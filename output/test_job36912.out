

date and time :  Wed Jun  9 10:04:18 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.5, early_stop=30, epochs=400, filename='', hidden_dim=300, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=291, weight_decay=0)
device :  cuda:0
Counter({1: 3489, 2: 2484, 0: 1427})

Epoch :  1 loss training:  296.64287853240967 Time :  517
accuracy train: 0.671079 val: 0.591045 test: 0.610190
max validation accuracy : 0.591045 max acc epoch : 1 test accuracy : 0.610190
Counter({2: 3423, 1: 2410, 0: 1567})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  185.23650366067886 Time :  603
accuracy train: 0.727333 val: 0.594030 test: 0.644324
max validation accuracy : 0.594030 max acc epoch : 2 test accuracy : 0.644324
Counter({2: 3455, 0: 2397, 1: 1548})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  181.6593572497368 Time :  664
accuracy train: 0.741893 val: 0.617910 test: 0.640613
max validation accuracy : 0.617910 max acc epoch : 3 test accuracy : 0.640613
Counter({2: 3494, 0: 2385, 1: 1521})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  116.54506313800812 Time :  733
accuracy train: 0.802118 val: 0.659701 test: 0.690576
max validation accuracy : 0.659701 max acc epoch : 4 test accuracy : 0.690576
Counter({2: 3451, 1: 2418, 0: 1531})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  102.25245907902718 Time :  803
accuracy train: 0.842488 val: 0.680597 test: 0.705169
max validation accuracy : 0.680597 max acc epoch : 5 test accuracy : 0.705169
Counter({0: 3449, 1: 2418, 2: 1533})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  90.28145346045494 Time :  885
accuracy train: 0.841165 val: 0.656716 test: 0.697007
max validation accuracy : 0.680597 max acc epoch : 5 test accuracy : 0.705169
Counter({2: 3460, 1: 2422, 0: 1518})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  72.4424087703228 Time :  957
accuracy train: 0.877895 val: 0.668657 test: 0.706406
max validation accuracy : 0.680597 max acc epoch : 5 test accuracy : 0.705169
Counter({1: 3437, 2: 2438, 0: 1525})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  67.09560370445251 Time :  1028
accuracy train: 0.874917 val: 0.677612 test: 0.703191
max validation accuracy : 0.680597 max acc epoch : 5 test accuracy : 0.705169
Counter({2: 3436, 0: 2425, 1: 1539})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.84024851024151 Time :  1113
accuracy train: 0.910655 val: 0.695522 test: 0.707148
max validation accuracy : 0.695522 max acc epoch : 9 test accuracy : 0.707148
Counter({1: 3431, 0: 2422, 2: 1547})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  55.50180687010288 Time :  1183
accuracy train: 0.903044 val: 0.686567 test: 0.713084
max validation accuracy : 0.695522 max acc epoch : 9 test accuracy : 0.707148
Counter({1: 3437, 2: 2423, 0: 1540})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  50.48596439510584 Time :  1252
accuracy train: 0.926539 val: 0.704478 test: 0.717536
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.717536
Counter({1: 3439, 0: 2422, 2: 1539})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  48.32000204920769 Time :  1330
accuracy train: 0.923230 val: 0.698507 test: 0.715558
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.717536
Counter({2: 3435, 0: 2422, 1: 1543})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  45.902532644569874 Time :  1383
accuracy train: 0.930841 val: 0.689552 test: 0.711106
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.717536
Counter({1: 3431, 2: 2422, 0: 1547})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  45.6062343493104 Time :  1451
accuracy train: 0.934150 val: 0.707463 test: 0.714568
max validation accuracy : 0.707463 max acc epoch : 14 test accuracy : 0.714568
Counter({1: 3428, 0: 2423, 2: 1549})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  44.961487755179405 Time :  1513
accuracy train: 0.934150 val: 0.713433 test: 0.715063
max validation accuracy : 0.713433 max acc epoch : 15 test accuracy : 0.715063
Counter({0: 3427, 2: 2424, 1: 1549})

Epoch :  16 loss training:  43.44340901821852 Time :  1582
accuracy train: 0.937790 val: 0.698507 test: 0.717536
max validation accuracy : 0.713433 max acc epoch : 15 test accuracy : 0.715063
Counter({0: 3433, 1: 2418, 2: 1549})

Epoch :  17 loss training:  43.03673862665892 Time :  1625
accuracy train: 0.943746 val: 0.704478 test: 0.720010
max validation accuracy : 0.713433 max acc epoch : 15 test accuracy : 0.715063
Counter({2: 3435, 1: 2422, 0: 1543})

Epoch :  18 loss training:  42.249325662851334 Time :  1695
accuracy train: 0.945400 val: 0.713433 test: 0.715310
max validation accuracy : 0.713433 max acc epoch : 15 test accuracy : 0.715063
Counter({0: 3433, 1: 2421, 2: 1546})

Epoch :  19 loss training:  39.68723254650831 Time :  1764
accuracy train: 0.954335 val: 0.710448 test: 0.718279
max validation accuracy : 0.713433 max acc epoch : 15 test accuracy : 0.715063
Counter({1: 3433, 0: 2421, 2: 1546})

Epoch :  20 loss training:  40.27116738259792 Time :  1836
accuracy train: 0.960291 val: 0.713433 test: 0.720505
max validation accuracy : 0.713433 max acc epoch : 15 test accuracy : 0.715063
Counter({1: 3440, 0: 2418, 2: 1542})

Epoch :  21 loss training:  39.67267695814371 Time :  1917
accuracy train: 0.954004 val: 0.707463 test: 0.722731
max validation accuracy : 0.713433 max acc epoch : 15 test accuracy : 0.715063
Counter({0: 3442, 2: 2422, 1: 1536})

Epoch :  22 loss training:  37.28175950795412 Time :  1995
accuracy train: 0.956320 val: 0.704478 test: 0.710364
max validation accuracy : 0.713433 max acc epoch : 15 test accuracy : 0.715063
Counter({1: 3440, 0: 2425, 2: 1535})

Epoch :  23 loss training:  37.60196880996227 Time :  2066
accuracy train: 0.962938 val: 0.716418 test: 0.720505
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.720505
Counter({1: 3437, 2: 2427, 0: 1536})

Epoch :  24 loss training:  34.475063651800156 Time :  2132
accuracy train: 0.967902 val: 0.710448 test: 0.718773
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.720505
Counter({0: 3443, 1: 2428, 2: 1529})

Epoch :  25 loss training:  34.66248808056116 Time :  2203
accuracy train: 0.965586 val: 0.707463 test: 0.724957
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.720505
Counter({1: 3439, 2: 2428, 0: 1533})

Epoch :  26 loss training:  31.3489800542593 Time :  2269
accuracy train: 0.963269 val: 0.728358 test: 0.721741
max validation accuracy : 0.728358 max acc epoch : 26 test accuracy : 0.721741
Counter({2: 3449, 1: 2417, 0: 1534})

Epoch :  27 loss training:  32.1733557395637 Time :  2329
accuracy train: 0.972535 val: 0.713433 test: 0.719515
max validation accuracy : 0.728358 max acc epoch : 26 test accuracy : 0.721741
Counter({1: 3454, 0: 2417, 2: 1529})

Epoch :  28 loss training:  30.12110461294651 Time :  2390
accuracy train: 0.976506 val: 0.719403 test: 0.720257
max validation accuracy : 0.728358 max acc epoch : 26 test accuracy : 0.721741
Counter({0: 3448, 2: 2423, 1: 1529})

Epoch :  29 loss training:  29.68995377421379 Time :  2452
accuracy train: 0.980477 val: 0.716418 test: 0.720999
max validation accuracy : 0.728358 max acc epoch : 26 test accuracy : 0.721741
Counter({2: 3454, 1: 2419, 0: 1527})

Epoch :  30 loss training:  31.148052718490362 Time :  2512
accuracy train: 0.975844 val: 0.722388 test: 0.713826
max validation accuracy : 0.728358 max acc epoch : 26 test accuracy : 0.721741
Counter({2: 3446, 0: 2421, 1: 1533})

Epoch :  31 loss training:  28.92418347299099 Time :  2575
accuracy train: 0.977498 val: 0.722388 test: 0.723473
max validation accuracy : 0.728358 max acc epoch : 26 test accuracy : 0.721741
Counter({2: 3440, 0: 2419, 1: 1541})

Epoch :  32 loss training:  29.429627433419228 Time :  2635
accuracy train: 0.978491 val: 0.713433 test: 0.719021
max validation accuracy : 0.728358 max acc epoch : 26 test accuracy : 0.721741
Counter({1: 3444, 0: 2420, 2: 1536})

Epoch :  33 loss training:  26.42257685214281 Time :  2707
accuracy train: 0.985109 val: 0.734328 test: 0.725946
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({1: 3439, 0: 2424, 2: 1537})

Epoch :  34 loss training:  25.165843475610018 Time :  2788
accuracy train: 0.983786 val: 0.716418 test: 0.724709
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({1: 3440, 0: 2418, 2: 1542})

Epoch :  35 loss training:  23.860040977597237 Time :  2853
accuracy train: 0.987756 val: 0.719403 test: 0.723225
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({1: 3436, 2: 2417, 0: 1547})

Epoch :  36 loss training:  24.923097986727953 Time :  2918
accuracy train: 0.988418 val: 0.707463 test: 0.722236
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({0: 3435, 1: 2417, 2: 1548})

Epoch :  37 loss training:  23.95786276087165 Time :  2983
accuracy train: 0.991396 val: 0.713433 test: 0.722483
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({0: 3440, 1: 2420, 2: 1540})

Epoch :  38 loss training:  24.81027757190168 Time :  3050
accuracy train: 0.992058 val: 0.719403 test: 0.721247
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({2: 3455, 1: 2417, 0: 1528})

Epoch :  39 loss training:  22.75553372874856 Time :  3094
accuracy train: 0.992389 val: 0.722388 test: 0.726935
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({1: 3445, 0: 2416, 2: 1539})

Epoch :  40 loss training:  20.92008462175727 Time :  3144
accuracy train: 0.993713 val: 0.728358 test: 0.717784
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({1: 3429, 0: 2418, 2: 1553})

Epoch :  41 loss training:  20.49553066957742 Time :  3204
accuracy train: 0.991727 val: 0.710448 test: 0.714321
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({1: 3429, 0: 2411, 2: 1560})

Epoch :  42 loss training:  18.68603404611349 Time :  3268
accuracy train: 0.993713 val: 0.728358 test: 0.719515
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({1: 3436, 0: 2413, 2: 1551})

Epoch :  43 loss training:  19.16637753508985 Time :  3332
accuracy train: 0.993382 val: 0.713433 test: 0.722731
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({2: 3470, 0: 2409, 1: 1521})

Epoch :  44 loss training:  19.656025176867843 Time :  3408
accuracy train: 0.992389 val: 0.716418 test: 0.720505
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({1: 3466, 0: 2414, 2: 1520})

Epoch :  45 loss training:  19.784816045314074 Time :  3479
accuracy train: 0.995367 val: 0.722388 test: 0.719021
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({0: 3471, 2: 2410, 1: 1519})

Epoch :  46 loss training:  17.63013220950961 Time :  3543
accuracy train: 0.995367 val: 0.722388 test: 0.725946
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({0: 3481, 1: 2409, 2: 1510})

Epoch :  47 loss training:  17.131620121188462 Time :  3601
accuracy train: 0.994044 val: 0.722388 test: 0.720752
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({1: 3474, 0: 2411, 2: 1515})

Epoch :  48 loss training:  16.37785003706813 Time :  3659
accuracy train: 0.996029 val: 0.716418 test: 0.723225
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({2: 3484, 0: 2406, 1: 1510})

Epoch :  49 loss training:  16.288629358634353 Time :  3717
accuracy train: 0.998015 val: 0.719403 test: 0.724215
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({2: 3482, 1: 2411, 0: 1507})

Epoch :  50 loss training:  15.367530716583133 Time :  3783
accuracy train: 0.997684 val: 0.716418 test: 0.724957
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({2: 3477, 0: 2410, 1: 1513})

Epoch :  51 loss training:  16.31405010446906 Time :  3844
accuracy train: 0.997022 val: 0.725373 test: 0.722236
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({1: 3476, 0: 2414, 2: 1510})

Epoch :  52 loss training:  13.79175045248121 Time :  3920
accuracy train: 0.998015 val: 0.731343 test: 0.724957
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({2: 3479, 1: 2415, 0: 1506})

Epoch :  53 loss training:  14.813448939472437 Time :  3980
accuracy train: 0.999007 val: 0.728358 test: 0.727925
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({1: 3481, 0: 2412, 2: 1507})

Epoch :  54 loss training:  13.04475980438292 Time :  4050
accuracy train: 0.995036 val: 0.722388 test: 0.726688
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({2: 3489, 1: 2406, 0: 1505})

Epoch :  55 loss training:  13.216660553589463 Time :  4114
accuracy train: 0.998015 val: 0.731343 test: 0.722731
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({0: 3489, 2: 2409, 1: 1502})

Epoch :  56 loss training:  13.604997549206018 Time :  4177
accuracy train: 0.996029 val: 0.728358 test: 0.724462
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({2: 3482, 0: 2411, 1: 1507})

Epoch :  57 loss training:  13.033518684096634 Time :  4244
accuracy train: 0.997684 val: 0.713433 test: 0.722978
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({2: 3486, 1: 2413, 0: 1501})

Epoch :  58 loss training:  12.853400874882936 Time :  4300
accuracy train: 0.998676 val: 0.713433 test: 0.725204
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({0: 3493, 1: 2417, 2: 1490})

Epoch :  59 loss training:  12.259301101788878 Time :  4370
accuracy train: 0.996691 val: 0.722388 test: 0.726441
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({1: 3491, 2: 2414, 0: 1495})

Epoch :  60 loss training:  11.498708829283714 Time :  4429
accuracy train: 0.998345 val: 0.728358 test: 0.724215
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({0: 3489, 1: 2417, 2: 1494})

Epoch :  61 loss training:  11.893269705586135 Time :  4496
accuracy train: 0.998676 val: 0.728358 test: 0.721989
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({0: 3495, 2: 2413, 1: 1492})

Epoch :  62 loss training:  11.316433056257665 Time :  4561
accuracy train: 0.997022 val: 0.722388 test: 0.722483
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({1: 3497, 0: 2410, 2: 1493})

Epoch :  63 loss training:  11.463030177168548 Time :  4628
accuracy train: 0.999669 val: 0.713433 test: 0.721247
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({0: 3501, 1: 2412, 2: 1487})

Epoch :  64 loss training:  11.47793895797804 Time :  4695
accuracy train: 0.999007 val: 0.722388 test: 0.722731
max validation accuracy : 0.734328 max acc epoch : 33 test accuracy : 0.725946
Counter({2: 3502, 0: 2410, 1: 1488})

========================================================================================================================================================================================================
max acc epoch :  33
max validation accuracy :  0.7343283582089553
test accuracy :  0.7259460796438288
last test_accuracy :  0.7227306455602276
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.5, early_stop=30, epochs=400, filename='', hidden_dim=300, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=291, weight_decay=0)
device :  cuda:0
Counter({1: 3489, 2: 2484, 0: 1427})

Epoch :  1 loss training:  295.9518269300461 Time :  5265
accuracy train: 0.656188 val: 0.588060 test: 0.597081
max validation accuracy : 0.588060 max acc epoch : 1 test accuracy : 0.597081
Counter({0: 3483, 2: 2406, 1: 1511})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  184.60316109657288 Time :  5339
accuracy train: 0.726340 val: 0.594030 test: 0.649023
max validation accuracy : 0.594030 max acc epoch : 2 test accuracy : 0.649023
Counter({2: 3459, 1: 2396, 0: 1545})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  181.45278230309486 Time :  5421
accuracy train: 0.733289 val: 0.602985 test: 0.629978
max validation accuracy : 0.602985 max acc epoch : 3 test accuracy : 0.629978
Counter({1: 3473, 2: 2384, 0: 1543})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  117.43050861358643 Time :  5482
accuracy train: 0.809398 val: 0.665672 test: 0.693792
max validation accuracy : 0.665672 max acc epoch : 4 test accuracy : 0.693792
Counter({1: 3476, 2: 2403, 0: 1521})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  102.58878163993359 Time :  5546
accuracy train: 0.830907 val: 0.692537 test: 0.703685
max validation accuracy : 0.692537 max acc epoch : 5 test accuracy : 0.703685
Counter({2: 3495, 1: 2410, 0: 1495})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  90.86964108794928 Time :  5610
accuracy train: 0.837856 val: 0.662687 test: 0.692555
max validation accuracy : 0.692537 max acc epoch : 5 test accuracy : 0.703685
Counter({1: 3504, 2: 2413, 0: 1483})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  73.72652831673622 Time :  5678
accuracy train: 0.874586 val: 0.644776 test: 0.702696
max validation accuracy : 0.692537 max acc epoch : 5 test accuracy : 0.703685
Counter({1: 3462, 2: 2427, 0: 1511})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  67.67613684386015 Time :  5749
accuracy train: 0.874917 val: 0.677612 test: 0.703933
max validation accuracy : 0.692537 max acc epoch : 5 test accuracy : 0.703685
Counter({1: 3487, 2: 2404, 0: 1509})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.45581775903702 Time :  5820
accuracy train: 0.911979 val: 0.686567 test: 0.713579
max validation accuracy : 0.692537 max acc epoch : 5 test accuracy : 0.703685
Counter({1: 3441, 0: 2417, 2: 1542})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  57.656365513801575 Time :  5906
accuracy train: 0.901390 val: 0.692537 test: 0.712837
max validation accuracy : 0.692537 max acc epoch : 5 test accuracy : 0.703685
Counter({0: 3457, 2: 2413, 1: 1530})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  51.29332739114761 Time :  5978
accuracy train: 0.914957 val: 0.695522 test: 0.710611
max validation accuracy : 0.695522 max acc epoch : 11 test accuracy : 0.710611
Counter({0: 3457, 2: 2415, 1: 1528})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  50.62105767428875 Time :  6048
accuracy train: 0.915288 val: 0.698507 test: 0.714321
max validation accuracy : 0.698507 max acc epoch : 12 test accuracy : 0.714321
Counter({2: 3450, 0: 2416, 1: 1534})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  47.65141064673662 Time :  6112
accuracy train: 0.927862 val: 0.692537 test: 0.709127
max validation accuracy : 0.698507 max acc epoch : 12 test accuracy : 0.714321
Counter({0: 3449, 1: 2412, 2: 1539})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  47.6092971265316 Time :  6182
accuracy train: 0.927201 val: 0.701493 test: 0.714568
max validation accuracy : 0.701493 max acc epoch : 14 test accuracy : 0.714568
Counter({0: 3455, 1: 2412, 2: 1533})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  46.111354395747185 Time :  6275
accuracy train: 0.931502 val: 0.698507 test: 0.713826
max validation accuracy : 0.701493 max acc epoch : 14 test accuracy : 0.714568
Counter({0: 3445, 2: 2420, 1: 1535})

Epoch :  16 loss training:  45.04898373037577 Time :  6350
accuracy train: 0.935473 val: 0.701493 test: 0.714074
max validation accuracy : 0.701493 max acc epoch : 14 test accuracy : 0.714568
Counter({1: 3451, 0: 2414, 2: 1535})

Epoch :  17 loss training:  43.75197463482618 Time :  6428
accuracy train: 0.935804 val: 0.698507 test: 0.712837
max validation accuracy : 0.701493 max acc epoch : 14 test accuracy : 0.714568
Counter({2: 3458, 0: 2408, 1: 1534})

Epoch :  18 loss training:  43.33125418424606 Time :  6503
accuracy train: 0.943415 val: 0.692537 test: 0.711600
max validation accuracy : 0.701493 max acc epoch : 14 test accuracy : 0.714568
Counter({2: 3461, 1: 2412, 0: 1527})

Epoch :  19 loss training:  40.31516266614199 Time :  6573
accuracy train: 0.953673 val: 0.698507 test: 0.710858
max validation accuracy : 0.701493 max acc epoch : 14 test accuracy : 0.714568
Counter({0: 3463, 2: 2413, 1: 1524})

Epoch :  20 loss training:  40.57421104609966 Time :  6655
accuracy train: 0.958637 val: 0.704478 test: 0.712095
max validation accuracy : 0.704478 max acc epoch : 20 test accuracy : 0.712095
Counter({2: 3461, 0: 2410, 1: 1529})

Epoch :  21 loss training:  38.85412307828665 Time :  6732
accuracy train: 0.949040 val: 0.695522 test: 0.714074
max validation accuracy : 0.704478 max acc epoch : 20 test accuracy : 0.712095
Counter({0: 3450, 2: 2419, 1: 1531})

Epoch :  22 loss training:  37.856747917830944 Time :  6802
accuracy train: 0.954997 val: 0.689552 test: 0.710858
max validation accuracy : 0.704478 max acc epoch : 20 test accuracy : 0.712095
Counter({1: 3441, 0: 2420, 2: 1539})

Epoch :  23 loss training:  37.18293494358659 Time :  6873
accuracy train: 0.959629 val: 0.695522 test: 0.714816
max validation accuracy : 0.704478 max acc epoch : 20 test accuracy : 0.712095
Counter({0: 3449, 2: 2421, 1: 1530})

Epoch :  24 loss training:  34.888889871537685 Time :  6949
accuracy train: 0.964924 val: 0.692537 test: 0.714568
max validation accuracy : 0.704478 max acc epoch : 20 test accuracy : 0.712095
Counter({1: 3448, 0: 2419, 2: 1533})

Epoch :  25 loss training:  34.93736532330513 Time :  7023
accuracy train: 0.961615 val: 0.701493 test: 0.715805
max validation accuracy : 0.704478 max acc epoch : 20 test accuracy : 0.712095
Counter({1: 3444, 2: 2420, 0: 1536})

Epoch :  26 loss training:  31.895554788410664 Time :  7097
accuracy train: 0.964262 val: 0.698507 test: 0.717784
max validation accuracy : 0.704478 max acc epoch : 20 test accuracy : 0.712095
Counter({2: 3469, 1: 2406, 0: 1525})

Epoch :  27 loss training:  33.289802737534046 Time :  7174
accuracy train: 0.963931 val: 0.701493 test: 0.712837
max validation accuracy : 0.704478 max acc epoch : 20 test accuracy : 0.712095
Counter({2: 3464, 0: 2412, 1: 1524})

Epoch :  28 loss training:  31.34134379029274 Time :  7249
accuracy train: 0.971873 val: 0.701493 test: 0.718031
max validation accuracy : 0.704478 max acc epoch : 20 test accuracy : 0.712095
Counter({0: 3461, 2: 2418, 1: 1521})

Epoch :  29 loss training:  31.65660236030817 Time :  7326
accuracy train: 0.975844 val: 0.698507 test: 0.713826
max validation accuracy : 0.704478 max acc epoch : 20 test accuracy : 0.712095
Counter({0: 3468, 1: 2420, 2: 1512})

Epoch :  30 loss training:  31.521406680345535 Time :  7407
accuracy train: 0.973197 val: 0.686567 test: 0.707395
max validation accuracy : 0.704478 max acc epoch : 20 test accuracy : 0.712095
Counter({1: 3461, 0: 2422, 2: 1517})

Epoch :  31 loss training:  30.009570062160492 Time :  7491
accuracy train: 0.974520 val: 0.689552 test: 0.720257
max validation accuracy : 0.704478 max acc epoch : 20 test accuracy : 0.712095
Counter({1: 3464, 2: 2413, 0: 1523})

Epoch :  32 loss training:  28.8659263625741 Time :  7567
accuracy train: 0.977167 val: 0.710448 test: 0.713579
max validation accuracy : 0.710448 max acc epoch : 32 test accuracy : 0.713579
Counter({1: 3461, 2: 2420, 0: 1519})

Epoch :  33 loss training:  26.73872296512127 Time :  7634
accuracy train: 0.982793 val: 0.698507 test: 0.717536
max validation accuracy : 0.710448 max acc epoch : 32 test accuracy : 0.713579
Counter({2: 3444, 1: 2414, 0: 1542})

Epoch :  34 loss training:  26.508827820420265 Time :  7715
accuracy train: 0.980807 val: 0.692537 test: 0.718773
max validation accuracy : 0.710448 max acc epoch : 32 test accuracy : 0.713579
Counter({1: 3466, 2: 2400, 0: 1534})

Epoch :  35 loss training:  25.387162566184998 Time :  7784
accuracy train: 0.985109 val: 0.713433 test: 0.717042
max validation accuracy : 0.713433 max acc epoch : 35 test accuracy : 0.717042
Counter({1: 3459, 2: 2410, 0: 1531})

Epoch :  36 loss training:  25.054348077625036 Time :  7857
accuracy train: 0.984116 val: 0.698507 test: 0.712590
max validation accuracy : 0.713433 max acc epoch : 35 test accuracy : 0.717042
Counter({2: 3465, 0: 2406, 1: 1529})

Epoch :  37 loss training:  25.460280671715736 Time :  7929
accuracy train: 0.986764 val: 0.692537 test: 0.715558
max validation accuracy : 0.713433 max acc epoch : 35 test accuracy : 0.717042
Counter({2: 3462, 1: 2413, 0: 1525})

Epoch :  38 loss training:  25.459199914708734 Time :  8004
accuracy train: 0.988087 val: 0.698507 test: 0.715063
max validation accuracy : 0.713433 max acc epoch : 35 test accuracy : 0.717042
Counter({1: 3481, 2: 2412, 0: 1507})

Epoch :  39 loss training:  23.520263427868485 Time :  8073
accuracy train: 0.990073 val: 0.704478 test: 0.714568
max validation accuracy : 0.713433 max acc epoch : 35 test accuracy : 0.717042
Counter({0: 3478, 2: 2412, 1: 1510})

Epoch :  40 loss training:  21.14380305632949 Time :  8151
accuracy train: 0.992389 val: 0.707463 test: 0.713826
max validation accuracy : 0.713433 max acc epoch : 35 test accuracy : 0.717042
Counter({2: 3483, 0: 2402, 1: 1515})

Epoch :  41 loss training:  21.285109121352434 Time :  8223
accuracy train: 0.992720 val: 0.695522 test: 0.709127
max validation accuracy : 0.713433 max acc epoch : 35 test accuracy : 0.717042
Counter({2: 3474, 1: 2410, 0: 1516})

Epoch :  42 loss training:  18.673477549105883 Time :  8293
accuracy train: 0.991066 val: 0.692537 test: 0.716300
max validation accuracy : 0.713433 max acc epoch : 35 test accuracy : 0.717042
Counter({2: 3467, 1: 2402, 0: 1531})

Epoch :  43 loss training:  20.621564891189337 Time :  8366
accuracy train: 0.992058 val: 0.698507 test: 0.716547
max validation accuracy : 0.713433 max acc epoch : 35 test accuracy : 0.717042
Counter({2: 3491, 0: 2401, 1: 1508})

Epoch :  44 loss training:  19.831928050145507 Time :  8444
accuracy train: 0.994044 val: 0.692537 test: 0.717536
max validation accuracy : 0.713433 max acc epoch : 35 test accuracy : 0.717042
Counter({1: 3494, 0: 2400, 2: 1506})

Epoch :  45 loss training:  19.526931336149573 Time :  8527
accuracy train: 0.994375 val: 0.698507 test: 0.713084
max validation accuracy : 0.713433 max acc epoch : 35 test accuracy : 0.717042
Counter({1: 3486, 2: 2398, 0: 1516})

Epoch :  46 loss training:  19.059705205261707 Time :  8604
accuracy train: 0.994705 val: 0.713433 test: 0.716300
max validation accuracy : 0.713433 max acc epoch : 35 test accuracy : 0.717042
Counter({0: 3499, 1: 2400, 2: 1501})

Epoch :  47 loss training:  16.84544610977173 Time :  8675
accuracy train: 0.994705 val: 0.704478 test: 0.717042
max validation accuracy : 0.713433 max acc epoch : 35 test accuracy : 0.717042
Counter({1: 3498, 2: 2403, 0: 1499})

Epoch :  48 loss training:  16.995409656316042 Time :  8749
accuracy train: 0.994375 val: 0.704478 test: 0.715063
max validation accuracy : 0.713433 max acc epoch : 35 test accuracy : 0.717042
Counter({1: 3510, 2: 2409, 0: 1481})

Epoch :  49 loss training:  15.945907136425376 Time :  8817
accuracy train: 0.995367 val: 0.689552 test: 0.714816
max validation accuracy : 0.713433 max acc epoch : 35 test accuracy : 0.717042
Counter({2: 3506, 1: 2402, 0: 1492})

Epoch :  50 loss training:  15.54895762167871 Time :  8882
accuracy train: 0.996360 val: 0.707463 test: 0.716547
max validation accuracy : 0.713433 max acc epoch : 35 test accuracy : 0.717042
Counter({2: 3507, 1: 2403, 0: 1490})

Epoch :  51 loss training:  15.241333837620914 Time :  8966
accuracy train: 0.997353 val: 0.704478 test: 0.717042
max validation accuracy : 0.713433 max acc epoch : 35 test accuracy : 0.717042
Counter({1: 3518, 2: 2406, 0: 1476})

Epoch :  52 loss training:  16.748494870960712 Time :  9036
accuracy train: 0.997353 val: 0.701493 test: 0.716547
max validation accuracy : 0.713433 max acc epoch : 35 test accuracy : 0.717042
Counter({2: 3531, 1: 2400, 0: 1469})

Epoch :  53 loss training:  15.086288502439857 Time :  9101
accuracy train: 0.997353 val: 0.704478 test: 0.718526
max validation accuracy : 0.713433 max acc epoch : 35 test accuracy : 0.717042
Counter({2: 3526, 0: 2395, 1: 1479})

Epoch :  54 loss training:  13.718388309702277 Time :  9168
accuracy train: 0.998015 val: 0.704478 test: 0.716300
max validation accuracy : 0.713433 max acc epoch : 35 test accuracy : 0.717042
Counter({2: 3517, 1: 2396, 0: 1487})

Epoch :  55 loss training:  12.911890335381031 Time :  9233
accuracy train: 0.997684 val: 0.698507 test: 0.715805
max validation accuracy : 0.713433 max acc epoch : 35 test accuracy : 0.717042
Counter({2: 3525, 1: 2395, 0: 1480})

Epoch :  56 loss training:  14.289917664602399 Time :  9298
accuracy train: 0.998015 val: 0.704478 test: 0.716300
max validation accuracy : 0.713433 max acc epoch : 35 test accuracy : 0.717042
Counter({1: 3523, 0: 2395, 2: 1482})

Epoch :  57 loss training:  12.346925104036927 Time :  9368
accuracy train: 0.998015 val: 0.698507 test: 0.714816
max validation accuracy : 0.713433 max acc epoch : 35 test accuracy : 0.717042
Counter({0: 3528, 2: 2393, 1: 1479})

Epoch :  58 loss training:  11.882600544020534 Time :  9438
accuracy train: 0.998345 val: 0.704478 test: 0.718031
max validation accuracy : 0.713433 max acc epoch : 35 test accuracy : 0.717042
Counter({1: 3518, 2: 2399, 0: 1483})

Epoch :  59 loss training:  12.835648395121098 Time :  9512
accuracy train: 0.997684 val: 0.722388 test: 0.720752
max validation accuracy : 0.722388 max acc epoch : 59 test accuracy : 0.720752
Counter({2: 3508, 1: 2390, 0: 1502})

Epoch :  60 loss training:  11.51450940221548 Time :  9576
accuracy train: 0.997684 val: 0.734328 test: 0.721494
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({2: 3510, 1: 2393, 0: 1497})

Epoch :  61 loss training:  11.139757604338229 Time :  9634
accuracy train: 0.999007 val: 0.704478 test: 0.719268
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({0: 3532, 1: 2391, 2: 1477})

Epoch :  62 loss training:  11.74674491584301 Time :  9702
accuracy train: 0.999338 val: 0.713433 test: 0.717289
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({1: 3531, 2: 2389, 0: 1480})

Epoch :  63 loss training:  10.566968472674489 Time :  9781
accuracy train: 1.000000 val: 0.701493 test: 0.720010
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({0: 3537, 2: 2391, 1: 1472})

Epoch :  64 loss training:  11.176662933081388 Time :  9845
accuracy train: 0.998676 val: 0.707463 test: 0.717784
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({1: 3538, 2: 2391, 0: 1471})

Epoch :  65 loss training:  10.302182290703058 Time :  9921
accuracy train: 0.999669 val: 0.704478 test: 0.713579
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({2: 3547, 0: 2388, 1: 1465})

Epoch :  66 loss training:  10.681868132203817 Time :  9998
accuracy train: 0.999007 val: 0.698507 test: 0.721247
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({2: 3545, 1: 2385, 0: 1470})

Epoch :  67 loss training:  10.285734647419304 Time :  10068
accuracy train: 0.999338 val: 0.707463 test: 0.721494
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({1: 3525, 0: 2386, 2: 1489})

Epoch :  68 loss training:  9.119971797801554 Time :  10144
accuracy train: 1.000000 val: 0.719403 test: 0.718031
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({0: 3543, 1: 2392, 2: 1465})

Epoch :  69 loss training:  10.10422114469111 Time :  10217
accuracy train: 0.998345 val: 0.719403 test: 0.721989
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({2: 3546, 1: 2389, 0: 1465})

Epoch :  70 loss training:  9.747721091844141 Time :  10280
accuracy train: 0.999338 val: 0.719403 test: 0.722978
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({1: 3543, 0: 2394, 2: 1463})

Epoch :  71 loss training:  9.133655055891722 Time :  10356
accuracy train: 0.998676 val: 0.719403 test: 0.724462
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({1: 3541, 2: 2393, 0: 1466})

Epoch :  72 loss training:  9.050359479617327 Time :  10421
accuracy train: 0.999007 val: 0.719403 test: 0.722236
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({1: 3542, 0: 2388, 2: 1470})

Epoch :  73 loss training:  8.259862926322967 Time :  10481
accuracy train: 0.999338 val: 0.710448 test: 0.720999
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({0: 3556, 1: 2390, 2: 1454})

Epoch :  74 loss training:  8.396953334100544 Time :  10545
accuracy train: 0.999669 val: 0.710448 test: 0.723720
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({0: 3570, 2: 2385, 1: 1445})

Epoch :  75 loss training:  8.194430665113032 Time :  10601
accuracy train: 0.999338 val: 0.716418 test: 0.717784
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({1: 3569, 2: 2388, 0: 1443})

Epoch :  76 loss training:  8.03674856480211 Time :  10669
accuracy train: 0.998676 val: 0.713433 test: 0.714568
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({0: 3547, 1: 2386, 2: 1467})

Epoch :  77 loss training:  8.051736046560109 Time :  10739
accuracy train: 1.000000 val: 0.701493 test: 0.715558
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({0: 3543, 1: 2393, 2: 1464})

Epoch :  78 loss training:  7.74579121125862 Time :  10815
accuracy train: 0.999338 val: 0.713433 test: 0.719515
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({2: 3546, 0: 2386, 1: 1468})

Epoch :  79 loss training:  6.199387702159584 Time :  10875
accuracy train: 1.000000 val: 0.716418 test: 0.718031
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({1: 3560, 0: 2390, 2: 1450})

Epoch :  80 loss training:  6.371084416285157 Time :  10938
accuracy train: 1.000000 val: 0.713433 test: 0.719268
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({2: 3550, 1: 2388, 0: 1462})

Epoch :  81 loss training:  7.379167979583144 Time :  11006
accuracy train: 1.000000 val: 0.704478 test: 0.717289
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({0: 3552, 2: 2392, 1: 1456})

Epoch :  82 loss training:  7.062838237732649 Time :  11073
accuracy train: 1.000000 val: 0.713433 test: 0.716052
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({1: 3551, 2: 2395, 0: 1454})

Epoch :  83 loss training:  6.427727495320141 Time :  11150
accuracy train: 1.000000 val: 0.713433 test: 0.718279
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({2: 3560, 0: 2376, 1: 1464})

Epoch :  84 loss training:  5.495341716799885 Time :  11216
accuracy train: 1.000000 val: 0.704478 test: 0.720752
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({1: 3559, 2: 2387, 0: 1454})

Epoch :  85 loss training:  6.117468473967165 Time :  11295
accuracy train: 1.000000 val: 0.710448 test: 0.725451
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({2: 3567, 1: 2384, 0: 1449})

Epoch :  86 loss training:  6.424373319372535 Time :  11360
accuracy train: 1.000000 val: 0.719403 test: 0.723720
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({0: 3562, 1: 2388, 2: 1450})

Epoch :  87 loss training:  6.408180580008775 Time :  11432
accuracy train: 1.000000 val: 0.689552 test: 0.720999
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({0: 3530, 1: 2397, 2: 1473})

Epoch :  88 loss training:  5.6254445584490895 Time :  11498
accuracy train: 1.000000 val: 0.713433 test: 0.723967
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({1: 3539, 2: 2389, 0: 1472})

Epoch :  89 loss training:  5.752049548900686 Time :  11556
accuracy train: 1.000000 val: 0.719403 test: 0.724709
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({1: 3537, 2: 2382, 0: 1481})

Epoch :  90 loss training:  6.368347494397312 Time :  11615
accuracy train: 1.000000 val: 0.719403 test: 0.720010
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({1: 3542, 2: 2380, 0: 1478})

Epoch :  91 loss training:  5.855051089543849 Time :  11672
accuracy train: 1.000000 val: 0.719403 test: 0.724957
max validation accuracy : 0.734328 max acc epoch : 60 test accuracy : 0.721494
Counter({1: 3543, 2: 2391, 0: 1466})

========================================================================================================================================================================================================
max acc epoch :  60
max validation accuracy :  0.7343283582089553
test accuracy :  0.7214939401434578
last test_accuracy :  0.7249567153104131
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.5, early_stop=30, epochs=400, filename='', hidden_dim=300, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=291, weight_decay=0)
device :  cuda:0
Counter({1: 3489, 2: 2484, 0: 1427})

Epoch :  1 loss training:  295.2206983566284 Time :  12553
accuracy train: 0.658173 val: 0.591045 test: 0.602523
max validation accuracy : 0.591045 max acc epoch : 1 test accuracy : 0.602523
Counter({0: 3457, 2: 2442, 1: 1501})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  183.3435714840889 Time :  12715
accuracy train: 0.714758 val: 0.543284 test: 0.638140
max validation accuracy : 0.591045 max acc epoch : 1 test accuracy : 0.602523
Counter({0: 3489, 1: 2392, 2: 1519})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  175.48807913064957 Time :  12878
accuracy train: 0.726671 val: 0.626866 test: 0.634925
max validation accuracy : 0.626866 max acc epoch : 3 test accuracy : 0.634925
Counter({0: 3484, 2: 2372, 1: 1544})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  116.04220089316368 Time :  13019
accuracy train: 0.808405 val: 0.674627 test: 0.699233
max validation accuracy : 0.674627 max acc epoch : 4 test accuracy : 0.699233
Counter({1: 3510, 0: 2416, 2: 1474})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  102.9638552069664 Time :  13167
accuracy train: 0.828259 val: 0.677612 test: 0.697749
max validation accuracy : 0.677612 max acc epoch : 5 test accuracy : 0.697749
Counter({0: 3477, 1: 2421, 2: 1502})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  92.18549188226461 Time :  13296
accuracy train: 0.840503 val: 0.656716 test: 0.693050
max validation accuracy : 0.677612 max acc epoch : 5 test accuracy : 0.697749
Counter({0: 3482, 1: 2414, 2: 1504})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  74.65245592594147 Time :  13391
accuracy train: 0.873263 val: 0.674627 test: 0.702696
max validation accuracy : 0.677612 max acc epoch : 5 test accuracy : 0.697749
Counter({2: 3464, 1: 2419, 0: 1517})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  67.97966426610947 Time :  13495
accuracy train: 0.873263 val: 0.671642 test: 0.701212
max validation accuracy : 0.677612 max acc epoch : 5 test accuracy : 0.697749
Counter({2: 3479, 1: 2415, 0: 1506})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.9033104032278 Time :  13581
accuracy train: 0.903706 val: 0.680597 test: 0.710364
max validation accuracy : 0.680597 max acc epoch : 9 test accuracy : 0.710364
Counter({2: 3478, 0: 2414, 1: 1508})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  55.62666853517294 Time :  13676
accuracy train: 0.897419 val: 0.689552 test: 0.713084
max validation accuracy : 0.689552 max acc epoch : 10 test accuracy : 0.713084
Counter({1: 3484, 2: 2414, 0: 1502})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  52.431609615683556 Time :  13768
accuracy train: 0.916612 val: 0.701493 test: 0.715063
max validation accuracy : 0.701493 max acc epoch : 11 test accuracy : 0.715063
Counter({1: 3459, 0: 2417, 2: 1524})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  50.52072985470295 Time :  13875
accuracy train: 0.913633 val: 0.698507 test: 0.713826
max validation accuracy : 0.701493 max acc epoch : 11 test accuracy : 0.715063
Counter({2: 3450, 0: 2421, 1: 1529})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  47.59930416941643 Time :  13966
accuracy train: 0.923891 val: 0.683582 test: 0.710858
max validation accuracy : 0.701493 max acc epoch : 11 test accuracy : 0.715063
Counter({0: 3449, 2: 2421, 1: 1530})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  47.78461564332247 Time :  14047
accuracy train: 0.927862 val: 0.704478 test: 0.715558
max validation accuracy : 0.704478 max acc epoch : 14 test accuracy : 0.715558
Counter({1: 3453, 2: 2418, 0: 1529})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  44.64874919503927 Time :  14130
accuracy train: 0.928855 val: 0.689552 test: 0.718526
max validation accuracy : 0.704478 max acc epoch : 14 test accuracy : 0.715558
Counter({0: 3447, 1: 2424, 2: 1529})

Epoch :  16 loss training:  44.95579429715872 Time :  14225
accuracy train: 0.930510 val: 0.704478 test: 0.714816
max validation accuracy : 0.704478 max acc epoch : 14 test accuracy : 0.715558
Counter({0: 3451, 2: 2418, 1: 1531})

Epoch :  17 loss training:  44.49118862301111 Time :  14313
accuracy train: 0.928193 val: 0.698507 test: 0.719268
max validation accuracy : 0.704478 max acc epoch : 14 test accuracy : 0.715558
Counter({1: 3450, 0: 2417, 2: 1533})

Epoch :  18 loss training:  43.16430255025625 Time :  14408
accuracy train: 0.941760 val: 0.683582 test: 0.713579
max validation accuracy : 0.704478 max acc epoch : 14 test accuracy : 0.715558
Counter({0: 3448, 1: 2419, 2: 1533})

Epoch :  19 loss training:  41.06203097105026 Time :  14495
accuracy train: 0.942753 val: 0.701493 test: 0.716547
max validation accuracy : 0.704478 max acc epoch : 14 test accuracy : 0.715558
Counter({2: 3453, 1: 2420, 0: 1527})

Epoch :  20 loss training:  41.937823571264744 Time :  14582
accuracy train: 0.953673 val: 0.713433 test: 0.718279
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.718279
Counter({2: 3459, 0: 2418, 1: 1523})

Epoch :  21 loss training:  39.07489547878504 Time :  14664
accuracy train: 0.945731 val: 0.707463 test: 0.716300
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.718279
Counter({0: 3457, 2: 2424, 1: 1519})

Epoch :  22 loss training:  38.698920987546444 Time :  14743
accuracy train: 0.950033 val: 0.686567 test: 0.708138
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.718279
Counter({1: 3457, 2: 2426, 0: 1517})

Epoch :  23 loss training:  37.359631568193436 Time :  14826
accuracy train: 0.955989 val: 0.701493 test: 0.719268
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.718279
Counter({1: 3461, 2: 2422, 0: 1517})

Epoch :  24 loss training:  35.85776336491108 Time :  14913
accuracy train: 0.958306 val: 0.695522 test: 0.715805
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.718279
Counter({0: 3469, 1: 2420, 2: 1511})

Epoch :  25 loss training:  34.96533711254597 Time :  14986
accuracy train: 0.960291 val: 0.704478 test: 0.717042
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.718279
Counter({1: 3472, 0: 2418, 2: 1510})

Epoch :  26 loss training:  31.59864342212677 Time :  15051
accuracy train: 0.957975 val: 0.716418 test: 0.716547
max validation accuracy : 0.716418 max acc epoch : 26 test accuracy : 0.716547
Counter({2: 3474, 1: 2408, 0: 1518})

Epoch :  27 loss training:  32.0695968195796 Time :  15106
accuracy train: 0.964262 val: 0.707463 test: 0.717536
max validation accuracy : 0.716418 max acc epoch : 26 test accuracy : 0.716547
Counter({2: 3470, 1: 2410, 0: 1520})

Epoch :  28 loss training:  30.786498464643955 Time :  15172
accuracy train: 0.973197 val: 0.710448 test: 0.715558
max validation accuracy : 0.716418 max acc epoch : 26 test accuracy : 0.716547
Counter({2: 3474, 1: 2412, 0: 1514})

Epoch :  29 loss training:  31.63569711148739 Time :  15239
accuracy train: 0.971873 val: 0.695522 test: 0.716300
max validation accuracy : 0.716418 max acc epoch : 26 test accuracy : 0.716547
Counter({2: 3477, 0: 2413, 1: 1510})

Epoch :  30 loss training:  30.396822709590197 Time :  15300
accuracy train: 0.972866 val: 0.695522 test: 0.710858
max validation accuracy : 0.716418 max acc epoch : 26 test accuracy : 0.716547
Counter({1: 3478, 0: 2413, 2: 1509})

Epoch :  31 loss training:  29.16867918521166 Time :  15376
accuracy train: 0.972535 val: 0.704478 test: 0.716300
max validation accuracy : 0.716418 max acc epoch : 26 test accuracy : 0.716547
Counter({1: 3481, 2: 2411, 0: 1508})

Epoch :  32 loss training:  29.767147660255432 Time :  15444
accuracy train: 0.974520 val: 0.707463 test: 0.716547
max validation accuracy : 0.716418 max acc epoch : 26 test accuracy : 0.716547
Counter({0: 3484, 1: 2410, 2: 1506})

Epoch :  33 loss training:  27.362539179623127 Time :  15507
accuracy train: 0.980807 val: 0.707463 test: 0.715558
max validation accuracy : 0.716418 max acc epoch : 26 test accuracy : 0.716547
Counter({1: 3479, 2: 2409, 0: 1512})

Epoch :  34 loss training:  25.307084158062935 Time :  15571
accuracy train: 0.980477 val: 0.704478 test: 0.717784
max validation accuracy : 0.716418 max acc epoch : 26 test accuracy : 0.716547
Counter({1: 3478, 2: 2410, 0: 1512})

Epoch :  35 loss training:  25.1105070784688 Time :  15641
accuracy train: 0.980807 val: 0.701493 test: 0.717289
max validation accuracy : 0.716418 max acc epoch : 26 test accuracy : 0.716547
Counter({2: 3477, 1: 2410, 0: 1513})

Epoch :  36 loss training:  25.19696494936943 Time :  15716
accuracy train: 0.985440 val: 0.695522 test: 0.719763
max validation accuracy : 0.716418 max acc epoch : 26 test accuracy : 0.716547
Counter({1: 3483, 0: 2408, 2: 1509})

Epoch :  37 loss training:  24.52312223613262 Time :  15789
accuracy train: 0.984447 val: 0.695522 test: 0.712837
max validation accuracy : 0.716418 max acc epoch : 26 test accuracy : 0.716547
Counter({2: 3489, 0: 2409, 1: 1502})

Epoch :  38 loss training:  25.35493273101747 Time :  15859
accuracy train: 0.985771 val: 0.710448 test: 0.714816
max validation accuracy : 0.716418 max acc epoch : 26 test accuracy : 0.716547
Counter({0: 3491, 1: 2406, 2: 1503})

Epoch :  39 loss training:  22.65890750475228 Time :  15923
accuracy train: 0.987426 val: 0.707463 test: 0.718526
max validation accuracy : 0.716418 max acc epoch : 26 test accuracy : 0.716547
Counter({0: 3507, 1: 2402, 2: 1491})

Epoch :  40 loss training:  21.717511527240276 Time :  15989
accuracy train: 0.988749 val: 0.725373 test: 0.714568
max validation accuracy : 0.725373 max acc epoch : 40 test accuracy : 0.714568
Counter({2: 3502, 1: 2405, 0: 1493})

Epoch :  41 loss training:  20.949877947568893 Time :  16056
accuracy train: 0.989080 val: 0.698507 test: 0.711106
max validation accuracy : 0.725373 max acc epoch : 40 test accuracy : 0.714568
Counter({2: 3494, 1: 2406, 0: 1500})

Epoch :  42 loss training:  18.935562578961253 Time :  16115
accuracy train: 0.990073 val: 0.701493 test: 0.709869
max validation accuracy : 0.725373 max acc epoch : 40 test accuracy : 0.714568
Counter({0: 3484, 2: 2404, 1: 1512})

Epoch :  43 loss training:  20.882219707593322 Time :  16182
accuracy train: 0.989411 val: 0.707463 test: 0.712342
max validation accuracy : 0.725373 max acc epoch : 40 test accuracy : 0.714568
Counter({2: 3493, 0: 2405, 1: 1502})

Epoch :  44 loss training:  18.93611929193139 Time :  16239
accuracy train: 0.989080 val: 0.704478 test: 0.720505
max validation accuracy : 0.725373 max acc epoch : 40 test accuracy : 0.714568
Counter({1: 3503, 0: 2403, 2: 1494})

Epoch :  45 loss training:  19.80302551202476 Time :  16304
accuracy train: 0.989742 val: 0.713433 test: 0.717536
max validation accuracy : 0.725373 max acc epoch : 40 test accuracy : 0.714568
Counter({2: 3495, 0: 2402, 1: 1503})

Epoch :  46 loss training:  18.58458898961544 Time :  16365
accuracy train: 0.992389 val: 0.725373 test: 0.714568
max validation accuracy : 0.725373 max acc epoch : 40 test accuracy : 0.714568
Counter({2: 3501, 1: 2402, 0: 1497})

Epoch :  47 loss training:  18.75146518740803 Time :  16432
accuracy train: 0.992720 val: 0.713433 test: 0.714816
max validation accuracy : 0.725373 max acc epoch : 40 test accuracy : 0.714568
Counter({1: 3495, 2: 2407, 0: 1498})

Epoch :  48 loss training:  17.386824779212475 Time :  16497
accuracy train: 0.994375 val: 0.710448 test: 0.717536
max validation accuracy : 0.725373 max acc epoch : 40 test accuracy : 0.714568
Counter({2: 3501, 1: 2404, 0: 1495})

Epoch :  49 loss training:  16.965013213455677 Time :  16566
accuracy train: 0.994705 val: 0.710448 test: 0.714321
max validation accuracy : 0.725373 max acc epoch : 40 test accuracy : 0.714568
Counter({2: 3498, 1: 2405, 0: 1497})

Epoch :  50 loss training:  16.500268670730293 Time :  16638
accuracy train: 0.995367 val: 0.716418 test: 0.717784
max validation accuracy : 0.725373 max acc epoch : 40 test accuracy : 0.714568
Counter({2: 3507, 1: 2404, 0: 1489})

Epoch :  51 loss training:  16.752963561564684 Time :  16702
accuracy train: 0.996029 val: 0.716418 test: 0.718031
max validation accuracy : 0.725373 max acc epoch : 40 test accuracy : 0.714568
Counter({1: 3511, 2: 2407, 0: 1482})

Epoch :  52 loss training:  14.55201053339988 Time :  16767
accuracy train: 0.995698 val: 0.716418 test: 0.717536
max validation accuracy : 0.725373 max acc epoch : 40 test accuracy : 0.714568
Counter({2: 3515, 0: 2406, 1: 1479})

Epoch :  53 loss training:  14.380142159759998 Time :  16836
accuracy train: 0.997022 val: 0.707463 test: 0.719515
max validation accuracy : 0.725373 max acc epoch : 40 test accuracy : 0.714568
Counter({0: 3512, 2: 2400, 1: 1488})

Epoch :  54 loss training:  14.084769265726209 Time :  16904
accuracy train: 0.995036 val: 0.710448 test: 0.716052
max validation accuracy : 0.725373 max acc epoch : 40 test accuracy : 0.714568
Counter({0: 3517, 1: 2404, 2: 1479})

Epoch :  55 loss training:  13.178962728008628 Time :  16953
accuracy train: 0.998015 val: 0.713433 test: 0.714816
max validation accuracy : 0.725373 max acc epoch : 40 test accuracy : 0.714568
Counter({0: 3526, 2: 2401, 1: 1473})

Epoch :  56 loss training:  13.816980730742216 Time :  17017
accuracy train: 0.995698 val: 0.731343 test: 0.717784
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({2: 3518, 0: 2401, 1: 1481})

Epoch :  57 loss training:  13.76875083707273 Time :  17082
accuracy train: 0.997684 val: 0.716418 test: 0.714321
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({1: 3526, 2: 2400, 0: 1474})

Epoch :  58 loss training:  13.488077918067575 Time :  17149
accuracy train: 0.999007 val: 0.710448 test: 0.718773
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({0: 3520, 2: 2405, 1: 1475})

Epoch :  59 loss training:  12.7507968172431 Time :  17221
accuracy train: 0.998345 val: 0.707463 test: 0.716300
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({1: 3522, 2: 2410, 0: 1468})

Epoch :  60 loss training:  10.732027539983392 Time :  17288
accuracy train: 0.999338 val: 0.707463 test: 0.717784
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({1: 3531, 0: 2408, 2: 1461})

Epoch :  61 loss training:  11.703737128525972 Time :  17360
accuracy train: 0.999007 val: 0.725373 test: 0.720999
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({0: 3540, 2: 2402, 1: 1458})

Epoch :  62 loss training:  11.020790258422494 Time :  17433
accuracy train: 0.997684 val: 0.716418 test: 0.717536
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({1: 3549, 2: 2394, 0: 1457})

Epoch :  63 loss training:  11.97156054340303 Time :  17498
accuracy train: 0.999669 val: 0.728358 test: 0.720752
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({1: 3547, 2: 2396, 0: 1457})

Epoch :  64 loss training:  10.291373485699296 Time :  17560
accuracy train: 0.999338 val: 0.722388 test: 0.720505
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({1: 3555, 0: 2400, 2: 1445})

Epoch :  65 loss training:  10.998808396980166 Time :  17624
accuracy train: 1.000000 val: 0.716418 test: 0.722483
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({0: 3553, 1: 2401, 2: 1446})

Epoch :  66 loss training:  11.754684694111347 Time :  17692
accuracy train: 0.998676 val: 0.719403 test: 0.715310
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({0: 3558, 1: 2395, 2: 1447})

Epoch :  67 loss training:  9.822549032047391 Time :  17760
accuracy train: 1.000000 val: 0.707463 test: 0.720999
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({0: 3551, 1: 2400, 2: 1449})

Epoch :  68 loss training:  8.569368215743452 Time :  17831
accuracy train: 1.000000 val: 0.710448 test: 0.712590
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({1: 3543, 0: 2399, 2: 1458})

Epoch :  69 loss training:  9.017762990668416 Time :  17902
accuracy train: 1.000000 val: 0.716418 test: 0.719021
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({0: 3538, 1: 2401, 2: 1461})

Epoch :  70 loss training:  8.76618524082005 Time :  17980
accuracy train: 1.000000 val: 0.731343 test: 0.720257
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({1: 3540, 0: 2400, 2: 1460})

Epoch :  71 loss training:  8.593496041372418 Time :  18056
accuracy train: 0.999669 val: 0.710448 test: 0.716300
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({1: 3553, 0: 2395, 2: 1452})

Epoch :  72 loss training:  8.435665480792522 Time :  18115
accuracy train: 0.999669 val: 0.713433 test: 0.714816
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({0: 3551, 2: 2391, 1: 1458})

Epoch :  73 loss training:  8.355674694292247 Time :  18181
accuracy train: 0.999669 val: 0.722388 test: 0.714568
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({2: 3548, 0: 2396, 1: 1456})

Epoch :  74 loss training:  8.621528601273894 Time :  18251
accuracy train: 0.999669 val: 0.698507 test: 0.717289
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({0: 3549, 2: 2396, 1: 1455})

Epoch :  75 loss training:  7.727072489447892 Time :  18323
accuracy train: 1.000000 val: 0.689552 test: 0.721989
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({2: 3545, 1: 2400, 0: 1455})

Epoch :  76 loss training:  8.074190482497215 Time :  18389
accuracy train: 1.000000 val: 0.713433 test: 0.717042
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({2: 3549, 0: 2397, 1: 1454})

Epoch :  77 loss training:  7.920465889852494 Time :  18450
accuracy train: 0.999669 val: 0.710448 test: 0.718279
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({1: 3573, 0: 2395, 2: 1432})

Epoch :  78 loss training:  7.347756683593616 Time :  18518
accuracy train: 1.000000 val: 0.698507 test: 0.716547
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({1: 3567, 0: 2390, 2: 1443})

Epoch :  79 loss training:  7.871027753688395 Time :  18584
accuracy train: 1.000000 val: 0.701493 test: 0.712342
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({0: 3577, 1: 2392, 2: 1431})

Epoch :  80 loss training:  7.379779873415828 Time :  18663
accuracy train: 1.000000 val: 0.716418 test: 0.716300
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({2: 3567, 1: 2396, 0: 1437})

Epoch :  81 loss training:  6.2724791704677045 Time :  18725
accuracy train: 1.000000 val: 0.716418 test: 0.718031
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({1: 3571, 0: 2395, 2: 1434})

Epoch :  82 loss training:  7.459767384454608 Time :  18795
accuracy train: 1.000000 val: 0.713433 test: 0.718773
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({2: 3575, 1: 2385, 0: 1440})

Epoch :  83 loss training:  6.981874838471413 Time :  18860
accuracy train: 1.000000 val: 0.710448 test: 0.719021
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({1: 3575, 2: 2386, 0: 1439})

Epoch :  84 loss training:  6.282499120105058 Time :  18924
accuracy train: 1.000000 val: 0.704478 test: 0.720257
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({1: 3575, 0: 2392, 2: 1433})

Epoch :  85 loss training:  6.062664343509823 Time :  18989
accuracy train: 1.000000 val: 0.719403 test: 0.717536
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({1: 3583, 2: 2384, 0: 1433})

Epoch :  86 loss training:  6.17719023139216 Time :  19055
accuracy train: 1.000000 val: 0.713433 test: 0.717784
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({0: 3571, 1: 2390, 2: 1439})

Epoch :  87 loss training:  6.5149266289081424 Time :  19121
accuracy train: 0.999669 val: 0.710448 test: 0.720999
max validation accuracy : 0.731343 max acc epoch : 56 test accuracy : 0.717784
Counter({0: 3576, 1: 2391, 2: 1433})

========================================================================================================================================================================================================
max acc epoch :  56
max validation accuracy :  0.7313432835820896
test accuracy :  0.7177838238931487
last test_accuracy :  0.7209992579767499
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.5, early_stop=30, epochs=400, filename='', hidden_dim=300, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=291, weight_decay=0)
device :  cuda:0
Counter({1: 3489, 2: 2484, 0: 1427})

Epoch :  1 loss training:  296.2252905368805 Time :  19697
accuracy train: 0.659166 val: 0.597015 test: 0.595597
max validation accuracy : 0.597015 max acc epoch : 1 test accuracy : 0.595597
Counter({1: 3461, 0: 2416, 2: 1523})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  185.48927730321884 Time :  19758
accuracy train: 0.736267 val: 0.602985 test: 0.648034
max validation accuracy : 0.602985 max acc epoch : 2 test accuracy : 0.648034
Counter({0: 3462, 1: 2393, 2: 1545})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  175.29412338137627 Time :  19825
accuracy train: 0.732627 val: 0.605970 test: 0.629978
max validation accuracy : 0.605970 max acc epoch : 3 test accuracy : 0.629978
Counter({0: 3456, 2: 2369, 1: 1575})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  114.58769565820694 Time :  19888
accuracy train: 0.808074 val: 0.656716 test: 0.700223
max validation accuracy : 0.656716 max acc epoch : 4 test accuracy : 0.700223
Counter({2: 3524, 1: 2401, 0: 1475})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  100.06840890645981 Time :  19963
accuracy train: 0.834216 val: 0.680597 test: 0.700717
max validation accuracy : 0.680597 max acc epoch : 5 test accuracy : 0.700717
Counter({0: 3471, 1: 2413, 2: 1516})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  91.44840542972088 Time :  20041
accuracy train: 0.832892 val: 0.638806 test: 0.692308
max validation accuracy : 0.680597 max acc epoch : 5 test accuracy : 0.700717
Counter({0: 3458, 2: 2420, 1: 1522})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  74.71136452257633 Time :  20114
accuracy train: 0.875579 val: 0.668657 test: 0.704427
max validation accuracy : 0.680597 max acc epoch : 5 test accuracy : 0.700717
Counter({1: 3409, 2: 2441, 0: 1550})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  67.0553020387888 Time :  20183
accuracy train: 0.870946 val: 0.698507 test: 0.701954
max validation accuracy : 0.698507 max acc epoch : 8 test accuracy : 0.701954
Counter({1: 3437, 2: 2430, 0: 1533})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.70699617266655 Time :  20251
accuracy train: 0.910324 val: 0.692537 test: 0.709374
max validation accuracy : 0.698507 max acc epoch : 8 test accuracy : 0.701954
Counter({2: 3439, 1: 2426, 0: 1535})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  54.44096753001213 Time :  20337
accuracy train: 0.901721 val: 0.695522 test: 0.710858
max validation accuracy : 0.698507 max acc epoch : 8 test accuracy : 0.701954
Counter({1: 3467, 0: 2415, 2: 1518})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  51.06963291764259 Time :  20405
accuracy train: 0.920913 val: 0.704478 test: 0.714321
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.714321
Counter({1: 3451, 2: 2427, 0: 1522})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  48.2184564396739 Time :  20478
accuracy train: 0.921244 val: 0.686567 test: 0.716052
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.714321
Counter({2: 3467, 0: 2423, 1: 1510})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  45.294676054269075 Time :  20544
accuracy train: 0.928193 val: 0.686567 test: 0.712590
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.714321
Counter({0: 3459, 1: 2427, 2: 1514})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  46.51040709018707 Time :  20616
accuracy train: 0.933157 val: 0.707463 test: 0.717536
max validation accuracy : 0.707463 max acc epoch : 14 test accuracy : 0.717536
Counter({0: 3454, 1: 2423, 2: 1523})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  44.90737849473953 Time :  20679
accuracy train: 0.932164 val: 0.698507 test: 0.713579
max validation accuracy : 0.707463 max acc epoch : 14 test accuracy : 0.717536
Counter({1: 3446, 0: 2428, 2: 1526})

Epoch :  16 loss training:  42.86323568969965 Time :  20750
accuracy train: 0.938120 val: 0.701493 test: 0.715063
max validation accuracy : 0.707463 max acc epoch : 14 test accuracy : 0.717536
Counter({1: 3458, 0: 2421, 2: 1521})

Epoch :  17 loss training:  43.31830299645662 Time :  20816
accuracy train: 0.936797 val: 0.701493 test: 0.713826
max validation accuracy : 0.707463 max acc epoch : 14 test accuracy : 0.717536
Counter({2: 3468, 0: 2416, 1: 1516})

Epoch :  18 loss training:  42.356385573744774 Time :  20878
accuracy train: 0.944408 val: 0.689552 test: 0.719763
max validation accuracy : 0.707463 max acc epoch : 14 test accuracy : 0.717536
Counter({2: 3462, 0: 2413, 1: 1525})

Epoch :  19 loss training:  38.99950581789017 Time :  20945
accuracy train: 0.949702 val: 0.719403 test: 0.716052
max validation accuracy : 0.719403 max acc epoch : 19 test accuracy : 0.716052
Counter({0: 3471, 2: 2418, 1: 1511})

Epoch :  20 loss training:  41.219251446425915 Time :  21009
accuracy train: 0.956651 val: 0.725373 test: 0.716794
max validation accuracy : 0.725373 max acc epoch : 20 test accuracy : 0.716794
Counter({1: 3474, 0: 2419, 2: 1507})

Epoch :  21 loss training:  37.470442429184914 Time :  21077
accuracy train: 0.949702 val: 0.734328 test: 0.716794
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({2: 3466, 1: 2423, 0: 1511})

Epoch :  22 loss training:  36.60204781591892 Time :  21140
accuracy train: 0.953342 val: 0.707463 test: 0.712342
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({2: 3453, 1: 2422, 0: 1525})

Epoch :  23 loss training:  36.611211985349655 Time :  21207
accuracy train: 0.957975 val: 0.719403 test: 0.717784
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({2: 3459, 1: 2420, 0: 1521})

Epoch :  24 loss training:  34.73462735116482 Time :  21277
accuracy train: 0.960953 val: 0.704478 test: 0.715558
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({1: 3459, 0: 2424, 2: 1517})

Epoch :  25 loss training:  33.59958294034004 Time :  21344
accuracy train: 0.966909 val: 0.707463 test: 0.722236
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({1: 3457, 0: 2423, 2: 1520})

Epoch :  26 loss training:  31.673558332026005 Time :  21386
accuracy train: 0.961946 val: 0.722388 test: 0.721247
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({1: 3467, 2: 2417, 0: 1516})

Epoch :  27 loss training:  30.637045681476593 Time :  21441
accuracy train: 0.973197 val: 0.719403 test: 0.718031
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({0: 3473, 1: 2417, 2: 1510})

Epoch :  28 loss training:  30.529520973563194 Time :  21503
accuracy train: 0.973527 val: 0.704478 test: 0.718031
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({0: 3463, 2: 2419, 1: 1518})

Epoch :  29 loss training:  30.206893771886826 Time :  21560
accuracy train: 0.975182 val: 0.707463 test: 0.716794
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({0: 3473, 2: 2419, 1: 1508})

Epoch :  30 loss training:  30.527911555022 Time :  21614
accuracy train: 0.975182 val: 0.713433 test: 0.707148
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({1: 3476, 0: 2421, 2: 1503})

Epoch :  31 loss training:  27.960057586431503 Time :  21671
accuracy train: 0.978491 val: 0.713433 test: 0.713826
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({1: 3486, 2: 2416, 0: 1498})

Epoch :  32 loss training:  28.4871958643198 Time :  21725
accuracy train: 0.978491 val: 0.713433 test: 0.711600
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({2: 3492, 0: 2418, 1: 1490})

Epoch :  33 loss training:  26.146580308675766 Time :  21787
accuracy train: 0.982793 val: 0.710448 test: 0.717536
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({0: 3476, 2: 2412, 1: 1512})

Epoch :  34 loss training:  25.49436056241393 Time :  21852
accuracy train: 0.981800 val: 0.710448 test: 0.717289
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({1: 3474, 2: 2405, 0: 1521})

Epoch :  35 loss training:  23.848053313791752 Time :  21913
accuracy train: 0.987426 val: 0.713433 test: 0.721494
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({2: 3472, 1: 2403, 0: 1525})

Epoch :  36 loss training:  23.624679815024137 Time :  21976
accuracy train: 0.986102 val: 0.701493 test: 0.718031
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({1: 3459, 0: 2400, 2: 1541})

Epoch :  37 loss training:  23.649427756667137 Time :  22044
accuracy train: 0.989411 val: 0.686567 test: 0.716052
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({2: 3490, 0: 2400, 1: 1510})

Epoch :  38 loss training:  24.006153203547 Time :  22102
accuracy train: 0.991396 val: 0.698507 test: 0.715558
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({0: 3513, 1: 2395, 2: 1492})

Epoch :  39 loss training:  22.964740542694926 Time :  22162
accuracy train: 0.989080 val: 0.713433 test: 0.714321
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({1: 3497, 2: 2396, 0: 1507})

Epoch :  40 loss training:  20.192015651613474 Time :  22218
accuracy train: 0.991066 val: 0.719403 test: 0.715310
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({2: 3506, 1: 2398, 0: 1496})

Epoch :  41 loss training:  20.584668822586536 Time :  22270
accuracy train: 0.992058 val: 0.689552 test: 0.710611
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({2: 3491, 1: 2398, 0: 1511})

Epoch :  42 loss training:  18.4491337351501 Time :  22319
accuracy train: 0.990735 val: 0.710448 test: 0.712837
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({1: 3497, 0: 2395, 2: 1508})

Epoch :  43 loss training:  19.225646637380123 Time :  22363
accuracy train: 0.995036 val: 0.695522 test: 0.719268
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({1: 3507, 2: 2393, 0: 1500})

Epoch :  44 loss training:  19.036100294440985 Time :  22396
accuracy train: 0.992720 val: 0.707463 test: 0.719021
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({0: 3510, 1: 2392, 2: 1498})

Epoch :  45 loss training:  18.36591518856585 Time :  22443
accuracy train: 0.993051 val: 0.716418 test: 0.717536
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({1: 3496, 2: 2394, 0: 1510})

Epoch :  46 loss training:  18.352678179740906 Time :  22491
accuracy train: 0.993713 val: 0.710448 test: 0.721741
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({0: 3512, 2: 2389, 1: 1499})

Epoch :  47 loss training:  16.330776972696185 Time :  22538
accuracy train: 0.996029 val: 0.710448 test: 0.715805
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({2: 3504, 1: 2404, 0: 1492})

Epoch :  48 loss training:  16.37495299614966 Time :  22583
accuracy train: 0.996029 val: 0.710448 test: 0.716052
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({1: 3513, 2: 2408, 0: 1479})

Epoch :  49 loss training:  16.205649070441723 Time :  22628
accuracy train: 0.996691 val: 0.713433 test: 0.712342
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({2: 3512, 1: 2399, 0: 1489})

Epoch :  50 loss training:  14.985995838418603 Time :  22674
accuracy train: 0.996360 val: 0.725373 test: 0.719515
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({1: 3518, 2: 2393, 0: 1489})

Epoch :  51 loss training:  15.694075805135071 Time :  22719
accuracy train: 0.998015 val: 0.710448 test: 0.719268
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({2: 3527, 0: 2400, 1: 1473})

Epoch :  52 loss training:  14.664465729147196 Time :  22767
accuracy train: 0.995698 val: 0.731343 test: 0.718031
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({0: 3540, 1: 2401, 2: 1459})

========================================================================================================================================================================================================
max acc epoch :  21
max validation accuracy :  0.7343283582089553
test accuracy :  0.7167944595597329
last test_accuracy :  0.7180311649765025
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.5, early_stop=30, epochs=400, filename='', hidden_dim=300, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=291, weight_decay=0)
device :  cuda:0
Counter({1: 3489, 2: 2484, 0: 1427})

Epoch :  1 loss training:  296.24553537368774 Time :  23123
accuracy train: 0.662475 val: 0.611940 test: 0.599307
max validation accuracy : 0.611940 max acc epoch : 1 test accuracy : 0.599307
Counter({1: 3423, 2: 2410, 0: 1567})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  184.1462646126747 Time :  23176
accuracy train: 0.728657 val: 0.573134 test: 0.639129
max validation accuracy : 0.611940 max acc epoch : 1 test accuracy : 0.599307
Counter({1: 3453, 0: 2403, 2: 1544})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  171.64901196956635 Time :  23231
accuracy train: 0.723362 val: 0.576119 test: 0.623547
max validation accuracy : 0.611940 max acc epoch : 1 test accuracy : 0.599307
Counter({2: 3465, 0: 2378, 1: 1557})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  113.77912098169327 Time :  23281
accuracy train: 0.814361 val: 0.674627 test: 0.697007
max validation accuracy : 0.674627 max acc epoch : 4 test accuracy : 0.697007
Counter({1: 3484, 0: 2418, 2: 1498})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  102.14862388372421 Time :  23332
accuracy train: 0.828590 val: 0.665672 test: 0.689587
max validation accuracy : 0.674627 max acc epoch : 4 test accuracy : 0.697007
Counter({2: 3465, 1: 2421, 0: 1514})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  91.56445275247097 Time :  23398
accuracy train: 0.816016 val: 0.635821 test: 0.665100
max validation accuracy : 0.674627 max acc epoch : 4 test accuracy : 0.697007
Counter({1: 3460, 0: 2423, 2: 1517})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  73.34309020638466 Time :  23471
accuracy train: 0.873594 val: 0.662687 test: 0.700717
max validation accuracy : 0.674627 max acc epoch : 4 test accuracy : 0.697007
Counter({0: 3451, 2: 2433, 1: 1516})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  67.48741316795349 Time :  23526
accuracy train: 0.863005 val: 0.674627 test: 0.694286
max validation accuracy : 0.674627 max acc epoch : 4 test accuracy : 0.697007
Counter({1: 3457, 0: 2422, 2: 1521})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.70843033492565 Time :  23577
accuracy train: 0.904037 val: 0.677612 test: 0.707148
max validation accuracy : 0.677612 max acc epoch : 9 test accuracy : 0.707148
Counter({2: 3436, 0: 2427, 1: 1537})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  54.762983582913876 Time :  23640
accuracy train: 0.894441 val: 0.680597 test: 0.707395
max validation accuracy : 0.680597 max acc epoch : 10 test accuracy : 0.707395
Counter({1: 3445, 0: 2418, 2: 1537})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  50.42325019836426 Time :  23695
accuracy train: 0.918266 val: 0.701493 test: 0.713084
max validation accuracy : 0.701493 max acc epoch : 11 test accuracy : 0.713084
Counter({1: 3445, 0: 2427, 2: 1528})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  48.332446336746216 Time :  23742
accuracy train: 0.913964 val: 0.701493 test: 0.713826
max validation accuracy : 0.701493 max acc epoch : 11 test accuracy : 0.713084
Counter({2: 3441, 0: 2433, 1: 1526})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  46.12105044722557 Time :  23805
accuracy train: 0.925215 val: 0.677612 test: 0.708880
max validation accuracy : 0.701493 max acc epoch : 11 test accuracy : 0.713084
Counter({1: 3441, 2: 2426, 0: 1533})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  46.4903629347682 Time :  23865
accuracy train: 0.928193 val: 0.707463 test: 0.711848
max validation accuracy : 0.707463 max acc epoch : 14 test accuracy : 0.711848
Counter({2: 3440, 1: 2425, 0: 1535})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  44.56682924181223 Time :  23922
accuracy train: 0.931502 val: 0.689552 test: 0.709127
max validation accuracy : 0.707463 max acc epoch : 14 test accuracy : 0.711848
Counter({0: 3440, 1: 2427, 2: 1533})

Epoch :  16 loss training:  44.35389914363623 Time :  23984
accuracy train: 0.937128 val: 0.701493 test: 0.715063
max validation accuracy : 0.707463 max acc epoch : 14 test accuracy : 0.711848
Counter({1: 3442, 0: 2424, 2: 1534})

Epoch :  17 loss training:  44.62161023914814 Time :  24035
accuracy train: 0.930841 val: 0.704478 test: 0.714321
max validation accuracy : 0.707463 max acc epoch : 14 test accuracy : 0.711848
Counter({2: 3444, 0: 2422, 1: 1534})

Epoch :  18 loss training:  42.53072492033243 Time :  24091
accuracy train: 0.944408 val: 0.695522 test: 0.715558
max validation accuracy : 0.707463 max acc epoch : 14 test accuracy : 0.711848
Counter({2: 3445, 1: 2422, 0: 1533})

Epoch :  19 loss training:  39.157431684434414 Time :  24147
accuracy train: 0.949371 val: 0.701493 test: 0.716547
max validation accuracy : 0.707463 max acc epoch : 14 test accuracy : 0.711848
Counter({0: 3439, 1: 2428, 2: 1533})

Epoch :  20 loss training:  40.382607102394104 Time :  24202
accuracy train: 0.956320 val: 0.716418 test: 0.717536
max validation accuracy : 0.716418 max acc epoch : 20 test accuracy : 0.717536
Counter({1: 3440, 0: 2428, 2: 1532})

Epoch :  21 loss training:  37.8625585436821 Time :  24272
accuracy train: 0.948709 val: 0.695522 test: 0.715558
max validation accuracy : 0.716418 max acc epoch : 20 test accuracy : 0.717536
Counter({0: 3445, 1: 2426, 2: 1529})

Epoch :  22 loss training:  36.35735533386469 Time :  24331
accuracy train: 0.953011 val: 0.701493 test: 0.707890
max validation accuracy : 0.716418 max acc epoch : 20 test accuracy : 0.717536
Counter({1: 3438, 0: 2432, 2: 1530})

Epoch :  23 loss training:  37.35364355891943 Time :  24392
accuracy train: 0.960291 val: 0.707463 test: 0.714074
max validation accuracy : 0.716418 max acc epoch : 20 test accuracy : 0.717536
Counter({1: 3439, 2: 2435, 0: 1526})

Epoch :  24 loss training:  34.978195294737816 Time :  24446
accuracy train: 0.960953 val: 0.683582 test: 0.715558
max validation accuracy : 0.716418 max acc epoch : 20 test accuracy : 0.717536
Counter({0: 3444, 1: 2429, 2: 1527})

Epoch :  25 loss training:  34.732461877167225 Time :  24503
accuracy train: 0.967571 val: 0.713433 test: 0.717536
max validation accuracy : 0.716418 max acc epoch : 20 test accuracy : 0.717536
Counter({1: 3440, 0: 2432, 2: 1528})

Epoch :  26 loss training:  31.517006047070026 Time :  24562
accuracy train: 0.964262 val: 0.710448 test: 0.718279
max validation accuracy : 0.716418 max acc epoch : 20 test accuracy : 0.717536
Counter({0: 3448, 1: 2419, 2: 1533})

Epoch :  27 loss training:  32.08792872726917 Time :  24610
accuracy train: 0.967571 val: 0.707463 test: 0.716794
max validation accuracy : 0.716418 max acc epoch : 20 test accuracy : 0.717536
Counter({2: 3448, 0: 2420, 1: 1532})

Epoch :  28 loss training:  29.958032887429 Time :  24675
accuracy train: 0.977167 val: 0.698507 test: 0.715310
max validation accuracy : 0.716418 max acc epoch : 20 test accuracy : 0.717536
Counter({0: 3440, 1: 2426, 2: 1534})

Epoch :  29 loss training:  30.08193691074848 Time :  24734
accuracy train: 0.976837 val: 0.701493 test: 0.713332
max validation accuracy : 0.716418 max acc epoch : 20 test accuracy : 0.717536
Counter({0: 3450, 1: 2426, 2: 1524})

Epoch :  30 loss training:  30.969182323664427 Time :  24798
accuracy train: 0.974851 val: 0.707463 test: 0.707148
max validation accuracy : 0.716418 max acc epoch : 20 test accuracy : 0.717536
Counter({0: 3450, 1: 2422, 2: 1528})

Epoch :  31 loss training:  28.91667963564396 Time :  24853
accuracy train: 0.973197 val: 0.710448 test: 0.717042
max validation accuracy : 0.716418 max acc epoch : 20 test accuracy : 0.717536
Counter({1: 3454, 0: 2419, 2: 1527})

Epoch :  32 loss training:  28.8088765963912 Time :  24906
accuracy train: 0.977498 val: 0.713433 test: 0.718031
max validation accuracy : 0.716418 max acc epoch : 20 test accuracy : 0.717536
Counter({2: 3459, 0: 2423, 1: 1518})

Epoch :  33 loss training:  25.867023520171642 Time :  24957
accuracy train: 0.980477 val: 0.716418 test: 0.717536
max validation accuracy : 0.716418 max acc epoch : 20 test accuracy : 0.717536
Counter({1: 3458, 0: 2422, 2: 1520})

Epoch :  34 loss training:  25.468512773513794 Time :  25017
accuracy train: 0.981469 val: 0.710448 test: 0.716794
max validation accuracy : 0.716418 max acc epoch : 20 test accuracy : 0.717536
Counter({0: 3461, 1: 2415, 2: 1524})

Epoch :  35 loss training:  24.669876858592033 Time :  25077
accuracy train: 0.985771 val: 0.719403 test: 0.715558
max validation accuracy : 0.719403 max acc epoch : 35 test accuracy : 0.715558
Counter({2: 3451, 1: 2418, 0: 1531})

Epoch :  36 loss training:  24.801702488213778 Time :  25115
accuracy train: 0.986102 val: 0.710448 test: 0.716300
max validation accuracy : 0.719403 max acc epoch : 35 test accuracy : 0.715558
Counter({2: 3454, 0: 2414, 1: 1532})

Epoch :  37 loss training:  24.492309872061014 Time :  25180
accuracy train: 0.986764 val: 0.695522 test: 0.712095
max validation accuracy : 0.719403 max acc epoch : 35 test accuracy : 0.715558
Counter({2: 3467, 1: 2418, 0: 1515})

Epoch :  38 loss training:  24.633927015587687 Time :  25231
accuracy train: 0.990073 val: 0.695522 test: 0.714321
max validation accuracy : 0.719403 max acc epoch : 35 test accuracy : 0.715558
Counter({0: 3474, 2: 2415, 1: 1511})

Epoch :  39 loss training:  22.744627680629492 Time :  25282
accuracy train: 0.990404 val: 0.713433 test: 0.715063
max validation accuracy : 0.719403 max acc epoch : 35 test accuracy : 0.715558
Counter({0: 3474, 1: 2415, 2: 1511})

Epoch :  40 loss training:  20.819597147405148 Time :  25336
accuracy train: 0.988749 val: 0.716418 test: 0.714816
max validation accuracy : 0.719403 max acc epoch : 35 test accuracy : 0.715558
Counter({0: 3469, 1: 2414, 2: 1517})

Epoch :  41 loss training:  20.653998577967286 Time :  25394
accuracy train: 0.990735 val: 0.698507 test: 0.707643
max validation accuracy : 0.719403 max acc epoch : 35 test accuracy : 0.715558
Counter({1: 3474, 2: 2415, 0: 1511})

Epoch :  42 loss training:  18.81669544428587 Time :  25449
accuracy train: 0.990735 val: 0.704478 test: 0.714816
max validation accuracy : 0.719403 max acc epoch : 35 test accuracy : 0.715558
Counter({2: 3490, 1: 2410, 0: 1500})

Epoch :  43 loss training:  20.680429596453905 Time :  25508
accuracy train: 0.991396 val: 0.713433 test: 0.715558
max validation accuracy : 0.719403 max acc epoch : 35 test accuracy : 0.715558
Counter({1: 3480, 0: 2411, 2: 1509})

Epoch :  44 loss training:  19.650648023933172 Time :  25560
accuracy train: 0.992389 val: 0.707463 test: 0.717536
max validation accuracy : 0.719403 max acc epoch : 35 test accuracy : 0.715558
Counter({0: 3490, 1: 2408, 2: 1502})

Epoch :  45 loss training:  18.98118250258267 Time :  25613
accuracy train: 0.991727 val: 0.716418 test: 0.720752
max validation accuracy : 0.719403 max acc epoch : 35 test accuracy : 0.715558
Counter({2: 3487, 0: 2406, 1: 1507})

Epoch :  46 loss training:  17.88498656824231 Time :  25664
accuracy train: 0.995367 val: 0.713433 test: 0.716052
max validation accuracy : 0.719403 max acc epoch : 35 test accuracy : 0.715558
Counter({2: 3478, 0: 2409, 1: 1513})

Epoch :  47 loss training:  17.30720739532262 Time :  25721
accuracy train: 0.993051 val: 0.710448 test: 0.716052
max validation accuracy : 0.719403 max acc epoch : 35 test accuracy : 0.715558
Counter({2: 3494, 0: 2406, 1: 1500})

Epoch :  48 loss training:  15.663814552128315 Time :  25767
accuracy train: 0.994705 val: 0.695522 test: 0.719515
max validation accuracy : 0.719403 max acc epoch : 35 test accuracy : 0.715558
Counter({1: 3495, 2: 2407, 0: 1498})

Epoch :  49 loss training:  16.784394569694996 Time :  25806
accuracy train: 0.997684 val: 0.695522 test: 0.719021
max validation accuracy : 0.719403 max acc epoch : 35 test accuracy : 0.715558
Counter({2: 3498, 0: 2417, 1: 1485})

Epoch :  50 loss training:  15.56408931966871 Time :  25856
accuracy train: 0.996691 val: 0.728358 test: 0.719021
max validation accuracy : 0.728358 max acc epoch : 50 test accuracy : 0.719021
Counter({0: 3511, 1: 2412, 2: 1477})

Epoch :  51 loss training:  15.652635350823402 Time :  25904
accuracy train: 0.997353 val: 0.716418 test: 0.718031
max validation accuracy : 0.728358 max acc epoch : 50 test accuracy : 0.719021
Counter({1: 3504, 2: 2419, 0: 1477})

Epoch :  52 loss training:  14.567972186021507 Time :  25959
accuracy train: 0.996360 val: 0.725373 test: 0.714321
max validation accuracy : 0.728358 max acc epoch : 50 test accuracy : 0.719021
Counter({1: 3508, 0: 2419, 2: 1473})

Epoch :  53 loss training:  14.347780108451843 Time :  26007
accuracy train: 0.998676 val: 0.710448 test: 0.715558
max validation accuracy : 0.728358 max acc epoch : 50 test accuracy : 0.719021
Counter({2: 3513, 0: 2409, 1: 1478})

Epoch :  54 loss training:  13.480951100587845 Time :  26059
accuracy train: 0.995367 val: 0.722388 test: 0.716547
max validation accuracy : 0.728358 max acc epoch : 50 test accuracy : 0.719021
Counter({0: 3509, 1: 2404, 2: 1487})

Epoch :  55 loss training:  13.060835637152195 Time :  26111
accuracy train: 0.997684 val: 0.719403 test: 0.713826
max validation accuracy : 0.728358 max acc epoch : 50 test accuracy : 0.719021
Counter({2: 3527, 1: 2400, 0: 1473})

Epoch :  56 loss training:  13.561332461424172 Time :  26158
accuracy train: 0.996360 val: 0.734328 test: 0.716300
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({1: 3517, 0: 2402, 2: 1481})

Epoch :  57 loss training:  12.671053357422352 Time :  26207
accuracy train: 0.998015 val: 0.713433 test: 0.712590
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({1: 3517, 2: 2408, 0: 1475})

Epoch :  58 loss training:  11.999003516510129 Time :  26255
accuracy train: 0.999007 val: 0.716418 test: 0.719268
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({0: 3516, 1: 2412, 2: 1472})

Epoch :  59 loss training:  12.285584365949035 Time :  26305
accuracy train: 0.997684 val: 0.713433 test: 0.716052
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({1: 3510, 2: 2408, 0: 1482})

Epoch :  60 loss training:  11.337884014472365 Time :  26355
accuracy train: 0.998345 val: 0.731343 test: 0.715558
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({1: 3517, 0: 2415, 2: 1468})

Epoch :  61 loss training:  11.274022057652473 Time :  26406
accuracy train: 0.999338 val: 0.719403 test: 0.715805
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({1: 3509, 2: 2413, 0: 1478})

Epoch :  62 loss training:  11.089691306464374 Time :  26457
accuracy train: 0.999007 val: 0.704478 test: 0.715558
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({0: 3490, 1: 2410, 2: 1500})

Epoch :  63 loss training:  10.375347494147718 Time :  26509
accuracy train: 0.999338 val: 0.710448 test: 0.712590
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({0: 3487, 2: 2405, 1: 1508})

Epoch :  64 loss training:  11.216987252235413 Time :  26560
accuracy train: 0.999007 val: 0.704478 test: 0.713084
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({1: 3488, 2: 2409, 0: 1503})

Epoch :  65 loss training:  9.969766711816192 Time :  26615
accuracy train: 0.999007 val: 0.704478 test: 0.716794
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({2: 3488, 1: 2411, 0: 1501})

Epoch :  66 loss training:  9.941874283365905 Time :  26662
accuracy train: 0.999007 val: 0.722388 test: 0.719021
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({1: 3490, 0: 2416, 2: 1494})

Epoch :  67 loss training:  9.933003288228065 Time :  26715
accuracy train: 0.999669 val: 0.731343 test: 0.715805
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({1: 3502, 2: 2417, 0: 1481})

Epoch :  68 loss training:  8.50901085883379 Time :  26766
accuracy train: 0.999669 val: 0.719403 test: 0.717289
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({2: 3510, 1: 2420, 0: 1470})

Epoch :  69 loss training:  9.78876171214506 Time :  26818
accuracy train: 0.999007 val: 0.713433 test: 0.716547
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({1: 3516, 2: 2414, 0: 1470})

Epoch :  70 loss training:  9.29698251071386 Time :  26865
accuracy train: 1.000000 val: 0.713433 test: 0.719021
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({2: 3525, 0: 2418, 1: 1457})

Epoch :  71 loss training:  8.399422174086794 Time :  26919
accuracy train: 0.999007 val: 0.716418 test: 0.717289
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({1: 3537, 0: 2410, 2: 1453})

Epoch :  72 loss training:  8.8423021719791 Time :  26971
accuracy train: 0.999007 val: 0.728358 test: 0.718279
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({1: 3536, 0: 2410, 2: 1454})

Epoch :  73 loss training:  8.633144952356815 Time :  27012
accuracy train: 1.000000 val: 0.731343 test: 0.716794
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({2: 3536, 0: 2413, 1: 1451})

Epoch :  74 loss training:  8.326594068668783 Time :  27064
accuracy train: 0.999669 val: 0.719403 test: 0.718526
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({2: 3542, 0: 2411, 1: 1447})

Epoch :  75 loss training:  8.202898892108351 Time :  27110
accuracy train: 1.000000 val: 0.728358 test: 0.718031
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({0: 3543, 2: 2415, 1: 1442})

Epoch :  76 loss training:  7.9677135068923235 Time :  27158
accuracy train: 0.999669 val: 0.725373 test: 0.715063
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({1: 3538, 2: 2413, 0: 1449})

Epoch :  77 loss training:  8.02871901076287 Time :  27207
accuracy train: 1.000000 val: 0.716418 test: 0.714074
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({1: 3535, 2: 2416, 0: 1449})

Epoch :  78 loss training:  7.648689824156463 Time :  27257
accuracy train: 1.000000 val: 0.719403 test: 0.714074
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({0: 3542, 2: 2409, 1: 1449})

Epoch :  79 loss training:  6.627030338626355 Time :  27309
accuracy train: 1.000000 val: 0.734328 test: 0.713579
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({0: 3549, 1: 2408, 2: 1443})

Epoch :  80 loss training:  6.03815845027566 Time :  27360
accuracy train: 1.000000 val: 0.719403 test: 0.713579
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({1: 3545, 0: 2408, 2: 1447})

Epoch :  81 loss training:  6.798430960159749 Time :  27410
accuracy train: 1.000000 val: 0.719403 test: 0.718279
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({0: 3540, 2: 2411, 1: 1449})

Epoch :  82 loss training:  6.953579253517091 Time :  27457
accuracy train: 0.999669 val: 0.734328 test: 0.720257
max validation accuracy : 0.734328 max acc epoch : 56 test accuracy : 0.716300
Counter({0: 3543, 2: 2411, 1: 1446})

Epoch :  83 loss training:  6.115269870497286 Time :  27506
accuracy train: 0.999669 val: 0.740299 test: 0.713579
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({0: 3553, 1: 2415, 2: 1432})

Epoch :  84 loss training:  6.011875675991178 Time :  27553
accuracy train: 1.000000 val: 0.728358 test: 0.719021
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({1: 3561, 0: 2415, 2: 1424})

Epoch :  85 loss training:  5.950341606512666 Time :  27596
accuracy train: 0.999669 val: 0.731343 test: 0.716300
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({2: 3571, 1: 2410, 0: 1419})

Epoch :  86 loss training:  6.646767806727439 Time :  27645
accuracy train: 1.000000 val: 0.722388 test: 0.720999
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({2: 3561, 1: 2410, 0: 1429})

Epoch :  87 loss training:  6.153817856684327 Time :  27693
accuracy train: 0.999007 val: 0.710448 test: 0.707643
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({0: 3545, 2: 2404, 1: 1451})

Epoch :  88 loss training:  6.17607608390972 Time :  27746
accuracy train: 0.999669 val: 0.737313 test: 0.713579
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({0: 3571, 2: 2409, 1: 1420})

Epoch :  89 loss training:  5.626242375466973 Time :  27798
accuracy train: 1.000000 val: 0.722388 test: 0.720257
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({1: 3572, 0: 2411, 2: 1417})

Epoch :  90 loss training:  5.969996537081897 Time :  27837
accuracy train: 0.999669 val: 0.737313 test: 0.717289
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({2: 3568, 1: 2411, 0: 1421})

Epoch :  91 loss training:  4.999830435961485 Time :  27889
accuracy train: 1.000000 val: 0.722388 test: 0.716794
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({1: 3544, 2: 2411, 0: 1445})

Epoch :  92 loss training:  5.275247860699892 Time :  27953
accuracy train: 1.000000 val: 0.725373 test: 0.718526
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({1: 3539, 0: 2410, 2: 1451})

Epoch :  93 loss training:  5.3860416687093675 Time :  28004
accuracy train: 1.000000 val: 0.719403 test: 0.719021
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({0: 3555, 1: 2409, 2: 1436})

Epoch :  94 loss training:  5.4070489960722625 Time :  28053
accuracy train: 0.999669 val: 0.725373 test: 0.711106
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({0: 3550, 1: 2411, 2: 1439})

Epoch :  95 loss training:  4.706320375204086 Time :  28104
accuracy train: 1.000000 val: 0.731343 test: 0.720010
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({1: 3568, 2: 2414, 0: 1418})

Epoch :  96 loss training:  4.909083952312358 Time :  28148
accuracy train: 1.000000 val: 0.734328 test: 0.716794
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({1: 3578, 0: 2418, 2: 1404})

Epoch :  97 loss training:  4.162056538509205 Time :  28199
accuracy train: 1.000000 val: 0.728358 test: 0.718773
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({1: 3583, 2: 2414, 0: 1403})

Epoch :  98 loss training:  4.290888414019719 Time :  28250
accuracy train: 1.000000 val: 0.725373 test: 0.720752
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({0: 3587, 2: 2410, 1: 1403})

Epoch :  99 loss training:  4.6627682654652745 Time :  28301
accuracy train: 1.000000 val: 0.722388 test: 0.718773
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({1: 3585, 2: 2408, 0: 1407})

Epoch :  100 loss training:  4.78577712608967 Time :  28349
accuracy train: 0.999669 val: 0.716418 test: 0.716300
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({2: 3588, 1: 2409, 0: 1403})

Epoch :  101 loss training:  4.170243745553307 Time :  28402
accuracy train: 1.000000 val: 0.725373 test: 0.716300
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({2: 3592, 0: 2404, 1: 1404})

Epoch :  102 loss training:  4.0660630443599075 Time :  28437
accuracy train: 1.000000 val: 0.734328 test: 0.709869
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({0: 3591, 1: 2406, 2: 1403})

Epoch :  103 loss training:  4.125966217368841 Time :  28488
accuracy train: 1.000000 val: 0.728358 test: 0.718279
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({0: 3588, 2: 2411, 1: 1401})

Epoch :  104 loss training:  3.759962924057618 Time :  28537
accuracy train: 1.000000 val: 0.725373 test: 0.715558
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({1: 3585, 2: 2412, 0: 1403})

Epoch :  105 loss training:  3.981127051403746 Time :  28583
accuracy train: 1.000000 val: 0.728358 test: 0.717042
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({0: 3589, 2: 2421, 1: 1390})

Epoch :  106 loss training:  4.265490616671741 Time :  28631
accuracy train: 1.000000 val: 0.740299 test: 0.721494
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({1: 3589, 2: 2415, 0: 1396})

Epoch :  107 loss training:  3.4301960736047477 Time :  28676
accuracy train: 1.000000 val: 0.734328 test: 0.716547
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({1: 3586, 2: 2418, 0: 1396})

Epoch :  108 loss training:  3.909155623987317 Time :  28720
accuracy train: 1.000000 val: 0.710448 test: 0.713826
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({2: 3577, 1: 2420, 0: 1403})

Epoch :  109 loss training:  3.507261131773703 Time :  28766
accuracy train: 1.000000 val: 0.728358 test: 0.714816
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({0: 3579, 1: 2414, 2: 1407})

Epoch :  110 loss training:  4.181809448054992 Time :  28815
accuracy train: 1.000000 val: 0.719403 test: 0.715063
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({0: 3582, 2: 2407, 1: 1411})

Epoch :  111 loss training:  3.868206315091811 Time :  28864
accuracy train: 1.000000 val: 0.728358 test: 0.719763
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({0: 3584, 1: 2402, 2: 1414})

Epoch :  112 loss training:  3.653198747197166 Time :  28917
accuracy train: 1.000000 val: 0.722388 test: 0.713579
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({1: 3571, 0: 2404, 2: 1425})

Epoch :  113 loss training:  4.104793705046177 Time :  28963
accuracy train: 1.000000 val: 0.731343 test: 0.716300
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({0: 3562, 1: 2405, 2: 1433})

Epoch :  114 loss training:  3.6910421068314463 Time :  29009
accuracy train: 1.000000 val: 0.731343 test: 0.722483
max validation accuracy : 0.740299 max acc epoch : 83 test accuracy : 0.713579
Counter({0: 3554, 1: 2409, 2: 1437})

========================================================================================================================================================================================================
max acc epoch :  83
max validation accuracy :  0.7402985074626866
test accuracy :  0.7135790254761316
last test_accuracy :  0.7224833044768736
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.73433 	 test_accuracy : 0.72595 	 max_acc epoch :  33 	 last test_accuracy : 0.72273
k :  1 	 val_accuracy : 0.73433 	 test_accuracy : 0.72149 	 max_acc epoch :  60 	 last test_accuracy : 0.72496
k :  2 	 val_accuracy : 0.73134 	 test_accuracy : 0.71778 	 max_acc epoch :  56 	 last test_accuracy : 0.72100
k :  3 	 val_accuracy : 0.73433 	 test_accuracy : 0.71679 	 max_acc epoch :  21 	 last test_accuracy : 0.71803
k :  4 	 val_accuracy : 0.74030 	 test_accuracy : 0.71358 	 max_acc epoch :  83 	 last test_accuracy : 0.72248

avg :  	 val_accuracy : 0.73493 	 test_accuracy : 0.71912 	 last_accuracy : 0.72184
