

date and time :  Fri May  7 21:32:39 2021
Namespace(batch_size=32, dataset='ohsumed', device=0, dropout=0.5, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  494.8683705329895 Time :  29
accuracy train: 0.588021 val: 0.576119 test: 0.559980
max validation accuracy : 0.576119 max acc epoch : 1 test accuracy : 0.559980
Epoch-1 lr: 0.001

Epoch :  2 loss training:  342.3949432373047 Time :  63
accuracy train: 0.682660 val: 0.632836 test: 0.643829
max validation accuracy : 0.632836 max acc epoch : 2 test accuracy : 0.643829
Epoch-2 lr: 0.001

Epoch :  3 loss training:  289.57610231637955 Time :  96
accuracy train: 0.707809 val: 0.671642 test: 0.655454
max validation accuracy : 0.671642 max acc epoch : 3 test accuracy : 0.655454
Epoch-3 lr: 0.001

Epoch :  4 loss training:  271.43392276763916 Time :  129
accuracy train: 0.721377 val: 0.644776 test: 0.646797
max validation accuracy : 0.671642 max acc epoch : 3 test accuracy : 0.655454
Epoch-4 lr: 0.001

Epoch :  5 loss training:  251.48048770427704 Time :  162
accuracy train: 0.717075 val: 0.650746 test: 0.654712
max validation accuracy : 0.671642 max acc epoch : 3 test accuracy : 0.655454
Epoch-5 lr: 0.001

Epoch :  6 loss training:  241.60787081718445 Time :  195
accuracy train: 0.747518 val: 0.674627 test: 0.678704
max validation accuracy : 0.674627 max acc epoch : 6 test accuracy : 0.678704
Counter({10: 1237, 4: 1043, 3: 809, 0: 687, 1: 610, 2: 577, 6: 450, 5: 448, 8: 436, 9: 410, 11: 405, 7: 288})
Epoch-6 lr: 0.001

Epoch :  7 loss training:  385.8938754796982 Time :  230
accuracy train: 0.722369 val: 0.665672 test: 0.662132
max validation accuracy : 0.674627 max acc epoch : 6 test accuracy : 0.678704
Epoch-7 lr: 0.001

Epoch :  8 loss training:  303.26636350154877 Time :  263
accuracy train: 0.737922 val: 0.671642 test: 0.668068
max validation accuracy : 0.674627 max acc epoch : 6 test accuracy : 0.678704
Counter({2: 1340, 3: 1218, 7: 659, 6: 563, 10: 529, 4: 527, 0: 511, 5: 438, 1: 432, 11: 410, 9: 402, 8: 371})
Epoch-8 lr: 0.001

Epoch :  9 loss training:  265.3024809360504 Time :  298
accuracy train: 0.768365 val: 0.707463 test: 0.677715
max validation accuracy : 0.707463 max acc epoch : 9 test accuracy : 0.677715
Epoch-9 lr: 0.001

Epoch :  10 loss training:  259.95096933841705 Time :  331
accuracy train: 0.743216 val: 0.716418 test: 0.666832
max validation accuracy : 0.716418 max acc epoch : 10 test accuracy : 0.666832
Counter({6: 1316, 9: 1128, 1: 812, 10: 741, 0: 613, 11: 554, 4: 432, 3: 393, 7: 386, 5: 379, 8: 374, 2: 272})
Epoch-10 lr: 0.0005

Epoch :  11 loss training:  232.16173648834229 Time :  366
accuracy train: 0.759762 val: 0.692537 test: 0.682167
max validation accuracy : 0.716418 max acc epoch : 10 test accuracy : 0.666832
Epoch-11 lr: 0.0005

Epoch :  12 loss training:  205.57873612642288 Time :  399
accuracy train: 0.779285 val: 0.692537 test: 0.690576
max validation accuracy : 0.716418 max acc epoch : 10 test accuracy : 0.666832
Counter({3: 1239, 2: 1112, 4: 749, 5: 612, 8: 577, 11: 530, 7: 474, 0: 444, 6: 443, 10: 432, 1: 401, 9: 387})
Epoch-12 lr: 0.0005

Epoch :  13 loss training:  190.93223869800568 Time :  434
accuracy train: 0.800132 val: 0.710448 test: 0.697997
max validation accuracy : 0.716418 max acc epoch : 10 test accuracy : 0.666832
Epoch-13 lr: 0.0005

Epoch :  14 loss training:  189.51874861121178 Time :  467
accuracy train: 0.794838 val: 0.704478 test: 0.695770
max validation accuracy : 0.716418 max acc epoch : 10 test accuracy : 0.666832
Counter({1: 1294, 4: 1098, 9: 741, 10: 617, 0: 583, 6: 501, 2: 495, 3: 457, 7: 446, 11: 394, 5: 387, 8: 387})
Epoch-14 lr: 0.0005

Epoch :  15 loss training:  197.58965581655502 Time :  502
accuracy train: 0.807412 val: 0.722388 test: 0.696018
max validation accuracy : 0.722388 max acc epoch : 15 test accuracy : 0.696018

Epoch :  16 loss training:  186.16827774047852 Time :  535
accuracy train: 0.799471 val: 0.713433 test: 0.693050
max validation accuracy : 0.722388 max acc epoch : 15 test accuracy : 0.696018
Counter({2: 1222, 1: 1067, 7: 731, 0: 722, 8: 699, 9: 605, 10: 426, 5: 420, 6: 403, 4: 395, 11: 394, 3: 316})

Epoch :  17 loss training:  180.63398724794388 Time :  571
accuracy train: 0.824289 val: 0.740299 test: 0.701707
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707

Epoch :  18 loss training:  169.35709643363953 Time :  603
accuracy train: 0.819656 val: 0.716418 test: 0.691318
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707
Counter({0: 1301, 10: 1114, 9: 785, 2: 692, 11: 630, 1: 483, 4: 454, 3: 444, 7: 442, 5: 409, 6: 385, 8: 261})

Epoch :  19 loss training:  182.94147545099258 Time :  639
accuracy train: 0.818001 val: 0.722388 test: 0.700470
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707

Epoch :  20 loss training:  170.03487157821655 Time :  672
accuracy train: 0.818332 val: 0.710448 test: 0.690082
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707
Counter({7: 1318, 4: 1075, 8: 942, 1: 790, 2: 503, 10: 489, 9: 469, 3: 452, 0: 416, 5: 401, 6: 392, 11: 153})

Epoch :  21 loss training:  166.7661914229393 Time :  708
accuracy train: 0.837856 val: 0.734328 test: 0.708138
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707

Epoch :  22 loss training:  146.90233594179153 Time :  741
accuracy train: 0.839179 val: 0.725373 test: 0.691813
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707
Counter({3: 1332, 0: 1067, 9: 772, 11: 689, 4: 586, 5: 462, 8: 458, 10: 446, 6: 437, 2: 433, 7: 430, 1: 288})

Epoch :  23 loss training:  142.1235802769661 Time :  776
accuracy train: 0.871608 val: 0.737313 test: 0.702449
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707

Epoch :  24 loss training:  128.4388365149498 Time :  810
accuracy train: 0.880543 val: 0.731343 test: 0.710364
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707
Counter({4: 1313, 7: 969, 3: 851, 2: 596, 9: 586, 6: 558, 10: 482, 5: 446, 8: 438, 1: 437, 11: 414, 0: 310})

Epoch :  25 loss training:  121.67442120611668 Time :  846
accuracy train: 0.894441 val: 0.728358 test: 0.717784
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707

Epoch :  26 loss training:  112.99473196268082 Time :  879
accuracy train: 0.894110 val: 0.725373 test: 0.708138
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707
Counter({3: 1299, 6: 1076, 10: 828, 11: 729, 4: 601, 2: 496, 7: 444, 0: 437, 5: 434, 8: 432, 1: 418, 9: 206})

Epoch :  27 loss training:  102.60250282287598 Time :  914
accuracy train: 0.916612 val: 0.719403 test: 0.713579
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707

Epoch :  28 loss training:  95.52328377962112 Time :  948
accuracy train: 0.929186 val: 0.710448 test: 0.703438
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707
Counter({2: 1306, 5: 1050, 7: 1021, 11: 632, 1: 552, 0: 464, 6: 450, 9: 438, 8: 416, 3: 408, 4: 401, 10: 262})

Epoch :  29 loss training:  87.60193920135498 Time :  984
accuracy train: 0.944739 val: 0.719403 test: 0.709374
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707

Epoch :  30 loss training:  78.81100356578827 Time :  1017
accuracy train: 0.935804 val: 0.725373 test: 0.700223
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707
Counter({1: 1324, 2: 1021, 9: 846, 0: 839, 4: 560, 10: 550, 8: 537, 6: 441, 7: 411, 3: 388, 5: 338, 11: 145})

Epoch :  31 loss training:  78.81059088371694 Time :  1053
accuracy train: 0.956982 val: 0.728358 test: 0.711600
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707

Epoch :  32 loss training:  68.69445347040892 Time :  1086
accuracy train: 0.960953 val: 0.704478 test: 0.716052
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707
Counter({0: 1319, 2: 1067, 3: 959, 9: 843, 8: 511, 7: 495, 11: 460, 4: 412, 5: 410, 1: 397, 6: 378, 10: 149})

Epoch :  33 loss training:  61.681732803583145 Time :  1122
accuracy train: 0.973858 val: 0.722388 test: 0.702943
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707

Epoch :  34 loss training:  56.5398318618536 Time :  1156
accuracy train: 0.977829 val: 0.710448 test: 0.710116
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707
Counter({0: 1266, 1: 955, 6: 944, 5: 633, 9: 598, 10: 583, 3: 486, 2: 469, 4: 434, 7: 395, 11: 379, 8: 258})

Epoch :  35 loss training:  53.4045085310936 Time :  1191
accuracy train: 0.962608 val: 0.707463 test: 0.709622
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707

Epoch :  36 loss training:  49.558965899050236 Time :  1225
accuracy train: 0.981138 val: 0.716418 test: 0.694286
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707
Counter({3: 1258, 1: 1048, 5: 893, 10: 661, 9: 530, 8: 510, 0: 491, 4: 446, 7: 425, 11: 408, 2: 391, 6: 339})

Epoch :  37 loss training:  40.19014756381512 Time :  1260
accuracy train: 0.985440 val: 0.722388 test: 0.717536
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707

Epoch :  38 loss training:  33.06390678137541 Time :  1293
accuracy train: 0.985771 val: 0.722388 test: 0.713579
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707
Counter({1: 1202, 2: 1032, 7: 880, 8: 832, 5: 701, 3: 530, 6: 476, 0: 408, 9: 375, 10: 368, 4: 359, 11: 237})

Epoch :  39 loss training:  35.90315295755863 Time :  1329
accuracy train: 0.991066 val: 0.710448 test: 0.701707
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707

Epoch :  40 loss training:  29.270242884755135 Time :  1362
accuracy train: 0.991396 val: 0.722388 test: 0.707643
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707
Counter({1: 1310, 2: 1052, 8: 895, 6: 836, 3: 529, 4: 504, 9: 489, 11: 450, 5: 412, 0: 373, 10: 327, 7: 223})

Epoch :  41 loss training:  28.939900614321232 Time :  1398
accuracy train: 0.992720 val: 0.713433 test: 0.697749
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707

Epoch :  42 loss training:  26.2278800457716 Time :  1431
accuracy train: 0.991066 val: 0.725373 test: 0.700223
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707
Counter({1: 1331, 0: 1015, 7: 1005, 3: 768, 5: 724, 2: 472, 9: 465, 10: 391, 4: 391, 8: 372, 6: 311, 11: 155})

Epoch :  43 loss training:  25.387078374624252 Time :  1467
accuracy train: 0.994044 val: 0.737313 test: 0.698986
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707

Epoch :  44 loss training:  21.250684153288603 Time :  1500
accuracy train: 0.995367 val: 0.728358 test: 0.705417
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707
Counter({10: 1289, 9: 1063, 7: 965, 5: 766, 6: 563, 4: 507, 11: 477, 0: 465, 1: 402, 8: 376, 3: 361, 2: 166})

Epoch :  45 loss training:  17.726116839796305 Time :  1536
accuracy train: 0.997353 val: 0.716418 test: 0.707890
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707

Epoch :  46 loss training:  17.38055832311511 Time :  1570
accuracy train: 0.997022 val: 0.728358 test: 0.704675
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707
Counter({0: 1179, 3: 1049, 11: 956, 7: 895, 4: 718, 2: 659, 9: 420, 1: 413, 10: 362, 5: 343, 8: 237, 6: 169})

Epoch :  47 loss training:  18.726203124970198 Time :  1606
accuracy train: 0.995698 val: 0.731343 test: 0.699728
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707

Epoch :  48 loss training:  17.70673884730786 Time :  1639
accuracy train: 0.995698 val: 0.728358 test: 0.699728
max validation accuracy : 0.740299 max acc epoch : 17 test accuracy : 0.701707
Counter({3: 1272, 2: 1087, 6: 919, 4: 615, 11: 517, 7: 512, 8: 505, 5: 428, 0: 401, 10: 396, 1: 381, 9: 367})

========================================================================================================================================================================================================
max acc epoch :  17
max validation accuracy :  0.7402985074626866
test accuracy :  0.7017066534751423
last test_accuracy :  0.6997279248083107
========================================================================================================================================================================================================

