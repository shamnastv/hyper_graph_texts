

date and time :  Fri Jun 11 19:58:56 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=286, weight_decay=1e-10)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  41.93161314725876 Time :  17
accuracy train: 0.957786 val: 0.965455 test: 0.961644
max validation accuracy : 0.965455 max acc epoch : 1 test accuracy : 0.961644
Counter({1: 4099, 0: 3592})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.239781541749835 Time :  37
accuracy train: 0.962230 val: 0.969091 test: 0.957534
max validation accuracy : 0.969091 max acc epoch : 2 test accuracy : 0.957534
Counter({0: 4003, 1: 3688})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.23363632336259 Time :  55
accuracy train: 0.968491 val: 0.967273 test: 0.971233
max validation accuracy : 0.969091 max acc epoch : 2 test accuracy : 0.957534
Counter({0: 3943, 1: 3748})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.673516479786485 Time :  75
accuracy train: 0.981822 val: 0.974545 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.968493
Counter({0: 3884, 1: 3807})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.411573409568518 Time :  93
accuracy train: 0.975560 val: 0.969091 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.968493
Counter({0: 3893, 1: 3798})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.51593124307692 Time :  111
accuracy train: 0.984246 val: 0.970909 test: 0.967123
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.968493
Counter({0: 3882, 1: 3809})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.6153421816416085 Time :  135
accuracy train: 0.990507 val: 0.981818 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3867, 1: 3824})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.473472498240881 Time :  162
accuracy train: 0.991113 val: 0.980000 test: 0.963470
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3851, 1: 3840})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.341267978772521 Time :  182
accuracy train: 0.991719 val: 0.978182 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3848, 1: 3843})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.992932948982343 Time :  207
accuracy train: 0.991921 val: 0.981818 test: 0.961187
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3862, 0: 3829})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  4.977544391294941 Time :  229
accuracy train: 0.993335 val: 0.980000 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3864, 0: 3827})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.564422482857481 Time :  250
accuracy train: 0.992729 val: 0.974545 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3883, 0: 3808})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  3.67257579654688 Time :  272
accuracy train: 0.994143 val: 0.976364 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3887, 0: 3804})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.191488650103565 Time :  293
accuracy train: 0.994143 val: 0.974545 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3888, 0: 3803})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  3.440355791593902 Time :  315
accuracy train: 0.994345 val: 0.976364 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3888, 1: 3803})

Epoch :  16 loss training:  3.664488057838753 Time :  339
accuracy train: 0.994951 val: 0.976364 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3889, 1: 3802})

Epoch :  17 loss training:  3.3429326764889993 Time :  361
accuracy train: 0.994749 val: 0.976364 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3892, 1: 3799})

Epoch :  18 loss training:  3.4181810630252585 Time :  381
accuracy train: 0.995152 val: 0.978182 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3892, 0: 3799})

Epoch :  19 loss training:  3.1677712102537043 Time :  402
accuracy train: 0.994951 val: 0.978182 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3893, 0: 3798})

Epoch :  20 loss training:  3.4357167110429145 Time :  424
accuracy train: 0.995556 val: 0.978182 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3895, 0: 3796})

Epoch :  21 loss training:  2.8768860597047023 Time :  445
accuracy train: 0.995556 val: 0.980000 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3894, 0: 3797})

Epoch :  22 loss training:  3.360049713170156 Time :  463
accuracy train: 0.995354 val: 0.974545 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3902, 0: 3789})

Epoch :  23 loss training:  2.6967840385623276 Time :  494
accuracy train: 0.995354 val: 0.980000 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3903, 0: 3788})

Epoch :  24 loss training:  3.1282979029929265 Time :  515
accuracy train: 0.995758 val: 0.976364 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3906, 0: 3785})

Epoch :  25 loss training:  2.4398527237353846 Time :  536
accuracy train: 0.994951 val: 0.976364 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3905, 0: 3786})

Epoch :  26 loss training:  3.2980386305134743 Time :  555
accuracy train: 0.995556 val: 0.976364 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3905, 0: 3786})

Epoch :  27 loss training:  2.5860582690802403 Time :  573
accuracy train: 0.995354 val: 0.978182 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3905, 0: 3786})

Epoch :  28 loss training:  2.6382088451937307 Time :  592
accuracy train: 0.995758 val: 0.976364 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3906, 0: 3785})

Epoch :  29 loss training:  2.3842394169187173 Time :  616
accuracy train: 0.995556 val: 0.976364 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3906, 0: 3785})

Epoch :  30 loss training:  2.582988901587669 Time :  636
accuracy train: 0.995758 val: 0.970909 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3909, 0: 3782})

Epoch :  31 loss training:  2.1453813285042997 Time :  656
accuracy train: 0.995960 val: 0.974545 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3909, 0: 3782})

Epoch :  32 loss training:  2.434424792736536 Time :  675
accuracy train: 0.995556 val: 0.978182 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3910, 0: 3781})

Epoch :  33 loss training:  2.4688750356435776 Time :  695
accuracy train: 0.995960 val: 0.972727 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3911, 0: 3780})

Epoch :  34 loss training:  2.4243393708602525 Time :  714
accuracy train: 0.995758 val: 0.974545 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3912, 1: 3779})

Epoch :  35 loss training:  1.9683401257207152 Time :  746
accuracy train: 0.995960 val: 0.976364 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3912, 0: 3779})

Epoch :  36 loss training:  2.1718656836019363 Time :  768
accuracy train: 0.995758 val: 0.974545 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3912, 0: 3779})

Epoch :  37 loss training:  2.0128070237406064 Time :  788
accuracy train: 0.995758 val: 0.972727 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3912, 0: 3779})

Epoch :  38 loss training:  2.2615491834294517 Time :  808
accuracy train: 0.996162 val: 0.974545 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3916, 0: 3775})

========================================================================================================================================================================================================
best acc epoch :  7
validation accuracy :  0.9818181818181818
test accuracy :  0.9744292237442922
last test_accuracy :  0.9707762557077626
second best val :  0.98
second best test :  0.9744292237442922
max gap 3
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=286, weight_decay=1e-10)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  41.916475266218185 Time :  833
accuracy train: 0.955968 val: 0.960000 test: 0.960731
max validation accuracy : 0.960000 max acc epoch : 1 test accuracy : 0.960731
Counter({0: 4109, 1: 3582})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.572584042325616 Time :  853
accuracy train: 0.967279 val: 0.969091 test: 0.958447
max validation accuracy : 0.969091 max acc epoch : 2 test accuracy : 0.958447
Counter({0: 3997, 1: 3694})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.00217279791832 Time :  873
accuracy train: 0.973137 val: 0.965455 test: 0.970320
max validation accuracy : 0.969091 max acc epoch : 2 test accuracy : 0.958447
Counter({0: 3944, 1: 3747})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.672550698975101 Time :  895
accuracy train: 0.981216 val: 0.972727 test: 0.965753
max validation accuracy : 0.972727 max acc epoch : 4 test accuracy : 0.965753
Counter({0: 3900, 1: 3791})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.66441954812035 Time :  914
accuracy train: 0.980610 val: 0.972727 test: 0.970776
max validation accuracy : 0.972727 max acc epoch : 4 test accuracy : 0.965753
Counter({0: 3889, 1: 3802})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.531659225467592 Time :  934
accuracy train: 0.982630 val: 0.974545 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({1: 3902, 0: 3789})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.619731884100474 Time :  952
accuracy train: 0.990709 val: 0.981818 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3879, 0: 3812})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.483333699055947 Time :  970
accuracy train: 0.991113 val: 0.976364 test: 0.964384
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3866, 0: 3825})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.475809998577461 Time :  990
accuracy train: 0.991315 val: 0.978182 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({0: 3863, 1: 3828})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  6.0424815693404526 Time :  1020
accuracy train: 0.992123 val: 0.972727 test: 0.962557
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({0: 3850, 1: 3841})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.129264682298526 Time :  1040
accuracy train: 0.993335 val: 0.976364 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({0: 3847, 1: 3844})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.6851251272019 Time :  1060
accuracy train: 0.992527 val: 0.972727 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({0: 3862, 1: 3829})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  3.727991149004083 Time :  1081
accuracy train: 0.993739 val: 0.974545 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3864, 0: 3827})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.292667378089391 Time :  1100
accuracy train: 0.994143 val: 0.976364 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({0: 3865, 1: 3826})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  3.6205935028847307 Time :  1119
accuracy train: 0.994143 val: 0.976364 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3865, 0: 3826})

Epoch :  16 loss training:  3.7678861395688727 Time :  1146
accuracy train: 0.994749 val: 0.976364 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({0: 3870, 1: 3821})

Epoch :  17 loss training:  3.3713506538188085 Time :  1164
accuracy train: 0.994951 val: 0.980000 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3871, 0: 3820})

Epoch :  18 loss training:  3.5281405292334966 Time :  1186
accuracy train: 0.994951 val: 0.980000 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3873, 0: 3818})

Epoch :  19 loss training:  2.9855842458782718 Time :  1207
accuracy train: 0.995152 val: 0.980000 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3875, 0: 3816})

Epoch :  20 loss training:  3.3242859501042403 Time :  1227
accuracy train: 0.995152 val: 0.978182 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({0: 3875, 1: 3816})

Epoch :  21 loss training:  2.8921606664080173 Time :  1247
accuracy train: 0.995556 val: 0.976364 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3875, 0: 3816})

Epoch :  22 loss training:  3.3685938930429984 Time :  1270
accuracy train: 0.995152 val: 0.974545 test: 0.968493
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3887, 0: 3804})

Epoch :  23 loss training:  2.774266961205285 Time :  1290
accuracy train: 0.995152 val: 0.978182 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3889, 0: 3802})

Epoch :  24 loss training:  3.0974428349290974 Time :  1310
accuracy train: 0.995556 val: 0.974545 test: 0.968037
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3899, 0: 3792})

Epoch :  25 loss training:  2.4428100889199413 Time :  1330
accuracy train: 0.995758 val: 0.978182 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3897, 0: 3794})

Epoch :  26 loss training:  3.3550748105044477 Time :  1348
accuracy train: 0.995354 val: 0.976364 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3900, 0: 3791})

Epoch :  27 loss training:  2.7195712600369006 Time :  1368
accuracy train: 0.995354 val: 0.980000 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3901, 0: 3790})

Epoch :  28 loss training:  2.70594334974885 Time :  1389
accuracy train: 0.995758 val: 0.980000 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3904, 0: 3787})

Epoch :  29 loss training:  2.4328081606072374 Time :  1418
accuracy train: 0.995556 val: 0.974545 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3904, 0: 3787})

Epoch :  30 loss training:  2.505832415219629 Time :  1452
accuracy train: 0.995758 val: 0.974545 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3904, 0: 3787})

Epoch :  31 loss training:  2.2132123657793272 Time :  1474
accuracy train: 0.995758 val: 0.976364 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3905, 0: 3786})

Epoch :  32 loss training:  2.4252387264568824 Time :  1494
accuracy train: 0.995960 val: 0.980000 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3905, 0: 3786})

Epoch :  33 loss training:  2.4523623086861335 Time :  1514
accuracy train: 0.995960 val: 0.978182 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3905, 0: 3786})

Epoch :  34 loss training:  2.5043697799846996 Time :  1535
accuracy train: 0.995556 val: 0.976364 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3905, 0: 3786})

Epoch :  35 loss training:  2.052018308721017 Time :  1555
accuracy train: 0.995960 val: 0.980000 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3905, 0: 3786})

Epoch :  36 loss training:  2.164895500347484 Time :  1577
accuracy train: 0.995758 val: 0.980000 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3913, 0: 3778})

Epoch :  37 loss training:  2.0519537650980055 Time :  1600
accuracy train: 0.995960 val: 0.976364 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3910, 0: 3781})

Epoch :  38 loss training:  2.382751793717034 Time :  1625
accuracy train: 0.996162 val: 0.976364 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3910, 0: 3781})

========================================================================================================================================================================================================
best acc epoch :  7
validation accuracy :  0.9818181818181818
test accuracy :  0.9707762557077626
last test_accuracy :  0.9694063926940639
second best val :  0.98
second best test :  0.9707762557077626
max gap 2
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=286, weight_decay=1e-10)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  41.88149853795767 Time :  1651
accuracy train: 0.955363 val: 0.960000 test: 0.960731
max validation accuracy : 0.960000 max acc epoch : 1 test accuracy : 0.960731
Counter({0: 4106, 1: 3585})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.68637447990477 Time :  1671
accuracy train: 0.966875 val: 0.967273 test: 0.958447
max validation accuracy : 0.967273 max acc epoch : 2 test accuracy : 0.958447
Counter({0: 4000, 1: 3691})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.590520058758557 Time :  1690
accuracy train: 0.973541 val: 0.967273 test: 0.972603
max validation accuracy : 0.967273 max acc epoch : 2 test accuracy : 0.958447
Counter({1: 3941, 0: 3750})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.844371951417997 Time :  1722
accuracy train: 0.981216 val: 0.974545 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.968037
Counter({0: 3903, 1: 3788})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.52184032346122 Time :  1741
accuracy train: 0.980206 val: 0.972727 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.968037
Counter({0: 3888, 1: 3803})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.490618182346225 Time :  1760
accuracy train: 0.981216 val: 0.970909 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.968037
Counter({0: 3895, 1: 3796})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.632206361275166 Time :  1778
accuracy train: 0.991315 val: 0.978182 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.970320
Counter({0: 3880, 1: 3811})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.338383732014336 Time :  1797
accuracy train: 0.990103 val: 0.976364 test: 0.965753
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.970320
Counter({1: 3867, 0: 3824})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.505342599237338 Time :  1818
accuracy train: 0.992325 val: 0.974545 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.970320
Counter({0: 3857, 1: 3834})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.980444930493832 Time :  1850
accuracy train: 0.992729 val: 0.972727 test: 0.964840
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.970320
Counter({1: 3846, 0: 3845})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.257066729012877 Time :  1870
accuracy train: 0.993941 val: 0.980000 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3848, 0: 3843})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.710151245468296 Time :  1892
accuracy train: 0.992527 val: 0.976364 test: 0.970320
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3866, 0: 3825})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  3.8359342217445374 Time :  1912
accuracy train: 0.994345 val: 0.978182 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3871, 0: 3820})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.210445955803152 Time :  1933
accuracy train: 0.993941 val: 0.978182 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3869, 0: 3822})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  3.5875945780426264 Time :  1955
accuracy train: 0.994547 val: 0.978182 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({0: 3869, 1: 3822})

Epoch :  16 loss training:  3.8318816350074485 Time :  1978
accuracy train: 0.994749 val: 0.974545 test: 0.975342
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3871, 0: 3820})

Epoch :  17 loss training:  3.4816038962453604 Time :  1998
accuracy train: 0.994749 val: 0.978182 test: 0.974886
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3873, 0: 3818})

Epoch :  18 loss training:  3.6118192615394946 Time :  2018
accuracy train: 0.995354 val: 0.976364 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3875, 0: 3816})

Epoch :  19 loss training:  3.188792317348998 Time :  2037
accuracy train: 0.994749 val: 0.976364 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3875, 0: 3816})

Epoch :  20 loss training:  3.5113312635803595 Time :  2057
accuracy train: 0.995354 val: 0.976364 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3877, 0: 3814})

Epoch :  21 loss training:  2.9058315834845416 Time :  2080
accuracy train: 0.995152 val: 0.980000 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3877, 0: 3814})

Epoch :  22 loss training:  3.4337724848883227 Time :  2102
accuracy train: 0.995152 val: 0.974545 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3883, 0: 3808})

Epoch :  23 loss training:  2.8025547994766384 Time :  2124
accuracy train: 0.995152 val: 0.980000 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3883, 0: 3808})

Epoch :  24 loss training:  3.252128607186023 Time :  2143
accuracy train: 0.995354 val: 0.974545 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3891, 0: 3800})

Epoch :  25 loss training:  2.436492318287492 Time :  2162
accuracy train: 0.995354 val: 0.974545 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3894, 0: 3797})

Epoch :  26 loss training:  3.402931742486544 Time :  2181
accuracy train: 0.995556 val: 0.976364 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({0: 3904, 1: 3787})

Epoch :  27 loss training:  2.6768211215385236 Time :  2205
accuracy train: 0.995556 val: 0.974545 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({0: 3904, 1: 3787})

Epoch :  28 loss training:  2.6465477448073216 Time :  2227
accuracy train: 0.995758 val: 0.976364 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3904, 0: 3787})

Epoch :  29 loss training:  2.451298082829453 Time :  2250
accuracy train: 0.995556 val: 0.974545 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3904, 0: 3787})

Epoch :  30 loss training:  2.391624769719783 Time :  2270
accuracy train: 0.995152 val: 0.970909 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3905, 0: 3786})

Epoch :  31 loss training:  2.364300998568069 Time :  2291
accuracy train: 0.995758 val: 0.974545 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3904, 0: 3787})

Epoch :  32 loss training:  2.563616693660151 Time :  2310
accuracy train: 0.995758 val: 0.970909 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({0: 3904, 1: 3787})

Epoch :  33 loss training:  1.9277833180385642 Time :  2343
accuracy train: 0.995556 val: 0.969091 test: 0.975342
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({0: 3904, 1: 3787})

Epoch :  34 loss training:  2.78432892577257 Time :  2364
accuracy train: 0.995354 val: 0.974545 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3907, 0: 3784})

Epoch :  35 loss training:  1.9719802845356753 Time :  2383
accuracy train: 0.995960 val: 0.970909 test: 0.975799
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3907, 0: 3784})

Epoch :  36 loss training:  2.364370501774829 Time :  2405
accuracy train: 0.995758 val: 0.972727 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3911, 0: 3780})

Epoch :  37 loss training:  1.9976999138161773 Time :  2424
accuracy train: 0.995960 val: 0.972727 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3911, 0: 3780})

Epoch :  38 loss training:  1.9344615766021889 Time :  2455
accuracy train: 0.995960 val: 0.972727 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3912, 0: 3779})

Epoch :  39 loss training:  1.8761344675149303 Time :  2476
accuracy train: 0.996162 val: 0.972727 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3911, 0: 3780})

Epoch :  40 loss training:  1.7739825694225146 Time :  2496
accuracy train: 0.996162 val: 0.969091 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3911, 0: 3780})

Epoch :  41 loss training:  1.6165882211644202 Time :  2522
accuracy train: 0.996162 val: 0.969091 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3912, 0: 3779})

Epoch :  42 loss training:  2.06543599186989 Time :  2552
accuracy train: 0.995960 val: 0.970909 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 11 test accuracy : 0.973516
Counter({1: 3914, 0: 3777})

========================================================================================================================================================================================================
best acc epoch :  11
validation accuracy :  0.98
test accuracy :  0.9735159817351599
last test_accuracy :  0.9735159817351599
second best val :  0.9781818181818182
second best test :  0.9703196347031964
max gap 4
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=286, weight_decay=1e-10)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  41.79040952771902 Time :  2599
accuracy train: 0.956978 val: 0.960000 test: 0.963470
max validation accuracy : 0.960000 max acc epoch : 1 test accuracy : 0.963470
Counter({0: 4106, 1: 3585})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.699383158236742 Time :  2627
accuracy train: 0.965664 val: 0.969091 test: 0.957534
max validation accuracy : 0.969091 max acc epoch : 2 test accuracy : 0.957534
Counter({0: 3990, 1: 3701})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.01354268565774 Time :  2651
accuracy train: 0.970511 val: 0.965455 test: 0.971689
max validation accuracy : 0.969091 max acc epoch : 2 test accuracy : 0.957534
Counter({0: 3941, 1: 3750})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.543674370273948 Time :  2670
accuracy train: 0.981620 val: 0.972727 test: 0.968950
max validation accuracy : 0.972727 max acc epoch : 4 test accuracy : 0.968950
Counter({0: 3904, 1: 3787})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.559360795188695 Time :  2688
accuracy train: 0.977378 val: 0.969091 test: 0.968950
max validation accuracy : 0.972727 max acc epoch : 4 test accuracy : 0.968950
Counter({0: 3896, 1: 3795})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.58722551446408 Time :  2710
accuracy train: 0.980812 val: 0.970909 test: 0.967580
max validation accuracy : 0.972727 max acc epoch : 4 test accuracy : 0.968950
Counter({1: 3904, 0: 3787})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.805155424401164 Time :  2730
accuracy train: 0.990709 val: 0.981818 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({0: 3873, 1: 3818})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.757426131865941 Time :  2748
accuracy train: 0.989093 val: 0.976364 test: 0.963927
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({0: 3862, 1: 3829})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.543652680236846 Time :  2766
accuracy train: 0.991113 val: 0.976364 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({0: 3853, 1: 3838})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  6.07203887659125 Time :  2786
accuracy train: 0.992325 val: 0.978182 test: 0.962557
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({0: 3849, 1: 3842})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.280878558056429 Time :  2805
accuracy train: 0.992325 val: 0.980000 test: 0.975799
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3852, 0: 3839})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.646309556555934 Time :  2824
accuracy train: 0.992325 val: 0.976364 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3869, 0: 3822})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  3.881159892072901 Time :  2841
accuracy train: 0.993739 val: 0.976364 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3872, 0: 3819})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.363440305925906 Time :  2861
accuracy train: 0.994143 val: 0.978182 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3874, 0: 3817})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  3.569454655284062 Time :  2884
accuracy train: 0.994345 val: 0.976364 test: 0.976712
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3873, 0: 3818})

Epoch :  16 loss training:  3.927236056071706 Time :  2903
accuracy train: 0.994749 val: 0.978182 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3875, 0: 3816})

Epoch :  17 loss training:  3.520793702278752 Time :  2923
accuracy train: 0.994749 val: 0.980000 test: 0.974886
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3876, 0: 3815})

Epoch :  18 loss training:  3.58725388959283 Time :  2941
accuracy train: 0.995354 val: 0.981818 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3878, 0: 3813})

Epoch :  19 loss training:  3.102752829727251 Time :  2960
accuracy train: 0.994951 val: 0.980000 test: 0.975342
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3878, 0: 3813})

Epoch :  20 loss training:  3.601954255369492 Time :  2980
accuracy train: 0.994951 val: 0.980000 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3884, 0: 3807})

Epoch :  21 loss training:  2.8804281301563606 Time :  3000
accuracy train: 0.995354 val: 0.980000 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3885, 0: 3806})

Epoch :  22 loss training:  3.369221348344581 Time :  3019
accuracy train: 0.995152 val: 0.976364 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3893, 0: 3798})

Epoch :  23 loss training:  2.8699375860160217 Time :  3037
accuracy train: 0.995354 val: 0.978182 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3894, 0: 3797})

Epoch :  24 loss training:  3.145773815223947 Time :  3056
accuracy train: 0.995960 val: 0.976364 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3904, 0: 3787})

Epoch :  25 loss training:  2.3998886817134917 Time :  3087
accuracy train: 0.995556 val: 0.976364 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3903, 0: 3788})

Epoch :  26 loss training:  3.2105439560255036 Time :  3109
accuracy train: 0.995354 val: 0.978182 test: 0.974886
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3904, 0: 3787})

Epoch :  27 loss training:  2.668415584776085 Time :  3130
accuracy train: 0.995556 val: 0.976364 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3905, 0: 3786})

Epoch :  28 loss training:  2.600018850294873 Time :  3158
accuracy train: 0.995960 val: 0.978182 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3909, 0: 3782})

Epoch :  29 loss training:  2.450871665321756 Time :  3180
accuracy train: 0.995758 val: 0.974545 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({0: 3901, 1: 3790})

Epoch :  30 loss training:  2.561735527240671 Time :  3207
accuracy train: 0.995758 val: 0.976364 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3908, 0: 3783})

Epoch :  31 loss training:  2.259831125003984 Time :  3229
accuracy train: 0.995960 val: 0.974545 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3907, 0: 3784})

Epoch :  32 loss training:  2.488633002853021 Time :  3250
accuracy train: 0.995960 val: 0.976364 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3907, 0: 3784})

Epoch :  33 loss training:  2.461813640053151 Time :  3280
accuracy train: 0.995960 val: 0.976364 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3907, 0: 3784})

Epoch :  34 loss training:  2.489066921407357 Time :  3301
accuracy train: 0.995960 val: 0.974545 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3908, 0: 3783})

Epoch :  35 loss training:  2.051381069526542 Time :  3326
accuracy train: 0.995960 val: 0.978182 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3910, 0: 3781})

Epoch :  36 loss training:  2.121376509370748 Time :  3353
accuracy train: 0.995960 val: 0.978182 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3910, 0: 3781})

Epoch :  37 loss training:  2.068210707511753 Time :  3374
accuracy train: 0.996162 val: 0.974545 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3910, 0: 3781})

Epoch :  38 loss training:  2.3791313947585877 Time :  3397
accuracy train: 0.996566 val: 0.976364 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3916, 0: 3775})

========================================================================================================================================================================================================
best acc epoch :  7
validation accuracy :  0.9818181818181818
test accuracy :  0.9694063926940639
last test_accuracy :  0.9730593607305936
second best val :  0.98
second best test :  0.9694063926940639
max gap 3
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=286, weight_decay=1e-10)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  41.79151752963662 Time :  3433
accuracy train: 0.955363 val: 0.960000 test: 0.962100
max validation accuracy : 0.960000 max acc epoch : 1 test accuracy : 0.962100
Counter({0: 4118, 1: 3573})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.486656745895743 Time :  3457
accuracy train: 0.965664 val: 0.969091 test: 0.959361
max validation accuracy : 0.969091 max acc epoch : 2 test accuracy : 0.959361
Counter({0: 3989, 1: 3702})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.107784022577107 Time :  3476
accuracy train: 0.973541 val: 0.965455 test: 0.969863
max validation accuracy : 0.969091 max acc epoch : 2 test accuracy : 0.959361
Counter({0: 3954, 1: 3737})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.594814032549039 Time :  3496
accuracy train: 0.980610 val: 0.972727 test: 0.966667
max validation accuracy : 0.972727 max acc epoch : 4 test accuracy : 0.966667
Counter({0: 3899, 1: 3792})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.846042306628078 Time :  3521
accuracy train: 0.980408 val: 0.972727 test: 0.972603
max validation accuracy : 0.972727 max acc epoch : 4 test accuracy : 0.966667
Counter({0: 3901, 1: 3790})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.510258972179145 Time :  3546
accuracy train: 0.980004 val: 0.965455 test: 0.966210
max validation accuracy : 0.972727 max acc epoch : 4 test accuracy : 0.966667
Counter({0: 3917, 1: 3774})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.664761514752172 Time :  3568
accuracy train: 0.990507 val: 0.978182 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.970776
Counter({0: 3893, 1: 3798})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.411297258920968 Time :  3586
accuracy train: 0.989497 val: 0.972727 test: 0.963470
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.970776
Counter({0: 3877, 1: 3814})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.709596454165876 Time :  3611
accuracy train: 0.991315 val: 0.978182 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3871, 0: 3820})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  6.00913819228299 Time :  3631
accuracy train: 0.992527 val: 0.972727 test: 0.963014
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.970776
Counter({0: 3855, 1: 3836})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.310381751507521 Time :  3654
accuracy train: 0.992527 val: 0.976364 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.970776
Counter({0: 3852, 1: 3839})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.699043908622116 Time :  3675
accuracy train: 0.993537 val: 0.978182 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3865, 0: 3826})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  3.7416016569477506 Time :  3698
accuracy train: 0.994143 val: 0.972727 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3869, 0: 3822})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.163279076223262 Time :  3719
accuracy train: 0.994749 val: 0.974545 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3870, 0: 3821})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  3.4893356637330726 Time :  3753
accuracy train: 0.994345 val: 0.980000 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.974429
Counter({1: 3870, 0: 3821})

Epoch :  16 loss training:  3.8829148755175993 Time :  3777
accuracy train: 0.995354 val: 0.972727 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.974429
Counter({1: 3874, 0: 3817})

Epoch :  17 loss training:  3.417032798344735 Time :  3800
accuracy train: 0.995152 val: 0.978182 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.974429
Counter({1: 3878, 0: 3813})

Epoch :  18 loss training:  3.6341618224978447 Time :  3821
accuracy train: 0.995556 val: 0.978182 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.974429
Counter({1: 3879, 0: 3812})

Epoch :  19 loss training:  3.035782104707323 Time :  3846
accuracy train: 0.995152 val: 0.978182 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.974429
Counter({1: 3886, 0: 3805})

Epoch :  20 loss training:  3.5267726071178913 Time :  3877
accuracy train: 0.996162 val: 0.978182 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.974429
Counter({0: 3886, 1: 3805})

Epoch :  21 loss training:  2.848358500399627 Time :  3900
accuracy train: 0.995960 val: 0.978182 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.974429
Counter({1: 3886, 0: 3805})

Epoch :  22 loss training:  3.550574960245285 Time :  3921
accuracy train: 0.995960 val: 0.974545 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.974429
Counter({1: 3888, 0: 3803})

Epoch :  23 loss training:  2.7554715052829124 Time :  3951
accuracy train: 0.995556 val: 0.976364 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.974429
Counter({1: 3890, 0: 3801})

Epoch :  24 loss training:  3.2438163047190756 Time :  3973
accuracy train: 0.995758 val: 0.974545 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.974429
Counter({1: 3900, 0: 3791})

Epoch :  25 loss training:  2.4835352012887597 Time :  3996
accuracy train: 0.995758 val: 0.981818 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3900, 0: 3791})

Epoch :  26 loss training:  3.363389481790364 Time :  4021
accuracy train: 0.995758 val: 0.980000 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3902, 0: 3789})

Epoch :  27 loss training:  2.718061062390916 Time :  4041
accuracy train: 0.995960 val: 0.980000 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3901, 0: 3790})

Epoch :  28 loss training:  2.7028184668160975 Time :  4062
accuracy train: 0.995960 val: 0.980000 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3905, 0: 3786})

Epoch :  29 loss training:  2.5151000685291365 Time :  4085
accuracy train: 0.995758 val: 0.970909 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3905, 0: 3786})

Epoch :  30 loss training:  2.385476577299414 Time :  4108
accuracy train: 0.995758 val: 0.969091 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({0: 3907, 1: 3784})

Epoch :  31 loss training:  2.445159030496143 Time :  4137
accuracy train: 0.995960 val: 0.972727 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3907, 0: 3784})

Epoch :  32 loss training:  2.4613400157541037 Time :  4157
accuracy train: 0.995758 val: 0.970909 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({0: 3905, 1: 3786})

Epoch :  33 loss training:  1.8540804093354382 Time :  4178
accuracy train: 0.995758 val: 0.978182 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3906, 0: 3785})

Epoch :  34 loss training:  2.7768863815872464 Time :  4206
accuracy train: 0.995960 val: 0.974545 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({0: 3910, 1: 3781})

Epoch :  35 loss training:  1.9916065795114264 Time :  4227
accuracy train: 0.995758 val: 0.976364 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3909, 0: 3782})

Epoch :  36 loss training:  2.3433083178824745 Time :  4249
accuracy train: 0.995960 val: 0.974545 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3911, 0: 3780})

Epoch :  37 loss training:  1.9711541911237873 Time :  4279
accuracy train: 0.995960 val: 0.976364 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3910, 0: 3781})

Epoch :  38 loss training:  2.037537343625445 Time :  4300
accuracy train: 0.995960 val: 0.974545 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3915, 0: 3776})

Epoch :  39 loss training:  1.860836597130401 Time :  4323
accuracy train: 0.996162 val: 0.978182 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3915, 0: 3776})

Epoch :  40 loss training:  1.7991755086222838 Time :  4352
accuracy train: 0.995960 val: 0.974545 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3916, 0: 3775})

Epoch :  41 loss training:  1.6744040882913396 Time :  4374
accuracy train: 0.996162 val: 0.972727 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3916, 0: 3775})

Epoch :  42 loss training:  2.108585269364994 Time :  4396
accuracy train: 0.996364 val: 0.976364 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3916, 0: 3775})

Epoch :  43 loss training:  1.627344567736145 Time :  4420
accuracy train: 0.996768 val: 0.976364 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3916, 0: 3775})

Epoch :  44 loss training:  1.7885240063551464 Time :  4444
accuracy train: 0.996364 val: 0.978182 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3917, 0: 3774})

Epoch :  45 loss training:  1.4485226053511724 Time :  4472
accuracy train: 0.996364 val: 0.976364 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3916, 0: 3775})

Epoch :  46 loss training:  1.9202924537676154 Time :  4494
accuracy train: 0.996364 val: 0.976364 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3919, 0: 3772})

Epoch :  47 loss training:  1.6701917101454455 Time :  4514
accuracy train: 0.996566 val: 0.972727 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3919, 0: 3772})

Epoch :  48 loss training:  1.8822250962693943 Time :  4535
accuracy train: 0.996768 val: 0.972727 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3920, 0: 3771})

Epoch :  49 loss training:  1.5335910189314745 Time :  4571
accuracy train: 0.996768 val: 0.974545 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3920, 0: 3771})

Epoch :  50 loss training:  1.8126561693206895 Time :  4592
accuracy train: 0.996768 val: 0.974545 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3920, 0: 3771})

Epoch :  51 loss training:  1.4615644274890656 Time :  4612
accuracy train: 0.996768 val: 0.972727 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({0: 3921, 1: 3770})

Epoch :  52 loss training:  1.502645180124091 Time :  4636
accuracy train: 0.996970 val: 0.970909 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3921, 0: 3770})

Epoch :  53 loss training:  1.4787696368439356 Time :  4657
accuracy train: 0.996768 val: 0.972727 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3921, 0: 3770})

Epoch :  54 loss training:  1.9601926569375792 Time :  4684
accuracy train: 0.997374 val: 0.969091 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3920, 0: 3771})

Epoch :  55 loss training:  1.292113649265957 Time :  4705
accuracy train: 0.996970 val: 0.970909 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3922, 0: 3769})

Epoch :  56 loss training:  1.9982332381041488 Time :  4726
accuracy train: 0.996566 val: 0.970909 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3922, 0: 3769})

========================================================================================================================================================================================================
best acc epoch :  25
validation accuracy :  0.9818181818181818
test accuracy :  0.9726027397260274
last test_accuracy :  0.9712328767123287
second best val :  0.98
second best test :  0.9744292237442922
max gap 10
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=286, weight_decay=1e-10)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  41.93448556214571 Time :  4782
accuracy train: 0.958190 val: 0.960000 test: 0.963014
max validation accuracy : 0.960000 max acc epoch : 1 test accuracy : 0.963014
Counter({0: 4127, 1: 3564})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.34654726088047 Time :  4803
accuracy train: 0.966471 val: 0.965455 test: 0.958447
max validation accuracy : 0.965455 max acc epoch : 2 test accuracy : 0.958447
Counter({1: 4005, 0: 3686})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.75147162983194 Time :  4826
accuracy train: 0.967683 val: 0.960000 test: 0.966667
max validation accuracy : 0.965455 max acc epoch : 2 test accuracy : 0.958447
Counter({0: 3955, 1: 3736})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.677327365148813 Time :  4847
accuracy train: 0.982024 val: 0.972727 test: 0.968950
max validation accuracy : 0.972727 max acc epoch : 4 test accuracy : 0.968950
Counter({1: 3908, 0: 3783})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.599968431983143 Time :  4872
accuracy train: 0.979802 val: 0.976364 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.968037
Counter({0: 3907, 1: 3784})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.339989922940731 Time :  4892
accuracy train: 0.982428 val: 0.969091 test: 0.964840
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.968037
Counter({0: 3906, 1: 3785})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.600426387740299 Time :  4919
accuracy train: 0.989093 val: 0.978182 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3882, 0: 3809})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.498152974527329 Time :  4940
accuracy train: 0.990507 val: 0.972727 test: 0.961187
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3874, 0: 3817})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.536537978099659 Time :  4964
accuracy train: 0.991719 val: 0.974545 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3870, 1: 3821})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  6.110420868732035 Time :  4990
accuracy train: 0.992931 val: 0.967273 test: 0.964384
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3857, 1: 3834})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.098996638320386 Time :  5011
accuracy train: 0.992729 val: 0.972727 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3853, 1: 3838})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.684958383208141 Time :  5040
accuracy train: 0.993133 val: 0.970909 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3853, 1: 3838})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  3.665479909046553 Time :  5061
accuracy train: 0.993941 val: 0.974545 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3853, 0: 3838})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.250341021921486 Time :  5082
accuracy train: 0.994143 val: 0.970909 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3857, 0: 3834})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  3.4546909980708733 Time :  5109
accuracy train: 0.994143 val: 0.974545 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3857, 0: 3834})

Epoch :  16 loss training:  3.9734553433954716 Time :  5131
accuracy train: 0.994749 val: 0.970909 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3858, 0: 3833})

Epoch :  17 loss training:  3.355020751710981 Time :  5161
accuracy train: 0.994749 val: 0.976364 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3861, 0: 3830})

Epoch :  18 loss training:  3.646470801322721 Time :  5184
accuracy train: 0.995354 val: 0.974545 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3864, 0: 3827})

Epoch :  19 loss training:  3.1611098797875457 Time :  5205
accuracy train: 0.995152 val: 0.972727 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3864, 0: 3827})

Epoch :  20 loss training:  3.4272577802767046 Time :  5226
accuracy train: 0.995556 val: 0.976364 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3864, 1: 3827})

Epoch :  21 loss training:  2.920839407539461 Time :  5246
accuracy train: 0.995758 val: 0.974545 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3864, 0: 3827})

Epoch :  22 loss training:  3.368004714488052 Time :  5266
accuracy train: 0.995556 val: 0.972727 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3865, 0: 3826})

Epoch :  23 loss training:  2.825836732983589 Time :  5291
accuracy train: 0.995152 val: 0.974545 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3865, 0: 3826})

Epoch :  24 loss training:  3.2009886854793876 Time :  5311
accuracy train: 0.995758 val: 0.974545 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3872, 0: 3819})

Epoch :  25 loss training:  2.529601102869492 Time :  5340
accuracy train: 0.995556 val: 0.972727 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3872, 0: 3819})

Epoch :  26 loss training:  3.3511073554400355 Time :  5361
accuracy train: 0.995960 val: 0.974545 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3875, 0: 3816})

Epoch :  27 loss training:  2.7496448773890734 Time :  5380
accuracy train: 0.995758 val: 0.974545 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3879, 0: 3812})

Epoch :  28 loss training:  2.672464194969507 Time :  5408
accuracy train: 0.995960 val: 0.974545 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3887, 0: 3804})

Epoch :  29 loss training:  2.5257341339602135 Time :  5430
accuracy train: 0.995354 val: 0.972727 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3890, 1: 3801})

Epoch :  30 loss training:  2.421955546247773 Time :  5455
accuracy train: 0.995758 val: 0.972727 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3891, 0: 3800})

Epoch :  31 loss training:  2.327824177336879 Time :  5484
accuracy train: 0.995960 val: 0.974545 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3891, 0: 3800})

Epoch :  32 loss training:  2.454006234824192 Time :  5504
accuracy train: 0.995758 val: 0.967273 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3891, 0: 3800})

Epoch :  33 loss training:  1.9552927252370864 Time :  5528
accuracy train: 0.995758 val: 0.972727 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3892, 0: 3799})

Epoch :  34 loss training:  2.795982316310983 Time :  5557
accuracy train: 0.995960 val: 0.972727 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3895, 1: 3796})

Epoch :  35 loss training:  2.01362497813534 Time :  5578
accuracy train: 0.995758 val: 0.969091 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3895, 0: 3796})

Epoch :  36 loss training:  2.341170759231318 Time :  5602
accuracy train: 0.995960 val: 0.974545 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3899, 0: 3792})

Epoch :  37 loss training:  1.9543799672974274 Time :  5634
accuracy train: 0.996162 val: 0.972727 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3899, 0: 3792})

Epoch :  38 loss training:  1.9978202952770516 Time :  5655
accuracy train: 0.995758 val: 0.967273 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3900, 0: 3791})

========================================================================================================================================================================================================
best acc epoch :  7
validation accuracy :  0.9781818181818182
test accuracy :  0.9726027397260274
last test_accuracy :  0.9721461187214612
second best val :  0.9763636363636363
second best test :  0.9680365296803652
max gap 2
========================================================================================================================================================================================================

itr : 6
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=286, weight_decay=1e-10)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  41.88670676201582 Time :  5687
accuracy train: 0.956372 val: 0.960000 test: 0.962100
max validation accuracy : 0.960000 max acc epoch : 1 test accuracy : 0.962100
Counter({0: 4097, 1: 3594})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.584081668406725 Time :  5710
accuracy train: 0.965058 val: 0.965455 test: 0.957991
max validation accuracy : 0.965455 max acc epoch : 2 test accuracy : 0.957991
Counter({0: 3987, 1: 3704})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.75417746650055 Time :  5730
accuracy train: 0.972935 val: 0.960000 test: 0.968037
max validation accuracy : 0.965455 max acc epoch : 2 test accuracy : 0.957991
Counter({0: 3945, 1: 3746})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.612857969012111 Time :  5752
accuracy train: 0.981620 val: 0.967273 test: 0.967580
max validation accuracy : 0.967273 max acc epoch : 4 test accuracy : 0.967580
Counter({0: 3904, 1: 3787})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.408414722420275 Time :  5781
accuracy train: 0.977984 val: 0.969091 test: 0.969863
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.969863
Counter({1: 3907, 0: 3784})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.230286084581167 Time :  5802
accuracy train: 0.982630 val: 0.967273 test: 0.965753
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.969863
Counter({0: 3897, 1: 3794})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.645388225209899 Time :  5826
accuracy train: 0.990507 val: 0.981818 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3877, 0: 3814})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.546880730427802 Time :  5846
accuracy train: 0.990305 val: 0.974545 test: 0.963470
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3867, 0: 3824})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.415031132521108 Time :  5867
accuracy train: 0.991315 val: 0.978182 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3856, 0: 3835})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.850393706932664 Time :  5895
accuracy train: 0.992527 val: 0.974545 test: 0.961644
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3851, 0: 3840})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.124660779256374 Time :  5915
accuracy train: 0.992931 val: 0.976364 test: 0.975799
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3851, 0: 3840})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.494607165106572 Time :  5942
accuracy train: 0.993941 val: 0.974545 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3863, 0: 3828})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  3.707814928784501 Time :  5966
accuracy train: 0.994547 val: 0.976364 test: 0.975342
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3864, 0: 3827})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.196447840775363 Time :  5987
accuracy train: 0.994749 val: 0.978182 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3869, 0: 3822})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  3.4665873553603888 Time :  6009
accuracy train: 0.994749 val: 0.978182 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3868, 0: 3823})

Epoch :  16 loss training:  3.9333270442439243 Time :  6034
accuracy train: 0.994951 val: 0.976364 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3870, 0: 3821})

Epoch :  17 loss training:  3.342235328280367 Time :  6057
accuracy train: 0.994951 val: 0.976364 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3871, 0: 3820})

Epoch :  18 loss training:  3.49790594537626 Time :  6085
accuracy train: 0.995152 val: 0.978182 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3875, 0: 3816})

Epoch :  19 loss training:  3.0550631380756386 Time :  6107
accuracy train: 0.995152 val: 0.976364 test: 0.975342
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3876, 0: 3815})

Epoch :  20 loss training:  3.4861814450123347 Time :  6126
accuracy train: 0.995354 val: 0.976364 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({0: 3879, 1: 3812})

Epoch :  21 loss training:  2.8779213275993243 Time :  6146
accuracy train: 0.995556 val: 0.978182 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3879, 0: 3812})

Epoch :  22 loss training:  3.311318662017584 Time :  6179
accuracy train: 0.995556 val: 0.976364 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3883, 0: 3808})

Epoch :  23 loss training:  2.84910102566937 Time :  6211
accuracy train: 0.995354 val: 0.976364 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3884, 0: 3807})

Epoch :  24 loss training:  3.1115022990561556 Time :  6231
accuracy train: 0.995758 val: 0.978182 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3891, 0: 3800})

Epoch :  25 loss training:  2.4377702771453187 Time :  6257
accuracy train: 0.995354 val: 0.976364 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3892, 0: 3799})

Epoch :  26 loss training:  3.2322792757768184 Time :  6285
accuracy train: 0.995354 val: 0.972727 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3893, 0: 3798})

Epoch :  27 loss training:  2.6829645150573924 Time :  6307
accuracy train: 0.995354 val: 0.972727 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3895, 0: 3796})

Epoch :  28 loss training:  2.7304496405122336 Time :  6335
accuracy train: 0.995758 val: 0.976364 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3900, 0: 3791})

Epoch :  29 loss training:  2.451057330472395 Time :  6356
accuracy train: 0.995354 val: 0.974545 test: 0.974886
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3900, 0: 3791})

Epoch :  30 loss training:  2.828363421256654 Time :  6382
accuracy train: 0.995960 val: 0.970909 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3908, 0: 3783})

Epoch :  31 loss training:  2.271672220202163 Time :  6409
accuracy train: 0.995960 val: 0.974545 test: 0.974886
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3908, 0: 3783})

Epoch :  32 loss training:  2.390815048769582 Time :  6432
accuracy train: 0.995960 val: 0.976364 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3908, 0: 3783})

Epoch :  33 loss training:  2.4593390248483047 Time :  6460
accuracy train: 0.995960 val: 0.976364 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({0: 3909, 1: 3782})

Epoch :  34 loss training:  2.458147276425734 Time :  6480
accuracy train: 0.995556 val: 0.970909 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({0: 3909, 1: 3782})

Epoch :  35 loss training:  2.0604794682294596 Time :  6511
accuracy train: 0.995960 val: 0.970909 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({0: 3909, 1: 3782})

Epoch :  36 loss training:  2.1427978954743594 Time :  6535
accuracy train: 0.995556 val: 0.976364 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3910, 0: 3781})

Epoch :  37 loss training:  2.0315106576890685 Time :  6560
accuracy train: 0.995960 val: 0.972727 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3910, 0: 3781})

Epoch :  38 loss training:  2.3369726462406106 Time :  6590
accuracy train: 0.996364 val: 0.976364 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3916, 0: 3775})

========================================================================================================================================================================================================
best acc epoch :  7
validation accuracy :  0.9818181818181818
test accuracy :  0.9739726027397261
last test_accuracy :  0.9707762557077626
second best val :  0.9781818181818182
second best test :  0.9739726027397261
max gap 2
========================================================================================================================================================================================================

itr : 7
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=286, weight_decay=1e-10)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  41.946785252541304 Time :  6633
accuracy train: 0.955767 val: 0.958182 test: 0.960731
max validation accuracy : 0.958182 max acc epoch : 1 test accuracy : 0.960731
Counter({0: 4107, 1: 3584})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.291482005268335 Time :  6653
accuracy train: 0.966471 val: 0.967273 test: 0.956164
max validation accuracy : 0.967273 max acc epoch : 2 test accuracy : 0.956164
Counter({0: 3987, 1: 3704})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.29639007942751 Time :  6670
accuracy train: 0.970713 val: 0.963636 test: 0.968950
max validation accuracy : 0.967273 max acc epoch : 2 test accuracy : 0.956164
Counter({0: 3941, 1: 3750})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.561793272849172 Time :  6696
accuracy train: 0.980610 val: 0.974545 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.968950
Counter({0: 3894, 1: 3797})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.451358271762729 Time :  6724
accuracy train: 0.976368 val: 0.969091 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.968950
Counter({0: 3881, 1: 3810})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.500937986653298 Time :  6744
accuracy train: 0.982428 val: 0.970909 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.968950
Counter({0: 3895, 1: 3796})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.630283404607326 Time :  6763
accuracy train: 0.991517 val: 0.980000 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({0: 3864, 1: 3827})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.226779728895053 Time :  6791
accuracy train: 0.990507 val: 0.972727 test: 0.960731
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3854, 0: 3837})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.391091495286673 Time :  6822
accuracy train: 0.991921 val: 0.974545 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({0: 3849, 1: 3842})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.997886148048565 Time :  6847
accuracy train: 0.992123 val: 0.972727 test: 0.961187
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3854, 0: 3837})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.017616444500163 Time :  6867
accuracy train: 0.993335 val: 0.976364 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({0: 3856, 1: 3835})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.630646728503052 Time :  6903
accuracy train: 0.992729 val: 0.972727 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3868, 0: 3823})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  3.6663971942616627 Time :  6927
accuracy train: 0.994345 val: 0.970909 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3868, 0: 3823})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.231426034239121 Time :  6948
accuracy train: 0.994143 val: 0.974545 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3873, 0: 3818})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  3.5460383121389896 Time :  6970
accuracy train: 0.994345 val: 0.970909 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3873, 0: 3818})

Epoch :  16 loss training:  3.7802322211209685 Time :  6995
accuracy train: 0.994749 val: 0.972727 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3874, 0: 3817})

Epoch :  17 loss training:  3.324342848442029 Time :  7016
accuracy train: 0.994951 val: 0.970909 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3877, 0: 3814})

Epoch :  18 loss training:  3.491488369589206 Time :  7048
accuracy train: 0.995152 val: 0.974545 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3883, 0: 3808})

Epoch :  19 loss training:  3.0125829422613606 Time :  7070
accuracy train: 0.994951 val: 0.970909 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3885, 0: 3806})

Epoch :  20 loss training:  3.328836015542038 Time :  7091
accuracy train: 0.995354 val: 0.974545 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3889, 0: 3802})

Epoch :  21 loss training:  2.866902204346843 Time :  7111
accuracy train: 0.995556 val: 0.969091 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3890, 0: 3801})

Epoch :  22 loss training:  3.469466272072168 Time :  7142
accuracy train: 0.995354 val: 0.974545 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({0: 3896, 1: 3795})

Epoch :  23 loss training:  2.866644644702319 Time :  7170
accuracy train: 0.995354 val: 0.970909 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3896, 0: 3795})

Epoch :  24 loss training:  3.008919239800889 Time :  7190
accuracy train: 0.995152 val: 0.974545 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3900, 0: 3791})

Epoch :  25 loss training:  2.469788105110638 Time :  7226
accuracy train: 0.995556 val: 0.972727 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3900, 0: 3791})

Epoch :  26 loss training:  3.298248892475385 Time :  7249
accuracy train: 0.995758 val: 0.972727 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3901, 0: 3790})

Epoch :  27 loss training:  2.66874059845577 Time :  7277
accuracy train: 0.995354 val: 0.972727 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3901, 0: 3790})

Epoch :  28 loss training:  2.6462145856639836 Time :  7299
accuracy train: 0.995758 val: 0.972727 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3903, 0: 3788})

Epoch :  29 loss training:  2.4001634762389585 Time :  7321
accuracy train: 0.995960 val: 0.972727 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({0: 3903, 1: 3788})

Epoch :  30 loss training:  2.5766656139167026 Time :  7339
accuracy train: 0.995556 val: 0.969091 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({0: 3906, 1: 3785})

Epoch :  31 loss training:  2.12839321361389 Time :  7372
accuracy train: 0.995758 val: 0.970909 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({0: 3907, 1: 3784})

Epoch :  32 loss training:  2.2613592136185616 Time :  7395
accuracy train: 0.995758 val: 0.972727 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3906, 0: 3785})

Epoch :  33 loss training:  2.4061410979775246 Time :  7422
accuracy train: 0.995758 val: 0.972727 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({0: 3907, 1: 3784})

Epoch :  34 loss training:  2.545233086188091 Time :  7441
accuracy train: 0.995960 val: 0.969091 test: 0.970320
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3908, 0: 3783})

Epoch :  35 loss training:  2.065772906120401 Time :  7465
accuracy train: 0.995960 val: 0.972727 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3909, 0: 3782})

Epoch :  36 loss training:  2.1090993033722043 Time :  7495
accuracy train: 0.995960 val: 0.972727 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3909, 0: 3782})

Epoch :  37 loss training:  1.9961964743561111 Time :  7517
accuracy train: 0.995960 val: 0.972727 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({0: 3909, 1: 3782})

Epoch :  38 loss training:  2.3127605500048958 Time :  7540
accuracy train: 0.996768 val: 0.976364 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.970776
Counter({1: 3914, 0: 3777})

========================================================================================================================================================================================================
best acc epoch :  7
validation accuracy :  0.98
test accuracy :  0.9707762557077626
last test_accuracy :  0.9707762557077626
second best val :  0.9763636363636363
second best test :  0.9707762557077626
max gap 3
========================================================================================================================================================================================================

itr : 8
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=286, weight_decay=1e-10)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  41.90636784210801 Time :  7584
accuracy train: 0.957786 val: 0.961818 test: 0.962557
max validation accuracy : 0.961818 max acc epoch : 1 test accuracy : 0.962557
Counter({0: 4109, 1: 3582})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.431433266028762 Time :  7606
accuracy train: 0.968087 val: 0.969091 test: 0.958904
max validation accuracy : 0.969091 max acc epoch : 2 test accuracy : 0.958904
Counter({1: 3978, 0: 3713})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.78170260693878 Time :  7628
accuracy train: 0.971319 val: 0.967273 test: 0.968493
max validation accuracy : 0.969091 max acc epoch : 2 test accuracy : 0.958904
Counter({1: 3939, 0: 3752})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.613124635070562 Time :  7648
accuracy train: 0.981014 val: 0.972727 test: 0.968493
max validation accuracy : 0.972727 max acc epoch : 4 test accuracy : 0.968493
Counter({0: 3901, 1: 3790})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.40205588657409 Time :  7667
accuracy train: 0.975964 val: 0.969091 test: 0.969406
max validation accuracy : 0.972727 max acc epoch : 4 test accuracy : 0.968493
Counter({0: 3915, 1: 3776})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.407542867120355 Time :  7696
accuracy train: 0.982428 val: 0.972727 test: 0.966210
max validation accuracy : 0.972727 max acc epoch : 4 test accuracy : 0.968493
Counter({0: 3912, 1: 3779})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.5664538071723655 Time :  7718
accuracy train: 0.988689 val: 0.980000 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3900, 0: 3791})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.661017453647219 Time :  7738
accuracy train: 0.990507 val: 0.976364 test: 0.964840
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3891, 1: 3800})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.634633599547669 Time :  7756
accuracy train: 0.992325 val: 0.974545 test: 0.974886
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3879, 1: 3812})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.9580440553836524 Time :  7776
accuracy train: 0.992729 val: 0.974545 test: 0.964840
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3861, 1: 3830})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.035769549198449 Time :  7801
accuracy train: 0.992931 val: 0.976364 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3857, 1: 3834})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.742205397924408 Time :  7830
accuracy train: 0.993335 val: 0.976364 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3847, 1: 3844})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  3.6435773266712204 Time :  7851
accuracy train: 0.994345 val: 0.978182 test: 0.974886
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3846, 1: 3845})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.208678219583817 Time :  7870
accuracy train: 0.994143 val: 0.976364 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3847, 1: 3844})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  3.590680269175209 Time :  7893
accuracy train: 0.994345 val: 0.976364 test: 0.974886
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3847, 0: 3844})

Epoch :  16 loss training:  3.912891171174124 Time :  7922
accuracy train: 0.994951 val: 0.976364 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3850, 0: 3841})

Epoch :  17 loss training:  3.4351559201604687 Time :  7950
accuracy train: 0.994749 val: 0.976364 test: 0.975342
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3852, 0: 3839})

Epoch :  18 loss training:  3.539017512870487 Time :  7973
accuracy train: 0.994951 val: 0.978182 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3853, 0: 3838})

Epoch :  19 loss training:  3.101316703017801 Time :  7991
accuracy train: 0.994951 val: 0.976364 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3853, 0: 3838})

Epoch :  20 loss training:  3.416371493774932 Time :  8014
accuracy train: 0.995354 val: 0.978182 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3854, 0: 3837})

Epoch :  21 loss training:  2.806434584548697 Time :  8045
accuracy train: 0.995152 val: 0.976364 test: 0.974886
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3854, 1: 3837})

Epoch :  22 loss training:  3.328513170941733 Time :  8075
accuracy train: 0.995354 val: 0.976364 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3857, 1: 3834})

Epoch :  23 loss training:  2.8039379425463267 Time :  8098
accuracy train: 0.995152 val: 0.980000 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3858, 0: 3833})

Epoch :  24 loss training:  3.2355298415059224 Time :  8118
accuracy train: 0.995556 val: 0.978182 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3883, 1: 3808})

Epoch :  25 loss training:  2.437115756678395 Time :  8149
accuracy train: 0.995960 val: 0.978182 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3889, 1: 3802})

Epoch :  26 loss training:  3.4847358427359723 Time :  8172
accuracy train: 0.995960 val: 0.976364 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3900, 1: 3791})

Epoch :  27 loss training:  2.7306613227701746 Time :  8193
accuracy train: 0.995960 val: 0.976364 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3899, 0: 3792})

Epoch :  28 loss training:  2.607460950675886 Time :  8216
accuracy train: 0.995960 val: 0.976364 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3899, 1: 3792})

Epoch :  29 loss training:  2.525134098046692 Time :  8236
accuracy train: 0.995758 val: 0.974545 test: 0.974886
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3899, 0: 3792})

Epoch :  30 loss training:  2.40139293615357 Time :  8263
accuracy train: 0.995758 val: 0.972727 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3902, 1: 3789})

Epoch :  31 loss training:  2.301177191955503 Time :  8285
accuracy train: 0.995960 val: 0.972727 test: 0.974886
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3903, 0: 3788})

Epoch :  32 loss training:  2.3416752996272407 Time :  8308
accuracy train: 0.995758 val: 0.970909 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3901, 0: 3790})

Epoch :  33 loss training:  1.9264136517303996 Time :  8336
accuracy train: 0.995758 val: 0.974545 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3901, 0: 3790})

Epoch :  34 loss training:  2.6943342199956533 Time :  8358
accuracy train: 0.995960 val: 0.974545 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3904, 1: 3787})

Epoch :  35 loss training:  1.9595539984875359 Time :  8379
accuracy train: 0.995758 val: 0.970909 test: 0.975799
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3903, 0: 3788})

Epoch :  36 loss training:  2.296990909439046 Time :  8412
accuracy train: 0.995758 val: 0.974545 test: 0.975799
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3905, 1: 3786})

Epoch :  37 loss training:  1.9757740160566755 Time :  8434
accuracy train: 0.996162 val: 0.974545 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3905, 0: 3786})

Epoch :  38 loss training:  1.952839335106546 Time :  8454
accuracy train: 0.995960 val: 0.974545 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3904, 1: 3787})

========================================================================================================================================================================================================
best acc epoch :  7
validation accuracy :  0.98
test accuracy :  0.9726027397260274
last test_accuracy :  0.9730593607305936
second best val :  0.9781818181818182
second best test :  0.9726027397260274
max gap 3
========================================================================================================================================================================================================

itr : 9
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=286, weight_decay=1e-10)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  41.799548123031855 Time :  8480
accuracy train: 0.957584 val: 0.960000 test: 0.962557
max validation accuracy : 0.960000 max acc epoch : 1 test accuracy : 0.962557
Counter({0: 4095, 1: 3596})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.55532516911626 Time :  8498
accuracy train: 0.964654 val: 0.965455 test: 0.955251
max validation accuracy : 0.965455 max acc epoch : 2 test accuracy : 0.955251
Counter({0: 3998, 1: 3693})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.985030306968838 Time :  8523
accuracy train: 0.970915 val: 0.967273 test: 0.969863
max validation accuracy : 0.967273 max acc epoch : 3 test accuracy : 0.969863
Counter({0: 3941, 1: 3750})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.5097884433344 Time :  8550
accuracy train: 0.982428 val: 0.974545 test: 0.965753
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.965753
Counter({0: 3882, 1: 3809})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.502822837093845 Time :  8573
accuracy train: 0.974955 val: 0.965455 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.965753
Counter({0: 3883, 1: 3808})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.576653636526316 Time :  8592
accuracy train: 0.982024 val: 0.972727 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.965753
Counter({0: 3882, 1: 3809})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.710288487258367 Time :  8610
accuracy train: 0.990103 val: 0.981818 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({0: 3861, 1: 3830})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.622370076016523 Time :  8638
accuracy train: 0.989699 val: 0.974545 test: 0.963927
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({0: 3854, 1: 3837})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.5914891180582345 Time :  8671
accuracy train: 0.991517 val: 0.976364 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({0: 3851, 1: 3840})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  6.0215407682117075 Time :  8688
accuracy train: 0.991921 val: 0.974545 test: 0.962557
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3856, 0: 3835})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.144353402778506 Time :  8720
accuracy train: 0.992527 val: 0.978182 test: 0.975799
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3861, 0: 3830})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.61296362336725 Time :  8745
accuracy train: 0.992325 val: 0.980000 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({0: 3873, 1: 3818})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  3.8656148693407886 Time :  8766
accuracy train: 0.993537 val: 0.980000 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3876, 0: 3815})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.2866185860475525 Time :  8785
accuracy train: 0.994143 val: 0.978182 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3878, 0: 3813})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  3.617983448319137 Time :  8814
accuracy train: 0.994547 val: 0.978182 test: 0.976712
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3878, 0: 3813})

Epoch :  16 loss training:  3.8282651386689395 Time :  8841
accuracy train: 0.994749 val: 0.980000 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3881, 0: 3810})

Epoch :  17 loss training:  3.5113389148027636 Time :  8863
accuracy train: 0.994951 val: 0.978182 test: 0.976256
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({0: 3884, 1: 3807})

Epoch :  18 loss training:  3.5470905393594876 Time :  8884
accuracy train: 0.995152 val: 0.980000 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({0: 3885, 1: 3806})

Epoch :  19 loss training:  3.239113738585729 Time :  8915
accuracy train: 0.995152 val: 0.978182 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3887, 0: 3804})

Epoch :  20 loss training:  3.7319518045987934 Time :  8937
accuracy train: 0.995152 val: 0.978182 test: 0.974886
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3892, 0: 3799})

Epoch :  21 loss training:  2.806304768251721 Time :  8959
accuracy train: 0.995354 val: 0.980000 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({0: 3892, 1: 3799})

Epoch :  22 loss training:  3.4409006203059107 Time :  8992
accuracy train: 0.995152 val: 0.976364 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3903, 0: 3788})

Epoch :  23 loss training:  2.8690196350216866 Time :  9013
accuracy train: 0.995354 val: 0.978182 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3904, 0: 3787})

Epoch :  24 loss training:  3.205700549442554 Time :  9034
accuracy train: 0.995152 val: 0.976364 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3906, 0: 3785})

Epoch :  25 loss training:  2.5583895489107817 Time :  9066
accuracy train: 0.995556 val: 0.974545 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3905, 0: 3786})

Epoch :  26 loss training:  3.2853934475569986 Time :  9088
accuracy train: 0.995556 val: 0.974545 test: 0.974886
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3906, 0: 3785})

Epoch :  27 loss training:  2.704872607078869 Time :  9107
accuracy train: 0.995556 val: 0.978182 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3907, 0: 3784})

Epoch :  28 loss training:  2.7526767272502184 Time :  9141
accuracy train: 0.995960 val: 0.978182 test: 0.974886
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3907, 0: 3784})

Epoch :  29 loss training:  2.5548654993181117 Time :  9165
accuracy train: 0.995556 val: 0.976364 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3908, 0: 3783})

Epoch :  30 loss training:  2.6495802829158492 Time :  9186
accuracy train: 0.995556 val: 0.970909 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3912, 0: 3779})

Epoch :  31 loss training:  2.2378256519150455 Time :  9218
accuracy train: 0.995758 val: 0.974545 test: 0.974886
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3911, 0: 3780})

Epoch :  32 loss training:  2.5480854634661227 Time :  9240
accuracy train: 0.995960 val: 0.980000 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3911, 0: 3780})

Epoch :  33 loss training:  2.4564667602535337 Time :  9258
accuracy train: 0.995960 val: 0.978182 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3913, 0: 3778})

Epoch :  34 loss training:  2.56007214600686 Time :  9290
accuracy train: 0.995758 val: 0.976364 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({0: 3913, 1: 3778})

Epoch :  35 loss training:  2.0512421231833287 Time :  9314
accuracy train: 0.995960 val: 0.978182 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({0: 3913, 1: 3778})

Epoch :  36 loss training:  2.1551970618311316 Time :  9333
accuracy train: 0.995758 val: 0.978182 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3914, 0: 3777})

Epoch :  37 loss training:  1.9950649379752576 Time :  9366
accuracy train: 0.995960 val: 0.976364 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3913, 0: 3778})

Epoch :  38 loss training:  2.317378777108388 Time :  9390
accuracy train: 0.996566 val: 0.976364 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.971689
Counter({0: 3915, 1: 3776})

========================================================================================================================================================================================================
best acc epoch :  7
validation accuracy :  0.9818181818181818
test accuracy :  0.971689497716895
last test_accuracy :  0.971689497716895
second best val :  0.98
second best test :  0.971689497716895
max gap 3
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  7 	 val_accuracy : 0.98182 	 test_accuracy : 0.97443 	 last test_accuracy : 0.97078 	 second best val : 0.98000 	 second best test : 0.97443
k :  1 	 best_acc epoch :  7 	 val_accuracy : 0.98182 	 test_accuracy : 0.97078 	 last test_accuracy : 0.96941 	 second best val : 0.98000 	 second best test : 0.97078
k :  2 	 best_acc epoch :  11 	 val_accuracy : 0.98000 	 test_accuracy : 0.97352 	 last test_accuracy : 0.97352 	 second best val : 0.97818 	 second best test : 0.97032
k :  3 	 best_acc epoch :  7 	 val_accuracy : 0.98182 	 test_accuracy : 0.96941 	 last test_accuracy : 0.97306 	 second best val : 0.98000 	 second best test : 0.96941
k :  4 	 best_acc epoch :  25 	 val_accuracy : 0.98182 	 test_accuracy : 0.97260 	 last test_accuracy : 0.97123 	 second best val : 0.98000 	 second best test : 0.97443
k :  5 	 best_acc epoch :  7 	 val_accuracy : 0.97818 	 test_accuracy : 0.97260 	 last test_accuracy : 0.97215 	 second best val : 0.97636 	 second best test : 0.96804
k :  6 	 best_acc epoch :  7 	 val_accuracy : 0.98182 	 test_accuracy : 0.97397 	 last test_accuracy : 0.97078 	 second best val : 0.97818 	 second best test : 0.97397
k :  7 	 best_acc epoch :  7 	 val_accuracy : 0.98000 	 test_accuracy : 0.97078 	 last test_accuracy : 0.97078 	 second best val : 0.97636 	 second best test : 0.97078
k :  8 	 best_acc epoch :  7 	 val_accuracy : 0.98000 	 test_accuracy : 0.97260 	 last test_accuracy : 0.97306 	 second best val : 0.97818 	 second best test : 0.97260
k :  9 	 best_acc epoch :  7 	 val_accuracy : 0.98182 	 test_accuracy : 0.97169 	 last test_accuracy : 0.97169 	 second best val : 0.98000 	 second best test : 0.97169

avg :  	 val_accuracy : 0.98091 	 test_accuracy : 0.97224 	 last_accuracy : 0.97164 	 second best val : 0.97873 	 second best test : 0.97164

std :  	 val_accuracy : 0.00122 	 test_accuracy : 0.00150 	 last_accuracy : 0.00123 	 second best val : 0.00142 	 second best test : 0.00208
