

date and time :  Sun Jul  4 17:41:19 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=193, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  95.07821652293205 Time :  11
accuracy train: 0.762992 val: 0.736398 test: 0.756894
max validation accuracy : 0.736398 max acc epoch : 1 test accuracy : 0.756894
Epoch-1 lr: 0.001

Epoch :  2 loss training:  88.50028872489929 Time :  20
accuracy train: 0.792453 val: 0.750469 test: 0.771244
max validation accuracy : 0.750469 max acc epoch : 2 test accuracy : 0.771244
Epoch-2 lr: 0.001

Epoch :  3 loss training:  84.17175248265266 Time :  29
accuracy train: 0.783350 val: 0.759850 test: 0.765335
max validation accuracy : 0.759850 max acc epoch : 3 test accuracy : 0.765335
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  80.46531358361244 Time :  37
accuracy train: 0.795929 val: 0.755159 test: 0.772932
max validation accuracy : 0.759850 max acc epoch : 3 test accuracy : 0.765335
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.12283340096474 Time :  46
accuracy train: 0.802549 val: 0.765478 test: 0.775746
max validation accuracy : 0.765478 max acc epoch : 5 test accuracy : 0.775746
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.72852857410908 Time :  55
accuracy train: 0.801887 val: 0.761726 test: 0.778841
max validation accuracy : 0.765478 max acc epoch : 5 test accuracy : 0.775746
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.2088280916214 Time :  64
accuracy train: 0.815293 val: 0.768293 test: 0.784750
max validation accuracy : 0.768293 max acc epoch : 7 test accuracy : 0.784750
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  75.88255390524864 Time :  74
accuracy train: 0.809997 val: 0.757974 test: 0.780248
max validation accuracy : 0.768293 max acc epoch : 7 test accuracy : 0.784750
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  75.56947436928749 Time :  85
accuracy train: 0.824727 val: 0.776735 test: 0.784187
max validation accuracy : 0.776735 max acc epoch : 9 test accuracy : 0.784187
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.20563112199306 Time :  94
accuracy train: 0.823403 val: 0.772983 test: 0.783343
max validation accuracy : 0.776735 max acc epoch : 9 test accuracy : 0.784187

Epoch :  11 loss training:  73.38197356462479 Time :  102
accuracy train: 0.830189 val: 0.774859 test: 0.785031
max validation accuracy : 0.776735 max acc epoch : 9 test accuracy : 0.784187

Epoch :  12 loss training:  71.68177479505539 Time :  111
accuracy train: 0.840450 val: 0.776735 test: 0.784750
max validation accuracy : 0.776735 max acc epoch : 9 test accuracy : 0.784187

Epoch :  13 loss training:  70.71250504255295 Time :  120
accuracy train: 0.848229 val: 0.774859 test: 0.784468
max validation accuracy : 0.776735 max acc epoch : 9 test accuracy : 0.784187

Epoch :  14 loss training:  69.88648271560669 Time :  129
accuracy train: 0.852532 val: 0.774859 test: 0.785594
max validation accuracy : 0.776735 max acc epoch : 9 test accuracy : 0.784187

Epoch :  15 loss training:  66.21089926362038 Time :  138
accuracy train: 0.864283 val: 0.783302 test: 0.786156
max validation accuracy : 0.783302 max acc epoch : 15 test accuracy : 0.786156

Epoch :  16 loss training:  64.47705300152302 Time :  147
accuracy train: 0.869414 val: 0.772983 test: 0.784187
max validation accuracy : 0.783302 max acc epoch : 15 test accuracy : 0.786156

Epoch :  17 loss training:  62.6642302274704 Time :  156
accuracy train: 0.882820 val: 0.781426 test: 0.788689
max validation accuracy : 0.783302 max acc epoch : 15 test accuracy : 0.786156

Epoch :  18 loss training:  61.74558962881565 Time :  165
accuracy train: 0.890103 val: 0.775797 test: 0.787845
max validation accuracy : 0.783302 max acc epoch : 15 test accuracy : 0.786156

Epoch :  19 loss training:  59.33295811712742 Time :  173
accuracy train: 0.895895 val: 0.778612 test: 0.788126
max validation accuracy : 0.783302 max acc epoch : 15 test accuracy : 0.786156

Epoch :  20 loss training:  55.89857133477926 Time :  182
accuracy train: 0.902019 val: 0.781426 test: 0.788407
max validation accuracy : 0.783302 max acc epoch : 15 test accuracy : 0.786156

Epoch :  21 loss training:  55.80334959924221 Time :  191
accuracy train: 0.906488 val: 0.780488 test: 0.788970
max validation accuracy : 0.783302 max acc epoch : 15 test accuracy : 0.786156

Epoch :  22 loss training:  52.13126015663147 Time :  200
accuracy train: 0.918570 val: 0.772983 test: 0.785875
max validation accuracy : 0.783302 max acc epoch : 15 test accuracy : 0.786156

Epoch :  23 loss training:  51.53590336441994 Time :  208
accuracy train: 0.923535 val: 0.776735 test: 0.785031
max validation accuracy : 0.783302 max acc epoch : 15 test accuracy : 0.786156

Epoch :  24 loss training:  48.524563141167164 Time :  217
accuracy train: 0.928832 val: 0.773921 test: 0.783061
max validation accuracy : 0.783302 max acc epoch : 15 test accuracy : 0.786156

Epoch :  25 loss training:  47.57963836193085 Time :  226
accuracy train: 0.933135 val: 0.787054 test: 0.785031
max validation accuracy : 0.787054 max acc epoch : 25 test accuracy : 0.785031

Epoch :  26 loss training:  44.47173294425011 Time :  235
accuracy train: 0.939590 val: 0.777674 test: 0.782499
max validation accuracy : 0.787054 max acc epoch : 25 test accuracy : 0.785031

Epoch :  27 loss training:  43.61322908848524 Time :  244
accuracy train: 0.944555 val: 0.779550 test: 0.785594
max validation accuracy : 0.787054 max acc epoch : 25 test accuracy : 0.785031

Epoch :  28 loss training:  41.389561019837856 Time :  252
accuracy train: 0.949851 val: 0.786116 test: 0.783905
max validation accuracy : 0.787054 max acc epoch : 25 test accuracy : 0.785031

Epoch :  29 loss training:  41.355621956288815 Time :  261
accuracy train: 0.951341 val: 0.779550 test: 0.783061
max validation accuracy : 0.787054 max acc epoch : 25 test accuracy : 0.785031

Epoch :  30 loss training:  38.90463139861822 Time :  271
accuracy train: 0.958292 val: 0.774859 test: 0.782780
max validation accuracy : 0.787054 max acc epoch : 25 test accuracy : 0.785031

Epoch :  31 loss training:  37.05978197604418 Time :  279
accuracy train: 0.962430 val: 0.778612 test: 0.779966
max validation accuracy : 0.787054 max acc epoch : 25 test accuracy : 0.785031

Epoch :  32 loss training:  35.74717877805233 Time :  288
accuracy train: 0.967891 val: 0.778612 test: 0.780810
max validation accuracy : 0.787054 max acc epoch : 25 test accuracy : 0.785031

Epoch :  33 loss training:  33.31685970723629 Time :  297
accuracy train: 0.969712 val: 0.778612 test: 0.776871
max validation accuracy : 0.787054 max acc epoch : 25 test accuracy : 0.785031

Epoch :  34 loss training:  34.82309043034911 Time :  307
accuracy train: 0.973684 val: 0.780488 test: 0.780248
max validation accuracy : 0.787054 max acc epoch : 25 test accuracy : 0.785031

Epoch :  35 loss training:  32.77179528772831 Time :  317
accuracy train: 0.977160 val: 0.781426 test: 0.776027
max validation accuracy : 0.787054 max acc epoch : 25 test accuracy : 0.785031

Epoch :  36 loss training:  30.771006364375353 Time :  324
accuracy train: 0.976829 val: 0.776735 test: 0.778278
max validation accuracy : 0.787054 max acc epoch : 25 test accuracy : 0.785031

========================================================================================================================================================================================================
best acc epoch :  25
validation accuracy :  0.7870544090056285
test accuracy :  0.7850309510410804
last test_accuracy :  0.7782779966235228
second best val :  0.7861163227016885
second best test :  0.7850309510410804
max gap 10
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=634, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  98.16625145077705 Time :  334
accuracy train: 0.776068 val: 0.747655 test: 0.760551
max validation accuracy : 0.747655 max acc epoch : 1 test accuracy : 0.760551
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.70949831604958 Time :  344
accuracy train: 0.779709 val: 0.762664 test: 0.759989
max validation accuracy : 0.762664 max acc epoch : 2 test accuracy : 0.759989
Epoch-2 lr: 0.001

Epoch :  3 loss training:  85.833536028862 Time :  353
accuracy train: 0.793942 val: 0.778612 test: 0.774057
max validation accuracy : 0.778612 max acc epoch : 3 test accuracy : 0.774057
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.85077434778214 Time :  362
accuracy train: 0.782522 val: 0.756098 test: 0.760270
max validation accuracy : 0.778612 max acc epoch : 3 test accuracy : 0.774057
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.1425586938858 Time :  371
accuracy train: 0.803707 val: 0.772045 test: 0.772369
max validation accuracy : 0.778612 max acc epoch : 3 test accuracy : 0.774057
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.44011524319649 Time :  380
accuracy train: 0.806852 val: 0.775797 test: 0.767586
max validation accuracy : 0.778612 max acc epoch : 3 test accuracy : 0.774057
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  78.50041474401951 Time :  389
accuracy train: 0.812976 val: 0.761726 test: 0.777715
max validation accuracy : 0.778612 max acc epoch : 3 test accuracy : 0.774057
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  77.28907886147499 Time :  398
accuracy train: 0.816120 val: 0.757036 test: 0.776590
max validation accuracy : 0.778612 max acc epoch : 3 test accuracy : 0.774057
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.59884108603 Time :  407
accuracy train: 0.820424 val: 0.778612 test: 0.776027
max validation accuracy : 0.778612 max acc epoch : 3 test accuracy : 0.774057
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.00736154615879 Time :  415
accuracy train: 0.822906 val: 0.774859 test: 0.780248
max validation accuracy : 0.778612 max acc epoch : 3 test accuracy : 0.774057

Epoch :  11 loss training:  75.80867603421211 Time :  424
accuracy train: 0.826051 val: 0.780488 test: 0.779403
max validation accuracy : 0.780488 max acc epoch : 11 test accuracy : 0.779403

Epoch :  12 loss training:  72.55148915946484 Time :  433
accuracy train: 0.840285 val: 0.776735 test: 0.781373
max validation accuracy : 0.780488 max acc epoch : 11 test accuracy : 0.779403

Epoch :  13 loss training:  70.68326595425606 Time :  442
accuracy train: 0.845581 val: 0.771107 test: 0.783061
max validation accuracy : 0.780488 max acc epoch : 11 test accuracy : 0.779403

Epoch :  14 loss training:  69.35244263708591 Time :  450
accuracy train: 0.855677 val: 0.778612 test: 0.780810
max validation accuracy : 0.780488 max acc epoch : 11 test accuracy : 0.779403

Epoch :  15 loss training:  68.51350343227386 Time :  459
accuracy train: 0.866104 val: 0.780488 test: 0.783061
max validation accuracy : 0.780488 max acc epoch : 11 test accuracy : 0.779403

Epoch :  16 loss training:  65.19636517763138 Time :  468
accuracy train: 0.868752 val: 0.777674 test: 0.784750
max validation accuracy : 0.780488 max acc epoch : 11 test accuracy : 0.779403

Epoch :  17 loss training:  62.88843122124672 Time :  477
accuracy train: 0.882489 val: 0.780488 test: 0.785875
max validation accuracy : 0.780488 max acc epoch : 11 test accuracy : 0.779403

Epoch :  18 loss training:  62.27180257439613 Time :  486
accuracy train: 0.886958 val: 0.779550 test: 0.787845
max validation accuracy : 0.780488 max acc epoch : 11 test accuracy : 0.779403

Epoch :  19 loss training:  60.17902198433876 Time :  497
accuracy train: 0.893082 val: 0.792683 test: 0.787001
max validation accuracy : 0.792683 max acc epoch : 19 test accuracy : 0.787001

Epoch :  20 loss training:  57.30694179236889 Time :  506
accuracy train: 0.903509 val: 0.788931 test: 0.785875
max validation accuracy : 0.792683 max acc epoch : 19 test accuracy : 0.787001

Epoch :  21 loss training:  55.57025448977947 Time :  515
accuracy train: 0.907150 val: 0.774859 test: 0.784187
max validation accuracy : 0.792683 max acc epoch : 19 test accuracy : 0.787001

Epoch :  22 loss training:  53.370510414242744 Time :  524
accuracy train: 0.917246 val: 0.777674 test: 0.787001
max validation accuracy : 0.792683 max acc epoch : 19 test accuracy : 0.787001

Epoch :  23 loss training:  52.50986576080322 Time :  532
accuracy train: 0.926018 val: 0.787992 test: 0.783905
max validation accuracy : 0.792683 max acc epoch : 19 test accuracy : 0.787001

Epoch :  24 loss training:  49.713481560349464 Time :  542
accuracy train: 0.932969 val: 0.786116 test: 0.781373
max validation accuracy : 0.792683 max acc epoch : 19 test accuracy : 0.787001

Epoch :  25 loss training:  47.75456842780113 Time :  551
accuracy train: 0.930487 val: 0.778612 test: 0.776871
max validation accuracy : 0.792683 max acc epoch : 19 test accuracy : 0.787001

Epoch :  26 loss training:  46.05523005127907 Time :  560
accuracy train: 0.938762 val: 0.784240 test: 0.777997
max validation accuracy : 0.792683 max acc epoch : 19 test accuracy : 0.787001

Epoch :  27 loss training:  44.19332327693701 Time :  569
accuracy train: 0.947037 val: 0.775797 test: 0.782780
max validation accuracy : 0.792683 max acc epoch : 19 test accuracy : 0.787001

Epoch :  28 loss training:  42.563965909183025 Time :  578
accuracy train: 0.954320 val: 0.777674 test: 0.782780
max validation accuracy : 0.792683 max acc epoch : 19 test accuracy : 0.787001

Epoch :  29 loss training:  41.808125205338 Time :  587
accuracy train: 0.956802 val: 0.783302 test: 0.782217
max validation accuracy : 0.792683 max acc epoch : 19 test accuracy : 0.787001

Epoch :  30 loss training:  40.56678355485201 Time :  595
accuracy train: 0.961106 val: 0.775797 test: 0.779122
max validation accuracy : 0.792683 max acc epoch : 19 test accuracy : 0.787001

========================================================================================================================================================================================================
best acc epoch :  19
validation accuracy :  0.7926829268292683
test accuracy :  0.7870005627462014
last test_accuracy :  0.7791221159257175
second best val :  0.7889305816135085
second best test :  0.7870005627462014
max gap 8
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=714, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  99.52101850509644 Time :  605
accuracy train: 0.774247 val: 0.757036 test: 0.756612
max validation accuracy : 0.757036 max acc epoch : 1 test accuracy : 0.756612
Epoch-1 lr: 0.001

Epoch :  2 loss training:  88.08907157182693 Time :  614
accuracy train: 0.786660 val: 0.753283 test: 0.776027
max validation accuracy : 0.757036 max acc epoch : 1 test accuracy : 0.756612
Epoch-2 lr: 0.001

Epoch :  3 loss training:  87.37700092792511 Time :  623
accuracy train: 0.782026 val: 0.749531 test: 0.758301
max validation accuracy : 0.757036 max acc epoch : 1 test accuracy : 0.756612
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.54034739732742 Time :  632
accuracy train: 0.803211 val: 0.772045 test: 0.777434
max validation accuracy : 0.772045 max acc epoch : 4 test accuracy : 0.777434
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.79589934647083 Time :  641
accuracy train: 0.798908 val: 0.771107 test: 0.775746
max validation accuracy : 0.772045 max acc epoch : 4 test accuracy : 0.777434
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.13538002967834 Time :  650
accuracy train: 0.804369 val: 0.760788 test: 0.777997
max validation accuracy : 0.772045 max acc epoch : 4 test accuracy : 0.777434
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  76.88551819324493 Time :  659
accuracy train: 0.811983 val: 0.764540 test: 0.783343
max validation accuracy : 0.772045 max acc epoch : 4 test accuracy : 0.777434
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  75.8444932103157 Time :  667
accuracy train: 0.814962 val: 0.779550 test: 0.780248
max validation accuracy : 0.779550 max acc epoch : 8 test accuracy : 0.780248
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.66351826488972 Time :  676
accuracy train: 0.820755 val: 0.776735 test: 0.783343
max validation accuracy : 0.779550 max acc epoch : 8 test accuracy : 0.780248
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  74.88240832090378 Time :  685
accuracy train: 0.823237 val: 0.775797 test: 0.786438
max validation accuracy : 0.779550 max acc epoch : 8 test accuracy : 0.780248

Epoch :  11 loss training:  75.95102339982986 Time :  694
accuracy train: 0.830851 val: 0.776735 test: 0.785312
max validation accuracy : 0.779550 max acc epoch : 8 test accuracy : 0.780248

Epoch :  12 loss training:  73.46918615698814 Time :  703
accuracy train: 0.839457 val: 0.775797 test: 0.786438
max validation accuracy : 0.779550 max acc epoch : 8 test accuracy : 0.780248

Epoch :  13 loss training:  71.79868198931217 Time :  712
accuracy train: 0.846077 val: 0.778612 test: 0.788689
max validation accuracy : 0.779550 max acc epoch : 8 test accuracy : 0.780248

Epoch :  14 loss training:  70.05779242515564 Time :  721
accuracy train: 0.860311 val: 0.783302 test: 0.790096
max validation accuracy : 0.783302 max acc epoch : 14 test accuracy : 0.790096

Epoch :  15 loss training:  65.81226751208305 Time :  730
accuracy train: 0.856173 val: 0.779550 test: 0.788970
max validation accuracy : 0.783302 max acc epoch : 14 test accuracy : 0.790096

Epoch :  16 loss training:  65.93474544584751 Time :  739
accuracy train: 0.869083 val: 0.781426 test: 0.787001
max validation accuracy : 0.783302 max acc epoch : 14 test accuracy : 0.790096

Epoch :  17 loss training:  63.5978427529335 Time :  747
accuracy train: 0.879841 val: 0.786116 test: 0.790940
max validation accuracy : 0.786116 max acc epoch : 17 test accuracy : 0.790940

Epoch :  18 loss training:  62.67269514501095 Time :  753
accuracy train: 0.887454 val: 0.781426 test: 0.788126
max validation accuracy : 0.786116 max acc epoch : 17 test accuracy : 0.790940

Epoch :  19 loss training:  59.35380320250988 Time :  762
accuracy train: 0.890930 val: 0.786116 test: 0.784750
max validation accuracy : 0.786116 max acc epoch : 17 test accuracy : 0.790940

Epoch :  20 loss training:  59.195251658558846 Time :  771
accuracy train: 0.896557 val: 0.787054 test: 0.787563
max validation accuracy : 0.787054 max acc epoch : 20 test accuracy : 0.787563

Epoch :  21 loss training:  56.59617938101292 Time :  780
accuracy train: 0.908474 val: 0.788931 test: 0.785594
max validation accuracy : 0.788931 max acc epoch : 21 test accuracy : 0.785594

Epoch :  22 loss training:  54.63883236050606 Time :  789
accuracy train: 0.913770 val: 0.787054 test: 0.784187
max validation accuracy : 0.788931 max acc epoch : 21 test accuracy : 0.785594

Epoch :  23 loss training:  52.21759517490864 Time :  798
accuracy train: 0.923866 val: 0.787054 test: 0.783905
max validation accuracy : 0.788931 max acc epoch : 21 test accuracy : 0.785594

Epoch :  24 loss training:  50.55385695397854 Time :  807
accuracy train: 0.926183 val: 0.792683 test: 0.786156
max validation accuracy : 0.792683 max acc epoch : 24 test accuracy : 0.786156

Epoch :  25 loss training:  48.85958120971918 Time :  816
accuracy train: 0.933962 val: 0.787992 test: 0.780810
max validation accuracy : 0.792683 max acc epoch : 24 test accuracy : 0.786156

Epoch :  26 loss training:  47.56113663315773 Time :  824
accuracy train: 0.937934 val: 0.792683 test: 0.785031
max validation accuracy : 0.792683 max acc epoch : 24 test accuracy : 0.786156

Epoch :  27 loss training:  46.70446436852217 Time :  833
accuracy train: 0.939424 val: 0.786116 test: 0.781654
max validation accuracy : 0.792683 max acc epoch : 24 test accuracy : 0.786156

Epoch :  28 loss training:  45.09406220912933 Time :  842
accuracy train: 0.944058 val: 0.786116 test: 0.785594
max validation accuracy : 0.792683 max acc epoch : 24 test accuracy : 0.786156

Epoch :  29 loss training:  40.946537770330906 Time :  852
accuracy train: 0.951837 val: 0.791745 test: 0.784750
max validation accuracy : 0.792683 max acc epoch : 24 test accuracy : 0.786156

Epoch :  30 loss training:  40.47401235997677 Time :  861
accuracy train: 0.957464 val: 0.791745 test: 0.782780
max validation accuracy : 0.792683 max acc epoch : 24 test accuracy : 0.786156

Epoch :  31 loss training:  39.29322253912687 Time :  869
accuracy train: 0.960444 val: 0.787992 test: 0.782499
max validation accuracy : 0.792683 max acc epoch : 24 test accuracy : 0.786156

Epoch :  32 loss training:  37.16276626288891 Time :  878
accuracy train: 0.961602 val: 0.781426 test: 0.780248
max validation accuracy : 0.792683 max acc epoch : 24 test accuracy : 0.786156

Epoch :  33 loss training:  36.05957604944706 Time :  887
accuracy train: 0.968719 val: 0.787992 test: 0.784750
max validation accuracy : 0.792683 max acc epoch : 24 test accuracy : 0.786156

Epoch :  34 loss training:  36.111500695347786 Time :  897
accuracy train: 0.971864 val: 0.788931 test: 0.782780
max validation accuracy : 0.792683 max acc epoch : 24 test accuracy : 0.786156

Epoch :  35 loss training:  33.5515468865633 Time :  905
accuracy train: 0.977491 val: 0.786116 test: 0.784750
max validation accuracy : 0.792683 max acc epoch : 24 test accuracy : 0.786156

========================================================================================================================================================================================================
best acc epoch :  24
validation accuracy :  0.7926829268292683
test accuracy :  0.7861564434440067
last test_accuracy :  0.7847495779403489
second best val :  0.7917448405253283
second best test :  0.7861564434440067
max gap 6
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=550, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  95.94931745529175 Time :  915
accuracy train: 0.770771 val: 0.750469 test: 0.764772
max validation accuracy : 0.750469 max acc epoch : 1 test accuracy : 0.764772
Epoch-1 lr: 0.001

Epoch :  2 loss training:  88.16152209043503 Time :  925
accuracy train: 0.773419 val: 0.731707 test: 0.756331
max validation accuracy : 0.750469 max acc epoch : 1 test accuracy : 0.764772
Epoch-2 lr: 0.001

Epoch :  3 loss training:  84.31389328837395 Time :  934
accuracy train: 0.784839 val: 0.741088 test: 0.763365
max validation accuracy : 0.750469 max acc epoch : 1 test accuracy : 0.764772
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.09757798910141 Time :  943
accuracy train: 0.803873 val: 0.754221 test: 0.778278
max validation accuracy : 0.754221 max acc epoch : 4 test accuracy : 0.778278
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.19349540770054 Time :  954
accuracy train: 0.799404 val: 0.747655 test: 0.771244
max validation accuracy : 0.754221 max acc epoch : 4 test accuracy : 0.778278
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.52978610992432 Time :  963
accuracy train: 0.815955 val: 0.758912 test: 0.777715
max validation accuracy : 0.758912 max acc epoch : 6 test accuracy : 0.777715
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.10618603229523 Time :  973
accuracy train: 0.817114 val: 0.770169 test: 0.774902
max validation accuracy : 0.770169 max acc epoch : 7 test accuracy : 0.774902
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  77.1958347260952 Time :  982
accuracy train: 0.823237 val: 0.753283 test: 0.777153
max validation accuracy : 0.770169 max acc epoch : 7 test accuracy : 0.774902
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  75.83890843391418 Time :  991
accuracy train: 0.824396 val: 0.761726 test: 0.777153
max validation accuracy : 0.770169 max acc epoch : 7 test accuracy : 0.774902
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  73.66755756735802 Time :  1000
accuracy train: 0.826216 val: 0.755159 test: 0.777997
max validation accuracy : 0.770169 max acc epoch : 7 test accuracy : 0.774902

Epoch :  11 loss training:  73.62028244137764 Time :  1009
accuracy train: 0.837637 val: 0.765478 test: 0.784187
max validation accuracy : 0.770169 max acc epoch : 7 test accuracy : 0.774902

Epoch :  12 loss training:  72.727629378438 Time :  1018
accuracy train: 0.842933 val: 0.772983 test: 0.782217
max validation accuracy : 0.772983 max acc epoch : 12 test accuracy : 0.782217

Epoch :  13 loss training:  71.56634047627449 Time :  1027
accuracy train: 0.852698 val: 0.757974 test: 0.781373
max validation accuracy : 0.772983 max acc epoch : 12 test accuracy : 0.782217

Epoch :  14 loss training:  69.13961170613766 Time :  1036
accuracy train: 0.861470 val: 0.770169 test: 0.786156
max validation accuracy : 0.772983 max acc epoch : 12 test accuracy : 0.782217

Epoch :  15 loss training:  67.19745969772339 Time :  1045
accuracy train: 0.864780 val: 0.765478 test: 0.783624
max validation accuracy : 0.772983 max acc epoch : 12 test accuracy : 0.782217

Epoch :  16 loss training:  65.45716871321201 Time :  1054
accuracy train: 0.878186 val: 0.772983 test: 0.785031
max validation accuracy : 0.772983 max acc epoch : 12 test accuracy : 0.782217

Epoch :  17 loss training:  61.75340589880943 Time :  1063
accuracy train: 0.883151 val: 0.771107 test: 0.782780
max validation accuracy : 0.772983 max acc epoch : 12 test accuracy : 0.782217

Epoch :  18 loss training:  61.43458001315594 Time :  1073
accuracy train: 0.883151 val: 0.755159 test: 0.777434
max validation accuracy : 0.772983 max acc epoch : 12 test accuracy : 0.782217

Epoch :  19 loss training:  59.13627244532108 Time :  1082
accuracy train: 0.895068 val: 0.759850 test: 0.783061
max validation accuracy : 0.772983 max acc epoch : 12 test accuracy : 0.782217

Epoch :  20 loss training:  57.00200937688351 Time :  1092
accuracy train: 0.903674 val: 0.773921 test: 0.787563
max validation accuracy : 0.773921 max acc epoch : 20 test accuracy : 0.787563

Epoch :  21 loss training:  54.968964129686356 Time :  1101
accuracy train: 0.907150 val: 0.772045 test: 0.787282
max validation accuracy : 0.773921 max acc epoch : 20 test accuracy : 0.787563

Epoch :  22 loss training:  52.21783748269081 Time :  1111
accuracy train: 0.913274 val: 0.772983 test: 0.786156
max validation accuracy : 0.773921 max acc epoch : 20 test accuracy : 0.787563

Epoch :  23 loss training:  53.52521051466465 Time :  1120
accuracy train: 0.925521 val: 0.779550 test: 0.785312
max validation accuracy : 0.779550 max acc epoch : 23 test accuracy : 0.785312

Epoch :  24 loss training:  51.61237831413746 Time :  1129
accuracy train: 0.930652 val: 0.774859 test: 0.781654
max validation accuracy : 0.779550 max acc epoch : 23 test accuracy : 0.785312

Epoch :  25 loss training:  48.37634479999542 Time :  1138
accuracy train: 0.935783 val: 0.773921 test: 0.783343
max validation accuracy : 0.779550 max acc epoch : 23 test accuracy : 0.785312

Epoch :  26 loss training:  46.20127847790718 Time :  1147
accuracy train: 0.944720 val: 0.771107 test: 0.781373
max validation accuracy : 0.779550 max acc epoch : 23 test accuracy : 0.785312

Epoch :  27 loss training:  45.02006224542856 Time :  1158
accuracy train: 0.945548 val: 0.774859 test: 0.782499
max validation accuracy : 0.779550 max acc epoch : 23 test accuracy : 0.785312

Epoch :  28 loss training:  43.08718141168356 Time :  1167
accuracy train: 0.951341 val: 0.771107 test: 0.779966
max validation accuracy : 0.779550 max acc epoch : 23 test accuracy : 0.785312

Epoch :  29 loss training:  39.909171499311924 Time :  1176
accuracy train: 0.956471 val: 0.766417 test: 0.782780
max validation accuracy : 0.779550 max acc epoch : 23 test accuracy : 0.785312

Epoch :  30 loss training:  40.69838459789753 Time :  1185
accuracy train: 0.959451 val: 0.779550 test: 0.783343
max validation accuracy : 0.779550 max acc epoch : 23 test accuracy : 0.785312

Epoch :  31 loss training:  38.51829793304205 Time :  1194
accuracy train: 0.963919 val: 0.781426 test: 0.782780
max validation accuracy : 0.781426 max acc epoch : 31 test accuracy : 0.782780

Epoch :  32 loss training:  37.92287443578243 Time :  1204
accuracy train: 0.965409 val: 0.779550 test: 0.781654
max validation accuracy : 0.781426 max acc epoch : 31 test accuracy : 0.782780

Epoch :  33 loss training:  35.24442882090807 Time :  1212
accuracy train: 0.968553 val: 0.775797 test: 0.781092
max validation accuracy : 0.781426 max acc epoch : 31 test accuracy : 0.782780

Epoch :  34 loss training:  34.86149852722883 Time :  1222
accuracy train: 0.976332 val: 0.780488 test: 0.780529
max validation accuracy : 0.781426 max acc epoch : 31 test accuracy : 0.782780

Epoch :  35 loss training:  32.06846261769533 Time :  1232
accuracy train: 0.977822 val: 0.776735 test: 0.785875
max validation accuracy : 0.781426 max acc epoch : 31 test accuracy : 0.782780

Epoch :  36 loss training:  31.400929730385542 Time :  1242
accuracy train: 0.979974 val: 0.769231 test: 0.781373
max validation accuracy : 0.781426 max acc epoch : 31 test accuracy : 0.782780

Epoch :  37 loss training:  31.00848262384534 Time :  1251
accuracy train: 0.981629 val: 0.773921 test: 0.782217
max validation accuracy : 0.781426 max acc epoch : 31 test accuracy : 0.782780

Epoch :  38 loss training:  29.631652399897575 Time :  1260
accuracy train: 0.982953 val: 0.774859 test: 0.782217
max validation accuracy : 0.781426 max acc epoch : 31 test accuracy : 0.782780

Epoch :  39 loss training:  27.460800498723984 Time :  1270
accuracy train: 0.984773 val: 0.765478 test: 0.776871
max validation accuracy : 0.781426 max acc epoch : 31 test accuracy : 0.782780

Epoch :  40 loss training:  26.180343080312014 Time :  1279
accuracy train: 0.986428 val: 0.770169 test: 0.777153
max validation accuracy : 0.781426 max acc epoch : 31 test accuracy : 0.782780

Epoch :  41 loss training:  25.72731701284647 Time :  1288
accuracy train: 0.987256 val: 0.767355 test: 0.778841
max validation accuracy : 0.781426 max acc epoch : 31 test accuracy : 0.782780

Epoch :  42 loss training:  25.645687712356448 Time :  1297
accuracy train: 0.988580 val: 0.769231 test: 0.777997
max validation accuracy : 0.781426 max acc epoch : 31 test accuracy : 0.782780

========================================================================================================================================================================================================
best acc epoch :  31
validation accuracy :  0.7814258911819888
test accuracy :  0.7827799662352279
last test_accuracy :  0.7779966235227912
second best val :  0.7804878048780488
second best test :  0.7827799662352279
max gap 8
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  25 	 val_accuracy : 0.78705 	 test_accuracy : 0.78503 	 last test_accuracy : 0.77828 	 second best val : 0.78612 	 second best test : 0.78503
k :  1 	 best_acc epoch :  19 	 val_accuracy : 0.79268 	 test_accuracy : 0.78700 	 last test_accuracy : 0.77912 	 second best val : 0.78893 	 second best test : 0.78700
k :  2 	 best_acc epoch :  24 	 val_accuracy : 0.79268 	 test_accuracy : 0.78616 	 last test_accuracy : 0.78475 	 second best val : 0.79174 	 second best test : 0.78616
k :  3 	 best_acc epoch :  31 	 val_accuracy : 0.78143 	 test_accuracy : 0.78278 	 last test_accuracy : 0.77800 	 second best val : 0.78049 	 second best test : 0.78278

avg :  	 val_accuracy : 0.78846 	 test_accuracy : 0.78524 	 last_accuracy : 0.78004 	 second best val : 0.78682 	 second best test : 0.78524

std :  	 val_accuracy : 0.00467 	 test_accuracy : 0.00158 	 last_accuracy : 0.00275 	 second best val : 0.00416 	 second best test : 0.00158


date and time :  Sun Jul  4 18:03:05 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=896, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  94.92866599559784 Time :  10
accuracy train: 0.772261 val: 0.740150 test: 0.761114
max validation accuracy : 0.740150 max acc epoch : 1 test accuracy : 0.761114
Epoch-1 lr: 0.001

Epoch :  2 loss training:  89.40310534834862 Time :  19
accuracy train: 0.771930 val: 0.767355 test: 0.758019
max validation accuracy : 0.767355 max acc epoch : 2 test accuracy : 0.758019
Epoch-2 lr: 0.001

Epoch :  3 loss training:  87.00962620973587 Time :  28
accuracy train: 0.788812 val: 0.765478 test: 0.774902
max validation accuracy : 0.767355 max acc epoch : 2 test accuracy : 0.758019
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  82.15175887942314 Time :  37
accuracy train: 0.791129 val: 0.756098 test: 0.774902
max validation accuracy : 0.767355 max acc epoch : 2 test accuracy : 0.758019
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  81.37799113988876 Time :  46
accuracy train: 0.791129 val: 0.760788 test: 0.772932
max validation accuracy : 0.767355 max acc epoch : 2 test accuracy : 0.758019
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.73617866635323 Time :  55
accuracy train: 0.797584 val: 0.767355 test: 0.779403
max validation accuracy : 0.767355 max acc epoch : 2 test accuracy : 0.758019
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  78.73107549548149 Time :  64
accuracy train: 0.800894 val: 0.772045 test: 0.781373
max validation accuracy : 0.772045 max acc epoch : 7 test accuracy : 0.781373
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  78.10374963283539 Time :  73
accuracy train: 0.802383 val: 0.772983 test: 0.780529
max validation accuracy : 0.772983 max acc epoch : 8 test accuracy : 0.780529
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  77.15920516848564 Time :  83
accuracy train: 0.807845 val: 0.768293 test: 0.777153
max validation accuracy : 0.772983 max acc epoch : 8 test accuracy : 0.780529
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.93714708089828 Time :  91
accuracy train: 0.807183 val: 0.767355 test: 0.778559
max validation accuracy : 0.772983 max acc epoch : 8 test accuracy : 0.780529

Epoch :  11 loss training:  75.89610353112221 Time :  101
accuracy train: 0.817445 val: 0.769231 test: 0.776871
max validation accuracy : 0.772983 max acc epoch : 8 test accuracy : 0.780529

Epoch :  12 loss training:  74.49152238667011 Time :  110
accuracy train: 0.823072 val: 0.771107 test: 0.775183
max validation accuracy : 0.772983 max acc epoch : 8 test accuracy : 0.780529

Epoch :  13 loss training:  72.47790989279747 Time :  120
accuracy train: 0.833333 val: 0.766417 test: 0.782499
max validation accuracy : 0.772983 max acc epoch : 8 test accuracy : 0.780529

Epoch :  14 loss training:  71.35953272879124 Time :  129
accuracy train: 0.842105 val: 0.774859 test: 0.784468
max validation accuracy : 0.774859 max acc epoch : 14 test accuracy : 0.784468

Epoch :  15 loss training:  68.9818384796381 Time :  138
accuracy train: 0.850050 val: 0.778612 test: 0.783343
max validation accuracy : 0.778612 max acc epoch : 15 test accuracy : 0.783343

Epoch :  16 loss training:  67.22588148713112 Time :  147
accuracy train: 0.857332 val: 0.777674 test: 0.783061
max validation accuracy : 0.778612 max acc epoch : 15 test accuracy : 0.783343

Epoch :  17 loss training:  64.40742082893848 Time :  157
accuracy train: 0.868918 val: 0.780488 test: 0.786156
max validation accuracy : 0.780488 max acc epoch : 17 test accuracy : 0.786156

Epoch :  18 loss training:  63.234603717923164 Time :  166
accuracy train: 0.876200 val: 0.781426 test: 0.789814
max validation accuracy : 0.781426 max acc epoch : 18 test accuracy : 0.789814

Epoch :  19 loss training:  62.236791878938675 Time :  176
accuracy train: 0.883648 val: 0.784240 test: 0.786156
max validation accuracy : 0.784240 max acc epoch : 19 test accuracy : 0.786156

Epoch :  20 loss training:  60.33772985637188 Time :  185
accuracy train: 0.889772 val: 0.782364 test: 0.786156
max validation accuracy : 0.784240 max acc epoch : 19 test accuracy : 0.786156

Epoch :  21 loss training:  57.41164460033178 Time :  194
accuracy train: 0.893413 val: 0.780488 test: 0.789814
max validation accuracy : 0.784240 max acc epoch : 19 test accuracy : 0.786156

Epoch :  22 loss training:  56.76178929209709 Time :  204
accuracy train: 0.901357 val: 0.782364 test: 0.782217
max validation accuracy : 0.784240 max acc epoch : 19 test accuracy : 0.786156

Epoch :  23 loss training:  54.69656166434288 Time :  213
accuracy train: 0.907977 val: 0.784240 test: 0.784750
max validation accuracy : 0.784240 max acc epoch : 19 test accuracy : 0.786156

Epoch :  24 loss training:  52.35953725874424 Time :  222
accuracy train: 0.913439 val: 0.778612 test: 0.786719
max validation accuracy : 0.784240 max acc epoch : 19 test accuracy : 0.786156

Epoch :  25 loss training:  49.91342043876648 Time :  231
accuracy train: 0.920225 val: 0.775797 test: 0.785031
max validation accuracy : 0.784240 max acc epoch : 19 test accuracy : 0.786156

Epoch :  26 loss training:  48.807685665786266 Time :  240
accuracy train: 0.930156 val: 0.783302 test: 0.787282
max validation accuracy : 0.784240 max acc epoch : 19 test accuracy : 0.786156

Epoch :  27 loss training:  45.559155352413654 Time :  250
accuracy train: 0.936279 val: 0.787054 test: 0.790377
max validation accuracy : 0.787054 max acc epoch : 27 test accuracy : 0.790377

Epoch :  28 loss training:  44.828714802861214 Time :  259
accuracy train: 0.940583 val: 0.781426 test: 0.789533
max validation accuracy : 0.787054 max acc epoch : 27 test accuracy : 0.790377

Epoch :  29 loss training:  42.65291032940149 Time :  268
accuracy train: 0.947865 val: 0.780488 test: 0.788126
max validation accuracy : 0.787054 max acc epoch : 27 test accuracy : 0.790377

Epoch :  30 loss training:  40.47132407128811 Time :  277
accuracy train: 0.951175 val: 0.786116 test: 0.791503
max validation accuracy : 0.787054 max acc epoch : 27 test accuracy : 0.790377

Epoch :  31 loss training:  39.21503686159849 Time :  286
accuracy train: 0.954982 val: 0.782364 test: 0.785875
max validation accuracy : 0.787054 max acc epoch : 27 test accuracy : 0.790377

Epoch :  32 loss training:  38.400511015206575 Time :  295
accuracy train: 0.958954 val: 0.787054 test: 0.788970
max validation accuracy : 0.787054 max acc epoch : 27 test accuracy : 0.790377

Epoch :  33 loss training:  35.83975192904472 Time :  304
accuracy train: 0.961768 val: 0.783302 test: 0.787001
max validation accuracy : 0.787054 max acc epoch : 27 test accuracy : 0.790377

Epoch :  34 loss training:  35.92848974466324 Time :  313
accuracy train: 0.964085 val: 0.780488 test: 0.785312
max validation accuracy : 0.787054 max acc epoch : 27 test accuracy : 0.790377

Epoch :  35 loss training:  33.36803466081619 Time :  322
accuracy train: 0.965574 val: 0.784240 test: 0.788970
max validation accuracy : 0.787054 max acc epoch : 27 test accuracy : 0.790377

Epoch :  36 loss training:  33.14788954705 Time :  331
accuracy train: 0.970043 val: 0.783302 test: 0.786156
max validation accuracy : 0.787054 max acc epoch : 27 test accuracy : 0.790377

Epoch :  37 loss training:  30.94661356508732 Time :  340
accuracy train: 0.975339 val: 0.792683 test: 0.790096
max validation accuracy : 0.792683 max acc epoch : 37 test accuracy : 0.790096

Epoch :  38 loss training:  29.955348528921604 Time :  349
accuracy train: 0.975174 val: 0.781426 test: 0.784468
max validation accuracy : 0.792683 max acc epoch : 37 test accuracy : 0.790096

Epoch :  39 loss training:  28.559078454971313 Time :  358
accuracy train: 0.977656 val: 0.787054 test: 0.785312
max validation accuracy : 0.792683 max acc epoch : 37 test accuracy : 0.790096

Epoch :  40 loss training:  27.63009414821863 Time :  368
accuracy train: 0.980305 val: 0.785178 test: 0.783624
max validation accuracy : 0.792683 max acc epoch : 37 test accuracy : 0.790096

Epoch :  41 loss training:  27.818261224776506 Time :  376
accuracy train: 0.982787 val: 0.782364 test: 0.783905
max validation accuracy : 0.792683 max acc epoch : 37 test accuracy : 0.790096

Epoch :  42 loss training:  25.291894041001797 Time :  386
accuracy train: 0.984773 val: 0.781426 test: 0.784187
max validation accuracy : 0.792683 max acc epoch : 37 test accuracy : 0.790096

Epoch :  43 loss training:  24.901371330022812 Time :  395
accuracy train: 0.986428 val: 0.785178 test: 0.780248
max validation accuracy : 0.792683 max acc epoch : 37 test accuracy : 0.790096

Epoch :  44 loss training:  23.69036486186087 Time :  404
accuracy train: 0.984277 val: 0.781426 test: 0.776027
max validation accuracy : 0.792683 max acc epoch : 37 test accuracy : 0.790096

Epoch :  45 loss training:  23.80058490112424 Time :  413
accuracy train: 0.988083 val: 0.781426 test: 0.781936
max validation accuracy : 0.792683 max acc epoch : 37 test accuracy : 0.790096

Epoch :  46 loss training:  21.741175558418036 Time :  422
accuracy train: 0.988083 val: 0.780488 test: 0.781654
max validation accuracy : 0.792683 max acc epoch : 37 test accuracy : 0.790096

Epoch :  47 loss training:  21.281756307929754 Time :  431
accuracy train: 0.991394 val: 0.779550 test: 0.778278
max validation accuracy : 0.792683 max acc epoch : 37 test accuracy : 0.790096

Epoch :  48 loss training:  19.502580862492323 Time :  440
accuracy train: 0.991725 val: 0.776735 test: 0.781092
max validation accuracy : 0.792683 max acc epoch : 37 test accuracy : 0.790096

========================================================================================================================================================================================================
best acc epoch :  37
validation accuracy :  0.7926829268292683
test accuracy :  0.7900956668542487
last test_accuracy :  0.7810917276308385
second best val :  0.7870544090056285
second best test :  0.7903770399549803
max gap 10
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=750, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  96.51342442631721 Time :  450
accuracy train: 0.764151 val: 0.742026 test: 0.756894
max validation accuracy : 0.742026 max acc epoch : 1 test accuracy : 0.756894
Epoch-1 lr: 0.001

Epoch :  2 loss training:  88.69927152991295 Time :  459
accuracy train: 0.783681 val: 0.757974 test: 0.767304
max validation accuracy : 0.757974 max acc epoch : 2 test accuracy : 0.767304
Epoch-2 lr: 0.001

Epoch :  3 loss training:  88.02772897481918 Time :  468
accuracy train: 0.783846 val: 0.766417 test: 0.767867
max validation accuracy : 0.766417 max acc epoch : 3 test accuracy : 0.767867
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  82.07622107863426 Time :  477
accuracy train: 0.794604 val: 0.755159 test: 0.770681
max validation accuracy : 0.766417 max acc epoch : 3 test accuracy : 0.767867
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.526471555233 Time :  486
accuracy train: 0.805528 val: 0.760788 test: 0.772651
max validation accuracy : 0.766417 max acc epoch : 3 test accuracy : 0.767867
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.86225605010986 Time :  495
accuracy train: 0.797087 val: 0.751407 test: 0.761958
max validation accuracy : 0.766417 max acc epoch : 3 test accuracy : 0.767867
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.22584569454193 Time :  504
accuracy train: 0.813803 val: 0.755159 test: 0.776027
max validation accuracy : 0.766417 max acc epoch : 3 test accuracy : 0.767867
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  77.35524529218674 Time :  513
accuracy train: 0.814134 val: 0.752345 test: 0.775746
max validation accuracy : 0.766417 max acc epoch : 3 test accuracy : 0.767867
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.89932565391064 Time :  523
accuracy train: 0.815293 val: 0.753283 test: 0.776027
max validation accuracy : 0.766417 max acc epoch : 3 test accuracy : 0.767867
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.67856660485268 Time :  532
accuracy train: 0.820755 val: 0.750469 test: 0.774902
max validation accuracy : 0.766417 max acc epoch : 3 test accuracy : 0.767867

Epoch :  11 loss training:  75.98471793532372 Time :  541
accuracy train: 0.824727 val: 0.755159 test: 0.777715
max validation accuracy : 0.766417 max acc epoch : 3 test accuracy : 0.767867

Epoch :  12 loss training:  72.7959625273943 Time :  551
accuracy train: 0.833499 val: 0.766417 test: 0.779122
max validation accuracy : 0.766417 max acc epoch : 3 test accuracy : 0.767867

Epoch :  13 loss training:  71.53025975823402 Time :  560
accuracy train: 0.838464 val: 0.758912 test: 0.781936
max validation accuracy : 0.766417 max acc epoch : 3 test accuracy : 0.767867

Epoch :  14 loss training:  70.3059014081955 Time :  571
accuracy train: 0.849222 val: 0.763602 test: 0.779122
max validation accuracy : 0.766417 max acc epoch : 3 test accuracy : 0.767867

========================================================================================================================================================================================================
best acc epoch :  3
validation accuracy :  0.7664165103189493
test accuracy :  0.7678671918964547
last test_accuracy :  0.7791221159257175
second best val :  0.7636022514071295
second best test :  0.7678671918964547
max gap 1
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=516, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  95.99216166138649 Time :  581
accuracy train: 0.682390 val: 0.662289 test: 0.669949
max validation accuracy : 0.662289 max acc epoch : 1 test accuracy : 0.669949
Epoch-1 lr: 0.001

Epoch :  2 loss training:  88.88168078660965 Time :  591
accuracy train: 0.771268 val: 0.734522 test: 0.748452
max validation accuracy : 0.734522 max acc epoch : 2 test accuracy : 0.748452
Epoch-2 lr: 0.001

Epoch :  3 loss training:  87.21804183721542 Time :  601
accuracy train: 0.782357 val: 0.749531 test: 0.761396
max validation accuracy : 0.749531 max acc epoch : 3 test accuracy : 0.761396
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  80.1430331170559 Time :  612
accuracy train: 0.802383 val: 0.770169 test: 0.777434
max validation accuracy : 0.770169 max acc epoch : 4 test accuracy : 0.777434
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.40506100654602 Time :  622
accuracy train: 0.804535 val: 0.759850 test: 0.776308
max validation accuracy : 0.770169 max acc epoch : 4 test accuracy : 0.777434
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.62450052797794 Time :  632
accuracy train: 0.808176 val: 0.771107 test: 0.779966
max validation accuracy : 0.771107 max acc epoch : 6 test accuracy : 0.779966
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  76.78298604488373 Time :  642
accuracy train: 0.811321 val: 0.768293 test: 0.778841
max validation accuracy : 0.771107 max acc epoch : 6 test accuracy : 0.779966
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.79152929782867 Time :  652
accuracy train: 0.816948 val: 0.776735 test: 0.778559
max validation accuracy : 0.776735 max acc epoch : 8 test accuracy : 0.778559
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  75.5960334688425 Time :  663
accuracy train: 0.813803 val: 0.759850 test: 0.776590
max validation accuracy : 0.776735 max acc epoch : 8 test accuracy : 0.778559
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  74.82170256972313 Time :  673
accuracy train: 0.814962 val: 0.773921 test: 0.777153
max validation accuracy : 0.776735 max acc epoch : 8 test accuracy : 0.778559

Epoch :  11 loss training:  73.72433333098888 Time :  684
accuracy train: 0.826382 val: 0.770169 test: 0.779122
max validation accuracy : 0.776735 max acc epoch : 8 test accuracy : 0.778559

Epoch :  12 loss training:  73.82291650772095 Time :  694
accuracy train: 0.833002 val: 0.766417 test: 0.779685
max validation accuracy : 0.776735 max acc epoch : 8 test accuracy : 0.778559

Epoch :  13 loss training:  70.21001683175564 Time :  704
accuracy train: 0.835816 val: 0.766417 test: 0.778278
max validation accuracy : 0.776735 max acc epoch : 8 test accuracy : 0.778559

Epoch :  14 loss training:  69.20693731307983 Time :  715
accuracy train: 0.844422 val: 0.764540 test: 0.778559
max validation accuracy : 0.776735 max acc epoch : 8 test accuracy : 0.778559

Epoch :  15 loss training:  67.84252600371838 Time :  725
accuracy train: 0.855180 val: 0.763602 test: 0.779966
max validation accuracy : 0.776735 max acc epoch : 8 test accuracy : 0.778559

Epoch :  16 loss training:  65.57520408928394 Time :  735
accuracy train: 0.860642 val: 0.764540 test: 0.778559
max validation accuracy : 0.776735 max acc epoch : 8 test accuracy : 0.778559

Epoch :  17 loss training:  63.63978363573551 Time :  745
accuracy train: 0.871400 val: 0.762664 test: 0.780529
max validation accuracy : 0.776735 max acc epoch : 8 test accuracy : 0.778559

Epoch :  18 loss training:  61.45696139335632 Time :  754
accuracy train: 0.876365 val: 0.758912 test: 0.780248
max validation accuracy : 0.776735 max acc epoch : 8 test accuracy : 0.778559

Epoch :  19 loss training:  60.26982906460762 Time :  765
accuracy train: 0.887123 val: 0.764540 test: 0.783343
max validation accuracy : 0.776735 max acc epoch : 8 test accuracy : 0.778559

========================================================================================================================================================================================================
best acc epoch :  8
validation accuracy :  0.776735459662289
test accuracy :  0.7785593697242543
last test_accuracy :  0.7833427124366911
second best val :  0.773921200750469
second best test :  0.7785593697242543
max gap 2
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=205, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  95.8032737672329 Time :  777
accuracy train: 0.747600 val: 0.752345 test: 0.748171
max validation accuracy : 0.752345 max acc epoch : 1 test accuracy : 0.748171
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.64789646863937 Time :  787
accuracy train: 0.781529 val: 0.750469 test: 0.774620
max validation accuracy : 0.752345 max acc epoch : 1 test accuracy : 0.748171
Epoch-2 lr: 0.001

Epoch :  3 loss training:  85.0723672658205 Time :  798
accuracy train: 0.784674 val: 0.770169 test: 0.759707
max validation accuracy : 0.770169 max acc epoch : 3 test accuracy : 0.759707
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.6220206618309 Time :  808
accuracy train: 0.798908 val: 0.773921 test: 0.782499
max validation accuracy : 0.773921 max acc epoch : 4 test accuracy : 0.782499
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.98702892661095 Time :  818
accuracy train: 0.799735 val: 0.783302 test: 0.783905
max validation accuracy : 0.783302 max acc epoch : 5 test accuracy : 0.783905
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  78.95318159461021 Time :  828
accuracy train: 0.791625 val: 0.762664 test: 0.771525
max validation accuracy : 0.783302 max acc epoch : 5 test accuracy : 0.783905
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.65480050444603 Time :  838
accuracy train: 0.806852 val: 0.774859 test: 0.777153
max validation accuracy : 0.783302 max acc epoch : 5 test accuracy : 0.783905
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  77.20080390572548 Time :  848
accuracy train: 0.813803 val: 0.779550 test: 0.778841
max validation accuracy : 0.783302 max acc epoch : 5 test accuracy : 0.783905
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.53879317641258 Time :  857
accuracy train: 0.819431 val: 0.785178 test: 0.784468
max validation accuracy : 0.785178 max acc epoch : 9 test accuracy : 0.784468
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.53681004047394 Time :  867
accuracy train: 0.819762 val: 0.788931 test: 0.780810
max validation accuracy : 0.788931 max acc epoch : 10 test accuracy : 0.780810

Epoch :  11 loss training:  75.23332661390305 Time :  878
accuracy train: 0.826879 val: 0.788931 test: 0.782499
max validation accuracy : 0.788931 max acc epoch : 10 test accuracy : 0.780810

Epoch :  12 loss training:  73.52979040145874 Time :  888
accuracy train: 0.836478 val: 0.793621 test: 0.786156
max validation accuracy : 0.793621 max acc epoch : 12 test accuracy : 0.786156

Epoch :  13 loss training:  70.98488801717758 Time :  898
accuracy train: 0.840616 val: 0.789869 test: 0.784750
max validation accuracy : 0.793621 max acc epoch : 12 test accuracy : 0.786156

Epoch :  14 loss training:  69.80521613359451 Time :  909
accuracy train: 0.845581 val: 0.782364 test: 0.782780
max validation accuracy : 0.793621 max acc epoch : 12 test accuracy : 0.786156

Epoch :  15 loss training:  68.46821804344654 Time :  919
accuracy train: 0.854849 val: 0.792683 test: 0.783061
max validation accuracy : 0.793621 max acc epoch : 12 test accuracy : 0.786156

Epoch :  16 loss training:  65.36326929926872 Time :  929
accuracy train: 0.860973 val: 0.786116 test: 0.785875
max validation accuracy : 0.793621 max acc epoch : 12 test accuracy : 0.786156

Epoch :  17 loss training:  63.16545059531927 Time :  939
accuracy train: 0.871400 val: 0.799250 test: 0.784468
max validation accuracy : 0.799250 max acc epoch : 17 test accuracy : 0.784468

Epoch :  18 loss training:  63.0208784788847 Time :  948
accuracy train: 0.873055 val: 0.788931 test: 0.781936
max validation accuracy : 0.799250 max acc epoch : 17 test accuracy : 0.784468

Epoch :  19 loss training:  60.482317045331 Time :  958
accuracy train: 0.882986 val: 0.791745 test: 0.781092
max validation accuracy : 0.799250 max acc epoch : 17 test accuracy : 0.784468

Epoch :  20 loss training:  57.62558704614639 Time :  969
accuracy train: 0.891427 val: 0.797373 test: 0.784187
max validation accuracy : 0.799250 max acc epoch : 17 test accuracy : 0.784468

Epoch :  21 loss training:  56.40500830113888 Time :  979
accuracy train: 0.900861 val: 0.800188 test: 0.786438
max validation accuracy : 0.800188 max acc epoch : 21 test accuracy : 0.786438

Epoch :  22 loss training:  55.80145390331745 Time :  990
accuracy train: 0.908474 val: 0.796435 test: 0.785031
max validation accuracy : 0.800188 max acc epoch : 21 test accuracy : 0.786438

Epoch :  23 loss training:  52.188958041369915 Time :  1000
accuracy train: 0.908474 val: 0.790807 test: 0.786156
max validation accuracy : 0.800188 max acc epoch : 21 test accuracy : 0.786438

Epoch :  24 loss training:  49.812200374901295 Time :  1011
accuracy train: 0.920722 val: 0.808630 test: 0.784187
max validation accuracy : 0.808630 max acc epoch : 24 test accuracy : 0.784187

Epoch :  25 loss training:  49.97084866464138 Time :  1021
accuracy train: 0.928004 val: 0.797373 test: 0.781936
max validation accuracy : 0.808630 max acc epoch : 24 test accuracy : 0.784187

Epoch :  26 loss training:  47.305914506316185 Time :  1032
accuracy train: 0.931314 val: 0.807692 test: 0.780248
max validation accuracy : 0.808630 max acc epoch : 24 test accuracy : 0.784187

Epoch :  27 loss training:  47.412016205489635 Time :  1042
accuracy train: 0.934624 val: 0.807692 test: 0.787563
max validation accuracy : 0.808630 max acc epoch : 24 test accuracy : 0.784187

Epoch :  28 loss training:  42.95925207436085 Time :  1052
accuracy train: 0.941245 val: 0.805816 test: 0.781373
max validation accuracy : 0.808630 max acc epoch : 24 test accuracy : 0.784187

Epoch :  29 loss training:  41.165106758475304 Time :  1063
accuracy train: 0.948858 val: 0.804878 test: 0.785312
max validation accuracy : 0.808630 max acc epoch : 24 test accuracy : 0.784187

Epoch :  30 loss training:  40.22814052551985 Time :  1073
accuracy train: 0.952003 val: 0.813321 test: 0.779966
max validation accuracy : 0.813321 max acc epoch : 30 test accuracy : 0.779966

Epoch :  31 loss training:  39.25138263404369 Time :  1084
accuracy train: 0.955809 val: 0.805816 test: 0.778278
max validation accuracy : 0.813321 max acc epoch : 30 test accuracy : 0.779966

Epoch :  32 loss training:  38.147219594568014 Time :  1094
accuracy train: 0.960940 val: 0.807692 test: 0.778559
max validation accuracy : 0.813321 max acc epoch : 30 test accuracy : 0.779966

Epoch :  33 loss training:  35.95404975116253 Time :  1104
accuracy train: 0.963588 val: 0.800188 test: 0.782780
max validation accuracy : 0.813321 max acc epoch : 30 test accuracy : 0.779966

Epoch :  34 loss training:  34.450684517621994 Time :  1114
accuracy train: 0.964912 val: 0.800188 test: 0.776590
max validation accuracy : 0.813321 max acc epoch : 30 test accuracy : 0.779966

Epoch :  35 loss training:  34.87749518454075 Time :  1124
accuracy train: 0.967229 val: 0.796435 test: 0.777715
max validation accuracy : 0.813321 max acc epoch : 30 test accuracy : 0.779966

Epoch :  36 loss training:  31.172595988959074 Time :  1133
accuracy train: 0.973022 val: 0.803002 test: 0.778559
max validation accuracy : 0.813321 max acc epoch : 30 test accuracy : 0.779966

Epoch :  37 loss training:  29.48723614960909 Time :  1143
accuracy train: 0.976498 val: 0.803940 test: 0.778278
max validation accuracy : 0.813321 max acc epoch : 30 test accuracy : 0.779966

Epoch :  38 loss training:  29.130106780678034 Time :  1153
accuracy train: 0.977822 val: 0.803002 test: 0.777997
max validation accuracy : 0.813321 max acc epoch : 30 test accuracy : 0.779966

Epoch :  39 loss training:  28.282293491065502 Time :  1164
accuracy train: 0.978484 val: 0.796435 test: 0.775464
max validation accuracy : 0.813321 max acc epoch : 30 test accuracy : 0.779966

Epoch :  40 loss training:  27.63107744604349 Time :  1174
accuracy train: 0.978318 val: 0.802064 test: 0.775183
max validation accuracy : 0.813321 max acc epoch : 30 test accuracy : 0.779966

Epoch :  41 loss training:  26.25292777083814 Time :  1184
accuracy train: 0.981960 val: 0.797373 test: 0.777153
max validation accuracy : 0.813321 max acc epoch : 30 test accuracy : 0.779966

========================================================================================================================================================================================================
best acc epoch :  30
validation accuracy :  0.8133208255159474
test accuracy :  0.7799662352279122
last test_accuracy :  0.7771525042205966
second best val :  0.8086303939962477
second best test :  0.7841868317388858
max gap 6
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  37 	 val_accuracy : 0.79268 	 test_accuracy : 0.79010 	 last test_accuracy : 0.78109 	 second best val : 0.78705 	 second best test : 0.79038
k :  1 	 best_acc epoch :  3 	 val_accuracy : 0.76642 	 test_accuracy : 0.76787 	 last test_accuracy : 0.77912 	 second best val : 0.76360 	 second best test : 0.76787
k :  2 	 best_acc epoch :  8 	 val_accuracy : 0.77674 	 test_accuracy : 0.77856 	 last test_accuracy : 0.78334 	 second best val : 0.77392 	 second best test : 0.77856
k :  3 	 best_acc epoch :  30 	 val_accuracy : 0.81332 	 test_accuracy : 0.77997 	 last test_accuracy : 0.77715 	 second best val : 0.80863 	 second best test : 0.78419

avg :  	 val_accuracy : 0.78729 	 test_accuracy : 0.77912 	 last_accuracy : 0.78018 	 second best val : 0.78330 	 second best test : 0.78025

std :  	 val_accuracy : 0.01770 	 test_accuracy : 0.00788 	 last_accuracy : 0.00230 	 second best val : 0.01682 	 second best test : 0.00828


date and time :  Sun Jul  4 18:22:59 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=768, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0
Counter({0: 6214, 1: 4448})

Epoch :  1 loss training:  94.86794400215149 Time :  13
accuracy train: 0.759351 val: 0.755159 test: 0.756894
max validation accuracy : 0.755159 max acc epoch : 1 test accuracy : 0.756894
Counter({1: 6137, 0: 4525})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  88.68302211165428 Time :  26
accuracy train: 0.759351 val: 0.759850 test: 0.751548
max validation accuracy : 0.759850 max acc epoch : 2 test accuracy : 0.751548
Counter({1: 6112, 0: 4550})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  85.3087349832058 Time :  39
accuracy train: 0.788812 val: 0.768293 test: 0.765616
max validation accuracy : 0.768293 max acc epoch : 3 test accuracy : 0.765616
Counter({1: 6224, 0: 4438})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.38497284054756 Time :  53
accuracy train: 0.795432 val: 0.776735 test: 0.765335
max validation accuracy : 0.776735 max acc epoch : 4 test accuracy : 0.765335
Counter({1: 6271, 0: 4391})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.37444224953651 Time :  66
accuracy train: 0.791129 val: 0.787992 test: 0.771525
max validation accuracy : 0.787992 max acc epoch : 5 test accuracy : 0.771525
Counter({0: 6327, 1: 4335})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.16055765748024 Time :  79
accuracy train: 0.794770 val: 0.783302 test: 0.765053
max validation accuracy : 0.787992 max acc epoch : 5 test accuracy : 0.771525
Counter({1: 6378, 0: 4284})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  78.03585249185562 Time :  96
accuracy train: 0.787653 val: 0.768293 test: 0.764491
max validation accuracy : 0.787992 max acc epoch : 5 test accuracy : 0.771525
Counter({1: 6374, 0: 4288})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.67435303330421 Time :  109
accuracy train: 0.804038 val: 0.781426 test: 0.767867
max validation accuracy : 0.787992 max acc epoch : 5 test accuracy : 0.771525
Counter({1: 6350, 0: 4312})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  75.7313430160284 Time :  123
accuracy train: 0.808673 val: 0.783302 test: 0.774057
max validation accuracy : 0.787992 max acc epoch : 5 test accuracy : 0.771525
Counter({1: 6376, 0: 4286})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.10352219641209 Time :  135
accuracy train: 0.809831 val: 0.781426 test: 0.773776
max validation accuracy : 0.787992 max acc epoch : 5 test accuracy : 0.771525
Counter({1: 6387, 0: 4275})

Epoch :  11 loss training:  74.84998899698257 Time :  151
accuracy train: 0.815458 val: 0.783302 test: 0.776027
max validation accuracy : 0.787992 max acc epoch : 5 test accuracy : 0.771525
Counter({1: 6351, 0: 4311})

Epoch :  12 loss training:  74.43088346719742 Time :  164
accuracy train: 0.825389 val: 0.787054 test: 0.774339
max validation accuracy : 0.787992 max acc epoch : 5 test accuracy : 0.771525
Counter({1: 6368, 0: 4294})

Epoch :  13 loss training:  72.39468482136726 Time :  177
accuracy train: 0.828699 val: 0.784240 test: 0.775746
max validation accuracy : 0.787992 max acc epoch : 5 test accuracy : 0.771525
Counter({1: 6383, 0: 4279})

Epoch :  14 loss training:  69.10976541042328 Time :  191
accuracy train: 0.825223 val: 0.785178 test: 0.770400
max validation accuracy : 0.787992 max acc epoch : 5 test accuracy : 0.771525
Counter({1: 6371, 0: 4291})

Epoch :  15 loss training:  66.65065409243107 Time :  207
accuracy train: 0.845084 val: 0.788931 test: 0.779122
max validation accuracy : 0.788931 max acc epoch : 15 test accuracy : 0.779122
Counter({1: 6351, 0: 4311})

Epoch :  16 loss training:  65.44104245305061 Time :  221
accuracy train: 0.857498 val: 0.787054 test: 0.781654
max validation accuracy : 0.788931 max acc epoch : 15 test accuracy : 0.779122
Counter({0: 6367, 1: 4295})

Epoch :  17 loss training:  63.77924156188965 Time :  233
accuracy train: 0.864780 val: 0.789869 test: 0.781373
max validation accuracy : 0.789869 max acc epoch : 17 test accuracy : 0.781373
Counter({1: 6329, 0: 4333})

Epoch :  18 loss training:  61.64464592933655 Time :  249
accuracy train: 0.872393 val: 0.787054 test: 0.783343
max validation accuracy : 0.789869 max acc epoch : 17 test accuracy : 0.781373
Counter({1: 6296, 0: 4366})

Epoch :  19 loss training:  59.88205571472645 Time :  262
accuracy train: 0.876862 val: 0.793621 test: 0.779685
max validation accuracy : 0.793621 max acc epoch : 19 test accuracy : 0.779685
Counter({1: 6280, 0: 4382})

Epoch :  20 loss training:  57.943363904953 Time :  275
accuracy train: 0.881662 val: 0.794559 test: 0.782499
max validation accuracy : 0.794559 max acc epoch : 20 test accuracy : 0.782499
Counter({1: 6271, 0: 4391})

Epoch :  21 loss training:  56.041638761758804 Time :  289
accuracy train: 0.900033 val: 0.788931 test: 0.787001
max validation accuracy : 0.794559 max acc epoch : 20 test accuracy : 0.782499
Counter({0: 6224, 1: 4438})

Epoch :  22 loss training:  52.80514733493328 Time :  302
accuracy train: 0.910957 val: 0.793621 test: 0.785875
max validation accuracy : 0.794559 max acc epoch : 20 test accuracy : 0.782499
Counter({1: 6181, 0: 4481})

Epoch :  23 loss training:  51.549937933683395 Time :  316
accuracy train: 0.919067 val: 0.791745 test: 0.785031
max validation accuracy : 0.794559 max acc epoch : 20 test accuracy : 0.782499
Counter({1: 6166, 0: 4496})

Epoch :  24 loss training:  49.190299458801746 Time :  329
accuracy train: 0.919232 val: 0.791745 test: 0.781654
max validation accuracy : 0.794559 max acc epoch : 20 test accuracy : 0.782499
Counter({1: 6123, 0: 4539})

Epoch :  25 loss training:  48.71212427318096 Time :  344
accuracy train: 0.930156 val: 0.785178 test: 0.780248
max validation accuracy : 0.794559 max acc epoch : 20 test accuracy : 0.782499
Counter({1: 6125, 0: 4537})

Epoch :  26 loss training:  45.852269634604454 Time :  357
accuracy train: 0.929328 val: 0.791745 test: 0.781936
max validation accuracy : 0.794559 max acc epoch : 20 test accuracy : 0.782499
Counter({1: 6143, 0: 4519})

Epoch :  27 loss training:  44.10038843750954 Time :  371
accuracy train: 0.938596 val: 0.791745 test: 0.783061
max validation accuracy : 0.794559 max acc epoch : 20 test accuracy : 0.782499
Counter({1: 6129, 0: 4533})

Epoch :  28 loss training:  42.91242162883282 Time :  384
accuracy train: 0.942569 val: 0.782364 test: 0.779685
max validation accuracy : 0.794559 max acc epoch : 20 test accuracy : 0.782499
Counter({1: 6138, 0: 4524})

Epoch :  29 loss training:  40.93359945714474 Time :  399
accuracy train: 0.946706 val: 0.782364 test: 0.774620
max validation accuracy : 0.794559 max acc epoch : 20 test accuracy : 0.782499
Counter({1: 6141, 0: 4521})

Epoch :  30 loss training:  39.103588718920946 Time :  412
accuracy train: 0.952996 val: 0.787992 test: 0.779403
max validation accuracy : 0.794559 max acc epoch : 20 test accuracy : 0.782499
Counter({1: 6164, 0: 4498})

Epoch :  31 loss training:  36.921561658382416 Time :  425
accuracy train: 0.958788 val: 0.783302 test: 0.780810
max validation accuracy : 0.794559 max acc epoch : 20 test accuracy : 0.782499
Counter({1: 6135, 0: 4527})

========================================================================================================================================================================================================
best acc epoch :  20
validation accuracy :  0.7945590994371482
test accuracy :  0.7824985931344963
last test_accuracy :  0.7808103545301069
second best val :  0.7936210131332082
second best test :  0.7796848621271807
max gap 10
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=123, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0
Counter({0: 6186, 1: 4476})

Epoch :  1 loss training:  98.6468215584755 Time :  441
accuracy train: 0.771930 val: 0.767355 test: 0.768993
max validation accuracy : 0.767355 max acc epoch : 1 test accuracy : 0.768993
Counter({0: 5571, 1: 5091})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.88781461119652 Time :  455
accuracy train: 0.781198 val: 0.750469 test: 0.767586
max validation accuracy : 0.767355 max acc epoch : 1 test accuracy : 0.768993
Counter({0: 5494, 1: 5168})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  87.33301347494125 Time :  471
accuracy train: 0.782853 val: 0.751407 test: 0.758019
max validation accuracy : 0.767355 max acc epoch : 1 test accuracy : 0.768993
Counter({0: 5615, 1: 5047})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.64437207579613 Time :  485
accuracy train: 0.797749 val: 0.771107 test: 0.770962
max validation accuracy : 0.771107 max acc epoch : 4 test accuracy : 0.770962
Counter({1: 5589, 0: 5073})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  78.4830100685358 Time :  500
accuracy train: 0.798577 val: 0.769231 test: 0.772932
max validation accuracy : 0.771107 max acc epoch : 4 test accuracy : 0.770962
Counter({1: 5671, 0: 4991})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  78.89458183944225 Time :  512
accuracy train: 0.796756 val: 0.775797 test: 0.775183
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.775183
Counter({0: 5706, 1: 4956})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.89650505781174 Time :  530
accuracy train: 0.809997 val: 0.763602 test: 0.774620
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.775183
Counter({1: 5760, 0: 4902})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.81262245774269 Time :  543
accuracy train: 0.811652 val: 0.761726 test: 0.774339
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.775183
Counter({1: 5795, 0: 4867})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.04859244823456 Time :  558
accuracy train: 0.811983 val: 0.761726 test: 0.773776
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.775183
Counter({1: 5820, 0: 4842})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.38943110406399 Time :  571
accuracy train: 0.814300 val: 0.771107 test: 0.775746
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.775183
Counter({1: 5839, 0: 4823})

Epoch :  11 loss training:  73.36368550360203 Time :  584
accuracy train: 0.821582 val: 0.765478 test: 0.775746
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.775183
Counter({1: 5845, 0: 4817})

Epoch :  12 loss training:  72.72619420289993 Time :  598
accuracy train: 0.826216 val: 0.758912 test: 0.774620
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.775183
Counter({1: 5882, 0: 4780})

Epoch :  13 loss training:  70.84376461803913 Time :  612
accuracy train: 0.832175 val: 0.765478 test: 0.775183
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.775183
Counter({0: 5874, 1: 4788})

Epoch :  14 loss training:  69.00833956897259 Time :  625
accuracy train: 0.843760 val: 0.761726 test: 0.774057
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.775183
Counter({0: 5922, 1: 4740})

Epoch :  15 loss training:  67.48315753042698 Time :  640
accuracy train: 0.851374 val: 0.772045 test: 0.780810
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.775183
Counter({1: 5916, 0: 4746})

Epoch :  16 loss training:  65.77179180085659 Time :  657
accuracy train: 0.861966 val: 0.784240 test: 0.781654
max validation accuracy : 0.784240 max acc epoch : 16 test accuracy : 0.781654
Counter({1: 5914, 0: 4748})

Epoch :  17 loss training:  63.121879667043686 Time :  671
accuracy train: 0.867594 val: 0.777674 test: 0.782499
max validation accuracy : 0.784240 max acc epoch : 16 test accuracy : 0.781654
Counter({1: 5909, 0: 4753})

Epoch :  18 loss training:  62.07912215590477 Time :  685
accuracy train: 0.879676 val: 0.781426 test: 0.779966
max validation accuracy : 0.784240 max acc epoch : 16 test accuracy : 0.781654
Counter({1: 5902, 0: 4760})

Epoch :  19 loss training:  59.214734613895416 Time :  698
accuracy train: 0.889441 val: 0.779550 test: 0.780810
max validation accuracy : 0.784240 max acc epoch : 16 test accuracy : 0.781654
Counter({1: 5891, 0: 4771})

Epoch :  20 loss training:  58.177639707922935 Time :  717
accuracy train: 0.893909 val: 0.772045 test: 0.779403
max validation accuracy : 0.784240 max acc epoch : 16 test accuracy : 0.781654
Counter({0: 5912, 1: 4750})

Epoch :  21 loss training:  55.69948881864548 Time :  728
accuracy train: 0.901523 val: 0.780488 test: 0.777153
max validation accuracy : 0.784240 max acc epoch : 16 test accuracy : 0.781654
Counter({0: 5872, 1: 4790})

Epoch :  22 loss training:  53.82466313242912 Time :  742
accuracy train: 0.916087 val: 0.777674 test: 0.780810
max validation accuracy : 0.784240 max acc epoch : 16 test accuracy : 0.781654
Counter({1: 5885, 0: 4777})

Epoch :  23 loss training:  52.34981510043144 Time :  755
accuracy train: 0.917411 val: 0.778612 test: 0.774620
max validation accuracy : 0.784240 max acc epoch : 16 test accuracy : 0.781654
Counter({1: 5861, 0: 4801})

Epoch :  24 loss training:  50.18769282847643 Time :  769
accuracy train: 0.927507 val: 0.793621 test: 0.780248
max validation accuracy : 0.793621 max acc epoch : 24 test accuracy : 0.780248
Counter({1: 5839, 0: 4823})

Epoch :  25 loss training:  48.17563437670469 Time :  788
accuracy train: 0.932969 val: 0.783302 test: 0.774339
max validation accuracy : 0.793621 max acc epoch : 24 test accuracy : 0.780248
Counter({1: 5779, 0: 4883})

Epoch :  26 loss training:  46.800264805555344 Time :  802
accuracy train: 0.935121 val: 0.775797 test: 0.769555
max validation accuracy : 0.793621 max acc epoch : 24 test accuracy : 0.780248
Counter({1: 5784, 0: 4878})

Epoch :  27 loss training:  45.751598350703716 Time :  816
accuracy train: 0.945548 val: 0.787992 test: 0.778278
max validation accuracy : 0.793621 max acc epoch : 24 test accuracy : 0.780248
Counter({1: 5759, 0: 4903})

Epoch :  28 loss training:  43.08841945976019 Time :  829
accuracy train: 0.948527 val: 0.781426 test: 0.771806
max validation accuracy : 0.793621 max acc epoch : 24 test accuracy : 0.780248
Counter({1: 5776, 0: 4886})

Epoch :  29 loss training:  41.5155304223299 Time :  843
accuracy train: 0.955644 val: 0.778612 test: 0.774902
max validation accuracy : 0.793621 max acc epoch : 24 test accuracy : 0.780248
Counter({1: 5751, 0: 4911})

Epoch :  30 loss training:  39.184143513441086 Time :  862
accuracy train: 0.959616 val: 0.779550 test: 0.775746
max validation accuracy : 0.793621 max acc epoch : 24 test accuracy : 0.780248
Counter({1: 5732, 0: 4930})

Epoch :  31 loss training:  37.11389969289303 Time :  876
accuracy train: 0.960940 val: 0.772983 test: 0.772651
max validation accuracy : 0.793621 max acc epoch : 24 test accuracy : 0.780248
Counter({1: 5748, 0: 4914})

Epoch :  32 loss training:  36.80443109944463 Time :  890
accuracy train: 0.963423 val: 0.775797 test: 0.772932
max validation accuracy : 0.793621 max acc epoch : 24 test accuracy : 0.780248
Counter({0: 5759, 1: 4903})

Epoch :  33 loss training:  34.692323084920645 Time :  903
accuracy train: 0.967395 val: 0.772983 test: 0.767586
max validation accuracy : 0.793621 max acc epoch : 24 test accuracy : 0.780248
Counter({1: 5766, 0: 4896})

Epoch :  34 loss training:  33.9581045769155 Time :  920
accuracy train: 0.970871 val: 0.770169 test: 0.763647
max validation accuracy : 0.793621 max acc epoch : 24 test accuracy : 0.780248
Counter({1: 5800, 0: 4862})

Epoch :  35 loss training:  31.32662684097886 Time :  936
accuracy train: 0.975339 val: 0.767355 test: 0.769555
max validation accuracy : 0.793621 max acc epoch : 24 test accuracy : 0.780248
Counter({1: 5761, 0: 4901})

========================================================================================================================================================================================================
best acc epoch :  24
validation accuracy :  0.7936210131332082
test accuracy :  0.7802476083286438
last test_accuracy :  0.7695554305008441
second best val :  0.7879924953095685
second best test :  0.7802476083286438
max gap 10
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=920, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0
Counter({1: 6188, 0: 4474})

Epoch :  1 loss training:  97.1639614701271 Time :  957
accuracy train: 0.774081 val: 0.731707 test: 0.758582
max validation accuracy : 0.731707 max acc epoch : 1 test accuracy : 0.758582
Counter({0: 5389, 1: 5273})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.51273542642593 Time :  969
accuracy train: 0.783681 val: 0.737336 test: 0.772932
max validation accuracy : 0.737336 max acc epoch : 2 test accuracy : 0.772932
Counter({1: 6087, 0: 4575})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  86.25115686655045 Time :  983
accuracy train: 0.781033 val: 0.747655 test: 0.763084
max validation accuracy : 0.747655 max acc epoch : 3 test accuracy : 0.763084
Counter({1: 6165, 0: 4497})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  80.70548358559608 Time :  996
accuracy train: 0.796922 val: 0.751407 test: 0.778278
max validation accuracy : 0.751407 max acc epoch : 4 test accuracy : 0.778278
Counter({0: 5456, 1: 5206})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  81.07301324605942 Time :  1013
accuracy train: 0.800066 val: 0.745779 test: 0.773495
max validation accuracy : 0.751407 max acc epoch : 4 test accuracy : 0.778278
Counter({1: 5332, 0: 5330})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.6442893743515 Time :  1031
accuracy train: 0.803542 val: 0.743902 test: 0.772932
max validation accuracy : 0.751407 max acc epoch : 4 test accuracy : 0.778278
Counter({0: 5754, 1: 4908})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.83957329392433 Time :  1045
accuracy train: 0.809169 val: 0.748593 test: 0.779122
max validation accuracy : 0.751407 max acc epoch : 4 test accuracy : 0.778278
Counter({1: 5840, 0: 4822})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  77.70428517460823 Time :  1059
accuracy train: 0.813638 val: 0.749531 test: 0.777434
max validation accuracy : 0.751407 max acc epoch : 4 test accuracy : 0.778278
Counter({1: 5914, 0: 4748})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  77.59286013245583 Time :  1073
accuracy train: 0.814465 val: 0.750469 test: 0.777997
max validation accuracy : 0.751407 max acc epoch : 4 test accuracy : 0.778278
Counter({1: 6003, 0: 4659})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  74.7129668444395 Time :  1086
accuracy train: 0.811321 val: 0.752345 test: 0.778278
max validation accuracy : 0.752345 max acc epoch : 10 test accuracy : 0.778278
Counter({0: 6096, 1: 4566})

Epoch :  11 loss training:  74.35245172679424 Time :  1104
accuracy train: 0.820424 val: 0.749531 test: 0.773776
max validation accuracy : 0.752345 max acc epoch : 10 test accuracy : 0.778278
Counter({0: 6101, 1: 4561})

Epoch :  12 loss training:  73.39394058287144 Time :  1118
accuracy train: 0.825720 val: 0.753283 test: 0.779122
max validation accuracy : 0.753283 max acc epoch : 12 test accuracy : 0.779122
Counter({0: 6060, 1: 4602})

Epoch :  13 loss training:  72.74006135761738 Time :  1132
accuracy train: 0.830354 val: 0.753283 test: 0.781936
max validation accuracy : 0.753283 max acc epoch : 12 test accuracy : 0.779122
Counter({1: 6050, 0: 4612})

Epoch :  14 loss training:  69.83207675814629 Time :  1146
accuracy train: 0.842933 val: 0.756098 test: 0.782780
max validation accuracy : 0.756098 max acc epoch : 14 test accuracy : 0.782780
Counter({0: 6081, 1: 4581})

Epoch :  15 loss training:  67.56986021995544 Time :  1161
accuracy train: 0.852698 val: 0.754221 test: 0.781373
max validation accuracy : 0.756098 max acc epoch : 14 test accuracy : 0.782780
Counter({1: 6088, 0: 4574})

Epoch :  16 loss training:  65.2319833189249 Time :  1179
accuracy train: 0.854849 val: 0.760788 test: 0.780810
max validation accuracy : 0.760788 max acc epoch : 16 test accuracy : 0.780810
Counter({0: 6102, 1: 4560})

Epoch :  17 loss training:  64.78407788276672 Time :  1192
accuracy train: 0.861801 val: 0.761726 test: 0.782499
max validation accuracy : 0.761726 max acc epoch : 17 test accuracy : 0.782499
Counter({0: 6087, 1: 4575})

Epoch :  18 loss training:  63.004662200808525 Time :  1207
accuracy train: 0.862132 val: 0.766417 test: 0.783343
max validation accuracy : 0.766417 max acc epoch : 18 test accuracy : 0.783343
Counter({0: 6145, 1: 4517})

Epoch :  19 loss training:  60.74736048281193 Time :  1221
accuracy train: 0.872559 val: 0.768293 test: 0.784750
max validation accuracy : 0.768293 max acc epoch : 19 test accuracy : 0.784750
Counter({0: 6185, 1: 4477})

Epoch :  20 loss training:  59.09591533243656 Time :  1235
accuracy train: 0.879841 val: 0.772983 test: 0.788126
max validation accuracy : 0.772983 max acc epoch : 20 test accuracy : 0.788126
Counter({1: 6316, 0: 4346})

Epoch :  21 loss training:  55.423478588461876 Time :  1250
accuracy train: 0.892420 val: 0.776735 test: 0.784750
max validation accuracy : 0.776735 max acc epoch : 21 test accuracy : 0.784750
Counter({1: 6338, 0: 4324})

Epoch :  22 loss training:  54.04081982374191 Time :  1265
accuracy train: 0.900861 val: 0.772045 test: 0.785312
max validation accuracy : 0.776735 max acc epoch : 21 test accuracy : 0.784750
Counter({0: 6325, 1: 4337})

Epoch :  23 loss training:  52.03244234621525 Time :  1279
accuracy train: 0.908309 val: 0.775797 test: 0.784750
max validation accuracy : 0.776735 max acc epoch : 21 test accuracy : 0.784750
Counter({0: 6356, 1: 4306})

Epoch :  24 loss training:  50.860804691910744 Time :  1291
accuracy train: 0.911453 val: 0.777674 test: 0.785594
max validation accuracy : 0.777674 max acc epoch : 24 test accuracy : 0.785594
Counter({0: 6334, 1: 4328})

Epoch :  25 loss training:  48.822428315877914 Time :  1306
accuracy train: 0.916749 val: 0.773921 test: 0.787001
max validation accuracy : 0.777674 max acc epoch : 24 test accuracy : 0.785594
Counter({0: 6377, 1: 4285})

Epoch :  26 loss training:  46.309648267924786 Time :  1325
accuracy train: 0.926349 val: 0.776735 test: 0.783624
max validation accuracy : 0.777674 max acc epoch : 24 test accuracy : 0.785594
Counter({0: 6354, 1: 4308})

Epoch :  27 loss training:  46.07780434191227 Time :  1341
accuracy train: 0.932804 val: 0.775797 test: 0.785312
max validation accuracy : 0.777674 max acc epoch : 24 test accuracy : 0.785594
Counter({1: 6386, 0: 4276})

Epoch :  28 loss training:  42.095867626369 Time :  1355
accuracy train: 0.934459 val: 0.782364 test: 0.787001
max validation accuracy : 0.782364 max acc epoch : 28 test accuracy : 0.787001
Counter({0: 6372, 1: 4290})

Epoch :  29 loss training:  42.95050485432148 Time :  1368
accuracy train: 0.942238 val: 0.777674 test: 0.782499
max validation accuracy : 0.782364 max acc epoch : 28 test accuracy : 0.787001
Counter({0: 6397, 1: 4265})

Epoch :  30 loss training:  40.74366248399019 Time :  1382
accuracy train: 0.945713 val: 0.778612 test: 0.780810
max validation accuracy : 0.782364 max acc epoch : 28 test accuracy : 0.787001
Counter({0: 6388, 1: 4274})

Epoch :  31 loss training:  38.296684354543686 Time :  1400
accuracy train: 0.952665 val: 0.781426 test: 0.781654
max validation accuracy : 0.782364 max acc epoch : 28 test accuracy : 0.787001
Counter({1: 6440, 0: 4222})

Epoch :  32 loss training:  36.22716820240021 Time :  1414
accuracy train: 0.954982 val: 0.776735 test: 0.781936
max validation accuracy : 0.782364 max acc epoch : 28 test accuracy : 0.787001
Counter({0: 6453, 1: 4209})

Epoch :  33 loss training:  34.389765311032534 Time :  1429
accuracy train: 0.951010 val: 0.775797 test: 0.782780
max validation accuracy : 0.782364 max acc epoch : 28 test accuracy : 0.787001
Counter({1: 6409, 0: 4253})

Epoch :  34 loss training:  32.876181963831186 Time :  1443
accuracy train: 0.966071 val: 0.777674 test: 0.784187
max validation accuracy : 0.782364 max acc epoch : 28 test accuracy : 0.787001
Counter({0: 6473, 1: 4189})

Epoch :  35 loss training:  32.00741274654865 Time :  1457
accuracy train: 0.968719 val: 0.779550 test: 0.784750
max validation accuracy : 0.782364 max acc epoch : 28 test accuracy : 0.787001
Counter({0: 6464, 1: 4198})

Epoch :  36 loss training:  30.065505243837833 Time :  1475
accuracy train: 0.970374 val: 0.774859 test: 0.783624
max validation accuracy : 0.782364 max acc epoch : 28 test accuracy : 0.787001
Counter({0: 6508, 1: 4154})

Epoch :  37 loss training:  29.413320168852806 Time :  1489
accuracy train: 0.967560 val: 0.775797 test: 0.779403
max validation accuracy : 0.782364 max acc epoch : 28 test accuracy : 0.787001
Counter({0: 6454, 1: 4208})

Epoch :  38 loss training:  28.257514152675867 Time :  1503
accuracy train: 0.976167 val: 0.777674 test: 0.779122
max validation accuracy : 0.782364 max acc epoch : 28 test accuracy : 0.787001
Counter({0: 6459, 1: 4203})

Epoch :  39 loss training:  27.163745183497667 Time :  1517
accuracy train: 0.979146 val: 0.779550 test: 0.784187
max validation accuracy : 0.782364 max acc epoch : 28 test accuracy : 0.787001
Counter({0: 6481, 1: 4181})

========================================================================================================================================================================================================
best acc epoch :  28
validation accuracy :  0.7823639774859287
test accuracy :  0.7870005627462014
last test_accuracy :  0.7841868317388858
second best val :  0.7814258911819888
second best test :  0.7870005627462014
max gap 6
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=936, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0
Counter({1: 6207, 0: 4455})

Epoch :  1 loss training:  98.1936631500721 Time :  1534
accuracy train: 0.760179 val: 0.730769 test: 0.749297
max validation accuracy : 0.730769 max acc epoch : 1 test accuracy : 0.749297
Counter({1: 6207, 0: 4455})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.35893109440804 Time :  1548
accuracy train: 0.783019 val: 0.744841 test: 0.765616
max validation accuracy : 0.744841 max acc epoch : 2 test accuracy : 0.765616
Counter({1: 6164, 0: 4498})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  84.34747043251991 Time :  1565
accuracy train: 0.767461 val: 0.740150 test: 0.752673
max validation accuracy : 0.744841 max acc epoch : 2 test accuracy : 0.765616
Counter({0: 6000, 1: 4662})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  80.35193911194801 Time :  1579
accuracy train: 0.783846 val: 0.744841 test: 0.771806
max validation accuracy : 0.744841 max acc epoch : 2 test accuracy : 0.765616
Counter({1: 5898, 0: 4764})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  79.85692089796066 Time :  1592
accuracy train: 0.796425 val: 0.744841 test: 0.772369
max validation accuracy : 0.744841 max acc epoch : 2 test accuracy : 0.765616
Counter({1: 5674, 0: 4988})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  78.8983339369297 Time :  1607
accuracy train: 0.789970 val: 0.742964 test: 0.766742
max validation accuracy : 0.744841 max acc epoch : 2 test accuracy : 0.765616
Counter({1: 5595, 0: 5067})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.07707095146179 Time :  1624
accuracy train: 0.803873 val: 0.739212 test: 0.776308
max validation accuracy : 0.744841 max acc epoch : 2 test accuracy : 0.765616
Counter({0: 5501, 1: 5161})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  75.4308355152607 Time :  1638
accuracy train: 0.810328 val: 0.753283 test: 0.773776
max validation accuracy : 0.753283 max acc epoch : 8 test accuracy : 0.773776
Counter({1: 5476, 0: 5186})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.49317993223667 Time :  1653
accuracy train: 0.811652 val: 0.745779 test: 0.779403
max validation accuracy : 0.753283 max acc epoch : 8 test accuracy : 0.773776
Counter({0: 5351, 1: 5311})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  76.08713752031326 Time :  1667
accuracy train: 0.805528 val: 0.744841 test: 0.774620
max validation accuracy : 0.753283 max acc epoch : 8 test accuracy : 0.773776
Counter({1: 5340, 0: 5322})

Epoch :  11 loss training:  73.0981495976448 Time :  1681
accuracy train: 0.818107 val: 0.749531 test: 0.778278
max validation accuracy : 0.753283 max acc epoch : 8 test accuracy : 0.773776
Counter({0: 5354, 1: 5308})

Epoch :  12 loss training:  71.17833477258682 Time :  1697
accuracy train: 0.823899 val: 0.756098 test: 0.780529
max validation accuracy : 0.756098 max acc epoch : 12 test accuracy : 0.780529
Counter({0: 5387, 1: 5275})

Epoch :  13 loss training:  71.18266054987907 Time :  1712
accuracy train: 0.831513 val: 0.755159 test: 0.776027
max validation accuracy : 0.756098 max acc epoch : 12 test accuracy : 0.780529
Counter({0: 5474, 1: 5188})

Epoch :  14 loss training:  69.45365869998932 Time :  1726
accuracy train: 0.837471 val: 0.753283 test: 0.777715
max validation accuracy : 0.756098 max acc epoch : 12 test accuracy : 0.780529
Counter({1: 5520, 0: 5142})

Epoch :  15 loss training:  67.18951208889484 Time :  1739
accuracy train: 0.848229 val: 0.752345 test: 0.777997
max validation accuracy : 0.756098 max acc epoch : 12 test accuracy : 0.780529
Counter({0: 5587, 1: 5075})

Epoch :  16 loss training:  66.72019131481647 Time :  1752
accuracy train: 0.853194 val: 0.758912 test: 0.777715
max validation accuracy : 0.758912 max acc epoch : 16 test accuracy : 0.777715
Counter({0: 5611, 1: 5051})

Epoch :  17 loss training:  63.468976363539696 Time :  1767
accuracy train: 0.860477 val: 0.762664 test: 0.777153
max validation accuracy : 0.762664 max acc epoch : 17 test accuracy : 0.777153
Counter({1: 5636, 0: 5026})

Epoch :  18 loss training:  61.1719616651535 Time :  1781
accuracy train: 0.870407 val: 0.760788 test: 0.778841
max validation accuracy : 0.762664 max acc epoch : 17 test accuracy : 0.777153
Counter({1: 5668, 0: 4994})

Epoch :  19 loss training:  59.77645839750767 Time :  1796
accuracy train: 0.876034 val: 0.760788 test: 0.776590
max validation accuracy : 0.762664 max acc epoch : 17 test accuracy : 0.777153
Counter({0: 5816, 1: 4846})

Epoch :  20 loss training:  56.35161654651165 Time :  1808
accuracy train: 0.891758 val: 0.765478 test: 0.779966
max validation accuracy : 0.765478 max acc epoch : 20 test accuracy : 0.779966
Counter({0: 5893, 1: 4769})

Epoch :  21 loss training:  54.98451855778694 Time :  1823
accuracy train: 0.894240 val: 0.767355 test: 0.779403
max validation accuracy : 0.767355 max acc epoch : 21 test accuracy : 0.779403
Counter({1: 5885, 0: 4777})

Epoch :  22 loss training:  52.687203243374825 Time :  1836
accuracy train: 0.905826 val: 0.768293 test: 0.779122
max validation accuracy : 0.768293 max acc epoch : 22 test accuracy : 0.779122
Counter({1: 5921, 0: 4741})

Epoch :  23 loss training:  51.3704059869051 Time :  1850
accuracy train: 0.908309 val: 0.761726 test: 0.779966
max validation accuracy : 0.768293 max acc epoch : 22 test accuracy : 0.779122
Counter({0: 5913, 1: 4749})

Epoch :  24 loss training:  49.071602530777454 Time :  1864
accuracy train: 0.914267 val: 0.766417 test: 0.777715
max validation accuracy : 0.768293 max acc epoch : 22 test accuracy : 0.779122
Counter({1: 5973, 0: 4689})

Epoch :  25 loss training:  48.23727110028267 Time :  1878
accuracy train: 0.923866 val: 0.774859 test: 0.776027
max validation accuracy : 0.774859 max acc epoch : 25 test accuracy : 0.776027
Counter({0: 5994, 1: 4668})

Epoch :  26 loss training:  45.73722702264786 Time :  1890
accuracy train: 0.926680 val: 0.774859 test: 0.778278
max validation accuracy : 0.774859 max acc epoch : 25 test accuracy : 0.776027
Counter({0: 6001, 1: 4661})

Epoch :  27 loss training:  43.96004121005535 Time :  1903
accuracy train: 0.931976 val: 0.773921 test: 0.778841
max validation accuracy : 0.774859 max acc epoch : 25 test accuracy : 0.776027
Counter({1: 6012, 0: 4650})

Epoch :  28 loss training:  42.11697296053171 Time :  1917
accuracy train: 0.938928 val: 0.769231 test: 0.772369
max validation accuracy : 0.774859 max acc epoch : 25 test accuracy : 0.776027
Counter({0: 6054, 1: 4608})

Epoch :  29 loss training:  38.98821362107992 Time :  1930
accuracy train: 0.947534 val: 0.776735 test: 0.781936
max validation accuracy : 0.776735 max acc epoch : 29 test accuracy : 0.781936
Counter({0: 6041, 1: 4621})

Epoch :  30 loss training:  38.37646114081144 Time :  1942
accuracy train: 0.946375 val: 0.776735 test: 0.772088
max validation accuracy : 0.776735 max acc epoch : 29 test accuracy : 0.781936
Counter({0: 6042, 1: 4620})

Epoch :  31 loss training:  37.134184427559376 Time :  1955
accuracy train: 0.956471 val: 0.774859 test: 0.779403
max validation accuracy : 0.776735 max acc epoch : 29 test accuracy : 0.781936
Counter({1: 6033, 0: 4629})

Epoch :  32 loss training:  34.51751870661974 Time :  1967
accuracy train: 0.957961 val: 0.776735 test: 0.776590
max validation accuracy : 0.776735 max acc epoch : 29 test accuracy : 0.781936
Counter({1: 6045, 0: 4617})

Epoch :  33 loss training:  33.45732678472996 Time :  1980
accuracy train: 0.964250 val: 0.775797 test: 0.785875
max validation accuracy : 0.776735 max acc epoch : 29 test accuracy : 0.781936
Counter({0: 6051, 1: 4611})

Epoch :  34 loss training:  31.76325173303485 Time :  1993
accuracy train: 0.966733 val: 0.774859 test: 0.776871
max validation accuracy : 0.776735 max acc epoch : 29 test accuracy : 0.781936
Counter({1: 6057, 0: 4605})

Epoch :  35 loss training:  29.871418356895447 Time :  2006
accuracy train: 0.969215 val: 0.775797 test: 0.780248
max validation accuracy : 0.776735 max acc epoch : 29 test accuracy : 0.781936
Counter({1: 6076, 0: 4586})

Epoch :  36 loss training:  29.558889005333185 Time :  2018
accuracy train: 0.973188 val: 0.769231 test: 0.780810
max validation accuracy : 0.776735 max acc epoch : 29 test accuracy : 0.781936
Counter({0: 6079, 1: 4583})

Epoch :  37 loss training:  27.481437174603343 Time :  2030
accuracy train: 0.977656 val: 0.770169 test: 0.776590
max validation accuracy : 0.776735 max acc epoch : 29 test accuracy : 0.781936
Counter({1: 6083, 0: 4579})

Epoch :  38 loss training:  26.256174959242344 Time :  2043
accuracy train: 0.978649 val: 0.772045 test: 0.776308
max validation accuracy : 0.776735 max acc epoch : 29 test accuracy : 0.781936
Counter({0: 6104, 1: 4558})

Epoch :  39 loss training:  25.412215527147055 Time :  2056
accuracy train: 0.980636 val: 0.773921 test: 0.771806
max validation accuracy : 0.776735 max acc epoch : 29 test accuracy : 0.781936
Counter({1: 6080, 0: 4582})

Epoch :  40 loss training:  23.755655834451318 Time :  2068
accuracy train: 0.981132 val: 0.772045 test: 0.777153
max validation accuracy : 0.776735 max acc epoch : 29 test accuracy : 0.781936
Counter({0: 6079, 1: 4583})

========================================================================================================================================================================================================
best acc epoch :  29
validation accuracy :  0.776735459662289
test accuracy :  0.7819358469330332
last test_accuracy :  0.7771525042205966
second best val :  0.775797373358349
second best test :  0.7819358469330332
max gap 6
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  20 	 val_accuracy : 0.79456 	 test_accuracy : 0.78250 	 last test_accuracy : 0.78081 	 second best val : 0.79362 	 second best test : 0.77968
k :  1 	 best_acc epoch :  24 	 val_accuracy : 0.79362 	 test_accuracy : 0.78025 	 last test_accuracy : 0.76956 	 second best val : 0.78799 	 second best test : 0.78025
k :  2 	 best_acc epoch :  28 	 val_accuracy : 0.78236 	 test_accuracy : 0.78700 	 last test_accuracy : 0.78419 	 second best val : 0.78143 	 second best test : 0.78700
k :  3 	 best_acc epoch :  29 	 val_accuracy : 0.77674 	 test_accuracy : 0.78194 	 last test_accuracy : 0.77715 	 second best val : 0.77580 	 second best test : 0.78194

avg :  	 val_accuracy : 0.78682 	 test_accuracy : 0.78292 	 last_accuracy : 0.77793 	 second best val : 0.78471 	 second best test : 0.78222

std :  	 val_accuracy : 0.00754 	 test_accuracy : 0.00250 	 last_accuracy : 0.00544 	 second best val : 0.00672 	 second best test : 0.00288
