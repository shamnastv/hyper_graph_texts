

date and time :  Sun Jun 13 00:11:43 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=410, tsne=False, weight_decay=0.0001)
device :  cuda:0

Epoch :  1 loss training:  90.9994769692421 Time :  9
accuracy train: 0.777899 val: 0.761972 test: 0.763365
max validation accuracy : 0.761972 max acc epoch : 1 test accuracy : 0.763365
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  82.80719020962715 Time :  20
accuracy train: 0.795874 val: 0.760563 test: 0.778559
max validation accuracy : 0.761972 max acc epoch : 1 test accuracy : 0.763365
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.92637851834297 Time :  30
accuracy train: 0.807596 val: 0.756338 test: 0.778559
max validation accuracy : 0.761972 max acc epoch : 1 test accuracy : 0.763365
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.6823036968708 Time :  41
accuracy train: 0.820100 val: 0.757746 test: 0.778559
max validation accuracy : 0.761972 max acc epoch : 1 test accuracy : 0.763365
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  74.05609294772148 Time :  51
accuracy train: 0.825258 val: 0.764789 test: 0.785594
max validation accuracy : 0.764789 max acc epoch : 5 test accuracy : 0.785594
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.69001713395119 Time :  61
accuracy train: 0.833854 val: 0.767606 test: 0.780248
max validation accuracy : 0.767606 max acc epoch : 6 test accuracy : 0.780248
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.87083867192268 Time :  72
accuracy train: 0.834480 val: 0.776056 test: 0.782217
max validation accuracy : 0.776056 max acc epoch : 7 test accuracy : 0.782217
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.58131182193756 Time :  83
accuracy train: 0.838074 val: 0.776056 test: 0.778841
max validation accuracy : 0.776056 max acc epoch : 7 test accuracy : 0.782217
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  68.03043612837791 Time :  95
accuracy train: 0.845889 val: 0.761972 test: 0.774902
max validation accuracy : 0.776056 max acc epoch : 7 test accuracy : 0.782217
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  67.1593227237463 Time :  106
accuracy train: 0.847921 val: 0.761972 test: 0.773776
max validation accuracy : 0.776056 max acc epoch : 7 test accuracy : 0.782217
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  66.97085915505886 Time :  115
accuracy train: 0.852766 val: 0.761972 test: 0.776308
max validation accuracy : 0.776056 max acc epoch : 7 test accuracy : 0.782217
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.58359450101852 Time :  126
accuracy train: 0.856830 val: 0.777465 test: 0.779122
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.779122
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  62.40776392817497 Time :  136
accuracy train: 0.863707 val: 0.771831 test: 0.777153
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.779122
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  62.56986939907074 Time :  143
accuracy train: 0.869490 val: 0.770423 test: 0.780529
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.779122
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  62.25217226147652 Time :  151
accuracy train: 0.873398 val: 0.767606 test: 0.780529
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.779122

Epoch :  16 loss training:  61.39843824505806 Time :  161
accuracy train: 0.874805 val: 0.766197 test: 0.784468
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.779122

Epoch :  17 loss training:  60.875690668821335 Time :  171
accuracy train: 0.877305 val: 0.763380 test: 0.778278
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.779122

Epoch :  18 loss training:  58.8938217908144 Time :  180
accuracy train: 0.879650 val: 0.766197 test: 0.781936
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.779122

Epoch :  19 loss training:  59.07703210413456 Time :  192
accuracy train: 0.884808 val: 0.763380 test: 0.782499
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.779122

Epoch :  20 loss training:  56.237834230065346 Time :  202
accuracy train: 0.883401 val: 0.767606 test: 0.776590
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.779122

Epoch :  21 loss training:  57.296934351325035 Time :  212
accuracy train: 0.891060 val: 0.764789 test: 0.782499
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.779122

Epoch :  22 loss training:  56.91466015577316 Time :  224
accuracy train: 0.894811 val: 0.763380 test: 0.778841
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.779122

Epoch :  23 loss training:  56.17876389622688 Time :  233
accuracy train: 0.897937 val: 0.760563 test: 0.777997
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.779122

========================================================================================================================================================================================================
best acc epoch :  12
validation accuracy :  0.7774647887323943
test accuracy :  0.7791221159257175
last test_accuracy :  0.7779966235227912
second best val :  0.776056338028169
second best test :  0.7822172200337648
max gap 5
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=410, tsne=False, weight_decay=0.0001)
device :  cuda:0

Epoch :  1 loss training:  90.96345978975296 Time :  246
accuracy train: 0.777274 val: 0.761972 test: 0.763365
max validation accuracy : 0.761972 max acc epoch : 1 test accuracy : 0.763365
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  82.79500690102577 Time :  256
accuracy train: 0.790091 val: 0.761972 test: 0.777715
max validation accuracy : 0.761972 max acc epoch : 1 test accuracy : 0.763365
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.9435496777296 Time :  263
accuracy train: 0.810410 val: 0.756338 test: 0.778841
max validation accuracy : 0.761972 max acc epoch : 1 test accuracy : 0.763365
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.47227835655212 Time :  270
accuracy train: 0.819162 val: 0.754930 test: 0.781373
max validation accuracy : 0.761972 max acc epoch : 1 test accuracy : 0.763365
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  73.7474494278431 Time :  282
accuracy train: 0.826196 val: 0.754930 test: 0.783061
max validation accuracy : 0.761972 max acc epoch : 1 test accuracy : 0.763365
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.79528468847275 Time :  293
accuracy train: 0.833229 val: 0.759155 test: 0.782780
max validation accuracy : 0.761972 max acc epoch : 1 test accuracy : 0.763365
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.93404506146908 Time :  304
accuracy train: 0.833542 val: 0.770423 test: 0.782780
max validation accuracy : 0.770423 max acc epoch : 7 test accuracy : 0.782780
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.42078903317451 Time :  315
accuracy train: 0.836511 val: 0.766197 test: 0.778278
max validation accuracy : 0.770423 max acc epoch : 7 test accuracy : 0.782780
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  68.04725734889507 Time :  326
accuracy train: 0.842451 val: 0.757746 test: 0.780248
max validation accuracy : 0.770423 max acc epoch : 7 test accuracy : 0.782780
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  67.09200195968151 Time :  336
accuracy train: 0.846515 val: 0.756338 test: 0.777997
max validation accuracy : 0.770423 max acc epoch : 7 test accuracy : 0.782780
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  67.22001458704472 Time :  348
accuracy train: 0.851672 val: 0.757746 test: 0.778841
max validation accuracy : 0.770423 max acc epoch : 7 test accuracy : 0.782780
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.7531723678112 Time :  358
accuracy train: 0.857299 val: 0.773239 test: 0.781092
max validation accuracy : 0.773239 max acc epoch : 12 test accuracy : 0.781092
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  62.8270199149847 Time :  369
accuracy train: 0.865270 val: 0.763380 test: 0.779403
max validation accuracy : 0.773239 max acc epoch : 12 test accuracy : 0.781092
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  62.845998510718346 Time :  380
accuracy train: 0.868709 val: 0.761972 test: 0.782780
max validation accuracy : 0.773239 max acc epoch : 12 test accuracy : 0.781092
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  62.27929040789604 Time :  391
accuracy train: 0.870272 val: 0.761972 test: 0.784468
max validation accuracy : 0.773239 max acc epoch : 12 test accuracy : 0.781092

Epoch :  16 loss training:  60.98520864546299 Time :  403
accuracy train: 0.872929 val: 0.761972 test: 0.782217
max validation accuracy : 0.773239 max acc epoch : 12 test accuracy : 0.781092

Epoch :  17 loss training:  61.10405904054642 Time :  413
accuracy train: 0.873711 val: 0.771831 test: 0.778841
max validation accuracy : 0.773239 max acc epoch : 12 test accuracy : 0.781092

Epoch :  18 loss training:  58.85836906731129 Time :  425
accuracy train: 0.878243 val: 0.767606 test: 0.783061
max validation accuracy : 0.773239 max acc epoch : 12 test accuracy : 0.781092

Epoch :  19 loss training:  59.12978649139404 Time :  437
accuracy train: 0.879962 val: 0.760563 test: 0.784187
max validation accuracy : 0.773239 max acc epoch : 12 test accuracy : 0.781092

Epoch :  20 loss training:  56.3544747531414 Time :  446
accuracy train: 0.881838 val: 0.769014 test: 0.780810
max validation accuracy : 0.773239 max acc epoch : 12 test accuracy : 0.781092

Epoch :  21 loss training:  57.31114925444126 Time :  458
accuracy train: 0.887777 val: 0.757746 test: 0.784468
max validation accuracy : 0.773239 max acc epoch : 12 test accuracy : 0.781092

Epoch :  22 loss training:  57.22418366372585 Time :  465
accuracy train: 0.891216 val: 0.761972 test: 0.785594
max validation accuracy : 0.773239 max acc epoch : 12 test accuracy : 0.781092

Epoch :  23 loss training:  56.343243047595024 Time :  477
accuracy train: 0.894029 val: 0.760563 test: 0.787282
max validation accuracy : 0.773239 max acc epoch : 12 test accuracy : 0.781092

========================================================================================================================================================================================================
best acc epoch :  12
validation accuracy :  0.7732394366197183
test accuracy :  0.7810917276308385
last test_accuracy :  0.7872819358469331
second best val :  0.7718309859154929
second best test :  0.7810917276308385
max gap 6
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=410, tsne=False, weight_decay=0.0001)
device :  cuda:0

Epoch :  1 loss training:  91.00935772061348 Time :  488
accuracy train: 0.776962 val: 0.760563 test: 0.760551
max validation accuracy : 0.760563 max acc epoch : 1 test accuracy : 0.760551
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  82.68211194872856 Time :  495
accuracy train: 0.791028 val: 0.759155 test: 0.779403
max validation accuracy : 0.760563 max acc epoch : 1 test accuracy : 0.760551
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.99760043621063 Time :  505
accuracy train: 0.810566 val: 0.760563 test: 0.780248
max validation accuracy : 0.760563 max acc epoch : 1 test accuracy : 0.760551
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.58269844949245 Time :  515
accuracy train: 0.819631 val: 0.767606 test: 0.781092
max validation accuracy : 0.767606 max acc epoch : 4 test accuracy : 0.781092
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  73.80652844905853 Time :  524
accuracy train: 0.826196 val: 0.756338 test: 0.783343
max validation accuracy : 0.767606 max acc epoch : 4 test accuracy : 0.781092
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.74005629122257 Time :  534
accuracy train: 0.835574 val: 0.769014 test: 0.781092
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.781092
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.97771960496902 Time :  545
accuracy train: 0.834480 val: 0.767606 test: 0.783343
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.781092
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.32968081533909 Time :  552
accuracy train: 0.834323 val: 0.769014 test: 0.779122
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.781092
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  68.09171597659588 Time :  561
accuracy train: 0.844014 val: 0.760563 test: 0.776871
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.781092
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  67.02996228635311 Time :  572
accuracy train: 0.847452 val: 0.763380 test: 0.777434
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.781092
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  67.1579117178917 Time :  583
accuracy train: 0.855424 val: 0.760563 test: 0.784468
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.781092
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.64334017038345 Time :  592
accuracy train: 0.856830 val: 0.774648 test: 0.783624
max validation accuracy : 0.774648 max acc epoch : 12 test accuracy : 0.783624
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  62.66377568244934 Time :  603
accuracy train: 0.864958 val: 0.777465 test: 0.781092
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.781092
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  62.80573336780071 Time :  613
accuracy train: 0.867771 val: 0.764789 test: 0.782780
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.781092
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  62.16808071732521 Time :  624
accuracy train: 0.872773 val: 0.771831 test: 0.783624
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.781092

Epoch :  16 loss training:  61.0797214359045 Time :  636
accuracy train: 0.873554 val: 0.771831 test: 0.783624
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.781092

Epoch :  17 loss training:  61.053459614515305 Time :  646
accuracy train: 0.872929 val: 0.774648 test: 0.780529
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.781092

Epoch :  18 loss training:  59.01250630617142 Time :  657
accuracy train: 0.877618 val: 0.774648 test: 0.785594
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.781092

Epoch :  19 loss training:  59.103769809007645 Time :  667
accuracy train: 0.884183 val: 0.766197 test: 0.784187
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.781092

Epoch :  20 loss training:  56.32967872917652 Time :  678
accuracy train: 0.881057 val: 0.773239 test: 0.780248
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.781092

Epoch :  21 loss training:  57.28606452047825 Time :  690
accuracy train: 0.890278 val: 0.759155 test: 0.781373
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.781092

Epoch :  22 loss training:  57.10305655002594 Time :  700
accuracy train: 0.893092 val: 0.764789 test: 0.778559
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.781092

Epoch :  23 loss training:  56.28152999281883 Time :  711
accuracy train: 0.895436 val: 0.769014 test: 0.781373
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.781092

Epoch :  24 loss training:  55.244023099541664 Time :  721
accuracy train: 0.899656 val: 0.767606 test: 0.777434
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.781092

========================================================================================================================================================================================================
best acc epoch :  13
validation accuracy :  0.7774647887323943
test accuracy :  0.7810917276308385
last test_accuracy :  0.7774338773213281
second best val :  0.7746478873239436
second best test :  0.7836240855374226
max gap 6
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=410, tsne=False, weight_decay=0.0001)
device :  cuda:0

Epoch :  1 loss training:  90.98051086068153 Time :  732
accuracy train: 0.777743 val: 0.766197 test: 0.763647
max validation accuracy : 0.766197 max acc epoch : 1 test accuracy : 0.763647
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  82.81207126379013 Time :  743
accuracy train: 0.793217 val: 0.761972 test: 0.779403
max validation accuracy : 0.766197 max acc epoch : 1 test accuracy : 0.763647
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.90808975696564 Time :  753
accuracy train: 0.810410 val: 0.747887 test: 0.781092
max validation accuracy : 0.766197 max acc epoch : 1 test accuracy : 0.763647
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.58844175934792 Time :  763
accuracy train: 0.819631 val: 0.757746 test: 0.780810
max validation accuracy : 0.766197 max acc epoch : 1 test accuracy : 0.763647
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  73.89881764352322 Time :  775
accuracy train: 0.826665 val: 0.761972 test: 0.784187
max validation accuracy : 0.766197 max acc epoch : 1 test accuracy : 0.763647
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.60542944073677 Time :  784
accuracy train: 0.837918 val: 0.761972 test: 0.776871
max validation accuracy : 0.766197 max acc epoch : 1 test accuracy : 0.763647
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.85328470170498 Time :  796
accuracy train: 0.837293 val: 0.766197 test: 0.781936
max validation accuracy : 0.766197 max acc epoch : 1 test accuracy : 0.763647
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.4177730679512 Time :  806
accuracy train: 0.835105 val: 0.773239 test: 0.778559
max validation accuracy : 0.773239 max acc epoch : 8 test accuracy : 0.778559
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.989352196455 Time :  816
accuracy train: 0.842763 val: 0.761972 test: 0.776590
max validation accuracy : 0.773239 max acc epoch : 8 test accuracy : 0.778559
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  67.18132039904594 Time :  828
accuracy train: 0.850266 val: 0.766197 test: 0.774057
max validation accuracy : 0.773239 max acc epoch : 8 test accuracy : 0.778559
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  67.0003032386303 Time :  837
accuracy train: 0.855736 val: 0.764789 test: 0.776308
max validation accuracy : 0.773239 max acc epoch : 8 test accuracy : 0.778559
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.50751093029976 Time :  848
accuracy train: 0.858706 val: 0.778873 test: 0.783343
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.783343
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  62.79216952621937 Time :  854
accuracy train: 0.865896 val: 0.776056 test: 0.778278
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.783343
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  62.8007025718689 Time :  863
accuracy train: 0.870741 val: 0.766197 test: 0.779403
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.783343
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  62.311576560139656 Time :  870
accuracy train: 0.873711 val: 0.773239 test: 0.779122
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.783343

Epoch :  16 loss training:  61.006363213062286 Time :  877
accuracy train: 0.874648 val: 0.771831 test: 0.781654
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.783343

Epoch :  17 loss training:  60.82963755726814 Time :  888
accuracy train: 0.876680 val: 0.773239 test: 0.776871
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.783343

Epoch :  18 loss training:  58.8371988683939 Time :  899
accuracy train: 0.879650 val: 0.773239 test: 0.780810
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.783343

Epoch :  19 loss training:  59.13020458817482 Time :  909
accuracy train: 0.884339 val: 0.770423 test: 0.778278
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.783343

Epoch :  20 loss training:  56.30033941566944 Time :  920
accuracy train: 0.884026 val: 0.761972 test: 0.778559
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.783343

Epoch :  21 loss training:  57.44181415438652 Time :  929
accuracy train: 0.892310 val: 0.760563 test: 0.776590
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.783343

Epoch :  22 loss training:  57.165190637111664 Time :  941
accuracy train: 0.893560 val: 0.764789 test: 0.776027
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.783343

Epoch :  23 loss training:  56.30843843519688 Time :  951
accuracy train: 0.896999 val: 0.759155 test: 0.777997
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.783343

========================================================================================================================================================================================================
best acc epoch :  12
validation accuracy :  0.7788732394366197
test accuracy :  0.7833427124366911
last test_accuracy :  0.7779966235227912
second best val :  0.776056338028169
second best test :  0.7833427124366911
max gap 7
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=410, tsne=False, weight_decay=0.0001)
device :  cuda:0

Epoch :  1 loss training:  91.01348778605461 Time :  963
accuracy train: 0.779150 val: 0.759155 test: 0.763365
max validation accuracy : 0.759155 max acc epoch : 1 test accuracy : 0.763365
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  82.72237300872803 Time :  975
accuracy train: 0.794623 val: 0.766197 test: 0.780810
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.780810
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.80472360551357 Time :  984
accuracy train: 0.809941 val: 0.750704 test: 0.777997
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.780810
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.41192032396793 Time :  995
accuracy train: 0.819787 val: 0.763380 test: 0.778278
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.780810
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  73.95102030038834 Time :  1004
accuracy train: 0.826508 val: 0.759155 test: 0.788126
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.780810
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.61258266866207 Time :  1015
accuracy train: 0.835730 val: 0.766197 test: 0.779685
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.780810
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.84101697802544 Time :  1028
accuracy train: 0.836199 val: 0.766197 test: 0.783905
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.780810
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.20304922759533 Time :  1037
accuracy train: 0.839168 val: 0.777465 test: 0.781092
max validation accuracy : 0.777465 max acc epoch : 8 test accuracy : 0.781092
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.90858666598797 Time :  1048
accuracy train: 0.845420 val: 0.759155 test: 0.776590
max validation accuracy : 0.777465 max acc epoch : 8 test accuracy : 0.781092
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  67.02562120556831 Time :  1058
accuracy train: 0.848703 val: 0.760563 test: 0.779966
max validation accuracy : 0.777465 max acc epoch : 8 test accuracy : 0.781092
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  66.94471913576126 Time :  1069
accuracy train: 0.855267 val: 0.757746 test: 0.778278
max validation accuracy : 0.777465 max acc epoch : 8 test accuracy : 0.781092
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.48323610424995 Time :  1079
accuracy train: 0.859956 val: 0.776056 test: 0.782499
max validation accuracy : 0.777465 max acc epoch : 8 test accuracy : 0.781092
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  62.591536059975624 Time :  1092
accuracy train: 0.866990 val: 0.774648 test: 0.778278
max validation accuracy : 0.777465 max acc epoch : 8 test accuracy : 0.781092
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  62.612053871154785 Time :  1102
accuracy train: 0.869334 val: 0.769014 test: 0.779966
max validation accuracy : 0.777465 max acc epoch : 8 test accuracy : 0.781092
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  62.23484651744366 Time :  1112
accuracy train: 0.873242 val: 0.771831 test: 0.782217
max validation accuracy : 0.777465 max acc epoch : 8 test accuracy : 0.781092

Epoch :  16 loss training:  60.92995247244835 Time :  1124
accuracy train: 0.876680 val: 0.769014 test: 0.782217
max validation accuracy : 0.777465 max acc epoch : 8 test accuracy : 0.781092

Epoch :  17 loss training:  60.645451471209526 Time :  1135
accuracy train: 0.877462 val: 0.771831 test: 0.774339
max validation accuracy : 0.777465 max acc epoch : 8 test accuracy : 0.781092

Epoch :  18 loss training:  58.88552686572075 Time :  1146
accuracy train: 0.879650 val: 0.771831 test: 0.781654
max validation accuracy : 0.777465 max acc epoch : 8 test accuracy : 0.781092

Epoch :  19 loss training:  58.891594007611275 Time :  1157
accuracy train: 0.885277 val: 0.769014 test: 0.781936
max validation accuracy : 0.777465 max acc epoch : 8 test accuracy : 0.781092

========================================================================================================================================================================================================
best acc epoch :  8
validation accuracy :  0.7774647887323943
test accuracy :  0.7810917276308385
last test_accuracy :  0.7819358469330332
second best val :  0.776056338028169
second best test :  0.7810917276308385
max gap 6
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=410, tsne=False, weight_decay=0.0001)
device :  cuda:0

Epoch :  1 loss training:  90.96240198612213 Time :  1167
accuracy train: 0.776493 val: 0.759155 test: 0.763928
max validation accuracy : 0.759155 max acc epoch : 1 test accuracy : 0.763928
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  82.89845284819603 Time :  1179
accuracy train: 0.791810 val: 0.752113 test: 0.776871
max validation accuracy : 0.759155 max acc epoch : 1 test accuracy : 0.763928
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  80.0061861872673 Time :  1190
accuracy train: 0.809628 val: 0.750704 test: 0.777997
max validation accuracy : 0.759155 max acc epoch : 1 test accuracy : 0.763928
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.62067410349846 Time :  1199
accuracy train: 0.818693 val: 0.760563 test: 0.777997
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.777997
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  73.94219091534615 Time :  1210
accuracy train: 0.825883 val: 0.763380 test: 0.782780
max validation accuracy : 0.763380 max acc epoch : 5 test accuracy : 0.782780
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.77805842459202 Time :  1220
accuracy train: 0.832604 val: 0.773239 test: 0.779685
max validation accuracy : 0.773239 max acc epoch : 6 test accuracy : 0.779685
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.9764016866684 Time :  1231
accuracy train: 0.834480 val: 0.769014 test: 0.779966
max validation accuracy : 0.773239 max acc epoch : 6 test accuracy : 0.779685
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.66649459302425 Time :  1243
accuracy train: 0.834948 val: 0.774648 test: 0.778278
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.778278
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  68.1213451474905 Time :  1252
accuracy train: 0.841669 val: 0.761972 test: 0.773495
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.778278
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  67.29180978238583 Time :  1261
accuracy train: 0.851516 val: 0.752113 test: 0.775746
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.778278
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  67.14196276664734 Time :  1268
accuracy train: 0.852923 val: 0.766197 test: 0.774620
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.778278
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.89348691701889 Time :  1278
accuracy train: 0.856361 val: 0.778873 test: 0.779122
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.779122
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  62.789180278778076 Time :  1288
accuracy train: 0.863082 val: 0.771831 test: 0.777153
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.779122
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  62.565271466970444 Time :  1298
accuracy train: 0.867459 val: 0.764789 test: 0.781092
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.779122
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  62.32096183300018 Time :  1310
accuracy train: 0.872460 val: 0.767606 test: 0.779122
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.779122

Epoch :  16 loss training:  61.20224666595459 Time :  1320
accuracy train: 0.872616 val: 0.773239 test: 0.782780
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.779122

Epoch :  17 loss training:  61.0199628919363 Time :  1332
accuracy train: 0.873867 val: 0.770423 test: 0.776590
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.779122

Epoch :  18 loss training:  59.02279181778431 Time :  1342
accuracy train: 0.876368 val: 0.778873 test: 0.781092
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.779122

Epoch :  19 loss training:  59.055060967803 Time :  1355
accuracy train: 0.881838 val: 0.770423 test: 0.782780
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.779122

Epoch :  20 loss training:  56.297013118863106 Time :  1366
accuracy train: 0.881369 val: 0.774648 test: 0.779403
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.779122

Epoch :  21 loss training:  57.1504740267992 Time :  1376
accuracy train: 0.888715 val: 0.766197 test: 0.779685
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.779122

Epoch :  22 loss training:  57.21186138689518 Time :  1387
accuracy train: 0.891216 val: 0.767606 test: 0.779685
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.779122

Epoch :  23 loss training:  56.193170711398125 Time :  1397
accuracy train: 0.894655 val: 0.763380 test: 0.781092
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.779122

========================================================================================================================================================================================================
best acc epoch :  12
validation accuracy :  0.7788732394366197
test accuracy :  0.7791221159257175
last test_accuracy :  0.7810917276308385
second best val :  0.7746478873239436
second best test :  0.7782779966235228
max gap 4
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  12 	 val_accuracy : 0.77746 	 test_accuracy : 0.77912 	 last test_accuracy : 0.77800 	 second best val : 0.77606 	 second best test : 0.78222
k :  1 	 best_acc epoch :  12 	 val_accuracy : 0.77324 	 test_accuracy : 0.78109 	 last test_accuracy : 0.78728 	 second best val : 0.77183 	 second best test : 0.78109
k :  2 	 best_acc epoch :  13 	 val_accuracy : 0.77746 	 test_accuracy : 0.78109 	 last test_accuracy : 0.77743 	 second best val : 0.77465 	 second best test : 0.78362
k :  3 	 best_acc epoch :  12 	 val_accuracy : 0.77887 	 test_accuracy : 0.78334 	 last test_accuracy : 0.77800 	 second best val : 0.77606 	 second best test : 0.78334
k :  4 	 best_acc epoch :  8 	 val_accuracy : 0.77746 	 test_accuracy : 0.78109 	 last test_accuracy : 0.78194 	 second best val : 0.77606 	 second best test : 0.78109
k :  5 	 best_acc epoch :  12 	 val_accuracy : 0.77887 	 test_accuracy : 0.77912 	 last test_accuracy : 0.78109 	 second best val : 0.77465 	 second best test : 0.77828

avg :  	 val_accuracy : 0.77723 	 test_accuracy : 0.78081 	 last_accuracy : 0.78062 	 second best val : 0.77488 	 second best test : 0.78161

std :  	 val_accuracy : 0.00189 	 test_accuracy : 0.00143 	 last_accuracy : 0.00342 	 second best val : 0.00150 	 second best test : 0.00178


date and time :  Sun Jun 13 00:35:06 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=205, tsne=False, weight_decay=0.0001)
device :  cuda:0

Epoch :  1 loss training:  102.28448590636253 Time :  12
accuracy train: 0.705846 val: 0.704225 test: 0.688239
max validation accuracy : 0.704225 max acc epoch : 1 test accuracy : 0.688239
Epoch-1 lr: 0.005

Epoch :  2 loss training:  89.50396445393562 Time :  24
accuracy train: 0.790403 val: 0.761972 test: 0.776027
max validation accuracy : 0.761972 max acc epoch : 2 test accuracy : 0.776027
Epoch-2 lr: 0.005

Epoch :  3 loss training:  87.43407261371613 Time :  33
accuracy train: 0.794154 val: 0.752113 test: 0.766742
max validation accuracy : 0.761972 max acc epoch : 2 test accuracy : 0.776027
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  77.32393808662891 Time :  43
accuracy train: 0.818693 val: 0.780282 test: 0.782217
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.782217
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  74.91697870194912 Time :  54
accuracy train: 0.828696 val: 0.766197 test: 0.779122
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.782217
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  73.4805780351162 Time :  63
accuracy train: 0.844952 val: 0.773239 test: 0.779403
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.782217
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  65.62568226456642 Time :  74
accuracy train: 0.864802 val: 0.757746 test: 0.769274
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.782217
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  63.56646579504013 Time :  86
accuracy train: 0.882932 val: 0.757746 test: 0.777434
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.782217
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  62.160712257027626 Time :  95
accuracy train: 0.894498 val: 0.777465 test: 0.779685
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.782217
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  57.550170347094536 Time :  106
accuracy train: 0.903564 val: 0.776056 test: 0.774902
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.782217
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  56.388774663209915 Time :  116
accuracy train: 0.925133 val: 0.783099 test: 0.770118
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.770118
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  48.84495593607426 Time :  127
accuracy train: 0.946546 val: 0.785915 test: 0.768430
max validation accuracy : 0.785915 max acc epoch : 12 test accuracy : 0.768430
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  38.94572979211807 Time :  137
accuracy train: 0.961082 val: 0.767606 test: 0.771525
max validation accuracy : 0.785915 max acc epoch : 12 test accuracy : 0.768430
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  35.83301316201687 Time :  149
accuracy train: 0.969834 val: 0.776056 test: 0.766742
max validation accuracy : 0.785915 max acc epoch : 12 test accuracy : 0.768430
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  31.190149538218975 Time :  161
accuracy train: 0.979837 val: 0.766197 test: 0.768430
max validation accuracy : 0.785915 max acc epoch : 12 test accuracy : 0.768430

Epoch :  16 loss training:  26.982003286480904 Time :  171
accuracy train: 0.986715 val: 0.769014 test: 0.769837
max validation accuracy : 0.785915 max acc epoch : 12 test accuracy : 0.768430

Epoch :  17 loss training:  23.344108521938324 Time :  183
accuracy train: 0.987340 val: 0.771831 test: 0.761677
max validation accuracy : 0.785915 max acc epoch : 12 test accuracy : 0.768430

Epoch :  18 loss training:  20.89779820293188 Time :  192
accuracy train: 0.992341 val: 0.769014 test: 0.757175
max validation accuracy : 0.785915 max acc epoch : 12 test accuracy : 0.768430

Epoch :  19 loss training:  18.480067003518343 Time :  201
accuracy train: 0.996093 val: 0.757746 test: 0.760833
max validation accuracy : 0.785915 max acc epoch : 12 test accuracy : 0.768430

Epoch :  20 loss training:  14.70374496653676 Time :  208
accuracy train: 0.997499 val: 0.761972 test: 0.755205
max validation accuracy : 0.785915 max acc epoch : 12 test accuracy : 0.768430

Epoch :  21 loss training:  12.521789021790028 Time :  221
accuracy train: 0.997812 val: 0.760563 test: 0.752954
max validation accuracy : 0.785915 max acc epoch : 12 test accuracy : 0.768430

Epoch :  22 loss training:  10.604688664898276 Time :  231
accuracy train: 0.998750 val: 0.767606 test: 0.753799
max validation accuracy : 0.785915 max acc epoch : 12 test accuracy : 0.768430

Epoch :  23 loss training:  9.176259187515825 Time :  241
accuracy train: 0.998593 val: 0.752113 test: 0.752673
max validation accuracy : 0.785915 max acc epoch : 12 test accuracy : 0.768430

========================================================================================================================================================================================================
best acc epoch :  12
validation accuracy :  0.7859154929577464
test accuracy :  0.7684299380979178
last test_accuracy :  0.7526730444569499
second best val :  0.7830985915492957
second best test :  0.7701181767023073
max gap 7
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=205, tsne=False, weight_decay=0.0001)
device :  cuda:0

Epoch :  1 loss training:  103.73810724914074 Time :  252
accuracy train: 0.742888 val: 0.725352 test: 0.738323
max validation accuracy : 0.725352 max acc epoch : 1 test accuracy : 0.738323
Epoch-1 lr: 0.005

Epoch :  2 loss training:  87.24340809881687 Time :  262
accuracy train: 0.792123 val: 0.753521 test: 0.768993
max validation accuracy : 0.753521 max acc epoch : 2 test accuracy : 0.768993
Epoch-2 lr: 0.005

Epoch :  3 loss training:  84.81651702523232 Time :  273
accuracy train: 0.795249 val: 0.746479 test: 0.763365
max validation accuracy : 0.753521 max acc epoch : 2 test accuracy : 0.768993
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  74.82001695036888 Time :  280
accuracy train: 0.825883 val: 0.783099 test: 0.775464
max validation accuracy : 0.783099 max acc epoch : 4 test accuracy : 0.775464
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  72.90026471018791 Time :  291
accuracy train: 0.846358 val: 0.771831 test: 0.772932
max validation accuracy : 0.783099 max acc epoch : 4 test accuracy : 0.775464
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  72.01586081087589 Time :  300
accuracy train: 0.840731 val: 0.780282 test: 0.768993
max validation accuracy : 0.783099 max acc epoch : 4 test accuracy : 0.775464
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  64.704584851861 Time :  311
accuracy train: 0.864645 val: 0.776056 test: 0.772369
max validation accuracy : 0.783099 max acc epoch : 4 test accuracy : 0.775464
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  62.954203471541405 Time :  320
accuracy train: 0.880119 val: 0.770423 test: 0.777434
max validation accuracy : 0.783099 max acc epoch : 4 test accuracy : 0.775464
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  61.34354417026043 Time :  331
accuracy train: 0.898249 val: 0.783099 test: 0.772651
max validation accuracy : 0.783099 max acc epoch : 4 test accuracy : 0.775464
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  55.702740639448166 Time :  341
accuracy train: 0.909034 val: 0.774648 test: 0.773213
max validation accuracy : 0.783099 max acc epoch : 4 test accuracy : 0.775464
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  56.31244760751724 Time :  351
accuracy train: 0.923726 val: 0.797183 test: 0.777434
max validation accuracy : 0.797183 max acc epoch : 11 test accuracy : 0.777434
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  48.76128312945366 Time :  362
accuracy train: 0.940606 val: 0.792958 test: 0.774057
max validation accuracy : 0.797183 max acc epoch : 11 test accuracy : 0.777434
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  38.9384757950902 Time :  372
accuracy train: 0.962801 val: 0.784507 test: 0.772088
max validation accuracy : 0.797183 max acc epoch : 11 test accuracy : 0.777434
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  35.49385579675436 Time :  382
accuracy train: 0.972023 val: 0.783099 test: 0.770962
max validation accuracy : 0.797183 max acc epoch : 11 test accuracy : 0.777434
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  31.104973927140236 Time :  394
accuracy train: 0.979837 val: 0.773239 test: 0.770400
max validation accuracy : 0.797183 max acc epoch : 11 test accuracy : 0.777434

Epoch :  16 loss training:  27.217558179050684 Time :  403
accuracy train: 0.985777 val: 0.767606 test: 0.767867
max validation accuracy : 0.797183 max acc epoch : 11 test accuracy : 0.777434

Epoch :  17 loss training:  23.079628359526396 Time :  415
accuracy train: 0.987965 val: 0.783099 test: 0.759989
max validation accuracy : 0.797183 max acc epoch : 11 test accuracy : 0.777434

Epoch :  18 loss training:  19.474384812638164 Time :  424
accuracy train: 0.991872 val: 0.773239 test: 0.755205
max validation accuracy : 0.797183 max acc epoch : 11 test accuracy : 0.777434

Epoch :  19 loss training:  17.10034216195345 Time :  435
accuracy train: 0.995467 val: 0.759155 test: 0.755205
max validation accuracy : 0.797183 max acc epoch : 11 test accuracy : 0.777434

Epoch :  20 loss training:  13.35172195918858 Time :  442
accuracy train: 0.997030 val: 0.773239 test: 0.756331
max validation accuracy : 0.797183 max acc epoch : 11 test accuracy : 0.777434

Epoch :  21 loss training:  11.028597867116332 Time :  453
accuracy train: 0.997499 val: 0.761972 test: 0.755205
max validation accuracy : 0.797183 max acc epoch : 11 test accuracy : 0.777434

Epoch :  22 loss training:  9.64500616490841 Time :  465
accuracy train: 0.998281 val: 0.769014 test: 0.751266
max validation accuracy : 0.797183 max acc epoch : 11 test accuracy : 0.777434

========================================================================================================================================================================================================
best acc epoch :  11
validation accuracy :  0.7971830985915493
test accuracy :  0.7774338773213281
last test_accuracy :  0.7512661789532921
second best val :  0.7929577464788733
second best test :  0.7774338773213281
max gap 7
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=205, tsne=False, weight_decay=0.0001)
device :  cuda:0

Epoch :  1 loss training:  102.39449140429497 Time :  475
accuracy train: 0.769928 val: 0.739437 test: 0.754080
max validation accuracy : 0.739437 max acc epoch : 1 test accuracy : 0.754080
Epoch-1 lr: 0.005

Epoch :  2 loss training:  88.03500556945801 Time :  487
accuracy train: 0.791185 val: 0.745070 test: 0.774057
max validation accuracy : 0.745070 max acc epoch : 2 test accuracy : 0.774057
Epoch-2 lr: 0.005

Epoch :  3 loss training:  84.82415813207626 Time :  497
accuracy train: 0.789778 val: 0.740845 test: 0.756612
max validation accuracy : 0.745070 max acc epoch : 2 test accuracy : 0.774057
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  74.67251913249493 Time :  509
accuracy train: 0.833073 val: 0.771831 test: 0.779966
max validation accuracy : 0.771831 max acc epoch : 4 test accuracy : 0.779966
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  72.14806146919727 Time :  518
accuracy train: 0.856205 val: 0.777465 test: 0.781936
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.781936
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  69.29926472902298 Time :  529
accuracy train: 0.869647 val: 0.776056 test: 0.777997
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.781936
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  62.11881063878536 Time :  538
accuracy train: 0.848390 val: 0.771831 test: 0.756612
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.781936
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  60.6304887086153 Time :  549
accuracy train: 0.889340 val: 0.777465 test: 0.770962
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.781936
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  61.00462840497494 Time :  560
accuracy train: 0.899031 val: 0.763380 test: 0.769555
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.781936
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  55.62459608912468 Time :  570
accuracy train: 0.911066 val: 0.776056 test: 0.771244
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.781936
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  54.926011219620705 Time :  581
accuracy train: 0.923257 val: 0.776056 test: 0.769555
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.781936
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  47.87831646203995 Time :  591
accuracy train: 0.947484 val: 0.777465 test: 0.769837
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.781936
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  38.87172170728445 Time :  602
accuracy train: 0.961863 val: 0.783099 test: 0.776027
max validation accuracy : 0.783099 max acc epoch : 13 test accuracy : 0.776027
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  35.843226701021194 Time :  613
accuracy train: 0.970616 val: 0.787324 test: 0.774620
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.774620
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  31.695875622332096 Time :  622
accuracy train: 0.979525 val: 0.783099 test: 0.773776
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.774620

Epoch :  16 loss training:  27.816560171544552 Time :  633
accuracy train: 0.984683 val: 0.781690 test: 0.772088
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.774620

Epoch :  17 loss training:  24.512213829904795 Time :  644
accuracy train: 0.986715 val: 0.781690 test: 0.759145
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.774620

Epoch :  18 loss training:  21.76682459935546 Time :  653
accuracy train: 0.991872 val: 0.788732 test: 0.760551
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.760551

Epoch :  19 loss training:  19.41026557609439 Time :  662
accuracy train: 0.992810 val: 0.759155 test: 0.762521
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.760551

Epoch :  20 loss training:  16.278752805665135 Time :  670
accuracy train: 0.997499 val: 0.781690 test: 0.754643
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.760551

Epoch :  21 loss training:  13.938556466251612 Time :  681
accuracy train: 0.997030 val: 0.766197 test: 0.753236
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.760551

Epoch :  22 loss training:  11.671356042847037 Time :  690
accuracy train: 0.998124 val: 0.763380 test: 0.750422
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.760551

Epoch :  23 loss training:  10.146417475305498 Time :  702
accuracy train: 0.998906 val: 0.745070 test: 0.749297
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.760551

Epoch :  24 loss training:  9.265520765446126 Time :  713
accuracy train: 0.999219 val: 0.740845 test: 0.750141
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.760551

Epoch :  25 loss training:  7.835832350887358 Time :  722
accuracy train: 0.999531 val: 0.756338 test: 0.748734
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.760551

Epoch :  26 loss training:  7.262325002811849 Time :  733
accuracy train: 0.999375 val: 0.754930 test: 0.751829
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.760551

Epoch :  27 loss training:  6.729039104655385 Time :  741
accuracy train: 0.999531 val: 0.759155 test: 0.745357
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.760551

Epoch :  28 loss training:  5.582023614551872 Time :  752
accuracy train: 0.999375 val: 0.754930 test: 0.745920
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.760551

Epoch :  29 loss training:  5.263466687873006 Time :  763
accuracy train: 0.999687 val: 0.753521 test: 0.747608
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.760551

========================================================================================================================================================================================================
best acc epoch :  18
validation accuracy :  0.7887323943661971
test accuracy :  0.7605514912774338
last test_accuracy :  0.7476083286437817
second best val :  0.7873239436619718
second best test :  0.7746201463140123
max gap 8
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=205, tsne=False, weight_decay=0.0001)
device :  cuda:0

Epoch :  1 loss training:  102.4620071053505 Time :  772
accuracy train: 0.773836 val: 0.766197 test: 0.758019
max validation accuracy : 0.766197 max acc epoch : 1 test accuracy : 0.758019
Epoch-1 lr: 0.005

Epoch :  2 loss training:  88.01948142051697 Time :  779
accuracy train: 0.779150 val: 0.740845 test: 0.766460
max validation accuracy : 0.766197 max acc epoch : 1 test accuracy : 0.758019
Epoch-2 lr: 0.005

Epoch :  3 loss training:  86.32194051146507 Time :  790
accuracy train: 0.798218 val: 0.763380 test: 0.769555
max validation accuracy : 0.766197 max acc epoch : 1 test accuracy : 0.758019
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  76.43927903473377 Time :  797
accuracy train: 0.823226 val: 0.759155 test: 0.782499
max validation accuracy : 0.766197 max acc epoch : 1 test accuracy : 0.758019
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  75.54613435268402 Time :  806
accuracy train: 0.829634 val: 0.777465 test: 0.777434
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.777434
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  72.8295062482357 Time :  816
accuracy train: 0.844795 val: 0.767606 test: 0.775746
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.777434
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  65.17338140308857 Time :  824
accuracy train: 0.866052 val: 0.771831 test: 0.778559
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.777434
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  63.04781870543957 Time :  833
accuracy train: 0.883401 val: 0.773239 test: 0.777153
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.777434
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  61.92163325846195 Time :  844
accuracy train: 0.898718 val: 0.780282 test: 0.779966
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.779966
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  57.131580263376236 Time :  851
accuracy train: 0.907940 val: 0.778873 test: 0.781092
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.779966
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  55.385027036070824 Time :  862
accuracy train: 0.927634 val: 0.788732 test: 0.777153
max validation accuracy : 0.788732 max acc epoch : 11 test accuracy : 0.777153
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  47.87831921875477 Time :  869
accuracy train: 0.950610 val: 0.790141 test: 0.774057
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.774057
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  38.46328876167536 Time :  878
accuracy train: 0.962801 val: 0.790141 test: 0.777153
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.774057
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  34.77219969779253 Time :  889
accuracy train: 0.970460 val: 0.785915 test: 0.775746
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.774057
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  30.257746756076813 Time :  900
accuracy train: 0.979994 val: 0.773239 test: 0.777434
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.774057

Epoch :  16 loss training:  26.930753029882908 Time :  911
accuracy train: 0.987027 val: 0.774648 test: 0.771525
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.774057

Epoch :  17 loss training:  22.636124171316624 Time :  922
accuracy train: 0.989215 val: 0.781690 test: 0.770118
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.774057

Epoch :  18 loss training:  19.727074295282364 Time :  933
accuracy train: 0.991872 val: 0.773239 test: 0.761958
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.774057

Epoch :  19 loss training:  17.690107319504023 Time :  943
accuracy train: 0.996405 val: 0.763380 test: 0.759426
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.774057

Epoch :  20 loss training:  14.160857759416103 Time :  952
accuracy train: 0.997656 val: 0.776056 test: 0.761958
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.774057

Epoch :  21 loss training:  12.41825719177723 Time :  958
accuracy train: 0.998750 val: 0.771831 test: 0.758301
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.774057

Epoch :  22 loss training:  9.798871187493205 Time :  968
accuracy train: 0.998750 val: 0.756338 test: 0.752110
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.774057

Epoch :  23 loss training:  8.076064082793891 Time :  978
accuracy train: 0.998906 val: 0.766197 test: 0.748452
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.774057

========================================================================================================================================================================================================
best acc epoch :  12
validation accuracy :  0.7901408450704225
test accuracy :  0.7740574001125492
last test_accuracy :  0.7484524479459763
second best val :  0.7887323943661971
second best test :  0.7771525042205966
max gap 4
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=205, tsne=False, weight_decay=0.0001)
device :  cuda:0

Epoch :  1 loss training:  107.12524677813053 Time :  991
accuracy train: 0.748359 val: 0.716901 test: 0.736635
max validation accuracy : 0.716901 max acc epoch : 1 test accuracy : 0.736635
Epoch-1 lr: 0.005

Epoch :  2 loss training:  88.39975941181183 Time :  1001
accuracy train: 0.794780 val: 0.754930 test: 0.776590
max validation accuracy : 0.754930 max acc epoch : 2 test accuracy : 0.776590
Epoch-2 lr: 0.005

Epoch :  3 loss training:  83.12496277689934 Time :  1010
accuracy train: 0.806033 val: 0.767606 test: 0.774057
max validation accuracy : 0.767606 max acc epoch : 3 test accuracy : 0.774057
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  74.78916332125664 Time :  1022
accuracy train: 0.827759 val: 0.764789 test: 0.784750
max validation accuracy : 0.767606 max acc epoch : 3 test accuracy : 0.774057
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  72.36309713125229 Time :  1031
accuracy train: 0.843076 val: 0.760563 test: 0.777997
max validation accuracy : 0.767606 max acc epoch : 3 test accuracy : 0.774057
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  70.17410126328468 Time :  1042
accuracy train: 0.871679 val: 0.774648 test: 0.776871
max validation accuracy : 0.774648 max acc epoch : 6 test accuracy : 0.776871
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  62.104305282235146 Time :  1051
accuracy train: 0.878868 val: 0.764789 test: 0.773495
max validation accuracy : 0.774648 max acc epoch : 6 test accuracy : 0.776871
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  59.958579286932945 Time :  1061
accuracy train: 0.895749 val: 0.764789 test: 0.777715
max validation accuracy : 0.774648 max acc epoch : 6 test accuracy : 0.776871
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  62.585375770926476 Time :  1071
accuracy train: 0.890122 val: 0.777465 test: 0.774620
max validation accuracy : 0.777465 max acc epoch : 9 test accuracy : 0.774620
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  58.46161335706711 Time :  1081
accuracy train: 0.909034 val: 0.773239 test: 0.769555
max validation accuracy : 0.777465 max acc epoch : 9 test accuracy : 0.774620
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  54.608201667666435 Time :  1093
accuracy train: 0.928415 val: 0.780282 test: 0.770962
max validation accuracy : 0.780282 max acc epoch : 11 test accuracy : 0.770962
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  47.25053781270981 Time :  1103
accuracy train: 0.950766 val: 0.785915 test: 0.769837
max validation accuracy : 0.785915 max acc epoch : 12 test accuracy : 0.769837
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  37.62089861929417 Time :  1115
accuracy train: 0.965302 val: 0.784507 test: 0.775183
max validation accuracy : 0.785915 max acc epoch : 12 test accuracy : 0.769837
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  34.11904679983854 Time :  1127
accuracy train: 0.971866 val: 0.777465 test: 0.772932
max validation accuracy : 0.785915 max acc epoch : 12 test accuracy : 0.769837
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  29.960340052843094 Time :  1138
accuracy train: 0.980463 val: 0.783099 test: 0.768711
max validation accuracy : 0.785915 max acc epoch : 12 test accuracy : 0.769837

Epoch :  16 loss training:  26.423036962747574 Time :  1148
accuracy train: 0.985621 val: 0.778873 test: 0.767867
max validation accuracy : 0.785915 max acc epoch : 12 test accuracy : 0.769837

Epoch :  17 loss training:  22.676258511841297 Time :  1158
accuracy train: 0.988434 val: 0.773239 test: 0.761677
max validation accuracy : 0.785915 max acc epoch : 12 test accuracy : 0.769837

Epoch :  18 loss training:  19.886129893362522 Time :  1169
accuracy train: 0.992185 val: 0.770423 test: 0.760551
max validation accuracy : 0.785915 max acc epoch : 12 test accuracy : 0.769837

Epoch :  19 loss training:  17.52171327546239 Time :  1179
accuracy train: 0.994842 val: 0.767606 test: 0.755487
max validation accuracy : 0.785915 max acc epoch : 12 test accuracy : 0.769837

Epoch :  20 loss training:  14.422635296359658 Time :  1190
accuracy train: 0.998124 val: 0.766197 test: 0.758582
max validation accuracy : 0.785915 max acc epoch : 12 test accuracy : 0.769837

Epoch :  21 loss training:  12.25562727637589 Time :  1202
accuracy train: 0.998437 val: 0.761972 test: 0.759989
max validation accuracy : 0.785915 max acc epoch : 12 test accuracy : 0.769837

Epoch :  22 loss training:  10.179940573871136 Time :  1213
accuracy train: 0.998906 val: 0.760563 test: 0.755768
max validation accuracy : 0.785915 max acc epoch : 12 test accuracy : 0.769837

Epoch :  23 loss training:  8.298153355717659 Time :  1224
accuracy train: 0.999062 val: 0.761972 test: 0.752392
max validation accuracy : 0.785915 max acc epoch : 12 test accuracy : 0.769837

========================================================================================================================================================================================================
best acc epoch :  12
validation accuracy :  0.7859154929577464
test accuracy :  0.7698368036015757
last test_accuracy :  0.7523916713562183
second best val :  0.7845070422535211
second best test :  0.7698368036015757
max gap 3
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=205, tsne=False, weight_decay=0.0001)
device :  cuda:0

Epoch :  1 loss training:  101.16951915621758 Time :  1236
accuracy train: 0.753673 val: 0.769014 test: 0.750985
max validation accuracy : 0.769014 max acc epoch : 1 test accuracy : 0.750985
Epoch-1 lr: 0.005

Epoch :  2 loss training:  91.82459035515785 Time :  1245
accuracy train: 0.795561 val: 0.767606 test: 0.775183
max validation accuracy : 0.769014 max acc epoch : 1 test accuracy : 0.750985
Epoch-2 lr: 0.005

Epoch :  3 loss training:  86.7483157813549 Time :  1257
accuracy train: 0.779775 val: 0.767606 test: 0.756894
max validation accuracy : 0.769014 max acc epoch : 1 test accuracy : 0.750985
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  80.0491872727871 Time :  1264
accuracy train: 0.819006 val: 0.771831 test: 0.783624
max validation accuracy : 0.771831 max acc epoch : 4 test accuracy : 0.783624
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  77.34961208701134 Time :  1274
accuracy train: 0.813223 val: 0.773239 test: 0.773495
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.773495
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  76.15572004020214 Time :  1285
accuracy train: 0.830259 val: 0.770423 test: 0.772088
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.773495
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  69.32855582237244 Time :  1296
accuracy train: 0.842138 val: 0.780282 test: 0.776027
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776027
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  68.3122707605362 Time :  1306
accuracy train: 0.857612 val: 0.783099 test: 0.781936
max validation accuracy : 0.783099 max acc epoch : 8 test accuracy : 0.781936
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  67.56951363384724 Time :  1315
accuracy train: 0.864333 val: 0.781690 test: 0.774902
max validation accuracy : 0.783099 max acc epoch : 8 test accuracy : 0.781936
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  64.02938923239708 Time :  1326
accuracy train: 0.877618 val: 0.784507 test: 0.779966
max validation accuracy : 0.784507 max acc epoch : 10 test accuracy : 0.779966
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  63.23029814660549 Time :  1337
accuracy train: 0.893560 val: 0.783099 test: 0.772088
max validation accuracy : 0.784507 max acc epoch : 10 test accuracy : 0.779966
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  55.35919304192066 Time :  1349
accuracy train: 0.921851 val: 0.791549 test: 0.772088
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.772088
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  45.740698873996735 Time :  1361
accuracy train: 0.941232 val: 0.790141 test: 0.783061
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.772088
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  41.77438246458769 Time :  1371
accuracy train: 0.950922 val: 0.787324 test: 0.776871
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.772088
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  37.407440185546875 Time :  1383
accuracy train: 0.965771 val: 0.790141 test: 0.778559
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.772088

Epoch :  16 loss training:  32.76854146271944 Time :  1393
accuracy train: 0.973273 val: 0.783099 test: 0.777153
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.772088

Epoch :  17 loss training:  28.393205150961876 Time :  1405
accuracy train: 0.979212 val: 0.778873 test: 0.770681
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.772088

Epoch :  18 loss training:  24.178338807076216 Time :  1416
accuracy train: 0.983276 val: 0.773239 test: 0.765335
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.772088

Epoch :  19 loss training:  21.915081802755594 Time :  1426
accuracy train: 0.990153 val: 0.771831 test: 0.767586
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.772088

Epoch :  20 loss training:  18.09562847018242 Time :  1438
accuracy train: 0.994842 val: 0.766197 test: 0.763365
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.772088

Epoch :  21 loss training:  14.033594200387597 Time :  1448
accuracy train: 0.996405 val: 0.761972 test: 0.759989
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.772088

Epoch :  22 loss training:  11.745682075619698 Time :  1460
accuracy train: 0.998281 val: 0.776056 test: 0.758019
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.772088

Epoch :  23 loss training:  10.149905071593821 Time :  1471
accuracy train: 0.998906 val: 0.763380 test: 0.757738
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.772088

========================================================================================================================================================================================================
best acc epoch :  12
validation accuracy :  0.7915492957746478
test accuracy :  0.7720877884074282
last test_accuracy :  0.7577377602701182
second best val :  0.7901408450704225
second best test :  0.7720877884074282
max gap 3
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  12 	 val_accuracy : 0.78592 	 test_accuracy : 0.76843 	 last test_accuracy : 0.75267 	 second best val : 0.78310 	 second best test : 0.77012
k :  1 	 best_acc epoch :  11 	 val_accuracy : 0.79718 	 test_accuracy : 0.77743 	 last test_accuracy : 0.75127 	 second best val : 0.79296 	 second best test : 0.77743
k :  2 	 best_acc epoch :  18 	 val_accuracy : 0.78873 	 test_accuracy : 0.76055 	 last test_accuracy : 0.74761 	 second best val : 0.78732 	 second best test : 0.77462
k :  3 	 best_acc epoch :  12 	 val_accuracy : 0.79014 	 test_accuracy : 0.77406 	 last test_accuracy : 0.74845 	 second best val : 0.78873 	 second best test : 0.77715
k :  4 	 best_acc epoch :  12 	 val_accuracy : 0.78592 	 test_accuracy : 0.76984 	 last test_accuracy : 0.75239 	 second best val : 0.78451 	 second best test : 0.76984
k :  5 	 best_acc epoch :  12 	 val_accuracy : 0.79155 	 test_accuracy : 0.77209 	 last test_accuracy : 0.75774 	 second best val : 0.79014 	 second best test : 0.77209

avg :  	 val_accuracy : 0.78991 	 test_accuracy : 0.77040 	 last_accuracy : 0.75169 	 second best val : 0.78779 	 second best test : 0.77354

std :  	 val_accuracy : 0.00385 	 test_accuracy : 0.00527 	 last_accuracy : 0.00330 	 second best val : 0.00332 	 second best test : 0.00308


date and time :  Sun Jun 13 00:59:43 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=732, tsne=False, weight_decay=1e-07)
device :  cuda:0

Epoch :  1 loss training:  91.67455092072487 Time :  13
accuracy train: 0.765864 val: 0.750704 test: 0.763365
max validation accuracy : 0.750704 max acc epoch : 1 test accuracy : 0.763365
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.78698298335075 Time :  23
accuracy train: 0.790560 val: 0.756338 test: 0.766179
max validation accuracy : 0.756338 max acc epoch : 2 test accuracy : 0.766179
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  80.42292982339859 Time :  35
accuracy train: 0.805095 val: 0.769014 test: 0.773213
max validation accuracy : 0.769014 max acc epoch : 3 test accuracy : 0.773213
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.6104356944561 Time :  45
accuracy train: 0.807596 val: 0.756338 test: 0.778559
max validation accuracy : 0.769014 max acc epoch : 3 test accuracy : 0.773213
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  74.25064994394779 Time :  54
accuracy train: 0.822132 val: 0.777465 test: 0.778841
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.778841
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.92716160416603 Time :  62
accuracy train: 0.829165 val: 0.788732 test: 0.770681
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.770681
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  70.52468667924404 Time :  74
accuracy train: 0.834948 val: 0.764789 test: 0.779403
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.770681
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  70.05576907098293 Time :  86
accuracy train: 0.842451 val: 0.766197 test: 0.775183
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.770681
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  69.18070013821125 Time :  97
accuracy train: 0.845889 val: 0.773239 test: 0.774339
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.770681
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  67.61702351272106 Time :  108
accuracy train: 0.848390 val: 0.767606 test: 0.776871
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.770681
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  65.68943876028061 Time :  117
accuracy train: 0.859956 val: 0.776056 test: 0.779685
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.770681
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.83909164369106 Time :  129
accuracy train: 0.865114 val: 0.774648 test: 0.776871
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.770681
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  62.41020381450653 Time :  139
accuracy train: 0.865427 val: 0.774648 test: 0.775746
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.770681
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  61.305853113532066 Time :  149
accuracy train: 0.869178 val: 0.778873 test: 0.777715
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.770681
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  61.183830827474594 Time :  160
accuracy train: 0.876837 val: 0.776056 test: 0.775746
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.770681

Epoch :  16 loss training:  59.66361655294895 Time :  170
accuracy train: 0.874492 val: 0.773239 test: 0.778559
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.770681

Epoch :  17 loss training:  58.79314133524895 Time :  181
accuracy train: 0.883401 val: 0.773239 test: 0.779403
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.770681

========================================================================================================================================================================================================
best acc epoch :  6
validation accuracy :  0.7887323943661971
test accuracy :  0.7706809229037704
last test_accuracy :  0.7794034890264491
second best val :  0.7788732394366197
second best test :  0.7706809229037704
max gap 2
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=732, tsne=False, weight_decay=1e-07)
device :  cuda:0

Epoch :  1 loss training:  91.63593298196793 Time :  192
accuracy train: 0.764770 val: 0.754930 test: 0.763365
max validation accuracy : 0.754930 max acc epoch : 1 test accuracy : 0.763365
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.73163908720016 Time :  199
accuracy train: 0.790716 val: 0.759155 test: 0.762802
max validation accuracy : 0.759155 max acc epoch : 2 test accuracy : 0.762802
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  80.29247039556503 Time :  210
accuracy train: 0.802751 val: 0.778873 test: 0.774620
max validation accuracy : 0.778873 max acc epoch : 3 test accuracy : 0.774620
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.72159266471863 Time :  221
accuracy train: 0.805564 val: 0.761972 test: 0.775183
max validation accuracy : 0.778873 max acc epoch : 3 test accuracy : 0.774620
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  74.45172534883022 Time :  231
accuracy train: 0.820882 val: 0.785915 test: 0.779403
max validation accuracy : 0.785915 max acc epoch : 5 test accuracy : 0.779403
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  73.10088329017162 Time :  243
accuracy train: 0.828071 val: 0.783099 test: 0.773495
max validation accuracy : 0.785915 max acc epoch : 5 test accuracy : 0.779403
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  70.75929273664951 Time :  253
accuracy train: 0.831666 val: 0.767606 test: 0.778278
max validation accuracy : 0.785915 max acc epoch : 5 test accuracy : 0.779403
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  70.07401293516159 Time :  262
accuracy train: 0.841826 val: 0.766197 test: 0.776590
max validation accuracy : 0.785915 max acc epoch : 5 test accuracy : 0.779403
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  69.45937772095203 Time :  271
accuracy train: 0.845264 val: 0.776056 test: 0.772932
max validation accuracy : 0.785915 max acc epoch : 5 test accuracy : 0.779403
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  67.54021629691124 Time :  282
accuracy train: 0.846983 val: 0.770423 test: 0.778278
max validation accuracy : 0.785915 max acc epoch : 5 test accuracy : 0.779403
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  65.77619130909443 Time :  292
accuracy train: 0.856830 val: 0.776056 test: 0.775746
max validation accuracy : 0.785915 max acc epoch : 5 test accuracy : 0.779403
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.73861576616764 Time :  303
accuracy train: 0.861519 val: 0.773239 test: 0.776027
max validation accuracy : 0.785915 max acc epoch : 5 test accuracy : 0.779403
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  62.16035132110119 Time :  314
accuracy train: 0.864176 val: 0.769014 test: 0.775183
max validation accuracy : 0.785915 max acc epoch : 5 test accuracy : 0.779403
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  61.278254464268684 Time :  324
accuracy train: 0.866521 val: 0.770423 test: 0.777434
max validation accuracy : 0.785915 max acc epoch : 5 test accuracy : 0.779403
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  61.146130457520485 Time :  335
accuracy train: 0.873242 val: 0.770423 test: 0.776308
max validation accuracy : 0.785915 max acc epoch : 5 test accuracy : 0.779403

Epoch :  16 loss training:  59.61700135469437 Time :  346
accuracy train: 0.875742 val: 0.773239 test: 0.779122
max validation accuracy : 0.785915 max acc epoch : 5 test accuracy : 0.779403

========================================================================================================================================================================================================
best acc epoch :  5
validation accuracy :  0.7859154929577464
test accuracy :  0.7794034890264491
last test_accuracy :  0.7791221159257175
second best val :  0.7830985915492957
second best test :  0.7794034890264491
max gap 2
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=732, tsne=False, weight_decay=1e-07)
device :  cuda:0

Epoch :  1 loss training:  91.64189130067825 Time :  358
accuracy train: 0.767115 val: 0.749296 test: 0.765616
max validation accuracy : 0.749296 max acc epoch : 1 test accuracy : 0.765616
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.89812684059143 Time :  370
accuracy train: 0.789465 val: 0.757746 test: 0.765335
max validation accuracy : 0.757746 max acc epoch : 2 test accuracy : 0.765335
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  80.35039201378822 Time :  380
accuracy train: 0.803376 val: 0.781690 test: 0.770962
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.770962
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.55684569478035 Time :  390
accuracy train: 0.810722 val: 0.759155 test: 0.778559
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.770962
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  74.29106833040714 Time :  400
accuracy train: 0.820100 val: 0.776056 test: 0.777434
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.770962
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.99734635651112 Time :  411
accuracy train: 0.826352 val: 0.790141 test: 0.772651
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.772651
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  70.79807159304619 Time :  421
accuracy train: 0.833073 val: 0.766197 test: 0.775746
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.772651
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.85000413656235 Time :  432
accuracy train: 0.842451 val: 0.774648 test: 0.775746
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.772651
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  69.05539351701736 Time :  442
accuracy train: 0.844952 val: 0.770423 test: 0.770400
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.772651
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  67.475426197052 Time :  453
accuracy train: 0.850109 val: 0.767606 test: 0.778278
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.772651
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  65.23915372788906 Time :  464
accuracy train: 0.857612 val: 0.767606 test: 0.770118
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.772651
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.63664022088051 Time :  475
accuracy train: 0.863551 val: 0.778873 test: 0.774057
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.772651
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  62.235380083322525 Time :  484
accuracy train: 0.867927 val: 0.771831 test: 0.774620
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.772651
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  61.15160422027111 Time :  494
accuracy train: 0.873554 val: 0.773239 test: 0.775183
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.772651
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  60.9526252746582 Time :  507
accuracy train: 0.876055 val: 0.780282 test: 0.773776
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.772651

Epoch :  16 loss training:  59.51998810470104 Time :  518
accuracy train: 0.876055 val: 0.769014 test: 0.775746
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.772651

Epoch :  17 loss training:  58.63432478904724 Time :  528
accuracy train: 0.884808 val: 0.777465 test: 0.773495
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.772651

========================================================================================================================================================================================================
best acc epoch :  6
validation accuracy :  0.7901408450704225
test accuracy :  0.7726505346088914
last test_accuracy :  0.7734946539110861
second best val :  0.7816901408450704
second best test :  0.770962296004502
max gap 3
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=732, tsne=False, weight_decay=1e-07)
device :  cuda:0

Epoch :  1 loss training:  91.69983461499214 Time :  541
accuracy train: 0.767427 val: 0.746479 test: 0.762802
max validation accuracy : 0.746479 max acc epoch : 1 test accuracy : 0.762802
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.85918629169464 Time :  552
accuracy train: 0.788059 val: 0.761972 test: 0.765335
max validation accuracy : 0.761972 max acc epoch : 2 test accuracy : 0.765335
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  80.26175871491432 Time :  562
accuracy train: 0.805408 val: 0.770423 test: 0.773495
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.773495
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.5317696928978 Time :  573
accuracy train: 0.808378 val: 0.763380 test: 0.775183
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.773495
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  74.44788585603237 Time :  584
accuracy train: 0.823070 val: 0.776056 test: 0.778278
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.778278
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.79722291231155 Time :  595
accuracy train: 0.826977 val: 0.791549 test: 0.770962
max validation accuracy : 0.791549 max acc epoch : 6 test accuracy : 0.770962
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  70.54117438197136 Time :  606
accuracy train: 0.834323 val: 0.760563 test: 0.779966
max validation accuracy : 0.791549 max acc epoch : 6 test accuracy : 0.770962
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.9382746219635 Time :  616
accuracy train: 0.843389 val: 0.771831 test: 0.774620
max validation accuracy : 0.791549 max acc epoch : 6 test accuracy : 0.770962
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  69.13292235136032 Time :  628
accuracy train: 0.847921 val: 0.773239 test: 0.776027
max validation accuracy : 0.791549 max acc epoch : 6 test accuracy : 0.770962
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  67.48812934756279 Time :  638
accuracy train: 0.849484 val: 0.764789 test: 0.778841
max validation accuracy : 0.791549 max acc epoch : 6 test accuracy : 0.770962
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  65.70316791534424 Time :  650
accuracy train: 0.856049 val: 0.773239 test: 0.777434
max validation accuracy : 0.791549 max acc epoch : 6 test accuracy : 0.770962
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.85381180047989 Time :  660
accuracy train: 0.862613 val: 0.778873 test: 0.779122
max validation accuracy : 0.791549 max acc epoch : 6 test accuracy : 0.770962
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  62.447788923978806 Time :  672
accuracy train: 0.865270 val: 0.780282 test: 0.776590
max validation accuracy : 0.791549 max acc epoch : 6 test accuracy : 0.770962
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  61.079324662685394 Time :  683
accuracy train: 0.870585 val: 0.776056 test: 0.778278
max validation accuracy : 0.791549 max acc epoch : 6 test accuracy : 0.770962
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  61.097034096717834 Time :  693
accuracy train: 0.876524 val: 0.778873 test: 0.779403
max validation accuracy : 0.791549 max acc epoch : 6 test accuracy : 0.770962

Epoch :  16 loss training:  59.674542620778084 Time :  704
accuracy train: 0.876524 val: 0.773239 test: 0.779122
max validation accuracy : 0.791549 max acc epoch : 6 test accuracy : 0.770962

Epoch :  17 loss training:  58.79065425693989 Time :  714
accuracy train: 0.882776 val: 0.776056 test: 0.780529
max validation accuracy : 0.791549 max acc epoch : 6 test accuracy : 0.770962

========================================================================================================================================================================================================
best acc epoch :  6
validation accuracy :  0.7915492957746478
test accuracy :  0.770962296004502
last test_accuracy :  0.7805289814293753
second best val :  0.780281690140845
second best test :  0.770962296004502
max gap 2
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=732, tsne=False, weight_decay=1e-07)
device :  cuda:0

Epoch :  1 loss training:  91.62625339627266 Time :  726
accuracy train: 0.764301 val: 0.749296 test: 0.763647
max validation accuracy : 0.749296 max acc epoch : 1 test accuracy : 0.763647
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.70217755436897 Time :  737
accuracy train: 0.789778 val: 0.752113 test: 0.763365
max validation accuracy : 0.752113 max acc epoch : 2 test accuracy : 0.763365
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  80.48223692178726 Time :  747
accuracy train: 0.805721 val: 0.781690 test: 0.772651
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.772651
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.43125176429749 Time :  758
accuracy train: 0.807284 val: 0.747887 test: 0.774057
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.772651
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  74.52310632169247 Time :  769
accuracy train: 0.819319 val: 0.778873 test: 0.781373
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.772651
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.93479552865028 Time :  780
accuracy train: 0.827602 val: 0.781690 test: 0.770400
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.772651
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  70.75464867055416 Time :  791
accuracy train: 0.833229 val: 0.763380 test: 0.778278
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.772651
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  70.1200891584158 Time :  802
accuracy train: 0.841669 val: 0.763380 test: 0.775183
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.772651
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  69.42174060642719 Time :  812
accuracy train: 0.845420 val: 0.771831 test: 0.773495
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.772651
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  67.60267022252083 Time :  822
accuracy train: 0.847765 val: 0.769014 test: 0.776308
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.772651
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  65.68963395059109 Time :  834
accuracy train: 0.856049 val: 0.776056 test: 0.776308
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.772651
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.99862134456635 Time :  845
accuracy train: 0.862613 val: 0.774648 test: 0.777153
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.772651
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  62.29636722803116 Time :  855
accuracy train: 0.866364 val: 0.770423 test: 0.773776
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.772651
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  61.63896068930626 Time :  866
accuracy train: 0.869178 val: 0.773239 test: 0.775183
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.772651
Epoch-14 lr: 3.125e-05

========================================================================================================================================================================================================
best acc epoch :  3
validation accuracy :  0.7816901408450704
test accuracy :  0.7726505346088914
last test_accuracy :  0.7751828925154756
second best val :  0.7788732394366197
second best test :  0.7726505346088914
max gap 1
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=732, tsne=False, weight_decay=1e-07)
device :  cuda:0

Epoch :  1 loss training:  91.65880116820335 Time :  877
accuracy train: 0.768209 val: 0.752113 test: 0.759707
max validation accuracy : 0.752113 max acc epoch : 1 test accuracy : 0.759707
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.91799396276474 Time :  888
accuracy train: 0.787590 val: 0.760563 test: 0.765616
max validation accuracy : 0.760563 max acc epoch : 2 test accuracy : 0.765616
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  80.22942596673965 Time :  898
accuracy train: 0.805877 val: 0.773239 test: 0.774620
max validation accuracy : 0.773239 max acc epoch : 3 test accuracy : 0.774620
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.55633988976479 Time :  905
accuracy train: 0.806815 val: 0.759155 test: 0.776590
max validation accuracy : 0.773239 max acc epoch : 3 test accuracy : 0.774620
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  74.53797756135464 Time :  916
accuracy train: 0.820725 val: 0.776056 test: 0.779685
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779685
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.9546375721693 Time :  926
accuracy train: 0.829791 val: 0.791549 test: 0.771806
max validation accuracy : 0.791549 max acc epoch : 6 test accuracy : 0.771806
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  70.86626471579075 Time :  935
accuracy train: 0.832135 val: 0.763380 test: 0.776590
max validation accuracy : 0.791549 max acc epoch : 6 test accuracy : 0.771806
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  70.0755537301302 Time :  942
accuracy train: 0.840419 val: 0.757746 test: 0.775183
max validation accuracy : 0.791549 max acc epoch : 6 test accuracy : 0.771806
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  69.40158371627331 Time :  952
accuracy train: 0.845420 val: 0.771831 test: 0.773776
max validation accuracy : 0.791549 max acc epoch : 6 test accuracy : 0.771806
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  67.64270050823689 Time :  959
accuracy train: 0.846671 val: 0.767606 test: 0.777715
max validation accuracy : 0.791549 max acc epoch : 6 test accuracy : 0.771806
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  65.71527384221554 Time :  969
accuracy train: 0.857299 val: 0.773239 test: 0.774620
max validation accuracy : 0.791549 max acc epoch : 6 test accuracy : 0.771806
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.66524381935596 Time :  976
accuracy train: 0.863864 val: 0.771831 test: 0.775183
max validation accuracy : 0.791549 max acc epoch : 6 test accuracy : 0.771806
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  62.426108688116074 Time :  983
accuracy train: 0.867771 val: 0.771831 test: 0.774339
max validation accuracy : 0.791549 max acc epoch : 6 test accuracy : 0.771806
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  61.2693180590868 Time :  994
accuracy train: 0.870585 val: 0.778873 test: 0.776308
max validation accuracy : 0.791549 max acc epoch : 6 test accuracy : 0.771806
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  61.209741562604904 Time :  1005
accuracy train: 0.874179 val: 0.777465 test: 0.776308
max validation accuracy : 0.791549 max acc epoch : 6 test accuracy : 0.771806

Epoch :  16 loss training:  59.71504479646683 Time :  1015
accuracy train: 0.878087 val: 0.776056 test: 0.781373
max validation accuracy : 0.791549 max acc epoch : 6 test accuracy : 0.771806

Epoch :  17 loss training:  58.81991329789162 Time :  1026
accuracy train: 0.882620 val: 0.774648 test: 0.779403
max validation accuracy : 0.791549 max acc epoch : 6 test accuracy : 0.771806

========================================================================================================================================================================================================
best acc epoch :  6
validation accuracy :  0.7915492957746478
test accuracy :  0.7718064153066967
last test_accuracy :  0.7794034890264491
second best val :  0.7788732394366197
second best test :  0.7718064153066967
max gap 2
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  6 	 val_accuracy : 0.78873 	 test_accuracy : 0.77068 	 last test_accuracy : 0.77940 	 second best val : 0.77887 	 second best test : 0.77068
k :  1 	 best_acc epoch :  5 	 val_accuracy : 0.78592 	 test_accuracy : 0.77940 	 last test_accuracy : 0.77912 	 second best val : 0.78310 	 second best test : 0.77940
k :  2 	 best_acc epoch :  6 	 val_accuracy : 0.79014 	 test_accuracy : 0.77265 	 last test_accuracy : 0.77349 	 second best val : 0.78169 	 second best test : 0.77096
k :  3 	 best_acc epoch :  6 	 val_accuracy : 0.79155 	 test_accuracy : 0.77096 	 last test_accuracy : 0.78053 	 second best val : 0.78028 	 second best test : 0.77096
k :  4 	 best_acc epoch :  3 	 val_accuracy : 0.78169 	 test_accuracy : 0.77265 	 last test_accuracy : 0.77518 	 second best val : 0.77887 	 second best test : 0.77265
k :  5 	 best_acc epoch :  6 	 val_accuracy : 0.79155 	 test_accuracy : 0.77181 	 last test_accuracy : 0.77940 	 second best val : 0.77887 	 second best test : 0.77181

avg :  	 val_accuracy : 0.78826 	 test_accuracy : 0.77303 	 last_accuracy : 0.77786 	 second best val : 0.78028 	 second best test : 0.77274

std :  	 val_accuracy : 0.00351 	 test_accuracy : 0.00295 	 last_accuracy : 0.00257 	 second best val : 0.00163 	 second best test : 0.00305


date and time :  Sun Jun 13 01:16:54 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=120, tsne=False, weight_decay=1e-07)
device :  cuda:0

Epoch :  1 loss training:  100.71326765418053 Time :  11
accuracy train: 0.616912 val: 0.607042 test: 0.610580
max validation accuracy : 0.607042 max acc epoch : 1 test accuracy : 0.610580
Epoch-1 lr: 0.005

Epoch :  2 loss training:  88.27556991577148 Time :  22
accuracy train: 0.785871 val: 0.757746 test: 0.760551
max validation accuracy : 0.757746 max acc epoch : 2 test accuracy : 0.760551
Epoch-2 lr: 0.005

Epoch :  3 loss training:  93.7388828843832 Time :  32
accuracy train: 0.733042 val: 0.739437 test: 0.719752
max validation accuracy : 0.757746 max acc epoch : 2 test accuracy : 0.760551
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  84.64844428002834 Time :  43
accuracy train: 0.813692 val: 0.759155 test: 0.767304
max validation accuracy : 0.759155 max acc epoch : 4 test accuracy : 0.767304
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  82.7784952968359 Time :  54
accuracy train: 0.811660 val: 0.750704 test: 0.760551
max validation accuracy : 0.759155 max acc epoch : 4 test accuracy : 0.767304
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  76.56523260474205 Time :  65
accuracy train: 0.825883 val: 0.747887 test: 0.768149
max validation accuracy : 0.759155 max acc epoch : 4 test accuracy : 0.767304
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  73.90057319402695 Time :  74
accuracy train: 0.838074 val: 0.767606 test: 0.768430
max validation accuracy : 0.767606 max acc epoch : 7 test accuracy : 0.768430
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  71.80614534020424 Time :  86
accuracy train: 0.851985 val: 0.747887 test: 0.776308
max validation accuracy : 0.767606 max acc epoch : 7 test accuracy : 0.768430
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  69.42776964604855 Time :  95
accuracy train: 0.855267 val: 0.752113 test: 0.771806
max validation accuracy : 0.767606 max acc epoch : 7 test accuracy : 0.768430
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  67.58890950679779 Time :  107
accuracy train: 0.866052 val: 0.754930 test: 0.770962
max validation accuracy : 0.767606 max acc epoch : 7 test accuracy : 0.768430
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  67.31617371737957 Time :  117
accuracy train: 0.890747 val: 0.776056 test: 0.772932
max validation accuracy : 0.776056 max acc epoch : 11 test accuracy : 0.772932
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  56.78003005683422 Time :  128
accuracy train: 0.922945 val: 0.757746 test: 0.773495
max validation accuracy : 0.776056 max acc epoch : 11 test accuracy : 0.772932
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  46.13958580046892 Time :  139
accuracy train: 0.935605 val: 0.774648 test: 0.777715
max validation accuracy : 0.776056 max acc epoch : 11 test accuracy : 0.772932
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  40.64417164027691 Time :  151
accuracy train: 0.945921 val: 0.767606 test: 0.773776
max validation accuracy : 0.776056 max acc epoch : 11 test accuracy : 0.772932
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  37.69601956754923 Time :  161
accuracy train: 0.957643 val: 0.777465 test: 0.774339
max validation accuracy : 0.777465 max acc epoch : 15 test accuracy : 0.774339

Epoch :  16 loss training:  32.48466071859002 Time :  167
accuracy train: 0.965771 val: 0.780282 test: 0.774902
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774902

Epoch :  17 loss training:  29.54379790648818 Time :  177
accuracy train: 0.972804 val: 0.790141 test: 0.769274
max validation accuracy : 0.790141 max acc epoch : 17 test accuracy : 0.769274

Epoch :  18 loss training:  26.19073523953557 Time :  184
accuracy train: 0.977806 val: 0.791549 test: 0.771525
max validation accuracy : 0.791549 max acc epoch : 18 test accuracy : 0.771525

Epoch :  19 loss training:  23.02190524712205 Time :  194
accuracy train: 0.981400 val: 0.797183 test: 0.769555
max validation accuracy : 0.797183 max acc epoch : 19 test accuracy : 0.769555

Epoch :  20 loss training:  21.512121826410294 Time :  203
accuracy train: 0.985777 val: 0.797183 test: 0.767304
max validation accuracy : 0.797183 max acc epoch : 19 test accuracy : 0.769555

Epoch :  21 loss training:  18.463230641558766 Time :  215
accuracy train: 0.988278 val: 0.792958 test: 0.759426
max validation accuracy : 0.797183 max acc epoch : 19 test accuracy : 0.769555

Epoch :  22 loss training:  15.843673234805465 Time :  226
accuracy train: 0.990778 val: 0.794366 test: 0.760833
max validation accuracy : 0.797183 max acc epoch : 19 test accuracy : 0.769555

Epoch :  23 loss training:  13.609567384235561 Time :  236
accuracy train: 0.992498 val: 0.798592 test: 0.758019
max validation accuracy : 0.798592 max acc epoch : 23 test accuracy : 0.758019

Epoch :  24 loss training:  12.303423592820764 Time :  248
accuracy train: 0.993123 val: 0.790141 test: 0.758019
max validation accuracy : 0.798592 max acc epoch : 23 test accuracy : 0.758019

Epoch :  25 loss training:  10.850861045531929 Time :  257
accuracy train: 0.995936 val: 0.784507 test: 0.756894
max validation accuracy : 0.798592 max acc epoch : 23 test accuracy : 0.758019

Epoch :  26 loss training:  10.121315269730985 Time :  269
accuracy train: 0.995780 val: 0.794366 test: 0.755487
max validation accuracy : 0.798592 max acc epoch : 23 test accuracy : 0.758019

Epoch :  27 loss training:  8.949778993614018 Time :  280
accuracy train: 0.997656 val: 0.781690 test: 0.752110
max validation accuracy : 0.798592 max acc epoch : 23 test accuracy : 0.758019

Epoch :  28 loss training:  8.199545352254063 Time :  289
accuracy train: 0.997968 val: 0.784507 test: 0.750703
max validation accuracy : 0.798592 max acc epoch : 23 test accuracy : 0.758019

Epoch :  29 loss training:  7.307461345568299 Time :  301
accuracy train: 0.998593 val: 0.770423 test: 0.750141
max validation accuracy : 0.798592 max acc epoch : 23 test accuracy : 0.758019

Epoch :  30 loss training:  5.592706857249141 Time :  311
accuracy train: 0.999219 val: 0.784507 test: 0.751548
max validation accuracy : 0.798592 max acc epoch : 23 test accuracy : 0.758019

Epoch :  31 loss training:  5.443897486664355 Time :  323
accuracy train: 0.999062 val: 0.777465 test: 0.751548
max validation accuracy : 0.798592 max acc epoch : 23 test accuracy : 0.758019

Epoch :  32 loss training:  4.77179578715004 Time :  334
accuracy train: 0.999531 val: 0.776056 test: 0.748734
max validation accuracy : 0.798592 max acc epoch : 23 test accuracy : 0.758019

Epoch :  33 loss training:  4.821487996727228 Time :  345
accuracy train: 0.999844 val: 0.784507 test: 0.748171
max validation accuracy : 0.798592 max acc epoch : 23 test accuracy : 0.758019

Epoch :  34 loss training:  4.079439925495535 Time :  356
accuracy train: 0.999687 val: 0.778873 test: 0.747327
max validation accuracy : 0.798592 max acc epoch : 23 test accuracy : 0.758019

========================================================================================================================================================================================================
best acc epoch :  23
validation accuracy :  0.7985915492957747
test accuracy :  0.7580191333708497
last test_accuracy :  0.7473269555430501
second best val :  0.7971830985915493
second best test :  0.7695554305008441
max gap 4
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=120, tsne=False, weight_decay=1e-07)
device :  cuda:0

Epoch :  1 loss training:  101.38570287823677 Time :  366
accuracy train: 0.700375 val: 0.678873 test: 0.682611
max validation accuracy : 0.678873 max acc epoch : 1 test accuracy : 0.682611
Epoch-1 lr: 0.005

Epoch :  2 loss training:  91.84710800647736 Time :  378
accuracy train: 0.770084 val: 0.735211 test: 0.744513
max validation accuracy : 0.735211 max acc epoch : 2 test accuracy : 0.744513
Epoch-2 lr: 0.005

Epoch :  3 loss training:  86.76398931443691 Time :  388
accuracy train: 0.802438 val: 0.745070 test: 0.765616
max validation accuracy : 0.745070 max acc epoch : 3 test accuracy : 0.765616
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  76.35703468322754 Time :  400
accuracy train: 0.821507 val: 0.766197 test: 0.773776
max validation accuracy : 0.766197 max acc epoch : 4 test accuracy : 0.773776
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  74.88542683422565 Time :  410
accuracy train: 0.830103 val: 0.760563 test: 0.765335
max validation accuracy : 0.766197 max acc epoch : 4 test accuracy : 0.773776
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  68.68728291988373 Time :  421
accuracy train: 0.839168 val: 0.776056 test: 0.766460
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.766460
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  67.04889068007469 Time :  433
accuracy train: 0.857768 val: 0.769014 test: 0.772369
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.766460
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  64.39828780293465 Time :  442
accuracy train: 0.882932 val: 0.760563 test: 0.774057
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.766460
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  60.14837980270386 Time :  453
accuracy train: 0.892935 val: 0.760563 test: 0.766460
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.766460
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  56.141731351614 Time :  462
accuracy train: 0.909034 val: 0.767606 test: 0.769555
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.766460
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  55.85696941614151 Time :  473
accuracy train: 0.932791 val: 0.776056 test: 0.778278
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.766460
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  45.5351418107748 Time :  483
accuracy train: 0.952173 val: 0.773239 test: 0.772088
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.766460
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  34.07653971016407 Time :  493
accuracy train: 0.963895 val: 0.780282 test: 0.774620
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.774620
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  29.131188448518515 Time :  504
accuracy train: 0.977493 val: 0.778873 test: 0.772088
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.774620
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  25.943930834531784 Time :  514
accuracy train: 0.982651 val: 0.777465 test: 0.772651
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.774620

Epoch :  16 loss training:  21.460830204188824 Time :  524
accuracy train: 0.986558 val: 0.778873 test: 0.771525
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.774620

Epoch :  17 loss training:  19.23465666361153 Time :  533
accuracy train: 0.990309 val: 0.776056 test: 0.767304
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.774620

Epoch :  18 loss training:  16.16522211395204 Time :  544
accuracy train: 0.994373 val: 0.774648 test: 0.763084
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.774620

Epoch :  19 loss training:  14.311269642785192 Time :  554
accuracy train: 0.995467 val: 0.784507 test: 0.764772
max validation accuracy : 0.784507 max acc epoch : 19 test accuracy : 0.764772

Epoch :  20 loss training:  12.406221449375153 Time :  565
accuracy train: 0.996093 val: 0.776056 test: 0.762240
max validation accuracy : 0.784507 max acc epoch : 19 test accuracy : 0.764772

Epoch :  21 loss training:  9.983208851888776 Time :  575
accuracy train: 0.997812 val: 0.780282 test: 0.762802
max validation accuracy : 0.784507 max acc epoch : 19 test accuracy : 0.764772

Epoch :  22 loss training:  8.64872582256794 Time :  584
accuracy train: 0.998124 val: 0.787324 test: 0.762521
max validation accuracy : 0.787324 max acc epoch : 22 test accuracy : 0.762521

Epoch :  23 loss training:  7.267698730807751 Time :  594
accuracy train: 0.999219 val: 0.778873 test: 0.761396
max validation accuracy : 0.787324 max acc epoch : 22 test accuracy : 0.762521

Epoch :  24 loss training:  6.489746467676014 Time :  604
accuracy train: 0.999531 val: 0.770423 test: 0.760270
max validation accuracy : 0.787324 max acc epoch : 22 test accuracy : 0.762521

Epoch :  25 loss training:  5.871579333674163 Time :  614
accuracy train: 0.999687 val: 0.770423 test: 0.761958
max validation accuracy : 0.787324 max acc epoch : 22 test accuracy : 0.762521

Epoch :  26 loss training:  5.1809248849749565 Time :  624
accuracy train: 0.999844 val: 0.776056 test: 0.759707
max validation accuracy : 0.787324 max acc epoch : 22 test accuracy : 0.762521

Epoch :  27 loss training:  4.8175419215112925 Time :  635
accuracy train: 0.999844 val: 0.776056 test: 0.759989
max validation accuracy : 0.787324 max acc epoch : 22 test accuracy : 0.762521

Epoch :  28 loss training:  4.067321535432711 Time :  645
accuracy train: 0.999844 val: 0.776056 test: 0.760833
max validation accuracy : 0.787324 max acc epoch : 22 test accuracy : 0.762521

Epoch :  29 loss training:  4.081594883231446 Time :  655
accuracy train: 0.999844 val: 0.759155 test: 0.758301
max validation accuracy : 0.787324 max acc epoch : 22 test accuracy : 0.762521

Epoch :  30 loss training:  3.297246443282347 Time :  666
accuracy train: 0.999844 val: 0.770423 test: 0.756331
max validation accuracy : 0.787324 max acc epoch : 22 test accuracy : 0.762521

Epoch :  31 loss training:  3.145713390316814 Time :  678
accuracy train: 0.999844 val: 0.760563 test: 0.756331
max validation accuracy : 0.787324 max acc epoch : 22 test accuracy : 0.762521

Epoch :  32 loss training:  2.728179526166059 Time :  688
accuracy train: 0.999844 val: 0.756338 test: 0.752673
max validation accuracy : 0.787324 max acc epoch : 22 test accuracy : 0.762521

Epoch :  33 loss training:  2.6381517096888274 Time :  699
accuracy train: 0.999844 val: 0.757746 test: 0.752954
max validation accuracy : 0.787324 max acc epoch : 22 test accuracy : 0.762521

========================================================================================================================================================================================================
best acc epoch :  22
validation accuracy :  0.7873239436619718
test accuracy :  0.7625211029825548
last test_accuracy :  0.7529544175576814
second best val :  0.7845070422535211
second best test :  0.7647720877884074
max gap 7
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=120, tsne=False, weight_decay=1e-07)
device :  cuda:0

Epoch :  1 loss training:  100.88178652524948 Time :  711
accuracy train: 0.750234 val: 0.714085 test: 0.726224
max validation accuracy : 0.714085 max acc epoch : 1 test accuracy : 0.726224
Epoch-1 lr: 0.005

Epoch :  2 loss training:  88.3270772099495 Time :  720
accuracy train: 0.796499 val: 0.754930 test: 0.769274
max validation accuracy : 0.754930 max acc epoch : 2 test accuracy : 0.769274
Epoch-2 lr: 0.005

Epoch :  3 loss training:  85.31579206883907 Time :  730
accuracy train: 0.811816 val: 0.752113 test: 0.765053
max validation accuracy : 0.754930 max acc epoch : 2 test accuracy : 0.769274
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  80.29737058281898 Time :  740
accuracy train: 0.772741 val: 0.747887 test: 0.736635
max validation accuracy : 0.754930 max acc epoch : 2 test accuracy : 0.769274
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  80.60698798298836 Time :  751
accuracy train: 0.847921 val: 0.761972 test: 0.778559
max validation accuracy : 0.761972 max acc epoch : 5 test accuracy : 0.778559
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  70.60261444747448 Time :  761
accuracy train: 0.869022 val: 0.766197 test: 0.777715
max validation accuracy : 0.766197 max acc epoch : 6 test accuracy : 0.777715
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  63.867570862174034 Time :  771
accuracy train: 0.882776 val: 0.764789 test: 0.779403
max validation accuracy : 0.766197 max acc epoch : 6 test accuracy : 0.777715
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  60.48830869793892 Time :  781
accuracy train: 0.894186 val: 0.766197 test: 0.774339
max validation accuracy : 0.766197 max acc epoch : 6 test accuracy : 0.777715
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  56.821955129504204 Time :  790
accuracy train: 0.910597 val: 0.763380 test: 0.772932
max validation accuracy : 0.766197 max acc epoch : 6 test accuracy : 0.777715
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  53.30048753321171 Time :  802
accuracy train: 0.925289 val: 0.761972 test: 0.771525
max validation accuracy : 0.766197 max acc epoch : 6 test accuracy : 0.777715
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  51.129670828580856 Time :  813
accuracy train: 0.947796 val: 0.783099 test: 0.773213
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773213
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  42.15040083229542 Time :  823
accuracy train: 0.965302 val: 0.777465 test: 0.765898
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773213
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  31.66774059087038 Time :  834
accuracy train: 0.978274 val: 0.784507 test: 0.772932
max validation accuracy : 0.784507 max acc epoch : 13 test accuracy : 0.772932
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  26.934930965304375 Time :  844
accuracy train: 0.982651 val: 0.777465 test: 0.772651
max validation accuracy : 0.784507 max acc epoch : 13 test accuracy : 0.772932
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  24.746790006756783 Time :  855
accuracy train: 0.987809 val: 0.788732 test: 0.773213
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.773213

Epoch :  16 loss training:  20.356955341994762 Time :  865
accuracy train: 0.991404 val: 0.791549 test: 0.769837
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.769837

Epoch :  17 loss training:  17.95042883977294 Time :  875
accuracy train: 0.993279 val: 0.778873 test: 0.766460
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.769837

Epoch :  18 loss training:  15.856212422251701 Time :  886
accuracy train: 0.994842 val: 0.774648 test: 0.769274
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.769837

Epoch :  19 loss training:  14.763807384297252 Time :  895
accuracy train: 0.997499 val: 0.781690 test: 0.763084
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.769837

Epoch :  20 loss training:  12.376422820612788 Time :  907
accuracy train: 0.997656 val: 0.784507 test: 0.759989
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.769837

Epoch :  21 loss training:  10.581962461583316 Time :  918
accuracy train: 0.998437 val: 0.774648 test: 0.761396
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.769837

Epoch :  22 loss training:  8.756907594390213 Time :  929
accuracy train: 0.999219 val: 0.778873 test: 0.758863
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.769837

Epoch :  23 loss training:  7.76746356440708 Time :  940
accuracy train: 0.999375 val: 0.784507 test: 0.762521
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.769837

Epoch :  24 loss training:  6.945053546689451 Time :  949
accuracy train: 0.999844 val: 0.783099 test: 0.759707
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.769837

Epoch :  25 loss training:  5.753511072602123 Time :  961
accuracy train: 0.999687 val: 0.784507 test: 0.759145
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.769837

Epoch :  26 loss training:  5.501497136196122 Time :  972
accuracy train: 0.999687 val: 0.785915 test: 0.760551
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.769837

Epoch :  27 loss training:  4.647051972802728 Time :  982
accuracy train: 0.999687 val: 0.777465 test: 0.756894
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.769837

========================================================================================================================================================================================================
best acc epoch :  16
validation accuracy :  0.7915492957746478
test accuracy :  0.7698368036015757
last test_accuracy :  0.7568936409679234
second best val :  0.7887323943661971
second best test :  0.7732132808103546
max gap 5
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=120, tsne=False, weight_decay=1e-07)
device :  cuda:0

Epoch :  1 loss training:  100.12851548194885 Time :  994
accuracy train: 0.780088 val: 0.742254 test: 0.761958
max validation accuracy : 0.742254 max acc epoch : 1 test accuracy : 0.761958
Epoch-1 lr: 0.005

Epoch :  2 loss training:  90.78811207413673 Time :  1004
accuracy train: 0.722413 val: 0.721127 test: 0.712437
max validation accuracy : 0.742254 max acc epoch : 1 test accuracy : 0.761958
Epoch-2 lr: 0.005

Epoch :  3 loss training:  85.60438965260983 Time :  1016
accuracy train: 0.766021 val: 0.746479 test: 0.739730
max validation accuracy : 0.746479 max acc epoch : 3 test accuracy : 0.739730
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  76.63084235787392 Time :  1027
accuracy train: 0.829791 val: 0.754930 test: 0.772651
max validation accuracy : 0.754930 max acc epoch : 4 test accuracy : 0.772651
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  74.20919635891914 Time :  1038
accuracy train: 0.830103 val: 0.773239 test: 0.766179
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.766179
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  69.07428604364395 Time :  1048
accuracy train: 0.855111 val: 0.769014 test: 0.767867
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.766179
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  66.36069709062576 Time :  1059
accuracy train: 0.860581 val: 0.771831 test: 0.774339
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.766179
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  62.78758059442043 Time :  1068
accuracy train: 0.891685 val: 0.764789 test: 0.767867
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.766179
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  57.94963216781616 Time :  1079
accuracy train: 0.903251 val: 0.770423 test: 0.764209
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.766179
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  54.74976119399071 Time :  1090
accuracy train: 0.913098 val: 0.769014 test: 0.761958
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.766179
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  53.637508034706116 Time :  1100
accuracy train: 0.936543 val: 0.781690 test: 0.772932
max validation accuracy : 0.781690 max acc epoch : 11 test accuracy : 0.772932
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  44.99619556218386 Time :  1109
accuracy train: 0.957174 val: 0.783099 test: 0.777715
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.777715
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  34.304686933755875 Time :  1116
accuracy train: 0.967959 val: 0.780282 test: 0.778559
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.777715
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  29.27018566429615 Time :  1127
accuracy train: 0.977337 val: 0.785915 test: 0.778559
max validation accuracy : 0.785915 max acc epoch : 14 test accuracy : 0.778559
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  26.14536752924323 Time :  1137
accuracy train: 0.983745 val: 0.781690 test: 0.775746
max validation accuracy : 0.785915 max acc epoch : 14 test accuracy : 0.778559

Epoch :  16 loss training:  22.10133338533342 Time :  1145
accuracy train: 0.986402 val: 0.791549 test: 0.778559
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.778559

Epoch :  17 loss training:  19.917728666216135 Time :  1152
accuracy train: 0.990778 val: 0.781690 test: 0.773776
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.778559

Epoch :  18 loss training:  17.298650650307536 Time :  1163
accuracy train: 0.993748 val: 0.776056 test: 0.770681
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.778559

Epoch :  19 loss training:  15.133109577000141 Time :  1174
accuracy train: 0.996561 val: 0.771831 test: 0.769555
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.778559

Epoch :  20 loss training:  13.514692690223455 Time :  1184
accuracy train: 0.997968 val: 0.780282 test: 0.768149
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.778559

Epoch :  21 loss training:  10.886247349902987 Time :  1195
accuracy train: 0.998124 val: 0.784507 test: 0.766460
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.778559

Epoch :  22 loss training:  9.657698413357139 Time :  1206
accuracy train: 0.998281 val: 0.790141 test: 0.765616
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.778559

Epoch :  23 loss training:  8.399589870590717 Time :  1217
accuracy train: 0.998906 val: 0.784507 test: 0.759145
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.778559

Epoch :  24 loss training:  7.56823956547305 Time :  1228
accuracy train: 0.999062 val: 0.773239 test: 0.754643
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.778559

Epoch :  25 loss training:  6.469983805436641 Time :  1238
accuracy train: 0.999531 val: 0.781690 test: 0.758019
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.778559

Epoch :  26 loss training:  5.929625114426017 Time :  1248
accuracy train: 0.999531 val: 0.780282 test: 0.756050
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.778559

Epoch :  27 loss training:  5.625839846208692 Time :  1259
accuracy train: 0.999531 val: 0.780282 test: 0.755205
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.778559

========================================================================================================================================================================================================
best acc epoch :  16
validation accuracy :  0.7915492957746478
test accuracy :  0.7785593697242543
last test_accuracy :  0.7552054023635341
second best val :  0.7901408450704225
second best test :  0.7785593697242543
max gap 6
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=120, tsne=False, weight_decay=1e-07)
device :  cuda:0

Epoch :  1 loss training:  100.76932680606842 Time :  1270
accuracy train: 0.773992 val: 0.746479 test: 0.767304
max validation accuracy : 0.746479 max acc epoch : 1 test accuracy : 0.767304
Epoch-1 lr: 0.005

Epoch :  2 loss training:  84.45567491650581 Time :  1281
accuracy train: 0.805408 val: 0.761972 test: 0.777153
max validation accuracy : 0.761972 max acc epoch : 2 test accuracy : 0.777153
Epoch-2 lr: 0.005

Epoch :  3 loss training:  83.75694504380226 Time :  1290
accuracy train: 0.808221 val: 0.756338 test: 0.761958
max validation accuracy : 0.761972 max acc epoch : 2 test accuracy : 0.777153
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  77.88723151385784 Time :  1301
accuracy train: 0.828071 val: 0.752113 test: 0.766460
max validation accuracy : 0.761972 max acc epoch : 2 test accuracy : 0.777153
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  74.42387099564075 Time :  1312
accuracy train: 0.809159 val: 0.767606 test: 0.753517
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.753517
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  67.87771645188332 Time :  1322
accuracy train: 0.818224 val: 0.746479 test: 0.752954
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.753517
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  64.0580033659935 Time :  1334
accuracy train: 0.825102 val: 0.757746 test: 0.753517
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.753517
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  60.26973171532154 Time :  1344
accuracy train: 0.898249 val: 0.754930 test: 0.772932
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.753517
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  56.419365391135216 Time :  1355
accuracy train: 0.898875 val: 0.749296 test: 0.772369
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.753517
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  54.7817420065403 Time :  1365
accuracy train: 0.914661 val: 0.757746 test: 0.774620
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.753517
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  54.09168437868357 Time :  1376
accuracy train: 0.933417 val: 0.774648 test: 0.779403
max validation accuracy : 0.774648 max acc epoch : 11 test accuracy : 0.779403
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  44.47562263906002 Time :  1386
accuracy train: 0.953579 val: 0.766197 test: 0.778841
max validation accuracy : 0.774648 max acc epoch : 11 test accuracy : 0.779403
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  34.21990172192454 Time :  1396
accuracy train: 0.967334 val: 0.787324 test: 0.780248
max validation accuracy : 0.787324 max acc epoch : 13 test accuracy : 0.780248
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  29.72106644511223 Time :  1405
accuracy train: 0.976243 val: 0.780282 test: 0.776590
max validation accuracy : 0.787324 max acc epoch : 13 test accuracy : 0.780248
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  27.092808056622744 Time :  1413
accuracy train: 0.982182 val: 0.781690 test: 0.773495
max validation accuracy : 0.787324 max acc epoch : 13 test accuracy : 0.780248

Epoch :  16 loss training:  22.56042567640543 Time :  1424
accuracy train: 0.984995 val: 0.795775 test: 0.776027
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.776027

Epoch :  17 loss training:  21.031503342092037 Time :  1434
accuracy train: 0.987340 val: 0.764789 test: 0.771525
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.776027

Epoch :  18 loss training:  17.488097516819835 Time :  1445
accuracy train: 0.987652 val: 0.781690 test: 0.764772
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.776027

Epoch :  19 loss training:  16.29222678951919 Time :  1457
accuracy train: 0.992185 val: 0.783099 test: 0.766742
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.776027

Epoch :  20 loss training:  14.631852127611637 Time :  1466
accuracy train: 0.993123 val: 0.790141 test: 0.765616
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.776027

Epoch :  21 loss training:  11.970318781211972 Time :  1477
accuracy train: 0.994530 val: 0.781690 test: 0.763365
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.776027

Epoch :  22 loss training:  10.72995652910322 Time :  1487
accuracy train: 0.995155 val: 0.784507 test: 0.761114
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.776027

Epoch :  23 loss training:  8.903733347542584 Time :  1497
accuracy train: 0.995936 val: 0.778873 test: 0.755487
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.776027

Epoch :  24 loss training:  7.996501546818763 Time :  1507
accuracy train: 0.997812 val: 0.776056 test: 0.760551
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.776027

Epoch :  25 loss training:  7.010882209986448 Time :  1516
accuracy train: 0.998124 val: 0.778873 test: 0.757738
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.776027

Epoch :  26 loss training:  6.502232832368463 Time :  1522
accuracy train: 0.998750 val: 0.773239 test: 0.756331
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.776027

Epoch :  27 loss training:  6.138481837697327 Time :  1533
accuracy train: 0.998750 val: 0.770423 test: 0.761396
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.776027

========================================================================================================================================================================================================
best acc epoch :  16
validation accuracy :  0.795774647887324
test accuracy :  0.7760270118176702
last test_accuracy :  0.7613956105796286
second best val :  0.7901408450704225
second best test :  0.7760270118176702
max gap 6
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=120, tsne=False, weight_decay=1e-07)
device :  cuda:0

Epoch :  1 loss training:  97.04029676318169 Time :  1544
accuracy train: 0.702407 val: 0.667606 test: 0.686832
max validation accuracy : 0.667606 max acc epoch : 1 test accuracy : 0.686832
Epoch-1 lr: 0.005

Epoch :  2 loss training:  88.13030394911766 Time :  1554
accuracy train: 0.813692 val: 0.753521 test: 0.776308
max validation accuracy : 0.753521 max acc epoch : 2 test accuracy : 0.776308
Epoch-2 lr: 0.005

Epoch :  3 loss training:  79.4410108178854 Time :  1564
accuracy train: 0.821819 val: 0.756338 test: 0.760270
max validation accuracy : 0.756338 max acc epoch : 3 test accuracy : 0.760270
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  70.90353825688362 Time :  1574
accuracy train: 0.870585 val: 0.767606 test: 0.776027
max validation accuracy : 0.767606 max acc epoch : 4 test accuracy : 0.776027
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  67.73503325879574 Time :  1585
accuracy train: 0.884339 val: 0.759155 test: 0.774057
max validation accuracy : 0.767606 max acc epoch : 4 test accuracy : 0.776027
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  59.82763001322746 Time :  1595
accuracy train: 0.899031 val: 0.766197 test: 0.778559
max validation accuracy : 0.767606 max acc epoch : 4 test accuracy : 0.776027
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  54.67108851671219 Time :  1605
accuracy train: 0.923414 val: 0.791549 test: 0.780529
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.780529
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  51.27054612338543 Time :  1615
accuracy train: 0.935136 val: 0.770423 test: 0.778559
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.780529
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  51.27770337462425 Time :  1625
accuracy train: 0.934042 val: 0.769014 test: 0.769837
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.780529
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  44.33630481362343 Time :  1635
accuracy train: 0.948109 val: 0.770423 test: 0.770118
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.780529
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  42.65954865515232 Time :  1647
accuracy train: 0.963113 val: 0.787324 test: 0.772369
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.780529
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  35.03332497924566 Time :  1658
accuracy train: 0.971866 val: 0.757746 test: 0.765616
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.780529
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  26.12477031722665 Time :  1670
accuracy train: 0.984526 val: 0.787324 test: 0.770118
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.780529
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  21.734869334846735 Time :  1682
accuracy train: 0.989528 val: 0.781690 test: 0.770962
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.780529
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  19.07824593782425 Time :  1692
accuracy train: 0.993904 val: 0.785915 test: 0.773495
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.780529

Epoch :  16 loss training:  15.346231449395418 Time :  1702
accuracy train: 0.995311 val: 0.776056 test: 0.772651
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.780529

Epoch :  17 loss training:  13.731273354962468 Time :  1712
accuracy train: 0.996874 val: 0.788732 test: 0.766460
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.780529

Epoch :  18 loss training:  11.760256296023726 Time :  1722
accuracy train: 0.997656 val: 0.787324 test: 0.761114
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.780529

========================================================================================================================================================================================================
best acc epoch :  7
validation accuracy :  0.7915492957746478
test accuracy :  0.7805289814293753
last test_accuracy :  0.7611142374788971
second best val :  0.7887323943661971
second best test :  0.7805289814293753
max gap 3
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  23 	 val_accuracy : 0.79859 	 test_accuracy : 0.75802 	 last test_accuracy : 0.74733 	 second best val : 0.79718 	 second best test : 0.76956
k :  1 	 best_acc epoch :  22 	 val_accuracy : 0.78732 	 test_accuracy : 0.76252 	 last test_accuracy : 0.75295 	 second best val : 0.78451 	 second best test : 0.76477
k :  2 	 best_acc epoch :  16 	 val_accuracy : 0.79155 	 test_accuracy : 0.76984 	 last test_accuracy : 0.75689 	 second best val : 0.78873 	 second best test : 0.77321
k :  3 	 best_acc epoch :  16 	 val_accuracy : 0.79155 	 test_accuracy : 0.77856 	 last test_accuracy : 0.75521 	 second best val : 0.79014 	 second best test : 0.77856
k :  4 	 best_acc epoch :  16 	 val_accuracy : 0.79577 	 test_accuracy : 0.77603 	 last test_accuracy : 0.76140 	 second best val : 0.79014 	 second best test : 0.77603
k :  5 	 best_acc epoch :  7 	 val_accuracy : 0.79155 	 test_accuracy : 0.78053 	 last test_accuracy : 0.76111 	 second best val : 0.78873 	 second best test : 0.78053

avg :  	 val_accuracy : 0.79272 	 test_accuracy : 0.77092 	 last_accuracy : 0.75582 	 second best val : 0.78991 	 second best test : 0.77378

std :  	 val_accuracy : 0.00358 	 test_accuracy : 0.00832 	 last_accuracy : 0.00485 	 second best val : 0.00376 	 second best test : 0.00537


date and time :  Sun Jun 13 01:45:42 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=815, tsne=False, weight_decay=1e-12)
device :  cuda:0

Epoch :  1 loss training:  90.34927010536194 Time :  12
accuracy train: 0.771178 val: 0.766197 test: 0.764209
max validation accuracy : 0.766197 max acc epoch : 1 test accuracy : 0.764209
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.2381101846695 Time :  22
accuracy train: 0.776493 val: 0.770423 test: 0.763365
max validation accuracy : 0.770423 max acc epoch : 2 test accuracy : 0.763365
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.66789609193802 Time :  33
accuracy train: 0.799156 val: 0.766197 test: 0.771806
max validation accuracy : 0.770423 max acc epoch : 2 test accuracy : 0.763365
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.71151189506054 Time :  45
accuracy train: 0.821663 val: 0.777465 test: 0.781654
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.781654
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  73.76016226410866 Time :  54
accuracy train: 0.834167 val: 0.773239 test: 0.776027
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.781654
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.96191823482513 Time :  66
accuracy train: 0.834636 val: 0.777465 test: 0.782780
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.781654
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  70.24275523424149 Time :  77
accuracy train: 0.843701 val: 0.770423 test: 0.778278
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.781654
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.43791484832764 Time :  87
accuracy train: 0.849328 val: 0.770423 test: 0.776308
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.781654
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.08218322694302 Time :  97
accuracy train: 0.850578 val: 0.771831 test: 0.772088
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.781654
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  67.13545858860016 Time :  106
accuracy train: 0.858081 val: 0.777465 test: 0.775746
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.781654
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  64.66172425448895 Time :  118
accuracy train: 0.862457 val: 0.770423 test: 0.776027
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.781654
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.45018129050732 Time :  124
accuracy train: 0.867459 val: 0.766197 test: 0.774057
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.781654
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  61.854303419589996 Time :  136
accuracy train: 0.873554 val: 0.780282 test: 0.780248
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.780248
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  60.94393427670002 Time :  146
accuracy train: 0.876368 val: 0.776056 test: 0.778278
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.780248
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  60.07437317073345 Time :  156
accuracy train: 0.881057 val: 0.778873 test: 0.777153
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.780248

Epoch :  16 loss training:  59.810549303889275 Time :  167
accuracy train: 0.886840 val: 0.778873 test: 0.775746
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.780248

Epoch :  17 loss training:  59.02933123707771 Time :  176
accuracy train: 0.888403 val: 0.778873 test: 0.777434
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.780248

Epoch :  18 loss training:  57.72374475002289 Time :  187
accuracy train: 0.890591 val: 0.771831 test: 0.775464
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.780248

Epoch :  19 loss training:  57.59858913719654 Time :  197
accuracy train: 0.895749 val: 0.777465 test: 0.775464
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.780248

Epoch :  20 loss training:  56.838618606328964 Time :  208
accuracy train: 0.899344 val: 0.769014 test: 0.774620
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.780248

Epoch :  21 loss training:  55.25841298699379 Time :  219
accuracy train: 0.897781 val: 0.776056 test: 0.776027
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.780248

Epoch :  22 loss training:  55.31122647225857 Time :  229
accuracy train: 0.903564 val: 0.773239 test: 0.773213
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.780248

Epoch :  23 loss training:  53.86847780644894 Time :  242
accuracy train: 0.906846 val: 0.771831 test: 0.774902
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.780248

Epoch :  24 loss training:  53.16098698973656 Time :  252
accuracy train: 0.909503 val: 0.773239 test: 0.775746
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.780248

========================================================================================================================================================================================================
best acc epoch :  13
validation accuracy :  0.780281690140845
test accuracy :  0.7802476083286438
last test_accuracy :  0.7757456387169387
second best val :  0.7788732394366197
second best test :  0.7802476083286438
max gap 9
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=815, tsne=False, weight_decay=1e-12)
device :  cuda:0

Epoch :  1 loss training:  90.39562794566154 Time :  264
accuracy train: 0.770241 val: 0.764789 test: 0.766179
max validation accuracy : 0.764789 max acc epoch : 1 test accuracy : 0.766179
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.278943836689 Time :  275
accuracy train: 0.775086 val: 0.764789 test: 0.762521
max validation accuracy : 0.764789 max acc epoch : 1 test accuracy : 0.766179
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.5512912273407 Time :  284
accuracy train: 0.799000 val: 0.770423 test: 0.770681
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.770681
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.63933004438877 Time :  295
accuracy train: 0.823539 val: 0.770423 test: 0.784468
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.770681
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  73.92537860572338 Time :  305
accuracy train: 0.831197 val: 0.773239 test: 0.774620
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.774620
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  73.31379893422127 Time :  316
accuracy train: 0.834636 val: 0.771831 test: 0.782499
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.774620
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  70.02429941296577 Time :  327
accuracy train: 0.841826 val: 0.770423 test: 0.778841
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.774620
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.49659770727158 Time :  337
accuracy train: 0.849484 val: 0.777465 test: 0.771525
max validation accuracy : 0.777465 max acc epoch : 8 test accuracy : 0.771525
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.05747966468334 Time :  349
accuracy train: 0.850578 val: 0.780282 test: 0.771806
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.771806
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  67.27011886239052 Time :  359
accuracy train: 0.854642 val: 0.776056 test: 0.774339
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.771806
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  64.7005393654108 Time :  369
accuracy train: 0.860269 val: 0.773239 test: 0.774057
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.771806
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.472457960248 Time :  379
accuracy train: 0.867302 val: 0.757746 test: 0.771244
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.771806
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  62.196465626358986 Time :  388
accuracy train: 0.873554 val: 0.780282 test: 0.774057
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.771806
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  60.959399819374084 Time :  401
accuracy train: 0.876680 val: 0.778873 test: 0.773495
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.771806
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  60.01229737699032 Time :  411
accuracy train: 0.881213 val: 0.780282 test: 0.774620
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.771806

Epoch :  16 loss training:  60.04436722397804 Time :  421
accuracy train: 0.883557 val: 0.777465 test: 0.773776
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.771806

Epoch :  17 loss training:  59.03176765143871 Time :  433
accuracy train: 0.885433 val: 0.773239 test: 0.774339
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.771806

Epoch :  18 loss training:  57.401298865675926 Time :  443
accuracy train: 0.890747 val: 0.763380 test: 0.776308
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.771806

Epoch :  19 loss training:  57.30266574025154 Time :  454
accuracy train: 0.894498 val: 0.771831 test: 0.773213
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.771806

Epoch :  20 loss training:  56.741097286343575 Time :  466
accuracy train: 0.897781 val: 0.763380 test: 0.776027
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.771806

========================================================================================================================================================================================================
best acc epoch :  9
validation accuracy :  0.780281690140845
test accuracy :  0.7718064153066967
last test_accuracy :  0.7760270118176702
second best val :  0.7788732394366197
second best test :  0.7718064153066967
max gap 3
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=815, tsne=False, weight_decay=1e-12)
device :  cuda:0

Epoch :  1 loss training:  90.3615303337574 Time :  477
accuracy train: 0.769147 val: 0.766197 test: 0.764772
max validation accuracy : 0.766197 max acc epoch : 1 test accuracy : 0.764772
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.27042633295059 Time :  488
accuracy train: 0.776336 val: 0.770423 test: 0.764772
max validation accuracy : 0.770423 max acc epoch : 2 test accuracy : 0.764772
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.64805555343628 Time :  500
accuracy train: 0.795249 val: 0.771831 test: 0.773213
max validation accuracy : 0.771831 max acc epoch : 3 test accuracy : 0.773213
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.6432930380106 Time :  507
accuracy train: 0.819631 val: 0.773239 test: 0.781654
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.781654
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  73.97093862295151 Time :  518
accuracy train: 0.831510 val: 0.776056 test: 0.774339
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.774339
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  73.21097508072853 Time :  528
accuracy train: 0.833229 val: 0.770423 test: 0.780248
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.774339
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  70.20059208571911 Time :  540
accuracy train: 0.841044 val: 0.769014 test: 0.777153
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.774339
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.90455569326878 Time :  550
accuracy train: 0.849484 val: 0.777465 test: 0.777997
max validation accuracy : 0.777465 max acc epoch : 8 test accuracy : 0.777997
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.21557947993279 Time :  561
accuracy train: 0.851672 val: 0.774648 test: 0.772651
max validation accuracy : 0.777465 max acc epoch : 8 test accuracy : 0.777997
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  67.20665299892426 Time :  571
accuracy train: 0.856049 val: 0.778873 test: 0.774902
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.774902
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  64.77543149888515 Time :  582
accuracy train: 0.860894 val: 0.777465 test: 0.776308
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.774902
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.54322157800198 Time :  592
accuracy train: 0.866521 val: 0.760563 test: 0.770118
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.774902
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  62.3000970184803 Time :  603
accuracy train: 0.872460 val: 0.774648 test: 0.776871
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.774902
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  61.137978464365005 Time :  614
accuracy train: 0.875586 val: 0.769014 test: 0.775464
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.774902
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  60.11007072031498 Time :  624
accuracy train: 0.879650 val: 0.773239 test: 0.779966
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.774902

Epoch :  16 loss training:  59.96538890898228 Time :  635
accuracy train: 0.884651 val: 0.771831 test: 0.775183
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.774902

Epoch :  17 loss training:  59.22722618281841 Time :  643
accuracy train: 0.888559 val: 0.777465 test: 0.774620
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.774902

Epoch :  18 loss training:  57.467412039637566 Time :  654
accuracy train: 0.889966 val: 0.770423 test: 0.776590
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.774902

Epoch :  19 loss training:  57.79349306225777 Time :  666
accuracy train: 0.892623 val: 0.769014 test: 0.776590
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.774902

Epoch :  20 loss training:  57.05459061264992 Time :  676
accuracy train: 0.898406 val: 0.767606 test: 0.777434
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.774902

Epoch :  21 loss training:  55.661895871162415 Time :  687
accuracy train: 0.899656 val: 0.773239 test: 0.776027
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.774902

========================================================================================================================================================================================================
best acc epoch :  10
validation accuracy :  0.7788732394366197
test accuracy :  0.7749015194147439
last test_accuracy :  0.7760270118176702
second best val :  0.7774647887323943
second best test :  0.7779966235227912
max gap 3
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=815, tsne=False, weight_decay=1e-12)
device :  cuda:0

Epoch :  1 loss training:  90.33817547559738 Time :  699
accuracy train: 0.770241 val: 0.767606 test: 0.765616
max validation accuracy : 0.767606 max acc epoch : 1 test accuracy : 0.765616
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.38410103321075 Time :  708
accuracy train: 0.773367 val: 0.770423 test: 0.759989
max validation accuracy : 0.770423 max acc epoch : 2 test accuracy : 0.759989
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.55408591032028 Time :  720
accuracy train: 0.794936 val: 0.763380 test: 0.768149
max validation accuracy : 0.770423 max acc epoch : 2 test accuracy : 0.759989
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.60905085504055 Time :  731
accuracy train: 0.819944 val: 0.770423 test: 0.782780
max validation accuracy : 0.770423 max acc epoch : 2 test accuracy : 0.759989
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  73.96754954755306 Time :  741
accuracy train: 0.831666 val: 0.777465 test: 0.776871
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.776871
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  73.29395934939384 Time :  752
accuracy train: 0.834480 val: 0.764789 test: 0.779122
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.776871
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  70.51222825050354 Time :  761
accuracy train: 0.840888 val: 0.766197 test: 0.779966
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.776871
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.7394489645958 Time :  772
accuracy train: 0.848546 val: 0.784507 test: 0.774620
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.774620
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.31497773528099 Time :  783
accuracy train: 0.849328 val: 0.776056 test: 0.775183
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.774620
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  67.10247990489006 Time :  793
accuracy train: 0.856987 val: 0.771831 test: 0.778559
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.774620
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  65.1878781169653 Time :  804
accuracy train: 0.862301 val: 0.764789 test: 0.776590
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.774620
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.71995201706886 Time :  814
accuracy train: 0.865739 val: 0.757746 test: 0.772932
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.774620
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  62.25915440917015 Time :  823
accuracy train: 0.875586 val: 0.776056 test: 0.775464
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.774620
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  61.06593677401543 Time :  830
accuracy train: 0.876055 val: 0.771831 test: 0.776027
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.774620
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  60.54064114391804 Time :  839
accuracy train: 0.881525 val: 0.777465 test: 0.776871
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.774620

Epoch :  16 loss training:  60.25847928225994 Time :  850
accuracy train: 0.886058 val: 0.780282 test: 0.774902
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.774620

Epoch :  17 loss training:  59.39415128529072 Time :  860
accuracy train: 0.886996 val: 0.778873 test: 0.774902
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.774620

Epoch :  18 loss training:  58.09973096847534 Time :  870
accuracy train: 0.891060 val: 0.773239 test: 0.774339
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.774620

Epoch :  19 loss training:  57.93603438138962 Time :  881
accuracy train: 0.894967 val: 0.777465 test: 0.776590
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.774620

========================================================================================================================================================================================================
best acc epoch :  8
validation accuracy :  0.7845070422535211
test accuracy :  0.7746201463140123
last test_accuracy :  0.7765897580191333
second best val :  0.780281690140845
second best test :  0.7746201463140123
max gap 3
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=815, tsne=False, weight_decay=1e-12)
device :  cuda:0

Epoch :  1 loss training:  90.36678117513657 Time :  894
accuracy train: 0.769147 val: 0.769014 test: 0.764209
max validation accuracy : 0.769014 max acc epoch : 1 test accuracy : 0.764209
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.25859948992729 Time :  903
accuracy train: 0.775399 val: 0.771831 test: 0.764491
max validation accuracy : 0.771831 max acc epoch : 2 test accuracy : 0.764491
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.58735805749893 Time :  914
accuracy train: 0.793998 val: 0.770423 test: 0.770400
max validation accuracy : 0.771831 max acc epoch : 2 test accuracy : 0.764491
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.6343092918396 Time :  925
accuracy train: 0.822132 val: 0.780282 test: 0.781654
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.781654
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  73.98186409473419 Time :  935
accuracy train: 0.831822 val: 0.784507 test: 0.778278
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.778278
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.94076678156853 Time :  947
accuracy train: 0.834480 val: 0.777465 test: 0.780529
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.778278
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  70.10257214307785 Time :  957
accuracy train: 0.842451 val: 0.776056 test: 0.778278
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.778278
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.64778017997742 Time :  967
accuracy train: 0.848859 val: 0.778873 test: 0.774902
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.778278
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.10920570790768 Time :  977
accuracy train: 0.849328 val: 0.777465 test: 0.772651
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.778278
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  67.0187646150589 Time :  989
accuracy train: 0.857924 val: 0.774648 test: 0.774339
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.778278
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  64.7565494030714 Time :  1000
accuracy train: 0.863239 val: 0.774648 test: 0.773776
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.778278
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.25651353597641 Time :  1010
accuracy train: 0.868709 val: 0.763380 test: 0.769837
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.778278
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  62.15589028596878 Time :  1020
accuracy train: 0.876837 val: 0.780282 test: 0.775464
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.778278
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  61.068019062280655 Time :  1030
accuracy train: 0.877305 val: 0.774648 test: 0.772651
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.778278
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  60.2118813842535 Time :  1041
accuracy train: 0.882463 val: 0.777465 test: 0.774057
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.778278

Epoch :  16 loss training:  59.77140451967716 Time :  1051
accuracy train: 0.886371 val: 0.773239 test: 0.773213
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.778278

========================================================================================================================================================================================================
best acc epoch :  5
validation accuracy :  0.7845070422535211
test accuracy :  0.7782779966235228
last test_accuracy :  0.7732132808103546
second best val :  0.780281690140845
second best test :  0.7816544738323016
max gap 2
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=815, tsne=False, weight_decay=1e-12)
device :  cuda:0

Epoch :  1 loss training:  90.38563627004623 Time :  1062
accuracy train: 0.772429 val: 0.761972 test: 0.764491
max validation accuracy : 0.761972 max acc epoch : 1 test accuracy : 0.764491
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.29999911785126 Time :  1072
accuracy train: 0.775711 val: 0.769014 test: 0.763084
max validation accuracy : 0.769014 max acc epoch : 2 test accuracy : 0.763084
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.59533497691154 Time :  1082
accuracy train: 0.794780 val: 0.759155 test: 0.770400
max validation accuracy : 0.769014 max acc epoch : 2 test accuracy : 0.763084
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.58746030926704 Time :  1093
accuracy train: 0.821194 val: 0.777465 test: 0.780810
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.780810
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  73.94416646659374 Time :  1102
accuracy train: 0.832135 val: 0.773239 test: 0.774339
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.780810
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  73.24105578660965 Time :  1113
accuracy train: 0.835730 val: 0.776056 test: 0.779966
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.780810
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  70.20498609542847 Time :  1123
accuracy train: 0.841044 val: 0.776056 test: 0.782780
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.780810
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.66406208276749 Time :  1133
accuracy train: 0.848703 val: 0.777465 test: 0.776871
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.780810
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.22506630420685 Time :  1143
accuracy train: 0.851204 val: 0.771831 test: 0.773495
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.780810
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  67.04442803561687 Time :  1153
accuracy train: 0.856674 val: 0.774648 test: 0.776871
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.780810
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  64.86745369434357 Time :  1162
accuracy train: 0.861363 val: 0.770423 test: 0.776590
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.780810
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.51590196788311 Time :  1169
accuracy train: 0.867771 val: 0.757746 test: 0.772369
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.780810
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  62.139767199754715 Time :  1178
accuracy train: 0.875274 val: 0.776056 test: 0.775464
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.780810
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  60.99744412302971 Time :  1187
accuracy train: 0.876680 val: 0.771831 test: 0.775464
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.780810
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  60.24008950591087 Time :  1198
accuracy train: 0.881994 val: 0.776056 test: 0.776027
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.780810

========================================================================================================================================================================================================
best acc epoch :  4
validation accuracy :  0.7774647887323943
test accuracy :  0.7808103545301069
last test_accuracy :  0.7760270118176702
second best val :  0.776056338028169
second best test :  0.7808103545301069
max gap 2
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  13 	 val_accuracy : 0.78028 	 test_accuracy : 0.78025 	 last test_accuracy : 0.77575 	 second best val : 0.77887 	 second best test : 0.78025
k :  1 	 best_acc epoch :  9 	 val_accuracy : 0.78028 	 test_accuracy : 0.77181 	 last test_accuracy : 0.77603 	 second best val : 0.77887 	 second best test : 0.77181
k :  2 	 best_acc epoch :  10 	 val_accuracy : 0.77887 	 test_accuracy : 0.77490 	 last test_accuracy : 0.77603 	 second best val : 0.77746 	 second best test : 0.77800
k :  3 	 best_acc epoch :  8 	 val_accuracy : 0.78451 	 test_accuracy : 0.77462 	 last test_accuracy : 0.77659 	 second best val : 0.78028 	 second best test : 0.77462
k :  4 	 best_acc epoch :  5 	 val_accuracy : 0.78451 	 test_accuracy : 0.77828 	 last test_accuracy : 0.77321 	 second best val : 0.78028 	 second best test : 0.78165
k :  5 	 best_acc epoch :  4 	 val_accuracy : 0.77746 	 test_accuracy : 0.78081 	 last test_accuracy : 0.77603 	 second best val : 0.77606 	 second best test : 0.78081

avg :  	 val_accuracy : 0.78099 	 test_accuracy : 0.77678 	 last_accuracy : 0.77560 	 second best val : 0.77864 	 second best test : 0.77786

std :  	 val_accuracy : 0.00267 	 test_accuracy : 0.00325 	 last_accuracy : 0.00110 	 second best val : 0.00150 	 second best test : 0.00356


date and time :  Sun Jun 13 02:05:45 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=412, tsne=False, weight_decay=1e-12)
device :  cuda:0

Epoch :  1 loss training:  102.13754856586456 Time :  12
accuracy train: 0.751172 val: 0.715493 test: 0.736635
max validation accuracy : 0.715493 max acc epoch : 1 test accuracy : 0.736635
Epoch-1 lr: 0.005

Epoch :  2 loss training:  90.46855261921883 Time :  22
accuracy train: 0.786027 val: 0.714085 test: 0.751548
max validation accuracy : 0.715493 max acc epoch : 1 test accuracy : 0.736635
Epoch-2 lr: 0.005

Epoch :  3 loss training:  84.25675004720688 Time :  33
accuracy train: 0.812598 val: 0.733803 test: 0.772088
max validation accuracy : 0.733803 max acc epoch : 3 test accuracy : 0.772088
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  74.71228209137917 Time :  43
accuracy train: 0.844483 val: 0.743662 test: 0.774057
max validation accuracy : 0.743662 max acc epoch : 4 test accuracy : 0.774057
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  69.99812887609005 Time :  53
accuracy train: 0.852610 val: 0.739437 test: 0.771525
max validation accuracy : 0.743662 max acc epoch : 4 test accuracy : 0.774057
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  68.04076306521893 Time :  64
accuracy train: 0.880744 val: 0.749296 test: 0.772088
max validation accuracy : 0.749296 max acc epoch : 6 test accuracy : 0.772088
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  58.33199414610863 Time :  74
accuracy train: 0.905439 val: 0.752113 test: 0.773213
max validation accuracy : 0.752113 max acc epoch : 7 test accuracy : 0.773213
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  55.07959921658039 Time :  84
accuracy train: 0.923570 val: 0.742254 test: 0.770681
max validation accuracy : 0.752113 max acc epoch : 7 test accuracy : 0.773213
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  51.28234238922596 Time :  94
accuracy train: 0.934042 val: 0.754930 test: 0.770118
max validation accuracy : 0.754930 max acc epoch : 9 test accuracy : 0.770118
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  47.521392568945885 Time :  104
accuracy train: 0.946546 val: 0.746479 test: 0.773213
max validation accuracy : 0.754930 max acc epoch : 9 test accuracy : 0.770118
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  43.95103296637535 Time :  115
accuracy train: 0.962801 val: 0.752113 test: 0.773495
max validation accuracy : 0.754930 max acc epoch : 9 test accuracy : 0.770118
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  35.081541664898396 Time :  126
accuracy train: 0.982182 val: 0.740845 test: 0.771525
max validation accuracy : 0.754930 max acc epoch : 9 test accuracy : 0.770118
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  27.797246262431145 Time :  138
accuracy train: 0.987027 val: 0.739437 test: 0.768149
max validation accuracy : 0.754930 max acc epoch : 9 test accuracy : 0.770118
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  22.424629863351583 Time :  148
accuracy train: 0.990309 val: 0.736620 test: 0.766460
max validation accuracy : 0.754930 max acc epoch : 9 test accuracy : 0.770118
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  20.190449435263872 Time :  157
accuracy train: 0.992029 val: 0.739437 test: 0.767867
max validation accuracy : 0.754930 max acc epoch : 9 test accuracy : 0.770118

Epoch :  16 loss training:  17.97162514925003 Time :  167
accuracy train: 0.994373 val: 0.750704 test: 0.763647
max validation accuracy : 0.754930 max acc epoch : 9 test accuracy : 0.770118

Epoch :  17 loss training:  15.215011268854141 Time :  177
accuracy train: 0.995155 val: 0.740845 test: 0.766460
max validation accuracy : 0.754930 max acc epoch : 9 test accuracy : 0.770118

Epoch :  18 loss training:  14.36128992587328 Time :  189
accuracy train: 0.996718 val: 0.738028 test: 0.761677
max validation accuracy : 0.754930 max acc epoch : 9 test accuracy : 0.770118

Epoch :  19 loss training:  12.189995780587196 Time :  200
accuracy train: 0.997343 val: 0.739437 test: 0.766179
max validation accuracy : 0.754930 max acc epoch : 9 test accuracy : 0.770118

Epoch :  20 loss training:  11.444777031429112 Time :  206
accuracy train: 0.996249 val: 0.739437 test: 0.764209
max validation accuracy : 0.754930 max acc epoch : 9 test accuracy : 0.770118

========================================================================================================================================================================================================
best acc epoch :  9
validation accuracy :  0.7549295774647887
test accuracy :  0.7701181767023073
last test_accuracy :  0.7642093415869443
second best val :  0.752112676056338
second best test :  0.7732132808103546
max gap 2
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=412, tsne=False, weight_decay=1e-12)
device :  cuda:0

Epoch :  1 loss training:  100.88693265616894 Time :  217
accuracy train: 0.760081 val: 0.722535 test: 0.748171
max validation accuracy : 0.722535 max acc epoch : 1 test accuracy : 0.748171
Epoch-1 lr: 0.005

Epoch :  2 loss training:  84.37916877865791 Time :  226
accuracy train: 0.805564 val: 0.738028 test: 0.768430
max validation accuracy : 0.738028 max acc epoch : 2 test accuracy : 0.768430
Epoch-2 lr: 0.005

Epoch :  3 loss training:  82.59228631854057 Time :  237
accuracy train: 0.805095 val: 0.729577 test: 0.770118
max validation accuracy : 0.738028 max acc epoch : 2 test accuracy : 0.768430
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  73.45696038007736 Time :  247
accuracy train: 0.840731 val: 0.740845 test: 0.762240
max validation accuracy : 0.740845 max acc epoch : 4 test accuracy : 0.762240
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  69.08016812801361 Time :  258
accuracy train: 0.856049 val: 0.749296 test: 0.769837
max validation accuracy : 0.749296 max acc epoch : 5 test accuracy : 0.769837
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  67.13414818048477 Time :  267
accuracy train: 0.881369 val: 0.725352 test: 0.774057
max validation accuracy : 0.749296 max acc epoch : 5 test accuracy : 0.769837
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  58.28827624022961 Time :  277
accuracy train: 0.897312 val: 0.739437 test: 0.772369
max validation accuracy : 0.749296 max acc epoch : 5 test accuracy : 0.769837
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  56.63433900475502 Time :  287
accuracy train: 0.899656 val: 0.747887 test: 0.773495
max validation accuracy : 0.749296 max acc epoch : 5 test accuracy : 0.769837
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  53.259066477417946 Time :  297
accuracy train: 0.766958 val: 0.685915 test: 0.704277
max validation accuracy : 0.749296 max acc epoch : 5 test accuracy : 0.769837
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  50.407906621694565 Time :  308
accuracy train: 0.874179 val: 0.736620 test: 0.773776
max validation accuracy : 0.749296 max acc epoch : 5 test accuracy : 0.769837
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  47.00317931175232 Time :  317
accuracy train: 0.940919 val: 0.745070 test: 0.781654
max validation accuracy : 0.749296 max acc epoch : 5 test accuracy : 0.769837
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  37.91565877944231 Time :  328
accuracy train: 0.960456 val: 0.753521 test: 0.773213
max validation accuracy : 0.753521 max acc epoch : 12 test accuracy : 0.773213
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  29.25139893963933 Time :  339
accuracy train: 0.967334 val: 0.753521 test: 0.772369
max validation accuracy : 0.753521 max acc epoch : 12 test accuracy : 0.773213
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  24.19558374211192 Time :  349
accuracy train: 0.969209 val: 0.747887 test: 0.771244
max validation accuracy : 0.753521 max acc epoch : 12 test accuracy : 0.773213
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  21.537452023476362 Time :  360
accuracy train: 0.980932 val: 0.749296 test: 0.772651
max validation accuracy : 0.753521 max acc epoch : 12 test accuracy : 0.773213

Epoch :  16 loss training:  18.542735271155834 Time :  370
accuracy train: 0.991404 val: 0.753521 test: 0.770962
max validation accuracy : 0.753521 max acc epoch : 12 test accuracy : 0.773213

Epoch :  17 loss training:  15.81164551526308 Time :  380
accuracy train: 0.991404 val: 0.742254 test: 0.772369
max validation accuracy : 0.753521 max acc epoch : 12 test accuracy : 0.773213

Epoch :  18 loss training:  14.032395984977484 Time :  388
accuracy train: 0.992654 val: 0.746479 test: 0.770118
max validation accuracy : 0.753521 max acc epoch : 12 test accuracy : 0.773213

Epoch :  19 loss training:  12.156733136624098 Time :  399
accuracy train: 0.993279 val: 0.756338 test: 0.768149
max validation accuracy : 0.756338 max acc epoch : 19 test accuracy : 0.768149

Epoch :  20 loss training:  10.862106352113187 Time :  409
accuracy train: 0.995155 val: 0.771831 test: 0.769837
max validation accuracy : 0.771831 max acc epoch : 20 test accuracy : 0.769837

Epoch :  21 loss training:  9.42850324511528 Time :  421
accuracy train: 0.996718 val: 0.757746 test: 0.769837
max validation accuracy : 0.771831 max acc epoch : 20 test accuracy : 0.769837

Epoch :  22 loss training:  7.521833963692188 Time :  431
accuracy train: 0.990622 val: 0.742254 test: 0.761958
max validation accuracy : 0.771831 max acc epoch : 20 test accuracy : 0.769837

Epoch :  23 loss training:  6.890609934460372 Time :  441
accuracy train: 0.996874 val: 0.735211 test: 0.763928
max validation accuracy : 0.771831 max acc epoch : 20 test accuracy : 0.769837

Epoch :  24 loss training:  6.6831990191712976 Time :  451
accuracy train: 0.996874 val: 0.752113 test: 0.764491
max validation accuracy : 0.771831 max acc epoch : 20 test accuracy : 0.769837

Epoch :  25 loss training:  5.3289143913425505 Time :  460
accuracy train: 0.997812 val: 0.759155 test: 0.765053
max validation accuracy : 0.771831 max acc epoch : 20 test accuracy : 0.769837

Epoch :  26 loss training:  4.6795985924545676 Time :  471
accuracy train: 0.997812 val: 0.753521 test: 0.763084
max validation accuracy : 0.771831 max acc epoch : 20 test accuracy : 0.769837

Epoch :  27 loss training:  4.639553739223629 Time :  481
accuracy train: 0.998593 val: 0.757746 test: 0.762521
max validation accuracy : 0.771831 max acc epoch : 20 test accuracy : 0.769837

Epoch :  28 loss training:  3.8167020003311336 Time :  492
accuracy train: 0.997812 val: 0.747887 test: 0.762240
max validation accuracy : 0.771831 max acc epoch : 20 test accuracy : 0.769837

Epoch :  29 loss training:  3.813076529535465 Time :  502
accuracy train: 0.997968 val: 0.747887 test: 0.761958
max validation accuracy : 0.771831 max acc epoch : 20 test accuracy : 0.769837

Epoch :  30 loss training:  3.5665761718992144 Time :  512
accuracy train: 0.998750 val: 0.745070 test: 0.763647
max validation accuracy : 0.771831 max acc epoch : 20 test accuracy : 0.769837

Epoch :  31 loss training:  2.9182609932031482 Time :  523
accuracy train: 0.998437 val: 0.749296 test: 0.763084
max validation accuracy : 0.771831 max acc epoch : 20 test accuracy : 0.769837

========================================================================================================================================================================================================
best acc epoch :  20
validation accuracy :  0.7718309859154929
test accuracy :  0.7698368036015757
last test_accuracy :  0.7630838491840181
second best val :  0.7591549295774648
second best test :  0.7698368036015757
max gap 7
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=412, tsne=False, weight_decay=1e-12)
device :  cuda:0

Epoch :  1 loss training:  104.84797024726868 Time :  534
accuracy train: 0.765708 val: 0.711268 test: 0.743669
max validation accuracy : 0.711268 max acc epoch : 1 test accuracy : 0.743669
Epoch-1 lr: 0.005

Epoch :  2 loss training:  87.44618672132492 Time :  545
accuracy train: 0.792123 val: 0.726761 test: 0.767867
max validation accuracy : 0.726761 max acc epoch : 2 test accuracy : 0.767867
Epoch-2 lr: 0.005

Epoch :  3 loss training:  89.63177877664566 Time :  555
accuracy train: 0.521569 val: 0.515493 test: 0.518008
max validation accuracy : 0.726761 max acc epoch : 2 test accuracy : 0.767867
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  83.82279565930367 Time :  565
accuracy train: 0.789153 val: 0.738028 test: 0.761396
max validation accuracy : 0.738028 max acc epoch : 4 test accuracy : 0.761396
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  76.19251942634583 Time :  575
accuracy train: 0.822132 val: 0.728169 test: 0.774902
max validation accuracy : 0.738028 max acc epoch : 4 test accuracy : 0.761396
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  75.78803241252899 Time :  586
accuracy train: 0.826039 val: 0.732394 test: 0.775464
max validation accuracy : 0.738028 max acc epoch : 4 test accuracy : 0.761396
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  69.64621369540691 Time :  596
accuracy train: 0.844483 val: 0.723944 test: 0.777715
max validation accuracy : 0.738028 max acc epoch : 4 test accuracy : 0.761396
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  69.23352834582329 Time :  607
accuracy train: 0.852766 val: 0.738028 test: 0.777715
max validation accuracy : 0.738028 max acc epoch : 4 test accuracy : 0.761396
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  67.39783895015717 Time :  618
accuracy train: 0.848078 val: 0.738028 test: 0.773776
max validation accuracy : 0.738028 max acc epoch : 4 test accuracy : 0.761396
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  66.27521075308323 Time :  627
accuracy train: 0.870897 val: 0.739437 test: 0.777715
max validation accuracy : 0.739437 max acc epoch : 10 test accuracy : 0.777715
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  63.97795781493187 Time :  638
accuracy train: 0.896218 val: 0.735211 test: 0.780529
max validation accuracy : 0.739437 max acc epoch : 10 test accuracy : 0.777715
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  54.38158382475376 Time :  649
accuracy train: 0.924820 val: 0.730986 test: 0.780248
max validation accuracy : 0.739437 max acc epoch : 10 test accuracy : 0.777715
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  46.09351644665003 Time :  660
accuracy train: 0.936855 val: 0.742254 test: 0.780810
max validation accuracy : 0.742254 max acc epoch : 13 test accuracy : 0.780810
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  40.33475946635008 Time :  671
accuracy train: 0.944358 val: 0.738028 test: 0.783624
max validation accuracy : 0.742254 max acc epoch : 13 test accuracy : 0.780810
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  36.38718143105507 Time :  681
accuracy train: 0.957174 val: 0.738028 test: 0.781373
max validation accuracy : 0.742254 max acc epoch : 13 test accuracy : 0.780810

Epoch :  16 loss training:  32.50936456769705 Time :  693
accuracy train: 0.961394 val: 0.740845 test: 0.777715
max validation accuracy : 0.742254 max acc epoch : 13 test accuracy : 0.780810

Epoch :  17 loss training:  29.56650634109974 Time :  704
accuracy train: 0.970147 val: 0.742254 test: 0.777997
max validation accuracy : 0.742254 max acc epoch : 13 test accuracy : 0.780810

Epoch :  18 loss training:  25.047831308096647 Time :  714
accuracy train: 0.977806 val: 0.745070 test: 0.774057
max validation accuracy : 0.745070 max acc epoch : 18 test accuracy : 0.774057

Epoch :  19 loss training:  23.725910883396864 Time :  724
accuracy train: 0.980775 val: 0.739437 test: 0.771525
max validation accuracy : 0.745070 max acc epoch : 18 test accuracy : 0.774057

Epoch :  20 loss training:  21.19697303697467 Time :  730
accuracy train: 0.985308 val: 0.753521 test: 0.775183
max validation accuracy : 0.753521 max acc epoch : 20 test accuracy : 0.775183

Epoch :  21 loss training:  18.879484992474318 Time :  740
accuracy train: 0.987965 val: 0.746479 test: 0.770118
max validation accuracy : 0.753521 max acc epoch : 20 test accuracy : 0.775183

Epoch :  22 loss training:  15.692834725603461 Time :  750
accuracy train: 0.989841 val: 0.742254 test: 0.772088
max validation accuracy : 0.753521 max acc epoch : 20 test accuracy : 0.775183

Epoch :  23 loss training:  13.953745959326625 Time :  762
accuracy train: 0.992967 val: 0.743662 test: 0.770681
max validation accuracy : 0.753521 max acc epoch : 20 test accuracy : 0.775183

Epoch :  24 loss training:  13.752867374569178 Time :  770
accuracy train: 0.993904 val: 0.733803 test: 0.767867
max validation accuracy : 0.753521 max acc epoch : 20 test accuracy : 0.775183

Epoch :  25 loss training:  11.250661831349134 Time :  781
accuracy train: 0.996249 val: 0.738028 test: 0.763647
max validation accuracy : 0.753521 max acc epoch : 20 test accuracy : 0.775183

Epoch :  26 loss training:  9.685770313255489 Time :  791
accuracy train: 0.996405 val: 0.728169 test: 0.765898
max validation accuracy : 0.753521 max acc epoch : 20 test accuracy : 0.775183

Epoch :  27 loss training:  9.385304127819836 Time :  801
accuracy train: 0.997187 val: 0.729577 test: 0.763647
max validation accuracy : 0.753521 max acc epoch : 20 test accuracy : 0.775183

Epoch :  28 loss training:  7.952052596025169 Time :  808
accuracy train: 0.998281 val: 0.732394 test: 0.763365
max validation accuracy : 0.753521 max acc epoch : 20 test accuracy : 0.775183

Epoch :  29 loss training:  7.401044229976833 Time :  820
accuracy train: 0.998593 val: 0.730986 test: 0.761958
max validation accuracy : 0.753521 max acc epoch : 20 test accuracy : 0.775183

Epoch :  30 loss training:  6.2663486413657665 Time :  831
accuracy train: 0.999062 val: 0.743662 test: 0.752392
max validation accuracy : 0.753521 max acc epoch : 20 test accuracy : 0.775183

Epoch :  31 loss training:  5.79252404300496 Time :  841
accuracy train: 0.999375 val: 0.736620 test: 0.758863
max validation accuracy : 0.753521 max acc epoch : 20 test accuracy : 0.775183

========================================================================================================================================================================================================
best acc epoch :  20
validation accuracy :  0.7535211267605634
test accuracy :  0.7751828925154756
last test_accuracy :  0.7588632526730444
second best val :  0.7464788732394366
second best test :  0.7751828925154756
max gap 6
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=412, tsne=False, weight_decay=1e-12)
device :  cuda:0

Epoch :  1 loss training:  100.94307780265808 Time :  853
accuracy train: 0.773367 val: 0.730986 test: 0.758863
max validation accuracy : 0.730986 max acc epoch : 1 test accuracy : 0.758863
Epoch-1 lr: 0.005

Epoch :  2 loss training:  89.71866431832314 Time :  862
accuracy train: 0.777899 val: 0.725352 test: 0.757175
max validation accuracy : 0.730986 max acc epoch : 1 test accuracy : 0.758863
Epoch-2 lr: 0.005

Epoch :  3 loss training:  84.72641235589981 Time :  874
accuracy train: 0.685996 val: 0.659155 test: 0.664041
max validation accuracy : 0.730986 max acc epoch : 1 test accuracy : 0.758863
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  79.81261134147644 Time :  884
accuracy train: 0.832760 val: 0.732394 test: 0.776590
max validation accuracy : 0.732394 max acc epoch : 4 test accuracy : 0.776590
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  73.79512323439121 Time :  895
accuracy train: 0.842607 val: 0.739437 test: 0.769837
max validation accuracy : 0.739437 max acc epoch : 5 test accuracy : 0.769837
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  76.10017359256744 Time :  906
accuracy train: 0.783370 val: 0.723944 test: 0.725661
max validation accuracy : 0.739437 max acc epoch : 5 test accuracy : 0.769837
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  69.67341114580631 Time :  916
accuracy train: 0.865114 val: 0.750704 test: 0.773495
max validation accuracy : 0.750704 max acc epoch : 7 test accuracy : 0.773495
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  67.67649121582508 Time :  926
accuracy train: 0.872773 val: 0.749296 test: 0.774339
max validation accuracy : 0.750704 max acc epoch : 7 test accuracy : 0.773495
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  66.37417379021645 Time :  936
accuracy train: 0.883557 val: 0.735211 test: 0.778278
max validation accuracy : 0.750704 max acc epoch : 7 test accuracy : 0.773495
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  64.79493147134781 Time :  948
accuracy train: 0.888872 val: 0.735211 test: 0.783343
max validation accuracy : 0.750704 max acc epoch : 7 test accuracy : 0.773495
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  61.727310463786125 Time :  958
accuracy train: 0.912473 val: 0.732394 test: 0.784750
max validation accuracy : 0.750704 max acc epoch : 7 test accuracy : 0.773495
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  52.790268227458 Time :  969
accuracy train: 0.938262 val: 0.743662 test: 0.788407
max validation accuracy : 0.750704 max acc epoch : 7 test accuracy : 0.773495
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  42.91921679675579 Time :  980
accuracy train: 0.951235 val: 0.735211 test: 0.783343
max validation accuracy : 0.750704 max acc epoch : 7 test accuracy : 0.773495
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  37.036693058907986 Time :  990
accuracy train: 0.959987 val: 0.740845 test: 0.785312
max validation accuracy : 0.750704 max acc epoch : 7 test accuracy : 0.773495
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  32.99609610438347 Time :  1001
accuracy train: 0.967177 val: 0.747887 test: 0.778278
max validation accuracy : 0.750704 max acc epoch : 7 test accuracy : 0.773495

Epoch :  16 loss training:  28.84161389991641 Time :  1012
accuracy train: 0.974992 val: 0.750704 test: 0.783624
max validation accuracy : 0.750704 max acc epoch : 7 test accuracy : 0.773495

Epoch :  17 loss training:  25.905269511044025 Time :  1022
accuracy train: 0.980932 val: 0.740845 test: 0.779685
max validation accuracy : 0.750704 max acc epoch : 7 test accuracy : 0.773495

Epoch :  18 loss training:  21.72333844192326 Time :  1034
accuracy train: 0.985152 val: 0.740845 test: 0.774902
max validation accuracy : 0.750704 max acc epoch : 7 test accuracy : 0.773495

========================================================================================================================================================================================================
best acc epoch :  7
validation accuracy :  0.7507042253521127
test accuracy :  0.7734946539110861
last test_accuracy :  0.7749015194147439
second best val :  0.7492957746478873
second best test :  0.7734946539110861
max gap 3
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=412, tsne=False, weight_decay=1e-12)
device :  cuda:0

Epoch :  1 loss training:  103.24225828051567 Time :  1044
accuracy train: 0.764458 val: 0.735211 test: 0.748452
max validation accuracy : 0.735211 max acc epoch : 1 test accuracy : 0.748452
Epoch-1 lr: 0.005

Epoch :  2 loss training:  86.80153849720955 Time :  1056
accuracy train: 0.802282 val: 0.739437 test: 0.772369
max validation accuracy : 0.739437 max acc epoch : 2 test accuracy : 0.772369
Epoch-2 lr: 0.005

Epoch :  3 loss training:  83.6092212498188 Time :  1065
accuracy train: 0.806971 val: 0.725352 test: 0.766742
max validation accuracy : 0.739437 max acc epoch : 2 test accuracy : 0.772369
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  73.34557363390923 Time :  1077
accuracy train: 0.851829 val: 0.749296 test: 0.777434
max validation accuracy : 0.749296 max acc epoch : 4 test accuracy : 0.777434
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  69.38757951557636 Time :  1088
accuracy train: 0.870897 val: 0.757746 test: 0.774902
max validation accuracy : 0.757746 max acc epoch : 5 test accuracy : 0.774902
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  66.47731953859329 Time :  1097
accuracy train: 0.882620 val: 0.735211 test: 0.771525
max validation accuracy : 0.757746 max acc epoch : 5 test accuracy : 0.774902
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  57.88105642795563 Time :  1108
accuracy train: 0.893092 val: 0.728169 test: 0.768430
max validation accuracy : 0.757746 max acc epoch : 5 test accuracy : 0.774902
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  55.64815731346607 Time :  1118
accuracy train: 0.919819 val: 0.746479 test: 0.772932
max validation accuracy : 0.757746 max acc epoch : 5 test accuracy : 0.774902
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  52.22820104658604 Time :  1129
accuracy train: 0.936699 val: 0.738028 test: 0.772088
max validation accuracy : 0.757746 max acc epoch : 5 test accuracy : 0.774902
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  48.60564924031496 Time :  1138
accuracy train: 0.945452 val: 0.740845 test: 0.776871
max validation accuracy : 0.757746 max acc epoch : 5 test accuracy : 0.774902
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  45.20797377079725 Time :  1147
accuracy train: 0.961707 val: 0.740845 test: 0.778278
max validation accuracy : 0.757746 max acc epoch : 5 test accuracy : 0.774902
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  36.78661947697401 Time :  1154
accuracy train: 0.979681 val: 0.760563 test: 0.772932
max validation accuracy : 0.760563 max acc epoch : 12 test accuracy : 0.772932
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  27.979972317814827 Time :  1165
accuracy train: 0.989059 val: 0.746479 test: 0.768711
max validation accuracy : 0.760563 max acc epoch : 12 test accuracy : 0.772932
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  22.831762976944447 Time :  1174
accuracy train: 0.991091 val: 0.749296 test: 0.767304
max validation accuracy : 0.760563 max acc epoch : 12 test accuracy : 0.772932
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  19.318816129118204 Time :  1185
accuracy train: 0.993435 val: 0.739437 test: 0.766742
max validation accuracy : 0.760563 max acc epoch : 12 test accuracy : 0.772932

Epoch :  16 loss training:  17.355700496584177 Time :  1196
accuracy train: 0.996405 val: 0.756338 test: 0.764491
max validation accuracy : 0.760563 max acc epoch : 12 test accuracy : 0.772932

Epoch :  17 loss training:  15.085044987499714 Time :  1206
accuracy train: 0.997030 val: 0.747887 test: 0.764209
max validation accuracy : 0.760563 max acc epoch : 12 test accuracy : 0.772932

Epoch :  18 loss training:  12.304709756746888 Time :  1217
accuracy train: 0.998437 val: 0.739437 test: 0.763647
max validation accuracy : 0.760563 max acc epoch : 12 test accuracy : 0.772932

Epoch :  19 loss training:  11.56685868743807 Time :  1228
accuracy train: 0.999219 val: 0.745070 test: 0.764772
max validation accuracy : 0.760563 max acc epoch : 12 test accuracy : 0.772932

Epoch :  20 loss training:  10.056279581971467 Time :  1239
accuracy train: 0.999062 val: 0.736620 test: 0.765335
max validation accuracy : 0.760563 max acc epoch : 12 test accuracy : 0.772932

Epoch :  21 loss training:  9.00207409914583 Time :  1250
accuracy train: 0.999375 val: 0.739437 test: 0.763084
max validation accuracy : 0.760563 max acc epoch : 12 test accuracy : 0.772932

Epoch :  22 loss training:  7.285415935330093 Time :  1260
accuracy train: 0.999375 val: 0.736620 test: 0.764491
max validation accuracy : 0.760563 max acc epoch : 12 test accuracy : 0.772932

Epoch :  23 loss training:  6.638261516112834 Time :  1272
accuracy train: 0.999531 val: 0.736620 test: 0.757175
max validation accuracy : 0.760563 max acc epoch : 12 test accuracy : 0.772932

========================================================================================================================================================================================================
best acc epoch :  12
validation accuracy :  0.7605633802816901
test accuracy :  0.772931907709623
last test_accuracy :  0.7571750140686551
second best val :  0.7577464788732394
second best test :  0.7749015194147439
max gap 7
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=412, tsne=False, weight_decay=1e-12)
device :  cuda:0

Epoch :  1 loss training:  102.6854567527771 Time :  1284
accuracy train: 0.779775 val: 0.728169 test: 0.766179
max validation accuracy : 0.728169 max acc epoch : 1 test accuracy : 0.766179
Epoch-1 lr: 0.005

Epoch :  2 loss training:  86.28414309024811 Time :  1290
accuracy train: 0.806033 val: 0.730986 test: 0.768430
max validation accuracy : 0.730986 max acc epoch : 2 test accuracy : 0.768430
Epoch-2 lr: 0.005

Epoch :  3 loss training:  80.33861169219017 Time :  1298
accuracy train: 0.821819 val: 0.730986 test: 0.770400
max validation accuracy : 0.730986 max acc epoch : 2 test accuracy : 0.768430
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  71.35444058477879 Time :  1309
accuracy train: 0.851360 val: 0.738028 test: 0.772088
max validation accuracy : 0.738028 max acc epoch : 4 test accuracy : 0.772088
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  67.14409041404724 Time :  1320
accuracy train: 0.857768 val: 0.743662 test: 0.768993
max validation accuracy : 0.743662 max acc epoch : 5 test accuracy : 0.768993
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  64.18198682367802 Time :  1329
accuracy train: 0.893560 val: 0.729577 test: 0.778841
max validation accuracy : 0.743662 max acc epoch : 5 test accuracy : 0.768993
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  55.81694221496582 Time :  1338
accuracy train: 0.912160 val: 0.730986 test: 0.777997
max validation accuracy : 0.743662 max acc epoch : 5 test accuracy : 0.768993
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  52.77668237686157 Time :  1348
accuracy train: 0.935449 val: 0.742254 test: 0.779403
max validation accuracy : 0.743662 max acc epoch : 5 test accuracy : 0.768993
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  48.44560390710831 Time :  1357
accuracy train: 0.940294 val: 0.745070 test: 0.777715
max validation accuracy : 0.745070 max acc epoch : 9 test accuracy : 0.777715
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  44.40985280275345 Time :  1364
accuracy train: 0.953892 val: 0.735211 test: 0.779966
max validation accuracy : 0.745070 max acc epoch : 9 test accuracy : 0.777715
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  41.75470492243767 Time :  1374
accuracy train: 0.968740 val: 0.745070 test: 0.781092
max validation accuracy : 0.745070 max acc epoch : 9 test accuracy : 0.777715
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  33.109911397099495 Time :  1384
accuracy train: 0.984058 val: 0.747887 test: 0.776027
max validation accuracy : 0.747887 max acc epoch : 12 test accuracy : 0.776027
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  25.534593272954226 Time :  1396
accuracy train: 0.989372 val: 0.743662 test: 0.773495
max validation accuracy : 0.747887 max acc epoch : 12 test accuracy : 0.776027
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  20.483274165540934 Time :  1407
accuracy train: 0.991872 val: 0.739437 test: 0.773495
max validation accuracy : 0.747887 max acc epoch : 12 test accuracy : 0.776027
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  17.819137390702963 Time :  1418
accuracy train: 0.993904 val: 0.752113 test: 0.771244
max validation accuracy : 0.752113 max acc epoch : 15 test accuracy : 0.771244

Epoch :  16 loss training:  15.593924317508936 Time :  1429
accuracy train: 0.995624 val: 0.730986 test: 0.770118
max validation accuracy : 0.752113 max acc epoch : 15 test accuracy : 0.771244

Epoch :  17 loss training:  13.369095727801323 Time :  1439
accuracy train: 0.997656 val: 0.745070 test: 0.770962
max validation accuracy : 0.752113 max acc epoch : 15 test accuracy : 0.771244

Epoch :  18 loss training:  11.287869069725275 Time :  1450
accuracy train: 0.998593 val: 0.747887 test: 0.767867
max validation accuracy : 0.752113 max acc epoch : 15 test accuracy : 0.771244

Epoch :  19 loss training:  9.91231601499021 Time :  1458
accuracy train: 0.998906 val: 0.752113 test: 0.767023
max validation accuracy : 0.752113 max acc epoch : 15 test accuracy : 0.771244

Epoch :  20 loss training:  9.001548330299556 Time :  1470
accuracy train: 0.999219 val: 0.736620 test: 0.771244
max validation accuracy : 0.752113 max acc epoch : 15 test accuracy : 0.771244

Epoch :  21 loss training:  8.0076770382002 Time :  1480
accuracy train: 0.999375 val: 0.736620 test: 0.771244
max validation accuracy : 0.752113 max acc epoch : 15 test accuracy : 0.771244

Epoch :  22 loss training:  6.487540000118315 Time :  1492
accuracy train: 0.999687 val: 0.733803 test: 0.768993
max validation accuracy : 0.752113 max acc epoch : 15 test accuracy : 0.771244

Epoch :  23 loss training:  6.080759776988998 Time :  1503
accuracy train: 1.000000 val: 0.738028 test: 0.769837
max validation accuracy : 0.752113 max acc epoch : 15 test accuracy : 0.771244

Epoch :  24 loss training:  6.619742170907557 Time :  1513
accuracy train: 0.999375 val: 0.735211 test: 0.764209
max validation accuracy : 0.752113 max acc epoch : 15 test accuracy : 0.771244

Epoch :  25 loss training:  7.330620368942618 Time :  1525
accuracy train: 0.998593 val: 0.743662 test: 0.762802
max validation accuracy : 0.752113 max acc epoch : 15 test accuracy : 0.771244

Epoch :  26 loss training:  4.024997538421303 Time :  1537
accuracy train: 0.999687 val: 0.733803 test: 0.767023
max validation accuracy : 0.752113 max acc epoch : 15 test accuracy : 0.771244

========================================================================================================================================================================================================
best acc epoch :  15
validation accuracy :  0.752112676056338
test accuracy :  0.7712436691052336
last test_accuracy :  0.76702307259426
second best val :  0.747887323943662
second best test :  0.7760270118176702
max gap 4
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  9 	 val_accuracy : 0.75493 	 test_accuracy : 0.77012 	 last test_accuracy : 0.76421 	 second best val : 0.75211 	 second best test : 0.77321
k :  1 	 best_acc epoch :  20 	 val_accuracy : 0.77183 	 test_accuracy : 0.76984 	 last test_accuracy : 0.76308 	 second best val : 0.75915 	 second best test : 0.76984
k :  2 	 best_acc epoch :  20 	 val_accuracy : 0.75352 	 test_accuracy : 0.77518 	 last test_accuracy : 0.75886 	 second best val : 0.74648 	 second best test : 0.77518
k :  3 	 best_acc epoch :  7 	 val_accuracy : 0.75070 	 test_accuracy : 0.77349 	 last test_accuracy : 0.77490 	 second best val : 0.74930 	 second best test : 0.77349
k :  4 	 best_acc epoch :  12 	 val_accuracy : 0.76056 	 test_accuracy : 0.77293 	 last test_accuracy : 0.75718 	 second best val : 0.75775 	 second best test : 0.77490
k :  5 	 best_acc epoch :  15 	 val_accuracy : 0.75211 	 test_accuracy : 0.77124 	 last test_accuracy : 0.76702 	 second best val : 0.74789 	 second best test : 0.77603

avg :  	 val_accuracy : 0.75728 	 test_accuracy : 0.77213 	 last_accuracy : 0.76421 	 second best val : 0.75211 	 second best test : 0.77378

std :  	 val_accuracy : 0.00721 	 test_accuracy : 0.00191 	 last_accuracy : 0.00580 	 second best val : 0.00481 	 second best test : 0.00201
