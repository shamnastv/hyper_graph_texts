date and time :  Wed Mar 17 13:26:59 2021
Namespace(batch_size=128, dataset='R8', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=1e-05)
device :  cuda:0
Counter({0: 1467, 3: 1321, 1: 1306, 2: 1251, 6: 1224, 5: 597, 7: 488, 4: 37})
HGNNModel(
  (word_embeddings): Embedding(8231, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=8, bias=True)
    (1): Linear(in_features=200, out_features=8, bias=True)
    (2): Linear(in_features=200, out_features=8, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  62.43669390678406 Time :  32
accuracy train: 0.820844 val: 0.809091 test: 0.860731
max validation accuracy : 0.809091 max acc epoch : 1 test accuracy : 0.860731

Epoch :  2 loss training:  31.433170527219772 Time :  39
accuracy train: 0.892951 val: 0.889091 test: 0.903196
max validation accuracy : 0.889091 max acc epoch : 2 test accuracy : 0.903196

Epoch :  3 loss training:  23.560948505997658 Time :  45
accuracy train: 0.907897 val: 0.903636 test: 0.912785
max validation accuracy : 0.903636 max acc epoch : 3 test accuracy : 0.912785

Epoch :  4 loss training:  18.753272626549006 Time :  51
accuracy train: 0.926076 val: 0.925455 test: 0.928767
max validation accuracy : 0.925455 max acc epoch : 4 test accuracy : 0.928767

Epoch :  5 loss training:  16.88496032357216 Time :  58
accuracy train: 0.908099 val: 0.909091 test: 0.914155
max validation accuracy : 0.925455 max acc epoch : 4 test accuracy : 0.928767

Epoch :  6 loss training:  14.524321645498276 Time :  64
accuracy train: 0.930317 val: 0.918182 test: 0.929680
max validation accuracy : 0.925455 max acc epoch : 4 test accuracy : 0.928767

Epoch :  7 loss training:  12.428882416337729 Time :  70
accuracy train: 0.926479 val: 0.912727 test: 0.919178
max validation accuracy : 0.925455 max acc epoch : 4 test accuracy : 0.928767

Epoch :  8 loss training:  12.381000868976116 Time :  75
accuracy train: 0.950313 val: 0.938182 test: 0.938356
max validation accuracy : 0.938182 max acc epoch : 8 test accuracy : 0.938356

Epoch :  9 loss training:  11.711441539227962 Time :  81
accuracy train: 0.923652 val: 0.912727 test: 0.919635
max validation accuracy : 0.938182 max acc epoch : 8 test accuracy : 0.938356

Epoch :  10 loss training:  9.385145835578442 Time :  87
accuracy train: 0.916784 val: 0.905455 test: 0.924201
max validation accuracy : 0.938182 max acc epoch : 8 test accuracy : 0.938356

Epoch :  11 loss training:  9.572678379714489 Time :  92
accuracy train: 0.960614 val: 0.934545 test: 0.943379
max validation accuracy : 0.938182 max acc epoch : 8 test accuracy : 0.938356

Epoch :  12 loss training:  7.905871922150254 Time :  97
accuracy train: 0.948091 val: 0.927273 test: 0.933333
max validation accuracy : 0.938182 max acc epoch : 8 test accuracy : 0.938356

Epoch :  13 loss training:  7.129864411428571 Time :  104
accuracy train: 0.945668 val: 0.920000 test: 0.923744
max validation accuracy : 0.938182 max acc epoch : 8 test accuracy : 0.938356

Epoch :  14 loss training:  8.467541677877307 Time :  109
accuracy train: 0.960008 val: 0.950909 test: 0.947032
max validation accuracy : 0.950909 max acc epoch : 14 test accuracy : 0.947032

Epoch :  15 loss training:  7.55987049639225 Time :  114
accuracy train: 0.940012 val: 0.912727 test: 0.924658
max validation accuracy : 0.950909 max acc epoch : 14 test accuracy : 0.947032

Epoch :  16 loss training:  6.428234588354826 Time :  119
accuracy train: 0.960816 val: 0.930909 test: 0.939726
max validation accuracy : 0.950909 max acc epoch : 14 test accuracy : 0.947032

Epoch :  17 loss training:  6.034861060790718 Time :  124
accuracy train: 0.965260 val: 0.929091 test: 0.936073
max validation accuracy : 0.950909 max acc epoch : 14 test accuracy : 0.947032

Epoch :  18 loss training:  5.437438337132335 Time :  130
accuracy train: 0.935165 val: 0.914545 test: 0.921005
max validation accuracy : 0.950909 max acc epoch : 14 test accuracy : 0.947032

Epoch :  19 loss training:  5.460842647589743 Time :  135
accuracy train: 0.957988 val: 0.927273 test: 0.934247
max validation accuracy : 0.950909 max acc epoch : 14 test accuracy : 0.947032

Epoch :  20 loss training:  4.633941040374339 Time :  141
accuracy train: 0.959200 val: 0.921818 test: 0.942009
max validation accuracy : 0.950909 max acc epoch : 14 test accuracy : 0.947032

Epoch :  21 loss training:  4.3425032971426845 Time :  145
accuracy train: 0.950919 val: 0.916364 test: 0.926941
max validation accuracy : 0.950909 max acc epoch : 14 test accuracy : 0.947032

Epoch :  22 loss training:  4.962291535921395 Time :  151
accuracy train: 0.948495 val: 0.920000 test: 0.923744
max validation accuracy : 0.950909 max acc epoch : 14 test accuracy : 0.947032

Epoch :  23 loss training:  4.924095917958766 Time :  157
accuracy train: 0.945062 val: 0.929091 test: 0.935160
max validation accuracy : 0.950909 max acc epoch : 14 test accuracy : 0.947032

Epoch :  24 loss training:  4.028616371564567 Time :  162
accuracy train: 0.943446 val: 0.912727 test: 0.927397
max validation accuracy : 0.950909 max acc epoch : 14 test accuracy : 0.947032

Epoch :  25 loss training:  4.325876338873059 Time :  167
accuracy train: 0.966269 val: 0.930909 test: 0.940183
max validation accuracy : 0.950909 max acc epoch : 14 test accuracy : 0.947032

Epoch :  26 loss training:  4.41962490323931 Time :  172
accuracy train: 0.957988 val: 0.929091 test: 0.932420
max validation accuracy : 0.950909 max acc epoch : 14 test accuracy : 0.947032

Epoch :  27 loss training:  4.753308213781565 Time :  177
accuracy train: 0.910523 val: 0.865455 test: 0.912785
max validation accuracy : 0.950909 max acc epoch : 14 test accuracy : 0.947032

Epoch :  28 loss training:  4.0758221172727644 Time :  182
accuracy train: 0.970713 val: 0.930909 test: 0.931963
max validation accuracy : 0.950909 max acc epoch : 14 test accuracy : 0.947032

Epoch :  29 loss training:  3.4827337563037872 Time :  186
accuracy train: 0.951323 val: 0.910909 test: 0.931507
max validation accuracy : 0.950909 max acc epoch : 14 test accuracy : 0.947032

Epoch :  30 loss training:  5.356509998207912 Time :  191
accuracy train: 0.959200 val: 0.921818 test: 0.931050
max validation accuracy : 0.950909 max acc epoch : 14 test accuracy : 0.947032

Epoch :  31 loss training:  3.6332144630141556 Time :  196
accuracy train: 0.967683 val: 0.927273 test: 0.938813
max validation accuracy : 0.950909 max acc epoch : 14 test accuracy : 0.947032

Epoch :  32 loss training:  3.009903858182952 Time :  201
accuracy train: 0.967077 val: 0.927273 test: 0.937900
max validation accuracy : 0.950909 max acc epoch : 14 test accuracy : 0.947032

Epoch :  33 loss training:  3.0176627575419843 Time :  206
accuracy train: 0.964452 val: 0.930909 test: 0.939726
max validation accuracy : 0.950909 max acc epoch : 14 test accuracy : 0.947032

Epoch :  34 loss training:  2.63710458856076 Time :  210
accuracy train: 0.967279 val: 0.923636 test: 0.938356
max validation accuracy : 0.950909 max acc epoch : 14 test accuracy : 0.947032

Epoch :  35 loss training:  2.4900510560255498 Time :  216
accuracy train: 0.966673 val: 0.927273 test: 0.934247
max validation accuracy : 0.950909 max acc epoch : 14 test accuracy : 0.947032

========================================================================================================================================================================================================
max acc epoch :  14
max validation accuracy :  0.9509090909090909
test accuracy :  0.9470319634703196
last test_accuracy :  0.9342465753424658
========================================================================================================================================================================================================

date and time :  Wed Mar 17 13:30:47 2021
Namespace(batch_size=128, dataset='R8', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=200, lda=True, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=1e-05)
device :  cuda:0
Counter({7: 1488, 4: 1299, 6: 1285, 2: 1260, 3: 1250, 5: 597, 1: 475, 0: 37})
HGNNModel(
  (word_embeddings): Embedding(8231, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=8, bias=True)
    (1): Linear(in_features=200, out_features=8, bias=True)
    (2): Linear(in_features=200, out_features=8, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  64.45554041862488 Time :  28
accuracy train: 0.880428 val: 0.865455 test: 0.890868
max validation accuracy : 0.865455 max acc epoch : 1 test accuracy : 0.890868

Epoch :  2 loss training:  34.97016432881355 Time :  35
accuracy train: 0.922440 val: 0.918182 test: 0.922831
max validation accuracy : 0.918182 max acc epoch : 2 test accuracy : 0.922831

Epoch :  3 loss training:  25.197089731693268 Time :  42
accuracy train: 0.940214 val: 0.934545 test: 0.933333
max validation accuracy : 0.934545 max acc epoch : 3 test accuracy : 0.933333

Epoch :  4 loss training:  20.201911881566048 Time :  49
accuracy train: 0.939204 val: 0.927273 test: 0.931963
max validation accuracy : 0.934545 max acc epoch : 3 test accuracy : 0.933333

Epoch :  5 loss training:  16.961679562926292 Time :  56
accuracy train: 0.956574 val: 0.943636 test: 0.943836
max validation accuracy : 0.943636 max acc epoch : 5 test accuracy : 0.943836

Epoch :  6 loss training:  14.971191063523293 Time :  62
accuracy train: 0.949303 val: 0.934545 test: 0.937900
max validation accuracy : 0.943636 max acc epoch : 5 test accuracy : 0.943836

Epoch :  7 loss training:  12.795815132558346 Time :  69
accuracy train: 0.958998 val: 0.945455 test: 0.947032
max validation accuracy : 0.945455 max acc epoch : 7 test accuracy : 0.947032

Epoch :  8 loss training:  11.360703945159912 Time :  75
accuracy train: 0.967885 val: 0.949091 test: 0.945662
max validation accuracy : 0.949091 max acc epoch : 8 test accuracy : 0.945662

Epoch :  9 loss training:  10.31264803186059 Time :  81
accuracy train: 0.962230 val: 0.945455 test: 0.944292
max validation accuracy : 0.949091 max acc epoch : 8 test accuracy : 0.945662

Epoch :  10 loss training:  9.236392006278038 Time :  88
accuracy train: 0.970107 val: 0.943636 test: 0.943836
max validation accuracy : 0.949091 max acc epoch : 8 test accuracy : 0.945662

Epoch :  11 loss training:  8.92410858348012 Time :  94
accuracy train: 0.966673 val: 0.936364 test: 0.943836
max validation accuracy : 0.949091 max acc epoch : 8 test accuracy : 0.945662

Epoch :  12 loss training:  8.373111767694354 Time :  101
accuracy train: 0.972733 val: 0.941818 test: 0.948402
max validation accuracy : 0.949091 max acc epoch : 8 test accuracy : 0.945662

Epoch :  13 loss training:  7.550221107900143 Time :  107
accuracy train: 0.961624 val: 0.938182 test: 0.934703
max validation accuracy : 0.949091 max acc epoch : 8 test accuracy : 0.945662

Epoch :  14 loss training:  6.5214701890945435 Time :  114
accuracy train: 0.969703 val: 0.949091 test: 0.951142
max validation accuracy : 0.949091 max acc epoch : 8 test accuracy : 0.945662

Epoch :  15 loss training:  6.524968154728413 Time :  121
accuracy train: 0.966067 val: 0.934545 test: 0.933333
max validation accuracy : 0.949091 max acc epoch : 8 test accuracy : 0.945662

Epoch :  16 loss training:  5.754392117261887 Time :  128
accuracy train: 0.957988 val: 0.936364 test: 0.933333
max validation accuracy : 0.949091 max acc epoch : 8 test accuracy : 0.945662

Epoch :  17 loss training:  5.65934962965548 Time :  135
accuracy train: 0.970107 val: 0.941818 test: 0.940639
max validation accuracy : 0.949091 max acc epoch : 8 test accuracy : 0.945662

Epoch :  18 loss training:  5.598839265294373 Time :  141
accuracy train: 0.974753 val: 0.945455 test: 0.946119
max validation accuracy : 0.949091 max acc epoch : 8 test accuracy : 0.945662

Epoch :  19 loss training:  4.9016014114022255 Time :  147
accuracy train: 0.971925 val: 0.934545 test: 0.944749
max validation accuracy : 0.949091 max acc epoch : 8 test accuracy : 0.945662

Epoch :  20 loss training:  4.403755838051438 Time :  154
accuracy train: 0.971319 val: 0.938182 test: 0.937900
max validation accuracy : 0.949091 max acc epoch : 8 test accuracy : 0.945662

Epoch :  21 loss training:  4.722214195877314 Time :  160
accuracy train: 0.970511 val: 0.945455 test: 0.941553
max validation accuracy : 0.949091 max acc epoch : 8 test accuracy : 0.945662

Epoch :  22 loss training:  5.271631967276335 Time :  167
accuracy train: 0.970713 val: 0.929091 test: 0.937443
max validation accuracy : 0.949091 max acc epoch : 8 test accuracy : 0.945662

Epoch :  23 loss training:  4.065645433962345 Time :  173
accuracy train: 0.974955 val: 0.934545 test: 0.940183
max validation accuracy : 0.949091 max acc epoch : 8 test accuracy : 0.945662

Epoch :  24 loss training:  3.427331699989736 Time :  180
accuracy train: 0.972531 val: 0.941818 test: 0.936986
max validation accuracy : 0.949091 max acc epoch : 8 test accuracy : 0.945662

Epoch :  25 loss training:  3.461617882363498 Time :  187
accuracy train: 0.980206 val: 0.952727 test: 0.946575
max validation accuracy : 0.952727 max acc epoch : 25 test accuracy : 0.946575

Epoch :  26 loss training:  3.469237877987325 Time :  193
accuracy train: 0.962230 val: 0.923636 test: 0.931963
max validation accuracy : 0.952727 max acc epoch : 25 test accuracy : 0.946575

Epoch :  27 loss training:  3.6583601562306285 Time :  200
accuracy train: 0.973541 val: 0.936364 test: 0.938356
max validation accuracy : 0.952727 max acc epoch : 25 test accuracy : 0.946575

Epoch :  28 loss training:  4.031111917458475 Time :  206
accuracy train: 0.967885 val: 0.938182 test: 0.936073
max validation accuracy : 0.952727 max acc epoch : 25 test accuracy : 0.946575

Epoch :  29 loss training:  3.81142066558823 Time :  213
accuracy train: 0.976368 val: 0.943636 test: 0.941096
max validation accuracy : 0.952727 max acc epoch : 25 test accuracy : 0.946575

Epoch :  30 loss training:  2.9598559122532606 Time :  219
accuracy train: 0.972531 val: 0.938182 test: 0.939269
max validation accuracy : 0.952727 max acc epoch : 25 test accuracy : 0.946575

Epoch :  31 loss training:  3.1306227948516607 Time :  225
accuracy train: 0.978792 val: 0.934545 test: 0.943379
max validation accuracy : 0.952727 max acc epoch : 25 test accuracy : 0.946575

Epoch :  32 loss training:  3.2286384298931807 Time :  232
accuracy train: 0.978792 val: 0.934545 test: 0.942922
max validation accuracy : 0.952727 max acc epoch : 25 test accuracy : 0.946575

Epoch :  33 loss training:  3.594171841163188 Time :  239
accuracy train: 0.980004 val: 0.945455 test: 0.950228
max validation accuracy : 0.952727 max acc epoch : 25 test accuracy : 0.946575

Epoch :  34 loss training:  2.8657162173185498 Time :  245
accuracy train: 0.976166 val: 0.923636 test: 0.943836
max validation accuracy : 0.952727 max acc epoch : 25 test accuracy : 0.946575

Epoch :  35 loss training:  2.894750260747969 Time :  251
accuracy train: 0.976368 val: 0.934545 test: 0.943836
max validation accuracy : 0.952727 max acc epoch : 25 test accuracy : 0.946575

Epoch :  36 loss training:  2.06921971635893 Time :  257
accuracy train: 0.982024 val: 0.934545 test: 0.951598
max validation accuracy : 0.952727 max acc epoch : 25 test accuracy : 0.946575

Epoch :  37 loss training:  2.459801394259557 Time :  263
accuracy train: 0.975560 val: 0.936364 test: 0.941553
max validation accuracy : 0.952727 max acc epoch : 25 test accuracy : 0.946575

Epoch :  38 loss training:  2.0584486103616655 Time :  270
accuracy train: 0.978994 val: 0.936364 test: 0.947032
max validation accuracy : 0.952727 max acc epoch : 25 test accuracy : 0.946575

Epoch :  39 loss training:  1.9305709647014737 Time :  276
accuracy train: 0.977782 val: 0.945455 test: 0.942466
max validation accuracy : 0.952727 max acc epoch : 25 test accuracy : 0.946575

Epoch :  40 loss training:  1.754151941742748 Time :  282
accuracy train: 0.981216 val: 0.945455 test: 0.945205
max validation accuracy : 0.952727 max acc epoch : 25 test accuracy : 0.946575

Epoch :  41 loss training:  2.1138050947338343 Time :  288
accuracy train: 0.972329 val: 0.925455 test: 0.942466
max validation accuracy : 0.952727 max acc epoch : 25 test accuracy : 0.946575

Epoch :  42 loss training:  2.2883711920585483 Time :  294
accuracy train: 0.978994 val: 0.938182 test: 0.936530
max validation accuracy : 0.952727 max acc epoch : 25 test accuracy : 0.946575

Epoch :  43 loss training:  2.268092609476298 Time :  300
accuracy train: 0.971319 val: 0.930909 test: 0.939726
max validation accuracy : 0.952727 max acc epoch : 25 test accuracy : 0.946575

Epoch :  44 loss training:  2.413431587861851 Time :  306
accuracy train: 0.984044 val: 0.940000 test: 0.952511
max validation accuracy : 0.952727 max acc epoch : 25 test accuracy : 0.946575

Epoch :  45 loss training:  2.027195533970371 Time :  312
accuracy train: 0.963442 val: 0.927273 test: 0.933333
max validation accuracy : 0.952727 max acc epoch : 25 test accuracy : 0.946575

Epoch :  46 loss training:  2.3231470382306725 Time :  318
accuracy train: 0.980610 val: 0.938182 test: 0.944292
max validation accuracy : 0.952727 max acc epoch : 25 test accuracy : 0.946575

========================================================================================================================================================================================================
max acc epoch :  25
max validation accuracy :  0.9527272727272728
test accuracy :  0.9465753424657535
last test_accuracy :  0.9442922374429223
========================================================================================================================================================================================================

date and time :  Wed Mar 17 13:36:17 2021
Namespace(batch_size=128, dataset='R8', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=True, seed=0, weight_decay=1e-05)
device :  cuda:0
Counter({0: 1467, 3: 1321, 1: 1306, 2: 1251, 6: 1224, 5: 597, 7: 488, 4: 37})
HGNNModel(
  (word_embeddings): Embedding(8231, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=8, bias=True)
    (1): Linear(in_features=200, out_features=8, bias=True)
    (2): Linear(in_features=200, out_features=8, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  66.42786884307861 Time :  17
accuracy train: 0.878408 val: 0.887273 test: 0.902283
max validation accuracy : 0.887273 max acc epoch : 1 test accuracy : 0.902283

Epoch :  2 loss training:  33.6088742017746 Time :  23
accuracy train: 0.927489 val: 0.905455 test: 0.921005
max validation accuracy : 0.905455 max acc epoch : 2 test accuracy : 0.921005

Epoch :  3 loss training:  23.475104868412018 Time :  29
accuracy train: 0.949505 val: 0.916364 test: 0.928767
max validation accuracy : 0.916364 max acc epoch : 3 test accuracy : 0.928767

Epoch :  4 loss training:  17.317223083227873 Time :  34
accuracy train: 0.960614 val: 0.921818 test: 0.936530
max validation accuracy : 0.921818 max acc epoch : 4 test accuracy : 0.936530

Epoch :  5 loss training:  14.289652056992054 Time :  39
accuracy train: 0.964452 val: 0.929091 test: 0.937900
max validation accuracy : 0.929091 max acc epoch : 5 test accuracy : 0.937900

Epoch :  6 loss training:  10.63050328195095 Time :  45
accuracy train: 0.972531 val: 0.936364 test: 0.944292
max validation accuracy : 0.936364 max acc epoch : 6 test accuracy : 0.944292

Epoch :  7 loss training:  8.139374339953065 Time :  50
accuracy train: 0.976166 val: 0.938182 test: 0.946575
max validation accuracy : 0.938182 max acc epoch : 7 test accuracy : 0.946575

Epoch :  8 loss training:  7.485007993876934 Time :  55
accuracy train: 0.980408 val: 0.940000 test: 0.948858
max validation accuracy : 0.940000 max acc epoch : 8 test accuracy : 0.948858

Epoch :  9 loss training:  6.487673841416836 Time :  60
accuracy train: 0.971319 val: 0.940000 test: 0.941553
max validation accuracy : 0.940000 max acc epoch : 8 test accuracy : 0.948858

Epoch :  10 loss training:  4.427927140146494 Time :  65
accuracy train: 0.981216 val: 0.945455 test: 0.947032
max validation accuracy : 0.945455 max acc epoch : 10 test accuracy : 0.947032

Epoch :  11 loss training:  4.348187098279595 Time :  70
accuracy train: 0.986265 val: 0.941818 test: 0.948858
max validation accuracy : 0.945455 max acc epoch : 10 test accuracy : 0.947032

Epoch :  12 loss training:  3.2670139987021685 Time :  75
accuracy train: 0.986467 val: 0.940000 test: 0.944749
max validation accuracy : 0.945455 max acc epoch : 10 test accuracy : 0.947032

Epoch :  13 loss training:  2.9699510149657726 Time :  81
accuracy train: 0.988689 val: 0.945455 test: 0.946575
max validation accuracy : 0.945455 max acc epoch : 10 test accuracy : 0.947032

Epoch :  14 loss training:  3.3244874449446797 Time :  86
accuracy train: 0.987073 val: 0.940000 test: 0.941096
max validation accuracy : 0.945455 max acc epoch : 10 test accuracy : 0.947032

Epoch :  15 loss training:  2.377984607592225 Time :  91
accuracy train: 0.991719 val: 0.945455 test: 0.950685
max validation accuracy : 0.945455 max acc epoch : 10 test accuracy : 0.947032

Epoch :  16 loss training:  2.0185492876917124 Time :  97
accuracy train: 0.993739 val: 0.949091 test: 0.948402
max validation accuracy : 0.949091 max acc epoch : 16 test accuracy : 0.948402

Epoch :  17 loss training:  1.9543367745354772 Time :  102
accuracy train: 0.995960 val: 0.954545 test: 0.954795
max validation accuracy : 0.954545 max acc epoch : 17 test accuracy : 0.954795

Epoch :  18 loss training:  1.479837667196989 Time :  107
accuracy train: 0.994547 val: 0.949091 test: 0.952968
max validation accuracy : 0.954545 max acc epoch : 17 test accuracy : 0.954795

Epoch :  19 loss training:  1.3010225337930024 Time :  112
accuracy train: 0.994547 val: 0.952727 test: 0.953425
max validation accuracy : 0.954545 max acc epoch : 17 test accuracy : 0.954795

Epoch :  20 loss training:  1.116274434607476 Time :  117
accuracy train: 0.995354 val: 0.949091 test: 0.951142
max validation accuracy : 0.954545 max acc epoch : 17 test accuracy : 0.954795

Epoch :  21 loss training:  0.9627508905250579 Time :  123
accuracy train: 0.995556 val: 0.952727 test: 0.951142
max validation accuracy : 0.954545 max acc epoch : 17 test accuracy : 0.954795

Epoch :  22 loss training:  0.8867514717858285 Time :  128
accuracy train: 0.995152 val: 0.950909 test: 0.951142
max validation accuracy : 0.954545 max acc epoch : 17 test accuracy : 0.954795

Epoch :  23 loss training:  2.059302331181243 Time :  133
accuracy train: 0.993335 val: 0.947273 test: 0.952511
max validation accuracy : 0.954545 max acc epoch : 17 test accuracy : 0.954795

Epoch :  24 loss training:  1.5237431896384805 Time :  139
accuracy train: 0.994143 val: 0.943636 test: 0.944749
max validation accuracy : 0.954545 max acc epoch : 17 test accuracy : 0.954795

Epoch :  25 loss training:  1.0180561228189617 Time :  145
accuracy train: 0.995758 val: 0.956364 test: 0.952511
max validation accuracy : 0.956364 max acc epoch : 25 test accuracy : 0.952511

Epoch :  26 loss training:  0.9577449047937989 Time :  150
accuracy train: 0.996364 val: 0.954545 test: 0.952511
max validation accuracy : 0.956364 max acc epoch : 25 test accuracy : 0.952511

Epoch :  27 loss training:  1.05579341808334 Time :  155
accuracy train: 0.997374 val: 0.950909 test: 0.951598
max validation accuracy : 0.956364 max acc epoch : 25 test accuracy : 0.952511

Epoch :  28 loss training:  1.4480334683321416 Time :  161
accuracy train: 0.995354 val: 0.949091 test: 0.951142
max validation accuracy : 0.956364 max acc epoch : 25 test accuracy : 0.952511

Epoch :  29 loss training:  1.020730483927764 Time :  167
accuracy train: 0.996566 val: 0.950909 test: 0.953425
max validation accuracy : 0.956364 max acc epoch : 25 test accuracy : 0.952511

Epoch :  30 loss training:  2.34036615898367 Time :  172
accuracy train: 0.995758 val: 0.941818 test: 0.952055
max validation accuracy : 0.956364 max acc epoch : 25 test accuracy : 0.952511

Epoch :  31 loss training:  1.1161678440403193 Time :  177
accuracy train: 0.996162 val: 0.950909 test: 0.952968
max validation accuracy : 0.956364 max acc epoch : 25 test accuracy : 0.952511

Epoch :  32 loss training:  0.9304211663547903 Time :  182
accuracy train: 0.994951 val: 0.950909 test: 0.952968
max validation accuracy : 0.956364 max acc epoch : 25 test accuracy : 0.952511

Epoch :  33 loss training:  1.4341556006111205 Time :  187
accuracy train: 0.995960 val: 0.954545 test: 0.950228
max validation accuracy : 0.956364 max acc epoch : 25 test accuracy : 0.952511

Epoch :  34 loss training:  1.1033928226097487 Time :  193
accuracy train: 0.995960 val: 0.947273 test: 0.955251
max validation accuracy : 0.956364 max acc epoch : 25 test accuracy : 0.952511

Epoch :  35 loss training:  0.7859522245125845 Time :  198
accuracy train: 0.995758 val: 0.947273 test: 0.945205
max validation accuracy : 0.956364 max acc epoch : 25 test accuracy : 0.952511

Epoch :  36 loss training:  1.2078917603066657 Time :  204
accuracy train: 0.993537 val: 0.941818 test: 0.936530
max validation accuracy : 0.956364 max acc epoch : 25 test accuracy : 0.952511

Epoch :  37 loss training:  0.9422768235672265 Time :  209
accuracy train: 0.996970 val: 0.949091 test: 0.949315
max validation accuracy : 0.956364 max acc epoch : 25 test accuracy : 0.952511

Epoch :  38 loss training:  0.6214377086143941 Time :  214
accuracy train: 0.996364 val: 0.947273 test: 0.954338
max validation accuracy : 0.956364 max acc epoch : 25 test accuracy : 0.952511

Epoch :  39 loss training:  0.8054984916234389 Time :  220
accuracy train: 0.996970 val: 0.956364 test: 0.956621
max validation accuracy : 0.956364 max acc epoch : 25 test accuracy : 0.952511

Epoch :  40 loss training:  0.9748717986512929 Time :  225
accuracy train: 0.997172 val: 0.956364 test: 0.957991
max validation accuracy : 0.956364 max acc epoch : 25 test accuracy : 0.952511

Epoch :  41 loss training:  0.7239828939782456 Time :  230
accuracy train: 0.991517 val: 0.949091 test: 0.948858
max validation accuracy : 0.956364 max acc epoch : 25 test accuracy : 0.952511

Epoch :  42 loss training:  0.8657067144522443 Time :  236
accuracy train: 0.995152 val: 0.952727 test: 0.952968
max validation accuracy : 0.956364 max acc epoch : 25 test accuracy : 0.952511

Epoch :  43 loss training:  0.7533195351716131 Time :  241
accuracy train: 0.995152 val: 0.949091 test: 0.951142
max validation accuracy : 0.956364 max acc epoch : 25 test accuracy : 0.952511

Epoch :  44 loss training:  0.71392581803957 Time :  247
accuracy train: 0.995960 val: 0.958182 test: 0.953881
max validation accuracy : 0.958182 max acc epoch : 44 test accuracy : 0.953881

Epoch :  45 loss training:  1.6060794147197157 Time :  252
accuracy train: 0.991719 val: 0.947273 test: 0.948402
max validation accuracy : 0.958182 max acc epoch : 44 test accuracy : 0.953881

Epoch :  46 loss training:  1.0881798328773584 Time :  258
accuracy train: 0.995556 val: 0.950909 test: 0.957078
max validation accuracy : 0.958182 max acc epoch : 44 test accuracy : 0.953881

Epoch :  47 loss training:  0.6551163059775718 Time :  264
accuracy train: 0.995556 val: 0.956364 test: 0.954338
max validation accuracy : 0.958182 max acc epoch : 44 test accuracy : 0.953881

Epoch :  48 loss training:  0.6255684639909305 Time :  270
accuracy train: 0.996364 val: 0.954545 test: 0.958447
max validation accuracy : 0.958182 max acc epoch : 44 test accuracy : 0.953881

Epoch :  49 loss training:  1.6247747002053075 Time :  275
accuracy train: 0.989093 val: 0.945455 test: 0.938813
max validation accuracy : 0.958182 max acc epoch : 44 test accuracy : 0.953881

Epoch :  50 loss training:  0.9392313818098046 Time :  281
accuracy train: 0.995354 val: 0.950909 test: 0.952511
max validation accuracy : 0.958182 max acc epoch : 44 test accuracy : 0.953881

Epoch :  51 loss training:  0.4609099955414422 Time :  286
accuracy train: 0.996566 val: 0.954545 test: 0.952968
max validation accuracy : 0.958182 max acc epoch : 44 test accuracy : 0.953881

Epoch :  52 loss training:  0.6615868864464574 Time :  292
accuracy train: 0.995960 val: 0.950909 test: 0.956164
max validation accuracy : 0.958182 max acc epoch : 44 test accuracy : 0.953881

Epoch :  53 loss training:  1.0128626965451986 Time :  296
accuracy train: 0.993941 val: 0.952727 test: 0.954338
max validation accuracy : 0.958182 max acc epoch : 44 test accuracy : 0.953881

Epoch :  54 loss training:  0.9216063289204612 Time :  302
accuracy train: 0.994951 val: 0.949091 test: 0.958447
max validation accuracy : 0.958182 max acc epoch : 44 test accuracy : 0.953881

Epoch :  55 loss training:  0.9694031407125294 Time :  308
accuracy train: 0.995152 val: 0.947273 test: 0.960731
max validation accuracy : 0.958182 max acc epoch : 44 test accuracy : 0.953881

Epoch :  56 loss training:  0.9283735130447894 Time :  313
accuracy train: 0.987881 val: 0.929091 test: 0.939726
max validation accuracy : 0.958182 max acc epoch : 44 test accuracy : 0.953881

Epoch :  57 loss training:  0.7389669362164568 Time :  319
accuracy train: 0.996970 val: 0.952727 test: 0.954795
max validation accuracy : 0.958182 max acc epoch : 44 test accuracy : 0.953881

Epoch :  58 loss training:  0.5428115199320018 Time :  324
accuracy train: 0.996970 val: 0.950909 test: 0.951598
max validation accuracy : 0.958182 max acc epoch : 44 test accuracy : 0.953881

Epoch :  59 loss training:  0.6310076829977334 Time :  329
accuracy train: 0.995556 val: 0.949091 test: 0.954338
max validation accuracy : 0.958182 max acc epoch : 44 test accuracy : 0.953881

Epoch :  60 loss training:  0.8067114243312972 Time :  334
accuracy train: 0.994749 val: 0.950909 test: 0.956621
max validation accuracy : 0.958182 max acc epoch : 44 test accuracy : 0.953881

Epoch :  61 loss training:  0.7941016858676448 Time :  339
accuracy train: 0.991517 val: 0.943636 test: 0.954338
max validation accuracy : 0.958182 max acc epoch : 44 test accuracy : 0.953881

Epoch :  62 loss training:  0.3925450965180062 Time :  345
accuracy train: 0.996364 val: 0.949091 test: 0.957991
max validation accuracy : 0.958182 max acc epoch : 44 test accuracy : 0.953881

Epoch :  63 loss training:  0.5480484620493371 Time :  350
accuracy train: 0.996768 val: 0.954545 test: 0.957534
max validation accuracy : 0.958182 max acc epoch : 44 test accuracy : 0.953881

Epoch :  64 loss training:  0.2288233019062318 Time :  355
accuracy train: 0.996162 val: 0.952727 test: 0.957534
max validation accuracy : 0.958182 max acc epoch : 44 test accuracy : 0.953881

Epoch :  65 loss training:  0.393600550130941 Time :  360
accuracy train: 0.996566 val: 0.950909 test: 0.955708
max validation accuracy : 0.958182 max acc epoch : 44 test accuracy : 0.953881

========================================================================================================================================================================================================
max acc epoch :  44
max validation accuracy :  0.9581818181818181
test accuracy :  0.9538812785388128
last test_accuracy :  0.9557077625570777
========================================================================================================================================================================================================

date and time :  Wed Mar 17 13:42:31 2021
Namespace(batch_size=128, dataset='R8', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=100, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=1e-05)
device :  cuda:0
Counter({0: 1467, 3: 1321, 1: 1306, 2: 1251, 6: 1224, 5: 597, 7: 488, 4: 37})
HGNNModel(
  (word_embeddings): Embedding(8231, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=8, bias=True)
    (1): Linear(in_features=100, out_features=8, bias=True)
    (2): Linear(in_features=100, out_features=8, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  61.62567174434662 Time :  24
accuracy train: 0.860230 val: 0.841818 test: 0.880822
max validation accuracy : 0.841818 max acc epoch : 1 test accuracy : 0.880822

Epoch :  2 loss training:  33.54523840546608 Time :  30
accuracy train: 0.896183 val: 0.878182 test: 0.894977
max validation accuracy : 0.878182 max acc epoch : 2 test accuracy : 0.894977

Epoch :  3 loss training:  25.70961794257164 Time :  36
accuracy train: 0.887497 val: 0.872727 test: 0.896347
max validation accuracy : 0.878182 max acc epoch : 2 test accuracy : 0.894977

Epoch :  4 loss training:  20.832605488598347 Time :  40
accuracy train: 0.906686 val: 0.900000 test: 0.915982
max validation accuracy : 0.900000 max acc epoch : 4 test accuracy : 0.915982

Epoch :  5 loss training:  18.39602829515934 Time :  46
accuracy train: 0.892951 val: 0.890909 test: 0.898174
max validation accuracy : 0.900000 max acc epoch : 4 test accuracy : 0.915982

Epoch :  6 loss training:  15.780000105500221 Time :  52
accuracy train: 0.929509 val: 0.910909 test: 0.931507
max validation accuracy : 0.910909 max acc epoch : 6 test accuracy : 0.931507

Epoch :  7 loss training:  13.660379096865654 Time :  57
accuracy train: 0.933145 val: 0.923636 test: 0.934247
max validation accuracy : 0.923636 max acc epoch : 7 test accuracy : 0.934247

Epoch :  8 loss training:  13.643959313631058 Time :  62
accuracy train: 0.933751 val: 0.925455 test: 0.933790
max validation accuracy : 0.925455 max acc epoch : 8 test accuracy : 0.933790

Epoch :  9 loss training:  12.586572799831629 Time :  68
accuracy train: 0.931731 val: 0.925455 test: 0.934703
max validation accuracy : 0.925455 max acc epoch : 8 test accuracy : 0.933790

Epoch :  10 loss training:  10.491875730454922 Time :  72
accuracy train: 0.945062 val: 0.925455 test: 0.936073
max validation accuracy : 0.925455 max acc epoch : 8 test accuracy : 0.933790

Epoch :  11 loss training:  9.980689475312829 Time :  78
accuracy train: 0.946879 val: 0.929091 test: 0.932877
max validation accuracy : 0.929091 max acc epoch : 11 test accuracy : 0.932877

Epoch :  12 loss training:  9.588674729689956 Time :  83
accuracy train: 0.942234 val: 0.925455 test: 0.931963
max validation accuracy : 0.929091 max acc epoch : 11 test accuracy : 0.932877

Epoch :  13 loss training:  8.513717979192734 Time :  89
accuracy train: 0.945062 val: 0.927273 test: 0.922831
max validation accuracy : 0.929091 max acc epoch : 11 test accuracy : 0.932877

Epoch :  14 loss training:  9.170724835246801 Time :  94
accuracy train: 0.964048 val: 0.947273 test: 0.944749
max validation accuracy : 0.947273 max acc epoch : 14 test accuracy : 0.944749

Epoch :  15 loss training:  7.827854078263044 Time :  98
accuracy train: 0.956776 val: 0.936364 test: 0.941553
max validation accuracy : 0.947273 max acc epoch : 14 test accuracy : 0.944749

Epoch :  16 loss training:  6.779249029234052 Time :  104
accuracy train: 0.959806 val: 0.932727 test: 0.930137
max validation accuracy : 0.947273 max acc epoch : 14 test accuracy : 0.944749

Epoch :  17 loss training:  6.7412899155169725 Time :  109
accuracy train: 0.957180 val: 0.927273 test: 0.939269
max validation accuracy : 0.947273 max acc epoch : 14 test accuracy : 0.944749

Epoch :  18 loss training:  6.48481147736311 Time :  114
accuracy train: 0.946475 val: 0.930909 test: 0.935160
max validation accuracy : 0.947273 max acc epoch : 14 test accuracy : 0.944749

Epoch :  19 loss training:  6.125679667107761 Time :  119
accuracy train: 0.964048 val: 0.945455 test: 0.946575
max validation accuracy : 0.947273 max acc epoch : 14 test accuracy : 0.944749

Epoch :  20 loss training:  5.576995432376862 Time :  124
accuracy train: 0.961018 val: 0.932727 test: 0.938813
max validation accuracy : 0.947273 max acc epoch : 14 test accuracy : 0.944749

Epoch :  21 loss training:  5.085217569954693 Time :  129
accuracy train: 0.950717 val: 0.925455 test: 0.928311
max validation accuracy : 0.947273 max acc epoch : 14 test accuracy : 0.944749

Epoch :  22 loss training:  5.9734564032405615 Time :  134
accuracy train: 0.946677 val: 0.923636 test: 0.925114
max validation accuracy : 0.947273 max acc epoch : 14 test accuracy : 0.944749

Epoch :  23 loss training:  5.686691898852587 Time :  139
accuracy train: 0.959806 val: 0.940000 test: 0.942922
max validation accuracy : 0.947273 max acc epoch : 14 test accuracy : 0.944749

Epoch :  24 loss training:  4.808912646025419 Time :  144
accuracy train: 0.946273 val: 0.929091 test: 0.930594
max validation accuracy : 0.947273 max acc epoch : 14 test accuracy : 0.944749

Epoch :  25 loss training:  4.982388362288475 Time :  149
accuracy train: 0.961624 val: 0.941818 test: 0.940639
max validation accuracy : 0.947273 max acc epoch : 14 test accuracy : 0.944749

Epoch :  26 loss training:  5.039589430205524 Time :  155
accuracy train: 0.950515 val: 0.930909 test: 0.940639
max validation accuracy : 0.947273 max acc epoch : 14 test accuracy : 0.944749

Epoch :  27 loss training:  5.408157323952764 Time :  160
accuracy train: 0.957382 val: 0.929091 test: 0.937443
max validation accuracy : 0.947273 max acc epoch : 14 test accuracy : 0.944749

Epoch :  28 loss training:  4.124973543453962 Time :  165
accuracy train: 0.958998 val: 0.934545 test: 0.933790
max validation accuracy : 0.947273 max acc epoch : 14 test accuracy : 0.944749

Epoch :  29 loss training:  4.0307742320001125 Time :  170
accuracy train: 0.955363 val: 0.923636 test: 0.930594
max validation accuracy : 0.947273 max acc epoch : 14 test accuracy : 0.944749

Epoch :  30 loss training:  6.353080090833828 Time :  175
accuracy train: 0.970309 val: 0.945455 test: 0.948858
max validation accuracy : 0.947273 max acc epoch : 14 test accuracy : 0.944749

Epoch :  31 loss training:  4.187151400372386 Time :  180
accuracy train: 0.961220 val: 0.929091 test: 0.936073
max validation accuracy : 0.947273 max acc epoch : 14 test accuracy : 0.944749

Epoch :  32 loss training:  3.6069085120689124 Time :  185
accuracy train: 0.977984 val: 0.934545 test: 0.950228
max validation accuracy : 0.947273 max acc epoch : 14 test accuracy : 0.944749

Epoch :  33 loss training:  3.6642022628802806 Time :  190
accuracy train: 0.966673 val: 0.936364 test: 0.942466
max validation accuracy : 0.947273 max acc epoch : 14 test accuracy : 0.944749

Epoch :  34 loss training:  3.5958405770361423 Time :  194
accuracy train: 0.972733 val: 0.936364 test: 0.950228
max validation accuracy : 0.947273 max acc epoch : 14 test accuracy : 0.944749

Epoch :  35 loss training:  3.246377920731902 Time :  199
accuracy train: 0.978792 val: 0.938182 test: 0.951142
max validation accuracy : 0.947273 max acc epoch : 14 test accuracy : 0.944749

========================================================================================================================================================================================================
max acc epoch :  14
max validation accuracy :  0.9472727272727273
test accuracy :  0.9447488584474886
last test_accuracy :  0.9511415525114155
========================================================================================================================================================================================================

date and time :  Wed Mar 17 13:45:59 2021
Namespace(batch_size=128, dataset='R8', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=100, lda=True, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=1e-05)
device :  cuda:0
Counter({7: 1488, 4: 1299, 6: 1285, 2: 1260, 3: 1250, 5: 597, 1: 475, 0: 37})
HGNNModel(
  (word_embeddings): Embedding(8231, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=8, bias=True)
    (1): Linear(in_features=100, out_features=8, bias=True)
    (2): Linear(in_features=100, out_features=8, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  64.6463993191719 Time :  19
accuracy train: 0.888507 val: 0.874545 test: 0.902740
max validation accuracy : 0.874545 max acc epoch : 1 test accuracy : 0.902740

Epoch :  2 loss training:  35.82035791873932 Time :  25
accuracy train: 0.917592 val: 0.905455 test: 0.921005
max validation accuracy : 0.905455 max acc epoch : 2 test accuracy : 0.921005

Epoch :  3 loss training:  26.83574315905571 Time :  31
accuracy train: 0.929509 val: 0.916364 test: 0.926484
max validation accuracy : 0.916364 max acc epoch : 3 test accuracy : 0.926484

Epoch :  4 loss training:  21.871471524238586 Time :  37
accuracy train: 0.935771 val: 0.920000 test: 0.931507
max validation accuracy : 0.920000 max acc epoch : 4 test accuracy : 0.931507

Epoch :  5 loss training:  18.588897094130516 Time :  44
accuracy train: 0.948495 val: 0.932727 test: 0.942922
max validation accuracy : 0.932727 max acc epoch : 5 test accuracy : 0.942922

Epoch :  6 loss training:  16.931005209684372 Time :  49
accuracy train: 0.953747 val: 0.940000 test: 0.947945
max validation accuracy : 0.940000 max acc epoch : 6 test accuracy : 0.947945

Epoch :  7 loss training:  14.357628859579563 Time :  56
accuracy train: 0.956776 val: 0.940000 test: 0.943379
max validation accuracy : 0.940000 max acc epoch : 6 test accuracy : 0.947945

Epoch :  8 loss training:  13.14652743190527 Time :  62
accuracy train: 0.963644 val: 0.950909 test: 0.951142
max validation accuracy : 0.950909 max acc epoch : 8 test accuracy : 0.951142

Epoch :  9 loss training:  11.755504347383976 Time :  68
accuracy train: 0.957786 val: 0.936364 test: 0.942466
max validation accuracy : 0.950909 max acc epoch : 8 test accuracy : 0.951142

Epoch :  10 loss training:  10.598057504743338 Time :  74
accuracy train: 0.968895 val: 0.947273 test: 0.952511
max validation accuracy : 0.950909 max acc epoch : 8 test accuracy : 0.951142

Epoch :  11 loss training:  10.424948558211327 Time :  81
accuracy train: 0.960412 val: 0.947273 test: 0.942922
max validation accuracy : 0.950909 max acc epoch : 8 test accuracy : 0.951142

Epoch :  12 loss training:  9.770717788487673 Time :  87
accuracy train: 0.971723 val: 0.954545 test: 0.956164
max validation accuracy : 0.954545 max acc epoch : 12 test accuracy : 0.956164

Epoch :  13 loss training:  8.564994044601917 Time :  93
accuracy train: 0.961220 val: 0.940000 test: 0.937900
max validation accuracy : 0.954545 max acc epoch : 12 test accuracy : 0.956164

Epoch :  14 loss training:  7.940337922424078 Time :  99
accuracy train: 0.968895 val: 0.952727 test: 0.956164
max validation accuracy : 0.954545 max acc epoch : 12 test accuracy : 0.956164

Epoch :  15 loss training:  7.745429307222366 Time :  105
accuracy train: 0.971117 val: 0.950909 test: 0.945205
max validation accuracy : 0.954545 max acc epoch : 12 test accuracy : 0.956164

Epoch :  16 loss training:  7.815000884234905 Time :  112
accuracy train: 0.970309 val: 0.949091 test: 0.951142
max validation accuracy : 0.954545 max acc epoch : 12 test accuracy : 0.956164

Epoch :  17 loss training:  7.215384673327208 Time :  118
accuracy train: 0.971319 val: 0.949091 test: 0.943836
max validation accuracy : 0.954545 max acc epoch : 12 test accuracy : 0.956164

Epoch :  18 loss training:  6.768527049571276 Time :  124
accuracy train: 0.970107 val: 0.947273 test: 0.949772
max validation accuracy : 0.954545 max acc epoch : 12 test accuracy : 0.956164

Epoch :  19 loss training:  5.983279671519995 Time :  130
accuracy train: 0.973137 val: 0.947273 test: 0.950685
max validation accuracy : 0.954545 max acc epoch : 12 test accuracy : 0.956164

Epoch :  20 loss training:  5.948204695247114 Time :  137
accuracy train: 0.978590 val: 0.949091 test: 0.954338
max validation accuracy : 0.954545 max acc epoch : 12 test accuracy : 0.956164

Epoch :  21 loss training:  6.083111780695617 Time :  142
accuracy train: 0.965865 val: 0.940000 test: 0.949772
max validation accuracy : 0.954545 max acc epoch : 12 test accuracy : 0.956164

Epoch :  22 loss training:  5.513474446721375 Time :  149
accuracy train: 0.976570 val: 0.943636 test: 0.946575
max validation accuracy : 0.954545 max acc epoch : 12 test accuracy : 0.956164

Epoch :  23 loss training:  4.872675276361406 Time :  155
accuracy train: 0.976368 val: 0.950909 test: 0.950685
max validation accuracy : 0.954545 max acc epoch : 12 test accuracy : 0.956164

Epoch :  24 loss training:  4.447051159106195 Time :  161
accuracy train: 0.974147 val: 0.941818 test: 0.948402
max validation accuracy : 0.954545 max acc epoch : 12 test accuracy : 0.956164

Epoch :  25 loss training:  3.970741040073335 Time :  167
accuracy train: 0.977580 val: 0.949091 test: 0.947945
max validation accuracy : 0.954545 max acc epoch : 12 test accuracy : 0.956164

Epoch :  26 loss training:  4.162428138777614 Time :  173
accuracy train: 0.980206 val: 0.945455 test: 0.950228
max validation accuracy : 0.954545 max acc epoch : 12 test accuracy : 0.956164

Epoch :  27 loss training:  4.791749036870897 Time :  179
accuracy train: 0.974551 val: 0.940000 test: 0.950228
max validation accuracy : 0.954545 max acc epoch : 12 test accuracy : 0.956164

Epoch :  28 loss training:  4.372729836497456 Time :  185
accuracy train: 0.973339 val: 0.950909 test: 0.946119
max validation accuracy : 0.954545 max acc epoch : 12 test accuracy : 0.956164

Epoch :  29 loss training:  4.337614520918578 Time :  192
accuracy train: 0.979196 val: 0.945455 test: 0.952055
max validation accuracy : 0.954545 max acc epoch : 12 test accuracy : 0.956164

Epoch :  30 loss training:  3.864185551647097 Time :  198
accuracy train: 0.981216 val: 0.950909 test: 0.954795
max validation accuracy : 0.954545 max acc epoch : 12 test accuracy : 0.956164

Epoch :  31 loss training:  4.10451635858044 Time :  203
accuracy train: 0.981418 val: 0.941818 test: 0.950685
max validation accuracy : 0.954545 max acc epoch : 12 test accuracy : 0.956164

Epoch :  32 loss training:  3.6045494824647903 Time :  209
accuracy train: 0.978590 val: 0.945455 test: 0.947032
max validation accuracy : 0.954545 max acc epoch : 12 test accuracy : 0.956164

Epoch :  33 loss training:  3.757834722753614 Time :  215
accuracy train: 0.979600 val: 0.947273 test: 0.949315
max validation accuracy : 0.954545 max acc epoch : 12 test accuracy : 0.956164

========================================================================================================================================================================================================
max acc epoch :  12
max validation accuracy :  0.9545454545454546
test accuracy :  0.9561643835616438
last test_accuracy :  0.9493150684931507
========================================================================================================================================================================================================

date and time :  Wed Mar 17 13:49:45 2021
Namespace(batch_size=128, dataset='R8', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=100, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=True, seed=0, weight_decay=1e-05)
device :  cuda:0
Counter({0: 1467, 3: 1321, 1: 1306, 2: 1251, 6: 1224, 5: 597, 7: 488, 4: 37})
HGNNModel(
  (word_embeddings): Embedding(8231, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=8, bias=True)
    (1): Linear(in_features=100, out_features=8, bias=True)
    (2): Linear(in_features=100, out_features=8, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  69.13330698013306 Time :  22
accuracy train: 0.881438 val: 0.889091 test: 0.904110
max validation accuracy : 0.889091 max acc epoch : 1 test accuracy : 0.904110

Epoch :  2 loss training:  38.359844356775284 Time :  28
accuracy train: 0.924460 val: 0.909091 test: 0.929680
max validation accuracy : 0.909091 max acc epoch : 2 test accuracy : 0.929680

Epoch :  3 loss training:  26.837450116872787 Time :  33
accuracy train: 0.936780 val: 0.907273 test: 0.931507
max validation accuracy : 0.909091 max acc epoch : 2 test accuracy : 0.929680

Epoch :  4 loss training:  20.323374815285206 Time :  38
accuracy train: 0.946677 val: 0.918182 test: 0.936073
max validation accuracy : 0.918182 max acc epoch : 4 test accuracy : 0.936073

Epoch :  5 loss training:  16.614958323538303 Time :  43
accuracy train: 0.955968 val: 0.925455 test: 0.935616
max validation accuracy : 0.925455 max acc epoch : 5 test accuracy : 0.935616

Epoch :  6 loss training:  12.487771339714527 Time :  49
accuracy train: 0.965058 val: 0.938182 test: 0.938813
max validation accuracy : 0.938182 max acc epoch : 6 test accuracy : 0.938813

Epoch :  7 loss training:  9.698835127055645 Time :  55
accuracy train: 0.973339 val: 0.943636 test: 0.948858
max validation accuracy : 0.943636 max acc epoch : 7 test accuracy : 0.948858

Epoch :  8 loss training:  8.639269437640905 Time :  60
accuracy train: 0.976368 val: 0.941818 test: 0.945662
max validation accuracy : 0.943636 max acc epoch : 7 test accuracy : 0.948858

Epoch :  9 loss training:  7.351486688479781 Time :  66
accuracy train: 0.976166 val: 0.945455 test: 0.946119
max validation accuracy : 0.945455 max acc epoch : 9 test accuracy : 0.946119

Epoch :  10 loss training:  5.497707212343812 Time :  71
accuracy train: 0.982630 val: 0.947273 test: 0.947945
max validation accuracy : 0.947273 max acc epoch : 10 test accuracy : 0.947945

Epoch :  11 loss training:  5.360352773219347 Time :  76
accuracy train: 0.984448 val: 0.947273 test: 0.947032
max validation accuracy : 0.947273 max acc epoch : 10 test accuracy : 0.947945

Epoch :  12 loss training:  4.254966955631971 Time :  82
accuracy train: 0.986063 val: 0.947273 test: 0.949315
max validation accuracy : 0.947273 max acc epoch : 10 test accuracy : 0.947945

Epoch :  13 loss training:  3.443839581683278 Time :  87
accuracy train: 0.986265 val: 0.945455 test: 0.949315
max validation accuracy : 0.947273 max acc epoch : 10 test accuracy : 0.947945

Epoch :  14 loss training:  4.070245627313852 Time :  93
accuracy train: 0.989093 val: 0.950909 test: 0.949315
max validation accuracy : 0.950909 max acc epoch : 14 test accuracy : 0.949315

Epoch :  15 loss training:  3.2416020315140486 Time :  98
accuracy train: 0.989497 val: 0.947273 test: 0.950685
max validation accuracy : 0.950909 max acc epoch : 14 test accuracy : 0.949315

Epoch :  16 loss training:  2.5825965916737914 Time :  103
accuracy train: 0.993335 val: 0.960000 test: 0.952968
max validation accuracy : 0.960000 max acc epoch : 16 test accuracy : 0.952968

Epoch :  17 loss training:  2.274900805670768 Time :  108
accuracy train: 0.995152 val: 0.952727 test: 0.956621
max validation accuracy : 0.960000 max acc epoch : 16 test accuracy : 0.952968

Epoch :  18 loss training:  1.788903288077563 Time :  114
accuracy train: 0.994547 val: 0.956364 test: 0.954795
max validation accuracy : 0.960000 max acc epoch : 16 test accuracy : 0.952968

Epoch :  19 loss training:  1.7464827531948686 Time :  119
accuracy train: 0.995758 val: 0.952727 test: 0.954795
max validation accuracy : 0.960000 max acc epoch : 16 test accuracy : 0.952968

Epoch :  20 loss training:  1.4228679947555065 Time :  124
accuracy train: 0.995556 val: 0.950909 test: 0.956621
max validation accuracy : 0.960000 max acc epoch : 16 test accuracy : 0.952968

Epoch :  21 loss training:  1.4379547545686364 Time :  130
accuracy train: 0.992527 val: 0.949091 test: 0.957534
max validation accuracy : 0.960000 max acc epoch : 16 test accuracy : 0.952968

Epoch :  22 loss training:  1.6515627410262823 Time :  134
accuracy train: 0.994951 val: 0.950909 test: 0.955251
max validation accuracy : 0.960000 max acc epoch : 16 test accuracy : 0.952968

Epoch :  23 loss training:  1.799655715469271 Time :  139
accuracy train: 0.995152 val: 0.952727 test: 0.953425
max validation accuracy : 0.960000 max acc epoch : 16 test accuracy : 0.952968

Epoch :  24 loss training:  1.460479753324762 Time :  144
accuracy train: 0.995960 val: 0.949091 test: 0.954795
max validation accuracy : 0.960000 max acc epoch : 16 test accuracy : 0.952968

Epoch :  25 loss training:  1.0426686054561287 Time :  149
accuracy train: 0.996364 val: 0.950909 test: 0.954338
max validation accuracy : 0.960000 max acc epoch : 16 test accuracy : 0.952968

Epoch :  26 loss training:  1.0144474818371236 Time :  154
accuracy train: 0.996768 val: 0.950909 test: 0.957078
max validation accuracy : 0.960000 max acc epoch : 16 test accuracy : 0.952968

Epoch :  27 loss training:  1.1511225837748498 Time :  159
accuracy train: 0.994749 val: 0.954545 test: 0.957991
max validation accuracy : 0.960000 max acc epoch : 16 test accuracy : 0.952968

Epoch :  28 loss training:  2.041198168415576 Time :  164
accuracy train: 0.995354 val: 0.958182 test: 0.954795
max validation accuracy : 0.960000 max acc epoch : 16 test accuracy : 0.952968

Epoch :  29 loss training:  1.302861669450067 Time :  169
accuracy train: 0.996364 val: 0.954545 test: 0.960731
max validation accuracy : 0.960000 max acc epoch : 16 test accuracy : 0.952968

Epoch :  30 loss training:  1.4032572315772995 Time :  174
accuracy train: 0.996566 val: 0.961818 test: 0.956621
max validation accuracy : 0.961818 max acc epoch : 30 test accuracy : 0.956621

Epoch :  31 loss training:  0.7689734256127849 Time :  180
accuracy train: 0.996364 val: 0.961818 test: 0.955251
max validation accuracy : 0.961818 max acc epoch : 30 test accuracy : 0.956621

Epoch :  32 loss training:  0.9512171924579889 Time :  185
accuracy train: 0.996364 val: 0.960000 test: 0.958904
max validation accuracy : 0.961818 max acc epoch : 30 test accuracy : 0.956621

Epoch :  33 loss training:  0.9932897307444364 Time :  190
accuracy train: 0.997172 val: 0.949091 test: 0.958447
max validation accuracy : 0.961818 max acc epoch : 30 test accuracy : 0.956621

Epoch :  34 loss training:  0.9181250043911859 Time :  195
accuracy train: 0.998182 val: 0.963636 test: 0.962557
max validation accuracy : 0.963636 max acc epoch : 34 test accuracy : 0.962557

Epoch :  35 loss training:  0.8544563449395355 Time :  201
accuracy train: 0.996970 val: 0.952727 test: 0.956164
max validation accuracy : 0.963636 max acc epoch : 34 test accuracy : 0.962557

Epoch :  36 loss training:  0.6439524389570579 Time :  206
accuracy train: 0.997576 val: 0.960000 test: 0.957534
max validation accuracy : 0.963636 max acc epoch : 34 test accuracy : 0.962557

Epoch :  37 loss training:  0.4627424241625704 Time :  211
accuracy train: 0.997980 val: 0.952727 test: 0.957534
max validation accuracy : 0.963636 max acc epoch : 34 test accuracy : 0.962557

Epoch :  38 loss training:  0.5791426017531194 Time :  217
accuracy train: 0.997980 val: 0.949091 test: 0.959817
max validation accuracy : 0.963636 max acc epoch : 34 test accuracy : 0.962557

Epoch :  39 loss training:  0.7554571278160438 Time :  221
accuracy train: 0.995556 val: 0.950909 test: 0.958447
max validation accuracy : 0.963636 max acc epoch : 34 test accuracy : 0.962557

Epoch :  40 loss training:  1.234537178534083 Time :  226
accuracy train: 0.995354 val: 0.952727 test: 0.958904
max validation accuracy : 0.963636 max acc epoch : 34 test accuracy : 0.962557

Epoch :  41 loss training:  0.8265551765216514 Time :  232
accuracy train: 0.997172 val: 0.965455 test: 0.963014
max validation accuracy : 0.965455 max acc epoch : 41 test accuracy : 0.963014

Epoch :  42 loss training:  1.1642332767369226 Time :  238
accuracy train: 0.994345 val: 0.969091 test: 0.961187
max validation accuracy : 0.969091 max acc epoch : 42 test accuracy : 0.961187

Epoch :  43 loss training:  1.295623907004483 Time :  243
accuracy train: 0.995758 val: 0.952727 test: 0.957078
max validation accuracy : 0.969091 max acc epoch : 42 test accuracy : 0.961187

Epoch :  44 loss training:  0.8800781859899871 Time :  248
accuracy train: 0.997172 val: 0.965455 test: 0.961644
max validation accuracy : 0.969091 max acc epoch : 42 test accuracy : 0.961187

Epoch :  45 loss training:  1.9172588823130354 Time :  253
accuracy train: 0.993941 val: 0.960000 test: 0.958904
max validation accuracy : 0.969091 max acc epoch : 42 test accuracy : 0.961187

Epoch :  46 loss training:  1.117411083105253 Time :  258
accuracy train: 0.995758 val: 0.950909 test: 0.959817
max validation accuracy : 0.969091 max acc epoch : 42 test accuracy : 0.961187

Epoch :  47 loss training:  0.7691739433794282 Time :  264
accuracy train: 0.996162 val: 0.956364 test: 0.958447
max validation accuracy : 0.969091 max acc epoch : 42 test accuracy : 0.961187

Epoch :  48 loss training:  1.0303594312863424 Time :  269
accuracy train: 0.994951 val: 0.958182 test: 0.957534
max validation accuracy : 0.969091 max acc epoch : 42 test accuracy : 0.961187

Epoch :  49 loss training:  0.908664281188976 Time :  274
accuracy train: 0.996768 val: 0.960000 test: 0.956164
max validation accuracy : 0.969091 max acc epoch : 42 test accuracy : 0.961187

Epoch :  50 loss training:  0.4941286060784478 Time :  279
accuracy train: 0.996970 val: 0.958182 test: 0.958904
max validation accuracy : 0.969091 max acc epoch : 42 test accuracy : 0.961187

Epoch :  51 loss training:  0.5980716427438892 Time :  285
accuracy train: 0.996970 val: 0.960000 test: 0.957534
max validation accuracy : 0.969091 max acc epoch : 42 test accuracy : 0.961187

Epoch :  52 loss training:  0.5069549311301671 Time :  290
accuracy train: 0.997778 val: 0.963636 test: 0.957991
max validation accuracy : 0.969091 max acc epoch : 42 test accuracy : 0.961187

Epoch :  53 loss training:  0.7073419155203737 Time :  295
accuracy train: 0.993133 val: 0.963636 test: 0.959817
max validation accuracy : 0.969091 max acc epoch : 42 test accuracy : 0.961187

Epoch :  54 loss training:  1.4138522332068533 Time :  300
accuracy train: 0.996970 val: 0.949091 test: 0.953425
max validation accuracy : 0.969091 max acc epoch : 42 test accuracy : 0.961187

Epoch :  55 loss training:  1.200097268272657 Time :  306
accuracy train: 0.996768 val: 0.965455 test: 0.965297
max validation accuracy : 0.969091 max acc epoch : 42 test accuracy : 0.961187

Epoch :  56 loss training:  0.8039425601018593 Time :  311
accuracy train: 0.997576 val: 0.961818 test: 0.959817
max validation accuracy : 0.969091 max acc epoch : 42 test accuracy : 0.961187

Epoch :  57 loss training:  1.0108859385945834 Time :  315
accuracy train: 0.996162 val: 0.956364 test: 0.959817
max validation accuracy : 0.969091 max acc epoch : 42 test accuracy : 0.961187

Epoch :  58 loss training:  0.6170497496641474 Time :  321
accuracy train: 0.996970 val: 0.956364 test: 0.959361
max validation accuracy : 0.969091 max acc epoch : 42 test accuracy : 0.961187

Epoch :  59 loss training:  0.6493811446998734 Time :  326
accuracy train: 0.997374 val: 0.954545 test: 0.958904
max validation accuracy : 0.969091 max acc epoch : 42 test accuracy : 0.961187

Epoch :  60 loss training:  0.44423711436684243 Time :  331
accuracy train: 0.996970 val: 0.958182 test: 0.959817
max validation accuracy : 0.969091 max acc epoch : 42 test accuracy : 0.961187

Epoch :  61 loss training:  1.0283969689335208 Time :  337
accuracy train: 0.987275 val: 0.938182 test: 0.957078
max validation accuracy : 0.969091 max acc epoch : 42 test accuracy : 0.961187

Epoch :  62 loss training:  1.226410634815693 Time :  341
accuracy train: 0.991719 val: 0.947273 test: 0.957991
max validation accuracy : 0.969091 max acc epoch : 42 test accuracy : 0.961187

Epoch :  63 loss training:  0.5659588700946188 Time :  346
accuracy train: 0.994749 val: 0.952727 test: 0.962557
max validation accuracy : 0.969091 max acc epoch : 42 test accuracy : 0.961187

========================================================================================================================================================================================================
max acc epoch :  42
max validation accuracy :  0.9690909090909091
test accuracy :  0.9611872146118722
last test_accuracy :  0.9625570776255707
========================================================================================================================================================================================================

