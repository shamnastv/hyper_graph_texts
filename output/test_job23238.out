date and time :  Tue Jan 26 20:27:44 2021
Namespace(batch_size=16, dataset='R52', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=300, lda=False, lr=0.0005, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=1e-05)
device :  cuda:0
HGNNModel(
  (word_embeddings): Embedding(9333, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=300, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=300, out_features=300, bias=True)
        (W_hr): Linear(in_features=300, out_features=300, bias=True)
        (W_in): Linear(in_features=300, out_features=300, bias=True)
        (W_hn): Linear(in_features=300, out_features=300, bias=True)
        (W_iz): Linear(in_features=300, out_features=300, bias=True)
        (W_hz): Linear(in_features=300, out_features=300, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=300, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=300, out_features=300, bias=True)
        (W_hr): Linear(in_features=300, out_features=300, bias=True)
        (W_in): Linear(in_features=300, out_features=300, bias=True)
        (W_hn): Linear(in_features=300, out_features=300, bias=True)
        (W_iz): Linear(in_features=300, out_features=300, bias=True)
        (W_hz): Linear(in_features=300, out_features=300, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=52, bias=True)
    (1): Linear(in_features=300, out_features=52, bias=True)
    (2): Linear(in_features=300, out_features=52, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  283.0362211987376 Time :  18
accuracy train: 0.926829 val: 0.893293 test: 0.893385
max validation accuracy : 0.893293 max acc epoch : 1.000000 test accuracy : 0.893385

Epoch :  2 loss training:  110.29603011719882 Time :  78
accuracy train: 0.942581 val: 0.894817 test: 0.912062
max validation accuracy : 0.894817 max acc epoch : 2.000000 test accuracy : 0.912062

Epoch :  3 loss training:  74.80792361288331 Time :  88
accuracy train: 0.978320 val: 0.929878 test: 0.926848
max validation accuracy : 0.929878 max acc epoch : 3.000000 test accuracy : 0.926848

Epoch :  4 loss training:  57.35595067916438 Time :  99
accuracy train: 0.982893 val: 0.939024 test: 0.931907
max validation accuracy : 0.939024 max acc epoch : 4.000000 test accuracy : 0.931907

Epoch :  5 loss training:  44.0418599905679 Time :  110
accuracy train: 0.986789 val: 0.943598 test: 0.940078
max validation accuracy : 0.943598 max acc epoch : 5.000000 test accuracy : 0.940078

Epoch :  6 loss training:  26.54393991502002 Time :  121
accuracy train: 0.986958 val: 0.931402 test: 0.936187
max validation accuracy : 0.943598 max acc epoch : 5.000000 test accuracy : 0.940078

Epoch :  7 loss training:  20.786644220526796 Time :  131
accuracy train: 0.994580 val: 0.940549 test: 0.940078
max validation accuracy : 0.943598 max acc epoch : 5.000000 test accuracy : 0.940078

Epoch :  8 loss training:  20.282723507494666 Time :  141
accuracy train: 0.995935 val: 0.939024 test: 0.938521
max validation accuracy : 0.943598 max acc epoch : 5.000000 test accuracy : 0.940078

Epoch :  9 loss training:  17.426459964655805 Time :  152
accuracy train: 0.994580 val: 0.943598 test: 0.939689
max validation accuracy : 0.943598 max acc epoch : 5.000000 test accuracy : 0.940078

Epoch :  10 loss training:  15.028758888933226 Time :  161
accuracy train: 0.996782 val: 0.945122 test: 0.942023
max validation accuracy : 0.945122 max acc epoch : 10.000000 test accuracy : 0.942023

Epoch :  11 loss training:  10.945486908061866 Time :  171
accuracy train: 0.997967 val: 0.945122 test: 0.942802
max validation accuracy : 0.945122 max acc epoch : 10.000000 test accuracy : 0.942023

Epoch :  12 loss training:  9.774474008016114 Time :  181
accuracy train: 0.997798 val: 0.940549 test: 0.937743
max validation accuracy : 0.945122 max acc epoch : 10.000000 test accuracy : 0.942023

Epoch :  13 loss training:  8.85647805435292 Time :  191
accuracy train: 0.997629 val: 0.946646 test: 0.941634
max validation accuracy : 0.946646 max acc epoch : 13.000000 test accuracy : 0.941634

Epoch :  14 loss training:  7.857935010353685 Time :  200
accuracy train: 0.997121 val: 0.945122 test: 0.938911
max validation accuracy : 0.946646 max acc epoch : 13.000000 test accuracy : 0.941634

Epoch :  15 loss training:  7.800860776882473 Time :  210
accuracy train: 0.997798 val: 0.948171 test: 0.942802
max validation accuracy : 0.948171 max acc epoch : 15.000000 test accuracy : 0.942802

Epoch :  16 loss training:  5.272573425852897 Time :  220
accuracy train: 0.998476 val: 0.945122 test: 0.942023
max validation accuracy : 0.948171 max acc epoch : 15.000000 test accuracy : 0.942802

Epoch :  17 loss training:  5.076348617818439 Time :  231
accuracy train: 0.998306 val: 0.945122 test: 0.942412
max validation accuracy : 0.948171 max acc epoch : 15.000000 test accuracy : 0.942802

Epoch :  18 loss training:  5.41140766548142 Time :  241
accuracy train: 0.998476 val: 0.940549 test: 0.942802
max validation accuracy : 0.948171 max acc epoch : 15.000000 test accuracy : 0.942802

Epoch :  19 loss training:  5.009414704287337 Time :  252
accuracy train: 0.997967 val: 0.943598 test: 0.943191
max validation accuracy : 0.948171 max acc epoch : 15.000000 test accuracy : 0.942802

Epoch :  20 loss training:  5.67050430648851 Time :  262
accuracy train: 0.998476 val: 0.943598 test: 0.944358
max validation accuracy : 0.948171 max acc epoch : 15.000000 test accuracy : 0.942802

Epoch :  21 loss training:  4.572345676881014 Time :  271
accuracy train: 0.998476 val: 0.946646 test: 0.943191
max validation accuracy : 0.948171 max acc epoch : 15.000000 test accuracy : 0.942802

Epoch :  22 loss training:  4.266918963787248 Time :  281
accuracy train: 0.998306 val: 0.942073 test: 0.944747
max validation accuracy : 0.948171 max acc epoch : 15.000000 test accuracy : 0.942802

Epoch :  23 loss training:  4.386249567727646 Time :  291
accuracy train: 0.998645 val: 0.942073 test: 0.943969
max validation accuracy : 0.948171 max acc epoch : 15.000000 test accuracy : 0.942802

Epoch :  24 loss training:  3.923150921376873 Time :  302
accuracy train: 0.998476 val: 0.943598 test: 0.943969
max validation accuracy : 0.948171 max acc epoch : 15.000000 test accuracy : 0.942802

Epoch :  25 loss training:  4.30493149655922 Time :  313
accuracy train: 0.998306 val: 0.940549 test: 0.943580
max validation accuracy : 0.948171 max acc epoch : 15.000000 test accuracy : 0.942802

Epoch :  26 loss training:  3.8235014031588435 Time :  324
accuracy train: 0.998476 val: 0.946646 test: 0.942412
max validation accuracy : 0.948171 max acc epoch : 15.000000 test accuracy : 0.942802

Epoch :  27 loss training:  2.9918446052270156 Time :  335
accuracy train: 0.998476 val: 0.939024 test: 0.943580
max validation accuracy : 0.948171 max acc epoch : 15.000000 test accuracy : 0.942802

Epoch :  28 loss training:  3.375205535715395 Time :  346
accuracy train: 0.998645 val: 0.940549 test: 0.944747
max validation accuracy : 0.948171 max acc epoch : 15.000000 test accuracy : 0.942802

Epoch :  29 loss training:  3.12015389120279 Time :  357
accuracy train: 0.998476 val: 0.942073 test: 0.943580
max validation accuracy : 0.948171 max acc epoch : 15.000000 test accuracy : 0.942802

Epoch :  30 loss training:  3.387648475674723 Time :  366
accuracy train: 0.998645 val: 0.942073 test: 0.945136
max validation accuracy : 0.948171 max acc epoch : 15.000000 test accuracy : 0.942802

Epoch :  31 loss training:  2.7648704759481006 Time :  376
accuracy train: 0.998645 val: 0.943598 test: 0.944358
max validation accuracy : 0.948171 max acc epoch : 15.000000 test accuracy : 0.942802

Epoch :  32 loss training:  3.0191140609131253 Time :  385
accuracy train: 0.998645 val: 0.945122 test: 0.945136
max validation accuracy : 0.948171 max acc epoch : 15.000000 test accuracy : 0.942802

Epoch :  33 loss training:  3.3790143074365915 Time :  396
accuracy train: 0.998476 val: 0.943598 test: 0.943580
max validation accuracy : 0.948171 max acc epoch : 15.000000 test accuracy : 0.942802

Epoch :  34 loss training:  3.571790591957324 Time :  407
accuracy train: 0.998645 val: 0.942073 test: 0.943969
max validation accuracy : 0.948171 max acc epoch : 15.000000 test accuracy : 0.942802

Epoch :  35 loss training:  3.1909544257259768 Time :  418
accuracy train: 0.998645 val: 0.945122 test: 0.944358
max validation accuracy : 0.948171 max acc epoch : 15.000000 test accuracy : 0.942802

Epoch :  36 loss training:  2.870801895734985 Time :  428
accuracy train: 0.998645 val: 0.943598 test: 0.943191
max validation accuracy : 0.948171 max acc epoch : 15.000000 test accuracy : 0.942802

========================================================================================================================================================================================================
max acc epoch :  15
max validation accuracy :  0.948170731707317
test accuracy :  0.9428015564202334
latest_test_accuracy :  0.9431906614785992
========================================================================================================================================================================================================

