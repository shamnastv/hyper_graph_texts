

date and time :  Tue May 25 23:54:54 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=2, random_vec=False, seed=612, weight_decay=1e-08)
device :  cuda:0
Counter({0: 2607, 1: 2532, 2: 2261})

Epoch :  1 loss training:  242.02621388435364 Time :  213
accuracy train: 0.586036 val: 0.608955 test: 0.550334
max validation accuracy : 0.608955 max acc epoch : 1 test accuracy : 0.550334
Counter({1: 2730, 0: 2605, 2: 2065})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  163.46613121032715 Time :  320
accuracy train: 0.669755 val: 0.632836 test: 0.611180
max validation accuracy : 0.632836 max acc epoch : 2 test accuracy : 0.611180
Counter({1: 4618, 2: 1431, 0: 1351})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  140.20570215582848 Time :  448
accuracy train: 0.709464 val: 0.683582 test: 0.645313
max validation accuracy : 0.683582 max acc epoch : 3 test accuracy : 0.645313
Counter({0: 4473, 2: 1657, 1: 1270})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  117.71481987833977 Time :  550
accuracy train: 0.739246 val: 0.683582 test: 0.667821
max validation accuracy : 0.683582 max acc epoch : 3 test accuracy : 0.645313
Counter({0: 3623, 1: 2255, 2: 1522})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  105.14015257358551 Time :  690
accuracy train: 0.792522 val: 0.701493 test: 0.673510
max validation accuracy : 0.701493 max acc epoch : 5 test accuracy : 0.673510
Counter({1: 3612, 0: 2397, 2: 1391})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  101.29047530889511 Time :  801
accuracy train: 0.790867 val: 0.692537 test: 0.678457
max validation accuracy : 0.701493 max acc epoch : 5 test accuracy : 0.673510
Counter({0: 3525, 2: 2457, 1: 1418})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  88.24680379033089 Time :  922
accuracy train: 0.823296 val: 0.725373 test: 0.695523
max validation accuracy : 0.725373 max acc epoch : 7 test accuracy : 0.695523
Counter({0: 3550, 1: 2439, 2: 1411})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  85.63959541916847 Time :  1056
accuracy train: 0.827267 val: 0.713433 test: 0.690824
max validation accuracy : 0.725373 max acc epoch : 7 test accuracy : 0.695523
Counter({1: 3644, 0: 2365, 2: 1391})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  81.64172233641148 Time :  1174
accuracy train: 0.847783 val: 0.710448 test: 0.700470
max validation accuracy : 0.725373 max acc epoch : 7 test accuracy : 0.695523
Counter({1: 3711, 0: 2296, 2: 1393})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  74.37139946222305 Time :  1290
accuracy train: 0.854401 val: 0.722388 test: 0.698739
max validation accuracy : 0.725373 max acc epoch : 7 test accuracy : 0.695523
Counter({1: 3684, 2: 2320, 0: 1396})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  73.43969956040382 Time :  1398
accuracy train: 0.857710 val: 0.725373 test: 0.702943
max validation accuracy : 0.725373 max acc epoch : 7 test accuracy : 0.695523
Counter({0: 3691, 2: 2312, 1: 1397})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  70.38862937688828 Time :  1501
accuracy train: 0.858703 val: 0.725373 test: 0.701212
max validation accuracy : 0.725373 max acc epoch : 7 test accuracy : 0.695523
Counter({0: 3673, 2: 2333, 1: 1394})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  69.57444830238819 Time :  1618
accuracy train: 0.865652 val: 0.731343 test: 0.703933
max validation accuracy : 0.731343 max acc epoch : 13 test accuracy : 0.703933
Counter({0: 3661, 2: 2344, 1: 1395})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  67.46606382727623 Time :  1734
accuracy train: 0.865652 val: 0.737313 test: 0.706901
max validation accuracy : 0.737313 max acc epoch : 14 test accuracy : 0.706901
Counter({2: 3663, 0: 2346, 1: 1391})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  68.96582867205143 Time :  1863
accuracy train: 0.869623 val: 0.731343 test: 0.703933
max validation accuracy : 0.737313 max acc epoch : 14 test accuracy : 0.706901
Counter({0: 3653, 2: 2358, 1: 1389})

Epoch :  16 loss training:  64.18830360472202 Time :  1974
accuracy train: 0.871939 val: 0.740299 test: 0.703685
max validation accuracy : 0.740299 max acc epoch : 16 test accuracy : 0.703685
Counter({0: 3659, 2: 2350, 1: 1391})

Epoch :  17 loss training:  64.39646878838539 Time :  2103
accuracy train: 0.876572 val: 0.734328 test: 0.704675
max validation accuracy : 0.740299 max acc epoch : 16 test accuracy : 0.703685
Counter({2: 3665, 1: 2345, 0: 1390})

Epoch :  18 loss training:  64.18372452259064 Time :  2219
accuracy train: 0.879550 val: 0.734328 test: 0.705417
max validation accuracy : 0.740299 max acc epoch : 16 test accuracy : 0.703685
Counter({0: 3667, 2: 2348, 1: 1385})

Epoch :  19 loss training:  61.586240872740746 Time :  2364
accuracy train: 0.887823 val: 0.728358 test: 0.709374
max validation accuracy : 0.740299 max acc epoch : 16 test accuracy : 0.703685
Counter({2: 3666, 1: 2351, 0: 1383})

Epoch :  20 loss training:  60.3030057400465 Time :  2471
accuracy train: 0.888484 val: 0.737313 test: 0.708385
max validation accuracy : 0.740299 max acc epoch : 16 test accuracy : 0.703685
Counter({2: 3665, 1: 2352, 0: 1383})

Epoch :  21 loss training:  59.79497668147087 Time :  2596
accuracy train: 0.888484 val: 0.716418 test: 0.700223
max validation accuracy : 0.740299 max acc epoch : 16 test accuracy : 0.703685
Counter({2: 3664, 0: 2355, 1: 1381})

Epoch :  22 loss training:  58.95124959945679 Time :  2693
accuracy train: 0.894110 val: 0.740299 test: 0.708138
max validation accuracy : 0.740299 max acc epoch : 16 test accuracy : 0.703685
Counter({1: 3663, 0: 2357, 2: 1380})

Epoch :  23 loss training:  57.58720353245735 Time :  2806
accuracy train: 0.898081 val: 0.734328 test: 0.709869
max validation accuracy : 0.740299 max acc epoch : 16 test accuracy : 0.703685
Counter({2: 3659, 1: 2365, 0: 1376})

Epoch :  24 loss training:  54.36686822772026 Time :  2895
accuracy train: 0.907015 val: 0.728358 test: 0.710364
max validation accuracy : 0.740299 max acc epoch : 16 test accuracy : 0.703685
Counter({0: 3638, 2: 2384, 1: 1378})

Epoch :  25 loss training:  53.77317090332508 Time :  2999
accuracy train: 0.908339 val: 0.743284 test: 0.708138
max validation accuracy : 0.743284 max acc epoch : 25 test accuracy : 0.708138
Counter({2: 3628, 1: 2390, 0: 1382})

Epoch :  26 loss training:  54.76987732946873 Time :  3118
accuracy train: 0.914957 val: 0.719403 test: 0.712590
max validation accuracy : 0.743284 max acc epoch : 25 test accuracy : 0.708138
Counter({2: 3622, 1: 2401, 0: 1377})

Epoch :  27 loss training:  53.31419287621975 Time :  3247
accuracy train: 0.917273 val: 0.734328 test: 0.710116
max validation accuracy : 0.743284 max acc epoch : 25 test accuracy : 0.708138
Counter({0: 3612, 1: 2412, 2: 1376})

Epoch :  28 loss training:  52.32353504002094 Time :  3355
accuracy train: 0.919921 val: 0.749254 test: 0.711600
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.711600
Counter({0: 3611, 1: 2423, 2: 1366})

Epoch :  29 loss training:  49.07539843022823 Time :  3475
accuracy train: 0.924553 val: 0.731343 test: 0.709869
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.711600
Counter({2: 3611, 1: 2422, 0: 1367})

Epoch :  30 loss training:  46.41726998984814 Time :  3578
accuracy train: 0.928524 val: 0.740299 test: 0.709622
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.711600
Counter({0: 3607, 1: 2425, 2: 1368})

Epoch :  31 loss training:  47.63856826722622 Time :  3689
accuracy train: 0.931171 val: 0.734328 test: 0.712590
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.711600
Counter({2: 3611, 1: 2426, 0: 1363})

Epoch :  32 loss training:  45.68873345851898 Time :  3801
accuracy train: 0.937459 val: 0.740299 test: 0.708632
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.711600
Counter({0: 3614, 2: 2421, 1: 1365})

Epoch :  33 loss training:  44.540137618780136 Time :  3927
accuracy train: 0.936797 val: 0.740299 test: 0.708385
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.711600
Counter({0: 3614, 2: 2425, 1: 1361})

Epoch :  34 loss training:  45.72703103721142 Time :  4028
accuracy train: 0.938782 val: 0.731343 test: 0.710364
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.711600
Counter({2: 3612, 0: 2432, 1: 1356})

Epoch :  35 loss training:  43.02980934083462 Time :  4147
accuracy train: 0.946062 val: 0.740299 test: 0.706653
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.711600
Counter({2: 3614, 0: 2431, 1: 1355})

Epoch :  36 loss training:  40.38619402050972 Time :  4242
accuracy train: 0.949371 val: 0.728358 test: 0.710364
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.711600
Counter({0: 3607, 2: 2438, 1: 1355})

Epoch :  37 loss training:  41.2203549221158 Time :  4348
accuracy train: 0.952019 val: 0.740299 test: 0.711848
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.711600
Counter({1: 3590, 0: 2455, 2: 1355})

Epoch :  38 loss training:  38.869011893868446 Time :  4471
accuracy train: 0.954997 val: 0.743284 test: 0.714568
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.711600
Counter({0: 3588, 1: 2459, 2: 1353})

Epoch :  39 loss training:  37.668162405490875 Time :  4575
accuracy train: 0.955659 val: 0.752239 test: 0.713826
max validation accuracy : 0.752239 max acc epoch : 39 test accuracy : 0.713826
Counter({2: 3593, 1: 2465, 0: 1342})

Epoch :  40 loss training:  37.433888010680676 Time :  4694
accuracy train: 0.958968 val: 0.752239 test: 0.711353
max validation accuracy : 0.752239 max acc epoch : 39 test accuracy : 0.713826
Counter({0: 3599, 1: 2458, 2: 1343})

Epoch :  41 loss training:  37.10987148433924 Time :  4799
accuracy train: 0.960291 val: 0.740299 test: 0.708138
max validation accuracy : 0.752239 max acc epoch : 39 test accuracy : 0.713826
Counter({0: 3599, 1: 2460, 2: 1341})

Epoch :  42 loss training:  35.52036225795746 Time :  4891
accuracy train: 0.966578 val: 0.743284 test: 0.708385
max validation accuracy : 0.752239 max acc epoch : 39 test accuracy : 0.713826
Counter({2: 3600, 1: 2459, 0: 1341})

Epoch :  43 loss training:  33.48021248728037 Time :  5017
accuracy train: 0.963600 val: 0.743284 test: 0.708138
max validation accuracy : 0.752239 max acc epoch : 39 test accuracy : 0.713826
Counter({2: 3592, 0: 2464, 1: 1344})

Epoch :  44 loss training:  32.913429372012615 Time :  5131
accuracy train: 0.966578 val: 0.752239 test: 0.709869
max validation accuracy : 0.752239 max acc epoch : 39 test accuracy : 0.713826
Counter({0: 3589, 2: 2466, 1: 1345})

Epoch :  45 loss training:  32.368988171219826 Time :  5226
accuracy train: 0.969226 val: 0.743284 test: 0.710858
max validation accuracy : 0.752239 max acc epoch : 39 test accuracy : 0.713826
Counter({0: 3589, 1: 2464, 2: 1347})

Epoch :  46 loss training:  31.447291918098927 Time :  5335
accuracy train: 0.973858 val: 0.749254 test: 0.710611
max validation accuracy : 0.752239 max acc epoch : 39 test accuracy : 0.713826
Counter({0: 3588, 2: 2469, 1: 1343})

Epoch :  47 loss training:  31.49877118319273 Time :  5422
accuracy train: 0.974851 val: 0.758209 test: 0.710364
max validation accuracy : 0.758209 max acc epoch : 47 test accuracy : 0.710364
Counter({0: 3588, 1: 2469, 2: 1343})

Epoch :  48 loss training:  30.073192320764065 Time :  5516
accuracy train: 0.974189 val: 0.731343 test: 0.710611
max validation accuracy : 0.758209 max acc epoch : 47 test accuracy : 0.710364
Counter({2: 3590, 0: 2470, 1: 1340})

Epoch :  49 loss training:  29.688643641769886 Time :  5638
accuracy train: 0.977498 val: 0.752239 test: 0.708880
max validation accuracy : 0.758209 max acc epoch : 47 test accuracy : 0.710364
Counter({2: 3590, 1: 2471, 0: 1339})

Epoch :  50 loss training:  28.724245194345713 Time :  5786
accuracy train: 0.981469 val: 0.740299 test: 0.709127
max validation accuracy : 0.758209 max acc epoch : 47 test accuracy : 0.710364
Counter({0: 3588, 1: 2470, 2: 1342})

Epoch :  51 loss training:  28.188697814941406 Time :  5907
accuracy train: 0.982793 val: 0.749254 test: 0.707395
max validation accuracy : 0.758209 max acc epoch : 47 test accuracy : 0.710364
Counter({1: 3577, 0: 2480, 2: 1343})

Epoch :  52 loss training:  26.859137441962957 Time :  6032
accuracy train: 0.983124 val: 0.746269 test: 0.715310
max validation accuracy : 0.758209 max acc epoch : 47 test accuracy : 0.710364
Counter({2: 3586, 0: 2482, 1: 1332})

Epoch :  53 loss training:  26.076063808053732 Time :  6130
accuracy train: 0.984778 val: 0.734328 test: 0.709374
max validation accuracy : 0.758209 max acc epoch : 47 test accuracy : 0.710364
Counter({2: 3583, 1: 2487, 0: 1330})

Epoch :  54 loss training:  25.0631844997406 Time :  6246
accuracy train: 0.983124 val: 0.761194 test: 0.711848
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({2: 3585, 1: 2485, 0: 1330})

Epoch :  55 loss training:  24.478414930403233 Time :  6358
accuracy train: 0.984778 val: 0.755224 test: 0.714568
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3584, 2: 2487, 1: 1329})

Epoch :  56 loss training:  23.782834108918905 Time :  6462
accuracy train: 0.986433 val: 0.755224 test: 0.716547
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({2: 3581, 0: 2492, 1: 1327})

Epoch :  57 loss training:  23.43461233191192 Time :  6579
accuracy train: 0.987426 val: 0.752239 test: 0.712590
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3578, 1: 2493, 2: 1329})

Epoch :  58 loss training:  22.689945496618748 Time :  6675
accuracy train: 0.990404 val: 0.755224 test: 0.714321
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({2: 3583, 0: 2490, 1: 1327})

Epoch :  59 loss training:  21.465806260704994 Time :  6781
accuracy train: 0.988749 val: 0.758209 test: 0.713579
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3589, 1: 2485, 2: 1326})

Epoch :  60 loss training:  21.27579971961677 Time :  6904
accuracy train: 0.989080 val: 0.740299 test: 0.715063
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3588, 2: 2488, 1: 1324})

Epoch :  61 loss training:  20.84092602878809 Time :  7013
accuracy train: 0.987095 val: 0.746269 test: 0.715063
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({1: 3584, 0: 2492, 2: 1324})

Epoch :  62 loss training:  19.531532175838947 Time :  7146
accuracy train: 0.992720 val: 0.731343 test: 0.714074
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3588, 1: 2489, 2: 1323})

Epoch :  63 loss training:  20.798847500234842 Time :  7239
accuracy train: 0.991727 val: 0.734328 test: 0.712342
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({2: 3591, 0: 2488, 1: 1321})

Epoch :  64 loss training:  18.92064912058413 Time :  7340
accuracy train: 0.992389 val: 0.746269 test: 0.711848
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3593, 1: 2487, 2: 1320})

Epoch :  65 loss training:  18.26035077497363 Time :  7462
accuracy train: 0.992720 val: 0.746269 test: 0.714074
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3589, 2: 2491, 1: 1320})

Epoch :  66 loss training:  17.899147022515535 Time :  7589
accuracy train: 0.993713 val: 0.734328 test: 0.708880
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3588, 2: 2492, 1: 1320})

Epoch :  67 loss training:  16.819331768900156 Time :  7698
accuracy train: 0.994044 val: 0.737313 test: 0.712342
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3593, 1: 2489, 2: 1318})

Epoch :  68 loss training:  16.68370996788144 Time :  7796
accuracy train: 0.995036 val: 0.749254 test: 0.713579
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3592, 2: 2490, 1: 1318})

Epoch :  69 loss training:  15.761201489716768 Time :  7903
accuracy train: 0.996691 val: 0.740299 test: 0.712342
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3576, 1: 2505, 2: 1319})

Epoch :  70 loss training:  15.131547318771482 Time :  8015
accuracy train: 0.996360 val: 0.743284 test: 0.710858
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3579, 1: 2502, 2: 1319})

Epoch :  71 loss training:  16.292599871754646 Time :  8108
accuracy train: 0.996029 val: 0.734328 test: 0.714321
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({2: 3571, 1: 2503, 0: 1326})

Epoch :  72 loss training:  15.013029973953962 Time :  8221
accuracy train: 0.995698 val: 0.743284 test: 0.715063
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3572, 1: 2501, 2: 1327})

Epoch :  73 loss training:  14.41681731492281 Time :  8360
accuracy train: 0.997022 val: 0.737313 test: 0.714568
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3570, 1: 2502, 2: 1328})

Epoch :  74 loss training:  14.516513967886567 Time :  8470
accuracy train: 0.997022 val: 0.740299 test: 0.712590
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3570, 1: 2501, 2: 1329})

Epoch :  75 loss training:  14.467572659254074 Time :  8588
accuracy train: 0.997684 val: 0.728358 test: 0.708880
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3566, 2: 2505, 1: 1329})

Epoch :  76 loss training:  12.938861122354865 Time :  8688
accuracy train: 0.997684 val: 0.737313 test: 0.713332
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3569, 1: 2501, 2: 1330})

Epoch :  77 loss training:  14.425920274108648 Time :  8798
accuracy train: 0.998345 val: 0.731343 test: 0.710611
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3565, 1: 2502, 2: 1333})

Epoch :  78 loss training:  13.307713935151696 Time :  8915
accuracy train: 0.997022 val: 0.740299 test: 0.710364
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3564, 1: 2503, 2: 1333})

Epoch :  79 loss training:  11.905857617035508 Time :  9022
accuracy train: 0.997684 val: 0.728358 test: 0.713332
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3565, 1: 2503, 2: 1332})

Epoch :  80 loss training:  13.012775289826095 Time :  9135
accuracy train: 0.998345 val: 0.737313 test: 0.711353
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({1: 3563, 2: 2505, 0: 1332})

Epoch :  81 loss training:  12.286860005930066 Time :  9221
accuracy train: 0.997684 val: 0.752239 test: 0.716300
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3565, 2: 2502, 1: 1333})

Epoch :  82 loss training:  11.178430512547493 Time :  9320
accuracy train: 0.997684 val: 0.728358 test: 0.715558
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3565, 1: 2502, 2: 1333})

Epoch :  83 loss training:  11.696889203041792 Time :  9427
accuracy train: 0.997684 val: 0.728358 test: 0.713084
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3554, 1: 2513, 2: 1333})

Epoch :  84 loss training:  10.665592236444354 Time :  9532
accuracy train: 0.998345 val: 0.731343 test: 0.710116
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({2: 3557, 1: 2511, 0: 1332})

Epoch :  85 loss training:  11.283190618269145 Time :  9645
accuracy train: 0.998345 val: 0.734328 test: 0.709127
max validation accuracy : 0.761194 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3557, 2: 2512, 1: 1331})

========================================================================================================================================================================================================
max acc epoch :  54
max validation accuracy :  0.7611940298507462
test accuracy :  0.7118476378926539
last test_accuracy :  0.7091268859757606
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=2, random_vec=False, seed=612, weight_decay=1e-08)
device :  cuda:0
Counter({0: 2607, 1: 2532, 2: 2261})

Epoch :  1 loss training:  241.164235830307 Time :  9923
accuracy train: 0.590668 val: 0.597015 test: 0.558744
max validation accuracy : 0.597015 max acc epoch : 1 test accuracy : 0.558744
Counter({0: 3987, 1: 2102, 2: 1311})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  162.33937793970108 Time :  10028
accuracy train: 0.675050 val: 0.641791 test: 0.623794
max validation accuracy : 0.641791 max acc epoch : 2 test accuracy : 0.623794
Counter({1: 4626, 2: 1470, 0: 1304})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  140.74807807803154 Time :  10153
accuracy train: 0.708471 val: 0.683582 test: 0.637151
max validation accuracy : 0.683582 max acc epoch : 3 test accuracy : 0.637151
Counter({0: 4761, 1: 1371, 2: 1268})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  116.05258074402809 Time :  10263
accuracy train: 0.737591 val: 0.686567 test: 0.663616
max validation accuracy : 0.686567 max acc epoch : 4 test accuracy : 0.663616
Counter({0: 3496, 2: 2452, 1: 1452})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  106.22915771603584 Time :  10371
accuracy train: 0.785572 val: 0.722388 test: 0.674994
max validation accuracy : 0.722388 max acc epoch : 5 test accuracy : 0.674994
Counter({2: 3619, 0: 2344, 1: 1437})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  100.55416187644005 Time :  10465
accuracy train: 0.809067 val: 0.707463 test: 0.679941
max validation accuracy : 0.722388 max acc epoch : 5 test accuracy : 0.674994
Counter({0: 3553, 1: 2432, 2: 1415})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  89.10295960307121 Time :  10612
accuracy train: 0.813369 val: 0.731343 test: 0.687114
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.687114
Counter({0: 3632, 2: 2458, 1: 1310})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  85.65321108698845 Time :  10716
accuracy train: 0.820979 val: 0.716418 test: 0.691566
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.687114
Counter({0: 3609, 2: 2487, 1: 1304})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  82.14931592345238 Time :  10839
accuracy train: 0.840503 val: 0.719403 test: 0.698244
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.687114
Counter({1: 3580, 0: 2495, 2: 1325})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  76.6783744096756 Time :  10936
accuracy train: 0.851754 val: 0.731343 test: 0.701954
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.687114
Counter({2: 3600, 1: 2486, 0: 1314})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  76.79560133814812 Time :  11054
accuracy train: 0.849437 val: 0.725373 test: 0.702201
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.687114
Counter({0: 3602, 1: 2489, 2: 1309})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  70.73232570290565 Time :  11159
accuracy train: 0.859365 val: 0.728358 test: 0.702201
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.687114
Counter({0: 3594, 1: 2496, 2: 1310})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  69.72499969601631 Time :  11262
accuracy train: 0.863336 val: 0.725373 test: 0.701707
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.687114
Counter({1: 3592, 0: 2496, 2: 1312})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  69.28460511565208 Time :  11379
accuracy train: 0.863997 val: 0.725373 test: 0.701707
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.687114
Counter({0: 3591, 2: 2495, 1: 1314})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  68.25623363256454 Time :  11469
accuracy train: 0.865652 val: 0.722388 test: 0.700470
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.687114
Counter({0: 3595, 1: 2492, 2: 1313})

Epoch :  16 loss training:  66.18927910923958 Time :  11557
accuracy train: 0.870615 val: 0.725373 test: 0.703933
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.687114
Counter({0: 3590, 1: 2493, 2: 1317})

Epoch :  17 loss training:  65.35829459130764 Time :  11664
accuracy train: 0.868299 val: 0.725373 test: 0.705417
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.687114
Counter({0: 3588, 1: 2502, 2: 1310})

Epoch :  18 loss training:  65.7306075245142 Time :  11757
accuracy train: 0.877895 val: 0.728358 test: 0.702201
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.687114
Counter({2: 3582, 1: 2507, 0: 1311})

Epoch :  19 loss training:  62.67261826992035 Time :  11865
accuracy train: 0.879550 val: 0.731343 test: 0.704427
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.687114
Counter({0: 3588, 2: 2503, 1: 1309})

Epoch :  20 loss training:  63.38820704817772 Time :  11992
accuracy train: 0.887492 val: 0.728358 test: 0.703438
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.687114
Counter({0: 3582, 1: 2506, 2: 1312})

Epoch :  21 loss training:  60.05659641325474 Time :  12096
accuracy train: 0.886499 val: 0.722388 test: 0.704180
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.687114
Counter({2: 3583, 0: 2508, 1: 1309})

Epoch :  22 loss training:  60.17787815257907 Time :  12201
accuracy train: 0.889808 val: 0.731343 test: 0.709622
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.687114
Counter({0: 3583, 2: 2503, 1: 1314})

Epoch :  23 loss training:  58.77801574021578 Time :  12327
accuracy train: 0.895103 val: 0.728358 test: 0.707148
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.687114
Counter({0: 3583, 1: 2504, 2: 1313})

Epoch :  24 loss training:  54.37137854099274 Time :  12440
accuracy train: 0.898081 val: 0.731343 test: 0.706901
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.687114
Counter({2: 3579, 1: 2509, 0: 1312})

Epoch :  25 loss training:  53.96924303472042 Time :  12562
accuracy train: 0.899735 val: 0.734328 test: 0.707148
max validation accuracy : 0.734328 max acc epoch : 25 test accuracy : 0.707148
Counter({2: 3571, 1: 2511, 0: 1318})

Epoch :  26 loss training:  52.20437744259834 Time :  12687
accuracy train: 0.908670 val: 0.734328 test: 0.708632
max validation accuracy : 0.734328 max acc epoch : 25 test accuracy : 0.707148
Counter({2: 3571, 1: 2516, 0: 1313})

Epoch :  27 loss training:  51.45372036099434 Time :  12789
accuracy train: 0.912972 val: 0.734328 test: 0.705664
max validation accuracy : 0.734328 max acc epoch : 25 test accuracy : 0.707148
Counter({2: 3567, 1: 2522, 0: 1311})

Epoch :  28 loss training:  50.911052122712135 Time :  12905
accuracy train: 0.915288 val: 0.737313 test: 0.705169
max validation accuracy : 0.737313 max acc epoch : 28 test accuracy : 0.705169
Counter({0: 3578, 1: 2521, 2: 1301})

Epoch :  29 loss training:  49.8365253508091 Time :  13020
accuracy train: 0.915619 val: 0.737313 test: 0.707643
max validation accuracy : 0.737313 max acc epoch : 28 test accuracy : 0.705169
Counter({0: 3581, 2: 2514, 1: 1305})

Epoch :  30 loss training:  48.59887643158436 Time :  13140
accuracy train: 0.920913 val: 0.740299 test: 0.709622
max validation accuracy : 0.740299 max acc epoch : 30 test accuracy : 0.709622
Counter({0: 3579, 1: 2512, 2: 1309})

Epoch :  31 loss training:  47.428041622042656 Time :  13249
accuracy train: 0.928524 val: 0.737313 test: 0.704427
max validation accuracy : 0.740299 max acc epoch : 30 test accuracy : 0.709622
Counter({0: 3571, 1: 2517, 2: 1312})

Epoch :  32 loss training:  47.15039499849081 Time :  13376
accuracy train: 0.929517 val: 0.743284 test: 0.709869
max validation accuracy : 0.743284 max acc epoch : 32 test accuracy : 0.709869
Counter({0: 3567, 1: 2519, 2: 1314})

Epoch :  33 loss training:  45.23003797233105 Time :  13466
accuracy train: 0.933157 val: 0.743284 test: 0.709374
max validation accuracy : 0.743284 max acc epoch : 32 test accuracy : 0.709869
Counter({0: 3570, 2: 2521, 1: 1309})

Epoch :  34 loss training:  43.46046540141106 Time :  13585
accuracy train: 0.934150 val: 0.743284 test: 0.713332
max validation accuracy : 0.743284 max acc epoch : 32 test accuracy : 0.709869
Counter({0: 3569, 2: 2524, 1: 1307})

Epoch :  35 loss training:  43.62538067251444 Time :  13690
accuracy train: 0.941099 val: 0.740299 test: 0.709374
max validation accuracy : 0.743284 max acc epoch : 32 test accuracy : 0.709869
Counter({2: 3568, 0: 2525, 1: 1307})

Epoch :  36 loss training:  41.64986941963434 Time :  13823
accuracy train: 0.950364 val: 0.731343 test: 0.707890
max validation accuracy : 0.743284 max acc epoch : 32 test accuracy : 0.709869
Counter({0: 3570, 1: 2515, 2: 1315})

Epoch :  37 loss training:  41.192207768559456 Time :  13928
accuracy train: 0.945400 val: 0.731343 test: 0.712837
max validation accuracy : 0.743284 max acc epoch : 32 test accuracy : 0.709869
Counter({1: 3572, 0: 2513, 2: 1315})

Epoch :  38 loss training:  41.34309493750334 Time :  14046
accuracy train: 0.948379 val: 0.740299 test: 0.710858
max validation accuracy : 0.743284 max acc epoch : 32 test accuracy : 0.709869
Counter({2: 3566, 1: 2518, 0: 1316})

Epoch :  39 loss training:  39.50246638059616 Time :  14146
accuracy train: 0.954997 val: 0.740299 test: 0.705169
max validation accuracy : 0.743284 max acc epoch : 32 test accuracy : 0.709869
Counter({2: 3564, 0: 2518, 1: 1318})

Epoch :  40 loss training:  38.49505038559437 Time :  14257
accuracy train: 0.957313 val: 0.737313 test: 0.709622
max validation accuracy : 0.743284 max acc epoch : 32 test accuracy : 0.709869
Counter({0: 3557, 2: 2525, 1: 1318})

Epoch :  41 loss training:  36.330883614718914 Time :  14397
accuracy train: 0.956651 val: 0.734328 test: 0.711106
max validation accuracy : 0.743284 max acc epoch : 32 test accuracy : 0.709869
Counter({1: 3563, 0: 2520, 2: 1317})

Epoch :  42 loss training:  35.37755560129881 Time :  14523
accuracy train: 0.959629 val: 0.737313 test: 0.707890
max validation accuracy : 0.743284 max acc epoch : 32 test accuracy : 0.709869
Counter({2: 3568, 0: 2515, 1: 1317})

Epoch :  43 loss training:  34.6651274561882 Time :  14652
accuracy train: 0.961946 val: 0.734328 test: 0.711106
max validation accuracy : 0.743284 max acc epoch : 32 test accuracy : 0.709869
Counter({1: 3565, 2: 2517, 0: 1318})

Epoch :  44 loss training:  34.50546495616436 Time :  14765
accuracy train: 0.966578 val: 0.731343 test: 0.709374
max validation accuracy : 0.743284 max acc epoch : 32 test accuracy : 0.709869
Counter({2: 3560, 0: 2518, 1: 1322})

Epoch :  45 loss training:  32.86224412918091 Time :  14883
accuracy train: 0.971873 val: 0.740299 test: 0.711106
max validation accuracy : 0.743284 max acc epoch : 32 test accuracy : 0.709869
Counter({0: 3557, 2: 2519, 1: 1324})

Epoch :  46 loss training:  33.34640567749739 Time :  14994
accuracy train: 0.970549 val: 0.725373 test: 0.708385
max validation accuracy : 0.743284 max acc epoch : 32 test accuracy : 0.709869
Counter({0: 3555, 2: 2520, 1: 1325})

Epoch :  47 loss training:  30.780580937862396 Time :  15113
accuracy train: 0.969887 val: 0.734328 test: 0.709622
max validation accuracy : 0.743284 max acc epoch : 32 test accuracy : 0.709869
Counter({0: 3556, 1: 2521, 2: 1323})

Epoch :  48 loss training:  30.61677449941635 Time :  15211
accuracy train: 0.970880 val: 0.731343 test: 0.706653
max validation accuracy : 0.743284 max acc epoch : 32 test accuracy : 0.709869
Counter({0: 3568, 1: 2518, 2: 1314})

Epoch :  49 loss training:  29.355327643454075 Time :  15300
accuracy train: 0.974189 val: 0.731343 test: 0.706653
max validation accuracy : 0.743284 max acc epoch : 32 test accuracy : 0.709869
Counter({1: 3572, 0: 2520, 2: 1308})

Epoch :  50 loss training:  28.417589738965034 Time :  15398
accuracy train: 0.981469 val: 0.737313 test: 0.712095
max validation accuracy : 0.743284 max acc epoch : 32 test accuracy : 0.709869
Counter({2: 3563, 1: 2520, 0: 1317})

Epoch :  51 loss training:  27.701051473617554 Time :  15489
accuracy train: 0.980146 val: 0.737313 test: 0.706653
max validation accuracy : 0.743284 max acc epoch : 32 test accuracy : 0.709869
Counter({0: 3569, 2: 2515, 1: 1316})

Epoch :  52 loss training:  27.497579738497734 Time :  15583
accuracy train: 0.983455 val: 0.728358 test: 0.706653
max validation accuracy : 0.743284 max acc epoch : 32 test accuracy : 0.709869
Counter({0: 3577, 2: 2510, 1: 1313})

Epoch :  53 loss training:  27.32557539641857 Time :  15698
accuracy train: 0.983455 val: 0.731343 test: 0.708385
max validation accuracy : 0.743284 max acc epoch : 32 test accuracy : 0.709869
Counter({0: 3573, 2: 2515, 1: 1312})

Epoch :  54 loss training:  26.696816831827164 Time :  15794
accuracy train: 0.981800 val: 0.746269 test: 0.711848
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3581, 2: 2505, 1: 1314})

Epoch :  55 loss training:  25.62169051170349 Time :  15913
accuracy train: 0.981138 val: 0.737313 test: 0.711106
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3591, 2: 2497, 1: 1312})

Epoch :  56 loss training:  25.338663589209318 Time :  15999
accuracy train: 0.987426 val: 0.746269 test: 0.710611
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({2: 3595, 1: 2492, 0: 1313})

Epoch :  57 loss training:  24.486588049679995 Time :  16091
accuracy train: 0.989080 val: 0.722388 test: 0.712095
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({2: 3607, 1: 2490, 0: 1303})

Epoch :  58 loss training:  22.675165433436632 Time :  16192
accuracy train: 0.990073 val: 0.737313 test: 0.710858
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3611, 2: 2487, 1: 1302})

Epoch :  59 loss training:  22.697187770158052 Time :  16276
accuracy train: 0.989080 val: 0.710448 test: 0.712590
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({2: 3627, 1: 2476, 0: 1297})

Epoch :  60 loss training:  22.9993510581553 Time :  16358
accuracy train: 0.990404 val: 0.725373 test: 0.711848
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({2: 3627, 0: 2473, 1: 1300})

Epoch :  61 loss training:  21.570023339241743 Time :  16461
accuracy train: 0.992058 val: 0.731343 test: 0.710611
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({1: 3636, 0: 2470, 2: 1294})

Epoch :  62 loss training:  19.864088766276836 Time :  16550
accuracy train: 0.992389 val: 0.728358 test: 0.709869
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3646, 2: 2463, 1: 1291})

Epoch :  63 loss training:  21.340732565149665 Time :  16641
accuracy train: 0.993382 val: 0.719403 test: 0.709374
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3644, 1: 2462, 2: 1294})

Epoch :  64 loss training:  19.649725003167987 Time :  16752
accuracy train: 0.994375 val: 0.725373 test: 0.709374
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({2: 3646, 1: 2460, 0: 1294})

Epoch :  65 loss training:  19.141596276313066 Time :  16837
accuracy train: 0.994705 val: 0.722388 test: 0.712342
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({2: 3645, 0: 2461, 1: 1294})

Epoch :  66 loss training:  17.6396690197289 Time :  16947
accuracy train: 0.994705 val: 0.725373 test: 0.711600
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3644, 1: 2462, 2: 1294})

Epoch :  67 loss training:  17.78183233551681 Time :  17034
accuracy train: 0.994044 val: 0.734328 test: 0.713084
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3649, 1: 2456, 2: 1295})

Epoch :  68 loss training:  17.482883766293526 Time :  17115
accuracy train: 0.994705 val: 0.728358 test: 0.712590
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3652, 2: 2455, 1: 1293})

Epoch :  69 loss training:  16.72191963903606 Time :  17226
accuracy train: 0.995036 val: 0.728358 test: 0.709127
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3655, 2: 2454, 1: 1291})

Epoch :  70 loss training:  17.009378638118505 Time :  17313
accuracy train: 0.996360 val: 0.728358 test: 0.709622
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({1: 3663, 2: 2451, 0: 1286})

Epoch :  71 loss training:  16.458474777638912 Time :  17421
accuracy train: 0.996691 val: 0.719403 test: 0.709374
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({2: 3663, 0: 2449, 1: 1288})

Epoch :  72 loss training:  16.219135001301765 Time :  17513
accuracy train: 0.996360 val: 0.716418 test: 0.709374
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({2: 3659, 0: 2451, 1: 1290})

Epoch :  73 loss training:  14.912383009679615 Time :  17612
accuracy train: 0.996360 val: 0.719403 test: 0.708880
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3663, 1: 2448, 2: 1289})

Epoch :  74 loss training:  15.504239648580551 Time :  17706
accuracy train: 0.996029 val: 0.725373 test: 0.710611
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3665, 1: 2448, 2: 1287})

Epoch :  75 loss training:  14.63110643811524 Time :  17780
accuracy train: 0.997684 val: 0.725373 test: 0.712342
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({2: 3663, 1: 2449, 0: 1288})

Epoch :  76 loss training:  14.277122671715915 Time :  17869
accuracy train: 0.998676 val: 0.713433 test: 0.704427
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3664, 2: 2451, 1: 1285})

Epoch :  77 loss training:  13.420416623353958 Time :  17964
accuracy train: 0.998676 val: 0.707463 test: 0.711106
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({1: 3667, 0: 2449, 2: 1284})

Epoch :  78 loss training:  12.481106607243419 Time :  18056
accuracy train: 0.998676 val: 0.725373 test: 0.713084
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3671, 1: 2445, 2: 1284})

Epoch :  79 loss training:  13.49423622339964 Time :  18161
accuracy train: 0.998676 val: 0.713433 test: 0.712095
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3675, 1: 2442, 2: 1283})

Epoch :  80 loss training:  13.456849651411176 Time :  18261
accuracy train: 0.998676 val: 0.719403 test: 0.708138
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3672, 1: 2446, 2: 1282})

Epoch :  81 loss training:  11.609396677464247 Time :  18361
accuracy train: 0.998345 val: 0.716418 test: 0.711848
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3672, 2: 2446, 1: 1282})

Epoch :  82 loss training:  11.611190599389374 Time :  18464
accuracy train: 0.998676 val: 0.716418 test: 0.709127
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3678, 2: 2443, 1: 1279})

Epoch :  83 loss training:  11.350795295089483 Time :  18565
accuracy train: 0.998345 val: 0.716418 test: 0.710364
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3681, 1: 2440, 2: 1279})

Epoch :  84 loss training:  10.916907999664545 Time :  18653
accuracy train: 0.998676 val: 0.725373 test: 0.714568
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3678, 2: 2444, 1: 1278})

Epoch :  85 loss training:  11.60823493078351 Time :  18753
accuracy train: 0.999007 val: 0.725373 test: 0.711353
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.711848
Counter({0: 3680, 1: 2442, 2: 1278})

========================================================================================================================================================================================================
max acc epoch :  54
max validation accuracy :  0.746268656716418
test accuracy :  0.7118476378926539
last test_accuracy :  0.711352955725946
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=2, random_vec=False, seed=612, weight_decay=1e-08)
device :  cuda:0
Counter({0: 2607, 1: 2532, 2: 2261})

Epoch :  1 loss training:  241.56084191799164 Time :  18961
accuracy train: 0.578756 val: 0.597015 test: 0.541182
max validation accuracy : 0.597015 max acc epoch : 1 test accuracy : 0.541182
Counter({0: 2797, 1: 2732, 2: 1871})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  163.7407596707344 Time :  19059
accuracy train: 0.675050 val: 0.650746 test: 0.622310
max validation accuracy : 0.650746 max acc epoch : 2 test accuracy : 0.622310
Counter({0: 4525, 2: 1529, 1: 1346})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  139.80093386769295 Time :  19179
accuracy train: 0.695235 val: 0.692537 test: 0.635172
max validation accuracy : 0.692537 max acc epoch : 3 test accuracy : 0.635172
Counter({0: 4633, 1: 1489, 2: 1278})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  116.38664025068283 Time :  19272
accuracy train: 0.743216 val: 0.683582 test: 0.662132
max validation accuracy : 0.692537 max acc epoch : 3 test accuracy : 0.635172
Counter({0: 3794, 1: 2171, 2: 1435})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  105.2797959446907 Time :  19391
accuracy train: 0.777962 val: 0.698507 test: 0.656691
max validation accuracy : 0.698507 max acc epoch : 5 test accuracy : 0.656691
Counter({0: 2564, 2: 2507, 1: 2329})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  103.6403446495533 Time :  19485
accuracy train: 0.801787 val: 0.698507 test: 0.675736
max validation accuracy : 0.698507 max acc epoch : 5 test accuracy : 0.656691
Counter({0: 2648, 2: 2646, 1: 2106})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  88.17155280709267 Time :  19605
accuracy train: 0.813700 val: 0.740299 test: 0.691566
max validation accuracy : 0.740299 max acc epoch : 7 test accuracy : 0.691566
Counter({0: 2636, 2: 2568, 1: 2196})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  86.97443026304245 Time :  19687
accuracy train: 0.821972 val: 0.728358 test: 0.693297
max validation accuracy : 0.740299 max acc epoch : 7 test accuracy : 0.691566
Counter({0: 2605, 2: 2588, 1: 2207})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  82.97007210552692 Time :  19790
accuracy train: 0.841827 val: 0.716418 test: 0.703438
max validation accuracy : 0.740299 max acc epoch : 7 test accuracy : 0.691566
Counter({0: 2542, 2: 2542, 1: 2316})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  74.93350444734097 Time :  19886
accuracy train: 0.844474 val: 0.722388 test: 0.699728
max validation accuracy : 0.740299 max acc epoch : 7 test accuracy : 0.691566
Counter({2: 2560, 1: 2531, 0: 2309})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  73.76127929985523 Time :  19982
accuracy train: 0.851754 val: 0.728358 test: 0.704180
max validation accuracy : 0.740299 max acc epoch : 7 test accuracy : 0.691566
Counter({0: 2558, 1: 2536, 2: 2306})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  71.42711514234543 Time :  20079
accuracy train: 0.852416 val: 0.722388 test: 0.704675
max validation accuracy : 0.740299 max acc epoch : 7 test accuracy : 0.691566
Counter({0: 2566, 2: 2539, 1: 2295})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  70.17411322891712 Time :  20163
accuracy train: 0.859034 val: 0.740299 test: 0.705664
max validation accuracy : 0.740299 max acc epoch : 7 test accuracy : 0.691566
Counter({1: 2571, 0: 2535, 2: 2294})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  68.96153554320335 Time :  20265
accuracy train: 0.864990 val: 0.737313 test: 0.704922
max validation accuracy : 0.740299 max acc epoch : 7 test accuracy : 0.691566
Counter({2: 2568, 1: 2542, 0: 2290})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  69.31724205613136 Time :  20369
accuracy train: 0.867968 val: 0.743284 test: 0.704180
max validation accuracy : 0.743284 max acc epoch : 15 test accuracy : 0.704180
Counter({1: 2567, 0: 2539, 2: 2294})

Epoch :  16 loss training:  65.05509774386883 Time :  20463
accuracy train: 0.871277 val: 0.746269 test: 0.702201
max validation accuracy : 0.746269 max acc epoch : 16 test accuracy : 0.702201
Counter({0: 2560, 1: 2542, 2: 2298})

Epoch :  17 loss training:  66.11487656831741 Time :  20569
accuracy train: 0.875248 val: 0.737313 test: 0.703933
max validation accuracy : 0.746269 max acc epoch : 16 test accuracy : 0.702201
Counter({1: 2558, 2: 2543, 0: 2299})

Epoch :  18 loss training:  65.1015873849392 Time :  20652
accuracy train: 0.878226 val: 0.734328 test: 0.706159
max validation accuracy : 0.746269 max acc epoch : 16 test accuracy : 0.702201
Counter({1: 2564, 0: 2545, 2: 2291})

Epoch :  19 loss training:  63.000273033976555 Time :  20763
accuracy train: 0.887161 val: 0.737313 test: 0.705911
max validation accuracy : 0.746269 max acc epoch : 16 test accuracy : 0.702201
Counter({1: 2561, 2: 2546, 0: 2293})

Epoch :  20 loss training:  60.18221691250801 Time :  20854
accuracy train: 0.885837 val: 0.743284 test: 0.704922
max validation accuracy : 0.746269 max acc epoch : 16 test accuracy : 0.702201
Counter({1: 2560, 2: 2547, 0: 2293})

Epoch :  21 loss training:  61.58690646290779 Time :  20943
accuracy train: 0.888484 val: 0.740299 test: 0.701707
max validation accuracy : 0.746269 max acc epoch : 16 test accuracy : 0.702201
Counter({0: 2564, 1: 2550, 2: 2286})

Epoch :  22 loss training:  59.44016569852829 Time :  21038
accuracy train: 0.887492 val: 0.740299 test: 0.709869
max validation accuracy : 0.746269 max acc epoch : 16 test accuracy : 0.702201
Counter({0: 2568, 1: 2549, 2: 2283})

Epoch :  23 loss training:  58.287194669246674 Time :  21123
accuracy train: 0.899073 val: 0.746269 test: 0.709622
max validation accuracy : 0.746269 max acc epoch : 16 test accuracy : 0.702201
Counter({1: 2567, 2: 2543, 0: 2290})

Epoch :  24 loss training:  54.12869107723236 Time :  21206
accuracy train: 0.901390 val: 0.749254 test: 0.707643
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({1: 2570, 0: 2552, 2: 2278})

Epoch :  25 loss training:  55.69549244642258 Time :  21286
accuracy train: 0.897419 val: 0.743284 test: 0.705664
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({1: 2577, 0: 2549, 2: 2274})

Epoch :  26 loss training:  54.236692294478416 Time :  21379
accuracy train: 0.910324 val: 0.740299 test: 0.705911
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({1: 2580, 2: 2549, 0: 2271})

Epoch :  27 loss training:  53.67155124247074 Time :  21483
accuracy train: 0.912972 val: 0.740299 test: 0.710364
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({1: 2573, 2: 2551, 0: 2276})

Epoch :  28 loss training:  54.52235780656338 Time :  21591
accuracy train: 0.915950 val: 0.746269 test: 0.710364
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({2: 2576, 1: 2549, 0: 2275})

Epoch :  29 loss training:  50.23609025776386 Time :  21688
accuracy train: 0.923561 val: 0.746269 test: 0.707890
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({2: 2572, 1: 2546, 0: 2282})

Epoch :  30 loss training:  47.64237028360367 Time :  21777
accuracy train: 0.925546 val: 0.743284 test: 0.706159
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({1: 2576, 0: 2549, 2: 2275})

Epoch :  31 loss training:  46.20698796212673 Time :  21867
accuracy train: 0.930841 val: 0.731343 test: 0.707890
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({1: 2573, 2: 2552, 0: 2275})

Epoch :  32 loss training:  47.092260867357254 Time :  21953
accuracy train: 0.933488 val: 0.743284 test: 0.706159
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({1: 2573, 2: 2557, 0: 2270})

Epoch :  33 loss training:  44.901995189487934 Time :  22032
accuracy train: 0.935142 val: 0.737313 test: 0.708138
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({1: 2574, 2: 2553, 0: 2273})

Epoch :  34 loss training:  44.37154385447502 Time :  22126
accuracy train: 0.934480 val: 0.737313 test: 0.705911
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({1: 2572, 2: 2559, 0: 2269})

Epoch :  35 loss training:  43.507920533418655 Time :  22228
accuracy train: 0.941760 val: 0.743284 test: 0.707148
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({0: 2568, 1: 2565, 2: 2267})

Epoch :  36 loss training:  40.130991376936436 Time :  22321
accuracy train: 0.946062 val: 0.743284 test: 0.708880
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({2: 2567, 1: 2564, 0: 2269})

Epoch :  37 loss training:  42.137050956487656 Time :  22410
accuracy train: 0.942422 val: 0.749254 test: 0.713826
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({1: 2565, 2: 2564, 0: 2271})

Epoch :  38 loss training:  40.72867698967457 Time :  22495
accuracy train: 0.948048 val: 0.749254 test: 0.708632
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({0: 2577, 2: 2559, 1: 2264})

Epoch :  39 loss training:  38.206285409629345 Time :  22573
accuracy train: 0.952680 val: 0.740299 test: 0.710116
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({1: 2580, 2: 2561, 0: 2259})

Epoch :  40 loss training:  37.28081429749727 Time :  22656
accuracy train: 0.953673 val: 0.722388 test: 0.702696
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({0: 2582, 1: 2560, 2: 2258})

Epoch :  41 loss training:  35.42196708917618 Time :  22743
accuracy train: 0.952680 val: 0.719403 test: 0.705417
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({0: 2584, 1: 2557, 2: 2259})

Epoch :  42 loss training:  35.85418926179409 Time :  22826
accuracy train: 0.957313 val: 0.722388 test: 0.707643
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({2: 2583, 1: 2556, 0: 2261})

Epoch :  43 loss training:  35.41965398937464 Time :  22918
accuracy train: 0.959298 val: 0.737313 test: 0.701707
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({1: 2581, 0: 2558, 2: 2261})

Epoch :  44 loss training:  34.10165859013796 Time :  23014
accuracy train: 0.961284 val: 0.731343 test: 0.703438
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({1: 2584, 2: 2557, 0: 2259})

Epoch :  45 loss training:  32.49520992487669 Time :  23111
accuracy train: 0.968564 val: 0.734328 test: 0.706653
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({1: 2587, 0: 2550, 2: 2263})

Epoch :  46 loss training:  33.389220014214516 Time :  23203
accuracy train: 0.971211 val: 0.722388 test: 0.708138
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({1: 2587, 2: 2550, 0: 2263})

Epoch :  47 loss training:  30.905789464712143 Time :  23286
accuracy train: 0.969557 val: 0.734328 test: 0.708138
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({2: 2594, 0: 2541, 1: 2265})

Epoch :  48 loss training:  30.253549672663212 Time :  23376
accuracy train: 0.973197 val: 0.734328 test: 0.703933
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({1: 2596, 2: 2534, 0: 2270})

Epoch :  49 loss training:  29.908336989581585 Time :  23458
accuracy train: 0.975182 val: 0.725373 test: 0.704180
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({2: 2602, 0: 2532, 1: 2266})

Epoch :  50 loss training:  27.53370901197195 Time :  23539
accuracy train: 0.978160 val: 0.731343 test: 0.709127
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({0: 2605, 1: 2526, 2: 2269})

Epoch :  51 loss training:  28.03283791989088 Time :  23621
accuracy train: 0.979153 val: 0.734328 test: 0.709127
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({0: 2605, 1: 2522, 2: 2273})

Epoch :  52 loss training:  28.20892258733511 Time :  23714
accuracy train: 0.981800 val: 0.713433 test: 0.709127
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({0: 2605, 1: 2519, 2: 2276})

Epoch :  53 loss training:  26.842375986278057 Time :  23804
accuracy train: 0.982462 val: 0.731343 test: 0.706159
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({0: 2605, 1: 2519, 2: 2276})

Epoch :  54 loss training:  24.917377218604088 Time :  23885
accuracy train: 0.979484 val: 0.725373 test: 0.709622
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({1: 2610, 2: 2514, 0: 2276})

Epoch :  55 loss training:  26.193005844950676 Time :  23978
accuracy train: 0.980146 val: 0.725373 test: 0.705169
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.707643
Counter({2: 2614, 0: 2510, 1: 2276})

========================================================================================================================================================================================================
max acc epoch :  24
max validation accuracy :  0.7492537313432835
test accuracy :  0.7076428394756369
last test_accuracy :  0.7051694286420974
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=2, random_vec=False, seed=612, weight_decay=1e-08)
device :  cuda:0
Counter({0: 2607, 1: 2532, 2: 2261})

Epoch :  1 loss training:  241.99235022068024 Time :  24229
accuracy train: 0.588021 val: 0.608955 test: 0.557754
max validation accuracy : 0.608955 max acc epoch : 1 test accuracy : 0.557754
Counter({1: 2837, 0: 2549, 2: 2014})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  162.37228393554688 Time :  24337
accuracy train: 0.681668 val: 0.659701 test: 0.627752
max validation accuracy : 0.659701 max acc epoch : 2 test accuracy : 0.627752
Counter({2: 3481, 0: 2399, 1: 1520})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  140.11724138259888 Time :  24433
accuracy train: 0.701853 val: 0.683582 test: 0.631956
max validation accuracy : 0.683582 max acc epoch : 3 test accuracy : 0.631956
Counter({0: 4445, 2: 1597, 1: 1358})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  117.08547750115395 Time :  24533
accuracy train: 0.735275 val: 0.698507 test: 0.664358
max validation accuracy : 0.698507 max acc epoch : 4 test accuracy : 0.664358
Counter({0: 3428, 2: 2461, 1: 1511})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  106.67799806594849 Time :  24650
accuracy train: 0.781932 val: 0.704478 test: 0.672768
max validation accuracy : 0.704478 max acc epoch : 5 test accuracy : 0.672768
Counter({2: 3495, 1: 2444, 0: 1461})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  101.20280784368515 Time :  24749
accuracy train: 0.799471 val: 0.725373 test: 0.680188
max validation accuracy : 0.725373 max acc epoch : 6 test accuracy : 0.680188
Counter({2: 3658, 0: 2311, 1: 1431})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  90.12167999148369 Time :  24836
accuracy train: 0.815023 val: 0.734328 test: 0.691813
max validation accuracy : 0.734328 max acc epoch : 7 test accuracy : 0.691813
Counter({0: 3683, 2: 2294, 1: 1423})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  85.71691173315048 Time :  24922
accuracy train: 0.819656 val: 0.725373 test: 0.693050
max validation accuracy : 0.734328 max acc epoch : 7 test accuracy : 0.691813
Counter({1: 3716, 0: 2287, 2: 1397})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  82.51852801442146 Time :  25064
accuracy train: 0.831899 val: 0.719403 test: 0.691318
max validation accuracy : 0.734328 max acc epoch : 7 test accuracy : 0.691813
Counter({1: 4459, 0: 1541, 2: 1400})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  77.45520213246346 Time :  25175
accuracy train: 0.842819 val: 0.734328 test: 0.696265
max validation accuracy : 0.734328 max acc epoch : 7 test accuracy : 0.691813
Counter({2: 4500, 0: 1508, 1: 1392})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  77.32639274001122 Time :  25274
accuracy train: 0.847783 val: 0.737313 test: 0.701459
max validation accuracy : 0.737313 max acc epoch : 11 test accuracy : 0.701459
Counter({2: 4517, 0: 1494, 1: 1389})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  71.74616208672523 Time :  25378
accuracy train: 0.855725 val: 0.728358 test: 0.702943
max validation accuracy : 0.737313 max acc epoch : 11 test accuracy : 0.701459
Counter({1: 4514, 0: 1496, 2: 1390})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  71.40523180365562 Time :  25490
accuracy train: 0.862674 val: 0.743284 test: 0.702696
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.702696
Counter({1: 4516, 0: 1497, 2: 1387})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  69.23586854338646 Time :  25609
accuracy train: 0.864659 val: 0.737313 test: 0.704922
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.702696
Counter({0: 4507, 2: 1505, 1: 1388})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  69.70456624031067 Time :  25708
accuracy train: 0.868630 val: 0.725373 test: 0.705417
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.702696
Counter({0: 4511, 1: 1502, 2: 1387})

Epoch :  16 loss training:  66.69208626449108 Time :  25803
accuracy train: 0.869623 val: 0.737313 test: 0.706406
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.702696
Counter({0: 4513, 1: 1500, 2: 1387})

Epoch :  17 loss training:  67.08578795194626 Time :  25907
accuracy train: 0.872270 val: 0.731343 test: 0.703191
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.702696
Counter({0: 4517, 2: 1498, 1: 1385})

Epoch :  18 loss training:  66.00688882172108 Time :  26015
accuracy train: 0.874255 val: 0.737313 test: 0.705911
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.702696
Counter({0: 4515, 2: 1500, 1: 1385})

Epoch :  19 loss training:  63.62262985110283 Time :  26115
accuracy train: 0.879219 val: 0.731343 test: 0.704180
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.702696
Counter({0: 4515, 1: 1501, 2: 1384})

Epoch :  20 loss training:  62.53166516125202 Time :  26214
accuracy train: 0.884844 val: 0.734328 test: 0.702201
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.702696
Counter({0: 4482, 1: 1533, 2: 1385})

Epoch :  21 loss training:  62.49059800058603 Time :  26324
accuracy train: 0.887492 val: 0.734328 test: 0.706159
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.702696
Counter({0: 4479, 1: 1537, 2: 1384})

Epoch :  22 loss training:  59.487711541354656 Time :  26426
accuracy train: 0.888484 val: 0.734328 test: 0.708138
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.702696
Counter({0: 4479, 1: 1539, 2: 1382})

Epoch :  23 loss training:  57.77851775288582 Time :  26538
accuracy train: 0.894441 val: 0.740299 test: 0.706159
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.702696
Counter({0: 4482, 1: 1539, 2: 1379})

Epoch :  24 loss training:  55.38344383239746 Time :  26648
accuracy train: 0.899735 val: 0.734328 test: 0.705911
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.702696
Counter({0: 4481, 2: 1540, 1: 1379})

Epoch :  25 loss training:  55.80688098073006 Time :  26745
accuracy train: 0.903044 val: 0.737313 test: 0.707395
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.702696
Counter({0: 4476, 2: 1543, 1: 1381})

Epoch :  26 loss training:  56.698920622467995 Time :  26840
accuracy train: 0.908339 val: 0.731343 test: 0.703933
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.702696
Counter({0: 4480, 2: 1542, 1: 1378})

Epoch :  27 loss training:  52.33207878470421 Time :  26929
accuracy train: 0.911648 val: 0.737313 test: 0.709127
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.702696
Counter({0: 4480, 2: 1541, 1: 1379})

Epoch :  28 loss training:  52.34374035894871 Time :  27018
accuracy train: 0.911648 val: 0.737313 test: 0.706406
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.702696
Counter({0: 4483, 1: 1540, 2: 1377})

Epoch :  29 loss training:  50.937865272164345 Time :  27135
accuracy train: 0.922237 val: 0.737313 test: 0.706159
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.702696
Counter({1: 4483, 0: 1538, 2: 1379})

Epoch :  30 loss training:  49.24963487684727 Time :  27225
accuracy train: 0.926208 val: 0.734328 test: 0.708385
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.702696
Counter({0: 4492, 1: 1530, 2: 1378})

Epoch :  31 loss training:  47.56968232989311 Time :  27317
accuracy train: 0.926208 val: 0.734328 test: 0.704675
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.702696
Counter({1: 4500, 0: 1531, 2: 1369})

Epoch :  32 loss training:  47.114864222705364 Time :  27431
accuracy train: 0.928855 val: 0.743284 test: 0.705664
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.702696
Counter({1: 4500, 2: 1531, 0: 1369})

Epoch :  33 loss training:  48.36479909718037 Time :  27553
accuracy train: 0.931502 val: 0.734328 test: 0.706901
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.702696
Counter({2: 4495, 0: 1538, 1: 1367})

Epoch :  34 loss training:  45.439006611704826 Time :  27649
accuracy train: 0.934480 val: 0.731343 test: 0.709127
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.702696
Counter({0: 4493, 1: 1539, 2: 1368})

Epoch :  35 loss training:  43.01047430187464 Time :  27744
accuracy train: 0.937790 val: 0.737313 test: 0.706653
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.702696
Counter({2: 4330, 0: 1702, 1: 1368})

Epoch :  36 loss training:  44.64238826930523 Time :  27865
accuracy train: 0.946393 val: 0.734328 test: 0.709127
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.702696
Counter({2: 4324, 0: 1710, 1: 1366})

Epoch :  37 loss training:  41.26138585060835 Time :  27982
accuracy train: 0.948709 val: 0.737313 test: 0.710364
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.702696
Counter({1: 4321, 0: 1711, 2: 1368})

Epoch :  38 loss training:  40.13096668571234 Time :  28074
accuracy train: 0.947386 val: 0.749254 test: 0.710116
max validation accuracy : 0.749254 max acc epoch : 38 test accuracy : 0.710116
Counter({0: 4313, 2: 1718, 1: 1369})

Epoch :  39 loss training:  39.67200367152691 Time :  28155
accuracy train: 0.949702 val: 0.743284 test: 0.711353
max validation accuracy : 0.749254 max acc epoch : 38 test accuracy : 0.710116
Counter({0: 4304, 1: 1726, 2: 1370})

Epoch :  40 loss training:  37.80032725632191 Time :  28264
accuracy train: 0.951357 val: 0.746269 test: 0.707148
max validation accuracy : 0.749254 max acc epoch : 38 test accuracy : 0.710116
Counter({0: 4311, 1: 1722, 2: 1367})

Epoch :  41 loss training:  37.730393670499325 Time :  28382
accuracy train: 0.957644 val: 0.743284 test: 0.709127
max validation accuracy : 0.749254 max acc epoch : 38 test accuracy : 0.710116
Counter({2: 4311, 0: 1722, 1: 1367})

Epoch :  42 loss training:  37.697958901524544 Time :  28472
accuracy train: 0.960953 val: 0.740299 test: 0.710116
max validation accuracy : 0.749254 max acc epoch : 38 test accuracy : 0.710116
Counter({1: 4315, 0: 1721, 2: 1364})

Epoch :  43 loss training:  35.41530691087246 Time :  28562
accuracy train: 0.959298 val: 0.737313 test: 0.706901
max validation accuracy : 0.749254 max acc epoch : 38 test accuracy : 0.710116
Counter({2: 4304, 0: 1732, 1: 1364})

Epoch :  44 loss training:  34.91226802021265 Time :  28659
accuracy train: 0.961946 val: 0.749254 test: 0.704427
max validation accuracy : 0.749254 max acc epoch : 38 test accuracy : 0.710116
Counter({0: 4304, 1: 1732, 2: 1364})

Epoch :  45 loss training:  34.07365534454584 Time :  28763
accuracy train: 0.970218 val: 0.740299 test: 0.707148
max validation accuracy : 0.749254 max acc epoch : 38 test accuracy : 0.710116
Counter({0: 4299, 2: 1734, 1: 1367})

Epoch :  46 loss training:  33.78298585116863 Time :  28856
accuracy train: 0.969226 val: 0.746269 test: 0.709374
max validation accuracy : 0.749254 max acc epoch : 38 test accuracy : 0.710116
Counter({0: 4294, 2: 1738, 1: 1368})

Epoch :  47 loss training:  30.555325649678707 Time :  28940
accuracy train: 0.969226 val: 0.740299 test: 0.710116
max validation accuracy : 0.749254 max acc epoch : 38 test accuracy : 0.710116
Counter({0: 4291, 1: 1743, 2: 1366})

Epoch :  48 loss training:  30.757702227681875 Time :  29028
accuracy train: 0.972866 val: 0.740299 test: 0.707395
max validation accuracy : 0.749254 max acc epoch : 38 test accuracy : 0.710116
Counter({0: 4291, 1: 1744, 2: 1365})

Epoch :  49 loss training:  30.142623029649258 Time :  29116
accuracy train: 0.973197 val: 0.737313 test: 0.712837
max validation accuracy : 0.749254 max acc epoch : 38 test accuracy : 0.710116
Counter({0: 4294, 2: 1742, 1: 1364})

Epoch :  50 loss training:  28.219499439001083 Time :  29205
accuracy train: 0.980477 val: 0.746269 test: 0.707890
max validation accuracy : 0.749254 max acc epoch : 38 test accuracy : 0.710116
Counter({0: 4298, 1: 1741, 2: 1361})

Epoch :  51 loss training:  28.636991754174232 Time :  29292
accuracy train: 0.977498 val: 0.743284 test: 0.708385
max validation accuracy : 0.749254 max acc epoch : 38 test accuracy : 0.710116
Counter({2: 4307, 0: 1738, 1: 1355})

Epoch :  52 loss training:  28.287019852548838 Time :  29381
accuracy train: 0.979484 val: 0.737313 test: 0.711353
max validation accuracy : 0.749254 max acc epoch : 38 test accuracy : 0.710116
Counter({0: 4304, 1: 1740, 2: 1356})

Epoch :  53 loss training:  26.767688807100058 Time :  29469
accuracy train: 0.981469 val: 0.743284 test: 0.707148
max validation accuracy : 0.749254 max acc epoch : 38 test accuracy : 0.710116
Counter({0: 4298, 1: 1746, 2: 1356})

Epoch :  54 loss training:  27.114465966820717 Time :  29558
accuracy train: 0.979153 val: 0.752239 test: 0.710364
max validation accuracy : 0.752239 max acc epoch : 54 test accuracy : 0.710364
Counter({0: 4297, 1: 1752, 2: 1351})

Epoch :  55 loss training:  27.73860078305006 Time :  29644
accuracy train: 0.980807 val: 0.743284 test: 0.709374
max validation accuracy : 0.752239 max acc epoch : 54 test accuracy : 0.710364
Counter({0: 4300, 1: 1752, 2: 1348})

Epoch :  56 loss training:  25.907472491264343 Time :  29725
accuracy train: 0.986102 val: 0.752239 test: 0.708880
max validation accuracy : 0.752239 max acc epoch : 54 test accuracy : 0.710364
Counter({0: 4302, 2: 1751, 1: 1347})

Epoch :  57 loss training:  24.133406288921833 Time :  29816
accuracy train: 0.982462 val: 0.740299 test: 0.713826
max validation accuracy : 0.752239 max acc epoch : 54 test accuracy : 0.710364
Counter({2: 4292, 1: 1761, 0: 1347})

Epoch :  58 loss training:  22.350562781095505 Time :  29922
accuracy train: 0.987756 val: 0.761194 test: 0.712342
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({1: 4282, 0: 1771, 2: 1347})

Epoch :  59 loss training:  22.055683501064777 Time :  30028
accuracy train: 0.987095 val: 0.743284 test: 0.712837
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({0: 4279, 2: 1774, 1: 1347})

Epoch :  60 loss training:  22.982044488191605 Time :  30125
accuracy train: 0.986433 val: 0.743284 test: 0.711848
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({1: 4278, 2: 1775, 0: 1347})

Epoch :  61 loss training:  20.838378842920065 Time :  30224
accuracy train: 0.988418 val: 0.749254 test: 0.712095
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({2: 4272, 0: 1780, 1: 1348})

Epoch :  62 loss training:  21.35239928215742 Time :  30317
accuracy train: 0.989411 val: 0.749254 test: 0.705911
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({0: 4266, 2: 1786, 1: 1348})

Epoch :  63 loss training:  21.468792844563723 Time :  30407
accuracy train: 0.990404 val: 0.743284 test: 0.708138
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({2: 4272, 0: 1786, 1: 1342})

Epoch :  64 loss training:  21.286727976053953 Time :  30500
accuracy train: 0.990735 val: 0.755224 test: 0.710611
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({1: 4283, 0: 1787, 2: 1330})

Epoch :  65 loss training:  18.899251714348793 Time :  30603
accuracy train: 0.993051 val: 0.749254 test: 0.713579
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({0: 4287, 2: 1786, 1: 1327})

Epoch :  66 loss training:  20.055975198745728 Time :  30703
accuracy train: 0.992720 val: 0.749254 test: 0.709622
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({0: 4290, 1: 1786, 2: 1324})

Epoch :  67 loss training:  19.174214724451303 Time :  30788
accuracy train: 0.992058 val: 0.749254 test: 0.707643
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({0: 4290, 2: 1786, 1: 1324})

Epoch :  68 loss training:  17.86821261420846 Time :  30863
accuracy train: 0.991066 val: 0.743284 test: 0.708632
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({0: 4290, 1: 1786, 2: 1324})

Epoch :  69 loss training:  17.337954925373197 Time :  30959
accuracy train: 0.994375 val: 0.746269 test: 0.707148
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({0: 4291, 2: 1785, 1: 1324})

Epoch :  70 loss training:  16.821719761937857 Time :  31055
accuracy train: 0.994044 val: 0.746269 test: 0.707890
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({2: 4290, 0: 1787, 1: 1323})

Epoch :  71 loss training:  17.277144480496645 Time :  31165
accuracy train: 0.994705 val: 0.746269 test: 0.708385
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({0: 4292, 1: 1795, 2: 1313})

Epoch :  72 loss training:  17.613365169614553 Time :  31278
accuracy train: 0.996029 val: 0.743284 test: 0.710116
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({0: 4290, 1: 1800, 2: 1310})

Epoch :  73 loss training:  15.407272351905704 Time :  31368
accuracy train: 0.994705 val: 0.740299 test: 0.710611
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({0: 4293, 1: 1798, 2: 1309})

Epoch :  74 loss training:  15.613663604483008 Time :  31455
accuracy train: 0.996691 val: 0.749254 test: 0.709622
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({2: 4292, 1: 1801, 0: 1307})

Epoch :  75 loss training:  15.485385850071907 Time :  31547
accuracy train: 0.996360 val: 0.743284 test: 0.706406
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({2: 4292, 1: 1803, 0: 1305})

Epoch :  76 loss training:  14.057634511962533 Time :  31643
accuracy train: 0.997353 val: 0.737313 test: 0.706901
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({0: 4286, 1: 1808, 2: 1306})

Epoch :  77 loss training:  13.166964564472437 Time :  31749
accuracy train: 0.997684 val: 0.737313 test: 0.708632
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({0: 4275, 1: 1816, 2: 1309})

Epoch :  78 loss training:  13.120583672076464 Time :  31852
accuracy train: 0.997353 val: 0.740299 test: 0.712095
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({0: 4275, 2: 1814, 1: 1311})

Epoch :  79 loss training:  14.100060995668173 Time :  31940
accuracy train: 0.997022 val: 0.737313 test: 0.712590
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({0: 4276, 2: 1813, 1: 1311})

Epoch :  80 loss training:  13.766797747462988 Time :  32030
accuracy train: 0.998015 val: 0.746269 test: 0.709622
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({0: 4280, 1: 1813, 2: 1307})

Epoch :  81 loss training:  12.285901678726077 Time :  32113
accuracy train: 0.994705 val: 0.734328 test: 0.714321
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({0: 4278, 1: 1814, 2: 1308})

Epoch :  82 loss training:  13.096939912997186 Time :  32205
accuracy train: 0.998676 val: 0.749254 test: 0.712342
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({0: 4281, 1: 1812, 2: 1307})

Epoch :  83 loss training:  11.66952889598906 Time :  32314
accuracy train: 0.998015 val: 0.737313 test: 0.715310
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({0: 4275, 1: 1817, 2: 1308})

Epoch :  84 loss training:  11.94913812354207 Time :  32431
accuracy train: 0.997022 val: 0.740299 test: 0.709869
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({0: 4274, 1: 1818, 2: 1308})

Epoch :  85 loss training:  11.398428986780345 Time :  32531
accuracy train: 0.997684 val: 0.746269 test: 0.712837
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({2: 4272, 0: 1820, 1: 1308})

Epoch :  86 loss training:  11.867387771606445 Time :  32626
accuracy train: 0.998345 val: 0.734328 test: 0.706406
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({0: 4268, 2: 1820, 1: 1312})

Epoch :  87 loss training:  10.735022721812129 Time :  32709
accuracy train: 0.998345 val: 0.740299 test: 0.715558
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({1: 4258, 0: 1832, 2: 1310})

Epoch :  88 loss training:  10.278940351679921 Time :  32802
accuracy train: 0.999338 val: 0.731343 test: 0.711106
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({2: 4259, 0: 1831, 1: 1310})

Epoch :  89 loss training:  11.119712234474719 Time :  32889
accuracy train: 0.999669 val: 0.752239 test: 0.710611
max validation accuracy : 0.761194 max acc epoch : 58 test accuracy : 0.712342
Counter({0: 4260, 1: 1830, 2: 1310})

========================================================================================================================================================================================================
max acc epoch :  58
max validation accuracy :  0.7611940298507462
test accuracy :  0.7123423200593618
last test_accuracy :  0.7106109324758842
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.76119 	 test_accuracy : 0.71185 	 max_acc epoch :  54 	 last test_accuracy : 0.70913
k :  1 	 val_accuracy : 0.74627 	 test_accuracy : 0.71185 	 max_acc epoch :  54 	 last test_accuracy : 0.71135
k :  2 	 val_accuracy : 0.74925 	 test_accuracy : 0.70764 	 max_acc epoch :  24 	 last test_accuracy : 0.70517
k :  3 	 val_accuracy : 0.76119 	 test_accuracy : 0.71234 	 max_acc epoch :  58 	 last test_accuracy : 0.71061

avg :  	 val_accuracy : 0.75448 	 test_accuracy : 0.71092 	 last_accuracy : 0.70907


date and time :  Wed May 26 09:04:19 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=4, num_mlp_layers=1, random_vec=False, seed=244, weight_decay=1e-08)
device :  cuda:0
Counter({1: 2607, 0: 2532, 2: 2261})

Epoch :  1 loss training:  219.9283041357994 Time :  167
accuracy train: 0.615817 val: 0.579104 test: 0.586446
max validation accuracy : 0.579104 max acc epoch : 1 test accuracy : 0.586446
Counter({2: 3443, 0: 2313, 1: 1644})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  151.76190012693405 Time :  307
accuracy train: 0.709464 val: 0.665672 test: 0.655701
max validation accuracy : 0.665672 max acc epoch : 2 test accuracy : 0.655701
Counter({2: 3314, 0: 2257, 1: 1829})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  130.4064595401287 Time :  414
accuracy train: 0.751158 val: 0.680597 test: 0.669058
max validation accuracy : 0.680597 max acc epoch : 3 test accuracy : 0.669058
Counter({0: 2778, 1: 2423, 2: 2199})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.67600226402283 Time :  561
accuracy train: 0.794507 val: 0.716418 test: 0.701954
max validation accuracy : 0.716418 max acc epoch : 4 test accuracy : 0.701954
Counter({0: 2701, 1: 2532, 2: 2167})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  91.7926985770464 Time :  662
accuracy train: 0.811052 val: 0.716418 test: 0.690329
max validation accuracy : 0.716418 max acc epoch : 4 test accuracy : 0.701954
Counter({1: 2662, 0: 2495, 2: 2243})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.95244637131691 Time :  761
accuracy train: 0.818994 val: 0.713433 test: 0.703685
max validation accuracy : 0.716418 max acc epoch : 4 test accuracy : 0.701954
Counter({0: 2646, 1: 2544, 2: 2210})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  74.98167443275452 Time :  887
accuracy train: 0.849768 val: 0.722388 test: 0.706159
max validation accuracy : 0.722388 max acc epoch : 7 test accuracy : 0.706159
Counter({0: 2661, 2: 2542, 1: 2197})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.90533044934273 Time :  995
accuracy train: 0.857710 val: 0.722388 test: 0.707395
max validation accuracy : 0.722388 max acc epoch : 7 test accuracy : 0.706159
Counter({0: 2650, 2: 2560, 1: 2190})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  67.57576134800911 Time :  1098
accuracy train: 0.874917 val: 0.707463 test: 0.710116
max validation accuracy : 0.722388 max acc epoch : 7 test accuracy : 0.706159
Counter({0: 2666, 1: 2546, 2: 2188})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.819281578063965 Time :  1196
accuracy train: 0.891132 val: 0.728358 test: 0.713084
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.713084
Counter({0: 2663, 2: 2553, 1: 2184})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  57.4548232704401 Time :  1299
accuracy train: 0.898081 val: 0.728358 test: 0.712837
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.713084
Counter({0: 2669, 1: 2541, 2: 2190})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  57.06977565586567 Time :  1401
accuracy train: 0.903044 val: 0.731343 test: 0.716052
max validation accuracy : 0.731343 max acc epoch : 12 test accuracy : 0.716052
Counter({0: 2676, 1: 2537, 2: 2187})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  52.09329845011234 Time :  1496
accuracy train: 0.904037 val: 0.728358 test: 0.713332
max validation accuracy : 0.731343 max acc epoch : 12 test accuracy : 0.716052
Counter({0: 2675, 1: 2539, 2: 2186})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  51.04355661571026 Time :  1584
accuracy train: 0.909993 val: 0.728358 test: 0.715310
max validation accuracy : 0.731343 max acc epoch : 12 test accuracy : 0.716052
Counter({0: 2676, 2: 2539, 1: 2185})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  51.19820274412632 Time :  1681
accuracy train: 0.909662 val: 0.716418 test: 0.716300
max validation accuracy : 0.731343 max acc epoch : 12 test accuracy : 0.716052
Counter({0: 2669, 1: 2544, 2: 2187})

Epoch :  16 loss training:  50.63629670441151 Time :  1795
accuracy train: 0.912641 val: 0.731343 test: 0.715063
max validation accuracy : 0.731343 max acc epoch : 12 test accuracy : 0.716052
Counter({0: 2671, 1: 2542, 2: 2187})

Epoch :  17 loss training:  48.707816660404205 Time :  1901
accuracy train: 0.921906 val: 0.722388 test: 0.716794
max validation accuracy : 0.731343 max acc epoch : 12 test accuracy : 0.716052
Counter({2: 2672, 0: 2536, 1: 2192})

Epoch :  18 loss training:  47.88298572599888 Time :  1994
accuracy train: 0.926870 val: 0.728358 test: 0.719021
max validation accuracy : 0.731343 max acc epoch : 12 test accuracy : 0.716052
Counter({1: 2678, 0: 2533, 2: 2189})

Epoch :  19 loss training:  44.582237742841244 Time :  2086
accuracy train: 0.929517 val: 0.737313 test: 0.720257
max validation accuracy : 0.737313 max acc epoch : 19 test accuracy : 0.720257
Counter({0: 2685, 2: 2524, 1: 2191})

Epoch :  20 loss training:  43.040936298668385 Time :  2198
accuracy train: 0.929517 val: 0.731343 test: 0.720010
max validation accuracy : 0.737313 max acc epoch : 19 test accuracy : 0.720257
Counter({0: 2686, 1: 2522, 2: 2192})

Epoch :  21 loss training:  41.78267168998718 Time :  2313
accuracy train: 0.939113 val: 0.734328 test: 0.716547
max validation accuracy : 0.737313 max acc epoch : 19 test accuracy : 0.720257
Counter({0: 2691, 2: 2518, 1: 2191})

Epoch :  22 loss training:  41.09373468160629 Time :  2413
accuracy train: 0.937790 val: 0.746269 test: 0.726193
max validation accuracy : 0.746269 max acc epoch : 22 test accuracy : 0.726193
Counter({0: 2696, 1: 2510, 2: 2194})

Epoch :  23 loss training:  39.619390308856964 Time :  2508
accuracy train: 0.946724 val: 0.734328 test: 0.719515
max validation accuracy : 0.746269 max acc epoch : 22 test accuracy : 0.726193
Counter({0: 2697, 1: 2508, 2: 2195})

Epoch :  24 loss training:  38.26749016344547 Time :  2599
accuracy train: 0.950364 val: 0.749254 test: 0.715805
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.715805
Counter({0: 2696, 1: 2505, 2: 2199})

Epoch :  25 loss training:  37.28214980661869 Time :  2705
accuracy train: 0.954335 val: 0.734328 test: 0.716300
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.715805
Counter({0: 2703, 2: 2499, 1: 2198})

Epoch :  26 loss training:  36.14637389034033 Time :  2810
accuracy train: 0.956982 val: 0.725373 test: 0.719021
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.715805
Counter({0: 2706, 1: 2493, 2: 2201})

Epoch :  27 loss training:  35.330016642808914 Time :  2914
accuracy train: 0.959960 val: 0.746269 test: 0.721494
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.715805
Counter({0: 2707, 2: 2495, 1: 2198})

Epoch :  28 loss training:  33.35723899304867 Time :  3003
accuracy train: 0.964262 val: 0.731343 test: 0.718279
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.715805
Counter({0: 2695, 2: 2508, 1: 2197})

Epoch :  29 loss training:  33.261556796729565 Time :  3100
accuracy train: 0.967902 val: 0.728358 test: 0.719515
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.715805
Counter({1: 2696, 0: 2507, 2: 2197})

Epoch :  30 loss training:  29.345337867736816 Time :  3223
accuracy train: 0.969557 val: 0.743284 test: 0.725204
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.715805
Counter({0: 2697, 2: 2507, 1: 2196})

Epoch :  31 loss training:  29.799336284399033 Time :  3341
accuracy train: 0.972866 val: 0.731343 test: 0.721741
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.715805
Counter({0: 2697, 1: 2508, 2: 2195})

Epoch :  32 loss training:  28.332951590418816 Time :  3439
accuracy train: 0.976175 val: 0.734328 test: 0.716300
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.715805
Counter({0: 2696, 2: 2510, 1: 2194})

Epoch :  33 loss training:  27.18589998781681 Time :  3537
accuracy train: 0.974520 val: 0.719403 test: 0.717042
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.715805
Counter({0: 2704, 1: 2504, 2: 2192})

Epoch :  34 loss training:  26.350429229438305 Time :  3658
accuracy train: 0.980146 val: 0.737313 test: 0.717042
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.715805
Counter({0: 2706, 2: 2503, 1: 2191})

Epoch :  35 loss training:  25.394947860389948 Time :  3749
accuracy train: 0.983124 val: 0.734328 test: 0.717536
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.715805
Counter({0: 2708, 2: 2502, 1: 2190})

Epoch :  36 loss training:  24.11913162469864 Time :  3833
accuracy train: 0.985109 val: 0.752239 test: 0.720999
max validation accuracy : 0.752239 max acc epoch : 36 test accuracy : 0.720999
Counter({1: 2713, 0: 2498, 2: 2189})

Epoch :  37 loss training:  23.805353868752718 Time :  3917
accuracy train: 0.987095 val: 0.740299 test: 0.719268
max validation accuracy : 0.752239 max acc epoch : 36 test accuracy : 0.720999
Counter({2: 2713, 0: 2504, 1: 2183})

Epoch :  38 loss training:  22.666857969015837 Time :  4041
accuracy train: 0.986102 val: 0.728358 test: 0.716052
max validation accuracy : 0.752239 max acc epoch : 36 test accuracy : 0.720999
Counter({1: 2713, 0: 2507, 2: 2180})

Epoch :  39 loss training:  23.764028627425432 Time :  4157
accuracy train: 0.990735 val: 0.737313 test: 0.723720
max validation accuracy : 0.752239 max acc epoch : 36 test accuracy : 0.720999
Counter({0: 2713, 2: 2508, 1: 2179})

Epoch :  40 loss training:  22.22805343568325 Time :  4258
accuracy train: 0.992058 val: 0.758209 test: 0.724215
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2710, 2: 2511, 1: 2179})

Epoch :  41 loss training:  19.88812441378832 Time :  4349
accuracy train: 0.993382 val: 0.743284 test: 0.718279
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2713, 1: 2511, 2: 2176})

Epoch :  42 loss training:  18.393074741587043 Time :  4437
accuracy train: 0.988087 val: 0.740299 test: 0.722236
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2713, 1: 2529, 2: 2158})

Epoch :  43 loss training:  18.523871567100286 Time :  4563
accuracy train: 0.993051 val: 0.737313 test: 0.718773
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2716, 2: 2526, 1: 2158})

Epoch :  44 loss training:  18.2923748716712 Time :  4660
accuracy train: 0.993713 val: 0.746269 test: 0.723473
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2714, 2: 2531, 1: 2155})

Epoch :  45 loss training:  15.377882657572627 Time :  4753
accuracy train: 0.995036 val: 0.728358 test: 0.722978
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2716, 1: 2534, 2: 2150})

Epoch :  46 loss training:  16.95909795165062 Time :  4845
accuracy train: 0.995036 val: 0.755224 test: 0.721494
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2719, 2: 2532, 1: 2149})

Epoch :  47 loss training:  15.8413129709661 Time :  4942
accuracy train: 0.995698 val: 0.728358 test: 0.720257
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2721, 1: 2529, 2: 2150})

Epoch :  48 loss training:  14.510498059913516 Time :  5020
accuracy train: 0.996029 val: 0.740299 test: 0.725451
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2719, 2: 2530, 1: 2151})

Epoch :  49 loss training:  14.309776816517115 Time :  5098
accuracy train: 0.996691 val: 0.740299 test: 0.721989
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({1: 2721, 0: 2531, 2: 2148})

Epoch :  50 loss training:  13.998777026310563 Time :  5180
accuracy train: 0.997353 val: 0.749254 test: 0.723720
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2720, 1: 2534, 2: 2146})

Epoch :  51 loss training:  12.687342904508114 Time :  5266
accuracy train: 0.998015 val: 0.737313 test: 0.718279
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2722, 1: 2537, 2: 2141})

Epoch :  52 loss training:  13.630584263242781 Time :  5345
accuracy train: 0.997022 val: 0.746269 test: 0.725204
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2721, 2: 2543, 1: 2136})

Epoch :  53 loss training:  11.687856778502464 Time :  5428
accuracy train: 0.998015 val: 0.737313 test: 0.724215
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2720, 2: 2548, 1: 2132})

Epoch :  54 loss training:  11.805675778537989 Time :  5513
accuracy train: 0.996360 val: 0.740299 test: 0.726441
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2721, 1: 2545, 2: 2134})

Epoch :  55 loss training:  11.609058452770114 Time :  5594
accuracy train: 0.998015 val: 0.728358 test: 0.722236
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2720, 2: 2545, 1: 2135})

Epoch :  56 loss training:  11.810858560726047 Time :  5672
accuracy train: 0.998676 val: 0.728358 test: 0.722236
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2721, 1: 2548, 2: 2131})

Epoch :  57 loss training:  11.782445827499032 Time :  5754
accuracy train: 0.999669 val: 0.734328 test: 0.724957
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({1: 2719, 0: 2552, 2: 2129})

Epoch :  58 loss training:  10.682423876598477 Time :  5838
accuracy train: 0.999338 val: 0.731343 test: 0.721247
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2722, 2: 2554, 1: 2124})

Epoch :  59 loss training:  10.530404572375119 Time :  5923
accuracy train: 0.999007 val: 0.740299 test: 0.720257
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2724, 2: 2583, 1: 2093})

Epoch :  60 loss training:  9.169724827632308 Time :  6006
accuracy train: 0.999669 val: 0.728358 test: 0.722236
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2725, 2: 2583, 1: 2092})

Epoch :  61 loss training:  9.045159899629653 Time :  6087
accuracy train: 0.998676 val: 0.725373 test: 0.722483
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2725, 2: 2583, 1: 2092})

Epoch :  62 loss training:  8.712354314513505 Time :  6167
accuracy train: 0.999669 val: 0.728358 test: 0.722236
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2724, 2: 2577, 1: 2099})

Epoch :  63 loss training:  9.111463841050863 Time :  6241
accuracy train: 1.000000 val: 0.728358 test: 0.722731
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2724, 2: 2578, 1: 2098})

Epoch :  64 loss training:  7.1886584693565965 Time :  6320
accuracy train: 0.999669 val: 0.731343 test: 0.721989
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2721, 2: 2581, 1: 2098})

Epoch :  65 loss training:  8.273744720034301 Time :  6400
accuracy train: 1.000000 val: 0.734328 test: 0.725946
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2721, 2: 2587, 1: 2092})

Epoch :  66 loss training:  7.912025269120932 Time :  6481
accuracy train: 1.000000 val: 0.725373 test: 0.720999
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2719, 2: 2602, 1: 2079})

Epoch :  67 loss training:  6.796077108941972 Time :  6562
accuracy train: 1.000000 val: 0.734328 test: 0.722483
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2720, 2: 2603, 1: 2077})

Epoch :  68 loss training:  7.852606245782226 Time :  6638
accuracy train: 1.000000 val: 0.731343 test: 0.723225
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2723, 2: 2599, 1: 2078})

Epoch :  69 loss training:  7.089435153640807 Time :  6715
accuracy train: 1.000000 val: 0.722388 test: 0.723225
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2726, 1: 2596, 2: 2078})

Epoch :  70 loss training:  6.967339904047549 Time :  6800
accuracy train: 1.000000 val: 0.737313 test: 0.724957
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2726, 2: 2596, 1: 2078})

Epoch :  71 loss training:  6.373902386985719 Time :  6883
accuracy train: 1.000000 val: 0.743284 test: 0.718526
max validation accuracy : 0.758209 max acc epoch : 40 test accuracy : 0.724215
Counter({0: 2725, 1: 2597, 2: 2078})

========================================================================================================================================================================================================
max acc epoch :  40
max validation accuracy :  0.7582089552238805
test accuracy :  0.7242146920603513
last test_accuracy :  0.7185258471432104
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=4, num_mlp_layers=1, random_vec=False, seed=244, weight_decay=1e-08)
device :  cuda:0
Counter({1: 2607, 0: 2532, 2: 2261})

Epoch :  1 loss training:  220.38269805908203 Time :  7058
accuracy train: 0.612839 val: 0.570149 test: 0.572842
max validation accuracy : 0.570149 max acc epoch : 1 test accuracy : 0.572842
Counter({1: 3311, 0: 2360, 2: 1729})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  150.85253554582596 Time :  7150
accuracy train: 0.719722 val: 0.653731 test: 0.661390
max validation accuracy : 0.653731 max acc epoch : 2 test accuracy : 0.661390
Counter({2: 3390, 0: 2408, 1: 1602})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  130.51457765698433 Time :  7245
accuracy train: 0.748842 val: 0.680597 test: 0.666832
max validation accuracy : 0.680597 max acc epoch : 3 test accuracy : 0.666832
Counter({2: 3142, 0: 2666, 1: 1592})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  97.66238144040108 Time :  7336
accuracy train: 0.791860 val: 0.695522 test: 0.704675
max validation accuracy : 0.695522 max acc epoch : 4 test accuracy : 0.704675
Counter({0: 3123, 2: 2680, 1: 1597})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  92.37952402234077 Time :  7418
accuracy train: 0.807412 val: 0.713433 test: 0.694781
max validation accuracy : 0.713433 max acc epoch : 5 test accuracy : 0.694781
Counter({2: 3039, 0: 2714, 1: 1647})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  83.83472776412964 Time :  7509
accuracy train: 0.822634 val: 0.692537 test: 0.699481
max validation accuracy : 0.713433 max acc epoch : 5 test accuracy : 0.694781
Counter({1: 3045, 0: 2707, 2: 1648})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  73.85664707422256 Time :  7593
accuracy train: 0.851754 val: 0.719403 test: 0.707890
max validation accuracy : 0.719403 max acc epoch : 7 test accuracy : 0.707890
Counter({1: 3005, 0: 2734, 2: 1661})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.47287254035473 Time :  7700
accuracy train: 0.866645 val: 0.743284 test: 0.707643
max validation accuracy : 0.743284 max acc epoch : 8 test accuracy : 0.707643
Counter({1: 2994, 0: 2735, 2: 1671})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  67.25300885736942 Time :  7781
accuracy train: 0.878557 val: 0.728358 test: 0.706653
max validation accuracy : 0.743284 max acc epoch : 8 test accuracy : 0.707643
Counter({0: 3007, 1: 2733, 2: 1660})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.068363308906555 Time :  7862
accuracy train: 0.888484 val: 0.728358 test: 0.708385
max validation accuracy : 0.743284 max acc epoch : 8 test accuracy : 0.707643
Counter({2: 3022, 0: 2733, 1: 1645})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  57.361173838377 Time :  7940
accuracy train: 0.894772 val: 0.743284 test: 0.713579
max validation accuracy : 0.743284 max acc epoch : 8 test accuracy : 0.707643
Counter({0: 3032, 2: 2735, 1: 1633})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  55.656785160303116 Time :  8024
accuracy train: 0.901721 val: 0.746269 test: 0.714321
max validation accuracy : 0.746269 max acc epoch : 12 test accuracy : 0.714321
Counter({1: 3035, 0: 2738, 2: 1627})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  51.148554012179375 Time :  8104
accuracy train: 0.911648 val: 0.731343 test: 0.713579
max validation accuracy : 0.746269 max acc epoch : 12 test accuracy : 0.714321
Counter({2: 3032, 0: 2741, 1: 1627})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  51.52354255318642 Time :  8183
accuracy train: 0.914626 val: 0.737313 test: 0.712342
max validation accuracy : 0.746269 max acc epoch : 12 test accuracy : 0.714321
Counter({1: 3035, 2: 2740, 0: 1625})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  50.17654502391815 Time :  8265
accuracy train: 0.913302 val: 0.734328 test: 0.716052
max validation accuracy : 0.746269 max acc epoch : 12 test accuracy : 0.714321
Counter({1: 3034, 0: 2741, 2: 1625})

Epoch :  16 loss training:  49.92073366045952 Time :  8346
accuracy train: 0.918266 val: 0.731343 test: 0.715805
max validation accuracy : 0.746269 max acc epoch : 12 test accuracy : 0.714321
Counter({1: 3038, 0: 2739, 2: 1623})

Epoch :  17 loss training:  48.74227408319712 Time :  8428
accuracy train: 0.926870 val: 0.740299 test: 0.715558
max validation accuracy : 0.746269 max acc epoch : 12 test accuracy : 0.714321
Counter({1: 3039, 0: 2741, 2: 1620})

Epoch :  18 loss training:  46.70971982181072 Time :  8507
accuracy train: 0.927201 val: 0.734328 test: 0.712837
max validation accuracy : 0.746269 max acc epoch : 12 test accuracy : 0.714321
Counter({2: 3037, 0: 2741, 1: 1622})

Epoch :  19 loss training:  44.00668969005346 Time :  8581
accuracy train: 0.931502 val: 0.743284 test: 0.716547
max validation accuracy : 0.746269 max acc epoch : 12 test accuracy : 0.714321
Counter({2: 3043, 0: 2741, 1: 1616})

Epoch :  20 loss training:  42.62221409380436 Time :  8661
accuracy train: 0.931171 val: 0.746269 test: 0.715805
max validation accuracy : 0.746269 max acc epoch : 12 test accuracy : 0.714321
Counter({1: 3043, 0: 2740, 2: 1617})

Epoch :  21 loss training:  41.06522061675787 Time :  8738
accuracy train: 0.940768 val: 0.728358 test: 0.718773
max validation accuracy : 0.746269 max acc epoch : 12 test accuracy : 0.714321
Counter({2: 3048, 0: 2739, 1: 1613})

Epoch :  22 loss training:  40.57125996798277 Time :  8824
accuracy train: 0.942753 val: 0.752239 test: 0.719763
max validation accuracy : 0.752239 max acc epoch : 22 test accuracy : 0.719763
Counter({2: 3048, 0: 2740, 1: 1612})

Epoch :  23 loss training:  39.00818358361721 Time :  8912
accuracy train: 0.950364 val: 0.743284 test: 0.719268
max validation accuracy : 0.752239 max acc epoch : 22 test accuracy : 0.719763
Counter({2: 3049, 0: 2743, 1: 1608})

Epoch :  24 loss training:  37.88270431756973 Time :  8999
accuracy train: 0.954004 val: 0.746269 test: 0.716300
max validation accuracy : 0.752239 max acc epoch : 22 test accuracy : 0.719763
Counter({2: 3049, 0: 2743, 1: 1608})

Epoch :  25 loss training:  36.62880050390959 Time :  9087
accuracy train: 0.957644 val: 0.737313 test: 0.720010
max validation accuracy : 0.752239 max acc epoch : 22 test accuracy : 0.719763
Counter({2: 3045, 0: 2746, 1: 1609})

Epoch :  26 loss training:  35.698157615959644 Time :  9170
accuracy train: 0.956982 val: 0.752239 test: 0.716794
max validation accuracy : 0.752239 max acc epoch : 22 test accuracy : 0.719763
Counter({2: 3035, 0: 2757, 1: 1608})

Epoch :  27 loss training:  34.58611685782671 Time :  9252
accuracy train: 0.964593 val: 0.752239 test: 0.720999
max validation accuracy : 0.752239 max acc epoch : 22 test accuracy : 0.719763
Counter({2: 3030, 0: 2763, 1: 1607})

Epoch :  28 loss training:  33.25526466965675 Time :  9332
accuracy train: 0.964924 val: 0.749254 test: 0.717536
max validation accuracy : 0.752239 max acc epoch : 22 test accuracy : 0.719763
Counter({0: 3030, 1: 2765, 2: 1605})

Epoch :  29 loss training:  33.17302303016186 Time :  9416
accuracy train: 0.967571 val: 0.734328 test: 0.717042
max validation accuracy : 0.752239 max acc epoch : 22 test accuracy : 0.719763
Counter({2: 3028, 0: 2766, 1: 1606})

Epoch :  30 loss training:  29.61368901282549 Time :  9493
accuracy train: 0.970218 val: 0.749254 test: 0.724709
max validation accuracy : 0.752239 max acc epoch : 22 test accuracy : 0.719763
Counter({2: 3023, 0: 2772, 1: 1605})

Epoch :  31 loss training:  29.51643592864275 Time :  9564
accuracy train: 0.975844 val: 0.752239 test: 0.723967
max validation accuracy : 0.752239 max acc epoch : 22 test accuracy : 0.719763
Counter({1: 3024, 0: 2774, 2: 1602})

Epoch :  32 loss training:  27.820737153291702 Time :  9646
accuracy train: 0.979153 val: 0.758209 test: 0.721989
max validation accuracy : 0.758209 max acc epoch : 32 test accuracy : 0.721989
Counter({1: 3028, 0: 2775, 2: 1597})

Epoch :  33 loss training:  26.25451386719942 Time :  9736
accuracy train: 0.975513 val: 0.743284 test: 0.720505
max validation accuracy : 0.758209 max acc epoch : 32 test accuracy : 0.721989
Counter({1: 3024, 0: 2781, 2: 1595})

Epoch :  34 loss training:  26.297021098434925 Time :  9823
accuracy train: 0.982793 val: 0.764179 test: 0.718526
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({1: 3029, 0: 2776, 2: 1595})

Epoch :  35 loss training:  25.63851873576641 Time :  9902
accuracy train: 0.985109 val: 0.752239 test: 0.718031
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({2: 3038, 0: 2772, 1: 1590})

Epoch :  36 loss training:  24.72305154055357 Time :  9979
accuracy train: 0.983786 val: 0.764179 test: 0.719268
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({1: 3041, 0: 2772, 2: 1587})

Epoch :  37 loss training:  22.61635923758149 Time :  10058
accuracy train: 0.983455 val: 0.740299 test: 0.724215
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({2: 3043, 0: 2771, 1: 1586})

Epoch :  38 loss training:  23.514466494321823 Time :  10141
accuracy train: 0.985440 val: 0.749254 test: 0.715558
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({2: 3055, 0: 2768, 1: 1577})

Epoch :  39 loss training:  22.52029648423195 Time :  10224
accuracy train: 0.990073 val: 0.746269 test: 0.719515
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({2: 3054, 0: 2769, 1: 1577})

Epoch :  40 loss training:  21.13019533827901 Time :  10309
accuracy train: 0.989742 val: 0.752239 test: 0.721989
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({2: 3072, 0: 2764, 1: 1564})

Epoch :  41 loss training:  20.76830567419529 Time :  10395
accuracy train: 0.992389 val: 0.734328 test: 0.718773
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({0: 3099, 1: 2759, 2: 1542})

Epoch :  42 loss training:  19.03072652220726 Time :  10478
accuracy train: 0.991727 val: 0.749254 test: 0.716547
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({2: 3101, 0: 2760, 1: 1539})

Epoch :  43 loss training:  18.632040176540613 Time :  10560
accuracy train: 0.992389 val: 0.746269 test: 0.723225
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({2: 3104, 0: 2758, 1: 1538})

Epoch :  44 loss training:  17.590320153161883 Time :  10636
accuracy train: 0.994375 val: 0.743284 test: 0.720999
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({2: 3105, 0: 2758, 1: 1537})

Epoch :  45 loss training:  16.4572741240263 Time :  10713
accuracy train: 0.995367 val: 0.749254 test: 0.721247
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({2: 3112, 0: 2756, 1: 1532})

Epoch :  46 loss training:  16.995917532593012 Time :  10799
accuracy train: 0.992720 val: 0.749254 test: 0.722483
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({2: 3111, 0: 2755, 1: 1534})

Epoch :  47 loss training:  15.558511760085821 Time :  10885
accuracy train: 0.996360 val: 0.743284 test: 0.720752
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({2: 3122, 0: 2748, 1: 1530})

Epoch :  48 loss training:  14.285324167460203 Time :  10973
accuracy train: 0.997022 val: 0.761194 test: 0.723720
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({0: 3132, 2: 2737, 1: 1531})

Epoch :  49 loss training:  14.39108994603157 Time :  11061
accuracy train: 0.996691 val: 0.749254 test: 0.717784
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({2: 3132, 0: 2738, 1: 1530})

Epoch :  50 loss training:  14.953184412792325 Time :  11146
accuracy train: 0.998345 val: 0.737313 test: 0.718031
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({2: 3134, 0: 2738, 1: 1528})

Epoch :  51 loss training:  13.389109937474132 Time :  11232
accuracy train: 0.998345 val: 0.734328 test: 0.720257
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({2: 3142, 0: 2735, 1: 1523})

Epoch :  52 loss training:  13.779121012426913 Time :  11316
accuracy train: 0.998015 val: 0.746269 test: 0.722978
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({0: 3144, 1: 2734, 2: 1522})

Epoch :  53 loss training:  11.532660122960806 Time :  11403
accuracy train: 0.999007 val: 0.740299 test: 0.724462
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({1: 3143, 0: 2737, 2: 1520})

Epoch :  54 loss training:  12.007728947326541 Time :  11487
accuracy train: 0.998345 val: 0.743284 test: 0.720752
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({1: 3149, 0: 2733, 2: 1518})

Epoch :  55 loss training:  11.994991730898619 Time :  11569
accuracy train: 0.999669 val: 0.743284 test: 0.720010
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({2: 3149, 0: 2736, 1: 1515})

Epoch :  56 loss training:  10.94915828667581 Time :  11647
accuracy train: 0.999669 val: 0.752239 test: 0.715805
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({1: 3156, 0: 2739, 2: 1505})

Epoch :  57 loss training:  12.093542236834764 Time :  11724
accuracy train: 0.999338 val: 0.746269 test: 0.718773
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({2: 3163, 0: 2740, 1: 1497})

Epoch :  58 loss training:  10.397113863378763 Time :  11800
accuracy train: 0.999338 val: 0.752239 test: 0.720752
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({2: 3164, 0: 2741, 1: 1495})

Epoch :  59 loss training:  10.299306879751384 Time :  11881
accuracy train: 0.999338 val: 0.737313 test: 0.718031
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({2: 3163, 0: 2742, 1: 1495})

Epoch :  60 loss training:  9.236025302670896 Time :  11966
accuracy train: 1.000000 val: 0.731343 test: 0.711353
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({2: 3164, 0: 2746, 1: 1490})

Epoch :  61 loss training:  9.214859921019524 Time :  12048
accuracy train: 1.000000 val: 0.755224 test: 0.720752
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({2: 3164, 0: 2748, 1: 1488})

Epoch :  62 loss training:  8.489270631223917 Time :  12127
accuracy train: 1.000000 val: 0.743284 test: 0.720505
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({1: 3166, 0: 2748, 2: 1486})

Epoch :  63 loss training:  8.366534477099776 Time :  12201
accuracy train: 1.000000 val: 0.752239 test: 0.722483
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({1: 3169, 0: 2750, 2: 1481})

Epoch :  64 loss training:  7.3736534575000405 Time :  12282
accuracy train: 1.000000 val: 0.752239 test: 0.723473
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({2: 3169, 0: 2750, 1: 1481})

Epoch :  65 loss training:  8.003377546556294 Time :  12369
accuracy train: 1.000000 val: 0.746269 test: 0.721741
max validation accuracy : 0.764179 max acc epoch : 34 test accuracy : 0.718526
Counter({0: 3174, 2: 2747, 1: 1479})

========================================================================================================================================================================================================
max acc epoch :  34
max validation accuracy :  0.764179104477612
test accuracy :  0.7185258471432104
last test_accuracy :  0.7217412812268118
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=4, num_mlp_layers=1, random_vec=False, seed=244, weight_decay=1e-08)
device :  cuda:0
Counter({1: 2607, 0: 2532, 2: 2261})

Epoch :  1 loss training:  219.59023118019104 Time :  12559
accuracy train: 0.617472 val: 0.558209 test: 0.575810
max validation accuracy : 0.558209 max acc epoch : 1 test accuracy : 0.575810
Counter({0: 3463, 1: 2285, 2: 1652})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  152.36102277040482 Time :  12672
accuracy train: 0.703839 val: 0.641791 test: 0.648528
max validation accuracy : 0.641791 max acc epoch : 2 test accuracy : 0.648528
Counter({1: 3634, 0: 2192, 2: 1574})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  130.88494443893433 Time :  12763
accuracy train: 0.742886 val: 0.668657 test: 0.668810
max validation accuracy : 0.668657 max acc epoch : 3 test accuracy : 0.668810
Counter({0: 2964, 1: 2845, 2: 1591})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  99.18533697724342 Time :  12872
accuracy train: 0.779285 val: 0.680597 test: 0.697007
max validation accuracy : 0.680597 max acc epoch : 4 test accuracy : 0.697007
Counter({1: 3005, 0: 2814, 2: 1581})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  92.43061551451683 Time :  12963
accuracy train: 0.808405 val: 0.695522 test: 0.695276
max validation accuracy : 0.695522 max acc epoch : 5 test accuracy : 0.695276
Counter({2: 3032, 0: 2796, 1: 1572})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.8638727068901 Time :  13046
accuracy train: 0.817340 val: 0.719403 test: 0.693792
max validation accuracy : 0.719403 max acc epoch : 6 test accuracy : 0.693792
Counter({2: 3028, 0: 2806, 1: 1566})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  74.51845535635948 Time :  13132
accuracy train: 0.851754 val: 0.710448 test: 0.703438
max validation accuracy : 0.719403 max acc epoch : 6 test accuracy : 0.693792
Counter({1: 3036, 0: 2794, 2: 1570})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  69.4136158823967 Time :  13224
accuracy train: 0.862012 val: 0.731343 test: 0.701954
max validation accuracy : 0.731343 max acc epoch : 8 test accuracy : 0.701954
Counter({1: 2786, 0: 2445, 2: 2169})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  67.43888844549656 Time :  13315
accuracy train: 0.877565 val: 0.710448 test: 0.705169
max validation accuracy : 0.731343 max acc epoch : 8 test accuracy : 0.701954
Counter({1: 2803, 2: 2451, 0: 2146})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.21304826438427 Time :  13391
accuracy train: 0.887161 val: 0.722388 test: 0.709374
max validation accuracy : 0.731343 max acc epoch : 8 test accuracy : 0.701954
Counter({0: 2808, 1: 2455, 2: 2137})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.0495036020875 Time :  13464
accuracy train: 0.892124 val: 0.731343 test: 0.713332
max validation accuracy : 0.731343 max acc epoch : 8 test accuracy : 0.701954
Counter({0: 2813, 1: 2457, 2: 2130})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  56.28817071020603 Time :  13536
accuracy train: 0.904368 val: 0.728358 test: 0.713084
max validation accuracy : 0.731343 max acc epoch : 8 test accuracy : 0.701954
Counter({0: 2829, 1: 2459, 2: 2112})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  51.566069439053535 Time :  13617
accuracy train: 0.907677 val: 0.722388 test: 0.713826
max validation accuracy : 0.731343 max acc epoch : 8 test accuracy : 0.701954
Counter({0: 2828, 1: 2461, 2: 2111})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  51.887658424675465 Time :  13696
accuracy train: 0.908339 val: 0.725373 test: 0.713332
max validation accuracy : 0.731343 max acc epoch : 8 test accuracy : 0.701954
Counter({0: 2827, 1: 2458, 2: 2115})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  50.49693664908409 Time :  13768
accuracy train: 0.909993 val: 0.728358 test: 0.711600
max validation accuracy : 0.731343 max acc epoch : 8 test accuracy : 0.701954
Counter({0: 2827, 1: 2457, 2: 2116})

Epoch :  16 loss training:  50.08867289125919 Time :  13844
accuracy train: 0.915619 val: 0.722388 test: 0.713332
max validation accuracy : 0.731343 max acc epoch : 8 test accuracy : 0.701954
Counter({0: 2829, 1: 2458, 2: 2113})

Epoch :  17 loss training:  47.9286343306303 Time :  13922
accuracy train: 0.923891 val: 0.716418 test: 0.715310
max validation accuracy : 0.731343 max acc epoch : 8 test accuracy : 0.701954
Counter({0: 2829, 1: 2460, 2: 2111})

Epoch :  18 loss training:  45.80741003155708 Time :  13998
accuracy train: 0.919590 val: 0.731343 test: 0.714321
max validation accuracy : 0.731343 max acc epoch : 8 test accuracy : 0.701954
Counter({0: 2838, 2: 2459, 1: 2103})

Epoch :  19 loss training:  45.43078624457121 Time :  14073
accuracy train: 0.931171 val: 0.731343 test: 0.715558
max validation accuracy : 0.731343 max acc epoch : 8 test accuracy : 0.701954
Counter({0: 2842, 1: 2458, 2: 2100})

Epoch :  20 loss training:  42.905727341771126 Time :  14150
accuracy train: 0.930179 val: 0.737313 test: 0.719515
max validation accuracy : 0.737313 max acc epoch : 20 test accuracy : 0.719515
Counter({1: 2845, 2: 2456, 0: 2099})

Epoch :  21 loss training:  41.84595464169979 Time :  14222
accuracy train: 0.938120 val: 0.734328 test: 0.714816
max validation accuracy : 0.737313 max acc epoch : 20 test accuracy : 0.719515
Counter({0: 2848, 1: 2456, 2: 2096})

Epoch :  22 loss training:  40.69165373593569 Time :  14296
accuracy train: 0.942753 val: 0.734328 test: 0.716300
max validation accuracy : 0.737313 max acc epoch : 20 test accuracy : 0.719515
Counter({0: 2850, 1: 2457, 2: 2093})

Epoch :  23 loss training:  38.884055100381374 Time :  14370
accuracy train: 0.948048 val: 0.737313 test: 0.715805
max validation accuracy : 0.737313 max acc epoch : 20 test accuracy : 0.719515
Counter({0: 2854, 2: 2459, 1: 2087})

Epoch :  24 loss training:  37.40580268204212 Time :  14449
accuracy train: 0.955659 val: 0.737313 test: 0.716052
max validation accuracy : 0.737313 max acc epoch : 20 test accuracy : 0.719515
Counter({2: 2843, 1: 2470, 0: 2087})

Epoch :  25 loss training:  37.497000217437744 Time :  14537
accuracy train: 0.954666 val: 0.743284 test: 0.713084
max validation accuracy : 0.743284 max acc epoch : 25 test accuracy : 0.713084
Counter({1: 2845, 2: 2475, 0: 2080})

Epoch :  26 loss training:  35.64077825844288 Time :  14625
accuracy train: 0.956651 val: 0.749254 test: 0.718773
max validation accuracy : 0.749254 max acc epoch : 26 test accuracy : 0.718773
Counter({0: 2848, 2: 2481, 1: 2071})

Epoch :  27 loss training:  34.18260310590267 Time :  14708
accuracy train: 0.960953 val: 0.752239 test: 0.720010
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.720010
Counter({0: 2851, 2: 2481, 1: 2068})

Epoch :  28 loss training:  32.397753946483135 Time :  14785
accuracy train: 0.963931 val: 0.746269 test: 0.716794
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.720010
Counter({1: 2850, 2: 2479, 0: 2071})

Epoch :  29 loss training:  32.8950020968914 Time :  14864
accuracy train: 0.967240 val: 0.749254 test: 0.718279
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.720010
Counter({0: 2852, 1: 2479, 2: 2069})

Epoch :  30 loss training:  31.22715735808015 Time :  14944
accuracy train: 0.974189 val: 0.743284 test: 0.720010
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.720010
Counter({0: 2852, 2: 2479, 1: 2069})

Epoch :  31 loss training:  29.73343548923731 Time :  15027
accuracy train: 0.975513 val: 0.737313 test: 0.715063
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.720010
Counter({0: 2854, 1: 2488, 2: 2058})

Epoch :  32 loss training:  28.095170944929123 Time :  15101
accuracy train: 0.976837 val: 0.746269 test: 0.714321
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.720010
Counter({0: 2855, 1: 2489, 2: 2056})

Epoch :  33 loss training:  27.289499528706074 Time :  15169
accuracy train: 0.973197 val: 0.731343 test: 0.717784
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.720010
Counter({1: 2858, 2: 2488, 0: 2054})

Epoch :  34 loss training:  26.167568240314722 Time :  15249
accuracy train: 0.976506 val: 0.734328 test: 0.718526
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.720010
Counter({2: 2865, 1: 2484, 0: 2051})

Epoch :  35 loss training:  24.96120198071003 Time :  15334
accuracy train: 0.987426 val: 0.737313 test: 0.717536
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.720010
Counter({0: 2871, 1: 2480, 2: 2049})

Epoch :  36 loss training:  24.556682392954826 Time :  15419
accuracy train: 0.984447 val: 0.743284 test: 0.718526
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.720010
Counter({2: 2870, 1: 2483, 0: 2047})

Epoch :  37 loss training:  23.120285250246525 Time :  15500
accuracy train: 0.985440 val: 0.749254 test: 0.719515
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.720010
Counter({0: 2869, 1: 2482, 2: 2049})

Epoch :  38 loss training:  22.087070364505053 Time :  15580
accuracy train: 0.986102 val: 0.728358 test: 0.721247
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.720010
Counter({0: 2873, 1: 2483, 2: 2044})

Epoch :  39 loss training:  23.539242938160896 Time :  15655
accuracy train: 0.990735 val: 0.746269 test: 0.721247
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.720010
Counter({0: 2872, 1: 2484, 2: 2044})

Epoch :  40 loss training:  21.238536149263382 Time :  15736
accuracy train: 0.991727 val: 0.749254 test: 0.722236
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.720010
Counter({0: 2872, 1: 2485, 2: 2043})

Epoch :  41 loss training:  20.442501744255424 Time :  15811
accuracy train: 0.991727 val: 0.737313 test: 0.720752
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.720010
Counter({0: 2879, 1: 2476, 2: 2045})

Epoch :  42 loss training:  18.220024295151234 Time :  15888
accuracy train: 0.990735 val: 0.746269 test: 0.722483
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.720010
Counter({2: 2880, 1: 2477, 0: 2043})

Epoch :  43 loss training:  19.2412183098495 Time :  15969
accuracy train: 0.991066 val: 0.737313 test: 0.720257
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.720010
Counter({0: 2882, 1: 2478, 2: 2040})

Epoch :  44 loss training:  16.7362238522619 Time :  16049
accuracy train: 0.994044 val: 0.737313 test: 0.719268
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.720010
Counter({0: 2879, 2: 2480, 1: 2041})

Epoch :  45 loss training:  16.618155010044575 Time :  16130
accuracy train: 0.994705 val: 0.740299 test: 0.718526
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.720010
Counter({2: 2877, 1: 2478, 0: 2045})

Epoch :  46 loss training:  15.669068723917007 Time :  16211
accuracy train: 0.994375 val: 0.746269 test: 0.725204
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.720010
Counter({0: 2878, 1: 2475, 2: 2047})

Epoch :  47 loss training:  15.888944376260042 Time :  16287
accuracy train: 0.995036 val: 0.743284 test: 0.724215
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.720010
Counter({0: 2878, 1: 2477, 2: 2045})

Epoch :  48 loss training:  13.93584100715816 Time :  16366
accuracy train: 0.995698 val: 0.755224 test: 0.722483
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({2: 2880, 1: 2475, 0: 2045})

Epoch :  49 loss training:  13.458017695695162 Time :  16449
accuracy train: 0.997022 val: 0.743284 test: 0.717289
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({0: 2885, 1: 2469, 2: 2046})

Epoch :  50 loss training:  14.392166152596474 Time :  16533
accuracy train: 0.998345 val: 0.749254 test: 0.720505
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({0: 2884, 2: 2463, 1: 2053})

Epoch :  51 loss training:  13.165859011933208 Time :  16624
accuracy train: 0.997022 val: 0.740299 test: 0.719268
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({0: 2885, 1: 2457, 2: 2058})

Epoch :  52 loss training:  13.9127929918468 Time :  16708
accuracy train: 0.998345 val: 0.749254 test: 0.724462
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({0: 2878, 1: 2455, 2: 2067})

Epoch :  53 loss training:  11.600811634212732 Time :  16809
accuracy train: 0.998345 val: 0.746269 test: 0.723225
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({1: 2878, 2: 2455, 0: 2067})

Epoch :  54 loss training:  11.45681287907064 Time :  16933
accuracy train: 0.998676 val: 0.737313 test: 0.721494
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({2: 2878, 1: 2459, 0: 2063})

Epoch :  55 loss training:  11.632701745256782 Time :  17075
accuracy train: 0.998345 val: 0.740299 test: 0.719515
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({0: 2877, 1: 2460, 2: 2063})

Epoch :  56 loss training:  10.954346589744091 Time :  17207
accuracy train: 0.998345 val: 0.749254 test: 0.714816
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({0: 2878, 2: 2454, 1: 2068})

Epoch :  57 loss training:  11.23597863689065 Time :  17331
accuracy train: 0.999669 val: 0.746269 test: 0.720010
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({0: 2877, 2: 2454, 1: 2069})

Epoch :  58 loss training:  9.672709802165627 Time :  17469
accuracy train: 0.999669 val: 0.755224 test: 0.722731
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({1: 2880, 2: 2451, 0: 2069})

Epoch :  59 loss training:  8.943153738975525 Time :  17593
accuracy train: 0.999007 val: 0.737313 test: 0.719268
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({0: 2879, 1: 2453, 2: 2068})

Epoch :  60 loss training:  9.813911639153957 Time :  17738
accuracy train: 1.000000 val: 0.737313 test: 0.723967
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({0: 2881, 1: 2451, 2: 2068})

Epoch :  61 loss training:  8.907368417829275 Time :  17884
accuracy train: 0.999669 val: 0.740299 test: 0.722731
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({2: 2878, 1: 2452, 0: 2070})

Epoch :  62 loss training:  8.881647184491158 Time :  17989
accuracy train: 0.999669 val: 0.734328 test: 0.721741
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({0: 2882, 2: 2452, 1: 2066})

Epoch :  63 loss training:  9.342610133811831 Time :  18132
accuracy train: 1.000000 val: 0.737313 test: 0.716300
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({0: 2883, 2: 2449, 1: 2068})

Epoch :  64 loss training:  7.357094177976251 Time :  18250
accuracy train: 1.000000 val: 0.737313 test: 0.721741
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({0: 2884, 2: 2449, 1: 2067})

Epoch :  65 loss training:  7.821135599166155 Time :  18388
accuracy train: 1.000000 val: 0.734328 test: 0.721989
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({0: 2886, 1: 2441, 2: 2073})

Epoch :  66 loss training:  8.001378489192575 Time :  18497
accuracy train: 1.000000 val: 0.731343 test: 0.722236
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({1: 2886, 2: 2434, 0: 2080})

Epoch :  67 loss training:  7.134465244598687 Time :  18607
accuracy train: 1.000000 val: 0.752239 test: 0.721494
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({0: 2888, 2: 2433, 1: 2079})

Epoch :  68 loss training:  8.235078995116055 Time :  18730
accuracy train: 1.000000 val: 0.740299 test: 0.720999
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({0: 2887, 1: 2434, 2: 2079})

Epoch :  69 loss training:  7.140503521077335 Time :  18845
accuracy train: 1.000000 val: 0.728358 test: 0.719021
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({0: 2886, 1: 2433, 2: 2081})

Epoch :  70 loss training:  6.340688955038786 Time :  18970
accuracy train: 1.000000 val: 0.749254 test: 0.719515
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({0: 2887, 2: 2433, 1: 2080})

Epoch :  71 loss training:  5.998350068926811 Time :  19113
accuracy train: 1.000000 val: 0.746269 test: 0.723473
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({0: 2887, 1: 2435, 2: 2078})

Epoch :  72 loss training:  6.560735174454749 Time :  19220
accuracy train: 1.000000 val: 0.725373 test: 0.714321
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({0: 2888, 1: 2435, 2: 2077})

Epoch :  73 loss training:  5.321315764915198 Time :  19356
accuracy train: 1.000000 val: 0.746269 test: 0.720999
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({2: 2891, 1: 2436, 0: 2073})

Epoch :  74 loss training:  5.892437746748328 Time :  19470
accuracy train: 1.000000 val: 0.728358 test: 0.714074
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({0: 2891, 2: 2437, 1: 2072})

Epoch :  75 loss training:  5.607974882237613 Time :  19607
accuracy train: 1.000000 val: 0.743284 test: 0.721989
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({0: 2898, 2: 2434, 1: 2068})

Epoch :  76 loss training:  5.58745973976329 Time :  19725
accuracy train: 1.000000 val: 0.728358 test: 0.719515
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({0: 2896, 2: 2435, 1: 2069})

Epoch :  77 loss training:  4.96679441165179 Time :  19846
accuracy train: 1.000000 val: 0.731343 test: 0.720257
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({0: 2895, 1: 2436, 2: 2069})

Epoch :  78 loss training:  4.6509206225164235 Time :  19957
accuracy train: 1.000000 val: 0.725373 test: 0.720010
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({1: 2892, 2: 2437, 0: 2071})

Epoch :  79 loss training:  4.07339107291773 Time :  20086
accuracy train: 1.000000 val: 0.737313 test: 0.718526
max validation accuracy : 0.755224 max acc epoch : 48 test accuracy : 0.722483
Counter({0: 2888, 1: 2437, 2: 2075})

========================================================================================================================================================================================================
max acc epoch :  48
max validation accuracy :  0.755223880597015
test accuracy :  0.7224833044768736
last test_accuracy :  0.7185258471432104
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=4, num_mlp_layers=1, random_vec=False, seed=244, weight_decay=1e-08)
device :  cuda:0
Counter({1: 2607, 0: 2532, 2: 2261})

Epoch :  1 loss training:  219.86139500141144 Time :  20380
accuracy train: 0.620781 val: 0.567164 test: 0.578283
max validation accuracy : 0.567164 max acc epoch : 1 test accuracy : 0.578283
Counter({0: 3580, 1: 2099, 2: 1721})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  151.61316347122192 Time :  20540
accuracy train: 0.710126 val: 0.659701 test: 0.655949
max validation accuracy : 0.659701 max acc epoch : 2 test accuracy : 0.655949
Counter({1: 2941, 0: 2266, 2: 2193})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  130.83567395806313 Time :  20693
accuracy train: 0.748842 val: 0.680597 test: 0.666090
max validation accuracy : 0.680597 max acc epoch : 3 test accuracy : 0.666090
Counter({0: 2802, 2: 2372, 1: 2226})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.32382833957672 Time :  20833
accuracy train: 0.782263 val: 0.674627 test: 0.690082
max validation accuracy : 0.680597 max acc epoch : 3 test accuracy : 0.666090
Counter({0: 2821, 2: 2439, 1: 2140})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  92.07191035151482 Time :  20969
accuracy train: 0.804765 val: 0.692537 test: 0.698986
max validation accuracy : 0.692537 max acc epoch : 5 test accuracy : 0.698986
Counter({0: 2843, 1: 2453, 2: 2104})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  85.02357986569405 Time :  21068
accuracy train: 0.813369 val: 0.719403 test: 0.694286
max validation accuracy : 0.719403 max acc epoch : 6 test accuracy : 0.694286
Counter({0: 2822, 2: 2480, 1: 2098})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  74.85348418354988 Time :  21197
accuracy train: 0.849437 val: 0.707463 test: 0.700223
max validation accuracy : 0.719403 max acc epoch : 6 test accuracy : 0.694286
Counter({2: 2835, 1: 2479, 0: 2086})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.80956068634987 Time :  21317
accuracy train: 0.863005 val: 0.725373 test: 0.700470
max validation accuracy : 0.725373 max acc epoch : 8 test accuracy : 0.700470
Counter({0: 2864, 1: 2475, 2: 2061})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.56506499648094 Time :  21464
accuracy train: 0.876241 val: 0.701493 test: 0.704180
max validation accuracy : 0.725373 max acc epoch : 8 test accuracy : 0.700470
Counter({0: 2883, 1: 2480, 2: 2037})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.67666129767895 Time :  21614
accuracy train: 0.892124 val: 0.734328 test: 0.713579
max validation accuracy : 0.734328 max acc epoch : 10 test accuracy : 0.713579
Counter({0: 2893, 1: 2475, 2: 2032})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  57.40279033780098 Time :  21734
accuracy train: 0.897088 val: 0.731343 test: 0.706901
max validation accuracy : 0.734328 max acc epoch : 10 test accuracy : 0.713579
Counter({0: 2879, 1: 2490, 2: 2031})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  55.56900805234909 Time :  21881
accuracy train: 0.905030 val: 0.749254 test: 0.713084
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2895, 2: 2486, 1: 2019})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  52.241986602544785 Time :  22009
accuracy train: 0.905361 val: 0.740299 test: 0.716052
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2898, 2: 2487, 1: 2015})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  50.697112649679184 Time :  22138
accuracy train: 0.905361 val: 0.740299 test: 0.714074
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2899, 1: 2487, 2: 2014})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  50.95232969522476 Time :  22275
accuracy train: 0.910986 val: 0.740299 test: 0.711600
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2896, 1: 2488, 2: 2016})

Epoch :  16 loss training:  49.42884540557861 Time :  22404
accuracy train: 0.914957 val: 0.728358 test: 0.715310
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2897, 2: 2485, 1: 2018})

Epoch :  17 loss training:  48.74901303648949 Time :  22544
accuracy train: 0.918597 val: 0.728358 test: 0.716300
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2897, 2: 2485, 1: 2018})

Epoch :  18 loss training:  46.50509925186634 Time :  22666
accuracy train: 0.926870 val: 0.737313 test: 0.711353
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({2: 2900, 1: 2487, 0: 2013})

Epoch :  19 loss training:  45.51582399010658 Time :  22808
accuracy train: 0.928524 val: 0.743284 test: 0.716052
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2905, 2: 2485, 1: 2010})

Epoch :  20 loss training:  43.818019814789295 Time :  22921
accuracy train: 0.928193 val: 0.728358 test: 0.717289
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2906, 1: 2484, 2: 2010})

Epoch :  21 loss training:  41.520815163850784 Time :  23055
accuracy train: 0.938451 val: 0.746269 test: 0.715063
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2912, 1: 2486, 2: 2002})

Epoch :  22 loss training:  40.517241917550564 Time :  23162
accuracy train: 0.939775 val: 0.749254 test: 0.715063
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2914, 2: 2487, 1: 1999})

Epoch :  23 loss training:  39.01464272290468 Time :  23289
accuracy train: 0.943415 val: 0.746269 test: 0.713084
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2911, 1: 2496, 2: 1993})

Epoch :  24 loss training:  38.88130147755146 Time :  23405
accuracy train: 0.953342 val: 0.734328 test: 0.715805
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2908, 1: 2499, 2: 1993})

Epoch :  25 loss training:  37.403679840266705 Time :  23551
accuracy train: 0.956651 val: 0.737313 test: 0.715558
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2909, 1: 2499, 2: 1992})

Epoch :  26 loss training:  35.019494876265526 Time :  23666
accuracy train: 0.956320 val: 0.737313 test: 0.718279
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2914, 1: 2498, 2: 1988})

Epoch :  27 loss training:  34.30688504129648 Time :  23805
accuracy train: 0.960953 val: 0.737313 test: 0.720010
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({2: 2912, 1: 2497, 0: 1991})

Epoch :  28 loss training:  34.037364177405834 Time :  23923
accuracy train: 0.964924 val: 0.740299 test: 0.717536
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2914, 2: 2500, 1: 1986})

Epoch :  29 loss training:  32.7675319686532 Time :  24053
accuracy train: 0.965255 val: 0.740299 test: 0.713579
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2913, 1: 2502, 2: 1985})

Epoch :  30 loss training:  32.14119674265385 Time :  24170
accuracy train: 0.972866 val: 0.749254 test: 0.717784
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2916, 2: 2499, 1: 1985})

Epoch :  31 loss training:  29.331156566739082 Time :  24327
accuracy train: 0.977167 val: 0.740299 test: 0.715310
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2920, 2: 2500, 1: 1980})

Epoch :  32 loss training:  28.516693379729986 Time :  24452
accuracy train: 0.978160 val: 0.737313 test: 0.716547
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2922, 1: 2494, 2: 1984})

Epoch :  33 loss training:  27.53986220806837 Time :  24566
accuracy train: 0.974189 val: 0.746269 test: 0.715805
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2922, 2: 2494, 1: 1984})

Epoch :  34 loss training:  27.406587585806847 Time :  24684
accuracy train: 0.980807 val: 0.740299 test: 0.715310
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2920, 2: 2493, 1: 1987})

Epoch :  35 loss training:  26.05880520492792 Time :  24803
accuracy train: 0.983786 val: 0.734328 test: 0.716300
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2919, 2: 2497, 1: 1984})

Epoch :  36 loss training:  24.58733068406582 Time :  24920
accuracy train: 0.984116 val: 0.743284 test: 0.719021
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2917, 2: 2504, 1: 1979})

Epoch :  37 loss training:  23.572837632149458 Time :  25020
accuracy train: 0.985771 val: 0.737313 test: 0.719515
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2918, 2: 2506, 1: 1976})

Epoch :  38 loss training:  22.352960808202624 Time :  25161
accuracy train: 0.989411 val: 0.725373 test: 0.715310
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({2: 2919, 1: 2505, 0: 1976})

Epoch :  39 loss training:  22.117066085338593 Time :  25276
accuracy train: 0.987426 val: 0.731343 test: 0.717536
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({2: 2921, 1: 2502, 0: 1977})

Epoch :  40 loss training:  20.896188851445913 Time :  25407
accuracy train: 0.991727 val: 0.731343 test: 0.721741
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2918, 2: 2504, 1: 1978})

Epoch :  41 loss training:  20.31081121787429 Time :  25524
accuracy train: 0.990735 val: 0.740299 test: 0.717536
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2918, 1: 2503, 2: 1979})

Epoch :  42 loss training:  20.12428667396307 Time :  25673
accuracy train: 0.990404 val: 0.746269 test: 0.719268
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2919, 2: 2501, 1: 1980})

Epoch :  43 loss training:  19.451012421399355 Time :  25788
accuracy train: 0.993051 val: 0.731343 test: 0.721494
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.713084
Counter({0: 2909, 1: 2504, 2: 1987})

========================================================================================================================================================================================================
max acc epoch :  12
max validation accuracy :  0.7492537313432835
test accuracy :  0.7130843433094237
last test_accuracy :  0.7214939401434578
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.75821 	 test_accuracy : 0.72421 	 max_acc epoch :  40 	 last test_accuracy : 0.71853
k :  1 	 val_accuracy : 0.76418 	 test_accuracy : 0.71853 	 max_acc epoch :  34 	 last test_accuracy : 0.72174
k :  2 	 val_accuracy : 0.75522 	 test_accuracy : 0.72248 	 max_acc epoch :  48 	 last test_accuracy : 0.71853
k :  3 	 val_accuracy : 0.74925 	 test_accuracy : 0.71308 	 max_acc epoch :  12 	 last test_accuracy : 0.72149

avg :  	 val_accuracy : 0.75672 	 test_accuracy : 0.71958 	 last_accuracy : 0.72007
