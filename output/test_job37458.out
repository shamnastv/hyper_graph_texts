

date and time :  Tue Jun 15 18:21:22 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=50, lda=False, lr=0.001, num_clusters=2, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=683, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  58.63273447006941 Time :  29
accuracy train: 0.936056 val: 0.926061 test: 0.929680
max validation accuracy : 0.926061 max acc epoch : 1 test accuracy : 0.929680
Counter({0: 4329, 1: 3362})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  21.854976799339056 Time :  61
accuracy train: 0.966210 val: 0.951515 test: 0.959817
max validation accuracy : 0.951515 max acc epoch : 2 test accuracy : 0.959817
Counter({1: 4129, 0: 3562})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  17.766253035515547 Time :  84
accuracy train: 0.965997 val: 0.947879 test: 0.960731
max validation accuracy : 0.951515 max acc epoch : 2 test accuracy : 0.959817
Counter({0: 4108, 1: 3583})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  12.99380868114531 Time :  116
accuracy train: 0.979683 val: 0.963636 test: 0.960731
max validation accuracy : 0.963636 max acc epoch : 4 test accuracy : 0.960731
Counter({0: 4086, 1: 3605})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  11.199383365921676 Time :  137
accuracy train: 0.979256 val: 0.957576 test: 0.973059
max validation accuracy : 0.963636 max acc epoch : 4 test accuracy : 0.960731
Counter({0: 4030, 1: 3661})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  12.239192178472877 Time :  171
accuracy train: 0.980967 val: 0.952727 test: 0.969863
max validation accuracy : 0.963636 max acc epoch : 4 test accuracy : 0.960731
Counter({1: 3959, 0: 3732})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  9.90228463895619 Time :  193
accuracy train: 0.982464 val: 0.960000 test: 0.968037
max validation accuracy : 0.963636 max acc epoch : 4 test accuracy : 0.960731
Counter({1: 3960, 0: 3731})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  8.849678698927164 Time :  215
accuracy train: 0.983961 val: 0.957576 test: 0.968950
max validation accuracy : 0.963636 max acc epoch : 4 test accuracy : 0.960731
Counter({0: 3946, 1: 3745})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  8.822319342754781 Time :  242
accuracy train: 0.985244 val: 0.960000 test: 0.970776
max validation accuracy : 0.963636 max acc epoch : 4 test accuracy : 0.960731
Counter({0: 3946, 1: 3745})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  8.019764279481024 Time :  264
accuracy train: 0.985885 val: 0.961212 test: 0.970320
max validation accuracy : 0.963636 max acc epoch : 4 test accuracy : 0.960731
Counter({0: 3929, 1: 3762})

Epoch :  11 loss training:  8.415526594035327 Time :  286
accuracy train: 0.986741 val: 0.968485 test: 0.970320
max validation accuracy : 0.968485 max acc epoch : 11 test accuracy : 0.970320
Counter({0: 3915, 1: 3776})

Epoch :  12 loss training:  7.6924169776029885 Time :  305
accuracy train: 0.989093 val: 0.963636 test: 0.968493
max validation accuracy : 0.968485 max acc epoch : 11 test accuracy : 0.970320
Counter({1: 3907, 0: 3784})

Epoch :  13 loss training:  7.508795702131465 Time :  336
accuracy train: 0.990590 val: 0.962424 test: 0.968493
max validation accuracy : 0.968485 max acc epoch : 11 test accuracy : 0.970320
Counter({1: 3873, 0: 3818})

Epoch :  14 loss training:  6.8920451471349224 Time :  355
accuracy train: 0.990590 val: 0.964848 test: 0.969406
max validation accuracy : 0.968485 max acc epoch : 11 test accuracy : 0.970320
Counter({0: 3867, 1: 3824})

Epoch :  15 loss training:  6.380577651550993 Time :  380
accuracy train: 0.992087 val: 0.964848 test: 0.970776
max validation accuracy : 0.968485 max acc epoch : 11 test accuracy : 0.970320
Counter({1: 3853, 0: 3838})

Epoch :  16 loss training:  5.841985802631825 Time :  396
accuracy train: 0.992301 val: 0.968485 test: 0.970320
max validation accuracy : 0.968485 max acc epoch : 11 test accuracy : 0.970320
Counter({0: 3849, 1: 3842})

Epoch :  17 loss training:  5.963636329048313 Time :  423
accuracy train: 0.992943 val: 0.964848 test: 0.971689
max validation accuracy : 0.968485 max acc epoch : 11 test accuracy : 0.970320
Counter({1: 3847, 0: 3844})

Epoch :  18 loss training:  5.396358070196584 Time :  444
accuracy train: 0.992301 val: 0.966061 test: 0.972603
max validation accuracy : 0.968485 max acc epoch : 11 test accuracy : 0.970320
Counter({1: 3847, 0: 3844})

Epoch :  19 loss training:  5.930853637168184 Time :  470
accuracy train: 0.993798 val: 0.966061 test: 0.972603
max validation accuracy : 0.968485 max acc epoch : 11 test accuracy : 0.970320
Counter({1: 3846, 0: 3845})

Epoch :  20 loss training:  4.917447614483535 Time :  490
accuracy train: 0.994654 val: 0.966061 test: 0.971233
max validation accuracy : 0.968485 max acc epoch : 11 test accuracy : 0.970320
Counter({1: 3849, 0: 3842})

Epoch :  21 loss training:  4.31221224705223 Time :  511
accuracy train: 0.992729 val: 0.962424 test: 0.968037
max validation accuracy : 0.968485 max acc epoch : 11 test accuracy : 0.970320
Counter({1: 3852, 0: 3839})

Epoch :  22 loss training:  5.201146990410052 Time :  528
accuracy train: 0.995081 val: 0.970909 test: 0.969863
max validation accuracy : 0.970909 max acc epoch : 22 test accuracy : 0.969863
Counter({1: 3856, 0: 3835})

Epoch :  23 loss training:  4.395259145647287 Time :  549
accuracy train: 0.995509 val: 0.969697 test: 0.970320
max validation accuracy : 0.970909 max acc epoch : 22 test accuracy : 0.969863
Counter({1: 3857, 0: 3834})

Epoch :  24 loss training:  4.208247372531332 Time :  573
accuracy train: 0.995509 val: 0.968485 test: 0.969863
max validation accuracy : 0.970909 max acc epoch : 22 test accuracy : 0.969863
Counter({1: 3860, 0: 3831})

Epoch :  25 loss training:  4.260695761535317 Time :  596
accuracy train: 0.996151 val: 0.969697 test: 0.970776
max validation accuracy : 0.970909 max acc epoch : 22 test accuracy : 0.969863
Counter({1: 3862, 0: 3829})

Epoch :  26 loss training:  3.8749262327328324 Time :  617
accuracy train: 0.995723 val: 0.970909 test: 0.974886
max validation accuracy : 0.970909 max acc epoch : 22 test accuracy : 0.969863
Counter({1: 3862, 0: 3829})

Epoch :  27 loss training:  3.7066244260640815 Time :  643
accuracy train: 0.995937 val: 0.972121 test: 0.971233
max validation accuracy : 0.972121 max acc epoch : 27 test accuracy : 0.971233
Counter({0: 3864, 1: 3827})

Epoch :  28 loss training:  3.6188296757172793 Time :  665
accuracy train: 0.996578 val: 0.967273 test: 0.971689
max validation accuracy : 0.972121 max acc epoch : 27 test accuracy : 0.971233
Counter({1: 3883, 0: 3808})

Epoch :  29 loss training:  3.4785942820599303 Time :  690
accuracy train: 0.996364 val: 0.970909 test: 0.972146
max validation accuracy : 0.972121 max acc epoch : 27 test accuracy : 0.971233
Counter({0: 3881, 1: 3810})

Epoch :  30 loss training:  2.9610570912482217 Time :  708
accuracy train: 0.996364 val: 0.969697 test: 0.972603
max validation accuracy : 0.972121 max acc epoch : 27 test accuracy : 0.971233
Counter({1: 3892, 0: 3799})

Epoch :  31 loss training:  3.0236219274811447 Time :  736
accuracy train: 0.996364 val: 0.972121 test: 0.970776
max validation accuracy : 0.972121 max acc epoch : 27 test accuracy : 0.971233
Counter({1: 3894, 0: 3797})

Epoch :  32 loss training:  2.7562371742678806 Time :  755
accuracy train: 0.996364 val: 0.973333 test: 0.974429
max validation accuracy : 0.973333 max acc epoch : 32 test accuracy : 0.974429
Counter({0: 3894, 1: 3797})

Epoch :  33 loss training:  3.104598324804101 Time :  780
accuracy train: 0.996364 val: 0.970909 test: 0.973516
max validation accuracy : 0.973333 max acc epoch : 32 test accuracy : 0.974429
Counter({0: 3893, 1: 3798})

Epoch :  34 loss training:  2.7945574658515397 Time :  799
accuracy train: 0.996578 val: 0.973333 test: 0.972146
max validation accuracy : 0.973333 max acc epoch : 32 test accuracy : 0.974429
Counter({0: 3891, 1: 3800})

Epoch :  35 loss training:  2.4821375218452886 Time :  827
accuracy train: 0.996792 val: 0.975758 test: 0.974429
max validation accuracy : 0.975758 max acc epoch : 35 test accuracy : 0.974429
Counter({0: 3896, 1: 3795})

Epoch :  36 loss training:  2.5529216430149972 Time :  848
accuracy train: 0.996792 val: 0.972121 test: 0.973059
max validation accuracy : 0.975758 max acc epoch : 35 test accuracy : 0.974429
Counter({0: 3899, 1: 3792})

Epoch :  37 loss training:  2.4266458523925394 Time :  872
accuracy train: 0.996792 val: 0.973333 test: 0.973516
max validation accuracy : 0.975758 max acc epoch : 35 test accuracy : 0.974429
Counter({0: 3895, 1: 3796})

Epoch :  38 loss training:  2.3840711464872584 Time :  891
accuracy train: 0.996792 val: 0.973333 test: 0.975342
max validation accuracy : 0.975758 max acc epoch : 35 test accuracy : 0.974429
Counter({0: 3901, 1: 3790})

Epoch :  39 loss training:  2.251015681249555 Time :  913
accuracy train: 0.996578 val: 0.975758 test: 0.973059
max validation accuracy : 0.975758 max acc epoch : 35 test accuracy : 0.974429
Counter({1: 3899, 0: 3792})

Epoch :  40 loss training:  2.1093126937630586 Time :  937
accuracy train: 0.996578 val: 0.970909 test: 0.970776
max validation accuracy : 0.975758 max acc epoch : 35 test accuracy : 0.974429
Counter({0: 3900, 1: 3791})

Epoch :  41 loss training:  2.43319222543505 Time :  962
accuracy train: 0.996792 val: 0.972121 test: 0.972603
max validation accuracy : 0.975758 max acc epoch : 35 test accuracy : 0.974429
Counter({1: 3903, 0: 3788})

Epoch :  42 loss training:  2.109345398203004 Time :  980
accuracy train: 0.996792 val: 0.973333 test: 0.972603
max validation accuracy : 0.975758 max acc epoch : 35 test accuracy : 0.974429
Counter({0: 3903, 1: 3788})

Epoch :  43 loss training:  2.216893419274129 Time :  999
accuracy train: 0.996792 val: 0.973333 test: 0.973059
max validation accuracy : 0.975758 max acc epoch : 35 test accuracy : 0.974429
Counter({1: 3902, 0: 3789})

Epoch :  44 loss training:  1.9160240462515503 Time :  1027
accuracy train: 0.996792 val: 0.976970 test: 0.973973
max validation accuracy : 0.976970 max acc epoch : 44 test accuracy : 0.973973
Counter({1: 3905, 0: 3786})

Epoch :  45 loss training:  2.3338702527689748 Time :  1046
accuracy train: 0.997006 val: 0.972121 test: 0.973973
max validation accuracy : 0.976970 max acc epoch : 44 test accuracy : 0.973973
Counter({0: 3909, 1: 3782})

Epoch :  46 loss training:  2.1106912395334803 Time :  1067
accuracy train: 0.996792 val: 0.969697 test: 0.972603
max validation accuracy : 0.976970 max acc epoch : 44 test accuracy : 0.973973
Counter({1: 3907, 0: 3784})

Epoch :  47 loss training:  2.04002300472348 Time :  1085
accuracy train: 0.997006 val: 0.973333 test: 0.972603
max validation accuracy : 0.976970 max acc epoch : 44 test accuracy : 0.973973
Counter({0: 3912, 1: 3779})

Epoch :  48 loss training:  2.176789846853353 Time :  1112
accuracy train: 0.997006 val: 0.975758 test: 0.974429
max validation accuracy : 0.976970 max acc epoch : 44 test accuracy : 0.973973
Counter({1: 3909, 0: 3782})

Epoch :  49 loss training:  1.8114811814302811 Time :  1131
accuracy train: 0.997006 val: 0.972121 test: 0.974429
max validation accuracy : 0.976970 max acc epoch : 44 test accuracy : 0.973973
Counter({0: 3910, 1: 3781})

Epoch :  50 loss training:  1.9629607965762261 Time :  1152
accuracy train: 0.997006 val: 0.976970 test: 0.972603
max validation accuracy : 0.976970 max acc epoch : 44 test accuracy : 0.973973
Counter({0: 3909, 1: 3782})

Epoch :  51 loss training:  1.9098449847951997 Time :  1178
accuracy train: 0.997006 val: 0.973333 test: 0.973059
max validation accuracy : 0.976970 max acc epoch : 44 test accuracy : 0.973973
Counter({1: 3912, 0: 3779})

Epoch :  52 loss training:  1.7265016653109342 Time :  1204
accuracy train: 0.997006 val: 0.975758 test: 0.975799
max validation accuracy : 0.976970 max acc epoch : 44 test accuracy : 0.973973
Counter({1: 3912, 0: 3779})

Epoch :  53 loss training:  1.8057489644124871 Time :  1234
accuracy train: 0.997006 val: 0.974545 test: 0.976256
max validation accuracy : 0.976970 max acc epoch : 44 test accuracy : 0.973973
Counter({0: 3915, 1: 3776})

Epoch :  54 loss training:  1.9429248524393188 Time :  1259
accuracy train: 0.996792 val: 0.979394 test: 0.971233
max validation accuracy : 0.979394 max acc epoch : 54 test accuracy : 0.971233
Counter({1: 3915, 0: 3776})

Epoch :  55 loss training:  1.8931428100331686 Time :  1290
accuracy train: 0.997006 val: 0.974545 test: 0.974429
max validation accuracy : 0.979394 max acc epoch : 54 test accuracy : 0.971233
Counter({1: 3918, 0: 3773})

Epoch :  56 loss training:  1.6640620481521182 Time :  1323
accuracy train: 0.997006 val: 0.974545 test: 0.973059
max validation accuracy : 0.979394 max acc epoch : 54 test accuracy : 0.971233
Counter({1: 3916, 0: 3775})

Epoch :  57 loss training:  1.7657108652565512 Time :  1346
accuracy train: 0.997006 val: 0.972121 test: 0.973516
max validation accuracy : 0.979394 max acc epoch : 54 test accuracy : 0.971233
Counter({0: 3917, 1: 3774})

Epoch :  58 loss training:  1.5296571723447414 Time :  1385
accuracy train: 0.997006 val: 0.973333 test: 0.974429
max validation accuracy : 0.979394 max acc epoch : 54 test accuracy : 0.971233
Counter({0: 3918, 1: 3773})

Epoch :  59 loss training:  1.5207484233542345 Time :  1419
accuracy train: 0.997006 val: 0.974545 test: 0.973973
max validation accuracy : 0.979394 max acc epoch : 54 test accuracy : 0.971233
Counter({1: 3918, 0: 3773})

Epoch :  60 loss training:  1.4342002905832487 Time :  1454
accuracy train: 0.997006 val: 0.976970 test: 0.974886
max validation accuracy : 0.979394 max acc epoch : 54 test accuracy : 0.971233
Counter({0: 3918, 1: 3773})

Epoch :  61 loss training:  1.3385382916312665 Time :  1480
accuracy train: 0.997006 val: 0.975758 test: 0.973516
max validation accuracy : 0.979394 max acc epoch : 54 test accuracy : 0.971233
Counter({0: 3918, 1: 3773})

Epoch :  62 loss training:  1.4621202251146315 Time :  1513
accuracy train: 0.997006 val: 0.976970 test: 0.975342
max validation accuracy : 0.979394 max acc epoch : 54 test accuracy : 0.971233
Counter({0: 3919, 1: 3772})

Epoch :  63 loss training:  1.4544196377974004 Time :  1540
accuracy train: 0.997006 val: 0.973333 test: 0.974429
max validation accuracy : 0.979394 max acc epoch : 54 test accuracy : 0.971233
Counter({0: 3919, 1: 3772})

Epoch :  64 loss training:  1.4795558737241663 Time :  1564
accuracy train: 0.997006 val: 0.978182 test: 0.975342
max validation accuracy : 0.979394 max acc epoch : 54 test accuracy : 0.971233
Counter({0: 3920, 1: 3771})

Epoch :  65 loss training:  1.461204109058599 Time :  1599
accuracy train: 0.997220 val: 0.973333 test: 0.973973
max validation accuracy : 0.979394 max acc epoch : 54 test accuracy : 0.971233
Counter({1: 3919, 0: 3772})

========================================================================================================================================================================================================
best acc epoch :  54
validation accuracy :  0.9793939393939394
test accuracy :  0.9712328767123287
last test_accuracy :  0.9739726027397261
second best val :  0.9781818181818182
second best test :  0.9712328767123287
max gap 11
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=50, lda=False, lr=0.001, num_clusters=2, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=317, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  62.600026696920395 Time :  1646
accuracy train: 0.943114 val: 0.936970 test: 0.944749
max validation accuracy : 0.936970 max acc epoch : 1 test accuracy : 0.944749
Counter({0: 4457, 1: 3234})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  23.6265356130898 Time :  1674
accuracy train: 0.958725 val: 0.936970 test: 0.947032
max validation accuracy : 0.936970 max acc epoch : 1 test accuracy : 0.944749
Counter({0: 4364, 1: 3327})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  17.826262060552835 Time :  1706
accuracy train: 0.968135 val: 0.950303 test: 0.952968
max validation accuracy : 0.950303 max acc epoch : 3 test accuracy : 0.952968
Counter({1: 4342, 0: 3349})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  14.876147630624473 Time :  1742
accuracy train: 0.977973 val: 0.956364 test: 0.960274
max validation accuracy : 0.956364 max acc epoch : 4 test accuracy : 0.960274
Counter({0: 4324, 1: 3367})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  12.26693451963365 Time :  1779
accuracy train: 0.978186 val: 0.955152 test: 0.961644
max validation accuracy : 0.956364 max acc epoch : 4 test accuracy : 0.960274
Counter({1: 4287, 0: 3404})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  11.577699369285256 Time :  1819
accuracy train: 0.982891 val: 0.957576 test: 0.968037
max validation accuracy : 0.957576 max acc epoch : 6 test accuracy : 0.968037
Counter({1: 4260, 0: 3431})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  9.78079344611615 Time :  1856
accuracy train: 0.981394 val: 0.961212 test: 0.966210
max validation accuracy : 0.961212 max acc epoch : 7 test accuracy : 0.966210
Counter({1: 4247, 0: 3444})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  10.231107517145574 Time :  1886
accuracy train: 0.983747 val: 0.960000 test: 0.964840
max validation accuracy : 0.961212 max acc epoch : 7 test accuracy : 0.966210
Counter({1: 4259, 0: 3432})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  9.97559285000898 Time :  1920
accuracy train: 0.986099 val: 0.961212 test: 0.967123
max validation accuracy : 0.961212 max acc epoch : 7 test accuracy : 0.966210
Counter({0: 4180, 1: 3511})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  9.322413574438542 Time :  1947
accuracy train: 0.985885 val: 0.967273 test: 0.965297
max validation accuracy : 0.967273 max acc epoch : 10 test accuracy : 0.965297
Counter({0: 4161, 1: 3530})

Epoch :  11 loss training:  9.38505143718794 Time :  1976
accuracy train: 0.984816 val: 0.966061 test: 0.964840
max validation accuracy : 0.967273 max acc epoch : 10 test accuracy : 0.965297
Counter({0: 4147, 1: 3544})

Epoch :  12 loss training:  8.121780127752572 Time :  2007
accuracy train: 0.987596 val: 0.964848 test: 0.966667
max validation accuracy : 0.967273 max acc epoch : 10 test accuracy : 0.965297
Counter({1: 4129, 0: 3562})

Epoch :  13 loss training:  7.779048931319267 Time :  2035
accuracy train: 0.987596 val: 0.964848 test: 0.966210
max validation accuracy : 0.967273 max acc epoch : 10 test accuracy : 0.965297
Counter({1: 4122, 0: 3569})

Epoch :  14 loss training:  7.603407801594585 Time :  2071
accuracy train: 0.988879 val: 0.968485 test: 0.965297
max validation accuracy : 0.968485 max acc epoch : 14 test accuracy : 0.965297
Counter({1: 4106, 0: 3585})

Epoch :  15 loss training:  7.424212739337236 Time :  2097
accuracy train: 0.988879 val: 0.964848 test: 0.965297
max validation accuracy : 0.968485 max acc epoch : 14 test accuracy : 0.965297
Counter({0: 4116, 1: 3575})

Epoch :  16 loss training:  6.524722342379391 Time :  2124
accuracy train: 0.989093 val: 0.962424 test: 0.965297
max validation accuracy : 0.968485 max acc epoch : 14 test accuracy : 0.965297
Counter({1: 4110, 0: 3581})

Epoch :  17 loss training:  6.75501588685438 Time :  2161
accuracy train: 0.991018 val: 0.963636 test: 0.965297
max validation accuracy : 0.968485 max acc epoch : 14 test accuracy : 0.965297
Counter({0: 4124, 1: 3567})

Epoch :  18 loss training:  6.200187678914517 Time :  2203
accuracy train: 0.992515 val: 0.962424 test: 0.969406
max validation accuracy : 0.968485 max acc epoch : 14 test accuracy : 0.965297
Counter({1: 4109, 0: 3582})

Epoch :  19 loss training:  5.767175395740196 Time :  2237
accuracy train: 0.992729 val: 0.966061 test: 0.966210
max validation accuracy : 0.968485 max acc epoch : 14 test accuracy : 0.965297
Counter({1: 4070, 0: 3621})

Epoch :  20 loss training:  5.401633353554644 Time :  2271
accuracy train: 0.992301 val: 0.964848 test: 0.970320
max validation accuracy : 0.968485 max acc epoch : 14 test accuracy : 0.965297
Counter({0: 4065, 1: 3626})

Epoch :  21 loss training:  5.24466507602483 Time :  2310
accuracy train: 0.992729 val: 0.967273 test: 0.966667
max validation accuracy : 0.968485 max acc epoch : 14 test accuracy : 0.965297
Counter({0: 4059, 1: 3632})

Epoch :  22 loss training:  4.765764855779707 Time :  2346
accuracy train: 0.994012 val: 0.970909 test: 0.968037
max validation accuracy : 0.970909 max acc epoch : 22 test accuracy : 0.968037
Counter({0: 4057, 1: 3634})

Epoch :  23 loss training:  4.914046775782481 Time :  2381
accuracy train: 0.994654 val: 0.968485 test: 0.965297
max validation accuracy : 0.970909 max acc epoch : 22 test accuracy : 0.968037
Counter({1: 4071, 0: 3620})

Epoch :  24 loss training:  4.45789098367095 Time :  2411
accuracy train: 0.995081 val: 0.968485 test: 0.968493
max validation accuracy : 0.970909 max acc epoch : 22 test accuracy : 0.968037
Counter({0: 4066, 1: 3625})

Epoch :  25 loss training:  4.475868572713807 Time :  2449
accuracy train: 0.994226 val: 0.966061 test: 0.970776
max validation accuracy : 0.970909 max acc epoch : 22 test accuracy : 0.968037
Counter({1: 4070, 0: 3621})

Epoch :  26 loss training:  4.503588352934457 Time :  2489
accuracy train: 0.995723 val: 0.972121 test: 0.968037
max validation accuracy : 0.972121 max acc epoch : 26 test accuracy : 0.968037
Counter({1: 4044, 0: 3647})

Epoch :  27 loss training:  4.0901753755752 Time :  2511
accuracy train: 0.995723 val: 0.968485 test: 0.968950
max validation accuracy : 0.972121 max acc epoch : 26 test accuracy : 0.968037
Counter({1: 4019, 0: 3672})

Epoch :  28 loss training:  3.936032732424792 Time :  2557
accuracy train: 0.996151 val: 0.968485 test: 0.968950
max validation accuracy : 0.972121 max acc epoch : 26 test accuracy : 0.968037
Counter({1: 4009, 0: 3682})

Epoch :  29 loss training:  4.666293426649645 Time :  2594
accuracy train: 0.996151 val: 0.967273 test: 0.968037
max validation accuracy : 0.972121 max acc epoch : 26 test accuracy : 0.968037
Counter({1: 4009, 0: 3682})

Epoch :  30 loss training:  3.7908417918370105 Time :  2637
accuracy train: 0.995937 val: 0.970909 test: 0.967580
max validation accuracy : 0.972121 max acc epoch : 26 test accuracy : 0.968037
Counter({1: 4041, 0: 3650})

Epoch :  31 loss training:  4.01725000620354 Time :  2676
accuracy train: 0.996578 val: 0.973333 test: 0.967123
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.967123
Counter({1: 4021, 0: 3670})

Epoch :  32 loss training:  3.679041459225118 Time :  2723
accuracy train: 0.996151 val: 0.969697 test: 0.969406
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.967123
Counter({1: 3972, 0: 3719})

Epoch :  33 loss training:  3.2258287994773127 Time :  2778
accuracy train: 0.996364 val: 0.973333 test: 0.968037
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.967123
Counter({0: 4005, 1: 3686})

Epoch :  34 loss training:  3.2546624364331365 Time :  2807
accuracy train: 0.996364 val: 0.964848 test: 0.968037
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.967123
Counter({1: 4011, 0: 3680})

Epoch :  35 loss training:  3.0653060790500604 Time :  2862
accuracy train: 0.996364 val: 0.969697 test: 0.968493
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.967123
Counter({1: 4012, 0: 3679})

Epoch :  36 loss training:  2.968611301272176 Time :  2904
accuracy train: 0.996792 val: 0.970909 test: 0.969863
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.967123
Counter({1: 3995, 0: 3696})

Epoch :  37 loss training:  2.7554844024416525 Time :  2944
accuracy train: 0.996151 val: 0.969697 test: 0.968493
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.967123
Counter({1: 3978, 0: 3713})

Epoch :  38 loss training:  2.650241773633752 Time :  2998
accuracy train: 0.996792 val: 0.970909 test: 0.968493
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.967123
Counter({0: 3986, 1: 3705})

Epoch :  39 loss training:  2.6261642521130852 Time :  3036
accuracy train: 0.996792 val: 0.970909 test: 0.967123
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.967123
Counter({1: 3977, 0: 3714})

Epoch :  40 loss training:  2.5321653481805697 Time :  3084
accuracy train: 0.997006 val: 0.970909 test: 0.967580
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.967123
Counter({0: 3969, 1: 3722})

Epoch :  41 loss training:  2.412983679358149 Time :  3139
accuracy train: 0.997006 val: 0.970909 test: 0.967580
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.967123
Counter({0: 3952, 1: 3739})

Epoch :  42 loss training:  2.538436057831859 Time :  3178
accuracy train: 0.996792 val: 0.969697 test: 0.968493
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.967123
Counter({1: 3904, 0: 3787})

========================================================================================================================================================================================================
best acc epoch :  31
validation accuracy :  0.9733333333333334
test accuracy :  0.9671232876712329
last test_accuracy :  0.9684931506849315
second best val :  0.9721212121212122
second best test :  0.9680365296803652
max gap 8
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  54 	 val_accuracy : 0.97939 	 test_accuracy : 0.97123 	 last test_accuracy : 0.97397 	 second best val : 0.97818 	 second best test : 0.97123
k :  1 	 best_acc epoch :  31 	 val_accuracy : 0.97333 	 test_accuracy : 0.96712 	 last test_accuracy : 0.96849 	 second best val : 0.97212 	 second best test : 0.96804

avg :  	 val_accuracy : 0.97636 	 test_accuracy : 0.96918 	 last_accuracy : 0.97123 	 second best val : 0.97515 	 second best test : 0.96963

std :  	 val_accuracy : 0.00303 	 test_accuracy : 0.00205 	 last_accuracy : 0.00274 	 second best val : 0.00303 	 second best test : 0.00160


date and time :  Tue Jun 15 19:15:08 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=100, lda=False, lr=0.001, num_clusters=2, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=285, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  48.405112732201815 Time :  81
accuracy train: 0.950171 val: 0.935758 test: 0.952968
max validation accuracy : 0.935758 max acc epoch : 1 test accuracy : 0.952968
Counter({0: 4114, 1: 3577})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.618983287364244 Time :  126
accuracy train: 0.973268 val: 0.960000 test: 0.962557
max validation accuracy : 0.960000 max acc epoch : 2 test accuracy : 0.962557
Counter({1: 4059, 0: 3632})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.973273712210357 Time :  167
accuracy train: 0.964713 val: 0.953939 test: 0.937900
max validation accuracy : 0.960000 max acc epoch : 2 test accuracy : 0.962557
Counter({1: 3934, 0: 3757})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  12.420210056938231 Time :  199
accuracy train: 0.982891 val: 0.970909 test: 0.964840
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.964840
Counter({0: 3978, 1: 3713})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.897178214043379 Time :  245
accuracy train: 0.978828 val: 0.963636 test: 0.967123
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.964840
Counter({0: 3924, 1: 3767})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  10.284865397028625 Time :  287
accuracy train: 0.984816 val: 0.964848 test: 0.970776
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.964840
Counter({0: 3930, 1: 3761})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  9.011760310502723 Time :  332
accuracy train: 0.986955 val: 0.964848 test: 0.968037
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.964840
Counter({0: 3931, 1: 3760})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  7.915245387644973 Time :  377
accuracy train: 0.989093 val: 0.964848 test: 0.967580
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.964840
Counter({1: 3907, 0: 3784})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  7.863259029807523 Time :  417
accuracy train: 0.983105 val: 0.961212 test: 0.969406
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.964840
Counter({0: 3915, 1: 3776})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  8.05894713732414 Time :  467
accuracy train: 0.989521 val: 0.964848 test: 0.972603
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.964840
Counter({1: 3895, 0: 3796})

Epoch :  11 loss training:  7.124243261292577 Time :  514
accuracy train: 0.990376 val: 0.967273 test: 0.971689
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.964840
Counter({1: 3914, 0: 3777})

Epoch :  12 loss training:  6.2691285400651395 Time :  567
accuracy train: 0.990804 val: 0.966061 test: 0.974886
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.964840
Counter({0: 3905, 1: 3786})

Epoch :  13 loss training:  6.12601028487552 Time :  617
accuracy train: 0.991446 val: 0.970909 test: 0.970320
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.964840
Counter({1: 3897, 0: 3794})

Epoch :  14 loss training:  5.397728170384653 Time :  657
accuracy train: 0.993157 val: 0.966061 test: 0.973516
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.964840
Counter({0: 3890, 1: 3801})

Epoch :  15 loss training:  5.6235724235884845 Time :  703
accuracy train: 0.992943 val: 0.966061 test: 0.973059
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.964840
Counter({0: 3873, 1: 3818})

========================================================================================================================================================================================================
best acc epoch :  4
validation accuracy :  0.9709090909090909
test accuracy :  0.9648401826484019
last test_accuracy :  0.9730593607305936
second best val :  0.9672727272727273
second best test :  0.9648401826484019
max gap 2
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=100, lda=False, lr=0.001, num_clusters=2, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=414, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  49.8118362352252 Time :  821
accuracy train: 0.954021 val: 0.956364 test: 0.960274
max validation accuracy : 0.956364 max acc epoch : 1 test accuracy : 0.960274
Counter({0: 4156, 1: 3535})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.206975230947137 Time :  868
accuracy train: 0.973695 val: 0.968485 test: 0.959817
max validation accuracy : 0.968485 max acc epoch : 2 test accuracy : 0.959817
Counter({0: 3987, 1: 3704})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.63726996909827 Time :  911
accuracy train: 0.976048 val: 0.963636 test: 0.965297
max validation accuracy : 0.968485 max acc epoch : 2 test accuracy : 0.959817
Counter({1: 3980, 0: 3711})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.965261668898165 Time :  950
accuracy train: 0.980967 val: 0.966061 test: 0.963470
max validation accuracy : 0.968485 max acc epoch : 2 test accuracy : 0.959817
Counter({1: 3972, 0: 3719})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.166442811954767 Time :  1003
accuracy train: 0.983105 val: 0.969697 test: 0.972146
max validation accuracy : 0.969697 max acc epoch : 5 test accuracy : 0.972146
Counter({0: 3913, 1: 3778})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.458126872312278 Time :  1038
accuracy train: 0.985244 val: 0.975758 test: 0.964840
max validation accuracy : 0.975758 max acc epoch : 6 test accuracy : 0.964840
Counter({1: 3888, 0: 3803})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  9.424985350808129 Time :  1077
accuracy train: 0.985458 val: 0.972121 test: 0.970320
max validation accuracy : 0.975758 max acc epoch : 6 test accuracy : 0.964840
Counter({0: 3873, 1: 3818})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  7.586150829214603 Time :  1121
accuracy train: 0.985672 val: 0.974545 test: 0.971689
max validation accuracy : 0.975758 max acc epoch : 6 test accuracy : 0.964840
Counter({1: 3883, 0: 3808})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.489876386942342 Time :  1159
accuracy train: 0.987596 val: 0.976970 test: 0.973059
max validation accuracy : 0.976970 max acc epoch : 9 test accuracy : 0.973059
Counter({0: 3877, 1: 3814})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  7.045046744751744 Time :  1204
accuracy train: 0.991018 val: 0.978182 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.970776
Counter({1: 3875, 0: 3816})

Epoch :  11 loss training:  6.712236487539485 Time :  1248
accuracy train: 0.991232 val: 0.975758 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.970776
Counter({0: 3873, 1: 3818})

Epoch :  12 loss training:  6.315390657633543 Time :  1288
accuracy train: 0.991660 val: 0.970909 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.970776
Counter({0: 3866, 1: 3825})

Epoch :  13 loss training:  6.354234883154277 Time :  1331
accuracy train: 0.992729 val: 0.978182 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.970776
Counter({1: 3865, 0: 3826})

Epoch :  14 loss training:  5.319191096001305 Time :  1368
accuracy train: 0.993157 val: 0.973333 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.970776
Counter({0: 3848, 1: 3843})

Epoch :  15 loss training:  5.177353826118633 Time :  1414
accuracy train: 0.994012 val: 0.974545 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.970776
Counter({1: 3850, 0: 3841})

Epoch :  16 loss training:  5.689499358646572 Time :  1450
accuracy train: 0.993798 val: 0.975758 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.970776
Counter({1: 3848, 0: 3843})

Epoch :  17 loss training:  4.75112975074444 Time :  1486
accuracy train: 0.994012 val: 0.975758 test: 0.967123
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.970776
Counter({0: 3860, 1: 3831})

Epoch :  18 loss training:  3.947354583069682 Time :  1535
accuracy train: 0.994654 val: 0.980606 test: 0.970776
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.970776
Counter({1: 3869, 0: 3822})

Epoch :  19 loss training:  3.8507241188781336 Time :  1566
accuracy train: 0.995295 val: 0.978182 test: 0.975342
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.970776
Counter({0: 3875, 1: 3816})

Epoch :  20 loss training:  4.255280616460368 Time :  1604
accuracy train: 0.995295 val: 0.975758 test: 0.969406
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.970776
Counter({0: 3878, 1: 3813})

Epoch :  21 loss training:  3.196692615892971 Time :  1655
accuracy train: 0.995509 val: 0.979394 test: 0.972603
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.970776
Counter({0: 3887, 1: 3804})

Epoch :  22 loss training:  3.3867932540015317 Time :  1683
accuracy train: 0.995509 val: 0.979394 test: 0.972603
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.970776
Counter({1: 3885, 0: 3806})

Epoch :  23 loss training:  4.183136726845987 Time :  1728
accuracy train: 0.995295 val: 0.970909 test: 0.973516
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.970776
Counter({0: 3877, 1: 3814})

Epoch :  24 loss training:  3.207067541225115 Time :  1775
accuracy train: 0.996151 val: 0.976970 test: 0.972146
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.970776
Counter({1: 3884, 0: 3807})

Epoch :  25 loss training:  2.843824381940067 Time :  1815
accuracy train: 0.996364 val: 0.975758 test: 0.972603
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.970776
Counter({0: 3879, 1: 3812})

Epoch :  26 loss training:  2.7977513329824433 Time :  1854
accuracy train: 0.996792 val: 0.978182 test: 0.971233
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.970776
Counter({0: 3890, 1: 3801})

Epoch :  27 loss training:  2.6948909735656343 Time :  1894
accuracy train: 0.996578 val: 0.974545 test: 0.969863
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.970776
Counter({0: 3887, 1: 3804})

Epoch :  28 loss training:  2.994146439654287 Time :  1945
accuracy train: 0.996792 val: 0.973333 test: 0.972146
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.970776
Counter({0: 3884, 1: 3807})

Epoch :  29 loss training:  2.8951267462107353 Time :  1990
accuracy train: 0.996792 val: 0.978182 test: 0.969406
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.970776
Counter({1: 3892, 0: 3799})

========================================================================================================================================================================================================
best acc epoch :  18
validation accuracy :  0.9806060606060606
test accuracy :  0.9707762557077626
last test_accuracy :  0.9694063926940639
second best val :  0.9793939393939394
second best test :  0.9707762557077626
max gap 8
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  4 	 val_accuracy : 0.97091 	 test_accuracy : 0.96484 	 last test_accuracy : 0.97306 	 second best val : 0.96727 	 second best test : 0.96484
k :  1 	 best_acc epoch :  18 	 val_accuracy : 0.98061 	 test_accuracy : 0.97078 	 last test_accuracy : 0.96941 	 second best val : 0.97939 	 second best test : 0.97078

avg :  	 val_accuracy : 0.97576 	 test_accuracy : 0.96781 	 last_accuracy : 0.97123 	 second best val : 0.97333 	 second best test : 0.96781

std :  	 val_accuracy : 0.00485 	 test_accuracy : 0.00297 	 last_accuracy : 0.00183 	 second best val : 0.00606 	 second best test : 0.00297


date and time :  Tue Jun 15 19:48:56 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=300, lda=False, lr=0.001, num_clusters=2, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=814, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  38.796434404328465 Time :  76
accuracy train: 0.948246 val: 0.946667 test: 0.938356
max validation accuracy : 0.946667 max acc epoch : 1 test accuracy : 0.938356
Counter({1: 3881, 0: 3810})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.9846620678436 Time :  131
accuracy train: 0.968563 val: 0.957576 test: 0.960731
max validation accuracy : 0.957576 max acc epoch : 2 test accuracy : 0.960731
Counter({0: 3910, 1: 3781})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.074832874001004 Time :  174
accuracy train: 0.968777 val: 0.961212 test: 0.959817
max validation accuracy : 0.961212 max acc epoch : 3 test accuracy : 0.959817
Counter({0: 3930, 1: 3761})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.051392943132669 Time :  210
accuracy train: 0.983319 val: 0.964848 test: 0.965297
max validation accuracy : 0.964848 max acc epoch : 4 test accuracy : 0.965297
Counter({0: 3907, 1: 3784})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.209306165808812 Time :  254
accuracy train: 0.984602 val: 0.967273 test: 0.958904
max validation accuracy : 0.967273 max acc epoch : 5 test accuracy : 0.958904
Counter({0: 3866, 1: 3825})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.297255024197511 Time :  304
accuracy train: 0.988024 val: 0.970909 test: 0.960274
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.960274
Counter({0: 3877, 1: 3814})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.410117574268952 Time :  338
accuracy train: 0.992087 val: 0.967273 test: 0.966667
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.960274
Counter({0: 3861, 1: 3830})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.379348983755335 Time :  388
accuracy train: 0.993370 val: 0.968485 test: 0.966667
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.960274
Counter({1: 3868, 0: 3823})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.743132256087847 Time :  444
accuracy train: 0.991446 val: 0.969697 test: 0.963927
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.960274
Counter({1: 3862, 0: 3829})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  4.528075536276447 Time :  506
accuracy train: 0.993157 val: 0.967273 test: 0.968493
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.960274
Counter({0: 3852, 1: 3839})

Epoch :  11 loss training:  4.502342730411328 Time :  560
accuracy train: 0.994226 val: 0.967273 test: 0.972146
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.960274
Counter({1: 3859, 0: 3832})

Epoch :  12 loss training:  4.226560003764462 Time :  617
accuracy train: 0.994012 val: 0.966061 test: 0.971689
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.960274
Counter({1: 3857, 0: 3834})

Epoch :  13 loss training:  4.219704540621024 Time :  670
accuracy train: 0.995937 val: 0.970909 test: 0.968493
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.960274
Counter({0: 3850, 1: 3841})

Epoch :  14 loss training:  3.4392941615660675 Time :  712
accuracy train: 0.995937 val: 0.969697 test: 0.968037
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.960274
Counter({1: 3851, 0: 3840})

Epoch :  15 loss training:  3.813396095240023 Time :  759
accuracy train: 0.995509 val: 0.969697 test: 0.968493
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.960274
Counter({1: 3856, 0: 3835})

Epoch :  16 loss training:  3.3017263606307097 Time :  813
accuracy train: 0.995295 val: 0.963636 test: 0.970320
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.960274
Counter({0: 3859, 1: 3832})

Epoch :  17 loss training:  2.895669977297075 Time :  853
accuracy train: 0.995937 val: 0.969697 test: 0.971689
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.960274
Counter({1: 3876, 0: 3815})

========================================================================================================================================================================================================
best acc epoch :  6
validation accuracy :  0.9709090909090909
test accuracy :  0.9602739726027397
last test_accuracy :  0.971689497716895
second best val :  0.9696969696969697
second best test :  0.9602739726027397
max gap 1
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=300, lda=False, lr=0.001, num_clusters=2, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=840, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  40.46536738425493 Time :  976
accuracy train: 0.948674 val: 0.944242 test: 0.952511
max validation accuracy : 0.944242 max acc epoch : 1 test accuracy : 0.952511
Counter({0: 4123, 1: 3568})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  22.624081797897816 Time :  1025
accuracy train: 0.955518 val: 0.949091 test: 0.943836
max validation accuracy : 0.949091 max acc epoch : 2 test accuracy : 0.943836
Counter({1: 3908, 0: 3783})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  17.26738512190059 Time :  1097
accuracy train: 0.961933 val: 0.958788 test: 0.962100
max validation accuracy : 0.958788 max acc epoch : 3 test accuracy : 0.962100
Counter({1: 3957, 0: 3734})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  13.086384864058346 Time :  1151
accuracy train: 0.985030 val: 0.966061 test: 0.963927
max validation accuracy : 0.966061 max acc epoch : 4 test accuracy : 0.963927
Counter({0: 3895, 1: 3796})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.725474416743964 Time :  1210
accuracy train: 0.984816 val: 0.973333 test: 0.966210
max validation accuracy : 0.973333 max acc epoch : 5 test accuracy : 0.966210
Counter({1: 3911, 0: 3780})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  7.992192458710633 Time :  1253
accuracy train: 0.988879 val: 0.962424 test: 0.960274
max validation accuracy : 0.973333 max acc epoch : 5 test accuracy : 0.966210
Counter({0: 3890, 1: 3801})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.453534438391216 Time :  1306
accuracy train: 0.986955 val: 0.972121 test: 0.969863
max validation accuracy : 0.973333 max acc epoch : 5 test accuracy : 0.966210
Counter({1: 3891, 0: 3800})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.600685302517377 Time :  1356
accuracy train: 0.989521 val: 0.974545 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971689
Counter({0: 3864, 1: 3827})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.76736199320294 Time :  1411
accuracy train: 0.991446 val: 0.974545 test: 0.974886
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971689
Counter({1: 3857, 0: 3834})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  4.91541072668042 Time :  1459
accuracy train: 0.992515 val: 0.972121 test: 0.974886
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971689
Counter({1: 3849, 0: 3842})

Epoch :  11 loss training:  4.736610586871393 Time :  1504
accuracy train: 0.993584 val: 0.973333 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971689
Counter({1: 3853, 0: 3838})

Epoch :  12 loss training:  4.581377844908275 Time :  1558
accuracy train: 0.992515 val: 0.972121 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971689
Counter({0: 3849, 1: 3842})

Epoch :  13 loss training:  4.232474745251238 Time :  1618
accuracy train: 0.994012 val: 0.978182 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.970320
Counter({1: 3869, 0: 3822})

Epoch :  14 loss training:  4.042777216527611 Time :  1670
accuracy train: 0.994654 val: 0.972121 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.970320
Counter({0: 3867, 1: 3824})

Epoch :  15 loss training:  4.111587068531662 Time :  1710
accuracy train: 0.994440 val: 0.973333 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.970320
Counter({1: 3873, 0: 3818})

Epoch :  16 loss training:  3.501960865338333 Time :  1773
accuracy train: 0.994440 val: 0.973333 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.970320
Counter({1: 3869, 0: 3822})

Epoch :  17 loss training:  3.700428315787576 Time :  1825
accuracy train: 0.994226 val: 0.976970 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.970320
Counter({0: 3866, 1: 3825})

Epoch :  18 loss training:  3.674220129760215 Time :  1891
accuracy train: 0.994654 val: 0.978182 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.970320
Counter({1: 3885, 0: 3806})

Epoch :  19 loss training:  3.270551336754579 Time :  1948
accuracy train: 0.995295 val: 0.974545 test: 0.967123
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.970320
Counter({0: 3887, 1: 3804})

Epoch :  20 loss training:  2.7496557669946924 Time :  2016
accuracy train: 0.995509 val: 0.975758 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.970320
Counter({1: 3905, 0: 3786})

Epoch :  21 loss training:  2.546561807685066 Time :  2086
accuracy train: 0.996151 val: 0.975758 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.970320
Counter({0: 3899, 1: 3792})

Epoch :  22 loss training:  2.736988603428472 Time :  2147
accuracy train: 0.994867 val: 0.974545 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.970320
Counter({1: 3909, 0: 3782})

Epoch :  23 loss training:  2.8338120184489526 Time :  2212
accuracy train: 0.996364 val: 0.976970 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.970320
Counter({0: 3898, 1: 3793})

Epoch :  24 loss training:  2.342312054883223 Time :  2269
accuracy train: 0.995723 val: 0.976970 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.970320
Counter({1: 3914, 0: 3777})

========================================================================================================================================================================================================
best acc epoch :  13
validation accuracy :  0.9781818181818182
test accuracy :  0.9703196347031964
last test_accuracy :  0.9726027397260274
second best val :  0.9769696969696969
second best test :  0.9703196347031964
max gap 5
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  6 	 val_accuracy : 0.97091 	 test_accuracy : 0.96027 	 last test_accuracy : 0.97169 	 second best val : 0.96970 	 second best test : 0.96027
k :  1 	 best_acc epoch :  13 	 val_accuracy : 0.97818 	 test_accuracy : 0.97032 	 last test_accuracy : 0.97260 	 second best val : 0.97697 	 second best test : 0.97032

avg :  	 val_accuracy : 0.97455 	 test_accuracy : 0.96530 	 last_accuracy : 0.97215 	 second best val : 0.97333 	 second best test : 0.96530

std :  	 val_accuracy : 0.00364 	 test_accuracy : 0.00502 	 last_accuracy : 0.00046 	 second best val : 0.00364 	 second best test : 0.00502
