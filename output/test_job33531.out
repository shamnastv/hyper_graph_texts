

date and time :  Sat May 22 10:27:42 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=649, weight_decay=0)
device :  cuda:0
Counter({0: 2606, 2: 2534, 1: 2260})

Epoch :  1 loss training:  208.3788805603981 Time :  93
accuracy train: 0.643614 val: 0.638806 test: 0.619095
max validation accuracy : 0.638806 max acc epoch : 1 test accuracy : 0.619095
Epoch :  1 loss training:  278.6750414967537 Time :  123
accuracy train: 0.516214 val: 0.534328 test: 0.503092
Counter({1: 3107, 2: 2532, 0: 1761})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  141.80163621902466 Time :  199
accuracy train: 0.709464 val: 0.653731 test: 0.643087
max validation accuracy : 0.653731 max acc epoch : 2 test accuracy : 0.643087
Epoch :  2 loss training:  162.89102298021317 Time :  222
accuracy train: 0.634348 val: 0.576119 test: 0.580015
Counter({2: 2828, 0: 2504, 1: 2068})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  124.10684448480606 Time :  283
accuracy train: 0.714428 val: 0.677612 test: 0.636903
max validation accuracy : 0.677612 max acc epoch : 3 test accuracy : 0.636903
Epoch :  3 loss training:  140.12223714590073 Time :  315
accuracy train: 0.674388 val: 0.597015 test: 0.599555
Counter({0: 3486, 1: 2519, 2: 1395})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  100.97413730621338 Time :  383
accuracy train: 0.795500 val: 0.734328 test: 0.698739
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  4 loss training:  103.75558924674988 Time :  411
accuracy train: 0.726340 val: 0.680597 test: 0.648528
Counter({1: 2597, 0: 2436, 2: 2367})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  91.48656839132309 Time :  484
accuracy train: 0.806750 val: 0.689552 test: 0.693792
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  5 loss training:  97.50472861528397 Time :  512
accuracy train: 0.739246 val: 0.656716 test: 0.639624
Counter({0: 2608, 2: 2469, 1: 2323})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  83.47530841827393 Time :  595
accuracy train: 0.835870 val: 0.689552 test: 0.702201
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  6 loss training:  86.87796822190285 Time :  628
accuracy train: 0.751489 val: 0.629851 test: 0.639871
Counter({2: 2692, 0: 2631, 1: 2077})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  74.11423751711845 Time :  693
accuracy train: 0.854070 val: 0.701493 test: 0.709869
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  7 loss training:  74.51300504803658 Time :  728
accuracy train: 0.755129 val: 0.659701 test: 0.640861
Counter({2: 2733, 1: 2635, 0: 2032})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.65557585656643 Time :  781
accuracy train: 0.870285 val: 0.734328 test: 0.713579
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  8 loss training:  67.81603972613811 Time :  809
accuracy train: 0.782925 val: 0.665672 test: 0.653475
Counter({1: 2746, 2: 2649, 0: 2005})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.53225483000278 Time :  866
accuracy train: 0.879550 val: 0.716418 test: 0.716547
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  9 loss training:  65.20743212103844 Time :  897
accuracy train: 0.770351 val: 0.677612 test: 0.650507
Counter({1: 2809, 2: 2621, 0: 1970})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.13057614862919 Time :  953
accuracy train: 0.893117 val: 0.728358 test: 0.713579
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  10 loss training:  59.52527426183224 Time :  979
accuracy train: 0.801125 val: 0.686567 test: 0.662132
Counter({2: 2814, 1: 2617, 0: 1969})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.91267907619476 Time :  1031
accuracy train: 0.890139 val: 0.728358 test: 0.714568
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  11 loss training:  58.13372564315796 Time :  1056
accuracy train: 0.814692 val: 0.698507 test: 0.668810
Counter({2: 2848, 1: 2596, 0: 1956})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.331973880529404 Time :  1098
accuracy train: 0.901721 val: 0.719403 test: 0.718526
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  12 loss training:  57.18378081917763 Time :  1130
accuracy train: 0.808074 val: 0.695522 test: 0.669305
Counter({1: 2851, 0: 2596, 2: 1953})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  53.06489261984825 Time :  1184
accuracy train: 0.906684 val: 0.704478 test: 0.718279
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  13 loss training:  52.93512537330389 Time :  1206
accuracy train: 0.816678 val: 0.698507 test: 0.674252
Counter({1: 2858, 2: 2590, 0: 1952})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  53.41266453266144 Time :  1254
accuracy train: 0.901721 val: 0.719403 test: 0.721741
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  14 loss training:  54.287208288908005 Time :  1281
accuracy train: 0.814361 val: 0.686567 test: 0.669058
Counter({1: 2859, 2: 2597, 0: 1944})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  52.29886242747307 Time :  1326
accuracy train: 0.908008 val: 0.713433 test: 0.715310
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  15 loss training:  51.29075613617897 Time :  1350
accuracy train: 0.815685 val: 0.686567 test: 0.670047
Counter({2: 2867, 1: 2593, 0: 1940})

Epoch :  16 loss training:  52.504166439175606 Time :  1402
accuracy train: 0.914957 val: 0.722388 test: 0.718526
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  16 loss training:  50.346128433942795 Time :  1439
accuracy train: 0.817340 val: 0.683582 test: 0.670542
Counter({2: 2868, 0: 2591, 1: 1941})

Epoch :  17 loss training:  49.85720971226692 Time :  1489
accuracy train: 0.920251 val: 0.716418 test: 0.716052
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  17 loss training:  50.925193548202515 Time :  1517
accuracy train: 0.816678 val: 0.683582 test: 0.667079
Counter({2: 2873, 1: 2585, 0: 1942})

Epoch :  18 loss training:  48.73757828772068 Time :  1564
accuracy train: 0.923891 val: 0.716418 test: 0.716052
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  18 loss training:  50.26380442082882 Time :  1584
accuracy train: 0.818001 val: 0.677612 test: 0.673262
Counter({1: 2869, 2: 2591, 0: 1940})

Epoch :  19 loss training:  48.36538602411747 Time :  1632
accuracy train: 0.922237 val: 0.710448 test: 0.718279
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  19 loss training:  51.09564033150673 Time :  1663
accuracy train: 0.829252 val: 0.686567 test: 0.674004
Counter({2: 2877, 1: 2588, 0: 1935})

Epoch :  20 loss training:  47.86789806187153 Time :  1699
accuracy train: 0.926870 val: 0.710448 test: 0.718279
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  20 loss training:  48.20968237519264 Time :  1730
accuracy train: 0.828921 val: 0.686567 test: 0.674004
Counter({2: 2882, 0: 2582, 1: 1936})

Epoch :  21 loss training:  44.21989490091801 Time :  1783
accuracy train: 0.931833 val: 0.704478 test: 0.715310
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  21 loss training:  48.19096300005913 Time :  1817
accuracy train: 0.835870 val: 0.677612 test: 0.675736
Counter({2: 2892, 1: 2577, 0: 1931})

Epoch :  22 loss training:  44.401650078594685 Time :  1858
accuracy train: 0.934150 val: 0.704478 test: 0.715310
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  22 loss training:  48.62525597214699 Time :  1893
accuracy train: 0.842158 val: 0.692537 test: 0.681672
Counter({2: 2899, 1: 2573, 0: 1928})

Epoch :  23 loss training:  42.46767695248127 Time :  1947
accuracy train: 0.938782 val: 0.701493 test: 0.713579
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  23 loss training:  46.3916209936142 Time :  1973
accuracy train: 0.837194 val: 0.683582 test: 0.678457
Counter({1: 2905, 0: 2568, 2: 1927})

Epoch :  24 loss training:  41.204373240470886 Time :  2024
accuracy train: 0.938782 val: 0.707463 test: 0.716794
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  24 loss training:  47.11056673526764 Time :  2058
accuracy train: 0.839510 val: 0.686567 test: 0.680930
Counter({1: 2915, 0: 2560, 2: 1925})

Epoch :  25 loss training:  39.868399642407894 Time :  2096
accuracy train: 0.943415 val: 0.713433 test: 0.717289
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  25 loss training:  43.770576648414135 Time :  2124
accuracy train: 0.840834 val: 0.686567 test: 0.682909
Counter({1: 2922, 2: 2554, 0: 1924})

Epoch :  26 loss training:  40.38433159515262 Time :  2184
accuracy train: 0.948379 val: 0.707463 test: 0.712590
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  26 loss training:  45.29834512621164 Time :  2218
accuracy train: 0.847452 val: 0.689552 test: 0.683651
Counter({1: 2933, 2: 2545, 0: 1922})

Epoch :  27 loss training:  37.53140142560005 Time :  2266
accuracy train: 0.950695 val: 0.701493 test: 0.711600
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  27 loss training:  45.603450894355774 Time :  2294
accuracy train: 0.845797 val: 0.689552 test: 0.687608
Counter({1: 2942, 0: 2536, 2: 1922})

Epoch :  28 loss training:  36.12838139384985 Time :  2350
accuracy train: 0.953673 val: 0.719403 test: 0.717289
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  28 loss training:  43.572452299296856 Time :  2384
accuracy train: 0.846128 val: 0.692537 test: 0.681919
Counter({1: 2945, 2: 2538, 0: 1917})

Epoch :  29 loss training:  35.27980351448059 Time :  2436
accuracy train: 0.961284 val: 0.719403 test: 0.720257
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  29 loss training:  43.020694836974144 Time :  2468
accuracy train: 0.846128 val: 0.692537 test: 0.681919
Counter({2: 2958, 1: 2527, 0: 1915})

Epoch :  30 loss training:  33.24529750645161 Time :  2523
accuracy train: 0.963931 val: 0.704478 test: 0.715063
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  30 loss training:  42.34661442786455 Time :  2557
accuracy train: 0.851754 val: 0.692537 test: 0.683156
Counter({1: 2963, 2: 2527, 0: 1910})

Epoch :  31 loss training:  33.40477982163429 Time :  2604
accuracy train: 0.965917 val: 0.698507 test: 0.719763
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  31 loss training:  42.60243371129036 Time :  2626
accuracy train: 0.853077 val: 0.701493 test: 0.684640
Counter({2: 2963, 1: 2530, 0: 1907})

Epoch :  32 loss training:  31.15126571059227 Time :  2676
accuracy train: 0.966909 val: 0.713433 test: 0.719021
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  32 loss training:  41.59787920117378 Time :  2702
accuracy train: 0.857379 val: 0.692537 test: 0.688350
Counter({1: 2962, 2: 2529, 0: 1909})

Epoch :  33 loss training:  30.40548773854971 Time :  2750
accuracy train: 0.968233 val: 0.707463 test: 0.717289
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  33 loss training:  41.11182598024607 Time :  2785
accuracy train: 0.857048 val: 0.677612 test: 0.677715
Counter({1: 2965, 2: 2525, 0: 1910})

Epoch :  34 loss training:  30.634271755814552 Time :  2829
accuracy train: 0.971542 val: 0.710448 test: 0.718031
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  34 loss training:  39.332799419760704 Time :  2856
accuracy train: 0.858703 val: 0.695522 test: 0.690576
Counter({2: 2962, 1: 2527, 0: 1911})

Epoch :  35 loss training:  28.76164909824729 Time :  2908
accuracy train: 0.974189 val: 0.713433 test: 0.721494
max validation accuracy : 0.734328 max acc epoch : 4 test accuracy : 0.698739
Epoch :  35 loss training:  38.75788680464029 Time :  2933
accuracy train: 0.858372 val: 0.689552 test: 0.683651
Counter({2: 2967, 1: 2524, 0: 1909})

========================================================================================================================================================================================================
max acc epoch :  4
max validation accuracy :  0.7343283582089553
test accuracy :  0.6987385604748949
last test_accuracy :  0.7214939401434578
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=649, weight_decay=0)
device :  cuda:0
Counter({0: 2606, 2: 2534, 1: 2260})

Epoch :  1 loss training:  208.55822759866714 Time :  3028
accuracy train: 0.649239 val: 0.629851 test: 0.618847
max validation accuracy : 0.629851 max acc epoch : 1 test accuracy : 0.618847
Epoch :  1 loss training:  278.7900103330612 Time :  3060
accuracy train: 0.529120 val: 0.546269 test: 0.507791
Counter({0: 3206, 2: 2741, 1: 1453})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  141.53321051597595 Time :  3129
accuracy train: 0.717737 val: 0.665672 test: 0.652238
max validation accuracy : 0.665672 max acc epoch : 2 test accuracy : 0.652238
Epoch :  2 loss training:  161.90424662828445 Time :  3150
accuracy train: 0.629054 val: 0.600000 test: 0.575810
Counter({0: 3146, 2: 2391, 1: 1863})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  125.59787318110466 Time :  3208
accuracy train: 0.719391 val: 0.707463 test: 0.636409
max validation accuracy : 0.707463 max acc epoch : 3 test accuracy : 0.636409
Epoch :  3 loss training:  142.69832479953766 Time :  3238
accuracy train: 0.641297 val: 0.594030 test: 0.576305
Counter({0: 3108, 2: 2431, 1: 1861})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  100.51777413487434 Time :  3292
accuracy train: 0.798147 val: 0.722388 test: 0.698491
max validation accuracy : 0.722388 max acc epoch : 4 test accuracy : 0.698491
Epoch :  4 loss training:  103.52452984452248 Time :  3321
accuracy train: 0.733620 val: 0.674627 test: 0.650260
Counter({1: 3148, 0: 2420, 2: 1832})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  90.25755923986435 Time :  3383
accuracy train: 0.810721 val: 0.686567 test: 0.695523
max validation accuracy : 0.722388 max acc epoch : 4 test accuracy : 0.698491
Epoch :  5 loss training:  94.9842517375946 Time :  3418
accuracy train: 0.738584 val: 0.644776 test: 0.641603
Counter({1: 3341, 2: 2442, 0: 1617})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  83.67251342535019 Time :  3470
accuracy train: 0.835870 val: 0.686567 test: 0.700470
max validation accuracy : 0.722388 max acc epoch : 4 test accuracy : 0.698491
Epoch :  6 loss training:  85.60568614304066 Time :  3497
accuracy train: 0.754467 val: 0.662687 test: 0.649765
Counter({1: 3404, 0: 2435, 2: 1561})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  74.28054776787758 Time :  3558
accuracy train: 0.852747 val: 0.695522 test: 0.711848
max validation accuracy : 0.722388 max acc epoch : 4 test accuracy : 0.698491
Epoch :  7 loss training:  72.46764767169952 Time :  3587
accuracy train: 0.756453 val: 0.632836 test: 0.640861
Counter({2: 3400, 0: 2423, 1: 1577})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.65391312539577 Time :  3635
accuracy train: 0.871277 val: 0.728358 test: 0.713579
max validation accuracy : 0.728358 max acc epoch : 8 test accuracy : 0.713579
Epoch :  8 loss training:  67.31319315731525 Time :  3667
accuracy train: 0.781602 val: 0.677612 test: 0.659164
Counter({2: 3410, 0: 2416, 1: 1574})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  66.04782578349113 Time :  3721
accuracy train: 0.880543 val: 0.734328 test: 0.717042
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.717042
Epoch :  9 loss training:  65.51269225776196 Time :  3744
accuracy train: 0.762409 val: 0.647761 test: 0.654959
Counter({0: 3429, 2: 2416, 1: 1555})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.86665053665638 Time :  3801
accuracy train: 0.891463 val: 0.716418 test: 0.711106
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.717042
Epoch :  10 loss training:  60.80147987604141 Time :  3833
accuracy train: 0.795500 val: 0.677612 test: 0.663369
Counter({0: 3407, 2: 2430, 1: 1563})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.65016035735607 Time :  3889
accuracy train: 0.890470 val: 0.713433 test: 0.715063
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.717042
Epoch :  11 loss training:  58.173565700650215 Time :  3917
accuracy train: 0.814361 val: 0.680597 test: 0.673757
Counter({2: 3387, 1: 2436, 0: 1577})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  57.267351657152176 Time :  3971
accuracy train: 0.901390 val: 0.725373 test: 0.718526
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.717042
Epoch :  12 loss training:  55.7791116386652 Time :  4005
accuracy train: 0.809398 val: 0.689552 test: 0.669552
Counter({0: 3389, 2: 2426, 1: 1585})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  53.09119991958141 Time :  4057
accuracy train: 0.905361 val: 0.710448 test: 0.714074
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.717042
Epoch :  13 loss training:  53.012348517775536 Time :  4086
accuracy train: 0.816347 val: 0.683582 test: 0.673510
Counter({0: 3385, 2: 2427, 1: 1588})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  53.34758648276329 Time :  4143
accuracy train: 0.905030 val: 0.725373 test: 0.719763
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.717042
Epoch :  14 loss training:  51.22648078203201 Time :  4173
accuracy train: 0.811052 val: 0.656716 test: 0.671036
Counter({0: 3391, 2: 2421, 1: 1588})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  53.20973186194897 Time :  4229
accuracy train: 0.913302 val: 0.719403 test: 0.714816
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.717042
Epoch :  15 loss training:  51.248814046382904 Time :  4261
accuracy train: 0.815685 val: 0.674627 test: 0.674746
Counter({0: 3388, 1: 2426, 2: 1586})

Epoch :  16 loss training:  52.73639561235905 Time :  4325
accuracy train: 0.916281 val: 0.722388 test: 0.717289
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.717042
Epoch :  16 loss training:  50.713047593832016 Time :  4361
accuracy train: 0.824289 val: 0.692537 test: 0.674499
Counter({0: 3389, 2: 2425, 1: 1586})

Epoch :  17 loss training:  50.69121654331684 Time :  4416
accuracy train: 0.924222 val: 0.704478 test: 0.717536
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.717042
Epoch :  17 loss training:  52.87546779215336 Time :  4440
accuracy train: 0.819656 val: 0.677612 test: 0.668068
Counter({0: 3388, 1: 2428, 2: 1584})

Epoch :  18 loss training:  49.12957066297531 Time :  4505
accuracy train: 0.922899 val: 0.713433 test: 0.719268
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.717042
Epoch :  18 loss training:  49.27540183067322 Time :  4541
accuracy train: 0.822634 val: 0.686567 test: 0.675983
Counter({0: 3373, 2: 2446, 1: 1581})

Epoch :  19 loss training:  48.77268560230732 Time :  4616
accuracy train: 0.923891 val: 0.734328 test: 0.717289
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.717042
Epoch :  19 loss training:  49.62435059249401 Time :  4652
accuracy train: 0.823627 val: 0.671642 test: 0.675488
Counter({1: 3360, 2: 2454, 0: 1586})

Epoch :  20 loss training:  45.668180383741856 Time :  4713
accuracy train: 0.929186 val: 0.713433 test: 0.722978
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.717042
Epoch :  20 loss training:  47.89825849235058 Time :  4741
accuracy train: 0.833554 val: 0.680597 test: 0.676478
Counter({0: 3361, 2: 2450, 1: 1589})

Epoch :  21 loss training:  45.247522324323654 Time :  4794
accuracy train: 0.938120 val: 0.713433 test: 0.716300
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.717042
Epoch :  21 loss training:  48.93018136918545 Time :  4827
accuracy train: 0.835539 val: 0.695522 test: 0.677962
Counter({0: 3356, 2: 2447, 1: 1597})

Epoch :  22 loss training:  44.00125399976969 Time :  4889
accuracy train: 0.936135 val: 0.704478 test: 0.719515
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.717042
Epoch :  22 loss training:  48.9415500164032 Time :  4922
accuracy train: 0.837525 val: 0.686567 test: 0.682414
Counter({2: 3345, 1: 2452, 0: 1603})

Epoch :  23 loss training:  41.65246766805649 Time :  4969
accuracy train: 0.943746 val: 0.713433 test: 0.717536
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.717042
Epoch :  23 loss training:  44.136122196912766 Time :  5000
accuracy train: 0.839179 val: 0.677612 test: 0.680188
Counter({2: 3344, 1: 2452, 0: 1604})

Epoch :  24 loss training:  40.27302062511444 Time :  5062
accuracy train: 0.941430 val: 0.728358 test: 0.719515
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.717042
Epoch :  24 loss training:  45.07803100347519 Time :  5092
accuracy train: 0.843481 val: 0.695522 test: 0.682661
Counter({0: 3341, 2: 2457, 1: 1602})

Epoch :  25 loss training:  38.70825818926096 Time :  5138
accuracy train: 0.951026 val: 0.719403 test: 0.717536
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.717042
Epoch :  25 loss training:  43.825584553182125 Time :  5174
accuracy train: 0.836201 val: 0.704478 test: 0.679693
Counter({0: 3332, 2: 2461, 1: 1607})

Epoch :  26 loss training:  37.974240474402905 Time :  5238
accuracy train: 0.953011 val: 0.734328 test: 0.719763
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.717042
Epoch :  26 loss training:  44.927521616220474 Time :  5274
accuracy train: 0.842819 val: 0.686567 test: 0.685877
Counter({0: 3329, 2: 2463, 1: 1608})

Epoch :  27 loss training:  36.64674334228039 Time :  5339
accuracy train: 0.955989 val: 0.722388 test: 0.721494
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.717042
Epoch :  27 loss training:  44.06467977166176 Time :  5368
accuracy train: 0.848776 val: 0.686567 test: 0.685629
Counter({0: 3321, 2: 2460, 1: 1619})

Epoch :  28 loss training:  34.854308888316154 Time :  5427
accuracy train: 0.962277 val: 0.725373 test: 0.719515
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.717042
Epoch :  28 loss training:  43.75525775551796 Time :  5454
accuracy train: 0.838518 val: 0.674627 test: 0.680683
Counter({1: 3322, 2: 2462, 0: 1616})

Epoch :  29 loss training:  33.39423760026693 Time :  5515
accuracy train: 0.964593 val: 0.731343 test: 0.720505
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.717042
Epoch :  29 loss training:  43.5034948438406 Time :  5551
accuracy train: 0.845136 val: 0.695522 test: 0.675736
Counter({0: 3325, 2: 2456, 1: 1619})

Epoch :  30 loss training:  35.13294754177332 Time :  5620
accuracy train: 0.964593 val: 0.725373 test: 0.715558
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.717042
Epoch :  30 loss training:  42.902292259037495 Time :  5643
accuracy train: 0.847452 val: 0.674627 test: 0.678704
Counter({0: 3325, 2: 2459, 1: 1616})

Epoch :  31 loss training:  34.83179372549057 Time :  5702
accuracy train: 0.969887 val: 0.725373 test: 0.719268
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.717042
Epoch :  31 loss training:  40.43207171559334 Time :  5737
accuracy train: 0.856717 val: 0.692537 test: 0.682167
Counter({0: 3325, 1: 2463, 2: 1612})

Epoch :  32 loss training:  30.0067832544446 Time :  5786
accuracy train: 0.968564 val: 0.722388 test: 0.720505
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.717042
Epoch :  32 loss training:  41.85085231810808 Time :  5816
accuracy train: 0.859365 val: 0.695522 test: 0.685629
Counter({0: 3332, 1: 2459, 2: 1609})

Epoch :  33 loss training:  29.588632382452488 Time :  5873
accuracy train: 0.972204 val: 0.737313 test: 0.720505
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  33 loss training:  41.27428928017616 Time :  5905
accuracy train: 0.859034 val: 0.692537 test: 0.685629
Counter({0: 3337, 2: 2466, 1: 1597})

Epoch :  34 loss training:  28.976061061024666 Time :  5964
accuracy train: 0.974520 val: 0.734328 test: 0.719763
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  34 loss training:  41.48536804318428 Time :  5986
accuracy train: 0.859696 val: 0.698507 test: 0.691318
Counter({1: 3332, 2: 2472, 0: 1596})

Epoch :  35 loss training:  28.922495063394308 Time :  6042
accuracy train: 0.980477 val: 0.731343 test: 0.722236
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  35 loss training:  40.01450903713703 Time :  6076
accuracy train: 0.865983 val: 0.686567 test: 0.690329
Counter({2: 2860, 1: 2588, 0: 1952})

Epoch :  36 loss training:  27.883836515247822 Time :  6131
accuracy train: 0.976837 val: 0.725373 test: 0.724957
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  36 loss training:  40.435905404388905 Time :  6167
accuracy train: 0.866976 val: 0.686567 test: 0.689587
Counter({0: 2868, 1: 2585, 2: 1947})

Epoch :  37 loss training:  26.342129729688168 Time :  6203
accuracy train: 0.979815 val: 0.725373 test: 0.720999
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  37 loss training:  38.988590106368065 Time :  6236
accuracy train: 0.866314 val: 0.704478 test: 0.689092
Counter({2: 2871, 0: 2600, 1: 1929})

Epoch :  38 loss training:  25.760201297700405 Time :  6283
accuracy train: 0.982793 val: 0.716418 test: 0.724709
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  38 loss training:  37.3866950571537 Time :  6320
accuracy train: 0.869623 val: 0.701493 test: 0.688598
Counter({2: 2862, 1: 2603, 0: 1935})

Epoch :  39 loss training:  24.499261535704136 Time :  6367
accuracy train: 0.986102 val: 0.725373 test: 0.720752
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  39 loss training:  36.971481777727604 Time :  6400
accuracy train: 0.875910 val: 0.698507 test: 0.691813
Counter({1: 2858, 0: 2608, 2: 1934})

Epoch :  40 loss training:  23.76847966015339 Time :  6454
accuracy train: 0.989411 val: 0.725373 test: 0.720752
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  40 loss training:  38.29916890710592 Time :  6481
accuracy train: 0.877895 val: 0.704478 test: 0.693792
Counter({2: 2860, 1: 2611, 0: 1929})

Epoch :  41 loss training:  23.20462015271187 Time :  6527
accuracy train: 0.990073 val: 0.728358 test: 0.723473
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  41 loss training:  37.29555716365576 Time :  6562
accuracy train: 0.880212 val: 0.707463 test: 0.694781
Counter({2: 2859, 1: 2606, 0: 1935})

Epoch :  42 loss training:  22.21157842129469 Time :  6598
accuracy train: 0.991066 val: 0.722388 test: 0.720257
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  42 loss training:  36.69576984643936 Time :  6631
accuracy train: 0.873263 val: 0.710448 test: 0.686866
Counter({2: 2867, 1: 2603, 0: 1930})

Epoch :  43 loss training:  22.48600198328495 Time :  6677
accuracy train: 0.990404 val: 0.731343 test: 0.721989
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  43 loss training:  35.4123837351799 Time :  6698
accuracy train: 0.872270 val: 0.701493 test: 0.689092
Counter({1: 2865, 2: 2614, 0: 1921})

Epoch :  44 loss training:  20.463802598416805 Time :  6754
accuracy train: 0.992720 val: 0.737313 test: 0.723473
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  44 loss training:  35.09949064999819 Time :  6779
accuracy train: 0.878557 val: 0.698507 test: 0.691318
Counter({2: 2873, 1: 2606, 0: 1921})

Epoch :  45 loss training:  19.455153711140156 Time :  6824
accuracy train: 0.994375 val: 0.725373 test: 0.719268
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  45 loss training:  34.82608509808779 Time :  6854
accuracy train: 0.883190 val: 0.695522 test: 0.693792
Counter({1: 2878, 2: 2596, 0: 1926})

Epoch :  46 loss training:  18.215969800949097 Time :  6899
accuracy train: 0.993382 val: 0.725373 test: 0.724709
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  46 loss training:  33.93112176656723 Time :  6920
accuracy train: 0.889146 val: 0.692537 test: 0.697502
Counter({0: 2885, 1: 2594, 2: 1921})

Epoch :  47 loss training:  19.714995745569468 Time :  6967
accuracy train: 0.996691 val: 0.734328 test: 0.718031
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  47 loss training:  34.88543998450041 Time :  6994
accuracy train: 0.886830 val: 0.692537 test: 0.691566
Counter({2: 2888, 1: 2598, 0: 1914})

Epoch :  48 loss training:  17.85756565257907 Time :  7043
accuracy train: 0.996029 val: 0.728358 test: 0.723473
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  48 loss training:  32.936793968081474 Time :  7079
accuracy train: 0.892455 val: 0.692537 test: 0.694286
Counter({2: 2890, 1: 2599, 0: 1911})

Epoch :  49 loss training:  17.282539252191782 Time :  7125
accuracy train: 0.993713 val: 0.716418 test: 0.720752
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  49 loss training:  33.43172167241573 Time :  7149
accuracy train: 0.888484 val: 0.674627 test: 0.691566
Counter({1: 2901, 0: 2589, 2: 1910})

Epoch :  50 loss training:  15.713614393025637 Time :  7198
accuracy train: 0.996691 val: 0.722388 test: 0.725451
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  50 loss training:  32.58950586616993 Time :  7222
accuracy train: 0.890139 val: 0.677612 test: 0.693792
Counter({2: 2910, 1: 2582, 0: 1908})

Epoch :  51 loss training:  15.558476746082306 Time :  7273
accuracy train: 0.998345 val: 0.716418 test: 0.720999
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  51 loss training:  31.33255672827363 Time :  7306
accuracy train: 0.892124 val: 0.698507 test: 0.696265
Counter({2: 2912, 1: 2575, 0: 1913})

Epoch :  52 loss training:  15.089898567646742 Time :  7341
accuracy train: 0.997353 val: 0.716418 test: 0.723720
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  52 loss training:  31.202148266136646 Time :  7374
accuracy train: 0.898412 val: 0.689552 test: 0.694534
Counter({1: 2927, 2: 2555, 0: 1918})

Epoch :  53 loss training:  14.700809190049767 Time :  7414
accuracy train: 0.997684 val: 0.719403 test: 0.722483
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  53 loss training:  32.230850245803595 Time :  7443
accuracy train: 0.893448 val: 0.683582 test: 0.698739
Counter({2: 2925, 1: 2556, 0: 1919})

Epoch :  54 loss training:  13.438682429492474 Time :  7493
accuracy train: 0.996691 val: 0.704478 test: 0.723967
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  54 loss training:  29.72781877219677 Time :  7517
accuracy train: 0.894772 val: 0.671642 test: 0.694534
Counter({2: 2928, 1: 2560, 0: 1912})

Epoch :  55 loss training:  13.262423284351826 Time :  7564
accuracy train: 0.997353 val: 0.725373 test: 0.719763
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  55 loss training:  31.083537109196186 Time :  7599
accuracy train: 0.893779 val: 0.689552 test: 0.694039
Counter({0: 2931, 2: 2558, 1: 1911})

Epoch :  56 loss training:  13.553311513736844 Time :  7635
accuracy train: 0.998345 val: 0.722388 test: 0.724215
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  56 loss training:  29.872136428952217 Time :  7668
accuracy train: 0.896757 val: 0.698507 test: 0.696018
Counter({2: 2933, 1: 2560, 0: 1907})

Epoch :  57 loss training:  12.859001036733389 Time :  7714
accuracy train: 0.998015 val: 0.716418 test: 0.724957
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  57 loss training:  29.088264852762222 Time :  7741
accuracy train: 0.890470 val: 0.686567 test: 0.695523
Counter({0: 2926, 1: 2555, 2: 1919})

Epoch :  58 loss training:  12.709527432918549 Time :  7788
accuracy train: 0.998676 val: 0.704478 test: 0.722978
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  58 loss training:  29.07696783915162 Time :  7821
accuracy train: 0.905361 val: 0.683582 test: 0.698244
Counter({2: 2923, 1: 2550, 0: 1927})

Epoch :  59 loss training:  11.37919538654387 Time :  7860
accuracy train: 0.998676 val: 0.707463 test: 0.724957
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  59 loss training:  29.462046265602112 Time :  7889
accuracy train: 0.899735 val: 0.686567 test: 0.692802
Counter({1: 2912, 2: 2562, 0: 1926})

Epoch :  60 loss training:  10.639974342659116 Time :  7940
accuracy train: 0.998015 val: 0.710448 test: 0.723225
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  60 loss training:  29.037355311214924 Time :  7965
accuracy train: 0.905692 val: 0.710448 test: 0.700965
Counter({0: 2913, 2: 2562, 1: 1925})

Epoch :  61 loss training:  11.133204124867916 Time :  8015
accuracy train: 0.999338 val: 0.707463 test: 0.719763
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  61 loss training:  28.478549130260944 Time :  8047
accuracy train: 0.906684 val: 0.698507 test: 0.696018
Counter({2: 2907, 1: 2564, 0: 1929})

Epoch :  62 loss training:  11.620820567943156 Time :  8085
accuracy train: 0.999007 val: 0.719403 test: 0.719021
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  62 loss training:  27.177734352648258 Time :  8120
accuracy train: 0.913302 val: 0.695522 test: 0.702449
Counter({2: 2903, 1: 2563, 0: 1934})

Epoch :  63 loss training:  10.22877561673522 Time :  8170
accuracy train: 0.998676 val: 0.719403 test: 0.721494
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  63 loss training:  27.16035872325301 Time :  8201
accuracy train: 0.915288 val: 0.698507 test: 0.700470
Counter({0: 2899, 2: 2561, 1: 1940})

Epoch :  64 loss training:  10.804807597771287 Time :  8241
accuracy train: 0.999338 val: 0.701493 test: 0.718031
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720505
Epoch :  64 loss training:  27.038791932165623 Time :  8274
accuracy train: 0.912972 val: 0.689552 test: 0.697749
Counter({2: 2898, 1: 2560, 0: 1942})

========================================================================================================================================================================================================
max acc epoch :  33
max validation accuracy :  0.7373134328358208
test accuracy :  0.720504575810042
last test_accuracy :  0.7180311649765025
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=649, weight_decay=0)
device :  cuda:0
Counter({0: 2606, 2: 2534, 1: 2260})

Epoch :  1 loss training:  208.39885300397873 Time :  8375
accuracy train: 0.648246 val: 0.626866 test: 0.617858
max validation accuracy : 0.626866 max acc epoch : 1 test accuracy : 0.617858
Epoch :  1 loss training:  278.6372007727623 Time :  8408
accuracy train: 0.533422 val: 0.534328 test: 0.505813
Counter({2: 3012, 1: 2991, 0: 1397})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  142.30018812417984 Time :  8496
accuracy train: 0.710788 val: 0.653731 test: 0.647044
max validation accuracy : 0.653731 max acc epoch : 2 test accuracy : 0.647044
Epoch :  2 loss training:  163.28235340118408 Time :  8532
accuracy train: 0.632032 val: 0.597015 test: 0.572842
Counter({1: 2596, 2: 2542, 0: 2262})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  126.03796806931496 Time :  8601
accuracy train: 0.721707 val: 0.680597 test: 0.644571
max validation accuracy : 0.680597 max acc epoch : 3 test accuracy : 0.644571
Epoch :  3 loss training:  140.94387340545654 Time :  8633
accuracy train: 0.639312 val: 0.594030 test: 0.580015
Counter({2: 2854, 1: 2631, 0: 1915})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  100.08105769753456 Time :  8704
accuracy train: 0.802780 val: 0.728358 test: 0.697007
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.697007
Epoch :  4 loss training:  104.25510436296463 Time :  8729
accuracy train: 0.722700 val: 0.674627 test: 0.645313
Counter({2: 2745, 1: 2692, 0: 1963})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  90.59022888541222 Time :  8793
accuracy train: 0.803772 val: 0.680597 test: 0.693544
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.697007
Epoch :  5 loss training:  95.91475975513458 Time :  8820
accuracy train: 0.731966 val: 0.656716 test: 0.636903
Counter({0: 2725, 2: 2686, 1: 1989})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  83.94908979535103 Time :  8871
accuracy train: 0.839179 val: 0.698507 test: 0.706159
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.697007
Epoch :  6 loss training:  84.54755200445652 Time :  8899
accuracy train: 0.746195 val: 0.659701 test: 0.639871
Counter({2: 2711, 1: 2711, 0: 1978})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  73.95850084722042 Time :  8951
accuracy train: 0.853408 val: 0.698507 test: 0.713826
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.697007
Epoch :  7 loss training:  72.69674542546272 Time :  8983
accuracy train: 0.761085 val: 0.650746 test: 0.642345
Counter({1: 2724, 2: 2686, 0: 1990})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.89957529306412 Time :  9040
accuracy train: 0.870615 val: 0.728358 test: 0.710858
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.697007
Epoch :  8 loss training:  66.09385392069817 Time :  9065
accuracy train: 0.779947 val: 0.668657 test: 0.658669
Counter({1: 2724, 2: 2701, 0: 1975})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  66.37437441945076 Time :  9118
accuracy train: 0.875579 val: 0.710448 test: 0.718526
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.697007
Epoch :  9 loss training:  64.33447271585464 Time :  9156
accuracy train: 0.768034 val: 0.650746 test: 0.652980
Counter({0: 2798, 2: 2644, 1: 1958})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.1932520121336 Time :  9213
accuracy train: 0.896095 val: 0.701493 test: 0.712837
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.697007
Epoch :  10 loss training:  59.31630916148424 Time :  9237
accuracy train: 0.797485 val: 0.674627 test: 0.666090
Counter({1: 2822, 2: 2636, 0: 1942})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  57.86536727845669 Time :  9293
accuracy train: 0.890470 val: 0.713433 test: 0.716300
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.697007
Epoch :  11 loss training:  56.83030906319618 Time :  9327
accuracy train: 0.819325 val: 0.677612 test: 0.675488
Counter({1: 2826, 2: 2622, 0: 1952})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  56.9300989061594 Time :  9383
accuracy train: 0.903706 val: 0.704478 test: 0.716794
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.697007
Epoch :  12 loss training:  55.821128726005554 Time :  9406
accuracy train: 0.810390 val: 0.686567 test: 0.672768
Counter({0: 2830, 2: 2624, 1: 1946})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  52.89457533508539 Time :  9465
accuracy train: 0.906684 val: 0.713433 test: 0.715558
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.697007
Epoch :  13 loss training:  52.255942076444626 Time :  9500
accuracy train: 0.820649 val: 0.686567 test: 0.672026
Counter({1: 2834, 2: 2625, 0: 1941})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  53.16853575408459 Time :  9571
accuracy train: 0.906023 val: 0.713433 test: 0.714816
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.697007
Epoch :  14 loss training:  52.73227237164974 Time :  9597
accuracy train: 0.818663 val: 0.671642 test: 0.669800
Counter({1: 2834, 2: 2627, 0: 1939})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  52.849139496684074 Time :  9666
accuracy train: 0.909001 val: 0.716418 test: 0.709869
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.697007
Epoch :  15 loss training:  50.86071743816137 Time :  9705
accuracy train: 0.821641 val: 0.680597 test: 0.670789
Counter({1: 2831, 0: 2628, 2: 1941})

Epoch :  16 loss training:  51.72556707262993 Time :  9758
accuracy train: 0.914626 val: 0.719403 test: 0.715310
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.697007
Epoch :  16 loss training:  49.830284386873245 Time :  9788
accuracy train: 0.821641 val: 0.680597 test: 0.670789
Counter({2: 2836, 0: 2629, 1: 1935})

Epoch :  17 loss training:  49.49018743634224 Time :  9845
accuracy train: 0.919590 val: 0.722388 test: 0.717042
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.697007
Epoch :  17 loss training:  51.38191635906696 Time :  9878
accuracy train: 0.817009 val: 0.686567 test: 0.666584
Counter({2: 2839, 1: 2624, 0: 1937})

Epoch :  18 loss training:  49.010237351059914 Time :  9924
accuracy train: 0.921906 val: 0.716418 test: 0.717784
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.697007
Epoch :  18 loss training:  49.29181729257107 Time :  9963
accuracy train: 0.822303 val: 0.683582 test: 0.676231
Counter({0: 2840, 2: 2631, 1: 1929})

Epoch :  19 loss training:  47.95980911701918 Time :  10016
accuracy train: 0.922568 val: 0.722388 test: 0.719021
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.697007
Epoch :  19 loss training:  48.81754641234875 Time :  10044
accuracy train: 0.830576 val: 0.683582 test: 0.674004
Counter({1: 2846, 2: 2628, 0: 1926})

Epoch :  20 loss training:  46.234194204211235 Time :  10103
accuracy train: 0.928193 val: 0.722388 test: 0.720752
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.697007
Epoch :  20 loss training:  49.01312505453825 Time :  10139
accuracy train: 0.834547 val: 0.686567 test: 0.673510
Counter({1: 2856, 2: 2622, 0: 1922})

Epoch :  21 loss training:  44.627604588866234 Time :  10194
accuracy train: 0.929517 val: 0.722388 test: 0.719021
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.697007
Epoch :  21 loss training:  47.08744236826897 Time :  10233
accuracy train: 0.837856 val: 0.692537 test: 0.678951
Counter({1: 2869, 2: 2616, 0: 1915})

Epoch :  22 loss training:  42.389261960983276 Time :  10297
accuracy train: 0.934480 val: 0.719403 test: 0.719021
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.697007
Epoch :  22 loss training:  48.680882796645164 Time :  10325
accuracy train: 0.838187 val: 0.686567 test: 0.682414
Counter({1: 2864, 2: 2621, 0: 1915})

Epoch :  23 loss training:  42.31125898659229 Time :  10382
accuracy train: 0.946062 val: 0.716418 test: 0.714568
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.697007
Epoch :  23 loss training:  45.13651514798403 Time :  10426
accuracy train: 0.833885 val: 0.686567 test: 0.676725
Counter({1: 2868, 2: 2623, 0: 1909})

Epoch :  24 loss training:  41.26871234923601 Time :  10484
accuracy train: 0.940437 val: 0.725373 test: 0.720752
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.697007
Epoch :  24 loss training:  45.73269969969988 Time :  10519
accuracy train: 0.836863 val: 0.689552 test: 0.676725
Counter({0: 2870, 2: 2621, 1: 1909})

Epoch :  25 loss training:  40.82205004990101 Time :  10579
accuracy train: 0.948709 val: 0.728358 test: 0.718031
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.697007
Epoch :  25 loss training:  45.78849671781063 Time :  10622
accuracy train: 0.840834 val: 0.704478 test: 0.675241
Counter({2: 2866, 1: 2625, 0: 1909})

Epoch :  26 loss training:  38.41952659189701 Time :  10670
accuracy train: 0.949040 val: 0.734328 test: 0.716794
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  26 loss training:  43.88212824612856 Time :  10707
accuracy train: 0.842488 val: 0.680597 test: 0.679446
Counter({2: 2864, 0: 2622, 1: 1914})

Epoch :  27 loss training:  37.51875431090593 Time :  10767
accuracy train: 0.951688 val: 0.707463 test: 0.718773
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  27 loss training:  43.073091238737106 Time :  10793
accuracy train: 0.846459 val: 0.686567 test: 0.683898
Counter({2: 2866, 1: 2623, 0: 1911})

Epoch :  28 loss training:  36.13746586441994 Time :  10854
accuracy train: 0.957975 val: 0.728358 test: 0.720257
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  28 loss training:  42.23280972242355 Time :  10891
accuracy train: 0.841165 val: 0.674627 test: 0.676478
Counter({2: 2878, 1: 2615, 0: 1907})

Epoch :  29 loss training:  34.80834720283747 Time :  10941
accuracy train: 0.957313 val: 0.719403 test: 0.720752
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  29 loss training:  41.78553543239832 Time :  10981
accuracy train: 0.846459 val: 0.677612 test: 0.680930
Counter({0: 2947, 2: 2559, 1: 1894})

Epoch :  30 loss training:  34.13461892306805 Time :  11037
accuracy train: 0.963600 val: 0.716418 test: 0.718526
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  30 loss training:  42.86371986567974 Time :  11064
accuracy train: 0.847783 val: 0.683582 test: 0.683898
Counter({1: 2948, 2: 2556, 0: 1896})

Epoch :  31 loss training:  32.658473271876574 Time :  11128
accuracy train: 0.962277 val: 0.713433 test: 0.720257
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  31 loss training:  40.677437737584114 Time :  11169
accuracy train: 0.858703 val: 0.692537 test: 0.685382
Counter({1: 2952, 0: 2553, 2: 1895})

Epoch :  32 loss training:  31.256203450262547 Time :  11221
accuracy train: 0.967902 val: 0.719403 test: 0.717784
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  32 loss training:  41.465902119874954 Time :  11256
accuracy train: 0.854732 val: 0.701493 test: 0.686619
Counter({0: 2956, 2: 2549, 1: 1895})

Epoch :  33 loss training:  31.124374881386757 Time :  11310
accuracy train: 0.971873 val: 0.716418 test: 0.720752
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  33 loss training:  39.615087028592825 Time :  11345
accuracy train: 0.852747 val: 0.683582 test: 0.679446
Counter({1: 2956, 2: 2550, 0: 1894})

Epoch :  34 loss training:  30.213211722671986 Time :  11389
accuracy train: 0.973858 val: 0.716418 test: 0.723967
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  34 loss training:  39.94223637878895 Time :  11426
accuracy train: 0.855725 val: 0.698507 test: 0.688103
Counter({0: 2964, 1: 2542, 2: 1894})

Epoch :  35 loss training:  28.05777119100094 Time :  11471
accuracy train: 0.977498 val: 0.710448 test: 0.716794
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  35 loss training:  38.31721522659063 Time :  11508
accuracy train: 0.858372 val: 0.701493 test: 0.688845
Counter({1: 2967, 2: 2546, 0: 1887})

Epoch :  36 loss training:  27.819299429655075 Time :  11570
accuracy train: 0.979153 val: 0.722388 test: 0.720999
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  36 loss training:  38.33593834936619 Time :  11600
accuracy train: 0.867306 val: 0.707463 test: 0.691318
Counter({0: 2974, 2: 2538, 1: 1888})

Epoch :  37 loss training:  28.495324186980724 Time :  11651
accuracy train: 0.981469 val: 0.713433 test: 0.717536
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  37 loss training:  39.04771525412798 Time :  11694
accuracy train: 0.866976 val: 0.701493 test: 0.688845
Counter({1: 2972, 0: 2534, 2: 1894})

Epoch :  38 loss training:  26.329066552221775 Time :  11743
accuracy train: 0.982131 val: 0.707463 test: 0.722483
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  38 loss training:  36.4065703228116 Time :  11780
accuracy train: 0.872932 val: 0.698507 test: 0.685877
Counter({0: 2974, 2: 2535, 1: 1891})

Epoch :  39 loss training:  24.77566008269787 Time :  11834
accuracy train: 0.985440 val: 0.728358 test: 0.722731
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  39 loss training:  36.52534455060959 Time :  11864
accuracy train: 0.873925 val: 0.695522 test: 0.686619
Counter({1: 2984, 2: 2533, 0: 1883})

Epoch :  40 loss training:  25.067954383790493 Time :  11914
accuracy train: 0.987426 val: 0.716418 test: 0.723720
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  40 loss training:  37.001901879906654 Time :  11951
accuracy train: 0.874255 val: 0.689552 test: 0.686619
Counter({1: 2993, 2: 2529, 0: 1878})

Epoch :  41 loss training:  24.07379522919655 Time :  12001
accuracy train: 0.985440 val: 0.713433 test: 0.721989
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  41 loss training:  35.6267169713974 Time :  12032
accuracy train: 0.881866 val: 0.695522 test: 0.690576
Counter({0: 2990, 2: 2529, 1: 1881})

Epoch :  42 loss training:  22.40307515859604 Time :  12078
accuracy train: 0.990073 val: 0.701493 test: 0.719763
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  42 loss training:  35.39347419142723 Time :  12101
accuracy train: 0.871277 val: 0.689552 test: 0.688350
Counter({0: 2993, 2: 2532, 1: 1875})

Epoch :  43 loss training:  21.48083345219493 Time :  12162
accuracy train: 0.990073 val: 0.704478 test: 0.721494
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  43 loss training:  34.59013592451811 Time :  12190
accuracy train: 0.875579 val: 0.707463 test: 0.689092
Counter({2: 2985, 1: 2537, 0: 1878})

Epoch :  44 loss training:  20.735225573182106 Time :  12245
accuracy train: 0.991396 val: 0.725373 test: 0.723473
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  44 loss training:  35.39238850772381 Time :  12282
accuracy train: 0.878226 val: 0.707463 test: 0.693792
Counter({0: 2991, 1: 2528, 2: 1881})

Epoch :  45 loss training:  19.329028956592083 Time :  12327
accuracy train: 0.992389 val: 0.713433 test: 0.725946
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  45 loss training:  32.97221413999796 Time :  12361
accuracy train: 0.884844 val: 0.707463 test: 0.699481
Counter({2: 2994, 1: 2529, 0: 1877})

Epoch :  46 loss training:  20.353043980896473 Time :  12410
accuracy train: 0.993382 val: 0.713433 test: 0.723967
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  46 loss training:  32.912155605852604 Time :  12432
accuracy train: 0.888484 val: 0.701493 test: 0.696512
Counter({1: 3008, 2: 2515, 0: 1877})

Epoch :  47 loss training:  19.202608227729797 Time :  12486
accuracy train: 0.995698 val: 0.716418 test: 0.725451
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  47 loss training:  34.501063108444214 Time :  12521
accuracy train: 0.874917 val: 0.686567 test: 0.693050
Counter({2: 3015, 0: 2501, 1: 1884})

Epoch :  48 loss training:  18.93435998260975 Time :  12568
accuracy train: 0.993051 val: 0.722388 test: 0.724709
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  48 loss training:  32.9196747764945 Time :  12606
accuracy train: 0.894110 val: 0.683582 test: 0.694039
Counter({1: 3018, 2: 2500, 0: 1882})

Epoch :  49 loss training:  16.939082480967045 Time :  12660
accuracy train: 0.995036 val: 0.716418 test: 0.722978
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  49 loss training:  32.48805735260248 Time :  12694
accuracy train: 0.892455 val: 0.686567 test: 0.693297
Counter({1: 3026, 2: 2493, 0: 1881})

Epoch :  50 loss training:  16.257497895509005 Time :  12751
accuracy train: 0.996029 val: 0.716418 test: 0.726935
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  50 loss training:  33.15596301853657 Time :  12793
accuracy train: 0.891794 val: 0.689552 test: 0.695028
Counter({1: 3042, 2: 2488, 0: 1870})

Epoch :  51 loss training:  16.87113457173109 Time :  12841
accuracy train: 0.997353 val: 0.710448 test: 0.723720
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  51 loss training:  32.15665881335735 Time :  12874
accuracy train: 0.898081 val: 0.689552 test: 0.700965
Counter({0: 3044, 2: 2487, 1: 1869})

Epoch :  52 loss training:  16.5086419750005 Time :  12931
accuracy train: 0.997022 val: 0.716418 test: 0.724709
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  52 loss training:  33.027138732373714 Time :  12969
accuracy train: 0.900728 val: 0.695522 test: 0.698986
Counter({0: 3062, 2: 2463, 1: 1875})

Epoch :  53 loss training:  14.035508641973138 Time :  13021
accuracy train: 0.997022 val: 0.728358 test: 0.723967
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  53 loss training:  31.071436889469624 Time :  13062
accuracy train: 0.897419 val: 0.683582 test: 0.697749
Counter({2: 3066, 1: 2462, 0: 1872})

Epoch :  54 loss training:  14.094796312972903 Time :  13115
accuracy train: 0.997022 val: 0.719403 test: 0.726935
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  54 loss training:  30.693850476294756 Time :  13146
accuracy train: 0.898081 val: 0.689552 test: 0.694039
Counter({1: 3068, 2: 2463, 0: 1869})

Epoch :  55 loss training:  13.76103793270886 Time :  13208
accuracy train: 0.998015 val: 0.719403 test: 0.724462
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  55 loss training:  29.134700909256935 Time :  13250
accuracy train: 0.903375 val: 0.698507 test: 0.698739
Counter({2: 3061, 1: 2469, 0: 1870})

Epoch :  56 loss training:  13.518401969224215 Time :  13292
accuracy train: 0.997353 val: 0.716418 test: 0.725946
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  56 loss training:  29.47691086307168 Time :  13334
accuracy train: 0.900066 val: 0.707463 test: 0.697749
Counter({1: 3060, 2: 2470, 0: 1870})

Epoch :  57 loss training:  12.722967693582177 Time :  13383
accuracy train: 0.998015 val: 0.731343 test: 0.726441
max validation accuracy : 0.734328 max acc epoch : 26 test accuracy : 0.716794
Epoch :  57 loss training:  29.10662642866373 Time :  13417
accuracy train: 0.902052 val: 0.686567 test: 0.698244
Counter({0: 3065, 1: 2466, 2: 1869})

========================================================================================================================================================================================================
max acc epoch :  26
max validation accuracy :  0.7343283582089553
test accuracy :  0.7167944595597329
last test_accuracy :  0.7264407618105367
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=649, weight_decay=0)
device :  cuda:0
Counter({0: 2606, 2: 2534, 1: 2260})

Epoch :  1 loss training:  208.2196289896965 Time :  13529
accuracy train: 0.650563 val: 0.620896 test: 0.620579
max validation accuracy : 0.620896 max acc epoch : 1 test accuracy : 0.620579
Epoch :  1 loss training:  278.1102377772331 Time :  13557
accuracy train: 0.526803 val: 0.546269 test: 0.506307
Counter({2: 3118, 1: 2954, 0: 1328})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  139.48183584213257 Time :  13634
accuracy train: 0.719060 val: 0.638806 test: 0.653475
max validation accuracy : 0.638806 max acc epoch : 2 test accuracy : 0.653475
Epoch :  2 loss training:  163.07189577817917 Time :  13675
accuracy train: 0.659828 val: 0.600000 test: 0.615137
Counter({0: 3193, 1: 2427, 2: 1780})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  124.72176450490952 Time :  13734
accuracy train: 0.716744 val: 0.641791 test: 0.639377
max validation accuracy : 0.641791 max acc epoch : 3 test accuracy : 0.639377
Epoch :  3 loss training:  135.77125895023346 Time :  13765
accuracy train: 0.681006 val: 0.617910 test: 0.615137
Counter({0: 3784, 1: 2025, 2: 1591})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  101.0273305773735 Time :  13852
accuracy train: 0.791860 val: 0.716418 test: 0.692060
max validation accuracy : 0.716418 max acc epoch : 4 test accuracy : 0.692060
Epoch :  4 loss training:  102.69738215208054 Time :  13892
accuracy train: 0.739246 val: 0.674627 test: 0.658669
Counter({2: 3660, 1: 1950, 0: 1790})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  89.27416676282883 Time :  13976
accuracy train: 0.803772 val: 0.665672 test: 0.690329
max validation accuracy : 0.716418 max acc epoch : 4 test accuracy : 0.692060
Epoch :  5 loss training:  94.9457733631134 Time :  14010
accuracy train: 0.750496 val: 0.683582 test: 0.643334
Counter({2: 3195, 1: 2316, 0: 1889})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.64156571030617 Time :  14071
accuracy train: 0.841827 val: 0.704478 test: 0.697749
max validation accuracy : 0.716418 max acc epoch : 4 test accuracy : 0.692060
Epoch :  6 loss training:  83.42497056722641 Time :  14108
accuracy train: 0.743547 val: 0.641791 test: 0.645808
Counter({1: 3127, 2: 2363, 0: 1910})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  71.6266884803772 Time :  14174
accuracy train: 0.850430 val: 0.704478 test: 0.710611
max validation accuracy : 0.716418 max acc epoch : 4 test accuracy : 0.692060
Epoch :  7 loss training:  73.10059168934822 Time :  14202
accuracy train: 0.762409 val: 0.638806 test: 0.650507
Counter({2: 3121, 1: 2359, 0: 1920})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  67.59655874967575 Time :  14266
accuracy train: 0.865321 val: 0.725373 test: 0.713332
max validation accuracy : 0.725373 max acc epoch : 8 test accuracy : 0.713332
Epoch :  8 loss training:  64.48113636672497 Time :  14309
accuracy train: 0.784249 val: 0.680597 test: 0.673262
Counter({2: 3147, 1: 2350, 0: 1903})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  66.26252365112305 Time :  14363
accuracy train: 0.879881 val: 0.731343 test: 0.714321
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.714321
Epoch :  9 loss training:  62.19513466954231 Time :  14401
accuracy train: 0.785572 val: 0.668657 test: 0.669800
Counter({1: 3129, 2: 2382, 0: 1889})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.31469361484051 Time :  14463
accuracy train: 0.893779 val: 0.713433 test: 0.715558
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.714321
Epoch :  10 loss training:  59.25493337959051 Time :  14499
accuracy train: 0.796492 val: 0.671642 test: 0.663863
Counter({2: 3130, 1: 2389, 0: 1881})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.276268377900124 Time :  14560
accuracy train: 0.892124 val: 0.731343 test: 0.715558
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.714321
Epoch :  11 loss training:  55.65892820060253 Time :  14596
accuracy train: 0.818001 val: 0.698507 test: 0.680188
Counter({2: 3128, 1: 2397, 0: 1875})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  56.47255364060402 Time :  14656
accuracy train: 0.902383 val: 0.719403 test: 0.713084
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.714321
Epoch :  12 loss training:  57.05015680193901 Time :  14690
accuracy train: 0.809729 val: 0.674627 test: 0.681919
Counter({0: 3115, 1: 2409, 2: 1876})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  54.70001985132694 Time :  14750
accuracy train: 0.910324 val: 0.716418 test: 0.717042
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.714321
Epoch :  13 loss training:  53.04750173538923 Time :  14796
accuracy train: 0.820979 val: 0.686567 test: 0.680683
Counter({0: 3114, 1: 2409, 2: 1877})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  52.78057913482189 Time :  14854
accuracy train: 0.908670 val: 0.725373 test: 0.722731
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.714321
Epoch :  14 loss training:  53.018103033304214 Time :  14888
accuracy train: 0.821641 val: 0.683582 test: 0.680683
Counter({2: 3114, 1: 2412, 0: 1874})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  52.885130271315575 Time :  14944
accuracy train: 0.909662 val: 0.713433 test: 0.717042
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.714321
Epoch :  15 loss training:  50.27473717927933 Time :  14970
accuracy train: 0.820649 val: 0.680597 test: 0.677962
Counter({1: 3111, 2: 2421, 0: 1868})

Epoch :  16 loss training:  52.449132308363914 Time :  15028
accuracy train: 0.915288 val: 0.719403 test: 0.720505
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.714321
Epoch :  16 loss training:  50.10466708242893 Time :  15066
accuracy train: 0.828259 val: 0.695522 test: 0.680930
Counter({1: 3103, 2: 2426, 0: 1871})

Epoch :  17 loss training:  49.384990841150284 Time :  15129
accuracy train: 0.919590 val: 0.728358 test: 0.716547
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.714321
Epoch :  17 loss training:  50.51580519974232 Time :  15162
accuracy train: 0.817670 val: 0.665672 test: 0.676231
Counter({0: 3110, 1: 2422, 2: 1868})

Epoch :  18 loss training:  47.6802694350481 Time :  15223
accuracy train: 0.923230 val: 0.719403 test: 0.715805
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.714321
Epoch :  18 loss training:  49.263441525399685 Time :  15257
accuracy train: 0.825612 val: 0.665672 test: 0.677220
Counter({1: 3109, 2: 2422, 0: 1869})

Epoch :  19 loss training:  48.031929939985275 Time :  15308
accuracy train: 0.924222 val: 0.728358 test: 0.721247
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.714321
Epoch :  19 loss training:  49.40371602028608 Time :  15349
accuracy train: 0.834878 val: 0.674627 test: 0.681672
Counter({0: 3107, 1: 2429, 2: 1864})

Epoch :  20 loss training:  46.91387037187815 Time :  15406
accuracy train: 0.931502 val: 0.716418 test: 0.719268
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.714321
Epoch :  20 loss training:  47.453204199671745 Time :  15436
accuracy train: 0.830245 val: 0.671642 test: 0.682167
Counter({2: 3102, 1: 2428, 0: 1870})

Epoch :  21 loss training:  44.9869147464633 Time :  15489
accuracy train: 0.934811 val: 0.713433 test: 0.716547
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.714321
Epoch :  21 loss training:  47.29319407045841 Time :  15527
accuracy train: 0.835539 val: 0.686567 test: 0.682167
Counter({0: 3099, 1: 2435, 2: 1866})

Epoch :  22 loss training:  44.364919785410166 Time :  15576
accuracy train: 0.937459 val: 0.722388 test: 0.719268
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.714321
Epoch :  22 loss training:  44.988785207271576 Time :  15615
accuracy train: 0.843150 val: 0.692537 test: 0.688845
Counter({1: 3096, 2: 2439, 0: 1865})

Epoch :  23 loss training:  41.909083649516106 Time :  15675
accuracy train: 0.946062 val: 0.719403 test: 0.720999
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.714321
Epoch :  23 loss training:  45.554120883345604 Time :  15703
accuracy train: 0.838187 val: 0.692537 test: 0.682167
Counter({1: 3094, 2: 2440, 0: 1866})

Epoch :  24 loss training:  41.696573346853256 Time :  15760
accuracy train: 0.942753 val: 0.725373 test: 0.718279
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.714321
Epoch :  24 loss training:  44.4522874802351 Time :  15800
accuracy train: 0.842819 val: 0.686567 test: 0.683651
Counter({0: 3089, 1: 2445, 2: 1866})

Epoch :  25 loss training:  40.60832200944424 Time :  15852
accuracy train: 0.948709 val: 0.734328 test: 0.719021
max validation accuracy : 0.734328 max acc epoch : 25 test accuracy : 0.719021
Epoch :  25 loss training:  43.42785722017288 Time :  15890
accuracy train: 0.847121 val: 0.695522 test: 0.688598
Counter({1: 3086, 2: 2444, 0: 1870})

Epoch :  26 loss training:  39.60529728233814 Time :  15954
accuracy train: 0.954004 val: 0.728358 test: 0.715063
max validation accuracy : 0.734328 max acc epoch : 25 test accuracy : 0.719021
Epoch :  26 loss training:  44.588402561843395 Time :  15984
accuracy train: 0.846459 val: 0.683582 test: 0.687608
Counter({2: 3087, 0: 2439, 1: 1874})

Epoch :  27 loss training:  36.86570543050766 Time :  16047
accuracy train: 0.954997 val: 0.725373 test: 0.718279
max validation accuracy : 0.734328 max acc epoch : 25 test accuracy : 0.719021
Epoch :  27 loss training:  43.70547608286142 Time :  16093
accuracy train: 0.850761 val: 0.692537 test: 0.689340
Counter({0: 3090, 1: 2430, 2: 1880})

Epoch :  28 loss training:  36.865959510207176 Time :  16156
accuracy train: 0.959629 val: 0.734328 test: 0.717042
max validation accuracy : 0.734328 max acc epoch : 25 test accuracy : 0.719021
Epoch :  28 loss training:  41.159457087516785 Time :  16195
accuracy train: 0.851092 val: 0.674627 test: 0.687856
Counter({0: 3092, 1: 2427, 2: 1881})

Epoch :  29 loss training:  33.64590861648321 Time :  16260
accuracy train: 0.962938 val: 0.731343 test: 0.717784
max validation accuracy : 0.734328 max acc epoch : 25 test accuracy : 0.719021
Epoch :  29 loss training:  41.73527268320322 Time :  16302
accuracy train: 0.855725 val: 0.689552 test: 0.689587
Counter({2: 3088, 1: 2430, 0: 1882})

Epoch :  30 loss training:  34.13316782563925 Time :  16357
accuracy train: 0.962277 val: 0.731343 test: 0.720257
max validation accuracy : 0.734328 max acc epoch : 25 test accuracy : 0.719021
Epoch :  30 loss training:  40.77694010734558 Time :  16402
accuracy train: 0.848776 val: 0.677612 test: 0.683898
Counter({1: 3083, 2: 2433, 0: 1884})

Epoch :  31 loss training:  32.8854703605175 Time :  16471
accuracy train: 0.967902 val: 0.731343 test: 0.718526
max validation accuracy : 0.734328 max acc epoch : 25 test accuracy : 0.719021
Epoch :  31 loss training:  40.36833020299673 Time :  16502
accuracy train: 0.856386 val: 0.680597 test: 0.687856
Counter({0: 3090, 2: 2426, 1: 1884})

Epoch :  32 loss training:  31.823669359087944 Time :  16565
accuracy train: 0.970549 val: 0.719403 test: 0.717536
max validation accuracy : 0.734328 max acc epoch : 25 test accuracy : 0.719021
Epoch :  32 loss training:  41.934881046414375 Time :  16607
accuracy train: 0.860026 val: 0.683582 test: 0.690824
Counter({2: 3085, 1: 2428, 0: 1887})

Epoch :  33 loss training:  30.59661950916052 Time :  16659
accuracy train: 0.972204 val: 0.728358 test: 0.719268
max validation accuracy : 0.734328 max acc epoch : 25 test accuracy : 0.719021
Epoch :  33 loss training:  39.45352245867252 Time :  16694
accuracy train: 0.861350 val: 0.662687 test: 0.688598
Counter({0: 3078, 2: 2434, 1: 1888})

Epoch :  34 loss training:  29.544871233403683 Time :  16748
accuracy train: 0.972204 val: 0.725373 test: 0.720752
max validation accuracy : 0.734328 max acc epoch : 25 test accuracy : 0.719021
Epoch :  34 loss training:  38.87581067532301 Time :  16779
accuracy train: 0.858372 val: 0.668657 test: 0.690824
Counter({2: 3073, 1: 2436, 0: 1891})

Epoch :  35 loss training:  29.242300555109978 Time :  16838
accuracy train: 0.974520 val: 0.740299 test: 0.718526
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  35 loss training:  37.850842252373695 Time :  16882
accuracy train: 0.862674 val: 0.677612 test: 0.696265
Counter({1: 3074, 2: 2434, 0: 1892})

Epoch :  36 loss training:  27.7682392783463 Time :  16947
accuracy train: 0.974520 val: 0.737313 test: 0.721247
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  36 loss training:  39.78969030082226 Time :  16983
accuracy train: 0.864659 val: 0.677612 test: 0.693792
Counter({0: 3088, 1: 2433, 2: 1879})

Epoch :  37 loss training:  26.903758004307747 Time :  17046
accuracy train: 0.981800 val: 0.737313 test: 0.718526
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  37 loss training:  37.45314382016659 Time :  17077
accuracy train: 0.867637 val: 0.677612 test: 0.691566
Counter({2: 3086, 0: 2436, 1: 1878})

Epoch :  38 loss training:  25.64608547091484 Time :  17133
accuracy train: 0.978822 val: 0.731343 test: 0.720752
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  38 loss training:  37.73401167988777 Time :  17174
accuracy train: 0.867968 val: 0.656716 test: 0.688598
Counter({1: 3102, 0: 2417, 2: 1881})

Epoch :  39 loss training:  25.859053820371628 Time :  17235
accuracy train: 0.983455 val: 0.734328 test: 0.719515
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  39 loss training:  34.78409228473902 Time :  17271
accuracy train: 0.878888 val: 0.677612 test: 0.695276
Counter({1: 3101, 2: 2417, 0: 1882})

Epoch :  40 loss training:  25.110008351504803 Time :  17329
accuracy train: 0.987095 val: 0.728358 test: 0.719021
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  40 loss training:  34.63031140714884 Time :  17364
accuracy train: 0.877234 val: 0.680597 test: 0.696018
Counter({2: 3103, 1: 2421, 0: 1876})

Epoch :  41 loss training:  23.467929419130087 Time :  17422
accuracy train: 0.987095 val: 0.719403 test: 0.719268
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  41 loss training:  35.95884799212217 Time :  17468
accuracy train: 0.881535 val: 0.680597 test: 0.691813
Counter({1: 3105, 2: 2419, 0: 1876})

Epoch :  42 loss training:  23.744539130479097 Time :  17538
accuracy train: 0.986764 val: 0.728358 test: 0.720257
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  42 loss training:  35.82212555408478 Time :  17570
accuracy train: 0.877565 val: 0.680597 test: 0.690329
Counter({0: 3113, 2: 2414, 1: 1873})

Epoch :  43 loss training:  22.62858498096466 Time :  17631
accuracy train: 0.988418 val: 0.722388 test: 0.720752
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  43 loss training:  34.624950148165226 Time :  17670
accuracy train: 0.879219 val: 0.677612 test: 0.694781
Counter({1: 3114, 2: 2417, 0: 1869})

Epoch :  44 loss training:  21.065042663365602 Time :  17721
accuracy train: 0.990073 val: 0.725373 test: 0.721741
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  44 loss training:  34.79172670841217 Time :  17766
accuracy train: 0.883521 val: 0.689552 test: 0.697007
Counter({1: 3103, 2: 2423, 0: 1874})

Epoch :  45 loss training:  20.920220613479614 Time :  17819
accuracy train: 0.990404 val: 0.725373 test: 0.720752
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  45 loss training:  34.451476119458675 Time :  17849
accuracy train: 0.882197 val: 0.677612 test: 0.697502
Counter({2: 3099, 1: 2424, 0: 1877})

Epoch :  46 loss training:  19.80124130100012 Time :  17902
accuracy train: 0.991727 val: 0.722388 test: 0.720752
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  46 loss training:  33.945597395300865 Time :  17932
accuracy train: 0.888484 val: 0.686567 test: 0.698739
Counter({2: 3094, 1: 2426, 0: 1880})

Epoch :  47 loss training:  20.006299134343863 Time :  17984
accuracy train: 0.991396 val: 0.719403 test: 0.718773
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  47 loss training:  34.05012669414282 Time :  18014
accuracy train: 0.883852 val: 0.677612 test: 0.696760
Counter({2: 3089, 0: 2426, 1: 1885})

Epoch :  48 loss training:  18.317137900739908 Time :  18063
accuracy train: 0.994044 val: 0.722388 test: 0.722978
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  48 loss training:  31.78062365204096 Time :  18094
accuracy train: 0.892786 val: 0.662687 test: 0.696265
Counter({2: 3077, 1: 2435, 0: 1888})

Epoch :  49 loss training:  17.39407854154706 Time :  18154
accuracy train: 0.992720 val: 0.728358 test: 0.724709
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  49 loss training:  32.4879252538085 Time :  18184
accuracy train: 0.889146 val: 0.671642 test: 0.697502
Counter({2: 3078, 0: 2435, 1: 1887})

Epoch :  50 loss training:  15.712180487811565 Time :  18228
accuracy train: 0.995036 val: 0.725373 test: 0.720257
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  50 loss training:  33.694000504910946 Time :  18258
accuracy train: 0.890470 val: 0.674627 test: 0.696018
Counter({2: 3081, 1: 2435, 0: 1884})

Epoch :  51 loss training:  15.924623250961304 Time :  18301
accuracy train: 0.995367 val: 0.722388 test: 0.720999
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  51 loss training:  32.163258247077465 Time :  18332
accuracy train: 0.897419 val: 0.686567 test: 0.699975
Counter({1: 3082, 2: 2432, 0: 1886})

Epoch :  52 loss training:  15.75759295746684 Time :  18380
accuracy train: 0.996029 val: 0.731343 test: 0.721494
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  52 loss training:  30.74488440155983 Time :  18409
accuracy train: 0.905030 val: 0.698507 test: 0.698244
Counter({1: 3080, 2: 2433, 0: 1887})

Epoch :  53 loss training:  14.717306680977345 Time :  18458
accuracy train: 0.995698 val: 0.722388 test: 0.718526
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  53 loss training:  31.838971454650164 Time :  18488
accuracy train: 0.900397 val: 0.686567 test: 0.693050
Counter({1: 3079, 2: 2434, 0: 1887})

Epoch :  54 loss training:  15.484100945293903 Time :  18537
accuracy train: 0.997353 val: 0.719403 test: 0.716052
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  54 loss training:  30.40990686416626 Time :  18567
accuracy train: 0.902383 val: 0.692537 test: 0.695028
Counter({2: 3077, 1: 2434, 0: 1889})

Epoch :  55 loss training:  13.39400900900364 Time :  18619
accuracy train: 0.997684 val: 0.725373 test: 0.723225
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  55 loss training:  28.25316195935011 Time :  18648
accuracy train: 0.909662 val: 0.698507 test: 0.698244
Counter({2: 3072, 1: 2446, 0: 1882})

Epoch :  56 loss training:  13.515660613775253 Time :  18701
accuracy train: 0.998015 val: 0.725373 test: 0.721494
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  56 loss training:  29.054853536188602 Time :  18730
accuracy train: 0.905361 val: 0.680597 test: 0.695523
Counter({1: 3060, 2: 2459, 0: 1881})

Epoch :  57 loss training:  13.16932081617415 Time :  18779
accuracy train: 0.997684 val: 0.722388 test: 0.720752
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  57 loss training:  29.65007834881544 Time :  18809
accuracy train: 0.902713 val: 0.689552 test: 0.695276
Counter({2: 3060, 1: 2458, 0: 1882})

Epoch :  58 loss training:  12.162093998864293 Time :  18860
accuracy train: 0.998345 val: 0.725373 test: 0.724462
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  58 loss training:  29.885844960808754 Time :  18897
accuracy train: 0.911979 val: 0.674627 test: 0.695028
Counter({2: 3054, 0: 2473, 1: 1873})

Epoch :  59 loss training:  12.78340194746852 Time :  18952
accuracy train: 0.998676 val: 0.716418 test: 0.720257
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  59 loss training:  27.696260198950768 Time :  18987
accuracy train: 0.907677 val: 0.659701 test: 0.694039
Counter({1: 3051, 2: 2467, 0: 1882})

Epoch :  60 loss training:  11.827405206859112 Time :  19039
accuracy train: 0.998345 val: 0.725373 test: 0.719021
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  60 loss training:  27.338288836181164 Time :  19075
accuracy train: 0.912310 val: 0.677612 test: 0.698491
Counter({1: 3043, 2: 2472, 0: 1885})

Epoch :  61 loss training:  11.502190753817558 Time :  19125
accuracy train: 0.999007 val: 0.725373 test: 0.719515
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  61 loss training:  26.83370215445757 Time :  19160
accuracy train: 0.912641 val: 0.701493 test: 0.698244
Counter({2: 3038, 1: 2475, 0: 1887})

Epoch :  62 loss training:  10.265125207602978 Time :  19222
accuracy train: 0.999338 val: 0.731343 test: 0.715805
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  62 loss training:  26.530496176332235 Time :  19255
accuracy train: 0.922568 val: 0.686567 test: 0.704675
Counter({2: 3029, 1: 2482, 0: 1889})

Epoch :  63 loss training:  10.362546095624566 Time :  19309
accuracy train: 0.999007 val: 0.716418 test: 0.719268
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  63 loss training:  25.524795681238174 Time :  19338
accuracy train: 0.922237 val: 0.695522 test: 0.700717
Counter({2: 3027, 1: 2481, 0: 1892})

Epoch :  64 loss training:  10.81306353583932 Time :  19389
accuracy train: 0.999669 val: 0.725373 test: 0.718031
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  64 loss training:  26.173996932804585 Time :  19420
accuracy train: 0.921906 val: 0.680597 test: 0.703933
Counter({2: 3030, 1: 2479, 0: 1891})

Epoch :  65 loss training:  9.818073714151978 Time :  19473
accuracy train: 0.998676 val: 0.725373 test: 0.719021
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  65 loss training:  25.84695417433977 Time :  19503
accuracy train: 0.918597 val: 0.689552 test: 0.699975
Counter({1: 3029, 2: 2485, 0: 1886})

Epoch :  66 loss training:  9.602267330512404 Time :  19547
accuracy train: 0.998676 val: 0.725373 test: 0.716300
max validation accuracy : 0.740299 max acc epoch : 35 test accuracy : 0.718526
Epoch :  66 loss training:  25.147544905543327 Time :  19579
accuracy train: 0.927862 val: 0.701493 test: 0.704427
Counter({2: 3032, 1: 2481, 0: 1887})

========================================================================================================================================================================================================
max acc epoch :  35
max validation accuracy :  0.7402985074626866
test accuracy :  0.7185258471432104
last test_accuracy :  0.716299777393025
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=649, weight_decay=0)
device :  cuda:0
Counter({0: 2606, 2: 2534, 1: 2260})

Epoch :  1 loss training:  208.52500140666962 Time :  19678
accuracy train: 0.648577 val: 0.638806 test: 0.620084
max validation accuracy : 0.638806 max acc epoch : 1 test accuracy : 0.620084
Epoch :  1 loss training:  279.1610190272331 Time :  19709
accuracy train: 0.520516 val: 0.522388 test: 0.496166
Counter({2: 2996, 1: 2850, 0: 1554})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  142.2790619134903 Time :  19777
accuracy train: 0.714758 val: 0.668657 test: 0.646550
max validation accuracy : 0.668657 max acc epoch : 2 test accuracy : 0.646550
Epoch :  2 loss training:  162.5864935517311 Time :  19808
accuracy train: 0.621774 val: 0.576119 test: 0.567648
Counter({2: 2912, 1: 2577, 0: 1911})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  124.85717287659645 Time :  19894
accuracy train: 0.717406 val: 0.656716 test: 0.632946
max validation accuracy : 0.668657 max acc epoch : 2 test accuracy : 0.646550
Epoch :  3 loss training:  140.2339267730713 Time :  19923
accuracy train: 0.670748 val: 0.611940 test: 0.587435
Counter({2: 2645, 0: 2496, 1: 2259})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  100.81914055347443 Time :  20001
accuracy train: 0.799801 val: 0.731343 test: 0.700717
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  4 loss training:  102.47322291135788 Time :  20035
accuracy train: 0.725017 val: 0.686567 test: 0.648528
Counter({0: 2829, 2: 2371, 1: 2200})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  91.46050226688385 Time :  20099
accuracy train: 0.807412 val: 0.683582 test: 0.693050
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  5 loss training:  97.20813512802124 Time :  20131
accuracy train: 0.736267 val: 0.671642 test: 0.641355
Counter({2: 2753, 0: 2371, 1: 2276})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  83.8626358807087 Time :  20196
accuracy train: 0.837856 val: 0.713433 test: 0.700470
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  6 loss training:  84.88000378012657 Time :  20227
accuracy train: 0.751158 val: 0.638806 test: 0.643087
Counter({0: 2774, 2: 2462, 1: 2164})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  74.76298895478249 Time :  20295
accuracy train: 0.854070 val: 0.704478 test: 0.712095
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  7 loss training:  73.52363020181656 Time :  20326
accuracy train: 0.766049 val: 0.668657 test: 0.642345
Counter({2: 2766, 1: 2467, 0: 2167})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  69.55505172908306 Time :  20382
accuracy train: 0.869623 val: 0.731343 test: 0.715310
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  8 loss training:  66.67091274261475 Time :  20413
accuracy train: 0.781271 val: 0.695522 test: 0.660401
Counter({0: 2776, 1: 2443, 2: 2181})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  67.68627826869488 Time :  20473
accuracy train: 0.872270 val: 0.728358 test: 0.715310
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  9 loss training:  64.98290632665157 Time :  20504
accuracy train: 0.786565 val: 0.686567 test: 0.660401
Counter({2: 2756, 0: 2430, 1: 2214})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.40476557612419 Time :  20578
accuracy train: 0.888815 val: 0.716418 test: 0.712095
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  10 loss training:  59.20423123240471 Time :  20604
accuracy train: 0.807743 val: 0.695522 test: 0.672520
Counter({1: 2753, 2: 2427, 0: 2220})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.79329840838909 Time :  20651
accuracy train: 0.889477 val: 0.710448 test: 0.714321
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  11 loss training:  58.145123049616814 Time :  20678
accuracy train: 0.815685 val: 0.692537 test: 0.674499
Counter({0: 2753, 2: 2709, 1: 1938})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  57.93679362535477 Time :  20726
accuracy train: 0.898743 val: 0.722388 test: 0.716794
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  12 loss training:  56.55953499674797 Time :  20752
accuracy train: 0.812045 val: 0.677612 test: 0.676725
Counter({0: 2750, 1: 2717, 2: 1933})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  53.92386743426323 Time :  20805
accuracy train: 0.900397 val: 0.722388 test: 0.717289
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  13 loss training:  53.237756446003914 Time :  20830
accuracy train: 0.818663 val: 0.686567 test: 0.674746
Counter({0: 2743, 1: 2730, 2: 1927})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  53.13052572309971 Time :  20873
accuracy train: 0.901059 val: 0.728358 test: 0.722483
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  14 loss training:  53.38743869960308 Time :  20899
accuracy train: 0.816016 val: 0.677612 test: 0.672273
Counter({1: 2752, 2: 2728, 0: 1920})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  53.346711844205856 Time :  20950
accuracy train: 0.907677 val: 0.713433 test: 0.713579
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  15 loss training:  50.928187027573586 Time :  20978
accuracy train: 0.811714 val: 0.692537 test: 0.671778
Counter({0: 2778, 2: 2707, 1: 1915})

Epoch :  16 loss training:  52.095909252762794 Time :  21026
accuracy train: 0.913302 val: 0.716418 test: 0.719515
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  16 loss training:  50.29818169772625 Time :  21052
accuracy train: 0.821641 val: 0.680597 test: 0.677715
Counter({0: 2783, 1: 2705, 2: 1912})

Epoch :  17 loss training:  50.75139510631561 Time :  21100
accuracy train: 0.915288 val: 0.716418 test: 0.715805
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  17 loss training:  51.84607143700123 Time :  21129
accuracy train: 0.821641 val: 0.674627 test: 0.673015
Counter({0: 2787, 2: 2698, 1: 1915})

Epoch :  18 loss training:  50.67472657561302 Time :  21175
accuracy train: 0.919590 val: 0.722388 test: 0.721989
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  18 loss training:  50.68116770684719 Time :  21202
accuracy train: 0.821641 val: 0.677612 test: 0.674499
Counter({0: 2783, 2: 2706, 1: 1911})

Epoch :  19 loss training:  49.92474604398012 Time :  21252
accuracy train: 0.924553 val: 0.731343 test: 0.720752
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  19 loss training:  49.03658300638199 Time :  21277
accuracy train: 0.823627 val: 0.683582 test: 0.673262
Counter({1: 2786, 2: 2697, 0: 1917})

Epoch :  20 loss training:  47.33973154425621 Time :  21321
accuracy train: 0.927201 val: 0.722388 test: 0.725451
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  20 loss training:  48.46474228799343 Time :  21345
accuracy train: 0.825943 val: 0.707463 test: 0.676725
Counter({0: 2800, 1: 2681, 2: 1919})

Epoch :  21 loss training:  45.11037637293339 Time :  21395
accuracy train: 0.929517 val: 0.716418 test: 0.722731
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  21 loss training:  48.382437735795975 Time :  21421
accuracy train: 0.829914 val: 0.692537 test: 0.674746
Counter({1: 2802, 2: 2680, 0: 1918})

Epoch :  22 loss training:  44.867199160158634 Time :  21466
accuracy train: 0.934480 val: 0.710448 test: 0.718031
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  22 loss training:  46.61791041493416 Time :  21492
accuracy train: 0.839510 val: 0.689552 test: 0.683156
Counter({2: 2808, 1: 2680, 0: 1912})

Epoch :  23 loss training:  42.328283190727234 Time :  21534
accuracy train: 0.942422 val: 0.713433 test: 0.717289
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  23 loss training:  44.69880612939596 Time :  21560
accuracy train: 0.836532 val: 0.698507 test: 0.681919
Counter({2: 2808, 1: 2684, 0: 1908})

Epoch :  24 loss training:  41.38102746009827 Time :  21600
accuracy train: 0.939775 val: 0.710448 test: 0.720010
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  24 loss training:  44.85798118263483 Time :  21623
accuracy train: 0.842819 val: 0.686567 test: 0.686124
Counter({2: 2812, 1: 2682, 0: 1906})

Epoch :  25 loss training:  39.2969124019146 Time :  21661
accuracy train: 0.945400 val: 0.722388 test: 0.719021
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  25 loss training:  45.96097654104233 Time :  21683
accuracy train: 0.839841 val: 0.680597 test: 0.682661
Counter({1: 2824, 2: 2674, 0: 1902})

Epoch :  26 loss training:  39.2684925198555 Time :  21719
accuracy train: 0.948048 val: 0.722388 test: 0.719515
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  26 loss training:  45.86955560743809 Time :  21743
accuracy train: 0.843481 val: 0.698507 test: 0.680683
Counter({2: 2826, 1: 2670, 0: 1904})

Epoch :  27 loss training:  37.660197623074055 Time :  21783
accuracy train: 0.948048 val: 0.716418 test: 0.720505
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  27 loss training:  44.77105227857828 Time :  21812
accuracy train: 0.838187 val: 0.671642 test: 0.681672
Counter({0: 2855, 2: 2634, 1: 1911})

Epoch :  28 loss training:  37.58859709650278 Time :  21857
accuracy train: 0.954666 val: 0.707463 test: 0.720752
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  28 loss training:  41.52311884611845 Time :  21881
accuracy train: 0.843812 val: 0.665672 test: 0.686619
Counter({2: 2884, 1: 2600, 0: 1916})

Epoch :  29 loss training:  35.84673526883125 Time :  21926
accuracy train: 0.959960 val: 0.719403 test: 0.717536
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  29 loss training:  43.353130742907524 Time :  21954
accuracy train: 0.850099 val: 0.671642 test: 0.687608
Counter({0: 2889, 1: 2602, 2: 1909})

Epoch :  30 loss training:  34.64510951191187 Time :  21997
accuracy train: 0.963600 val: 0.725373 test: 0.721494
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  30 loss training:  42.12912344932556 Time :  22022
accuracy train: 0.843481 val: 0.683582 test: 0.679693
Counter({1: 2898, 0: 2599, 2: 1903})

Epoch :  31 loss training:  34.287452444434166 Time :  22062
accuracy train: 0.965586 val: 0.710448 test: 0.717536
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  31 loss training:  40.28536777198315 Time :  22085
accuracy train: 0.853739 val: 0.683582 test: 0.682414
Counter({2: 2905, 1: 2594, 0: 1901})

Epoch :  32 loss training:  31.469608947634697 Time :  22130
accuracy train: 0.966909 val: 0.716418 test: 0.718773
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  32 loss training:  41.70185273885727 Time :  22154
accuracy train: 0.855725 val: 0.689552 test: 0.691318
Counter({0: 2900, 1: 2602, 2: 1898})

Epoch :  33 loss training:  30.808488190174103 Time :  22194
accuracy train: 0.967240 val: 0.710448 test: 0.717289
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  33 loss training:  41.01484405994415 Time :  22219
accuracy train: 0.849437 val: 0.677612 test: 0.684393
Counter({1: 2916, 2: 2595, 0: 1889})

Epoch :  34 loss training:  30.166312910616398 Time :  22257
accuracy train: 0.968895 val: 0.713433 test: 0.719268
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  34 loss training:  40.908573523163795 Time :  22280
accuracy train: 0.856717 val: 0.698507 test: 0.688103
Counter({1: 2913, 2: 2595, 0: 1892})

Epoch :  35 loss training:  28.36023873835802 Time :  22323
accuracy train: 0.975182 val: 0.713433 test: 0.719515
max validation accuracy : 0.731343 max acc epoch : 4 test accuracy : 0.700717
Epoch :  35 loss training:  38.75970809161663 Time :  22348
accuracy train: 0.852085 val: 0.683582 test: 0.684393
Counter({1: 2907, 0: 2595, 2: 1898})

========================================================================================================================================================================================================
max acc epoch :  4
max validation accuracy :  0.7313432835820896
test accuracy :  0.7007172891417265
last test_accuracy :  0.7195152114766262
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	val_accuracy :  73.43283582089552 	test_accuracy :  69.8738560474895 	max_acc epoch :  4 	last test_accuracy :  72.14939401434577
k :  1 	val_accuracy :  73.73134328358208 	test_accuracy :  72.0504575810042 	max_acc epoch :  33 	last test_accuracy :  71.80311649765025
k :  2 	val_accuracy :  73.43283582089552 	test_accuracy :  71.67944595597329 	max_acc epoch :  26 	last test_accuracy :  72.64407618105368
k :  3 	val_accuracy :  74.02985074626865 	test_accuracy :  71.85258471432104 	max_acc epoch :  35 	last test_accuracy :  71.6299777393025
k :  4 	val_accuracy :  73.13432835820896 	test_accuracy :  70.07172891417265 	max_acc epoch :  4 	last test_accuracy :  71.95152114766262

avg :  	val_accuracy :  73.55223880597015 	test_accuracy :  71.10561464259213 	last_accuracy :  72.03561711600297
