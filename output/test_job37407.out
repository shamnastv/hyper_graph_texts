

date and time :  Tue Jun 15 12:10:07 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=15, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=864, tsne=False, val_prop=0.25, weight_decay=0)
device :  cuda:0
Counter({1: 2609, 0: 2526, 2: 2265})

Epoch :  1 loss training:  217.08695644140244 Time :  24
accuracy train: 0.654488 val: 0.591180 test: 0.596092
max validation accuracy : 0.591180 max acc epoch : 1 test accuracy : 0.596092
Counter({1: 3302, 2: 2390, 0: 1708})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  149.24571979045868 Time :  94
accuracy train: 0.701747 val: 0.628129 test: 0.612169
max validation accuracy : 0.628129 max acc epoch : 2 test accuracy : 0.612169
Counter({2: 2787, 1: 2570, 0: 2043})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  131.6162526011467 Time :  158
accuracy train: 0.749801 val: 0.647199 test: 0.658669
max validation accuracy : 0.647199 max acc epoch : 3 test accuracy : 0.658669
Counter({0: 3517, 2: 2347, 1: 1536})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  95.89200112223625 Time :  184
accuracy train: 0.803018 val: 0.679380 test: 0.678209
max validation accuracy : 0.679380 max acc epoch : 4 test accuracy : 0.678209
Counter({0: 2731, 1: 2569, 2: 2100})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  89.8731007874012 Time :  243
accuracy train: 0.809770 val: 0.679380 test: 0.676973
max validation accuracy : 0.679380 max acc epoch : 4 test accuracy : 0.678209
Counter({1: 3131, 2: 2745, 0: 1524})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  82.07225421071053 Time :  285
accuracy train: 0.836378 val: 0.668653 test: 0.688350
max validation accuracy : 0.679380 max acc epoch : 4 test accuracy : 0.678209
Counter({2: 2623, 0: 2519, 1: 2258})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  73.18375904858112 Time :  352
accuracy train: 0.864972 val: 0.686532 test: 0.697749
max validation accuracy : 0.686532 max acc epoch : 7 test accuracy : 0.697749
Counter({0: 2656, 2: 2545, 1: 2199})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.64197078347206 Time :  400
accuracy train: 0.880461 val: 0.686532 test: 0.696265
max validation accuracy : 0.686532 max acc epoch : 7 test accuracy : 0.697749
Counter({0: 2684, 1: 2538, 2: 2178})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.6154502928257 Time :  468
accuracy train: 0.884829 val: 0.698451 test: 0.690329
max validation accuracy : 0.698451 max acc epoch : 9 test accuracy : 0.690329
Counter({2: 2691, 1: 2544, 0: 2165})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.83945129811764 Time :  544
accuracy train: 0.897935 val: 0.698451 test: 0.696760
max validation accuracy : 0.698451 max acc epoch : 9 test accuracy : 0.690329
Counter({0: 2719, 2: 2505, 1: 2176})

Epoch :  11 loss training:  57.029738672077656 Time :  620
accuracy train: 0.903495 val: 0.694875 test: 0.699233
max validation accuracy : 0.698451 max acc epoch : 9 test accuracy : 0.690329
Counter({0: 2731, 1: 2494, 2: 2175})

Epoch :  12 loss training:  54.16948352754116 Time :  685
accuracy train: 0.906275 val: 0.703218 test: 0.696018
max validation accuracy : 0.703218 max acc epoch : 12 test accuracy : 0.696018
Counter({0: 2704, 1: 2506, 2: 2190})

Epoch :  13 loss training:  50.899691477417946 Time :  756
accuracy train: 0.921366 val: 0.696067 test: 0.698739
max validation accuracy : 0.703218 max acc epoch : 12 test accuracy : 0.696018
Counter({2: 2728, 0: 2492, 1: 2180})

Epoch :  14 loss training:  46.1664080619812 Time :  814
accuracy train: 0.930103 val: 0.702026 test: 0.698491
max validation accuracy : 0.703218 max acc epoch : 12 test accuracy : 0.696018
Counter({2: 3334, 1: 2583, 0: 1483})

Epoch :  15 loss training:  44.45733010023832 Time :  878
accuracy train: 0.938840 val: 0.699642 test: 0.702449
max validation accuracy : 0.703218 max acc epoch : 12 test accuracy : 0.696018
Counter({2: 3337, 1: 2587, 0: 1476})

Epoch :  16 loss training:  42.11338568478823 Time :  954
accuracy train: 0.942812 val: 0.699642 test: 0.699728
max validation accuracy : 0.703218 max acc epoch : 12 test accuracy : 0.696018
Counter({1: 2698, 2: 2489, 0: 2213})

Epoch :  17 loss training:  40.44051569700241 Time :  1008
accuracy train: 0.949960 val: 0.704410 test: 0.701459
max validation accuracy : 0.704410 max acc epoch : 17 test accuracy : 0.701459
Counter({0: 2661, 2: 2486, 1: 2253})

Epoch :  18 loss training:  36.47878771275282 Time :  1069
accuracy train: 0.961080 val: 0.704410 test: 0.699233
max validation accuracy : 0.704410 max acc epoch : 17 test accuracy : 0.701459
Counter({0: 2717, 2: 2483, 1: 2200})

Epoch :  19 loss training:  34.54223823547363 Time :  1094
accuracy train: 0.957506 val: 0.717521 test: 0.700470
max validation accuracy : 0.717521 max acc epoch : 19 test accuracy : 0.700470
Counter({1: 2763, 0: 2493, 2: 2144})

Epoch :  20 loss training:  32.20059726014733 Time :  1155
accuracy train: 0.964654 val: 0.707986 test: 0.700470
max validation accuracy : 0.717521 max acc epoch : 19 test accuracy : 0.700470
Counter({0: 2763, 1: 2493, 2: 2144})

Epoch :  21 loss training:  31.60455461591482 Time :  1194
accuracy train: 0.966640 val: 0.711561 test: 0.700965
max validation accuracy : 0.717521 max acc epoch : 19 test accuracy : 0.700470
Counter({1: 2778, 2: 2485, 0: 2137})

Epoch :  22 loss training:  27.6305337511003 Time :  1256
accuracy train: 0.975377 val: 0.704410 test: 0.702696
max validation accuracy : 0.717521 max acc epoch : 19 test accuracy : 0.700470
Counter({2: 3306, 1: 2622, 0: 1472})

Epoch :  23 loss training:  27.520977810025215 Time :  1285
accuracy train: 0.977760 val: 0.715137 test: 0.701212
max validation accuracy : 0.717521 max acc epoch : 19 test accuracy : 0.700470
Counter({0: 3297, 1: 2627, 2: 1476})

Epoch :  24 loss training:  25.501029524952173 Time :  1345
accuracy train: 0.977760 val: 0.716329 test: 0.702696
max validation accuracy : 0.717521 max acc epoch : 19 test accuracy : 0.700470
Counter({0: 3291, 1: 2642, 2: 1467})

Epoch :  25 loss training:  23.90314957499504 Time :  1380
accuracy train: 0.979349 val: 0.710369 test: 0.703438
max validation accuracy : 0.717521 max acc epoch : 19 test accuracy : 0.700470
Counter({0: 2704, 2: 2458, 1: 2238})

Epoch :  26 loss training:  21.421124175190926 Time :  1451
accuracy train: 0.984512 val: 0.712753 test: 0.703191
max validation accuracy : 0.717521 max acc epoch : 19 test accuracy : 0.700470
Counter({2: 2702, 1: 2452, 0: 2246})

Epoch :  27 loss training:  21.3121458850801 Time :  1481
accuracy train: 0.985306 val: 0.707986 test: 0.702201
max validation accuracy : 0.717521 max acc epoch : 19 test accuracy : 0.700470
Counter({2: 2706, 0: 2497, 1: 2197})

Epoch :  28 loss training:  18.7169086933136 Time :  1547
accuracy train: 0.991263 val: 0.713945 test: 0.704922
max validation accuracy : 0.717521 max acc epoch : 19 test accuracy : 0.700470
Counter({1: 3349, 2: 2582, 0: 1469})

Epoch :  29 loss training:  17.481278965249658 Time :  1579
accuracy train: 0.989674 val: 0.710369 test: 0.704180
max validation accuracy : 0.717521 max acc epoch : 19 test accuracy : 0.700470
Counter({0: 3330, 2: 2611, 1: 1459})

Epoch :  30 loss training:  16.985223691910505 Time :  1635
accuracy train: 0.992851 val: 0.711561 test: 0.704922
max validation accuracy : 0.717521 max acc epoch : 19 test accuracy : 0.700470
Counter({0: 3347, 1: 2610, 2: 1443})

Epoch :  31 loss training:  14.638340398669243 Time :  1666
accuracy train: 0.995234 val: 0.712753 test: 0.705169
max validation accuracy : 0.717521 max acc epoch : 19 test accuracy : 0.700470
Counter({2: 3311, 1: 2639, 0: 1450})

Epoch :  32 loss training:  14.102675506845117 Time :  1726
accuracy train: 0.998809 val: 0.693683 test: 0.695523
max validation accuracy : 0.717521 max acc epoch : 19 test accuracy : 0.700470
Counter({2: 2685, 0: 2480, 1: 2235})

Epoch :  33 loss training:  11.555328445509076 Time :  1756
accuracy train: 0.996426 val: 0.704410 test: 0.706159
max validation accuracy : 0.717521 max acc epoch : 19 test accuracy : 0.700470
Counter({0: 2710, 2: 2463, 1: 2227})

Epoch :  34 loss training:  11.388827838003635 Time :  1820
accuracy train: 0.996426 val: 0.707986 test: 0.707890
max validation accuracy : 0.717521 max acc epoch : 19 test accuracy : 0.700470
Counter({0: 3430, 1: 2526, 2: 1444})

Epoch :  35 loss training:  11.550674472004175 Time :  1847
accuracy train: 0.999206 val: 0.699642 test: 0.703438
max validation accuracy : 0.717521 max acc epoch : 19 test accuracy : 0.700470
Counter({0: 3395, 1: 2574, 2: 1431})

========================================================================================================================================================================================================
best acc epoch :  19
validation accuracy :  0.7175208581644815
test accuracy :  0.7004699480583725
last test_accuracy :  0.7034380410586198
second best val :  0.7163289630512515
second best test :  0.7004699480583725
max gap 5
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=15, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=172, tsne=False, val_prop=0.25, weight_decay=0)
device :  cuda:0
Counter({1: 2587, 0: 2546, 2: 2267})

Epoch :  1 loss training:  217.80460327863693 Time :  1981
accuracy train: 0.669579 val: 0.598331 test: 0.617858
max validation accuracy : 0.598331 max acc epoch : 1 test accuracy : 0.617858
Counter({0: 2788, 1: 2659, 2: 1953})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  144.23807054758072 Time :  2055
accuracy train: 0.729944 val: 0.611442 test: 0.638635
max validation accuracy : 0.611442 max acc epoch : 2 test accuracy : 0.638635
Counter({1: 2859, 0: 2603, 2: 1938})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  123.12685602903366 Time :  2129
accuracy train: 0.751787 val: 0.637664 test: 0.640613
max validation accuracy : 0.637664 max acc epoch : 3 test accuracy : 0.640613
Counter({2: 2864, 1: 2644, 0: 1892})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  99.63130544126034 Time :  2221
accuracy train: 0.801430 val: 0.674613 test: 0.671778
max validation accuracy : 0.674613 max acc epoch : 4 test accuracy : 0.671778
Counter({1: 2830, 0: 2634, 2: 1936})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  86.80467449128628 Time :  2298
accuracy train: 0.819301 val: 0.673421 test: 0.677220
max validation accuracy : 0.674613 max acc epoch : 4 test accuracy : 0.671778
Counter({2: 3754, 1: 1896, 0: 1750})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  81.94570994377136 Time :  2332
accuracy train: 0.840747 val: 0.675805 test: 0.683898
max validation accuracy : 0.675805 max acc epoch : 6 test accuracy : 0.683898
Counter({0: 2844, 2: 2569, 1: 1987})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  70.98661041259766 Time :  2377
accuracy train: 0.871724 val: 0.682956 test: 0.688350
max validation accuracy : 0.682956 max acc epoch : 7 test accuracy : 0.688350
Counter({1: 2844, 0: 2629, 2: 1927})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.6676457375288 Time :  2434
accuracy train: 0.885226 val: 0.681764 test: 0.688845
max validation accuracy : 0.682956 max acc epoch : 7 test accuracy : 0.688350
Counter({2: 2818, 0: 2662, 1: 1920})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  61.24867960810661 Time :  2470
accuracy train: 0.901906 val: 0.676996 test: 0.691318
max validation accuracy : 0.682956 max acc epoch : 7 test accuracy : 0.688350
Counter({0: 2827, 1: 2651, 2: 1922})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  55.13596581667662 Time :  2523
accuracy train: 0.899523 val: 0.694875 test: 0.696512
max validation accuracy : 0.694875 max acc epoch : 10 test accuracy : 0.696512
Counter({0: 2812, 1: 2643, 2: 1945})

Epoch :  11 loss training:  54.89822560548782 Time :  2556
accuracy train: 0.916998 val: 0.681764 test: 0.696265
max validation accuracy : 0.694875 max acc epoch : 10 test accuracy : 0.696512
Counter({0: 2812, 2: 2645, 1: 1943})

Epoch :  12 loss training:  50.892882257699966 Time :  2588
accuracy train: 0.925735 val: 0.688915 test: 0.694781
max validation accuracy : 0.694875 max acc epoch : 10 test accuracy : 0.696512
Counter({1: 2835, 2: 2635, 0: 1930})

Epoch :  13 loss training:  46.57483711838722 Time :  2646
accuracy train: 0.920572 val: 0.692491 test: 0.692308
max validation accuracy : 0.694875 max acc epoch : 10 test accuracy : 0.696512
Counter({1: 2812, 0: 2650, 2: 1938})

Epoch :  14 loss training:  46.15835642814636 Time :  2673
accuracy train: 0.936458 val: 0.694875 test: 0.699481
max validation accuracy : 0.694875 max acc epoch : 10 test accuracy : 0.696512
Counter({2: 2822, 0: 2640, 1: 1938})

Epoch :  15 loss training:  41.159198224544525 Time :  2725
accuracy train: 0.944797 val: 0.696067 test: 0.695770
max validation accuracy : 0.696067 max acc epoch : 15 test accuracy : 0.695770
Counter({1: 2830, 0: 2621, 2: 1949})

Epoch :  16 loss training:  37.920256078243256 Time :  2758
accuracy train: 0.943209 val: 0.691299 test: 0.696512
max validation accuracy : 0.696067 max acc epoch : 15 test accuracy : 0.695770
Counter({0: 2805, 1: 2647, 2: 1948})

Epoch :  17 loss training:  38.19733375310898 Time :  2821
accuracy train: 0.957109 val: 0.690107 test: 0.695523
max validation accuracy : 0.696067 max acc epoch : 15 test accuracy : 0.695770
Counter({1: 2808, 2: 2621, 0: 1971})

Epoch :  18 loss training:  36.65118848532438 Time :  2869
accuracy train: 0.965449 val: 0.696067 test: 0.696018
max validation accuracy : 0.696067 max acc epoch : 15 test accuracy : 0.695770
Counter({2: 2719, 1: 2680, 0: 2001})

Epoch :  19 loss training:  33.02304359897971 Time :  2894
accuracy train: 0.966640 val: 0.686532 test: 0.698244
max validation accuracy : 0.696067 max acc epoch : 15 test accuracy : 0.695770
Counter({0: 2730, 2: 2688, 1: 1982})

Epoch :  20 loss training:  30.23514961078763 Time :  2954
accuracy train: 0.962272 val: 0.696067 test: 0.700470
max validation accuracy : 0.696067 max acc epoch : 15 test accuracy : 0.695770
Counter({1: 2711, 0: 2704, 2: 1985})

Epoch :  21 loss training:  28.288274131715298 Time :  2993
accuracy train: 0.972200 val: 0.694875 test: 0.700470
max validation accuracy : 0.696067 max acc epoch : 15 test accuracy : 0.695770
Counter({1: 2719, 2: 2696, 0: 1985})

Epoch :  22 loss training:  26.693505197763443 Time :  3063
accuracy train: 0.975377 val: 0.702026 test: 0.700717
max validation accuracy : 0.702026 max acc epoch : 22 test accuracy : 0.700717
Counter({1: 2713, 0: 2713, 2: 1974})

Epoch :  23 loss training:  24.590590626001358 Time :  3091
accuracy train: 0.981334 val: 0.696067 test: 0.699481
max validation accuracy : 0.702026 max acc epoch : 22 test accuracy : 0.700717
Counter({1: 2731, 2: 2705, 0: 1964})

Epoch :  24 loss training:  23.1922950707376 Time :  3160
accuracy train: 0.984114 val: 0.697259 test: 0.699233
max validation accuracy : 0.702026 max acc epoch : 22 test accuracy : 0.700717
Counter({1: 2709, 2: 2708, 0: 1983})

Epoch :  25 loss training:  21.61468866840005 Time :  3189
accuracy train: 0.987292 val: 0.699642 test: 0.698244
max validation accuracy : 0.702026 max acc epoch : 22 test accuracy : 0.700717
Counter({2: 2746, 1: 2671, 0: 1983})

Epoch :  26 loss training:  19.704816695302725 Time :  3254
accuracy train: 0.986100 val: 0.693683 test: 0.699728
max validation accuracy : 0.702026 max acc epoch : 22 test accuracy : 0.700717
Counter({2: 2721, 0: 2651, 1: 2028})

Epoch :  27 loss training:  17.799160983413458 Time :  3280
accuracy train: 0.990469 val: 0.692491 test: 0.701954
max validation accuracy : 0.702026 max acc epoch : 22 test accuracy : 0.700717
Counter({1: 2706, 0: 2671, 2: 2023})

Epoch :  28 loss training:  16.930375372990966 Time :  3336
accuracy train: 0.990469 val: 0.696067 test: 0.702943
max validation accuracy : 0.702026 max acc epoch : 22 test accuracy : 0.700717
Counter({1: 2705, 2: 2678, 0: 2017})

Epoch :  29 loss training:  16.36141869984567 Time :  3375
accuracy train: 0.994837 val: 0.705602 test: 0.697502
max validation accuracy : 0.705602 max acc epoch : 29 test accuracy : 0.697502
Counter({0: 2707, 2: 2660, 1: 2033})

Epoch :  30 loss training:  14.7534414306283 Time :  3405
accuracy train: 0.993249 val: 0.696067 test: 0.702201
max validation accuracy : 0.705602 max acc epoch : 29 test accuracy : 0.697502
Counter({1: 2723, 2: 2595, 0: 2082})

Epoch :  31 loss training:  14.371022023260593 Time :  3463
accuracy train: 0.998014 val: 0.704410 test: 0.699233
max validation accuracy : 0.705602 max acc epoch : 29 test accuracy : 0.697502
Counter({2: 2716, 0: 2592, 1: 2092})

Epoch :  32 loss training:  12.909707432612777 Time :  3525
accuracy train: 0.998809 val: 0.710369 test: 0.699728
max validation accuracy : 0.710369 max acc epoch : 32 test accuracy : 0.699728
Counter({1: 2712, 2: 2555, 0: 2133})

Epoch :  33 loss training:  11.33905117586255 Time :  3549
accuracy train: 0.996823 val: 0.705602 test: 0.706159
max validation accuracy : 0.710369 max acc epoch : 32 test accuracy : 0.699728
Counter({1: 2717, 0: 2544, 2: 2139})

Epoch :  34 loss training:  10.42495890893042 Time :  3602
accuracy train: 0.997220 val: 0.703218 test: 0.705664
max validation accuracy : 0.710369 max acc epoch : 32 test accuracy : 0.699728
Counter({2: 2710, 0: 2599, 1: 2091})

Epoch :  35 loss training:  11.332382205873728 Time :  3634
accuracy train: 0.997617 val: 0.705602 test: 0.701212
max validation accuracy : 0.710369 max acc epoch : 32 test accuracy : 0.699728
Counter({1: 2683, 0: 2562, 2: 2155})

Epoch :  36 loss training:  9.911607436835766 Time :  3691
accuracy train: 0.997220 val: 0.706794 test: 0.704922
max validation accuracy : 0.710369 max acc epoch : 32 test accuracy : 0.699728
Counter({2: 2712, 1: 2518, 0: 2170})

Epoch :  37 loss training:  8.777171633206308 Time :  3727
accuracy train: 0.996823 val: 0.700834 test: 0.703933
max validation accuracy : 0.710369 max acc epoch : 32 test accuracy : 0.699728
Counter({2: 2726, 0: 2523, 1: 2151})

Epoch :  38 loss training:  8.385774802416563 Time :  3758
accuracy train: 0.999603 val: 0.699642 test: 0.704427
max validation accuracy : 0.710369 max acc epoch : 32 test accuracy : 0.699728
Counter({2: 2719, 0: 2542, 1: 2139})

Epoch :  39 loss training:  7.242715903557837 Time :  3822
accuracy train: 0.998809 val: 0.704410 test: 0.702201
max validation accuracy : 0.710369 max acc epoch : 32 test accuracy : 0.699728
Counter({2: 2725, 0: 2539, 1: 2136})

Epoch :  40 loss training:  8.067608206998557 Time :  3884
accuracy train: 0.999603 val: 0.697259 test: 0.698986
max validation accuracy : 0.710369 max acc epoch : 32 test accuracy : 0.699728
Counter({1: 2711, 0: 2517, 2: 2172})

Epoch :  41 loss training:  7.2961617722176015 Time :  3964
accuracy train: 0.999206 val: 0.704410 test: 0.700470
max validation accuracy : 0.710369 max acc epoch : 32 test accuracy : 0.699728
Counter({2: 2719, 1: 2511, 0: 2170})

Epoch :  42 loss training:  7.396331247873604 Time :  4031
accuracy train: 0.999206 val: 0.692491 test: 0.706406
max validation accuracy : 0.710369 max acc epoch : 32 test accuracy : 0.699728
Counter({1: 2722, 0: 2489, 2: 2189})

Epoch :  43 loss training:  6.2850878508761525 Time :  4120
accuracy train: 1.000000 val: 0.703218 test: 0.702696
max validation accuracy : 0.710369 max acc epoch : 32 test accuracy : 0.699728
Counter({2: 2720, 1: 2491, 0: 2189})

Epoch :  44 loss training:  6.367230675648898 Time :  4197
accuracy train: 1.000000 val: 0.699642 test: 0.704180
max validation accuracy : 0.710369 max acc epoch : 32 test accuracy : 0.699728
Counter({2: 2731, 1: 2496, 0: 2173})

Epoch :  45 loss training:  5.774677707348019 Time :  4258
accuracy train: 0.999206 val: 0.698451 test: 0.697997
max validation accuracy : 0.710369 max acc epoch : 32 test accuracy : 0.699728
Counter({1: 2664, 2: 2552, 0: 2184})

Epoch :  46 loss training:  6.03722077421844 Time :  4324
accuracy train: 1.000000 val: 0.700834 test: 0.700965
max validation accuracy : 0.710369 max acc epoch : 32 test accuracy : 0.699728
Counter({2: 2667, 1: 2552, 0: 2181})

Epoch :  47 loss training:  4.766491761431098 Time :  4369
accuracy train: 1.000000 val: 0.702026 test: 0.702696
max validation accuracy : 0.710369 max acc epoch : 32 test accuracy : 0.699728
Counter({2: 2667, 0: 2509, 1: 2224})

Epoch :  48 loss training:  4.801615545060486 Time :  4433
accuracy train: 1.000000 val: 0.710369 test: 0.700470
max validation accuracy : 0.710369 max acc epoch : 32 test accuracy : 0.699728
Counter({1: 2717, 0: 2510, 2: 2173})

========================================================================================================================================================================================================
best acc epoch :  32
validation accuracy :  0.7103694874851013
test accuracy :  0.6997279248083107
last test_accuracy :  0.7004699480583725
second best val :  0.7067938021454112
second best test :  0.6997279248083107
max gap 7
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  19 	 val_accuracy : 0.71752 	 test_accuracy : 0.70047 	 last test_accuracy : 0.70344 	 second best val : 0.71633 	 second best test : 0.70047
k :  1 	 best_acc epoch :  32 	 val_accuracy : 0.71037 	 test_accuracy : 0.69973 	 last test_accuracy : 0.70047 	 second best val : 0.70679 	 second best test : 0.69973

avg :  	 val_accuracy : 0.71395 	 test_accuracy : 0.70010 	 last_accuracy : 0.70195 	 second best val : 0.71156 	 second best test : 0.70010

std :  	 val_accuracy : 0.00358 	 test_accuracy : 0.00037 	 last_accuracy : 0.00148 	 second best val : 0.00477 	 second best test : 0.00037


date and time :  Tue Jun 15 13:24:22 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=15, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=192, tsne=False, val_prop=0.5, weight_decay=0)
device :  cuda:0
Counter({1: 2604, 0: 2534, 2: 2262})

Epoch :  1 loss training:  238.08939838409424 Time :  98
accuracy train: 0.609291 val: 0.574493 test: 0.558496
max validation accuracy : 0.574493 max acc epoch : 1 test accuracy : 0.558496
Counter({1: 3830, 2: 1966, 0: 1604})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  165.78666371107101 Time :  141
accuracy train: 0.693270 val: 0.610846 test: 0.619837
max validation accuracy : 0.610846 max acc epoch : 2 test accuracy : 0.619837
Counter({1: 3007, 0: 2771, 2: 1622})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  128.07480505108833 Time :  224
accuracy train: 0.757594 val: 0.638856 test: 0.632204
max validation accuracy : 0.638856 max acc epoch : 3 test accuracy : 0.632204
Counter({1: 3362, 2: 2414, 0: 1624})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  101.86755841970444 Time :  292
accuracy train: 0.794521 val: 0.660906 test: 0.667079
max validation accuracy : 0.660906 max acc epoch : 4 test accuracy : 0.667079
Counter({2: 2886, 1: 2822, 0: 1692})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  93.49040162563324 Time :  368
accuracy train: 0.810006 val: 0.653754 test: 0.654217
max validation accuracy : 0.660906 max acc epoch : 4 test accuracy : 0.667079
Counter({1: 2973, 2: 2716, 0: 1711})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  83.7184564769268 Time :  432
accuracy train: 0.846933 val: 0.669845 test: 0.669058
max validation accuracy : 0.669845 max acc epoch : 6 test accuracy : 0.669058
Counter({0: 2944, 1: 2751, 2: 1705})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  68.96519795060158 Time :  484
accuracy train: 0.872543 val: 0.675209 test: 0.674252
max validation accuracy : 0.675209 max acc epoch : 7 test accuracy : 0.674252
Counter({1: 2959, 0: 2794, 2: 1647})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  62.04934906959534 Time :  542
accuracy train: 0.878499 val: 0.682956 test: 0.684887
max validation accuracy : 0.682956 max acc epoch : 8 test accuracy : 0.684887
Counter({2: 2928, 0: 2758, 1: 1714})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.171280562877655 Time :  617
accuracy train: 0.896367 val: 0.686532 test: 0.689340
max validation accuracy : 0.686532 max acc epoch : 9 test accuracy : 0.689340
Counter({1: 2875, 2: 2809, 0: 1716})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  55.71277415752411 Time :  677
accuracy train: 0.893389 val: 0.687723 test: 0.693050
max validation accuracy : 0.687723 max acc epoch : 10 test accuracy : 0.693050
Counter({1: 2910, 0: 2772, 2: 1718})

Epoch :  11 loss training:  52.682810202240944 Time :  734
accuracy train: 0.919595 val: 0.694279 test: 0.696265
max validation accuracy : 0.694279 max acc epoch : 11 test accuracy : 0.696265
Counter({1: 2914, 0: 2780, 2: 1706})

Epoch :  12 loss training:  50.20867720246315 Time :  798
accuracy train: 0.925551 val: 0.693683 test: 0.690576
max validation accuracy : 0.694279 max acc epoch : 11 test accuracy : 0.696265
Counter({1: 2918, 2: 2779, 0: 1703})

Epoch :  13 loss training:  46.47836088389158 Time :  860
accuracy train: 0.923764 val: 0.693087 test: 0.691071
max validation accuracy : 0.694279 max acc epoch : 11 test accuracy : 0.696265
Counter({2: 2942, 1: 2748, 0: 1710})

Epoch :  14 loss training:  44.21480180323124 Time :  924
accuracy train: 0.940441 val: 0.690703 test: 0.691813
max validation accuracy : 0.694279 max acc epoch : 11 test accuracy : 0.696265
Counter({2: 2956, 0: 2737, 1: 1707})

Epoch :  15 loss training:  43.17618403583765 Time :  961
accuracy train: 0.946992 val: 0.687723 test: 0.699975
max validation accuracy : 0.694279 max acc epoch : 11 test accuracy : 0.696265
Counter({1: 2986, 0: 2741, 2: 1673})

Epoch :  16 loss training:  40.12842520326376 Time :  1028
accuracy train: 0.948183 val: 0.690107 test: 0.700965
max validation accuracy : 0.694279 max acc epoch : 11 test accuracy : 0.696265
Counter({0: 2972, 1: 2736, 2: 1692})

Epoch :  17 loss training:  37.49162922799587 Time :  1089
accuracy train: 0.960691 val: 0.698451 test: 0.697007
max validation accuracy : 0.698451 max acc epoch : 17 test accuracy : 0.697007
Counter({0: 2970, 1: 2733, 2: 1697})

Epoch :  18 loss training:  32.44742572307587 Time :  1161
accuracy train: 0.966647 val: 0.696067 test: 0.697255
max validation accuracy : 0.698451 max acc epoch : 17 test accuracy : 0.697007
Counter({0: 2979, 1: 2726, 2: 1695})

Epoch :  19 loss training:  32.554884150624275 Time :  1238
accuracy train: 0.968434 val: 0.699642 test: 0.698244
max validation accuracy : 0.699642 max acc epoch : 19 test accuracy : 0.698244
Counter({0: 2986, 1: 2708, 2: 1706})

Epoch :  20 loss training:  30.055941466242075 Time :  1315
accuracy train: 0.975581 val: 0.697259 test: 0.698244
max validation accuracy : 0.699642 max acc epoch : 19 test accuracy : 0.698244
Counter({0: 3008, 2: 2705, 1: 1687})

Epoch :  21 loss training:  28.086069107055664 Time :  1367
accuracy train: 0.970816 val: 0.699046 test: 0.699975
max validation accuracy : 0.699642 max acc epoch : 19 test accuracy : 0.698244
Counter({1: 3006, 2: 2688, 0: 1706})

Epoch :  22 loss training:  25.50658443197608 Time :  1432
accuracy train: 0.977963 val: 0.703814 test: 0.702449
max validation accuracy : 0.703814 max acc epoch : 22 test accuracy : 0.702449
Counter({2: 3039, 0: 2668, 1: 1693})

Epoch :  23 loss training:  24.468770537525415 Time :  1474
accuracy train: 0.985110 val: 0.698451 test: 0.694534
max validation accuracy : 0.703814 max acc epoch : 22 test accuracy : 0.702449
Counter({2: 3026, 1: 2697, 0: 1677})

Epoch :  24 loss training:  22.656620578840375 Time :  1557
accuracy train: 0.985110 val: 0.700238 test: 0.704427
max validation accuracy : 0.703814 max acc epoch : 22 test accuracy : 0.702449
Counter({0: 3026, 1: 2694, 2: 1680})

Epoch :  25 loss training:  20.61637870967388 Time :  1598
accuracy train: 0.986897 val: 0.700834 test: 0.696265
max validation accuracy : 0.703814 max acc epoch : 22 test accuracy : 0.702449
Counter({0: 3052, 1: 2675, 2: 1673})

Epoch :  26 loss training:  19.584206419065595 Time :  1654
accuracy train: 0.986301 val: 0.702622 test: 0.697997
max validation accuracy : 0.703814 max acc epoch : 22 test accuracy : 0.702449
Counter({0: 3048, 1: 2682, 2: 1670})

Epoch :  27 loss training:  18.111844459548593 Time :  1708
accuracy train: 0.991662 val: 0.696067 test: 0.699728
max validation accuracy : 0.703814 max acc epoch : 22 test accuracy : 0.702449
Counter({0: 3061, 2: 2660, 1: 1679})

Epoch :  28 loss training:  16.874342219904065 Time :  1782
accuracy train: 0.993448 val: 0.705602 test: 0.697007
max validation accuracy : 0.705602 max acc epoch : 28 test accuracy : 0.697007
Counter({0: 3074, 2: 2680, 1: 1646})

Epoch :  29 loss training:  16.01167204976082 Time :  1846
accuracy train: 0.995831 val: 0.698451 test: 0.694286
max validation accuracy : 0.705602 max acc epoch : 28 test accuracy : 0.697007
Counter({1: 3086, 2: 2693, 0: 1621})

Epoch :  30 loss training:  14.413999075070024 Time :  1907
accuracy train: 0.996426 val: 0.699642 test: 0.696018
max validation accuracy : 0.705602 max acc epoch : 28 test accuracy : 0.697007
Counter({0: 3072, 1: 2727, 2: 1601})

Epoch :  31 loss training:  13.500064233783633 Time :  1984
accuracy train: 0.998213 val: 0.700238 test: 0.697255
max validation accuracy : 0.705602 max acc epoch : 28 test accuracy : 0.697007
Counter({2: 3094, 1: 2702, 0: 1604})

Epoch :  32 loss training:  13.422359190881252 Time :  2055
accuracy train: 0.998213 val: 0.696067 test: 0.690082
max validation accuracy : 0.705602 max acc epoch : 28 test accuracy : 0.697007
Counter({2: 3108, 1: 2709, 0: 1583})

Epoch :  33 loss training:  11.92633593082428 Time :  2100
accuracy train: 0.999404 val: 0.701430 test: 0.690329
max validation accuracy : 0.705602 max acc epoch : 28 test accuracy : 0.697007
Counter({2: 3112, 1: 2708, 0: 1580})

Epoch :  34 loss training:  9.96196857187897 Time :  2166
accuracy train: 0.999404 val: 0.700238 test: 0.697255
max validation accuracy : 0.705602 max acc epoch : 28 test accuracy : 0.697007
Counter({1: 3103, 2: 2708, 0: 1589})

Epoch :  35 loss training:  9.677465864922851 Time :  2240
accuracy train: 1.000000 val: 0.700834 test: 0.696760
max validation accuracy : 0.705602 max acc epoch : 28 test accuracy : 0.697007
Counter({1: 3111, 2: 2700, 0: 1589})

Epoch :  36 loss training:  9.58382184850052 Time :  2325
accuracy train: 0.998809 val: 0.703218 test: 0.694781
max validation accuracy : 0.705602 max acc epoch : 28 test accuracy : 0.697007
Counter({1: 3122, 2: 2692, 0: 1586})

Epoch :  37 loss training:  7.258230329025537 Time :  2373
accuracy train: 0.999404 val: 0.703218 test: 0.696018
max validation accuracy : 0.705602 max acc epoch : 28 test accuracy : 0.697007
Counter({1: 3127, 0: 2718, 2: 1555})

Epoch :  38 loss training:  8.389491199050099 Time :  2457
accuracy train: 1.000000 val: 0.699046 test: 0.693544
max validation accuracy : 0.705602 max acc epoch : 28 test accuracy : 0.697007
Counter({2: 3129, 1: 2735, 0: 1536})

Epoch :  39 loss training:  8.217993653845042 Time :  2542
accuracy train: 1.000000 val: 0.701430 test: 0.687608
max validation accuracy : 0.705602 max acc epoch : 28 test accuracy : 0.697007
Counter({0: 3125, 1: 2744, 2: 1531})

Epoch :  40 loss training:  8.761129391379654 Time :  2615
accuracy train: 0.999404 val: 0.700238 test: 0.699975
max validation accuracy : 0.705602 max acc epoch : 28 test accuracy : 0.697007
Counter({1: 3155, 0: 2711, 2: 1534})

Epoch :  41 loss training:  6.565916765481234 Time :  2678
accuracy train: 1.000000 val: 0.697259 test: 0.696760
max validation accuracy : 0.705602 max acc epoch : 28 test accuracy : 0.697007
Counter({1: 3124, 0: 2728, 2: 1548})

Epoch :  42 loss training:  6.480453268624842 Time :  2760
accuracy train: 1.000000 val: 0.702622 test: 0.701212
max validation accuracy : 0.705602 max acc epoch : 28 test accuracy : 0.697007
Counter({2: 3074, 0: 2752, 1: 1574})

Epoch :  43 loss training:  6.883422028273344 Time :  2840
accuracy train: 1.000000 val: 0.700834 test: 0.693792
max validation accuracy : 0.705602 max acc epoch : 28 test accuracy : 0.697007
Counter({2: 3119, 0: 2731, 1: 1550})

Epoch :  44 loss training:  5.5481414892710745 Time :  2906
accuracy train: 1.000000 val: 0.698451 test: 0.696265
max validation accuracy : 0.705602 max acc epoch : 28 test accuracy : 0.697007
Counter({2: 3140, 0: 2721, 1: 1539})

========================================================================================================================================================================================================
best acc epoch :  28
validation accuracy :  0.7056019070321812
test accuracy :  0.6970071728914172
last test_accuracy :  0.6962651496413554
second best val :  0.7038140643623361
second best test :  0.7024486767252041
max gap 6
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=15, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=653, tsne=False, val_prop=0.5, weight_decay=0)
device :  cuda:0
Counter({0: 2602, 1: 2533, 2: 2265})

Epoch :  1 loss training:  247.27012944221497 Time :  3047
accuracy train: 0.610482 val: 0.563170 test: 0.536977
max validation accuracy : 0.563170 max acc epoch : 1 test accuracy : 0.536977
Counter({2: 3380, 0: 2085, 1: 1935})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  160.4201074242592 Time :  3075
accuracy train: 0.706373 val: 0.629321 test: 0.613901
max validation accuracy : 0.629321 max acc epoch : 2 test accuracy : 0.613901
Counter({0: 3453, 1: 2102, 2: 1845})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  134.81389552354813 Time :  3165
accuracy train: 0.741513 val: 0.637664 test: 0.625526
max validation accuracy : 0.637664 max acc epoch : 3 test accuracy : 0.625526
Counter({1: 3711, 0: 1987, 2: 1702})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  105.3318263888359 Time :  3224
accuracy train: 0.783204 val: 0.665077 test: 0.651496
max validation accuracy : 0.665077 max acc epoch : 4 test accuracy : 0.651496
Counter({0: 2956, 2: 2771, 1: 1673})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  91.57201462984085 Time :  3306
accuracy train: 0.800476 val: 0.640644 test: 0.644571
max validation accuracy : 0.665077 max acc epoch : 4 test accuracy : 0.651496
Counter({2: 3093, 1: 2661, 0: 1646})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  86.70184972882271 Time :  3349
accuracy train: 0.832638 val: 0.663290 test: 0.654959
max validation accuracy : 0.665077 max acc epoch : 4 test accuracy : 0.651496
Counter({1: 3216, 2: 2507, 0: 1677})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  70.07239027321339 Time :  3440
accuracy train: 0.866587 val: 0.674017 test: 0.668316
max validation accuracy : 0.674017 max acc epoch : 7 test accuracy : 0.668316
Counter({2: 3245, 1: 2494, 0: 1661})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  62.000612795352936 Time :  3506
accuracy train: 0.884455 val: 0.681168 test: 0.673757
max validation accuracy : 0.681168 max acc epoch : 8 test accuracy : 0.673757
Counter({2: 3259, 1: 2485, 0: 1656})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  58.54846303164959 Time :  3546
accuracy train: 0.889815 val: 0.687723 test: 0.671531
max validation accuracy : 0.687723 max acc epoch : 9 test accuracy : 0.671531
Counter({2: 3203, 0: 2541, 1: 1656})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  54.86242204904556 Time :  3611
accuracy train: 0.899345 val: 0.682956 test: 0.671284
max validation accuracy : 0.687723 max acc epoch : 9 test accuracy : 0.671531
Counter({1: 3180, 0: 2559, 2: 1661})

Epoch :  11 loss training:  51.505988746881485 Time :  3650
accuracy train: 0.922573 val: 0.689511 test: 0.674252
max validation accuracy : 0.689511 max acc epoch : 11 test accuracy : 0.674252
Counter({2: 3252, 1: 2490, 0: 1658})

Epoch :  12 loss training:  48.19675190746784 Time :  3727
accuracy train: 0.927933 val: 0.687723 test: 0.673757
max validation accuracy : 0.689511 max acc epoch : 11 test accuracy : 0.674252
Counter({2: 3213, 1: 2535, 0: 1652})

Epoch :  13 loss training:  47.09581754356623 Time :  3774
accuracy train: 0.932698 val: 0.686532 test: 0.673757
max validation accuracy : 0.689511 max acc epoch : 11 test accuracy : 0.674252
Counter({1: 3191, 0: 2555, 2: 1654})

Epoch :  14 loss training:  43.625248208642006 Time :  3841
accuracy train: 0.939250 val: 0.695471 test: 0.677220
max validation accuracy : 0.695471 max acc epoch : 14 test accuracy : 0.677220
Counter({0: 3198, 2: 2550, 1: 1652})

Epoch :  15 loss training:  40.911323338747025 Time :  3884
accuracy train: 0.944014 val: 0.691299 test: 0.673510
max validation accuracy : 0.695471 max acc epoch : 14 test accuracy : 0.677220
Counter({1: 3223, 0: 2539, 2: 1638})

Epoch :  16 loss training:  38.075370736420155 Time :  3949
accuracy train: 0.949375 val: 0.684148 test: 0.676478
max validation accuracy : 0.695471 max acc epoch : 14 test accuracy : 0.677220
Counter({2: 3194, 1: 2555, 0: 1651})

Epoch :  17 loss training:  34.73624089360237 Time :  4012
accuracy train: 0.949970 val: 0.690107 test: 0.676478
max validation accuracy : 0.695471 max acc epoch : 14 test accuracy : 0.677220
Counter({2: 3203, 1: 2544, 0: 1653})

Epoch :  18 loss training:  32.43604303896427 Time :  4050
accuracy train: 0.966647 val: 0.690703 test: 0.679446
max validation accuracy : 0.695471 max acc epoch : 14 test accuracy : 0.677220
Counter({2: 3238, 1: 2523, 0: 1639})

Epoch :  19 loss training:  30.371324837207794 Time :  4121
accuracy train: 0.967838 val: 0.694875 test: 0.679446
max validation accuracy : 0.695471 max acc epoch : 14 test accuracy : 0.677220
Counter({2: 3193, 1: 2554, 0: 1653})

Epoch :  20 loss training:  29.32488315552473 Time :  4153
accuracy train: 0.969625 val: 0.689511 test: 0.682661
max validation accuracy : 0.695471 max acc epoch : 14 test accuracy : 0.677220
Counter({2: 3251, 1: 2505, 0: 1644})

Epoch :  21 loss training:  28.093908093869686 Time :  4218
accuracy train: 0.979750 val: 0.690107 test: 0.681177
max validation accuracy : 0.695471 max acc epoch : 14 test accuracy : 0.677220
Counter({0: 3206, 1: 2563, 2: 1631})

Epoch :  22 loss training:  25.337957307696342 Time :  4274
accuracy train: 0.989875 val: 0.693683 test: 0.678951
max validation accuracy : 0.695471 max acc epoch : 14 test accuracy : 0.677220
Counter({0: 3227, 2: 2545, 1: 1628})

Epoch :  23 loss training:  21.81919315829873 Time :  4340
accuracy train: 0.988088 val: 0.684148 test: 0.679693
max validation accuracy : 0.695471 max acc epoch : 14 test accuracy : 0.677220
Counter({2: 3235, 0: 2550, 1: 1615})

Epoch :  24 loss training:  21.00910570845008 Time :  4376
accuracy train: 0.986301 val: 0.691299 test: 0.686124
max validation accuracy : 0.695471 max acc epoch : 14 test accuracy : 0.677220
Counter({2: 3227, 1: 2561, 0: 1612})

Epoch :  25 loss training:  18.382631508633494 Time :  4440
accuracy train: 0.997618 val: 0.689511 test: 0.679199
max validation accuracy : 0.695471 max acc epoch : 14 test accuracy : 0.677220
Counter({0: 3242, 1: 2559, 2: 1599})

Epoch :  26 loss training:  16.530285518616438 Time :  4482
accuracy train: 0.993448 val: 0.698451 test: 0.678704
max validation accuracy : 0.698451 max acc epoch : 26 test accuracy : 0.678704
Counter({0: 3254, 1: 2545, 2: 1601})

Epoch :  27 loss training:  16.774035929702222 Time :  4548
accuracy train: 0.994044 val: 0.689511 test: 0.677467
max validation accuracy : 0.698451 max acc epoch : 26 test accuracy : 0.678704
Counter({1: 3210, 2: 2599, 0: 1591})

Epoch :  28 loss training:  14.01004140265286 Time :  4585
accuracy train: 0.995831 val: 0.699046 test: 0.683898
max validation accuracy : 0.699046 max acc epoch : 28 test accuracy : 0.683898
Counter({0: 3267, 1: 2549, 2: 1584})

Epoch :  29 loss training:  14.225513802841306 Time :  4653
accuracy train: 0.997618 val: 0.694279 test: 0.681425
max validation accuracy : 0.699046 max acc epoch : 28 test accuracy : 0.683898
Counter({1: 3308, 0: 2506, 2: 1586})

Epoch :  30 loss training:  11.807133112102747 Time :  4724
accuracy train: 0.997618 val: 0.695471 test: 0.684640
max validation accuracy : 0.699046 max acc epoch : 28 test accuracy : 0.683898
Counter({1: 3274, 0: 2558, 2: 1568})

Epoch :  31 loss training:  13.316367424093187 Time :  4798
accuracy train: 0.997618 val: 0.690703 test: 0.677962
max validation accuracy : 0.699046 max acc epoch : 28 test accuracy : 0.683898
Counter({1: 3281, 0: 2547, 2: 1572})

Epoch :  32 loss training:  12.260745281353593 Time :  4875
accuracy train: 0.995831 val: 0.693087 test: 0.689092
max validation accuracy : 0.699046 max acc epoch : 28 test accuracy : 0.683898
Counter({2: 3268, 1: 2539, 0: 1593})

Epoch :  33 loss training:  11.306922077201307 Time :  4922
accuracy train: 0.998809 val: 0.693683 test: 0.681672
max validation accuracy : 0.699046 max acc epoch : 28 test accuracy : 0.683898
Counter({0: 3269, 1: 2561, 2: 1570})

Epoch :  34 loss training:  10.07042168173939 Time :  5004
accuracy train: 0.997618 val: 0.699642 test: 0.682167
max validation accuracy : 0.699642 max acc epoch : 34 test accuracy : 0.682167
Counter({0: 3280, 1: 2552, 2: 1568})

Epoch :  35 loss training:  7.900332256220281 Time :  5074
accuracy train: 0.998213 val: 0.690107 test: 0.681919
max validation accuracy : 0.699642 max acc epoch : 34 test accuracy : 0.682167
Counter({2: 3252, 0: 2578, 1: 1570})

Epoch :  36 loss training:  8.503838281612843 Time :  5158
accuracy train: 0.998809 val: 0.703814 test: 0.679446
max validation accuracy : 0.703814 max acc epoch : 36 test accuracy : 0.679446
Counter({2: 3228, 0: 2599, 1: 1573})

Epoch :  37 loss training:  7.47671037632972 Time :  5221
accuracy train: 0.999404 val: 0.697259 test: 0.678457
max validation accuracy : 0.703814 max acc epoch : 36 test accuracy : 0.679446
Counter({1: 3285, 0: 2560, 2: 1555})

Epoch :  38 loss training:  7.451303286012262 Time :  5309
accuracy train: 0.998213 val: 0.690703 test: 0.679446
max validation accuracy : 0.703814 max acc epoch : 36 test accuracy : 0.679446
Counter({0: 3292, 2: 2554, 1: 1554})

Epoch :  39 loss training:  7.5412855197209865 Time :  5400
accuracy train: 0.998809 val: 0.696067 test: 0.678704
max validation accuracy : 0.703814 max acc epoch : 36 test accuracy : 0.679446
Counter({1: 3308, 0: 2531, 2: 1561})

Epoch :  40 loss training:  6.015053953509778 Time :  5478
accuracy train: 0.999404 val: 0.702026 test: 0.678951
max validation accuracy : 0.703814 max acc epoch : 36 test accuracy : 0.679446
Counter({2: 3355, 0: 2509, 1: 1536})

Epoch :  41 loss training:  6.007102923002094 Time :  5581
accuracy train: 0.999404 val: 0.700834 test: 0.678209
max validation accuracy : 0.703814 max acc epoch : 36 test accuracy : 0.679446
Counter({2: 3400, 0: 2462, 1: 1538})

Epoch :  42 loss training:  6.0222275126725435 Time :  5689
accuracy train: 1.000000 val: 0.700238 test: 0.674994
max validation accuracy : 0.703814 max acc epoch : 36 test accuracy : 0.679446
Counter({1: 3339, 2: 2526, 0: 1535})

Epoch :  43 loss training:  5.842781899380498 Time :  5780
accuracy train: 1.000000 val: 0.696067 test: 0.680930
max validation accuracy : 0.703814 max acc epoch : 36 test accuracy : 0.679446
Counter({0: 3315, 1: 2532, 2: 1553})

Epoch :  44 loss training:  4.8116172414738685 Time :  5879
accuracy train: 1.000000 val: 0.701430 test: 0.679941
max validation accuracy : 0.703814 max acc epoch : 36 test accuracy : 0.679446
Counter({1: 3300, 0: 2563, 2: 1537})

Epoch :  45 loss training:  5.207886633463204 Time :  5973
accuracy train: 1.000000 val: 0.700238 test: 0.682909
max validation accuracy : 0.703814 max acc epoch : 36 test accuracy : 0.679446
Counter({1: 3284, 2: 2585, 0: 1531})

Epoch :  46 loss training:  4.823341665789485 Time :  6056
accuracy train: 0.998809 val: 0.703814 test: 0.680435
max validation accuracy : 0.703814 max acc epoch : 36 test accuracy : 0.679446
Counter({2: 3285, 1: 2583, 0: 1532})

Epoch :  47 loss training:  4.126788205234334 Time :  6142
accuracy train: 1.000000 val: 0.697855 test: 0.681672
max validation accuracy : 0.703814 max acc epoch : 36 test accuracy : 0.679446
Counter({0: 3251, 1: 2632, 2: 1517})

Epoch :  48 loss training:  3.5952686067903414 Time :  6250
accuracy train: 0.999404 val: 0.704410 test: 0.685135
max validation accuracy : 0.704410 max acc epoch : 48 test accuracy : 0.685135
Counter({0: 3235, 1: 2651, 2: 1514})

Epoch :  49 loss training:  2.967268242035061 Time :  6352
accuracy train: 1.000000 val: 0.702622 test: 0.681919
max validation accuracy : 0.704410 max acc epoch : 48 test accuracy : 0.685135
Counter({0: 3256, 1: 2641, 2: 1503})

Epoch :  50 loss training:  2.7496686428785324 Time :  6418
accuracy train: 1.000000 val: 0.699642 test: 0.688598
max validation accuracy : 0.704410 max acc epoch : 48 test accuracy : 0.685135
Counter({1: 3285, 0: 2617, 2: 1498})

Epoch :  51 loss training:  2.8880800626939163 Time :  6490
accuracy train: 1.000000 val: 0.690703 test: 0.680435
max validation accuracy : 0.704410 max acc epoch : 48 test accuracy : 0.685135
Counter({2: 3277, 0: 2623, 1: 1500})

Epoch :  52 loss training:  3.5680914373369887 Time :  6577
accuracy train: 1.000000 val: 0.693683 test: 0.680188
max validation accuracy : 0.704410 max acc epoch : 48 test accuracy : 0.685135
Counter({1: 3326, 0: 2582, 2: 1492})

Epoch :  53 loss training:  2.788373348710593 Time :  6641
accuracy train: 1.000000 val: 0.696663 test: 0.682414
max validation accuracy : 0.704410 max acc epoch : 48 test accuracy : 0.685135
Counter({2: 3368, 1: 2546, 0: 1486})

Epoch :  54 loss training:  3.278609703091206 Time :  6724
accuracy train: 1.000000 val: 0.696067 test: 0.680683
max validation accuracy : 0.704410 max acc epoch : 48 test accuracy : 0.685135
Counter({2: 3286, 0: 2632, 1: 1482})

Epoch :  55 loss training:  2.5809130854322575 Time :  6803
accuracy train: 1.000000 val: 0.702622 test: 0.678951
max validation accuracy : 0.704410 max acc epoch : 48 test accuracy : 0.685135
Counter({0: 3259, 1: 2644, 2: 1497})

Epoch :  56 loss training:  2.3614337912295014 Time :  6856
accuracy train: 1.000000 val: 0.696663 test: 0.689834
max validation accuracy : 0.704410 max acc epoch : 48 test accuracy : 0.685135
Counter({1: 3319, 2: 2590, 0: 1491})

Epoch :  57 loss training:  2.247963725356385 Time :  6942
accuracy train: 1.000000 val: 0.702622 test: 0.683898
max validation accuracy : 0.704410 max acc epoch : 48 test accuracy : 0.685135
Counter({0: 3278, 2: 2639, 1: 1483})

Epoch :  58 loss training:  3.231723647681065 Time :  7012
accuracy train: 1.000000 val: 0.696663 test: 0.684393
max validation accuracy : 0.704410 max acc epoch : 48 test accuracy : 0.685135
Counter({0: 3259, 2: 2655, 1: 1486})

Epoch :  59 loss training:  2.365881997393444 Time :  7097
accuracy train: 1.000000 val: 0.703218 test: 0.673262
max validation accuracy : 0.704410 max acc epoch : 48 test accuracy : 0.685135
Counter({0: 3290, 1: 2624, 2: 1486})

Epoch :  60 loss training:  1.6477581397630274 Time :  7191
accuracy train: 1.000000 val: 0.702026 test: 0.680188
max validation accuracy : 0.704410 max acc epoch : 48 test accuracy : 0.685135
Counter({0: 3317, 2: 2604, 1: 1479})

Epoch :  61 loss training:  2.4152137882774696 Time :  7283
accuracy train: 1.000000 val: 0.691299 test: 0.680930
max validation accuracy : 0.704410 max acc epoch : 48 test accuracy : 0.685135
Counter({1: 3298, 2: 2630, 0: 1472})

Epoch :  62 loss training:  2.4420749245909974 Time :  7379
accuracy train: 1.000000 val: 0.686532 test: 0.682414
max validation accuracy : 0.704410 max acc epoch : 48 test accuracy : 0.685135
Counter({1: 3305, 2: 2611, 0: 1484})

Epoch :  63 loss training:  2.105195127951447 Time :  7464
accuracy train: 1.000000 val: 0.689511 test: 0.678704
max validation accuracy : 0.704410 max acc epoch : 48 test accuracy : 0.685135
Counter({0: 3297, 1: 2619, 2: 1484})

Epoch :  64 loss training:  1.609934731037356 Time :  7547
accuracy train: 1.000000 val: 0.687723 test: 0.680930
max validation accuracy : 0.704410 max acc epoch : 48 test accuracy : 0.685135
Counter({1: 3342, 2: 2592, 0: 1466})

========================================================================================================================================================================================================
best acc epoch :  48
validation accuracy :  0.7044100119189511
test accuracy :  0.6851348008904279
last test_accuracy :  0.6809300024734108
second best val :  0.7038140643623361
second best test :  0.6794459559732872
max gap 12
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  28 	 val_accuracy : 0.70560 	 test_accuracy : 0.69701 	 last test_accuracy : 0.69627 	 second best val : 0.70381 	 second best test : 0.70245
k :  1 	 best_acc epoch :  48 	 val_accuracy : 0.70441 	 test_accuracy : 0.68513 	 last test_accuracy : 0.68093 	 second best val : 0.70381 	 second best test : 0.67945

avg :  	 val_accuracy : 0.70501 	 test_accuracy : 0.69107 	 last_accuracy : 0.68860 	 second best val : 0.70381 	 second best test : 0.69095

std :  	 val_accuracy : 0.00060 	 test_accuracy : 0.00594 	 last_accuracy : 0.00767 	 second best val : 0.00000 	 second best test : 0.01150


date and time :  Tue Jun 15 15:30:54 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=15, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=542, tsne=False, val_prop=0.75, weight_decay=0)
device :  cuda:0
Counter({1: 2604, 0: 2534, 2: 2262})

Epoch :  1 loss training:  269.3164870738983 Time :  147
accuracy train: 0.546429 val: 0.492253 test: 0.483304
max validation accuracy : 0.492253 max acc epoch : 1 test accuracy : 0.483304
Counter({1: 2860, 0: 2628, 2: 1912})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  186.5776525437832 Time :  242
accuracy train: 0.667857 val: 0.547080 test: 0.526837
max validation accuracy : 0.547080 max acc epoch : 2 test accuracy : 0.526837
Counter({0: 3223, 1: 2466, 2: 1711})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  158.01488576829433 Time :  343
accuracy train: 0.679762 val: 0.549861 test: 0.535988
max validation accuracy : 0.549861 max acc epoch : 3 test accuracy : 0.535988
Counter({1: 3154, 2: 2441, 0: 1805})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  115.3129495549947 Time :  432
accuracy train: 0.827381 val: 0.618991 test: 0.627504
max validation accuracy : 0.618991 max acc epoch : 4 test accuracy : 0.627504
Counter({1: 3208, 0: 2524, 2: 1668})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  85.11846251040697 Time :  511
accuracy train: 0.854762 val: 0.619785 test: 0.625278
max validation accuracy : 0.619785 max acc epoch : 5 test accuracy : 0.625278
Counter({2: 3068, 1: 2942, 0: 1390})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  76.94361996650696 Time :  584
accuracy train: 0.850000 val: 0.622567 test: 0.620826
max validation accuracy : 0.622567 max acc epoch : 6 test accuracy : 0.620826
Counter({2: 4256, 1: 1626, 0: 1518})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  65.52487862855196 Time :  685
accuracy train: 0.894048 val: 0.637267 test: 0.642839
max validation accuracy : 0.637267 max acc epoch : 7 test accuracy : 0.642839
Counter({2: 2947, 1: 2868, 0: 1585})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  54.46828394383192 Time :  775
accuracy train: 0.930952 val: 0.632499 test: 0.634925
max validation accuracy : 0.637267 max acc epoch : 7 test accuracy : 0.642839
Counter({2: 3015, 1: 2907, 0: 1478})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  51.976807940751314 Time :  853
accuracy train: 0.926190 val: 0.638458 test: 0.630472
max validation accuracy : 0.638458 max acc epoch : 9 test accuracy : 0.630472
Counter({1: 3313, 2: 2370, 0: 1717})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  41.40853222552687 Time :  922
accuracy train: 0.942857 val: 0.647596 test: 0.646055
max validation accuracy : 0.647596 max acc epoch : 10 test accuracy : 0.646055
Counter({0: 3331, 2: 2369, 1: 1700})

Epoch :  11 loss training:  42.450799252837896 Time :  996
accuracy train: 0.948810 val: 0.648788 test: 0.643087
max validation accuracy : 0.648788 max acc epoch : 11 test accuracy : 0.643087
Counter({1: 3128, 2: 2781, 0: 1491})

Epoch :  12 loss training:  36.978370887227356 Time :  1093
accuracy train: 0.965476 val: 0.649583 test: 0.654959
max validation accuracy : 0.649583 max acc epoch : 12 test accuracy : 0.654959
Counter({1: 3087, 0: 2806, 2: 1507})

Epoch :  13 loss training:  36.2826943397522 Time :  1184
accuracy train: 0.965476 val: 0.649583 test: 0.644818
max validation accuracy : 0.649583 max acc epoch : 12 test accuracy : 0.654959
Counter({2: 3072, 1: 2819, 0: 1509})

Epoch :  14 loss training:  32.67032060213387 Time :  1283
accuracy train: 0.977381 val: 0.651172 test: 0.648034
max validation accuracy : 0.651172 max acc epoch : 14 test accuracy : 0.648034
Counter({2: 3096, 1: 2814, 0: 1490})

Epoch :  15 loss training:  28.227006325498223 Time :  1356
accuracy train: 0.979762 val: 0.649583 test: 0.647539
max validation accuracy : 0.651172 max acc epoch : 14 test accuracy : 0.648034
Counter({2: 3110, 0: 2795, 1: 1495})

Epoch :  16 loss training:  25.6924883518368 Time :  1440
accuracy train: 0.982143 val: 0.649980 test: 0.647292
max validation accuracy : 0.651172 max acc epoch : 14 test accuracy : 0.648034
Counter({2: 3311, 0: 2431, 1: 1658})

Epoch :  17 loss training:  27.981855194433592 Time :  1500
accuracy train: 0.985714 val: 0.652364 test: 0.645313
max validation accuracy : 0.652364 max acc epoch : 17 test accuracy : 0.645313
Counter({2: 3317, 0: 2431, 1: 1652})

Epoch :  18 loss training:  23.724032182246447 Time :  1589
accuracy train: 0.989286 val: 0.647199 test: 0.641850
max validation accuracy : 0.652364 max acc epoch : 17 test accuracy : 0.645313
Counter({1: 4211, 2: 1660, 0: 1529})

Epoch :  19 loss training:  20.738287495449185 Time :  1656
accuracy train: 0.992857 val: 0.649186 test: 0.646055
max validation accuracy : 0.652364 max acc epoch : 17 test accuracy : 0.645313
Counter({0: 2945, 1: 2843, 2: 1612})

Epoch :  20 loss training:  20.1634367890656 Time :  1754
accuracy train: 0.990476 val: 0.646404 test: 0.640861
max validation accuracy : 0.652364 max acc epoch : 17 test accuracy : 0.645313
Counter({2: 2978, 0: 2777, 1: 1645})

Epoch :  21 loss training:  16.674593118950725 Time :  1859
accuracy train: 0.996429 val: 0.657529 test: 0.643334
max validation accuracy : 0.657529 max acc epoch : 21 test accuracy : 0.643334
Counter({1: 2951, 0: 2809, 2: 1640})

Epoch :  22 loss training:  15.87941978406161 Time :  1943
accuracy train: 0.997619 val: 0.644021 test: 0.643829
max validation accuracy : 0.657529 max acc epoch : 21 test accuracy : 0.643334
Counter({2: 2934, 1: 2836, 0: 1630})

Epoch :  23 loss training:  14.924325825297274 Time :  2023
accuracy train: 0.997619 val: 0.657132 test: 0.646055
max validation accuracy : 0.657529 max acc epoch : 21 test accuracy : 0.643334
Counter({1: 2925, 0: 2850, 2: 1625})

Epoch :  24 loss training:  12.02766215056181 Time :  2111
accuracy train: 0.997619 val: 0.657132 test: 0.647539
max validation accuracy : 0.657529 max acc epoch : 21 test accuracy : 0.643334
Counter({2: 2916, 1: 2882, 0: 1602})

Epoch :  25 loss training:  11.52045819349587 Time :  2200
accuracy train: 1.000000 val: 0.657926 test: 0.642839
max validation accuracy : 0.657926 max acc epoch : 25 test accuracy : 0.642839
Counter({0: 2905, 2: 2884, 1: 1611})

Epoch :  26 loss training:  11.23258846020326 Time :  2274
accuracy train: 1.000000 val: 0.652364 test: 0.636656
max validation accuracy : 0.657926 max acc epoch : 25 test accuracy : 0.642839
Counter({1: 2921, 0: 2869, 2: 1610})

Epoch :  27 loss training:  9.575804480351508 Time :  2342
accuracy train: 1.000000 val: 0.657529 test: 0.644818
max validation accuracy : 0.657926 max acc epoch : 25 test accuracy : 0.642839
Counter({1: 2961, 0: 2832, 2: 1607})

Epoch :  28 loss training:  9.622859268449247 Time :  2393
accuracy train: 1.000000 val: 0.659913 test: 0.647786
max validation accuracy : 0.659913 max acc epoch : 28 test accuracy : 0.647786
Counter({2: 3005, 1: 2797, 0: 1598})

Epoch :  29 loss training:  8.537226014304906 Time :  2442
accuracy train: 0.998810 val: 0.656734 test: 0.649765
max validation accuracy : 0.659913 max acc epoch : 28 test accuracy : 0.647786
Counter({0: 3044, 2: 2781, 1: 1575})

Epoch :  30 loss training:  7.900009524775669 Time :  2491
accuracy train: 0.998810 val: 0.653556 test: 0.640861
max validation accuracy : 0.659913 max acc epoch : 28 test accuracy : 0.647786
Counter({2: 3023, 0: 2780, 1: 1597})

Epoch :  31 loss training:  7.752472245367244 Time :  2539
accuracy train: 0.998810 val: 0.655145 test: 0.646302
max validation accuracy : 0.659913 max acc epoch : 28 test accuracy : 0.647786
Counter({2: 3019, 0: 2773, 1: 1608})

Epoch :  32 loss training:  6.813163601560518 Time :  2586
accuracy train: 1.000000 val: 0.646802 test: 0.648034
max validation accuracy : 0.659913 max acc epoch : 28 test accuracy : 0.647786
Counter({1: 3071, 0: 2759, 2: 1570})

Epoch :  33 loss training:  6.147803576430306 Time :  2635
accuracy train: 1.000000 val: 0.658721 test: 0.650260
max validation accuracy : 0.659913 max acc epoch : 28 test accuracy : 0.647786
Counter({0: 3134, 1: 2754, 2: 1512})

Epoch :  34 loss training:  5.935456418490503 Time :  2683
accuracy train: 1.000000 val: 0.653953 test: 0.653722
max validation accuracy : 0.659913 max acc epoch : 28 test accuracy : 0.647786
Counter({1: 3160, 2: 2729, 0: 1511})

Epoch :  35 loss training:  5.860311261145398 Time :  2747
accuracy train: 0.998810 val: 0.659913 test: 0.647786
max validation accuracy : 0.659913 max acc epoch : 28 test accuracy : 0.647786
Counter({1: 3136, 2: 2734, 0: 1530})

Epoch :  36 loss training:  4.814313987677451 Time :  2823
accuracy train: 1.000000 val: 0.650377 test: 0.643829
max validation accuracy : 0.659913 max acc epoch : 28 test accuracy : 0.647786
Counter({1: 3117, 0: 2725, 2: 1558})

Epoch :  37 loss training:  5.398594507249072 Time :  2885
accuracy train: 1.000000 val: 0.657926 test: 0.652733
max validation accuracy : 0.659913 max acc epoch : 28 test accuracy : 0.647786
Counter({2: 3146, 0: 2736, 1: 1518})

Epoch :  38 loss training:  4.806821866892278 Time :  2942
accuracy train: 1.000000 val: 0.661899 test: 0.647539
max validation accuracy : 0.661899 max acc epoch : 38 test accuracy : 0.647539
Counter({0: 3189, 2: 2696, 1: 1515})

Epoch :  39 loss training:  3.0632573200855404 Time :  3013
accuracy train: 1.000000 val: 0.656337 test: 0.646055
max validation accuracy : 0.661899 max acc epoch : 38 test accuracy : 0.647539
Counter({2: 3187, 1: 2699, 0: 1514})

Epoch :  40 loss training:  3.8579318436968606 Time :  3082
accuracy train: 1.000000 val: 0.654748 test: 0.648528
max validation accuracy : 0.661899 max acc epoch : 38 test accuracy : 0.647539
Counter({1: 3168, 2: 2709, 0: 1523})

Epoch :  41 loss training:  2.886471540448838 Time :  3166
accuracy train: 1.000000 val: 0.658721 test: 0.655949
max validation accuracy : 0.661899 max acc epoch : 38 test accuracy : 0.647539
Counter({0: 3186, 1: 2692, 2: 1522})

Epoch :  42 loss training:  4.603343705064617 Time :  3274
accuracy train: 1.000000 val: 0.649186 test: 0.649518
max validation accuracy : 0.661899 max acc epoch : 38 test accuracy : 0.647539
Counter({0: 3205, 1: 2701, 2: 1494})

Epoch :  43 loss training:  3.591636799275875 Time :  3366
accuracy train: 1.000000 val: 0.653556 test: 0.646302
max validation accuracy : 0.661899 max acc epoch : 38 test accuracy : 0.647539
Counter({1: 3202, 0: 2693, 2: 1505})

Epoch :  44 loss training:  3.673038951586932 Time :  3445
accuracy train: 1.000000 val: 0.656734 test: 0.645808
max validation accuracy : 0.661899 max acc epoch : 38 test accuracy : 0.647539
Counter({1: 3186, 2: 2700, 0: 1514})

Epoch :  45 loss training:  2.950900378637016 Time :  3537
accuracy train: 1.000000 val: 0.654748 test: 0.642097
max validation accuracy : 0.661899 max acc epoch : 38 test accuracy : 0.647539
Counter({0: 3195, 1: 2696, 2: 1509})

Epoch :  46 loss training:  2.3723057794268243 Time :  3618
accuracy train: 1.000000 val: 0.654350 test: 0.644818
max validation accuracy : 0.661899 max acc epoch : 38 test accuracy : 0.647539
Counter({1: 3177, 2: 2713, 0: 1510})

Epoch :  47 loss training:  1.9544225517020095 Time :  3709
accuracy train: 1.000000 val: 0.655542 test: 0.650507
max validation accuracy : 0.661899 max acc epoch : 38 test accuracy : 0.647539
Counter({1: 3192, 0: 2697, 2: 1511})

Epoch :  48 loss training:  1.7548711622366682 Time :  3790
accuracy train: 1.000000 val: 0.657926 test: 0.651002
max validation accuracy : 0.661899 max acc epoch : 38 test accuracy : 0.647539
Counter({2: 3193, 0: 2701, 1: 1506})

Epoch :  49 loss training:  1.576234478794504 Time :  3869
accuracy train: 1.000000 val: 0.659118 test: 0.650012
max validation accuracy : 0.661899 max acc epoch : 38 test accuracy : 0.647539
Counter({1: 3196, 0: 2709, 2: 1495})

Epoch :  50 loss training:  1.8401489778771065 Time :  3926
accuracy train: 1.000000 val: 0.659118 test: 0.653475
max validation accuracy : 0.661899 max acc epoch : 38 test accuracy : 0.647539
Counter({1: 3226, 0: 2688, 2: 1486})

Epoch :  51 loss training:  1.449243892217055 Time :  3970
accuracy train: 1.000000 val: 0.663091 test: 0.656443
max validation accuracy : 0.663091 max acc epoch : 51 test accuracy : 0.656443
Counter({1: 3230, 0: 2692, 2: 1478})

Epoch :  52 loss training:  1.2567005301243626 Time :  4018
accuracy train: 1.000000 val: 0.665475 test: 0.652238
max validation accuracy : 0.665475 max acc epoch : 52 test accuracy : 0.652238
Counter({0: 3222, 1: 2702, 2: 1476})

Epoch :  53 loss training:  1.217228263936704 Time :  4066
accuracy train: 1.000000 val: 0.664680 test: 0.650012
max validation accuracy : 0.665475 max acc epoch : 52 test accuracy : 0.652238
Counter({1: 3285, 2: 2643, 0: 1472})

Epoch :  54 loss training:  1.4046262319898233 Time :  4126
accuracy train: 1.000000 val: 0.654350 test: 0.651744
max validation accuracy : 0.665475 max acc epoch : 52 test accuracy : 0.652238
Counter({1: 3261, 0: 2648, 2: 1491})

Epoch :  55 loss training:  3.0587139086492243 Time :  4177
accuracy train: 1.000000 val: 0.652364 test: 0.640613
max validation accuracy : 0.665475 max acc epoch : 52 test accuracy : 0.652238
Counter({0: 3259, 1: 2647, 2: 1494})

Epoch :  56 loss training:  1.4451870002085343 Time :  4221
accuracy train: 1.000000 val: 0.662296 test: 0.651744
max validation accuracy : 0.665475 max acc epoch : 52 test accuracy : 0.652238
Counter({2: 3246, 1: 2672, 0: 1482})

Epoch :  57 loss training:  1.8036654601601185 Time :  4270
accuracy train: 1.000000 val: 0.647199 test: 0.647539
max validation accuracy : 0.665475 max acc epoch : 52 test accuracy : 0.652238
Counter({1: 3281, 2: 2639, 0: 1480})

Epoch :  58 loss training:  2.045094183384208 Time :  4321
accuracy train: 1.000000 val: 0.656734 test: 0.641108
max validation accuracy : 0.665475 max acc epoch : 52 test accuracy : 0.652238
Counter({1: 3340, 2: 2581, 0: 1479})

Epoch :  59 loss training:  2.012008112302283 Time :  4377
accuracy train: 1.000000 val: 0.656337 test: 0.652238
max validation accuracy : 0.665475 max acc epoch : 52 test accuracy : 0.652238
Counter({2: 3322, 1: 2606, 0: 1472})

Epoch :  60 loss training:  1.7784559418214485 Time :  4424
accuracy train: 1.000000 val: 0.650377 test: 0.646550
max validation accuracy : 0.665475 max acc epoch : 52 test accuracy : 0.652238
Counter({0: 3337, 2: 2589, 1: 1474})

Epoch :  61 loss training:  0.7918966602883302 Time :  4466
accuracy train: 1.000000 val: 0.656337 test: 0.653228
max validation accuracy : 0.665475 max acc epoch : 52 test accuracy : 0.652238
Counter({0: 3344, 1: 2582, 2: 1474})

Epoch :  62 loss training:  3.883643596811453 Time :  4499
accuracy train: 1.000000 val: 0.647596 test: 0.651744
max validation accuracy : 0.665475 max acc epoch : 52 test accuracy : 0.652238
Counter({0: 3270, 1: 2630, 2: 1500})

Epoch :  63 loss training:  1.4459426836110651 Time :  4550
accuracy train: 1.000000 val: 0.651569 test: 0.647539
max validation accuracy : 0.665475 max acc epoch : 52 test accuracy : 0.652238
Counter({1: 3290, 2: 2613, 0: 1497})

Epoch :  64 loss training:  1.2649210140807554 Time :  4594
accuracy train: 1.000000 val: 0.646404 test: 0.651002
max validation accuracy : 0.665475 max acc epoch : 52 test accuracy : 0.652238
Counter({2: 3311, 0: 2599, 1: 1490})

Epoch :  65 loss training:  1.7138287982088514 Time :  4639
accuracy train: 1.000000 val: 0.643226 test: 0.637398
max validation accuracy : 0.665475 max acc epoch : 52 test accuracy : 0.652238
Counter({1: 3312, 2: 2613, 0: 1475})

Epoch :  66 loss training:  1.0698674078885233 Time :  4684
accuracy train: 1.000000 val: 0.650377 test: 0.647292
max validation accuracy : 0.665475 max acc epoch : 52 test accuracy : 0.652238
Counter({2: 3292, 1: 2630, 0: 1478})

Epoch :  67 loss training:  1.1119334587247067 Time :  4718
accuracy train: 1.000000 val: 0.654748 test: 0.651002
max validation accuracy : 0.665475 max acc epoch : 52 test accuracy : 0.652238
Counter({2: 3002, 1: 2920, 0: 1478})

Epoch :  68 loss training:  0.9343447882856708 Time :  4764
accuracy train: 1.000000 val: 0.656734 test: 0.654712
max validation accuracy : 0.665475 max acc epoch : 52 test accuracy : 0.652238
Counter({1: 2987, 2: 2939, 0: 1474})

========================================================================================================================================================================================================
best acc epoch :  52
validation accuracy :  0.6654747715534366
test accuracy :  0.6522384368043532
last test_accuracy :  0.6547118476378927
second best val :  0.6646801748112833
second best test :  0.6522384368043532
max gap 13
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=15, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=320, tsne=False, val_prop=0.75, weight_decay=0)
device :  cuda:0
Counter({2: 2603, 0: 2533, 1: 2264})

Epoch :  1 loss training:  280.33571434020996 Time :  4815
accuracy train: 0.539286 val: 0.495828 test: 0.471927
max validation accuracy : 0.495828 max acc epoch : 1 test accuracy : 0.471927
Counter({0: 3850, 1: 1970, 2: 1580})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  193.30872136354446 Time :  4860
accuracy train: 0.701190 val: 0.569726 test: 0.554786
max validation accuracy : 0.569726 max acc epoch : 2 test accuracy : 0.554786
Counter({1: 4130, 0: 1661, 2: 1609})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  147.30147624015808 Time :  4898
accuracy train: 0.726190 val: 0.593961 test: 0.587188
max validation accuracy : 0.593961 max acc epoch : 3 test accuracy : 0.587188
Counter({1: 3109, 0: 2941, 2: 1350})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  102.85118740051985 Time :  4974
accuracy train: 0.810714 val: 0.616607 test: 0.619095
max validation accuracy : 0.616607 max acc epoch : 4 test accuracy : 0.619095
Counter({2: 4380, 0: 1690, 1: 1330})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  89.79163225181401 Time :  5048
accuracy train: 0.864286 val: 0.619785 test: 0.623300
max validation accuracy : 0.619785 max acc epoch : 5 test accuracy : 0.623300
Counter({2: 4460, 0: 1635, 1: 1305})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  77.67725235037506 Time :  5100
accuracy train: 0.883333 val: 0.628129 test: 0.619342
max validation accuracy : 0.628129 max acc epoch : 6 test accuracy : 0.619342
Counter({1: 4485, 0: 1619, 2: 1296})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  60.08991400524974 Time :  5149
accuracy train: 0.885714 val: 0.628129 test: 0.634183
max validation accuracy : 0.628129 max acc epoch : 6 test accuracy : 0.619342
Counter({0: 4501, 1: 1593, 2: 1306})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  53.17867008969188 Time :  5200
accuracy train: 0.919048 val: 0.640445 test: 0.632946
max validation accuracy : 0.640445 max acc epoch : 8 test accuracy : 0.632946
Counter({1: 4519, 2: 1583, 0: 1298})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  48.68919315934181 Time :  5251
accuracy train: 0.919048 val: 0.637664 test: 0.637398
max validation accuracy : 0.640445 max acc epoch : 8 test accuracy : 0.632946
Counter({0: 4493, 2: 1596, 1: 1311})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  41.59295563027263 Time :  5296
accuracy train: 0.951190 val: 0.650377 test: 0.643334
max validation accuracy : 0.650377 max acc epoch : 10 test accuracy : 0.643334
Counter({0: 4477, 1: 1611, 2: 1312})

Epoch :  11 loss training:  40.32853495422751 Time :  5358
accuracy train: 0.951190 val: 0.649583 test: 0.645313
max validation accuracy : 0.650377 max acc epoch : 10 test accuracy : 0.643334
Counter({1: 4487, 2: 1602, 0: 1311})

Epoch :  12 loss training:  35.37399700284004 Time :  5396
accuracy train: 0.954762 val: 0.647596 test: 0.644324
max validation accuracy : 0.650377 max acc epoch : 10 test accuracy : 0.643334
Counter({2: 4498, 0: 1586, 1: 1316})

Epoch :  13 loss training:  33.97813560068607 Time :  5447
accuracy train: 0.955952 val: 0.642829 test: 0.641850
max validation accuracy : 0.650377 max acc epoch : 10 test accuracy : 0.643334
Counter({1: 4490, 0: 1595, 2: 1315})

Epoch :  14 loss training:  30.787981101777405 Time :  5495
accuracy train: 0.957143 val: 0.647199 test: 0.642345
max validation accuracy : 0.650377 max acc epoch : 10 test accuracy : 0.643334
Counter({1: 4473, 2: 1605, 0: 1322})

Epoch :  15 loss training:  28.562287699896842 Time :  5546
accuracy train: 0.973810 val: 0.636075 test: 0.646302
max validation accuracy : 0.650377 max acc epoch : 10 test accuracy : 0.643334
Counter({0: 4105, 2: 1977, 1: 1318})

Epoch :  16 loss training:  25.979014019481838 Time :  5622
accuracy train: 0.979762 val: 0.646007 test: 0.644324
max validation accuracy : 0.650377 max acc epoch : 10 test accuracy : 0.643334
Counter({2: 4099, 1: 1989, 0: 1312})

Epoch :  17 loss training:  21.26370990741998 Time :  5697
accuracy train: 0.984524 val: 0.645213 test: 0.641603
max validation accuracy : 0.650377 max acc epoch : 10 test accuracy : 0.643334
Counter({0: 4095, 2: 1989, 1: 1316})

Epoch :  18 loss training:  21.565258036367595 Time :  5759
accuracy train: 0.980952 val: 0.644815 test: 0.643334
max validation accuracy : 0.650377 max acc epoch : 10 test accuracy : 0.643334
Counter({0: 4096, 2: 1990, 1: 1314})

Epoch :  19 loss training:  19.34199482947588 Time :  5831
accuracy train: 0.990476 val: 0.645213 test: 0.648776
max validation accuracy : 0.650377 max acc epoch : 10 test accuracy : 0.643334
Counter({0: 4117, 2: 1966, 1: 1317})

Epoch :  20 loss training:  19.255789179354906 Time :  5881
accuracy train: 0.994048 val: 0.644021 test: 0.647044
max validation accuracy : 0.650377 max acc epoch : 10 test accuracy : 0.643334
Counter({0: 4137, 1: 1966, 2: 1297})

Epoch :  21 loss training:  15.78982014581561 Time :  5933
accuracy train: 0.994048 val: 0.644418 test: 0.641108
max validation accuracy : 0.650377 max acc epoch : 10 test accuracy : 0.643334
Counter({1: 4473, 2: 1616, 0: 1311})

Epoch :  22 loss training:  15.416711509227753 Time :  5977
accuracy train: 0.992857 val: 0.649980 test: 0.643829
max validation accuracy : 0.650377 max acc epoch : 10 test accuracy : 0.643334
Counter({0: 4093, 2: 2001, 1: 1306})

Epoch :  23 loss training:  15.256835002452135 Time :  6052
accuracy train: 0.990476 val: 0.638458 test: 0.638882
max validation accuracy : 0.650377 max acc epoch : 10 test accuracy : 0.643334
Counter({2: 4064, 0: 2034, 1: 1302})

Epoch :  24 loss training:  12.555625383742154 Time :  6123
accuracy train: 0.998810 val: 0.639253 test: 0.639871
max validation accuracy : 0.650377 max acc epoch : 10 test accuracy : 0.643334
Counter({0: 4061, 2: 2033, 1: 1306})

Epoch :  25 loss training:  11.001007566228509 Time :  6211
accuracy train: 1.000000 val: 0.649186 test: 0.645313
max validation accuracy : 0.650377 max acc epoch : 10 test accuracy : 0.643334
Counter({0: 4056, 2: 2038, 1: 1306})

Epoch :  26 loss training:  9.48578050173819 Time :  6298
accuracy train: 0.995238 val: 0.650775 test: 0.650754
max validation accuracy : 0.650775 max acc epoch : 26 test accuracy : 0.650754
Counter({1: 4079, 0: 2019, 2: 1302})

Epoch :  27 loss training:  10.389131613075733 Time :  6387
accuracy train: 0.995238 val: 0.649583 test: 0.648034
max validation accuracy : 0.650775 max acc epoch : 26 test accuracy : 0.650754
Counter({2: 4071, 1: 2031, 0: 1298})

Epoch :  28 loss training:  8.987857750616968 Time :  6482
accuracy train: 1.000000 val: 0.645213 test: 0.650754
max validation accuracy : 0.650775 max acc epoch : 26 test accuracy : 0.650754
Counter({1: 4086, 0: 2027, 2: 1287})

Epoch :  29 loss training:  7.173786030383781 Time :  6558
accuracy train: 0.997619 val: 0.646802 test: 0.649765
max validation accuracy : 0.650775 max acc epoch : 26 test accuracy : 0.650754
Counter({1: 4552, 2: 1556, 0: 1292})

Epoch :  30 loss training:  6.009526605019346 Time :  6618
accuracy train: 1.000000 val: 0.647994 test: 0.650260
max validation accuracy : 0.650775 max acc epoch : 26 test accuracy : 0.650754
Counter({2: 4554, 0: 1554, 1: 1292})

Epoch :  31 loss training:  5.586848500650376 Time :  6678
accuracy train: 1.000000 val: 0.651967 test: 0.654712
max validation accuracy : 0.651967 max acc epoch : 31 test accuracy : 0.654712
Counter({0: 4079, 2: 2025, 1: 1296})

Epoch :  32 loss training:  5.149865426355973 Time :  6748
accuracy train: 1.000000 val: 0.652761 test: 0.657433
max validation accuracy : 0.652761 max acc epoch : 32 test accuracy : 0.657433
Counter({0: 4112, 2: 1991, 1: 1297})

Epoch :  33 loss training:  4.936725872568786 Time :  6825
accuracy train: 0.998810 val: 0.652761 test: 0.649518
max validation accuracy : 0.652761 max acc epoch : 32 test accuracy : 0.657433
Counter({0: 4102, 2: 2000, 1: 1298})

Epoch :  34 loss training:  4.721476107020862 Time :  6918
accuracy train: 1.000000 val: 0.650377 test: 0.647786
max validation accuracy : 0.652761 max acc epoch : 32 test accuracy : 0.657433
Counter({1: 4118, 0: 1981, 2: 1301})

Epoch :  35 loss training:  4.600921998964623 Time :  7001
accuracy train: 1.000000 val: 0.650775 test: 0.647292
max validation accuracy : 0.652761 max acc epoch : 32 test accuracy : 0.657433
Counter({2: 4564, 1: 1534, 0: 1302})

Epoch :  36 loss training:  4.386786109535024 Time :  7056
accuracy train: 1.000000 val: 0.653953 test: 0.650012
max validation accuracy : 0.653953 max acc epoch : 36 test accuracy : 0.650012
Counter({1: 4556, 2: 1547, 0: 1297})

Epoch :  37 loss training:  4.509515199577436 Time :  7106
accuracy train: 1.000000 val: 0.656337 test: 0.650012
max validation accuracy : 0.656337 max acc epoch : 37 test accuracy : 0.650012
Counter({2: 4578, 1: 1525, 0: 1297})

Epoch :  38 loss training:  3.7784088370390236 Time :  7153
accuracy train: 1.000000 val: 0.647596 test: 0.650754
max validation accuracy : 0.656337 max acc epoch : 37 test accuracy : 0.650012
Counter({0: 4096, 2: 2005, 1: 1299})

Epoch :  39 loss training:  3.1622734226984903 Time :  7201
accuracy train: 1.000000 val: 0.652761 test: 0.650260
max validation accuracy : 0.656337 max acc epoch : 37 test accuracy : 0.650012
Counter({2: 4576, 0: 1529, 1: 1295})

Epoch :  40 loss training:  4.059253003448248 Time :  7265
accuracy train: 1.000000 val: 0.654350 test: 0.658917
max validation accuracy : 0.656337 max acc epoch : 37 test accuracy : 0.650012
Counter({2: 4590, 0: 1526, 1: 1284})

Epoch :  41 loss training:  2.122758998651989 Time :  7325
accuracy train: 1.000000 val: 0.649186 test: 0.652980
max validation accuracy : 0.656337 max acc epoch : 37 test accuracy : 0.650012
Counter({0: 4601, 2: 1519, 1: 1280})

Epoch :  42 loss training:  3.360698224103544 Time :  7371
accuracy train: 1.000000 val: 0.649186 test: 0.652238
max validation accuracy : 0.656337 max acc epoch : 37 test accuracy : 0.650012
Counter({1: 4615, 0: 1498, 2: 1287})

Epoch :  43 loss training:  3.1525122072489467 Time :  7444
accuracy train: 1.000000 val: 0.642829 test: 0.647786
max validation accuracy : 0.656337 max acc epoch : 37 test accuracy : 0.650012
Counter({1: 4603, 2: 1529, 0: 1268})

Epoch :  44 loss training:  2.829478877596557 Time :  7523
accuracy train: 0.998810 val: 0.652364 test: 0.651496
max validation accuracy : 0.656337 max acc epoch : 37 test accuracy : 0.650012
Counter({0: 4162, 2: 1972, 1: 1266})

Epoch :  45 loss training:  2.234590782347368 Time :  7612
accuracy train: 1.000000 val: 0.652761 test: 0.652238
max validation accuracy : 0.656337 max acc epoch : 37 test accuracy : 0.650012
Counter({0: 4632, 1: 1503, 2: 1265})

Epoch :  46 loss training:  2.015428747283295 Time :  7690
accuracy train: 1.000000 val: 0.651569 test: 0.653722
max validation accuracy : 0.656337 max acc epoch : 37 test accuracy : 0.650012
Counter({1: 4623, 2: 1505, 0: 1272})

Epoch :  47 loss training:  1.9215449182665907 Time :  7742
accuracy train: 1.000000 val: 0.651172 test: 0.655207
max validation accuracy : 0.656337 max acc epoch : 37 test accuracy : 0.650012
Counter({2: 4644, 1: 1489, 0: 1267})

Epoch :  48 loss training:  2.239389971247874 Time :  7805
accuracy train: 1.000000 val: 0.644418 test: 0.650754
max validation accuracy : 0.656337 max acc epoch : 37 test accuracy : 0.650012
Counter({2: 4628, 0: 1512, 1: 1260})

Epoch :  49 loss training:  1.7355143656313885 Time :  7854
accuracy train: 1.000000 val: 0.656337 test: 0.656196
max validation accuracy : 0.656337 max acc epoch : 37 test accuracy : 0.650012
Counter({2: 4620, 0: 1519, 1: 1261})

Epoch :  50 loss training:  1.4508877826265234 Time :  7901
accuracy train: 1.000000 val: 0.653159 test: 0.654959
max validation accuracy : 0.656337 max acc epoch : 37 test accuracy : 0.650012
Counter({0: 4626, 2: 1522, 1: 1252})

Epoch :  51 loss training:  2.88446695136372 Time :  7954
accuracy train: 0.996429 val: 0.646007 test: 0.644076
max validation accuracy : 0.656337 max acc epoch : 37 test accuracy : 0.650012
Counter({2: 4634, 0: 1507, 1: 1259})

Epoch :  52 loss training:  1.5517520766243251 Time :  7995
accuracy train: 1.000000 val: 0.657529 test: 0.647786
max validation accuracy : 0.657529 max acc epoch : 52 test accuracy : 0.647786
Counter({1: 4624, 0: 1510, 2: 1266})

Epoch :  53 loss training:  1.9192386397044174 Time :  8033
accuracy train: 0.998810 val: 0.650775 test: 0.647292
max validation accuracy : 0.657529 max acc epoch : 52 test accuracy : 0.647786
Counter({0: 4632, 2: 1503, 1: 1265})

Epoch :  54 loss training:  1.5827604305522982 Time :  8085
accuracy train: 1.000000 val: 0.649980 test: 0.653722
max validation accuracy : 0.657529 max acc epoch : 52 test accuracy : 0.647786
Counter({1: 4637, 0: 1498, 2: 1265})

Epoch :  55 loss training:  1.1670047676598188 Time :  8134
accuracy train: 1.000000 val: 0.651172 test: 0.654217
max validation accuracy : 0.657529 max acc epoch : 52 test accuracy : 0.647786
Counter({1: 4661, 2: 1479, 0: 1260})

Epoch :  56 loss training:  1.8186356708756648 Time :  8214
accuracy train: 1.000000 val: 0.642034 test: 0.648528
max validation accuracy : 0.657529 max acc epoch : 52 test accuracy : 0.647786
Counter({1: 4546, 2: 1533, 0: 1321})

Epoch :  57 loss training:  1.1344859202799853 Time :  8263
accuracy train: 1.000000 val: 0.648391 test: 0.643829
max validation accuracy : 0.657529 max acc epoch : 52 test accuracy : 0.647786
Counter({0: 4609, 1: 1505, 2: 1286})

Epoch :  58 loss training:  0.9684192491549766 Time :  8317
accuracy train: 1.000000 val: 0.653556 test: 0.649270
max validation accuracy : 0.657529 max acc epoch : 52 test accuracy : 0.647786
Counter({2: 4634, 0: 1506, 1: 1260})

Epoch :  59 loss training:  0.7591559625943773 Time :  8373
accuracy train: 1.000000 val: 0.644815 test: 0.648776
max validation accuracy : 0.657529 max acc epoch : 52 test accuracy : 0.647786
Counter({0: 4617, 2: 1516, 1: 1267})

Epoch :  60 loss training:  0.7889439855935052 Time :  8423
accuracy train: 1.000000 val: 0.649186 test: 0.645808
max validation accuracy : 0.657529 max acc epoch : 52 test accuracy : 0.647786
Counter({1: 4609, 2: 1524, 0: 1267})

Epoch :  61 loss training:  1.1839228127064416 Time :  8476
accuracy train: 1.000000 val: 0.658721 test: 0.655454
max validation accuracy : 0.658721 max acc epoch : 61 test accuracy : 0.655454
Counter({2: 4597, 0: 1534, 1: 1269})

Epoch :  62 loss training:  0.8737343610555399 Time :  8516
accuracy train: 1.000000 val: 0.649186 test: 0.653475
max validation accuracy : 0.658721 max acc epoch : 61 test accuracy : 0.655454
Counter({2: 4639, 0: 1487, 1: 1274})

Epoch :  63 loss training:  1.3406773479437106 Time :  8574
accuracy train: 1.000000 val: 0.650377 test: 0.650754
max validation accuracy : 0.658721 max acc epoch : 61 test accuracy : 0.655454
Counter({1: 4724, 0: 1449, 2: 1227})

Epoch :  64 loss training:  1.3943493116821628 Time :  8610
accuracy train: 1.000000 val: 0.645610 test: 0.646550
max validation accuracy : 0.658721 max acc epoch : 61 test accuracy : 0.655454
Counter({0: 4714, 2: 1422, 1: 1264})

Epoch :  65 loss training:  2.368786962615559 Time :  8656
accuracy train: 1.000000 val: 0.651967 test: 0.636903
max validation accuracy : 0.658721 max acc epoch : 61 test accuracy : 0.655454
Counter({1: 4683, 0: 1434, 2: 1283})

Epoch :  66 loss training:  0.6130847635613463 Time :  8710
accuracy train: 1.000000 val: 0.652364 test: 0.643581
max validation accuracy : 0.658721 max acc epoch : 61 test accuracy : 0.655454
Counter({0: 4672, 1: 1444, 2: 1284})

Epoch :  67 loss training:  0.7444960259017535 Time :  8772
accuracy train: 1.000000 val: 0.656734 test: 0.647292
max validation accuracy : 0.658721 max acc epoch : 61 test accuracy : 0.655454
Counter({1: 4657, 2: 1453, 0: 1290})

Epoch :  68 loss training:  1.6894005482809007 Time :  8821
accuracy train: 1.000000 val: 0.653953 test: 0.653475
max validation accuracy : 0.658721 max acc epoch : 61 test accuracy : 0.655454
Counter({1: 4619, 2: 1513, 0: 1268})

Epoch :  69 loss training:  0.81088007397193 Time :  8879
accuracy train: 1.000000 val: 0.661502 test: 0.658175
max validation accuracy : 0.661502 max acc epoch : 69 test accuracy : 0.658175
Counter({0: 4661, 2: 1495, 1: 1244})

Epoch :  70 loss training:  1.107440377556486 Time :  8935
accuracy train: 1.000000 val: 0.669050 test: 0.653475
max validation accuracy : 0.669050 max acc epoch : 70 test accuracy : 0.653475
Counter({1: 4726, 0: 1470, 2: 1204})

Epoch :  71 loss training:  0.597983840663801 Time :  8990
accuracy train: 1.000000 val: 0.663488 test: 0.653970
max validation accuracy : 0.669050 max acc epoch : 70 test accuracy : 0.653475
Counter({2: 4742, 1: 1460, 0: 1198})

Epoch :  72 loss training:  0.4138492780548404 Time :  9041
accuracy train: 1.000000 val: 0.667064 test: 0.654217
max validation accuracy : 0.669050 max acc epoch : 70 test accuracy : 0.653475
Counter({1: 4743, 0: 1448, 2: 1209})

Epoch :  73 loss training:  0.43575635189336026 Time :  9099
accuracy train: 1.000000 val: 0.653556 test: 0.648776
max validation accuracy : 0.669050 max acc epoch : 70 test accuracy : 0.653475
Counter({2: 4716, 1: 1462, 0: 1222})

Epoch :  74 loss training:  0.41570750829123426 Time :  9140
accuracy train: 1.000000 val: 0.651172 test: 0.651002
max validation accuracy : 0.669050 max acc epoch : 70 test accuracy : 0.653475
Counter({2: 4721, 1: 1460, 0: 1219})

Epoch :  75 loss training:  0.47620646670111455 Time :  9181
accuracy train: 1.000000 val: 0.658721 test: 0.649518
max validation accuracy : 0.669050 max acc epoch : 70 test accuracy : 0.653475
Counter({0: 4686, 1: 1461, 2: 1253})

Epoch :  76 loss training:  0.34854944984545 Time :  9242
accuracy train: 1.000000 val: 0.649186 test: 0.647786
max validation accuracy : 0.669050 max acc epoch : 70 test accuracy : 0.653475
Counter({1: 4673, 2: 1470, 0: 1257})

Epoch :  77 loss training:  0.698418564061285 Time :  9285
accuracy train: 1.000000 val: 0.653953 test: 0.646797
max validation accuracy : 0.669050 max acc epoch : 70 test accuracy : 0.653475
Counter({1: 4688, 0: 1463, 2: 1249})

Epoch :  78 loss training:  0.4181063980449835 Time :  9323
accuracy train: 1.000000 val: 0.653556 test: 0.648034
max validation accuracy : 0.669050 max acc epoch : 70 test accuracy : 0.653475
Counter({2: 4712, 0: 1446, 1: 1242})

Epoch :  79 loss training:  0.5084264564575278 Time :  9376
accuracy train: 1.000000 val: 0.651172 test: 0.646550
max validation accuracy : 0.669050 max acc epoch : 70 test accuracy : 0.653475
Counter({0: 4716, 2: 1447, 1: 1237})

Epoch :  80 loss training:  0.3253583726618672 Time :  9429
accuracy train: 1.000000 val: 0.658323 test: 0.652980
max validation accuracy : 0.669050 max acc epoch : 70 test accuracy : 0.653475
Counter({0: 4711, 1: 1434, 2: 1255})

Epoch :  81 loss training:  0.338876487534435 Time :  9486
accuracy train: 1.000000 val: 0.661502 test: 0.652733
max validation accuracy : 0.669050 max acc epoch : 70 test accuracy : 0.653475
Counter({0: 4716, 2: 1431, 1: 1253})

Epoch :  82 loss training:  0.26754831240759813 Time :  9539
accuracy train: 1.000000 val: 0.653953 test: 0.649270
max validation accuracy : 0.669050 max acc epoch : 70 test accuracy : 0.653475
Counter({0: 4720, 2: 1427, 1: 1253})

Epoch :  83 loss training:  0.3240437520580599 Time :  9591
accuracy train: 1.000000 val: 0.658323 test: 0.650507
max validation accuracy : 0.669050 max acc epoch : 70 test accuracy : 0.653475
Counter({1: 4706, 2: 1438, 0: 1256})

Epoch :  84 loss training:  0.2610589562127643 Time :  9635
accuracy train: 1.000000 val: 0.658323 test: 0.652486
max validation accuracy : 0.669050 max acc epoch : 70 test accuracy : 0.653475
Counter({2: 4772, 1: 1434, 0: 1194})

Epoch :  85 loss training:  0.5430270274009672 Time :  9686
accuracy train: 1.000000 val: 0.649186 test: 0.648776
max validation accuracy : 0.669050 max acc epoch : 70 test accuracy : 0.653475
Counter({1: 4751, 0: 1469, 2: 1180})

Epoch :  86 loss training:  1.3341185584504274 Time :  9720
accuracy train: 1.000000 val: 0.649186 test: 0.645808
max validation accuracy : 0.669050 max acc epoch : 70 test accuracy : 0.653475
Counter({1: 4725, 2: 1455, 0: 1220})

========================================================================================================================================================================================================
best acc epoch :  70
validation accuracy :  0.6690504568931267
test accuracy :  0.6534751422211229
last test_accuracy :  0.6458075686371506
second best val :  0.6670639650377433
second best test :  0.6534751422211229
max gap 16
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  52 	 val_accuracy : 0.66547 	 test_accuracy : 0.65224 	 last test_accuracy : 0.65471 	 second best val : 0.66468 	 second best test : 0.65224
k :  1 	 best_acc epoch :  70 	 val_accuracy : 0.66905 	 test_accuracy : 0.65348 	 last test_accuracy : 0.64581 	 second best val : 0.66706 	 second best test : 0.65348

avg :  	 val_accuracy : 0.66726 	 test_accuracy : 0.65286 	 last_accuracy : 0.65026 	 second best val : 0.66587 	 second best test : 0.65286

std :  	 val_accuracy : 0.00179 	 test_accuracy : 0.00062 	 last_accuracy : 0.00445 	 second best val : 0.00119 	 second best test : 0.00062


date and time :  Tue Jun 15 18:13:30 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=15, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=857, tsne=False, val_prop=0.95, weight_decay=0)
device :  cuda:0
Counter({2: 2596, 1: 2538, 0: 2266})

Epoch :  1 loss training:  305.4946620762348 Time :  48
accuracy train: 0.482143 val: 0.306993 test: 0.307692
max validation accuracy : 0.306993 max acc epoch : 1 test accuracy : 0.307692
Counter({0: 3503, 2: 2054, 1: 1843})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  190.68236231058836 Time :  107
accuracy train: 0.571429 val: 0.407965 test: 0.388326
max validation accuracy : 0.407965 max acc epoch : 2 test accuracy : 0.388326
Counter({0: 3337, 2: 2350, 1: 1713})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  153.13643192313612 Time :  140
accuracy train: 0.750000 val: 0.440891 test: 0.420975
max validation accuracy : 0.440891 max acc epoch : 3 test accuracy : 0.420975
Counter({0: 2954, 2: 2731, 1: 1715})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  88.44361707102507 Time :  180
accuracy train: 0.845238 val: 0.459705 test: 0.428889
max validation accuracy : 0.459705 max acc epoch : 4 test accuracy : 0.428889
Counter({1: 2966, 0: 2738, 2: 1696})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  63.977747491560876 Time :  213
accuracy train: 0.940476 val: 0.467231 test: 0.450655
max validation accuracy : 0.467231 max acc epoch : 5 test accuracy : 0.450655
Counter({1: 2934, 0: 2754, 2: 1712})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  45.760896372026764 Time :  246
accuracy train: 0.982143 val: 0.469113 test: 0.436557
max validation accuracy : 0.469113 max acc epoch : 6 test accuracy : 0.436557
Counter({0: 3083, 1: 2561, 2: 1756})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  29.936809849459678 Time :  274
accuracy train: 0.982143 val: 0.487927 test: 0.474648
max validation accuracy : 0.487927 max acc epoch : 7 test accuracy : 0.474648
Counter({1: 3034, 2: 2557, 0: 1809})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  20.755184814566746 Time :  318
accuracy train: 0.994048 val: 0.499843 test: 0.477616
max validation accuracy : 0.499843 max acc epoch : 8 test accuracy : 0.477616
Counter({2: 3050, 0: 2538, 1: 1812})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  14.558740757638589 Time :  352
accuracy train: 0.994048 val: 0.497335 test: 0.481573
max validation accuracy : 0.499843 max acc epoch : 8 test accuracy : 0.477616
Counter({2: 3029, 0: 2553, 1: 1818})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  14.202785987523384 Time :  381
accuracy train: 0.994048 val: 0.496707 test: 0.482068
max validation accuracy : 0.499843 max acc epoch : 8 test accuracy : 0.477616
Counter({0: 3009, 2: 2567, 1: 1824})

Epoch :  11 loss training:  11.910538126248866 Time :  413
accuracy train: 1.000000 val: 0.493258 test: 0.476626
max validation accuracy : 0.499843 max acc epoch : 8 test accuracy : 0.477616
Counter({0: 3021, 1: 2549, 2: 1830})

Epoch :  12 loss training:  10.182089620735496 Time :  447
accuracy train: 1.000000 val: 0.495140 test: 0.478358
max validation accuracy : 0.499843 max acc epoch : 8 test accuracy : 0.477616
Counter({0: 3023, 1: 2549, 2: 1828})

Epoch :  13 loss training:  9.717127236071974 Time :  492
accuracy train: 1.000000 val: 0.496707 test: 0.484789
max validation accuracy : 0.499843 max acc epoch : 8 test accuracy : 0.477616
Counter({0: 3041, 1: 2533, 2: 1826})

Epoch :  14 loss training:  9.164853269816376 Time :  534
accuracy train: 1.000000 val: 0.499216 test: 0.487757
max validation accuracy : 0.499843 max acc epoch : 8 test accuracy : 0.477616
Counter({0: 3075, 1: 2533, 2: 1792})

Epoch :  15 loss training:  6.621469975914806 Time :  568
accuracy train: 1.000000 val: 0.496080 test: 0.485531
max validation accuracy : 0.499843 max acc epoch : 8 test accuracy : 0.477616
Counter({2: 3105, 1: 2517, 0: 1778})

Epoch :  16 loss training:  6.1591338553407695 Time :  605
accuracy train: 1.000000 val: 0.497021 test: 0.484789
max validation accuracy : 0.499843 max acc epoch : 8 test accuracy : 0.477616
Counter({1: 3109, 2: 2511, 0: 1780})

Epoch :  17 loss training:  5.331856202465133 Time :  645
accuracy train: 1.000000 val: 0.494826 test: 0.484541
max validation accuracy : 0.499843 max acc epoch : 8 test accuracy : 0.477616
Counter({2: 3111, 0: 2510, 1: 1779})

Epoch :  18 loss training:  5.387670386233367 Time :  683
accuracy train: 1.000000 val: 0.495140 test: 0.486767
max validation accuracy : 0.499843 max acc epoch : 8 test accuracy : 0.477616
Counter({2: 3104, 0: 2499, 1: 1797})

Epoch :  19 loss training:  4.07634538464481 Time :  715
accuracy train: 1.000000 val: 0.493258 test: 0.483799
max validation accuracy : 0.499843 max acc epoch : 8 test accuracy : 0.477616
Counter({2: 3090, 0: 2521, 1: 1789})

Epoch :  20 loss training:  3.853696365171345 Time :  746
accuracy train: 1.000000 val: 0.491377 test: 0.481573
max validation accuracy : 0.499843 max acc epoch : 8 test accuracy : 0.477616
Counter({1: 3089, 2: 2522, 0: 1789})

Epoch :  21 loss training:  3.8134409381309524 Time :  772
accuracy train: 1.000000 val: 0.492944 test: 0.487262
max validation accuracy : 0.499843 max acc epoch : 8 test accuracy : 0.477616
Counter({0: 3084, 1: 2526, 2: 1790})

Epoch :  22 loss training:  2.3822911542956717 Time :  810
accuracy train: 1.000000 val: 0.500470 test: 0.488746
max validation accuracy : 0.500470 max acc epoch : 22 test accuracy : 0.488746
Counter({0: 3090, 1: 2527, 2: 1783})

Epoch :  23 loss training:  3.790675654890947 Time :  836
accuracy train: 1.000000 val: 0.497021 test: 0.484789
max validation accuracy : 0.500470 max acc epoch : 22 test accuracy : 0.488746
Counter({0: 3078, 1: 2547, 2: 1775})

Epoch :  24 loss training:  2.2552790090849157 Time :  861
accuracy train: 1.000000 val: 0.500470 test: 0.487262
max validation accuracy : 0.500470 max acc epoch : 22 test accuracy : 0.488746
Counter({1: 3077, 2: 2553, 0: 1770})

Epoch :  25 loss training:  2.162464982859092 Time :  888
accuracy train: 1.000000 val: 0.500470 test: 0.492456
max validation accuracy : 0.500470 max acc epoch : 22 test accuracy : 0.488746
Counter({2: 3071, 0: 2551, 1: 1778})

Epoch :  26 loss training:  1.7379460495430976 Time :  917
accuracy train: 1.000000 val: 0.502352 test: 0.494682
max validation accuracy : 0.502352 max acc epoch : 26 test accuracy : 0.494682
Counter({0: 3077, 2: 2551, 1: 1772})

Epoch :  27 loss training:  2.6784294579993 Time :  947
accuracy train: 1.000000 val: 0.499216 test: 0.488993
max validation accuracy : 0.502352 max acc epoch : 26 test accuracy : 0.494682
Counter({1: 3062, 2: 2552, 0: 1786})

Epoch :  28 loss training:  1.6763676816772204 Time :  972
accuracy train: 1.000000 val: 0.499530 test: 0.485531
max validation accuracy : 0.502352 max acc epoch : 26 test accuracy : 0.494682
Counter({0: 3072, 1: 2544, 2: 1784})

Epoch :  29 loss training:  1.5065737079421524 Time :  993
accuracy train: 1.000000 val: 0.500157 test: 0.491961
max validation accuracy : 0.502352 max acc epoch : 26 test accuracy : 0.494682
Counter({0: 3081, 1: 2540, 2: 1779})

Epoch :  30 loss training:  1.480157564743422 Time :  1019
accuracy train: 1.000000 val: 0.502038 test: 0.493940
max validation accuracy : 0.502352 max acc epoch : 26 test accuracy : 0.494682
Counter({1: 3088, 2: 2531, 0: 1781})

Epoch :  31 loss training:  1.6313487021252513 Time :  1049
accuracy train: 1.000000 val: 0.498275 test: 0.490477
max validation accuracy : 0.502352 max acc epoch : 26 test accuracy : 0.494682
Counter({1: 3092, 2: 2523, 0: 1785})

Epoch :  32 loss training:  1.8548946071241517 Time :  1082
accuracy train: 1.000000 val: 0.498589 test: 0.489488
max validation accuracy : 0.502352 max acc epoch : 26 test accuracy : 0.494682
Counter({2: 3100, 1: 2516, 0: 1784})

Epoch :  33 loss training:  1.434482618504262 Time :  1117
accuracy train: 1.000000 val: 0.500157 test: 0.494435
max validation accuracy : 0.502352 max acc epoch : 26 test accuracy : 0.494682
Counter({2: 3095, 1: 2520, 0: 1785})

Epoch :  34 loss training:  2.9086230153625365 Time :  1145
accuracy train: 1.000000 val: 0.483537 test: 0.467227
max validation accuracy : 0.502352 max acc epoch : 26 test accuracy : 0.494682
Counter({0: 3103, 2: 2500, 1: 1797})

Epoch :  35 loss training:  1.2911164768156596 Time :  1173
accuracy train: 1.000000 val: 0.500470 test: 0.481326
max validation accuracy : 0.502352 max acc epoch : 26 test accuracy : 0.494682
Counter({0: 3090, 1: 2520, 2: 1790})

Epoch :  36 loss training:  0.8986410880643234 Time :  1209
accuracy train: 1.000000 val: 0.497335 test: 0.485036
max validation accuracy : 0.502352 max acc epoch : 26 test accuracy : 0.494682
Counter({0: 3094, 2: 2514, 1: 1792})

Epoch :  37 loss training:  0.8945967425679555 Time :  1238
accuracy train: 1.000000 val: 0.498589 test: 0.487509
max validation accuracy : 0.502352 max acc epoch : 26 test accuracy : 0.494682
Counter({0: 3103, 1: 2508, 2: 1789})

Epoch :  38 loss training:  0.7951349321738235 Time :  1262
accuracy train: 1.000000 val: 0.498589 test: 0.487262
max validation accuracy : 0.502352 max acc epoch : 26 test accuracy : 0.494682
Counter({1: 3099, 2: 2515, 0: 1786})

Epoch :  39 loss training:  0.7886796549282735 Time :  1297
accuracy train: 1.000000 val: 0.498902 test: 0.489735
max validation accuracy : 0.502352 max acc epoch : 26 test accuracy : 0.494682
Counter({2: 3101, 0: 2512, 1: 1787})

Epoch :  40 loss training:  0.8099652097953367 Time :  1324
accuracy train: 1.000000 val: 0.499843 test: 0.492703
max validation accuracy : 0.502352 max acc epoch : 26 test accuracy : 0.494682
Counter({1: 3097, 0: 2524, 2: 1779})

Epoch :  41 loss training:  0.705692635034211 Time :  1351
accuracy train: 1.000000 val: 0.502665 test: 0.489488
max validation accuracy : 0.502665 max acc epoch : 41 test accuracy : 0.489488
Counter({2: 3099, 1: 2524, 0: 1777})

Epoch :  42 loss training:  0.5916682200695504 Time :  1379
accuracy train: 1.000000 val: 0.501411 test: 0.489735
max validation accuracy : 0.502665 max acc epoch : 41 test accuracy : 0.489488
Counter({0: 3107, 1: 2515, 2: 1778})

Epoch :  43 loss training:  0.5252004315261729 Time :  1409
accuracy train: 1.000000 val: 0.501411 test: 0.493940
max validation accuracy : 0.502665 max acc epoch : 41 test accuracy : 0.489488
Counter({0: 3110, 2: 2511, 1: 1779})

Epoch :  44 loss training:  0.5703945745954115 Time :  1441
accuracy train: 1.000000 val: 0.502979 test: 0.494187
max validation accuracy : 0.502979 max acc epoch : 44 test accuracy : 0.494187
Counter({0: 3117, 1: 2503, 2: 1780})

Epoch :  45 loss training:  0.6434901025641011 Time :  1466
accuracy train: 1.000000 val: 0.503920 test: 0.496661
max validation accuracy : 0.503920 max acc epoch : 45 test accuracy : 0.496661
Counter({1: 3127, 2: 2485, 0: 1788})

Epoch :  46 loss training:  0.5358081589984067 Time :  1501
accuracy train: 1.000000 val: 0.502979 test: 0.492951
max validation accuracy : 0.503920 max acc epoch : 45 test accuracy : 0.496661
Counter({1: 3120, 0: 2489, 2: 1791})

Epoch :  47 loss training:  0.3451925566623686 Time :  1530
accuracy train: 1.000000 val: 0.503293 test: 0.491467
max validation accuracy : 0.503920 max acc epoch : 45 test accuracy : 0.496661
Counter({2: 3130, 1: 2485, 0: 1785})

Epoch :  48 loss training:  0.4374580497969873 Time :  1555
accuracy train: 1.000000 val: 0.506115 test: 0.494435
max validation accuracy : 0.506115 max acc epoch : 48 test accuracy : 0.494435
Counter({0: 3118, 1: 2492, 2: 1790})

Epoch :  49 loss training:  0.5922305868007243 Time :  1588
accuracy train: 1.000000 val: 0.501411 test: 0.493445
max validation accuracy : 0.506115 max acc epoch : 48 test accuracy : 0.494435
Counter({0: 3124, 2: 2488, 1: 1788})

Epoch :  50 loss training:  0.41910872627340723 Time :  1617
accuracy train: 1.000000 val: 0.500470 test: 0.486273
max validation accuracy : 0.506115 max acc epoch : 48 test accuracy : 0.494435
Counter({1: 3141, 0: 2484, 2: 1775})

Epoch :  51 loss training:  0.24449123073281953 Time :  1650
accuracy train: 1.000000 val: 0.500784 test: 0.490230
max validation accuracy : 0.506115 max acc epoch : 48 test accuracy : 0.494435
Counter({2: 3140, 0: 2490, 1: 1770})

Epoch :  52 loss training:  0.32291242650535423 Time :  1681
accuracy train: 1.000000 val: 0.502352 test: 0.491714
max validation accuracy : 0.506115 max acc epoch : 48 test accuracy : 0.494435
Counter({2: 3143, 1: 2489, 0: 1768})

Epoch :  53 loss training:  0.29748933027440216 Time :  1716
accuracy train: 1.000000 val: 0.502979 test: 0.492951
max validation accuracy : 0.506115 max acc epoch : 48 test accuracy : 0.494435
Counter({1: 3148, 2: 2488, 0: 1764})

Epoch :  54 loss training:  0.3035719000035897 Time :  1764
accuracy train: 1.000000 val: 0.502979 test: 0.495672
max validation accuracy : 0.506115 max acc epoch : 48 test accuracy : 0.494435
Counter({0: 3152, 1: 2484, 2: 1764})

Epoch :  55 loss training:  0.3048327496071579 Time :  1807
accuracy train: 1.000000 val: 0.498275 test: 0.489983
max validation accuracy : 0.506115 max acc epoch : 48 test accuracy : 0.494435
Counter({0: 3127, 1: 2509, 2: 1764})

Epoch :  56 loss training:  0.38456928105733823 Time :  1861
accuracy train: 1.000000 val: 0.502352 test: 0.493693
max validation accuracy : 0.506115 max acc epoch : 48 test accuracy : 0.494435
Counter({0: 3134, 2: 2497, 1: 1769})

Epoch :  57 loss training:  0.30796445631131064 Time :  1902
accuracy train: 1.000000 val: 0.502665 test: 0.494187
max validation accuracy : 0.506115 max acc epoch : 48 test accuracy : 0.494435
Counter({2: 3125, 0: 2499, 1: 1776})

Epoch :  58 loss training:  0.271891174823395 Time :  1945
accuracy train: 1.000000 val: 0.505801 test: 0.493198
max validation accuracy : 0.506115 max acc epoch : 48 test accuracy : 0.494435
Counter({1: 3106, 0: 2502, 2: 1792})

Epoch :  59 loss training:  0.6364609123047558 Time :  1987
accuracy train: 1.000000 val: 0.496080 test: 0.488004
max validation accuracy : 0.506115 max acc epoch : 48 test accuracy : 0.494435
Counter({1: 2958, 0: 2524, 2: 1918})

Epoch :  60 loss training:  0.2512673593155341 Time :  2026
accuracy train: 1.000000 val: 0.502665 test: 0.495424
max validation accuracy : 0.506115 max acc epoch : 48 test accuracy : 0.494435
Counter({0: 2976, 2: 2514, 1: 1910})

Epoch :  61 loss training:  0.19948931390899816 Time :  2076
accuracy train: 1.000000 val: 0.500470 test: 0.493940
max validation accuracy : 0.506115 max acc epoch : 48 test accuracy : 0.494435
Counter({2: 2980, 0: 2510, 1: 1910})

Epoch :  62 loss training:  0.167666244047723 Time :  2124
accuracy train: 1.000000 val: 0.503606 test: 0.495177
max validation accuracy : 0.506115 max acc epoch : 48 test accuracy : 0.494435
Counter({0: 2982, 1: 2508, 2: 1910})

Epoch :  63 loss training:  0.25722530890561757 Time :  2167
accuracy train: 1.000000 val: 0.507996 test: 0.492951
max validation accuracy : 0.507996 max acc epoch : 63 test accuracy : 0.492951
Counter({2: 2994, 1: 2506, 0: 1900})

Epoch :  64 loss training:  0.15419630138057983 Time :  2204
accuracy train: 1.000000 val: 0.507056 test: 0.494435
max validation accuracy : 0.507996 max acc epoch : 63 test accuracy : 0.492951
Counter({2: 3013, 1: 2496, 0: 1891})

Epoch :  65 loss training:  0.2309894631162024 Time :  2254
accuracy train: 1.000000 val: 0.510191 test: 0.496166
max validation accuracy : 0.510191 max acc epoch : 65 test accuracy : 0.496166
Counter({1: 3027, 0: 2492, 2: 1881})

Epoch :  66 loss training:  0.19255602011617157 Time :  2309
accuracy train: 1.000000 val: 0.509251 test: 0.497898
max validation accuracy : 0.510191 max acc epoch : 65 test accuracy : 0.496166
Counter({2: 3022, 1: 2501, 0: 1877})

Epoch :  67 loss training:  0.15871974859328475 Time :  2345
accuracy train: 1.000000 val: 0.508623 test: 0.498392
max validation accuracy : 0.510191 max acc epoch : 65 test accuracy : 0.496166
Counter({0: 3044, 2: 2491, 1: 1865})

Epoch :  68 loss training:  0.1052830144908512 Time :  2396
accuracy train: 1.000000 val: 0.508623 test: 0.499134
max validation accuracy : 0.510191 max acc epoch : 65 test accuracy : 0.496166
Counter({2: 3071, 0: 2480, 1: 1849})

Epoch :  69 loss training:  0.16344154952821555 Time :  2442
accuracy train: 1.000000 val: 0.505801 test: 0.493198
max validation accuracy : 0.510191 max acc epoch : 65 test accuracy : 0.496166
Counter({0: 3061, 1: 2483, 2: 1856})

Epoch :  70 loss training:  0.104367478255881 Time :  2468
accuracy train: 1.000000 val: 0.504233 test: 0.497898
max validation accuracy : 0.510191 max acc epoch : 65 test accuracy : 0.496166
Counter({2: 3071, 1: 2473, 0: 1856})

Epoch :  71 loss training:  0.10301521005567338 Time :  2512
accuracy train: 1.000000 val: 0.507056 test: 0.502844
max validation accuracy : 0.510191 max acc epoch : 65 test accuracy : 0.496166
Counter({0: 3089, 2: 2468, 1: 1843})

Epoch :  72 loss training:  0.10795346300801612 Time :  2557
accuracy train: 1.000000 val: 0.508937 test: 0.500124
max validation accuracy : 0.510191 max acc epoch : 65 test accuracy : 0.496166
Counter({2: 3088, 1: 2469, 0: 1843})

Epoch :  73 loss training:  0.11660312044477905 Time :  2589
accuracy train: 1.000000 val: 0.506428 test: 0.500371
max validation accuracy : 0.510191 max acc epoch : 65 test accuracy : 0.496166
Counter({0: 3083, 2: 2466, 1: 1851})

Epoch :  74 loss training:  0.11866845185795682 Time :  2636
accuracy train: 1.000000 val: 0.502038 test: 0.495424
max validation accuracy : 0.510191 max acc epoch : 65 test accuracy : 0.496166
Counter({2: 3076, 0: 2475, 1: 1849})

Epoch :  75 loss training:  0.10452379986236338 Time :  2689
accuracy train: 1.000000 val: 0.505174 test: 0.499382
max validation accuracy : 0.510191 max acc epoch : 65 test accuracy : 0.496166
Counter({0: 3079, 2: 2481, 1: 1840})

Epoch :  76 loss training:  0.1530084011683357 Time :  2729
accuracy train: 1.000000 val: 0.505488 test: 0.496414
max validation accuracy : 0.510191 max acc epoch : 65 test accuracy : 0.496166
Counter({1: 3099, 0: 2472, 2: 1829})

Epoch :  77 loss training:  0.11500931514819968 Time :  2780
accuracy train: 1.000000 val: 0.509878 test: 0.495672
max validation accuracy : 0.510191 max acc epoch : 65 test accuracy : 0.496166
Counter({0: 3114, 1: 2477, 2: 1809})

Epoch :  78 loss training:  0.09984849560350995 Time :  2823
accuracy train: 1.000000 val: 0.506742 test: 0.497156
max validation accuracy : 0.510191 max acc epoch : 65 test accuracy : 0.496166
Counter({1: 3113, 0: 2474, 2: 1813})

Epoch :  79 loss training:  0.0771097693414049 Time :  2868
accuracy train: 1.000000 val: 0.508623 test: 0.498392
max validation accuracy : 0.510191 max acc epoch : 65 test accuracy : 0.496166
Counter({0: 3126, 2: 2476, 1: 1798})

Epoch :  80 loss training:  0.06101297492477897 Time :  2921
accuracy train: 1.000000 val: 0.508623 test: 0.498392
max validation accuracy : 0.510191 max acc epoch : 65 test accuracy : 0.496166
Counter({0: 3128, 2: 2473, 1: 1799})

Epoch :  81 loss training:  0.08736986118492496 Time :  2971
accuracy train: 1.000000 val: 0.509564 test: 0.495672
max validation accuracy : 0.510191 max acc epoch : 65 test accuracy : 0.496166
Counter({0: 3140, 2: 2460, 1: 1800})

========================================================================================================================================================================================================
best acc epoch :  65
validation accuracy :  0.5101912825337096
test accuracy :  0.49616621320801385
last test_accuracy :  0.49567153104130596
second best val :  0.5098777046095955
second best test :  0.49616621320801385
max gap 15
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=15, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=923, tsne=False, val_prop=0.95, weight_decay=0)
device :  cuda:0
Counter({2: 2604, 0: 2534, 1: 2262})

Epoch :  1 loss training:  318.6943396925926 Time :  3039
accuracy train: 0.410714 val: 0.335215 test: 0.322780
max validation accuracy : 0.335215 max acc epoch : 1 test accuracy : 0.322780
Counter({1: 2984, 2: 2235, 0: 2181})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  199.28505294956267 Time :  3106
accuracy train: 0.553571 val: 0.392600 test: 0.382637
max validation accuracy : 0.392600 max acc epoch : 2 test accuracy : 0.382637
Counter({1: 3330, 0: 2255, 2: 1815})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  184.76570687629282 Time :  3192
accuracy train: 0.672619 val: 0.418940 test: 0.405145
max validation accuracy : 0.418940 max acc epoch : 3 test accuracy : 0.405145
Counter({0: 3082, 1: 2530, 2: 1788})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  88.70659702271223 Time :  3267
accuracy train: 0.851190 val: 0.462841 test: 0.468959
max validation accuracy : 0.462841 max acc epoch : 4 test accuracy : 0.468959
Counter({0: 3546, 1: 2115, 2: 1739})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  63.549047655425966 Time :  3336
accuracy train: 0.934524 val: 0.483851 test: 0.485036
max validation accuracy : 0.483851 max acc epoch : 5 test accuracy : 0.485036
Counter({0: 3453, 1: 2210, 2: 1737})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  40.52504536882043 Time :  3408
accuracy train: 0.940476 val: 0.476638 test: 0.474895
max validation accuracy : 0.483851 max acc epoch : 5 test accuracy : 0.485036
Counter({2: 3143, 0: 2492, 1: 1765})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  31.644282016903162 Time :  3487
accuracy train: 0.988095 val: 0.510191 test: 0.500371
max validation accuracy : 0.510191 max acc epoch : 7 test accuracy : 0.500371
Counter({0: 3112, 2: 2552, 1: 1736})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  20.93549881945364 Time :  3556
accuracy train: 0.988095 val: 0.503920 test: 0.495672
max validation accuracy : 0.510191 max acc epoch : 7 test accuracy : 0.500371
Counter({2: 3114, 1: 2553, 0: 1733})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  19.079531299183145 Time :  3628
accuracy train: 0.994048 val: 0.499843 test: 0.501855
max validation accuracy : 0.510191 max acc epoch : 7 test accuracy : 0.500371
Counter({0: 3074, 1: 2620, 2: 1706})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  15.036297875456512 Time :  3695
accuracy train: 1.000000 val: 0.507996 test: 0.502102
max validation accuracy : 0.510191 max acc epoch : 7 test accuracy : 0.500371
Counter({2: 3052, 1: 2643, 0: 1705})

Epoch :  11 loss training:  11.737734254682437 Time :  3769
accuracy train: 1.000000 val: 0.510818 test: 0.503092
max validation accuracy : 0.510818 max acc epoch : 11 test accuracy : 0.503092
Counter({2: 3030, 1: 2670, 0: 1700})

Epoch :  12 loss training:  12.962708726059645 Time :  3826
accuracy train: 1.000000 val: 0.511132 test: 0.507791
max validation accuracy : 0.511132 max acc epoch : 12 test accuracy : 0.507791
Counter({1: 2895, 2: 2802, 0: 1703})

Epoch :  13 loss training:  7.466042029147502 Time :  3880
accuracy train: 1.000000 val: 0.515209 test: 0.509028
max validation accuracy : 0.515209 max acc epoch : 13 test accuracy : 0.509028
Counter({1: 2910, 2: 2787, 0: 1703})

Epoch :  14 loss training:  8.644555028760806 Time :  3944
accuracy train: 1.000000 val: 0.513327 test: 0.505318
max validation accuracy : 0.515209 max acc epoch : 13 test accuracy : 0.509028
Counter({2: 2857, 1: 2851, 0: 1692})

Epoch :  15 loss training:  6.9705525729223154 Time :  4030
accuracy train: 1.000000 val: 0.514581 test: 0.511749
max validation accuracy : 0.515209 max acc epoch : 13 test accuracy : 0.509028
Counter({0: 2872, 2: 2846, 1: 1682})

Epoch :  16 loss training:  7.828962231287733 Time :  4110
accuracy train: 1.000000 val: 0.518971 test: 0.517932
max validation accuracy : 0.518971 max acc epoch : 16 test accuracy : 0.517932
Counter({2: 2871, 1: 2869, 0: 1660})

Epoch :  17 loss training:  5.702535545453429 Time :  4193
accuracy train: 1.000000 val: 0.513327 test: 0.512243
max validation accuracy : 0.518971 max acc epoch : 16 test accuracy : 0.517932
Counter({2: 2872, 1: 2867, 0: 1661})

Epoch :  18 loss training:  6.106244667200372 Time :  4270
accuracy train: 1.000000 val: 0.514268 test: 0.514222
max validation accuracy : 0.518971 max acc epoch : 16 test accuracy : 0.517932
Counter({2: 2877, 1: 2860, 0: 1663})

Epoch :  19 loss training:  5.290401217178442 Time :  4349
accuracy train: 1.000000 val: 0.513954 test: 0.515459
max validation accuracy : 0.518971 max acc epoch : 16 test accuracy : 0.517932
Counter({2: 2897, 0: 2847, 1: 1656})

Epoch :  20 loss training:  3.6404640931577887 Time :  4440
accuracy train: 1.000000 val: 0.519285 test: 0.519416
max validation accuracy : 0.519285 max acc epoch : 20 test accuracy : 0.519416
Counter({1: 2888, 2: 2860, 0: 1652})

Epoch :  21 loss training:  4.350774505641311 Time :  4520
accuracy train: 1.000000 val: 0.514895 test: 0.517190
max validation accuracy : 0.519285 max acc epoch : 20 test accuracy : 0.519416
Counter({2: 2918, 0: 2830, 1: 1652})

Epoch :  22 loss training:  3.489285593444947 Time :  4594
accuracy train: 1.000000 val: 0.519285 test: 0.517438
max validation accuracy : 0.519285 max acc epoch : 20 test accuracy : 0.519416
Counter({0: 2931, 2: 2821, 1: 1648})

Epoch :  23 loss training:  3.1673425105400383 Time :  4648
accuracy train: 1.000000 val: 0.522107 test: 0.521148
max validation accuracy : 0.522107 max acc epoch : 23 test accuracy : 0.521148
Counter({1: 2950, 2: 2806, 0: 1644})

Epoch :  24 loss training:  2.186360167397652 Time :  4724
accuracy train: 1.000000 val: 0.522107 test: 0.523126
max validation accuracy : 0.522107 max acc epoch : 23 test accuracy : 0.521148
Counter({1: 2928, 0: 2836, 2: 1636})

Epoch :  25 loss training:  2.6716570995631628 Time :  4778
accuracy train: 1.000000 val: 0.518971 test: 0.520158
max validation accuracy : 0.522107 max acc epoch : 23 test accuracy : 0.521148
Counter({2: 2950, 1: 2811, 0: 1639})

Epoch :  26 loss training:  3.8263957700692117 Time :  4850
accuracy train: 1.000000 val: 0.521167 test: 0.521890
max validation accuracy : 0.522107 max acc epoch : 23 test accuracy : 0.521148
Counter({0: 2973, 1: 2837, 2: 1590})

Epoch :  27 loss training:  2.807983541628346 Time :  4921
accuracy train: 1.000000 val: 0.520539 test: 0.525105
max validation accuracy : 0.522107 max acc epoch : 23 test accuracy : 0.521148
Counter({0: 2981, 1: 2826, 2: 1593})

Epoch :  28 loss training:  2.4833436534390785 Time :  4986
accuracy train: 1.000000 val: 0.518031 test: 0.521395
max validation accuracy : 0.522107 max acc epoch : 23 test accuracy : 0.521148
Counter({1: 2980, 2: 2835, 0: 1585})

Epoch :  29 loss training:  1.746597163961269 Time :  5051
accuracy train: 1.000000 val: 0.519912 test: 0.524610
max validation accuracy : 0.522107 max acc epoch : 23 test accuracy : 0.521148
Counter({2: 2985, 1: 2823, 0: 1592})

Epoch :  30 loss training:  1.6866457029245794 Time :  5108
accuracy train: 1.000000 val: 0.522107 test: 0.525352
max validation accuracy : 0.522107 max acc epoch : 23 test accuracy : 0.521148
Counter({2: 2982, 0: 2826, 1: 1592})

Epoch :  31 loss training:  2.221789794624783 Time :  5155
accuracy train: 1.000000 val: 0.522107 test: 0.521148
max validation accuracy : 0.522107 max acc epoch : 23 test accuracy : 0.521148
Counter({1: 3027, 0: 2772, 2: 1601})

Epoch :  32 loss training:  1.655039604724152 Time :  5228
accuracy train: 1.000000 val: 0.521794 test: 0.523868
max validation accuracy : 0.522107 max acc epoch : 23 test accuracy : 0.521148
Counter({2: 3049, 0: 2754, 1: 1597})

Epoch :  33 loss training:  1.2763759149675025 Time :  5277
accuracy train: 1.000000 val: 0.522421 test: 0.525847
max validation accuracy : 0.522421 max acc epoch : 33 test accuracy : 0.525847
Counter({0: 3043, 1: 2759, 2: 1598})

Epoch :  34 loss training:  1.45989072813245 Time :  5351
accuracy train: 1.000000 val: 0.522734 test: 0.523868
max validation accuracy : 0.522734 max acc epoch : 34 test accuracy : 0.523868
Counter({2: 3011, 1: 2799, 0: 1590})

Epoch :  35 loss training:  1.1453791341627948 Time :  5397
accuracy train: 1.000000 val: 0.525870 test: 0.526342
max validation accuracy : 0.525870 max acc epoch : 35 test accuracy : 0.526342
Counter({2: 3016, 1: 2795, 0: 1589})

Epoch :  36 loss training:  1.0633404709587921 Time :  5469
accuracy train: 1.000000 val: 0.526497 test: 0.526589
max validation accuracy : 0.526497 max acc epoch : 36 test accuracy : 0.526589
Counter({0: 3035, 2: 2777, 1: 1588})

Epoch :  37 loss training:  1.234742823864508 Time :  5531
accuracy train: 1.000000 val: 0.527438 test: 0.530299
max validation accuracy : 0.527438 max acc epoch : 37 test accuracy : 0.530299
Counter({2: 3023, 0: 2784, 1: 1593})

Epoch :  38 loss training:  1.0968073192052543 Time :  5584
accuracy train: 1.000000 val: 0.529006 test: 0.531783
max validation accuracy : 0.529006 max acc epoch : 38 test accuracy : 0.531783
Counter({0: 3059, 2: 2751, 1: 1590})

Epoch :  39 loss training:  1.2889348608878208 Time :  5654
accuracy train: 1.000000 val: 0.523989 test: 0.521890
max validation accuracy : 0.529006 max acc epoch : 38 test accuracy : 0.531783
Counter({1: 2981, 0: 2831, 2: 1588})

Epoch :  40 loss training:  1.0092987812822685 Time :  5728
accuracy train: 1.000000 val: 0.522734 test: 0.525847
max validation accuracy : 0.529006 max acc epoch : 38 test accuracy : 0.531783
Counter({1: 2985, 0: 2835, 2: 1580})

Epoch :  41 loss training:  0.8717265436280286 Time :  5798
accuracy train: 1.000000 val: 0.519285 test: 0.518427
max validation accuracy : 0.529006 max acc epoch : 38 test accuracy : 0.531783
Counter({2: 3014, 0: 2805, 1: 1581})

Epoch :  42 loss training:  0.7388561436673626 Time :  5858
accuracy train: 1.000000 val: 0.522107 test: 0.522879
max validation accuracy : 0.529006 max acc epoch : 38 test accuracy : 0.531783
Counter({2: 3023, 0: 2800, 1: 1577})

Epoch :  43 loss training:  0.5357096421503229 Time :  5919
accuracy train: 1.000000 val: 0.523989 test: 0.522632
max validation accuracy : 0.529006 max acc epoch : 38 test accuracy : 0.531783
Counter({0: 3026, 2: 2797, 1: 1577})

Epoch :  44 loss training:  0.6843424252001569 Time :  5970
accuracy train: 1.000000 val: 0.521167 test: 0.521890
max validation accuracy : 0.529006 max acc epoch : 38 test accuracy : 0.531783
Counter({2: 3047, 0: 2776, 1: 1577})

Epoch :  45 loss training:  0.6900546550023137 Time :  6030
accuracy train: 1.000000 val: 0.523675 test: 0.522137
max validation accuracy : 0.529006 max acc epoch : 38 test accuracy : 0.531783
Counter({2: 3042, 0: 2782, 1: 1576})

Epoch :  46 loss training:  0.9382945055840537 Time :  6078
accuracy train: 1.000000 val: 0.526184 test: 0.519664
max validation accuracy : 0.529006 max acc epoch : 38 test accuracy : 0.531783
Counter({0: 3066, 2: 2763, 1: 1571})

Epoch :  47 loss training:  0.531871901883278 Time :  6162
accuracy train: 1.000000 val: 0.526184 test: 0.516943
max validation accuracy : 0.529006 max acc epoch : 38 test accuracy : 0.531783
Counter({2: 3072, 0: 2758, 1: 1570})

Epoch :  48 loss training:  0.49335396769311046 Time :  6239
accuracy train: 1.000000 val: 0.529320 test: 0.521890
max validation accuracy : 0.529320 max acc epoch : 48 test accuracy : 0.521890
Counter({2: 3066, 0: 2767, 1: 1567})

Epoch :  49 loss training:  0.6293783760338556 Time :  6310
accuracy train: 1.000000 val: 0.523362 test: 0.516943
max validation accuracy : 0.529320 max acc epoch : 48 test accuracy : 0.521890
Counter({0: 3075, 2: 2764, 1: 1561})

Epoch :  50 loss training:  0.4214634252421092 Time :  6377
accuracy train: 1.000000 val: 0.523675 test: 0.515953
max validation accuracy : 0.529320 max acc epoch : 48 test accuracy : 0.521890
Counter({0: 3079, 1: 2761, 2: 1560})

Epoch :  51 loss training:  0.4674234761041589 Time :  6422
accuracy train: 1.000000 val: 0.524302 test: 0.516201
max validation accuracy : 0.529320 max acc epoch : 48 test accuracy : 0.521890
Counter({2: 3083, 0: 2756, 1: 1561})

Epoch :  52 loss training:  0.36563637999643106 Time :  6486
accuracy train: 1.000000 val: 0.524929 test: 0.519911
max validation accuracy : 0.529320 max acc epoch : 48 test accuracy : 0.521890
Counter({2: 3084, 0: 2755, 1: 1561})

Epoch :  53 loss training:  0.34251278495867155 Time :  6554
accuracy train: 1.000000 val: 0.525870 test: 0.523374
max validation accuracy : 0.529320 max acc epoch : 48 test accuracy : 0.521890
Counter({0: 3071, 1: 2764, 2: 1565})

Epoch :  54 loss training:  0.30904910077515524 Time :  6610
accuracy train: 1.000000 val: 0.526497 test: 0.525352
max validation accuracy : 0.529320 max acc epoch : 48 test accuracy : 0.521890
Counter({1: 3073, 2: 2761, 0: 1566})

Epoch :  55 loss training:  0.2875316349527566 Time :  6685
accuracy train: 1.000000 val: 0.528692 test: 0.524610
max validation accuracy : 0.529320 max acc epoch : 48 test accuracy : 0.521890
Counter({0: 3070, 2: 2764, 1: 1566})

Epoch :  56 loss training:  0.2434488130165846 Time :  6743
accuracy train: 1.000000 val: 0.528065 test: 0.522879
max validation accuracy : 0.529320 max acc epoch : 48 test accuracy : 0.521890
Counter({0: 3088, 2: 2745, 1: 1567})

Epoch :  57 loss training:  0.3378696291056258 Time :  6830
accuracy train: 1.000000 val: 0.529006 test: 0.521642
max validation accuracy : 0.529320 max acc epoch : 48 test accuracy : 0.521890
Counter({1: 3076, 0: 2762, 2: 1562})

Epoch :  58 loss training:  0.31309735219110735 Time :  6911
accuracy train: 1.000000 val: 0.531201 test: 0.526094
max validation accuracy : 0.531201 max acc epoch : 58 test accuracy : 0.526094
Counter({1: 3088, 0: 2751, 2: 1561})

Epoch :  59 loss training:  0.2157767422904726 Time :  6963
accuracy train: 1.000000 val: 0.530887 test: 0.527084
max validation accuracy : 0.531201 max acc epoch : 58 test accuracy : 0.526094
Counter({2: 3090, 1: 2748, 0: 1562})

Epoch :  60 loss training:  0.23128812124195974 Time :  7025
accuracy train: 1.000000 val: 0.532455 test: 0.529063
max validation accuracy : 0.532455 max acc epoch : 60 test accuracy : 0.529063
Counter({0: 3111, 1: 2729, 2: 1560})

Epoch :  61 loss training:  0.26714466291014105 Time :  7094
accuracy train: 1.000000 val: 0.533082 test: 0.529805
max validation accuracy : 0.533082 max acc epoch : 61 test accuracy : 0.529805
Counter({0: 3119, 2: 2723, 1: 1558})

Epoch :  62 loss training:  0.1906644420050725 Time :  7171
accuracy train: 1.000000 val: 0.531828 test: 0.531783
max validation accuracy : 0.533082 max acc epoch : 61 test accuracy : 0.529805
Counter({0: 3117, 1: 2727, 2: 1556})

Epoch :  63 loss training:  0.21251491474322393 Time :  7223
accuracy train: 1.000000 val: 0.531828 test: 0.531536
max validation accuracy : 0.533082 max acc epoch : 61 test accuracy : 0.529805
Counter({0: 3123, 1: 2717, 2: 1560})

Epoch :  64 loss training:  0.19643380869092653 Time :  7286
accuracy train: 1.000000 val: 0.527438 test: 0.529557
max validation accuracy : 0.533082 max acc epoch : 61 test accuracy : 0.529805
Counter({1: 3126, 0: 2714, 2: 1560})

Epoch :  65 loss training:  0.1586925109877484 Time :  7365
accuracy train: 1.000000 val: 0.533082 test: 0.532031
max validation accuracy : 0.533082 max acc epoch : 61 test accuracy : 0.529805
Counter({2: 3099, 1: 2740, 0: 1561})

Epoch :  66 loss training:  0.18756332455996017 Time :  7429
accuracy train: 1.000000 val: 0.530260 test: 0.526589
max validation accuracy : 0.533082 max acc epoch : 61 test accuracy : 0.529805
Counter({1: 3111, 2: 2721, 0: 1568})

Epoch :  67 loss training:  0.1528356542585243 Time :  7495
accuracy train: 1.000000 val: 0.534964 test: 0.530547
max validation accuracy : 0.534964 max acc epoch : 67 test accuracy : 0.530547
Counter({0: 3110, 2: 2722, 1: 1568})

Epoch :  68 loss training:  0.13899210679664975 Time :  7554
accuracy train: 1.000000 val: 0.533710 test: 0.529063
max validation accuracy : 0.534964 max acc epoch : 67 test accuracy : 0.530547
Counter({0: 3124, 1: 2710, 2: 1566})

Epoch :  69 loss training:  0.21191010059374094 Time :  7642
accuracy train: 1.000000 val: 0.529633 test: 0.529310
max validation accuracy : 0.534964 max acc epoch : 67 test accuracy : 0.530547
Counter({0: 3133, 1: 2697, 2: 1570})

Epoch :  70 loss training:  0.18480810632900102 Time :  7724
accuracy train: 1.000000 val: 0.530574 test: 0.533762
max validation accuracy : 0.534964 max acc epoch : 67 test accuracy : 0.530547
Counter({2: 3155, 1: 2678, 0: 1567})

Epoch :  71 loss training:  0.1963715922247502 Time :  7814
accuracy train: 1.000000 val: 0.535278 test: 0.534751
max validation accuracy : 0.535278 max acc epoch : 71 test accuracy : 0.534751
Counter({2: 3163, 1: 2676, 0: 1561})

Epoch :  72 loss training:  0.11935165725662955 Time :  7895
accuracy train: 1.000000 val: 0.534337 test: 0.534999
max validation accuracy : 0.535278 max acc epoch : 71 test accuracy : 0.534751
Counter({1: 3181, 2: 2657, 0: 1562})

Epoch :  73 loss training:  0.10843815158659709 Time :  7985
accuracy train: 1.000000 val: 0.533710 test: 0.533020
max validation accuracy : 0.535278 max acc epoch : 71 test accuracy : 0.534751
Counter({0: 3180, 2: 2658, 1: 1562})

Epoch :  74 loss training:  0.13252708890649956 Time :  8061
accuracy train: 1.000000 val: 0.535278 test: 0.532031
max validation accuracy : 0.535278 max acc epoch : 71 test accuracy : 0.534751
Counter({0: 3166, 1: 2679, 2: 1555})

Epoch :  75 loss training:  0.12236181207117625 Time :  8136
accuracy train: 1.000000 val: 0.536532 test: 0.537720
max validation accuracy : 0.536532 max acc epoch : 75 test accuracy : 0.537720
Counter({2: 3180, 0: 2664, 1: 1556})

Epoch :  76 loss training:  0.10659747764839267 Time :  8210
accuracy train: 1.000000 val: 0.537786 test: 0.534257
max validation accuracy : 0.537786 max acc epoch : 76 test accuracy : 0.534257
Counter({1: 3164, 0: 2680, 2: 1556})

Epoch :  77 loss training:  0.08210627585503971 Time :  8255
accuracy train: 1.000000 val: 0.536532 test: 0.536483
max validation accuracy : 0.537786 max acc epoch : 76 test accuracy : 0.534257
Counter({2: 3166, 1: 2681, 0: 1553})

Epoch :  78 loss training:  0.13115203677807585 Time :  8307
accuracy train: 1.000000 val: 0.532769 test: 0.533267
max validation accuracy : 0.537786 max acc epoch : 76 test accuracy : 0.534257
Counter({0: 3150, 1: 2693, 2: 1557})

Epoch :  79 loss training:  0.1346120239886659 Time :  8383
accuracy train: 1.000000 val: 0.529006 test: 0.529310
max validation accuracy : 0.537786 max acc epoch : 76 test accuracy : 0.534257
Counter({2: 3133, 1: 2707, 0: 1560})

Epoch :  80 loss training:  0.08832415146389394 Time :  8434
accuracy train: 1.000000 val: 0.526184 test: 0.526589
max validation accuracy : 0.537786 max acc epoch : 76 test accuracy : 0.534257
Counter({0: 3104, 1: 2740, 2: 1556})

Epoch :  81 loss training:  0.09204359097657289 Time :  8500
accuracy train: 1.000000 val: 0.531201 test: 0.528073
max validation accuracy : 0.537786 max acc epoch : 76 test accuracy : 0.534257
Counter({1: 3084, 2: 2757, 0: 1559})

Epoch :  82 loss training:  0.08422242976575944 Time :  8557
accuracy train: 1.000000 val: 0.535905 test: 0.527826
max validation accuracy : 0.537786 max acc epoch : 76 test accuracy : 0.534257
Counter({0: 3095, 1: 2745, 2: 1560})

Epoch :  83 loss training:  0.07401559870368146 Time :  8619
accuracy train: 1.000000 val: 0.535905 test: 0.526589
max validation accuracy : 0.537786 max acc epoch : 76 test accuracy : 0.534257
Counter({2: 3086, 0: 2757, 1: 1557})

Epoch :  84 loss training:  0.06240102098126954 Time :  8666
accuracy train: 1.000000 val: 0.534650 test: 0.526094
max validation accuracy : 0.537786 max acc epoch : 76 test accuracy : 0.534257
Counter({0: 3081, 1: 2769, 2: 1550})

Epoch :  85 loss training:  0.058385405274748337 Time :  8715
accuracy train: 1.000000 val: 0.534650 test: 0.527826
max validation accuracy : 0.537786 max acc epoch : 76 test accuracy : 0.534257
Counter({1: 3088, 2: 2761, 0: 1551})

Epoch :  86 loss training:  0.08121191255304439 Time :  8769
accuracy train: 1.000000 val: 0.534337 test: 0.526837
max validation accuracy : 0.537786 max acc epoch : 76 test accuracy : 0.534257
Counter({0: 3069, 1: 2803, 2: 1528})

Epoch :  87 loss training:  0.07271571612182015 Time :  8842
accuracy train: 1.000000 val: 0.534964 test: 0.530052
max validation accuracy : 0.537786 max acc epoch : 76 test accuracy : 0.534257
Counter({1: 3049, 2: 2831, 0: 1520})

Epoch :  88 loss training:  0.05793324773731001 Time :  8915
accuracy train: 1.000000 val: 0.537786 test: 0.529557
max validation accuracy : 0.537786 max acc epoch : 76 test accuracy : 0.534257
Counter({2: 3057, 0: 2819, 1: 1524})

Epoch :  89 loss training:  0.049527282578310405 Time :  8978
accuracy train: 1.000000 val: 0.535591 test: 0.529063
max validation accuracy : 0.537786 max acc epoch : 76 test accuracy : 0.534257
Counter({2: 3070, 1: 2800, 0: 1530})

Epoch :  90 loss training:  0.0501742665655911 Time :  9041
accuracy train: 1.000000 val: 0.535905 test: 0.529310
max validation accuracy : 0.537786 max acc epoch : 76 test accuracy : 0.534257
Counter({0: 3069, 1: 2805, 2: 1526})

Epoch :  91 loss training:  0.5161402406347406 Time :  9102
accuracy train: 1.000000 val: 0.488554 test: 0.487262
max validation accuracy : 0.537786 max acc epoch : 76 test accuracy : 0.534257
Counter({1: 3312, 0: 2727, 2: 1361})

Epoch :  92 loss training:  1.527627701185338 Time :  9167
accuracy train: 1.000000 val: 0.502038 test: 0.493445
max validation accuracy : 0.537786 max acc epoch : 76 test accuracy : 0.534257
Counter({1: 3066, 0: 2882, 2: 1452})

========================================================================================================================================================================================================
best acc epoch :  76
validation accuracy :  0.5377861398557542
test accuracy :  0.5342567400445214
last test_accuracy :  0.49344546129112044
second best val :  0.5365318281592976
second best test :  0.5377195152114767
max gap 10
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  65 	 val_accuracy : 0.51019 	 test_accuracy : 0.49617 	 last test_accuracy : 0.49567 	 second best val : 0.50988 	 second best test : 0.49617
k :  1 	 best_acc epoch :  76 	 val_accuracy : 0.53779 	 test_accuracy : 0.53426 	 last test_accuracy : 0.49345 	 second best val : 0.53653 	 second best test : 0.53772

avg :  	 val_accuracy : 0.52399 	 test_accuracy : 0.51521 	 last_accuracy : 0.49456 	 second best val : 0.52320 	 second best test : 0.51694

std :  	 val_accuracy : 0.01380 	 test_accuracy : 0.01905 	 last_accuracy : 0.00111 	 second best val : 0.01333 	 second best test : 0.02078
