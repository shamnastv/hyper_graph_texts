date and time :  Tue Jan 26 20:46:01 2021
Namespace(batch_size=16, dataset='R52', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=300, lda=False, lr=0.0005, num_layers=3, num_mlp_layers=1, random_vec=True, seed=0, weight_decay=1e-05)
device :  cuda:0
HGNNModel(
  (word_embeddings): Embedding(9333, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=300, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=300, out_features=300, bias=True)
        (W_hr): Linear(in_features=300, out_features=300, bias=True)
        (W_in): Linear(in_features=300, out_features=300, bias=True)
        (W_hn): Linear(in_features=300, out_features=300, bias=True)
        (W_iz): Linear(in_features=300, out_features=300, bias=True)
        (W_hz): Linear(in_features=300, out_features=300, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=300, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=300, out_features=300, bias=True)
        (W_hr): Linear(in_features=300, out_features=300, bias=True)
        (W_in): Linear(in_features=300, out_features=300, bias=True)
        (W_hn): Linear(in_features=300, out_features=300, bias=True)
        (W_iz): Linear(in_features=300, out_features=300, bias=True)
        (W_hz): Linear(in_features=300, out_features=300, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=52, bias=True)
    (1): Linear(in_features=300, out_features=52, bias=True)
    (2): Linear(in_features=300, out_features=52, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  359.8509321315214 Time :  13
accuracy train: 0.922764 val: 0.870427 test: 0.859144
max validation accuracy : 0.870427 max acc epoch : 1.000000 test accuracy : 0.859144

Epoch :  2 loss training:  128.46389277651906 Time :  22
accuracy train: 0.970698 val: 0.903963 test: 0.891440
max validation accuracy : 0.903963 max acc epoch : 2.000000 test accuracy : 0.891440

Epoch :  3 loss training:  67.60125639964826 Time :  29
accuracy train: 0.990007 val: 0.908537 test: 0.905837
max validation accuracy : 0.908537 max acc epoch : 3.000000 test accuracy : 0.905837

Epoch :  4 loss training:  38.868518099188805 Time :  37
accuracy train: 0.995088 val: 0.929878 test: 0.903113
max validation accuracy : 0.929878 max acc epoch : 4.000000 test accuracy : 0.903113

Epoch :  5 loss training:  24.881814698746894 Time :  45
accuracy train: 0.996612 val: 0.923780 test: 0.907393
max validation accuracy : 0.929878 max acc epoch : 4.000000 test accuracy : 0.903113

Epoch :  6 loss training:  14.144188181358913 Time :  53
accuracy train: 0.998476 val: 0.935976 test: 0.915564
max validation accuracy : 0.935976 max acc epoch : 6.000000 test accuracy : 0.915564

Epoch :  7 loss training:  10.645545656501781 Time :  60
accuracy train: 0.998476 val: 0.929878 test: 0.914008
max validation accuracy : 0.935976 max acc epoch : 6.000000 test accuracy : 0.915564

Epoch :  8 loss training:  8.351285441938671 Time :  68
accuracy train: 0.998645 val: 0.928354 test: 0.913619
max validation accuracy : 0.935976 max acc epoch : 6.000000 test accuracy : 0.915564

Epoch :  9 loss training:  7.606327069195686 Time :  76
accuracy train: 0.998645 val: 0.923780 test: 0.911284
max validation accuracy : 0.935976 max acc epoch : 6.000000 test accuracy : 0.915564

Epoch :  10 loss training:  9.388954942543933 Time :  84
accuracy train: 0.998306 val: 0.922256 test: 0.909728
max validation accuracy : 0.935976 max acc epoch : 6.000000 test accuracy : 0.915564

Epoch :  11 loss training:  5.401797902166436 Time :  91
accuracy train: 0.998814 val: 0.929878 test: 0.910506
max validation accuracy : 0.935976 max acc epoch : 6.000000 test accuracy : 0.915564

Epoch :  12 loss training:  4.837362482139724 Time :  99
accuracy train: 0.998814 val: 0.926829 test: 0.914397
max validation accuracy : 0.935976 max acc epoch : 6.000000 test accuracy : 0.915564

Epoch :  13 loss training:  3.2366978014979395 Time :  107
accuracy train: 0.999153 val: 0.931402 test: 0.916342
max validation accuracy : 0.935976 max acc epoch : 6.000000 test accuracy : 0.915564

Epoch :  14 loss training:  3.842491295632499 Time :  115
accuracy train: 0.998814 val: 0.934451 test: 0.913619
max validation accuracy : 0.935976 max acc epoch : 6.000000 test accuracy : 0.915564

Epoch :  15 loss training:  2.8850796647666357 Time :  122
accuracy train: 0.998984 val: 0.931402 test: 0.917899
max validation accuracy : 0.935976 max acc epoch : 6.000000 test accuracy : 0.915564

Epoch :  16 loss training:  3.715147279129269 Time :  130
accuracy train: 0.999153 val: 0.934451 test: 0.916342
max validation accuracy : 0.935976 max acc epoch : 6.000000 test accuracy : 0.915564

Epoch :  17 loss training:  2.3818626738466264 Time :  138
accuracy train: 0.999153 val: 0.934451 test: 0.915953
max validation accuracy : 0.935976 max acc epoch : 6.000000 test accuracy : 0.915564

Epoch :  18 loss training:  2.2190195555103855 Time :  146
accuracy train: 0.999153 val: 0.932927 test: 0.917121
max validation accuracy : 0.935976 max acc epoch : 6.000000 test accuracy : 0.915564

Epoch :  19 loss training:  2.9417933964336953 Time :  154
accuracy train: 0.998984 val: 0.934451 test: 0.914397
max validation accuracy : 0.935976 max acc epoch : 6.000000 test accuracy : 0.915564

Epoch :  20 loss training:  2.5731791003427134 Time :  162
accuracy train: 0.998814 val: 0.934451 test: 0.917899
max validation accuracy : 0.935976 max acc epoch : 6.000000 test accuracy : 0.915564

Epoch :  21 loss training:  2.1791179132385423 Time :  170
accuracy train: 0.998984 val: 0.932927 test: 0.915564
max validation accuracy : 0.935976 max acc epoch : 6.000000 test accuracy : 0.915564

Epoch :  22 loss training:  2.279691082159843 Time :  177
accuracy train: 0.998984 val: 0.932927 test: 0.917899
max validation accuracy : 0.935976 max acc epoch : 6.000000 test accuracy : 0.915564

Epoch :  23 loss training:  2.751917977341691 Time :  185
accuracy train: 0.998984 val: 0.932927 test: 0.914008
max validation accuracy : 0.935976 max acc epoch : 6.000000 test accuracy : 0.915564

Epoch :  24 loss training:  2.4727254021690896 Time :  193
accuracy train: 0.998984 val: 0.931402 test: 0.917899
max validation accuracy : 0.935976 max acc epoch : 6.000000 test accuracy : 0.915564

Epoch :  25 loss training:  1.8864094958371425 Time :  201
accuracy train: 0.998984 val: 0.931402 test: 0.916342
max validation accuracy : 0.935976 max acc epoch : 6.000000 test accuracy : 0.915564

Epoch :  26 loss training:  2.160593867166426 Time :  208
accuracy train: 0.998984 val: 0.931402 test: 0.917121
max validation accuracy : 0.935976 max acc epoch : 6.000000 test accuracy : 0.915564

Epoch :  27 loss training:  1.7794677090046207 Time :  216
accuracy train: 0.998984 val: 0.926829 test: 0.915564
max validation accuracy : 0.935976 max acc epoch : 6.000000 test accuracy : 0.915564

========================================================================================================================================================================================================
max acc epoch :  6
max validation accuracy :  0.9359756097560976
test accuracy :  0.9155642023346303
latest_test_accuracy :  0.9155642023346303
========================================================================================================================================================================================================

