

date and time :  Thu Jun 10 20:23:24 2021
itr : 0
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=946, weight_decay=1e-10)
device :  cuda:0
Counter({0: 5412, 1: 2503, 2: 1215})

Epoch :  1 loss training:  124.03492869436741 Time :  25
accuracy train: 0.893293 val: 0.878049 test: 0.888327
max validation accuracy : 0.878049 max acc epoch : 1 test accuracy : 0.888327
Counter({1: 3578, 2: 2917, 0: 2635})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.147428035736084 Time :  47
accuracy train: 0.943089 val: 0.914634 test: 0.910895
max validation accuracy : 0.914634 max acc epoch : 2 test accuracy : 0.910895
Counter({1: 3752, 0: 2824, 2: 2554})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  36.306935861706734 Time :  70
accuracy train: 0.955454 val: 0.928354 test: 0.924514
max validation accuracy : 0.928354 max acc epoch : 3 test accuracy : 0.924514
Counter({0: 3798, 2: 2904, 1: 2428})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  27.778009332716465 Time :  98
accuracy train: 0.954099 val: 0.920732 test: 0.932296
max validation accuracy : 0.928354 max acc epoch : 3 test accuracy : 0.924514
Counter({0: 3804, 1: 2914, 2: 2412})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  28.554339883849025 Time :  123
accuracy train: 0.970190 val: 0.939024 test: 0.934241
max validation accuracy : 0.939024 max acc epoch : 5 test accuracy : 0.934241
Counter({1: 3842, 2: 2871, 0: 2417})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  26.058263843879104 Time :  147
accuracy train: 0.965447 val: 0.929878 test: 0.932296
max validation accuracy : 0.939024 max acc epoch : 5 test accuracy : 0.934241
Counter({1: 3859, 2: 2889, 0: 2382})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  19.86530637741089 Time :  171
accuracy train: 0.982215 val: 0.939024 test: 0.939689
max validation accuracy : 0.939024 max acc epoch : 5 test accuracy : 0.934241
Counter({2: 3881, 1: 2886, 0: 2363})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  16.81505244411528 Time :  194
accuracy train: 0.982724 val: 0.948171 test: 0.947082
max validation accuracy : 0.948171 max acc epoch : 8 test accuracy : 0.947082
Counter({0: 3883, 2: 2885, 1: 2362})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  15.521399076096714 Time :  218
accuracy train: 0.984925 val: 0.943598 test: 0.944358
max validation accuracy : 0.948171 max acc epoch : 8 test accuracy : 0.947082
Counter({0: 3882, 2: 2887, 1: 2361})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  13.81381285795942 Time :  241
accuracy train: 0.986619 val: 0.946646 test: 0.948249
max validation accuracy : 0.948171 max acc epoch : 8 test accuracy : 0.947082
Counter({1: 3883, 0: 2879, 2: 2368})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  12.347518152557313 Time :  269
accuracy train: 0.988991 val: 0.946646 test: 0.947471
max validation accuracy : 0.948171 max acc epoch : 8 test accuracy : 0.947082
Counter({1: 3886, 2: 2875, 0: 2369})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  12.307899887673557 Time :  294
accuracy train: 0.989329 val: 0.955793 test: 0.947471
max validation accuracy : 0.955793 max acc epoch : 12 test accuracy : 0.947471
Counter({1: 3887, 0: 2874, 2: 2369})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  11.208028721157461 Time :  315
accuracy train: 0.990007 val: 0.949695 test: 0.947860
max validation accuracy : 0.955793 max acc epoch : 12 test accuracy : 0.947471
Counter({1: 3888, 0: 2872, 2: 2370})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  10.588998269289732 Time :  338
accuracy train: 0.989837 val: 0.954268 test: 0.947860
max validation accuracy : 0.955793 max acc epoch : 12 test accuracy : 0.947471
Counter({1: 3890, 0: 2872, 2: 2368})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  10.31009212648496 Time :  362
accuracy train: 0.990346 val: 0.951220 test: 0.947082
max validation accuracy : 0.955793 max acc epoch : 12 test accuracy : 0.947471
Counter({0: 3893, 1: 2872, 2: 2365})

Epoch :  16 loss training:  10.025756934192032 Time :  387
accuracy train: 0.990007 val: 0.946646 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 12 test accuracy : 0.947471
Counter({0: 3894, 1: 2872, 2: 2364})

Epoch :  17 loss training:  9.95245607290417 Time :  418
accuracy train: 0.991531 val: 0.949695 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 12 test accuracy : 0.947471
Counter({0: 3896, 1: 2872, 2: 2362})

Epoch :  18 loss training:  9.273860394023359 Time :  444
accuracy train: 0.991701 val: 0.955793 test: 0.950584
max validation accuracy : 0.955793 max acc epoch : 12 test accuracy : 0.947471
Counter({0: 3897, 2: 2870, 1: 2363})

Epoch :  19 loss training:  8.731234902981669 Time :  470
accuracy train: 0.992886 val: 0.949695 test: 0.948249
max validation accuracy : 0.955793 max acc epoch : 12 test accuracy : 0.947471
Counter({1: 3899, 2: 2869, 0: 2362})

Epoch :  20 loss training:  8.641098032938316 Time :  506
accuracy train: 0.992717 val: 0.951220 test: 0.949805
max validation accuracy : 0.955793 max acc epoch : 12 test accuracy : 0.947471
Counter({0: 3898, 1: 2868, 2: 2364})

Epoch :  21 loss training:  8.978687295690179 Time :  535
accuracy train: 0.992547 val: 0.949695 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 12 test accuracy : 0.947471
Counter({1: 3901, 0: 2867, 2: 2362})

Epoch :  22 loss training:  8.00569236651063 Time :  559
accuracy train: 0.993225 val: 0.957317 test: 0.948638
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({0: 3903, 2: 2866, 1: 2361})

Epoch :  23 loss training:  7.73230046313256 Time :  584
accuracy train: 0.992039 val: 0.948171 test: 0.948249
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({2: 3905, 1: 2862, 0: 2363})

Epoch :  24 loss training:  8.436459799762815 Time :  611
accuracy train: 0.993902 val: 0.951220 test: 0.948638
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({1: 3908, 0: 2863, 2: 2359})

Epoch :  25 loss training:  7.4783066269010305 Time :  641
accuracy train: 0.993394 val: 0.951220 test: 0.949027
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({1: 3910, 0: 2861, 2: 2359})

Epoch :  26 loss training:  6.893178663216531 Time :  667
accuracy train: 0.993902 val: 0.948171 test: 0.950584
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({0: 3913, 1: 2862, 2: 2355})

Epoch :  27 loss training:  6.935141479130834 Time :  691
accuracy train: 0.993733 val: 0.952744 test: 0.947860
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({1: 3914, 2: 2862, 0: 2354})

Epoch :  28 loss training:  6.363307957304642 Time :  719
accuracy train: 0.994749 val: 0.946646 test: 0.949416
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({0: 3914, 2: 2865, 1: 2351})

Epoch :  29 loss training:  6.203968866029754 Time :  755
accuracy train: 0.995088 val: 0.954268 test: 0.949805
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({0: 3916, 2: 2863, 1: 2351})

Epoch :  30 loss training:  6.282060021068901 Time :  778
accuracy train: 0.994580 val: 0.952744 test: 0.949805
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({1: 3917, 2: 2865, 0: 2348})

Epoch :  31 loss training:  5.936579465167597 Time :  806
accuracy train: 0.994749 val: 0.955793 test: 0.950195
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({1: 3918, 0: 2863, 2: 2349})

Epoch :  32 loss training:  5.881381340324879 Time :  832
accuracy train: 0.994749 val: 0.954268 test: 0.949416
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({1: 3922, 0: 2862, 2: 2346})

Epoch :  33 loss training:  5.211235402384773 Time :  856
accuracy train: 0.994919 val: 0.952744 test: 0.950584
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({2: 3922, 0: 2862, 1: 2346})

Epoch :  34 loss training:  5.625573066528887 Time :  887
accuracy train: 0.994919 val: 0.952744 test: 0.949805
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({0: 3922, 2: 2863, 1: 2345})

Epoch :  35 loss training:  4.968888739007525 Time :  913
accuracy train: 0.995427 val: 0.952744 test: 0.949416
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({1: 3923, 2: 2864, 0: 2343})

Epoch :  36 loss training:  5.245123526779935 Time :  936
accuracy train: 0.995427 val: 0.952744 test: 0.951751
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({1: 3923, 0: 2863, 2: 2344})

Epoch :  37 loss training:  5.01071149809286 Time :  960
accuracy train: 0.994919 val: 0.951220 test: 0.950584
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({0: 3924, 1: 2862, 2: 2344})

Epoch :  38 loss training:  4.7935724935960025 Time :  991
accuracy train: 0.996612 val: 0.954268 test: 0.950195
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({0: 3926, 1: 2865, 2: 2339})

Epoch :  39 loss training:  4.523813531268388 Time :  1017
accuracy train: 0.995935 val: 0.949695 test: 0.950195
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({1: 3926, 2: 2867, 0: 2337})

Epoch :  40 loss training:  4.375444547273219 Time :  1041
accuracy train: 0.995935 val: 0.951220 test: 0.951751
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({0: 3926, 2: 2871, 1: 2333})

Epoch :  41 loss training:  4.112849376630038 Time :  1064
accuracy train: 0.995596 val: 0.949695 test: 0.952918
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({1: 3926, 0: 2872, 2: 2332})

Epoch :  42 loss training:  4.377217351575382 Time :  1089
accuracy train: 0.996443 val: 0.948171 test: 0.950195
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({1: 3927, 2: 2872, 0: 2331})

Epoch :  43 loss training:  3.958093164837919 Time :  1122
accuracy train: 0.996274 val: 0.946646 test: 0.951751
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({1: 3927, 0: 2872, 2: 2331})

Epoch :  44 loss training:  3.9495742255821824 Time :  1145
accuracy train: 0.996612 val: 0.948171 test: 0.951751
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({1: 3928, 2: 2871, 0: 2331})

Epoch :  45 loss training:  3.6106183704687282 Time :  1168
accuracy train: 0.997121 val: 0.951220 test: 0.950584
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({0: 3928, 1: 2871, 2: 2331})

Epoch :  46 loss training:  3.777344989590347 Time :  1194
accuracy train: 0.996782 val: 0.949695 test: 0.952140
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({0: 3925, 1: 2872, 2: 2333})

Epoch :  47 loss training:  3.4872267436003312 Time :  1219
accuracy train: 0.996443 val: 0.952744 test: 0.950195
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({1: 3924, 2: 2872, 0: 2334})

Epoch :  48 loss training:  3.6878203292144462 Time :  1250
accuracy train: 0.997121 val: 0.949695 test: 0.952529
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({1: 3924, 0: 2875, 2: 2331})

Epoch :  49 loss training:  3.5009159325272776 Time :  1276
accuracy train: 0.995766 val: 0.949695 test: 0.950195
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({0: 3925, 2: 2876, 1: 2329})

Epoch :  50 loss training:  3.1345287178410217 Time :  1302
accuracy train: 0.996782 val: 0.951220 test: 0.951362
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({0: 3925, 2: 2876, 1: 2329})

Epoch :  51 loss training:  3.456469959754031 Time :  1326
accuracy train: 0.996274 val: 0.954268 test: 0.951751
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({2: 3925, 1: 2876, 0: 2329})

Epoch :  52 loss training:  3.0384588561719283 Time :  1354
accuracy train: 0.996274 val: 0.948171 test: 0.950973
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({1: 3925, 2: 2875, 0: 2330})

Epoch :  53 loss training:  3.2411132102133706 Time :  1381
accuracy train: 0.996443 val: 0.951220 test: 0.950973
max validation accuracy : 0.957317 max acc epoch : 22 test accuracy : 0.948638
Counter({0: 3925, 1: 2874, 2: 2331})

========================================================================================================================================================================================================
max acc epoch :  22
max validation accuracy :  0.9573170731707317
test accuracy :  0.9486381322957198
last test_accuracy :  0.9509727626459143
max gap 10
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=946, weight_decay=1e-10)
device :  cuda:0
Counter({1: 5412, 2: 2503, 0: 1215})

Epoch :  1 loss training:  123.92121854424477 Time :  1410
accuracy train: 0.892785 val: 0.875000 test: 0.884436
max validation accuracy : 0.875000 max acc epoch : 1 test accuracy : 0.884436
Counter({1: 3566, 0: 2958, 2: 2606})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.49695763364434 Time :  1439
accuracy train: 0.938347 val: 0.914634 test: 0.906615
max validation accuracy : 0.914634 max acc epoch : 2 test accuracy : 0.906615
Counter({0: 3760, 1: 2867, 2: 2503})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  38.18219535052776 Time :  1464
accuracy train: 0.946138 val: 0.919207 test: 0.916342
max validation accuracy : 0.919207 max acc epoch : 3 test accuracy : 0.916342
Counter({1: 3842, 0: 2870, 2: 2418})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  35.14516914635897 Time :  1503
accuracy train: 0.949526 val: 0.913110 test: 0.931128
max validation accuracy : 0.919207 max acc epoch : 3 test accuracy : 0.916342
Counter({2: 3843, 0: 2887, 1: 2400})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  28.449882362037897 Time :  1531
accuracy train: 0.965955 val: 0.939024 test: 0.937743
max validation accuracy : 0.939024 max acc epoch : 5 test accuracy : 0.937743
Counter({1: 3864, 2: 2853, 0: 2413})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  24.56884390488267 Time :  1555
accuracy train: 0.964770 val: 0.931402 test: 0.938911
max validation accuracy : 0.939024 max acc epoch : 5 test accuracy : 0.937743
Counter({1: 3853, 2: 2882, 0: 2395})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  18.964596384204924 Time :  1578
accuracy train: 0.980352 val: 0.945122 test: 0.938911
max validation accuracy : 0.945122 max acc epoch : 7 test accuracy : 0.938911
Counter({2: 3883, 1: 2880, 0: 2367})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  16.22636953787878 Time :  1604
accuracy train: 0.982724 val: 0.948171 test: 0.949805
max validation accuracy : 0.948171 max acc epoch : 8 test accuracy : 0.949805
Counter({0: 3886, 2: 2873, 1: 2371})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  14.345418129116297 Time :  1633
accuracy train: 0.984587 val: 0.945122 test: 0.947860
max validation accuracy : 0.948171 max acc epoch : 8 test accuracy : 0.949805
Counter({0: 3886, 2: 2878, 1: 2366})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  12.69169357419014 Time :  1662
accuracy train: 0.986450 val: 0.948171 test: 0.952140
max validation accuracy : 0.948171 max acc epoch : 8 test accuracy : 0.949805
Counter({1: 3892, 2: 2873, 0: 2365})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  11.88740112632513 Time :  1688
accuracy train: 0.988313 val: 0.954268 test: 0.946693
max validation accuracy : 0.954268 max acc epoch : 11 test accuracy : 0.946693
Counter({0: 3895, 2: 2868, 1: 2367})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  11.60413636919111 Time :  1711
accuracy train: 0.988991 val: 0.955793 test: 0.947082
max validation accuracy : 0.955793 max acc epoch : 12 test accuracy : 0.947082
Counter({1: 3900, 0: 2864, 2: 2366})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  10.705978954676539 Time :  1738
accuracy train: 0.990346 val: 0.948171 test: 0.946304
max validation accuracy : 0.955793 max acc epoch : 12 test accuracy : 0.947082
Counter({1: 3903, 0: 2862, 2: 2365})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  10.1687105121091 Time :  1769
accuracy train: 0.988991 val: 0.952744 test: 0.947082
max validation accuracy : 0.955793 max acc epoch : 12 test accuracy : 0.947082
Counter({0: 3904, 2: 2862, 1: 2364})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  10.03725699428469 Time :  1800
accuracy train: 0.989837 val: 0.951220 test: 0.948249
max validation accuracy : 0.955793 max acc epoch : 12 test accuracy : 0.947082
Counter({0: 3905, 1: 2862, 2: 2363})

Epoch :  16 loss training:  9.922796297352761 Time :  1827
accuracy train: 0.990007 val: 0.952744 test: 0.950973
max validation accuracy : 0.955793 max acc epoch : 12 test accuracy : 0.947082
Counter({1: 3905, 2: 2861, 0: 2364})

Epoch :  17 loss training:  9.488326960243285 Time :  1858
accuracy train: 0.990346 val: 0.952744 test: 0.948638
max validation accuracy : 0.955793 max acc epoch : 12 test accuracy : 0.947082
Counter({2: 3906, 1: 2862, 0: 2362})

Epoch :  18 loss training:  8.956109126564115 Time :  1887
accuracy train: 0.990854 val: 0.952744 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 12 test accuracy : 0.947082
Counter({0: 3909, 1: 2860, 2: 2361})

Epoch :  19 loss training:  8.548243429511786 Time :  1916
accuracy train: 0.993056 val: 0.952744 test: 0.948638
max validation accuracy : 0.955793 max acc epoch : 12 test accuracy : 0.947082
Counter({2: 3912, 1: 2860, 0: 2358})

Epoch :  20 loss training:  8.312555064447224 Time :  1944
accuracy train: 0.993056 val: 0.946646 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 12 test accuracy : 0.947082
Counter({0: 3912, 2: 2860, 1: 2358})

Epoch :  21 loss training:  8.682784952688962 Time :  1974
accuracy train: 0.993056 val: 0.951220 test: 0.950584
max validation accuracy : 0.955793 max acc epoch : 12 test accuracy : 0.947082
Counter({0: 3914, 2: 2861, 1: 2355})

Epoch :  22 loss training:  7.590100800152868 Time :  2004
accuracy train: 0.994072 val: 0.952744 test: 0.947860
max validation accuracy : 0.955793 max acc epoch : 12 test accuracy : 0.947082
Counter({0: 3914, 2: 2863, 1: 2353})

Epoch :  23 loss training:  7.065035535022616 Time :  2033
accuracy train: 0.993733 val: 0.948171 test: 0.947860
max validation accuracy : 0.955793 max acc epoch : 12 test accuracy : 0.947082
Counter({1: 3915, 2: 2863, 0: 2352})

Epoch :  24 loss training:  8.125478586414829 Time :  2073
accuracy train: 0.993394 val: 0.952744 test: 0.948638
max validation accuracy : 0.955793 max acc epoch : 12 test accuracy : 0.947082
Counter({0: 3915, 2: 2864, 1: 2351})

Epoch :  25 loss training:  7.377935781609267 Time :  2102
accuracy train: 0.993225 val: 0.957317 test: 0.948638
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.948638
Counter({0: 3918, 1: 2861, 2: 2351})

Epoch :  26 loss training:  6.957274827058427 Time :  2126
accuracy train: 0.994072 val: 0.951220 test: 0.951751
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.948638
Counter({1: 3920, 0: 2863, 2: 2347})

Epoch :  27 loss training:  6.680741157848388 Time :  2154
accuracy train: 0.994580 val: 0.955793 test: 0.948638
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.948638
Counter({1: 3921, 0: 2864, 2: 2345})

Epoch :  28 loss training:  6.295800622319803 Time :  2183
accuracy train: 0.994749 val: 0.952744 test: 0.949416
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.948638
Counter({1: 3921, 0: 2866, 2: 2343})

Epoch :  29 loss training:  5.8661489689257 Time :  2208
accuracy train: 0.994749 val: 0.954268 test: 0.949805
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.948638
Counter({0: 3922, 1: 2869, 2: 2339})

Epoch :  30 loss training:  6.060002216137946 Time :  2239
accuracy train: 0.994411 val: 0.951220 test: 0.947471
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.948638
Counter({1: 3926, 0: 2870, 2: 2334})

Epoch :  31 loss training:  5.823706532130018 Time :  2269
accuracy train: 0.994919 val: 0.954268 test: 0.947860
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.948638
Counter({1: 3926, 0: 2868, 2: 2336})

Epoch :  32 loss training:  5.778475971659645 Time :  2291
accuracy train: 0.994749 val: 0.954268 test: 0.947860
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.948638
Counter({2: 3929, 1: 2868, 0: 2333})

Epoch :  33 loss training:  5.373847094830126 Time :  2315
accuracy train: 0.995257 val: 0.957317 test: 0.945525
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.948638
Counter({1: 3940, 0: 2857, 2: 2333})

Epoch :  34 loss training:  5.257544448599219 Time :  2350
accuracy train: 0.995427 val: 0.958841 test: 0.947860
max validation accuracy : 0.958841 max acc epoch : 34 test accuracy : 0.947860
Counter({1: 3941, 2: 2856, 0: 2333})

Epoch :  35 loss training:  4.786179986549541 Time :  2376
accuracy train: 0.995257 val: 0.955793 test: 0.948249
max validation accuracy : 0.958841 max acc epoch : 34 test accuracy : 0.947860
Counter({1: 3941, 2: 2859, 0: 2330})

Epoch :  36 loss training:  5.099665072746575 Time :  2403
accuracy train: 0.995596 val: 0.960366 test: 0.949027
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({1: 3941, 0: 2859, 2: 2330})

Epoch :  37 loss training:  4.7718770815990865 Time :  2430
accuracy train: 0.995427 val: 0.954268 test: 0.947471
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({2: 3941, 1: 2859, 0: 2330})

Epoch :  38 loss training:  4.725111145060509 Time :  2458
accuracy train: 0.996443 val: 0.955793 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({0: 3943, 2: 2859, 1: 2328})

Epoch :  39 loss training:  4.624970662058331 Time :  2485
accuracy train: 0.995766 val: 0.955793 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({1: 3943, 2: 2861, 0: 2326})

Epoch :  40 loss training:  4.229970348300412 Time :  2516
accuracy train: 0.996274 val: 0.954268 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({0: 3943, 1: 2863, 2: 2324})

Epoch :  41 loss training:  4.169252440799028 Time :  2547
accuracy train: 0.996274 val: 0.954268 test: 0.949416
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({1: 3943, 0: 2865, 2: 2322})

Epoch :  42 loss training:  4.280681890202686 Time :  2574
accuracy train: 0.996274 val: 0.952744 test: 0.949027
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({2: 3943, 1: 2869, 0: 2318})

Epoch :  43 loss training:  3.6946233400376514 Time :  2607
accuracy train: 0.995935 val: 0.952744 test: 0.949805
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({2: 3944, 0: 2869, 1: 2317})

Epoch :  44 loss training:  3.8225179676664993 Time :  2633
accuracy train: 0.995935 val: 0.949695 test: 0.945914
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({1: 3944, 0: 2868, 2: 2318})

Epoch :  45 loss training:  3.4063212455948815 Time :  2662
accuracy train: 0.996951 val: 0.955793 test: 0.947860
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({0: 3944, 2: 2867, 1: 2319})

Epoch :  46 loss training:  3.7752582052489743 Time :  2689
accuracy train: 0.996782 val: 0.954268 test: 0.949805
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({0: 3944, 1: 2867, 2: 2319})

Epoch :  47 loss training:  3.4163596940925345 Time :  2714
accuracy train: 0.996612 val: 0.955793 test: 0.946304
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({0: 3944, 2: 2867, 1: 2319})

Epoch :  48 loss training:  3.6872363775619306 Time :  2747
accuracy train: 0.997121 val: 0.952744 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({0: 3943, 1: 2869, 2: 2318})

Epoch :  49 loss training:  3.5250073450733908 Time :  2777
accuracy train: 0.996951 val: 0.957317 test: 0.949805
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({0: 3941, 2: 2872, 1: 2317})

Epoch :  50 loss training:  3.1327341155847535 Time :  2803
accuracy train: 0.996612 val: 0.954268 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({1: 3941, 0: 2870, 2: 2319})

Epoch :  51 loss training:  3.4548083847621456 Time :  2829
accuracy train: 0.996443 val: 0.955793 test: 0.951362
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({1: 3941, 2: 2870, 0: 2319})

Epoch :  52 loss training:  3.0230431164382026 Time :  2853
accuracy train: 0.996782 val: 0.949695 test: 0.950973
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({1: 3940, 0: 2872, 2: 2318})

Epoch :  53 loss training:  3.050709347182419 Time :  2881
accuracy train: 0.996612 val: 0.952744 test: 0.949805
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({0: 3940, 2: 2872, 1: 2318})

Epoch :  54 loss training:  2.5737890180025715 Time :  2913
accuracy train: 0.996612 val: 0.949695 test: 0.949027
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({1: 3940, 2: 2872, 0: 2318})

Epoch :  55 loss training:  2.9117114064865746 Time :  2939
accuracy train: 0.996951 val: 0.952744 test: 0.949027
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({1: 3940, 2: 2872, 0: 2318})

Epoch :  56 loss training:  3.042143379454501 Time :  2965
accuracy train: 0.996951 val: 0.957317 test: 0.947471
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({1: 3941, 0: 2873, 2: 2316})

Epoch :  57 loss training:  2.427863784163492 Time :  2996
accuracy train: 0.996782 val: 0.951220 test: 0.950973
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({1: 3933, 2: 2881, 0: 2316})

Epoch :  58 loss training:  3.0329821513732895 Time :  3024
accuracy train: 0.996782 val: 0.949695 test: 0.948638
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({1: 3933, 0: 2882, 2: 2315})

Epoch :  59 loss training:  2.69707300781738 Time :  3046
accuracy train: 0.996951 val: 0.957317 test: 0.948638
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({1: 3933, 2: 2882, 0: 2315})

Epoch :  60 loss training:  2.5776396475266665 Time :  3077
accuracy train: 0.996782 val: 0.946646 test: 0.948249
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({1: 3933, 2: 2882, 0: 2315})

Epoch :  61 loss training:  2.805929465102963 Time :  3106
accuracy train: 0.997121 val: 0.949695 test: 0.949416
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({1: 3933, 0: 2884, 2: 2313})

Epoch :  62 loss training:  2.412634941225406 Time :  3131
accuracy train: 0.996782 val: 0.951220 test: 0.947860
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({0: 3932, 1: 2885, 2: 2313})

Epoch :  63 loss training:  2.348751662822906 Time :  3157
accuracy train: 0.996951 val: 0.951220 test: 0.947860
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({1: 3932, 0: 2884, 2: 2314})

Epoch :  64 loss training:  3.0943645420775283 Time :  3189
accuracy train: 0.996782 val: 0.946646 test: 0.946304
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({1: 3932, 2: 2884, 0: 2314})

Epoch :  65 loss training:  2.5649742981768213 Time :  3219
accuracy train: 0.996782 val: 0.946646 test: 0.948638
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({2: 3933, 0: 2884, 1: 2313})

Epoch :  66 loss training:  2.8333785948634613 Time :  3244
accuracy train: 0.997121 val: 0.951220 test: 0.948638
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({0: 3934, 2: 2884, 1: 2312})

Epoch :  67 loss training:  2.5249805971689057 Time :  3274
accuracy train: 0.996951 val: 0.946646 test: 0.949027
max validation accuracy : 0.960366 max acc epoch : 36 test accuracy : 0.949027
Counter({2: 3945, 0: 2873, 1: 2312})

========================================================================================================================================================================================================
max acc epoch :  36
max validation accuracy :  0.9603658536585366
test accuracy :  0.9490272373540856
last test_accuracy :  0.9490272373540856
max gap 13
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=946, weight_decay=1e-10)
device :  cuda:0
Counter({1: 5412, 2: 2503, 0: 1215})

Epoch :  1 loss training:  123.94195719063282 Time :  3308
accuracy train: 0.893801 val: 0.879573 test: 0.885992
max validation accuracy : 0.879573 max acc epoch : 1 test accuracy : 0.885992
Counter({0: 3580, 1: 2960, 2: 2590})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.39351895079017 Time :  3332
accuracy train: 0.936822 val: 0.917683 test: 0.903502
max validation accuracy : 0.917683 max acc epoch : 2 test accuracy : 0.903502
Counter({0: 3757, 2: 2878, 1: 2495})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  38.07349845394492 Time :  3358
accuracy train: 0.945630 val: 0.920732 test: 0.915953
max validation accuracy : 0.920732 max acc epoch : 3 test accuracy : 0.915953
Counter({1: 3829, 2: 2898, 0: 2403})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  35.2019773311913 Time :  3390
accuracy train: 0.954099 val: 0.913110 test: 0.928794
max validation accuracy : 0.920732 max acc epoch : 3 test accuracy : 0.915953
Counter({1: 3836, 0: 2891, 2: 2403})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  28.66583160497248 Time :  3415
accuracy train: 0.964092 val: 0.935976 test: 0.938132
max validation accuracy : 0.935976 max acc epoch : 5 test accuracy : 0.938132
Counter({1: 3838, 2: 2882, 0: 2410})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  24.36295527406037 Time :  3443
accuracy train: 0.961382 val: 0.925305 test: 0.933852
max validation accuracy : 0.935976 max acc epoch : 5 test accuracy : 0.938132
Counter({1: 3829, 0: 2887, 2: 2414})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  18.938755746930838 Time :  3468
accuracy train: 0.980014 val: 0.939024 test: 0.935019
max validation accuracy : 0.939024 max acc epoch : 7 test accuracy : 0.935019
Counter({2: 3860, 1: 2885, 0: 2385})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  16.483569187112153 Time :  3495
accuracy train: 0.984417 val: 0.946646 test: 0.947860
max validation accuracy : 0.946646 max acc epoch : 8 test accuracy : 0.947860
Counter({1: 3869, 0: 2879, 2: 2382})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  14.565750407986343 Time :  3525
accuracy train: 0.984248 val: 0.945122 test: 0.946304
max validation accuracy : 0.946646 max acc epoch : 8 test accuracy : 0.947860
Counter({0: 3873, 2: 2874, 1: 2383})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  12.816303386352956 Time :  3556
accuracy train: 0.986619 val: 0.949695 test: 0.950973
max validation accuracy : 0.949695 max acc epoch : 10 test accuracy : 0.950973
Counter({1: 3880, 2: 2870, 0: 2380})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  12.033507759682834 Time :  3587
accuracy train: 0.988313 val: 0.951220 test: 0.947471
max validation accuracy : 0.951220 max acc epoch : 11 test accuracy : 0.947471
Counter({1: 3888, 2: 2861, 0: 2381})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  11.426190408412367 Time :  3616
accuracy train: 0.989668 val: 0.949695 test: 0.946304
max validation accuracy : 0.951220 max acc epoch : 11 test accuracy : 0.947471
Counter({1: 3899, 0: 2852, 2: 2379})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  10.84462137403898 Time :  3639
accuracy train: 0.990346 val: 0.948171 test: 0.946304
max validation accuracy : 0.951220 max acc epoch : 11 test accuracy : 0.947471
Counter({2: 3900, 0: 2851, 1: 2379})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  10.366236511617899 Time :  3665
accuracy train: 0.990007 val: 0.952744 test: 0.946304
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.946304
Counter({1: 3900, 0: 2850, 2: 2380})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  9.988409246783704 Time :  3695
accuracy train: 0.990854 val: 0.949695 test: 0.946693
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.946304
Counter({1: 3903, 0: 2850, 2: 2377})

Epoch :  16 loss training:  9.904280305840075 Time :  3720
accuracy train: 0.990007 val: 0.946646 test: 0.948249
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.946304
Counter({0: 3904, 1: 2850, 2: 2376})

Epoch :  17 loss training:  9.607863198965788 Time :  3750
accuracy train: 0.991531 val: 0.949695 test: 0.948249
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.946304
Counter({0: 3905, 1: 2851, 2: 2374})

Epoch :  18 loss training:  8.995321638416499 Time :  3778
accuracy train: 0.991701 val: 0.949695 test: 0.948638
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.946304
Counter({0: 3906, 2: 2852, 1: 2372})

Epoch :  19 loss training:  8.54979156050831 Time :  3806
accuracy train: 0.992209 val: 0.952744 test: 0.949027
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.946304
Counter({0: 3906, 1: 2852, 2: 2372})

Epoch :  20 loss training:  8.36076850257814 Time :  3832
accuracy train: 0.993056 val: 0.943598 test: 0.950584
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.946304
Counter({0: 3907, 2: 2849, 1: 2374})

Epoch :  21 loss training:  8.718320574611425 Time :  3859
accuracy train: 0.993394 val: 0.949695 test: 0.949416
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.946304
Counter({0: 3908, 2: 2849, 1: 2373})

Epoch :  22 loss training:  7.734752920921892 Time :  3888
accuracy train: 0.993733 val: 0.952744 test: 0.949027
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.946304
Counter({0: 3909, 1: 2850, 2: 2371})

Epoch :  23 loss training:  7.287079555913806 Time :  3914
accuracy train: 0.993394 val: 0.949695 test: 0.947860
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.946304
Counter({2: 3911, 1: 2849, 0: 2370})

Epoch :  24 loss training:  8.030427863821387 Time :  3942
accuracy train: 0.993733 val: 0.952744 test: 0.949416
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.946304
Counter({1: 3911, 2: 2849, 0: 2370})

Epoch :  25 loss training:  7.555642524734139 Time :  3974
accuracy train: 0.993394 val: 0.958841 test: 0.947860
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3917, 0: 2845, 2: 2368})

Epoch :  26 loss training:  7.119627386098728 Time :  4004
accuracy train: 0.993733 val: 0.951220 test: 0.950973
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3919, 0: 2844, 2: 2367})

Epoch :  27 loss training:  6.669589533936232 Time :  4030
accuracy train: 0.994580 val: 0.955793 test: 0.950195
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({2: 3919, 1: 2844, 0: 2367})

Epoch :  28 loss training:  6.41041408595629 Time :  4054
accuracy train: 0.994749 val: 0.952744 test: 0.947471
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({0: 3920, 2: 2847, 1: 2363})

Epoch :  29 loss training:  5.960731456289068 Time :  4083
accuracy train: 0.995257 val: 0.949695 test: 0.948638
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3921, 2: 2849, 0: 2360})

Epoch :  30 loss training:  6.080467441817746 Time :  4114
accuracy train: 0.994580 val: 0.955793 test: 0.945914
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({0: 3923, 1: 2849, 2: 2358})

Epoch :  31 loss training:  5.9478737155441195 Time :  4143
accuracy train: 0.995088 val: 0.954268 test: 0.947860
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3923, 2: 2848, 0: 2359})

Epoch :  32 loss training:  5.723697970970534 Time :  4171
accuracy train: 0.995088 val: 0.957317 test: 0.949416
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3925, 0: 2847, 2: 2358})

Epoch :  33 loss training:  5.39393991290126 Time :  4198
accuracy train: 0.995427 val: 0.955793 test: 0.947471
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3934, 0: 2838, 2: 2358})

Epoch :  34 loss training:  5.378341781906784 Time :  4226
accuracy train: 0.995427 val: 0.954268 test: 0.949027
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({2: 3934, 0: 2842, 1: 2354})

Epoch :  35 loss training:  4.873087655054405 Time :  4257
accuracy train: 0.995596 val: 0.957317 test: 0.948249
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3934, 2: 2842, 0: 2354})

Epoch :  36 loss training:  5.157291829353198 Time :  4283
accuracy train: 0.995766 val: 0.958841 test: 0.949805
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({0: 3934, 1: 2843, 2: 2353})

Epoch :  37 loss training:  4.835488057113253 Time :  4310
accuracy train: 0.995427 val: 0.948171 test: 0.947860
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3934, 0: 2841, 2: 2355})

Epoch :  38 loss training:  4.66962812084239 Time :  4337
accuracy train: 0.996443 val: 0.955793 test: 0.950973
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({0: 3936, 2: 2841, 1: 2353})

Epoch :  39 loss training:  4.601558202761225 Time :  4367
accuracy train: 0.995935 val: 0.954268 test: 0.952918
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3937, 2: 2848, 0: 2345})

Epoch :  40 loss training:  4.3790974208386615 Time :  4393
accuracy train: 0.995596 val: 0.952744 test: 0.950584
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({0: 3937, 1: 2849, 2: 2344})

Epoch :  41 loss training:  4.247836779919453 Time :  4424
accuracy train: 0.996443 val: 0.952744 test: 0.952529
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3937, 2: 2853, 0: 2340})

Epoch :  42 loss training:  4.316875481628813 Time :  4455
accuracy train: 0.996274 val: 0.951220 test: 0.950973
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3937, 2: 2854, 0: 2339})

Epoch :  43 loss training:  3.838840825832449 Time :  4483
accuracy train: 0.996443 val: 0.951220 test: 0.950584
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3937, 0: 2854, 2: 2339})

Epoch :  44 loss training:  4.034123439108953 Time :  4515
accuracy train: 0.996274 val: 0.951220 test: 0.948249
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3937, 0: 2855, 2: 2338})

Epoch :  45 loss training:  3.5351058434462175 Time :  4550
accuracy train: 0.996782 val: 0.952744 test: 0.948638
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({0: 3938, 1: 2856, 2: 2336})

Epoch :  46 loss training:  3.7549784887814894 Time :  4576
accuracy train: 0.996612 val: 0.955793 test: 0.949416
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({0: 3937, 2: 2857, 1: 2336})

Epoch :  47 loss training:  3.4806136105326004 Time :  4606
accuracy train: 0.996443 val: 0.955793 test: 0.949416
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3937, 2: 2858, 0: 2335})

Epoch :  48 loss training:  3.841819091408979 Time :  4635
accuracy train: 0.997121 val: 0.958841 test: 0.948249
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3935, 2: 2860, 0: 2335})

Epoch :  49 loss training:  3.4010815508663654 Time :  4664
accuracy train: 0.996782 val: 0.957317 test: 0.949805
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3935, 0: 2860, 2: 2335})

Epoch :  50 loss training:  3.2575998406973667 Time :  4691
accuracy train: 0.996782 val: 0.955793 test: 0.952140
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3935, 0: 2859, 2: 2336})

Epoch :  51 loss training:  3.5921386861009523 Time :  4715
accuracy train: 0.996612 val: 0.955793 test: 0.950584
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({2: 3934, 1: 2860, 0: 2336})

Epoch :  52 loss training:  3.172879323596135 Time :  4750
accuracy train: 0.997121 val: 0.952744 test: 0.950973
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3934, 0: 2861, 2: 2335})

Epoch :  53 loss training:  3.163593362318352 Time :  4782
accuracy train: 0.996951 val: 0.954268 test: 0.949805
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({0: 3934, 2: 2860, 1: 2336})

Epoch :  54 loss training:  2.5954348957748152 Time :  4808
accuracy train: 0.996612 val: 0.952744 test: 0.951751
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3934, 2: 2862, 0: 2334})

Epoch :  55 loss training:  2.8982490808703005 Time :  4838
accuracy train: 0.996782 val: 0.955793 test: 0.949027
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3925, 2: 2872, 0: 2333})

Epoch :  56 loss training:  3.058330493106041 Time :  4868
accuracy train: 0.996612 val: 0.955793 test: 0.949805
max validation accuracy : 0.958841 max acc epoch : 25 test accuracy : 0.947860
Counter({2: 3925, 0: 2874, 1: 2331})

========================================================================================================================================================================================================
max acc epoch :  25
max validation accuracy :  0.9588414634146342
test accuracy :  0.9478599221789883
last test_accuracy :  0.9498054474708171
max gap 11
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=946, weight_decay=1e-10)
device :  cuda:0
Counter({1: 5412, 2: 2503, 0: 1215})

Epoch :  1 loss training:  123.87170289456844 Time :  4909
accuracy train: 0.893462 val: 0.879573 test: 0.886770
max validation accuracy : 0.879573 max acc epoch : 1 test accuracy : 0.886770
Counter({1: 3567, 0: 2944, 2: 2619})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.446070935577154 Time :  4938
accuracy train: 0.941057 val: 0.910061 test: 0.908560
max validation accuracy : 0.910061 max acc epoch : 2 test accuracy : 0.908560
Counter({1: 3733, 2: 2888, 0: 2509})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  39.315154667943716 Time :  4963
accuracy train: 0.942751 val: 0.916159 test: 0.918677
max validation accuracy : 0.916159 max acc epoch : 3 test accuracy : 0.918677
Counter({2: 3833, 0: 2884, 1: 2413})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  34.07803909853101 Time :  4992
accuracy train: 0.952066 val: 0.916159 test: 0.932685
max validation accuracy : 0.916159 max acc epoch : 3 test accuracy : 0.918677
Counter({1: 3850, 2: 2895, 0: 2385})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  27.658126335591078 Time :  5018
accuracy train: 0.966972 val: 0.939024 test: 0.938911
max validation accuracy : 0.939024 max acc epoch : 5 test accuracy : 0.938911
Counter({1: 3861, 2: 2859, 0: 2410})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  24.772702803835273 Time :  5049
accuracy train: 0.963584 val: 0.926829 test: 0.931907
max validation accuracy : 0.939024 max acc epoch : 5 test accuracy : 0.938911
Counter({2: 3857, 1: 2887, 0: 2386})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  18.9883070923388 Time :  5074
accuracy train: 0.980352 val: 0.939024 test: 0.935409
max validation accuracy : 0.939024 max acc epoch : 5 test accuracy : 0.938911
Counter({2: 3882, 1: 2885, 0: 2363})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  16.443826554808766 Time :  5097
accuracy train: 0.983570 val: 0.948171 test: 0.948249
max validation accuracy : 0.948171 max acc epoch : 8 test accuracy : 0.948249
Counter({1: 3888, 2: 2874, 0: 2368})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  14.730564498342574 Time :  5127
accuracy train: 0.984079 val: 0.945122 test: 0.946693
max validation accuracy : 0.948171 max acc epoch : 8 test accuracy : 0.948249
Counter({0: 3890, 2: 2878, 1: 2362})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  12.60292531689629 Time :  5158
accuracy train: 0.986619 val: 0.946646 test: 0.950195
max validation accuracy : 0.948171 max acc epoch : 8 test accuracy : 0.948249
Counter({1: 3891, 2: 2876, 0: 2363})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  11.844411970116198 Time :  5182
accuracy train: 0.988821 val: 0.952744 test: 0.948638
max validation accuracy : 0.952744 max acc epoch : 11 test accuracy : 0.948638
Counter({2: 3902, 0: 2866, 1: 2362})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  11.62114916741848 Time :  5207
accuracy train: 0.989160 val: 0.957317 test: 0.948249
max validation accuracy : 0.957317 max acc epoch : 12 test accuracy : 0.948249
Counter({0: 3908, 2: 2860, 1: 2362})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  10.724162044934928 Time :  5235
accuracy train: 0.989329 val: 0.949695 test: 0.947860
max validation accuracy : 0.957317 max acc epoch : 12 test accuracy : 0.948249
Counter({0: 3909, 2: 2860, 1: 2361})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  10.031820403411984 Time :  5269
accuracy train: 0.989499 val: 0.951220 test: 0.947082
max validation accuracy : 0.957317 max acc epoch : 12 test accuracy : 0.948249
Counter({2: 3910, 1: 2859, 0: 2361})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  9.975646753329784 Time :  5296
accuracy train: 0.990007 val: 0.952744 test: 0.946304
max validation accuracy : 0.957317 max acc epoch : 12 test accuracy : 0.948249
Counter({2: 3910, 0: 2859, 1: 2361})

Epoch :  16 loss training:  9.64805915323086 Time :  5321
accuracy train: 0.990176 val: 0.951220 test: 0.950973
max validation accuracy : 0.957317 max acc epoch : 12 test accuracy : 0.948249
Counter({1: 3910, 0: 2859, 2: 2361})

Epoch :  17 loss training:  9.661946862470359 Time :  5347
accuracy train: 0.991023 val: 0.949695 test: 0.950195
max validation accuracy : 0.957317 max acc epoch : 12 test accuracy : 0.948249
Counter({0: 3911, 2: 2859, 1: 2360})

Epoch :  18 loss training:  8.914365466218442 Time :  5373
accuracy train: 0.990515 val: 0.954268 test: 0.950195
max validation accuracy : 0.957317 max acc epoch : 12 test accuracy : 0.948249
Counter({0: 3914, 1: 2856, 2: 2360})

Epoch :  19 loss training:  8.448154693003744 Time :  5398
accuracy train: 0.993394 val: 0.952744 test: 0.949027
max validation accuracy : 0.957317 max acc epoch : 12 test accuracy : 0.948249
Counter({1: 3915, 2: 2856, 0: 2359})

Epoch :  20 loss training:  8.388157567940652 Time :  5433
accuracy train: 0.993056 val: 0.948171 test: 0.949416
max validation accuracy : 0.957317 max acc epoch : 12 test accuracy : 0.948249
Counter({1: 3915, 0: 2856, 2: 2359})

Epoch :  21 loss training:  8.84201244590804 Time :  5459
accuracy train: 0.993056 val: 0.952744 test: 0.950195
max validation accuracy : 0.957317 max acc epoch : 12 test accuracy : 0.948249
Counter({1: 3917, 0: 2856, 2: 2357})

Epoch :  22 loss training:  7.660460835788399 Time :  5483
accuracy train: 0.993733 val: 0.957317 test: 0.949805
max validation accuracy : 0.957317 max acc epoch : 12 test accuracy : 0.948249
Counter({1: 3917, 2: 2858, 0: 2355})

Epoch :  23 loss training:  7.085534682497382 Time :  5509
accuracy train: 0.993733 val: 0.951220 test: 0.948638
max validation accuracy : 0.957317 max acc epoch : 12 test accuracy : 0.948249
Counter({0: 3919, 2: 2857, 1: 2354})

Epoch :  24 loss training:  8.00021944148466 Time :  5540
accuracy train: 0.993564 val: 0.954268 test: 0.949027
max validation accuracy : 0.957317 max acc epoch : 12 test accuracy : 0.948249
Counter({0: 3920, 2: 2857, 1: 2353})

Epoch :  25 loss training:  7.345710464054719 Time :  5568
accuracy train: 0.993733 val: 0.960366 test: 0.949027
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({1: 3923, 0: 2858, 2: 2349})

Epoch :  26 loss training:  7.049317579949275 Time :  5599
accuracy train: 0.994072 val: 0.952744 test: 0.950584
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({2: 3924, 1: 2858, 0: 2348})

Epoch :  27 loss training:  6.615668016951531 Time :  5628
accuracy train: 0.994580 val: 0.955793 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({1: 3924, 0: 2859, 2: 2347})

Epoch :  28 loss training:  6.324052281910554 Time :  5655
accuracy train: 0.994749 val: 0.952744 test: 0.950584
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({1: 3928, 0: 2864, 2: 2338})

Epoch :  29 loss training:  5.834128694143146 Time :  5680
accuracy train: 0.995596 val: 0.952744 test: 0.949805
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({0: 3928, 1: 2864, 2: 2338})

Epoch :  30 loss training:  5.931459071580321 Time :  5712
accuracy train: 0.994580 val: 0.952744 test: 0.948638
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({1: 3929, 2: 2865, 0: 2336})

Epoch :  31 loss training:  5.78531705820933 Time :  5745
accuracy train: 0.995088 val: 0.954268 test: 0.949027
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({0: 3932, 2: 2863, 1: 2335})

Epoch :  32 loss training:  5.561215205700137 Time :  5773
accuracy train: 0.995427 val: 0.955793 test: 0.949416
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({1: 3934, 2: 2862, 0: 2334})

Epoch :  33 loss training:  5.2011010616552085 Time :  5796
accuracy train: 0.995427 val: 0.954268 test: 0.947860
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({1: 3934, 0: 2862, 2: 2334})

Epoch :  34 loss training:  5.1594801931642 Time :  5819
accuracy train: 0.995257 val: 0.954268 test: 0.949416
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({1: 3935, 2: 2860, 0: 2335})

Epoch :  35 loss training:  4.808825101470575 Time :  5850
accuracy train: 0.995257 val: 0.951220 test: 0.949805
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({1: 3935, 0: 2860, 2: 2335})

Epoch :  36 loss training:  4.932689382694662 Time :  5882
accuracy train: 0.995596 val: 0.954268 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({1: 3935, 2: 2860, 0: 2335})

Epoch :  37 loss training:  4.867358267423697 Time :  5912
accuracy train: 0.995596 val: 0.951220 test: 0.947082
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({2: 3934, 1: 2859, 0: 2337})

Epoch :  38 loss training:  4.638741553411819 Time :  5940
accuracy train: 0.996443 val: 0.952744 test: 0.951751
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({0: 3936, 2: 2863, 1: 2331})

Epoch :  39 loss training:  4.463527648593299 Time :  5966
accuracy train: 0.995766 val: 0.954268 test: 0.951751
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({1: 3936, 0: 2865, 2: 2329})

Epoch :  40 loss training:  4.084989605937153 Time :  5996
accuracy train: 0.996443 val: 0.952744 test: 0.949416
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({0: 3936, 1: 2865, 2: 2329})

Epoch :  41 loss training:  4.137005105789285 Time :  6024
accuracy train: 0.996274 val: 0.952744 test: 0.950973
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({1: 3937, 2: 2871, 0: 2322})

Epoch :  42 loss training:  4.305086410488002 Time :  6055
accuracy train: 0.996274 val: 0.951220 test: 0.952140
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({1: 3936, 2: 2877, 0: 2317})

Epoch :  43 loss training:  3.642187930177897 Time :  6081
accuracy train: 0.996443 val: 0.948171 test: 0.951362
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({0: 3936, 2: 2877, 1: 2317})

Epoch :  44 loss training:  3.8381867548450828 Time :  6107
accuracy train: 0.996443 val: 0.952744 test: 0.947860
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({1: 3936, 2: 2877, 0: 2317})

Epoch :  45 loss training:  3.5214657885953784 Time :  6135
accuracy train: 0.996951 val: 0.948171 test: 0.949805
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({0: 3936, 1: 2876, 2: 2318})

Epoch :  46 loss training:  3.7367596473777667 Time :  6163
accuracy train: 0.996782 val: 0.954268 test: 0.951751
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({0: 3935, 2: 2875, 1: 2320})

Epoch :  47 loss training:  3.3231118569383398 Time :  6188
accuracy train: 0.996782 val: 0.952744 test: 0.948249
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({2: 3935, 1: 2875, 0: 2320})

Epoch :  48 loss training:  3.6135587401804514 Time :  6212
accuracy train: 0.997121 val: 0.951220 test: 0.949805
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({0: 3934, 1: 2876, 2: 2320})

Epoch :  49 loss training:  3.3377277353429236 Time :  6239
accuracy train: 0.996951 val: 0.955793 test: 0.950584
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({1: 3943, 0: 2871, 2: 2316})

Epoch :  50 loss training:  3.0773446196108125 Time :  6265
accuracy train: 0.996612 val: 0.949695 test: 0.952140
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({1: 3943, 2: 2870, 0: 2317})

Epoch :  51 loss training:  3.543857639306225 Time :  6288
accuracy train: 0.996612 val: 0.955793 test: 0.950973
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({0: 3943, 1: 2871, 2: 2316})

Epoch :  52 loss training:  3.045371091575362 Time :  6314
accuracy train: 0.996951 val: 0.949695 test: 0.949805
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({2: 3942, 1: 2873, 0: 2315})

Epoch :  53 loss training:  3.002882158034481 Time :  6344
accuracy train: 0.996612 val: 0.952744 test: 0.950584
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({0: 3942, 2: 2869, 1: 2319})

Epoch :  54 loss training:  2.5537750162475277 Time :  6370
accuracy train: 0.996612 val: 0.951220 test: 0.949027
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({0: 3942, 2: 2869, 1: 2319})

Epoch :  55 loss training:  2.9087301806139294 Time :  6395
accuracy train: 0.996612 val: 0.948171 test: 0.949416
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({1: 3942, 2: 2869, 0: 2319})

Epoch :  56 loss training:  3.1025726506486535 Time :  6421
accuracy train: 0.996782 val: 0.952744 test: 0.948638
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.949027
Counter({1: 3942, 0: 2869, 2: 2319})

========================================================================================================================================================================================================
max acc epoch :  25
max validation accuracy :  0.9603658536585366
test accuracy :  0.9490272373540856
last test_accuracy :  0.9486381322957198
max gap 13
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=946, weight_decay=1e-10)
device :  cuda:0
Counter({0: 5412, 1: 2503, 2: 1215})

Epoch :  1 loss training:  124.00533419847488 Time :  6457
accuracy train: 0.891768 val: 0.882622 test: 0.888716
max validation accuracy : 0.882622 max acc epoch : 1 test accuracy : 0.888716
Counter({1: 3561, 0: 2933, 2: 2636})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.30039020255208 Time :  6485
accuracy train: 0.942581 val: 0.917683 test: 0.910506
max validation accuracy : 0.917683 max acc epoch : 2 test accuracy : 0.910506
Counter({0: 3707, 1: 2880, 2: 2543})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  36.353224121034145 Time :  6509
accuracy train: 0.956301 val: 0.922256 test: 0.922957
max validation accuracy : 0.922256 max acc epoch : 3 test accuracy : 0.922957
Counter({1: 3792, 2: 2912, 0: 2426})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  26.086821066215634 Time :  6538
accuracy train: 0.959180 val: 0.923780 test: 0.933074
max validation accuracy : 0.923780 max acc epoch : 4 test accuracy : 0.933074
Counter({1: 3795, 2: 2931, 0: 2404})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  22.52283113449812 Time :  6568
accuracy train: 0.971883 val: 0.932927 test: 0.939300
max validation accuracy : 0.932927 max acc epoch : 5 test accuracy : 0.939300
Counter({1: 3837, 2: 2907, 0: 2386})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  26.469586921855807 Time :  6603
accuracy train: 0.961213 val: 0.923780 test: 0.925681
max validation accuracy : 0.932927 max acc epoch : 5 test accuracy : 0.939300
Counter({0: 3836, 2: 2930, 1: 2364})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  21.981934579089284 Time :  6629
accuracy train: 0.980522 val: 0.935976 test: 0.936965
max validation accuracy : 0.935976 max acc epoch : 7 test accuracy : 0.936965
Counter({2: 3858, 1: 2918, 0: 2354})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  18.0213184915483 Time :  6656
accuracy train: 0.980183 val: 0.943598 test: 0.947082
max validation accuracy : 0.943598 max acc epoch : 8 test accuracy : 0.947082
Counter({1: 3861, 2: 2910, 0: 2359})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  16.754894386976957 Time :  6688
accuracy train: 0.984587 val: 0.943598 test: 0.947471
max validation accuracy : 0.943598 max acc epoch : 8 test accuracy : 0.947082
Counter({0: 3869, 1: 2908, 2: 2353})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  14.57874178653583 Time :  6713
accuracy train: 0.985095 val: 0.949695 test: 0.949027
max validation accuracy : 0.949695 max acc epoch : 10 test accuracy : 0.949027
Counter({0: 3875, 2: 2897, 1: 2358})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  13.187852133996785 Time :  6736
accuracy train: 0.988991 val: 0.949695 test: 0.948249
max validation accuracy : 0.949695 max acc epoch : 10 test accuracy : 0.949027
Counter({0: 3878, 2: 2890, 1: 2362})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  12.802415356040001 Time :  6764
accuracy train: 0.989499 val: 0.958841 test: 0.949027
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({0: 3884, 1: 2884, 2: 2362})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  11.878339883638546 Time :  6795
accuracy train: 0.989837 val: 0.951220 test: 0.943580
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({2: 3885, 0: 2883, 1: 2362})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  10.894406937528402 Time :  6822
accuracy train: 0.988821 val: 0.957317 test: 0.948249
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({2: 3887, 0: 2883, 1: 2360})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  10.846429001539946 Time :  6851
accuracy train: 0.989837 val: 0.951220 test: 0.948249
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({0: 3888, 2: 2882, 1: 2360})

Epoch :  16 loss training:  10.681717176921666 Time :  6877
accuracy train: 0.989499 val: 0.951220 test: 0.949805
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({1: 3888, 0: 2882, 2: 2360})

Epoch :  17 loss training:  10.346818095538765 Time :  6901
accuracy train: 0.990515 val: 0.951220 test: 0.948249
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({1: 3890, 2: 2881, 0: 2359})

Epoch :  18 loss training:  9.691110393963754 Time :  6931
accuracy train: 0.991192 val: 0.954268 test: 0.949416
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({1: 3892, 2: 2878, 0: 2360})

Epoch :  19 loss training:  9.198675772175193 Time :  6957
accuracy train: 0.992209 val: 0.951220 test: 0.948638
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({2: 3898, 0: 2875, 1: 2357})

Epoch :  20 loss training:  9.087870363611728 Time :  6983
accuracy train: 0.992547 val: 0.951220 test: 0.949416
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({1: 3899, 0: 2875, 2: 2356})

Epoch :  21 loss training:  9.356545902322978 Time :  7007
accuracy train: 0.992039 val: 0.951220 test: 0.949805
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({0: 3902, 1: 2875, 2: 2353})

Epoch :  22 loss training:  8.079366449266672 Time :  7035
accuracy train: 0.993394 val: 0.951220 test: 0.947860
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({0: 3902, 1: 2876, 2: 2352})

Epoch :  23 loss training:  8.125306655652821 Time :  7061
accuracy train: 0.992039 val: 0.946646 test: 0.948638
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({1: 3902, 2: 2876, 0: 2352})

Epoch :  24 loss training:  8.619833821896464 Time :  7093
accuracy train: 0.994072 val: 0.952744 test: 0.949805
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({1: 3904, 0: 2877, 2: 2349})

Epoch :  25 loss training:  7.689767065458 Time :  7118
accuracy train: 0.993225 val: 0.955793 test: 0.947471
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({1: 3906, 0: 2876, 2: 2348})

Epoch :  26 loss training:  7.274592588655651 Time :  7148
accuracy train: 0.993733 val: 0.951220 test: 0.950584
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({2: 3907, 1: 2876, 0: 2347})

Epoch :  27 loss training:  7.234542136546224 Time :  7178
accuracy train: 0.994072 val: 0.954268 test: 0.949805
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({0: 3910, 1: 2874, 2: 2346})

Epoch :  28 loss training:  6.630521566839889 Time :  7203
accuracy train: 0.994580 val: 0.952744 test: 0.949805
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({0: 3914, 2: 2876, 1: 2340})

Epoch :  29 loss training:  6.402460013749078 Time :  7228
accuracy train: 0.994919 val: 0.951220 test: 0.949027
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({1: 3916, 2: 2875, 0: 2339})

Epoch :  30 loss training:  6.601299019996077 Time :  7264
accuracy train: 0.994411 val: 0.951220 test: 0.950584
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({0: 3916, 1: 2877, 2: 2337})

Epoch :  31 loss training:  6.23654065746814 Time :  7290
accuracy train: 0.994919 val: 0.951220 test: 0.950584
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({1: 3919, 0: 2874, 2: 2337})

Epoch :  32 loss training:  6.082861537812278 Time :  7315
accuracy train: 0.994919 val: 0.955793 test: 0.949416
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({1: 3920, 0: 2873, 2: 2337})

Epoch :  33 loss training:  5.582925624679774 Time :  7345
accuracy train: 0.995427 val: 0.951220 test: 0.951751
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({2: 3921, 0: 2874, 1: 2335})

Epoch :  34 loss training:  5.698634583270177 Time :  7372
accuracy train: 0.995257 val: 0.951220 test: 0.950584
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({2: 3923, 1: 2874, 0: 2333})

Epoch :  35 loss training:  5.045784382382408 Time :  7398
accuracy train: 0.995257 val: 0.955793 test: 0.950584
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({1: 3923, 2: 2875, 0: 2332})

Epoch :  36 loss training:  5.26067878480535 Time :  7426
accuracy train: 0.995257 val: 0.954268 test: 0.950973
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({0: 3923, 2: 2875, 1: 2332})

Epoch :  37 loss training:  5.17421545390971 Time :  7457
accuracy train: 0.995257 val: 0.952744 test: 0.951751
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({1: 3923, 2: 2876, 0: 2331})

Epoch :  38 loss training:  4.993389283074066 Time :  7483
accuracy train: 0.996274 val: 0.952744 test: 0.950584
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({0: 3925, 2: 2878, 1: 2327})

Epoch :  39 loss training:  4.644655448384583 Time :  7513
accuracy train: 0.995596 val: 0.949695 test: 0.950973
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({1: 3925, 2: 2878, 0: 2327})

Epoch :  40 loss training:  4.490078934468329 Time :  7542
accuracy train: 0.995596 val: 0.951220 test: 0.950973
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({0: 3925, 2: 2878, 1: 2327})

Epoch :  41 loss training:  4.205556009314023 Time :  7570
accuracy train: 0.995596 val: 0.952744 test: 0.950195
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({1: 3925, 0: 2880, 2: 2325})

Epoch :  42 loss training:  4.759529463713989 Time :  7599
accuracy train: 0.996274 val: 0.943598 test: 0.951751
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({1: 3924, 2: 2882, 0: 2324})

Epoch :  43 loss training:  3.98555495752953 Time :  7636
accuracy train: 0.996443 val: 0.954268 test: 0.951751
max validation accuracy : 0.958841 max acc epoch : 12 test accuracy : 0.949027
Counter({1: 3924, 0: 2882, 2: 2324})

========================================================================================================================================================================================================
max acc epoch :  12
max validation accuracy :  0.9588414634146342
test accuracy :  0.9490272373540856
last test_accuracy :  0.9517509727626459
max gap 2
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=946, weight_decay=1e-10)
device :  cuda:0
Counter({1: 5412, 2: 2503, 0: 1215})

Epoch :  1 loss training:  123.90634454786777 Time :  7670
accuracy train: 0.893123 val: 0.876524 test: 0.887938
max validation accuracy : 0.876524 max acc epoch : 1 test accuracy : 0.887938
Counter({1: 3570, 0: 2974, 2: 2586})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.62341671809554 Time :  7698
accuracy train: 0.940888 val: 0.913110 test: 0.905447
max validation accuracy : 0.913110 max acc epoch : 2 test accuracy : 0.905447
Counter({1: 3768, 2: 2889, 0: 2473})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  38.614586405456066 Time :  7726
accuracy train: 0.945799 val: 0.922256 test: 0.917510
max validation accuracy : 0.922256 max acc epoch : 3 test accuracy : 0.917510
Counter({0: 3853, 1: 2876, 2: 2401})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  34.90260972827673 Time :  7757
accuracy train: 0.950542 val: 0.910061 test: 0.929183
max validation accuracy : 0.922256 max acc epoch : 3 test accuracy : 0.917510
Counter({1: 3842, 2: 2884, 0: 2404})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  28.245276372879744 Time :  7782
accuracy train: 0.967818 val: 0.940549 test: 0.938132
max validation accuracy : 0.940549 max acc epoch : 5 test accuracy : 0.938132
Counter({0: 3859, 1: 2864, 2: 2407})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  25.028811821714044 Time :  7805
accuracy train: 0.962568 val: 0.928354 test: 0.936187
max validation accuracy : 0.940549 max acc epoch : 5 test accuracy : 0.938132
Counter({0: 3848, 1: 2892, 2: 2390})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  18.55382307060063 Time :  7828
accuracy train: 0.981877 val: 0.939024 test: 0.939300
max validation accuracy : 0.940549 max acc epoch : 5 test accuracy : 0.938132
Counter({1: 3873, 0: 2892, 2: 2365})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  16.283205144573003 Time :  7858
accuracy train: 0.983401 val: 0.945122 test: 0.947860
max validation accuracy : 0.945122 max acc epoch : 8 test accuracy : 0.947860
Counter({0: 3885, 2: 2876, 1: 2369})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  14.22667308151722 Time :  7889
accuracy train: 0.985095 val: 0.946646 test: 0.947082
max validation accuracy : 0.946646 max acc epoch : 9 test accuracy : 0.947082
Counter({1: 3888, 2: 2875, 0: 2367})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  12.4428494295571 Time :  7916
accuracy train: 0.987297 val: 0.948171 test: 0.951751
max validation accuracy : 0.948171 max acc epoch : 10 test accuracy : 0.951751
Counter({2: 3891, 0: 2871, 1: 2368})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  12.068951662629843 Time :  7945
accuracy train: 0.988821 val: 0.951220 test: 0.948249
max validation accuracy : 0.951220 max acc epoch : 11 test accuracy : 0.948249
Counter({2: 3896, 0: 2865, 1: 2369})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  11.363892626948655 Time :  7976
accuracy train: 0.989499 val: 0.954268 test: 0.947471
max validation accuracy : 0.954268 max acc epoch : 12 test accuracy : 0.947471
Counter({0: 3899, 2: 2862, 1: 2369})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  10.717704582493752 Time :  8001
accuracy train: 0.989160 val: 0.949695 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 12 test accuracy : 0.947471
Counter({2: 3899, 0: 2862, 1: 2369})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  10.004575048573315 Time :  8028
accuracy train: 0.989668 val: 0.954268 test: 0.947082
max validation accuracy : 0.954268 max acc epoch : 12 test accuracy : 0.947471
Counter({1: 3899, 0: 2862, 2: 2369})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  9.958806571550667 Time :  8058
accuracy train: 0.990007 val: 0.952744 test: 0.946304
max validation accuracy : 0.954268 max acc epoch : 12 test accuracy : 0.947471
Counter({0: 3901, 2: 2861, 1: 2368})

Epoch :  16 loss training:  9.70153820188716 Time :  8086
accuracy train: 0.989668 val: 0.951220 test: 0.949416
max validation accuracy : 0.954268 max acc epoch : 12 test accuracy : 0.947471
Counter({0: 3901, 1: 2861, 2: 2368})

Epoch :  17 loss training:  9.569811629131436 Time :  8114
accuracy train: 0.990515 val: 0.952744 test: 0.947082
max validation accuracy : 0.954268 max acc epoch : 12 test accuracy : 0.947471
Counter({0: 3902, 1: 2861, 2: 2367})

Epoch :  18 loss training:  8.907118533505127 Time :  8139
accuracy train: 0.990346 val: 0.952744 test: 0.949416
max validation accuracy : 0.954268 max acc epoch : 12 test accuracy : 0.947471
Counter({0: 3904, 2: 2859, 1: 2367})

Epoch :  19 loss training:  8.323270526248962 Time :  8164
accuracy train: 0.992547 val: 0.949695 test: 0.950195
max validation accuracy : 0.954268 max acc epoch : 12 test accuracy : 0.947471
Counter({0: 3906, 1: 2858, 2: 2366})

Epoch :  20 loss training:  8.080953880213201 Time :  8190
accuracy train: 0.992886 val: 0.946646 test: 0.950584
max validation accuracy : 0.954268 max acc epoch : 12 test accuracy : 0.947471
Counter({0: 3907, 2: 2858, 1: 2365})

Epoch :  21 loss training:  8.591204009950161 Time :  8221
accuracy train: 0.992886 val: 0.949695 test: 0.946693
max validation accuracy : 0.954268 max acc epoch : 12 test accuracy : 0.947471
Counter({1: 3908, 0: 2858, 2: 2364})

Epoch :  22 loss training:  7.740047269035131 Time :  8254
accuracy train: 0.994072 val: 0.955793 test: 0.945914
max validation accuracy : 0.955793 max acc epoch : 22 test accuracy : 0.945914
Counter({2: 3910, 0: 2857, 1: 2363})

Epoch :  23 loss training:  6.969045259524137 Time :  8289
accuracy train: 0.993394 val: 0.952744 test: 0.948638
max validation accuracy : 0.955793 max acc epoch : 22 test accuracy : 0.945914
Counter({1: 3911, 2: 2855, 0: 2364})

Epoch :  24 loss training:  7.918932968750596 Time :  8315
accuracy train: 0.994241 val: 0.951220 test: 0.949027
max validation accuracy : 0.955793 max acc epoch : 22 test accuracy : 0.945914
Counter({2: 3911, 0: 2857, 1: 2362})

Epoch :  25 loss training:  7.318702556192875 Time :  8342
accuracy train: 0.993902 val: 0.957317 test: 0.947860
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({2: 3916, 0: 2855, 1: 2359})

Epoch :  26 loss training:  6.9768656441010535 Time :  8379
accuracy train: 0.994411 val: 0.951220 test: 0.949805
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({0: 3918, 2: 2855, 1: 2357})

Epoch :  27 loss training:  6.566517069004476 Time :  8406
accuracy train: 0.994072 val: 0.955793 test: 0.949027
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3919, 0: 2856, 2: 2355})

Epoch :  28 loss training:  6.230243115918711 Time :  8434
accuracy train: 0.994411 val: 0.951220 test: 0.950973
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({0: 3922, 2: 2856, 1: 2352})

Epoch :  29 loss training:  5.830289237201214 Time :  8462
accuracy train: 0.995257 val: 0.949695 test: 0.949416
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({0: 3921, 2: 2856, 1: 2353})

Epoch :  30 loss training:  5.938498735893518 Time :  8494
accuracy train: 0.994580 val: 0.948171 test: 0.948249
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3924, 0: 2856, 2: 2350})

Epoch :  31 loss training:  5.85795737686567 Time :  8525
accuracy train: 0.995088 val: 0.952744 test: 0.949416
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3925, 0: 2855, 2: 2350})

Epoch :  32 loss training:  5.558870893204585 Time :  8554
accuracy train: 0.995257 val: 0.952744 test: 0.948638
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({0: 3925, 1: 2855, 2: 2350})

Epoch :  33 loss training:  5.260704709799029 Time :  8587
accuracy train: 0.995427 val: 0.954268 test: 0.948638
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3926, 2: 2855, 0: 2349})

Epoch :  34 loss training:  5.1374284971971065 Time :  8624
accuracy train: 0.995596 val: 0.952744 test: 0.948638
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3927, 2: 2854, 0: 2349})

Epoch :  35 loss training:  4.777476953808218 Time :  8657
accuracy train: 0.995427 val: 0.955793 test: 0.951362
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({2: 3927, 1: 2854, 0: 2349})

Epoch :  36 loss training:  5.003076320979744 Time :  8685
accuracy train: 0.995427 val: 0.952744 test: 0.949416
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3928, 0: 2855, 2: 2347})

Epoch :  37 loss training:  4.746399997500703 Time :  8710
accuracy train: 0.995088 val: 0.951220 test: 0.946693
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3929, 2: 2854, 0: 2347})

Epoch :  38 loss training:  4.573230517562479 Time :  8746
accuracy train: 0.996274 val: 0.951220 test: 0.949805
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({2: 3929, 0: 2857, 1: 2344})

Epoch :  39 loss training:  4.549650468863547 Time :  8774
accuracy train: 0.995935 val: 0.952744 test: 0.950584
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3929, 2: 2859, 0: 2342})

Epoch :  40 loss training:  4.191174412379041 Time :  8809
accuracy train: 0.995935 val: 0.951220 test: 0.948638
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({0: 3930, 1: 2859, 2: 2341})

Epoch :  41 loss training:  3.9890043338527903 Time :  8839
accuracy train: 0.996104 val: 0.949695 test: 0.950973
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3930, 0: 2862, 2: 2338})

Epoch :  42 loss training:  4.252520891837776 Time :  8863
accuracy train: 0.996443 val: 0.951220 test: 0.949027
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({0: 3930, 2: 2865, 1: 2335})

Epoch :  43 loss training:  3.7102288173045963 Time :  8888
accuracy train: 0.996104 val: 0.952744 test: 0.949027
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({0: 3930, 2: 2865, 1: 2335})

Epoch :  44 loss training:  3.9422009472036734 Time :  8914
accuracy train: 0.996274 val: 0.949695 test: 0.948638
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({2: 3931, 1: 2866, 0: 2333})

Epoch :  45 loss training:  3.4097391793038696 Time :  8938
accuracy train: 0.996951 val: 0.951220 test: 0.947082
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3931, 2: 2866, 0: 2333})

Epoch :  46 loss training:  3.5853269076906145 Time :  8972
accuracy train: 0.996951 val: 0.952744 test: 0.948638
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({0: 3931, 2: 2865, 1: 2334})

Epoch :  47 loss training:  3.2953226608224213 Time :  9004
accuracy train: 0.996782 val: 0.952744 test: 0.947471
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3931, 2: 2865, 0: 2334})

Epoch :  48 loss training:  3.7372213636990637 Time :  9031
accuracy train: 0.996951 val: 0.954268 test: 0.948249
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({0: 3930, 2: 2866, 1: 2334})

Epoch :  49 loss training:  3.48909843940055 Time :  9063
accuracy train: 0.996951 val: 0.955793 test: 0.950195
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({0: 3928, 2: 2866, 1: 2336})

Epoch :  50 loss training:  3.145376387925353 Time :  9094
accuracy train: 0.996951 val: 0.952744 test: 0.949805
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3928, 0: 2866, 2: 2336})

Epoch :  51 loss training:  3.381431253044866 Time :  9121
accuracy train: 0.996443 val: 0.954268 test: 0.949805
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({2: 3928, 1: 2867, 0: 2335})

Epoch :  52 loss training:  3.1155127676320262 Time :  9148
accuracy train: 0.996782 val: 0.951220 test: 0.949416
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3928, 0: 2868, 2: 2334})

Epoch :  53 loss training:  3.160642172442749 Time :  9175
accuracy train: 0.996612 val: 0.951220 test: 0.947860
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({0: 3928, 2: 2866, 1: 2336})

Epoch :  54 loss training:  2.5831626777071506 Time :  9204
accuracy train: 0.996782 val: 0.951220 test: 0.950584
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({1: 3928, 2: 2866, 0: 2336})

Epoch :  55 loss training:  2.8890273158904165 Time :  9227
accuracy train: 0.996782 val: 0.951220 test: 0.949416
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({2: 3928, 0: 2866, 1: 2336})

Epoch :  56 loss training:  3.027706404449418 Time :  9252
accuracy train: 0.996782 val: 0.957317 test: 0.948638
max validation accuracy : 0.957317 max acc epoch : 25 test accuracy : 0.947860
Counter({0: 3928, 2: 2868, 1: 2334})

========================================================================================================================================================================================================
max acc epoch :  25
max validation accuracy :  0.9573170731707317
test accuracy :  0.9478599221789883
last test_accuracy :  0.9486381322957198
max gap 10
========================================================================================================================================================================================================

itr : 6
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=946, weight_decay=1e-10)
device :  cuda:0
Counter({1: 5412, 2: 2503, 0: 1215})

Epoch :  1 loss training:  124.0316430926323 Time :  9291
accuracy train: 0.892785 val: 0.879573 test: 0.885992
max validation accuracy : 0.879573 max acc epoch : 1 test accuracy : 0.885992
Counter({1: 3578, 2: 2944, 0: 2608})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.32001256197691 Time :  9318
accuracy train: 0.942412 val: 0.919207 test: 0.907004
max validation accuracy : 0.919207 max acc epoch : 2 test accuracy : 0.907004
Counter({0: 3773, 2: 2878, 1: 2479})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  36.85736130923033 Time :  9343
accuracy train: 0.952575 val: 0.925305 test: 0.924125
max validation accuracy : 0.925305 max acc epoch : 3 test accuracy : 0.924125
Counter({1: 3851, 2: 2880, 0: 2399})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  31.373955573886633 Time :  9368
accuracy train: 0.949864 val: 0.913110 test: 0.932296
max validation accuracy : 0.925305 max acc epoch : 3 test accuracy : 0.924125
Counter({1: 3833, 2: 2900, 0: 2397})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  28.444941125810146 Time :  9399
accuracy train: 0.968157 val: 0.934451 test: 0.934241
max validation accuracy : 0.934451 max acc epoch : 5 test accuracy : 0.934241
Counter({1: 3863, 2: 2867, 0: 2400})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  25.629909666255116 Time :  9430
accuracy train: 0.962907 val: 0.928354 test: 0.930739
max validation accuracy : 0.934451 max acc epoch : 5 test accuracy : 0.934241
Counter({2: 3863, 1: 2884, 0: 2383})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  19.665021302178502 Time :  9456
accuracy train: 0.979336 val: 0.935976 test: 0.933463
max validation accuracy : 0.935976 max acc epoch : 7 test accuracy : 0.933463
Counter({1: 3886, 0: 2882, 2: 2362})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  17.043764902744442 Time :  9480
accuracy train: 0.982724 val: 0.945122 test: 0.947471
max validation accuracy : 0.945122 max acc epoch : 8 test accuracy : 0.947471
Counter({2: 3890, 1: 2877, 0: 2363})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  14.954454134218395 Time :  9508
accuracy train: 0.983401 val: 0.939024 test: 0.943580
max validation accuracy : 0.945122 max acc epoch : 8 test accuracy : 0.947471
Counter({0: 3893, 2: 2875, 1: 2362})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  13.182091253111139 Time :  9537
accuracy train: 0.985434 val: 0.945122 test: 0.949416
max validation accuracy : 0.945122 max acc epoch : 8 test accuracy : 0.947471
Counter({1: 3897, 2: 2870, 0: 2363})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  12.10576905310154 Time :  9562
accuracy train: 0.987127 val: 0.949695 test: 0.947471
max validation accuracy : 0.949695 max acc epoch : 11 test accuracy : 0.947471
Counter({2: 3903, 1: 2864, 0: 2363})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  11.682428860571235 Time :  9586
accuracy train: 0.988991 val: 0.952744 test: 0.947471
max validation accuracy : 0.952744 max acc epoch : 12 test accuracy : 0.947471
Counter({1: 3907, 0: 2861, 2: 2362})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  10.785657402593642 Time :  9617
accuracy train: 0.989329 val: 0.942073 test: 0.949027
max validation accuracy : 0.952744 max acc epoch : 12 test accuracy : 0.947471
Counter({0: 3908, 2: 2862, 1: 2360})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  10.487988273613155 Time :  9678
accuracy train: 0.988652 val: 0.946646 test: 0.949416
max validation accuracy : 0.952744 max acc epoch : 12 test accuracy : 0.947471
Counter({0: 3908, 1: 2862, 2: 2360})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  10.290543651673943 Time :  9704
accuracy train: 0.988821 val: 0.948171 test: 0.948249
max validation accuracy : 0.952744 max acc epoch : 12 test accuracy : 0.947471
Counter({0: 3909, 1: 2862, 2: 2359})

Epoch :  16 loss training:  10.623320086393505 Time :  9737
accuracy train: 0.989837 val: 0.951220 test: 0.949805
max validation accuracy : 0.952744 max acc epoch : 12 test accuracy : 0.947471
Counter({0: 3910, 2: 2862, 1: 2358})

Epoch :  17 loss training:  9.636176244355738 Time :  9770
accuracy train: 0.990346 val: 0.945122 test: 0.945525
max validation accuracy : 0.952744 max acc epoch : 12 test accuracy : 0.947471
Counter({2: 3911, 1: 2862, 0: 2357})

Epoch :  18 loss training:  8.916693067643791 Time :  9799
accuracy train: 0.990684 val: 0.946646 test: 0.948638
max validation accuracy : 0.952744 max acc epoch : 12 test accuracy : 0.947471
Counter({0: 3912, 2: 2863, 1: 2355})

Epoch :  19 loss training:  9.070610005874187 Time :  9826
accuracy train: 0.992209 val: 0.946646 test: 0.949027
max validation accuracy : 0.952744 max acc epoch : 12 test accuracy : 0.947471
Counter({2: 3913, 0: 2862, 1: 2355})

Epoch :  20 loss training:  8.556331153959036 Time :  9851
accuracy train: 0.992547 val: 0.943598 test: 0.950973
max validation accuracy : 0.952744 max acc epoch : 12 test accuracy : 0.947471
Counter({0: 3915, 2: 2861, 1: 2354})

Epoch :  21 loss training:  8.464366694446653 Time :  9889
accuracy train: 0.992378 val: 0.948171 test: 0.948249
max validation accuracy : 0.952744 max acc epoch : 12 test accuracy : 0.947471
Counter({1: 3917, 0: 2866, 2: 2347})

Epoch :  22 loss training:  8.432427301071584 Time :  9919
accuracy train: 0.992886 val: 0.949695 test: 0.948249
max validation accuracy : 0.952744 max acc epoch : 12 test accuracy : 0.947471
Counter({2: 3918, 0: 2865, 1: 2347})

Epoch :  23 loss training:  7.770081786438823 Time :  9951
accuracy train: 0.992378 val: 0.945122 test: 0.947082
max validation accuracy : 0.952744 max acc epoch : 12 test accuracy : 0.947471
Counter({0: 3918, 2: 2865, 1: 2347})

Epoch :  24 loss training:  7.5101433461532 Time :  9985
accuracy train: 0.994241 val: 0.945122 test: 0.950195
max validation accuracy : 0.952744 max acc epoch : 12 test accuracy : 0.947471
Counter({2: 3918, 0: 2865, 1: 2347})

Epoch :  25 loss training:  7.084688215982169 Time :  10015
accuracy train: 0.993056 val: 0.948171 test: 0.947082
max validation accuracy : 0.952744 max acc epoch : 12 test accuracy : 0.947471
Counter({1: 3920, 2: 2863, 0: 2347})

Epoch :  26 loss training:  7.048432246316224 Time :  10043
accuracy train: 0.993394 val: 0.951220 test: 0.951362
max validation accuracy : 0.952744 max acc epoch : 12 test accuracy : 0.947471
Counter({1: 3921, 2: 2863, 0: 2346})

Epoch :  27 loss training:  6.83237443678081 Time :  10073
accuracy train: 0.993733 val: 0.948171 test: 0.950584
max validation accuracy : 0.952744 max acc epoch : 12 test accuracy : 0.947471
Counter({1: 3921, 2: 2864, 0: 2345})

Epoch :  28 loss training:  5.923048431519419 Time :  10105
accuracy train: 0.994919 val: 0.945122 test: 0.950195
max validation accuracy : 0.952744 max acc epoch : 12 test accuracy : 0.947471
Counter({0: 3922, 2: 2864, 1: 2344})

Epoch :  29 loss training:  6.430916967336088 Time :  10132
accuracy train: 0.995596 val: 0.951220 test: 0.949027
max validation accuracy : 0.952744 max acc epoch : 12 test accuracy : 0.947471
Counter({0: 3923, 2: 2863, 1: 2344})

Epoch :  30 loss training:  5.831468347227201 Time :  10163
accuracy train: 0.994919 val: 0.951220 test: 0.950973
max validation accuracy : 0.952744 max acc epoch : 12 test accuracy : 0.947471
Counter({1: 3931, 2: 2865, 0: 2334})

Epoch :  31 loss training:  6.079413088504225 Time :  10197
accuracy train: 0.994749 val: 0.954268 test: 0.947471
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({1: 3932, 0: 2865, 2: 2333})

Epoch :  32 loss training:  5.386767741641961 Time :  10224
accuracy train: 0.995088 val: 0.954268 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({0: 3932, 1: 2863, 2: 2335})

Epoch :  33 loss training:  5.542162623023614 Time :  10256
accuracy train: 0.995257 val: 0.951220 test: 0.948249
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({1: 3932, 0: 2863, 2: 2335})

Epoch :  34 loss training:  5.886813680874184 Time :  10291
accuracy train: 0.994919 val: 0.949695 test: 0.947471
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({1: 3932, 2: 2862, 0: 2336})

Epoch :  35 loss training:  5.011801310116425 Time :  10318
accuracy train: 0.995257 val: 0.949695 test: 0.948249
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({1: 3933, 2: 2861, 0: 2336})

Epoch :  36 loss training:  4.7584970449097455 Time :  10353
accuracy train: 0.995088 val: 0.951220 test: 0.948638
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({1: 3933, 0: 2861, 2: 2336})

Epoch :  37 loss training:  4.760878820321523 Time :  10383
accuracy train: 0.995427 val: 0.946646 test: 0.948249
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({0: 3933, 2: 2862, 1: 2335})

Epoch :  38 loss training:  4.498062969418243 Time :  10409
accuracy train: 0.996443 val: 0.946646 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({0: 3934, 2: 2862, 1: 2334})

Epoch :  39 loss training:  4.824067372595891 Time :  10435
accuracy train: 0.995596 val: 0.949695 test: 0.947471
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({0: 3934, 2: 2863, 1: 2333})

Epoch :  40 loss training:  4.352520529180765 Time :  10462
accuracy train: 0.995596 val: 0.946646 test: 0.946693
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({0: 3934, 2: 2864, 1: 2332})

Epoch :  41 loss training:  4.148358708480373 Time :  10494
accuracy train: 0.995596 val: 0.949695 test: 0.948638
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({1: 3935, 0: 2872, 2: 2323})

Epoch :  42 loss training:  3.8998458069982007 Time :  10522
accuracy train: 0.996104 val: 0.949695 test: 0.946693
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({1: 3934, 2: 2873, 0: 2323})

Epoch :  43 loss training:  4.288224732736126 Time :  10547
accuracy train: 0.996443 val: 0.952744 test: 0.947471
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({1: 3933, 0: 2874, 2: 2323})

Epoch :  44 loss training:  3.6896288960706443 Time :  10575
accuracy train: 0.996104 val: 0.951220 test: 0.948249
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({1: 3933, 0: 2875, 2: 2322})

Epoch :  45 loss training:  3.815017225802876 Time :  10610
accuracy train: 0.996782 val: 0.949695 test: 0.946693
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({0: 3934, 1: 2877, 2: 2319})

Epoch :  46 loss training:  3.6449962271144614 Time :  10640
accuracy train: 0.996612 val: 0.954268 test: 0.947860
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({0: 3934, 2: 2877, 1: 2319})

Epoch :  47 loss training:  3.5046137292520143 Time :  10666
accuracy train: 0.996612 val: 0.948171 test: 0.944747
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({1: 3933, 2: 2877, 0: 2320})

Epoch :  48 loss training:  3.2182519178604707 Time :  10689
accuracy train: 0.996951 val: 0.945122 test: 0.947082
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({0: 3933, 2: 2878, 1: 2319})

Epoch :  49 loss training:  3.378268077620305 Time :  10718
accuracy train: 0.996951 val: 0.951220 test: 0.948249
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({2: 3933, 0: 2880, 1: 2317})

Epoch :  50 loss training:  3.330929158721119 Time :  10744
accuracy train: 0.996782 val: 0.948171 test: 0.949805
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({1: 3934, 0: 2879, 2: 2317})

Epoch :  51 loss training:  3.092948456062004 Time :  10768
accuracy train: 0.996612 val: 0.952744 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({1: 3932, 2: 2880, 0: 2318})

Epoch :  52 loss training:  3.206412036670372 Time :  10795
accuracy train: 0.996782 val: 0.946646 test: 0.948249
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({1: 3934, 0: 2879, 2: 2317})

Epoch :  53 loss training:  3.4326915607089177 Time :  10818
accuracy train: 0.996782 val: 0.946646 test: 0.948638
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({0: 3934, 2: 2879, 1: 2317})

Epoch :  54 loss training:  2.943886263296008 Time :  10843
accuracy train: 0.996443 val: 0.946646 test: 0.947860
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({1: 3934, 2: 2879, 0: 2317})

Epoch :  55 loss training:  3.1665034701582044 Time :  10870
accuracy train: 0.996612 val: 0.946646 test: 0.947082
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({1: 3934, 0: 2882, 2: 2314})

Epoch :  56 loss training:  2.6818632525682915 Time :  10895
accuracy train: 0.996612 val: 0.949695 test: 0.947082
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({0: 3934, 1: 2883, 2: 2313})

Epoch :  57 loss training:  2.7580669606104493 Time :  10920
accuracy train: 0.996612 val: 0.942073 test: 0.946304
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({1: 3934, 2: 2885, 0: 2311})

Epoch :  58 loss training:  3.1402420636441093 Time :  10945
accuracy train: 0.996612 val: 0.949695 test: 0.947860
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({1: 3934, 2: 2887, 0: 2309})

Epoch :  59 loss training:  2.508600978704635 Time :  10968
accuracy train: 0.996612 val: 0.952744 test: 0.947471
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({1: 3934, 2: 2887, 0: 2309})

Epoch :  60 loss training:  2.6148437008378096 Time :  10995
accuracy train: 0.996612 val: 0.949695 test: 0.948638
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({1: 3934, 2: 2887, 0: 2309})

Epoch :  61 loss training:  2.841678642318584 Time :  11020
accuracy train: 0.997121 val: 0.948171 test: 0.948638
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({1: 3934, 0: 2887, 2: 2309})

Epoch :  62 loss training:  2.566870824317448 Time :  11044
accuracy train: 0.996612 val: 0.945122 test: 0.948638
max validation accuracy : 0.954268 max acc epoch : 31 test accuracy : 0.947471
Counter({1: 3934, 0: 2887, 2: 2309})

========================================================================================================================================================================================================
max acc epoch :  31
max validation accuracy :  0.9542682926829268
test accuracy :  0.9474708171206225
last test_accuracy :  0.9486381322957198
max gap 19
========================================================================================================================================================================================================

itr : 7
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=946, weight_decay=1e-10)
device :  cuda:0
Counter({1: 5412, 2: 2503, 0: 1215})

Epoch :  1 loss training:  123.90985745191574 Time :  11076
accuracy train: 0.892785 val: 0.876524 test: 0.885603
max validation accuracy : 0.876524 max acc epoch : 1 test accuracy : 0.885603
Counter({2: 3570, 0: 2956, 1: 2604})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.346380189061165 Time :  11098
accuracy train: 0.938178 val: 0.916159 test: 0.903502
max validation accuracy : 0.916159 max acc epoch : 2 test accuracy : 0.903502
Counter({1: 3740, 2: 2900, 0: 2490})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  38.33998769521713 Time :  11120
accuracy train: 0.945799 val: 0.917683 test: 0.915564
max validation accuracy : 0.917683 max acc epoch : 3 test accuracy : 0.915564
Counter({2: 3848, 0: 2884, 1: 2398})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  34.30843937583268 Time :  11145
accuracy train: 0.952066 val: 0.923780 test: 0.933463
max validation accuracy : 0.923780 max acc epoch : 4 test accuracy : 0.933463
Counter({1: 3850, 2: 2896, 0: 2384})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  27.859392633661628 Time :  11166
accuracy train: 0.969682 val: 0.939024 test: 0.938521
max validation accuracy : 0.939024 max acc epoch : 5 test accuracy : 0.938521
Counter({1: 3864, 0: 2875, 2: 2391})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  25.001202395185828 Time :  11188
accuracy train: 0.965278 val: 0.929878 test: 0.935019
max validation accuracy : 0.939024 max acc epoch : 5 test accuracy : 0.938521
Counter({1: 3869, 2: 2893, 0: 2368})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  19.349752550013363 Time :  11216
accuracy train: 0.981538 val: 0.935976 test: 0.937354
max validation accuracy : 0.939024 max acc epoch : 5 test accuracy : 0.938521
Counter({2: 3890, 1: 2890, 0: 2350})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  16.42283722385764 Time :  11240
accuracy train: 0.983570 val: 0.949695 test: 0.947860
max validation accuracy : 0.949695 max acc epoch : 8 test accuracy : 0.947860
Counter({1: 3893, 2: 2886, 0: 2351})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  14.681890728883445 Time :  11262
accuracy train: 0.984417 val: 0.943598 test: 0.947082
max validation accuracy : 0.949695 max acc epoch : 8 test accuracy : 0.947860
Counter({0: 3899, 2: 2886, 1: 2345})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  12.756550329271704 Time :  11284
accuracy train: 0.986619 val: 0.946646 test: 0.950584
max validation accuracy : 0.949695 max acc epoch : 8 test accuracy : 0.947860
Counter({1: 3908, 0: 2879, 2: 2343})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  12.04576201364398 Time :  11310
accuracy train: 0.989160 val: 0.952744 test: 0.949027
max validation accuracy : 0.952744 max acc epoch : 11 test accuracy : 0.949027
Counter({0: 3913, 2: 2875, 1: 2342})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  11.481230901088566 Time :  11335
accuracy train: 0.989329 val: 0.954268 test: 0.950195
max validation accuracy : 0.954268 max acc epoch : 12 test accuracy : 0.950195
Counter({1: 3917, 0: 2872, 2: 2341})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  10.55772526934743 Time :  11358
accuracy train: 0.989837 val: 0.942073 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 12 test accuracy : 0.950195
Counter({0: 3918, 2: 2871, 1: 2341})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  10.051181432791054 Time :  11386
accuracy train: 0.989668 val: 0.948171 test: 0.948249
max validation accuracy : 0.954268 max acc epoch : 12 test accuracy : 0.950195
Counter({0: 3918, 2: 2871, 1: 2341})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  10.150798238581046 Time :  11409
accuracy train: 0.990684 val: 0.943598 test: 0.946693
max validation accuracy : 0.954268 max acc epoch : 12 test accuracy : 0.950195
Counter({0: 3920, 2: 2870, 1: 2340})

Epoch :  16 loss training:  10.204302218277007 Time :  11433
accuracy train: 0.990346 val: 0.952744 test: 0.949416
max validation accuracy : 0.954268 max acc epoch : 12 test accuracy : 0.950195
Counter({1: 3920, 2: 2869, 0: 2341})

Epoch :  17 loss training:  9.194821774959564 Time :  11456
accuracy train: 0.991531 val: 0.946646 test: 0.948249
max validation accuracy : 0.954268 max acc epoch : 12 test accuracy : 0.950195
Counter({1: 3920, 2: 2870, 0: 2340})

Epoch :  18 loss training:  8.758741324301809 Time :  11481
accuracy train: 0.991701 val: 0.949695 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 12 test accuracy : 0.950195
Counter({2: 3921, 0: 2869, 1: 2340})

Epoch :  19 loss training:  8.801946316845715 Time :  11504
accuracy train: 0.992209 val: 0.951220 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 12 test accuracy : 0.950195
Counter({0: 3923, 2: 2868, 1: 2339})

Epoch :  20 loss training:  8.152643392328173 Time :  11528
accuracy train: 0.992886 val: 0.948171 test: 0.949805
max validation accuracy : 0.954268 max acc epoch : 12 test accuracy : 0.950195
Counter({2: 3924, 0: 2868, 1: 2338})

Epoch :  21 loss training:  8.032870465423912 Time :  11554
accuracy train: 0.992717 val: 0.952744 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 12 test accuracy : 0.950195
Counter({2: 3924, 0: 2869, 1: 2337})

Epoch :  22 loss training:  8.14619090850465 Time :  11576
accuracy train: 0.993056 val: 0.952744 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 12 test accuracy : 0.950195
Counter({1: 3925, 2: 2867, 0: 2338})

Epoch :  23 loss training:  7.908302060561255 Time :  11599
accuracy train: 0.993733 val: 0.951220 test: 0.945914
max validation accuracy : 0.954268 max acc epoch : 12 test accuracy : 0.950195
Counter({0: 3927, 2: 2867, 1: 2336})

Epoch :  24 loss training:  7.332276102621108 Time :  11621
accuracy train: 0.993733 val: 0.951220 test: 0.950195
max validation accuracy : 0.954268 max acc epoch : 12 test accuracy : 0.950195
Counter({1: 3928, 2: 2867, 0: 2335})

Epoch :  25 loss training:  6.824024173663929 Time :  11642
accuracy train: 0.993902 val: 0.954268 test: 0.949416
max validation accuracy : 0.954268 max acc epoch : 12 test accuracy : 0.950195
Counter({1: 3929, 2: 2867, 0: 2334})

Epoch :  26 loss training:  6.885530674830079 Time :  11665
accuracy train: 0.994411 val: 0.955793 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({1: 3931, 0: 2866, 2: 2333})

Epoch :  27 loss training:  6.644236590713263 Time :  11686
accuracy train: 0.994411 val: 0.948171 test: 0.949805
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({1: 3930, 0: 2868, 2: 2332})

Epoch :  28 loss training:  5.643383449641988 Time :  11707
accuracy train: 0.994580 val: 0.945122 test: 0.947082
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({1: 3932, 0: 2868, 2: 2330})

Epoch :  29 loss training:  6.192862382624298 Time :  11727
accuracy train: 0.995427 val: 0.955793 test: 0.949027
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({0: 3932, 2: 2868, 1: 2330})

Epoch :  30 loss training:  5.54570725816302 Time :  11747
accuracy train: 0.994919 val: 0.955793 test: 0.947860
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({1: 3934, 2: 2868, 0: 2328})

Epoch :  31 loss training:  5.646819477202371 Time :  11770
accuracy train: 0.995257 val: 0.952744 test: 0.947471
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({1: 3934, 0: 2869, 2: 2327})

Epoch :  32 loss training:  5.266382752568461 Time :  11792
accuracy train: 0.994919 val: 0.951220 test: 0.947082
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({1: 3935, 0: 2869, 2: 2326})

Epoch :  33 loss training:  5.341529750265181 Time :  11812
accuracy train: 0.995596 val: 0.954268 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({1: 3935, 0: 2869, 2: 2326})

Epoch :  34 loss training:  5.645162534550764 Time :  11832
accuracy train: 0.995596 val: 0.949695 test: 0.947082
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({1: 3935, 2: 2869, 0: 2326})

Epoch :  35 loss training:  4.970489260740578 Time :  11851
accuracy train: 0.995088 val: 0.951220 test: 0.947082
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({1: 3935, 2: 2870, 0: 2325})

Epoch :  36 loss training:  4.655309985391796 Time :  11873
accuracy train: 0.995427 val: 0.954268 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({1: 3935, 2: 2870, 0: 2325})

Epoch :  37 loss training:  4.5071551714790985 Time :  11893
accuracy train: 0.995596 val: 0.951220 test: 0.948249
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({0: 3935, 2: 2872, 1: 2323})

Epoch :  38 loss training:  4.482623115647584 Time :  11914
accuracy train: 0.996274 val: 0.946646 test: 0.949805
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({0: 3935, 1: 2874, 2: 2321})

Epoch :  39 loss training:  4.744180043577217 Time :  11934
accuracy train: 0.995766 val: 0.949695 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({1: 3935, 2: 2872, 0: 2323})

Epoch :  40 loss training:  4.274744721595198 Time :  11953
accuracy train: 0.996274 val: 0.951220 test: 0.949027
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({0: 3935, 1: 2871, 2: 2324})

Epoch :  41 loss training:  4.015252143377438 Time :  11974
accuracy train: 0.996104 val: 0.949695 test: 0.949805
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({1: 3937, 0: 2873, 2: 2320})

Epoch :  42 loss training:  3.7649377996567637 Time :  11994
accuracy train: 0.996443 val: 0.948171 test: 0.948638
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({1: 3936, 2: 2875, 0: 2319})

Epoch :  43 loss training:  4.040758966933936 Time :  12016
accuracy train: 0.996782 val: 0.952744 test: 0.948638
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({0: 3935, 2: 2875, 1: 2320})

Epoch :  44 loss training:  3.655008761677891 Time :  12042
accuracy train: 0.996274 val: 0.949695 test: 0.948249
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({1: 3935, 2: 2875, 0: 2320})

Epoch :  45 loss training:  3.7267588015529327 Time :  12067
accuracy train: 0.996951 val: 0.949695 test: 0.948249
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({0: 3936, 1: 2874, 2: 2320})

Epoch :  46 loss training:  3.4242567092878744 Time :  12089
accuracy train: 0.996782 val: 0.954268 test: 0.947082
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({1: 3936, 2: 2875, 0: 2319})

Epoch :  47 loss training:  3.4012112698401324 Time :  12114
accuracy train: 0.996612 val: 0.952744 test: 0.947860
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({1: 3936, 2: 2875, 0: 2319})

Epoch :  48 loss training:  3.288833379803691 Time :  12159
accuracy train: 0.996951 val: 0.948171 test: 0.946693
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({1: 3936, 0: 2877, 2: 2317})

Epoch :  49 loss training:  3.4652198675321415 Time :  12184
accuracy train: 0.996612 val: 0.954268 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({1: 3936, 0: 2878, 2: 2316})

Epoch :  50 loss training:  3.239731064881198 Time :  12210
accuracy train: 0.996951 val: 0.951220 test: 0.950584
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({1: 3936, 0: 2878, 2: 2316})

Epoch :  51 loss training:  3.197994848364033 Time :  12236
accuracy train: 0.996612 val: 0.955793 test: 0.950584
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({0: 3934, 2: 2880, 1: 2316})

Epoch :  52 loss training:  3.0825295899121556 Time :  12266
accuracy train: 0.996782 val: 0.948171 test: 0.949027
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({1: 3934, 0: 2881, 2: 2315})

Epoch :  53 loss training:  3.286419451702386 Time :  12296
accuracy train: 0.996612 val: 0.946646 test: 0.948638
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({1: 3934, 0: 2881, 2: 2315})

Epoch :  54 loss training:  2.8945558551931754 Time :  12328
accuracy train: 0.996782 val: 0.949695 test: 0.949027
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({1: 3934, 2: 2882, 0: 2314})

Epoch :  55 loss training:  3.1787576640490443 Time :  12353
accuracy train: 0.997121 val: 0.951220 test: 0.949027
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({1: 3933, 2: 2884, 0: 2313})

Epoch :  56 loss training:  2.651386797137093 Time :  12383
accuracy train: 0.996782 val: 0.954268 test: 0.947860
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({0: 3933, 1: 2884, 2: 2313})

Epoch :  57 loss training:  2.66224820894422 Time :  12411
accuracy train: 0.996612 val: 0.945122 test: 0.948249
max validation accuracy : 0.955793 max acc epoch : 26 test accuracy : 0.950195
Counter({1: 3932, 2: 2885, 0: 2313})

========================================================================================================================================================================================================
max acc epoch :  26
max validation accuracy :  0.9557926829268293
test accuracy :  0.9501945525291828
last test_accuracy :  0.948249027237354
max gap 14
========================================================================================================================================================================================================

itr : 8
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=946, weight_decay=1e-10)
device :  cuda:0
Counter({1: 5412, 2: 2503, 0: 1215})

Epoch :  1 loss training:  123.84247790277004 Time :  12441
accuracy train: 0.895833 val: 0.882622 test: 0.885603
max validation accuracy : 0.882622 max acc epoch : 1 test accuracy : 0.885603
Counter({1: 3577, 0: 2955, 2: 2598})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.52812848985195 Time :  12468
accuracy train: 0.941057 val: 0.910061 test: 0.907393
max validation accuracy : 0.910061 max acc epoch : 2 test accuracy : 0.907393
Counter({0: 3743, 2: 2870, 1: 2517})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  38.301340989768505 Time :  12493
accuracy train: 0.945461 val: 0.922256 test: 0.916342
max validation accuracy : 0.922256 max acc epoch : 3 test accuracy : 0.916342
Counter({1: 3855, 2: 2870, 0: 2405})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  35.24942058697343 Time :  12524
accuracy train: 0.950203 val: 0.913110 test: 0.929572
max validation accuracy : 0.922256 max acc epoch : 3 test accuracy : 0.916342
Counter({0: 3850, 2: 2870, 1: 2410})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  28.87345370091498 Time :  12550
accuracy train: 0.967988 val: 0.942073 test: 0.938911
max validation accuracy : 0.942073 max acc epoch : 5 test accuracy : 0.938911
Counter({1: 3862, 0: 2852, 2: 2416})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  24.342337926849723 Time :  12575
accuracy train: 0.964262 val: 0.934451 test: 0.934630
max validation accuracy : 0.942073 max acc epoch : 5 test accuracy : 0.938911
Counter({1: 3856, 2: 2875, 0: 2399})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  19.16589584760368 Time :  12600
accuracy train: 0.981538 val: 0.939024 test: 0.936576
max validation accuracy : 0.942073 max acc epoch : 5 test accuracy : 0.938911
Counter({1: 3874, 2: 2875, 0: 2381})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  16.040708870161325 Time :  12628
accuracy train: 0.983401 val: 0.949695 test: 0.947860
max validation accuracy : 0.949695 max acc epoch : 8 test accuracy : 0.947860
Counter({0: 3879, 2: 2870, 1: 2381})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  14.683069227263331 Time :  12652
accuracy train: 0.983909 val: 0.948171 test: 0.945914
max validation accuracy : 0.949695 max acc epoch : 8 test accuracy : 0.947860
Counter({0: 3885, 2: 2869, 1: 2376})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  12.748620366444811 Time :  12677
accuracy train: 0.986450 val: 0.946646 test: 0.950584
max validation accuracy : 0.949695 max acc epoch : 8 test accuracy : 0.947860
Counter({2: 3894, 1: 2859, 0: 2377})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  11.909807097166777 Time :  12702
accuracy train: 0.988652 val: 0.952744 test: 0.948638
max validation accuracy : 0.952744 max acc epoch : 11 test accuracy : 0.948638
Counter({0: 3900, 1: 2851, 2: 2379})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  11.459160056430846 Time :  12726
accuracy train: 0.988482 val: 0.952744 test: 0.946693
max validation accuracy : 0.952744 max acc epoch : 11 test accuracy : 0.948638
Counter({1: 3900, 0: 2852, 2: 2378})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  10.647084729047492 Time :  12762
accuracy train: 0.990176 val: 0.948171 test: 0.947471
max validation accuracy : 0.952744 max acc epoch : 11 test accuracy : 0.948638
Counter({2: 3903, 0: 2849, 1: 2378})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  10.173281008377671 Time :  12788
accuracy train: 0.989499 val: 0.951220 test: 0.946693
max validation accuracy : 0.952744 max acc epoch : 11 test accuracy : 0.948638
Counter({0: 3903, 2: 2849, 1: 2378})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  9.94511137669906 Time :  12813
accuracy train: 0.990684 val: 0.949695 test: 0.946304
max validation accuracy : 0.952744 max acc epoch : 11 test accuracy : 0.948638
Counter({0: 3903, 2: 2853, 1: 2374})

Epoch :  16 loss training:  9.980035518063232 Time :  12840
accuracy train: 0.990346 val: 0.949695 test: 0.950195
max validation accuracy : 0.952744 max acc epoch : 11 test accuracy : 0.948638
Counter({0: 3903, 1: 2853, 2: 2374})

Epoch :  17 loss training:  9.371151101309806 Time :  12876
accuracy train: 0.990854 val: 0.946646 test: 0.949416
max validation accuracy : 0.952744 max acc epoch : 11 test accuracy : 0.948638
Counter({1: 3904, 2: 2853, 0: 2373})

Epoch :  18 loss training:  9.041796331293881 Time :  12909
accuracy train: 0.990515 val: 0.954268 test: 0.950584
max validation accuracy : 0.954268 max acc epoch : 18 test accuracy : 0.950584
Counter({0: 3907, 2: 2853, 1: 2370})

Epoch :  19 loss training:  8.190803673118353 Time :  12937
accuracy train: 0.992717 val: 0.951220 test: 0.949416
max validation accuracy : 0.954268 max acc epoch : 18 test accuracy : 0.950584
Counter({1: 3908, 0: 2853, 2: 2369})

Epoch :  20 loss training:  8.147249670233577 Time :  12963
accuracy train: 0.993225 val: 0.945122 test: 0.949416
max validation accuracy : 0.954268 max acc epoch : 18 test accuracy : 0.950584
Counter({2: 3908, 0: 2853, 1: 2369})

Epoch :  21 loss training:  8.657948955427855 Time :  12995
accuracy train: 0.993225 val: 0.949695 test: 0.948638
max validation accuracy : 0.954268 max acc epoch : 18 test accuracy : 0.950584
Counter({1: 3909, 0: 2855, 2: 2366})

Epoch :  22 loss training:  7.766570058185607 Time :  13021
accuracy train: 0.993225 val: 0.949695 test: 0.949416
max validation accuracy : 0.954268 max acc epoch : 18 test accuracy : 0.950584
Counter({2: 3911, 0: 2858, 1: 2361})

Epoch :  23 loss training:  7.10547976847738 Time :  13047
accuracy train: 0.993733 val: 0.946646 test: 0.947471
max validation accuracy : 0.954268 max acc epoch : 18 test accuracy : 0.950584
Counter({0: 3913, 2: 2857, 1: 2360})

Epoch :  24 loss training:  8.140736597357318 Time :  13072
accuracy train: 0.993733 val: 0.952744 test: 0.949805
max validation accuracy : 0.954268 max acc epoch : 18 test accuracy : 0.950584
Counter({1: 3914, 2: 2860, 0: 2356})

Epoch :  25 loss training:  7.349244549171999 Time :  13102
accuracy train: 0.993225 val: 0.954268 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 18 test accuracy : 0.950584
Counter({1: 3916, 0: 2858, 2: 2356})

Epoch :  26 loss training:  7.056236463715322 Time :  13127
accuracy train: 0.993902 val: 0.949695 test: 0.949416
max validation accuracy : 0.954268 max acc epoch : 18 test accuracy : 0.950584
Counter({1: 3917, 2: 2860, 0: 2353})

Epoch :  27 loss training:  6.6086642374284565 Time :  13153
accuracy train: 0.994241 val: 0.954268 test: 0.949805
max validation accuracy : 0.954268 max acc epoch : 18 test accuracy : 0.950584
Counter({0: 3919, 2: 2862, 1: 2349})

Epoch :  28 loss training:  6.285006245365366 Time :  13179
accuracy train: 0.994411 val: 0.951220 test: 0.950584
max validation accuracy : 0.954268 max acc epoch : 18 test accuracy : 0.950584
Counter({0: 3921, 2: 2865, 1: 2344})

Epoch :  29 loss training:  5.875728375278413 Time :  13209
accuracy train: 0.994749 val: 0.949695 test: 0.949416
max validation accuracy : 0.954268 max acc epoch : 18 test accuracy : 0.950584
Counter({2: 3921, 0: 2865, 1: 2344})

Epoch :  30 loss training:  6.060149788390845 Time :  13250
accuracy train: 0.994072 val: 0.954268 test: 0.951362
max validation accuracy : 0.954268 max acc epoch : 18 test accuracy : 0.950584
Counter({1: 3922, 2: 2867, 0: 2341})

Epoch :  31 loss training:  5.942931726807728 Time :  13281
accuracy train: 0.994919 val: 0.952744 test: 0.949416
max validation accuracy : 0.954268 max acc epoch : 18 test accuracy : 0.950584
Counter({1: 3923, 0: 2867, 2: 2340})

Epoch :  32 loss training:  5.581358988303691 Time :  13313
accuracy train: 0.995088 val: 0.949695 test: 0.949416
max validation accuracy : 0.954268 max acc epoch : 18 test accuracy : 0.950584
Counter({1: 3926, 0: 2865, 2: 2339})

Epoch :  33 loss training:  5.340993930120021 Time :  13345
accuracy train: 0.995088 val: 0.951220 test: 0.948249
max validation accuracy : 0.954268 max acc epoch : 18 test accuracy : 0.950584
Counter({1: 3927, 2: 2864, 0: 2339})

Epoch :  34 loss training:  5.240965549135581 Time :  13390
accuracy train: 0.995088 val: 0.951220 test: 0.949805
max validation accuracy : 0.954268 max acc epoch : 18 test accuracy : 0.950584
Counter({2: 3936, 1: 2856, 0: 2338})

Epoch :  35 loss training:  4.715315457899123 Time :  13425
accuracy train: 0.995257 val: 0.955793 test: 0.950584
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({1: 3936, 2: 2857, 0: 2337})

Epoch :  36 loss training:  4.935317790834233 Time :  13459
accuracy train: 0.995596 val: 0.952744 test: 0.950973
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({1: 3936, 0: 2857, 2: 2337})

Epoch :  37 loss training:  4.7219803631305695 Time :  13485
accuracy train: 0.994749 val: 0.948171 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({1: 3937, 0: 2854, 2: 2339})

Epoch :  38 loss training:  4.61885247414466 Time :  13530
accuracy train: 0.996443 val: 0.951220 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({0: 3938, 2: 2855, 1: 2337})

Epoch :  39 loss training:  4.56537170545198 Time :  13559
accuracy train: 0.995766 val: 0.951220 test: 0.952529
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({1: 3938, 2: 2859, 0: 2333})

Epoch :  40 loss training:  4.143498950870708 Time :  13586
accuracy train: 0.996104 val: 0.949695 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({0: 3939, 2: 2860, 1: 2331})

Epoch :  41 loss training:  4.238387834164314 Time :  13612
accuracy train: 0.995935 val: 0.949695 test: 0.950973
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({1: 3940, 0: 2867, 2: 2323})

Epoch :  42 loss training:  4.273980851867236 Time :  13649
accuracy train: 0.996612 val: 0.945122 test: 0.951362
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({1: 3940, 2: 2869, 0: 2321})

Epoch :  43 loss training:  3.742250836803578 Time :  13684
accuracy train: 0.996274 val: 0.949695 test: 0.950973
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({1: 3940, 0: 2868, 2: 2322})

Epoch :  44 loss training:  3.8835400429088622 Time :  13716
accuracy train: 0.996274 val: 0.948171 test: 0.949805
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({1: 3940, 0: 2867, 2: 2323})

Epoch :  45 loss training:  3.462934537557885 Time :  13757
accuracy train: 0.997290 val: 0.948171 test: 0.948638
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({0: 3940, 1: 2866, 2: 2324})

Epoch :  46 loss training:  3.6699705357896164 Time :  13788
accuracy train: 0.996782 val: 0.949695 test: 0.951362
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({1: 3937, 2: 2866, 0: 2327})

Epoch :  47 loss training:  3.3188173964153975 Time :  13825
accuracy train: 0.996612 val: 0.949695 test: 0.947860
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({2: 3937, 1: 2866, 0: 2327})

Epoch :  48 loss training:  3.7366383641492575 Time :  13865
accuracy train: 0.997121 val: 0.952744 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({0: 3937, 1: 2867, 2: 2326})

Epoch :  49 loss training:  3.449018150975462 Time :  13897
accuracy train: 0.996951 val: 0.954268 test: 0.950973
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({1: 3937, 0: 2868, 2: 2325})

Epoch :  50 loss training:  3.1555795302265324 Time :  13936
accuracy train: 0.996612 val: 0.949695 test: 0.950973
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({1: 3937, 2: 2868, 0: 2325})

Epoch :  51 loss training:  3.5906694069853984 Time :  13975
accuracy train: 0.996951 val: 0.955793 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({1: 3937, 2: 2869, 0: 2324})

Epoch :  52 loss training:  3.1963609540252946 Time :  14021
accuracy train: 0.996782 val: 0.949695 test: 0.950584
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({2: 3937, 0: 2871, 1: 2322})

Epoch :  53 loss training:  3.1782408888684586 Time :  14055
accuracy train: 0.996782 val: 0.949695 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({1: 3937, 0: 2871, 2: 2322})

Epoch :  54 loss training:  2.6199006461538374 Time :  14098
accuracy train: 0.996612 val: 0.951220 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({1: 3937, 2: 2871, 0: 2322})

Epoch :  55 loss training:  2.992422533890931 Time :  14139
accuracy train: 0.996782 val: 0.949695 test: 0.947860
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({1: 3937, 0: 2871, 2: 2322})

Epoch :  56 loss training:  3.0750215986045077 Time :  14179
accuracy train: 0.996782 val: 0.955793 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({1: 3938, 0: 2871, 2: 2321})

Epoch :  57 loss training:  2.455001303140307 Time :  14228
accuracy train: 0.996782 val: 0.949695 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({1: 3938, 2: 2871, 0: 2321})

Epoch :  58 loss training:  3.0362675877695438 Time :  14265
accuracy train: 0.996951 val: 0.943598 test: 0.948638
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({1: 3938, 2: 2872, 0: 2320})

Epoch :  59 loss training:  2.6688130784314126 Time :  14305
accuracy train: 0.996951 val: 0.951220 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({1: 3939, 2: 2872, 0: 2319})

Epoch :  60 loss training:  2.6831380769144744 Time :  14343
accuracy train: 0.996782 val: 0.946646 test: 0.948638
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({1: 3939, 2: 2872, 0: 2319})

Epoch :  61 loss training:  2.644156285561621 Time :  14390
accuracy train: 0.997121 val: 0.949695 test: 0.947471
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({1: 3939, 0: 2872, 2: 2319})

Epoch :  62 loss training:  2.4934281206224114 Time :  14424
accuracy train: 0.996951 val: 0.949695 test: 0.949027
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({1: 3938, 0: 2873, 2: 2319})

Epoch :  63 loss training:  2.3317309213452972 Time :  14457
accuracy train: 0.996951 val: 0.945122 test: 0.947860
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({1: 3938, 0: 2873, 2: 2319})

Epoch :  64 loss training:  3.1674236233520787 Time :  14491
accuracy train: 0.996443 val: 0.940549 test: 0.948638
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({0: 3938, 2: 2873, 1: 2319})

Epoch :  65 loss training:  2.6560050140251406 Time :  14527
accuracy train: 0.996951 val: 0.946646 test: 0.949805
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({0: 3937, 2: 2873, 1: 2320})

Epoch :  66 loss training:  2.901732083322713 Time :  14572
accuracy train: 0.996782 val: 0.945122 test: 0.950584
max validation accuracy : 0.955793 max acc epoch : 35 test accuracy : 0.950584
Counter({2: 3937, 0: 2873, 1: 2320})

========================================================================================================================================================================================================
max acc epoch :  35
max validation accuracy :  0.9557926829268293
test accuracy :  0.9505836575875486
last test_accuracy :  0.9505836575875486
max gap 17
========================================================================================================================================================================================================

itr : 9
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=946, weight_decay=1e-10)
device :  cuda:0
Counter({1: 5412, 2: 2503, 0: 1215})

Epoch :  1 loss training:  123.94130456447601 Time :  14638
accuracy train: 0.893801 val: 0.881098 test: 0.888327
max validation accuracy : 0.881098 max acc epoch : 1 test accuracy : 0.888327
Counter({0: 3577, 2: 2966, 1: 2587})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.13742287456989 Time :  14682
accuracy train: 0.937500 val: 0.917683 test: 0.901946
max validation accuracy : 0.917683 max acc epoch : 2 test accuracy : 0.901946
Counter({1: 3767, 0: 2901, 2: 2462})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  37.75571292638779 Time :  14726
accuracy train: 0.946308 val: 0.926829 test: 0.915953
max validation accuracy : 0.926829 max acc epoch : 3 test accuracy : 0.915953
Counter({0: 3848, 2: 2868, 1: 2414})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  34.73846600949764 Time :  14772
accuracy train: 0.952913 val: 0.919207 test: 0.932296
max validation accuracy : 0.926829 max acc epoch : 3 test accuracy : 0.915953
Counter({1: 3848, 2: 2878, 0: 2404})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  28.162245646119118 Time :  14812
accuracy train: 0.966972 val: 0.943598 test: 0.937743
max validation accuracy : 0.943598 max acc epoch : 5 test accuracy : 0.937743
Counter({1: 3862, 0: 2867, 2: 2401})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  24.914921175688505 Time :  14853
accuracy train: 0.965617 val: 0.932927 test: 0.932296
max validation accuracy : 0.943598 max acc epoch : 5 test accuracy : 0.937743
Counter({2: 3867, 1: 2878, 0: 2385})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  18.678501247428358 Time :  14900
accuracy train: 0.980014 val: 0.932927 test: 0.937743
max validation accuracy : 0.943598 max acc epoch : 5 test accuracy : 0.937743
Counter({2: 3889, 1: 2880, 0: 2361})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  16.426018776837736 Time :  14946
accuracy train: 0.983740 val: 0.948171 test: 0.948249
max validation accuracy : 0.948171 max acc epoch : 8 test accuracy : 0.948249
Counter({0: 3891, 1: 2876, 2: 2363})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  14.634244102053344 Time :  14985
accuracy train: 0.985603 val: 0.946646 test: 0.948638
max validation accuracy : 0.948171 max acc epoch : 8 test accuracy : 0.948249
Counter({2: 3893, 1: 2874, 0: 2363})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  12.625640268670395 Time :  15016
accuracy train: 0.987636 val: 0.948171 test: 0.952529
max validation accuracy : 0.948171 max acc epoch : 8 test accuracy : 0.948249
Counter({1: 3899, 2: 2869, 0: 2362})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  11.73132064472884 Time :  15049
accuracy train: 0.988991 val: 0.946646 test: 0.950584
max validation accuracy : 0.948171 max acc epoch : 8 test accuracy : 0.948249
Counter({2: 3908, 0: 2864, 1: 2358})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  11.397817945107818 Time :  15090
accuracy train: 0.989329 val: 0.949695 test: 0.946304
max validation accuracy : 0.949695 max acc epoch : 12 test accuracy : 0.946304
Counter({1: 3913, 0: 2861, 2: 2356})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  10.603963618632406 Time :  15123
accuracy train: 0.990346 val: 0.942073 test: 0.948249
max validation accuracy : 0.949695 max acc epoch : 12 test accuracy : 0.946304
Counter({1: 3915, 0: 2861, 2: 2354})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  9.903341091237962 Time :  15156
accuracy train: 0.990007 val: 0.946646 test: 0.948638
max validation accuracy : 0.949695 max acc epoch : 12 test accuracy : 0.946304
Counter({1: 3915, 0: 2860, 2: 2355})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  9.98334903176874 Time :  15188
accuracy train: 0.990176 val: 0.945122 test: 0.948638
max validation accuracy : 0.949695 max acc epoch : 12 test accuracy : 0.946304
Counter({1: 3917, 0: 2860, 2: 2353})

Epoch :  16 loss training:  10.280354923568666 Time :  15219
accuracy train: 0.990684 val: 0.949695 test: 0.949805
max validation accuracy : 0.949695 max acc epoch : 12 test accuracy : 0.946304
Counter({0: 3917, 1: 2860, 2: 2353})

Epoch :  17 loss training:  9.380830947309732 Time :  15252
accuracy train: 0.991023 val: 0.945122 test: 0.946693
max validation accuracy : 0.949695 max acc epoch : 12 test accuracy : 0.946304
Counter({1: 3918, 2: 2861, 0: 2351})

Epoch :  18 loss training:  8.822198771173134 Time :  15300
accuracy train: 0.991531 val: 0.945122 test: 0.950973
max validation accuracy : 0.949695 max acc epoch : 12 test accuracy : 0.946304
Counter({0: 3919, 2: 2860, 1: 2351})

Epoch :  19 loss training:  8.718278175219893 Time :  15338
accuracy train: 0.992209 val: 0.942073 test: 0.949805
max validation accuracy : 0.949695 max acc epoch : 12 test accuracy : 0.946304
Counter({1: 3918, 2: 2860, 0: 2352})

Epoch :  20 loss training:  8.24344199988991 Time :  15370
accuracy train: 0.993225 val: 0.946646 test: 0.949805
max validation accuracy : 0.949695 max acc epoch : 12 test accuracy : 0.946304
Counter({1: 3919, 0: 2859, 2: 2352})

Epoch :  21 loss training:  8.26840462628752 Time :  15402
accuracy train: 0.993394 val: 0.948171 test: 0.948249
max validation accuracy : 0.949695 max acc epoch : 12 test accuracy : 0.946304
Counter({2: 3919, 0: 2861, 1: 2350})

Epoch :  22 loss training:  8.22358996188268 Time :  15436
accuracy train: 0.994072 val: 0.951220 test: 0.947471
max validation accuracy : 0.951220 max acc epoch : 22 test accuracy : 0.947471
Counter({1: 3919, 0: 2860, 2: 2351})

Epoch :  23 loss training:  7.8212229972705245 Time :  15478
accuracy train: 0.993564 val: 0.946646 test: 0.945914
max validation accuracy : 0.951220 max acc epoch : 22 test accuracy : 0.947471
Counter({0: 3919, 2: 2860, 1: 2351})

Epoch :  24 loss training:  7.381632008822635 Time :  15513
accuracy train: 0.994241 val: 0.946646 test: 0.949805
max validation accuracy : 0.951220 max acc epoch : 22 test accuracy : 0.947471
Counter({2: 3921, 1: 2859, 0: 2350})

Epoch :  25 loss training:  6.884185595205054 Time :  15549
accuracy train: 0.993056 val: 0.948171 test: 0.949027
max validation accuracy : 0.951220 max acc epoch : 22 test accuracy : 0.947471
Counter({0: 3923, 2: 2857, 1: 2350})

Epoch :  26 loss training:  6.786137219285592 Time :  15581
accuracy train: 0.993733 val: 0.951220 test: 0.950584
max validation accuracy : 0.951220 max acc epoch : 22 test accuracy : 0.947471
Counter({1: 3926, 2: 2856, 0: 2348})

Epoch :  27 loss training:  6.568354967981577 Time :  15618
accuracy train: 0.993564 val: 0.946646 test: 0.949416
max validation accuracy : 0.951220 max acc epoch : 22 test accuracy : 0.947471
Counter({1: 3926, 2: 2857, 0: 2347})

Epoch :  28 loss training:  5.763835921883583 Time :  15655
accuracy train: 0.994580 val: 0.945122 test: 0.949416
max validation accuracy : 0.951220 max acc epoch : 22 test accuracy : 0.947471
Counter({0: 3927, 2: 2857, 1: 2346})

Epoch :  29 loss training:  6.207469583954662 Time :  15706
accuracy train: 0.994749 val: 0.948171 test: 0.949416
max validation accuracy : 0.951220 max acc epoch : 22 test accuracy : 0.947471
Counter({0: 3928, 1: 2857, 2: 2345})

Epoch :  30 loss training:  5.379974050913006 Time :  15748
accuracy train: 0.995257 val: 0.951220 test: 0.948249
max validation accuracy : 0.951220 max acc epoch : 22 test accuracy : 0.947471
Counter({1: 3932, 0: 2857, 2: 2341})

Epoch :  31 loss training:  5.8218202707357705 Time :  15793
accuracy train: 0.994919 val: 0.948171 test: 0.947471
max validation accuracy : 0.951220 max acc epoch : 22 test accuracy : 0.947471
Counter({1: 3933, 2: 2858, 0: 2339})

Epoch :  32 loss training:  5.219485769746825 Time :  15830
accuracy train: 0.995427 val: 0.949695 test: 0.947860
max validation accuracy : 0.951220 max acc epoch : 22 test accuracy : 0.947471
Counter({1: 3933, 0: 2858, 2: 2339})

Epoch :  33 loss training:  5.258364881388843 Time :  15858
accuracy train: 0.995257 val: 0.951220 test: 0.947082
max validation accuracy : 0.951220 max acc epoch : 22 test accuracy : 0.947471
Counter({1: 3933, 0: 2858, 2: 2339})

Epoch :  34 loss training:  5.824135870207101 Time :  15889
accuracy train: 0.995257 val: 0.948171 test: 0.945525
max validation accuracy : 0.951220 max acc epoch : 22 test accuracy : 0.947471
Counter({0: 3933, 2: 2857, 1: 2340})

Epoch :  35 loss training:  5.035262264078483 Time :  15920
accuracy train: 0.995766 val: 0.945122 test: 0.948249
max validation accuracy : 0.951220 max acc epoch : 22 test accuracy : 0.947471
Counter({1: 3933, 0: 2857, 2: 2340})

Epoch :  36 loss training:  4.654160054167733 Time :  15953
accuracy train: 0.995427 val: 0.951220 test: 0.950584
max validation accuracy : 0.951220 max acc epoch : 22 test accuracy : 0.947471
Counter({2: 3933, 0: 2857, 1: 2340})

Epoch :  37 loss training:  4.514885429409333 Time :  16001
accuracy train: 0.995257 val: 0.946646 test: 0.948638
max validation accuracy : 0.951220 max acc epoch : 22 test accuracy : 0.947471
Counter({0: 3932, 2: 2860, 1: 2338})

Epoch :  38 loss training:  4.593400871148333 Time :  16033
accuracy train: 0.996443 val: 0.946646 test: 0.948249
max validation accuracy : 0.951220 max acc epoch : 22 test accuracy : 0.947471
Counter({0: 3933, 2: 2861, 1: 2336})

Epoch :  39 loss training:  4.882303741760552 Time :  16067
accuracy train: 0.996104 val: 0.948171 test: 0.947082
max validation accuracy : 0.951220 max acc epoch : 22 test accuracy : 0.947471
Counter({1: 3933, 2: 2861, 0: 2336})

Epoch :  40 loss training:  4.388969516963698 Time :  16102
accuracy train: 0.996104 val: 0.945122 test: 0.946693
max validation accuracy : 0.951220 max acc epoch : 22 test accuracy : 0.947471
Counter({0: 3933, 1: 2861, 2: 2336})

Epoch :  41 loss training:  4.024778006947599 Time :  16141
accuracy train: 0.996104 val: 0.948171 test: 0.950584
max validation accuracy : 0.951220 max acc epoch : 22 test accuracy : 0.947471
Counter({1: 3934, 0: 2865, 2: 2331})

Epoch :  42 loss training:  3.833633649512194 Time :  16174
accuracy train: 0.996443 val: 0.949695 test: 0.949805
max validation accuracy : 0.951220 max acc epoch : 22 test accuracy : 0.947471
Counter({0: 3934, 1: 2867, 2: 2329})

Epoch :  43 loss training:  3.9718757092487067 Time :  16206
accuracy train: 0.996443 val: 0.952744 test: 0.946693
max validation accuracy : 0.952744 max acc epoch : 43 test accuracy : 0.946693
Counter({0: 3934, 2: 2868, 1: 2328})

Epoch :  44 loss training:  3.702517296653241 Time :  16239
accuracy train: 0.996443 val: 0.946646 test: 0.948638
max validation accuracy : 0.952744 max acc epoch : 43 test accuracy : 0.946693
Counter({1: 3933, 0: 2869, 2: 2328})

Epoch :  45 loss training:  3.4568683833349496 Time :  16271
accuracy train: 0.996782 val: 0.946646 test: 0.947082
max validation accuracy : 0.952744 max acc epoch : 43 test accuracy : 0.946693
Counter({0: 3934, 2: 2869, 1: 2327})

Epoch :  46 loss training:  3.475062884623185 Time :  16310
accuracy train: 0.996612 val: 0.949695 test: 0.945914
max validation accuracy : 0.952744 max acc epoch : 43 test accuracy : 0.946693
Counter({0: 3934, 1: 2874, 2: 2322})

Epoch :  47 loss training:  3.4658284515026025 Time :  16352
accuracy train: 0.996782 val: 0.945122 test: 0.948249
max validation accuracy : 0.952744 max acc epoch : 43 test accuracy : 0.946693
Counter({1: 3933, 2: 2875, 0: 2322})

Epoch :  48 loss training:  3.2633254939573817 Time :  16391
accuracy train: 0.996951 val: 0.943598 test: 0.946304
max validation accuracy : 0.952744 max acc epoch : 43 test accuracy : 0.946693
Counter({0: 3933, 2: 2877, 1: 2320})

Epoch :  49 loss training:  3.444945551920682 Time :  16425
accuracy train: 0.996612 val: 0.951220 test: 0.949027
max validation accuracy : 0.952744 max acc epoch : 43 test accuracy : 0.946693
Counter({2: 3933, 0: 2880, 1: 2317})

Epoch :  50 loss training:  3.2520959220128134 Time :  16458
accuracy train: 0.996951 val: 0.946646 test: 0.949416
max validation accuracy : 0.952744 max acc epoch : 43 test accuracy : 0.946693
Counter({1: 3933, 0: 2879, 2: 2318})

Epoch :  51 loss training:  3.1954032046487555 Time :  16512
accuracy train: 0.996782 val: 0.954268 test: 0.949416
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({1: 3931, 2: 2882, 0: 2317})

Epoch :  52 loss training:  3.128494180738926 Time :  16545
accuracy train: 0.996782 val: 0.949695 test: 0.947860
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({1: 3932, 0: 2881, 2: 2317})

Epoch :  53 loss training:  3.444778685341589 Time :  16577
accuracy train: 0.996612 val: 0.945122 test: 0.949805
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({0: 3932, 1: 2880, 2: 2318})

Epoch :  54 loss training:  3.0017661014571786 Time :  16610
accuracy train: 0.996782 val: 0.943598 test: 0.947860
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({0: 3932, 2: 2881, 1: 2317})

Epoch :  55 loss training:  3.121014842472505 Time :  16642
accuracy train: 0.996782 val: 0.948171 test: 0.946304
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({2: 3932, 0: 2883, 1: 2315})

Epoch :  56 loss training:  2.6341703082434833 Time :  16689
accuracy train: 0.996951 val: 0.949695 test: 0.947471
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({1: 3932, 0: 2883, 2: 2315})

Epoch :  57 loss training:  2.695622729428578 Time :  16720
accuracy train: 0.996612 val: 0.945122 test: 0.948638
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({2: 3932, 1: 2883, 0: 2315})

Epoch :  58 loss training:  3.1101654133817647 Time :  16750
accuracy train: 0.996782 val: 0.951220 test: 0.948249
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({1: 3932, 2: 2885, 0: 2313})

Epoch :  59 loss training:  2.4712885607150383 Time :  16789
accuracy train: 0.996951 val: 0.952744 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({1: 3932, 2: 2885, 0: 2313})

Epoch :  60 loss training:  2.662078585650306 Time :  16822
accuracy train: 0.996612 val: 0.949695 test: 0.949805
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({1: 3931, 2: 2884, 0: 2315})

Epoch :  61 loss training:  2.815233549423283 Time :  16877
accuracy train: 0.996782 val: 0.949695 test: 0.949416
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({2: 3931, 0: 2884, 1: 2315})

Epoch :  62 loss training:  2.5482754853146616 Time :  16913
accuracy train: 0.996612 val: 0.949695 test: 0.950584
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({1: 3931, 0: 2884, 2: 2315})

Epoch :  63 loss training:  2.3634108008700423 Time :  16949
accuracy train: 0.996951 val: 0.946646 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({1: 3931, 0: 2884, 2: 2315})

Epoch :  64 loss training:  2.4476906552445143 Time :  16991
accuracy train: 0.996612 val: 0.942073 test: 0.947082
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({2: 3933, 0: 2881, 1: 2316})

Epoch :  65 loss training:  2.3913300755084492 Time :  17035
accuracy train: 0.996951 val: 0.942073 test: 0.947860
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({0: 3933, 1: 2881, 2: 2316})

Epoch :  66 loss training:  2.4178035396325868 Time :  17078
accuracy train: 0.996782 val: 0.945122 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({1: 3933, 2: 2882, 0: 2315})

Epoch :  67 loss training:  2.2647361190611264 Time :  17116
accuracy train: 0.996782 val: 0.946646 test: 0.948249
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({1: 3933, 0: 2882, 2: 2315})

Epoch :  68 loss training:  2.461317365319701 Time :  17148
accuracy train: 0.996951 val: 0.945122 test: 0.946693
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({0: 3933, 1: 2882, 2: 2315})

Epoch :  69 loss training:  2.3720444294885965 Time :  17184
accuracy train: 0.996782 val: 0.948171 test: 0.946693
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({0: 3933, 2: 2882, 1: 2315})

Epoch :  70 loss training:  2.2949718384770676 Time :  17233
accuracy train: 0.996951 val: 0.946646 test: 0.949805
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({1: 3933, 0: 2882, 2: 2315})

Epoch :  71 loss training:  2.0373024459695444 Time :  17268
accuracy train: 0.996951 val: 0.946646 test: 0.949416
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({1: 3933, 2: 2882, 0: 2315})

Epoch :  72 loss training:  2.2552398530824576 Time :  17304
accuracy train: 0.996782 val: 0.951220 test: 0.950584
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({2: 3932, 0: 2883, 1: 2315})

Epoch :  73 loss training:  2.107365259886137 Time :  17339
accuracy train: 0.996782 val: 0.948171 test: 0.947860
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({0: 3932, 2: 2883, 1: 2315})

Epoch :  74 loss training:  2.1922493437014055 Time :  17387
accuracy train: 0.996782 val: 0.948171 test: 0.950973
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({0: 3932, 1: 2890, 2: 2308})

Epoch :  75 loss training:  2.3547325010295026 Time :  17422
accuracy train: 0.996612 val: 0.945122 test: 0.950195
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({1: 3932, 0: 2890, 2: 2308})

Epoch :  76 loss training:  2.336721294297604 Time :  17451
accuracy train: 0.996612 val: 0.946646 test: 0.950195
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({0: 3941, 1: 2881, 2: 2308})

Epoch :  77 loss training:  2.159983185585588 Time :  17481
accuracy train: 0.996951 val: 0.948171 test: 0.950195
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({0: 3941, 2: 2881, 1: 2308})

Epoch :  78 loss training:  2.359229024965316 Time :  17514
accuracy train: 0.997121 val: 0.949695 test: 0.949416
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({0: 3941, 2: 2881, 1: 2308})

Epoch :  79 loss training:  2.0580061196669703 Time :  17560
accuracy train: 0.996951 val: 0.948171 test: 0.948249
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({1: 3941, 2: 2880, 0: 2309})

Epoch :  80 loss training:  2.221327365754405 Time :  17598
accuracy train: 0.996951 val: 0.951220 test: 0.948249
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({0: 3941, 2: 2880, 1: 2309})

Epoch :  81 loss training:  1.8556038946990157 Time :  17642
accuracy train: 0.996612 val: 0.949695 test: 0.947860
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({2: 3941, 1: 2880, 0: 2309})

Epoch :  82 loss training:  1.724200916753034 Time :  17684
accuracy train: 0.997121 val: 0.949695 test: 0.949805
max validation accuracy : 0.954268 max acc epoch : 51 test accuracy : 0.949416
Counter({0: 3941, 2: 2883, 1: 2306})

========================================================================================================================================================================================================
max acc epoch :  51
max validation accuracy :  0.9542682926829268
test accuracy :  0.9494163424124513
last test_accuracy :  0.9498054474708171
max gap 21
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.95732 	 test_accuracy : 0.94864 	 max_acc epoch :  22 	 last test_accuracy : 0.95097
k :  1 	 val_accuracy : 0.96037 	 test_accuracy : 0.94903 	 max_acc epoch :  36 	 last test_accuracy : 0.94903
k :  2 	 val_accuracy : 0.95884 	 test_accuracy : 0.94786 	 max_acc epoch :  25 	 last test_accuracy : 0.94981
k :  3 	 val_accuracy : 0.96037 	 test_accuracy : 0.94903 	 max_acc epoch :  25 	 last test_accuracy : 0.94864
k :  4 	 val_accuracy : 0.95884 	 test_accuracy : 0.94903 	 max_acc epoch :  12 	 last test_accuracy : 0.95175
k :  5 	 val_accuracy : 0.95732 	 test_accuracy : 0.94786 	 max_acc epoch :  25 	 last test_accuracy : 0.94864
k :  6 	 val_accuracy : 0.95427 	 test_accuracy : 0.94747 	 max_acc epoch :  31 	 last test_accuracy : 0.94864
k :  7 	 val_accuracy : 0.95579 	 test_accuracy : 0.95019 	 max_acc epoch :  26 	 last test_accuracy : 0.94825
k :  8 	 val_accuracy : 0.95579 	 test_accuracy : 0.95058 	 max_acc epoch :  35 	 last test_accuracy : 0.95058
k :  9 	 val_accuracy : 0.95427 	 test_accuracy : 0.94942 	 max_acc epoch :  51 	 last test_accuracy : 0.94981

avg :  	 val_accuracy : 0.95732 	 test_accuracy : 0.94891 	 last_accuracy : 0.94961
