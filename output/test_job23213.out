date and time :  Tue Jan 26 15:36:34 2021
Namespace(batch_size=16, dataset='R52', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=1e-06)
device :  cuda:0
HGNNModel(
  (word_embeddings): Embedding(9333, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=52, bias=True)
    (1): Linear(in_features=200, out_features=52, bias=True)
    (2): Linear(in_features=200, out_features=52, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
)
Epoch :  1 loss training:  256.8784589273855 Time :  13
accuracy train: 0.927337 val: 0.899390 test: 0.900389
max validation accuracy : 0.899390243902439 max acc epoch : 1 test accuracy : 0.9003891050583658

Epoch :  2 loss training:  101.92329014698043 Time :  24
accuracy train: 0.939024 val: 0.914634 test: 0.921012
max validation accuracy : 0.9146341463414634 max acc epoch : 2 test accuracy : 0.9210116731517509

Epoch :  3 loss training:  76.41322037955979 Time :  35
accuracy train: 0.972053 val: 0.940549 test: 0.925292
max validation accuracy : 0.9405487804878049 max acc epoch : 3 test accuracy : 0.9252918287937744

Epoch :  4 loss training:  58.36845334782265 Time :  45
accuracy train: 0.977134 val: 0.955793 test: 0.932296
max validation accuracy : 0.9557926829268293 max acc epoch : 4 test accuracy : 0.932295719844358

Epoch :  5 loss training:  48.67617749271449 Time :  55
accuracy train: 0.984079 val: 0.943598 test: 0.935409
max validation accuracy : 0.9557926829268293 max acc epoch : 4 test accuracy : 0.932295719844358

Epoch :  6 loss training:  38.57264968636446 Time :  64
accuracy train: 0.969682 val: 0.932927 test: 0.928405
max validation accuracy : 0.9557926829268293 max acc epoch : 4 test accuracy : 0.932295719844358

Epoch :  7 loss training:  32.133289676043205 Time :  72
accuracy train: 0.985942 val: 0.946646 test: 0.940856
max validation accuracy : 0.9557926829268293 max acc epoch : 4 test accuracy : 0.932295719844358

Epoch :  8 loss training:  30.339102835860103 Time :  81
accuracy train: 0.987805 val: 0.940549 test: 0.934241
max validation accuracy : 0.9557926829268293 max acc epoch : 4 test accuracy : 0.932295719844358

Epoch :  9 loss training:  28.72845038920059 Time :  92
accuracy train: 0.980691 val: 0.928354 test: 0.928405
max validation accuracy : 0.9557926829268293 max acc epoch : 4 test accuracy : 0.932295719844358

Epoch :  10 loss training:  23.085272881784476 Time :  102
accuracy train: 0.992378 val: 0.926829 test: 0.923346
max validation accuracy : 0.9557926829268293 max acc epoch : 4 test accuracy : 0.932295719844358

Epoch :  11 loss training:  31.60593887718278 Time :  112
accuracy train: 0.987805 val: 0.940549 test: 0.938911
max validation accuracy : 0.9557926829268293 max acc epoch : 4 test accuracy : 0.932295719844358

Epoch :  12 loss training:  22.822192940413515 Time :  122
accuracy train: 0.993056 val: 0.942073 test: 0.933074
max validation accuracy : 0.9557926829268293 max acc epoch : 4 test accuracy : 0.932295719844358

Epoch :  13 loss training:  18.69522236521152 Time :  129
accuracy train: 0.994919 val: 0.942073 test: 0.934630
max validation accuracy : 0.9557926829268293 max acc epoch : 4 test accuracy : 0.932295719844358

Epoch :  14 loss training:  18.6990942057746 Time :  136
accuracy train: 0.993564 val: 0.940549 test: 0.931128
max validation accuracy : 0.9557926829268293 max acc epoch : 4 test accuracy : 0.932295719844358

Epoch :  15 loss training:  19.512267645843167 Time :  143
accuracy train: 0.992717 val: 0.934451 test: 0.928794
max validation accuracy : 0.9557926829268293 max acc epoch : 4 test accuracy : 0.932295719844358

Epoch :  16 loss training:  15.82257975788525 Time :  150
accuracy train: 0.990007 val: 0.946646 test: 0.924514
max validation accuracy : 0.9557926829268293 max acc epoch : 4 test accuracy : 0.932295719844358

Epoch :  17 loss training:  18.579791509015195 Time :  157
accuracy train: 0.986789 val: 0.934451 test: 0.929572
max validation accuracy : 0.9557926829268293 max acc epoch : 4 test accuracy : 0.932295719844358

Epoch :  18 loss training:  15.771351151085128 Time :  164
accuracy train: 0.995088 val: 0.943598 test: 0.938132
max validation accuracy : 0.9557926829268293 max acc epoch : 4 test accuracy : 0.932295719844358

Epoch :  19 loss training:  12.102435591456015 Time :  170
accuracy train: 0.994580 val: 0.945122 test: 0.934630
max validation accuracy : 0.9557926829268293 max acc epoch : 4 test accuracy : 0.932295719844358

Epoch :  20 loss training:  14.20966779913033 Time :  177
accuracy train: 0.995257 val: 0.945122 test: 0.936187
max validation accuracy : 0.9557926829268293 max acc epoch : 4 test accuracy : 0.932295719844358

Epoch :  21 loss training:  15.11149866278538 Time :  184
accuracy train: 0.995935 val: 0.942073 test: 0.936965
max validation accuracy : 0.9557926829268293 max acc epoch : 4 test accuracy : 0.932295719844358

Epoch :  22 loss training:  11.89831917537299 Time :  190
accuracy train: 0.987127 val: 0.920732 test: 0.928405
max validation accuracy : 0.9557926829268293 max acc epoch : 4 test accuracy : 0.932295719844358

Epoch :  23 loss training:  18.291476320609945 Time :  197
accuracy train: 0.994411 val: 0.934451 test: 0.930739
max validation accuracy : 0.9557926829268293 max acc epoch : 4 test accuracy : 0.932295719844358

Epoch :  24 loss training:  11.336776842661493 Time :  204
accuracy train: 0.993225 val: 0.929878 test: 0.921012
max validation accuracy : 0.9557926829268293 max acc epoch : 4 test accuracy : 0.932295719844358

Epoch :  25 loss training:  14.497479739092341 Time :  210
accuracy train: 0.994919 val: 0.932927 test: 0.925292
max validation accuracy : 0.9557926829268293 max acc epoch : 4 test accuracy : 0.932295719844358

========================================================================================================================================================================================================
max acc epoch :  4
max validation accuracy :  0.9557926829268293
test accuracy :  0.932295719844358
latest_test_accuracy :  0.9252918287937744
========================================================================================================================================================================================================

