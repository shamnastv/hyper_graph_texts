date and time :  Tue Jan 26 19:57:56 2021
Namespace(batch_size=16, dataset='R52', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_layers=3, num_mlp_layers=1, random_vec=True, seed=0, weight_decay=1e-05)
device :  cuda:0
HGNNModel(
  (word_embeddings): Embedding(9333, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=52, bias=True)
    (1): Linear(in_features=200, out_features=52, bias=True)
    (2): Linear(in_features=200, out_features=52, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  388.0859455913305 Time :  14
accuracy train: 0.893801 val: 0.875000 test: 0.855253
max validation accuracy : 0.875000 max acc epoch : 1.000000 test accuracy : 0.855253

Epoch :  2 loss training:  164.9417453277856 Time :  26
accuracy train: 0.938855 val: 0.896341 test: 0.888327
max validation accuracy : 0.896341 max acc epoch : 2.000000 test accuracy : 0.888327

Epoch :  3 loss training:  101.41105331201106 Time :  36
accuracy train: 0.976626 val: 0.913110 test: 0.901167
max validation accuracy : 0.913110 max acc epoch : 3.000000 test accuracy : 0.901167

Epoch :  4 loss training:  64.39222814841196 Time :  48
accuracy train: 0.986958 val: 0.916159 test: 0.908949
max validation accuracy : 0.916159 max acc epoch : 4.000000 test accuracy : 0.908949

Epoch :  5 loss training:  46.91287894558627 Time :  59
accuracy train: 0.993902 val: 0.925305 test: 0.912840
max validation accuracy : 0.925305 max acc epoch : 5.000000 test accuracy : 0.912840

Epoch :  6 loss training:  26.720677637204062 Time :  71
accuracy train: 0.995766 val: 0.934451 test: 0.916342
max validation accuracy : 0.934451 max acc epoch : 6.000000 test accuracy : 0.916342

Epoch :  7 loss training:  20.91583183023613 Time :  82
accuracy train: 0.996104 val: 0.939024 test: 0.914786
max validation accuracy : 0.939024 max acc epoch : 7.000000 test accuracy : 0.914786

Epoch :  8 loss training:  16.96776403754484 Time :  93
accuracy train: 0.998814 val: 0.939024 test: 0.915564
max validation accuracy : 0.939024 max acc epoch : 7.000000 test accuracy : 0.914786

Epoch :  9 loss training:  13.14751314788009 Time :  106
accuracy train: 0.998137 val: 0.943598 test: 0.916732
max validation accuracy : 0.943598 max acc epoch : 9.000000 test accuracy : 0.916732

Epoch :  10 loss training:  13.290570983925136 Time :  117
accuracy train: 0.998476 val: 0.935976 test: 0.918288
max validation accuracy : 0.943598 max acc epoch : 9.000000 test accuracy : 0.916732

Epoch :  11 loss training:  11.000059975718614 Time :  127
accuracy train: 0.998476 val: 0.942073 test: 0.919455
max validation accuracy : 0.943598 max acc epoch : 9.000000 test accuracy : 0.916732

Epoch :  12 loss training:  8.009706603421364 Time :  138
accuracy train: 0.998645 val: 0.942073 test: 0.917121
max validation accuracy : 0.943598 max acc epoch : 9.000000 test accuracy : 0.916732

Epoch :  13 loss training:  5.9102811563934665 Time :  148
accuracy train: 0.998984 val: 0.943598 test: 0.915953
max validation accuracy : 0.943598 max acc epoch : 9.000000 test accuracy : 0.916732

Epoch :  14 loss training:  6.510224110803392 Time :  159
accuracy train: 0.998984 val: 0.945122 test: 0.917121
max validation accuracy : 0.945122 max acc epoch : 14.000000 test accuracy : 0.917121

Epoch :  15 loss training:  5.832121057952463 Time :  170
accuracy train: 0.998984 val: 0.939024 test: 0.914786
max validation accuracy : 0.945122 max acc epoch : 14.000000 test accuracy : 0.917121

Epoch :  16 loss training:  6.237500245777483 Time :  181
accuracy train: 0.999153 val: 0.945122 test: 0.920623
max validation accuracy : 0.945122 max acc epoch : 14.000000 test accuracy : 0.917121

Epoch :  17 loss training:  5.192552555061411 Time :  192
accuracy train: 0.999153 val: 0.939024 test: 0.916732
max validation accuracy : 0.945122 max acc epoch : 14.000000 test accuracy : 0.917121

Epoch :  18 loss training:  4.274202617976698 Time :  204
accuracy train: 0.999153 val: 0.937500 test: 0.916732
max validation accuracy : 0.945122 max acc epoch : 14.000000 test accuracy : 0.917121

Epoch :  19 loss training:  5.248783017545065 Time :  216
accuracy train: 0.998984 val: 0.940549 test: 0.917121
max validation accuracy : 0.945122 max acc epoch : 14.000000 test accuracy : 0.917121

Epoch :  20 loss training:  4.471521310184471 Time :  226
accuracy train: 0.998984 val: 0.946646 test: 0.917510
max validation accuracy : 0.946646 max acc epoch : 20.000000 test accuracy : 0.917510

Epoch :  21 loss training:  3.379685183357651 Time :  237
accuracy train: 0.999153 val: 0.943598 test: 0.917899
max validation accuracy : 0.946646 max acc epoch : 20.000000 test accuracy : 0.917510

Epoch :  22 loss training:  5.363627094884578 Time :  249
accuracy train: 0.998984 val: 0.946646 test: 0.917121
max validation accuracy : 0.946646 max acc epoch : 20.000000 test accuracy : 0.917510

Epoch :  23 loss training:  3.749490862057428 Time :  262
accuracy train: 0.999153 val: 0.945122 test: 0.914786
max validation accuracy : 0.946646 max acc epoch : 20.000000 test accuracy : 0.917510

Epoch :  24 loss training:  3.7033208358316188 Time :  272
accuracy train: 0.998814 val: 0.942073 test: 0.916732
max validation accuracy : 0.946646 max acc epoch : 20.000000 test accuracy : 0.917510

Epoch :  25 loss training:  3.258954163378803 Time :  283
accuracy train: 0.999153 val: 0.942073 test: 0.917899
max validation accuracy : 0.946646 max acc epoch : 20.000000 test accuracy : 0.917510

Epoch :  26 loss training:  4.032205179935772 Time :  295
accuracy train: 0.998984 val: 0.945122 test: 0.918677
max validation accuracy : 0.946646 max acc epoch : 20.000000 test accuracy : 0.917510

Epoch :  27 loss training:  3.0061579725461343 Time :  306
accuracy train: 0.998984 val: 0.940549 test: 0.917121
max validation accuracy : 0.946646 max acc epoch : 20.000000 test accuracy : 0.917510

Epoch :  28 loss training:  2.7561758479678247 Time :  317
accuracy train: 0.998984 val: 0.939024 test: 0.917510
max validation accuracy : 0.946646 max acc epoch : 20.000000 test accuracy : 0.917510

Epoch :  29 loss training:  2.615919584744006 Time :  327
accuracy train: 0.998984 val: 0.943598 test: 0.917899
max validation accuracy : 0.946646 max acc epoch : 20.000000 test accuracy : 0.917510

Epoch :  30 loss training:  3.8132455172635673 Time :  337
accuracy train: 0.999153 val: 0.942073 test: 0.917899
max validation accuracy : 0.946646 max acc epoch : 20.000000 test accuracy : 0.917510

Epoch :  31 loss training:  2.1168414580479293 Time :  347
accuracy train: 0.999153 val: 0.942073 test: 0.918288
max validation accuracy : 0.946646 max acc epoch : 20.000000 test accuracy : 0.917510

Epoch :  32 loss training:  2.2056252961801874 Time :  356
accuracy train: 0.999153 val: 0.942073 test: 0.917510
max validation accuracy : 0.946646 max acc epoch : 20.000000 test accuracy : 0.917510

Epoch :  33 loss training:  3.4068190311591025 Time :  366
accuracy train: 0.999153 val: 0.942073 test: 0.915175
max validation accuracy : 0.946646 max acc epoch : 20.000000 test accuracy : 0.917510

Epoch :  34 loss training:  2.8446570691021407 Time :  376
accuracy train: 0.998984 val: 0.943598 test: 0.918288
max validation accuracy : 0.946646 max acc epoch : 20.000000 test accuracy : 0.917510

Epoch :  35 loss training:  2.8704715090407262 Time :  386
accuracy train: 0.998984 val: 0.942073 test: 0.918288
max validation accuracy : 0.946646 max acc epoch : 20.000000 test accuracy : 0.917510

Epoch :  36 loss training:  2.6330118082605622 Time :  396
accuracy train: 0.998984 val: 0.940549 test: 0.917121
max validation accuracy : 0.946646 max acc epoch : 20.000000 test accuracy : 0.917510

Epoch :  37 loss training:  2.685399471229175 Time :  406
accuracy train: 0.998984 val: 0.943598 test: 0.918288
max validation accuracy : 0.946646 max acc epoch : 20.000000 test accuracy : 0.917510

Epoch :  38 loss training:  2.640981013802957 Time :  415
accuracy train: 0.998984 val: 0.945122 test: 0.917510
max validation accuracy : 0.946646 max acc epoch : 20.000000 test accuracy : 0.917510

Epoch :  39 loss training:  2.400949209440455 Time :  424
accuracy train: 0.998984 val: 0.942073 test: 0.917510
max validation accuracy : 0.946646 max acc epoch : 20.000000 test accuracy : 0.917510

Epoch :  40 loss training:  2.364750670363719 Time :  434
accuracy train: 0.998984 val: 0.945122 test: 0.915953
max validation accuracy : 0.946646 max acc epoch : 20.000000 test accuracy : 0.917510

Epoch :  41 loss training:  3.4063777354917875 Time :  444
accuracy train: 0.998984 val: 0.946646 test: 0.918677
max validation accuracy : 0.946646 max acc epoch : 20.000000 test accuracy : 0.917510

========================================================================================================================================================================================================
max acc epoch :  20
max validation accuracy :  0.9466463414634146
test accuracy :  0.9175097276264591
latest_test_accuracy :  0.9186770428015564
========================================================================================================================================================================================================

