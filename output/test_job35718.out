

date and time :  Sat Jun  5 18:47:35 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.005, num_Exp=5, num_clusters=0, num_layers=3, num_mlp_layers=1, random_vec=False, seed=364, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  100.50799298286438 Time :  11
accuracy train: 0.788215 val: 0.771831 test: 0.766179
max validation accuracy : 0.771831 max acc epoch : 1 test accuracy : 0.766179
Epoch-1 lr: 0.005

Epoch :  2 loss training:  88.75926893949509 Time :  20
accuracy train: 0.771335 val: 0.760563 test: 0.736353
max validation accuracy : 0.771831 max acc epoch : 1 test accuracy : 0.766179
Epoch-2 lr: 0.005

Epoch :  3 loss training:  80.55655658245087 Time :  29
accuracy train: 0.844795 val: 0.790141 test: 0.780248
max validation accuracy : 0.790141 max acc epoch : 3 test accuracy : 0.780248
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  70.04723261296749 Time :  38
accuracy train: 0.864802 val: 0.800000 test: 0.776590
max validation accuracy : 0.800000 max acc epoch : 4 test accuracy : 0.776590
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  64.96661321818829 Time :  47
accuracy train: 0.857612 val: 0.777465 test: 0.763647
max validation accuracy : 0.800000 max acc epoch : 4 test accuracy : 0.776590
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  61.8672401458025 Time :  55
accuracy train: 0.898093 val: 0.784507 test: 0.767304
max validation accuracy : 0.800000 max acc epoch : 4 test accuracy : 0.776590
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  54.263144105672836 Time :  63
accuracy train: 0.923414 val: 0.781690 test: 0.775183
max validation accuracy : 0.800000 max acc epoch : 4 test accuracy : 0.776590
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  49.71103662252426 Time :  71
accuracy train: 0.932948 val: 0.783099 test: 0.774902
max validation accuracy : 0.800000 max acc epoch : 4 test accuracy : 0.776590
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  44.8728985786438 Time :  80
accuracy train: 0.950610 val: 0.792958 test: 0.778559
max validation accuracy : 0.800000 max acc epoch : 4 test accuracy : 0.776590
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  40.53656154125929 Time :  89
accuracy train: 0.946858 val: 0.780282 test: 0.770681
max validation accuracy : 0.800000 max acc epoch : 4 test accuracy : 0.776590
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  37.305993154644966 Time :  97
accuracy train: 0.962176 val: 0.784507 test: 0.773213
max validation accuracy : 0.800000 max acc epoch : 4 test accuracy : 0.776590
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  36.23282042145729 Time :  106
accuracy train: 0.972491 val: 0.801408 test: 0.773776
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  33.27864518761635 Time :  114
accuracy train: 0.969678 val: 0.780282 test: 0.770400
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  32.59676295518875 Time :  123
accuracy train: 0.976399 val: 0.798592 test: 0.775464
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  30.378315221518278 Time :  132
accuracy train: 0.979525 val: 0.791549 test: 0.773213
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  16 loss training:  30.048570103943348 Time :  141
accuracy train: 0.984839 val: 0.788732 test: 0.770681
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  17 loss training:  25.36904137581587 Time :  154
accuracy train: 0.988903 val: 0.778873 test: 0.766179
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  18 loss training:  21.81664752215147 Time :  169
accuracy train: 0.993435 val: 0.784507 test: 0.771244
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  19 loss training:  17.608413541689515 Time :  180
accuracy train: 0.994842 val: 0.791549 test: 0.768430
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  20 loss training:  16.531202921643853 Time :  195
accuracy train: 0.996249 val: 0.777465 test: 0.766179
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  21 loss training:  14.44805221259594 Time :  213
accuracy train: 0.997030 val: 0.781690 test: 0.765898
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  22 loss training:  12.309672825038433 Time :  230
accuracy train: 0.998750 val: 0.769014 test: 0.760551
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  23 loss training:  11.471845511347055 Time :  248
accuracy train: 0.998593 val: 0.774648 test: 0.765053
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  24 loss training:  9.776056786067784 Time :  265
accuracy train: 0.998750 val: 0.777465 test: 0.759989
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  25 loss training:  8.301608376204967 Time :  282
accuracy train: 0.998593 val: 0.777465 test: 0.767586
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  26 loss training:  7.046469327993691 Time :  299
accuracy train: 0.999531 val: 0.767606 test: 0.762240
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  27 loss training:  6.551888798829168 Time :  316
accuracy train: 0.999375 val: 0.770423 test: 0.762521
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  28 loss training:  6.016906377859414 Time :  334
accuracy train: 0.999687 val: 0.776056 test: 0.768430
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  29 loss training:  5.707978190854192 Time :  351
accuracy train: 0.999531 val: 0.759155 test: 0.770118
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  30 loss training:  4.880919894669205 Time :  368
accuracy train: 0.999844 val: 0.771831 test: 0.767867
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  31 loss training:  4.733604449313134 Time :  386
accuracy train: 0.999844 val: 0.767606 test: 0.765335
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  32 loss training:  4.087441144511104 Time :  404
accuracy train: 0.999062 val: 0.767606 test: 0.762521
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  33 loss training:  3.5513765891082585 Time :  421
accuracy train: 0.998750 val: 0.759155 test: 0.764209
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  34 loss training:  3.5360227406490594 Time :  439
accuracy train: 0.999844 val: 0.763380 test: 0.764209
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  35 loss training:  3.2727714541833848 Time :  456
accuracy train: 0.999531 val: 0.760563 test: 0.762240
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  36 loss training:  2.7560116078238934 Time :  473
accuracy train: 0.999375 val: 0.766197 test: 0.765053
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  37 loss training:  3.1416112976148725 Time :  487
accuracy train: 0.999844 val: 0.756338 test: 0.764491
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  38 loss training:  2.3315920342574827 Time :  500
accuracy train: 0.999531 val: 0.757746 test: 0.765053
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  39 loss training:  3.0011529609328136 Time :  512
accuracy train: 0.999687 val: 0.764789 test: 0.760833
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  40 loss training:  3.0834208610467613 Time :  520
accuracy train: 0.999375 val: 0.753521 test: 0.764209
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  41 loss training:  2.8969339663162827 Time :  527
accuracy train: 0.999687 val: 0.767606 test: 0.761396
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  42 loss training:  2.614084406173788 Time :  538
accuracy train: 0.999844 val: 0.760563 test: 0.759145
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

Epoch :  43 loss training:  2.1363534356933087 Time :  550
accuracy train: 0.999844 val: 0.753521 test: 0.757738
max validation accuracy : 0.801408 max acc epoch : 12 test accuracy : 0.773776

========================================================================================================================================================================================================
max acc epoch :  12
max validation accuracy :  0.8014084507042254
test accuracy :  0.7737760270118177
last test_accuracy :  0.7577377602701182
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.005, num_Exp=5, num_clusters=0, num_layers=3, num_mlp_layers=1, random_vec=False, seed=364, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  102.33902505040169 Time :  562
accuracy train: 0.710222 val: 0.697183 test: 0.699775
max validation accuracy : 0.697183 max acc epoch : 1 test accuracy : 0.699775
Epoch-1 lr: 0.005

Epoch :  2 loss training:  91.01086527109146 Time :  571
accuracy train: 0.783682 val: 0.781690 test: 0.755768
max validation accuracy : 0.781690 max acc epoch : 2 test accuracy : 0.755768
Epoch-2 lr: 0.005

Epoch :  3 loss training:  86.54212695360184 Time :  584
accuracy train: 0.790872 val: 0.776056 test: 0.768993
max validation accuracy : 0.781690 max acc epoch : 2 test accuracy : 0.755768
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  77.48866859078407 Time :  593
accuracy train: 0.785402 val: 0.763380 test: 0.752673
max validation accuracy : 0.781690 max acc epoch : 2 test accuracy : 0.755768
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  75.1027974486351 Time :  602
accuracy train: 0.810722 val: 0.770423 test: 0.765898
max validation accuracy : 0.781690 max acc epoch : 2 test accuracy : 0.755768
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  72.53030499815941 Time :  612
accuracy train: 0.843232 val: 0.783099 test: 0.767867
max validation accuracy : 0.783099 max acc epoch : 6 test accuracy : 0.767867
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  68.65972657501698 Time :  625
accuracy train: 0.855111 val: 0.784507 test: 0.776308
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.776308
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  66.77920179069042 Time :  635
accuracy train: 0.869178 val: 0.783099 test: 0.772088
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.776308
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  63.118252113461494 Time :  644
accuracy train: 0.889966 val: 0.792958 test: 0.768430
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  59.36126893758774 Time :  657
accuracy train: 0.891060 val: 0.784507 test: 0.768993
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  57.84722712635994 Time :  667
accuracy train: 0.903095 val: 0.781690 test: 0.769837
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  56.32611866295338 Time :  676
accuracy train: 0.910128 val: 0.778873 test: 0.767304
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  53.93522970378399 Time :  687
accuracy train: 0.914661 val: 0.784507 test: 0.768993
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  52.54909634590149 Time :  698
accuracy train: 0.920444 val: 0.780282 test: 0.768430
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  51.176558792591095 Time :  707
accuracy train: 0.922788 val: 0.776056 test: 0.768430
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430

Epoch :  16 loss training:  50.8438188880682 Time :  718
accuracy train: 0.936699 val: 0.784507 test: 0.769837
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430

Epoch :  17 loss training:  44.94842837005854 Time :  729
accuracy train: 0.952641 val: 0.780282 test: 0.774339
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430

Epoch :  18 loss training:  40.205242678523064 Time :  739
accuracy train: 0.962801 val: 0.785915 test: 0.770400
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430

Epoch :  19 loss training:  35.82651948928833 Time :  747
accuracy train: 0.966083 val: 0.776056 test: 0.765053
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430

Epoch :  20 loss training:  32.1621961183846 Time :  762
accuracy train: 0.977180 val: 0.776056 test: 0.768711
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430

Epoch :  21 loss training:  27.833054073154926 Time :  783
accuracy train: 0.982495 val: 0.778873 test: 0.764209
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430

Epoch :  22 loss training:  25.407947599887848 Time :  805
accuracy train: 0.987496 val: 0.774648 test: 0.765898
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430

Epoch :  23 loss training:  23.38158819824457 Time :  825
accuracy train: 0.990622 val: 0.780282 test: 0.763084
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430

Epoch :  24 loss training:  19.44602943211794 Time :  846
accuracy train: 0.989841 val: 0.767606 test: 0.762240
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430

Epoch :  25 loss training:  17.984417378902435 Time :  867
accuracy train: 0.993592 val: 0.760563 test: 0.763365
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430

Epoch :  26 loss training:  15.676838019862771 Time :  888
accuracy train: 0.995624 val: 0.774648 test: 0.761677
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430

Epoch :  27 loss training:  13.573654869571328 Time :  910
accuracy train: 0.997187 val: 0.781690 test: 0.756612
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430

Epoch :  28 loss training:  13.083763743750751 Time :  932
accuracy train: 0.996405 val: 0.776056 test: 0.757738
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430

Epoch :  29 loss training:  11.416738133877516 Time :  955
accuracy train: 0.997187 val: 0.784507 test: 0.752392
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430

Epoch :  30 loss training:  11.007368810474873 Time :  976
accuracy train: 0.998437 val: 0.790141 test: 0.755205
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430

Epoch :  31 loss training:  8.973323269281536 Time :  996
accuracy train: 0.996561 val: 0.774648 test: 0.751548
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430

Epoch :  32 loss training:  8.601234229281545 Time :  1017
accuracy train: 0.998593 val: 0.780282 test: 0.749859
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430

Epoch :  33 loss training:  7.509369621053338 Time :  1038
accuracy train: 0.998906 val: 0.767606 test: 0.748734
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430

Epoch :  34 loss training:  6.743258856702596 Time :  1061
accuracy train: 0.999375 val: 0.764789 test: 0.749015
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430

Epoch :  35 loss training:  5.944338267669082 Time :  1082
accuracy train: 0.999531 val: 0.771831 test: 0.745920
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430

Epoch :  36 loss training:  5.463738460093737 Time :  1102
accuracy train: 0.999219 val: 0.771831 test: 0.745357
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430

Epoch :  37 loss training:  5.7979960611555725 Time :  1124
accuracy train: 0.999531 val: 0.780282 test: 0.748171
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430

Epoch :  38 loss training:  5.093217394780368 Time :  1146
accuracy train: 0.999219 val: 0.749296 test: 0.747046
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430

Epoch :  39 loss training:  5.204226088477299 Time :  1168
accuracy train: 0.998906 val: 0.780282 test: 0.750985
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430

Epoch :  40 loss training:  4.194485827349126 Time :  1190
accuracy train: 0.998906 val: 0.764789 test: 0.744795
max validation accuracy : 0.792958 max acc epoch : 9 test accuracy : 0.768430

========================================================================================================================================================================================================
max acc epoch :  9
max validation accuracy :  0.7929577464788733
test accuracy :  0.7684299380979178
last test_accuracy :  0.7447945976364659
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.005, num_Exp=5, num_clusters=0, num_layers=3, num_mlp_layers=1, random_vec=False, seed=364, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  102.98988077044487 Time :  1212
accuracy train: 0.782745 val: 0.766197 test: 0.765053
max validation accuracy : 0.766197 max acc epoch : 1 test accuracy : 0.765053
Epoch-1 lr: 0.005

Epoch :  2 loss training:  92.17115986347198 Time :  1233
accuracy train: 0.794623 val: 0.766197 test: 0.757456
max validation accuracy : 0.766197 max acc epoch : 1 test accuracy : 0.765053
Epoch-2 lr: 0.005

Epoch :  3 loss training:  92.4546646475792 Time :  1254
accuracy train: 0.798687 val: 0.764789 test: 0.765898
max validation accuracy : 0.766197 max acc epoch : 1 test accuracy : 0.765053
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  79.3931132555008 Time :  1275
accuracy train: 0.826039 val: 0.773239 test: 0.776027
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.776027
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  74.13479901850224 Time :  1296
accuracy train: 0.817756 val: 0.763380 test: 0.754080
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.776027
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  71.93698385357857 Time :  1308
accuracy train: 0.836668 val: 0.785915 test: 0.762521
max validation accuracy : 0.785915 max acc epoch : 6 test accuracy : 0.762521
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  65.41908925771713 Time :  1316
accuracy train: 0.854486 val: 0.785915 test: 0.766742
max validation accuracy : 0.785915 max acc epoch : 6 test accuracy : 0.762521
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  64.49823096394539 Time :  1325
accuracy train: 0.884651 val: 0.781690 test: 0.771806
max validation accuracy : 0.785915 max acc epoch : 6 test accuracy : 0.762521
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  59.362212747335434 Time :  1333
accuracy train: 0.897624 val: 0.777465 test: 0.772651
max validation accuracy : 0.785915 max acc epoch : 6 test accuracy : 0.762521
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  56.23273831605911 Time :  1339
accuracy train: 0.900594 val: 0.785915 test: 0.773213
max validation accuracy : 0.785915 max acc epoch : 6 test accuracy : 0.762521
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  54.080841198563576 Time :  1347
accuracy train: 0.909972 val: 0.780282 test: 0.773776
max validation accuracy : 0.785915 max acc epoch : 6 test accuracy : 0.762521
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  55.02476418018341 Time :  1356
accuracy train: 0.912160 val: 0.781690 test: 0.773776
max validation accuracy : 0.785915 max acc epoch : 6 test accuracy : 0.762521
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  54.244267508387566 Time :  1365
accuracy train: 0.913879 val: 0.783099 test: 0.770681
max validation accuracy : 0.785915 max acc epoch : 6 test accuracy : 0.762521
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  52.76518443226814 Time :  1374
accuracy train: 0.921382 val: 0.773239 test: 0.773495
max validation accuracy : 0.785915 max acc epoch : 6 test accuracy : 0.762521
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  51.45218875259161 Time :  1381
accuracy train: 0.921225 val: 0.788732 test: 0.767867
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  16 loss training:  50.65429911017418 Time :  1389
accuracy train: 0.936543 val: 0.770423 test: 0.771244
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  17 loss training:  44.99328964203596 Time :  1399
accuracy train: 0.949828 val: 0.780282 test: 0.767023
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  18 loss training:  40.33363192528486 Time :  1417
accuracy train: 0.957330 val: 0.780282 test: 0.775183
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  19 loss training:  37.14881385862827 Time :  1433
accuracy train: 0.963739 val: 0.787324 test: 0.772932
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  20 loss training:  32.74545143917203 Time :  1447
accuracy train: 0.976086 val: 0.777465 test: 0.774057
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  21 loss training:  29.190304961055517 Time :  1465
accuracy train: 0.983276 val: 0.784507 test: 0.766742
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  22 loss training:  26.307957034558058 Time :  1482
accuracy train: 0.988278 val: 0.777465 test: 0.768149
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  23 loss training:  25.03155904635787 Time :  1500
accuracy train: 0.990466 val: 0.777465 test: 0.768430
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  24 loss training:  20.647459603846073 Time :  1518
accuracy train: 0.992185 val: 0.787324 test: 0.766742
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  25 loss training:  18.617557540535927 Time :  1535
accuracy train: 0.993592 val: 0.780282 test: 0.771806
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  26 loss training:  17.430163644254208 Time :  1552
accuracy train: 0.995624 val: 0.778873 test: 0.761677
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  27 loss training:  15.147414971143007 Time :  1570
accuracy train: 0.996405 val: 0.770423 test: 0.763928
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  28 loss training:  14.812487374991179 Time :  1589
accuracy train: 0.998124 val: 0.776056 test: 0.760551
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  29 loss training:  12.254126728512347 Time :  1606
accuracy train: 0.998124 val: 0.776056 test: 0.759989
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  30 loss training:  10.986124271526933 Time :  1624
accuracy train: 0.998906 val: 0.778873 test: 0.759426
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  31 loss training:  9.990997805260122 Time :  1641
accuracy train: 0.999375 val: 0.787324 test: 0.761114
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  32 loss training:  9.07841098215431 Time :  1659
accuracy train: 0.999062 val: 0.776056 test: 0.759707
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  33 loss training:  7.992100182920694 Time :  1677
accuracy train: 0.999375 val: 0.770423 test: 0.757456
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  34 loss training:  8.20576130785048 Time :  1695
accuracy train: 0.999375 val: 0.770423 test: 0.760551
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  35 loss training:  7.341320788487792 Time :  1713
accuracy train: 0.999531 val: 0.773239 test: 0.761677
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  36 loss training:  5.963208079338074 Time :  1729
accuracy train: 0.999687 val: 0.773239 test: 0.758301
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  37 loss training:  5.3146450207568705 Time :  1743
accuracy train: 0.999687 val: 0.764789 test: 0.756612
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  38 loss training:  5.082206059247255 Time :  1757
accuracy train: 0.999687 val: 0.764789 test: 0.755768
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  39 loss training:  4.629714725306258 Time :  1768
accuracy train: 0.999844 val: 0.767606 test: 0.753799
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  40 loss training:  4.043128416640684 Time :  1777
accuracy train: 0.999844 val: 0.761972 test: 0.755487
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  41 loss training:  3.836174430558458 Time :  1786
accuracy train: 0.999687 val: 0.766197 test: 0.756331
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  42 loss training:  3.670602897880599 Time :  1799
accuracy train: 0.999687 val: 0.774648 test: 0.757738
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  43 loss training:  2.9950862558325753 Time :  1809
accuracy train: 0.999687 val: 0.764789 test: 0.754361
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  44 loss training:  3.2787612164393067 Time :  1818
accuracy train: 0.999844 val: 0.767606 test: 0.755768
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  45 loss training:  2.8451121021062136 Time :  1830
accuracy train: 1.000000 val: 0.759155 test: 0.753517
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

Epoch :  46 loss training:  2.8802102878689766 Time :  1843
accuracy train: 1.000000 val: 0.766197 test: 0.751266
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.767867

========================================================================================================================================================================================================
max acc epoch :  15
max validation accuracy :  0.7887323943661971
test accuracy :  0.7678671918964547
last test_accuracy :  0.7512661789532921
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.005, num_Exp=5, num_clusters=0, num_layers=3, num_mlp_layers=1, random_vec=False, seed=364, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  101.4668191075325 Time :  1856
accuracy train: 0.682401 val: 0.673239 test: 0.673889
max validation accuracy : 0.673239 max acc epoch : 1 test accuracy : 0.673889
Epoch-1 lr: 0.005

Epoch :  2 loss training:  93.75241795182228 Time :  1865
accuracy train: 0.791654 val: 0.771831 test: 0.764772
max validation accuracy : 0.771831 max acc epoch : 2 test accuracy : 0.764772
Epoch-2 lr: 0.005

Epoch :  3 loss training:  86.26434403657913 Time :  1875
accuracy train: 0.793529 val: 0.770423 test: 0.766742
max validation accuracy : 0.771831 max acc epoch : 2 test accuracy : 0.764772
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  75.86122460663319 Time :  1886
accuracy train: 0.823851 val: 0.787324 test: 0.770962
max validation accuracy : 0.787324 max acc epoch : 4 test accuracy : 0.770962
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  72.87277376651764 Time :  1895
accuracy train: 0.810097 val: 0.766197 test: 0.753799
max validation accuracy : 0.787324 max acc epoch : 4 test accuracy : 0.770962
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  70.53571352362633 Time :  1904
accuracy train: 0.845889 val: 0.771831 test: 0.768711
max validation accuracy : 0.787324 max acc epoch : 4 test accuracy : 0.770962
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  65.64894695580006 Time :  1916
accuracy train: 0.875274 val: 0.784507 test: 0.778841
max validation accuracy : 0.787324 max acc epoch : 4 test accuracy : 0.770962
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  62.61117896437645 Time :  1927
accuracy train: 0.895280 val: 0.776056 test: 0.777153
max validation accuracy : 0.787324 max acc epoch : 4 test accuracy : 0.770962
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  58.03955918550491 Time :  1935
accuracy train: 0.899187 val: 0.781690 test: 0.772932
max validation accuracy : 0.787324 max acc epoch : 4 test accuracy : 0.770962
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  54.46866920590401 Time :  1946
accuracy train: 0.902313 val: 0.776056 test: 0.762521
max validation accuracy : 0.787324 max acc epoch : 4 test accuracy : 0.770962
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  52.41928252577782 Time :  1959
accuracy train: 0.918881 val: 0.792958 test: 0.768430
max validation accuracy : 0.792958 max acc epoch : 11 test accuracy : 0.768430
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  50.733604311943054 Time :  1967
accuracy train: 0.930760 val: 0.794366 test: 0.772651
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  48.475683249533176 Time :  1976
accuracy train: 0.922476 val: 0.788732 test: 0.765898
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  46.17791849374771 Time :  1988
accuracy train: 0.935761 val: 0.785915 test: 0.768993
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  45.07955361902714 Time :  1999
accuracy train: 0.940138 val: 0.792958 test: 0.771525
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  16 loss training:  44.93161752820015 Time :  2008
accuracy train: 0.953423 val: 0.788732 test: 0.768430
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  17 loss training:  39.088399827480316 Time :  2017
accuracy train: 0.962176 val: 0.781690 test: 0.768711
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  18 loss training:  33.641666889190674 Time :  2032
accuracy train: 0.967959 val: 0.783099 test: 0.773776
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  19 loss training:  30.178597081452608 Time :  2055
accuracy train: 0.979525 val: 0.785915 test: 0.771806
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  20 loss training:  26.48594482243061 Time :  2075
accuracy train: 0.979994 val: 0.787324 test: 0.768149
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  21 loss training:  22.63140146434307 Time :  2098
accuracy train: 0.986558 val: 0.787324 test: 0.770400
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  22 loss training:  19.59590844810009 Time :  2121
accuracy train: 0.991872 val: 0.785915 test: 0.768993
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  23 loss training:  18.16593796852976 Time :  2143
accuracy train: 0.991560 val: 0.783099 test: 0.763928
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  24 loss training:  14.898725291714072 Time :  2166
accuracy train: 0.994842 val: 0.771831 test: 0.765898
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  25 loss training:  13.177363960072398 Time :  2190
accuracy train: 0.997030 val: 0.780282 test: 0.763928
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  26 loss training:  11.678059425204992 Time :  2213
accuracy train: 0.997656 val: 0.769014 test: 0.763928
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  27 loss training:  9.26724497973919 Time :  2236
accuracy train: 0.996093 val: 0.766197 test: 0.758301
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  28 loss training:  9.115471068769693 Time :  2258
accuracy train: 0.997968 val: 0.763380 test: 0.759426
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  29 loss training:  8.112636084668338 Time :  2281
accuracy train: 0.999062 val: 0.764789 test: 0.759989
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  30 loss training:  6.745269486214966 Time :  2304
accuracy train: 0.998906 val: 0.764789 test: 0.761114
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  31 loss training:  6.032028877642006 Time :  2328
accuracy train: 0.998437 val: 0.746479 test: 0.759145
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  32 loss training:  5.618714053649455 Time :  2350
accuracy train: 0.997812 val: 0.735211 test: 0.756612
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  33 loss training:  4.530219243839383 Time :  2373
accuracy train: 0.998593 val: 0.753521 test: 0.753236
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  34 loss training:  4.731276916107163 Time :  2395
accuracy train: 0.999531 val: 0.740845 test: 0.758301
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  35 loss training:  4.487330908887088 Time :  2419
accuracy train: 0.999531 val: 0.761972 test: 0.752673
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  36 loss training:  3.6211314930114895 Time :  2442
accuracy train: 0.999687 val: 0.757746 test: 0.756331
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  37 loss training:  3.5029214163077995 Time :  2460
accuracy train: 0.998593 val: 0.745070 test: 0.754080
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  38 loss training:  3.149886740837246 Time :  2468
accuracy train: 0.999687 val: 0.754930 test: 0.755205
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  39 loss training:  2.639860365423374 Time :  2477
accuracy train: 0.999531 val: 0.754930 test: 0.755768
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  40 loss training:  2.2428803003567737 Time :  2486
accuracy train: 0.999531 val: 0.740845 test: 0.756894
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  41 loss training:  2.36617075355025 Time :  2495
accuracy train: 0.998437 val: 0.736620 test: 0.753799
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  42 loss training:  2.2898900297586806 Time :  2504
accuracy train: 0.999844 val: 0.754930 test: 0.754361
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

Epoch :  43 loss training:  2.070343574450817 Time :  2512
accuracy train: 0.999844 val: 0.746479 test: 0.751829
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.772651

========================================================================================================================================================================================================
max acc epoch :  12
max validation accuracy :  0.7943661971830986
test accuracy :  0.7726505346088914
last test_accuracy :  0.7518289251547552
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.005, num_Exp=5, num_clusters=0, num_layers=3, num_mlp_layers=1, random_vec=False, seed=364, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  98.15461680293083 Time :  2521
accuracy train: 0.765864 val: 0.746479 test: 0.746764
max validation accuracy : 0.746479 max acc epoch : 1 test accuracy : 0.746764
Epoch-1 lr: 0.005

Epoch :  2 loss training:  89.58484560251236 Time :  2530
accuracy train: 0.802126 val: 0.781690 test: 0.763647
max validation accuracy : 0.781690 max acc epoch : 2 test accuracy : 0.763647
Epoch-2 lr: 0.005

Epoch :  3 loss training:  86.33462065458298 Time :  2539
accuracy train: 0.824476 val: 0.778873 test: 0.776308
max validation accuracy : 0.781690 max acc epoch : 2 test accuracy : 0.763647
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  73.63407428562641 Time :  2547
accuracy train: 0.834636 val: 0.780282 test: 0.767023
max validation accuracy : 0.781690 max acc epoch : 2 test accuracy : 0.763647
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  70.95953561365604 Time :  2556
accuracy train: 0.814786 val: 0.760563 test: 0.744232
max validation accuracy : 0.781690 max acc epoch : 2 test accuracy : 0.763647
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  67.10326351225376 Time :  2565
accuracy train: 0.718193 val: 0.692958 test: 0.676421
max validation accuracy : 0.781690 max acc epoch : 2 test accuracy : 0.763647
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  62.321567222476006 Time :  2573
accuracy train: 0.890122 val: 0.787324 test: 0.775464
max validation accuracy : 0.787324 max acc epoch : 7 test accuracy : 0.775464
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  59.74750620126724 Time :  2582
accuracy train: 0.901688 val: 0.785915 test: 0.776590
max validation accuracy : 0.787324 max acc epoch : 7 test accuracy : 0.775464
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  54.91791582107544 Time :  2590
accuracy train: 0.901688 val: 0.780282 test: 0.768149
max validation accuracy : 0.787324 max acc epoch : 7 test accuracy : 0.775464
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  52.24805226922035 Time :  2599
accuracy train: 0.868084 val: 0.774648 test: 0.738886
max validation accuracy : 0.787324 max acc epoch : 7 test accuracy : 0.775464
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  49.08573134243488 Time :  2607
accuracy train: 0.934354 val: 0.790141 test: 0.775464
max validation accuracy : 0.790141 max acc epoch : 11 test accuracy : 0.775464
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  48.06324192881584 Time :  2616
accuracy train: 0.937168 val: 0.791549 test: 0.776590
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.776590
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  45.66381970793009 Time :  2625
accuracy train: 0.924977 val: 0.790141 test: 0.762240
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.776590
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  44.27627106755972 Time :  2633
accuracy train: 0.945608 val: 0.795775 test: 0.773776
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  42.590084075927734 Time :  2641
accuracy train: 0.949984 val: 0.794366 test: 0.770400
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  16 loss training:  42.682375982403755 Time :  2649
accuracy train: 0.953579 val: 0.784507 test: 0.770400
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  17 loss training:  37.69258815050125 Time :  2657
accuracy train: 0.960144 val: 0.784507 test: 0.768430
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  18 loss training:  32.628550216555595 Time :  2666
accuracy train: 0.959519 val: 0.784507 test: 0.767023
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  19 loss training:  28.963488280773163 Time :  2675
accuracy train: 0.967021 val: 0.774648 test: 0.764772
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  20 loss training:  25.807901985943317 Time :  2682
accuracy train: 0.984058 val: 0.776056 test: 0.771806
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  21 loss training:  22.908267941325903 Time :  2690
accuracy train: 0.988121 val: 0.787324 test: 0.770400
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  22 loss training:  20.593677449971437 Time :  2699
accuracy train: 0.979525 val: 0.773239 test: 0.759707
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  23 loss training:  18.89573085308075 Time :  2708
accuracy train: 0.993592 val: 0.784507 test: 0.771525
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  24 loss training:  15.963129920884967 Time :  2717
accuracy train: 0.996561 val: 0.787324 test: 0.768711
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  25 loss training:  14.89334623515606 Time :  2727
accuracy train: 0.992341 val: 0.777465 test: 0.761677
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  26 loss training:  12.319866381585598 Time :  2736
accuracy train: 0.997187 val: 0.776056 test: 0.766179
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  27 loss training:  10.812393001280725 Time :  2744
accuracy train: 0.998593 val: 0.770423 test: 0.762521
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  28 loss training:  10.778118992224336 Time :  2753
accuracy train: 0.996874 val: 0.764789 test: 0.764772
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  29 loss training:  9.16908363532275 Time :  2762
accuracy train: 0.998437 val: 0.784507 test: 0.760833
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  30 loss training:  7.49104842916131 Time :  2771
accuracy train: 0.997812 val: 0.777465 test: 0.767304
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  31 loss training:  7.292814532294869 Time :  2785
accuracy train: 0.998750 val: 0.774648 test: 0.764491
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  32 loss training:  6.342239575460553 Time :  2801
accuracy train: 0.996718 val: 0.764789 test: 0.760551
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  33 loss training:  5.773600596468896 Time :  2813
accuracy train: 0.999062 val: 0.771831 test: 0.765335
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  34 loss training:  5.920145266922191 Time :  2828
accuracy train: 0.998437 val: 0.763380 test: 0.759707
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  35 loss training:  4.957891835831106 Time :  2845
accuracy train: 1.000000 val: 0.757746 test: 0.761677
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  36 loss training:  4.174751140642911 Time :  2862
accuracy train: 1.000000 val: 0.766197 test: 0.764772
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  37 loss training:  3.632168344920501 Time :  2880
accuracy train: 0.999844 val: 0.757746 test: 0.762240
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  38 loss training:  3.54904738930054 Time :  2897
accuracy train: 0.999531 val: 0.757746 test: 0.762240
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  39 loss training:  3.2992056796792895 Time :  2915
accuracy train: 0.998750 val: 0.760563 test: 0.763647
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  40 loss training:  2.739013720769435 Time :  2932
accuracy train: 0.999844 val: 0.760563 test: 0.764491
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  41 loss training:  2.9686596458777785 Time :  2949
accuracy train: 0.999687 val: 0.764789 test: 0.761114
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  42 loss training:  2.5939859552308917 Time :  2967
accuracy train: 1.000000 val: 0.770423 test: 0.764491
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  43 loss training:  2.0677088454249315 Time :  2984
accuracy train: 0.999844 val: 0.771831 test: 0.759426
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  44 loss training:  2.153488796786405 Time :  3002
accuracy train: 1.000000 val: 0.773239 test: 0.764209
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

Epoch :  45 loss training:  1.861926083045546 Time :  3019
accuracy train: 0.998906 val: 0.753521 test: 0.753517
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.773776

========================================================================================================================================================================================================
max acc epoch :  14
max validation accuracy :  0.795774647887324
test accuracy :  0.7737760270118177
last test_accuracy :  0.7535171637591446
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.80141 	 test_accuracy : 0.77378 	 max_acc epoch :  12 	 last test_accuracy : 0.75774
k :  1 	 val_accuracy : 0.79296 	 test_accuracy : 0.76843 	 max_acc epoch :  9 	 last test_accuracy : 0.74479
k :  2 	 val_accuracy : 0.78873 	 test_accuracy : 0.76787 	 max_acc epoch :  15 	 last test_accuracy : 0.75127
k :  3 	 val_accuracy : 0.79437 	 test_accuracy : 0.77265 	 max_acc epoch :  12 	 last test_accuracy : 0.75183
k :  4 	 val_accuracy : 0.79577 	 test_accuracy : 0.77378 	 max_acc epoch :  14 	 last test_accuracy : 0.75352

avg :  	 val_accuracy : 0.79465 	 test_accuracy : 0.77130 	 last_accuracy : 0.75183


date and time :  Sat Jun  5 19:38:02 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_Exp=5, num_clusters=0, num_layers=3, num_mlp_layers=1, random_vec=False, seed=495, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.12910443544388 Time :  19
accuracy train: 0.783370 val: 0.733803 test: 0.763365
max validation accuracy : 0.733803 max acc epoch : 1 test accuracy : 0.763365
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  81.82398819923401 Time :  37
accuracy train: 0.798531 val: 0.756338 test: 0.776027
max validation accuracy : 0.756338 max acc epoch : 2 test accuracy : 0.776027
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  78.54407808184624 Time :  55
accuracy train: 0.805252 val: 0.763380 test: 0.775464
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  73.27578693628311 Time :  70
accuracy train: 0.821976 val: 0.752113 test: 0.780248
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  72.0252087265253 Time :  84
accuracy train: 0.824164 val: 0.746479 test: 0.784187
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  71.17083384096622 Time :  97
accuracy train: 0.831666 val: 0.760563 test: 0.782780
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.47664734721184 Time :  109
accuracy train: 0.846046 val: 0.761972 test: 0.781092
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.31166715919971 Time :  118
accuracy train: 0.847765 val: 0.749296 test: 0.781092
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.85103538632393 Time :  127
accuracy train: 0.851204 val: 0.752113 test: 0.785875
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  65.22239074110985 Time :  139
accuracy train: 0.858550 val: 0.749296 test: 0.783061
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  64.74192397296429 Time :  150
accuracy train: 0.861363 val: 0.749296 test: 0.783343
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  65.91208472847939 Time :  159
accuracy train: 0.861676 val: 0.750704 test: 0.780529
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  63.444719046354294 Time :  167
accuracy train: 0.863707 val: 0.757746 test: 0.782499
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  63.69364649057388 Time :  180
accuracy train: 0.862926 val: 0.753521 test: 0.785031
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  64.15193675458431 Time :  190
accuracy train: 0.867302 val: 0.754930 test: 0.781936
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464

Epoch :  16 loss training:  63.59080348908901 Time :  199
accuracy train: 0.870428 val: 0.750704 test: 0.780529
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464

Epoch :  17 loss training:  61.520702958106995 Time :  211
accuracy train: 0.875899 val: 0.753521 test: 0.779403
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464

Epoch :  18 loss training:  61.271131202578545 Time :  222
accuracy train: 0.878243 val: 0.757746 test: 0.782780
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464

Epoch :  19 loss training:  60.9180875569582 Time :  231
accuracy train: 0.883401 val: 0.745070 test: 0.782780
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464

Epoch :  20 loss training:  59.414939522743225 Time :  242
accuracy train: 0.888559 val: 0.757746 test: 0.779966
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464

Epoch :  21 loss training:  60.25850236415863 Time :  255
accuracy train: 0.895749 val: 0.745070 test: 0.783343
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464

Epoch :  22 loss training:  58.0818445533514 Time :  264
accuracy train: 0.892779 val: 0.754930 test: 0.779685
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464

Epoch :  23 loss training:  57.6526145786047 Time :  273
accuracy train: 0.897624 val: 0.753521 test: 0.781092
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464

Epoch :  24 loss training:  56.78318673372269 Time :  285
accuracy train: 0.901532 val: 0.750704 test: 0.781936
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464

Epoch :  25 loss training:  55.57190653681755 Time :  296
accuracy train: 0.904033 val: 0.754930 test: 0.783343
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464

Epoch :  26 loss training:  54.804092049598694 Time :  305
accuracy train: 0.907002 val: 0.747887 test: 0.787001
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464

Epoch :  27 loss training:  53.75570897758007 Time :  316
accuracy train: 0.911847 val: 0.759155 test: 0.785031
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464

Epoch :  28 loss training:  52.88015699386597 Time :  328
accuracy train: 0.916380 val: 0.756338 test: 0.781654
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464

Epoch :  29 loss training:  52.19406375288963 Time :  337
accuracy train: 0.920131 val: 0.754930 test: 0.779122
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464

Epoch :  30 loss training:  52.14913459122181 Time :  346
accuracy train: 0.921225 val: 0.760563 test: 0.781936
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464

Epoch :  31 loss training:  50.226905800402164 Time :  355
accuracy train: 0.924508 val: 0.752113 test: 0.780248
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464

Epoch :  32 loss training:  50.350944831967354 Time :  373
accuracy train: 0.928103 val: 0.759155 test: 0.782499
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464

Epoch :  33 loss training:  48.83875396847725 Time :  394
accuracy train: 0.932635 val: 0.754930 test: 0.775464
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464

Epoch :  34 loss training:  47.583485916256905 Time :  415
accuracy train: 0.934042 val: 0.754930 test: 0.780248
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.775464

========================================================================================================================================================================================================
max acc epoch :  3
max validation accuracy :  0.7633802816901408
test accuracy :  0.7754642656162071
last test_accuracy :  0.7802476083286438
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_Exp=5, num_clusters=0, num_layers=3, num_mlp_layers=1, random_vec=False, seed=495, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.10118144750595 Time :  438
accuracy train: 0.784464 val: 0.739437 test: 0.764772
max validation accuracy : 0.739437 max acc epoch : 1 test accuracy : 0.764772
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  81.93918886780739 Time :  459
accuracy train: 0.796186 val: 0.759155 test: 0.775464
max validation accuracy : 0.759155 max acc epoch : 2 test accuracy : 0.775464
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  78.50024592876434 Time :  480
accuracy train: 0.804783 val: 0.761972 test: 0.776027
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  73.20725144445896 Time :  501
accuracy train: 0.821038 val: 0.757746 test: 0.780529
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  71.92496381700039 Time :  522
accuracy train: 0.825570 val: 0.745070 test: 0.783624
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  71.26542066037655 Time :  544
accuracy train: 0.830728 val: 0.761972 test: 0.784750
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.52278330922127 Time :  565
accuracy train: 0.843076 val: 0.759155 test: 0.782780
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.18526141345501 Time :  586
accuracy train: 0.846046 val: 0.753521 test: 0.782217
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.88829906284809 Time :  607
accuracy train: 0.851516 val: 0.750704 test: 0.783905
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  65.3558010905981 Time :  628
accuracy train: 0.857612 val: 0.756338 test: 0.783343
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  64.89244359731674 Time :  650
accuracy train: 0.862770 val: 0.750704 test: 0.782217
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  65.94257713854313 Time :  671
accuracy train: 0.860425 val: 0.757746 test: 0.783624
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  63.56354586780071 Time :  693
accuracy train: 0.863864 val: 0.754930 test: 0.780529
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  63.65863116085529 Time :  714
accuracy train: 0.863707 val: 0.753521 test: 0.785031
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  64.17008066177368 Time :  735
accuracy train: 0.866990 val: 0.757746 test: 0.784187
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027

Epoch :  16 loss training:  63.362362548708916 Time :  757
accuracy train: 0.867927 val: 0.752113 test: 0.782780
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027

Epoch :  17 loss training:  61.50178226828575 Time :  776
accuracy train: 0.873554 val: 0.752113 test: 0.781373
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027

Epoch :  18 loss training:  61.26181411743164 Time :  785
accuracy train: 0.878712 val: 0.756338 test: 0.783624
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027

Epoch :  19 loss training:  60.87300871312618 Time :  793
accuracy train: 0.882932 val: 0.752113 test: 0.781654
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027

Epoch :  20 loss training:  59.709252417087555 Time :  802
accuracy train: 0.886058 val: 0.756338 test: 0.779122
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027

Epoch :  21 loss training:  60.3690121024847 Time :  810
accuracy train: 0.891372 val: 0.749296 test: 0.783061
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027

Epoch :  22 loss training:  58.101897582411766 Time :  819
accuracy train: 0.894967 val: 0.754930 test: 0.780529
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027

Epoch :  23 loss training:  57.60561525821686 Time :  828
accuracy train: 0.895749 val: 0.756338 test: 0.780810
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027

Epoch :  24 loss training:  56.65677158534527 Time :  837
accuracy train: 0.900438 val: 0.756338 test: 0.781936
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027

Epoch :  25 loss training:  55.29960924386978 Time :  847
accuracy train: 0.904658 val: 0.759155 test: 0.783624
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027

Epoch :  26 loss training:  54.81363819539547 Time :  856
accuracy train: 0.906533 val: 0.752113 test: 0.785594
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027

Epoch :  27 loss training:  53.78447449207306 Time :  866
accuracy train: 0.911222 val: 0.760563 test: 0.786156
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027

Epoch :  28 loss training:  52.92811846733093 Time :  875
accuracy train: 0.914192 val: 0.753521 test: 0.780529
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027

Epoch :  29 loss training:  52.4241980612278 Time :  885
accuracy train: 0.918881 val: 0.759155 test: 0.776590
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027

Epoch :  30 loss training:  52.33989080786705 Time :  894
accuracy train: 0.920600 val: 0.749296 test: 0.781373
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027

Epoch :  31 loss training:  50.44201951473951 Time :  903
accuracy train: 0.923726 val: 0.757746 test: 0.782217
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027

Epoch :  32 loss training:  50.34315261244774 Time :  913
accuracy train: 0.926696 val: 0.753521 test: 0.781654
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027

Epoch :  33 loss training:  48.73712703585625 Time :  922
accuracy train: 0.931229 val: 0.756338 test: 0.776871
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027

Epoch :  34 loss training:  47.433364510536194 Time :  932
accuracy train: 0.932635 val: 0.747887 test: 0.778841
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776027

========================================================================================================================================================================================================
max acc epoch :  3
max validation accuracy :  0.7619718309859155
test accuracy :  0.7760270118176702
last test_accuracy :  0.7788407428249859
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_Exp=5, num_clusters=0, num_layers=3, num_mlp_layers=1, random_vec=False, seed=495, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.11082193255424 Time :  943
accuracy train: 0.784308 val: 0.738028 test: 0.763365
max validation accuracy : 0.738028 max acc epoch : 1 test accuracy : 0.763365
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  81.90677237510681 Time :  952
accuracy train: 0.796812 val: 0.753521 test: 0.774902
max validation accuracy : 0.753521 max acc epoch : 2 test accuracy : 0.774902
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  78.50920242071152 Time :  961
accuracy train: 0.806033 val: 0.764789 test: 0.776027
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  73.11943526566029 Time :  971
accuracy train: 0.821819 val: 0.754930 test: 0.778841
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  71.92982929944992 Time :  980
accuracy train: 0.826196 val: 0.746479 test: 0.783624
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  71.17496931552887 Time :  990
accuracy train: 0.833854 val: 0.761972 test: 0.784750
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.37723709642887 Time :  999
accuracy train: 0.845733 val: 0.763380 test: 0.779966
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.18140125274658 Time :  1008
accuracy train: 0.848390 val: 0.750704 test: 0.782217
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.7833751887083 Time :  1017
accuracy train: 0.853392 val: 0.753521 test: 0.786438
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  65.21623739600182 Time :  1026
accuracy train: 0.859956 val: 0.753521 test: 0.783343
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  64.76767607033253 Time :  1036
accuracy train: 0.862770 val: 0.746479 test: 0.781092
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  65.61460907757282 Time :  1044
accuracy train: 0.862613 val: 0.750704 test: 0.781936
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  63.29053470492363 Time :  1053
accuracy train: 0.864958 val: 0.756338 test: 0.779403
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  63.38883359730244 Time :  1062
accuracy train: 0.866052 val: 0.750704 test: 0.785312
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  64.04852445423603 Time :  1071
accuracy train: 0.870116 val: 0.750704 test: 0.784750
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027

Epoch :  16 loss training:  63.153988644480705 Time :  1081
accuracy train: 0.869647 val: 0.746479 test: 0.781936
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027

Epoch :  17 loss training:  61.43743923306465 Time :  1090
accuracy train: 0.876837 val: 0.746479 test: 0.782499
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027

Epoch :  18 loss training:  61.08855301141739 Time :  1100
accuracy train: 0.880900 val: 0.750704 test: 0.781373
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027

Epoch :  19 loss training:  60.604826390743256 Time :  1108
accuracy train: 0.885277 val: 0.750704 test: 0.783061
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027

Epoch :  20 loss training:  59.480732396245 Time :  1117
accuracy train: 0.890278 val: 0.747887 test: 0.779966
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027

Epoch :  21 loss training:  59.84246322512627 Time :  1126
accuracy train: 0.896061 val: 0.747887 test: 0.780529
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027

Epoch :  22 loss training:  57.88609993457794 Time :  1136
accuracy train: 0.897468 val: 0.740845 test: 0.783343
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027

Epoch :  23 loss training:  57.201614767313 Time :  1146
accuracy train: 0.897468 val: 0.749296 test: 0.779403
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027

Epoch :  24 loss training:  56.428598299622536 Time :  1155
accuracy train: 0.903251 val: 0.746479 test: 0.783061
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027

Epoch :  25 loss training:  55.133350387215614 Time :  1164
accuracy train: 0.907158 val: 0.752113 test: 0.782217
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027

Epoch :  26 loss training:  54.72365443408489 Time :  1174
accuracy train: 0.907784 val: 0.747887 test: 0.783624
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027

Epoch :  27 loss training:  53.487814232707024 Time :  1184
accuracy train: 0.914192 val: 0.754930 test: 0.785031
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027

Epoch :  28 loss training:  52.548343643546104 Time :  1192
accuracy train: 0.918881 val: 0.756338 test: 0.783061
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027

Epoch :  29 loss training:  52.11245669424534 Time :  1202
accuracy train: 0.920444 val: 0.757746 test: 0.780248
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027

Epoch :  30 loss training:  51.98682942986488 Time :  1211
accuracy train: 0.921382 val: 0.756338 test: 0.781936
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027

Epoch :  31 loss training:  49.86543732881546 Time :  1221
accuracy train: 0.926071 val: 0.760563 test: 0.778559
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027

Epoch :  32 loss training:  49.97333087027073 Time :  1230
accuracy train: 0.929197 val: 0.759155 test: 0.780248
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027

Epoch :  33 loss training:  48.57526817917824 Time :  1238
accuracy train: 0.934042 val: 0.752113 test: 0.777715
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027

Epoch :  34 loss training:  47.23931631445885 Time :  1247
accuracy train: 0.934667 val: 0.752113 test: 0.780810
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027

========================================================================================================================================================================================================
max acc epoch :  3
max validation accuracy :  0.7647887323943662
test accuracy :  0.7760270118176702
last test_accuracy :  0.7808103545301069
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_Exp=5, num_clusters=0, num_layers=3, num_mlp_layers=1, random_vec=False, seed=495, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.1227111518383 Time :  1259
accuracy train: 0.783995 val: 0.732394 test: 0.766179
max validation accuracy : 0.732394 max acc epoch : 1 test accuracy : 0.766179
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  81.88065469264984 Time :  1268
accuracy train: 0.796030 val: 0.752113 test: 0.775464
max validation accuracy : 0.752113 max acc epoch : 2 test accuracy : 0.775464
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  78.61862367391586 Time :  1277
accuracy train: 0.804001 val: 0.764789 test: 0.777715
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  73.31110934913158 Time :  1286
accuracy train: 0.822288 val: 0.754930 test: 0.780529
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  72.00708574056625 Time :  1295
accuracy train: 0.822601 val: 0.749296 test: 0.784187
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  71.22004756331444 Time :  1303
accuracy train: 0.832604 val: 0.759155 test: 0.784187
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.49924077093601 Time :  1312
accuracy train: 0.843857 val: 0.763380 test: 0.780248
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.12932322919369 Time :  1322
accuracy train: 0.847452 val: 0.750704 test: 0.783343
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.67383301258087 Time :  1331
accuracy train: 0.852610 val: 0.746479 test: 0.780810
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  65.22634820640087 Time :  1340
accuracy train: 0.857768 val: 0.754930 test: 0.782217
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  64.75738716125488 Time :  1349
accuracy train: 0.861832 val: 0.749296 test: 0.780248
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  65.89703792333603 Time :  1358
accuracy train: 0.859018 val: 0.747887 test: 0.782217
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  63.43696005642414 Time :  1366
accuracy train: 0.864176 val: 0.753521 test: 0.781373
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  63.68030671775341 Time :  1375
accuracy train: 0.864176 val: 0.749296 test: 0.783061
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  64.21429578959942 Time :  1384
accuracy train: 0.867459 val: 0.749296 test: 0.782780
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715

Epoch :  16 loss training:  63.43335808813572 Time :  1393
accuracy train: 0.870741 val: 0.749296 test: 0.780529
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715

Epoch :  17 loss training:  61.557047352194786 Time :  1402
accuracy train: 0.873554 val: 0.747887 test: 0.781092
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715

Epoch :  18 loss training:  61.152924567461014 Time :  1411
accuracy train: 0.878399 val: 0.753521 test: 0.779685
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715

Epoch :  19 loss training:  60.75299833714962 Time :  1420
accuracy train: 0.882620 val: 0.746479 test: 0.781654
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715

Epoch :  20 loss training:  59.42131344974041 Time :  1428
accuracy train: 0.888715 val: 0.750704 test: 0.779403
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715

Epoch :  21 loss training:  60.01823200285435 Time :  1438
accuracy train: 0.892623 val: 0.745070 test: 0.781373
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715

Epoch :  22 loss training:  58.14854325354099 Time :  1447
accuracy train: 0.894498 val: 0.750704 test: 0.779685
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715

Epoch :  23 loss training:  57.50930380821228 Time :  1456
accuracy train: 0.899656 val: 0.749296 test: 0.781654
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715

Epoch :  24 loss training:  56.57519067823887 Time :  1465
accuracy train: 0.901063 val: 0.747887 test: 0.783061
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715

Epoch :  25 loss training:  55.45927904546261 Time :  1474
accuracy train: 0.905283 val: 0.752113 test: 0.781936
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715

Epoch :  26 loss training:  54.828970313072205 Time :  1483
accuracy train: 0.907627 val: 0.743662 test: 0.783905
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715

Epoch :  27 loss training:  53.65150743722916 Time :  1492
accuracy train: 0.911222 val: 0.757746 test: 0.782217
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715

Epoch :  28 loss training:  52.93521896004677 Time :  1501
accuracy train: 0.916849 val: 0.756338 test: 0.781373
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715

Epoch :  29 loss training:  52.07082615792751 Time :  1515
accuracy train: 0.919193 val: 0.760563 test: 0.781373
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715

Epoch :  30 loss training:  52.19760645925999 Time :  1525
accuracy train: 0.922476 val: 0.757746 test: 0.779122
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715

Epoch :  31 loss training:  50.11960059404373 Time :  1534
accuracy train: 0.924664 val: 0.750704 test: 0.779122
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715

Epoch :  32 loss training:  50.459207497537136 Time :  1542
accuracy train: 0.928884 val: 0.756338 test: 0.781373
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715

Epoch :  33 loss training:  48.89232586324215 Time :  1551
accuracy train: 0.932166 val: 0.747887 test: 0.777997
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715

Epoch :  34 loss training:  47.60710449516773 Time :  1560
accuracy train: 0.934980 val: 0.753521 test: 0.779122
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.777715

========================================================================================================================================================================================================
max acc epoch :  3
max validation accuracy :  0.7647887323943662
test accuracy :  0.7777152504220597
last test_accuracy :  0.7791221159257175
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_Exp=5, num_clusters=0, num_layers=3, num_mlp_layers=1, random_vec=False, seed=495, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.10298666357994 Time :  1577
accuracy train: 0.783995 val: 0.733803 test: 0.762240
max validation accuracy : 0.733803 max acc epoch : 1 test accuracy : 0.762240
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  81.9161628484726 Time :  1593
accuracy train: 0.796499 val: 0.752113 test: 0.777715
max validation accuracy : 0.752113 max acc epoch : 2 test accuracy : 0.777715
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  78.51329663395882 Time :  1608
accuracy train: 0.805408 val: 0.761972 test: 0.773776
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  73.2927753329277 Time :  1625
accuracy train: 0.821507 val: 0.752113 test: 0.778559
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  71.87697020173073 Time :  1642
accuracy train: 0.824008 val: 0.746479 test: 0.785031
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  71.28214928507805 Time :  1656
accuracy train: 0.832448 val: 0.756338 test: 0.785031
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.57419173419476 Time :  1665
accuracy train: 0.848859 val: 0.759155 test: 0.781654
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.16914553940296 Time :  1673
accuracy train: 0.848390 val: 0.752113 test: 0.784468
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.86495436728 Time :  1682
accuracy train: 0.850422 val: 0.747887 test: 0.783905
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  65.19563362002373 Time :  1691
accuracy train: 0.859018 val: 0.757746 test: 0.783905
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  64.68026986718178 Time :  1700
accuracy train: 0.863082 val: 0.749296 test: 0.781654
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  65.75820134580135 Time :  1709
accuracy train: 0.861050 val: 0.754930 test: 0.782499
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  63.33365501463413 Time :  1718
accuracy train: 0.865270 val: 0.761972 test: 0.780529
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  63.59991739690304 Time :  1727
accuracy train: 0.864802 val: 0.753521 test: 0.782217
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  64.21401554346085 Time :  1737
accuracy train: 0.867771 val: 0.754930 test: 0.783061
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776

Epoch :  16 loss training:  63.41443359851837 Time :  1747
accuracy train: 0.870428 val: 0.753521 test: 0.784187
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776

Epoch :  17 loss training:  61.394412472844124 Time :  1763
accuracy train: 0.875117 val: 0.757746 test: 0.781936
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776

Epoch :  18 loss training:  61.01426453888416 Time :  1772
accuracy train: 0.881213 val: 0.756338 test: 0.780529
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776

Epoch :  19 loss training:  60.769637763500214 Time :  1781
accuracy train: 0.884339 val: 0.749296 test: 0.783624
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776

Epoch :  20 loss training:  59.587771505117416 Time :  1790
accuracy train: 0.888715 val: 0.754930 test: 0.779403
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776

Epoch :  21 loss training:  60.03342768549919 Time :  1802
accuracy train: 0.893873 val: 0.750704 test: 0.780529
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776

Epoch :  22 loss training:  58.04475635290146 Time :  1819
accuracy train: 0.895749 val: 0.757746 test: 0.781373
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776

Epoch :  23 loss training:  57.50067023932934 Time :  1837
accuracy train: 0.896843 val: 0.750704 test: 0.780248
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776

Epoch :  24 loss training:  56.68708123266697 Time :  1855
accuracy train: 0.901532 val: 0.760563 test: 0.783061
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776

Epoch :  25 loss training:  55.54569773375988 Time :  1869
accuracy train: 0.904501 val: 0.757746 test: 0.783343
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776

Epoch :  26 loss training:  55.013225957751274 Time :  1877
accuracy train: 0.907784 val: 0.754930 test: 0.780810
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776

Epoch :  27 loss training:  53.71780826151371 Time :  1887
accuracy train: 0.914036 val: 0.760563 test: 0.783343
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776

Epoch :  28 loss training:  53.01564557850361 Time :  1894
accuracy train: 0.916068 val: 0.757746 test: 0.782217
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776

Epoch :  29 loss training:  52.14127126336098 Time :  1905
accuracy train: 0.918568 val: 0.754930 test: 0.779122
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776

Epoch :  30 loss training:  52.30754718184471 Time :  1923
accuracy train: 0.920131 val: 0.760563 test: 0.778278
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776

Epoch :  31 loss training:  50.14677952229977 Time :  1934
accuracy train: 0.925758 val: 0.754930 test: 0.779122
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776

Epoch :  32 loss training:  50.26468500494957 Time :  1944
accuracy train: 0.927634 val: 0.760563 test: 0.781373
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776

Epoch :  33 loss training:  48.797975182533264 Time :  1953
accuracy train: 0.933417 val: 0.757746 test: 0.778559
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776

Epoch :  34 loss training:  47.51086361706257 Time :  1962
accuracy train: 0.933417 val: 0.753521 test: 0.779122
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.773776

========================================================================================================================================================================================================
max acc epoch :  3
max validation accuracy :  0.7619718309859155
test accuracy :  0.7737760270118177
last test_accuracy :  0.7791221159257175
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.76338 	 test_accuracy : 0.77546 	 max_acc epoch :  3 	 last test_accuracy : 0.78025
k :  1 	 val_accuracy : 0.76197 	 test_accuracy : 0.77603 	 max_acc epoch :  3 	 last test_accuracy : 0.77884
k :  2 	 val_accuracy : 0.76479 	 test_accuracy : 0.77603 	 max_acc epoch :  3 	 last test_accuracy : 0.78081
k :  3 	 val_accuracy : 0.76479 	 test_accuracy : 0.77772 	 max_acc epoch :  3 	 last test_accuracy : 0.77912
k :  4 	 val_accuracy : 0.76197 	 test_accuracy : 0.77378 	 max_acc epoch :  3 	 last test_accuracy : 0.77912

avg :  	 val_accuracy : 0.76338 	 test_accuracy : 0.77580 	 last_accuracy : 0.77963
