

date and time :  Sat May  8 22:49:04 2021
Namespace(batch_size=32, dataset='ohsumed', device=0, dropout=0.5, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=0)
device :  cuda:0
min_len_of_sentence : 1
max_len_of_sentence : 5
min_num_of_sentence : 3
max_num_of_sentence : 326
average_len_of_sentence: 4.990813339989624
average_num_of_sentence: 82.83162162162162
Total_num_of_sentence : 612954
Counter({'C14': 1175, 'C04': 1030, 'C23': 796, 'C10': 557, 'C21': 553, 'C20': 410, 'C06': 354, 'C12': 342, 'C18': 323, 'C08': 250, 'C17': 233, 'C05': 223, 'C01': 216, 'C13': 195, 'C15': 133, 'C16': 129, 'C11': 125, 'C19': 86, 'C02': 75, 'C07': 63, 'C09': 63, 'C03': 50, 'C22': 19})
Total_number_of_words: 12909
Total_number_of_categories: 23

Epoch :  1 loss training:  720.7839205265045 Time :  141
accuracy train: 0.506618 val: 0.519403 test: 0.469453
max validation accuracy : 0.519403 max acc epoch : 1 test accuracy : 0.469453

Epoch :  2 loss training:  463.3032863140106 Time :  168
accuracy train: 0.629715 val: 0.626866 test: 0.554539
max validation accuracy : 0.626866 max acc epoch : 2 test accuracy : 0.554539

Epoch :  3 loss training:  425.3548102378845 Time :  196
accuracy train: 0.654864 val: 0.600000 test: 0.558496
max validation accuracy : 0.626866 max acc epoch : 2 test accuracy : 0.554539

Epoch :  4 loss training:  362.85519003868103 Time :  224
accuracy train: 0.720715 val: 0.653731 test: 0.626762
max validation accuracy : 0.653731 max acc epoch : 4 test accuracy : 0.626762

Epoch :  5 loss training:  335.52722895145416 Time :  252
accuracy train: 0.746195 val: 0.623881 test: 0.612169
max validation accuracy : 0.653731 max acc epoch : 4 test accuracy : 0.626762

Epoch :  6 loss training:  311.7462058067322 Time :  279
accuracy train: 0.759100 val: 0.671642 test: 0.628494
max validation accuracy : 0.671642 max acc epoch : 6 test accuracy : 0.628494

Epoch :  7 loss training:  288.2345311641693 Time :  306
accuracy train: 0.781932 val: 0.647761 test: 0.635914
max validation accuracy : 0.671642 max acc epoch : 6 test accuracy : 0.628494

Epoch :  8 loss training:  265.6859624385834 Time :  334
accuracy train: 0.785242 val: 0.689552 test: 0.639871
max validation accuracy : 0.689552 max acc epoch : 8 test accuracy : 0.639871

Epoch :  9 loss training:  273.6140102148056 Time :  360
accuracy train: 0.807743 val: 0.686567 test: 0.631709
max validation accuracy : 0.689552 max acc epoch : 8 test accuracy : 0.639871

Epoch :  10 loss training:  244.98082435131073 Time :  387
accuracy train: 0.818332 val: 0.632836 test: 0.633935
max validation accuracy : 0.689552 max acc epoch : 8 test accuracy : 0.639871

Epoch :  11 loss training:  227.263529419899 Time :  413
accuracy train: 0.813369 val: 0.653731 test: 0.624536
max validation accuracy : 0.689552 max acc epoch : 8 test accuracy : 0.639871

Epoch :  12 loss training:  227.70255553722382 Time :  439
accuracy train: 0.808405 val: 0.704478 test: 0.644571
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.644571

Epoch :  13 loss training:  210.42786240577698 Time :  465
accuracy train: 0.846790 val: 0.686567 test: 0.659659
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.644571

Epoch :  14 loss training:  197.41734862327576 Time :  490
accuracy train: 0.856056 val: 0.710448 test: 0.660648
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  15 loss training:  192.0660823583603 Time :  515
accuracy train: 0.879550 val: 0.644776 test: 0.653970
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  16 loss training:  179.83077466487885 Time :  541
accuracy train: 0.877234 val: 0.683582 test: 0.652980
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  17 loss training:  187.08529388904572 Time :  568
accuracy train: 0.890801 val: 0.677612 test: 0.648776
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  18 loss training:  176.26692605018616 Time :  593
accuracy train: 0.878888 val: 0.701493 test: 0.662627
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  19 loss training:  155.37769430875778 Time :  619
accuracy train: 0.872601 val: 0.701493 test: 0.648776
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  20 loss training:  151.88726297020912 Time :  645
accuracy train: 0.896757 val: 0.680597 test: 0.653475
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  21 loss training:  156.77404814958572 Time :  671
accuracy train: 0.923891 val: 0.671642 test: 0.657680
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  22 loss training:  149.53802263736725 Time :  697
accuracy train: 0.910655 val: 0.653731 test: 0.660401
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  23 loss training:  152.29881942272186 Time :  723
accuracy train: 0.917273 val: 0.683582 test: 0.649765
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  24 loss training:  156.6500547528267 Time :  749
accuracy train: 0.909332 val: 0.671642 test: 0.664111
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  25 loss training:  153.55314660072327 Time :  775
accuracy train: 0.910324 val: 0.656716 test: 0.651496
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  26 loss training:  148.12284135818481 Time :  800
accuracy train: 0.946393 val: 0.695522 test: 0.672520
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  27 loss training:  139.35245424509048 Time :  826
accuracy train: 0.934480 val: 0.668657 test: 0.667574
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  28 loss training:  120.85089895129204 Time :  850
accuracy train: 0.949702 val: 0.674627 test: 0.674252
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  29 loss training:  117.777497112751 Time :  877
accuracy train: 0.945731 val: 0.692537 test: 0.671531
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  30 loss training:  119.49719893932343 Time :  903
accuracy train: 0.951357 val: 0.680597 test: 0.674746
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  31 loss training:  127.3479630947113 Time :  928
accuracy train: 0.934150 val: 0.671642 test: 0.660401
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  32 loss training:  117.21076560020447 Time :  954
accuracy train: 0.943746 val: 0.683582 test: 0.670789
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  33 loss training:  119.33814719319344 Time :  978
accuracy train: 0.955659 val: 0.710448 test: 0.671284
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  34 loss training:  119.89659401774406 Time :  1004
accuracy train: 0.954997 val: 0.689552 test: 0.678457
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  35 loss training:  119.10793170332909 Time :  1031
accuracy train: 0.969226 val: 0.668657 test: 0.670047
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  36 loss training:  89.5845850110054 Time :  1057
accuracy train: 0.966578 val: 0.680597 test: 0.668316
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  37 loss training:  97.69042405486107 Time :  1084
accuracy train: 0.959298 val: 0.659701 test: 0.656691
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  38 loss training:  95.7887861430645 Time :  1110
accuracy train: 0.969557 val: 0.689552 test: 0.667079
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  39 loss training:  97.15673208236694 Time :  1137
accuracy train: 0.969557 val: 0.686567 test: 0.657680
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  40 loss training:  97.7074244916439 Time :  1163
accuracy train: 0.964262 val: 0.680597 test: 0.669058
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  41 loss training:  106.80419188737869 Time :  1189
accuracy train: 0.975844 val: 0.710448 test: 0.674252
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  42 loss training:  93.39865556359291 Time :  1214
accuracy train: 0.973858 val: 0.692537 test: 0.671531
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  43 loss training:  111.4434974193573 Time :  1239
accuracy train: 0.975182 val: 0.707463 test: 0.678457
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  44 loss training:  101.93392288684845 Time :  1265
accuracy train: 0.967902 val: 0.695522 test: 0.662379
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

Epoch :  45 loss training:  81.70362882316113 Time :  1291
accuracy train: 0.980146 val: 0.692537 test: 0.671531
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.660648

========================================================================================================================================================================================================
max acc epoch :  14
max validation accuracy :  0.7104477611940299
test accuracy :  0.6606480336383873
last test_accuracy :  0.671531041305961
========================================================================================================================================================================================================

