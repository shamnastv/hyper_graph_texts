

date and time :  Sat May  8 12:21:59 2021
Namespace(batch_size=32, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=0)
device :  cuda:0
min_len_of_sentence : 1
max_len_of_sentence : 7408
min_num_of_sentence : 7
max_num_of_sentence : 21895
average_len_of_sentence: 5.831122391605742
average_num_of_sentence: 140.61349888570518
Total_num_of_sentence : 2650002
Counter({'rec.sport.hockey': 999, 'soc.religion.christian': 997, 'rec.motorcycles': 996, 'rec.sport.baseball': 994, 'sci.crypt': 991, 'rec.autos': 990, 'sci.med': 990, 'comp.windows.x': 988, 'sci.space': 987, 'comp.os.ms-windows.misc': 985, 'sci.electronics': 984, 'comp.sys.ibm.pc.hardware': 982, 'misc.forsale': 975, 'comp.graphics': 973, 'comp.sys.mac.hardware': 963, 'talk.politics.mideast': 940, 'talk.politics.guns': 910, 'alt.atheism': 799, 'talk.politics.misc': 775, 'talk.religion.misc': 628})
Total_number_of_words: 39033
Total_number_of_categories: 20
vocab size : 39033
got embeddings of : 30907

Epoch :  1 loss training:  686.3554557561874 Time :  325
accuracy train: 0.813415 val: 0.774536 test: 0.741370
max validation accuracy : 0.774536 max acc epoch : 1 test accuracy : 0.741370

Epoch :  2 loss training:  376.9813795387745 Time :  449
accuracy train: 0.860552 val: 0.823165 test: 0.777350
max validation accuracy : 0.823165 max acc epoch : 2 test accuracy : 0.777350

Epoch :  3 loss training:  327.19300705194473 Time :  568
accuracy train: 0.880978 val: 0.822281 test: 0.778147
max validation accuracy : 0.823165 max acc epoch : 2 test accuracy : 0.777350

Epoch :  4 loss training:  275.58954609930515 Time :  688
accuracy train: 0.914269 val: 0.840849 test: 0.799389
max validation accuracy : 0.840849 max acc epoch : 4 test accuracy : 0.799389

Epoch :  5 loss training:  245.6892253756523 Time :  809
accuracy train: 0.930080 val: 0.870911 test: 0.810011
max validation accuracy : 0.870911 max acc epoch : 5 test accuracy : 0.810011

Epoch :  6 loss training:  227.23330557346344 Time :  928
accuracy train: 0.928607 val: 0.854111 test: 0.806691
max validation accuracy : 0.870911 max acc epoch : 5 test accuracy : 0.810011

Epoch :  7 loss training:  216.8142785280943 Time :  1048
accuracy train: 0.934106 val: 0.863837 test: 0.804567
max validation accuracy : 0.870911 max acc epoch : 5 test accuracy : 0.810011

Epoch :  8 loss training:  152.6730781570077 Time :  1170
accuracy train: 0.955809 val: 0.885942 test: 0.820898
max validation accuracy : 0.885942 max acc epoch : 8 test accuracy : 0.820898

Epoch :  9 loss training:  138.80137869343162 Time :  1291
accuracy train: 0.963665 val: 0.881521 test: 0.821429
max validation accuracy : 0.885942 max acc epoch : 8 test accuracy : 0.820898

Epoch :  10 loss training:  132.1831079609692 Time :  1414
accuracy train: 0.971423 val: 0.892131 test: 0.832050
max validation accuracy : 0.892131 max acc epoch : 10 test accuracy : 0.832050

Epoch :  11 loss training:  121.35286553949118 Time :  1533
accuracy train: 0.972307 val: 0.884173 test: 0.828465
max validation accuracy : 0.892131 max acc epoch : 10 test accuracy : 0.832050

Epoch :  12 loss training:  117.62945211306214 Time :  1653
accuracy train: 0.975940 val: 0.878868 test: 0.832050
max validation accuracy : 0.892131 max acc epoch : 10 test accuracy : 0.832050

Epoch :  13 loss training:  96.39790965616703 Time :  1775
accuracy train: 0.981832 val: 0.895668 test: 0.831253
max validation accuracy : 0.895668 max acc epoch : 13 test accuracy : 0.831253

Epoch :  14 loss training:  88.93048519268632 Time :  1895
accuracy train: 0.984288 val: 0.893015 test: 0.830722
max validation accuracy : 0.895668 max acc epoch : 13 test accuracy : 0.831253

Epoch :  15 loss training:  81.87959925830364 Time :  2014
accuracy train: 0.985466 val: 0.892131 test: 0.831386
max validation accuracy : 0.895668 max acc epoch : 13 test accuracy : 0.831253

Epoch :  16 loss training:  79.45970658957958 Time :  2133
accuracy train: 0.985368 val: 0.889478 test: 0.829926
max validation accuracy : 0.895668 max acc epoch : 13 test accuracy : 0.831253

Epoch :  17 loss training:  70.92663726396859 Time :  2253
accuracy train: 0.990278 val: 0.893899 test: 0.832183
max validation accuracy : 0.895668 max acc epoch : 13 test accuracy : 0.831253

Epoch :  18 loss training:  69.42798319272697 Time :  2373
accuracy train: 0.991162 val: 0.898320 test: 0.830722
max validation accuracy : 0.898320 max acc epoch : 18 test accuracy : 0.830722

Epoch :  19 loss training:  68.15652262046933 Time :  2495
accuracy train: 0.991947 val: 0.899204 test: 0.835236
max validation accuracy : 0.899204 max acc epoch : 19 test accuracy : 0.835236

Epoch :  20 loss training:  64.03896457515657 Time :  2615
accuracy train: 0.991064 val: 0.895668 test: 0.832714
max validation accuracy : 0.899204 max acc epoch : 19 test accuracy : 0.835236

Epoch :  21 loss training:  60.7937160898 Time :  2745
accuracy train: 0.992144 val: 0.901857 test: 0.835635
max validation accuracy : 0.901857 max acc epoch : 21 test accuracy : 0.835635

Epoch :  22 loss training:  56.336358370259404 Time :  2873
accuracy train: 0.994108 val: 0.904509 test: 0.834307
max validation accuracy : 0.904509 max acc epoch : 22 test accuracy : 0.834307

Epoch :  23 loss training:  51.11204596795142 Time :  3000
accuracy train: 0.995384 val: 0.907162 test: 0.837493
max validation accuracy : 0.907162 max acc epoch : 23 test accuracy : 0.837493

Epoch :  24 loss training:  45.89791998825967 Time :  3128
accuracy train: 0.996366 val: 0.902741 test: 0.838555
max validation accuracy : 0.907162 max acc epoch : 23 test accuracy : 0.837493

Epoch :  25 loss training:  38.579630616120994 Time :  3255
accuracy train: 0.997152 val: 0.905393 test: 0.843468
max validation accuracy : 0.907162 max acc epoch : 23 test accuracy : 0.837493

Epoch :  26 loss training:  35.67575304210186 Time :  3382
accuracy train: 0.997349 val: 0.908046 test: 0.840945
max validation accuracy : 0.908046 max acc epoch : 26 test accuracy : 0.840945

Epoch :  27 loss training:  34.69093821197748 Time :  3509
accuracy train: 0.997643 val: 0.909814 test: 0.839352
max validation accuracy : 0.909814 max acc epoch : 27 test accuracy : 0.839352

Epoch :  28 loss training:  32.51220439746976 Time :  3636
accuracy train: 0.997349 val: 0.905393 test: 0.842140
max validation accuracy : 0.909814 max acc epoch : 27 test accuracy : 0.839352

Epoch :  29 loss training:  30.69674799218774 Time :  3762
accuracy train: 0.998625 val: 0.905393 test: 0.842140
max validation accuracy : 0.909814 max acc epoch : 27 test accuracy : 0.839352

Epoch :  30 loss training:  29.756270714104176 Time :  3890
accuracy train: 0.998331 val: 0.908046 test: 0.842539
max validation accuracy : 0.909814 max acc epoch : 27 test accuracy : 0.839352

Epoch :  31 loss training:  27.567046975251287 Time :  4017
accuracy train: 0.998429 val: 0.907162 test: 0.844530
max validation accuracy : 0.909814 max acc epoch : 27 test accuracy : 0.839352

Epoch :  32 loss training:  27.33723258972168 Time :  4143
accuracy train: 0.998625 val: 0.908046 test: 0.842273
max validation accuracy : 0.909814 max acc epoch : 27 test accuracy : 0.839352

Epoch :  33 loss training:  24.212489411234856 Time :  4267
accuracy train: 0.998527 val: 0.906278 test: 0.843335
max validation accuracy : 0.909814 max acc epoch : 27 test accuracy : 0.839352

Epoch :  34 loss training:  24.201619160361588 Time :  4394
accuracy train: 0.998527 val: 0.908046 test: 0.844663
max validation accuracy : 0.909814 max acc epoch : 27 test accuracy : 0.839352

Epoch :  35 loss training:  25.501106240786612 Time :  4520
accuracy train: 0.998822 val: 0.904509 test: 0.843601
max validation accuracy : 0.909814 max acc epoch : 27 test accuracy : 0.839352

Epoch :  36 loss training:  23.596056369133294 Time :  4647
accuracy train: 0.998625 val: 0.906278 test: 0.843999
max validation accuracy : 0.909814 max acc epoch : 27 test accuracy : 0.839352

Epoch :  37 loss training:  24.0039739953354 Time :  4774
accuracy train: 0.998625 val: 0.907162 test: 0.844796
max validation accuracy : 0.909814 max acc epoch : 27 test accuracy : 0.839352

Epoch :  38 loss training:  24.645872708410025 Time :  4899
accuracy train: 0.998822 val: 0.903625 test: 0.842804
max validation accuracy : 0.909814 max acc epoch : 27 test accuracy : 0.839352

Epoch :  39 loss training:  23.326028812676668 Time :  5026
accuracy train: 0.998527 val: 0.910698 test: 0.845327
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  40 loss training:  23.433955577667803 Time :  5154
accuracy train: 0.998822 val: 0.908046 test: 0.844928
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  41 loss training:  23.366233157925308 Time :  5282
accuracy train: 0.998723 val: 0.908046 test: 0.844663
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  42 loss training:  23.409774389117956 Time :  5408
accuracy train: 0.998822 val: 0.904509 test: 0.843999
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  43 loss training:  23.762380408123136 Time :  5535
accuracy train: 0.998920 val: 0.906278 test: 0.844132
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  44 loss training:  22.590903487987816 Time :  5662
accuracy train: 0.998723 val: 0.907162 test: 0.844530
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  45 loss training:  21.405571495182812 Time :  5791
accuracy train: 0.998723 val: 0.906278 test: 0.843468
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  46 loss training:  25.40076916012913 Time :  5918
accuracy train: 0.998723 val: 0.903625 test: 0.843733
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  47 loss training:  23.72587708197534 Time :  6047
accuracy train: 0.998822 val: 0.906278 test: 0.843999
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  48 loss training:  22.380998617969453 Time :  6196
accuracy train: 0.998723 val: 0.906278 test: 0.843070
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  49 loss training:  23.492891747504473 Time :  6347
accuracy train: 0.998822 val: 0.904509 test: 0.844132
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  50 loss training:  23.86981897894293 Time :  6494
accuracy train: 0.998723 val: 0.906278 test: 0.844397
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  51 loss training:  23.416954148560762 Time :  6639
accuracy train: 0.998822 val: 0.907162 test: 0.844530
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  52 loss training:  21.663406276144087 Time :  6781
accuracy train: 0.998723 val: 0.907162 test: 0.844796
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  53 loss training:  24.84216473530978 Time :  6923
accuracy train: 0.998822 val: 0.906278 test: 0.843733
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  54 loss training:  22.63561599701643 Time :  7066
accuracy train: 0.998822 val: 0.906278 test: 0.844796
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  55 loss training:  23.51697067823261 Time :  7208
accuracy train: 0.998822 val: 0.908046 test: 0.843733
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  56 loss training:  22.23153725359589 Time :  7349
accuracy train: 0.998822 val: 0.907162 test: 0.844264
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  57 loss training:  23.17177986446768 Time :  7489
accuracy train: 0.998723 val: 0.906278 test: 0.844530
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  58 loss training:  21.336164705455303 Time :  7638
accuracy train: 0.998723 val: 0.907162 test: 0.844663
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  59 loss training:  21.56317954044789 Time :  7801
accuracy train: 0.998723 val: 0.903625 test: 0.843999
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  60 loss training:  23.331403096206486 Time :  7949
accuracy train: 0.998723 val: 0.905393 test: 0.844264
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  61 loss training:  22.349330753087997 Time :  8096
accuracy train: 0.998822 val: 0.907162 test: 0.845194
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  62 loss training:  22.097165064886212 Time :  8242
accuracy train: 0.998920 val: 0.908046 test: 0.843468
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  63 loss training:  22.204199172905646 Time :  8388
accuracy train: 0.998723 val: 0.906278 test: 0.844663
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  64 loss training:  23.686939910054207 Time :  8532
accuracy train: 0.998822 val: 0.906278 test: 0.843733
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  65 loss training:  23.53553139884025 Time :  8678
accuracy train: 0.998822 val: 0.906278 test: 0.843999
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  66 loss training:  21.112043962813914 Time :  8825
accuracy train: 0.998822 val: 0.905393 test: 0.845459
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  67 loss training:  22.624488905537874 Time :  8967
accuracy train: 0.998723 val: 0.905393 test: 0.845327
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  68 loss training:  22.79388200864196 Time :  9106
accuracy train: 0.998723 val: 0.906278 test: 0.843468
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  69 loss training:  21.716865290887654 Time :  9246
accuracy train: 0.998723 val: 0.905393 test: 0.843335
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

Epoch :  70 loss training:  21.795179871842265 Time :  9384
accuracy train: 0.998723 val: 0.908046 test: 0.844264
max validation accuracy : 0.910698 max acc epoch : 39 test accuracy : 0.845327

========================================================================================================================================================================================================
max acc epoch :  39
max validation accuracy :  0.9106984969053935
test accuracy :  0.8453266064790228
last test_accuracy :  0.8442644715878916
========================================================================================================================================================================================================

