

date and time :  Sat Jul  3 00:14:36 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=954, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  97.1198770403862 Time :  11
accuracy train: 0.759351 val: 0.731707 test: 0.753517
max validation accuracy : 0.731707 max acc epoch : 1 test accuracy : 0.753517
Epoch-1 lr: 0.001

Epoch :  2 loss training:  88.80214262008667 Time :  20
accuracy train: 0.778054 val: 0.755159 test: 0.768149
max validation accuracy : 0.755159 max acc epoch : 2 test accuracy : 0.768149
Epoch-2 lr: 0.001

Epoch :  3 loss training:  84.67151880264282 Time :  30
accuracy train: 0.771268 val: 0.749531 test: 0.763647
max validation accuracy : 0.755159 max acc epoch : 2 test accuracy : 0.768149
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  82.8568064570427 Time :  39
accuracy train: 0.792949 val: 0.760788 test: 0.776590
max validation accuracy : 0.760788 max acc epoch : 4 test accuracy : 0.776590
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.30874125659466 Time :  49
accuracy train: 0.788481 val: 0.749531 test: 0.767023
max validation accuracy : 0.760788 max acc epoch : 4 test accuracy : 0.776590
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.45018319785595 Time :  59
accuracy train: 0.797584 val: 0.757036 test: 0.772088
max validation accuracy : 0.760788 max acc epoch : 4 test accuracy : 0.776590
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.41807013750076 Time :  68
accuracy train: 0.804866 val: 0.760788 test: 0.776308
max validation accuracy : 0.760788 max acc epoch : 4 test accuracy : 0.776590
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  77.16069597005844 Time :  77
accuracy train: 0.813141 val: 0.765478 test: 0.778278
max validation accuracy : 0.765478 max acc epoch : 8 test accuracy : 0.778278
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.92131242156029 Time :  88
accuracy train: 0.811817 val: 0.764540 test: 0.777997
max validation accuracy : 0.765478 max acc epoch : 8 test accuracy : 0.778278
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.78890064358711 Time :  98
accuracy train: 0.811155 val: 0.770169 test: 0.781654
max validation accuracy : 0.770169 max acc epoch : 10 test accuracy : 0.781654

Epoch :  11 loss training:  75.64335682988167 Time :  108
accuracy train: 0.823237 val: 0.772045 test: 0.781373
max validation accuracy : 0.772045 max acc epoch : 11 test accuracy : 0.781373

Epoch :  12 loss training:  73.29260778427124 Time :  118
accuracy train: 0.834161 val: 0.778612 test: 0.783905
max validation accuracy : 0.778612 max acc epoch : 12 test accuracy : 0.783905

Epoch :  13 loss training:  71.95907264947891 Time :  128
accuracy train: 0.838299 val: 0.774859 test: 0.783624
max validation accuracy : 0.778612 max acc epoch : 12 test accuracy : 0.783905

Epoch :  14 loss training:  70.76054771244526 Time :  138
accuracy train: 0.849553 val: 0.782364 test: 0.785875
max validation accuracy : 0.782364 max acc epoch : 14 test accuracy : 0.785875

Epoch :  15 loss training:  68.0024022012949 Time :  148
accuracy train: 0.859484 val: 0.783302 test: 0.788407
max validation accuracy : 0.783302 max acc epoch : 15 test accuracy : 0.788407

Epoch :  16 loss training:  66.5566054135561 Time :  159
accuracy train: 0.866104 val: 0.787992 test: 0.785594
max validation accuracy : 0.787992 max acc epoch : 16 test accuracy : 0.785594

Epoch :  17 loss training:  65.32757313549519 Time :  169
accuracy train: 0.874048 val: 0.795497 test: 0.787563
max validation accuracy : 0.795497 max acc epoch : 17 test accuracy : 0.787563

Epoch :  18 loss training:  63.13917976617813 Time :  179
accuracy train: 0.885137 val: 0.797373 test: 0.790096
max validation accuracy : 0.797373 max acc epoch : 18 test accuracy : 0.790096

Epoch :  19 loss training:  60.76263736188412 Time :  188
accuracy train: 0.886461 val: 0.794559 test: 0.786438
max validation accuracy : 0.797373 max acc epoch : 18 test accuracy : 0.790096

Epoch :  20 loss training:  57.89892102777958 Time :  197
accuracy train: 0.896392 val: 0.796435 test: 0.789252
max validation accuracy : 0.797373 max acc epoch : 18 test accuracy : 0.790096

Epoch :  21 loss training:  56.94955084472895 Time :  207
accuracy train: 0.900364 val: 0.790807 test: 0.786438
max validation accuracy : 0.797373 max acc epoch : 18 test accuracy : 0.790096

Epoch :  22 loss training:  55.497826129198074 Time :  218
accuracy train: 0.908971 val: 0.794559 test: 0.783061
max validation accuracy : 0.797373 max acc epoch : 18 test accuracy : 0.790096

Epoch :  23 loss training:  54.035539627075195 Time :  227
accuracy train: 0.916253 val: 0.799250 test: 0.781373
max validation accuracy : 0.799250 max acc epoch : 23 test accuracy : 0.781373

Epoch :  24 loss training:  50.555621951818466 Time :  237
accuracy train: 0.922873 val: 0.803002 test: 0.783343
max validation accuracy : 0.803002 max acc epoch : 24 test accuracy : 0.783343

Epoch :  25 loss training:  48.4717165902257 Time :  247
accuracy train: 0.924197 val: 0.799250 test: 0.786156
max validation accuracy : 0.803002 max acc epoch : 24 test accuracy : 0.783343

Epoch :  26 loss training:  46.62996178120375 Time :  257
accuracy train: 0.931314 val: 0.797373 test: 0.784187
max validation accuracy : 0.803002 max acc epoch : 24 test accuracy : 0.783343

Epoch :  27 loss training:  45.44897872209549 Time :  266
accuracy train: 0.938265 val: 0.802064 test: 0.781092
max validation accuracy : 0.803002 max acc epoch : 24 test accuracy : 0.783343

Epoch :  28 loss training:  43.64083082228899 Time :  276
accuracy train: 0.948858 val: 0.803940 test: 0.785594
max validation accuracy : 0.803940 max acc epoch : 28 test accuracy : 0.785594

Epoch :  29 loss training:  40.76631689071655 Time :  285
accuracy train: 0.953492 val: 0.812383 test: 0.781936
max validation accuracy : 0.812383 max acc epoch : 29 test accuracy : 0.781936

Epoch :  30 loss training:  41.039885096251965 Time :  294
accuracy train: 0.958788 val: 0.803002 test: 0.784468
max validation accuracy : 0.812383 max acc epoch : 29 test accuracy : 0.781936

Epoch :  31 loss training:  38.5533993691206 Time :  304
accuracy train: 0.961602 val: 0.804878 test: 0.782499
max validation accuracy : 0.812383 max acc epoch : 29 test accuracy : 0.781936

Epoch :  32 loss training:  36.52819685637951 Time :  315
accuracy train: 0.966236 val: 0.803940 test: 0.784468
max validation accuracy : 0.812383 max acc epoch : 29 test accuracy : 0.781936

Epoch :  33 loss training:  36.39812098443508 Time :  325
accuracy train: 0.965574 val: 0.801126 test: 0.778559
max validation accuracy : 0.812383 max acc epoch : 29 test accuracy : 0.781936

Epoch :  34 loss training:  34.47476979345083 Time :  336
accuracy train: 0.969712 val: 0.799250 test: 0.781092
max validation accuracy : 0.812383 max acc epoch : 29 test accuracy : 0.781936

Epoch :  35 loss training:  34.23138961195946 Time :  345
accuracy train: 0.976001 val: 0.796435 test: 0.775746
max validation accuracy : 0.812383 max acc epoch : 29 test accuracy : 0.781936

Epoch :  36 loss training:  32.56915697082877 Time :  354
accuracy train: 0.976498 val: 0.801126 test: 0.780810
max validation accuracy : 0.812383 max acc epoch : 29 test accuracy : 0.781936

Epoch :  37 loss training:  31.540697064250708 Time :  364
accuracy train: 0.980305 val: 0.798311 test: 0.776871
max validation accuracy : 0.812383 max acc epoch : 29 test accuracy : 0.781936

Epoch :  38 loss training:  31.766205552965403 Time :  374
accuracy train: 0.980967 val: 0.798311 test: 0.773776
max validation accuracy : 0.812383 max acc epoch : 29 test accuracy : 0.781936

Epoch :  39 loss training:  29.991916000843048 Time :  384
accuracy train: 0.983780 val: 0.793621 test: 0.774339
max validation accuracy : 0.812383 max acc epoch : 29 test accuracy : 0.781936

Epoch :  40 loss training:  28.017801735550165 Time :  393
accuracy train: 0.984111 val: 0.796435 test: 0.775183
max validation accuracy : 0.812383 max acc epoch : 29 test accuracy : 0.781936

========================================================================================================================================================================================================
best acc epoch :  29
validation accuracy :  0.8123827392120075
test accuracy :  0.7819358469330332
last test_accuracy :  0.7751828925154756
second best val :  0.8048780487804879
second best test :  0.7819358469330332
max gap 5
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=438, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  98.25235003232956 Time :  404
accuracy train: 0.771930 val: 0.783302 test: 0.772369
max validation accuracy : 0.783302 max acc epoch : 1 test accuracy : 0.772369
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.61055859923363 Time :  413
accuracy train: 0.769778 val: 0.767355 test: 0.747608
max validation accuracy : 0.783302 max acc epoch : 1 test accuracy : 0.772369
Epoch-2 lr: 0.001

Epoch :  3 loss training:  85.80813044309616 Time :  423
accuracy train: 0.778716 val: 0.760788 test: 0.756050
max validation accuracy : 0.783302 max acc epoch : 1 test accuracy : 0.772369
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  82.80289259552956 Time :  432
accuracy train: 0.774081 val: 0.752345 test: 0.744795
max validation accuracy : 0.783302 max acc epoch : 1 test accuracy : 0.772369
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.3094031214714 Time :  442
accuracy train: 0.796922 val: 0.784240 test: 0.775183
max validation accuracy : 0.784240 max acc epoch : 5 test accuracy : 0.775183
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  82.08475604653358 Time :  452
accuracy train: 0.812479 val: 0.775797 test: 0.777153
max validation accuracy : 0.784240 max acc epoch : 5 test accuracy : 0.775183
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.95843216776848 Time :  462
accuracy train: 0.812148 val: 0.785178 test: 0.776308
max validation accuracy : 0.785178 max acc epoch : 7 test accuracy : 0.776308
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  75.80204832553864 Time :  471
accuracy train: 0.817445 val: 0.787992 test: 0.772088
max validation accuracy : 0.787992 max acc epoch : 8 test accuracy : 0.772088
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.65668842196465 Time :  481
accuracy train: 0.806190 val: 0.761726 test: 0.754643
max validation accuracy : 0.787992 max acc epoch : 8 test accuracy : 0.772088
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.78502750396729 Time :  490
accuracy train: 0.821086 val: 0.774859 test: 0.768430
max validation accuracy : 0.787992 max acc epoch : 8 test accuracy : 0.772088

Epoch :  11 loss training:  75.22917202115059 Time :  500
accuracy train: 0.827210 val: 0.785178 test: 0.772651
max validation accuracy : 0.787992 max acc epoch : 8 test accuracy : 0.772088

Epoch :  12 loss training:  73.4271492511034 Time :  510
accuracy train: 0.836643 val: 0.792683 test: 0.773213
max validation accuracy : 0.792683 max acc epoch : 12 test accuracy : 0.773213

Epoch :  13 loss training:  70.24953557550907 Time :  521
accuracy train: 0.843429 val: 0.792683 test: 0.774620
max validation accuracy : 0.792683 max acc epoch : 12 test accuracy : 0.773213

Epoch :  14 loss training:  68.87388601899147 Time :  531
accuracy train: 0.851705 val: 0.791745 test: 0.772932
max validation accuracy : 0.792683 max acc epoch : 12 test accuracy : 0.773213

Epoch :  15 loss training:  66.96339370310307 Time :  540
accuracy train: 0.862297 val: 0.791745 test: 0.778559
max validation accuracy : 0.792683 max acc epoch : 12 test accuracy : 0.773213

Epoch :  16 loss training:  66.10503524541855 Time :  550
accuracy train: 0.869414 val: 0.789869 test: 0.776308
max validation accuracy : 0.792683 max acc epoch : 12 test accuracy : 0.773213

Epoch :  17 loss training:  63.56818190217018 Time :  559
accuracy train: 0.880172 val: 0.788931 test: 0.784468
max validation accuracy : 0.792683 max acc epoch : 12 test accuracy : 0.773213

Epoch :  18 loss training:  62.82011725008488 Time :  568
accuracy train: 0.884310 val: 0.791745 test: 0.776027
max validation accuracy : 0.792683 max acc epoch : 12 test accuracy : 0.773213

Epoch :  19 loss training:  59.36935895681381 Time :  578
accuracy train: 0.888282 val: 0.787054 test: 0.772651
max validation accuracy : 0.792683 max acc epoch : 12 test accuracy : 0.773213

Epoch :  20 loss training:  57.24693086743355 Time :  587
accuracy train: 0.893744 val: 0.782364 test: 0.771806
max validation accuracy : 0.792683 max acc epoch : 12 test accuracy : 0.773213

Epoch :  21 loss training:  57.09061770141125 Time :  597
accuracy train: 0.910791 val: 0.791745 test: 0.776027
max validation accuracy : 0.792683 max acc epoch : 12 test accuracy : 0.773213

Epoch :  22 loss training:  54.34645737707615 Time :  606
accuracy train: 0.916418 val: 0.789869 test: 0.776308
max validation accuracy : 0.792683 max acc epoch : 12 test accuracy : 0.773213

Epoch :  23 loss training:  51.7446860820055 Time :  616
accuracy train: 0.923039 val: 0.786116 test: 0.771806
max validation accuracy : 0.792683 max acc epoch : 12 test accuracy : 0.773213

========================================================================================================================================================================================================
best acc epoch :  12
validation accuracy :  0.7926829268292683
test accuracy :  0.7732132808103546
last test_accuracy :  0.7718064153066967
second best val :  0.7917448405253283
second best test :  0.7732132808103546
max gap 4
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=337, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  99.0136150419712 Time :  626
accuracy train: 0.771764 val: 0.772045 test: 0.766742
max validation accuracy : 0.772045 max acc epoch : 1 test accuracy : 0.766742
Epoch-1 lr: 0.001

Epoch :  2 loss training:  90.55041056871414 Time :  635
accuracy train: 0.778550 val: 0.768293 test: 0.762521
max validation accuracy : 0.772045 max acc epoch : 1 test accuracy : 0.766742
Epoch-2 lr: 0.001

Epoch :  3 loss training:  86.88104939460754 Time :  644
accuracy train: 0.785501 val: 0.773921 test: 0.767867
max validation accuracy : 0.773921 max acc epoch : 3 test accuracy : 0.767867
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.58211186528206 Time :  653
accuracy train: 0.797253 val: 0.760788 test: 0.771525
max validation accuracy : 0.773921 max acc epoch : 3 test accuracy : 0.767867
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.37929514050484 Time :  662
accuracy train: 0.809997 val: 0.774859 test: 0.777153
max validation accuracy : 0.774859 max acc epoch : 5 test accuracy : 0.777153
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.5051238834858 Time :  670
accuracy train: 0.803707 val: 0.772045 test: 0.776590
max validation accuracy : 0.774859 max acc epoch : 5 test accuracy : 0.777153
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  78.45613810420036 Time :  679
accuracy train: 0.807845 val: 0.772983 test: 0.774902
max validation accuracy : 0.774859 max acc epoch : 5 test accuracy : 0.777153
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.46773055195808 Time :  688
accuracy train: 0.808673 val: 0.778612 test: 0.772088
max validation accuracy : 0.778612 max acc epoch : 8 test accuracy : 0.772088
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  75.23841869831085 Time :  697
accuracy train: 0.823568 val: 0.779550 test: 0.778841
max validation accuracy : 0.779550 max acc epoch : 9 test accuracy : 0.778841
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.80351182818413 Time :  706
accuracy train: 0.818107 val: 0.783302 test: 0.773776
max validation accuracy : 0.783302 max acc epoch : 10 test accuracy : 0.773776

Epoch :  11 loss training:  73.9748366177082 Time :  715
accuracy train: 0.826216 val: 0.778612 test: 0.779966
max validation accuracy : 0.783302 max acc epoch : 10 test accuracy : 0.773776

Epoch :  12 loss training:  71.25542086362839 Time :  724
accuracy train: 0.828865 val: 0.779550 test: 0.780810
max validation accuracy : 0.783302 max acc epoch : 10 test accuracy : 0.773776

Epoch :  13 loss training:  70.79106283187866 Time :  733
accuracy train: 0.851705 val: 0.781426 test: 0.782499
max validation accuracy : 0.783302 max acc epoch : 10 test accuracy : 0.773776

Epoch :  14 loss training:  68.47018821537495 Time :  742
accuracy train: 0.858160 val: 0.786116 test: 0.781654
max validation accuracy : 0.786116 max acc epoch : 14 test accuracy : 0.781654

Epoch :  15 loss training:  67.5870868563652 Time :  752
accuracy train: 0.862463 val: 0.786116 test: 0.782780
max validation accuracy : 0.786116 max acc epoch : 14 test accuracy : 0.781654

Epoch :  16 loss training:  66.13357985019684 Time :  761
accuracy train: 0.874048 val: 0.787992 test: 0.785594
max validation accuracy : 0.787992 max acc epoch : 16 test accuracy : 0.785594

Epoch :  17 loss training:  63.57655255496502 Time :  770
accuracy train: 0.880338 val: 0.782364 test: 0.786156
max validation accuracy : 0.787992 max acc epoch : 16 test accuracy : 0.785594

Epoch :  18 loss training:  61.43837171792984 Time :  779
accuracy train: 0.886296 val: 0.787054 test: 0.783061
max validation accuracy : 0.787992 max acc epoch : 16 test accuracy : 0.785594

Epoch :  19 loss training:  59.51644729077816 Time :  789
accuracy train: 0.895730 val: 0.785178 test: 0.785031
max validation accuracy : 0.787992 max acc epoch : 16 test accuracy : 0.785594

Epoch :  20 loss training:  57.32894415408373 Time :  799
accuracy train: 0.907315 val: 0.785178 test: 0.787282
max validation accuracy : 0.787992 max acc epoch : 16 test accuracy : 0.785594

Epoch :  21 loss training:  56.47968266904354 Time :  809
accuracy train: 0.903674 val: 0.783302 test: 0.784468
max validation accuracy : 0.787992 max acc epoch : 16 test accuracy : 0.785594

Epoch :  22 loss training:  53.75871321558952 Time :  818
accuracy train: 0.913108 val: 0.792683 test: 0.784468
max validation accuracy : 0.792683 max acc epoch : 22 test accuracy : 0.784468

Epoch :  23 loss training:  52.30278420448303 Time :  827
accuracy train: 0.923204 val: 0.788931 test: 0.787845
max validation accuracy : 0.792683 max acc epoch : 22 test accuracy : 0.784468

Epoch :  24 loss training:  50.625392094254494 Time :  837
accuracy train: 0.930983 val: 0.789869 test: 0.781092
max validation accuracy : 0.792683 max acc epoch : 22 test accuracy : 0.784468

Epoch :  25 loss training:  47.22316639125347 Time :  846
accuracy train: 0.931645 val: 0.787992 test: 0.783061
max validation accuracy : 0.792683 max acc epoch : 22 test accuracy : 0.784468

Epoch :  26 loss training:  47.72357967495918 Time :  855
accuracy train: 0.935948 val: 0.791745 test: 0.785031
max validation accuracy : 0.792683 max acc epoch : 22 test accuracy : 0.784468

Epoch :  27 loss training:  45.4604265242815 Time :  864
accuracy train: 0.940417 val: 0.789869 test: 0.786438
max validation accuracy : 0.792683 max acc epoch : 22 test accuracy : 0.784468

Epoch :  28 loss training:  45.31767927110195 Time :  873
accuracy train: 0.941741 val: 0.797373 test: 0.775746
max validation accuracy : 0.797373 max acc epoch : 28 test accuracy : 0.775746

Epoch :  29 loss training:  42.044945396482944 Time :  883
accuracy train: 0.945382 val: 0.792683 test: 0.783061
max validation accuracy : 0.797373 max acc epoch : 28 test accuracy : 0.775746

Epoch :  30 loss training:  40.44546168297529 Time :  892
accuracy train: 0.953658 val: 0.791745 test: 0.782217
max validation accuracy : 0.797373 max acc epoch : 28 test accuracy : 0.775746

Epoch :  31 loss training:  38.2094224691391 Time :  901
accuracy train: 0.958623 val: 0.793621 test: 0.781092
max validation accuracy : 0.797373 max acc epoch : 28 test accuracy : 0.775746

Epoch :  32 loss training:  37.93027254194021 Time :  910
accuracy train: 0.960609 val: 0.789869 test: 0.772088
max validation accuracy : 0.797373 max acc epoch : 28 test accuracy : 0.775746

Epoch :  33 loss training:  35.31927273795009 Time :  919
accuracy train: 0.963588 val: 0.790807 test: 0.779966
max validation accuracy : 0.797373 max acc epoch : 28 test accuracy : 0.775746

Epoch :  34 loss training:  35.338612511754036 Time :  929
accuracy train: 0.967726 val: 0.789869 test: 0.778278
max validation accuracy : 0.797373 max acc epoch : 28 test accuracy : 0.775746

Epoch :  35 loss training:  34.137986332178116 Time :  939
accuracy train: 0.973188 val: 0.796435 test: 0.782499
max validation accuracy : 0.797373 max acc epoch : 28 test accuracy : 0.775746

Epoch :  36 loss training:  30.753324650228024 Time :  948
accuracy train: 0.971202 val: 0.783302 test: 0.774339
max validation accuracy : 0.797373 max acc epoch : 28 test accuracy : 0.775746

Epoch :  37 loss training:  31.170213237404823 Time :  958
accuracy train: 0.975505 val: 0.782364 test: 0.779122
max validation accuracy : 0.797373 max acc epoch : 28 test accuracy : 0.775746

Epoch :  38 loss training:  29.24423923715949 Time :  968
accuracy train: 0.981463 val: 0.787054 test: 0.777153
max validation accuracy : 0.797373 max acc epoch : 28 test accuracy : 0.775746

Epoch :  39 loss training:  27.790213068947196 Time :  977
accuracy train: 0.982291 val: 0.798311 test: 0.778841
max validation accuracy : 0.798311 max acc epoch : 39 test accuracy : 0.778841

Epoch :  40 loss training:  28.249452278017998 Time :  987
accuracy train: 0.981463 val: 0.790807 test: 0.776027
max validation accuracy : 0.798311 max acc epoch : 39 test accuracy : 0.778841

Epoch :  41 loss training:  27.138604938983917 Time :  997
accuracy train: 0.984608 val: 0.784240 test: 0.773776
max validation accuracy : 0.798311 max acc epoch : 39 test accuracy : 0.778841

Epoch :  42 loss training:  25.72560917213559 Time :  1007
accuracy train: 0.984773 val: 0.785178 test: 0.777153
max validation accuracy : 0.798311 max acc epoch : 39 test accuracy : 0.778841

Epoch :  43 loss training:  23.182430680841208 Time :  1017
accuracy train: 0.987421 val: 0.791745 test: 0.773776
max validation accuracy : 0.798311 max acc epoch : 39 test accuracy : 0.778841

Epoch :  44 loss training:  23.53898404352367 Time :  1026
accuracy train: 0.986263 val: 0.782364 test: 0.768993
max validation accuracy : 0.798311 max acc epoch : 39 test accuracy : 0.778841

Epoch :  45 loss training:  22.62761364132166 Time :  1035
accuracy train: 0.990235 val: 0.790807 test: 0.771806
max validation accuracy : 0.798311 max acc epoch : 39 test accuracy : 0.778841

Epoch :  46 loss training:  22.025905068963766 Time :  1045
accuracy train: 0.988083 val: 0.790807 test: 0.770681
max validation accuracy : 0.798311 max acc epoch : 39 test accuracy : 0.778841

Epoch :  47 loss training:  20.280373678542674 Time :  1054
accuracy train: 0.991725 val: 0.794559 test: 0.770962
max validation accuracy : 0.798311 max acc epoch : 39 test accuracy : 0.778841

Epoch :  48 loss training:  20.578260557726026 Time :  1064
accuracy train: 0.992718 val: 0.787054 test: 0.768430
max validation accuracy : 0.798311 max acc epoch : 39 test accuracy : 0.778841

Epoch :  49 loss training:  19.497776428237557 Time :  1073
accuracy train: 0.994704 val: 0.778612 test: 0.765898
max validation accuracy : 0.798311 max acc epoch : 39 test accuracy : 0.778841

Epoch :  50 loss training:  18.66953970026225 Time :  1082
accuracy train: 0.995035 val: 0.788931 test: 0.772369
max validation accuracy : 0.798311 max acc epoch : 39 test accuracy : 0.778841

========================================================================================================================================================================================================
best acc epoch :  39
validation accuracy :  0.798311444652908
test accuracy :  0.7788407428249859
last test_accuracy :  0.7723691615081598
second best val :  0.797373358348968
second best test :  0.7757456387169387
max gap 11
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=919, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  94.90733247995377 Time :  1092
accuracy train: 0.771433 val: 0.727955 test: 0.755205
max validation accuracy : 0.727955 max acc epoch : 1 test accuracy : 0.755205
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.26528272032738 Time :  1100
accuracy train: 0.777888 val: 0.739212 test: 0.762240
max validation accuracy : 0.739212 max acc epoch : 2 test accuracy : 0.762240
Epoch-2 lr: 0.001

Epoch :  3 loss training:  85.02710056304932 Time :  1110
accuracy train: 0.789970 val: 0.740150 test: 0.767867
max validation accuracy : 0.740150 max acc epoch : 3 test accuracy : 0.767867
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  80.51161581277847 Time :  1119
accuracy train: 0.799239 val: 0.755159 test: 0.772932
max validation accuracy : 0.755159 max acc epoch : 4 test accuracy : 0.772932
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.72016835212708 Time :  1128
accuracy train: 0.808342 val: 0.748593 test: 0.780529
max validation accuracy : 0.755159 max acc epoch : 4 test accuracy : 0.772932
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  78.56644976139069 Time :  1137
accuracy train: 0.819762 val: 0.766417 test: 0.776308
max validation accuracy : 0.766417 max acc epoch : 6 test accuracy : 0.776308
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.48473024368286 Time :  1147
accuracy train: 0.819596 val: 0.758912 test: 0.779403
max validation accuracy : 0.766417 max acc epoch : 6 test accuracy : 0.776308
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  75.48434966802597 Time :  1157
accuracy train: 0.819100 val: 0.761726 test: 0.779966
max validation accuracy : 0.766417 max acc epoch : 6 test accuracy : 0.776308
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  74.6331228762865 Time :  1168
accuracy train: 0.828534 val: 0.753283 test: 0.777715
max validation accuracy : 0.766417 max acc epoch : 6 test accuracy : 0.776308
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  73.45275585353374 Time :  1177
accuracy train: 0.831182 val: 0.759850 test: 0.780810
max validation accuracy : 0.766417 max acc epoch : 6 test accuracy : 0.776308

Epoch :  11 loss training:  73.54377770423889 Time :  1187
accuracy train: 0.838961 val: 0.759850 test: 0.781092
max validation accuracy : 0.766417 max acc epoch : 6 test accuracy : 0.776308

Epoch :  12 loss training:  73.52433554828167 Time :  1196
accuracy train: 0.844091 val: 0.759850 test: 0.783624
max validation accuracy : 0.766417 max acc epoch : 6 test accuracy : 0.776308

Epoch :  13 loss training:  70.70062877237797 Time :  1205
accuracy train: 0.850712 val: 0.760788 test: 0.784750
max validation accuracy : 0.766417 max acc epoch : 6 test accuracy : 0.776308

Epoch :  14 loss training:  69.33229918777943 Time :  1214
accuracy train: 0.859484 val: 0.759850 test: 0.783343
max validation accuracy : 0.766417 max acc epoch : 6 test accuracy : 0.776308

Epoch :  15 loss training:  66.86538170278072 Time :  1223
accuracy train: 0.869745 val: 0.762664 test: 0.783624
max validation accuracy : 0.766417 max acc epoch : 6 test accuracy : 0.776308

Epoch :  16 loss training:  64.7806341201067 Time :  1232
accuracy train: 0.879510 val: 0.767355 test: 0.784187
max validation accuracy : 0.767355 max acc epoch : 16 test accuracy : 0.784187

Epoch :  17 loss training:  62.66598053276539 Time :  1241
accuracy train: 0.881000 val: 0.768293 test: 0.787282
max validation accuracy : 0.768293 max acc epoch : 17 test accuracy : 0.787282

Epoch :  18 loss training:  60.1120890378952 Time :  1250
accuracy train: 0.890103 val: 0.765478 test: 0.788689
max validation accuracy : 0.768293 max acc epoch : 17 test accuracy : 0.787282

Epoch :  19 loss training:  59.169213116168976 Time :  1259
accuracy train: 0.894737 val: 0.763602 test: 0.785875
max validation accuracy : 0.768293 max acc epoch : 17 test accuracy : 0.787282

Epoch :  20 loss training:  57.43222762644291 Time :  1269
accuracy train: 0.903012 val: 0.765478 test: 0.787845
max validation accuracy : 0.768293 max acc epoch : 17 test accuracy : 0.787282

Epoch :  21 loss training:  56.72387556731701 Time :  1278
accuracy train: 0.908971 val: 0.772045 test: 0.784468
max validation accuracy : 0.772045 max acc epoch : 21 test accuracy : 0.784468

Epoch :  22 loss training:  53.566165789961815 Time :  1288
accuracy train: 0.917577 val: 0.763602 test: 0.787563
max validation accuracy : 0.772045 max acc epoch : 21 test accuracy : 0.784468

Epoch :  23 loss training:  51.603470005095005 Time :  1297
accuracy train: 0.921053 val: 0.770169 test: 0.784468
max validation accuracy : 0.772045 max acc epoch : 21 test accuracy : 0.784468

Epoch :  24 loss training:  49.75524436682463 Time :  1306
accuracy train: 0.929659 val: 0.767355 test: 0.786156
max validation accuracy : 0.772045 max acc epoch : 21 test accuracy : 0.784468

Epoch :  25 loss training:  47.69041831791401 Time :  1314
accuracy train: 0.933466 val: 0.765478 test: 0.788126
max validation accuracy : 0.772045 max acc epoch : 21 test accuracy : 0.784468

Epoch :  26 loss training:  46.924674436450005 Time :  1323
accuracy train: 0.939093 val: 0.766417 test: 0.788970
max validation accuracy : 0.772045 max acc epoch : 21 test accuracy : 0.784468

Epoch :  27 loss training:  45.342462971806526 Time :  1332
accuracy train: 0.942734 val: 0.765478 test: 0.787563
max validation accuracy : 0.772045 max acc epoch : 21 test accuracy : 0.784468

Epoch :  28 loss training:  41.06446576863527 Time :  1341
accuracy train: 0.949024 val: 0.762664 test: 0.784187
max validation accuracy : 0.772045 max acc epoch : 21 test accuracy : 0.784468

Epoch :  29 loss training:  42.44662372767925 Time :  1351
accuracy train: 0.956306 val: 0.764540 test: 0.785875
max validation accuracy : 0.772045 max acc epoch : 21 test accuracy : 0.784468

Epoch :  30 loss training:  38.538378585129976 Time :  1360
accuracy train: 0.958623 val: 0.770169 test: 0.782499
max validation accuracy : 0.772045 max acc epoch : 21 test accuracy : 0.784468

Epoch :  31 loss training:  39.45065760239959 Time :  1369
accuracy train: 0.962264 val: 0.770169 test: 0.784187
max validation accuracy : 0.772045 max acc epoch : 21 test accuracy : 0.784468

Epoch :  32 loss training:  38.03989252448082 Time :  1378
accuracy train: 0.967395 val: 0.771107 test: 0.785875
max validation accuracy : 0.772045 max acc epoch : 21 test accuracy : 0.784468

========================================================================================================================================================================================================
best acc epoch :  21
validation accuracy :  0.7720450281425891
test accuracy :  0.7844682048396173
last test_accuracy :  0.7858750703432752
second best val :  0.7711069418386491
second best test :  0.7844682048396173
max gap 10
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  29 	 val_accuracy : 0.81238 	 test_accuracy : 0.78194 	 last test_accuracy : 0.77518 	 second best val : 0.80488 	 second best test : 0.78194
k :  1 	 best_acc epoch :  12 	 val_accuracy : 0.79268 	 test_accuracy : 0.77321 	 last test_accuracy : 0.77181 	 second best val : 0.79174 	 second best test : 0.77321
k :  2 	 best_acc epoch :  39 	 val_accuracy : 0.79831 	 test_accuracy : 0.77884 	 last test_accuracy : 0.77237 	 second best val : 0.79737 	 second best test : 0.77575
k :  3 	 best_acc epoch :  21 	 val_accuracy : 0.77205 	 test_accuracy : 0.78447 	 last test_accuracy : 0.78588 	 second best val : 0.77111 	 second best test : 0.78447

avg :  	 val_accuracy : 0.79386 	 test_accuracy : 0.77961 	 last_accuracy : 0.77631 	 second best val : 0.79128 	 second best test : 0.77884

std :  	 val_accuracy : 0.01449 	 test_accuracy : 0.00420 	 last_accuracy : 0.00567 	 second best val : 0.01254 	 second best test : 0.00454


date and time :  Sat Jul  3 00:37:42 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=331, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  95.40256956219673 Time :  11
accuracy train: 0.769116 val: 0.740150 test: 0.752673
max validation accuracy : 0.740150 max acc epoch : 1 test accuracy : 0.752673
Epoch-1 lr: 0.001

Epoch :  2 loss training:  88.21277153491974 Time :  20
accuracy train: 0.773088 val: 0.743902 test: 0.749297
max validation accuracy : 0.743902 max acc epoch : 2 test accuracy : 0.749297
Epoch-2 lr: 0.001

Epoch :  3 loss training:  84.2248138487339 Time :  30
accuracy train: 0.781529 val: 0.750469 test: 0.752673
max validation accuracy : 0.750469 max acc epoch : 3 test accuracy : 0.752673
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  82.70235016942024 Time :  40
accuracy train: 0.800066 val: 0.763602 test: 0.778278
max validation accuracy : 0.763602 max acc epoch : 4 test accuracy : 0.778278
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.22761622071266 Time :  51
accuracy train: 0.792453 val: 0.749531 test: 0.768993
max validation accuracy : 0.763602 max acc epoch : 4 test accuracy : 0.778278
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.3308458328247 Time :  60
accuracy train: 0.810824 val: 0.765478 test: 0.762802
max validation accuracy : 0.765478 max acc epoch : 6 test accuracy : 0.762802
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  76.65736016631126 Time :  70
accuracy train: 0.813969 val: 0.771107 test: 0.775464
max validation accuracy : 0.771107 max acc epoch : 7 test accuracy : 0.775464
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.05095985531807 Time :  81
accuracy train: 0.816286 val: 0.770169 test: 0.779122
max validation accuracy : 0.771107 max acc epoch : 7 test accuracy : 0.775464
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.79632005095482 Time :  90
accuracy train: 0.818769 val: 0.765478 test: 0.779403
max validation accuracy : 0.771107 max acc epoch : 7 test accuracy : 0.775464
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.95818796753883 Time :  100
accuracy train: 0.821251 val: 0.765478 test: 0.777434
max validation accuracy : 0.771107 max acc epoch : 7 test accuracy : 0.775464

Epoch :  11 loss training:  74.10037489235401 Time :  109
accuracy train: 0.827872 val: 0.762664 test: 0.772369
max validation accuracy : 0.771107 max acc epoch : 7 test accuracy : 0.775464

Epoch :  12 loss training:  73.23785354197025 Time :  119
accuracy train: 0.833664 val: 0.766417 test: 0.779966
max validation accuracy : 0.771107 max acc epoch : 7 test accuracy : 0.775464

Epoch :  13 loss training:  70.67616583406925 Time :  129
accuracy train: 0.843926 val: 0.768293 test: 0.780248
max validation accuracy : 0.771107 max acc epoch : 7 test accuracy : 0.775464

Epoch :  14 loss training:  69.31979987025261 Time :  139
accuracy train: 0.851374 val: 0.776735 test: 0.785031
max validation accuracy : 0.776735 max acc epoch : 14 test accuracy : 0.785031

Epoch :  15 loss training:  65.64089867472649 Time :  149
accuracy train: 0.855180 val: 0.773921 test: 0.780810
max validation accuracy : 0.776735 max acc epoch : 14 test accuracy : 0.785031

Epoch :  16 loss training:  66.07668079435825 Time :  159
accuracy train: 0.866600 val: 0.773921 test: 0.783905
max validation accuracy : 0.776735 max acc epoch : 14 test accuracy : 0.785031

Epoch :  17 loss training:  62.910979345440865 Time :  170
accuracy train: 0.871235 val: 0.778612 test: 0.787001
max validation accuracy : 0.778612 max acc epoch : 17 test accuracy : 0.787001

Epoch :  18 loss training:  61.48043581843376 Time :  180
accuracy train: 0.881827 val: 0.773921 test: 0.784187
max validation accuracy : 0.778612 max acc epoch : 17 test accuracy : 0.787001

Epoch :  19 loss training:  59.29883302748203 Time :  190
accuracy train: 0.888944 val: 0.777674 test: 0.783343
max validation accuracy : 0.778612 max acc epoch : 17 test accuracy : 0.787001

Epoch :  20 loss training:  58.774204403162 Time :  200
accuracy train: 0.898378 val: 0.780488 test: 0.785031
max validation accuracy : 0.780488 max acc epoch : 20 test accuracy : 0.785031

Epoch :  21 loss training:  55.500213384628296 Time :  210
accuracy train: 0.907481 val: 0.781426 test: 0.784468
max validation accuracy : 0.781426 max acc epoch : 21 test accuracy : 0.784468

Epoch :  22 loss training:  55.0788469016552 Time :  219
accuracy train: 0.907812 val: 0.783302 test: 0.780248
max validation accuracy : 0.783302 max acc epoch : 22 test accuracy : 0.780248

Epoch :  23 loss training:  53.98278959095478 Time :  229
accuracy train: 0.917246 val: 0.782364 test: 0.785875
max validation accuracy : 0.783302 max acc epoch : 22 test accuracy : 0.780248

Epoch :  24 loss training:  50.29912477731705 Time :  238
accuracy train: 0.926514 val: 0.776735 test: 0.787563
max validation accuracy : 0.783302 max acc epoch : 22 test accuracy : 0.780248

Epoch :  25 loss training:  47.56139576435089 Time :  248
accuracy train: 0.931480 val: 0.780488 test: 0.782780
max validation accuracy : 0.783302 max acc epoch : 22 test accuracy : 0.780248

Epoch :  26 loss training:  47.145568676292896 Time :  257
accuracy train: 0.939093 val: 0.783302 test: 0.786438
max validation accuracy : 0.783302 max acc epoch : 22 test accuracy : 0.780248

Epoch :  27 loss training:  44.37013967335224 Time :  267
accuracy train: 0.942403 val: 0.782364 test: 0.784468
max validation accuracy : 0.783302 max acc epoch : 22 test accuracy : 0.780248

Epoch :  28 loss training:  43.42680659145117 Time :  277
accuracy train: 0.946044 val: 0.785178 test: 0.783061
max validation accuracy : 0.785178 max acc epoch : 28 test accuracy : 0.783061

Epoch :  29 loss training:  41.78212949633598 Time :  286
accuracy train: 0.950348 val: 0.781426 test: 0.779966
max validation accuracy : 0.785178 max acc epoch : 28 test accuracy : 0.783061

Epoch :  30 loss training:  40.32048837095499 Time :  296
accuracy train: 0.948692 val: 0.780488 test: 0.779685
max validation accuracy : 0.785178 max acc epoch : 28 test accuracy : 0.783061

Epoch :  31 loss training:  37.35029397904873 Time :  306
accuracy train: 0.956802 val: 0.782364 test: 0.787001
max validation accuracy : 0.785178 max acc epoch : 28 test accuracy : 0.783061

Epoch :  32 loss training:  36.87682195007801 Time :  315
accuracy train: 0.961106 val: 0.778612 test: 0.784187
max validation accuracy : 0.785178 max acc epoch : 28 test accuracy : 0.783061

Epoch :  33 loss training:  36.721963703632355 Time :  326
accuracy train: 0.964581 val: 0.777674 test: 0.778841
max validation accuracy : 0.785178 max acc epoch : 28 test accuracy : 0.783061

Epoch :  34 loss training:  34.25146862119436 Time :  336
accuracy train: 0.970374 val: 0.775797 test: 0.782780
max validation accuracy : 0.785178 max acc epoch : 28 test accuracy : 0.783061

Epoch :  35 loss training:  33.58266260102391 Time :  346
accuracy train: 0.969050 val: 0.775797 test: 0.781373
max validation accuracy : 0.785178 max acc epoch : 28 test accuracy : 0.783061

Epoch :  36 loss training:  31.399084463715553 Time :  357
accuracy train: 0.974843 val: 0.772045 test: 0.783061
max validation accuracy : 0.785178 max acc epoch : 28 test accuracy : 0.783061

Epoch :  37 loss training:  29.834170408546925 Time :  366
accuracy train: 0.974181 val: 0.777674 test: 0.781936
max validation accuracy : 0.785178 max acc epoch : 28 test accuracy : 0.783061

Epoch :  38 loss training:  30.225705359131098 Time :  376
accuracy train: 0.976498 val: 0.771107 test: 0.782780
max validation accuracy : 0.785178 max acc epoch : 28 test accuracy : 0.783061

Epoch :  39 loss training:  29.108543071895838 Time :  385
accuracy train: 0.970871 val: 0.780488 test: 0.781654
max validation accuracy : 0.785178 max acc epoch : 28 test accuracy : 0.783061

========================================================================================================================================================================================================
best acc epoch :  28
validation accuracy :  0.7851782363977486
test accuracy :  0.7830613393359594
last test_accuracy :  0.7816544738323016
second best val :  0.7833020637898687
second best test :  0.7802476083286438
max gap 7
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=949, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  97.8138819038868 Time :  395
accuracy train: 0.762330 val: 0.735460 test: 0.749859
max validation accuracy : 0.735460 max acc epoch : 1 test accuracy : 0.749859
Epoch-1 lr: 0.001

Epoch :  2 loss training:  89.22299382090569 Time :  406
accuracy train: 0.775405 val: 0.732645 test: 0.750141
max validation accuracy : 0.735460 max acc epoch : 1 test accuracy : 0.749859
Epoch-2 lr: 0.001

Epoch :  3 loss training:  85.41827604174614 Time :  416
accuracy train: 0.792949 val: 0.737336 test: 0.761114
max validation accuracy : 0.737336 max acc epoch : 3 test accuracy : 0.761114
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  82.06865870952606 Time :  426
accuracy train: 0.789805 val: 0.749531 test: 0.770400
max validation accuracy : 0.749531 max acc epoch : 4 test accuracy : 0.770400
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.59585332870483 Time :  437
accuracy train: 0.800894 val: 0.751407 test: 0.772369
max validation accuracy : 0.751407 max acc epoch : 5 test accuracy : 0.772369
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.36040270328522 Time :  447
accuracy train: 0.803873 val: 0.747655 test: 0.777997
max validation accuracy : 0.751407 max acc epoch : 5 test accuracy : 0.772369
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  78.17650166153908 Time :  457
accuracy train: 0.811652 val: 0.750469 test: 0.780529
max validation accuracy : 0.751407 max acc epoch : 5 test accuracy : 0.772369
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  77.40747025609016 Time :  467
accuracy train: 0.809169 val: 0.756098 test: 0.778559
max validation accuracy : 0.756098 max acc epoch : 8 test accuracy : 0.778559
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  75.77605339884758 Time :  476
accuracy train: 0.815624 val: 0.751407 test: 0.777434
max validation accuracy : 0.756098 max acc epoch : 8 test accuracy : 0.778559
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.47342377901077 Time :  485
accuracy train: 0.815624 val: 0.757974 test: 0.785312
max validation accuracy : 0.757974 max acc epoch : 10 test accuracy : 0.785312

Epoch :  11 loss training:  75.0949109941721 Time :  495
accuracy train: 0.819927 val: 0.746717 test: 0.779966
max validation accuracy : 0.757974 max acc epoch : 10 test accuracy : 0.785312

Epoch :  12 loss training:  72.48236340284348 Time :  505
accuracy train: 0.835154 val: 0.767355 test: 0.784187
max validation accuracy : 0.767355 max acc epoch : 12 test accuracy : 0.784187

Epoch :  13 loss training:  71.70655430853367 Time :  515
accuracy train: 0.840119 val: 0.763602 test: 0.783624
max validation accuracy : 0.767355 max acc epoch : 12 test accuracy : 0.784187

Epoch :  14 loss training:  69.16287502646446 Time :  524
accuracy train: 0.843926 val: 0.750469 test: 0.782780
max validation accuracy : 0.767355 max acc epoch : 12 test accuracy : 0.784187

Epoch :  15 loss training:  68.42592677474022 Time :  534
accuracy train: 0.857498 val: 0.764540 test: 0.788970
max validation accuracy : 0.767355 max acc epoch : 12 test accuracy : 0.784187

Epoch :  16 loss training:  65.03249378502369 Time :  544
accuracy train: 0.865111 val: 0.771107 test: 0.784750
max validation accuracy : 0.771107 max acc epoch : 16 test accuracy : 0.784750

Epoch :  17 loss training:  63.850493147969246 Time :  553
accuracy train: 0.869414 val: 0.766417 test: 0.783061
max validation accuracy : 0.771107 max acc epoch : 16 test accuracy : 0.784750

Epoch :  18 loss training:  62.58749708533287 Time :  563
accuracy train: 0.873221 val: 0.755159 test: 0.785031
max validation accuracy : 0.771107 max acc epoch : 16 test accuracy : 0.784750

Epoch :  19 loss training:  60.874615639448166 Time :  573
accuracy train: 0.882489 val: 0.757036 test: 0.783905
max validation accuracy : 0.771107 max acc epoch : 16 test accuracy : 0.784750

Epoch :  20 loss training:  57.79842184484005 Time :  583
accuracy train: 0.887951 val: 0.761726 test: 0.783343
max validation accuracy : 0.771107 max acc epoch : 16 test accuracy : 0.784750

Epoch :  21 loss training:  56.217887595295906 Time :  593
accuracy train: 0.903343 val: 0.764540 test: 0.786719
max validation accuracy : 0.771107 max acc epoch : 16 test accuracy : 0.784750

Epoch :  22 loss training:  54.63151963055134 Time :  602
accuracy train: 0.910626 val: 0.763602 test: 0.788689
max validation accuracy : 0.771107 max acc epoch : 16 test accuracy : 0.784750

Epoch :  23 loss training:  51.86496244370937 Time :  612
accuracy train: 0.916418 val: 0.763602 test: 0.788970
max validation accuracy : 0.771107 max acc epoch : 16 test accuracy : 0.784750

Epoch :  24 loss training:  50.42788127064705 Time :  622
accuracy train: 0.922046 val: 0.767355 test: 0.788407
max validation accuracy : 0.771107 max acc epoch : 16 test accuracy : 0.784750

Epoch :  25 loss training:  49.036540165543556 Time :  633
accuracy train: 0.929163 val: 0.772045 test: 0.791221
max validation accuracy : 0.772045 max acc epoch : 25 test accuracy : 0.791221

Epoch :  26 loss training:  45.561041451990604 Time :  642
accuracy train: 0.937603 val: 0.773921 test: 0.791221
max validation accuracy : 0.773921 max acc epoch : 26 test accuracy : 0.791221

Epoch :  27 loss training:  44.96088459342718 Time :  652
accuracy train: 0.939424 val: 0.772983 test: 0.793472
max validation accuracy : 0.773921 max acc epoch : 26 test accuracy : 0.791221

Epoch :  28 loss training:  42.86298308521509 Time :  662
accuracy train: 0.944886 val: 0.759850 test: 0.794598
max validation accuracy : 0.773921 max acc epoch : 26 test accuracy : 0.791221

Epoch :  29 loss training:  40.86695156246424 Time :  673
accuracy train: 0.954982 val: 0.764540 test: 0.788126
max validation accuracy : 0.773921 max acc epoch : 26 test accuracy : 0.791221

Epoch :  30 loss training:  40.668948605656624 Time :  683
accuracy train: 0.956802 val: 0.768293 test: 0.787001
max validation accuracy : 0.773921 max acc epoch : 26 test accuracy : 0.791221

Epoch :  31 loss training:  37.94798345863819 Time :  694
accuracy train: 0.960609 val: 0.768293 test: 0.787845
max validation accuracy : 0.773921 max acc epoch : 26 test accuracy : 0.791221

Epoch :  32 loss training:  37.60991916060448 Time :  704
accuracy train: 0.963257 val: 0.765478 test: 0.787563
max validation accuracy : 0.773921 max acc epoch : 26 test accuracy : 0.791221

Epoch :  33 loss training:  35.855011861771345 Time :  714
accuracy train: 0.965905 val: 0.767355 test: 0.784468
max validation accuracy : 0.773921 max acc epoch : 26 test accuracy : 0.791221

Epoch :  34 loss training:  35.16785614937544 Time :  724
accuracy train: 0.973519 val: 0.757974 test: 0.787001
max validation accuracy : 0.773921 max acc epoch : 26 test accuracy : 0.791221

Epoch :  35 loss training:  33.154419399797916 Time :  734
accuracy train: 0.975339 val: 0.759850 test: 0.787282
max validation accuracy : 0.773921 max acc epoch : 26 test accuracy : 0.791221

Epoch :  36 loss training:  31.394517872482538 Time :  744
accuracy train: 0.976994 val: 0.765478 test: 0.786438
max validation accuracy : 0.773921 max acc epoch : 26 test accuracy : 0.791221

Epoch :  37 loss training:  29.89222440496087 Time :  754
accuracy train: 0.977987 val: 0.762664 test: 0.786719
max validation accuracy : 0.773921 max acc epoch : 26 test accuracy : 0.791221

========================================================================================================================================================================================================
best acc epoch :  26
validation accuracy :  0.773921200750469
test accuracy :  0.7912211592571751
last test_accuracy :  0.7867191896454699
second best val :  0.7729831144465291
second best test :  0.7912211592571751
max gap 9
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=855, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  97.01654744148254 Time :  766
accuracy train: 0.735187 val: 0.729831 test: 0.727631
max validation accuracy : 0.729831 max acc epoch : 1 test accuracy : 0.727631
Epoch-1 lr: 0.001

Epoch :  2 loss training:  88.95676213502884 Time :  777
accuracy train: 0.778716 val: 0.771107 test: 0.770962
max validation accuracy : 0.771107 max acc epoch : 2 test accuracy : 0.770962
Epoch-2 lr: 0.001

Epoch :  3 loss training:  86.5565370619297 Time :  786
accuracy train: 0.771930 val: 0.763602 test: 0.762240
max validation accuracy : 0.771107 max acc epoch : 2 test accuracy : 0.770962
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  82.35487198829651 Time :  797
accuracy train: 0.794770 val: 0.772045 test: 0.779122
max validation accuracy : 0.772045 max acc epoch : 4 test accuracy : 0.779122
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  81.73535737395287 Time :  806
accuracy train: 0.796425 val: 0.767355 test: 0.776871
max validation accuracy : 0.772045 max acc epoch : 4 test accuracy : 0.779122
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.16853439807892 Time :  816
accuracy train: 0.801887 val: 0.777674 test: 0.779966
max validation accuracy : 0.777674 max acc epoch : 6 test accuracy : 0.779966
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.48286747932434 Time :  826
accuracy train: 0.803376 val: 0.783302 test: 0.779685
max validation accuracy : 0.783302 max acc epoch : 7 test accuracy : 0.779685
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  78.06264600157738 Time :  835
accuracy train: 0.809997 val: 0.787054 test: 0.778841
max validation accuracy : 0.787054 max acc epoch : 8 test accuracy : 0.778841
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  79.0755814909935 Time :  845
accuracy train: 0.808507 val: 0.774859 test: 0.775464
max validation accuracy : 0.787054 max acc epoch : 8 test accuracy : 0.778841
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  77.10229432582855 Time :  855
accuracy train: 0.818438 val: 0.789869 test: 0.783624
max validation accuracy : 0.789869 max acc epoch : 10 test accuracy : 0.783624

Epoch :  11 loss training:  74.88894364237785 Time :  864
accuracy train: 0.817279 val: 0.773921 test: 0.781373
max validation accuracy : 0.789869 max acc epoch : 10 test accuracy : 0.783624

Epoch :  12 loss training:  75.25347855687141 Time :  874
accuracy train: 0.831513 val: 0.780488 test: 0.784468
max validation accuracy : 0.789869 max acc epoch : 10 test accuracy : 0.783624

Epoch :  13 loss training:  72.01481023430824 Time :  884
accuracy train: 0.839126 val: 0.781426 test: 0.783905
max validation accuracy : 0.789869 max acc epoch : 10 test accuracy : 0.783624

Epoch :  14 loss training:  69.63198249042034 Time :  894
accuracy train: 0.843760 val: 0.783302 test: 0.783905
max validation accuracy : 0.789869 max acc epoch : 10 test accuracy : 0.783624

Epoch :  15 loss training:  69.00935733318329 Time :  904
accuracy train: 0.854849 val: 0.786116 test: 0.788126
max validation accuracy : 0.789869 max acc epoch : 10 test accuracy : 0.783624

Epoch :  16 loss training:  67.0413070321083 Time :  914
accuracy train: 0.860477 val: 0.793621 test: 0.789252
max validation accuracy : 0.793621 max acc epoch : 16 test accuracy : 0.789252

Epoch :  17 loss training:  65.36192527413368 Time :  924
accuracy train: 0.868752 val: 0.785178 test: 0.786438
max validation accuracy : 0.793621 max acc epoch : 16 test accuracy : 0.789252

Epoch :  18 loss training:  62.65477226674557 Time :  934
accuracy train: 0.874545 val: 0.788931 test: 0.788126
max validation accuracy : 0.793621 max acc epoch : 16 test accuracy : 0.789252

Epoch :  19 loss training:  62.58216853439808 Time :  941
accuracy train: 0.882489 val: 0.786116 test: 0.790940
max validation accuracy : 0.793621 max acc epoch : 16 test accuracy : 0.789252

Epoch :  20 loss training:  60.85274848341942 Time :  952
accuracy train: 0.885303 val: 0.787054 test: 0.785875
max validation accuracy : 0.793621 max acc epoch : 16 test accuracy : 0.789252

Epoch :  21 loss training:  57.900778383016586 Time :  961
accuracy train: 0.891096 val: 0.787992 test: 0.786719
max validation accuracy : 0.793621 max acc epoch : 16 test accuracy : 0.789252

Epoch :  22 loss training:  56.87544924020767 Time :  972
accuracy train: 0.898544 val: 0.797373 test: 0.787001
max validation accuracy : 0.797373 max acc epoch : 22 test accuracy : 0.787001

Epoch :  23 loss training:  54.569613471627235 Time :  982
accuracy train: 0.905660 val: 0.797373 test: 0.784187
max validation accuracy : 0.797373 max acc epoch : 22 test accuracy : 0.787001

Epoch :  24 loss training:  52.24543611705303 Time :  992
accuracy train: 0.917411 val: 0.797373 test: 0.785312
max validation accuracy : 0.797373 max acc epoch : 22 test accuracy : 0.787001

Epoch :  25 loss training:  50.409315429627895 Time :  1003
accuracy train: 0.920722 val: 0.790807 test: 0.786719
max validation accuracy : 0.797373 max acc epoch : 22 test accuracy : 0.787001

Epoch :  26 loss training:  48.74268162250519 Time :  1013
accuracy train: 0.929494 val: 0.798311 test: 0.784187
max validation accuracy : 0.798311 max acc epoch : 26 test accuracy : 0.784187

Epoch :  27 loss training:  46.81189800798893 Time :  1024
accuracy train: 0.936279 val: 0.789869 test: 0.787563
max validation accuracy : 0.798311 max acc epoch : 26 test accuracy : 0.784187

Epoch :  28 loss training:  45.21409934014082 Time :  1034
accuracy train: 0.937603 val: 0.788931 test: 0.781936
max validation accuracy : 0.798311 max acc epoch : 26 test accuracy : 0.784187

Epoch :  29 loss training:  42.948402129113674 Time :  1045
accuracy train: 0.945382 val: 0.792683 test: 0.783905
max validation accuracy : 0.798311 max acc epoch : 26 test accuracy : 0.784187

Epoch :  30 loss training:  43.13458560407162 Time :  1055
accuracy train: 0.946706 val: 0.794559 test: 0.784750
max validation accuracy : 0.798311 max acc epoch : 26 test accuracy : 0.784187

Epoch :  31 loss training:  40.57366186380386 Time :  1066
accuracy train: 0.952168 val: 0.801126 test: 0.787001
max validation accuracy : 0.801126 max acc epoch : 31 test accuracy : 0.787001

Epoch :  32 loss training:  40.316413067281246 Time :  1076
accuracy train: 0.959616 val: 0.800188 test: 0.783061
max validation accuracy : 0.801126 max acc epoch : 31 test accuracy : 0.787001

Epoch :  33 loss training:  38.19190913438797 Time :  1086
accuracy train: 0.959285 val: 0.795497 test: 0.781654
max validation accuracy : 0.801126 max acc epoch : 31 test accuracy : 0.787001

Epoch :  34 loss training:  35.572623908519745 Time :  1096
accuracy train: 0.964581 val: 0.801126 test: 0.783061
max validation accuracy : 0.801126 max acc epoch : 31 test accuracy : 0.787001

Epoch :  35 loss training:  35.137912176549435 Time :  1105
accuracy train: 0.968553 val: 0.796435 test: 0.782780
max validation accuracy : 0.801126 max acc epoch : 31 test accuracy : 0.787001

Epoch :  36 loss training:  33.968972992151976 Time :  1116
accuracy train: 0.967395 val: 0.803002 test: 0.781654
max validation accuracy : 0.803002 max acc epoch : 36 test accuracy : 0.781654

Epoch :  37 loss training:  31.749032825231552 Time :  1126
accuracy train: 0.972857 val: 0.800188 test: 0.778841
max validation accuracy : 0.803002 max acc epoch : 36 test accuracy : 0.781654

Epoch :  38 loss training:  30.23073099926114 Time :  1136
accuracy train: 0.976498 val: 0.800188 test: 0.775464
max validation accuracy : 0.803002 max acc epoch : 36 test accuracy : 0.781654

Epoch :  39 loss training:  28.627539291977882 Time :  1148
accuracy train: 0.981298 val: 0.786116 test: 0.776027
max validation accuracy : 0.803002 max acc epoch : 36 test accuracy : 0.781654

Epoch :  40 loss training:  28.728048734366894 Time :  1158
accuracy train: 0.982456 val: 0.797373 test: 0.778559
max validation accuracy : 0.803002 max acc epoch : 36 test accuracy : 0.781654

Epoch :  41 loss training:  27.343434631824493 Time :  1168
accuracy train: 0.983615 val: 0.797373 test: 0.776871
max validation accuracy : 0.803002 max acc epoch : 36 test accuracy : 0.781654

Epoch :  42 loss training:  26.642036352306604 Time :  1179
accuracy train: 0.985270 val: 0.801126 test: 0.773495
max validation accuracy : 0.803002 max acc epoch : 36 test accuracy : 0.781654

Epoch :  43 loss training:  26.334718020632863 Time :  1189
accuracy train: 0.987090 val: 0.797373 test: 0.778278
max validation accuracy : 0.803002 max acc epoch : 36 test accuracy : 0.781654

Epoch :  44 loss training:  24.54743496887386 Time :  1200
accuracy train: 0.989407 val: 0.799250 test: 0.773495
max validation accuracy : 0.803002 max acc epoch : 36 test accuracy : 0.781654

Epoch :  45 loss training:  22.307100620120764 Time :  1210
accuracy train: 0.990566 val: 0.788931 test: 0.774339
max validation accuracy : 0.803002 max acc epoch : 36 test accuracy : 0.781654

Epoch :  46 loss training:  22.50765044055879 Time :  1220
accuracy train: 0.990401 val: 0.792683 test: 0.769837
max validation accuracy : 0.803002 max acc epoch : 36 test accuracy : 0.781654

Epoch :  47 loss training:  21.617429237812757 Time :  1230
accuracy train: 0.990732 val: 0.807692 test: 0.774339
max validation accuracy : 0.807692 max acc epoch : 47 test accuracy : 0.774339

Epoch :  48 loss training:  21.272238988429308 Time :  1240
accuracy train: 0.993545 val: 0.792683 test: 0.768993
max validation accuracy : 0.807692 max acc epoch : 47 test accuracy : 0.774339

Epoch :  49 loss training:  21.23951613716781 Time :  1249
accuracy train: 0.993711 val: 0.790807 test: 0.770400
max validation accuracy : 0.807692 max acc epoch : 47 test accuracy : 0.774339

Epoch :  50 loss training:  20.535486310720444 Time :  1261
accuracy train: 0.994373 val: 0.791745 test: 0.771244
max validation accuracy : 0.807692 max acc epoch : 47 test accuracy : 0.774339

Epoch :  51 loss training:  20.118562838062644 Time :  1271
accuracy train: 0.994704 val: 0.789869 test: 0.770118
max validation accuracy : 0.807692 max acc epoch : 47 test accuracy : 0.774339

Epoch :  52 loss training:  19.502695560455322 Time :  1281
accuracy train: 0.995862 val: 0.800188 test: 0.767023
max validation accuracy : 0.807692 max acc epoch : 47 test accuracy : 0.774339

Epoch :  53 loss training:  17.893347044009715 Time :  1291
accuracy train: 0.996028 val: 0.797373 test: 0.769274
max validation accuracy : 0.807692 max acc epoch : 47 test accuracy : 0.774339

Epoch :  54 loss training:  16.72582440637052 Time :  1302
accuracy train: 0.996028 val: 0.798311 test: 0.771244
max validation accuracy : 0.807692 max acc epoch : 47 test accuracy : 0.774339

Epoch :  55 loss training:  16.993868499994278 Time :  1311
accuracy train: 0.996690 val: 0.792683 test: 0.768993
max validation accuracy : 0.807692 max acc epoch : 47 test accuracy : 0.774339

Epoch :  56 loss training:  15.870283629745245 Time :  1322
accuracy train: 0.997186 val: 0.791745 test: 0.767867
max validation accuracy : 0.807692 max acc epoch : 47 test accuracy : 0.774339

Epoch :  57 loss training:  14.922707405872643 Time :  1332
accuracy train: 0.997186 val: 0.791745 test: 0.768993
max validation accuracy : 0.807692 max acc epoch : 47 test accuracy : 0.774339

Epoch :  58 loss training:  15.610632521100342 Time :  1342
accuracy train: 0.997517 val: 0.790807 test: 0.771244
max validation accuracy : 0.807692 max acc epoch : 47 test accuracy : 0.774339

========================================================================================================================================================================================================
best acc epoch :  47
validation accuracy :  0.8076923076923077
test accuracy :  0.7743387732132808
last test_accuracy :  0.7712436691052336
second best val :  0.8030018761726079
second best test :  0.7816544738323016
max gap 11
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=638, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  94.6704743206501 Time :  1352
accuracy train: 0.773585 val: 0.745779 test: 0.762802
max validation accuracy : 0.745779 max acc epoch : 1 test accuracy : 0.762802
Epoch-1 lr: 0.001

Epoch :  2 loss training:  89.77068600058556 Time :  1361
accuracy train: 0.782357 val: 0.764540 test: 0.769837
max validation accuracy : 0.764540 max acc epoch : 2 test accuracy : 0.769837
Epoch-2 lr: 0.001

Epoch :  3 loss training:  83.34445966780186 Time :  1372
accuracy train: 0.785667 val: 0.757974 test: 0.772369
max validation accuracy : 0.764540 max acc epoch : 2 test accuracy : 0.769837
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.54931119084358 Time :  1382
accuracy train: 0.793115 val: 0.744841 test: 0.763365
max validation accuracy : 0.764540 max acc epoch : 2 test accuracy : 0.769837
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  79.62546473741531 Time :  1393
accuracy train: 0.796260 val: 0.764540 test: 0.768149
max validation accuracy : 0.764540 max acc epoch : 2 test accuracy : 0.769837
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.1592723429203 Time :  1403
accuracy train: 0.803045 val: 0.752345 test: 0.769837
max validation accuracy : 0.764540 max acc epoch : 2 test accuracy : 0.769837
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  78.37294036149979 Time :  1413
accuracy train: 0.806852 val: 0.768293 test: 0.774057
max validation accuracy : 0.768293 max acc epoch : 7 test accuracy : 0.774057
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  77.49674698710442 Time :  1423
accuracy train: 0.811983 val: 0.766417 test: 0.779966
max validation accuracy : 0.768293 max acc epoch : 7 test accuracy : 0.774057
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  78.13654235005379 Time :  1433
accuracy train: 0.811486 val: 0.763602 test: 0.777434
max validation accuracy : 0.768293 max acc epoch : 7 test accuracy : 0.774057
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  77.78336235880852 Time :  1439
accuracy train: 0.813803 val: 0.773921 test: 0.775746
max validation accuracy : 0.773921 max acc epoch : 10 test accuracy : 0.775746

Epoch :  11 loss training:  75.62626475095749 Time :  1447
accuracy train: 0.823899 val: 0.770169 test: 0.781092
max validation accuracy : 0.773921 max acc epoch : 10 test accuracy : 0.775746

Epoch :  12 loss training:  74.35262683033943 Time :  1457
accuracy train: 0.825223 val: 0.771107 test: 0.781936
max validation accuracy : 0.773921 max acc epoch : 10 test accuracy : 0.775746

Epoch :  13 loss training:  72.32383827865124 Time :  1467
accuracy train: 0.835485 val: 0.783302 test: 0.786156
max validation accuracy : 0.783302 max acc epoch : 13 test accuracy : 0.786156

Epoch :  14 loss training:  70.65790905058384 Time :  1478
accuracy train: 0.840285 val: 0.781426 test: 0.788689
max validation accuracy : 0.783302 max acc epoch : 13 test accuracy : 0.786156

Epoch :  15 loss training:  67.5578940808773 Time :  1488
accuracy train: 0.849719 val: 0.785178 test: 0.787001
max validation accuracy : 0.785178 max acc epoch : 15 test accuracy : 0.787001

Epoch :  16 loss training:  67.22002790868282 Time :  1499
accuracy train: 0.854849 val: 0.784240 test: 0.785031
max validation accuracy : 0.785178 max acc epoch : 15 test accuracy : 0.787001

Epoch :  17 loss training:  64.29034052789211 Time :  1509
accuracy train: 0.870076 val: 0.787992 test: 0.787001
max validation accuracy : 0.787992 max acc epoch : 17 test accuracy : 0.787001

Epoch :  18 loss training:  62.43835490942001 Time :  1519
accuracy train: 0.874379 val: 0.783302 test: 0.787845
max validation accuracy : 0.787992 max acc epoch : 17 test accuracy : 0.787001

Epoch :  19 loss training:  61.095703199505806 Time :  1530
accuracy train: 0.881165 val: 0.785178 test: 0.787001
max validation accuracy : 0.787992 max acc epoch : 17 test accuracy : 0.787001

Epoch :  20 loss training:  59.47549632191658 Time :  1540
accuracy train: 0.889110 val: 0.783302 test: 0.783343
max validation accuracy : 0.787992 max acc epoch : 17 test accuracy : 0.787001

Epoch :  21 loss training:  57.479880437254906 Time :  1551
accuracy train: 0.890103 val: 0.789869 test: 0.786156
max validation accuracy : 0.789869 max acc epoch : 21 test accuracy : 0.786156

Epoch :  22 loss training:  55.481737956404686 Time :  1562
accuracy train: 0.902019 val: 0.790807 test: 0.787845
max validation accuracy : 0.790807 max acc epoch : 22 test accuracy : 0.787845

Epoch :  23 loss training:  53.5089168548584 Time :  1571
accuracy train: 0.911122 val: 0.792683 test: 0.791784
max validation accuracy : 0.792683 max acc epoch : 23 test accuracy : 0.791784

Epoch :  24 loss training:  51.19248542189598 Time :  1582
accuracy train: 0.916915 val: 0.798311 test: 0.788126
max validation accuracy : 0.798311 max acc epoch : 24 test accuracy : 0.788126

Epoch :  25 loss training:  50.39861590415239 Time :  1592
accuracy train: 0.923039 val: 0.801126 test: 0.787845
max validation accuracy : 0.801126 max acc epoch : 25 test accuracy : 0.787845

Epoch :  26 loss training:  47.97717960178852 Time :  1602
accuracy train: 0.930652 val: 0.804878 test: 0.782780
max validation accuracy : 0.804878 max acc epoch : 26 test accuracy : 0.782780

Epoch :  27 loss training:  45.34787230938673 Time :  1612
accuracy train: 0.936610 val: 0.805816 test: 0.783905
max validation accuracy : 0.805816 max acc epoch : 27 test accuracy : 0.783905

Epoch :  28 loss training:  43.72880806773901 Time :  1621
accuracy train: 0.940583 val: 0.802064 test: 0.782499
max validation accuracy : 0.805816 max acc epoch : 27 test accuracy : 0.783905

Epoch :  29 loss training:  45.20837262272835 Time :  1631
accuracy train: 0.941079 val: 0.802064 test: 0.783343
max validation accuracy : 0.805816 max acc epoch : 27 test accuracy : 0.783905

Epoch :  30 loss training:  40.40037298202515 Time :  1642
accuracy train: 0.950348 val: 0.798311 test: 0.778278
max validation accuracy : 0.805816 max acc epoch : 27 test accuracy : 0.783905

Epoch :  31 loss training:  41.0356028303504 Time :  1651
accuracy train: 0.952996 val: 0.804878 test: 0.778559
max validation accuracy : 0.805816 max acc epoch : 27 test accuracy : 0.783905

Epoch :  32 loss training:  38.32801592722535 Time :  1661
accuracy train: 0.953492 val: 0.798311 test: 0.782499
max validation accuracy : 0.805816 max acc epoch : 27 test accuracy : 0.783905

Epoch :  33 loss training:  37.33707317709923 Time :  1671
accuracy train: 0.963092 val: 0.797373 test: 0.779403
max validation accuracy : 0.805816 max acc epoch : 27 test accuracy : 0.783905

Epoch :  34 loss training:  34.96570371463895 Time :  1681
accuracy train: 0.963754 val: 0.800188 test: 0.778559
max validation accuracy : 0.805816 max acc epoch : 27 test accuracy : 0.783905

Epoch :  35 loss training:  34.70740585029125 Time :  1691
accuracy train: 0.970374 val: 0.793621 test: 0.774902
max validation accuracy : 0.805816 max acc epoch : 27 test accuracy : 0.783905

Epoch :  36 loss training:  31.79567565023899 Time :  1701
accuracy train: 0.972857 val: 0.801126 test: 0.775464
max validation accuracy : 0.805816 max acc epoch : 27 test accuracy : 0.783905

Epoch :  37 loss training:  31.671275675296783 Time :  1710
accuracy train: 0.968719 val: 0.795497 test: 0.777434
max validation accuracy : 0.805816 max acc epoch : 27 test accuracy : 0.783905

Epoch :  38 loss training:  30.94929677248001 Time :  1720
accuracy train: 0.978484 val: 0.798311 test: 0.773495
max validation accuracy : 0.805816 max acc epoch : 27 test accuracy : 0.783905

========================================================================================================================================================================================================
best acc epoch :  27
validation accuracy :  0.8058161350844277
test accuracy :  0.7839054586381542
last test_accuracy :  0.7734946539110861
second best val :  0.8048780487804879
second best test :  0.7827799662352279
max gap 5
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  28 	 val_accuracy : 0.78518 	 test_accuracy : 0.78306 	 last test_accuracy : 0.78165 	 second best val : 0.78330 	 second best test : 0.78025
k :  1 	 best_acc epoch :  26 	 val_accuracy : 0.77392 	 test_accuracy : 0.79122 	 last test_accuracy : 0.78672 	 second best val : 0.77298 	 second best test : 0.79122
k :  2 	 best_acc epoch :  47 	 val_accuracy : 0.80769 	 test_accuracy : 0.77434 	 last test_accuracy : 0.77124 	 second best val : 0.80300 	 second best test : 0.78165
k :  3 	 best_acc epoch :  27 	 val_accuracy : 0.80582 	 test_accuracy : 0.78391 	 last test_accuracy : 0.77349 	 second best val : 0.80488 	 second best test : 0.78278

avg :  	 val_accuracy : 0.79315 	 test_accuracy : 0.78313 	 last_accuracy : 0.77828 	 second best val : 0.79104 	 second best test : 0.78398

std :  	 val_accuracy : 0.01419 	 test_accuracy : 0.00599 	 last_accuracy : 0.00623 	 second best val : 0.01342 	 second best test : 0.00428


date and time :  Sat Jul  3 01:06:33 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=714, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({0: 6237, 1: 4425})

Epoch :  1 loss training:  97.47776886820793 Time :  14
accuracy train: 0.776730 val: 0.757036 test: 0.764772
max validation accuracy : 0.757036 max acc epoch : 1 test accuracy : 0.764772
Counter({0: 5501, 1: 5161})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  86.8100388944149 Time :  27
accuracy train: 0.774743 val: 0.752345 test: 0.768430
max validation accuracy : 0.757036 max acc epoch : 1 test accuracy : 0.764772
Counter({0: 5486, 1: 5176})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  83.21968829631805 Time :  40
accuracy train: 0.677756 val: 0.647280 test: 0.659257
max validation accuracy : 0.757036 max acc epoch : 1 test accuracy : 0.764772
Counter({1: 5740, 0: 4922})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.00869426131248 Time :  57
accuracy train: 0.792287 val: 0.764540 test: 0.776308
max validation accuracy : 0.764540 max acc epoch : 4 test accuracy : 0.776308
Counter({0: 5639, 1: 5023})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.29000854492188 Time :  70
accuracy train: 0.798577 val: 0.775797 test: 0.778559
max validation accuracy : 0.775797 max acc epoch : 5 test accuracy : 0.778559
Counter({1: 5734, 0: 4928})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.0847841501236 Time :  85
accuracy train: 0.799901 val: 0.768293 test: 0.775464
max validation accuracy : 0.775797 max acc epoch : 5 test accuracy : 0.778559
Counter({1: 5807, 0: 4855})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.54610186815262 Time :  97
accuracy train: 0.807680 val: 0.776735 test: 0.776871
max validation accuracy : 0.776735 max acc epoch : 7 test accuracy : 0.776871
Counter({0: 5718, 1: 4944})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.00983163714409 Time :  113
accuracy train: 0.802218 val: 0.774859 test: 0.776590
max validation accuracy : 0.776735 max acc epoch : 7 test accuracy : 0.776871
Counter({1: 5691, 0: 4971})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.37538573145866 Time :  127
accuracy train: 0.809831 val: 0.778612 test: 0.782499
max validation accuracy : 0.778612 max acc epoch : 9 test accuracy : 0.782499
Counter({0: 5718, 1: 4944})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  73.97890169918537 Time :  139
accuracy train: 0.810990 val: 0.770169 test: 0.779966
max validation accuracy : 0.778612 max acc epoch : 9 test accuracy : 0.782499
Counter({1: 5734, 0: 4928})

Epoch :  11 loss training:  75.37725795805454 Time :  153
accuracy train: 0.819100 val: 0.768293 test: 0.778841
max validation accuracy : 0.778612 max acc epoch : 9 test accuracy : 0.782499
Counter({1: 5756, 0: 4906})

Epoch :  12 loss training:  73.58228731155396 Time :  169
accuracy train: 0.822741 val: 0.759850 test: 0.774620
max validation accuracy : 0.778612 max acc epoch : 9 test accuracy : 0.782499
Counter({0: 5777, 1: 4885})

Epoch :  13 loss training:  71.73012591898441 Time :  182
accuracy train: 0.827375 val: 0.763602 test: 0.781092
max validation accuracy : 0.778612 max acc epoch : 9 test accuracy : 0.782499
Counter({1: 5759, 0: 4903})

Epoch :  14 loss training:  69.22452917695045 Time :  196
accuracy train: 0.838795 val: 0.775797 test: 0.785031
max validation accuracy : 0.778612 max acc epoch : 9 test accuracy : 0.782499
Counter({0: 5814, 1: 4848})

Epoch :  15 loss training:  68.31752046942711 Time :  209
accuracy train: 0.846739 val: 0.770169 test: 0.785594
max validation accuracy : 0.778612 max acc epoch : 9 test accuracy : 0.782499
Counter({0: 5822, 1: 4840})

Epoch :  16 loss training:  65.95755955576897 Time :  225
accuracy train: 0.853691 val: 0.772983 test: 0.787845
max validation accuracy : 0.778612 max acc epoch : 9 test accuracy : 0.782499
Counter({0: 5833, 1: 4829})

Epoch :  17 loss training:  64.2436735779047 Time :  238
accuracy train: 0.865607 val: 0.772983 test: 0.791503
max validation accuracy : 0.778612 max acc epoch : 9 test accuracy : 0.782499
Counter({0: 5840, 1: 4822})

Epoch :  18 loss training:  61.88951326906681 Time :  252
accuracy train: 0.871731 val: 0.782364 test: 0.788126
max validation accuracy : 0.782364 max acc epoch : 18 test accuracy : 0.788126
Counter({0: 5913, 1: 4749})

Epoch :  19 loss training:  60.86913751065731 Time :  266
accuracy train: 0.880172 val: 0.779550 test: 0.787282
max validation accuracy : 0.782364 max acc epoch : 18 test accuracy : 0.788126
Counter({1: 5949, 0: 4713})

Epoch :  20 loss training:  59.62428618967533 Time :  279
accuracy train: 0.882655 val: 0.780488 test: 0.783343
max validation accuracy : 0.782364 max acc epoch : 18 test accuracy : 0.788126
Counter({0: 5979, 1: 4683})

Epoch :  21 loss training:  57.88345351815224 Time :  296
accuracy train: 0.892585 val: 0.783302 test: 0.788126
max validation accuracy : 0.783302 max acc epoch : 21 test accuracy : 0.788126
Counter({1: 5971, 0: 4691})

Epoch :  22 loss training:  56.058581084012985 Time :  310
accuracy train: 0.902185 val: 0.783302 test: 0.788407
max validation accuracy : 0.783302 max acc epoch : 21 test accuracy : 0.788126
Counter({1: 5997, 0: 4665})

Epoch :  23 loss training:  51.475038573145866 Time :  324
accuracy train: 0.906488 val: 0.780488 test: 0.792065
max validation accuracy : 0.783302 max acc epoch : 21 test accuracy : 0.788126
Counter({0: 5974, 1: 4688})

Epoch :  24 loss training:  51.4755575209856 Time :  336
accuracy train: 0.916584 val: 0.778612 test: 0.787001
max validation accuracy : 0.783302 max acc epoch : 21 test accuracy : 0.788126
Counter({1: 5969, 0: 4693})

Epoch :  25 loss training:  49.4789135158062 Time :  353
accuracy train: 0.923370 val: 0.778612 test: 0.784468
max validation accuracy : 0.783302 max acc epoch : 21 test accuracy : 0.788126
Counter({0: 6019, 1: 4643})

Epoch :  26 loss training:  46.58407411724329 Time :  367
accuracy train: 0.929990 val: 0.775797 test: 0.786438
max validation accuracy : 0.783302 max acc epoch : 21 test accuracy : 0.788126
Counter({1: 5980, 0: 4682})

Epoch :  27 loss training:  45.89287857711315 Time :  381
accuracy train: 0.933962 val: 0.782364 test: 0.779966
max validation accuracy : 0.783302 max acc epoch : 21 test accuracy : 0.788126
Counter({0: 6041, 1: 4621})

Epoch :  28 loss training:  43.846199467778206 Time :  394
accuracy train: 0.941576 val: 0.780488 test: 0.781654
max validation accuracy : 0.783302 max acc epoch : 21 test accuracy : 0.788126
Counter({1: 6038, 0: 4624})

Epoch :  29 loss training:  45.045725390315056 Time :  409
accuracy train: 0.944224 val: 0.772983 test: 0.786156
max validation accuracy : 0.783302 max acc epoch : 21 test accuracy : 0.788126
Counter({0: 6019, 1: 4643})

Epoch :  30 loss training:  40.63946584612131 Time :  427
accuracy train: 0.947865 val: 0.774859 test: 0.789814
max validation accuracy : 0.783302 max acc epoch : 21 test accuracy : 0.788126
Counter({1: 6018, 0: 4644})

Epoch :  31 loss training:  38.290578961372375 Time :  442
accuracy train: 0.956968 val: 0.773921 test: 0.777715
max validation accuracy : 0.783302 max acc epoch : 21 test accuracy : 0.788126
Counter({0: 5987, 1: 4675})

Epoch :  32 loss training:  38.495198003947735 Time :  456
accuracy train: 0.957795 val: 0.773921 test: 0.779685
max validation accuracy : 0.783302 max acc epoch : 21 test accuracy : 0.788126
Counter({1: 6007, 0: 4655})

========================================================================================================================================================================================================
best acc epoch :  21
validation accuracy :  0.7833020637898687
test accuracy :  0.7881260551491277
last test_accuracy :  0.7796848621271807
second best val :  0.7823639774859287
second best test :  0.7881260551491277
max gap 9
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=451, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 6226, 0: 4436})

Epoch :  1 loss training:  96.42176088690758 Time :  472
accuracy train: 0.753889 val: 0.758912 test: 0.747046
max validation accuracy : 0.758912 max acc epoch : 1 test accuracy : 0.747046
Counter({0: 5654, 1: 5008})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  88.89512896537781 Time :  485
accuracy train: 0.775902 val: 0.781426 test: 0.770681
max validation accuracy : 0.781426 max acc epoch : 2 test accuracy : 0.770681
Counter({0: 6004, 1: 4658})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  86.84245926141739 Time :  497
accuracy train: 0.796260 val: 0.792683 test: 0.774902
max validation accuracy : 0.792683 max acc epoch : 3 test accuracy : 0.774902
Counter({0: 6313, 1: 4349})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  82.2546719610691 Time :  510
accuracy train: 0.777392 val: 0.771107 test: 0.763084
max validation accuracy : 0.792683 max acc epoch : 3 test accuracy : 0.774902
Counter({1: 6242, 0: 4420})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  79.88288959860802 Time :  523
accuracy train: 0.800232 val: 0.792683 test: 0.777153
max validation accuracy : 0.792683 max acc epoch : 3 test accuracy : 0.774902
Counter({0: 6390, 1: 4272})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.92746657133102 Time :  536
accuracy train: 0.795432 val: 0.787992 test: 0.771806
max validation accuracy : 0.792683 max acc epoch : 3 test accuracy : 0.774902
Counter({1: 6574, 0: 4088})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.37833338975906 Time :  549
accuracy train: 0.800563 val: 0.794559 test: 0.774057
max validation accuracy : 0.794559 max acc epoch : 7 test accuracy : 0.774057
Counter({0: 6518, 1: 4144})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.7507334947586 Time :  561
accuracy train: 0.796425 val: 0.787054 test: 0.770118
max validation accuracy : 0.794559 max acc epoch : 7 test accuracy : 0.774057
Counter({1: 6580, 0: 4082})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  77.06376677751541 Time :  574
accuracy train: 0.800563 val: 0.785178 test: 0.769837
max validation accuracy : 0.794559 max acc epoch : 7 test accuracy : 0.774057
Counter({0: 6641, 1: 4021})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.78228706121445 Time :  586
accuracy train: 0.810493 val: 0.791745 test: 0.776308
max validation accuracy : 0.794559 max acc epoch : 7 test accuracy : 0.774057
Counter({1: 6597, 0: 4065})

Epoch :  11 loss training:  73.93309217691422 Time :  598
accuracy train: 0.811983 val: 0.786116 test: 0.779685
max validation accuracy : 0.794559 max acc epoch : 7 test accuracy : 0.774057
Counter({0: 6558, 1: 4104})

Epoch :  12 loss training:  73.40479162335396 Time :  610
accuracy train: 0.819596 val: 0.785178 test: 0.774339
max validation accuracy : 0.794559 max acc epoch : 7 test accuracy : 0.774057
Counter({1: 6585, 0: 4077})

Epoch :  13 loss training:  71.487877368927 Time :  623
accuracy train: 0.828037 val: 0.787992 test: 0.781373
max validation accuracy : 0.794559 max acc epoch : 7 test accuracy : 0.774057
Counter({0: 6545, 1: 4117})

Epoch :  14 loss training:  71.10898378491402 Time :  636
accuracy train: 0.829361 val: 0.782364 test: 0.776027
max validation accuracy : 0.794559 max acc epoch : 7 test accuracy : 0.774057
Counter({1: 6512, 0: 4150})

Epoch :  15 loss training:  67.29870711266994 Time :  649
accuracy train: 0.834161 val: 0.787054 test: 0.779966
max validation accuracy : 0.794559 max acc epoch : 7 test accuracy : 0.774057
Counter({1: 6502, 0: 4160})

Epoch :  16 loss training:  66.183000177145 Time :  661
accuracy train: 0.849057 val: 0.790807 test: 0.782217
max validation accuracy : 0.794559 max acc epoch : 7 test accuracy : 0.774057
Counter({0: 6506, 1: 4156})

Epoch :  17 loss training:  64.77470496296883 Time :  674
accuracy train: 0.857498 val: 0.789869 test: 0.779685
max validation accuracy : 0.794559 max acc epoch : 7 test accuracy : 0.774057
Counter({0: 6527, 1: 4135})

Epoch :  18 loss training:  61.84855657815933 Time :  686
accuracy train: 0.858325 val: 0.793621 test: 0.777997
max validation accuracy : 0.794559 max acc epoch : 7 test accuracy : 0.774057
Counter({0: 6562, 1: 4100})

========================================================================================================================================================================================================
best acc epoch :  7
validation accuracy :  0.7945590994371482
test accuracy :  0.7740574001125492
last test_accuracy :  0.7779966235227912
second best val :  0.7936210131332082
second best test :  0.7740574001125492
max gap 4
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=734, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 6184, 0: 4478})

Epoch :  1 loss training:  97.22319248318672 Time :  702
accuracy train: 0.769282 val: 0.756098 test: 0.762802
max validation accuracy : 0.756098 max acc epoch : 1 test accuracy : 0.762802
Counter({0: 5748, 1: 4914})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  88.01134321093559 Time :  714
accuracy train: 0.757034 val: 0.740150 test: 0.749859
max validation accuracy : 0.756098 max acc epoch : 1 test accuracy : 0.762802
Counter({0: 5417, 1: 5245})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  86.19735953211784 Time :  728
accuracy train: 0.770771 val: 0.739212 test: 0.754643
max validation accuracy : 0.756098 max acc epoch : 1 test accuracy : 0.762802
Counter({1: 5773, 0: 4889})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  83.30346471071243 Time :  741
accuracy train: 0.790798 val: 0.778612 test: 0.769274
max validation accuracy : 0.778612 max acc epoch : 4 test accuracy : 0.769274
Counter({0: 5472, 1: 5190})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  81.30088396370411 Time :  753
accuracy train: 0.787157 val: 0.770169 test: 0.761958
max validation accuracy : 0.778612 max acc epoch : 4 test accuracy : 0.769274
Counter({0: 5753, 1: 4909})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.03255045413971 Time :  765
accuracy train: 0.804038 val: 0.784240 test: 0.772932
max validation accuracy : 0.784240 max acc epoch : 6 test accuracy : 0.772932
Counter({1: 5897, 0: 4765})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  78.19992989301682 Time :  777
accuracy train: 0.803873 val: 0.780488 test: 0.772651
max validation accuracy : 0.784240 max acc epoch : 6 test accuracy : 0.772932
Counter({1: 5863, 0: 4799})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  77.93013775348663 Time :  789
accuracy train: 0.801721 val: 0.772045 test: 0.767586
max validation accuracy : 0.784240 max acc epoch : 6 test accuracy : 0.772932
Counter({1: 5879, 0: 4783})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.54267299175262 Time :  802
accuracy train: 0.803045 val: 0.781426 test: 0.774620
max validation accuracy : 0.784240 max acc epoch : 6 test accuracy : 0.772932
Counter({0: 6062, 1: 4600})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  77.03506141901016 Time :  814
accuracy train: 0.806190 val: 0.770169 test: 0.776027
max validation accuracy : 0.784240 max acc epoch : 6 test accuracy : 0.772932
Counter({0: 6299, 1: 4363})

Epoch :  11 loss training:  74.91377437114716 Time :  826
accuracy train: 0.809169 val: 0.773921 test: 0.773495
max validation accuracy : 0.784240 max acc epoch : 6 test accuracy : 0.772932
Counter({0: 6076, 1: 4586})

Epoch :  12 loss training:  73.15720111131668 Time :  838
accuracy train: 0.815127 val: 0.767355 test: 0.774339
max validation accuracy : 0.784240 max acc epoch : 6 test accuracy : 0.772932
Counter({0: 6375, 1: 4287})

Epoch :  13 loss training:  71.42366108298302 Time :  851
accuracy train: 0.825720 val: 0.787054 test: 0.783343
max validation accuracy : 0.787054 max acc epoch : 13 test accuracy : 0.783343
Counter({0: 6425, 1: 4237})

Epoch :  14 loss training:  69.73793677985668 Time :  864
accuracy train: 0.829030 val: 0.781426 test: 0.779403
max validation accuracy : 0.787054 max acc epoch : 13 test accuracy : 0.783343
Counter({1: 6326, 0: 4336})

Epoch :  15 loss training:  68.36189422011375 Time :  877
accuracy train: 0.837637 val: 0.771107 test: 0.777715
max validation accuracy : 0.787054 max acc epoch : 13 test accuracy : 0.783343
Counter({0: 6348, 1: 4314})

Epoch :  16 loss training:  67.79164353013039 Time :  891
accuracy train: 0.844422 val: 0.778612 test: 0.775183
max validation accuracy : 0.787054 max acc epoch : 13 test accuracy : 0.783343
Counter({0: 6343, 1: 4319})

Epoch :  17 loss training:  64.1067496240139 Time :  903
accuracy train: 0.860973 val: 0.796435 test: 0.785312
max validation accuracy : 0.796435 max acc epoch : 17 test accuracy : 0.785312
Counter({1: 6246, 0: 4416})

Epoch :  18 loss training:  63.37917838990688 Time :  916
accuracy train: 0.867594 val: 0.796435 test: 0.780529
max validation accuracy : 0.796435 max acc epoch : 17 test accuracy : 0.785312
Counter({1: 6407, 0: 4255})

Epoch :  19 loss training:  60.8770667463541 Time :  928
accuracy train: 0.876034 val: 0.781426 test: 0.778841
max validation accuracy : 0.796435 max acc epoch : 17 test accuracy : 0.785312
Counter({0: 6436, 1: 4226})

Epoch :  20 loss training:  59.46877467632294 Time :  941
accuracy train: 0.886461 val: 0.793621 test: 0.784750
max validation accuracy : 0.796435 max acc epoch : 17 test accuracy : 0.785312
Counter({1: 6533, 0: 4129})

Epoch :  21 loss training:  57.314589753746986 Time :  954
accuracy train: 0.891592 val: 0.789869 test: 0.785312
max validation accuracy : 0.796435 max acc epoch : 17 test accuracy : 0.785312
Counter({0: 6369, 1: 4293})

Epoch :  22 loss training:  53.73099075257778 Time :  967
accuracy train: 0.895895 val: 0.780488 test: 0.776871
max validation accuracy : 0.796435 max acc epoch : 17 test accuracy : 0.785312
Counter({1: 6417, 0: 4245})

Epoch :  23 loss training:  53.38560815900564 Time :  980
accuracy train: 0.907481 val: 0.787992 test: 0.779685
max validation accuracy : 0.796435 max acc epoch : 17 test accuracy : 0.785312
Counter({0: 6390, 1: 4272})

Epoch :  24 loss training:  50.94363962113857 Time :  992
accuracy train: 0.910626 val: 0.782364 test: 0.782499
max validation accuracy : 0.796435 max acc epoch : 17 test accuracy : 0.785312
Counter({0: 6345, 1: 4317})

Epoch :  25 loss training:  50.44461107254028 Time :  1005
accuracy train: 0.916915 val: 0.782364 test: 0.782780
max validation accuracy : 0.796435 max acc epoch : 17 test accuracy : 0.785312
Counter({0: 6218, 1: 4444})

Epoch :  26 loss training:  47.70651903748512 Time :  1018
accuracy train: 0.918073 val: 0.781426 test: 0.779403
max validation accuracy : 0.796435 max acc epoch : 17 test accuracy : 0.785312
Counter({1: 6269, 0: 4393})

Epoch :  27 loss training:  46.04661475121975 Time :  1032
accuracy train: 0.924694 val: 0.778612 test: 0.780529
max validation accuracy : 0.796435 max acc epoch : 17 test accuracy : 0.785312
Counter({0: 6475, 1: 4187})

Epoch :  28 loss training:  43.992659106850624 Time :  1044
accuracy train: 0.940748 val: 0.799250 test: 0.781373
max validation accuracy : 0.799250 max acc epoch : 28 test accuracy : 0.781373
Counter({1: 6551, 0: 4111})

Epoch :  29 loss training:  42.706429056823254 Time :  1058
accuracy train: 0.936114 val: 0.797373 test: 0.783905
max validation accuracy : 0.799250 max acc epoch : 28 test accuracy : 0.781373
Counter({0: 6504, 1: 4158})

Epoch :  30 loss training:  40.177283085882664 Time :  1072
accuracy train: 0.941576 val: 0.785178 test: 0.782499
max validation accuracy : 0.799250 max acc epoch : 28 test accuracy : 0.781373
Counter({1: 6596, 0: 4066})

Epoch :  31 loss training:  37.051786445081234 Time :  1085
accuracy train: 0.952665 val: 0.789869 test: 0.783343
max validation accuracy : 0.799250 max acc epoch : 28 test accuracy : 0.781373
Counter({1: 6709, 0: 3953})

Epoch :  32 loss training:  37.25628912448883 Time :  1097
accuracy train: 0.957464 val: 0.791745 test: 0.777153
max validation accuracy : 0.799250 max acc epoch : 28 test accuracy : 0.781373
Counter({0: 6711, 1: 3951})

Epoch :  33 loss training:  36.16190952807665 Time :  1110
accuracy train: 0.954982 val: 0.780488 test: 0.776027
max validation accuracy : 0.799250 max acc epoch : 28 test accuracy : 0.781373
Counter({1: 6796, 0: 3866})

Epoch :  34 loss training:  33.96133465319872 Time :  1123
accuracy train: 0.964912 val: 0.787992 test: 0.779966
max validation accuracy : 0.799250 max acc epoch : 28 test accuracy : 0.781373
Counter({0: 6809, 1: 3853})

Epoch :  35 loss training:  34.725713953375816 Time :  1135
accuracy train: 0.966733 val: 0.782364 test: 0.777434
max validation accuracy : 0.799250 max acc epoch : 28 test accuracy : 0.781373
Counter({0: 6878, 1: 3784})

Epoch :  36 loss training:  30.987720988690853 Time :  1148
accuracy train: 0.973353 val: 0.787054 test: 0.779685
max validation accuracy : 0.799250 max acc epoch : 28 test accuracy : 0.781373
Counter({0: 6859, 1: 3803})

Epoch :  37 loss training:  29.565389323979616 Time :  1162
accuracy train: 0.972526 val: 0.788931 test: 0.778559
max validation accuracy : 0.799250 max acc epoch : 28 test accuracy : 0.781373
Counter({0: 6857, 1: 3805})

Epoch :  38 loss training:  28.63445157930255 Time :  1174
accuracy train: 0.976663 val: 0.786116 test: 0.775183
max validation accuracy : 0.799250 max acc epoch : 28 test accuracy : 0.781373
Counter({1: 6898, 0: 3764})

Epoch :  39 loss training:  26.98453478142619 Time :  1187
accuracy train: 0.975505 val: 0.784240 test: 0.779403
max validation accuracy : 0.799250 max acc epoch : 28 test accuracy : 0.781373
Counter({0: 6870, 1: 3792})

========================================================================================================================================================================================================
best acc epoch :  28
validation accuracy :  0.799249530956848
test accuracy :  0.7813731007315701
last test_accuracy :  0.7794034890264491
second best val :  0.797373358348968
second best test :  0.7813731007315701
max gap 11
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=236, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({0: 6234, 1: 4428})

Epoch :  1 loss training:  96.1625834107399 Time :  1201
accuracy train: 0.769778 val: 0.739212 test: 0.768711
max validation accuracy : 0.739212 max acc epoch : 1 test accuracy : 0.768711
Counter({1: 5448, 0: 5214})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.81909319758415 Time :  1214
accuracy train: 0.777226 val: 0.752345 test: 0.768149
max validation accuracy : 0.752345 max acc epoch : 2 test accuracy : 0.768149
Counter({0: 5756, 1: 4906})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  86.0401930809021 Time :  1227
accuracy train: 0.787488 val: 0.748593 test: 0.780529
max validation accuracy : 0.752345 max acc epoch : 2 test accuracy : 0.768149
Counter({1: 5738, 0: 4924})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.33420741558075 Time :  1240
accuracy train: 0.794604 val: 0.753283 test: 0.780248
max validation accuracy : 0.753283 max acc epoch : 4 test accuracy : 0.780248
Counter({0: 5703, 1: 4959})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  81.36905315518379 Time :  1252
accuracy train: 0.791129 val: 0.757974 test: 0.767023
max validation accuracy : 0.757974 max acc epoch : 5 test accuracy : 0.767023
Counter({1: 5760, 0: 4902})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  78.16422241926193 Time :  1265
accuracy train: 0.787984 val: 0.754221 test: 0.764491
max validation accuracy : 0.757974 max acc epoch : 5 test accuracy : 0.767023
Counter({0: 5757, 1: 4905})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  76.84457077085972 Time :  1277
accuracy train: 0.803873 val: 0.773921 test: 0.777715
max validation accuracy : 0.773921 max acc epoch : 7 test accuracy : 0.777715
Counter({0: 6066, 1: 4596})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.30315253138542 Time :  1289
accuracy train: 0.801556 val: 0.761726 test: 0.772651
max validation accuracy : 0.773921 max acc epoch : 7 test accuracy : 0.777715
Counter({1: 5707, 0: 4955})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  75.87175613641739 Time :  1302
accuracy train: 0.810824 val: 0.763602 test: 0.777715
max validation accuracy : 0.773921 max acc epoch : 7 test accuracy : 0.777715
Counter({1: 5781, 0: 4881})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  74.93598061800003 Time :  1315
accuracy train: 0.814962 val: 0.764540 test: 0.783343
max validation accuracy : 0.773921 max acc epoch : 7 test accuracy : 0.777715
Counter({0: 5733, 1: 4929})

Epoch :  11 loss training:  72.86494340002537 Time :  1327
accuracy train: 0.818769 val: 0.758912 test: 0.782499
max validation accuracy : 0.773921 max acc epoch : 7 test accuracy : 0.777715
Counter({1: 5663, 0: 4999})

Epoch :  12 loss training:  71.92488671839237 Time :  1339
accuracy train: 0.826216 val: 0.768293 test: 0.785031
max validation accuracy : 0.773921 max acc epoch : 7 test accuracy : 0.777715
Counter({1: 5786, 0: 4876})

Epoch :  13 loss training:  70.18879760801792 Time :  1352
accuracy train: 0.828865 val: 0.770169 test: 0.783624
max validation accuracy : 0.773921 max acc epoch : 7 test accuracy : 0.777715
Counter({0: 5755, 1: 4907})

Epoch :  14 loss training:  69.34620597958565 Time :  1364
accuracy train: 0.838795 val: 0.765478 test: 0.788126
max validation accuracy : 0.773921 max acc epoch : 7 test accuracy : 0.777715
Counter({1: 5835, 0: 4827})

Epoch :  15 loss training:  66.18099048733711 Time :  1376
accuracy train: 0.846905 val: 0.765478 test: 0.784468
max validation accuracy : 0.773921 max acc epoch : 7 test accuracy : 0.777715
Counter({1: 5886, 0: 4776})

Epoch :  16 loss training:  64.35834364593029 Time :  1389
accuracy train: 0.856504 val: 0.765478 test: 0.782499
max validation accuracy : 0.773921 max acc epoch : 7 test accuracy : 0.777715
Counter({1: 5837, 0: 4825})

Epoch :  17 loss training:  63.74990992248058 Time :  1401
accuracy train: 0.864283 val: 0.757036 test: 0.783624
max validation accuracy : 0.773921 max acc epoch : 7 test accuracy : 0.777715
Counter({0: 5865, 1: 4797})

Epoch :  18 loss training:  61.57024958729744 Time :  1414
accuracy train: 0.871400 val: 0.760788 test: 0.784468
max validation accuracy : 0.773921 max acc epoch : 7 test accuracy : 0.777715
Counter({1: 5920, 0: 4742})

========================================================================================================================================================================================================
best acc epoch :  7
validation accuracy :  0.773921200750469
test accuracy :  0.7777152504220597
last test_accuracy :  0.7844682048396173
second best val :  0.7701688555347092
second best test :  0.7777152504220597
max gap 2
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  21 	 val_accuracy : 0.78330 	 test_accuracy : 0.78813 	 last test_accuracy : 0.77968 	 second best val : 0.78236 	 second best test : 0.78813
k :  1 	 best_acc epoch :  7 	 val_accuracy : 0.79456 	 test_accuracy : 0.77406 	 last test_accuracy : 0.77800 	 second best val : 0.79362 	 second best test : 0.77406
k :  2 	 best_acc epoch :  28 	 val_accuracy : 0.79925 	 test_accuracy : 0.78137 	 last test_accuracy : 0.77940 	 second best val : 0.79737 	 second best test : 0.78137
k :  3 	 best_acc epoch :  7 	 val_accuracy : 0.77392 	 test_accuracy : 0.77772 	 last test_accuracy : 0.78447 	 second best val : 0.77017 	 second best test : 0.77772

avg :  	 val_accuracy : 0.78776 	 test_accuracy : 0.78032 	 last_accuracy : 0.78039 	 second best val : 0.78588 	 second best test : 0.78032

std :  	 val_accuracy : 0.00987 	 test_accuracy : 0.00520 	 last_accuracy : 0.00244 	 second best val : 0.01062 	 second best test : 0.00520
