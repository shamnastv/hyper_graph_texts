

date and time :  Sat Jul  3 17:29:09 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=306, tsne=False, val_prop=0.15, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  97.34199661016464 Time :  12
accuracy train: 0.766468 val: 0.765478 test: 0.768430
max validation accuracy : 0.765478 max acc epoch : 1 test accuracy : 0.768430
Epoch-1 lr: 0.001

Epoch :  2 loss training:  89.89702099561691 Time :  21
accuracy train: 0.774743 val: 0.771107 test: 0.761677
max validation accuracy : 0.771107 max acc epoch : 2 test accuracy : 0.761677
Epoch-2 lr: 0.001

Epoch :  3 loss training:  86.6896975338459 Time :  31
accuracy train: 0.778385 val: 0.764540 test: 0.766742
max validation accuracy : 0.771107 max acc epoch : 2 test accuracy : 0.761677
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  82.93327987194061 Time :  40
accuracy train: 0.786164 val: 0.777674 test: 0.770118
max validation accuracy : 0.777674 max acc epoch : 4 test accuracy : 0.770118
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.83550697565079 Time :  51
accuracy train: 0.802052 val: 0.778612 test: 0.775746
max validation accuracy : 0.778612 max acc epoch : 5 test accuracy : 0.775746
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.71635317802429 Time :  61
accuracy train: 0.803045 val: 0.792683 test: 0.774902
max validation accuracy : 0.792683 max acc epoch : 6 test accuracy : 0.774902
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.59763598442078 Time :  72
accuracy train: 0.811486 val: 0.790807 test: 0.780529
max validation accuracy : 0.792683 max acc epoch : 6 test accuracy : 0.774902
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  77.15918681025505 Time :  84
accuracy train: 0.811155 val: 0.794559 test: 0.779403
max validation accuracy : 0.794559 max acc epoch : 8 test accuracy : 0.779403
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  77.22130465507507 Time :  94
accuracy train: 0.818438 val: 0.785178 test: 0.782217
max validation accuracy : 0.794559 max acc epoch : 8 test accuracy : 0.779403
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  76.80359107255936 Time :  105
accuracy train: 0.820093 val: 0.793621 test: 0.780810
max validation accuracy : 0.794559 max acc epoch : 8 test accuracy : 0.779403

Epoch :  11 loss training:  74.01659241318703 Time :  115
accuracy train: 0.824396 val: 0.788931 test: 0.781373
max validation accuracy : 0.794559 max acc epoch : 8 test accuracy : 0.779403

Epoch :  12 loss training:  73.05345974862576 Time :  125
accuracy train: 0.838133 val: 0.791745 test: 0.784187
max validation accuracy : 0.794559 max acc epoch : 8 test accuracy : 0.779403

Epoch :  13 loss training:  70.57322697341442 Time :  134
accuracy train: 0.842767 val: 0.803002 test: 0.784187
max validation accuracy : 0.803002 max acc epoch : 13 test accuracy : 0.784187

Epoch :  14 loss training:  69.24141255021095 Time :  144
accuracy train: 0.851870 val: 0.795497 test: 0.784750
max validation accuracy : 0.803002 max acc epoch : 13 test accuracy : 0.784187

Epoch :  15 loss training:  67.74869206547737 Time :  154
accuracy train: 0.859649 val: 0.796435 test: 0.783905
max validation accuracy : 0.803002 max acc epoch : 13 test accuracy : 0.784187

Epoch :  16 loss training:  65.1847231388092 Time :  165
accuracy train: 0.866269 val: 0.797373 test: 0.783343
max validation accuracy : 0.803002 max acc epoch : 13 test accuracy : 0.784187

Epoch :  17 loss training:  64.82480144500732 Time :  172
accuracy train: 0.875207 val: 0.796435 test: 0.782499
max validation accuracy : 0.803002 max acc epoch : 13 test accuracy : 0.784187

Epoch :  18 loss training:  60.78219357132912 Time :  178
accuracy train: 0.882820 val: 0.794559 test: 0.785875
max validation accuracy : 0.803002 max acc epoch : 13 test accuracy : 0.784187

Epoch :  19 loss training:  60.73660910129547 Time :  187
accuracy train: 0.889772 val: 0.795497 test: 0.789252
max validation accuracy : 0.803002 max acc epoch : 13 test accuracy : 0.784187

Epoch :  20 loss training:  57.63452769815922 Time :  196
accuracy train: 0.897219 val: 0.800188 test: 0.787563
max validation accuracy : 0.803002 max acc epoch : 13 test accuracy : 0.784187

Epoch :  21 loss training:  54.74585746228695 Time :  206
accuracy train: 0.905495 val: 0.802064 test: 0.784187
max validation accuracy : 0.803002 max acc epoch : 13 test accuracy : 0.784187

Epoch :  22 loss training:  55.60541854798794 Time :  213
accuracy train: 0.915094 val: 0.800188 test: 0.783624
max validation accuracy : 0.803002 max acc epoch : 13 test accuracy : 0.784187

Epoch :  23 loss training:  53.172821924090385 Time :  219
accuracy train: 0.921218 val: 0.803940 test: 0.784468
max validation accuracy : 0.803940 max acc epoch : 23 test accuracy : 0.784468

Epoch :  24 loss training:  50.27126354724169 Time :  225
accuracy train: 0.927342 val: 0.800188 test: 0.782217
max validation accuracy : 0.803940 max acc epoch : 23 test accuracy : 0.784468

Epoch :  25 loss training:  49.9704797193408 Time :  238
accuracy train: 0.933300 val: 0.800188 test: 0.783905
max validation accuracy : 0.803940 max acc epoch : 23 test accuracy : 0.784468

Epoch :  26 loss training:  46.035662576556206 Time :  248
accuracy train: 0.941907 val: 0.799250 test: 0.781654
max validation accuracy : 0.803940 max acc epoch : 23 test accuracy : 0.784468

Epoch :  27 loss training:  44.99229558557272 Time :  259
accuracy train: 0.943065 val: 0.804878 test: 0.783343
max validation accuracy : 0.804878 max acc epoch : 27 test accuracy : 0.783343

Epoch :  28 loss training:  42.665652606636286 Time :  269
accuracy train: 0.950679 val: 0.797373 test: 0.784468
max validation accuracy : 0.804878 max acc epoch : 27 test accuracy : 0.783343

Epoch :  29 loss training:  43.53492783010006 Time :  280
accuracy train: 0.954816 val: 0.794559 test: 0.781092
max validation accuracy : 0.804878 max acc epoch : 27 test accuracy : 0.783343

Epoch :  30 loss training:  41.35826838761568 Time :  289
accuracy train: 0.958954 val: 0.801126 test: 0.778841
max validation accuracy : 0.804878 max acc epoch : 27 test accuracy : 0.783343

Epoch :  31 loss training:  38.14559983834624 Time :  299
accuracy train: 0.961271 val: 0.798311 test: 0.776027
max validation accuracy : 0.804878 max acc epoch : 27 test accuracy : 0.783343

Epoch :  32 loss training:  37.96731932833791 Time :  309
accuracy train: 0.963423 val: 0.803940 test: 0.775183
max validation accuracy : 0.804878 max acc epoch : 27 test accuracy : 0.783343

Epoch :  33 loss training:  34.79743319749832 Time :  318
accuracy train: 0.969050 val: 0.791745 test: 0.776027
max validation accuracy : 0.804878 max acc epoch : 27 test accuracy : 0.783343

Epoch :  34 loss training:  35.45088893175125 Time :  328
accuracy train: 0.972195 val: 0.788931 test: 0.780248
max validation accuracy : 0.804878 max acc epoch : 27 test accuracy : 0.783343

Epoch :  35 loss training:  33.42610803991556 Time :  337
accuracy train: 0.973188 val: 0.793621 test: 0.778841
max validation accuracy : 0.804878 max acc epoch : 27 test accuracy : 0.783343

Epoch :  36 loss training:  32.45914527028799 Time :  348
accuracy train: 0.975008 val: 0.787054 test: 0.780529
max validation accuracy : 0.804878 max acc epoch : 27 test accuracy : 0.783343

Epoch :  37 loss training:  31.542483750730753 Time :  357
accuracy train: 0.981298 val: 0.792683 test: 0.779122
max validation accuracy : 0.804878 max acc epoch : 27 test accuracy : 0.783343

Epoch :  38 loss training:  29.26406691595912 Time :  367
accuracy train: 0.981298 val: 0.789869 test: 0.776871
max validation accuracy : 0.804878 max acc epoch : 27 test accuracy : 0.783343

========================================================================================================================================================================================================
best acc epoch :  27
validation accuracy :  0.8048780487804879
test accuracy :  0.7833427124366911
last test_accuracy :  0.7768711311198649
second best val :  0.8039399624765479
second best test :  0.7844682048396173
max gap 10
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=389, tsne=False, val_prop=0.15, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  97.50009042024612 Time :  377
accuracy train: 0.761503 val: 0.750469 test: 0.752954
max validation accuracy : 0.750469 max acc epoch : 1 test accuracy : 0.752954
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.91010376811028 Time :  387
accuracy train: 0.767792 val: 0.751407 test: 0.751829
max validation accuracy : 0.751407 max acc epoch : 2 test accuracy : 0.751829
Epoch-2 lr: 0.001

Epoch :  3 loss training:  85.06118032336235 Time :  396
accuracy train: 0.788481 val: 0.757974 test: 0.763647
max validation accuracy : 0.757974 max acc epoch : 3 test accuracy : 0.763647
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  82.69164237380028 Time :  406
accuracy train: 0.785170 val: 0.750469 test: 0.750985
max validation accuracy : 0.757974 max acc epoch : 3 test accuracy : 0.763647
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  81.10598143935204 Time :  415
accuracy train: 0.807018 val: 0.770169 test: 0.772932
max validation accuracy : 0.770169 max acc epoch : 5 test accuracy : 0.772932
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.07092010974884 Time :  424
accuracy train: 0.803873 val: 0.767355 test: 0.777434
max validation accuracy : 0.770169 max acc epoch : 5 test accuracy : 0.772932
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.42601343989372 Time :  435
accuracy train: 0.813638 val: 0.771107 test: 0.775183
max validation accuracy : 0.771107 max acc epoch : 7 test accuracy : 0.775183
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.38380128145218 Time :  445
accuracy train: 0.821913 val: 0.764540 test: 0.774620
max validation accuracy : 0.771107 max acc epoch : 7 test accuracy : 0.775183
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.94329032301903 Time :  455
accuracy train: 0.817610 val: 0.772045 test: 0.775464
max validation accuracy : 0.772045 max acc epoch : 9 test accuracy : 0.775464
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  74.72197848558426 Time :  464
accuracy train: 0.821417 val: 0.777674 test: 0.775183
max validation accuracy : 0.777674 max acc epoch : 10 test accuracy : 0.775183

Epoch :  11 loss training:  73.27449943125248 Time :  474
accuracy train: 0.833995 val: 0.779550 test: 0.777997
max validation accuracy : 0.779550 max acc epoch : 11 test accuracy : 0.777997

Epoch :  12 loss training:  72.4462316185236 Time :  484
accuracy train: 0.839788 val: 0.777674 test: 0.779685
max validation accuracy : 0.779550 max acc epoch : 11 test accuracy : 0.777997

Epoch :  13 loss training:  71.68811708688736 Time :  493
accuracy train: 0.846739 val: 0.776735 test: 0.779403
max validation accuracy : 0.779550 max acc epoch : 11 test accuracy : 0.777997

Epoch :  14 loss training:  68.73051846027374 Time :  503
accuracy train: 0.855677 val: 0.787054 test: 0.780248
max validation accuracy : 0.787054 max acc epoch : 14 test accuracy : 0.780248

Epoch :  15 loss training:  65.43393698334694 Time :  512
accuracy train: 0.862794 val: 0.789869 test: 0.776590
max validation accuracy : 0.789869 max acc epoch : 15 test accuracy : 0.776590

Epoch :  16 loss training:  64.39902125298977 Time :  523
accuracy train: 0.871400 val: 0.781426 test: 0.779122
max validation accuracy : 0.789869 max acc epoch : 15 test accuracy : 0.776590

Epoch :  17 loss training:  62.94697616994381 Time :  533
accuracy train: 0.880172 val: 0.793621 test: 0.778278
max validation accuracy : 0.793621 max acc epoch : 17 test accuracy : 0.778278

Epoch :  18 loss training:  61.03431202471256 Time :  543
accuracy train: 0.884806 val: 0.789869 test: 0.778841
max validation accuracy : 0.793621 max acc epoch : 17 test accuracy : 0.778278

Epoch :  19 loss training:  59.27544093132019 Time :  552
accuracy train: 0.891427 val: 0.787054 test: 0.781654
max validation accuracy : 0.793621 max acc epoch : 17 test accuracy : 0.778278

Epoch :  20 loss training:  57.33448076248169 Time :  561
accuracy train: 0.903840 val: 0.787054 test: 0.783624
max validation accuracy : 0.793621 max acc epoch : 17 test accuracy : 0.778278

Epoch :  21 loss training:  55.683141604065895 Time :  573
accuracy train: 0.906819 val: 0.791745 test: 0.783061
max validation accuracy : 0.793621 max acc epoch : 17 test accuracy : 0.778278

Epoch :  22 loss training:  54.427926041185856 Time :  582
accuracy train: 0.915094 val: 0.794559 test: 0.783624
max validation accuracy : 0.794559 max acc epoch : 22 test accuracy : 0.783624

Epoch :  23 loss training:  51.38620475679636 Time :  592
accuracy train: 0.924363 val: 0.784240 test: 0.786719
max validation accuracy : 0.794559 max acc epoch : 22 test accuracy : 0.783624

Epoch :  24 loss training:  49.61786022782326 Time :  603
accuracy train: 0.932638 val: 0.795497 test: 0.781654
max validation accuracy : 0.795497 max acc epoch : 24 test accuracy : 0.781654

Epoch :  25 loss training:  47.73112799227238 Time :  612
accuracy train: 0.937934 val: 0.787054 test: 0.785875
max validation accuracy : 0.795497 max acc epoch : 24 test accuracy : 0.781654

Epoch :  26 loss training:  46.655672408640385 Time :  622
accuracy train: 0.942900 val: 0.781426 test: 0.783343
max validation accuracy : 0.795497 max acc epoch : 24 test accuracy : 0.781654

Epoch :  27 loss training:  44.50442858785391 Time :  631
accuracy train: 0.945713 val: 0.781426 test: 0.785594
max validation accuracy : 0.795497 max acc epoch : 24 test accuracy : 0.781654

Epoch :  28 loss training:  42.97821535915136 Time :  641
accuracy train: 0.950679 val: 0.776735 test: 0.782217
max validation accuracy : 0.795497 max acc epoch : 24 test accuracy : 0.781654

Epoch :  29 loss training:  40.30956958979368 Time :  650
accuracy train: 0.958457 val: 0.777674 test: 0.785312
max validation accuracy : 0.795497 max acc epoch : 24 test accuracy : 0.781654

Epoch :  30 loss training:  40.78754622489214 Time :  660
accuracy train: 0.958457 val: 0.781426 test: 0.785875
max validation accuracy : 0.795497 max acc epoch : 24 test accuracy : 0.781654

Epoch :  31 loss training:  37.711896389722824 Time :  669
accuracy train: 0.959947 val: 0.784240 test: 0.790377
max validation accuracy : 0.795497 max acc epoch : 24 test accuracy : 0.781654

Epoch :  32 loss training:  37.762116238474846 Time :  678
accuracy train: 0.964747 val: 0.785178 test: 0.786438
max validation accuracy : 0.795497 max acc epoch : 24 test accuracy : 0.781654

Epoch :  33 loss training:  34.93353321403265 Time :  687
accuracy train: 0.969050 val: 0.784240 test: 0.782780
max validation accuracy : 0.795497 max acc epoch : 24 test accuracy : 0.781654

Epoch :  34 loss training:  34.714044354856014 Time :  693
accuracy train: 0.971864 val: 0.785178 test: 0.783905
max validation accuracy : 0.795497 max acc epoch : 24 test accuracy : 0.781654

Epoch :  35 loss training:  31.13247226923704 Time :  699
accuracy train: 0.975670 val: 0.782364 test: 0.778278
max validation accuracy : 0.795497 max acc epoch : 24 test accuracy : 0.781654

========================================================================================================================================================================================================
best acc epoch :  24
validation accuracy :  0.7954971857410882
test accuracy :  0.7816544738323016
last test_accuracy :  0.7782779966235228
second best val :  0.7945590994371482
second best test :  0.7836240855374226
max gap 5
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=114, tsne=False, val_prop=0.15, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  97.45308002829552 Time :  711
accuracy train: 0.725257 val: 0.706379 test: 0.715532
max validation accuracy : 0.706379 max acc epoch : 1 test accuracy : 0.715532
Epoch-1 lr: 0.001

Epoch :  2 loss training:  88.96870464086533 Time :  720
accuracy train: 0.784177 val: 0.753283 test: 0.772369
max validation accuracy : 0.753283 max acc epoch : 2 test accuracy : 0.772369
Epoch-2 lr: 0.001

Epoch :  3 loss training:  85.22868621349335 Time :  730
accuracy train: 0.782191 val: 0.749531 test: 0.772088
max validation accuracy : 0.753283 max acc epoch : 2 test accuracy : 0.772369
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.57944211363792 Time :  739
accuracy train: 0.795266 val: 0.758912 test: 0.783624
max validation accuracy : 0.758912 max acc epoch : 4 test accuracy : 0.783624
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.94632604718208 Time :  748
accuracy train: 0.800728 val: 0.771107 test: 0.780248
max validation accuracy : 0.771107 max acc epoch : 5 test accuracy : 0.780248
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.55851918458939 Time :  759
accuracy train: 0.804866 val: 0.772983 test: 0.783624
max validation accuracy : 0.772983 max acc epoch : 6 test accuracy : 0.783624
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  78.86578863859177 Time :  768
accuracy train: 0.807680 val: 0.766417 test: 0.779122
max validation accuracy : 0.772983 max acc epoch : 6 test accuracy : 0.783624
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.73699389398098 Time :  778
accuracy train: 0.808838 val: 0.766417 test: 0.783624
max validation accuracy : 0.772983 max acc epoch : 6 test accuracy : 0.783624
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  75.68011075258255 Time :  787
accuracy train: 0.813969 val: 0.771107 test: 0.785312
max validation accuracy : 0.772983 max acc epoch : 6 test accuracy : 0.783624
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.6122775375843 Time :  798
accuracy train: 0.816286 val: 0.775797 test: 0.782499
max validation accuracy : 0.775797 max acc epoch : 10 test accuracy : 0.782499

Epoch :  11 loss training:  74.93826289474964 Time :  808
accuracy train: 0.822244 val: 0.776735 test: 0.783061
max validation accuracy : 0.776735 max acc epoch : 11 test accuracy : 0.783061

Epoch :  12 loss training:  74.22618356347084 Time :  819
accuracy train: 0.832009 val: 0.772045 test: 0.782780
max validation accuracy : 0.776735 max acc epoch : 11 test accuracy : 0.783061

Epoch :  13 loss training:  71.80896992981434 Time :  828
accuracy train: 0.840947 val: 0.781426 test: 0.785875
max validation accuracy : 0.781426 max acc epoch : 13 test accuracy : 0.785875

Epoch :  14 loss training:  70.21050900220871 Time :  837
accuracy train: 0.845912 val: 0.779550 test: 0.785875
max validation accuracy : 0.781426 max acc epoch : 13 test accuracy : 0.785875

Epoch :  15 loss training:  67.58215083181858 Time :  846
accuracy train: 0.856504 val: 0.784240 test: 0.785875
max validation accuracy : 0.784240 max acc epoch : 15 test accuracy : 0.785875

Epoch :  16 loss training:  65.47673934698105 Time :  852
accuracy train: 0.867759 val: 0.791745 test: 0.783905
max validation accuracy : 0.791745 max acc epoch : 16 test accuracy : 0.783905

Epoch :  17 loss training:  63.75610922276974 Time :  859
accuracy train: 0.874710 val: 0.780488 test: 0.791221
max validation accuracy : 0.791745 max acc epoch : 16 test accuracy : 0.783905

Epoch :  18 loss training:  62.23511315882206 Time :  870
accuracy train: 0.884144 val: 0.787992 test: 0.788407
max validation accuracy : 0.791745 max acc epoch : 16 test accuracy : 0.783905

Epoch :  19 loss training:  60.46125853061676 Time :  879
accuracy train: 0.893413 val: 0.791745 test: 0.785594
max validation accuracy : 0.791745 max acc epoch : 16 test accuracy : 0.783905

Epoch :  20 loss training:  59.25692914426327 Time :  890
accuracy train: 0.897219 val: 0.789869 test: 0.783905
max validation accuracy : 0.791745 max acc epoch : 16 test accuracy : 0.783905

Epoch :  21 loss training:  56.97727456688881 Time :  900
accuracy train: 0.903509 val: 0.787992 test: 0.785312
max validation accuracy : 0.791745 max acc epoch : 16 test accuracy : 0.783905

Epoch :  22 loss training:  54.13731677830219 Time :  912
accuracy train: 0.912777 val: 0.792683 test: 0.789533
max validation accuracy : 0.792683 max acc epoch : 22 test accuracy : 0.789533

Epoch :  23 loss training:  52.230290696024895 Time :  921
accuracy train: 0.916584 val: 0.792683 test: 0.787563
max validation accuracy : 0.792683 max acc epoch : 22 test accuracy : 0.789533

Epoch :  24 loss training:  50.20985786616802 Time :  931
accuracy train: 0.922708 val: 0.796435 test: 0.780810
max validation accuracy : 0.796435 max acc epoch : 24 test accuracy : 0.780810

Epoch :  25 loss training:  48.54521533846855 Time :  941
accuracy train: 0.932142 val: 0.787992 test: 0.784187
max validation accuracy : 0.796435 max acc epoch : 24 test accuracy : 0.780810

Epoch :  26 loss training:  45.98382855206728 Time :  950
accuracy train: 0.936279 val: 0.793621 test: 0.780810
max validation accuracy : 0.796435 max acc epoch : 24 test accuracy : 0.780810

Epoch :  27 loss training:  44.71691023558378 Time :  961
accuracy train: 0.941576 val: 0.789869 test: 0.779403
max validation accuracy : 0.796435 max acc epoch : 24 test accuracy : 0.780810

Epoch :  28 loss training:  42.79302145540714 Time :  970
accuracy train: 0.949189 val: 0.796435 test: 0.779685
max validation accuracy : 0.796435 max acc epoch : 24 test accuracy : 0.780810

Epoch :  29 loss training:  42.122162871062756 Time :  980
accuracy train: 0.953658 val: 0.795497 test: 0.777715
max validation accuracy : 0.796435 max acc epoch : 24 test accuracy : 0.780810

Epoch :  30 loss training:  40.48843360692263 Time :  989
accuracy train: 0.955809 val: 0.791745 test: 0.774339
max validation accuracy : 0.796435 max acc epoch : 24 test accuracy : 0.780810

Epoch :  31 loss training:  37.515669263899326 Time :  1000
accuracy train: 0.961271 val: 0.791745 test: 0.781936
max validation accuracy : 0.796435 max acc epoch : 24 test accuracy : 0.780810

Epoch :  32 loss training:  37.275231793522835 Time :  1010
accuracy train: 0.964085 val: 0.788931 test: 0.777715
max validation accuracy : 0.796435 max acc epoch : 24 test accuracy : 0.780810

Epoch :  33 loss training:  36.23513679206371 Time :  1020
accuracy train: 0.966733 val: 0.797373 test: 0.775464
max validation accuracy : 0.797373 max acc epoch : 33 test accuracy : 0.775464

Epoch :  34 loss training:  34.63716974109411 Time :  1029
accuracy train: 0.970209 val: 0.793621 test: 0.774902
max validation accuracy : 0.797373 max acc epoch : 33 test accuracy : 0.775464

Epoch :  35 loss training:  34.29214367642999 Time :  1039
accuracy train: 0.973519 val: 0.790807 test: 0.780248
max validation accuracy : 0.797373 max acc epoch : 33 test accuracy : 0.775464

Epoch :  36 loss training:  31.311184480786324 Time :  1048
accuracy train: 0.975836 val: 0.792683 test: 0.774620
max validation accuracy : 0.797373 max acc epoch : 33 test accuracy : 0.775464

Epoch :  37 loss training:  31.43194656446576 Time :  1058
accuracy train: 0.976332 val: 0.792683 test: 0.779122
max validation accuracy : 0.797373 max acc epoch : 33 test accuracy : 0.775464

Epoch :  38 loss training:  28.959001626819372 Time :  1068
accuracy train: 0.980636 val: 0.790807 test: 0.774339
max validation accuracy : 0.797373 max acc epoch : 33 test accuracy : 0.775464

Epoch :  39 loss training:  28.549208134412766 Time :  1077
accuracy train: 0.982125 val: 0.787054 test: 0.772088
max validation accuracy : 0.797373 max acc epoch : 33 test accuracy : 0.775464

Epoch :  40 loss training:  27.85055378638208 Time :  1088
accuracy train: 0.983615 val: 0.787992 test: 0.774620
max validation accuracy : 0.797373 max acc epoch : 33 test accuracy : 0.775464

Epoch :  41 loss training:  26.646611630916595 Time :  1097
accuracy train: 0.984111 val: 0.788931 test: 0.771806
max validation accuracy : 0.797373 max acc epoch : 33 test accuracy : 0.775464

Epoch :  42 loss training:  26.09616155922413 Time :  1105
accuracy train: 0.987090 val: 0.775797 test: 0.770118
max validation accuracy : 0.797373 max acc epoch : 33 test accuracy : 0.775464

Epoch :  43 loss training:  24.116391064599156 Time :  1112
accuracy train: 0.988414 val: 0.787054 test: 0.772651
max validation accuracy : 0.797373 max acc epoch : 33 test accuracy : 0.775464

Epoch :  44 loss training:  23.928916208446026 Time :  1121
accuracy train: 0.988249 val: 0.783302 test: 0.770400
max validation accuracy : 0.797373 max acc epoch : 33 test accuracy : 0.775464

========================================================================================================================================================================================================
best acc epoch :  33
validation accuracy :  0.797373358348968
test accuracy :  0.7754642656162071
last test_accuracy :  0.7703995498030388
second best val :  0.7964352720450282
second best test :  0.7808103545301069
max gap 9
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=274, tsne=False, val_prop=0.15, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  97.17879495024681 Time :  1132
accuracy train: 0.766965 val: 0.744841 test: 0.757456
max validation accuracy : 0.744841 max acc epoch : 1 test accuracy : 0.757456
Epoch-1 lr: 0.001

Epoch :  2 loss training:  86.3311625123024 Time :  1141
accuracy train: 0.780371 val: 0.741088 test: 0.758582
max validation accuracy : 0.744841 max acc epoch : 1 test accuracy : 0.757456
Epoch-2 lr: 0.001

Epoch :  3 loss training:  84.45359307527542 Time :  1151
accuracy train: 0.788481 val: 0.753283 test: 0.773776
max validation accuracy : 0.753283 max acc epoch : 3 test accuracy : 0.773776
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  82.19732500612736 Time :  1160
accuracy train: 0.798080 val: 0.755159 test: 0.772651
max validation accuracy : 0.755159 max acc epoch : 4 test accuracy : 0.772651
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  79.82973968982697 Time :  1171
accuracy train: 0.800894 val: 0.752345 test: 0.775183
max validation accuracy : 0.755159 max acc epoch : 4 test accuracy : 0.772651
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  78.95458510518074 Time :  1180
accuracy train: 0.806024 val: 0.749531 test: 0.774339
max validation accuracy : 0.755159 max acc epoch : 4 test accuracy : 0.772651
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  76.95144498348236 Time :  1189
accuracy train: 0.814796 val: 0.758912 test: 0.773213
max validation accuracy : 0.758912 max acc epoch : 7 test accuracy : 0.773213
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.59548115730286 Time :  1199
accuracy train: 0.812976 val: 0.755159 test: 0.773776
max validation accuracy : 0.758912 max acc epoch : 7 test accuracy : 0.773213
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  74.40156674385071 Time :  1208
accuracy train: 0.823403 val: 0.758912 test: 0.774339
max validation accuracy : 0.758912 max acc epoch : 7 test accuracy : 0.773213
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  74.44151778519154 Time :  1219
accuracy train: 0.824561 val: 0.763602 test: 0.776027
max validation accuracy : 0.763602 max acc epoch : 10 test accuracy : 0.776027

Epoch :  11 loss training:  74.15174603462219 Time :  1230
accuracy train: 0.830189 val: 0.763602 test: 0.780529
max validation accuracy : 0.763602 max acc epoch : 10 test accuracy : 0.776027

Epoch :  12 loss training:  71.02996376156807 Time :  1241
accuracy train: 0.840450 val: 0.768293 test: 0.778841
max validation accuracy : 0.768293 max acc epoch : 12 test accuracy : 0.778841

Epoch :  13 loss training:  69.67749783396721 Time :  1250
accuracy train: 0.843595 val: 0.760788 test: 0.781373
max validation accuracy : 0.768293 max acc epoch : 12 test accuracy : 0.778841

Epoch :  14 loss training:  69.20272544026375 Time :  1261
accuracy train: 0.853691 val: 0.767355 test: 0.778278
max validation accuracy : 0.768293 max acc epoch : 12 test accuracy : 0.778841

Epoch :  15 loss training:  66.07470816373825 Time :  1270
accuracy train: 0.857829 val: 0.772983 test: 0.783624
max validation accuracy : 0.772983 max acc epoch : 15 test accuracy : 0.783624

Epoch :  16 loss training:  65.22459590435028 Time :  1278
accuracy train: 0.869083 val: 0.770169 test: 0.784750
max validation accuracy : 0.772983 max acc epoch : 15 test accuracy : 0.783624

Epoch :  17 loss training:  63.64595074951649 Time :  1289
accuracy train: 0.877193 val: 0.775797 test: 0.781936
max validation accuracy : 0.775797 max acc epoch : 17 test accuracy : 0.781936

Epoch :  18 loss training:  61.0957023948431 Time :  1298
accuracy train: 0.884475 val: 0.772045 test: 0.783343
max validation accuracy : 0.775797 max acc epoch : 17 test accuracy : 0.781936

Epoch :  19 loss training:  57.80535674095154 Time :  1308
accuracy train: 0.892585 val: 0.779550 test: 0.781654
max validation accuracy : 0.779550 max acc epoch : 19 test accuracy : 0.781654

Epoch :  20 loss training:  55.927309423685074 Time :  1318
accuracy train: 0.899206 val: 0.773921 test: 0.779122
max validation accuracy : 0.779550 max acc epoch : 19 test accuracy : 0.781654

Epoch :  21 loss training:  55.40542455017567 Time :  1328
accuracy train: 0.910626 val: 0.771107 test: 0.784468
max validation accuracy : 0.779550 max acc epoch : 19 test accuracy : 0.781654

Epoch :  22 loss training:  53.782003208994865 Time :  1337
accuracy train: 0.914763 val: 0.772045 test: 0.785031
max validation accuracy : 0.779550 max acc epoch : 19 test accuracy : 0.781654

Epoch :  23 loss training:  50.692529141902924 Time :  1347
accuracy train: 0.923866 val: 0.769231 test: 0.781936
max validation accuracy : 0.779550 max acc epoch : 19 test accuracy : 0.781654

Epoch :  24 loss training:  51.193689718842506 Time :  1357
accuracy train: 0.932804 val: 0.768293 test: 0.780248
max validation accuracy : 0.779550 max acc epoch : 19 test accuracy : 0.781654

Epoch :  25 loss training:  46.40519040822983 Time :  1366
accuracy train: 0.932307 val: 0.773921 test: 0.782499
max validation accuracy : 0.779550 max acc epoch : 19 test accuracy : 0.781654

Epoch :  26 loss training:  46.66075174510479 Time :  1377
accuracy train: 0.940417 val: 0.772983 test: 0.781936
max validation accuracy : 0.779550 max acc epoch : 19 test accuracy : 0.781654

Epoch :  27 loss training:  44.546965792775154 Time :  1386
accuracy train: 0.947534 val: 0.768293 test: 0.779966
max validation accuracy : 0.779550 max acc epoch : 19 test accuracy : 0.781654

Epoch :  28 loss training:  43.573053419589996 Time :  1397
accuracy train: 0.945879 val: 0.774859 test: 0.780810
max validation accuracy : 0.779550 max acc epoch : 19 test accuracy : 0.781654

Epoch :  29 loss training:  42.14143297821283 Time :  1406
accuracy train: 0.949851 val: 0.781426 test: 0.780248
max validation accuracy : 0.781426 max acc epoch : 29 test accuracy : 0.780248

Epoch :  30 loss training:  40.39862606674433 Time :  1417
accuracy train: 0.958788 val: 0.776735 test: 0.780810
max validation accuracy : 0.781426 max acc epoch : 29 test accuracy : 0.780248

Epoch :  31 loss training:  38.729563131928444 Time :  1426
accuracy train: 0.961933 val: 0.777674 test: 0.778841
max validation accuracy : 0.781426 max acc epoch : 29 test accuracy : 0.780248

Epoch :  32 loss training:  37.91277580708265 Time :  1436
accuracy train: 0.967064 val: 0.787054 test: 0.779685
max validation accuracy : 0.787054 max acc epoch : 32 test accuracy : 0.779685

Epoch :  33 loss training:  35.51405940204859 Time :  1445
accuracy train: 0.969547 val: 0.779550 test: 0.780248
max validation accuracy : 0.787054 max acc epoch : 32 test accuracy : 0.779685

Epoch :  34 loss training:  34.43941414356232 Time :  1456
accuracy train: 0.971367 val: 0.772045 test: 0.778278
max validation accuracy : 0.787054 max acc epoch : 32 test accuracy : 0.779685

Epoch :  35 loss training:  33.48311860114336 Time :  1465
accuracy train: 0.976167 val: 0.773921 test: 0.778841
max validation accuracy : 0.787054 max acc epoch : 32 test accuracy : 0.779685

Epoch :  36 loss training:  31.884235065430403 Time :  1476
accuracy train: 0.977491 val: 0.779550 test: 0.780248
max validation accuracy : 0.787054 max acc epoch : 32 test accuracy : 0.779685

Epoch :  37 loss training:  29.605007972568274 Time :  1485
accuracy train: 0.982953 val: 0.775797 test: 0.778559
max validation accuracy : 0.787054 max acc epoch : 32 test accuracy : 0.779685

Epoch :  38 loss training:  29.97079661488533 Time :  1493
accuracy train: 0.981960 val: 0.775797 test: 0.778841
max validation accuracy : 0.787054 max acc epoch : 32 test accuracy : 0.779685

Epoch :  39 loss training:  29.248971857130527 Time :  1500
accuracy train: 0.981629 val: 0.773921 test: 0.778278
max validation accuracy : 0.787054 max acc epoch : 32 test accuracy : 0.779685

Epoch :  40 loss training:  27.62734668329358 Time :  1506
accuracy train: 0.984442 val: 0.777674 test: 0.779403
max validation accuracy : 0.787054 max acc epoch : 32 test accuracy : 0.779685

Epoch :  41 loss training:  26.851044215261936 Time :  1516
accuracy train: 0.984442 val: 0.777674 test: 0.780810
max validation accuracy : 0.787054 max acc epoch : 32 test accuracy : 0.779685

Epoch :  42 loss training:  26.769944125786424 Time :  1525
accuracy train: 0.986428 val: 0.778612 test: 0.781654
max validation accuracy : 0.787054 max acc epoch : 32 test accuracy : 0.779685

Epoch :  43 loss training:  24.92235131189227 Time :  1536
accuracy train: 0.989573 val: 0.782364 test: 0.776308
max validation accuracy : 0.787054 max acc epoch : 32 test accuracy : 0.779685

========================================================================================================================================================================================================
best acc epoch :  32
validation accuracy :  0.7870544090056285
test accuracy :  0.7796848621271807
last test_accuracy :  0.7763083849184018
second best val :  0.7823639774859287
second best test :  0.7796848621271807
max gap 10
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  27 	 val_accuracy : 0.80488 	 test_accuracy : 0.78334 	 last test_accuracy : 0.77687 	 second best val : 0.80394 	 second best test : 0.78447
k :  1 	 best_acc epoch :  24 	 val_accuracy : 0.79550 	 test_accuracy : 0.78165 	 last test_accuracy : 0.77828 	 second best val : 0.79456 	 second best test : 0.78362
k :  2 	 best_acc epoch :  33 	 val_accuracy : 0.79737 	 test_accuracy : 0.77546 	 last test_accuracy : 0.77040 	 second best val : 0.79644 	 second best test : 0.78081
k :  3 	 best_acc epoch :  32 	 val_accuracy : 0.78705 	 test_accuracy : 0.77968 	 last test_accuracy : 0.77631 	 second best val : 0.78236 	 second best test : 0.77968

avg :  	 val_accuracy : 0.79620 	 test_accuracy : 0.78004 	 last_accuracy : 0.77546 	 second best val : 0.79432 	 second best test : 0.78215

std :  	 val_accuracy : 0.00634 	 test_accuracy : 0.00294 	 last_accuracy : 0.00301 	 second best val : 0.00775 	 second best test : 0.00196


date and time :  Sat Jul  3 17:54:54 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=294, tsne=False, val_prop=0.15, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  96.48884987831116 Time :  12
accuracy train: 0.775405 val: 0.767355 test: 0.772932
max validation accuracy : 0.767355 max acc epoch : 1 test accuracy : 0.772932
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.9032179415226 Time :  21
accuracy train: 0.783846 val: 0.768293 test: 0.769837
max validation accuracy : 0.768293 max acc epoch : 2 test accuracy : 0.769837
Epoch-2 lr: 0.001

Epoch :  3 loss training:  86.3057664334774 Time :  31
accuracy train: 0.789308 val: 0.774859 test: 0.764491
max validation accuracy : 0.774859 max acc epoch : 3 test accuracy : 0.764491
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  82.33113145828247 Time :  40
accuracy train: 0.793280 val: 0.774859 test: 0.771525
max validation accuracy : 0.774859 max acc epoch : 3 test accuracy : 0.764491
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  81.16854891180992 Time :  50
accuracy train: 0.784343 val: 0.768293 test: 0.765898
max validation accuracy : 0.774859 max acc epoch : 3 test accuracy : 0.764491
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  82.16790908575058 Time :  61
accuracy train: 0.807183 val: 0.784240 test: 0.777434
max validation accuracy : 0.784240 max acc epoch : 6 test accuracy : 0.777434
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  78.49770882725716 Time :  71
accuracy train: 0.810990 val: 0.787054 test: 0.777715
max validation accuracy : 0.787054 max acc epoch : 7 test accuracy : 0.777715
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  78.06654596328735 Time :  80
accuracy train: 0.813969 val: 0.798311 test: 0.775183
max validation accuracy : 0.798311 max acc epoch : 8 test accuracy : 0.775183
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  77.31087911128998 Time :  86
accuracy train: 0.810162 val: 0.779550 test: 0.777153
max validation accuracy : 0.798311 max acc epoch : 8 test accuracy : 0.775183
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.71457427740097 Time :  93
accuracy train: 0.819596 val: 0.787054 test: 0.777997
max validation accuracy : 0.798311 max acc epoch : 8 test accuracy : 0.775183

Epoch :  11 loss training:  76.561076015234 Time :  102
accuracy train: 0.825058 val: 0.787992 test: 0.779966
max validation accuracy : 0.798311 max acc epoch : 8 test accuracy : 0.775183

Epoch :  12 loss training:  75.17769218981266 Time :  111
accuracy train: 0.825885 val: 0.782364 test: 0.778841
max validation accuracy : 0.798311 max acc epoch : 8 test accuracy : 0.775183

Epoch :  13 loss training:  72.87584438920021 Time :  121
accuracy train: 0.840616 val: 0.786116 test: 0.777997
max validation accuracy : 0.798311 max acc epoch : 8 test accuracy : 0.775183

Epoch :  14 loss training:  70.06723929941654 Time :  132
accuracy train: 0.844753 val: 0.784240 test: 0.775746
max validation accuracy : 0.798311 max acc epoch : 8 test accuracy : 0.775183

Epoch :  15 loss training:  68.58004616200924 Time :  142
accuracy train: 0.859318 val: 0.785178 test: 0.780248
max validation accuracy : 0.798311 max acc epoch : 8 test accuracy : 0.775183

Epoch :  16 loss training:  67.29519023001194 Time :  153
accuracy train: 0.860973 val: 0.790807 test: 0.778278
max validation accuracy : 0.798311 max acc epoch : 8 test accuracy : 0.775183

Epoch :  17 loss training:  65.07926531136036 Time :  163
accuracy train: 0.866269 val: 0.789869 test: 0.778841
max validation accuracy : 0.798311 max acc epoch : 8 test accuracy : 0.775183

Epoch :  18 loss training:  62.06493490934372 Time :  175
accuracy train: 0.871731 val: 0.797373 test: 0.776027
max validation accuracy : 0.798311 max acc epoch : 8 test accuracy : 0.775183

Epoch :  19 loss training:  61.553765311837196 Time :  184
accuracy train: 0.881331 val: 0.798311 test: 0.777434
max validation accuracy : 0.798311 max acc epoch : 8 test accuracy : 0.775183

========================================================================================================================================================================================================
best acc epoch :  8
validation accuracy :  0.798311444652908
test accuracy :  0.7751828925154756
last test_accuracy :  0.7774338773213281
second best val :  0.797373358348968
second best test :  0.7751828925154756
max gap 3
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=906, tsne=False, val_prop=0.15, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  94.84995684027672 Time :  196
accuracy train: 0.766799 val: 0.742026 test: 0.759145
max validation accuracy : 0.742026 max acc epoch : 1 test accuracy : 0.759145
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.51152616739273 Time :  205
accuracy train: 0.767627 val: 0.743902 test: 0.762240
max validation accuracy : 0.743902 max acc epoch : 2 test accuracy : 0.762240
Epoch-2 lr: 0.001

Epoch :  3 loss training:  85.52685081958771 Time :  215
accuracy train: 0.767461 val: 0.741088 test: 0.757738
max validation accuracy : 0.743902 max acc epoch : 2 test accuracy : 0.762240
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.33997309207916 Time :  225
accuracy train: 0.800563 val: 0.774859 test: 0.776871
max validation accuracy : 0.774859 max acc epoch : 4 test accuracy : 0.776871
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.94467288255692 Time :  234
accuracy train: 0.794273 val: 0.761726 test: 0.772088
max validation accuracy : 0.774859 max acc epoch : 4 test accuracy : 0.776871
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  78.47861963510513 Time :  245
accuracy train: 0.803376 val: 0.764540 test: 0.780529
max validation accuracy : 0.774859 max acc epoch : 4 test accuracy : 0.776871
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.88862431049347 Time :  254
accuracy train: 0.803045 val: 0.774859 test: 0.781373
max validation accuracy : 0.774859 max acc epoch : 4 test accuracy : 0.776871
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  77.11979714035988 Time :  262
accuracy train: 0.808673 val: 0.775797 test: 0.783061
max validation accuracy : 0.775797 max acc epoch : 8 test accuracy : 0.783061
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.44069394469261 Time :  269
accuracy train: 0.801390 val: 0.761726 test: 0.777997
max validation accuracy : 0.775797 max acc epoch : 8 test accuracy : 0.783061
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.65859451889992 Time :  275
accuracy train: 0.818107 val: 0.781426 test: 0.782780
max validation accuracy : 0.781426 max acc epoch : 10 test accuracy : 0.782780

Epoch :  11 loss training:  74.58447943627834 Time :  286
accuracy train: 0.823734 val: 0.785178 test: 0.780529
max validation accuracy : 0.785178 max acc epoch : 11 test accuracy : 0.780529

Epoch :  12 loss training:  73.76794278621674 Time :  295
accuracy train: 0.827210 val: 0.784240 test: 0.779403
max validation accuracy : 0.785178 max acc epoch : 11 test accuracy : 0.780529

Epoch :  13 loss training:  71.58063334226608 Time :  304
accuracy train: 0.841609 val: 0.788931 test: 0.783343
max validation accuracy : 0.788931 max acc epoch : 13 test accuracy : 0.783343

Epoch :  14 loss training:  69.91049578785896 Time :  311
accuracy train: 0.849222 val: 0.794559 test: 0.785312
max validation accuracy : 0.794559 max acc epoch : 14 test accuracy : 0.785312

Epoch :  15 loss training:  67.85390809178352 Time :  317
accuracy train: 0.856670 val: 0.789869 test: 0.783343
max validation accuracy : 0.794559 max acc epoch : 14 test accuracy : 0.785312

Epoch :  16 loss training:  65.47939968109131 Time :  328
accuracy train: 0.858822 val: 0.785178 test: 0.783061
max validation accuracy : 0.794559 max acc epoch : 14 test accuracy : 0.785312

Epoch :  17 loss training:  63.36394986510277 Time :  337
accuracy train: 0.866766 val: 0.784240 test: 0.781092
max validation accuracy : 0.794559 max acc epoch : 14 test accuracy : 0.785312

Epoch :  18 loss training:  62.397475212812424 Time :  347
accuracy train: 0.880834 val: 0.781426 test: 0.781373
max validation accuracy : 0.794559 max acc epoch : 14 test accuracy : 0.785312

Epoch :  19 loss training:  60.68618433177471 Time :  353
accuracy train: 0.886627 val: 0.780488 test: 0.784187
max validation accuracy : 0.794559 max acc epoch : 14 test accuracy : 0.785312

Epoch :  20 loss training:  58.73197875916958 Time :  360
accuracy train: 0.899206 val: 0.789869 test: 0.785312
max validation accuracy : 0.794559 max acc epoch : 14 test accuracy : 0.785312

Epoch :  21 loss training:  56.634243950247765 Time :  371
accuracy train: 0.905660 val: 0.788931 test: 0.784750
max validation accuracy : 0.794559 max acc epoch : 14 test accuracy : 0.785312

Epoch :  22 loss training:  53.38739646226168 Time :  381
accuracy train: 0.909633 val: 0.784240 test: 0.781654
max validation accuracy : 0.794559 max acc epoch : 14 test accuracy : 0.785312

Epoch :  23 loss training:  52.34160099923611 Time :  392
accuracy train: 0.915094 val: 0.790807 test: 0.784750
max validation accuracy : 0.794559 max acc epoch : 14 test accuracy : 0.785312

Epoch :  24 loss training:  50.43198820948601 Time :  401
accuracy train: 0.920722 val: 0.788931 test: 0.781654
max validation accuracy : 0.794559 max acc epoch : 14 test accuracy : 0.785312

Epoch :  25 loss training:  48.24839832633734 Time :  413
accuracy train: 0.931976 val: 0.777674 test: 0.779122
max validation accuracy : 0.794559 max acc epoch : 14 test accuracy : 0.785312

========================================================================================================================================================================================================
best acc epoch :  14
validation accuracy :  0.7945590994371482
test accuracy :  0.7853123241418121
last test_accuracy :  0.7791221159257175
second best val :  0.7908067542213884
second best test :  0.7853123241418121
max gap 4
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=956, tsne=False, val_prop=0.15, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  97.17555582523346 Time :  424
accuracy train: 0.765475 val: 0.759850 test: 0.753799
max validation accuracy : 0.759850 max acc epoch : 1 test accuracy : 0.753799
Epoch-1 lr: 0.001

Epoch :  2 loss training:  90.2062636911869 Time :  435
accuracy train: 0.782853 val: 0.761726 test: 0.759989
max validation accuracy : 0.761726 max acc epoch : 2 test accuracy : 0.759989
Epoch-2 lr: 0.001

Epoch :  3 loss training:  86.50729894638062 Time :  445
accuracy train: 0.768454 val: 0.756098 test: 0.749297
max validation accuracy : 0.761726 max acc epoch : 2 test accuracy : 0.759989
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  82.2114389538765 Time :  456
accuracy train: 0.792618 val: 0.772983 test: 0.771244
max validation accuracy : 0.772983 max acc epoch : 4 test accuracy : 0.771244
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.8515716791153 Time :  466
accuracy train: 0.799735 val: 0.765478 test: 0.776871
max validation accuracy : 0.772983 max acc epoch : 4 test accuracy : 0.771244
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.6238756775856 Time :  475
accuracy train: 0.803707 val: 0.769231 test: 0.771806
max validation accuracy : 0.772983 max acc epoch : 4 test accuracy : 0.771244
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  78.26229760050774 Time :  486
accuracy train: 0.807514 val: 0.769231 test: 0.776871
max validation accuracy : 0.772983 max acc epoch : 4 test accuracy : 0.771244
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  77.8332094848156 Time :  495
accuracy train: 0.810990 val: 0.772983 test: 0.777153
max validation accuracy : 0.772983 max acc epoch : 4 test accuracy : 0.771244
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  78.3305811882019 Time :  507
accuracy train: 0.812148 val: 0.772045 test: 0.775746
max validation accuracy : 0.772983 max acc epoch : 4 test accuracy : 0.771244
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  76.1679536998272 Time :  516
accuracy train: 0.818107 val: 0.778612 test: 0.776308
max validation accuracy : 0.778612 max acc epoch : 10 test accuracy : 0.776308

Epoch :  11 loss training:  74.72619757056236 Time :  527
accuracy train: 0.822244 val: 0.777674 test: 0.776027
max validation accuracy : 0.778612 max acc epoch : 10 test accuracy : 0.776308

Epoch :  12 loss training:  74.65096843242645 Time :  537
accuracy train: 0.829527 val: 0.782364 test: 0.779685
max validation accuracy : 0.782364 max acc epoch : 12 test accuracy : 0.779685

Epoch :  13 loss training:  72.99973137676716 Time :  548
accuracy train: 0.838795 val: 0.775797 test: 0.778841
max validation accuracy : 0.782364 max acc epoch : 12 test accuracy : 0.779685

Epoch :  14 loss training:  71.140001937747 Time :  557
accuracy train: 0.844422 val: 0.774859 test: 0.784187
max validation accuracy : 0.782364 max acc epoch : 12 test accuracy : 0.779685

Epoch :  15 loss training:  69.01663911342621 Time :  568
accuracy train: 0.853029 val: 0.772045 test: 0.781654
max validation accuracy : 0.782364 max acc epoch : 12 test accuracy : 0.779685

Epoch :  16 loss training:  67.17453546822071 Time :  577
accuracy train: 0.862959 val: 0.782364 test: 0.786719
max validation accuracy : 0.782364 max acc epoch : 12 test accuracy : 0.779685

Epoch :  17 loss training:  65.72238226234913 Time :  589
accuracy train: 0.866435 val: 0.780488 test: 0.783624
max validation accuracy : 0.782364 max acc epoch : 12 test accuracy : 0.779685

Epoch :  18 loss training:  63.107942685484886 Time :  599
accuracy train: 0.876034 val: 0.774859 test: 0.788407
max validation accuracy : 0.782364 max acc epoch : 12 test accuracy : 0.779685

Epoch :  19 loss training:  60.784668907523155 Time :  611
accuracy train: 0.881331 val: 0.776735 test: 0.787282
max validation accuracy : 0.782364 max acc epoch : 12 test accuracy : 0.779685

Epoch :  20 loss training:  58.83107978105545 Time :  620
accuracy train: 0.885799 val: 0.772983 test: 0.784750
max validation accuracy : 0.782364 max acc epoch : 12 test accuracy : 0.779685

Epoch :  21 loss training:  57.625933572649956 Time :  631
accuracy train: 0.896061 val: 0.779550 test: 0.789814
max validation accuracy : 0.782364 max acc epoch : 12 test accuracy : 0.779685

Epoch :  22 loss training:  56.45777130126953 Time :  641
accuracy train: 0.902847 val: 0.779550 test: 0.788126
max validation accuracy : 0.782364 max acc epoch : 12 test accuracy : 0.779685

Epoch :  23 loss training:  53.89775861799717 Time :  651
accuracy train: 0.911288 val: 0.781426 test: 0.785875
max validation accuracy : 0.782364 max acc epoch : 12 test accuracy : 0.779685

========================================================================================================================================================================================================
best acc epoch :  12
validation accuracy :  0.7823639774859287
test accuracy :  0.7796848621271807
last test_accuracy :  0.7858750703432752
second best val :  0.7814258911819888
second best test :  0.7796848621271807
max gap 6
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=5, tsne=False, val_prop=0.15, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  97.67726796865463 Time :  661
accuracy train: 0.761668 val: 0.767355 test: 0.763928
max validation accuracy : 0.767355 max acc epoch : 1 test accuracy : 0.763928
Epoch-1 lr: 0.001

Epoch :  2 loss training:  88.33068466186523 Time :  673
accuracy train: 0.781364 val: 0.750469 test: 0.770400
max validation accuracy : 0.767355 max acc epoch : 1 test accuracy : 0.763928
Epoch-2 lr: 0.001

Epoch :  3 loss training:  84.29552994668484 Time :  682
accuracy train: 0.787819 val: 0.755159 test: 0.775183
max validation accuracy : 0.767355 max acc epoch : 1 test accuracy : 0.763928
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  83.31040841341019 Time :  692
accuracy train: 0.803211 val: 0.757974 test: 0.784750
max validation accuracy : 0.767355 max acc epoch : 1 test accuracy : 0.763928
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  82.1553650200367 Time :  702
accuracy train: 0.796260 val: 0.763602 test: 0.779122
max validation accuracy : 0.767355 max acc epoch : 1 test accuracy : 0.763928
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  81.26235643029213 Time :  712
accuracy train: 0.807349 val: 0.761726 test: 0.785031
max validation accuracy : 0.767355 max acc epoch : 1 test accuracy : 0.763928
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  78.30727660655975 Time :  722
accuracy train: 0.808011 val: 0.772045 test: 0.787001
max validation accuracy : 0.772045 max acc epoch : 7 test accuracy : 0.787001
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  78.33379110693932 Time :  733
accuracy train: 0.812976 val: 0.765478 test: 0.784750
max validation accuracy : 0.772045 max acc epoch : 7 test accuracy : 0.787001
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.97068628668785 Time :  742
accuracy train: 0.815458 val: 0.772983 test: 0.781654
max validation accuracy : 0.772983 max acc epoch : 9 test accuracy : 0.781654
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.48033247888088 Time :  752
accuracy train: 0.819100 val: 0.771107 test: 0.782499
max validation accuracy : 0.772983 max acc epoch : 9 test accuracy : 0.781654

Epoch :  11 loss training:  74.81610947847366 Time :  761
accuracy train: 0.825058 val: 0.774859 test: 0.783905
max validation accuracy : 0.774859 max acc epoch : 11 test accuracy : 0.783905

Epoch :  12 loss training:  73.61510062217712 Time :  771
accuracy train: 0.829361 val: 0.776735 test: 0.783061
max validation accuracy : 0.776735 max acc epoch : 12 test accuracy : 0.783061

Epoch :  13 loss training:  71.98669368028641 Time :  780
accuracy train: 0.841940 val: 0.779550 test: 0.787563
max validation accuracy : 0.779550 max acc epoch : 13 test accuracy : 0.787563

Epoch :  14 loss training:  68.91506047546864 Time :  789
accuracy train: 0.845250 val: 0.781426 test: 0.787845
max validation accuracy : 0.781426 max acc epoch : 14 test accuracy : 0.787845

Epoch :  15 loss training:  68.64460557699203 Time :  799
accuracy train: 0.856339 val: 0.786116 test: 0.787845
max validation accuracy : 0.786116 max acc epoch : 15 test accuracy : 0.787845

Epoch :  16 loss training:  65.93039251863956 Time :  808
accuracy train: 0.861635 val: 0.790807 test: 0.786719
max validation accuracy : 0.790807 max acc epoch : 16 test accuracy : 0.786719

Epoch :  17 loss training:  64.43467001616955 Time :  817
accuracy train: 0.867759 val: 0.788931 test: 0.788126
max validation accuracy : 0.790807 max acc epoch : 16 test accuracy : 0.786719

Epoch :  18 loss training:  62.6695541292429 Time :  827
accuracy train: 0.875703 val: 0.782364 test: 0.786156
max validation accuracy : 0.790807 max acc epoch : 16 test accuracy : 0.786719

Epoch :  19 loss training:  61.00049747526646 Time :  836
accuracy train: 0.887123 val: 0.788931 test: 0.787001
max validation accuracy : 0.790807 max acc epoch : 16 test accuracy : 0.786719

Epoch :  20 loss training:  58.777945682406425 Time :  845
accuracy train: 0.894240 val: 0.788931 test: 0.786156
max validation accuracy : 0.790807 max acc epoch : 16 test accuracy : 0.786719

Epoch :  21 loss training:  57.5603234320879 Time :  855
accuracy train: 0.903343 val: 0.789869 test: 0.783624
max validation accuracy : 0.790807 max acc epoch : 16 test accuracy : 0.786719

Epoch :  22 loss training:  54.28574773669243 Time :  864
accuracy train: 0.908143 val: 0.787054 test: 0.783905
max validation accuracy : 0.790807 max acc epoch : 16 test accuracy : 0.786719

Epoch :  23 loss training:  52.63715768605471 Time :  873
accuracy train: 0.918073 val: 0.787054 test: 0.783905
max validation accuracy : 0.790807 max acc epoch : 16 test accuracy : 0.786719

Epoch :  24 loss training:  50.86451941728592 Time :  883
accuracy train: 0.920391 val: 0.789869 test: 0.783061
max validation accuracy : 0.790807 max acc epoch : 16 test accuracy : 0.786719

Epoch :  25 loss training:  49.82357896119356 Time :  892
accuracy train: 0.930487 val: 0.785178 test: 0.785312
max validation accuracy : 0.790807 max acc epoch : 16 test accuracy : 0.786719

Epoch :  26 loss training:  48.369048707187176 Time :  902
accuracy train: 0.934790 val: 0.786116 test: 0.779403
max validation accuracy : 0.790807 max acc epoch : 16 test accuracy : 0.786719

Epoch :  27 loss training:  46.21117625385523 Time :  912
accuracy train: 0.940914 val: 0.787992 test: 0.782780
max validation accuracy : 0.790807 max acc epoch : 16 test accuracy : 0.786719

========================================================================================================================================================================================================
best acc epoch :  16
validation accuracy :  0.7908067542213884
test accuracy :  0.7867191896454699
last test_accuracy :  0.7827799662352279
second best val :  0.7898686679174484
second best test :  0.7867191896454699
max gap 6
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  8 	 val_accuracy : 0.79831 	 test_accuracy : 0.77518 	 last test_accuracy : 0.77743 	 second best val : 0.79737 	 second best test : 0.77518
k :  1 	 best_acc epoch :  14 	 val_accuracy : 0.79456 	 test_accuracy : 0.78531 	 last test_accuracy : 0.77912 	 second best val : 0.79081 	 second best test : 0.78531
k :  2 	 best_acc epoch :  12 	 val_accuracy : 0.78236 	 test_accuracy : 0.77968 	 last test_accuracy : 0.78588 	 second best val : 0.78143 	 second best test : 0.77968
k :  3 	 best_acc epoch :  16 	 val_accuracy : 0.79081 	 test_accuracy : 0.78672 	 last test_accuracy : 0.78278 	 second best val : 0.78987 	 second best test : 0.78672

avg :  	 val_accuracy : 0.79151 	 test_accuracy : 0.78172 	 last_accuracy : 0.78130 	 second best val : 0.78987 	 second best test : 0.78172

std :  	 val_accuracy : 0.00591 	 test_accuracy : 0.00460 	 last_accuracy : 0.00327 	 second best val : 0.00567 	 second best test : 0.00460


date and time :  Sat Jul  3 18:10:15 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=890, tsne=False, val_prop=0.15, weight_decay=1e-10)
device :  cuda:0
Counter({1: 6188, 0: 4474})

Epoch :  1 loss training:  96.32178992033005 Time :  13
accuracy train: 0.759186 val: 0.724203 test: 0.748734
max validation accuracy : 0.724203 max acc epoch : 1 test accuracy : 0.748734
Counter({1: 6370, 0: 4292})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  88.13224935531616 Time :  26
accuracy train: 0.768289 val: 0.761726 test: 0.766179
max validation accuracy : 0.761726 max acc epoch : 2 test accuracy : 0.766179
Counter({1: 5779, 0: 4883})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  88.06402462720871 Time :  38
accuracy train: 0.786660 val: 0.772045 test: 0.768711
max validation accuracy : 0.772045 max acc epoch : 3 test accuracy : 0.768711
Counter({1: 5542, 0: 5120})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  79.99110206961632 Time :  51
accuracy train: 0.794770 val: 0.778612 test: 0.771244
max validation accuracy : 0.778612 max acc epoch : 4 test accuracy : 0.771244
Counter({1: 5535, 0: 5127})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  78.55833396315575 Time :  64
accuracy train: 0.797749 val: 0.758912 test: 0.773213
max validation accuracy : 0.778612 max acc epoch : 4 test accuracy : 0.771244
Counter({1: 5562, 0: 5100})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  78.81995868682861 Time :  77
accuracy train: 0.799901 val: 0.759850 test: 0.768711
max validation accuracy : 0.778612 max acc epoch : 4 test accuracy : 0.771244
Counter({1: 5563, 0: 5099})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  76.95750278234482 Time :  91
accuracy train: 0.810990 val: 0.757974 test: 0.776590
max validation accuracy : 0.778612 max acc epoch : 4 test accuracy : 0.771244
Counter({0: 5637, 1: 5025})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.24968813359737 Time :  104
accuracy train: 0.808011 val: 0.768293 test: 0.774620
max validation accuracy : 0.778612 max acc epoch : 4 test accuracy : 0.771244
Counter({1: 5583, 0: 5079})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.64125716686249 Time :  117
accuracy train: 0.808342 val: 0.767355 test: 0.773495
max validation accuracy : 0.778612 max acc epoch : 4 test accuracy : 0.771244
Counter({1: 5678, 0: 4984})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  74.91912597417831 Time :  130
accuracy train: 0.812645 val: 0.764540 test: 0.772651
max validation accuracy : 0.778612 max acc epoch : 4 test accuracy : 0.771244
Counter({0: 5671, 1: 4991})

Epoch :  11 loss training:  73.62843176722527 Time :  143
accuracy train: 0.810659 val: 0.768293 test: 0.768993
max validation accuracy : 0.778612 max acc epoch : 4 test accuracy : 0.771244
Counter({0: 5667, 1: 4995})

Epoch :  12 loss training:  73.34318493306637 Time :  157
accuracy train: 0.825058 val: 0.762664 test: 0.774620
max validation accuracy : 0.778612 max acc epoch : 4 test accuracy : 0.771244
Counter({0: 5702, 1: 4960})

Epoch :  13 loss training:  71.32944744825363 Time :  170
accuracy train: 0.833830 val: 0.765478 test: 0.774057
max validation accuracy : 0.778612 max acc epoch : 4 test accuracy : 0.771244
Counter({0: 5705, 1: 4957})

Epoch :  14 loss training:  68.62436462938786 Time :  183
accuracy train: 0.842602 val: 0.769231 test: 0.775746
max validation accuracy : 0.778612 max acc epoch : 4 test accuracy : 0.771244
Counter({0: 5731, 1: 4931})

Epoch :  15 loss training:  67.5962491184473 Time :  196
accuracy train: 0.847898 val: 0.762664 test: 0.777715
max validation accuracy : 0.778612 max acc epoch : 4 test accuracy : 0.771244
Counter({1: 5746, 0: 4916})

========================================================================================================================================================================================================
best acc epoch :  4
validation accuracy :  0.7786116322701688
test accuracy :  0.7712436691052336
last test_accuracy :  0.7777152504220597
second best val :  0.7720450281425891
second best test :  0.7687113111986494
max gap 1
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=487, tsne=False, val_prop=0.15, weight_decay=1e-10)
device :  cuda:0
Counter({0: 6226, 1: 4436})

Epoch :  1 loss training:  97.28926798701286 Time :  212
accuracy train: 0.778385 val: 0.754221 test: 0.765898
max validation accuracy : 0.754221 max acc epoch : 1 test accuracy : 0.765898
Counter({1: 6165, 0: 4497})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  88.24425837397575 Time :  226
accuracy train: 0.782026 val: 0.754221 test: 0.769274
max validation accuracy : 0.754221 max acc epoch : 1 test accuracy : 0.765898
Counter({1: 5946, 0: 4716})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  85.50350508093834 Time :  239
accuracy train: 0.785005 val: 0.763602 test: 0.765616
max validation accuracy : 0.763602 max acc epoch : 3 test accuracy : 0.765616
Counter({0: 5562, 1: 5100})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.41199404001236 Time :  252
accuracy train: 0.793611 val: 0.762664 test: 0.778841
max validation accuracy : 0.763602 max acc epoch : 3 test accuracy : 0.765616
Counter({0: 5561, 1: 5101})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  79.58320146799088 Time :  265
accuracy train: 0.799901 val: 0.754221 test: 0.771525
max validation accuracy : 0.763602 max acc epoch : 3 test accuracy : 0.765616
Counter({1: 5495, 0: 5167})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.45640587806702 Time :  279
accuracy train: 0.799735 val: 0.765478 test: 0.775464
max validation accuracy : 0.765478 max acc epoch : 6 test accuracy : 0.775464
Counter({1: 5405, 0: 5257})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.62272670865059 Time :  292
accuracy train: 0.802218 val: 0.767355 test: 0.773776
max validation accuracy : 0.767355 max acc epoch : 7 test accuracy : 0.773776
Counter({1: 5395, 0: 5267})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  77.39601908624172 Time :  305
accuracy train: 0.807183 val: 0.763602 test: 0.776308
max validation accuracy : 0.767355 max acc epoch : 7 test accuracy : 0.773776
Counter({1: 5350, 0: 5312})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  75.91873648762703 Time :  318
accuracy train: 0.809831 val: 0.772983 test: 0.774620
max validation accuracy : 0.772983 max acc epoch : 9 test accuracy : 0.774620
Counter({1: 5348, 0: 5314})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.02702850103378 Time :  331
accuracy train: 0.816120 val: 0.769231 test: 0.774057
max validation accuracy : 0.772983 max acc epoch : 9 test accuracy : 0.774620
Counter({0: 5366, 1: 5296})

Epoch :  11 loss training:  74.79684872925282 Time :  342
accuracy train: 0.819265 val: 0.772983 test: 0.772932
max validation accuracy : 0.772983 max acc epoch : 9 test accuracy : 0.774620
Counter({0: 5348, 1: 5314})

Epoch :  12 loss training:  73.16634652018547 Time :  356
accuracy train: 0.826713 val: 0.777674 test: 0.776590
max validation accuracy : 0.777674 max acc epoch : 12 test accuracy : 0.776590
Counter({1: 5348, 0: 5314})

Epoch :  13 loss training:  72.80819711089134 Time :  369
accuracy train: 0.830354 val: 0.775797 test: 0.776308
max validation accuracy : 0.777674 max acc epoch : 12 test accuracy : 0.776590
Counter({0: 5344, 1: 5318})

Epoch :  14 loss training:  69.88403508067131 Time :  383
accuracy train: 0.835981 val: 0.776735 test: 0.773213
max validation accuracy : 0.777674 max acc epoch : 12 test accuracy : 0.776590
Counter({1: 5334, 0: 5328})

Epoch :  15 loss training:  67.08802400529385 Time :  395
accuracy train: 0.844588 val: 0.782364 test: 0.782780
max validation accuracy : 0.782364 max acc epoch : 15 test accuracy : 0.782780
Counter({0: 5348, 1: 5314})

Epoch :  16 loss training:  66.40207953751087 Time :  409
accuracy train: 0.857332 val: 0.786116 test: 0.786438
max validation accuracy : 0.786116 max acc epoch : 16 test accuracy : 0.786438
Counter({0: 5333, 1: 5329})

Epoch :  17 loss training:  63.91352413594723 Time :  422
accuracy train: 0.862794 val: 0.775797 test: 0.774902
max validation accuracy : 0.786116 max acc epoch : 16 test accuracy : 0.786438
Counter({0: 5361, 1: 5301})

Epoch :  18 loss training:  61.715260937809944 Time :  435
accuracy train: 0.873386 val: 0.787054 test: 0.780810
max validation accuracy : 0.787054 max acc epoch : 18 test accuracy : 0.780810
Counter({0: 5378, 1: 5284})

Epoch :  19 loss training:  61.44411091506481 Time :  448
accuracy train: 0.882820 val: 0.789869 test: 0.780248
max validation accuracy : 0.789869 max acc epoch : 19 test accuracy : 0.780248
Counter({0: 5400, 1: 5262})

Epoch :  20 loss training:  59.43397615849972 Time :  462
accuracy train: 0.886792 val: 0.792683 test: 0.778559
max validation accuracy : 0.792683 max acc epoch : 20 test accuracy : 0.778559
Counter({0: 5392, 1: 5270})

Epoch :  21 loss training:  56.104084834456444 Time :  476
accuracy train: 0.896888 val: 0.793621 test: 0.779685
max validation accuracy : 0.793621 max acc epoch : 21 test accuracy : 0.779685
Counter({0: 5412, 1: 5250})

Epoch :  22 loss training:  54.89118526875973 Time :  489
accuracy train: 0.902681 val: 0.791745 test: 0.776871
max validation accuracy : 0.793621 max acc epoch : 21 test accuracy : 0.779685
Counter({0: 5427, 1: 5235})

Epoch :  23 loss training:  52.398362189531326 Time :  502
accuracy train: 0.913274 val: 0.788931 test: 0.778278
max validation accuracy : 0.793621 max acc epoch : 21 test accuracy : 0.779685
Counter({0: 5486, 1: 5176})

Epoch :  24 loss training:  50.28796562552452 Time :  516
accuracy train: 0.921053 val: 0.787992 test: 0.777715
max validation accuracy : 0.793621 max acc epoch : 21 test accuracy : 0.779685
Counter({1: 5530, 0: 5132})

Epoch :  25 loss training:  47.935322143137455 Time :  529
accuracy train: 0.929494 val: 0.789869 test: 0.780529
max validation accuracy : 0.793621 max acc epoch : 21 test accuracy : 0.779685
Counter({0: 5540, 1: 5122})

Epoch :  26 loss training:  45.35622179508209 Time :  543
accuracy train: 0.930983 val: 0.788931 test: 0.781654
max validation accuracy : 0.793621 max acc epoch : 21 test accuracy : 0.779685
Counter({0: 5591, 1: 5071})

Epoch :  27 loss training:  45.35437923669815 Time :  557
accuracy train: 0.932804 val: 0.785178 test: 0.775464
max validation accuracy : 0.793621 max acc epoch : 21 test accuracy : 0.779685
Counter({0: 5628, 1: 5034})

Epoch :  28 loss training:  44.85480144619942 Time :  570
accuracy train: 0.937934 val: 0.784240 test: 0.770400
max validation accuracy : 0.793621 max acc epoch : 21 test accuracy : 0.779685
Counter({0: 5628, 1: 5034})

Epoch :  29 loss training:  41.92832117527723 Time :  583
accuracy train: 0.946375 val: 0.787992 test: 0.777997
max validation accuracy : 0.793621 max acc epoch : 21 test accuracy : 0.779685
Counter({0: 5635, 1: 5027})

Epoch :  30 loss training:  41.312251806259155 Time :  597
accuracy train: 0.951341 val: 0.785178 test: 0.774339
max validation accuracy : 0.793621 max acc epoch : 21 test accuracy : 0.779685
Counter({1: 5680, 0: 4982})

Epoch :  31 loss training:  38.190106835216284 Time :  610
accuracy train: 0.954816 val: 0.785178 test: 0.773776
max validation accuracy : 0.793621 max acc epoch : 21 test accuracy : 0.779685
Counter({0: 5749, 1: 4913})

Epoch :  32 loss training:  36.821067199110985 Time :  624
accuracy train: 0.960113 val: 0.785178 test: 0.769555
max validation accuracy : 0.793621 max acc epoch : 21 test accuracy : 0.779685
Counter({0: 5744, 1: 4918})

========================================================================================================================================================================================================
best acc epoch :  21
validation accuracy :  0.7936210131332082
test accuracy :  0.7796848621271807
last test_accuracy :  0.7695554305008441
second best val :  0.7926829268292683
second best test :  0.7785593697242543
max gap 3
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=377, tsne=False, val_prop=0.15, weight_decay=1e-10)
device :  cuda:0
Counter({0: 6193, 1: 4469})

Epoch :  1 loss training:  97.68191802501678 Time :  640
accuracy train: 0.764647 val: 0.749531 test: 0.757456
max validation accuracy : 0.749531 max acc epoch : 1 test accuracy : 0.757456
Counter({0: 6154, 1: 4508})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  88.33249267935753 Time :  653
accuracy train: 0.783846 val: 0.758912 test: 0.768149
max validation accuracy : 0.758912 max acc epoch : 2 test accuracy : 0.768149
Counter({1: 5774, 0: 4888})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  86.30434700846672 Time :  666
accuracy train: 0.788646 val: 0.760788 test: 0.773776
max validation accuracy : 0.760788 max acc epoch : 3 test accuracy : 0.773776
Counter({0: 5891, 1: 4771})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.89476582407951 Time :  679
accuracy train: 0.790963 val: 0.768293 test: 0.774902
max validation accuracy : 0.768293 max acc epoch : 4 test accuracy : 0.774902
Counter({1: 5916, 0: 4746})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  81.5691037774086 Time :  692
accuracy train: 0.801887 val: 0.758912 test: 0.774339
max validation accuracy : 0.768293 max acc epoch : 4 test accuracy : 0.774902
Counter({1: 6170, 0: 4492})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.84354785084724 Time :  705
accuracy train: 0.795597 val: 0.745779 test: 0.761114
max validation accuracy : 0.768293 max acc epoch : 4 test accuracy : 0.774902
Counter({0: 6258, 1: 4404})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.78614395856857 Time :  718
accuracy train: 0.802218 val: 0.763602 test: 0.767867
max validation accuracy : 0.768293 max acc epoch : 4 test accuracy : 0.774902
Counter({0: 6411, 1: 4251})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.76322042942047 Time :  731
accuracy train: 0.804535 val: 0.752345 test: 0.769837
max validation accuracy : 0.768293 max acc epoch : 4 test accuracy : 0.774902
Counter({1: 6510, 0: 4152})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  75.79880073666573 Time :  744
accuracy train: 0.816783 val: 0.757974 test: 0.774620
max validation accuracy : 0.768293 max acc epoch : 4 test accuracy : 0.774902
Counter({1: 6596, 0: 4066})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  74.46034698188305 Time :  758
accuracy train: 0.816783 val: 0.762664 test: 0.778559
max validation accuracy : 0.768293 max acc epoch : 4 test accuracy : 0.774902
Counter({1: 6614, 0: 4048})

Epoch :  11 loss training:  75.55404344201088 Time :  771
accuracy train: 0.816617 val: 0.767355 test: 0.775464
max validation accuracy : 0.768293 max acc epoch : 4 test accuracy : 0.774902
Counter({1: 6646, 0: 4016})

Epoch :  12 loss training:  72.07047799229622 Time :  784
accuracy train: 0.834492 val: 0.759850 test: 0.781373
max validation accuracy : 0.768293 max acc epoch : 4 test accuracy : 0.774902
Counter({0: 6604, 1: 4058})

Epoch :  13 loss training:  71.2494506239891 Time :  798
accuracy train: 0.843429 val: 0.757036 test: 0.775746
max validation accuracy : 0.768293 max acc epoch : 4 test accuracy : 0.774902
Counter({1: 6522, 0: 4140})

Epoch :  14 loss training:  69.53536988794804 Time :  811
accuracy train: 0.846739 val: 0.758912 test: 0.778841
max validation accuracy : 0.768293 max acc epoch : 4 test accuracy : 0.774902
Counter({1: 6513, 0: 4149})

Epoch :  15 loss training:  68.18248046934605 Time :  825
accuracy train: 0.858160 val: 0.757974 test: 0.784187
max validation accuracy : 0.768293 max acc epoch : 4 test accuracy : 0.774902
Counter({0: 6202, 1: 4460})

========================================================================================================================================================================================================
best acc epoch :  4
validation accuracy :  0.7682926829268293
test accuracy :  0.7749015194147439
last test_accuracy :  0.7841868317388858
second best val :  0.7673545966228893
second best test :  0.7749015194147439
max gap 1
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=409, tsne=False, val_prop=0.15, weight_decay=1e-10)
device :  cuda:0
Counter({0: 6215, 1: 4447})

Epoch :  1 loss training:  97.23239049315453 Time :  846
accuracy train: 0.774412 val: 0.749531 test: 0.767867
max validation accuracy : 0.749531 max acc epoch : 1 test accuracy : 0.767867
Counter({0: 6400, 1: 4262})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.88477009534836 Time :  861
accuracy train: 0.774578 val: 0.727955 test: 0.754080
max validation accuracy : 0.749531 max acc epoch : 1 test accuracy : 0.767867
Counter({0: 6186, 1: 4476})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  84.87245059013367 Time :  875
accuracy train: 0.762330 val: 0.721388 test: 0.743388
max validation accuracy : 0.749531 max acc epoch : 1 test accuracy : 0.767867
Counter({0: 6170, 1: 4492})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  80.9410329759121 Time :  888
accuracy train: 0.797418 val: 0.764540 test: 0.773776
max validation accuracy : 0.764540 max acc epoch : 4 test accuracy : 0.773776
Counter({1: 6170, 0: 4492})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.36607418954372 Time :  902
accuracy train: 0.805362 val: 0.768293 test: 0.769837
max validation accuracy : 0.768293 max acc epoch : 5 test accuracy : 0.769837
Counter({1: 6170, 0: 4492})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  78.44994848966599 Time :  914
accuracy train: 0.806852 val: 0.775797 test: 0.776871
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.776871
Counter({0: 6170, 1: 4492})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.17157936096191 Time :  928
accuracy train: 0.815624 val: 0.769231 test: 0.774902
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.776871
Counter({1: 6170, 0: 4492})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.80770067870617 Time :  941
accuracy train: 0.818272 val: 0.759850 test: 0.776027
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.776871
Counter({1: 6170, 0: 4492})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.68940389156342 Time :  954
accuracy train: 0.819596 val: 0.772983 test: 0.775183
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.776871
Counter({1: 6170, 0: 4492})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  76.34425473213196 Time :  968
accuracy train: 0.818107 val: 0.768293 test: 0.775746
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.776871
Counter({1: 6170, 0: 4492})

Epoch :  11 loss training:  75.00893649458885 Time :  981
accuracy train: 0.828865 val: 0.769231 test: 0.775464
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.776871
Counter({1: 6170, 0: 4492})

Epoch :  12 loss training:  73.40699565410614 Time :  997
accuracy train: 0.828368 val: 0.771107 test: 0.777715
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.776871
Counter({1: 6170, 0: 4492})

Epoch :  13 loss training:  70.87350353598595 Time :  1010
accuracy train: 0.842767 val: 0.771107 test: 0.779685
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.776871
Counter({1: 6170, 0: 4492})

Epoch :  14 loss training:  69.58447532355785 Time :  1024
accuracy train: 0.852863 val: 0.777674 test: 0.781373
max validation accuracy : 0.777674 max acc epoch : 14 test accuracy : 0.781373
Counter({1: 6170, 0: 4492})

Epoch :  15 loss training:  66.8897535353899 Time :  1037
accuracy train: 0.858656 val: 0.783302 test: 0.783905
max validation accuracy : 0.783302 max acc epoch : 15 test accuracy : 0.783905
Counter({1: 6170, 0: 4492})

Epoch :  16 loss training:  65.38359022140503 Time :  1053
accuracy train: 0.868918 val: 0.780488 test: 0.783343
max validation accuracy : 0.783302 max acc epoch : 15 test accuracy : 0.783905
Counter({1: 6170, 0: 4492})

Epoch :  17 loss training:  64.2113970220089 Time :  1065
accuracy train: 0.874876 val: 0.776735 test: 0.782499
max validation accuracy : 0.783302 max acc epoch : 15 test accuracy : 0.783905
Counter({1: 6170, 0: 4492})

Epoch :  18 loss training:  61.328926622867584 Time :  1079
accuracy train: 0.887951 val: 0.781426 test: 0.785031
max validation accuracy : 0.783302 max acc epoch : 15 test accuracy : 0.783905
Counter({0: 6170, 1: 4492})

Epoch :  19 loss training:  58.6135568022728 Time :  1092
accuracy train: 0.894240 val: 0.773921 test: 0.781936
max validation accuracy : 0.783302 max acc epoch : 15 test accuracy : 0.783905
Counter({1: 6170, 0: 4492})

Epoch :  20 loss training:  57.33607056736946 Time :  1108
accuracy train: 0.901854 val: 0.767355 test: 0.783343
max validation accuracy : 0.783302 max acc epoch : 15 test accuracy : 0.783905
Counter({1: 6170, 0: 4492})

Epoch :  21 loss training:  55.70981175452471 Time :  1121
accuracy train: 0.908805 val: 0.770169 test: 0.784750
max validation accuracy : 0.783302 max acc epoch : 15 test accuracy : 0.783905
Counter({1: 6170, 0: 4492})

Epoch :  22 loss training:  54.625616908073425 Time :  1135
accuracy train: 0.916253 val: 0.772983 test: 0.785594
max validation accuracy : 0.783302 max acc epoch : 15 test accuracy : 0.783905
Counter({1: 6170, 0: 4492})

Epoch :  23 loss training:  50.82351253926754 Time :  1148
accuracy train: 0.924528 val: 0.775797 test: 0.786438
max validation accuracy : 0.783302 max acc epoch : 15 test accuracy : 0.783905
Counter({1: 6170, 0: 4492})

Epoch :  24 loss training:  50.395890176296234 Time :  1163
accuracy train: 0.928169 val: 0.773921 test: 0.787282
max validation accuracy : 0.783302 max acc epoch : 15 test accuracy : 0.783905
Counter({1: 6176, 0: 4486})

Epoch :  25 loss training:  47.490553610026836 Time :  1178
accuracy train: 0.933135 val: 0.782364 test: 0.792065
max validation accuracy : 0.783302 max acc epoch : 15 test accuracy : 0.783905
Counter({1: 6172, 0: 4490})

Epoch :  26 loss training:  45.11889258027077 Time :  1191
accuracy train: 0.939259 val: 0.775797 test: 0.789252
max validation accuracy : 0.783302 max acc epoch : 15 test accuracy : 0.783905
Counter({0: 6176, 1: 4486})

========================================================================================================================================================================================================
best acc epoch :  15
validation accuracy :  0.7833020637898687
test accuracy :  0.7839054586381542
last test_accuracy :  0.7892515475520541
second best val :  0.7823639774859287
second best test :  0.7839054586381542
max gap 8
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  4 	 val_accuracy : 0.77861 	 test_accuracy : 0.77124 	 last test_accuracy : 0.77772 	 second best val : 0.77205 	 second best test : 0.76871
k :  1 	 best_acc epoch :  21 	 val_accuracy : 0.79362 	 test_accuracy : 0.77968 	 last test_accuracy : 0.76956 	 second best val : 0.79268 	 second best test : 0.77856
k :  2 	 best_acc epoch :  4 	 val_accuracy : 0.76829 	 test_accuracy : 0.77490 	 last test_accuracy : 0.78419 	 second best val : 0.76735 	 second best test : 0.77490
k :  3 	 best_acc epoch :  15 	 val_accuracy : 0.78330 	 test_accuracy : 0.78391 	 last test_accuracy : 0.78925 	 second best val : 0.78236 	 second best test : 0.78391

avg :  	 val_accuracy : 0.78096 	 test_accuracy : 0.77743 	 last_accuracy : 0.78018 	 second best val : 0.77861 	 second best test : 0.77652

std :  	 val_accuracy : 0.00911 	 test_accuracy : 0.00479 	 last_accuracy : 0.00737 	 second best val : 0.00977 	 second best test : 0.00553
