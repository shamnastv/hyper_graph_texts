

date and time :  Fri May 21 10:46:49 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=501, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  90.1165660917759 Time :  307
accuracy train: 0.781651 val: 0.735211 test: 0.757456
max validation accuracy : 0.735211 max acc epoch : 1 test accuracy : 0.757456
Epoch-1 lr: 0.001

Epoch :  2 loss training:  85.08201488852501 Time :  316
accuracy train: 0.789309 val: 0.747887 test: 0.758582
max validation accuracy : 0.747887 max acc epoch : 2 test accuracy : 0.758582
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.29707948863506 Time :  325
accuracy train: 0.803845 val: 0.754930 test: 0.772369
max validation accuracy : 0.754930 max acc epoch : 3 test accuracy : 0.772369
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.60023853182793 Time :  333
accuracy train: 0.824945 val: 0.760563 test: 0.779966
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.779966
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.15039251744747 Time :  342
accuracy train: 0.832917 val: 0.764789 test: 0.778278
max validation accuracy : 0.764789 max acc epoch : 5 test accuracy : 0.778278
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.78579725325108 Time :  352
accuracy train: 0.834948 val: 0.754930 test: 0.776027
max validation accuracy : 0.764789 max acc epoch : 5 test accuracy : 0.778278
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.27528548240662 Time :  361
accuracy train: 0.854642 val: 0.773239 test: 0.774620
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.71903964877129 Time :  369
accuracy train: 0.862770 val: 0.770423 test: 0.779122
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.385749250650406 Time :  377
accuracy train: 0.872773 val: 0.763380 test: 0.770962
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.729200690984726 Time :  385
accuracy train: 0.874492 val: 0.750704 test: 0.775464
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.64189174771309 Time :  394
accuracy train: 0.881838 val: 0.766197 test: 0.774339
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.77301163971424 Time :  404
accuracy train: 0.882151 val: 0.754930 test: 0.770400
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  58.59202195703983 Time :  412
accuracy train: 0.887152 val: 0.753521 test: 0.774339
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.3932279497385 Time :  421
accuracy train: 0.889966 val: 0.767606 test: 0.768711
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  57.353998452425 Time :  435
accuracy train: 0.889809 val: 0.760563 test: 0.771525
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620

Epoch :  16 loss training:  57.42384400963783 Time :  451
accuracy train: 0.897937 val: 0.763380 test: 0.775746
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620

Epoch :  17 loss training:  56.46389415860176 Time :  462
accuracy train: 0.904658 val: 0.756338 test: 0.775464
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620

Epoch :  18 loss training:  53.41237910091877 Time :  470
accuracy train: 0.908878 val: 0.763380 test: 0.773213
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620

Epoch :  19 loss training:  52.56817536056042 Time :  480
accuracy train: 0.914661 val: 0.752113 test: 0.769555
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620

Epoch :  20 loss training:  50.34035920351744 Time :  489
accuracy train: 0.920288 val: 0.760563 test: 0.772651
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620

Epoch :  21 loss training:  49.128543719649315 Time :  497
accuracy train: 0.925133 val: 0.761972 test: 0.770118
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620

Epoch :  22 loss training:  47.59518429636955 Time :  506
accuracy train: 0.935292 val: 0.766197 test: 0.766460
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620

Epoch :  23 loss training:  46.198245629668236 Time :  514
accuracy train: 0.940138 val: 0.761972 test: 0.768149
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620

Epoch :  24 loss training:  44.15676534175873 Time :  523
accuracy train: 0.942951 val: 0.760563 test: 0.769837
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620

Epoch :  25 loss training:  43.06993901729584 Time :  532
accuracy train: 0.945764 val: 0.763380 test: 0.771525
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620

Epoch :  26 loss training:  42.08436018973589 Time :  540
accuracy train: 0.953267 val: 0.761972 test: 0.774902
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620

Epoch :  27 loss training:  40.023210011422634 Time :  549
accuracy train: 0.959831 val: 0.760563 test: 0.778841
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620

Epoch :  28 loss training:  39.110292121768 Time :  557
accuracy train: 0.964051 val: 0.766197 test: 0.772369
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620

Epoch :  29 loss training:  36.536500319838524 Time :  567
accuracy train: 0.965458 val: 0.759155 test: 0.772369
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620

Epoch :  30 loss training:  36.270418748259544 Time :  581
accuracy train: 0.969678 val: 0.771831 test: 0.772932
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620

Epoch :  31 loss training:  34.84214213117957 Time :  592
accuracy train: 0.972960 val: 0.761972 test: 0.772369
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620

Epoch :  32 loss training:  33.70672012120485 Time :  607
accuracy train: 0.974211 val: 0.771831 test: 0.770400
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620

Epoch :  33 loss training:  32.50878830626607 Time :  616
accuracy train: 0.974992 val: 0.760563 test: 0.773213
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620

Epoch :  34 loss training:  30.50734007358551 Time :  624
accuracy train: 0.980932 val: 0.752113 test: 0.771244
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620

Epoch :  35 loss training:  29.086862336844206 Time :  632
accuracy train: 0.981557 val: 0.750704 test: 0.772088
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620

Epoch :  36 loss training:  29.159177573397756 Time :  640
accuracy train: 0.984683 val: 0.746479 test: 0.771806
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620

Epoch :  37 loss training:  28.038851529359818 Time :  648
accuracy train: 0.986089 val: 0.752113 test: 0.768711
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620

Epoch :  38 loss training:  25.94497574493289 Time :  656
accuracy train: 0.987183 val: 0.753521 test: 0.766460
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774620

========================================================================================================================================================================================================
max acc epoch :  7
max validation accuracy :  0.7732394366197183
test accuracy :  0.7746201463140123
last test_accuracy :  0.7664603263927968
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=501, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  90.17713239789009 Time :  893
accuracy train: 0.781025 val: 0.742254 test: 0.756894
max validation accuracy : 0.742254 max acc epoch : 1 test accuracy : 0.756894
Epoch-1 lr: 0.001

Epoch :  2 loss training:  85.52551263570786 Time :  906
accuracy train: 0.786652 val: 0.740845 test: 0.762802
max validation accuracy : 0.742254 max acc epoch : 1 test accuracy : 0.756894
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.01815454661846 Time :  919
accuracy train: 0.802907 val: 0.747887 test: 0.770681
max validation accuracy : 0.747887 max acc epoch : 3 test accuracy : 0.770681
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.74738699197769 Time :  928
accuracy train: 0.820256 val: 0.760563 test: 0.774620
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.774620
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.49536511301994 Time :  938
accuracy train: 0.829947 val: 0.773239 test: 0.779685
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.779685
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.72701892256737 Time :  949
accuracy train: 0.834792 val: 0.764789 test: 0.773495
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.779685
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.73659293353558 Time :  958
accuracy train: 0.845108 val: 0.766197 test: 0.773495
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.779685
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.0347539037466 Time :  968
accuracy train: 0.859018 val: 0.774648 test: 0.777434
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.42266730964184 Time :  978
accuracy train: 0.868865 val: 0.760563 test: 0.771806
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.305878058075905 Time :  986
accuracy train: 0.875274 val: 0.756338 test: 0.770118
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  61.24123667180538 Time :  995
accuracy train: 0.877931 val: 0.756338 test: 0.770681
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  60.84102848172188 Time :  1005
accuracy train: 0.880744 val: 0.757746 test: 0.767586
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  59.21552662551403 Time :  1014
accuracy train: 0.885277 val: 0.770423 test: 0.769837
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  58.418276250362396 Time :  1023
accuracy train: 0.885746 val: 0.767606 test: 0.772369
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  58.23802253603935 Time :  1036
accuracy train: 0.888559 val: 0.767606 test: 0.770118
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434

Epoch :  16 loss training:  58.44275815784931 Time :  1052
accuracy train: 0.893717 val: 0.764789 test: 0.770118
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434

Epoch :  17 loss training:  57.058091908693314 Time :  1064
accuracy train: 0.900907 val: 0.769014 test: 0.770681
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434

Epoch :  18 loss training:  54.09452596306801 Time :  1073
accuracy train: 0.904814 val: 0.773239 test: 0.766179
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434

Epoch :  19 loss training:  53.35656088590622 Time :  1081
accuracy train: 0.911847 val: 0.771831 test: 0.767304
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434

Epoch :  20 loss training:  51.244843095541 Time :  1091
accuracy train: 0.916536 val: 0.767606 test: 0.770962
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434

Epoch :  21 loss training:  50.484544560313225 Time :  1100
accuracy train: 0.920600 val: 0.774648 test: 0.766179
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434

Epoch :  22 loss training:  48.2957398891449 Time :  1110
accuracy train: 0.928884 val: 0.767606 test: 0.769555
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434

Epoch :  23 loss training:  46.84344505518675 Time :  1118
accuracy train: 0.936543 val: 0.769014 test: 0.767867
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434

Epoch :  24 loss training:  45.01326382160187 Time :  1126
accuracy train: 0.937637 val: 0.769014 test: 0.767304
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434

Epoch :  25 loss training:  43.7882139980793 Time :  1134
accuracy train: 0.943264 val: 0.769014 test: 0.767586
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434

Epoch :  26 loss training:  43.314144007861614 Time :  1143
accuracy train: 0.949515 val: 0.766197 test: 0.769837
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434

Epoch :  27 loss training:  41.80094441026449 Time :  1153
accuracy train: 0.953892 val: 0.771831 test: 0.771525
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434

Epoch :  28 loss training:  40.224975042045116 Time :  1162
accuracy train: 0.954830 val: 0.763380 test: 0.767023
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434

Epoch :  29 loss training:  38.865277633070946 Time :  1176
accuracy train: 0.958893 val: 0.766197 test: 0.769555
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434

Epoch :  30 loss training:  37.33087985217571 Time :  1188
accuracy train: 0.961550 val: 0.764789 test: 0.765898
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434

Epoch :  31 loss training:  36.6543566249311 Time :  1198
accuracy train: 0.966396 val: 0.766197 test: 0.769837
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434

Epoch :  32 loss training:  35.39233823120594 Time :  1207
accuracy train: 0.969678 val: 0.764789 test: 0.768149
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434

Epoch :  33 loss training:  33.741785407066345 Time :  1217
accuracy train: 0.968897 val: 0.767606 test: 0.772932
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434

Epoch :  34 loss training:  31.292085219174623 Time :  1227
accuracy train: 0.975148 val: 0.767606 test: 0.770118
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434

Epoch :  35 loss training:  30.584381133317947 Time :  1237
accuracy train: 0.978743 val: 0.757746 test: 0.769274
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434

Epoch :  36 loss training:  29.88662506453693 Time :  1245
accuracy train: 0.980932 val: 0.763380 test: 0.772369
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434

Epoch :  37 loss training:  29.000459507107735 Time :  1252
accuracy train: 0.983589 val: 0.760563 test: 0.770681
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434

Epoch :  38 loss training:  26.595867089927197 Time :  1261
accuracy train: 0.985464 val: 0.769014 test: 0.767586
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434

Epoch :  39 loss training:  25.901847280561924 Time :  1270
accuracy train: 0.986246 val: 0.757746 test: 0.774057
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.777434

========================================================================================================================================================================================================
max acc epoch :  8
max validation accuracy :  0.7746478873239436
test accuracy :  0.7774338773213281
last test_accuracy :  0.7740574001125492
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=501, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  90.22166582942009 Time :  1476
accuracy train: 0.784933 val: 0.739437 test: 0.762240
max validation accuracy : 0.739437 max acc epoch : 1 test accuracy : 0.762240
Epoch-1 lr: 0.001

Epoch :  2 loss training:  85.0216161608696 Time :  1484
accuracy train: 0.786808 val: 0.767606 test: 0.769555
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.769555
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.99763748049736 Time :  1493
accuracy train: 0.813223 val: 0.757746 test: 0.769555
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.769555
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.25467777252197 Time :  1502
accuracy train: 0.824789 val: 0.759155 test: 0.776027
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.769555
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.01165282726288 Time :  1511
accuracy train: 0.836668 val: 0.769014 test: 0.775746
max validation accuracy : 0.769014 max acc epoch : 5 test accuracy : 0.775746
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.76518788933754 Time :  1519
accuracy train: 0.839012 val: 0.769014 test: 0.772088
max validation accuracy : 0.769014 max acc epoch : 5 test accuracy : 0.775746
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  65.93008233606815 Time :  1528
accuracy train: 0.849641 val: 0.784507 test: 0.773495
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.73097974061966 Time :  1536
accuracy train: 0.859487 val: 0.774648 test: 0.774057
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.17514343559742 Time :  1545
accuracy train: 0.872148 val: 0.770423 test: 0.767867
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.17616115510464 Time :  1554
accuracy train: 0.876993 val: 0.766197 test: 0.768430
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.831981018185616 Time :  1563
accuracy train: 0.882463 val: 0.766197 test: 0.770400
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.565994799137115 Time :  1572
accuracy train: 0.886527 val: 0.776056 test: 0.764491
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  58.252899527549744 Time :  1583
accuracy train: 0.888090 val: 0.776056 test: 0.768711
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.97486858069897 Time :  1596
accuracy train: 0.888715 val: 0.773239 test: 0.768711
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  57.685657039284706 Time :  1609
accuracy train: 0.893404 val: 0.777465 test: 0.769837
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495

Epoch :  16 loss training:  57.7925536185503 Time :  1619
accuracy train: 0.901532 val: 0.771831 test: 0.768430
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495

Epoch :  17 loss training:  55.96595859527588 Time :  1627
accuracy train: 0.907940 val: 0.780282 test: 0.771806
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495

Epoch :  18 loss training:  53.201602682471275 Time :  1636
accuracy train: 0.913567 val: 0.774648 test: 0.772932
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495

Epoch :  19 loss training:  52.34948864579201 Time :  1643
accuracy train: 0.920288 val: 0.774648 test: 0.767867
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495

Epoch :  20 loss training:  50.67007818818092 Time :  1651
accuracy train: 0.925602 val: 0.777465 test: 0.770118
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495

Epoch :  21 loss training:  49.35975366830826 Time :  1659
accuracy train: 0.930134 val: 0.776056 test: 0.774620
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495

Epoch :  22 loss training:  47.16409207880497 Time :  1667
accuracy train: 0.937949 val: 0.773239 test: 0.772088
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495

Epoch :  23 loss training:  46.46378818154335 Time :  1675
accuracy train: 0.942169 val: 0.774648 test: 0.772088
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495

Epoch :  24 loss training:  43.72138778120279 Time :  1684
accuracy train: 0.944827 val: 0.776056 test: 0.776871
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495

Epoch :  25 loss training:  42.86916986107826 Time :  1693
accuracy train: 0.950922 val: 0.776056 test: 0.779403
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495

Epoch :  26 loss training:  42.09570076316595 Time :  1702
accuracy train: 0.957487 val: 0.780282 test: 0.775464
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495

Epoch :  27 loss training:  40.638184405863285 Time :  1710
accuracy train: 0.960300 val: 0.777465 test: 0.776308
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495

Epoch :  28 loss training:  38.795310847461224 Time :  1724
accuracy train: 0.965614 val: 0.774648 test: 0.774339
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495

Epoch :  29 loss training:  36.972709871828556 Time :  1737
accuracy train: 0.967021 val: 0.771831 test: 0.776590
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495

Epoch :  30 loss training:  36.354433096945286 Time :  1749
accuracy train: 0.970147 val: 0.776056 test: 0.773495
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495

Epoch :  31 loss training:  34.15849980339408 Time :  1757
accuracy train: 0.973742 val: 0.777465 test: 0.774902
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495

Epoch :  32 loss training:  33.485911428928375 Time :  1765
accuracy train: 0.977337 val: 0.766197 test: 0.772932
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495

Epoch :  33 loss training:  32.39134447276592 Time :  1773
accuracy train: 0.977180 val: 0.766197 test: 0.774057
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495

Epoch :  34 loss training:  29.855961434543133 Time :  1782
accuracy train: 0.981869 val: 0.776056 test: 0.771806
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495

Epoch :  35 loss training:  28.509275913238525 Time :  1791
accuracy train: 0.984214 val: 0.769014 test: 0.769555
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495

Epoch :  36 loss training:  28.072185672819614 Time :  1799
accuracy train: 0.986089 val: 0.769014 test: 0.770962
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495

Epoch :  37 loss training:  28.88901025056839 Time :  1807
accuracy train: 0.987809 val: 0.764789 test: 0.770400
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495

Epoch :  38 loss training:  25.963420134037733 Time :  1816
accuracy train: 0.988746 val: 0.767606 test: 0.768711
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773495

========================================================================================================================================================================================================
max acc epoch :  7
max validation accuracy :  0.7845070422535211
test accuracy :  0.7734946539110861
last test_accuracy :  0.7687113111986494
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=501, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  90.20746278762817 Time :  2047
accuracy train: 0.782901 val: 0.743662 test: 0.759707
max validation accuracy : 0.743662 max acc epoch : 1 test accuracy : 0.759707
Epoch-1 lr: 0.001

Epoch :  2 loss training:  85.00892552733421 Time :  2063
accuracy train: 0.786808 val: 0.760563 test: 0.763365
max validation accuracy : 0.760563 max acc epoch : 2 test accuracy : 0.763365
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.75663051009178 Time :  2071
accuracy train: 0.807440 val: 0.759155 test: 0.773213
max validation accuracy : 0.760563 max acc epoch : 2 test accuracy : 0.763365
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.07831108570099 Time :  2079
accuracy train: 0.819631 val: 0.773239 test: 0.772088
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.772088
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.02774748206139 Time :  2087
accuracy train: 0.832917 val: 0.776056 test: 0.779122
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.76598533987999 Time :  2095
accuracy train: 0.837137 val: 0.776056 test: 0.781373
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  65.94392581284046 Time :  2102
accuracy train: 0.849015 val: 0.776056 test: 0.774902
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.80036985874176 Time :  2110
accuracy train: 0.861519 val: 0.770423 test: 0.773776
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.59939086437225 Time :  2118
accuracy train: 0.868865 val: 0.764789 test: 0.775746
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.157658606767654 Time :  2125
accuracy train: 0.873085 val: 0.764789 test: 0.773213
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.87434336543083 Time :  2133
accuracy train: 0.879494 val: 0.774648 test: 0.773495
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.88121709227562 Time :  2141
accuracy train: 0.879494 val: 0.763380 test: 0.774339
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  58.44996526837349 Time :  2149
accuracy train: 0.883401 val: 0.764789 test: 0.774620
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.953682854771614 Time :  2157
accuracy train: 0.885589 val: 0.769014 test: 0.768149
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  57.36526319384575 Time :  2168
accuracy train: 0.886058 val: 0.769014 test: 0.774620
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122

Epoch :  16 loss training:  58.28326576948166 Time :  2184
accuracy train: 0.893717 val: 0.767606 test: 0.774339
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122

Epoch :  17 loss training:  56.857529774308205 Time :  2198
accuracy train: 0.901219 val: 0.763380 test: 0.775183
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122

Epoch :  18 loss training:  53.34882432222366 Time :  2206
accuracy train: 0.907627 val: 0.773239 test: 0.773495
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122

Epoch :  19 loss training:  53.27092310786247 Time :  2215
accuracy train: 0.911066 val: 0.764789 test: 0.775183
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122

Epoch :  20 loss training:  50.35406248271465 Time :  2223
accuracy train: 0.918881 val: 0.767606 test: 0.774620
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122

Epoch :  21 loss training:  50.054068729281425 Time :  2231
accuracy train: 0.919037 val: 0.771831 test: 0.772369
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122

Epoch :  22 loss training:  47.90820525586605 Time :  2239
accuracy train: 0.928728 val: 0.763380 test: 0.773213
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122

Epoch :  23 loss training:  46.59376383572817 Time :  2247
accuracy train: 0.932791 val: 0.766197 test: 0.776308
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122

Epoch :  24 loss training:  45.04661068320274 Time :  2254
accuracy train: 0.933260 val: 0.770423 test: 0.772369
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122

Epoch :  25 loss training:  43.966341473162174 Time :  2262
accuracy train: 0.939356 val: 0.767606 test: 0.776871
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122

Epoch :  26 loss training:  43.447631791234016 Time :  2270
accuracy train: 0.943732 val: 0.763380 test: 0.773776
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122

Epoch :  27 loss training:  41.261948212981224 Time :  2278
accuracy train: 0.950922 val: 0.770423 test: 0.776590
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122

Epoch :  28 loss training:  39.020835757255554 Time :  2286
accuracy train: 0.953892 val: 0.766197 test: 0.775183
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122

Epoch :  29 loss training:  37.834164530038834 Time :  2294
accuracy train: 0.954830 val: 0.769014 test: 0.772369
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122

Epoch :  30 loss training:  36.82138769328594 Time :  2308
accuracy train: 0.959675 val: 0.766197 test: 0.772369
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122

Epoch :  31 loss training:  35.10994517430663 Time :  2322
accuracy train: 0.964989 val: 0.763380 test: 0.776308
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122

Epoch :  32 loss training:  35.12009462714195 Time :  2332
accuracy train: 0.967021 val: 0.767606 test: 0.773213
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122

Epoch :  33 loss training:  33.38611512631178 Time :  2341
accuracy train: 0.967646 val: 0.769014 test: 0.775746
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122

Epoch :  34 loss training:  30.83332657441497 Time :  2349
accuracy train: 0.975148 val: 0.763380 test: 0.774057
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122

Epoch :  35 loss training:  30.06330766901374 Time :  2357
accuracy train: 0.974523 val: 0.757746 test: 0.775464
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122

Epoch :  36 loss training:  28.68911014124751 Time :  2364
accuracy train: 0.977962 val: 0.760563 test: 0.772088
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122

========================================================================================================================================================================================================
max acc epoch :  5
max validation accuracy :  0.776056338028169
test accuracy :  0.7791221159257175
last test_accuracy :  0.7720877884074282
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=501, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  90.16254708170891 Time :  2577
accuracy train: 0.781963 val: 0.736620 test: 0.759989
max validation accuracy : 0.736620 max acc epoch : 1 test accuracy : 0.759989
Epoch-1 lr: 0.001

Epoch :  2 loss training:  84.49600860476494 Time :  2586
accuracy train: 0.788371 val: 0.756338 test: 0.759145
max validation accuracy : 0.756338 max acc epoch : 2 test accuracy : 0.759145
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.9491024017334 Time :  2597
accuracy train: 0.803532 val: 0.749296 test: 0.772651
max validation accuracy : 0.756338 max acc epoch : 2 test accuracy : 0.759145
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.33358316123486 Time :  2611
accuracy train: 0.824008 val: 0.759155 test: 0.773213
max validation accuracy : 0.759155 max acc epoch : 4 test accuracy : 0.773213
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.74791467189789 Time :  2626
accuracy train: 0.832604 val: 0.774648 test: 0.776308
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.6899865269661 Time :  2633
accuracy train: 0.839950 val: 0.769014 test: 0.769555
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.11999566853046 Time :  2641
accuracy train: 0.850578 val: 0.773239 test: 0.769837
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.1384488940239 Time :  2648
accuracy train: 0.862613 val: 0.770423 test: 0.774902
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.25538368523121 Time :  2656
accuracy train: 0.873867 val: 0.764789 test: 0.772088
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.21158070862293 Time :  2664
accuracy train: 0.880275 val: 0.767606 test: 0.775183
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.42394104599953 Time :  2672
accuracy train: 0.883245 val: 0.769014 test: 0.775464
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.7856804728508 Time :  2681
accuracy train: 0.887465 val: 0.766197 test: 0.770118
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  59.03619712591171 Time :  2690
accuracy train: 0.890903 val: 0.767606 test: 0.770681
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.400743052363396 Time :  2698
accuracy train: 0.889184 val: 0.774648 test: 0.770400
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  57.04576453566551 Time :  2707
accuracy train: 0.894186 val: 0.771831 test: 0.772932
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308

Epoch :  16 loss training:  57.35948957502842 Time :  2715
accuracy train: 0.902626 val: 0.763380 test: 0.774339
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308

Epoch :  17 loss training:  55.9825189858675 Time :  2723
accuracy train: 0.906221 val: 0.769014 test: 0.777434
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308

Epoch :  18 loss training:  53.17066931724548 Time :  2735
accuracy train: 0.910597 val: 0.766197 test: 0.775464
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308

Epoch :  19 loss training:  52.51637050509453 Time :  2750
accuracy train: 0.918568 val: 0.757746 test: 0.774057
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308

Epoch :  20 loss training:  50.142408192157745 Time :  2761
accuracy train: 0.922163 val: 0.759155 test: 0.774902
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308

Epoch :  21 loss training:  49.42535299062729 Time :  2769
accuracy train: 0.924195 val: 0.767606 test: 0.774057
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308

Epoch :  22 loss training:  47.20359317958355 Time :  2777
accuracy train: 0.934823 val: 0.763380 test: 0.773213
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308

Epoch :  23 loss training:  45.47140762209892 Time :  2785
accuracy train: 0.938575 val: 0.759155 test: 0.774339
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308

Epoch :  24 loss training:  44.01949893683195 Time :  2795
accuracy train: 0.939043 val: 0.767606 test: 0.774902
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308

Epoch :  25 loss training:  42.554665587842464 Time :  2804
accuracy train: 0.945921 val: 0.761972 test: 0.775183
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308

Epoch :  26 loss training:  42.180470071733 Time :  2813
accuracy train: 0.950453 val: 0.767606 test: 0.772651
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308

Epoch :  27 loss training:  40.289891712367535 Time :  2821
accuracy train: 0.956393 val: 0.766197 test: 0.773495
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308

Epoch :  28 loss training:  38.73833225667477 Time :  2830
accuracy train: 0.959362 val: 0.764789 test: 0.770962
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308

Epoch :  29 loss training:  37.80367125570774 Time :  2840
accuracy train: 0.962019 val: 0.763380 test: 0.772369
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308

Epoch :  30 loss training:  36.04365412518382 Time :  2849
accuracy train: 0.964989 val: 0.763380 test: 0.767586
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308

Epoch :  31 loss training:  34.73987136781216 Time :  2858
accuracy train: 0.970772 val: 0.767606 test: 0.768711
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308

Epoch :  32 loss training:  34.19141844660044 Time :  2868
accuracy train: 0.973742 val: 0.767606 test: 0.770962
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308

Epoch :  33 loss training:  32.816429033875465 Time :  2883
accuracy train: 0.973898 val: 0.769014 test: 0.771806
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308

Epoch :  34 loss training:  31.178470492362976 Time :  2899
accuracy train: 0.978431 val: 0.770423 test: 0.773776
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308

Epoch :  35 loss training:  29.222719434648752 Time :  2914
accuracy train: 0.982026 val: 0.757746 test: 0.770962
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308

Epoch :  36 loss training:  28.84680799767375 Time :  2926
accuracy train: 0.983901 val: 0.759155 test: 0.769837
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.776308

========================================================================================================================================================================================================
max acc epoch :  5
max validation accuracy :  0.7746478873239436
test accuracy :  0.7763083849184018
last test_accuracy :  0.7698368036015757
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	val_accuracy :  77.32394366197182 	test_accuracy :  77.46201463140123 	max_acc epoch :  7 	last test_accuracy :  76.64603263927968
k :  1 	val_accuracy :  77.46478873239437 	test_accuracy :  77.7433877321328 	max_acc epoch :  8 	last test_accuracy :  77.40574001125492
k :  2 	val_accuracy :  78.45070422535211 	test_accuracy :  77.34946539110861 	max_acc epoch :  7 	last test_accuracy :  76.87113111986494
k :  3 	val_accuracy :  77.6056338028169 	test_accuracy :  77.91221159257175 	max_acc epoch :  5 	last test_accuracy :  77.20877884074282
k :  4 	val_accuracy :  77.46478873239437 	test_accuracy :  77.63083849184018 	max_acc epoch :  5 	last test_accuracy :  76.98368036015756

avg :  	val_accuracy :  77.6619718309859 	test_accuracy :  77.6195835678109 	last_accuracy :  77.02307259425999


date and time :  Fri May 21 11:35:42 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=966, weight_decay=0)
device :  cuda:0
Counter({0: 6231, 1: 4431})

Epoch :  1 loss training:  93.09764137864113 Time :  311
accuracy train: 0.786027 val: 0.770423 test: 0.776871
max validation accuracy : 0.770423 max acc epoch : 1 test accuracy : 0.776871
Counter({1: 5494, 0: 5168})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.35292294621468 Time :  367
accuracy train: 0.800406 val: 0.757746 test: 0.774620
max validation accuracy : 0.770423 max acc epoch : 1 test accuracy : 0.776871
Counter({1: 8138, 0: 2524})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.43878504633904 Time :  419
accuracy train: 0.792435 val: 0.756338 test: 0.767304
max validation accuracy : 0.770423 max acc epoch : 1 test accuracy : 0.776871
Counter({0: 5466, 1: 5196})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.89818912744522 Time :  467
accuracy train: 0.825570 val: 0.763380 test: 0.776308
max validation accuracy : 0.770423 max acc epoch : 1 test accuracy : 0.776871
Counter({0: 5897, 1: 4765})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  73.16340175271034 Time :  512
accuracy train: 0.839481 val: 0.770423 test: 0.779685
max validation accuracy : 0.770423 max acc epoch : 1 test accuracy : 0.776871
Counter({0: 6089, 1: 4573})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.45710162818432 Time :  567
accuracy train: 0.832760 val: 0.777465 test: 0.779403
max validation accuracy : 0.777465 max acc epoch : 6 test accuracy : 0.779403
Counter({1: 6115, 0: 4547})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.85499531030655 Time :  621
accuracy train: 0.850109 val: 0.767606 test: 0.776308
max validation accuracy : 0.777465 max acc epoch : 6 test accuracy : 0.779403
Counter({0: 6112, 1: 4550})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.53530257940292 Time :  659
accuracy train: 0.859487 val: 0.777465 test: 0.777153
max validation accuracy : 0.777465 max acc epoch : 6 test accuracy : 0.779403
Counter({1: 6201, 0: 4461})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.92254711687565 Time :  697
accuracy train: 0.871991 val: 0.777465 test: 0.774902
max validation accuracy : 0.777465 max acc epoch : 6 test accuracy : 0.779403
Counter({0: 6252, 1: 4410})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.63448512554169 Time :  736
accuracy train: 0.874179 val: 0.767606 test: 0.779122
max validation accuracy : 0.777465 max acc epoch : 6 test accuracy : 0.779403
Counter({1: 6311, 0: 4351})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.4813661724329 Time :  783
accuracy train: 0.874023 val: 0.764789 test: 0.772932
max validation accuracy : 0.777465 max acc epoch : 6 test accuracy : 0.779403
Counter({0: 6330, 1: 4332})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.848090559244156 Time :  828
accuracy train: 0.883401 val: 0.770423 test: 0.773776
max validation accuracy : 0.777465 max acc epoch : 6 test accuracy : 0.779403
Counter({0: 6360, 1: 4302})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.98506064713001 Time :  869
accuracy train: 0.886527 val: 0.776056 test: 0.774620
max validation accuracy : 0.777465 max acc epoch : 6 test accuracy : 0.779403
Counter({1: 6354, 0: 4308})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  58.436782881617546 Time :  904
accuracy train: 0.887152 val: 0.776056 test: 0.776871
max validation accuracy : 0.777465 max acc epoch : 6 test accuracy : 0.779403
Counter({1: 6361, 0: 4301})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  57.96844436228275 Time :  938
accuracy train: 0.892623 val: 0.770423 test: 0.774620
max validation accuracy : 0.777465 max acc epoch : 6 test accuracy : 0.779403
Counter({1: 6349, 0: 4313})

Epoch :  16 loss training:  56.103011175990105 Time :  974
accuracy train: 0.896530 val: 0.764789 test: 0.773495
max validation accuracy : 0.777465 max acc epoch : 6 test accuracy : 0.779403
Counter({1: 6359, 0: 4303})

Epoch :  17 loss training:  54.686525113880634 Time :  1024
accuracy train: 0.902470 val: 0.769014 test: 0.773776
max validation accuracy : 0.777465 max acc epoch : 6 test accuracy : 0.779403
Counter({1: 6392, 0: 4270})

Epoch :  18 loss training:  52.58697105944157 Time :  1062
accuracy train: 0.914192 val: 0.777465 test: 0.774057
max validation accuracy : 0.777465 max acc epoch : 6 test accuracy : 0.779403
Counter({1: 6416, 0: 4246})

Epoch :  19 loss training:  52.34881214797497 Time :  1099
accuracy train: 0.920756 val: 0.777465 test: 0.775183
max validation accuracy : 0.777465 max acc epoch : 6 test accuracy : 0.779403
Counter({1: 6435, 0: 4227})

Epoch :  20 loss training:  51.19327834248543 Time :  1135
accuracy train: 0.923414 val: 0.778873 test: 0.775183
max validation accuracy : 0.778873 max acc epoch : 20 test accuracy : 0.775183
Counter({0: 6427, 1: 4235})

Epoch :  21 loss training:  48.73469312489033 Time :  1170
accuracy train: 0.930603 val: 0.776056 test: 0.777153
max validation accuracy : 0.778873 max acc epoch : 20 test accuracy : 0.775183
Counter({1: 6428, 0: 4234})

Epoch :  22 loss training:  48.49525874853134 Time :  1211
accuracy train: 0.936074 val: 0.769014 test: 0.769837
max validation accuracy : 0.778873 max acc epoch : 20 test accuracy : 0.775183
Counter({0: 6471, 1: 4191})

Epoch :  23 loss training:  45.19744085520506 Time :  1258
accuracy train: 0.938418 val: 0.770423 test: 0.771806
max validation accuracy : 0.778873 max acc epoch : 20 test accuracy : 0.775183
Counter({0: 6480, 1: 4182})

Epoch :  24 loss training:  42.665745213627815 Time :  1295
accuracy train: 0.942326 val: 0.778873 test: 0.770400
max validation accuracy : 0.778873 max acc epoch : 20 test accuracy : 0.775183
Counter({0: 6536, 1: 4126})

Epoch :  25 loss training:  42.30449415743351 Time :  1330
accuracy train: 0.948578 val: 0.774648 test: 0.772651
max validation accuracy : 0.778873 max acc epoch : 20 test accuracy : 0.775183
Counter({1: 6577, 0: 4085})

Epoch :  26 loss training:  41.66274143010378 Time :  1368
accuracy train: 0.953892 val: 0.771831 test: 0.773495
max validation accuracy : 0.778873 max acc epoch : 20 test accuracy : 0.775183
Counter({1: 6598, 0: 4064})

Epoch :  27 loss training:  39.3698223605752 Time :  1405
accuracy train: 0.959206 val: 0.769014 test: 0.769555
max validation accuracy : 0.778873 max acc epoch : 20 test accuracy : 0.775183
Counter({0: 6598, 1: 4064})

Epoch :  28 loss training:  37.362991504371166 Time :  1450
accuracy train: 0.962488 val: 0.770423 test: 0.766742
max validation accuracy : 0.778873 max acc epoch : 20 test accuracy : 0.775183
Counter({0: 6598, 1: 4064})

Epoch :  29 loss training:  35.608812004327774 Time :  1491
accuracy train: 0.964364 val: 0.773239 test: 0.771806
max validation accuracy : 0.778873 max acc epoch : 20 test accuracy : 0.775183
Counter({0: 6601, 1: 4061})

Epoch :  30 loss training:  34.42985761165619 Time :  1527
accuracy train: 0.970303 val: 0.771831 test: 0.770118
max validation accuracy : 0.778873 max acc epoch : 20 test accuracy : 0.775183
Counter({1: 6587, 0: 4075})

Epoch :  31 loss training:  33.377632193267345 Time :  1564
accuracy train: 0.973429 val: 0.764789 test: 0.768430
max validation accuracy : 0.778873 max acc epoch : 20 test accuracy : 0.775183
Counter({0: 6604, 1: 4058})

Epoch :  32 loss training:  32.00418480485678 Time :  1600
accuracy train: 0.976243 val: 0.778873 test: 0.768993
max validation accuracy : 0.778873 max acc epoch : 20 test accuracy : 0.775183
Counter({1: 6614, 0: 4048})

Epoch :  33 loss training:  31.366755060851574 Time :  1637
accuracy train: 0.978274 val: 0.776056 test: 0.768430
max validation accuracy : 0.778873 max acc epoch : 20 test accuracy : 0.775183
Counter({0: 6638, 1: 4024})

Epoch :  34 loss training:  28.407380025833845 Time :  1684
accuracy train: 0.979994 val: 0.771831 test: 0.770962
max validation accuracy : 0.778873 max acc epoch : 20 test accuracy : 0.775183
Counter({0: 6637, 1: 4025})

Epoch :  35 loss training:  27.781337399035692 Time :  1725
accuracy train: 0.982651 val: 0.777465 test: 0.773495
max validation accuracy : 0.778873 max acc epoch : 20 test accuracy : 0.775183
Counter({0: 6648, 1: 4014})

Epoch :  36 loss training:  27.035890318453312 Time :  1762
accuracy train: 0.983901 val: 0.774648 test: 0.772088
max validation accuracy : 0.778873 max acc epoch : 20 test accuracy : 0.775183
Counter({1: 6643, 0: 4019})

Epoch :  37 loss training:  24.76936250552535 Time :  1797
accuracy train: 0.985777 val: 0.776056 test: 0.770118
max validation accuracy : 0.778873 max acc epoch : 20 test accuracy : 0.775183
Counter({1: 6622, 0: 4040})

Epoch :  38 loss training:  24.264011148363352 Time :  1835
accuracy train: 0.987027 val: 0.773239 test: 0.765898
max validation accuracy : 0.778873 max acc epoch : 20 test accuracy : 0.775183
Counter({0: 6616, 1: 4046})

Epoch :  39 loss training:  24.099298030138016 Time :  1872
accuracy train: 0.991091 val: 0.777465 test: 0.766742
max validation accuracy : 0.778873 max acc epoch : 20 test accuracy : 0.775183
Counter({0: 6632, 1: 4030})

Epoch :  40 loss training:  21.493734072893858 Time :  1922
accuracy train: 0.990622 val: 0.773239 test: 0.766460
max validation accuracy : 0.778873 max acc epoch : 20 test accuracy : 0.775183
Counter({1: 6644, 0: 4018})

Epoch :  41 loss training:  20.89345920085907 Time :  1955
accuracy train: 0.990309 val: 0.774648 test: 0.760833
max validation accuracy : 0.778873 max acc epoch : 20 test accuracy : 0.775183
Counter({0: 6663, 1: 3999})

Epoch :  42 loss training:  19.311727922409773 Time :  1990
accuracy train: 0.994217 val: 0.781690 test: 0.761396
max validation accuracy : 0.781690 max acc epoch : 42 test accuracy : 0.761396
Counter({1: 6655, 0: 4007})

Epoch :  43 loss training:  21.030490110628307 Time :  2027
accuracy train: 0.995936 val: 0.778873 test: 0.763084
max validation accuracy : 0.781690 max acc epoch : 42 test accuracy : 0.761396
Counter({1: 6669, 0: 3993})

Epoch :  44 loss training:  19.083288248628378 Time :  2062
accuracy train: 0.995624 val: 0.777465 test: 0.769274
max validation accuracy : 0.781690 max acc epoch : 42 test accuracy : 0.761396
Counter({1: 6638, 0: 4024})

Epoch :  45 loss training:  17.946318842470646 Time :  2104
accuracy train: 0.996093 val: 0.773239 test: 0.768993
max validation accuracy : 0.781690 max acc epoch : 42 test accuracy : 0.761396
Counter({1: 6622, 0: 4040})

Epoch :  46 loss training:  16.986054690554738 Time :  2149
accuracy train: 0.996249 val: 0.771831 test: 0.766742
max validation accuracy : 0.781690 max acc epoch : 42 test accuracy : 0.761396
Counter({0: 6599, 1: 4063})

Epoch :  47 loss training:  16.515805035829544 Time :  2185
accuracy train: 0.996093 val: 0.778873 test: 0.766742
max validation accuracy : 0.781690 max acc epoch : 42 test accuracy : 0.761396
Counter({1: 6612, 0: 4050})

Epoch :  48 loss training:  15.227013811469078 Time :  2221
accuracy train: 0.997968 val: 0.783099 test: 0.771244
max validation accuracy : 0.783099 max acc epoch : 48 test accuracy : 0.771244
Counter({0: 6587, 1: 4075})

Epoch :  49 loss training:  14.676317892037332 Time :  2258
accuracy train: 0.998124 val: 0.780282 test: 0.770400
max validation accuracy : 0.783099 max acc epoch : 48 test accuracy : 0.771244
Counter({1: 6610, 0: 4052})

Epoch :  50 loss training:  14.953715938143432 Time :  2292
accuracy train: 0.998593 val: 0.784507 test: 0.769274
max validation accuracy : 0.784507 max acc epoch : 50 test accuracy : 0.769274
Counter({1: 6604, 0: 4058})

Epoch :  51 loss training:  13.373712597414851 Time :  2340
accuracy train: 0.999219 val: 0.785915 test: 0.767304
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({1: 6600, 0: 4062})

Epoch :  52 loss training:  13.268880795687437 Time :  2373
accuracy train: 0.999219 val: 0.774648 test: 0.764772
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({1: 6584, 0: 4078})

Epoch :  53 loss training:  12.814472679048777 Time :  2412
accuracy train: 0.999062 val: 0.778873 test: 0.765898
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({1: 6568, 0: 4094})

Epoch :  54 loss training:  12.195934493560344 Time :  2447
accuracy train: 0.999219 val: 0.777465 test: 0.765335
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({0: 6509, 1: 4153})

Epoch :  55 loss training:  11.432129924185574 Time :  2484
accuracy train: 0.999219 val: 0.783099 test: 0.764772
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({0: 6509, 1: 4153})

Epoch :  56 loss training:  11.30980691127479 Time :  2523
accuracy train: 0.999687 val: 0.785915 test: 0.765898
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({0: 6497, 1: 4165})

Epoch :  57 loss training:  11.147281226236373 Time :  2563
accuracy train: 0.999687 val: 0.777465 test: 0.770118
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({0: 6501, 1: 4161})

Epoch :  58 loss training:  10.167126953136176 Time :  2594
accuracy train: 1.000000 val: 0.778873 test: 0.766460
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({1: 6484, 0: 4178})

Epoch :  59 loss training:  9.38834262941964 Time :  2623
accuracy train: 1.000000 val: 0.777465 test: 0.765616
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({1: 6485, 0: 4177})

Epoch :  60 loss training:  10.07690653624013 Time :  2652
accuracy train: 1.000000 val: 0.777465 test: 0.769837
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({0: 6472, 1: 4190})

Epoch :  61 loss training:  8.988899134565145 Time :  2680
accuracy train: 0.999844 val: 0.770423 test: 0.765616
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({0: 6475, 1: 4187})

Epoch :  62 loss training:  8.841293155448511 Time :  2711
accuracy train: 1.000000 val: 0.778873 test: 0.768149
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({1: 6420, 0: 4242})

Epoch :  63 loss training:  7.820758281741291 Time :  2754
accuracy train: 1.000000 val: 0.774648 test: 0.764491
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({1: 6340, 0: 4322})

Epoch :  64 loss training:  7.215722393244505 Time :  2791
accuracy train: 1.000000 val: 0.771831 test: 0.767586
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({1: 6323, 0: 4339})

Epoch :  65 loss training:  7.626006967853755 Time :  2821
accuracy train: 1.000000 val: 0.774648 test: 0.765898
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({0: 6318, 1: 4344})

Epoch :  66 loss training:  7.28323614411056 Time :  2851
accuracy train: 1.000000 val: 0.776056 test: 0.765616
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({0: 6302, 1: 4360})

Epoch :  67 loss training:  6.392409127904102 Time :  2881
accuracy train: 1.000000 val: 0.773239 test: 0.768149
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({0: 6295, 1: 4367})

Epoch :  68 loss training:  7.22689828556031 Time :  2915
accuracy train: 1.000000 val: 0.773239 test: 0.766742
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({1: 6287, 0: 4375})

Epoch :  69 loss training:  6.890480395173654 Time :  2959
accuracy train: 1.000000 val: 0.777465 test: 0.766742
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({1: 6285, 0: 4377})

Epoch :  70 loss training:  5.0833198190666735 Time :  2987
accuracy train: 0.999844 val: 0.771831 test: 0.762521
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({0: 6283, 1: 4379})

Epoch :  71 loss training:  5.860588600044139 Time :  3011
accuracy train: 1.000000 val: 0.769014 test: 0.768430
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({0: 6260, 1: 4402})

Epoch :  72 loss training:  5.932077552890405 Time :  3038
accuracy train: 1.000000 val: 0.769014 test: 0.765616
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({1: 6255, 0: 4407})

Epoch :  73 loss training:  5.486095278989524 Time :  3061
accuracy train: 1.000000 val: 0.773239 test: 0.765616
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({0: 6252, 1: 4410})

Epoch :  74 loss training:  4.779899126733653 Time :  3085
accuracy train: 1.000000 val: 0.778873 test: 0.765898
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({0: 6248, 1: 4414})

Epoch :  75 loss training:  4.839912114548497 Time :  3114
accuracy train: 1.000000 val: 0.774648 test: 0.762802
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({1: 6207, 0: 4455})

Epoch :  76 loss training:  5.35403291269904 Time :  3149
accuracy train: 1.000000 val: 0.770423 test: 0.764209
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({1: 6178, 0: 4484})

Epoch :  77 loss training:  4.713376091676764 Time :  3175
accuracy train: 1.000000 val: 0.771831 test: 0.763365
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({1: 6165, 0: 4497})

Epoch :  78 loss training:  4.167421267804457 Time :  3203
accuracy train: 1.000000 val: 0.777465 test: 0.763365
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({0: 6171, 1: 4491})

Epoch :  79 loss training:  3.6682208698475733 Time :  3234
accuracy train: 1.000000 val: 0.777465 test: 0.764491
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({1: 6067, 0: 4595})

Epoch :  80 loss training:  3.9657724366988987 Time :  3269
accuracy train: 1.000000 val: 0.773239 test: 0.761114
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({1: 6077, 0: 4585})

Epoch :  81 loss training:  3.7953922725864686 Time :  3302
accuracy train: 1.000000 val: 0.767606 test: 0.759989
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({1: 6062, 0: 4600})

Epoch :  82 loss training:  4.191890685760882 Time :  3348
accuracy train: 1.000000 val: 0.769014 test: 0.765335
max validation accuracy : 0.785915 max acc epoch : 51 test accuracy : 0.767304
Counter({0: 6054, 1: 4608})

========================================================================================================================================================================================================
max acc epoch :  51
max validation accuracy :  0.7859154929577464
test accuracy :  0.7673044456949916
last test_accuracy :  0.7653348339898706
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=966, weight_decay=0)
device :  cuda:0
Counter({0: 6231, 1: 4431})

Epoch :  1 loss training:  93.07040226459503 Time :  3575
accuracy train: 0.785402 val: 0.764789 test: 0.771525
max validation accuracy : 0.764789 max acc epoch : 1 test accuracy : 0.771525
Counter({1: 5927, 0: 4735})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.47846326231956 Time :  3598
accuracy train: 0.796030 val: 0.769014 test: 0.771244
max validation accuracy : 0.769014 max acc epoch : 2 test accuracy : 0.771244
Counter({0: 6044, 1: 4618})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.18675690889359 Time :  3620
accuracy train: 0.786652 val: 0.757746 test: 0.760270
max validation accuracy : 0.769014 max acc epoch : 2 test accuracy : 0.771244
Counter({1: 6194, 0: 4468})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.77586404979229 Time :  3643
accuracy train: 0.813067 val: 0.752113 test: 0.774057
max validation accuracy : 0.769014 max acc epoch : 2 test accuracy : 0.771244
Counter({0: 6339, 1: 4323})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  73.33202704787254 Time :  3681
accuracy train: 0.836511 val: 0.770423 test: 0.778841
max validation accuracy : 0.770423 max acc epoch : 5 test accuracy : 0.778841
Counter({0: 6639, 1: 4023})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.39690063893795 Time :  3708
accuracy train: 0.840731 val: 0.774648 test: 0.781654
max validation accuracy : 0.774648 max acc epoch : 6 test accuracy : 0.781654
Counter({0: 6789, 1: 3873})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.73761394619942 Time :  3737
accuracy train: 0.848078 val: 0.759155 test: 0.776027
max validation accuracy : 0.774648 max acc epoch : 6 test accuracy : 0.781654
Counter({0: 6780, 1: 3882})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.56887763738632 Time :  3766
accuracy train: 0.864489 val: 0.770423 test: 0.775183
max validation accuracy : 0.774648 max acc epoch : 6 test accuracy : 0.781654
Counter({1: 6864, 0: 3798})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.996551766991615 Time :  3796
accuracy train: 0.873867 val: 0.771831 test: 0.769274
max validation accuracy : 0.774648 max acc epoch : 6 test accuracy : 0.781654
Counter({0: 6893, 1: 3769})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.520818650722504 Time :  3828
accuracy train: 0.875586 val: 0.766197 test: 0.773776
max validation accuracy : 0.774648 max acc epoch : 6 test accuracy : 0.781654
Counter({0: 6920, 1: 3742})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.715474367141724 Time :  3870
accuracy train: 0.879337 val: 0.763380 test: 0.772651
max validation accuracy : 0.774648 max acc epoch : 6 test accuracy : 0.781654
Counter({1: 6925, 0: 3737})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.551918029785156 Time :  3904
accuracy train: 0.891997 val: 0.777465 test: 0.765335
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({0: 6981, 1: 3681})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.87013617157936 Time :  3932
accuracy train: 0.894811 val: 0.776056 test: 0.767867
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({0: 7003, 1: 3659})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.64158394932747 Time :  3958
accuracy train: 0.895436 val: 0.769014 test: 0.767023
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({0: 7024, 1: 3638})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  58.03769785165787 Time :  3985
accuracy train: 0.896999 val: 0.764789 test: 0.768149
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({1: 7022, 0: 3640})

Epoch :  16 loss training:  56.26907932758331 Time :  4013
accuracy train: 0.903095 val: 0.769014 test: 0.769837
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({1: 7015, 0: 3647})

Epoch :  17 loss training:  54.78775389492512 Time :  4047
accuracy train: 0.910128 val: 0.770423 test: 0.765616
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({1: 7020, 0: 3642})

Epoch :  18 loss training:  51.94719049334526 Time :  4087
accuracy train: 0.914661 val: 0.776056 test: 0.767023
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({0: 7026, 1: 3636})

Epoch :  19 loss training:  52.1188078969717 Time :  4111
accuracy train: 0.923726 val: 0.773239 test: 0.768993
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({0: 7033, 1: 3629})

Epoch :  20 loss training:  50.34072786569595 Time :  4138
accuracy train: 0.928728 val: 0.769014 test: 0.768149
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({1: 7034, 0: 3628})

Epoch :  21 loss training:  48.05541808903217 Time :  4171
accuracy train: 0.932166 val: 0.767606 test: 0.770118
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({0: 7033, 1: 3629})

Epoch :  22 loss training:  48.334455862641335 Time :  4203
accuracy train: 0.939512 val: 0.767606 test: 0.763928
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({1: 7038, 0: 3624})

Epoch :  23 loss training:  45.67366550117731 Time :  4237
accuracy train: 0.945921 val: 0.770423 test: 0.768149
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({1: 7033, 0: 3629})

Epoch :  24 loss training:  42.998768746852875 Time :  4283
accuracy train: 0.948734 val: 0.760563 test: 0.763084
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({1: 7059, 0: 3603})

Epoch :  25 loss training:  42.89763727784157 Time :  4314
accuracy train: 0.955142 val: 0.767606 test: 0.763365
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({1: 7047, 0: 3615})

Epoch :  26 loss training:  41.48229295760393 Time :  4344
accuracy train: 0.957018 val: 0.760563 test: 0.763084
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({0: 7044, 1: 3618})

Epoch :  27 loss training:  39.64751799404621 Time :  4375
accuracy train: 0.964676 val: 0.766197 test: 0.761958
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({0: 7071, 1: 3591})

Epoch :  28 loss training:  37.63824647665024 Time :  4407
accuracy train: 0.965614 val: 0.757746 test: 0.762521
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({0: 7024, 1: 3638})

Epoch :  29 loss training:  36.05709320679307 Time :  4448
accuracy train: 0.971397 val: 0.760563 test: 0.768711
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({1: 7004, 0: 3658})

Epoch :  30 loss training:  34.61407808959484 Time :  4489
accuracy train: 0.972491 val: 0.766197 test: 0.766179
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({1: 7008, 0: 3654})

Epoch :  31 loss training:  33.53902378305793 Time :  4519
accuracy train: 0.975617 val: 0.766197 test: 0.767304
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({1: 7033, 0: 3629})

Epoch :  32 loss training:  32.380939960479736 Time :  4551
accuracy train: 0.980150 val: 0.764789 test: 0.765335
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({0: 7003, 1: 3659})

Epoch :  33 loss training:  32.54376733675599 Time :  4582
accuracy train: 0.980775 val: 0.764789 test: 0.767867
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({0: 6994, 1: 3668})

Epoch :  34 loss training:  29.31442917883396 Time :  4611
accuracy train: 0.982338 val: 0.766197 test: 0.769274
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({1: 6928, 0: 3734})

Epoch :  35 loss training:  29.07534711062908 Time :  4659
accuracy train: 0.986089 val: 0.764789 test: 0.768430
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({0: 6865, 1: 3797})

Epoch :  36 loss training:  27.65060142427683 Time :  4691
accuracy train: 0.986871 val: 0.773239 test: 0.769274
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({0: 6850, 1: 3812})

Epoch :  37 loss training:  25.294726625084877 Time :  4721
accuracy train: 0.988903 val: 0.767606 test: 0.768711
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({1: 6745, 0: 3917})

Epoch :  38 loss training:  24.853488240391016 Time :  4758
accuracy train: 0.989841 val: 0.764789 test: 0.770681
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({1: 6707, 0: 3955})

Epoch :  39 loss training:  24.095137178897858 Time :  4792
accuracy train: 0.991404 val: 0.764789 test: 0.767867
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({1: 6722, 0: 3940})

Epoch :  40 loss training:  21.972264479845762 Time :  4832
accuracy train: 0.991091 val: 0.763380 test: 0.763365
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({1: 6728, 0: 3934})

Epoch :  41 loss training:  22.07453241571784 Time :  4875
accuracy train: 0.990153 val: 0.756338 test: 0.761958
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({0: 6745, 1: 3917})

Epoch :  42 loss training:  20.04092874377966 Time :  4903
accuracy train: 0.993592 val: 0.756338 test: 0.760833
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({1: 6758, 0: 3904})

Epoch :  43 loss training:  21.980774343013763 Time :  4930
accuracy train: 0.994686 val: 0.763380 test: 0.763928
max validation accuracy : 0.777465 max acc epoch : 12 test accuracy : 0.765335
Counter({1: 6751, 0: 3911})

========================================================================================================================================================================================================
max acc epoch :  12
max validation accuracy :  0.7774647887323943
test accuracy :  0.7653348339898706
last test_accuracy :  0.7639279684862127
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=966, weight_decay=0)
device :  cuda:0
Counter({0: 6231, 1: 4431})

Epoch :  1 loss training:  92.98169767856598 Time :  5210
accuracy train: 0.788215 val: 0.763380 test: 0.776871
max validation accuracy : 0.763380 max acc epoch : 1 test accuracy : 0.776871
Counter({1: 5558, 0: 5104})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.6106733083725 Time :  5258
accuracy train: 0.801969 val: 0.763380 test: 0.773213
max validation accuracy : 0.763380 max acc epoch : 1 test accuracy : 0.776871
Counter({1: 6172, 0: 4490})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.57102012634277 Time :  5296
accuracy train: 0.783682 val: 0.739437 test: 0.756331
max validation accuracy : 0.763380 max acc epoch : 1 test accuracy : 0.776871
Counter({0: 6244, 1: 4418})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  75.2303681075573 Time :  5342
accuracy train: 0.818537 val: 0.766197 test: 0.779122
max validation accuracy : 0.766197 max acc epoch : 4 test accuracy : 0.779122
Counter({1: 6171, 0: 4491})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  73.77885639667511 Time :  5377
accuracy train: 0.838700 val: 0.781690 test: 0.777997
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6171, 0: 4491})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.12209591269493 Time :  5417
accuracy train: 0.842607 val: 0.763380 test: 0.787001
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6174, 0: 4488})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.03288353979588 Time :  5459
accuracy train: 0.854486 val: 0.767606 test: 0.779966
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6176, 0: 4486})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.96602918207645 Time :  5492
accuracy train: 0.865583 val: 0.776056 test: 0.781373
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({0: 6171, 1: 4491})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.24023884534836 Time :  5520
accuracy train: 0.872148 val: 0.771831 test: 0.773213
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6175, 0: 4487})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.15068708360195 Time :  5550
accuracy train: 0.875274 val: 0.771831 test: 0.778559
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6172, 0: 4490})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  61.00411310791969 Time :  5582
accuracy train: 0.881682 val: 0.771831 test: 0.774339
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6172, 0: 4490})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  61.00776804983616 Time :  5618
accuracy train: 0.889966 val: 0.776056 test: 0.772651
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6172, 0: 4490})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  58.845020458102226 Time :  5663
accuracy train: 0.890903 val: 0.774648 test: 0.774057
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6173, 0: 4489})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  58.62287351489067 Time :  5696
accuracy train: 0.892154 val: 0.767606 test: 0.774620
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6171, 0: 4491})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  58.48054714500904 Time :  5730
accuracy train: 0.895592 val: 0.770423 test: 0.777715
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6172, 0: 4490})

Epoch :  16 loss training:  57.268801882863045 Time :  5764
accuracy train: 0.901375 val: 0.771831 test: 0.779685
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6171, 0: 4491})

Epoch :  17 loss training:  55.70282623171806 Time :  5799
accuracy train: 0.907002 val: 0.778873 test: 0.779966
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6171, 0: 4491})

Epoch :  18 loss training:  53.008034378290176 Time :  5839
accuracy train: 0.915286 val: 0.780282 test: 0.779122
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6171, 0: 4491})

Epoch :  19 loss training:  53.44551278650761 Time :  5884
accuracy train: 0.923101 val: 0.774648 test: 0.774057
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6172, 0: 4490})

Epoch :  20 loss training:  52.35730744898319 Time :  5918
accuracy train: 0.926852 val: 0.771831 test: 0.779403
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6171, 0: 4491})

Epoch :  21 loss training:  49.808704540133476 Time :  5955
accuracy train: 0.931541 val: 0.780282 test: 0.779685
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6170, 0: 4492})

Epoch :  22 loss training:  48.626133531332016 Time :  5992
accuracy train: 0.935917 val: 0.773239 test: 0.776871
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6169, 0: 4493})

Epoch :  23 loss training:  46.494942024350166 Time :  6026
accuracy train: 0.941544 val: 0.769014 test: 0.775464
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6169, 0: 4493})

Epoch :  24 loss training:  43.869019359350204 Time :  6069
accuracy train: 0.945608 val: 0.767606 test: 0.776027
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6169, 0: 4493})

Epoch :  25 loss training:  42.25686404109001 Time :  6111
accuracy train: 0.951078 val: 0.773239 test: 0.776308
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6169, 0: 4493})

Epoch :  26 loss training:  42.08491636812687 Time :  6146
accuracy train: 0.954986 val: 0.770423 test: 0.776590
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6169, 0: 4493})

Epoch :  27 loss training:  41.12225601822138 Time :  6178
accuracy train: 0.959050 val: 0.769014 test: 0.773495
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6169, 0: 4493})

Epoch :  28 loss training:  38.13051062822342 Time :  6213
accuracy train: 0.961082 val: 0.773239 test: 0.778278
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6169, 0: 4493})

Epoch :  29 loss training:  36.88891461491585 Time :  6247
accuracy train: 0.963426 val: 0.776056 test: 0.775464
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6167, 0: 4495})

Epoch :  30 loss training:  35.72969909757376 Time :  6289
accuracy train: 0.969522 val: 0.767606 test: 0.776308
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6166, 0: 4496})

Epoch :  31 loss training:  34.77019847929478 Time :  6333
accuracy train: 0.974367 val: 0.767606 test: 0.778278
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({0: 6166, 1: 4496})

Epoch :  32 loss training:  33.31242747604847 Time :  6362
accuracy train: 0.976399 val: 0.770423 test: 0.778278
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6166, 0: 4496})

Epoch :  33 loss training:  33.31830855458975 Time :  6395
accuracy train: 0.979837 val: 0.771831 test: 0.779403
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6166, 0: 4496})

Epoch :  34 loss training:  29.747216552495956 Time :  6427
accuracy train: 0.981088 val: 0.769014 test: 0.778841
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6166, 0: 4496})

Epoch :  35 loss training:  29.64039919525385 Time :  6465
accuracy train: 0.984526 val: 0.763380 test: 0.776590
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6166, 0: 4496})

Epoch :  36 loss training:  28.18411374092102 Time :  6503
accuracy train: 0.986558 val: 0.770423 test: 0.777715
max validation accuracy : 0.781690 max acc epoch : 5 test accuracy : 0.777997
Counter({1: 6165, 0: 4497})

========================================================================================================================================================================================================
max acc epoch :  5
max validation accuracy :  0.7816901408450704
test accuracy :  0.7779966235227912
last test_accuracy :  0.7777152504220597
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=966, weight_decay=0)
device :  cuda:0
Counter({0: 6231, 1: 4431})

Epoch :  1 loss training:  93.02432659268379 Time :  6872
accuracy train: 0.784933 val: 0.760563 test: 0.774057
max validation accuracy : 0.760563 max acc epoch : 1 test accuracy : 0.774057
Counter({1: 6113, 0: 4549})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.38692529499531 Time :  6910
accuracy train: 0.796499 val: 0.761972 test: 0.771806
max validation accuracy : 0.761972 max acc epoch : 2 test accuracy : 0.771806
Counter({0: 6286, 1: 4376})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.84915775060654 Time :  6963
accuracy train: 0.802438 val: 0.759155 test: 0.765053
max validation accuracy : 0.761972 max acc epoch : 2 test accuracy : 0.771806
Counter({1: 6873, 0: 3789})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.20310878753662 Time :  7036
accuracy train: 0.823539 val: 0.759155 test: 0.776590
max validation accuracy : 0.761972 max acc epoch : 2 test accuracy : 0.771806
Counter({1: 5611, 0: 5051})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.8331089913845 Time :  7085
accuracy train: 0.838543 val: 0.761972 test: 0.776871
max validation accuracy : 0.761972 max acc epoch : 2 test accuracy : 0.771806
Counter({1: 5570, 0: 5092})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  69.76565924286842 Time :  7124
accuracy train: 0.835261 val: 0.773239 test: 0.777715
max validation accuracy : 0.773239 max acc epoch : 6 test accuracy : 0.777715
Counter({1: 5646, 0: 5016})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.03486335277557 Time :  7170
accuracy train: 0.858706 val: 0.773239 test: 0.772651
max validation accuracy : 0.773239 max acc epoch : 6 test accuracy : 0.777715
Counter({0: 5682, 1: 4980})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  63.70954781770706 Time :  7210
accuracy train: 0.869178 val: 0.776056 test: 0.773776
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({0: 5736, 1: 4926})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.94044156372547 Time :  7250
accuracy train: 0.872773 val: 0.764789 test: 0.769837
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({0: 5803, 1: 4859})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.27023933827877 Time :  7289
accuracy train: 0.881525 val: 0.773239 test: 0.771244
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({0: 5881, 1: 4781})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.52074249088764 Time :  7331
accuracy train: 0.885902 val: 0.769014 test: 0.768430
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({0: 5895, 1: 4767})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.968859389424324 Time :  7377
accuracy train: 0.892623 val: 0.774648 test: 0.768149
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({1: 5927, 0: 4735})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  56.576666578650475 Time :  7418
accuracy train: 0.896374 val: 0.770423 test: 0.767023
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({0: 5931, 1: 4731})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.524436220526695 Time :  7450
accuracy train: 0.894811 val: 0.776056 test: 0.765898
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({0: 5937, 1: 4725})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.391975685954094 Time :  7483
accuracy train: 0.898875 val: 0.766197 test: 0.765053
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({0: 5917, 1: 4745})

Epoch :  16 loss training:  55.11289423704147 Time :  7519
accuracy train: 0.903876 val: 0.770423 test: 0.766460
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({0: 5918, 1: 4744})

Epoch :  17 loss training:  54.22689178586006 Time :  7553
accuracy train: 0.912004 val: 0.769014 test: 0.765898
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({0: 5924, 1: 4738})

Epoch :  18 loss training:  51.57532721757889 Time :  7599
accuracy train: 0.918412 val: 0.763380 test: 0.765335
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({1: 5934, 0: 4728})

Epoch :  19 loss training:  51.186033457517624 Time :  7637
accuracy train: 0.927321 val: 0.761972 test: 0.762802
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({1: 5929, 0: 4733})

Epoch :  20 loss training:  49.90360714495182 Time :  7668
accuracy train: 0.929666 val: 0.773239 test: 0.765335
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({1: 5936, 0: 4726})

Epoch :  21 loss training:  47.51625460386276 Time :  7699
accuracy train: 0.935136 val: 0.766197 test: 0.765335
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({1: 5953, 0: 4709})

Epoch :  22 loss training:  46.68425860255957 Time :  7733
accuracy train: 0.939825 val: 0.773239 test: 0.763084
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({0: 5956, 1: 4706})

Epoch :  23 loss training:  44.22688037157059 Time :  7768
accuracy train: 0.946233 val: 0.776056 test: 0.764209
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({1: 5946, 0: 4716})

Epoch :  24 loss training:  41.95605846494436 Time :  7814
accuracy train: 0.949828 val: 0.770423 test: 0.760551
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({1: 5956, 0: 4706})

Epoch :  25 loss training:  41.17829571664333 Time :  7849
accuracy train: 0.953892 val: 0.766197 test: 0.761677
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({1: 5960, 0: 4702})

Epoch :  26 loss training:  40.69589915126562 Time :  7878
accuracy train: 0.957174 val: 0.770423 test: 0.763647
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({0: 5955, 1: 4707})

Epoch :  27 loss training:  38.87972117215395 Time :  7908
accuracy train: 0.963895 val: 0.766197 test: 0.763084
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({0: 5947, 1: 4715})

Epoch :  28 loss training:  36.40865656733513 Time :  7938
accuracy train: 0.963739 val: 0.766197 test: 0.759707
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({0: 5909, 1: 4753})

Epoch :  29 loss training:  34.775105096399784 Time :  7969
accuracy train: 0.969678 val: 0.773239 test: 0.765053
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({1: 5886, 0: 4776})

Epoch :  30 loss training:  33.74238692224026 Time :  8015
accuracy train: 0.973429 val: 0.766197 test: 0.762521
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({1: 5865, 0: 4797})

Epoch :  31 loss training:  31.930487129837275 Time :  8048
accuracy train: 0.975930 val: 0.764789 test: 0.765616
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({1: 5877, 0: 4785})

Epoch :  32 loss training:  30.870697401463985 Time :  8080
accuracy train: 0.979837 val: 0.776056 test: 0.762521
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({0: 5860, 1: 4802})

Epoch :  33 loss training:  31.52593119069934 Time :  8112
accuracy train: 0.981088 val: 0.769014 test: 0.765053
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({1: 5817, 0: 4845})

Epoch :  34 loss training:  27.97837806493044 Time :  8143
accuracy train: 0.983432 val: 0.771831 test: 0.764209
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({0: 5817, 1: 4845})

Epoch :  35 loss training:  27.818522300571203 Time :  8177
accuracy train: 0.986246 val: 0.763380 test: 0.766742
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({0: 5800, 1: 4862})

Epoch :  36 loss training:  26.43909051269293 Time :  8219
accuracy train: 0.988121 val: 0.771831 test: 0.767586
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({1: 5783, 0: 4879})

Epoch :  37 loss training:  24.03363375365734 Time :  8253
accuracy train: 0.989997 val: 0.759155 test: 0.765898
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({1: 5746, 0: 4916})

Epoch :  38 loss training:  24.16071029007435 Time :  8278
accuracy train: 0.989997 val: 0.766197 test: 0.767304
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({1: 5727, 0: 4935})

Epoch :  39 loss training:  22.9406343344599 Time :  8303
accuracy train: 0.992185 val: 0.773239 test: 0.764209
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.773776
Counter({0: 5733, 1: 4929})

========================================================================================================================================================================================================
max acc epoch :  8
max validation accuracy :  0.776056338028169
test accuracy :  0.7737760270118177
last test_accuracy :  0.7642093415869443
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=966, weight_decay=0)
device :  cuda:0
Counter({0: 6231, 1: 4431})

Epoch :  1 loss training:  93.00551703572273 Time :  8549
accuracy train: 0.785558 val: 0.764789 test: 0.775746
max validation accuracy : 0.764789 max acc epoch : 1 test accuracy : 0.775746
Counter({0: 5894, 1: 4768})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.49186860024929 Time :  8597
accuracy train: 0.800406 val: 0.763380 test: 0.775464
max validation accuracy : 0.764789 max acc epoch : 1 test accuracy : 0.775746
Counter({1: 7992, 0: 2670})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.51455906033516 Time :  8639
accuracy train: 0.791028 val: 0.747887 test: 0.758582
max validation accuracy : 0.764789 max acc epoch : 1 test accuracy : 0.775746
Counter({1: 5803, 0: 4859})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  75.0435046851635 Time :  8676
accuracy train: 0.818224 val: 0.766197 test: 0.779122
max validation accuracy : 0.766197 max acc epoch : 4 test accuracy : 0.779122
Counter({0: 5612, 1: 5050})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  73.69402021169662 Time :  8714
accuracy train: 0.840263 val: 0.780282 test: 0.778559
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.778559
Counter({1: 7118, 0: 3544})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.67221207916737 Time :  8750
accuracy train: 0.843389 val: 0.780282 test: 0.780529
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.778559
Counter({0: 7026, 1: 3636})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.29741616547108 Time :  8788
accuracy train: 0.852923 val: 0.769014 test: 0.782780
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.778559
Counter({1: 6657, 0: 4005})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.36377209424973 Time :  8816
accuracy train: 0.860894 val: 0.784507 test: 0.780529
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({1: 6321, 0: 4341})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.26007759571075 Time :  8841
accuracy train: 0.866990 val: 0.773239 test: 0.776308
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({0: 6620, 1: 4042})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.44412678480148 Time :  8868
accuracy train: 0.870585 val: 0.763380 test: 0.776027
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({0: 6969, 1: 3693})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.58573327958584 Time :  8894
accuracy train: 0.877305 val: 0.761972 test: 0.776308
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({0: 6941, 1: 3721})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.978343173861504 Time :  8925
accuracy train: 0.884808 val: 0.778873 test: 0.770962
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({0: 7000, 1: 3662})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.713528499007225 Time :  8964
accuracy train: 0.884651 val: 0.773239 test: 0.772932
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({0: 6979, 1: 3683})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  58.01537951827049 Time :  8989
accuracy train: 0.882776 val: 0.773239 test: 0.773213
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({1: 7025, 0: 3637})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  57.86867453157902 Time :  9017
accuracy train: 0.887934 val: 0.771831 test: 0.772651
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({0: 7014, 1: 3648})

Epoch :  16 loss training:  56.38523279130459 Time :  9048
accuracy train: 0.891841 val: 0.764789 test: 0.771525
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({1: 7037, 0: 3625})

Epoch :  17 loss training:  54.63888782262802 Time :  9081
accuracy train: 0.898875 val: 0.774648 test: 0.768149
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({0: 7036, 1: 3626})

Epoch :  18 loss training:  52.510945960879326 Time :  9113
accuracy train: 0.906533 val: 0.773239 test: 0.769274
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({1: 7031, 0: 3631})

Epoch :  19 loss training:  52.50415059924126 Time :  9162
accuracy train: 0.914192 val: 0.773239 test: 0.766742
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({1: 7011, 0: 3651})

Epoch :  20 loss training:  50.9174907207489 Time :  9193
accuracy train: 0.916693 val: 0.771831 test: 0.769274
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({1: 7025, 0: 3637})

Epoch :  21 loss training:  48.77986788004637 Time :  9223
accuracy train: 0.922319 val: 0.776056 test: 0.772369
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({1: 7007, 0: 3655})

Epoch :  22 loss training:  48.53194089233875 Time :  9253
accuracy train: 0.929822 val: 0.771831 test: 0.772088
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({0: 7028, 1: 3634})

Epoch :  23 loss training:  45.813001319766045 Time :  9282
accuracy train: 0.933573 val: 0.770423 test: 0.771806
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({1: 7055, 0: 3607})

Epoch :  24 loss training:  42.8655459433794 Time :  9320
accuracy train: 0.937949 val: 0.769014 test: 0.768149
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({0: 7072, 1: 3590})

Epoch :  25 loss training:  42.13494008779526 Time :  9358
accuracy train: 0.943107 val: 0.764789 test: 0.768993
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({0: 7081, 1: 3581})

Epoch :  26 loss training:  41.672284945845604 Time :  9386
accuracy train: 0.947952 val: 0.767606 test: 0.765616
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({0: 7073, 1: 3589})

Epoch :  27 loss training:  39.74823322147131 Time :  9414
accuracy train: 0.954986 val: 0.763380 test: 0.765053
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({0: 7069, 1: 3593})

Epoch :  28 loss training:  37.199390061199665 Time :  9442
accuracy train: 0.956705 val: 0.760563 test: 0.769274
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({0: 7048, 1: 3614})

Epoch :  29 loss training:  35.343688279390335 Time :  9472
accuracy train: 0.962332 val: 0.756338 test: 0.767304
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({0: 7052, 1: 3610})

Epoch :  30 loss training:  34.493816554546356 Time :  9511
accuracy train: 0.967021 val: 0.763380 test: 0.763647
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({0: 7053, 1: 3609})

Epoch :  31 loss training:  33.28822989016771 Time :  9552
accuracy train: 0.969991 val: 0.761972 test: 0.766460
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({1: 7060, 0: 3602})

Epoch :  32 loss training:  32.41369965299964 Time :  9583
accuracy train: 0.974836 val: 0.764789 test: 0.768149
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({0: 7067, 1: 3595})

Epoch :  33 loss training:  32.138490948826075 Time :  9612
accuracy train: 0.977024 val: 0.767606 test: 0.768711
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({0: 7032, 1: 3630})

Epoch :  34 loss training:  29.280127309262753 Time :  9642
accuracy train: 0.977337 val: 0.766197 test: 0.770681
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({1: 7045, 0: 3617})

Epoch :  35 loss training:  27.74442844837904 Time :  9674
accuracy train: 0.980775 val: 0.759155 test: 0.771806
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({0: 7032, 1: 3630})

Epoch :  36 loss training:  26.557277381420135 Time :  9713
accuracy train: 0.983901 val: 0.759155 test: 0.768711
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({0: 7040, 1: 3622})

Epoch :  37 loss training:  24.956640601158142 Time :  9755
accuracy train: 0.986558 val: 0.757746 test: 0.770400
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({0: 7014, 1: 3648})

Epoch :  38 loss training:  24.618816126137972 Time :  9784
accuracy train: 0.986715 val: 0.759155 test: 0.770681
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({1: 6970, 0: 3692})

Epoch :  39 loss training:  24.07048388570547 Time :  9810
accuracy train: 0.988903 val: 0.754930 test: 0.768430
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.780529
Counter({1: 7003, 0: 3659})

========================================================================================================================================================================================================
max acc epoch :  8
max validation accuracy :  0.7845070422535211
test accuracy :  0.7805289814293753
last test_accuracy :  0.7684299380979178
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	val_accuracy :  78.59154929577464 	test_accuracy :  76.73044456949916 	max_acc epoch :  51 	last test_accuracy :  76.53348339898706
k :  1 	val_accuracy :  77.74647887323944 	test_accuracy :  76.53348339898706 	max_acc epoch :  12 	last test_accuracy :  76.39279684862127
k :  2 	val_accuracy :  78.16901408450704 	test_accuracy :  77.79966235227911 	max_acc epoch :  5 	last test_accuracy :  77.77152504220597
k :  3 	val_accuracy :  77.6056338028169 	test_accuracy :  77.37760270118177 	max_acc epoch :  8 	last test_accuracy :  76.42093415869444
k :  4 	val_accuracy :  78.45070422535211 	test_accuracy :  78.05289814293754 	max_acc epoch :  8 	last test_accuracy :  76.84299380979178

avg :  	val_accuracy :  78.11267605633803 	test_accuracy :  77.29881823297691 	last_accuracy :  76.7923466516601


date and time :  Fri May 21 14:19:36 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=36, weight_decay=0)
device :  cuda:0
Counter({0: 5099, 1: 3374, 2: 2189})

Epoch :  1 loss training:  92.23188662528992 Time :  319
accuracy train: 0.773992 val: 0.764789 test: 0.758019
max validation accuracy : 0.764789 max acc epoch : 1 test accuracy : 0.758019
Counter({2: 3798, 1: 3533, 0: 3331})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.2682013809681 Time :  371
accuracy train: 0.789309 val: 0.767606 test: 0.767586
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.767586
Counter({2: 4330, 0: 3172, 1: 3160})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.54501736164093 Time :  418
accuracy train: 0.802751 val: 0.759155 test: 0.769837
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.767586
Counter({1: 4358, 2: 3188, 0: 3116})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  72.55242934823036 Time :  474
accuracy train: 0.821976 val: 0.778873 test: 0.775464
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.775464
Counter({2: 4393, 1: 3184, 0: 3085})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.93670599162579 Time :  518
accuracy train: 0.836980 val: 0.798592 test: 0.768993
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.768993
Counter({2: 4473, 1: 3105, 0: 3084})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  68.9092025756836 Time :  561
accuracy train: 0.842920 val: 0.777465 test: 0.768149
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.768993
Counter({2: 4699, 1: 3035, 0: 2928})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.13368864357471 Time :  596
accuracy train: 0.854017 val: 0.784507 test: 0.771806
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.768993
Counter({0: 4731, 1: 2977, 2: 2954})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.5442786514759 Time :  641
accuracy train: 0.862613 val: 0.798592 test: 0.772651
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.768993
Counter({0: 4792, 1: 2987, 2: 2883})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.82356119155884 Time :  702
accuracy train: 0.870897 val: 0.800000 test: 0.771244
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({2: 4806, 0: 2963, 1: 2893})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.20045457780361 Time :  762
accuracy train: 0.877305 val: 0.780282 test: 0.765335
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({2: 4880, 0: 2931, 1: 2851})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.61366233229637 Time :  825
accuracy train: 0.882776 val: 0.784507 test: 0.765616
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({2: 4908, 1: 2904, 0: 2850})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.34977826476097 Time :  888
accuracy train: 0.887621 val: 0.780282 test: 0.761958
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({2: 5010, 1: 2855, 0: 2797})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  56.636747777462006 Time :  952
accuracy train: 0.893248 val: 0.777465 test: 0.760833
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 4998, 2: 2855, 0: 2809})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.22722737491131 Time :  1010
accuracy train: 0.896061 val: 0.780282 test: 0.762521
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({0: 5019, 1: 2868, 2: 2775})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  54.57895331084728 Time :  1073
accuracy train: 0.897155 val: 0.776056 test: 0.762240
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({2: 5039, 0: 2864, 1: 2759})

Epoch :  16 loss training:  55.33441300690174 Time :  1131
accuracy train: 0.904345 val: 0.784507 test: 0.761958
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({0: 5081, 1: 2836, 2: 2745})

Epoch :  17 loss training:  53.80879194289446 Time :  1192
accuracy train: 0.910128 val: 0.785915 test: 0.762802
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 5053, 2: 2863, 0: 2746})

Epoch :  18 loss training:  52.06371809542179 Time :  1252
accuracy train: 0.917474 val: 0.781690 test: 0.761396
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({2: 5057, 1: 2856, 0: 2749})

Epoch :  19 loss training:  50.44737155735493 Time :  1319
accuracy train: 0.922476 val: 0.781690 test: 0.763928
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({2: 5052, 1: 2860, 0: 2750})

Epoch :  20 loss training:  48.659097760915756 Time :  1374
accuracy train: 0.926540 val: 0.785915 test: 0.763928
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 5090, 0: 2815, 2: 2757})

Epoch :  21 loss training:  47.141748912632465 Time :  1418
accuracy train: 0.933417 val: 0.788732 test: 0.763365
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 5098, 2: 2804, 0: 2760})

Epoch :  22 loss training:  45.252618588507175 Time :  1463
accuracy train: 0.938262 val: 0.785915 test: 0.763365
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 5092, 2: 2798, 0: 2772})

Epoch :  23 loss training:  44.475039310753345 Time :  1510
accuracy train: 0.946546 val: 0.792958 test: 0.763365
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({2: 5092, 1: 2816, 0: 2754})

Epoch :  24 loss training:  42.856128834187984 Time :  1556
accuracy train: 0.949828 val: 0.792958 test: 0.761114
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({0: 5092, 1: 2804, 2: 2766})

Epoch :  25 loss training:  42.28620661050081 Time :  1604
accuracy train: 0.952173 val: 0.781690 test: 0.765053
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({2: 5090, 0: 2800, 1: 2772})

Epoch :  26 loss training:  39.62732379883528 Time :  1650
accuracy train: 0.957330 val: 0.784507 test: 0.760833
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 5088, 0: 2791, 2: 2783})

Epoch :  27 loss training:  39.37732437252998 Time :  1713
accuracy train: 0.959362 val: 0.788732 test: 0.766460
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 5062, 0: 2805, 2: 2795})

Epoch :  28 loss training:  37.11075150221586 Time :  1785
accuracy train: 0.964364 val: 0.781690 test: 0.761396
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 5051, 0: 2811, 2: 2800})

Epoch :  29 loss training:  35.40128768235445 Time :  1863
accuracy train: 0.967959 val: 0.781690 test: 0.765335
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 5056, 0: 2823, 2: 2783})

Epoch :  30 loss training:  33.54614978283644 Time :  1941
accuracy train: 0.971710 val: 0.774648 test: 0.762521
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({2: 5033, 1: 2865, 0: 2764})

Epoch :  31 loss training:  33.065684117376804 Time :  2034
accuracy train: 0.974836 val: 0.776056 test: 0.757738
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({0: 5024, 1: 2875, 2: 2763})

Epoch :  32 loss training:  31.044898364692926 Time :  2112
accuracy train: 0.977649 val: 0.780282 test: 0.759707
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 5022, 0: 2885, 2: 2755})

Epoch :  33 loss training:  29.53888515383005 Time :  2204
accuracy train: 0.978118 val: 0.776056 test: 0.763084
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({2: 5011, 1: 2878, 0: 2773})

Epoch :  34 loss training:  29.128562673926353 Time :  2284
accuracy train: 0.981400 val: 0.771831 test: 0.757738
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({2: 4967, 0: 2910, 1: 2785})

Epoch :  35 loss training:  27.86284915730357 Time :  2368
accuracy train: 0.984370 val: 0.774648 test: 0.759707
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 4966, 0: 2915, 2: 2781})

Epoch :  36 loss training:  26.771227784454823 Time :  2426
accuracy train: 0.986246 val: 0.777465 test: 0.758582
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({2: 4985, 0: 2931, 1: 2746})

Epoch :  37 loss training:  25.790866136550903 Time :  2511
accuracy train: 0.984683 val: 0.776056 test: 0.761396
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({2: 4959, 0: 2963, 1: 2740})

Epoch :  38 loss training:  25.190832264721394 Time :  2590
accuracy train: 0.987809 val: 0.774648 test: 0.757175
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({0: 4948, 1: 2966, 2: 2748})

Epoch :  39 loss training:  24.823949702084064 Time :  2667
accuracy train: 0.989215 val: 0.771831 test: 0.759145
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 4941, 0: 2987, 2: 2734})

Epoch :  40 loss training:  22.64918002486229 Time :  2736
accuracy train: 0.991404 val: 0.774648 test: 0.758863
max validation accuracy : 0.800000 max acc epoch : 9 test accuracy : 0.771244
Counter({2: 4916, 1: 2998, 0: 2748})

========================================================================================================================================================================================================
max acc epoch :  9
max validation accuracy :  0.8
test accuracy :  0.7712436691052336
last test_accuracy :  0.7588632526730444
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=36, weight_decay=0)
device :  cuda:0
Counter({0: 5099, 1: 3374, 2: 2189})

Epoch :  1 loss training:  92.34336915612221 Time :  3408
accuracy train: 0.773992 val: 0.778873 test: 0.758582
max validation accuracy : 0.778873 max acc epoch : 1 test accuracy : 0.758582
Counter({1: 3921, 2: 3550, 0: 3191})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.19349533319473 Time :  3502
accuracy train: 0.792279 val: 0.773239 test: 0.770400
max validation accuracy : 0.778873 max acc epoch : 1 test accuracy : 0.758582
Counter({1: 4351, 0: 3159, 2: 3152})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.84927725791931 Time :  3586
accuracy train: 0.794467 val: 0.757746 test: 0.770118
max validation accuracy : 0.778873 max acc epoch : 1 test accuracy : 0.758582
Counter({0: 4296, 1: 3292, 2: 3074})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.36988124251366 Time :  3664
accuracy train: 0.819787 val: 0.785915 test: 0.772369
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.772369
Counter({0: 4433, 1: 3211, 2: 3018})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.46756413578987 Time :  3745
accuracy train: 0.837918 val: 0.785915 test: 0.770681
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.772369
Counter({2: 4463, 0: 3229, 1: 2970})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  69.22870805859566 Time :  3814
accuracy train: 0.843076 val: 0.774648 test: 0.773213
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.772369
Counter({1: 4628, 0: 3229, 2: 2805})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.22233580052853 Time :  3917
accuracy train: 0.849953 val: 0.777465 test: 0.770118
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.772369
Counter({1: 4718, 2: 3273, 0: 2671})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.89871937036514 Time :  3972
accuracy train: 0.861207 val: 0.798592 test: 0.770962
max validation accuracy : 0.798592 max acc epoch : 8 test accuracy : 0.770962
Counter({1: 4837, 2: 3212, 0: 2613})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.397497087717056 Time :  4037
accuracy train: 0.864333 val: 0.785915 test: 0.766742
max validation accuracy : 0.798592 max acc epoch : 8 test accuracy : 0.770962
Counter({2: 4913, 1: 3201, 0: 2548})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.90450273454189 Time :  4098
accuracy train: 0.871366 val: 0.778873 test: 0.763928
max validation accuracy : 0.798592 max acc epoch : 8 test accuracy : 0.770962
Counter({0: 4957, 1: 3164, 2: 2541})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.735241919755936 Time :  4169
accuracy train: 0.877462 val: 0.774648 test: 0.766179
max validation accuracy : 0.798592 max acc epoch : 8 test accuracy : 0.770962
Counter({1: 4991, 0: 3165, 2: 2506})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.42776735126972 Time :  4215
accuracy train: 0.880275 val: 0.764789 test: 0.763647
max validation accuracy : 0.798592 max acc epoch : 8 test accuracy : 0.770962
Counter({2: 5079, 0: 3083, 1: 2500})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.638533502817154 Time :  4289
accuracy train: 0.887309 val: 0.781690 test: 0.759989
max validation accuracy : 0.798592 max acc epoch : 8 test accuracy : 0.770962
Counter({1: 5071, 0: 3062, 2: 2529})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.718349158763885 Time :  4337
accuracy train: 0.891529 val: 0.774648 test: 0.765053
max validation accuracy : 0.798592 max acc epoch : 8 test accuracy : 0.770962
Counter({1: 5111, 0: 3029, 2: 2522})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.46903991699219 Time :  4418
accuracy train: 0.897155 val: 0.773239 test: 0.763365
max validation accuracy : 0.798592 max acc epoch : 8 test accuracy : 0.770962
Counter({2: 5112, 0: 3036, 1: 2514})

Epoch :  16 loss training:  56.35819813609123 Time :  4490
accuracy train: 0.899344 val: 0.770423 test: 0.766460
max validation accuracy : 0.798592 max acc epoch : 8 test accuracy : 0.770962
Counter({1: 5157, 2: 3028, 0: 2477})

Epoch :  17 loss training:  54.921363830566406 Time :  4564
accuracy train: 0.903407 val: 0.769014 test: 0.763365
max validation accuracy : 0.798592 max acc epoch : 8 test accuracy : 0.770962
Counter({1: 5147, 2: 3019, 0: 2496})

slurmstepd: error: *** JOB 33462 ON cl-gpusrv1 CANCELLED AT 2021-05-21T15:37:02 ***
