date and time :  Wed Jan  6 19:56:00 2021
Namespace(batch_size=32, dataset='R52', debug=False, device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lr=0.0005, num_layers=3, num_mlp_layers=2, seed=0)
device :  cuda:0
min_len_of_sentence : 0
max_len_of_sentence : 453
min_num_of_sentence : 1
max_num_of_sentence : 43
average_len_of_sentence: 15.948564209083706
average_num_of_sentence: 5.114895947426068
Total_num_of_sentence : 46699
Counter({'earn': 3923, 'acq': 2292, 'crude': 374, 'trade': 326, 'money-fx': 309, 'interest': 272, 'money-supply': 151, 'ship': 144, 'sugar': 122, 'coffee': 112, 'gold': 90, 'gnp': 74, 'cpi': 71, 'cocoa': 61, 'grain': 51, 'alum': 50, 'reserves': 49, 'jobs': 49, 'ipi': 45, 'copper': 44, 'rubber': 40, 'iron-steel': 38, 'nat-gas': 36, 'bop': 31, 'veg-oil': 30, 'tin': 27, 'cotton': 24, 'wpi': 23, 'livestock': 22, 'orange': 22, 'retail': 20, 'pet-chem': 19, 'gas': 18, 'housing': 17, 'strategic-metal': 15, 'lei': 14, 'lumber': 14, 'zinc': 13, 'income': 11, 'meal-feed': 11, 'carcass': 11, 'fuel': 11, 'heat': 10, 'lead': 8, 'instal-debt': 6, 'dlr': 6, 'tea': 5, 'potato': 5, 'nickel': 4, 'cpu': 4, 'platinum': 3, 'jet': 3})
Total_number_of_words: 9334
Total_number_of_categories: 52
Epoch :  1 loss training:  196.27443243563175 Time :  86
accuracy train: 0.876143 val: 0.852896 test: 0.857198
max validation accuracy : 0.8528963414634146 max acc epoch : 1 test accuracy : 0.8571984435797665

Epoch :  2 loss training:  77.75767125189304 Time :  95
accuracy train: 0.941883 val: 0.903963 test: 0.901946
max validation accuracy : 0.9039634146341463 max acc epoch : 2 test accuracy : 0.9019455252918288

Epoch :  3 loss training:  46.273020692169666 Time :  105
accuracy train: 0.967035 val: 0.920732 test: 0.924514
max validation accuracy : 0.9207317073170732 max acc epoch : 3 test accuracy : 0.9245136186770428

Epoch :  4 loss training:  29.364952243864536 Time :  114
accuracy train: 0.981136 val: 0.929878 test: 0.926848
max validation accuracy : 0.9298780487804879 max acc epoch : 4 test accuracy : 0.9268482490272374

Epoch :  5 loss training:  23.464738748967648 Time :  123
accuracy train: 0.987043 val: 0.928354 test: 0.929572
max validation accuracy : 0.9298780487804879 max acc epoch : 4 test accuracy : 0.9268482490272374

Epoch :  6 loss training:  20.659832201898098 Time :  132
accuracy train: 0.986280 val: 0.935213 test: 0.928016
max validation accuracy : 0.9352134146341463 max acc epoch : 6 test accuracy : 0.9280155642023347

Epoch :  7 loss training:  15.19154717028141 Time :  144
accuracy train: 0.995427 val: 0.933689 test: 0.926848
max validation accuracy : 0.9352134146341463 max acc epoch : 6 test accuracy : 0.9280155642023347

Epoch :  8 loss training:  11.605323068797588 Time :  154
accuracy train: 0.995427 val: 0.932927 test: 0.926070
max validation accuracy : 0.9352134146341463 max acc epoch : 6 test accuracy : 0.9280155642023347

Epoch :  9 loss training:  8.871790897101164 Time :  163
accuracy train: 0.995808 val: 0.934451 test: 0.929183
max validation accuracy : 0.9352134146341463 max acc epoch : 6 test accuracy : 0.9280155642023347

Epoch :  10 loss training:  8.553369659930468 Time :  172
accuracy train: 0.994665 val: 0.931402 test: 0.928016
max validation accuracy : 0.9352134146341463 max acc epoch : 6 test accuracy : 0.9280155642023347

Epoch :  11 loss training:  7.529747523367405 Time :  181
accuracy train: 0.997332 val: 0.933689 test: 0.925681
max validation accuracy : 0.9352134146341463 max acc epoch : 6 test accuracy : 0.9280155642023347

Epoch :  12 loss training:  6.142736978828907 Time :  190
accuracy train: 0.997713 val: 0.929878 test: 0.929572
max validation accuracy : 0.9352134146341463 max acc epoch : 6 test accuracy : 0.9280155642023347

Epoch :  13 loss training:  5.893202979117632 Time :  201
accuracy train: 0.997523 val: 0.932165 test: 0.931518
max validation accuracy : 0.9352134146341463 max acc epoch : 6 test accuracy : 0.9280155642023347

Epoch :  14 loss training:  5.720915969461203 Time :  210
accuracy train: 0.997523 val: 0.930640 test: 0.931907
max validation accuracy : 0.9352134146341463 max acc epoch : 6 test accuracy : 0.9280155642023347

Epoch :  15 loss training:  3.867119062691927 Time :  219
accuracy train: 0.998095 val: 0.935213 test: 0.932296
max validation accuracy : 0.9352134146341463 max acc epoch : 6 test accuracy : 0.9280155642023347

Epoch :  16 loss training:  3.5195025093853474 Time :  228
accuracy train: 0.998476 val: 0.935976 test: 0.925292
max validation accuracy : 0.9359756097560976 max acc epoch : 16 test accuracy : 0.9252918287937744

Epoch :  17 loss training:  2.9106901586055756 Time :  237
accuracy train: 0.997904 val: 0.932165 test: 0.932296
max validation accuracy : 0.9359756097560976 max acc epoch : 16 test accuracy : 0.9252918287937744

Epoch :  18 loss training:  2.302362345159054 Time :  246
accuracy train: 0.999047 val: 0.934451 test: 0.928794
max validation accuracy : 0.9359756097560976 max acc epoch : 16 test accuracy : 0.9252918287937744

Epoch :  19 loss training:  3.39233061298728 Time :  255
accuracy train: 0.998857 val: 0.934451 test: 0.932685
max validation accuracy : 0.9359756097560976 max acc epoch : 16 test accuracy : 0.9252918287937744

Epoch :  20 loss training:  2.305549968034029 Time :  265
accuracy train: 0.998476 val: 0.939024 test: 0.935019
max validation accuracy : 0.9390243902439024 max acc epoch : 20 test accuracy : 0.9350194552529183

Epoch :  21 loss training:  2.9144976511597633 Time :  274
accuracy train: 0.998476 val: 0.936738 test: 0.936965
max validation accuracy : 0.9390243902439024 max acc epoch : 20 test accuracy : 0.9350194552529183

Epoch :  22 loss training:  2.4727133587002754 Time :  284
accuracy train: 0.998476 val: 0.932927 test: 0.925681
max validation accuracy : 0.9390243902439024 max acc epoch : 20 test accuracy : 0.9350194552529183

Epoch :  23 loss training:  3.448076207190752 Time :  294
accuracy train: 0.998095 val: 0.927591 test: 0.923346
max validation accuracy : 0.9390243902439024 max acc epoch : 20 test accuracy : 0.9350194552529183

Epoch :  24 loss training:  3.225898191332817 Time :  303
accuracy train: 0.997713 val: 0.932165 test: 0.932296
max validation accuracy : 0.9390243902439024 max acc epoch : 20 test accuracy : 0.9350194552529183

Epoch :  25 loss training:  3.3593448475003242 Time :  312
accuracy train: 0.998285 val: 0.930640 test: 0.927237
max validation accuracy : 0.9390243902439024 max acc epoch : 20 test accuracy : 0.9350194552529183

Epoch :  26 loss training:  1.8839071616530418 Time :  321
accuracy train: 0.998857 val: 0.928354 test: 0.931128
max validation accuracy : 0.9390243902439024 max acc epoch : 20 test accuracy : 0.9350194552529183

Epoch :  27 loss training:  1.6700307354331017 Time :  330
accuracy train: 0.999238 val: 0.934451 test: 0.930739
max validation accuracy : 0.9390243902439024 max acc epoch : 20 test accuracy : 0.9350194552529183

Epoch :  28 loss training:  3.1055873073637486 Time :  340
accuracy train: 0.998857 val: 0.932165 test: 0.928405
max validation accuracy : 0.9390243902439024 max acc epoch : 20 test accuracy : 0.9350194552529183

Epoch :  29 loss training:  2.4115442261099815 Time :  348
accuracy train: 0.998666 val: 0.929878 test: 0.931907
max validation accuracy : 0.9390243902439024 max acc epoch : 20 test accuracy : 0.9350194552529183

Epoch :  30 loss training:  1.4563971161842346 Time :  358
accuracy train: 0.999238 val: 0.935976 test: 0.931907
max validation accuracy : 0.9390243902439024 max acc epoch : 20 test accuracy : 0.9350194552529183

Epoch :  31 loss training:  2.5310192853212357 Time :  367
accuracy train: 0.998476 val: 0.933689 test: 0.928794
max validation accuracy : 0.9390243902439024 max acc epoch : 20 test accuracy : 0.9350194552529183

Epoch :  32 loss training:  3.56076686643064 Time :  376
accuracy train: 0.998476 val: 0.928354 test: 0.922568
max validation accuracy : 0.9390243902439024 max acc epoch : 20 test accuracy : 0.9350194552529183

Epoch :  33 loss training:  3.7356278114020824 Time :  385
accuracy train: 0.999047 val: 0.935213 test: 0.928016
max validation accuracy : 0.9390243902439024 max acc epoch : 20 test accuracy : 0.9350194552529183

Epoch :  34 loss training:  1.7722535878419876 Time :  395
accuracy train: 0.999619 val: 0.939787 test: 0.929572
max validation accuracy : 0.9397865853658537 max acc epoch : 34 test accuracy : 0.9295719844357977

Epoch :  35 loss training:  0.7914563529193401 Time :  404
accuracy train: 0.999619 val: 0.942073 test: 0.929961
max validation accuracy : 0.9420731707317073 max acc epoch : 35 test accuracy : 0.9299610894941635

Epoch :  36 loss training:  1.4492500368505716 Time :  413
accuracy train: 0.999619 val: 0.948171 test: 0.934630
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  37 loss training:  1.2528520114719868 Time :  422
accuracy train: 0.998666 val: 0.935213 test: 0.934630
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  38 loss training:  1.1991840824484825 Time :  431
accuracy train: 0.998666 val: 0.933689 test: 0.934630
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  39 loss training:  1.3360873013734818 Time :  440
accuracy train: 0.999238 val: 0.939024 test: 0.933852
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  40 loss training:  1.0978457480669022 Time :  449
accuracy train: 0.998857 val: 0.941311 test: 0.933463
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  41 loss training:  0.6187757551670074 Time :  458
accuracy train: 0.999619 val: 0.941311 test: 0.932685
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  42 loss training:  0.5765643790364265 Time :  467
accuracy train: 0.999619 val: 0.941311 test: 0.934630
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  43 loss training:  1.036873783916235 Time :  476
accuracy train: 0.999428 val: 0.938262 test: 0.931518
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  44 loss training:  1.5289401561021805 Time :  485
accuracy train: 0.998476 val: 0.935213 test: 0.925681
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  45 loss training:  1.7659898474812508 Time :  495
accuracy train: 0.999238 val: 0.935213 test: 0.931518
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  46 loss training:  1.794642724096775 Time :  503
accuracy train: 0.999428 val: 0.934451 test: 0.924125
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  47 loss training:  1.466127723455429 Time :  513
accuracy train: 0.999238 val: 0.937500 test: 0.929183
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  48 loss training:  1.1887099668383598 Time :  521
accuracy train: 0.997713 val: 0.934451 test: 0.926848
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  49 loss training:  1.6214191801846027 Time :  530
accuracy train: 0.999238 val: 0.935976 test: 0.924903
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  50 loss training:  1.0952927991747856 Time :  539
accuracy train: 0.999619 val: 0.939024 test: 0.926070
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  51 loss training:  1.4313269779086113 Time :  548
accuracy train: 0.999428 val: 0.937500 test: 0.927626
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  52 loss training:  1.0686134416610003 Time :  557
accuracy train: 0.999238 val: 0.935213 test: 0.932685
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  53 loss training:  0.6504422426223755 Time :  566
accuracy train: 0.999428 val: 0.935976 test: 0.926459
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  54 loss training:  1.0309783071279526 Time :  575
accuracy train: 0.999428 val: 0.936738 test: 0.928794
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  55 loss training:  1.8099039159715176 Time :  584
accuracy train: 0.999619 val: 0.937500 test: 0.928405
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  56 loss training:  0.7131816148757935 Time :  593
accuracy train: 0.999428 val: 0.939787 test: 0.930739
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  57 loss training:  0.3607836589217186 Time :  601
accuracy train: 0.999619 val: 0.936738 test: 0.930350
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  58 loss training:  0.6086161881685257 Time :  610
accuracy train: 0.999619 val: 0.936738 test: 0.928016
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  59 loss training:  0.5883004441857338 Time :  618
accuracy train: 0.999428 val: 0.937500 test: 0.928405
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  60 loss training:  1.0434859097003937 Time :  627
accuracy train: 0.999238 val: 0.934451 test: 0.928794
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  61 loss training:  0.7603010386228561 Time :  636
accuracy train: 0.999428 val: 0.933689 test: 0.927237
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  62 loss training:  0.5631233006715775 Time :  645
accuracy train: 0.999238 val: 0.934451 test: 0.922568
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  63 loss training:  0.5643250271677971 Time :  654
accuracy train: 0.999619 val: 0.930640 test: 0.930350
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  64 loss training:  0.5644818767905235 Time :  662
accuracy train: 0.999428 val: 0.932927 test: 0.929572
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  65 loss training:  0.8904326595366001 Time :  671
accuracy train: 0.999428 val: 0.929116 test: 0.930739
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  66 loss training:  0.9787349961698055 Time :  680
accuracy train: 0.999619 val: 0.929116 test: 0.932296
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

Epoch :  67 loss training:  0.6153159886598587 Time :  689
accuracy train: 0.999619 val: 0.934451 test: 0.930739
max validation accuracy : 0.948170731707317 max acc epoch : 36 test accuracy : 0.9346303501945525

========================================================================================================================================================================================================
max acc epoch :  36
max validation accuracy :  0.948170731707317
test accuracy :  0.9346303501945525
latest_test_accuracy :  0.930739299610895
========================================================================================================================================================================================================

