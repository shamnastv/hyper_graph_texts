

date and time :  Thu Jun  3 10:14:19 2021
itr : 0
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=339, weight_decay=1e-08)
device :  cuda:0
Counter({0: 5417, 2: 2501, 1: 1212})

Epoch :  1 loss training:  124.61145271360874 Time :  59
accuracy train: 0.904810 val: 0.896341 test: 0.891051
max validation accuracy : 0.896341 max acc epoch : 1 test accuracy : 0.891051
Counter({1: 3683, 0: 2872, 2: 2575})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.721404388546944 Time :  88
accuracy train: 0.938178 val: 0.917683 test: 0.911284
max validation accuracy : 0.917683 max acc epoch : 2 test accuracy : 0.911284
Counter({2: 3781, 0: 2833, 1: 2516})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  40.35358592867851 Time :  113
accuracy train: 0.936992 val: 0.907012 test: 0.923346
max validation accuracy : 0.917683 max acc epoch : 2 test accuracy : 0.911284
Counter({1: 3759, 0: 2878, 2: 2493})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  26.922759988810867 Time :  147
accuracy train: 0.967818 val: 0.929878 test: 0.923346
max validation accuracy : 0.929878 max acc epoch : 4 test accuracy : 0.923346
Counter({1: 3839, 0: 2861, 2: 2430})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  22.344547799788415 Time :  192
accuracy train: 0.977304 val: 0.948171 test: 0.942023
max validation accuracy : 0.948171 max acc epoch : 5 test accuracy : 0.942023
Counter({1: 3837, 0: 2873, 2: 2420})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  19.156526749953628 Time :  220
accuracy train: 0.977642 val: 0.931402 test: 0.938521
max validation accuracy : 0.948171 max acc epoch : 5 test accuracy : 0.942023
Counter({1: 3842, 0: 2884, 2: 2404})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  16.384692968800664 Time :  252
accuracy train: 0.983909 val: 0.946646 test: 0.942023
max validation accuracy : 0.948171 max acc epoch : 5 test accuracy : 0.942023
Counter({1: 3859, 0: 2873, 2: 2398})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  13.72766732191667 Time :  286
accuracy train: 0.988144 val: 0.948171 test: 0.946304
max validation accuracy : 0.948171 max acc epoch : 5 test accuracy : 0.942023
Counter({2: 3869, 0: 2868, 1: 2393})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  13.045671502593905 Time :  313
accuracy train: 0.988144 val: 0.949695 test: 0.948638
max validation accuracy : 0.949695 max acc epoch : 9 test accuracy : 0.948638
Counter({1: 3868, 2: 2867, 0: 2395})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  10.987672702874988 Time :  352
accuracy train: 0.988821 val: 0.949695 test: 0.947082
max validation accuracy : 0.949695 max acc epoch : 9 test accuracy : 0.948638
Counter({2: 3869, 0: 2869, 1: 2392})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  10.876904190983623 Time :  382
accuracy train: 0.990346 val: 0.948171 test: 0.948249
max validation accuracy : 0.949695 max acc epoch : 9 test accuracy : 0.948638
Counter({2: 3873, 0: 2871, 1: 2386})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  10.8403440262191 Time :  409
accuracy train: 0.988652 val: 0.951220 test: 0.950195
max validation accuracy : 0.951220 max acc epoch : 12 test accuracy : 0.950195
Counter({1: 3878, 0: 2873, 2: 2379})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  9.783636226318777 Time :  437
accuracy train: 0.991192 val: 0.951220 test: 0.946693
max validation accuracy : 0.951220 max acc epoch : 12 test accuracy : 0.950195
Counter({0: 3882, 2: 2872, 1: 2376})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  9.477291894610971 Time :  464
accuracy train: 0.991531 val: 0.952744 test: 0.945914
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.945914
Counter({2: 3885, 0: 2870, 1: 2375})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  8.81116106826812 Time :  497
accuracy train: 0.991192 val: 0.952744 test: 0.942412
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.945914
Counter({2: 3886, 0: 2871, 1: 2373})

Epoch :  16 loss training:  8.945530638564378 Time :  533
accuracy train: 0.992039 val: 0.951220 test: 0.945136
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.945914
Counter({1: 3886, 2: 2871, 0: 2373})

Epoch :  17 loss training:  8.251277446281165 Time :  564
accuracy train: 0.991870 val: 0.952744 test: 0.949027
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.945914
Counter({2: 3886, 0: 2871, 1: 2373})

Epoch :  18 loss training:  8.072361282072961 Time :  595
accuracy train: 0.992717 val: 0.951220 test: 0.950973
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.945914
Counter({2: 3888, 0: 2868, 1: 2374})

Epoch :  19 loss training:  8.499257876072079 Time :  631
accuracy train: 0.993225 val: 0.951220 test: 0.950195
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.945914
Counter({2: 3887, 0: 2871, 1: 2372})

Epoch :  20 loss training:  8.031117532402277 Time :  659
accuracy train: 0.993902 val: 0.951220 test: 0.949027
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.945914
Counter({2: 3887, 0: 2871, 1: 2372})

Epoch :  21 loss training:  7.190527226310223 Time :  695
accuracy train: 0.994580 val: 0.949695 test: 0.947860
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.945914
Counter({2: 3890, 0: 2869, 1: 2371})

Epoch :  22 loss training:  7.293237923178822 Time :  726
accuracy train: 0.994072 val: 0.948171 test: 0.948638
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.945914
Counter({1: 3897, 0: 2866, 2: 2367})

Epoch :  23 loss training:  7.1137177143245935 Time :  754
accuracy train: 0.994411 val: 0.951220 test: 0.950195
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.945914
Counter({1: 3897, 0: 2867, 2: 2366})

Epoch :  24 loss training:  6.641157176345587 Time :  795
accuracy train: 0.994411 val: 0.951220 test: 0.949416
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.945914
Counter({2: 3899, 0: 2867, 1: 2364})

Epoch :  25 loss training:  6.714252954348922 Time :  832
accuracy train: 0.994749 val: 0.946646 test: 0.949416
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.945914
Counter({1: 3900, 0: 2873, 2: 2357})

Epoch :  26 loss training:  6.084319609915838 Time :  859
accuracy train: 0.995596 val: 0.948171 test: 0.949027
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.945914
Counter({1: 3903, 0: 2874, 2: 2353})

Epoch :  27 loss training:  6.218940585851669 Time :  889
accuracy train: 0.995088 val: 0.951220 test: 0.950584
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.945914
Counter({2: 3903, 0: 2872, 1: 2355})

Epoch :  28 loss training:  5.754658041289076 Time :  917
accuracy train: 0.995088 val: 0.954268 test: 0.950195
max validation accuracy : 0.954268 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3907, 0: 2875, 2: 2348})

Epoch :  29 loss training:  5.8536895686993375 Time :  949
accuracy train: 0.995766 val: 0.954268 test: 0.946693
max validation accuracy : 0.954268 max acc epoch : 28 test accuracy : 0.950195
Counter({2: 3908, 0: 2876, 1: 2346})

Epoch :  30 loss training:  5.452866124920547 Time :  985
accuracy train: 0.994919 val: 0.951220 test: 0.949416
max validation accuracy : 0.954268 max acc epoch : 28 test accuracy : 0.950195
Counter({2: 3909, 0: 2883, 1: 2338})

Epoch :  31 loss training:  5.180610631359741 Time :  1016
accuracy train: 0.995766 val: 0.949695 test: 0.947082
max validation accuracy : 0.954268 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3912, 0: 2883, 2: 2335})

Epoch :  32 loss training:  4.958316070144065 Time :  1047
accuracy train: 0.996612 val: 0.948171 test: 0.949805
max validation accuracy : 0.954268 max acc epoch : 28 test accuracy : 0.950195
Counter({2: 3912, 0: 2883, 1: 2335})

Epoch :  33 loss training:  4.818410295294598 Time :  1081
accuracy train: 0.996443 val: 0.948171 test: 0.949805
max validation accuracy : 0.954268 max acc epoch : 28 test accuracy : 0.950195
Counter({2: 3918, 0: 2882, 1: 2330})

Epoch :  34 loss training:  4.891276566544548 Time :  1114
accuracy train: 0.995766 val: 0.954268 test: 0.950584
max validation accuracy : 0.954268 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3918, 0: 2882, 2: 2330})

Epoch :  35 loss training:  4.525533256586641 Time :  1144
accuracy train: 0.996443 val: 0.951220 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3918, 0: 2882, 2: 2330})

Epoch :  36 loss training:  4.791112091392279 Time :  1172
accuracy train: 0.995935 val: 0.951220 test: 0.950584
max validation accuracy : 0.954268 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3918, 0: 2883, 2: 2329})

Epoch :  37 loss training:  4.596816527599003 Time :  1198
accuracy train: 0.996274 val: 0.954268 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3919, 0: 2885, 2: 2326})

Epoch :  38 loss training:  4.117635161499493 Time :  1242
accuracy train: 0.996274 val: 0.954268 test: 0.948638
max validation accuracy : 0.954268 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3920, 0: 2885, 2: 2325})

Epoch :  39 loss training:  4.054481228580698 Time :  1269
accuracy train: 0.996104 val: 0.954268 test: 0.947860
max validation accuracy : 0.954268 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3920, 0: 2886, 2: 2324})

Epoch :  40 loss training:  4.178400323493406 Time :  1299
accuracy train: 0.996951 val: 0.954268 test: 0.950584
max validation accuracy : 0.954268 max acc epoch : 28 test accuracy : 0.950195
Counter({0: 3920, 2: 2892, 1: 2318})

Epoch :  41 loss training:  3.5383425657637417 Time :  1337
accuracy train: 0.995766 val: 0.954268 test: 0.949416
max validation accuracy : 0.954268 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3920, 0: 2892, 2: 2318})

Epoch :  42 loss training:  3.694881426403299 Time :  1370
accuracy train: 0.996443 val: 0.949695 test: 0.950584
max validation accuracy : 0.954268 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3921, 0: 2892, 2: 2317})

Epoch :  43 loss training:  3.56057611387223 Time :  1413
accuracy train: 0.996104 val: 0.948171 test: 0.950195
max validation accuracy : 0.954268 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3921, 0: 2894, 2: 2315})

Epoch :  44 loss training:  3.5808535730466247 Time :  1442
accuracy train: 0.996274 val: 0.949695 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3921, 0: 2893, 2: 2316})

Epoch :  45 loss training:  3.756619593477808 Time :  1481
accuracy train: 0.996104 val: 0.954268 test: 0.950584
max validation accuracy : 0.954268 max acc epoch : 28 test accuracy : 0.950195
Counter({2: 3920, 0: 2894, 1: 2316})

Epoch :  46 loss training:  3.721345930825919 Time :  1516
accuracy train: 0.996274 val: 0.952744 test: 0.948638
max validation accuracy : 0.954268 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3920, 0: 2894, 2: 2316})

Epoch :  47 loss training:  3.332173420698382 Time :  1549
accuracy train: 0.996274 val: 0.951220 test: 0.949805
max validation accuracy : 0.954268 max acc epoch : 28 test accuracy : 0.950195
Counter({2: 3919, 0: 2894, 1: 2317})

Epoch :  48 loss training:  3.4850553158903494 Time :  1589
accuracy train: 0.995935 val: 0.955793 test: 0.951751
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({1: 3919, 0: 2894, 2: 2317})

Epoch :  49 loss training:  3.0383687095018104 Time :  1629
accuracy train: 0.996443 val: 0.949695 test: 0.946693
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({1: 3919, 2: 2895, 0: 2316})

Epoch :  50 loss training:  3.2052391605684534 Time :  1663
accuracy train: 0.996274 val: 0.952744 test: 0.949027
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({2: 3919, 0: 2895, 1: 2316})

Epoch :  51 loss training:  3.1525231531704776 Time :  1691
accuracy train: 0.996782 val: 0.949695 test: 0.947860
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({2: 3919, 0: 2894, 1: 2317})

Epoch :  52 loss training:  3.384296606120188 Time :  1720
accuracy train: 0.996443 val: 0.949695 test: 0.947860
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({2: 3919, 0: 2895, 1: 2316})

Epoch :  53 loss training:  2.728774442046415 Time :  1765
accuracy train: 0.996782 val: 0.949695 test: 0.947860
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({1: 3919, 0: 2895, 2: 2316})

Epoch :  54 loss training:  2.8340973959420808 Time :  1797
accuracy train: 0.996782 val: 0.948171 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({2: 3921, 0: 2893, 1: 2316})

Epoch :  55 loss training:  2.9246372140478343 Time :  1830
accuracy train: 0.996782 val: 0.948171 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({2: 3921, 0: 2893, 1: 2316})

Epoch :  56 loss training:  2.501022189448122 Time :  1859
accuracy train: 0.996782 val: 0.948171 test: 0.948638
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({1: 3921, 0: 2893, 2: 2316})

Epoch :  57 loss training:  3.006131742760772 Time :  1890
accuracy train: 0.996951 val: 0.951220 test: 0.947471
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({2: 3921, 0: 2892, 1: 2317})

Epoch :  58 loss training:  2.877298230305314 Time :  1921
accuracy train: 0.996782 val: 0.949695 test: 0.946304
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({0: 3921, 2: 2892, 1: 2317})

Epoch :  59 loss training:  2.4722885789815336 Time :  1959
accuracy train: 0.997121 val: 0.948171 test: 0.950973
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({1: 3921, 0: 2893, 2: 2316})

Epoch :  60 loss training:  2.373594868055079 Time :  1989
accuracy train: 0.996951 val: 0.948171 test: 0.949805
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({2: 3920, 0: 2894, 1: 2316})

Epoch :  61 loss training:  2.6921076209982857 Time :  2021
accuracy train: 0.996951 val: 0.946646 test: 0.948249
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({1: 3920, 0: 2900, 2: 2310})

Epoch :  62 loss training:  2.867928405525163 Time :  2055
accuracy train: 0.997121 val: 0.948171 test: 0.948249
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({2: 3920, 0: 2903, 1: 2307})

Epoch :  63 loss training:  2.5093685531173833 Time :  2082
accuracy train: 0.996443 val: 0.949695 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({1: 3920, 0: 2902, 2: 2308})

Epoch :  64 loss training:  2.310956250221352 Time :  2116
accuracy train: 0.997121 val: 0.952744 test: 0.948249
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({1: 3920, 0: 2903, 2: 2307})

Epoch :  65 loss training:  2.655913360969862 Time :  2148
accuracy train: 0.996782 val: 0.949695 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({1: 3920, 0: 2903, 2: 2307})

Epoch :  66 loss training:  2.279789786087349 Time :  2177
accuracy train: 0.996951 val: 0.949695 test: 0.950584
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({1: 3920, 2: 2902, 0: 2308})

Epoch :  67 loss training:  2.204475680307951 Time :  2209
accuracy train: 0.996782 val: 0.952744 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({0: 3920, 1: 2901, 2: 2309})

Epoch :  68 loss training:  2.202937116031535 Time :  2237
accuracy train: 0.996782 val: 0.951220 test: 0.947860
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({1: 3920, 0: 2901, 2: 2309})

Epoch :  69 loss training:  2.725611957546789 Time :  2266
accuracy train: 0.997121 val: 0.952744 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({2: 3920, 0: 2901, 1: 2309})

Epoch :  70 loss training:  2.382475469057681 Time :  2294
accuracy train: 0.996951 val: 0.949695 test: 0.950973
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({2: 3920, 0: 2901, 1: 2309})

Epoch :  71 loss training:  2.185974695137702 Time :  2330
accuracy train: 0.996782 val: 0.949695 test: 0.948249
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({0: 3920, 2: 2901, 1: 2309})

Epoch :  72 loss training:  2.3391103609392303 Time :  2361
accuracy train: 0.997121 val: 0.948171 test: 0.949027
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({1: 3920, 0: 2906, 2: 2304})

Epoch :  73 loss training:  2.1873434512817767 Time :  2399
accuracy train: 0.997121 val: 0.946646 test: 0.950584
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({1: 3920, 0: 2906, 2: 2304})

Epoch :  74 loss training:  2.2854159163398435 Time :  2431
accuracy train: 0.996612 val: 0.954268 test: 0.953307
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({2: 3920, 0: 2906, 1: 2304})

Epoch :  75 loss training:  2.6132514530909248 Time :  2461
accuracy train: 0.997121 val: 0.949695 test: 0.948638
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({1: 3920, 0: 2907, 2: 2303})

Epoch :  76 loss training:  2.1052671394718345 Time :  2494
accuracy train: 0.996951 val: 0.942073 test: 0.947860
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({2: 3920, 0: 2907, 1: 2303})

Epoch :  77 loss training:  2.080895125225652 Time :  2529
accuracy train: 0.997121 val: 0.951220 test: 0.946304
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({2: 3920, 0: 2907, 1: 2303})

Epoch :  78 loss training:  2.103190289795748 Time :  2557
accuracy train: 0.996612 val: 0.949695 test: 0.946304
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({1: 3920, 0: 2907, 2: 2303})

Epoch :  79 loss training:  2.086626777643687 Time :  2583
accuracy train: 0.997121 val: 0.952744 test: 0.945914
max validation accuracy : 0.955793 max acc epoch : 48 test accuracy : 0.951751
Counter({1: 3920, 0: 2907, 2: 2303})

========================================================================================================================================================================================================
max acc epoch :  48
max validation accuracy :  0.9557926829268293
test accuracy :  0.9517509727626459
last test_accuracy :  0.9459143968871595
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=339, weight_decay=1e-08)
device :  cuda:0
Counter({0: 5417, 2: 2501, 1: 1212})

Epoch :  1 loss training:  124.6301658153534 Time :  2625
accuracy train: 0.907012 val: 0.897866 test: 0.889494
max validation accuracy : 0.897866 max acc epoch : 1 test accuracy : 0.889494
Counter({1: 3721, 0: 2862, 2: 2547})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.64303104579449 Time :  2654
accuracy train: 0.933096 val: 0.914634 test: 0.907782
max validation accuracy : 0.914634 max acc epoch : 2 test accuracy : 0.907782
Counter({1: 3765, 0: 2841, 2: 2524})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  41.05724883452058 Time :  2689
accuracy train: 0.937839 val: 0.913110 test: 0.924903
max validation accuracy : 0.914634 max acc epoch : 2 test accuracy : 0.907782
Counter({1: 3717, 0: 2917, 2: 2496})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  26.92806465504691 Time :  2721
accuracy train: 0.965278 val: 0.928354 test: 0.924514
max validation accuracy : 0.928354 max acc epoch : 4 test accuracy : 0.924514
Counter({1: 3800, 2: 2882, 0: 2448})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  22.030213560909033 Time :  2749
accuracy train: 0.976795 val: 0.945122 test: 0.943580
max validation accuracy : 0.945122 max acc epoch : 5 test accuracy : 0.943580
Counter({1: 3805, 0: 2904, 2: 2421})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  19.148888726718724 Time :  2778
accuracy train: 0.975949 val: 0.931402 test: 0.936576
max validation accuracy : 0.945122 max acc epoch : 5 test accuracy : 0.943580
Counter({1: 3786, 0: 2941, 2: 2403})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  16.448536951094866 Time :  2814
accuracy train: 0.983570 val: 0.946646 test: 0.944747
max validation accuracy : 0.946646 max acc epoch : 7 test accuracy : 0.944747
Counter({2: 3808, 1: 2901, 0: 2421})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  13.86667580716312 Time :  2844
accuracy train: 0.987297 val: 0.948171 test: 0.945136
max validation accuracy : 0.948171 max acc epoch : 8 test accuracy : 0.945136
Counter({2: 3824, 0: 2886, 1: 2420})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  13.122220450080931 Time :  2870
accuracy train: 0.988991 val: 0.954268 test: 0.950584
max validation accuracy : 0.954268 max acc epoch : 9 test accuracy : 0.950584
Counter({1: 3865, 0: 2877, 2: 2388})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  10.912519749253988 Time :  2895
accuracy train: 0.989668 val: 0.948171 test: 0.947082
max validation accuracy : 0.954268 max acc epoch : 9 test accuracy : 0.950584
Counter({1: 3869, 0: 2877, 2: 2384})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  10.526655576191843 Time :  2918
accuracy train: 0.990684 val: 0.948171 test: 0.947860
max validation accuracy : 0.954268 max acc epoch : 9 test accuracy : 0.950584
Counter({2: 3876, 0: 2876, 1: 2378})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  10.72621597442776 Time :  2942
accuracy train: 0.989499 val: 0.946646 test: 0.950973
max validation accuracy : 0.954268 max acc epoch : 9 test accuracy : 0.950584
Counter({1: 3886, 0: 2871, 2: 2373})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  9.729416173882782 Time :  2975
accuracy train: 0.991870 val: 0.952744 test: 0.947082
max validation accuracy : 0.954268 max acc epoch : 9 test accuracy : 0.950584
Counter({1: 3886, 0: 2871, 2: 2373})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  9.478125990368426 Time :  3005
accuracy train: 0.992209 val: 0.949695 test: 0.948249
max validation accuracy : 0.954268 max acc epoch : 9 test accuracy : 0.950584
Counter({1: 3886, 0: 2870, 2: 2374})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  8.675577935762703 Time :  3030
accuracy train: 0.991531 val: 0.949695 test: 0.946693
max validation accuracy : 0.954268 max acc epoch : 9 test accuracy : 0.950584
Counter({1: 3886, 0: 2871, 2: 2373})

Epoch :  16 loss training:  8.690877290442586 Time :  3059
accuracy train: 0.992209 val: 0.946646 test: 0.947082
max validation accuracy : 0.954268 max acc epoch : 9 test accuracy : 0.950584
Counter({2: 3885, 0: 2870, 1: 2375})

Epoch :  17 loss training:  8.230123011162505 Time :  3083
accuracy train: 0.992039 val: 0.946646 test: 0.951751
max validation accuracy : 0.954268 max acc epoch : 9 test accuracy : 0.950584
Counter({1: 3887, 2: 2869, 0: 2374})

Epoch :  18 loss training:  7.99953951779753 Time :  3107
accuracy train: 0.993056 val: 0.951220 test: 0.951362
max validation accuracy : 0.954268 max acc epoch : 9 test accuracy : 0.950584
Counter({2: 3888, 0: 2868, 1: 2374})

Epoch :  19 loss training:  8.546946669695899 Time :  3130
accuracy train: 0.992717 val: 0.951220 test: 0.951362
max validation accuracy : 0.954268 max acc epoch : 9 test accuracy : 0.950584
Counter({2: 3887, 0: 2871, 1: 2372})

Epoch :  20 loss training:  7.920731846243143 Time :  3168
accuracy train: 0.993564 val: 0.948171 test: 0.949416
max validation accuracy : 0.954268 max acc epoch : 9 test accuracy : 0.950584
Counter({1: 3888, 0: 2871, 2: 2371})

Epoch :  21 loss training:  7.267727968515828 Time :  3203
accuracy train: 0.994241 val: 0.951220 test: 0.951362
max validation accuracy : 0.954268 max acc epoch : 9 test accuracy : 0.950584
Counter({0: 3891, 1: 2868, 2: 2371})

Epoch :  22 loss training:  7.269657772034407 Time :  3234
accuracy train: 0.994411 val: 0.948171 test: 0.949805
max validation accuracy : 0.954268 max acc epoch : 9 test accuracy : 0.950584
Counter({2: 3899, 0: 2870, 1: 2361})

Epoch :  23 loss training:  6.799750378821045 Time :  3272
accuracy train: 0.994749 val: 0.951220 test: 0.951751
max validation accuracy : 0.954268 max acc epoch : 9 test accuracy : 0.950584
Counter({1: 3899, 0: 2871, 2: 2360})

Epoch :  24 loss training:  6.5112220998853445 Time :  3305
accuracy train: 0.994411 val: 0.948171 test: 0.950973
max validation accuracy : 0.954268 max acc epoch : 9 test accuracy : 0.950584
Counter({2: 3902, 0: 2870, 1: 2358})

Epoch :  25 loss training:  6.721677463967353 Time :  3335
accuracy train: 0.995257 val: 0.949695 test: 0.950584
max validation accuracy : 0.954268 max acc epoch : 9 test accuracy : 0.950584
Counter({1: 3905, 0: 2875, 2: 2350})

Epoch :  26 loss training:  6.196318620350212 Time :  3374
accuracy train: 0.995427 val: 0.949695 test: 0.947082
max validation accuracy : 0.954268 max acc epoch : 9 test accuracy : 0.950584
Counter({1: 3910, 0: 2880, 2: 2340})

Epoch :  27 loss training:  6.090858542360365 Time :  3406
accuracy train: 0.995257 val: 0.954268 test: 0.950973
max validation accuracy : 0.954268 max acc epoch : 9 test accuracy : 0.950584
Counter({1: 3910, 0: 2879, 2: 2341})

Epoch :  28 loss training:  5.738387190853246 Time :  3431
accuracy train: 0.995596 val: 0.955793 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({2: 3912, 0: 2881, 1: 2337})

Epoch :  29 loss training:  5.957701902487315 Time :  3458
accuracy train: 0.995596 val: 0.955793 test: 0.947082
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3914, 2: 2881, 0: 2335})

Epoch :  30 loss training:  5.37966104131192 Time :  3496
accuracy train: 0.995596 val: 0.955793 test: 0.951362
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3915, 0: 2883, 2: 2332})

Epoch :  31 loss training:  5.0467190344352275 Time :  3524
accuracy train: 0.995766 val: 0.948171 test: 0.946693
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({2: 3917, 1: 2882, 0: 2331})

Epoch :  32 loss training:  4.966258354485035 Time :  3549
accuracy train: 0.996274 val: 0.949695 test: 0.949027
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3917, 0: 2882, 2: 2331})

Epoch :  33 loss training:  4.827432798454538 Time :  3576
accuracy train: 0.996104 val: 0.949695 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({2: 3919, 0: 2882, 1: 2329})

Epoch :  34 loss training:  5.033272882690653 Time :  3603
accuracy train: 0.995596 val: 0.954268 test: 0.951362
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3919, 0: 2881, 2: 2330})

Epoch :  35 loss training:  4.593392367125489 Time :  3631
accuracy train: 0.996104 val: 0.948171 test: 0.950973
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3921, 0: 2881, 2: 2328})

Epoch :  36 loss training:  4.830640859669074 Time :  3665
accuracy train: 0.996104 val: 0.954268 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({2: 3921, 0: 2882, 1: 2327})

Epoch :  37 loss training:  4.588009098311886 Time :  3694
accuracy train: 0.995935 val: 0.955793 test: 0.950584
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({2: 3922, 0: 2886, 1: 2322})

Epoch :  38 loss training:  4.087694454705343 Time :  3719
accuracy train: 0.996104 val: 0.952744 test: 0.951362
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({2: 3922, 0: 2885, 1: 2323})

Epoch :  39 loss training:  3.977024425403215 Time :  3751
accuracy train: 0.996104 val: 0.952744 test: 0.949805
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3921, 0: 2886, 2: 2323})

Epoch :  40 loss training:  4.072092343121767 Time :  3777
accuracy train: 0.996951 val: 0.949695 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({2: 3921, 0: 2886, 1: 2323})

Epoch :  41 loss training:  3.576689538429491 Time :  3802
accuracy train: 0.996274 val: 0.954268 test: 0.952140
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3922, 0: 2885, 2: 2323})

Epoch :  42 loss training:  3.7354087190469727 Time :  3831
accuracy train: 0.996443 val: 0.948171 test: 0.952918
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({2: 3922, 0: 2885, 1: 2323})

Epoch :  43 loss training:  3.64649099111557 Time :  3861
accuracy train: 0.996274 val: 0.949695 test: 0.952918
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3924, 0: 2886, 2: 2320})

Epoch :  44 loss training:  3.434816123684868 Time :  3887
accuracy train: 0.996443 val: 0.949695 test: 0.952529
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({0: 3923, 2: 2887, 1: 2320})

Epoch :  45 loss training:  3.7750193678075448 Time :  3913
accuracy train: 0.996443 val: 0.955793 test: 0.952918
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3922, 0: 2888, 2: 2320})

Epoch :  46 loss training:  3.6661275945371017 Time :  3946
accuracy train: 0.996612 val: 0.954268 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3922, 0: 2888, 2: 2320})

Epoch :  47 loss training:  3.4436085700872354 Time :  3973
accuracy train: 0.996612 val: 0.952744 test: 0.952529
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({2: 3922, 0: 2888, 1: 2320})

Epoch :  48 loss training:  3.519197823945433 Time :  3999
accuracy train: 0.995935 val: 0.955793 test: 0.952140
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3922, 0: 2891, 2: 2317})

Epoch :  49 loss training:  3.112682051723823 Time :  4028
accuracy train: 0.996274 val: 0.948171 test: 0.951751
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({2: 3921, 0: 2891, 1: 2318})

Epoch :  50 loss training:  3.187253898649942 Time :  4058
accuracy train: 0.996443 val: 0.951220 test: 0.950973
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({0: 3922, 2: 2892, 1: 2316})

Epoch :  51 loss training:  3.096306488267146 Time :  4084
accuracy train: 0.996782 val: 0.952744 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3922, 0: 2891, 2: 2317})

Epoch :  52 loss training:  3.397264265746344 Time :  4108
accuracy train: 0.996612 val: 0.949695 test: 0.948638
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3922, 0: 2892, 2: 2316})

Epoch :  53 loss training:  2.739401700673625 Time :  4141
accuracy train: 0.997121 val: 0.951220 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({2: 3922, 0: 2892, 1: 2316})

Epoch :  54 loss training:  2.7309004879789427 Time :  4173
accuracy train: 0.997121 val: 0.951220 test: 0.951362
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3923, 2: 2890, 0: 2317})

Epoch :  55 loss training:  3.0851765302359127 Time :  4199
accuracy train: 0.996782 val: 0.946646 test: 0.947471
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({2: 3923, 0: 2891, 1: 2316})

Epoch :  56 loss training:  2.4609103979892097 Time :  4230
accuracy train: 0.996782 val: 0.948171 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3924, 0: 2890, 2: 2316})

Epoch :  57 loss training:  2.9985706103034317 Time :  4254
accuracy train: 0.996951 val: 0.948171 test: 0.948638
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({2: 3923, 0: 2889, 1: 2318})

Epoch :  58 loss training:  2.8563256000052206 Time :  4286
accuracy train: 0.996782 val: 0.951220 test: 0.948638
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({1: 3923, 0: 2890, 2: 2317})

Epoch :  59 loss training:  2.497426607995294 Time :  4313
accuracy train: 0.997121 val: 0.951220 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 28 test accuracy : 0.950195
Counter({2: 3923, 1: 2892, 0: 2315})

========================================================================================================================================================================================================
max acc epoch :  28
max validation accuracy :  0.9557926829268293
test accuracy :  0.9501945525291828
last test_accuracy :  0.9494163424124513
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=339, weight_decay=1e-08)
device :  cuda:0
Counter({0: 5417, 2: 2501, 1: 1212})

Epoch :  1 loss training:  124.67984917759895 Time :  4347
accuracy train: 0.906843 val: 0.900915 test: 0.889494
max validation accuracy : 0.900915 max acc epoch : 1 test accuracy : 0.889494
Counter({1: 3684, 0: 2873, 2: 2573})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.72562991082668 Time :  4373
accuracy train: 0.937161 val: 0.917683 test: 0.910117
max validation accuracy : 0.917683 max acc epoch : 2 test accuracy : 0.910117
Counter({1: 3775, 2: 2821, 0: 2534})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  40.86881718412042 Time :  4396
accuracy train: 0.939024 val: 0.914634 test: 0.924514
max validation accuracy : 0.917683 max acc epoch : 2 test accuracy : 0.910117
Counter({1: 3737, 0: 2873, 2: 2520})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  26.429593917448074 Time :  4429
accuracy train: 0.966125 val: 0.920732 test: 0.921790
max validation accuracy : 0.920732 max acc epoch : 4 test accuracy : 0.921790
Counter({1: 3817, 2: 2868, 0: 2445})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  22.263355035334826 Time :  4456
accuracy train: 0.978659 val: 0.943598 test: 0.943580
max validation accuracy : 0.943598 max acc epoch : 5 test accuracy : 0.943580
Counter({1: 3829, 0: 2881, 2: 2420})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  19.013444519601762 Time :  4481
accuracy train: 0.978150 val: 0.934451 test: 0.936187
max validation accuracy : 0.943598 max acc epoch : 5 test accuracy : 0.943580
Counter({2: 3808, 0: 2911, 1: 2411})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  16.469420792534947 Time :  4509
accuracy train: 0.984417 val: 0.946646 test: 0.941634
max validation accuracy : 0.946646 max acc epoch : 7 test accuracy : 0.941634
Counter({1: 3852, 0: 2875, 2: 2403})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  13.938249468803406 Time :  4538
accuracy train: 0.989160 val: 0.946646 test: 0.944747
max validation accuracy : 0.946646 max acc epoch : 7 test accuracy : 0.941634
Counter({0: 3865, 2: 2865, 1: 2400})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  12.950988776050508 Time :  4565
accuracy train: 0.988482 val: 0.955793 test: 0.948249
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({1: 3867, 2: 2871, 0: 2392})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  10.978371032513678 Time :  4591
accuracy train: 0.989160 val: 0.948171 test: 0.945914
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({1: 3869, 0: 2873, 2: 2388})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  10.83842584816739 Time :  4626
accuracy train: 0.990684 val: 0.948171 test: 0.945525
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({1: 3878, 0: 2870, 2: 2382})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  10.75649229157716 Time :  4655
accuracy train: 0.988482 val: 0.948171 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({1: 3882, 0: 2868, 2: 2380})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  9.92732050968334 Time :  4680
accuracy train: 0.991362 val: 0.949695 test: 0.947860
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({1: 3882, 0: 2869, 2: 2379})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  9.442135706543922 Time :  4705
accuracy train: 0.991701 val: 0.951220 test: 0.946304
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({1: 3882, 0: 2870, 2: 2378})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  8.705975253134966 Time :  4737
accuracy train: 0.991362 val: 0.949695 test: 0.943580
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({1: 3886, 0: 2870, 2: 2374})

Epoch :  16 loss training:  8.870425961911678 Time :  4767
accuracy train: 0.991362 val: 0.946646 test: 0.943580
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({1: 3887, 0: 2870, 2: 2373})

Epoch :  17 loss training:  8.29315704992041 Time :  4796
accuracy train: 0.992378 val: 0.948171 test: 0.947082
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({2: 3888, 0: 2870, 1: 2372})

Epoch :  18 loss training:  8.136766262352467 Time :  4824
accuracy train: 0.993056 val: 0.949695 test: 0.950973
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({2: 3888, 0: 2870, 1: 2372})

Epoch :  19 loss training:  8.473455647006631 Time :  4859
accuracy train: 0.992717 val: 0.949695 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({2: 3888, 0: 2874, 1: 2368})

Epoch :  20 loss training:  8.038402873557061 Time :  4889
accuracy train: 0.993394 val: 0.948171 test: 0.948249
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({1: 3889, 0: 2875, 2: 2366})

Epoch :  21 loss training:  7.333611208247021 Time :  4917
accuracy train: 0.994241 val: 0.948171 test: 0.948638
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({1: 3893, 0: 2871, 2: 2366})

Epoch :  22 loss training:  7.221623939927667 Time :  4945
accuracy train: 0.994072 val: 0.948171 test: 0.947082
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({1: 3901, 0: 2870, 2: 2359})

Epoch :  23 loss training:  6.9293728191405535 Time :  4979
accuracy train: 0.994749 val: 0.949695 test: 0.949027
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({1: 3902, 0: 2869, 2: 2359})

Epoch :  24 loss training:  6.621497000800446 Time :  5006
accuracy train: 0.994411 val: 0.951220 test: 0.948249
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({1: 3909, 0: 2865, 2: 2356})

Epoch :  25 loss training:  6.6212719635805115 Time :  5032
accuracy train: 0.995257 val: 0.946646 test: 0.947082
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({1: 3911, 0: 2875, 2: 2344})

Epoch :  26 loss training:  6.031263734679669 Time :  5059
accuracy train: 0.995427 val: 0.945122 test: 0.945525
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({1: 3912, 0: 2883, 2: 2335})

Epoch :  27 loss training:  6.028972926782444 Time :  5091
accuracy train: 0.995427 val: 0.948171 test: 0.948638
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({2: 3912, 0: 2883, 1: 2335})

Epoch :  28 loss training:  5.6663424669532105 Time :  5122
accuracy train: 0.995427 val: 0.951220 test: 0.948249
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({1: 3913, 0: 2884, 2: 2333})

Epoch :  29 loss training:  5.830657119979151 Time :  5147
accuracy train: 0.995596 val: 0.951220 test: 0.947471
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({1: 3916, 0: 2883, 2: 2331})

Epoch :  30 loss training:  5.519774585030973 Time :  5172
accuracy train: 0.994919 val: 0.949695 test: 0.946304
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({0: 3917, 2: 2884, 1: 2329})

Epoch :  31 loss training:  5.099319195607677 Time :  5196
accuracy train: 0.995766 val: 0.945122 test: 0.946304
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({1: 3918, 0: 2883, 2: 2329})

Epoch :  32 loss training:  4.920662910328247 Time :  5227
accuracy train: 0.996612 val: 0.948171 test: 0.948249
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({0: 3918, 1: 2883, 2: 2329})

Epoch :  33 loss training:  4.8930909123737365 Time :  5256
accuracy train: 0.996612 val: 0.948171 test: 0.946304
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({1: 3919, 0: 2883, 2: 2328})

Epoch :  34 loss training:  5.032223888905719 Time :  5283
accuracy train: 0.995596 val: 0.951220 test: 0.949027
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({0: 3921, 2: 2882, 1: 2327})

Epoch :  35 loss training:  4.6246647535590455 Time :  5311
accuracy train: 0.996443 val: 0.948171 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({1: 3922, 0: 2882, 2: 2326})

Epoch :  36 loss training:  4.721766615752131 Time :  5342
accuracy train: 0.996274 val: 0.948171 test: 0.949027
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({2: 3922, 0: 2882, 1: 2326})

Epoch :  37 loss training:  4.5408892460982315 Time :  5371
accuracy train: 0.996104 val: 0.949695 test: 0.948249
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({1: 3922, 0: 2883, 2: 2325})

Epoch :  38 loss training:  4.225126133533195 Time :  5398
accuracy train: 0.995935 val: 0.948171 test: 0.947471
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({1: 3921, 0: 2885, 2: 2324})

Epoch :  39 loss training:  3.960571604198776 Time :  5427
accuracy train: 0.995935 val: 0.949695 test: 0.949027
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({2: 3921, 0: 2887, 1: 2322})

Epoch :  40 loss training:  4.117597090662457 Time :  5456
accuracy train: 0.996612 val: 0.948171 test: 0.950973
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.948249
Counter({2: 3923, 0: 2888, 1: 2319})

========================================================================================================================================================================================================
max acc epoch :  9
max validation accuracy :  0.9557926829268293
test accuracy :  0.948249027237354
last test_accuracy :  0.9509727626459143
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=339, weight_decay=1e-08)
device :  cuda:0
Counter({0: 5417, 2: 2501, 1: 1212})

Epoch :  1 loss training:  124.62747147679329 Time :  5500
accuracy train: 0.906504 val: 0.902439 test: 0.890661
max validation accuracy : 0.902439 max acc epoch : 1 test accuracy : 0.890661
Counter({1: 3691, 2: 2880, 0: 2559})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.43712465465069 Time :  5524
accuracy train: 0.935976 val: 0.917683 test: 0.906615
max validation accuracy : 0.917683 max acc epoch : 2 test accuracy : 0.906615
Counter({1: 3790, 0: 2814, 2: 2526})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  40.84065116383135 Time :  5551
accuracy train: 0.940549 val: 0.910061 test: 0.924514
max validation accuracy : 0.917683 max acc epoch : 2 test accuracy : 0.906615
Counter({2: 3735, 1: 2892, 0: 2503})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  26.675018293317407 Time :  5583
accuracy train: 0.965786 val: 0.928354 test: 0.920623
max validation accuracy : 0.928354 max acc epoch : 4 test accuracy : 0.920623
Counter({0: 3800, 2: 2883, 1: 2447})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  22.344321021810174 Time :  5610
accuracy train: 0.978489 val: 0.940549 test: 0.945525
max validation accuracy : 0.940549 max acc epoch : 5 test accuracy : 0.945525
Counter({1: 3808, 0: 2883, 2: 2439})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  19.339885009918362 Time :  5636
accuracy train: 0.976118 val: 0.935976 test: 0.940078
max validation accuracy : 0.940549 max acc epoch : 5 test accuracy : 0.945525
Counter({2: 3787, 0: 2906, 1: 2437})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  16.42641137726605 Time :  5663
accuracy train: 0.983909 val: 0.943598 test: 0.945525
max validation accuracy : 0.943598 max acc epoch : 7 test accuracy : 0.945525
Counter({2: 3803, 0: 2875, 1: 2452})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  14.137736100703478 Time :  5692
accuracy train: 0.988821 val: 0.948171 test: 0.943969
max validation accuracy : 0.948171 max acc epoch : 8 test accuracy : 0.943969
Counter({1: 3828, 2: 2862, 0: 2440})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  13.403289068955928 Time :  5723
accuracy train: 0.987974 val: 0.951220 test: 0.949027
max validation accuracy : 0.951220 max acc epoch : 9 test accuracy : 0.949027
Counter({1: 3854, 0: 2868, 2: 2408})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  11.02752304635942 Time :  5745
accuracy train: 0.988482 val: 0.945122 test: 0.945914
max validation accuracy : 0.951220 max acc epoch : 9 test accuracy : 0.949027
Counter({2: 3855, 0: 2870, 1: 2405})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  11.019684547558427 Time :  5769
accuracy train: 0.990346 val: 0.948171 test: 0.946304
max validation accuracy : 0.951220 max acc epoch : 9 test accuracy : 0.949027
Counter({2: 3863, 0: 2870, 1: 2397})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  10.707402625586838 Time :  5797
accuracy train: 0.988652 val: 0.946646 test: 0.951751
max validation accuracy : 0.951220 max acc epoch : 9 test accuracy : 0.949027
Counter({2: 3867, 0: 2868, 1: 2395})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  9.880913621280342 Time :  5825
accuracy train: 0.991701 val: 0.954268 test: 0.950195
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({2: 3868, 0: 2867, 1: 2395})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  9.430399137083441 Time :  5852
accuracy train: 0.991870 val: 0.952744 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({1: 3869, 0: 2866, 2: 2395})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  8.731451190076768 Time :  5879
accuracy train: 0.991023 val: 0.949695 test: 0.945914
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({0: 3873, 2: 2867, 1: 2390})

Epoch :  16 loss training:  8.802322476170957 Time :  5910
accuracy train: 0.991023 val: 0.946646 test: 0.947860
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({2: 3875, 0: 2865, 1: 2390})

Epoch :  17 loss training:  8.354221668094397 Time :  5940
accuracy train: 0.992209 val: 0.952744 test: 0.951362
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({2: 3875, 0: 2865, 1: 2390})

Epoch :  18 loss training:  8.16383671713993 Time :  5970
accuracy train: 0.992547 val: 0.951220 test: 0.952529
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({2: 3876, 0: 2864, 1: 2390})

Epoch :  19 loss training:  8.537627637153491 Time :  5994
accuracy train: 0.993056 val: 0.951220 test: 0.949416
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({1: 3878, 0: 2868, 2: 2384})

Epoch :  20 loss training:  7.837435313034803 Time :  6019
accuracy train: 0.993394 val: 0.948171 test: 0.950584
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({0: 3879, 1: 2869, 2: 2382})

Epoch :  21 loss training:  7.22568449168466 Time :  6052
accuracy train: 0.994749 val: 0.948171 test: 0.950195
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({2: 3882, 0: 2869, 1: 2379})

Epoch :  22 loss training:  7.234278881922364 Time :  6081
accuracy train: 0.994580 val: 0.949695 test: 0.950584
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({2: 3889, 0: 2868, 1: 2373})

Epoch :  23 loss training:  6.916319052223116 Time :  6105
accuracy train: 0.994749 val: 0.951220 test: 0.950584
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({2: 3891, 0: 2868, 1: 2371})

Epoch :  24 loss training:  6.657753613777459 Time :  6136
accuracy train: 0.994749 val: 0.952744 test: 0.950584
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({2: 3895, 0: 2868, 1: 2367})

Epoch :  25 loss training:  6.576410656096414 Time :  6163
accuracy train: 0.994580 val: 0.945122 test: 0.951362
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({1: 3899, 0: 2879, 2: 2352})

Epoch :  26 loss training:  5.987458345247433 Time :  6188
accuracy train: 0.995766 val: 0.946646 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({2: 3902, 0: 2879, 1: 2349})

Epoch :  27 loss training:  6.102532366057858 Time :  6211
accuracy train: 0.995088 val: 0.951220 test: 0.950195
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({1: 3904, 0: 2878, 2: 2348})

Epoch :  28 loss training:  5.646247638738714 Time :  6238
accuracy train: 0.995257 val: 0.949695 test: 0.951751
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({2: 3904, 0: 2880, 1: 2346})

Epoch :  29 loss training:  5.890000280342065 Time :  6264
accuracy train: 0.995766 val: 0.949695 test: 0.950973
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({0: 3882, 2: 2878, 1: 2370})

Epoch :  30 loss training:  5.537938360124826 Time :  6289
accuracy train: 0.995088 val: 0.952744 test: 0.949416
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({1: 3883, 2: 2879, 0: 2368})

Epoch :  31 loss training:  5.071167169138789 Time :  6316
accuracy train: 0.995935 val: 0.948171 test: 0.948249
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({1: 3885, 0: 2880, 2: 2365})

Epoch :  32 loss training:  5.031357643660158 Time :  6349
accuracy train: 0.996443 val: 0.945122 test: 0.950584
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({1: 3912, 2: 2881, 0: 2337})

Epoch :  33 loss training:  4.795121840434149 Time :  6375
accuracy train: 0.996104 val: 0.948171 test: 0.949416
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({2: 3915, 0: 2884, 1: 2331})

Epoch :  34 loss training:  4.878658756380901 Time :  6399
accuracy train: 0.995766 val: 0.951220 test: 0.953307
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({2: 3917, 0: 2883, 1: 2330})

Epoch :  35 loss training:  4.6412249729037285 Time :  6430
accuracy train: 0.996274 val: 0.948171 test: 0.952918
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({2: 3917, 0: 2883, 1: 2330})

Epoch :  36 loss training:  4.835698577808216 Time :  6457
accuracy train: 0.996104 val: 0.949695 test: 0.952140
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({1: 3918, 0: 2883, 2: 2329})

Epoch :  37 loss training:  4.605090787750669 Time :  6483
accuracy train: 0.995935 val: 0.949695 test: 0.953307
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({1: 3919, 2: 2885, 0: 2326})

Epoch :  38 loss training:  4.0829052025219426 Time :  6507
accuracy train: 0.996104 val: 0.949695 test: 0.950973
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({0: 3919, 1: 2885, 2: 2326})

Epoch :  39 loss training:  3.9469114921521395 Time :  6532
accuracy train: 0.996104 val: 0.952744 test: 0.950195
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({0: 3919, 2: 2885, 1: 2326})

Epoch :  40 loss training:  4.188132531999145 Time :  6561
accuracy train: 0.996443 val: 0.952744 test: 0.952918
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({0: 3893, 1: 2888, 2: 2349})

Epoch :  41 loss training:  3.5397912247572094 Time :  6585
accuracy train: 0.995935 val: 0.951220 test: 0.952140
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({1: 3919, 0: 2888, 2: 2323})

Epoch :  42 loss training:  3.6883678092854097 Time :  6608
accuracy train: 0.996274 val: 0.949695 test: 0.953307
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({2: 3920, 0: 2887, 1: 2323})

Epoch :  43 loss training:  3.4582998912082985 Time :  6638
accuracy train: 0.996104 val: 0.949695 test: 0.953696
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({1: 3920, 0: 2888, 2: 2322})

Epoch :  44 loss training:  3.54963947145734 Time :  6664
accuracy train: 0.996274 val: 0.949695 test: 0.951751
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.950195
Counter({1: 3920, 0: 2888, 2: 2322})

========================================================================================================================================================================================================
max acc epoch :  13
max validation accuracy :  0.9542682926829268
test accuracy :  0.9501945525291828
last test_accuracy :  0.9517509727626459
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=339, weight_decay=1e-08)
device :  cuda:0
Counter({0: 5417, 2: 2501, 1: 1212})

Epoch :  1 loss training:  124.64744493365288 Time :  6708
accuracy train: 0.905827 val: 0.897866 test: 0.891440
max validation accuracy : 0.897866 max acc epoch : 1 test accuracy : 0.891440
Counter({1: 3688, 0: 2868, 2: 2574})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.62112000212073 Time :  6734
accuracy train: 0.934282 val: 0.913110 test: 0.910117
max validation accuracy : 0.913110 max acc epoch : 2 test accuracy : 0.910117
Counter({0: 3784, 2: 2835, 1: 2511})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  41.02382017672062 Time :  6757
accuracy train: 0.935129 val: 0.907012 test: 0.924903
max validation accuracy : 0.913110 max acc epoch : 2 test accuracy : 0.910117
Counter({2: 3733, 0: 2900, 1: 2497})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  26.870868717320263 Time :  6781
accuracy train: 0.967649 val: 0.926829 test: 0.922568
max validation accuracy : 0.926829 max acc epoch : 4 test accuracy : 0.922568
Counter({1: 3818, 0: 2886, 2: 2426})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  22.19389628432691 Time :  6811
accuracy train: 0.978150 val: 0.946646 test: 0.943969
max validation accuracy : 0.946646 max acc epoch : 5 test accuracy : 0.943969
Counter({1: 3821, 0: 2890, 2: 2419})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  19.340601160191 Time :  6835
accuracy train: 0.976965 val: 0.934451 test: 0.937743
max validation accuracy : 0.946646 max acc epoch : 5 test accuracy : 0.943969
Counter({2: 3831, 0: 2892, 1: 2407})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  16.40277359634638 Time :  6861
accuracy train: 0.984587 val: 0.946646 test: 0.940467
max validation accuracy : 0.946646 max acc epoch : 5 test accuracy : 0.943969
Counter({1: 3845, 0: 2882, 2: 2403})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  14.166100854054093 Time :  6884
accuracy train: 0.987805 val: 0.948171 test: 0.945914
max validation accuracy : 0.948171 max acc epoch : 8 test accuracy : 0.945914
Counter({1: 3863, 0: 2871, 2: 2396})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  13.158639979548752 Time :  6908
accuracy train: 0.988313 val: 0.948171 test: 0.950195
max validation accuracy : 0.948171 max acc epoch : 8 test accuracy : 0.945914
Counter({1: 3863, 0: 2873, 2: 2394})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  10.923581823706627 Time :  6934
accuracy train: 0.989837 val: 0.948171 test: 0.945525
max validation accuracy : 0.948171 max acc epoch : 8 test accuracy : 0.945914
Counter({0: 3865, 2: 2871, 1: 2394})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  10.721565899439156 Time :  6958
accuracy train: 0.990684 val: 0.946646 test: 0.945136
max validation accuracy : 0.948171 max acc epoch : 8 test accuracy : 0.945914
Counter({2: 3871, 0: 2871, 1: 2388})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  10.718195599038154 Time :  6983
accuracy train: 0.989329 val: 0.948171 test: 0.950584
max validation accuracy : 0.948171 max acc epoch : 8 test accuracy : 0.945914
Counter({2: 3874, 0: 2870, 1: 2386})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  10.034725826233625 Time :  7004
accuracy train: 0.991701 val: 0.952744 test: 0.946693
max validation accuracy : 0.952744 max acc epoch : 13 test accuracy : 0.946693
Counter({1: 3879, 0: 2868, 2: 2383})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  9.620971758849919 Time :  7028
accuracy train: 0.992039 val: 0.949695 test: 0.947082
max validation accuracy : 0.952744 max acc epoch : 13 test accuracy : 0.946693
Counter({0: 3883, 1: 2866, 2: 2381})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  8.734381032176316 Time :  7055
accuracy train: 0.991701 val: 0.946646 test: 0.944358
max validation accuracy : 0.952744 max acc epoch : 13 test accuracy : 0.946693
Counter({1: 3884, 0: 2868, 2: 2378})

Epoch :  16 loss training:  8.945418399758637 Time :  7080
accuracy train: 0.991701 val: 0.949695 test: 0.945525
max validation accuracy : 0.952744 max acc epoch : 13 test accuracy : 0.946693
Counter({1: 3885, 0: 2868, 2: 2377})

Epoch :  17 loss training:  8.250365258660167 Time :  7107
accuracy train: 0.992378 val: 0.952744 test: 0.950973
max validation accuracy : 0.952744 max acc epoch : 13 test accuracy : 0.946693
Counter({1: 3886, 0: 2867, 2: 2377})

Epoch :  18 loss training:  7.927340970840305 Time :  7130
accuracy train: 0.993056 val: 0.952744 test: 0.952529
max validation accuracy : 0.952744 max acc epoch : 13 test accuracy : 0.946693
Counter({1: 3887, 2: 2868, 0: 2375})

Epoch :  19 loss training:  8.630966622615233 Time :  7157
accuracy train: 0.993225 val: 0.955793 test: 0.950584
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({1: 3887, 0: 2871, 2: 2372})

Epoch :  20 loss training:  8.036649213638157 Time :  7182
accuracy train: 0.993733 val: 0.952744 test: 0.950973
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({1: 3887, 0: 2872, 2: 2371})

Epoch :  21 loss training:  7.425985944690183 Time :  7207
accuracy train: 0.993902 val: 0.952744 test: 0.950973
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({2: 3888, 0: 2873, 1: 2369})

Epoch :  22 loss training:  7.231895761098713 Time :  7231
accuracy train: 0.993902 val: 0.951220 test: 0.947082
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({1: 3894, 0: 2871, 2: 2365})

Epoch :  23 loss training:  7.069062863476574 Time :  7260
accuracy train: 0.994580 val: 0.952744 test: 0.950584
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({1: 3894, 0: 2870, 2: 2366})

Epoch :  24 loss training:  6.578879683278501 Time :  7287
accuracy train: 0.994411 val: 0.951220 test: 0.949027
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({1: 3901, 0: 2871, 2: 2358})

Epoch :  25 loss training:  6.621035125805065 Time :  7310
accuracy train: 0.994919 val: 0.945122 test: 0.949027
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({1: 3905, 0: 2879, 2: 2346})

Epoch :  26 loss training:  6.157240357017145 Time :  7333
accuracy train: 0.995088 val: 0.946646 test: 0.947082
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({2: 3906, 0: 2884, 1: 2340})

Epoch :  27 loss training:  6.284103974699974 Time :  7357
accuracy train: 0.995088 val: 0.949695 test: 0.950584
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({2: 3908, 0: 2882, 1: 2340})

Epoch :  28 loss training:  5.87367942254059 Time :  7385
accuracy train: 0.995427 val: 0.951220 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({1: 3912, 0: 2884, 2: 2334})

Epoch :  29 loss training:  5.977984115073923 Time :  7411
accuracy train: 0.995596 val: 0.952744 test: 0.947860
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({2: 3914, 0: 2883, 1: 2333})

Epoch :  30 loss training:  5.612615769496188 Time :  7436
accuracy train: 0.995088 val: 0.951220 test: 0.950584
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({1: 3916, 0: 2885, 2: 2329})

Epoch :  31 loss training:  5.166330114239827 Time :  7459
accuracy train: 0.995935 val: 0.948171 test: 0.949027
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({2: 3918, 0: 2885, 1: 2327})

Epoch :  32 loss training:  4.906116756377742 Time :  7489
accuracy train: 0.996274 val: 0.949695 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({1: 3918, 0: 2885, 2: 2327})

Epoch :  33 loss training:  4.786395259900019 Time :  7513
accuracy train: 0.995935 val: 0.948171 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({1: 3918, 0: 2886, 2: 2326})

Epoch :  34 loss training:  5.002502768067643 Time :  7537
accuracy train: 0.995596 val: 0.951220 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({2: 3917, 0: 2888, 1: 2325})

Epoch :  35 loss training:  4.724341866676696 Time :  7571
accuracy train: 0.996104 val: 0.949695 test: 0.949805
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({2: 3919, 0: 2887, 1: 2324})

Epoch :  36 loss training:  4.9214042607927695 Time :  7597
accuracy train: 0.996274 val: 0.952744 test: 0.951751
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({2: 3920, 0: 2887, 1: 2323})

Epoch :  37 loss training:  4.729983354918659 Time :  7621
accuracy train: 0.996104 val: 0.954268 test: 0.951362
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({1: 3921, 0: 2888, 2: 2321})

Epoch :  38 loss training:  4.111957727465779 Time :  7654
accuracy train: 0.996274 val: 0.951220 test: 0.949805
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({2: 3922, 0: 2888, 1: 2320})

Epoch :  39 loss training:  4.060445578652434 Time :  7678
accuracy train: 0.996104 val: 0.951220 test: 0.949027
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({2: 3922, 0: 2888, 1: 2320})

Epoch :  40 loss training:  4.212882815045305 Time :  7701
accuracy train: 0.996612 val: 0.951220 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({1: 3922, 0: 2889, 2: 2319})

Epoch :  41 loss training:  3.6733365829568356 Time :  7733
accuracy train: 0.996104 val: 0.954268 test: 0.951362
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({2: 3923, 0: 2888, 1: 2319})

Epoch :  42 loss training:  3.681538664153777 Time :  7760
accuracy train: 0.996274 val: 0.949695 test: 0.951362
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({2: 3923, 0: 2888, 1: 2319})

Epoch :  43 loss training:  3.608877769787796 Time :  7783
accuracy train: 0.996274 val: 0.948171 test: 0.951362
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({2: 3923, 0: 2888, 1: 2319})

Epoch :  44 loss training:  3.443227158742957 Time :  7808
accuracy train: 0.996274 val: 0.952744 test: 0.950584
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({2: 3923, 0: 2888, 1: 2319})

Epoch :  45 loss training:  3.7903942361008376 Time :  7835
accuracy train: 0.996612 val: 0.954268 test: 0.950584
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({1: 3922, 0: 2888, 2: 2320})

Epoch :  46 loss training:  3.8073876277776435 Time :  7862
accuracy train: 0.996104 val: 0.954268 test: 0.950584
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({2: 3922, 0: 2888, 1: 2320})

Epoch :  47 loss training:  3.5443410797743127 Time :  7884
accuracy train: 0.996443 val: 0.951220 test: 0.952140
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.950584
Counter({2: 3922, 0: 2888, 1: 2320})

Epoch :  48 loss training:  3.50934310129378 Time :  7908
accuracy train: 0.996104 val: 0.957317 test: 0.951362
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({2: 3922, 0: 2889, 1: 2319})

Epoch :  49 loss training:  3.238056574948132 Time :  7938
accuracy train: 0.996443 val: 0.948171 test: 0.949416
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({2: 3922, 0: 2890, 1: 2318})

Epoch :  50 loss training:  3.3256247302051634 Time :  7963
accuracy train: 0.996104 val: 0.949695 test: 0.950584
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({2: 3921, 0: 2890, 1: 2319})

Epoch :  51 loss training:  3.154362072935328 Time :  7987
accuracy train: 0.996782 val: 0.948171 test: 0.950195
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({2: 3921, 0: 2890, 1: 2319})

Epoch :  52 loss training:  3.404012898739893 Time :  8018
accuracy train: 0.996443 val: 0.951220 test: 0.950584
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({2: 3921, 0: 2890, 1: 2319})

Epoch :  53 loss training:  2.7886023977189325 Time :  8044
accuracy train: 0.996612 val: 0.949695 test: 0.950195
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({2: 3921, 0: 2889, 1: 2320})

Epoch :  54 loss training:  2.819493453396717 Time :  8069
accuracy train: 0.996782 val: 0.946646 test: 0.952140
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({0: 3920, 2: 2889, 1: 2321})

Epoch :  55 loss training:  2.917304410249926 Time :  8093
accuracy train: 0.996782 val: 0.948171 test: 0.949416
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({2: 3920, 0: 2891, 1: 2319})

Epoch :  56 loss training:  2.4633240114781074 Time :  8125
accuracy train: 0.996951 val: 0.946646 test: 0.948638
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({2: 3921, 0: 2890, 1: 2319})

Epoch :  57 loss training:  3.1124372859485447 Time :  8150
accuracy train: 0.996782 val: 0.946646 test: 0.947860
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({2: 3923, 0: 2888, 1: 2319})

Epoch :  58 loss training:  2.8973328968859278 Time :  8175
accuracy train: 0.996782 val: 0.951220 test: 0.947860
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({2: 3924, 0: 2888, 1: 2318})

Epoch :  59 loss training:  2.416907423408702 Time :  8200
accuracy train: 0.996951 val: 0.949695 test: 0.951362
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({2: 3924, 0: 2889, 1: 2317})

Epoch :  60 loss training:  2.2163781452109106 Time :  8232
accuracy train: 0.996782 val: 0.948171 test: 0.950584
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({2: 3924, 0: 2889, 1: 2317})

Epoch :  61 loss training:  2.7095738972129766 Time :  8268
accuracy train: 0.996951 val: 0.946646 test: 0.950584
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({2: 3924, 0: 2890, 1: 2316})

Epoch :  62 loss training:  2.8054530020453967 Time :  8293
accuracy train: 0.997121 val: 0.949695 test: 0.951362
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({2: 3924, 0: 2890, 1: 2316})

Epoch :  63 loss training:  2.557082916086074 Time :  8318
accuracy train: 0.996274 val: 0.951220 test: 0.949805
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({1: 3924, 0: 2890, 2: 2316})

Epoch :  64 loss training:  2.5753736755577847 Time :  8339
accuracy train: 0.997290 val: 0.951220 test: 0.950584
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({2: 3924, 0: 2893, 1: 2313})

Epoch :  65 loss training:  2.766725494468119 Time :  8370
accuracy train: 0.996782 val: 0.948171 test: 0.949027
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({2: 3925, 0: 2891, 1: 2314})

Epoch :  66 loss training:  2.4235727317573037 Time :  8396
accuracy train: 0.996951 val: 0.948171 test: 0.950584
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({1: 3924, 0: 2892, 2: 2314})

Epoch :  67 loss training:  2.184412550413981 Time :  8420
accuracy train: 0.996951 val: 0.951220 test: 0.951751
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({1: 3924, 0: 2892, 2: 2314})

Epoch :  68 loss training:  2.2833752802107483 Time :  8452
accuracy train: 0.996782 val: 0.951220 test: 0.950195
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({2: 3923, 0: 2893, 1: 2314})

Epoch :  69 loss training:  2.6462806874187663 Time :  8479
accuracy train: 0.996951 val: 0.949695 test: 0.950195
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({2: 3923, 0: 2895, 1: 2312})

Epoch :  70 loss training:  2.3681666839984246 Time :  8504
accuracy train: 0.996782 val: 0.952744 test: 0.950584
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({2: 3923, 0: 2895, 1: 2312})

Epoch :  71 loss training:  2.228636456246022 Time :  8530
accuracy train: 0.996782 val: 0.954268 test: 0.950973
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({2: 3923, 0: 2895, 1: 2312})

Epoch :  72 loss training:  2.3731175283755874 Time :  8554
accuracy train: 0.997290 val: 0.949695 test: 0.952140
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({1: 3923, 0: 2895, 2: 2312})

Epoch :  73 loss training:  2.3184281464200467 Time :  8578
accuracy train: 0.996951 val: 0.946646 test: 0.950973
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({1: 3923, 2: 2895, 0: 2312})

Epoch :  74 loss training:  2.343138323354651 Time :  8610
accuracy train: 0.996612 val: 0.955793 test: 0.952529
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({2: 3923, 0: 2895, 1: 2312})

Epoch :  75 loss training:  2.3094352333864663 Time :  8636
accuracy train: 0.996951 val: 0.949695 test: 0.949416
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({2: 3923, 0: 2895, 1: 2312})

Epoch :  76 loss training:  2.0958510765631218 Time :  8662
accuracy train: 0.996782 val: 0.945122 test: 0.949416
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({1: 3923, 0: 2896, 2: 2311})

Epoch :  77 loss training:  2.1285617173998617 Time :  8685
accuracy train: 0.996951 val: 0.949695 test: 0.949027
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({1: 3923, 0: 2896, 2: 2311})

Epoch :  78 loss training:  2.1084698135091458 Time :  8711
accuracy train: 0.996782 val: 0.949695 test: 0.949416
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({1: 3922, 0: 2897, 2: 2311})

Epoch :  79 loss training:  2.108773703192128 Time :  8736
accuracy train: 0.997121 val: 0.951220 test: 0.950195
max validation accuracy : 0.957317 max acc epoch : 48 test accuracy : 0.951362
Counter({2: 3922, 0: 2897, 1: 2311})

========================================================================================================================================================================================================
max acc epoch :  48
max validation accuracy :  0.9573170731707317
test accuracy :  0.9513618677042801
last test_accuracy :  0.9501945525291828
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=339, weight_decay=1e-08)
device :  cuda:0
Counter({0: 5417, 2: 2501, 1: 1212})

Epoch :  1 loss training:  124.64230647683144 Time :  8772
accuracy train: 0.907690 val: 0.907012 test: 0.889883
max validation accuracy : 0.907012 max acc epoch : 1 test accuracy : 0.889883
Counter({0: 3687, 2: 2878, 1: 2565})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.28431584313512 Time :  8799
accuracy train: 0.939194 val: 0.916159 test: 0.910506
max validation accuracy : 0.916159 max acc epoch : 2 test accuracy : 0.910506
Counter({1: 3787, 0: 2814, 2: 2529})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  41.26918035559356 Time :  8824
accuracy train: 0.938347 val: 0.908537 test: 0.927237
max validation accuracy : 0.916159 max acc epoch : 2 test accuracy : 0.910506
Counter({0: 3715, 1: 2910, 2: 2505})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  26.971854875795543 Time :  8847
accuracy train: 0.967141 val: 0.922256 test: 0.922179
max validation accuracy : 0.922256 max acc epoch : 4 test accuracy : 0.922179
Counter({1: 3804, 0: 2866, 2: 2460})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  22.510184306651354 Time :  8870
accuracy train: 0.977642 val: 0.939024 test: 0.942412
max validation accuracy : 0.939024 max acc epoch : 5 test accuracy : 0.942412
Counter({1: 3808, 0: 2880, 2: 2442})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  18.991033220198005 Time :  8895
accuracy train: 0.979336 val: 0.937500 test: 0.936576
max validation accuracy : 0.939024 max acc epoch : 5 test accuracy : 0.942412
Counter({1: 3825, 0: 2893, 2: 2412})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  16.441767124459147 Time :  8922
accuracy train: 0.984248 val: 0.942073 test: 0.942412
max validation accuracy : 0.942073 max acc epoch : 7 test accuracy : 0.942412
Counter({1: 3854, 0: 2873, 2: 2403})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  13.919216805137694 Time :  8946
accuracy train: 0.987974 val: 0.940549 test: 0.942023
max validation accuracy : 0.942073 max acc epoch : 7 test accuracy : 0.942412
Counter({1: 3865, 0: 2858, 2: 2407})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  13.181172736920416 Time :  8969
accuracy train: 0.987974 val: 0.943598 test: 0.947860
max validation accuracy : 0.943598 max acc epoch : 9 test accuracy : 0.947860
Counter({2: 3868, 0: 2860, 1: 2402})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  10.93911300599575 Time :  8993
accuracy train: 0.988991 val: 0.948171 test: 0.943580
max validation accuracy : 0.948171 max acc epoch : 10 test accuracy : 0.943580
Counter({2: 3870, 0: 2860, 1: 2400})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  10.56848930567503 Time :  9015
accuracy train: 0.990176 val: 0.945122 test: 0.943580
max validation accuracy : 0.948171 max acc epoch : 10 test accuracy : 0.943580
Counter({2: 3876, 0: 2859, 1: 2395})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  10.651779165491462 Time :  9037
accuracy train: 0.988313 val: 0.948171 test: 0.951362
max validation accuracy : 0.948171 max acc epoch : 10 test accuracy : 0.943580
Counter({2: 3879, 0: 2859, 1: 2392})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  9.81180258281529 Time :  9059
accuracy train: 0.990854 val: 0.951220 test: 0.949027
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({1: 3880, 0: 2859, 2: 2391})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  9.317027247976512 Time :  9088
accuracy train: 0.992039 val: 0.949695 test: 0.946304
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({0: 3881, 1: 2858, 2: 2391})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  8.862609948497266 Time :  9114
accuracy train: 0.991531 val: 0.948171 test: 0.945136
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({1: 3883, 0: 2859, 2: 2388})

Epoch :  16 loss training:  8.678751202300191 Time :  9138
accuracy train: 0.991870 val: 0.948171 test: 0.948249
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({1: 3882, 0: 2859, 2: 2389})

Epoch :  17 loss training:  8.219437859486789 Time :  9165
accuracy train: 0.992378 val: 0.948171 test: 0.951362
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({1: 3883, 0: 2858, 2: 2389})

Epoch :  18 loss training:  8.071194678544998 Time :  9190
accuracy train: 0.992378 val: 0.949695 test: 0.951362
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({1: 3882, 0: 2859, 2: 2389})

Epoch :  19 loss training:  8.59773909742944 Time :  9215
accuracy train: 0.992886 val: 0.949695 test: 0.950973
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({1: 3883, 0: 2860, 2: 2387})

Epoch :  20 loss training:  7.953960995655507 Time :  9241
accuracy train: 0.993225 val: 0.951220 test: 0.950973
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({1: 3883, 0: 2860, 2: 2387})

Epoch :  21 loss training:  7.390791505109519 Time :  9266
accuracy train: 0.994072 val: 0.948171 test: 0.951362
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({0: 3887, 2: 2859, 1: 2384})

Epoch :  22 loss training:  7.2227074252441525 Time :  9289
accuracy train: 0.994411 val: 0.948171 test: 0.948638
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({1: 3894, 0: 2862, 2: 2374})

Epoch :  23 loss training:  7.068959300406277 Time :  9313
accuracy train: 0.994919 val: 0.951220 test: 0.949416
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({1: 3896, 0: 2864, 2: 2370})

Epoch :  24 loss training:  6.39178795972839 Time :  9336
accuracy train: 0.994749 val: 0.948171 test: 0.950973
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({1: 3905, 0: 2859, 2: 2366})

Epoch :  25 loss training:  6.494463141774759 Time :  9365
accuracy train: 0.994411 val: 0.945122 test: 0.949805
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({0: 3906, 1: 2873, 2: 2351})

Epoch :  26 loss training:  6.1450258085969836 Time :  9390
accuracy train: 0.995257 val: 0.945122 test: 0.949027
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({2: 3905, 1: 2877, 0: 2348})

Epoch :  27 loss training:  6.07225451618433 Time :  9414
accuracy train: 0.995257 val: 0.951220 test: 0.950195
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({1: 3916, 0: 2871, 2: 2343})

Epoch :  28 loss training:  5.712425979203545 Time :  9437
accuracy train: 0.994919 val: 0.948171 test: 0.950973
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({1: 3917, 2: 2872, 0: 2341})

Epoch :  29 loss training:  5.993861238937825 Time :  9466
accuracy train: 0.995596 val: 0.951220 test: 0.949805
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({1: 3920, 0: 2872, 2: 2338})

Epoch :  30 loss training:  5.4414314911700785 Time :  9489
accuracy train: 0.995257 val: 0.951220 test: 0.949027
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({0: 3920, 1: 2874, 2: 2336})

Epoch :  31 loss training:  5.200012663612142 Time :  9512
accuracy train: 0.996104 val: 0.943598 test: 0.948638
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({1: 3924, 0: 2872, 2: 2334})

Epoch :  32 loss training:  4.850785085116513 Time :  9536
accuracy train: 0.996612 val: 0.943598 test: 0.947860
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({1: 3926, 0: 2871, 2: 2333})

Epoch :  33 loss training:  4.857040724833496 Time :  9564
accuracy train: 0.996274 val: 0.949695 test: 0.949416
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({2: 3928, 0: 2870, 1: 2332})

Epoch :  34 loss training:  4.968668527202681 Time :  9588
accuracy train: 0.995596 val: 0.949695 test: 0.952140
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({1: 3928, 0: 2870, 2: 2332})

Epoch :  35 loss training:  4.611593759385869 Time :  9612
accuracy train: 0.996274 val: 0.946646 test: 0.952918
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({2: 3928, 0: 2870, 1: 2332})

Epoch :  36 loss training:  4.822107222746126 Time :  9636
accuracy train: 0.996104 val: 0.951220 test: 0.951362
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({1: 3928, 2: 2870, 0: 2332})

Epoch :  37 loss training:  4.524507326073945 Time :  9665
accuracy train: 0.996274 val: 0.951220 test: 0.952140
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({1: 3929, 0: 2871, 2: 2330})

Epoch :  38 loss training:  4.036419696640223 Time :  9691
accuracy train: 0.996274 val: 0.949695 test: 0.948249
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({1: 3929, 0: 2871, 2: 2330})

Epoch :  39 loss training:  3.957387601258233 Time :  9716
accuracy train: 0.996104 val: 0.949695 test: 0.949416
max validation accuracy : 0.951220 max acc epoch : 13 test accuracy : 0.949027
Counter({2: 3928, 0: 2871, 1: 2331})

Epoch :  40 loss training:  4.194309329497628 Time :  9740
accuracy train: 0.996951 val: 0.952744 test: 0.950973
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({1: 3929, 0: 2872, 2: 2329})

Epoch :  41 loss training:  3.606859899009578 Time :  9772
accuracy train: 0.996274 val: 0.948171 test: 0.950195
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({2: 3929, 0: 2872, 1: 2329})

Epoch :  42 loss training:  3.759073778288439 Time :  9793
accuracy train: 0.996443 val: 0.949695 test: 0.952140
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({2: 3929, 0: 2873, 1: 2328})

Epoch :  43 loss training:  3.6602292886236683 Time :  9813
accuracy train: 0.996104 val: 0.948171 test: 0.949416
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({2: 3931, 0: 2876, 1: 2323})

Epoch :  44 loss training:  3.526626968057826 Time :  9835
accuracy train: 0.996443 val: 0.949695 test: 0.950973
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({1: 3932, 0: 2877, 2: 2321})

Epoch :  45 loss training:  3.7836562772863545 Time :  9855
accuracy train: 0.996443 val: 0.951220 test: 0.950584
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({2: 3932, 0: 2878, 1: 2320})

Epoch :  46 loss training:  3.7717031240463257 Time :  9876
accuracy train: 0.996274 val: 0.951220 test: 0.948638
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({2: 3932, 0: 2878, 1: 2320})

Epoch :  47 loss training:  3.5189506431343034 Time :  9896
accuracy train: 0.996443 val: 0.945122 test: 0.952140
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({1: 3932, 0: 2878, 2: 2320})

Epoch :  48 loss training:  3.550439779064618 Time :  9916
accuracy train: 0.995935 val: 0.951220 test: 0.952140
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({2: 3932, 0: 2878, 1: 2320})

Epoch :  49 loss training:  3.044038495514542 Time :  9938
accuracy train: 0.996612 val: 0.948171 test: 0.949027
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({2: 3932, 0: 2879, 1: 2319})

Epoch :  50 loss training:  3.2783824775833637 Time :  9959
accuracy train: 0.996443 val: 0.948171 test: 0.949416
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({0: 3932, 2: 2880, 1: 2318})

Epoch :  51 loss training:  3.2618294654530473 Time :  9979
accuracy train: 0.996443 val: 0.946646 test: 0.949027
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({0: 3932, 1: 2879, 2: 2319})

Epoch :  52 loss training:  3.417525918339379 Time :  10000
accuracy train: 0.996443 val: 0.946646 test: 0.949416
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({1: 3932, 0: 2880, 2: 2318})

Epoch :  53 loss training:  2.7311846336815506 Time :  10021
accuracy train: 0.996782 val: 0.948171 test: 0.950973
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({1: 3932, 0: 2881, 2: 2317})

Epoch :  54 loss training:  2.786434299952816 Time :  10042
accuracy train: 0.996782 val: 0.945122 test: 0.950584
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({2: 3932, 0: 2881, 1: 2317})

Epoch :  55 loss training:  3.0300121618784033 Time :  10063
accuracy train: 0.996951 val: 0.942073 test: 0.949805
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({2: 3932, 0: 2881, 1: 2317})

Epoch :  56 loss training:  2.5607580686337315 Time :  10084
accuracy train: 0.996951 val: 0.945122 test: 0.950195
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({2: 3932, 0: 2881, 1: 2317})

Epoch :  57 loss training:  2.980543215671787 Time :  10105
accuracy train: 0.996951 val: 0.945122 test: 0.949027
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({2: 3931, 0: 2881, 1: 2318})

Epoch :  58 loss training:  2.9665023592533544 Time :  10126
accuracy train: 0.996782 val: 0.945122 test: 0.949027
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({2: 3931, 0: 2882, 1: 2317})

Epoch :  59 loss training:  2.4828539178706706 Time :  10147
accuracy train: 0.997121 val: 0.946646 test: 0.949805
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({2: 3931, 0: 2882, 1: 2317})

Epoch :  60 loss training:  2.2776640899537597 Time :  10168
accuracy train: 0.996782 val: 0.948171 test: 0.951362
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({2: 3931, 0: 2882, 1: 2317})

Epoch :  61 loss training:  2.695252117700875 Time :  10190
accuracy train: 0.997121 val: 0.948171 test: 0.950584
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({1: 3931, 2: 2882, 0: 2317})

Epoch :  62 loss training:  2.768943404807942 Time :  10212
accuracy train: 0.997121 val: 0.946646 test: 0.949416
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({2: 3932, 0: 2885, 1: 2313})

Epoch :  63 loss training:  2.582450084388256 Time :  10234
accuracy train: 0.996443 val: 0.948171 test: 0.951362
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({1: 3932, 0: 2885, 2: 2313})

Epoch :  64 loss training:  2.535782306920737 Time :  10256
accuracy train: 0.997290 val: 0.948171 test: 0.950195
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({2: 3932, 0: 2886, 1: 2312})

Epoch :  65 loss training:  2.7951880495238584 Time :  10276
accuracy train: 0.997290 val: 0.946646 test: 0.949416
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({2: 3932, 0: 2891, 1: 2307})

Epoch :  66 loss training:  2.4379492413718253 Time :  10298
accuracy train: 0.996782 val: 0.942073 test: 0.951751
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({1: 3932, 2: 2891, 0: 2307})

Epoch :  67 loss training:  2.2004303379217163 Time :  10320
accuracy train: 0.996782 val: 0.951220 test: 0.951751
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({2: 3932, 0: 2891, 1: 2307})

Epoch :  68 loss training:  2.3534503650153056 Time :  10342
accuracy train: 0.996782 val: 0.948171 test: 0.950973
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({1: 3932, 2: 2891, 0: 2307})

Epoch :  69 loss training:  2.5971159166365396 Time :  10364
accuracy train: 0.996951 val: 0.948171 test: 0.950195
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({2: 3932, 0: 2891, 1: 2307})

Epoch :  70 loss training:  2.3024296387739014 Time :  10389
accuracy train: 0.996782 val: 0.948171 test: 0.950195
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({2: 3932, 0: 2891, 1: 2307})

Epoch :  71 loss training:  2.159522764137364 Time :  10411
accuracy train: 0.996951 val: 0.946646 test: 0.949027
max validation accuracy : 0.952744 max acc epoch : 40 test accuracy : 0.950973
Counter({2: 3932, 0: 2891, 1: 2307})

========================================================================================================================================================================================================
max acc epoch :  40
max validation accuracy :  0.9527439024390244
test accuracy :  0.9509727626459143
last test_accuracy :  0.9490272373540856
========================================================================================================================================================================================================

itr : 6
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=339, weight_decay=1e-08)
device :  cuda:0
Counter({0: 5417, 2: 2501, 1: 1212})

Epoch :  1 loss training:  124.5826905220747 Time :  10438
accuracy train: 0.904980 val: 0.897866 test: 0.888327
max validation accuracy : 0.897866 max acc epoch : 1 test accuracy : 0.888327
Counter({0: 3684, 2: 2869, 1: 2577})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.36064827814698 Time :  10459
accuracy train: 0.936484 val: 0.914634 test: 0.905837
max validation accuracy : 0.914634 max acc epoch : 2 test accuracy : 0.905837
Counter({1: 3809, 0: 2827, 2: 2494})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  41.0556341893971 Time :  10479
accuracy train: 0.941226 val: 0.910061 test: 0.924514
max validation accuracy : 0.914634 max acc epoch : 2 test accuracy : 0.905837
Counter({1: 3752, 0: 2896, 2: 2482})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  26.95889637991786 Time :  10497
accuracy train: 0.966633 val: 0.925305 test: 0.923735
max validation accuracy : 0.925305 max acc epoch : 4 test accuracy : 0.923735
Counter({1: 3823, 0: 2883, 2: 2424})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  22.414702907204628 Time :  10517
accuracy train: 0.976626 val: 0.948171 test: 0.942802
max validation accuracy : 0.948171 max acc epoch : 5 test accuracy : 0.942802
Counter({1: 3829, 0: 2884, 2: 2417})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  19.112461945973337 Time :  10537
accuracy train: 0.976795 val: 0.935976 test: 0.938911
max validation accuracy : 0.948171 max acc epoch : 5 test accuracy : 0.942802
Counter({0: 3821, 2: 2907, 1: 2402})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  16.626101644709706 Time :  10557
accuracy train: 0.984756 val: 0.945122 test: 0.943580
max validation accuracy : 0.948171 max acc epoch : 5 test accuracy : 0.942802
Counter({2: 3830, 0: 2873, 1: 2427})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  13.939692243933678 Time :  10578
accuracy train: 0.987805 val: 0.948171 test: 0.946304
max validation accuracy : 0.948171 max acc epoch : 5 test accuracy : 0.942802
Counter({1: 3837, 2: 2896, 0: 2397})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  13.15352894878015 Time :  10598
accuracy train: 0.987974 val: 0.948171 test: 0.950195
max validation accuracy : 0.948171 max acc epoch : 5 test accuracy : 0.942802
Counter({1: 3873, 2: 2871, 0: 2386})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  11.089365845546126 Time :  10618
accuracy train: 0.989499 val: 0.951220 test: 0.947082
max validation accuracy : 0.951220 max acc epoch : 10 test accuracy : 0.947082
Counter({2: 3876, 0: 2872, 1: 2382})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  10.992689311504364 Time :  10639
accuracy train: 0.990346 val: 0.945122 test: 0.947471
max validation accuracy : 0.951220 max acc epoch : 10 test accuracy : 0.947082
Counter({2: 3851, 0: 2872, 1: 2407})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  10.77835563197732 Time :  10659
accuracy train: 0.988482 val: 0.948171 test: 0.951751
max validation accuracy : 0.951220 max acc epoch : 10 test accuracy : 0.947082
Counter({1: 3858, 0: 2896, 2: 2376})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  9.89922978170216 Time :  10679
accuracy train: 0.991023 val: 0.954268 test: 0.948638
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({1: 3858, 2: 2870, 0: 2402})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  9.531934996135533 Time :  10700
accuracy train: 0.991192 val: 0.952744 test: 0.949416
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({1: 3858, 2: 2870, 0: 2402})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  8.84942045295611 Time :  10721
accuracy train: 0.991870 val: 0.949695 test: 0.945525
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({2: 3857, 0: 2872, 1: 2401})

Epoch :  16 loss training:  8.814067215193063 Time :  10743
accuracy train: 0.992039 val: 0.951220 test: 0.945136
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({1: 3857, 0: 2872, 2: 2401})

Epoch :  17 loss training:  8.369815394980833 Time :  10764
accuracy train: 0.991870 val: 0.949695 test: 0.952140
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({2: 3859, 0: 2871, 1: 2400})

Epoch :  18 loss training:  8.092273442540318 Time :  10785
accuracy train: 0.992209 val: 0.952744 test: 0.951751
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({1: 3859, 0: 2868, 2: 2403})

Epoch :  19 loss training:  8.445245992392302 Time :  10806
accuracy train: 0.992717 val: 0.949695 test: 0.949805
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({1: 3861, 0: 2874, 2: 2395})

Epoch :  20 loss training:  8.02441872889176 Time :  10828
accuracy train: 0.993225 val: 0.948171 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({2: 3862, 0: 2874, 1: 2394})

Epoch :  21 loss training:  7.236629347549751 Time :  10850
accuracy train: 0.994580 val: 0.951220 test: 0.952529
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({1: 3863, 0: 2873, 2: 2394})

Epoch :  22 loss training:  7.261835229117423 Time :  10872
accuracy train: 0.994411 val: 0.949695 test: 0.949416
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({1: 3868, 0: 2874, 2: 2388})

Epoch :  23 loss training:  7.103282463271171 Time :  10894
accuracy train: 0.994411 val: 0.954268 test: 0.949805
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({1: 3868, 0: 2875, 2: 2387})

Epoch :  24 loss training:  6.579177025472745 Time :  10915
accuracy train: 0.994241 val: 0.952744 test: 0.949805
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({1: 3870, 0: 2873, 2: 2387})

Epoch :  25 loss training:  6.514768051216379 Time :  10937
accuracy train: 0.994749 val: 0.948171 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({1: 3871, 0: 2884, 2: 2375})

Epoch :  26 loss training:  6.1750728050246835 Time :  10958
accuracy train: 0.995427 val: 0.946646 test: 0.948249
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({1: 3876, 2: 2885, 0: 2369})

Epoch :  27 loss training:  6.298363388516009 Time :  10979
accuracy train: 0.995427 val: 0.948171 test: 0.951362
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({2: 3876, 0: 2886, 1: 2368})

Epoch :  28 loss training:  5.88847052003257 Time :  10999
accuracy train: 0.995596 val: 0.954268 test: 0.950973
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({1: 3880, 0: 2886, 2: 2364})

Epoch :  29 loss training:  6.017826855415478 Time :  11020
accuracy train: 0.995935 val: 0.952744 test: 0.949805
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({2: 3881, 0: 2886, 1: 2363})

Epoch :  30 loss training:  5.561114166630432 Time :  11042
accuracy train: 0.995427 val: 0.952744 test: 0.949416
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({2: 3881, 1: 2887, 0: 2362})

Epoch :  31 loss training:  5.2470850355457515 Time :  11064
accuracy train: 0.995935 val: 0.946646 test: 0.948638
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({2: 3882, 0: 2887, 1: 2361})

Epoch :  32 loss training:  5.095418825163506 Time :  11085
accuracy train: 0.996443 val: 0.946646 test: 0.949805
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({1: 3883, 0: 2887, 2: 2360})

Epoch :  33 loss training:  4.902483953279443 Time :  11105
accuracy train: 0.996612 val: 0.948171 test: 0.947860
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({2: 3884, 0: 2890, 1: 2356})

Epoch :  34 loss training:  5.010997759643942 Time :  11126
accuracy train: 0.995766 val: 0.951220 test: 0.951362
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({2: 3885, 0: 2889, 1: 2356})

Epoch :  35 loss training:  4.726261892588809 Time :  11146
accuracy train: 0.996443 val: 0.949695 test: 0.952529
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({1: 3885, 0: 2889, 2: 2356})

Epoch :  36 loss training:  4.9208596523385495 Time :  11167
accuracy train: 0.996104 val: 0.954268 test: 0.952918
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({2: 3885, 0: 2889, 1: 2356})

Epoch :  37 loss training:  4.796749616099987 Time :  11189
accuracy train: 0.996104 val: 0.954268 test: 0.950195
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({2: 3887, 0: 2892, 1: 2351})

Epoch :  38 loss training:  4.319347292883322 Time :  11211
accuracy train: 0.996443 val: 0.952744 test: 0.950973
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({2: 3885, 0: 2894, 1: 2351})

Epoch :  39 loss training:  3.9970471041742712 Time :  11231
accuracy train: 0.996274 val: 0.954268 test: 0.951751
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({0: 3886, 2: 2921, 1: 2323})

Epoch :  40 loss training:  4.225130091421306 Time :  11253
accuracy train: 0.996951 val: 0.951220 test: 0.949416
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({2: 3888, 0: 2896, 1: 2346})

Epoch :  41 loss training:  3.705435494775884 Time :  11275
accuracy train: 0.996104 val: 0.951220 test: 0.951362
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({2: 3888, 0: 2895, 1: 2347})

Epoch :  42 loss training:  3.772148601245135 Time :  11296
accuracy train: 0.996274 val: 0.949695 test: 0.953307
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({1: 3889, 0: 2922, 2: 2319})

Epoch :  43 loss training:  3.4785744447726756 Time :  11317
accuracy train: 0.996443 val: 0.949695 test: 0.952529
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({2: 3890, 0: 2923, 1: 2317})

Epoch :  44 loss training:  3.548175025731325 Time :  11339
accuracy train: 0.996443 val: 0.948171 test: 0.954086
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.948638
Counter({2: 3889, 0: 2924, 1: 2317})

========================================================================================================================================================================================================
max acc epoch :  13
max validation accuracy :  0.9542682926829268
test accuracy :  0.9486381322957198
last test_accuracy :  0.9540856031128405
========================================================================================================================================================================================================

itr : 7
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=339, weight_decay=1e-08)
device :  cuda:0
Counter({0: 5417, 2: 2501, 1: 1212})

Epoch :  1 loss training:  124.5999351143837 Time :  11365
accuracy train: 0.908706 val: 0.894817 test: 0.890661
max validation accuracy : 0.894817 max acc epoch : 1 test accuracy : 0.890661
Counter({1: 3690, 2: 2862, 0: 2578})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.50913529843092 Time :  11385
accuracy train: 0.936314 val: 0.914634 test: 0.907393
max validation accuracy : 0.914634 max acc epoch : 2 test accuracy : 0.907393
Counter({1: 3794, 0: 2820, 2: 2516})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  40.75669218599796 Time :  11406
accuracy train: 0.936653 val: 0.910061 test: 0.924125
max validation accuracy : 0.914634 max acc epoch : 2 test accuracy : 0.907393
Counter({1: 3727, 2: 2925, 0: 2478})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  26.836856424808502 Time :  11427
accuracy train: 0.966802 val: 0.923780 test: 0.924514
max validation accuracy : 0.923780 max acc epoch : 4 test accuracy : 0.924514
Counter({0: 3806, 1: 2890, 2: 2434})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  22.447149723768234 Time :  11447
accuracy train: 0.977134 val: 0.948171 test: 0.943969
max validation accuracy : 0.948171 max acc epoch : 5 test accuracy : 0.943969
Counter({2: 3808, 0: 2892, 1: 2430})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  19.080069409683347 Time :  11467
accuracy train: 0.976457 val: 0.934451 test: 0.938911
max validation accuracy : 0.948171 max acc epoch : 5 test accuracy : 0.943969
Counter({1: 3798, 0: 2913, 2: 2419})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  16.441066715866327 Time :  11488
accuracy train: 0.984417 val: 0.948171 test: 0.945525
max validation accuracy : 0.948171 max acc epoch : 5 test accuracy : 0.943969
Counter({2: 3821, 0: 2872, 1: 2437})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  14.080062522552907 Time :  11508
accuracy train: 0.988482 val: 0.945122 test: 0.943969
max validation accuracy : 0.948171 max acc epoch : 5 test accuracy : 0.943969
Counter({1: 3841, 0: 2870, 2: 2419})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  13.164294547401369 Time :  11528
accuracy train: 0.988313 val: 0.943598 test: 0.949805
max validation accuracy : 0.948171 max acc epoch : 5 test accuracy : 0.943969
Counter({1: 3868, 0: 2871, 2: 2391})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  10.817412405274808 Time :  11548
accuracy train: 0.988991 val: 0.945122 test: 0.946304
max validation accuracy : 0.948171 max acc epoch : 5 test accuracy : 0.943969
Counter({1: 3870, 0: 2874, 2: 2386})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  10.745880482252687 Time :  11568
accuracy train: 0.990346 val: 0.946646 test: 0.945914
max validation accuracy : 0.948171 max acc epoch : 5 test accuracy : 0.943969
Counter({1: 3876, 0: 2874, 2: 2380})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  10.857664642389864 Time :  11589
accuracy train: 0.988991 val: 0.945122 test: 0.951362
max validation accuracy : 0.948171 max acc epoch : 5 test accuracy : 0.943969
Counter({2: 3882, 0: 2872, 1: 2376})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  9.92042227042839 Time :  11609
accuracy train: 0.991192 val: 0.949695 test: 0.948638
max validation accuracy : 0.949695 max acc epoch : 13 test accuracy : 0.948638
Counter({2: 3885, 0: 2872, 1: 2373})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  9.41382996365428 Time :  11629
accuracy train: 0.992209 val: 0.951220 test: 0.948638
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({2: 3888, 0: 2870, 1: 2372})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  8.699733245652169 Time :  11649
accuracy train: 0.991701 val: 0.949695 test: 0.947860
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({2: 3862, 0: 2871, 1: 2397})

Epoch :  16 loss training:  8.826551048085093 Time :  11671
accuracy train: 0.991531 val: 0.945122 test: 0.945525
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({0: 3864, 2: 2869, 1: 2397})

Epoch :  17 loss training:  8.24685374670662 Time :  11692
accuracy train: 0.991870 val: 0.948171 test: 0.951751
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({1: 3865, 2: 2868, 0: 2397})

Epoch :  18 loss training:  8.226420936640352 Time :  11712
accuracy train: 0.992717 val: 0.948171 test: 0.952918
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({1: 3867, 0: 2866, 2: 2397})

Epoch :  19 loss training:  8.411093444796279 Time :  11732
accuracy train: 0.993056 val: 0.948171 test: 0.950973
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({1: 3869, 0: 2870, 2: 2391})

Epoch :  20 loss training:  7.9130501742474735 Time :  11753
accuracy train: 0.992886 val: 0.946646 test: 0.950584
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({2: 3868, 0: 2871, 1: 2391})

Epoch :  21 loss training:  7.108111680019647 Time :  11774
accuracy train: 0.994241 val: 0.945122 test: 0.951362
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({0: 3868, 2: 2871, 1: 2391})

Epoch :  22 loss training:  7.109091599006206 Time :  11795
accuracy train: 0.994072 val: 0.948171 test: 0.950195
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({1: 3870, 2: 2873, 0: 2387})

Epoch :  23 loss training:  7.0108467331156135 Time :  11818
accuracy train: 0.994580 val: 0.949695 test: 0.949805
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({1: 3870, 0: 2876, 2: 2384})

Epoch :  24 loss training:  6.511302440427244 Time :  11839
accuracy train: 0.994580 val: 0.948171 test: 0.948638
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({2: 3874, 0: 2877, 1: 2379})

Epoch :  25 loss training:  6.474264148389921 Time :  11860
accuracy train: 0.994749 val: 0.945122 test: 0.950973
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({1: 3877, 0: 2877, 2: 2376})

Epoch :  26 loss training:  6.137691107345745 Time :  11882
accuracy train: 0.995427 val: 0.943598 test: 0.949416
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({1: 3878, 0: 2877, 2: 2375})

Epoch :  27 loss training:  6.142913315445185 Time :  11903
accuracy train: 0.995766 val: 0.948171 test: 0.951362
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({1: 3907, 0: 2878, 2: 2345})

Epoch :  28 loss training:  5.691500567016192 Time :  11923
accuracy train: 0.995257 val: 0.948171 test: 0.950195
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({1: 3908, 0: 2884, 2: 2338})

Epoch :  29 loss training:  5.849509817780927 Time :  11944
accuracy train: 0.995257 val: 0.949695 test: 0.949027
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({2: 3883, 0: 2884, 1: 2363})

Epoch :  30 loss training:  5.558478955877945 Time :  11965
accuracy train: 0.995257 val: 0.949695 test: 0.950973
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({1: 3885, 0: 2886, 2: 2359})

Epoch :  31 loss training:  5.075127455871552 Time :  11986
accuracy train: 0.995935 val: 0.946646 test: 0.949027
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({1: 3887, 0: 2884, 2: 2359})

Epoch :  32 loss training:  5.062375095440075 Time :  12008
accuracy train: 0.996612 val: 0.946646 test: 0.950584
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({1: 3887, 0: 2884, 2: 2359})

Epoch :  33 loss training:  4.924001920153387 Time :  12030
accuracy train: 0.996443 val: 0.946646 test: 0.950195
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({1: 3888, 0: 2883, 2: 2359})

Epoch :  34 loss training:  4.946644238661975 Time :  12050
accuracy train: 0.995596 val: 0.948171 test: 0.955253
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({2: 3890, 0: 2882, 1: 2358})

Epoch :  35 loss training:  4.726484379498288 Time :  12072
accuracy train: 0.996443 val: 0.948171 test: 0.950195
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({2: 3890, 0: 2882, 1: 2358})

Epoch :  36 loss training:  4.853865982731804 Time :  12092
accuracy train: 0.996104 val: 0.949695 test: 0.953307
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({2: 3890, 0: 2884, 1: 2356})

Epoch :  37 loss training:  4.52319619350601 Time :  12115
accuracy train: 0.995935 val: 0.949695 test: 0.952529
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({1: 3891, 0: 2885, 2: 2354})

Epoch :  38 loss training:  4.105871813953854 Time :  12137
accuracy train: 0.996274 val: 0.949695 test: 0.951751
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({1: 3890, 0: 2885, 2: 2355})

Epoch :  39 loss training:  3.9662305440288037 Time :  12157
accuracy train: 0.996104 val: 0.949695 test: 0.950973
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({2: 3891, 0: 2885, 1: 2354})

Epoch :  40 loss training:  4.2222320206929 Time :  12178
accuracy train: 0.996612 val: 0.948171 test: 0.951751
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({2: 3892, 0: 2887, 1: 2351})

Epoch :  41 loss training:  3.57973427826073 Time :  12199
accuracy train: 0.996104 val: 0.949695 test: 0.950973
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({2: 3893, 0: 2887, 1: 2350})

Epoch :  42 loss training:  3.8645988568896428 Time :  12221
accuracy train: 0.996443 val: 0.949695 test: 0.954475
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({0: 3893, 2: 2887, 1: 2350})

Epoch :  43 loss training:  3.5873284307308495 Time :  12242
accuracy train: 0.995935 val: 0.949695 test: 0.953696
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({1: 3895, 0: 2886, 2: 2349})

Epoch :  44 loss training:  3.5134752256562933 Time :  12265
accuracy train: 0.996274 val: 0.948171 test: 0.950584
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({2: 3895, 0: 2886, 1: 2349})

Epoch :  45 loss training:  3.8685363268014044 Time :  12286
accuracy train: 0.996274 val: 0.951220 test: 0.953696
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.948638
Counter({2: 3894, 0: 2913, 1: 2323})

========================================================================================================================================================================================================
max acc epoch :  14
max validation accuracy :  0.9512195121951219
test accuracy :  0.9486381322957198
last test_accuracy :  0.9536964980544748
========================================================================================================================================================================================================

itr : 8
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=339, weight_decay=1e-08)
device :  cuda:0
Counter({0: 5417, 2: 2501, 1: 1212})

Epoch :  1 loss training:  124.70831483602524 Time :  12312
accuracy train: 0.908367 val: 0.897866 test: 0.892218
max validation accuracy : 0.897866 max acc epoch : 1 test accuracy : 0.892218
Counter({0: 3679, 2: 2873, 1: 2578})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.126000851392746 Time :  12333
accuracy train: 0.937161 val: 0.914634 test: 0.906615
max validation accuracy : 0.914634 max acc epoch : 2 test accuracy : 0.906615
Counter({1: 3787, 0: 2821, 2: 2522})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  40.7499174028635 Time :  12353
accuracy train: 0.942412 val: 0.911585 test: 0.927237
max validation accuracy : 0.914634 max acc epoch : 2 test accuracy : 0.906615
Counter({2: 3748, 0: 2886, 1: 2496})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  26.87888001371175 Time :  12373
accuracy train: 0.967818 val: 0.929878 test: 0.928405
max validation accuracy : 0.929878 max acc epoch : 4 test accuracy : 0.928405
Counter({1: 3822, 0: 2877, 2: 2431})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  22.06047150120139 Time :  12394
accuracy train: 0.977473 val: 0.946646 test: 0.941634
max validation accuracy : 0.946646 max acc epoch : 5 test accuracy : 0.941634
Counter({1: 3826, 0: 2880, 2: 2424})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  19.05773655930534 Time :  12415
accuracy train: 0.977134 val: 0.939024 test: 0.939689
max validation accuracy : 0.946646 max acc epoch : 5 test accuracy : 0.941634
Counter({1: 3836, 0: 2889, 2: 2405})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  16.12738772109151 Time :  12437
accuracy train: 0.985603 val: 0.943598 test: 0.941634
max validation accuracy : 0.946646 max acc epoch : 5 test accuracy : 0.941634
Counter({1: 3850, 0: 2878, 2: 2402})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  13.962974107824266 Time :  12457
accuracy train: 0.987805 val: 0.948171 test: 0.944747
max validation accuracy : 0.948171 max acc epoch : 8 test accuracy : 0.944747
Counter({1: 3861, 0: 2874, 2: 2395})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  12.960255432408303 Time :  12477
accuracy train: 0.988313 val: 0.949695 test: 0.948638
max validation accuracy : 0.949695 max acc epoch : 9 test accuracy : 0.948638
Counter({2: 3864, 0: 2869, 1: 2397})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  10.831272720359266 Time :  12497
accuracy train: 0.989160 val: 0.951220 test: 0.944358
max validation accuracy : 0.951220 max acc epoch : 10 test accuracy : 0.944358
Counter({1: 3864, 0: 2870, 2: 2396})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  10.538971322122961 Time :  12518
accuracy train: 0.990176 val: 0.948171 test: 0.945525
max validation accuracy : 0.951220 max acc epoch : 10 test accuracy : 0.944358
Counter({1: 3881, 0: 2869, 2: 2380})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  10.594256440643221 Time :  12539
accuracy train: 0.988313 val: 0.948171 test: 0.950195
max validation accuracy : 0.951220 max acc epoch : 10 test accuracy : 0.944358
Counter({1: 3886, 0: 2870, 2: 2374})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  9.772133879363537 Time :  12559
accuracy train: 0.991362 val: 0.954268 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.949027
Counter({1: 3888, 0: 2868, 2: 2374})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  9.325856739189476 Time :  12580
accuracy train: 0.992209 val: 0.952744 test: 0.947860
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.949027
Counter({1: 3891, 0: 2867, 2: 2372})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  8.642169941216707 Time :  12600
accuracy train: 0.991531 val: 0.952744 test: 0.945136
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.949027
Counter({1: 3892, 0: 2868, 2: 2370})

Epoch :  16 loss training:  8.606708507984877 Time :  12621
accuracy train: 0.991870 val: 0.949695 test: 0.947082
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.949027
Counter({2: 3892, 0: 2868, 1: 2370})

Epoch :  17 loss training:  8.243282878538594 Time :  12644
accuracy train: 0.992378 val: 0.951220 test: 0.949805
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.949027
Counter({0: 3892, 2: 2868, 1: 2370})

Epoch :  18 loss training:  8.08477855566889 Time :  12667
accuracy train: 0.992717 val: 0.954268 test: 0.950973
max validation accuracy : 0.954268 max acc epoch : 13 test accuracy : 0.949027
Counter({1: 3894, 0: 2868, 2: 2368})

Epoch :  19 loss training:  8.30820059380494 Time :  12688
accuracy train: 0.993394 val: 0.955793 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({0: 3895, 2: 2874, 1: 2361})

Epoch :  20 loss training:  7.690915111918002 Time :  12711
accuracy train: 0.993564 val: 0.951220 test: 0.950584
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({1: 3896, 0: 2875, 2: 2359})

Epoch :  21 loss training:  7.206961856689304 Time :  12731
accuracy train: 0.994580 val: 0.951220 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({1: 3899, 0: 2873, 2: 2358})

Epoch :  22 loss training:  7.068878243211657 Time :  12753
accuracy train: 0.994411 val: 0.951220 test: 0.949805
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({1: 3901, 0: 2872, 2: 2357})

Epoch :  23 loss training:  6.780371953500435 Time :  12775
accuracy train: 0.994749 val: 0.951220 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({2: 3902, 0: 2872, 1: 2356})

Epoch :  24 loss training:  6.625885631190613 Time :  12796
accuracy train: 0.994749 val: 0.952744 test: 0.949027
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({0: 3907, 1: 2869, 2: 2354})

Epoch :  25 loss training:  6.389722288935445 Time :  12818
accuracy train: 0.995088 val: 0.948171 test: 0.949805
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({1: 3908, 0: 2877, 2: 2345})

Epoch :  26 loss training:  6.101023041526787 Time :  12840
accuracy train: 0.995427 val: 0.948171 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({1: 3908, 0: 2880, 2: 2342})

Epoch :  27 loss training:  6.040249821962789 Time :  12860
accuracy train: 0.995257 val: 0.952744 test: 0.949805
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({2: 3909, 0: 2879, 1: 2342})

Epoch :  28 loss training:  5.560202386695892 Time :  12880
accuracy train: 0.994919 val: 0.954268 test: 0.948638
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({0: 3910, 2: 2880, 1: 2340})

Epoch :  29 loss training:  5.847948554204777 Time :  12901
accuracy train: 0.995596 val: 0.954268 test: 0.950584
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({0: 3915, 1: 2879, 2: 2336})

Epoch :  30 loss training:  5.495752674061805 Time :  12922
accuracy train: 0.994919 val: 0.954268 test: 0.949805
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({2: 3916, 0: 2881, 1: 2333})

Epoch :  31 loss training:  4.994483852526173 Time :  12943
accuracy train: 0.995935 val: 0.948171 test: 0.950973
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({1: 3919, 0: 2880, 2: 2331})

Epoch :  32 loss training:  4.806698827305809 Time :  12964
accuracy train: 0.996612 val: 0.951220 test: 0.948638
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({1: 3919, 0: 2881, 2: 2330})

Epoch :  33 loss training:  4.815479464363307 Time :  12985
accuracy train: 0.995935 val: 0.949695 test: 0.949027
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({1: 3920, 0: 2880, 2: 2330})

Epoch :  34 loss training:  4.90991200809367 Time :  13006
accuracy train: 0.995766 val: 0.952744 test: 0.952918
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({2: 3924, 0: 2880, 1: 2326})

Epoch :  35 loss training:  4.61428963416256 Time :  13027
accuracy train: 0.996104 val: 0.948171 test: 0.951362
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({2: 3923, 1: 2880, 0: 2327})

Epoch :  36 loss training:  4.68343404692132 Time :  13048
accuracy train: 0.996104 val: 0.954268 test: 0.952140
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({2: 3923, 0: 2880, 1: 2327})

Epoch :  37 loss training:  4.35309440823039 Time :  13070
accuracy train: 0.996104 val: 0.952744 test: 0.950973
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({2: 3923, 0: 2880, 1: 2327})

Epoch :  38 loss training:  4.19648548681289 Time :  13091
accuracy train: 0.996274 val: 0.952744 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({2: 3923, 0: 2880, 1: 2327})

Epoch :  39 loss training:  3.8168615660397336 Time :  13112
accuracy train: 0.996104 val: 0.951220 test: 0.950584
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({1: 3923, 0: 2880, 2: 2327})

Epoch :  40 loss training:  4.122320163878612 Time :  13132
accuracy train: 0.996612 val: 0.952744 test: 0.952918
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({1: 3932, 0: 2875, 2: 2323})

Epoch :  41 loss training:  3.5339759959606454 Time :  13154
accuracy train: 0.996274 val: 0.951220 test: 0.949027
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({1: 3932, 2: 2875, 0: 2323})

Epoch :  42 loss training:  3.6985569858225062 Time :  13175
accuracy train: 0.996443 val: 0.948171 test: 0.954086
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({1: 3932, 2: 2875, 0: 2323})

Epoch :  43 loss training:  3.612913607619703 Time :  13199
accuracy train: 0.995935 val: 0.952744 test: 0.953307
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({1: 3932, 0: 2876, 2: 2322})

Epoch :  44 loss training:  3.477781208464876 Time :  13221
accuracy train: 0.996274 val: 0.949695 test: 0.952529
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({2: 3924, 0: 2885, 1: 2321})

Epoch :  45 loss training:  3.796586539130658 Time :  13243
accuracy train: 0.996443 val: 0.954268 test: 0.951751
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({2: 3922, 0: 2887, 1: 2321})

Epoch :  46 loss training:  3.7007934822468087 Time :  13265
accuracy train: 0.996274 val: 0.952744 test: 0.951362
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({2: 3922, 0: 2887, 1: 2321})

Epoch :  47 loss training:  3.5480860191746615 Time :  13287
accuracy train: 0.996612 val: 0.954268 test: 0.952918
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({2: 3931, 0: 2885, 1: 2314})

Epoch :  48 loss training:  3.433191683376208 Time :  13308
accuracy train: 0.996104 val: 0.954268 test: 0.951751
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({2: 3932, 0: 2884, 1: 2314})

Epoch :  49 loss training:  3.15244510024786 Time :  13330
accuracy train: 0.996274 val: 0.949695 test: 0.948638
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({2: 3925, 0: 2891, 1: 2314})

Epoch :  50 loss training:  3.19836121838307 Time :  13351
accuracy train: 0.996443 val: 0.949695 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.949416
Counter({2: 3924, 0: 2891, 1: 2315})

========================================================================================================================================================================================================
max acc epoch :  19
max validation accuracy :  0.9557926829268293
test accuracy :  0.9494163424124513
last test_accuracy :  0.9501945525291828
========================================================================================================================================================================================================

itr : 9
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=339, weight_decay=1e-08)
device :  cuda:0
Counter({0: 5417, 2: 2501, 1: 1212})

Epoch :  1 loss training:  124.65516348183155 Time :  13377
accuracy train: 0.906504 val: 0.897866 test: 0.889105
max validation accuracy : 0.897866 max acc epoch : 1 test accuracy : 0.889105
Counter({1: 3677, 0: 2889, 2: 2564})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.52403084561229 Time :  13397
accuracy train: 0.934790 val: 0.916159 test: 0.910506
max validation accuracy : 0.916159 max acc epoch : 2 test accuracy : 0.910506
Counter({2: 3786, 0: 2835, 1: 2509})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  40.4744281694293 Time :  13418
accuracy train: 0.940041 val: 0.913110 test: 0.926070
max validation accuracy : 0.916159 max acc epoch : 2 test accuracy : 0.910506
Counter({1: 3747, 0: 2884, 2: 2499})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  26.813356488011777 Time :  13438
accuracy train: 0.967480 val: 0.929878 test: 0.924125
max validation accuracy : 0.929878 max acc epoch : 4 test accuracy : 0.924125
Counter({1: 3827, 0: 2877, 2: 2426})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  22.20788509771228 Time :  13459
accuracy train: 0.978320 val: 0.945122 test: 0.943580
max validation accuracy : 0.945122 max acc epoch : 5 test accuracy : 0.943580
Counter({0: 3835, 1: 2880, 2: 2415})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  19.139041926246136 Time :  13480
accuracy train: 0.977812 val: 0.939024 test: 0.938132
max validation accuracy : 0.945122 max acc epoch : 5 test accuracy : 0.943580
Counter({2: 3837, 0: 2890, 1: 2403})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  15.925922805443406 Time :  13501
accuracy train: 0.983401 val: 0.946646 test: 0.942802
max validation accuracy : 0.946646 max acc epoch : 7 test accuracy : 0.942802
Counter({2: 3853, 0: 2877, 1: 2400})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  13.807063927873969 Time :  13522
accuracy train: 0.989160 val: 0.948171 test: 0.945914
max validation accuracy : 0.948171 max acc epoch : 8 test accuracy : 0.945914
Counter({0: 3863, 2: 2871, 1: 2396})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  13.041171435732394 Time :  13542
accuracy train: 0.988144 val: 0.952744 test: 0.951362
max validation accuracy : 0.952744 max acc epoch : 9 test accuracy : 0.951362
Counter({1: 3874, 0: 2861, 2: 2395})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  10.90657458640635 Time :  13563
accuracy train: 0.988652 val: 0.951220 test: 0.947860
max validation accuracy : 0.952744 max acc epoch : 9 test accuracy : 0.951362
Counter({2: 3875, 0: 2864, 1: 2391})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  10.815852683968842 Time :  13584
accuracy train: 0.989837 val: 0.948171 test: 0.947471
max validation accuracy : 0.952744 max acc epoch : 9 test accuracy : 0.951362
Counter({2: 3883, 0: 2866, 1: 2381})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  10.652050300035626 Time :  13604
accuracy train: 0.988991 val: 0.949695 test: 0.950973
max validation accuracy : 0.952744 max acc epoch : 9 test accuracy : 0.951362
Counter({1: 3885, 2: 2867, 0: 2378})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  9.806712563149631 Time :  13624
accuracy train: 0.991192 val: 0.952744 test: 0.950195
max validation accuracy : 0.952744 max acc epoch : 9 test accuracy : 0.951362
Counter({0: 3886, 2: 2867, 1: 2377})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  9.316464533563703 Time :  13643
accuracy train: 0.992378 val: 0.951220 test: 0.949805
max validation accuracy : 0.952744 max acc epoch : 9 test accuracy : 0.951362
Counter({2: 3889, 0: 2865, 1: 2376})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  8.617370078805834 Time :  13663
accuracy train: 0.991701 val: 0.948171 test: 0.946304
max validation accuracy : 0.952744 max acc epoch : 9 test accuracy : 0.951362
Counter({1: 3889, 0: 2866, 2: 2375})

Epoch :  16 loss training:  8.643497361335903 Time :  13685
accuracy train: 0.991870 val: 0.949695 test: 0.948249
max validation accuracy : 0.952744 max acc epoch : 9 test accuracy : 0.951362
Counter({2: 3889, 0: 2866, 1: 2375})

Epoch :  17 loss training:  8.105563736055046 Time :  13707
accuracy train: 0.992039 val: 0.951220 test: 0.953307
max validation accuracy : 0.952744 max acc epoch : 9 test accuracy : 0.951362
Counter({2: 3893, 0: 2865, 1: 2372})

Epoch :  18 loss training:  7.996338677126914 Time :  13729
accuracy train: 0.992717 val: 0.955793 test: 0.952140
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({2: 3894, 0: 2864, 1: 2372})

Epoch :  19 loss training:  8.34660999965854 Time :  13751
accuracy train: 0.993056 val: 0.951220 test: 0.951362
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({0: 3896, 1: 2863, 2: 2371})

Epoch :  20 loss training:  7.642862586304545 Time :  13774
accuracy train: 0.993733 val: 0.952744 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({2: 3898, 0: 2863, 1: 2369})

Epoch :  21 loss training:  7.222792668733746 Time :  13797
accuracy train: 0.994919 val: 0.951220 test: 0.952529
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({1: 3898, 2: 2863, 0: 2369})

Epoch :  22 loss training:  7.068751564249396 Time :  13819
accuracy train: 0.994411 val: 0.951220 test: 0.950973
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({1: 3900, 2: 2863, 0: 2367})

Epoch :  23 loss training:  6.998674700036645 Time :  13843
accuracy train: 0.994919 val: 0.951220 test: 0.952140
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({2: 3901, 0: 2865, 1: 2364})

Epoch :  24 loss training:  6.653469688724726 Time :  13867
accuracy train: 0.994919 val: 0.949695 test: 0.951751
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({2: 3901, 0: 2865, 1: 2364})

Epoch :  25 loss training:  6.592976879328489 Time :  13888
accuracy train: 0.994919 val: 0.946646 test: 0.951362
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({2: 3904, 0: 2869, 1: 2357})

Epoch :  26 loss training:  6.033612771658227 Time :  13909
accuracy train: 0.995257 val: 0.948171 test: 0.950584
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({1: 3905, 0: 2869, 2: 2356})

Epoch :  27 loss training:  5.940927273128182 Time :  13931
accuracy train: 0.995257 val: 0.949695 test: 0.950584
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({2: 3905, 0: 2869, 1: 2356})

Epoch :  28 loss training:  5.750146184233017 Time :  13952
accuracy train: 0.995766 val: 0.951220 test: 0.951362
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({0: 3907, 2: 2871, 1: 2352})

Epoch :  29 loss training:  5.8763483567745425 Time :  13975
accuracy train: 0.995935 val: 0.951220 test: 0.947471
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({2: 3911, 0: 2871, 1: 2348})

Epoch :  30 loss training:  5.428167822770774 Time :  13997
accuracy train: 0.995596 val: 0.952744 test: 0.948638
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({2: 3911, 0: 2875, 1: 2344})

Epoch :  31 loss training:  5.119123921380378 Time :  14017
accuracy train: 0.995766 val: 0.948171 test: 0.947860
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({1: 3914, 0: 2875, 2: 2341})

Epoch :  32 loss training:  4.962242953595705 Time :  14038
accuracy train: 0.996274 val: 0.945122 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({2: 3914, 0: 2876, 1: 2340})

Epoch :  33 loss training:  4.775582751026377 Time :  14060
accuracy train: 0.996104 val: 0.952744 test: 0.948638
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({2: 3920, 0: 2875, 1: 2335})

Epoch :  34 loss training:  4.89007090497762 Time :  14083
accuracy train: 0.995935 val: 0.951220 test: 0.952140
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({2: 3920, 0: 2875, 1: 2335})

Epoch :  35 loss training:  4.4809367707930505 Time :  14104
accuracy train: 0.996612 val: 0.946646 test: 0.950973
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({2: 3921, 0: 2875, 1: 2334})

Epoch :  36 loss training:  4.727051388239488 Time :  14125
accuracy train: 0.996443 val: 0.952744 test: 0.951362
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({2: 3921, 0: 2875, 1: 2334})

Epoch :  37 loss training:  4.413157796370797 Time :  14147
accuracy train: 0.996274 val: 0.952744 test: 0.950584
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({2: 3922, 0: 2882, 1: 2326})

Epoch :  38 loss training:  3.941375333117321 Time :  14168
accuracy train: 0.996104 val: 0.948171 test: 0.949805
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({0: 3922, 2: 2882, 1: 2326})

Epoch :  39 loss training:  3.91806011821609 Time :  14189
accuracy train: 0.996443 val: 0.952744 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({0: 3922, 2: 2882, 1: 2326})

Epoch :  40 loss training:  4.066692012827843 Time :  14211
accuracy train: 0.996782 val: 0.949695 test: 0.952529
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({2: 3923, 0: 2883, 1: 2324})

Epoch :  41 loss training:  3.434837011853233 Time :  14233
accuracy train: 0.996274 val: 0.951220 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({2: 3923, 0: 2883, 1: 2324})

Epoch :  42 loss training:  3.6543015013448894 Time :  14256
accuracy train: 0.996274 val: 0.949695 test: 0.952140
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({2: 3925, 0: 2883, 1: 2322})

Epoch :  43 loss training:  3.4637260880554095 Time :  14280
accuracy train: 0.996274 val: 0.949695 test: 0.950973
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({2: 3926, 0: 2884, 1: 2320})

Epoch :  44 loss training:  3.4232381430920213 Time :  14302
accuracy train: 0.996274 val: 0.951220 test: 0.951362
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({2: 3925, 0: 2885, 1: 2320})

Epoch :  45 loss training:  3.682756267138757 Time :  14323
accuracy train: 0.996782 val: 0.952744 test: 0.951751
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({2: 3924, 0: 2886, 1: 2320})

Epoch :  46 loss training:  3.610590865369886 Time :  14345
accuracy train: 0.996612 val: 0.955793 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({2: 3926, 0: 2886, 1: 2318})

Epoch :  47 loss training:  3.3164867077139206 Time :  14368
accuracy train: 0.996612 val: 0.951220 test: 0.951751
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({1: 3926, 0: 2887, 2: 2317})

Epoch :  48 loss training:  3.355070427292958 Time :  14389
accuracy train: 0.996274 val: 0.952744 test: 0.952918
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({2: 3926, 0: 2887, 1: 2317})

Epoch :  49 loss training:  3.0889290388440713 Time :  14411
accuracy train: 0.997121 val: 0.949695 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({2: 3927, 0: 2886, 1: 2317})

========================================================================================================================================================================================================
max acc epoch :  18
max validation accuracy :  0.9557926829268293
test accuracy :  0.9521400778210116
last test_accuracy :  0.9494163424124513
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.95579 	 test_accuracy : 0.95175 	 max_acc epoch :  48 	 last test_accuracy : 0.94591
k :  1 	 val_accuracy : 0.95579 	 test_accuracy : 0.95019 	 max_acc epoch :  28 	 last test_accuracy : 0.94942
k :  2 	 val_accuracy : 0.95579 	 test_accuracy : 0.94825 	 max_acc epoch :  9 	 last test_accuracy : 0.95097
k :  3 	 val_accuracy : 0.95427 	 test_accuracy : 0.95019 	 max_acc epoch :  13 	 last test_accuracy : 0.95175
k :  4 	 val_accuracy : 0.95732 	 test_accuracy : 0.95136 	 max_acc epoch :  48 	 last test_accuracy : 0.95019
k :  5 	 val_accuracy : 0.95274 	 test_accuracy : 0.95097 	 max_acc epoch :  40 	 last test_accuracy : 0.94903
k :  6 	 val_accuracy : 0.95427 	 test_accuracy : 0.94864 	 max_acc epoch :  13 	 last test_accuracy : 0.95409
k :  7 	 val_accuracy : 0.95122 	 test_accuracy : 0.94864 	 max_acc epoch :  14 	 last test_accuracy : 0.95370
k :  8 	 val_accuracy : 0.95579 	 test_accuracy : 0.94942 	 max_acc epoch :  19 	 last test_accuracy : 0.95019
k :  9 	 val_accuracy : 0.95579 	 test_accuracy : 0.95214 	 max_acc epoch :  18 	 last test_accuracy : 0.94942

avg :  	 val_accuracy : 0.95488 	 test_accuracy : 0.95016 	 last_accuracy : 0.95047
