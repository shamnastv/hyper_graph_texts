date and time :  Tue Jan 26 15:44:00 2021
Namespace(batch_size=16, dataset='R52', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=1e-06)
device :  cuda:0
HGNNModel(
  (word_embeddings): Embedding(9333, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=52, bias=True)
    (1): Linear(in_features=200, out_features=52, bias=True)
    (2): Linear(in_features=200, out_features=52, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
)
Epoch :  1 loss training:  298.71939238067716 Time :  12
accuracy train: 0.923950 val: 0.897866 test: 0.898054
max validation accuracy : 0.8978658536585366 max acc epoch : 1 test accuracy : 0.8980544747081712

Epoch :  2 loss training:  114.32614487828687 Time :  24
accuracy train: 0.951050 val: 0.923780 test: 0.921401
max validation accuracy : 0.9237804878048781 max acc epoch : 2 test accuracy : 0.9214007782101167

Epoch :  3 loss training:  78.04213547636755 Time :  37
accuracy train: 0.976118 val: 0.931402 test: 0.924125
max validation accuracy : 0.9314024390243902 max acc epoch : 3 test accuracy : 0.9241245136186771

Epoch :  4 loss training:  58.20426139375195 Time :  48
accuracy train: 0.981199 val: 0.939024 test: 0.932685
max validation accuracy : 0.9390243902439024 max acc epoch : 4 test accuracy : 0.9326848249027238

Epoch :  5 loss training:  45.841785950702615 Time :  59
accuracy train: 0.980352 val: 0.934451 test: 0.932296
max validation accuracy : 0.9390243902439024 max acc epoch : 4 test accuracy : 0.9326848249027238

Epoch :  6 loss training:  31.026649319916032 Time :  71
accuracy train: 0.988313 val: 0.942073 test: 0.939689
max validation accuracy : 0.9420731707317073 max acc epoch : 6 test accuracy : 0.9396887159533074

Epoch :  7 loss training:  23.935124086099677 Time :  83
accuracy train: 0.993902 val: 0.940549 test: 0.938911
max validation accuracy : 0.9420731707317073 max acc epoch : 6 test accuracy : 0.9396887159533074

Epoch :  8 loss training:  22.49000275018625 Time :  94
accuracy train: 0.991870 val: 0.949695 test: 0.934241
max validation accuracy : 0.9496951219512195 max acc epoch : 8 test accuracy : 0.9342412451361868

Epoch :  9 loss training:  20.40505202912027 Time :  106
accuracy train: 0.992378 val: 0.939024 test: 0.934241
max validation accuracy : 0.9496951219512195 max acc epoch : 8 test accuracy : 0.9342412451361868

Epoch :  10 loss training:  17.390182098635705 Time :  116
accuracy train: 0.994749 val: 0.934451 test: 0.938911
max validation accuracy : 0.9496951219512195 max acc epoch : 8 test accuracy : 0.9342412451361868

Epoch :  11 loss training:  14.91452357659 Time :  126
accuracy train: 0.996443 val: 0.948171 test: 0.937743
max validation accuracy : 0.9496951219512195 max acc epoch : 8 test accuracy : 0.9342412451361868

Epoch :  12 loss training:  12.491068480761896 Time :  137
accuracy train: 0.996951 val: 0.951220 test: 0.936187
max validation accuracy : 0.9512195121951219 max acc epoch : 12 test accuracy : 0.9361867704280156

Epoch :  13 loss training:  11.18629354069708 Time :  148
accuracy train: 0.997798 val: 0.954268 test: 0.938911
max validation accuracy : 0.9542682926829268 max acc epoch : 13 test accuracy : 0.9389105058365759

Epoch :  14 loss training:  10.993617503350833 Time :  160
accuracy train: 0.997459 val: 0.945122 test: 0.936965
max validation accuracy : 0.9542682926829268 max acc epoch : 13 test accuracy : 0.9389105058365759

Epoch :  15 loss training:  9.741666577247088 Time :  171
accuracy train: 0.996782 val: 0.951220 test: 0.936965
max validation accuracy : 0.9542682926829268 max acc epoch : 13 test accuracy : 0.9389105058365759

Epoch :  16 loss training:  7.475884892119211 Time :  182
accuracy train: 0.998137 val: 0.951220 test: 0.937743
max validation accuracy : 0.9542682926829268 max acc epoch : 13 test accuracy : 0.9389105058365759

Epoch :  17 loss training:  7.573926617289544 Time :  191
accuracy train: 0.998137 val: 0.949695 test: 0.939300
max validation accuracy : 0.9542682926829268 max acc epoch : 13 test accuracy : 0.9389105058365759

Epoch :  18 loss training:  6.43063948004783 Time :  202
accuracy train: 0.998137 val: 0.948171 test: 0.938911
max validation accuracy : 0.9542682926829268 max acc epoch : 13 test accuracy : 0.9389105058365759

Epoch :  19 loss training:  6.784271069584065 Time :  213
accuracy train: 0.997629 val: 0.948171 test: 0.940467
max validation accuracy : 0.9542682926829268 max acc epoch : 13 test accuracy : 0.9389105058365759

Epoch :  20 loss training:  6.83151565616572 Time :  223
accuracy train: 0.998137 val: 0.952744 test: 0.940078
max validation accuracy : 0.9542682926829268 max acc epoch : 13 test accuracy : 0.9389105058365759

Epoch :  21 loss training:  5.965392972859263 Time :  234
accuracy train: 0.997967 val: 0.952744 test: 0.940467
max validation accuracy : 0.9542682926829268 max acc epoch : 13 test accuracy : 0.9389105058365759

Epoch :  22 loss training:  5.519009950949112 Time :  244
accuracy train: 0.997967 val: 0.948171 test: 0.941634
max validation accuracy : 0.9542682926829268 max acc epoch : 13 test accuracy : 0.9389105058365759

Epoch :  23 loss training:  5.4296921445202315 Time :  255
accuracy train: 0.998137 val: 0.949695 test: 0.940467
max validation accuracy : 0.9542682926829268 max acc epoch : 13 test accuracy : 0.9389105058365759

Epoch :  24 loss training:  5.840930899328669 Time :  265
accuracy train: 0.998137 val: 0.946646 test: 0.942802
max validation accuracy : 0.9542682926829268 max acc epoch : 13 test accuracy : 0.9389105058365759

Epoch :  25 loss training:  4.9450264939368935 Time :  275
accuracy train: 0.998137 val: 0.949695 test: 0.942802
max validation accuracy : 0.9542682926829268 max acc epoch : 13 test accuracy : 0.9389105058365759

Epoch :  26 loss training:  4.742748710032174 Time :  282
accuracy train: 0.998137 val: 0.949695 test: 0.943191
max validation accuracy : 0.9542682926829268 max acc epoch : 13 test accuracy : 0.9389105058365759

Epoch :  27 loss training:  5.073656525819388 Time :  289
accuracy train: 0.998137 val: 0.951220 test: 0.941245
max validation accuracy : 0.9542682926829268 max acc epoch : 13 test accuracy : 0.9389105058365759

Epoch :  28 loss training:  4.872838647625031 Time :  296
accuracy train: 0.998137 val: 0.951220 test: 0.942023
max validation accuracy : 0.9542682926829268 max acc epoch : 13 test accuracy : 0.9389105058365759

Epoch :  29 loss training:  4.624183785839705 Time :  303
accuracy train: 0.998137 val: 0.951220 test: 0.942412
max validation accuracy : 0.9542682926829268 max acc epoch : 13 test accuracy : 0.9389105058365759

Epoch :  30 loss training:  4.179447737755254 Time :  311
accuracy train: 0.998137 val: 0.948171 test: 0.941245
max validation accuracy : 0.9542682926829268 max acc epoch : 13 test accuracy : 0.9389105058365759

Epoch :  31 loss training:  4.9863476124737645 Time :  318
accuracy train: 0.998137 val: 0.948171 test: 0.940078
max validation accuracy : 0.9542682926829268 max acc epoch : 13 test accuracy : 0.9389105058365759

Epoch :  32 loss training:  4.810088366215496 Time :  326
accuracy train: 0.998137 val: 0.945122 test: 0.941245
max validation accuracy : 0.9542682926829268 max acc epoch : 13 test accuracy : 0.9389105058365759

Epoch :  33 loss training:  4.428376425719762 Time :  333
accuracy train: 0.998306 val: 0.949695 test: 0.939689
max validation accuracy : 0.9542682926829268 max acc epoch : 13 test accuracy : 0.9389105058365759

Epoch :  34 loss training:  4.253448631796346 Time :  341
accuracy train: 0.998476 val: 0.957317 test: 0.942412
max validation accuracy : 0.9573170731707317 max acc epoch : 34 test accuracy : 0.9424124513618677

Epoch :  35 loss training:  4.712769676112657 Time :  348
accuracy train: 0.998137 val: 0.952744 test: 0.940078
max validation accuracy : 0.9573170731707317 max acc epoch : 34 test accuracy : 0.9424124513618677

Epoch :  36 loss training:  4.690212093220907 Time :  356
accuracy train: 0.998137 val: 0.946646 test: 0.940856
max validation accuracy : 0.9573170731707317 max acc epoch : 34 test accuracy : 0.9424124513618677

Epoch :  37 loss training:  4.559050120529719 Time :  363
accuracy train: 0.998137 val: 0.951220 test: 0.940467
max validation accuracy : 0.9573170731707317 max acc epoch : 34 test accuracy : 0.9424124513618677

Epoch :  38 loss training:  4.026132139653782 Time :  371
accuracy train: 0.998137 val: 0.952744 test: 0.940467
max validation accuracy : 0.9573170731707317 max acc epoch : 34 test accuracy : 0.9424124513618677

Epoch :  39 loss training:  4.586114726038431 Time :  379
accuracy train: 0.998137 val: 0.948171 test: 0.943191
max validation accuracy : 0.9573170731707317 max acc epoch : 34 test accuracy : 0.9424124513618677

Epoch :  40 loss training:  4.100843706990418 Time :  388
accuracy train: 0.998137 val: 0.948171 test: 0.942412
max validation accuracy : 0.9573170731707317 max acc epoch : 34 test accuracy : 0.9424124513618677

Epoch :  41 loss training:  4.434346044065023 Time :  397
accuracy train: 0.998306 val: 0.949695 test: 0.942412
max validation accuracy : 0.9573170731707317 max acc epoch : 34 test accuracy : 0.9424124513618677

Epoch :  42 loss training:  3.7343924932720256 Time :  404
accuracy train: 0.998137 val: 0.952744 test: 0.940856
max validation accuracy : 0.9573170731707317 max acc epoch : 34 test accuracy : 0.9424124513618677

Epoch :  43 loss training:  4.292822826517295 Time :  412
accuracy train: 0.998137 val: 0.948171 test: 0.941245
max validation accuracy : 0.9573170731707317 max acc epoch : 34 test accuracy : 0.9424124513618677

Epoch :  44 loss training:  3.844409094472212 Time :  420
accuracy train: 0.998476 val: 0.952744 test: 0.940467
max validation accuracy : 0.9573170731707317 max acc epoch : 34 test accuracy : 0.9424124513618677

Epoch :  45 loss training:  3.8880753644052675 Time :  427
accuracy train: 0.998306 val: 0.951220 test: 0.940856
max validation accuracy : 0.9573170731707317 max acc epoch : 34 test accuracy : 0.9424124513618677

Epoch :  46 loss training:  4.442231261375127 Time :  434
accuracy train: 0.998306 val: 0.948171 test: 0.940467
max validation accuracy : 0.9573170731707317 max acc epoch : 34 test accuracy : 0.9424124513618677

Epoch :  47 loss training:  5.282921973994235 Time :  441
accuracy train: 0.998137 val: 0.951220 test: 0.941634
max validation accuracy : 0.9573170731707317 max acc epoch : 34 test accuracy : 0.9424124513618677

Epoch :  48 loss training:  3.804693357695214 Time :  448
accuracy train: 0.998476 val: 0.952744 test: 0.941245
max validation accuracy : 0.9573170731707317 max acc epoch : 34 test accuracy : 0.9424124513618677

Epoch :  49 loss training:  3.9841375818359666 Time :  455
accuracy train: 0.998306 val: 0.954268 test: 0.940467
max validation accuracy : 0.9573170731707317 max acc epoch : 34 test accuracy : 0.9424124513618677

Epoch :  50 loss training:  4.638609489418741 Time :  462
accuracy train: 0.998476 val: 0.951220 test: 0.941634
max validation accuracy : 0.9573170731707317 max acc epoch : 34 test accuracy : 0.9424124513618677

Epoch :  51 loss training:  4.089007818191021 Time :  469
accuracy train: 0.998137 val: 0.946646 test: 0.941634
max validation accuracy : 0.9573170731707317 max acc epoch : 34 test accuracy : 0.9424124513618677

Epoch :  52 loss training:  3.5722952205615 Time :  476
accuracy train: 0.998306 val: 0.952744 test: 0.941245
max validation accuracy : 0.9573170731707317 max acc epoch : 34 test accuracy : 0.9424124513618677

Epoch :  53 loss training:  3.426656150531926 Time :  483
accuracy train: 0.998306 val: 0.952744 test: 0.942023
max validation accuracy : 0.9573170731707317 max acc epoch : 34 test accuracy : 0.9424124513618677

Epoch :  54 loss training:  4.273451764653146 Time :  490
accuracy train: 0.998137 val: 0.948171 test: 0.940467
max validation accuracy : 0.9573170731707317 max acc epoch : 34 test accuracy : 0.9424124513618677

Epoch :  55 loss training:  3.8827275325329538 Time :  497
accuracy train: 0.998137 val: 0.948171 test: 0.940856
max validation accuracy : 0.9573170731707317 max acc epoch : 34 test accuracy : 0.9424124513618677

========================================================================================================================================================================================================
max acc epoch :  34
max validation accuracy :  0.9573170731707317
test accuracy :  0.9424124513618677
latest_test_accuracy :  0.9408560311284047
========================================================================================================================================================================================================

