

date and time :  Sat May  8 21:31:43 2021
Namespace(batch_size=32, dataset='ohsumed', device=0, dropout=0.5, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=0)
device :  cuda:0
Counter({4: 6672, 1: 635, 0: 88, 3: 1, 6: 1, 7: 1, 5: 1, 2: 1})

Epoch :  1 loss training:  506.479633808136 Time :  84
accuracy train: 0.594639 val: 0.594030 test: 0.565422
max validation accuracy : 0.594030 max acc epoch : 1 test accuracy : 0.565422
Epoch-1 lr: 0.001

Epoch :  2 loss training:  341.64745903015137 Time :  115
accuracy train: 0.661813 val: 0.662687 test: 0.634925
max validation accuracy : 0.662687 max acc epoch : 2 test accuracy : 0.634925
Epoch-2 lr: 0.001

Epoch :  3 loss training:  298.68275052309036 Time :  145
accuracy train: 0.676704 val: 0.644776 test: 0.635419
max validation accuracy : 0.662687 max acc epoch : 2 test accuracy : 0.634925
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  249.8028565645218 Time :  177
accuracy train: 0.725347 val: 0.659701 test: 0.660153
max validation accuracy : 0.662687 max acc epoch : 2 test accuracy : 0.634925
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  245.53673273324966 Time :  208
accuracy train: 0.744540 val: 0.695522 test: 0.674499
max validation accuracy : 0.695522 max acc epoch : 5 test accuracy : 0.674499
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  226.15549367666245 Time :  240
accuracy train: 0.748180 val: 0.689552 test: 0.677467
max validation accuracy : 0.695522 max acc epoch : 5 test accuracy : 0.674499
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  215.10436749458313 Time :  272
accuracy train: 0.763402 val: 0.689552 test: 0.682167
max validation accuracy : 0.695522 max acc epoch : 5 test accuracy : 0.674499
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  200.59015142917633 Time :  303
accuracy train: 0.777631 val: 0.698507 test: 0.685135
max validation accuracy : 0.698507 max acc epoch : 8 test accuracy : 0.685135
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  194.67845356464386 Time :  334
accuracy train: 0.785242 val: 0.701493 test: 0.684640
max validation accuracy : 0.701493 max acc epoch : 9 test accuracy : 0.684640
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  192.15432274341583 Time :  365
accuracy train: 0.782263 val: 0.701493 test: 0.692802
max validation accuracy : 0.701493 max acc epoch : 9 test accuracy : 0.684640
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  180.08059453964233 Time :  397
accuracy train: 0.790867 val: 0.698507 test: 0.698491
max validation accuracy : 0.701493 max acc epoch : 9 test accuracy : 0.684640
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  184.33672678470612 Time :  428
accuracy train: 0.798809 val: 0.707463 test: 0.695523
max validation accuracy : 0.707463 max acc epoch : 12 test accuracy : 0.695523
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  175.39391642808914 Time :  460
accuracy train: 0.798478 val: 0.710448 test: 0.701212
max validation accuracy : 0.710448 max acc epoch : 13 test accuracy : 0.701212
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  177.276620388031 Time :  491
accuracy train: 0.801456 val: 0.707463 test: 0.700717
max validation accuracy : 0.710448 max acc epoch : 13 test accuracy : 0.701212
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  173.93888592720032 Time :  523
accuracy train: 0.806420 val: 0.704478 test: 0.703438
max validation accuracy : 0.710448 max acc epoch : 13 test accuracy : 0.701212

Epoch :  16 loss training:  169.6377653479576 Time :  554
accuracy train: 0.800132 val: 0.707463 test: 0.700717
max validation accuracy : 0.710448 max acc epoch : 13 test accuracy : 0.701212

Epoch :  17 loss training:  172.39374005794525 Time :  585
accuracy train: 0.805427 val: 0.716418 test: 0.704427
max validation accuracy : 0.716418 max acc epoch : 17 test accuracy : 0.704427

Epoch :  18 loss training:  177.20573991537094 Time :  616
accuracy train: 0.807743 val: 0.716418 test: 0.703191
max validation accuracy : 0.716418 max acc epoch : 17 test accuracy : 0.704427

Epoch :  19 loss training:  168.22364354133606 Time :  648
accuracy train: 0.808405 val: 0.707463 test: 0.702943
max validation accuracy : 0.716418 max acc epoch : 17 test accuracy : 0.704427

Epoch :  20 loss training:  172.745423078537 Time :  679
accuracy train: 0.804103 val: 0.716418 test: 0.701707
max validation accuracy : 0.716418 max acc epoch : 17 test accuracy : 0.704427

Epoch :  21 loss training:  167.65623486042023 Time :  711
accuracy train: 0.813369 val: 0.716418 test: 0.703191
max validation accuracy : 0.716418 max acc epoch : 17 test accuracy : 0.704427

Epoch :  22 loss training:  164.56161308288574 Time :  743
accuracy train: 0.818332 val: 0.719403 test: 0.703191
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.703191

Epoch :  23 loss training:  164.84029984474182 Time :  775
accuracy train: 0.817340 val: 0.701493 test: 0.703685
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.703191

Epoch :  24 loss training:  158.09452998638153 Time :  806
accuracy train: 0.818332 val: 0.713433 test: 0.703933
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.703191

Epoch :  25 loss training:  155.1191202402115 Time :  838
accuracy train: 0.828259 val: 0.713433 test: 0.706653
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.703191

Epoch :  26 loss training:  158.09003990888596 Time :  870
accuracy train: 0.830576 val: 0.716418 test: 0.704922
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.703191

Epoch :  27 loss training:  157.63079530000687 Time :  902
accuracy train: 0.832892 val: 0.710448 test: 0.709374
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.703191

Epoch :  28 loss training:  148.61207914352417 Time :  933
accuracy train: 0.838187 val: 0.707463 test: 0.706406
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.703191

Epoch :  29 loss training:  149.1737928390503 Time :  965
accuracy train: 0.837194 val: 0.707463 test: 0.706159
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.703191

Epoch :  30 loss training:  152.83030712604523 Time :  998
accuracy train: 0.839179 val: 0.707463 test: 0.709374
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.703191

Epoch :  31 loss training:  143.30984300374985 Time :  1031
accuracy train: 0.844474 val: 0.719403 test: 0.708138
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.703191

Epoch :  32 loss training:  143.7101246714592 Time :  1064
accuracy train: 0.850099 val: 0.713433 test: 0.709374
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.703191

Epoch :  33 loss training:  145.34673988819122 Time :  1094
accuracy train: 0.851754 val: 0.707463 test: 0.710116
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.703191

Epoch :  34 loss training:  142.47763872146606 Time :  1124
accuracy train: 0.851423 val: 0.707463 test: 0.712342
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.703191

Epoch :  35 loss training:  142.43298482894897 Time :  1155
accuracy train: 0.854732 val: 0.719403 test: 0.710858
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.703191

Epoch :  36 loss training:  135.93329405784607 Time :  1187
accuracy train: 0.859034 val: 0.722388 test: 0.712837
max validation accuracy : 0.722388 max acc epoch : 36 test accuracy : 0.712837

Epoch :  37 loss training:  135.69550740718842 Time :  1219
accuracy train: 0.868299 val: 0.728358 test: 0.714321
max validation accuracy : 0.728358 max acc epoch : 37 test accuracy : 0.714321

Epoch :  38 loss training:  130.95266765356064 Time :  1251
accuracy train: 0.869292 val: 0.716418 test: 0.713332
max validation accuracy : 0.728358 max acc epoch : 37 test accuracy : 0.714321

Epoch :  39 loss training:  133.53661626577377 Time :  1281
accuracy train: 0.867306 val: 0.710448 test: 0.717042
max validation accuracy : 0.728358 max acc epoch : 37 test accuracy : 0.714321

Epoch :  40 loss training:  126.15062516927719 Time :  1313
accuracy train: 0.869954 val: 0.719403 test: 0.715063
max validation accuracy : 0.728358 max acc epoch : 37 test accuracy : 0.714321

Epoch :  41 loss training:  130.22663521766663 Time :  1343
accuracy train: 0.871277 val: 0.716418 test: 0.718031
max validation accuracy : 0.728358 max acc epoch : 37 test accuracy : 0.714321

Epoch :  42 loss training:  127.17225360870361 Time :  1374
accuracy train: 0.879881 val: 0.722388 test: 0.713332
max validation accuracy : 0.728358 max acc epoch : 37 test accuracy : 0.714321

Epoch :  43 loss training:  125.2987647652626 Time :  1405
accuracy train: 0.878226 val: 0.722388 test: 0.716547
max validation accuracy : 0.728358 max acc epoch : 37 test accuracy : 0.714321

Epoch :  44 loss training:  116.4257021844387 Time :  1436
accuracy train: 0.885837 val: 0.734328 test: 0.715063
max validation accuracy : 0.734328 max acc epoch : 44 test accuracy : 0.715063

Epoch :  45 loss training:  120.87446337938309 Time :  1467
accuracy train: 0.883521 val: 0.728358 test: 0.715310
max validation accuracy : 0.734328 max acc epoch : 44 test accuracy : 0.715063

Epoch :  46 loss training:  115.20146709680557 Time :  1498
accuracy train: 0.889477 val: 0.725373 test: 0.717784
max validation accuracy : 0.734328 max acc epoch : 44 test accuracy : 0.715063

Epoch :  47 loss training:  117.77765423059464 Time :  1528
accuracy train: 0.893448 val: 0.734328 test: 0.719268
max validation accuracy : 0.734328 max acc epoch : 44 test accuracy : 0.715063

Epoch :  48 loss training:  117.50735378265381 Time :  1558
accuracy train: 0.890470 val: 0.728358 test: 0.718773
max validation accuracy : 0.734328 max acc epoch : 44 test accuracy : 0.715063

Epoch :  49 loss training:  110.91225409507751 Time :  1587
accuracy train: 0.896426 val: 0.728358 test: 0.718279
max validation accuracy : 0.734328 max acc epoch : 44 test accuracy : 0.715063

Epoch :  50 loss training:  110.26266738772392 Time :  1616
accuracy train: 0.900066 val: 0.731343 test: 0.721494
max validation accuracy : 0.734328 max acc epoch : 44 test accuracy : 0.715063

Epoch :  51 loss training:  111.13676822185516 Time :  1645
accuracy train: 0.900066 val: 0.734328 test: 0.719763
max validation accuracy : 0.734328 max acc epoch : 44 test accuracy : 0.715063

Epoch :  52 loss training:  110.71657460927963 Time :  1675
accuracy train: 0.907346 val: 0.731343 test: 0.719515
max validation accuracy : 0.734328 max acc epoch : 44 test accuracy : 0.715063

Epoch :  53 loss training:  105.94479221105576 Time :  1704
accuracy train: 0.904699 val: 0.731343 test: 0.717042
max validation accuracy : 0.734328 max acc epoch : 44 test accuracy : 0.715063

Epoch :  54 loss training:  107.07952725887299 Time :  1733
accuracy train: 0.911979 val: 0.731343 test: 0.722978
max validation accuracy : 0.734328 max acc epoch : 44 test accuracy : 0.715063

Epoch :  55 loss training:  102.76412349939346 Time :  1763
accuracy train: 0.911317 val: 0.746269 test: 0.721494
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  56 loss training:  98.93404543399811 Time :  1793
accuracy train: 0.913964 val: 0.737313 test: 0.719763
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  57 loss training:  98.51020210981369 Time :  1823
accuracy train: 0.916612 val: 0.731343 test: 0.724957
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  58 loss training:  104.04812812805176 Time :  1852
accuracy train: 0.920251 val: 0.737313 test: 0.724709
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  59 loss training:  94.26548084616661 Time :  1882
accuracy train: 0.918266 val: 0.728358 test: 0.722483
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  60 loss training:  95.03689324855804 Time :  1912
accuracy train: 0.924553 val: 0.728358 test: 0.724957
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  61 loss training:  91.69921380281448 Time :  1941
accuracy train: 0.924553 val: 0.737313 test: 0.724215
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  62 loss training:  94.58420321345329 Time :  1973
accuracy train: 0.928193 val: 0.731343 test: 0.724462
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  63 loss training:  91.56028205156326 Time :  2005
accuracy train: 0.933488 val: 0.725373 test: 0.726935
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  64 loss training:  91.6328960955143 Time :  2035
accuracy train: 0.934150 val: 0.734328 test: 0.725204
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  65 loss training:  92.94090950489044 Time :  2065
accuracy train: 0.938120 val: 0.725373 test: 0.725451
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  66 loss training:  88.48924645781517 Time :  2095
accuracy train: 0.941099 val: 0.722388 test: 0.724957
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  67 loss training:  85.51239249110222 Time :  2126
accuracy train: 0.940106 val: 0.728358 test: 0.723967
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  68 loss training:  86.59418618679047 Time :  2156
accuracy train: 0.941430 val: 0.731343 test: 0.723473
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  69 loss training:  81.30779367685318 Time :  2185
accuracy train: 0.941760 val: 0.728358 test: 0.727183
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  70 loss training:  81.9872779250145 Time :  2215
accuracy train: 0.941430 val: 0.737313 test: 0.726935
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  71 loss training:  82.82011631131172 Time :  2245
accuracy train: 0.950364 val: 0.725373 test: 0.724215
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  72 loss training:  81.86896225810051 Time :  2275
accuracy train: 0.949040 val: 0.734328 test: 0.726193
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  73 loss training:  79.71338048577309 Time :  2306
accuracy train: 0.950695 val: 0.734328 test: 0.723967
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  74 loss training:  79.84390497207642 Time :  2338
accuracy train: 0.954666 val: 0.734328 test: 0.728172
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  75 loss training:  77.24679520726204 Time :  2368
accuracy train: 0.955989 val: 0.743284 test: 0.728667
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  76 loss training:  75.667610257864 Time :  2398
accuracy train: 0.953673 val: 0.743284 test: 0.722483
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  77 loss training:  74.11053052544594 Time :  2428
accuracy train: 0.957644 val: 0.722388 test: 0.724709
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  78 loss training:  73.21300706267357 Time :  2458
accuracy train: 0.956651 val: 0.719403 test: 0.724957
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  79 loss training:  71.54821325838566 Time :  2488
accuracy train: 0.961284 val: 0.713433 test: 0.725204
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  80 loss training:  70.25003832578659 Time :  2518
accuracy train: 0.956320 val: 0.734328 test: 0.727430
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  81 loss training:  69.25221247971058 Time :  2547
accuracy train: 0.961284 val: 0.722388 test: 0.730893
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  82 loss training:  67.92572167515755 Time :  2578
accuracy train: 0.962938 val: 0.740299 test: 0.727677
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  83 loss training:  68.12088614702225 Time :  2608
accuracy train: 0.964593 val: 0.734328 test: 0.727677
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  84 loss training:  62.89691072702408 Time :  2637
accuracy train: 0.969887 val: 0.734328 test: 0.727430
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  85 loss training:  65.73604279756546 Time :  2667
accuracy train: 0.967240 val: 0.731343 test: 0.728914
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

Epoch :  86 loss training:  64.91456240415573 Time :  2697
accuracy train: 0.966578 val: 0.728358 test: 0.729656
max validation accuracy : 0.746269 max acc epoch : 55 test accuracy : 0.721494

========================================================================================================================================================================================================
max acc epoch :  55
max validation accuracy :  0.746268656716418
test accuracy :  0.7214939401434578
last test_accuracy :  0.729656195894138
========================================================================================================================================================================================================

