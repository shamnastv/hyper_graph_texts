

date and time :  Sat Jun  5 14:55:37 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=63, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  213.16930276155472 Time :  28
accuracy train: 0.655857 val: 0.623881 test: 0.613406
max validation accuracy : 0.623881 max acc epoch : 1 test accuracy : 0.613406
Epoch-1 lr: 0.001

Epoch :  2 loss training:  146.14508259296417 Time :  49
accuracy train: 0.712111 val: 0.644776 test: 0.653475
max validation accuracy : 0.644776 max acc epoch : 2 test accuracy : 0.653475
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.15297549962997 Time :  66
accuracy train: 0.761085 val: 0.644776 test: 0.658422
max validation accuracy : 0.644776 max acc epoch : 2 test accuracy : 0.653475
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  99.49335876107216 Time :  83
accuracy train: 0.803772 val: 0.671642 test: 0.694534
max validation accuracy : 0.671642 max acc epoch : 4 test accuracy : 0.694534
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  91.89513921737671 Time :  103
accuracy train: 0.808736 val: 0.674627 test: 0.697007
max validation accuracy : 0.674627 max acc epoch : 5 test accuracy : 0.697007
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.42891344428062 Time :  120
accuracy train: 0.818332 val: 0.680597 test: 0.688845
max validation accuracy : 0.680597 max acc epoch : 6 test accuracy : 0.688845
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  75.10516908764839 Time :  138
accuracy train: 0.857379 val: 0.683582 test: 0.710611
max validation accuracy : 0.683582 max acc epoch : 7 test accuracy : 0.710611
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  71.29785880446434 Time :  156
accuracy train: 0.856386 val: 0.683582 test: 0.707395
max validation accuracy : 0.683582 max acc epoch : 7 test accuracy : 0.710611
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  68.12435457110405 Time :  173
accuracy train: 0.876572 val: 0.701493 test: 0.713084
max validation accuracy : 0.701493 max acc epoch : 9 test accuracy : 0.713084
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.568533554673195 Time :  191
accuracy train: 0.890801 val: 0.695522 test: 0.710116
max validation accuracy : 0.701493 max acc epoch : 9 test accuracy : 0.713084
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  57.53345040977001 Time :  209
accuracy train: 0.895433 val: 0.698507 test: 0.715310
max validation accuracy : 0.701493 max acc epoch : 9 test accuracy : 0.713084
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.052576676011086 Time :  226
accuracy train: 0.895103 val: 0.695522 test: 0.717042
max validation accuracy : 0.701493 max acc epoch : 9 test accuracy : 0.713084
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  55.150717571377754 Time :  244
accuracy train: 0.908008 val: 0.701493 test: 0.717042
max validation accuracy : 0.701493 max acc epoch : 9 test accuracy : 0.713084
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  54.0636243224144 Time :  262
accuracy train: 0.905692 val: 0.698507 test: 0.718526
max validation accuracy : 0.701493 max acc epoch : 9 test accuracy : 0.713084
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  53.68469540774822 Time :  279
accuracy train: 0.908008 val: 0.689552 test: 0.719763
max validation accuracy : 0.701493 max acc epoch : 9 test accuracy : 0.713084

Epoch :  16 loss training:  52.72697626054287 Time :  296
accuracy train: 0.911979 val: 0.692537 test: 0.717784
max validation accuracy : 0.701493 max acc epoch : 9 test accuracy : 0.713084

Epoch :  17 loss training:  52.65245373547077 Time :  314
accuracy train: 0.918928 val: 0.695522 test: 0.718773
max validation accuracy : 0.701493 max acc epoch : 9 test accuracy : 0.713084

Epoch :  18 loss training:  51.29608644545078 Time :  331
accuracy train: 0.921906 val: 0.707463 test: 0.718773
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  19 loss training:  47.739747039973736 Time :  348
accuracy train: 0.926539 val: 0.695522 test: 0.716052
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  20 loss training:  47.7015335559845 Time :  366
accuracy train: 0.930510 val: 0.692537 test: 0.719021
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  21 loss training:  45.93352863937616 Time :  384
accuracy train: 0.936466 val: 0.686567 test: 0.722483
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  22 loss training:  45.58576402068138 Time :  402
accuracy train: 0.937128 val: 0.704478 test: 0.717289
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  23 loss training:  43.08639580756426 Time :  419
accuracy train: 0.942091 val: 0.680597 test: 0.718279
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  24 loss training:  39.635002106428146 Time :  437
accuracy train: 0.938451 val: 0.674627 test: 0.720257
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  25 loss training:  39.747779086232185 Time :  454
accuracy train: 0.947386 val: 0.695522 test: 0.721494
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  26 loss training:  38.32384939491749 Time :  472
accuracy train: 0.948709 val: 0.692537 test: 0.723473
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  27 loss training:  38.37035170942545 Time :  489
accuracy train: 0.950364 val: 0.695522 test: 0.721247
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  28 loss training:  36.63736177235842 Time :  506
accuracy train: 0.960622 val: 0.695522 test: 0.724709
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  29 loss training:  35.06659013032913 Time :  524
accuracy train: 0.961284 val: 0.695522 test: 0.721741
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  30 loss training:  33.56575806438923 Time :  541
accuracy train: 0.965586 val: 0.704478 test: 0.723225
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  31 loss training:  33.451520808041096 Time :  559
accuracy train: 0.969887 val: 0.701493 test: 0.721494
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  32 loss training:  31.039100371301174 Time :  576
accuracy train: 0.970880 val: 0.686567 test: 0.723720
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  33 loss training:  30.256938442587852 Time :  594
accuracy train: 0.976506 val: 0.695522 test: 0.718279
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  34 loss training:  29.091891162097454 Time :  611
accuracy train: 0.974520 val: 0.695522 test: 0.720257
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  35 loss training:  29.331854410469532 Time :  628
accuracy train: 0.979484 val: 0.689552 test: 0.717042
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  36 loss training:  27.561261400580406 Time :  646
accuracy train: 0.980807 val: 0.707463 test: 0.718031
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  37 loss training:  28.893037524074316 Time :  663
accuracy train: 0.978822 val: 0.686567 test: 0.720010
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  38 loss training:  26.32589938491583 Time :  680
accuracy train: 0.987426 val: 0.686567 test: 0.720257
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  39 loss training:  25.05834998190403 Time :  698
accuracy train: 0.984116 val: 0.701493 test: 0.720999
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  40 loss training:  24.274638410657644 Time :  716
accuracy train: 0.987095 val: 0.686567 test: 0.719021
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  41 loss training:  24.330757327377796 Time :  733
accuracy train: 0.987756 val: 0.677612 test: 0.721494
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  42 loss training:  21.957255505025387 Time :  750
accuracy train: 0.990073 val: 0.689552 test: 0.720257
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  43 loss training:  21.460090968757868 Time :  767
accuracy train: 0.989080 val: 0.680597 test: 0.719763
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  44 loss training:  20.665279518812895 Time :  784
accuracy train: 0.991066 val: 0.686567 test: 0.720010
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  45 loss training:  20.23106674849987 Time :  802
accuracy train: 0.993382 val: 0.668657 test: 0.716052
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  46 loss training:  18.69724139198661 Time :  820
accuracy train: 0.994375 val: 0.686567 test: 0.717784
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  47 loss training:  17.903277315199375 Time :  838
accuracy train: 0.994705 val: 0.689552 test: 0.720752
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  48 loss training:  16.57904613018036 Time :  855
accuracy train: 0.995036 val: 0.680597 test: 0.721741
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

Epoch :  49 loss training:  17.505794022232294 Time :  873
accuracy train: 0.996029 val: 0.695522 test: 0.719268
max validation accuracy : 0.707463 max acc epoch : 18 test accuracy : 0.718773

========================================================================================================================================================================================================
max acc epoch :  18
max validation accuracy :  0.7074626865671642
test accuracy :  0.7187731882265644
last test_accuracy :  0.7192678703932723
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=63, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  212.66473412513733 Time :  903
accuracy train: 0.651555 val: 0.605970 test: 0.609448
max validation accuracy : 0.605970 max acc epoch : 1 test accuracy : 0.609448
Epoch-1 lr: 0.001

Epoch :  2 loss training:  146.35356885194778 Time :  920
accuracy train: 0.718068 val: 0.638806 test: 0.652486
max validation accuracy : 0.638806 max acc epoch : 2 test accuracy : 0.652486
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.42112699151039 Time :  937
accuracy train: 0.760093 val: 0.650746 test: 0.658422
max validation accuracy : 0.650746 max acc epoch : 3 test accuracy : 0.658422
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  99.30083015561104 Time :  953
accuracy train: 0.803111 val: 0.683582 test: 0.692802
max validation accuracy : 0.683582 max acc epoch : 4 test accuracy : 0.692802
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  91.09854352474213 Time :  970
accuracy train: 0.808405 val: 0.671642 test: 0.698491
max validation accuracy : 0.683582 max acc epoch : 4 test accuracy : 0.692802
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.1740979552269 Time :  987
accuracy train: 0.820979 val: 0.677612 test: 0.690082
max validation accuracy : 0.683582 max acc epoch : 4 test accuracy : 0.692802
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  75.09684926271439 Time :  1004
accuracy train: 0.860026 val: 0.683582 test: 0.710611
max validation accuracy : 0.683582 max acc epoch : 4 test accuracy : 0.692802
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  71.11263059079647 Time :  1020
accuracy train: 0.854401 val: 0.686567 test: 0.706159
max validation accuracy : 0.686567 max acc epoch : 8 test accuracy : 0.706159
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  68.10866613686085 Time :  1037
accuracy train: 0.871939 val: 0.698507 test: 0.712837
max validation accuracy : 0.698507 max acc epoch : 9 test accuracy : 0.712837
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.53072561323643 Time :  1054
accuracy train: 0.889808 val: 0.689552 test: 0.708138
max validation accuracy : 0.698507 max acc epoch : 9 test accuracy : 0.712837
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  57.38206347823143 Time :  1071
accuracy train: 0.896095 val: 0.695522 test: 0.716300
max validation accuracy : 0.698507 max acc epoch : 9 test accuracy : 0.712837
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.3548368960619 Time :  1088
accuracy train: 0.893117 val: 0.704478 test: 0.717784
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.717784
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  55.19083580374718 Time :  1104
accuracy train: 0.912310 val: 0.701493 test: 0.721741
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.717784
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  54.26106444001198 Time :  1121
accuracy train: 0.908670 val: 0.707463 test: 0.718526
max validation accuracy : 0.707463 max acc epoch : 14 test accuracy : 0.718526
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  53.636947467923164 Time :  1139
accuracy train: 0.908008 val: 0.704478 test: 0.719021
max validation accuracy : 0.707463 max acc epoch : 14 test accuracy : 0.718526

Epoch :  16 loss training:  52.91028189659119 Time :  1156
accuracy train: 0.914626 val: 0.707463 test: 0.719268
max validation accuracy : 0.707463 max acc epoch : 14 test accuracy : 0.718526

Epoch :  17 loss training:  51.952540189027786 Time :  1174
accuracy train: 0.921244 val: 0.698507 test: 0.719021
max validation accuracy : 0.707463 max acc epoch : 14 test accuracy : 0.718526

Epoch :  18 loss training:  51.490872889757156 Time :  1191
accuracy train: 0.923230 val: 0.698507 test: 0.717536
max validation accuracy : 0.707463 max acc epoch : 14 test accuracy : 0.718526

Epoch :  19 loss training:  47.37125998735428 Time :  1209
accuracy train: 0.928524 val: 0.701493 test: 0.716300
max validation accuracy : 0.707463 max acc epoch : 14 test accuracy : 0.718526

Epoch :  20 loss training:  47.2130768597126 Time :  1227
accuracy train: 0.931171 val: 0.710448 test: 0.724215
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.724215

Epoch :  21 loss training:  45.65217074751854 Time :  1244
accuracy train: 0.935804 val: 0.704478 test: 0.721989
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.724215

Epoch :  22 loss training:  45.14723759889603 Time :  1262
accuracy train: 0.942091 val: 0.716418 test: 0.716052
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  23 loss training:  42.80844242870808 Time :  1280
accuracy train: 0.949040 val: 0.698507 test: 0.720505
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  24 loss training:  39.379455640912056 Time :  1297
accuracy train: 0.943084 val: 0.695522 test: 0.722483
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  25 loss training:  39.64714404940605 Time :  1315
accuracy train: 0.951026 val: 0.695522 test: 0.720010
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  26 loss training:  38.372508227825165 Time :  1333
accuracy train: 0.949702 val: 0.701493 test: 0.723967
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  27 loss training:  38.21790923923254 Time :  1351
accuracy train: 0.951357 val: 0.698507 test: 0.722236
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  28 loss training:  36.69169605523348 Time :  1369
accuracy train: 0.962608 val: 0.695522 test: 0.720752
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  29 loss training:  35.41338262706995 Time :  1386
accuracy train: 0.964593 val: 0.707463 test: 0.720505
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  30 loss training:  33.337277472019196 Time :  1404
accuracy train: 0.964924 val: 0.686567 test: 0.721247
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  31 loss training:  33.54639903455973 Time :  1422
accuracy train: 0.970218 val: 0.704478 test: 0.719763
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  32 loss training:  30.512222088873386 Time :  1440
accuracy train: 0.970880 val: 0.695522 test: 0.720752
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  33 loss training:  30.284929007291794 Time :  1457
accuracy train: 0.975844 val: 0.695522 test: 0.720752
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  34 loss training:  29.477340139448643 Time :  1474
accuracy train: 0.974851 val: 0.692537 test: 0.720752
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  35 loss training:  28.872498720884323 Time :  1492
accuracy train: 0.977829 val: 0.698507 test: 0.717289
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  36 loss training:  27.517994686961174 Time :  1510
accuracy train: 0.980807 val: 0.710448 test: 0.717536
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  37 loss training:  29.085104756057262 Time :  1528
accuracy train: 0.980477 val: 0.695522 test: 0.715558
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  38 loss training:  26.49833147227764 Time :  1546
accuracy train: 0.986102 val: 0.689552 test: 0.718526
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  39 loss training:  25.227984867990017 Time :  1563
accuracy train: 0.985771 val: 0.701493 test: 0.721247
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  40 loss training:  24.355822529643774 Time :  1580
accuracy train: 0.987095 val: 0.698507 test: 0.719021
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  41 loss training:  24.074219398200512 Time :  1598
accuracy train: 0.988418 val: 0.680597 test: 0.718526
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  42 loss training:  21.827464394271374 Time :  1616
accuracy train: 0.988749 val: 0.689552 test: 0.717536
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  43 loss training:  21.272959351539612 Time :  1634
accuracy train: 0.989411 val: 0.692537 test: 0.720752
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  44 loss training:  20.650385592132807 Time :  1651
accuracy train: 0.991396 val: 0.695522 test: 0.717784
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  45 loss training:  20.68169704824686 Time :  1669
accuracy train: 0.992389 val: 0.677612 test: 0.713826
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  46 loss training:  19.250768586993217 Time :  1686
accuracy train: 0.993382 val: 0.686567 test: 0.718031
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  47 loss training:  18.186127435415983 Time :  1704
accuracy train: 0.993713 val: 0.695522 test: 0.720999
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  48 loss training:  16.68150369822979 Time :  1721
accuracy train: 0.995367 val: 0.686567 test: 0.716794
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  49 loss training:  17.683100022375584 Time :  1739
accuracy train: 0.994705 val: 0.698507 test: 0.717536
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  50 loss training:  16.446119407191873 Time :  1756
accuracy train: 0.995367 val: 0.686567 test: 0.720999
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  51 loss training:  15.553930593654513 Time :  1774
accuracy train: 0.995698 val: 0.698507 test: 0.719515
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  52 loss training:  16.574133409187198 Time :  1791
accuracy train: 0.996691 val: 0.701493 test: 0.717536
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

Epoch :  53 loss training:  14.882997311651707 Time :  1809
accuracy train: 0.996029 val: 0.707463 test: 0.720257
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.716052

========================================================================================================================================================================================================
max acc epoch :  22
max validation accuracy :  0.7164179104477612
test accuracy :  0.7160524363096711
last test_accuracy :  0.7202572347266881
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=63, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  212.9986134171486 Time :  1845
accuracy train: 0.658835 val: 0.600000 test: 0.610932
max validation accuracy : 0.600000 max acc epoch : 1 test accuracy : 0.610932
Epoch-1 lr: 0.001

Epoch :  2 loss training:  146.29995530843735 Time :  1863
accuracy train: 0.711780 val: 0.638806 test: 0.656938
max validation accuracy : 0.638806 max acc epoch : 2 test accuracy : 0.656938
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.84101930260658 Time :  1880
accuracy train: 0.763071 val: 0.641791 test: 0.660153
max validation accuracy : 0.641791 max acc epoch : 3 test accuracy : 0.660153
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  99.48466527462006 Time :  1898
accuracy train: 0.803441 val: 0.680597 test: 0.691071
max validation accuracy : 0.680597 max acc epoch : 4 test accuracy : 0.691071
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  91.96663895249367 Time :  1915
accuracy train: 0.809398 val: 0.674627 test: 0.699975
max validation accuracy : 0.680597 max acc epoch : 4 test accuracy : 0.691071
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.86320042610168 Time :  1933
accuracy train: 0.818001 val: 0.668657 test: 0.691813
max validation accuracy : 0.680597 max acc epoch : 4 test accuracy : 0.691071
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  75.2947042286396 Time :  1950
accuracy train: 0.857048 val: 0.692537 test: 0.709374
max validation accuracy : 0.692537 max acc epoch : 7 test accuracy : 0.709374
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  71.36721402406693 Time :  1967
accuracy train: 0.852085 val: 0.683582 test: 0.704675
max validation accuracy : 0.692537 max acc epoch : 7 test accuracy : 0.709374
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  68.41642200946808 Time :  1985
accuracy train: 0.873925 val: 0.701493 test: 0.713826
max validation accuracy : 0.701493 max acc epoch : 9 test accuracy : 0.713826
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.824920654296875 Time :  2003
accuracy train: 0.889477 val: 0.686567 test: 0.710611
max validation accuracy : 0.701493 max acc epoch : 9 test accuracy : 0.713826
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  57.89875502884388 Time :  2021
accuracy train: 0.894441 val: 0.689552 test: 0.715805
max validation accuracy : 0.701493 max acc epoch : 9 test accuracy : 0.713826
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.59879416227341 Time :  2038
accuracy train: 0.898081 val: 0.689552 test: 0.722978
max validation accuracy : 0.701493 max acc epoch : 9 test accuracy : 0.713826
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  54.95410145819187 Time :  2055
accuracy train: 0.908670 val: 0.701493 test: 0.721494
max validation accuracy : 0.701493 max acc epoch : 9 test accuracy : 0.713826
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  54.14678297936916 Time :  2073
accuracy train: 0.907346 val: 0.710448 test: 0.721247
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.721247
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  53.49938826262951 Time :  2090
accuracy train: 0.907677 val: 0.701493 test: 0.719763
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.721247

Epoch :  16 loss training:  52.95863912254572 Time :  2108
accuracy train: 0.912310 val: 0.695522 test: 0.717289
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.721247

Epoch :  17 loss training:  52.44321581721306 Time :  2126
accuracy train: 0.921906 val: 0.689552 test: 0.720010
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.721247

Epoch :  18 loss training:  51.62597498297691 Time :  2144
accuracy train: 0.925546 val: 0.698507 test: 0.720010
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.721247

Epoch :  19 loss training:  47.3463751450181 Time :  2162
accuracy train: 0.927201 val: 0.701493 test: 0.719021
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.721247

Epoch :  20 loss training:  47.44264183193445 Time :  2180
accuracy train: 0.932495 val: 0.701493 test: 0.720257
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.721247

Epoch :  21 loss training:  45.95076563209295 Time :  2198
accuracy train: 0.936466 val: 0.692537 test: 0.720505
max validation accuracy : 0.710448 max acc epoch : 14 test accuracy : 0.721247

Epoch :  22 loss training:  45.325560830533504 Time :  2216
accuracy train: 0.938451 val: 0.713433 test: 0.717289
max validation accuracy : 0.713433 max acc epoch : 22 test accuracy : 0.717289

Epoch :  23 loss training:  42.66759268194437 Time :  2235
accuracy train: 0.945731 val: 0.692537 test: 0.721247
max validation accuracy : 0.713433 max acc epoch : 22 test accuracy : 0.717289

Epoch :  24 loss training:  39.7333350405097 Time :  2253
accuracy train: 0.939444 val: 0.701493 test: 0.718031
max validation accuracy : 0.713433 max acc epoch : 22 test accuracy : 0.717289

Epoch :  25 loss training:  39.53702102601528 Time :  2271
accuracy train: 0.951357 val: 0.695522 test: 0.720257
max validation accuracy : 0.713433 max acc epoch : 22 test accuracy : 0.717289

Epoch :  26 loss training:  38.586270943284035 Time :  2289
accuracy train: 0.952019 val: 0.689552 test: 0.725699
max validation accuracy : 0.713433 max acc epoch : 22 test accuracy : 0.717289

Epoch :  27 loss training:  38.34657767415047 Time :  2307
accuracy train: 0.952680 val: 0.686567 test: 0.725204
max validation accuracy : 0.713433 max acc epoch : 22 test accuracy : 0.717289

Epoch :  28 loss training:  36.13434424996376 Time :  2325
accuracy train: 0.959960 val: 0.692537 test: 0.722483
max validation accuracy : 0.713433 max acc epoch : 22 test accuracy : 0.717289

Epoch :  29 loss training:  35.38883228600025 Time :  2344
accuracy train: 0.963931 val: 0.704478 test: 0.717784
max validation accuracy : 0.713433 max acc epoch : 22 test accuracy : 0.717289

Epoch :  30 loss training:  32.85834151506424 Time :  2363
accuracy train: 0.965917 val: 0.704478 test: 0.724215
max validation accuracy : 0.713433 max acc epoch : 22 test accuracy : 0.717289

Epoch :  31 loss training:  33.57686152309179 Time :  2382
accuracy train: 0.969557 val: 0.701493 test: 0.722731
max validation accuracy : 0.713433 max acc epoch : 22 test accuracy : 0.717289

Epoch :  32 loss training:  30.770242914557457 Time :  2400
accuracy train: 0.971873 val: 0.689552 test: 0.721494
max validation accuracy : 0.713433 max acc epoch : 22 test accuracy : 0.717289

Epoch :  33 loss training:  30.138028118759394 Time :  2418
accuracy train: 0.976837 val: 0.692537 test: 0.719268
max validation accuracy : 0.713433 max acc epoch : 22 test accuracy : 0.717289

Epoch :  34 loss training:  29.031111896038055 Time :  2435
accuracy train: 0.977167 val: 0.695522 test: 0.721989
max validation accuracy : 0.713433 max acc epoch : 22 test accuracy : 0.717289

Epoch :  35 loss training:  28.896639220416546 Time :  2453
accuracy train: 0.977498 val: 0.692537 test: 0.718526
max validation accuracy : 0.713433 max acc epoch : 22 test accuracy : 0.717289

Epoch :  36 loss training:  27.149213783442974 Time :  2471
accuracy train: 0.982131 val: 0.716418 test: 0.716794
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  37 loss training:  28.599624942988157 Time :  2489
accuracy train: 0.982793 val: 0.698507 test: 0.720999
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  38 loss training:  26.342057690024376 Time :  2507
accuracy train: 0.987426 val: 0.692537 test: 0.716052
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  39 loss training:  24.959858790040016 Time :  2525
accuracy train: 0.985109 val: 0.695522 test: 0.720010
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  40 loss training:  23.986189853399992 Time :  2544
accuracy train: 0.987095 val: 0.695522 test: 0.718526
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  41 loss training:  24.11023723334074 Time :  2562
accuracy train: 0.988087 val: 0.698507 test: 0.718773
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  42 loss training:  22.08897316455841 Time :  2581
accuracy train: 0.990404 val: 0.695522 test: 0.718279
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  43 loss training:  21.302720688283443 Time :  2598
accuracy train: 0.989411 val: 0.692537 test: 0.719763
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  44 loss training:  20.895154640078545 Time :  2617
accuracy train: 0.991066 val: 0.698507 test: 0.720505
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  45 loss training:  20.950071830302477 Time :  2635
accuracy train: 0.992058 val: 0.683582 test: 0.718031
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  46 loss training:  18.929876167327166 Time :  2653
accuracy train: 0.993051 val: 0.698507 test: 0.719515
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  47 loss training:  17.854158211499453 Time :  2672
accuracy train: 0.994705 val: 0.695522 test: 0.719021
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  48 loss training:  16.65231215581298 Time :  2689
accuracy train: 0.995367 val: 0.683582 test: 0.716547
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  49 loss training:  17.561049338430166 Time :  2708
accuracy train: 0.995367 val: 0.695522 test: 0.718526
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  50 loss training:  16.771524485200644 Time :  2726
accuracy train: 0.994705 val: 0.686567 test: 0.722978
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  51 loss training:  15.37948951125145 Time :  2744
accuracy train: 0.996360 val: 0.698507 test: 0.720010
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  52 loss training:  16.677253330126405 Time :  2762
accuracy train: 0.996691 val: 0.695522 test: 0.720257
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  53 loss training:  15.217586759477854 Time :  2780
accuracy train: 0.995367 val: 0.695522 test: 0.720010
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  54 loss training:  15.12670892290771 Time :  2797
accuracy train: 0.996691 val: 0.707463 test: 0.718773
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  55 loss training:  13.809374960139394 Time :  2815
accuracy train: 0.998015 val: 0.686567 test: 0.719268
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  56 loss training:  12.507326480001211 Time :  2833
accuracy train: 0.997684 val: 0.704478 test: 0.717042
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  57 loss training:  12.185098128393292 Time :  2851
accuracy train: 0.999338 val: 0.686567 test: 0.716052
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  58 loss training:  12.474371138960123 Time :  2869
accuracy train: 0.999007 val: 0.692537 test: 0.718773
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  59 loss training:  11.757329486310482 Time :  2887
accuracy train: 0.998676 val: 0.689552 test: 0.714816
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  60 loss training:  11.389779299497604 Time :  2906
accuracy train: 0.998015 val: 0.695522 test: 0.718526
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  61 loss training:  9.913798434659839 Time :  2924
accuracy train: 0.997684 val: 0.698507 test: 0.719515
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  62 loss training:  10.940505503676832 Time :  2942
accuracy train: 1.000000 val: 0.680597 test: 0.722236
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  63 loss training:  10.314861498773098 Time :  2960
accuracy train: 1.000000 val: 0.689552 test: 0.720257
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  64 loss training:  11.134116923436522 Time :  2978
accuracy train: 0.999669 val: 0.686567 test: 0.721741
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  65 loss training:  9.852549893781543 Time :  2995
accuracy train: 1.000000 val: 0.689552 test: 0.721989
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  66 loss training:  9.42688224464655 Time :  3014
accuracy train: 0.999669 val: 0.686567 test: 0.718526
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

Epoch :  67 loss training:  9.345673732459545 Time :  3032
accuracy train: 0.999669 val: 0.692537 test: 0.722483
max validation accuracy : 0.716418 max acc epoch : 36 test accuracy : 0.716794

========================================================================================================================================================================================================
max acc epoch :  36
max validation accuracy :  0.7164179104477612
test accuracy :  0.7167944595597329
last test_accuracy :  0.7224833044768736
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=63, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  213.08475720882416 Time :  3065
accuracy train: 0.652548 val: 0.611940 test: 0.615879
max validation accuracy : 0.611940 max acc epoch : 1 test accuracy : 0.615879
Epoch-1 lr: 0.001

Epoch :  2 loss training:  146.149034678936 Time :  3082
accuracy train: 0.709133 val: 0.632836 test: 0.652486
max validation accuracy : 0.632836 max acc epoch : 2 test accuracy : 0.652486
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.2860817015171 Time :  3099
accuracy train: 0.763071 val: 0.647761 test: 0.665842
max validation accuracy : 0.647761 max acc epoch : 3 test accuracy : 0.665842
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  99.06778568029404 Time :  3116
accuracy train: 0.806089 val: 0.671642 test: 0.692555
max validation accuracy : 0.671642 max acc epoch : 4 test accuracy : 0.692555
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  91.2594498693943 Time :  3133
accuracy train: 0.807412 val: 0.671642 test: 0.700223
max validation accuracy : 0.671642 max acc epoch : 4 test accuracy : 0.692555
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.79352751374245 Time :  3150
accuracy train: 0.818663 val: 0.662687 test: 0.690329
max validation accuracy : 0.671642 max acc epoch : 4 test accuracy : 0.692555
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  74.78480172157288 Time :  3167
accuracy train: 0.859034 val: 0.689552 test: 0.710116
max validation accuracy : 0.689552 max acc epoch : 7 test accuracy : 0.710116
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  71.12404349446297 Time :  3185
accuracy train: 0.858041 val: 0.695522 test: 0.708138
max validation accuracy : 0.695522 max acc epoch : 8 test accuracy : 0.708138
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  67.94628065824509 Time :  3202
accuracy train: 0.874917 val: 0.716418 test: 0.709622
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.709622
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.761571913957596 Time :  3219
accuracy train: 0.891794 val: 0.695522 test: 0.713084
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.709622
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  57.773370519280434 Time :  3236
accuracy train: 0.896095 val: 0.704478 test: 0.719763
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.709622
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.54285489022732 Time :  3253
accuracy train: 0.897419 val: 0.710448 test: 0.719515
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.709622
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  54.94764161109924 Time :  3271
accuracy train: 0.910655 val: 0.716418 test: 0.723967
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.709622
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  53.96558965742588 Time :  3288
accuracy train: 0.910324 val: 0.728358 test: 0.723225
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  53.09653623402119 Time :  3305
accuracy train: 0.909662 val: 0.713433 test: 0.719268
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  16 loss training:  52.72870770096779 Time :  3323
accuracy train: 0.913964 val: 0.713433 test: 0.720752
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  17 loss training:  52.19447794556618 Time :  3341
accuracy train: 0.921906 val: 0.704478 test: 0.719515
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  18 loss training:  51.445756152272224 Time :  3359
accuracy train: 0.925877 val: 0.701493 test: 0.721494
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  19 loss training:  47.3206507191062 Time :  3376
accuracy train: 0.929186 val: 0.695522 test: 0.723720
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  20 loss training:  47.15607090294361 Time :  3394
accuracy train: 0.929848 val: 0.716418 test: 0.723225
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  21 loss training:  45.9897036254406 Time :  3412
accuracy train: 0.935804 val: 0.695522 test: 0.722236
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  22 loss training:  45.17253186553717 Time :  3430
accuracy train: 0.939113 val: 0.722388 test: 0.718773
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  23 loss training:  42.47714055329561 Time :  3448
accuracy train: 0.944408 val: 0.704478 test: 0.722731
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  24 loss training:  39.650989301502705 Time :  3466
accuracy train: 0.942422 val: 0.692537 test: 0.723225
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  25 loss training:  39.13176221400499 Time :  3484
accuracy train: 0.949702 val: 0.707463 test: 0.723225
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  26 loss training:  37.97478175908327 Time :  3502
accuracy train: 0.949702 val: 0.704478 test: 0.726193
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  27 loss training:  38.21426958590746 Time :  3520
accuracy train: 0.951357 val: 0.698507 test: 0.723473
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  28 loss training:  36.22713062167168 Time :  3538
accuracy train: 0.959298 val: 0.689552 test: 0.725699
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  29 loss training:  34.648802891373634 Time :  3556
accuracy train: 0.962608 val: 0.701493 test: 0.726441
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  30 loss training:  32.981326796114445 Time :  3574
accuracy train: 0.967571 val: 0.701493 test: 0.724709
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  31 loss training:  33.144490242004395 Time :  3592
accuracy train: 0.969887 val: 0.692537 test: 0.723967
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  32 loss training:  30.680530339479446 Time :  3610
accuracy train: 0.971873 val: 0.695522 test: 0.724957
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  33 loss training:  30.4918271638453 Time :  3628
accuracy train: 0.977167 val: 0.704478 test: 0.720752
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  34 loss training:  29.159150503575802 Time :  3645
accuracy train: 0.975844 val: 0.704478 test: 0.722236
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  35 loss training:  28.97198686748743 Time :  3662
accuracy train: 0.979484 val: 0.686567 test: 0.720752
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  36 loss training:  27.28718025237322 Time :  3680
accuracy train: 0.981138 val: 0.707463 test: 0.721741
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  37 loss training:  29.036975499242544 Time :  3697
accuracy train: 0.979815 val: 0.698507 test: 0.720010
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  38 loss training:  26.042117077857256 Time :  3714
accuracy train: 0.986433 val: 0.692537 test: 0.722236
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  39 loss training:  25.289993338286877 Time :  3732
accuracy train: 0.984447 val: 0.701493 test: 0.722236
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  40 loss training:  24.70902119576931 Time :  3749
accuracy train: 0.986764 val: 0.698507 test: 0.721741
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  41 loss training:  24.43017377704382 Time :  3767
accuracy train: 0.987426 val: 0.692537 test: 0.720010
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  42 loss training:  21.938449911773205 Time :  3786
accuracy train: 0.988418 val: 0.695522 test: 0.718279
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  43 loss training:  21.29868847504258 Time :  3804
accuracy train: 0.989742 val: 0.695522 test: 0.720010
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  44 loss training:  20.37712561711669 Time :  3822
accuracy train: 0.991066 val: 0.686567 test: 0.722236
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

Epoch :  45 loss training:  20.425066750496626 Time :  3840
accuracy train: 0.992389 val: 0.683582 test: 0.718031
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.723225

========================================================================================================================================================================================================
max acc epoch :  14
max validation accuracy :  0.7283582089552239
test accuracy :  0.7232253277269355
last test_accuracy :  0.7180311649765025
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=63, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  212.7943281531334 Time :  3873
accuracy train: 0.650893 val: 0.602985 test: 0.614395
max validation accuracy : 0.602985 max acc epoch : 1 test accuracy : 0.614395
Epoch-1 lr: 0.001

Epoch :  2 loss training:  146.40592062473297 Time :  3890
accuracy train: 0.712111 val: 0.641791 test: 0.654959
max validation accuracy : 0.641791 max acc epoch : 2 test accuracy : 0.654959
Epoch-2 lr: 0.001

Epoch :  3 loss training:  120.74171629548073 Time :  3909
accuracy train: 0.764064 val: 0.644776 test: 0.663121
max validation accuracy : 0.644776 max acc epoch : 3 test accuracy : 0.663121
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  99.32672002911568 Time :  3928
accuracy train: 0.804765 val: 0.662687 test: 0.691813
max validation accuracy : 0.662687 max acc epoch : 4 test accuracy : 0.691813
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  91.41123712062836 Time :  3946
accuracy train: 0.809729 val: 0.668657 test: 0.701707
max validation accuracy : 0.668657 max acc epoch : 5 test accuracy : 0.701707
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.5290677845478 Time :  3964
accuracy train: 0.814361 val: 0.674627 test: 0.690824
max validation accuracy : 0.674627 max acc epoch : 6 test accuracy : 0.690824
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  74.58605635166168 Time :  3981
accuracy train: 0.857048 val: 0.677612 test: 0.709869
max validation accuracy : 0.677612 max acc epoch : 7 test accuracy : 0.709869
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  70.70702436566353 Time :  3999
accuracy train: 0.854070 val: 0.677612 test: 0.703438
max validation accuracy : 0.677612 max acc epoch : 7 test accuracy : 0.709869
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  68.14114870131016 Time :  4016
accuracy train: 0.874586 val: 0.695522 test: 0.713579
max validation accuracy : 0.695522 max acc epoch : 9 test accuracy : 0.713579
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.802996069192886 Time :  4034
accuracy train: 0.892124 val: 0.701493 test: 0.712095
max validation accuracy : 0.701493 max acc epoch : 10 test accuracy : 0.712095
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  57.54106718301773 Time :  4052
accuracy train: 0.895103 val: 0.689552 test: 0.715805
max validation accuracy : 0.701493 max acc epoch : 10 test accuracy : 0.712095
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.46256247162819 Time :  4069
accuracy train: 0.895103 val: 0.701493 test: 0.717784
max validation accuracy : 0.701493 max acc epoch : 10 test accuracy : 0.712095
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  54.689124062657356 Time :  4086
accuracy train: 0.907015 val: 0.701493 test: 0.719515
max validation accuracy : 0.701493 max acc epoch : 10 test accuracy : 0.712095
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  53.82288771867752 Time :  4104
accuracy train: 0.907677 val: 0.701493 test: 0.718773
max validation accuracy : 0.701493 max acc epoch : 10 test accuracy : 0.712095
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  53.256760627031326 Time :  4122
accuracy train: 0.909001 val: 0.698507 test: 0.716547
max validation accuracy : 0.701493 max acc epoch : 10 test accuracy : 0.712095

Epoch :  16 loss training:  52.25967627763748 Time :  4140
accuracy train: 0.913633 val: 0.704478 test: 0.719021
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719021

Epoch :  17 loss training:  51.87156917154789 Time :  4158
accuracy train: 0.922568 val: 0.686567 test: 0.716300
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719021

Epoch :  18 loss training:  51.65345421433449 Time :  4176
accuracy train: 0.925546 val: 0.689552 test: 0.716300
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719021

Epoch :  19 loss training:  47.21630430966616 Time :  4194
accuracy train: 0.929186 val: 0.689552 test: 0.717042
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719021

Epoch :  20 loss training:  46.62674328684807 Time :  4212
accuracy train: 0.933157 val: 0.695522 test: 0.720257
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719021

Epoch :  21 loss training:  45.50625957548618 Time :  4230
accuracy train: 0.937790 val: 0.698507 test: 0.717784
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719021

Epoch :  22 loss training:  45.09682136029005 Time :  4248
accuracy train: 0.940437 val: 0.704478 test: 0.714816
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719021

Epoch :  23 loss training:  42.462504267692566 Time :  4265
accuracy train: 0.945731 val: 0.683582 test: 0.717289
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719021

Epoch :  24 loss training:  39.1040113940835 Time :  4283
accuracy train: 0.944408 val: 0.686567 test: 0.720010
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719021

Epoch :  25 loss training:  39.40542869269848 Time :  4301
accuracy train: 0.951357 val: 0.695522 test: 0.719268
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719021

Epoch :  26 loss training:  38.294203743338585 Time :  4319
accuracy train: 0.949040 val: 0.707463 test: 0.721741
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  27 loss training:  37.61736731976271 Time :  4336
accuracy train: 0.951688 val: 0.692537 test: 0.721741
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  28 loss training:  36.4486128538847 Time :  4355
accuracy train: 0.958637 val: 0.692537 test: 0.721989
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  29 loss training:  35.02511074393988 Time :  4372
accuracy train: 0.960622 val: 0.686567 test: 0.720752
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  30 loss training:  32.82264209538698 Time :  4390
accuracy train: 0.965917 val: 0.689552 test: 0.721494
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  31 loss training:  33.34721032530069 Time :  4408
accuracy train: 0.969887 val: 0.689552 test: 0.718773
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  32 loss training:  31.046676844358444 Time :  4427
accuracy train: 0.971542 val: 0.692537 test: 0.719763
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  33 loss training:  30.270370960235596 Time :  4445
accuracy train: 0.974851 val: 0.689552 test: 0.719515
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  34 loss training:  28.429865278303623 Time :  4463
accuracy train: 0.974189 val: 0.686567 test: 0.719515
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  35 loss training:  28.87431386858225 Time :  4480
accuracy train: 0.979153 val: 0.680597 test: 0.718279
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  36 loss training:  27.310087874531746 Time :  4498
accuracy train: 0.981800 val: 0.698507 test: 0.716794
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  37 loss training:  28.699619852006435 Time :  4516
accuracy train: 0.979815 val: 0.689552 test: 0.717784
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  38 loss training:  25.887256175279617 Time :  4534
accuracy train: 0.987095 val: 0.686567 test: 0.717289
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  39 loss training:  25.173305202275515 Time :  4551
accuracy train: 0.985440 val: 0.692537 test: 0.717784
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  40 loss training:  24.356550324708223 Time :  4570
accuracy train: 0.988087 val: 0.686567 test: 0.720505
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  41 loss training:  24.075365394353867 Time :  4588
accuracy train: 0.988418 val: 0.680597 test: 0.716794
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  42 loss training:  21.643488738685846 Time :  4605
accuracy train: 0.990404 val: 0.683582 test: 0.718031
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  43 loss training:  20.80967701599002 Time :  4623
accuracy train: 0.989411 val: 0.683582 test: 0.722483
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  44 loss training:  20.31233039498329 Time :  4641
accuracy train: 0.992389 val: 0.677612 test: 0.720010
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  45 loss training:  20.859794706106186 Time :  4659
accuracy train: 0.993051 val: 0.671642 test: 0.715558
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  46 loss training:  18.871861714869738 Time :  4678
accuracy train: 0.994044 val: 0.689552 test: 0.716547
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  47 loss training:  17.785591769963503 Time :  4696
accuracy train: 0.995367 val: 0.692537 test: 0.719268
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  48 loss training:  16.26060075685382 Time :  4714
accuracy train: 0.995367 val: 0.683582 test: 0.720752
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  49 loss training:  17.452535804361105 Time :  4732
accuracy train: 0.995698 val: 0.689552 test: 0.721247
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  50 loss training:  16.647647701203823 Time :  4750
accuracy train: 0.994705 val: 0.686567 test: 0.720752
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  51 loss training:  15.476927116513252 Time :  4768
accuracy train: 0.995367 val: 0.683582 test: 0.719268
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  52 loss training:  16.756470017135143 Time :  4786
accuracy train: 0.996029 val: 0.689552 test: 0.718031
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  53 loss training:  14.70359743013978 Time :  4804
accuracy train: 0.995698 val: 0.689552 test: 0.722236
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  54 loss training:  15.037925519049168 Time :  4822
accuracy train: 0.997353 val: 0.689552 test: 0.720010
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  55 loss training:  13.602716283872724 Time :  4840
accuracy train: 0.998015 val: 0.680597 test: 0.720505
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  56 loss training:  12.063304722309113 Time :  4857
accuracy train: 0.998015 val: 0.683582 test: 0.719763
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

Epoch :  57 loss training:  12.199059262871742 Time :  4875
accuracy train: 0.998015 val: 0.689552 test: 0.719515
max validation accuracy : 0.707463 max acc epoch : 26 test accuracy : 0.721741

========================================================================================================================================================================================================
max acc epoch :  26
max validation accuracy :  0.7074626865671642
test accuracy :  0.7217412812268118
last test_accuracy :  0.7195152114766262
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.70746 	 test_accuracy : 0.71877 	 max_acc epoch :  18 	 last test_accuracy : 0.71927
k :  1 	 val_accuracy : 0.71642 	 test_accuracy : 0.71605 	 max_acc epoch :  22 	 last test_accuracy : 0.72026
k :  2 	 val_accuracy : 0.71642 	 test_accuracy : 0.71679 	 max_acc epoch :  36 	 last test_accuracy : 0.72248
k :  3 	 val_accuracy : 0.72836 	 test_accuracy : 0.72323 	 max_acc epoch :  14 	 last test_accuracy : 0.71803
k :  4 	 val_accuracy : 0.70746 	 test_accuracy : 0.72174 	 max_acc epoch :  26 	 last test_accuracy : 0.71952

avg :  	 val_accuracy : 0.71522 	 test_accuracy : 0.71932 	 last_accuracy : 0.71991
