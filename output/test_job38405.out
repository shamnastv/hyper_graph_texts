

date and time :  Sun Jul  4 20:21:29 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=777, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  95.4122245311737 Time :  11
accuracy train: 0.773088 val: 0.770169 test: 0.765616
max validation accuracy : 0.770169 max acc epoch : 1 test accuracy : 0.765616
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.62148681282997 Time :  21
accuracy train: 0.768620 val: 0.748593 test: 0.762802
max validation accuracy : 0.770169 max acc epoch : 1 test accuracy : 0.765616
Epoch-2 lr: 0.001

Epoch :  3 loss training:  86.09747552871704 Time :  31
accuracy train: 0.789970 val: 0.785178 test: 0.771806
max validation accuracy : 0.785178 max acc epoch : 3 test accuracy : 0.771806
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  82.51708729565144 Time :  41
accuracy train: 0.796094 val: 0.784240 test: 0.782780
max validation accuracy : 0.785178 max acc epoch : 3 test accuracy : 0.771806
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.18576017022133 Time :  52
accuracy train: 0.803211 val: 0.783302 test: 0.782780
max validation accuracy : 0.785178 max acc epoch : 3 test accuracy : 0.771806
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.13467280566692 Time :  63
accuracy train: 0.802714 val: 0.784240 test: 0.777434
max validation accuracy : 0.785178 max acc epoch : 3 test accuracy : 0.771806
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  78.66921226680279 Time :  73
accuracy train: 0.810162 val: 0.789869 test: 0.780529
max validation accuracy : 0.789869 max acc epoch : 7 test accuracy : 0.780529
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.74621084332466 Time :  84
accuracy train: 0.813307 val: 0.773921 test: 0.780810
max validation accuracy : 0.789869 max acc epoch : 7 test accuracy : 0.780529
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.54142519831657 Time :  94
accuracy train: 0.813803 val: 0.769231 test: 0.784750
max validation accuracy : 0.789869 max acc epoch : 7 test accuracy : 0.780529
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  76.45640902221203 Time :  104
accuracy train: 0.815624 val: 0.769231 test: 0.781654
max validation accuracy : 0.789869 max acc epoch : 7 test accuracy : 0.780529

Epoch :  11 loss training:  75.606271058321 Time :  115
accuracy train: 0.820920 val: 0.772983 test: 0.785312
max validation accuracy : 0.789869 max acc epoch : 7 test accuracy : 0.780529

Epoch :  12 loss training:  72.51551419496536 Time :  125
accuracy train: 0.838795 val: 0.778612 test: 0.788970
max validation accuracy : 0.789869 max acc epoch : 7 test accuracy : 0.780529

Epoch :  13 loss training:  71.88819208741188 Time :  135
accuracy train: 0.845746 val: 0.784240 test: 0.786156
max validation accuracy : 0.789869 max acc epoch : 7 test accuracy : 0.780529

Epoch :  14 loss training:  70.05464786291122 Time :  145
accuracy train: 0.853525 val: 0.787054 test: 0.784468
max validation accuracy : 0.789869 max acc epoch : 7 test accuracy : 0.780529

Epoch :  15 loss training:  67.77569442987442 Time :  154
accuracy train: 0.859318 val: 0.780488 test: 0.789814
max validation accuracy : 0.789869 max acc epoch : 7 test accuracy : 0.780529

Epoch :  16 loss training:  65.1519747376442 Time :  164
accuracy train: 0.868918 val: 0.784240 test: 0.784187
max validation accuracy : 0.789869 max acc epoch : 7 test accuracy : 0.780529

Epoch :  17 loss training:  63.22723913192749 Time :  173
accuracy train: 0.876862 val: 0.782364 test: 0.785594
max validation accuracy : 0.789869 max acc epoch : 7 test accuracy : 0.780529

Epoch :  18 loss training:  62.161366522312164 Time :  184
accuracy train: 0.883482 val: 0.784240 test: 0.784468
max validation accuracy : 0.789869 max acc epoch : 7 test accuracy : 0.780529

========================================================================================================================================================================================================
best acc epoch :  7
validation accuracy :  0.7898686679174484
test accuracy :  0.7805289814293753
last test_accuracy :  0.7844682048396173
second best val :  0.7870544090056285
second best test :  0.7805289814293753
max gap 4
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=706, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  96.0854888856411 Time :  195
accuracy train: 0.773585 val: 0.755159 test: 0.761396
max validation accuracy : 0.755159 max acc epoch : 1 test accuracy : 0.761396
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.38632968068123 Time :  205
accuracy train: 0.779709 val: 0.757036 test: 0.761958
max validation accuracy : 0.757036 max acc epoch : 2 test accuracy : 0.761958
Epoch-2 lr: 0.001

Epoch :  3 loss training:  85.7257142663002 Time :  216
accuracy train: 0.790963 val: 0.742964 test: 0.767023
max validation accuracy : 0.757036 max acc epoch : 2 test accuracy : 0.761958
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  80.28309890627861 Time :  225
accuracy train: 0.803376 val: 0.773921 test: 0.782780
max validation accuracy : 0.773921 max acc epoch : 4 test accuracy : 0.782780
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.01522624492645 Time :  235
accuracy train: 0.808011 val: 0.773921 test: 0.778278
max validation accuracy : 0.773921 max acc epoch : 4 test accuracy : 0.782780
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.1571287214756 Time :  245
accuracy train: 0.809169 val: 0.763602 test: 0.778559
max validation accuracy : 0.773921 max acc epoch : 4 test accuracy : 0.782780
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  76.75372532010078 Time :  254
accuracy train: 0.815293 val: 0.772045 test: 0.779685
max validation accuracy : 0.773921 max acc epoch : 4 test accuracy : 0.782780
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.66713592410088 Time :  264
accuracy train: 0.818769 val: 0.768293 test: 0.776590
max validation accuracy : 0.773921 max acc epoch : 4 test accuracy : 0.782780
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.32104128599167 Time :  274
accuracy train: 0.819100 val: 0.770169 test: 0.778841
max validation accuracy : 0.773921 max acc epoch : 4 test accuracy : 0.782780
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  74.94321429729462 Time :  283
accuracy train: 0.821582 val: 0.770169 test: 0.780810
max validation accuracy : 0.773921 max acc epoch : 4 test accuracy : 0.782780

Epoch :  11 loss training:  74.5971993803978 Time :  293
accuracy train: 0.830354 val: 0.773921 test: 0.780529
max validation accuracy : 0.773921 max acc epoch : 4 test accuracy : 0.782780

Epoch :  12 loss training:  72.6635564416647 Time :  303
accuracy train: 0.838630 val: 0.766417 test: 0.780529
max validation accuracy : 0.773921 max acc epoch : 4 test accuracy : 0.782780

Epoch :  13 loss training:  70.22386226058006 Time :  314
accuracy train: 0.845250 val: 0.776735 test: 0.784187
max validation accuracy : 0.776735 max acc epoch : 13 test accuracy : 0.784187

Epoch :  14 loss training:  67.54020428657532 Time :  324
accuracy train: 0.853360 val: 0.777674 test: 0.781936
max validation accuracy : 0.777674 max acc epoch : 14 test accuracy : 0.781936

Epoch :  15 loss training:  66.96602402627468 Time :  334
accuracy train: 0.864449 val: 0.779550 test: 0.785031
max validation accuracy : 0.779550 max acc epoch : 15 test accuracy : 0.785031

Epoch :  16 loss training:  65.40712788701057 Time :  344
accuracy train: 0.869745 val: 0.782364 test: 0.786719
max validation accuracy : 0.782364 max acc epoch : 16 test accuracy : 0.786719

Epoch :  17 loss training:  62.391164019703865 Time :  354
accuracy train: 0.876365 val: 0.788931 test: 0.788126
max validation accuracy : 0.788931 max acc epoch : 17 test accuracy : 0.788126

Epoch :  18 loss training:  60.93148398399353 Time :  364
accuracy train: 0.885799 val: 0.790807 test: 0.787845
max validation accuracy : 0.790807 max acc epoch : 18 test accuracy : 0.787845

Epoch :  19 loss training:  58.18198911845684 Time :  374
accuracy train: 0.895399 val: 0.781426 test: 0.787845
max validation accuracy : 0.790807 max acc epoch : 18 test accuracy : 0.787845

Epoch :  20 loss training:  56.549833945930004 Time :  384
accuracy train: 0.902681 val: 0.787992 test: 0.788407
max validation accuracy : 0.790807 max acc epoch : 18 test accuracy : 0.787845

Epoch :  21 loss training:  55.13725309073925 Time :  394
accuracy train: 0.913274 val: 0.782364 test: 0.790940
max validation accuracy : 0.790807 max acc epoch : 18 test accuracy : 0.787845

Epoch :  22 loss training:  53.458877101540565 Time :  404
accuracy train: 0.917411 val: 0.783302 test: 0.785594
max validation accuracy : 0.790807 max acc epoch : 18 test accuracy : 0.787845

Epoch :  23 loss training:  50.28157053887844 Time :  414
accuracy train: 0.923535 val: 0.787992 test: 0.784468
max validation accuracy : 0.790807 max acc epoch : 18 test accuracy : 0.787845

Epoch :  24 loss training:  48.965065106749535 Time :  424
accuracy train: 0.925190 val: 0.784240 test: 0.780810
max validation accuracy : 0.790807 max acc epoch : 18 test accuracy : 0.787845

Epoch :  25 loss training:  48.058943659067154 Time :  434
accuracy train: 0.935121 val: 0.786116 test: 0.785312
max validation accuracy : 0.790807 max acc epoch : 18 test accuracy : 0.787845

Epoch :  26 loss training:  46.25361655652523 Time :  444
accuracy train: 0.940417 val: 0.786116 test: 0.782780
max validation accuracy : 0.790807 max acc epoch : 18 test accuracy : 0.787845

Epoch :  27 loss training:  44.13600319623947 Time :  453
accuracy train: 0.946210 val: 0.787054 test: 0.781936
max validation accuracy : 0.790807 max acc epoch : 18 test accuracy : 0.787845

Epoch :  28 loss training:  42.8093826174736 Time :  463
accuracy train: 0.953492 val: 0.787992 test: 0.783061
max validation accuracy : 0.790807 max acc epoch : 18 test accuracy : 0.787845

Epoch :  29 loss training:  40.134892240166664 Time :  473
accuracy train: 0.957299 val: 0.783302 test: 0.781373
max validation accuracy : 0.790807 max acc epoch : 18 test accuracy : 0.787845

========================================================================================================================================================================================================
best acc epoch :  18
validation accuracy :  0.7908067542213884
test accuracy :  0.7878446820483962
last test_accuracy :  0.7813731007315701
second best val :  0.7889305816135085
second best test :  0.7881260551491277
max gap 9
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=741, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  97.97618651390076 Time :  484
accuracy train: 0.766799 val: 0.750469 test: 0.762240
max validation accuracy : 0.750469 max acc epoch : 1 test accuracy : 0.762240
Epoch-1 lr: 0.001

Epoch :  2 loss training:  88.29166033864021 Time :  495
accuracy train: 0.778881 val: 0.750469 test: 0.760833
max validation accuracy : 0.750469 max acc epoch : 1 test accuracy : 0.762240
Epoch-2 lr: 0.001

Epoch :  3 loss training:  86.92683658003807 Time :  505
accuracy train: 0.788646 val: 0.763602 test: 0.770962
max validation accuracy : 0.763602 max acc epoch : 3 test accuracy : 0.770962
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  79.97814670205116 Time :  514
accuracy train: 0.798908 val: 0.757036 test: 0.772369
max validation accuracy : 0.763602 max acc epoch : 3 test accuracy : 0.770962
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.97598266601562 Time :  525
accuracy train: 0.802052 val: 0.765478 test: 0.779122
max validation accuracy : 0.765478 max acc epoch : 5 test accuracy : 0.779122
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.15726190805435 Time :  534
accuracy train: 0.810659 val: 0.771107 test: 0.782780
max validation accuracy : 0.771107 max acc epoch : 6 test accuracy : 0.782780
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.34454667568207 Time :  545
accuracy train: 0.815789 val: 0.769231 test: 0.777434
max validation accuracy : 0.771107 max acc epoch : 6 test accuracy : 0.782780
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.66579721868038 Time :  554
accuracy train: 0.812645 val: 0.771107 test: 0.775746
max validation accuracy : 0.771107 max acc epoch : 6 test accuracy : 0.782780
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.97733649611473 Time :  564
accuracy train: 0.815127 val: 0.767355 test: 0.780248
max validation accuracy : 0.771107 max acc epoch : 6 test accuracy : 0.782780
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  74.5774941444397 Time :  574
accuracy train: 0.827210 val: 0.776735 test: 0.781092
max validation accuracy : 0.776735 max acc epoch : 10 test accuracy : 0.781092

Epoch :  11 loss training:  74.70841084420681 Time :  583
accuracy train: 0.829858 val: 0.779550 test: 0.784750
max validation accuracy : 0.779550 max acc epoch : 11 test accuracy : 0.784750

Epoch :  12 loss training:  72.61164136230946 Time :  593
accuracy train: 0.844422 val: 0.780488 test: 0.780810
max validation accuracy : 0.780488 max acc epoch : 12 test accuracy : 0.780810

Epoch :  13 loss training:  71.45150327682495 Time :  604
accuracy train: 0.854187 val: 0.783302 test: 0.789814
max validation accuracy : 0.783302 max acc epoch : 13 test accuracy : 0.789814

Epoch :  14 loss training:  68.61463870108128 Time :  614
accuracy train: 0.858160 val: 0.781426 test: 0.778841
max validation accuracy : 0.783302 max acc epoch : 13 test accuracy : 0.789814

Epoch :  15 loss training:  67.54854522645473 Time :  624
accuracy train: 0.866931 val: 0.787992 test: 0.788689
max validation accuracy : 0.787992 max acc epoch : 15 test accuracy : 0.788689

Epoch :  16 loss training:  64.65567949414253 Time :  635
accuracy train: 0.875207 val: 0.788931 test: 0.787845
max validation accuracy : 0.788931 max acc epoch : 16 test accuracy : 0.787845

Epoch :  17 loss training:  64.44619916379452 Time :  645
accuracy train: 0.883979 val: 0.785178 test: 0.790940
max validation accuracy : 0.788931 max acc epoch : 16 test accuracy : 0.787845

Epoch :  18 loss training:  62.5573391020298 Time :  655
accuracy train: 0.893578 val: 0.781426 test: 0.793472
max validation accuracy : 0.788931 max acc epoch : 16 test accuracy : 0.787845

Epoch :  19 loss training:  59.679135128855705 Time :  666
accuracy train: 0.898047 val: 0.783302 test: 0.789252
max validation accuracy : 0.788931 max acc epoch : 16 test accuracy : 0.787845

Epoch :  20 loss training:  56.96009562909603 Time :  675
accuracy train: 0.905164 val: 0.779550 test: 0.790096
max validation accuracy : 0.788931 max acc epoch : 16 test accuracy : 0.787845

Epoch :  21 loss training:  55.71673126518726 Time :  685
accuracy train: 0.913605 val: 0.783302 test: 0.788407
max validation accuracy : 0.788931 max acc epoch : 16 test accuracy : 0.787845

Epoch :  22 loss training:  53.252039059996605 Time :  695
accuracy train: 0.916253 val: 0.783302 test: 0.790377
max validation accuracy : 0.788931 max acc epoch : 16 test accuracy : 0.787845

Epoch :  23 loss training:  50.389050990343094 Time :  706
accuracy train: 0.923039 val: 0.778612 test: 0.788126
max validation accuracy : 0.788931 max acc epoch : 16 test accuracy : 0.787845

Epoch :  24 loss training:  49.419578947126865 Time :  717
accuracy train: 0.935452 val: 0.769231 test: 0.783061
max validation accuracy : 0.788931 max acc epoch : 16 test accuracy : 0.787845

Epoch :  25 loss training:  47.52885993570089 Time :  727
accuracy train: 0.940086 val: 0.776735 test: 0.779403
max validation accuracy : 0.788931 max acc epoch : 16 test accuracy : 0.787845

Epoch :  26 loss training:  45.14086999744177 Time :  737
accuracy train: 0.945382 val: 0.786116 test: 0.788689
max validation accuracy : 0.788931 max acc epoch : 16 test accuracy : 0.787845

Epoch :  27 loss training:  44.77973307669163 Time :  748
accuracy train: 0.952499 val: 0.780488 test: 0.786438
max validation accuracy : 0.788931 max acc epoch : 16 test accuracy : 0.787845

========================================================================================================================================================================================================
best acc epoch :  16
validation accuracy :  0.7889305816135085
test accuracy :  0.7878446820483962
last test_accuracy :  0.7864378165447383
second best val :  0.7879924953095685
second best test :  0.7886888013505908
max gap 4
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=525, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  96.87879267334938 Time :  759
accuracy train: 0.744455 val: 0.756098 test: 0.742825
max validation accuracy : 0.756098 max acc epoch : 1 test accuracy : 0.742825
Epoch-1 lr: 0.001

Epoch :  2 loss training:  90.93532738089561 Time :  769
accuracy train: 0.779709 val: 0.766417 test: 0.771806
max validation accuracy : 0.766417 max acc epoch : 2 test accuracy : 0.771806
Epoch-2 lr: 0.001

Epoch :  3 loss training:  85.79305750131607 Time :  780
accuracy train: 0.787984 val: 0.762664 test: 0.772369
max validation accuracy : 0.766417 max acc epoch : 2 test accuracy : 0.771806
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  80.53397671878338 Time :  790
accuracy train: 0.790963 val: 0.777674 test: 0.774339
max validation accuracy : 0.777674 max acc epoch : 4 test accuracy : 0.774339
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.87307035923004 Time :  800
accuracy train: 0.795432 val: 0.789869 test: 0.771244
max validation accuracy : 0.789869 max acc epoch : 5 test accuracy : 0.771244
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.74877759814262 Time :  810
accuracy train: 0.811155 val: 0.762664 test: 0.776871
max validation accuracy : 0.789869 max acc epoch : 5 test accuracy : 0.771244
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.50566613674164 Time :  820
accuracy train: 0.807183 val: 0.769231 test: 0.776590
max validation accuracy : 0.789869 max acc epoch : 5 test accuracy : 0.771244
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  77.71015074849129 Time :  830
accuracy train: 0.817610 val: 0.765478 test: 0.781654
max validation accuracy : 0.789869 max acc epoch : 5 test accuracy : 0.771244
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.88553389906883 Time :  840
accuracy train: 0.820093 val: 0.769231 test: 0.780810
max validation accuracy : 0.789869 max acc epoch : 5 test accuracy : 0.771244
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.09796085953712 Time :  850
accuracy train: 0.819431 val: 0.772983 test: 0.777715
max validation accuracy : 0.789869 max acc epoch : 5 test accuracy : 0.771244

Epoch :  11 loss training:  74.54569627344608 Time :  860
accuracy train: 0.826548 val: 0.772983 test: 0.777434
max validation accuracy : 0.789869 max acc epoch : 5 test accuracy : 0.771244

Epoch :  12 loss training:  73.21739445626736 Time :  870
accuracy train: 0.835981 val: 0.772983 test: 0.781654
max validation accuracy : 0.789869 max acc epoch : 5 test accuracy : 0.771244

Epoch :  13 loss training:  70.6659497320652 Time :  880
accuracy train: 0.842933 val: 0.772045 test: 0.784468
max validation accuracy : 0.789869 max acc epoch : 5 test accuracy : 0.771244

Epoch :  14 loss training:  69.41007660329342 Time :  890
accuracy train: 0.852201 val: 0.776735 test: 0.781092
max validation accuracy : 0.789869 max acc epoch : 5 test accuracy : 0.771244

Epoch :  15 loss training:  67.37910175323486 Time :  900
accuracy train: 0.854849 val: 0.784240 test: 0.780529
max validation accuracy : 0.789869 max acc epoch : 5 test accuracy : 0.771244

Epoch :  16 loss training:  66.07487297058105 Time :  909
accuracy train: 0.868587 val: 0.786116 test: 0.780248
max validation accuracy : 0.789869 max acc epoch : 5 test accuracy : 0.771244

========================================================================================================================================================================================================
best acc epoch :  5
validation accuracy :  0.7898686679174484
test accuracy :  0.7712436691052336
last test_accuracy :  0.7802476083286438
second best val :  0.7861163227016885
second best test :  0.7712436691052336
max gap 2
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  7 	 val_accuracy : 0.78987 	 test_accuracy : 0.78053 	 last test_accuracy : 0.78447 	 second best val : 0.78705 	 second best test : 0.78053
k :  1 	 best_acc epoch :  18 	 val_accuracy : 0.79081 	 test_accuracy : 0.78784 	 last test_accuracy : 0.78137 	 second best val : 0.78893 	 second best test : 0.78813
k :  2 	 best_acc epoch :  16 	 val_accuracy : 0.78893 	 test_accuracy : 0.78784 	 last test_accuracy : 0.78644 	 second best val : 0.78799 	 second best test : 0.78869
k :  3 	 best_acc epoch :  5 	 val_accuracy : 0.78987 	 test_accuracy : 0.77124 	 last test_accuracy : 0.78025 	 second best val : 0.78612 	 second best test : 0.77124

avg :  	 val_accuracy : 0.78987 	 test_accuracy : 0.78187 	 last_accuracy : 0.78313 	 second best val : 0.78752 	 second best test : 0.78215

std :  	 val_accuracy : 0.00066 	 test_accuracy : 0.00682 	 last_accuracy : 0.00246 	 second best val : 0.00105 	 second best test : 0.00707


date and time :  Sun Jul  4 20:36:47 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=169, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  97.14653414487839 Time :  10
accuracy train: 0.767296 val: 0.742964 test: 0.746764
max validation accuracy : 0.742964 max acc epoch : 1 test accuracy : 0.746764
Epoch-1 lr: 0.001

Epoch :  2 loss training:  86.74546113610268 Time :  20
accuracy train: 0.786660 val: 0.749531 test: 0.761396
max validation accuracy : 0.749531 max acc epoch : 2 test accuracy : 0.761396
Epoch-2 lr: 0.001

Epoch :  3 loss training:  84.90943412482738 Time :  29
accuracy train: 0.790136 val: 0.749531 test: 0.776308
max validation accuracy : 0.749531 max acc epoch : 2 test accuracy : 0.761396
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.52822002768517 Time :  39
accuracy train: 0.787157 val: 0.745779 test: 0.769555
max validation accuracy : 0.749531 max acc epoch : 2 test accuracy : 0.761396
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.72260774672031 Time :  50
accuracy train: 0.799901 val: 0.770169 test: 0.774902
max validation accuracy : 0.770169 max acc epoch : 5 test accuracy : 0.774902
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.9874718785286 Time :  59
accuracy train: 0.803542 val: 0.771107 test: 0.780248
max validation accuracy : 0.771107 max acc epoch : 6 test accuracy : 0.780248
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  78.16358581185341 Time :  70
accuracy train: 0.806356 val: 0.763602 test: 0.783343
max validation accuracy : 0.771107 max acc epoch : 6 test accuracy : 0.780248
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  77.19800335168839 Time :  80
accuracy train: 0.807845 val: 0.761726 test: 0.780810
max validation accuracy : 0.771107 max acc epoch : 6 test accuracy : 0.780248
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.50274150073528 Time :  91
accuracy train: 0.810493 val: 0.759850 test: 0.781092
max validation accuracy : 0.771107 max acc epoch : 6 test accuracy : 0.780248
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.80858582258224 Time :  101
accuracy train: 0.811817 val: 0.761726 test: 0.781092
max validation accuracy : 0.771107 max acc epoch : 6 test accuracy : 0.780248

Epoch :  11 loss training:  75.67471554875374 Time :  112
accuracy train: 0.819927 val: 0.772045 test: 0.783905
max validation accuracy : 0.772045 max acc epoch : 11 test accuracy : 0.783905

Epoch :  12 loss training:  73.39012098312378 Time :  121
accuracy train: 0.823568 val: 0.770169 test: 0.780248
max validation accuracy : 0.772045 max acc epoch : 11 test accuracy : 0.783905

Epoch :  13 loss training:  71.89996314048767 Time :  132
accuracy train: 0.833995 val: 0.766417 test: 0.781654
max validation accuracy : 0.772045 max acc epoch : 11 test accuracy : 0.783905

Epoch :  14 loss training:  70.36545123159885 Time :  142
accuracy train: 0.842436 val: 0.768293 test: 0.783624
max validation accuracy : 0.772045 max acc epoch : 11 test accuracy : 0.783905

Epoch :  15 loss training:  68.28252057731152 Time :  152
accuracy train: 0.851870 val: 0.776735 test: 0.781936
max validation accuracy : 0.776735 max acc epoch : 15 test accuracy : 0.781936

Epoch :  16 loss training:  66.92590197920799 Time :  162
accuracy train: 0.865442 val: 0.779550 test: 0.779403
max validation accuracy : 0.779550 max acc epoch : 16 test accuracy : 0.779403

Epoch :  17 loss training:  64.78271965682507 Time :  172
accuracy train: 0.862794 val: 0.770169 test: 0.781373
max validation accuracy : 0.779550 max acc epoch : 16 test accuracy : 0.779403

Epoch :  18 loss training:  60.52346621453762 Time :  181
accuracy train: 0.878021 val: 0.776735 test: 0.783905
max validation accuracy : 0.779550 max acc epoch : 16 test accuracy : 0.779403

Epoch :  19 loss training:  59.113913387060165 Time :  192
accuracy train: 0.885468 val: 0.779550 test: 0.782780
max validation accuracy : 0.779550 max acc epoch : 16 test accuracy : 0.779403

Epoch :  20 loss training:  57.79101911187172 Time :  202
accuracy train: 0.892585 val: 0.777674 test: 0.785312
max validation accuracy : 0.779550 max acc epoch : 16 test accuracy : 0.779403

Epoch :  21 loss training:  57.32103356719017 Time :  213
accuracy train: 0.899206 val: 0.776735 test: 0.783343
max validation accuracy : 0.779550 max acc epoch : 16 test accuracy : 0.779403

Epoch :  22 loss training:  54.71163748204708 Time :  223
accuracy train: 0.910957 val: 0.774859 test: 0.785312
max validation accuracy : 0.779550 max acc epoch : 16 test accuracy : 0.779403

Epoch :  23 loss training:  53.16501021385193 Time :  233
accuracy train: 0.915094 val: 0.775797 test: 0.782217
max validation accuracy : 0.779550 max acc epoch : 16 test accuracy : 0.779403

Epoch :  24 loss training:  49.83949975669384 Time :  244
accuracy train: 0.919398 val: 0.771107 test: 0.787001
max validation accuracy : 0.779550 max acc epoch : 16 test accuracy : 0.779403

Epoch :  25 loss training:  49.95470778644085 Time :  254
accuracy train: 0.928666 val: 0.772983 test: 0.780529
max validation accuracy : 0.779550 max acc epoch : 16 test accuracy : 0.779403

Epoch :  26 loss training:  45.2133526802063 Time :  264
accuracy train: 0.929990 val: 0.773921 test: 0.783905
max validation accuracy : 0.779550 max acc epoch : 16 test accuracy : 0.779403

Epoch :  27 loss training:  45.46704587340355 Time :  274
accuracy train: 0.938431 val: 0.776735 test: 0.784468
max validation accuracy : 0.779550 max acc epoch : 16 test accuracy : 0.779403

========================================================================================================================================================================================================
best acc epoch :  16
validation accuracy :  0.7795497185741088
test accuracy :  0.7794034890264491
last test_accuracy :  0.7844682048396173
second best val :  0.7776735459662288
second best test :  0.7794034890264491
max gap 5
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=645, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  95.91238296031952 Time :  285
accuracy train: 0.764316 val: 0.743902 test: 0.754361
max validation accuracy : 0.743902 max acc epoch : 1 test accuracy : 0.754361
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.6505177617073 Time :  295
accuracy train: 0.738828 val: 0.694184 test: 0.723129
max validation accuracy : 0.743902 max acc epoch : 1 test accuracy : 0.754361
Epoch-2 lr: 0.001

Epoch :  3 loss training:  85.55512487888336 Time :  305
accuracy train: 0.754717 val: 0.712946 test: 0.733821
max validation accuracy : 0.743902 max acc epoch : 1 test accuracy : 0.754361
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  82.20826733112335 Time :  315
accuracy train: 0.797253 val: 0.765478 test: 0.773495
max validation accuracy : 0.765478 max acc epoch : 4 test accuracy : 0.773495
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  81.72198851406574 Time :  325
accuracy train: 0.802880 val: 0.764540 test: 0.780248
max validation accuracy : 0.765478 max acc epoch : 4 test accuracy : 0.773495
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.69672319293022 Time :  335
accuracy train: 0.803211 val: 0.764540 test: 0.774339
max validation accuracy : 0.765478 max acc epoch : 4 test accuracy : 0.773495
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  76.99744606018066 Time :  345
accuracy train: 0.808176 val: 0.767355 test: 0.779403
max validation accuracy : 0.767355 max acc epoch : 7 test accuracy : 0.779403
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.2473771572113 Time :  355
accuracy train: 0.814134 val: 0.765478 test: 0.778841
max validation accuracy : 0.767355 max acc epoch : 7 test accuracy : 0.779403
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.19082543253899 Time :  364
accuracy train: 0.812479 val: 0.755159 test: 0.778278
max validation accuracy : 0.767355 max acc epoch : 7 test accuracy : 0.779403
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  74.56416961550713 Time :  375
accuracy train: 0.817114 val: 0.768293 test: 0.781373
max validation accuracy : 0.768293 max acc epoch : 10 test accuracy : 0.781373

Epoch :  11 loss training:  74.93843166530132 Time :  385
accuracy train: 0.823734 val: 0.773921 test: 0.781654
max validation accuracy : 0.773921 max acc epoch : 11 test accuracy : 0.781654

Epoch :  12 loss training:  71.84807269275188 Time :  394
accuracy train: 0.834657 val: 0.772983 test: 0.781373
max validation accuracy : 0.773921 max acc epoch : 11 test accuracy : 0.781654

Epoch :  13 loss training:  72.04102815687656 Time :  405
accuracy train: 0.847236 val: 0.777674 test: 0.780810
max validation accuracy : 0.777674 max acc epoch : 13 test accuracy : 0.780810

Epoch :  14 loss training:  69.80878940224648 Time :  415
accuracy train: 0.854187 val: 0.773921 test: 0.781092
max validation accuracy : 0.777674 max acc epoch : 13 test accuracy : 0.780810

Epoch :  15 loss training:  69.12249433994293 Time :  425
accuracy train: 0.859318 val: 0.769231 test: 0.782499
max validation accuracy : 0.777674 max acc epoch : 13 test accuracy : 0.780810

Epoch :  16 loss training:  65.76012608408928 Time :  436
accuracy train: 0.865276 val: 0.766417 test: 0.784750
max validation accuracy : 0.777674 max acc epoch : 13 test accuracy : 0.780810

Epoch :  17 loss training:  63.79097083210945 Time :  447
accuracy train: 0.874048 val: 0.776735 test: 0.785031
max validation accuracy : 0.777674 max acc epoch : 13 test accuracy : 0.780810

Epoch :  18 loss training:  62.21397256851196 Time :  457
accuracy train: 0.878352 val: 0.768293 test: 0.784468
max validation accuracy : 0.777674 max acc epoch : 13 test accuracy : 0.780810

Epoch :  19 loss training:  59.80232936143875 Time :  468
accuracy train: 0.887123 val: 0.771107 test: 0.786719
max validation accuracy : 0.777674 max acc epoch : 13 test accuracy : 0.780810

Epoch :  20 loss training:  57.95332183688879 Time :  478
accuracy train: 0.894737 val: 0.768293 test: 0.786156
max validation accuracy : 0.777674 max acc epoch : 13 test accuracy : 0.780810

Epoch :  21 loss training:  55.53777840733528 Time :  489
accuracy train: 0.902681 val: 0.773921 test: 0.785031
max validation accuracy : 0.777674 max acc epoch : 13 test accuracy : 0.780810

Epoch :  22 loss training:  54.858308136463165 Time :  499
accuracy train: 0.905991 val: 0.770169 test: 0.786438
max validation accuracy : 0.777674 max acc epoch : 13 test accuracy : 0.780810

Epoch :  23 loss training:  51.88821265101433 Time :  509
accuracy train: 0.915260 val: 0.769231 test: 0.784468
max validation accuracy : 0.777674 max acc epoch : 13 test accuracy : 0.780810

Epoch :  24 loss training:  51.63974179327488 Time :  519
accuracy train: 0.917742 val: 0.768293 test: 0.788407
max validation accuracy : 0.777674 max acc epoch : 13 test accuracy : 0.780810

========================================================================================================================================================================================================
best acc epoch :  13
validation accuracy :  0.7776735459662288
test accuracy :  0.7808103545301069
last test_accuracy :  0.7884074282498593
second best val :  0.776735459662289
second best test :  0.7808103545301069
max gap 3
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=923, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  97.86982709169388 Time :  531
accuracy train: 0.766468 val: 0.774859 test: 0.765898
max validation accuracy : 0.774859 max acc epoch : 1 test accuracy : 0.765898
Epoch-1 lr: 0.001

Epoch :  2 loss training:  88.15316197276115 Time :  541
accuracy train: 0.772426 val: 0.757036 test: 0.759426
max validation accuracy : 0.774859 max acc epoch : 1 test accuracy : 0.765898
Epoch-2 lr: 0.001

Epoch :  3 loss training:  85.11126354336739 Time :  551
accuracy train: 0.791129 val: 0.753283 test: 0.768711
max validation accuracy : 0.774859 max acc epoch : 1 test accuracy : 0.765898
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  80.81561750173569 Time :  561
accuracy train: 0.790798 val: 0.757036 test: 0.772088
max validation accuracy : 0.774859 max acc epoch : 1 test accuracy : 0.765898
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.70590171217918 Time :  571
accuracy train: 0.794273 val: 0.767355 test: 0.774902
max validation accuracy : 0.774859 max acc epoch : 1 test accuracy : 0.765898
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.65938782691956 Time :  581
accuracy train: 0.798411 val: 0.781426 test: 0.776590
max validation accuracy : 0.781426 max acc epoch : 6 test accuracy : 0.776590
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  78.62772130966187 Time :  591
accuracy train: 0.802549 val: 0.773921 test: 0.777153
max validation accuracy : 0.781426 max acc epoch : 6 test accuracy : 0.776590
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.90138748288155 Time :  601
accuracy train: 0.810990 val: 0.780488 test: 0.785031
max validation accuracy : 0.781426 max acc epoch : 6 test accuracy : 0.776590
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  77.52207925915718 Time :  611
accuracy train: 0.816452 val: 0.781426 test: 0.785031
max validation accuracy : 0.781426 max acc epoch : 6 test accuracy : 0.776590
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  76.23874342441559 Time :  621
accuracy train: 0.812645 val: 0.779550 test: 0.782499
max validation accuracy : 0.781426 max acc epoch : 6 test accuracy : 0.776590

Epoch :  11 loss training:  75.70293679833412 Time :  631
accuracy train: 0.822575 val: 0.783302 test: 0.784468
max validation accuracy : 0.783302 max acc epoch : 11 test accuracy : 0.784468

Epoch :  12 loss training:  75.0183699131012 Time :  642
accuracy train: 0.829030 val: 0.775797 test: 0.778278
max validation accuracy : 0.783302 max acc epoch : 11 test accuracy : 0.784468

Epoch :  13 loss training:  71.40242509543896 Time :  652
accuracy train: 0.833664 val: 0.779550 test: 0.780529
max validation accuracy : 0.783302 max acc epoch : 11 test accuracy : 0.784468

Epoch :  14 loss training:  71.04965633153915 Time :  663
accuracy train: 0.849057 val: 0.789869 test: 0.781373
max validation accuracy : 0.789869 max acc epoch : 14 test accuracy : 0.781373

Epoch :  15 loss training:  67.99973078072071 Time :  673
accuracy train: 0.852532 val: 0.789869 test: 0.783343
max validation accuracy : 0.789869 max acc epoch : 14 test accuracy : 0.781373

Epoch :  16 loss training:  67.72547999024391 Time :  683
accuracy train: 0.854518 val: 0.790807 test: 0.784750
max validation accuracy : 0.790807 max acc epoch : 16 test accuracy : 0.784750

Epoch :  17 loss training:  64.57413199543953 Time :  693
accuracy train: 0.867925 val: 0.800188 test: 0.792909
max validation accuracy : 0.800188 max acc epoch : 17 test accuracy : 0.792909

Epoch :  18 loss training:  63.44592182338238 Time :  703
accuracy train: 0.874379 val: 0.797373 test: 0.790377
max validation accuracy : 0.800188 max acc epoch : 17 test accuracy : 0.792909

Epoch :  19 loss training:  60.76508803665638 Time :  713
accuracy train: 0.884641 val: 0.795497 test: 0.785875
max validation accuracy : 0.800188 max acc epoch : 17 test accuracy : 0.792909

Epoch :  20 loss training:  59.33217456936836 Time :  723
accuracy train: 0.890930 val: 0.796435 test: 0.790096
max validation accuracy : 0.800188 max acc epoch : 17 test accuracy : 0.792909

Epoch :  21 loss training:  56.494850501418114 Time :  733
accuracy train: 0.896723 val: 0.799250 test: 0.788970
max validation accuracy : 0.800188 max acc epoch : 17 test accuracy : 0.792909

Epoch :  22 loss training:  54.81763434410095 Time :  743
accuracy train: 0.909302 val: 0.800188 test: 0.791784
max validation accuracy : 0.800188 max acc epoch : 17 test accuracy : 0.792909

Epoch :  23 loss training:  52.08192004263401 Time :  754
accuracy train: 0.912943 val: 0.804878 test: 0.787563
max validation accuracy : 0.804878 max acc epoch : 23 test accuracy : 0.787563

Epoch :  24 loss training:  50.535449758172035 Time :  764
accuracy train: 0.918405 val: 0.796435 test: 0.788970
max validation accuracy : 0.804878 max acc epoch : 23 test accuracy : 0.787563

Epoch :  25 loss training:  49.516788855195045 Time :  774
accuracy train: 0.929328 val: 0.794559 test: 0.790658
max validation accuracy : 0.804878 max acc epoch : 23 test accuracy : 0.787563

Epoch :  26 loss training:  46.43811512738466 Time :  784
accuracy train: 0.933300 val: 0.798311 test: 0.789814
max validation accuracy : 0.804878 max acc epoch : 23 test accuracy : 0.787563

Epoch :  27 loss training:  46.30999832600355 Time :  795
accuracy train: 0.942238 val: 0.804878 test: 0.790658
max validation accuracy : 0.804878 max acc epoch : 23 test accuracy : 0.787563

Epoch :  28 loss training:  43.30053901672363 Time :  805
accuracy train: 0.943727 val: 0.792683 test: 0.785875
max validation accuracy : 0.804878 max acc epoch : 23 test accuracy : 0.787563

Epoch :  29 loss training:  42.13743793964386 Time :  816
accuracy train: 0.950844 val: 0.799250 test: 0.789533
max validation accuracy : 0.804878 max acc epoch : 23 test accuracy : 0.787563

Epoch :  30 loss training:  39.17930271476507 Time :  826
accuracy train: 0.954982 val: 0.803940 test: 0.785875
max validation accuracy : 0.804878 max acc epoch : 23 test accuracy : 0.787563

Epoch :  31 loss training:  37.97469376027584 Time :  836
accuracy train: 0.961271 val: 0.793621 test: 0.785594
max validation accuracy : 0.804878 max acc epoch : 23 test accuracy : 0.787563

Epoch :  32 loss training:  36.674236454069614 Time :  846
accuracy train: 0.961437 val: 0.795497 test: 0.782499
max validation accuracy : 0.804878 max acc epoch : 23 test accuracy : 0.787563

Epoch :  33 loss training:  35.12001181021333 Time :  856
accuracy train: 0.960940 val: 0.796435 test: 0.788126
max validation accuracy : 0.804878 max acc epoch : 23 test accuracy : 0.787563

Epoch :  34 loss training:  34.961062759160995 Time :  867
accuracy train: 0.967064 val: 0.798311 test: 0.782780
max validation accuracy : 0.804878 max acc epoch : 23 test accuracy : 0.787563

========================================================================================================================================================================================================
best acc epoch :  23
validation accuracy :  0.8048780487804879
test accuracy :  0.7875633089476646
last test_accuracy :  0.7827799662352279
second best val :  0.8039399624765479
second best test :  0.7875633089476646
max gap 6
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=622, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  96.03630468249321 Time :  878
accuracy train: 0.771102 val: 0.741088 test: 0.764772
max validation accuracy : 0.741088 max acc epoch : 1 test accuracy : 0.764772
Epoch-1 lr: 0.001

Epoch :  2 loss training:  86.90755453705788 Time :  887
accuracy train: 0.786826 val: 0.752345 test: 0.760833
max validation accuracy : 0.752345 max acc epoch : 2 test accuracy : 0.760833
Epoch-2 lr: 0.001

Epoch :  3 loss training:  86.87390878796577 Time :  898
accuracy train: 0.748262 val: 0.712946 test: 0.737760
max validation accuracy : 0.752345 max acc epoch : 2 test accuracy : 0.760833
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.13236382603645 Time :  909
accuracy train: 0.794935 val: 0.757974 test: 0.778278
max validation accuracy : 0.757974 max acc epoch : 4 test accuracy : 0.778278
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.28060056269169 Time :  919
accuracy train: 0.802880 val: 0.756098 test: 0.773495
max validation accuracy : 0.757974 max acc epoch : 4 test accuracy : 0.778278
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.89644342660904 Time :  930
accuracy train: 0.805528 val: 0.753283 test: 0.771806
max validation accuracy : 0.757974 max acc epoch : 4 test accuracy : 0.778278
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.9928862452507 Time :  940
accuracy train: 0.806852 val: 0.753283 test: 0.781936
max validation accuracy : 0.757974 max acc epoch : 4 test accuracy : 0.778278
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.62762749195099 Time :  950
accuracy train: 0.800563 val: 0.757974 test: 0.776308
max validation accuracy : 0.757974 max acc epoch : 4 test accuracy : 0.778278
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.57144048810005 Time :  959
accuracy train: 0.814134 val: 0.756098 test: 0.776871
max validation accuracy : 0.757974 max acc epoch : 4 test accuracy : 0.778278
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.50736027956009 Time :  969
accuracy train: 0.813307 val: 0.756098 test: 0.776871
max validation accuracy : 0.757974 max acc epoch : 4 test accuracy : 0.778278

Epoch :  11 loss training:  73.43015190958977 Time :  979
accuracy train: 0.817941 val: 0.757036 test: 0.777153
max validation accuracy : 0.757974 max acc epoch : 4 test accuracy : 0.778278

Epoch :  12 loss training:  72.66570954024792 Time :  989
accuracy train: 0.835154 val: 0.773921 test: 0.781092
max validation accuracy : 0.773921 max acc epoch : 12 test accuracy : 0.781092

Epoch :  13 loss training:  71.65612372756004 Time :  1000
accuracy train: 0.842436 val: 0.771107 test: 0.781936
max validation accuracy : 0.773921 max acc epoch : 12 test accuracy : 0.781092

Epoch :  14 loss training:  69.90701439976692 Time :  1010
accuracy train: 0.842767 val: 0.760788 test: 0.781373
max validation accuracy : 0.773921 max acc epoch : 12 test accuracy : 0.781092

Epoch :  15 loss training:  67.75358380377293 Time :  1021
accuracy train: 0.850712 val: 0.759850 test: 0.777715
max validation accuracy : 0.773921 max acc epoch : 12 test accuracy : 0.781092

Epoch :  16 loss training:  64.29505233466625 Time :  1031
accuracy train: 0.860311 val: 0.761726 test: 0.778841
max validation accuracy : 0.773921 max acc epoch : 12 test accuracy : 0.781092

Epoch :  17 loss training:  63.197531417012215 Time :  1041
accuracy train: 0.873552 val: 0.774859 test: 0.777997
max validation accuracy : 0.774859 max acc epoch : 17 test accuracy : 0.777997

Epoch :  18 loss training:  62.75969633460045 Time :  1051
accuracy train: 0.880007 val: 0.771107 test: 0.777153
max validation accuracy : 0.774859 max acc epoch : 17 test accuracy : 0.777997

Epoch :  19 loss training:  59.90541172027588 Time :  1062
accuracy train: 0.888117 val: 0.772983 test: 0.780529
max validation accuracy : 0.774859 max acc epoch : 17 test accuracy : 0.777997

Epoch :  20 loss training:  58.59749846160412 Time :  1072
accuracy train: 0.899206 val: 0.774859 test: 0.776590
max validation accuracy : 0.774859 max acc epoch : 17 test accuracy : 0.777997

Epoch :  21 loss training:  56.29627127945423 Time :  1083
accuracy train: 0.906984 val: 0.775797 test: 0.779966
max validation accuracy : 0.775797 max acc epoch : 21 test accuracy : 0.779966

Epoch :  22 loss training:  55.10194915533066 Time :  1092
accuracy train: 0.910791 val: 0.765478 test: 0.779122
max validation accuracy : 0.775797 max acc epoch : 21 test accuracy : 0.779966

Epoch :  23 loss training:  54.395193457603455 Time :  1102
accuracy train: 0.914432 val: 0.772045 test: 0.780248
max validation accuracy : 0.775797 max acc epoch : 21 test accuracy : 0.779966

Epoch :  24 loss training:  50.58188250660896 Time :  1112
accuracy train: 0.923039 val: 0.774859 test: 0.781092
max validation accuracy : 0.775797 max acc epoch : 21 test accuracy : 0.779966

Epoch :  25 loss training:  49.11540175229311 Time :  1123
accuracy train: 0.928004 val: 0.767355 test: 0.780529
max validation accuracy : 0.775797 max acc epoch : 21 test accuracy : 0.779966

Epoch :  26 loss training:  47.64640096575022 Time :  1133
accuracy train: 0.935121 val: 0.774859 test: 0.781654
max validation accuracy : 0.775797 max acc epoch : 21 test accuracy : 0.779966

Epoch :  27 loss training:  45.44259913265705 Time :  1144
accuracy train: 0.935617 val: 0.767355 test: 0.780810
max validation accuracy : 0.775797 max acc epoch : 21 test accuracy : 0.779966

Epoch :  28 loss training:  42.54685854911804 Time :  1154
accuracy train: 0.944389 val: 0.770169 test: 0.782499
max validation accuracy : 0.775797 max acc epoch : 21 test accuracy : 0.779966

Epoch :  29 loss training:  40.88335172086954 Time :  1164
accuracy train: 0.951175 val: 0.763602 test: 0.784468
max validation accuracy : 0.775797 max acc epoch : 21 test accuracy : 0.779966

Epoch :  30 loss training:  41.81197615340352 Time :  1175
accuracy train: 0.955147 val: 0.765478 test: 0.780810
max validation accuracy : 0.775797 max acc epoch : 21 test accuracy : 0.779966

Epoch :  31 loss training:  37.94434995949268 Time :  1186
accuracy train: 0.959947 val: 0.770169 test: 0.779122
max validation accuracy : 0.775797 max acc epoch : 21 test accuracy : 0.779966

Epoch :  32 loss training:  37.295971155166626 Time :  1195
accuracy train: 0.964085 val: 0.768293 test: 0.783061
max validation accuracy : 0.775797 max acc epoch : 21 test accuracy : 0.779966

========================================================================================================================================================================================================
best acc epoch :  21
validation accuracy :  0.775797373358349
test accuracy :  0.7799662352279122
last test_accuracy :  0.7830613393359594
second best val :  0.774859287054409
second best test :  0.7779966235227912
max gap 8
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  16 	 val_accuracy : 0.77955 	 test_accuracy : 0.77940 	 last test_accuracy : 0.78447 	 second best val : 0.77767 	 second best test : 0.77940
k :  1 	 best_acc epoch :  13 	 val_accuracy : 0.77767 	 test_accuracy : 0.78081 	 last test_accuracy : 0.78841 	 second best val : 0.77674 	 second best test : 0.78081
k :  2 	 best_acc epoch :  23 	 val_accuracy : 0.80488 	 test_accuracy : 0.78756 	 last test_accuracy : 0.78278 	 second best val : 0.80394 	 second best test : 0.78756
k :  3 	 best_acc epoch :  21 	 val_accuracy : 0.77580 	 test_accuracy : 0.77997 	 last test_accuracy : 0.78306 	 second best val : 0.77486 	 second best test : 0.77800

avg :  	 val_accuracy : 0.78447 	 test_accuracy : 0.78194 	 last_accuracy : 0.78468 	 second best val : 0.78330 	 second best test : 0.78144

std :  	 val_accuracy : 0.01185 	 test_accuracy : 0.00329 	 last_accuracy : 0.00225 	 second best val : 0.01196 	 second best test : 0.00367


date and time :  Sun Jul  4 20:56:51 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=862, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0
Counter({1: 6237, 0: 4425})

Epoch :  1 loss training:  94.14148676395416 Time :  13
accuracy train: 0.761668 val: 0.747655 test: 0.759145
max validation accuracy : 0.747655 max acc epoch : 1 test accuracy : 0.759145
Counter({1: 5720, 0: 4942})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  86.62342396378517 Time :  26
accuracy train: 0.783515 val: 0.737336 test: 0.774902
max validation accuracy : 0.747655 max acc epoch : 1 test accuracy : 0.759145
Counter({0: 5484, 1: 5178})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  83.15977738797665 Time :  36
accuracy train: 0.793280 val: 0.749531 test: 0.770118
max validation accuracy : 0.749531 max acc epoch : 3 test accuracy : 0.770118
Counter({1: 5680, 0: 4982})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.61457023024559 Time :  48
accuracy train: 0.793280 val: 0.745779 test: 0.776871
max validation accuracy : 0.749531 max acc epoch : 3 test accuracy : 0.770118
Counter({0: 5667, 1: 4995})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.86260235309601 Time :  62
accuracy train: 0.791460 val: 0.742964 test: 0.764491
max validation accuracy : 0.749531 max acc epoch : 3 test accuracy : 0.770118
Counter({0: 5774, 1: 4888})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.07156920433044 Time :  76
accuracy train: 0.800397 val: 0.752345 test: 0.772088
max validation accuracy : 0.752345 max acc epoch : 6 test accuracy : 0.772088
Counter({0: 5821, 1: 4841})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  76.45782148838043 Time :  89
accuracy train: 0.802218 val: 0.746717 test: 0.772369
max validation accuracy : 0.752345 max acc epoch : 6 test accuracy : 0.772088
Counter({0: 5823, 1: 4839})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  75.78530538082123 Time :  102
accuracy train: 0.808342 val: 0.758912 test: 0.774057
max validation accuracy : 0.758912 max acc epoch : 8 test accuracy : 0.774057
Counter({0: 5843, 1: 4819})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  75.72197790443897 Time :  115
accuracy train: 0.803376 val: 0.748593 test: 0.772369
max validation accuracy : 0.758912 max acc epoch : 8 test accuracy : 0.774057
Counter({0: 5830, 1: 4832})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  76.1150675714016 Time :  128
accuracy train: 0.813141 val: 0.760788 test: 0.778559
max validation accuracy : 0.760788 max acc epoch : 10 test accuracy : 0.778559
Counter({0: 5855, 1: 4807})

Epoch :  11 loss training:  73.11058330535889 Time :  142
accuracy train: 0.813307 val: 0.757974 test: 0.779685
max validation accuracy : 0.760788 max acc epoch : 10 test accuracy : 0.778559
Counter({1: 5876, 0: 4786})

Epoch :  12 loss training:  72.88775436580181 Time :  155
accuracy train: 0.824230 val: 0.759850 test: 0.782499
max validation accuracy : 0.760788 max acc epoch : 10 test accuracy : 0.778559
Counter({1: 5917, 0: 4745})

Epoch :  13 loss training:  70.14541375637054 Time :  169
accuracy train: 0.826216 val: 0.756098 test: 0.782217
max validation accuracy : 0.760788 max acc epoch : 10 test accuracy : 0.778559
Counter({0: 5941, 1: 4721})

Epoch :  14 loss training:  68.78706918656826 Time :  183
accuracy train: 0.843429 val: 0.761726 test: 0.782217
max validation accuracy : 0.761726 max acc epoch : 14 test accuracy : 0.782217
Counter({1: 5876, 0: 4786})

Epoch :  15 loss training:  66.89334152638912 Time :  196
accuracy train: 0.848891 val: 0.753283 test: 0.781092
max validation accuracy : 0.761726 max acc epoch : 14 test accuracy : 0.782217
Counter({0: 5871, 1: 4791})

Epoch :  16 loss training:  65.57311876118183 Time :  209
accuracy train: 0.854518 val: 0.755159 test: 0.780810
max validation accuracy : 0.761726 max acc epoch : 14 test accuracy : 0.782217
Counter({0: 5905, 1: 4757})

Epoch :  17 loss training:  62.63610281050205 Time :  222
accuracy train: 0.866766 val: 0.758912 test: 0.782780
max validation accuracy : 0.761726 max acc epoch : 14 test accuracy : 0.782217
Counter({0: 5900, 1: 4762})

Epoch :  18 loss training:  61.333993434906006 Time :  236
accuracy train: 0.874876 val: 0.757974 test: 0.785312
max validation accuracy : 0.761726 max acc epoch : 14 test accuracy : 0.782217
Counter({0: 5825, 1: 4837})

Epoch :  19 loss training:  58.52879421412945 Time :  249
accuracy train: 0.885468 val: 0.766417 test: 0.783624
max validation accuracy : 0.766417 max acc epoch : 19 test accuracy : 0.783624
Counter({0: 5842, 1: 4820})

Epoch :  20 loss training:  57.05199557542801 Time :  262
accuracy train: 0.890930 val: 0.761726 test: 0.783061
max validation accuracy : 0.766417 max acc epoch : 19 test accuracy : 0.783624
Counter({1: 5832, 0: 4830})

Epoch :  21 loss training:  55.1918363571167 Time :  276
accuracy train: 0.895895 val: 0.771107 test: 0.784468
max validation accuracy : 0.771107 max acc epoch : 21 test accuracy : 0.784468
Counter({1: 5727, 0: 4935})

Epoch :  22 loss training:  52.680723547935486 Time :  289
accuracy train: 0.906984 val: 0.769231 test: 0.786719
max validation accuracy : 0.771107 max acc epoch : 21 test accuracy : 0.784468
Counter({1: 5699, 0: 4963})

Epoch :  23 loss training:  50.76814982295036 Time :  302
accuracy train: 0.912612 val: 0.773921 test: 0.786438
max validation accuracy : 0.773921 max acc epoch : 23 test accuracy : 0.786438
Counter({0: 5709, 1: 4953})

Epoch :  24 loss training:  48.84704250097275 Time :  316
accuracy train: 0.922873 val: 0.772045 test: 0.786156
max validation accuracy : 0.773921 max acc epoch : 23 test accuracy : 0.786438
Counter({0: 5708, 1: 4954})

Epoch :  25 loss training:  48.23484856635332 Time :  328
accuracy train: 0.929494 val: 0.771107 test: 0.785031
max validation accuracy : 0.773921 max acc epoch : 23 test accuracy : 0.786438
Counter({0: 5625, 1: 5037})

Epoch :  26 loss training:  45.158150516450405 Time :  341
accuracy train: 0.931976 val: 0.779550 test: 0.782499
max validation accuracy : 0.779550 max acc epoch : 26 test accuracy : 0.782499
Counter({1: 5656, 0: 5006})

Epoch :  27 loss training:  43.66125403344631 Time :  354
accuracy train: 0.937272 val: 0.770169 test: 0.781373
max validation accuracy : 0.779550 max acc epoch : 26 test accuracy : 0.782499
Counter({0: 5660, 1: 5002})

Epoch :  28 loss training:  42.517313785851 Time :  367
accuracy train: 0.938928 val: 0.774859 test: 0.786719
max validation accuracy : 0.779550 max acc epoch : 26 test accuracy : 0.782499
Counter({0: 5685, 1: 4977})

Epoch :  29 loss training:  40.502791687846184 Time :  380
accuracy train: 0.950017 val: 0.782364 test: 0.783905
max validation accuracy : 0.782364 max acc epoch : 29 test accuracy : 0.783905
Counter({1: 5678, 0: 4984})

Epoch :  30 loss training:  39.76858518272638 Time :  393
accuracy train: 0.951010 val: 0.778612 test: 0.783624
max validation accuracy : 0.782364 max acc epoch : 29 test accuracy : 0.783905
Counter({0: 5651, 1: 5011})

Epoch :  31 loss training:  37.98813018202782 Time :  407
accuracy train: 0.954816 val: 0.782364 test: 0.784187
max validation accuracy : 0.782364 max acc epoch : 29 test accuracy : 0.783905
Counter({0: 5615, 1: 5047})

Epoch :  32 loss training:  35.90762961655855 Time :  420
accuracy train: 0.958788 val: 0.780488 test: 0.789533
max validation accuracy : 0.782364 max acc epoch : 29 test accuracy : 0.783905
Counter({0: 5634, 1: 5028})

Epoch :  33 loss training:  34.59801018983126 Time :  434
accuracy train: 0.963257 val: 0.775797 test: 0.785031
max validation accuracy : 0.782364 max acc epoch : 29 test accuracy : 0.783905
Counter({1: 5648, 0: 5014})

Epoch :  34 loss training:  32.92707170732319 Time :  447
accuracy train: 0.967726 val: 0.775797 test: 0.783343
max validation accuracy : 0.782364 max acc epoch : 29 test accuracy : 0.783905
Counter({0: 5605, 1: 5057})

Epoch :  35 loss training:  30.842060312628746 Time :  460
accuracy train: 0.967064 val: 0.769231 test: 0.781092
max validation accuracy : 0.782364 max acc epoch : 29 test accuracy : 0.783905
Counter({0: 5600, 1: 5062})

Epoch :  36 loss training:  30.226239763200283 Time :  473
accuracy train: 0.975505 val: 0.782364 test: 0.788689
max validation accuracy : 0.782364 max acc epoch : 29 test accuracy : 0.783905
Counter({1: 5570, 0: 5092})

Epoch :  37 loss training:  29.537157848477364 Time :  486
accuracy train: 0.977160 val: 0.779550 test: 0.785875
max validation accuracy : 0.782364 max acc epoch : 29 test accuracy : 0.783905
Counter({0: 5574, 1: 5088})

Epoch :  38 loss training:  29.317082062363625 Time :  499
accuracy train: 0.976829 val: 0.775797 test: 0.788970
max validation accuracy : 0.782364 max acc epoch : 29 test accuracy : 0.783905
Counter({0: 5557, 1: 5105})

Epoch :  39 loss training:  27.511800963431597 Time :  512
accuracy train: 0.980470 val: 0.780488 test: 0.786156
max validation accuracy : 0.782364 max acc epoch : 29 test accuracy : 0.783905
Counter({0: 5549, 1: 5113})

Epoch :  40 loss training:  24.90810734592378 Time :  525
accuracy train: 0.981794 val: 0.773921 test: 0.786156
max validation accuracy : 0.782364 max acc epoch : 29 test accuracy : 0.783905
Counter({0: 5533, 1: 5129})

========================================================================================================================================================================================================
best acc epoch :  29
validation accuracy :  0.7823639774859287
test accuracy :  0.7839054586381542
last test_accuracy :  0.7861564434440067
second best val :  0.7804878048780488
second best test :  0.7839054586381542
max gap 5
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=465, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0
Counter({0: 6235, 1: 4427})

Epoch :  1 loss training:  97.55850410461426 Time :  541
accuracy train: 0.758524 val: 0.748593 test: 0.745357
max validation accuracy : 0.748593 max acc epoch : 1 test accuracy : 0.745357
Counter({1: 6299, 0: 4363})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  89.74720093607903 Time :  555
accuracy train: 0.775571 val: 0.761726 test: 0.764772
max validation accuracy : 0.761726 max acc epoch : 2 test accuracy : 0.764772
Counter({1: 5763, 0: 4899})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  84.93291747570038 Time :  569
accuracy train: 0.784343 val: 0.764540 test: 0.771806
max validation accuracy : 0.764540 max acc epoch : 3 test accuracy : 0.771806
Counter({0: 5533, 1: 5129})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  82.41459041833878 Time :  582
accuracy train: 0.788150 val: 0.786116 test: 0.779685
max validation accuracy : 0.786116 max acc epoch : 4 test accuracy : 0.779685
Counter({1: 6067, 0: 4595})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  81.1328629553318 Time :  596
accuracy train: 0.794935 val: 0.777674 test: 0.778278
max validation accuracy : 0.786116 max acc epoch : 4 test accuracy : 0.779685
Counter({1: 6292, 0: 4370})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.55353891849518 Time :  608
accuracy train: 0.796756 val: 0.775797 test: 0.775746
max validation accuracy : 0.786116 max acc epoch : 4 test accuracy : 0.779685
Counter({0: 6168, 1: 4494})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  78.48433551192284 Time :  621
accuracy train: 0.789805 val: 0.772983 test: 0.767586
max validation accuracy : 0.786116 max acc epoch : 4 test accuracy : 0.779685
Counter({0: 6171, 1: 4491})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.55108664929867 Time :  634
accuracy train: 0.799901 val: 0.780488 test: 0.782499
max validation accuracy : 0.786116 max acc epoch : 4 test accuracy : 0.779685
Counter({1: 6165, 0: 4497})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.73689544200897 Time :  646
accuracy train: 0.794604 val: 0.772045 test: 0.770400
max validation accuracy : 0.786116 max acc epoch : 4 test accuracy : 0.779685
Counter({0: 6188, 1: 4474})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.77860999107361 Time :  658
accuracy train: 0.796260 val: 0.765478 test: 0.765898
max validation accuracy : 0.786116 max acc epoch : 4 test accuracy : 0.779685
Counter({1: 6172, 0: 4490})

Epoch :  11 loss training:  74.45352317392826 Time :  670
accuracy train: 0.796425 val: 0.768293 test: 0.765053
max validation accuracy : 0.786116 max acc epoch : 4 test accuracy : 0.779685
Counter({0: 6119, 1: 4543})

Epoch :  12 loss training:  73.67533315718174 Time :  683
accuracy train: 0.819596 val: 0.783302 test: 0.776308
max validation accuracy : 0.786116 max acc epoch : 4 test accuracy : 0.779685
Counter({0: 6136, 1: 4526})

Epoch :  13 loss training:  71.89449271559715 Time :  697
accuracy train: 0.815789 val: 0.777674 test: 0.772932
max validation accuracy : 0.786116 max acc epoch : 4 test accuracy : 0.779685
Counter({0: 6145, 1: 4517})

Epoch :  14 loss training:  70.46071594953537 Time :  710
accuracy train: 0.837471 val: 0.784240 test: 0.778841
max validation accuracy : 0.786116 max acc epoch : 4 test accuracy : 0.779685
Counter({0: 6142, 1: 4520})

Epoch :  15 loss training:  68.20976309478283 Time :  723
accuracy train: 0.839292 val: 0.781426 test: 0.776027
max validation accuracy : 0.786116 max acc epoch : 4 test accuracy : 0.779685
Counter({0: 6147, 1: 4515})

========================================================================================================================================================================================================
best acc epoch :  4
validation accuracy :  0.7861163227016885
test accuracy :  0.7796848621271807
last test_accuracy :  0.7760270118176702
second best val :  0.7842401500938087
second best test :  0.7796848621271807
max gap 1
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=9, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0
Counter({1: 6185, 0: 4477})

Epoch :  1 loss training:  97.01682198047638 Time :  739
accuracy train: 0.771599 val: 0.745779 test: 0.763647
max validation accuracy : 0.745779 max acc epoch : 1 test accuracy : 0.763647
Counter({0: 5845, 1: 4817})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  86.10232785344124 Time :  753
accuracy train: 0.780702 val: 0.768293 test: 0.772369
max validation accuracy : 0.768293 max acc epoch : 2 test accuracy : 0.772369
Counter({0: 5930, 1: 4732})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  84.38941639661789 Time :  766
accuracy train: 0.783681 val: 0.766417 test: 0.778559
max validation accuracy : 0.768293 max acc epoch : 2 test accuracy : 0.772369
Counter({0: 6165, 1: 4497})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.05369994044304 Time :  780
accuracy train: 0.793280 val: 0.772045 test: 0.777434
max validation accuracy : 0.772045 max acc epoch : 4 test accuracy : 0.777434
Counter({1: 6262, 0: 4400})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.52433663606644 Time :  793
accuracy train: 0.790467 val: 0.762664 test: 0.782780
max validation accuracy : 0.772045 max acc epoch : 4 test accuracy : 0.777434
Counter({0: 6181, 1: 4481})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.58076101541519 Time :  807
accuracy train: 0.797915 val: 0.778612 test: 0.777434
max validation accuracy : 0.778612 max acc epoch : 6 test accuracy : 0.777434
Counter({1: 6062, 0: 4600})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.18930250406265 Time :  822
accuracy train: 0.800894 val: 0.772983 test: 0.777434
max validation accuracy : 0.778612 max acc epoch : 6 test accuracy : 0.777434
Counter({0: 6000, 1: 4662})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.64908081293106 Time :  835
accuracy train: 0.805197 val: 0.779550 test: 0.780810
max validation accuracy : 0.779550 max acc epoch : 8 test accuracy : 0.780810
Counter({0: 5995, 1: 4667})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.24310168623924 Time :  849
accuracy train: 0.807183 val: 0.779550 test: 0.781654
max validation accuracy : 0.779550 max acc epoch : 8 test accuracy : 0.780810
Counter({0: 5965, 1: 4697})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.20022082328796 Time :  862
accuracy train: 0.808838 val: 0.776735 test: 0.785031
max validation accuracy : 0.779550 max acc epoch : 8 test accuracy : 0.780810
Counter({1: 5967, 0: 4695})

Epoch :  11 loss training:  75.28273791074753 Time :  876
accuracy train: 0.813803 val: 0.773921 test: 0.781092
max validation accuracy : 0.779550 max acc epoch : 8 test accuracy : 0.780810
Counter({0: 5930, 1: 4732})

Epoch :  12 loss training:  73.46844132244587 Time :  892
accuracy train: 0.824727 val: 0.781426 test: 0.788126
max validation accuracy : 0.781426 max acc epoch : 12 test accuracy : 0.788126
Counter({0: 5957, 1: 4705})

Epoch :  13 loss training:  70.79990731179714 Time :  906
accuracy train: 0.830851 val: 0.786116 test: 0.786438
max validation accuracy : 0.786116 max acc epoch : 13 test accuracy : 0.786438
Counter({1: 5973, 0: 4689})

Epoch :  14 loss training:  70.47345013916492 Time :  920
accuracy train: 0.840285 val: 0.785178 test: 0.785594
max validation accuracy : 0.786116 max acc epoch : 13 test accuracy : 0.786438
Counter({1: 6013, 0: 4649})

Epoch :  15 loss training:  68.1319634616375 Time :  934
accuracy train: 0.835154 val: 0.779550 test: 0.782780
max validation accuracy : 0.786116 max acc epoch : 13 test accuracy : 0.786438
Counter({0: 5974, 1: 4688})

Epoch :  16 loss training:  66.13049298524857 Time :  948
accuracy train: 0.851043 val: 0.792683 test: 0.780529
max validation accuracy : 0.792683 max acc epoch : 16 test accuracy : 0.780529
Counter({0: 5999, 1: 4663})

Epoch :  17 loss training:  64.30325092375278 Time :  965
accuracy train: 0.857498 val: 0.791745 test: 0.783061
max validation accuracy : 0.792683 max acc epoch : 16 test accuracy : 0.780529
Counter({1: 5989, 0: 4673})

Epoch :  18 loss training:  62.66555871069431 Time :  979
accuracy train: 0.868918 val: 0.788931 test: 0.783061
max validation accuracy : 0.792683 max acc epoch : 16 test accuracy : 0.780529
Counter({0: 5996, 1: 4666})

Epoch :  19 loss training:  58.562242209911346 Time :  993
accuracy train: 0.876034 val: 0.792683 test: 0.784468
max validation accuracy : 0.792683 max acc epoch : 16 test accuracy : 0.780529
Counter({0: 6029, 1: 4633})

Epoch :  20 loss training:  58.7376255095005 Time :  1007
accuracy train: 0.886627 val: 0.799250 test: 0.786438
max validation accuracy : 0.799250 max acc epoch : 20 test accuracy : 0.786438
Counter({0: 6015, 1: 4647})

Epoch :  21 loss training:  56.79786905646324 Time :  1021
accuracy train: 0.897716 val: 0.796435 test: 0.783061
max validation accuracy : 0.799250 max acc epoch : 20 test accuracy : 0.786438
Counter({0: 5960, 1: 4702})

Epoch :  22 loss training:  54.94700512290001 Time :  1037
accuracy train: 0.903178 val: 0.800188 test: 0.784468
max validation accuracy : 0.800188 max acc epoch : 22 test accuracy : 0.784468
Counter({0: 6007, 1: 4655})

Epoch :  23 loss training:  51.29222618043423 Time :  1050
accuracy train: 0.912281 val: 0.790807 test: 0.786438
max validation accuracy : 0.800188 max acc epoch : 22 test accuracy : 0.784468
Counter({0: 6064, 1: 4598})

Epoch :  24 loss training:  49.5002630725503 Time :  1065
accuracy train: 0.914432 val: 0.793621 test: 0.784187
max validation accuracy : 0.800188 max acc epoch : 22 test accuracy : 0.784468
Counter({0: 5994, 1: 4668})

Epoch :  25 loss training:  47.67904332280159 Time :  1078
accuracy train: 0.927838 val: 0.788931 test: 0.789252
max validation accuracy : 0.800188 max acc epoch : 22 test accuracy : 0.784468
Counter({0: 6027, 1: 4635})

Epoch :  26 loss training:  45.11143895238638 Time :  1091
accuracy train: 0.931811 val: 0.780488 test: 0.782780
max validation accuracy : 0.800188 max acc epoch : 22 test accuracy : 0.784468
Counter({0: 6028, 1: 4634})

Epoch :  27 loss training:  44.809650637209415 Time :  1104
accuracy train: 0.933797 val: 0.788931 test: 0.784187
max validation accuracy : 0.800188 max acc epoch : 22 test accuracy : 0.784468
Counter({0: 6013, 1: 4649})

Epoch :  28 loss training:  41.55226296931505 Time :  1119
accuracy train: 0.941907 val: 0.785178 test: 0.784750
max validation accuracy : 0.800188 max acc epoch : 22 test accuracy : 0.784468
Counter({0: 6040, 1: 4622})

Epoch :  29 loss training:  41.29995073378086 Time :  1131
accuracy train: 0.947534 val: 0.786116 test: 0.785031
max validation accuracy : 0.800188 max acc epoch : 22 test accuracy : 0.784468
Counter({0: 6015, 1: 4647})

Epoch :  30 loss training:  37.38094890117645 Time :  1145
accuracy train: 0.952334 val: 0.790807 test: 0.781654
max validation accuracy : 0.800188 max acc epoch : 22 test accuracy : 0.784468
Counter({0: 6005, 1: 4657})

Epoch :  31 loss training:  36.05735545605421 Time :  1160
accuracy train: 0.953823 val: 0.782364 test: 0.781654
max validation accuracy : 0.800188 max acc epoch : 22 test accuracy : 0.784468
Counter({0: 5981, 1: 4681})

Epoch :  32 loss training:  35.469099674373865 Time :  1173
accuracy train: 0.959451 val: 0.789869 test: 0.783905
max validation accuracy : 0.800188 max acc epoch : 22 test accuracy : 0.784468
Counter({1: 5997, 0: 4665})

Epoch :  33 loss training:  34.50284905731678 Time :  1187
accuracy train: 0.963092 val: 0.783302 test: 0.784187
max validation accuracy : 0.800188 max acc epoch : 22 test accuracy : 0.784468
Counter({0: 5994, 1: 4668})

========================================================================================================================================================================================================
best acc epoch :  22
validation accuracy :  0.800187617260788
test accuracy :  0.7844682048396173
last test_accuracy :  0.7841868317388858
second best val :  0.799249530956848
second best test :  0.7864378165447383
max gap 4
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=189, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0
Counter({0: 6233, 1: 4429})

Epoch :  1 loss training:  97.03523871302605 Time :  1203
accuracy train: 0.774578 val: 0.754221 test: 0.770118
max validation accuracy : 0.754221 max acc epoch : 1 test accuracy : 0.770118
Counter({1: 5865, 0: 4797})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  86.99412813782692 Time :  1218
accuracy train: 0.778550 val: 0.763602 test: 0.771244
max validation accuracy : 0.763602 max acc epoch : 2 test accuracy : 0.771244
Counter({0: 5742, 1: 4920})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  85.93049502372742 Time :  1237
accuracy train: 0.789143 val: 0.760788 test: 0.779403
max validation accuracy : 0.763602 max acc epoch : 2 test accuracy : 0.771244
Counter({0: 5513, 1: 5149})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.39891389012337 Time :  1251
accuracy train: 0.784674 val: 0.770169 test: 0.772369
max validation accuracy : 0.770169 max acc epoch : 4 test accuracy : 0.772369
Counter({1: 5618, 0: 5044})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.25977927446365 Time :  1264
accuracy train: 0.788315 val: 0.772045 test: 0.778559
max validation accuracy : 0.772045 max acc epoch : 5 test accuracy : 0.778559
Counter({1: 5597, 0: 5065})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.51981273293495 Time :  1277
accuracy train: 0.797253 val: 0.776735 test: 0.770400
max validation accuracy : 0.776735 max acc epoch : 6 test accuracy : 0.770400
Counter({0: 5891, 1: 4771})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  78.48764023184776 Time :  1292
accuracy train: 0.805362 val: 0.775797 test: 0.776590
max validation accuracy : 0.776735 max acc epoch : 6 test accuracy : 0.770400
Counter({1: 5879, 0: 4783})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.70143330097198 Time :  1310
accuracy train: 0.808838 val: 0.772045 test: 0.775183
max validation accuracy : 0.776735 max acc epoch : 6 test accuracy : 0.770400
Counter({1: 5862, 0: 4800})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  74.74179649353027 Time :  1324
accuracy train: 0.805197 val: 0.765478 test: 0.776590
max validation accuracy : 0.776735 max acc epoch : 6 test accuracy : 0.770400
Counter({1: 5854, 0: 4808})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  73.89295925199986 Time :  1339
accuracy train: 0.812976 val: 0.763602 test: 0.776590
max validation accuracy : 0.776735 max acc epoch : 6 test accuracy : 0.770400
Counter({1: 5863, 0: 4799})

Epoch :  11 loss training:  73.3009454458952 Time :  1352
accuracy train: 0.817445 val: 0.766417 test: 0.782780
max validation accuracy : 0.776735 max acc epoch : 6 test accuracy : 0.770400
Counter({1: 5891, 0: 4771})

Epoch :  12 loss training:  72.65160718560219 Time :  1365
accuracy train: 0.824230 val: 0.773921 test: 0.780529
max validation accuracy : 0.776735 max acc epoch : 6 test accuracy : 0.770400
Counter({1: 5879, 0: 4783})

Epoch :  13 loss training:  72.76848992705345 Time :  1380
accuracy train: 0.831678 val: 0.772983 test: 0.780248
max validation accuracy : 0.776735 max acc epoch : 6 test accuracy : 0.770400
Counter({1: 5873, 0: 4789})

Epoch :  14 loss training:  68.9352361112833 Time :  1392
accuracy train: 0.840285 val: 0.776735 test: 0.785031
max validation accuracy : 0.776735 max acc epoch : 6 test accuracy : 0.770400
Counter({0: 5909, 1: 4753})

Epoch :  15 loss training:  67.71637542545795 Time :  1405
accuracy train: 0.849388 val: 0.771107 test: 0.785031
max validation accuracy : 0.776735 max acc epoch : 6 test accuracy : 0.770400
Counter({1: 5937, 0: 4725})

Epoch :  16 loss training:  65.38387797772884 Time :  1419
accuracy train: 0.858160 val: 0.773921 test: 0.779966
max validation accuracy : 0.776735 max acc epoch : 6 test accuracy : 0.770400
Counter({1: 5948, 0: 4714})

Epoch :  17 loss training:  64.33458340167999 Time :  1435
accuracy train: 0.861635 val: 0.772983 test: 0.783624
max validation accuracy : 0.776735 max acc epoch : 6 test accuracy : 0.770400
Counter({0: 5981, 1: 4681})

========================================================================================================================================================================================================
best acc epoch :  6
validation accuracy :  0.776735459662289
test accuracy :  0.7703995498030388
last test_accuracy :  0.7836240855374226
second best val :  0.775797373358349
second best test :  0.7703995498030388
max gap 2
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  29 	 val_accuracy : 0.78236 	 test_accuracy : 0.78391 	 last test_accuracy : 0.78616 	 second best val : 0.78049 	 second best test : 0.78391
k :  1 	 best_acc epoch :  4 	 val_accuracy : 0.78612 	 test_accuracy : 0.77968 	 last test_accuracy : 0.77603 	 second best val : 0.78424 	 second best test : 0.77968
k :  2 	 best_acc epoch :  22 	 val_accuracy : 0.80019 	 test_accuracy : 0.78447 	 last test_accuracy : 0.78419 	 second best val : 0.79925 	 second best test : 0.78644
k :  3 	 best_acc epoch :  6 	 val_accuracy : 0.77674 	 test_accuracy : 0.77040 	 last test_accuracy : 0.78362 	 second best val : 0.77580 	 second best test : 0.77040

avg :  	 val_accuracy : 0.78635 	 test_accuracy : 0.77961 	 last_accuracy : 0.78250 	 second best val : 0.78494 	 second best test : 0.78011

std :  	 val_accuracy : 0.00866 	 test_accuracy : 0.00563 	 last_accuracy : 0.00385 	 second best val : 0.00878 	 second best test : 0.00610
