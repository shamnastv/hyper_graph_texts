

date and time :  Fri Jun  4 01:18:51 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=174, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  102.55397456884384 Time :  11
accuracy train: 0.646921 val: 0.614085 test: 0.638998
max validation accuracy : 0.614085 max acc epoch : 1 test accuracy : 0.638998
Epoch-1 lr: 0.005

Epoch :  2 loss training:  93.49700736999512 Time :  23
accuracy train: 0.778368 val: 0.767606 test: 0.762802
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.762802
Epoch-2 lr: 0.005

Epoch :  3 loss training:  96.01726779341698 Time :  35
accuracy train: 0.785089 val: 0.730986 test: 0.763647
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.762802
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  78.89569960534573 Time :  44
accuracy train: 0.799625 val: 0.753521 test: 0.772088
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.762802
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  78.28156661987305 Time :  55
accuracy train: 0.726008 val: 0.709859 test: 0.685988
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.762802
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  75.02668789029121 Time :  64
accuracy train: 0.778993 val: 0.719718 test: 0.746201
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.762802
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  68.55274882912636 Time :  76
accuracy train: 0.822757 val: 0.753521 test: 0.770681
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.762802
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  69.99965824186802 Time :  91
accuracy train: 0.815255 val: 0.750704 test: 0.758863
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.762802
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  68.07343201339245 Time :  101
accuracy train: 0.613942 val: 0.590141 test: 0.594260
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.762802
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  65.05798310041428 Time :  113
accuracy train: 0.822132 val: 0.754930 test: 0.770962
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.762802
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  64.18636091053486 Time :  122
accuracy train: 0.801344 val: 0.746479 test: 0.744232
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.762802
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  64.95109684765339 Time :  134
accuracy train: 0.787746 val: 0.721127 test: 0.753799
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.762802
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  65.02446153759956 Time :  145
accuracy train: 0.836043 val: 0.767606 test: 0.777434
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.762802
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  65.07236632704735 Time :  155
accuracy train: 0.866208 val: 0.759155 test: 0.781936
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.762802
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  60.70804660022259 Time :  166
accuracy train: 0.880275 val: 0.771831 test: 0.787001
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  16 loss training:  59.57116079330444 Time :  176
accuracy train: 0.896686 val: 0.770423 test: 0.784468
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  17 loss training:  52.40833383798599 Time :  188
accuracy train: 0.914661 val: 0.756338 test: 0.788970
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  18 loss training:  48.29960772395134 Time :  200
accuracy train: 0.932635 val: 0.764789 test: 0.786719
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  19 loss training:  43.60250251740217 Time :  213
accuracy train: 0.944983 val: 0.752113 test: 0.786719
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  20 loss training:  38.57387638092041 Time :  224
accuracy train: 0.956236 val: 0.756338 test: 0.785594
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  21 loss training:  33.85391768068075 Time :  235
accuracy train: 0.966552 val: 0.754930 test: 0.784468
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  22 loss training:  29.885582324117422 Time :  246
accuracy train: 0.972960 val: 0.742254 test: 0.782780
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  23 loss training:  26.06578901782632 Time :  256
accuracy train: 0.981244 val: 0.749296 test: 0.776590
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  24 loss training:  23.2522779032588 Time :  268
accuracy train: 0.983745 val: 0.745070 test: 0.774620
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  25 loss training:  20.653969943523407 Time :  280
accuracy train: 0.987340 val: 0.743662 test: 0.773213
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  26 loss training:  17.17949473299086 Time :  290
accuracy train: 0.989528 val: 0.749296 test: 0.770681
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  27 loss training:  16.200173418968916 Time :  302
accuracy train: 0.981869 val: 0.745070 test: 0.757456
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  28 loss training:  14.715940030291677 Time :  313
accuracy train: 0.987027 val: 0.747887 test: 0.763365
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  29 loss training:  12.017449086531997 Time :  324
accuracy train: 0.992029 val: 0.739437 test: 0.762240
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  30 loss training:  11.0310979783535 Time :  339
accuracy train: 0.996093 val: 0.740845 test: 0.758019
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  31 loss training:  9.167417293414474 Time :  348
accuracy train: 0.996874 val: 0.745070 test: 0.759989
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  32 loss training:  8.8815879188478 Time :  358
accuracy train: 0.998437 val: 0.738028 test: 0.762240
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  33 loss training:  7.863066013902426 Time :  369
accuracy train: 0.998750 val: 0.740845 test: 0.754924
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  34 loss training:  6.643194413743913 Time :  380
accuracy train: 0.999219 val: 0.747887 test: 0.758019
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  35 loss training:  6.0424775262363255 Time :  392
accuracy train: 0.999687 val: 0.743662 test: 0.761396
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  36 loss training:  5.1466400171630085 Time :  402
accuracy train: 0.999531 val: 0.742254 test: 0.754643
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  37 loss training:  5.6479718934278935 Time :  414
accuracy train: 0.999844 val: 0.746479 test: 0.754924
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  38 loss training:  4.2645013817818835 Time :  426
accuracy train: 0.999844 val: 0.745070 test: 0.755487
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  39 loss training:  4.179886603727937 Time :  435
accuracy train: 0.999844 val: 0.750704 test: 0.752110
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  40 loss training:  3.5904218496289104 Time :  449
accuracy train: 0.999844 val: 0.746479 test: 0.752954
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  41 loss training:  3.530732159037143 Time :  461
accuracy train: 0.999687 val: 0.739437 test: 0.749578
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  42 loss training:  3.185303137404844 Time :  472
accuracy train: 0.999844 val: 0.735211 test: 0.755205
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  43 loss training:  2.6960319778881967 Time :  481
accuracy train: 0.999687 val: 0.749296 test: 0.749578
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  44 loss training:  2.705758336611325 Time :  493
accuracy train: 0.999844 val: 0.742254 test: 0.751266
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  45 loss training:  2.3698176384205 Time :  503
accuracy train: 0.999844 val: 0.738028 test: 0.751548
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

Epoch :  46 loss training:  2.651000661600847 Time :  515
accuracy train: 0.999844 val: 0.739437 test: 0.754080
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.787001

========================================================================================================================================================================================================
max acc epoch :  15
max validation accuracy :  0.7718309859154929
test accuracy :  0.7870005627462014
last test_accuracy :  0.7540799099606078
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=174, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  101.253194719553 Time :  526
accuracy train: 0.678493 val: 0.643662 test: 0.671919
max validation accuracy : 0.643662 max acc epoch : 1 test accuracy : 0.671919
Epoch-1 lr: 0.005

Epoch :  2 loss training:  91.05397021770477 Time :  537
accuracy train: 0.777430 val: 0.738028 test: 0.747608
max validation accuracy : 0.738028 max acc epoch : 2 test accuracy : 0.747608
Epoch-2 lr: 0.005

Epoch :  3 loss training:  83.35680362582207 Time :  550
accuracy train: 0.826039 val: 0.760563 test: 0.777997
max validation accuracy : 0.760563 max acc epoch : 3 test accuracy : 0.777997
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  76.62757489085197 Time :  561
accuracy train: 0.841357 val: 0.749296 test: 0.780529
max validation accuracy : 0.760563 max acc epoch : 3 test accuracy : 0.777997
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  72.38419224321842 Time :  573
accuracy train: 0.862613 val: 0.756338 test: 0.783624
max validation accuracy : 0.760563 max acc epoch : 3 test accuracy : 0.777997
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  67.65659630298615 Time :  586
accuracy train: 0.882151 val: 0.754930 test: 0.780248
max validation accuracy : 0.760563 max acc epoch : 3 test accuracy : 0.777997
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  59.10380446910858 Time :  596
accuracy train: 0.875899 val: 0.739437 test: 0.777153
max validation accuracy : 0.760563 max acc epoch : 3 test accuracy : 0.777997
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  58.268100887537 Time :  608
accuracy train: 0.902938 val: 0.750704 test: 0.776871
max validation accuracy : 0.760563 max acc epoch : 3 test accuracy : 0.777997
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  55.95613223314285 Time :  619
accuracy train: 0.892935 val: 0.732394 test: 0.763365
max validation accuracy : 0.760563 max acc epoch : 3 test accuracy : 0.777997
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  50.94036063551903 Time :  629
accuracy train: 0.924508 val: 0.770423 test: 0.781654
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  49.377901792526245 Time :  642
accuracy train: 0.931229 val: 0.760563 test: 0.782217
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  47.26723553240299 Time :  652
accuracy train: 0.896218 val: 0.752113 test: 0.774339
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  45.77706800401211 Time :  661
accuracy train: 0.933417 val: 0.754930 test: 0.785312
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  45.65620359033346 Time :  673
accuracy train: 0.942795 val: 0.754930 test: 0.777997
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  42.922853253781796 Time :  682
accuracy train: 0.950453 val: 0.749296 test: 0.783343
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

Epoch :  16 loss training:  42.67793050408363 Time :  696
accuracy train: 0.958581 val: 0.753521 test: 0.785875
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

Epoch :  17 loss training:  35.783780962228775 Time :  710
accuracy train: 0.968897 val: 0.749296 test: 0.783905
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

Epoch :  18 loss training:  32.901700124144554 Time :  720
accuracy train: 0.976711 val: 0.759155 test: 0.780248
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

Epoch :  19 loss training:  29.29296388477087 Time :  731
accuracy train: 0.982026 val: 0.754930 test: 0.781654
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

Epoch :  20 loss training:  25.747756749391556 Time :  743
accuracy train: 0.987183 val: 0.763380 test: 0.777434
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

Epoch :  21 loss training:  22.618070002645254 Time :  753
accuracy train: 0.990935 val: 0.753521 test: 0.778841
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

Epoch :  22 loss training:  18.9388250336051 Time :  765
accuracy train: 0.992341 val: 0.754930 test: 0.779685
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

Epoch :  23 loss training:  16.922557555139065 Time :  777
accuracy train: 0.994217 val: 0.764789 test: 0.773776
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

Epoch :  24 loss training:  15.29020850546658 Time :  786
accuracy train: 0.994998 val: 0.756338 test: 0.778841
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

Epoch :  25 loss training:  13.560622338205576 Time :  798
accuracy train: 0.996718 val: 0.760563 test: 0.770400
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

Epoch :  26 loss training:  12.149989748373628 Time :  809
accuracy train: 0.997812 val: 0.763380 test: 0.769274
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

Epoch :  27 loss training:  10.743251416832209 Time :  821
accuracy train: 0.998906 val: 0.766197 test: 0.765053
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

Epoch :  28 loss training:  9.438958229497075 Time :  834
accuracy train: 0.999219 val: 0.752113 test: 0.766460
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

Epoch :  29 loss training:  8.159350761212409 Time :  843
accuracy train: 0.999531 val: 0.760563 test: 0.763084
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

Epoch :  30 loss training:  7.510422943159938 Time :  855
accuracy train: 0.999531 val: 0.753521 test: 0.766179
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

Epoch :  31 loss training:  6.142522236332297 Time :  867
accuracy train: 0.998906 val: 0.753521 test: 0.764209
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

Epoch :  32 loss training:  6.117608000990003 Time :  877
accuracy train: 0.999531 val: 0.761972 test: 0.761958
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

Epoch :  33 loss training:  5.440600614994764 Time :  890
accuracy train: 0.999844 val: 0.759155 test: 0.762521
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

Epoch :  34 loss training:  4.3163588414900005 Time :  902
accuracy train: 0.999531 val: 0.759155 test: 0.759426
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

Epoch :  35 loss training:  4.1064582308754325 Time :  913
accuracy train: 0.999844 val: 0.757746 test: 0.760270
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

Epoch :  36 loss training:  3.855299230199307 Time :  922
accuracy train: 0.999844 val: 0.759155 test: 0.759989
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

Epoch :  37 loss training:  3.6866202106466517 Time :  935
accuracy train: 0.999844 val: 0.750704 test: 0.759989
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

Epoch :  38 loss training:  2.8624227517284453 Time :  948
accuracy train: 0.999844 val: 0.754930 test: 0.759426
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

Epoch :  39 loss training:  2.4329461810411885 Time :  962
accuracy train: 0.999844 val: 0.749296 test: 0.759989
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

Epoch :  40 loss training:  2.5021814518840984 Time :  973
accuracy train: 0.999687 val: 0.745070 test: 0.754924
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

Epoch :  41 loss training:  2.0813759735319763 Time :  983
accuracy train: 0.999844 val: 0.747887 test: 0.758582
max validation accuracy : 0.770423 max acc epoch : 10 test accuracy : 0.781654

========================================================================================================================================================================================================
max acc epoch :  10
max validation accuracy :  0.7704225352112676
test accuracy :  0.7816544738323016
last test_accuracy :  0.7585818795723129
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=174, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  103.4858303964138 Time :  996
accuracy train: 0.663645 val: 0.625352 test: 0.657006
max validation accuracy : 0.625352 max acc epoch : 1 test accuracy : 0.657006
Epoch-1 lr: 0.005

Epoch :  2 loss training:  88.4324423968792 Time :  1009
accuracy train: 0.778056 val: 0.763380 test: 0.755768
max validation accuracy : 0.763380 max acc epoch : 2 test accuracy : 0.755768
Epoch-2 lr: 0.005

Epoch :  3 loss training:  86.65299105644226 Time :  1019
accuracy train: 0.790872 val: 0.732394 test: 0.743669
max validation accuracy : 0.763380 max acc epoch : 2 test accuracy : 0.755768
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  75.5106762200594 Time :  1030
accuracy train: 0.821507 val: 0.749296 test: 0.775746
max validation accuracy : 0.763380 max acc epoch : 2 test accuracy : 0.755768
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  71.88108225166798 Time :  1042
accuracy train: 0.854017 val: 0.759155 test: 0.779403
max validation accuracy : 0.763380 max acc epoch : 2 test accuracy : 0.755768
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  69.1285378485918 Time :  1052
accuracy train: 0.875117 val: 0.750704 test: 0.781092
max validation accuracy : 0.763380 max acc epoch : 2 test accuracy : 0.755768
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  61.25233905017376 Time :  1069
accuracy train: 0.844326 val: 0.738028 test: 0.758301
max validation accuracy : 0.763380 max acc epoch : 2 test accuracy : 0.755768
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  60.260364413261414 Time :  1079
accuracy train: 0.904501 val: 0.766197 test: 0.779685
max validation accuracy : 0.766197 max acc epoch : 8 test accuracy : 0.779685
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  56.572210893034935 Time :  1091
accuracy train: 0.893560 val: 0.760563 test: 0.768711
max validation accuracy : 0.766197 max acc epoch : 8 test accuracy : 0.779685
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  51.9262725263834 Time :  1103
accuracy train: 0.926227 val: 0.766197 test: 0.780248
max validation accuracy : 0.766197 max acc epoch : 8 test accuracy : 0.779685
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  49.732192635536194 Time :  1112
accuracy train: 0.932166 val: 0.754930 test: 0.780810
max validation accuracy : 0.766197 max acc epoch : 8 test accuracy : 0.779685
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  47.30149099230766 Time :  1125
accuracy train: 0.938575 val: 0.749296 test: 0.780248
max validation accuracy : 0.766197 max acc epoch : 8 test accuracy : 0.779685
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  44.44810312986374 Time :  1136
accuracy train: 0.939356 val: 0.752113 test: 0.779403
max validation accuracy : 0.766197 max acc epoch : 8 test accuracy : 0.779685
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  44.18703384697437 Time :  1146
accuracy train: 0.947796 val: 0.756338 test: 0.774620
max validation accuracy : 0.766197 max acc epoch : 8 test accuracy : 0.779685
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  42.12404605001211 Time :  1156
accuracy train: 0.952485 val: 0.760563 test: 0.776590
max validation accuracy : 0.766197 max acc epoch : 8 test accuracy : 0.779685

Epoch :  16 loss training:  41.594292640686035 Time :  1167
accuracy train: 0.963895 val: 0.763380 test: 0.780810
max validation accuracy : 0.766197 max acc epoch : 8 test accuracy : 0.779685

Epoch :  17 loss training:  34.75936471670866 Time :  1176
accuracy train: 0.973273 val: 0.747887 test: 0.776871
max validation accuracy : 0.766197 max acc epoch : 8 test accuracy : 0.779685

Epoch :  18 loss training:  31.64366962760687 Time :  1191
accuracy train: 0.977180 val: 0.770423 test: 0.777434
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  19 loss training:  27.910762146115303 Time :  1204
accuracy train: 0.983901 val: 0.752113 test: 0.781092
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  20 loss training:  25.06559656187892 Time :  1216
accuracy train: 0.985464 val: 0.753521 test: 0.774902
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  21 loss training:  22.192955426871777 Time :  1226
accuracy train: 0.988903 val: 0.753521 test: 0.777715
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  22 loss training:  18.2558559961617 Time :  1238
accuracy train: 0.989372 val: 0.760563 test: 0.775183
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  23 loss training:  16.12679623812437 Time :  1247
accuracy train: 0.995311 val: 0.763380 test: 0.768993
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  24 loss training:  14.397614315152168 Time :  1260
accuracy train: 0.989372 val: 0.756338 test: 0.771244
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  25 loss training:  13.166614059358835 Time :  1271
accuracy train: 0.992341 val: 0.750704 test: 0.766742
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  26 loss training:  12.511756367050111 Time :  1282
accuracy train: 0.995467 val: 0.752113 test: 0.770681
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  27 loss training:  11.775459854863584 Time :  1294
accuracy train: 0.990935 val: 0.746479 test: 0.764772
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  28 loss training:  9.328724956605583 Time :  1304
accuracy train: 0.996405 val: 0.756338 test: 0.767867
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  29 loss training:  7.170021802186966 Time :  1314
accuracy train: 0.994998 val: 0.753521 test: 0.768430
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  30 loss training:  6.607486734166741 Time :  1330
accuracy train: 0.997030 val: 0.750704 test: 0.768430
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  31 loss training:  5.7569291102699935 Time :  1343
accuracy train: 0.998750 val: 0.756338 test: 0.767023
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  32 loss training:  5.505184825975448 Time :  1353
accuracy train: 0.999219 val: 0.753521 test: 0.761396
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  33 loss training:  5.022269218228757 Time :  1363
accuracy train: 0.999531 val: 0.747887 test: 0.763928
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  34 loss training:  4.468902149703354 Time :  1375
accuracy train: 0.998593 val: 0.743662 test: 0.762240
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  35 loss training:  4.468560420209542 Time :  1385
accuracy train: 0.998437 val: 0.747887 test: 0.759989
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  36 loss training:  3.6856130498927087 Time :  1396
accuracy train: 0.999062 val: 0.745070 test: 0.761114
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  37 loss training:  3.898860895074904 Time :  1408
accuracy train: 0.999687 val: 0.752113 test: 0.761677
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  38 loss training:  2.76343292160891 Time :  1417
accuracy train: 0.999687 val: 0.746479 test: 0.754924
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  39 loss training:  3.3518840789911337 Time :  1429
accuracy train: 0.999844 val: 0.753521 test: 0.758582
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  40 loss training:  2.8361100513720885 Time :  1440
accuracy train: 0.999687 val: 0.743662 test: 0.755487
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  41 loss training:  2.1449504942283966 Time :  1450
accuracy train: 1.000000 val: 0.747887 test: 0.756612
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  42 loss training:  2.1744141714298166 Time :  1465
accuracy train: 0.999219 val: 0.745070 test: 0.755205
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  43 loss training:  1.9823488204856403 Time :  1476
accuracy train: 1.000000 val: 0.752113 test: 0.752673
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  44 loss training:  2.04431852477137 Time :  1487
accuracy train: 0.999687 val: 0.747887 test: 0.753236
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  45 loss training:  1.6271522071911022 Time :  1499
accuracy train: 1.000000 val: 0.747887 test: 0.755205
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  46 loss training:  2.0034626820415724 Time :  1509
accuracy train: 1.000000 val: 0.740845 test: 0.757175
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  47 loss training:  1.423065057490021 Time :  1520
accuracy train: 1.000000 val: 0.749296 test: 0.754361
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  48 loss training:  1.4166581418830901 Time :  1530
accuracy train: 1.000000 val: 0.752113 test: 0.749297
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

Epoch :  49 loss training:  1.3622088652919047 Time :  1542
accuracy train: 1.000000 val: 0.749296 test: 0.750141
max validation accuracy : 0.770423 max acc epoch : 18 test accuracy : 0.777434

========================================================================================================================================================================================================
max acc epoch :  18
max validation accuracy :  0.7704225352112676
test accuracy :  0.7774338773213281
last test_accuracy :  0.7501406865503658
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=174, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  100.12453216314316 Time :  1552
accuracy train: 0.762895 val: 0.721127 test: 0.753799
max validation accuracy : 0.721127 max acc epoch : 1 test accuracy : 0.753799
Epoch-1 lr: 0.005

Epoch :  2 loss training:  97.17499673366547 Time :  1561
accuracy train: 0.791654 val: 0.756338 test: 0.762802
max validation accuracy : 0.756338 max acc epoch : 2 test accuracy : 0.762802
Epoch-2 lr: 0.005

Epoch :  3 loss training:  91.56664630770683 Time :  1574
accuracy train: 0.801657 val: 0.753521 test: 0.753517
max validation accuracy : 0.756338 max acc epoch : 2 test accuracy : 0.762802
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  76.17480729520321 Time :  1587
accuracy train: 0.804783 val: 0.736620 test: 0.758019
max validation accuracy : 0.756338 max acc epoch : 2 test accuracy : 0.762802
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  72.74130199849606 Time :  1599
accuracy train: 0.842451 val: 0.759155 test: 0.778559
max validation accuracy : 0.759155 max acc epoch : 5 test accuracy : 0.778559
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  69.91652937233448 Time :  1606
accuracy train: 0.860738 val: 0.740845 test: 0.782499
max validation accuracy : 0.759155 max acc epoch : 5 test accuracy : 0.778559
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  62.66749261319637 Time :  1617
accuracy train: 0.843389 val: 0.728169 test: 0.762240
max validation accuracy : 0.759155 max acc epoch : 5 test accuracy : 0.778559
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  62.633413672447205 Time :  1629
accuracy train: 0.892154 val: 0.763380 test: 0.774057
max validation accuracy : 0.763380 max acc epoch : 8 test accuracy : 0.774057
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  63.27002203464508 Time :  1638
accuracy train: 0.883714 val: 0.756338 test: 0.768149
max validation accuracy : 0.763380 max acc epoch : 8 test accuracy : 0.774057
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  58.013773918151855 Time :  1650
accuracy train: 0.907940 val: 0.757746 test: 0.774902
max validation accuracy : 0.763380 max acc epoch : 8 test accuracy : 0.774057
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  55.16983675956726 Time :  1660
accuracy train: 0.916380 val: 0.761972 test: 0.776308
max validation accuracy : 0.763380 max acc epoch : 8 test accuracy : 0.774057
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  53.38632155954838 Time :  1671
accuracy train: 0.920131 val: 0.746479 test: 0.775464
max validation accuracy : 0.763380 max acc epoch : 8 test accuracy : 0.774057
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  50.59883600473404 Time :  1683
accuracy train: 0.921382 val: 0.747887 test: 0.769837
max validation accuracy : 0.763380 max acc epoch : 8 test accuracy : 0.774057
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  50.889450281858444 Time :  1692
accuracy train: 0.932323 val: 0.752113 test: 0.777153
max validation accuracy : 0.763380 max acc epoch : 8 test accuracy : 0.774057
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  49.55650623142719 Time :  1707
accuracy train: 0.937012 val: 0.759155 test: 0.773213
max validation accuracy : 0.763380 max acc epoch : 8 test accuracy : 0.774057

Epoch :  16 loss training:  47.7760257050395 Time :  1722
accuracy train: 0.952016 val: 0.759155 test: 0.773776
max validation accuracy : 0.763380 max acc epoch : 8 test accuracy : 0.774057

Epoch :  17 loss training:  41.66277536004782 Time :  1732
accuracy train: 0.962488 val: 0.757746 test: 0.776308
max validation accuracy : 0.763380 max acc epoch : 8 test accuracy : 0.774057

Epoch :  18 loss training:  37.47279051691294 Time :  1744
accuracy train: 0.974211 val: 0.763380 test: 0.776590
max validation accuracy : 0.763380 max acc epoch : 8 test accuracy : 0.774057

Epoch :  19 loss training:  33.947372786700726 Time :  1753
accuracy train: 0.977806 val: 0.754930 test: 0.777153
max validation accuracy : 0.763380 max acc epoch : 8 test accuracy : 0.774057

Epoch :  20 loss training:  28.515589252114296 Time :  1763
accuracy train: 0.985308 val: 0.761972 test: 0.776027
max validation accuracy : 0.763380 max acc epoch : 8 test accuracy : 0.774057

Epoch :  21 loss training:  25.189126022160053 Time :  1775
accuracy train: 0.990153 val: 0.760563 test: 0.776027
max validation accuracy : 0.763380 max acc epoch : 8 test accuracy : 0.774057

Epoch :  22 loss training:  22.17801082879305 Time :  1785
accuracy train: 0.992498 val: 0.759155 test: 0.772088
max validation accuracy : 0.763380 max acc epoch : 8 test accuracy : 0.774057

Epoch :  23 loss training:  18.72062173858285 Time :  1796
accuracy train: 0.994373 val: 0.764789 test: 0.768430
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  24 loss training:  16.351434405893087 Time :  1808
accuracy train: 0.994686 val: 0.753521 test: 0.768711
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  25 loss training:  14.353672409430146 Time :  1816
accuracy train: 0.997499 val: 0.756338 test: 0.765053
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  26 loss training:  13.139065757393837 Time :  1831
accuracy train: 0.997968 val: 0.747887 test: 0.763365
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  27 loss training:  11.079448960721493 Time :  1844
accuracy train: 0.998906 val: 0.747887 test: 0.762802
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  28 loss training:  10.054656658321619 Time :  1856
accuracy train: 0.999062 val: 0.754930 test: 0.763647
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  29 loss training:  8.734970198944211 Time :  1868
accuracy train: 0.999219 val: 0.746479 test: 0.758301
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  30 loss training:  7.392748665064573 Time :  1879
accuracy train: 0.999531 val: 0.750704 test: 0.759426
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  31 loss training:  6.7163445092737675 Time :  1892
accuracy train: 0.998750 val: 0.742254 test: 0.762802
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  32 loss training:  6.001061439979821 Time :  1901
accuracy train: 0.999687 val: 0.745070 test: 0.761114
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  33 loss training:  5.772539806552231 Time :  1913
accuracy train: 0.999844 val: 0.753521 test: 0.759989
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  34 loss training:  4.678588362410665 Time :  1921
accuracy train: 0.999844 val: 0.750704 test: 0.758019
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  35 loss training:  3.829110767925158 Time :  1932
accuracy train: 0.999844 val: 0.743662 test: 0.758019
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  36 loss training:  3.697328759357333 Time :  1943
accuracy train: 0.999844 val: 0.745070 test: 0.757738
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  37 loss training:  3.805274714482948 Time :  1956
accuracy train: 0.999844 val: 0.742254 test: 0.752673
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  38 loss training:  3.1735231857164763 Time :  1969
accuracy train: 0.999844 val: 0.746479 test: 0.756612
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  39 loss training:  2.8546258863061666 Time :  1980
accuracy train: 0.999844 val: 0.740845 test: 0.757456
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  40 loss training:  3.063166439475026 Time :  1991
accuracy train: 0.999844 val: 0.740845 test: 0.751548
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  41 loss training:  2.8231695670401677 Time :  2003
accuracy train: 1.000000 val: 0.747887 test: 0.754080
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  42 loss training:  2.578132088878192 Time :  2013
accuracy train: 1.000000 val: 0.742254 test: 0.755487
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  43 loss training:  2.318753426312469 Time :  2026
accuracy train: 1.000000 val: 0.754930 test: 0.750703
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  44 loss training:  1.9261631577974185 Time :  2038
accuracy train: 1.000000 val: 0.746479 test: 0.752392
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  45 loss training:  1.8961425629095174 Time :  2047
accuracy train: 1.000000 val: 0.746479 test: 0.753799
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  46 loss training:  1.6477795052924193 Time :  2060
accuracy train: 1.000000 val: 0.746479 test: 0.745639
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  47 loss training:  1.7366444225772284 Time :  2070
accuracy train: 1.000000 val: 0.756338 test: 0.748171
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  48 loss training:  1.5908147480804473 Time :  2087
accuracy train: 1.000000 val: 0.754930 test: 0.753799
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  49 loss training:  1.2764637956570368 Time :  2096
accuracy train: 1.000000 val: 0.753521 test: 0.747608
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  50 loss training:  1.1242713849642314 Time :  2108
accuracy train: 1.000000 val: 0.747887 test: 0.751829
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  51 loss training:  1.1209777383774053 Time :  2122
accuracy train: 1.000000 val: 0.750704 test: 0.748171
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  52 loss training:  1.0552034816646483 Time :  2134
accuracy train: 1.000000 val: 0.745070 test: 0.749297
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  53 loss training:  0.7092702572263079 Time :  2144
accuracy train: 1.000000 val: 0.743662 test: 0.746764
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

Epoch :  54 loss training:  1.0517391054308973 Time :  2156
accuracy train: 1.000000 val: 0.745070 test: 0.749015
max validation accuracy : 0.764789 max acc epoch : 23 test accuracy : 0.768430

========================================================================================================================================================================================================
max acc epoch :  23
max validation accuracy :  0.7647887323943662
test accuracy :  0.7684299380979178
last test_accuracy :  0.7490151941474396
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=174, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  99.94743385910988 Time :  2168
accuracy train: 0.665052 val: 0.628169 test: 0.650816
max validation accuracy : 0.628169 max acc epoch : 1 test accuracy : 0.650816
Epoch-1 lr: 0.005

Epoch :  2 loss training:  90.01036638021469 Time :  2179
accuracy train: 0.771491 val: 0.725352 test: 0.749578
max validation accuracy : 0.725352 max acc epoch : 2 test accuracy : 0.749578
Epoch-2 lr: 0.005

Epoch :  3 loss training:  88.06965497136116 Time :  2191
accuracy train: 0.797593 val: 0.738028 test: 0.748171
max validation accuracy : 0.738028 max acc epoch : 3 test accuracy : 0.748171
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  75.21769435703754 Time :  2200
accuracy train: 0.820413 val: 0.740845 test: 0.774057
max validation accuracy : 0.740845 max acc epoch : 4 test accuracy : 0.774057
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  71.23331677913666 Time :  2213
accuracy train: 0.856987 val: 0.745070 test: 0.774902
max validation accuracy : 0.745070 max acc epoch : 5 test accuracy : 0.774902
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  67.83665537834167 Time :  2226
accuracy train: 0.876524 val: 0.750704 test: 0.770681
max validation accuracy : 0.750704 max acc epoch : 6 test accuracy : 0.770681
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  59.6562996506691 Time :  2240
accuracy train: 0.864802 val: 0.743662 test: 0.768430
max validation accuracy : 0.750704 max acc epoch : 6 test accuracy : 0.770681
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  58.22934032976627 Time :  2252
accuracy train: 0.895592 val: 0.757746 test: 0.764209
max validation accuracy : 0.757746 max acc epoch : 8 test accuracy : 0.764209
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  56.86564742028713 Time :  2265
accuracy train: 0.907158 val: 0.749296 test: 0.771806
max validation accuracy : 0.757746 max acc epoch : 8 test accuracy : 0.764209
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  52.01572771370411 Time :  2274
accuracy train: 0.853704 val: 0.756338 test: 0.768149
max validation accuracy : 0.757746 max acc epoch : 8 test accuracy : 0.764209
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  50.43747279047966 Time :  2286
accuracy train: 0.872304 val: 0.754930 test: 0.766179
max validation accuracy : 0.757746 max acc epoch : 8 test accuracy : 0.764209
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  47.163570798933506 Time :  2296
accuracy train: 0.937324 val: 0.759155 test: 0.777715
max validation accuracy : 0.759155 max acc epoch : 12 test accuracy : 0.777715
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  45.43462918698788 Time :  2307
accuracy train: 0.939512 val: 0.749296 test: 0.779966
max validation accuracy : 0.759155 max acc epoch : 12 test accuracy : 0.777715
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  44.70774073898792 Time :  2318
accuracy train: 0.937324 val: 0.756338 test: 0.773213
max validation accuracy : 0.759155 max acc epoch : 12 test accuracy : 0.777715
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  43.84099765866995 Time :  2327
accuracy train: 0.952016 val: 0.759155 test: 0.780248
max validation accuracy : 0.759155 max acc epoch : 12 test accuracy : 0.777715

Epoch :  16 loss training:  43.06831180304289 Time :  2340
accuracy train: 0.958268 val: 0.756338 test: 0.775183
max validation accuracy : 0.759155 max acc epoch : 12 test accuracy : 0.777715

Epoch :  17 loss training:  35.65843468159437 Time :  2349
accuracy train: 0.969365 val: 0.763380 test: 0.780248
max validation accuracy : 0.763380 max acc epoch : 17 test accuracy : 0.780248

Epoch :  18 loss training:  32.71424287557602 Time :  2367
accuracy train: 0.974367 val: 0.759155 test: 0.772932
max validation accuracy : 0.763380 max acc epoch : 17 test accuracy : 0.780248

Epoch :  19 loss training:  29.216289944946766 Time :  2379
accuracy train: 0.983432 val: 0.769014 test: 0.776027
max validation accuracy : 0.769014 max acc epoch : 19 test accuracy : 0.776027

Epoch :  20 loss training:  25.684255849570036 Time :  2391
accuracy train: 0.985621 val: 0.773239 test: 0.770962
max validation accuracy : 0.773239 max acc epoch : 20 test accuracy : 0.770962

Epoch :  21 loss training:  22.3299822807312 Time :  2403
accuracy train: 0.989059 val: 0.769014 test: 0.777997
max validation accuracy : 0.773239 max acc epoch : 20 test accuracy : 0.770962

Epoch :  22 loss training:  19.08673333749175 Time :  2413
accuracy train: 0.993279 val: 0.776056 test: 0.772932
max validation accuracy : 0.776056 max acc epoch : 22 test accuracy : 0.772932

Epoch :  23 loss training:  16.993467962369323 Time :  2426
accuracy train: 0.991872 val: 0.763380 test: 0.764209
max validation accuracy : 0.776056 max acc epoch : 22 test accuracy : 0.772932

Epoch :  24 loss training:  15.513832651078701 Time :  2436
accuracy train: 0.995936 val: 0.773239 test: 0.770118
max validation accuracy : 0.776056 max acc epoch : 22 test accuracy : 0.772932

Epoch :  25 loss training:  13.262727415189147 Time :  2448
accuracy train: 0.998124 val: 0.778873 test: 0.763928
max validation accuracy : 0.778873 max acc epoch : 25 test accuracy : 0.763928

Epoch :  26 loss training:  12.107015473768115 Time :  2459
accuracy train: 0.998281 val: 0.766197 test: 0.762802
max validation accuracy : 0.778873 max acc epoch : 25 test accuracy : 0.763928

Epoch :  27 loss training:  10.461210010573268 Time :  2466
accuracy train: 0.998593 val: 0.764789 test: 0.764209
max validation accuracy : 0.778873 max acc epoch : 25 test accuracy : 0.763928

Epoch :  28 loss training:  9.089009701274335 Time :  2479
accuracy train: 0.979837 val: 0.770423 test: 0.765335
max validation accuracy : 0.778873 max acc epoch : 25 test accuracy : 0.763928

Epoch :  29 loss training:  8.244742538779974 Time :  2492
accuracy train: 0.982963 val: 0.767606 test: 0.767304
max validation accuracy : 0.778873 max acc epoch : 25 test accuracy : 0.763928

Epoch :  30 loss training:  7.148434585891664 Time :  2503
accuracy train: 0.983745 val: 0.781690 test: 0.767586
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  31 loss training:  6.450264851562679 Time :  2516
accuracy train: 0.978274 val: 0.747887 test: 0.750141
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  32 loss training:  6.277699158992618 Time :  2525
accuracy train: 0.998906 val: 0.774648 test: 0.762521
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  33 loss training:  5.317280277609825 Time :  2538
accuracy train: 0.999531 val: 0.754930 test: 0.760270
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  34 loss training:  4.78191197803244 Time :  2549
accuracy train: 0.990622 val: 0.756338 test: 0.758863
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  35 loss training:  3.839925650972873 Time :  2558
accuracy train: 0.999687 val: 0.763380 test: 0.763928
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  36 loss training:  3.7456559571437538 Time :  2567
accuracy train: 0.999531 val: 0.759155 test: 0.759707
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  37 loss training:  3.253615628229454 Time :  2576
accuracy train: 0.999687 val: 0.761972 test: 0.759145
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  38 loss training:  2.7971752879675478 Time :  2583
accuracy train: 0.999531 val: 0.756338 test: 0.758582
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  39 loss training:  3.1078134453855455 Time :  2596
accuracy train: 0.999062 val: 0.759155 test: 0.759707
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  40 loss training:  2.8277468531159684 Time :  2605
accuracy train: 0.999687 val: 0.750704 test: 0.765335
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  41 loss training:  2.6102902052225545 Time :  2614
accuracy train: 0.999844 val: 0.767606 test: 0.763647
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  42 loss training:  2.468024982721545 Time :  2624
accuracy train: 0.999687 val: 0.754930 test: 0.759145
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  43 loss training:  2.0288812431972474 Time :  2634
accuracy train: 0.999687 val: 0.756338 test: 0.758582
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  44 loss training:  1.7121049613924697 Time :  2643
accuracy train: 0.999687 val: 0.759155 test: 0.757456
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  45 loss training:  1.8117527124122716 Time :  2652
accuracy train: 0.999844 val: 0.761972 test: 0.754643
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  46 loss training:  1.643962442612974 Time :  2661
accuracy train: 0.999844 val: 0.759155 test: 0.760551
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  47 loss training:  1.3617757093161345 Time :  2670
accuracy train: 0.999844 val: 0.756338 test: 0.758582
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  48 loss training:  1.5662579062627628 Time :  2683
accuracy train: 0.999687 val: 0.770423 test: 0.758301
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  49 loss training:  1.3742769426607993 Time :  2692
accuracy train: 0.999687 val: 0.771831 test: 0.756612
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  50 loss training:  1.3991777151532006 Time :  2701
accuracy train: 0.999687 val: 0.770423 test: 0.758301
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  51 loss training:  0.8666582543810364 Time :  2710
accuracy train: 0.999687 val: 0.763380 test: 0.757456
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  52 loss training:  1.014367131923791 Time :  2719
accuracy train: 0.999531 val: 0.766197 test: 0.756050
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  53 loss training:  0.750443455966888 Time :  2727
accuracy train: 0.999844 val: 0.766197 test: 0.758019
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  54 loss training:  1.233615106160869 Time :  2736
accuracy train: 0.999844 val: 0.757746 test: 0.757738
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  55 loss training:  1.072787128345226 Time :  2745
accuracy train: 0.999844 val: 0.766197 test: 0.757175
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  56 loss training:  0.8501224927458679 Time :  2754
accuracy train: 0.999844 val: 0.766197 test: 0.754924
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  57 loss training:  0.9947248768003192 Time :  2763
accuracy train: 0.999844 val: 0.767606 test: 0.752110
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  58 loss training:  0.9679106580151711 Time :  2776
accuracy train: 0.999844 val: 0.760563 test: 0.752673
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  59 loss training:  0.8817141995968996 Time :  2785
accuracy train: 1.000000 val: 0.760563 test: 0.757738
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  60 loss training:  0.636145611453685 Time :  2794
accuracy train: 1.000000 val: 0.771831 test: 0.754924
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

Epoch :  61 loss training:  0.48174420252325945 Time :  2803
accuracy train: 0.999844 val: 0.763380 test: 0.755768
max validation accuracy : 0.781690 max acc epoch : 30 test accuracy : 0.767586

========================================================================================================================================================================================================
max acc epoch :  30
max validation accuracy :  0.7816901408450704
test accuracy :  0.7675858187957231
last test_accuracy :  0.7557681485649972
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=174, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  99.94690918922424 Time :  2812
accuracy train: 0.648953 val: 0.632394 test: 0.638154
max validation accuracy : 0.632394 max acc epoch : 1 test accuracy : 0.638154
Epoch-1 lr: 0.005

Epoch :  2 loss training:  88.52738252282143 Time :  2822
accuracy train: 0.793217 val: 0.723944 test: 0.767867
max validation accuracy : 0.723944 max acc epoch : 2 test accuracy : 0.767867
Epoch-2 lr: 0.005

Epoch :  3 loss training:  86.46748438477516 Time :  2830
accuracy train: 0.676305 val: 0.652113 test: 0.655599
max validation accuracy : 0.723944 max acc epoch : 2 test accuracy : 0.767867
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  74.02403362095356 Time :  2839
accuracy train: 0.762426 val: 0.687324 test: 0.732696
max validation accuracy : 0.723944 max acc epoch : 2 test accuracy : 0.767867
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  70.49922828376293 Time :  2848
accuracy train: 0.855111 val: 0.749296 test: 0.780529
max validation accuracy : 0.749296 max acc epoch : 5 test accuracy : 0.780529
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  66.75190630555153 Time :  2856
accuracy train: 0.882463 val: 0.756338 test: 0.774057
max validation accuracy : 0.756338 max acc epoch : 6 test accuracy : 0.774057
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  59.379174277186394 Time :  2869
accuracy train: 0.856987 val: 0.749296 test: 0.764209
max validation accuracy : 0.756338 max acc epoch : 6 test accuracy : 0.774057
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  57.792546570301056 Time :  2878
accuracy train: 0.907627 val: 0.757746 test: 0.776590
max validation accuracy : 0.757746 max acc epoch : 8 test accuracy : 0.776590
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  53.531297117471695 Time :  2887
accuracy train: 0.867927 val: 0.735211 test: 0.739449
max validation accuracy : 0.757746 max acc epoch : 8 test accuracy : 0.776590
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  49.40711607038975 Time :  2896
accuracy train: 0.915599 val: 0.756338 test: 0.768993
max validation accuracy : 0.757746 max acc epoch : 8 test accuracy : 0.776590
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  46.47734101116657 Time :  2905
accuracy train: 0.935449 val: 0.756338 test: 0.774339
max validation accuracy : 0.757746 max acc epoch : 8 test accuracy : 0.776590
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  44.58276055753231 Time :  2914
accuracy train: 0.935761 val: 0.761972 test: 0.773495
max validation accuracy : 0.761972 max acc epoch : 12 test accuracy : 0.773495
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  42.34264871478081 Time :  2922
accuracy train: 0.942482 val: 0.752113 test: 0.774620
max validation accuracy : 0.761972 max acc epoch : 12 test accuracy : 0.773495
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  40.76162542402744 Time :  2930
accuracy train: 0.946233 val: 0.756338 test: 0.775464
max validation accuracy : 0.761972 max acc epoch : 12 test accuracy : 0.773495
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  39.0656069368124 Time :  2936
accuracy train: 0.949359 val: 0.756338 test: 0.772088
max validation accuracy : 0.761972 max acc epoch : 12 test accuracy : 0.773495

Epoch :  16 loss training:  38.89196689426899 Time :  2945
accuracy train: 0.959831 val: 0.760563 test: 0.777997
max validation accuracy : 0.761972 max acc epoch : 12 test accuracy : 0.773495

Epoch :  17 loss training:  33.20093712210655 Time :  2958
accuracy train: 0.963739 val: 0.763380 test: 0.774057
max validation accuracy : 0.763380 max acc epoch : 17 test accuracy : 0.774057

Epoch :  18 loss training:  29.358340971171856 Time :  2967
accuracy train: 0.950922 val: 0.760563 test: 0.754080
max validation accuracy : 0.763380 max acc epoch : 17 test accuracy : 0.774057

Epoch :  19 loss training:  25.36785974726081 Time :  2977
accuracy train: 0.969053 val: 0.745070 test: 0.767023
max validation accuracy : 0.763380 max acc epoch : 17 test accuracy : 0.774057

Epoch :  20 loss training:  22.47945185378194 Time :  2989
accuracy train: 0.992029 val: 0.760563 test: 0.770962
max validation accuracy : 0.763380 max acc epoch : 17 test accuracy : 0.774057

Epoch :  21 loss training:  19.47150232642889 Time :  2998
accuracy train: 0.994217 val: 0.766197 test: 0.772088
max validation accuracy : 0.766197 max acc epoch : 21 test accuracy : 0.772088

Epoch :  22 loss training:  16.813108444213867 Time :  3009
accuracy train: 0.996405 val: 0.769014 test: 0.768993
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  23 loss training:  15.065031608566642 Time :  3020
accuracy train: 0.996405 val: 0.766197 test: 0.764772
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  24 loss training:  13.639577455818653 Time :  3028
accuracy train: 0.997343 val: 0.766197 test: 0.768993
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  25 loss training:  11.338747214525938 Time :  3039
accuracy train: 0.998750 val: 0.764789 test: 0.761114
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  26 loss training:  10.094221404753625 Time :  3050
accuracy train: 0.998593 val: 0.754930 test: 0.761114
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  27 loss training:  8.935576639603823 Time :  3063
accuracy train: 0.998750 val: 0.761972 test: 0.755487
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  28 loss training:  7.673711355775595 Time :  3072
accuracy train: 0.999062 val: 0.760563 test: 0.764491
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  29 loss training:  6.689819872844964 Time :  3083
accuracy train: 0.998593 val: 0.750704 test: 0.757738
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  30 loss training:  6.119655586779118 Time :  3094
accuracy train: 0.999062 val: 0.757746 test: 0.762802
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  31 loss training:  5.24293610220775 Time :  3103
accuracy train: 0.999375 val: 0.757746 test: 0.761114
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  32 loss training:  4.693671229761094 Time :  3114
accuracy train: 0.999531 val: 0.759155 test: 0.757456
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  33 loss training:  4.636747186537832 Time :  3124
accuracy train: 0.999375 val: 0.753521 test: 0.759145
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  34 loss training:  3.847517484333366 Time :  3131
accuracy train: 0.999375 val: 0.760563 test: 0.763365
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  35 loss training:  3.222122051520273 Time :  3142
accuracy train: 0.999531 val: 0.756338 test: 0.762240
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  36 loss training:  2.8667352497577667 Time :  3152
accuracy train: 0.999375 val: 0.756338 test: 0.760551
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  37 loss training:  2.964921394304838 Time :  3165
accuracy train: 0.999844 val: 0.747887 test: 0.758863
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  38 loss training:  2.7852753501501866 Time :  3176
accuracy train: 0.999687 val: 0.759155 test: 0.755205
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  39 loss training:  2.4425149724120274 Time :  3187
accuracy train: 0.999687 val: 0.763380 test: 0.760833
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  40 loss training:  2.050005798228085 Time :  3197
accuracy train: 0.999844 val: 0.752113 test: 0.757175
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  41 loss training:  2.235217501176521 Time :  3207
accuracy train: 1.000000 val: 0.759155 test: 0.748734
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  42 loss training:  2.339750558603555 Time :  3217
accuracy train: 1.000000 val: 0.759155 test: 0.753236
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  43 loss training:  1.6889788242406212 Time :  3228
accuracy train: 0.999687 val: 0.750704 test: 0.753799
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  44 loss training:  1.5592443001805805 Time :  3237
accuracy train: 1.000000 val: 0.752113 test: 0.750703
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  45 loss training:  1.486957875546068 Time :  3248
accuracy train: 1.000000 val: 0.745070 test: 0.753517
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  46 loss training:  1.4656221443437971 Time :  3258
accuracy train: 0.999375 val: 0.743662 test: 0.746201
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  47 loss training:  1.464235741237644 Time :  3269
accuracy train: 0.999531 val: 0.745070 test: 0.753799
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  48 loss training:  1.3991305767849553 Time :  3282
accuracy train: 0.999531 val: 0.729577 test: 0.745920
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  49 loss training:  1.093901413230924 Time :  3293
accuracy train: 0.999687 val: 0.767606 test: 0.750703
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  50 loss training:  1.2423131488612853 Time :  3301
accuracy train: 1.000000 val: 0.757746 test: 0.748452
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  51 loss training:  1.0402181794779608 Time :  3313
accuracy train: 1.000000 val: 0.739437 test: 0.742544
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  52 loss training:  1.0241385201952653 Time :  3323
accuracy train: 0.999687 val: 0.749296 test: 0.746764
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

Epoch :  53 loss training:  0.9858914661745075 Time :  3332
accuracy train: 0.999844 val: 0.749296 test: 0.746483
max validation accuracy : 0.769014 max acc epoch : 22 test accuracy : 0.768993

========================================================================================================================================================================================================
max acc epoch :  22
max validation accuracy :  0.7690140845070422
test accuracy :  0.768992684299381
last test_accuracy :  0.7464828362408554
========================================================================================================================================================================================================

itr : 6
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=174, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  100.61030554771423 Time :  3344
accuracy train: 0.704283 val: 0.681690 test: 0.703151
max validation accuracy : 0.681690 max acc epoch : 1 test accuracy : 0.703151
Epoch-1 lr: 0.005

Epoch :  2 loss training:  95.3159786760807 Time :  3355
accuracy train: 0.725227 val: 0.705634 test: 0.709060
max validation accuracy : 0.705634 max acc epoch : 2 test accuracy : 0.709060
Epoch-2 lr: 0.005

Epoch :  3 loss training:  90.41838936507702 Time :  3365
accuracy train: 0.793373 val: 0.742254 test: 0.773495
max validation accuracy : 0.742254 max acc epoch : 3 test accuracy : 0.773495
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  82.0497714728117 Time :  3377
accuracy train: 0.728822 val: 0.678873 test: 0.705965
max validation accuracy : 0.742254 max acc epoch : 3 test accuracy : 0.773495
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  78.13592246174812 Time :  3388
accuracy train: 0.786965 val: 0.739437 test: 0.757175
max validation accuracy : 0.742254 max acc epoch : 3 test accuracy : 0.773495
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  75.31470802426338 Time :  3398
accuracy train: 0.823539 val: 0.764789 test: 0.781092
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.781092
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  69.6425546258688 Time :  3407
accuracy train: 0.781025 val: 0.733803 test: 0.740011
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.781092
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  71.13803024590015 Time :  3417
accuracy train: 0.767271 val: 0.712676 test: 0.727631
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.781092
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  69.37689743936062 Time :  3427
accuracy train: 0.826821 val: 0.747887 test: 0.768149
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.781092
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  66.68828682601452 Time :  3436
accuracy train: 0.834011 val: 0.766197 test: 0.774339
max validation accuracy : 0.766197 max acc epoch : 10 test accuracy : 0.774339
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  64.74507549405098 Time :  3446
accuracy train: 0.854955 val: 0.777465 test: 0.778841
max validation accuracy : 0.777465 max acc epoch : 11 test accuracy : 0.778841
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  64.08486299216747 Time :  3457
accuracy train: 0.862457 val: 0.773239 test: 0.771806
max validation accuracy : 0.777465 max acc epoch : 11 test accuracy : 0.778841
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  62.52428683638573 Time :  3465
accuracy train: 0.847452 val: 0.760563 test: 0.779122
max validation accuracy : 0.777465 max acc epoch : 11 test accuracy : 0.778841
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  62.55648826062679 Time :  3476
accuracy train: 0.855111 val: 0.770423 test: 0.776590
max validation accuracy : 0.777465 max acc epoch : 11 test accuracy : 0.778841
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  61.132155656814575 Time :  3490
accuracy train: 0.844483 val: 0.760563 test: 0.767586
max validation accuracy : 0.777465 max acc epoch : 11 test accuracy : 0.778841

Epoch :  16 loss training:  60.64022195339203 Time :  3499
accuracy train: 0.884808 val: 0.767606 test: 0.781373
max validation accuracy : 0.777465 max acc epoch : 11 test accuracy : 0.778841

Epoch :  17 loss training:  53.05581693351269 Time :  3509
accuracy train: 0.905439 val: 0.774648 test: 0.784187
max validation accuracy : 0.777465 max acc epoch : 11 test accuracy : 0.778841

Epoch :  18 loss training:  48.516293317079544 Time :  3519
accuracy train: 0.926071 val: 0.766197 test: 0.781373
max validation accuracy : 0.777465 max acc epoch : 11 test accuracy : 0.778841

Epoch :  19 loss training:  44.09854577481747 Time :  3528
accuracy train: 0.936074 val: 0.774648 test: 0.783343
max validation accuracy : 0.777465 max acc epoch : 11 test accuracy : 0.778841

Epoch :  20 loss training:  39.369330018758774 Time :  3538
accuracy train: 0.955611 val: 0.781690 test: 0.785594
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  21 loss training:  34.25923351198435 Time :  3549
accuracy train: 0.950610 val: 0.770423 test: 0.777997
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  22 loss training:  29.73477677255869 Time :  3560
accuracy train: 0.951078 val: 0.760563 test: 0.769837
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  23 loss training:  26.362301845103502 Time :  3568
accuracy train: 0.945921 val: 0.749296 test: 0.764772
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  24 loss training:  23.072732731699944 Time :  3579
accuracy train: 0.981088 val: 0.766197 test: 0.774339
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  25 loss training:  19.57860854640603 Time :  3594
accuracy train: 0.987965 val: 0.771831 test: 0.772369
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  26 loss training:  17.690417790785432 Time :  3603
accuracy train: 0.982026 val: 0.764789 test: 0.770118
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  27 loss training:  14.981382919475436 Time :  3615
accuracy train: 0.983589 val: 0.770423 test: 0.767867
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  28 loss training:  12.632866630330682 Time :  3625
accuracy train: 0.994686 val: 0.769014 test: 0.766460
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  29 loss training:  11.11241077631712 Time :  3635
accuracy train: 0.994373 val: 0.771831 test: 0.766742
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  30 loss training:  9.403863029554486 Time :  3646
accuracy train: 0.994217 val: 0.769014 test: 0.765616
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  31 loss training:  8.06581285316497 Time :  3656
accuracy train: 0.993592 val: 0.767606 test: 0.765053
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  32 loss training:  8.072813247330487 Time :  3664
accuracy train: 0.995624 val: 0.769014 test: 0.760551
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  33 loss training:  6.5612414022907615 Time :  3674
accuracy train: 0.996874 val: 0.764789 test: 0.761114
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  34 loss training:  6.081734029576182 Time :  3685
accuracy train: 0.988903 val: 0.756338 test: 0.746483
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  35 loss training:  5.330404086969793 Time :  3698
accuracy train: 0.999062 val: 0.764789 test: 0.754924
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  36 loss training:  4.48166315513663 Time :  3707
accuracy train: 0.997030 val: 0.760563 test: 0.756331
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  37 loss training:  4.644103110069409 Time :  3718
accuracy train: 0.999687 val: 0.764789 test: 0.757456
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  38 loss training:  3.930760976509191 Time :  3729
accuracy train: 0.997968 val: 0.769014 test: 0.756331
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  39 loss training:  3.3091868876945227 Time :  3738
accuracy train: 0.998906 val: 0.761972 test: 0.758582
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  40 loss training:  2.797881086822599 Time :  3749
accuracy train: 0.999375 val: 0.767606 test: 0.756894
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  41 loss training:  3.0108861855696887 Time :  3759
accuracy train: 0.999531 val: 0.767606 test: 0.756894
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  42 loss training:  2.629896862024907 Time :  3768
accuracy train: 0.998281 val: 0.756338 test: 0.747890
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  43 loss training:  2.4040904782013968 Time :  3777
accuracy train: 0.999687 val: 0.756338 test: 0.756612
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  44 loss training:  2.2774228912894614 Time :  3788
accuracy train: 0.999687 val: 0.764789 test: 0.753799
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  45 loss training:  2.2990858563571237 Time :  3797
accuracy train: 0.999844 val: 0.767606 test: 0.756894
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  46 loss training:  1.9050170672126114 Time :  3808
accuracy train: 0.999375 val: 0.760563 test: 0.750141
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  47 loss training:  1.7373092168127187 Time :  3820
accuracy train: 0.999844 val: 0.771831 test: 0.754080
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  48 loss training:  2.019042493237066 Time :  3830
accuracy train: 0.999844 val: 0.757746 test: 0.750703
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  49 loss training:  1.2820098996162415 Time :  3839
accuracy train: 0.999844 val: 0.769014 test: 0.754361
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  50 loss training:  1.381250715116039 Time :  3850
accuracy train: 0.999844 val: 0.756338 test: 0.752954
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

Epoch :  51 loss training:  1.3954070063773543 Time :  3859
accuracy train: 0.999844 val: 0.761972 test: 0.751829
max validation accuracy : 0.781690 max acc epoch : 20 test accuracy : 0.785594

========================================================================================================================================================================================================
max acc epoch :  20
max validation accuracy :  0.7816901408450704
test accuracy :  0.7855936972425436
last test_accuracy :  0.7518289251547552
========================================================================================================================================================================================================

itr : 7
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=174, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  100.54041910171509 Time :  3870
accuracy train: 0.725383 val: 0.676056 test: 0.716376
max validation accuracy : 0.676056 max acc epoch : 1 test accuracy : 0.716376
Epoch-1 lr: 0.005

Epoch :  2 loss training:  92.78688292205334 Time :  3879
accuracy train: 0.679275 val: 0.657746 test: 0.657569
max validation accuracy : 0.676056 max acc epoch : 1 test accuracy : 0.716376
Epoch-2 lr: 0.005

Epoch :  3 loss training:  90.10469642281532 Time :  3889
accuracy train: 0.787277 val: 0.742254 test: 0.746483
max validation accuracy : 0.742254 max acc epoch : 3 test accuracy : 0.746483
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  77.47628250718117 Time :  3898
accuracy train: 0.806189 val: 0.742254 test: 0.765898
max validation accuracy : 0.742254 max acc epoch : 3 test accuracy : 0.746483
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  80.4638386964798 Time :  3908
accuracy train: 0.808378 val: 0.745070 test: 0.771525
max validation accuracy : 0.745070 max acc epoch : 5 test accuracy : 0.771525
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  78.38983446359634 Time :  3920
accuracy train: 0.829478 val: 0.763380 test: 0.777715
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.777715
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  73.08213160932064 Time :  3931
accuracy train: 0.820569 val: 0.746479 test: 0.771525
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.777715
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  74.92528662085533 Time :  3941
accuracy train: 0.836824 val: 0.767606 test: 0.779122
max validation accuracy : 0.767606 max acc epoch : 8 test accuracy : 0.779122
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  72.37448731064796 Time :  3951
accuracy train: 0.825570 val: 0.770423 test: 0.770400
max validation accuracy : 0.770423 max acc epoch : 9 test accuracy : 0.770400
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  70.63058285415173 Time :  3961
accuracy train: 0.845420 val: 0.767606 test: 0.780810
max validation accuracy : 0.770423 max acc epoch : 9 test accuracy : 0.770400
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  69.15844313800335 Time :  3971
accuracy train: 0.840575 val: 0.757746 test: 0.785594
max validation accuracy : 0.770423 max acc epoch : 9 test accuracy : 0.770400
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  68.14350897073746 Time :  3981
accuracy train: 0.849953 val: 0.766197 test: 0.778559
max validation accuracy : 0.770423 max acc epoch : 9 test accuracy : 0.770400
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  67.98164680600166 Time :  3991
accuracy train: 0.853079 val: 0.769014 test: 0.780529
max validation accuracy : 0.770423 max acc epoch : 9 test accuracy : 0.770400
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  68.26914502680302 Time :  4001
accuracy train: 0.847765 val: 0.766197 test: 0.774339
max validation accuracy : 0.770423 max acc epoch : 9 test accuracy : 0.770400
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  67.65785747766495 Time :  4011
accuracy train: 0.858393 val: 0.767606 test: 0.779122
max validation accuracy : 0.770423 max acc epoch : 9 test accuracy : 0.770400

Epoch :  16 loss training:  67.51856856048107 Time :  4021
accuracy train: 0.870585 val: 0.771831 test: 0.779685
max validation accuracy : 0.771831 max acc epoch : 16 test accuracy : 0.779685

Epoch :  17 loss training:  60.10388608276844 Time :  4032
accuracy train: 0.893404 val: 0.773239 test: 0.786438
max validation accuracy : 0.773239 max acc epoch : 17 test accuracy : 0.786438

Epoch :  18 loss training:  55.47726196050644 Time :  4042
accuracy train: 0.904658 val: 0.783099 test: 0.783061
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  19 loss training:  51.57773606479168 Time :  4052
accuracy train: 0.917631 val: 0.770423 test: 0.784187
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  20 loss training:  47.193339839577675 Time :  4063
accuracy train: 0.933573 val: 0.777465 test: 0.781654
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  21 loss training:  42.05534457415342 Time :  4072
accuracy train: 0.937637 val: 0.771831 test: 0.787563
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  22 loss training:  37.949683271348476 Time :  4083
accuracy train: 0.953267 val: 0.778873 test: 0.781654
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  23 loss training:  34.48050977289677 Time :  4093
accuracy train: 0.961707 val: 0.767606 test: 0.773776
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  24 loss training:  30.912580873817205 Time :  4103
accuracy train: 0.966396 val: 0.770423 test: 0.778841
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  25 loss training:  27.500946037471294 Time :  4113
accuracy train: 0.964989 val: 0.769014 test: 0.770962
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  26 loss training:  24.322494819760323 Time :  4123
accuracy train: 0.977962 val: 0.754930 test: 0.771244
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  27 loss training:  21.720736045390368 Time :  4134
accuracy train: 0.980932 val: 0.761972 test: 0.771525
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  28 loss training:  20.245974704623222 Time :  4146
accuracy train: 0.984683 val: 0.757746 test: 0.772088
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  29 loss training:  17.299955831840634 Time :  4155
accuracy train: 0.986246 val: 0.767606 test: 0.765335
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  30 loss training:  15.86463519372046 Time :  4166
accuracy train: 0.988434 val: 0.753521 test: 0.762802
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  31 loss training:  13.222074296325445 Time :  4176
accuracy train: 0.990309 val: 0.753521 test: 0.764491
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  32 loss training:  12.691903803497553 Time :  4186
accuracy train: 0.990622 val: 0.749296 test: 0.759707
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  33 loss training:  11.346301386132836 Time :  4196
accuracy train: 0.992029 val: 0.752113 test: 0.765053
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  34 loss training:  10.33059123903513 Time :  4207
accuracy train: 0.994842 val: 0.756338 test: 0.758019
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  35 loss training:  9.512783348560333 Time :  4218
accuracy train: 0.995155 val: 0.750704 test: 0.759426
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  36 loss training:  7.90929319197312 Time :  4227
accuracy train: 0.995311 val: 0.750704 test: 0.757738
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  37 loss training:  6.994893238414079 Time :  4237
accuracy train: 0.994686 val: 0.738028 test: 0.748734
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  38 loss training:  6.72958461754024 Time :  4248
accuracy train: 0.998281 val: 0.742254 test: 0.756331
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  39 loss training:  5.974215479101986 Time :  4259
accuracy train: 0.995624 val: 0.729577 test: 0.751266
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  40 loss training:  5.630700067151338 Time :  4270
accuracy train: 0.997343 val: 0.742254 test: 0.751548
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  41 loss training:  4.967882865574211 Time :  4279
accuracy train: 0.997499 val: 0.745070 test: 0.749578
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  42 loss training:  4.96719139139168 Time :  4290
accuracy train: 0.998906 val: 0.749296 test: 0.750985
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  43 loss training:  4.468741812277585 Time :  4300
accuracy train: 0.998593 val: 0.742254 test: 0.755768
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  44 loss training:  3.733382193837315 Time :  4310
accuracy train: 0.999062 val: 0.747887 test: 0.753517
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  45 loss training:  3.566282993997447 Time :  4319
accuracy train: 0.997656 val: 0.738028 test: 0.753799
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  46 loss training:  3.3178750948864035 Time :  4328
accuracy train: 0.996561 val: 0.721127 test: 0.749297
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  47 loss training:  2.7838567722355947 Time :  4339
accuracy train: 0.999531 val: 0.743662 test: 0.749015
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  48 loss training:  2.694322401890531 Time :  4348
accuracy train: 0.999375 val: 0.750704 test: 0.747327
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

Epoch :  49 loss training:  2.4532039486803114 Time :  4359
accuracy train: 0.999687 val: 0.740845 test: 0.748452
max validation accuracy : 0.783099 max acc epoch : 18 test accuracy : 0.783061

========================================================================================================================================================================================================
max acc epoch :  18
max validation accuracy :  0.7830985915492957
test accuracy :  0.7830613393359594
last test_accuracy :  0.7484524479459763
========================================================================================================================================================================================================

itr : 8
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=174, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  101.06422704458237 Time :  4371
accuracy train: 0.587684 val: 0.570423 test: 0.584131
max validation accuracy : 0.570423 max acc epoch : 1 test accuracy : 0.584131
Epoch-1 lr: 0.005

Epoch :  2 loss training:  94.49134358763695 Time :  4381
accuracy train: 0.699437 val: 0.676056 test: 0.670512
max validation accuracy : 0.676056 max acc epoch : 2 test accuracy : 0.670512
Epoch-2 lr: 0.005

Epoch :  3 loss training:  93.1902901083231 Time :  4390
accuracy train: 0.691466 val: 0.670423 test: 0.666573
max validation accuracy : 0.676056 max acc epoch : 2 test accuracy : 0.670512
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  79.79940505325794 Time :  4401
accuracy train: 0.728978 val: 0.676056 test: 0.705121
max validation accuracy : 0.676056 max acc epoch : 2 test accuracy : 0.670512
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  75.52167496085167 Time :  4410
accuracy train: 0.692248 val: 0.654930 test: 0.674733
max validation accuracy : 0.676056 max acc epoch : 2 test accuracy : 0.670512
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  73.69488495588303 Time :  4420
accuracy train: 0.809628 val: 0.739437 test: 0.769274
max validation accuracy : 0.739437 max acc epoch : 6 test accuracy : 0.769274
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  67.17216356098652 Time :  4430
accuracy train: 0.753673 val: 0.695775 test: 0.717783
max validation accuracy : 0.739437 max acc epoch : 6 test accuracy : 0.769274
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  68.08053541183472 Time :  4440
accuracy train: 0.826977 val: 0.757746 test: 0.762521
max validation accuracy : 0.757746 max acc epoch : 8 test accuracy : 0.762521
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  65.05516476929188 Time :  4450
accuracy train: 0.713192 val: 0.692958 test: 0.680079
max validation accuracy : 0.757746 max acc epoch : 8 test accuracy : 0.762521
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  61.935538694262505 Time :  4460
accuracy train: 0.815098 val: 0.738028 test: 0.758582
max validation accuracy : 0.757746 max acc epoch : 8 test accuracy : 0.762521
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  59.46460349857807 Time :  4470
accuracy train: 0.829165 val: 0.756338 test: 0.764772
max validation accuracy : 0.757746 max acc epoch : 8 test accuracy : 0.762521
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  58.6119658946991 Time :  4481
accuracy train: 0.827133 val: 0.760563 test: 0.763928
max validation accuracy : 0.760563 max acc epoch : 12 test accuracy : 0.763928
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  56.87468263506889 Time :  4491
accuracy train: 0.830728 val: 0.759155 test: 0.768993
max validation accuracy : 0.760563 max acc epoch : 12 test accuracy : 0.763928
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  55.647862657904625 Time :  4501
accuracy train: 0.834323 val: 0.767606 test: 0.772088
max validation accuracy : 0.767606 max acc epoch : 14 test accuracy : 0.772088
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  54.49358893930912 Time :  4511
accuracy train: 0.834167 val: 0.756338 test: 0.772369
max validation accuracy : 0.767606 max acc epoch : 14 test accuracy : 0.772088

Epoch :  16 loss training:  54.727334797382355 Time :  4521
accuracy train: 0.855111 val: 0.767606 test: 0.778559
max validation accuracy : 0.767606 max acc epoch : 14 test accuracy : 0.772088

Epoch :  17 loss training:  46.135805904865265 Time :  4531
accuracy train: 0.801500 val: 0.729577 test: 0.724536
max validation accuracy : 0.767606 max acc epoch : 14 test accuracy : 0.772088

Epoch :  18 loss training:  42.13473652303219 Time :  4539
accuracy train: 0.749766 val: 0.694366 test: 0.686269
max validation accuracy : 0.767606 max acc epoch : 14 test accuracy : 0.772088

Epoch :  19 loss training:  38.15302553027868 Time :  4550
accuracy train: 0.886527 val: 0.774648 test: 0.772369
max validation accuracy : 0.774648 max acc epoch : 19 test accuracy : 0.772369

Epoch :  20 loss training:  34.04085832834244 Time :  4559
accuracy train: 0.892154 val: 0.776056 test: 0.767023
max validation accuracy : 0.776056 max acc epoch : 20 test accuracy : 0.767023

Epoch :  21 loss training:  29.124281458556652 Time :  4570
accuracy train: 0.892623 val: 0.757746 test: 0.767023
max validation accuracy : 0.776056 max acc epoch : 20 test accuracy : 0.767023

Epoch :  22 loss training:  27.87444155290723 Time :  4581
accuracy train: 0.857455 val: 0.728169 test: 0.740574
max validation accuracy : 0.776056 max acc epoch : 20 test accuracy : 0.767023

Epoch :  23 loss training:  34.80229179188609 Time :  4592
accuracy train: 0.952016 val: 0.766197 test: 0.780529
max validation accuracy : 0.776056 max acc epoch : 20 test accuracy : 0.767023

Epoch :  24 loss training:  31.065637938678265 Time :  4602
accuracy train: 0.982807 val: 0.777465 test: 0.774620
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  25 loss training:  22.237661492079496 Time :  4612
accuracy train: 0.989997 val: 0.771831 test: 0.774620
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  26 loss training:  18.551631109789014 Time :  4623
accuracy train: 0.993748 val: 0.773239 test: 0.766460
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  27 loss training:  15.002960285171866 Time :  4633
accuracy train: 0.995311 val: 0.764789 test: 0.757738
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  28 loss training:  12.978152801282704 Time :  4643
accuracy train: 0.996093 val: 0.776056 test: 0.764772
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  29 loss training:  10.930499917827547 Time :  4654
accuracy train: 0.997499 val: 0.769014 test: 0.763928
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  30 loss training:  10.066785333678126 Time :  4664
accuracy train: 0.998281 val: 0.764789 test: 0.758301
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  31 loss training:  8.63216675259173 Time :  4674
accuracy train: 0.998750 val: 0.760563 test: 0.764209
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  32 loss training:  8.082818557973951 Time :  4682
accuracy train: 0.999375 val: 0.766197 test: 0.758863
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  33 loss training:  6.888270624214783 Time :  4692
accuracy train: 0.999531 val: 0.760563 test: 0.755768
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  34 loss training:  6.293739759363234 Time :  4704
accuracy train: 0.999219 val: 0.759155 test: 0.756612
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  35 loss training:  5.20023528393358 Time :  4713
accuracy train: 0.999687 val: 0.767606 test: 0.756612
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  36 loss training:  4.882344811921939 Time :  4723
accuracy train: 0.999687 val: 0.763380 test: 0.752673
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  37 loss training:  4.395747544011101 Time :  4733
accuracy train: 0.999375 val: 0.756338 test: 0.754361
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  38 loss training:  3.743494907859713 Time :  4743
accuracy train: 0.999844 val: 0.767606 test: 0.750422
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  39 loss training:  3.5435617701150477 Time :  4753
accuracy train: 0.999844 val: 0.757746 test: 0.752954
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  40 loss training:  3.2765497851069085 Time :  4763
accuracy train: 0.999844 val: 0.756338 test: 0.751829
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  41 loss training:  3.124156983802095 Time :  4773
accuracy train: 0.999844 val: 0.757746 test: 0.743669
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  42 loss training:  2.757926933118142 Time :  4782
accuracy train: 1.000000 val: 0.754930 test: 0.747608
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  43 loss training:  2.3925938891479746 Time :  4793
accuracy train: 1.000000 val: 0.752113 test: 0.752954
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  44 loss training:  2.2581178550899494 Time :  4805
accuracy train: 1.000000 val: 0.750704 test: 0.750422
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  45 loss training:  1.8518146790884202 Time :  4818
accuracy train: 1.000000 val: 0.753521 test: 0.749859
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  46 loss training:  2.2723770251031965 Time :  4828
accuracy train: 1.000000 val: 0.756338 test: 0.750703
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  47 loss training:  1.908186720975209 Time :  4839
accuracy train: 1.000000 val: 0.756338 test: 0.741981
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  48 loss training:  1.3991004693962168 Time :  4848
accuracy train: 1.000000 val: 0.756338 test: 0.741137
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  49 loss training:  1.5434650099487044 Time :  4859
accuracy train: 1.000000 val: 0.760563 test: 0.749015
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  50 loss training:  1.67696426238399 Time :  4870
accuracy train: 1.000000 val: 0.753521 test: 0.746764
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  51 loss training:  1.4133973942080047 Time :  4880
accuracy train: 1.000000 val: 0.750704 test: 0.744232
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  52 loss training:  1.1258567658514949 Time :  4890
accuracy train: 1.000000 val: 0.752113 test: 0.749015
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  53 loss training:  1.157970016633044 Time :  4900
accuracy train: 1.000000 val: 0.749296 test: 0.747046
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  54 loss training:  1.1294077291095164 Time :  4910
accuracy train: 1.000000 val: 0.752113 test: 0.749015
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

Epoch :  55 loss training:  0.7828280245594215 Time :  4921
accuracy train: 1.000000 val: 0.753521 test: 0.748452
max validation accuracy : 0.777465 max acc epoch : 24 test accuracy : 0.774620

========================================================================================================================================================================================================
max acc epoch :  24
max validation accuracy :  0.7774647887323943
test accuracy :  0.7746201463140123
last test_accuracy :  0.7484524479459763
========================================================================================================================================================================================================

itr : 9
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=174, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  101.64561107754707 Time :  4934
accuracy train: 0.694592 val: 0.653521 test: 0.687113
max validation accuracy : 0.653521 max acc epoch : 1 test accuracy : 0.687113
Epoch-1 lr: 0.005

Epoch :  2 loss training:  96.75055888295174 Time :  4945
accuracy train: 0.778056 val: 0.742254 test: 0.761114
max validation accuracy : 0.742254 max acc epoch : 2 test accuracy : 0.761114
Epoch-2 lr: 0.005

Epoch :  3 loss training:  94.75849856436253 Time :  4954
accuracy train: 0.800719 val: 0.749296 test: 0.768993
max validation accuracy : 0.749296 max acc epoch : 3 test accuracy : 0.768993
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  84.7687766700983 Time :  4965
accuracy train: 0.811972 val: 0.769014 test: 0.780529
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.780529
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  82.34353929758072 Time :  4975
accuracy train: 0.815098 val: 0.763380 test: 0.783624
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.780529
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  79.87604236602783 Time :  4985
accuracy train: 0.822601 val: 0.760563 test: 0.777153
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.780529
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  72.90361805260181 Time :  4995
accuracy train: 0.816974 val: 0.754930 test: 0.774902
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.780529
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  75.20444452762604 Time :  5006
accuracy train: 0.830728 val: 0.756338 test: 0.782217
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.780529
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  73.07063396275043 Time :  5016
accuracy train: 0.832917 val: 0.763380 test: 0.772932
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.780529
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  70.80394408106804 Time :  5026
accuracy train: 0.844170 val: 0.777465 test: 0.779403
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  69.46738092601299 Time :  5037
accuracy train: 0.845733 val: 0.766197 test: 0.779966
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  68.99652208387852 Time :  5048
accuracy train: 0.849953 val: 0.770423 test: 0.779122
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  67.15915624797344 Time :  5058
accuracy train: 0.848546 val: 0.773239 test: 0.782217
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  68.55771876871586 Time :  5065
accuracy train: 0.850422 val: 0.776056 test: 0.778559
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  67.15888804197311 Time :  5074
accuracy train: 0.852610 val: 0.776056 test: 0.783343
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

Epoch :  16 loss training:  66.78364908695221 Time :  5084
accuracy train: 0.873554 val: 0.776056 test: 0.786719
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

Epoch :  17 loss training:  59.76445969939232 Time :  5095
accuracy train: 0.894186 val: 0.773239 test: 0.786719
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

Epoch :  18 loss training:  55.7473359555006 Time :  5106
accuracy train: 0.907627 val: 0.763380 test: 0.785594
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

Epoch :  19 loss training:  51.331082701683044 Time :  5116
accuracy train: 0.923570 val: 0.764789 test: 0.782499
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

Epoch :  20 loss training:  46.45655697584152 Time :  5126
accuracy train: 0.935449 val: 0.777465 test: 0.781373
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

Epoch :  21 loss training:  41.428933307528496 Time :  5136
accuracy train: 0.944983 val: 0.764789 test: 0.781092
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

Epoch :  22 loss training:  37.181488409638405 Time :  5147
accuracy train: 0.955611 val: 0.767606 test: 0.781092
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

Epoch :  23 loss training:  32.781083166599274 Time :  5157
accuracy train: 0.965771 val: 0.761972 test: 0.772088
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

Epoch :  24 loss training:  30.265614066272974 Time :  5170
accuracy train: 0.969678 val: 0.759155 test: 0.774339
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

Epoch :  25 loss training:  25.802829053252935 Time :  5180
accuracy train: 0.977180 val: 0.756338 test: 0.767304
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

Epoch :  26 loss training:  23.170678209513426 Time :  5191
accuracy train: 0.984214 val: 0.740845 test: 0.763084
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

Epoch :  27 loss training:  19.586763720959425 Time :  5202
accuracy train: 0.986715 val: 0.728169 test: 0.759426
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

Epoch :  28 loss training:  18.395984664559364 Time :  5212
accuracy train: 0.988590 val: 0.736620 test: 0.758863
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

Epoch :  29 loss training:  15.924090016633272 Time :  5221
accuracy train: 0.990778 val: 0.732394 test: 0.758863
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

Epoch :  30 loss training:  14.157052874565125 Time :  5233
accuracy train: 0.992185 val: 0.732394 test: 0.758582
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

Epoch :  31 loss training:  11.80152228474617 Time :  5243
accuracy train: 0.993904 val: 0.728169 test: 0.756331
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

Epoch :  32 loss training:  11.469069533981383 Time :  5254
accuracy train: 0.995467 val: 0.732394 test: 0.754361
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

Epoch :  33 loss training:  9.685020670760423 Time :  5264
accuracy train: 0.995467 val: 0.723944 test: 0.755205
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

Epoch :  34 loss training:  9.03572290809825 Time :  5274
accuracy train: 0.996249 val: 0.723944 test: 0.748734
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

Epoch :  35 loss training:  7.583313976414502 Time :  5286
accuracy train: 0.997030 val: 0.722535 test: 0.752392
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

Epoch :  36 loss training:  6.750510992016643 Time :  5297
accuracy train: 0.997812 val: 0.721127 test: 0.748452
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

Epoch :  37 loss training:  5.958867394831032 Time :  5307
accuracy train: 0.998593 val: 0.711268 test: 0.744513
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

Epoch :  38 loss training:  5.711309566162527 Time :  5318
accuracy train: 0.998750 val: 0.719718 test: 0.746483
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

Epoch :  39 loss training:  4.853679673979059 Time :  5327
accuracy train: 0.998593 val: 0.715493 test: 0.747608
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

Epoch :  40 loss training:  4.797709130565636 Time :  5338
accuracy train: 0.999375 val: 0.722535 test: 0.745920
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

Epoch :  41 loss training:  4.601817364688031 Time :  5348
accuracy train: 0.999219 val: 0.715493 test: 0.746201
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.779403

========================================================================================================================================================================================================
max acc epoch :  10
max validation accuracy :  0.7774647887323943
test accuracy :  0.7794034890264491
last test_accuracy :  0.7462014631401238
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.77183 	 test_accuracy : 0.78700 	 max_acc epoch :  15 	 last test_accuracy : 0.75408
k :  1 	 val_accuracy : 0.77042 	 test_accuracy : 0.78165 	 max_acc epoch :  10 	 last test_accuracy : 0.75858
k :  2 	 val_accuracy : 0.77042 	 test_accuracy : 0.77743 	 max_acc epoch :  18 	 last test_accuracy : 0.75014
k :  3 	 val_accuracy : 0.76479 	 test_accuracy : 0.76843 	 max_acc epoch :  23 	 last test_accuracy : 0.74902
k :  4 	 val_accuracy : 0.78169 	 test_accuracy : 0.76759 	 max_acc epoch :  30 	 last test_accuracy : 0.75577
k :  5 	 val_accuracy : 0.76901 	 test_accuracy : 0.76899 	 max_acc epoch :  22 	 last test_accuracy : 0.74648
k :  6 	 val_accuracy : 0.78169 	 test_accuracy : 0.78559 	 max_acc epoch :  20 	 last test_accuracy : 0.75183
k :  7 	 val_accuracy : 0.78310 	 test_accuracy : 0.78306 	 max_acc epoch :  18 	 last test_accuracy : 0.74845
k :  8 	 val_accuracy : 0.77746 	 test_accuracy : 0.77462 	 max_acc epoch :  24 	 last test_accuracy : 0.74845
k :  9 	 val_accuracy : 0.77746 	 test_accuracy : 0.77940 	 max_acc epoch :  10 	 last test_accuracy : 0.74620

avg :  	 val_accuracy : 0.77479 	 test_accuracy : 0.77738 	 last_accuracy : 0.75090


date and time :  Fri Jun  4 02:48:03 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=231, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.47883412241936 Time :  13
accuracy train: 0.783057 val: 0.756338 test: 0.773213
max validation accuracy : 0.756338 max acc epoch : 1 test accuracy : 0.773213
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.37585583329201 Time :  23
accuracy train: 0.781963 val: 0.752113 test: 0.754924
max validation accuracy : 0.756338 max acc epoch : 1 test accuracy : 0.773213
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.13392826914787 Time :  33
accuracy train: 0.804470 val: 0.756338 test: 0.769555
max validation accuracy : 0.756338 max acc epoch : 1 test accuracy : 0.773213
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  76.42517793178558 Time :  45
accuracy train: 0.819944 val: 0.763380 test: 0.779403
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.779403
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  74.92147839069366 Time :  57
accuracy train: 0.824945 val: 0.757746 test: 0.775183
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.779403
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.52012850344181 Time :  67
accuracy train: 0.828853 val: 0.769014 test: 0.771806
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.80784928798676 Time :  77
accuracy train: 0.834167 val: 0.767606 test: 0.774902
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.19724050164223 Time :  88
accuracy train: 0.842451 val: 0.743662 test: 0.776590
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.72077377140522 Time :  98
accuracy train: 0.845577 val: 0.756338 test: 0.776027
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  66.1903989315033 Time :  108
accuracy train: 0.854017 val: 0.747887 test: 0.774902
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  65.71656748652458 Time :  118
accuracy train: 0.854955 val: 0.753521 test: 0.774620
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  65.03561767935753 Time :  129
accuracy train: 0.856205 val: 0.753521 test: 0.776308
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  64.55225773155689 Time :  139
accuracy train: 0.859956 val: 0.749296 test: 0.775746
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  64.7845102250576 Time :  149
accuracy train: 0.862301 val: 0.747887 test: 0.775464
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  64.07536490261555 Time :  159
accuracy train: 0.862457 val: 0.749296 test: 0.772369
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806

Epoch :  16 loss training:  63.227731838822365 Time :  172
accuracy train: 0.866990 val: 0.740845 test: 0.774057
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806

Epoch :  17 loss training:  62.47949379682541 Time :  181
accuracy train: 0.870272 val: 0.745070 test: 0.777997
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806

Epoch :  18 loss training:  60.30199594795704 Time :  193
accuracy train: 0.873711 val: 0.747887 test: 0.776590
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806

Epoch :  19 loss training:  60.1147825717926 Time :  203
accuracy train: 0.874961 val: 0.753521 test: 0.774057
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806

Epoch :  20 loss training:  59.78210976719856 Time :  214
accuracy train: 0.881525 val: 0.750704 test: 0.777153
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806

Epoch :  21 loss training:  58.48704884946346 Time :  223
accuracy train: 0.885277 val: 0.757746 test: 0.777434
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806

Epoch :  22 loss training:  58.62080365419388 Time :  235
accuracy train: 0.892466 val: 0.752113 test: 0.773776
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806

Epoch :  23 loss training:  57.70404025912285 Time :  246
accuracy train: 0.893717 val: 0.746479 test: 0.774057
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806

Epoch :  24 loss training:  58.07897788286209 Time :  256
accuracy train: 0.897312 val: 0.750704 test: 0.776027
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806

Epoch :  25 loss training:  55.48373971879482 Time :  266
accuracy train: 0.900281 val: 0.750704 test: 0.774902
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806

Epoch :  26 loss training:  54.22984270751476 Time :  278
accuracy train: 0.903095 val: 0.749296 test: 0.772932
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806

Epoch :  27 loss training:  53.718839928507805 Time :  289
accuracy train: 0.906221 val: 0.749296 test: 0.778278
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806

Epoch :  28 loss training:  53.494209945201874 Time :  300
accuracy train: 0.909034 val: 0.739437 test: 0.772651
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806

Epoch :  29 loss training:  51.59652382135391 Time :  311
accuracy train: 0.911847 val: 0.739437 test: 0.768711
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806

Epoch :  30 loss training:  51.13391835987568 Time :  322
accuracy train: 0.915286 val: 0.739437 test: 0.769555
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806

Epoch :  31 loss training:  51.25637340545654 Time :  331
accuracy train: 0.917631 val: 0.740845 test: 0.770962
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806

Epoch :  32 loss training:  49.098901852965355 Time :  342
accuracy train: 0.922319 val: 0.743662 test: 0.772369
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806

Epoch :  33 loss training:  48.82495188713074 Time :  353
accuracy train: 0.924195 val: 0.745070 test: 0.767023
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806

Epoch :  34 loss training:  47.11628222465515 Time :  363
accuracy train: 0.928728 val: 0.740845 test: 0.770962
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806

Epoch :  35 loss training:  47.24311335384846 Time :  374
accuracy train: 0.932635 val: 0.747887 test: 0.771244
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806

Epoch :  36 loss training:  46.22104735672474 Time :  385
accuracy train: 0.934667 val: 0.743662 test: 0.767867
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806

Epoch :  37 loss training:  45.74507090449333 Time :  398
accuracy train: 0.936074 val: 0.745070 test: 0.766742
max validation accuracy : 0.769014 max acc epoch : 6 test accuracy : 0.771806

========================================================================================================================================================================================================
max acc epoch :  6
max validation accuracy :  0.7690140845070422
test accuracy :  0.7718064153066967
last test_accuracy :  0.7667416994935284
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=231, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.47144836187363 Time :  409
accuracy train: 0.781025 val: 0.754930 test: 0.770962
max validation accuracy : 0.754930 max acc epoch : 1 test accuracy : 0.770962
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.36365559697151 Time :  417
accuracy train: 0.782276 val: 0.756338 test: 0.759989
max validation accuracy : 0.756338 max acc epoch : 2 test accuracy : 0.759989
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.49997314810753 Time :  426
accuracy train: 0.803532 val: 0.752113 test: 0.771244
max validation accuracy : 0.756338 max acc epoch : 2 test accuracy : 0.759989
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  76.43881696462631 Time :  436
accuracy train: 0.816818 val: 0.763380 test: 0.781936
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  75.1543397307396 Time :  447
accuracy train: 0.824945 val: 0.761972 test: 0.780810
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.6341831535101 Time :  458
accuracy train: 0.829478 val: 0.761972 test: 0.777153
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  70.045246809721 Time :  465
accuracy train: 0.835105 val: 0.747887 test: 0.777153
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.41411338746548 Time :  475
accuracy train: 0.844639 val: 0.747887 test: 0.778841
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.90277701616287 Time :  485
accuracy train: 0.845108 val: 0.753521 test: 0.776308
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  66.33712492883205 Time :  495
accuracy train: 0.853861 val: 0.747887 test: 0.777715
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  65.831727206707 Time :  507
accuracy train: 0.852923 val: 0.750704 test: 0.777434
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  65.10158954560757 Time :  518
accuracy train: 0.855424 val: 0.753521 test: 0.778278
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  64.48898720741272 Time :  529
accuracy train: 0.860425 val: 0.742254 test: 0.774057
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  65.04887825250626 Time :  539
accuracy train: 0.862457 val: 0.745070 test: 0.776308
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  64.1783717572689 Time :  550
accuracy train: 0.862926 val: 0.746479 test: 0.774902
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936

Epoch :  16 loss training:  63.117101684212685 Time :  559
accuracy train: 0.867146 val: 0.750704 test: 0.777434
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936

Epoch :  17 loss training:  62.82559998333454 Time :  571
accuracy train: 0.870116 val: 0.746479 test: 0.774902
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936

Epoch :  18 loss training:  60.31243960559368 Time :  581
accuracy train: 0.872929 val: 0.754930 test: 0.778559
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936

Epoch :  19 loss training:  60.429104670882225 Time :  592
accuracy train: 0.877618 val: 0.754930 test: 0.777153
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936

Epoch :  20 loss training:  60.308481961488724 Time :  601
accuracy train: 0.880275 val: 0.752113 test: 0.774057
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936

Epoch :  21 loss training:  58.65378972887993 Time :  612
accuracy train: 0.884026 val: 0.747887 test: 0.778559
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936

Epoch :  22 loss training:  58.727038994431496 Time :  627
accuracy train: 0.886996 val: 0.749296 test: 0.776871
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936

Epoch :  23 loss training:  57.52210311591625 Time :  637
accuracy train: 0.891685 val: 0.743662 test: 0.775746
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936

Epoch :  24 loss training:  58.5742164850235 Time :  648
accuracy train: 0.895123 val: 0.747887 test: 0.773495
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936

Epoch :  25 loss training:  55.90283785760403 Time :  658
accuracy train: 0.897624 val: 0.753521 test: 0.775746
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936

Epoch :  26 loss training:  54.9045527279377 Time :  670
accuracy train: 0.901532 val: 0.743662 test: 0.776308
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936

Epoch :  27 loss training:  54.03848598897457 Time :  680
accuracy train: 0.903876 val: 0.750704 test: 0.778278
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936

Epoch :  28 loss training:  54.045833706855774 Time :  691
accuracy train: 0.906533 val: 0.745070 test: 0.777153
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936

Epoch :  29 loss training:  51.946205496788025 Time :  702
accuracy train: 0.909972 val: 0.750704 test: 0.772932
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936

Epoch :  30 loss training:  51.3866885304451 Time :  713
accuracy train: 0.915911 val: 0.752113 test: 0.777715
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936

Epoch :  31 loss training:  51.52326783537865 Time :  723
accuracy train: 0.918568 val: 0.749296 test: 0.774057
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936

Epoch :  32 loss training:  49.18166472017765 Time :  734
accuracy train: 0.922163 val: 0.745070 test: 0.775183
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936

Epoch :  33 loss training:  48.892681039869785 Time :  745
accuracy train: 0.925445 val: 0.746479 test: 0.776308
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936

Epoch :  34 loss training:  47.263245314359665 Time :  755
accuracy train: 0.927634 val: 0.745070 test: 0.774339
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936

Epoch :  35 loss training:  47.93759083747864 Time :  766
accuracy train: 0.930134 val: 0.747887 test: 0.770681
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.781936

========================================================================================================================================================================================================
max acc epoch :  4
max validation accuracy :  0.7633802816901408
test accuracy :  0.7819358469330332
last test_accuracy :  0.7706809229037704
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=231, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.4779963195324 Time :  778
accuracy train: 0.781025 val: 0.757746 test: 0.771244
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.771244
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.28838962316513 Time :  789
accuracy train: 0.782588 val: 0.754930 test: 0.756894
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.771244
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.26180991530418 Time :  800
accuracy train: 0.805408 val: 0.745070 test: 0.772932
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.771244
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  76.3984422981739 Time :  810
accuracy train: 0.819162 val: 0.764789 test: 0.780248
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.780248
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  74.98013949394226 Time :  820
accuracy train: 0.826665 val: 0.766197 test: 0.779685
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.79570624232292 Time :  830
accuracy train: 0.827446 val: 0.763380 test: 0.774339
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.57933184504509 Time :  841
accuracy train: 0.836668 val: 0.756338 test: 0.776308
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.40953442454338 Time :  852
accuracy train: 0.842294 val: 0.750704 test: 0.775464
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.84957809746265 Time :  865
accuracy train: 0.845577 val: 0.754930 test: 0.771244
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  66.55539034307003 Time :  876
accuracy train: 0.855736 val: 0.752113 test: 0.773776
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  65.76935821771622 Time :  886
accuracy train: 0.856049 val: 0.754930 test: 0.774339
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.96208003163338 Time :  893
accuracy train: 0.858706 val: 0.756338 test: 0.774902
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  64.29719650745392 Time :  904
accuracy train: 0.860738 val: 0.749296 test: 0.774620
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  64.77183143794537 Time :  915
accuracy train: 0.864176 val: 0.745070 test: 0.772651
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  64.3993303924799 Time :  921
accuracy train: 0.865270 val: 0.745070 test: 0.771244
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685

Epoch :  16 loss training:  63.09831601381302 Time :  931
accuracy train: 0.868396 val: 0.750704 test: 0.773213
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685

Epoch :  17 loss training:  62.77784726023674 Time :  942
accuracy train: 0.871053 val: 0.746479 test: 0.771244
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685

Epoch :  18 loss training:  60.38427110016346 Time :  953
accuracy train: 0.874023 val: 0.750704 test: 0.773776
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685

Epoch :  19 loss training:  60.47999621927738 Time :  964
accuracy train: 0.878399 val: 0.760563 test: 0.771806
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685

Epoch :  20 loss training:  59.716288670897484 Time :  976
accuracy train: 0.881994 val: 0.750704 test: 0.772932
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685

Epoch :  21 loss training:  58.607004418969154 Time :  990
accuracy train: 0.884495 val: 0.750704 test: 0.772932
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685

Epoch :  22 loss training:  58.66763432323933 Time :  1000
accuracy train: 0.888090 val: 0.743662 test: 0.775464
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685

Epoch :  23 loss training:  57.75112757086754 Time :  1010
accuracy train: 0.890747 val: 0.743662 test: 0.773495
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685

Epoch :  24 loss training:  58.22642455995083 Time :  1021
accuracy train: 0.895749 val: 0.749296 test: 0.771244
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685

Epoch :  25 loss training:  56.056038200855255 Time :  1032
accuracy train: 0.899187 val: 0.752113 test: 0.774620
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685

Epoch :  26 loss training:  54.793651565909386 Time :  1042
accuracy train: 0.901532 val: 0.747887 test: 0.776027
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685

Epoch :  27 loss training:  54.13948093354702 Time :  1052
accuracy train: 0.904345 val: 0.752113 test: 0.776308
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685

Epoch :  28 loss training:  54.1266425549984 Time :  1063
accuracy train: 0.907158 val: 0.743662 test: 0.774620
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685

Epoch :  29 loss training:  52.05868922173977 Time :  1074
accuracy train: 0.911222 val: 0.738028 test: 0.772369
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685

Epoch :  30 loss training:  51.407460421323776 Time :  1085
accuracy train: 0.914192 val: 0.745070 test: 0.774620
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685

Epoch :  31 loss training:  51.506364434957504 Time :  1098
accuracy train: 0.916380 val: 0.749296 test: 0.776308
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685

Epoch :  32 loss training:  49.46189668774605 Time :  1108
accuracy train: 0.920756 val: 0.746479 test: 0.773776
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685

Epoch :  33 loss training:  48.80102600902319 Time :  1119
accuracy train: 0.924820 val: 0.745070 test: 0.774620
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685

Epoch :  34 loss training:  46.741389483213425 Time :  1129
accuracy train: 0.927477 val: 0.745070 test: 0.776308
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685

Epoch :  35 loss training:  47.448264479637146 Time :  1140
accuracy train: 0.933260 val: 0.745070 test: 0.772932
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685

Epoch :  36 loss training:  46.597053684294224 Time :  1151
accuracy train: 0.934980 val: 0.753521 test: 0.772088
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779685

========================================================================================================================================================================================================
max acc epoch :  5
max validation accuracy :  0.7661971830985915
test accuracy :  0.7796848621271807
last test_accuracy :  0.7720877884074282
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=231, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.48675030469894 Time :  1163
accuracy train: 0.782119 val: 0.753521 test: 0.773213
max validation accuracy : 0.753521 max acc epoch : 1 test accuracy : 0.773213
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.43676513433456 Time :  1172
accuracy train: 0.781025 val: 0.756338 test: 0.755487
max validation accuracy : 0.756338 max acc epoch : 2 test accuracy : 0.755487
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.43169242143631 Time :  1183
accuracy train: 0.803063 val: 0.756338 test: 0.773213
max validation accuracy : 0.756338 max acc epoch : 2 test accuracy : 0.755487
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  76.43836018443108 Time :  1194
accuracy train: 0.818381 val: 0.764789 test: 0.779403
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  75.23278793692589 Time :  1205
accuracy train: 0.822132 val: 0.753521 test: 0.777715
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.77432817220688 Time :  1219
accuracy train: 0.829322 val: 0.757746 test: 0.776871
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.96238088607788 Time :  1229
accuracy train: 0.834323 val: 0.757746 test: 0.772932
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.33261400461197 Time :  1239
accuracy train: 0.844326 val: 0.752113 test: 0.780529
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  68.1990011036396 Time :  1250
accuracy train: 0.844014 val: 0.749296 test: 0.772369
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  66.63369750976562 Time :  1260
accuracy train: 0.850891 val: 0.745070 test: 0.773213
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  65.8597899377346 Time :  1271
accuracy train: 0.852766 val: 0.752113 test: 0.773776
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.93571427464485 Time :  1281
accuracy train: 0.856205 val: 0.750704 test: 0.774620
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  64.6328497827053 Time :  1292
accuracy train: 0.859175 val: 0.752113 test: 0.775183
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  65.07031634449959 Time :  1303
accuracy train: 0.859956 val: 0.749296 test: 0.777153
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  64.54673783481121 Time :  1313
accuracy train: 0.860738 val: 0.754930 test: 0.775183
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403

Epoch :  16 loss training:  63.340554907917976 Time :  1323
accuracy train: 0.865583 val: 0.738028 test: 0.774620
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403

Epoch :  17 loss training:  62.69992741942406 Time :  1338
accuracy train: 0.869490 val: 0.743662 test: 0.773213
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403

Epoch :  18 loss training:  60.80596895515919 Time :  1347
accuracy train: 0.872148 val: 0.745070 test: 0.774902
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403

Epoch :  19 loss training:  60.702058270573616 Time :  1358
accuracy train: 0.875430 val: 0.750704 test: 0.774057
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403

Epoch :  20 loss training:  60.167658656835556 Time :  1369
accuracy train: 0.881213 val: 0.750704 test: 0.773495
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403

Epoch :  21 loss training:  58.91029566526413 Time :  1379
accuracy train: 0.881057 val: 0.752113 test: 0.772932
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403

Epoch :  22 loss training:  58.723730728030205 Time :  1389
accuracy train: 0.884026 val: 0.743662 test: 0.772369
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403

Epoch :  23 loss training:  57.94757482409477 Time :  1400
accuracy train: 0.889966 val: 0.740845 test: 0.772932
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403

Epoch :  24 loss training:  58.6040116250515 Time :  1411
accuracy train: 0.893873 val: 0.749296 test: 0.770118
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403

Epoch :  25 loss training:  55.64443922042847 Time :  1421
accuracy train: 0.895123 val: 0.742254 test: 0.772651
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403

Epoch :  26 loss training:  54.442574217915535 Time :  1429
accuracy train: 0.899500 val: 0.746479 test: 0.772651
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403

Epoch :  27 loss training:  53.988085478544235 Time :  1439
accuracy train: 0.903407 val: 0.746479 test: 0.774339
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403

Epoch :  28 loss training:  53.90676221251488 Time :  1451
accuracy train: 0.906064 val: 0.738028 test: 0.777153
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403

Epoch :  29 loss training:  51.838915660977364 Time :  1462
accuracy train: 0.908096 val: 0.740845 test: 0.775464
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403

Epoch :  30 loss training:  51.37802144885063 Time :  1473
accuracy train: 0.913723 val: 0.749296 test: 0.772932
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403

Epoch :  31 loss training:  51.35644808411598 Time :  1485
accuracy train: 0.916693 val: 0.740845 test: 0.774339
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403

Epoch :  32 loss training:  49.13048869371414 Time :  1495
accuracy train: 0.921225 val: 0.742254 test: 0.777715
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403

Epoch :  33 loss training:  48.99764607101679 Time :  1505
accuracy train: 0.923726 val: 0.739437 test: 0.774902
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403

Epoch :  34 loss training:  47.101817697286606 Time :  1516
accuracy train: 0.927946 val: 0.735211 test: 0.773213
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403

Epoch :  35 loss training:  47.48552805185318 Time :  1526
accuracy train: 0.930916 val: 0.735211 test: 0.774339
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.779403

========================================================================================================================================================================================================
max acc epoch :  4
max validation accuracy :  0.7647887323943662
test accuracy :  0.7794034890264491
last test_accuracy :  0.7743387732132808
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=231, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.48217582702637 Time :  1538
accuracy train: 0.781807 val: 0.757746 test: 0.769555
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.769555
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.41072794795036 Time :  1548
accuracy train: 0.781963 val: 0.754930 test: 0.758301
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.769555
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.33304139971733 Time :  1560
accuracy train: 0.800094 val: 0.745070 test: 0.773213
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.769555
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  76.40538582205772 Time :  1574
accuracy train: 0.818068 val: 0.761972 test: 0.781373
max validation accuracy : 0.761972 max acc epoch : 4 test accuracy : 0.781373
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  75.1829654276371 Time :  1585
accuracy train: 0.822601 val: 0.760563 test: 0.774620
max validation accuracy : 0.761972 max acc epoch : 4 test accuracy : 0.781373
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.72396399080753 Time :  1596
accuracy train: 0.829322 val: 0.763380 test: 0.774057
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.5607550740242 Time :  1605
accuracy train: 0.834480 val: 0.760563 test: 0.774620
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.35864798724651 Time :  1615
accuracy train: 0.842607 val: 0.756338 test: 0.775183
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.96177950501442 Time :  1626
accuracy train: 0.846983 val: 0.756338 test: 0.772651
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  66.33928699791431 Time :  1636
accuracy train: 0.854017 val: 0.761972 test: 0.772369
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  65.94502156972885 Time :  1646
accuracy train: 0.852610 val: 0.754930 test: 0.774620
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  65.14637061953545 Time :  1658
accuracy train: 0.857455 val: 0.756338 test: 0.772369
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  64.4024423956871 Time :  1667
accuracy train: 0.857299 val: 0.757746 test: 0.773213
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  64.85342301428318 Time :  1678
accuracy train: 0.861519 val: 0.756338 test: 0.774902
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  64.37546266615391 Time :  1691
accuracy train: 0.860894 val: 0.763380 test: 0.772369
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057

Epoch :  16 loss training:  63.07795552909374 Time :  1702
accuracy train: 0.865270 val: 0.743662 test: 0.771244
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057

Epoch :  17 loss training:  62.90480890870094 Time :  1713
accuracy train: 0.868553 val: 0.746479 test: 0.770962
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057

Epoch :  18 loss training:  60.50133588910103 Time :  1724
accuracy train: 0.873867 val: 0.752113 test: 0.773213
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057

Epoch :  19 loss training:  60.459436029195786 Time :  1735
accuracy train: 0.876368 val: 0.756338 test: 0.771244
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057

Epoch :  20 loss training:  60.05289375782013 Time :  1745
accuracy train: 0.881682 val: 0.757746 test: 0.772369
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057

Epoch :  21 loss training:  58.797594994306564 Time :  1757
accuracy train: 0.883245 val: 0.754930 test: 0.774902
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057

Epoch :  22 loss training:  58.43865855038166 Time :  1768
accuracy train: 0.886214 val: 0.752113 test: 0.777434
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057

Epoch :  23 loss training:  57.548632085323334 Time :  1778
accuracy train: 0.891372 val: 0.749296 test: 0.776590
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057

Epoch :  24 loss training:  58.15219147503376 Time :  1790
accuracy train: 0.896218 val: 0.753521 test: 0.771806
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057

Epoch :  25 loss training:  55.897898837924004 Time :  1801
accuracy train: 0.897468 val: 0.746479 test: 0.771244
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057

Epoch :  26 loss training:  54.44431249797344 Time :  1815
accuracy train: 0.901063 val: 0.743662 test: 0.775746
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057

Epoch :  27 loss training:  54.09993243217468 Time :  1822
accuracy train: 0.903876 val: 0.742254 test: 0.776027
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057

Epoch :  28 loss training:  53.82872301340103 Time :  1833
accuracy train: 0.908096 val: 0.738028 test: 0.772651
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057

Epoch :  29 loss training:  51.71466751396656 Time :  1844
accuracy train: 0.911222 val: 0.746479 test: 0.773776
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057

Epoch :  30 loss training:  51.28476843237877 Time :  1854
accuracy train: 0.914973 val: 0.743662 test: 0.770962
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057

Epoch :  31 loss training:  51.37295766174793 Time :  1866
accuracy train: 0.919819 val: 0.742254 test: 0.775464
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057

Epoch :  32 loss training:  49.53261687606573 Time :  1876
accuracy train: 0.923414 val: 0.756338 test: 0.774902
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057

Epoch :  33 loss training:  48.78774356842041 Time :  1883
accuracy train: 0.925289 val: 0.753521 test: 0.774902
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057

Epoch :  34 loss training:  46.75423337519169 Time :  1894
accuracy train: 0.927790 val: 0.745070 test: 0.774620
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057

Epoch :  35 loss training:  47.38791095465422 Time :  1905
accuracy train: 0.932635 val: 0.743662 test: 0.772651
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057

Epoch :  36 loss training:  46.56171288341284 Time :  1915
accuracy train: 0.934042 val: 0.736620 test: 0.773495
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057

Epoch :  37 loss training:  45.870740078389645 Time :  1928
accuracy train: 0.939669 val: 0.752113 test: 0.772932
max validation accuracy : 0.763380 max acc epoch : 6 test accuracy : 0.774057

========================================================================================================================================================================================================
max acc epoch :  6
max validation accuracy :  0.7633802816901408
test accuracy :  0.7740574001125492
last test_accuracy :  0.772931907709623
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=231, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.45572829246521 Time :  1941
accuracy train: 0.780088 val: 0.760563 test: 0.772088
max validation accuracy : 0.760563 max acc epoch : 1 test accuracy : 0.772088
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.38025176525116 Time :  1951
accuracy train: 0.782432 val: 0.749296 test: 0.753236
max validation accuracy : 0.760563 max acc epoch : 1 test accuracy : 0.772088
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.358681589365 Time :  1962
accuracy train: 0.800875 val: 0.753521 test: 0.770118
max validation accuracy : 0.760563 max acc epoch : 1 test accuracy : 0.772088
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  76.24187856912613 Time :  1973
accuracy train: 0.819944 val: 0.760563 test: 0.778841
max validation accuracy : 0.760563 max acc epoch : 1 test accuracy : 0.772088
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  74.97971421480179 Time :  1982
accuracy train: 0.824476 val: 0.761972 test: 0.777434
max validation accuracy : 0.761972 max acc epoch : 5 test accuracy : 0.777434
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.61247926950455 Time :  1993
accuracy train: 0.828071 val: 0.761972 test: 0.772369
max validation accuracy : 0.761972 max acc epoch : 5 test accuracy : 0.777434
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.85919968783855 Time :  2003
accuracy train: 0.836511 val: 0.754930 test: 0.774057
max validation accuracy : 0.761972 max acc epoch : 5 test accuracy : 0.777434
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.2809933423996 Time :  2014
accuracy train: 0.843232 val: 0.752113 test: 0.777153
max validation accuracy : 0.761972 max acc epoch : 5 test accuracy : 0.777434
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.69244639575481 Time :  2023
accuracy train: 0.847921 val: 0.749296 test: 0.772932
max validation accuracy : 0.761972 max acc epoch : 5 test accuracy : 0.777434
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  66.18968346714973 Time :  2034
accuracy train: 0.853548 val: 0.752113 test: 0.779122
max validation accuracy : 0.761972 max acc epoch : 5 test accuracy : 0.777434
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  65.66196385025978 Time :  2046
accuracy train: 0.855580 val: 0.753521 test: 0.776308
max validation accuracy : 0.761972 max acc epoch : 5 test accuracy : 0.777434
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  65.03170144557953 Time :  2057
accuracy train: 0.857768 val: 0.752113 test: 0.775183
max validation accuracy : 0.761972 max acc epoch : 5 test accuracy : 0.777434
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  64.49555040895939 Time :  2067
accuracy train: 0.861207 val: 0.752113 test: 0.774902
max validation accuracy : 0.761972 max acc epoch : 5 test accuracy : 0.777434
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  64.79894268512726 Time :  2077
accuracy train: 0.863864 val: 0.750704 test: 0.772651
max validation accuracy : 0.761972 max acc epoch : 5 test accuracy : 0.777434
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  64.25278763473034 Time :  2087
accuracy train: 0.864489 val: 0.749296 test: 0.772932
max validation accuracy : 0.761972 max acc epoch : 5 test accuracy : 0.777434

Epoch :  16 loss training:  62.91891425848007 Time :  2097
accuracy train: 0.866364 val: 0.753521 test: 0.771244
max validation accuracy : 0.761972 max acc epoch : 5 test accuracy : 0.777434

Epoch :  17 loss training:  62.74142962694168 Time :  2108
accuracy train: 0.869334 val: 0.740845 test: 0.774902
max validation accuracy : 0.761972 max acc epoch : 5 test accuracy : 0.777434

Epoch :  18 loss training:  60.41249519586563 Time :  2119
accuracy train: 0.873554 val: 0.759155 test: 0.778559
max validation accuracy : 0.761972 max acc epoch : 5 test accuracy : 0.777434

Epoch :  19 loss training:  60.17126074433327 Time :  2130
accuracy train: 0.875586 val: 0.754930 test: 0.772369
max validation accuracy : 0.761972 max acc epoch : 5 test accuracy : 0.777434

Epoch :  20 loss training:  59.76641735434532 Time :  2140
accuracy train: 0.881682 val: 0.764789 test: 0.774620
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  21 loss training:  58.659861356019974 Time :  2151
accuracy train: 0.884183 val: 0.760563 test: 0.774057
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  22 loss training:  58.71342904865742 Time :  2162
accuracy train: 0.888246 val: 0.757746 test: 0.777434
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  23 loss training:  57.39980098605156 Time :  2176
accuracy train: 0.892154 val: 0.745070 test: 0.775183
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  24 loss training:  57.938711151480675 Time :  2187
accuracy train: 0.895280 val: 0.756338 test: 0.770962
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  25 loss training:  55.76521237194538 Time :  2197
accuracy train: 0.898718 val: 0.757746 test: 0.775464
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  26 loss training:  54.259201377630234 Time :  2208
accuracy train: 0.901688 val: 0.752113 test: 0.776590
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  27 loss training:  54.006685957312584 Time :  2218
accuracy train: 0.905595 val: 0.752113 test: 0.778559
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  28 loss training:  53.73430196940899 Time :  2229
accuracy train: 0.909816 val: 0.752113 test: 0.776027
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  29 loss training:  51.61726960539818 Time :  2240
accuracy train: 0.913879 val: 0.753521 test: 0.772369
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  30 loss training:  51.30301509797573 Time :  2252
accuracy train: 0.916536 val: 0.749296 test: 0.768993
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  31 loss training:  51.30910874903202 Time :  2262
accuracy train: 0.920913 val: 0.749296 test: 0.773213
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  32 loss training:  49.13158718496561 Time :  2273
accuracy train: 0.924195 val: 0.750704 test: 0.773213
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  33 loss training:  48.43744792044163 Time :  2285
accuracy train: 0.926383 val: 0.749296 test: 0.776308
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  34 loss training:  47.1340157687664 Time :  2299
accuracy train: 0.928884 val: 0.742254 test: 0.776308
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  35 loss training:  47.39321268349886 Time :  2310
accuracy train: 0.932948 val: 0.749296 test: 0.770962
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  36 loss training:  46.115839429199696 Time :  2320
accuracy train: 0.935136 val: 0.739437 test: 0.771525
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  37 loss training:  46.274765476584435 Time :  2331
accuracy train: 0.937168 val: 0.749296 test: 0.771244
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  38 loss training:  45.33799800276756 Time :  2343
accuracy train: 0.938731 val: 0.732394 test: 0.770118
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  39 loss training:  44.00502810627222 Time :  2354
accuracy train: 0.942951 val: 0.736620 test: 0.774620
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  40 loss training:  43.09270737320185 Time :  2363
accuracy train: 0.944827 val: 0.743662 test: 0.772932
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  41 loss training:  42.81301835179329 Time :  2374
accuracy train: 0.948578 val: 0.740845 test: 0.768711
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  42 loss training:  40.62490885704756 Time :  2385
accuracy train: 0.950610 val: 0.733803 test: 0.772369
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  43 loss training:  40.694340370595455 Time :  2396
accuracy train: 0.951547 val: 0.730986 test: 0.768711
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  44 loss training:  40.69295531511307 Time :  2408
accuracy train: 0.955299 val: 0.738028 test: 0.772088
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  45 loss training:  38.560877963900566 Time :  2419
accuracy train: 0.955611 val: 0.736620 test: 0.772932
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  46 loss training:  40.901192881166935 Time :  2430
accuracy train: 0.959519 val: 0.738028 test: 0.769837
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  47 loss training:  36.24935434758663 Time :  2441
accuracy train: 0.959675 val: 0.735211 test: 0.769555
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  48 loss training:  37.2671680226922 Time :  2452
accuracy train: 0.963270 val: 0.729577 test: 0.768430
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  49 loss training:  36.73842250183225 Time :  2463
accuracy train: 0.965458 val: 0.736620 test: 0.769837
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  50 loss training:  35.28542409837246 Time :  2474
accuracy train: 0.966552 val: 0.736620 test: 0.769837
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

Epoch :  51 loss training:  33.99057561159134 Time :  2484
accuracy train: 0.966865 val: 0.732394 test: 0.765898
max validation accuracy : 0.764789 max acc epoch : 20 test accuracy : 0.774620

========================================================================================================================================================================================================
max acc epoch :  20
max validation accuracy :  0.7647887323943662
test accuracy :  0.7746201463140123
last test_accuracy :  0.7658975801913337
========================================================================================================================================================================================================

itr : 6
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=231, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.47986373305321 Time :  2496
accuracy train: 0.781807 val: 0.759155 test: 0.768711
max validation accuracy : 0.759155 max acc epoch : 1 test accuracy : 0.768711
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.38152632117271 Time :  2507
accuracy train: 0.781338 val: 0.757746 test: 0.757175
max validation accuracy : 0.759155 max acc epoch : 1 test accuracy : 0.768711
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.28768223524094 Time :  2519
accuracy train: 0.801344 val: 0.750704 test: 0.772369
max validation accuracy : 0.759155 max acc epoch : 1 test accuracy : 0.768711
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  76.30846291780472 Time :  2531
accuracy train: 0.819944 val: 0.770423 test: 0.782217
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  75.1619063615799 Time :  2542
accuracy train: 0.823851 val: 0.763380 test: 0.776590
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.39234036207199 Time :  2553
accuracy train: 0.830103 val: 0.760563 test: 0.775464
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.74861644208431 Time :  2563
accuracy train: 0.835886 val: 0.757746 test: 0.775464
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.32281219959259 Time :  2573
accuracy train: 0.842138 val: 0.747887 test: 0.778278
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.8334180265665 Time :  2584
accuracy train: 0.845889 val: 0.753521 test: 0.774339
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  66.11666442453861 Time :  2595
accuracy train: 0.854329 val: 0.749296 test: 0.778278
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  65.84283450245857 Time :  2604
accuracy train: 0.853548 val: 0.754930 test: 0.778278
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.88327606022358 Time :  2616
accuracy train: 0.856830 val: 0.750704 test: 0.776590
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  64.44318108260632 Time :  2627
accuracy train: 0.860269 val: 0.750704 test: 0.776027
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  64.85684418678284 Time :  2636
accuracy train: 0.862301 val: 0.752113 test: 0.775464
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  64.07959307730198 Time :  2649
accuracy train: 0.862926 val: 0.750704 test: 0.774620
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217

Epoch :  16 loss training:  62.85511302947998 Time :  2661
accuracy train: 0.867302 val: 0.749296 test: 0.775183
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217

Epoch :  17 loss training:  62.411865234375 Time :  2672
accuracy train: 0.871210 val: 0.752113 test: 0.774057
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217

Epoch :  18 loss training:  60.51152981817722 Time :  2683
accuracy train: 0.874648 val: 0.754930 test: 0.777997
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217

Epoch :  19 loss training:  60.49947728216648 Time :  2694
accuracy train: 0.874648 val: 0.757746 test: 0.773776
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217

Epoch :  20 loss training:  59.98413842916489 Time :  2706
accuracy train: 0.882307 val: 0.759155 test: 0.776027
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217

Epoch :  21 loss training:  58.713294222950935 Time :  2716
accuracy train: 0.885746 val: 0.759155 test: 0.776590
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217

Epoch :  22 loss training:  58.49798405170441 Time :  2727
accuracy train: 0.888090 val: 0.752113 test: 0.775746
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217

Epoch :  23 loss training:  57.602835685014725 Time :  2738
accuracy train: 0.892935 val: 0.747887 test: 0.775464
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217

Epoch :  24 loss training:  58.20241643488407 Time :  2749
accuracy train: 0.896530 val: 0.752113 test: 0.773213
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217

Epoch :  25 loss training:  55.5876644551754 Time :  2760
accuracy train: 0.900594 val: 0.754930 test: 0.771525
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217

Epoch :  26 loss training:  54.2175824791193 Time :  2772
accuracy train: 0.901844 val: 0.750704 test: 0.773776
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217

Epoch :  27 loss training:  53.89972177147865 Time :  2784
accuracy train: 0.905595 val: 0.750704 test: 0.771806
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217

Epoch :  28 loss training:  53.75007203221321 Time :  2793
accuracy train: 0.909972 val: 0.743662 test: 0.776871
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217

Epoch :  29 loss training:  51.60473205149174 Time :  2800
accuracy train: 0.911379 val: 0.746479 test: 0.773213
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217

Epoch :  30 loss training:  51.34920588135719 Time :  2812
accuracy train: 0.918881 val: 0.747887 test: 0.770962
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217

Epoch :  31 loss training:  51.49127733707428 Time :  2823
accuracy train: 0.919975 val: 0.756338 test: 0.772369
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217

Epoch :  32 loss training:  49.084835939109325 Time :  2833
accuracy train: 0.922945 val: 0.753521 test: 0.774902
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217

Epoch :  33 loss training:  48.92328415066004 Time :  2844
accuracy train: 0.926852 val: 0.753521 test: 0.770118
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217

Epoch :  34 loss training:  46.84629721939564 Time :  2855
accuracy train: 0.929978 val: 0.750704 test: 0.770962
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217

Epoch :  35 loss training:  47.28554069250822 Time :  2865
accuracy train: 0.935136 val: 0.747887 test: 0.773495
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.782217

========================================================================================================================================================================================================
max acc epoch :  4
max validation accuracy :  0.7704225352112676
test accuracy :  0.7822172200337648
last test_accuracy :  0.7734946539110861
========================================================================================================================================================================================================

itr : 7
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=231, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.48132330179214 Time :  2878
accuracy train: 0.781338 val: 0.756338 test: 0.771525
max validation accuracy : 0.756338 max acc epoch : 1 test accuracy : 0.771525
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.3608989417553 Time :  2891
accuracy train: 0.782588 val: 0.757746 test: 0.757175
max validation accuracy : 0.757746 max acc epoch : 2 test accuracy : 0.757175
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.30031007528305 Time :  2903
accuracy train: 0.806346 val: 0.759155 test: 0.772932
max validation accuracy : 0.759155 max acc epoch : 3 test accuracy : 0.772932
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  76.30138522386551 Time :  2913
accuracy train: 0.821350 val: 0.760563 test: 0.775183
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  74.87468191981316 Time :  2924
accuracy train: 0.822757 val: 0.760563 test: 0.774902
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.67408360540867 Time :  2934
accuracy train: 0.828853 val: 0.757746 test: 0.777434
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.60950867831707 Time :  2945
accuracy train: 0.836199 val: 0.752113 test: 0.776871
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.15360620617867 Time :  2955
accuracy train: 0.842763 val: 0.754930 test: 0.776308
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.50346559286118 Time :  2966
accuracy train: 0.847296 val: 0.752113 test: 0.774620
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  66.1794992685318 Time :  2976
accuracy train: 0.855111 val: 0.756338 test: 0.779122
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  65.8265458792448 Time :  2987
accuracy train: 0.853392 val: 0.753521 test: 0.776308
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.87840943038464 Time :  2997
accuracy train: 0.858550 val: 0.752113 test: 0.773776
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  64.07178467512131 Time :  3008
accuracy train: 0.861363 val: 0.743662 test: 0.777153
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  64.4402936398983 Time :  3020
accuracy train: 0.863707 val: 0.747887 test: 0.773776
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  64.13926351070404 Time :  3031
accuracy train: 0.864802 val: 0.750704 test: 0.773495
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183

Epoch :  16 loss training:  62.968888491392136 Time :  3042
accuracy train: 0.867459 val: 0.749296 test: 0.773495
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183

Epoch :  17 loss training:  62.63514490425587 Time :  3052
accuracy train: 0.870897 val: 0.745070 test: 0.773776
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183

Epoch :  18 loss training:  60.18088734149933 Time :  3063
accuracy train: 0.876837 val: 0.749296 test: 0.776027
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183

Epoch :  19 loss training:  60.34021706879139 Time :  3072
accuracy train: 0.878087 val: 0.749296 test: 0.774057
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183

Epoch :  20 loss training:  59.61558347940445 Time :  3079
accuracy train: 0.883401 val: 0.754930 test: 0.776308
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183

Epoch :  21 loss training:  58.40239082276821 Time :  3090
accuracy train: 0.885433 val: 0.757746 test: 0.777153
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183

Epoch :  22 loss training:  58.67369623482227 Time :  3101
accuracy train: 0.890122 val: 0.749296 test: 0.776027
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183

Epoch :  23 loss training:  57.680722415447235 Time :  3112
accuracy train: 0.892154 val: 0.749296 test: 0.776871
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183

Epoch :  24 loss training:  58.12953393161297 Time :  3124
accuracy train: 0.896218 val: 0.752113 test: 0.772369
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183

Epoch :  25 loss training:  55.667728275060654 Time :  3136
accuracy train: 0.898875 val: 0.745070 test: 0.776871
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183

Epoch :  26 loss training:  54.426233276724815 Time :  3147
accuracy train: 0.902782 val: 0.750704 test: 0.776871
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183

Epoch :  27 loss training:  54.06560502946377 Time :  3158
accuracy train: 0.905439 val: 0.745070 test: 0.778278
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183

Epoch :  28 loss training:  53.903853833675385 Time :  3169
accuracy train: 0.908253 val: 0.740845 test: 0.776308
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183

Epoch :  29 loss training:  51.61877655982971 Time :  3179
accuracy train: 0.911535 val: 0.750704 test: 0.773495
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183

Epoch :  30 loss training:  51.29614996910095 Time :  3190
accuracy train: 0.916380 val: 0.746479 test: 0.775183
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183

Epoch :  31 loss training:  51.30702678859234 Time :  3200
accuracy train: 0.917631 val: 0.745070 test: 0.776590
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183

Epoch :  32 loss training:  49.2400084733963 Time :  3211
accuracy train: 0.922319 val: 0.746479 test: 0.779685
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183

Epoch :  33 loss training:  48.35314740985632 Time :  3222
accuracy train: 0.925758 val: 0.742254 test: 0.775464
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183

Epoch :  34 loss training:  46.647162422537804 Time :  3232
accuracy train: 0.929040 val: 0.739437 test: 0.777153
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183

Epoch :  35 loss training:  47.58226661384106 Time :  3244
accuracy train: 0.931541 val: 0.743662 test: 0.775746
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.775183

========================================================================================================================================================================================================
max acc epoch :  4
max validation accuracy :  0.7605633802816901
test accuracy :  0.7751828925154756
last test_accuracy :  0.7757456387169387
========================================================================================================================================================================================================

itr : 8
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=231, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.489467471838 Time :  3257
accuracy train: 0.782432 val: 0.754930 test: 0.772932
max validation accuracy : 0.754930 max acc epoch : 1 test accuracy : 0.772932
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.43115335702896 Time :  3268
accuracy train: 0.783057 val: 0.756338 test: 0.758301
max validation accuracy : 0.756338 max acc epoch : 2 test accuracy : 0.758301
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.18834254145622 Time :  3277
accuracy train: 0.801657 val: 0.752113 test: 0.768430
max validation accuracy : 0.756338 max acc epoch : 2 test accuracy : 0.758301
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  76.42870298027992 Time :  3288
accuracy train: 0.820569 val: 0.754930 test: 0.776308
max validation accuracy : 0.756338 max acc epoch : 2 test accuracy : 0.758301
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  75.04337719082832 Time :  3299
accuracy train: 0.824633 val: 0.750704 test: 0.774902
max validation accuracy : 0.756338 max acc epoch : 2 test accuracy : 0.758301
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.67866949737072 Time :  3310
accuracy train: 0.828228 val: 0.764789 test: 0.772651
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.86052420735359 Time :  3320
accuracy train: 0.835730 val: 0.743662 test: 0.776027
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.25602768361568 Time :  3329
accuracy train: 0.842451 val: 0.746479 test: 0.775464
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.97003990411758 Time :  3340
accuracy train: 0.844795 val: 0.745070 test: 0.772932
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  66.2235008329153 Time :  3349
accuracy train: 0.853861 val: 0.740845 test: 0.775183
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  65.82966403663158 Time :  3362
accuracy train: 0.854329 val: 0.743662 test: 0.774902
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  65.21994794905186 Time :  3370
accuracy train: 0.857143 val: 0.750704 test: 0.774620
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  64.56663644313812 Time :  3380
accuracy train: 0.860425 val: 0.745070 test: 0.776308
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  65.01221716403961 Time :  3390
accuracy train: 0.862770 val: 0.743662 test: 0.775746
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  64.38366438448429 Time :  3401
accuracy train: 0.864333 val: 0.743662 test: 0.773495
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651

Epoch :  16 loss training:  63.033699706196785 Time :  3411
accuracy train: 0.866990 val: 0.742254 test: 0.775464
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651

Epoch :  17 loss training:  62.56320494413376 Time :  3422
accuracy train: 0.869490 val: 0.739437 test: 0.775464
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651

Epoch :  18 loss training:  60.650868594646454 Time :  3433
accuracy train: 0.874023 val: 0.747887 test: 0.777434
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651

Epoch :  19 loss training:  60.23630028963089 Time :  3441
accuracy train: 0.875899 val: 0.754930 test: 0.776027
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651

Epoch :  20 loss training:  60.137326553463936 Time :  3453
accuracy train: 0.881994 val: 0.756338 test: 0.777434
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651

Epoch :  21 loss training:  58.42715764045715 Time :  3464
accuracy train: 0.884651 val: 0.750704 test: 0.777434
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651

Epoch :  22 loss training:  58.54227365553379 Time :  3474
accuracy train: 0.889184 val: 0.746479 test: 0.776027
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651

Epoch :  23 loss training:  57.73141238093376 Time :  3487
accuracy train: 0.892466 val: 0.746479 test: 0.778559
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651

Epoch :  24 loss training:  58.70231734216213 Time :  3498
accuracy train: 0.896061 val: 0.746479 test: 0.774057
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651

Epoch :  25 loss training:  55.86791595816612 Time :  3506
accuracy train: 0.898249 val: 0.749296 test: 0.773495
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651

Epoch :  26 loss training:  54.4575659185648 Time :  3517
accuracy train: 0.902001 val: 0.745070 test: 0.776590
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651

Epoch :  27 loss training:  53.81137742102146 Time :  3526
accuracy train: 0.904814 val: 0.738028 test: 0.779685
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651

Epoch :  28 loss training:  53.91549204289913 Time :  3537
accuracy train: 0.909190 val: 0.738028 test: 0.778278
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651

Epoch :  29 loss training:  51.90261812508106 Time :  3548
accuracy train: 0.910597 val: 0.746479 test: 0.775746
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651

Epoch :  30 loss training:  51.122133776545525 Time :  3558
accuracy train: 0.915599 val: 0.740845 test: 0.778841
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651

Epoch :  31 loss training:  51.656559839844704 Time :  3568
accuracy train: 0.918256 val: 0.746479 test: 0.777153
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651

Epoch :  32 loss training:  49.494076646864414 Time :  3579
accuracy train: 0.924039 val: 0.746479 test: 0.779966
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651

Epoch :  33 loss training:  48.62251755595207 Time :  3589
accuracy train: 0.925602 val: 0.743662 test: 0.776871
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651

Epoch :  34 loss training:  47.17071655392647 Time :  3601
accuracy train: 0.928259 val: 0.742254 test: 0.778278
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651

Epoch :  35 loss training:  47.75490804761648 Time :  3612
accuracy train: 0.931697 val: 0.743662 test: 0.772932
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651

Epoch :  36 loss training:  46.425459675490856 Time :  3623
accuracy train: 0.932010 val: 0.745070 test: 0.770962
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651

Epoch :  37 loss training:  46.16372615098953 Time :  3633
accuracy train: 0.938418 val: 0.745070 test: 0.774902
max validation accuracy : 0.764789 max acc epoch : 6 test accuracy : 0.772651

========================================================================================================================================================================================================
max acc epoch :  6
max validation accuracy :  0.7647887323943662
test accuracy :  0.7726505346088914
last test_accuracy :  0.7749015194147439
========================================================================================================================================================================================================

itr : 9
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=231, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.50132170319557 Time :  3645
accuracy train: 0.781651 val: 0.757746 test: 0.772932
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.772932
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.3566645681858 Time :  3656
accuracy train: 0.780400 val: 0.753521 test: 0.755487
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.772932
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.53139841556549 Time :  3666
accuracy train: 0.804314 val: 0.753521 test: 0.773213
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.772932
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  76.28427419066429 Time :  3676
accuracy train: 0.819475 val: 0.766197 test: 0.779122
max validation accuracy : 0.766197 max acc epoch : 4 test accuracy : 0.779122
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  74.85682904720306 Time :  3688
accuracy train: 0.824320 val: 0.763380 test: 0.775746
max validation accuracy : 0.766197 max acc epoch : 4 test accuracy : 0.779122
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.41375580430031 Time :  3698
accuracy train: 0.832291 val: 0.771831 test: 0.775464
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.63128346204758 Time :  3708
accuracy train: 0.837762 val: 0.759155 test: 0.774057
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.26555459201336 Time :  3721
accuracy train: 0.845108 val: 0.747887 test: 0.776308
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.64599086344242 Time :  3732
accuracy train: 0.849015 val: 0.749296 test: 0.776871
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  66.17585119605064 Time :  3743
accuracy train: 0.853548 val: 0.754930 test: 0.776308
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  65.61466152966022 Time :  3753
accuracy train: 0.854486 val: 0.752113 test: 0.772651
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  65.02287782728672 Time :  3764
accuracy train: 0.858081 val: 0.746479 test: 0.774620
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  64.47243939340115 Time :  3775
accuracy train: 0.859644 val: 0.752113 test: 0.775464
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  64.97219325602055 Time :  3787
accuracy train: 0.862457 val: 0.752113 test: 0.774057
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  64.06065212190151 Time :  3796
accuracy train: 0.861832 val: 0.752113 test: 0.773213
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464

Epoch :  16 loss training:  63.12292371690273 Time :  3808
accuracy train: 0.867771 val: 0.746479 test: 0.773213
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464

Epoch :  17 loss training:  62.568957671523094 Time :  3819
accuracy train: 0.869803 val: 0.743662 test: 0.775746
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464

Epoch :  18 loss training:  60.29318743944168 Time :  3829
accuracy train: 0.874805 val: 0.752113 test: 0.773776
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464

Epoch :  19 loss training:  60.45209041237831 Time :  3840
accuracy train: 0.878399 val: 0.753521 test: 0.772088
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464

Epoch :  20 loss training:  59.77501851320267 Time :  3853
accuracy train: 0.880744 val: 0.760563 test: 0.772932
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464

Epoch :  21 loss training:  58.28410080075264 Time :  3863
accuracy train: 0.884964 val: 0.752113 test: 0.775183
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464

Epoch :  22 loss training:  58.31077282130718 Time :  3874
accuracy train: 0.888559 val: 0.753521 test: 0.776871
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464

Epoch :  23 loss training:  57.57868371903896 Time :  3886
accuracy train: 0.890903 val: 0.746479 test: 0.774057
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464

Epoch :  24 loss training:  57.950403705239296 Time :  3897
accuracy train: 0.895280 val: 0.747887 test: 0.773495
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464

Epoch :  25 loss training:  55.65542218089104 Time :  3907
accuracy train: 0.899187 val: 0.743662 test: 0.774620
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464

Epoch :  26 loss training:  54.05387885868549 Time :  3919
accuracy train: 0.902313 val: 0.745070 test: 0.775464
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464

Epoch :  27 loss training:  53.67030085623264 Time :  3930
accuracy train: 0.904501 val: 0.746479 test: 0.774620
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464

Epoch :  28 loss training:  53.96116794645786 Time :  3940
accuracy train: 0.907784 val: 0.742254 test: 0.773776
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464

Epoch :  29 loss training:  51.72819268703461 Time :  3949
accuracy train: 0.912160 val: 0.745070 test: 0.771244
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464

Epoch :  30 loss training:  50.704876616597176 Time :  3959
accuracy train: 0.916849 val: 0.743662 test: 0.772369
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464

Epoch :  31 loss training:  51.26264350116253 Time :  3973
accuracy train: 0.919506 val: 0.746479 test: 0.774620
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464

Epoch :  32 loss training:  49.07748702913523 Time :  3985
accuracy train: 0.922788 val: 0.747887 test: 0.773495
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464

Epoch :  33 loss training:  48.987255446612835 Time :  3995
accuracy train: 0.926383 val: 0.747887 test: 0.774902
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464

Epoch :  34 loss training:  46.761050179600716 Time :  4006
accuracy train: 0.928259 val: 0.745070 test: 0.776590
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464

Epoch :  35 loss training:  47.094114273786545 Time :  4016
accuracy train: 0.934198 val: 0.745070 test: 0.773776
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464

Epoch :  36 loss training:  45.95145009458065 Time :  4027
accuracy train: 0.934980 val: 0.746479 test: 0.774620
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464

Epoch :  37 loss training:  45.90990337729454 Time :  4037
accuracy train: 0.937480 val: 0.749296 test: 0.773495
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.775464

========================================================================================================================================================================================================
max acc epoch :  6
max validation accuracy :  0.7718309859154929
test accuracy :  0.7754642656162071
last test_accuracy :  0.7734946539110861
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.76901 	 test_accuracy : 0.77181 	 max_acc epoch :  6 	 last test_accuracy : 0.76674
k :  1 	 val_accuracy : 0.76338 	 test_accuracy : 0.78194 	 max_acc epoch :  4 	 last test_accuracy : 0.77068
k :  2 	 val_accuracy : 0.76620 	 test_accuracy : 0.77968 	 max_acc epoch :  5 	 last test_accuracy : 0.77209
k :  3 	 val_accuracy : 0.76479 	 test_accuracy : 0.77940 	 max_acc epoch :  4 	 last test_accuracy : 0.77434
k :  4 	 val_accuracy : 0.76338 	 test_accuracy : 0.77406 	 max_acc epoch :  6 	 last test_accuracy : 0.77293
k :  5 	 val_accuracy : 0.76479 	 test_accuracy : 0.77462 	 max_acc epoch :  20 	 last test_accuracy : 0.76590
k :  6 	 val_accuracy : 0.77042 	 test_accuracy : 0.78222 	 max_acc epoch :  4 	 last test_accuracy : 0.77349
k :  7 	 val_accuracy : 0.76056 	 test_accuracy : 0.77518 	 max_acc epoch :  4 	 last test_accuracy : 0.77575
k :  8 	 val_accuracy : 0.76479 	 test_accuracy : 0.77265 	 max_acc epoch :  6 	 last test_accuracy : 0.77490
k :  9 	 val_accuracy : 0.77183 	 test_accuracy : 0.77546 	 max_acc epoch :  6 	 last test_accuracy : 0.77349

avg :  	 val_accuracy : 0.76592 	 test_accuracy : 0.77670 	 last_accuracy : 0.77203
