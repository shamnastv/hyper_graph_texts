

date and time :  Fri May 21 14:47:16 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=791, weight_decay=0)
device :  cuda:0
Counter({2: 2591, 1: 2556, 0: 2253})

Epoch :  1 loss training:  212.63370156288147 Time :  199
accuracy train: 0.632694 val: 0.570149 test: 0.594608
max validation accuracy : 0.570149 max acc epoch : 1 test accuracy : 0.594608
Epoch :  1 loss training:  274.3082011938095 Time :  272
accuracy train: 0.576439 val: 0.504478 test: 0.549592
Counter({0: 3109, 1: 2579, 2: 1712})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  142.87062120437622 Time :  378
accuracy train: 0.714097 val: 0.674627 test: 0.652980
max validation accuracy : 0.674627 max acc epoch : 2 test accuracy : 0.652980
Epoch :  2 loss training:  174.18959784507751 Time :  454
accuracy train: 0.602250 val: 0.549254 test: 0.554291
Counter({0: 2775, 1: 2555, 2: 2070})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  119.55524545907974 Time :  547
accuracy train: 0.760093 val: 0.695522 test: 0.679941
max validation accuracy : 0.695522 max acc epoch : 3 test accuracy : 0.679941
Epoch :  3 loss training:  146.70362320542336 Time :  621
accuracy train: 0.649570 val: 0.608955 test: 0.582241
Counter({1: 3080, 2: 2432, 0: 1888})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  100.30697712302208 Time :  726
accuracy train: 0.779947 val: 0.704478 test: 0.681672
max validation accuracy : 0.704478 max acc epoch : 4 test accuracy : 0.681672
Epoch :  4 loss training:  124.59460985660553 Time :  767
accuracy train: 0.693580 val: 0.591045 test: 0.603512
Counter({2: 2993, 1: 2567, 0: 1840})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  91.25453694164753 Time :  854
accuracy train: 0.812045 val: 0.725373 test: 0.683898
max validation accuracy : 0.725373 max acc epoch : 5 test accuracy : 0.683898
Epoch :  5 loss training:  107.07583114504814 Time :  934
accuracy train: 0.753805 val: 0.647761 test: 0.638387
Counter({1: 2808, 2: 2683, 0: 1909})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  87.16120994091034 Time :  1011
accuracy train: 0.824289 val: 0.716418 test: 0.698739
max validation accuracy : 0.725373 max acc epoch : 5 test accuracy : 0.683898
Epoch :  6 loss training:  93.75594426691532 Time :  1077
accuracy train: 0.738915 val: 0.608955 test: 0.627257
Counter({1: 2968, 2: 2476, 0: 1956})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  73.9005147665739 Time :  1164
accuracy train: 0.845467 val: 0.728358 test: 0.714321
max validation accuracy : 0.728358 max acc epoch : 7 test accuracy : 0.714321
Epoch :  7 loss training:  90.44871684908867 Time :  1220
accuracy train: 0.765718 val: 0.683582 test: 0.635914
Counter({2: 2697, 0: 2501, 1: 2202})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  71.58049550652504 Time :  1307
accuracy train: 0.863005 val: 0.728358 test: 0.707148
max validation accuracy : 0.728358 max acc epoch : 7 test accuracy : 0.714321
Epoch :  8 loss training:  82.62896919250488 Time :  1343
accuracy train: 0.716082 val: 0.591045 test: 0.606728
Counter({1: 2678, 2: 2594, 0: 2128})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  66.47738809883595 Time :  1411
accuracy train: 0.870285 val: 0.716418 test: 0.706901
max validation accuracy : 0.728358 max acc epoch : 7 test accuracy : 0.714321
Epoch :  9 loss training:  73.62176637351513 Time :  1474
accuracy train: 0.782594 val: 0.635821 test: 0.646550
Counter({0: 2839, 2: 2549, 1: 2012})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.629888862371445 Time :  1589
accuracy train: 0.886168 val: 0.737313 test: 0.708385
max validation accuracy : 0.737313 max acc epoch : 10 test accuracy : 0.708385
Epoch :  10 loss training:  69.23144586384296 Time :  1624
accuracy train: 0.769689 val: 0.647761 test: 0.625773
Counter({0: 2834, 2: 2577, 1: 1989})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.577796667814255 Time :  1707
accuracy train: 0.891132 val: 0.737313 test: 0.713332
max validation accuracy : 0.737313 max acc epoch : 10 test accuracy : 0.708385
Epoch :  11 loss training:  69.8727685213089 Time :  1744
accuracy train: 0.789212 val: 0.662687 test: 0.625773
Counter({2: 2782, 0: 2647, 1: 1971})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  57.293292835354805 Time :  1831
accuracy train: 0.896426 val: 0.743284 test: 0.708385
max validation accuracy : 0.743284 max acc epoch : 12 test accuracy : 0.708385
Epoch :  12 loss training:  57.5548262745142 Time :  1902
accuracy train: 0.826274 val: 0.650746 test: 0.650260
Counter({1: 2905, 2: 2597, 0: 1898})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  54.6371391415596 Time :  1962
accuracy train: 0.906353 val: 0.734328 test: 0.711600
max validation accuracy : 0.743284 max acc epoch : 12 test accuracy : 0.708385
Epoch :  13 loss training:  52.363472148776054 Time :  2013
accuracy train: 0.874586 val: 0.692537 test: 0.671036
Counter({0: 2855, 2: 2660, 1: 1885})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  54.51058265566826 Time :  2116
accuracy train: 0.906353 val: 0.746269 test: 0.709127
max validation accuracy : 0.746269 max acc epoch : 14 test accuracy : 0.709127
Epoch :  14 loss training:  47.59661840647459 Time :  2164
accuracy train: 0.883190 val: 0.713433 test: 0.677467
Counter({0: 2797, 2: 2594, 1: 2009})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  52.1626046448946 Time :  2262
accuracy train: 0.911979 val: 0.737313 test: 0.714074
max validation accuracy : 0.746269 max acc epoch : 14 test accuracy : 0.709127
Epoch :  15 loss training:  53.92904933542013 Time :  2313
accuracy train: 0.830907 val: 0.701493 test: 0.645066
Counter({1: 2859, 0: 2611, 2: 1930})

Epoch :  16 loss training:  52.44542899727821 Time :  2380
accuracy train: 0.910655 val: 0.746269 test: 0.715310
max validation accuracy : 0.746269 max acc epoch : 14 test accuracy : 0.709127
Epoch :  16 loss training:  46.62641067802906 Time :  2435
accuracy train: 0.871608 val: 0.686567 test: 0.651249
Counter({1: 2780, 0: 2689, 2: 1931})

Epoch :  17 loss training:  50.024254232645035 Time :  2519
accuracy train: 0.919921 val: 0.752239 test: 0.714074
max validation accuracy : 0.752239 max acc epoch : 17 test accuracy : 0.714074
Epoch :  17 loss training:  41.016236305236816 Time :  2557
accuracy train: 0.889808 val: 0.701493 test: 0.671778
Counter({1: 2819, 2: 2380, 0: 2201})

Epoch :  18 loss training:  50.251099705696106 Time :  2644
accuracy train: 0.921575 val: 0.749254 test: 0.713332
max validation accuracy : 0.752239 max acc epoch : 17 test accuracy : 0.714074
Epoch :  18 loss training:  37.062765933573246 Time :  2703
accuracy train: 0.908339 val: 0.695522 test: 0.664111
Counter({2: 2804, 1: 2432, 0: 2164})

Epoch :  19 loss training:  46.32232113927603 Time :  2792
accuracy train: 0.932164 val: 0.749254 test: 0.708385
max validation accuracy : 0.752239 max acc epoch : 17 test accuracy : 0.714074
Epoch :  19 loss training:  35.35718823596835 Time :  2857
accuracy train: 0.902713 val: 0.701493 test: 0.668810
Counter({0: 2661, 1: 2641, 2: 2098})

Epoch :  20 loss training:  46.722692266106606 Time :  2931
accuracy train: 0.935804 val: 0.752239 test: 0.712342
max validation accuracy : 0.752239 max acc epoch : 17 test accuracy : 0.714074
Epoch :  20 loss training:  36.64564947783947 Time :  2967
accuracy train: 0.915619 val: 0.692537 test: 0.662627
Counter({2: 2731, 1: 2659, 0: 2010})

Epoch :  21 loss training:  43.68064346909523 Time :  3034
accuracy train: 0.935804 val: 0.746269 test: 0.713579
max validation accuracy : 0.752239 max acc epoch : 17 test accuracy : 0.714074
Epoch :  21 loss training:  36.57487578690052 Time :  3073
accuracy train: 0.920251 val: 0.728358 test: 0.677220
Counter({2: 2872, 0: 2588, 1: 1940})

Epoch :  22 loss training:  42.03803611546755 Time :  3128
accuracy train: 0.941430 val: 0.746269 test: 0.715558
max validation accuracy : 0.752239 max acc epoch : 17 test accuracy : 0.714074
Epoch :  22 loss training:  31.295903243124485 Time :  3164
accuracy train: 0.911979 val: 0.683582 test: 0.661885
Counter({1: 2793, 2: 2622, 0: 1985})

Epoch :  23 loss training:  41.81111516058445 Time :  3214
accuracy train: 0.947055 val: 0.761194 test: 0.717042
max validation accuracy : 0.761194 max acc epoch : 23 test accuracy : 0.717042
Epoch :  23 loss training:  27.698031509295106 Time :  3256
accuracy train: 0.935473 val: 0.698507 test: 0.688103
Counter({1: 2814, 0: 2681, 2: 1905})

Epoch :  24 loss training:  40.48459171503782 Time :  3328
accuracy train: 0.947717 val: 0.755224 test: 0.715310
max validation accuracy : 0.761194 max acc epoch : 23 test accuracy : 0.717042
Epoch :  24 loss training:  25.624011989682913 Time :  3355
accuracy train: 0.922237 val: 0.680597 test: 0.666584
Counter({1: 2956, 2: 2543, 0: 1901})

Epoch :  25 loss training:  39.9638786688447 Time :  3410
accuracy train: 0.948048 val: 0.758209 test: 0.714816
max validation accuracy : 0.761194 max acc epoch : 23 test accuracy : 0.717042
Epoch :  25 loss training:  33.05036651343107 Time :  3445
accuracy train: 0.945731 val: 0.713433 test: 0.674252
Counter({2: 3023, 1: 2544, 0: 1833})

Epoch :  26 loss training:  38.82110306620598 Time :  3526
accuracy train: 0.954004 val: 0.743284 test: 0.712342
max validation accuracy : 0.761194 max acc epoch : 23 test accuracy : 0.717042
Epoch :  26 loss training:  25.865927193313837 Time :  3551
accuracy train: 0.957644 val: 0.704478 test: 0.686124
Counter({0: 2978, 1: 2566, 2: 1856})

Epoch :  27 loss training:  37.79894217848778 Time :  3616
accuracy train: 0.958968 val: 0.761194 test: 0.716300
max validation accuracy : 0.761194 max acc epoch : 23 test accuracy : 0.717042
Epoch :  27 loss training:  31.116786155849695 Time :  3645
accuracy train: 0.936135 val: 0.647761 test: 0.672273
Counter({2: 2869, 0: 2542, 1: 1989})

Epoch :  28 loss training:  35.94194723665714 Time :  3718
accuracy train: 0.965255 val: 0.758209 test: 0.717536
max validation accuracy : 0.761194 max acc epoch : 23 test accuracy : 0.717042
Epoch :  28 loss training:  29.914948977530003 Time :  3771
accuracy train: 0.916942 val: 0.644776 test: 0.654959
Counter({2: 2815, 0: 2691, 1: 1894})

Epoch :  29 loss training:  34.394283302128315 Time :  3825
accuracy train: 0.967902 val: 0.755224 test: 0.715063
max validation accuracy : 0.761194 max acc epoch : 23 test accuracy : 0.717042
Epoch :  29 loss training:  34.085311476141214 Time :  3851
accuracy train: 0.945069 val: 0.683582 test: 0.668068
Counter({0: 2778, 1: 2640, 2: 1982})

Epoch :  30 loss training:  34.425370775163174 Time :  3917
accuracy train: 0.966578 val: 0.749254 test: 0.712837
max validation accuracy : 0.761194 max acc epoch : 23 test accuracy : 0.717042
Epoch :  30 loss training:  25.926179327070713 Time :  3959
accuracy train: 0.923230 val: 0.662687 test: 0.648281
Counter({1: 2789, 2: 2683, 0: 1928})

Epoch :  31 loss training:  33.23018531501293 Time :  4016
accuracy train: 0.968233 val: 0.764179 test: 0.711848
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  31 loss training:  20.90016010031104 Time :  4053
accuracy train: 0.967571 val: 0.716418 test: 0.682909
Counter({2: 2758, 1: 2714, 0: 1928})

Epoch :  32 loss training:  31.309398271143436 Time :  4131
accuracy train: 0.974851 val: 0.755224 test: 0.713826
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  32 loss training:  19.175773100927472 Time :  4172
accuracy train: 0.975513 val: 0.686567 test: 0.670294
Counter({0: 2818, 2: 2641, 1: 1941})

Epoch :  33 loss training:  30.001473531126976 Time :  4247
accuracy train: 0.975844 val: 0.746269 test: 0.716300
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  33 loss training:  18.617897871881723 Time :  4278
accuracy train: 0.974520 val: 0.695522 test: 0.679446
Counter({2: 2752, 0: 2688, 1: 1960})

Epoch :  34 loss training:  28.733852967619896 Time :  4336
accuracy train: 0.979815 val: 0.743284 test: 0.717536
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  34 loss training:  16.021289259195328 Time :  4373
accuracy train: 0.968895 val: 0.695522 test: 0.672768
Counter({1: 2703, 0: 2679, 2: 2018})

Epoch :  35 loss training:  27.302988834679127 Time :  4448
accuracy train: 0.978491 val: 0.749254 test: 0.716052
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  35 loss training:  15.422030198387802 Time :  4479
accuracy train: 0.971542 val: 0.677612 test: 0.656938
Counter({2: 2755, 0: 2670, 1: 1975})

Epoch :  36 loss training:  27.20885094255209 Time :  4540
accuracy train: 0.981800 val: 0.755224 test: 0.714568
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  36 loss training:  16.16282313875854 Time :  4569
accuracy train: 0.967902 val: 0.707463 test: 0.660153
Counter({0: 2745, 2: 2745, 1: 1910})

Epoch :  37 loss training:  27.041548795998096 Time :  4648
accuracy train: 0.982462 val: 0.761194 test: 0.712590
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  37 loss training:  17.517652167007327 Time :  4687
accuracy train: 0.984447 val: 0.713433 test: 0.677220
Counter({0: 2959, 1: 2441, 2: 2000})

Epoch :  38 loss training:  24.666925944387913 Time :  4747
accuracy train: 0.983455 val: 0.755224 test: 0.717536
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  38 loss training:  16.992854334414005 Time :  4778
accuracy train: 0.982131 val: 0.680597 test: 0.670789
Counter({2: 3255, 0: 2089, 1: 2056})

Epoch :  39 loss training:  23.42753115296364 Time :  4865
accuracy train: 0.987426 val: 0.749254 test: 0.716052
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  39 loss training:  19.087130379863083 Time :  4906
accuracy train: 0.970880 val: 0.683582 test: 0.660401
Counter({0: 2815, 1: 2646, 2: 1939})

Epoch :  40 loss training:  24.185822263360023 Time :  4975
accuracy train: 0.985771 val: 0.764179 test: 0.717042
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  40 loss training:  18.692040339112282 Time :  5015
accuracy train: 0.982462 val: 0.698507 test: 0.686372
Counter({0: 2892, 2: 2668, 1: 1840})

Epoch :  41 loss training:  23.687299117445946 Time :  5083
accuracy train: 0.986433 val: 0.758209 test: 0.717536
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  41 loss training:  15.626756247133017 Time :  5128
accuracy train: 0.983786 val: 0.701493 test: 0.679199
Counter({0: 2810, 1: 2748, 2: 1842})

Epoch :  42 loss training:  22.48572661355138 Time :  5203
accuracy train: 0.990404 val: 0.749254 test: 0.713332
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  42 loss training:  16.420980237424374 Time :  5230
accuracy train: 0.964924 val: 0.701493 test: 0.665348
Counter({1: 2855, 2: 2718, 0: 1827})

Epoch :  43 loss training:  21.04423164948821 Time :  5306
accuracy train: 0.991066 val: 0.752239 test: 0.713332
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  43 loss training:  16.693472949787974 Time :  5335
accuracy train: 0.969887 val: 0.668657 test: 0.665100
Counter({0: 2860, 1: 2626, 2: 1914})

Epoch :  44 loss training:  21.38159029558301 Time :  5416
accuracy train: 0.993382 val: 0.743284 test: 0.715805
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  44 loss training:  20.493955947458744 Time :  5451
accuracy train: 0.980146 val: 0.728358 test: 0.676478
Counter({0: 2770, 1: 2495, 2: 2135})

Epoch :  45 loss training:  20.963207826018333 Time :  5527
accuracy train: 0.993051 val: 0.749254 test: 0.716794
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  45 loss training:  32.807945584878325 Time :  5567
accuracy train: 0.927201 val: 0.644776 test: 0.639871
Counter({2: 2886, 1: 2379, 0: 2135})

Epoch :  46 loss training:  20.321464981883764 Time :  5655
accuracy train: 0.991727 val: 0.755224 test: 0.718031
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  46 loss training:  28.26210255920887 Time :  5692
accuracy train: 0.973858 val: 0.689552 test: 0.677715
Counter({0: 3077, 1: 2213, 2: 2110})

Epoch :  47 loss training:  18.411673616617918 Time :  5772
accuracy train: 0.994044 val: 0.746269 test: 0.719763
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  47 loss training:  19.705558704212308 Time :  5801
accuracy train: 0.974520 val: 0.689552 test: 0.659906
Counter({0: 2790, 2: 2452, 1: 2158})

Epoch :  48 loss training:  18.13942639157176 Time :  5890
accuracy train: 0.994375 val: 0.740299 test: 0.714568
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  48 loss training:  20.089199183508754 Time :  5939
accuracy train: 0.968564 val: 0.716418 test: 0.678209
Counter({0: 3019, 2: 2507, 1: 1874})

Epoch :  49 loss training:  17.998885560780764 Time :  6024
accuracy train: 0.995367 val: 0.755224 test: 0.716300
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  49 loss training:  15.278108328580856 Time :  6063
accuracy train: 0.978822 val: 0.710448 test: 0.670542
Counter({2: 2827, 0: 2468, 1: 2105})

Epoch :  50 loss training:  17.25273340009153 Time :  6163
accuracy train: 0.997684 val: 0.737313 test: 0.718526
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  50 loss training:  16.717588357627392 Time :  6205
accuracy train: 0.983786 val: 0.734328 test: 0.681672
Counter({0: 3480, 1: 2053, 2: 1867})

Epoch :  51 loss training:  15.844649862498045 Time :  6294
accuracy train: 0.997353 val: 0.758209 test: 0.716547
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  51 loss training:  20.84261440951377 Time :  6333
accuracy train: 0.975182 val: 0.704478 test: 0.671036
Counter({1: 3017, 2: 2318, 0: 2065})

Epoch :  52 loss training:  16.4334554746747 Time :  6424
accuracy train: 0.996691 val: 0.764179 test: 0.719763
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  52 loss training:  16.894197577610612 Time :  6459
accuracy train: 0.988418 val: 0.704478 test: 0.668068
Counter({2: 2805, 1: 2559, 0: 2036})

Epoch :  53 loss training:  14.978430937975645 Time :  6540
accuracy train: 0.998345 val: 0.761194 test: 0.718279
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  53 loss training:  20.30981755629182 Time :  6582
accuracy train: 0.984778 val: 0.713433 test: 0.677467
Counter({0: 2887, 1: 2512, 2: 2001})

Epoch :  54 loss training:  14.986867304891348 Time :  6665
accuracy train: 0.997684 val: 0.737313 test: 0.714816
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  54 loss training:  12.677188546396792 Time :  6707
accuracy train: 0.993713 val: 0.710448 test: 0.680683
Counter({2: 2787, 0: 2668, 1: 1945})

Epoch :  55 loss training:  14.678866198286414 Time :  6788
accuracy train: 0.998345 val: 0.740299 test: 0.715310
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  55 loss training:  11.604352289810777 Time :  6829
accuracy train: 0.992389 val: 0.722388 test: 0.684393
Counter({0: 2791, 2: 2306, 1: 2303})

Epoch :  56 loss training:  13.831477485597134 Time :  6911
accuracy train: 0.998345 val: 0.746269 test: 0.717042
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  56 loss training:  12.759476404637098 Time :  6959
accuracy train: 0.989411 val: 0.731343 test: 0.692060
Counter({2: 2921, 1: 2409, 0: 2070})

Epoch :  57 loss training:  13.090300753712654 Time :  7031
accuracy train: 0.999007 val: 0.752239 test: 0.719515
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  57 loss training:  14.631875639781356 Time :  7071
accuracy train: 0.960291 val: 0.719403 test: 0.663121
Counter({2: 2947, 0: 2270, 1: 2183})

Epoch :  58 loss training:  13.693752815946937 Time :  7143
accuracy train: 0.999669 val: 0.740299 test: 0.716794
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  58 loss training:  15.036456970032305 Time :  7178
accuracy train: 0.988087 val: 0.719403 test: 0.680188
Counter({0: 2850, 2: 2609, 1: 1941})

Epoch :  59 loss training:  12.014900881797075 Time :  7250
accuracy train: 0.998676 val: 0.755224 test: 0.718031
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  59 loss training:  12.078914281912148 Time :  7288
accuracy train: 0.980807 val: 0.677612 test: 0.658422
Counter({0: 2858, 1: 2527, 2: 2015})

Epoch :  60 loss training:  11.187521893531084 Time :  7349
accuracy train: 0.999338 val: 0.755224 test: 0.714321
max validation accuracy : 0.764179 max acc epoch : 31 test accuracy : 0.711848
Epoch :  60 loss training:  14.553024170920253 Time :  7385
accuracy train: 0.968564 val: 0.695522 test: 0.664853
Counter({2: 2943, 1: 2567, 0: 1890})

Epoch :  61 loss training:  11.107311945408583 Time :  7465
accuracy train: 0.999007 val: 0.767164 test: 0.719021
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  61 loss training:  13.940895122243091 Time :  7491
accuracy train: 0.976506 val: 0.689552 test: 0.671778
Counter({2: 2941, 1: 2476, 0: 1983})

Epoch :  62 loss training:  11.386048128828406 Time :  7570
accuracy train: 0.999338 val: 0.758209 test: 0.718526
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  62 loss training:  14.348195138387382 Time :  7606
accuracy train: 0.993713 val: 0.719403 test: 0.689092
Counter({0: 2965, 2: 2514, 1: 1921})

Epoch :  63 loss training:  10.454838532954454 Time :  7693
accuracy train: 1.000000 val: 0.758209 test: 0.717042
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  63 loss training:  9.09259140631184 Time :  7723
accuracy train: 0.991727 val: 0.707463 test: 0.690082
Counter({1: 3482, 0: 2665, 2: 1253})

Epoch :  64 loss training:  10.080545283854008 Time :  7784
accuracy train: 0.999669 val: 0.743284 test: 0.721247
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  64 loss training:  12.501194997690618 Time :  7805
accuracy train: 0.968895 val: 0.677612 test: 0.641603
Counter({2: 2647, 0: 2512, 1: 2241})

Epoch :  65 loss training:  10.717463991604745 Time :  7873
accuracy train: 0.999669 val: 0.746269 test: 0.718773
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  65 loss training:  14.96450450271368 Time :  7908
accuracy train: 0.986433 val: 0.698507 test: 0.669800
Counter({1: 2752, 0: 2507, 2: 2141})

Epoch :  66 loss training:  8.962815904989839 Time :  7950
accuracy train: 1.000000 val: 0.767164 test: 0.721989
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  66 loss training:  14.044990673661232 Time :  7977
accuracy train: 0.940768 val: 0.656716 test: 0.623547
Counter({2: 2984, 0: 2735, 1: 1681})

Epoch :  67 loss training:  9.722026505507529 Time :  8033
accuracy train: 0.999669 val: 0.752239 test: 0.721247
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  67 loss training:  16.342776395380497 Time :  8074
accuracy train: 0.974520 val: 0.671642 test: 0.656691
Counter({0: 4171, 1: 1993, 2: 1236})

Epoch :  68 loss training:  9.334298581816256 Time :  8147
accuracy train: 1.000000 val: 0.758209 test: 0.719268
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  68 loss training:  15.098206358263269 Time :  8185
accuracy train: 0.993051 val: 0.695522 test: 0.678209
Counter({1: 4229, 2: 2018, 0: 1153})

Epoch :  69 loss training:  7.932084864936769 Time :  8256
accuracy train: 1.000000 val: 0.758209 test: 0.718279
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  69 loss training:  8.732003953773528 Time :  8297
accuracy train: 0.985440 val: 0.695522 test: 0.672520
Counter({0: 3334, 1: 2249, 2: 1817})

Epoch :  70 loss training:  7.879967013373971 Time :  8377
accuracy train: 1.000000 val: 0.761194 test: 0.716052
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  70 loss training:  8.718617497943342 Time :  8413
accuracy train: 0.994705 val: 0.686567 test: 0.679199
Counter({1: 4863, 2: 1385, 0: 1152})

Epoch :  71 loss training:  8.408809058368206 Time :  8455
accuracy train: 1.000000 val: 0.755224 test: 0.719021
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  71 loss training:  9.104304036591202 Time :  8499
accuracy train: 0.994044 val: 0.710448 test: 0.689587
Counter({1: 3144, 0: 3117, 2: 1139})

Epoch :  72 loss training:  7.450045852921903 Time :  8561
accuracy train: 0.999669 val: 0.749254 test: 0.719021
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  72 loss training:  8.50029858155176 Time :  8586
accuracy train: 0.998676 val: 0.704478 test: 0.684393
Counter({2: 4101, 0: 2026, 1: 1273})

Epoch :  73 loss training:  7.782854216173291 Time :  8661
accuracy train: 0.999669 val: 0.743284 test: 0.716300
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  73 loss training:  7.634319267235696 Time :  8713
accuracy train: 0.996360 val: 0.710448 test: 0.689092
Counter({1: 2740, 0: 2668, 2: 1992})

Epoch :  74 loss training:  7.313189062289894 Time :  8767
accuracy train: 1.000000 val: 0.746269 test: 0.716300
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  74 loss training:  8.47845058934763 Time :  8797
accuracy train: 0.996029 val: 0.716418 test: 0.681672
Counter({0: 2765, 1: 2679, 2: 1956})

Epoch :  75 loss training:  7.407836860045791 Time :  8865
accuracy train: 1.000000 val: 0.764179 test: 0.722236
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  75 loss training:  8.831650294363499 Time :  8897
accuracy train: 0.997022 val: 0.704478 test: 0.683156
Counter({2: 3516, 0: 2668, 1: 1216})

Epoch :  76 loss training:  6.490559017285705 Time :  8968
accuracy train: 1.000000 val: 0.743284 test: 0.720505
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  76 loss training:  12.10027137491852 Time :  9000
accuracy train: 0.991396 val: 0.689552 test: 0.685629
Counter({0: 3216, 2: 3046, 1: 1138})

Epoch :  77 loss training:  6.975494206417352 Time :  9052
accuracy train: 1.000000 val: 0.746269 test: 0.720010
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  77 loss training:  7.87882234621793 Time :  9086
accuracy train: 0.997022 val: 0.716418 test: 0.684887
Counter({1: 3656, 2: 2655, 0: 1089})

Epoch :  78 loss training:  6.978353139013052 Time :  9155
accuracy train: 1.000000 val: 0.743284 test: 0.719763
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  78 loss training:  11.868449025554582 Time :  9190
accuracy train: 0.994044 val: 0.713433 test: 0.679693
Counter({1: 3470, 2: 2781, 0: 1149})

Epoch :  79 loss training:  6.658459706697613 Time :  9257
accuracy train: 1.000000 val: 0.764179 test: 0.719763
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  79 loss training:  18.14098846213892 Time :  9279
accuracy train: 0.990073 val: 0.731343 test: 0.676478
Counter({0: 2708, 1: 2595, 2: 2097})

Epoch :  80 loss training:  6.219595763832331 Time :  9356
accuracy train: 1.000000 val: 0.761194 test: 0.716794
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  80 loss training:  12.57531978096813 Time :  9398
accuracy train: 0.995367 val: 0.731343 test: 0.669305
Counter({0: 3082, 1: 2283, 2: 2035})

Epoch :  81 loss training:  5.348816237878054 Time :  9446
accuracy train: 1.000000 val: 0.761194 test: 0.720010
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  81 loss training:  10.965303068049252 Time :  9484
accuracy train: 0.995367 val: 0.737313 test: 0.676973
Counter({0: 2917, 2: 2446, 1: 2037})

Epoch :  82 loss training:  5.697879228740931 Time :  9541
accuracy train: 1.000000 val: 0.755224 test: 0.720010
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  82 loss training:  7.80236079567112 Time :  9589
accuracy train: 0.993713 val: 0.734328 test: 0.679941
Counter({1: 2815, 2: 2498, 0: 2087})

Epoch :  83 loss training:  5.260256389155984 Time :  9656
accuracy train: 1.000000 val: 0.752239 test: 0.720505
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  83 loss training:  9.13845635310281 Time :  9679
accuracy train: 0.997684 val: 0.710448 test: 0.689834
Counter({0: 2992, 2: 2303, 1: 2105})

Epoch :  84 loss training:  4.832455881871283 Time :  9758
accuracy train: 1.000000 val: 0.758209 test: 0.723473
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  84 loss training:  6.766740280319937 Time :  9809
accuracy train: 0.997022 val: 0.731343 test: 0.688598
Counter({0: 2916, 2: 2352, 1: 2132})

Epoch :  85 loss training:  5.563810357358307 Time :  9863
accuracy train: 1.000000 val: 0.755224 test: 0.720257
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  85 loss training:  5.9147175184916705 Time :  9894
accuracy train: 0.996360 val: 0.722388 test: 0.693792
Counter({2: 2764, 0: 2517, 1: 2119})

Epoch :  86 loss training:  5.05017156759277 Time :  9955
accuracy train: 1.000000 val: 0.764179 test: 0.721247
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  86 loss training:  4.2685281379381195 Time :  9983
accuracy train: 0.998015 val: 0.722388 test: 0.687114
Counter({1: 2991, 2: 2460, 0: 1949})

Epoch :  87 loss training:  4.605689380783588 Time :  10057
accuracy train: 1.000000 val: 0.761194 test: 0.725699
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  87 loss training:  5.717303322860971 Time :  10088
accuracy train: 0.999007 val: 0.737313 test: 0.697007
Counter({2: 3516, 0: 2668, 1: 1216})

Epoch :  88 loss training:  5.027980130864307 Time :  10158
accuracy train: 1.000000 val: 0.758209 test: 0.716794
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  88 loss training:  5.799743569921702 Time :  10200
accuracy train: 0.996691 val: 0.719403 test: 0.692555
Counter({2: 2709, 0: 2540, 1: 2151})

Epoch :  89 loss training:  4.592765076551586 Time :  10291
accuracy train: 1.000000 val: 0.764179 test: 0.716300
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  89 loss training:  12.346795122139156 Time :  10326
accuracy train: 0.974851 val: 0.680597 test: 0.646302
Counter({1: 3715, 0: 1890, 2: 1795})

Epoch :  90 loss training:  4.989990460453555 Time :  10424
accuracy train: 1.000000 val: 0.761194 test: 0.720999
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  90 loss training:  16.652871461585164 Time :  10475
accuracy train: 0.982793 val: 0.695522 test: 0.665348
Counter({0: 2868, 1: 2517, 2: 2015})

Epoch :  91 loss training:  4.265314340591431 Time :  10565
accuracy train: 1.000000 val: 0.752239 test: 0.720752
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  91 loss training:  17.383889629039913 Time :  10597
accuracy train: 0.994044 val: 0.713433 test: 0.683651
Counter({0: 3070, 1: 2370, 2: 1960})

Epoch :  92 loss training:  4.274840752594173 Time :  10684
accuracy train: 1.000000 val: 0.755224 test: 0.721247
max validation accuracy : 0.767164 max acc epoch : 61 test accuracy : 0.719021
Epoch :  92 loss training:  9.22530169179663 Time :  10741
accuracy train: 0.985771 val: 0.716418 test: 0.661637
Counter({2: 3335, 1: 2457, 0: 1608})

========================================================================================================================================================================================================
max acc epoch :  61
max validation accuracy :  0.7671641791044777
test accuracy :  0.7190205293099183
last test_accuracy :  0.7212465990601039
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=791, weight_decay=0)
device :  cuda:0
Counter({2: 2591, 1: 2556, 0: 2253})

Epoch :  1 loss training:  212.38270944356918 Time :  10913
accuracy train: 0.639974 val: 0.576119 test: 0.594608
max validation accuracy : 0.576119 max acc epoch : 1 test accuracy : 0.594608
Epoch :  1 loss training:  273.6595264673233 Time :  10960
accuracy train: 0.565850 val: 0.492537 test: 0.544645
Counter({1: 3103, 0: 2546, 2: 1751})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  142.399684548378 Time :  11054
accuracy train: 0.712773 val: 0.650746 test: 0.645560
max validation accuracy : 0.650746 max acc epoch : 2 test accuracy : 0.645560
Epoch :  2 loss training:  174.03452944755554 Time :  11078
accuracy train: 0.609199 val: 0.564179 test: 0.557754
Counter({2: 3397, 1: 2115, 0: 1888})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  123.79750418663025 Time :  11191
accuracy train: 0.762740 val: 0.707463 test: 0.680683
max validation accuracy : 0.707463 max acc epoch : 3 test accuracy : 0.680683
Epoch :  3 loss training:  143.7498851120472 Time :  11239
accuracy train: 0.670748 val: 0.617910 test: 0.595845
Counter({0: 3333, 2: 2197, 1: 1870})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  101.22728669643402 Time :  11326
accuracy train: 0.784580 val: 0.689552 test: 0.686372
max validation accuracy : 0.707463 max acc epoch : 3 test accuracy : 0.680683
Epoch :  4 loss training:  123.1647701561451 Time :  11362
accuracy train: 0.684646 val: 0.597015 test: 0.600544
Counter({1: 2710, 0: 2635, 2: 2055})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  89.35836172103882 Time :  11430
accuracy train: 0.825612 val: 0.749254 test: 0.690082
max validation accuracy : 0.749254 max acc epoch : 5 test accuracy : 0.690082
Epoch :  5 loss training:  112.89621922373772 Time :  11493
accuracy train: 0.740900 val: 0.626866 test: 0.637645
Counter({0: 2732, 1: 2583, 2: 2085})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  85.36334666609764 Time :  11559
accuracy train: 0.836532 val: 0.728358 test: 0.704180
max validation accuracy : 0.749254 max acc epoch : 5 test accuracy : 0.690082
Epoch :  6 loss training:  96.99875992536545 Time :  11592
accuracy train: 0.704500 val: 0.591045 test: 0.604996
Counter({1: 2935, 0: 2387, 2: 2078})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  73.65241520106792 Time :  11669
accuracy train: 0.858041 val: 0.728358 test: 0.709869
max validation accuracy : 0.749254 max acc epoch : 5 test accuracy : 0.690082
Epoch :  7 loss training:  92.40819698572159 Time :  11711
accuracy train: 0.765387 val: 0.653731 test: 0.643087
Counter({1: 2916, 2: 2437, 0: 2047})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  70.94592118263245 Time :  11775
accuracy train: 0.861350 val: 0.734328 test: 0.706406
max validation accuracy : 0.749254 max acc epoch : 5 test accuracy : 0.690082
Epoch :  8 loss training:  80.3275563120842 Time :  11812
accuracy train: 0.736267 val: 0.623881 test: 0.624042
Counter({2: 3011, 1: 2420, 0: 1969})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.99235838651657 Time :  11878
accuracy train: 0.878557 val: 0.734328 test: 0.707395
max validation accuracy : 0.749254 max acc epoch : 5 test accuracy : 0.690082
Epoch :  9 loss training:  81.3573746830225 Time :  11916
accuracy train: 0.750496 val: 0.620896 test: 0.627010
Counter({1: 3006, 2: 2457, 0: 1937})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.02380220592022 Time :  12004
accuracy train: 0.892124 val: 0.740299 test: 0.710858
max validation accuracy : 0.749254 max acc epoch : 5 test accuracy : 0.690082
Epoch :  10 loss training:  69.48759743571281 Time :  12034
accuracy train: 0.773991 val: 0.653731 test: 0.627257
Counter({2: 2871, 0: 2565, 1: 1964})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.29673482477665 Time :  12102
accuracy train: 0.895764 val: 0.749254 test: 0.709127
max validation accuracy : 0.749254 max acc epoch : 5 test accuracy : 0.690082
Epoch :  11 loss training:  65.76929593086243 Time :  12141
accuracy train: 0.780940 val: 0.650746 test: 0.610438
Counter({1: 2742, 0: 2617, 2: 2041})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  57.511756010353565 Time :  12205
accuracy train: 0.897750 val: 0.746269 test: 0.710116
max validation accuracy : 0.749254 max acc epoch : 5 test accuracy : 0.690082
Epoch :  12 loss training:  59.15877057611942 Time :  12259
accuracy train: 0.824619 val: 0.659701 test: 0.649270
Counter({2: 2829, 1: 2610, 0: 1961})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  54.78036993741989 Time :  12332
accuracy train: 0.909332 val: 0.743284 test: 0.712590
max validation accuracy : 0.749254 max acc epoch : 5 test accuracy : 0.690082
Epoch :  13 loss training:  52.93918500840664 Time :  12362
accuracy train: 0.855725 val: 0.710448 test: 0.666584
Counter({0: 2924, 1: 2532, 2: 1944})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  55.45054470002651 Time :  12431
accuracy train: 0.910324 val: 0.752239 test: 0.713826
max validation accuracy : 0.752239 max acc epoch : 14 test accuracy : 0.713826
Epoch :  14 loss training:  49.037642419338226 Time :  12486
accuracy train: 0.879219 val: 0.683582 test: 0.664853
Counter({2: 2814, 1: 2624, 0: 1962})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  51.289530359208584 Time :  12559
accuracy train: 0.915950 val: 0.743284 test: 0.717289
max validation accuracy : 0.752239 max acc epoch : 14 test accuracy : 0.713826
Epoch :  15 loss training:  49.7391619682312 Time :  12593
accuracy train: 0.864659 val: 0.713433 test: 0.658669
Counter({2: 2809, 0: 2683, 1: 1908})

Epoch :  16 loss training:  51.5945011228323 Time :  12657
accuracy train: 0.915950 val: 0.743284 test: 0.715558
max validation accuracy : 0.752239 max acc epoch : 14 test accuracy : 0.713826
Epoch :  16 loss training:  45.47729302942753 Time :  12707
accuracy train: 0.868961 val: 0.677612 test: 0.654712
Counter({1: 2831, 2: 2626, 0: 1943})

Epoch :  17 loss training:  48.98913003504276 Time :  12773
accuracy train: 0.925546 val: 0.755224 test: 0.716794
max validation accuracy : 0.755224 max acc epoch : 17 test accuracy : 0.716794
Epoch :  17 loss training:  41.32589615881443 Time :  12809
accuracy train: 0.850761 val: 0.674627 test: 0.647786
Counter({1: 2860, 0: 2648, 2: 1892})

Epoch :  18 loss training:  49.659454345703125 Time :  12881
accuracy train: 0.926539 val: 0.764179 test: 0.720010
max validation accuracy : 0.764179 max acc epoch : 18 test accuracy : 0.720010
Epoch :  18 loss training:  40.32177706062794 Time :  12912
accuracy train: 0.892786 val: 0.653731 test: 0.649518
Counter({1: 2841, 2: 2708, 0: 1851})

Epoch :  19 loss training:  47.252453342080116 Time :  12990
accuracy train: 0.931171 val: 0.755224 test: 0.715063
max validation accuracy : 0.764179 max acc epoch : 18 test accuracy : 0.720010
Epoch :  19 loss training:  40.88082851469517 Time :  13028
accuracy train: 0.863997 val: 0.695522 test: 0.660648
Counter({1: 2852, 0: 2706, 2: 1842})

Epoch :  20 loss training:  45.282904237508774 Time :  13072
accuracy train: 0.934480 val: 0.761194 test: 0.715063
max validation accuracy : 0.764179 max acc epoch : 18 test accuracy : 0.720010
Epoch :  20 loss training:  35.870773857459426 Time :  13105
accuracy train: 0.923230 val: 0.683582 test: 0.681177
Counter({1: 2781, 0: 2740, 2: 1879})

Epoch :  21 loss training:  43.367603592574596 Time :  13163
accuracy train: 0.935142 val: 0.764179 test: 0.715063
max validation accuracy : 0.764179 max acc epoch : 18 test accuracy : 0.720010
Epoch :  21 loss training:  33.277936700731516 Time :  13197
accuracy train: 0.915619 val: 0.695522 test: 0.677467
Counter({1: 2781, 0: 2733, 2: 1886})

Epoch :  22 loss training:  43.900907441973686 Time :  13259
accuracy train: 0.946062 val: 0.749254 test: 0.713579
max validation accuracy : 0.764179 max acc epoch : 18 test accuracy : 0.720010
Epoch :  22 loss training:  27.848161682486534 Time :  13294
accuracy train: 0.918928 val: 0.710448 test: 0.667326
Counter({0: 3017, 1: 2537, 2: 1846})

Epoch :  23 loss training:  40.762846522033215 Time :  13339
accuracy train: 0.946724 val: 0.761194 test: 0.717536
max validation accuracy : 0.764179 max acc epoch : 18 test accuracy : 0.720010
Epoch :  23 loss training:  31.726485956460238 Time :  13382
accuracy train: 0.924884 val: 0.719403 test: 0.672026
Counter({1: 3933, 2: 1884, 0: 1583})

Epoch :  24 loss training:  41.783869951963425 Time :  13454
accuracy train: 0.949702 val: 0.752239 test: 0.716547
max validation accuracy : 0.764179 max acc epoch : 18 test accuracy : 0.720010
Epoch :  24 loss training:  27.46654350683093 Time :  13485
accuracy train: 0.913964 val: 0.662687 test: 0.661885
Counter({0: 3504, 1: 1984, 2: 1912})

Epoch :  25 loss training:  39.38739404082298 Time :  13549
accuracy train: 0.951357 val: 0.767164 test: 0.719515
max validation accuracy : 0.767164 max acc epoch : 25 test accuracy : 0.719515
Epoch :  25 loss training:  30.023575134575367 Time :  13596
accuracy train: 0.950695 val: 0.692537 test: 0.676725
Counter({0: 2869, 1: 2601, 2: 1930})

Epoch :  26 loss training:  37.481710851192474 Time :  13669
accuracy train: 0.955989 val: 0.764179 test: 0.717536
max validation accuracy : 0.767164 max acc epoch : 25 test accuracy : 0.719515
Epoch :  26 loss training:  25.472718462347984 Time :  13692
accuracy train: 0.956982 val: 0.698507 test: 0.681425
Counter({0: 3004, 1: 2534, 2: 1862})

Epoch :  27 loss training:  37.25468073040247 Time :  13769
accuracy train: 0.962277 val: 0.758209 test: 0.719021
max validation accuracy : 0.767164 max acc epoch : 25 test accuracy : 0.719515
Epoch :  27 loss training:  27.50518588721752 Time :  13811
accuracy train: 0.958306 val: 0.719403 test: 0.678704
Counter({0: 2869, 1: 2600, 2: 1931})

Epoch :  28 loss training:  35.8177080526948 Time :  13866
accuracy train: 0.963931 val: 0.758209 test: 0.722236
max validation accuracy : 0.767164 max acc epoch : 25 test accuracy : 0.719515
Epoch :  28 loss training:  24.320119857788086 Time :  13895
accuracy train: 0.943415 val: 0.689552 test: 0.674004
Counter({1: 2995, 0: 2437, 2: 1968})

Epoch :  29 loss training:  33.02085629850626 Time :  13955
accuracy train: 0.967902 val: 0.755224 test: 0.720505
max validation accuracy : 0.767164 max acc epoch : 25 test accuracy : 0.719515
Epoch :  29 loss training:  25.81008278951049 Time :  13996
accuracy train: 0.965255 val: 0.740299 test: 0.689340
Counter({1: 3271, 2: 2073, 0: 2056})

Epoch :  30 loss training:  33.205122753977776 Time :  14061
accuracy train: 0.968895 val: 0.761194 test: 0.720505
max validation accuracy : 0.767164 max acc epoch : 25 test accuracy : 0.719515
Epoch :  30 loss training:  21.778481094166636 Time :  14097
accuracy train: 0.954004 val: 0.674627 test: 0.661885
Counter({2: 3099, 0: 2272, 1: 2029})

Epoch :  31 loss training:  31.14359015226364 Time :  14154
accuracy train: 0.971542 val: 0.761194 test: 0.722731
max validation accuracy : 0.767164 max acc epoch : 25 test accuracy : 0.719515
Epoch :  31 loss training:  23.436240976676345 Time :  14180
accuracy train: 0.966909 val: 0.701493 test: 0.679199
Counter({0: 2905, 1: 2484, 2: 2011})

Epoch :  32 loss training:  31.223184943199158 Time :  14259
accuracy train: 0.976506 val: 0.773134 test: 0.720752
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  32 loss training:  19.77038067020476 Time :  14284
accuracy train: 0.963931 val: 0.701493 test: 0.686619
Counter({0: 2963, 1: 2408, 2: 2029})

Epoch :  33 loss training:  30.32599112391472 Time :  14336
accuracy train: 0.977498 val: 0.755224 test: 0.718279
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  33 loss training:  19.259027883410454 Time :  14372
accuracy train: 0.977498 val: 0.695522 test: 0.665842
Counter({1: 2958, 2: 2402, 0: 2040})

Epoch :  34 loss training:  30.242246754467487 Time :  14440
accuracy train: 0.979815 val: 0.758209 test: 0.721247
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  34 loss training:  21.005203317850828 Time :  14474
accuracy train: 0.958306 val: 0.686567 test: 0.670294
Counter({2: 3012, 1: 2488, 0: 1900})

Epoch :  35 loss training:  27.85326547920704 Time :  14544
accuracy train: 0.982793 val: 0.752239 test: 0.719763
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  35 loss training:  20.766183778643608 Time :  14576
accuracy train: 0.965255 val: 0.674627 test: 0.669058
Counter({2: 2959, 1: 2518, 0: 1923})

Epoch :  36 loss training:  27.22938310354948 Time :  14650
accuracy train: 0.983786 val: 0.758209 test: 0.718279
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  36 loss training:  19.01370242331177 Time :  14697
accuracy train: 0.966248 val: 0.683582 test: 0.654712
Counter({0: 2774, 2: 2671, 1: 1955})

Epoch :  37 loss training:  26.810379959642887 Time :  14753
accuracy train: 0.984116 val: 0.767164 test: 0.714568
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  37 loss training:  21.47922346368432 Time :  14777
accuracy train: 0.976506 val: 0.710448 test: 0.674004
Counter({2: 3022, 1: 2462, 0: 1916})

Epoch :  38 loss training:  24.753074325621128 Time :  14842
accuracy train: 0.983786 val: 0.761194 test: 0.723720
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  38 loss training:  21.31066524796188 Time :  14897
accuracy train: 0.979815 val: 0.698507 test: 0.684640
Counter({0: 2787, 1: 2710, 2: 1903})

Epoch :  39 loss training:  24.690766640007496 Time :  14953
accuracy train: 0.986764 val: 0.764179 test: 0.718279
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  39 loss training:  19.715085553005338 Time :  14992
accuracy train: 0.974851 val: 0.710448 test: 0.677220
Counter({0: 2791, 2: 2653, 1: 1956})

Epoch :  40 loss training:  23.563082434237003 Time :  15056
accuracy train: 0.988418 val: 0.767164 test: 0.718031
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  40 loss training:  12.008667901158333 Time :  15083
accuracy train: 0.982462 val: 0.722388 test: 0.677962
Counter({1: 2824, 0: 2626, 2: 1950})

Epoch :  41 loss training:  23.421936064958572 Time :  15163
accuracy train: 0.989080 val: 0.761194 test: 0.721741
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  41 loss training:  12.408647316507995 Time :  15191
accuracy train: 0.987426 val: 0.707463 test: 0.689340
Counter({2: 3067, 1: 2423, 0: 1910})

Epoch :  42 loss training:  22.152254205197096 Time :  15256
accuracy train: 0.990073 val: 0.746269 test: 0.718773
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  42 loss training:  19.1679069949314 Time :  15293
accuracy train: 0.966578 val: 0.668657 test: 0.671036
Counter({0: 2714, 2: 2559, 1: 2127})

Epoch :  43 loss training:  21.170972172170877 Time :  15373
accuracy train: 0.991066 val: 0.773134 test: 0.721247
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  43 loss training:  16.958413324784487 Time :  15402
accuracy train: 0.987426 val: 0.692537 test: 0.689340
Counter({2: 2795, 0: 2581, 1: 2024})

Epoch :  44 loss training:  21.485791478306055 Time :  15477
accuracy train: 0.991396 val: 0.749254 test: 0.717042
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  44 loss training:  13.398281965404749 Time :  15511
accuracy train: 0.995036 val: 0.701493 test: 0.693297
Counter({1: 2800, 0: 2646, 2: 1954})

Epoch :  45 loss training:  20.090068792924285 Time :  15594
accuracy train: 0.993382 val: 0.773134 test: 0.720999
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  45 loss training:  12.719791227020323 Time :  15634
accuracy train: 0.988087 val: 0.707463 test: 0.686866
Counter({1: 2753, 2: 2617, 0: 2030})

Epoch :  46 loss training:  18.06684387475252 Time :  15705
accuracy train: 0.993382 val: 0.773134 test: 0.724462
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  46 loss training:  16.36109951371327 Time :  15737
accuracy train: 0.982462 val: 0.713433 test: 0.666832
Counter({2: 2780, 1: 2694, 0: 1926})

Epoch :  47 loss training:  18.394584879279137 Time :  15825
accuracy train: 0.995367 val: 0.755224 test: 0.719763
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  47 loss training:  14.706182985100895 Time :  15852
accuracy train: 0.979153 val: 0.695522 test: 0.662379
Counter({1: 2811, 2: 2664, 0: 1925})

Epoch :  48 loss training:  16.87640638463199 Time :  15931
accuracy train: 0.994044 val: 0.764179 test: 0.721741
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  48 loss training:  15.175977332983166 Time :  15969
accuracy train: 0.988749 val: 0.710448 test: 0.675736
Counter({2: 2773, 0: 2620, 1: 2007})

Epoch :  49 loss training:  17.20224066078663 Time :  16062
accuracy train: 0.995698 val: 0.758209 test: 0.712342
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  49 loss training:  14.875566547736526 Time :  16097
accuracy train: 0.994044 val: 0.707463 test: 0.687856
Counter({0: 2949, 2: 2371, 1: 2080})

Epoch :  50 loss training:  16.845399372279644 Time :  16178
accuracy train: 0.996691 val: 0.758209 test: 0.716794
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  50 loss training:  13.11056120460853 Time :  16208
accuracy train: 0.980807 val: 0.707463 test: 0.660648
Counter({1: 2775, 2: 2491, 0: 2134})

Epoch :  51 loss training:  15.452151838690042 Time :  16289
accuracy train: 0.997684 val: 0.761194 test: 0.721989
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  51 loss training:  15.53127902559936 Time :  16329
accuracy train: 0.964593 val: 0.689552 test: 0.657680
Counter({0: 2757, 2: 2472, 1: 2171})

Epoch :  52 loss training:  14.794667303562164 Time :  16390
accuracy train: 0.998015 val: 0.764179 test: 0.717784
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  52 loss training:  27.801069147884846 Time :  16428
accuracy train: 0.968895 val: 0.674627 test: 0.665842
Counter({1: 2816, 0: 2595, 2: 1989})

Epoch :  53 loss training:  15.026376970112324 Time :  16525
accuracy train: 0.998676 val: 0.767164 test: 0.719515
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  53 loss training:  21.956774880178273 Time :  16552
accuracy train: 0.984778 val: 0.692537 test: 0.665595
Counter({0: 2826, 1: 2512, 2: 2062})

Epoch :  54 loss training:  14.85424998961389 Time :  16626
accuracy train: 0.998676 val: 0.770149 test: 0.717784
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  54 loss training:  27.813088830560446 Time :  16653
accuracy train: 0.976175 val: 0.710448 test: 0.685135
Counter({1: 2766, 2: 2599, 0: 2035})

Epoch :  55 loss training:  13.952684057876468 Time :  16765
accuracy train: 0.996691 val: 0.773134 test: 0.720752
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  55 loss training:  19.68491391092539 Time :  16804
accuracy train: 0.982793 val: 0.725373 test: 0.683403
Counter({2: 3253, 0: 2514, 1: 1633})

Epoch :  56 loss training:  13.086632188409567 Time :  16887
accuracy train: 0.998676 val: 0.758209 test: 0.716052
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  56 loss training:  14.535729248076677 Time :  16916
accuracy train: 0.992389 val: 0.722388 test: 0.686619
Counter({2: 3240, 0: 2760, 1: 1400})

Epoch :  57 loss training:  12.468053881078959 Time :  17011
accuracy train: 0.998676 val: 0.758209 test: 0.719021
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  57 loss training:  11.591887437738478 Time :  17044
accuracy train: 0.992058 val: 0.716418 test: 0.687361
Counter({2: 2771, 1: 2435, 0: 2194})

Epoch :  58 loss training:  12.387754427269101 Time :  17120
accuracy train: 1.000000 val: 0.767164 test: 0.719268
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  58 loss training:  13.417490772902966 Time :  17156
accuracy train: 0.984447 val: 0.686567 test: 0.684393
Counter({0: 3125, 2: 2665, 1: 1610})

Epoch :  59 loss training:  12.29521219432354 Time :  17261
accuracy train: 0.999669 val: 0.770149 test: 0.721741
max validation accuracy : 0.773134 max acc epoch : 32 test accuracy : 0.720752
Epoch :  59 loss training:  13.143120623193681 Time :  17289
accuracy train: 0.994375 val: 0.698507 test: 0.685629
Counter({2: 2709, 1: 2585, 0: 2106})

Epoch :  60 loss training:  11.311719826422632 Time :  17374
accuracy train: 1.000000 val: 0.776119 test: 0.717042
max validation accuracy : 0.776119 max acc epoch : 60 test accuracy : 0.717042
Epoch :  60 loss training:  13.256720875389874 Time :  17412
accuracy train: 0.994044 val: 0.722388 test: 0.696760
Counter({2: 2606, 0: 2603, 1: 2191})

Epoch :  61 loss training:  11.290111688897014 Time :  17512
accuracy train: 0.999669 val: 0.770149 test: 0.725699
max validation accuracy : 0.776119 max acc epoch : 60 test accuracy : 0.717042
Epoch :  61 loss training:  11.334531771950424 Time :  17538
accuracy train: 0.974520 val: 0.677612 test: 0.670542
Counter({1: 2650, 0: 2557, 2: 2193})

Epoch :  62 loss training:  10.78139072470367 Time :  17611
accuracy train: 0.999338 val: 0.764179 test: 0.720999
max validation accuracy : 0.776119 max acc epoch : 60 test accuracy : 0.717042
Epoch :  62 loss training:  11.517257675994188 Time :  17636
accuracy train: 0.994705 val: 0.722388 test: 0.686372
Counter({2: 2645, 1: 2542, 0: 2213})

Epoch :  63 loss training:  10.922264616936445 Time :  17721
accuracy train: 0.999669 val: 0.770149 test: 0.722236
max validation accuracy : 0.776119 max acc epoch : 60 test accuracy : 0.717042
Epoch :  63 loss training:  9.234356189146638 Time :  17764
accuracy train: 0.993051 val: 0.725373 test: 0.676231
Counter({1: 2846, 0: 2279, 2: 2275})

Epoch :  64 loss training:  9.937649300321937 Time :  17850
accuracy train: 1.000000 val: 0.755224 test: 0.720752
max validation accuracy : 0.776119 max acc epoch : 60 test accuracy : 0.717042
Epoch :  64 loss training:  9.311407377477735 Time :  17878
accuracy train: 0.992389 val: 0.719403 test: 0.689587
Counter({1: 2724, 0: 2516, 2: 2160})

Epoch :  65 loss training:  9.649351796135306 Time :  17972
accuracy train: 1.000000 val: 0.758209 test: 0.720752
max validation accuracy : 0.776119 max acc epoch : 60 test accuracy : 0.717042
Epoch :  65 loss training:  8.893480656202883 Time :  18012
accuracy train: 0.995036 val: 0.707463 test: 0.689340
Counter({2: 2814, 0: 2558, 1: 2028})

Epoch :  66 loss training:  8.42549262009561 Time :  18063
accuracy train: 1.000000 val: 0.752239 test: 0.723473
max validation accuracy : 0.776119 max acc epoch : 60 test accuracy : 0.717042
Epoch :  66 loss training:  16.169634364545345 Time :  18103
accuracy train: 0.974520 val: 0.692537 test: 0.661885
Counter({2: 2656, 1: 2460, 0: 2284})

Epoch :  67 loss training:  9.329349264502525 Time :  18177
accuracy train: 1.000000 val: 0.773134 test: 0.722483
max validation accuracy : 0.776119 max acc epoch : 60 test accuracy : 0.717042
Epoch :  67 loss training:  30.12795657850802 Time :  18222
accuracy train: 0.980146 val: 0.692537 test: 0.671778
Counter({1: 2722, 0: 2606, 2: 2072})

Epoch :  68 loss training:  9.303391811437905 Time :  18316
accuracy train: 1.000000 val: 0.758209 test: 0.719021
max validation accuracy : 0.776119 max acc epoch : 60 test accuracy : 0.717042
Epoch :  68 loss training:  23.067089442163706 Time :  18348
accuracy train: 0.983786 val: 0.710448 test: 0.670542
Counter({1: 2782, 2: 2414, 0: 2204})

Epoch :  69 loss training:  8.452965481206775 Time :  18418
accuracy train: 0.999669 val: 0.752239 test: 0.716052
max validation accuracy : 0.776119 max acc epoch : 60 test accuracy : 0.717042
Epoch :  69 loss training:  23.053431244567037 Time :  18472
accuracy train: 0.987095 val: 0.686567 test: 0.684640
Counter({0: 2722, 1: 2623, 2: 2055})

Epoch :  70 loss training:  7.188306641764939 Time :  18535
accuracy train: 1.000000 val: 0.773134 test: 0.720257
max validation accuracy : 0.776119 max acc epoch : 60 test accuracy : 0.717042
Epoch :  70 loss training:  12.218702760525048 Time :  18561
accuracy train: 0.995698 val: 0.695522 test: 0.698739
Counter({0: 2765, 1: 2718, 2: 1917})

Epoch :  71 loss training:  7.724714811891317 Time :  18619
accuracy train: 1.000000 val: 0.767164 test: 0.715310
max validation accuracy : 0.776119 max acc epoch : 60 test accuracy : 0.717042
Epoch :  71 loss training:  9.856880179489963 Time :  18662
accuracy train: 0.997353 val: 0.707463 test: 0.690329
Counter({2: 3030, 1: 2370, 0: 2000})

Epoch :  72 loss training:  6.838035554625094 Time :  18731
accuracy train: 1.000000 val: 0.779104 test: 0.719515
max validation accuracy : 0.779104 max acc epoch : 72 test accuracy : 0.719515
Epoch :  72 loss training:  9.82927840645425 Time :  18756
accuracy train: 0.983786 val: 0.680597 test: 0.679446
Counter({2: 2812, 0: 2721, 1: 1867})

Epoch :  73 loss training:  7.221101036295295 Time :  18809
accuracy train: 1.000000 val: 0.767164 test: 0.714816
max validation accuracy : 0.779104 max acc epoch : 72 test accuracy : 0.719515
Epoch :  73 loss training:  11.754548867233098 Time :  18846
accuracy train: 0.990404 val: 0.704478 test: 0.685135
Counter({2: 2863, 0: 2634, 1: 1903})

Epoch :  74 loss training:  6.994032613933086 Time :  18889
accuracy train: 1.000000 val: 0.782090 test: 0.720752
max validation accuracy : 0.782090 max acc epoch : 74 test accuracy : 0.720752
Epoch :  74 loss training:  8.20664465194568 Time :  18918
accuracy train: 0.995367 val: 0.701493 test: 0.687608
Counter({1: 2858, 0: 2572, 2: 1970})

Epoch :  75 loss training:  6.011804495938122 Time :  18967
accuracy train: 1.000000 val: 0.773134 test: 0.722483
max validation accuracy : 0.782090 max acc epoch : 74 test accuracy : 0.720752
Epoch :  75 loss training:  6.289203106891364 Time :  18990
accuracy train: 0.998345 val: 0.713433 test: 0.691566
Counter({1: 2956, 2: 2544, 0: 1900})

Epoch :  76 loss training:  6.690805805847049 Time :  19046
accuracy train: 1.000000 val: 0.764179 test: 0.719268
max validation accuracy : 0.782090 max acc epoch : 74 test accuracy : 0.720752
Epoch :  76 loss training:  7.184787142556161 Time :  19080
accuracy train: 0.995367 val: 0.707463 test: 0.697007
Counter({0: 2957, 1: 2402, 2: 2041})

Epoch :  77 loss training:  5.772862585261464 Time :  19130
accuracy train: 1.000000 val: 0.770149 test: 0.722731
max validation accuracy : 0.782090 max acc epoch : 74 test accuracy : 0.720752
Epoch :  77 loss training:  6.476875307736918 Time :  19157
accuracy train: 0.997684 val: 0.692537 test: 0.687114
Counter({0: 2758, 2: 2623, 1: 2019})

Epoch :  78 loss training:  6.326187261380255 Time :  19218
accuracy train: 1.000000 val: 0.785075 test: 0.724215
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  78 loss training:  6.872937002335675 Time :  19245
accuracy train: 0.992058 val: 0.692537 test: 0.679446
Counter({0: 2832, 1: 2557, 2: 2011})

Epoch :  79 loss training:  5.220621530432254 Time :  19294
accuracy train: 1.000000 val: 0.776119 test: 0.720257
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  79 loss training:  6.447759714908898 Time :  19324
accuracy train: 0.996360 val: 0.698507 test: 0.694286
Counter({1: 2815, 2: 2677, 0: 1908})

Epoch :  80 loss training:  6.130146347451955 Time :  19373
accuracy train: 1.000000 val: 0.779104 test: 0.720505
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  80 loss training:  7.119933949783444 Time :  19398
accuracy train: 0.996029 val: 0.674627 test: 0.692308
Counter({1: 2822, 2: 2566, 0: 2012})

Epoch :  81 loss training:  6.028255191631615 Time :  19457
accuracy train: 1.000000 val: 0.764179 test: 0.719021
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  81 loss training:  13.268430745927617 Time :  19488
accuracy train: 0.997353 val: 0.707463 test: 0.691566
Counter({2: 2720, 1: 2664, 0: 2016})

Epoch :  82 loss training:  5.189837323967367 Time :  19527
accuracy train: 1.000000 val: 0.773134 test: 0.721741
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  82 loss training:  7.826384562300518 Time :  19555
accuracy train: 0.996029 val: 0.713433 test: 0.686866
Counter({0: 2824, 1: 2413, 2: 2163})

Epoch :  83 loss training:  5.793693926651031 Time :  19621
accuracy train: 1.000000 val: 0.764179 test: 0.721494
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  83 loss training:  7.718044766923413 Time :  19651
accuracy train: 0.988087 val: 0.689552 test: 0.681425
Counter({0: 2684, 1: 2579, 2: 2137})

Epoch :  84 loss training:  4.656021541450173 Time :  19692
accuracy train: 1.000000 val: 0.773134 test: 0.719268
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  84 loss training:  10.278799546184018 Time :  19722
accuracy train: 0.990073 val: 0.695522 test: 0.675241
Counter({2: 2591, 1: 2559, 0: 2250})

Epoch :  85 loss training:  5.4086643774062395 Time :  19776
accuracy train: 1.000000 val: 0.764179 test: 0.719515
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  85 loss training:  11.567933999584056 Time :  19799
accuracy train: 0.991396 val: 0.716418 test: 0.682661
Counter({0: 2738, 1: 2427, 2: 2235})

Epoch :  86 loss training:  5.723527941852808 Time :  19862
accuracy train: 1.000000 val: 0.755224 test: 0.721989
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  86 loss training:  9.179634713102132 Time :  19893
accuracy train: 0.991396 val: 0.695522 test: 0.678457
Counter({1: 2737, 2: 2471, 0: 2192})

Epoch :  87 loss training:  5.011117487680167 Time :  19931
accuracy train: 1.000000 val: 0.758209 test: 0.718526
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  87 loss training:  8.18343575578183 Time :  19962
accuracy train: 0.994705 val: 0.707463 test: 0.678951
Counter({1: 2969, 2: 2220, 0: 2211})

Epoch :  88 loss training:  4.90898397564888 Time :  20013
accuracy train: 1.000000 val: 0.779104 test: 0.721741
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  88 loss training:  10.546873955521733 Time :  20037
accuracy train: 0.982131 val: 0.692537 test: 0.669305
Counter({2: 2976, 0: 2262, 1: 2162})

Epoch :  89 loss training:  4.508152627153322 Time :  20091
accuracy train: 1.000000 val: 0.752239 test: 0.714074
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  89 loss training:  11.629606391536072 Time :  20125
accuracy train: 0.996360 val: 0.707463 test: 0.682414
Counter({2: 2743, 1: 2649, 0: 2008})

Epoch :  90 loss training:  4.343949957517907 Time :  20172
accuracy train: 1.000000 val: 0.779104 test: 0.717784
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  90 loss training:  9.645421795314178 Time :  20202
accuracy train: 0.991727 val: 0.698507 test: 0.685877
Counter({2: 3696, 0: 2092, 1: 1612})

Epoch :  91 loss training:  4.677126040216535 Time :  20265
accuracy train: 1.000000 val: 0.776119 test: 0.717784
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  91 loss training:  7.7620111256837845 Time :  20289
accuracy train: 0.995698 val: 0.716418 test: 0.688103
Counter({0: 2790, 2: 2520, 1: 2090})

Epoch :  92 loss training:  3.9127586933318526 Time :  20358
accuracy train: 1.000000 val: 0.767164 test: 0.723225
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  92 loss training:  6.413660531397909 Time :  20391
accuracy train: 0.995367 val: 0.698507 test: 0.681177
Counter({2: 2892, 0: 2416, 1: 2092})

Epoch :  93 loss training:  3.9219824271276593 Time :  20454
accuracy train: 1.000000 val: 0.761194 test: 0.719021
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  93 loss training:  5.718556669773534 Time :  20481
accuracy train: 0.990073 val: 0.704478 test: 0.678457
Counter({0: 2549, 2: 2542, 1: 2309})

Epoch :  94 loss training:  3.608635801356286 Time :  20540
accuracy train: 1.000000 val: 0.761194 test: 0.714074
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  94 loss training:  12.095526077784598 Time :  20572
accuracy train: 0.995367 val: 0.695522 test: 0.683898
Counter({1: 2636, 0: 2414, 2: 2350})

Epoch :  95 loss training:  3.7165751443244517 Time :  20633
accuracy train: 1.000000 val: 0.776119 test: 0.720999
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  95 loss training:  5.605862032971345 Time :  20660
accuracy train: 0.999669 val: 0.722388 test: 0.687856
Counter({0: 2592, 1: 2527, 2: 2281})

Epoch :  96 loss training:  3.7877882570028305 Time :  20726
accuracy train: 1.000000 val: 0.767164 test: 0.718526
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  96 loss training:  5.806113749829819 Time :  20752
accuracy train: 0.997684 val: 0.710448 test: 0.681672
Counter({1: 2798, 0: 2499, 2: 2103})

Epoch :  97 loss training:  2.9551778049208224 Time :  20814
accuracy train: 1.000000 val: 0.767164 test: 0.719021
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  97 loss training:  3.5237038724008016 Time :  20845
accuracy train: 0.999007 val: 0.710448 test: 0.693297
Counter({1: 2711, 0: 2558, 2: 2131})

Epoch :  98 loss training:  3.009320313576609 Time :  20902
accuracy train: 1.000000 val: 0.782090 test: 0.721741
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  98 loss training:  9.090473862190265 Time :  20934
accuracy train: 0.995036 val: 0.698507 test: 0.664605
Counter({1: 3396, 0: 2328, 2: 1676})

Epoch :  99 loss training:  3.3672030298039317 Time :  20993
accuracy train: 1.000000 val: 0.776119 test: 0.719763
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  99 loss training:  7.4728272394277155 Time :  21023
accuracy train: 0.993382 val: 0.665672 test: 0.664853
Counter({2: 3328, 0: 2399, 1: 1673})

Epoch :  100 loss training:  3.5368880887981504 Time :  21083
accuracy train: 1.000000 val: 0.752239 test: 0.713826
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  100 loss training:  7.314284877385944 Time :  21109
accuracy train: 0.999338 val: 0.707463 test: 0.682909
Counter({1: 2690, 0: 2417, 2: 2293})

Epoch :  101 loss training:  3.2038165635894984 Time :  21191
accuracy train: 1.000000 val: 0.776119 test: 0.720752
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  101 loss training:  5.0331830063369125 Time :  21221
accuracy train: 0.996691 val: 0.710448 test: 0.676478
Counter({2: 2836, 1: 2485, 0: 2079})

Epoch :  102 loss training:  3.6743273937609047 Time :  21290
accuracy train: 1.000000 val: 0.770149 test: 0.722978
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  102 loss training:  9.069114452810027 Time :  21323
accuracy train: 0.991727 val: 0.677612 test: 0.681177
Counter({1: 3328, 0: 2318, 2: 1754})

Epoch :  103 loss training:  2.9620949941454455 Time :  21405
accuracy train: 1.000000 val: 0.776119 test: 0.720010
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  103 loss training:  9.942765470710583 Time :  21431
accuracy train: 0.996029 val: 0.680597 test: 0.664605
Counter({2: 2667, 0: 2479, 1: 2254})

Epoch :  104 loss training:  3.568346834857948 Time :  21500
accuracy train: 1.000000 val: 0.773134 test: 0.720010
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  104 loss training:  8.037183129577897 Time :  21528
accuracy train: 0.996029 val: 0.701493 test: 0.669552
Counter({2: 3229, 1: 2378, 0: 1793})

Epoch :  105 loss training:  3.2980787875130773 Time :  21610
accuracy train: 1.000000 val: 0.770149 test: 0.718773
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  105 loss training:  10.143357784952968 Time :  21648
accuracy train: 0.998676 val: 0.728358 test: 0.678457
Counter({0: 3338, 2: 2386, 1: 1676})

Epoch :  106 loss training:  2.7608010328840464 Time :  21725
accuracy train: 1.000000 val: 0.776119 test: 0.717536
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  106 loss training:  4.2644889607909136 Time :  21752
accuracy train: 0.999669 val: 0.734328 test: 0.696018
Counter({1: 2616, 0: 2613, 2: 2171})

Epoch :  107 loss training:  2.7591368809808046 Time :  21826
accuracy train: 1.000000 val: 0.770149 test: 0.720752
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  107 loss training:  5.8183233853196725 Time :  21863
accuracy train: 0.999007 val: 0.722388 test: 0.686372
Counter({2: 3322, 0: 2439, 1: 1639})

Epoch :  108 loss training:  3.0356865774374455 Time :  21946
accuracy train: 1.000000 val: 0.779104 test: 0.719763
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  108 loss training:  8.002832126803696 Time :  21970
accuracy train: 0.999007 val: 0.713433 test: 0.666584
Counter({0: 2598, 1: 2561, 2: 2241})

Epoch :  109 loss training:  2.507117281202227 Time :  22049
accuracy train: 1.000000 val: 0.770149 test: 0.719268
max validation accuracy : 0.785075 max acc epoch : 78 test accuracy : 0.724215
Epoch :  109 loss training:  16.71743869036436 Time :  22081
accuracy train: 0.981138 val: 0.680597 test: 0.657680
Counter({1: 2597, 0: 2584, 2: 2219})

========================================================================================================================================================================================================
max acc epoch :  78
max validation accuracy :  0.7850746268656716
test accuracy :  0.7242146920603513
last test_accuracy :  0.7192678703932723
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=791, weight_decay=0)
device :  cuda:0
Counter({2: 2591, 1: 2556, 0: 2253})

Epoch :  1 loss training:  212.5324980020523 Time :  22214
accuracy train: 0.631370 val: 0.558209 test: 0.592135
max validation accuracy : 0.558209 max acc epoch : 1 test accuracy : 0.592135
Epoch :  1 loss training:  274.4319701194763 Time :  22239
accuracy train: 0.567836 val: 0.483582 test: 0.547860
Counter({0: 3002, 1: 2628, 2: 1770})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  142.48658841848373 Time :  22308
accuracy train: 0.727002 val: 0.701493 test: 0.659659
max validation accuracy : 0.701493 max acc epoch : 2 test accuracy : 0.659659
Epoch :  2 loss training:  173.21309143304825 Time :  22340
accuracy train: 0.570814 val: 0.504478 test: 0.530299
Counter({2: 2690, 1: 2506, 0: 2204})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  122.51962894201279 Time :  22401
accuracy train: 0.759100 val: 0.719403 test: 0.677467
max validation accuracy : 0.719403 max acc epoch : 3 test accuracy : 0.677467
Epoch :  3 loss training:  146.08098003268242 Time :  22434
accuracy train: 0.657512 val: 0.614925 test: 0.573584
Counter({2: 2802, 0: 2529, 1: 2069})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  99.62989470362663 Time :  22512
accuracy train: 0.780278 val: 0.701493 test: 0.683156
max validation accuracy : 0.719403 max acc epoch : 3 test accuracy : 0.677467
Epoch :  4 loss training:  124.93555957078934 Time :  22538
accuracy train: 0.666777 val: 0.602985 test: 0.593619
Counter({0: 3628, 1: 2061, 2: 1711})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  90.82468444108963 Time :  22639
accuracy train: 0.818001 val: 0.731343 test: 0.689340
max validation accuracy : 0.731343 max acc epoch : 5 test accuracy : 0.689340
Epoch :  5 loss training:  109.22302383184433 Time :  22666
accuracy train: 0.744209 val: 0.638806 test: 0.633935
Counter({0: 2817, 2: 2576, 1: 2007})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  87.28386005759239 Time :  22736
accuracy train: 0.833885 val: 0.716418 test: 0.706406
max validation accuracy : 0.731343 max acc epoch : 5 test accuracy : 0.689340
Epoch :  6 loss training:  98.57310649752617 Time :  22773
accuracy train: 0.707809 val: 0.579104 test: 0.609201
Counter({1: 3083, 2: 2355, 0: 1962})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  72.83685351908207 Time :  22834
accuracy train: 0.859696 val: 0.731343 test: 0.709622
max validation accuracy : 0.731343 max acc epoch : 5 test accuracy : 0.689340
Epoch :  7 loss training:  94.0117789953947 Time :  22866
accuracy train: 0.763733 val: 0.689552 test: 0.651249
Counter({2: 3022, 1: 2453, 0: 1925})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  70.75933933258057 Time :  22926
accuracy train: 0.863005 val: 0.737313 test: 0.711106
max validation accuracy : 0.737313 max acc epoch : 8 test accuracy : 0.711106
Epoch :  8 loss training:  80.85176511108875 Time :  22961
accuracy train: 0.724024 val: 0.582090 test: 0.615632
Counter({1: 3078, 0: 2366, 2: 1956})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.74930433183908 Time :  23005
accuracy train: 0.875910 val: 0.746269 test: 0.707148
max validation accuracy : 0.746269 max acc epoch : 9 test accuracy : 0.707148
Epoch :  9 loss training:  79.70941310375929 Time :  23040
accuracy train: 0.801125 val: 0.668657 test: 0.658917
Counter({1: 3060, 2: 2538, 0: 1802})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.271653816103935 Time :  23090
accuracy train: 0.891463 val: 0.725373 test: 0.712590
max validation accuracy : 0.746269 max acc epoch : 9 test accuracy : 0.707148
Epoch :  10 loss training:  66.98436641693115 Time :  23120
accuracy train: 0.798478 val: 0.659701 test: 0.647786
Counter({2: 2856, 1: 2644, 0: 1900})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.70927767455578 Time :  23173
accuracy train: 0.887823 val: 0.731343 test: 0.719268
max validation accuracy : 0.746269 max acc epoch : 9 test accuracy : 0.707148
Epoch :  11 loss training:  62.967973083257675 Time :  23198
accuracy train: 0.791198 val: 0.638806 test: 0.627999
Counter({0: 2935, 1: 2601, 2: 1864})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  57.1102225035429 Time :  23254
accuracy train: 0.898743 val: 0.740299 test: 0.710858
max validation accuracy : 0.746269 max acc epoch : 9 test accuracy : 0.707148
Epoch :  12 loss training:  62.58464977145195 Time :  23289
accuracy train: 0.793183 val: 0.650746 test: 0.634430
Counter({2: 3014, 1: 2466, 0: 1920})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  54.81094780564308 Time :  23355
accuracy train: 0.908339 val: 0.746269 test: 0.718526
max validation accuracy : 0.746269 max acc epoch : 9 test accuracy : 0.707148
Epoch :  13 loss training:  57.45173678547144 Time :  23382
accuracy train: 0.859696 val: 0.674627 test: 0.668068
Counter({2: 2895, 0: 2571, 1: 1934})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  54.48130193352699 Time :  23444
accuracy train: 0.908339 val: 0.743284 test: 0.717784
max validation accuracy : 0.746269 max acc epoch : 9 test accuracy : 0.707148
Epoch :  14 loss training:  53.022314339876175 Time :  23472
accuracy train: 0.866314 val: 0.692537 test: 0.670294
Counter({0: 2900, 2: 2571, 1: 1929})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  51.511093601584435 Time :  23524
accuracy train: 0.916612 val: 0.746269 test: 0.720257
max validation accuracy : 0.746269 max acc epoch : 9 test accuracy : 0.707148
Epoch :  15 loss training:  53.827352687716484 Time :  23552
accuracy train: 0.875248 val: 0.728358 test: 0.670294
Counter({0: 2768, 1: 2653, 2: 1979})

Epoch :  16 loss training:  52.329531744122505 Time :  23596
accuracy train: 0.916281 val: 0.737313 test: 0.717784
max validation accuracy : 0.746269 max acc epoch : 9 test accuracy : 0.707148
Epoch :  16 loss training:  49.26496436446905 Time :  23629
accuracy train: 0.869623 val: 0.677612 test: 0.665595
Counter({2: 2863, 1: 2638, 0: 1899})

Epoch :  17 loss training:  50.30891175568104 Time :  23681
accuracy train: 0.919921 val: 0.749254 test: 0.717289
max validation accuracy : 0.749254 max acc epoch : 17 test accuracy : 0.717289
Epoch :  17 loss training:  42.758623361587524 Time :  23711
accuracy train: 0.895433 val: 0.698507 test: 0.673015
Counter({0: 2961, 2: 2549, 1: 1890})

Epoch :  18 loss training:  49.7287590354681 Time :  23756
accuracy train: 0.923891 val: 0.740299 test: 0.718279
max validation accuracy : 0.749254 max acc epoch : 17 test accuracy : 0.717289
Epoch :  18 loss training:  39.195540368556976 Time :  23786
accuracy train: 0.872601 val: 0.650746 test: 0.641603
Counter({0: 2864, 2: 2603, 1: 1933})

Epoch :  19 loss training:  48.60765001922846 Time :  23840
accuracy train: 0.929517 val: 0.752239 test: 0.712342
max validation accuracy : 0.752239 max acc epoch : 19 test accuracy : 0.712342
Epoch :  19 loss training:  37.86457555741072 Time :  23862
accuracy train: 0.901059 val: 0.674627 test: 0.672520
Counter({1: 2759, 0: 2646, 2: 1995})

Epoch :  20 loss training:  47.0614078193903 Time :  23918
accuracy train: 0.937790 val: 0.734328 test: 0.714321
max validation accuracy : 0.752239 max acc epoch : 19 test accuracy : 0.712342
Epoch :  20 loss training:  32.81224916130304 Time :  23947
accuracy train: 0.910655 val: 0.683582 test: 0.671531
Counter({0: 2787, 1: 2601, 2: 2012})

Epoch :  21 loss training:  45.63215048611164 Time :  23992
accuracy train: 0.939775 val: 0.743284 test: 0.715558
max validation accuracy : 0.752239 max acc epoch : 19 test accuracy : 0.712342
Epoch :  21 loss training:  30.607649847865105 Time :  24025
accuracy train: 0.908670 val: 0.707463 test: 0.680930
Counter({0: 2702, 2: 2670, 1: 2028})

Epoch :  22 loss training:  43.43192459642887 Time :  24072
accuracy train: 0.944408 val: 0.734328 test: 0.716547
max validation accuracy : 0.752239 max acc epoch : 19 test accuracy : 0.712342
Epoch :  22 loss training:  34.81082604825497 Time :  24100
accuracy train: 0.906023 val: 0.701493 test: 0.680188
Counter({0: 2957, 2: 2511, 1: 1932})

Epoch :  23 loss training:  42.70909132063389 Time :  24151
accuracy train: 0.949702 val: 0.743284 test: 0.718526
max validation accuracy : 0.752239 max acc epoch : 19 test accuracy : 0.712342
Epoch :  23 loss training:  33.89755716919899 Time :  24187
accuracy train: 0.924222 val: 0.674627 test: 0.687856
Counter({1: 2917, 0: 2601, 2: 1882})

Epoch :  24 loss training:  40.19656305015087 Time :  24235
accuracy train: 0.954335 val: 0.740299 test: 0.720010
max validation accuracy : 0.752239 max acc epoch : 19 test accuracy : 0.712342
Epoch :  24 loss training:  30.153528910130262 Time :  24267
accuracy train: 0.913633 val: 0.689552 test: 0.666832
Counter({0: 3072, 2: 2539, 1: 1789})

Epoch :  25 loss training:  40.17610242217779 Time :  24322
accuracy train: 0.955989 val: 0.752239 test: 0.718773
max validation accuracy : 0.752239 max acc epoch : 19 test accuracy : 0.712342
Epoch :  25 loss training:  31.112486146390438 Time :  24343
accuracy train: 0.937790 val: 0.704478 test: 0.664605
Counter({2: 2801, 0: 2619, 1: 1980})

Epoch :  26 loss training:  37.730085112154484 Time :  24398
accuracy train: 0.961615 val: 0.749254 test: 0.720257
max validation accuracy : 0.752239 max acc epoch : 19 test accuracy : 0.712342
Epoch :  26 loss training:  31.15096189826727 Time :  24428
accuracy train: 0.944739 val: 0.716418 test: 0.674994
Counter({1: 2827, 0: 2675, 2: 1898})

Epoch :  27 loss training:  37.690218947827816 Time :  24471
accuracy train: 0.963931 val: 0.752239 test: 0.718031
max validation accuracy : 0.752239 max acc epoch : 19 test accuracy : 0.712342
Epoch :  27 loss training:  34.313660860061646 Time :  24503
accuracy train: 0.950364 val: 0.704478 test: 0.689340
Counter({2: 2671, 1: 2641, 0: 2088})

Epoch :  28 loss training:  36.12437918782234 Time :  24561
accuracy train: 0.967240 val: 0.764179 test: 0.720999
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  28 loss training:  29.894553285092115 Time :  24585
accuracy train: 0.932826 val: 0.683582 test: 0.672026
Counter({0: 2804, 1: 2713, 2: 1883})

Epoch :  29 loss training:  33.97493730485439 Time :  24635
accuracy train: 0.967240 val: 0.743284 test: 0.721741
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  29 loss training:  24.276801366358995 Time :  24669
accuracy train: 0.923561 val: 0.668657 test: 0.656691
Counter({0: 2937, 2: 2250, 1: 2213})

Epoch :  30 loss training:  34.44135249406099 Time :  24713
accuracy train: 0.968233 val: 0.725373 test: 0.716300
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  30 loss training:  27.939612116664648 Time :  24739
accuracy train: 0.950695 val: 0.686567 test: 0.671284
Counter({0: 2936, 2: 2277, 1: 2187})

Epoch :  31 loss training:  31.710794024169445 Time :  24795
accuracy train: 0.972866 val: 0.752239 test: 0.722731
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  31 loss training:  24.59523954614997 Time :  24823
accuracy train: 0.968233 val: 0.719403 test: 0.684640
Counter({2: 2876, 1: 2596, 0: 1928})

Epoch :  32 loss training:  31.800736293196678 Time :  24868
accuracy train: 0.975513 val: 0.743284 test: 0.720257
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  32 loss training:  23.487866658717394 Time :  24903
accuracy train: 0.955659 val: 0.695522 test: 0.667326
Counter({0: 3005, 1: 2552, 2: 1843})

Epoch :  33 loss training:  29.15367664396763 Time :  24947
accuracy train: 0.977167 val: 0.746269 test: 0.720257
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  33 loss training:  23.02999854274094 Time :  24975
accuracy train: 0.957975 val: 0.686567 test: 0.654959
Counter({2: 3054, 0: 2462, 1: 1884})

Epoch :  34 loss training:  29.52526831626892 Time :  25017
accuracy train: 0.979153 val: 0.737313 test: 0.720999
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  34 loss training:  29.291147403419018 Time :  25043
accuracy train: 0.943084 val: 0.674627 test: 0.663863
Counter({1: 2985, 2: 2488, 0: 1927})

Epoch :  35 loss training:  27.091513343155384 Time :  25096
accuracy train: 0.980146 val: 0.758209 test: 0.722731
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  35 loss training:  22.70343381166458 Time :  25117
accuracy train: 0.960953 val: 0.674627 test: 0.661885
Counter({0: 2783, 1: 2762, 2: 1855})

Epoch :  36 loss training:  27.49006349593401 Time :  25180
accuracy train: 0.980477 val: 0.749254 test: 0.719268
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  36 loss training:  21.36280381307006 Time :  25211
accuracy train: 0.969557 val: 0.698507 test: 0.658422
Counter({2: 3068, 0: 2469, 1: 1863})

Epoch :  37 loss training:  26.594778787344694 Time :  25264
accuracy train: 0.983124 val: 0.746269 test: 0.716547
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  37 loss training:  17.27333789691329 Time :  25299
accuracy train: 0.980146 val: 0.722388 test: 0.671778
Counter({1: 2784, 0: 2705, 2: 1911})

Epoch :  38 loss training:  25.962973721325397 Time :  25344
accuracy train: 0.983455 val: 0.758209 test: 0.719268
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  38 loss training:  18.273423524573445 Time :  25375
accuracy train: 0.984447 val: 0.728358 test: 0.678704
Counter({1: 2985, 2: 2482, 0: 1933})

Epoch :  39 loss training:  25.08593052998185 Time :  25440
accuracy train: 0.986433 val: 0.746269 test: 0.719021
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  39 loss training:  15.08978871628642 Time :  25470
accuracy train: 0.980146 val: 0.716418 test: 0.675488
Counter({1: 2904, 0: 2689, 2: 1807})

Epoch :  40 loss training:  23.886709831655025 Time :  25532
accuracy train: 0.988418 val: 0.743284 test: 0.720257
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  40 loss training:  15.973154969513416 Time :  25568
accuracy train: 0.981469 val: 0.695522 test: 0.676231
Counter({0: 2834, 1: 2771, 2: 1795})

Epoch :  41 loss training:  23.427231900393963 Time :  25615
accuracy train: 0.988087 val: 0.755224 test: 0.724957
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  41 loss training:  14.936379953753203 Time :  25647
accuracy train: 0.983455 val: 0.743284 test: 0.679941
Counter({0: 2867, 1: 2763, 2: 1770})

Epoch :  42 loss training:  23.801329612731934 Time :  25697
accuracy train: 0.990735 val: 0.734328 test: 0.716300
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  42 loss training:  14.612154672853649 Time :  25723
accuracy train: 0.979815 val: 0.686567 test: 0.674004
Counter({2: 2902, 0: 2669, 1: 1829})

Epoch :  43 loss training:  21.599371064454317 Time :  25789
accuracy train: 0.992389 val: 0.740299 test: 0.720257
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  43 loss training:  16.51081720739603 Time :  25813
accuracy train: 0.964924 val: 0.662687 test: 0.656196
Counter({2: 2892, 0: 2668, 1: 1840})

Epoch :  44 loss training:  19.938262682408094 Time :  25876
accuracy train: 0.991396 val: 0.722388 test: 0.714074
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  44 loss training:  20.35757252573967 Time :  25906
accuracy train: 0.886830 val: 0.579104 test: 0.581746
Counter({2: 3130, 0: 2445, 1: 1825})

Epoch :  45 loss training:  21.014339324086905 Time :  25963
accuracy train: 0.991727 val: 0.758209 test: 0.720752
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  45 loss training:  48.18030217476189 Time :  26002
accuracy train: 0.919921 val: 0.686567 test: 0.630472
Counter({0: 3242, 1: 2241, 2: 1917})

Epoch :  46 loss training:  20.09049492701888 Time :  26058
accuracy train: 0.993382 val: 0.740299 test: 0.720010
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  46 loss training:  29.234399899840355 Time :  26089
accuracy train: 0.967571 val: 0.713433 test: 0.669058
Counter({1: 3143, 2: 2197, 0: 2060})

Epoch :  47 loss training:  19.933586843311787 Time :  26143
accuracy train: 0.995367 val: 0.740299 test: 0.718773
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  47 loss training:  19.163942309096456 Time :  26172
accuracy train: 0.980477 val: 0.677612 test: 0.665595
Counter({0: 2685, 2: 2595, 1: 2120})

Epoch :  48 loss training:  17.61624127998948 Time :  26246
accuracy train: 0.996029 val: 0.731343 test: 0.718526
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  48 loss training:  14.002100495621562 Time :  26269
accuracy train: 0.989080 val: 0.710448 test: 0.676725
Counter({0: 2824, 1: 2655, 2: 1921})

Epoch :  49 loss training:  17.29561533778906 Time :  26335
accuracy train: 0.994375 val: 0.746269 test: 0.720257
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  49 loss training:  12.325716002844274 Time :  26359
accuracy train: 0.991066 val: 0.707463 test: 0.677467
Counter({1: 2784, 2: 2693, 0: 1923})

Epoch :  50 loss training:  17.623073529452085 Time :  26461
accuracy train: 0.996029 val: 0.722388 test: 0.714321
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  50 loss training:  14.473226309753954 Time :  26495
accuracy train: 0.984778 val: 0.725373 test: 0.674994
Counter({1: 2925, 2: 2578, 0: 1897})

Epoch :  51 loss training:  16.558079540729523 Time :  26550
accuracy train: 0.996691 val: 0.737313 test: 0.718279
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  51 loss training:  10.011281592771411 Time :  26587
accuracy train: 0.987756 val: 0.695522 test: 0.677220
Counter({0: 2900, 2: 2641, 1: 1859})

Epoch :  52 loss training:  14.484077023342252 Time :  26651
accuracy train: 0.996360 val: 0.749254 test: 0.721989
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  52 loss training:  10.195787702221423 Time :  26687
accuracy train: 0.992720 val: 0.719403 test: 0.690082
Counter({0: 2881, 1: 2664, 2: 1855})

Epoch :  53 loss training:  14.96536753885448 Time :  26738
accuracy train: 0.998015 val: 0.755224 test: 0.720505
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  53 loss training:  15.079931031912565 Time :  26773
accuracy train: 0.965586 val: 0.704478 test: 0.648528
Counter({2: 2898, 1: 2603, 0: 1899})

Epoch :  54 loss training:  15.311356406658888 Time :  26824
accuracy train: 0.997684 val: 0.734328 test: 0.719515
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  54 loss training:  11.339506526011974 Time :  26862
accuracy train: 0.992389 val: 0.704478 test: 0.673757
Counter({1: 2883, 2: 2701, 0: 1816})

Epoch :  55 loss training:  13.69328654371202 Time :  26930
accuracy train: 0.997684 val: 0.749254 test: 0.719268
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  55 loss training:  13.237288753502071 Time :  26963
accuracy train: 0.991396 val: 0.716418 test: 0.683403
Counter({2: 2839, 1: 2726, 0: 1835})

Epoch :  56 loss training:  12.946264103055 Time :  27013
accuracy train: 0.999007 val: 0.728358 test: 0.721741
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  56 loss training:  9.75014246138744 Time :  27046
accuracy train: 0.996029 val: 0.704478 test: 0.677467
Counter({1: 2765, 2: 2760, 0: 1875})

Epoch :  57 loss training:  12.929188812151551 Time :  27106
accuracy train: 0.998676 val: 0.734328 test: 0.719268
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  57 loss training:  10.377939799334854 Time :  27133
accuracy train: 0.984778 val: 0.671642 test: 0.661885
Counter({0: 2805, 1: 2786, 2: 1809})

Epoch :  58 loss training:  12.140692288056016 Time :  27192
accuracy train: 0.998345 val: 0.746269 test: 0.716794
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  58 loss training:  13.950724981725216 Time :  27218
accuracy train: 0.992058 val: 0.698507 test: 0.682661
Counter({1: 2824, 0: 2735, 2: 1841})

Epoch :  59 loss training:  12.623155368492007 Time :  27288
accuracy train: 0.998676 val: 0.740299 test: 0.717289
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.720999
Epoch :  59 loss training:  12.57724801171571 Time :  27310
accuracy train: 0.987756 val: 0.677612 test: 0.668563
Counter({1: 2905, 2: 2644, 0: 1851})

========================================================================================================================================================================================================
max acc epoch :  28
max validation accuracy :  0.764179104477612
test accuracy :  0.7209992579767499
last test_accuracy :  0.7172891417264408
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=791, weight_decay=0)
device :  cuda:0
Counter({2: 2591, 1: 2556, 0: 2253})

Epoch :  1 loss training:  212.70780181884766 Time :  27454
accuracy train: 0.632363 val: 0.570149 test: 0.588424
max validation accuracy : 0.570149 max acc epoch : 1 test accuracy : 0.588424
Epoch :  1 loss training:  274.83331233263016 Time :  27482
accuracy train: 0.576109 val: 0.489552 test: 0.551818
Counter({2: 3648, 1: 1912, 0: 1840})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  142.199347615242 Time :  27550
accuracy train: 0.720715 val: 0.683582 test: 0.660895
max validation accuracy : 0.683582 max acc epoch : 2 test accuracy : 0.660895
Epoch :  2 loss training:  173.81595581769943 Time :  27582
accuracy train: 0.569821 val: 0.516418 test: 0.539946
Counter({2: 3728, 1: 1936, 0: 1736})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  122.45293709635735 Time :  27652
accuracy train: 0.763733 val: 0.707463 test: 0.679199
max validation accuracy : 0.707463 max acc epoch : 3 test accuracy : 0.679199
Epoch :  3 loss training:  144.01426035165787 Time :  27687
accuracy train: 0.647915 val: 0.611940 test: 0.575563
Counter({2: 3624, 1: 1912, 0: 1864})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  99.76429417729378 Time :  27754
accuracy train: 0.777300 val: 0.713433 test: 0.684145
max validation accuracy : 0.713433 max acc epoch : 4 test accuracy : 0.684145
Epoch :  4 loss training:  122.59114471077919 Time :  27785
accuracy train: 0.687624 val: 0.632836 test: 0.611180
Counter({1: 3029, 0: 2370, 2: 2001})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  92.0347749888897 Time :  27841
accuracy train: 0.822965 val: 0.728358 test: 0.694781
max validation accuracy : 0.728358 max acc epoch : 5 test accuracy : 0.694781
Epoch :  5 loss training:  109.95843413472176 Time :  27867
accuracy train: 0.742555 val: 0.626866 test: 0.636161
Counter({0: 2818, 2: 2646, 1: 1936})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.67682030797005 Time :  27931
accuracy train: 0.834878 val: 0.737313 test: 0.699975
max validation accuracy : 0.737313 max acc epoch : 6 test accuracy : 0.699975
Epoch :  6 loss training:  94.74092400074005 Time :  27957
accuracy train: 0.721707 val: 0.611940 test: 0.618600
Counter({2: 3008, 0: 2457, 1: 1935})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  73.13634318113327 Time :  28020
accuracy train: 0.856386 val: 0.734328 test: 0.708385
max validation accuracy : 0.737313 max acc epoch : 6 test accuracy : 0.699975
Epoch :  7 loss training:  83.61836905777454 Time :  28042
accuracy train: 0.735936 val: 0.635821 test: 0.623547
Counter({0: 2846, 1: 2599, 2: 1955})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  69.70552492141724 Time :  28097
accuracy train: 0.859696 val: 0.740299 test: 0.709374
max validation accuracy : 0.740299 max acc epoch : 8 test accuracy : 0.709374
Epoch :  8 loss training:  82.40039379894733 Time :  28119
accuracy train: 0.732627 val: 0.635821 test: 0.619095
Counter({0: 3004, 1: 2209, 2: 2187})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  66.95009142160416 Time :  28181
accuracy train: 0.870615 val: 0.725373 test: 0.708385
max validation accuracy : 0.740299 max acc epoch : 8 test accuracy : 0.709374
Epoch :  9 loss training:  73.35706561803818 Time :  28204
accuracy train: 0.764064 val: 0.656716 test: 0.631956
Counter({2: 2733, 1: 2510, 0: 2157})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.352199107408524 Time :  28268
accuracy train: 0.890470 val: 0.731343 test: 0.712590
max validation accuracy : 0.740299 max acc epoch : 8 test accuracy : 0.709374
Epoch :  10 loss training:  70.27320267260075 Time :  28293
accuracy train: 0.780278 val: 0.671642 test: 0.646302
Counter({0: 2790, 2: 2459, 1: 2151})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.11426445841789 Time :  28362
accuracy train: 0.895764 val: 0.740299 test: 0.714568
max validation accuracy : 0.740299 max acc epoch : 8 test accuracy : 0.709374
Epoch :  11 loss training:  70.36425414681435 Time :  28392
accuracy train: 0.768034 val: 0.647761 test: 0.607964
Counter({0: 2734, 2: 2630, 1: 2036})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  57.414576441049576 Time :  28467
accuracy train: 0.904699 val: 0.734328 test: 0.714816
max validation accuracy : 0.740299 max acc epoch : 8 test accuracy : 0.709374
Epoch :  12 loss training:  65.28839306533337 Time :  28500
accuracy train: 0.819325 val: 0.686567 test: 0.652980
Counter({1: 2853, 0: 2516, 2: 2031})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  54.70957900583744 Time :  28539
accuracy train: 0.906684 val: 0.734328 test: 0.716547
max validation accuracy : 0.740299 max acc epoch : 8 test accuracy : 0.709374
Epoch :  13 loss training:  57.23721331357956 Time :  28571
accuracy train: 0.856717 val: 0.713433 test: 0.671531
Counter({1: 2664, 0: 2639, 2: 2097})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  55.11816197633743 Time :  28605
accuracy train: 0.907677 val: 0.740299 test: 0.716052
max validation accuracy : 0.740299 max acc epoch : 8 test accuracy : 0.709374
Epoch :  14 loss training:  48.92015007138252 Time :  28636
accuracy train: 0.862674 val: 0.707463 test: 0.664111
Counter({2: 2584, 0: 2481, 1: 2335})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  52.770988680422306 Time :  28689
accuracy train: 0.912641 val: 0.740299 test: 0.720010
max validation accuracy : 0.740299 max acc epoch : 8 test accuracy : 0.709374
Epoch :  15 loss training:  49.07527235150337 Time :  28716
accuracy train: 0.831899 val: 0.716418 test: 0.638387
Counter({2: 2618, 1: 2475, 0: 2307})

Epoch :  16 loss training:  51.6457959190011 Time :  28761
accuracy train: 0.911317 val: 0.740299 test: 0.716052
max validation accuracy : 0.740299 max acc epoch : 8 test accuracy : 0.709374
Epoch :  16 loss training:  48.084940284490585 Time :  28793
accuracy train: 0.874586 val: 0.692537 test: 0.652980
Counter({0: 2582, 1: 2540, 2: 2278})

Epoch :  17 loss training:  50.87104111909866 Time :  28841
accuracy train: 0.925546 val: 0.737313 test: 0.720257
max validation accuracy : 0.740299 max acc epoch : 8 test accuracy : 0.709374
Epoch :  17 loss training:  41.346249014139175 Time :  28865
accuracy train: 0.877234 val: 0.704478 test: 0.665100
Counter({1: 2799, 0: 2466, 2: 2135})

Epoch :  18 loss training:  49.55034947395325 Time :  28919
accuracy train: 0.925546 val: 0.737313 test: 0.718031
max validation accuracy : 0.740299 max acc epoch : 8 test accuracy : 0.709374
Epoch :  18 loss training:  47.4916138201952 Time :  28942
accuracy train: 0.886499 val: 0.686567 test: 0.665348
Counter({0: 2665, 1: 2470, 2: 2265})

Epoch :  19 loss training:  48.369327798485756 Time :  29001
accuracy train: 0.930510 val: 0.740299 test: 0.715805
max validation accuracy : 0.740299 max acc epoch : 8 test accuracy : 0.709374
Epoch :  19 loss training:  39.43752986937761 Time :  29028
accuracy train: 0.904037 val: 0.695522 test: 0.677715
Counter({0: 2658, 1: 2651, 2: 2091})

Epoch :  20 loss training:  45.463468596339226 Time :  29088
accuracy train: 0.934811 val: 0.728358 test: 0.714074
max validation accuracy : 0.740299 max acc epoch : 8 test accuracy : 0.709374
Epoch :  20 loss training:  36.60926954448223 Time :  29118
accuracy train: 0.891794 val: 0.668657 test: 0.652980
Counter({1: 2698, 0: 2640, 2: 2062})

Epoch :  21 loss training:  44.30931232869625 Time :  29157
accuracy train: 0.936466 val: 0.728358 test: 0.716300
max validation accuracy : 0.740299 max acc epoch : 8 test accuracy : 0.709374
Epoch :  21 loss training:  32.4118629693985 Time :  29187
accuracy train: 0.893779 val: 0.704478 test: 0.670789
Counter({0: 2916, 2: 2507, 1: 1977})

Epoch :  22 loss training:  44.6798105686903 Time :  29228
accuracy train: 0.946393 val: 0.737313 test: 0.715558
max validation accuracy : 0.740299 max acc epoch : 8 test accuracy : 0.709374
Epoch :  22 loss training:  31.064307186752558 Time :  29262
accuracy train: 0.920251 val: 0.734328 test: 0.686372
Counter({0: 2854, 2: 2600, 1: 1946})

Epoch :  23 loss training:  40.935875445604324 Time :  29318
accuracy train: 0.947055 val: 0.746269 test: 0.718279
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.718279
Epoch :  23 loss training:  32.98202793672681 Time :  29343
accuracy train: 0.895433 val: 0.695522 test: 0.663863
Counter({2: 2786, 1: 2640, 0: 1974})

Epoch :  24 loss training:  40.34702670574188 Time :  29404
accuracy train: 0.945069 val: 0.758209 test: 0.715063
max validation accuracy : 0.758209 max acc epoch : 24 test accuracy : 0.715063
Epoch :  24 loss training:  26.907575622200966 Time :  29428
accuracy train: 0.929517 val: 0.713433 test: 0.672520
Counter({0: 2852, 1: 2620, 2: 1928})

Epoch :  25 loss training:  40.29428305476904 Time :  29462
accuracy train: 0.950695 val: 0.758209 test: 0.718526
max validation accuracy : 0.758209 max acc epoch : 24 test accuracy : 0.715063
Epoch :  25 loss training:  30.494780108332634 Time :  29484
accuracy train: 0.930179 val: 0.695522 test: 0.675736
Counter({1: 2890, 2: 2552, 0: 1958})

Epoch :  26 loss training:  38.77310125529766 Time :  29513
accuracy train: 0.956651 val: 0.746269 test: 0.718526
max validation accuracy : 0.758209 max acc epoch : 24 test accuracy : 0.715063
Epoch :  26 loss training:  31.329080168157816 Time :  29534
accuracy train: 0.930510 val: 0.704478 test: 0.664358
Counter({0: 2768, 1: 2740, 2: 1892})

Epoch :  27 loss training:  37.14409013837576 Time :  29567
accuracy train: 0.961284 val: 0.749254 test: 0.717536
max validation accuracy : 0.758209 max acc epoch : 24 test accuracy : 0.715063
Epoch :  27 loss training:  31.424554746598005 Time :  29588
accuracy train: 0.946393 val: 0.722388 test: 0.667079
Counter({0: 3019, 2: 2519, 1: 1862})

Epoch :  28 loss training:  36.37922532111406 Time :  29622
accuracy train: 0.961946 val: 0.755224 test: 0.718773
max validation accuracy : 0.758209 max acc epoch : 24 test accuracy : 0.715063
Epoch :  28 loss training:  26.33665480464697 Time :  29643
accuracy train: 0.947717 val: 0.701493 test: 0.663616
Counter({0: 2919, 2: 2642, 1: 1839})

Epoch :  29 loss training:  34.34545451402664 Time :  29679
accuracy train: 0.967571 val: 0.749254 test: 0.718773
max validation accuracy : 0.758209 max acc epoch : 24 test accuracy : 0.715063
Epoch :  29 loss training:  21.165627125650644 Time :  29702
accuracy train: 0.967571 val: 0.734328 test: 0.678951
Counter({0: 2985, 1: 2529, 2: 1886})

Epoch :  30 loss training:  33.93933638930321 Time :  29733
accuracy train: 0.969557 val: 0.746269 test: 0.718773
max validation accuracy : 0.758209 max acc epoch : 24 test accuracy : 0.715063
Epoch :  30 loss training:  28.670454498380423 Time :  29755
accuracy train: 0.929517 val: 0.680597 test: 0.649023
Counter({1: 2908, 2: 2588, 0: 1904})

Epoch :  31 loss training:  31.8678320646286 Time :  29789
accuracy train: 0.966909 val: 0.749254 test: 0.721494
max validation accuracy : 0.758209 max acc epoch : 24 test accuracy : 0.715063
Epoch :  31 loss training:  22.2193846963346 Time :  29811
accuracy train: 0.963600 val: 0.740299 test: 0.678704
Counter({0: 2962, 2: 2603, 1: 1835})

Epoch :  32 loss training:  31.44464721530676 Time :  29843
accuracy train: 0.973858 val: 0.755224 test: 0.721494
max validation accuracy : 0.758209 max acc epoch : 24 test accuracy : 0.715063
Epoch :  32 loss training:  23.220745963975787 Time :  29865
accuracy train: 0.964924 val: 0.725373 test: 0.674746
Counter({0: 3065, 2: 2221, 1: 2114})

Epoch :  33 loss training:  30.373344227671623 Time :  29897
accuracy train: 0.976175 val: 0.749254 test: 0.720257
max validation accuracy : 0.758209 max acc epoch : 24 test accuracy : 0.715063
Epoch :  33 loss training:  22.05240188539028 Time :  29919
accuracy train: 0.962277 val: 0.719403 test: 0.673262
Counter({0: 3023, 1: 2250, 2: 2127})

Epoch :  34 loss training:  29.548965774476528 Time :  29953
accuracy train: 0.979815 val: 0.746269 test: 0.717784
max validation accuracy : 0.758209 max acc epoch : 24 test accuracy : 0.715063
Epoch :  34 loss training:  24.683181634172797 Time :  29976
accuracy train: 0.963600 val: 0.707463 test: 0.675488
Counter({0: 2889, 2: 2523, 1: 1988})

Epoch :  35 loss training:  27.990152962505817 Time :  30011
accuracy train: 0.981138 val: 0.740299 test: 0.718279
max validation accuracy : 0.758209 max acc epoch : 24 test accuracy : 0.715063
Epoch :  35 loss training:  23.92943936213851 Time :  30033
accuracy train: 0.953342 val: 0.677612 test: 0.659411
Counter({0: 2904, 2: 2595, 1: 1901})

Epoch :  36 loss training:  28.014626696705818 Time :  30064
accuracy train: 0.982131 val: 0.743284 test: 0.721741
max validation accuracy : 0.758209 max acc epoch : 24 test accuracy : 0.715063
Epoch :  36 loss training:  23.351872842758894 Time :  30087
accuracy train: 0.978160 val: 0.731343 test: 0.675983
Counter({1: 2954, 0: 2529, 2: 1917})

Epoch :  37 loss training:  27.239687889814377 Time :  30124
accuracy train: 0.983124 val: 0.746269 test: 0.718031
max validation accuracy : 0.758209 max acc epoch : 24 test accuracy : 0.715063
Epoch :  37 loss training:  18.40105901286006 Time :  30147
accuracy train: 0.967902 val: 0.698507 test: 0.673510
Counter({0: 2944, 1: 2518, 2: 1938})

Epoch :  38 loss training:  25.206016421318054 Time :  30185
accuracy train: 0.982793 val: 0.752239 test: 0.721741
max validation accuracy : 0.758209 max acc epoch : 24 test accuracy : 0.715063
Epoch :  38 loss training:  22.916683111339808 Time :  30209
accuracy train: 0.975844 val: 0.713433 test: 0.673757
Counter({0: 2909, 2: 2533, 1: 1958})

Epoch :  39 loss training:  24.02649123594165 Time :  30254
accuracy train: 0.984447 val: 0.746269 test: 0.719021
max validation accuracy : 0.758209 max acc epoch : 24 test accuracy : 0.715063
Epoch :  39 loss training:  17.523402383551 Time :  30281
accuracy train: 0.961615 val: 0.707463 test: 0.664853
Counter({0: 2798, 1: 2631, 2: 1971})

Epoch :  40 loss training:  25.468636747449636 Time :  30320
accuracy train: 0.987756 val: 0.755224 test: 0.718031
max validation accuracy : 0.758209 max acc epoch : 24 test accuracy : 0.715063
Epoch :  40 loss training:  15.773830993101 Time :  30343
accuracy train: 0.983786 val: 0.740299 test: 0.681177
Counter({0: 2889, 1: 2278, 2: 2233})

Epoch :  41 loss training:  23.102759178727865 Time :  30384
accuracy train: 0.988418 val: 0.749254 test: 0.721494
max validation accuracy : 0.758209 max acc epoch : 24 test accuracy : 0.715063
Epoch :  41 loss training:  17.914999303407967 Time :  30405
accuracy train: 0.966248 val: 0.716418 test: 0.677715
Counter({0: 2909, 2: 2547, 1: 1944})

Epoch :  42 loss training:  23.137598417699337 Time :  30445
accuracy train: 0.988087 val: 0.761194 test: 0.720257
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  42 loss training:  15.62641591578722 Time :  30467
accuracy train: 0.966909 val: 0.722388 test: 0.656691
Counter({0: 3002, 2: 2219, 1: 2179})

Epoch :  43 loss training:  21.1572174616158 Time :  30507
accuracy train: 0.989080 val: 0.749254 test: 0.723225
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  43 loss training:  19.527097708545625 Time :  30529
accuracy train: 0.963269 val: 0.677612 test: 0.654959
Counter({0: 2988, 2: 2234, 1: 2178})

Epoch :  44 loss training:  21.090048912912607 Time :  30571
accuracy train: 0.990404 val: 0.752239 test: 0.718279
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  44 loss training:  29.664604254066944 Time :  30594
accuracy train: 0.969557 val: 0.689552 test: 0.669800
Counter({0: 2707, 2: 2384, 1: 2309})

Epoch :  45 loss training:  20.364265341311693 Time :  30631
accuracy train: 0.990735 val: 0.749254 test: 0.719268
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  45 loss training:  18.153441890142858 Time :  30654
accuracy train: 0.960291 val: 0.665672 test: 0.638387
Counter({1: 2932, 2: 2507, 0: 1961})

Epoch :  46 loss training:  19.00285866484046 Time :  30694
accuracy train: 0.991727 val: 0.755224 test: 0.719515
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  46 loss training:  15.11505937948823 Time :  30717
accuracy train: 0.993051 val: 0.710448 test: 0.683651
Counter({0: 2738, 1: 2673, 2: 1989})

Epoch :  47 loss training:  18.35434316843748 Time :  30756
accuracy train: 0.992389 val: 0.740299 test: 0.719763
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  47 loss training:  12.383471572771668 Time :  30778
accuracy train: 0.987756 val: 0.692537 test: 0.667574
Counter({1: 2707, 0: 2665, 2: 2028})

Epoch :  48 loss training:  17.575960516929626 Time :  30822
accuracy train: 0.994375 val: 0.758209 test: 0.719515
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  48 loss training:  13.427306818310171 Time :  30846
accuracy train: 0.988749 val: 0.719403 test: 0.675736
Counter({0: 2795, 1: 2631, 2: 1974})

Epoch :  49 loss training:  17.75075787305832 Time :  30887
accuracy train: 0.996360 val: 0.737313 test: 0.718279
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  49 loss training:  10.412505994550884 Time :  30910
accuracy train: 0.994375 val: 0.713433 test: 0.675488
Counter({1: 2832, 0: 2511, 2: 2057})

Epoch :  50 loss training:  16.29664073511958 Time :  30952
accuracy train: 0.995698 val: 0.740299 test: 0.722483
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  50 loss training:  10.0008461214602 Time :  30974
accuracy train: 0.992720 val: 0.719403 test: 0.679199
Counter({1: 2886, 0: 2545, 2: 1969})

Epoch :  51 loss training:  17.07962677255273 Time :  31019
accuracy train: 0.996360 val: 0.734328 test: 0.718031
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  51 loss training:  11.315029750112444 Time :  31041
accuracy train: 0.980807 val: 0.713433 test: 0.685382
Counter({1: 3031, 2: 2436, 0: 1933})

Epoch :  52 loss training:  15.870411338284612 Time :  31092
accuracy train: 0.995698 val: 0.743284 test: 0.716547
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  52 loss training:  15.896580164320767 Time :  31115
accuracy train: 0.986764 val: 0.695522 test: 0.671284
Counter({0: 2990, 1: 2390, 2: 2020})

Epoch :  53 loss training:  14.869494346901774 Time :  31180
accuracy train: 0.997022 val: 0.746269 test: 0.720257
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  53 loss training:  27.981335181742907 Time :  31203
accuracy train: 0.943084 val: 0.641791 test: 0.629978
Counter({2: 3247, 1: 2123, 0: 2030})

Epoch :  54 loss training:  15.007832190021873 Time :  31255
accuracy train: 0.997353 val: 0.746269 test: 0.720010
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  54 loss training:  52.15167389065027 Time :  31279
accuracy train: 0.965917 val: 0.692537 test: 0.666832
Counter({0: 2976, 2: 2433, 1: 1991})

Epoch :  55 loss training:  14.248278565704823 Time :  31320
accuracy train: 0.997684 val: 0.746269 test: 0.716547
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  55 loss training:  25.470891376957297 Time :  31342
accuracy train: 0.943415 val: 0.656716 test: 0.643829
Counter({2: 2825, 1: 2702, 0: 1873})

Epoch :  56 loss training:  14.285267349332571 Time :  31420
accuracy train: 0.998345 val: 0.734328 test: 0.720999
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  56 loss training:  21.822621600702405 Time :  31443
accuracy train: 0.968895 val: 0.683582 test: 0.673015
Counter({2: 3113, 1: 2550, 0: 1737})

Epoch :  57 loss training:  13.214193865656853 Time :  31518
accuracy train: 0.998345 val: 0.746269 test: 0.716547
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  57 loss training:  19.75237089022994 Time :  31541
accuracy train: 0.981469 val: 0.704478 test: 0.680188
Counter({1: 2989, 0: 2544, 2: 1867})

Epoch :  58 loss training:  12.923886945471168 Time :  31618
accuracy train: 0.999007 val: 0.731343 test: 0.715063
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  58 loss training:  14.011163110844791 Time :  31646
accuracy train: 0.982131 val: 0.683582 test: 0.676231
Counter({1: 3282, 2: 2338, 0: 1780})

Epoch :  59 loss training:  12.155391704291105 Time :  31723
accuracy train: 0.998676 val: 0.743284 test: 0.721247
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  59 loss training:  11.974687587469816 Time :  31745
accuracy train: 0.950364 val: 0.659701 test: 0.643087
Counter({0: 3145, 2: 2330, 1: 1925})

Epoch :  60 loss training:  11.811054999008775 Time :  31816
accuracy train: 0.999338 val: 0.746269 test: 0.720752
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  60 loss training:  12.689536789432168 Time :  31839
accuracy train: 0.987095 val: 0.698507 test: 0.681177
Counter({1: 2589, 0: 2516, 2: 2295})

Epoch :  61 loss training:  10.612593488767743 Time :  31917
accuracy train: 0.999338 val: 0.746269 test: 0.715805
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  61 loss training:  10.774477512575686 Time :  31939
accuracy train: 0.988418 val: 0.695522 test: 0.678704
Counter({0: 2604, 2: 2590, 1: 2206})

Epoch :  62 loss training:  11.409038811922073 Time :  31995
accuracy train: 0.998015 val: 0.737313 test: 0.719515
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  62 loss training:  12.318669121712446 Time :  32017
accuracy train: 0.991727 val: 0.716418 test: 0.677962
Counter({0: 3575, 1: 2492, 2: 1333})

Epoch :  63 loss training:  11.336441008374095 Time :  32085
accuracy train: 0.999007 val: 0.734328 test: 0.719763
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  63 loss training:  18.313938841223717 Time :  32108
accuracy train: 0.973197 val: 0.668657 test: 0.668316
Counter({0: 2996, 1: 2237, 2: 2167})

Epoch :  64 loss training:  10.081111492589116 Time :  32156
accuracy train: 0.999669 val: 0.734328 test: 0.718279
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  64 loss training:  17.287045364268124 Time :  32183
accuracy train: 0.961946 val: 0.653731 test: 0.651991
Counter({1: 3378, 0: 2199, 2: 1823})

Epoch :  65 loss training:  10.886210811324418 Time :  32250
accuracy train: 0.999669 val: 0.737313 test: 0.719021
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  65 loss training:  15.846094142179936 Time :  32272
accuracy train: 0.983786 val: 0.692537 test: 0.672768
Counter({2: 2969, 1: 2743, 0: 1688})

Epoch :  66 loss training:  9.922650752589107 Time :  32329
accuracy train: 0.999669 val: 0.731343 test: 0.719268
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  66 loss training:  17.12253399565816 Time :  32351
accuracy train: 0.991066 val: 0.704478 test: 0.688350
Counter({1: 3031, 0: 2733, 2: 1636})

Epoch :  67 loss training:  9.839843774214387 Time :  32403
accuracy train: 1.000000 val: 0.734328 test: 0.718526
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  67 loss training:  16.261707752477378 Time :  32424
accuracy train: 0.991396 val: 0.698507 test: 0.669305
Counter({2: 3141, 0: 2252, 1: 2007})

Epoch :  68 loss training:  9.187145012430847 Time :  32472
accuracy train: 1.000000 val: 0.734328 test: 0.717042
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  68 loss training:  16.362871912308037 Time :  32494
accuracy train: 0.985771 val: 0.692537 test: 0.679693
Counter({0: 3262, 1: 2161, 2: 1977})

Epoch :  69 loss training:  8.131919069215655 Time :  32552
accuracy train: 1.000000 val: 0.740299 test: 0.719763
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  69 loss training:  17.533608969300985 Time :  32574
accuracy train: 0.961615 val: 0.677612 test: 0.655207
Counter({0: 3093, 1: 2457, 2: 1850})

Epoch :  70 loss training:  8.245677988044918 Time :  32629
accuracy train: 1.000000 val: 0.740299 test: 0.718031
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  70 loss training:  13.6300316399429 Time :  32652
accuracy train: 0.950033 val: 0.677612 test: 0.639377
Counter({0: 3169, 1: 2467, 2: 1764})

Epoch :  71 loss training:  8.127805966883898 Time :  32696
accuracy train: 1.000000 val: 0.749254 test: 0.717289
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  71 loss training:  16.637756354175508 Time :  32723
accuracy train: 0.991727 val: 0.695522 test: 0.682414
Counter({0: 2946, 1: 2523, 2: 1931})

Epoch :  72 loss training:  7.375831447541714 Time :  32765
accuracy train: 0.999669 val: 0.749254 test: 0.714321
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  72 loss training:  10.607567415572703 Time :  32787
accuracy train: 0.988418 val: 0.710448 test: 0.676725
Counter({2: 3018, 0: 2546, 1: 1836})

Epoch :  73 loss training:  7.075945470482111 Time :  32842
accuracy train: 0.999669 val: 0.740299 test: 0.720999
max validation accuracy : 0.761194 max acc epoch : 42 test accuracy : 0.720257
Epoch :  73 loss training:  10.085149068385363 Time :  32868
accuracy train: 0.996360 val: 0.701493 test: 0.672520
Counter({0: 3539, 2: 2257, 1: 1604})

========================================================================================================================================================================================================
max acc epoch :  42
max validation accuracy :  0.7611940298507462
test accuracy :  0.7202572347266881
last test_accuracy :  0.7209992579767499
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=791, weight_decay=0)
device :  cuda:0
Counter({2: 2591, 1: 2556, 0: 2253})

Epoch :  1 loss training:  212.63822865486145 Time :  32985
accuracy train: 0.631370 val: 0.576119 test: 0.590651
max validation accuracy : 0.576119 max acc epoch : 1 test accuracy : 0.590651
Epoch :  1 loss training:  274.2368619441986 Time :  33010
accuracy train: 0.575447 val: 0.507463 test: 0.556270
Counter({0: 3106, 2: 2663, 1: 1631})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  142.5183104276657 Time :  33051
accuracy train: 0.715420 val: 0.668657 test: 0.650012
max validation accuracy : 0.668657 max acc epoch : 2 test accuracy : 0.650012
Epoch :  2 loss training:  173.30877417325974 Time :  33073
accuracy train: 0.601257 val: 0.570149 test: 0.558496
Counter({0: 3606, 1: 2142, 2: 1652})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  119.36138406395912 Time :  33116
accuracy train: 0.765056 val: 0.698507 test: 0.686619
max validation accuracy : 0.698507 max acc epoch : 3 test accuracy : 0.686619
Epoch :  3 loss training:  148.8903333246708 Time :  33138
accuracy train: 0.659497 val: 0.611940 test: 0.583478
Counter({1: 2993, 0: 2204, 2: 2203})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  100.44258949160576 Time :  33181
accuracy train: 0.782263 val: 0.692537 test: 0.676478
max validation accuracy : 0.698507 max acc epoch : 3 test accuracy : 0.686619
Epoch :  4 loss training:  121.88865181803703 Time :  33203
accuracy train: 0.675381 val: 0.585075 test: 0.607470
Counter({1: 2804, 0: 2688, 2: 1908})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  91.31395569443703 Time :  33236
accuracy train: 0.811383 val: 0.728358 test: 0.694286
max validation accuracy : 0.728358 max acc epoch : 5 test accuracy : 0.694286
Epoch :  5 loss training:  108.53427138924599 Time :  33258
accuracy train: 0.738915 val: 0.659701 test: 0.629978
Counter({1: 2772, 2: 2703, 0: 1925})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.86056569218636 Time :  33301
accuracy train: 0.827929 val: 0.731343 test: 0.701707
max validation accuracy : 0.731343 max acc epoch : 6 test accuracy : 0.701707
Epoch :  6 loss training:  97.06446671485901 Time :  33324
accuracy train: 0.726340 val: 0.617910 test: 0.625278
Counter({1: 2807, 0: 2678, 2: 1915})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  71.93446142971516 Time :  33358
accuracy train: 0.857379 val: 0.734328 test: 0.708880
max validation accuracy : 0.734328 max acc epoch : 7 test accuracy : 0.708880
Epoch :  7 loss training:  92.4691884368658 Time :  33380
accuracy train: 0.737591 val: 0.614925 test: 0.611922
Counter({1: 2800, 0: 2439, 2: 2161})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  70.21481421589851 Time :  33412
accuracy train: 0.862674 val: 0.737313 test: 0.708385
max validation accuracy : 0.737313 max acc epoch : 8 test accuracy : 0.708385
Epoch :  8 loss training:  83.34159751236439 Time :  33434
accuracy train: 0.741562 val: 0.591045 test: 0.630720
Counter({1: 2928, 0: 2242, 2: 2230})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.76897257566452 Time :  33482
accuracy train: 0.872601 val: 0.719403 test: 0.707643
max validation accuracy : 0.737313 max acc epoch : 8 test accuracy : 0.708385
Epoch :  9 loss training:  75.40043671429157 Time :  33509
accuracy train: 0.770020 val: 0.650746 test: 0.637151
Counter({2: 3112, 0: 2221, 1: 2067})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.85317198932171 Time :  33552
accuracy train: 0.893117 val: 0.740299 test: 0.715805
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.715805
Epoch :  10 loss training:  66.74262151122093 Time :  33574
accuracy train: 0.771674 val: 0.632836 test: 0.621321
Counter({0: 2718, 1: 2552, 2: 2130})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.892434895038605 Time :  33611
accuracy train: 0.896095 val: 0.737313 test: 0.715805
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.715805
Epoch :  11 loss training:  66.27827432751656 Time :  33633
accuracy train: 0.794176 val: 0.680597 test: 0.625278
Counter({2: 2728, 0: 2604, 1: 2068})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  55.970557644963264 Time :  33680
accuracy train: 0.900728 val: 0.746269 test: 0.717289
max validation accuracy : 0.746269 max acc epoch : 12 test accuracy : 0.717289
Epoch :  12 loss training:  64.00136058032513 Time :  33702
accuracy train: 0.831899 val: 0.686567 test: 0.658175
Counter({1: 2842, 0: 2619, 2: 1939})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  54.674589052796364 Time :  33733
accuracy train: 0.911317 val: 0.752239 test: 0.717289
max validation accuracy : 0.752239 max acc epoch : 13 test accuracy : 0.717289
Epoch :  13 loss training:  56.64907018095255 Time :  33756
accuracy train: 0.863997 val: 0.707463 test: 0.663121
Counter({1: 2802, 2: 2652, 0: 1946})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  52.746222004294395 Time :  33786
accuracy train: 0.911317 val: 0.755224 test: 0.717289
max validation accuracy : 0.755224 max acc epoch : 14 test accuracy : 0.717289
Epoch :  14 loss training:  48.40348635613918 Time :  33808
accuracy train: 0.885175 val: 0.707463 test: 0.678951
Counter({2: 2765, 0: 2684, 1: 1951})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  52.72371885180473 Time :  33841
accuracy train: 0.912972 val: 0.761194 test: 0.718526
max validation accuracy : 0.761194 max acc epoch : 15 test accuracy : 0.718526
Epoch :  15 loss training:  52.94730556756258 Time :  33863
accuracy train: 0.855725 val: 0.719403 test: 0.655454
Counter({0: 2831, 2: 2694, 1: 1875})

Epoch :  16 loss training:  52.50751782953739 Time :  33902
accuracy train: 0.913302 val: 0.746269 test: 0.718526
max validation accuracy : 0.761194 max acc epoch : 15 test accuracy : 0.718526
Epoch :  16 loss training:  44.815589763224125 Time :  33924
accuracy train: 0.866314 val: 0.677612 test: 0.651744
Counter({1: 2872, 0: 2715, 2: 1813})

Epoch :  17 loss training:  50.17092652618885 Time :  33965
accuracy train: 0.920251 val: 0.767164 test: 0.721741
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  17 loss training:  40.00330625474453 Time :  33988
accuracy train: 0.864659 val: 0.710448 test: 0.651249
Counter({2: 2829, 1: 2663, 0: 1908})

Epoch :  18 loss training:  48.0335097014904 Time :  34018
accuracy train: 0.930510 val: 0.767164 test: 0.724957
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  18 loss training:  37.571046352386475 Time :  34041
accuracy train: 0.863005 val: 0.626866 test: 0.633935
Counter({2: 2807, 0: 2649, 1: 1944})

Epoch :  19 loss training:  48.1339410841465 Time :  34074
accuracy train: 0.931833 val: 0.758209 test: 0.714074
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  19 loss training:  36.456447564065456 Time :  34096
accuracy train: 0.913302 val: 0.713433 test: 0.684887
Counter({2: 2819, 0: 2646, 1: 1935})

Epoch :  20 loss training:  45.35578143596649 Time :  34132
accuracy train: 0.937459 val: 0.752239 test: 0.722731
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  20 loss training:  33.53171514719725 Time :  34153
accuracy train: 0.921906 val: 0.704478 test: 0.680683
Counter({2: 2816, 1: 2770, 0: 1814})

Epoch :  21 loss training:  43.48848279565573 Time :  34186
accuracy train: 0.939775 val: 0.758209 test: 0.716300
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  21 loss training:  30.915149476379156 Time :  34208
accuracy train: 0.907015 val: 0.695522 test: 0.670294
Counter({1: 2874, 0: 2794, 2: 1732})

Epoch :  22 loss training:  43.83259201794863 Time :  34239
accuracy train: 0.945731 val: 0.746269 test: 0.723473
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  22 loss training:  30.90366730466485 Time :  34261
accuracy train: 0.937459 val: 0.707463 test: 0.691813
Counter({0: 2898, 1: 2714, 2: 1788})

Epoch :  23 loss training:  42.83373945951462 Time :  34302
accuracy train: 0.946724 val: 0.749254 test: 0.720010
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  23 loss training:  29.470454338937998 Time :  34325
accuracy train: 0.928524 val: 0.692537 test: 0.669552
Counter({0: 2980, 1: 2635, 2: 1785})

Epoch :  24 loss training:  39.638546243309975 Time :  34358
accuracy train: 0.953011 val: 0.755224 test: 0.723473
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  24 loss training:  27.51319856196642 Time :  34380
accuracy train: 0.911979 val: 0.668657 test: 0.655454
Counter({2: 2890, 1: 2698, 0: 1812})

Epoch :  25 loss training:  38.80873602628708 Time :  34425
accuracy train: 0.951688 val: 0.755224 test: 0.722483
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  25 loss training:  27.623035352677107 Time :  34450
accuracy train: 0.956982 val: 0.704478 test: 0.681177
Counter({1: 3011, 2: 2522, 0: 1867})

Epoch :  26 loss training:  38.354155875742435 Time :  34485
accuracy train: 0.959629 val: 0.758209 test: 0.722483
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  26 loss training:  28.767273638397455 Time :  34508
accuracy train: 0.942753 val: 0.710448 test: 0.670789
Counter({1: 2822, 0: 2720, 2: 1858})

Epoch :  27 loss training:  37.25261690467596 Time :  34539
accuracy train: 0.961615 val: 0.767164 test: 0.724709
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  27 loss training:  26.418880075216293 Time :  34563
accuracy train: 0.938451 val: 0.665672 test: 0.659659
Counter({0: 2952, 1: 2605, 2: 1843})

Epoch :  28 loss training:  36.52803536504507 Time :  34599
accuracy train: 0.965255 val: 0.746269 test: 0.726441
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  28 loss training:  26.327728547155857 Time :  34622
accuracy train: 0.941430 val: 0.689552 test: 0.662379
Counter({1: 2918, 0: 2639, 2: 1843})

Epoch :  29 loss training:  32.642898224294186 Time :  34660
accuracy train: 0.965586 val: 0.749254 test: 0.725451
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  29 loss training:  24.182050295174122 Time :  34684
accuracy train: 0.952019 val: 0.734328 test: 0.671531
Counter({1: 3200, 0: 2297, 2: 1903})

Epoch :  30 loss training:  33.592195980250835 Time :  34725
accuracy train: 0.968233 val: 0.755224 test: 0.722236
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  30 loss training:  23.671038188040257 Time :  34753
accuracy train: 0.926539 val: 0.650746 test: 0.652238
Counter({1: 3220, 2: 2318, 0: 1862})

Epoch :  31 loss training:  32.122723408043385 Time :  34793
accuracy train: 0.970549 val: 0.764179 test: 0.722236
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  31 loss training:  24.814466012641788 Time :  34817
accuracy train: 0.971542 val: 0.713433 test: 0.676973
Counter({1: 3158, 0: 2402, 2: 1840})

Epoch :  32 loss training:  31.45551985502243 Time :  34855
accuracy train: 0.973858 val: 0.758209 test: 0.722236
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  32 loss training:  24.1462290417403 Time :  34877
accuracy train: 0.976837 val: 0.725373 test: 0.669800
Counter({2: 2860, 0: 2788, 1: 1752})

Epoch :  33 loss training:  30.73188964277506 Time :  34919
accuracy train: 0.976175 val: 0.758209 test: 0.721494
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  33 loss training:  39.10735830292106 Time :  34942
accuracy train: 0.933157 val: 0.698507 test: 0.641108
Counter({0: 2877, 1: 2661, 2: 1862})

Epoch :  34 loss training:  29.423031844198704 Time :  34985
accuracy train: 0.977167 val: 0.755224 test: 0.725699
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  34 loss training:  24.160125628113747 Time :  35013
accuracy train: 0.938451 val: 0.671642 test: 0.664605
Counter({1: 2932, 2: 2606, 0: 1862})

Epoch :  35 loss training:  27.928424552083015 Time :  35057
accuracy train: 0.980146 val: 0.764179 test: 0.723473
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  35 loss training:  18.362317046150565 Time :  35079
accuracy train: 0.963931 val: 0.698507 test: 0.654217
Counter({1: 2815, 2: 2796, 0: 1789})

Epoch :  36 loss training:  26.269119255244732 Time :  35118
accuracy train: 0.981800 val: 0.761194 test: 0.722731
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  36 loss training:  17.465151699259877 Time :  35140
accuracy train: 0.977829 val: 0.722388 test: 0.681425
Counter({1: 2937, 2: 2680, 0: 1783})

Epoch :  37 loss training:  26.971368968486786 Time :  35175
accuracy train: 0.984778 val: 0.764179 test: 0.722236
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  37 loss training:  18.438646350987256 Time :  35202
accuracy train: 0.971873 val: 0.725373 test: 0.660401
Counter({1: 2976, 2: 2615, 0: 1809})

Epoch :  38 loss training:  24.983856700360775 Time :  35241
accuracy train: 0.983455 val: 0.761194 test: 0.720505
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  38 loss training:  17.248938746750355 Time :  35262
accuracy train: 0.961615 val: 0.674627 test: 0.665595
Counter({0: 2890, 1: 2734, 2: 1776})

Epoch :  39 loss training:  24.596953520551324 Time :  35301
accuracy train: 0.985440 val: 0.767164 test: 0.722236
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  39 loss training:  14.270065611228347 Time :  35325
accuracy train: 0.981469 val: 0.707463 test: 0.682909
Counter({1: 2925, 0: 2730, 2: 1745})

Epoch :  40 loss training:  24.004930913448334 Time :  35369
accuracy train: 0.988087 val: 0.767164 test: 0.724462
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  40 loss training:  19.03206844907254 Time :  35393
accuracy train: 0.985109 val: 0.704478 test: 0.671778
Counter({0: 2935, 1: 2724, 2: 1741})

Epoch :  41 loss training:  23.593155033886433 Time :  35437
accuracy train: 0.987756 val: 0.764179 test: 0.725204
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  41 loss training:  18.511485198512673 Time :  35460
accuracy train: 0.974851 val: 0.674627 test: 0.678457
Counter({1: 3125, 2: 2489, 0: 1786})

Epoch :  42 loss training:  21.962240289896727 Time :  35501
accuracy train: 0.992058 val: 0.752239 test: 0.722236
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  42 loss training:  19.538765714503825 Time :  35524
accuracy train: 0.980477 val: 0.719403 test: 0.667079
Counter({1: 3158, 0: 2404, 2: 1838})

Epoch :  43 loss training:  20.769700303673744 Time :  35572
accuracy train: 0.990404 val: 0.755224 test: 0.723720
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  43 loss training:  19.861237892415375 Time :  35597
accuracy train: 0.969226 val: 0.701493 test: 0.663616
Counter({0: 2861, 1: 2688, 2: 1851})

Epoch :  44 loss training:  21.215689927339554 Time :  35644
accuracy train: 0.993382 val: 0.755224 test: 0.721989
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  44 loss training:  22.580073351971805 Time :  35672
accuracy train: 0.848445 val: 0.591045 test: 0.582241
Counter({2: 4301, 1: 1858, 0: 1241})

Epoch :  45 loss training:  20.421723026782274 Time :  35735
accuracy train: 0.993382 val: 0.749254 test: 0.718773
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  45 loss training:  23.97797143086791 Time :  35761
accuracy train: 0.957313 val: 0.704478 test: 0.658917
Counter({0: 3176, 2: 2632, 1: 1592})

Epoch :  46 loss training:  19.763698421418667 Time :  35818
accuracy train: 0.993713 val: 0.749254 test: 0.720505
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  46 loss training:  15.964596550911665 Time :  35845
accuracy train: 0.985109 val: 0.731343 test: 0.672768
Counter({0: 2645, 1: 2472, 2: 2283})

Epoch :  47 loss training:  17.501933878287673 Time :  35916
accuracy train: 0.994705 val: 0.764179 test: 0.722978
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  47 loss training:  15.92505064047873 Time :  35941
accuracy train: 0.970549 val: 0.701493 test: 0.662627
Counter({2: 2915, 1: 2275, 0: 2210})

Epoch :  48 loss training:  18.035622250288725 Time :  36009
accuracy train: 0.995367 val: 0.761194 test: 0.720752
max validation accuracy : 0.767164 max acc epoch : 17 test accuracy : 0.721741
Epoch :  48 loss training:  15.842761040199548 Time :  36032
accuracy train: 0.981469 val: 0.680597 test: 0.667079
Counter({1: 2853, 0: 2636, 2: 1911})

========================================================================================================================================================================================================
max acc epoch :  17
max validation accuracy :  0.7671641791044777
test accuracy :  0.7217412812268118
last test_accuracy :  0.720751916893396
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	val_accuracy :  76.71641791044776 	test_accuracy :  71.90205293099183 	max_acc epoch :  61 	last test_accuracy :  72.1246599060104
k :  1 	val_accuracy :  78.50746268656717 	test_accuracy :  72.42146920603513 	max_acc epoch :  78 	last test_accuracy :  71.92678703932724
k :  2 	val_accuracy :  76.4179104477612 	test_accuracy :  72.09992579767498 	max_acc epoch :  28 	last test_accuracy :  71.72891417264408
k :  3 	val_accuracy :  76.11940298507463 	test_accuracy :  72.02572347266882 	max_acc epoch :  42 	last test_accuracy :  72.09992579767498
k :  4 	val_accuracy :  76.71641791044776 	test_accuracy :  72.17412812268118 	max_acc epoch :  17 	last test_accuracy :  72.0751916893396

avg :  	val_accuracy :  76.8955223880597 	test_accuracy :  72.12465990601038 	last_accuracy :  71.99109572099924
