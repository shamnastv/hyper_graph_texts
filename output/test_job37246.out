

date and time :  Sat Jun 12 18:40:38 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=23, weight_decay=0)
device :  cuda:0
Counter({2: 2587, 0: 2555, 1: 2258})

Epoch :  1 loss training:  212.03130888938904 Time :  18
accuracy train: 0.671741 val: 0.647761 test: 0.636161
max validation accuracy : 0.647761 max acc epoch : 1 test accuracy : 0.636161
Counter({0: 3313, 1: 2515, 2: 1572})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  145.92458426952362 Time :  42
accuracy train: 0.730311 val: 0.683582 test: 0.655454
max validation accuracy : 0.683582 max acc epoch : 2 test accuracy : 0.655454
Counter({1: 3216, 2: 2645, 0: 1539})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  123.62591004371643 Time :  68
accuracy train: 0.743878 val: 0.695522 test: 0.658422
max validation accuracy : 0.695522 max acc epoch : 3 test accuracy : 0.658422
Counter({1: 3043, 0: 2326, 2: 2031})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  97.76012715697289 Time :  94
accuracy train: 0.800132 val: 0.698507 test: 0.689587
max validation accuracy : 0.698507 max acc epoch : 4 test accuracy : 0.689587
Counter({1: 2953, 0: 2457, 2: 1990})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.72799417376518 Time :  121
accuracy train: 0.830576 val: 0.710448 test: 0.691071
max validation accuracy : 0.710448 max acc epoch : 5 test accuracy : 0.691071
Counter({1: 3050, 0: 2452, 2: 1898})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  81.81760749220848 Time :  145
accuracy train: 0.829583 val: 0.722388 test: 0.695028
max validation accuracy : 0.722388 max acc epoch : 6 test accuracy : 0.695028
Counter({2: 2955, 0: 2885, 1: 1560})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  71.76182867586613 Time :  168
accuracy train: 0.855725 val: 0.710448 test: 0.702201
max validation accuracy : 0.722388 max acc epoch : 6 test accuracy : 0.695028
Counter({0: 3036, 2: 2820, 1: 1544})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  69.01654762029648 Time :  192
accuracy train: 0.861681 val: 0.722388 test: 0.698739
max validation accuracy : 0.722388 max acc epoch : 6 test accuracy : 0.695028
Counter({1: 3213, 0: 2648, 2: 1539})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.23144353926182 Time :  219
accuracy train: 0.882197 val: 0.710448 test: 0.698244
max validation accuracy : 0.722388 max acc epoch : 6 test accuracy : 0.695028
Counter({2: 3245, 0: 2619, 1: 1536})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.92496192455292 Time :  242
accuracy train: 0.883852 val: 0.716418 test: 0.713084
max validation accuracy : 0.722388 max acc epoch : 6 test accuracy : 0.695028
Counter({1: 3249, 2: 2624, 0: 1527})

Epoch :  11 loss training:  58.08421251177788 Time :  267
accuracy train: 0.900066 val: 0.731343 test: 0.707395
max validation accuracy : 0.731343 max acc epoch : 11 test accuracy : 0.707395
Counter({0: 3282, 1: 2598, 2: 1520})

Epoch :  12 loss training:  54.98557148873806 Time :  291
accuracy train: 0.906353 val: 0.725373 test: 0.712837
max validation accuracy : 0.731343 max acc epoch : 11 test accuracy : 0.707395
Counter({0: 3286, 1: 2594, 2: 1520})

Epoch :  13 loss training:  54.08496309816837 Time :  316
accuracy train: 0.916281 val: 0.722388 test: 0.714816
max validation accuracy : 0.731343 max acc epoch : 11 test accuracy : 0.707395
Counter({0: 3288, 1: 2597, 2: 1515})

Epoch :  14 loss training:  48.56208294630051 Time :  341
accuracy train: 0.926208 val: 0.731343 test: 0.715558
max validation accuracy : 0.731343 max acc epoch : 11 test accuracy : 0.707395
Counter({1: 3302, 0: 2577, 2: 1521})

Epoch :  15 loss training:  45.70639379322529 Time :  366
accuracy train: 0.934480 val: 0.716418 test: 0.714816
max validation accuracy : 0.731343 max acc epoch : 11 test accuracy : 0.707395
Counter({2: 3308, 1: 2569, 0: 1523})

Epoch :  16 loss training:  44.71826207637787 Time :  390
accuracy train: 0.940768 val: 0.725373 test: 0.713826
max validation accuracy : 0.731343 max acc epoch : 11 test accuracy : 0.707395
Counter({0: 3304, 1: 2577, 2: 1519})

Epoch :  17 loss training:  42.10320295393467 Time :  415
accuracy train: 0.951026 val: 0.737313 test: 0.719515
max validation accuracy : 0.737313 max acc epoch : 17 test accuracy : 0.719515
Counter({0: 3323, 2: 2554, 1: 1523})

Epoch :  18 loss training:  41.00979133695364 Time :  458
accuracy train: 0.950364 val: 0.719403 test: 0.719515
max validation accuracy : 0.737313 max acc epoch : 17 test accuracy : 0.719515
Counter({2: 3313, 0: 2558, 1: 1529})

Epoch :  19 loss training:  36.719511061906815 Time :  482
accuracy train: 0.954997 val: 0.716418 test: 0.713084
max validation accuracy : 0.737313 max acc epoch : 17 test accuracy : 0.719515
Counter({0: 3307, 2: 2569, 1: 1524})

Epoch :  20 loss training:  35.291455149650574 Time :  505
accuracy train: 0.959960 val: 0.731343 test: 0.722483
max validation accuracy : 0.737313 max acc epoch : 17 test accuracy : 0.719515
Counter({0: 3303, 2: 2575, 1: 1522})

Epoch :  21 loss training:  32.483732275664806 Time :  528
accuracy train: 0.967240 val: 0.740299 test: 0.720010
max validation accuracy : 0.740299 max acc epoch : 21 test accuracy : 0.720010
Counter({2: 3283, 0: 2598, 1: 1519})

Epoch :  22 loss training:  29.253820843994617 Time :  553
accuracy train: 0.973858 val: 0.734328 test: 0.719763
max validation accuracy : 0.740299 max acc epoch : 21 test accuracy : 0.720010
Counter({0: 3198, 1: 2680, 2: 1522})

Epoch :  23 loss training:  29.602109253406525 Time :  579
accuracy train: 0.981469 val: 0.743284 test: 0.717536
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.717536
Counter({0: 3153, 1: 2733, 2: 1514})

Epoch :  24 loss training:  26.793156921863556 Time :  606
accuracy train: 0.983124 val: 0.749254 test: 0.720505
max validation accuracy : 0.749254 max acc epoch : 24 test accuracy : 0.720505
Counter({2: 3132, 1: 2736, 0: 1532})

Epoch :  25 loss training:  24.155271783471107 Time :  630
accuracy train: 0.985440 val: 0.764179 test: 0.720505
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3127, 1: 2739, 2: 1534})

Epoch :  26 loss training:  23.0441889539361 Time :  654
accuracy train: 0.986764 val: 0.731343 test: 0.722978
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3144, 1: 2725, 2: 1531})

Epoch :  27 loss training:  21.742149740457535 Time :  678
accuracy train: 0.988749 val: 0.749254 test: 0.718526
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({2: 3144, 0: 2738, 1: 1518})

Epoch :  28 loss training:  21.245813947170973 Time :  700
accuracy train: 0.994705 val: 0.740299 test: 0.720257
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3146, 1: 2750, 2: 1504})

Epoch :  29 loss training:  19.230936478823423 Time :  724
accuracy train: 0.991727 val: 0.746269 test: 0.725204
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({1: 3148, 0: 2746, 2: 1506})

Epoch :  30 loss training:  18.08673121407628 Time :  746
accuracy train: 0.995036 val: 0.737313 test: 0.716300
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3159, 1: 2734, 2: 1507})

Epoch :  31 loss training:  17.380709774792194 Time :  771
accuracy train: 0.994705 val: 0.734328 test: 0.722731
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({1: 3165, 0: 2725, 2: 1510})

Epoch :  32 loss training:  15.60215388983488 Time :  796
accuracy train: 0.995698 val: 0.734328 test: 0.722483
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3160, 2: 2728, 1: 1512})

Epoch :  33 loss training:  12.946291139349341 Time :  822
accuracy train: 0.998015 val: 0.737313 test: 0.725699
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3155, 2: 2733, 1: 1512})

Epoch :  34 loss training:  13.623200321570039 Time :  847
accuracy train: 0.997022 val: 0.737313 test: 0.712342
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3127, 2: 2758, 1: 1515})

Epoch :  35 loss training:  13.01833188906312 Time :  873
accuracy train: 0.997353 val: 0.743284 test: 0.718279
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3136, 2: 2759, 1: 1505})

Epoch :  36 loss training:  12.223466493189335 Time :  898
accuracy train: 0.999338 val: 0.731343 test: 0.717784
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3153, 2: 2756, 1: 1491})

Epoch :  37 loss training:  11.124979007057846 Time :  924
accuracy train: 0.997353 val: 0.728358 test: 0.720010
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3153, 1: 2761, 2: 1486})

Epoch :  38 loss training:  10.672367824241519 Time :  948
accuracy train: 0.999669 val: 0.743284 test: 0.718526
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3145, 1: 2773, 2: 1482})

Epoch :  39 loss training:  9.904820252209902 Time :  993
accuracy train: 0.999669 val: 0.737313 test: 0.717042
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3161, 1: 2770, 2: 1469})

Epoch :  40 loss training:  9.639086315408349 Time :  1020
accuracy train: 1.000000 val: 0.749254 test: 0.721741
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3165, 2: 2763, 1: 1472})

Epoch :  41 loss training:  9.035260139033198 Time :  1045
accuracy train: 0.999669 val: 0.746269 test: 0.721989
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({2: 3145, 0: 2784, 1: 1471})

Epoch :  42 loss training:  7.794790035113692 Time :  1069
accuracy train: 0.999669 val: 0.740299 test: 0.722483
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3150, 2: 2781, 1: 1469})

Epoch :  43 loss training:  7.658659220673144 Time :  1092
accuracy train: 1.000000 val: 0.749254 test: 0.721989
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3174, 2: 2765, 1: 1461})

Epoch :  44 loss training:  7.1428268207237124 Time :  1117
accuracy train: 1.000000 val: 0.743284 test: 0.716052
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({2: 3205, 0: 2750, 1: 1445})

Epoch :  45 loss training:  7.536623201332986 Time :  1142
accuracy train: 1.000000 val: 0.740299 test: 0.712095
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({2: 3224, 1: 2741, 0: 1435})

Epoch :  46 loss training:  7.7223079688847065 Time :  1164
accuracy train: 0.999669 val: 0.752239 test: 0.713332
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3219, 1: 2755, 2: 1426})

Epoch :  47 loss training:  6.185573073104024 Time :  1188
accuracy train: 1.000000 val: 0.734328 test: 0.718279
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({2: 3216, 0: 2765, 1: 1419})

Epoch :  48 loss training:  5.542758430354297 Time :  1212
accuracy train: 1.000000 val: 0.746269 test: 0.718279
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3215, 1: 2771, 2: 1414})

Epoch :  49 loss training:  5.791358034592122 Time :  1236
accuracy train: 1.000000 val: 0.737313 test: 0.717289
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({2: 3201, 1: 2780, 0: 1419})

Epoch :  50 loss training:  6.132618923205882 Time :  1260
accuracy train: 1.000000 val: 0.731343 test: 0.711353
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3227, 1: 2762, 2: 1411})

Epoch :  51 loss training:  4.8644988955929875 Time :  1285
accuracy train: 1.000000 val: 0.740299 test: 0.716547
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({1: 3235, 2: 2753, 0: 1412})

Epoch :  52 loss training:  5.206298867706209 Time :  1309
accuracy train: 1.000000 val: 0.740299 test: 0.723720
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3243, 2: 2751, 1: 1406})

Epoch :  53 loss training:  4.4043265983927995 Time :  1334
accuracy train: 1.000000 val: 0.743284 test: 0.720257
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({2: 3248, 1: 2748, 0: 1404})

Epoch :  54 loss training:  4.076171076623723 Time :  1357
accuracy train: 1.000000 val: 0.740299 test: 0.720010
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({2: 3200, 1: 2806, 0: 1394})

Epoch :  55 loss training:  4.631190438056365 Time :  1383
accuracy train: 1.000000 val: 0.746269 test: 0.717289
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({2: 3194, 0: 2812, 1: 1394})

Epoch :  56 loss training:  4.274019876029342 Time :  1410
accuracy train: 1.000000 val: 0.731343 test: 0.720010
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3203, 2: 2807, 1: 1390})

========================================================================================================================================================================================================
best acc epoch :  25
validation accuracy :  0.764179104477612
test accuracy :  0.720504575810042
last test_accuracy :  0.7200098936433341
second best val :  0.7522388059701492
second best test :  0.720504575810042
max gap 6
========================================================================================================================================================================================================

(4043, 1400)
itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=23, weight_decay=0)
device :  cuda:0
Counter({2: 2587, 0: 2555, 1: 2258})

Epoch :  1 loss training:  211.9905707836151 Time :  1524
accuracy train: 0.669093 val: 0.665672 test: 0.634183
max validation accuracy : 0.665672 max acc epoch : 1 test accuracy : 0.634183
Counter({1: 3377, 0: 2392, 2: 1631})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  145.30853679776192 Time :  1549
accuracy train: 0.727333 val: 0.686567 test: 0.658917
max validation accuracy : 0.686567 max acc epoch : 2 test accuracy : 0.658917
Counter({0: 3235, 2: 2604, 1: 1561})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  124.00687390565872 Time :  1573
accuracy train: 0.749504 val: 0.677612 test: 0.655207
max validation accuracy : 0.686567 max acc epoch : 2 test accuracy : 0.658917
Counter({2: 2942, 0: 2372, 1: 2086})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  96.7958465218544 Time :  1597
accuracy train: 0.801125 val: 0.707463 test: 0.685382
max validation accuracy : 0.707463 max acc epoch : 4 test accuracy : 0.685382
Counter({2: 2895, 0: 2493, 1: 2012})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.69148060679436 Time :  1621
accuracy train: 0.837525 val: 0.704478 test: 0.693297
max validation accuracy : 0.707463 max acc epoch : 4 test accuracy : 0.685382
Counter({1: 3035, 2: 2438, 0: 1927})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  81.9144795536995 Time :  1645
accuracy train: 0.835208 val: 0.713433 test: 0.694781
max validation accuracy : 0.713433 max acc epoch : 6 test accuracy : 0.694781
Counter({2: 2921, 1: 2912, 0: 1567})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  72.44866845011711 Time :  1669
accuracy train: 0.857048 val: 0.725373 test: 0.705169
max validation accuracy : 0.725373 max acc epoch : 7 test accuracy : 0.705169
Counter({0: 3016, 2: 2830, 1: 1554})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.34806001186371 Time :  1693
accuracy train: 0.867306 val: 0.707463 test: 0.705417
max validation accuracy : 0.725373 max acc epoch : 7 test accuracy : 0.705169
Counter({0: 3090, 1: 2759, 2: 1551})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.32991841435432 Time :  1717
accuracy train: 0.883190 val: 0.713433 test: 0.700470
max validation accuracy : 0.725373 max acc epoch : 7 test accuracy : 0.705169
Counter({2: 3105, 0: 2750, 1: 1545})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.42648892104626 Time :  1741
accuracy train: 0.886499 val: 0.710448 test: 0.712342
max validation accuracy : 0.725373 max acc epoch : 7 test accuracy : 0.705169
Counter({1: 3104, 2: 2752, 0: 1544})

Epoch :  11 loss training:  57.92032015323639 Time :  1765
accuracy train: 0.902052 val: 0.722388 test: 0.712095
max validation accuracy : 0.725373 max acc epoch : 7 test accuracy : 0.705169
Counter({0: 3153, 1: 2704, 2: 1543})

Epoch :  12 loss training:  54.425097554922104 Time :  1789
accuracy train: 0.906353 val: 0.713433 test: 0.715063
max validation accuracy : 0.725373 max acc epoch : 7 test accuracy : 0.705169
Counter({2: 3184, 0: 2669, 1: 1547})

Epoch :  13 loss training:  53.62565802037716 Time :  1813
accuracy train: 0.919921 val: 0.716418 test: 0.715805
max validation accuracy : 0.725373 max acc epoch : 7 test accuracy : 0.705169
Counter({0: 3191, 1: 2657, 2: 1552})

Epoch :  14 loss training:  47.978394225239754 Time :  1837
accuracy train: 0.928524 val: 0.713433 test: 0.717536
max validation accuracy : 0.725373 max acc epoch : 7 test accuracy : 0.705169
Counter({2: 3215, 0: 2627, 1: 1558})

Epoch :  15 loss training:  46.21764673292637 Time :  1860
accuracy train: 0.936135 val: 0.710448 test: 0.714321
max validation accuracy : 0.725373 max acc epoch : 7 test accuracy : 0.705169
Counter({2: 3221, 1: 2629, 0: 1550})

Epoch :  16 loss training:  44.46218878030777 Time :  1883
accuracy train: 0.944739 val: 0.719403 test: 0.713826
max validation accuracy : 0.725373 max acc epoch : 7 test accuracy : 0.705169
Counter({0: 3210, 1: 2639, 2: 1551})

Epoch :  17 loss training:  42.176180593669415 Time :  1908
accuracy train: 0.953342 val: 0.719403 test: 0.716052
max validation accuracy : 0.725373 max acc epoch : 7 test accuracy : 0.705169
Counter({0: 3209, 1: 2640, 2: 1551})

Epoch :  18 loss training:  38.97431065142155 Time :  1933
accuracy train: 0.959629 val: 0.710448 test: 0.719268
max validation accuracy : 0.725373 max acc epoch : 7 test accuracy : 0.705169
Counter({2: 3207, 0: 2643, 1: 1550})

Epoch :  19 loss training:  35.4977455958724 Time :  1955
accuracy train: 0.958306 val: 0.719403 test: 0.719021
max validation accuracy : 0.725373 max acc epoch : 7 test accuracy : 0.705169
Counter({2: 3243, 1: 2611, 0: 1546})

Epoch :  20 loss training:  33.4277978092432 Time :  1980
accuracy train: 0.966248 val: 0.728358 test: 0.719515
max validation accuracy : 0.728358 max acc epoch : 20 test accuracy : 0.719515
Counter({0: 3246, 2: 2610, 1: 1544})

Epoch :  21 loss training:  32.55930722504854 Time :  2004
accuracy train: 0.970218 val: 0.719403 test: 0.720752
max validation accuracy : 0.728358 max acc epoch : 20 test accuracy : 0.719515
Counter({0: 3227, 1: 2620, 2: 1553})

Epoch :  22 loss training:  30.53355943225324 Time :  2028
accuracy train: 0.975513 val: 0.716418 test: 0.716794
max validation accuracy : 0.728358 max acc epoch : 20 test accuracy : 0.719515
Counter({0: 3228, 1: 2626, 2: 1546})

Epoch :  23 loss training:  27.80951786786318 Time :  2052
accuracy train: 0.980146 val: 0.725373 test: 0.722483
max validation accuracy : 0.728358 max acc epoch : 20 test accuracy : 0.719515
Counter({1: 3241, 0: 2626, 2: 1533})

Epoch :  24 loss training:  27.00387315824628 Time :  2093
accuracy train: 0.984778 val: 0.719403 test: 0.722978
max validation accuracy : 0.728358 max acc epoch : 20 test accuracy : 0.719515
Counter({0: 3228, 1: 2638, 2: 1534})

Epoch :  25 loss training:  23.71292745321989 Time :  2120
accuracy train: 0.984778 val: 0.731343 test: 0.722236
max validation accuracy : 0.731343 max acc epoch : 25 test accuracy : 0.722236
Counter({1: 3222, 0: 2644, 2: 1534})

Epoch :  26 loss training:  22.888138934969902 Time :  2143
accuracy train: 0.985771 val: 0.707463 test: 0.720752
max validation accuracy : 0.731343 max acc epoch : 25 test accuracy : 0.722236
Counter({0: 3229, 2: 2635, 1: 1536})

Epoch :  27 loss training:  21.378764234483242 Time :  2166
accuracy train: 0.988749 val: 0.737313 test: 0.720505
max validation accuracy : 0.737313 max acc epoch : 27 test accuracy : 0.720505
Counter({0: 3246, 2: 2634, 1: 1520})

Epoch :  28 loss training:  20.76059554889798 Time :  2192
accuracy train: 0.995367 val: 0.713433 test: 0.720752
max validation accuracy : 0.737313 max acc epoch : 27 test accuracy : 0.720505
Counter({2: 3237, 0: 2644, 1: 1519})

Epoch :  29 loss training:  18.979156378656626 Time :  2216
accuracy train: 0.992389 val: 0.725373 test: 0.720505
max validation accuracy : 0.737313 max acc epoch : 27 test accuracy : 0.720505
Counter({0: 3230, 2: 2649, 1: 1521})

Epoch :  30 loss training:  17.5607203040272 Time :  2242
accuracy train: 0.995367 val: 0.725373 test: 0.717289
max validation accuracy : 0.737313 max acc epoch : 27 test accuracy : 0.720505
Counter({2: 3248, 1: 2629, 0: 1523})

Epoch :  31 loss training:  17.26478660479188 Time :  2267
accuracy train: 0.995367 val: 0.734328 test: 0.721741
max validation accuracy : 0.737313 max acc epoch : 27 test accuracy : 0.720505
Counter({1: 3240, 2: 2635, 0: 1525})

Epoch :  32 loss training:  15.289708126336336 Time :  2291
accuracy train: 0.997684 val: 0.710448 test: 0.720257
max validation accuracy : 0.737313 max acc epoch : 27 test accuracy : 0.720505
Counter({2: 3251, 0: 2636, 1: 1513})

Epoch :  33 loss training:  13.925357157364488 Time :  2315
accuracy train: 0.997353 val: 0.728358 test: 0.723720
max validation accuracy : 0.737313 max acc epoch : 27 test accuracy : 0.720505
Counter({0: 3267, 1: 2621, 2: 1512})

Epoch :  34 loss training:  13.577615981921554 Time :  2343
accuracy train: 0.997684 val: 0.722388 test: 0.724215
max validation accuracy : 0.737313 max acc epoch : 27 test accuracy : 0.720505
Counter({0: 3260, 1: 2633, 2: 1507})

Epoch :  35 loss training:  12.556915301829576 Time :  2367
accuracy train: 0.998345 val: 0.743284 test: 0.718773
max validation accuracy : 0.743284 max acc epoch : 35 test accuracy : 0.718773
Counter({1: 3252, 0: 2651, 2: 1497})

Epoch :  36 loss training:  11.580534677952528 Time :  2391
accuracy train: 0.998676 val: 0.737313 test: 0.720257
max validation accuracy : 0.743284 max acc epoch : 35 test accuracy : 0.718773
Counter({1: 3260, 0: 2646, 2: 1494})

Epoch :  37 loss training:  10.230250485241413 Time :  2419
accuracy train: 0.998015 val: 0.743284 test: 0.723225
max validation accuracy : 0.743284 max acc epoch : 35 test accuracy : 0.718773
Counter({2: 3259, 1: 2659, 0: 1482})

Epoch :  38 loss training:  9.5518914218992 Time :  2447
accuracy train: 0.998676 val: 0.737313 test: 0.722483
max validation accuracy : 0.743284 max acc epoch : 35 test accuracy : 0.718773
Counter({0: 3250, 1: 2671, 2: 1479})

Epoch :  39 loss training:  9.714763099327683 Time :  2475
accuracy train: 0.998676 val: 0.716418 test: 0.722731
max validation accuracy : 0.743284 max acc epoch : 35 test accuracy : 0.718773
Counter({0: 3226, 2: 2699, 1: 1475})

Epoch :  40 loss training:  9.856272798031569 Time :  2502
accuracy train: 1.000000 val: 0.734328 test: 0.721494
max validation accuracy : 0.743284 max acc epoch : 35 test accuracy : 0.718773
Counter({2: 3235, 1: 2689, 0: 1476})

Epoch :  41 loss training:  8.875988340005279 Time :  2528
accuracy train: 0.999669 val: 0.740299 test: 0.730893
max validation accuracy : 0.743284 max acc epoch : 35 test accuracy : 0.718773
Counter({2: 3242, 0: 2690, 1: 1468})

Epoch :  42 loss training:  7.398951282724738 Time :  2556
accuracy train: 0.999669 val: 0.746269 test: 0.723225
max validation accuracy : 0.746269 max acc epoch : 42 test accuracy : 0.723225
Counter({0: 3238, 2: 2700, 1: 1462})

Epoch :  43 loss training:  7.951470545493066 Time :  2582
accuracy train: 0.999669 val: 0.740299 test: 0.725204
max validation accuracy : 0.746269 max acc epoch : 42 test accuracy : 0.723225
Counter({1: 3211, 0: 2733, 2: 1456})

Epoch :  44 loss training:  7.097659792751074 Time :  2628
accuracy train: 0.999669 val: 0.734328 test: 0.718526
max validation accuracy : 0.746269 max acc epoch : 42 test accuracy : 0.723225
Counter({2: 3218, 0: 2733, 1: 1449})

Epoch :  45 loss training:  6.505655989050865 Time :  2659
accuracy train: 0.999669 val: 0.737313 test: 0.722978
max validation accuracy : 0.746269 max acc epoch : 42 test accuracy : 0.723225
Counter({0: 3221, 1: 2739, 2: 1440})

Epoch :  46 loss training:  6.200781795196235 Time :  2684
accuracy train: 0.999669 val: 0.743284 test: 0.719763
max validation accuracy : 0.746269 max acc epoch : 42 test accuracy : 0.723225
Counter({0: 3208, 1: 2752, 2: 1440})

Epoch :  47 loss training:  5.852328773587942 Time :  2708
accuracy train: 0.999669 val: 0.749254 test: 0.725451
max validation accuracy : 0.749254 max acc epoch : 47 test accuracy : 0.725451
Counter({0: 3229, 1: 2734, 2: 1437})

Epoch :  48 loss training:  6.116575049702078 Time :  2732
accuracy train: 0.999669 val: 0.734328 test: 0.720257
max validation accuracy : 0.749254 max acc epoch : 47 test accuracy : 0.725451
Counter({1: 3251, 0: 2714, 2: 1435})

Epoch :  49 loss training:  5.969866366125643 Time :  2755
accuracy train: 1.000000 val: 0.740299 test: 0.724215
max validation accuracy : 0.749254 max acc epoch : 47 test accuracy : 0.725451
Counter({0: 3255, 1: 2712, 2: 1433})

Epoch :  50 loss training:  4.886067213490605 Time :  2780
accuracy train: 1.000000 val: 0.743284 test: 0.719268
max validation accuracy : 0.749254 max acc epoch : 47 test accuracy : 0.725451
Counter({0: 3250, 2: 2712, 1: 1438})

Epoch :  51 loss training:  4.484007768332958 Time :  2804
accuracy train: 1.000000 val: 0.749254 test: 0.721989
max validation accuracy : 0.749254 max acc epoch : 47 test accuracy : 0.725451
Counter({2: 3288, 0: 2677, 1: 1435})

Epoch :  52 loss training:  4.855361002031714 Time :  2835
accuracy train: 1.000000 val: 0.746269 test: 0.723225
max validation accuracy : 0.749254 max acc epoch : 47 test accuracy : 0.725451
Counter({2: 3270, 1: 2698, 0: 1432})

Epoch :  53 loss training:  4.232576326117851 Time :  2861
accuracy train: 1.000000 val: 0.725373 test: 0.716300
max validation accuracy : 0.749254 max acc epoch : 47 test accuracy : 0.725451
Counter({2: 3254, 1: 2718, 0: 1428})

Epoch :  54 loss training:  4.504102195380256 Time :  2886
accuracy train: 0.999669 val: 0.749254 test: 0.718526
max validation accuracy : 0.749254 max acc epoch : 47 test accuracy : 0.725451
Counter({2: 3244, 0: 2730, 1: 1426})

Epoch :  55 loss training:  4.280848080758005 Time :  2914
accuracy train: 0.999669 val: 0.728358 test: 0.718031
max validation accuracy : 0.749254 max acc epoch : 47 test accuracy : 0.725451
Counter({2: 3218, 1: 2761, 0: 1421})

Epoch :  56 loss training:  3.5429813996888697 Time :  2939
accuracy train: 1.000000 val: 0.734328 test: 0.717042
max validation accuracy : 0.749254 max acc epoch : 47 test accuracy : 0.725451
Counter({1: 3211, 2: 2768, 0: 1421})

Epoch :  57 loss training:  3.503361276118085 Time :  2966
accuracy train: 1.000000 val: 0.734328 test: 0.720010
max validation accuracy : 0.749254 max acc epoch : 47 test accuracy : 0.725451
Counter({0: 3225, 1: 2762, 2: 1413})

Epoch :  58 loss training:  3.2016978235915303 Time :  2991
accuracy train: 1.000000 val: 0.731343 test: 0.718526
max validation accuracy : 0.749254 max acc epoch : 47 test accuracy : 0.725451
Counter({0: 3218, 1: 2769, 2: 1413})

Epoch :  59 loss training:  4.099945199443027 Time :  3018
accuracy train: 1.000000 val: 0.740299 test: 0.718773
max validation accuracy : 0.749254 max acc epoch : 47 test accuracy : 0.725451
Counter({0: 3220, 1: 2777, 2: 1403})

Epoch :  60 loss training:  3.458601381862536 Time :  3045
accuracy train: 1.000000 val: 0.752239 test: 0.723473
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({0: 3225, 2: 2773, 1: 1402})

Epoch :  61 loss training:  3.337757576489821 Time :  3070
accuracy train: 1.000000 val: 0.752239 test: 0.716300
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({2: 3224, 0: 2774, 1: 1402})

Epoch :  62 loss training:  2.826201437972486 Time :  3095
accuracy train: 1.000000 val: 0.743284 test: 0.723473
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({0: 3215, 1: 2783, 2: 1402})

Epoch :  63 loss training:  2.7005729742813855 Time :  3121
accuracy train: 1.000000 val: 0.752239 test: 0.719268
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({0: 3227, 1: 2776, 2: 1397})

Epoch :  64 loss training:  2.955723274964839 Time :  3148
accuracy train: 1.000000 val: 0.737313 test: 0.720505
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({0: 3223, 1: 2788, 2: 1389})

Epoch :  65 loss training:  2.5664593225810677 Time :  3178
accuracy train: 1.000000 val: 0.740299 test: 0.723225
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({0: 3212, 2: 2807, 1: 1381})

Epoch :  66 loss training:  2.9062279663048685 Time :  3220
accuracy train: 1.000000 val: 0.728358 test: 0.718279
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({0: 3206, 2: 2812, 1: 1382})

Epoch :  67 loss training:  2.3474651330616325 Time :  3248
accuracy train: 1.000000 val: 0.743284 test: 0.719268
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({0: 3214, 2: 2807, 1: 1379})

Epoch :  68 loss training:  2.5851693756412715 Time :  3276
accuracy train: 1.000000 val: 0.737313 test: 0.720257
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({0: 3212, 1: 2813, 2: 1375})

Epoch :  69 loss training:  2.6152085908688605 Time :  3303
accuracy train: 1.000000 val: 0.740299 test: 0.720999
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({0: 3208, 1: 2819, 2: 1373})

Epoch :  70 loss training:  2.155249704606831 Time :  3330
accuracy train: 1.000000 val: 0.734328 test: 0.720752
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({0: 3199, 1: 2830, 2: 1371})

Epoch :  71 loss training:  1.774130605859682 Time :  3356
accuracy train: 1.000000 val: 0.737313 test: 0.720010
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({1: 3204, 0: 2826, 2: 1370})

Epoch :  72 loss training:  1.5878374644671567 Time :  3384
accuracy train: 1.000000 val: 0.746269 test: 0.717042
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({2: 3220, 1: 2811, 0: 1369})

Epoch :  73 loss training:  2.1949489016551524 Time :  3410
accuracy train: 1.000000 val: 0.734328 test: 0.717289
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({2: 3233, 1: 2797, 0: 1370})

Epoch :  74 loss training:  2.3876675206702203 Time :  3438
accuracy train: 1.000000 val: 0.737313 test: 0.718773
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({2: 3242, 0: 2789, 1: 1369})

Epoch :  75 loss training:  1.8250387150328606 Time :  3463
accuracy train: 1.000000 val: 0.743284 test: 0.722483
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({2: 3235, 0: 2795, 1: 1370})

Epoch :  76 loss training:  2.3148989307810552 Time :  3489
accuracy train: 0.999338 val: 0.731343 test: 0.715310
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({0: 3244, 1: 2784, 2: 1372})

Epoch :  77 loss training:  2.258335094433278 Time :  3513
accuracy train: 1.000000 val: 0.746269 test: 0.717536
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({0: 3239, 1: 2783, 2: 1378})

Epoch :  78 loss training:  1.908236449409742 Time :  3539
accuracy train: 1.000000 val: 0.743284 test: 0.720010
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({0: 3255, 2: 2775, 1: 1370})

Epoch :  79 loss training:  1.7495774748385884 Time :  3565
accuracy train: 1.000000 val: 0.749254 test: 0.717289
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({1: 3248, 0: 2779, 2: 1373})

Epoch :  80 loss training:  1.3866114243573975 Time :  3591
accuracy train: 1.000000 val: 0.746269 test: 0.714321
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({0: 3200, 2: 2828, 1: 1372})

Epoch :  81 loss training:  1.6400837019609753 Time :  3618
accuracy train: 1.000000 val: 0.740299 test: 0.720999
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({2: 3214, 0: 2813, 1: 1373})

Epoch :  82 loss training:  1.713568514387589 Time :  3642
accuracy train: 1.000000 val: 0.725373 test: 0.707395
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({0: 3215, 2: 2815, 1: 1370})

Epoch :  83 loss training:  1.7431548794847913 Time :  3667
accuracy train: 1.000000 val: 0.734328 test: 0.718773
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({2: 3209, 0: 2825, 1: 1366})

Epoch :  84 loss training:  1.5272898182156496 Time :  3693
accuracy train: 1.000000 val: 0.734328 test: 0.720257
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({2: 3202, 0: 2830, 1: 1368})

Epoch :  85 loss training:  1.2942349562072195 Time :  3722
accuracy train: 1.000000 val: 0.746269 test: 0.724215
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({1: 3197, 0: 2836, 2: 1367})

Epoch :  86 loss training:  2.0483817996864673 Time :  3750
accuracy train: 1.000000 val: 0.740299 test: 0.717289
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({1: 3263, 0: 2773, 2: 1364})

Epoch :  87 loss training:  1.555402613710612 Time :  3793
accuracy train: 1.000000 val: 0.722388 test: 0.715063
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({2: 3274, 1: 2763, 0: 1363})

Epoch :  88 loss training:  1.5987109790439717 Time :  3838
accuracy train: 1.000000 val: 0.731343 test: 0.707395
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({0: 3286, 2: 2763, 1: 1351})

Epoch :  89 loss training:  0.8975046959822066 Time :  3866
accuracy train: 1.000000 val: 0.725373 test: 0.717289
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({0: 3293, 1: 2755, 2: 1352})

Epoch :  90 loss training:  1.3077524421096314 Time :  3894
accuracy train: 1.000000 val: 0.731343 test: 0.716794
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({0: 3295, 1: 2754, 2: 1351})

Epoch :  91 loss training:  1.301815893733874 Time :  3922
accuracy train: 1.000000 val: 0.740299 test: 0.715805
max validation accuracy : 0.752239 max acc epoch : 60 test accuracy : 0.723473
Counter({0: 3295, 2: 2760, 1: 1345})

========================================================================================================================================================================================================
best acc epoch :  60
validation accuracy :  0.7522388059701492
test accuracy :  0.7234726688102894
last test_accuracy :  0.7158050952263171
second best val :  0.7492537313432835
second best test :  0.725451397477121
max gap 13
========================================================================================================================================================================================================

(4043, 1400)
itr : 2
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=23, weight_decay=0)
device :  cuda:0
Counter({2: 2587, 0: 2555, 1: 2258})

Epoch :  1 loss training:  212.05907660722733 Time :  4030
accuracy train: 0.665122 val: 0.653731 test: 0.634183
max validation accuracy : 0.653731 max acc epoch : 1 test accuracy : 0.634183
Counter({2: 3231, 0: 2557, 1: 1612})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  145.37192729115486 Time :  4057
accuracy train: 0.725347 val: 0.665672 test: 0.651744
max validation accuracy : 0.665672 max acc epoch : 2 test accuracy : 0.651744
Counter({2: 3256, 1: 2615, 0: 1529})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  124.61903482675552 Time :  4084
accuracy train: 0.749173 val: 0.677612 test: 0.657680
max validation accuracy : 0.677612 max acc epoch : 3 test accuracy : 0.657680
Counter({1: 3056, 0: 2248, 2: 2096})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  97.08852115273476 Time :  4113
accuracy train: 0.799471 val: 0.713433 test: 0.694039
max validation accuracy : 0.713433 max acc epoch : 4 test accuracy : 0.694039
Counter({2: 3034, 0: 2392, 1: 1974})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  89.23463800549507 Time :  4138
accuracy train: 0.831238 val: 0.722388 test: 0.691566
max validation accuracy : 0.722388 max acc epoch : 5 test accuracy : 0.691566
Counter({2: 3090, 0: 2419, 1: 1891})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  81.93168157339096 Time :  4164
accuracy train: 0.832561 val: 0.719403 test: 0.697255
max validation accuracy : 0.722388 max acc epoch : 5 test accuracy : 0.691566
Counter({2: 3038, 1: 2836, 0: 1526})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  72.75820362567902 Time :  4191
accuracy train: 0.852747 val: 0.707463 test: 0.699728
max validation accuracy : 0.722388 max acc epoch : 5 test accuracy : 0.691566
Counter({0: 3056, 1: 2820, 2: 1524})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  69.12535464763641 Time :  4218
accuracy train: 0.856056 val: 0.731343 test: 0.701459
max validation accuracy : 0.731343 max acc epoch : 8 test accuracy : 0.701459
Counter({2: 3181, 0: 2702, 1: 1517})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.09429848194122 Time :  4244
accuracy train: 0.881866 val: 0.725373 test: 0.700470
max validation accuracy : 0.731343 max acc epoch : 8 test accuracy : 0.701459
Counter({0: 3211, 1: 2673, 2: 1516})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.354313626885414 Time :  4273
accuracy train: 0.884183 val: 0.719403 test: 0.711600
max validation accuracy : 0.731343 max acc epoch : 8 test accuracy : 0.701459
Counter({0: 3201, 2: 2687, 1: 1512})

Epoch :  11 loss training:  58.280332908034325 Time :  4301
accuracy train: 0.903044 val: 0.728358 test: 0.711600
max validation accuracy : 0.731343 max acc epoch : 8 test accuracy : 0.701459
Counter({0: 3201, 1: 2687, 2: 1512})

Epoch :  12 loss training:  54.85679616034031 Time :  4331
accuracy train: 0.903375 val: 0.731343 test: 0.718031
max validation accuracy : 0.731343 max acc epoch : 8 test accuracy : 0.701459
Counter({0: 3207, 1: 2690, 2: 1503})

Epoch :  13 loss training:  53.714833959937096 Time :  4358
accuracy train: 0.916612 val: 0.725373 test: 0.717042
max validation accuracy : 0.731343 max acc epoch : 8 test accuracy : 0.701459
Counter({1: 3217, 2: 2685, 0: 1498})

Epoch :  14 loss training:  48.61247701942921 Time :  4385
accuracy train: 0.926539 val: 0.719403 test: 0.717042
max validation accuracy : 0.731343 max acc epoch : 8 test accuracy : 0.701459
Counter({1: 3238, 2: 2661, 0: 1501})

Epoch :  15 loss training:  46.56690916419029 Time :  4413
accuracy train: 0.933819 val: 0.716418 test: 0.715805
max validation accuracy : 0.731343 max acc epoch : 8 test accuracy : 0.701459
Counter({0: 3242, 2: 2662, 1: 1496})

Epoch :  16 loss training:  44.69340495765209 Time :  4439
accuracy train: 0.942422 val: 0.722388 test: 0.714074
max validation accuracy : 0.731343 max acc epoch : 8 test accuracy : 0.701459
Counter({1: 3241, 0: 2668, 2: 1491})

Epoch :  17 loss training:  42.58356440067291 Time :  4467
accuracy train: 0.955989 val: 0.731343 test: 0.714568
max validation accuracy : 0.731343 max acc epoch : 8 test accuracy : 0.701459
Counter({0: 3239, 1: 2667, 2: 1494})

Epoch :  18 loss training:  38.95140764117241 Time :  4512
accuracy train: 0.958637 val: 0.707463 test: 0.720010
max validation accuracy : 0.731343 max acc epoch : 8 test accuracy : 0.701459
Counter({0: 3243, 1: 2667, 2: 1490})

Epoch :  19 loss training:  35.66538105905056 Time :  4536
accuracy train: 0.958637 val: 0.719403 test: 0.717289
max validation accuracy : 0.731343 max acc epoch : 8 test accuracy : 0.701459
Counter({0: 3264, 2: 2644, 1: 1492})

Epoch :  20 loss training:  33.47025368362665 Time :  4566
accuracy train: 0.963931 val: 0.734328 test: 0.719021
max validation accuracy : 0.734328 max acc epoch : 20 test accuracy : 0.719021
Counter({1: 3261, 2: 2645, 0: 1494})

Epoch :  21 loss training:  32.76326320320368 Time :  4594
accuracy train: 0.967902 val: 0.728358 test: 0.720752
max validation accuracy : 0.734328 max acc epoch : 20 test accuracy : 0.719021
Counter({0: 3267, 1: 2652, 2: 1481})

Epoch :  22 loss training:  30.63429755717516 Time :  4621
accuracy train: 0.973858 val: 0.716418 test: 0.714568
max validation accuracy : 0.734328 max acc epoch : 20 test accuracy : 0.719021
Counter({0: 3261, 2: 2659, 1: 1480})

Epoch :  23 loss training:  28.322779200971127 Time :  4650
accuracy train: 0.978822 val: 0.731343 test: 0.721494
max validation accuracy : 0.734328 max acc epoch : 20 test accuracy : 0.719021
Counter({0: 3277, 2: 2671, 1: 1452})

Epoch :  24 loss training:  26.85721419751644 Time :  4676
accuracy train: 0.982131 val: 0.737313 test: 0.722483
max validation accuracy : 0.737313 max acc epoch : 24 test accuracy : 0.722483
Counter({1: 3260, 0: 2683, 2: 1457})

Epoch :  25 loss training:  24.061956394463778 Time :  4704
accuracy train: 0.985771 val: 0.749254 test: 0.721989
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({0: 3260, 1: 2675, 2: 1465})

Epoch :  26 loss training:  23.307154595851898 Time :  4729
accuracy train: 0.982131 val: 0.716418 test: 0.719268
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({0: 3262, 2: 2670, 1: 1468})

Epoch :  27 loss training:  21.7536457516253 Time :  4754
accuracy train: 0.988087 val: 0.734328 test: 0.717536
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({0: 3289, 1: 2645, 2: 1466})

Epoch :  28 loss training:  21.110290460288525 Time :  4779
accuracy train: 0.993382 val: 0.716418 test: 0.716547
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({2: 3229, 0: 2707, 1: 1464})

Epoch :  29 loss training:  19.11058607324958 Time :  4805
accuracy train: 0.992720 val: 0.728358 test: 0.718526
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({1: 3234, 0: 2700, 2: 1466})

Epoch :  30 loss training:  17.964897707104683 Time :  4834
accuracy train: 0.994044 val: 0.740299 test: 0.717536
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({1: 3249, 0: 2683, 2: 1468})

Epoch :  31 loss training:  17.294122444465756 Time :  4862
accuracy train: 0.994375 val: 0.746269 test: 0.721989
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({0: 3259, 1: 2673, 2: 1468})

Epoch :  32 loss training:  15.279370047152042 Time :  4890
accuracy train: 0.996360 val: 0.734328 test: 0.719268
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({0: 3262, 2: 2673, 1: 1465})

Epoch :  33 loss training:  13.957857340574265 Time :  4917
accuracy train: 0.996691 val: 0.734328 test: 0.722483
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({1: 3273, 0: 2662, 2: 1465})

Epoch :  34 loss training:  13.719804102554917 Time :  4945
accuracy train: 0.997684 val: 0.734328 test: 0.722236
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({0: 3276, 1: 2661, 2: 1463})

Epoch :  35 loss training:  12.47371600754559 Time :  4973
accuracy train: 0.998015 val: 0.743284 test: 0.717289
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({0: 3260, 2: 2680, 1: 1460})

Epoch :  36 loss training:  11.669754512608051 Time :  5001
accuracy train: 0.998676 val: 0.749254 test: 0.722483
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({0: 3260, 1: 2683, 2: 1457})

Epoch :  37 loss training:  10.032247133553028 Time :  5026
accuracy train: 0.997353 val: 0.749254 test: 0.720999
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({1: 3263, 2: 2688, 0: 1449})

Epoch :  38 loss training:  10.089379947632551 Time :  5054
accuracy train: 0.998676 val: 0.743284 test: 0.721494
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({2: 3249, 1: 2706, 0: 1445})

Epoch :  39 loss training:  9.80092644970864 Time :  5096
accuracy train: 0.999007 val: 0.731343 test: 0.721989
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({2: 3232, 1: 2726, 0: 1442})

Epoch :  40 loss training:  10.024051203392446 Time :  5136
accuracy train: 1.000000 val: 0.740299 test: 0.720257
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({0: 3230, 1: 2729, 2: 1441})

Epoch :  41 loss training:  9.033357355743647 Time :  5161
accuracy train: 1.000000 val: 0.728358 test: 0.724709
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({0: 3246, 1: 2721, 2: 1433})

Epoch :  42 loss training:  7.816305883228779 Time :  5186
accuracy train: 0.999669 val: 0.737313 test: 0.722483
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({0: 3252, 1: 2720, 2: 1428})

Epoch :  43 loss training:  7.999213567003608 Time :  5212
accuracy train: 0.999669 val: 0.740299 test: 0.722483
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({0: 3224, 1: 2750, 2: 1426})

Epoch :  44 loss training:  6.912981112487614 Time :  5239
accuracy train: 1.000000 val: 0.743284 test: 0.721247
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({0: 3238, 1: 2734, 2: 1428})

Epoch :  45 loss training:  6.1333958259783685 Time :  5264
accuracy train: 0.999669 val: 0.731343 test: 0.720010
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({2: 3231, 0: 2744, 1: 1425})

Epoch :  46 loss training:  5.871830204036087 Time :  5290
accuracy train: 0.999669 val: 0.746269 test: 0.719763
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({0: 3203, 1: 2772, 2: 1425})

Epoch :  47 loss training:  5.723829924594611 Time :  5320
accuracy train: 0.999669 val: 0.740299 test: 0.717042
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({2: 3210, 0: 2767, 1: 1423})

Epoch :  48 loss training:  5.750731448177248 Time :  5346
accuracy train: 0.999669 val: 0.749254 test: 0.712342
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({0: 3220, 1: 2759, 2: 1421})

Epoch :  49 loss training:  5.473867095075548 Time :  5374
accuracy train: 1.000000 val: 0.734328 test: 0.716794
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({0: 3224, 2: 2756, 1: 1420})

Epoch :  50 loss training:  5.400222270749509 Time :  5402
accuracy train: 0.999669 val: 0.725373 test: 0.714816
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({2: 3224, 0: 2756, 1: 1420})

Epoch :  51 loss training:  5.130475852172822 Time :  5430
accuracy train: 0.999669 val: 0.716418 test: 0.718773
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({0: 3210, 1: 2769, 2: 1421})

Epoch :  52 loss training:  4.792988573201001 Time :  5458
accuracy train: 1.000000 val: 0.734328 test: 0.722731
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({2: 3185, 1: 2794, 0: 1421})

Epoch :  53 loss training:  5.332882582210004 Time :  5486
accuracy train: 1.000000 val: 0.740299 test: 0.719268
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({1: 3203, 2: 2776, 0: 1421})

Epoch :  54 loss training:  4.631444346159697 Time :  5513
accuracy train: 0.999669 val: 0.740299 test: 0.718526
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({0: 3220, 2: 2764, 1: 1416})

Epoch :  55 loss training:  3.9325147354975343 Time :  5540
accuracy train: 0.999669 val: 0.746269 test: 0.720010
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({0: 3218, 2: 2762, 1: 1420})

Epoch :  56 loss training:  4.026519190985709 Time :  5565
accuracy train: 1.000000 val: 0.740299 test: 0.723720
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721989
Counter({0: 3205, 2: 2776, 1: 1419})

========================================================================================================================================================================================================
best acc epoch :  25
validation accuracy :  0.7492537313432835
test accuracy :  0.7219886223101657
last test_accuracy :  0.7237200098936434
second best val :  0.746268656716418
second best test :  0.7219886223101657
max gap 12
========================================================================================================================================================================================================

(4043, 1400)
itr : 3
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=23, weight_decay=0)
device :  cuda:0
Counter({2: 2587, 0: 2555, 1: 2258})

Epoch :  1 loss training:  212.07243293523788 Time :  5692
accuracy train: 0.663468 val: 0.644776 test: 0.635667
max validation accuracy : 0.644776 max acc epoch : 1 test accuracy : 0.635667
Counter({2: 3375, 1: 2438, 0: 1587})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  145.58820846676826 Time :  5721
accuracy train: 0.727664 val: 0.680597 test: 0.652486
max validation accuracy : 0.680597 max acc epoch : 2 test accuracy : 0.652486
Counter({0: 3228, 2: 2658, 1: 1514})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  124.70916628837585 Time :  5747
accuracy train: 0.751489 val: 0.686567 test: 0.660153
max validation accuracy : 0.686567 max acc epoch : 3 test accuracy : 0.660153
Counter({2: 2840, 0: 2288, 1: 2272})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.483532756567 Time :  5770
accuracy train: 0.795831 val: 0.704478 test: 0.691813
max validation accuracy : 0.704478 max acc epoch : 4 test accuracy : 0.691813
Counter({1: 2828, 0: 2435, 2: 2137})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.85477903485298 Time :  5796
accuracy train: 0.815023 val: 0.713433 test: 0.682909
max validation accuracy : 0.713433 max acc epoch : 5 test accuracy : 0.682909
Counter({0: 2868, 1: 2411, 2: 2121})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  81.52514290809631 Time :  5824
accuracy train: 0.837856 val: 0.710448 test: 0.691566
max validation accuracy : 0.713433 max acc epoch : 5 test accuracy : 0.682909
Counter({0: 2909, 2: 2482, 1: 2009})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  72.71988722681999 Time :  5849
accuracy train: 0.853408 val: 0.722388 test: 0.703933
max validation accuracy : 0.722388 max acc epoch : 7 test accuracy : 0.703933
Counter({0: 2906, 1: 2490, 2: 2004})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.86711061000824 Time :  5874
accuracy train: 0.864328 val: 0.716418 test: 0.705664
max validation accuracy : 0.722388 max acc epoch : 7 test accuracy : 0.703933
Counter({2: 2907, 1: 2533, 0: 1960})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.59858706593513 Time :  5898
accuracy train: 0.878888 val: 0.719403 test: 0.700965
max validation accuracy : 0.722388 max acc epoch : 7 test accuracy : 0.703933
Counter({2: 2934, 1: 2546, 0: 1920})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.01198174059391 Time :  5921
accuracy train: 0.887161 val: 0.716418 test: 0.712342
max validation accuracy : 0.722388 max acc epoch : 7 test accuracy : 0.703933
Counter({2: 2936, 0: 2556, 1: 1908})

Epoch :  11 loss training:  56.96088020503521 Time :  5948
accuracy train: 0.905361 val: 0.704478 test: 0.712837
max validation accuracy : 0.722388 max acc epoch : 7 test accuracy : 0.703933
Counter({2: 2946, 1: 2559, 0: 1895})

Epoch :  12 loss training:  55.84141765534878 Time :  5973
accuracy train: 0.911648 val: 0.731343 test: 0.718031
max validation accuracy : 0.731343 max acc epoch : 12 test accuracy : 0.718031
Counter({0: 2963, 2: 2549, 1: 1888})

Epoch :  13 loss training:  53.29957030713558 Time :  6000
accuracy train: 0.912641 val: 0.698507 test: 0.716547
max validation accuracy : 0.731343 max acc epoch : 12 test accuracy : 0.718031
Counter({2: 2964, 0: 2556, 1: 1880})

Epoch :  14 loss training:  48.98564149439335 Time :  6026
accuracy train: 0.925877 val: 0.716418 test: 0.712837
max validation accuracy : 0.731343 max acc epoch : 12 test accuracy : 0.718031
Counter({0: 2964, 2: 2580, 1: 1856})

Epoch :  15 loss training:  46.60223409533501 Time :  6051
accuracy train: 0.930510 val: 0.710448 test: 0.717536
max validation accuracy : 0.731343 max acc epoch : 12 test accuracy : 0.718031
Counter({0: 2955, 1: 2585, 2: 1860})

Epoch :  16 loss training:  45.01377649605274 Time :  6077
accuracy train: 0.938120 val: 0.716418 test: 0.712837
max validation accuracy : 0.731343 max acc epoch : 12 test accuracy : 0.718031
Counter({0: 2955, 1: 2591, 2: 1854})

Epoch :  17 loss training:  43.02047149091959 Time :  6102
accuracy train: 0.950364 val: 0.719403 test: 0.717784
max validation accuracy : 0.731343 max acc epoch : 12 test accuracy : 0.718031
Counter({1: 2951, 0: 2592, 2: 1857})

Epoch :  18 loss training:  38.826454661786556 Time :  6129
accuracy train: 0.957644 val: 0.713433 test: 0.717784
max validation accuracy : 0.731343 max acc epoch : 12 test accuracy : 0.718031
Counter({0: 2940, 1: 2603, 2: 1857})

Epoch :  19 loss training:  35.79608664661646 Time :  6152
accuracy train: 0.959629 val: 0.704478 test: 0.715805
max validation accuracy : 0.731343 max acc epoch : 12 test accuracy : 0.718031
Counter({0: 2941, 1: 2608, 2: 1851})

Epoch :  20 loss training:  34.1451176032424 Time :  6177
accuracy train: 0.962938 val: 0.737313 test: 0.722483
max validation accuracy : 0.737313 max acc epoch : 20 test accuracy : 0.722483
Counter({0: 2960, 2: 2587, 1: 1853})

Epoch :  21 loss training:  32.41446979343891 Time :  6202
accuracy train: 0.969557 val: 0.734328 test: 0.721741
max validation accuracy : 0.737313 max acc epoch : 20 test accuracy : 0.722483
Counter({2: 2959, 1: 2591, 0: 1850})

Epoch :  22 loss training:  31.194187931716442 Time :  6224
accuracy train: 0.971211 val: 0.725373 test: 0.717042
max validation accuracy : 0.737313 max acc epoch : 20 test accuracy : 0.722483
Counter({0: 2951, 1: 2598, 2: 1851})

Epoch :  23 loss training:  28.667625170201063 Time :  6251
accuracy train: 0.976506 val: 0.734328 test: 0.719763
max validation accuracy : 0.737313 max acc epoch : 20 test accuracy : 0.722483
Counter({0: 2951, 1: 2589, 2: 1860})

Epoch :  24 loss training:  28.128768630325794 Time :  6275
accuracy train: 0.980146 val: 0.722388 test: 0.718526
max validation accuracy : 0.737313 max acc epoch : 20 test accuracy : 0.722483
Counter({2: 2953, 0: 2588, 1: 1859})

Epoch :  25 loss training:  25.434255711734295 Time :  6301
accuracy train: 0.985771 val: 0.749254 test: 0.721247
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({0: 2950, 2: 2598, 1: 1852})

Epoch :  26 loss training:  23.29085560142994 Time :  6327
accuracy train: 0.986764 val: 0.713433 test: 0.720257
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({2: 2947, 1: 2589, 0: 1864})

Epoch :  27 loss training:  21.262405138462782 Time :  6351
accuracy train: 0.990073 val: 0.731343 test: 0.717042
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({1: 2948, 0: 2590, 2: 1862})

Epoch :  28 loss training:  20.832126513123512 Time :  6375
accuracy train: 0.993713 val: 0.722388 test: 0.717536
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({2: 2955, 0: 2588, 1: 1857})

Epoch :  29 loss training:  18.39425233192742 Time :  6401
accuracy train: 0.993382 val: 0.740299 test: 0.720257
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({1: 2956, 2: 2590, 0: 1854})

Epoch :  30 loss training:  18.203254405409098 Time :  6426
accuracy train: 0.995698 val: 0.734328 test: 0.720257
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({1: 2915, 0: 2597, 2: 1888})

Epoch :  31 loss training:  17.42643655091524 Time :  6448
accuracy train: 0.995367 val: 0.743284 test: 0.718773
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({2: 2910, 1: 2604, 0: 1886})

Epoch :  32 loss training:  15.591539788991213 Time :  6472
accuracy train: 0.996029 val: 0.728358 test: 0.717784
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({0: 2918, 2: 2610, 1: 1872})

Epoch :  33 loss training:  14.646674264222383 Time :  6498
accuracy train: 0.997022 val: 0.737313 test: 0.721989
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({0: 2927, 2: 2602, 1: 1871})

Epoch :  34 loss training:  13.69884626660496 Time :  6523
accuracy train: 0.997022 val: 0.737313 test: 0.724957
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({0: 2927, 1: 2608, 2: 1865})

Epoch :  35 loss training:  13.120851741172373 Time :  6546
accuracy train: 0.997684 val: 0.731343 test: 0.720010
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({2: 2924, 0: 2595, 1: 1881})

Epoch :  36 loss training:  10.71090753749013 Time :  6574
accuracy train: 0.998676 val: 0.740299 test: 0.718526
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({1: 2930, 2: 2591, 0: 1879})

Epoch :  37 loss training:  10.363841572776437 Time :  6599
accuracy train: 0.998015 val: 0.737313 test: 0.721494
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({0: 2928, 2: 2582, 1: 1890})

Epoch :  38 loss training:  9.8210812760517 Time :  6625
accuracy train: 0.999338 val: 0.728358 test: 0.722731
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({1: 2931, 0: 2575, 2: 1894})

Epoch :  39 loss training:  10.057255916297436 Time :  6651
accuracy train: 0.999338 val: 0.725373 test: 0.711106
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({1: 2906, 2: 2606, 0: 1888})

Epoch :  40 loss training:  9.558231266215444 Time :  6676
accuracy train: 0.999669 val: 0.731343 test: 0.715310
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({1: 2908, 2: 2597, 0: 1895})

Epoch :  41 loss training:  8.297571262344718 Time :  6703
accuracy train: 1.000000 val: 0.743284 test: 0.721494
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({0: 2905, 2: 2596, 1: 1899})

Epoch :  42 loss training:  7.943259201012552 Time :  6731
accuracy train: 0.999338 val: 0.731343 test: 0.719515
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({1: 2907, 0: 2580, 2: 1913})

Epoch :  43 loss training:  7.850024436600506 Time :  6756
accuracy train: 1.000000 val: 0.713433 test: 0.720257
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({1: 2901, 2: 2576, 0: 1923})

Epoch :  44 loss training:  7.635144314728677 Time :  6784
accuracy train: 1.000000 val: 0.719403 test: 0.721741
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({1: 2913, 0: 2571, 2: 1916})

Epoch :  45 loss training:  6.209736604243517 Time :  6811
accuracy train: 1.000000 val: 0.734328 test: 0.718279
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({2: 2906, 1: 2580, 0: 1914})

Epoch :  46 loss training:  6.195140805095434 Time :  6836
accuracy train: 0.999669 val: 0.722388 test: 0.712342
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({1: 2906, 0: 2587, 2: 1907})

Epoch :  47 loss training:  6.665711454581469 Time :  6862
accuracy train: 1.000000 val: 0.731343 test: 0.713332
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({1: 2920, 0: 2580, 2: 1900})

Epoch :  48 loss training:  5.836716221645474 Time :  6888
accuracy train: 1.000000 val: 0.725373 test: 0.714321
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({0: 2916, 2: 2579, 1: 1905})

Epoch :  49 loss training:  5.9326593754813075 Time :  6914
accuracy train: 1.000000 val: 0.725373 test: 0.714074
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({1: 2921, 0: 2574, 2: 1905})

Epoch :  50 loss training:  4.91280761687085 Time :  6940
accuracy train: 1.000000 val: 0.731343 test: 0.716794
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({1: 2927, 0: 2577, 2: 1896})

Epoch :  51 loss training:  4.301774990744889 Time :  6967
accuracy train: 1.000000 val: 0.722388 test: 0.714816
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({1: 2922, 2: 2578, 0: 1900})

Epoch :  52 loss training:  4.246326205320656 Time :  6992
accuracy train: 0.999669 val: 0.728358 test: 0.719515
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({1: 2918, 2: 2582, 0: 1900})

Epoch :  53 loss training:  4.899742198642343 Time :  7017
accuracy train: 1.000000 val: 0.734328 test: 0.717289
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({2: 2907, 0: 2604, 1: 1889})

Epoch :  54 loss training:  4.542492505628616 Time :  7043
accuracy train: 1.000000 val: 0.728358 test: 0.719268
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({0: 2919, 1: 2589, 2: 1892})

Epoch :  55 loss training:  4.051547668641433 Time :  7069
accuracy train: 1.000000 val: 0.728358 test: 0.719763
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({2: 2925, 0: 2555, 1: 1920})

Epoch :  56 loss training:  3.6564438787754625 Time :  7099
accuracy train: 1.000000 val: 0.734328 test: 0.715805
max validation accuracy : 0.749254 max acc epoch : 25 test accuracy : 0.721247
Counter({0: 2924, 1: 2565, 2: 1911})

========================================================================================================================================================================================================
best acc epoch :  25
validation accuracy :  0.7492537313432835
test accuracy :  0.7212465990601039
last test_accuracy :  0.7158050952263171
second best val :  0.7432835820895523
second best test :  0.7212465990601039
max gap 8
========================================================================================================================================================================================================

(4043, 1400)
itr : 4
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=23, weight_decay=0)
device :  cuda:0
Counter({2: 2587, 0: 2555, 1: 2258})

Epoch :  1 loss training:  212.0919861793518 Time :  7208
accuracy train: 0.666446 val: 0.650746 test: 0.634183
max validation accuracy : 0.650746 max acc epoch : 1 test accuracy : 0.634183
Counter({2: 2980, 1: 2801, 0: 1619})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  144.73413115739822 Time :  7236
accuracy train: 0.732958 val: 0.668657 test: 0.658422
max validation accuracy : 0.668657 max acc epoch : 2 test accuracy : 0.658422
Counter({1: 3175, 0: 2737, 2: 1488})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  125.95352327823639 Time :  7262
accuracy train: 0.759431 val: 0.713433 test: 0.663863
max validation accuracy : 0.713433 max acc epoch : 3 test accuracy : 0.663863
Counter({2: 3205, 1: 2769, 0: 1426})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.23175007104874 Time :  7288
accuracy train: 0.799471 val: 0.713433 test: 0.688350
max validation accuracy : 0.713433 max acc epoch : 3 test accuracy : 0.663863
Counter({2: 3296, 1: 2673, 0: 1431})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  89.84640130400658 Time :  7314
accuracy train: 0.831899 val: 0.686567 test: 0.688103
max validation accuracy : 0.713433 max acc epoch : 3 test accuracy : 0.663863
Counter({0: 3278, 1: 2711, 2: 1411})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  83.08778616786003 Time :  7340
accuracy train: 0.833885 val: 0.701493 test: 0.692802
max validation accuracy : 0.713433 max acc epoch : 3 test accuracy : 0.663863
Counter({1: 3296, 0: 2668, 2: 1436})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  72.671631783247 Time :  7366
accuracy train: 0.851092 val: 0.710448 test: 0.706406
max validation accuracy : 0.713433 max acc epoch : 3 test accuracy : 0.663863
Counter({0: 3261, 1: 2701, 2: 1438})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  69.6159479022026 Time :  7394
accuracy train: 0.869954 val: 0.707463 test: 0.706159
max validation accuracy : 0.713433 max acc epoch : 3 test accuracy : 0.663863
Counter({0: 3299, 1: 2660, 2: 1441})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.55424590408802 Time :  7418
accuracy train: 0.877565 val: 0.704478 test: 0.699233
max validation accuracy : 0.713433 max acc epoch : 3 test accuracy : 0.663863
Counter({0: 3294, 2: 2664, 1: 1442})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.785455614328384 Time :  7444
accuracy train: 0.888484 val: 0.701493 test: 0.710364
max validation accuracy : 0.713433 max acc epoch : 3 test accuracy : 0.663863
Counter({0: 3297, 1: 2666, 2: 1437})

Epoch :  11 loss training:  58.22661593556404 Time :  7470
accuracy train: 0.902052 val: 0.716418 test: 0.713084
max validation accuracy : 0.716418 max acc epoch : 11 test accuracy : 0.713084
Counter({2: 3290, 1: 2672, 0: 1438})

Epoch :  12 loss training:  54.91537046432495 Time :  7496
accuracy train: 0.905692 val: 0.707463 test: 0.716547
max validation accuracy : 0.716418 max acc epoch : 11 test accuracy : 0.713084
Counter({2: 3301, 0: 2661, 1: 1438})

Epoch :  13 loss training:  54.10604476928711 Time :  7525
accuracy train: 0.913302 val: 0.716418 test: 0.717536
max validation accuracy : 0.716418 max acc epoch : 11 test accuracy : 0.713084
Counter({1: 3287, 2: 2665, 0: 1448})

Epoch :  14 loss training:  48.73359254002571 Time :  7550
accuracy train: 0.921575 val: 0.710448 test: 0.713084
max validation accuracy : 0.716418 max acc epoch : 11 test accuracy : 0.713084
Counter({0: 3277, 1: 2666, 2: 1457})

Epoch :  15 loss training:  46.732566729187965 Time :  7576
accuracy train: 0.929848 val: 0.707463 test: 0.709869
max validation accuracy : 0.716418 max acc epoch : 11 test accuracy : 0.713084
Counter({2: 3279, 1: 2668, 0: 1453})

Epoch :  16 loss training:  45.20973117649555 Time :  7603
accuracy train: 0.939775 val: 0.716418 test: 0.712590
max validation accuracy : 0.716418 max acc epoch : 11 test accuracy : 0.713084
Counter({0: 3275, 2: 2669, 1: 1456})

Epoch :  17 loss training:  42.98029833287001 Time :  7629
accuracy train: 0.950364 val: 0.725373 test: 0.711106
max validation accuracy : 0.725373 max acc epoch : 17 test accuracy : 0.711106
Counter({0: 3265, 1: 2676, 2: 1459})

Epoch :  18 loss training:  39.197762079536915 Time :  7653
accuracy train: 0.956982 val: 0.719403 test: 0.715805
max validation accuracy : 0.725373 max acc epoch : 17 test accuracy : 0.711106
Counter({0: 3283, 1: 2661, 2: 1456})

Epoch :  19 loss training:  36.55997183918953 Time :  7681
accuracy train: 0.957313 val: 0.722388 test: 0.716300
max validation accuracy : 0.725373 max acc epoch : 17 test accuracy : 0.711106
Counter({2: 3292, 0: 2653, 1: 1455})

Epoch :  20 loss training:  34.2097148373723 Time :  7707
accuracy train: 0.961615 val: 0.725373 test: 0.721494
max validation accuracy : 0.725373 max acc epoch : 17 test accuracy : 0.711106
Counter({0: 3288, 1: 2655, 2: 1457})

Epoch :  21 loss training:  32.64892566204071 Time :  7734
accuracy train: 0.968564 val: 0.725373 test: 0.722236
max validation accuracy : 0.725373 max acc epoch : 17 test accuracy : 0.711106
Counter({2: 3286, 0: 2653, 1: 1461})

Epoch :  22 loss training:  29.90458733588457 Time :  7761
accuracy train: 0.974189 val: 0.740299 test: 0.715805
max validation accuracy : 0.740299 max acc epoch : 22 test accuracy : 0.715805
Counter({0: 3287, 2: 2647, 1: 1466})

Epoch :  23 loss training:  30.116130992770195 Time :  7787
accuracy train: 0.976506 val: 0.740299 test: 0.723225
max validation accuracy : 0.740299 max acc epoch : 22 test accuracy : 0.715805
Counter({2: 3277, 0: 2661, 1: 1462})

Epoch :  24 loss training:  27.201002463698387 Time :  7813
accuracy train: 0.980146 val: 0.725373 test: 0.723720
max validation accuracy : 0.740299 max acc epoch : 22 test accuracy : 0.715805
Counter({2: 3269, 1: 2676, 0: 1455})

Epoch :  25 loss training:  24.602846905589104 Time :  7840
accuracy train: 0.984116 val: 0.746269 test: 0.721247
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({0: 3261, 1: 2683, 2: 1456})

Epoch :  26 loss training:  23.694266576319933 Time :  7868
accuracy train: 0.983124 val: 0.731343 test: 0.723473
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({2: 3282, 1: 2665, 0: 1453})

Epoch :  27 loss training:  21.553910952061415 Time :  7899
accuracy train: 0.985771 val: 0.737313 test: 0.717536
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({1: 3291, 0: 2664, 2: 1445})

Epoch :  28 loss training:  21.348818264901638 Time :  7930
accuracy train: 0.990735 val: 0.728358 test: 0.719021
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({0: 3279, 1: 2679, 2: 1442})

Epoch :  29 loss training:  19.18698400631547 Time :  7957
accuracy train: 0.990404 val: 0.743284 test: 0.721494
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({0: 3272, 1: 2680, 2: 1448})

Epoch :  30 loss training:  18.45179527811706 Time :  7983
accuracy train: 0.992389 val: 0.734328 test: 0.713579
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({0: 3262, 1: 2686, 2: 1452})

Epoch :  31 loss training:  17.38250008970499 Time :  8013
accuracy train: 0.993051 val: 0.734328 test: 0.721494
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({2: 3253, 0: 2691, 1: 1456})

Epoch :  32 loss training:  15.718574956059456 Time :  8040
accuracy train: 0.996029 val: 0.728358 test: 0.718773
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({2: 3251, 1: 2691, 0: 1458})

Epoch :  33 loss training:  14.361929377540946 Time :  8067
accuracy train: 0.996029 val: 0.722388 test: 0.718773
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({1: 3262, 0: 2683, 2: 1455})

Epoch :  34 loss training:  13.992005579173565 Time :  8092
accuracy train: 0.996360 val: 0.725373 test: 0.722731
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({0: 3281, 1: 2674, 2: 1445})

Epoch :  35 loss training:  13.386536026373506 Time :  8119
accuracy train: 0.997684 val: 0.737313 test: 0.717536
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({1: 3260, 0: 2696, 2: 1444})

Epoch :  36 loss training:  11.509475132450461 Time :  8145
accuracy train: 0.997684 val: 0.746269 test: 0.719763
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({0: 3263, 2: 2695, 1: 1442})

Epoch :  37 loss training:  10.113023773767054 Time :  8171
accuracy train: 0.996360 val: 0.746269 test: 0.720257
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({2: 3269, 0: 2694, 1: 1437})

Epoch :  38 loss training:  10.40114607475698 Time :  8199
accuracy train: 0.999669 val: 0.743284 test: 0.720257
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({0: 3265, 1: 2701, 2: 1434})

Epoch :  39 loss training:  9.447601777501404 Time :  8225
accuracy train: 1.000000 val: 0.743284 test: 0.718773
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({1: 3269, 0: 2703, 2: 1428})

Epoch :  40 loss training:  8.815205125138164 Time :  8250
accuracy train: 1.000000 val: 0.743284 test: 0.716794
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({2: 3295, 1: 2675, 0: 1430})

Epoch :  41 loss training:  9.701161414384842 Time :  8279
accuracy train: 1.000000 val: 0.740299 test: 0.717289
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({0: 3319, 2: 2676, 1: 1405})

Epoch :  42 loss training:  7.463555539958179 Time :  8308
accuracy train: 0.999669 val: 0.740299 test: 0.724462
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({2: 3312, 0: 2686, 1: 1402})

Epoch :  43 loss training:  7.536376643925905 Time :  8334
accuracy train: 1.000000 val: 0.740299 test: 0.719268
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({0: 3283, 1: 2714, 2: 1403})

Epoch :  44 loss training:  7.417936932295561 Time :  8359
accuracy train: 0.999669 val: 0.743284 test: 0.719763
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({0: 3289, 1: 2707, 2: 1404})

Epoch :  45 loss training:  6.865525486879051 Time :  8384
accuracy train: 1.000000 val: 0.728358 test: 0.720257
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({2: 3274, 1: 2727, 0: 1399})

Epoch :  46 loss training:  5.960743778850883 Time :  8410
accuracy train: 1.000000 val: 0.740299 test: 0.721989
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({0: 3259, 1: 2742, 2: 1399})

Epoch :  47 loss training:  6.028813486453146 Time :  8437
accuracy train: 1.000000 val: 0.725373 test: 0.719515
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({0: 3270, 1: 2733, 2: 1397})

Epoch :  48 loss training:  5.615931079722941 Time :  8462
accuracy train: 1.000000 val: 0.734328 test: 0.717042
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({2: 3277, 0: 2738, 1: 1385})

Epoch :  49 loss training:  6.276431709527969 Time :  8486
accuracy train: 1.000000 val: 0.722388 test: 0.721247
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({0: 3270, 1: 2749, 2: 1381})

Epoch :  50 loss training:  5.00757330050692 Time :  8512
accuracy train: 1.000000 val: 0.734328 test: 0.720010
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({1: 3269, 0: 2751, 2: 1380})

Epoch :  51 loss training:  4.512547682970762 Time :  8538
accuracy train: 1.000000 val: 0.731343 test: 0.719021
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({1: 3274, 0: 2746, 2: 1380})

Epoch :  52 loss training:  4.451984439976513 Time :  8564
accuracy train: 1.000000 val: 0.740299 test: 0.719268
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({0: 3271, 1: 2753, 2: 1376})

Epoch :  53 loss training:  4.22827192209661 Time :  8590
accuracy train: 1.000000 val: 0.734328 test: 0.716052
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({0: 3262, 1: 2763, 2: 1375})

Epoch :  54 loss training:  4.689221465494484 Time :  8614
accuracy train: 1.000000 val: 0.740299 test: 0.714321
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({1: 3279, 0: 2747, 2: 1374})

Epoch :  55 loss training:  4.000120784621686 Time :  8640
accuracy train: 1.000000 val: 0.740299 test: 0.718773
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({2: 3274, 1: 2750, 0: 1376})

Epoch :  56 loss training:  3.9667189607862383 Time :  8664
accuracy train: 1.000000 val: 0.746269 test: 0.717289
max validation accuracy : 0.746269 max acc epoch : 25 test accuracy : 0.721247
Counter({0: 3272, 1: 2755, 2: 1373})

========================================================================================================================================================================================================
best acc epoch :  25
validation accuracy :  0.746268656716418
test accuracy :  0.7212465990601039
last test_accuracy :  0.7172891417264408
second best val :  0.7432835820895523
second best test :  0.7212465990601039
max gap 8
========================================================================================================================================================================================================

(4043, 1400)
itr : 5
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=23, weight_decay=0)
device :  cuda:0
Counter({2: 2587, 0: 2555, 1: 2258})

Epoch :  1 loss training:  211.80722373723984 Time :  8770
accuracy train: 0.666115 val: 0.650746 test: 0.632451
max validation accuracy : 0.650746 max acc epoch : 1 test accuracy : 0.632451
Counter({2: 3102, 0: 2689, 1: 1609})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  145.47523847222328 Time :  8793
accuracy train: 0.726671 val: 0.674627 test: 0.654712
max validation accuracy : 0.674627 max acc epoch : 2 test accuracy : 0.654712
Counter({0: 2750, 2: 2625, 1: 2025})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  124.4131663441658 Time :  8817
accuracy train: 0.747849 val: 0.692537 test: 0.658917
max validation accuracy : 0.692537 max acc epoch : 3 test accuracy : 0.658917
Counter({1: 3065, 0: 2370, 2: 1965})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.07626140117645 Time :  8840
accuracy train: 0.801456 val: 0.707463 test: 0.688350
max validation accuracy : 0.707463 max acc epoch : 4 test accuracy : 0.688350
Counter({1: 2981, 0: 2481, 2: 1938})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.39898583292961 Time :  8865
accuracy train: 0.823958 val: 0.704478 test: 0.685629
max validation accuracy : 0.707463 max acc epoch : 4 test accuracy : 0.688350
Counter({2: 3020, 0: 2430, 1: 1950})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  81.011479601264 Time :  8889
accuracy train: 0.836863 val: 0.710448 test: 0.691318
max validation accuracy : 0.710448 max acc epoch : 6 test accuracy : 0.691318
Counter({0: 3012, 1: 2474, 2: 1914})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  72.30710303783417 Time :  8912
accuracy train: 0.852416 val: 0.716418 test: 0.700965
max validation accuracy : 0.716418 max acc epoch : 7 test accuracy : 0.700965
Counter({2: 2981, 0: 2473, 1: 1946})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.89700311422348 Time :  8936
accuracy train: 0.864990 val: 0.707463 test: 0.701212
max validation accuracy : 0.716418 max acc epoch : 7 test accuracy : 0.700965
Counter({1: 2969, 2: 2508, 0: 1923})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.78717857599258 Time :  8960
accuracy train: 0.881866 val: 0.722388 test: 0.703438
max validation accuracy : 0.722388 max acc epoch : 9 test accuracy : 0.703438
Counter({2: 2981, 0: 2515, 1: 1904})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.191033974289894 Time :  8983
accuracy train: 0.885175 val: 0.716418 test: 0.713332
max validation accuracy : 0.722388 max acc epoch : 9 test accuracy : 0.703438
Counter({0: 2988, 1: 2513, 2: 1899})

Epoch :  11 loss training:  56.76400814950466 Time :  9009
accuracy train: 0.900397 val: 0.710448 test: 0.712837
max validation accuracy : 0.722388 max acc epoch : 9 test accuracy : 0.703438
Counter({0: 3000, 1: 2505, 2: 1895})

Epoch :  12 loss training:  55.12255744636059 Time :  9032
accuracy train: 0.909332 val: 0.722388 test: 0.718279
max validation accuracy : 0.722388 max acc epoch : 9 test accuracy : 0.703438
Counter({1: 3017, 0: 2495, 2: 1888})

Epoch :  13 loss training:  52.81496821343899 Time :  9056
accuracy train: 0.912641 val: 0.698507 test: 0.714816
max validation accuracy : 0.722388 max acc epoch : 9 test accuracy : 0.703438
Counter({1: 3012, 2: 2503, 0: 1885})

Epoch :  14 loss training:  48.05296264588833 Time :  9080
accuracy train: 0.925215 val: 0.701493 test: 0.713826
max validation accuracy : 0.722388 max acc epoch : 9 test accuracy : 0.703438
Counter({2: 3016, 1: 2525, 0: 1859})

Epoch :  15 loss training:  46.49764841794968 Time :  9104
accuracy train: 0.930841 val: 0.713433 test: 0.718279
max validation accuracy : 0.722388 max acc epoch : 9 test accuracy : 0.703438
Counter({0: 3013, 1: 2523, 2: 1864})

Epoch :  16 loss training:  45.19629122316837 Time :  9130
accuracy train: 0.938782 val: 0.713433 test: 0.715310
max validation accuracy : 0.722388 max acc epoch : 9 test accuracy : 0.703438
Counter({0: 3011, 1: 2527, 2: 1862})

Epoch :  17 loss training:  42.038339599967 Time :  9156
accuracy train: 0.953011 val: 0.725373 test: 0.712837
max validation accuracy : 0.725373 max acc epoch : 17 test accuracy : 0.712837
Counter({1: 3005, 0: 2532, 2: 1863})

Epoch :  18 loss training:  38.64544279873371 Time :  9180
accuracy train: 0.958306 val: 0.707463 test: 0.714816
max validation accuracy : 0.725373 max acc epoch : 17 test accuracy : 0.712837
Counter({2: 3002, 1: 2538, 0: 1860})

Epoch :  19 loss training:  35.52343141287565 Time :  9203
accuracy train: 0.957644 val: 0.716418 test: 0.715558
max validation accuracy : 0.725373 max acc epoch : 17 test accuracy : 0.712837
Counter({1: 3012, 0: 2546, 2: 1842})

Epoch :  20 loss training:  33.599347308278084 Time :  9227
accuracy train: 0.961946 val: 0.725373 test: 0.718031
max validation accuracy : 0.725373 max acc epoch : 17 test accuracy : 0.712837
Counter({2: 3009, 0: 2546, 1: 1845})

Epoch :  21 loss training:  32.25029814243317 Time :  9251
accuracy train: 0.969887 val: 0.728358 test: 0.716547
max validation accuracy : 0.728358 max acc epoch : 21 test accuracy : 0.716547
Counter({0: 3016, 2: 2552, 1: 1832})

Epoch :  22 loss training:  30.729727137833834 Time :  9276
accuracy train: 0.973197 val: 0.731343 test: 0.711848
max validation accuracy : 0.731343 max acc epoch : 22 test accuracy : 0.711848
Counter({2: 3016, 0: 2550, 1: 1834})

Epoch :  23 loss training:  27.321954671293497 Time :  9300
accuracy train: 0.977167 val: 0.728358 test: 0.719515
max validation accuracy : 0.731343 max acc epoch : 22 test accuracy : 0.711848
Counter({2: 3023, 1: 2540, 0: 1837})

Epoch :  24 loss training:  27.757475715130568 Time :  9326
accuracy train: 0.981800 val: 0.725373 test: 0.716300
max validation accuracy : 0.731343 max acc epoch : 22 test accuracy : 0.711848
Counter({1: 3006, 2: 2557, 0: 1837})

Epoch :  25 loss training:  24.64268560707569 Time :  9351
accuracy train: 0.985771 val: 0.737313 test: 0.716052
max validation accuracy : 0.737313 max acc epoch : 25 test accuracy : 0.716052
Counter({0: 3001, 2: 2566, 1: 1833})

Epoch :  26 loss training:  22.930061277002096 Time :  9374
accuracy train: 0.986433 val: 0.725373 test: 0.721494
max validation accuracy : 0.737313 max acc epoch : 25 test accuracy : 0.716052
Counter({0: 2968, 1: 2560, 2: 1872})

Epoch :  27 loss training:  20.827196668833494 Time :  9398
accuracy train: 0.991066 val: 0.731343 test: 0.716300
max validation accuracy : 0.737313 max acc epoch : 25 test accuracy : 0.716052
Counter({1: 2967, 2: 2563, 0: 1870})

Epoch :  28 loss training:  19.840689551085234 Time :  9420
accuracy train: 0.994375 val: 0.713433 test: 0.713332
max validation accuracy : 0.737313 max acc epoch : 25 test accuracy : 0.716052
Counter({2: 2987, 0: 2571, 1: 1842})

Epoch :  29 loss training:  18.388607177883387 Time :  9445
accuracy train: 0.992389 val: 0.731343 test: 0.716547
max validation accuracy : 0.737313 max acc epoch : 25 test accuracy : 0.716052
Counter({1: 2991, 2: 2572, 0: 1837})

Epoch :  30 loss training:  18.35468501225114 Time :  9468
accuracy train: 0.996029 val: 0.731343 test: 0.716547
max validation accuracy : 0.737313 max acc epoch : 25 test accuracy : 0.716052
Counter({2: 2981, 0: 2574, 1: 1845})

Epoch :  31 loss training:  16.778958939015865 Time :  9492
accuracy train: 0.996029 val: 0.728358 test: 0.718279
max validation accuracy : 0.737313 max acc epoch : 25 test accuracy : 0.716052
Counter({2: 2992, 1: 2571, 0: 1837})

Epoch :  32 loss training:  15.33528595417738 Time :  9517
accuracy train: 0.996360 val: 0.728358 test: 0.717042
max validation accuracy : 0.737313 max acc epoch : 25 test accuracy : 0.716052
Counter({1: 3329, 0: 2235, 2: 1836})

Epoch :  33 loss training:  13.934282653033733 Time :  9542
accuracy train: 0.999669 val: 0.734328 test: 0.716794
max validation accuracy : 0.737313 max acc epoch : 25 test accuracy : 0.716052
Counter({2: 3356, 1: 2230, 0: 1814})

Epoch :  34 loss training:  13.756488628685474 Time :  9565
accuracy train: 0.998015 val: 0.740299 test: 0.716052
max validation accuracy : 0.740299 max acc epoch : 34 test accuracy : 0.716052
Counter({0: 3350, 1: 2239, 2: 1811})

Epoch :  35 loss training:  12.729507776908576 Time :  9592
accuracy train: 0.999338 val: 0.737313 test: 0.720999
max validation accuracy : 0.740299 max acc epoch : 34 test accuracy : 0.716052
Counter({2: 3353, 1: 2229, 0: 1818})

Epoch :  36 loss training:  11.128940284252167 Time :  9616
accuracy train: 0.999007 val: 0.743284 test: 0.717289
max validation accuracy : 0.743284 max acc epoch : 36 test accuracy : 0.717289
Counter({1: 3371, 2: 2193, 0: 1836})

Epoch :  37 loss training:  10.982349622994661 Time :  9640
accuracy train: 0.998015 val: 0.731343 test: 0.718526
max validation accuracy : 0.743284 max acc epoch : 36 test accuracy : 0.717289
Counter({0: 3394, 1: 2181, 2: 1825})

Epoch :  38 loss training:  9.553412353619933 Time :  9664
accuracy train: 0.999338 val: 0.731343 test: 0.720999
max validation accuracy : 0.743284 max acc epoch : 36 test accuracy : 0.717289
Counter({1: 3407, 0: 2173, 2: 1820})

Epoch :  39 loss training:  8.708119247108698 Time :  9688
accuracy train: 0.999669 val: 0.731343 test: 0.718031
max validation accuracy : 0.743284 max acc epoch : 36 test accuracy : 0.717289
Counter({1: 3435, 0: 2107, 2: 1858})

Epoch :  40 loss training:  9.158539479598403 Time :  9711
accuracy train: 0.999338 val: 0.728358 test: 0.715558
max validation accuracy : 0.743284 max acc epoch : 36 test accuracy : 0.717289
Counter({2: 3487, 1: 2061, 0: 1852})

Epoch :  41 loss training:  8.223552590236068 Time :  9735
accuracy train: 0.999669 val: 0.749254 test: 0.720257
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.720257
Counter({2: 3495, 1: 2066, 0: 1839})

Epoch :  42 loss training:  7.59914019331336 Time :  9758
accuracy train: 0.999669 val: 0.734328 test: 0.719515
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.720257
Counter({0: 3495, 2: 2054, 1: 1851})

Epoch :  43 loss training:  7.743641213513911 Time :  9782
accuracy train: 0.999669 val: 0.740299 test: 0.720999
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.720257
Counter({2: 3476, 1: 2060, 0: 1864})

Epoch :  44 loss training:  6.81490114890039 Time :  9805
accuracy train: 0.999338 val: 0.722388 test: 0.727430
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.720257
Counter({0: 3476, 1: 2058, 2: 1866})

Epoch :  45 loss training:  6.902103562839329 Time :  9827
accuracy train: 0.999669 val: 0.728358 test: 0.722978
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.720257
Counter({0: 3475, 1: 2045, 2: 1880})

Epoch :  46 loss training:  7.146505838260055 Time :  9852
accuracy train: 1.000000 val: 0.734328 test: 0.716052
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.720257
Counter({1: 3469, 0: 2048, 2: 1883})

Epoch :  47 loss training:  6.005069402046502 Time :  9876
accuracy train: 0.999669 val: 0.746269 test: 0.714568
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.720257
Counter({1: 3617, 2: 2028, 0: 1755})

Epoch :  48 loss training:  5.809580967295915 Time :  9902
accuracy train: 0.999669 val: 0.734328 test: 0.719763
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.720257
Counter({1: 3608, 2: 2049, 0: 1743})

Epoch :  49 loss training:  5.967280017910525 Time :  9925
accuracy train: 1.000000 val: 0.746269 test: 0.720505
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.720257
Counter({0: 3626, 1: 2051, 2: 1723})

Epoch :  50 loss training:  5.368727037217468 Time :  9948
accuracy train: 1.000000 val: 0.734328 test: 0.723225
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.720257
Counter({1: 3630, 2: 2068, 0: 1702})

Epoch :  51 loss training:  5.018336271867156 Time :  9973
accuracy train: 1.000000 val: 0.755224 test: 0.719763
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({0: 3668, 1: 2052, 2: 1680})

Epoch :  52 loss training:  5.313626729883254 Time :  9998
accuracy train: 1.000000 val: 0.740299 test: 0.718773
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({2: 3681, 1: 2045, 0: 1674})

Epoch :  53 loss training:  4.309304425027221 Time :  10022
accuracy train: 1.000000 val: 0.725373 test: 0.716794
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({1: 3728, 2: 2056, 0: 1616})

Epoch :  54 loss training:  4.2622945085167885 Time :  10048
accuracy train: 0.999669 val: 0.722388 test: 0.717784
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({2: 3739, 1: 2084, 0: 1577})

Epoch :  55 loss training:  4.342866436112672 Time :  10072
accuracy train: 1.000000 val: 0.728358 test: 0.720010
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({2: 3809, 0: 2089, 1: 1502})

Epoch :  56 loss training:  3.756475736387074 Time :  10097
accuracy train: 1.000000 val: 0.716418 test: 0.719515
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({0: 3843, 1: 2076, 2: 1481})

Epoch :  57 loss training:  3.198116563959047 Time :  10120
accuracy train: 1.000000 val: 0.731343 test: 0.719268
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({0: 3853, 1: 2078, 2: 1469})

Epoch :  58 loss training:  3.2855712820310146 Time :  10143
accuracy train: 1.000000 val: 0.728358 test: 0.714816
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({0: 3869, 1: 2097, 2: 1434})

Epoch :  59 loss training:  3.489980586571619 Time :  10167
accuracy train: 1.000000 val: 0.731343 test: 0.716547
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({2: 3874, 1: 2111, 0: 1415})

Epoch :  60 loss training:  4.443196993786842 Time :  10189
accuracy train: 1.000000 val: 0.722388 test: 0.720010
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({0: 3866, 2: 2118, 1: 1416})

Epoch :  61 loss training:  2.975528075825423 Time :  10213
accuracy train: 1.000000 val: 0.710448 test: 0.719268
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({0: 3847, 1: 2132, 2: 1421})

Epoch :  62 loss training:  2.9752129479311407 Time :  10237
accuracy train: 1.000000 val: 0.731343 test: 0.720010
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({0: 3834, 1: 2147, 2: 1419})

Epoch :  63 loss training:  2.3328871382400393 Time :  10260
accuracy train: 1.000000 val: 0.728358 test: 0.720752
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({2: 3790, 0: 2195, 1: 1415})

Epoch :  64 loss training:  2.582282714312896 Time :  10285
accuracy train: 1.000000 val: 0.722388 test: 0.718526
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({0: 3788, 1: 2202, 2: 1410})

Epoch :  65 loss training:  2.3029860026435927 Time :  10311
accuracy train: 1.000000 val: 0.734328 test: 0.721494
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({2: 3782, 1: 2203, 0: 1415})

Epoch :  66 loss training:  2.8145554214715958 Time :  10334
accuracy train: 1.000000 val: 0.719403 test: 0.720257
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({1: 3791, 2: 2194, 0: 1415})

Epoch :  67 loss training:  3.367157893953845 Time :  10358
accuracy train: 1.000000 val: 0.734328 test: 0.721247
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({1: 3838, 0: 2141, 2: 1421})

Epoch :  68 loss training:  3.0868861322524026 Time :  10383
accuracy train: 1.000000 val: 0.731343 test: 0.721247
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({2: 3836, 0: 2154, 1: 1410})

Epoch :  69 loss training:  2.496597261633724 Time :  10406
accuracy train: 1.000000 val: 0.731343 test: 0.716547
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({0: 3862, 1: 2127, 2: 1411})

Epoch :  70 loss training:  2.3941182824783027 Time :  10431
accuracy train: 1.000000 val: 0.749254 test: 0.715063
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({0: 3854, 1: 2133, 2: 1413})

Epoch :  71 loss training:  2.2713108855532482 Time :  10457
accuracy train: 1.000000 val: 0.725373 test: 0.717289
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({1: 3859, 0: 2131, 2: 1410})

Epoch :  72 loss training:  2.154925541835837 Time :  10482
accuracy train: 1.000000 val: 0.722388 test: 0.715310
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({0: 3876, 2: 2113, 1: 1411})

Epoch :  73 loss training:  1.891709232586436 Time :  10506
accuracy train: 1.000000 val: 0.737313 test: 0.720010
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({0: 3883, 1: 2108, 2: 1409})

Epoch :  74 loss training:  1.919967770227231 Time :  10534
accuracy train: 1.000000 val: 0.725373 test: 0.719515
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({2: 3881, 0: 2106, 1: 1413})

Epoch :  75 loss training:  1.4806414913618937 Time :  10559
accuracy train: 1.000000 val: 0.740299 test: 0.719515
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({1: 3885, 2: 2104, 0: 1411})

Epoch :  76 loss training:  1.9512350423028693 Time :  10584
accuracy train: 1.000000 val: 0.734328 test: 0.722483
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({1: 3882, 0: 2110, 2: 1408})

Epoch :  77 loss training:  1.3359153289347887 Time :  10608
accuracy train: 1.000000 val: 0.740299 test: 0.717042
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({0: 3883, 2: 2109, 1: 1408})

Epoch :  78 loss training:  1.220212262822315 Time :  10632
accuracy train: 1.000000 val: 0.746269 test: 0.719763
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({1: 3867, 2: 2129, 0: 1404})

Epoch :  79 loss training:  1.512744288542308 Time :  10658
accuracy train: 1.000000 val: 0.737313 test: 0.718031
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({1: 3870, 0: 2125, 2: 1405})

Epoch :  80 loss training:  1.8020564736798406 Time :  10685
accuracy train: 1.000000 val: 0.743284 test: 0.715558
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({0: 3889, 1: 2110, 2: 1401})

Epoch :  81 loss training:  1.2933401089394465 Time :  10709
accuracy train: 1.000000 val: 0.743284 test: 0.715558
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({0: 3890, 1: 2104, 2: 1406})

Epoch :  82 loss training:  1.2240926731028594 Time :  10732
accuracy train: 1.000000 val: 0.737313 test: 0.718279
max validation accuracy : 0.755224 max acc epoch : 51 test accuracy : 0.719763
Counter({2: 3896, 0: 2102, 1: 1402})

========================================================================================================================================================================================================
best acc epoch :  51
validation accuracy :  0.755223880597015
test accuracy :  0.7197625525599802
last test_accuracy :  0.7182785060598565
second best val :  0.7492537313432835
second best test :  0.7202572347266881
max gap 10
========================================================================================================================================================================================================

(4043, 1400)
itr : 6
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=23, weight_decay=0)
device :  cuda:0
Counter({2: 2587, 0: 2555, 1: 2258})

Epoch :  1 loss training:  212.17921513319016 Time :  10843
accuracy train: 0.664792 val: 0.656716 test: 0.634183
max validation accuracy : 0.656716 max acc epoch : 1 test accuracy : 0.634183
Counter({0: 3174, 1: 2601, 2: 1625})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  144.60857212543488 Time :  10871
accuracy train: 0.733289 val: 0.668657 test: 0.656443
max validation accuracy : 0.668657 max acc epoch : 2 test accuracy : 0.656443
Counter({1: 3119, 0: 2773, 2: 1508})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  125.59403508901596 Time :  10898
accuracy train: 0.751820 val: 0.710448 test: 0.664605
max validation accuracy : 0.710448 max acc epoch : 3 test accuracy : 0.664605
Counter({1: 2975, 0: 2926, 2: 1499})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.14065283536911 Time :  10927
accuracy train: 0.798809 val: 0.704478 test: 0.681425
max validation accuracy : 0.710448 max acc epoch : 3 test accuracy : 0.664605
Counter({2: 3085, 1: 2808, 0: 1507})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  89.11004257202148 Time :  10953
accuracy train: 0.827929 val: 0.704478 test: 0.692308
max validation accuracy : 0.710448 max acc epoch : 3 test accuracy : 0.664605
Counter({0: 3102, 1: 2814, 2: 1484})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  81.13240578770638 Time :  10983
accuracy train: 0.829914 val: 0.719403 test: 0.688845
max validation accuracy : 0.719403 max acc epoch : 6 test accuracy : 0.688845
Counter({2: 3123, 0: 2777, 1: 1500})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  73.37042573094368 Time :  11012
accuracy train: 0.853077 val: 0.722388 test: 0.702943
max validation accuracy : 0.722388 max acc epoch : 7 test accuracy : 0.702943
Counter({1: 3106, 2: 2793, 0: 1501})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  69.30101379752159 Time :  11038
accuracy train: 0.877234 val: 0.704478 test: 0.706653
max validation accuracy : 0.722388 max acc epoch : 7 test accuracy : 0.702943
Counter({0: 3136, 1: 2775, 2: 1489})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  66.25454445183277 Time :  11065
accuracy train: 0.880874 val: 0.716418 test: 0.701707
max validation accuracy : 0.722388 max acc epoch : 7 test accuracy : 0.702943
Counter({0: 3148, 2: 2759, 1: 1493})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.849458143115044 Time :  11090
accuracy train: 0.890139 val: 0.731343 test: 0.710116
max validation accuracy : 0.731343 max acc epoch : 10 test accuracy : 0.710116
Counter({0: 3146, 1: 2766, 2: 1488})

Epoch :  11 loss training:  57.77742278575897 Time :  11115
accuracy train: 0.902052 val: 0.746269 test: 0.712095
max validation accuracy : 0.746269 max acc epoch : 11 test accuracy : 0.712095
Counter({2: 3158, 1: 2753, 0: 1489})

Epoch :  12 loss training:  54.752470411360264 Time :  11143
accuracy train: 0.908008 val: 0.740299 test: 0.718526
max validation accuracy : 0.746269 max acc epoch : 11 test accuracy : 0.712095
Counter({1: 3167, 2: 2748, 0: 1485})

Epoch :  13 loss training:  53.1516547203064 Time :  11171
accuracy train: 0.919259 val: 0.734328 test: 0.716300
max validation accuracy : 0.746269 max acc epoch : 11 test accuracy : 0.712095
Counter({0: 3170, 1: 2742, 2: 1488})

Epoch :  14 loss training:  49.69922998547554 Time :  11200
accuracy train: 0.929517 val: 0.755224 test: 0.717042
max validation accuracy : 0.755224 max acc epoch : 14 test accuracy : 0.717042
Counter({1: 3158, 0: 2746, 2: 1496})

Epoch :  15 loss training:  46.60024802386761 Time :  11232
accuracy train: 0.938451 val: 0.734328 test: 0.715805
max validation accuracy : 0.755224 max acc epoch : 14 test accuracy : 0.717042
Counter({1: 3169, 0: 2738, 2: 1493})

Epoch :  16 loss training:  45.04271797835827 Time :  11263
accuracy train: 0.944408 val: 0.737313 test: 0.715805
max validation accuracy : 0.755224 max acc epoch : 14 test accuracy : 0.717042
Counter({1: 3161, 0: 2748, 2: 1491})

Epoch :  17 loss training:  43.115590929985046 Time :  11294
accuracy train: 0.952680 val: 0.734328 test: 0.713826
max validation accuracy : 0.755224 max acc epoch : 14 test accuracy : 0.717042
Counter({1: 3160, 2: 2747, 0: 1493})

Epoch :  18 loss training:  38.40548577159643 Time :  11329
accuracy train: 0.957975 val: 0.743284 test: 0.720505
max validation accuracy : 0.755224 max acc epoch : 14 test accuracy : 0.717042
Counter({0: 3151, 1: 2754, 2: 1495})

Epoch :  19 loss training:  36.34787832200527 Time :  11360
accuracy train: 0.957644 val: 0.746269 test: 0.718031
max validation accuracy : 0.755224 max acc epoch : 14 test accuracy : 0.717042
Counter({0: 3150, 2: 2756, 1: 1494})

Epoch :  20 loss training:  33.381377533078194 Time :  11389
accuracy train: 0.960953 val: 0.755224 test: 0.722978
max validation accuracy : 0.755224 max acc epoch : 14 test accuracy : 0.717042
Counter({1: 3143, 0: 2759, 2: 1498})

Epoch :  21 loss training:  32.59943297505379 Time :  11429
accuracy train: 0.966909 val: 0.749254 test: 0.723720
max validation accuracy : 0.755224 max acc epoch : 14 test accuracy : 0.717042
Counter({1: 3137, 2: 2765, 0: 1498})

Epoch :  22 loss training:  29.130268096923828 Time :  11458
accuracy train: 0.976837 val: 0.737313 test: 0.722978
max validation accuracy : 0.755224 max acc epoch : 14 test accuracy : 0.717042
Counter({2: 3131, 0: 2773, 1: 1496})

Epoch :  23 loss training:  27.967334516346455 Time :  11486
accuracy train: 0.980146 val: 0.764179 test: 0.717042
max validation accuracy : 0.764179 max acc epoch : 23 test accuracy : 0.717042
Counter({0: 3127, 2: 2791, 1: 1482})

Epoch :  24 loss training:  25.603672921657562 Time :  11520
accuracy train: 0.982793 val: 0.758209 test: 0.722731
max validation accuracy : 0.764179 max acc epoch : 23 test accuracy : 0.717042
Counter({1: 3145, 0: 2770, 2: 1485})

Epoch :  25 loss training:  24.272520013153553 Time :  11550
accuracy train: 0.985440 val: 0.752239 test: 0.714321
max validation accuracy : 0.764179 max acc epoch : 23 test accuracy : 0.717042
Counter({1: 3129, 0: 2785, 2: 1486})

Epoch :  26 loss training:  23.30893487483263 Time :  11578
accuracy train: 0.986764 val: 0.752239 test: 0.720257
max validation accuracy : 0.764179 max acc epoch : 23 test accuracy : 0.717042
Counter({0: 3110, 2: 2806, 1: 1484})

Epoch :  27 loss training:  22.683956272900105 Time :  11615
accuracy train: 0.988749 val: 0.746269 test: 0.724462
max validation accuracy : 0.764179 max acc epoch : 23 test accuracy : 0.717042
Counter({2: 3099, 0: 2824, 1: 1477})

Epoch :  28 loss training:  20.613566864281893 Time :  11648
accuracy train: 0.991727 val: 0.752239 test: 0.721741
max validation accuracy : 0.764179 max acc epoch : 23 test accuracy : 0.717042
Counter({0: 3086, 1: 2831, 2: 1483})

Epoch :  29 loss training:  18.106607917696238 Time :  11675
accuracy train: 0.992720 val: 0.755224 test: 0.721741
max validation accuracy : 0.764179 max acc epoch : 23 test accuracy : 0.717042
Counter({0: 3067, 2: 2851, 1: 1482})

Epoch :  30 loss training:  18.351795552298427 Time :  11718
accuracy train: 0.995036 val: 0.758209 test: 0.716300
max validation accuracy : 0.764179 max acc epoch : 23 test accuracy : 0.717042
Counter({0: 3044, 2: 2873, 1: 1483})

Epoch :  31 loss training:  16.841133061796427 Time :  11750
accuracy train: 0.995367 val: 0.773134 test: 0.722978
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({1: 3012, 0: 2888, 2: 1500})

Epoch :  32 loss training:  15.196349324658513 Time :  11782
accuracy train: 0.996691 val: 0.743284 test: 0.722483
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({0: 3020, 1: 2889, 2: 1491})

Epoch :  33 loss training:  14.976582309231162 Time :  11807
accuracy train: 0.996360 val: 0.761194 test: 0.717042
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({0: 3025, 2: 2884, 1: 1491})

Epoch :  34 loss training:  13.932415256276727 Time :  11836
accuracy train: 0.998015 val: 0.758209 test: 0.718773
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({0: 3037, 1: 2875, 2: 1488})

Epoch :  35 loss training:  13.026829643175006 Time :  11864
accuracy train: 0.997684 val: 0.764179 test: 0.716052
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({0: 3044, 2: 2880, 1: 1476})

Epoch :  36 loss training:  11.956872191280127 Time :  11897
accuracy train: 0.998345 val: 0.755224 test: 0.719515
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({1: 3022, 0: 2908, 2: 1470})

Epoch :  37 loss training:  10.771005069836974 Time :  11925
accuracy train: 0.997684 val: 0.758209 test: 0.721741
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({0: 3005, 1: 2930, 2: 1465})

Epoch :  38 loss training:  9.895155349746346 Time :  11950
accuracy train: 0.999338 val: 0.755224 test: 0.718031
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({0: 3019, 1: 2917, 2: 1464})

Epoch :  39 loss training:  9.911962736397982 Time :  11979
accuracy train: 1.000000 val: 0.749254 test: 0.716547
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({0: 3025, 1: 2921, 2: 1454})

Epoch :  40 loss training:  9.44443465769291 Time :  12006
accuracy train: 0.999338 val: 0.761194 test: 0.719763
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({2: 3022, 1: 2928, 0: 1450})

Epoch :  41 loss training:  8.328870520927012 Time :  12031
accuracy train: 1.000000 val: 0.743284 test: 0.717042
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({1: 3021, 2: 2926, 0: 1453})

Epoch :  42 loss training:  7.640739594586194 Time :  12058
accuracy train: 0.999669 val: 0.749254 test: 0.718279
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({2: 3019, 0: 2929, 1: 1452})

Epoch :  43 loss training:  7.73735424503684 Time :  12087
accuracy train: 0.999669 val: 0.743284 test: 0.717536
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({0: 3035, 1: 2920, 2: 1445})

Epoch :  44 loss training:  8.465890916995704 Time :  12112
accuracy train: 0.999669 val: 0.758209 test: 0.717784
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({1: 3023, 0: 2932, 2: 1445})

Epoch :  45 loss training:  7.363467374816537 Time :  12137
accuracy train: 1.000000 val: 0.743284 test: 0.718031
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({2: 3029, 0: 2928, 1: 1443})

Epoch :  46 loss training:  6.6785566210746765 Time :  12165
accuracy train: 1.000000 val: 0.743284 test: 0.716547
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({0: 3031, 1: 2930, 2: 1439})

Epoch :  47 loss training:  4.936993564944714 Time :  12192
accuracy train: 1.000000 val: 0.737313 test: 0.720257
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({2: 3028, 0: 2933, 1: 1439})

Epoch :  48 loss training:  5.591045816428959 Time :  12217
accuracy train: 1.000000 val: 0.740299 test: 0.722236
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({2: 3036, 1: 2923, 0: 1441})

Epoch :  49 loss training:  5.612733393907547 Time :  12248
accuracy train: 1.000000 val: 0.743284 test: 0.717289
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({2: 3043, 1: 2914, 0: 1443})

Epoch :  50 loss training:  5.929579073097557 Time :  12280
accuracy train: 0.999669 val: 0.734328 test: 0.711106
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({0: 3066, 1: 2910, 2: 1424})

Epoch :  51 loss training:  4.873330584727228 Time :  12306
accuracy train: 1.000000 val: 0.737313 test: 0.716052
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({0: 3061, 2: 2906, 1: 1433})

Epoch :  52 loss training:  5.290391549933702 Time :  12330
accuracy train: 1.000000 val: 0.752239 test: 0.714321
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({0: 3066, 1: 2906, 2: 1428})

Epoch :  53 loss training:  4.115615949966013 Time :  12361
accuracy train: 1.000000 val: 0.743284 test: 0.720505
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({1: 3077, 2: 2902, 0: 1421})

Epoch :  54 loss training:  4.142983850324526 Time :  12387
accuracy train: 1.000000 val: 0.740299 test: 0.711848
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({0: 3061, 1: 2919, 2: 1420})

Epoch :  55 loss training:  4.585747153731063 Time :  12411
accuracy train: 1.000000 val: 0.755224 test: 0.713826
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({0: 3074, 2: 2923, 1: 1403})

Epoch :  56 loss training:  3.7671443277504295 Time :  12441
accuracy train: 1.000000 val: 0.740299 test: 0.716547
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({1: 3083, 2: 2924, 0: 1393})

Epoch :  57 loss training:  3.316101915203035 Time :  12468
accuracy train: 1.000000 val: 0.752239 test: 0.721494
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({0: 3109, 1: 2904, 2: 1387})

Epoch :  58 loss training:  3.076471530366689 Time :  12498
accuracy train: 1.000000 val: 0.755224 test: 0.712342
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({0: 3124, 1: 2901, 2: 1375})

Epoch :  59 loss training:  3.213451507734135 Time :  12528
accuracy train: 1.000000 val: 0.755224 test: 0.720752
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({1: 3113, 2: 2913, 0: 1374})

Epoch :  60 loss training:  3.3175016627646983 Time :  12554
accuracy train: 1.000000 val: 0.746269 test: 0.712095
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({1: 3120, 0: 2910, 2: 1370})

Epoch :  61 loss training:  2.7482150114374235 Time :  12579
accuracy train: 1.000000 val: 0.731343 test: 0.713579
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({1: 3110, 0: 2917, 2: 1373})

Epoch :  62 loss training:  2.8213181423489004 Time :  12607
accuracy train: 0.999007 val: 0.758209 test: 0.718526
max validation accuracy : 0.773134 max acc epoch : 31 test accuracy : 0.722978
Counter({0: 3111, 2: 2925, 1: 1364})

========================================================================================================================================================================================================
best acc epoch :  31
validation accuracy :  0.7731343283582089
test accuracy :  0.7229779866435815
last test_accuracy :  0.7185258471432104
second best val :  0.764179104477612
second best test :  0.7170418006430869
max gap 9
========================================================================================================================================================================================================

(4043, 1400)
itr : 7
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=23, weight_decay=0)
device :  cuda:0
Counter({2: 2587, 0: 2555, 1: 2258})

Epoch :  1 loss training:  211.83155018091202 Time :  12711
accuracy train: 0.668762 val: 0.656716 test: 0.634430
max validation accuracy : 0.656716 max acc epoch : 1 test accuracy : 0.634430
Counter({1: 3343, 0: 2461, 2: 1596})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  145.4627632200718 Time :  12736
accuracy train: 0.731304 val: 0.680597 test: 0.654959
max validation accuracy : 0.680597 max acc epoch : 2 test accuracy : 0.654959
Counter({2: 3265, 0: 2604, 1: 1531})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  124.33367955684662 Time :  12760
accuracy train: 0.740900 val: 0.680597 test: 0.649518
max validation accuracy : 0.680597 max acc epoch : 2 test accuracy : 0.654959
Counter({0: 3133, 2: 2742, 1: 1525})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.44508409500122 Time :  12785
accuracy train: 0.797485 val: 0.716418 test: 0.687361
max validation accuracy : 0.716418 max acc epoch : 4 test accuracy : 0.687361
Counter({2: 3255, 0: 2610, 1: 1535})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.69503259658813 Time :  12808
accuracy train: 0.819656 val: 0.704478 test: 0.685629
max validation accuracy : 0.716418 max acc epoch : 4 test accuracy : 0.687361
Counter({2: 3243, 0: 2650, 1: 1507})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  81.91156594455242 Time :  12830
accuracy train: 0.842488 val: 0.704478 test: 0.692555
max validation accuracy : 0.716418 max acc epoch : 4 test accuracy : 0.687361
Counter({1: 3363, 0: 2549, 2: 1488})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  71.78862836956978 Time :  12854
accuracy train: 0.853408 val: 0.716418 test: 0.698986
max validation accuracy : 0.716418 max acc epoch : 4 test accuracy : 0.687361
Counter({2: 3365, 0: 2539, 1: 1496})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.82555621862411 Time :  12878
accuracy train: 0.869623 val: 0.722388 test: 0.706653
max validation accuracy : 0.722388 max acc epoch : 8 test accuracy : 0.706653
Counter({0: 3366, 1: 2539, 2: 1495})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.27994391322136 Time :  12900
accuracy train: 0.886168 val: 0.713433 test: 0.704675
max validation accuracy : 0.722388 max acc epoch : 8 test accuracy : 0.706653
Counter({2: 3358, 0: 2545, 1: 1497})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.270118184387684 Time :  12924
accuracy train: 0.884514 val: 0.716418 test: 0.711353
max validation accuracy : 0.722388 max acc epoch : 8 test accuracy : 0.706653
Counter({1: 3364, 2: 2542, 0: 1494})

Epoch :  11 loss training:  56.682232454419136 Time :  12951
accuracy train: 0.905361 val: 0.719403 test: 0.712837
max validation accuracy : 0.722388 max acc epoch : 8 test accuracy : 0.706653
Counter({0: 3351, 1: 2556, 2: 1493})

Epoch :  12 loss training:  54.93320080637932 Time :  12975
accuracy train: 0.911317 val: 0.725373 test: 0.715063
max validation accuracy : 0.725373 max acc epoch : 12 test accuracy : 0.715063
Counter({2: 3335, 1: 2569, 0: 1496})

Epoch :  13 loss training:  52.99664033949375 Time :  12998
accuracy train: 0.917273 val: 0.704478 test: 0.715063
max validation accuracy : 0.725373 max acc epoch : 12 test accuracy : 0.715063
Counter({1: 3336, 2: 2578, 0: 1486})

Epoch :  14 loss training:  48.80030243098736 Time :  13022
accuracy train: 0.927862 val: 0.701493 test: 0.715310
max validation accuracy : 0.725373 max acc epoch : 12 test accuracy : 0.715063
Counter({0: 3330, 2: 2576, 1: 1494})

Epoch :  15 loss training:  47.032237991690636 Time :  13044
accuracy train: 0.935473 val: 0.713433 test: 0.715558
max validation accuracy : 0.725373 max acc epoch : 12 test accuracy : 0.715063
Counter({1: 3351, 0: 2560, 2: 1489})

Epoch :  16 loss training:  44.31252767145634 Time :  13067
accuracy train: 0.939775 val: 0.716418 test: 0.718526
max validation accuracy : 0.725373 max acc epoch : 12 test accuracy : 0.715063
Counter({0: 3370, 1: 2553, 2: 1477})

Epoch :  17 loss training:  41.05864252150059 Time :  13092
accuracy train: 0.953342 val: 0.731343 test: 0.718031
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.718031
Counter({2: 3369, 1: 2550, 0: 1481})

Epoch :  18 loss training:  38.54019479453564 Time :  13116
accuracy train: 0.957313 val: 0.725373 test: 0.719268
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.718031
Counter({2: 3362, 0: 2555, 1: 1483})

Epoch :  19 loss training:  36.50655045360327 Time :  13139
accuracy train: 0.961284 val: 0.722388 test: 0.718526
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.718031
Counter({0: 3365, 1: 2552, 2: 1483})

Epoch :  20 loss training:  33.97735369950533 Time :  13162
accuracy train: 0.964924 val: 0.710448 test: 0.720752
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.718031
Counter({0: 3348, 1: 2566, 2: 1486})

Epoch :  21 loss training:  33.24841632694006 Time :  13188
accuracy train: 0.970880 val: 0.722388 test: 0.722236
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.718031
Counter({0: 3347, 1: 2555, 2: 1498})

Epoch :  22 loss training:  30.67608378827572 Time :  13211
accuracy train: 0.978160 val: 0.734328 test: 0.720257
max validation accuracy : 0.734328 max acc epoch : 22 test accuracy : 0.720257
Counter({0: 3305, 1: 2594, 2: 1501})

Epoch :  23 loss training:  29.53772996366024 Time :  13235
accuracy train: 0.979815 val: 0.728358 test: 0.719763
max validation accuracy : 0.734328 max acc epoch : 22 test accuracy : 0.720257
Counter({2: 3289, 0: 2617, 1: 1494})

Epoch :  24 loss training:  27.032262302935123 Time :  13260
accuracy train: 0.982793 val: 0.728358 test: 0.723720
max validation accuracy : 0.734328 max acc epoch : 22 test accuracy : 0.720257
Counter({2: 3278, 0: 2621, 1: 1501})

Epoch :  25 loss training:  24.573288034647703 Time :  13284
accuracy train: 0.986433 val: 0.734328 test: 0.713826
max validation accuracy : 0.734328 max acc epoch : 22 test accuracy : 0.720257
Counter({1: 3279, 0: 2621, 2: 1500})

Epoch :  26 loss training:  23.30179812759161 Time :  13307
accuracy train: 0.988749 val: 0.725373 test: 0.718279
max validation accuracy : 0.734328 max acc epoch : 22 test accuracy : 0.720257
Counter({0: 3280, 1: 2621, 2: 1499})

Epoch :  27 loss training:  21.83112856000662 Time :  13331
accuracy train: 0.989080 val: 0.734328 test: 0.720010
max validation accuracy : 0.734328 max acc epoch : 22 test accuracy : 0.720257
Counter({2: 3239, 1: 2667, 0: 1494})

Epoch :  28 loss training:  20.78008297085762 Time :  13357
accuracy train: 0.992389 val: 0.737313 test: 0.720752
max validation accuracy : 0.737313 max acc epoch : 28 test accuracy : 0.720752
Counter({1: 3182, 2: 2726, 0: 1492})

Epoch :  29 loss training:  19.526155095547438 Time :  13381
accuracy train: 0.992389 val: 0.737313 test: 0.722236
max validation accuracy : 0.737313 max acc epoch : 28 test accuracy : 0.720752
Counter({0: 3158, 2: 2748, 1: 1494})

Epoch :  30 loss training:  18.25678587704897 Time :  13405
accuracy train: 0.994705 val: 0.743284 test: 0.716547
max validation accuracy : 0.743284 max acc epoch : 30 test accuracy : 0.716547
Counter({0: 3154, 2: 2754, 1: 1492})

Epoch :  31 loss training:  16.70944901742041 Time :  13428
accuracy train: 0.995698 val: 0.740299 test: 0.723720
max validation accuracy : 0.743284 max acc epoch : 30 test accuracy : 0.716547
Counter({0: 3168, 1: 2737, 2: 1495})

Epoch :  32 loss training:  14.763617247343063 Time :  13453
accuracy train: 0.997684 val: 0.728358 test: 0.720257
max validation accuracy : 0.743284 max acc epoch : 30 test accuracy : 0.716547
Counter({0: 3178, 1: 2725, 2: 1497})

Epoch :  33 loss training:  13.865779088810086 Time :  13479
accuracy train: 0.997684 val: 0.731343 test: 0.722236
max validation accuracy : 0.743284 max acc epoch : 30 test accuracy : 0.716547
Counter({2: 3226, 0: 2688, 1: 1486})

Epoch :  34 loss training:  13.90846268646419 Time :  13505
accuracy train: 0.997022 val: 0.740299 test: 0.726688
max validation accuracy : 0.743284 max acc epoch : 30 test accuracy : 0.716547
Counter({1: 3238, 0: 2678, 2: 1484})

Epoch :  35 loss training:  13.147830417379737 Time :  13528
accuracy train: 0.998015 val: 0.752239 test: 0.720752
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({0: 3228, 2: 2693, 1: 1479})

Epoch :  36 loss training:  11.494554093107581 Time :  13551
accuracy train: 0.997684 val: 0.740299 test: 0.720010
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({2: 3264, 0: 2661, 1: 1475})

Epoch :  37 loss training:  10.135009665042162 Time :  13574
accuracy train: 0.997684 val: 0.740299 test: 0.723225
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({2: 3268, 0: 2659, 1: 1473})

Epoch :  38 loss training:  10.150354411453009 Time :  13597
accuracy train: 0.999007 val: 0.734328 test: 0.717784
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({0: 3238, 1: 2693, 2: 1469})

Epoch :  39 loss training:  9.261897834949195 Time :  13620
accuracy train: 0.999669 val: 0.743284 test: 0.721247
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({2: 3262, 1: 2683, 0: 1455})

Epoch :  40 loss training:  9.02793850004673 Time :  13643
accuracy train: 0.999669 val: 0.722388 test: 0.719268
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({1: 3267, 2: 2676, 0: 1457})

Epoch :  41 loss training:  8.600535771809518 Time :  13666
accuracy train: 0.999669 val: 0.728358 test: 0.718526
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({0: 3250, 2: 2699, 1: 1451})

Epoch :  42 loss training:  7.884398999623954 Time :  13689
accuracy train: 0.999669 val: 0.725373 test: 0.722978
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({0: 3257, 1: 2693, 2: 1450})

Epoch :  43 loss training:  7.622126480564475 Time :  13712
accuracy train: 0.999669 val: 0.740299 test: 0.720505
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({0: 3244, 1: 2706, 2: 1450})

Epoch :  44 loss training:  7.152861044742167 Time :  13735
accuracy train: 1.000000 val: 0.737313 test: 0.716052
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({0: 3243, 1: 2713, 2: 1444})

Epoch :  45 loss training:  6.800903612282127 Time :  13757
accuracy train: 0.999669 val: 0.737313 test: 0.712590
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({2: 3213, 1: 2743, 0: 1444})

Epoch :  46 loss training:  6.886698701418936 Time :  13779
accuracy train: 1.000000 val: 0.752239 test: 0.716052
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({0: 3236, 2: 2731, 1: 1433})

Epoch :  47 loss training:  6.0582592859864235 Time :  13800
accuracy train: 0.999669 val: 0.713433 test: 0.720752
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({0: 3250, 1: 2719, 2: 1431})

Epoch :  48 loss training:  5.456434301100671 Time :  13822
accuracy train: 0.999669 val: 0.743284 test: 0.719515
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({0: 3261, 1: 2707, 2: 1432})

Epoch :  49 loss training:  5.579748352058232 Time :  13846
accuracy train: 1.000000 val: 0.734328 test: 0.716300
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({0: 3292, 1: 2679, 2: 1429})

Epoch :  50 loss training:  5.805108027067035 Time :  13870
accuracy train: 1.000000 val: 0.737313 test: 0.716052
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({0: 3394, 1: 2582, 2: 1424})

Epoch :  51 loss training:  4.546144333668053 Time :  13893
accuracy train: 1.000000 val: 0.740299 test: 0.716794
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({0: 3387, 2: 2590, 1: 1423})

Epoch :  52 loss training:  4.6590754496864974 Time :  13918
accuracy train: 1.000000 val: 0.740299 test: 0.718279
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({0: 3418, 2: 2580, 1: 1402})

Epoch :  53 loss training:  4.554486827692017 Time :  13943
accuracy train: 1.000000 val: 0.737313 test: 0.718031
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({0: 3414, 2: 2584, 1: 1402})

Epoch :  54 loss training:  3.7701469738967717 Time :  13965
accuracy train: 1.000000 val: 0.752239 test: 0.718031
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({0: 3421, 1: 2577, 2: 1402})

Epoch :  55 loss training:  3.6858746332582086 Time :  13989
accuracy train: 1.000000 val: 0.737313 test: 0.716794
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({0: 3396, 1: 2602, 2: 1402})

Epoch :  56 loss training:  3.7930711936205626 Time :  14011
accuracy train: 1.000000 val: 0.722388 test: 0.718526
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({0: 3439, 2: 2568, 1: 1393})

Epoch :  57 loss training:  3.749533383641392 Time :  14033
accuracy train: 1.000000 val: 0.740299 test: 0.719268
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({1: 3444, 0: 2564, 2: 1392})

Epoch :  58 loss training:  3.8273033702280372 Time :  14057
accuracy train: 1.000000 val: 0.737313 test: 0.719268
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({1: 3439, 0: 2569, 2: 1392})

Epoch :  59 loss training:  2.63313404424116 Time :  14079
accuracy train: 1.000000 val: 0.728358 test: 0.719268
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({2: 3438, 0: 2569, 1: 1393})

Epoch :  60 loss training:  3.101707272231579 Time :  14103
accuracy train: 1.000000 val: 0.728358 test: 0.720010
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({0: 3413, 2: 2594, 1: 1393})

Epoch :  61 loss training:  2.8190404151100665 Time :  14126
accuracy train: 1.000000 val: 0.719403 test: 0.716794
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({0: 3394, 1: 2613, 2: 1393})

Epoch :  62 loss training:  3.727697837166488 Time :  14150
accuracy train: 1.000000 val: 0.731343 test: 0.719021
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({0: 3367, 1: 2641, 2: 1392})

Epoch :  63 loss training:  2.684913777280599 Time :  14176
accuracy train: 1.000000 val: 0.737313 test: 0.719268
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({1: 3364, 2: 2646, 0: 1390})

Epoch :  64 loss training:  2.56206640182063 Time :  14199
accuracy train: 1.000000 val: 0.734328 test: 0.720010
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({0: 3279, 2: 2733, 1: 1388})

Epoch :  65 loss training:  2.5004782516043633 Time :  14224
accuracy train: 1.000000 val: 0.743284 test: 0.726688
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({1: 3266, 0: 2748, 2: 1386})

Epoch :  66 loss training:  2.798526312923059 Time :  14247
accuracy train: 1.000000 val: 0.752239 test: 0.722731
max validation accuracy : 0.752239 max acc epoch : 35 test accuracy : 0.720752
Counter({1: 3286, 0: 2729, 2: 1385})

========================================================================================================================================================================================================
best acc epoch :  35
validation accuracy :  0.7522388059701492
test accuracy :  0.720751916893396
last test_accuracy :  0.7227306455602276
second best val :  0.7432835820895523
second best test :  0.716547118476379
max gap 6
========================================================================================================================================================================================================

(4043, 1400)
itr : 8
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=23, weight_decay=0)
device :  cuda:0
Counter({2: 2587, 0: 2555, 1: 2258})

Epoch :  1 loss training:  212.19207799434662 Time :  14350
accuracy train: 0.668762 val: 0.656716 test: 0.632946
max validation accuracy : 0.656716 max acc epoch : 1 test accuracy : 0.632946
Counter({1: 3322, 2: 2450, 0: 1628})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  146.3394964337349 Time :  14373
accuracy train: 0.724686 val: 0.671642 test: 0.658175
max validation accuracy : 0.671642 max acc epoch : 2 test accuracy : 0.658175
Counter({2: 3257, 1: 2592, 0: 1551})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  123.81071257591248 Time :  14396
accuracy train: 0.742555 val: 0.680597 test: 0.657927
max validation accuracy : 0.680597 max acc epoch : 3 test accuracy : 0.657927
Counter({0: 2919, 1: 2431, 2: 2050})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  96.84552830457687 Time :  14421
accuracy train: 0.794838 val: 0.701493 test: 0.686124
max validation accuracy : 0.701493 max acc epoch : 4 test accuracy : 0.686124
Counter({0: 2905, 2: 2416, 1: 2079})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  89.04468324780464 Time :  14446
accuracy train: 0.829914 val: 0.710448 test: 0.690824
max validation accuracy : 0.710448 max acc epoch : 5 test accuracy : 0.690824
Counter({2: 3022, 0: 2435, 1: 1943})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  82.2913888990879 Time :  14470
accuracy train: 0.830576 val: 0.719403 test: 0.698491
max validation accuracy : 0.719403 max acc epoch : 6 test accuracy : 0.698491
Counter({1: 2934, 0: 2873, 2: 1593})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  71.92809934914112 Time :  14494
accuracy train: 0.857710 val: 0.731343 test: 0.702449
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.702449
Counter({2: 2975, 1: 2842, 0: 1583})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.76422384381294 Time :  14516
accuracy train: 0.860357 val: 0.716418 test: 0.705664
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.702449
Counter({2: 3111, 1: 2713, 0: 1576})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.74149319529533 Time :  14538
accuracy train: 0.883852 val: 0.710448 test: 0.703438
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.702449
Counter({0: 3124, 1: 2719, 2: 1557})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.973749458789825 Time :  14560
accuracy train: 0.888815 val: 0.716418 test: 0.712095
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.702449
Counter({0: 3128, 1: 2721, 2: 1551})

Epoch :  11 loss training:  58.40101134777069 Time :  14584
accuracy train: 0.903706 val: 0.713433 test: 0.712837
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.702449
Counter({0: 3138, 1: 2713, 2: 1549})

Epoch :  12 loss training:  54.51117829978466 Time :  14608
accuracy train: 0.905692 val: 0.713433 test: 0.716547
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.702449
Counter({1: 3128, 0: 2721, 2: 1551})

Epoch :  13 loss training:  54.2671367675066 Time :  14631
accuracy train: 0.915950 val: 0.728358 test: 0.710611
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.702449
Counter({0: 3129, 1: 2718, 2: 1553})

Epoch :  14 loss training:  48.508292734622955 Time :  14655
accuracy train: 0.929517 val: 0.725373 test: 0.716547
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.702449
Counter({2: 3170, 1: 2674, 0: 1556})

Epoch :  15 loss training:  45.75678549706936 Time :  14680
accuracy train: 0.936135 val: 0.722388 test: 0.718279
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.702449
Counter({0: 3180, 1: 2662, 2: 1558})

Epoch :  16 loss training:  44.82488575577736 Time :  14704
accuracy train: 0.939113 val: 0.725373 test: 0.715310
max validation accuracy : 0.731343 max acc epoch : 7 test accuracy : 0.702449
Counter({0: 3145, 1: 2704, 2: 1551})

Epoch :  17 loss training:  42.51517130434513 Time :  14728
accuracy train: 0.950364 val: 0.734328 test: 0.719268
max validation accuracy : 0.734328 max acc epoch : 17 test accuracy : 0.719268
Counter({0: 3143, 2: 2705, 1: 1552})

Epoch :  18 loss training:  40.50249284505844 Time :  14751
accuracy train: 0.952019 val: 0.734328 test: 0.718031
max validation accuracy : 0.734328 max acc epoch : 17 test accuracy : 0.719268
Counter({1: 3142, 2: 2698, 0: 1560})

Epoch :  19 loss training:  36.50604805350304 Time :  14773
accuracy train: 0.955989 val: 0.719403 test: 0.716300
max validation accuracy : 0.734328 max acc epoch : 17 test accuracy : 0.719268
Counter({2: 3141, 0: 2709, 1: 1550})

Epoch :  20 loss training:  35.3505719229579 Time :  14795
accuracy train: 0.962938 val: 0.737313 test: 0.721247
max validation accuracy : 0.737313 max acc epoch : 20 test accuracy : 0.721247
Counter({2: 3148, 0: 2708, 1: 1544})

Epoch :  21 loss training:  32.49609346687794 Time :  14817
accuracy train: 0.965917 val: 0.731343 test: 0.721494
max validation accuracy : 0.737313 max acc epoch : 20 test accuracy : 0.721247
Counter({0: 3156, 1: 2704, 2: 1540})

Epoch :  22 loss training:  29.4428376480937 Time :  14840
accuracy train: 0.975182 val: 0.728358 test: 0.717784
max validation accuracy : 0.737313 max acc epoch : 20 test accuracy : 0.721247
Counter({2: 3126, 0: 2737, 1: 1537})

Epoch :  23 loss training:  30.13462308049202 Time :  14863
accuracy train: 0.977498 val: 0.755224 test: 0.720999
max validation accuracy : 0.755224 max acc epoch : 23 test accuracy : 0.720999
Counter({1: 3087, 0: 2780, 2: 1533})

Epoch :  24 loss training:  27.38493663072586 Time :  14886
accuracy train: 0.979153 val: 0.746269 test: 0.721741
max validation accuracy : 0.755224 max acc epoch : 23 test accuracy : 0.720999
Counter({0: 3064, 2: 2795, 1: 1541})

Epoch :  25 loss training:  24.062010318040848 Time :  14908
accuracy train: 0.983786 val: 0.764179 test: 0.720505
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3054, 1: 2799, 2: 1547})

Epoch :  26 loss training:  23.151506543159485 Time :  14931
accuracy train: 0.985771 val: 0.740299 test: 0.722978
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3067, 1: 2789, 2: 1544})

Epoch :  27 loss training:  21.83975377306342 Time :  14953
accuracy train: 0.988749 val: 0.761194 test: 0.717784
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3072, 1: 2789, 2: 1539})

Epoch :  28 loss training:  21.191602431237698 Time :  14977
accuracy train: 0.993051 val: 0.743284 test: 0.714568
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({2: 3080, 1: 2786, 0: 1534})

Epoch :  29 loss training:  19.035685572773218 Time :  15000
accuracy train: 0.992389 val: 0.743284 test: 0.722978
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3074, 2: 2793, 1: 1533})

Epoch :  30 loss training:  17.947424091398716 Time :  15024
accuracy train: 0.994044 val: 0.740299 test: 0.712837
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3079, 2: 2788, 1: 1533})

Epoch :  31 loss training:  17.498820915818214 Time :  15046
accuracy train: 0.993713 val: 0.722388 test: 0.722483
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({2: 3067, 1: 2792, 0: 1541})

Epoch :  32 loss training:  16.013726901263 Time :  15070
accuracy train: 0.997022 val: 0.728358 test: 0.721247
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({2: 3071, 1: 2797, 0: 1532})

Epoch :  33 loss training:  13.005951929837465 Time :  15095
accuracy train: 0.997684 val: 0.728358 test: 0.722236
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3089, 1: 2785, 2: 1526})

Epoch :  34 loss training:  13.518799737095833 Time :  15116
accuracy train: 0.996691 val: 0.722388 test: 0.717784
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({2: 3070, 0: 2803, 1: 1527})

Epoch :  35 loss training:  12.906357439234853 Time :  15141
accuracy train: 0.997353 val: 0.737313 test: 0.718526
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({2: 3051, 0: 2824, 1: 1525})

Epoch :  36 loss training:  12.648218680173159 Time :  15164
accuracy train: 0.999007 val: 0.713433 test: 0.724462
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({1: 3041, 2: 2841, 0: 1518})

Epoch :  37 loss training:  10.883805317804217 Time :  15188
accuracy train: 0.997022 val: 0.725373 test: 0.722731
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3042, 2: 2852, 1: 1506})

Epoch :  38 loss training:  10.851986018940806 Time :  15210
accuracy train: 0.998676 val: 0.734328 test: 0.724462
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3019, 1: 2877, 2: 1504})

Epoch :  39 loss training:  9.67408103030175 Time :  15233
accuracy train: 0.999007 val: 0.743284 test: 0.723967
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3016, 2: 2882, 1: 1502})

Epoch :  40 loss training:  9.592680170200765 Time :  15256
accuracy train: 1.000000 val: 0.743284 test: 0.720257
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3046, 1: 2854, 2: 1500})

Epoch :  41 loss training:  9.046678511425853 Time :  15279
accuracy train: 0.999338 val: 0.740299 test: 0.723225
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({1: 3060, 0: 2863, 2: 1477})

Epoch :  42 loss training:  7.787998840212822 Time :  15304
accuracy train: 0.999669 val: 0.737313 test: 0.723720
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3050, 2: 2888, 1: 1462})

Epoch :  43 loss training:  7.861044393852353 Time :  15327
accuracy train: 0.999669 val: 0.734328 test: 0.720257
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({2: 3048, 1: 2895, 0: 1457})

Epoch :  44 loss training:  7.493932940997183 Time :  15349
accuracy train: 0.999338 val: 0.737313 test: 0.723720
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3059, 2: 2884, 1: 1457})

Epoch :  45 loss training:  6.584665458649397 Time :  15370
accuracy train: 0.999669 val: 0.737313 test: 0.725451
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({2: 3058, 0: 2880, 1: 1462})

Epoch :  46 loss training:  6.749776915181428 Time :  15395
accuracy train: 0.999669 val: 0.749254 test: 0.719515
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({1: 3020, 0: 2911, 2: 1469})

Epoch :  47 loss training:  5.341672060545534 Time :  15420
accuracy train: 0.999338 val: 0.749254 test: 0.720999
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({2: 3042, 0: 2897, 1: 1461})

Epoch :  48 loss training:  5.0828795013949275 Time :  15442
accuracy train: 0.999338 val: 0.746269 test: 0.718526
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3083, 1: 2870, 2: 1447})

Epoch :  49 loss training:  6.08960684761405 Time :  15463
accuracy train: 0.999669 val: 0.743284 test: 0.714568
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3074, 1: 2883, 2: 1443})

Epoch :  50 loss training:  5.09116781828925 Time :  15487
accuracy train: 0.999669 val: 0.740299 test: 0.717042
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3050, 1: 2901, 2: 1449})

Epoch :  51 loss training:  5.112130292924121 Time :  15510
accuracy train: 1.000000 val: 0.743284 test: 0.721494
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({1: 3057, 0: 2895, 2: 1448})

Epoch :  52 loss training:  4.1856679324992 Time :  15533
accuracy train: 1.000000 val: 0.731343 test: 0.717536
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3057, 2: 2886, 1: 1457})

Epoch :  53 loss training:  4.066928906366229 Time :  15557
accuracy train: 1.000000 val: 0.740299 test: 0.717289
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({0: 3048, 2: 2894, 1: 1458})

Epoch :  54 loss training:  4.734522287268192 Time :  15580
accuracy train: 1.000000 val: 0.740299 test: 0.716052
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({2: 3005, 0: 2947, 1: 1448})

Epoch :  55 loss training:  4.331691716331989 Time :  15605
accuracy train: 1.000000 val: 0.737313 test: 0.724462
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({1: 2979, 0: 2977, 2: 1444})

Epoch :  56 loss training:  3.432268070988357 Time :  15629
accuracy train: 1.000000 val: 0.737313 test: 0.723967
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.720505
Counter({2: 3003, 0: 2956, 1: 1441})

========================================================================================================================================================================================================
best acc epoch :  25
validation accuracy :  0.764179104477612
test accuracy :  0.720504575810042
last test_accuracy :  0.7239673509769973
second best val :  0.7611940298507462
second best test :  0.720504575810042
max gap 10
========================================================================================================================================================================================================

(4043, 1400)
itr : 9
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=23, weight_decay=0)
device :  cuda:0
Counter({2: 2587, 0: 2555, 1: 2258})

Epoch :  1 loss training:  212.01637470722198 Time :  15730
accuracy train: 0.670086 val: 0.665672 test: 0.632698
max validation accuracy : 0.665672 max acc epoch : 1 test accuracy : 0.632698
Counter({0: 3402, 2: 2373, 1: 1625})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  146.09841930866241 Time :  15754
accuracy train: 0.720053 val: 0.674627 test: 0.648776
max validation accuracy : 0.674627 max acc epoch : 2 test accuracy : 0.648776
Counter({1: 2658, 2: 2628, 0: 2114})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  124.41981196403503 Time :  15776
accuracy train: 0.755129 val: 0.698507 test: 0.659659
max validation accuracy : 0.698507 max acc epoch : 3 test accuracy : 0.659659
Counter({1: 2952, 0: 2318, 2: 2130})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.66981789469719 Time :  15800
accuracy train: 0.796492 val: 0.713433 test: 0.684887
max validation accuracy : 0.713433 max acc epoch : 4 test accuracy : 0.684887
Counter({2: 2917, 1: 2481, 0: 2002})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  89.07394671440125 Time :  15823
accuracy train: 0.826274 val: 0.713433 test: 0.689092
max validation accuracy : 0.713433 max acc epoch : 4 test accuracy : 0.684887
Counter({1: 2957, 2: 2460, 0: 1983})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  81.6499839425087 Time :  15845
accuracy train: 0.838187 val: 0.710448 test: 0.691813
max validation accuracy : 0.713433 max acc epoch : 4 test accuracy : 0.684887
Counter({2: 2974, 1: 2514, 0: 1912})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  72.28772708773613 Time :  15869
accuracy train: 0.856056 val: 0.722388 test: 0.701212
max validation accuracy : 0.722388 max acc epoch : 7 test accuracy : 0.701212
Counter({1: 2962, 2: 2532, 0: 1906})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  69.43776881694794 Time :  15895
accuracy train: 0.867306 val: 0.716418 test: 0.705664
max validation accuracy : 0.722388 max acc epoch : 7 test accuracy : 0.701212
Counter({2: 2959, 0: 2564, 1: 1877})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.20002609491348 Time :  15918
accuracy train: 0.885175 val: 0.722388 test: 0.706159
max validation accuracy : 0.722388 max acc epoch : 7 test accuracy : 0.701212
Counter({2: 2972, 1: 2560, 0: 1868})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.33082202076912 Time :  15940
accuracy train: 0.886830 val: 0.716418 test: 0.717042
max validation accuracy : 0.722388 max acc epoch : 7 test accuracy : 0.701212
Counter({0: 2979, 2: 2567, 1: 1854})

Epoch :  11 loss training:  57.410495951771736 Time :  15962
accuracy train: 0.902052 val: 0.713433 test: 0.712590
max validation accuracy : 0.722388 max acc epoch : 7 test accuracy : 0.701212
Counter({2: 2982, 0: 2564, 1: 1854})

Epoch :  12 loss training:  54.92018963396549 Time :  15984
accuracy train: 0.906684 val: 0.719403 test: 0.720752
max validation accuracy : 0.722388 max acc epoch : 7 test accuracy : 0.701212
Counter({1: 3003, 2: 2556, 0: 1841})

Epoch :  13 loss training:  53.09011736512184 Time :  16005
accuracy train: 0.912972 val: 0.710448 test: 0.716052
max validation accuracy : 0.722388 max acc epoch : 7 test accuracy : 0.701212
Counter({1: 2996, 2: 2560, 0: 1844})

Epoch :  14 loss training:  48.46945883333683 Time :  16028
accuracy train: 0.925546 val: 0.725373 test: 0.714321
max validation accuracy : 0.725373 max acc epoch : 14 test accuracy : 0.714321
Counter({2: 2988, 0: 2588, 1: 1824})

Epoch :  15 loss training:  46.58573469519615 Time :  16051
accuracy train: 0.933488 val: 0.719403 test: 0.714816
max validation accuracy : 0.725373 max acc epoch : 14 test accuracy : 0.714321
Counter({1: 2986, 2: 2591, 0: 1823})

Epoch :  16 loss training:  44.717286467552185 Time :  16076
accuracy train: 0.940768 val: 0.728358 test: 0.715063
max validation accuracy : 0.728358 max acc epoch : 16 test accuracy : 0.715063
Counter({2: 2976, 0: 2604, 1: 1820})

Epoch :  17 loss training:  42.21409197896719 Time :  16098
accuracy train: 0.952680 val: 0.728358 test: 0.716052
max validation accuracy : 0.728358 max acc epoch : 16 test accuracy : 0.715063
Counter({2: 2987, 0: 2607, 1: 1806})

Epoch :  18 loss training:  38.818013958632946 Time :  16120
accuracy train: 0.959960 val: 0.722388 test: 0.718526
max validation accuracy : 0.728358 max acc epoch : 16 test accuracy : 0.715063
Counter({1: 2984, 0: 2616, 2: 1800})

Epoch :  19 loss training:  35.682296968996525 Time :  16143
accuracy train: 0.958637 val: 0.734328 test: 0.717042
max validation accuracy : 0.734328 max acc epoch : 19 test accuracy : 0.717042
Counter({0: 2998, 2: 2615, 1: 1787})

Epoch :  20 loss training:  33.36331883072853 Time :  16166
accuracy train: 0.967240 val: 0.734328 test: 0.720752
max validation accuracy : 0.734328 max acc epoch : 19 test accuracy : 0.717042
Counter({2: 3018, 0: 2623, 1: 1759})

Epoch :  21 loss training:  32.50082781910896 Time :  16190
accuracy train: 0.971873 val: 0.737313 test: 0.717289
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.717289
Counter({2: 3025, 1: 2613, 0: 1762})

Epoch :  22 loss training:  31.08387713879347 Time :  16215
accuracy train: 0.975513 val: 0.746269 test: 0.713579
max validation accuracy : 0.746269 max acc epoch : 22 test accuracy : 0.713579
Counter({0: 3028, 2: 2612, 1: 1760})

Epoch :  23 loss training:  27.92636390775442 Time :  16238
accuracy train: 0.977498 val: 0.743284 test: 0.716794
max validation accuracy : 0.746269 max acc epoch : 22 test accuracy : 0.713579
Counter({0: 3031, 2: 2600, 1: 1769})

Epoch :  24 loss training:  27.684658478945494 Time :  16261
accuracy train: 0.979815 val: 0.731343 test: 0.719021
max validation accuracy : 0.746269 max acc epoch : 22 test accuracy : 0.713579
Counter({0: 3026, 1: 2602, 2: 1772})

Epoch :  25 loss training:  25.400522779673338 Time :  16284
accuracy train: 0.984116 val: 0.746269 test: 0.719515
max validation accuracy : 0.746269 max acc epoch : 22 test accuracy : 0.713579
Counter({2: 3019, 1: 2615, 0: 1766})

Epoch :  26 loss training:  23.183598194271326 Time :  16306
accuracy train: 0.985771 val: 0.722388 test: 0.719763
max validation accuracy : 0.746269 max acc epoch : 22 test accuracy : 0.713579
Counter({2: 3003, 1: 2606, 0: 1791})

Epoch :  27 loss training:  20.531669329851866 Time :  16330
accuracy train: 0.991066 val: 0.752239 test: 0.719021
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({0: 2984, 1: 2610, 2: 1806})

Epoch :  28 loss training:  19.93088385462761 Time :  16353
accuracy train: 0.994044 val: 0.728358 test: 0.718031
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({0: 2999, 1: 2635, 2: 1766})

Epoch :  29 loss training:  18.949505906552076 Time :  16377
accuracy train: 0.992389 val: 0.734328 test: 0.718031
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({2: 3002, 1: 2635, 0: 1763})

Epoch :  30 loss training:  18.55054685100913 Time :  16400
accuracy train: 0.995698 val: 0.713433 test: 0.717042
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({0: 3007, 1: 2627, 2: 1766})

Epoch :  31 loss training:  17.125389579683542 Time :  16423
accuracy train: 0.997022 val: 0.746269 test: 0.724709
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({0: 3011, 1: 2629, 2: 1760})

Epoch :  32 loss training:  15.174214070662856 Time :  16447
accuracy train: 0.994705 val: 0.734328 test: 0.719515
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({0: 3017, 2: 2635, 1: 1748})

Epoch :  33 loss training:  14.341374516487122 Time :  16472
accuracy train: 0.997353 val: 0.740299 test: 0.719763
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({2: 3009, 0: 2637, 1: 1754})

Epoch :  34 loss training:  13.777434487827122 Time :  16495
accuracy train: 0.996691 val: 0.737313 test: 0.719021
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({2: 2967, 1: 2658, 0: 1775})

Epoch :  35 loss training:  12.883602746762335 Time :  16518
accuracy train: 0.998015 val: 0.743284 test: 0.722483
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({2: 2957, 0: 2655, 1: 1788})

Epoch :  36 loss training:  10.707312831655145 Time :  16540
accuracy train: 0.999338 val: 0.740299 test: 0.722483
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({2: 2977, 1: 2621, 0: 1802})

Epoch :  37 loss training:  10.165078189224005 Time :  16563
accuracy train: 0.998676 val: 0.740299 test: 0.722236
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({0: 2982, 2: 2599, 1: 1819})

Epoch :  38 loss training:  9.791921832598746 Time :  16585
accuracy train: 0.999007 val: 0.746269 test: 0.722483
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({0: 2979, 2: 2590, 1: 1831})

Epoch :  39 loss training:  9.715506005100906 Time :  16609
accuracy train: 0.998345 val: 0.731343 test: 0.717536
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({0: 2966, 1: 2609, 2: 1825})

Epoch :  40 loss training:  9.612933553755283 Time :  16632
accuracy train: 0.999338 val: 0.734328 test: 0.716794
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({1: 2957, 0: 2608, 2: 1835})

Epoch :  41 loss training:  7.896398888900876 Time :  16654
accuracy train: 0.999669 val: 0.749254 test: 0.719763
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({1: 2956, 0: 2595, 2: 1849})

Epoch :  42 loss training:  7.796735774725676 Time :  16676
accuracy train: 0.999669 val: 0.734328 test: 0.720752
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({0: 2942, 2: 2593, 1: 1865})

Epoch :  43 loss training:  7.7092801705002785 Time :  16698
accuracy train: 0.999338 val: 0.749254 test: 0.719515
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({2: 2936, 1: 2587, 0: 1877})

Epoch :  44 loss training:  7.916374529711902 Time :  16722
accuracy train: 0.999007 val: 0.746269 test: 0.721989
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({2: 2944, 1: 2574, 0: 1882})

Epoch :  45 loss training:  6.80132804159075 Time :  16745
accuracy train: 0.999338 val: 0.743284 test: 0.719268
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({2: 2938, 0: 2577, 1: 1885})

Epoch :  46 loss training:  6.6031818790361285 Time :  16769
accuracy train: 1.000000 val: 0.743284 test: 0.716794
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({0: 2945, 2: 2568, 1: 1887})

Epoch :  47 loss training:  5.868119868915528 Time :  16791
accuracy train: 0.999669 val: 0.734328 test: 0.718279
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({0: 2955, 2: 2568, 1: 1877})

Epoch :  48 loss training:  6.573163944296539 Time :  16815
accuracy train: 0.999669 val: 0.734328 test: 0.720505
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({2: 2968, 0: 2557, 1: 1875})

Epoch :  49 loss training:  5.372723405249417 Time :  16840
accuracy train: 1.000000 val: 0.746269 test: 0.718773
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({0: 2973, 1: 2561, 2: 1866})

Epoch :  50 loss training:  5.058541022706777 Time :  16861
accuracy train: 1.000000 val: 0.740299 test: 0.724709
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({2: 2974, 1: 2565, 0: 1861})

Epoch :  51 loss training:  4.195288851857185 Time :  16885
accuracy train: 1.000000 val: 0.722388 test: 0.713579
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({1: 2967, 0: 2560, 2: 1873})

Epoch :  52 loss training:  3.87717418349348 Time :  16909
accuracy train: 1.000000 val: 0.731343 test: 0.714074
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({0: 2965, 1: 2566, 2: 1869})

Epoch :  53 loss training:  4.875690860208124 Time :  16931
accuracy train: 1.000000 val: 0.734328 test: 0.719515
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({0: 2953, 2: 2565, 1: 1882})

Epoch :  54 loss training:  4.42435808153823 Time :  16954
accuracy train: 0.999669 val: 0.737313 test: 0.719763
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({1: 2958, 2: 2564, 0: 1878})

Epoch :  55 loss training:  4.294064070098102 Time :  16977
accuracy train: 1.000000 val: 0.749254 test: 0.714074
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({0: 2949, 1: 2584, 2: 1867})

Epoch :  56 loss training:  4.586992151103914 Time :  17003
accuracy train: 1.000000 val: 0.728358 test: 0.713826
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({1: 2942, 2: 2581, 0: 1877})

Epoch :  57 loss training:  3.571908850921318 Time :  17028
accuracy train: 1.000000 val: 0.716418 test: 0.719763
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({2: 2941, 1: 2568, 0: 1891})

Epoch :  58 loss training:  3.8670640317723155 Time :  17053
accuracy train: 1.000000 val: 0.725373 test: 0.714816
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.719021
Counter({0: 2958, 1: 2564, 2: 1878})

========================================================================================================================================================================================================
best acc epoch :  27
validation accuracy :  0.7522388059701492
test accuracy :  0.7190205293099183
last test_accuracy :  0.7148157308929013
second best val :  0.7492537313432835
second best test :  0.7190205293099183
max gap 7
========================================================================================================================================================================================================

(4043, 1400)
=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  25 	 val_accuracy : 0.76418 	 test_accuracy : 0.72050 	 last test_accuracy : 0.72001 	 second best val : 0.75224 	 second best test : 0.72050
k :  1 	 best_acc epoch :  60 	 val_accuracy : 0.75224 	 test_accuracy : 0.72347 	 last test_accuracy : 0.71581 	 second best val : 0.74925 	 second best test : 0.72545
k :  2 	 best_acc epoch :  25 	 val_accuracy : 0.74925 	 test_accuracy : 0.72199 	 last test_accuracy : 0.72372 	 second best val : 0.74627 	 second best test : 0.72199
k :  3 	 best_acc epoch :  25 	 val_accuracy : 0.74925 	 test_accuracy : 0.72125 	 last test_accuracy : 0.71581 	 second best val : 0.74328 	 second best test : 0.72125
k :  4 	 best_acc epoch :  25 	 val_accuracy : 0.74627 	 test_accuracy : 0.72125 	 last test_accuracy : 0.71729 	 second best val : 0.74328 	 second best test : 0.72125
k :  5 	 best_acc epoch :  51 	 val_accuracy : 0.75522 	 test_accuracy : 0.71976 	 last test_accuracy : 0.71828 	 second best val : 0.74925 	 second best test : 0.72026
k :  6 	 best_acc epoch :  31 	 val_accuracy : 0.77313 	 test_accuracy : 0.72298 	 last test_accuracy : 0.71853 	 second best val : 0.76418 	 second best test : 0.71704
k :  7 	 best_acc epoch :  35 	 val_accuracy : 0.75224 	 test_accuracy : 0.72075 	 last test_accuracy : 0.72273 	 second best val : 0.74328 	 second best test : 0.71655
k :  8 	 best_acc epoch :  25 	 val_accuracy : 0.76418 	 test_accuracy : 0.72050 	 last test_accuracy : 0.72397 	 second best val : 0.76119 	 second best test : 0.72050
k :  9 	 best_acc epoch :  27 	 val_accuracy : 0.75224 	 test_accuracy : 0.71902 	 last test_accuracy : 0.71482 	 second best val : 0.74925 	 second best test : 0.71902

avg :  	 val_accuracy : 0.75582 	 test_accuracy : 0.72115 	 last_accuracy : 0.71909 	 second best val : 0.75015 	 second best test : 0.72038

std :  	 val_accuracy : 0.00810 	 test_accuracy : 0.00130 	 last_accuracy : 0.00322 	 second best val : 0.00694 	 second best test : 0.00240
