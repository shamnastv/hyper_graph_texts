date and time :  Fri Jan 29 14:32:22 2021
Namespace(batch_size=16, dataset='R52', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=1e-05)
device :  cuda:0
HGNNModel(
  (word_embeddings): Embedding(9333, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=52, bias=True)
    (1): Linear(in_features=200, out_features=52, bias=True)
    (2): Linear(in_features=200, out_features=52, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  390.8369867429137 Time :  33
accuracy train: 0.881436 val: 0.862805 test: 0.861868
max validation accuracy : 0.862805 max acc epoch : 1 test accuracy : 0.861868

Epoch :  2 loss training:  204.3995648138225 Time :  52
accuracy train: 0.909383 val: 0.876524 test: 0.892218
max validation accuracy : 0.876524 max acc epoch : 2 test accuracy : 0.892218

Epoch :  3 loss training:  157.43758841603994 Time :  71
accuracy train: 0.940549 val: 0.893293 test: 0.903891
max validation accuracy : 0.893293 max acc epoch : 3 test accuracy : 0.903891

Epoch :  4 loss training:  132.39735279418528 Time :  90
accuracy train: 0.939533 val: 0.902439 test: 0.913619
max validation accuracy : 0.902439 max acc epoch : 4 test accuracy : 0.913619

Epoch :  5 loss training:  111.3758604656905 Time :  114
accuracy train: 0.958672 val: 0.916159 test: 0.915564
max validation accuracy : 0.916159 max acc epoch : 5 test accuracy : 0.915564

Epoch :  6 loss training:  83.92168762814254 Time :  136
accuracy train: 0.969512 val: 0.922256 test: 0.925681
max validation accuracy : 0.922256 max acc epoch : 6 test accuracy : 0.925681

Epoch :  7 loss training:  73.14730461407453 Time :  154
accuracy train: 0.973577 val: 0.923780 test: 0.922957
max validation accuracy : 0.923780 max acc epoch : 7 test accuracy : 0.922957

Epoch :  8 loss training:  66.1183440645691 Time :  174
accuracy train: 0.977642 val: 0.929878 test: 0.927237
max validation accuracy : 0.929878 max acc epoch : 8 test accuracy : 0.927237

Epoch :  9 loss training:  62.18283299263567 Time :  201
accuracy train: 0.977642 val: 0.929878 test: 0.921790
max validation accuracy : 0.929878 max acc epoch : 8 test accuracy : 0.927237

Epoch :  10 loss training:  58.82167283212766 Time :  219
accuracy train: 0.985264 val: 0.932927 test: 0.931907
max validation accuracy : 0.932927 max acc epoch : 10 test accuracy : 0.931907

Epoch :  11 loss training:  47.954026180901565 Time :  238
accuracy train: 0.983401 val: 0.928354 test: 0.928016
max validation accuracy : 0.932927 max acc epoch : 10 test accuracy : 0.931907

Epoch :  12 loss training:  40.992217935970984 Time :  256
accuracy train: 0.987636 val: 0.926829 test: 0.931128
max validation accuracy : 0.932927 max acc epoch : 10 test accuracy : 0.931907

Epoch :  13 loss training:  40.50015967874788 Time :  280
accuracy train: 0.990007 val: 0.934451 test: 0.927626
max validation accuracy : 0.934451 max acc epoch : 13 test accuracy : 0.927626

Epoch :  14 loss training:  40.80028492055135 Time :  299
accuracy train: 0.992039 val: 0.937500 test: 0.930739
max validation accuracy : 0.937500 max acc epoch : 14 test accuracy : 0.930739

Epoch :  15 loss training:  33.421603832161054 Time :  317
accuracy train: 0.992547 val: 0.934451 test: 0.931518
max validation accuracy : 0.937500 max acc epoch : 14 test accuracy : 0.930739

Epoch :  16 loss training:  30.263755934895016 Time :  337
accuracy train: 0.993394 val: 0.932927 test: 0.930350
max validation accuracy : 0.937500 max acc epoch : 14 test accuracy : 0.930739

Epoch :  17 loss training:  28.667047643801197 Time :  356
accuracy train: 0.994919 val: 0.934451 test: 0.931518
max validation accuracy : 0.937500 max acc epoch : 14 test accuracy : 0.930739

Epoch :  18 loss training:  24.92985600011889 Time :  372
accuracy train: 0.994919 val: 0.931402 test: 0.934630
max validation accuracy : 0.937500 max acc epoch : 14 test accuracy : 0.930739

Epoch :  19 loss training:  24.910914301406592 Time :  389
accuracy train: 0.995088 val: 0.932927 test: 0.935019
max validation accuracy : 0.937500 max acc epoch : 14 test accuracy : 0.930739

Epoch :  20 loss training:  24.41507686778641 Time :  410
accuracy train: 0.995427 val: 0.939024 test: 0.933074
max validation accuracy : 0.939024 max acc epoch : 20 test accuracy : 0.933074

Epoch :  21 loss training:  21.91172238928266 Time :  426
accuracy train: 0.995427 val: 0.935976 test: 0.938132
max validation accuracy : 0.939024 max acc epoch : 20 test accuracy : 0.933074

Epoch :  22 loss training:  24.861548580345698 Time :  443
accuracy train: 0.994919 val: 0.934451 test: 0.937743
max validation accuracy : 0.939024 max acc epoch : 20 test accuracy : 0.933074

Epoch :  23 loss training:  19.5726938911248 Time :  460
accuracy train: 0.996443 val: 0.935976 test: 0.935798
max validation accuracy : 0.939024 max acc epoch : 20 test accuracy : 0.933074

Epoch :  24 loss training:  20.69857768647489 Time :  480
accuracy train: 0.996274 val: 0.935976 test: 0.934630
max validation accuracy : 0.939024 max acc epoch : 20 test accuracy : 0.933074

Epoch :  25 loss training:  19.50788824103074 Time :  496
accuracy train: 0.995766 val: 0.932927 test: 0.936187
max validation accuracy : 0.939024 max acc epoch : 20 test accuracy : 0.933074

Epoch :  26 loss training:  19.257679333968554 Time :  513
accuracy train: 0.996443 val: 0.929878 test: 0.935798
max validation accuracy : 0.939024 max acc epoch : 20 test accuracy : 0.933074

Epoch :  27 loss training:  19.2544154181669 Time :  528
accuracy train: 0.996274 val: 0.939024 test: 0.933463
max validation accuracy : 0.939024 max acc epoch : 20 test accuracy : 0.933074

Epoch :  28 loss training:  18.283816245530033 Time :  540
accuracy train: 0.996612 val: 0.937500 test: 0.935019
max validation accuracy : 0.939024 max acc epoch : 20 test accuracy : 0.933074

Epoch :  29 loss training:  18.94262237183284 Time :  560
accuracy train: 0.996443 val: 0.937500 test: 0.933852
max validation accuracy : 0.939024 max acc epoch : 20 test accuracy : 0.933074

Epoch :  30 loss training:  18.68072554844548 Time :  578
accuracy train: 0.996612 val: 0.932927 test: 0.933074
max validation accuracy : 0.939024 max acc epoch : 20 test accuracy : 0.933074

Epoch :  31 loss training:  16.895520330115687 Time :  596
accuracy train: 0.996612 val: 0.931402 test: 0.933074
max validation accuracy : 0.939024 max acc epoch : 20 test accuracy : 0.933074

Epoch :  32 loss training:  18.77270597711322 Time :  613
accuracy train: 0.996782 val: 0.935976 test: 0.935019
max validation accuracy : 0.939024 max acc epoch : 20 test accuracy : 0.933074

Epoch :  33 loss training:  15.97121175628854 Time :  632
accuracy train: 0.996612 val: 0.937500 test: 0.931518
max validation accuracy : 0.939024 max acc epoch : 20 test accuracy : 0.933074

Epoch :  34 loss training:  17.45370891453058 Time :  652
accuracy train: 0.996951 val: 0.935976 test: 0.934241
max validation accuracy : 0.939024 max acc epoch : 20 test accuracy : 0.933074

Epoch :  35 loss training:  16.688771210378036 Time :  669
accuracy train: 0.996612 val: 0.935976 test: 0.932685
max validation accuracy : 0.939024 max acc epoch : 20 test accuracy : 0.933074

Epoch :  36 loss training:  16.30813954147743 Time :  686
accuracy train: 0.996951 val: 0.937500 test: 0.931518
max validation accuracy : 0.939024 max acc epoch : 20 test accuracy : 0.933074

Epoch :  37 loss training:  16.28268473711796 Time :  703
accuracy train: 0.996782 val: 0.940549 test: 0.932685
max validation accuracy : 0.940549 max acc epoch : 37 test accuracy : 0.932685

Epoch :  38 loss training:  15.564220460713841 Time :  721
accuracy train: 0.996782 val: 0.943598 test: 0.935798
max validation accuracy : 0.943598 max acc epoch : 38 test accuracy : 0.935798

Epoch :  39 loss training:  17.270768558373675 Time :  743
accuracy train: 0.997121 val: 0.937500 test: 0.935409
max validation accuracy : 0.943598 max acc epoch : 38 test accuracy : 0.935798

Epoch :  40 loss training:  17.052874525921652 Time :  763
accuracy train: 0.997121 val: 0.939024 test: 0.935019
max validation accuracy : 0.943598 max acc epoch : 38 test accuracy : 0.935798

Epoch :  41 loss training:  17.408936014500796 Time :  780
accuracy train: 0.996951 val: 0.937500 test: 0.936187
max validation accuracy : 0.943598 max acc epoch : 38 test accuracy : 0.935798

Epoch :  42 loss training:  17.592390330217313 Time :  796
accuracy train: 0.997121 val: 0.940549 test: 0.933463
max validation accuracy : 0.943598 max acc epoch : 38 test accuracy : 0.935798

Epoch :  43 loss training:  16.644391511159483 Time :  814
accuracy train: 0.996782 val: 0.939024 test: 0.933852
max validation accuracy : 0.943598 max acc epoch : 38 test accuracy : 0.935798

Epoch :  44 loss training:  17.583166554250056 Time :  834
accuracy train: 0.996951 val: 0.943598 test: 0.934630
max validation accuracy : 0.943598 max acc epoch : 38 test accuracy : 0.935798

Epoch :  45 loss training:  16.48349786523613 Time :  855
accuracy train: 0.997121 val: 0.940549 test: 0.933074
max validation accuracy : 0.943598 max acc epoch : 38 test accuracy : 0.935798

Epoch :  46 loss training:  16.38992750379839 Time :  876
accuracy train: 0.997121 val: 0.940549 test: 0.934630
max validation accuracy : 0.943598 max acc epoch : 38 test accuracy : 0.935798

Epoch :  47 loss training:  15.952861243771622 Time :  898
accuracy train: 0.997121 val: 0.945122 test: 0.933463
max validation accuracy : 0.945122 max acc epoch : 47 test accuracy : 0.933463

Epoch :  48 loss training:  16.126590074651176 Time :  915
accuracy train: 0.996951 val: 0.940549 test: 0.933463
max validation accuracy : 0.945122 max acc epoch : 47 test accuracy : 0.933463

Epoch :  49 loss training:  16.72873552587407 Time :  935
accuracy train: 0.997121 val: 0.940549 test: 0.932685
max validation accuracy : 0.945122 max acc epoch : 47 test accuracy : 0.933463

Epoch :  50 loss training:  15.221071531675989 Time :  955
accuracy train: 0.996782 val: 0.940549 test: 0.934630
max validation accuracy : 0.945122 max acc epoch : 47 test accuracy : 0.933463

Epoch :  51 loss training:  16.282278105180012 Time :  974
accuracy train: 0.996951 val: 0.937500 test: 0.935798
max validation accuracy : 0.945122 max acc epoch : 47 test accuracy : 0.933463

Epoch :  52 loss training:  16.05720457312418 Time :  1000
accuracy train: 0.996951 val: 0.939024 test: 0.932685
max validation accuracy : 0.945122 max acc epoch : 47 test accuracy : 0.933463

Epoch :  53 loss training:  15.868517237657215 Time :  1021
accuracy train: 0.996782 val: 0.940549 test: 0.932685
max validation accuracy : 0.945122 max acc epoch : 47 test accuracy : 0.933463

Epoch :  54 loss training:  14.410883475509763 Time :  1040
accuracy train: 0.996951 val: 0.937500 test: 0.935409
max validation accuracy : 0.945122 max acc epoch : 47 test accuracy : 0.933463

Epoch :  55 loss training:  16.22938512309338 Time :  1059
accuracy train: 0.997121 val: 0.940549 test: 0.931518
max validation accuracy : 0.945122 max acc epoch : 47 test accuracy : 0.933463

Epoch :  56 loss training:  17.185682696814183 Time :  1079
accuracy train: 0.996782 val: 0.940549 test: 0.935019
max validation accuracy : 0.945122 max acc epoch : 47 test accuracy : 0.933463

Epoch :  57 loss training:  15.357682691595983 Time :  1098
accuracy train: 0.996951 val: 0.939024 test: 0.933463
max validation accuracy : 0.945122 max acc epoch : 47 test accuracy : 0.933463

Epoch :  58 loss training:  14.534537904299214 Time :  1117
accuracy train: 0.996951 val: 0.937500 test: 0.934241
max validation accuracy : 0.945122 max acc epoch : 47 test accuracy : 0.933463

Epoch :  59 loss training:  14.816222741072124 Time :  1137
accuracy train: 0.996951 val: 0.942073 test: 0.930350
max validation accuracy : 0.945122 max acc epoch : 47 test accuracy : 0.933463

Epoch :  60 loss training:  15.260004324954934 Time :  1163
accuracy train: 0.997121 val: 0.937500 test: 0.937743
max validation accuracy : 0.945122 max acc epoch : 47 test accuracy : 0.933463

Epoch :  61 loss training:  14.226265420409618 Time :  1184
accuracy train: 0.996951 val: 0.937500 test: 0.935409
max validation accuracy : 0.945122 max acc epoch : 47 test accuracy : 0.933463

Epoch :  62 loss training:  14.186181499797385 Time :  1203
accuracy train: 0.996951 val: 0.935976 test: 0.935019
max validation accuracy : 0.945122 max acc epoch : 47 test accuracy : 0.933463

Epoch :  63 loss training:  14.043799233448226 Time :  1223
accuracy train: 0.997121 val: 0.935976 test: 0.933852
max validation accuracy : 0.945122 max acc epoch : 47 test accuracy : 0.933463

Epoch :  64 loss training:  14.644196339708287 Time :  1242
accuracy train: 0.997290 val: 0.935976 test: 0.933852
max validation accuracy : 0.945122 max acc epoch : 47 test accuracy : 0.933463

Epoch :  65 loss training:  16.93498904586886 Time :  1262
accuracy train: 0.996951 val: 0.939024 test: 0.933074
max validation accuracy : 0.945122 max acc epoch : 47 test accuracy : 0.933463

Epoch :  66 loss training:  15.268840081582312 Time :  1289
accuracy train: 0.996951 val: 0.940549 test: 0.934630
max validation accuracy : 0.945122 max acc epoch : 47 test accuracy : 0.933463

Epoch :  67 loss training:  17.394598304352257 Time :  1309
accuracy train: 0.996951 val: 0.937500 test: 0.933852
max validation accuracy : 0.945122 max acc epoch : 47 test accuracy : 0.933463

Epoch :  68 loss training:  14.51090818803641 Time :  1328
accuracy train: 0.997121 val: 0.940549 test: 0.933852
max validation accuracy : 0.945122 max acc epoch : 47 test accuracy : 0.933463

========================================================================================================================================================================================================
max acc epoch :  47
max validation accuracy :  0.9451219512195121
test accuracy :  0.9334630350194553
latest_test_accuracy :  0.933852140077821
========================================================================================================================================================================================================

date and time :  Fri Jan 29 14:54:39 2021
Namespace(batch_size=16, dataset='R52', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=200, lda=True, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=1e-05)
device :  cuda:0
HGNNModel(
  (word_embeddings): Embedding(9333, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=52, bias=True)
    (1): Linear(in_features=200, out_features=52, bias=True)
    (2): Linear(in_features=200, out_features=52, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  360.18630328029394 Time :  17
accuracy train: 0.880081 val: 0.855183 test: 0.859533
max validation accuracy : 0.855183 max acc epoch : 1 test accuracy : 0.859533

Epoch :  2 loss training:  179.34347655437887 Time :  38
accuracy train: 0.911585 val: 0.868902 test: 0.891829
max validation accuracy : 0.868902 max acc epoch : 2 test accuracy : 0.891829

Epoch :  3 loss training:  136.45624768733978 Time :  65
accuracy train: 0.942073 val: 0.902439 test: 0.912062
max validation accuracy : 0.902439 max acc epoch : 3 test accuracy : 0.912062

Epoch :  4 loss training:  112.52825931366533 Time :  85
accuracy train: 0.954438 val: 0.923780 test: 0.919844
max validation accuracy : 0.923780 max acc epoch : 4 test accuracy : 0.919844

Epoch :  5 loss training:  97.79906590282917 Time :  106
accuracy train: 0.963245 val: 0.917683 test: 0.919455
max validation accuracy : 0.923780 max acc epoch : 4 test accuracy : 0.919844

Epoch :  6 loss training:  68.6112465057522 Time :  134
accuracy train: 0.968835 val: 0.928354 test: 0.927237
max validation accuracy : 0.928354 max acc epoch : 6 test accuracy : 0.927237

Epoch :  7 loss training:  62.58863074565306 Time :  157
accuracy train: 0.979844 val: 0.931402 test: 0.927237
max validation accuracy : 0.931402 max acc epoch : 7 test accuracy : 0.927237

Epoch :  8 loss training:  57.09885228029452 Time :  178
accuracy train: 0.979505 val: 0.928354 test: 0.928794
max validation accuracy : 0.931402 max acc epoch : 7 test accuracy : 0.927237

Epoch :  9 loss training:  52.83460252103396 Time :  201
accuracy train: 0.982215 val: 0.931402 test: 0.928016
max validation accuracy : 0.931402 max acc epoch : 7 test accuracy : 0.927237

Epoch :  10 loss training:  46.902802518045064 Time :  222
accuracy train: 0.986958 val: 0.916159 test: 0.929183
max validation accuracy : 0.931402 max acc epoch : 7 test accuracy : 0.927237

Epoch :  11 loss training:  37.735491847619414 Time :  241
accuracy train: 0.989499 val: 0.929878 test: 0.932296
max validation accuracy : 0.931402 max acc epoch : 7 test accuracy : 0.927237

Epoch :  12 loss training:  32.64350779278902 Time :  261
accuracy train: 0.990007 val: 0.932927 test: 0.927626
max validation accuracy : 0.932927 max acc epoch : 12 test accuracy : 0.927626

Epoch :  13 loss training:  30.83209776773583 Time :  289
accuracy train: 0.993733 val: 0.929878 test: 0.928794
max validation accuracy : 0.932927 max acc epoch : 12 test accuracy : 0.927626

Epoch :  14 loss training:  31.79866250627674 Time :  309
accuracy train: 0.994411 val: 0.926829 test: 0.930739
max validation accuracy : 0.932927 max acc epoch : 12 test accuracy : 0.927626

Epoch :  15 loss training:  26.710508109885268 Time :  328
accuracy train: 0.995257 val: 0.929878 test: 0.930350
max validation accuracy : 0.932927 max acc epoch : 12 test accuracy : 0.927626

Epoch :  16 loss training:  22.98186468129279 Time :  347
accuracy train: 0.996274 val: 0.934451 test: 0.930739
max validation accuracy : 0.934451 max acc epoch : 16 test accuracy : 0.930739

Epoch :  17 loss training:  21.85019583092071 Time :  375
accuracy train: 0.996274 val: 0.929878 test: 0.931128
max validation accuracy : 0.934451 max acc epoch : 16 test accuracy : 0.930739

Epoch :  18 loss training:  19.17355742654763 Time :  400
accuracy train: 0.996782 val: 0.929878 test: 0.933852
max validation accuracy : 0.934451 max acc epoch : 16 test accuracy : 0.930739

Epoch :  19 loss training:  21.67525459069293 Time :  419
accuracy train: 0.997121 val: 0.925305 test: 0.932296
max validation accuracy : 0.934451 max acc epoch : 16 test accuracy : 0.930739

Epoch :  20 loss training:  18.500281077227555 Time :  447
accuracy train: 0.997459 val: 0.929878 test: 0.936187
max validation accuracy : 0.934451 max acc epoch : 16 test accuracy : 0.930739

Epoch :  21 loss training:  17.108017206017394 Time :  496
accuracy train: 0.997290 val: 0.932927 test: 0.934241
max validation accuracy : 0.934451 max acc epoch : 16 test accuracy : 0.930739

Epoch :  22 loss training:  17.117970534120104 Time :  536
accuracy train: 0.997290 val: 0.929878 test: 0.934241
max validation accuracy : 0.934451 max acc epoch : 16 test accuracy : 0.930739

Epoch :  23 loss training:  15.828509528713766 Time :  560
accuracy train: 0.997459 val: 0.934451 test: 0.933074
max validation accuracy : 0.934451 max acc epoch : 16 test accuracy : 0.930739

Epoch :  24 loss training:  16.01913431310095 Time :  581
accuracy train: 0.997629 val: 0.928354 test: 0.932296
max validation accuracy : 0.934451 max acc epoch : 16 test accuracy : 0.930739

Epoch :  25 loss training:  14.355266464190208 Time :  602
accuracy train: 0.997629 val: 0.929878 test: 0.933463
max validation accuracy : 0.934451 max acc epoch : 16 test accuracy : 0.930739

Epoch :  26 loss training:  12.290471983651514 Time :  627
accuracy train: 0.997459 val: 0.931402 test: 0.932685
max validation accuracy : 0.934451 max acc epoch : 16 test accuracy : 0.930739

Epoch :  27 loss training:  14.332220712225535 Time :  646
accuracy train: 0.997629 val: 0.932927 test: 0.934241
max validation accuracy : 0.934451 max acc epoch : 16 test accuracy : 0.930739

Epoch :  28 loss training:  13.636743647664844 Time :  665
accuracy train: 0.997629 val: 0.932927 test: 0.933074
max validation accuracy : 0.934451 max acc epoch : 16 test accuracy : 0.930739

Epoch :  29 loss training:  12.75010116523481 Time :  686
accuracy train: 0.997459 val: 0.926829 test: 0.933074
max validation accuracy : 0.934451 max acc epoch : 16 test accuracy : 0.930739

Epoch :  30 loss training:  12.234022652206477 Time :  717
accuracy train: 0.997629 val: 0.928354 test: 0.934241
max validation accuracy : 0.934451 max acc epoch : 16 test accuracy : 0.930739

Epoch :  31 loss training:  12.97578457641066 Time :  759
accuracy train: 0.997629 val: 0.929878 test: 0.931518
max validation accuracy : 0.934451 max acc epoch : 16 test accuracy : 0.930739

Epoch :  32 loss training:  11.747098394378554 Time :  795
accuracy train: 0.997798 val: 0.928354 test: 0.932296
max validation accuracy : 0.934451 max acc epoch : 16 test accuracy : 0.930739

Epoch :  33 loss training:  12.106493843355565 Time :  839
accuracy train: 0.997798 val: 0.928354 test: 0.932296
max validation accuracy : 0.934451 max acc epoch : 16 test accuracy : 0.930739

Epoch :  34 loss training:  12.888900151912821 Time :  888
accuracy train: 0.997798 val: 0.931402 test: 0.934630
max validation accuracy : 0.934451 max acc epoch : 16 test accuracy : 0.930739

Epoch :  35 loss training:  12.975232218283054 Time :  938
accuracy train: 0.997798 val: 0.928354 test: 0.932296
max validation accuracy : 0.934451 max acc epoch : 16 test accuracy : 0.930739

Epoch :  36 loss training:  13.100859767655493 Time :  989
accuracy train: 0.997798 val: 0.931402 test: 0.932296
max validation accuracy : 0.934451 max acc epoch : 16 test accuracy : 0.930739

Epoch :  37 loss training:  12.618638835469028 Time :  1026
accuracy train: 0.997798 val: 0.932927 test: 0.934241
max validation accuracy : 0.934451 max acc epoch : 16 test accuracy : 0.930739

========================================================================================================================================================================================================
max acc epoch :  16
max validation accuracy :  0.9344512195121951
test accuracy :  0.930739299610895
latest_test_accuracy :  0.9342412451361868
========================================================================================================================================================================================================

date and time :  Fri Jan 29 15:11:59 2021
Namespace(batch_size=16, dataset='R52', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=True, seed=0, weight_decay=1e-05)
device :  cuda:0
HGNNModel(
  (word_embeddings): Embedding(9333, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=52, bias=True)
    (1): Linear(in_features=200, out_features=52, bias=True)
    (2): Linear(in_features=200, out_features=52, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  458.7833019644022 Time :  17
accuracy train: 0.847392 val: 0.835366 test: 0.820623
max validation accuracy : 0.835366 max acc epoch : 1 test accuracy : 0.820623

Epoch :  2 loss training:  245.55047308839858 Time :  38
accuracy train: 0.918022 val: 0.850610 test: 0.850195
max validation accuracy : 0.850610 max acc epoch : 2 test accuracy : 0.850195

Epoch :  3 loss training:  161.71416077762842 Time :  55
accuracy train: 0.959519 val: 0.884146 test: 0.869650
max validation accuracy : 0.884146 max acc epoch : 3 test accuracy : 0.869650

Epoch :  4 loss training:  107.88187967985868 Time :  74
accuracy train: 0.978828 val: 0.893293 test: 0.879377
max validation accuracy : 0.893293 max acc epoch : 4 test accuracy : 0.879377

Epoch :  5 loss training:  73.53355796914548 Time :  96
accuracy train: 0.988482 val: 0.905488 test: 0.893385
max validation accuracy : 0.905488 max acc epoch : 5 test accuracy : 0.893385

Epoch :  6 loss training:  43.37390500571928 Time :  118
accuracy train: 0.995935 val: 0.917683 test: 0.894942
max validation accuracy : 0.917683 max acc epoch : 6 test accuracy : 0.894942

Epoch :  7 loss training:  29.6586419318337 Time :  136
accuracy train: 0.996104 val: 0.914634 test: 0.901946
max validation accuracy : 0.917683 max acc epoch : 6 test accuracy : 0.894942

Epoch :  8 loss training:  28.07691069530847 Time :  156
accuracy train: 0.998137 val: 0.913110 test: 0.896109
max validation accuracy : 0.917683 max acc epoch : 6 test accuracy : 0.894942

Epoch :  9 loss training:  23.30536787181336 Time :  174
accuracy train: 0.996782 val: 0.916159 test: 0.897665
max validation accuracy : 0.917683 max acc epoch : 6 test accuracy : 0.894942

Epoch :  10 loss training:  20.89178161637392 Time :  198
accuracy train: 0.998137 val: 0.920732 test: 0.895720
max validation accuracy : 0.920732 max acc epoch : 10 test accuracy : 0.895720

Epoch :  11 loss training:  14.592787316069007 Time :  217
accuracy train: 0.997967 val: 0.926829 test: 0.899611
max validation accuracy : 0.926829 max acc epoch : 11 test accuracy : 0.899611

Epoch :  12 loss training:  12.758281549686217 Time :  236
accuracy train: 0.998814 val: 0.923780 test: 0.898833
max validation accuracy : 0.926829 max acc epoch : 11 test accuracy : 0.899611

Epoch :  13 loss training:  9.64483753812965 Time :  254
accuracy train: 0.998814 val: 0.923780 test: 0.903113
max validation accuracy : 0.926829 max acc epoch : 11 test accuracy : 0.899611

Epoch :  14 loss training:  9.882546190267021 Time :  276
accuracy train: 0.998814 val: 0.913110 test: 0.900389
max validation accuracy : 0.926829 max acc epoch : 11 test accuracy : 0.899611

Epoch :  15 loss training:  9.652069226740423 Time :  299
accuracy train: 0.997967 val: 0.922256 test: 0.900778
max validation accuracy : 0.926829 max acc epoch : 11 test accuracy : 0.899611

Epoch :  16 loss training:  8.214682707948668 Time :  321
accuracy train: 0.998814 val: 0.916159 test: 0.895720
max validation accuracy : 0.926829 max acc epoch : 11 test accuracy : 0.899611

Epoch :  17 loss training:  6.412033984819573 Time :  340
accuracy train: 0.998984 val: 0.914634 test: 0.901556
max validation accuracy : 0.926829 max acc epoch : 11 test accuracy : 0.899611

Epoch :  18 loss training:  6.9215076517284615 Time :  359
accuracy train: 0.999153 val: 0.919207 test: 0.903113
max validation accuracy : 0.926829 max acc epoch : 11 test accuracy : 0.899611

Epoch :  19 loss training:  7.4156680380838225 Time :  382
accuracy train: 0.998814 val: 0.920732 test: 0.900000
max validation accuracy : 0.926829 max acc epoch : 11 test accuracy : 0.899611

Epoch :  20 loss training:  6.541273236442066 Time :  406
accuracy train: 0.999153 val: 0.923780 test: 0.905058
max validation accuracy : 0.926829 max acc epoch : 11 test accuracy : 0.899611

Epoch :  21 loss training:  5.799213461461477 Time :  425
accuracy train: 0.998984 val: 0.919207 test: 0.902335
max validation accuracy : 0.926829 max acc epoch : 11 test accuracy : 0.899611

Epoch :  22 loss training:  6.045038333228149 Time :  444
accuracy train: 0.999153 val: 0.926829 test: 0.904280
max validation accuracy : 0.926829 max acc epoch : 11 test accuracy : 0.899611

Epoch :  23 loss training:  4.7590948247598135 Time :  464
accuracy train: 0.999153 val: 0.925305 test: 0.901946
max validation accuracy : 0.926829 max acc epoch : 11 test accuracy : 0.899611

Epoch :  24 loss training:  5.171310185185575 Time :  482
accuracy train: 0.998984 val: 0.923780 test: 0.902724
max validation accuracy : 0.926829 max acc epoch : 11 test accuracy : 0.899611

Epoch :  25 loss training:  4.47454981572082 Time :  499
accuracy train: 0.999153 val: 0.923780 test: 0.905837
max validation accuracy : 0.926829 max acc epoch : 11 test accuracy : 0.899611

Epoch :  26 loss training:  3.7960516319544695 Time :  518
accuracy train: 0.999153 val: 0.922256 test: 0.905447
max validation accuracy : 0.926829 max acc epoch : 11 test accuracy : 0.899611

Epoch :  27 loss training:  5.2255268561866615 Time :  537
accuracy train: 0.999153 val: 0.923780 test: 0.904669
max validation accuracy : 0.926829 max acc epoch : 11 test accuracy : 0.899611

Epoch :  28 loss training:  4.547747288333994 Time :  560
accuracy train: 0.999153 val: 0.920732 test: 0.904669
max validation accuracy : 0.926829 max acc epoch : 11 test accuracy : 0.899611

Epoch :  29 loss training:  4.388697602948014 Time :  579
accuracy train: 0.999153 val: 0.923780 test: 0.901946
max validation accuracy : 0.926829 max acc epoch : 11 test accuracy : 0.899611

Epoch :  30 loss training:  4.688900543829732 Time :  602
accuracy train: 0.999153 val: 0.926829 test: 0.905837
max validation accuracy : 0.926829 max acc epoch : 11 test accuracy : 0.899611

Epoch :  31 loss training:  3.8599197982475744 Time :  622
accuracy train: 0.999153 val: 0.920732 test: 0.903502
max validation accuracy : 0.926829 max acc epoch : 11 test accuracy : 0.899611

Epoch :  32 loss training:  5.308564499464865 Time :  641
accuracy train: 0.999153 val: 0.920732 test: 0.903891
max validation accuracy : 0.926829 max acc epoch : 11 test accuracy : 0.899611

========================================================================================================================================================================================================
max acc epoch :  11
max validation accuracy :  0.926829268292683
test accuracy :  0.8996108949416343
latest_test_accuracy :  0.9038910505836576
========================================================================================================================================================================================================

date and time :  Fri Jan 29 15:22:50 2021
Namespace(batch_size=16, dataset='R52', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=100, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=1e-05)
device :  cuda:0
HGNNModel(
  (word_embeddings): Embedding(9333, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=52, bias=True)
    (1): Linear(in_features=100, out_features=52, bias=True)
    (2): Linear(in_features=100, out_features=52, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  419.87176717072725 Time :  17
accuracy train: 0.864160 val: 0.836890 test: 0.849027
max validation accuracy : 0.836890 max acc epoch : 1 test accuracy : 0.849027

Epoch :  2 loss training:  212.18478609621525 Time :  42
accuracy train: 0.903625 val: 0.873476 test: 0.891051
max validation accuracy : 0.873476 max acc epoch : 2 test accuracy : 0.891051

Epoch :  3 loss training:  170.15919985249639 Time :  60
accuracy train: 0.926491 val: 0.899390 test: 0.903502
max validation accuracy : 0.899390 max acc epoch : 3 test accuracy : 0.903502

Epoch :  4 loss training:  132.6428194437176 Time :  79
accuracy train: 0.945461 val: 0.897866 test: 0.917121
max validation accuracy : 0.899390 max acc epoch : 3 test accuracy : 0.903502

Epoch :  5 loss training:  110.38425669819117 Time :  98
accuracy train: 0.958841 val: 0.926829 test: 0.927626
max validation accuracy : 0.926829 max acc epoch : 5 test accuracy : 0.927626

Epoch :  6 loss training:  83.48926719743758 Time :  118
accuracy train: 0.966972 val: 0.923780 test: 0.930350
max validation accuracy : 0.926829 max acc epoch : 5 test accuracy : 0.927626

Epoch :  7 loss training:  73.45557760482188 Time :  143
accuracy train: 0.969851 val: 0.934451 test: 0.934630
max validation accuracy : 0.934451 max acc epoch : 7 test accuracy : 0.934630

Epoch :  8 loss training:  70.56367400055751 Time :  163
accuracy train: 0.972561 val: 0.928354 test: 0.935019
max validation accuracy : 0.934451 max acc epoch : 7 test accuracy : 0.934630

Epoch :  9 loss training:  63.88634717557579 Time :  181
accuracy train: 0.976795 val: 0.925305 test: 0.937354
max validation accuracy : 0.934451 max acc epoch : 7 test accuracy : 0.934630

Epoch :  10 loss training:  58.58276404696517 Time :  199
accuracy train: 0.979844 val: 0.931402 test: 0.938132
max validation accuracy : 0.934451 max acc epoch : 7 test accuracy : 0.934630

Epoch :  11 loss training:  50.471645436482504 Time :  217
accuracy train: 0.982215 val: 0.925305 test: 0.939300
max validation accuracy : 0.934451 max acc epoch : 7 test accuracy : 0.934630

Epoch :  12 loss training:  44.76686115167104 Time :  239
accuracy train: 0.984587 val: 0.934451 test: 0.940856
max validation accuracy : 0.934451 max acc epoch : 7 test accuracy : 0.934630

Epoch :  13 loss training:  43.32380833057687 Time :  259
accuracy train: 0.986958 val: 0.931402 test: 0.937743
max validation accuracy : 0.934451 max acc epoch : 7 test accuracy : 0.934630

Epoch :  14 loss training:  42.63387842592783 Time :  277
accuracy train: 0.987127 val: 0.928354 test: 0.940078
max validation accuracy : 0.934451 max acc epoch : 7 test accuracy : 0.934630

Epoch :  15 loss training:  39.335446308832616 Time :  294
accuracy train: 0.988313 val: 0.934451 test: 0.938132
max validation accuracy : 0.934451 max acc epoch : 7 test accuracy : 0.934630

Epoch :  16 loss training:  36.80229726003017 Time :  312
accuracy train: 0.989329 val: 0.928354 test: 0.942023
max validation accuracy : 0.934451 max acc epoch : 7 test accuracy : 0.934630

Epoch :  17 loss training:  34.08859471831238 Time :  329
accuracy train: 0.991023 val: 0.929878 test: 0.939300
max validation accuracy : 0.934451 max acc epoch : 7 test accuracy : 0.934630

Epoch :  18 loss training:  31.926580322440714 Time :  349
accuracy train: 0.990515 val: 0.929878 test: 0.944747
max validation accuracy : 0.934451 max acc epoch : 7 test accuracy : 0.934630

Epoch :  19 loss training:  33.34366484032944 Time :  371
accuracy train: 0.991362 val: 0.929878 test: 0.942023
max validation accuracy : 0.934451 max acc epoch : 7 test accuracy : 0.934630

Epoch :  20 loss training:  30.239480091724545 Time :  389
accuracy train: 0.990515 val: 0.932927 test: 0.940467
max validation accuracy : 0.934451 max acc epoch : 7 test accuracy : 0.934630

Epoch :  21 loss training:  28.651635223301128 Time :  405
accuracy train: 0.991362 val: 0.929878 test: 0.937354
max validation accuracy : 0.934451 max acc epoch : 7 test accuracy : 0.934630

Epoch :  22 loss training:  28.95764887635596 Time :  423
accuracy train: 0.990684 val: 0.935976 test: 0.938911
max validation accuracy : 0.935976 max acc epoch : 22 test accuracy : 0.938911

Epoch :  23 loss training:  28.729763106915925 Time :  440
accuracy train: 0.992547 val: 0.931402 test: 0.940856
max validation accuracy : 0.935976 max acc epoch : 22 test accuracy : 0.938911

Epoch :  24 loss training:  27.24164331681095 Time :  458
accuracy train: 0.992547 val: 0.934451 test: 0.940856
max validation accuracy : 0.935976 max acc epoch : 22 test accuracy : 0.938911

Epoch :  25 loss training:  24.212919857585803 Time :  474
accuracy train: 0.992547 val: 0.934451 test: 0.940467
max validation accuracy : 0.935976 max acc epoch : 22 test accuracy : 0.938911

Epoch :  26 loss training:  23.225052600959316 Time :  493
accuracy train: 0.992209 val: 0.939024 test: 0.940856
max validation accuracy : 0.939024 max acc epoch : 26 test accuracy : 0.940856

Epoch :  27 loss training:  26.7867267630063 Time :  510
accuracy train: 0.992886 val: 0.935976 test: 0.940467
max validation accuracy : 0.939024 max acc epoch : 26 test accuracy : 0.940856

Epoch :  28 loss training:  25.808389183715917 Time :  526
accuracy train: 0.993225 val: 0.935976 test: 0.940467
max validation accuracy : 0.939024 max acc epoch : 26 test accuracy : 0.940856

Epoch :  29 loss training:  22.929279214018607 Time :  543
accuracy train: 0.993394 val: 0.934451 test: 0.940856
max validation accuracy : 0.939024 max acc epoch : 26 test accuracy : 0.940856

Epoch :  30 loss training:  24.345544199895812 Time :  561
accuracy train: 0.992209 val: 0.937500 test: 0.940856
max validation accuracy : 0.939024 max acc epoch : 26 test accuracy : 0.940856

Epoch :  31 loss training:  25.05054764461238 Time :  580
accuracy train: 0.992378 val: 0.935976 test: 0.938911
max validation accuracy : 0.939024 max acc epoch : 26 test accuracy : 0.940856

Epoch :  32 loss training:  24.267762015457265 Time :  600
accuracy train: 0.993564 val: 0.934451 test: 0.940856
max validation accuracy : 0.939024 max acc epoch : 26 test accuracy : 0.940856

Epoch :  33 loss training:  23.764888245263137 Time :  625
accuracy train: 0.993564 val: 0.935976 test: 0.942023
max validation accuracy : 0.939024 max acc epoch : 26 test accuracy : 0.940856

Epoch :  34 loss training:  23.224363667482976 Time :  645
accuracy train: 0.992717 val: 0.934451 test: 0.942412
max validation accuracy : 0.939024 max acc epoch : 26 test accuracy : 0.940856

Epoch :  35 loss training:  21.902478466159664 Time :  662
accuracy train: 0.993394 val: 0.935976 test: 0.941634
max validation accuracy : 0.939024 max acc epoch : 26 test accuracy : 0.940856

Epoch :  36 loss training:  22.92932031719829 Time :  681
accuracy train: 0.994072 val: 0.935976 test: 0.941634
max validation accuracy : 0.939024 max acc epoch : 26 test accuracy : 0.940856

Epoch :  37 loss training:  23.34225695458008 Time :  699
accuracy train: 0.993902 val: 0.935976 test: 0.938911
max validation accuracy : 0.939024 max acc epoch : 26 test accuracy : 0.940856

Epoch :  38 loss training:  22.97766067041084 Time :  717
accuracy train: 0.994411 val: 0.934451 test: 0.941634
max validation accuracy : 0.939024 max acc epoch : 26 test accuracy : 0.940856

Epoch :  39 loss training:  24.2105488620291 Time :  739
accuracy train: 0.993733 val: 0.935976 test: 0.939689
max validation accuracy : 0.939024 max acc epoch : 26 test accuracy : 0.940856

Epoch :  40 loss training:  21.99178157170536 Time :  762
accuracy train: 0.993733 val: 0.934451 test: 0.940078
max validation accuracy : 0.939024 max acc epoch : 26 test accuracy : 0.940856

Epoch :  41 loss training:  22.06340438252664 Time :  777
accuracy train: 0.993733 val: 0.932927 test: 0.940467
max validation accuracy : 0.939024 max acc epoch : 26 test accuracy : 0.940856

Epoch :  42 loss training:  21.840158867416903 Time :  799
accuracy train: 0.993225 val: 0.934451 test: 0.940078
max validation accuracy : 0.939024 max acc epoch : 26 test accuracy : 0.940856

Epoch :  43 loss training:  20.8079606522806 Time :  822
accuracy train: 0.993564 val: 0.935976 test: 0.941634
max validation accuracy : 0.939024 max acc epoch : 26 test accuracy : 0.940856

Epoch :  44 loss training:  21.275829736783635 Time :  843
accuracy train: 0.994411 val: 0.932927 test: 0.940078
max validation accuracy : 0.939024 max acc epoch : 26 test accuracy : 0.940856

Epoch :  45 loss training:  22.827160190150607 Time :  861
accuracy train: 0.994411 val: 0.934451 test: 0.940856
max validation accuracy : 0.939024 max acc epoch : 26 test accuracy : 0.940856

Epoch :  46 loss training:  21.069865156605374 Time :  879
accuracy train: 0.994580 val: 0.934451 test: 0.940467
max validation accuracy : 0.939024 max acc epoch : 26 test accuracy : 0.940856

Epoch :  47 loss training:  22.22412899241317 Time :  897
accuracy train: 0.994072 val: 0.934451 test: 0.942802
max validation accuracy : 0.939024 max acc epoch : 26 test accuracy : 0.940856

========================================================================================================================================================================================================
max acc epoch :  26
max validation accuracy :  0.9390243902439024
test accuracy :  0.9408560311284047
latest_test_accuracy :  0.9428015564202334
========================================================================================================================================================================================================

date and time :  Fri Jan 29 15:37:55 2021
Namespace(batch_size=16, dataset='R52', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=100, lda=True, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=1e-05)
device :  cuda:0
HGNNModel(
  (word_embeddings): Embedding(9333, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=52, bias=True)
    (1): Linear(in_features=100, out_features=52, bias=True)
    (2): Linear(in_features=100, out_features=52, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  375.4735098555684 Time :  17
accuracy train: 0.881775 val: 0.871951 test: 0.871595
max validation accuracy : 0.871951 max acc epoch : 1 test accuracy : 0.871595

Epoch :  2 loss training:  189.29198438487947 Time :  37
accuracy train: 0.908367 val: 0.878049 test: 0.886770
max validation accuracy : 0.878049 max acc epoch : 2 test accuracy : 0.886770

Epoch :  3 loss training:  140.2200372274965 Time :  61
accuracy train: 0.934451 val: 0.907012 test: 0.915564
max validation accuracy : 0.907012 max acc epoch : 3 test accuracy : 0.915564

Epoch :  4 loss training:  111.70281941257417 Time :  72
accuracy train: 0.958672 val: 0.928354 test: 0.926848
max validation accuracy : 0.928354 max acc epoch : 4 test accuracy : 0.926848

Epoch :  5 loss training:  94.11409886553884 Time :  89
accuracy train: 0.957486 val: 0.913110 test: 0.930739
max validation accuracy : 0.928354 max acc epoch : 4 test accuracy : 0.926848

Epoch :  6 loss training:  74.16498500108719 Time :  107
accuracy train: 0.969682 val: 0.932927 test: 0.935019
max validation accuracy : 0.932927 max acc epoch : 6 test accuracy : 0.935019

Epoch :  7 loss training:  65.0892337183468 Time :  125
accuracy train: 0.973747 val: 0.928354 test: 0.940467
max validation accuracy : 0.932927 max acc epoch : 6 test accuracy : 0.935019

Epoch :  8 loss training:  57.735455956775695 Time :  145
accuracy train: 0.977304 val: 0.932927 test: 0.934630
max validation accuracy : 0.932927 max acc epoch : 6 test accuracy : 0.935019

Epoch :  9 loss training:  51.77873683674261 Time :  166
accuracy train: 0.979844 val: 0.928354 test: 0.940078
max validation accuracy : 0.932927 max acc epoch : 6 test accuracy : 0.935019

Epoch :  10 loss training:  49.33040306344628 Time :  184
accuracy train: 0.982046 val: 0.942073 test: 0.938911
max validation accuracy : 0.942073 max acc epoch : 10 test accuracy : 0.938911

Epoch :  11 loss training:  41.97852668724954 Time :  201
accuracy train: 0.986280 val: 0.937500 test: 0.940856
max validation accuracy : 0.942073 max acc epoch : 10 test accuracy : 0.938911

Epoch :  12 loss training:  34.40440498996759 Time :  218
accuracy train: 0.987805 val: 0.940549 test: 0.941634
max validation accuracy : 0.942073 max acc epoch : 10 test accuracy : 0.938911

Epoch :  13 loss training:  34.01742928248132 Time :  237
accuracy train: 0.988144 val: 0.939024 test: 0.940856
max validation accuracy : 0.942073 max acc epoch : 10 test accuracy : 0.938911

Epoch :  14 loss training:  33.4156788631808 Time :  258
accuracy train: 0.990854 val: 0.942073 test: 0.938911
max validation accuracy : 0.942073 max acc epoch : 10 test accuracy : 0.938911

Epoch :  15 loss training:  31.791953092673793 Time :  277
accuracy train: 0.991701 val: 0.942073 test: 0.940078
max validation accuracy : 0.942073 max acc epoch : 10 test accuracy : 0.938911

Epoch :  16 loss training:  29.625471890205517 Time :  296
accuracy train: 0.992378 val: 0.942073 test: 0.941245
max validation accuracy : 0.942073 max acc epoch : 10 test accuracy : 0.938911

Epoch :  17 loss training:  28.988669393234886 Time :  316
accuracy train: 0.992886 val: 0.942073 test: 0.941245
max validation accuracy : 0.942073 max acc epoch : 10 test accuracy : 0.938911

Epoch :  18 loss training:  27.720910869073123 Time :  339
accuracy train: 0.992209 val: 0.948171 test: 0.940467
max validation accuracy : 0.948171 max acc epoch : 18 test accuracy : 0.940467

Epoch :  19 loss training:  25.55134709610138 Time :  356
accuracy train: 0.992717 val: 0.942073 test: 0.940856
max validation accuracy : 0.948171 max acc epoch : 18 test accuracy : 0.940467

Epoch :  20 loss training:  24.59756466682302 Time :  374
accuracy train: 0.991870 val: 0.942073 test: 0.940078
max validation accuracy : 0.948171 max acc epoch : 18 test accuracy : 0.940467

Epoch :  21 loss training:  22.563328280841233 Time :  390
accuracy train: 0.993733 val: 0.943598 test: 0.941245
max validation accuracy : 0.948171 max acc epoch : 18 test accuracy : 0.940467

Epoch :  22 loss training:  21.607494446041528 Time :  408
accuracy train: 0.992547 val: 0.945122 test: 0.941634
max validation accuracy : 0.948171 max acc epoch : 18 test accuracy : 0.940467

Epoch :  23 loss training:  22.06747776607517 Time :  426
accuracy train: 0.994919 val: 0.939024 test: 0.940078
max validation accuracy : 0.948171 max acc epoch : 18 test accuracy : 0.940467

Epoch :  24 loss training:  22.68132801289903 Time :  443
accuracy train: 0.994072 val: 0.940549 test: 0.939689
max validation accuracy : 0.948171 max acc epoch : 18 test accuracy : 0.940467

Epoch :  25 loss training:  20.45914587599691 Time :  461
accuracy train: 0.993733 val: 0.940549 test: 0.941634
max validation accuracy : 0.948171 max acc epoch : 18 test accuracy : 0.940467

Epoch :  26 loss training:  21.33058899421303 Time :  478
accuracy train: 0.994580 val: 0.939024 test: 0.940078
max validation accuracy : 0.948171 max acc epoch : 18 test accuracy : 0.940467

Epoch :  27 loss training:  19.80688424431719 Time :  494
accuracy train: 0.995088 val: 0.939024 test: 0.940856
max validation accuracy : 0.948171 max acc epoch : 18 test accuracy : 0.940467

Epoch :  28 loss training:  20.226404568122234 Time :  511
accuracy train: 0.995257 val: 0.945122 test: 0.942023
max validation accuracy : 0.948171 max acc epoch : 18 test accuracy : 0.940467

Epoch :  29 loss training:  19.60735639053746 Time :  530
accuracy train: 0.994919 val: 0.942073 test: 0.940467
max validation accuracy : 0.948171 max acc epoch : 18 test accuracy : 0.940467

Epoch :  30 loss training:  19.089063532068394 Time :  548
accuracy train: 0.994580 val: 0.945122 test: 0.942802
max validation accuracy : 0.948171 max acc epoch : 18 test accuracy : 0.940467

Epoch :  31 loss training:  18.453985934262164 Time :  567
accuracy train: 0.995088 val: 0.940549 test: 0.940467
max validation accuracy : 0.948171 max acc epoch : 18 test accuracy : 0.940467

Epoch :  32 loss training:  18.000617634912487 Time :  590
accuracy train: 0.995596 val: 0.942073 test: 0.940467
max validation accuracy : 0.948171 max acc epoch : 18 test accuracy : 0.940467

Epoch :  33 loss training:  17.88568115985254 Time :  622
accuracy train: 0.995596 val: 0.945122 test: 0.938911
max validation accuracy : 0.948171 max acc epoch : 18 test accuracy : 0.940467

Epoch :  34 loss training:  20.055687387488433 Time :  658
accuracy train: 0.995088 val: 0.943598 test: 0.942802
max validation accuracy : 0.948171 max acc epoch : 18 test accuracy : 0.940467

Epoch :  35 loss training:  18.300291169260163 Time :  687
accuracy train: 0.995427 val: 0.942073 test: 0.939300
max validation accuracy : 0.948171 max acc epoch : 18 test accuracy : 0.940467

Epoch :  36 loss training:  18.885288596211467 Time :  718
accuracy train: 0.995427 val: 0.943598 test: 0.941634
max validation accuracy : 0.948171 max acc epoch : 18 test accuracy : 0.940467

Epoch :  37 loss training:  16.610010441567283 Time :  757
accuracy train: 0.995766 val: 0.945122 test: 0.940856
max validation accuracy : 0.948171 max acc epoch : 18 test accuracy : 0.940467

Epoch :  38 loss training:  16.665483727760147 Time :  779
accuracy train: 0.994749 val: 0.942073 test: 0.940467
max validation accuracy : 0.948171 max acc epoch : 18 test accuracy : 0.940467

Epoch :  39 loss training:  17.652416231809184 Time :  795
accuracy train: 0.995257 val: 0.943598 test: 0.941245
max validation accuracy : 0.948171 max acc epoch : 18 test accuracy : 0.940467

========================================================================================================================================================================================================
max acc epoch :  18
max validation accuracy :  0.948170731707317
test accuracy :  0.9404669260700389
latest_test_accuracy :  0.9412451361867704
========================================================================================================================================================================================================

date and time :  Fri Jan 29 15:51:24 2021
Namespace(batch_size=16, dataset='R52', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=100, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=True, seed=0, weight_decay=1e-05)
device :  cuda:0
HGNNModel(
  (word_embeddings): Embedding(9333, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=52, bias=True)
    (1): Linear(in_features=100, out_features=52, bias=True)
    (2): Linear(in_features=100, out_features=52, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  469.21224308013916 Time :  15
accuracy train: 0.857046 val: 0.827744 test: 0.824514
max validation accuracy : 0.827744 max acc epoch : 1 test accuracy : 0.824514

Epoch :  2 loss training:  236.35920502059162 Time :  35
accuracy train: 0.927507 val: 0.882622 test: 0.875875
max validation accuracy : 0.882622 max acc epoch : 2 test accuracy : 0.875875

Epoch :  3 loss training:  141.89957263879478 Time :  53
accuracy train: 0.959519 val: 0.897866 test: 0.893774
max validation accuracy : 0.897866 max acc epoch : 3 test accuracy : 0.893774

Epoch :  4 loss training:  97.64407594851218 Time :  71
accuracy train: 0.974932 val: 0.908537 test: 0.897276
max validation accuracy : 0.908537 max acc epoch : 4 test accuracy : 0.897276

Epoch :  5 loss training:  67.18087424291298 Time :  84
accuracy train: 0.989499 val: 0.907012 test: 0.906226
max validation accuracy : 0.908537 max acc epoch : 4 test accuracy : 0.897276

Epoch :  6 loss training:  39.109560505487025 Time :  102
accuracy train: 0.991870 val: 0.920732 test: 0.910117
max validation accuracy : 0.920732 max acc epoch : 6 test accuracy : 0.910117

Epoch :  7 loss training:  32.386423578544054 Time :  117
accuracy train: 0.994411 val: 0.928354 test: 0.909339
max validation accuracy : 0.928354 max acc epoch : 7 test accuracy : 0.909339

Epoch :  8 loss training:  25.419773367291782 Time :  133
accuracy train: 0.997121 val: 0.926829 test: 0.915564
max validation accuracy : 0.928354 max acc epoch : 7 test accuracy : 0.909339

Epoch :  9 loss training:  20.1895930392202 Time :  152
accuracy train: 0.997967 val: 0.922256 test: 0.919844
max validation accuracy : 0.928354 max acc epoch : 7 test accuracy : 0.909339

Epoch :  10 loss training:  20.876945300027728 Time :  169
accuracy train: 0.997629 val: 0.923780 test: 0.913230
max validation accuracy : 0.928354 max acc epoch : 7 test accuracy : 0.909339

Epoch :  11 loss training:  16.8993244417361 Time :  187
accuracy train: 0.998476 val: 0.923780 test: 0.917899
max validation accuracy : 0.928354 max acc epoch : 7 test accuracy : 0.909339

Epoch :  12 loss training:  12.364741767800297 Time :  205
accuracy train: 0.998814 val: 0.923780 test: 0.916732
max validation accuracy : 0.928354 max acc epoch : 7 test accuracy : 0.909339

Epoch :  13 loss training:  10.516392294834077 Time :  222
accuracy train: 0.999153 val: 0.925305 test: 0.921790
max validation accuracy : 0.928354 max acc epoch : 7 test accuracy : 0.909339

Epoch :  14 loss training:  10.79708214844868 Time :  238
accuracy train: 0.998814 val: 0.932927 test: 0.919455
max validation accuracy : 0.932927 max acc epoch : 14 test accuracy : 0.919455

Epoch :  15 loss training:  10.110001771601674 Time :  255
accuracy train: 0.998645 val: 0.920732 test: 0.917510
max validation accuracy : 0.932927 max acc epoch : 14 test accuracy : 0.919455

Epoch :  16 loss training:  8.473518127902935 Time :  272
accuracy train: 0.999153 val: 0.919207 test: 0.919844
max validation accuracy : 0.932927 max acc epoch : 14 test accuracy : 0.919455

Epoch :  17 loss training:  6.380128498736667 Time :  289
accuracy train: 0.999153 val: 0.925305 test: 0.922957
max validation accuracy : 0.932927 max acc epoch : 14 test accuracy : 0.919455

Epoch :  18 loss training:  7.2766819212338305 Time :  305
accuracy train: 0.999153 val: 0.923780 test: 0.918288
max validation accuracy : 0.932927 max acc epoch : 14 test accuracy : 0.919455

Epoch :  19 loss training:  8.823685635332367 Time :  322
accuracy train: 0.998476 val: 0.922256 test: 0.919844
max validation accuracy : 0.932927 max acc epoch : 14 test accuracy : 0.919455

Epoch :  20 loss training:  6.339515521969588 Time :  338
accuracy train: 0.998984 val: 0.925305 test: 0.920233
max validation accuracy : 0.932927 max acc epoch : 14 test accuracy : 0.919455

Epoch :  21 loss training:  6.4623149397921225 Time :  354
accuracy train: 0.998984 val: 0.926829 test: 0.921790
max validation accuracy : 0.932927 max acc epoch : 14 test accuracy : 0.919455

Epoch :  22 loss training:  5.538936732798902 Time :  371
accuracy train: 0.998984 val: 0.931402 test: 0.922179
max validation accuracy : 0.932927 max acc epoch : 14 test accuracy : 0.919455

Epoch :  23 loss training:  5.877794056046696 Time :  388
accuracy train: 0.998984 val: 0.928354 test: 0.921012
max validation accuracy : 0.932927 max acc epoch : 14 test accuracy : 0.919455

Epoch :  24 loss training:  4.421437068514933 Time :  405
accuracy train: 0.998814 val: 0.929878 test: 0.919455
max validation accuracy : 0.932927 max acc epoch : 14 test accuracy : 0.919455

Epoch :  25 loss training:  5.5162980900204275 Time :  422
accuracy train: 0.998984 val: 0.931402 test: 0.922957
max validation accuracy : 0.932927 max acc epoch : 14 test accuracy : 0.919455

Epoch :  26 loss training:  5.455561069149553 Time :  440
accuracy train: 0.999153 val: 0.931402 test: 0.922957
max validation accuracy : 0.932927 max acc epoch : 14 test accuracy : 0.919455

Epoch :  27 loss training:  5.447720587551885 Time :  457
accuracy train: 0.998814 val: 0.929878 test: 0.921401
max validation accuracy : 0.932927 max acc epoch : 14 test accuracy : 0.919455

Epoch :  28 loss training:  5.208253711687576 Time :  474
accuracy train: 0.998814 val: 0.929878 test: 0.922957
max validation accuracy : 0.932927 max acc epoch : 14 test accuracy : 0.919455

Epoch :  29 loss training:  4.8340785312211665 Time :  490
accuracy train: 0.999153 val: 0.928354 test: 0.922957
max validation accuracy : 0.932927 max acc epoch : 14 test accuracy : 0.919455

Epoch :  30 loss training:  5.252477100724718 Time :  506
accuracy train: 0.999153 val: 0.931402 test: 0.922568
max validation accuracy : 0.932927 max acc epoch : 14 test accuracy : 0.919455

Epoch :  31 loss training:  4.746056381969538 Time :  522
accuracy train: 0.999153 val: 0.931402 test: 0.924903
max validation accuracy : 0.932927 max acc epoch : 14 test accuracy : 0.919455

Epoch :  32 loss training:  4.584051007575908 Time :  539
accuracy train: 0.999153 val: 0.928354 test: 0.923346
max validation accuracy : 0.932927 max acc epoch : 14 test accuracy : 0.919455

Epoch :  33 loss training:  3.8409844359048293 Time :  555
accuracy train: 0.999153 val: 0.928354 test: 0.923346
max validation accuracy : 0.932927 max acc epoch : 14 test accuracy : 0.919455

Epoch :  34 loss training:  4.30519829822515 Time :  572
accuracy train: 0.999153 val: 0.929878 test: 0.921790
max validation accuracy : 0.932927 max acc epoch : 14 test accuracy : 0.919455

Epoch :  35 loss training:  5.071205889758858 Time :  589
accuracy train: 0.999153 val: 0.928354 test: 0.921401
max validation accuracy : 0.932927 max acc epoch : 14 test accuracy : 0.919455

========================================================================================================================================================================================================
max acc epoch :  14
max validation accuracy :  0.9329268292682927
test accuracy :  0.9194552529182879
latest_test_accuracy :  0.9214007782101167
========================================================================================================================================================================================================

date and time :  Fri Jan 29 16:01:21 2021
Namespace(batch_size=16, dataset='R52', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=2, random_vec=False, seed=0, weight_decay=1e-05)
device :  cuda:0
HGNNModel(
  (word_embeddings): Embedding(9333, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
          (1): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
          (1): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
          (1): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
          (1): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=52, bias=True)
    (1): Linear(in_features=200, out_features=52, bias=True)
    (2): Linear(in_features=200, out_features=52, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  452.12792759388685 Time :  17
accuracy train: 0.867717 val: 0.844512 test: 0.853307
max validation accuracy : 0.844512 max acc epoch : 1 test accuracy : 0.853307

Epoch :  2 loss training:  219.28797604888678 Time :  35
accuracy train: 0.904133 val: 0.873476 test: 0.886381
max validation accuracy : 0.873476 max acc epoch : 2 test accuracy : 0.886381

Epoch :  3 loss training:  156.96493167895824 Time :  53
accuracy train: 0.942412 val: 0.919207 test: 0.920233
max validation accuracy : 0.919207 max acc epoch : 3 test accuracy : 0.920233

Epoch :  4 loss training:  119.31133240275085 Time :  72
accuracy train: 0.949526 val: 0.920732 test: 0.922179
max validation accuracy : 0.920732 max acc epoch : 4 test accuracy : 0.922179

Epoch :  5 loss training:  98.80706425243989 Time :  91
accuracy train: 0.960196 val: 0.931402 test: 0.931128
max validation accuracy : 0.931402 max acc epoch : 5 test accuracy : 0.931128

Epoch :  6 loss training:  68.20369329303503 Time :  114
accuracy train: 0.972730 val: 0.940549 test: 0.932685
max validation accuracy : 0.940549 max acc epoch : 6 test accuracy : 0.932685

Epoch :  7 loss training:  61.620738121680915 Time :  133
accuracy train: 0.978828 val: 0.943598 test: 0.937743
max validation accuracy : 0.943598 max acc epoch : 7 test accuracy : 0.937743

Epoch :  8 loss training:  54.825945206568576 Time :  152
accuracy train: 0.978150 val: 0.931402 test: 0.936576
max validation accuracy : 0.943598 max acc epoch : 7 test accuracy : 0.937743

Epoch :  9 loss training:  49.178430073545314 Time :  170
accuracy train: 0.982046 val: 0.935976 test: 0.936965
max validation accuracy : 0.943598 max acc epoch : 7 test accuracy : 0.937743

Epoch :  10 loss training:  47.137740348116495 Time :  189
accuracy train: 0.981877 val: 0.945122 test: 0.943191
max validation accuracy : 0.945122 max acc epoch : 10 test accuracy : 0.943191

Epoch :  11 loss training:  33.8654493894428 Time :  209
accuracy train: 0.990007 val: 0.949695 test: 0.944747
max validation accuracy : 0.949695 max acc epoch : 11 test accuracy : 0.944747

Epoch :  12 loss training:  32.26603730145143 Time :  228
accuracy train: 0.991701 val: 0.952744 test: 0.943969
max validation accuracy : 0.952744 max acc epoch : 12 test accuracy : 0.943969

Epoch :  13 loss training:  30.3990466229734 Time :  252
accuracy train: 0.990176 val: 0.946646 test: 0.947471
max validation accuracy : 0.952744 max acc epoch : 12 test accuracy : 0.943969

Epoch :  14 loss training:  30.13600646215491 Time :  270
accuracy train: 0.992886 val: 0.949695 test: 0.947082
max validation accuracy : 0.952744 max acc epoch : 12 test accuracy : 0.943969

Epoch :  15 loss training:  29.477174456471403 Time :  290
accuracy train: 0.991870 val: 0.960366 test: 0.943580
max validation accuracy : 0.960366 max acc epoch : 15 test accuracy : 0.943580

Epoch :  16 loss training:  22.058868795080343 Time :  309
accuracy train: 0.993564 val: 0.957317 test: 0.944358
max validation accuracy : 0.960366 max acc epoch : 15 test accuracy : 0.943580

Epoch :  17 loss training:  20.53828922928369 Time :  330
accuracy train: 0.994580 val: 0.955793 test: 0.945525
max validation accuracy : 0.960366 max acc epoch : 15 test accuracy : 0.943580

Epoch :  18 loss training:  20.085628619337513 Time :  349
accuracy train: 0.994580 val: 0.958841 test: 0.949805
max validation accuracy : 0.960366 max acc epoch : 15 test accuracy : 0.943580

Epoch :  19 loss training:  20.46751822360966 Time :  367
accuracy train: 0.994580 val: 0.954268 test: 0.948638
max validation accuracy : 0.960366 max acc epoch : 15 test accuracy : 0.943580

Epoch :  20 loss training:  17.3327185207163 Time :  385
accuracy train: 0.994749 val: 0.949695 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 15 test accuracy : 0.943580

Epoch :  21 loss training:  16.09844766887545 Time :  398
accuracy train: 0.995766 val: 0.952744 test: 0.949416
max validation accuracy : 0.960366 max acc epoch : 15 test accuracy : 0.943580

Epoch :  22 loss training:  17.17277191049652 Time :  421
accuracy train: 0.995257 val: 0.957317 test: 0.946693
max validation accuracy : 0.960366 max acc epoch : 15 test accuracy : 0.943580

Epoch :  23 loss training:  14.836552817446318 Time :  439
accuracy train: 0.996274 val: 0.949695 test: 0.945914
max validation accuracy : 0.960366 max acc epoch : 15 test accuracy : 0.943580

Epoch :  24 loss training:  15.356310964030854 Time :  456
accuracy train: 0.996274 val: 0.951220 test: 0.947860
max validation accuracy : 0.960366 max acc epoch : 15 test accuracy : 0.943580

Epoch :  25 loss training:  15.697019892315438 Time :  475
accuracy train: 0.996443 val: 0.952744 test: 0.948249
max validation accuracy : 0.960366 max acc epoch : 15 test accuracy : 0.943580

Epoch :  26 loss training:  12.77174647974607 Time :  492
accuracy train: 0.996443 val: 0.954268 test: 0.948638
max validation accuracy : 0.960366 max acc epoch : 15 test accuracy : 0.943580

Epoch :  27 loss training:  13.030386983449716 Time :  510
accuracy train: 0.996612 val: 0.952744 test: 0.948249
max validation accuracy : 0.960366 max acc epoch : 15 test accuracy : 0.943580

Epoch :  28 loss training:  12.967024124547606 Time :  530
accuracy train: 0.996612 val: 0.952744 test: 0.949416
max validation accuracy : 0.960366 max acc epoch : 15 test accuracy : 0.943580

Epoch :  29 loss training:  11.727378268660686 Time :  551
accuracy train: 0.996443 val: 0.957317 test: 0.947471
max validation accuracy : 0.960366 max acc epoch : 15 test accuracy : 0.943580

Epoch :  30 loss training:  11.520743212924572 Time :  571
accuracy train: 0.996951 val: 0.957317 test: 0.947860
max validation accuracy : 0.960366 max acc epoch : 15 test accuracy : 0.943580

Epoch :  31 loss training:  13.976046396130187 Time :  589
accuracy train: 0.996782 val: 0.954268 test: 0.950584
max validation accuracy : 0.960366 max acc epoch : 15 test accuracy : 0.943580

Epoch :  32 loss training:  13.116835234839527 Time :  607
accuracy train: 0.996951 val: 0.952744 test: 0.949416
max validation accuracy : 0.960366 max acc epoch : 15 test accuracy : 0.943580

Epoch :  33 loss training:  11.359544826875208 Time :  626
accuracy train: 0.996951 val: 0.952744 test: 0.949805
max validation accuracy : 0.960366 max acc epoch : 15 test accuracy : 0.943580

Epoch :  34 loss training:  12.089012491502217 Time :  645
accuracy train: 0.997290 val: 0.951220 test: 0.949805
max validation accuracy : 0.960366 max acc epoch : 15 test accuracy : 0.943580

Epoch :  35 loss training:  12.599181150377262 Time :  667
accuracy train: 0.997290 val: 0.951220 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 15 test accuracy : 0.943580

Epoch :  36 loss training:  12.634625768798287 Time :  685
accuracy train: 0.997290 val: 0.949695 test: 0.949416
max validation accuracy : 0.960366 max acc epoch : 15 test accuracy : 0.943580

========================================================================================================================================================================================================
max acc epoch :  15
max validation accuracy :  0.9603658536585366
test accuracy :  0.943579766536965
latest_test_accuracy :  0.9494163424124513
========================================================================================================================================================================================================

date and time :  Fri Jan 29 16:12:54 2021
Namespace(batch_size=16, dataset='R52', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=200, lda=True, lr=0.001, num_layers=3, num_mlp_layers=2, random_vec=False, seed=0, weight_decay=1e-05)
device :  cuda:0
HGNNModel(
  (word_embeddings): Embedding(9333, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
          (1): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
          (1): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
          (1): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
          (1): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=52, bias=True)
    (1): Linear(in_features=200, out_features=52, bias=True)
    (2): Linear(in_features=200, out_features=52, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  401.105046082288 Time :  17
accuracy train: 0.874831 val: 0.861280 test: 0.852529
max validation accuracy : 0.861280 max acc epoch : 1 test accuracy : 0.852529

Epoch :  2 loss training:  186.76142254844308 Time :  37
accuracy train: 0.926152 val: 0.907012 test: 0.905837
max validation accuracy : 0.907012 max acc epoch : 2 test accuracy : 0.905837

Epoch :  3 loss training:  128.41560797346756 Time :  56
accuracy train: 0.949018 val: 0.934451 test: 0.925681
max validation accuracy : 0.934451 max acc epoch : 3 test accuracy : 0.925681

Epoch :  4 loss training:  102.18229667888954 Time :  78
accuracy train: 0.961382 val: 0.929878 test: 0.925292
max validation accuracy : 0.934451 max acc epoch : 3 test accuracy : 0.925681

Epoch :  5 loss training:  88.37684911489487 Time :  97
accuracy train: 0.959519 val: 0.932927 test: 0.924125
max validation accuracy : 0.934451 max acc epoch : 3 test accuracy : 0.925681

Epoch :  6 loss training:  63.02095123426989 Time :  118
accuracy train: 0.968157 val: 0.943598 test: 0.936576
max validation accuracy : 0.943598 max acc epoch : 6 test accuracy : 0.936576

Epoch :  7 loss training:  57.392333367373794 Time :  140
accuracy train: 0.977812 val: 0.943598 test: 0.944358
max validation accuracy : 0.943598 max acc epoch : 6 test accuracy : 0.936576

Epoch :  8 loss training:  47.322686245752266 Time :  173
accuracy train: 0.980183 val: 0.939024 test: 0.938132
max validation accuracy : 0.943598 max acc epoch : 6 test accuracy : 0.936576

Epoch :  9 loss training:  45.27822100720368 Time :  194
accuracy train: 0.983232 val: 0.946646 test: 0.934630
max validation accuracy : 0.946646 max acc epoch : 9 test accuracy : 0.934630

Epoch :  10 loss training:  42.7468462116085 Time :  215
accuracy train: 0.984417 val: 0.946646 test: 0.941634
max validation accuracy : 0.946646 max acc epoch : 9 test accuracy : 0.934630

Epoch :  11 loss training:  30.144851128890878 Time :  242
accuracy train: 0.989668 val: 0.949695 test: 0.942412
max validation accuracy : 0.949695 max acc epoch : 11 test accuracy : 0.942412

Epoch :  12 loss training:  27.21092154881626 Time :  266
accuracy train: 0.991870 val: 0.948171 test: 0.941245
max validation accuracy : 0.949695 max acc epoch : 11 test accuracy : 0.942412

Epoch :  13 loss training:  27.347299160726834 Time :  287
accuracy train: 0.992547 val: 0.948171 test: 0.941634
max validation accuracy : 0.949695 max acc epoch : 11 test accuracy : 0.942412

Epoch :  14 loss training:  24.000914200674742 Time :  311
accuracy train: 0.992886 val: 0.952744 test: 0.945914
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.945914

Epoch :  15 loss training:  25.154031674654107 Time :  328
accuracy train: 0.990346 val: 0.946646 test: 0.941634
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.945914

Epoch :  16 loss training:  18.778302849648753 Time :  340
accuracy train: 0.994411 val: 0.955793 test: 0.943969
max validation accuracy : 0.955793 max acc epoch : 16 test accuracy : 0.943969

Epoch :  17 loss training:  17.744951771193882 Time :  353
accuracy train: 0.994411 val: 0.954268 test: 0.945525
max validation accuracy : 0.955793 max acc epoch : 16 test accuracy : 0.943969

Epoch :  18 loss training:  17.25612521736184 Time :  365
accuracy train: 0.994580 val: 0.946646 test: 0.944747
max validation accuracy : 0.955793 max acc epoch : 16 test accuracy : 0.943969

Epoch :  19 loss training:  17.437194692436606 Time :  377
accuracy train: 0.995596 val: 0.951220 test: 0.939689
max validation accuracy : 0.955793 max acc epoch : 16 test accuracy : 0.943969

Epoch :  20 loss training:  16.538478735863464 Time :  390
accuracy train: 0.994241 val: 0.951220 test: 0.940467
max validation accuracy : 0.955793 max acc epoch : 16 test accuracy : 0.943969

Epoch :  21 loss training:  16.031487670938077 Time :  402
accuracy train: 0.996104 val: 0.951220 test: 0.938132
max validation accuracy : 0.955793 max acc epoch : 16 test accuracy : 0.943969

Epoch :  22 loss training:  13.61361381428651 Time :  413
accuracy train: 0.996443 val: 0.948171 test: 0.943580
max validation accuracy : 0.955793 max acc epoch : 16 test accuracy : 0.943969

Epoch :  23 loss training:  13.528900908677315 Time :  425
accuracy train: 0.996612 val: 0.951220 test: 0.940078
max validation accuracy : 0.955793 max acc epoch : 16 test accuracy : 0.943969

Epoch :  24 loss training:  12.532942248613836 Time :  437
accuracy train: 0.996782 val: 0.948171 test: 0.941634
max validation accuracy : 0.955793 max acc epoch : 16 test accuracy : 0.943969

Epoch :  25 loss training:  13.096010880646645 Time :  449
accuracy train: 0.996612 val: 0.945122 test: 0.941245
max validation accuracy : 0.955793 max acc epoch : 16 test accuracy : 0.943969

Epoch :  26 loss training:  11.919195617429068 Time :  461
accuracy train: 0.996612 val: 0.943598 test: 0.939689
max validation accuracy : 0.955793 max acc epoch : 16 test accuracy : 0.943969

Epoch :  27 loss training:  12.538826226638776 Time :  473
accuracy train: 0.997459 val: 0.945122 test: 0.942023
max validation accuracy : 0.955793 max acc epoch : 16 test accuracy : 0.943969

Epoch :  28 loss training:  11.201791505423898 Time :  485
accuracy train: 0.997459 val: 0.948171 test: 0.940856
max validation accuracy : 0.955793 max acc epoch : 16 test accuracy : 0.943969

Epoch :  29 loss training:  11.372216883013607 Time :  497
accuracy train: 0.997121 val: 0.945122 test: 0.940078
max validation accuracy : 0.955793 max acc epoch : 16 test accuracy : 0.943969

Epoch :  30 loss training:  10.557622041189461 Time :  508
accuracy train: 0.997121 val: 0.951220 test: 0.943191
max validation accuracy : 0.955793 max acc epoch : 16 test accuracy : 0.943969

Epoch :  31 loss training:  11.354297715717621 Time :  520
accuracy train: 0.997121 val: 0.949695 test: 0.942412
max validation accuracy : 0.955793 max acc epoch : 16 test accuracy : 0.943969

Epoch :  32 loss training:  10.155249374765845 Time :  531
accuracy train: 0.997121 val: 0.952744 test: 0.943191
max validation accuracy : 0.955793 max acc epoch : 16 test accuracy : 0.943969

Epoch :  33 loss training:  11.005605032019957 Time :  543
accuracy train: 0.997290 val: 0.949695 test: 0.942802
max validation accuracy : 0.955793 max acc epoch : 16 test accuracy : 0.943969

Epoch :  34 loss training:  10.331108649850648 Time :  555
accuracy train: 0.997290 val: 0.951220 test: 0.943580
max validation accuracy : 0.955793 max acc epoch : 16 test accuracy : 0.943969

Epoch :  35 loss training:  9.908314773798338 Time :  567
accuracy train: 0.997459 val: 0.948171 test: 0.941245
max validation accuracy : 0.955793 max acc epoch : 16 test accuracy : 0.943969

Epoch :  36 loss training:  9.683718337408209 Time :  577
accuracy train: 0.997290 val: 0.949695 test: 0.942412
max validation accuracy : 0.955793 max acc epoch : 16 test accuracy : 0.943969

Epoch :  37 loss training:  10.664836029009166 Time :  590
accuracy train: 0.997290 val: 0.946646 test: 0.941634
max validation accuracy : 0.955793 max acc epoch : 16 test accuracy : 0.943969

========================================================================================================================================================================================================
max acc epoch :  16
max validation accuracy :  0.9557926829268293
test accuracy :  0.9439688715953307
latest_test_accuracy :  0.9416342412451362
========================================================================================================================================================================================================

date and time :  Fri Jan 29 16:22:50 2021
Namespace(batch_size=16, dataset='R52', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=2, random_vec=True, seed=0, weight_decay=1e-05)
device :  cuda:0
HGNNModel(
  (word_embeddings): Embedding(9333, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
          (1): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
          (1): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
          (1): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
          (1): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=52, bias=True)
    (1): Linear(in_features=200, out_features=52, bias=True)
    (2): Linear(in_features=200, out_features=52, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  574.8233450949192 Time :  15
accuracy train: 0.754912 val: 0.748476 test: 0.763035
max validation accuracy : 0.748476 max acc epoch : 1 test accuracy : 0.763035

Epoch :  2 loss training:  354.831065133214 Time :  27
accuracy train: 0.848408 val: 0.829268 test: 0.831128
max validation accuracy : 0.829268 max acc epoch : 2 test accuracy : 0.831128

Epoch :  3 loss training:  249.60954143106937 Time :  39
accuracy train: 0.894817 val: 0.855183 test: 0.861089
max validation accuracy : 0.855183 max acc epoch : 3 test accuracy : 0.861089

Epoch :  4 loss training:  190.60999679751694 Time :  49
accuracy train: 0.923442 val: 0.882622 test: 0.878599
max validation accuracy : 0.882622 max acc epoch : 4 test accuracy : 0.878599

Epoch :  5 loss training:  144.80031162500381 Time :  61
accuracy train: 0.942412 val: 0.882622 test: 0.887938
max validation accuracy : 0.882622 max acc epoch : 4 test accuracy : 0.878599

Epoch :  6 loss training:  101.8286948222667 Time :  73
accuracy train: 0.963923 val: 0.899390 test: 0.901946
max validation accuracy : 0.899390 max acc epoch : 6 test accuracy : 0.901946

Epoch :  7 loss training:  86.95217343932018 Time :  84
accuracy train: 0.971037 val: 0.908537 test: 0.910117
max validation accuracy : 0.908537 max acc epoch : 7 test accuracy : 0.910117

Epoch :  8 loss training:  71.91021066985559 Time :  95
accuracy train: 0.975610 val: 0.914634 test: 0.912062
max validation accuracy : 0.914634 max acc epoch : 8 test accuracy : 0.912062

Epoch :  9 loss training:  63.72801107913256 Time :  106
accuracy train: 0.981877 val: 0.914634 test: 0.912062
max validation accuracy : 0.914634 max acc epoch : 8 test accuracy : 0.912062

Epoch :  10 loss training:  55.93304021592485 Time :  118
accuracy train: 0.982893 val: 0.911585 test: 0.915564
max validation accuracy : 0.914634 max acc epoch : 8 test accuracy : 0.912062

Epoch :  11 loss training:  43.63999196921941 Time :  129
accuracy train: 0.988652 val: 0.917683 test: 0.918288
max validation accuracy : 0.917683 max acc epoch : 11 test accuracy : 0.918288

Epoch :  12 loss training:  35.887345010298304 Time :  140
accuracy train: 0.992039 val: 0.914634 test: 0.920623
max validation accuracy : 0.917683 max acc epoch : 11 test accuracy : 0.918288

Epoch :  13 loss training:  30.783558502793312 Time :  151
accuracy train: 0.994072 val: 0.919207 test: 0.921790
max validation accuracy : 0.919207 max acc epoch : 13 test accuracy : 0.921790

Epoch :  14 loss training:  31.99684851980419 Time :  164
accuracy train: 0.994411 val: 0.925305 test: 0.923735
max validation accuracy : 0.925305 max acc epoch : 14 test accuracy : 0.923735

Epoch :  15 loss training:  28.879535328429483 Time :  176
accuracy train: 0.996104 val: 0.922256 test: 0.919844
max validation accuracy : 0.925305 max acc epoch : 14 test accuracy : 0.923735

Epoch :  16 loss training:  21.041115228363196 Time :  188
accuracy train: 0.997121 val: 0.922256 test: 0.924514
max validation accuracy : 0.925305 max acc epoch : 14 test accuracy : 0.923735

Epoch :  17 loss training:  19.701719050150132 Time :  200
accuracy train: 0.996951 val: 0.928354 test: 0.924125
max validation accuracy : 0.928354 max acc epoch : 17 test accuracy : 0.924125

Epoch :  18 loss training:  15.867591150976295 Time :  211
accuracy train: 0.997798 val: 0.928354 test: 0.924125
max validation accuracy : 0.928354 max acc epoch : 17 test accuracy : 0.924125

Epoch :  19 loss training:  18.31155075773131 Time :  223
accuracy train: 0.996951 val: 0.920732 test: 0.923346
max validation accuracy : 0.928354 max acc epoch : 17 test accuracy : 0.924125

Epoch :  20 loss training:  15.681987470772583 Time :  233
accuracy train: 0.997629 val: 0.932927 test: 0.924125
max validation accuracy : 0.932927 max acc epoch : 20 test accuracy : 0.924125

Epoch :  21 loss training:  15.483615315999486 Time :  245
accuracy train: 0.997629 val: 0.926829 test: 0.922568
max validation accuracy : 0.932927 max acc epoch : 20 test accuracy : 0.924125

Epoch :  22 loss training:  14.4989383248394 Time :  257
accuracy train: 0.997121 val: 0.923780 test: 0.922568
max validation accuracy : 0.932927 max acc epoch : 20 test accuracy : 0.924125

Epoch :  23 loss training:  12.046877201679308 Time :  268
accuracy train: 0.997967 val: 0.926829 test: 0.925292
max validation accuracy : 0.932927 max acc epoch : 20 test accuracy : 0.924125

Epoch :  24 loss training:  13.497316874978424 Time :  281
accuracy train: 0.998476 val: 0.929878 test: 0.923735
max validation accuracy : 0.932927 max acc epoch : 20 test accuracy : 0.924125

Epoch :  25 loss training:  12.679196661352762 Time :  292
accuracy train: 0.998476 val: 0.926829 test: 0.923346
max validation accuracy : 0.932927 max acc epoch : 20 test accuracy : 0.924125

Epoch :  26 loss training:  10.798051817517262 Time :  304
accuracy train: 0.998645 val: 0.926829 test: 0.927237
max validation accuracy : 0.932927 max acc epoch : 20 test accuracy : 0.924125

Epoch :  27 loss training:  12.479359413002385 Time :  316
accuracy train: 0.998645 val: 0.925305 test: 0.924514
max validation accuracy : 0.932927 max acc epoch : 20 test accuracy : 0.924125

Epoch :  28 loss training:  12.07057774112036 Time :  328
accuracy train: 0.998476 val: 0.923780 test: 0.922957
max validation accuracy : 0.932927 max acc epoch : 20 test accuracy : 0.924125

Epoch :  29 loss training:  10.392708103638142 Time :  340
accuracy train: 0.998476 val: 0.923780 test: 0.924903
max validation accuracy : 0.932927 max acc epoch : 20 test accuracy : 0.924125

Epoch :  30 loss training:  9.173467531982169 Time :  352
accuracy train: 0.998306 val: 0.931402 test: 0.926459
max validation accuracy : 0.932927 max acc epoch : 20 test accuracy : 0.924125

Epoch :  31 loss training:  9.472097878940986 Time :  364
accuracy train: 0.998306 val: 0.926829 test: 0.926459
max validation accuracy : 0.932927 max acc epoch : 20 test accuracy : 0.924125

Epoch :  32 loss training:  10.518674899572943 Time :  376
accuracy train: 0.998645 val: 0.928354 test: 0.925681
max validation accuracy : 0.932927 max acc epoch : 20 test accuracy : 0.924125

Epoch :  33 loss training:  11.306736010919849 Time :  388
accuracy train: 0.998476 val: 0.923780 test: 0.924514
max validation accuracy : 0.932927 max acc epoch : 20 test accuracy : 0.924125

Epoch :  34 loss training:  9.759170318662655 Time :  400
accuracy train: 0.998476 val: 0.926829 test: 0.925681
max validation accuracy : 0.932927 max acc epoch : 20 test accuracy : 0.924125

Epoch :  35 loss training:  10.941003724499751 Time :  412
accuracy train: 0.998645 val: 0.925305 test: 0.925292
max validation accuracy : 0.932927 max acc epoch : 20 test accuracy : 0.924125

Epoch :  36 loss training:  12.00217321785749 Time :  424
accuracy train: 0.998814 val: 0.925305 test: 0.925292
max validation accuracy : 0.932927 max acc epoch : 20 test accuracy : 0.924125

Epoch :  37 loss training:  10.330008014701889 Time :  436
accuracy train: 0.998814 val: 0.923780 test: 0.925292
max validation accuracy : 0.932927 max acc epoch : 20 test accuracy : 0.924125

Epoch :  38 loss training:  10.473718357185135 Time :  447
accuracy train: 0.998476 val: 0.923780 test: 0.924125
max validation accuracy : 0.932927 max acc epoch : 20 test accuracy : 0.924125

Epoch :  39 loss training:  10.587616702028754 Time :  460
accuracy train: 0.998476 val: 0.925305 test: 0.923735
max validation accuracy : 0.932927 max acc epoch : 20 test accuracy : 0.924125

Epoch :  40 loss training:  10.998294917524618 Time :  472
accuracy train: 0.998476 val: 0.923780 test: 0.924514
max validation accuracy : 0.932927 max acc epoch : 20 test accuracy : 0.924125

Epoch :  41 loss training:  9.541211051971914 Time :  484
accuracy train: 0.998476 val: 0.926829 test: 0.926070
max validation accuracy : 0.932927 max acc epoch : 20 test accuracy : 0.924125

========================================================================================================================================================================================================
max acc epoch :  20
max validation accuracy :  0.9329268292682927
test accuracy :  0.9241245136186771
latest_test_accuracy :  0.9260700389105059
========================================================================================================================================================================================================

