date and time :  Tue Jan 26 17:30:32 2021
Namespace(batch_size=16, dataset='R52', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_layers=3, num_mlp_layers=1, random_vec=True, seed=0, weight_decay=1e-05)
device :  cuda:0
HGNNModel(
  (word_embeddings): Embedding(9333, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=52, bias=True)
    (1): Linear(in_features=200, out_features=52, bias=True)
    (2): Linear(in_features=200, out_features=52, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
)
Epoch :  1 loss training:  388.04363720119 Time :  66
accuracy train: 0.903963 val: 0.858232 test: 0.863035
max validation accuracy : 0.858232 max acc epoch : 1.000000 test accuracy : 0.863035

Epoch :  2 loss training:  152.20583997666836 Time :  562
accuracy train: 0.943259 val: 0.893293 test: 0.894163
max validation accuracy : 0.893293 max acc epoch : 2.000000 test accuracy : 0.894163

Epoch :  3 loss training:  91.63907958427444 Time :  1241
accuracy train: 0.978659 val: 0.913110 test: 0.903502
max validation accuracy : 0.913110 max acc epoch : 3.000000 test accuracy : 0.903502

Epoch :  4 loss training:  56.09344237996265 Time :  1556
accuracy train: 0.988313 val: 0.931402 test: 0.911284
max validation accuracy : 0.931402 max acc epoch : 4.000000 test accuracy : 0.911284

Epoch :  5 loss training:  40.032263164175674 Time :  1817
accuracy train: 0.995088 val: 0.934451 test: 0.913619
max validation accuracy : 0.934451 max acc epoch : 5.000000 test accuracy : 0.913619

Epoch :  6 loss training:  21.238857122836635 Time :  2105
accuracy train: 0.996612 val: 0.928354 test: 0.913619
max validation accuracy : 0.934451 max acc epoch : 5.000000 test accuracy : 0.913619

Epoch :  7 loss training:  13.946281328855548 Time :  2485
accuracy train: 0.998137 val: 0.940549 test: 0.917121
max validation accuracy : 0.940549 max acc epoch : 7.000000 test accuracy : 0.917121

Epoch :  8 loss training:  13.836439648453961 Time :  2826
accuracy train: 0.998137 val: 0.934451 test: 0.915564
max validation accuracy : 0.940549 max acc epoch : 7.000000 test accuracy : 0.917121

Epoch :  9 loss training:  11.85867383115692 Time :  2838
accuracy train: 0.997798 val: 0.939024 test: 0.916342
max validation accuracy : 0.940549 max acc epoch : 7.000000 test accuracy : 0.917121

Epoch :  10 loss training:  7.989927043687203 Time :  2848
accuracy train: 0.998814 val: 0.931402 test: 0.916342
max validation accuracy : 0.940549 max acc epoch : 7.000000 test accuracy : 0.917121

Epoch :  11 loss training:  7.2361649440463225 Time :  2859
accuracy train: 0.998137 val: 0.937500 test: 0.915175
max validation accuracy : 0.940549 max acc epoch : 7.000000 test accuracy : 0.917121

Epoch :  12 loss training:  7.310107617457106 Time :  2869
accuracy train: 0.998814 val: 0.934451 test: 0.912840
max validation accuracy : 0.940549 max acc epoch : 7.000000 test accuracy : 0.917121

Epoch :  13 loss training:  4.674663454532492 Time :  2880
accuracy train: 0.999153 val: 0.937500 test: 0.914786
max validation accuracy : 0.940549 max acc epoch : 7.000000 test accuracy : 0.917121

Epoch :  14 loss training:  5.934829742051079 Time :  2891
accuracy train: 0.998984 val: 0.939024 test: 0.913230
max validation accuracy : 0.940549 max acc epoch : 7.000000 test accuracy : 0.917121

Epoch :  15 loss training:  5.3860390076279145 Time :  2902
accuracy train: 0.998984 val: 0.937500 test: 0.912451
max validation accuracy : 0.940549 max acc epoch : 7.000000 test accuracy : 0.917121

Epoch :  16 loss training:  3.838879083188658 Time :  2915
accuracy train: 0.999153 val: 0.935976 test: 0.914008
max validation accuracy : 0.940549 max acc epoch : 7.000000 test accuracy : 0.917121

Epoch :  17 loss training:  4.4916570302448235 Time :  3064
accuracy train: 0.998984 val: 0.935976 test: 0.914786
max validation accuracy : 0.940549 max acc epoch : 7.000000 test accuracy : 0.917121

Epoch :  18 loss training:  3.1183196103993396 Time :  3347
accuracy train: 0.998984 val: 0.937500 test: 0.912840
max validation accuracy : 0.940549 max acc epoch : 7.000000 test accuracy : 0.917121

Epoch :  19 loss training:  3.7384122492640017 Time :  3656
accuracy train: 0.998984 val: 0.935976 test: 0.913619
max validation accuracy : 0.940549 max acc epoch : 7.000000 test accuracy : 0.917121

Epoch :  20 loss training:  3.5316982225231186 Time :  3986
accuracy train: 0.998984 val: 0.935976 test: 0.914397
max validation accuracy : 0.940549 max acc epoch : 7.000000 test accuracy : 0.917121

Epoch :  21 loss training:  2.963829926567996 Time :  4323
accuracy train: 0.998984 val: 0.937500 test: 0.916342
max validation accuracy : 0.940549 max acc epoch : 7.000000 test accuracy : 0.917121

Epoch :  22 loss training:  2.5509651607899286 Time :  4653
accuracy train: 0.998984 val: 0.932927 test: 0.916732
max validation accuracy : 0.940549 max acc epoch : 7.000000 test accuracy : 0.917121

Epoch :  23 loss training:  3.137754762600707 Time :  4983
accuracy train: 0.999153 val: 0.935976 test: 0.916732
max validation accuracy : 0.940549 max acc epoch : 7.000000 test accuracy : 0.917121

Epoch :  24 loss training:  3.1223881644582434 Time :  5304
accuracy train: 0.998984 val: 0.935976 test: 0.917121
max validation accuracy : 0.940549 max acc epoch : 7.000000 test accuracy : 0.917121

Epoch :  25 loss training:  2.5169745070270437 Time :  5619
accuracy train: 0.999153 val: 0.937500 test: 0.916342
max validation accuracy : 0.940549 max acc epoch : 7.000000 test accuracy : 0.917121

Epoch :  26 loss training:  2.368462041929888 Time :  5962
accuracy train: 0.998814 val: 0.932927 test: 0.915175
max validation accuracy : 0.940549 max acc epoch : 7.000000 test accuracy : 0.917121

Epoch :  27 loss training:  2.36999811554233 Time :  6334
accuracy train: 0.998984 val: 0.937500 test: 0.914786
max validation accuracy : 0.940549 max acc epoch : 7.000000 test accuracy : 0.917121

Epoch :  28 loss training:  2.404363366782036 Time :  6687
accuracy train: 0.998984 val: 0.937500 test: 0.915175
max validation accuracy : 0.940549 max acc epoch : 7.000000 test accuracy : 0.917121

========================================================================================================================================================================================================
max acc epoch :  7
max validation accuracy :  0.9405487804878049
test accuracy :  0.9171206225680933
latest_test_accuracy :  0.9151750972762646
========================================================================================================================================================================================================

