

date and time :  Fri Jun 11 12:26:36 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=145, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  91.9379965364933 Time :  12
accuracy train: 0.779150 val: 0.760563 test: 0.767586
max validation accuracy : 0.760563 max acc epoch : 1 test accuracy : 0.767586
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.15789052844048 Time :  22
accuracy train: 0.792435 val: 0.769014 test: 0.776027
max validation accuracy : 0.769014 max acc epoch : 2 test accuracy : 0.776027
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.96055600047112 Time :  31
accuracy train: 0.809784 val: 0.771831 test: 0.772651
max validation accuracy : 0.771831 max acc epoch : 3 test accuracy : 0.772651
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.32917703688145 Time :  43
accuracy train: 0.813848 val: 0.766197 test: 0.777153
max validation accuracy : 0.771831 max acc epoch : 3 test accuracy : 0.772651
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  73.64115060865879 Time :  55
accuracy train: 0.837293 val: 0.770423 test: 0.771806
max validation accuracy : 0.771831 max acc epoch : 3 test accuracy : 0.772651
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.48470598459244 Time :  65
accuracy train: 0.833385 val: 0.759155 test: 0.762802
max validation accuracy : 0.771831 max acc epoch : 3 test accuracy : 0.772651
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.40286479890347 Time :  81
accuracy train: 0.849953 val: 0.787324 test: 0.775464
max validation accuracy : 0.787324 max acc epoch : 7 test accuracy : 0.775464
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.33031760156155 Time :  89
accuracy train: 0.857768 val: 0.787324 test: 0.774902
max validation accuracy : 0.787324 max acc epoch : 7 test accuracy : 0.775464
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.94205085933208 Time :  100
accuracy train: 0.861988 val: 0.783099 test: 0.774339
max validation accuracy : 0.787324 max acc epoch : 7 test accuracy : 0.775464
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  63.133136942982674 Time :  108
accuracy train: 0.869490 val: 0.776056 test: 0.778841
max validation accuracy : 0.787324 max acc epoch : 7 test accuracy : 0.775464

Epoch :  11 loss training:  61.3278743326664 Time :  116
accuracy train: 0.876524 val: 0.781690 test: 0.775746
max validation accuracy : 0.787324 max acc epoch : 7 test accuracy : 0.775464

Epoch :  12 loss training:  58.73216710984707 Time :  124
accuracy train: 0.890591 val: 0.784507 test: 0.772932
max validation accuracy : 0.787324 max acc epoch : 7 test accuracy : 0.775464

Epoch :  13 loss training:  56.055385410785675 Time :  131
accuracy train: 0.906377 val: 0.783099 test: 0.772369
max validation accuracy : 0.787324 max acc epoch : 7 test accuracy : 0.775464

Epoch :  14 loss training:  52.43263417482376 Time :  143
accuracy train: 0.916693 val: 0.797183 test: 0.777153
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  15 loss training:  50.172446578741074 Time :  151
accuracy train: 0.927946 val: 0.790141 test: 0.771806
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  16 loss training:  46.84685239940882 Time :  163
accuracy train: 0.936543 val: 0.785915 test: 0.770962
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  17 loss training:  42.16410455107689 Time :  173
accuracy train: 0.940138 val: 0.787324 test: 0.768711
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  18 loss training:  40.57008372992277 Time :  189
accuracy train: 0.954517 val: 0.784507 test: 0.771525
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  19 loss training:  37.950707986950874 Time :  198
accuracy train: 0.963113 val: 0.780282 test: 0.770681
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  20 loss training:  36.55259022861719 Time :  205
accuracy train: 0.970928 val: 0.783099 test: 0.769555
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  21 loss training:  32.74571396410465 Time :  215
accuracy train: 0.972804 val: 0.795775 test: 0.774057
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  22 loss training:  30.692923955619335 Time :  224
accuracy train: 0.979212 val: 0.781690 test: 0.767304
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  23 loss training:  28.18773004412651 Time :  234
accuracy train: 0.983589 val: 0.780282 test: 0.771525
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  24 loss training:  26.773672215640545 Time :  244
accuracy train: 0.989059 val: 0.792958 test: 0.767867
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  25 loss training:  24.141855284571648 Time :  253
accuracy train: 0.989684 val: 0.774648 test: 0.772932
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  26 loss training:  23.173136353492737 Time :  261
accuracy train: 0.990309 val: 0.777465 test: 0.769555
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  27 loss training:  21.121350014582276 Time :  271
accuracy train: 0.992185 val: 0.773239 test: 0.768711
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  28 loss training:  19.001533033326268 Time :  277
accuracy train: 0.994842 val: 0.770423 test: 0.774057
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  29 loss training:  18.8076032679528 Time :  287
accuracy train: 0.996249 val: 0.774648 test: 0.769274
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  30 loss training:  15.889425472356379 Time :  297
accuracy train: 0.997187 val: 0.781690 test: 0.774620
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  31 loss training:  15.755064405500889 Time :  307
accuracy train: 0.998437 val: 0.776056 test: 0.766179
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  32 loss training:  14.544950819574296 Time :  321
accuracy train: 0.996561 val: 0.767606 test: 0.765616
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  33 loss training:  12.862995675764978 Time :  332
accuracy train: 0.998437 val: 0.773239 test: 0.773213
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  34 loss training:  12.228770457673818 Time :  340
accuracy train: 0.998750 val: 0.774648 test: 0.765898
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  35 loss training:  11.626703781541437 Time :  349
accuracy train: 0.998750 val: 0.764789 test: 0.768711
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  36 loss training:  11.290046183392406 Time :  356
accuracy train: 0.999375 val: 0.767606 test: 0.771806
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  37 loss training:  9.829390654340386 Time :  366
accuracy train: 0.998906 val: 0.767606 test: 0.764209
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  38 loss training:  9.595268086530268 Time :  376
accuracy train: 0.999375 val: 0.764789 test: 0.763928
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  39 loss training:  8.507714219857007 Time :  386
accuracy train: 0.999687 val: 0.761972 test: 0.763365
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  40 loss training:  8.923588247969747 Time :  392
accuracy train: 0.999531 val: 0.777465 test: 0.767304
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  41 loss training:  8.962531550321728 Time :  402
accuracy train: 0.999687 val: 0.766197 test: 0.767867
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  42 loss training:  8.230462559266016 Time :  412
accuracy train: 0.999687 val: 0.764789 test: 0.770681
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  43 loss training:  7.332988640060648 Time :  422
accuracy train: 0.999687 val: 0.771831 test: 0.768711
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  44 loss training:  7.167427610605955 Time :  430
accuracy train: 0.999844 val: 0.759155 test: 0.768430
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

Epoch :  45 loss training:  6.780783319263719 Time :  444
accuracy train: 0.999844 val: 0.761972 test: 0.772651
max validation accuracy : 0.797183 max acc epoch : 14 test accuracy : 0.777153

========================================================================================================================================================================================================
max acc epoch :  14
max validation accuracy :  0.7971830985915493
test accuracy :  0.7771525042205966
last test_accuracy :  0.7726505346088914
second best val :  0.795774647887324
second best test :  0.7771525042205966
max gap 7
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=145, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  92.02673676609993 Time :  457
accuracy train: 0.776336 val: 0.769014 test: 0.761396
max validation accuracy : 0.769014 max acc epoch : 1 test accuracy : 0.761396
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.43318998813629 Time :  466
accuracy train: 0.793686 val: 0.760563 test: 0.774902
max validation accuracy : 0.769014 max acc epoch : 1 test accuracy : 0.761396
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.25615103542805 Time :  477
accuracy train: 0.810410 val: 0.769014 test: 0.774339
max validation accuracy : 0.769014 max acc epoch : 1 test accuracy : 0.761396
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.01439575850964 Time :  484
accuracy train: 0.820882 val: 0.774648 test: 0.770962
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.770962
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  73.07879196107388 Time :  494
accuracy train: 0.838700 val: 0.771831 test: 0.777153
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.770962
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.13842436671257 Time :  502
accuracy train: 0.835261 val: 0.764789 test: 0.767586
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.770962
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.99342907965183 Time :  513
accuracy train: 0.857299 val: 0.770423 test: 0.779403
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.770962
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.00185632705688 Time :  523
accuracy train: 0.864176 val: 0.776056 test: 0.771806
max validation accuracy : 0.776056 max acc epoch : 8 test accuracy : 0.771806
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.69722054898739 Time :  533
accuracy train: 0.864020 val: 0.784507 test: 0.773495
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.30130659043789 Time :  543
accuracy train: 0.872773 val: 0.770423 test: 0.775746
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  11 loss training:  60.63402330875397 Time :  553
accuracy train: 0.879494 val: 0.767606 test: 0.773213
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  12 loss training:  58.705952763557434 Time :  566
accuracy train: 0.894342 val: 0.769014 test: 0.767586
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  13 loss training:  55.47993604838848 Time :  580
accuracy train: 0.906846 val: 0.771831 test: 0.771244
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  14 loss training:  51.87862507998943 Time :  593
accuracy train: 0.915755 val: 0.784507 test: 0.774339
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  15 loss training:  49.773563876748085 Time :  604
accuracy train: 0.932323 val: 0.774648 test: 0.768993
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  16 loss training:  46.37374646961689 Time :  613
accuracy train: 0.941388 val: 0.773239 test: 0.770962
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  17 loss training:  41.88285096734762 Time :  624
accuracy train: 0.940294 val: 0.778873 test: 0.769837
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  18 loss training:  40.15276139974594 Time :  633
accuracy train: 0.954517 val: 0.784507 test: 0.771244
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  19 loss training:  37.449109092354774 Time :  643
accuracy train: 0.962645 val: 0.776056 test: 0.765616
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  20 loss training:  35.977647222578526 Time :  654
accuracy train: 0.969053 val: 0.776056 test: 0.764209
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  21 loss training:  32.70627384632826 Time :  663
accuracy train: 0.974211 val: 0.783099 test: 0.769837
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  22 loss training:  31.060991160571575 Time :  675
accuracy train: 0.980619 val: 0.778873 test: 0.766460
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  23 loss training:  27.29059887677431 Time :  684
accuracy train: 0.983432 val: 0.770423 test: 0.770681
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  24 loss training:  26.468460220843554 Time :  695
accuracy train: 0.987965 val: 0.778873 test: 0.765053
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  25 loss training:  24.828167028725147 Time :  706
accuracy train: 0.989528 val: 0.776056 test: 0.768149
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  26 loss training:  22.89274943806231 Time :  716
accuracy train: 0.989684 val: 0.777465 test: 0.765898
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  27 loss training:  21.412367263808846 Time :  731
accuracy train: 0.992654 val: 0.777465 test: 0.765335
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  28 loss training:  19.213748581707478 Time :  743
accuracy train: 0.995624 val: 0.769014 test: 0.762802
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  29 loss training:  18.407931361347437 Time :  754
accuracy train: 0.996249 val: 0.778873 test: 0.765053
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  30 loss training:  17.081517450511456 Time :  764
accuracy train: 0.996874 val: 0.783099 test: 0.770118
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  31 loss training:  16.245876539498568 Time :  774
accuracy train: 0.997343 val: 0.773239 test: 0.768993
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  32 loss training:  14.10598211735487 Time :  787
accuracy train: 0.997030 val: 0.771831 test: 0.770681
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  33 loss training:  13.092344891279936 Time :  795
accuracy train: 0.997499 val: 0.781690 test: 0.768149
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  34 loss training:  12.763599595054984 Time :  807
accuracy train: 0.998750 val: 0.780282 test: 0.764772
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  35 loss training:  12.587912543211132 Time :  817
accuracy train: 0.998593 val: 0.776056 test: 0.766460
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  36 loss training:  11.515361000783741 Time :  827
accuracy train: 0.999531 val: 0.773239 test: 0.759426
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  37 loss training:  9.972340975888073 Time :  839
accuracy train: 0.999219 val: 0.767606 test: 0.763647
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  38 loss training:  10.335340748075396 Time :  848
accuracy train: 0.999531 val: 0.757746 test: 0.760833
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  39 loss training:  9.142148047219962 Time :  862
accuracy train: 0.999687 val: 0.771831 test: 0.764491
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

Epoch :  40 loss training:  9.35491218068637 Time :  872
accuracy train: 0.999687 val: 0.774648 test: 0.756894
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.773495

========================================================================================================================================================================================================
max acc epoch :  9
max validation accuracy :  0.7845070422535211
test accuracy :  0.7734946539110861
last test_accuracy :  0.7568936409679234
second best val :  0.7830985915492957
second best test :  0.7734946539110861
max gap 4
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=145, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  91.87003436684608 Time :  890
accuracy train: 0.773367 val: 0.767606 test: 0.765616
max validation accuracy : 0.767606 max acc epoch : 1 test accuracy : 0.765616
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.44265238940716 Time :  903
accuracy train: 0.791966 val: 0.761972 test: 0.774057
max validation accuracy : 0.767606 max acc epoch : 1 test accuracy : 0.765616
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.15206757187843 Time :  911
accuracy train: 0.811035 val: 0.764789 test: 0.776027
max validation accuracy : 0.767606 max acc epoch : 1 test accuracy : 0.765616
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.50224883854389 Time :  925
accuracy train: 0.820413 val: 0.773239 test: 0.771244
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.771244
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.7687061727047 Time :  933
accuracy train: 0.837918 val: 0.773239 test: 0.776308
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.771244
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  69.99247097969055 Time :  945
accuracy train: 0.837449 val: 0.754930 test: 0.766742
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.771244
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.75172021985054 Time :  956
accuracy train: 0.854486 val: 0.781690 test: 0.777434
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.81094014644623 Time :  965
accuracy train: 0.865427 val: 0.757746 test: 0.769555
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.5420793890953 Time :  977
accuracy train: 0.869803 val: 0.759155 test: 0.775464
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.449754267930984 Time :  986
accuracy train: 0.875430 val: 0.767606 test: 0.770118
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  11 loss training:  60.37264443933964 Time :  999
accuracy train: 0.885277 val: 0.774648 test: 0.771525
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  12 loss training:  57.96430027484894 Time :  1009
accuracy train: 0.894967 val: 0.767606 test: 0.768993
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  13 loss training:  54.847752183675766 Time :  1020
accuracy train: 0.908721 val: 0.763380 test: 0.773213
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  14 loss training:  50.88097770512104 Time :  1033
accuracy train: 0.918725 val: 0.776056 test: 0.774339
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  15 loss training:  49.38851463794708 Time :  1048
accuracy train: 0.932323 val: 0.769014 test: 0.777434
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  16 loss training:  46.772850662469864 Time :  1067
accuracy train: 0.944514 val: 0.766197 test: 0.769274
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  17 loss training:  41.533794686198235 Time :  1077
accuracy train: 0.944983 val: 0.769014 test: 0.767586
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  18 loss training:  39.64761733263731 Time :  1090
accuracy train: 0.956862 val: 0.781690 test: 0.774620
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  19 loss training:  36.695579171180725 Time :  1098
accuracy train: 0.965771 val: 0.769014 test: 0.765898
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  20 loss training:  35.88695280998945 Time :  1111
accuracy train: 0.971397 val: 0.766197 test: 0.761958
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  21 loss training:  32.640559785068035 Time :  1122
accuracy train: 0.976243 val: 0.773239 test: 0.766742
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  22 loss training:  30.515281949192286 Time :  1132
accuracy train: 0.981557 val: 0.764789 test: 0.758863
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  23 loss training:  26.48676497861743 Time :  1145
accuracy train: 0.985933 val: 0.766197 test: 0.765898
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  24 loss training:  26.34644003212452 Time :  1154
accuracy train: 0.988746 val: 0.767606 test: 0.761396
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  25 loss training:  23.38283415697515 Time :  1166
accuracy train: 0.990309 val: 0.766197 test: 0.763647
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  26 loss training:  22.681632101535797 Time :  1179
accuracy train: 0.991716 val: 0.767606 test: 0.759145
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  27 loss training:  21.07778098806739 Time :  1188
accuracy train: 0.992498 val: 0.756338 test: 0.758582
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  28 loss training:  18.97293570637703 Time :  1204
accuracy train: 0.995936 val: 0.761972 test: 0.762802
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  29 loss training:  17.723340425640345 Time :  1220
accuracy train: 0.995467 val: 0.769014 test: 0.761958
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  30 loss training:  16.51911228336394 Time :  1242
accuracy train: 0.997030 val: 0.776056 test: 0.761114
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  31 loss training:  15.4492466468364 Time :  1253
accuracy train: 0.998124 val: 0.756338 test: 0.758863
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  32 loss training:  14.365303342230618 Time :  1266
accuracy train: 0.997499 val: 0.773239 test: 0.756612
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  33 loss training:  13.3176975781098 Time :  1279
accuracy train: 0.998437 val: 0.776056 test: 0.762240
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  34 loss training:  12.20599144231528 Time :  1289
accuracy train: 0.998593 val: 0.773239 test: 0.759426
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  35 loss training:  11.885436525102705 Time :  1305
accuracy train: 0.998906 val: 0.766197 test: 0.759145
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  36 loss training:  11.212979226373136 Time :  1315
accuracy train: 0.999375 val: 0.766197 test: 0.759707
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  37 loss training:  9.817039104178548 Time :  1332
accuracy train: 0.999687 val: 0.757746 test: 0.757738
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

Epoch :  38 loss training:  10.227118545677513 Time :  1342
accuracy train: 1.000000 val: 0.757746 test: 0.752954
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777434

========================================================================================================================================================================================================
max acc epoch :  7
max validation accuracy :  0.7816901408450704
test accuracy :  0.7774338773213281
last test_accuracy :  0.7529544175576814
second best val :  0.776056338028169
second best test :  0.7774338773213281
max gap 3
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=145, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  91.99980860948563 Time :  1355
accuracy train: 0.771804 val: 0.761972 test: 0.768711
max validation accuracy : 0.761972 max acc epoch : 1 test accuracy : 0.768711
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.38498954474926 Time :  1367
accuracy train: 0.786652 val: 0.771831 test: 0.773495
max validation accuracy : 0.771831 max acc epoch : 2 test accuracy : 0.773495
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.17642503976822 Time :  1377
accuracy train: 0.809315 val: 0.770423 test: 0.776590
max validation accuracy : 0.771831 max acc epoch : 2 test accuracy : 0.773495
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.75588947534561 Time :  1393
accuracy train: 0.810566 val: 0.767606 test: 0.774057
max validation accuracy : 0.771831 max acc epoch : 2 test accuracy : 0.773495
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  73.56654605269432 Time :  1413
accuracy train: 0.835574 val: 0.774648 test: 0.777715
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.777715
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.60706335306168 Time :  1437
accuracy train: 0.832448 val: 0.769014 test: 0.768993
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.777715
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.515256986022 Time :  1445
accuracy train: 0.852610 val: 0.776056 test: 0.779685
max validation accuracy : 0.776056 max acc epoch : 7 test accuracy : 0.779685
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.64947898685932 Time :  1458
accuracy train: 0.856987 val: 0.777465 test: 0.772932
max validation accuracy : 0.777465 max acc epoch : 8 test accuracy : 0.772932
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.46563975512981 Time :  1471
accuracy train: 0.862301 val: 0.778873 test: 0.779685
max validation accuracy : 0.778873 max acc epoch : 9 test accuracy : 0.779685
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  63.444926261901855 Time :  1480
accuracy train: 0.869803 val: 0.777465 test: 0.773776
max validation accuracy : 0.778873 max acc epoch : 9 test accuracy : 0.779685

Epoch :  11 loss training:  61.460835471749306 Time :  1495
accuracy train: 0.877774 val: 0.773239 test: 0.773495
max validation accuracy : 0.778873 max acc epoch : 9 test accuracy : 0.779685

Epoch :  12 loss training:  59.115595668554306 Time :  1503
accuracy train: 0.887465 val: 0.781690 test: 0.776871
max validation accuracy : 0.781690 max acc epoch : 12 test accuracy : 0.776871

Epoch :  13 loss training:  56.701324105262756 Time :  1516
accuracy train: 0.903564 val: 0.783099 test: 0.776308
max validation accuracy : 0.783099 max acc epoch : 13 test accuracy : 0.776308

Epoch :  14 loss training:  52.33784830570221 Time :  1529
accuracy train: 0.911379 val: 0.787324 test: 0.778559
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.778559

Epoch :  15 loss training:  50.5083267390728 Time :  1539
accuracy train: 0.929197 val: 0.787324 test: 0.778841
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.778559

Epoch :  16 loss training:  47.25928447395563 Time :  1555
accuracy train: 0.936543 val: 0.783099 test: 0.775183
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.778559

Epoch :  17 loss training:  43.07636518776417 Time :  1565
accuracy train: 0.939981 val: 0.787324 test: 0.775746
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.778559

Epoch :  18 loss training:  41.02730990201235 Time :  1581
accuracy train: 0.953110 val: 0.794366 test: 0.772088
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  19 loss training:  38.357021145522594 Time :  1597
accuracy train: 0.960613 val: 0.778873 test: 0.770118
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  20 loss training:  36.49237059056759 Time :  1623
accuracy train: 0.968428 val: 0.778873 test: 0.768993
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  21 loss training:  32.64299526810646 Time :  1635
accuracy train: 0.971554 val: 0.791549 test: 0.774057
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  22 loss training:  30.97050479054451 Time :  1646
accuracy train: 0.981557 val: 0.770423 test: 0.764772
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  23 loss training:  28.220392778515816 Time :  1662
accuracy train: 0.983589 val: 0.774648 test: 0.774620
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  24 loss training:  26.72118904814124 Time :  1671
accuracy train: 0.987965 val: 0.785915 test: 0.770400
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  25 loss training:  24.62518858164549 Time :  1686
accuracy train: 0.989841 val: 0.783099 test: 0.772369
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  26 loss training:  23.23558455146849 Time :  1699
accuracy train: 0.992341 val: 0.788732 test: 0.773776
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  27 loss training:  21.292008198797703 Time :  1710
accuracy train: 0.992185 val: 0.784507 test: 0.768711
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  28 loss training:  18.70951070636511 Time :  1721
accuracy train: 0.996093 val: 0.780282 test: 0.768711
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  29 loss training:  18.73869807459414 Time :  1733
accuracy train: 0.995780 val: 0.777465 test: 0.773776
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  30 loss training:  16.362990722060204 Time :  1743
accuracy train: 0.997499 val: 0.787324 test: 0.772651
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  31 loss training:  16.045151975937188 Time :  1755
accuracy train: 0.997968 val: 0.781690 test: 0.764491
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  32 loss training:  14.020519538782537 Time :  1766
accuracy train: 0.996718 val: 0.787324 test: 0.772088
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  33 loss training:  12.738214218989015 Time :  1776
accuracy train: 0.998281 val: 0.787324 test: 0.772651
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  34 loss training:  12.261424316093326 Time :  1791
accuracy train: 0.998593 val: 0.781690 test: 0.771244
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  35 loss training:  11.638455326203257 Time :  1810
accuracy train: 0.999062 val: 0.787324 test: 0.767867
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  36 loss training:  11.440753316506743 Time :  1822
accuracy train: 0.999531 val: 0.780282 test: 0.770962
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  37 loss training:  9.534007016103715 Time :  1836
accuracy train: 0.999844 val: 0.783099 test: 0.765616
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  38 loss training:  10.249715119367465 Time :  1846
accuracy train: 0.999844 val: 0.781690 test: 0.768430
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  39 loss training:  9.493956054095179 Time :  1857
accuracy train: 0.999844 val: 0.771831 test: 0.767304
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  40 loss training:  8.904672130709514 Time :  1870
accuracy train: 0.999687 val: 0.783099 test: 0.766179
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  41 loss training:  9.15729574020952 Time :  1879
accuracy train: 0.999844 val: 0.769014 test: 0.759707
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  42 loss training:  7.85154764377512 Time :  1892
accuracy train: 0.999844 val: 0.780282 test: 0.770400
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  43 loss training:  8.075004460988566 Time :  1904
accuracy train: 0.999844 val: 0.776056 test: 0.769274
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  44 loss training:  7.194395203143358 Time :  1914
accuracy train: 1.000000 val: 0.776056 test: 0.773213
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  45 loss training:  7.127236603759229 Time :  1926
accuracy train: 0.999687 val: 0.767606 test: 0.771244
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  46 loss training:  6.3566425568424165 Time :  1935
accuracy train: 0.999844 val: 0.770423 test: 0.774902
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  47 loss training:  6.565712338546291 Time :  1946
accuracy train: 0.999844 val: 0.773239 test: 0.761114
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  48 loss training:  6.08230586402351 Time :  1962
accuracy train: 1.000000 val: 0.769014 test: 0.764491
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

Epoch :  49 loss training:  5.805617488920689 Time :  1980
accuracy train: 0.999844 val: 0.766197 test: 0.764772
max validation accuracy : 0.794366 max acc epoch : 18 test accuracy : 0.772088

========================================================================================================================================================================================================
max acc epoch :  18
max validation accuracy :  0.7943661971830986
test accuracy :  0.7720877884074282
last test_accuracy :  0.7647720877884074
second best val :  0.7915492957746478
second best test :  0.7720877884074282
max gap 4
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=145, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  91.80359500646591 Time :  1999
accuracy train: 0.775242 val: 0.776056 test: 0.764772
max validation accuracy : 0.776056 max acc epoch : 1 test accuracy : 0.764772
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.30107082426548 Time :  2009
accuracy train: 0.794311 val: 0.767606 test: 0.772088
max validation accuracy : 0.776056 max acc epoch : 1 test accuracy : 0.764772
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.33882319927216 Time :  2021
accuracy train: 0.814317 val: 0.764789 test: 0.773495
max validation accuracy : 0.776056 max acc epoch : 1 test accuracy : 0.764772
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.7115473151207 Time :  2035
accuracy train: 0.809784 val: 0.754930 test: 0.772088
max validation accuracy : 0.776056 max acc epoch : 1 test accuracy : 0.764772
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  73.77749741077423 Time :  2045
accuracy train: 0.832135 val: 0.771831 test: 0.779403
max validation accuracy : 0.776056 max acc epoch : 1 test accuracy : 0.764772
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.41790141165257 Time :  2060
accuracy train: 0.827602 val: 0.747887 test: 0.768993
max validation accuracy : 0.776056 max acc epoch : 1 test accuracy : 0.764772
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.34076808393002 Time :  2069
accuracy train: 0.850422 val: 0.783099 test: 0.778278
max validation accuracy : 0.783099 max acc epoch : 7 test accuracy : 0.778278
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.42555376887321 Time :  2078
accuracy train: 0.855111 val: 0.778873 test: 0.773213
max validation accuracy : 0.783099 max acc epoch : 7 test accuracy : 0.778278
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.96949988603592 Time :  2095
accuracy train: 0.861832 val: 0.783099 test: 0.774902
max validation accuracy : 0.783099 max acc epoch : 7 test accuracy : 0.778278
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  63.08553163707256 Time :  2104
accuracy train: 0.867146 val: 0.780282 test: 0.777434
max validation accuracy : 0.783099 max acc epoch : 7 test accuracy : 0.778278

Epoch :  11 loss training:  61.327687203884125 Time :  2118
accuracy train: 0.874492 val: 0.780282 test: 0.779122
max validation accuracy : 0.783099 max acc epoch : 7 test accuracy : 0.778278

Epoch :  12 loss training:  58.90542742609978 Time :  2129
accuracy train: 0.886840 val: 0.767606 test: 0.774057
max validation accuracy : 0.783099 max acc epoch : 7 test accuracy : 0.778278

Epoch :  13 loss training:  55.625043511390686 Time :  2144
accuracy train: 0.901219 val: 0.781690 test: 0.773213
max validation accuracy : 0.783099 max acc epoch : 7 test accuracy : 0.778278

Epoch :  14 loss training:  52.63139733672142 Time :  2166
accuracy train: 0.911535 val: 0.795775 test: 0.778841
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.778841

Epoch :  15 loss training:  50.42836597561836 Time :  2182
accuracy train: 0.926540 val: 0.788732 test: 0.774057
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.778841

Epoch :  16 loss training:  47.02452074736357 Time :  2191
accuracy train: 0.936699 val: 0.797183 test: 0.773213
max validation accuracy : 0.797183 max acc epoch : 16 test accuracy : 0.773213

Epoch :  17 loss training:  42.797014996409416 Time :  2207
accuracy train: 0.940450 val: 0.790141 test: 0.775464
max validation accuracy : 0.797183 max acc epoch : 16 test accuracy : 0.773213

Epoch :  18 loss training:  40.9086227864027 Time :  2216
accuracy train: 0.949359 val: 0.800000 test: 0.777434
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  19 loss training:  37.903452299535275 Time :  2228
accuracy train: 0.959831 val: 0.785915 test: 0.771244
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  20 loss training:  36.76764330267906 Time :  2239
accuracy train: 0.968115 val: 0.781690 test: 0.771806
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  21 loss training:  33.44020826369524 Time :  2248
accuracy train: 0.972023 val: 0.784507 test: 0.776027
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  22 loss training:  31.13464307039976 Time :  2262
accuracy train: 0.979837 val: 0.777465 test: 0.770118
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  23 loss training:  28.836721759289503 Time :  2272
accuracy train: 0.980150 val: 0.771831 test: 0.777153
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  24 loss training:  27.071996949613094 Time :  2280
accuracy train: 0.987027 val: 0.783099 test: 0.773213
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  25 loss training:  24.825253136456013 Time :  2294
accuracy train: 0.988434 val: 0.774648 test: 0.772651
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  26 loss training:  23.94455699250102 Time :  2304
accuracy train: 0.989684 val: 0.777465 test: 0.767586
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  27 loss training:  22.478577697649598 Time :  2315
accuracy train: 0.992185 val: 0.770423 test: 0.769555
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  28 loss training:  19.687212677672505 Time :  2331
accuracy train: 0.995155 val: 0.766197 test: 0.767867
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  29 loss training:  19.50863310880959 Time :  2351
accuracy train: 0.995311 val: 0.774648 test: 0.771806
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  30 loss training:  16.919000716879964 Time :  2370
accuracy train: 0.996405 val: 0.774648 test: 0.773213
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  31 loss training:  16.42180864326656 Time :  2381
accuracy train: 0.997187 val: 0.769014 test: 0.769555
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  32 loss training:  15.16011068969965 Time :  2393
accuracy train: 0.996561 val: 0.773239 test: 0.771806
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  33 loss training:  13.247354401275516 Time :  2407
accuracy train: 0.998281 val: 0.773239 test: 0.772932
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  34 loss training:  12.149192763958126 Time :  2417
accuracy train: 0.997812 val: 0.769014 test: 0.768711
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  35 loss training:  12.148891816381365 Time :  2432
accuracy train: 0.998750 val: 0.783099 test: 0.776308
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  36 loss training:  11.312626583036035 Time :  2441
accuracy train: 0.998750 val: 0.771831 test: 0.771525
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  37 loss training:  9.951846371404827 Time :  2452
accuracy train: 0.999375 val: 0.759155 test: 0.761958
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  38 loss training:  10.135256833396852 Time :  2465
accuracy train: 0.999531 val: 0.766197 test: 0.761677
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  39 loss training:  9.1664281017147 Time :  2474
accuracy train: 0.999687 val: 0.767606 test: 0.763647
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  40 loss training:  9.619664324680343 Time :  2485
accuracy train: 0.999531 val: 0.763380 test: 0.763084
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  41 loss training:  9.081364952260628 Time :  2497
accuracy train: 0.999687 val: 0.763380 test: 0.762521
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  42 loss training:  8.001179273473099 Time :  2509
accuracy train: 0.999844 val: 0.766197 test: 0.765616
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  43 loss training:  7.769409315427765 Time :  2531
accuracy train: 0.999687 val: 0.771831 test: 0.768711
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  44 loss training:  8.199562561931089 Time :  2545
accuracy train: 0.999844 val: 0.764789 test: 0.770962
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  45 loss training:  7.1917809748556465 Time :  2558
accuracy train: 0.999844 val: 0.774648 test: 0.766742
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  46 loss training:  6.6451328177936375 Time :  2572
accuracy train: 1.000000 val: 0.774648 test: 0.766460
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  47 loss training:  6.205930371768773 Time :  2580
accuracy train: 0.999844 val: 0.770423 test: 0.760270
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  48 loss training:  5.831288104876876 Time :  2592
accuracy train: 1.000000 val: 0.757746 test: 0.766742
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

Epoch :  49 loss training:  5.876431905431673 Time :  2603
accuracy train: 1.000000 val: 0.763380 test: 0.768711
max validation accuracy : 0.800000 max acc epoch : 18 test accuracy : 0.777434

========================================================================================================================================================================================================
max acc epoch :  18
max validation accuracy :  0.8
test accuracy :  0.7774338773213281
last test_accuracy :  0.7687113111986494
second best val :  0.7971830985915493
second best test :  0.7732132808103546
max gap 7
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=145, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  91.87354996800423 Time :  2614
accuracy train: 0.771022 val: 0.763380 test: 0.764772
max validation accuracy : 0.763380 max acc epoch : 1 test accuracy : 0.764772
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.27426943182945 Time :  2629
accuracy train: 0.783839 val: 0.752113 test: 0.766179
max validation accuracy : 0.763380 max acc epoch : 1 test accuracy : 0.764772
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.14663940668106 Time :  2637
accuracy train: 0.805252 val: 0.754930 test: 0.768430
max validation accuracy : 0.763380 max acc epoch : 1 test accuracy : 0.764772
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.28282272815704 Time :  2648
accuracy train: 0.821038 val: 0.771831 test: 0.776027
max validation accuracy : 0.771831 max acc epoch : 4 test accuracy : 0.776027
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  73.42019993066788 Time :  2658
accuracy train: 0.834011 val: 0.770423 test: 0.779685
max validation accuracy : 0.771831 max acc epoch : 4 test accuracy : 0.776027
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.46071007847786 Time :  2668
accuracy train: 0.833542 val: 0.773239 test: 0.768149
max validation accuracy : 0.773239 max acc epoch : 6 test accuracy : 0.768149
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.22828805446625 Time :  2681
accuracy train: 0.848859 val: 0.785915 test: 0.775746
max validation accuracy : 0.785915 max acc epoch : 7 test accuracy : 0.775746
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.7333464473486 Time :  2695
accuracy train: 0.854017 val: 0.785915 test: 0.777434
max validation accuracy : 0.785915 max acc epoch : 7 test accuracy : 0.775746
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.63236771523952 Time :  2712
accuracy train: 0.861832 val: 0.788732 test: 0.771244
max validation accuracy : 0.788732 max acc epoch : 9 test accuracy : 0.771244
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  63.6934350579977 Time :  2729
accuracy train: 0.864645 val: 0.781690 test: 0.771525
max validation accuracy : 0.788732 max acc epoch : 9 test accuracy : 0.771244

Epoch :  11 loss training:  61.1177764236927 Time :  2741
accuracy train: 0.876368 val: 0.784507 test: 0.775183
max validation accuracy : 0.788732 max acc epoch : 9 test accuracy : 0.771244

Epoch :  12 loss training:  58.66473086178303 Time :  2751
accuracy train: 0.886683 val: 0.788732 test: 0.772088
max validation accuracy : 0.788732 max acc epoch : 9 test accuracy : 0.771244

Epoch :  13 loss training:  56.060771867632866 Time :  2768
accuracy train: 0.904189 val: 0.777465 test: 0.772932
max validation accuracy : 0.788732 max acc epoch : 9 test accuracy : 0.771244

Epoch :  14 loss training:  53.0395098477602 Time :  2778
accuracy train: 0.913723 val: 0.791549 test: 0.776871
max validation accuracy : 0.791549 max acc epoch : 14 test accuracy : 0.776871

Epoch :  15 loss training:  50.532595731318 Time :  2796
accuracy train: 0.925914 val: 0.781690 test: 0.773213
max validation accuracy : 0.791549 max acc epoch : 14 test accuracy : 0.776871

Epoch :  16 loss training:  47.04028584808111 Time :  2805
accuracy train: 0.937637 val: 0.783099 test: 0.770681
max validation accuracy : 0.791549 max acc epoch : 14 test accuracy : 0.776871

Epoch :  17 loss training:  42.659897439181805 Time :  2818
accuracy train: 0.938887 val: 0.785915 test: 0.773213
max validation accuracy : 0.791549 max acc epoch : 14 test accuracy : 0.776871

Epoch :  18 loss training:  40.72898016124964 Time :  2832
accuracy train: 0.952329 val: 0.784507 test: 0.773776
max validation accuracy : 0.791549 max acc epoch : 14 test accuracy : 0.776871

Epoch :  19 loss training:  38.67377711832523 Time :  2842
accuracy train: 0.962645 val: 0.777465 test: 0.771525
max validation accuracy : 0.791549 max acc epoch : 14 test accuracy : 0.776871

Epoch :  20 loss training:  36.622164867818356 Time :  2860
accuracy train: 0.967021 val: 0.776056 test: 0.769555
max validation accuracy : 0.791549 max acc epoch : 14 test accuracy : 0.776871

Epoch :  21 loss training:  33.41321947425604 Time :  2869
accuracy train: 0.970303 val: 0.784507 test: 0.774057
max validation accuracy : 0.791549 max acc epoch : 14 test accuracy : 0.776871

Epoch :  22 loss training:  31.166474483907223 Time :  2882
accuracy train: 0.978743 val: 0.783099 test: 0.769274
max validation accuracy : 0.791549 max acc epoch : 14 test accuracy : 0.776871

Epoch :  23 loss training:  28.930264450609684 Time :  2897
accuracy train: 0.982026 val: 0.783099 test: 0.775464
max validation accuracy : 0.791549 max acc epoch : 14 test accuracy : 0.776871

Epoch :  24 loss training:  27.123588766902685 Time :  2918
accuracy train: 0.986558 val: 0.785915 test: 0.766742
max validation accuracy : 0.791549 max acc epoch : 14 test accuracy : 0.776871

Epoch :  25 loss training:  25.003592735156417 Time :  2943
accuracy train: 0.987809 val: 0.783099 test: 0.777153
max validation accuracy : 0.791549 max acc epoch : 14 test accuracy : 0.776871

Epoch :  26 loss training:  23.716063134372234 Time :  2951
accuracy train: 0.989528 val: 0.790141 test: 0.773213
max validation accuracy : 0.791549 max acc epoch : 14 test accuracy : 0.776871

Epoch :  27 loss training:  22.227902015671134 Time :  2966
accuracy train: 0.989215 val: 0.792958 test: 0.770962
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  28 loss training:  19.785243321210146 Time :  2979
accuracy train: 0.995155 val: 0.777465 test: 0.768430
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  29 loss training:  18.963166818022728 Time :  2988
accuracy train: 0.995624 val: 0.781690 test: 0.770400
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  30 loss training:  17.389824921265244 Time :  3006
accuracy train: 0.996718 val: 0.787324 test: 0.771244
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  31 loss training:  16.10389732941985 Time :  3015
accuracy train: 0.998281 val: 0.790141 test: 0.764772
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  32 loss training:  14.834404967725277 Time :  3030
accuracy train: 0.995936 val: 0.790141 test: 0.768149
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  33 loss training:  13.144784999080002 Time :  3042
accuracy train: 0.997812 val: 0.787324 test: 0.767586
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  34 loss training:  12.014399426057935 Time :  3051
accuracy train: 0.998437 val: 0.780282 test: 0.772088
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  35 loss training:  12.240057823248208 Time :  3067
accuracy train: 0.998593 val: 0.780282 test: 0.766742
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  36 loss training:  11.815485519822687 Time :  3075
accuracy train: 0.999062 val: 0.780282 test: 0.768711
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  37 loss training:  10.13424458540976 Time :  3091
accuracy train: 0.999062 val: 0.780282 test: 0.762802
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  38 loss training:  10.315835048444569 Time :  3113
accuracy train: 0.999375 val: 0.771831 test: 0.761677
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  39 loss training:  9.57668760465458 Time :  3130
accuracy train: 0.999375 val: 0.771831 test: 0.762802
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  40 loss training:  10.071065633092076 Time :  3145
accuracy train: 0.999531 val: 0.780282 test: 0.761677
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  41 loss training:  9.005567772546783 Time :  3154
accuracy train: 0.999531 val: 0.769014 test: 0.763365
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  42 loss training:  7.797462430084124 Time :  3163
accuracy train: 0.999687 val: 0.774648 test: 0.762521
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  43 loss training:  7.686669312417507 Time :  3180
accuracy train: 0.999687 val: 0.769014 test: 0.765616
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  44 loss training:  7.283084090100601 Time :  3189
accuracy train: 1.000000 val: 0.766197 test: 0.764772
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  45 loss training:  6.5459117870777845 Time :  3204
accuracy train: 1.000000 val: 0.778873 test: 0.763365
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  46 loss training:  5.763235207879916 Time :  3216
accuracy train: 0.999844 val: 0.773239 test: 0.764772
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  47 loss training:  6.1874020856339484 Time :  3225
accuracy train: 1.000000 val: 0.760563 test: 0.760551
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  48 loss training:  5.799562318949029 Time :  3242
accuracy train: 1.000000 val: 0.766197 test: 0.764209
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  49 loss training:  5.3725586120272055 Time :  3250
accuracy train: 1.000000 val: 0.761972 test: 0.763647
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  50 loss training:  5.248102866637055 Time :  3265
accuracy train: 1.000000 val: 0.769014 test: 0.764491
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  51 loss training:  5.898819539579563 Time :  3277
accuracy train: 1.000000 val: 0.770423 test: 0.760270
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  52 loss training:  4.619692224718165 Time :  3290
accuracy train: 1.000000 val: 0.752113 test: 0.759426
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  53 loss training:  5.771442798897624 Time :  3314
accuracy train: 1.000000 val: 0.771831 test: 0.755768
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  54 loss training:  5.056566047598608 Time :  3333
accuracy train: 1.000000 val: 0.763380 test: 0.758019
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  55 loss training:  4.383596469589975 Time :  3343
accuracy train: 1.000000 val: 0.770423 test: 0.759707
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  56 loss training:  4.564575171330944 Time :  3359
accuracy train: 1.000000 val: 0.770423 test: 0.755768
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  57 loss training:  4.19347830535844 Time :  3367
accuracy train: 1.000000 val: 0.756338 test: 0.750985
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

Epoch :  58 loss training:  4.04799840162741 Time :  3385
accuracy train: 1.000000 val: 0.757746 test: 0.756612
max validation accuracy : 0.792958 max acc epoch : 27 test accuracy : 0.770962

========================================================================================================================================================================================================
max acc epoch :  27
max validation accuracy :  0.7929577464788733
test accuracy :  0.770962296004502
last test_accuracy :  0.7566122678671919
second best val :  0.7915492957746478
second best test :  0.7768711311198649
max gap 13
========================================================================================================================================================================================================

itr : 6
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=145, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  91.97828543186188 Time :  3395
accuracy train: 0.774930 val: 0.759155 test: 0.764209
max validation accuracy : 0.759155 max acc epoch : 1 test accuracy : 0.764209
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.09362471103668 Time :  3405
accuracy train: 0.796343 val: 0.766197 test: 0.778278
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.778278
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.92373847961426 Time :  3418
accuracy train: 0.813223 val: 0.773239 test: 0.776027
max validation accuracy : 0.773239 max acc epoch : 3 test accuracy : 0.776027
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.12137645483017 Time :  3427
accuracy train: 0.817287 val: 0.773239 test: 0.778278
max validation accuracy : 0.773239 max acc epoch : 3 test accuracy : 0.776027
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.96272027492523 Time :  3438
accuracy train: 0.834011 val: 0.771831 test: 0.778278
max validation accuracy : 0.773239 max acc epoch : 3 test accuracy : 0.776027
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.34589263796806 Time :  3451
accuracy train: 0.835730 val: 0.760563 test: 0.766460
max validation accuracy : 0.773239 max acc epoch : 3 test accuracy : 0.776027
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.90475089848042 Time :  3459
accuracy train: 0.854329 val: 0.774648 test: 0.780529
max validation accuracy : 0.774648 max acc epoch : 7 test accuracy : 0.780529
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.83489599823952 Time :  3470
accuracy train: 0.861519 val: 0.783099 test: 0.775746
max validation accuracy : 0.783099 max acc epoch : 8 test accuracy : 0.775746
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.12016107141972 Time :  3483
accuracy train: 0.866364 val: 0.770423 test: 0.776871
max validation accuracy : 0.783099 max acc epoch : 8 test accuracy : 0.775746
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.54577773809433 Time :  3495
accuracy train: 0.872148 val: 0.776056 test: 0.775183
max validation accuracy : 0.783099 max acc epoch : 8 test accuracy : 0.775746

Epoch :  11 loss training:  60.74774785339832 Time :  3516
accuracy train: 0.880275 val: 0.778873 test: 0.774620
max validation accuracy : 0.783099 max acc epoch : 8 test accuracy : 0.775746

Epoch :  12 loss training:  58.26852285861969 Time :  3532
accuracy train: 0.895905 val: 0.777465 test: 0.769837
max validation accuracy : 0.783099 max acc epoch : 8 test accuracy : 0.775746

Epoch :  13 loss training:  55.65781597793102 Time :  3543
accuracy train: 0.909972 val: 0.776056 test: 0.773495
max validation accuracy : 0.783099 max acc epoch : 8 test accuracy : 0.775746

Epoch :  14 loss training:  51.96758484840393 Time :  3554
accuracy train: 0.916224 val: 0.790141 test: 0.778559
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  15 loss training:  49.43106645345688 Time :  3563
accuracy train: 0.930760 val: 0.770423 test: 0.769837
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  16 loss training:  46.81911876052618 Time :  3577
accuracy train: 0.938731 val: 0.771831 test: 0.771244
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  17 loss training:  41.93731081485748 Time :  3588
accuracy train: 0.942013 val: 0.785915 test: 0.771525
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  18 loss training:  39.91399647295475 Time :  3598
accuracy train: 0.957643 val: 0.785915 test: 0.771244
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  19 loss training:  38.01256034523249 Time :  3613
accuracy train: 0.964520 val: 0.783099 test: 0.772369
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  20 loss training:  35.59402071684599 Time :  3622
accuracy train: 0.972804 val: 0.777465 test: 0.768430
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  21 loss training:  32.73779334127903 Time :  3632
accuracy train: 0.974992 val: 0.780282 test: 0.773495
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  22 loss training:  30.59348525106907 Time :  3645
accuracy train: 0.982182 val: 0.773239 test: 0.766460
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  23 loss training:  27.980652831494808 Time :  3654
accuracy train: 0.984370 val: 0.777465 test: 0.768711
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  24 loss training:  27.11407281458378 Time :  3664
accuracy train: 0.989059 val: 0.787324 test: 0.769274
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  25 loss training:  24.527382276952267 Time :  3677
accuracy train: 0.990935 val: 0.778873 test: 0.770118
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  26 loss training:  23.855170564725995 Time :  3688
accuracy train: 0.992185 val: 0.774648 test: 0.772088
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  27 loss training:  21.631706301122904 Time :  3703
accuracy train: 0.993279 val: 0.764789 test: 0.765053
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  28 loss training:  18.992491090670228 Time :  3728
accuracy train: 0.997187 val: 0.761972 test: 0.764209
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  29 loss training:  19.012508548796177 Time :  3737
accuracy train: 0.996093 val: 0.773239 test: 0.767586
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  30 loss training:  16.289445960894227 Time :  3754
accuracy train: 0.996561 val: 0.777465 test: 0.765898
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  31 loss training:  15.887241267599165 Time :  3765
accuracy train: 0.998750 val: 0.774648 test: 0.767304
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  32 loss training:  14.208543374203146 Time :  3775
accuracy train: 0.997812 val: 0.776056 test: 0.765616
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  33 loss training:  13.464154578745365 Time :  3791
accuracy train: 0.998750 val: 0.784507 test: 0.767586
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  34 loss training:  11.738925328012556 Time :  3800
accuracy train: 0.999219 val: 0.787324 test: 0.764772
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  35 loss training:  11.69371747970581 Time :  3812
accuracy train: 0.999375 val: 0.771831 test: 0.766742
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  36 loss training:  11.50642980216071 Time :  3822
accuracy train: 0.999531 val: 0.780282 test: 0.768430
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  37 loss training:  10.401118464767933 Time :  3831
accuracy train: 0.999531 val: 0.773239 test: 0.765616
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  38 loss training:  9.708080986049026 Time :  3846
accuracy train: 0.999844 val: 0.771831 test: 0.763084
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  39 loss training:  9.143650024197996 Time :  3856
accuracy train: 0.999687 val: 0.778873 test: 0.762521
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  40 loss training:  9.57545793056488 Time :  3864
accuracy train: 0.999844 val: 0.777465 test: 0.762521
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  41 loss training:  9.1233006719267 Time :  3876
accuracy train: 0.999844 val: 0.767606 test: 0.759707
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  42 loss training:  8.076533930609003 Time :  3890
accuracy train: 0.999844 val: 0.767606 test: 0.756894
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  43 loss training:  7.3266108757816255 Time :  3903
accuracy train: 0.999844 val: 0.776056 test: 0.768149
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  44 loss training:  6.994970464613289 Time :  3916
accuracy train: 1.000000 val: 0.767606 test: 0.766179
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

Epoch :  45 loss training:  6.681062452495098 Time :  3930
accuracy train: 1.000000 val: 0.778873 test: 0.763647
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.778559

========================================================================================================================================================================================================
max acc epoch :  14
max validation accuracy :  0.7901408450704225
test accuracy :  0.7785593697242543
last test_accuracy :  0.7636465953854812
second best val :  0.7873239436619718
second best test :  0.7785593697242543
max gap 6
========================================================================================================================================================================================================

itr : 7
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=145, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  92.00670912861824 Time :  3940
accuracy train: 0.776180 val: 0.769014 test: 0.765616
max validation accuracy : 0.769014 max acc epoch : 1 test accuracy : 0.765616
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.43930768966675 Time :  3949
accuracy train: 0.795405 val: 0.778873 test: 0.776027
max validation accuracy : 0.778873 max acc epoch : 2 test accuracy : 0.776027
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.05896157026291 Time :  3962
accuracy train: 0.812129 val: 0.774648 test: 0.776590
max validation accuracy : 0.778873 max acc epoch : 2 test accuracy : 0.776027
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.66393586993217 Time :  3971
accuracy train: 0.814004 val: 0.767606 test: 0.773776
max validation accuracy : 0.778873 max acc epoch : 2 test accuracy : 0.776027
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  73.60245294868946 Time :  3980
accuracy train: 0.831822 val: 0.764789 test: 0.774339
max validation accuracy : 0.778873 max acc epoch : 2 test accuracy : 0.776027
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.52254983782768 Time :  3992
accuracy train: 0.832917 val: 0.767606 test: 0.770962
max validation accuracy : 0.778873 max acc epoch : 2 test accuracy : 0.776027
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.24351967871189 Time :  4003
accuracy train: 0.851829 val: 0.776056 test: 0.780248
max validation accuracy : 0.778873 max acc epoch : 2 test accuracy : 0.776027
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.20340771973133 Time :  4012
accuracy train: 0.857768 val: 0.770423 test: 0.770962
max validation accuracy : 0.778873 max acc epoch : 2 test accuracy : 0.776027
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.08119750022888 Time :  4022
accuracy train: 0.860581 val: 0.784507 test: 0.777997
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.777997
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  63.15957435965538 Time :  4032
accuracy train: 0.868865 val: 0.770423 test: 0.776027
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.777997

Epoch :  11 loss training:  61.068751841783524 Time :  4041
accuracy train: 0.879494 val: 0.770423 test: 0.777434
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.777997

Epoch :  12 loss training:  58.592938244342804 Time :  4050
accuracy train: 0.887465 val: 0.774648 test: 0.777715
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.777997

Epoch :  13 loss training:  55.90175575017929 Time :  4062
accuracy train: 0.899500 val: 0.784507 test: 0.774057
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.777997

Epoch :  14 loss training:  52.60932105779648 Time :  4074
accuracy train: 0.914192 val: 0.780282 test: 0.777997
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.777997

Epoch :  15 loss training:  49.70916295051575 Time :  4089
accuracy train: 0.923726 val: 0.774648 test: 0.773776
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.777997

Epoch :  16 loss training:  46.865708112716675 Time :  4109
accuracy train: 0.932635 val: 0.784507 test: 0.769837
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.777997

Epoch :  17 loss training:  42.80673458427191 Time :  4120
accuracy train: 0.941857 val: 0.785915 test: 0.774339
max validation accuracy : 0.785915 max acc epoch : 17 test accuracy : 0.774339

Epoch :  18 loss training:  40.60328786820173 Time :  4128
accuracy train: 0.955142 val: 0.788732 test: 0.772088
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  19 loss training:  38.17708285152912 Time :  4140
accuracy train: 0.962488 val: 0.780282 test: 0.772088
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  20 loss training:  36.22607747465372 Time :  4150
accuracy train: 0.972023 val: 0.787324 test: 0.768430
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  21 loss training:  32.572326473891735 Time :  4159
accuracy train: 0.973742 val: 0.785915 test: 0.773495
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  22 loss training:  31.170373644679785 Time :  4170
accuracy train: 0.978587 val: 0.777465 test: 0.767586
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  23 loss training:  28.6452377140522 Time :  4183
accuracy train: 0.982338 val: 0.776056 test: 0.772088
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  24 loss training:  26.725979302078485 Time :  4193
accuracy train: 0.985933 val: 0.773239 test: 0.770400
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  25 loss training:  24.91356521844864 Time :  4205
accuracy train: 0.989059 val: 0.778873 test: 0.774057
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  26 loss training:  23.312653491273522 Time :  4213
accuracy train: 0.992185 val: 0.766197 test: 0.772651
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  27 loss training:  21.72475336305797 Time :  4223
accuracy train: 0.993435 val: 0.776056 test: 0.764772
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  28 loss training:  18.791469351388514 Time :  4235
accuracy train: 0.995311 val: 0.773239 test: 0.767867
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  29 loss training:  18.686166901141405 Time :  4243
accuracy train: 0.996405 val: 0.771831 test: 0.765053
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  30 loss training:  17.184632902033627 Time :  4252
accuracy train: 0.996874 val: 0.785915 test: 0.771806
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  31 loss training:  16.436102457344532 Time :  4266
accuracy train: 0.997499 val: 0.780282 test: 0.765053
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  32 loss training:  14.528414610773325 Time :  4273
accuracy train: 0.997187 val: 0.783099 test: 0.768711
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  33 loss training:  13.128375133499503 Time :  4280
accuracy train: 0.998437 val: 0.778873 test: 0.772651
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  34 loss training:  11.90311246085912 Time :  4295
accuracy train: 0.998906 val: 0.781690 test: 0.771806
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  35 loss training:  12.090438662096858 Time :  4304
accuracy train: 0.999062 val: 0.770423 test: 0.767586
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  36 loss training:  11.814563959371299 Time :  4312
accuracy train: 0.999062 val: 0.770423 test: 0.764209
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  37 loss training:  9.967119622975588 Time :  4326
accuracy train: 0.999531 val: 0.774648 test: 0.763647
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  38 loss training:  9.829424408264458 Time :  4336
accuracy train: 0.999687 val: 0.761972 test: 0.756050
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  39 loss training:  9.417795887682587 Time :  4349
accuracy train: 0.999375 val: 0.766197 test: 0.758863
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  40 loss training:  9.310921707656235 Time :  4359
accuracy train: 0.999687 val: 0.770423 test: 0.763084
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  41 loss training:  8.741706842556596 Time :  4366
accuracy train: 0.999531 val: 0.756338 test: 0.759989
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  42 loss training:  7.778330912580714 Time :  4381
accuracy train: 1.000000 val: 0.757746 test: 0.760270
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  43 loss training:  6.905636767856777 Time :  4388
accuracy train: 0.999531 val: 0.764789 test: 0.763647
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  44 loss training:  7.689818258397281 Time :  4397
accuracy train: 0.999844 val: 0.773239 test: 0.765898
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  45 loss training:  7.494523545727134 Time :  4410
accuracy train: 0.999844 val: 0.773239 test: 0.766742
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  46 loss training:  6.982589446008205 Time :  4417
accuracy train: 1.000000 val: 0.766197 test: 0.765898
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  47 loss training:  6.392426839796826 Time :  4425
accuracy train: 0.999844 val: 0.761972 test: 0.759426
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  48 loss training:  6.182424242608249 Time :  4437
accuracy train: 1.000000 val: 0.766197 test: 0.765053
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

Epoch :  49 loss training:  5.646597576560453 Time :  4447
accuracy train: 1.000000 val: 0.759155 test: 0.767867
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.772088

========================================================================================================================================================================================================
max acc epoch :  18
max validation accuracy :  0.7887323943661971
test accuracy :  0.7720877884074282
last test_accuracy :  0.7678671918964547
second best val :  0.7873239436619718
second best test :  0.7720877884074282
max gap 8
========================================================================================================================================================================================================

itr : 8
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=145, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  91.99228140711784 Time :  4459
accuracy train: 0.774148 val: 0.763380 test: 0.768711
max validation accuracy : 0.763380 max acc epoch : 1 test accuracy : 0.768711
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.3002318739891 Time :  4472
accuracy train: 0.792279 val: 0.761972 test: 0.777715
max validation accuracy : 0.763380 max acc epoch : 1 test accuracy : 0.768711
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.25227493047714 Time :  4482
accuracy train: 0.814161 val: 0.770423 test: 0.775183
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.775183
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.9006931334734 Time :  4492
accuracy train: 0.816505 val: 0.774648 test: 0.777715
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777715
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  73.58391010761261 Time :  4505
accuracy train: 0.832448 val: 0.778873 test: 0.777997
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.777997
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.42992728948593 Time :  4516
accuracy train: 0.827602 val: 0.771831 test: 0.767304
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.777997
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.43734058737755 Time :  4524
accuracy train: 0.848546 val: 0.780282 test: 0.777715
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.777715
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.27449396252632 Time :  4537
accuracy train: 0.857143 val: 0.770423 test: 0.772651
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.777715
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.65488646924496 Time :  4549
accuracy train: 0.862613 val: 0.790141 test: 0.776871
max validation accuracy : 0.790141 max acc epoch : 9 test accuracy : 0.776871
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  63.331335708498955 Time :  4562
accuracy train: 0.866677 val: 0.788732 test: 0.777434
max validation accuracy : 0.790141 max acc epoch : 9 test accuracy : 0.776871

Epoch :  11 loss training:  61.53728298842907 Time :  4574
accuracy train: 0.875117 val: 0.780282 test: 0.774620
max validation accuracy : 0.790141 max acc epoch : 9 test accuracy : 0.776871

Epoch :  12 loss training:  58.99573627114296 Time :  4586
accuracy train: 0.890435 val: 0.778873 test: 0.772088
max validation accuracy : 0.790141 max acc epoch : 9 test accuracy : 0.776871

Epoch :  13 loss training:  56.29114469885826 Time :  4598
accuracy train: 0.904189 val: 0.785915 test: 0.770681
max validation accuracy : 0.790141 max acc epoch : 9 test accuracy : 0.776871

Epoch :  14 loss training:  52.43557794392109 Time :  4610
accuracy train: 0.914036 val: 0.798592 test: 0.772651
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  15 loss training:  50.47798082232475 Time :  4624
accuracy train: 0.927165 val: 0.785915 test: 0.772651
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  16 loss training:  47.18103691935539 Time :  4635
accuracy train: 0.937637 val: 0.794366 test: 0.770681
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  17 loss training:  42.99742962419987 Time :  4649
accuracy train: 0.939669 val: 0.790141 test: 0.772369
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  18 loss training:  40.701677426695824 Time :  4661
accuracy train: 0.952954 val: 0.791549 test: 0.775746
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  19 loss training:  38.28434269875288 Time :  4672
accuracy train: 0.959831 val: 0.785915 test: 0.774057
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  20 loss training:  37.03635124117136 Time :  4684
accuracy train: 0.968897 val: 0.774648 test: 0.772369
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  21 loss training:  33.645228795707226 Time :  4697
accuracy train: 0.972648 val: 0.783099 test: 0.775464
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  22 loss training:  31.379915438592434 Time :  4708
accuracy train: 0.978900 val: 0.784507 test: 0.770118
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  23 loss training:  28.800809789448977 Time :  4721
accuracy train: 0.981244 val: 0.773239 test: 0.777153
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  24 loss training:  27.025921422988176 Time :  4734
accuracy train: 0.985933 val: 0.783099 test: 0.769837
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  25 loss training:  24.91484285518527 Time :  4745
accuracy train: 0.988746 val: 0.781690 test: 0.775746
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  26 loss training:  23.854885548353195 Time :  4757
accuracy train: 0.988903 val: 0.783099 test: 0.774057
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  27 loss training:  21.87896258942783 Time :  4771
accuracy train: 0.991091 val: 0.783099 test: 0.770118
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  28 loss training:  19.965775053948164 Time :  4781
accuracy train: 0.994842 val: 0.777465 test: 0.773213
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  29 loss training:  19.67668610997498 Time :  4792
accuracy train: 0.995155 val: 0.781690 test: 0.772369
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  30 loss training:  17.35063017345965 Time :  4806
accuracy train: 0.996405 val: 0.787324 test: 0.768993
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  31 loss training:  16.59447967261076 Time :  4817
accuracy train: 0.997968 val: 0.783099 test: 0.769837
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  32 loss training:  14.68873010482639 Time :  4829
accuracy train: 0.996874 val: 0.781690 test: 0.770962
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  33 loss training:  13.545007165521383 Time :  4845
accuracy train: 0.998281 val: 0.778873 test: 0.769274
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  34 loss training:  12.279425616376102 Time :  4856
accuracy train: 0.998593 val: 0.777465 test: 0.771244
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  35 loss training:  12.267488401848823 Time :  4865
accuracy train: 0.999219 val: 0.778873 test: 0.770400
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  36 loss training:  11.54370195325464 Time :  4879
accuracy train: 0.999531 val: 0.776056 test: 0.766179
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  37 loss training:  9.783381208777428 Time :  4890
accuracy train: 0.999531 val: 0.781690 test: 0.762802
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  38 loss training:  9.925702335778624 Time :  4902
accuracy train: 0.999531 val: 0.778873 test: 0.763365
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  39 loss training:  9.178072233684361 Time :  4918
accuracy train: 0.999687 val: 0.763380 test: 0.762240
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  40 loss training:  9.601275632157922 Time :  4933
accuracy train: 0.999531 val: 0.771831 test: 0.764209
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  41 loss training:  9.158678037580103 Time :  4944
accuracy train: 0.999844 val: 0.769014 test: 0.765616
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  42 loss training:  7.9223646223545074 Time :  4956
accuracy train: 1.000000 val: 0.764789 test: 0.760833
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  43 loss training:  8.071090844925493 Time :  4969
accuracy train: 0.999844 val: 0.769014 test: 0.769555
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  44 loss training:  7.174871858209372 Time :  4982
accuracy train: 1.000000 val: 0.767606 test: 0.769274
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

Epoch :  45 loss training:  6.890121444128454 Time :  4993
accuracy train: 1.000000 val: 0.769014 test: 0.770400
max validation accuracy : 0.798592 max acc epoch : 14 test accuracy : 0.772651

========================================================================================================================================================================================================
max acc epoch :  14
max validation accuracy :  0.7985915492957747
test accuracy :  0.7726505346088914
last test_accuracy :  0.7703995498030388
second best val :  0.7943661971830986
second best test :  0.7726505346088914
max gap 5
========================================================================================================================================================================================================

itr : 9
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=145, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  91.84687113761902 Time :  5005
accuracy train: 0.776024 val: 0.766197 test: 0.765616
max validation accuracy : 0.766197 max acc epoch : 1 test accuracy : 0.765616
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.13229002058506 Time :  5020
accuracy train: 0.787277 val: 0.767606 test: 0.772369
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.772369
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.85050678253174 Time :  5032
accuracy train: 0.807752 val: 0.757746 test: 0.777715
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.772369
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.68496215343475 Time :  5047
accuracy train: 0.820725 val: 0.764789 test: 0.777715
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.772369
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  73.31768637895584 Time :  5059
accuracy train: 0.836355 val: 0.764789 test: 0.778559
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.772369
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.13883078098297 Time :  5069
accuracy train: 0.838856 val: 0.761972 test: 0.767304
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.772369
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.76598177850246 Time :  5083
accuracy train: 0.854329 val: 0.781690 test: 0.769837
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.769837
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.82818149030209 Time :  5093
accuracy train: 0.863082 val: 0.774648 test: 0.776308
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.769837
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.59599222242832 Time :  5107
accuracy train: 0.867771 val: 0.781690 test: 0.775464
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.769837
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.28280891478062 Time :  5122
accuracy train: 0.873085 val: 0.773239 test: 0.768993
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.769837

Epoch :  11 loss training:  59.8536419570446 Time :  5137
accuracy train: 0.883870 val: 0.778873 test: 0.769837
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.769837

Epoch :  12 loss training:  57.86247882246971 Time :  5148
accuracy train: 0.894967 val: 0.767606 test: 0.767304
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.769837

Epoch :  13 loss training:  54.82237100601196 Time :  5160
accuracy train: 0.911691 val: 0.776056 test: 0.767023
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.769837

Epoch :  14 loss training:  51.12613886594772 Time :  5173
accuracy train: 0.919037 val: 0.784507 test: 0.771525
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  15 loss training:  49.444334372878075 Time :  5189
accuracy train: 0.934511 val: 0.774648 test: 0.767023
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  16 loss training:  46.30604851990938 Time :  5205
accuracy train: 0.943264 val: 0.778873 test: 0.767023
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  17 loss training:  41.419648975133896 Time :  5217
accuracy train: 0.945764 val: 0.770423 test: 0.768711
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  18 loss training:  39.85179739445448 Time :  5230
accuracy train: 0.958737 val: 0.784507 test: 0.770400
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  19 loss training:  37.418816059827805 Time :  5243
accuracy train: 0.963270 val: 0.784507 test: 0.770118
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  20 loss training:  36.085648126900196 Time :  5256
accuracy train: 0.972023 val: 0.783099 test: 0.763928
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  21 loss training:  31.254375718533993 Time :  5268
accuracy train: 0.975617 val: 0.780282 test: 0.772651
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  22 loss training:  29.90133561939001 Time :  5283
accuracy train: 0.983901 val: 0.777465 test: 0.763365
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  23 loss training:  27.35658400505781 Time :  5298
accuracy train: 0.986402 val: 0.778873 test: 0.764491
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  24 loss training:  26.25863002613187 Time :  5309
accuracy train: 0.989841 val: 0.784507 test: 0.766742
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  25 loss training:  23.92687406204641 Time :  5321
accuracy train: 0.991091 val: 0.777465 test: 0.768430
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  26 loss training:  23.035661505535245 Time :  5334
accuracy train: 0.993435 val: 0.769014 test: 0.763084
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  27 loss training:  20.725656040012836 Time :  5349
accuracy train: 0.994373 val: 0.777465 test: 0.763084
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  28 loss training:  19.006567219272256 Time :  5360
accuracy train: 0.995467 val: 0.776056 test: 0.756612
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  29 loss training:  17.95120851136744 Time :  5371
accuracy train: 0.996561 val: 0.781690 test: 0.761958
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  30 loss training:  16.228874258697033 Time :  5388
accuracy train: 0.996874 val: 0.780282 test: 0.766742
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  31 loss training:  15.893461055122316 Time :  5401
accuracy train: 0.998750 val: 0.777465 test: 0.761677
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  32 loss training:  14.324815187603235 Time :  5411
accuracy train: 0.998437 val: 0.783099 test: 0.766179
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  33 loss training:  12.90787366963923 Time :  5429
accuracy train: 0.998593 val: 0.780282 test: 0.764772
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  34 loss training:  11.939236151520163 Time :  5439
accuracy train: 0.998906 val: 0.774648 test: 0.763084
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  35 loss training:  11.74143222719431 Time :  5448
accuracy train: 0.999375 val: 0.773239 test: 0.761114
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  36 loss training:  11.699071028269827 Time :  5465
accuracy train: 0.999687 val: 0.774648 test: 0.768149
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  37 loss training:  10.074076680466533 Time :  5478
accuracy train: 0.999687 val: 0.773239 test: 0.757175
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  38 loss training:  10.065046957461163 Time :  5494
accuracy train: 1.000000 val: 0.771831 test: 0.759989
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  39 loss training:  9.283020042581484 Time :  5513
accuracy train: 0.999844 val: 0.764789 test: 0.758019
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  40 loss training:  8.893063101684675 Time :  5525
accuracy train: 0.999844 val: 0.769014 test: 0.754924
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  41 loss training:  8.805181459756568 Time :  5537
accuracy train: 0.999844 val: 0.771831 test: 0.756331
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  42 loss training:  7.63295283773914 Time :  5551
accuracy train: 1.000000 val: 0.769014 test: 0.761677
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  43 loss training:  7.848766221199185 Time :  5561
accuracy train: 0.999844 val: 0.770423 test: 0.765335
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  44 loss training:  6.95864389417693 Time :  5574
accuracy train: 1.000000 val: 0.774648 test: 0.765616
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

Epoch :  45 loss training:  6.10195049806498 Time :  5588
accuracy train: 1.000000 val: 0.769014 test: 0.761396
max validation accuracy : 0.784507 max acc epoch : 14 test accuracy : 0.771525

========================================================================================================================================================================================================
max acc epoch :  14
max validation accuracy :  0.7845070422535211
test accuracy :  0.7715250422059651
last test_accuracy :  0.7613956105796286
second best val :  0.7830985915492957
second best test :  0.7715250422059651
max gap 7
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 max_acc epoch :  14 	 val_accuracy : 0.79718 	 test_accuracy : 0.77715 	 last test_accuracy : 0.77265 	 second best val : 0.79577 	 second best test : 0.77715
k :  1 	 max_acc epoch :  9 	 val_accuracy : 0.78451 	 test_accuracy : 0.77349 	 last test_accuracy : 0.75689 	 second best val : 0.78310 	 second best test : 0.77349
k :  2 	 max_acc epoch :  7 	 val_accuracy : 0.78169 	 test_accuracy : 0.77743 	 last test_accuracy : 0.75295 	 second best val : 0.77606 	 second best test : 0.77743
k :  3 	 max_acc epoch :  18 	 val_accuracy : 0.79437 	 test_accuracy : 0.77209 	 last test_accuracy : 0.76477 	 second best val : 0.79155 	 second best test : 0.77209
k :  4 	 max_acc epoch :  18 	 val_accuracy : 0.80000 	 test_accuracy : 0.77743 	 last test_accuracy : 0.76871 	 second best val : 0.79718 	 second best test : 0.77321
k :  5 	 max_acc epoch :  27 	 val_accuracy : 0.79296 	 test_accuracy : 0.77096 	 last test_accuracy : 0.75661 	 second best val : 0.79155 	 second best test : 0.77687
k :  6 	 max_acc epoch :  14 	 val_accuracy : 0.79014 	 test_accuracy : 0.77856 	 last test_accuracy : 0.76365 	 second best val : 0.78732 	 second best test : 0.77856
k :  7 	 max_acc epoch :  18 	 val_accuracy : 0.78873 	 test_accuracy : 0.77209 	 last test_accuracy : 0.76787 	 second best val : 0.78732 	 second best test : 0.77209
k :  8 	 max_acc epoch :  14 	 val_accuracy : 0.79859 	 test_accuracy : 0.77265 	 last test_accuracy : 0.77040 	 second best val : 0.79437 	 second best test : 0.77265
k :  9 	 max_acc epoch :  14 	 val_accuracy : 0.78451 	 test_accuracy : 0.77153 	 last test_accuracy : 0.76140 	 second best val : 0.78310 	 second best test : 0.77153
(5,)

avg :  	 val_accuracy : 0.79127 	 test_accuracy : 0.77434 	 last_accuracy : 0.76359 	 second best val : 0.78873 	 second best test : 0.77451

std :  	 val_accuracy : 0.00607 	 test_accuracy : 0.00279 	 last_accuracy : 0.00621 	 second best val : 0.00630 	 second best test : 0.00254
