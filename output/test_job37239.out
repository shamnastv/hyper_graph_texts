

date and time :  Sat Jun 12 13:39:22 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=990, weight_decay=0)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  41.79674570634961 Time :  22
accuracy train: 0.960614 val: 0.952727 test: 0.950685
max validation accuracy : 0.952727 max acc epoch : 1 test accuracy : 0.950685
Counter({0: 4063, 1: 3628})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.168226124718785 Time :  41
accuracy train: 0.963442 val: 0.945455 test: 0.958904
max validation accuracy : 0.952727 max acc epoch : 1 test accuracy : 0.950685
Counter({0: 4038, 1: 3653})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.08624248765409 Time :  60
accuracy train: 0.981822 val: 0.960000 test: 0.968493
max validation accuracy : 0.960000 max acc epoch : 3 test accuracy : 0.968493
Counter({0: 3930, 1: 3761})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.962351101450622 Time :  77
accuracy train: 0.981418 val: 0.963636 test: 0.967123
max validation accuracy : 0.963636 max acc epoch : 4 test accuracy : 0.967123
Counter({0: 3901, 1: 3790})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.748057730263099 Time :  95
accuracy train: 0.985861 val: 0.967273 test: 0.971689
max validation accuracy : 0.967273 max acc epoch : 5 test accuracy : 0.971689
Counter({0: 3860, 1: 3831})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.632430357974954 Time :  114
accuracy train: 0.987881 val: 0.974545 test: 0.967123
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967123
Counter({0: 3849, 1: 3842})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.222655775491148 Time :  133
accuracy train: 0.988285 val: 0.965455 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967123
Counter({0: 3848, 1: 3843})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.114845929900184 Time :  154
accuracy train: 0.990103 val: 0.963636 test: 0.976256
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967123
Counter({1: 3853, 0: 3838})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.106729673454538 Time :  173
accuracy train: 0.991921 val: 0.967273 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967123
Counter({1: 3862, 0: 3829})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.53348426008597 Time :  194
accuracy train: 0.993537 val: 0.969091 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967123
Counter({0: 3869, 1: 3822})

Epoch :  11 loss training:  5.064985426957719 Time :  214
accuracy train: 0.993335 val: 0.970909 test: 0.974886
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967123
Counter({1: 3871, 0: 3820})

Epoch :  12 loss training:  4.631887419614941 Time :  234
accuracy train: 0.992325 val: 0.970909 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967123
Counter({1: 3875, 0: 3816})

Epoch :  13 loss training:  4.558642459800467 Time :  257
accuracy train: 0.992729 val: 0.972727 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967123
Counter({0: 3882, 1: 3809})

Epoch :  14 loss training:  4.094816586468369 Time :  277
accuracy train: 0.994143 val: 0.967273 test: 0.974429
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967123
Counter({1: 3891, 0: 3800})

Epoch :  15 loss training:  3.8387531195767224 Time :  298
accuracy train: 0.994951 val: 0.969091 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967123
Counter({1: 3890, 0: 3801})

Epoch :  16 loss training:  3.495410474599339 Time :  316
accuracy train: 0.995758 val: 0.974545 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967123
Counter({1: 3892, 0: 3799})

Epoch :  17 loss training:  3.251832592213759 Time :  337
accuracy train: 0.995152 val: 0.972727 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967123
Counter({1: 3896, 0: 3795})

Epoch :  18 loss training:  3.129031357704662 Time :  356
accuracy train: 0.995354 val: 0.970909 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967123
Counter({1: 3896, 0: 3795})

Epoch :  19 loss training:  3.252706321392907 Time :  375
accuracy train: 0.995960 val: 0.974545 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967123
Counter({1: 3898, 0: 3793})

Epoch :  20 loss training:  3.0403048644657247 Time :  397
accuracy train: 0.996162 val: 0.976364 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 20 test accuracy : 0.968037
Counter({1: 3909, 0: 3782})

Epoch :  21 loss training:  2.532941724144621 Time :  417
accuracy train: 0.995758 val: 0.978182 test: 0.967123
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.967123
Counter({0: 3925, 1: 3766})

Epoch :  22 loss training:  2.491193126363214 Time :  436
accuracy train: 0.995758 val: 0.980000 test: 0.970320
max validation accuracy : 0.980000 max acc epoch : 22 test accuracy : 0.970320
Counter({1: 3924, 0: 3767})

Epoch :  23 loss training:  2.2862318601401057 Time :  456
accuracy train: 0.995758 val: 0.974545 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 22 test accuracy : 0.970320
Counter({1: 3925, 0: 3766})

Epoch :  24 loss training:  2.3451281715970254 Time :  475
accuracy train: 0.996162 val: 0.972727 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 22 test accuracy : 0.970320
Counter({1: 3925, 0: 3766})

Epoch :  25 loss training:  2.384770012460649 Time :  501
accuracy train: 0.996162 val: 0.972727 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 22 test accuracy : 0.970320
Counter({1: 3925, 0: 3766})

Epoch :  26 loss training:  2.352037231925351 Time :  521
accuracy train: 0.996566 val: 0.972727 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 22 test accuracy : 0.970320
Counter({1: 3924, 0: 3767})

Epoch :  27 loss training:  2.1971352363107144 Time :  540
accuracy train: 0.996364 val: 0.969091 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 22 test accuracy : 0.970320
Counter({1: 3925, 0: 3766})

Epoch :  28 loss training:  1.9314164088427788 Time :  561
accuracy train: 0.996364 val: 0.972727 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 22 test accuracy : 0.970320
Counter({0: 3925, 1: 3766})

Epoch :  29 loss training:  2.1202571567082487 Time :  583
accuracy train: 0.996970 val: 0.981818 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3925, 0: 3766})

Epoch :  30 loss training:  1.9232911869185045 Time :  603
accuracy train: 0.996566 val: 0.974545 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3925, 0: 3766})

Epoch :  31 loss training:  1.8130262855120236 Time :  628
accuracy train: 0.996970 val: 0.974545 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({0: 3925, 1: 3766})

Epoch :  32 loss training:  1.9845223443990108 Time :  650
accuracy train: 0.996970 val: 0.976364 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({0: 3926, 1: 3765})

Epoch :  33 loss training:  2.0406804497979465 Time :  670
accuracy train: 0.997374 val: 0.978182 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3927, 0: 3764})

Epoch :  34 loss training:  1.6617264474989497 Time :  690
accuracy train: 0.996970 val: 0.972727 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3929, 0: 3762})

Epoch :  35 loss training:  1.6128353648309712 Time :  710
accuracy train: 0.997374 val: 0.974545 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3929, 0: 3762})

Epoch :  36 loss training:  1.5703163418602344 Time :  731
accuracy train: 0.997374 val: 0.974545 test: 0.974886
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3929, 0: 3762})

Epoch :  37 loss training:  1.6557311037977342 Time :  754
accuracy train: 0.997374 val: 0.976364 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({0: 3929, 1: 3762})

Epoch :  38 loss training:  1.5680579951658729 Time :  781
accuracy train: 0.997374 val: 0.978182 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3929, 0: 3762})

Epoch :  39 loss training:  1.7797797195016756 Time :  801
accuracy train: 0.997374 val: 0.974545 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3929, 0: 3762})

Epoch :  40 loss training:  1.4695238208951196 Time :  823
accuracy train: 0.997576 val: 0.972727 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3928, 0: 3763})

Epoch :  41 loss training:  1.551016698249441 Time :  843
accuracy train: 0.997374 val: 0.974545 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({0: 3928, 1: 3763})

Epoch :  42 loss training:  1.2325461967811862 Time :  865
accuracy train: 0.997374 val: 0.972727 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3928, 0: 3763})

Epoch :  43 loss training:  1.3899551248578064 Time :  886
accuracy train: 0.997576 val: 0.974545 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3928, 0: 3763})

Epoch :  44 loss training:  1.3887525769605418 Time :  916
accuracy train: 0.997576 val: 0.974545 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3928, 0: 3763})

Epoch :  45 loss training:  1.4171793714158412 Time :  936
accuracy train: 0.997576 val: 0.974545 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3928, 0: 3763})

Epoch :  46 loss training:  1.3675783023209078 Time :  955
accuracy train: 0.997374 val: 0.976364 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3928, 0: 3763})

Epoch :  47 loss training:  1.4121753327781335 Time :  975
accuracy train: 0.997576 val: 0.976364 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3928, 0: 3763})

Epoch :  48 loss training:  1.5265062883081555 Time :  995
accuracy train: 0.997576 val: 0.976364 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3929, 0: 3762})

Epoch :  49 loss training:  1.4203464736674505 Time :  1016
accuracy train: 0.997576 val: 0.974545 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({0: 3929, 1: 3762})

Epoch :  50 loss training:  1.29961236078816 Time :  1045
accuracy train: 0.997172 val: 0.970909 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3929, 0: 3762})

Epoch :  51 loss training:  1.2674974622714217 Time :  1065
accuracy train: 0.997576 val: 0.972727 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3929, 0: 3762})

Epoch :  52 loss training:  1.3010583958493953 Time :  1086
accuracy train: 0.997576 val: 0.974545 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3929, 0: 3762})

Epoch :  53 loss training:  1.6583569341928523 Time :  1106
accuracy train: 0.997172 val: 0.970909 test: 0.974886
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({0: 3929, 1: 3762})

Epoch :  54 loss training:  1.6147594832018513 Time :  1126
accuracy train: 0.997374 val: 0.976364 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3929, 0: 3762})

Epoch :  55 loss training:  1.0921532261818356 Time :  1146
accuracy train: 0.997374 val: 0.967273 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3929, 0: 3762})

Epoch :  56 loss training:  1.1941339491677354 Time :  1174
accuracy train: 0.997576 val: 0.969091 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3930, 0: 3761})

Epoch :  57 loss training:  1.1010046372248325 Time :  1195
accuracy train: 0.997374 val: 0.969091 test: 0.975342
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3930, 0: 3761})

Epoch :  58 loss training:  1.2728883253021195 Time :  1214
accuracy train: 0.997576 val: 0.972727 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3930, 0: 3761})

Epoch :  59 loss training:  1.130735552564147 Time :  1234
accuracy train: 0.997374 val: 0.972727 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3930, 0: 3761})

Epoch :  60 loss training:  1.2151776413538755 Time :  1255
accuracy train: 0.997374 val: 0.970909 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3930, 0: 3761})

========================================================================================================================================================================================================
best acc epoch :  29
validation accuracy :  0.9818181818181818
test accuracy :  0.9712328767123287
last test_accuracy :  0.971689497716895
second best val :  0.98
second best test :  0.9703196347031964
max gap 14
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=990, weight_decay=0)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  41.76230353116989 Time :  1280
accuracy train: 0.960210 val: 0.950909 test: 0.949772
max validation accuracy : 0.950909 max acc epoch : 1 test accuracy : 0.949772
Counter({0: 4057, 1: 3634})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.294673282653093 Time :  1310
accuracy train: 0.963644 val: 0.943636 test: 0.957078
max validation accuracy : 0.950909 max acc epoch : 1 test accuracy : 0.949772
Counter({1: 4029, 0: 3662})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.13909474760294 Time :  1328
accuracy train: 0.979802 val: 0.972727 test: 0.962557
max validation accuracy : 0.972727 max acc epoch : 3 test accuracy : 0.962557
Counter({0: 3960, 1: 3731})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.976795798400417 Time :  1348
accuracy train: 0.983640 val: 0.960000 test: 0.966667
max validation accuracy : 0.972727 max acc epoch : 3 test accuracy : 0.962557
Counter({0: 3907, 1: 3784})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.714372692862526 Time :  1366
accuracy train: 0.985861 val: 0.969091 test: 0.972146
max validation accuracy : 0.972727 max acc epoch : 3 test accuracy : 0.962557
Counter({0: 3864, 1: 3827})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.370304135605693 Time :  1385
accuracy train: 0.988083 val: 0.974545 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({0: 3866, 1: 3825})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.176136955618858 Time :  1405
accuracy train: 0.988891 val: 0.965455 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({0: 3869, 1: 3822})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.933014983776957 Time :  1427
accuracy train: 0.991315 val: 0.963636 test: 0.975342
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({0: 3856, 1: 3835})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  4.928622585721314 Time :  1446
accuracy train: 0.993133 val: 0.969091 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({0: 3847, 1: 3844})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.355100507498719 Time :  1464
accuracy train: 0.992931 val: 0.969091 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({0: 3856, 1: 3835})

Epoch :  11 loss training:  4.969779000151902 Time :  1484
accuracy train: 0.992931 val: 0.970909 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({1: 3858, 0: 3833})

Epoch :  12 loss training:  4.398107510060072 Time :  1502
accuracy train: 0.993133 val: 0.970909 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({1: 3862, 0: 3829})

Epoch :  13 loss training:  4.580281899718102 Time :  1521
accuracy train: 0.994345 val: 0.972727 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({1: 3877, 0: 3814})

Epoch :  14 loss training:  3.9634903293917887 Time :  1542
accuracy train: 0.994547 val: 0.965455 test: 0.974429
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({1: 3884, 0: 3807})

Epoch :  15 loss training:  3.673776703857584 Time :  1568
accuracy train: 0.995556 val: 0.970909 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({1: 3885, 0: 3806})

Epoch :  16 loss training:  3.295617102907272 Time :  1590
accuracy train: 0.995556 val: 0.970909 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({1: 3892, 0: 3799})

Epoch :  17 loss training:  3.2364047820155974 Time :  1610
accuracy train: 0.994951 val: 0.974545 test: 0.974886
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({1: 3894, 0: 3797})

Epoch :  18 loss training:  2.9966071052476764 Time :  1629
accuracy train: 0.995960 val: 0.972727 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({1: 3899, 0: 3792})

Epoch :  19 loss training:  2.9972886884352192 Time :  1651
accuracy train: 0.995960 val: 0.969091 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({1: 3900, 0: 3791})

Epoch :  20 loss training:  2.9199260261957534 Time :  1672
accuracy train: 0.995758 val: 0.970909 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({0: 3904, 1: 3787})

Epoch :  21 loss training:  2.570642369275447 Time :  1697
accuracy train: 0.995960 val: 0.970909 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({0: 3924, 1: 3767})

Epoch :  22 loss training:  2.345910914213164 Time :  1715
accuracy train: 0.995758 val: 0.972727 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({1: 3923, 0: 3768})

Epoch :  23 loss training:  2.2778396633220837 Time :  1737
accuracy train: 0.995758 val: 0.972727 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({0: 3924, 1: 3767})

Epoch :  24 loss training:  2.2788848361960845 Time :  1756
accuracy train: 0.995960 val: 0.967273 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({1: 3924, 0: 3767})

Epoch :  25 loss training:  2.281692575314082 Time :  1777
accuracy train: 0.995960 val: 0.965455 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({1: 3924, 0: 3767})

Epoch :  26 loss training:  2.3730729618982878 Time :  1797
accuracy train: 0.996566 val: 0.967273 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({0: 3924, 1: 3767})

Epoch :  27 loss training:  2.1287871598178754 Time :  1824
accuracy train: 0.996768 val: 0.965455 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({1: 3923, 0: 3768})

Epoch :  28 loss training:  1.8434973431139952 Time :  1844
accuracy train: 0.996768 val: 0.970909 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({1: 3923, 0: 3768})

Epoch :  29 loss training:  2.1612360166036524 Time :  1862
accuracy train: 0.996970 val: 0.974545 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({1: 3923, 0: 3768})

Epoch :  30 loss training:  1.9522487096255645 Time :  1883
accuracy train: 0.996768 val: 0.967273 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({1: 3923, 0: 3768})

Epoch :  31 loss training:  1.8894498161389492 Time :  1902
accuracy train: 0.996970 val: 0.967273 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({0: 3923, 1: 3768})

Epoch :  32 loss training:  1.7730452902032994 Time :  1923
accuracy train: 0.996970 val: 0.970909 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({0: 3926, 1: 3765})

Epoch :  33 loss training:  1.9701310148375342 Time :  1950
accuracy train: 0.997374 val: 0.970909 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({1: 3930, 0: 3761})

Epoch :  34 loss training:  1.6037698936306697 Time :  1969
accuracy train: 0.996970 val: 0.970909 test: 0.976256
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({1: 3930, 0: 3761})

Epoch :  35 loss training:  1.6589366737025557 Time :  1989
accuracy train: 0.997172 val: 0.972727 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({1: 3930, 0: 3761})

Epoch :  36 loss training:  1.785849424348271 Time :  2009
accuracy train: 0.997374 val: 0.974545 test: 0.976256
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({1: 3930, 0: 3761})

Epoch :  37 loss training:  1.636654088164505 Time :  2028
accuracy train: 0.997576 val: 0.974545 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.966667
Counter({1: 3930, 0: 3761})

========================================================================================================================================================================================================
best acc epoch :  6
validation accuracy :  0.9745454545454545
test accuracy :  0.9666666666666667
last test_accuracy :  0.9739726027397261
second best val :  0.9727272727272728
second best test :  0.9625570776255707
max gap 3
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=990, weight_decay=0)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  41.768004078418016 Time :  2055
accuracy train: 0.959402 val: 0.952727 test: 0.950685
max validation accuracy : 0.952727 max acc epoch : 1 test accuracy : 0.950685
Counter({0: 4070, 1: 3621})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.29856078326702 Time :  2078
accuracy train: 0.961018 val: 0.945455 test: 0.958904
max validation accuracy : 0.952727 max acc epoch : 1 test accuracy : 0.950685
Counter({0: 4040, 1: 3651})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.087396362796426 Time :  2096
accuracy train: 0.980206 val: 0.965455 test: 0.966667
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.966667
Counter({0: 3955, 1: 3736})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.90059502585791 Time :  2115
accuracy train: 0.983438 val: 0.965455 test: 0.966667
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.966667
Counter({0: 3904, 1: 3787})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.99456742964685 Time :  2134
accuracy train: 0.985256 val: 0.967273 test: 0.971689
max validation accuracy : 0.967273 max acc epoch : 5 test accuracy : 0.971689
Counter({0: 3868, 1: 3823})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.472292796708643 Time :  2153
accuracy train: 0.987881 val: 0.969091 test: 0.967123
max validation accuracy : 0.969091 max acc epoch : 6 test accuracy : 0.967123
Counter({1: 3859, 0: 3832})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.239928463706747 Time :  2172
accuracy train: 0.988689 val: 0.965455 test: 0.973059
max validation accuracy : 0.969091 max acc epoch : 6 test accuracy : 0.967123
Counter({0: 3863, 1: 3828})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.068771501770243 Time :  2198
accuracy train: 0.990911 val: 0.965455 test: 0.975799
max validation accuracy : 0.969091 max acc epoch : 6 test accuracy : 0.967123
Counter({1: 3857, 0: 3834})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.11234087171033 Time :  2216
accuracy train: 0.992123 val: 0.963636 test: 0.971233
max validation accuracy : 0.969091 max acc epoch : 6 test accuracy : 0.967123
Counter({0: 3849, 1: 3842})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.443261140491813 Time :  2234
accuracy train: 0.993133 val: 0.970909 test: 0.970776
max validation accuracy : 0.970909 max acc epoch : 10 test accuracy : 0.970776
Counter({1: 3849, 0: 3842})

Epoch :  11 loss training:  4.965009733801708 Time :  2255
accuracy train: 0.993335 val: 0.970909 test: 0.971233
max validation accuracy : 0.970909 max acc epoch : 10 test accuracy : 0.970776
Counter({1: 3850, 0: 3841})

Epoch :  12 loss training:  4.538733826135285 Time :  2276
accuracy train: 0.992123 val: 0.965455 test: 0.972603
max validation accuracy : 0.970909 max acc epoch : 10 test accuracy : 0.970776
Counter({1: 3852, 0: 3839})

Epoch :  13 loss training:  4.494195319362916 Time :  2298
accuracy train: 0.993739 val: 0.969091 test: 0.973059
max validation accuracy : 0.970909 max acc epoch : 10 test accuracy : 0.970776
Counter({1: 3869, 0: 3822})

Epoch :  14 loss training:  4.090717017417774 Time :  2323
accuracy train: 0.994143 val: 0.969091 test: 0.975799
max validation accuracy : 0.970909 max acc epoch : 10 test accuracy : 0.970776
Counter({1: 3876, 0: 3815})

Epoch :  15 loss training:  3.687529139628168 Time :  2343
accuracy train: 0.995556 val: 0.972727 test: 0.971689
max validation accuracy : 0.972727 max acc epoch : 15 test accuracy : 0.971689
Counter({1: 3879, 0: 3812})

Epoch :  16 loss training:  3.35137259127805 Time :  2364
accuracy train: 0.995354 val: 0.972727 test: 0.973973
max validation accuracy : 0.972727 max acc epoch : 15 test accuracy : 0.971689
Counter({1: 3886, 0: 3805})

Epoch :  17 loss training:  3.2979372278496157 Time :  2384
accuracy train: 0.994951 val: 0.970909 test: 0.975342
max validation accuracy : 0.972727 max acc epoch : 15 test accuracy : 0.971689
Counter({1: 3892, 0: 3799})

Epoch :  18 loss training:  2.9876188746420667 Time :  2403
accuracy train: 0.995758 val: 0.969091 test: 0.972603
max validation accuracy : 0.972727 max acc epoch : 15 test accuracy : 0.971689
Counter({1: 3898, 0: 3793})

Epoch :  19 loss training:  3.2168241903418675 Time :  2426
accuracy train: 0.995758 val: 0.972727 test: 0.973516
max validation accuracy : 0.972727 max acc epoch : 15 test accuracy : 0.971689
Counter({1: 3901, 0: 3790})

Epoch :  20 loss training:  3.0373418026138097 Time :  2449
accuracy train: 0.996162 val: 0.972727 test: 0.969863
max validation accuracy : 0.972727 max acc epoch : 15 test accuracy : 0.971689
Counter({1: 3906, 0: 3785})

Epoch :  21 loss training:  2.6033461846527644 Time :  2471
accuracy train: 0.995960 val: 0.974545 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 21 test accuracy : 0.969863
Counter({1: 3923, 0: 3768})

Epoch :  22 loss training:  2.3344452978635672 Time :  2491
accuracy train: 0.995758 val: 0.974545 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 21 test accuracy : 0.969863
Counter({0: 3923, 1: 3768})

Epoch :  23 loss training:  2.2791878520074533 Time :  2511
accuracy train: 0.995960 val: 0.974545 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 21 test accuracy : 0.969863
Counter({1: 3925, 0: 3766})

Epoch :  24 loss training:  2.353774040690041 Time :  2529
accuracy train: 0.996162 val: 0.972727 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 21 test accuracy : 0.969863
Counter({0: 3925, 1: 3766})

Epoch :  25 loss training:  2.2503210856812075 Time :  2550
accuracy train: 0.996364 val: 0.972727 test: 0.976256
max validation accuracy : 0.974545 max acc epoch : 21 test accuracy : 0.969863
Counter({1: 3925, 0: 3766})

Epoch :  26 loss training:  2.356884170549165 Time :  2572
accuracy train: 0.996566 val: 0.970909 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 21 test accuracy : 0.969863
Counter({1: 3924, 0: 3767})

Epoch :  27 loss training:  2.107828003936447 Time :  2598
accuracy train: 0.996566 val: 0.969091 test: 0.974886
max validation accuracy : 0.974545 max acc epoch : 21 test accuracy : 0.969863
Counter({1: 3924, 0: 3767})

Epoch :  28 loss training:  1.9089149903156795 Time :  2619
accuracy train: 0.996768 val: 0.970909 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 21 test accuracy : 0.969863
Counter({1: 3924, 0: 3767})

Epoch :  29 loss training:  2.0647038080132916 Time :  2639
accuracy train: 0.997172 val: 0.978182 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3924, 0: 3767})

Epoch :  30 loss training:  1.874181282502832 Time :  2658
accuracy train: 0.996566 val: 0.972727 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3924, 0: 3767})

Epoch :  31 loss training:  1.8815348268690286 Time :  2677
accuracy train: 0.996970 val: 0.970909 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3924, 0: 3767})

Epoch :  32 loss training:  1.7200087039091159 Time :  2701
accuracy train: 0.997172 val: 0.974545 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3925, 0: 3766})

Epoch :  33 loss training:  1.9538290235359455 Time :  2723
accuracy train: 0.997576 val: 0.976364 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3926, 0: 3765})

Epoch :  34 loss training:  1.7472284859686624 Time :  2744
accuracy train: 0.997172 val: 0.969091 test: 0.975799
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3930, 0: 3761})

Epoch :  35 loss training:  1.6061851620470406 Time :  2764
accuracy train: 0.997172 val: 0.970909 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3930, 0: 3761})

Epoch :  36 loss training:  1.5380172302284336 Time :  2784
accuracy train: 0.997374 val: 0.972727 test: 0.976256
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3929, 0: 3762})

Epoch :  37 loss training:  1.5893137698512874 Time :  2804
accuracy train: 0.997374 val: 0.974545 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3929, 0: 3762})

Epoch :  38 loss training:  1.5864973567295237 Time :  2829
accuracy train: 0.997576 val: 0.974545 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3929, 0: 3762})

Epoch :  39 loss training:  1.7449167505110381 Time :  2851
accuracy train: 0.997374 val: 0.976364 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3929, 0: 3762})

Epoch :  40 loss training:  1.4710311076014477 Time :  2872
accuracy train: 0.997576 val: 0.974545 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3928, 0: 3763})

Epoch :  41 loss training:  1.6316681733587757 Time :  2891
accuracy train: 0.997576 val: 0.974545 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3929, 0: 3762})

Epoch :  42 loss training:  1.2886011645314284 Time :  2910
accuracy train: 0.997576 val: 0.974545 test: 0.975799
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3929, 0: 3762})

Epoch :  43 loss training:  1.4764867097037495 Time :  2931
accuracy train: 0.997576 val: 0.970909 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3929, 0: 3762})

Epoch :  44 loss training:  1.4038078805788246 Time :  2954
accuracy train: 0.997576 val: 0.974545 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3929, 0: 3762})

Epoch :  45 loss training:  1.4136140591472213 Time :  2979
accuracy train: 0.997576 val: 0.974545 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({0: 3929, 1: 3762})

Epoch :  46 loss training:  1.3121112249646103 Time :  2999
accuracy train: 0.997576 val: 0.972727 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3929, 0: 3762})

Epoch :  47 loss training:  1.524381224400713 Time :  3019
accuracy train: 0.997576 val: 0.974545 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3930, 0: 3761})

Epoch :  48 loss training:  1.4544185557970195 Time :  3039
accuracy train: 0.997576 val: 0.970909 test: 0.975799
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3930, 0: 3761})

Epoch :  49 loss training:  1.4801949612046883 Time :  3060
accuracy train: 0.997576 val: 0.970909 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({0: 3930, 1: 3761})

Epoch :  50 loss training:  1.3825996421655873 Time :  3082
accuracy train: 0.997172 val: 0.969091 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3930, 0: 3761})

Epoch :  51 loss training:  1.2477283915141015 Time :  3108
accuracy train: 0.997576 val: 0.974545 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3930, 0: 3761})

Epoch :  52 loss training:  1.175450085036573 Time :  3129
accuracy train: 0.997374 val: 0.974545 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3930, 0: 3761})

Epoch :  53 loss training:  1.5201959287333011 Time :  3149
accuracy train: 0.997374 val: 0.972727 test: 0.978082
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({0: 3930, 1: 3761})

Epoch :  54 loss training:  1.4512240951899003 Time :  3169
accuracy train: 0.997374 val: 0.976364 test: 0.975799
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3929, 0: 3762})

Epoch :  55 loss training:  1.0590634596446762 Time :  3190
accuracy train: 0.997374 val: 0.969091 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3929, 0: 3762})

Epoch :  56 loss training:  1.1852673388057156 Time :  3213
accuracy train: 0.997576 val: 0.969091 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3930, 0: 3761})

Epoch :  57 loss training:  1.129386881399114 Time :  3235
accuracy train: 0.997374 val: 0.969091 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3930, 0: 3761})

Epoch :  58 loss training:  1.472147521781153 Time :  3256
accuracy train: 0.997576 val: 0.969091 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3930, 0: 3761})

Epoch :  59 loss training:  1.0908810662585893 Time :  3277
accuracy train: 0.997374 val: 0.972727 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3930, 0: 3761})

Epoch :  60 loss training:  1.1454263795512816 Time :  3299
accuracy train: 0.997576 val: 0.972727 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 29 test accuracy : 0.973059
Counter({1: 3930, 0: 3761})

========================================================================================================================================================================================================
best acc epoch :  29
validation accuracy :  0.9781818181818182
test accuracy :  0.9730593607305936
last test_accuracy :  0.971689497716895
second best val :  0.9763636363636363
second best test :  0.9730593607305936
max gap 8
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=990, weight_decay=0)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  41.64221518859267 Time :  3324
accuracy train: 0.959402 val: 0.954545 test: 0.952511
max validation accuracy : 0.954545 max acc epoch : 1 test accuracy : 0.952511
Counter({0: 4094, 1: 3597})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.352340653538704 Time :  3355
accuracy train: 0.964048 val: 0.941818 test: 0.959817
max validation accuracy : 0.954545 max acc epoch : 1 test accuracy : 0.952511
Counter({0: 4050, 1: 3641})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.796564337797463 Time :  3375
accuracy train: 0.981822 val: 0.963636 test: 0.966667
max validation accuracy : 0.963636 max acc epoch : 3 test accuracy : 0.966667
Counter({0: 3932, 1: 3759})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.859789481386542 Time :  3394
accuracy train: 0.983640 val: 0.963636 test: 0.966210
max validation accuracy : 0.963636 max acc epoch : 3 test accuracy : 0.966667
Counter({0: 3904, 1: 3787})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.519485121127218 Time :  3414
accuracy train: 0.986467 val: 0.967273 test: 0.967580
max validation accuracy : 0.967273 max acc epoch : 5 test accuracy : 0.967580
Counter({0: 3871, 1: 3820})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.420103190816008 Time :  3433
accuracy train: 0.987477 val: 0.972727 test: 0.968037
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({0: 3861, 1: 3830})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.292873088736087 Time :  3454
accuracy train: 0.988891 val: 0.967273 test: 0.973516
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({0: 3859, 1: 3832})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.087501996429637 Time :  3481
accuracy train: 0.989497 val: 0.963636 test: 0.976712
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({0: 3850, 1: 3841})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.054896330926567 Time :  3503
accuracy train: 0.991517 val: 0.963636 test: 0.972603
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({1: 3846, 0: 3845})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.668076403788291 Time :  3522
accuracy train: 0.993335 val: 0.967273 test: 0.972603
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({1: 3853, 0: 3838})

Epoch :  11 loss training:  5.026304621133022 Time :  3543
accuracy train: 0.992325 val: 0.967273 test: 0.972146
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({1: 3856, 0: 3835})

Epoch :  12 loss training:  4.574129012646154 Time :  3565
accuracy train: 0.991921 val: 0.967273 test: 0.973516
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({1: 3860, 0: 3831})

Epoch :  13 loss training:  4.503102620772552 Time :  3585
accuracy train: 0.992931 val: 0.969091 test: 0.975799
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({1: 3876, 0: 3815})

Epoch :  14 loss training:  4.07233947358327 Time :  3613
accuracy train: 0.994345 val: 0.965455 test: 0.975342
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({1: 3885, 0: 3806})

Epoch :  15 loss training:  3.7817012155719567 Time :  3634
accuracy train: 0.995556 val: 0.970909 test: 0.971689
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({1: 3886, 0: 3805})

Epoch :  16 loss training:  3.4711509853368625 Time :  3656
accuracy train: 0.995354 val: 0.970909 test: 0.973516
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({0: 3895, 1: 3796})

Epoch :  17 loss training:  3.3245206456485903 Time :  3676
accuracy train: 0.994749 val: 0.969091 test: 0.976712
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({1: 3898, 0: 3793})

Epoch :  18 loss training:  2.993687889073044 Time :  3698
accuracy train: 0.995354 val: 0.969091 test: 0.972146
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({1: 3899, 0: 3792})

Epoch :  19 loss training:  3.018660759291379 Time :  3718
accuracy train: 0.995758 val: 0.970909 test: 0.972603
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({1: 3899, 0: 3792})

Epoch :  20 loss training:  3.0841672299138736 Time :  3749
accuracy train: 0.995556 val: 0.970909 test: 0.969863
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({1: 3909, 0: 3782})

Epoch :  21 loss training:  2.644303656357806 Time :  3769
accuracy train: 0.995556 val: 0.969091 test: 0.971233
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({1: 3921, 0: 3770})

Epoch :  22 loss training:  2.355569617036963 Time :  3790
accuracy train: 0.995354 val: 0.972727 test: 0.972603
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({1: 3922, 0: 3769})

Epoch :  23 loss training:  2.322582819208037 Time :  3811
accuracy train: 0.995758 val: 0.969091 test: 0.973516
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({0: 3922, 1: 3769})

Epoch :  24 loss training:  2.3186917086713947 Time :  3832
accuracy train: 0.996162 val: 0.965455 test: 0.973059
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({0: 3922, 1: 3769})

Epoch :  25 loss training:  2.2243548685510177 Time :  3854
accuracy train: 0.996162 val: 0.967273 test: 0.975799
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({1: 3922, 0: 3769})

Epoch :  26 loss training:  2.5112198457791237 Time :  3883
accuracy train: 0.996364 val: 0.967273 test: 0.973516
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({1: 3921, 0: 3770})

Epoch :  27 loss training:  2.171524806144589 Time :  3904
accuracy train: 0.996364 val: 0.969091 test: 0.976256
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({1: 3922, 0: 3769})

Epoch :  28 loss training:  1.8340858366864268 Time :  3922
accuracy train: 0.996566 val: 0.972727 test: 0.973516
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({0: 3923, 1: 3768})

Epoch :  29 loss training:  2.056147984116251 Time :  3944
accuracy train: 0.997172 val: 0.972727 test: 0.971689
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({1: 3923, 0: 3768})

Epoch :  30 loss training:  1.8297717809764436 Time :  3965
accuracy train: 0.996566 val: 0.970909 test: 0.971233
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({1: 3923, 0: 3768})

Epoch :  31 loss training:  1.9135904357681284 Time :  3986
accuracy train: 0.996768 val: 0.969091 test: 0.974429
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({0: 3924, 1: 3767})

Epoch :  32 loss training:  1.7688384820066858 Time :  4016
accuracy train: 0.996970 val: 0.969091 test: 0.972146
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({0: 3925, 1: 3766})

Epoch :  33 loss training:  1.9848358784802258 Time :  4036
accuracy train: 0.996970 val: 0.972727 test: 0.972603
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({1: 3926, 0: 3765})

Epoch :  34 loss training:  1.6566057965610526 Time :  4055
accuracy train: 0.997172 val: 0.969091 test: 0.973516
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({1: 3928, 0: 3763})

Epoch :  35 loss training:  1.6519563981055398 Time :  4076
accuracy train: 0.997374 val: 0.970909 test: 0.972146
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({1: 3928, 0: 3763})

Epoch :  36 loss training:  1.5959223622339778 Time :  4097
accuracy train: 0.997172 val: 0.969091 test: 0.976712
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.968037
Counter({0: 3928, 1: 3763})

Epoch :  37 loss training:  1.5955433272320079 Time :  4116
accuracy train: 0.997374 val: 0.974545 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3928, 0: 3763})

Epoch :  38 loss training:  1.6355368168988207 Time :  4144
accuracy train: 0.997576 val: 0.970909 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3928, 0: 3763})

Epoch :  39 loss training:  1.6811406344932038 Time :  4163
accuracy train: 0.997374 val: 0.969091 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3928, 0: 3763})

Epoch :  40 loss training:  1.397261543526838 Time :  4183
accuracy train: 0.997374 val: 0.970909 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3928, 0: 3763})

Epoch :  41 loss training:  1.6220207517162635 Time :  4203
accuracy train: 0.997374 val: 0.970909 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({0: 3928, 1: 3763})

Epoch :  42 loss training:  1.2378218273152015 Time :  4224
accuracy train: 0.997374 val: 0.967273 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3928, 0: 3763})

Epoch :  43 loss training:  1.4096748798328917 Time :  4244
accuracy train: 0.997374 val: 0.970909 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3928, 0: 3763})

Epoch :  44 loss training:  1.364832752617076 Time :  4270
accuracy train: 0.997374 val: 0.970909 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3928, 0: 3763})

Epoch :  45 loss training:  1.4338285052544961 Time :  4289
accuracy train: 0.997374 val: 0.969091 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3928, 0: 3763})

Epoch :  46 loss training:  1.3943336728516442 Time :  4309
accuracy train: 0.997172 val: 0.969091 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({0: 3928, 1: 3763})

Epoch :  47 loss training:  1.5428810857483768 Time :  4332
accuracy train: 0.997576 val: 0.969091 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({0: 3928, 1: 3763})

Epoch :  48 loss training:  1.446980748380156 Time :  4351
accuracy train: 0.997374 val: 0.969091 test: 0.976712
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3928, 0: 3763})

Epoch :  49 loss training:  1.5337568047170862 Time :  4372
accuracy train: 0.997576 val: 0.969091 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({0: 3928, 1: 3763})

Epoch :  50 loss training:  1.3723643467546935 Time :  4394
accuracy train: 0.997172 val: 0.965455 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3928, 0: 3763})

Epoch :  51 loss training:  1.2562313106645888 Time :  4414
accuracy train: 0.997374 val: 0.967273 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3928, 0: 3763})

Epoch :  52 loss training:  1.3597031721437816 Time :  4434
accuracy train: 0.997374 val: 0.970909 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3928, 0: 3763})

Epoch :  53 loss training:  1.617536551084413 Time :  4454
accuracy train: 0.997374 val: 0.965455 test: 0.976712
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({0: 3928, 1: 3763})

Epoch :  54 loss training:  1.4764808859708864 Time :  4473
accuracy train: 0.997374 val: 0.970909 test: 0.974429
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3927, 0: 3764})

Epoch :  55 loss training:  1.0261353672285622 Time :  4493
accuracy train: 0.997374 val: 0.967273 test: 0.974429
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3927, 0: 3764})

Epoch :  56 loss training:  1.2196290051651886 Time :  4517
accuracy train: 0.997374 val: 0.970909 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3927, 0: 3764})

Epoch :  57 loss training:  1.1150690056110761 Time :  4537
accuracy train: 0.997374 val: 0.967273 test: 0.975342
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3927, 0: 3764})

Epoch :  58 loss training:  1.3680851356257335 Time :  4557
accuracy train: 0.997576 val: 0.965455 test: 0.974429
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3926, 0: 3765})

Epoch :  59 loss training:  1.2423832359345397 Time :  4576
accuracy train: 0.997374 val: 0.965455 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3926, 0: 3765})

Epoch :  60 loss training:  1.3081867578966921 Time :  4594
accuracy train: 0.997374 val: 0.965455 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3926, 0: 3765})

Epoch :  61 loss training:  1.1671406964796915 Time :  4615
accuracy train: 0.997576 val: 0.967273 test: 0.975799
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3926, 0: 3765})

Epoch :  62 loss training:  1.059389417157945 Time :  4642
accuracy train: 0.997576 val: 0.963636 test: 0.974429
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3926, 0: 3765})

Epoch :  63 loss training:  1.0533235959865124 Time :  4660
accuracy train: 0.997172 val: 0.960000 test: 0.974429
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3926, 0: 3765})

Epoch :  64 loss training:  1.151486926337384 Time :  4678
accuracy train: 0.997374 val: 0.965455 test: 0.974429
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3926, 0: 3765})

Epoch :  65 loss training:  1.134368992373311 Time :  4697
accuracy train: 0.997576 val: 0.967273 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3926, 0: 3765})

Epoch :  66 loss training:  1.2739666897396091 Time :  4718
accuracy train: 0.997576 val: 0.967273 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3926, 0: 3765})

Epoch :  67 loss training:  1.0492760329143493 Time :  4738
accuracy train: 0.997576 val: 0.967273 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3926, 0: 3765})

Epoch :  68 loss training:  1.0981225582854677 Time :  4763
accuracy train: 0.997374 val: 0.970909 test: 0.974886
max validation accuracy : 0.974545 max acc epoch : 37 test accuracy : 0.972146
Counter({1: 3926, 0: 3765})

========================================================================================================================================================================================================
best acc epoch :  37
validation accuracy :  0.9745454545454545
test accuracy :  0.9721461187214612
last test_accuracy :  0.9748858447488584
second best val :  0.9727272727272728
second best test :  0.9680365296803652
max gap 31
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=990, weight_decay=0)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  41.63278894498944 Time :  4787
accuracy train: 0.958392 val: 0.952727 test: 0.952055
max validation accuracy : 0.952727 max acc epoch : 1 test accuracy : 0.952055
Counter({0: 4120, 1: 3571})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.52795510366559 Time :  4805
accuracy train: 0.962230 val: 0.941818 test: 0.962100
max validation accuracy : 0.952727 max acc epoch : 1 test accuracy : 0.952055
Counter({0: 4056, 1: 3635})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.101897214539349 Time :  4824
accuracy train: 0.980610 val: 0.965455 test: 0.967123
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.967123
Counter({0: 3913, 1: 3778})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.026322642806917 Time :  4842
accuracy train: 0.984044 val: 0.958182 test: 0.966667
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.967123
Counter({0: 3883, 1: 3808})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.749612549319863 Time :  4861
accuracy train: 0.986063 val: 0.963636 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.967123
Counter({1: 3861, 0: 3830})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.235452218912542 Time :  4879
accuracy train: 0.988487 val: 0.965455 test: 0.969406
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.967123
Counter({0: 3846, 1: 3845})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.167779095470905 Time :  4908
accuracy train: 0.988083 val: 0.960000 test: 0.973516
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.967123
Counter({0: 3848, 1: 3843})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.041739808395505 Time :  4927
accuracy train: 0.990305 val: 0.963636 test: 0.977169
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.967123
Counter({1: 3854, 0: 3837})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.123754889238626 Time :  4945
accuracy train: 0.992729 val: 0.963636 test: 0.972603
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.967123
Counter({1: 3860, 0: 3831})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.495261965552345 Time :  4966
accuracy train: 0.993739 val: 0.967273 test: 0.972146
max validation accuracy : 0.967273 max acc epoch : 10 test accuracy : 0.972146
Counter({1: 3869, 0: 3822})

Epoch :  11 loss training:  5.03104567353148 Time :  4986
accuracy train: 0.992931 val: 0.967273 test: 0.971689
max validation accuracy : 0.967273 max acc epoch : 10 test accuracy : 0.972146
Counter({1: 3873, 0: 3818})

slurmstepd: error: *** JOB 37239 ON cl-gpusrv1 CANCELLED AT 2021-06-12T15:02:41 ***
