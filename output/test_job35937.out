

date and time :  Tue Jun  8 15:27:54 2021
itr : 0
Namespace(batch_size=64, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=718, weight_decay=0)
device :  cuda:0
Counter({0: 7583, 1: 6352, 2: 4911})

Epoch :  1 loss training:  343.1361768245697 Time :  132
accuracy train: 0.792596 val: 0.756852 test: 0.726102
max validation accuracy : 0.756852 max acc epoch : 1 test accuracy : 0.726102
Counter({0: 7604, 2: 5991, 1: 5251})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  210.4819586724043 Time :  272
accuracy train: 0.836983 val: 0.803714 test: 0.756107
max validation accuracy : 0.803714 max acc epoch : 2 test accuracy : 0.756107
Counter({1: 7078, 0: 6642, 2: 5126})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  175.74090792238712 Time :  413
accuracy train: 0.872631 val: 0.832891 test: 0.779076
max validation accuracy : 0.832891 max acc epoch : 3 test accuracy : 0.779076
Counter({0: 7215, 1: 6826, 2: 4805})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  136.79158583283424 Time :  536
accuracy train: 0.903172 val: 0.862069 test: 0.795273
max validation accuracy : 0.862069 max acc epoch : 4 test accuracy : 0.795273
Counter({2: 7343, 0: 6858, 1: 4645})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  123.26403358578682 Time :  654
accuracy train: 0.905431 val: 0.863837 test: 0.790892
max validation accuracy : 0.863837 max acc epoch : 5 test accuracy : 0.790892
Counter({2: 7290, 1: 6861, 0: 4695})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  116.38766191899776 Time :  765
accuracy train: 0.926053 val: 0.878868 test: 0.801115
max validation accuracy : 0.878868 max acc epoch : 6 test accuracy : 0.801115
Counter({2: 7270, 0: 6874, 1: 4702})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  97.47567068785429 Time :  882
accuracy train: 0.936070 val: 0.880637 test: 0.810674
max validation accuracy : 0.880637 max acc epoch : 7 test accuracy : 0.810674
Counter({0: 7279, 2: 6862, 1: 4705})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  96.29461575299501 Time :  1001
accuracy train: 0.939311 val: 0.877984 test: 0.810542
max validation accuracy : 0.880637 max acc epoch : 7 test accuracy : 0.810674
Counter({2: 7234, 0: 6896, 1: 4716})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  87.93735549598932 Time :  1134
accuracy train: 0.942944 val: 0.884173 test: 0.808816
max validation accuracy : 0.884173 max acc epoch : 9 test accuracy : 0.808816
Counter({0: 7230, 1: 6897, 2: 4719})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  79.35728897154331 Time :  1243
accuracy train: 0.950899 val: 0.884173 test: 0.812799
max validation accuracy : 0.884173 max acc epoch : 9 test accuracy : 0.808816
Counter({1: 7177, 2: 6943, 0: 4726})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  77.28565961122513 Time :  1367
accuracy train: 0.952568 val: 0.877984 test: 0.812533
max validation accuracy : 0.884173 max acc epoch : 9 test accuracy : 0.808816
Counter({1: 7154, 0: 6980, 2: 4712})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  75.29367535188794 Time :  1492
accuracy train: 0.951488 val: 0.881521 test: 0.810409
max validation accuracy : 0.884173 max acc epoch : 9 test accuracy : 0.808816
Counter({0: 7121, 1: 7007, 2: 4718})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  74.20543349534273 Time :  1616
accuracy train: 0.957282 val: 0.891247 test: 0.816516
max validation accuracy : 0.891247 max acc epoch : 13 test accuracy : 0.816516
Counter({1: 7092, 2: 7038, 0: 4716})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  69.19791520386934 Time :  1738
accuracy train: 0.958657 val: 0.885942 test: 0.815852
max validation accuracy : 0.891247 max acc epoch : 13 test accuracy : 0.816516
Counter({1: 7071, 2: 7059, 0: 4716})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  68.73550288565457 Time :  1858
accuracy train: 0.959344 val: 0.885942 test: 0.816118
max validation accuracy : 0.891247 max acc epoch : 13 test accuracy : 0.816516
Counter({0: 7086, 1: 7053, 2: 4707})

Epoch :  16 loss training:  68.41690141707659 Time :  1973
accuracy train: 0.962094 val: 0.890363 test: 0.818109
max validation accuracy : 0.891247 max acc epoch : 13 test accuracy : 0.816516
Counter({2: 7108, 0: 7032, 1: 4706})

Epoch :  17 loss training:  68.59588983654976 Time :  2098
accuracy train: 0.961308 val: 0.885942 test: 0.818375
max validation accuracy : 0.891247 max acc epoch : 13 test accuracy : 0.816516
Counter({1: 7120, 0: 7021, 2: 4705})

Epoch :  18 loss training:  66.01561241969466 Time :  2212
accuracy train: 0.965138 val: 0.886826 test: 0.819703
max validation accuracy : 0.891247 max acc epoch : 13 test accuracy : 0.816516
Counter({0: 7125, 1: 7018, 2: 4703})

Epoch :  19 loss training:  66.67588258907199 Time :  2324
accuracy train: 0.964156 val: 0.888594 test: 0.815056
max validation accuracy : 0.891247 max acc epoch : 13 test accuracy : 0.816516
Counter({1: 7128, 0: 7015, 2: 4703})

Epoch :  20 loss training:  64.32774962857366 Time :  2447
accuracy train: 0.966316 val: 0.892131 test: 0.818242
max validation accuracy : 0.892131 max acc epoch : 20 test accuracy : 0.818242
Counter({0: 7137, 2: 7008, 1: 4701})

Epoch :  21 loss training:  63.96162732318044 Time :  2561
accuracy train: 0.968477 val: 0.893899 test: 0.817313
max validation accuracy : 0.893899 max acc epoch : 21 test accuracy : 0.817313
Counter({2: 7149, 1: 6996, 0: 4701})

Epoch :  22 loss training:  61.664471451193094 Time :  2673
accuracy train: 0.967397 val: 0.889478 test: 0.815587
max validation accuracy : 0.893899 max acc epoch : 21 test accuracy : 0.817313
Counter({2: 7157, 1: 6985, 0: 4704})

Epoch :  23 loss training:  60.82145835086703 Time :  2795
accuracy train: 0.969262 val: 0.897436 test: 0.820765
max validation accuracy : 0.897436 max acc epoch : 23 test accuracy : 0.820765
Counter({1: 7187, 0: 6944, 2: 4715})

Epoch :  24 loss training:  60.51455189473927 Time :  2912
accuracy train: 0.969852 val: 0.896552 test: 0.821163
max validation accuracy : 0.897436 max acc epoch : 23 test accuracy : 0.820765
Counter({1: 7201, 0: 6929, 2: 4716})

Epoch :  25 loss training:  59.6642391551286 Time :  3031
accuracy train: 0.972896 val: 0.899204 test: 0.819968
max validation accuracy : 0.899204 max acc epoch : 25 test accuracy : 0.819968
Counter({1: 7208, 0: 6916, 2: 4722})

Epoch :  26 loss training:  60.1115438491106 Time :  3147
accuracy train: 0.972110 val: 0.898320 test: 0.820632
max validation accuracy : 0.899204 max acc epoch : 25 test accuracy : 0.819968
Counter({2: 7214, 1: 6907, 0: 4725})

Epoch :  27 loss training:  59.69804674759507 Time :  3297
accuracy train: 0.972405 val: 0.894783 test: 0.825146
max validation accuracy : 0.899204 max acc epoch : 25 test accuracy : 0.819968
Counter({2: 7227, 0: 6886, 1: 4733})

Epoch :  28 loss training:  56.454945258796215 Time :  3428
accuracy train: 0.974467 val: 0.899204 test: 0.822491
max validation accuracy : 0.899204 max acc epoch : 25 test accuracy : 0.819968
Counter({1: 7221, 2: 6892, 0: 4733})

Epoch :  29 loss training:  57.871502339839935 Time :  3572
accuracy train: 0.973485 val: 0.890363 test: 0.821296
max validation accuracy : 0.899204 max acc epoch : 25 test accuracy : 0.819968
Counter({0: 7232, 1: 6876, 2: 4738})

Epoch :  30 loss training:  56.16987496428192 Time :  3701
accuracy train: 0.974860 val: 0.893015 test: 0.821163
max validation accuracy : 0.899204 max acc epoch : 25 test accuracy : 0.819968
Counter({1: 7250, 0: 6860, 2: 4736})

Epoch :  31 loss training:  53.890997134149075 Time :  3815
accuracy train: 0.976137 val: 0.894783 test: 0.822623
max validation accuracy : 0.899204 max acc epoch : 25 test accuracy : 0.819968
Counter({2: 7252, 1: 6847, 0: 4747})

Epoch :  32 loss training:  55.096947476267815 Time :  3930
accuracy train: 0.978592 val: 0.896552 test: 0.825279
max validation accuracy : 0.899204 max acc epoch : 25 test accuracy : 0.819968
Counter({1: 7259, 0: 6834, 2: 4753})

Epoch :  33 loss training:  55.59405394643545 Time :  4059
accuracy train: 0.978494 val: 0.890363 test: 0.819835
max validation accuracy : 0.899204 max acc epoch : 25 test accuracy : 0.819968
Counter({1: 7271, 0: 6823, 2: 4752})

Epoch :  34 loss training:  54.652018489316106 Time :  4173
accuracy train: 0.977217 val: 0.903625 test: 0.823686
max validation accuracy : 0.903625 max acc epoch : 34 test accuracy : 0.823686
Counter({0: 7267, 1: 6823, 2: 4756})

Epoch :  35 loss training:  53.33153427951038 Time :  4286
accuracy train: 0.979574 val: 0.899204 test: 0.820632
max validation accuracy : 0.903625 max acc epoch : 34 test accuracy : 0.823686
Counter({1: 7270, 2: 6821, 0: 4755})

Epoch :  36 loss training:  49.773960089311004 Time :  4417
accuracy train: 0.979967 val: 0.901857 test: 0.819039
max validation accuracy : 0.903625 max acc epoch : 34 test accuracy : 0.823686
Counter({1: 7273, 2: 6818, 0: 4755})

Epoch :  37 loss training:  53.547864366322756 Time :  4532
accuracy train: 0.979574 val: 0.894783 test: 0.819968
max validation accuracy : 0.903625 max acc epoch : 34 test accuracy : 0.823686
Counter({0: 7278, 2: 6813, 1: 4755})

Epoch :  38 loss training:  51.40092639066279 Time :  4646
accuracy train: 0.980458 val: 0.902741 test: 0.822623
max validation accuracy : 0.903625 max acc epoch : 34 test accuracy : 0.823686
Counter({0: 7284, 1: 6812, 2: 4750})

Epoch :  39 loss training:  49.79379468411207 Time :  4759
accuracy train: 0.982323 val: 0.903625 test: 0.821163
max validation accuracy : 0.903625 max acc epoch : 34 test accuracy : 0.823686
Counter({2: 7291, 0: 6806, 1: 4749})

Epoch :  40 loss training:  49.79466552473605 Time :  4877
accuracy train: 0.980949 val: 0.896552 test: 0.823155
max validation accuracy : 0.903625 max acc epoch : 34 test accuracy : 0.823686
Counter({2: 7295, 1: 6803, 0: 4748})

Epoch :  41 loss training:  47.98963400349021 Time :  4986
accuracy train: 0.983502 val: 0.893015 test: 0.825279
max validation accuracy : 0.903625 max acc epoch : 34 test accuracy : 0.823686
Counter({0: 7301, 1: 6797, 2: 4748})

Epoch :  42 loss training:  47.72247979417443 Time :  5100
accuracy train: 0.984091 val: 0.904509 test: 0.823686
max validation accuracy : 0.904509 max acc epoch : 42 test accuracy : 0.823686
Counter({0: 7316, 2: 6788, 1: 4742})

Epoch :  43 loss training:  46.634587405249476 Time :  5213
accuracy train: 0.983895 val: 0.900088 test: 0.822756
max validation accuracy : 0.904509 max acc epoch : 42 test accuracy : 0.823686
Counter({1: 7316, 0: 6793, 2: 4737})

Epoch :  44 loss training:  44.74943516775966 Time :  5333
accuracy train: 0.984484 val: 0.901857 test: 0.822756
max validation accuracy : 0.904509 max acc epoch : 42 test accuracy : 0.823686
Counter({1: 7324, 0: 6788, 2: 4734})

Epoch :  45 loss training:  44.17020698823035 Time :  5445
accuracy train: 0.984582 val: 0.904509 test: 0.822623
max validation accuracy : 0.904509 max acc epoch : 42 test accuracy : 0.823686
Counter({0: 7339, 2: 6772, 1: 4735})

Epoch :  46 loss training:  44.848095897585154 Time :  5561
accuracy train: 0.984779 val: 0.903625 test: 0.824217
max validation accuracy : 0.904509 max acc epoch : 42 test accuracy : 0.823686
Counter({0: 7339, 1: 6776, 2: 4731})

Epoch :  47 loss training:  45.39592868834734 Time :  5667
accuracy train: 0.986350 val: 0.904509 test: 0.825146
max validation accuracy : 0.904509 max acc epoch : 42 test accuracy : 0.823686
Counter({0: 7346, 1: 6749, 2: 4751})

Epoch :  48 loss training:  43.234020821750164 Time :  5768
accuracy train: 0.985662 val: 0.895668 test: 0.822358
max validation accuracy : 0.904509 max acc epoch : 42 test accuracy : 0.823686
Counter({1: 7358, 0: 6732, 2: 4756})

Epoch :  49 loss training:  43.70117906294763 Time :  5856
accuracy train: 0.987332 val: 0.900973 test: 0.822889
max validation accuracy : 0.904509 max acc epoch : 42 test accuracy : 0.823686
Counter({2: 7362, 1: 6717, 0: 4767})

Epoch :  50 loss training:  43.85987791325897 Time :  5946
accuracy train: 0.987135 val: 0.905393 test: 0.824349
max validation accuracy : 0.905393 max acc epoch : 50 test accuracy : 0.824349
Counter({0: 7365, 2: 6712, 1: 4769})

Epoch :  51 loss training:  41.9061532355845 Time :  6037
accuracy train: 0.988608 val: 0.901857 test: 0.823420
max validation accuracy : 0.905393 max acc epoch : 50 test accuracy : 0.824349
Counter({2: 7364, 0: 6711, 1: 4771})

Epoch :  52 loss training:  42.09466383885592 Time :  6132
accuracy train: 0.988314 val: 0.905393 test: 0.826208
max validation accuracy : 0.905393 max acc epoch : 50 test accuracy : 0.824349
Counter({2: 7372, 0: 6705, 1: 4769})

Epoch :  53 loss training:  40.06472451798618 Time :  6239
accuracy train: 0.988412 val: 0.904509 test: 0.820101
max validation accuracy : 0.905393 max acc epoch : 50 test accuracy : 0.824349
Counter({0: 7387, 2: 6695, 1: 4764})

Epoch :  54 loss training:  40.84607420489192 Time :  6332
accuracy train: 0.989983 val: 0.899204 test: 0.823287
max validation accuracy : 0.905393 max acc epoch : 50 test accuracy : 0.824349
Counter({2: 7394, 1: 6687, 0: 4765})

Epoch :  55 loss training:  41.57544766180217 Time :  6424
accuracy train: 0.989099 val: 0.898320 test: 0.824881
max validation accuracy : 0.905393 max acc epoch : 50 test accuracy : 0.824349
Counter({2: 7394, 0: 6685, 1: 4767})

Epoch :  56 loss training:  38.00067680794746 Time :  6514
accuracy train: 0.990769 val: 0.907162 test: 0.828864
max validation accuracy : 0.907162 max acc epoch : 56 test accuracy : 0.828864
Counter({1: 7400, 0: 6679, 2: 4767})

Epoch :  57 loss training:  37.62290496751666 Time :  6602
accuracy train: 0.990376 val: 0.903625 test: 0.824217
max validation accuracy : 0.907162 max acc epoch : 56 test accuracy : 0.828864
Counter({2: 7413, 1: 6679, 0: 4754})

Epoch :  58 loss training:  39.23679894953966 Time :  6691
accuracy train: 0.991849 val: 0.901857 test: 0.824349
max validation accuracy : 0.907162 max acc epoch : 56 test accuracy : 0.828864
Counter({1: 7422, 2: 6673, 0: 4751})

Epoch :  59 loss training:  38.46788343787193 Time :  6782
accuracy train: 0.991849 val: 0.901857 test: 0.825412
max validation accuracy : 0.907162 max acc epoch : 56 test accuracy : 0.828864
Counter({1: 7425, 0: 6664, 2: 4757})

Epoch :  60 loss training:  38.37271947506815 Time :  6873
accuracy train: 0.991849 val: 0.908046 test: 0.825146
max validation accuracy : 0.908046 max acc epoch : 60 test accuracy : 0.825146
Counter({1: 7428, 2: 6658, 0: 4760})

Epoch :  61 loss training:  35.417004686780274 Time :  6961
accuracy train: 0.992537 val: 0.908046 test: 0.827403
max validation accuracy : 0.908046 max acc epoch : 60 test accuracy : 0.825146
Counter({2: 7428, 1: 6651, 0: 4767})

Epoch :  62 loss training:  35.339355980977416 Time :  7049
accuracy train: 0.992046 val: 0.906278 test: 0.825810
max validation accuracy : 0.908046 max acc epoch : 60 test accuracy : 0.825146
Counter({2: 7433, 0: 6647, 1: 4766})

Epoch :  63 loss training:  36.86052495054901 Time :  7137
accuracy train: 0.992046 val: 0.905393 test: 0.825677
max validation accuracy : 0.908046 max acc epoch : 60 test accuracy : 0.825146
Counter({0: 7444, 1: 6636, 2: 4766})

Epoch :  64 loss training:  35.3864834792912 Time :  7227
accuracy train: 0.993028 val: 0.900088 test: 0.825677
max validation accuracy : 0.908046 max acc epoch : 60 test accuracy : 0.825146
Counter({0: 7448, 2: 6632, 1: 4766})

Epoch :  65 loss training:  34.705355864949524 Time :  7344
accuracy train: 0.994304 val: 0.902741 test: 0.826208
max validation accuracy : 0.908046 max acc epoch : 60 test accuracy : 0.825146
Counter({1: 7452, 2: 6630, 0: 4764})

Epoch :  66 loss training:  33.555861064232886 Time :  7456
accuracy train: 0.993420 val: 0.900088 test: 0.822491
max validation accuracy : 0.908046 max acc epoch : 60 test accuracy : 0.825146
Counter({1: 7451, 2: 6636, 0: 4759})

Epoch :  67 loss training:  33.9066284224391 Time :  7558
accuracy train: 0.993715 val: 0.903625 test: 0.825810
max validation accuracy : 0.908046 max acc epoch : 60 test accuracy : 0.825146
Counter({2: 7453, 1: 6637, 0: 4756})

Epoch :  68 loss training:  33.85641308221966 Time :  7665
accuracy train: 0.995090 val: 0.909814 test: 0.825544
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({2: 7453, 1: 6636, 0: 4757})

Epoch :  69 loss training:  33.11930976854637 Time :  7767
accuracy train: 0.994992 val: 0.907162 test: 0.824482
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({0: 7460, 1: 6631, 2: 4755})

Epoch :  70 loss training:  34.050726460292935 Time :  7872
accuracy train: 0.994893 val: 0.903625 test: 0.823155
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({1: 7461, 0: 6633, 2: 4752})

Epoch :  71 loss training:  32.11724455934018 Time :  7975
accuracy train: 0.994992 val: 0.907162 test: 0.824615
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({1: 7461, 0: 6633, 2: 4752})

Epoch :  72 loss training:  32.497367080301046 Time :  8084
accuracy train: 0.995286 val: 0.902741 test: 0.824349
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({2: 7462, 1: 6632, 0: 4752})

Epoch :  73 loss training:  30.906587599776685 Time :  8186
accuracy train: 0.994402 val: 0.902741 test: 0.827138
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({1: 7462, 0: 6637, 2: 4747})

Epoch :  74 loss training:  31.561372802592814 Time :  8299
accuracy train: 0.995581 val: 0.905393 test: 0.825810
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({0: 7462, 2: 6636, 1: 4748})

Epoch :  75 loss training:  31.372285335324705 Time :  8401
accuracy train: 0.996759 val: 0.908930 test: 0.825412
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({1: 7464, 0: 6637, 2: 4745})

Epoch :  76 loss training:  30.17102431692183 Time :  8508
accuracy train: 0.996366 val: 0.901857 test: 0.824482
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({1: 7462, 0: 6637, 2: 4747})

Epoch :  77 loss training:  27.610771394334733 Time :  8625
accuracy train: 0.997349 val: 0.908930 test: 0.824217
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({2: 7469, 1: 6634, 0: 4743})

Epoch :  78 loss training:  28.727870598435402 Time :  8725
accuracy train: 0.997054 val: 0.901857 test: 0.821960
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({0: 7469, 1: 6637, 2: 4740})

Epoch :  79 loss training:  30.25944240298122 Time :  8831
accuracy train: 0.995777 val: 0.901857 test: 0.826474
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({2: 7466, 1: 6645, 0: 4735})

Epoch :  80 loss training:  29.543491035699844 Time :  8942
accuracy train: 0.996465 val: 0.898320 test: 0.825013
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({2: 7466, 1: 6644, 0: 4736})

Epoch :  81 loss training:  28.120009182952344 Time :  9044
accuracy train: 0.997250 val: 0.901857 test: 0.823553
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({2: 7473, 1: 6643, 0: 4730})

Epoch :  82 loss training:  28.917961705476046 Time :  9150
accuracy train: 0.996465 val: 0.897436 test: 0.824084
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({1: 7477, 0: 6640, 2: 4729})

Epoch :  83 loss training:  28.529397163540125 Time :  9262
accuracy train: 0.996759 val: 0.905393 test: 0.823818
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({1: 7478, 0: 6642, 2: 4726})

Epoch :  84 loss training:  27.879286067560315 Time :  9408
accuracy train: 0.996858 val: 0.904509 test: 0.825412
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({2: 7479, 1: 6641, 0: 4726})

Epoch :  85 loss training:  26.248736911453307 Time :  9525
accuracy train: 0.997250 val: 0.903625 test: 0.827270
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({2: 7482, 0: 6646, 1: 4718})

Epoch :  86 loss training:  26.941785987466574 Time :  9643
accuracy train: 0.997447 val: 0.902741 test: 0.825544
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({1: 7482, 2: 6647, 0: 4717})

Epoch :  87 loss training:  26.86024401616305 Time :  9750
accuracy train: 0.996956 val: 0.902741 test: 0.825677
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({1: 7484, 2: 6647, 0: 4715})

Epoch :  88 loss training:  26.589502681046724 Time :  9862
accuracy train: 0.997545 val: 0.906278 test: 0.828864
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({2: 7485, 1: 6646, 0: 4715})

Epoch :  89 loss training:  27.308893249370158 Time :  9964
accuracy train: 0.998232 val: 0.896552 test: 0.825279
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({1: 7483, 0: 6646, 2: 4717})

Epoch :  90 loss training:  24.97865191102028 Time :  10088
accuracy train: 0.997447 val: 0.902741 test: 0.822092
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({0: 7484, 1: 6644, 2: 4718})

Epoch :  91 loss training:  25.437485658098012 Time :  10226
accuracy train: 0.997741 val: 0.905393 test: 0.828332
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({2: 7488, 0: 6643, 1: 4715})

Epoch :  92 loss training:  24.43535112310201 Time :  10395
accuracy train: 0.998036 val: 0.906278 test: 0.825943
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({2: 7489, 1: 6644, 0: 4713})

Epoch :  93 loss training:  25.032703232951462 Time :  10518
accuracy train: 0.998527 val: 0.903625 test: 0.827403
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({2: 7491, 0: 6643, 1: 4712})

Epoch :  94 loss training:  23.222797742579132 Time :  10649
accuracy train: 0.998331 val: 0.907162 test: 0.828731
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({2: 7492, 0: 6642, 1: 4712})

Epoch :  95 loss training:  24.20569730643183 Time :  10788
accuracy train: 0.998331 val: 0.907162 test: 0.825146
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({1: 7492, 2: 6641, 0: 4713})

Epoch :  96 loss training:  24.67519668210298 Time :  10930
accuracy train: 0.998232 val: 0.904509 test: 0.825412
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({1: 7495, 2: 6639, 0: 4712})

Epoch :  97 loss training:  23.314501896034926 Time :  11067
accuracy train: 0.998036 val: 0.907162 test: 0.827934
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({1: 7502, 2: 6635, 0: 4709})

Epoch :  98 loss training:  23.394541249610484 Time :  11196
accuracy train: 0.998331 val: 0.896552 test: 0.827536
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({2: 7504, 0: 6629, 1: 4713})

Epoch :  99 loss training:  21.71041352348402 Time :  11327
accuracy train: 0.998429 val: 0.904509 test: 0.826474
max validation accuracy : 0.909814 max acc epoch : 68 test accuracy : 0.825544
Counter({0: 7509, 2: 6626, 1: 4711})

========================================================================================================================================================================================================
max acc epoch :  68
max validation accuracy :  0.9098143236074271
test accuracy :  0.8255443441317047
last test_accuracy :  0.8264737121614445
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=718, weight_decay=0)
device :  cuda:0
Counter({0: 7583, 1: 6352, 2: 4911})

Epoch :  1 loss training:  343.17694276571274 Time :  11478
accuracy train: 0.791319 val: 0.763926 test: 0.726766
max validation accuracy : 0.763926 max acc epoch : 1 test accuracy : 0.726766
Counter({1: 9862, 0: 7016, 2: 1968})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  211.22258611023426 Time :  11628
accuracy train: 0.822842 val: 0.800177 test: 0.745088
max validation accuracy : 0.800177 max acc epoch : 2 test accuracy : 0.745088
Counter({2: 7681, 0: 6695, 1: 4470})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  176.65476594865322 Time :  11770
accuracy train: 0.849651 val: 0.815208 test: 0.758232
max validation accuracy : 0.815208 max acc epoch : 3 test accuracy : 0.758232
Counter({1: 7444, 2: 6613, 0: 4789})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  138.0989099740982 Time :  11928
accuracy train: 0.900815 val: 0.858532 test: 0.795141
max validation accuracy : 0.858532 max acc epoch : 4 test accuracy : 0.795141
Counter({2: 7614, 1: 6726, 0: 4506})
Epoch-4 lr: 0.0005

slurmstepd: error: *** JOB 35937 ON cl-gpusrv1 CANCELLED AT 2021-06-08T18:47:57 ***
