

date and time :  Tue Jun 15 16:09:06 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=15, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=63, tsne=False, val_prop=0.975, weight_decay=0)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  98.83558241534047 Time :  65
accuracy train: 0.847826 val: 0.760022 test: 0.758904
max validation accuracy : 0.760022 max acc epoch : 1 test accuracy : 0.758904
Counter({0: 3995, 1: 3696})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  45.298476657204446 Time :  99
accuracy train: 0.905797 val: 0.805892 test: 0.839726
max validation accuracy : 0.805892 max acc epoch : 2 test accuracy : 0.839726
Counter({0: 4374, 1: 3317})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  38.77652763916922 Time :  133
accuracy train: 0.963768 val: 0.848219 test: 0.860274
max validation accuracy : 0.848219 max acc epoch : 3 test accuracy : 0.860274
Counter({1: 4080, 0: 3611})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  12.391578350958298 Time :  159
accuracy train: 0.992754 val: 0.879172 test: 0.898174
max validation accuracy : 0.879172 max acc epoch : 4 test accuracy : 0.898174
Counter({1: 4102, 0: 3589})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  5.473962227964876 Time :  195
accuracy train: 0.978261 val: 0.876375 test: 0.884475
max validation accuracy : 0.879172 max acc epoch : 4 test accuracy : 0.898174
Counter({1: 4308, 0: 3383})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  3.24169200590768 Time :  223
accuracy train: 0.992754 val: 0.894649 test: 0.900913
max validation accuracy : 0.894649 max acc epoch : 6 test accuracy : 0.900913
Counter({0: 4146, 1: 3545})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  2.3180540169059896 Time :  252
accuracy train: 1.000000 val: 0.899124 test: 0.925571
max validation accuracy : 0.899124 max acc epoch : 7 test accuracy : 0.925571
Counter({0: 4243, 1: 3448})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  1.5118784936726115 Time :  282
accuracy train: 1.000000 val: 0.900242 test: 0.920548
max validation accuracy : 0.900242 max acc epoch : 8 test accuracy : 0.920548
Counter({1: 4213, 0: 3478})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  1.0456564945657192 Time :  306
accuracy train: 1.000000 val: 0.903972 test: 0.921005
max validation accuracy : 0.903972 max acc epoch : 9 test accuracy : 0.921005
Counter({0: 4195, 1: 3496})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  0.9134005869973407 Time :  336
accuracy train: 1.000000 val: 0.904345 test: 0.921461
max validation accuracy : 0.904345 max acc epoch : 10 test accuracy : 0.921461
Counter({1: 4186, 0: 3505})

Epoch :  11 loss training:  1.0204094626146798 Time :  369
accuracy train: 1.000000 val: 0.905090 test: 0.921005
max validation accuracy : 0.905090 max acc epoch : 11 test accuracy : 0.921005
Counter({1: 4167, 0: 3524})

Epoch :  12 loss training:  0.8174565270475114 Time :  394
accuracy train: 1.000000 val: 0.903412 test: 0.921461
max validation accuracy : 0.905090 max acc epoch : 11 test accuracy : 0.921005
Counter({1: 4169, 0: 3522})

Epoch :  13 loss training:  0.47310006928711346 Time :  433
accuracy train: 1.000000 val: 0.902666 test: 0.921005
max validation accuracy : 0.905090 max acc epoch : 11 test accuracy : 0.921005
Counter({0: 4168, 1: 3523})

Epoch :  14 loss training:  0.6080679990485578 Time :  466
accuracy train: 1.000000 val: 0.904531 test: 0.920548
max validation accuracy : 0.905090 max acc epoch : 11 test accuracy : 0.921005
Counter({1: 4165, 0: 3526})

Epoch :  15 loss training:  0.3351834550333024 Time :  516
accuracy train: 1.000000 val: 0.905463 test: 0.920091
max validation accuracy : 0.905463 max acc epoch : 15 test accuracy : 0.920091
Counter({0: 4163, 1: 3528})

Epoch :  16 loss training:  0.498677878700164 Time :  540
accuracy train: 1.000000 val: 0.905463 test: 0.914612
max validation accuracy : 0.905463 max acc epoch : 15 test accuracy : 0.920091
Counter({0: 4149, 1: 3542})

Epoch :  17 loss training:  0.5270717903085824 Time :  605
accuracy train: 1.000000 val: 0.909006 test: 0.918721
max validation accuracy : 0.909006 max acc epoch : 17 test accuracy : 0.918721
Counter({1: 4151, 0: 3540})

Epoch :  18 loss training:  0.4159137342772965 Time :  668
accuracy train: 1.000000 val: 0.906209 test: 0.920548
max validation accuracy : 0.909006 max acc epoch : 17 test accuracy : 0.918721
Counter({0: 4163, 1: 3528})

Epoch :  19 loss training:  0.270111052230277 Time :  731
accuracy train: 1.000000 val: 0.908074 test: 0.921005
max validation accuracy : 0.909006 max acc epoch : 17 test accuracy : 0.918721
Counter({0: 4168, 1: 3523})

Epoch :  20 loss training:  0.3444485716499912 Time :  801
accuracy train: 1.000000 val: 0.909379 test: 0.919178
max validation accuracy : 0.909379 max acc epoch : 20 test accuracy : 0.919178
Counter({1: 4134, 0: 3557})

Epoch :  21 loss training:  0.2384515345681848 Time :  878
accuracy train: 1.000000 val: 0.909379 test: 0.918721
max validation accuracy : 0.909379 max acc epoch : 20 test accuracy : 0.919178
Counter({0: 4127, 1: 3564})

Epoch :  22 loss training:  0.1501575099132424 Time :  946
accuracy train: 1.000000 val: 0.909193 test: 0.916895
max validation accuracy : 0.909379 max acc epoch : 20 test accuracy : 0.919178
Counter({1: 4120, 0: 3571})

Epoch :  23 loss training:  0.21944910268439344 Time :  1015
accuracy train: 1.000000 val: 0.909193 test: 0.921461
max validation accuracy : 0.909379 max acc epoch : 20 test accuracy : 0.919178
Counter({0: 4120, 1: 3571})

Epoch :  24 loss training:  0.26801603430743626 Time :  1084
accuracy train: 1.000000 val: 0.909193 test: 0.923288
max validation accuracy : 0.909379 max acc epoch : 20 test accuracy : 0.919178
Counter({1: 4122, 0: 3569})

Epoch :  25 loss training:  0.22922497714853307 Time :  1159
accuracy train: 1.000000 val: 0.910125 test: 0.917808
max validation accuracy : 0.910125 max acc epoch : 25 test accuracy : 0.917808
Counter({0: 4116, 1: 3575})

Epoch :  26 loss training:  0.17856118326312753 Time :  1234
accuracy train: 1.000000 val: 0.910498 test: 0.922831
max validation accuracy : 0.910498 max acc epoch : 26 test accuracy : 0.922831
Counter({0: 4113, 1: 3578})

Epoch :  27 loss training:  0.1531550542728155 Time :  1302
accuracy train: 1.000000 val: 0.911990 test: 0.924201
max validation accuracy : 0.911990 max acc epoch : 27 test accuracy : 0.924201
Counter({1: 4107, 0: 3584})

Epoch :  28 loss training:  0.1633554289083463 Time :  1369
accuracy train: 1.000000 val: 0.909379 test: 0.923288
max validation accuracy : 0.911990 max acc epoch : 27 test accuracy : 0.924201
Counter({0: 4111, 1: 3580})

Epoch :  29 loss training:  0.14432436416927885 Time :  1436
accuracy train: 1.000000 val: 0.911990 test: 0.921005
max validation accuracy : 0.911990 max acc epoch : 27 test accuracy : 0.924201
Counter({1: 4110, 0: 3581})

Epoch :  30 loss training:  0.15666675623515403 Time :  1485
accuracy train: 1.000000 val: 0.905277 test: 0.925114
max validation accuracy : 0.911990 max acc epoch : 27 test accuracy : 0.924201
Counter({0: 4115, 1: 3576})

Epoch :  31 loss training:  0.15564609296890808 Time :  1515
accuracy train: 1.000000 val: 0.905090 test: 0.923744
max validation accuracy : 0.911990 max acc epoch : 27 test accuracy : 0.924201
Counter({1: 4104, 0: 3587})

Epoch :  32 loss training:  0.10655791185928365 Time :  1564
accuracy train: 1.000000 val: 0.903972 test: 0.927854
max validation accuracy : 0.911990 max acc epoch : 27 test accuracy : 0.924201
Counter({0: 4110, 1: 3581})

Epoch :  33 loss training:  0.1921270985620538 Time :  1588
accuracy train: 1.000000 val: 0.905463 test: 0.918265
max validation accuracy : 0.911990 max acc epoch : 27 test accuracy : 0.924201
Counter({0: 4088, 1: 3603})

Epoch :  34 loss training:  0.07079137457520801 Time :  1625
accuracy train: 1.000000 val: 0.904904 test: 0.921461
max validation accuracy : 0.911990 max acc epoch : 27 test accuracy : 0.924201
Counter({1: 4091, 0: 3600})

Epoch :  35 loss training:  0.07426293363937475 Time :  1645
accuracy train: 1.000000 val: 0.906209 test: 0.919635
max validation accuracy : 0.911990 max acc epoch : 27 test accuracy : 0.924201
Counter({0: 4087, 1: 3604})

Epoch :  36 loss training:  0.06634631418631898 Time :  1674
accuracy train: 1.000000 val: 0.904904 test: 0.923288
max validation accuracy : 0.911990 max acc epoch : 27 test accuracy : 0.924201
Counter({0: 4084, 1: 3607})

Epoch :  37 loss training:  0.07286368709014823 Time :  1696
accuracy train: 1.000000 val: 0.904718 test: 0.922374
max validation accuracy : 0.911990 max acc epoch : 27 test accuracy : 0.924201
Counter({0: 4081, 1: 3610})

Epoch :  38 loss training:  0.06910906778591652 Time :  1727
accuracy train: 1.000000 val: 0.906396 test: 0.920548
max validation accuracy : 0.911990 max acc epoch : 27 test accuracy : 0.924201
Counter({1: 4081, 0: 3610})

Epoch :  39 loss training:  0.09805929250160261 Time :  1752
accuracy train: 1.000000 val: 0.908260 test: 0.921005
max validation accuracy : 0.911990 max acc epoch : 27 test accuracy : 0.924201
Counter({0: 4078, 1: 3613})

Epoch :  40 loss training:  0.0688290963192344 Time :  1775
accuracy train: 1.000000 val: 0.908447 test: 0.920548
max validation accuracy : 0.911990 max acc epoch : 27 test accuracy : 0.924201
Counter({1: 4078, 0: 3613})

Epoch :  41 loss training:  0.07455192696744462 Time :  1802
accuracy train: 1.000000 val: 0.908633 test: 0.922831
max validation accuracy : 0.911990 max acc epoch : 27 test accuracy : 0.924201
Counter({0: 4074, 1: 3617})

Epoch :  42 loss training:  0.07439255964493441 Time :  1837
accuracy train: 1.000000 val: 0.905277 test: 0.924658
max validation accuracy : 0.911990 max acc epoch : 27 test accuracy : 0.924201
Counter({1: 4062, 0: 3629})

Epoch :  43 loss training:  0.08368827210946961 Time :  1870
accuracy train: 1.000000 val: 0.906396 test: 0.925114
max validation accuracy : 0.911990 max acc epoch : 27 test accuracy : 0.924201
Counter({0: 4075, 1: 3616})

========================================================================================================================================================================================================
best acc epoch :  27
validation accuracy :  0.9119895580831624
test accuracy :  0.9242009132420091
last test_accuracy :  0.9251141552511416
second best val :  0.9104978556777923
second best test :  0.9228310502283105
max gap 5
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=15, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=965, tsne=False, val_prop=0.975, weight_decay=0)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  82.05472439236473 Time :  1902
accuracy train: 0.862319 val: 0.750140 test: 0.737900
max validation accuracy : 0.750140 max acc epoch : 1 test accuracy : 0.737900
Counter({1: 4319, 0: 3372})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  51.9040844659321 Time :  1928
accuracy train: 0.891304 val: 0.794332 test: 0.820091
max validation accuracy : 0.794332 max acc epoch : 2 test accuracy : 0.820091
Counter({0: 3978, 1: 3713})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  42.78587999141746 Time :  1954
accuracy train: 0.891304 val: 0.789297 test: 0.824658
max validation accuracy : 0.794332 max acc epoch : 2 test accuracy : 0.820091
Counter({0: 4253, 1: 3438})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  29.679250308198107 Time :  1980
accuracy train: 0.985507 val: 0.856424 test: 0.883562
max validation accuracy : 0.856424 max acc epoch : 4 test accuracy : 0.883562
Counter({1: 4239, 0: 3452})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  11.307901090060113 Time :  2017
accuracy train: 0.949275 val: 0.810367 test: 0.841096
max validation accuracy : 0.856424 max acc epoch : 4 test accuracy : 0.883562
Counter({1: 4165, 0: 3526})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  10.158337702276185 Time :  2037
accuracy train: 1.000000 val: 0.873392 test: 0.890411
max validation accuracy : 0.873392 max acc epoch : 6 test accuracy : 0.890411
Counter({1: 4016, 0: 3675})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  3.449855083868897 Time :  2091
accuracy train: 1.000000 val: 0.878053 test: 0.897260
max validation accuracy : 0.878053 max acc epoch : 7 test accuracy : 0.897260
Counter({0: 4010, 1: 3681})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  3.3213151390009443 Time :  2141
accuracy train: 1.000000 val: 0.884393 test: 0.910502
max validation accuracy : 0.884393 max acc epoch : 8 test accuracy : 0.910502
Counter({1: 4022, 0: 3669})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  2.3757166300529207 Time :  2193
accuracy train: 1.000000 val: 0.881783 test: 0.908676
max validation accuracy : 0.884393 max acc epoch : 8 test accuracy : 0.910502
Counter({0: 4028, 1: 3663})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  1.7400163362399326 Time :  2241
accuracy train: 1.000000 val: 0.883274 test: 0.910046
max validation accuracy : 0.884393 max acc epoch : 8 test accuracy : 0.910502
Counter({1: 4029, 0: 3662})

Epoch :  11 loss training:  1.3006808120626374 Time :  2291
accuracy train: 1.000000 val: 0.886444 test: 0.914155
max validation accuracy : 0.886444 max acc epoch : 11 test accuracy : 0.914155
Counter({0: 4029, 1: 3662})

Epoch :  12 loss training:  1.557206037711694 Time :  2338
accuracy train: 1.000000 val: 0.887004 test: 0.912785
max validation accuracy : 0.887004 max acc epoch : 12 test accuracy : 0.912785
Counter({0: 4024, 1: 3667})

Epoch :  13 loss training:  0.7996202974663902 Time :  2375
accuracy train: 1.000000 val: 0.889614 test: 0.913699
max validation accuracy : 0.889614 max acc epoch : 13 test accuracy : 0.913699
Counter({1: 4012, 0: 3679})

Epoch :  14 loss training:  0.8861559894530728 Time :  2406
accuracy train: 1.000000 val: 0.890360 test: 0.916895
max validation accuracy : 0.890360 max acc epoch : 14 test accuracy : 0.916895
Counter({1: 4014, 0: 3677})

Epoch :  15 loss training:  0.6759573203653417 Time :  2428
accuracy train: 1.000000 val: 0.891479 test: 0.916438
max validation accuracy : 0.891479 max acc epoch : 15 test accuracy : 0.916438
Counter({1: 4014, 0: 3677})

Epoch :  16 loss training:  0.5427527535648551 Time :  2462
accuracy train: 1.000000 val: 0.890546 test: 0.916895
max validation accuracy : 0.891479 max acc epoch : 15 test accuracy : 0.916438
Counter({0: 4017, 1: 3674})

Epoch :  17 loss training:  0.5940940226291787 Time :  2503
accuracy train: 1.000000 val: 0.892597 test: 0.916895
max validation accuracy : 0.892597 max acc epoch : 17 test accuracy : 0.916895
Counter({1: 4016, 0: 3675})

Epoch :  18 loss training:  0.7767064651761757 Time :  2550
accuracy train: 1.000000 val: 0.892225 test: 0.915525
max validation accuracy : 0.892597 max acc epoch : 17 test accuracy : 0.916895
Counter({0: 4042, 1: 3649})

Epoch :  19 loss training:  0.8412975208134412 Time :  2592
accuracy train: 1.000000 val: 0.890360 test: 0.916438
max validation accuracy : 0.892597 max acc epoch : 17 test accuracy : 0.916895
Counter({1: 4050, 0: 3641})

Epoch :  20 loss training:  0.41913205551009014 Time :  2620
accuracy train: 1.000000 val: 0.890546 test: 0.915525
max validation accuracy : 0.892597 max acc epoch : 17 test accuracy : 0.916895
Counter({1: 4050, 0: 3641})

Epoch :  21 loss training:  0.3631934473301044 Time :  2689
accuracy train: 1.000000 val: 0.891292 test: 0.917808
max validation accuracy : 0.892597 max acc epoch : 17 test accuracy : 0.916895
Counter({1: 4039, 0: 3652})

Epoch :  22 loss training:  0.4454529898889632 Time :  2756
accuracy train: 1.000000 val: 0.892411 test: 0.918265
max validation accuracy : 0.892597 max acc epoch : 17 test accuracy : 0.916895
Counter({1: 4041, 0: 3650})

Epoch :  23 loss training:  0.447544135734006 Time :  2813
accuracy train: 1.000000 val: 0.891479 test: 0.912785
max validation accuracy : 0.892597 max acc epoch : 17 test accuracy : 0.916895
Counter({0: 4047, 1: 3644})

Epoch :  24 loss training:  0.3734827141761343 Time :  2865
accuracy train: 1.000000 val: 0.892225 test: 0.911872
max validation accuracy : 0.892597 max acc epoch : 17 test accuracy : 0.916895
Counter({1: 4044, 0: 3647})

Epoch :  25 loss training:  0.3514308557905679 Time :  2925
accuracy train: 1.000000 val: 0.895021 test: 0.916895
max validation accuracy : 0.895021 max acc epoch : 25 test accuracy : 0.916895
Counter({0: 4048, 1: 3643})

Epoch :  26 loss training:  0.507153834969813 Time :  2977
accuracy train: 1.000000 val: 0.893716 test: 0.916438
max validation accuracy : 0.895021 max acc epoch : 25 test accuracy : 0.916895
Counter({1: 4010, 0: 3681})

Epoch :  27 loss training:  0.33215483657841105 Time :  3029
accuracy train: 1.000000 val: 0.893530 test: 0.917808
max validation accuracy : 0.895021 max acc epoch : 25 test accuracy : 0.916895
Counter({0: 4026, 1: 3665})

Epoch :  28 loss training:  0.23938824367860434 Time :  3093
accuracy train: 1.000000 val: 0.894649 test: 0.919178
max validation accuracy : 0.895021 max acc epoch : 25 test accuracy : 0.916895
Counter({0: 4037, 1: 3654})

Epoch :  29 loss training:  0.3170290983509858 Time :  3144
accuracy train: 1.000000 val: 0.897445 test: 0.918265
max validation accuracy : 0.897445 max acc epoch : 29 test accuracy : 0.918265
Counter({1: 4034, 0: 3657})

Epoch :  30 loss training:  0.1762518819402885 Time :  3194
accuracy train: 1.000000 val: 0.895208 test: 0.916895
max validation accuracy : 0.897445 max acc epoch : 29 test accuracy : 0.918265
Counter({0: 4046, 1: 3645})

Epoch :  31 loss training:  0.17096238548492693 Time :  3248
accuracy train: 1.000000 val: 0.897445 test: 0.920548
max validation accuracy : 0.897445 max acc epoch : 29 test accuracy : 0.918265
Counter({1: 4044, 0: 3647})

Epoch :  32 loss training:  0.23861360295245504 Time :  3291
accuracy train: 1.000000 val: 0.901548 test: 0.920091
max validation accuracy : 0.901548 max acc epoch : 32 test accuracy : 0.920091
Counter({0: 4052, 1: 3639})

Epoch :  33 loss training:  0.1311175694152098 Time :  3330
accuracy train: 1.000000 val: 0.898005 test: 0.919635
max validation accuracy : 0.901548 max acc epoch : 32 test accuracy : 0.920091
Counter({1: 4051, 0: 3640})

Epoch :  34 loss training:  0.16625688346584866 Time :  3367
accuracy train: 1.000000 val: 0.899310 test: 0.919178
max validation accuracy : 0.901548 max acc epoch : 32 test accuracy : 0.920091
Counter({1: 4050, 0: 3641})

Epoch :  35 loss training:  0.14524787481855128 Time :  3403
accuracy train: 1.000000 val: 0.899124 test: 0.917352
max validation accuracy : 0.901548 max acc epoch : 32 test accuracy : 0.920091
Counter({0: 4048, 1: 3643})

Epoch :  36 loss training:  0.14246482374119296 Time :  3437
accuracy train: 1.000000 val: 0.898378 test: 0.917808
max validation accuracy : 0.901548 max acc epoch : 32 test accuracy : 0.920091
Counter({1: 4047, 0: 3644})

Epoch :  37 loss training:  0.15500781975879363 Time :  3477
accuracy train: 1.000000 val: 0.900056 test: 0.917808
max validation accuracy : 0.901548 max acc epoch : 32 test accuracy : 0.920091
Counter({0: 4047, 1: 3644})

Epoch :  38 loss training:  0.15129209722704218 Time :  3523
accuracy train: 1.000000 val: 0.896140 test: 0.918265
max validation accuracy : 0.901548 max acc epoch : 32 test accuracy : 0.920091
Counter({1: 4047, 0: 3644})

Epoch :  39 loss training:  2.9579955473013797 Time :  3543
accuracy train: 1.000000 val: 0.889800 test: 0.901826
max validation accuracy : 0.901548 max acc epoch : 32 test accuracy : 0.920091
Counter({0: 4072, 1: 3619})

Epoch :  40 loss training:  0.14853274711686026 Time :  3574
accuracy train: 1.000000 val: 0.897259 test: 0.910046
max validation accuracy : 0.901548 max acc epoch : 32 test accuracy : 0.920091
Counter({1: 4064, 0: 3627})

Epoch :  41 loss training:  0.15782050346342658 Time :  3605
accuracy train: 1.000000 val: 0.895208 test: 0.908219
max validation accuracy : 0.901548 max acc epoch : 32 test accuracy : 0.920091
Counter({0: 4067, 1: 3624})

Epoch :  42 loss training:  0.10780594856919379 Time :  3639
accuracy train: 1.000000 val: 0.901175 test: 0.912329
max validation accuracy : 0.901548 max acc epoch : 32 test accuracy : 0.920091
Counter({0: 4063, 1: 3628})

Epoch :  43 loss training:  0.12420764511989546 Time :  3668
accuracy train: 1.000000 val: 0.899310 test: 0.913699
max validation accuracy : 0.901548 max acc epoch : 32 test accuracy : 0.920091
Counter({1: 4065, 0: 3626})

Epoch :  44 loss training:  0.1324184804639117 Time :  3687
accuracy train: 1.000000 val: 0.895954 test: 0.915982
max validation accuracy : 0.901548 max acc epoch : 32 test accuracy : 0.920091
Counter({0: 4054, 1: 3637})

Epoch :  45 loss training:  0.08680683853299342 Time :  3716
accuracy train: 1.000000 val: 0.896700 test: 0.912785
max validation accuracy : 0.901548 max acc epoch : 32 test accuracy : 0.920091
Counter({1: 4049, 0: 3642})

Epoch :  46 loss training:  0.08439219061347103 Time :  3756
accuracy train: 1.000000 val: 0.899869 test: 0.915068
max validation accuracy : 0.901548 max acc epoch : 32 test accuracy : 0.920091
Counter({1: 4035, 0: 3656})

Epoch :  47 loss training:  0.07416031525508515 Time :  3792
accuracy train: 1.000000 val: 0.899497 test: 0.911872
max validation accuracy : 0.901548 max acc epoch : 32 test accuracy : 0.920091
Counter({0: 4042, 1: 3649})

Epoch :  48 loss training:  0.06471923839944793 Time :  3828
accuracy train: 1.000000 val: 0.898937 test: 0.916895
max validation accuracy : 0.901548 max acc epoch : 32 test accuracy : 0.920091
Counter({1: 4046, 0: 3645})

========================================================================================================================================================================================================
best acc epoch :  32
validation accuracy :  0.9015476412455715
test accuracy :  0.9200913242009132
last test_accuracy :  0.9168949771689497
second best val :  0.901174715644229
second best test :  0.9200913242009132
max gap 8
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  27 	 val_accuracy : 0.91199 	 test_accuracy : 0.92420 	 last test_accuracy : 0.92511 	 second best val : 0.91050 	 second best test : 0.92283
k :  1 	 best_acc epoch :  32 	 val_accuracy : 0.90155 	 test_accuracy : 0.92009 	 last test_accuracy : 0.91689 	 second best val : 0.90117 	 second best test : 0.92009

avg :  	 val_accuracy : 0.90677 	 test_accuracy : 0.92215 	 last_accuracy : 0.92100 	 second best val : 0.90584 	 second best test : 0.92146

std :  	 val_accuracy : 0.00522 	 test_accuracy : 0.00205 	 last_accuracy : 0.00411 	 second best val : 0.00466 	 second best test : 0.00137


date and time :  Tue Jun 15 17:13:38 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=15, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=137, tsne=False, val_prop=0.975, weight_decay=0)
device :  cuda:0
Counter({1: 2587, 2: 2546, 0: 2267})

Epoch :  1 loss training:  201.2446619272232 Time :  116
accuracy train: 0.476190 val: 0.304002 test: 0.306208
max validation accuracy : 0.304002 max acc epoch : 1 test accuracy : 0.306208
Counter({1: 3144, 2: 2767, 0: 1489})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  123.97429187037051 Time :  181
accuracy train: 0.476190 val: 0.264895 test: 0.234479
max validation accuracy : 0.304002 max acc epoch : 1 test accuracy : 0.306208
Counter({2: 3345, 1: 2294, 0: 1761})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  107.2751103118062 Time :  267
accuracy train: 0.738095 val: 0.357165 test: 0.358892
max validation accuracy : 0.357165 max acc epoch : 3 test accuracy : 0.358892
Counter({0: 3380, 2: 2311, 1: 1709})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  48.8577952333726 Time :  318
accuracy train: 0.952381 val: 0.414604 test: 0.398714
max validation accuracy : 0.414604 max acc epoch : 4 test accuracy : 0.398714
Counter({0: 3604, 1: 1927, 2: 1869})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  18.900249984115362 Time :  379
accuracy train: 0.964286 val: 0.421632 test: 0.410092
max validation accuracy : 0.421632 max acc epoch : 5 test accuracy : 0.410092
Counter({1: 3475, 0: 1972, 2: 1953})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  20.172509183175862 Time :  417
accuracy train: 0.976190 val: 0.429881 test: 0.416028
max validation accuracy : 0.429881 max acc epoch : 6 test accuracy : 0.416028
Counter({2: 3533, 0: 1952, 1: 1915})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  13.880345988087356 Time :  461
accuracy train: 1.000000 val: 0.447907 test: 0.441256
max validation accuracy : 0.447907 max acc epoch : 7 test accuracy : 0.441256
Counter({0: 3592, 1: 1969, 2: 1839})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  7.219050356652588 Time :  515
accuracy train: 1.000000 val: 0.442102 test: 0.429879
max validation accuracy : 0.447907 max acc epoch : 7 test accuracy : 0.441256
Counter({2: 3596, 1: 1968, 0: 1836})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.450962526258081 Time :  571
accuracy train: 1.000000 val: 0.442408 test: 0.432600
max validation accuracy : 0.447907 max acc epoch : 7 test accuracy : 0.441256
Counter({2: 3612, 1: 1980, 0: 1808})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.936401161365211 Time :  627
accuracy train: 1.000000 val: 0.450046 test: 0.432352
max validation accuracy : 0.450046 max acc epoch : 10 test accuracy : 0.432352
Counter({2: 3629, 1: 1971, 0: 1800})

Epoch :  11 loss training:  6.952428713440895 Time :  677
accuracy train: 1.000000 val: 0.439658 test: 0.427900
max validation accuracy : 0.450046 max acc epoch : 10 test accuracy : 0.432352
Counter({1: 3588, 0: 2004, 2: 1808})

Epoch :  12 loss training:  4.606059533543885 Time :  744
accuracy train: 1.000000 val: 0.440880 test: 0.428642
max validation accuracy : 0.450046 max acc epoch : 10 test accuracy : 0.432352
Counter({2: 3601, 0: 2005, 1: 1794})

Epoch :  13 loss training:  3.871661799348658 Time :  821
accuracy train: 1.000000 val: 0.446991 test: 0.429137
max validation accuracy : 0.450046 max acc epoch : 10 test accuracy : 0.432352
Counter({0: 3602, 1: 2003, 2: 1795})

Epoch :  14 loss training:  3.0541827107663266 Time :  871
accuracy train: 1.000000 val: 0.447296 test: 0.434331
max validation accuracy : 0.450046 max acc epoch : 10 test accuracy : 0.432352
Counter({0: 3595, 1: 2011, 2: 1794})

Epoch :  15 loss training:  2.8645539295393974 Time :  900
accuracy train: 1.000000 val: 0.448213 test: 0.432600
max validation accuracy : 0.450046 max acc epoch : 10 test accuracy : 0.432352
Counter({2: 3592, 1: 2014, 0: 1794})

Epoch :  16 loss training:  2.210293388343416 Time :  939
accuracy train: 1.000000 val: 0.450046 test: 0.432352
max validation accuracy : 0.450046 max acc epoch : 10 test accuracy : 0.432352
Counter({1: 3587, 0: 2020, 2: 1793})

Epoch :  17 loss training:  2.297087154176552 Time :  980
accuracy train: 1.000000 val: 0.449129 test: 0.436062
max validation accuracy : 0.450046 max acc epoch : 10 test accuracy : 0.432352
Counter({0: 3590, 1: 2020, 2: 1790})

Epoch :  18 loss training:  2.5069732133997604 Time :  1002
accuracy train: 1.000000 val: 0.446074 test: 0.433342
max validation accuracy : 0.450046 max acc epoch : 10 test accuracy : 0.432352
Counter({1: 3598, 0: 2029, 2: 1773})

Epoch :  19 loss training:  1.4975841876585037 Time :  1043
accuracy train: 1.000000 val: 0.448518 test: 0.433094
max validation accuracy : 0.450046 max acc epoch : 10 test accuracy : 0.432352
Counter({1: 3593, 2: 2037, 0: 1770})

Epoch :  20 loss training:  2.1664570483844727 Time :  1098
accuracy train: 1.000000 val: 0.447602 test: 0.433342
max validation accuracy : 0.450046 max acc epoch : 10 test accuracy : 0.432352
Counter({0: 3589, 2: 2042, 1: 1769})

Epoch :  21 loss training:  1.2797842371510342 Time :  1148
accuracy train: 1.000000 val: 0.446379 test: 0.433094
max validation accuracy : 0.450046 max acc epoch : 10 test accuracy : 0.432352
Counter({0: 3590, 1: 2046, 2: 1764})

Epoch :  22 loss training:  1.4075003097532317 Time :  1178
accuracy train: 1.000000 val: 0.448824 test: 0.435320
max validation accuracy : 0.450046 max acc epoch : 10 test accuracy : 0.432352
Counter({2: 3589, 0: 2047, 1: 1764})

Epoch :  23 loss training:  1.0508479495765641 Time :  1208
accuracy train: 1.000000 val: 0.445157 test: 0.433836
max validation accuracy : 0.450046 max acc epoch : 10 test accuracy : 0.432352
Counter({0: 3584, 2: 2053, 1: 1763})

Epoch :  24 loss training:  1.0107920886366628 Time :  1266
accuracy train: 1.000000 val: 0.447907 test: 0.433836
max validation accuracy : 0.450046 max acc epoch : 10 test accuracy : 0.432352
Counter({2: 3585, 0: 2053, 1: 1762})

Epoch :  25 loss training:  1.9472588647331577 Time :  1330
accuracy train: 1.000000 val: 0.445157 test: 0.428889
max validation accuracy : 0.450046 max acc epoch : 10 test accuracy : 0.432352
Counter({0: 3597, 2: 2036, 1: 1767})

Epoch :  26 loss training:  1.3312020351877436 Time :  1379
accuracy train: 1.000000 val: 0.445463 test: 0.431858
max validation accuracy : 0.450046 max acc epoch : 10 test accuracy : 0.432352
Counter({0: 3605, 2: 2032, 1: 1763})

========================================================================================================================================================================================================
best acc epoch :  10
validation accuracy :  0.45004582951420713
test accuracy :  0.432352213702696
last test_accuracy :  0.4318575315359881
second best val :  0.44912923923006415
second best test :  0.432352213702696
max gap 3
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=15, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=242, tsne=False, val_prop=0.975, weight_decay=0)
device :  cuda:0
Counter({0: 2587, 1: 2546, 2: 2267})

Epoch :  1 loss training:  191.77964869514108 Time :  1489
accuracy train: 0.464286 val: 0.282004 test: 0.281227
max validation accuracy : 0.282004 max acc epoch : 1 test accuracy : 0.281227
Counter({1: 2702, 2: 2494, 0: 2204})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  128.84270001202822 Time :  1542
accuracy train: 0.654762 val: 0.313168 test: 0.320307
max validation accuracy : 0.313168 max acc epoch : 2 test accuracy : 0.320307
Counter({0: 3326, 1: 2204, 2: 1870})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  69.79853643290699 Time :  1578
accuracy train: 0.750000 val: 0.399022 test: 0.387583
max validation accuracy : 0.399022 max acc epoch : 3 test accuracy : 0.387583
Counter({0: 2739, 2: 2629, 1: 2032})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  48.399695903179236 Time :  1635
accuracy train: 0.940476 val: 0.369080 test: 0.358892
max validation accuracy : 0.399022 max acc epoch : 3 test accuracy : 0.387583
Counter({0: 3116, 2: 2396, 1: 1888})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  20.952314181253314 Time :  1670
accuracy train: 0.988095 val: 0.419493 test: 0.394262
max validation accuracy : 0.419493 max acc epoch : 5 test accuracy : 0.394262
Counter({2: 3475, 1: 2009, 0: 1916})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.520859548356384 Time :  1699
accuracy train: 0.988095 val: 0.451268 test: 0.435073
max validation accuracy : 0.451268 max acc epoch : 6 test accuracy : 0.435073
Counter({2: 3519, 0: 1953, 1: 1928})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.850986743113026 Time :  1734
accuracy train: 1.000000 val: 0.439963 test: 0.429879
max validation accuracy : 0.451268 max acc epoch : 6 test accuracy : 0.435073
Counter({0: 3487, 2: 1963, 1: 1950})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  4.489650907926261 Time :  1779
accuracy train: 1.000000 val: 0.457990 test: 0.443483
max validation accuracy : 0.457990 max acc epoch : 8 test accuracy : 0.443483
Counter({0: 3482, 2: 1961, 1: 1957})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  3.529363740235567 Time :  1801
accuracy train: 1.000000 val: 0.454629 test: 0.444719
max validation accuracy : 0.457990 max acc epoch : 8 test accuracy : 0.443483
Counter({0: 3481, 1: 1975, 2: 1944})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  3.298721735482104 Time :  1834
accuracy train: 1.000000 val: 0.450657 test: 0.447687
max validation accuracy : 0.457990 max acc epoch : 8 test accuracy : 0.443483
Counter({1: 3484, 2: 1973, 0: 1943})

Epoch :  11 loss training:  2.6081127624493092 Time :  1870
accuracy train: 1.000000 val: 0.455851 test: 0.446451
max validation accuracy : 0.457990 max acc epoch : 8 test accuracy : 0.443483
Counter({2: 3492, 0: 1966, 1: 1942})

Epoch :  12 loss training:  2.609063070267439 Time :  1917
accuracy train: 1.000000 val: 0.449129 test: 0.446945
max validation accuracy : 0.457990 max acc epoch : 8 test accuracy : 0.443483
Counter({0: 3495, 2: 1976, 1: 1929})

Epoch :  13 loss training:  2.4603873735759407 Time :  1959
accuracy train: 1.000000 val: 0.454629 test: 0.444719
max validation accuracy : 0.457990 max acc epoch : 8 test accuracy : 0.443483
Counter({0: 3496, 1: 1978, 2: 1926})

Epoch :  14 loss training:  1.8928687270963565 Time :  2003
accuracy train: 1.000000 val: 0.452185 test: 0.448677
max validation accuracy : 0.457990 max acc epoch : 8 test accuracy : 0.443483
Counter({0: 3511, 1: 1979, 2: 1910})

Epoch :  15 loss training:  1.6587848871713504 Time :  2063
accuracy train: 1.000000 val: 0.453101 test: 0.448677
max validation accuracy : 0.457990 max acc epoch : 8 test accuracy : 0.443483
Counter({1: 3507, 2: 1983, 0: 1910})

Epoch :  16 loss training:  1.8720989827997983 Time :  2102
accuracy train: 1.000000 val: 0.452185 test: 0.445461
max validation accuracy : 0.457990 max acc epoch : 8 test accuracy : 0.443483
Counter({1: 3489, 0: 2006, 2: 1905})

Epoch :  17 loss training:  1.4668113118968904 Time :  2149
accuracy train: 1.000000 val: 0.454323 test: 0.448924
max validation accuracy : 0.457990 max acc epoch : 8 test accuracy : 0.443483
Counter({1: 3480, 2: 2010, 0: 1910})

Epoch :  18 loss training:  1.5823661991453264 Time :  2196
accuracy train: 1.000000 val: 0.457073 test: 0.451645
max validation accuracy : 0.457990 max acc epoch : 8 test accuracy : 0.443483
Counter({2: 3448, 0: 2043, 1: 1909})

Epoch :  19 loss training:  1.4656267957179807 Time :  2217
accuracy train: 1.000000 val: 0.454629 test: 0.447687
max validation accuracy : 0.457990 max acc epoch : 8 test accuracy : 0.443483
Counter({2: 3454, 0: 2037, 1: 1909})

Epoch :  20 loss training:  1.1679851740482263 Time :  2256
accuracy train: 1.000000 val: 0.457073 test: 0.448924
max validation accuracy : 0.457990 max acc epoch : 8 test accuracy : 0.443483
Counter({0: 3451, 2: 2041, 1: 1908})

Epoch :  21 loss training:  1.1026047541381558 Time :  2291
accuracy train: 1.000000 val: 0.457684 test: 0.450903
max validation accuracy : 0.457990 max acc epoch : 8 test accuracy : 0.443483
Counter({2: 3456, 1: 2033, 0: 1911})

Epoch :  22 loss training:  1.1204940101597458 Time :  2315
accuracy train: 1.000000 val: 0.459517 test: 0.449666
max validation accuracy : 0.459517 max acc epoch : 22 test accuracy : 0.449666
Counter({1: 3458, 2: 2038, 0: 1904})

Epoch :  23 loss training:  0.9916632766835392 Time :  2353
accuracy train: 1.000000 val: 0.459212 test: 0.450408
max validation accuracy : 0.459517 max acc epoch : 22 test accuracy : 0.449666
Counter({2: 3457, 0: 2038, 1: 1905})

Epoch :  24 loss training:  0.988743336929474 Time :  2399
accuracy train: 1.000000 val: 0.459517 test: 0.449171
max validation accuracy : 0.459517 max acc epoch : 22 test accuracy : 0.449666
Counter({0: 3461, 1: 2042, 2: 1897})

Epoch :  25 loss training:  0.8119542385684326 Time :  2430
accuracy train: 1.000000 val: 0.456767 test: 0.447935
max validation accuracy : 0.459517 max acc epoch : 22 test accuracy : 0.449666
Counter({0: 3457, 1: 2045, 2: 1898})

Epoch :  26 loss training:  0.7262111472373363 Time :  2457
accuracy train: 1.000000 val: 0.455240 test: 0.452140
max validation accuracy : 0.459517 max acc epoch : 22 test accuracy : 0.449666
Counter({0: 3458, 2: 2046, 1: 1896})

Epoch :  27 loss training:  0.6819368849392049 Time :  2496
accuracy train: 1.000000 val: 0.457073 test: 0.452140
max validation accuracy : 0.459517 max acc epoch : 22 test accuracy : 0.449666
Counter({2: 3465, 1: 2041, 0: 1894})

Epoch :  28 loss training:  0.6662065185373649 Time :  2545
accuracy train: 1.000000 val: 0.457379 test: 0.450903
max validation accuracy : 0.459517 max acc epoch : 22 test accuracy : 0.449666
Counter({0: 3474, 1: 2031, 2: 1895})

Epoch :  29 loss training:  0.6885807877697516 Time :  2590
accuracy train: 1.000000 val: 0.452796 test: 0.447193
max validation accuracy : 0.459517 max acc epoch : 22 test accuracy : 0.449666
Counter({0: 3464, 1: 2034, 2: 1902})

Epoch :  30 loss training:  0.6757677351706661 Time :  2618
accuracy train: 1.000000 val: 0.458295 test: 0.448677
max validation accuracy : 0.459517 max acc epoch : 22 test accuracy : 0.449666
Counter({2: 3461, 0: 2038, 1: 1901})

Epoch :  31 loss training:  0.5585848216724116 Time :  2658
accuracy train: 1.000000 val: 0.458906 test: 0.451150
max validation accuracy : 0.459517 max acc epoch : 22 test accuracy : 0.449666
Counter({0: 3460, 1: 2038, 2: 1902})

Epoch :  32 loss training:  0.5211515522096306 Time :  2708
accuracy train: 1.000000 val: 0.461045 test: 0.451150
max validation accuracy : 0.461045 max acc epoch : 32 test accuracy : 0.451150
Counter({0: 3470, 1: 2037, 2: 1893})

Epoch :  33 loss training:  0.49271944534848444 Time :  2750
accuracy train: 1.000000 val: 0.460434 test: 0.451150
max validation accuracy : 0.461045 max acc epoch : 32 test accuracy : 0.451150
Counter({0: 3469, 1: 2037, 2: 1894})

Epoch :  34 loss training:  0.4574144647922367 Time :  2772
accuracy train: 1.000000 val: 0.459823 test: 0.450161
max validation accuracy : 0.461045 max acc epoch : 32 test accuracy : 0.451150
Counter({0: 3467, 1: 2039, 2: 1894})

Epoch :  35 loss training:  0.4053395106748212 Time :  2817
accuracy train: 1.000000 val: 0.461656 test: 0.450903
max validation accuracy : 0.461656 max acc epoch : 35 test accuracy : 0.450903
Counter({0: 3471, 2: 2037, 1: 1892})

Epoch :  36 loss training:  0.49100753691163845 Time :  2848
accuracy train: 1.000000 val: 0.460434 test: 0.447687
max validation accuracy : 0.461656 max acc epoch : 35 test accuracy : 0.450903
Counter({0: 3479, 2: 2031, 1: 1890})

Epoch :  37 loss training:  0.44365617239964195 Time :  2878
accuracy train: 1.000000 val: 0.461350 test: 0.448677
max validation accuracy : 0.461656 max acc epoch : 35 test accuracy : 0.450903
Counter({0: 3480, 2: 2035, 1: 1885})

Epoch :  38 loss training:  0.4162300693569705 Time :  2928
accuracy train: 1.000000 val: 0.458295 test: 0.445709
max validation accuracy : 0.461656 max acc epoch : 35 test accuracy : 0.450903
Counter({1: 3484, 0: 2034, 2: 1882})

Epoch :  39 loss training:  0.4099192049179692 Time :  2953
accuracy train: 1.000000 val: 0.457990 test: 0.451645
max validation accuracy : 0.461656 max acc epoch : 35 test accuracy : 0.450903
Counter({2: 3492, 1: 2035, 0: 1873})

Epoch :  40 loss training:  0.3641207158216275 Time :  2980
accuracy train: 1.000000 val: 0.458295 test: 0.451150
max validation accuracy : 0.461656 max acc epoch : 35 test accuracy : 0.450903
Counter({1: 3495, 2: 2034, 0: 1871})

Epoch :  41 loss training:  0.3078411869792035 Time :  3013
accuracy train: 1.000000 val: 0.460739 test: 0.453624
max validation accuracy : 0.461656 max acc epoch : 35 test accuracy : 0.450903
Counter({0: 3491, 2: 2040, 1: 1869})

Epoch :  42 loss training:  0.314456939115189 Time :  3063
accuracy train: 1.000000 val: 0.459823 test: 0.452882
max validation accuracy : 0.461656 max acc epoch : 35 test accuracy : 0.450903
Counter({1: 3489, 0: 2041, 2: 1870})

Epoch :  43 loss training:  0.2967260094592348 Time :  3089
accuracy train: 1.000000 val: 0.460128 test: 0.455355
max validation accuracy : 0.461656 max acc epoch : 35 test accuracy : 0.450903
Counter({0: 3489, 2: 2043, 1: 1868})

Epoch :  44 loss training:  0.3021548988035647 Time :  3125
accuracy train: 1.000000 val: 0.462267 test: 0.454118
max validation accuracy : 0.462267 max acc epoch : 44 test accuracy : 0.454118
Counter({2: 3490, 0: 2038, 1: 1872})

Epoch :  45 loss training:  0.2861115706327837 Time :  3162
accuracy train: 1.000000 val: 0.465628 test: 0.456839
max validation accuracy : 0.465628 max acc epoch : 45 test accuracy : 0.456839
Counter({0: 3501, 2: 2039, 1: 1860})

Epoch :  46 loss training:  0.28848460990411695 Time :  3208
accuracy train: 1.000000 val: 0.463184 test: 0.454366
max validation accuracy : 0.465628 max acc epoch : 45 test accuracy : 0.456839
Counter({2: 3500, 0: 2038, 1: 1862})

Epoch :  47 loss training:  0.27994536153710214 Time :  3251
accuracy train: 1.000000 val: 0.462267 test: 0.452387
max validation accuracy : 0.465628 max acc epoch : 45 test accuracy : 0.456839
Counter({0: 3495, 2: 2041, 1: 1864})

Epoch :  48 loss training:  0.20518971979618073 Time :  3277
accuracy train: 1.000000 val: 0.461350 test: 0.451645
max validation accuracy : 0.465628 max acc epoch : 45 test accuracy : 0.456839
Counter({0: 3504, 2: 2039, 1: 1857})

Epoch :  49 loss training:  0.3429587461578194 Time :  3325
accuracy train: 1.000000 val: 0.453101 test: 0.442246
max validation accuracy : 0.465628 max acc epoch : 45 test accuracy : 0.456839
Counter({1: 3515, 2: 2034, 0: 1851})

Epoch :  50 loss training:  0.1877206165518146 Time :  3370
accuracy train: 1.000000 val: 0.455240 test: 0.446698
max validation accuracy : 0.465628 max acc epoch : 45 test accuracy : 0.456839
Counter({2: 3509, 0: 2034, 1: 1857})

Epoch :  51 loss training:  0.21227360758348368 Time :  3412
accuracy train: 1.000000 val: 0.455240 test: 0.445461
max validation accuracy : 0.465628 max acc epoch : 45 test accuracy : 0.456839
Counter({0: 3510, 2: 2032, 1: 1858})

Epoch :  52 loss training:  0.14494570253009442 Time :  3432
accuracy train: 1.000000 val: 0.457379 test: 0.449666
max validation accuracy : 0.465628 max acc epoch : 45 test accuracy : 0.456839
Counter({1: 3510, 0: 2033, 2: 1857})

Epoch :  53 loss training:  0.1664417094871169 Time :  3470
accuracy train: 1.000000 val: 0.455240 test: 0.447193
max validation accuracy : 0.465628 max acc epoch : 45 test accuracy : 0.456839
Counter({1: 3514, 0: 2036, 2: 1850})

Epoch :  54 loss training:  0.18204525752662448 Time :  3512
accuracy train: 1.000000 val: 0.456156 test: 0.449171
max validation accuracy : 0.465628 max acc epoch : 45 test accuracy : 0.456839
Counter({2: 3515, 1: 2034, 0: 1851})

Epoch :  55 loss training:  0.146173541987082 Time :  3540
accuracy train: 1.000000 val: 0.457990 test: 0.448924
max validation accuracy : 0.465628 max acc epoch : 45 test accuracy : 0.456839
Counter({2: 3519, 0: 2033, 1: 1848})

Epoch :  56 loss training:  0.17838619568647118 Time :  3572
accuracy train: 1.000000 val: 0.460128 test: 0.450161
max validation accuracy : 0.465628 max acc epoch : 45 test accuracy : 0.456839
Counter({2: 3519, 0: 2037, 1: 1844})

Epoch :  57 loss training:  0.16201386500324588 Time :  3612
accuracy train: 1.000000 val: 0.460739 test: 0.451150
max validation accuracy : 0.465628 max acc epoch : 45 test accuracy : 0.456839
Counter({1: 3514, 0: 2039, 2: 1847})

Epoch :  58 loss training:  0.15131456186645664 Time :  3642
accuracy train: 1.000000 val: 0.460739 test: 0.455602
max validation accuracy : 0.465628 max acc epoch : 45 test accuracy : 0.456839
Counter({1: 3527, 2: 2036, 0: 1837})

Epoch :  59 loss training:  0.1341241835252731 Time :  3688
accuracy train: 1.000000 val: 0.460739 test: 0.455602
max validation accuracy : 0.465628 max acc epoch : 45 test accuracy : 0.456839
Counter({2: 3527, 0: 2033, 1: 1840})

Epoch :  60 loss training:  0.13612450503569562 Time :  3723
accuracy train: 1.000000 val: 0.463184 test: 0.457581
max validation accuracy : 0.465628 max acc epoch : 45 test accuracy : 0.456839
Counter({1: 3528, 2: 2031, 0: 1841})

Epoch :  61 loss training:  0.1638669009480509 Time :  3762
accuracy train: 1.000000 val: 0.465933 test: 0.459312
max validation accuracy : 0.465933 max acc epoch : 61 test accuracy : 0.459312
Counter({2: 3526, 1: 2033, 0: 1841})

Epoch :  62 loss training:  0.12703033341676928 Time :  3784
accuracy train: 1.000000 val: 0.461962 test: 0.452882
max validation accuracy : 0.465933 max acc epoch : 61 test accuracy : 0.459312
Counter({0: 3518, 2: 2039, 1: 1843})

Epoch :  63 loss training:  0.09774085460230708 Time :  3810
accuracy train: 1.000000 val: 0.462573 test: 0.453624
max validation accuracy : 0.465933 max acc epoch : 61 test accuracy : 0.459312
Counter({1: 3521, 0: 2037, 2: 1842})

Epoch :  64 loss training:  0.11362908620503731 Time :  3841
accuracy train: 1.000000 val: 0.460739 test: 0.454613
max validation accuracy : 0.465933 max acc epoch : 61 test accuracy : 0.459312
Counter({0: 3518, 2: 2043, 1: 1839})

Epoch :  65 loss training:  0.11487095859047258 Time :  3865
accuracy train: 1.000000 val: 0.462878 test: 0.452634
max validation accuracy : 0.465933 max acc epoch : 61 test accuracy : 0.459312
Counter({0: 3522, 1: 2037, 2: 1841})

Epoch :  66 loss training:  0.10051820232911268 Time :  3906
accuracy train: 1.000000 val: 0.460434 test: 0.454118
max validation accuracy : 0.465933 max acc epoch : 61 test accuracy : 0.459312
Counter({1: 3524, 2: 2035, 0: 1841})

Epoch :  67 loss training:  0.08631205931305885 Time :  3935
accuracy train: 1.000000 val: 0.460739 test: 0.451645
max validation accuracy : 0.465933 max acc epoch : 61 test accuracy : 0.459312
Counter({1: 3524, 0: 2037, 2: 1839})

Epoch :  68 loss training:  0.10327901166601805 Time :  3959
accuracy train: 1.000000 val: 0.460128 test: 0.450903
max validation accuracy : 0.465933 max acc epoch : 61 test accuracy : 0.459312
Counter({2: 3523, 1: 2037, 0: 1840})

Epoch :  69 loss training:  0.08142322573257843 Time :  3985
accuracy train: 1.000000 val: 0.457684 test: 0.448182
max validation accuracy : 0.465933 max acc epoch : 61 test accuracy : 0.459312
Counter({1: 3516, 2: 2038, 0: 1846})

Epoch :  70 loss training:  0.09255862715508556 Time :  4009
accuracy train: 1.000000 val: 0.461045 test: 0.450161
max validation accuracy : 0.465933 max acc epoch : 61 test accuracy : 0.459312
Counter({2: 3516, 0: 2040, 1: 1844})

Epoch :  71 loss training:  0.08146387262786448 Time :  4039
accuracy train: 1.000000 val: 0.459823 test: 0.451150
max validation accuracy : 0.465933 max acc epoch : 61 test accuracy : 0.459312
Counter({1: 3518, 2: 2045, 0: 1837})

Epoch :  72 loss training:  0.09822548490410554 Time :  4079
accuracy train: 1.000000 val: 0.463795 test: 0.452140
max validation accuracy : 0.465933 max acc epoch : 61 test accuracy : 0.459312
Counter({2: 3521, 0: 2041, 1: 1838})

Epoch :  73 loss training:  0.07408252960522077 Time :  4106
accuracy train: 1.000000 val: 0.461045 test: 0.453376
max validation accuracy : 0.465933 max acc epoch : 61 test accuracy : 0.459312
Counter({2: 3518, 0: 2045, 1: 1837})

Epoch :  74 loss training:  0.06456977480411297 Time :  4139
accuracy train: 1.000000 val: 0.462878 test: 0.452634
max validation accuracy : 0.465933 max acc epoch : 61 test accuracy : 0.459312
Counter({0: 3524, 2: 2043, 1: 1833})

Epoch :  75 loss training:  0.08585525545640849 Time :  4176
accuracy train: 1.000000 val: 0.457684 test: 0.447687
max validation accuracy : 0.465933 max acc epoch : 61 test accuracy : 0.459312
Counter({1: 3521, 0: 2044, 2: 1835})

Epoch :  76 loss training:  0.07839929169858806 Time :  4204
accuracy train: 1.000000 val: 0.461656 test: 0.447935
max validation accuracy : 0.465933 max acc epoch : 61 test accuracy : 0.459312
Counter({0: 3513, 2: 2048, 1: 1839})

Epoch :  77 loss training:  0.0702254485040612 Time :  4240
accuracy train: 1.000000 val: 0.460128 test: 0.452387
max validation accuracy : 0.465933 max acc epoch : 61 test accuracy : 0.459312
Counter({0: 3509, 1: 2050, 2: 1841})

========================================================================================================================================================================================================
best acc epoch :  61
validation accuracy :  0.4659333944393523
test accuracy :  0.45931239178827604
last test_accuracy :  0.4523868414543656
second best val :  0.46562786434463793
second best test :  0.4568389809547366
max gap 16
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  10 	 val_accuracy : 0.45005 	 test_accuracy : 0.43235 	 last test_accuracy : 0.43186 	 second best val : 0.44913 	 second best test : 0.43235
k :  1 	 best_acc epoch :  61 	 val_accuracy : 0.46593 	 test_accuracy : 0.45931 	 last test_accuracy : 0.45239 	 second best val : 0.46563 	 second best test : 0.45684

avg :  	 val_accuracy : 0.45799 	 test_accuracy : 0.44583 	 last_accuracy : 0.44212 	 second best val : 0.45738 	 second best test : 0.44460

std :  	 val_accuracy : 0.00794 	 test_accuracy : 0.01348 	 last_accuracy : 0.01026 	 second best val : 0.00825 	 second best test : 0.01224
