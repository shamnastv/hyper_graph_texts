

date and time :  Fri Jun 11 17:21:46 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=545, weight_decay=1e-10)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  38.97182313981466 Time :  32
accuracy train: 0.955363 val: 0.936364 test: 0.956621
max validation accuracy : 0.936364 max acc epoch : 1 test accuracy : 0.956621
Counter({0: 4184, 1: 3507})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.370163678366225 Time :  53
accuracy train: 0.950313 val: 0.941818 test: 0.957078
max validation accuracy : 0.941818 max acc epoch : 2 test accuracy : 0.957078
Counter({0: 4043, 1: 3648})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  13.843089792877436 Time :  90
accuracy train: 0.952939 val: 0.927273 test: 0.956621
max validation accuracy : 0.941818 max acc epoch : 2 test accuracy : 0.957078
Counter({0: 3989, 1: 3702})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.931198062971816 Time :  123
accuracy train: 0.981620 val: 0.961818 test: 0.968493
max validation accuracy : 0.961818 max acc epoch : 4 test accuracy : 0.968493
Counter({0: 3924, 1: 3767})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.734432080993429 Time :  144
accuracy train: 0.982630 val: 0.967273 test: 0.973059
max validation accuracy : 0.967273 max acc epoch : 5 test accuracy : 0.973059
Counter({0: 3900, 1: 3791})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  7.225355918286368 Time :  166
accuracy train: 0.979196 val: 0.954545 test: 0.973516
max validation accuracy : 0.967273 max acc epoch : 5 test accuracy : 0.973059
Counter({0: 3892, 1: 3799})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.538415796530899 Time :  197
accuracy train: 0.988285 val: 0.978182 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3866, 1: 3825})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.401439838344231 Time :  221
accuracy train: 0.987881 val: 0.969091 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3859, 1: 3832})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.436573218088597 Time :  246
accuracy train: 0.988487 val: 0.963636 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3851, 1: 3840})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  4.802617387555074 Time :  280
accuracy train: 0.990709 val: 0.970909 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3851, 0: 3840})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  4.438486871076748 Time :  306
accuracy train: 0.990507 val: 0.970909 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3856, 0: 3835})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.476108926755842 Time :  330
accuracy train: 0.992325 val: 0.970909 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3861, 0: 3830})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  3.5107007784827147 Time :  351
accuracy train: 0.993941 val: 0.970909 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3866, 0: 3825})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  3.480581174881081 Time :  374
accuracy train: 0.993537 val: 0.972727 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3868, 0: 3823})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  3.6034164101583883 Time :  404
accuracy train: 0.992527 val: 0.970909 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3869, 0: 3822})

Epoch :  16 loss training:  3.44928029429866 Time :  434
accuracy train: 0.993335 val: 0.972727 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3872, 0: 3819})

Epoch :  17 loss training:  2.7956116106943227 Time :  459
accuracy train: 0.994345 val: 0.974545 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3877, 1: 3814})

Epoch :  18 loss training:  2.879736097966088 Time :  481
accuracy train: 0.994547 val: 0.974545 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3879, 0: 3812})

Epoch :  19 loss training:  2.683890445565339 Time :  504
accuracy train: 0.994547 val: 0.972727 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3881, 0: 3810})

Epoch :  20 loss training:  2.72135022492148 Time :  535
accuracy train: 0.995354 val: 0.974545 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3881, 0: 3810})

Epoch :  21 loss training:  2.64681089296937 Time :  571
accuracy train: 0.995152 val: 0.976364 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3884, 1: 3807})

Epoch :  22 loss training:  2.589203234834713 Time :  596
accuracy train: 0.995354 val: 0.976364 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3886, 0: 3805})

Epoch :  23 loss training:  2.4269742206670344 Time :  619
accuracy train: 0.995960 val: 0.976364 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3890, 0: 3801})

Epoch :  24 loss training:  2.194908973411657 Time :  645
accuracy train: 0.994951 val: 0.974545 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3896, 1: 3795})

Epoch :  25 loss training:  2.1642027761263307 Time :  671
accuracy train: 0.995354 val: 0.974545 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3896, 0: 3795})

Epoch :  26 loss training:  2.191640112432651 Time :  693
accuracy train: 0.996566 val: 0.978182 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3897, 1: 3794})

Epoch :  27 loss training:  2.0543431528494693 Time :  719
accuracy train: 0.995556 val: 0.976364 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3898, 0: 3793})

Epoch :  28 loss training:  1.9812294247676618 Time :  748
accuracy train: 0.995556 val: 0.974545 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3901, 0: 3790})

Epoch :  29 loss training:  1.794826638433733 Time :  770
accuracy train: 0.996162 val: 0.970909 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3901, 0: 3790})

Epoch :  30 loss training:  1.94503116919077 Time :  791
accuracy train: 0.995758 val: 0.972727 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3902, 0: 3789})

Epoch :  31 loss training:  1.8784344444575254 Time :  818
accuracy train: 0.995960 val: 0.974545 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3904, 0: 3787})

Epoch :  32 loss training:  2.046515767870005 Time :  850
accuracy train: 0.995960 val: 0.967273 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3904, 0: 3787})

Epoch :  33 loss training:  1.8645248913380783 Time :  883
accuracy train: 0.995758 val: 0.972727 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3911, 1: 3780})

Epoch :  34 loss training:  1.7489947939684498 Time :  907
accuracy train: 0.995960 val: 0.970909 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3912, 0: 3779})

Epoch :  35 loss training:  1.7254162385943346 Time :  933
accuracy train: 0.996162 val: 0.970909 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3915, 0: 3776})

Epoch :  36 loss training:  1.605900193022535 Time :  959
accuracy train: 0.996566 val: 0.970909 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3915, 0: 3776})

Epoch :  37 loss training:  1.6431215638003778 Time :  984
accuracy train: 0.996162 val: 0.970909 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3915, 0: 3776})

Epoch :  38 loss training:  1.6493452620197786 Time :  1004
accuracy train: 0.996364 val: 0.970909 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3921, 0: 3770})

========================================================================================================================================================================================================
best acc epoch :  7
validation accuracy :  0.9781818181818182
test accuracy :  0.9744292237442922
last test_accuracy :  0.9707762557077626
second best val :  0.9763636363636363
second best test :  0.9744292237442922
max gap 2
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=545, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  38.12351348542143 Time :  1082
accuracy train: 0.956372 val: 0.938182 test: 0.956164
max validation accuracy : 0.938182 max acc epoch : 1 test accuracy : 0.956164
Counter({0: 4224, 1: 3467})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  16.88042411778588 Time :  1104
accuracy train: 0.955767 val: 0.943636 test: 0.963470
max validation accuracy : 0.943636 max acc epoch : 2 test accuracy : 0.963470
Counter({0: 4086, 1: 3605})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.866205538521172 Time :  1124
accuracy train: 0.945466 val: 0.936364 test: 0.958447
max validation accuracy : 0.943636 max acc epoch : 2 test accuracy : 0.963470
Counter({0: 4083, 1: 3608})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.319354726932943 Time :  1151
accuracy train: 0.974753 val: 0.956364 test: 0.973059
max validation accuracy : 0.956364 max acc epoch : 4 test accuracy : 0.973059
Counter({0: 4023, 1: 3668})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.253273917362094 Time :  1179
accuracy train: 0.970107 val: 0.949091 test: 0.971233
max validation accuracy : 0.956364 max acc epoch : 4 test accuracy : 0.973059
Counter({1: 4001, 0: 3690})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  7.793224025750533 Time :  1202
accuracy train: 0.976166 val: 0.943636 test: 0.964840
max validation accuracy : 0.956364 max acc epoch : 4 test accuracy : 0.973059
Counter({0: 3948, 1: 3743})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.270686998665042 Time :  1235
accuracy train: 0.985256 val: 0.965455 test: 0.968950
max validation accuracy : 0.965455 max acc epoch : 7 test accuracy : 0.968950
Counter({0: 3910, 1: 3781})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.61434108899266 Time :  1258
accuracy train: 0.989901 val: 0.965455 test: 0.968950
max validation accuracy : 0.965455 max acc epoch : 7 test accuracy : 0.968950
Counter({1: 3876, 0: 3815})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.927528367628838 Time :  1288
accuracy train: 0.989901 val: 0.967273 test: 0.972603
max validation accuracy : 0.967273 max acc epoch : 9 test accuracy : 0.972603
Counter({0: 3867, 1: 3824})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.0020700927925645 Time :  1311
accuracy train: 0.991315 val: 0.972727 test: 0.972146
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.972146
Counter({0: 3846, 1: 3845})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  4.3712216889543924 Time :  1331
accuracy train: 0.992325 val: 0.972727 test: 0.969406
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.972146
Counter({1: 3851, 0: 3840})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.45581369107822 Time :  1357
accuracy train: 0.992527 val: 0.972727 test: 0.971233
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.972146
Counter({1: 3858, 0: 3833})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  3.542088971036719 Time :  1396
accuracy train: 0.992729 val: 0.972727 test: 0.971233
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.972146
Counter({1: 3861, 0: 3830})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  3.296957787064457 Time :  1421
accuracy train: 0.993335 val: 0.974545 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({1: 3867, 0: 3824})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  3.3367285344575066 Time :  1444
accuracy train: 0.993537 val: 0.972727 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({1: 3867, 0: 3824})

Epoch :  16 loss training:  3.2250186993042007 Time :  1467
accuracy train: 0.993739 val: 0.970909 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({0: 3868, 1: 3823})

Epoch :  17 loss training:  2.9275487222184893 Time :  1494
accuracy train: 0.994143 val: 0.970909 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({1: 3875, 0: 3816})

Epoch :  18 loss training:  2.753303091551061 Time :  1523
accuracy train: 0.994143 val: 0.972727 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({1: 3875, 0: 3816})

Epoch :  19 loss training:  3.0274341130352695 Time :  1555
accuracy train: 0.994345 val: 0.974545 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({1: 3880, 0: 3811})

Epoch :  20 loss training:  2.7660134909674525 Time :  1579
accuracy train: 0.994951 val: 0.970909 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({1: 3880, 0: 3811})

Epoch :  21 loss training:  2.4332053666948923 Time :  1601
accuracy train: 0.995758 val: 0.969091 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({1: 3886, 0: 3805})

Epoch :  22 loss training:  2.2745107799055404 Time :  1632
accuracy train: 0.995354 val: 0.970909 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({1: 3886, 0: 3805})

Epoch :  23 loss training:  2.191649658143433 Time :  1655
accuracy train: 0.995556 val: 0.970909 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({1: 3888, 0: 3803})

Epoch :  24 loss training:  2.3052726330497535 Time :  1685
accuracy train: 0.995758 val: 0.970909 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({0: 3889, 1: 3802})

Epoch :  25 loss training:  2.344425278977724 Time :  1713
accuracy train: 0.995152 val: 0.970909 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({0: 3893, 1: 3798})

Epoch :  26 loss training:  2.094141957015381 Time :  1741
accuracy train: 0.995960 val: 0.972727 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({1: 3896, 0: 3795})

Epoch :  27 loss training:  2.2485743870347505 Time :  1770
accuracy train: 0.995758 val: 0.970909 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({1: 3896, 0: 3795})

Epoch :  28 loss training:  2.0334705790810403 Time :  1796
accuracy train: 0.996162 val: 0.970909 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({1: 3899, 0: 3792})

Epoch :  29 loss training:  2.1512534108733234 Time :  1819
accuracy train: 0.995960 val: 0.972727 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({1: 3902, 0: 3789})

Epoch :  30 loss training:  2.0618897056992864 Time :  1850
accuracy train: 0.995556 val: 0.972727 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({1: 3902, 0: 3789})

Epoch :  31 loss training:  2.09832124768036 Time :  1879
accuracy train: 0.995758 val: 0.974545 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({0: 3903, 1: 3788})

Epoch :  32 loss training:  2.032442436436213 Time :  1906
accuracy train: 0.995556 val: 0.969091 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({1: 3904, 0: 3787})

Epoch :  33 loss training:  1.8844647182122571 Time :  1930
accuracy train: 0.995758 val: 0.969091 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({1: 3907, 0: 3784})

Epoch :  34 loss training:  1.6777918717707507 Time :  1953
accuracy train: 0.995960 val: 0.974545 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({0: 3909, 1: 3782})

Epoch :  35 loss training:  1.868940057931468 Time :  1980
accuracy train: 0.996162 val: 0.972727 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({1: 3909, 0: 3782})

Epoch :  36 loss training:  1.7378174340847181 Time :  2016
accuracy train: 0.996364 val: 0.972727 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({1: 3918, 0: 3773})

Epoch :  37 loss training:  1.3313839832080703 Time :  2038
accuracy train: 0.996162 val: 0.970909 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({0: 3918, 1: 3773})

Epoch :  38 loss training:  1.515884290674876 Time :  2062
accuracy train: 0.995960 val: 0.970909 test: 0.967123
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({0: 3918, 1: 3773})

Epoch :  39 loss training:  1.3935368869570084 Time :  2090
accuracy train: 0.996162 val: 0.970909 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({1: 3918, 0: 3773})

Epoch :  40 loss training:  1.601251846353989 Time :  2117
accuracy train: 0.996364 val: 0.972727 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({1: 3919, 0: 3772})

Epoch :  41 loss training:  1.3407486337528098 Time :  2142
accuracy train: 0.996364 val: 0.969091 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({1: 3918, 0: 3773})

Epoch :  42 loss training:  1.3410750171642576 Time :  2166
accuracy train: 0.996162 val: 0.970909 test: 0.966210
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({1: 3920, 0: 3771})

Epoch :  43 loss training:  1.2781982829583285 Time :  2195
accuracy train: 0.996566 val: 0.972727 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({0: 3920, 1: 3771})

Epoch :  44 loss training:  1.4591233452993038 Time :  2218
accuracy train: 0.996566 val: 0.967273 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({0: 3919, 1: 3772})

Epoch :  45 loss training:  1.3435087076613854 Time :  2241
accuracy train: 0.995758 val: 0.963636 test: 0.967123
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.970320
Counter({1: 3920, 0: 3771})

========================================================================================================================================================================================================
best acc epoch :  14
validation accuracy :  0.9745454545454545
test accuracy :  0.9703196347031964
last test_accuracy :  0.9671232876712329
second best val :  0.9727272727272728
second best test :  0.9721461187214612
max gap 4
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=545, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  38.12392899475526 Time :  2306
accuracy train: 0.957382 val: 0.932727 test: 0.955708
max validation accuracy : 0.932727 max acc epoch : 1 test accuracy : 0.955708
Counter({1: 4211, 0: 3480})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.493305037729442 Time :  2343
accuracy train: 0.950717 val: 0.940000 test: 0.955708
max validation accuracy : 0.940000 max acc epoch : 2 test accuracy : 0.955708
Counter({0: 4128, 1: 3563})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.226027735072421 Time :  2364
accuracy train: 0.951323 val: 0.927273 test: 0.960274
max validation accuracy : 0.940000 max acc epoch : 2 test accuracy : 0.955708
Counter({0: 4086, 1: 3605})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.042693431314547 Time :  2389
accuracy train: 0.979398 val: 0.963636 test: 0.968950
max validation accuracy : 0.963636 max acc epoch : 4 test accuracy : 0.968950
Counter({1: 3940, 0: 3751})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.318053816212341 Time :  2422
accuracy train: 0.981822 val: 0.969091 test: 0.973059
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.973059
Counter({1: 3901, 0: 3790})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  6.837376666109776 Time :  2448
accuracy train: 0.982630 val: 0.967273 test: 0.973516
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.973059
Counter({0: 3883, 1: 3808})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.222935014171526 Time :  2469
accuracy train: 0.988689 val: 0.976364 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3871, 1: 3820})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.225562145875301 Time :  2494
accuracy train: 0.986265 val: 0.970909 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3867, 1: 3824})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  4.9961988650029525 Time :  2526
accuracy train: 0.987477 val: 0.963636 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3865, 1: 3826})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  4.403798350220313 Time :  2549
accuracy train: 0.990911 val: 0.974545 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3853, 1: 3838})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  4.406420836341567 Time :  2570
accuracy train: 0.991315 val: 0.974545 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3849, 1: 3842})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.377732811059104 Time :  2595
accuracy train: 0.992527 val: 0.976364 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3846, 1: 3845})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  3.513410244617262 Time :  2625
accuracy train: 0.993941 val: 0.976364 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3851, 0: 3840})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  3.2668291953013977 Time :  2652
accuracy train: 0.993941 val: 0.974545 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3851, 0: 3840})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  3.351742064289283 Time :  2678
accuracy train: 0.992729 val: 0.972727 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3852, 0: 3839})

Epoch :  16 loss training:  3.2286237367079593 Time :  2709
accuracy train: 0.994547 val: 0.974545 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.972603
Counter({1: 3858, 0: 3833})

Epoch :  17 loss training:  2.804146151232999 Time :  2733
accuracy train: 0.994547 val: 0.978182 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.973973
Counter({0: 3861, 1: 3830})

Epoch :  18 loss training:  2.938238473376259 Time :  2755
accuracy train: 0.995152 val: 0.978182 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3863, 0: 3828})

Epoch :  19 loss training:  2.653410532802809 Time :  2779
accuracy train: 0.994749 val: 0.974545 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.973973
Counter({0: 3865, 1: 3826})

Epoch :  20 loss training:  2.531497983785812 Time :  2814
accuracy train: 0.995556 val: 0.978182 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3871, 0: 3820})

Epoch :  21 loss training:  2.5517996668204432 Time :  2840
accuracy train: 0.995556 val: 0.978182 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3878, 0: 3813})

Epoch :  22 loss training:  2.348494865495013 Time :  2864
accuracy train: 0.995556 val: 0.980000 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 22 test accuracy : 0.971689
Counter({1: 3879, 0: 3812})

Epoch :  23 loss training:  2.377404977392871 Time :  2887
accuracy train: 0.995960 val: 0.981818 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.972146
Counter({0: 3879, 1: 3812})

Epoch :  24 loss training:  2.0862332656397484 Time :  2913
accuracy train: 0.995758 val: 0.980000 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3880, 0: 3811})

Epoch :  25 loss training:  1.9673592381295748 Time :  2943
accuracy train: 0.996364 val: 0.983636 test: 0.973516
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({0: 3886, 1: 3805})

Epoch :  26 loss training:  2.1552958564425353 Time :  2980
accuracy train: 0.996566 val: 0.981818 test: 0.972146
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({1: 3890, 0: 3801})

Epoch :  27 loss training:  1.8953510842111427 Time :  3006
accuracy train: 0.996566 val: 0.980000 test: 0.972603
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({0: 3890, 1: 3801})

Epoch :  28 loss training:  1.8613532293093158 Time :  3035
accuracy train: 0.996566 val: 0.978182 test: 0.973059
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({1: 3892, 0: 3799})

Epoch :  29 loss training:  1.8510848465957679 Time :  3062
accuracy train: 0.996566 val: 0.972727 test: 0.972603
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({1: 3893, 0: 3798})

Epoch :  30 loss training:  1.7360359122685622 Time :  3085
accuracy train: 0.996364 val: 0.972727 test: 0.972146
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({1: 3894, 0: 3797})

Epoch :  31 loss training:  1.6556248128072184 Time :  3106
accuracy train: 0.996162 val: 0.974545 test: 0.971233
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({1: 3895, 0: 3796})

Epoch :  32 loss training:  1.8411065952241188 Time :  3136
accuracy train: 0.995960 val: 0.967273 test: 0.971689
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({0: 3894, 1: 3797})

Epoch :  33 loss training:  1.7208962301083375 Time :  3167
accuracy train: 0.996162 val: 0.970909 test: 0.972603
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({1: 3896, 0: 3795})

Epoch :  34 loss training:  1.688111796771409 Time :  3190
accuracy train: 0.995960 val: 0.970909 test: 0.973059
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({1: 3896, 0: 3795})

Epoch :  35 loss training:  1.590217962708266 Time :  3214
accuracy train: 0.996566 val: 0.970909 test: 0.973973
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({1: 3912, 0: 3779})

Epoch :  36 loss training:  1.4344088339130394 Time :  3237
accuracy train: 0.996566 val: 0.965455 test: 0.971233
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({1: 3912, 0: 3779})

Epoch :  37 loss training:  1.3485435818583937 Time :  3267
accuracy train: 0.996566 val: 0.969091 test: 0.971689
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({1: 3912, 0: 3779})

Epoch :  38 loss training:  1.534653924885788 Time :  3301
accuracy train: 0.996364 val: 0.969091 test: 0.973973
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({1: 3914, 0: 3777})

Epoch :  39 loss training:  1.2715944426818169 Time :  3322
accuracy train: 0.996364 val: 0.969091 test: 0.970320
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({1: 3915, 0: 3776})

Epoch :  40 loss training:  1.3189989835464075 Time :  3346
accuracy train: 0.996768 val: 0.970909 test: 0.970320
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({1: 3915, 0: 3776})

Epoch :  41 loss training:  1.1538233613537159 Time :  3377
accuracy train: 0.996768 val: 0.970909 test: 0.972146
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({1: 3914, 0: 3777})

Epoch :  42 loss training:  1.3684247875826259 Time :  3400
accuracy train: 0.996768 val: 0.974545 test: 0.971689
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({1: 3914, 0: 3777})

Epoch :  43 loss training:  1.22065405815556 Time :  3423
accuracy train: 0.996162 val: 0.972727 test: 0.972603
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({1: 3914, 0: 3777})

Epoch :  44 loss training:  1.2360256867796124 Time :  3453
accuracy train: 0.996768 val: 0.970909 test: 0.972603
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({1: 3914, 0: 3777})

Epoch :  45 loss training:  1.1748744445940247 Time :  3476
accuracy train: 0.996970 val: 0.967273 test: 0.970320
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({0: 3915, 1: 3776})

Epoch :  46 loss training:  1.248921004953445 Time :  3505
accuracy train: 0.996768 val: 0.967273 test: 0.970320
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({1: 3915, 0: 3776})

Epoch :  47 loss training:  1.173261055329931 Time :  3528
accuracy train: 0.996970 val: 0.969091 test: 0.973516
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({0: 3915, 1: 3776})

Epoch :  48 loss training:  1.2631002111302223 Time :  3549
accuracy train: 0.996566 val: 0.967273 test: 0.973516
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({0: 3911, 1: 3780})

Epoch :  49 loss training:  1.0594710096920608 Time :  3570
accuracy train: 0.996970 val: 0.970909 test: 0.971689
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({1: 3911, 0: 3780})

Epoch :  50 loss training:  0.9685675279106363 Time :  3602
accuracy train: 0.996970 val: 0.970909 test: 0.971233
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({1: 3911, 0: 3780})

Epoch :  51 loss training:  0.9489265454394626 Time :  3626
accuracy train: 0.996970 val: 0.970909 test: 0.973059
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({1: 3911, 0: 3780})

Epoch :  52 loss training:  1.0896685422158043 Time :  3649
accuracy train: 0.996162 val: 0.970909 test: 0.968950
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({1: 3911, 0: 3780})

Epoch :  53 loss training:  1.0035137944942107 Time :  3670
accuracy train: 0.996970 val: 0.967273 test: 0.971689
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({1: 3911, 0: 3780})

Epoch :  54 loss training:  1.0106935647163482 Time :  3696
accuracy train: 0.996970 val: 0.970909 test: 0.970776
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({0: 3911, 1: 3780})

Epoch :  55 loss training:  0.8617405734439672 Time :  3725
accuracy train: 0.996970 val: 0.967273 test: 0.969863
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({1: 3911, 0: 3780})

Epoch :  56 loss training:  1.218400687452231 Time :  3762
accuracy train: 0.996970 val: 0.969091 test: 0.972603
max validation accuracy : 0.983636 max acc epoch : 25 test accuracy : 0.973516
Counter({1: 3910, 0: 3781})

========================================================================================================================================================================================================
best acc epoch :  25
validation accuracy :  0.9836363636363636
test accuracy :  0.9735159817351599
last test_accuracy :  0.9726027397260274
second best val :  0.9818181818181818
second best test :  0.9721461187214612
max gap 10
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=545, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  38.16422521171626 Time :  3793
accuracy train: 0.954757 val: 0.934545 test: 0.955708
max validation accuracy : 0.934545 max acc epoch : 1 test accuracy : 0.955708
Counter({0: 4204, 1: 3487})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.54883152898401 Time :  3816
accuracy train: 0.943042 val: 0.932727 test: 0.953425
max validation accuracy : 0.934545 max acc epoch : 1 test accuracy : 0.955708
Counter({1: 4157, 0: 3534})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.432077361852862 Time :  3835
accuracy train: 0.959200 val: 0.929091 test: 0.957991
max validation accuracy : 0.934545 max acc epoch : 1 test accuracy : 0.955708
Counter({0: 4054, 1: 3637})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.84458884462947 Time :  3861
accuracy train: 0.980004 val: 0.961818 test: 0.968493
max validation accuracy : 0.961818 max acc epoch : 4 test accuracy : 0.968493
Counter({1: 3935, 0: 3756})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.042295440798625 Time :  3882
accuracy train: 0.981418 val: 0.961818 test: 0.973973
max validation accuracy : 0.961818 max acc epoch : 4 test accuracy : 0.968493
Counter({0: 3898, 1: 3793})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  6.865171537123388 Time :  3915
accuracy train: 0.980610 val: 0.960000 test: 0.973973
max validation accuracy : 0.961818 max acc epoch : 4 test accuracy : 0.968493
Counter({0: 3875, 1: 3816})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.2653829720802605 Time :  3933
accuracy train: 0.987477 val: 0.980000 test: 0.974886
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974886
Counter({0: 3865, 1: 3826})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.252182389522204 Time :  3961
accuracy train: 0.986467 val: 0.972727 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974886
Counter({0: 3863, 1: 3828})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.0120194324990734 Time :  3985
accuracy train: 0.989901 val: 0.967273 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974886
Counter({0: 3859, 1: 3832})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  4.341578748135362 Time :  4006
accuracy train: 0.991315 val: 0.978182 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974886
Counter({1: 3849, 0: 3842})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  4.315651057637297 Time :  4028
accuracy train: 0.991517 val: 0.972727 test: 0.975799
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974886
Counter({1: 3846, 0: 3845})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.245852673819172 Time :  4062
accuracy train: 0.991315 val: 0.976364 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974886
Counter({0: 3853, 1: 3838})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  3.486409268763964 Time :  4086
accuracy train: 0.993537 val: 0.978182 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974886
Counter({1: 3859, 0: 3832})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  3.2401908425963484 Time :  4107
accuracy train: 0.994143 val: 0.976364 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974886
Counter({1: 3861, 0: 3830})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  3.1414442804525606 Time :  4132
accuracy train: 0.993335 val: 0.972727 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974886
Counter({0: 3861, 1: 3830})

Epoch :  16 loss training:  3.3013015473261476 Time :  4160
accuracy train: 0.994345 val: 0.976364 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974886
Counter({1: 3862, 0: 3829})

Epoch :  17 loss training:  2.7328216596506536 Time :  4183
accuracy train: 0.994749 val: 0.978182 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974886
Counter({1: 3868, 0: 3823})

Epoch :  18 loss training:  2.914110055375204 Time :  4215
accuracy train: 0.994951 val: 0.978182 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974886
Counter({1: 3869, 0: 3822})

Epoch :  19 loss training:  2.5881656327546807 Time :  4237
accuracy train: 0.995354 val: 0.978182 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974886
Counter({1: 3872, 0: 3819})

Epoch :  20 loss training:  2.550521245924756 Time :  4256
accuracy train: 0.995354 val: 0.980000 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974886
Counter({1: 3875, 0: 3816})

Epoch :  21 loss training:  2.446641336173343 Time :  4281
accuracy train: 0.995152 val: 0.978182 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974886
Counter({1: 3878, 0: 3813})

Epoch :  22 loss training:  2.3469046186073683 Time :  4305
accuracy train: 0.995556 val: 0.976364 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974886
Counter({1: 3879, 0: 3812})

Epoch :  23 loss training:  2.3718643055708526 Time :  4334
accuracy train: 0.995960 val: 0.980000 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974886
Counter({0: 3886, 1: 3805})

Epoch :  24 loss training:  2.0806946317316033 Time :  4361
accuracy train: 0.995354 val: 0.972727 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974886
Counter({1: 3888, 0: 3803})

Epoch :  25 loss training:  1.952102491952246 Time :  4385
accuracy train: 0.995556 val: 0.981818 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3892, 0: 3799})

Epoch :  26 loss training:  2.1625919127982343 Time :  4404
accuracy train: 0.996364 val: 0.980000 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({0: 3894, 1: 3797})

Epoch :  27 loss training:  1.8315921209505177 Time :  4427
accuracy train: 0.995758 val: 0.978182 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3895, 0: 3796})

Epoch :  28 loss training:  1.807021949600312 Time :  4450
accuracy train: 0.996970 val: 0.972727 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3897, 0: 3794})

Epoch :  29 loss training:  1.795983119023731 Time :  4471
accuracy train: 0.996364 val: 0.970909 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3899, 0: 3792})

Epoch :  30 loss training:  1.719855903997086 Time :  4501
accuracy train: 0.996162 val: 0.972727 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3903, 0: 3788})

Epoch :  31 loss training:  1.7323456998929032 Time :  4521
accuracy train: 0.996162 val: 0.974545 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3903, 0: 3788})

Epoch :  32 loss training:  1.8856840599473799 Time :  4548
accuracy train: 0.996162 val: 0.970909 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3903, 0: 3788})

Epoch :  33 loss training:  1.5325871034292504 Time :  4572
accuracy train: 0.995556 val: 0.970909 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3906, 0: 3785})

Epoch :  34 loss training:  1.6353641467358102 Time :  4595
accuracy train: 0.995960 val: 0.969091 test: 0.974886
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3906, 0: 3785})

Epoch :  35 loss training:  1.5537513295421377 Time :  4619
accuracy train: 0.996162 val: 0.974545 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({0: 3912, 1: 3779})

Epoch :  36 loss training:  1.48300758165351 Time :  4649
accuracy train: 0.995758 val: 0.972727 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3912, 0: 3779})

Epoch :  37 loss training:  1.3527801380696474 Time :  4670
accuracy train: 0.996162 val: 0.970909 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3912, 0: 3779})

Epoch :  38 loss training:  1.4496015151235042 Time :  4692
accuracy train: 0.996162 val: 0.972727 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3914, 0: 3777})

Epoch :  39 loss training:  1.2731895166580216 Time :  4711
accuracy train: 0.994951 val: 0.970909 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3916, 0: 3775})

Epoch :  40 loss training:  1.381186881204485 Time :  4734
accuracy train: 0.996364 val: 0.972727 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3915, 0: 3776})

Epoch :  41 loss training:  1.233491735518328 Time :  4762
accuracy train: 0.996566 val: 0.972727 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3913, 0: 3778})

Epoch :  42 loss training:  1.418190726031753 Time :  4786
accuracy train: 0.996768 val: 0.974545 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3913, 0: 3778})

Epoch :  43 loss training:  1.3786562997411238 Time :  4806
accuracy train: 0.996364 val: 0.974545 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3914, 0: 3777})

Epoch :  44 loss training:  1.3053447455677087 Time :  4829
accuracy train: 0.996768 val: 0.969091 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3914, 0: 3777})

Epoch :  45 loss training:  1.2769856574886944 Time :  4856
accuracy train: 0.996364 val: 0.972727 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3918, 0: 3773})

Epoch :  46 loss training:  1.278652059554588 Time :  4880
accuracy train: 0.996566 val: 0.970909 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3918, 0: 3773})

Epoch :  47 loss training:  1.193399304545892 Time :  4907
accuracy train: 0.996970 val: 0.969091 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3919, 0: 3772})

Epoch :  48 loss training:  1.2490389796439558 Time :  4930
accuracy train: 0.996364 val: 0.969091 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3917, 0: 3774})

Epoch :  49 loss training:  1.0297763377893716 Time :  4956
accuracy train: 0.996768 val: 0.972727 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3917, 0: 3774})

Epoch :  50 loss training:  1.023076096738805 Time :  4978
accuracy train: 0.996364 val: 0.970909 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3917, 0: 3774})

Epoch :  51 loss training:  0.9731982451667136 Time :  5001
accuracy train: 0.996566 val: 0.972727 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({0: 3917, 1: 3774})

Epoch :  52 loss training:  1.0186283220609766 Time :  5021
accuracy train: 0.995960 val: 0.972727 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({0: 3917, 1: 3774})

Epoch :  53 loss training:  1.0338185984801385 Time :  5053
accuracy train: 0.996162 val: 0.970909 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({0: 3915, 1: 3776})

Epoch :  54 loss training:  0.9868719910518848 Time :  5076
accuracy train: 0.996768 val: 0.970909 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3915, 0: 3776})

Epoch :  55 loss training:  0.9893980546985404 Time :  5101
accuracy train: 0.997172 val: 0.967273 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3915, 0: 3776})

Epoch :  56 loss training:  1.1486929980601417 Time :  5123
accuracy train: 0.997374 val: 0.970909 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 25 test accuracy : 0.972603
Counter({1: 3915, 0: 3776})

========================================================================================================================================================================================================
best acc epoch :  25
validation accuracy :  0.9818181818181818
test accuracy :  0.9726027397260274
last test_accuracy :  0.9735159817351599
second best val :  0.98
second best test :  0.9748858447488584
max gap 18
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=545, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  38.149970142985694 Time :  5146
accuracy train: 0.955968 val: 0.936364 test: 0.955708
max validation accuracy : 0.936364 max acc epoch : 1 test accuracy : 0.955708
Counter({0: 4190, 1: 3501})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.728197642602026 Time :  5170
accuracy train: 0.945264 val: 0.936364 test: 0.953881
max validation accuracy : 0.936364 max acc epoch : 1 test accuracy : 0.955708
Counter({0: 4107, 1: 3584})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.512691654614173 Time :  5204
accuracy train: 0.956170 val: 0.929091 test: 0.957078
max validation accuracy : 0.936364 max acc epoch : 1 test accuracy : 0.955708
Counter({0: 4069, 1: 3622})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.731629228248494 Time :  5224
accuracy train: 0.980206 val: 0.960000 test: 0.968037
max validation accuracy : 0.960000 max acc epoch : 4 test accuracy : 0.968037
Counter({0: 3951, 1: 3740})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.038522651215317 Time :  5243
accuracy train: 0.982428 val: 0.956364 test: 0.975342
max validation accuracy : 0.960000 max acc epoch : 4 test accuracy : 0.968037
Counter({1: 3915, 0: 3776})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  7.10689564414497 Time :  5265
accuracy train: 0.982630 val: 0.963636 test: 0.972146
max validation accuracy : 0.963636 max acc epoch : 6 test accuracy : 0.972146
Counter({0: 3892, 1: 3799})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.2127432961715385 Time :  5287
accuracy train: 0.988487 val: 0.976364 test: 0.974429
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3878, 1: 3813})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.250075422198279 Time :  5308
accuracy train: 0.987881 val: 0.974545 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3870, 1: 3821})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  4.989861073234351 Time :  5329
accuracy train: 0.989497 val: 0.967273 test: 0.973973
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3864, 1: 3827})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  4.574878311294015 Time :  5359
accuracy train: 0.989497 val: 0.972727 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3847, 0: 3844})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  4.4409787799813785 Time :  5381
accuracy train: 0.991719 val: 0.974545 test: 0.973516
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3851, 0: 3840})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.377105036488501 Time :  5399
accuracy train: 0.992123 val: 0.976364 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3855, 1: 3836})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  3.590442985005211 Time :  5423
accuracy train: 0.992527 val: 0.974545 test: 0.973516
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3858, 0: 3833})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  3.3102843278320506 Time :  5452
accuracy train: 0.992527 val: 0.976364 test: 0.973516
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3859, 0: 3832})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  3.322066896187607 Time :  5481
accuracy train: 0.993133 val: 0.976364 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3857, 0: 3834})

Epoch :  16 loss training:  3.301368293876294 Time :  5502
accuracy train: 0.994143 val: 0.978182 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 16 test accuracy : 0.973516
Counter({1: 3859, 0: 3832})

Epoch :  17 loss training:  2.8390886647393927 Time :  5529
accuracy train: 0.994547 val: 0.978182 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 16 test accuracy : 0.973516
Counter({1: 3863, 0: 3828})

Epoch :  18 loss training:  2.903165957337478 Time :  5557
accuracy train: 0.994345 val: 0.978182 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 16 test accuracy : 0.973516
Counter({1: 3863, 0: 3828})

Epoch :  19 loss training:  2.7419822801020928 Time :  5581
accuracy train: 0.995152 val: 0.974545 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 16 test accuracy : 0.973516
Counter({0: 3865, 1: 3826})

Epoch :  20 loss training:  2.604525897302665 Time :  5603
accuracy train: 0.995152 val: 0.980000 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.973973
Counter({1: 3873, 0: 3818})

Epoch :  21 loss training:  2.571251026398386 Time :  5632
accuracy train: 0.995556 val: 0.978182 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.973973
Counter({1: 3879, 0: 3812})

Epoch :  22 loss training:  2.322398971526127 Time :  5655
accuracy train: 0.995354 val: 0.978182 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.973973
Counter({1: 3879, 0: 3812})

Epoch :  23 loss training:  2.391908921628783 Time :  5684
accuracy train: 0.995758 val: 0.980000 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.973973
Counter({1: 3883, 0: 3808})

Epoch :  24 loss training:  2.095344357425347 Time :  5706
accuracy train: 0.995152 val: 0.978182 test: 0.975799
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.973973
Counter({0: 3884, 1: 3807})

Epoch :  25 loss training:  2.0371924253413454 Time :  5727
accuracy train: 0.995960 val: 0.980000 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.973973
Counter({1: 3887, 0: 3804})

Epoch :  26 loss training:  2.1968290523509495 Time :  5749
accuracy train: 0.996162 val: 0.980000 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.973973
Counter({1: 3893, 0: 3798})

Epoch :  27 loss training:  1.9002937747136457 Time :  5779
accuracy train: 0.996364 val: 0.981818 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({1: 3893, 0: 3798})

Epoch :  28 loss training:  1.8707787316816393 Time :  5801
accuracy train: 0.996364 val: 0.974545 test: 0.975342
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({0: 3894, 1: 3797})

Epoch :  29 loss training:  1.8822632012015674 Time :  5821
accuracy train: 0.995960 val: 0.972727 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({1: 3897, 0: 3794})

Epoch :  30 loss training:  1.6769926369888708 Time :  5840
accuracy train: 0.996566 val: 0.978182 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({1: 3899, 0: 3792})

Epoch :  31 loss training:  1.7514681194006698 Time :  5864
accuracy train: 0.996566 val: 0.976364 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({1: 3900, 0: 3791})

Epoch :  32 loss training:  1.9427313923661131 Time :  5891
accuracy train: 0.995758 val: 0.970909 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({1: 3899, 0: 3792})

Epoch :  33 loss training:  1.7053142163495068 Time :  5915
accuracy train: 0.995960 val: 0.972727 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({1: 3899, 0: 3792})

Epoch :  34 loss training:  1.6359066579170758 Time :  5933
accuracy train: 0.995960 val: 0.969091 test: 0.974886
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({1: 3899, 0: 3792})

Epoch :  35 loss training:  1.5719134370519896 Time :  5966
accuracy train: 0.996566 val: 0.974545 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({1: 3908, 0: 3783})

Epoch :  36 loss training:  1.4828336400678381 Time :  5987
accuracy train: 0.996162 val: 0.970909 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({0: 3908, 1: 3783})

Epoch :  37 loss training:  1.4128770055249333 Time :  6008
accuracy train: 0.996566 val: 0.974545 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({1: 3908, 0: 3783})

Epoch :  38 loss training:  1.4534279240760952 Time :  6034
accuracy train: 0.995960 val: 0.974545 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({1: 3912, 0: 3779})

Epoch :  39 loss training:  1.2432598524464993 Time :  6062
accuracy train: 0.996566 val: 0.976364 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({1: 3913, 0: 3778})

Epoch :  40 loss training:  1.3284830531592888 Time :  6086
accuracy train: 0.996768 val: 0.972727 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({1: 3912, 0: 3779})

Epoch :  41 loss training:  1.2666200768799172 Time :  6108
accuracy train: 0.997172 val: 0.974545 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({1: 3911, 0: 3780})

Epoch :  42 loss training:  1.3871390207350487 Time :  6130
accuracy train: 0.996970 val: 0.976364 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({0: 3910, 1: 3781})

Epoch :  43 loss training:  1.3080693448027887 Time :  6150
accuracy train: 0.995960 val: 0.970909 test: 0.974886
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({0: 3911, 1: 3780})

Epoch :  44 loss training:  1.3423684920708183 Time :  6183
accuracy train: 0.996768 val: 0.965455 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({1: 3911, 0: 3780})

Epoch :  45 loss training:  1.2725940693126176 Time :  6209
accuracy train: 0.996566 val: 0.974545 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({1: 3915, 0: 3776})

Epoch :  46 loss training:  1.2612952135750675 Time :  6233
accuracy train: 0.996768 val: 0.972727 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({1: 3915, 0: 3776})

Epoch :  47 loss training:  1.1706716373300878 Time :  6256
accuracy train: 0.996970 val: 0.969091 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({1: 3914, 0: 3777})

Epoch :  48 loss training:  1.2341884777706582 Time :  6278
accuracy train: 0.996162 val: 0.967273 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({1: 3913, 0: 3778})

Epoch :  49 loss training:  1.0579110593462246 Time :  6298
accuracy train: 0.996970 val: 0.972727 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({0: 3913, 1: 3778})

Epoch :  50 loss training:  1.0563934874298866 Time :  6331
accuracy train: 0.995556 val: 0.970909 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({1: 3914, 0: 3777})

Epoch :  51 loss training:  1.0519519231238519 Time :  6355
accuracy train: 0.996768 val: 0.972727 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({0: 3915, 1: 3776})

Epoch :  52 loss training:  1.0512904670467833 Time :  6382
accuracy train: 0.996162 val: 0.974545 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({1: 3916, 0: 3775})

Epoch :  53 loss training:  1.0457302951690508 Time :  6404
accuracy train: 0.996970 val: 0.970909 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({1: 3913, 0: 3778})

Epoch :  54 loss training:  1.0546765791077632 Time :  6424
accuracy train: 0.996970 val: 0.972727 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({1: 3913, 0: 3778})

Epoch :  55 loss training:  0.9620446482440457 Time :  6444
accuracy train: 0.997172 val: 0.965455 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({1: 3913, 0: 3778})

Epoch :  56 loss training:  1.1179985579947243 Time :  6480
accuracy train: 0.996566 val: 0.969091 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({0: 3912, 1: 3779})

Epoch :  57 loss training:  0.8785840175623889 Time :  6502
accuracy train: 0.997172 val: 0.965455 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({1: 3912, 0: 3779})

Epoch :  58 loss training:  0.8585215434250131 Time :  6523
accuracy train: 0.996768 val: 0.965455 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 27 test accuracy : 0.973516
Counter({1: 3912, 0: 3779})

========================================================================================================================================================================================================
best acc epoch :  27
validation accuracy :  0.9818181818181818
test accuracy :  0.9735159817351599
last test_accuracy :  0.9735159817351599
second best val :  0.98
second best test :  0.9739726027397261
max gap 9
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=545, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  38.11936124518979 Time :  6549
accuracy train: 0.955161 val: 0.934545 test: 0.956621
max validation accuracy : 0.934545 max acc epoch : 1 test accuracy : 0.956621
Counter({1: 4217, 0: 3474})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.592189447022974 Time :  6568
accuracy train: 0.951323 val: 0.938182 test: 0.957534
max validation accuracy : 0.938182 max acc epoch : 2 test accuracy : 0.957534
Counter({0: 4142, 1: 3549})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  13.886983603151748 Time :  6597
accuracy train: 0.951929 val: 0.929091 test: 0.957991
max validation accuracy : 0.938182 max acc epoch : 2 test accuracy : 0.957534
Counter({0: 4100, 1: 3591})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.973138517671032 Time :  6624
accuracy train: 0.977984 val: 0.958182 test: 0.969863
max validation accuracy : 0.958182 max acc epoch : 4 test accuracy : 0.969863
Counter({1: 3978, 0: 3713})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.181199191196356 Time :  6643
accuracy train: 0.981620 val: 0.960000 test: 0.973059
max validation accuracy : 0.960000 max acc epoch : 5 test accuracy : 0.973059
Counter({0: 3919, 1: 3772})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  6.788609415147221 Time :  6667
accuracy train: 0.982832 val: 0.970909 test: 0.973059
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973059
Counter({0: 3897, 1: 3794})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.310212378506549 Time :  6689
accuracy train: 0.988487 val: 0.972727 test: 0.972603
max validation accuracy : 0.972727 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3877, 1: 3814})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.238099498179508 Time :  6710
accuracy train: 0.987073 val: 0.974545 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971233
Counter({0: 3869, 1: 3822})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.16801680700155 Time :  6728
accuracy train: 0.989093 val: 0.965455 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971233
Counter({1: 3862, 0: 3829})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  4.373716774323839 Time :  6759
accuracy train: 0.990103 val: 0.970909 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971233
Counter({0: 3851, 1: 3840})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  4.441069932770915 Time :  6782
accuracy train: 0.991315 val: 0.970909 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971233
Counter({0: 3849, 1: 3842})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.3556715221493505 Time :  6804
accuracy train: 0.991719 val: 0.972727 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971233
Counter({1: 3853, 0: 3838})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  3.511229627416469 Time :  6824
accuracy train: 0.993335 val: 0.972727 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971233
Counter({0: 3855, 1: 3836})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  3.444063119852217 Time :  6846
accuracy train: 0.993335 val: 0.972727 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971233
Counter({1: 3859, 0: 3832})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  3.234704810252879 Time :  6873
accuracy train: 0.992729 val: 0.972727 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971233
Counter({1: 3859, 0: 3832})

Epoch :  16 loss training:  3.3528607430052944 Time :  6901
accuracy train: 0.994143 val: 0.972727 test: 0.974429
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971233
Counter({1: 3861, 0: 3830})

Epoch :  17 loss training:  2.847716744756326 Time :  6919
accuracy train: 0.994345 val: 0.974545 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971233
Counter({1: 3868, 0: 3823})

Epoch :  18 loss training:  3.003085021584411 Time :  6944
accuracy train: 0.994749 val: 0.974545 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971233
Counter({1: 3869, 0: 3822})

Epoch :  19 loss training:  2.7407893197087105 Time :  6971
accuracy train: 0.994951 val: 0.972727 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971233
Counter({1: 3870, 0: 3821})

Epoch :  20 loss training:  2.6103236645576544 Time :  6992
accuracy train: 0.994951 val: 0.974545 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971233
Counter({1: 3874, 0: 3817})

Epoch :  21 loss training:  2.6144833392172586 Time :  7011
accuracy train: 0.994951 val: 0.974545 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971233
Counter({1: 3876, 0: 3815})

Epoch :  22 loss training:  2.3850011089089094 Time :  7040
accuracy train: 0.995152 val: 0.974545 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971233
Counter({1: 3880, 0: 3811})

Epoch :  23 loss training:  2.4511177082349604 Time :  7068
accuracy train: 0.995354 val: 0.976364 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3888, 0: 3803})

Epoch :  24 loss training:  1.9952149527380243 Time :  7093
accuracy train: 0.995354 val: 0.974545 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3889, 0: 3802})

Epoch :  25 loss training:  1.9820436269510537 Time :  7115
accuracy train: 0.996364 val: 0.974545 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3893, 0: 3798})

Epoch :  26 loss training:  2.1984085754083935 Time :  7133
accuracy train: 0.995960 val: 0.974545 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3895, 0: 3796})

Epoch :  27 loss training:  1.9639845482597593 Time :  7155
accuracy train: 0.995960 val: 0.972727 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3895, 0: 3796})

Epoch :  28 loss training:  1.8883417204779107 Time :  7192
accuracy train: 0.996364 val: 0.970909 test: 0.974886
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3897, 0: 3794})

Epoch :  29 loss training:  1.8927829326421488 Time :  7213
accuracy train: 0.996364 val: 0.970909 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3898, 0: 3793})

Epoch :  30 loss training:  1.7535340006870683 Time :  7235
accuracy train: 0.996364 val: 0.969091 test: 0.973516
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3899, 0: 3792})

Epoch :  31 loss training:  1.7218141824596387 Time :  7257
accuracy train: 0.996162 val: 0.967273 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3899, 0: 3792})

Epoch :  32 loss training:  1.9487672606337583 Time :  7281
accuracy train: 0.995556 val: 0.967273 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3898, 0: 3793})

Epoch :  33 loss training:  1.6012332035170402 Time :  7302
accuracy train: 0.995960 val: 0.967273 test: 0.974429
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({0: 3900, 1: 3791})

Epoch :  34 loss training:  1.6602949814987369 Time :  7334
accuracy train: 0.996364 val: 0.967273 test: 0.975342
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({0: 3905, 1: 3786})

Epoch :  35 loss training:  1.5512291805789573 Time :  7353
accuracy train: 0.996364 val: 0.972727 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3917, 0: 3774})

Epoch :  36 loss training:  1.4635129257512745 Time :  7374
accuracy train: 0.996566 val: 0.963636 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3917, 0: 3774})

Epoch :  37 loss training:  1.3895240182901034 Time :  7401
accuracy train: 0.996566 val: 0.965455 test: 0.973516
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({0: 3917, 1: 3774})

Epoch :  38 loss training:  1.4741119823302142 Time :  7425
accuracy train: 0.996364 val: 0.967273 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3918, 0: 3773})

Epoch :  39 loss training:  1.2735749978673994 Time :  7446
accuracy train: 0.996566 val: 0.965455 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3920, 0: 3771})

Epoch :  40 loss training:  1.3826952151248406 Time :  7472
accuracy train: 0.996566 val: 0.967273 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({0: 3920, 1: 3771})

Epoch :  41 loss training:  1.222478258787305 Time :  7496
accuracy train: 0.996768 val: 0.970909 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3917, 0: 3774})

Epoch :  42 loss training:  1.2660390808159718 Time :  7519
accuracy train: 0.996768 val: 0.972727 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3915, 0: 3776})

Epoch :  43 loss training:  1.2724284342875762 Time :  7540
accuracy train: 0.996364 val: 0.972727 test: 0.974429
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3915, 0: 3776})

Epoch :  44 loss training:  1.2585986103295 Time :  7559
accuracy train: 0.996364 val: 0.970909 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3915, 0: 3776})

Epoch :  45 loss training:  1.2038763038435718 Time :  7584
accuracy train: 0.996566 val: 0.970909 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3916, 0: 3775})

Epoch :  46 loss training:  1.2897772087017074 Time :  7613
accuracy train: 0.996566 val: 0.969091 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3915, 0: 3776})

Epoch :  47 loss training:  1.1652036797895562 Time :  7634
accuracy train: 0.996970 val: 0.969091 test: 0.973516
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3915, 0: 3776})

Epoch :  48 loss training:  1.191869044698251 Time :  7654
accuracy train: 0.995960 val: 0.969091 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3912, 0: 3779})

Epoch :  49 loss training:  1.0202963839255972 Time :  7677
accuracy train: 0.996566 val: 0.972727 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3912, 0: 3779})

Epoch :  50 loss training:  0.9568956124458055 Time :  7701
accuracy train: 0.995354 val: 0.967273 test: 0.973516
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3912, 0: 3779})

Epoch :  51 loss training:  1.0448586566926679 Time :  7729
accuracy train: 0.996970 val: 0.970909 test: 0.973516
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3912, 0: 3779})

Epoch :  52 loss training:  1.144310478339321 Time :  7753
accuracy train: 0.995758 val: 0.976364 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3912, 0: 3779})

Epoch :  53 loss training:  1.0235742416189169 Time :  7772
accuracy train: 0.996768 val: 0.972727 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({0: 3912, 1: 3779})

Epoch :  54 loss training:  1.0358557237341302 Time :  7794
accuracy train: 0.996970 val: 0.970909 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 23 test accuracy : 0.972146
Counter({1: 3911, 0: 3780})

========================================================================================================================================================================================================
best acc epoch :  23
validation accuracy :  0.9763636363636363
test accuracy :  0.9721461187214612
last test_accuracy :  0.9721461187214612
second best val :  0.9745454545454545
second best test :  0.9712328767123287
max gap 15
========================================================================================================================================================================================================

itr : 6
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=545, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  38.1651752339676 Time :  7829
accuracy train: 0.955565 val: 0.934545 test: 0.955251
max validation accuracy : 0.934545 max acc epoch : 1 test accuracy : 0.955251
Counter({0: 4209, 1: 3482})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.669238350354135 Time :  7854
accuracy train: 0.943446 val: 0.932727 test: 0.952055
max validation accuracy : 0.934545 max acc epoch : 1 test accuracy : 0.955251
Counter({0: 4143, 1: 3548})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.201147775049321 Time :  7884
accuracy train: 0.962028 val: 0.934545 test: 0.960731
max validation accuracy : 0.934545 max acc epoch : 1 test accuracy : 0.955251
Counter({0: 4087, 1: 3604})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.929976363084279 Time :  7902
accuracy train: 0.980206 val: 0.963636 test: 0.970320
max validation accuracy : 0.963636 max acc epoch : 4 test accuracy : 0.970320
Counter({0: 3952, 1: 3739})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.301435046771076 Time :  7926
accuracy train: 0.981418 val: 0.961818 test: 0.972603
max validation accuracy : 0.963636 max acc epoch : 4 test accuracy : 0.970320
Counter({1: 3928, 0: 3763})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  6.892120724951383 Time :  7951
accuracy train: 0.981822 val: 0.970909 test: 0.973516
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973516
Counter({0: 3888, 1: 3803})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.223700736532919 Time :  7972
accuracy train: 0.990305 val: 0.980000 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3874, 1: 3817})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.200618467642926 Time :  7990
accuracy train: 0.987881 val: 0.969091 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3868, 1: 3823})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.027669960865751 Time :  8016
accuracy train: 0.990709 val: 0.970909 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3867, 1: 3824})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  4.565292472485453 Time :  8041
accuracy train: 0.991315 val: 0.970909 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3859, 1: 3832})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  4.458361106924713 Time :  8064
accuracy train: 0.991517 val: 0.972727 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3855, 1: 3836})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.377222130715381 Time :  8086
accuracy train: 0.991719 val: 0.974545 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3853, 0: 3838})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  3.580683887412306 Time :  8105
accuracy train: 0.993335 val: 0.972727 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3848, 1: 3843})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  3.4673022792703705 Time :  8127
accuracy train: 0.993739 val: 0.976364 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3847, 1: 3844})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  3.3743062354042195 Time :  8163
accuracy train: 0.992729 val: 0.970909 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3847, 1: 3844})

Epoch :  16 loss training:  3.3634858289151452 Time :  8185
accuracy train: 0.994345 val: 0.970909 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3848, 0: 3843})

Epoch :  17 loss training:  2.855509365675971 Time :  8207
accuracy train: 0.994547 val: 0.976364 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3854, 0: 3837})

Epoch :  18 loss training:  2.906176488599158 Time :  8225
accuracy train: 0.994749 val: 0.980000 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3857, 0: 3834})

Epoch :  19 loss training:  2.759196731087286 Time :  8248
accuracy train: 0.995354 val: 0.978182 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3859, 0: 3832})

Epoch :  20 loss training:  2.6318883737549186 Time :  8275
accuracy train: 0.994951 val: 0.974545 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3864, 0: 3827})

Epoch :  21 loss training:  2.616833494248567 Time :  8309
accuracy train: 0.995354 val: 0.980000 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3868, 0: 3823})

Epoch :  22 loss training:  2.382935951987747 Time :  8329
accuracy train: 0.994951 val: 0.978182 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3868, 0: 3823})

Epoch :  23 loss training:  2.4699837133375695 Time :  8351
accuracy train: 0.996364 val: 0.981818 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({0: 3871, 1: 3820})

Epoch :  24 loss training:  2.24532870441908 Time :  8376
accuracy train: 0.994547 val: 0.974545 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({1: 3877, 0: 3814})

Epoch :  25 loss training:  2.0701771237363573 Time :  8399
accuracy train: 0.995354 val: 0.981818 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({1: 3881, 0: 3810})

Epoch :  26 loss training:  2.3001743380737025 Time :  8420
accuracy train: 0.995758 val: 0.981818 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({1: 3884, 0: 3807})

Epoch :  27 loss training:  2.009715530468384 Time :  8450
accuracy train: 0.995758 val: 0.978182 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({0: 3885, 1: 3806})

Epoch :  28 loss training:  2.0314511689939536 Time :  8468
accuracy train: 0.996162 val: 0.976364 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({0: 3886, 1: 3805})

Epoch :  29 loss training:  1.9346424527175259 Time :  8493
accuracy train: 0.995758 val: 0.972727 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({1: 3888, 0: 3803})

Epoch :  30 loss training:  1.8287785749998875 Time :  8515
accuracy train: 0.996162 val: 0.972727 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({0: 3888, 1: 3803})

Epoch :  31 loss training:  1.7444239739415934 Time :  8536
accuracy train: 0.995960 val: 0.972727 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({0: 3887, 1: 3804})

Epoch :  32 loss training:  1.9041626812249888 Time :  8555
accuracy train: 0.995556 val: 0.972727 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({1: 3888, 0: 3803})

Epoch :  33 loss training:  1.6460052309266757 Time :  8589
accuracy train: 0.995556 val: 0.970909 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({1: 3894, 0: 3797})

Epoch :  34 loss training:  1.7124474883894436 Time :  8609
accuracy train: 0.995556 val: 0.969091 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({0: 3894, 1: 3797})

Epoch :  35 loss training:  1.552511519388645 Time :  8638
accuracy train: 0.995960 val: 0.972727 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({1: 3906, 0: 3785})

Epoch :  36 loss training:  1.494954003719613 Time :  8660
accuracy train: 0.996364 val: 0.969091 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({1: 3906, 0: 3785})

Epoch :  37 loss training:  1.4125608930335147 Time :  8681
accuracy train: 0.996364 val: 0.970909 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({1: 3906, 0: 3785})

Epoch :  38 loss training:  1.5179962014371995 Time :  8700
accuracy train: 0.996162 val: 0.969091 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({1: 3906, 0: 3785})

Epoch :  39 loss training:  1.2841499227943132 Time :  8732
accuracy train: 0.996364 val: 0.974545 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({0: 3910, 1: 3781})

Epoch :  40 loss training:  1.346189346681058 Time :  8753
accuracy train: 0.996566 val: 0.972727 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({1: 3910, 0: 3781})

Epoch :  41 loss training:  1.2768306922371266 Time :  8774
accuracy train: 0.996162 val: 0.972727 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({1: 3910, 0: 3781})

Epoch :  42 loss training:  1.336867099693336 Time :  8792
accuracy train: 0.996566 val: 0.976364 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({1: 3907, 0: 3784})

Epoch :  43 loss training:  1.3446611555664276 Time :  8816
accuracy train: 0.995960 val: 0.972727 test: 0.974886
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({1: 3907, 0: 3784})

Epoch :  44 loss training:  1.3246835112513509 Time :  8841
accuracy train: 0.996566 val: 0.967273 test: 0.974886
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({1: 3908, 0: 3783})

Epoch :  45 loss training:  1.2310033005196601 Time :  8861
accuracy train: 0.996364 val: 0.970909 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({0: 3910, 1: 3781})

Epoch :  46 loss training:  1.2816707404854242 Time :  8881
accuracy train: 0.996566 val: 0.970909 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({1: 3910, 0: 3781})

Epoch :  47 loss training:  1.174364609993063 Time :  8904
accuracy train: 0.996566 val: 0.970909 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({1: 3910, 0: 3781})

Epoch :  48 loss training:  1.150631705429987 Time :  8931
accuracy train: 0.996768 val: 0.969091 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({0: 3910, 1: 3781})

Epoch :  49 loss training:  1.1164962021503015 Time :  8954
accuracy train: 0.996566 val: 0.970909 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({1: 3910, 0: 3781})

Epoch :  50 loss training:  0.9784161778079579 Time :  8984
accuracy train: 0.996566 val: 0.969091 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({0: 3911, 1: 3780})

Epoch :  51 loss training:  1.015282063606719 Time :  9006
accuracy train: 0.996364 val: 0.970909 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({1: 3911, 0: 3780})

Epoch :  52 loss training:  1.0992168558732374 Time :  9025
accuracy train: 0.996364 val: 0.974545 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({1: 3911, 0: 3780})

Epoch :  53 loss training:  1.0658783113794925 Time :  9048
accuracy train: 0.996768 val: 0.974545 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({1: 3908, 0: 3783})

Epoch :  54 loss training:  1.0339033459204074 Time :  9069
accuracy train: 0.997172 val: 0.974545 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.973059
Counter({1: 3909, 0: 3782})

========================================================================================================================================================================================================
best acc epoch :  23
validation accuracy :  0.9818181818181818
test accuracy :  0.9730593607305936
last test_accuracy :  0.9726027397260274
second best val :  0.98
second best test :  0.9744292237442922
max gap 16
========================================================================================================================================================================================================

itr : 7
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=545, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  38.178710941108875 Time :  9095
accuracy train: 0.955767 val: 0.936364 test: 0.954795
max validation accuracy : 0.936364 max acc epoch : 1 test accuracy : 0.954795
Counter({0: 4219, 1: 3472})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.687795411329716 Time :  9126
accuracy train: 0.947283 val: 0.940000 test: 0.954795
max validation accuracy : 0.940000 max acc epoch : 2 test accuracy : 0.954795
Counter({0: 4129, 1: 3562})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.434682618040824 Time :  9142
accuracy train: 0.953545 val: 0.925455 test: 0.957991
max validation accuracy : 0.940000 max acc epoch : 2 test accuracy : 0.954795
Counter({1: 4099, 0: 3592})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.84430521610193 Time :  9165
accuracy train: 0.981418 val: 0.965455 test: 0.973059
max validation accuracy : 0.965455 max acc epoch : 4 test accuracy : 0.973059
Counter({0: 3916, 1: 3775})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  7.887345012859441 Time :  9190
accuracy train: 0.981822 val: 0.969091 test: 0.974429
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.974429
Counter({0: 3898, 1: 3793})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  6.885959787323372 Time :  9211
accuracy train: 0.982226 val: 0.970909 test: 0.972603
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.972603
Counter({1: 3880, 0: 3811})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.339531204430386 Time :  9229
accuracy train: 0.988891 val: 0.978182 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3863, 1: 3828})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.223834197211545 Time :  9259
accuracy train: 0.987073 val: 0.972727 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3858, 0: 3833})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  4.989674840588123 Time :  9284
accuracy train: 0.989497 val: 0.965455 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3853, 1: 3838})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  4.5581084790755995 Time :  9306
accuracy train: 0.990103 val: 0.976364 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3849, 1: 3842})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  4.3734212999697775 Time :  9325
accuracy train: 0.991113 val: 0.978182 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3847, 0: 3844})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.4516348778270185 Time :  9356
accuracy train: 0.991921 val: 0.976364 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3854, 1: 3837})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  3.591963170474628 Time :  9376
accuracy train: 0.993537 val: 0.976364 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3864, 0: 3827})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  3.379267091746442 Time :  9398
accuracy train: 0.993739 val: 0.978182 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3866, 0: 3825})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  3.248202489281539 Time :  9415
accuracy train: 0.992527 val: 0.978182 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3867, 0: 3824})

Epoch :  16 loss training:  3.3248477687011473 Time :  9434
accuracy train: 0.993335 val: 0.976364 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3868, 1: 3823})

Epoch :  17 loss training:  2.8200762668275274 Time :  9455
accuracy train: 0.994547 val: 0.980000 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3869, 0: 3822})

Epoch :  18 loss training:  2.9251239903096575 Time :  9476
accuracy train: 0.994345 val: 0.980000 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({0: 3869, 1: 3822})

Epoch :  19 loss training:  2.7100478233478498 Time :  9498
accuracy train: 0.994951 val: 0.978182 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3874, 0: 3817})

Epoch :  20 loss training:  2.621914515912067 Time :  9520
accuracy train: 0.994951 val: 0.974545 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3874, 0: 3817})

Epoch :  21 loss training:  2.555439417694288 Time :  9540
accuracy train: 0.995152 val: 0.978182 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3877, 0: 3814})

Epoch :  22 loss training:  2.3551817334519 Time :  9565
accuracy train: 0.994951 val: 0.978182 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3877, 0: 3814})

Epoch :  23 loss training:  2.4308886576000077 Time :  9592
accuracy train: 0.995556 val: 0.980000 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3880, 0: 3811})

Epoch :  24 loss training:  2.0939190860954113 Time :  9614
accuracy train: 0.994547 val: 0.978182 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3884, 0: 3807})

Epoch :  25 loss training:  2.0326104316627607 Time :  9641
accuracy train: 0.996162 val: 0.980000 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3887, 0: 3804})

Epoch :  26 loss training:  2.2457240333314985 Time :  9663
accuracy train: 0.996364 val: 0.980000 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3891, 0: 3800})

Epoch :  27 loss training:  1.9513677231734619 Time :  9685
accuracy train: 0.996162 val: 0.980000 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3891, 0: 3800})

Epoch :  28 loss training:  1.9099567088414915 Time :  9708
accuracy train: 0.996364 val: 0.974545 test: 0.974886
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3892, 0: 3799})

Epoch :  29 loss training:  1.8823141087777913 Time :  9732
accuracy train: 0.996364 val: 0.972727 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3894, 0: 3797})

Epoch :  30 loss training:  1.7456263200729154 Time :  9753
accuracy train: 0.996162 val: 0.976364 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3894, 0: 3797})

Epoch :  31 loss training:  1.784561494619993 Time :  9782
accuracy train: 0.996364 val: 0.978182 test: 0.974886
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3894, 0: 3797})

Epoch :  32 loss training:  1.847830399798113 Time :  9802
accuracy train: 0.995758 val: 0.970909 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3893, 0: 3798})

Epoch :  33 loss training:  1.6062790502910502 Time :  9824
accuracy train: 0.995960 val: 0.972727 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3895, 0: 3796})

Epoch :  34 loss training:  1.6708695797715336 Time :  9846
accuracy train: 0.995758 val: 0.969091 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3894, 0: 3797})

Epoch :  35 loss training:  1.5906006538134534 Time :  9867
accuracy train: 0.996364 val: 0.974545 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({0: 3910, 1: 3781})

Epoch :  36 loss training:  1.4383555038075428 Time :  9888
accuracy train: 0.996162 val: 0.970909 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3910, 0: 3781})

Epoch :  37 loss training:  1.367242403954151 Time :  9913
accuracy train: 0.996364 val: 0.972727 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3910, 0: 3781})

Epoch :  38 loss training:  1.5102471514692297 Time :  9935
accuracy train: 0.996162 val: 0.974545 test: 0.974886
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3911, 0: 3780})

Epoch :  39 loss training:  1.198602703967481 Time :  9956
accuracy train: 0.996364 val: 0.976364 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3912, 0: 3779})

Epoch :  40 loss training:  1.3796008841745788 Time :  9977
accuracy train: 0.996364 val: 0.972727 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({0: 3912, 1: 3779})

Epoch :  41 loss training:  1.2185022363555618 Time :  9997
accuracy train: 0.996364 val: 0.970909 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3910, 0: 3781})

Epoch :  42 loss training:  1.3620291430634097 Time :  10018
accuracy train: 0.996566 val: 0.972727 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3908, 0: 3783})

Epoch :  43 loss training:  1.2913911831201403 Time :  10042
accuracy train: 0.996364 val: 0.970909 test: 0.974886
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3910, 0: 3781})

Epoch :  44 loss training:  1.2858300841762684 Time :  10061
accuracy train: 0.995758 val: 0.969091 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3909, 0: 3782})

Epoch :  45 loss training:  1.2557733697613003 Time :  10080
accuracy train: 0.996364 val: 0.974545 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3913, 0: 3778})

Epoch :  46 loss training:  1.3509261627623346 Time :  10100
accuracy train: 0.996768 val: 0.970909 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3911, 0: 3780})

Epoch :  47 loss training:  1.2393622415183927 Time :  10122
accuracy train: 0.996970 val: 0.970909 test: 0.975342
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({1: 3911, 0: 3780})

Epoch :  48 loss training:  1.1832913848629687 Time :  10141
accuracy train: 0.996768 val: 0.967273 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.973973
Counter({0: 3910, 1: 3781})

========================================================================================================================================================================================================
best acc epoch :  17
validation accuracy :  0.98
test accuracy :  0.9739726027397261
last test_accuracy :  0.9730593607305936
second best val :  0.9781818181818182
second best test :  0.9744292237442922
max gap 10
========================================================================================================================================================================================================

itr : 8
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=545, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  38.08918533066753 Time :  10193
accuracy train: 0.956574 val: 0.938182 test: 0.956164
max validation accuracy : 0.938182 max acc epoch : 1 test accuracy : 0.956164
Counter({0: 4208, 1: 3483})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.71112080477178 Time :  10212
accuracy train: 0.941830 val: 0.929091 test: 0.950228
max validation accuracy : 0.938182 max acc epoch : 1 test accuracy : 0.956164
Counter({1: 4120, 0: 3571})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.739457076706458 Time :  10233
accuracy train: 0.954959 val: 0.929091 test: 0.959361
max validation accuracy : 0.938182 max acc epoch : 1 test accuracy : 0.956164
Counter({0: 4013, 1: 3678})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.747500717174262 Time :  10254
accuracy train: 0.979196 val: 0.958182 test: 0.966210
max validation accuracy : 0.958182 max acc epoch : 4 test accuracy : 0.966210
Counter({1: 3882, 0: 3809})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.052978298044764 Time :  10274
accuracy train: 0.982226 val: 0.961818 test: 0.973516
max validation accuracy : 0.961818 max acc epoch : 5 test accuracy : 0.973516
Counter({0: 3877, 1: 3814})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  6.984121671659523 Time :  10292
accuracy train: 0.980206 val: 0.960000 test: 0.974429
max validation accuracy : 0.961818 max acc epoch : 5 test accuracy : 0.973516
Counter({0: 3870, 1: 3821})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.186372124939226 Time :  10319
accuracy train: 0.988487 val: 0.978182 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3858, 1: 3833})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.144573732162826 Time :  10339
accuracy train: 0.988083 val: 0.972727 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3858, 1: 3833})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  4.845910477684811 Time :  10358
accuracy train: 0.987275 val: 0.965455 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3854, 1: 3837})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  4.4851925098046195 Time :  10376
accuracy train: 0.990709 val: 0.972727 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3859, 0: 3832})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  4.457982930063736 Time :  10396
accuracy train: 0.990911 val: 0.970909 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3866, 0: 3825})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.268643141142093 Time :  10417
accuracy train: 0.991921 val: 0.974545 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3869, 1: 3822})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  3.416369839455001 Time :  10441
accuracy train: 0.992931 val: 0.974545 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3877, 1: 3814})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  3.2856625396962045 Time :  10462
accuracy train: 0.993133 val: 0.970909 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3879, 0: 3812})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  3.1724090182979126 Time :  10482
accuracy train: 0.994143 val: 0.970909 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3881, 0: 3810})

Epoch :  16 loss training:  3.198097431741189 Time :  10503
accuracy train: 0.994547 val: 0.970909 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3883, 0: 3808})

Epoch :  17 loss training:  2.60328728944296 Time :  10522
accuracy train: 0.994951 val: 0.972727 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3888, 0: 3803})

Epoch :  18 loss training:  2.8287031191503047 Time :  10543
accuracy train: 0.995152 val: 0.974545 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3889, 1: 3802})

Epoch :  19 loss training:  2.4913466468569823 Time :  10565
accuracy train: 0.995556 val: 0.972727 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3890, 0: 3801})

Epoch :  20 loss training:  2.4890573224402033 Time :  10587
accuracy train: 0.995556 val: 0.974545 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3891, 0: 3800})

Epoch :  21 loss training:  2.4910404707843554 Time :  10607
accuracy train: 0.995354 val: 0.974545 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3893, 0: 3798})

Epoch :  22 loss training:  2.288211619568756 Time :  10628
accuracy train: 0.995354 val: 0.972727 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3893, 0: 3798})

Epoch :  23 loss training:  2.3636572545365198 Time :  10648
accuracy train: 0.996162 val: 0.978182 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3896, 0: 3795})

Epoch :  24 loss training:  1.9955072469310835 Time :  10668
accuracy train: 0.995354 val: 0.972727 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3897, 0: 3794})

Epoch :  25 loss training:  2.0031016984721646 Time :  10690
accuracy train: 0.996566 val: 0.976364 test: 0.976256
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3901, 1: 3790})

Epoch :  26 loss training:  2.0616535956505686 Time :  10712
accuracy train: 0.996364 val: 0.972727 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3901, 0: 3790})

Epoch :  27 loss training:  1.7877163752855267 Time :  10732
accuracy train: 0.996162 val: 0.974545 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3901, 0: 3790})

Epoch :  28 loss training:  1.8526102396572242 Time :  10752
accuracy train: 0.996364 val: 0.974545 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3904, 1: 3787})

Epoch :  29 loss training:  1.7589052945841104 Time :  10772
accuracy train: 0.996566 val: 0.972727 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3905, 0: 3786})

Epoch :  30 loss training:  1.696034829452401 Time :  10792
accuracy train: 0.996566 val: 0.970909 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3909, 0: 3782})

Epoch :  31 loss training:  1.700373356579803 Time :  10812
accuracy train: 0.996768 val: 0.974545 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3912, 0: 3779})

Epoch :  32 loss training:  1.7291610627289629 Time :  10842
accuracy train: 0.996364 val: 0.970909 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3911, 0: 3780})

Epoch :  33 loss training:  1.5955562052258756 Time :  10872
accuracy train: 0.995960 val: 0.970909 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3912, 0: 3779})

Epoch :  34 loss training:  1.5703733049012953 Time :  10899
accuracy train: 0.996162 val: 0.969091 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3912, 0: 3779})

Epoch :  35 loss training:  1.5179769358946942 Time :  10920
accuracy train: 0.996364 val: 0.970909 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3920, 0: 3771})

Epoch :  36 loss training:  1.436374996730592 Time :  10939
accuracy train: 0.996364 val: 0.967273 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3920, 0: 3771})

Epoch :  37 loss training:  1.2709310072968947 Time :  10958
accuracy train: 0.996566 val: 0.970909 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3921, 0: 3770})

Epoch :  38 loss training:  1.426529071162804 Time :  10978
accuracy train: 0.996970 val: 0.972727 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3923, 0: 3768})

========================================================================================================================================================================================================
best acc epoch :  7
validation accuracy :  0.9781818181818182
test accuracy :  0.9744292237442922
last test_accuracy :  0.9730593607305936
second best val :  0.9763636363636363
second best test :  0.9744292237442922
max gap 3
========================================================================================================================================================================================================

itr : 9
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=545, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  38.161067311419174 Time :  11003
accuracy train: 0.954959 val: 0.932727 test: 0.956621
max validation accuracy : 0.932727 max acc epoch : 1 test accuracy : 0.956621
Counter({0: 4217, 1: 3474})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.709817667026073 Time :  11028
accuracy train: 0.941830 val: 0.932727 test: 0.950685
max validation accuracy : 0.932727 max acc epoch : 1 test accuracy : 0.956621
Counter({0: 4141, 1: 3550})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.480507510248572 Time :  11053
accuracy train: 0.960816 val: 0.932727 test: 0.962100
max validation accuracy : 0.932727 max acc epoch : 1 test accuracy : 0.956621
Counter({1: 4047, 0: 3644})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.567992424359545 Time :  11073
accuracy train: 0.982024 val: 0.963636 test: 0.969863
max validation accuracy : 0.963636 max acc epoch : 4 test accuracy : 0.969863
Counter({0: 3903, 1: 3788})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  7.902752436697483 Time :  11094
accuracy train: 0.981822 val: 0.967273 test: 0.973973
max validation accuracy : 0.967273 max acc epoch : 5 test accuracy : 0.973973
Counter({0: 3892, 1: 3799})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  6.7757783744018525 Time :  11113
accuracy train: 0.982832 val: 0.965455 test: 0.973516
max validation accuracy : 0.967273 max acc epoch : 5 test accuracy : 0.973973
Counter({0: 3879, 1: 3812})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.195334948832169 Time :  11145
accuracy train: 0.987477 val: 0.976364 test: 0.974429
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3869, 1: 3822})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.336857961956412 Time :  11165
accuracy train: 0.986871 val: 0.970909 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3864, 1: 3827})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.081617716234177 Time :  11184
accuracy train: 0.989295 val: 0.969091 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3863, 1: 3828})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  4.559066420421004 Time :  11204
accuracy train: 0.989901 val: 0.970909 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3858, 1: 3833})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  4.437379367067479 Time :  11225
accuracy train: 0.990305 val: 0.972727 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3851, 1: 3840})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.3899591866647825 Time :  11249
accuracy train: 0.991719 val: 0.974545 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3847, 1: 3844})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  3.560503135449835 Time :  11283
accuracy train: 0.993133 val: 0.972727 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3848, 0: 3843})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  3.434214337175945 Time :  11304
accuracy train: 0.993537 val: 0.976364 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3849, 1: 3842})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  3.2764554207678884 Time :  11326
accuracy train: 0.992123 val: 0.974545 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.974429
Counter({1: 3849, 0: 3842})

Epoch :  16 loss training:  3.3059067337890156 Time :  11347
accuracy train: 0.993941 val: 0.974545 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.974429
Counter({0: 3851, 1: 3840})

Epoch :  17 loss training:  2.7835196499945596 Time :  11369
accuracy train: 0.994951 val: 0.980000 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({1: 3859, 0: 3832})

Epoch :  18 loss training:  3.000209661127883 Time :  11398
accuracy train: 0.994951 val: 0.976364 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({0: 3862, 1: 3829})

Epoch :  19 loss training:  2.7133331137883943 Time :  11420
accuracy train: 0.995152 val: 0.980000 test: 0.968950
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({1: 3864, 0: 3827})

Epoch :  20 loss training:  2.5919253554893658 Time :  11442
accuracy train: 0.995354 val: 0.976364 test: 0.970320
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({0: 3868, 1: 3823})

Epoch :  21 loss training:  2.535858416784322 Time :  11462
accuracy train: 0.995960 val: 0.976364 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({1: 3873, 0: 3818})

Epoch :  22 loss training:  2.360619666753337 Time :  11483
accuracy train: 0.995556 val: 0.976364 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({1: 3873, 0: 3818})

Epoch :  23 loss training:  2.4011203607951757 Time :  11507
accuracy train: 0.995960 val: 0.980000 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({1: 3876, 0: 3815})

Epoch :  24 loss training:  2.1909196358174086 Time :  11529
accuracy train: 0.995354 val: 0.976364 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({0: 3879, 1: 3812})

Epoch :  25 loss training:  1.9839921342208982 Time :  11550
accuracy train: 0.995556 val: 0.980000 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({1: 3882, 0: 3809})

Epoch :  26 loss training:  2.189638221694622 Time :  11570
accuracy train: 0.995758 val: 0.978182 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({1: 3886, 0: 3805})

Epoch :  27 loss training:  2.0241841393581126 Time :  11589
accuracy train: 0.996566 val: 0.980000 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({1: 3887, 0: 3804})

Epoch :  28 loss training:  1.931302403754671 Time :  11609
accuracy train: 0.996162 val: 0.976364 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({1: 3890, 0: 3801})

Epoch :  29 loss training:  1.8370809012558311 Time :  11634
accuracy train: 0.995758 val: 0.972727 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({1: 3891, 0: 3800})

Epoch :  30 loss training:  1.6784397293522488 Time :  11656
accuracy train: 0.996162 val: 0.976364 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({1: 3894, 0: 3797})

Epoch :  31 loss training:  1.823388601813349 Time :  11677
accuracy train: 0.996162 val: 0.978182 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({0: 3895, 1: 3796})

Epoch :  32 loss training:  1.8229816716047935 Time :  11697
accuracy train: 0.995758 val: 0.970909 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({0: 3894, 1: 3797})

Epoch :  33 loss training:  1.678827907104278 Time :  11716
accuracy train: 0.995758 val: 0.970909 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({0: 3895, 1: 3796})

Epoch :  34 loss training:  1.7266927793534705 Time :  11736
accuracy train: 0.996162 val: 0.970909 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({1: 3895, 0: 3796})

Epoch :  35 loss training:  1.6046167092135875 Time :  11766
accuracy train: 0.996566 val: 0.972727 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({1: 3903, 0: 3788})

Epoch :  36 loss training:  1.5209574145847 Time :  11787
accuracy train: 0.996364 val: 0.969091 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({1: 3903, 0: 3788})

Epoch :  37 loss training:  1.4136539824830834 Time :  11808
accuracy train: 0.996364 val: 0.969091 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({1: 3904, 0: 3787})

Epoch :  38 loss training:  1.530603437742684 Time :  11828
accuracy train: 0.996364 val: 0.972727 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({0: 3905, 1: 3786})

Epoch :  39 loss training:  1.224358315426798 Time :  11848
accuracy train: 0.996364 val: 0.970909 test: 0.970320
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({0: 3907, 1: 3784})

Epoch :  40 loss training:  1.3384885979321552 Time :  11879
accuracy train: 0.996162 val: 0.972727 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({1: 3907, 0: 3784})

Epoch :  41 loss training:  1.2914622696844162 Time :  11898
accuracy train: 0.996162 val: 0.976364 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({1: 3906, 0: 3785})

Epoch :  42 loss training:  1.3402706399247108 Time :  11921
accuracy train: 0.996970 val: 0.978182 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({1: 3903, 0: 3788})

Epoch :  43 loss training:  1.294612346413487 Time :  11949
accuracy train: 0.996364 val: 0.972727 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({1: 3906, 0: 3785})

Epoch :  44 loss training:  1.304194244905375 Time :  11973
accuracy train: 0.996566 val: 0.972727 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({1: 3907, 0: 3784})

Epoch :  45 loss training:  1.218940900726011 Time :  11995
accuracy train: 0.996364 val: 0.974545 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({1: 3908, 0: 3783})

Epoch :  46 loss training:  1.2001322643045569 Time :  12028
accuracy train: 0.996768 val: 0.972727 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({1: 3908, 0: 3783})

Epoch :  47 loss training:  1.193342812890478 Time :  12055
accuracy train: 0.996768 val: 0.972727 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({0: 3909, 1: 3782})

Epoch :  48 loss training:  1.1430990084409132 Time :  12079
accuracy train: 0.996364 val: 0.970909 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.972146
Counter({0: 3909, 1: 3782})

========================================================================================================================================================================================================
best acc epoch :  17
validation accuracy :  0.98
test accuracy :  0.9721461187214612
last test_accuracy :  0.9739726027397261
second best val :  0.9781818181818182
second best test :  0.9721461187214612
max gap 10
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  7 	 val_accuracy : 0.97818 	 test_accuracy : 0.97443 	 last test_accuracy : 0.97078 	 second best val : 0.97636 	 second best test : 0.97443
k :  1 	 best_acc epoch :  14 	 val_accuracy : 0.97455 	 test_accuracy : 0.97032 	 last test_accuracy : 0.96712 	 second best val : 0.97273 	 second best test : 0.97215
k :  2 	 best_acc epoch :  25 	 val_accuracy : 0.98364 	 test_accuracy : 0.97352 	 last test_accuracy : 0.97260 	 second best val : 0.98182 	 second best test : 0.97215
k :  3 	 best_acc epoch :  25 	 val_accuracy : 0.98182 	 test_accuracy : 0.97260 	 last test_accuracy : 0.97352 	 second best val : 0.98000 	 second best test : 0.97489
k :  4 	 best_acc epoch :  27 	 val_accuracy : 0.98182 	 test_accuracy : 0.97352 	 last test_accuracy : 0.97352 	 second best val : 0.98000 	 second best test : 0.97397
k :  5 	 best_acc epoch :  23 	 val_accuracy : 0.97636 	 test_accuracy : 0.97215 	 last test_accuracy : 0.97215 	 second best val : 0.97455 	 second best test : 0.97123
k :  6 	 best_acc epoch :  23 	 val_accuracy : 0.98182 	 test_accuracy : 0.97306 	 last test_accuracy : 0.97260 	 second best val : 0.98000 	 second best test : 0.97443
k :  7 	 best_acc epoch :  17 	 val_accuracy : 0.98000 	 test_accuracy : 0.97397 	 last test_accuracy : 0.97306 	 second best val : 0.97818 	 second best test : 0.97443
k :  8 	 best_acc epoch :  7 	 val_accuracy : 0.97818 	 test_accuracy : 0.97443 	 last test_accuracy : 0.97306 	 second best val : 0.97636 	 second best test : 0.97443
k :  9 	 best_acc epoch :  17 	 val_accuracy : 0.98000 	 test_accuracy : 0.97215 	 last test_accuracy : 0.97397 	 second best val : 0.97818 	 second best test : 0.97215

avg :  	 val_accuracy : 0.97964 	 test_accuracy : 0.97301 	 last_accuracy : 0.97224 	 second best val : 0.97782 	 second best test : 0.97342

std :  	 val_accuracy : 0.00267 	 test_accuracy : 0.00120 	 last_accuracy : 0.00190 	 second best val : 0.00267 	 second best test : 0.00127
