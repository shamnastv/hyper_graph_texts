date and time :  Sun Apr  4 10:21:13 2021
Namespace(batch_size=8, dataset='R52', debug=False, device=0, dropout=0.4, early_stop=100, epochs=400, filename='', hidden_dim=100, lda=False, lr=0.001, num_layers=3, num_mlp_layers=2, random_vec=False, seed=0, weight_decay=1e-05)
device :  cuda:0
min_len_of_sentence : 0
max_len_of_sentence : 453
min_num_of_sentence : 1
max_num_of_sentence : 43
average_len_of_sentence: 15.948564209083706
average_num_of_sentence: 5.114895947426068
Total_num_of_sentence : 46699
Counter({'earn': 3923, 'acq': 2292, 'crude': 374, 'trade': 326, 'money-fx': 309, 'interest': 272, 'money-supply': 151, 'ship': 144, 'sugar': 122, 'coffee': 112, 'gold': 90, 'gnp': 74, 'cpi': 71, 'cocoa': 61, 'grain': 51, 'alum': 50, 'reserves': 49, 'jobs': 49, 'ipi': 45, 'copper': 44, 'rubber': 40, 'iron-steel': 38, 'nat-gas': 36, 'bop': 31, 'veg-oil': 30, 'tin': 27, 'cotton': 24, 'wpi': 23, 'livestock': 22, 'orange': 22, 'retail': 20, 'pet-chem': 19, 'gas': 18, 'housing': 17, 'strategic-metal': 15, 'lei': 14, 'lumber': 14, 'zinc': 13, 'income': 11, 'meal-feed': 11, 'carcass': 11, 'fuel': 11, 'heat': 10, 'lead': 8, 'instal-debt': 6, 'dlr': 6, 'tea': 5, 'potato': 5, 'nickel': 4, 'cpu': 4, 'platinum': 3, 'jet': 3})
Total_number_of_words: 9334
Total_number_of_categories: 52
vocab size : 9334
got embeddings of : 8713
Counter({0: 9130})
HGNNModel(
  (word_embeddings): Embedding(9334, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=100, bias=True)
          (1): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
          (1): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
          (1): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
          (1): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=52, bias=True)
    (1): Linear(in_features=100, out_features=52, bias=True)
    (2): Linear(in_features=100, out_features=52, bias=True)
  )
  (graph_pool_layer): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  1264.1942633390427 Time :  94
accuracy train: 0.833164 val: 0.807927 test: 0.821790
max validation accuracy : 0.807927 max acc epoch : 1 test accuracy : 0.821790

Epoch :  2 loss training:  639.7819746285677 Time :  117
accuracy train: 0.889566 val: 0.853659 test: 0.863424
max validation accuracy : 0.853659 max acc epoch : 2 test accuracy : 0.863424

Epoch :  3 loss training:  482.06899148225784 Time :  138
accuracy train: 0.910230 val: 0.882622 test: 0.887938
max validation accuracy : 0.882622 max acc epoch : 3 test accuracy : 0.887938

Epoch :  4 loss training:  404.03689827024937 Time :  154
accuracy train: 0.924458 val: 0.882622 test: 0.887549
max validation accuracy : 0.882622 max acc epoch : 3 test accuracy : 0.887938

Epoch :  5 loss training:  360.648872949183 Time :  167
accuracy train: 0.937839 val: 0.884146 test: 0.898444
max validation accuracy : 0.884146 max acc epoch : 5 test accuracy : 0.898444

Epoch :  6 loss training:  296.46667446149513 Time :  182
accuracy train: 0.943767 val: 0.902439 test: 0.901167
max validation accuracy : 0.902439 max acc epoch : 6 test accuracy : 0.901167

Epoch :  7 loss training:  267.7597129046917 Time :  203
accuracy train: 0.949864 val: 0.890244 test: 0.899222
max validation accuracy : 0.902439 max acc epoch : 6 test accuracy : 0.901167

Epoch :  8 loss training:  252.40065758069977 Time :  224
accuracy train: 0.947832 val: 0.896341 test: 0.900000
max validation accuracy : 0.902439 max acc epoch : 6 test accuracy : 0.901167

Epoch :  9 loss training:  245.8726646034047 Time :  245
accuracy train: 0.955115 val: 0.891768 test: 0.905447
max validation accuracy : 0.902439 max acc epoch : 6 test accuracy : 0.901167

Epoch :  10 loss training:  231.1258862284012 Time :  265
accuracy train: 0.958841 val: 0.893293 test: 0.907004
max validation accuracy : 0.902439 max acc epoch : 6 test accuracy : 0.901167

Epoch :  11 loss training:  196.35669260092254 Time :  285
accuracy train: 0.964770 val: 0.902439 test: 0.908949
max validation accuracy : 0.902439 max acc epoch : 6 test accuracy : 0.901167

Epoch :  12 loss training:  193.09749210509472 Time :  305
accuracy train: 0.960705 val: 0.914634 test: 0.912062
max validation accuracy : 0.914634 max acc epoch : 12 test accuracy : 0.912062

Epoch :  13 loss training:  197.38686745334417 Time :  325
accuracy train: 0.963923 val: 0.905488 test: 0.915175
max validation accuracy : 0.914634 max acc epoch : 12 test accuracy : 0.912062

Epoch :  14 loss training:  180.0685920678079 Time :  345
accuracy train: 0.961551 val: 0.908537 test: 0.914397
max validation accuracy : 0.914634 max acc epoch : 12 test accuracy : 0.912062

Epoch :  15 loss training:  185.08079238981009 Time :  366
accuracy train: 0.972730 val: 0.911585 test: 0.912451
max validation accuracy : 0.914634 max acc epoch : 12 test accuracy : 0.912062

Epoch :  16 loss training:  172.40214002877474 Time :  388
accuracy train: 0.972053 val: 0.913110 test: 0.917121
max validation accuracy : 0.914634 max acc epoch : 12 test accuracy : 0.912062

Epoch :  17 loss training:  167.50861829146743 Time :  410
accuracy train: 0.971206 val: 0.914634 test: 0.910117
max validation accuracy : 0.914634 max acc epoch : 12 test accuracy : 0.912062

Epoch :  18 loss training:  165.22346787317656 Time :  431
accuracy train: 0.972392 val: 0.922256 test: 0.911284
max validation accuracy : 0.922256 max acc epoch : 18 test accuracy : 0.911284

Epoch :  19 loss training:  168.3377104406245 Time :  451
accuracy train: 0.975102 val: 0.920732 test: 0.909728
max validation accuracy : 0.922256 max acc epoch : 18 test accuracy : 0.911284

Epoch :  20 loss training:  156.26799714332446 Time :  472
accuracy train: 0.975779 val: 0.922256 test: 0.908949
max validation accuracy : 0.922256 max acc epoch : 18 test accuracy : 0.911284

Epoch :  21 loss training:  151.7681892134715 Time :  494
accuracy train: 0.972900 val: 0.916159 test: 0.912062
max validation accuracy : 0.922256 max acc epoch : 18 test accuracy : 0.911284

Epoch :  22 loss training:  148.92440429190174 Time :  517
accuracy train: 0.975610 val: 0.920732 test: 0.913619
max validation accuracy : 0.922256 max acc epoch : 18 test accuracy : 0.911284

Epoch :  23 loss training:  142.25012740062084 Time :  540
accuracy train: 0.975949 val: 0.920732 test: 0.911673
max validation accuracy : 0.922256 max acc epoch : 18 test accuracy : 0.911284

Epoch :  24 loss training:  140.79105062037706 Time :  562
accuracy train: 0.977642 val: 0.917683 test: 0.912062
max validation accuracy : 0.922256 max acc epoch : 18 test accuracy : 0.911284

Epoch :  25 loss training:  140.02391785592772 Time :  586
accuracy train: 0.977304 val: 0.919207 test: 0.912062
max validation accuracy : 0.922256 max acc epoch : 18 test accuracy : 0.911284

Epoch :  26 loss training:  136.86388033779804 Time :  609
accuracy train: 0.978489 val: 0.925305 test: 0.912062
max validation accuracy : 0.925305 max acc epoch : 26 test accuracy : 0.912062

Epoch :  27 loss training:  137.46784069831483 Time :  632
accuracy train: 0.978828 val: 0.922256 test: 0.912451
max validation accuracy : 0.925305 max acc epoch : 26 test accuracy : 0.912062

Epoch :  28 loss training:  131.02333671413362 Time :  648
accuracy train: 0.978997 val: 0.925305 test: 0.911284
max validation accuracy : 0.925305 max acc epoch : 26 test accuracy : 0.912062

Epoch :  29 loss training:  138.24770221533254 Time :  672
accuracy train: 0.978828 val: 0.920732 test: 0.912062
max validation accuracy : 0.925305 max acc epoch : 26 test accuracy : 0.912062

Epoch :  30 loss training:  138.0091087691253 Time :  695
accuracy train: 0.979505 val: 0.920732 test: 0.914397
max validation accuracy : 0.925305 max acc epoch : 26 test accuracy : 0.912062

Epoch :  31 loss training:  131.959113355726 Time :  719
accuracy train: 0.979505 val: 0.925305 test: 0.914397
max validation accuracy : 0.925305 max acc epoch : 26 test accuracy : 0.912062

Epoch :  32 loss training:  130.42735769285355 Time :  740
accuracy train: 0.980522 val: 0.922256 test: 0.912062
max validation accuracy : 0.925305 max acc epoch : 26 test accuracy : 0.912062

Epoch :  33 loss training:  128.269893665798 Time :  760
accuracy train: 0.980691 val: 0.928354 test: 0.912062
max validation accuracy : 0.928354 max acc epoch : 33 test accuracy : 0.912062

Epoch :  34 loss training:  127.46901386755053 Time :  781
accuracy train: 0.978659 val: 0.919207 test: 0.908560
max validation accuracy : 0.928354 max acc epoch : 33 test accuracy : 0.912062

Epoch :  35 loss training:  132.95639868167927 Time :  801
accuracy train: 0.980691 val: 0.920732 test: 0.912062
max validation accuracy : 0.928354 max acc epoch : 33 test accuracy : 0.912062

Epoch :  36 loss training:  129.09009846672416 Time :  818
accuracy train: 0.980860 val: 0.917683 test: 0.912062
max validation accuracy : 0.928354 max acc epoch : 33 test accuracy : 0.912062

Epoch :  37 loss training:  136.79405826190487 Time :  834
accuracy train: 0.981199 val: 0.922256 test: 0.912451
max validation accuracy : 0.928354 max acc epoch : 33 test accuracy : 0.912062

Epoch :  38 loss training:  128.8742001359933 Time :  853
accuracy train: 0.981369 val: 0.920732 test: 0.912451
max validation accuracy : 0.928354 max acc epoch : 33 test accuracy : 0.912062

Epoch :  39 loss training:  129.77151610003784 Time :  874
accuracy train: 0.980183 val: 0.920732 test: 0.911673
max validation accuracy : 0.928354 max acc epoch : 33 test accuracy : 0.912062

Epoch :  40 loss training:  140.79605587222613 Time :  894
accuracy train: 0.981538 val: 0.922256 test: 0.911673
max validation accuracy : 0.928354 max acc epoch : 33 test accuracy : 0.912062

Epoch :  41 loss training:  122.9138949282933 Time :  914
accuracy train: 0.982385 val: 0.925305 test: 0.911673
max validation accuracy : 0.928354 max acc epoch : 33 test accuracy : 0.912062

Epoch :  42 loss training:  123.94344626320526 Time :  933
accuracy train: 0.982215 val: 0.923780 test: 0.912451
max validation accuracy : 0.928354 max acc epoch : 33 test accuracy : 0.912062

Epoch :  43 loss training:  123.78188474616036 Time :  948
accuracy train: 0.981199 val: 0.925305 test: 0.913230
max validation accuracy : 0.928354 max acc epoch : 33 test accuracy : 0.912062

Epoch :  44 loss training:  129.33322649588808 Time :  967
accuracy train: 0.978997 val: 0.919207 test: 0.911284
max validation accuracy : 0.928354 max acc epoch : 33 test accuracy : 0.912062
slurmstepd: error: *** JOB 31700 ON cl-gpusrv1 CANCELLED AT 2021-04-04T10:37:42 ***
