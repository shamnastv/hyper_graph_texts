

date and time :  Fri Jun 18 16:14:54 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=992, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.66630947589874 Time :  12
accuracy train: 0.781695 val: 0.766417 test: 0.770681
max validation accuracy : 0.766417 max acc epoch : 1 test accuracy : 0.770681
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.10467156767845 Time :  22
accuracy train: 0.795432 val: 0.760788 test: 0.771525
max validation accuracy : 0.766417 max acc epoch : 1 test accuracy : 0.770681
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  80.89534676074982 Time :  32
accuracy train: 0.805528 val: 0.772045 test: 0.781654
max validation accuracy : 0.772045 max acc epoch : 3 test accuracy : 0.781654
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.36899469792843 Time :  42
accuracy train: 0.815458 val: 0.780488 test: 0.784750
max validation accuracy : 0.780488 max acc epoch : 4 test accuracy : 0.784750
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  73.87889391183853 Time :  51
accuracy train: 0.821086 val: 0.785178 test: 0.778559
max validation accuracy : 0.785178 max acc epoch : 5 test accuracy : 0.778559
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  73.35040700435638 Time :  61
accuracy train: 0.838299 val: 0.772983 test: 0.772932
max validation accuracy : 0.785178 max acc epoch : 5 test accuracy : 0.778559
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  70.60654146969318 Time :  71
accuracy train: 0.846077 val: 0.781426 test: 0.774339
max validation accuracy : 0.785178 max acc epoch : 5 test accuracy : 0.778559
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  70.12710601091385 Time :  82
accuracy train: 0.849719 val: 0.787054 test: 0.780810
max validation accuracy : 0.787054 max acc epoch : 8 test accuracy : 0.780810
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  68.99313020706177 Time :  92
accuracy train: 0.849057 val: 0.779550 test: 0.777715
max validation accuracy : 0.787054 max acc epoch : 8 test accuracy : 0.780810
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  66.71872758865356 Time :  100
accuracy train: 0.860808 val: 0.783302 test: 0.774057
max validation accuracy : 0.787054 max acc epoch : 8 test accuracy : 0.780810

Epoch :  11 loss training:  66.57469266653061 Time :  112
accuracy train: 0.865276 val: 0.777674 test: 0.776871
max validation accuracy : 0.787054 max acc epoch : 8 test accuracy : 0.780810

Epoch :  12 loss training:  64.29053239524364 Time :  121
accuracy train: 0.868752 val: 0.778612 test: 0.777434
max validation accuracy : 0.787054 max acc epoch : 8 test accuracy : 0.780810

Epoch :  13 loss training:  63.08760264515877 Time :  130
accuracy train: 0.877855 val: 0.779550 test: 0.775746
max validation accuracy : 0.787054 max acc epoch : 8 test accuracy : 0.780810

Epoch :  14 loss training:  61.55775512754917 Time :  140
accuracy train: 0.884144 val: 0.781426 test: 0.778278
max validation accuracy : 0.787054 max acc epoch : 8 test accuracy : 0.780810

Epoch :  15 loss training:  59.94753059744835 Time :  150
accuracy train: 0.892916 val: 0.781426 test: 0.774057
max validation accuracy : 0.787054 max acc epoch : 8 test accuracy : 0.780810

Epoch :  16 loss training:  57.99779711663723 Time :  160
accuracy train: 0.899702 val: 0.779550 test: 0.772651
max validation accuracy : 0.787054 max acc epoch : 8 test accuracy : 0.780810

Epoch :  17 loss training:  56.55606397986412 Time :  171
accuracy train: 0.906488 val: 0.777674 test: 0.774339
max validation accuracy : 0.787054 max acc epoch : 8 test accuracy : 0.780810

Epoch :  18 loss training:  55.52844166755676 Time :  181
accuracy train: 0.912281 val: 0.782364 test: 0.778559
max validation accuracy : 0.787054 max acc epoch : 8 test accuracy : 0.780810

Epoch :  19 loss training:  52.43175868690014 Time :  188
accuracy train: 0.921053 val: 0.772045 test: 0.774620
max validation accuracy : 0.787054 max acc epoch : 8 test accuracy : 0.780810

========================================================================================================================================================================================================
best acc epoch :  8
validation accuracy :  0.7870544090056285
test accuracy :  0.7808103545301069
last test_accuracy :  0.7746201463140123
second best val :  0.7851782363977486
second best test :  0.7785593697242543
max gap 3
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=947, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.21157142519951 Time :  195
accuracy train: 0.783184 val: 0.727017 test: 0.766179
max validation accuracy : 0.727017 max acc epoch : 1 test accuracy : 0.766179
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  82.27867585420609 Time :  206
accuracy train: 0.795929 val: 0.754221 test: 0.763928
max validation accuracy : 0.754221 max acc epoch : 2 test accuracy : 0.763928
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  78.7098779976368 Time :  216
accuracy train: 0.809169 val: 0.740150 test: 0.769274
max validation accuracy : 0.754221 max acc epoch : 2 test accuracy : 0.763928
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  74.16307608783245 Time :  225
accuracy train: 0.823899 val: 0.747655 test: 0.772651
max validation accuracy : 0.754221 max acc epoch : 2 test accuracy : 0.763928
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  72.84566414356232 Time :  236
accuracy train: 0.825885 val: 0.759850 test: 0.773776
max validation accuracy : 0.759850 max acc epoch : 5 test accuracy : 0.773776
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.4663084000349 Time :  245
accuracy train: 0.841443 val: 0.766417 test: 0.774620
max validation accuracy : 0.766417 max acc epoch : 6 test accuracy : 0.774620
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.21399097144604 Time :  255
accuracy train: 0.848891 val: 0.765478 test: 0.772651
max validation accuracy : 0.766417 max acc epoch : 6 test accuracy : 0.774620
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.82944835722446 Time :  265
accuracy train: 0.845581 val: 0.757974 test: 0.773213
max validation accuracy : 0.766417 max acc epoch : 6 test accuracy : 0.774620
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.3974324464798 Time :  275
accuracy train: 0.853525 val: 0.760788 test: 0.767867
max validation accuracy : 0.766417 max acc epoch : 6 test accuracy : 0.774620
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  65.84980311989784 Time :  285
accuracy train: 0.858160 val: 0.762664 test: 0.771525
max validation accuracy : 0.766417 max acc epoch : 6 test accuracy : 0.774620

Epoch :  11 loss training:  65.67439439892769 Time :  295
accuracy train: 0.867097 val: 0.769231 test: 0.771244
max validation accuracy : 0.769231 max acc epoch : 11 test accuracy : 0.771244

Epoch :  12 loss training:  64.05486011505127 Time :  305
accuracy train: 0.871731 val: 0.763602 test: 0.772369
max validation accuracy : 0.769231 max acc epoch : 11 test accuracy : 0.771244

Epoch :  13 loss training:  62.23291562497616 Time :  316
accuracy train: 0.876696 val: 0.772045 test: 0.770118
max validation accuracy : 0.772045 max acc epoch : 13 test accuracy : 0.770118

Epoch :  14 loss training:  60.535106763243675 Time :  326
accuracy train: 0.885137 val: 0.768293 test: 0.769555
max validation accuracy : 0.772045 max acc epoch : 13 test accuracy : 0.770118

Epoch :  15 loss training:  57.922007724642754 Time :  337
accuracy train: 0.889441 val: 0.766417 test: 0.770962
max validation accuracy : 0.772045 max acc epoch : 13 test accuracy : 0.770118

Epoch :  16 loss training:  56.63615120947361 Time :  348
accuracy train: 0.900861 val: 0.755159 test: 0.770118
max validation accuracy : 0.772045 max acc epoch : 13 test accuracy : 0.770118

Epoch :  17 loss training:  55.447863698005676 Time :  360
accuracy train: 0.905495 val: 0.771107 test: 0.770118
max validation accuracy : 0.772045 max acc epoch : 13 test accuracy : 0.770118

Epoch :  18 loss training:  53.01985181868076 Time :  369
accuracy train: 0.915922 val: 0.772983 test: 0.768430
max validation accuracy : 0.772983 max acc epoch : 18 test accuracy : 0.768430

Epoch :  19 loss training:  50.57895515859127 Time :  379
accuracy train: 0.919398 val: 0.765478 test: 0.769837
max validation accuracy : 0.772983 max acc epoch : 18 test accuracy : 0.768430

Epoch :  20 loss training:  50.073358088731766 Time :  390
accuracy train: 0.927673 val: 0.776735 test: 0.772088
max validation accuracy : 0.776735 max acc epoch : 20 test accuracy : 0.772088

Epoch :  21 loss training:  48.80228666961193 Time :  400
accuracy train: 0.930156 val: 0.786116 test: 0.774057
max validation accuracy : 0.786116 max acc epoch : 21 test accuracy : 0.774057

Epoch :  22 loss training:  46.14804004877806 Time :  412
accuracy train: 0.946210 val: 0.770169 test: 0.769274
max validation accuracy : 0.786116 max acc epoch : 21 test accuracy : 0.774057

Epoch :  23 loss training:  44.626902401447296 Time :  420
accuracy train: 0.946872 val: 0.776735 test: 0.769555
max validation accuracy : 0.786116 max acc epoch : 21 test accuracy : 0.774057

Epoch :  24 loss training:  43.61374268680811 Time :  430
accuracy train: 0.954816 val: 0.775797 test: 0.770400
max validation accuracy : 0.786116 max acc epoch : 21 test accuracy : 0.774057

Epoch :  25 loss training:  41.58689995110035 Time :  438
accuracy train: 0.957961 val: 0.772983 test: 0.766179
max validation accuracy : 0.786116 max acc epoch : 21 test accuracy : 0.774057

Epoch :  26 loss training:  39.586435563862324 Time :  446
accuracy train: 0.962926 val: 0.776735 test: 0.766179
max validation accuracy : 0.786116 max acc epoch : 21 test accuracy : 0.774057

Epoch :  27 loss training:  38.03365812450647 Time :  455
accuracy train: 0.966567 val: 0.772045 test: 0.763365
max validation accuracy : 0.786116 max acc epoch : 21 test accuracy : 0.774057

Epoch :  28 loss training:  35.83940780907869 Time :  466
accuracy train: 0.968884 val: 0.772983 test: 0.762802
max validation accuracy : 0.786116 max acc epoch : 21 test accuracy : 0.774057

Epoch :  29 loss training:  35.11549883335829 Time :  475
accuracy train: 0.972360 val: 0.770169 test: 0.765053
max validation accuracy : 0.786116 max acc epoch : 21 test accuracy : 0.774057

Epoch :  30 loss training:  34.06475588679314 Time :  485
accuracy train: 0.975836 val: 0.774859 test: 0.766179
max validation accuracy : 0.786116 max acc epoch : 21 test accuracy : 0.774057

Epoch :  31 loss training:  32.35478180274367 Time :  494
accuracy train: 0.977656 val: 0.778612 test: 0.765898
max validation accuracy : 0.786116 max acc epoch : 21 test accuracy : 0.774057

Epoch :  32 loss training:  32.28231719881296 Time :  503
accuracy train: 0.981463 val: 0.782364 test: 0.759707
max validation accuracy : 0.786116 max acc epoch : 21 test accuracy : 0.774057

========================================================================================================================================================================================================
best acc epoch :  21
validation accuracy :  0.7861163227016885
test accuracy :  0.7740574001125492
last test_accuracy :  0.7597073719752392
second best val :  0.7823639774859287
second best test :  0.7740574001125492
max gap 5
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=74, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.8040726184845 Time :  515
accuracy train: 0.778716 val: 0.753283 test: 0.754080
max validation accuracy : 0.753283 max acc epoch : 1 test accuracy : 0.754080
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.34944939613342 Time :  524
accuracy train: 0.793942 val: 0.758912 test: 0.768993
max validation accuracy : 0.758912 max acc epoch : 2 test accuracy : 0.768993
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  80.18933576345444 Time :  534
accuracy train: 0.810328 val: 0.768293 test: 0.779966
max validation accuracy : 0.768293 max acc epoch : 3 test accuracy : 0.779966
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  74.9123166501522 Time :  544
accuracy train: 0.818603 val: 0.770169 test: 0.774057
max validation accuracy : 0.770169 max acc epoch : 4 test accuracy : 0.774057
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  73.94854879379272 Time :  553
accuracy train: 0.827541 val: 0.777674 test: 0.774620
max validation accuracy : 0.777674 max acc epoch : 5 test accuracy : 0.774620
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.2636871188879 Time :  563
accuracy train: 0.834492 val: 0.772983 test: 0.774057
max validation accuracy : 0.777674 max acc epoch : 5 test accuracy : 0.774620
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.98322468996048 Time :  572
accuracy train: 0.832506 val: 0.760788 test: 0.773776
max validation accuracy : 0.777674 max acc epoch : 5 test accuracy : 0.774620
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.53846809267998 Time :  579
accuracy train: 0.853360 val: 0.772045 test: 0.777153
max validation accuracy : 0.777674 max acc epoch : 5 test accuracy : 0.774620
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  68.59895035624504 Time :  589
accuracy train: 0.858325 val: 0.772045 test: 0.775183
max validation accuracy : 0.777674 max acc epoch : 5 test accuracy : 0.774620
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  66.52441434562206 Time :  599
accuracy train: 0.857001 val: 0.775797 test: 0.777997
max validation accuracy : 0.777674 max acc epoch : 5 test accuracy : 0.774620

Epoch :  11 loss training:  65.60143002867699 Time :  609
accuracy train: 0.863787 val: 0.772045 test: 0.775464
max validation accuracy : 0.777674 max acc epoch : 5 test accuracy : 0.774620

Epoch :  12 loss training:  64.76066920161247 Time :  619
accuracy train: 0.867925 val: 0.770169 test: 0.779122
max validation accuracy : 0.777674 max acc epoch : 5 test accuracy : 0.774620

Epoch :  13 loss training:  63.39301760494709 Time :  628
accuracy train: 0.878683 val: 0.770169 test: 0.777153
max validation accuracy : 0.777674 max acc epoch : 5 test accuracy : 0.774620

Epoch :  14 loss training:  60.81129390001297 Time :  639
accuracy train: 0.883151 val: 0.767355 test: 0.776871
max validation accuracy : 0.777674 max acc epoch : 5 test accuracy : 0.774620

Epoch :  15 loss training:  59.242501467466354 Time :  648
accuracy train: 0.895233 val: 0.772045 test: 0.776590
max validation accuracy : 0.777674 max acc epoch : 5 test accuracy : 0.774620

Epoch :  16 loss training:  57.617934718728065 Time :  658
accuracy train: 0.900695 val: 0.777674 test: 0.775183
max validation accuracy : 0.777674 max acc epoch : 5 test accuracy : 0.774620

========================================================================================================================================================================================================
best acc epoch :  5
validation accuracy :  0.7776735459662288
test accuracy :  0.7746201463140123
last test_accuracy :  0.7751828925154756
second best val :  0.775797373358349
second best test :  0.7746201463140123
max gap 1
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=521, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.23732653260231 Time :  670
accuracy train: 0.780205 val: 0.777674 test: 0.767023
max validation accuracy : 0.777674 max acc epoch : 1 test accuracy : 0.767023
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  84.01733699440956 Time :  679
accuracy train: 0.794604 val: 0.764540 test: 0.777715
max validation accuracy : 0.777674 max acc epoch : 1 test accuracy : 0.767023
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.54498374462128 Time :  689
accuracy train: 0.810162 val: 0.772983 test: 0.781092
max validation accuracy : 0.777674 max acc epoch : 1 test accuracy : 0.767023
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.35655891895294 Time :  698
accuracy train: 0.816120 val: 0.775797 test: 0.776871
max validation accuracy : 0.777674 max acc epoch : 1 test accuracy : 0.767023
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  73.67473055422306 Time :  708
accuracy train: 0.819596 val: 0.778612 test: 0.776590
max validation accuracy : 0.778612 max acc epoch : 5 test accuracy : 0.776590
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  73.23636266589165 Time :  718
accuracy train: 0.827541 val: 0.781426 test: 0.777997
max validation accuracy : 0.781426 max acc epoch : 6 test accuracy : 0.777997
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  70.73258076608181 Time :  728
accuracy train: 0.834988 val: 0.790807 test: 0.780810
max validation accuracy : 0.790807 max acc epoch : 7 test accuracy : 0.780810
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.28907988965511 Time :  738
accuracy train: 0.843264 val: 0.786116 test: 0.777153
max validation accuracy : 0.790807 max acc epoch : 7 test accuracy : 0.780810
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  69.0504009872675 Time :  748
accuracy train: 0.845084 val: 0.782364 test: 0.779403
max validation accuracy : 0.790807 max acc epoch : 7 test accuracy : 0.780810
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  67.21301454305649 Time :  757
accuracy train: 0.854518 val: 0.778612 test: 0.778841
max validation accuracy : 0.790807 max acc epoch : 7 test accuracy : 0.780810

Epoch :  11 loss training:  66.95039434731007 Time :  766
accuracy train: 0.856835 val: 0.787054 test: 0.779122
max validation accuracy : 0.790807 max acc epoch : 7 test accuracy : 0.780810

Epoch :  12 loss training:  65.60440248250961 Time :  775
accuracy train: 0.865938 val: 0.788931 test: 0.781373
max validation accuracy : 0.790807 max acc epoch : 7 test accuracy : 0.780810

Epoch :  13 loss training:  63.27093328535557 Time :  786
accuracy train: 0.874710 val: 0.782364 test: 0.774620
max validation accuracy : 0.790807 max acc epoch : 7 test accuracy : 0.780810

Epoch :  14 loss training:  61.6679839938879 Time :  792
accuracy train: 0.886627 val: 0.784240 test: 0.772088
max validation accuracy : 0.790807 max acc epoch : 7 test accuracy : 0.780810

Epoch :  15 loss training:  59.62354199588299 Time :  799
accuracy train: 0.890765 val: 0.787992 test: 0.777434
max validation accuracy : 0.790807 max acc epoch : 7 test accuracy : 0.780810

Epoch :  16 loss training:  58.38749477267265 Time :  810
accuracy train: 0.898709 val: 0.785178 test: 0.772088
max validation accuracy : 0.790807 max acc epoch : 7 test accuracy : 0.780810

Epoch :  17 loss training:  56.487496092915535 Time :  820
accuracy train: 0.907646 val: 0.790807 test: 0.776308
max validation accuracy : 0.790807 max acc epoch : 7 test accuracy : 0.780810

Epoch :  18 loss training:  54.927515894174576 Time :  830
accuracy train: 0.914598 val: 0.790807 test: 0.775183
max validation accuracy : 0.790807 max acc epoch : 7 test accuracy : 0.780810

========================================================================================================================================================================================================
best acc epoch :  7
validation accuracy :  0.7908067542213884
test accuracy :  0.7808103545301069
last test_accuracy :  0.7751828925154756
second best val :  0.7889305816135085
second best test :  0.7808103545301069
max gap 4
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  8 	 val_accuracy : 0.78705 	 test_accuracy : 0.78081 	 last test_accuracy : 0.77462 	 second best val : 0.78518 	 second best test : 0.77856
k :  1 	 best_acc epoch :  21 	 val_accuracy : 0.78612 	 test_accuracy : 0.77406 	 last test_accuracy : 0.75971 	 second best val : 0.78236 	 second best test : 0.77406
k :  2 	 best_acc epoch :  5 	 val_accuracy : 0.77767 	 test_accuracy : 0.77462 	 last test_accuracy : 0.77518 	 second best val : 0.77580 	 second best test : 0.77462
k :  3 	 best_acc epoch :  7 	 val_accuracy : 0.79081 	 test_accuracy : 0.78081 	 last test_accuracy : 0.77518 	 second best val : 0.78893 	 second best test : 0.78081

avg :  	 val_accuracy : 0.78541 	 test_accuracy : 0.77757 	 last_accuracy : 0.77117 	 second best val : 0.78307 	 second best test : 0.77701

std :  	 val_accuracy : 0.00480 	 test_accuracy : 0.00324 	 last_accuracy : 0.00662 	 second best val : 0.00480 	 second best test : 0.00280


date and time :  Fri Jun 18 16:28:53 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=492, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.62969240546227 Time :  10
accuracy train: 0.781033 val: 0.754221 test: 0.768149
max validation accuracy : 0.754221 max acc epoch : 1 test accuracy : 0.768149
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.58598440885544 Time :  21
accuracy train: 0.792122 val: 0.758912 test: 0.770400
max validation accuracy : 0.758912 max acc epoch : 2 test accuracy : 0.770400
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  80.98638290166855 Time :  30
accuracy train: 0.797253 val: 0.738274 test: 0.764491
max validation accuracy : 0.758912 max acc epoch : 2 test accuracy : 0.770400
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  76.76647952198982 Time :  42
accuracy train: 0.815293 val: 0.766417 test: 0.777997
max validation accuracy : 0.766417 max acc epoch : 4 test accuracy : 0.777997
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  73.89498659968376 Time :  51
accuracy train: 0.821086 val: 0.760788 test: 0.775746
max validation accuracy : 0.766417 max acc epoch : 4 test accuracy : 0.777997
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  73.05713257193565 Time :  63
accuracy train: 0.818272 val: 0.772045 test: 0.780810
max validation accuracy : 0.772045 max acc epoch : 6 test accuracy : 0.780810
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  71.99358619749546 Time :  73
accuracy train: 0.833499 val: 0.761726 test: 0.777715
max validation accuracy : 0.772045 max acc epoch : 6 test accuracy : 0.780810
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  70.9174417257309 Time :  83
accuracy train: 0.834657 val: 0.757036 test: 0.775464
max validation accuracy : 0.772045 max acc epoch : 6 test accuracy : 0.780810
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  69.82226556539536 Time :  96
accuracy train: 0.836643 val: 0.764540 test: 0.772651
max validation accuracy : 0.772045 max acc epoch : 6 test accuracy : 0.780810
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  68.71321581304073 Time :  104
accuracy train: 0.839788 val: 0.766417 test: 0.773213
max validation accuracy : 0.772045 max acc epoch : 6 test accuracy : 0.780810

Epoch :  11 loss training:  68.48228624463081 Time :  115
accuracy train: 0.844257 val: 0.767355 test: 0.777997
max validation accuracy : 0.772045 max acc epoch : 6 test accuracy : 0.780810

Epoch :  12 loss training:  65.62212494015694 Time :  124
accuracy train: 0.857829 val: 0.762664 test: 0.777715
max validation accuracy : 0.772045 max acc epoch : 6 test accuracy : 0.780810

Epoch :  13 loss training:  65.0739938467741 Time :  133
accuracy train: 0.859815 val: 0.771107 test: 0.785312
max validation accuracy : 0.772045 max acc epoch : 6 test accuracy : 0.780810

Epoch :  14 loss training:  63.61796787381172 Time :  145
accuracy train: 0.867262 val: 0.768293 test: 0.780810
max validation accuracy : 0.772045 max acc epoch : 6 test accuracy : 0.780810

Epoch :  15 loss training:  62.1706936955452 Time :  154
accuracy train: 0.879179 val: 0.763602 test: 0.782217
max validation accuracy : 0.772045 max acc epoch : 6 test accuracy : 0.780810

Epoch :  16 loss training:  59.0909923017025 Time :  165
accuracy train: 0.882489 val: 0.773921 test: 0.780529
max validation accuracy : 0.773921 max acc epoch : 16 test accuracy : 0.780529

Epoch :  17 loss training:  58.25267107784748 Time :  174
accuracy train: 0.889275 val: 0.768293 test: 0.782499
max validation accuracy : 0.773921 max acc epoch : 16 test accuracy : 0.780529

Epoch :  18 loss training:  55.71136178076267 Time :  185
accuracy train: 0.898213 val: 0.768293 test: 0.781092
max validation accuracy : 0.773921 max acc epoch : 16 test accuracy : 0.780529

Epoch :  19 loss training:  53.56983380019665 Time :  196
accuracy train: 0.905164 val: 0.769231 test: 0.780810
max validation accuracy : 0.773921 max acc epoch : 16 test accuracy : 0.780529

Epoch :  20 loss training:  53.357391968369484 Time :  205
accuracy train: 0.910626 val: 0.765478 test: 0.778841
max validation accuracy : 0.773921 max acc epoch : 16 test accuracy : 0.780529

Epoch :  21 loss training:  51.42653477191925 Time :  216
accuracy train: 0.918073 val: 0.764540 test: 0.779685
max validation accuracy : 0.773921 max acc epoch : 16 test accuracy : 0.780529

Epoch :  22 loss training:  47.94456699490547 Time :  225
accuracy train: 0.924032 val: 0.761726 test: 0.779685
max validation accuracy : 0.773921 max acc epoch : 16 test accuracy : 0.780529

Epoch :  23 loss training:  49.034032344818115 Time :  235
accuracy train: 0.926183 val: 0.763602 test: 0.774057
max validation accuracy : 0.773921 max acc epoch : 16 test accuracy : 0.780529

Epoch :  24 loss training:  46.51439443230629 Time :  246
accuracy train: 0.931976 val: 0.760788 test: 0.776871
max validation accuracy : 0.773921 max acc epoch : 16 test accuracy : 0.780529

Epoch :  25 loss training:  45.72115508466959 Time :  256
accuracy train: 0.943893 val: 0.760788 test: 0.777997
max validation accuracy : 0.773921 max acc epoch : 16 test accuracy : 0.780529

Epoch :  26 loss training:  43.09622175246477 Time :  265
accuracy train: 0.947699 val: 0.759850 test: 0.777997
max validation accuracy : 0.773921 max acc epoch : 16 test accuracy : 0.780529

Epoch :  27 loss training:  39.82882661372423 Time :  272
accuracy train: 0.952665 val: 0.762664 test: 0.776871
max validation accuracy : 0.773921 max acc epoch : 16 test accuracy : 0.780529

========================================================================================================================================================================================================
best acc epoch :  16
validation accuracy :  0.773921200750469
test accuracy :  0.7805289814293753
last test_accuracy :  0.7768711311198649
second best val :  0.7720450281425891
second best test :  0.7808103545301069
max gap 10
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=150, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  92.19116839766502 Time :  279
accuracy train: 0.764813 val: 0.760788 test: 0.753517
max validation accuracy : 0.760788 max acc epoch : 1 test accuracy : 0.753517
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  84.1028490960598 Time :  290
accuracy train: 0.797418 val: 0.773921 test: 0.775464
max validation accuracy : 0.773921 max acc epoch : 2 test accuracy : 0.775464
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  80.23453283309937 Time :  299
accuracy train: 0.797915 val: 0.765478 test: 0.770400
max validation accuracy : 0.773921 max acc epoch : 2 test accuracy : 0.775464
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.59443333745003 Time :  309
accuracy train: 0.816452 val: 0.757974 test: 0.774339
max validation accuracy : 0.773921 max acc epoch : 2 test accuracy : 0.775464
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  75.37730413675308 Time :  319
accuracy train: 0.812810 val: 0.751407 test: 0.771806
max validation accuracy : 0.773921 max acc epoch : 2 test accuracy : 0.775464
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  73.49434417486191 Time :  329
accuracy train: 0.819927 val: 0.781426 test: 0.768711
max validation accuracy : 0.781426 max acc epoch : 6 test accuracy : 0.768711
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  71.58371244370937 Time :  340
accuracy train: 0.834326 val: 0.765478 test: 0.775746
max validation accuracy : 0.781426 max acc epoch : 6 test accuracy : 0.768711
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.6444799900055 Time :  350
accuracy train: 0.837140 val: 0.761726 test: 0.775746
max validation accuracy : 0.781426 max acc epoch : 6 test accuracy : 0.768711
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  68.68816238641739 Time :  361
accuracy train: 0.840450 val: 0.762664 test: 0.777434
max validation accuracy : 0.781426 max acc epoch : 6 test accuracy : 0.768711
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  69.22733168303967 Time :  370
accuracy train: 0.843098 val: 0.760788 test: 0.776590
max validation accuracy : 0.781426 max acc epoch : 6 test accuracy : 0.768711

Epoch :  11 loss training:  67.63578097522259 Time :  381
accuracy train: 0.847898 val: 0.773921 test: 0.777153
max validation accuracy : 0.781426 max acc epoch : 6 test accuracy : 0.768711

Epoch :  12 loss training:  65.44004388153553 Time :  391
accuracy train: 0.856008 val: 0.772045 test: 0.776027
max validation accuracy : 0.781426 max acc epoch : 6 test accuracy : 0.768711

Epoch :  13 loss training:  64.76919278502464 Time :  401
accuracy train: 0.862463 val: 0.775797 test: 0.776871
max validation accuracy : 0.781426 max acc epoch : 6 test accuracy : 0.768711

Epoch :  14 loss training:  62.59055222570896 Time :  412
accuracy train: 0.868421 val: 0.776735 test: 0.772932
max validation accuracy : 0.781426 max acc epoch : 6 test accuracy : 0.768711

Epoch :  15 loss training:  61.00058323144913 Time :  422
accuracy train: 0.876531 val: 0.772045 test: 0.777997
max validation accuracy : 0.781426 max acc epoch : 6 test accuracy : 0.768711

Epoch :  16 loss training:  59.472441390156746 Time :  432
accuracy train: 0.882655 val: 0.772045 test: 0.774620
max validation accuracy : 0.781426 max acc epoch : 6 test accuracy : 0.768711

Epoch :  17 loss training:  58.22747106850147 Time :  441
accuracy train: 0.890268 val: 0.776735 test: 0.772651
max validation accuracy : 0.781426 max acc epoch : 6 test accuracy : 0.768711

========================================================================================================================================================================================================
best acc epoch :  6
validation accuracy :  0.7814258911819888
test accuracy :  0.7687113111986494
last test_accuracy :  0.7726505346088914
second best val :  0.776735459662289
second best test :  0.7687113111986494
max gap 4
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=711, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  92.90038174390793 Time :  452
accuracy train: 0.767296 val: 0.764540 test: 0.758582
max validation accuracy : 0.764540 max acc epoch : 1 test accuracy : 0.758582
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  82.992007791996 Time :  461
accuracy train: 0.784177 val: 0.763602 test: 0.769555
max validation accuracy : 0.764540 max acc epoch : 1 test accuracy : 0.758582
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  81.70680996775627 Time :  470
accuracy train: 0.803045 val: 0.782364 test: 0.775183
max validation accuracy : 0.782364 max acc epoch : 3 test accuracy : 0.775183
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  76.94891786575317 Time :  476
accuracy train: 0.808838 val: 0.778612 test: 0.775746
max validation accuracy : 0.782364 max acc epoch : 3 test accuracy : 0.775183
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  74.85140649974346 Time :  482
accuracy train: 0.817279 val: 0.786116 test: 0.773495
max validation accuracy : 0.786116 max acc epoch : 5 test accuracy : 0.773495
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  74.83208626508713 Time :  491
accuracy train: 0.809997 val: 0.768293 test: 0.765053
max validation accuracy : 0.786116 max acc epoch : 5 test accuracy : 0.773495
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  73.29023671150208 Time :  500
accuracy train: 0.828037 val: 0.776735 test: 0.776871
max validation accuracy : 0.786116 max acc epoch : 5 test accuracy : 0.773495
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  71.27218928933144 Time :  510
accuracy train: 0.831513 val: 0.779550 test: 0.776871
max validation accuracy : 0.786116 max acc epoch : 5 test accuracy : 0.773495
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  70.4798247218132 Time :  519
accuracy train: 0.836312 val: 0.783302 test: 0.776871
max validation accuracy : 0.786116 max acc epoch : 5 test accuracy : 0.773495
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  69.99730668962002 Time :  528
accuracy train: 0.841443 val: 0.781426 test: 0.774339
max validation accuracy : 0.786116 max acc epoch : 5 test accuracy : 0.773495

Epoch :  11 loss training:  68.57975824177265 Time :  538
accuracy train: 0.845746 val: 0.780488 test: 0.777434
max validation accuracy : 0.786116 max acc epoch : 5 test accuracy : 0.773495

Epoch :  12 loss training:  67.91963975131512 Time :  548
accuracy train: 0.854849 val: 0.786116 test: 0.776871
max validation accuracy : 0.786116 max acc epoch : 5 test accuracy : 0.773495

Epoch :  13 loss training:  66.65312154591084 Time :  558
accuracy train: 0.861635 val: 0.791745 test: 0.778841
max validation accuracy : 0.791745 max acc epoch : 13 test accuracy : 0.778841

Epoch :  14 loss training:  64.50762569904327 Time :  567
accuracy train: 0.867097 val: 0.782364 test: 0.782499
max validation accuracy : 0.791745 max acc epoch : 13 test accuracy : 0.778841

Epoch :  15 loss training:  62.1531892567873 Time :  578
accuracy train: 0.872890 val: 0.787054 test: 0.778559
max validation accuracy : 0.791745 max acc epoch : 13 test accuracy : 0.778841

Epoch :  16 loss training:  60.9955732524395 Time :  587
accuracy train: 0.880503 val: 0.787054 test: 0.779403
max validation accuracy : 0.791745 max acc epoch : 13 test accuracy : 0.778841

Epoch :  17 loss training:  59.479110300540924 Time :  597
accuracy train: 0.888448 val: 0.791745 test: 0.781092
max validation accuracy : 0.791745 max acc epoch : 13 test accuracy : 0.778841

Epoch :  18 loss training:  58.889581486582756 Time :  607
accuracy train: 0.895399 val: 0.788931 test: 0.781373
max validation accuracy : 0.791745 max acc epoch : 13 test accuracy : 0.778841

Epoch :  19 loss training:  57.19672890007496 Time :  617
accuracy train: 0.902019 val: 0.788931 test: 0.781373
max validation accuracy : 0.791745 max acc epoch : 13 test accuracy : 0.778841

Epoch :  20 loss training:  54.47054520249367 Time :  626
accuracy train: 0.906322 val: 0.792683 test: 0.776871
max validation accuracy : 0.792683 max acc epoch : 20 test accuracy : 0.776871

Epoch :  21 loss training:  52.93027561903 Time :  636
accuracy train: 0.912943 val: 0.792683 test: 0.779122
max validation accuracy : 0.792683 max acc epoch : 20 test accuracy : 0.776871

Epoch :  22 loss training:  51.016206830739975 Time :  647
accuracy train: 0.919232 val: 0.787992 test: 0.773776
max validation accuracy : 0.792683 max acc epoch : 20 test accuracy : 0.776871

Epoch :  23 loss training:  50.3443555906415 Time :  657
accuracy train: 0.921715 val: 0.787992 test: 0.776027
max validation accuracy : 0.792683 max acc epoch : 20 test accuracy : 0.776871

Epoch :  24 loss training:  47.626331090927124 Time :  666
accuracy train: 0.925521 val: 0.787992 test: 0.775464
max validation accuracy : 0.792683 max acc epoch : 20 test accuracy : 0.776871

Epoch :  25 loss training:  46.87229745835066 Time :  675
accuracy train: 0.931480 val: 0.788931 test: 0.767867
max validation accuracy : 0.792683 max acc epoch : 20 test accuracy : 0.776871

Epoch :  26 loss training:  44.998847007751465 Time :  681
accuracy train: 0.937107 val: 0.782364 test: 0.770118
max validation accuracy : 0.792683 max acc epoch : 20 test accuracy : 0.776871

Epoch :  27 loss training:  42.89311786741018 Time :  687
accuracy train: 0.943727 val: 0.783302 test: 0.773776
max validation accuracy : 0.792683 max acc epoch : 20 test accuracy : 0.776871

Epoch :  28 loss training:  40.96081700921059 Time :  697
accuracy train: 0.945713 val: 0.784240 test: 0.771244
max validation accuracy : 0.792683 max acc epoch : 20 test accuracy : 0.776871

Epoch :  29 loss training:  39.84345082938671 Time :  706
accuracy train: 0.952665 val: 0.784240 test: 0.777434
max validation accuracy : 0.792683 max acc epoch : 20 test accuracy : 0.776871

Epoch :  30 loss training:  39.697070844471455 Time :  716
accuracy train: 0.957299 val: 0.800188 test: 0.774339
max validation accuracy : 0.800188 max acc epoch : 30 test accuracy : 0.774339

Epoch :  31 loss training:  35.516707465052605 Time :  725
accuracy train: 0.960609 val: 0.796435 test: 0.772651
max validation accuracy : 0.800188 max acc epoch : 30 test accuracy : 0.774339

Epoch :  32 loss training:  36.00293551385403 Time :  735
accuracy train: 0.967064 val: 0.791745 test: 0.769555
max validation accuracy : 0.800188 max acc epoch : 30 test accuracy : 0.774339

Epoch :  33 loss training:  34.810857117176056 Time :  744
accuracy train: 0.967395 val: 0.793621 test: 0.772369
max validation accuracy : 0.800188 max acc epoch : 30 test accuracy : 0.774339

Epoch :  34 loss training:  32.19569708779454 Time :  753
accuracy train: 0.973850 val: 0.791745 test: 0.767023
max validation accuracy : 0.800188 max acc epoch : 30 test accuracy : 0.774339

Epoch :  35 loss training:  31.61042296886444 Time :  763
accuracy train: 0.973850 val: 0.789869 test: 0.771525
max validation accuracy : 0.800188 max acc epoch : 30 test accuracy : 0.774339

Epoch :  36 loss training:  30.47875326499343 Time :  772
accuracy train: 0.978318 val: 0.800188 test: 0.771806
max validation accuracy : 0.800188 max acc epoch : 30 test accuracy : 0.774339

Epoch :  37 loss training:  30.468194149434566 Time :  780
accuracy train: 0.983615 val: 0.792683 test: 0.767304
max validation accuracy : 0.800188 max acc epoch : 30 test accuracy : 0.774339

Epoch :  38 loss training:  27.45878717675805 Time :  786
accuracy train: 0.983449 val: 0.795497 test: 0.776308
max validation accuracy : 0.800188 max acc epoch : 30 test accuracy : 0.774339

Epoch :  39 loss training:  27.662401374429464 Time :  792
accuracy train: 0.984608 val: 0.792683 test: 0.768993
max validation accuracy : 0.800188 max acc epoch : 30 test accuracy : 0.774339

Epoch :  40 loss training:  26.93523266352713 Time :  803
accuracy train: 0.987090 val: 0.794559 test: 0.762240
max validation accuracy : 0.800188 max acc epoch : 30 test accuracy : 0.774339

Epoch :  41 loss training:  24.55810683593154 Time :  814
accuracy train: 0.990401 val: 0.793621 test: 0.763647
max validation accuracy : 0.800188 max acc epoch : 30 test accuracy : 0.774339

========================================================================================================================================================================================================
best acc epoch :  30
validation accuracy :  0.800187617260788
test accuracy :  0.7743387732132808
last test_accuracy :  0.7636465953854812
second best val :  0.7964352720450282
second best test :  0.7743387732132808
max gap 10
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=422, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  92.05182409286499 Time :  825
accuracy train: 0.780867 val: 0.748593 test: 0.767867
max validation accuracy : 0.748593 max acc epoch : 1 test accuracy : 0.767867
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.40914303064346 Time :  834
accuracy train: 0.792949 val: 0.757036 test: 0.768993
max validation accuracy : 0.757036 max acc epoch : 2 test accuracy : 0.768993
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  80.41628506779671 Time :  844
accuracy train: 0.797418 val: 0.750469 test: 0.766460
max validation accuracy : 0.757036 max acc epoch : 2 test accuracy : 0.768993
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.53104561567307 Time :  853
accuracy train: 0.816617 val: 0.762664 test: 0.777997
max validation accuracy : 0.762664 max acc epoch : 4 test accuracy : 0.777997
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  74.09914995729923 Time :  864
accuracy train: 0.825720 val: 0.760788 test: 0.773495
max validation accuracy : 0.762664 max acc epoch : 4 test accuracy : 0.777997
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  73.939658254385 Time :  873
accuracy train: 0.824561 val: 0.760788 test: 0.772651
max validation accuracy : 0.762664 max acc epoch : 4 test accuracy : 0.777997
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  71.41094006597996 Time :  882
accuracy train: 0.836809 val: 0.763602 test: 0.771244
max validation accuracy : 0.763602 max acc epoch : 7 test accuracy : 0.771244
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.9702437967062 Time :  889
accuracy train: 0.842271 val: 0.757974 test: 0.773213
max validation accuracy : 0.763602 max acc epoch : 7 test accuracy : 0.771244
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  68.89076887071133 Time :  900
accuracy train: 0.836312 val: 0.759850 test: 0.770962
max validation accuracy : 0.763602 max acc epoch : 7 test accuracy : 0.771244
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  67.15316896140575 Time :  910
accuracy train: 0.848229 val: 0.753283 test: 0.775464
max validation accuracy : 0.763602 max acc epoch : 7 test accuracy : 0.771244

Epoch :  11 loss training:  68.57710787653923 Time :  921
accuracy train: 0.853360 val: 0.754221 test: 0.774339
max validation accuracy : 0.763602 max acc epoch : 7 test accuracy : 0.771244

Epoch :  12 loss training:  64.87367260456085 Time :  930
accuracy train: 0.857994 val: 0.751407 test: 0.776027
max validation accuracy : 0.763602 max acc epoch : 7 test accuracy : 0.771244

Epoch :  13 loss training:  63.91750104725361 Time :  941
accuracy train: 0.865938 val: 0.758912 test: 0.777153
max validation accuracy : 0.763602 max acc epoch : 7 test accuracy : 0.771244

Epoch :  14 loss training:  63.0462034791708 Time :  950
accuracy train: 0.873552 val: 0.753283 test: 0.777715
max validation accuracy : 0.763602 max acc epoch : 7 test accuracy : 0.771244

Epoch :  15 loss training:  60.64044551551342 Time :  959
accuracy train: 0.879014 val: 0.757974 test: 0.775183
max validation accuracy : 0.763602 max acc epoch : 7 test accuracy : 0.771244

Epoch :  16 loss training:  60.42746840417385 Time :  966
accuracy train: 0.885965 val: 0.754221 test: 0.778278
max validation accuracy : 0.763602 max acc epoch : 7 test accuracy : 0.771244

Epoch :  17 loss training:  58.36799447238445 Time :  972
accuracy train: 0.893413 val: 0.760788 test: 0.775183
max validation accuracy : 0.763602 max acc epoch : 7 test accuracy : 0.771244

Epoch :  18 loss training:  56.053596168756485 Time :  980
accuracy train: 0.896723 val: 0.763602 test: 0.773213
max validation accuracy : 0.763602 max acc epoch : 7 test accuracy : 0.771244

========================================================================================================================================================================================================
best acc epoch :  7
validation accuracy :  0.7636022514071295
test accuracy :  0.7712436691052336
last test_accuracy :  0.7732132808103546
second best val :  0.7626641651031895
second best test :  0.7779966235227912
max gap 3
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  16 	 val_accuracy : 0.77392 	 test_accuracy : 0.78053 	 last test_accuracy : 0.77687 	 second best val : 0.77205 	 second best test : 0.78081
k :  1 	 best_acc epoch :  6 	 val_accuracy : 0.78143 	 test_accuracy : 0.76871 	 last test_accuracy : 0.77265 	 second best val : 0.77674 	 second best test : 0.76871
k :  2 	 best_acc epoch :  30 	 val_accuracy : 0.80019 	 test_accuracy : 0.77434 	 last test_accuracy : 0.76365 	 second best val : 0.79644 	 second best test : 0.77434
k :  3 	 best_acc epoch :  7 	 val_accuracy : 0.76360 	 test_accuracy : 0.77124 	 last test_accuracy : 0.77321 	 second best val : 0.76266 	 second best test : 0.77800

avg :  	 val_accuracy : 0.77978 	 test_accuracy : 0.77371 	 last_accuracy : 0.77160 	 second best val : 0.77697 	 second best test : 0.77546

std :  	 val_accuracy : 0.01337 	 test_accuracy : 0.00441 	 last_accuracy : 0.00487 	 second best val : 0.01233 	 second best test : 0.00452


date and time :  Fri Jun 18 16:45:23 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=238, tsne=True, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 6212, 0: 4450})

Epoch :  1 loss training:  92.31750398874283 Time :  13
accuracy train: 0.775240 val: 0.787054 test: 0.758019
max validation accuracy : 0.787054 max acc epoch : 1 test accuracy : 0.758019
Counter({1: 6048, 0: 4614})
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  85.42273843288422 Time :  27
accuracy train: 0.788812 val: 0.782364 test: 0.771244
max validation accuracy : 0.787054 max acc epoch : 1 test accuracy : 0.758019
Counter({0: 5852, 1: 4810})
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  80.08802524209023 Time :  45
accuracy train: 0.794604 val: 0.791745 test: 0.766742
max validation accuracy : 0.791745 max acc epoch : 3 test accuracy : 0.766742
Counter({1: 5725, 0: 4937})
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.9290729612112 Time :  58
accuracy train: 0.806852 val: 0.781426 test: 0.766460
max validation accuracy : 0.791745 max acc epoch : 3 test accuracy : 0.766742
Counter({0: 5847, 1: 4815})
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  74.98133279383183 Time :  71
accuracy train: 0.812314 val: 0.787054 test: 0.767023
max validation accuracy : 0.791745 max acc epoch : 3 test accuracy : 0.766742
Counter({0: 5838, 1: 4824})
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  73.5697445422411 Time :  84
accuracy train: 0.822906 val: 0.773921 test: 0.766460
max validation accuracy : 0.791745 max acc epoch : 3 test accuracy : 0.766742
Counter({1: 5846, 0: 4816})
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  72.32371413707733 Time :  96
accuracy train: 0.823568 val: 0.788931 test: 0.765053
max validation accuracy : 0.791745 max acc epoch : 3 test accuracy : 0.766742
Counter({1: 5837, 0: 4825})
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  71.38265623152256 Time :  110
accuracy train: 0.828037 val: 0.780488 test: 0.763365
max validation accuracy : 0.791745 max acc epoch : 3 test accuracy : 0.766742
Counter({1: 5960, 0: 4702})
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  69.89750783145428 Time :  123
accuracy train: 0.832506 val: 0.787992 test: 0.764491
max validation accuracy : 0.791745 max acc epoch : 3 test accuracy : 0.766742
Counter({1: 5996, 0: 4666})
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  68.62512965500355 Time :  140
accuracy train: 0.835485 val: 0.784240 test: 0.765616
max validation accuracy : 0.791745 max acc epoch : 3 test accuracy : 0.766742
Counter({0: 6005, 1: 4657})

Epoch :  11 loss training:  69.77149763703346 Time :  154
accuracy train: 0.839623 val: 0.792683 test: 0.765898
max validation accuracy : 0.792683 max acc epoch : 11 test accuracy : 0.765898
Counter({1: 6018, 0: 4644})

Epoch :  12 loss training:  66.87263886630535 Time :  170
accuracy train: 0.846574 val: 0.784240 test: 0.767023
max validation accuracy : 0.792683 max acc epoch : 11 test accuracy : 0.765898
Counter({1: 6035, 0: 4627})

Epoch :  13 loss training:  65.30396611988544 Time :  184
accuracy train: 0.852698 val: 0.787054 test: 0.765335
max validation accuracy : 0.792683 max acc epoch : 11 test accuracy : 0.765898
Counter({0: 5993, 1: 4669})

Epoch :  14 loss training:  63.46982215344906 Time :  197
accuracy train: 0.857663 val: 0.784240 test: 0.767023
max validation accuracy : 0.792683 max acc epoch : 11 test accuracy : 0.765898
Counter({0: 6078, 1: 4584})

Epoch :  15 loss training:  61.63938485085964 Time :  217
accuracy train: 0.863621 val: 0.789869 test: 0.767304
max validation accuracy : 0.792683 max acc epoch : 11 test accuracy : 0.765898
Counter({1: 6076, 0: 4586})

Epoch :  16 loss training:  59.85199527442455 Time :  231
accuracy train: 0.870076 val: 0.793621 test: 0.767304
max validation accuracy : 0.793621 max acc epoch : 16 test accuracy : 0.767304
Counter({1: 6096, 0: 4566})

Epoch :  17 loss training:  59.823140263557434 Time :  244
accuracy train: 0.876862 val: 0.789869 test: 0.764491
max validation accuracy : 0.793621 max acc epoch : 16 test accuracy : 0.767304
Counter({1: 6140, 0: 4522})

Epoch :  18 loss training:  57.21254609525204 Time :  258
accuracy train: 0.888779 val: 0.786116 test: 0.763928
max validation accuracy : 0.793621 max acc epoch : 16 test accuracy : 0.767304
Counter({1: 6142, 0: 4520})

Epoch :  19 loss training:  55.368848368525505 Time :  270
accuracy train: 0.894075 val: 0.785178 test: 0.762240
max validation accuracy : 0.793621 max acc epoch : 16 test accuracy : 0.767304
Counter({1: 6143, 0: 4519})

Epoch :  20 loss training:  53.09335105121136 Time :  284
accuracy train: 0.907977 val: 0.785178 test: 0.763365
max validation accuracy : 0.793621 max acc epoch : 16 test accuracy : 0.767304
Counter({0: 6145, 1: 4517})

Epoch :  21 loss training:  51.955302730202675 Time :  298
accuracy train: 0.910626 val: 0.793621 test: 0.764209
max validation accuracy : 0.793621 max acc epoch : 16 test accuracy : 0.767304
Counter({1: 6173, 0: 4489})

Epoch :  22 loss training:  49.77409490942955 Time :  312
accuracy train: 0.915260 val: 0.791745 test: 0.764772
max validation accuracy : 0.793621 max acc epoch : 16 test accuracy : 0.767304
Counter({0: 6145, 1: 4517})

Epoch :  23 loss training:  47.30513487756252 Time :  327
accuracy train: 0.923370 val: 0.787992 test: 0.769274
max validation accuracy : 0.793621 max acc epoch : 16 test accuracy : 0.767304
Counter({0: 6125, 1: 4537})

Epoch :  24 loss training:  46.53317892551422 Time :  340
accuracy train: 0.930652 val: 0.787992 test: 0.763647
max validation accuracy : 0.793621 max acc epoch : 16 test accuracy : 0.767304
Counter({1: 6145, 0: 4517})

Epoch :  25 loss training:  44.50436408817768 Time :  355
accuracy train: 0.938100 val: 0.785178 test: 0.765898
max validation accuracy : 0.793621 max acc epoch : 16 test accuracy : 0.767304
Counter({1: 6144, 0: 4518})

Epoch :  26 loss training:  42.27912037074566 Time :  367
accuracy train: 0.937438 val: 0.792683 test: 0.767586
max validation accuracy : 0.793621 max acc epoch : 16 test accuracy : 0.767304
Counter({0: 6118, 1: 4544})

Epoch :  27 loss training:  40.181874111294746 Time :  383
accuracy train: 0.942238 val: 0.789869 test: 0.768430
max validation accuracy : 0.793621 max acc epoch : 16 test accuracy : 0.767304
Counter({1: 6186, 0: 4476})

========================================================================================================================================================================================================
best acc epoch :  16
validation accuracy :  0.7936210131332082
test accuracy :  0.7673044456949916
last test_accuracy :  0.7684299380979178
second best val :  0.7926829268292683
second best test :  0.7658975801913337
max gap 8
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=124, tsne=True, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 6179, 0: 4483})

Epoch :  1 loss training:  91.19888672232628 Time :  469
accuracy train: 0.775571 val: 0.760788 test: 0.762240
max validation accuracy : 0.760788 max acc epoch : 1 test accuracy : 0.762240
Counter({0: 5909, 1: 4753})
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  82.895252764225 Time :  491
accuracy train: 0.790963 val: 0.757974 test: 0.778278
max validation accuracy : 0.760788 max acc epoch : 1 test accuracy : 0.762240
Counter({1: 5972, 0: 4690})
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  78.86366298794746 Time :  505
accuracy train: 0.805362 val: 0.766417 test: 0.779403
max validation accuracy : 0.766417 max acc epoch : 3 test accuracy : 0.779403
Counter({1: 5973, 0: 4689})
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  74.86500985920429 Time :  519
accuracy train: 0.806521 val: 0.763602 test: 0.768149
max validation accuracy : 0.766417 max acc epoch : 3 test accuracy : 0.779403
Counter({0: 5967, 1: 4695})
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  73.53797520697117 Time :  533
accuracy train: 0.817610 val: 0.765478 test: 0.773495
max validation accuracy : 0.766417 max acc epoch : 3 test accuracy : 0.779403
Counter({0: 5982, 1: 4680})
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  73.50956605374813 Time :  547
accuracy train: 0.820755 val: 0.762664 test: 0.780810
max validation accuracy : 0.766417 max acc epoch : 3 test accuracy : 0.779403
Counter({1: 6059, 0: 4603})
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  70.11690840125084 Time :  563
accuracy train: 0.824561 val: 0.756098 test: 0.782217
max validation accuracy : 0.766417 max acc epoch : 3 test accuracy : 0.779403
Counter({0: 6118, 1: 4544})
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.53807979822159 Time :  577
accuracy train: 0.833168 val: 0.768293 test: 0.780529
max validation accuracy : 0.768293 max acc epoch : 8 test accuracy : 0.780529
Counter({1: 6167, 0: 4495})
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  68.695735886693 Time :  590
accuracy train: 0.835485 val: 0.761726 test: 0.783905
max validation accuracy : 0.768293 max acc epoch : 8 test accuracy : 0.780529
Counter({0: 6155, 1: 4507})
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  67.75571793317795 Time :  603
accuracy train: 0.837471 val: 0.768293 test: 0.781654
max validation accuracy : 0.768293 max acc epoch : 8 test accuracy : 0.780529
Counter({1: 6161, 0: 4501})

Epoch :  11 loss training:  67.03708823025227 Time :  616
accuracy train: 0.842602 val: 0.765478 test: 0.783624
max validation accuracy : 0.768293 max acc epoch : 8 test accuracy : 0.780529
Counter({0: 6152, 1: 4510})

Epoch :  12 loss training:  65.24447052180767 Time :  637
accuracy train: 0.845250 val: 0.769231 test: 0.783905
max validation accuracy : 0.769231 max acc epoch : 12 test accuracy : 0.783905
Counter({0: 6170, 1: 4492})

Epoch :  13 loss training:  64.25503933429718 Time :  651
accuracy train: 0.854022 val: 0.766417 test: 0.785312
max validation accuracy : 0.769231 max acc epoch : 12 test accuracy : 0.783905
Counter({0: 6184, 1: 4478})

Epoch :  14 loss training:  62.23694349825382 Time :  664
accuracy train: 0.855842 val: 0.761726 test: 0.784187
max validation accuracy : 0.769231 max acc epoch : 12 test accuracy : 0.783905
Counter({1: 6217, 0: 4445})

Epoch :  15 loss training:  61.614962205290794 Time :  679
accuracy train: 0.864118 val: 0.764540 test: 0.785031
max validation accuracy : 0.769231 max acc epoch : 12 test accuracy : 0.783905
Counter({1: 6230, 0: 4432})

Epoch :  16 loss training:  58.79736974835396 Time :  690
accuracy train: 0.873386 val: 0.766417 test: 0.785875
max validation accuracy : 0.769231 max acc epoch : 12 test accuracy : 0.783905
Counter({0: 6260, 1: 4402})

Epoch :  17 loss training:  57.71419847011566 Time :  708
accuracy train: 0.880172 val: 0.758912 test: 0.787563
max validation accuracy : 0.769231 max acc epoch : 12 test accuracy : 0.783905
Counter({1: 6273, 0: 4389})

Epoch :  18 loss training:  55.86982536315918 Time :  723
accuracy train: 0.886296 val: 0.768293 test: 0.783905
max validation accuracy : 0.769231 max acc epoch : 12 test accuracy : 0.783905
Counter({0: 6280, 1: 4382})

Epoch :  19 loss training:  54.187080308794975 Time :  735
accuracy train: 0.893744 val: 0.765478 test: 0.783343
max validation accuracy : 0.769231 max acc epoch : 12 test accuracy : 0.783905
Counter({1: 6275, 0: 4387})

Epoch :  20 loss training:  53.72120629251003 Time :  749
accuracy train: 0.899206 val: 0.758912 test: 0.783905
max validation accuracy : 0.769231 max acc epoch : 12 test accuracy : 0.783905
Counter({1: 6294, 0: 4368})

Epoch :  21 loss training:  50.19938760995865 Time :  762
accuracy train: 0.906322 val: 0.765478 test: 0.787001
max validation accuracy : 0.769231 max acc epoch : 12 test accuracy : 0.783905
Counter({0: 6330, 1: 4332})

Epoch :  22 loss training:  48.72939084470272 Time :  776
accuracy train: 0.913108 val: 0.765478 test: 0.783905
max validation accuracy : 0.769231 max acc epoch : 12 test accuracy : 0.783905
Counter({1: 6374, 0: 4288})

Epoch :  23 loss training:  48.209787994623184 Time :  791
accuracy train: 0.917742 val: 0.764540 test: 0.786719
max validation accuracy : 0.769231 max acc epoch : 12 test accuracy : 0.783905
Counter({0: 6401, 1: 4261})

========================================================================================================================================================================================================
best acc epoch :  12
validation accuracy :  0.7692307692307693
test accuracy :  0.7839054586381542
last test_accuracy :  0.7867191896454699
second best val :  0.7682926829268293
second best test :  0.7805289814293753
max gap 5
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=699, tsne=True, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 6218, 0: 4444})

Epoch :  1 loss training:  92.92851938307285 Time :  881
accuracy train: 0.758524 val: 0.758912 test: 0.752673
max validation accuracy : 0.758912 max acc epoch : 1 test accuracy : 0.752673
Counter({0: 5391, 1: 5271})
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  85.62219449877739 Time :  894
accuracy train: 0.783184 val: 0.771107 test: 0.764209
max validation accuracy : 0.771107 max acc epoch : 2 test accuracy : 0.764209
Counter({0: 5339, 1: 5323})
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  80.38394781947136 Time :  908
accuracy train: 0.799570 val: 0.776735 test: 0.770118
max validation accuracy : 0.776735 max acc epoch : 3 test accuracy : 0.770118
Counter({0: 5496, 1: 5166})
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  76.22335287928581 Time :  921
accuracy train: 0.800894 val: 0.775797 test: 0.776308
max validation accuracy : 0.776735 max acc epoch : 3 test accuracy : 0.770118
Counter({0: 5345, 1: 5317})
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  75.67034500837326 Time :  935
accuracy train: 0.813803 val: 0.779550 test: 0.766179
max validation accuracy : 0.779550 max acc epoch : 5 test accuracy : 0.766179
Counter({0: 5421, 1: 5241})
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  73.59878596663475 Time :  948
accuracy train: 0.812314 val: 0.777674 test: 0.769555
max validation accuracy : 0.779550 max acc epoch : 5 test accuracy : 0.766179
Counter({0: 5454, 1: 5208})
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  71.78242833912373 Time :  960
accuracy train: 0.816286 val: 0.779550 test: 0.774620
max validation accuracy : 0.779550 max acc epoch : 5 test accuracy : 0.766179
Counter({0: 5421, 1: 5241})
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  70.78529386222363 Time :  972
accuracy train: 0.822741 val: 0.779550 test: 0.769274
max validation accuracy : 0.779550 max acc epoch : 5 test accuracy : 0.766179
Counter({1: 5447, 0: 5215})
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  69.27758887410164 Time :  984
accuracy train: 0.826216 val: 0.778612 test: 0.772932
max validation accuracy : 0.779550 max acc epoch : 5 test accuracy : 0.766179
Counter({0: 5425, 1: 5237})
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  68.40900927782059 Time :  996
accuracy train: 0.827872 val: 0.774859 test: 0.770118
max validation accuracy : 0.779550 max acc epoch : 5 test accuracy : 0.766179
Counter({1: 5480, 0: 5182})

Epoch :  11 loss training:  68.15820442140102 Time :  1008
accuracy train: 0.830685 val: 0.779550 test: 0.767586
max validation accuracy : 0.779550 max acc epoch : 5 test accuracy : 0.766179
Counter({0: 5484, 1: 5178})

Epoch :  12 loss training:  67.75005806982517 Time :  1021
accuracy train: 0.843760 val: 0.783302 test: 0.770118
max validation accuracy : 0.783302 max acc epoch : 12 test accuracy : 0.770118
Counter({1: 5467, 0: 5195})

Epoch :  13 loss training:  65.53838576376438 Time :  1032
accuracy train: 0.846243 val: 0.784240 test: 0.773213
max validation accuracy : 0.784240 max acc epoch : 13 test accuracy : 0.773213
Counter({1: 5459, 0: 5203})

Epoch :  14 loss training:  63.588448479771614 Time :  1045
accuracy train: 0.850712 val: 0.786116 test: 0.770681
max validation accuracy : 0.786116 max acc epoch : 14 test accuracy : 0.770681
Counter({0: 5526, 1: 5136})

Epoch :  15 loss training:  61.95509585738182 Time :  1058
accuracy train: 0.865938 val: 0.781426 test: 0.770118
max validation accuracy : 0.786116 max acc epoch : 14 test accuracy : 0.770681
Counter({1: 5518, 0: 5144})

Epoch :  16 loss training:  60.339470863342285 Time :  1072
accuracy train: 0.864945 val: 0.784240 test: 0.779122
max validation accuracy : 0.786116 max acc epoch : 14 test accuracy : 0.770681
Counter({1: 5560, 0: 5102})

Epoch :  17 loss training:  59.98297627270222 Time :  1084
accuracy train: 0.880669 val: 0.785178 test: 0.774620
max validation accuracy : 0.786116 max acc epoch : 14 test accuracy : 0.770681
Counter({1: 5564, 0: 5098})

Epoch :  18 loss training:  56.13427881151438 Time :  1097
accuracy train: 0.888282 val: 0.790807 test: 0.772932
max validation accuracy : 0.790807 max acc epoch : 18 test accuracy : 0.772932
Counter({1: 5581, 0: 5081})

Epoch :  19 loss training:  54.945823684334755 Time :  1110
accuracy train: 0.888448 val: 0.790807 test: 0.777153
max validation accuracy : 0.790807 max acc epoch : 18 test accuracy : 0.772932
Counter({1: 5607, 0: 5055})

Epoch :  20 loss training:  53.31413218379021 Time :  1122
accuracy train: 0.903509 val: 0.790807 test: 0.777153
max validation accuracy : 0.790807 max acc epoch : 18 test accuracy : 0.772932
Counter({1: 5590, 0: 5072})

Epoch :  21 loss training:  50.61250248551369 Time :  1135
accuracy train: 0.903674 val: 0.786116 test: 0.780248
max validation accuracy : 0.790807 max acc epoch : 18 test accuracy : 0.772932
Counter({0: 5572, 1: 5090})

Epoch :  22 loss training:  50.146881476044655 Time :  1148
accuracy train: 0.909136 val: 0.791745 test: 0.778841
max validation accuracy : 0.791745 max acc epoch : 22 test accuracy : 0.778841
Counter({0: 5566, 1: 5096})

Epoch :  23 loss training:  47.6392372995615 Time :  1161
accuracy train: 0.920391 val: 0.788931 test: 0.778841
max validation accuracy : 0.791745 max acc epoch : 22 test accuracy : 0.778841
Counter({1: 5565, 0: 5097})

Epoch :  24 loss training:  45.57635860145092 Time :  1173
accuracy train: 0.925852 val: 0.798311 test: 0.780529
max validation accuracy : 0.798311 max acc epoch : 24 test accuracy : 0.780529
Counter({0: 5573, 1: 5089})

Epoch :  25 loss training:  44.494488187134266 Time :  1186
accuracy train: 0.932969 val: 0.803002 test: 0.779966
max validation accuracy : 0.803002 max acc epoch : 25 test accuracy : 0.779966
Counter({1: 5575, 0: 5087})

Epoch :  26 loss training:  41.79443021863699 Time :  1198
accuracy train: 0.939259 val: 0.803940 test: 0.777997
max validation accuracy : 0.803940 max acc epoch : 26 test accuracy : 0.777997
Counter({0: 5575, 1: 5087})

Epoch :  27 loss training:  41.91765332221985 Time :  1210
accuracy train: 0.941741 val: 0.797373 test: 0.780248
max validation accuracy : 0.803940 max acc epoch : 26 test accuracy : 0.777997
Counter({0: 5561, 1: 5101})

Epoch :  28 loss training:  38.81808361411095 Time :  1223
accuracy train: 0.948858 val: 0.794559 test: 0.776308
max validation accuracy : 0.803940 max acc epoch : 26 test accuracy : 0.777997
Counter({1: 5575, 0: 5087})

Epoch :  29 loss training:  37.56548134237528 Time :  1236
accuracy train: 0.953658 val: 0.793621 test: 0.777153
max validation accuracy : 0.803940 max acc epoch : 26 test accuracy : 0.777997
Counter({0: 5520, 1: 5142})

Epoch :  30 loss training:  37.06273465976119 Time :  1248
accuracy train: 0.956140 val: 0.784240 test: 0.775183
max validation accuracy : 0.803940 max acc epoch : 26 test accuracy : 0.777997
Counter({0: 5549, 1: 5113})

Epoch :  31 loss training:  35.662771835923195 Time :  1261
accuracy train: 0.958788 val: 0.793621 test: 0.780529
max validation accuracy : 0.803940 max acc epoch : 26 test accuracy : 0.777997
Counter({0: 5557, 1: 5105})

Epoch :  32 loss training:  32.6143753528595 Time :  1274
accuracy train: 0.965409 val: 0.790807 test: 0.773776
max validation accuracy : 0.803940 max acc epoch : 26 test accuracy : 0.777997
Counter({1: 5525, 0: 5137})

Epoch :  33 loss training:  32.663931254297495 Time :  1286
accuracy train: 0.966236 val: 0.794559 test: 0.776590
max validation accuracy : 0.803940 max acc epoch : 26 test accuracy : 0.777997
Counter({1: 5533, 0: 5129})

Epoch :  34 loss training:  30.302103858441114 Time :  1298
accuracy train: 0.972029 val: 0.793621 test: 0.775464
max validation accuracy : 0.803940 max acc epoch : 26 test accuracy : 0.777997
Counter({1: 5516, 0: 5146})

Epoch :  35 loss training:  29.70863599702716 Time :  1311
accuracy train: 0.974181 val: 0.783302 test: 0.775746
max validation accuracy : 0.803940 max acc epoch : 26 test accuracy : 0.777997
Counter({0: 5475, 1: 5187})

Epoch :  36 loss training:  27.7689450699836 Time :  1324
accuracy train: 0.976829 val: 0.793621 test: 0.775464
max validation accuracy : 0.803940 max acc epoch : 26 test accuracy : 0.777997
Counter({1: 5486, 0: 5176})

Epoch :  37 loss training:  27.685516480356455 Time :  1337
accuracy train: 0.980636 val: 0.791745 test: 0.775183
max validation accuracy : 0.803940 max acc epoch : 26 test accuracy : 0.777997
Counter({0: 5367, 1: 5295})

========================================================================================================================================================================================================
best acc epoch :  26
validation accuracy :  0.8039399624765479
test accuracy :  0.7779966235227912
last test_accuracy :  0.7751828925154756
second best val :  0.8030018761726079
second best test :  0.7799662352279122
max gap 7
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=898, tsne=True, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 6236, 0: 4426})

Epoch :  1 loss training:  91.67176941037178 Time :  1403
accuracy train: 0.769116 val: 0.768293 test: 0.768711
max validation accuracy : 0.768293 max acc epoch : 1 test accuracy : 0.768711
Counter({1: 6168, 0: 4494})
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  82.87437278032303 Time :  1416
accuracy train: 0.787653 val: 0.765478 test: 0.771244
max validation accuracy : 0.768293 max acc epoch : 1 test accuracy : 0.768711
Counter({0: 6134, 1: 4528})
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.47715322673321 Time :  1428
accuracy train: 0.800066 val: 0.766417 test: 0.774057
max validation accuracy : 0.768293 max acc epoch : 1 test accuracy : 0.768711
Counter({0: 6066, 1: 4596})
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.64545166492462 Time :  1440
accuracy train: 0.802218 val: 0.766417 test: 0.775183
max validation accuracy : 0.768293 max acc epoch : 1 test accuracy : 0.768711
Counter({1: 6082, 0: 4580})
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  73.86656659841537 Time :  1453
accuracy train: 0.810824 val: 0.764540 test: 0.767867
max validation accuracy : 0.768293 max acc epoch : 1 test accuracy : 0.768711
Counter({0: 6015, 1: 4647})
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.38989797234535 Time :  1463
accuracy train: 0.825058 val: 0.761726 test: 0.770400
max validation accuracy : 0.768293 max acc epoch : 1 test accuracy : 0.768711
Counter({0: 5981, 1: 4681})
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  70.15924866497517 Time :  1475
accuracy train: 0.828865 val: 0.760788 test: 0.772369
max validation accuracy : 0.768293 max acc epoch : 1 test accuracy : 0.768711
Counter({1: 6017, 0: 4645})
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.20025517046452 Time :  1487
accuracy train: 0.831844 val: 0.764540 test: 0.774339
max validation accuracy : 0.768293 max acc epoch : 1 test accuracy : 0.768711
Counter({0: 6037, 1: 4625})
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  68.56705893576145 Time :  1500
accuracy train: 0.833664 val: 0.767355 test: 0.772088
max validation accuracy : 0.768293 max acc epoch : 1 test accuracy : 0.768711
Counter({1: 6027, 0: 4635})
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  67.3048165589571 Time :  1512
accuracy train: 0.837471 val: 0.767355 test: 0.775183
max validation accuracy : 0.768293 max acc epoch : 1 test accuracy : 0.768711
Counter({1: 6061, 0: 4601})

Epoch :  11 loss training:  67.4245805889368 Time :  1525
accuracy train: 0.846574 val: 0.763602 test: 0.774339
max validation accuracy : 0.768293 max acc epoch : 1 test accuracy : 0.768711
Counter({0: 6032, 1: 4630})

Epoch :  12 loss training:  64.5569495856762 Time :  1537
accuracy train: 0.855180 val: 0.759850 test: 0.777434
max validation accuracy : 0.768293 max acc epoch : 1 test accuracy : 0.768711
Counter({0: 6045, 1: 4617})

========================================================================================================================================================================================================
best acc epoch :  1
validation accuracy :  0.7682926829268293
test accuracy :  0.7687113111986494
last test_accuracy :  0.7774338773213281
second best val :  0.7673545966228893
second best test :  0.7687113111986494
max gap 1
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  16 	 val_accuracy : 0.79362 	 test_accuracy : 0.76730 	 last test_accuracy : 0.76843 	 second best val : 0.79268 	 second best test : 0.76590
k :  1 	 best_acc epoch :  12 	 val_accuracy : 0.76923 	 test_accuracy : 0.78391 	 last test_accuracy : 0.78672 	 second best val : 0.76829 	 second best test : 0.78053
k :  2 	 best_acc epoch :  26 	 val_accuracy : 0.80394 	 test_accuracy : 0.77800 	 last test_accuracy : 0.77518 	 second best val : 0.80300 	 second best test : 0.77997
k :  3 	 best_acc epoch :  1 	 val_accuracy : 0.76829 	 test_accuracy : 0.76871 	 last test_accuracy : 0.77743 	 second best val : 0.76735 	 second best test : 0.76871

avg :  	 val_accuracy : 0.78377 	 test_accuracy : 0.77448 	 last_accuracy : 0.77694 	 second best val : 0.78283 	 second best test : 0.77378

std :  	 val_accuracy : 0.01545 	 test_accuracy : 0.00682 	 last_accuracy : 0.00655 	 second best val : 0.01545 	 second best test : 0.00655
