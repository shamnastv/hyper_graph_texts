

date and time :  Sat Jun  5 10:57:46 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=370, weight_decay=0)
device :  cuda:0
Counter({1: 4561, 0: 2839})

Epoch :  1 loss training:  211.78265398740768 Time :  39
accuracy train: 0.644606 val: 0.597015 test: 0.598318
max validation accuracy : 0.597015 max acc epoch : 1 test accuracy : 0.598318
Counter({0: 4787, 1: 2613})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  140.81017738580704 Time :  81
accuracy train: 0.715751 val: 0.653731 test: 0.632946
max validation accuracy : 0.653731 max acc epoch : 2 test accuracy : 0.632946
Counter({1: 4641, 0: 2759})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  120.98944157361984 Time :  112
accuracy train: 0.739576 val: 0.698507 test: 0.661885
max validation accuracy : 0.698507 max acc epoch : 3 test accuracy : 0.661885
Counter({0: 4446, 1: 2954})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.63189551234245 Time :  142
accuracy train: 0.797154 val: 0.695522 test: 0.697749
max validation accuracy : 0.698507 max acc epoch : 3 test accuracy : 0.661885
Counter({1: 4415, 0: 2985})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  90.34730607271194 Time :  182
accuracy train: 0.825281 val: 0.701493 test: 0.702449
max validation accuracy : 0.701493 max acc epoch : 5 test accuracy : 0.702449
Counter({0: 4331, 1: 3069})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.93535104393959 Time :  232
accuracy train: 0.826274 val: 0.704478 test: 0.696018
max validation accuracy : 0.704478 max acc epoch : 6 test accuracy : 0.696018
Counter({1: 4208, 0: 3192})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  72.30500242114067 Time :  267
accuracy train: 0.863336 val: 0.704478 test: 0.708138
max validation accuracy : 0.704478 max acc epoch : 6 test accuracy : 0.696018
Counter({0: 4241, 1: 3159})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.87664270401001 Time :  296
accuracy train: 0.871608 val: 0.698507 test: 0.709869
max validation accuracy : 0.704478 max acc epoch : 6 test accuracy : 0.696018
Counter({1: 4232, 0: 3168})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.74965241551399 Time :  323
accuracy train: 0.882859 val: 0.728358 test: 0.714816
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.714816
Counter({1: 4198, 0: 3202})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.20071570575237 Time :  350
accuracy train: 0.894441 val: 0.707463 test: 0.717536
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.714816
Counter({1: 4193, 0: 3207})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  57.98541660606861 Time :  389
accuracy train: 0.892124 val: 0.710448 test: 0.722978
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.714816
Counter({0: 4200, 1: 3200})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  55.760544538497925 Time :  418
accuracy train: 0.904037 val: 0.710448 test: 0.724215
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.714816
Counter({0: 4209, 1: 3191})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  53.50916586816311 Time :  451
accuracy train: 0.903044 val: 0.704478 test: 0.719021
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.714816
Counter({0: 4211, 1: 3189})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  53.58249431848526 Time :  483
accuracy train: 0.907677 val: 0.728358 test: 0.719515
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.714816
Counter({1: 4206, 0: 3194})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  51.59404644370079 Time :  521
accuracy train: 0.908339 val: 0.719403 test: 0.720999
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.714816
Counter({1: 4193, 0: 3207})
Epoch-15 lr: 3.125e-05

Epoch :  16 loss training:  52.30283297598362 Time :  559
accuracy train: 0.909993 val: 0.710448 test: 0.721494
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.714816
Counter({0: 4188, 1: 3212})
Epoch-16 lr: 3.125e-05

Epoch :  17 loss training:  50.35504362732172 Time :  593
accuracy train: 0.911979 val: 0.728358 test: 0.716052
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.714816
Counter({0: 4178, 1: 3222})
Epoch-17 lr: 3.125e-05

Epoch :  18 loss training:  49.604457661509514 Time :  630
accuracy train: 0.915288 val: 0.728358 test: 0.722731
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.714816
Counter({0: 4177, 1: 3223})
Epoch-18 lr: 1.5625e-05

Epoch :  19 loss training:  48.311834052205086 Time :  660
accuracy train: 0.920913 val: 0.716418 test: 0.722731
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.714816
Counter({0: 4177, 1: 3223})
Epoch-19 lr: 1.5625e-05

Epoch :  20 loss training:  47.71314862370491 Time :  693
accuracy train: 0.920913 val: 0.725373 test: 0.719515
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.714816
Counter({1: 4176, 0: 3224})

Epoch :  21 loss training:  46.01743793487549 Time :  737
accuracy train: 0.920251 val: 0.722388 test: 0.721989
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.714816
Counter({1: 4175, 0: 3225})

Epoch :  22 loss training:  48.354384407401085 Time :  773
accuracy train: 0.925215 val: 0.725373 test: 0.721247
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.714816
Counter({0: 4175, 1: 3225})

Epoch :  23 loss training:  47.02890381217003 Time :  805
accuracy train: 0.927531 val: 0.725373 test: 0.719515
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.714816
Counter({0: 4181, 1: 3219})

Epoch :  24 loss training:  45.31905545294285 Time :  839
accuracy train: 0.927201 val: 0.716418 test: 0.722731
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.714816
Counter({1: 4185, 0: 3215})

Epoch :  25 loss training:  45.78410939872265 Time :  867
accuracy train: 0.924222 val: 0.719403 test: 0.721989
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.714816
Counter({0: 4185, 1: 3215})

Epoch :  26 loss training:  44.36911863088608 Time :  903
accuracy train: 0.928193 val: 0.731343 test: 0.721989
max validation accuracy : 0.731343 max acc epoch : 26 test accuracy : 0.721989
Counter({1: 4190, 0: 3210})

Epoch :  27 loss training:  45.671708323061466 Time :  946
accuracy train: 0.933819 val: 0.722388 test: 0.719268
max validation accuracy : 0.731343 max acc epoch : 26 test accuracy : 0.721989
Counter({1: 4193, 0: 3207})

Epoch :  28 loss training:  45.08574216067791 Time :  986
accuracy train: 0.931833 val: 0.722388 test: 0.724215
max validation accuracy : 0.731343 max acc epoch : 26 test accuracy : 0.721989
Counter({0: 4200, 1: 3200})

Epoch :  29 loss training:  44.12538921833038 Time :  1018
accuracy train: 0.933819 val: 0.710448 test: 0.721741
max validation accuracy : 0.731343 max acc epoch : 26 test accuracy : 0.721989
Counter({1: 4203, 0: 3197})

Epoch :  30 loss training:  44.095220763236284 Time :  1054
accuracy train: 0.935804 val: 0.710448 test: 0.723473
max validation accuracy : 0.731343 max acc epoch : 26 test accuracy : 0.721989
Counter({0: 4206, 1: 3194})

Epoch :  31 loss training:  43.01144793629646 Time :  1101
accuracy train: 0.934811 val: 0.725373 test: 0.722483
max validation accuracy : 0.731343 max acc epoch : 26 test accuracy : 0.721989
Counter({1: 4206, 0: 3194})

Epoch :  32 loss training:  42.93584893643856 Time :  1145
accuracy train: 0.937790 val: 0.719403 test: 0.722978
max validation accuracy : 0.731343 max acc epoch : 26 test accuracy : 0.721989
Counter({0: 4207, 1: 3193})

Epoch :  33 loss training:  43.08089354634285 Time :  1180
accuracy train: 0.936797 val: 0.725373 test: 0.721741
max validation accuracy : 0.731343 max acc epoch : 26 test accuracy : 0.721989
Counter({1: 4206, 0: 3194})

Epoch :  34 loss training:  43.19888609647751 Time :  1216
accuracy train: 0.937790 val: 0.725373 test: 0.721741
max validation accuracy : 0.731343 max acc epoch : 26 test accuracy : 0.721989
Counter({0: 4208, 1: 3192})

Epoch :  35 loss training:  41.97850079834461 Time :  1249
accuracy train: 0.940437 val: 0.722388 test: 0.721494
max validation accuracy : 0.731343 max acc epoch : 26 test accuracy : 0.721989
Counter({1: 4207, 0: 3193})

Epoch :  36 loss training:  42.495639860630035 Time :  1284
accuracy train: 0.940768 val: 0.719403 test: 0.720999
max validation accuracy : 0.731343 max acc epoch : 26 test accuracy : 0.721989
Counter({1: 4207, 0: 3193})

Epoch :  37 loss training:  40.37942378222942 Time :  1321
accuracy train: 0.943746 val: 0.722388 test: 0.723225
max validation accuracy : 0.731343 max acc epoch : 26 test accuracy : 0.721989
Counter({1: 4208, 0: 3192})

Epoch :  38 loss training:  42.16839460283518 Time :  1352
accuracy train: 0.944739 val: 0.719403 test: 0.722731
max validation accuracy : 0.731343 max acc epoch : 26 test accuracy : 0.721989
Counter({1: 4210, 0: 3190})

Epoch :  39 loss training:  42.12058736383915 Time :  1380
accuracy train: 0.944077 val: 0.716418 test: 0.724957
max validation accuracy : 0.731343 max acc epoch : 26 test accuracy : 0.721989
Counter({1: 4209, 0: 3191})

Epoch :  40 loss training:  39.7571020424366 Time :  1416
accuracy train: 0.941760 val: 0.719403 test: 0.722731
max validation accuracy : 0.731343 max acc epoch : 26 test accuracy : 0.721989
Counter({0: 4210, 1: 3190})

Epoch :  41 loss training:  40.08954864740372 Time :  1447
accuracy train: 0.945731 val: 0.719403 test: 0.723225
max validation accuracy : 0.731343 max acc epoch : 26 test accuracy : 0.721989
Counter({0: 4208, 1: 3192})

Epoch :  42 loss training:  41.56354231387377 Time :  1479
accuracy train: 0.945400 val: 0.728358 test: 0.719268
max validation accuracy : 0.731343 max acc epoch : 26 test accuracy : 0.721989
Counter({1: 4211, 0: 3189})

Epoch :  43 loss training:  38.82278670370579 Time :  1510
accuracy train: 0.947717 val: 0.725373 test: 0.719763
max validation accuracy : 0.731343 max acc epoch : 26 test accuracy : 0.721989
Counter({0: 4212, 1: 3188})

Epoch :  44 loss training:  39.276311576366425 Time :  1543
accuracy train: 0.949371 val: 0.725373 test: 0.721741
max validation accuracy : 0.731343 max acc epoch : 26 test accuracy : 0.721989
Counter({1: 4209, 0: 3191})

Epoch :  45 loss training:  38.646244920790195 Time :  1575
accuracy train: 0.949040 val: 0.725373 test: 0.720505
max validation accuracy : 0.731343 max acc epoch : 26 test accuracy : 0.721989
Counter({1: 4212, 0: 3188})

Epoch :  46 loss training:  39.001899398863316 Time :  1607
accuracy train: 0.948048 val: 0.713433 test: 0.724709
max validation accuracy : 0.731343 max acc epoch : 26 test accuracy : 0.721989
Counter({0: 4212, 1: 3188})

Epoch :  47 loss training:  37.99889973551035 Time :  1639
accuracy train: 0.947055 val: 0.716418 test: 0.721989
max validation accuracy : 0.731343 max acc epoch : 26 test accuracy : 0.721989
Counter({0: 4213, 1: 3187})

Epoch :  48 loss training:  37.09802687168121 Time :  1674
accuracy train: 0.953673 val: 0.728358 test: 0.724709
max validation accuracy : 0.731343 max acc epoch : 26 test accuracy : 0.721989
Counter({0: 4214, 1: 3186})

Epoch :  49 loss training:  37.04545122385025 Time :  1705
accuracy train: 0.952349 val: 0.737313 test: 0.724215
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({0: 4214, 1: 3186})

Epoch :  50 loss training:  38.229200437664986 Time :  1737
accuracy train: 0.950033 val: 0.722388 test: 0.723967
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({0: 4215, 1: 3185})

Epoch :  51 loss training:  37.21401131898165 Time :  1767
accuracy train: 0.954335 val: 0.725373 test: 0.726193
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({1: 4218, 0: 3182})

Epoch :  52 loss training:  37.534886337816715 Time :  1802
accuracy train: 0.955989 val: 0.713433 test: 0.723473
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({0: 4217, 1: 3183})

Epoch :  53 loss training:  36.3861615434289 Time :  1837
accuracy train: 0.954666 val: 0.719403 test: 0.724709
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({1: 4217, 0: 3183})

Epoch :  54 loss training:  36.0797451287508 Time :  1874
accuracy train: 0.957644 val: 0.731343 test: 0.724957
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({1: 4219, 0: 3181})

Epoch :  55 loss training:  35.51753988862038 Time :  1907
accuracy train: 0.957644 val: 0.722388 test: 0.721989
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({1: 4219, 0: 3181})

Epoch :  56 loss training:  35.5476034656167 Time :  1938
accuracy train: 0.961946 val: 0.719403 test: 0.724957
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({1: 4220, 0: 3180})

Epoch :  57 loss training:  35.76084449887276 Time :  1979
accuracy train: 0.959960 val: 0.731343 test: 0.726193
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({0: 4224, 1: 3176})

Epoch :  58 loss training:  34.955906450748444 Time :  2005
accuracy train: 0.959629 val: 0.722388 test: 0.726441
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({1: 4223, 0: 3177})

Epoch :  59 loss training:  33.50658731162548 Time :  2035
accuracy train: 0.961946 val: 0.722388 test: 0.723473
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({0: 4223, 1: 3177})

Epoch :  60 loss training:  34.060150019824505 Time :  2064
accuracy train: 0.961946 val: 0.725373 test: 0.723720
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({0: 4220, 1: 3180})

Epoch :  61 loss training:  32.615856163203716 Time :  2092
accuracy train: 0.963269 val: 0.737313 test: 0.723225
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({0: 4221, 1: 3179})

Epoch :  62 loss training:  35.240134850144386 Time :  2126
accuracy train: 0.962277 val: 0.722388 test: 0.723473
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({0: 4219, 1: 3181})

Epoch :  63 loss training:  33.24410752952099 Time :  2158
accuracy train: 0.965586 val: 0.719403 test: 0.726441
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({0: 4217, 1: 3183})

Epoch :  64 loss training:  32.78370250016451 Time :  2190
accuracy train: 0.965586 val: 0.728358 test: 0.722731
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({1: 4218, 0: 3182})

Epoch :  65 loss training:  32.64241810888052 Time :  2220
accuracy train: 0.966909 val: 0.725373 test: 0.727925
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({0: 4219, 1: 3181})

Epoch :  66 loss training:  33.3471545279026 Time :  2250
accuracy train: 0.965586 val: 0.722388 test: 0.724462
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({1: 4223, 0: 3177})

Epoch :  67 loss training:  31.259670086205006 Time :  2282
accuracy train: 0.965255 val: 0.725373 test: 0.724957
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({1: 4223, 0: 3177})

Epoch :  68 loss training:  31.093273006379604 Time :  2323
accuracy train: 0.969887 val: 0.728358 test: 0.724462
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({1: 4226, 0: 3174})

Epoch :  69 loss training:  31.605728819966316 Time :  2366
accuracy train: 0.967240 val: 0.719403 test: 0.723473
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({1: 4230, 0: 3170})

Epoch :  70 loss training:  31.178426928818226 Time :  2405
accuracy train: 0.969557 val: 0.725373 test: 0.727430
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({0: 4232, 1: 3168})

Epoch :  71 loss training:  31.1714698523283 Time :  2445
accuracy train: 0.970218 val: 0.728358 test: 0.725699
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({0: 4232, 1: 3168})

Epoch :  72 loss training:  30.593364879488945 Time :  2490
accuracy train: 0.970880 val: 0.722388 test: 0.726441
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({1: 4237, 0: 3163})

Epoch :  73 loss training:  30.37778516858816 Time :  2530
accuracy train: 0.971211 val: 0.725373 test: 0.724957
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({0: 4238, 1: 3162})

Epoch :  74 loss training:  30.272038534283638 Time :  2564
accuracy train: 0.971873 val: 0.728358 test: 0.725204
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({0: 4234, 1: 3166})

Epoch :  75 loss training:  29.515029650181532 Time :  2596
accuracy train: 0.970880 val: 0.731343 test: 0.726935
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({0: 4232, 1: 3168})

Epoch :  76 loss training:  29.590486496686935 Time :  2626
accuracy train: 0.971211 val: 0.719403 test: 0.724462
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({0: 4233, 1: 3167})

Epoch :  77 loss training:  30.108355402946472 Time :  2661
accuracy train: 0.972535 val: 0.722388 test: 0.723967
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({0: 4236, 1: 3164})

Epoch :  78 loss training:  27.972283340990543 Time :  2690
accuracy train: 0.974189 val: 0.719403 test: 0.726935
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({0: 4236, 1: 3164})

Epoch :  79 loss training:  30.33672784268856 Time :  2722
accuracy train: 0.974520 val: 0.722388 test: 0.728914
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({1: 4233, 0: 3167})

Epoch :  80 loss training:  28.251635678112507 Time :  2749
accuracy train: 0.976175 val: 0.722388 test: 0.725204
max validation accuracy : 0.737313 max acc epoch : 49 test accuracy : 0.724215
Counter({0: 4233, 1: 3167})

========================================================================================================================================================================================================
max acc epoch :  49
max validation accuracy :  0.7373134328358208
test accuracy :  0.7242146920603513
last test_accuracy :  0.725204056393767
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=370, weight_decay=0)
device :  cuda:0
Counter({1: 4561, 0: 2839})

Epoch :  1 loss training:  212.31595849990845 Time :  2852
accuracy train: 0.643283 val: 0.600000 test: 0.603760
max validation accuracy : 0.600000 max acc epoch : 1 test accuracy : 0.603760
Counter({0: 4791, 1: 2609})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  141.48830091953278 Time :  2886
accuracy train: 0.717406 val: 0.656716 test: 0.632698
max validation accuracy : 0.656716 max acc epoch : 2 test accuracy : 0.632698
Counter({0: 4033, 1: 3367})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  122.69597291946411 Time :  2915
accuracy train: 0.745202 val: 0.689552 test: 0.658917
max validation accuracy : 0.689552 max acc epoch : 3 test accuracy : 0.658917
Counter({0: 4256, 1: 3144})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  96.78956061601639 Time :  2950
accuracy train: 0.797154 val: 0.695522 test: 0.700470
max validation accuracy : 0.695522 max acc epoch : 4 test accuracy : 0.700470
Counter({0: 4350, 1: 3050})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  89.30636993050575 Time :  2995
accuracy train: 0.827929 val: 0.704478 test: 0.705417
max validation accuracy : 0.704478 max acc epoch : 5 test accuracy : 0.705417
Counter({0: 4401, 1: 2999})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  85.84934723377228 Time :  3025
accuracy train: 0.833554 val: 0.713433 test: 0.699481
max validation accuracy : 0.713433 max acc epoch : 6 test accuracy : 0.699481
Counter({0: 4312, 1: 3088})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  71.81073406338692 Time :  3053
accuracy train: 0.862674 val: 0.704478 test: 0.711600
max validation accuracy : 0.713433 max acc epoch : 6 test accuracy : 0.699481
Counter({0: 4296, 1: 3104})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  67.1784089654684 Time :  3081
accuracy train: 0.879881 val: 0.722388 test: 0.715558
max validation accuracy : 0.722388 max acc epoch : 8 test accuracy : 0.715558
Counter({1: 4331, 0: 3069})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.74824133515358 Time :  3108
accuracy train: 0.879550 val: 0.725373 test: 0.715558
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.715558
Counter({1: 4307, 0: 3093})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.816976711153984 Time :  3142
accuracy train: 0.892455 val: 0.704478 test: 0.720505
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.715558
Counter({1: 4309, 0: 3091})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  57.20956403017044 Time :  3169
accuracy train: 0.895103 val: 0.713433 test: 0.719763
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.715558
Counter({1: 4307, 0: 3093})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  55.601918295025826 Time :  3193
accuracy train: 0.908339 val: 0.722388 test: 0.721741
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.715558
Counter({0: 4306, 1: 3094})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  53.295378386974335 Time :  3225
accuracy train: 0.904037 val: 0.713433 test: 0.716052
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.715558
Counter({0: 4310, 1: 3090})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  53.96546699106693 Time :  3251
accuracy train: 0.910324 val: 0.713433 test: 0.721494
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.715558
Counter({1: 4324, 0: 3076})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  51.14024715125561 Time :  3280
accuracy train: 0.912972 val: 0.710448 test: 0.723225
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.715558
Counter({1: 4330, 0: 3070})
Epoch-15 lr: 3.125e-05

Epoch :  16 loss training:  49.44287297129631 Time :  3316
accuracy train: 0.913302 val: 0.713433 test: 0.723473
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.715558
Counter({0: 4332, 1: 3068})
Epoch-16 lr: 3.125e-05

Epoch :  17 loss training:  49.79366407543421 Time :  3342
accuracy train: 0.915619 val: 0.722388 test: 0.720257
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.715558
Counter({0: 4333, 1: 3067})
Epoch-17 lr: 3.125e-05

Epoch :  18 loss training:  48.17460195720196 Time :  3369
accuracy train: 0.918928 val: 0.725373 test: 0.723967
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.715558
Counter({0: 4333, 1: 3067})
Epoch-18 lr: 1.5625e-05

Epoch :  19 loss training:  47.468891590833664 Time :  3401
accuracy train: 0.920913 val: 0.722388 test: 0.725451
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.715558
Counter({1: 4334, 0: 3066})
Epoch-19 lr: 1.5625e-05

Epoch :  20 loss training:  49.29326984286308 Time :  3430
accuracy train: 0.921575 val: 0.716418 test: 0.723225
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.715558
Counter({0: 4334, 1: 3066})

Epoch :  21 loss training:  47.818142771720886 Time :  3459
accuracy train: 0.919921 val: 0.716418 test: 0.727925
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.715558
Counter({1: 4330, 0: 3070})

Epoch :  22 loss training:  46.571115136146545 Time :  3487
accuracy train: 0.922899 val: 0.725373 test: 0.724709
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.715558
Counter({0: 4333, 1: 3067})

Epoch :  23 loss training:  48.65435320138931 Time :  3515
accuracy train: 0.922899 val: 0.716418 test: 0.722731
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.715558
Counter({0: 4336, 1: 3064})

Epoch :  24 loss training:  45.13641711324453 Time :  3541
accuracy train: 0.925546 val: 0.722388 test: 0.719763
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.715558
Counter({1: 4337, 0: 3063})

Epoch :  25 loss training:  45.80084717273712 Time :  3577
accuracy train: 0.926870 val: 0.722388 test: 0.725699
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.715558
Counter({0: 4340, 1: 3060})

Epoch :  26 loss training:  46.63946870714426 Time :  3609
accuracy train: 0.928193 val: 0.722388 test: 0.722731
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.715558
Counter({1: 4341, 0: 3059})

Epoch :  27 loss training:  46.05332175642252 Time :  3647
accuracy train: 0.933819 val: 0.722388 test: 0.723473
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.715558
Counter({1: 4346, 0: 3054})

Epoch :  28 loss training:  44.058435037732124 Time :  3684
accuracy train: 0.933157 val: 0.725373 test: 0.722978
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.715558
Counter({0: 4348, 1: 3052})

Epoch :  29 loss training:  43.85950367897749 Time :  3718
accuracy train: 0.929848 val: 0.728358 test: 0.720999
max validation accuracy : 0.728358 max acc epoch : 29 test accuracy : 0.720999
Counter({1: 4350, 0: 3050})

Epoch :  30 loss training:  43.86486805975437 Time :  3749
accuracy train: 0.934150 val: 0.725373 test: 0.724215
max validation accuracy : 0.728358 max acc epoch : 29 test accuracy : 0.720999
Counter({1: 4351, 0: 3049})

Epoch :  31 loss training:  43.497124552726746 Time :  3789
accuracy train: 0.935473 val: 0.725373 test: 0.724215
max validation accuracy : 0.728358 max acc epoch : 29 test accuracy : 0.720999
Counter({0: 4352, 1: 3048})

Epoch :  32 loss training:  43.20319736748934 Time :  3827
accuracy train: 0.936135 val: 0.719403 test: 0.724957
max validation accuracy : 0.728358 max acc epoch : 29 test accuracy : 0.720999
Counter({0: 4352, 1: 3048})

Epoch :  33 loss training:  44.000291123986244 Time :  3865
accuracy train: 0.937459 val: 0.725373 test: 0.723225
max validation accuracy : 0.728358 max acc epoch : 29 test accuracy : 0.720999
Counter({0: 4352, 1: 3048})

Epoch :  34 loss training:  43.01918613165617 Time :  3898
accuracy train: 0.936797 val: 0.725373 test: 0.724215
max validation accuracy : 0.728358 max acc epoch : 29 test accuracy : 0.720999
Counter({0: 4355, 1: 3045})

Epoch :  35 loss training:  42.930537544190884 Time :  3925
accuracy train: 0.940106 val: 0.719403 test: 0.725204
max validation accuracy : 0.728358 max acc epoch : 29 test accuracy : 0.720999
Counter({0: 4358, 1: 3042})

Epoch :  36 loss training:  41.43854007869959 Time :  3965
accuracy train: 0.937790 val: 0.722388 test: 0.725699
max validation accuracy : 0.728358 max acc epoch : 29 test accuracy : 0.720999
Counter({1: 4359, 0: 3041})

Epoch :  37 loss training:  41.26109462976456 Time :  3991
accuracy train: 0.939113 val: 0.731343 test: 0.723473
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({1: 4358, 0: 3042})

Epoch :  38 loss training:  39.37931954115629 Time :  4018
accuracy train: 0.939775 val: 0.716418 test: 0.719763
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({1: 4356, 0: 3044})

Epoch :  39 loss training:  40.162212654948235 Time :  4047
accuracy train: 0.943415 val: 0.719403 test: 0.727925
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({1: 4357, 0: 3043})

Epoch :  40 loss training:  39.35277207940817 Time :  4074
accuracy train: 0.943084 val: 0.722388 test: 0.720505
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({1: 4360, 0: 3040})

Epoch :  41 loss training:  41.54775646328926 Time :  4103
accuracy train: 0.946393 val: 0.719403 test: 0.723225
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({0: 4362, 1: 3038})

Epoch :  42 loss training:  39.303455241024494 Time :  4143
accuracy train: 0.945731 val: 0.722388 test: 0.722236
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({1: 4363, 0: 3037})

Epoch :  43 loss training:  39.50399172306061 Time :  4177
accuracy train: 0.948379 val: 0.719403 test: 0.724462
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({1: 4364, 0: 3036})

Epoch :  44 loss training:  39.34684593975544 Time :  4204
accuracy train: 0.948048 val: 0.731343 test: 0.723225
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({1: 4364, 0: 3036})

Epoch :  45 loss training:  38.296266585588455 Time :  4233
accuracy train: 0.948048 val: 0.728358 test: 0.723967
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({0: 4363, 1: 3037})

Epoch :  46 loss training:  37.3134433478117 Time :  4264
accuracy train: 0.950033 val: 0.722388 test: 0.725451
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({0: 4367, 1: 3033})

Epoch :  47 loss training:  38.33650393038988 Time :  4302
accuracy train: 0.948709 val: 0.722388 test: 0.720752
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({0: 4369, 1: 3031})

Epoch :  48 loss training:  37.12915451079607 Time :  4329
accuracy train: 0.950364 val: 0.728358 test: 0.724957
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({1: 4373, 0: 3027})

Epoch :  49 loss training:  37.977708265185356 Time :  4368
accuracy train: 0.951357 val: 0.728358 test: 0.724709
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({0: 4372, 1: 3028})

Epoch :  50 loss training:  36.872012957930565 Time :  4398
accuracy train: 0.954666 val: 0.725373 test: 0.727925
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({1: 4367, 0: 3033})

Epoch :  51 loss training:  38.44005451351404 Time :  4424
accuracy train: 0.955659 val: 0.725373 test: 0.726193
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({0: 4368, 1: 3032})

Epoch :  52 loss training:  35.303773663938046 Time :  4452
accuracy train: 0.955328 val: 0.716418 test: 0.725946
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({1: 4369, 0: 3031})

Epoch :  53 loss training:  35.49313762784004 Time :  4493
accuracy train: 0.957644 val: 0.710448 test: 0.724462
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({0: 4368, 1: 3032})

Epoch :  54 loss training:  36.17477870732546 Time :  4524
accuracy train: 0.960622 val: 0.725373 test: 0.724215
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({0: 4368, 1: 3032})

Epoch :  55 loss training:  35.764827735722065 Time :  4555
accuracy train: 0.961284 val: 0.716418 test: 0.722483
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({0: 4368, 1: 3032})

Epoch :  56 loss training:  36.180282443761826 Time :  4586
accuracy train: 0.959960 val: 0.713433 test: 0.726441
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({0: 4371, 1: 3029})

Epoch :  57 loss training:  34.43701432645321 Time :  4622
accuracy train: 0.964262 val: 0.722388 test: 0.724215
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({1: 4375, 0: 3025})

Epoch :  58 loss training:  34.787046544253826 Time :  4653
accuracy train: 0.961615 val: 0.719403 test: 0.726193
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({0: 4374, 1: 3026})

Epoch :  59 loss training:  35.087737165391445 Time :  4679
accuracy train: 0.961946 val: 0.719403 test: 0.726441
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({0: 4379, 1: 3021})

Epoch :  60 loss training:  33.97791523113847 Time :  4710
accuracy train: 0.963600 val: 0.713433 test: 0.725451
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({1: 4384, 0: 3016})

Epoch :  61 loss training:  32.64509892463684 Time :  4739
accuracy train: 0.965586 val: 0.722388 test: 0.725699
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({1: 4386, 0: 3014})

Epoch :  62 loss training:  34.008319325745106 Time :  4775
accuracy train: 0.965917 val: 0.725373 test: 0.724462
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({0: 4386, 1: 3014})

Epoch :  63 loss training:  33.56929520517588 Time :  4807
accuracy train: 0.965255 val: 0.719403 test: 0.725451
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({0: 4387, 1: 3013})

Epoch :  64 loss training:  32.71107951179147 Time :  4838
accuracy train: 0.965917 val: 0.716418 test: 0.724462
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({0: 4388, 1: 3012})

Epoch :  65 loss training:  33.018401980400085 Time :  4868
accuracy train: 0.967240 val: 0.728358 test: 0.726193
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({0: 4389, 1: 3011})

Epoch :  66 loss training:  32.10226444527507 Time :  4900
accuracy train: 0.967571 val: 0.719403 test: 0.728914
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({1: 4388, 0: 3012})

Epoch :  67 loss training:  33.89712256193161 Time :  4942
accuracy train: 0.968233 val: 0.725373 test: 0.725204
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({0: 4389, 1: 3011})

Epoch :  68 loss training:  32.32599487900734 Time :  4970
accuracy train: 0.970218 val: 0.719403 test: 0.728667
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.723473
Counter({0: 4389, 1: 3011})

========================================================================================================================================================================================================
max acc epoch :  37
max validation accuracy :  0.7313432835820896
test accuracy :  0.7234726688102894
last test_accuracy :  0.7286668315607222
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=370, weight_decay=0)
device :  cuda:0
Counter({1: 4561, 0: 2839})

Epoch :  1 loss training:  211.8193138241768 Time :  5041
accuracy train: 0.645599 val: 0.608955 test: 0.604254
max validation accuracy : 0.608955 max acc epoch : 1 test accuracy : 0.604254
Counter({1: 4777, 0: 2623})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  141.1662274003029 Time :  5073
accuracy train: 0.712442 val: 0.644776 test: 0.631956
max validation accuracy : 0.644776 max acc epoch : 2 test accuracy : 0.631956
Counter({0: 4247, 1: 3153})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  123.02936732769012 Time :  5128
accuracy train: 0.743216 val: 0.686567 test: 0.653970
max validation accuracy : 0.686567 max acc epoch : 3 test accuracy : 0.653970
Counter({1: 4445, 0: 2955})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  97.0451951622963 Time :  5168
accuracy train: 0.801787 val: 0.713433 test: 0.697502
max validation accuracy : 0.713433 max acc epoch : 4 test accuracy : 0.697502
Counter({1: 4409, 0: 2991})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.97466856241226 Time :  5209
accuracy train: 0.825943 val: 0.716418 test: 0.700717
max validation accuracy : 0.716418 max acc epoch : 5 test accuracy : 0.700717
Counter({0: 4404, 1: 2996})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  85.40020391345024 Time :  5244
accuracy train: 0.828259 val: 0.713433 test: 0.700965
max validation accuracy : 0.716418 max acc epoch : 5 test accuracy : 0.700717
Counter({0: 4245, 1: 3155})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  71.43118044734001 Time :  5279
accuracy train: 0.861681 val: 0.701493 test: 0.709374
max validation accuracy : 0.716418 max acc epoch : 5 test accuracy : 0.700717
Counter({1: 4238, 0: 3162})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.91140174865723 Time :  5316
accuracy train: 0.876572 val: 0.716418 test: 0.714568
max validation accuracy : 0.716418 max acc epoch : 5 test accuracy : 0.700717
Counter({1: 4309, 0: 3091})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.05750827491283 Time :  5349
accuracy train: 0.877234 val: 0.734328 test: 0.709127
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.709127
Counter({1: 4291, 0: 3109})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.62582800537348 Time :  5381
accuracy train: 0.893448 val: 0.707463 test: 0.719021
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.709127
Counter({1: 4292, 0: 3108})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  57.386010110378265 Time :  5415
accuracy train: 0.895433 val: 0.710448 test: 0.716794
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.709127
Counter({1: 4302, 0: 3098})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  54.3443716019392 Time :  5449
accuracy train: 0.909001 val: 0.719403 test: 0.721494
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.709127
Counter({0: 4301, 1: 3099})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  52.890210926532745 Time :  5489
accuracy train: 0.906023 val: 0.707463 test: 0.716547
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.709127
Counter({0: 4305, 1: 3095})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  53.40429745614529 Time :  5519
accuracy train: 0.907677 val: 0.719403 test: 0.722731
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.709127
Counter({1: 4315, 0: 3085})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  51.04405452311039 Time :  5550
accuracy train: 0.910986 val: 0.725373 test: 0.720752
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.709127
Counter({1: 4313, 0: 3087})
Epoch-15 lr: 3.125e-05

Epoch :  16 loss training:  49.43952217698097 Time :  5583
accuracy train: 0.911979 val: 0.719403 test: 0.724462
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.709127
Counter({0: 4317, 1: 3083})
Epoch-16 lr: 3.125e-05

Epoch :  17 loss training:  49.37766474485397 Time :  5627
accuracy train: 0.912310 val: 0.728358 test: 0.721247
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.709127
Counter({1: 4317, 0: 3083})
Epoch-17 lr: 3.125e-05

Epoch :  18 loss training:  48.31610989570618 Time :  5666
accuracy train: 0.918597 val: 0.725373 test: 0.722483
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.709127
Counter({0: 4324, 1: 3076})
Epoch-18 lr: 1.5625e-05

Epoch :  19 loss training:  47.38630086183548 Time :  5703
accuracy train: 0.919921 val: 0.722388 test: 0.721989
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.709127
Counter({1: 4323, 0: 3077})
Epoch-19 lr: 1.5625e-05

Epoch :  20 loss training:  49.40944218635559 Time :  5743
accuracy train: 0.921244 val: 0.731343 test: 0.720257
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.709127
Counter({0: 4323, 1: 3077})

Epoch :  21 loss training:  45.92116641998291 Time :  5779
accuracy train: 0.919259 val: 0.728358 test: 0.720999
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.709127
Counter({0: 4323, 1: 3077})

Epoch :  22 loss training:  47.39449194073677 Time :  5824
accuracy train: 0.922568 val: 0.731343 test: 0.722236
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.709127
Counter({0: 4324, 1: 3076})

Epoch :  23 loss training:  47.14803338050842 Time :  5858
accuracy train: 0.926870 val: 0.734328 test: 0.720999
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.709127
Counter({1: 4332, 0: 3068})

Epoch :  24 loss training:  45.67796881496906 Time :  5898
accuracy train: 0.925546 val: 0.731343 test: 0.718279
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.709127
Counter({1: 4337, 0: 3063})

Epoch :  25 loss training:  44.945453360676765 Time :  5935
accuracy train: 0.926870 val: 0.734328 test: 0.723225
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.709127
Counter({0: 4340, 1: 3060})

Epoch :  26 loss training:  44.16967923939228 Time :  5977
accuracy train: 0.928193 val: 0.731343 test: 0.721247
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.709127
Counter({1: 4340, 0: 3060})

Epoch :  27 loss training:  45.550699174404144 Time :  6013
accuracy train: 0.933819 val: 0.719403 test: 0.723720
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.709127
Counter({0: 4339, 1: 3061})

Epoch :  28 loss training:  44.43157725036144 Time :  6051
accuracy train: 0.930179 val: 0.713433 test: 0.721494
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.709127
Counter({1: 4342, 0: 3058})

Epoch :  29 loss training:  43.75581431388855 Time :  6093
accuracy train: 0.932495 val: 0.725373 test: 0.722483
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.709127
Counter({0: 4342, 1: 3058})

Epoch :  30 loss training:  42.88636177033186 Time :  6134
accuracy train: 0.936466 val: 0.728358 test: 0.720257
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.709127
Counter({0: 4345, 1: 3055})

Epoch :  31 loss training:  43.29384768009186 Time :  6163
accuracy train: 0.939775 val: 0.728358 test: 0.718031
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.709127
Counter({0: 4345, 1: 3055})

Epoch :  32 loss training:  43.486402451992035 Time :  6192
accuracy train: 0.939113 val: 0.719403 test: 0.720999
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.709127
Counter({0: 4347, 1: 3053})

Epoch :  33 loss training:  42.71843507885933 Time :  6219
accuracy train: 0.937128 val: 0.725373 test: 0.718031
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.709127
Counter({1: 4346, 0: 3054})

Epoch :  34 loss training:  42.27859168499708 Time :  6248
accuracy train: 0.939113 val: 0.737313 test: 0.721741
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({0: 4348, 1: 3052})

Epoch :  35 loss training:  41.53117634356022 Time :  6289
accuracy train: 0.942091 val: 0.728358 test: 0.722731
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({1: 4347, 0: 3053})

Epoch :  36 loss training:  42.33574836701155 Time :  6324
accuracy train: 0.939775 val: 0.731343 test: 0.720257
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({1: 4344, 0: 3056})

Epoch :  37 loss training:  40.17951129376888 Time :  6354
accuracy train: 0.945731 val: 0.710448 test: 0.720752
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({1: 4342, 0: 3058})

Epoch :  38 loss training:  41.10806439071894 Time :  6382
accuracy train: 0.945400 val: 0.710448 test: 0.720010
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({1: 4342, 0: 3058})

Epoch :  39 loss training:  41.85974718630314 Time :  6412
accuracy train: 0.947055 val: 0.722388 test: 0.725946
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({0: 4345, 1: 3055})

Epoch :  40 loss training:  39.04669167101383 Time :  6452
accuracy train: 0.944408 val: 0.716418 test: 0.722978
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({0: 4346, 1: 3054})

Epoch :  41 loss training:  38.86330857872963 Time :  6483
accuracy train: 0.950364 val: 0.719403 test: 0.721989
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({0: 4349, 1: 3051})

Epoch :  42 loss training:  40.74996381253004 Time :  6519
accuracy train: 0.947717 val: 0.719403 test: 0.719515
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({1: 4350, 0: 3050})

Epoch :  43 loss training:  38.03870643675327 Time :  6549
accuracy train: 0.949371 val: 0.722388 test: 0.719268
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({0: 4356, 1: 3044})

Epoch :  44 loss training:  39.75819166004658 Time :  6580
accuracy train: 0.948709 val: 0.725373 test: 0.718773
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({1: 4353, 0: 3047})

Epoch :  45 loss training:  38.6740193516016 Time :  6614
accuracy train: 0.951026 val: 0.722388 test: 0.722236
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({0: 4353, 1: 3047})

Epoch :  46 loss training:  38.371189057826996 Time :  6646
accuracy train: 0.953342 val: 0.716418 test: 0.721741
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({0: 4354, 1: 3046})

Epoch :  47 loss training:  37.443349964916706 Time :  6676
accuracy train: 0.953673 val: 0.719403 test: 0.720257
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({0: 4356, 1: 3044})

Epoch :  48 loss training:  36.405698359012604 Time :  6703
accuracy train: 0.956982 val: 0.725373 test: 0.722483
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({1: 4359, 0: 3041})

Epoch :  49 loss training:  36.56903509795666 Time :  6738
accuracy train: 0.954335 val: 0.725373 test: 0.722483
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({0: 4360, 1: 3040})

Epoch :  50 loss training:  36.84410288929939 Time :  6769
accuracy train: 0.956320 val: 0.716418 test: 0.724709
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({1: 4358, 0: 3042})

Epoch :  51 loss training:  37.750531390309334 Time :  6809
accuracy train: 0.958306 val: 0.719403 test: 0.725451
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({1: 4360, 0: 3040})

Epoch :  52 loss training:  37.81647814810276 Time :  6839
accuracy train: 0.956320 val: 0.713433 test: 0.723225
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({1: 4361, 0: 3039})

Epoch :  53 loss training:  34.408225521445274 Time :  6870
accuracy train: 0.955328 val: 0.704478 test: 0.722731
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({1: 4359, 0: 3041})

Epoch :  54 loss training:  35.702804654836655 Time :  6902
accuracy train: 0.961615 val: 0.728358 test: 0.724462
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({1: 4366, 0: 3034})

Epoch :  55 loss training:  35.60067917406559 Time :  6933
accuracy train: 0.960953 val: 0.704478 test: 0.723967
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({0: 4368, 1: 3032})

Epoch :  56 loss training:  35.97703266143799 Time :  6968
accuracy train: 0.960953 val: 0.713433 test: 0.724215
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({1: 4369, 0: 3031})

Epoch :  57 loss training:  34.23649735748768 Time :  6998
accuracy train: 0.962938 val: 0.716418 test: 0.722236
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({1: 4368, 0: 3032})

Epoch :  58 loss training:  34.767277017235756 Time :  7029
accuracy train: 0.961284 val: 0.716418 test: 0.724957
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({0: 4369, 1: 3031})

Epoch :  59 loss training:  33.72540670633316 Time :  7063
accuracy train: 0.963931 val: 0.704478 test: 0.724215
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({0: 4370, 1: 3030})

Epoch :  60 loss training:  33.89755241200328 Time :  7098
accuracy train: 0.964262 val: 0.722388 test: 0.721989
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({1: 4369, 0: 3031})

Epoch :  61 loss training:  33.65873195976019 Time :  7130
accuracy train: 0.966909 val: 0.725373 test: 0.723720
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({0: 4371, 1: 3029})

Epoch :  62 loss training:  34.64335235208273 Time :  7165
accuracy train: 0.966909 val: 0.716418 test: 0.721494
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({0: 4365, 1: 3035})

Epoch :  63 loss training:  33.74729509651661 Time :  7200
accuracy train: 0.967240 val: 0.716418 test: 0.724215
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({0: 4365, 1: 3035})

Epoch :  64 loss training:  32.96539197862148 Time :  7230
accuracy train: 0.968233 val: 0.716418 test: 0.722731
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({1: 4367, 0: 3033})

Epoch :  65 loss training:  32.417415879666805 Time :  7265
accuracy train: 0.969557 val: 0.728358 test: 0.727430
max validation accuracy : 0.737313 max acc epoch : 34 test accuracy : 0.721741
Counter({0: 4368, 1: 3032})

========================================================================================================================================================================================================
max acc epoch :  34
max validation accuracy :  0.7373134328358208
test accuracy :  0.7217412812268118
last test_accuracy :  0.7274301261439525
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=370, weight_decay=0)
device :  cuda:0
Counter({1: 4561, 0: 2839})

Epoch :  1 loss training:  212.4091340303421 Time :  7312
accuracy train: 0.644606 val: 0.591045 test: 0.598813
max validation accuracy : 0.591045 max acc epoch : 1 test accuracy : 0.598813
Counter({1: 4900, 0: 2500})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  140.80238246917725 Time :  7344
accuracy train: 0.710788 val: 0.653731 test: 0.633688
max validation accuracy : 0.653731 max acc epoch : 2 test accuracy : 0.633688
Counter({0: 4279, 1: 3121})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  123.65300235152245 Time :  7372
accuracy train: 0.741893 val: 0.674627 test: 0.652980
max validation accuracy : 0.674627 max acc epoch : 3 test accuracy : 0.652980
Counter({1: 4337, 0: 3063})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  97.39712566137314 Time :  7411
accuracy train: 0.799140 val: 0.692537 test: 0.701707
max validation accuracy : 0.692537 max acc epoch : 4 test accuracy : 0.701707
Counter({1: 4341, 0: 3059})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.69706469774246 Time :  7441
accuracy train: 0.826605 val: 0.707463 test: 0.702696
max validation accuracy : 0.707463 max acc epoch : 5 test accuracy : 0.702696
Counter({0: 4391, 1: 3009})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  85.90773293375969 Time :  7470
accuracy train: 0.830245 val: 0.710448 test: 0.698491
max validation accuracy : 0.710448 max acc epoch : 6 test accuracy : 0.698491
Counter({0: 4265, 1: 3135})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  71.67049339413643 Time :  7502
accuracy train: 0.861681 val: 0.710448 test: 0.709374
max validation accuracy : 0.710448 max acc epoch : 6 test accuracy : 0.698491
Counter({0: 4264, 1: 3136})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  67.43577882647514 Time :  7531
accuracy train: 0.878888 val: 0.722388 test: 0.716300
max validation accuracy : 0.722388 max acc epoch : 8 test accuracy : 0.716300
Counter({1: 4297, 0: 3103})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.57318459451199 Time :  7564
accuracy train: 0.878888 val: 0.731343 test: 0.706653
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.706653
Counter({1: 4263, 0: 3137})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.05899193882942 Time :  7596
accuracy train: 0.893117 val: 0.719403 test: 0.718279
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.706653
Counter({0: 4262, 1: 3138})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  57.71283660829067 Time :  7629
accuracy train: 0.893779 val: 0.719403 test: 0.719515
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.706653
Counter({0: 4261, 1: 3139})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  54.88443446159363 Time :  7667
accuracy train: 0.909001 val: 0.731343 test: 0.719021
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.706653
Counter({0: 4254, 1: 3146})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  53.59492003917694 Time :  7693
accuracy train: 0.905030 val: 0.716418 test: 0.718773
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.706653
Counter({0: 4262, 1: 3138})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  54.05010728538036 Time :  7721
accuracy train: 0.907015 val: 0.719403 test: 0.719021
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.706653
Counter({1: 4275, 0: 3125})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  51.44435365498066 Time :  7747
accuracy train: 0.912641 val: 0.722388 test: 0.720505
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.706653
Counter({0: 4277, 1: 3123})
Epoch-15 lr: 3.125e-05

Epoch :  16 loss training:  49.224026292562485 Time :  7773
accuracy train: 0.911648 val: 0.725373 test: 0.723967
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.706653
Counter({0: 4276, 1: 3124})
Epoch-16 lr: 3.125e-05

Epoch :  17 loss training:  49.80078839510679 Time :  7804
accuracy train: 0.914957 val: 0.728358 test: 0.721247
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.706653
Counter({1: 4273, 0: 3127})
Epoch-17 lr: 3.125e-05

Epoch :  18 loss training:  48.640716180205345 Time :  7834
accuracy train: 0.916942 val: 0.725373 test: 0.721494
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.706653
Counter({0: 4273, 1: 3127})
Epoch-18 lr: 1.5625e-05

Epoch :  19 loss training:  47.74258264899254 Time :  7867
accuracy train: 0.922899 val: 0.725373 test: 0.722978
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.706653
Counter({1: 4274, 0: 3126})
Epoch-19 lr: 1.5625e-05

Epoch :  20 loss training:  49.28166680037975 Time :  7907
accuracy train: 0.921244 val: 0.731343 test: 0.721989
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.706653
Counter({1: 4275, 0: 3125})

Epoch :  21 loss training:  47.43474204838276 Time :  7935
accuracy train: 0.921575 val: 0.728358 test: 0.721494
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.706653
Counter({0: 4273, 1: 3127})

Epoch :  22 loss training:  46.375367641448975 Time :  7971
accuracy train: 0.922237 val: 0.725373 test: 0.724215
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.706653
Counter({1: 4273, 0: 3127})

Epoch :  23 loss training:  48.32245859503746 Time :  8003
accuracy train: 0.923561 val: 0.728358 test: 0.721741
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.706653
Counter({1: 4273, 0: 3127})

Epoch :  24 loss training:  45.44313684105873 Time :  8031
accuracy train: 0.928193 val: 0.728358 test: 0.717784
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.706653
Counter({1: 4274, 0: 3126})

Epoch :  25 loss training:  45.57860389351845 Time :  8060
accuracy train: 0.927531 val: 0.731343 test: 0.723720
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.706653
Counter({0: 4273, 1: 3127})

Epoch :  26 loss training:  46.3862814232707 Time :  8089
accuracy train: 0.928193 val: 0.725373 test: 0.724462
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.706653
Counter({1: 4278, 0: 3122})

Epoch :  27 loss training:  45.52431070804596 Time :  8119
accuracy train: 0.933157 val: 0.722388 test: 0.722483
max validation accuracy : 0.731343 max acc epoch : 9 test accuracy : 0.706653
Counter({1: 4278, 0: 3122})

Epoch :  28 loss training:  44.56031355261803 Time :  8149
accuracy train: 0.930179 val: 0.740299 test: 0.725451
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({1: 4280, 0: 3120})

Epoch :  29 loss training:  44.0498139038682 Time :  8175
accuracy train: 0.933819 val: 0.725373 test: 0.723473
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({1: 4280, 0: 3120})

Epoch :  30 loss training:  43.51653711497784 Time :  8208
accuracy train: 0.937128 val: 0.740299 test: 0.722978
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({0: 4282, 1: 3118})

Epoch :  31 loss training:  43.75963336229324 Time :  8238
accuracy train: 0.939775 val: 0.725373 test: 0.722731
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({1: 4285, 0: 3115})

Epoch :  32 loss training:  42.864160023629665 Time :  8267
accuracy train: 0.938451 val: 0.728358 test: 0.721741
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({1: 4284, 0: 3116})

Epoch :  33 loss training:  44.16852214932442 Time :  8303
accuracy train: 0.937790 val: 0.728358 test: 0.721989
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({1: 4283, 0: 3117})

Epoch :  34 loss training:  43.31305958330631 Time :  8329
accuracy train: 0.938120 val: 0.728358 test: 0.723473
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({1: 4288, 0: 3112})

Epoch :  35 loss training:  42.444161005318165 Time :  8358
accuracy train: 0.941430 val: 0.722388 test: 0.722731
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({1: 4290, 0: 3110})

Epoch :  36 loss training:  41.34914292767644 Time :  8391
accuracy train: 0.939113 val: 0.731343 test: 0.722483
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({0: 4290, 1: 3110})

Epoch :  37 loss training:  40.87152498960495 Time :  8419
accuracy train: 0.942422 val: 0.734328 test: 0.719763
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({1: 4289, 0: 3111})

Epoch :  38 loss training:  39.41276992857456 Time :  8449
accuracy train: 0.943746 val: 0.725373 test: 0.719763
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({1: 4288, 0: 3112})

Epoch :  39 loss training:  40.473447903990746 Time :  8482
accuracy train: 0.942753 val: 0.728358 test: 0.725451
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({1: 4283, 0: 3117})

Epoch :  40 loss training:  39.27539794892073 Time :  8511
accuracy train: 0.944077 val: 0.725373 test: 0.721741
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({0: 4282, 1: 3118})

Epoch :  41 loss training:  41.673732437193394 Time :  8548
accuracy train: 0.947386 val: 0.719403 test: 0.721989
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({0: 4288, 1: 3112})

Epoch :  42 loss training:  39.665799126029015 Time :  8577
accuracy train: 0.949040 val: 0.725373 test: 0.720999
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({0: 4287, 1: 3113})

Epoch :  43 loss training:  39.95467187464237 Time :  8608
accuracy train: 0.948379 val: 0.731343 test: 0.719021
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({0: 4288, 1: 3112})

Epoch :  44 loss training:  39.41397075355053 Time :  8636
accuracy train: 0.946724 val: 0.725373 test: 0.723225
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({0: 4287, 1: 3113})

Epoch :  45 loss training:  38.83485536277294 Time :  8663
accuracy train: 0.947055 val: 0.725373 test: 0.725699
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({1: 4287, 0: 3113})

Epoch :  46 loss training:  37.168179519474506 Time :  8687
accuracy train: 0.949702 val: 0.725373 test: 0.723473
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({0: 4288, 1: 3112})

Epoch :  47 loss training:  38.25662034749985 Time :  8713
accuracy train: 0.950364 val: 0.710448 test: 0.722483
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({0: 4291, 1: 3109})

Epoch :  48 loss training:  37.043804593384266 Time :  8741
accuracy train: 0.954335 val: 0.725373 test: 0.723967
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({0: 4293, 1: 3107})

Epoch :  49 loss training:  38.08661524951458 Time :  8765
accuracy train: 0.952349 val: 0.731343 test: 0.725451
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({1: 4295, 0: 3105})

Epoch :  50 loss training:  37.12864737957716 Time :  8791
accuracy train: 0.953673 val: 0.719403 test: 0.722731
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({1: 4290, 0: 3110})

Epoch :  51 loss training:  38.344292268157005 Time :  8815
accuracy train: 0.958637 val: 0.716418 test: 0.726193
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({0: 4288, 1: 3112})

Epoch :  52 loss training:  35.766797967255116 Time :  8841
accuracy train: 0.954666 val: 0.725373 test: 0.723720
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({0: 4292, 1: 3108})

Epoch :  53 loss training:  35.009507179260254 Time :  8867
accuracy train: 0.956320 val: 0.713433 test: 0.724462
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({1: 4293, 0: 3107})

Epoch :  54 loss training:  36.30482963472605 Time :  8892
accuracy train: 0.959960 val: 0.725373 test: 0.724215
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({1: 4295, 0: 3105})

Epoch :  55 loss training:  35.634966894984245 Time :  8916
accuracy train: 0.961284 val: 0.719403 test: 0.722731
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({1: 4298, 0: 3102})

Epoch :  56 loss training:  36.22036170959473 Time :  8941
accuracy train: 0.959960 val: 0.716418 test: 0.725204
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({0: 4297, 1: 3103})

Epoch :  57 loss training:  34.23708122968674 Time :  8965
accuracy train: 0.963931 val: 0.725373 test: 0.724709
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({1: 4299, 0: 3101})

Epoch :  58 loss training:  35.01590681821108 Time :  8990
accuracy train: 0.959629 val: 0.728358 test: 0.724957
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({0: 4298, 1: 3102})

Epoch :  59 loss training:  34.8305828794837 Time :  9014
accuracy train: 0.962608 val: 0.728358 test: 0.725699
max validation accuracy : 0.740299 max acc epoch : 28 test accuracy : 0.725451
Counter({0: 4300, 1: 3100})

========================================================================================================================================================================================================
max acc epoch :  28
max validation accuracy :  0.7402985074626866
test accuracy :  0.725451397477121
last test_accuracy :  0.7256987385604748
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=370, weight_decay=0)
device :  cuda:0
Counter({1: 4561, 0: 2839})

Epoch :  1 loss training:  211.86040991544724 Time :  9045
accuracy train: 0.645930 val: 0.614925 test: 0.603512
max validation accuracy : 0.614925 max acc epoch : 1 test accuracy : 0.603512
Counter({1: 4724, 0: 2676})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  141.09249317646027 Time :  9072
accuracy train: 0.712442 val: 0.659701 test: 0.631709
max validation accuracy : 0.659701 max acc epoch : 2 test accuracy : 0.631709
Counter({0: 4240, 1: 3160})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  122.89443457126617 Time :  9097
accuracy train: 0.740900 val: 0.683582 test: 0.654465
max validation accuracy : 0.683582 max acc epoch : 3 test accuracy : 0.654465
Counter({1: 4418, 0: 2982})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  97.23895540833473 Time :  9136
accuracy train: 0.799801 val: 0.704478 test: 0.701212
max validation accuracy : 0.704478 max acc epoch : 4 test accuracy : 0.701212
Counter({0: 4392, 1: 3008})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.9148827791214 Time :  9160
accuracy train: 0.824619 val: 0.701493 test: 0.703191
max validation accuracy : 0.704478 max acc epoch : 4 test accuracy : 0.701212
Counter({1: 4498, 0: 2902})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  85.08383145928383 Time :  9186
accuracy train: 0.831899 val: 0.704478 test: 0.699481
max validation accuracy : 0.704478 max acc epoch : 4 test accuracy : 0.701212
Counter({1: 4293, 0: 3107})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  71.39939552545547 Time :  9214
accuracy train: 0.863336 val: 0.707463 test: 0.711600
max validation accuracy : 0.707463 max acc epoch : 7 test accuracy : 0.711600
Counter({0: 4287, 1: 3113})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.82258778810501 Time :  9243
accuracy train: 0.877895 val: 0.722388 test: 0.710364
max validation accuracy : 0.722388 max acc epoch : 8 test accuracy : 0.710364
Counter({1: 4309, 0: 3091})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.26119081676006 Time :  9271
accuracy train: 0.879219 val: 0.728358 test: 0.711848
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.711848
Counter({1: 4280, 0: 3120})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.69659112393856 Time :  9299
accuracy train: 0.896095 val: 0.713433 test: 0.717536
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.711848
Counter({1: 4289, 0: 3111})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  57.34623400866985 Time :  9322
accuracy train: 0.897419 val: 0.719403 test: 0.715558
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.711848
Counter({0: 4302, 1: 3098})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  54.969612434506416 Time :  9346
accuracy train: 0.909662 val: 0.719403 test: 0.718279
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.711848
Counter({0: 4309, 1: 3091})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  53.00568801164627 Time :  9374
accuracy train: 0.907346 val: 0.713433 test: 0.715310
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.711848
Counter({0: 4320, 1: 3080})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  53.4527762979269 Time :  9397
accuracy train: 0.909332 val: 0.713433 test: 0.720010
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.711848
Counter({1: 4324, 0: 3076})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  51.217922404408455 Time :  9419
accuracy train: 0.915619 val: 0.716418 test: 0.718279
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.711848
Counter({1: 4325, 0: 3075})
Epoch-15 lr: 3.125e-05

Epoch :  16 loss training:  48.850179836153984 Time :  9443
accuracy train: 0.912972 val: 0.722388 test: 0.722483
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.711848
Counter({1: 4325, 0: 3075})
Epoch-16 lr: 3.125e-05

Epoch :  17 loss training:  49.47965566813946 Time :  9468
accuracy train: 0.916612 val: 0.719403 test: 0.722483
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.711848
Counter({1: 4324, 0: 3076})
Epoch-17 lr: 3.125e-05

Epoch :  18 loss training:  47.6773806065321 Time :  9495
accuracy train: 0.921244 val: 0.722388 test: 0.721741
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.711848
Counter({0: 4323, 1: 3077})
Epoch-18 lr: 1.5625e-05

Epoch :  19 loss training:  47.17497272789478 Time :  9518
accuracy train: 0.923891 val: 0.719403 test: 0.721247
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.711848
Counter({1: 4321, 0: 3079})
Epoch-19 lr: 1.5625e-05

Epoch :  20 loss training:  48.88869449496269 Time :  9541
accuracy train: 0.922568 val: 0.722388 test: 0.720752
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.711848
Counter({1: 4321, 0: 3079})

Epoch :  21 loss training:  47.4446714669466 Time :  9564
accuracy train: 0.922899 val: 0.722388 test: 0.721741
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.711848
Counter({0: 4321, 1: 3079})

Epoch :  22 loss training:  46.782287031412125 Time :  9592
accuracy train: 0.923891 val: 0.725373 test: 0.719515
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.711848
Counter({1: 4321, 0: 3079})

Epoch :  23 loss training:  47.89283727109432 Time :  9615
accuracy train: 0.926539 val: 0.719403 test: 0.722731
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.711848
Counter({0: 4322, 1: 3078})

Epoch :  24 loss training:  45.190988063812256 Time :  9640
accuracy train: 0.929848 val: 0.731343 test: 0.718031
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({0: 4324, 1: 3076})

Epoch :  25 loss training:  45.31555186212063 Time :  9663
accuracy train: 0.929186 val: 0.728358 test: 0.724462
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({1: 4326, 0: 3074})

Epoch :  26 loss training:  45.94414430111647 Time :  9687
accuracy train: 0.928855 val: 0.719403 test: 0.720010
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({1: 4327, 0: 3073})

Epoch :  27 loss training:  45.18940390646458 Time :  9714
accuracy train: 0.935473 val: 0.722388 test: 0.724462
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({1: 4325, 0: 3075})

Epoch :  28 loss training:  44.194626316428185 Time :  9736
accuracy train: 0.932164 val: 0.722388 test: 0.723473
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({1: 4325, 0: 3075})

Epoch :  29 loss training:  43.573926873505116 Time :  9759
accuracy train: 0.935142 val: 0.716418 test: 0.721741
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({1: 4326, 0: 3074})

Epoch :  30 loss training:  43.28502930700779 Time :  9784
accuracy train: 0.938782 val: 0.728358 test: 0.721989
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({0: 4330, 1: 3070})

Epoch :  31 loss training:  42.738456666469574 Time :  9810
accuracy train: 0.937459 val: 0.722388 test: 0.722483
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({1: 4327, 0: 3073})

Epoch :  32 loss training:  42.34224060177803 Time :  9833
accuracy train: 0.941430 val: 0.719403 test: 0.721494
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({0: 4329, 1: 3071})

Epoch :  33 loss training:  43.895002245903015 Time :  9856
accuracy train: 0.940437 val: 0.719403 test: 0.720010
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({1: 4324, 0: 3076})

Epoch :  34 loss training:  42.73259924352169 Time :  9880
accuracy train: 0.941099 val: 0.728358 test: 0.722731
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({0: 4324, 1: 3076})

Epoch :  35 loss training:  42.253046579658985 Time :  9904
accuracy train: 0.940437 val: 0.710448 test: 0.724462
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({1: 4327, 0: 3073})

Epoch :  36 loss training:  40.760227628052235 Time :  9931
accuracy train: 0.940437 val: 0.722388 test: 0.721989
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({0: 4325, 1: 3075})

Epoch :  37 loss training:  40.76813653111458 Time :  9954
accuracy train: 0.943415 val: 0.725373 test: 0.722978
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({1: 4322, 0: 3078})

Epoch :  38 loss training:  39.34462869167328 Time :  9977
accuracy train: 0.944408 val: 0.716418 test: 0.721494
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({1: 4320, 0: 3080})

Epoch :  39 loss training:  40.233143128454685 Time :  10001
accuracy train: 0.946393 val: 0.713433 test: 0.726193
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({1: 4324, 0: 3076})

Epoch :  40 loss training:  39.24822974950075 Time :  10028
accuracy train: 0.945400 val: 0.719403 test: 0.722483
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({0: 4327, 1: 3073})

Epoch :  41 loss training:  41.470907777547836 Time :  10051
accuracy train: 0.949702 val: 0.707463 test: 0.722236
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({0: 4329, 1: 3071})

Epoch :  42 loss training:  39.22831665724516 Time :  10074
accuracy train: 0.949371 val: 0.713433 test: 0.720752
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({0: 4327, 1: 3073})

Epoch :  43 loss training:  39.11740989983082 Time :  10097
accuracy train: 0.948709 val: 0.719403 test: 0.720752
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({1: 4331, 0: 3069})

Epoch :  44 loss training:  38.88778601586819 Time :  10120
accuracy train: 0.951026 val: 0.719403 test: 0.720257
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({1: 4325, 0: 3075})

Epoch :  45 loss training:  38.58459456264973 Time :  10149
accuracy train: 0.950033 val: 0.719403 test: 0.722483
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({0: 4324, 1: 3076})

Epoch :  46 loss training:  37.196809113025665 Time :  10172
accuracy train: 0.949371 val: 0.716418 test: 0.719268
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({0: 4326, 1: 3074})

Epoch :  47 loss training:  37.93108702450991 Time :  10195
accuracy train: 0.950364 val: 0.710448 test: 0.719515
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({0: 4326, 1: 3074})

Epoch :  48 loss training:  36.65847985446453 Time :  10218
accuracy train: 0.955328 val: 0.716418 test: 0.723473
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({0: 4328, 1: 3072})

Epoch :  49 loss training:  37.42048775404692 Time :  10242
accuracy train: 0.955328 val: 0.731343 test: 0.722236
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({0: 4329, 1: 3071})

Epoch :  50 loss training:  36.68393848836422 Time :  10268
accuracy train: 0.954004 val: 0.722388 test: 0.723720
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({1: 4325, 0: 3075})

Epoch :  51 loss training:  38.01336242258549 Time :  10292
accuracy train: 0.957644 val: 0.716418 test: 0.724462
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({0: 4329, 1: 3071})

Epoch :  52 loss training:  34.84146432578564 Time :  10316
accuracy train: 0.954997 val: 0.713433 test: 0.723720
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({0: 4328, 1: 3072})

Epoch :  53 loss training:  34.6604802981019 Time :  10339
accuracy train: 0.957313 val: 0.710448 test: 0.723967
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({1: 4328, 0: 3072})

Epoch :  54 loss training:  35.81041309982538 Time :  10364
accuracy train: 0.961284 val: 0.725373 test: 0.723967
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({1: 4331, 0: 3069})

Epoch :  55 loss training:  35.549543887376785 Time :  10387
accuracy train: 0.961284 val: 0.707463 test: 0.723225
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.718031
Counter({0: 4332, 1: 3068})

========================================================================================================================================================================================================
max acc epoch :  24
max validation accuracy :  0.7313432835820896
test accuracy :  0.7180311649765025
last test_accuracy :  0.7232253277269355
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.73731 	 test_accuracy : 0.72421 	 max_acc epoch :  49 	 last test_accuracy : 0.72520
k :  1 	 val_accuracy : 0.73134 	 test_accuracy : 0.72347 	 max_acc epoch :  37 	 last test_accuracy : 0.72867
k :  2 	 val_accuracy : 0.73731 	 test_accuracy : 0.72174 	 max_acc epoch :  34 	 last test_accuracy : 0.72743
k :  3 	 val_accuracy : 0.74030 	 test_accuracy : 0.72545 	 max_acc epoch :  28 	 last test_accuracy : 0.72570
k :  4 	 val_accuracy : 0.73134 	 test_accuracy : 0.71803 	 max_acc epoch :  24 	 last test_accuracy : 0.72323

avg :  	 val_accuracy : 0.73552 	 test_accuracy : 0.72258 	 last_accuracy : 0.72605
