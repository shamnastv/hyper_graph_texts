

date and time :  Fri Jun 18 16:48:02 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=324, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  41.011958725750446 Time :  15
accuracy train: 0.962147 val: 0.961212 test: 0.954338
max validation accuracy : 0.961212 max acc epoch : 1 test accuracy : 0.954338
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.102829250507057 Time :  29
accuracy train: 0.969632 val: 0.964848 test: 0.958447
max validation accuracy : 0.964848 max acc epoch : 2 test accuracy : 0.958447
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.068005909677595 Time :  41
accuracy train: 0.972840 val: 0.972121 test: 0.952511
max validation accuracy : 0.972121 max acc epoch : 3 test accuracy : 0.952511
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.122529204934835 Time :  56
accuracy train: 0.985030 val: 0.976970 test: 0.970776
max validation accuracy : 0.976970 max acc epoch : 4 test accuracy : 0.970776
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.780035159084946 Time :  70
accuracy train: 0.987382 val: 0.976970 test: 0.975799
max validation accuracy : 0.976970 max acc epoch : 4 test accuracy : 0.970776
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.673144998960197 Time :  82
accuracy train: 0.987169 val: 0.974545 test: 0.968037
max validation accuracy : 0.976970 max acc epoch : 4 test accuracy : 0.970776
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.986835977062583 Time :  96
accuracy train: 0.992943 val: 0.978182 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.968037
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.320217705331743 Time :  108
accuracy train: 0.994226 val: 0.980606 test: 0.972146
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.972146
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.253931876155548 Time :  122
accuracy train: 0.992301 val: 0.976970 test: 0.970776
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.972146
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.535053085186519 Time :  134
accuracy train: 0.994226 val: 0.978182 test: 0.969406
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.972146

Epoch :  11 loss training:  4.929426501621492 Time :  148
accuracy train: 0.993798 val: 0.978182 test: 0.970776
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.972146

Epoch :  12 loss training:  4.618589830468409 Time :  161
accuracy train: 0.994654 val: 0.978182 test: 0.971233
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.972146

Epoch :  13 loss training:  3.932063531712629 Time :  175
accuracy train: 0.994440 val: 0.976970 test: 0.971233
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.972146

Epoch :  14 loss training:  4.555083849118091 Time :  188
accuracy train: 0.994654 val: 0.980606 test: 0.970320
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.972146

Epoch :  15 loss training:  4.095732982561458 Time :  202
accuracy train: 0.995295 val: 0.980606 test: 0.971689
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.972146

Epoch :  16 loss training:  3.8565223139012232 Time :  216
accuracy train: 0.994867 val: 0.976970 test: 0.970320
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.972146

Epoch :  17 loss training:  3.5153539867023937 Time :  229
accuracy train: 0.995937 val: 0.981818 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 17 test accuracy : 0.971233

Epoch :  18 loss training:  3.337231860263273 Time :  243
accuracy train: 0.996151 val: 0.978182 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 17 test accuracy : 0.971233

Epoch :  19 loss training:  2.7888415514607914 Time :  256
accuracy train: 0.995937 val: 0.980606 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 17 test accuracy : 0.971233

Epoch :  20 loss training:  3.1516430221381597 Time :  268
accuracy train: 0.995937 val: 0.980606 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 17 test accuracy : 0.971233

Epoch :  21 loss training:  3.0575939554255456 Time :  283
accuracy train: 0.995937 val: 0.981818 test: 0.968493
max validation accuracy : 0.981818 max acc epoch : 17 test accuracy : 0.971233

Epoch :  22 loss training:  2.454840423539281 Time :  300
accuracy train: 0.996151 val: 0.976970 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 17 test accuracy : 0.971233

Epoch :  23 loss training:  2.6009915323229507 Time :  313
accuracy train: 0.996578 val: 0.979394 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 17 test accuracy : 0.971233

Epoch :  24 loss training:  2.80913845289615 Time :  329
accuracy train: 0.997006 val: 0.978182 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 17 test accuracy : 0.971233

Epoch :  25 loss training:  2.034285058180103 Time :  341
accuracy train: 0.996364 val: 0.980606 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 17 test accuracy : 0.971233

Epoch :  26 loss training:  2.1098065742116887 Time :  355
accuracy train: 0.996364 val: 0.981818 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 17 test accuracy : 0.971233

Epoch :  27 loss training:  2.239906693052035 Time :  367
accuracy train: 0.996578 val: 0.978182 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 17 test accuracy : 0.971233

Epoch :  28 loss training:  2.292787870479515 Time :  381
accuracy train: 0.996578 val: 0.981818 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 17 test accuracy : 0.971233

Epoch :  29 loss training:  2.486796596684144 Time :  394
accuracy train: 0.996578 val: 0.981818 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 17 test accuracy : 0.971233

Epoch :  30 loss training:  2.1273800683411537 Time :  407
accuracy train: 0.996578 val: 0.980606 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 17 test accuracy : 0.971233

Epoch :  31 loss training:  1.9756375060460414 Time :  420
accuracy train: 0.997006 val: 0.979394 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 17 test accuracy : 0.971233

Epoch :  32 loss training:  1.7180587722396012 Time :  433
accuracy train: 0.996578 val: 0.980606 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 17 test accuracy : 0.971233

Epoch :  33 loss training:  2.0618222157645505 Time :  447
accuracy train: 0.997220 val: 0.980606 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 17 test accuracy : 0.971233

Epoch :  34 loss training:  1.634862116043223 Time :  459
accuracy train: 0.997006 val: 0.981818 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 17 test accuracy : 0.971233

Epoch :  35 loss training:  1.760427331464598 Time :  474
accuracy train: 0.997434 val: 0.981818 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 17 test accuracy : 0.971233

Epoch :  36 loss training:  1.7333767001255183 Time :  486
accuracy train: 0.997006 val: 0.981818 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 17 test accuracy : 0.971233

Epoch :  37 loss training:  1.483181908428378 Time :  501
accuracy train: 0.996792 val: 0.979394 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 17 test accuracy : 0.971233

Epoch :  38 loss training:  1.8732626900964533 Time :  514
accuracy train: 0.997220 val: 0.978182 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 17 test accuracy : 0.971233

Epoch :  39 loss training:  1.5593873279794934 Time :  527
accuracy train: 0.997648 val: 0.981818 test: 0.975799
max validation accuracy : 0.981818 max acc epoch : 17 test accuracy : 0.971233

Epoch :  40 loss training:  1.6419363627355779 Time :  539
accuracy train: 0.996792 val: 0.980606 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 17 test accuracy : 0.971233

Epoch :  41 loss training:  2.160021999567107 Time :  552
accuracy train: 0.997006 val: 0.983030 test: 0.972146
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  42 loss training:  1.7211544083038461 Time :  565
accuracy train: 0.997220 val: 0.976970 test: 0.972603
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  43 loss training:  1.3397510221548146 Time :  578
accuracy train: 0.997006 val: 0.981818 test: 0.970320
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  44 loss training:  1.5330040993430885 Time :  591
accuracy train: 0.997006 val: 0.980606 test: 0.968493
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  45 loss training:  1.6361802247993182 Time :  603
accuracy train: 0.997220 val: 0.978182 test: 0.971233
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  46 loss training:  1.6070384330832894 Time :  617
accuracy train: 0.997006 val: 0.981818 test: 0.973059
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  47 loss training:  1.4362743862875504 Time :  629
accuracy train: 0.997006 val: 0.978182 test: 0.971689
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  48 loss training:  1.2343353691976517 Time :  643
accuracy train: 0.997220 val: 0.983030 test: 0.973516
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  49 loss training:  1.4717209670743614 Time :  656
accuracy train: 0.997006 val: 0.981818 test: 0.969863
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  50 loss training:  1.3634160203837382 Time :  676
accuracy train: 0.996578 val: 0.980606 test: 0.971689
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  51 loss training:  1.5523543537710793 Time :  687
accuracy train: 0.997220 val: 0.981818 test: 0.970776
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  52 loss training:  1.358360168436775 Time :  700
accuracy train: 0.997648 val: 0.980606 test: 0.973059
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  53 loss training:  1.2469894723278685 Time :  712
accuracy train: 0.997648 val: 0.983030 test: 0.969863
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  54 loss training:  1.4141946252075286 Time :  726
accuracy train: 0.997648 val: 0.979394 test: 0.970776
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  55 loss training:  1.1952460368411266 Time :  738
accuracy train: 0.997006 val: 0.981818 test: 0.973516
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  56 loss training:  1.15262170425558 Time :  752
accuracy train: 0.997006 val: 0.979394 test: 0.971689
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  57 loss training:  1.5630130424369781 Time :  765
accuracy train: 0.997006 val: 0.981818 test: 0.971233
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  58 loss training:  1.37790498560571 Time :  778
accuracy train: 0.997220 val: 0.974545 test: 0.973516
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  59 loss training:  1.3526333994414017 Time :  791
accuracy train: 0.997220 val: 0.978182 test: 0.971233
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  60 loss training:  1.438702493578603 Time :  804
accuracy train: 0.997648 val: 0.976970 test: 0.970776
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  61 loss training:  1.3470260073900135 Time :  817
accuracy train: 0.996792 val: 0.974545 test: 0.969863
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  62 loss training:  1.5860798695885023 Time :  830
accuracy train: 0.997006 val: 0.978182 test: 0.971233
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  63 loss training:  1.2512408046995915 Time :  842
accuracy train: 0.997220 val: 0.979394 test: 0.971689
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  64 loss training:  1.2569992146309232 Time :  855
accuracy train: 0.997220 val: 0.979394 test: 0.969863
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  65 loss training:  1.4048843019336346 Time :  868
accuracy train: 0.997648 val: 0.979394 test: 0.968950
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  66 loss training:  1.221342437525891 Time :  880
accuracy train: 0.997220 val: 0.976970 test: 0.971233
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  67 loss training:  1.2858974864439006 Time :  893
accuracy train: 0.997648 val: 0.980606 test: 0.970320
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  68 loss training:  1.3549911083609913 Time :  904
accuracy train: 0.997648 val: 0.976970 test: 0.968037
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  69 loss training:  1.2590921535684174 Time :  916
accuracy train: 0.997006 val: 0.976970 test: 0.972146
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  70 loss training:  1.1284385025919619 Time :  927
accuracy train: 0.997006 val: 0.976970 test: 0.966667
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  71 loss training:  0.9313305234136351 Time :  939
accuracy train: 0.997006 val: 0.976970 test: 0.972146
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

Epoch :  72 loss training:  1.280223315641706 Time :  951
accuracy train: 0.997648 val: 0.978182 test: 0.969863
max validation accuracy : 0.983030 max acc epoch : 41 test accuracy : 0.972146

========================================================================================================================================================================================================
best acc epoch :  41
validation accuracy :  0.983030303030303
test accuracy :  0.9721461187214612
last test_accuracy :  0.9698630136986301
second best val :  0.9818181818181818
second best test :  0.9712328767123287
max gap 24
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=542, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  41.665934804826975 Time :  964
accuracy train: 0.964927 val: 0.970909 test: 0.962557
max validation accuracy : 0.970909 max acc epoch : 1 test accuracy : 0.962557
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.989314068108797 Time :  975
accuracy train: 0.969204 val: 0.962424 test: 0.957078
max validation accuracy : 0.970909 max acc epoch : 1 test accuracy : 0.962557
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.666263519786298 Time :  986
accuracy train: 0.970915 val: 0.961212 test: 0.960731
max validation accuracy : 0.970909 max acc epoch : 1 test accuracy : 0.962557
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.414947029668838 Time :  997
accuracy train: 0.985244 val: 0.975758 test: 0.962100
max validation accuracy : 0.975758 max acc epoch : 4 test accuracy : 0.962100
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.056174432393163 Time :  1008
accuracy train: 0.988879 val: 0.978182 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 5 test accuracy : 0.969863
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.813594327075407 Time :  1020
accuracy train: 0.986955 val: 0.967273 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 5 test accuracy : 0.969863
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  8.127555867424235 Time :  1030
accuracy train: 0.991232 val: 0.979394 test: 0.964840
max validation accuracy : 0.979394 max acc epoch : 7 test accuracy : 0.964840
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.950833097100258 Time :  1041
accuracy train: 0.992087 val: 0.980606 test: 0.968037
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.968037
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.993602585513145 Time :  1052
accuracy train: 0.992943 val: 0.975758 test: 0.960731
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.968037
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.666347767459229 Time :  1063
accuracy train: 0.993157 val: 0.979394 test: 0.961187
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.968037

Epoch :  11 loss training:  4.720026138049434 Time :  1075
accuracy train: 0.994012 val: 0.978182 test: 0.963014
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.968037

Epoch :  12 loss training:  4.865459366701543 Time :  1086
accuracy train: 0.994226 val: 0.980606 test: 0.965297
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.968037

Epoch :  13 loss training:  4.205115615040995 Time :  1098
accuracy train: 0.995081 val: 0.979394 test: 0.962557
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.968037

Epoch :  14 loss training:  4.386462289956398 Time :  1111
accuracy train: 0.994654 val: 0.975758 test: 0.963927
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.968037

Epoch :  15 loss training:  4.282638203061651 Time :  1122
accuracy train: 0.994654 val: 0.976970 test: 0.963014
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.968037

Epoch :  16 loss training:  4.216060871141963 Time :  1133
accuracy train: 0.994654 val: 0.979394 test: 0.961644
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.968037

Epoch :  17 loss training:  3.8580812531290576 Time :  1145
accuracy train: 0.995509 val: 0.979394 test: 0.963014
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.968037

Epoch :  18 loss training:  3.343089743691962 Time :  1157
accuracy train: 0.995509 val: 0.978182 test: 0.961644
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.968037

Epoch :  19 loss training:  3.101098081213422 Time :  1169
accuracy train: 0.995723 val: 0.976970 test: 0.964384
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.968037

Epoch :  20 loss training:  2.896571651333943 Time :  1181
accuracy train: 0.995937 val: 0.975758 test: 0.966210
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.968037

Epoch :  21 loss training:  2.9584185520070605 Time :  1192
accuracy train: 0.996151 val: 0.978182 test: 0.963470
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.968037

Epoch :  22 loss training:  3.1688224964309484 Time :  1203
accuracy train: 0.995937 val: 0.976970 test: 0.962557
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.968037

Epoch :  23 loss training:  2.7354704264726024 Time :  1214
accuracy train: 0.996151 val: 0.975758 test: 0.966667
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.968037

Epoch :  24 loss training:  2.5790976734715514 Time :  1226
accuracy train: 0.996364 val: 0.975758 test: 0.966210
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.968037

Epoch :  25 loss training:  2.4409189659636468 Time :  1238
accuracy train: 0.996151 val: 0.976970 test: 0.961644
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.968037

Epoch :  26 loss training:  2.374181973747909 Time :  1250
accuracy train: 0.996364 val: 0.980606 test: 0.962557
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.968037

Epoch :  27 loss training:  2.556134106576792 Time :  1262
accuracy train: 0.995937 val: 0.980606 test: 0.962100
max validation accuracy : 0.980606 max acc epoch : 8 test accuracy : 0.968037

Epoch :  28 loss training:  1.9271880976157263 Time :  1274
accuracy train: 0.996578 val: 0.981818 test: 0.964840
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  29 loss training:  2.191952001681784 Time :  1287
accuracy train: 0.996364 val: 0.976970 test: 0.964384
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  30 loss training:  2.039305081576458 Time :  1299
accuracy train: 0.996151 val: 0.976970 test: 0.963014
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  31 loss training:  2.153408848447725 Time :  1311
accuracy train: 0.996364 val: 0.976970 test: 0.962557
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  32 loss training:  1.8350047458225163 Time :  1323
accuracy train: 0.997006 val: 0.978182 test: 0.961187
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  33 loss training:  2.2792725772596896 Time :  1336
accuracy train: 0.996792 val: 0.976970 test: 0.962557
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  34 loss training:  1.9994438877038192 Time :  1348
accuracy train: 0.996578 val: 0.976970 test: 0.963470
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  35 loss training:  1.7029291688668309 Time :  1360
accuracy train: 0.996578 val: 0.980606 test: 0.964840
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  36 loss training:  1.7788066015418735 Time :  1372
accuracy train: 0.996792 val: 0.980606 test: 0.961644
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  37 loss training:  1.800893775987788 Time :  1384
accuracy train: 0.997220 val: 0.980606 test: 0.968037
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  38 loss training:  2.1244846906192834 Time :  1394
accuracy train: 0.997220 val: 0.978182 test: 0.963470
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  39 loss training:  1.9597699049118091 Time :  1406
accuracy train: 0.997434 val: 0.979394 test: 0.966210
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  40 loss training:  1.724483335208788 Time :  1417
accuracy train: 0.996792 val: 0.976970 test: 0.965297
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  41 loss training:  1.765701871663623 Time :  1428
accuracy train: 0.996792 val: 0.976970 test: 0.966210
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  42 loss training:  1.8160355227664695 Time :  1439
accuracy train: 0.997006 val: 0.974545 test: 0.965753
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  43 loss training:  1.9145193537333398 Time :  1449
accuracy train: 0.997006 val: 0.976970 test: 0.967123
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  44 loss training:  1.8344520303871832 Time :  1459
accuracy train: 0.996578 val: 0.976970 test: 0.968037
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  45 loss training:  1.907671103181201 Time :  1469
accuracy train: 0.996792 val: 0.974545 test: 0.964840
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  46 loss training:  1.7552736684519914 Time :  1479
accuracy train: 0.997006 val: 0.972121 test: 0.965297
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  47 loss training:  1.5138633519600262 Time :  1489
accuracy train: 0.996792 val: 0.975758 test: 0.964840
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  48 loss training:  1.5981233196507674 Time :  1499
accuracy train: 0.996792 val: 0.975758 test: 0.965753
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  49 loss training:  1.4907512340159883 Time :  1509
accuracy train: 0.997006 val: 0.972121 test: 0.964840
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  50 loss training:  1.8331301386824634 Time :  1520
accuracy train: 0.997006 val: 0.976970 test: 0.965297
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  51 loss training:  1.7875266864793957 Time :  1530
accuracy train: 0.997006 val: 0.972121 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  52 loss training:  1.431623040316481 Time :  1540
accuracy train: 0.996364 val: 0.976970 test: 0.965753
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  53 loss training:  1.8374362212725828 Time :  1550
accuracy train: 0.997006 val: 0.975758 test: 0.964384
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  54 loss training:  1.4679643518757075 Time :  1560
accuracy train: 0.997006 val: 0.973333 test: 0.966667
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  55 loss training:  1.400865964267723 Time :  1570
accuracy train: 0.997434 val: 0.978182 test: 0.967580
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  56 loss training:  1.5299339565535774 Time :  1580
accuracy train: 0.996792 val: 0.972121 test: 0.964840
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  57 loss training:  1.58828220318901 Time :  1590
accuracy train: 0.997006 val: 0.974545 test: 0.963014
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  58 loss training:  1.175516561484983 Time :  1600
accuracy train: 0.996578 val: 0.968485 test: 0.964840
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

Epoch :  59 loss training:  1.557926165823119 Time :  1610
accuracy train: 0.996792 val: 0.969697 test: 0.963014
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.964840

========================================================================================================================================================================================================
best acc epoch :  28
validation accuracy :  0.9818181818181818
test accuracy :  0.9648401826484019
last test_accuracy :  0.963013698630137
second best val :  0.9806060606060606
second best test :  0.9680365296803652
max gap 20
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  41 	 val_accuracy : 0.98303 	 test_accuracy : 0.97215 	 last test_accuracy : 0.96986 	 second best val : 0.98182 	 second best test : 0.97123
k :  1 	 best_acc epoch :  28 	 val_accuracy : 0.98182 	 test_accuracy : 0.96484 	 last test_accuracy : 0.96301 	 second best val : 0.98061 	 second best test : 0.96804

avg :  	 val_accuracy : 0.98242 	 test_accuracy : 0.96849 	 last_accuracy : 0.96644 	 second best val : 0.98121 	 second best test : 0.96963

std :  	 val_accuracy : 0.00061 	 test_accuracy : 0.00365 	 last_accuracy : 0.00342 	 second best val : 0.00061 	 second best test : 0.00160


date and time :  Fri Jun 18 17:15:03 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=400, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  38.35763546824455 Time :  15
accuracy train: 0.959581 val: 0.952727 test: 0.947032
max validation accuracy : 0.952727 max acc epoch : 1 test accuracy : 0.947032
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.235773902386427 Time :  29
accuracy train: 0.965997 val: 0.953939 test: 0.955251
max validation accuracy : 0.953939 max acc epoch : 2 test accuracy : 0.955251
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.458010459318757 Time :  43
accuracy train: 0.971557 val: 0.970909 test: 0.963470
max validation accuracy : 0.970909 max acc epoch : 3 test accuracy : 0.963470
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.294965469511226 Time :  58
accuracy train: 0.976689 val: 0.967273 test: 0.967580
max validation accuracy : 0.970909 max acc epoch : 3 test accuracy : 0.963470
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.876664706273004 Time :  72
accuracy train: 0.982891 val: 0.967273 test: 0.970320
max validation accuracy : 0.970909 max acc epoch : 3 test accuracy : 0.963470
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.467191206524149 Time :  86
accuracy train: 0.987169 val: 0.969697 test: 0.963927
max validation accuracy : 0.970909 max acc epoch : 3 test accuracy : 0.963470
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.921696076635271 Time :  101
accuracy train: 0.989521 val: 0.976970 test: 0.968037
max validation accuracy : 0.976970 max acc epoch : 7 test accuracy : 0.968037
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.197297832462937 Time :  115
accuracy train: 0.989949 val: 0.979394 test: 0.968493
max validation accuracy : 0.979394 max acc epoch : 8 test accuracy : 0.968493
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.039409540127963 Time :  130
accuracy train: 0.992943 val: 0.976970 test: 0.963014
max validation accuracy : 0.979394 max acc epoch : 8 test accuracy : 0.968493
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  4.933393585844897 Time :  144
accuracy train: 0.992729 val: 0.975758 test: 0.966210
max validation accuracy : 0.979394 max acc epoch : 8 test accuracy : 0.968493

Epoch :  11 loss training:  4.993282144190744 Time :  159
accuracy train: 0.992729 val: 0.976970 test: 0.967123
max validation accuracy : 0.979394 max acc epoch : 8 test accuracy : 0.968493

Epoch :  12 loss training:  4.6669428097084165 Time :  175
accuracy train: 0.993157 val: 0.976970 test: 0.971233
max validation accuracy : 0.979394 max acc epoch : 8 test accuracy : 0.968493

Epoch :  13 loss training:  4.288479590264615 Time :  190
accuracy train: 0.993798 val: 0.976970 test: 0.971233
max validation accuracy : 0.979394 max acc epoch : 8 test accuracy : 0.968493

Epoch :  14 loss training:  4.194930782192387 Time :  205
accuracy train: 0.993370 val: 0.980606 test: 0.972146
max validation accuracy : 0.980606 max acc epoch : 14 test accuracy : 0.972146

Epoch :  15 loss training:  3.723329367581755 Time :  220
accuracy train: 0.994440 val: 0.979394 test: 0.970320
max validation accuracy : 0.980606 max acc epoch : 14 test accuracy : 0.972146

Epoch :  16 loss training:  3.8082147180102766 Time :  235
accuracy train: 0.995295 val: 0.981818 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  17 loss training:  3.5858009867952205 Time :  251
accuracy train: 0.995723 val: 0.979394 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  18 loss training:  3.125374146969989 Time :  266
accuracy train: 0.995723 val: 0.979394 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  19 loss training:  3.23833080654731 Time :  281
accuracy train: 0.995723 val: 0.974545 test: 0.966667
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  20 loss training:  3.2913730820873752 Time :  296
accuracy train: 0.995081 val: 0.976970 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  21 loss training:  3.0522417222964577 Time :  311
accuracy train: 0.995295 val: 0.980606 test: 0.967123
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  22 loss training:  3.2107783489336725 Time :  326
accuracy train: 0.995937 val: 0.974545 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  23 loss training:  2.764890856575221 Time :  341
accuracy train: 0.995937 val: 0.976970 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  24 loss training:  2.492669305356685 Time :  356
accuracy train: 0.996364 val: 0.978182 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  25 loss training:  2.794878092012368 Time :  371
accuracy train: 0.996364 val: 0.976970 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  26 loss training:  2.6614615078724455 Time :  386
accuracy train: 0.996578 val: 0.979394 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  27 loss training:  2.5885339722735807 Time :  401
accuracy train: 0.995081 val: 0.975758 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  28 loss training:  1.8321259951917455 Time :  416
accuracy train: 0.995937 val: 0.980606 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  29 loss training:  2.387479493074352 Time :  431
accuracy train: 0.996578 val: 0.979394 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  30 loss training:  2.1175328476419963 Time :  446
accuracy train: 0.996578 val: 0.979394 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  31 loss training:  1.7305594742210815 Time :  461
accuracy train: 0.997220 val: 0.978182 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  32 loss training:  1.9773284730035812 Time :  476
accuracy train: 0.997006 val: 0.974545 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  33 loss training:  2.075358218222391 Time :  491
accuracy train: 0.996792 val: 0.980606 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  34 loss training:  2.036024170156452 Time :  506
accuracy train: 0.997220 val: 0.974545 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  35 loss training:  2.369846827990841 Time :  521
accuracy train: 0.996364 val: 0.975758 test: 0.967123
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  36 loss training:  2.2913239038316533 Time :  536
accuracy train: 0.997434 val: 0.975758 test: 0.968493
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  37 loss training:  1.8612958447483834 Time :  551
accuracy train: 0.997220 val: 0.975758 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  38 loss training:  1.9383783821103862 Time :  566
accuracy train: 0.997434 val: 0.976970 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  39 loss training:  1.6222023466980318 Time :  581
accuracy train: 0.997434 val: 0.973333 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  40 loss training:  1.6118884652896668 Time :  596
accuracy train: 0.997434 val: 0.978182 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  41 loss training:  1.5246167128207162 Time :  611
accuracy train: 0.997220 val: 0.980606 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  42 loss training:  1.9509812889955356 Time :  626
accuracy train: 0.997434 val: 0.976970 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  43 loss training:  1.6780015149270184 Time :  641
accuracy train: 0.997220 val: 0.979394 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  44 loss training:  1.6978304433941958 Time :  656
accuracy train: 0.997434 val: 0.978182 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.968950

Epoch :  45 loss training:  1.884044227299455 Time :  671
accuracy train: 0.996578 val: 0.983030 test: 0.968493
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  46 loss training:  1.4885466136329342 Time :  686
accuracy train: 0.997648 val: 0.976970 test: 0.974886
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  47 loss training:  1.3044236833666218 Time :  701
accuracy train: 0.997006 val: 0.980606 test: 0.971689
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  48 loss training:  1.2623728002909047 Time :  716
accuracy train: 0.997434 val: 0.978182 test: 0.971233
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  49 loss training:  1.422831581250648 Time :  731
accuracy train: 0.997220 val: 0.979394 test: 0.969863
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  50 loss training:  1.7828424432154861 Time :  746
accuracy train: 0.997006 val: 0.974545 test: 0.967123
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  51 loss training:  1.7357002919652587 Time :  761
accuracy train: 0.997434 val: 0.974545 test: 0.967123
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  52 loss training:  1.4363205725885564 Time :  776
accuracy train: 0.997220 val: 0.978182 test: 0.971233
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  53 loss training:  1.3528534582874272 Time :  791
accuracy train: 0.996792 val: 0.974545 test: 0.973973
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  54 loss training:  1.5321376726569724 Time :  806
accuracy train: 0.997006 val: 0.980606 test: 0.972146
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  55 loss training:  1.6365295936084294 Time :  821
accuracy train: 0.997434 val: 0.979394 test: 0.971689
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  56 loss training:  1.3563300146597612 Time :  836
accuracy train: 0.997220 val: 0.978182 test: 0.972603
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  57 loss training:  1.2907426620186015 Time :  851
accuracy train: 0.997434 val: 0.976970 test: 0.973973
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  58 loss training:  1.3829782809370954 Time :  866
accuracy train: 0.997434 val: 0.976970 test: 0.970776
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  59 loss training:  1.25049503592345 Time :  881
accuracy train: 0.997648 val: 0.978182 test: 0.973516
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  60 loss training:  1.4475396628695307 Time :  896
accuracy train: 0.997220 val: 0.979394 test: 0.974429
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  61 loss training:  1.5561802081174392 Time :  911
accuracy train: 0.997434 val: 0.983030 test: 0.971233
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  62 loss training:  1.3676049905352556 Time :  926
accuracy train: 0.997434 val: 0.970909 test: 0.969863
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  63 loss training:  1.4387840733434132 Time :  941
accuracy train: 0.997220 val: 0.974545 test: 0.973059
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  64 loss training:  1.242175175641023 Time :  956
accuracy train: 0.997220 val: 0.980606 test: 0.972146
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  65 loss training:  1.2472548117057158 Time :  971
accuracy train: 0.997220 val: 0.978182 test: 0.972146
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  66 loss training:  1.306370235144641 Time :  986
accuracy train: 0.997434 val: 0.980606 test: 0.975342
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  67 loss training:  1.2346366120655148 Time :  1001
accuracy train: 0.997220 val: 0.983030 test: 0.975342
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  68 loss training:  1.4826760994856159 Time :  1016
accuracy train: 0.997220 val: 0.978182 test: 0.973973
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  69 loss training:  1.7588829924700349 Time :  1031
accuracy train: 0.997434 val: 0.975758 test: 0.972603
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  70 loss training:  1.4246975877686054 Time :  1046
accuracy train: 0.997434 val: 0.978182 test: 0.973059
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  71 loss training:  1.4452726500239805 Time :  1061
accuracy train: 0.997220 val: 0.976970 test: 0.973059
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  72 loss training:  0.9451358494125088 Time :  1076
accuracy train: 0.997006 val: 0.978182 test: 0.973516
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  73 loss training:  1.258146999431574 Time :  1091
accuracy train: 0.997006 val: 0.980606 test: 0.973059
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  74 loss training:  1.195265648426357 Time :  1106
accuracy train: 0.997220 val: 0.980606 test: 0.974429
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  75 loss training:  1.39485035549842 Time :  1121
accuracy train: 0.997434 val: 0.979394 test: 0.973973
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

Epoch :  76 loss training:  1.1457344159853164 Time :  1136
accuracy train: 0.997434 val: 0.979394 test: 0.973516
max validation accuracy : 0.983030 max acc epoch : 45 test accuracy : 0.968493

========================================================================================================================================================================================================
best acc epoch :  45
validation accuracy :  0.983030303030303
test accuracy :  0.9684931506849315
last test_accuracy :  0.9735159817351599
second best val :  0.9818181818181818
second best test :  0.9689497716894977
max gap 29
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=698, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  37.79797297157347 Time :  1152
accuracy train: 0.965355 val: 0.972121 test: 0.961644
max validation accuracy : 0.972121 max acc epoch : 1 test accuracy : 0.961644
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.894483586773276 Time :  1166
accuracy train: 0.956587 val: 0.952727 test: 0.963014
max validation accuracy : 0.972121 max acc epoch : 1 test accuracy : 0.961644
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.420311449328437 Time :  1181
accuracy train: 0.970701 val: 0.973333 test: 0.967123
max validation accuracy : 0.973333 max acc epoch : 3 test accuracy : 0.967123
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.942905050236732 Time :  1195
accuracy train: 0.984602 val: 0.974545 test: 0.963014
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.963014
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.707100912928581 Time :  1209
accuracy train: 0.981822 val: 0.967273 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.963014
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.365834493888542 Time :  1224
accuracy train: 0.989735 val: 0.981818 test: 0.967123
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.967123
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.998863067710772 Time :  1238
accuracy train: 0.985885 val: 0.983030 test: 0.974886
max validation accuracy : 0.983030 max acc epoch : 7 test accuracy : 0.974886
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  7.000808137236163 Time :  1253
accuracy train: 0.991446 val: 0.979394 test: 0.969863
max validation accuracy : 0.983030 max acc epoch : 7 test accuracy : 0.974886
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.889240941265598 Time :  1267
accuracy train: 0.990590 val: 0.978182 test: 0.974886
max validation accuracy : 0.983030 max acc epoch : 7 test accuracy : 0.974886
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.444234955881257 Time :  1280
accuracy train: 0.991018 val: 0.979394 test: 0.972603
max validation accuracy : 0.983030 max acc epoch : 7 test accuracy : 0.974886

Epoch :  11 loss training:  5.135693378048018 Time :  1295
accuracy train: 0.991660 val: 0.976970 test: 0.967123
max validation accuracy : 0.983030 max acc epoch : 7 test accuracy : 0.974886

Epoch :  12 loss training:  5.254363525775261 Time :  1310
accuracy train: 0.992729 val: 0.978182 test: 0.968950
max validation accuracy : 0.983030 max acc epoch : 7 test accuracy : 0.974886

Epoch :  13 loss training:  4.957915439037606 Time :  1325
accuracy train: 0.992515 val: 0.980606 test: 0.973059
max validation accuracy : 0.983030 max acc epoch : 7 test accuracy : 0.974886

Epoch :  14 loss training:  4.650067628012039 Time :  1340
accuracy train: 0.993798 val: 0.981818 test: 0.968493
max validation accuracy : 0.983030 max acc epoch : 7 test accuracy : 0.974886

Epoch :  15 loss training:  4.3186700346414 Time :  1354
accuracy train: 0.994012 val: 0.981818 test: 0.967580
max validation accuracy : 0.983030 max acc epoch : 7 test accuracy : 0.974886

Epoch :  16 loss training:  4.25464819688932 Time :  1369
accuracy train: 0.993584 val: 0.980606 test: 0.968950
max validation accuracy : 0.983030 max acc epoch : 7 test accuracy : 0.974886

Epoch :  17 loss training:  3.8660412231474766 Time :  1383
accuracy train: 0.994012 val: 0.983030 test: 0.969406
max validation accuracy : 0.983030 max acc epoch : 7 test accuracy : 0.974886

Epoch :  18 loss training:  3.9154066481860355 Time :  1397
accuracy train: 0.994867 val: 0.980606 test: 0.968493
max validation accuracy : 0.983030 max acc epoch : 7 test accuracy : 0.974886

Epoch :  19 loss training:  3.936458566458896 Time :  1411
accuracy train: 0.995509 val: 0.981818 test: 0.968037
max validation accuracy : 0.983030 max acc epoch : 7 test accuracy : 0.974886

Epoch :  20 loss training:  3.66004126923508 Time :  1424
accuracy train: 0.995509 val: 0.984242 test: 0.968493
max validation accuracy : 0.984242 max acc epoch : 20 test accuracy : 0.968493

Epoch :  21 loss training:  3.2273629995179363 Time :  1437
accuracy train: 0.995081 val: 0.984242 test: 0.969406
max validation accuracy : 0.984242 max acc epoch : 20 test accuracy : 0.968493

Epoch :  22 loss training:  3.0551385611179285 Time :  1450
accuracy train: 0.995295 val: 0.985455 test: 0.968950
max validation accuracy : 0.985455 max acc epoch : 22 test accuracy : 0.968950

Epoch :  23 loss training:  2.967342346062651 Time :  1463
accuracy train: 0.994867 val: 0.986667 test: 0.971689
max validation accuracy : 0.986667 max acc epoch : 23 test accuracy : 0.971689

Epoch :  24 loss training:  2.960604649997549 Time :  1475
accuracy train: 0.994440 val: 0.986667 test: 0.970320
max validation accuracy : 0.986667 max acc epoch : 23 test accuracy : 0.971689

Epoch :  25 loss training:  2.8596879100077786 Time :  1488
accuracy train: 0.995081 val: 0.986667 test: 0.967580
max validation accuracy : 0.986667 max acc epoch : 23 test accuracy : 0.971689

Epoch :  26 loss training:  2.8103815455397125 Time :  1501
accuracy train: 0.995723 val: 0.987879 test: 0.969863
max validation accuracy : 0.987879 max acc epoch : 26 test accuracy : 0.969863

Epoch :  27 loss training:  2.696035392815247 Time :  1514
accuracy train: 0.995937 val: 0.986667 test: 0.968950
max validation accuracy : 0.987879 max acc epoch : 26 test accuracy : 0.969863

Epoch :  28 loss training:  2.6288726407219656 Time :  1527
accuracy train: 0.995295 val: 0.986667 test: 0.968950
max validation accuracy : 0.987879 max acc epoch : 26 test accuracy : 0.969863

Epoch :  29 loss training:  2.4703000714362133 Time :  1540
accuracy train: 0.996151 val: 0.986667 test: 0.968950
max validation accuracy : 0.987879 max acc epoch : 26 test accuracy : 0.969863

Epoch :  30 loss training:  2.058810602669837 Time :  1552
accuracy train: 0.995937 val: 0.986667 test: 0.965297
max validation accuracy : 0.987879 max acc epoch : 26 test accuracy : 0.969863

Epoch :  31 loss training:  2.11481899060891 Time :  1565
accuracy train: 0.995937 val: 0.986667 test: 0.968950
max validation accuracy : 0.987879 max acc epoch : 26 test accuracy : 0.969863

Epoch :  32 loss training:  2.791301874356577 Time :  1578
accuracy train: 0.994867 val: 0.985455 test: 0.970776
max validation accuracy : 0.987879 max acc epoch : 26 test accuracy : 0.969863

Epoch :  33 loss training:  2.4068364680570085 Time :  1591
accuracy train: 0.994867 val: 0.984242 test: 0.968950
max validation accuracy : 0.987879 max acc epoch : 26 test accuracy : 0.969863

Epoch :  34 loss training:  2.1437014914190513 Time :  1604
accuracy train: 0.995723 val: 0.990303 test: 0.971689
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  35 loss training:  2.1397752175689675 Time :  1617
accuracy train: 0.995723 val: 0.985455 test: 0.968037
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  36 loss training:  2.1910493948162184 Time :  1629
accuracy train: 0.995937 val: 0.986667 test: 0.968493
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  37 loss training:  1.9402375661738915 Time :  1642
accuracy train: 0.996364 val: 0.986667 test: 0.971233
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  38 loss training:  1.898224781267345 Time :  1655
accuracy train: 0.996792 val: 0.987879 test: 0.968493
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  39 loss training:  2.1214507763506845 Time :  1668
accuracy train: 0.996364 val: 0.989091 test: 0.968950
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  40 loss training:  1.7989325955968525 Time :  1681
accuracy train: 0.995937 val: 0.986667 test: 0.970320
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  41 loss training:  1.9325480918196263 Time :  1694
accuracy train: 0.996364 val: 0.983030 test: 0.973516
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  42 loss training:  1.9855347018747125 Time :  1706
accuracy train: 0.996792 val: 0.987879 test: 0.970776
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  43 loss training:  1.9318176453161868 Time :  1719
accuracy train: 0.995937 val: 0.987879 test: 0.972146
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  44 loss training:  1.9904921170382295 Time :  1732
accuracy train: 0.996364 val: 0.987879 test: 0.967123
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  45 loss training:  2.0731297475940664 Time :  1745
accuracy train: 0.996364 val: 0.985455 test: 0.966667
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  46 loss training:  2.0162178959071753 Time :  1757
accuracy train: 0.995723 val: 0.983030 test: 0.968950
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  47 loss training:  1.855080251560139 Time :  1770
accuracy train: 0.996578 val: 0.984242 test: 0.967580
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  48 loss training:  1.7988098365894984 Time :  1783
accuracy train: 0.996578 val: 0.984242 test: 0.968493
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  49 loss training:  1.71093818081863 Time :  1796
accuracy train: 0.996578 val: 0.979394 test: 0.967580
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  50 loss training:  2.2574277007879573 Time :  1809
accuracy train: 0.996364 val: 0.983030 test: 0.969406
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  51 loss training:  2.014405077556148 Time :  1822
accuracy train: 0.996792 val: 0.984242 test: 0.968950
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  52 loss training:  1.58397658917238 Time :  1835
accuracy train: 0.996151 val: 0.986667 test: 0.969406
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  53 loss training:  1.7233550458113314 Time :  1847
accuracy train: 0.996578 val: 0.987879 test: 0.972146
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  54 loss training:  1.4897209468254005 Time :  1860
accuracy train: 0.996364 val: 0.986667 test: 0.972146
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  55 loss training:  1.5656572217922076 Time :  1873
accuracy train: 0.996364 val: 0.987879 test: 0.969863
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  56 loss training:  1.7741060409025522 Time :  1886
accuracy train: 0.996578 val: 0.987879 test: 0.961187
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  57 loss training:  1.6819568018727296 Time :  1899
accuracy train: 0.996792 val: 0.985455 test: 0.969406
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  58 loss training:  1.790153445683245 Time :  1912
accuracy train: 0.996364 val: 0.985455 test: 0.970776
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  59 loss training:  1.7955769781256095 Time :  1925
accuracy train: 0.996364 val: 0.986667 test: 0.968493
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  60 loss training:  1.498556530848873 Time :  1937
accuracy train: 0.996578 val: 0.985455 test: 0.967580
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  61 loss training:  1.4740172912024718 Time :  1950
accuracy train: 0.996364 val: 0.986667 test: 0.971233
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  62 loss training:  1.6253597257600632 Time :  1963
accuracy train: 0.996151 val: 0.989091 test: 0.970776
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  63 loss training:  1.4832527380422107 Time :  1976
accuracy train: 0.996578 val: 0.987879 test: 0.968037
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  64 loss training:  1.6468231480030227 Time :  1989
accuracy train: 0.996364 val: 0.984242 test: 0.965297
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

Epoch :  65 loss training:  1.491772474721074 Time :  2002
accuracy train: 0.996151 val: 0.987879 test: 0.971689
max validation accuracy : 0.990303 max acc epoch : 34 test accuracy : 0.971689

========================================================================================================================================================================================================
best acc epoch :  34
validation accuracy :  0.9903030303030304
test accuracy :  0.971689497716895
last test_accuracy :  0.971689497716895
second best val :  0.9890909090909091
second best test :  0.971689497716895
max gap 13
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  45 	 val_accuracy : 0.98303 	 test_accuracy : 0.96849 	 last test_accuracy : 0.97352 	 second best val : 0.98182 	 second best test : 0.96895
k :  1 	 best_acc epoch :  34 	 val_accuracy : 0.99030 	 test_accuracy : 0.97169 	 last test_accuracy : 0.97169 	 second best val : 0.98909 	 second best test : 0.97169

avg :  	 val_accuracy : 0.98667 	 test_accuracy : 0.97009 	 last_accuracy : 0.97260 	 second best val : 0.98545 	 second best test : 0.97032

std :  	 val_accuracy : 0.00364 	 test_accuracy : 0.00160 	 last_accuracy : 0.00091 	 second best val : 0.00364 	 second best test : 0.00137


date and time :  Fri Jun 18 17:48:36 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=288, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 4721, 0: 2970})

Epoch :  1 loss training:  36.75724556669593 Time :  16
accuracy train: 0.951882 val: 0.932121 test: 0.945662
max validation accuracy : 0.932121 max acc epoch : 1 test accuracy : 0.945662
Counter({1: 3926, 0: 3765})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.57983327843249 Time :  35
accuracy train: 0.963644 val: 0.949091 test: 0.947032
max validation accuracy : 0.949091 max acc epoch : 2 test accuracy : 0.947032
Counter({1: 3850, 0: 3841})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  13.399539730744436 Time :  52
accuracy train: 0.969204 val: 0.940606 test: 0.961187
max validation accuracy : 0.949091 max acc epoch : 2 test accuracy : 0.947032
Counter({0: 3902, 1: 3789})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.63709515123628 Time :  69
accuracy train: 0.985885 val: 0.966061 test: 0.970776
max validation accuracy : 0.966061 max acc epoch : 4 test accuracy : 0.970776
Counter({1: 3866, 0: 3825})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.46296151005663 Time :  87
accuracy train: 0.985030 val: 0.968485 test: 0.968037
max validation accuracy : 0.968485 max acc epoch : 5 test accuracy : 0.968037
Counter({0: 3862, 1: 3829})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  7.221446342417039 Time :  103
accuracy train: 0.991018 val: 0.974545 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({1: 3875, 0: 3816})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.170902100158855 Time :  119
accuracy train: 0.992515 val: 0.968485 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({0: 3873, 1: 3818})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.7101897487882525 Time :  134
accuracy train: 0.990590 val: 0.964848 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({1: 3877, 0: 3814})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  4.8482435524929315 Time :  149
accuracy train: 0.992515 val: 0.966061 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({1: 3884, 0: 3807})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  4.469056495232508 Time :  164
accuracy train: 0.993157 val: 0.967273 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({0: 3884, 1: 3807})

Epoch :  11 loss training:  4.159250055265147 Time :  179
accuracy train: 0.994440 val: 0.969697 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({0: 3888, 1: 3803})

Epoch :  12 loss training:  4.010364391142502 Time :  195
accuracy train: 0.994654 val: 0.966061 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({1: 3893, 0: 3798})

Epoch :  13 loss training:  3.708169072982855 Time :  211
accuracy train: 0.994867 val: 0.967273 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({1: 3895, 0: 3796})

Epoch :  14 loss training:  3.513352138514165 Time :  226
accuracy train: 0.994867 val: 0.962424 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({0: 3894, 1: 3797})

Epoch :  15 loss training:  3.545410500926664 Time :  242
accuracy train: 0.994867 val: 0.966061 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({1: 3902, 0: 3789})

Epoch :  16 loss training:  2.8987876579049043 Time :  257
accuracy train: 0.995509 val: 0.966061 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({0: 3904, 1: 3787})

Epoch :  17 loss training:  2.8282118999632075 Time :  273
accuracy train: 0.994867 val: 0.963636 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({1: 3906, 0: 3785})

Epoch :  18 loss training:  2.8381923928682227 Time :  289
accuracy train: 0.995081 val: 0.966061 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({0: 3906, 1: 3785})

Epoch :  19 loss training:  2.8950923552329186 Time :  304
accuracy train: 0.995937 val: 0.966061 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({1: 3910, 0: 3781})

Epoch :  20 loss training:  2.3568168986967066 Time :  323
accuracy train: 0.996151 val: 0.966061 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({0: 3912, 1: 3779})

Epoch :  21 loss training:  2.437216768041253 Time :  342
accuracy train: 0.996151 val: 0.966061 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({1: 3920, 0: 3771})

Epoch :  22 loss training:  2.4221843225241173 Time :  360
accuracy train: 0.995937 val: 0.964848 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({0: 3920, 1: 3771})

Epoch :  23 loss training:  2.458187654163339 Time :  375
accuracy train: 0.996364 val: 0.966061 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({1: 3919, 0: 3772})

Epoch :  24 loss training:  2.094451052544173 Time :  391
accuracy train: 0.996364 val: 0.964848 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({0: 3917, 1: 3774})

Epoch :  25 loss training:  2.1474932900018757 Time :  407
accuracy train: 0.996364 val: 0.962424 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({1: 3919, 0: 3772})

Epoch :  26 loss training:  1.8464362261074712 Time :  423
accuracy train: 0.996578 val: 0.966061 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({1: 3917, 0: 3774})

Epoch :  27 loss training:  2.324924562126398 Time :  439
accuracy train: 0.996792 val: 0.963636 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({1: 3917, 0: 3774})

Epoch :  28 loss training:  2.196348368321196 Time :  454
accuracy train: 0.996578 val: 0.966061 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({0: 3915, 1: 3776})

Epoch :  29 loss training:  1.8402971576797427 Time :  470
accuracy train: 0.997006 val: 0.966061 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({1: 3916, 0: 3775})

Epoch :  30 loss training:  1.9126862527045887 Time :  486
accuracy train: 0.996151 val: 0.968485 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({0: 3916, 1: 3775})

Epoch :  31 loss training:  2.050949953001691 Time :  502
accuracy train: 0.997006 val: 0.966061 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({1: 3917, 0: 3774})

Epoch :  32 loss training:  1.7286190848608385 Time :  517
accuracy train: 0.997006 val: 0.962424 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({0: 3917, 1: 3774})

Epoch :  33 loss training:  1.5384854181684204 Time :  536
accuracy train: 0.996792 val: 0.964848 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({1: 3917, 0: 3774})

Epoch :  34 loss training:  1.6016420904634288 Time :  555
accuracy train: 0.997220 val: 0.964848 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({0: 3919, 1: 3772})

Epoch :  35 loss training:  1.6244919708260568 Time :  572
accuracy train: 0.996792 val: 0.960000 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({1: 3919, 0: 3772})

Epoch :  36 loss training:  1.7187680962088052 Time :  590
accuracy train: 0.997220 val: 0.963636 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({1: 3919, 0: 3772})

Epoch :  37 loss training:  1.7581102537478728 Time :  606
accuracy train: 0.997220 val: 0.963636 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.967580
Counter({1: 3919, 0: 3772})

========================================================================================================================================================================================================
best acc epoch :  6
validation accuracy :  0.9745454545454545
test accuracy :  0.9675799086757991
last test_accuracy :  0.9707762557077626
second best val :  0.9696969696969697
second best test :  0.9675799086757991
max gap 2
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=885, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 4721, 0: 2970})

Epoch :  1 loss training:  40.650513460859656 Time :  627
accuracy train: 0.967494 val: 0.952727 test: 0.961187
max validation accuracy : 0.952727 max acc epoch : 1 test accuracy : 0.961187
Counter({0: 3872, 1: 3819})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  16.57928085140884 Time :  643
accuracy train: 0.976048 val: 0.957576 test: 0.965753
max validation accuracy : 0.957576 max acc epoch : 2 test accuracy : 0.965753
Counter({0: 3857, 1: 3834})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.992164986208081 Time :  658
accuracy train: 0.981822 val: 0.968485 test: 0.963927
max validation accuracy : 0.968485 max acc epoch : 3 test accuracy : 0.963927
Counter({1: 3863, 0: 3828})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.084354648599401 Time :  677
accuracy train: 0.985672 val: 0.967273 test: 0.967123
max validation accuracy : 0.968485 max acc epoch : 3 test accuracy : 0.963927
Counter({0: 3898, 1: 3793})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.694724642671645 Time :  693
accuracy train: 0.989521 val: 0.967273 test: 0.966667
max validation accuracy : 0.968485 max acc epoch : 3 test accuracy : 0.963927
Counter({1: 3895, 0: 3796})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  6.7592381570721045 Time :  711
accuracy train: 0.987810 val: 0.961212 test: 0.969863
max validation accuracy : 0.968485 max acc epoch : 3 test accuracy : 0.963927
Counter({0: 3877, 1: 3814})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.201582504902035 Time :  729
accuracy train: 0.991232 val: 0.966061 test: 0.968493
max validation accuracy : 0.968485 max acc epoch : 3 test accuracy : 0.963927
Counter({1: 3912, 0: 3779})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.801792010781355 Time :  745
accuracy train: 0.991873 val: 0.967273 test: 0.973059
max validation accuracy : 0.968485 max acc epoch : 3 test accuracy : 0.963927
Counter({0: 3908, 1: 3783})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.528519359533675 Time :  762
accuracy train: 0.990376 val: 0.961212 test: 0.971233
max validation accuracy : 0.968485 max acc epoch : 3 test accuracy : 0.963927
Counter({0: 3893, 1: 3798})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  4.418806851725094 Time :  779
accuracy train: 0.993584 val: 0.964848 test: 0.972146
max validation accuracy : 0.968485 max acc epoch : 3 test accuracy : 0.963927
Counter({1: 3901, 0: 3790})

Epoch :  11 loss training:  3.8008969053043984 Time :  797
accuracy train: 0.993157 val: 0.969697 test: 0.973973
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({0: 3903, 1: 3788})

Epoch :  12 loss training:  3.5639265262288973 Time :  815
accuracy train: 0.994226 val: 0.967273 test: 0.971689
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({1: 3909, 0: 3782})

Epoch :  13 loss training:  3.6041147449286655 Time :  833
accuracy train: 0.995509 val: 0.968485 test: 0.972603
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({0: 3912, 1: 3779})

Epoch :  14 loss training:  5.038951302180067 Time :  850
accuracy train: 0.995295 val: 0.962424 test: 0.973516
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({1: 3919, 0: 3772})

Epoch :  15 loss training:  3.437755421618931 Time :  868
accuracy train: 0.995295 val: 0.962424 test: 0.971689
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({1: 3918, 0: 3773})

Epoch :  16 loss training:  2.7595367077738047 Time :  886
accuracy train: 0.995509 val: 0.957576 test: 0.971233
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({0: 3910, 1: 3781})

Epoch :  17 loss training:  2.8322570413001813 Time :  902
accuracy train: 0.996151 val: 0.963636 test: 0.973516
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({1: 3922, 0: 3769})

Epoch :  18 loss training:  2.7523721265024506 Time :  918
accuracy train: 0.995937 val: 0.964848 test: 0.972603
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({1: 3917, 0: 3774})

Epoch :  19 loss training:  2.5836386857845355 Time :  933
accuracy train: 0.995509 val: 0.962424 test: 0.973973
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({0: 3923, 1: 3768})

Epoch :  20 loss training:  2.5986404974828474 Time :  949
accuracy train: 0.995937 val: 0.968485 test: 0.974429
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({0: 3917, 1: 3774})

Epoch :  21 loss training:  2.7550584008713486 Time :  966
accuracy train: 0.996364 val: 0.961212 test: 0.973059
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({0: 3915, 1: 3776})

Epoch :  22 loss training:  2.2963205414707772 Time :  982
accuracy train: 0.996792 val: 0.966061 test: 0.974429
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({1: 3922, 0: 3769})

Epoch :  23 loss training:  2.102611590817105 Time :  1000
accuracy train: 0.996151 val: 0.969697 test: 0.973973
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({0: 3918, 1: 3773})

Epoch :  24 loss training:  2.149810907052597 Time :  1022
accuracy train: 0.996792 val: 0.961212 test: 0.973973
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({0: 3921, 1: 3770})

Epoch :  25 loss training:  2.2209580479975557 Time :  1039
accuracy train: 0.996792 val: 0.963636 test: 0.972146
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({0: 3921, 1: 3770})

Epoch :  26 loss training:  2.1197867799492087 Time :  1056
accuracy train: 0.997006 val: 0.966061 test: 0.971233
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({0: 3920, 1: 3771})

Epoch :  27 loss training:  1.9082130989991128 Time :  1072
accuracy train: 0.996578 val: 0.958788 test: 0.971689
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({1: 3920, 0: 3771})

Epoch :  28 loss training:  1.8836792695801705 Time :  1089
accuracy train: 0.996578 val: 0.960000 test: 0.970776
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({0: 3924, 1: 3767})

Epoch :  29 loss training:  1.7784313868614845 Time :  1106
accuracy train: 0.996792 val: 0.963636 test: 0.974429
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({0: 3923, 1: 3768})

Epoch :  30 loss training:  1.762483244368923 Time :  1123
accuracy train: 0.997220 val: 0.956364 test: 0.970776
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({0: 3916, 1: 3775})

Epoch :  31 loss training:  1.5246769320729072 Time :  1146
accuracy train: 0.997220 val: 0.963636 test: 0.974886
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({1: 3919, 0: 3772})

Epoch :  32 loss training:  1.4583006001957983 Time :  1162
accuracy train: 0.997220 val: 0.966061 test: 0.974886
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({0: 3920, 1: 3771})

Epoch :  33 loss training:  1.6033399996522348 Time :  1179
accuracy train: 0.997006 val: 0.962424 test: 0.971689
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({1: 3921, 0: 3770})

Epoch :  34 loss training:  1.4278335520793917 Time :  1195
accuracy train: 0.997220 val: 0.961212 test: 0.971689
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({0: 3921, 1: 3770})

Epoch :  35 loss training:  1.356125851998513 Time :  1212
accuracy train: 0.997220 val: 0.962424 test: 0.971689
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({0: 3921, 1: 3770})

Epoch :  36 loss training:  1.467288720443321 Time :  1228
accuracy train: 0.997006 val: 0.966061 test: 0.975342
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({1: 3921, 0: 3770})

Epoch :  37 loss training:  1.4101317521271994 Time :  1246
accuracy train: 0.997220 val: 0.961212 test: 0.974429
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({1: 3920, 0: 3771})

Epoch :  38 loss training:  1.9414214109492605 Time :  1263
accuracy train: 0.996792 val: 0.961212 test: 0.971233
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({1: 3921, 0: 3770})

Epoch :  39 loss training:  1.7863831423528609 Time :  1279
accuracy train: 0.997220 val: 0.961212 test: 0.973973
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({0: 3922, 1: 3769})

Epoch :  40 loss training:  1.3269554257640266 Time :  1296
accuracy train: 0.997220 val: 0.958788 test: 0.971689
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({1: 3920, 0: 3771})

Epoch :  41 loss training:  1.2713705305141048 Time :  1313
accuracy train: 0.997006 val: 0.964848 test: 0.972603
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({0: 3920, 1: 3771})

Epoch :  42 loss training:  1.290319086285308 Time :  1331
accuracy train: 0.997220 val: 0.963636 test: 0.972603
max validation accuracy : 0.969697 max acc epoch : 11 test accuracy : 0.973973
Counter({1: 3920, 0: 3771})

========================================================================================================================================================================================================
best acc epoch :  11
validation accuracy :  0.9696969696969697
test accuracy :  0.9739726027397261
last test_accuracy :  0.9726027397260274
second best val :  0.9684848484848485
second best test :  0.9639269406392694
max gap 8
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  6 	 val_accuracy : 0.97455 	 test_accuracy : 0.96758 	 last test_accuracy : 0.97078 	 second best val : 0.96970 	 second best test : 0.96758
k :  1 	 best_acc epoch :  11 	 val_accuracy : 0.96970 	 test_accuracy : 0.97397 	 last test_accuracy : 0.97260 	 second best val : 0.96848 	 second best test : 0.96393

avg :  	 val_accuracy : 0.97212 	 test_accuracy : 0.97078 	 last_accuracy : 0.97169 	 second best val : 0.96909 	 second best test : 0.96575

std :  	 val_accuracy : 0.00242 	 test_accuracy : 0.00320 	 last_accuracy : 0.00091 	 second best val : 0.00061 	 second best test : 0.00183
