

date and time :  Fri Jun 11 00:10:33 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=894, weight_decay=1e-10)
device :  cuda:0
min_len_of_sentence : 0
max_len_of_sentence : 40
min_num_of_sentence : 1
max_num_of_sentence : 12
average_len_of_sentence: 8.81713073818157
average_num_of_sentence: 1.3709435377977865
Total_num_of_sentence : 14617
Counter({'1': 5331, '0': 5331})
Total_number_of_words: 16658
Total_number_of_categories: 2
vocab size : 16658
got embeddings of : 15770

Epoch :  1 loss training:  103.02038782835007 Time :  86
accuracy train: 0.761644 val: 0.752113 test: 0.742544
max validation accuracy : 0.752113 max acc epoch : 1 test accuracy : 0.742544
Epoch-1 lr: 0.005

Epoch :  2 loss training:  84.66257959604263 Time :  97
accuracy train: 0.807127 val: 0.759155 test: 0.778841
max validation accuracy : 0.759155 max acc epoch : 2 test accuracy : 0.778841
Epoch-2 lr: 0.005

Epoch :  3 loss training:  85.50821559131145 Time :  110
accuracy train: 0.823695 val: 0.776056 test: 0.772932
max validation accuracy : 0.776056 max acc epoch : 3 test accuracy : 0.772932
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  71.55781564116478 Time :  122
accuracy train: 0.832291 val: 0.770423 test: 0.766179
max validation accuracy : 0.776056 max acc epoch : 3 test accuracy : 0.772932
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  68.76930505037308 Time :  132
accuracy train: 0.844014 val: 0.764789 test: 0.762802
max validation accuracy : 0.776056 max acc epoch : 3 test accuracy : 0.772932
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  63.379517287015915 Time :  143
accuracy train: 0.889340 val: 0.771831 test: 0.768430
max validation accuracy : 0.776056 max acc epoch : 3 test accuracy : 0.772932
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  56.58527213335037 Time :  156
accuracy train: 0.898249 val: 0.746479 test: 0.763084
max validation accuracy : 0.776056 max acc epoch : 3 test accuracy : 0.772932
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  52.7337916046381 Time :  165
accuracy train: 0.934198 val: 0.773239 test: 0.770400
max validation accuracy : 0.776056 max acc epoch : 3 test accuracy : 0.772932
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  48.564283058047295 Time :  180
accuracy train: 0.947640 val: 0.781690 test: 0.775183
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  43.32173704355955 Time :  197
accuracy train: 0.957643 val: 0.771831 test: 0.768430
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  11 loss training:  40.09235893934965 Time :  213
accuracy train: 0.973898 val: 0.767606 test: 0.771525
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  12 loss training:  32.770274206995964 Time :  224
accuracy train: 0.986089 val: 0.752113 test: 0.770962
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  13 loss training:  23.664374720305204 Time :  238
accuracy train: 0.990466 val: 0.770423 test: 0.774620
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  14 loss training:  17.968014812096953 Time :  251
accuracy train: 0.995624 val: 0.761972 test: 0.772088
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  15 loss training:  13.92407784704119 Time :  260
accuracy train: 0.998124 val: 0.763380 test: 0.769274
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  16 loss training:  11.530428582802415 Time :  273
accuracy train: 0.998437 val: 0.754930 test: 0.763647
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  17 loss training:  7.97656037285924 Time :  288
accuracy train: 0.999531 val: 0.757746 test: 0.761114
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  18 loss training:  7.294110232498497 Time :  298
accuracy train: 0.999062 val: 0.760563 test: 0.753517
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  19 loss training:  4.975673860870302 Time :  310
accuracy train: 0.999531 val: 0.761972 test: 0.752110
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  20 loss training:  4.473377775866538 Time :  325
accuracy train: 0.999531 val: 0.759155 test: 0.757456
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  21 loss training:  3.5340469719376415 Time :  336
accuracy train: 0.999687 val: 0.763380 test: 0.751266
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  22 loss training:  3.4084026449127123 Time :  348
accuracy train: 0.999687 val: 0.753521 test: 0.756894
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  23 loss training:  2.3114016702165827 Time :  360
accuracy train: 1.000000 val: 0.763380 test: 0.757175
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  24 loss training:  2.321804313804023 Time :  377
accuracy train: 0.999844 val: 0.757746 test: 0.748734
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  25 loss training:  1.9158282940043136 Time :  393
accuracy train: 1.000000 val: 0.777465 test: 0.754643
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  26 loss training:  1.6109574401343707 Time :  405
accuracy train: 1.000000 val: 0.767606 test: 0.752673
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  27 loss training:  1.3820770278689452 Time :  417
accuracy train: 1.000000 val: 0.754930 test: 0.750985
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  28 loss training:  1.6058101792586967 Time :  428
accuracy train: 1.000000 val: 0.767606 test: 0.747890
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  29 loss training:  1.2794919256411958 Time :  445
accuracy train: 1.000000 val: 0.769014 test: 0.748734
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  30 loss training:  1.1457481576071586 Time :  457
accuracy train: 1.000000 val: 0.769014 test: 0.750703
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  31 loss training:  0.7638435362896416 Time :  466
accuracy train: 1.000000 val: 0.763380 test: 0.748734
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  32 loss training:  0.7721388716454385 Time :  483
accuracy train: 1.000000 val: 0.774648 test: 0.753517
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  33 loss training:  0.5368349211348686 Time :  494
accuracy train: 1.000000 val: 0.760563 test: 0.746764
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  34 loss training:  1.0771825978008565 Time :  502
accuracy train: 1.000000 val: 0.754930 test: 0.747046
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  35 loss training:  0.5621527475814219 Time :  517
accuracy train: 1.000000 val: 0.749296 test: 0.750985
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  36 loss training:  0.6371333344795858 Time :  531
accuracy train: 1.000000 val: 0.754930 test: 0.745076
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  37 loss training:  0.6523699263780145 Time :  542
accuracy train: 1.000000 val: 0.752113 test: 0.745920
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  38 loss training:  0.6751458786820876 Time :  562
accuracy train: 1.000000 val: 0.757746 test: 0.744232
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  39 loss training:  0.6841820149984414 Time :  581
accuracy train: 1.000000 val: 0.767606 test: 0.748734
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

Epoch :  40 loss training:  0.6429009843159292 Time :  590
accuracy train: 1.000000 val: 0.757746 test: 0.750985
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.775183

========================================================================================================================================================================================================
max acc epoch :  9
max validation accuracy :  0.7816901408450704
test accuracy :  0.7751828925154756
last test_accuracy :  0.7509848058525604
max gap 6
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=894, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  103.89395126700401 Time :  603
accuracy train: 0.626915 val: 0.628169 test: 0.626055
max validation accuracy : 0.628169 max acc epoch : 1 test accuracy : 0.626055
Epoch-1 lr: 0.005

Epoch :  2 loss training:  87.61803504824638 Time :  616
accuracy train: 0.765239 val: 0.740845 test: 0.747046
max validation accuracy : 0.740845 max acc epoch : 2 test accuracy : 0.747046
Epoch-2 lr: 0.005

Epoch :  3 loss training:  98.4594476222992 Time :  626
accuracy train: 0.802751 val: 0.777465 test: 0.771244
max validation accuracy : 0.777465 max acc epoch : 3 test accuracy : 0.771244
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  77.81662438809872 Time :  639
accuracy train: 0.825102 val: 0.769014 test: 0.766460
max validation accuracy : 0.777465 max acc epoch : 3 test accuracy : 0.771244
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  76.70957489311695 Time :  652
accuracy train: 0.835574 val: 0.771831 test: 0.774620
max validation accuracy : 0.777465 max acc epoch : 3 test accuracy : 0.771244
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  74.89111632108688 Time :  667
accuracy train: 0.851985 val: 0.781690 test: 0.771244
max validation accuracy : 0.781690 max acc epoch : 6 test accuracy : 0.771244
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  69.00396320223808 Time :  680
accuracy train: 0.847296 val: 0.759155 test: 0.757456
max validation accuracy : 0.781690 max acc epoch : 6 test accuracy : 0.771244
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  68.28945003449917 Time :  691
accuracy train: 0.875742 val: 0.776056 test: 0.774339
max validation accuracy : 0.781690 max acc epoch : 6 test accuracy : 0.771244
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  64.10251988470554 Time :  706
accuracy train: 0.889028 val: 0.778873 test: 0.772651
max validation accuracy : 0.781690 max acc epoch : 6 test accuracy : 0.771244
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  59.60752047598362 Time :  716
accuracy train: 0.895123 val: 0.785915 test: 0.776308
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776308

Epoch :  11 loss training:  57.922537088394165 Time :  728
accuracy train: 0.926227 val: 0.791549 test: 0.773776
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  12 loss training:  48.218865379691124 Time :  753
accuracy train: 0.951547 val: 0.774648 test: 0.771806
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  13 loss training:  37.96467283368111 Time :  764
accuracy train: 0.969209 val: 0.773239 test: 0.770118
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  14 loss training:  29.548282202333212 Time :  774
accuracy train: 0.984370 val: 0.770423 test: 0.770681
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  15 loss training:  22.100315373390913 Time :  789
accuracy train: 0.992810 val: 0.760563 test: 0.768993
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  16 loss training:  17.13538070395589 Time :  799
accuracy train: 0.996405 val: 0.757746 test: 0.763084
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  17 loss training:  13.377036011777818 Time :  810
accuracy train: 0.997812 val: 0.753521 test: 0.760270
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  18 loss training:  10.36113471724093 Time :  824
accuracy train: 0.999062 val: 0.757746 test: 0.755205
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  19 loss training:  7.782318885438144 Time :  833
accuracy train: 0.999375 val: 0.757746 test: 0.754643
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  20 loss training:  6.468078130390495 Time :  848
accuracy train: 0.999844 val: 0.756338 test: 0.758301
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  21 loss training:  6.164474535733461 Time :  861
accuracy train: 0.999844 val: 0.750704 test: 0.755487
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  22 loss training:  4.344680668087676 Time :  870
accuracy train: 0.999687 val: 0.754930 test: 0.753517
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  23 loss training:  3.4571788122411817 Time :  884
accuracy train: 1.000000 val: 0.753521 test: 0.750985
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  24 loss training:  3.2845467834267765 Time :  900
accuracy train: 0.999687 val: 0.763380 test: 0.749015
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  25 loss training:  3.0048140223370865 Time :  915
accuracy train: 1.000000 val: 0.756338 test: 0.749015
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  26 loss training:  2.162817373755388 Time :  931
accuracy train: 1.000000 val: 0.754930 test: 0.749297
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  27 loss training:  1.9602735585649498 Time :  945
accuracy train: 1.000000 val: 0.749296 test: 0.747608
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  28 loss training:  1.8205089867697097 Time :  957
accuracy train: 1.000000 val: 0.760563 test: 0.747327
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  29 loss training:  1.74779560326715 Time :  968
accuracy train: 1.000000 val: 0.753521 test: 0.746764
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  30 loss training:  1.7361035411595367 Time :  995
accuracy train: 1.000000 val: 0.756338 test: 0.750141
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  31 loss training:  1.1231303595850477 Time :  1004
accuracy train: 1.000000 val: 0.747887 test: 0.749859
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  32 loss training:  1.0531783358746907 Time :  1012
accuracy train: 1.000000 val: 0.756338 test: 0.748734
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  33 loss training:  0.6732449950504815 Time :  1032
accuracy train: 1.000000 val: 0.750704 test: 0.749015
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  34 loss training:  0.8531453452305868 Time :  1045
accuracy train: 0.999844 val: 0.759155 test: 0.746483
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  35 loss training:  0.7631748586209142 Time :  1052
accuracy train: 1.000000 val: 0.752113 test: 0.747327
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  36 loss training:  0.6175500644167187 Time :  1065
accuracy train: 1.000000 val: 0.754930 test: 0.750422
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  37 loss training:  0.5433722407906316 Time :  1080
accuracy train: 0.999844 val: 0.752113 test: 0.744795
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  38 loss training:  0.5120564883109182 Time :  1090
accuracy train: 1.000000 val: 0.759155 test: 0.748452
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  39 loss training:  0.6213789423709386 Time :  1105
accuracy train: 1.000000 val: 0.763380 test: 0.740855
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  40 loss training:  0.7546492782239511 Time :  1117
accuracy train: 1.000000 val: 0.766197 test: 0.747046
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  41 loss training:  0.6746800364053342 Time :  1131
accuracy train: 1.000000 val: 0.770423 test: 0.748452
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

Epoch :  42 loss training:  0.5408670117103611 Time :  1143
accuracy train: 1.000000 val: 0.760563 test: 0.744232
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.773776

========================================================================================================================================================================================================
max acc epoch :  11
max validation accuracy :  0.7915492957746478
test accuracy :  0.7737760270118177
last test_accuracy :  0.7442318514350028
max gap 4
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=894, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  101.88030996918678 Time :  1155
accuracy train: 0.674117 val: 0.653521 test: 0.663478
max validation accuracy : 0.653521 max acc epoch : 1 test accuracy : 0.663478
Epoch-1 lr: 0.005

Epoch :  2 loss training:  88.223119109869 Time :  1169
accuracy train: 0.806346 val: 0.767606 test: 0.774339
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.774339
Epoch-2 lr: 0.005

Epoch :  3 loss training:  91.24109244346619 Time :  1181
accuracy train: 0.822913 val: 0.780282 test: 0.770118
max validation accuracy : 0.780282 max acc epoch : 3 test accuracy : 0.770118
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  73.04985027015209 Time :  1189
accuracy train: 0.852923 val: 0.771831 test: 0.779403
max validation accuracy : 0.780282 max acc epoch : 3 test accuracy : 0.770118
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  70.455575466156 Time :  1205
accuracy train: 0.856049 val: 0.771831 test: 0.768430
max validation accuracy : 0.780282 max acc epoch : 3 test accuracy : 0.770118
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  65.25338922441006 Time :  1218
accuracy train: 0.894498 val: 0.790141 test: 0.777153
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  58.14627006649971 Time :  1230
accuracy train: 0.906533 val: 0.746479 test: 0.772651
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  55.20253236591816 Time :  1244
accuracy train: 0.925445 val: 0.770423 test: 0.767304
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  50.191623732447624 Time :  1259
accuracy train: 0.936230 val: 0.769014 test: 0.769555
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  44.571995332837105 Time :  1271
accuracy train: 0.951547 val: 0.752113 test: 0.772932
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  11 loss training:  42.1055568382144 Time :  1284
accuracy train: 0.967490 val: 0.759155 test: 0.777715
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  12 loss training:  34.05401163548231 Time :  1300
accuracy train: 0.982807 val: 0.752113 test: 0.774057
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  13 loss training:  26.388948895037174 Time :  1313
accuracy train: 0.988590 val: 0.757746 test: 0.772088
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  14 loss training:  20.13405974768102 Time :  1321
accuracy train: 0.994373 val: 0.761972 test: 0.772088
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  15 loss training:  14.788491440936923 Time :  1333
accuracy train: 0.996874 val: 0.764789 test: 0.772369
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  16 loss training:  12.516302227973938 Time :  1349
accuracy train: 0.998437 val: 0.760563 test: 0.769274
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  17 loss training:  8.8853426175192 Time :  1358
accuracy train: 0.999219 val: 0.761972 test: 0.766742
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  18 loss training:  7.044371490832418 Time :  1371
accuracy train: 0.999375 val: 0.753521 test: 0.758019
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  19 loss training:  5.886750279460102 Time :  1382
accuracy train: 0.999531 val: 0.760563 test: 0.761677
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  20 loss training:  4.5922950017265975 Time :  1392
accuracy train: 0.999687 val: 0.761972 test: 0.763084
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  21 loss training:  3.9012507935985923 Time :  1404
accuracy train: 0.999531 val: 0.757746 test: 0.764772
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  22 loss training:  3.4483924345113337 Time :  1415
accuracy train: 0.999687 val: 0.750704 test: 0.756050
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  23 loss training:  3.162835206836462 Time :  1427
accuracy train: 1.000000 val: 0.759155 test: 0.754361
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  24 loss training:  2.612293896730989 Time :  1438
accuracy train: 0.999844 val: 0.754930 test: 0.752673
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  25 loss training:  2.1302581269992515 Time :  1451
accuracy train: 1.000000 val: 0.750704 test: 0.757738
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  26 loss training:  1.991022061847616 Time :  1464
accuracy train: 1.000000 val: 0.759155 test: 0.757456
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  27 loss training:  1.4664565951679833 Time :  1476
accuracy train: 1.000000 val: 0.760563 test: 0.755205
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  28 loss training:  1.4145876715774648 Time :  1487
accuracy train: 1.000000 val: 0.766197 test: 0.754924
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  29 loss training:  1.4610601005260833 Time :  1499
accuracy train: 0.999844 val: 0.757746 test: 0.759145
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  30 loss training:  1.4654535863664933 Time :  1513
accuracy train: 1.000000 val: 0.770423 test: 0.751548
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  31 loss training:  1.2125311266863719 Time :  1522
accuracy train: 1.000000 val: 0.760563 test: 0.752392
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  32 loss training:  0.7123493724502623 Time :  1534
accuracy train: 1.000000 val: 0.754930 test: 0.753236
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  33 loss training:  0.6748566996393492 Time :  1547
accuracy train: 1.000000 val: 0.756338 test: 0.749578
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  34 loss training:  0.8161857984305243 Time :  1558
accuracy train: 1.000000 val: 0.760563 test: 0.755487
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  35 loss training:  0.5999877702997765 Time :  1569
accuracy train: 1.000000 val: 0.753521 test: 0.759989
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  36 loss training:  0.725697736179427 Time :  1581
accuracy train: 1.000000 val: 0.757746 test: 0.757738
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

Epoch :  37 loss training:  0.43959355958213564 Time :  1593
accuracy train: 1.000000 val: 0.761972 test: 0.755768
max validation accuracy : 0.790141 max acc epoch : 6 test accuracy : 0.777153

========================================================================================================================================================================================================
max acc epoch :  6
max validation accuracy :  0.7901408450704225
test accuracy :  0.7771525042205966
last test_accuracy :  0.7557681485649972
max gap 3
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=894, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  103.44526359438896 Time :  1606
accuracy train: 0.750078 val: 0.726761 test: 0.733821
max validation accuracy : 0.726761 max acc epoch : 1 test accuracy : 0.733821
Epoch-1 lr: 0.005

Epoch :  2 loss training:  85.45592987537384 Time :  1616
accuracy train: 0.810878 val: 0.774648 test: 0.774620
max validation accuracy : 0.774648 max acc epoch : 2 test accuracy : 0.774620
Epoch-2 lr: 0.005

Epoch :  3 loss training:  84.63249009847641 Time :  1628
accuracy train: 0.822445 val: 0.774648 test: 0.763084
max validation accuracy : 0.774648 max acc epoch : 2 test accuracy : 0.774620
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  70.99309858679771 Time :  1640
accuracy train: 0.836355 val: 0.777465 test: 0.772369
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.772369
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  68.9931343048811 Time :  1654
accuracy train: 0.843545 val: 0.770423 test: 0.767023
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.772369
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  63.384743109345436 Time :  1664
accuracy train: 0.887621 val: 0.769014 test: 0.769555
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.772369
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  57.523271694779396 Time :  1676
accuracy train: 0.905595 val: 0.760563 test: 0.771244
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.772369
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  53.82827712595463 Time :  1687
accuracy train: 0.928259 val: 0.776056 test: 0.772088
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.772369
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  49.75196645408869 Time :  1700
accuracy train: 0.936855 val: 0.781690 test: 0.776027
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.776027
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  44.691111132502556 Time :  1709
accuracy train: 0.948265 val: 0.777465 test: 0.775183
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.776027

Epoch :  11 loss training:  42.14244793355465 Time :  1721
accuracy train: 0.963739 val: 0.783099 test: 0.773776
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  12 loss training:  34.53133378922939 Time :  1732
accuracy train: 0.982495 val: 0.771831 test: 0.776027
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  13 loss training:  26.066230103373528 Time :  1742
accuracy train: 0.986715 val: 0.770423 test: 0.770681
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  14 loss training:  18.97482204437256 Time :  1754
accuracy train: 0.994061 val: 0.780282 test: 0.768430
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  15 loss training:  15.163786351680756 Time :  1765
accuracy train: 0.997968 val: 0.766197 test: 0.767867
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  16 loss training:  12.035366592928767 Time :  1775
accuracy train: 0.998281 val: 0.766197 test: 0.763365
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  17 loss training:  8.380845281295478 Time :  1788
accuracy train: 0.999375 val: 0.759155 test: 0.759989
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  18 loss training:  6.877778470981866 Time :  1800
accuracy train: 0.999531 val: 0.759155 test: 0.759707
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  19 loss training:  5.73012622166425 Time :  1812
accuracy train: 0.999687 val: 0.769014 test: 0.759426
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  20 loss training:  4.45089948666282 Time :  1824
accuracy train: 1.000000 val: 0.766197 test: 0.755487
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  21 loss training:  3.5688947909511626 Time :  1838
accuracy train: 0.999844 val: 0.764789 test: 0.754643
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  22 loss training:  3.9536651896778494 Time :  1849
accuracy train: 0.999844 val: 0.753521 test: 0.759707
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  23 loss training:  2.778971226187423 Time :  1859
accuracy train: 0.999844 val: 0.757746 test: 0.761114
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  24 loss training:  2.4712851303629577 Time :  1872
accuracy train: 0.999687 val: 0.749296 test: 0.763084
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  25 loss training:  1.9437345718033612 Time :  1882
accuracy train: 1.000000 val: 0.756338 test: 0.758582
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  26 loss training:  1.628748492395971 Time :  1892
accuracy train: 1.000000 val: 0.764789 test: 0.755768
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  27 loss training:  1.3094198981125373 Time :  1909
accuracy train: 1.000000 val: 0.760563 test: 0.752392
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  28 loss training:  1.5724283397430554 Time :  1919
accuracy train: 1.000000 val: 0.756338 test: 0.750703
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  29 loss training:  1.6807442556892056 Time :  1929
accuracy train: 1.000000 val: 0.760563 test: 0.749859
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  30 loss training:  1.129005103779491 Time :  1942
accuracy train: 1.000000 val: 0.773239 test: 0.754643
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  31 loss training:  0.8320839021762367 Time :  1951
accuracy train: 0.999844 val: 0.764789 test: 0.751548
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  32 loss training:  0.8919659273233265 Time :  1961
accuracy train: 1.000000 val: 0.753521 test: 0.750422
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  33 loss training:  0.8439578613761114 Time :  1975
accuracy train: 1.000000 val: 0.759155 test: 0.753517
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  34 loss training:  1.1067874543041398 Time :  1987
accuracy train: 1.000000 val: 0.752113 test: 0.746764
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  35 loss training:  0.6132581766723888 Time :  2000
accuracy train: 1.000000 val: 0.754930 test: 0.750141
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  36 loss training:  0.5311307666415814 Time :  2013
accuracy train: 1.000000 val: 0.756338 test: 0.745920
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  37 loss training:  0.6243529631465208 Time :  2023
accuracy train: 1.000000 val: 0.760563 test: 0.749015
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  38 loss training:  0.48547951098225894 Time :  2033
accuracy train: 1.000000 val: 0.754930 test: 0.745639
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  39 loss training:  0.3259865572399576 Time :  2048
accuracy train: 1.000000 val: 0.760563 test: 0.748171
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  40 loss training:  0.34661063957901206 Time :  2063
accuracy train: 1.000000 val: 0.761972 test: 0.749297
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  41 loss training:  0.4350639420445077 Time :  2073
accuracy train: 1.000000 val: 0.759155 test: 0.748734
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

Epoch :  42 loss training:  1.0612543103052303 Time :  2084
accuracy train: 1.000000 val: 0.756338 test: 0.748171
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.773776

========================================================================================================================================================================================================
max acc epoch :  11
max validation accuracy :  0.7830985915492957
test accuracy :  0.7737760270118177
last test_accuracy :  0.7481710748452448
max gap 5
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=894, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  101.49820536375046 Time :  2099
accuracy train: 0.689903 val: 0.671831 test: 0.676702
max validation accuracy : 0.671831 max acc epoch : 1 test accuracy : 0.676702
Epoch-1 lr: 0.005

Epoch :  2 loss training:  85.56488519906998 Time :  2112
accuracy train: 0.803376 val: 0.769014 test: 0.774339
max validation accuracy : 0.769014 max acc epoch : 2 test accuracy : 0.774339
Epoch-2 lr: 0.005

Epoch :  3 loss training:  87.22902509570122 Time :  2122
accuracy train: 0.816661 val: 0.784507 test: 0.763365
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.763365
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  72.37954623997211 Time :  2135
accuracy train: 0.848703 val: 0.785915 test: 0.776027
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  68.44320327043533 Time :  2149
accuracy train: 0.853235 val: 0.778873 test: 0.767304
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  63.817467734217644 Time :  2160
accuracy train: 0.890122 val: 0.773239 test: 0.775464
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  58.0096283107996 Time :  2171
accuracy train: 0.890122 val: 0.764789 test: 0.765898
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  54.796952441334724 Time :  2184
accuracy train: 0.923101 val: 0.776056 test: 0.769274
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  51.149617321789265 Time :  2197
accuracy train: 0.906846 val: 0.781690 test: 0.760833
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  46.65190373361111 Time :  2206
accuracy train: 0.947327 val: 0.764789 test: 0.776590
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027

Epoch :  11 loss training:  43.67984119057655 Time :  2218
accuracy train: 0.964520 val: 0.766197 test: 0.773776
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027

Epoch :  12 loss training:  35.092320539057255 Time :  2229
accuracy train: 0.981088 val: 0.770423 test: 0.768993
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027

Epoch :  13 loss training:  26.80409138277173 Time :  2242
accuracy train: 0.987496 val: 0.767606 test: 0.770400
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027

Epoch :  14 loss training:  20.525154937058687 Time :  2251
accuracy train: 0.993904 val: 0.773239 test: 0.772088
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027

Epoch :  15 loss training:  15.735264947637916 Time :  2264
accuracy train: 0.996249 val: 0.763380 test: 0.764772
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027

Epoch :  16 loss training:  12.204013330861926 Time :  2276
accuracy train: 0.998281 val: 0.766197 test: 0.760270
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027

Epoch :  17 loss training:  9.209448060020804 Time :  2287
accuracy train: 0.998906 val: 0.764789 test: 0.763647
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027

Epoch :  18 loss training:  6.996229835785925 Time :  2297
accuracy train: 0.999062 val: 0.773239 test: 0.758863
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027

Epoch :  19 loss training:  6.076433140318841 Time :  2310
accuracy train: 0.999844 val: 0.767606 test: 0.759989
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027

Epoch :  20 loss training:  5.0680353925563395 Time :  2320
accuracy train: 0.999844 val: 0.764789 test: 0.757175
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027

Epoch :  21 loss training:  4.4252799993846565 Time :  2332
accuracy train: 0.999844 val: 0.750704 test: 0.759707
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027

Epoch :  22 loss training:  4.419764154125005 Time :  2347
accuracy train: 0.999531 val: 0.750704 test: 0.756612
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027

Epoch :  23 loss training:  3.1721931691281497 Time :  2361
accuracy train: 0.999844 val: 0.754930 test: 0.756050
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027

Epoch :  24 loss training:  3.0235626549692824 Time :  2371
accuracy train: 0.999844 val: 0.747887 test: 0.750141
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027

Epoch :  25 loss training:  2.2755692703067325 Time :  2381
accuracy train: 1.000000 val: 0.756338 test: 0.754080
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027

Epoch :  26 loss training:  1.9805435392190702 Time :  2393
accuracy train: 1.000000 val: 0.761972 test: 0.756050
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027

Epoch :  27 loss training:  1.5264325151219964 Time :  2403
accuracy train: 1.000000 val: 0.756338 test: 0.749859
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027

Epoch :  28 loss training:  1.5315818453673273 Time :  2414
accuracy train: 1.000000 val: 0.771831 test: 0.749578
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027

Epoch :  29 loss training:  1.4963822916033678 Time :  2428
accuracy train: 1.000000 val: 0.761972 test: 0.754361
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027

Epoch :  30 loss training:  1.5062690749618923 Time :  2437
accuracy train: 0.999844 val: 0.757746 test: 0.753799
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027

Epoch :  31 loss training:  0.8733147441380424 Time :  2447
accuracy train: 1.000000 val: 0.759155 test: 0.757738
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027

Epoch :  32 loss training:  1.3473832758027129 Time :  2460
accuracy train: 0.997187 val: 0.756338 test: 0.748452
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027

Epoch :  33 loss training:  0.9053044864413096 Time :  2470
accuracy train: 0.997187 val: 0.756338 test: 0.752392
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027

Epoch :  34 loss training:  1.0823910564358812 Time :  2480
accuracy train: 1.000000 val: 0.736620 test: 0.746483
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027

Epoch :  35 loss training:  0.9147490509203635 Time :  2495
accuracy train: 1.000000 val: 0.749296 test: 0.753517
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.776027

========================================================================================================================================================================================================
max acc epoch :  4
max validation accuracy :  0.7859154929577464
test accuracy :  0.7760270118176702
last test_accuracy :  0.7535171637591446
max gap 1
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=894, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  102.78195801377296 Time :  2510
accuracy train: 0.726946 val: 0.695775 test: 0.706246
max validation accuracy : 0.695775 max acc epoch : 1 test accuracy : 0.706246
Epoch-1 lr: 0.005

Epoch :  2 loss training:  84.77098190784454 Time :  2521
accuracy train: 0.787121 val: 0.736620 test: 0.752110
max validation accuracy : 0.736620 max acc epoch : 2 test accuracy : 0.752110
Epoch-2 lr: 0.005

Epoch :  3 loss training:  89.30164101719856 Time :  2533
accuracy train: 0.811191 val: 0.759155 test: 0.764491
max validation accuracy : 0.759155 max acc epoch : 3 test accuracy : 0.764491
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  74.24852299690247 Time :  2543
accuracy train: 0.840106 val: 0.764789 test: 0.772932
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.772932
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  71.24008908867836 Time :  2552
accuracy train: 0.847452 val: 0.770423 test: 0.770400
max validation accuracy : 0.770423 max acc epoch : 5 test accuracy : 0.770400
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  65.21140906214714 Time :  2564
accuracy train: 0.883557 val: 0.759155 test: 0.772088
max validation accuracy : 0.770423 max acc epoch : 5 test accuracy : 0.770400
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  59.64922313392162 Time :  2575
accuracy train: 0.897781 val: 0.759155 test: 0.769555
max validation accuracy : 0.770423 max acc epoch : 5 test accuracy : 0.770400
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  56.09210602939129 Time :  2587
accuracy train: 0.926071 val: 0.780282 test: 0.772369
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  51.168770499527454 Time :  2600
accuracy train: 0.932323 val: 0.774648 test: 0.771525
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  47.03729405999184 Time :  2610
accuracy train: 0.945608 val: 0.778873 test: 0.775464
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  11 loss training:  43.05926280468702 Time :  2622
accuracy train: 0.964364 val: 0.769014 test: 0.768993
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  12 loss training:  35.19013099372387 Time :  2634
accuracy train: 0.982182 val: 0.777465 test: 0.768711
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  13 loss training:  26.435373321175575 Time :  2644
accuracy train: 0.987809 val: 0.780282 test: 0.767023
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  14 loss training:  20.085055477917194 Time :  2656
accuracy train: 0.994217 val: 0.778873 test: 0.768711
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  15 loss training:  15.458698570728302 Time :  2669
accuracy train: 0.997030 val: 0.773239 test: 0.768430
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  16 loss training:  12.230669727548957 Time :  2680
accuracy train: 0.998437 val: 0.774648 test: 0.767304
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  17 loss training:  8.739415805786848 Time :  2692
accuracy train: 0.999375 val: 0.764789 test: 0.764772
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  18 loss training:  7.271873395424336 Time :  2708
accuracy train: 0.999375 val: 0.773239 test: 0.759145
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  19 loss training:  5.3295257072895765 Time :  2718
accuracy train: 0.999687 val: 0.767606 test: 0.757175
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  20 loss training:  4.4560076089110225 Time :  2728
accuracy train: 0.999844 val: 0.764789 test: 0.756050
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  21 loss training:  4.124255562201142 Time :  2741
accuracy train: 0.999844 val: 0.763380 test: 0.758301
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  22 loss training:  3.496846575057134 Time :  2751
accuracy train: 1.000000 val: 0.766197 test: 0.758863
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  23 loss training:  2.7017891589784995 Time :  2758
accuracy train: 1.000000 val: 0.763380 test: 0.760551
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  24 loss training:  2.515521390014328 Time :  2769
accuracy train: 1.000000 val: 0.759155 test: 0.757175
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  25 loss training:  1.969965060299728 Time :  2782
accuracy train: 1.000000 val: 0.761972 test: 0.758301
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  26 loss training:  1.7515812687051948 Time :  2791
accuracy train: 1.000000 val: 0.761972 test: 0.755768
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  27 loss training:  1.6230587489553727 Time :  2801
accuracy train: 1.000000 val: 0.767606 test: 0.751829
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  28 loss training:  1.385439861798659 Time :  2814
accuracy train: 1.000000 val: 0.767606 test: 0.750703
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  29 loss training:  1.387605001218617 Time :  2825
accuracy train: 1.000000 val: 0.770423 test: 0.752110
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  30 loss training:  1.0939428800484166 Time :  2835
accuracy train: 1.000000 val: 0.760563 test: 0.750422
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  31 loss training:  0.9046675176359713 Time :  2849
accuracy train: 1.000000 val: 0.764789 test: 0.755487
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  32 loss training:  0.8201730821892852 Time :  2865
accuracy train: 1.000000 val: 0.766197 test: 0.752673
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  33 loss training:  0.6735764969926095 Time :  2877
accuracy train: 1.000000 val: 0.767606 test: 0.756331
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  34 loss training:  0.9103175143536646 Time :  2887
accuracy train: 1.000000 val: 0.753521 test: 0.750422
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  35 loss training:  0.6749408786199638 Time :  2901
accuracy train: 1.000000 val: 0.766197 test: 0.747608
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  36 loss training:  0.7042980737605831 Time :  2912
accuracy train: 1.000000 val: 0.764789 test: 0.750703
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  37 loss training:  0.5431853136979043 Time :  2923
accuracy train: 1.000000 val: 0.759155 test: 0.753236
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  38 loss training:  0.7276378188471426 Time :  2936
accuracy train: 0.999687 val: 0.742254 test: 0.745357
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

Epoch :  39 loss training:  0.49577210614006617 Time :  2947
accuracy train: 1.000000 val: 0.750704 test: 0.747046
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.772369

========================================================================================================================================================================================================
max acc epoch :  8
max validation accuracy :  0.780281690140845
test accuracy :  0.7723691615081598
last test_accuracy :  0.7470455824423186
max gap 3
========================================================================================================================================================================================================

itr : 6
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=894, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  100.73718360066414 Time :  2959
accuracy train: 0.753048 val: 0.708451 test: 0.730726
max validation accuracy : 0.708451 max acc epoch : 1 test accuracy : 0.730726
Epoch-1 lr: 0.005

Epoch :  2 loss training:  83.98176318407059 Time :  2972
accuracy train: 0.804783 val: 0.759155 test: 0.774057
max validation accuracy : 0.759155 max acc epoch : 2 test accuracy : 0.774057
Epoch-2 lr: 0.005

Epoch :  3 loss training:  96.01626080274582 Time :  2984
accuracy train: 0.554705 val: 0.546479 test: 0.551491
max validation accuracy : 0.759155 max acc epoch : 2 test accuracy : 0.774057
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  76.3416395932436 Time :  2995
accuracy train: 0.832760 val: 0.767606 test: 0.779403
max validation accuracy : 0.767606 max acc epoch : 4 test accuracy : 0.779403
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  78.52306932210922 Time :  3005
accuracy train: 0.832604 val: 0.764789 test: 0.775746
max validation accuracy : 0.767606 max acc epoch : 4 test accuracy : 0.779403
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  76.84767091274261 Time :  3016
accuracy train: 0.838543 val: 0.760563 test: 0.778841
max validation accuracy : 0.767606 max acc epoch : 4 test accuracy : 0.779403
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  72.12647141516209 Time :  3029
accuracy train: 0.834167 val: 0.757746 test: 0.770681
max validation accuracy : 0.767606 max acc epoch : 4 test accuracy : 0.779403
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  72.47597722709179 Time :  3043
accuracy train: 0.831041 val: 0.747887 test: 0.768149
max validation accuracy : 0.767606 max acc epoch : 4 test accuracy : 0.779403
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  65.72601781785488 Time :  3054
accuracy train: 0.869647 val: 0.780282 test: 0.777715
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.777715
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  62.23748545348644 Time :  3064
accuracy train: 0.873554 val: 0.776056 test: 0.778278
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.777715

Epoch :  11 loss training:  60.093176528811455 Time :  3077
accuracy train: 0.909347 val: 0.780282 test: 0.781373
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.777715

Epoch :  12 loss training:  50.80332647264004 Time :  3089
accuracy train: 0.932010 val: 0.774648 test: 0.781654
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.777715

Epoch :  13 loss training:  41.47793981432915 Time :  3099
accuracy train: 0.942013 val: 0.776056 test: 0.778559
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.777715

Epoch :  14 loss training:  34.15709888935089 Time :  3111
accuracy train: 0.962645 val: 0.787324 test: 0.770681
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.770681

Epoch :  15 loss training:  26.80954008549452 Time :  3121
accuracy train: 0.979994 val: 0.781690 test: 0.773495
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.770681

Epoch :  16 loss training:  21.924355829134583 Time :  3133
accuracy train: 0.985933 val: 0.764789 test: 0.770118
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.770681

Epoch :  17 loss training:  18.793885787948966 Time :  3145
accuracy train: 0.991560 val: 0.776056 test: 0.772088
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.770681

Epoch :  18 loss training:  16.19925875030458 Time :  3153
accuracy train: 0.993279 val: 0.769014 test: 0.767304
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.770681

Epoch :  19 loss training:  13.663452764973044 Time :  3165
accuracy train: 0.997812 val: 0.766197 test: 0.763365
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.770681

Epoch :  20 loss training:  10.720910836942494 Time :  3177
accuracy train: 0.997656 val: 0.761972 test: 0.755205
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.770681

Epoch :  21 loss training:  8.482495484407991 Time :  3187
accuracy train: 0.998437 val: 0.771831 test: 0.756331
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.770681

Epoch :  22 loss training:  6.990044547244906 Time :  3199
accuracy train: 0.998593 val: 0.752113 test: 0.747608
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.770681

Epoch :  23 loss training:  5.328516922658309 Time :  3221
accuracy train: 0.999687 val: 0.767606 test: 0.752110
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.770681

Epoch :  24 loss training:  4.32220029970631 Time :  3235
accuracy train: 0.999844 val: 0.764789 test: 0.745076
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.770681

Epoch :  25 loss training:  3.6895954568171874 Time :  3244
accuracy train: 0.999687 val: 0.773239 test: 0.745639
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.770681

Epoch :  26 loss training:  3.081420211587101 Time :  3255
accuracy train: 1.000000 val: 0.766197 test: 0.750985
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.770681

Epoch :  27 loss training:  2.7739492203108966 Time :  3267
accuracy train: 0.999531 val: 0.764789 test: 0.742825
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.770681

Epoch :  28 loss training:  2.1083741316688247 Time :  3279
accuracy train: 0.999844 val: 0.764789 test: 0.743950
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.770681

Epoch :  29 loss training:  2.59765730710933 Time :  3289
accuracy train: 1.000000 val: 0.761972 test: 0.741418
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.770681

Epoch :  30 loss training:  3.052204729116056 Time :  3302
accuracy train: 1.000000 val: 0.776056 test: 0.738604
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.770681

Epoch :  31 loss training:  1.7600916245137341 Time :  3313
accuracy train: 0.999844 val: 0.771831 test: 0.741699
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.770681

Epoch :  32 loss training:  1.8918214754958171 Time :  3322
accuracy train: 0.999844 val: 0.761972 test: 0.736916
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.770681

Epoch :  33 loss training:  1.4653587448992766 Time :  3335
accuracy train: 0.999844 val: 0.769014 test: 0.742544
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.770681

Epoch :  34 loss training:  1.0685014215123374 Time :  3350
accuracy train: 1.000000 val: 0.777465 test: 0.746201
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.770681

Epoch :  35 loss training:  1.0651053049077746 Time :  3358
accuracy train: 1.000000 val: 0.778873 test: 0.741418
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.770681

Epoch :  36 loss training:  0.807582781137171 Time :  3371
accuracy train: 1.000000 val: 0.783099 test: 0.739167
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.770681

Epoch :  37 loss training:  0.6863352836371632 Time :  3388
accuracy train: 1.000000 val: 0.788732 test: 0.743950
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  38 loss training:  0.642377997879521 Time :  3400
accuracy train: 1.000000 val: 0.780282 test: 0.741699
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  39 loss training:  0.6498010358918691 Time :  3409
accuracy train: 1.000000 val: 0.781690 test: 0.740574
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  40 loss training:  0.6584837472109939 Time :  3425
accuracy train: 1.000000 val: 0.776056 test: 0.742544
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  41 loss training:  0.6291268700733781 Time :  3438
accuracy train: 1.000000 val: 0.778873 test: 0.746201
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  42 loss training:  0.52072981891979 Time :  3446
accuracy train: 1.000000 val: 0.774648 test: 0.741137
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  43 loss training:  0.5483391278648924 Time :  3456
accuracy train: 1.000000 val: 0.777465 test: 0.744232
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  44 loss training:  0.4881974915151659 Time :  3470
accuracy train: 1.000000 val: 0.773239 test: 0.745357
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  45 loss training:  0.4717638575802994 Time :  3480
accuracy train: 1.000000 val: 0.773239 test: 0.741418
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  46 loss training:  0.43322814997554815 Time :  3491
accuracy train: 1.000000 val: 0.774648 test: 0.742544
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  47 loss training:  0.49107701242974144 Time :  3503
accuracy train: 1.000000 val: 0.773239 test: 0.744513
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  48 loss training:  0.36461779183991894 Time :  3513
accuracy train: 1.000000 val: 0.778873 test: 0.745357
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  49 loss training:  0.38015712423293735 Time :  3524
accuracy train: 1.000000 val: 0.776056 test: 0.739449
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  50 loss training:  0.253738261271792 Time :  3537
accuracy train: 1.000000 val: 0.761972 test: 0.737198
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  51 loss training:  0.39822554018564915 Time :  3548
accuracy train: 1.000000 val: 0.763380 test: 0.737198
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  52 loss training:  0.1977254970388458 Time :  3560
accuracy train: 1.000000 val: 0.759155 test: 0.738323
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  53 loss training:  0.2893189934388829 Time :  3573
accuracy train: 1.000000 val: 0.761972 test: 0.738323
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  54 loss training:  0.17606937540494982 Time :  3586
accuracy train: 1.000000 val: 0.759155 test: 0.738886
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  55 loss training:  0.3632942936856125 Time :  3598
accuracy train: 1.000000 val: 0.763380 test: 0.737198
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  56 loss training:  0.26808787778827536 Time :  3608
accuracy train: 1.000000 val: 0.780282 test: 0.740574
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  57 loss training:  0.43081766684917966 Time :  3621
accuracy train: 0.999844 val: 0.774648 test: 0.736353
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  58 loss training:  0.6517625677224714 Time :  3633
accuracy train: 1.000000 val: 0.770423 test: 0.738604
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  59 loss training:  0.1988861762661145 Time :  3643
accuracy train: 1.000000 val: 0.784507 test: 0.739449
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  60 loss training:  0.19752899687455283 Time :  3656
accuracy train: 1.000000 val: 0.770423 test: 0.736353
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  61 loss training:  0.18388038620241787 Time :  3667
accuracy train: 1.000000 val: 0.769014 test: 0.740293
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  62 loss training:  0.11791324539126435 Time :  3679
accuracy train: 1.000000 val: 0.769014 test: 0.738323
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  63 loss training:  0.24762828330835873 Time :  3691
accuracy train: 1.000000 val: 0.763380 test: 0.738323
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  64 loss training:  0.18851628368065576 Time :  3703
accuracy train: 1.000000 val: 0.770423 test: 0.735791
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  65 loss training:  0.22042790394289113 Time :  3713
accuracy train: 0.999844 val: 0.759155 test: 0.730163
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  66 loss training:  0.19147334684748785 Time :  3726
accuracy train: 1.000000 val: 0.773239 test: 0.736916
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  67 loss training:  0.08432357037577276 Time :  3743
accuracy train: 1.000000 val: 0.771831 test: 0.738604
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

Epoch :  68 loss training:  0.3888164755485377 Time :  3756
accuracy train: 1.000000 val: 0.771831 test: 0.737198
max validation accuracy : 0.788732 max acc epoch : 37 test accuracy : 0.743950

========================================================================================================================================================================================================
max acc epoch :  37
max validation accuracy :  0.7887323943661971
test accuracy :  0.7439504783342712
last test_accuracy :  0.7371975239167136
max gap 23
========================================================================================================================================================================================================

itr : 7
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=894, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  101.40353488922119 Time :  3766
accuracy train: 0.738512 val: 0.712676 test: 0.718908
max validation accuracy : 0.712676 max acc epoch : 1 test accuracy : 0.718908
Epoch-1 lr: 0.005

Epoch :  2 loss training:  85.5621565580368 Time :  3780
accuracy train: 0.804626 val: 0.752113 test: 0.763647
max validation accuracy : 0.752113 max acc epoch : 2 test accuracy : 0.763647
Epoch-2 lr: 0.005

Epoch :  3 loss training:  97.82967790961266 Time :  3791
accuracy train: 0.798843 val: 0.784507 test: 0.764491
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.764491
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  73.83179314434528 Time :  3799
accuracy train: 0.831822 val: 0.757746 test: 0.767867
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.764491
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  71.26634684205055 Time :  3812
accuracy train: 0.835261 val: 0.773239 test: 0.754361
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.764491
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  67.48504942655563 Time :  3823
accuracy train: 0.869022 val: 0.760563 test: 0.765053
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.764491
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  67.8426696062088 Time :  3834
accuracy train: 0.859018 val: 0.745070 test: 0.759707
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.764491
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  66.21011412143707 Time :  3845
accuracy train: 0.879181 val: 0.759155 test: 0.767867
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.764491
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  60.21981655061245 Time :  3855
accuracy train: 0.901375 val: 0.784507 test: 0.768711
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.764491
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  54.01440919935703 Time :  3868
accuracy train: 0.916693 val: 0.780282 test: 0.765898
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.764491

Epoch :  11 loss training:  52.232561647892 Time :  3880
accuracy train: 0.943732 val: 0.785915 test: 0.772369
max validation accuracy : 0.785915 max acc epoch : 11 test accuracy : 0.772369

Epoch :  12 loss training:  43.059512965381145 Time :  3890
accuracy train: 0.962332 val: 0.788732 test: 0.769555
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  13 loss training:  34.93368247151375 Time :  3904
accuracy train: 0.968584 val: 0.770423 test: 0.772369
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  14 loss training:  27.216559279710054 Time :  3918
accuracy train: 0.983745 val: 0.777465 test: 0.771244
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  15 loss training:  21.251718785613775 Time :  3929
accuracy train: 0.991247 val: 0.766197 test: 0.762802
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  16 loss training:  16.98507429845631 Time :  3937
accuracy train: 0.994373 val: 0.760563 test: 0.763928
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  17 loss training:  12.87940531782806 Time :  3954
accuracy train: 0.997499 val: 0.769014 test: 0.767304
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  18 loss training:  11.145617201924324 Time :  3965
accuracy train: 0.997968 val: 0.764789 test: 0.760833
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  19 loss training:  8.66648640204221 Time :  3974
accuracy train: 0.999219 val: 0.763380 test: 0.759989
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  20 loss training:  6.730669551994652 Time :  3988
accuracy train: 0.997343 val: 0.760563 test: 0.755205
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  21 loss training:  6.0139226308092475 Time :  4003
accuracy train: 1.000000 val: 0.773239 test: 0.756894
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  22 loss training:  4.878797937184572 Time :  4013
accuracy train: 0.999844 val: 0.761972 test: 0.759145
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  23 loss training:  3.959009936079383 Time :  4023
accuracy train: 1.000000 val: 0.760563 test: 0.756050
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  24 loss training:  3.5752256505656987 Time :  4038
accuracy train: 1.000000 val: 0.763380 test: 0.752110
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  25 loss training:  2.6939710607985035 Time :  4048
accuracy train: 1.000000 val: 0.766197 test: 0.750422
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  26 loss training:  2.4992006809916347 Time :  4058
accuracy train: 1.000000 val: 0.760563 test: 0.755768
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  27 loss training:  2.6162665211595595 Time :  4068
accuracy train: 1.000000 val: 0.750704 test: 0.752392
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  28 loss training:  1.9760265779332258 Time :  4085
accuracy train: 1.000000 val: 0.753521 test: 0.746483
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  29 loss training:  2.0308686138596386 Time :  4097
accuracy train: 1.000000 val: 0.756338 test: 0.747890
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  30 loss training:  2.0268837526091374 Time :  4109
accuracy train: 1.000000 val: 0.763380 test: 0.750703
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  31 loss training:  1.378460071689915 Time :  4118
accuracy train: 1.000000 val: 0.756338 test: 0.747046
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  32 loss training:  1.0058777720551006 Time :  4128
accuracy train: 1.000000 val: 0.747887 test: 0.746764
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  33 loss training:  1.4124886284698732 Time :  4139
accuracy train: 1.000000 val: 0.750704 test: 0.745076
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  34 loss training:  1.0604800570727093 Time :  4150
accuracy train: 1.000000 val: 0.745070 test: 0.748452
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  35 loss training:  0.8859672421240248 Time :  4161
accuracy train: 1.000000 val: 0.749296 test: 0.751548
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  36 loss training:  0.8112833998238784 Time :  4170
accuracy train: 1.000000 val: 0.754930 test: 0.748734
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  37 loss training:  0.7382166845854954 Time :  4180
accuracy train: 1.000000 val: 0.746479 test: 0.749297
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  38 loss training:  0.4797641990298871 Time :  4190
accuracy train: 1.000000 val: 0.747887 test: 0.745357
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  39 loss training:  0.7809159795069718 Time :  4201
accuracy train: 0.999844 val: 0.746479 test: 0.752392
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  40 loss training:  0.3748584074928658 Time :  4211
accuracy train: 1.000000 val: 0.747887 test: 0.754080
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  41 loss training:  0.5914963837603864 Time :  4222
accuracy train: 0.999844 val: 0.746479 test: 0.753236
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  42 loss training:  0.8351681034291687 Time :  4234
accuracy train: 1.000000 val: 0.753521 test: 0.751266
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

Epoch :  43 loss training:  0.694751276205352 Time :  4245
accuracy train: 1.000000 val: 0.740845 test: 0.748734
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.769555

========================================================================================================================================================================================================
max acc epoch :  12
max validation accuracy :  0.7887323943661971
test accuracy :  0.7695554305008441
last test_accuracy :  0.7487338210467079
max gap 8
========================================================================================================================================================================================================

itr : 8
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=894, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  100.68462231755257 Time :  4258
accuracy train: 0.720381 val: 0.705634 test: 0.706246
max validation accuracy : 0.705634 max acc epoch : 1 test accuracy : 0.706246
Epoch-1 lr: 0.005

Epoch :  2 loss training:  86.4078334569931 Time :  4269
accuracy train: 0.756643 val: 0.723944 test: 0.732696
max validation accuracy : 0.723944 max acc epoch : 2 test accuracy : 0.732696
Epoch-2 lr: 0.005

Epoch :  3 loss training:  92.56950789690018 Time :  4280
accuracy train: 0.811504 val: 0.798592 test: 0.775183
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  77.60355204343796 Time :  4289
accuracy train: 0.817756 val: 0.770423 test: 0.770400
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  76.70656934380531 Time :  4299
accuracy train: 0.815411 val: 0.770423 test: 0.757456
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  74.66301935911179 Time :  4310
accuracy train: 0.846202 val: 0.791549 test: 0.777715
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  71.96681824326515 Time :  4320
accuracy train: 0.849484 val: 0.752113 test: 0.772651
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  70.44921244680882 Time :  4330
accuracy train: 0.862770 val: 0.771831 test: 0.780529
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  67.00781796872616 Time :  4341
accuracy train: 0.870116 val: 0.770423 test: 0.776871
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  63.42221976816654 Time :  4351
accuracy train: 0.880431 val: 0.788732 test: 0.775183
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183

Epoch :  11 loss training:  61.120552480220795 Time :  4363
accuracy train: 0.911535 val: 0.784507 test: 0.784468
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183

Epoch :  12 loss training:  52.60831247270107 Time :  4373
accuracy train: 0.937637 val: 0.763380 test: 0.776871
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183

Epoch :  13 loss training:  42.96483211219311 Time :  4384
accuracy train: 0.956862 val: 0.771831 test: 0.778841
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183

Epoch :  14 loss training:  34.20906636863947 Time :  4394
accuracy train: 0.974523 val: 0.767606 test: 0.774620
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183

Epoch :  15 loss training:  27.338803872466087 Time :  4405
accuracy train: 0.982338 val: 0.761972 test: 0.768993
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183

Epoch :  16 loss training:  21.621130522340536 Time :  4414
accuracy train: 0.989997 val: 0.756338 test: 0.764491
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183

Epoch :  17 loss training:  16.586648531258106 Time :  4424
accuracy train: 0.995780 val: 0.750704 test: 0.767867
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183

Epoch :  18 loss training:  12.911775248125196 Time :  4435
accuracy train: 0.997030 val: 0.747887 test: 0.760551
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183

Epoch :  19 loss training:  9.580124475993216 Time :  4443
accuracy train: 0.998906 val: 0.757746 test: 0.760833
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183

Epoch :  20 loss training:  7.725499530788511 Time :  4455
accuracy train: 0.999062 val: 0.752113 test: 0.755205
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183

Epoch :  21 loss training:  7.033002646639943 Time :  4465
accuracy train: 0.999531 val: 0.750704 test: 0.751829
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183

Epoch :  22 loss training:  5.981939629651606 Time :  4477
accuracy train: 0.999687 val: 0.750704 test: 0.753517
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183

Epoch :  23 loss training:  5.018773928517476 Time :  4485
accuracy train: 0.999844 val: 0.754930 test: 0.750422
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183

Epoch :  24 loss training:  4.047403129050508 Time :  4497
accuracy train: 0.999844 val: 0.752113 test: 0.743106
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183

Epoch :  25 loss training:  3.137018439359963 Time :  4507
accuracy train: 0.999687 val: 0.757746 test: 0.749015
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183

Epoch :  26 loss training:  2.9034770351136103 Time :  4517
accuracy train: 0.999687 val: 0.754930 test: 0.752110
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183

Epoch :  27 loss training:  2.3731082431040704 Time :  4527
accuracy train: 0.999844 val: 0.747887 test: 0.744795
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183

Epoch :  28 loss training:  1.9080152625101618 Time :  4537
accuracy train: 1.000000 val: 0.747887 test: 0.749015
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183

Epoch :  29 loss training:  2.023867776733823 Time :  4547
accuracy train: 1.000000 val: 0.743662 test: 0.746201
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183

Epoch :  30 loss training:  2.012687030422967 Time :  4556
accuracy train: 1.000000 val: 0.735211 test: 0.748452
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183

Epoch :  31 loss training:  1.2731865353998728 Time :  4568
accuracy train: 1.000000 val: 0.736620 test: 0.749578
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183

Epoch :  32 loss training:  1.0700619171693688 Time :  4578
accuracy train: 1.000000 val: 0.740845 test: 0.744795
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183

Epoch :  33 loss training:  1.118578303285176 Time :  4588
accuracy train: 1.000000 val: 0.745070 test: 0.741137
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183

Epoch :  34 loss training:  0.837334466225002 Time :  4602
accuracy train: 1.000000 val: 0.747887 test: 0.744513
max validation accuracy : 0.798592 max acc epoch : 3 test accuracy : 0.775183

========================================================================================================================================================================================================
max acc epoch :  3
max validation accuracy :  0.7985915492957747
test accuracy :  0.7751828925154756
last test_accuracy :  0.7445132245357344
max gap 1
========================================================================================================================================================================================================

itr : 9
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.005, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=894, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  102.59795299172401 Time :  4613
accuracy train: 0.717255 val: 0.685915 test: 0.692459
max validation accuracy : 0.685915 max acc epoch : 1 test accuracy : 0.692459
Epoch-1 lr: 0.005

Epoch :  2 loss training:  87.44138342142105 Time :  4621
accuracy train: 0.768053 val: 0.761972 test: 0.746483
max validation accuracy : 0.761972 max acc epoch : 2 test accuracy : 0.746483
Epoch-2 lr: 0.005

Epoch :  3 loss training:  93.90941759943962 Time :  4634
accuracy train: 0.805095 val: 0.769014 test: 0.759145
max validation accuracy : 0.769014 max acc epoch : 3 test accuracy : 0.759145
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  73.65714445710182 Time :  4648
accuracy train: 0.841982 val: 0.770423 test: 0.774620
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.774620
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  70.81457503139973 Time :  4658
accuracy train: 0.847140 val: 0.771831 test: 0.771806
max validation accuracy : 0.771831 max acc epoch : 5 test accuracy : 0.771806
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  65.44787533581257 Time :  4668
accuracy train: 0.885120 val: 0.776056 test: 0.777153
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  59.92607007920742 Time :  4679
accuracy train: 0.898406 val: 0.749296 test: 0.763084
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  55.48399415612221 Time :  4689
accuracy train: 0.922788 val: 0.770423 test: 0.776027
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  52.032680958509445 Time :  4698
accuracy train: 0.941388 val: 0.769014 test: 0.777153
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  46.82981622219086 Time :  4711
accuracy train: 0.946077 val: 0.766197 test: 0.778278
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  11 loss training:  43.94004639983177 Time :  4720
accuracy train: 0.965302 val: 0.771831 test: 0.779685
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  12 loss training:  36.451169811189175 Time :  4729
accuracy train: 0.979212 val: 0.769014 test: 0.781373
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  13 loss training:  27.81084879115224 Time :  4740
accuracy train: 0.984683 val: 0.764789 test: 0.776590
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  14 loss training:  21.19470990821719 Time :  4750
accuracy train: 0.993123 val: 0.764789 test: 0.776590
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  15 loss training:  16.296882450580597 Time :  4762
accuracy train: 0.995936 val: 0.756338 test: 0.774902
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  16 loss training:  13.238448159769177 Time :  4773
accuracy train: 0.999062 val: 0.760563 test: 0.773495
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  17 loss training:  10.141425035893917 Time :  4783
accuracy train: 0.998750 val: 0.753521 test: 0.770400
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  18 loss training:  8.069334828294814 Time :  4793
accuracy train: 0.998906 val: 0.764789 test: 0.768711
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  19 loss training:  6.164727839175612 Time :  4802
accuracy train: 0.999844 val: 0.757746 test: 0.763647
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  20 loss training:  5.241131274495274 Time :  4812
accuracy train: 0.999687 val: 0.759155 test: 0.768430
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  21 loss training:  4.629941335646436 Time :  4823
accuracy train: 0.999844 val: 0.766197 test: 0.765898
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  22 loss training:  4.1926533482037485 Time :  4834
accuracy train: 1.000000 val: 0.750704 test: 0.765335
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  23 loss training:  2.85833979526069 Time :  4845
accuracy train: 1.000000 val: 0.764789 test: 0.765616
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  24 loss training:  2.573759594350122 Time :  4855
accuracy train: 0.999844 val: 0.753521 test: 0.757175
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  25 loss training:  2.324685665196739 Time :  4865
accuracy train: 1.000000 val: 0.769014 test: 0.765053
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  26 loss training:  1.8896741026546806 Time :  4876
accuracy train: 1.000000 val: 0.771831 test: 0.758582
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  27 loss training:  1.6139256140450016 Time :  4886
accuracy train: 1.000000 val: 0.769014 test: 0.754643
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  28 loss training:  1.6669482240395155 Time :  4897
accuracy train: 0.999844 val: 0.756338 test: 0.759426
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  29 loss training:  1.507189454860054 Time :  4909
accuracy train: 1.000000 val: 0.764789 test: 0.763084
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  30 loss training:  1.2633267095661722 Time :  4918
accuracy train: 1.000000 val: 0.760563 test: 0.757456
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  31 loss training:  0.9724776060902514 Time :  4927
accuracy train: 1.000000 val: 0.766197 test: 0.761958
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  32 loss training:  0.9357113698351895 Time :  4941
accuracy train: 1.000000 val: 0.766197 test: 0.759989
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  33 loss training:  0.7071086309442762 Time :  4950
accuracy train: 1.000000 val: 0.763380 test: 0.758301
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  34 loss training:  0.8984384603390936 Time :  4960
accuracy train: 1.000000 val: 0.760563 test: 0.756894
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  35 loss training:  0.6422300342383096 Time :  4973
accuracy train: 1.000000 val: 0.773239 test: 0.761114
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  36 loss training:  0.709785270242719 Time :  4982
accuracy train: 1.000000 val: 0.769014 test: 0.759707
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

Epoch :  37 loss training:  0.5899006105319131 Time :  4993
accuracy train: 1.000000 val: 0.770423 test: 0.754924
max validation accuracy : 0.776056 max acc epoch : 6 test accuracy : 0.777153

========================================================================================================================================================================================================
max acc epoch :  6
max validation accuracy :  0.776056338028169
test accuracy :  0.7771525042205966
last test_accuracy :  0.7549240292628024
max gap 1
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.78169 	 test_accuracy : 0.77518 	 max_acc epoch :  9 	 last test_accuracy : 0.75098
k :  1 	 val_accuracy : 0.79155 	 test_accuracy : 0.77378 	 max_acc epoch :  11 	 last test_accuracy : 0.74423
k :  2 	 val_accuracy : 0.79014 	 test_accuracy : 0.77715 	 max_acc epoch :  6 	 last test_accuracy : 0.75577
k :  3 	 val_accuracy : 0.78310 	 test_accuracy : 0.77378 	 max_acc epoch :  11 	 last test_accuracy : 0.74817
k :  4 	 val_accuracy : 0.78592 	 test_accuracy : 0.77603 	 max_acc epoch :  4 	 last test_accuracy : 0.75352
k :  5 	 val_accuracy : 0.78028 	 test_accuracy : 0.77237 	 max_acc epoch :  8 	 last test_accuracy : 0.74705
k :  6 	 val_accuracy : 0.78873 	 test_accuracy : 0.74395 	 max_acc epoch :  37 	 last test_accuracy : 0.73720
k :  7 	 val_accuracy : 0.78873 	 test_accuracy : 0.76956 	 max_acc epoch :  12 	 last test_accuracy : 0.74873
k :  8 	 val_accuracy : 0.79859 	 test_accuracy : 0.77518 	 max_acc epoch :  3 	 last test_accuracy : 0.74451
k :  9 	 val_accuracy : 0.77606 	 test_accuracy : 0.77715 	 max_acc epoch :  6 	 last test_accuracy : 0.75492

avg :  	 val_accuracy : 0.78648 	 test_accuracy : 0.77141 	 last_accuracy : 0.74851


date and time :  Fri Jun 11 01:33:53 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=359, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  90.01419985294342 Time :  11
accuracy train: 0.782119 val: 0.746479 test: 0.762802
max validation accuracy : 0.746479 max acc epoch : 1 test accuracy : 0.762802
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  82.20799168944359 Time :  22
accuracy train: 0.799312 val: 0.753521 test: 0.770400
max validation accuracy : 0.753521 max acc epoch : 2 test accuracy : 0.770400
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  78.45068401098251 Time :  35
accuracy train: 0.811816 val: 0.761972 test: 0.775464
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.775464
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  74.29879102110863 Time :  46
accuracy train: 0.828071 val: 0.773239 test: 0.772369
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.772369
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  72.18225228786469 Time :  55
accuracy train: 0.832448 val: 0.764789 test: 0.770400
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.772369
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.43908181786537 Time :  70
accuracy train: 0.833698 val: 0.766197 test: 0.776590
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.772369
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.15267004072666 Time :  80
accuracy train: 0.842763 val: 0.771831 test: 0.777715
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.772369
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.57981690764427 Time :  88
accuracy train: 0.851516 val: 0.780282 test: 0.773213
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773213
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  68.03467771410942 Time :  99
accuracy train: 0.852766 val: 0.780282 test: 0.774902
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773213
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  65.7721621543169 Time :  109
accuracy train: 0.854329 val: 0.780282 test: 0.779122
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773213

Epoch :  11 loss training:  65.05785413086414 Time :  118
accuracy train: 0.864489 val: 0.777465 test: 0.777434
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773213

Epoch :  12 loss training:  63.00158026814461 Time :  131
accuracy train: 0.865270 val: 0.777465 test: 0.776590
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773213

Epoch :  13 loss training:  62.2895614951849 Time :  142
accuracy train: 0.878868 val: 0.792958 test: 0.773213
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  14 loss training:  60.63454265892506 Time :  151
accuracy train: 0.883557 val: 0.784507 test: 0.775464
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  15 loss training:  58.27867078781128 Time :  161
accuracy train: 0.890122 val: 0.784507 test: 0.777715
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  16 loss training:  58.18288333714008 Time :  168
accuracy train: 0.894811 val: 0.783099 test: 0.770681
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  17 loss training:  55.29188232123852 Time :  180
accuracy train: 0.902157 val: 0.780282 test: 0.777715
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  18 loss training:  53.91415438055992 Time :  195
accuracy train: 0.910441 val: 0.780282 test: 0.770681
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  19 loss training:  53.1159823089838 Time :  205
accuracy train: 0.915755 val: 0.780282 test: 0.769837
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  20 loss training:  50.39949916303158 Time :  215
accuracy train: 0.920444 val: 0.784507 test: 0.776027
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  21 loss training:  48.51264873147011 Time :  228
accuracy train: 0.926071 val: 0.791549 test: 0.771244
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  22 loss training:  48.21280674636364 Time :  238
accuracy train: 0.932479 val: 0.785915 test: 0.768993
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  23 loss training:  45.86972984671593 Time :  247
accuracy train: 0.935136 val: 0.784507 test: 0.775746
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  24 loss training:  44.66117823123932 Time :  259
accuracy train: 0.943889 val: 0.787324 test: 0.773776
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  25 loss training:  42.9630813524127 Time :  268
accuracy train: 0.946858 val: 0.781690 test: 0.770400
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  26 loss training:  41.514585606753826 Time :  279
accuracy train: 0.952485 val: 0.785915 test: 0.771806
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  27 loss training:  39.284837044775486 Time :  289
accuracy train: 0.954673 val: 0.785915 test: 0.774339
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  28 loss training:  37.56183212995529 Time :  298
accuracy train: 0.958893 val: 0.783099 test: 0.768993
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  29 loss training:  37.795120887458324 Time :  310
accuracy train: 0.961238 val: 0.784507 test: 0.773213
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  30 loss training:  36.147510059177876 Time :  319
accuracy train: 0.964989 val: 0.791549 test: 0.769837
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  31 loss training:  34.15224976465106 Time :  330
accuracy train: 0.969678 val: 0.784507 test: 0.770118
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  32 loss training:  33.19453886896372 Time :  343
accuracy train: 0.971397 val: 0.785915 test: 0.769555
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  33 loss training:  32.650086373090744 Time :  351
accuracy train: 0.973273 val: 0.777465 test: 0.772369
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  34 loss training:  31.596621461212635 Time :  359
accuracy train: 0.975617 val: 0.774648 test: 0.773776
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  35 loss training:  29.8373657874763 Time :  371
accuracy train: 0.980932 val: 0.773239 test: 0.769555
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  36 loss training:  27.834788158535957 Time :  380
accuracy train: 0.982182 val: 0.787324 test: 0.768430
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  37 loss training:  27.152695529162884 Time :  389
accuracy train: 0.982182 val: 0.774648 test: 0.765616
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  38 loss training:  27.44313422590494 Time :  400
accuracy train: 0.984526 val: 0.770423 test: 0.771806
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  39 loss training:  25.681994136422873 Time :  412
accuracy train: 0.985777 val: 0.778873 test: 0.769555
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  40 loss training:  24.917070407420397 Time :  421
accuracy train: 0.989059 val: 0.764789 test: 0.765616
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  41 loss training:  24.403271723538637 Time :  431
accuracy train: 0.988590 val: 0.778873 test: 0.765898
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  42 loss training:  23.93908570893109 Time :  443
accuracy train: 0.991247 val: 0.777465 test: 0.771244
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  43 loss training:  22.769866351038218 Time :  453
accuracy train: 0.992810 val: 0.770423 test: 0.768149
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

Epoch :  44 loss training:  21.669999711215496 Time :  465
accuracy train: 0.992810 val: 0.771831 test: 0.770681
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.773213

========================================================================================================================================================================================================
max acc epoch :  13
max validation accuracy :  0.7929577464788733
test accuracy :  0.7732132808103546
last test_accuracy :  0.7706809229037704
max gap 5
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=359, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  90.02667580544949 Time :  482
accuracy train: 0.783057 val: 0.749296 test: 0.764209
max validation accuracy : 0.749296 max acc epoch : 1 test accuracy : 0.764209
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  82.10317033529282 Time :  489
accuracy train: 0.797124 val: 0.764789 test: 0.773495
max validation accuracy : 0.764789 max acc epoch : 2 test accuracy : 0.773495
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  78.49516287446022 Time :  496
accuracy train: 0.811504 val: 0.760563 test: 0.772088
max validation accuracy : 0.764789 max acc epoch : 2 test accuracy : 0.773495
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  74.15926828980446 Time :  508
accuracy train: 0.823851 val: 0.770423 test: 0.771244
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.771244
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  72.05558305978775 Time :  518
accuracy train: 0.831510 val: 0.770423 test: 0.770118
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.771244
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.4047438800335 Time :  529
accuracy train: 0.836980 val: 0.769014 test: 0.774902
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.771244
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.04101906716824 Time :  539
accuracy train: 0.843857 val: 0.771831 test: 0.777997
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.44883778691292 Time :  549
accuracy train: 0.853704 val: 0.784507 test: 0.775746
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.775746
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.8555079549551 Time :  559
accuracy train: 0.857143 val: 0.781690 test: 0.774620
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.775746
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  65.84262102842331 Time :  570
accuracy train: 0.857299 val: 0.774648 test: 0.776027
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.775746

Epoch :  11 loss training:  64.88737054169178 Time :  580
accuracy train: 0.866052 val: 0.778873 test: 0.775746
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.775746

Epoch :  12 loss training:  62.79003331065178 Time :  590
accuracy train: 0.866208 val: 0.784507 test: 0.773495
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.775746

Epoch :  13 loss training:  62.171165108680725 Time :  603
accuracy train: 0.878868 val: 0.783099 test: 0.776308
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.775746

Epoch :  14 loss training:  60.55292443931103 Time :  619
accuracy train: 0.885277 val: 0.790141 test: 0.777997
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.777997

Epoch :  15 loss training:  58.3199030905962 Time :  630
accuracy train: 0.890435 val: 0.788732 test: 0.774620
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.777997

Epoch :  16 loss training:  58.226659402251244 Time :  641
accuracy train: 0.896686 val: 0.781690 test: 0.776590
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.777997

Epoch :  17 loss training:  55.23341152071953 Time :  651
accuracy train: 0.903564 val: 0.784507 test: 0.778559
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.777997

Epoch :  18 loss training:  53.98045854270458 Time :  662
accuracy train: 0.913879 val: 0.784507 test: 0.773776
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.777997

Epoch :  19 loss training:  53.083081394433975 Time :  672
accuracy train: 0.919506 val: 0.784507 test: 0.771525
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.777997

Epoch :  20 loss training:  50.369358107447624 Time :  681
accuracy train: 0.921851 val: 0.788732 test: 0.772369
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.777997

Epoch :  21 loss training:  48.52584180235863 Time :  692
accuracy train: 0.929197 val: 0.785915 test: 0.773495
max validation accuracy : 0.790141 max acc epoch : 14 test accuracy : 0.777997

Epoch :  22 loss training:  47.91751469671726 Time :  703
accuracy train: 0.934823 val: 0.794366 test: 0.774902
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  23 loss training:  45.816433288156986 Time :  713
accuracy train: 0.937324 val: 0.787324 test: 0.775746
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  24 loss training:  44.52393355965614 Time :  721
accuracy train: 0.945139 val: 0.783099 test: 0.776308
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  25 loss training:  42.94448937475681 Time :  731
accuracy train: 0.950610 val: 0.780282 test: 0.773495
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  26 loss training:  41.48201225697994 Time :  741
accuracy train: 0.951860 val: 0.781690 test: 0.770962
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  27 loss training:  39.23612594604492 Time :  752
accuracy train: 0.955767 val: 0.785915 test: 0.772088
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  28 loss training:  37.17465478181839 Time :  764
accuracy train: 0.958425 val: 0.788732 test: 0.769274
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  29 loss training:  37.54689026623964 Time :  775
accuracy train: 0.964520 val: 0.783099 test: 0.773776
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  30 loss training:  36.369165025651455 Time :  783
accuracy train: 0.966708 val: 0.781690 test: 0.769837
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  31 loss training:  34.10448285937309 Time :  794
accuracy train: 0.970772 val: 0.783099 test: 0.773776
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  32 loss training:  33.29762827605009 Time :  806
accuracy train: 0.974523 val: 0.783099 test: 0.770681
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  33 loss training:  32.71992939710617 Time :  817
accuracy train: 0.976711 val: 0.777465 test: 0.768993
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  34 loss training:  31.303957246243954 Time :  827
accuracy train: 0.977337 val: 0.773239 test: 0.775746
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  35 loss training:  29.21557128429413 Time :  835
accuracy train: 0.981557 val: 0.777465 test: 0.770118
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  36 loss training:  27.798263732343912 Time :  846
accuracy train: 0.983120 val: 0.788732 test: 0.771525
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  37 loss training:  27.097408182919025 Time :  856
accuracy train: 0.984058 val: 0.774648 test: 0.766742
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  38 loss training:  27.269262101501226 Time :  866
accuracy train: 0.986402 val: 0.774648 test: 0.772651
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  39 loss training:  25.817644331604242 Time :  875
accuracy train: 0.987652 val: 0.778873 test: 0.768993
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  40 loss training:  24.856810871511698 Time :  885
accuracy train: 0.990153 val: 0.770423 test: 0.766179
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  41 loss training:  24.412766721099615 Time :  899
accuracy train: 0.988590 val: 0.777465 test: 0.766460
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  42 loss training:  23.87373792566359 Time :  910
accuracy train: 0.991404 val: 0.777465 test: 0.766179
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  43 loss training:  22.588999392464757 Time :  921
accuracy train: 0.993435 val: 0.771831 test: 0.767867
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  44 loss training:  21.253981778398156 Time :  931
accuracy train: 0.993592 val: 0.771831 test: 0.770118
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  45 loss training:  21.212370581924915 Time :  940
accuracy train: 0.993748 val: 0.778873 test: 0.770118
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  46 loss training:  20.88195519335568 Time :  950
accuracy train: 0.993904 val: 0.774648 test: 0.766460
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  47 loss training:  19.79869239591062 Time :  958
accuracy train: 0.994373 val: 0.776056 test: 0.771244
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  48 loss training:  20.283508755266666 Time :  968
accuracy train: 0.996718 val: 0.780282 test: 0.765898
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  49 loss training:  17.805691683664918 Time :  975
accuracy train: 0.996405 val: 0.773239 test: 0.766179
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  50 loss training:  17.175026390701532 Time :  985
accuracy train: 0.997343 val: 0.774648 test: 0.767304
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  51 loss training:  16.444585783407092 Time :  995
accuracy train: 0.997968 val: 0.781690 test: 0.767867
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  52 loss training:  17.299121042713523 Time :  1005
accuracy train: 0.997187 val: 0.788732 test: 0.762521
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

Epoch :  53 loss training:  15.93131860718131 Time :  1014
accuracy train: 0.997968 val: 0.764789 test: 0.765053
max validation accuracy : 0.794366 max acc epoch : 22 test accuracy : 0.774902

========================================================================================================================================================================================================
max acc epoch :  22
max validation accuracy :  0.7943661971830986
test accuracy :  0.7749015194147439
last test_accuracy :  0.765053460889139
max gap 8
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=359, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  90.05164811015129 Time :  1027
accuracy train: 0.782588 val: 0.747887 test: 0.765053
max validation accuracy : 0.747887 max acc epoch : 1 test accuracy : 0.765053
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  82.09526419639587 Time :  1039
accuracy train: 0.799625 val: 0.756338 test: 0.775183
max validation accuracy : 0.756338 max acc epoch : 2 test accuracy : 0.775183
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  78.4763610959053 Time :  1049
accuracy train: 0.813535 val: 0.759155 test: 0.774620
max validation accuracy : 0.759155 max acc epoch : 3 test accuracy : 0.774620
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  74.19873425364494 Time :  1061
accuracy train: 0.827759 val: 0.766197 test: 0.773213
max validation accuracy : 0.766197 max acc epoch : 4 test accuracy : 0.773213
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  72.32425366342068 Time :  1071
accuracy train: 0.829947 val: 0.764789 test: 0.771525
max validation accuracy : 0.766197 max acc epoch : 4 test accuracy : 0.773213
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.38517190515995 Time :  1080
accuracy train: 0.834948 val: 0.770423 test: 0.774620
max validation accuracy : 0.770423 max acc epoch : 6 test accuracy : 0.774620
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.03242534399033 Time :  1091
accuracy train: 0.844795 val: 0.774648 test: 0.779403
max validation accuracy : 0.774648 max acc epoch : 7 test accuracy : 0.779403
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.51449401676655 Time :  1101
accuracy train: 0.852610 val: 0.778873 test: 0.773776
max validation accuracy : 0.778873 max acc epoch : 8 test accuracy : 0.773776
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.96827559173107 Time :  1110
accuracy train: 0.851829 val: 0.778873 test: 0.774057
max validation accuracy : 0.778873 max acc epoch : 8 test accuracy : 0.773776
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  65.7719439715147 Time :  1121
accuracy train: 0.853392 val: 0.776056 test: 0.777715
max validation accuracy : 0.778873 max acc epoch : 8 test accuracy : 0.773776

Epoch :  11 loss training:  64.78322222828865 Time :  1131
accuracy train: 0.864645 val: 0.771831 test: 0.775464
max validation accuracy : 0.778873 max acc epoch : 8 test accuracy : 0.773776

Epoch :  12 loss training:  62.94860343635082 Time :  1141
accuracy train: 0.865896 val: 0.784507 test: 0.773213
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.773213

Epoch :  13 loss training:  62.47507295012474 Time :  1151
accuracy train: 0.880119 val: 0.778873 test: 0.773776
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.773213

Epoch :  14 loss training:  60.660911321640015 Time :  1161
accuracy train: 0.883401 val: 0.778873 test: 0.776871
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.773213

Epoch :  15 loss training:  58.3560673892498 Time :  1171
accuracy train: 0.892623 val: 0.785915 test: 0.775746
max validation accuracy : 0.785915 max acc epoch : 15 test accuracy : 0.775746

Epoch :  16 loss training:  58.02166700363159 Time :  1184
accuracy train: 0.896999 val: 0.783099 test: 0.772651
max validation accuracy : 0.785915 max acc epoch : 15 test accuracy : 0.775746

Epoch :  17 loss training:  55.30080184340477 Time :  1195
accuracy train: 0.902938 val: 0.780282 test: 0.779966
max validation accuracy : 0.785915 max acc epoch : 15 test accuracy : 0.775746

Epoch :  18 loss training:  53.96901024878025 Time :  1204
accuracy train: 0.911379 val: 0.787324 test: 0.774620
max validation accuracy : 0.787324 max acc epoch : 18 test accuracy : 0.774620

Epoch :  19 loss training:  53.149669513106346 Time :  1215
accuracy train: 0.915755 val: 0.783099 test: 0.771806
max validation accuracy : 0.787324 max acc epoch : 18 test accuracy : 0.774620

Epoch :  20 loss training:  50.61800496280193 Time :  1226
accuracy train: 0.921225 val: 0.784507 test: 0.773213
max validation accuracy : 0.787324 max acc epoch : 18 test accuracy : 0.774620

Epoch :  21 loss training:  48.47057147324085 Time :  1237
accuracy train: 0.927321 val: 0.788732 test: 0.772651
max validation accuracy : 0.788732 max acc epoch : 21 test accuracy : 0.772651

Epoch :  22 loss training:  47.866843834519386 Time :  1247
accuracy train: 0.933260 val: 0.790141 test: 0.772932
max validation accuracy : 0.790141 max acc epoch : 22 test accuracy : 0.772932

Epoch :  23 loss training:  45.76195850968361 Time :  1257
accuracy train: 0.935136 val: 0.785915 test: 0.777434
max validation accuracy : 0.790141 max acc epoch : 22 test accuracy : 0.772932

Epoch :  24 loss training:  44.459392070770264 Time :  1268
accuracy train: 0.941857 val: 0.784507 test: 0.774620
max validation accuracy : 0.790141 max acc epoch : 22 test accuracy : 0.772932

Epoch :  25 loss training:  43.00563506036997 Time :  1278
accuracy train: 0.948421 val: 0.778873 test: 0.772088
max validation accuracy : 0.790141 max acc epoch : 22 test accuracy : 0.772932

Epoch :  26 loss training:  41.666928328573704 Time :  1287
accuracy train: 0.951391 val: 0.784507 test: 0.774620
max validation accuracy : 0.790141 max acc epoch : 22 test accuracy : 0.772932

Epoch :  27 loss training:  39.400562047958374 Time :  1298
accuracy train: 0.953736 val: 0.781690 test: 0.772932
max validation accuracy : 0.790141 max acc epoch : 22 test accuracy : 0.772932

Epoch :  28 loss training:  37.60205554962158 Time :  1308
accuracy train: 0.957174 val: 0.784507 test: 0.773776
max validation accuracy : 0.790141 max acc epoch : 22 test accuracy : 0.772932

Epoch :  29 loss training:  37.583187364041805 Time :  1321
accuracy train: 0.961863 val: 0.792958 test: 0.775183
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  30 loss training:  36.56881753355265 Time :  1333
accuracy train: 0.963426 val: 0.785915 test: 0.775746
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  31 loss training:  34.66078156977892 Time :  1341
accuracy train: 0.968584 val: 0.783099 test: 0.771806
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  32 loss training:  33.64876675605774 Time :  1353
accuracy train: 0.970147 val: 0.778873 test: 0.769555
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  33 loss training:  33.14105898141861 Time :  1363
accuracy train: 0.973273 val: 0.777465 test: 0.770400
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  34 loss training:  31.530503258109093 Time :  1372
accuracy train: 0.974367 val: 0.778873 test: 0.774339
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  35 loss training:  29.70519319921732 Time :  1383
accuracy train: 0.979212 val: 0.774648 test: 0.769837
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  36 loss training:  28.36572502553463 Time :  1394
accuracy train: 0.981244 val: 0.785915 test: 0.773213
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  37 loss training:  27.50415227562189 Time :  1403
accuracy train: 0.983901 val: 0.773239 test: 0.765616
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  38 loss training:  27.347591772675514 Time :  1413
accuracy train: 0.984995 val: 0.770423 test: 0.773776
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  39 loss training:  25.99268116056919 Time :  1421
accuracy train: 0.987183 val: 0.774648 test: 0.770962
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  40 loss training:  24.818224001675844 Time :  1432
accuracy train: 0.988746 val: 0.767606 test: 0.769555
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  41 loss training:  24.68431143462658 Time :  1442
accuracy train: 0.987809 val: 0.773239 test: 0.769837
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  42 loss training:  24.249694142490625 Time :  1454
accuracy train: 0.991247 val: 0.771831 test: 0.771806
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  43 loss training:  23.54034868441522 Time :  1464
accuracy train: 0.992967 val: 0.761972 test: 0.770400
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  44 loss training:  21.620520632714033 Time :  1474
accuracy train: 0.991560 val: 0.761972 test: 0.770962
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  45 loss training:  21.102612886577845 Time :  1484
accuracy train: 0.993123 val: 0.770423 test: 0.773776
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  46 loss training:  20.56657866574824 Time :  1494
accuracy train: 0.993435 val: 0.764789 test: 0.765335
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  47 loss training:  19.892185365781188 Time :  1503
accuracy train: 0.993748 val: 0.777465 test: 0.768149
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  48 loss training:  20.5862601660192 Time :  1515
accuracy train: 0.996093 val: 0.784507 test: 0.770118
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  49 loss training:  18.07509819418192 Time :  1526
accuracy train: 0.996718 val: 0.776056 test: 0.770681
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  50 loss training:  17.489283479750156 Time :  1535
accuracy train: 0.994998 val: 0.773239 test: 0.767023
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  51 loss training:  16.51944430731237 Time :  1545
accuracy train: 0.997030 val: 0.778873 test: 0.770962
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  52 loss training:  16.975229387171566 Time :  1556
accuracy train: 0.996405 val: 0.792958 test: 0.763084
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  53 loss training:  16.029904909431934 Time :  1566
accuracy train: 0.997187 val: 0.754930 test: 0.769274
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  54 loss training:  15.677884026430547 Time :  1577
accuracy train: 0.997656 val: 0.766197 test: 0.767023
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  55 loss training:  15.30073750950396 Time :  1589
accuracy train: 0.998281 val: 0.766197 test: 0.768149
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  56 loss training:  13.846001015044749 Time :  1599
accuracy train: 0.998124 val: 0.770423 test: 0.764491
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  57 loss training:  13.383909087162465 Time :  1610
accuracy train: 0.998750 val: 0.774648 test: 0.770400
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  58 loss training:  13.296388439834118 Time :  1620
accuracy train: 0.999062 val: 0.767606 test: 0.763647
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  59 loss training:  14.403544885106385 Time :  1628
accuracy train: 0.998906 val: 0.769014 test: 0.774339
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

Epoch :  60 loss training:  12.48675815621391 Time :  1640
accuracy train: 0.999219 val: 0.769014 test: 0.770962
max validation accuracy : 0.792958 max acc epoch : 29 test accuracy : 0.775183

========================================================================================================================================================================================================
max acc epoch :  29
max validation accuracy :  0.7929577464788733
test accuracy :  0.7751828925154756
last test_accuracy :  0.770962296004502
max gap 7
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=359, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  90.0099849998951 Time :  1653
accuracy train: 0.782901 val: 0.745070 test: 0.764772
max validation accuracy : 0.745070 max acc epoch : 1 test accuracy : 0.764772
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  82.11713594198227 Time :  1663
accuracy train: 0.798062 val: 0.754930 test: 0.772088
max validation accuracy : 0.754930 max acc epoch : 2 test accuracy : 0.772088
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  78.60539391636848 Time :  1673
accuracy train: 0.811347 val: 0.761972 test: 0.774620
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.774620
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  74.35563984513283 Time :  1682
accuracy train: 0.822288 val: 0.769014 test: 0.768711
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.768711
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  72.07550020515919 Time :  1691
accuracy train: 0.831041 val: 0.760563 test: 0.769274
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.768711
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.59440359473228 Time :  1702
accuracy train: 0.834948 val: 0.766197 test: 0.775183
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.768711
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  68.88997575640678 Time :  1712
accuracy train: 0.843389 val: 0.773239 test: 0.777434
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.777434
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.524115473032 Time :  1723
accuracy train: 0.850422 val: 0.778873 test: 0.772932
max validation accuracy : 0.778873 max acc epoch : 8 test accuracy : 0.772932
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.78577062487602 Time :  1735
accuracy train: 0.853079 val: 0.785915 test: 0.772932
max validation accuracy : 0.785915 max acc epoch : 9 test accuracy : 0.772932
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  65.65240806341171 Time :  1747
accuracy train: 0.855424 val: 0.778873 test: 0.778841
max validation accuracy : 0.785915 max acc epoch : 9 test accuracy : 0.772932

Epoch :  11 loss training:  64.7316576987505 Time :  1756
accuracy train: 0.864020 val: 0.774648 test: 0.775183
max validation accuracy : 0.785915 max acc epoch : 9 test accuracy : 0.772932

Epoch :  12 loss training:  62.95824109017849 Time :  1771
accuracy train: 0.867302 val: 0.777465 test: 0.776590
max validation accuracy : 0.785915 max acc epoch : 9 test accuracy : 0.772932

Epoch :  13 loss training:  62.37320551276207 Time :  1782
accuracy train: 0.877149 val: 0.784507 test: 0.775746
max validation accuracy : 0.785915 max acc epoch : 9 test accuracy : 0.772932

Epoch :  14 loss training:  60.71450971066952 Time :  1791
accuracy train: 0.882932 val: 0.784507 test: 0.777715
max validation accuracy : 0.785915 max acc epoch : 9 test accuracy : 0.772932

Epoch :  15 loss training:  58.31586939096451 Time :  1801
accuracy train: 0.890278 val: 0.790141 test: 0.774902
max validation accuracy : 0.790141 max acc epoch : 15 test accuracy : 0.774902

Epoch :  16 loss training:  58.05405259132385 Time :  1815
accuracy train: 0.898406 val: 0.791549 test: 0.771525
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.771525

Epoch :  17 loss training:  55.14338777959347 Time :  1825
accuracy train: 0.903564 val: 0.781690 test: 0.778841
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.771525

Epoch :  18 loss training:  53.955898463726044 Time :  1835
accuracy train: 0.913254 val: 0.787324 test: 0.772932
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.771525

Epoch :  19 loss training:  53.25747086107731 Time :  1846
accuracy train: 0.916380 val: 0.781690 test: 0.771806
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.771525

Epoch :  20 loss training:  50.541121765971184 Time :  1858
accuracy train: 0.921538 val: 0.777465 test: 0.777434
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.771525

Epoch :  21 loss training:  48.53662393987179 Time :  1869
accuracy train: 0.927790 val: 0.785915 test: 0.775464
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.771525

Epoch :  22 loss training:  47.97476643323898 Time :  1879
accuracy train: 0.933886 val: 0.784507 test: 0.770962
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.771525

Epoch :  23 loss training:  45.712799713015556 Time :  1889
accuracy train: 0.937793 val: 0.784507 test: 0.776590
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.771525

Epoch :  24 loss training:  44.76927211880684 Time :  1898
accuracy train: 0.943264 val: 0.777465 test: 0.774902
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.771525

Epoch :  25 loss training:  42.903783813118935 Time :  1908
accuracy train: 0.947327 val: 0.785915 test: 0.773776
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.771525

Epoch :  26 loss training:  41.45042257010937 Time :  1919
accuracy train: 0.952954 val: 0.784507 test: 0.773495
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.771525

Epoch :  27 loss training:  39.716023713350296 Time :  1929
accuracy train: 0.955455 val: 0.797183 test: 0.769555
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  28 loss training:  37.48740032315254 Time :  1939
accuracy train: 0.956862 val: 0.781690 test: 0.769837
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  29 loss training:  37.568983271718025 Time :  1949
accuracy train: 0.961550 val: 0.794366 test: 0.772932
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  30 loss training:  36.35543076694012 Time :  1959
accuracy train: 0.966396 val: 0.788732 test: 0.771525
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  31 loss training:  34.594544004648924 Time :  1966
accuracy train: 0.967802 val: 0.791549 test: 0.770962
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  32 loss training:  33.4902038872242 Time :  1977
accuracy train: 0.970303 val: 0.780282 test: 0.769837
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  33 loss training:  32.689496859908104 Time :  1987
accuracy train: 0.972335 val: 0.784507 test: 0.770400
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  34 loss training:  31.512730091810226 Time :  1997
accuracy train: 0.973742 val: 0.780282 test: 0.774339
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  35 loss training:  29.90199786797166 Time :  2010
accuracy train: 0.979525 val: 0.783099 test: 0.767586
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  36 loss training:  28.461495220661163 Time :  2020
accuracy train: 0.982026 val: 0.784507 test: 0.771244
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  37 loss training:  27.038988798856735 Time :  2030
accuracy train: 0.982651 val: 0.773239 test: 0.769555
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  38 loss training:  27.420612148940563 Time :  2041
accuracy train: 0.985464 val: 0.770423 test: 0.770118
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  39 loss training:  26.146633610129356 Time :  2051
accuracy train: 0.986871 val: 0.774648 test: 0.769555
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  40 loss training:  24.85763891413808 Time :  2061
accuracy train: 0.988903 val: 0.767606 test: 0.763647
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  41 loss training:  24.524272236973047 Time :  2071
accuracy train: 0.986871 val: 0.769014 test: 0.769837
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  42 loss training:  24.28725186176598 Time :  2082
accuracy train: 0.989528 val: 0.767606 test: 0.769837
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  43 loss training:  22.982339769601822 Time :  2092
accuracy train: 0.994061 val: 0.774648 test: 0.769555
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  44 loss training:  21.30143832601607 Time :  2102
accuracy train: 0.992810 val: 0.770423 test: 0.770118
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  45 loss training:  21.642428101971745 Time :  2110
accuracy train: 0.992341 val: 0.776056 test: 0.771244
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  46 loss training:  20.56028612330556 Time :  2121
accuracy train: 0.993904 val: 0.776056 test: 0.767304
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  47 loss training:  19.40855292789638 Time :  2132
accuracy train: 0.993592 val: 0.771831 test: 0.765053
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  48 loss training:  20.41268153861165 Time :  2144
accuracy train: 0.995780 val: 0.784507 test: 0.769837
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  49 loss training:  17.772522561252117 Time :  2156
accuracy train: 0.996249 val: 0.776056 test: 0.761396
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  50 loss training:  17.20150573924184 Time :  2166
accuracy train: 0.996405 val: 0.773239 test: 0.763365
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  51 loss training:  16.099246725440025 Time :  2178
accuracy train: 0.997187 val: 0.770423 test: 0.768149
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  52 loss training:  17.063438959419727 Time :  2187
accuracy train: 0.996249 val: 0.785915 test: 0.761958
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  53 loss training:  16.521587193012238 Time :  2199
accuracy train: 0.997968 val: 0.767606 test: 0.765898
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  54 loss training:  15.821028891019523 Time :  2209
accuracy train: 0.998124 val: 0.776056 test: 0.763928
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  55 loss training:  14.776101424358785 Time :  2218
accuracy train: 0.998124 val: 0.771831 test: 0.764772
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  56 loss training:  14.137380967848003 Time :  2231
accuracy train: 0.997499 val: 0.770423 test: 0.767023
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  57 loss training:  13.715084940195084 Time :  2240
accuracy train: 0.998750 val: 0.769014 test: 0.768993
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

Epoch :  58 loss training:  13.247222905047238 Time :  2250
accuracy train: 0.999062 val: 0.769014 test: 0.766460
max validation accuracy : 0.797183 max acc epoch : 27 test accuracy : 0.769555

========================================================================================================================================================================================================
max acc epoch :  27
max validation accuracy :  0.7971830985915493
test accuracy :  0.7695554305008441
last test_accuracy :  0.7664603263927968
max gap 11
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=359, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  90.00896920263767 Time :  2264
accuracy train: 0.781963 val: 0.746479 test: 0.765335
max validation accuracy : 0.746479 max acc epoch : 1 test accuracy : 0.765335
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  82.25983327627182 Time :  2276
accuracy train: 0.798843 val: 0.747887 test: 0.774620
max validation accuracy : 0.747887 max acc epoch : 2 test accuracy : 0.774620
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  78.47363939881325 Time :  2288
accuracy train: 0.809784 val: 0.764789 test: 0.772651
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.772651
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  74.4127753674984 Time :  2299
accuracy train: 0.823695 val: 0.774648 test: 0.769837
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.769837
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  72.0567384660244 Time :  2307
accuracy train: 0.831041 val: 0.773239 test: 0.772369
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.769837
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.63839717209339 Time :  2318
accuracy train: 0.835417 val: 0.770423 test: 0.774902
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.769837
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.04422718286514 Time :  2327
accuracy train: 0.844326 val: 0.777465 test: 0.775183
max validation accuracy : 0.777465 max acc epoch : 7 test accuracy : 0.775183
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.55188402533531 Time :  2334
accuracy train: 0.852298 val: 0.783099 test: 0.775183
max validation accuracy : 0.783099 max acc epoch : 8 test accuracy : 0.775183
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  68.18321324884892 Time :  2343
accuracy train: 0.854329 val: 0.785915 test: 0.777153
max validation accuracy : 0.785915 max acc epoch : 9 test accuracy : 0.777153
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  65.63743863999844 Time :  2356
accuracy train: 0.854486 val: 0.778873 test: 0.776027
max validation accuracy : 0.785915 max acc epoch : 9 test accuracy : 0.777153

Epoch :  11 loss training:  64.92742824554443 Time :  2367
accuracy train: 0.862770 val: 0.773239 test: 0.774902
max validation accuracy : 0.785915 max acc epoch : 9 test accuracy : 0.777153

Epoch :  12 loss training:  63.16339811682701 Time :  2376
accuracy train: 0.865270 val: 0.774648 test: 0.775464
max validation accuracy : 0.785915 max acc epoch : 9 test accuracy : 0.777153

Epoch :  13 loss training:  62.41114366054535 Time :  2387
accuracy train: 0.879650 val: 0.788732 test: 0.776027
max validation accuracy : 0.788732 max acc epoch : 13 test accuracy : 0.776027

Epoch :  14 loss training:  60.990167781710625 Time :  2399
accuracy train: 0.882151 val: 0.784507 test: 0.779966
max validation accuracy : 0.788732 max acc epoch : 13 test accuracy : 0.776027

Epoch :  15 loss training:  58.32752850651741 Time :  2409
accuracy train: 0.889184 val: 0.788732 test: 0.776027
max validation accuracy : 0.788732 max acc epoch : 13 test accuracy : 0.776027

Epoch :  16 loss training:  58.374933674931526 Time :  2419
accuracy train: 0.897155 val: 0.785915 test: 0.776027
max validation accuracy : 0.788732 max acc epoch : 13 test accuracy : 0.776027

Epoch :  17 loss training:  55.457609459757805 Time :  2430
accuracy train: 0.903095 val: 0.783099 test: 0.778841
max validation accuracy : 0.788732 max acc epoch : 13 test accuracy : 0.776027

Epoch :  18 loss training:  54.08549280464649 Time :  2442
accuracy train: 0.909347 val: 0.784507 test: 0.776590
max validation accuracy : 0.788732 max acc epoch : 13 test accuracy : 0.776027

Epoch :  19 loss training:  53.077286183834076 Time :  2452
accuracy train: 0.915442 val: 0.777465 test: 0.774902
max validation accuracy : 0.788732 max acc epoch : 13 test accuracy : 0.776027

Epoch :  20 loss training:  50.451451033353806 Time :  2464
accuracy train: 0.922319 val: 0.785915 test: 0.779122
max validation accuracy : 0.788732 max acc epoch : 13 test accuracy : 0.776027

Epoch :  21 loss training:  48.31784164905548 Time :  2476
accuracy train: 0.925758 val: 0.784507 test: 0.773213
max validation accuracy : 0.788732 max acc epoch : 13 test accuracy : 0.776027

Epoch :  22 loss training:  48.07728245854378 Time :  2484
accuracy train: 0.930916 val: 0.778873 test: 0.770681
max validation accuracy : 0.788732 max acc epoch : 13 test accuracy : 0.776027

Epoch :  23 loss training:  45.92042180150747 Time :  2495
accuracy train: 0.934198 val: 0.784507 test: 0.778278
max validation accuracy : 0.788732 max acc epoch : 13 test accuracy : 0.776027

Epoch :  24 loss training:  44.48213877528906 Time :  2507
accuracy train: 0.941544 val: 0.776056 test: 0.776027
max validation accuracy : 0.788732 max acc epoch : 13 test accuracy : 0.776027

Epoch :  25 loss training:  42.95921690016985 Time :  2516
accuracy train: 0.947015 val: 0.783099 test: 0.771244
max validation accuracy : 0.788732 max acc epoch : 13 test accuracy : 0.776027

Epoch :  26 loss training:  41.27795308828354 Time :  2525
accuracy train: 0.949203 val: 0.781690 test: 0.773495
max validation accuracy : 0.788732 max acc epoch : 13 test accuracy : 0.776027

Epoch :  27 loss training:  39.40603294968605 Time :  2538
accuracy train: 0.952329 val: 0.783099 test: 0.770962
max validation accuracy : 0.788732 max acc epoch : 13 test accuracy : 0.776027

Epoch :  28 loss training:  37.69102996587753 Time :  2547
accuracy train: 0.958112 val: 0.778873 test: 0.774902
max validation accuracy : 0.788732 max acc epoch : 13 test accuracy : 0.776027

Epoch :  29 loss training:  37.72421547025442 Time :  2558
accuracy train: 0.960144 val: 0.790141 test: 0.773213
max validation accuracy : 0.790141 max acc epoch : 29 test accuracy : 0.773213

Epoch :  30 loss training:  36.09527911990881 Time :  2570
accuracy train: 0.965927 val: 0.781690 test: 0.773213
max validation accuracy : 0.790141 max acc epoch : 29 test accuracy : 0.773213

Epoch :  31 loss training:  34.60262322053313 Time :  2582
accuracy train: 0.966865 val: 0.780282 test: 0.770962
max validation accuracy : 0.790141 max acc epoch : 29 test accuracy : 0.773213

Epoch :  32 loss training:  33.40680477023125 Time :  2591
accuracy train: 0.970928 val: 0.787324 test: 0.769274
max validation accuracy : 0.790141 max acc epoch : 29 test accuracy : 0.773213

Epoch :  33 loss training:  32.90097028017044 Time :  2601
accuracy train: 0.972804 val: 0.784507 test: 0.769555
max validation accuracy : 0.790141 max acc epoch : 29 test accuracy : 0.773213

Epoch :  34 loss training:  31.51395519822836 Time :  2612
accuracy train: 0.975461 val: 0.784507 test: 0.774057
max validation accuracy : 0.790141 max acc epoch : 29 test accuracy : 0.773213

Epoch :  35 loss training:  29.831646777689457 Time :  2621
accuracy train: 0.980775 val: 0.791549 test: 0.771806
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  36 loss training:  28.03663369268179 Time :  2631
accuracy train: 0.982495 val: 0.788732 test: 0.769837
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  37 loss training:  27.38352432474494 Time :  2643
accuracy train: 0.984370 val: 0.776056 test: 0.766742
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  38 loss training:  27.073186822235584 Time :  2653
accuracy train: 0.985308 val: 0.781690 test: 0.772369
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  39 loss training:  25.899249959737062 Time :  2663
accuracy train: 0.986871 val: 0.769014 test: 0.764772
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  40 loss training:  24.928907562047243 Time :  2673
accuracy train: 0.988434 val: 0.776056 test: 0.768711
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  41 loss training:  24.2872851267457 Time :  2684
accuracy train: 0.987496 val: 0.770423 test: 0.770118
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  42 loss training:  23.917284656316042 Time :  2698
accuracy train: 0.992029 val: 0.771831 test: 0.772932
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  43 loss training:  22.689693223685026 Time :  2709
accuracy train: 0.993904 val: 0.767606 test: 0.767586
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  44 loss training:  21.38215461373329 Time :  2721
accuracy train: 0.992967 val: 0.770423 test: 0.770118
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  45 loss training:  21.439955407753587 Time :  2729
accuracy train: 0.992967 val: 0.776056 test: 0.772369
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  46 loss training:  20.742886390537024 Time :  2743
accuracy train: 0.994686 val: 0.770423 test: 0.765616
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  47 loss training:  19.851556418463588 Time :  2755
accuracy train: 0.994373 val: 0.776056 test: 0.770400
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  48 loss training:  20.164194107055664 Time :  2764
accuracy train: 0.996405 val: 0.781690 test: 0.767304
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  49 loss training:  17.685610020533204 Time :  2775
accuracy train: 0.997030 val: 0.777465 test: 0.765335
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  50 loss training:  16.965952220372856 Time :  2788
accuracy train: 0.996093 val: 0.774648 test: 0.766742
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  51 loss training:  16.071557980030775 Time :  2798
accuracy train: 0.997812 val: 0.780282 test: 0.773213
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  52 loss training:  17.12642681784928 Time :  2807
accuracy train: 0.996874 val: 0.777465 test: 0.764491
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  53 loss training:  15.823730236850679 Time :  2821
accuracy train: 0.997812 val: 0.776056 test: 0.769555
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  54 loss training:  15.696241253521293 Time :  2828
accuracy train: 0.997968 val: 0.774648 test: 0.768430
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  55 loss training:  15.027188677340746 Time :  2840
accuracy train: 0.998593 val: 0.777465 test: 0.764491
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  56 loss training:  13.802196880802512 Time :  2852
accuracy train: 0.998750 val: 0.780282 test: 0.769274
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  57 loss training:  13.19191674888134 Time :  2865
accuracy train: 0.999375 val: 0.767606 test: 0.768149
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  58 loss training:  13.163765876553953 Time :  2874
accuracy train: 0.999219 val: 0.774648 test: 0.765898
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  59 loss training:  14.078393862582743 Time :  2885
accuracy train: 0.999531 val: 0.777465 test: 0.771525
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  60 loss training:  11.722029554657638 Time :  2898
accuracy train: 0.999687 val: 0.777465 test: 0.772932
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  61 loss training:  11.562475010752678 Time :  2908
accuracy train: 0.999531 val: 0.777465 test: 0.766179
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  62 loss training:  11.743773720227182 Time :  2920
accuracy train: 0.999844 val: 0.774648 test: 0.769555
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  63 loss training:  10.704472081270069 Time :  2932
accuracy train: 0.999844 val: 0.780282 test: 0.772651
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  64 loss training:  10.626172048971057 Time :  2944
accuracy train: 0.999531 val: 0.766197 test: 0.767304
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  65 loss training:  10.832396647892892 Time :  2955
accuracy train: 0.999844 val: 0.777465 test: 0.766460
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

Epoch :  66 loss training:  9.954406282864511 Time :  2966
accuracy train: 0.999844 val: 0.777465 test: 0.767867
max validation accuracy : 0.791549 max acc epoch : 35 test accuracy : 0.771806

========================================================================================================================================================================================================
max acc epoch :  35
max validation accuracy :  0.7915492957746478
test accuracy :  0.7718064153066967
last test_accuracy :  0.7678671918964547
max gap 16
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=359, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  90.02562209963799 Time :  2982
accuracy train: 0.782276 val: 0.747887 test: 0.765053
max validation accuracy : 0.747887 max acc epoch : 1 test accuracy : 0.765053
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  82.09380474686623 Time :  2994
accuracy train: 0.799625 val: 0.761972 test: 0.772088
max validation accuracy : 0.761972 max acc epoch : 2 test accuracy : 0.772088
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  78.5473695397377 Time :  3004
accuracy train: 0.813379 val: 0.761972 test: 0.773776
max validation accuracy : 0.761972 max acc epoch : 2 test accuracy : 0.772088
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  74.11015379428864 Time :  3015
accuracy train: 0.822288 val: 0.764789 test: 0.772651
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.772651
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  72.15763001143932 Time :  3025
accuracy train: 0.832448 val: 0.764789 test: 0.772932
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.772651
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.41258743405342 Time :  3035
accuracy train: 0.835730 val: 0.767606 test: 0.775183
max validation accuracy : 0.767606 max acc epoch : 6 test accuracy : 0.775183
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.11278443038464 Time :  3047
accuracy train: 0.843701 val: 0.771831 test: 0.774620
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.774620
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.6384602189064 Time :  3058
accuracy train: 0.849797 val: 0.780282 test: 0.774057
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.774057
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  68.05821914970875 Time :  3069
accuracy train: 0.853548 val: 0.785915 test: 0.774620
max validation accuracy : 0.785915 max acc epoch : 9 test accuracy : 0.774620
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  65.85205799341202 Time :  3080
accuracy train: 0.856049 val: 0.776056 test: 0.777153
max validation accuracy : 0.785915 max acc epoch : 9 test accuracy : 0.774620

Epoch :  11 loss training:  65.12108299136162 Time :  3090
accuracy train: 0.864645 val: 0.778873 test: 0.773213
max validation accuracy : 0.785915 max acc epoch : 9 test accuracy : 0.774620

Epoch :  12 loss training:  63.01157309114933 Time :  3102
accuracy train: 0.865739 val: 0.780282 test: 0.773495
max validation accuracy : 0.785915 max acc epoch : 9 test accuracy : 0.774620

Epoch :  13 loss training:  62.586418092250824 Time :  3114
accuracy train: 0.880431 val: 0.785915 test: 0.776590
max validation accuracy : 0.785915 max acc epoch : 9 test accuracy : 0.774620

Epoch :  14 loss training:  60.57609851658344 Time :  3124
accuracy train: 0.883557 val: 0.791549 test: 0.774620
max validation accuracy : 0.791549 max acc epoch : 14 test accuracy : 0.774620

Epoch :  15 loss training:  58.539299726486206 Time :  3135
accuracy train: 0.889653 val: 0.794366 test: 0.776590
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  16 loss training:  58.14249995350838 Time :  3146
accuracy train: 0.896843 val: 0.787324 test: 0.773776
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  17 loss training:  55.379187881946564 Time :  3155
accuracy train: 0.903876 val: 0.788732 test: 0.776590
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  18 loss training:  54.10388506948948 Time :  3168
accuracy train: 0.912316 val: 0.785915 test: 0.774620
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  19 loss training:  53.022717610001564 Time :  3182
accuracy train: 0.917631 val: 0.784507 test: 0.775464
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  20 loss training:  50.657373666763306 Time :  3191
accuracy train: 0.924039 val: 0.787324 test: 0.774620
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  21 loss training:  48.71532414853573 Time :  3204
accuracy train: 0.928884 val: 0.792958 test: 0.773495
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  22 loss training:  48.05622573196888 Time :  3214
accuracy train: 0.932323 val: 0.791549 test: 0.771525
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  23 loss training:  45.91697806864977 Time :  3224
accuracy train: 0.935605 val: 0.788732 test: 0.776308
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  24 loss training:  44.80876426398754 Time :  3236
accuracy train: 0.944983 val: 0.788732 test: 0.774902
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  25 loss training:  42.79663813114166 Time :  3246
accuracy train: 0.950297 val: 0.788732 test: 0.775746
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  26 loss training:  41.578074775636196 Time :  3258
accuracy train: 0.952798 val: 0.792958 test: 0.776308
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  27 loss training:  39.42447978258133 Time :  3269
accuracy train: 0.957487 val: 0.792958 test: 0.772932
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  28 loss training:  37.488573640584946 Time :  3279
accuracy train: 0.959206 val: 0.788732 test: 0.770400
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  29 loss training:  37.64996030181646 Time :  3289
accuracy train: 0.962332 val: 0.792958 test: 0.774620
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  30 loss training:  36.234441354870796 Time :  3301
accuracy train: 0.966865 val: 0.791549 test: 0.773495
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  31 loss training:  34.34200641140342 Time :  3311
accuracy train: 0.968271 val: 0.787324 test: 0.771244
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  32 loss training:  33.62916824221611 Time :  3323
accuracy train: 0.973585 val: 0.788732 test: 0.772651
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  33 loss training:  32.99403088539839 Time :  3334
accuracy train: 0.974523 val: 0.788732 test: 0.769555
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  34 loss training:  31.38595189526677 Time :  3342
accuracy train: 0.976868 val: 0.784507 test: 0.777153
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  35 loss training:  29.31164825707674 Time :  3356
accuracy train: 0.982338 val: 0.785915 test: 0.771806
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  36 loss training:  27.855555951595306 Time :  3365
accuracy train: 0.983276 val: 0.788732 test: 0.769555
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  37 loss training:  27.265345454216003 Time :  3375
accuracy train: 0.983120 val: 0.783099 test: 0.768149
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  38 loss training:  27.334115486592054 Time :  3392
accuracy train: 0.985308 val: 0.784507 test: 0.773776
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  39 loss training:  25.586279783397913 Time :  3403
accuracy train: 0.986246 val: 0.773239 test: 0.768430
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  40 loss training:  25.10539098456502 Time :  3412
accuracy train: 0.989684 val: 0.781690 test: 0.770118
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  41 loss training:  24.471512518823147 Time :  3427
accuracy train: 0.989059 val: 0.774648 test: 0.772651
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  42 loss training:  23.730253180488944 Time :  3439
accuracy train: 0.992029 val: 0.778873 test: 0.771244
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  43 loss training:  22.7347675524652 Time :  3448
accuracy train: 0.992967 val: 0.780282 test: 0.768711
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  44 loss training:  21.413369961082935 Time :  3460
accuracy train: 0.993435 val: 0.778873 test: 0.772088
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  45 loss training:  20.823488403111696 Time :  3471
accuracy train: 0.993435 val: 0.783099 test: 0.770118
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

Epoch :  46 loss training:  20.535999234765768 Time :  3481
accuracy train: 0.994686 val: 0.777465 test: 0.768430
max validation accuracy : 0.794366 max acc epoch : 15 test accuracy : 0.776590

========================================================================================================================================================================================================
max acc epoch :  15
max validation accuracy :  0.7943661971830986
test accuracy :  0.7765897580191333
last test_accuracy :  0.7684299380979178
max gap 5
========================================================================================================================================================================================================

itr : 6
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=359, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  90.04079085588455 Time :  3494
accuracy train: 0.783057 val: 0.750704 test: 0.763084
max validation accuracy : 0.750704 max acc epoch : 1 test accuracy : 0.763084
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  82.1959681212902 Time :  3504
accuracy train: 0.799625 val: 0.754930 test: 0.772369
max validation accuracy : 0.754930 max acc epoch : 2 test accuracy : 0.772369
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  78.45995336771011 Time :  3514
accuracy train: 0.810097 val: 0.757746 test: 0.772932
max validation accuracy : 0.757746 max acc epoch : 3 test accuracy : 0.772932
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  74.34018987417221 Time :  3525
accuracy train: 0.824320 val: 0.776056 test: 0.774339
max validation accuracy : 0.776056 max acc epoch : 4 test accuracy : 0.774339
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  72.32538588345051 Time :  3537
accuracy train: 0.830416 val: 0.770423 test: 0.773776
max validation accuracy : 0.776056 max acc epoch : 4 test accuracy : 0.774339
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.37762355804443 Time :  3548
accuracy train: 0.832135 val: 0.767606 test: 0.775464
max validation accuracy : 0.776056 max acc epoch : 4 test accuracy : 0.774339
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.28726795315742 Time :  3556
accuracy train: 0.840419 val: 0.780282 test: 0.776308
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776308
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.87711544334888 Time :  3565
accuracy train: 0.850422 val: 0.783099 test: 0.774902
max validation accuracy : 0.783099 max acc epoch : 8 test accuracy : 0.774902
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  68.11749510467052 Time :  3577
accuracy train: 0.851047 val: 0.783099 test: 0.774057
max validation accuracy : 0.783099 max acc epoch : 8 test accuracy : 0.774902
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  65.96125353872776 Time :  3586
accuracy train: 0.853235 val: 0.784507 test: 0.776027
max validation accuracy : 0.784507 max acc epoch : 10 test accuracy : 0.776027

Epoch :  11 loss training:  65.3007099032402 Time :  3597
accuracy train: 0.861988 val: 0.785915 test: 0.776308
max validation accuracy : 0.785915 max acc epoch : 11 test accuracy : 0.776308

Epoch :  12 loss training:  63.25870597362518 Time :  3607
accuracy train: 0.862457 val: 0.781690 test: 0.777434
max validation accuracy : 0.785915 max acc epoch : 11 test accuracy : 0.776308

Epoch :  13 loss training:  62.64650619029999 Time :  3617
accuracy train: 0.875274 val: 0.785915 test: 0.777715
max validation accuracy : 0.785915 max acc epoch : 11 test accuracy : 0.776308

Epoch :  14 loss training:  60.71203625202179 Time :  3629
accuracy train: 0.882932 val: 0.791549 test: 0.774339
max validation accuracy : 0.791549 max acc epoch : 14 test accuracy : 0.774339

Epoch :  15 loss training:  58.48679976165295 Time :  3640
accuracy train: 0.888246 val: 0.792958 test: 0.777715
max validation accuracy : 0.792958 max acc epoch : 15 test accuracy : 0.777715

Epoch :  16 loss training:  58.43173098564148 Time :  3650
accuracy train: 0.895592 val: 0.787324 test: 0.772088
max validation accuracy : 0.792958 max acc epoch : 15 test accuracy : 0.777715

Epoch :  17 loss training:  55.38012379407883 Time :  3664
accuracy train: 0.899969 val: 0.781690 test: 0.777715
max validation accuracy : 0.792958 max acc epoch : 15 test accuracy : 0.777715

Epoch :  18 loss training:  54.09815068542957 Time :  3675
accuracy train: 0.911379 val: 0.788732 test: 0.772088
max validation accuracy : 0.792958 max acc epoch : 15 test accuracy : 0.777715

Epoch :  19 loss training:  53.1944320499897 Time :  3686
accuracy train: 0.914661 val: 0.787324 test: 0.769274
max validation accuracy : 0.792958 max acc epoch : 15 test accuracy : 0.777715

Epoch :  20 loss training:  50.71568484604359 Time :  3695
accuracy train: 0.920288 val: 0.787324 test: 0.776590
max validation accuracy : 0.792958 max acc epoch : 15 test accuracy : 0.777715

Epoch :  21 loss training:  48.59093464165926 Time :  3703
accuracy train: 0.925758 val: 0.788732 test: 0.774339
max validation accuracy : 0.792958 max acc epoch : 15 test accuracy : 0.777715

Epoch :  22 loss training:  48.28631880879402 Time :  3716
accuracy train: 0.931229 val: 0.785915 test: 0.769555
max validation accuracy : 0.792958 max acc epoch : 15 test accuracy : 0.777715

Epoch :  23 loss training:  46.138237453997135 Time :  3725
accuracy train: 0.933729 val: 0.787324 test: 0.773213
max validation accuracy : 0.792958 max acc epoch : 15 test accuracy : 0.777715

Epoch :  24 loss training:  45.13040794432163 Time :  3735
accuracy train: 0.940919 val: 0.781690 test: 0.773776
max validation accuracy : 0.792958 max acc epoch : 15 test accuracy : 0.777715

Epoch :  25 loss training:  42.968231208622456 Time :  3747
accuracy train: 0.949515 val: 0.784507 test: 0.772369
max validation accuracy : 0.792958 max acc epoch : 15 test accuracy : 0.777715

Epoch :  26 loss training:  41.88126816600561 Time :  3756
accuracy train: 0.953110 val: 0.790141 test: 0.773213
max validation accuracy : 0.792958 max acc epoch : 15 test accuracy : 0.777715

Epoch :  27 loss training:  39.71967809647322 Time :  3767
accuracy train: 0.954204 val: 0.795775 test: 0.775464
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  28 loss training:  37.73290953785181 Time :  3779
accuracy train: 0.957643 val: 0.783099 test: 0.770118
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  29 loss training:  37.673567950725555 Time :  3789
accuracy train: 0.959831 val: 0.791549 test: 0.774339
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  30 loss training:  36.255983479321 Time :  3803
accuracy train: 0.965614 val: 0.790141 test: 0.771525
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  31 loss training:  34.35303968191147 Time :  3814
accuracy train: 0.968740 val: 0.785915 test: 0.772369
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  32 loss training:  33.34597923234105 Time :  3823
accuracy train: 0.972023 val: 0.790141 test: 0.771806
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  33 loss training:  33.344113945961 Time :  3837
accuracy train: 0.972179 val: 0.784507 test: 0.768430
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  34 loss training:  31.645865336060524 Time :  3847
accuracy train: 0.974367 val: 0.783099 test: 0.771525
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  35 loss training:  29.692531809210777 Time :  3856
accuracy train: 0.979837 val: 0.791549 test: 0.770962
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  36 loss training:  28.02285522967577 Time :  3871
accuracy train: 0.980619 val: 0.778873 test: 0.772369
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  37 loss training:  27.458740569651127 Time :  3881
accuracy train: 0.983432 val: 0.780282 test: 0.769555
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  38 loss training:  27.79219003394246 Time :  3890
accuracy train: 0.985464 val: 0.776056 test: 0.772369
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  39 loss training:  25.740790765732527 Time :  3903
accuracy train: 0.986871 val: 0.774648 test: 0.769837
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  40 loss training:  24.993950601667166 Time :  3912
accuracy train: 0.988590 val: 0.776056 test: 0.765616
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  41 loss training:  24.73132710158825 Time :  3922
accuracy train: 0.988278 val: 0.771831 test: 0.769555
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  42 loss training:  24.225181877613068 Time :  3939
accuracy train: 0.990778 val: 0.773239 test: 0.772651
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  43 loss training:  23.270325915887952 Time :  3950
accuracy train: 0.992810 val: 0.773239 test: 0.768993
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  44 loss training:  21.064779594540596 Time :  3961
accuracy train: 0.992810 val: 0.770423 test: 0.767586
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  45 loss training:  20.90430887043476 Time :  3973
accuracy train: 0.992810 val: 0.771831 test: 0.772932
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  46 loss training:  20.816645869985223 Time :  3983
accuracy train: 0.993748 val: 0.769014 test: 0.765898
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  47 loss training:  20.017953518778086 Time :  3992
accuracy train: 0.993435 val: 0.769014 test: 0.769837
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  48 loss training:  20.581855818629265 Time :  4007
accuracy train: 0.995780 val: 0.777465 test: 0.765335
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  49 loss training:  17.851237313821912 Time :  4017
accuracy train: 0.996874 val: 0.778873 test: 0.767586
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  50 loss training:  17.63520492427051 Time :  4026
accuracy train: 0.996561 val: 0.769014 test: 0.763084
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  51 loss training:  16.362330561503768 Time :  4041
accuracy train: 0.997343 val: 0.781690 test: 0.771525
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  52 loss training:  17.057024856097996 Time :  4051
accuracy train: 0.995311 val: 0.784507 test: 0.764491
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  53 loss training:  15.916517075151205 Time :  4060
accuracy train: 0.997187 val: 0.766197 test: 0.768430
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  54 loss training:  16.150629865936935 Time :  4073
accuracy train: 0.997812 val: 0.774648 test: 0.769555
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  55 loss training:  14.854002246633172 Time :  4083
accuracy train: 0.997968 val: 0.770423 test: 0.767023
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  56 loss training:  13.810547215864062 Time :  4093
accuracy train: 0.998437 val: 0.763380 test: 0.766742
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  57 loss training:  12.77195514086634 Time :  4106
accuracy train: 0.998750 val: 0.764789 test: 0.765616
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

Epoch :  58 loss training:  12.972198912873864 Time :  4115
accuracy train: 0.998906 val: 0.766197 test: 0.763647
max validation accuracy : 0.795775 max acc epoch : 27 test accuracy : 0.775464

========================================================================================================================================================================================================
max acc epoch :  27
max validation accuracy :  0.795774647887324
test accuracy :  0.7754642656162071
last test_accuracy :  0.7636465953854812
max gap 12
========================================================================================================================================================================================================

itr : 7
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=359, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  90.03433911502361 Time :  4127
accuracy train: 0.782901 val: 0.750704 test: 0.764491
max validation accuracy : 0.750704 max acc epoch : 1 test accuracy : 0.764491
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  82.18050163984299 Time :  4137
accuracy train: 0.800094 val: 0.752113 test: 0.771806
max validation accuracy : 0.752113 max acc epoch : 2 test accuracy : 0.771806
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  78.46422302722931 Time :  4148
accuracy train: 0.811816 val: 0.763380 test: 0.769837
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.769837
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  74.1862074136734 Time :  4160
accuracy train: 0.822601 val: 0.769014 test: 0.774057
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.774057
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  72.18166357278824 Time :  4170
accuracy train: 0.830259 val: 0.761972 test: 0.771525
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.774057
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.53195866942406 Time :  4179
accuracy train: 0.836355 val: 0.769014 test: 0.774902
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.774057
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.19502763450146 Time :  4191
accuracy train: 0.841513 val: 0.776056 test: 0.776308
max validation accuracy : 0.776056 max acc epoch : 7 test accuracy : 0.776308
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.60866637527943 Time :  4199
accuracy train: 0.853235 val: 0.778873 test: 0.774902
max validation accuracy : 0.778873 max acc epoch : 8 test accuracy : 0.774902
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.79156681895256 Time :  4210
accuracy train: 0.853704 val: 0.783099 test: 0.772932
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.772932
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  65.71489202976227 Time :  4223
accuracy train: 0.857768 val: 0.778873 test: 0.777715
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.772932

Epoch :  11 loss training:  65.0638848990202 Time :  4232
accuracy train: 0.864489 val: 0.777465 test: 0.777715
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.772932

Epoch :  12 loss training:  62.82693190872669 Time :  4239
accuracy train: 0.866990 val: 0.776056 test: 0.774902
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.772932

Epoch :  13 loss training:  62.47611549496651 Time :  4254
accuracy train: 0.878087 val: 0.783099 test: 0.777997
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.772932

Epoch :  14 loss training:  60.63865818083286 Time :  4265
accuracy train: 0.882151 val: 0.785915 test: 0.773776
max validation accuracy : 0.785915 max acc epoch : 14 test accuracy : 0.773776

Epoch :  15 loss training:  58.424656957387924 Time :  4274
accuracy train: 0.890122 val: 0.785915 test: 0.777715
max validation accuracy : 0.785915 max acc epoch : 14 test accuracy : 0.773776

Epoch :  16 loss training:  58.28094233572483 Time :  4287
accuracy train: 0.896686 val: 0.780282 test: 0.770400
max validation accuracy : 0.785915 max acc epoch : 14 test accuracy : 0.773776

Epoch :  17 loss training:  55.0378325432539 Time :  4299
accuracy train: 0.902313 val: 0.776056 test: 0.777434
max validation accuracy : 0.785915 max acc epoch : 14 test accuracy : 0.773776

Epoch :  18 loss training:  53.61950987577438 Time :  4309
accuracy train: 0.910597 val: 0.781690 test: 0.772369
max validation accuracy : 0.785915 max acc epoch : 14 test accuracy : 0.773776

Epoch :  19 loss training:  52.93654212355614 Time :  4322
accuracy train: 0.914817 val: 0.778873 test: 0.771806
max validation accuracy : 0.785915 max acc epoch : 14 test accuracy : 0.773776

Epoch :  20 loss training:  50.510176584124565 Time :  4335
accuracy train: 0.918256 val: 0.776056 test: 0.778559
max validation accuracy : 0.785915 max acc epoch : 14 test accuracy : 0.773776

Epoch :  21 loss training:  48.40414857119322 Time :  4346
accuracy train: 0.924977 val: 0.788732 test: 0.771244
max validation accuracy : 0.788732 max acc epoch : 21 test accuracy : 0.771244

Epoch :  22 loss training:  48.20950973033905 Time :  4359
accuracy train: 0.932948 val: 0.784507 test: 0.772369
max validation accuracy : 0.788732 max acc epoch : 21 test accuracy : 0.771244

Epoch :  23 loss training:  45.92300255596638 Time :  4373
accuracy train: 0.932635 val: 0.787324 test: 0.773213
max validation accuracy : 0.788732 max acc epoch : 21 test accuracy : 0.771244

Epoch :  24 loss training:  44.770612969994545 Time :  4383
accuracy train: 0.941857 val: 0.783099 test: 0.777997
max validation accuracy : 0.788732 max acc epoch : 21 test accuracy : 0.771244

Epoch :  25 loss training:  42.94487652927637 Time :  4392
accuracy train: 0.946702 val: 0.784507 test: 0.770962
max validation accuracy : 0.788732 max acc epoch : 21 test accuracy : 0.771244

Epoch :  26 loss training:  41.75083555281162 Time :  4404
accuracy train: 0.950922 val: 0.787324 test: 0.769837
max validation accuracy : 0.788732 max acc epoch : 21 test accuracy : 0.771244

Epoch :  27 loss training:  39.9631308093667 Time :  4414
accuracy train: 0.953267 val: 0.791549 test: 0.772932
max validation accuracy : 0.791549 max acc epoch : 27 test accuracy : 0.772932

Epoch :  28 loss training:  37.34007274359465 Time :  4424
accuracy train: 0.957487 val: 0.794366 test: 0.773776
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  29 loss training:  37.49501793831587 Time :  4434
accuracy train: 0.959675 val: 0.790141 test: 0.771525
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  30 loss training:  36.305960059165955 Time :  4445
accuracy train: 0.964051 val: 0.780282 test: 0.771525
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  31 loss training:  34.091509237885475 Time :  4455
accuracy train: 0.968584 val: 0.787324 test: 0.767586
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  32 loss training:  33.23294825851917 Time :  4465
accuracy train: 0.971554 val: 0.783099 test: 0.771525
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  33 loss training:  32.71752742677927 Time :  4477
accuracy train: 0.973273 val: 0.778873 test: 0.769274
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  34 loss training:  31.55415802448988 Time :  4487
accuracy train: 0.974523 val: 0.778873 test: 0.772088
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  35 loss training:  29.49220062047243 Time :  4499
accuracy train: 0.979369 val: 0.780282 test: 0.773213
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  36 loss training:  27.788708958774805 Time :  4514
accuracy train: 0.981244 val: 0.788732 test: 0.764209
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  37 loss training:  27.221573248505592 Time :  4523
accuracy train: 0.982807 val: 0.777465 test: 0.770681
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  38 loss training:  27.395701844245195 Time :  4533
accuracy train: 0.984839 val: 0.780282 test: 0.770681
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  39 loss training:  25.828680582344532 Time :  4547
accuracy train: 0.987183 val: 0.773239 test: 0.768993
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  40 loss training:  25.13988047838211 Time :  4557
accuracy train: 0.988590 val: 0.773239 test: 0.767867
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  41 loss training:  24.822325889021158 Time :  4566
accuracy train: 0.987809 val: 0.774648 test: 0.765616
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  42 loss training:  24.249427227303386 Time :  4579
accuracy train: 0.990466 val: 0.776056 test: 0.771244
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  43 loss training:  23.249522687867284 Time :  4592
accuracy train: 0.992967 val: 0.776056 test: 0.767867
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  44 loss training:  22.041992362588644 Time :  4601
accuracy train: 0.992341 val: 0.774648 test: 0.773776
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  45 loss training:  20.803829707205296 Time :  4615
accuracy train: 0.992810 val: 0.767606 test: 0.771244
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  46 loss training:  20.8616821244359 Time :  4624
accuracy train: 0.993748 val: 0.776056 test: 0.767304
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  47 loss training:  19.78880985826254 Time :  4637
accuracy train: 0.993904 val: 0.771831 test: 0.771244
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  48 loss training:  20.706256419420242 Time :  4654
accuracy train: 0.995311 val: 0.764789 test: 0.766460
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  49 loss training:  17.98889173567295 Time :  4666
accuracy train: 0.996561 val: 0.769014 test: 0.768711
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  50 loss training:  17.220316228456795 Time :  4677
accuracy train: 0.995624 val: 0.769014 test: 0.769555
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  51 loss training:  16.317376313731074 Time :  4687
accuracy train: 0.997187 val: 0.773239 test: 0.769555
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  52 loss training:  16.963160132989287 Time :  4697
accuracy train: 0.995936 val: 0.788732 test: 0.764772
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  53 loss training:  16.17622658610344 Time :  4707
accuracy train: 0.997656 val: 0.766197 test: 0.770400
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  54 loss training:  15.753887549974024 Time :  4716
accuracy train: 0.997812 val: 0.781690 test: 0.767304
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  55 loss training:  15.031983344815671 Time :  4726
accuracy train: 0.998124 val: 0.766197 test: 0.765898
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  56 loss training:  13.974403490312397 Time :  4736
accuracy train: 0.998281 val: 0.763380 test: 0.767586
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  57 loss training:  13.087503468617797 Time :  4746
accuracy train: 0.998437 val: 0.767606 test: 0.769837
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  58 loss training:  13.478481952100992 Time :  4755
accuracy train: 0.998906 val: 0.767606 test: 0.766179
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

Epoch :  59 loss training:  14.310197319835424 Time :  4766
accuracy train: 0.998750 val: 0.770423 test: 0.772088
max validation accuracy : 0.794366 max acc epoch : 28 test accuracy : 0.773776

========================================================================================================================================================================================================
max acc epoch :  28
max validation accuracy :  0.7943661971830986
test accuracy :  0.7737760270118177
last test_accuracy :  0.7720877884074282
max gap 7
========================================================================================================================================================================================================

itr : 8
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=359, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  90.02995973825455 Time :  4776
accuracy train: 0.782588 val: 0.745070 test: 0.767304
max validation accuracy : 0.745070 max acc epoch : 1 test accuracy : 0.767304
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  82.26474568247795 Time :  4788
accuracy train: 0.800875 val: 0.759155 test: 0.771244
max validation accuracy : 0.759155 max acc epoch : 2 test accuracy : 0.771244
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  78.45235881209373 Time :  4802
accuracy train: 0.812129 val: 0.767606 test: 0.773495
max validation accuracy : 0.767606 max acc epoch : 3 test accuracy : 0.773495
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  74.10624760389328 Time :  4814
accuracy train: 0.825258 val: 0.776056 test: 0.772369
max validation accuracy : 0.776056 max acc epoch : 4 test accuracy : 0.772369
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  72.06716719269753 Time :  4823
accuracy train: 0.831354 val: 0.764789 test: 0.773213
max validation accuracy : 0.776056 max acc epoch : 4 test accuracy : 0.772369
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.35352392494678 Time :  4837
accuracy train: 0.834011 val: 0.770423 test: 0.774057
max validation accuracy : 0.776056 max acc epoch : 4 test accuracy : 0.772369
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  68.93903873860836 Time :  4847
accuracy train: 0.841826 val: 0.777465 test: 0.775746
max validation accuracy : 0.777465 max acc epoch : 7 test accuracy : 0.775746
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.48333835601807 Time :  4855
accuracy train: 0.850109 val: 0.776056 test: 0.772651
max validation accuracy : 0.777465 max acc epoch : 7 test accuracy : 0.775746
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.80137166380882 Time :  4867
accuracy train: 0.852454 val: 0.778873 test: 0.772932
max validation accuracy : 0.778873 max acc epoch : 9 test accuracy : 0.772932
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  65.80285961925983 Time :  4879
accuracy train: 0.855892 val: 0.778873 test: 0.777434
max validation accuracy : 0.778873 max acc epoch : 9 test accuracy : 0.772932

Epoch :  11 loss training:  64.91059957444668 Time :  4889
accuracy train: 0.864020 val: 0.776056 test: 0.776590
max validation accuracy : 0.778873 max acc epoch : 9 test accuracy : 0.772932

Epoch :  12 loss training:  62.94370441138744 Time :  4900
accuracy train: 0.865270 val: 0.781690 test: 0.776871
max validation accuracy : 0.781690 max acc epoch : 12 test accuracy : 0.776871

Epoch :  13 loss training:  62.413231268525124 Time :  4911
accuracy train: 0.879806 val: 0.785915 test: 0.777434
max validation accuracy : 0.785915 max acc epoch : 13 test accuracy : 0.777434

Epoch :  14 loss training:  60.46698047220707 Time :  4920
accuracy train: 0.882463 val: 0.783099 test: 0.775183
max validation accuracy : 0.785915 max acc epoch : 13 test accuracy : 0.777434

Epoch :  15 loss training:  58.219202890992165 Time :  4932
accuracy train: 0.889653 val: 0.788732 test: 0.780529
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.780529

Epoch :  16 loss training:  58.048789605498314 Time :  4948
accuracy train: 0.898093 val: 0.785915 test: 0.775464
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.780529

Epoch :  17 loss training:  55.053565695881844 Time :  4959
accuracy train: 0.902626 val: 0.788732 test: 0.776871
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.780529

Epoch :  18 loss training:  53.69393992424011 Time :  4969
accuracy train: 0.911535 val: 0.783099 test: 0.771806
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.780529

Epoch :  19 loss training:  52.925356432795525 Time :  4979
accuracy train: 0.919037 val: 0.784507 test: 0.774620
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.780529

Epoch :  20 loss training:  50.34673826396465 Time :  4989
accuracy train: 0.920913 val: 0.783099 test: 0.777997
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.780529

Epoch :  21 loss training:  48.4637261852622 Time :  5000
accuracy train: 0.928103 val: 0.788732 test: 0.772932
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.780529

Epoch :  22 loss training:  48.00632032752037 Time :  5010
accuracy train: 0.932166 val: 0.790141 test: 0.773776
max validation accuracy : 0.790141 max acc epoch : 22 test accuracy : 0.773776

Epoch :  23 loss training:  45.91007122397423 Time :  5020
accuracy train: 0.935292 val: 0.781690 test: 0.779122
max validation accuracy : 0.790141 max acc epoch : 22 test accuracy : 0.773776

Epoch :  24 loss training:  44.73563316464424 Time :  5031
accuracy train: 0.944045 val: 0.792958 test: 0.774057
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  25 loss training:  43.19782613217831 Time :  5042
accuracy train: 0.949359 val: 0.783099 test: 0.773495
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  26 loss training:  41.67193233221769 Time :  5053
accuracy train: 0.953267 val: 0.787324 test: 0.771244
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  27 loss training:  39.498437374830246 Time :  5063
accuracy train: 0.956080 val: 0.792958 test: 0.776027
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  28 loss training:  37.5956848859787 Time :  5076
accuracy train: 0.961082 val: 0.785915 test: 0.770962
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  29 loss training:  37.31421985477209 Time :  5088
accuracy train: 0.962176 val: 0.783099 test: 0.773495
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  30 loss training:  35.83177241683006 Time :  5099
accuracy train: 0.966239 val: 0.781690 test: 0.774339
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  31 loss training:  34.44164298474789 Time :  5108
accuracy train: 0.969522 val: 0.784507 test: 0.771525
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  32 loss training:  33.335912082344294 Time :  5119
accuracy train: 0.972179 val: 0.785915 test: 0.770118
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  33 loss training:  32.760377921164036 Time :  5126
accuracy train: 0.973429 val: 0.787324 test: 0.771244
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  34 loss training:  31.454545810818672 Time :  5134
accuracy train: 0.976868 val: 0.777465 test: 0.774057
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  35 loss training:  29.180903013795614 Time :  5148
accuracy train: 0.979525 val: 0.780282 test: 0.773495
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  36 loss training:  28.01762978360057 Time :  5158
accuracy train: 0.982495 val: 0.784507 test: 0.770118
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  37 loss training:  26.850483305752277 Time :  5166
accuracy train: 0.984526 val: 0.774648 test: 0.770118
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  38 loss training:  27.349075868725777 Time :  5179
accuracy train: 0.986402 val: 0.771831 test: 0.770681
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  39 loss training:  25.48472386226058 Time :  5189
accuracy train: 0.987965 val: 0.778873 test: 0.768993
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  40 loss training:  24.995146859437227 Time :  5198
accuracy train: 0.990309 val: 0.783099 test: 0.767304
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  41 loss training:  24.40649889782071 Time :  5210
accuracy train: 0.988434 val: 0.783099 test: 0.767586
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  42 loss training:  24.26163337379694 Time :  5220
accuracy train: 0.991560 val: 0.776056 test: 0.768149
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  43 loss training:  23.157909469678998 Time :  5231
accuracy train: 0.993435 val: 0.776056 test: 0.768993
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  44 loss training:  21.595261842012405 Time :  5241
accuracy train: 0.993123 val: 0.773239 test: 0.773495
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  45 loss training:  21.240392193198204 Time :  5253
accuracy train: 0.993435 val: 0.776056 test: 0.771525
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  46 loss training:  20.706335205584764 Time :  5262
accuracy train: 0.992810 val: 0.778873 test: 0.767867
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  47 loss training:  19.508591629564762 Time :  5273
accuracy train: 0.994217 val: 0.780282 test: 0.768149
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  48 loss training:  20.37884700857103 Time :  5284
accuracy train: 0.996561 val: 0.783099 test: 0.767304
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  49 loss training:  17.61061044409871 Time :  5294
accuracy train: 0.997030 val: 0.774648 test: 0.767586
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  50 loss training:  17.668471932411194 Time :  5305
accuracy train: 0.996718 val: 0.773239 test: 0.765616
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  51 loss training:  16.39116115681827 Time :  5314
accuracy train: 0.997343 val: 0.776056 test: 0.770681
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  52 loss training:  16.7729773838073 Time :  5325
accuracy train: 0.995155 val: 0.790141 test: 0.765053
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  53 loss training:  15.944994870573282 Time :  5336
accuracy train: 0.997968 val: 0.767606 test: 0.765335
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  54 loss training:  15.929209886584431 Time :  5347
accuracy train: 0.998124 val: 0.781690 test: 0.767867
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

Epoch :  55 loss training:  15.133298047818244 Time :  5357
accuracy train: 0.997968 val: 0.771831 test: 0.763084
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.774057

========================================================================================================================================================================================================
max acc epoch :  24
max validation accuracy :  0.7929577464788733
test accuracy :  0.7740574001125492
last test_accuracy :  0.7630838491840181
max gap 7
========================================================================================================================================================================================================

itr : 9
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=359, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  90.04837734997272 Time :  5373
accuracy train: 0.781963 val: 0.747887 test: 0.764491
max validation accuracy : 0.747887 max acc epoch : 1 test accuracy : 0.764491
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  82.09294643998146 Time :  5383
accuracy train: 0.799000 val: 0.756338 test: 0.771806
max validation accuracy : 0.756338 max acc epoch : 2 test accuracy : 0.771806
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  78.41928747296333 Time :  5392
accuracy train: 0.814004 val: 0.767606 test: 0.775464
max validation accuracy : 0.767606 max acc epoch : 3 test accuracy : 0.775464
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  74.32460868358612 Time :  5402
accuracy train: 0.824320 val: 0.774648 test: 0.775464
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.775464
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  72.12934133410454 Time :  5413
accuracy train: 0.830728 val: 0.764789 test: 0.772088
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.775464
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.44242317974567 Time :  5422
accuracy train: 0.835105 val: 0.771831 test: 0.776590
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.775464
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  68.92680935561657 Time :  5434
accuracy train: 0.842138 val: 0.776056 test: 0.777434
max validation accuracy : 0.776056 max acc epoch : 7 test accuracy : 0.777434
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.51684631407261 Time :  5443
accuracy train: 0.851829 val: 0.777465 test: 0.774620
max validation accuracy : 0.777465 max acc epoch : 8 test accuracy : 0.774620
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.93895971775055 Time :  5453
accuracy train: 0.855111 val: 0.780282 test: 0.773776
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.773776
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  65.50162090361118 Time :  5464
accuracy train: 0.857143 val: 0.784507 test: 0.778841
max validation accuracy : 0.784507 max acc epoch : 10 test accuracy : 0.778841

Epoch :  11 loss training:  64.79421365261078 Time :  5473
accuracy train: 0.863707 val: 0.783099 test: 0.775746
max validation accuracy : 0.784507 max acc epoch : 10 test accuracy : 0.778841

Epoch :  12 loss training:  62.71026560664177 Time :  5486
accuracy train: 0.866521 val: 0.788732 test: 0.774057
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.774057

Epoch :  13 loss training:  62.306524619460106 Time :  5495
accuracy train: 0.881682 val: 0.785915 test: 0.773776
max validation accuracy : 0.788732 max acc epoch : 12 test accuracy : 0.774057

Epoch :  14 loss training:  60.4926505535841 Time :  5506
accuracy train: 0.884183 val: 0.794366 test: 0.775464
max validation accuracy : 0.794366 max acc epoch : 14 test accuracy : 0.775464

Epoch :  15 loss training:  58.11543834209442 Time :  5520
accuracy train: 0.892310 val: 0.792958 test: 0.776308
max validation accuracy : 0.794366 max acc epoch : 14 test accuracy : 0.775464

Epoch :  16 loss training:  58.02948136627674 Time :  5530
accuracy train: 0.897937 val: 0.795775 test: 0.774339
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  17 loss training:  55.28098691999912 Time :  5540
accuracy train: 0.903876 val: 0.785915 test: 0.778841
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  18 loss training:  53.9954384714365 Time :  5551
accuracy train: 0.912160 val: 0.791549 test: 0.775464
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  19 loss training:  52.92865642905235 Time :  5561
accuracy train: 0.917631 val: 0.790141 test: 0.778559
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  20 loss training:  50.30894047021866 Time :  5569
accuracy train: 0.921225 val: 0.785915 test: 0.777153
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  21 loss training:  48.54336670786142 Time :  5581
accuracy train: 0.927477 val: 0.792958 test: 0.776590
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  22 loss training:  47.93573880195618 Time :  5592
accuracy train: 0.932323 val: 0.790141 test: 0.774620
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  23 loss training:  46.02669012546539 Time :  5603
accuracy train: 0.934667 val: 0.785915 test: 0.776590
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  24 loss training:  44.270890317857265 Time :  5615
accuracy train: 0.943420 val: 0.783099 test: 0.776027
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  25 loss training:  43.187535524368286 Time :  5624
accuracy train: 0.949203 val: 0.780282 test: 0.772932
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  26 loss training:  41.44255095720291 Time :  5635
accuracy train: 0.951235 val: 0.785915 test: 0.771525
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  27 loss training:  39.491884648799896 Time :  5646
accuracy train: 0.955299 val: 0.788732 test: 0.774620
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  28 loss training:  37.14179581403732 Time :  5657
accuracy train: 0.957799 val: 0.781690 test: 0.774620
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  29 loss training:  37.5036970898509 Time :  5668
accuracy train: 0.962019 val: 0.783099 test: 0.772369
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  30 loss training:  36.49126681685448 Time :  5680
accuracy train: 0.965145 val: 0.790141 test: 0.773776
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  31 loss training:  34.68943947926164 Time :  5692
accuracy train: 0.969209 val: 0.787324 test: 0.774902
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  32 loss training:  33.292073868215084 Time :  5701
accuracy train: 0.971554 val: 0.787324 test: 0.769555
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  33 loss training:  32.81190564855933 Time :  5711
accuracy train: 0.974992 val: 0.778873 test: 0.771525
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  34 loss training:  31.132632352411747 Time :  5722
accuracy train: 0.975305 val: 0.780282 test: 0.776027
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  35 loss training:  29.879865534603596 Time :  5732
accuracy train: 0.981557 val: 0.788732 test: 0.772369
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  36 loss training:  27.939256496727467 Time :  5741
accuracy train: 0.981557 val: 0.788732 test: 0.770962
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  37 loss training:  27.429231241345406 Time :  5750
accuracy train: 0.982182 val: 0.777465 test: 0.767586
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  38 loss training:  27.221493620425463 Time :  5762
accuracy train: 0.984839 val: 0.776056 test: 0.770681
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  39 loss training:  25.961527220904827 Time :  5772
accuracy train: 0.985308 val: 0.771831 test: 0.772369
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  40 loss training:  24.90999785810709 Time :  5781
accuracy train: 0.988278 val: 0.777465 test: 0.765335
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  41 loss training:  24.242141846567392 Time :  5794
accuracy train: 0.987652 val: 0.780282 test: 0.771806
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  42 loss training:  23.8983141053468 Time :  5805
accuracy train: 0.990309 val: 0.776056 test: 0.772651
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  43 loss training:  22.93623925000429 Time :  5816
accuracy train: 0.992810 val: 0.773239 test: 0.769837
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  44 loss training:  21.660705104470253 Time :  5827
accuracy train: 0.992341 val: 0.777465 test: 0.769555
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  45 loss training:  20.96302912198007 Time :  5837
accuracy train: 0.992341 val: 0.777465 test: 0.767304
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  46 loss training:  20.795114183798432 Time :  5848
accuracy train: 0.993279 val: 0.771831 test: 0.772932
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

Epoch :  47 loss training:  19.747128965333104 Time :  5859
accuracy train: 0.992967 val: 0.773239 test: 0.768149
max validation accuracy : 0.795775 max acc epoch : 16 test accuracy : 0.774339

========================================================================================================================================================================================================
max acc epoch :  16
max validation accuracy :  0.795774647887324
test accuracy :  0.7743387732132808
last test_accuracy :  0.7681485649971863
max gap 3
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.79296 	 test_accuracy : 0.77321 	 max_acc epoch :  13 	 last test_accuracy : 0.77068
k :  1 	 val_accuracy : 0.79437 	 test_accuracy : 0.77490 	 max_acc epoch :  22 	 last test_accuracy : 0.76505
k :  2 	 val_accuracy : 0.79296 	 test_accuracy : 0.77518 	 max_acc epoch :  29 	 last test_accuracy : 0.77096
k :  3 	 val_accuracy : 0.79718 	 test_accuracy : 0.76956 	 max_acc epoch :  27 	 last test_accuracy : 0.76646
k :  4 	 val_accuracy : 0.79155 	 test_accuracy : 0.77181 	 max_acc epoch :  35 	 last test_accuracy : 0.76787
k :  5 	 val_accuracy : 0.79437 	 test_accuracy : 0.77659 	 max_acc epoch :  15 	 last test_accuracy : 0.76843
k :  6 	 val_accuracy : 0.79577 	 test_accuracy : 0.77546 	 max_acc epoch :  27 	 last test_accuracy : 0.76365
k :  7 	 val_accuracy : 0.79437 	 test_accuracy : 0.77378 	 max_acc epoch :  28 	 last test_accuracy : 0.77209
k :  8 	 val_accuracy : 0.79296 	 test_accuracy : 0.77406 	 max_acc epoch :  24 	 last test_accuracy : 0.76308
k :  9 	 val_accuracy : 0.79577 	 test_accuracy : 0.77434 	 max_acc epoch :  16 	 last test_accuracy : 0.76815

avg :  	 val_accuracy : 0.79423 	 test_accuracy : 0.77389 	 last_accuracy : 0.76764
