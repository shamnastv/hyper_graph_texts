date and time :  Mon Apr  5 21:15:29 2021
Namespace(batch_size=64, dataset='R8', debug=False, device=0, dropout=0.4, early_stop=50, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=4, num_mlp_layers=2, random_vec=False, seed=0, weight_decay=1e-07)
device :  cuda:0
Counter({5: 1472, 2: 1266, 1: 1168, 7: 1131, 4: 1106, 6: 909, 3: 602, 0: 37})
HGNNModel(
  (word_embeddings): Embedding(8232, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
          (1): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
          (1): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
          (1): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
          (1): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (2): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
          (1): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
          (1): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=8, bias=True)
    (1): Linear(in_features=200, out_features=8, bias=True)
    (2): Linear(in_features=200, out_features=8, bias=True)
    (3): Linear(in_features=200, out_features=8, bias=True)
  )
  (graph_pool_layer): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (3): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  103.26543766260147 Time :  442
accuracy train: 0.739851 val: 0.703636 test: 0.745662
max validation accuracy : 0.703636 max acc epoch : 1 test accuracy : 0.745662
Counter({1: 1735, 6: 1659, 0: 1605, 5: 1237, 7: 1033, 4: 308, 2: 90, 3: 24})

Epoch :  2 loss training:  52.35719022154808 Time :  887
accuracy train: 0.884468 val: 0.860000 test: 0.887671
max validation accuracy : 0.860000 max acc epoch : 2 test accuracy : 0.887671
Counter({1: 1836, 3: 1759, 7: 1530, 0: 1243, 5: 911, 6: 306, 4: 80, 2: 26})

Epoch :  3 loss training:  28.4956956487149 Time :  1318
accuracy train: 0.917996 val: 0.892727 test: 0.903196
max validation accuracy : 0.892727 max acc epoch : 3 test accuracy : 0.903196
Counter({0: 1512, 7: 1481, 6: 1375, 1: 1316, 3: 1170, 4: 618, 5: 190, 2: 29})

Epoch :  4 loss training:  22.219519702717662 Time :  1743
accuracy train: 0.931731 val: 0.901818 test: 0.942922
max validation accuracy : 0.901818 max acc epoch : 4 test accuracy : 0.942922
Counter({2: 2299, 1: 1556, 4: 1166, 3: 1080, 5: 1060, 0: 337, 7: 160, 6: 33})

Epoch :  5 loss training:  19.889730750583112 Time :  2238
accuracy train: 0.945264 val: 0.912727 test: 0.947945
max validation accuracy : 0.912727 max acc epoch : 5 test accuracy : 0.947945
Counter({2: 2268, 4: 1597, 1: 1289, 7: 967, 0: 955, 3: 361, 6: 175, 5: 79})

Epoch :  6 loss training:  15.107715960533824 Time :  2743
accuracy train: 0.953545 val: 0.929091 test: 0.946575
max validation accuracy : 0.929091 max acc epoch : 6 test accuracy : 0.946575
Counter({0: 2145, 5: 1805, 4: 1286, 3: 967, 2: 868, 7: 389, 1: 173, 6: 58})

Epoch :  7 loss training:  12.797291756374761 Time :  3190
accuracy train: 0.956978 val: 0.932727 test: 0.955251
max validation accuracy : 0.932727 max acc epoch : 7 test accuracy : 0.955251
Counter({0: 2256, 4: 1687, 2: 1246, 1: 914, 3: 777, 5: 537, 7: 181, 6: 93})

Epoch :  8 loss training:  11.805416015908122 Time :  3557
accuracy train: 0.961220 val: 0.932727 test: 0.952511
max validation accuracy : 0.932727 max acc epoch : 7 test accuracy : 0.955251
