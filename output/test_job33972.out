

date and time :  Thu May 27 10:26:05 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=202, weight_decay=1e-08)
device :  cuda:0

Epoch :  1 loss training:  210.96618235111237 Time :  102
accuracy train: 0.658504 val: 0.617910 test: 0.620084
max validation accuracy : 0.617910 max acc epoch : 1 test accuracy : 0.620084
Epoch-1 lr: 0.001

Epoch :  2 loss training:  142.82079899311066 Time :  133
accuracy train: 0.738584 val: 0.668657 test: 0.665842
max validation accuracy : 0.668657 max acc epoch : 2 test accuracy : 0.665842
Epoch-2 lr: 0.001

Epoch :  3 loss training:  119.04709577560425 Time :  174
accuracy train: 0.755791 val: 0.668657 test: 0.669800
max validation accuracy : 0.668657 max acc epoch : 2 test accuracy : 0.665842
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  96.145020455122 Time :  269
accuracy train: 0.812707 val: 0.689552 test: 0.695523
max validation accuracy : 0.689552 max acc epoch : 4 test accuracy : 0.695523
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.35248270630836 Time :  301
accuracy train: 0.826274 val: 0.704478 test: 0.702201
max validation accuracy : 0.704478 max acc epoch : 5 test accuracy : 0.702201
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.58208711445332 Time :  327
accuracy train: 0.838848 val: 0.686567 test: 0.693050
max validation accuracy : 0.704478 max acc epoch : 5 test accuracy : 0.702201
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  74.35298998653889 Time :  351
accuracy train: 0.863666 val: 0.698507 test: 0.706159
max validation accuracy : 0.704478 max acc epoch : 5 test accuracy : 0.702201
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  70.53208941221237 Time :  381
accuracy train: 0.870946 val: 0.710448 test: 0.711848
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.711848
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  67.80050751566887 Time :  402
accuracy train: 0.887823 val: 0.710448 test: 0.710364
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.711848
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.85926477611065 Time :  429
accuracy train: 0.889477 val: 0.701493 test: 0.712837
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.711848
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  57.71256545186043 Time :  462
accuracy train: 0.897419 val: 0.704478 test: 0.712590
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.711848
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  56.68520924448967 Time :  512
accuracy train: 0.904699 val: 0.710448 test: 0.714816
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.711848
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  54.26197583973408 Time :  551
accuracy train: 0.906684 val: 0.713433 test: 0.716547
max validation accuracy : 0.713433 max acc epoch : 13 test accuracy : 0.716547
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  53.751559391617775 Time :  591
accuracy train: 0.909662 val: 0.701493 test: 0.714816
max validation accuracy : 0.713433 max acc epoch : 13 test accuracy : 0.716547
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  52.42491772770882 Time :  646
accuracy train: 0.915288 val: 0.707463 test: 0.718773
max validation accuracy : 0.713433 max acc epoch : 13 test accuracy : 0.716547

Epoch :  16 loss training:  50.51709895581007 Time :  701
accuracy train: 0.918597 val: 0.704478 test: 0.716300
max validation accuracy : 0.713433 max acc epoch : 13 test accuracy : 0.716547

Epoch :  17 loss training:  49.47301833331585 Time :  737
accuracy train: 0.920251 val: 0.713433 test: 0.716052
max validation accuracy : 0.713433 max acc epoch : 13 test accuracy : 0.716547

Epoch :  18 loss training:  49.978223100304604 Time :  772
accuracy train: 0.924553 val: 0.707463 test: 0.715063
max validation accuracy : 0.713433 max acc epoch : 13 test accuracy : 0.716547

Epoch :  19 loss training:  48.06929865479469 Time :  809
accuracy train: 0.925546 val: 0.707463 test: 0.715310
max validation accuracy : 0.713433 max acc epoch : 13 test accuracy : 0.716547

Epoch :  20 loss training:  45.63972872495651 Time :  870
accuracy train: 0.934150 val: 0.707463 test: 0.721247
max validation accuracy : 0.713433 max acc epoch : 13 test accuracy : 0.716547

Epoch :  21 loss training:  45.3574964851141 Time :  917
accuracy train: 0.938451 val: 0.710448 test: 0.717042
max validation accuracy : 0.713433 max acc epoch : 13 test accuracy : 0.716547

Epoch :  22 loss training:  42.93334625661373 Time :  977
accuracy train: 0.939113 val: 0.707463 test: 0.721741
max validation accuracy : 0.713433 max acc epoch : 13 test accuracy : 0.716547

Epoch :  23 loss training:  43.04964743554592 Time :  1023
accuracy train: 0.942091 val: 0.722388 test: 0.719763
max validation accuracy : 0.722388 max acc epoch : 23 test accuracy : 0.719763

Epoch :  24 loss training:  39.90382977575064 Time :  1076
accuracy train: 0.944739 val: 0.725373 test: 0.718526
max validation accuracy : 0.725373 max acc epoch : 24 test accuracy : 0.718526

Epoch :  25 loss training:  39.11852012574673 Time :  1119
accuracy train: 0.952349 val: 0.707463 test: 0.720752
max validation accuracy : 0.725373 max acc epoch : 24 test accuracy : 0.718526

Epoch :  26 loss training:  38.08365897834301 Time :  1148
accuracy train: 0.955328 val: 0.722388 test: 0.722978
max validation accuracy : 0.725373 max acc epoch : 24 test accuracy : 0.718526

Epoch :  27 loss training:  36.253899686038494 Time :  1202
accuracy train: 0.954335 val: 0.716418 test: 0.720752
max validation accuracy : 0.725373 max acc epoch : 24 test accuracy : 0.718526

Epoch :  28 loss training:  35.430304042994976 Time :  1247
accuracy train: 0.959629 val: 0.719403 test: 0.722731
max validation accuracy : 0.725373 max acc epoch : 24 test accuracy : 0.718526

Epoch :  29 loss training:  36.034318298101425 Time :  1294
accuracy train: 0.961946 val: 0.722388 test: 0.723967
max validation accuracy : 0.725373 max acc epoch : 24 test accuracy : 0.718526

Epoch :  30 loss training:  34.767513670027256 Time :  1321
accuracy train: 0.966909 val: 0.728358 test: 0.722483
max validation accuracy : 0.728358 max acc epoch : 30 test accuracy : 0.722483

Epoch :  31 loss training:  31.41431199759245 Time :  1382
accuracy train: 0.968233 val: 0.728358 test: 0.721247
max validation accuracy : 0.728358 max acc epoch : 30 test accuracy : 0.722483

Epoch :  32 loss training:  30.562409408390522 Time :  1432
accuracy train: 0.969887 val: 0.725373 test: 0.720010
max validation accuracy : 0.728358 max acc epoch : 30 test accuracy : 0.722483

Epoch :  33 loss training:  30.209375008940697 Time :  1456
accuracy train: 0.971211 val: 0.737313 test: 0.720257
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  34 loss training:  30.055468015372753 Time :  1497
accuracy train: 0.973197 val: 0.737313 test: 0.722236
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  35 loss training:  27.917818523943424 Time :  1554
accuracy train: 0.974189 val: 0.722388 test: 0.725699
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  36 loss training:  25.891756527125835 Time :  1618
accuracy train: 0.979484 val: 0.737313 test: 0.726193
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  37 loss training:  26.385187041014433 Time :  1638
accuracy train: 0.984116 val: 0.719403 test: 0.724215
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  38 loss training:  25.579661641269922 Time :  1667
accuracy train: 0.984778 val: 0.713433 test: 0.726935
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  39 loss training:  24.372596852481365 Time :  1714
accuracy train: 0.986764 val: 0.734328 test: 0.727183
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  40 loss training:  22.33547992259264 Time :  1766
accuracy train: 0.986433 val: 0.731343 test: 0.725946
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  41 loss training:  22.56714653596282 Time :  1792
accuracy train: 0.991066 val: 0.734328 test: 0.722731
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  42 loss training:  22.03849544003606 Time :  1845
accuracy train: 0.992720 val: 0.722388 test: 0.724462
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  43 loss training:  21.306322935968637 Time :  1917
accuracy train: 0.991066 val: 0.734328 test: 0.728172
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  44 loss training:  21.74453717470169 Time :  1951
accuracy train: 0.994044 val: 0.716418 test: 0.723473
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  45 loss training:  19.66432400420308 Time :  1975
accuracy train: 0.992058 val: 0.725373 test: 0.727925
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  46 loss training:  19.063237130641937 Time :  2019
accuracy train: 0.993713 val: 0.722388 test: 0.729656
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  47 loss training:  17.700165558606386 Time :  2081
accuracy train: 0.997022 val: 0.731343 test: 0.722978
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  48 loss training:  17.454234153032303 Time :  2114
accuracy train: 0.995698 val: 0.731343 test: 0.730398
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  49 loss training:  17.381216511130333 Time :  2151
accuracy train: 0.998015 val: 0.725373 test: 0.723720
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  50 loss training:  16.77025304362178 Time :  2188
accuracy train: 0.996691 val: 0.731343 test: 0.726193
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  51 loss training:  17.00876347720623 Time :  2253
accuracy train: 0.997022 val: 0.731343 test: 0.724709
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  52 loss training:  15.184178054332733 Time :  2288
accuracy train: 0.997353 val: 0.722388 test: 0.726193
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  53 loss training:  14.913919065147638 Time :  2317
accuracy train: 0.998676 val: 0.737313 test: 0.723720
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  54 loss training:  13.898223945870996 Time :  2353
accuracy train: 0.998015 val: 0.725373 test: 0.726193
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  55 loss training:  13.70456794090569 Time :  2398
accuracy train: 0.999007 val: 0.728358 test: 0.721989
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  56 loss training:  12.943860251456499 Time :  2447
accuracy train: 0.999007 val: 0.719403 test: 0.723720
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  57 loss training:  12.201579123735428 Time :  2472
accuracy train: 0.999338 val: 0.728358 test: 0.723720
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  58 loss training:  13.045673550106585 Time :  2498
accuracy train: 0.999338 val: 0.719403 test: 0.726688
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  59 loss training:  12.427909415215254 Time :  2537
accuracy train: 0.999338 val: 0.719403 test: 0.725946
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  60 loss training:  11.220793241634965 Time :  2606
accuracy train: 0.999007 val: 0.737313 test: 0.726688
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  61 loss training:  11.279090008698404 Time :  2635
accuracy train: 0.999338 val: 0.734328 test: 0.726688
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  62 loss training:  10.166519568301737 Time :  2669
accuracy train: 0.999007 val: 0.728358 test: 0.727430
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  63 loss training:  10.442952271550894 Time :  2701
accuracy train: 0.999669 val: 0.722388 test: 0.725699
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

Epoch :  64 loss training:  10.024521732702851 Time :  2751
accuracy train: 0.999669 val: 0.725373 test: 0.724709
max validation accuracy : 0.737313 max acc epoch : 33 test accuracy : 0.720257

========================================================================================================================================================================================================
max acc epoch :  33
max validation accuracy :  0.7373134328358208
test accuracy :  0.7202572347266881
last test_accuracy :  0.7247093742270592
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=202, weight_decay=1e-08)
device :  cuda:0

Epoch :  1 loss training:  210.87213677167892 Time :  2873
accuracy train: 0.660490 val: 0.614925 test: 0.620826
max validation accuracy : 0.614925 max acc epoch : 1 test accuracy : 0.620826
Epoch-1 lr: 0.001

Epoch :  2 loss training:  142.8933828473091 Time :  2936
accuracy train: 0.729649 val: 0.656716 test: 0.665595
max validation accuracy : 0.656716 max acc epoch : 2 test accuracy : 0.665595
Epoch-2 lr: 0.001

Epoch :  3 loss training:  119.68758884072304 Time :  2990
accuracy train: 0.762740 val: 0.674627 test: 0.668810
max validation accuracy : 0.674627 max acc epoch : 3 test accuracy : 0.668810
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  96.47559005022049 Time :  3023
accuracy train: 0.814361 val: 0.695522 test: 0.694781
max validation accuracy : 0.695522 max acc epoch : 4 test accuracy : 0.694781
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.23223549127579 Time :  3067
accuracy train: 0.820649 val: 0.704478 test: 0.696018
max validation accuracy : 0.704478 max acc epoch : 5 test accuracy : 0.696018
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.8515912592411 Time :  3110
accuracy train: 0.835870 val: 0.680597 test: 0.696760
max validation accuracy : 0.704478 max acc epoch : 5 test accuracy : 0.696018
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  73.96557626128197 Time :  3135
accuracy train: 0.861681 val: 0.701493 test: 0.707890
max validation accuracy : 0.704478 max acc epoch : 5 test accuracy : 0.696018
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  70.45348556339741 Time :  3174
accuracy train: 0.872601 val: 0.710448 test: 0.712837
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.712837
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  67.51336078345776 Time :  3197
accuracy train: 0.886168 val: 0.728358 test: 0.712342
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.712342
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.41578459739685 Time :  3260
accuracy train: 0.890470 val: 0.707463 test: 0.717536
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.712342
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.00895267724991 Time :  3304
accuracy train: 0.892455 val: 0.707463 test: 0.717536
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.712342
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  56.345311626791954 Time :  3338
accuracy train: 0.904037 val: 0.707463 test: 0.717536
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.712342
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  54.593663796782494 Time :  3387
accuracy train: 0.908008 val: 0.713433 test: 0.717536
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.712342
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  53.72663313150406 Time :  3422
accuracy train: 0.910986 val: 0.716418 test: 0.720999
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.712342
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  52.68740604817867 Time :  3462
accuracy train: 0.910655 val: 0.719403 test: 0.720999
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.712342

Epoch :  16 loss training:  50.30492781102657 Time :  3490
accuracy train: 0.917273 val: 0.719403 test: 0.719763
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.712342

Epoch :  17 loss training:  49.38950628042221 Time :  3530
accuracy train: 0.915619 val: 0.725373 test: 0.717042
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.712342

Epoch :  18 loss training:  49.44304034113884 Time :  3596
accuracy train: 0.921244 val: 0.719403 test: 0.718279
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.712342

Epoch :  19 loss training:  47.8434112817049 Time :  3621
accuracy train: 0.925215 val: 0.725373 test: 0.722483
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.712342

Epoch :  20 loss training:  45.399354323744774 Time :  3662
accuracy train: 0.933819 val: 0.728358 test: 0.723473
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.712342

Epoch :  21 loss training:  45.24812953174114 Time :  3716
accuracy train: 0.937790 val: 0.713433 test: 0.719268
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.712342

Epoch :  22 loss training:  43.06153114140034 Time :  3781
accuracy train: 0.939113 val: 0.728358 test: 0.724709
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.712342

Epoch :  23 loss training:  42.585379764437675 Time :  3805
accuracy train: 0.941430 val: 0.737313 test: 0.722483
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  24 loss training:  40.058925837278366 Time :  3834
accuracy train: 0.943084 val: 0.728358 test: 0.723473
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  25 loss training:  39.14873243868351 Time :  3895
accuracy train: 0.949040 val: 0.716418 test: 0.721741
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  26 loss training:  38.13412947952747 Time :  3927
accuracy train: 0.953342 val: 0.725373 test: 0.723967
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  27 loss training:  36.266186986118555 Time :  3962
accuracy train: 0.952349 val: 0.725373 test: 0.725451
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  28 loss training:  35.460340708494186 Time :  3999
accuracy train: 0.956651 val: 0.731343 test: 0.726441
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  29 loss training:  36.25979321449995 Time :  4071
accuracy train: 0.958968 val: 0.728358 test: 0.722731
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  30 loss training:  34.689627550542355 Time :  4105
accuracy train: 0.966248 val: 0.722388 test: 0.722236
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  31 loss training:  31.148525394499302 Time :  4129
accuracy train: 0.964262 val: 0.719403 test: 0.724462
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  32 loss training:  30.272994622588158 Time :  4164
accuracy train: 0.966578 val: 0.719403 test: 0.724709
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  33 loss training:  29.993498750030994 Time :  4218
accuracy train: 0.969887 val: 0.722388 test: 0.723720
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  34 loss training:  30.079483181238174 Time :  4265
accuracy train: 0.971873 val: 0.734328 test: 0.722731
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  35 loss training:  27.510767057538033 Time :  4293
accuracy train: 0.974189 val: 0.728358 test: 0.727430
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  36 loss training:  25.689890582114458 Time :  4316
accuracy train: 0.978491 val: 0.734328 test: 0.725204
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  37 loss training:  26.3559179417789 Time :  4364
accuracy train: 0.983455 val: 0.719403 test: 0.724215
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  38 loss training:  25.291593924164772 Time :  4423
accuracy train: 0.982462 val: 0.725373 test: 0.722236
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  39 loss training:  24.01916417479515 Time :  4449
accuracy train: 0.986102 val: 0.728358 test: 0.724215
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  40 loss training:  22.12295240908861 Time :  4488
accuracy train: 0.986764 val: 0.725373 test: 0.726935
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  41 loss training:  22.529073741286993 Time :  4522
accuracy train: 0.990735 val: 0.731343 test: 0.725204
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  42 loss training:  21.755990631878376 Time :  4586
accuracy train: 0.992389 val: 0.716418 test: 0.722731
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  43 loss training:  21.380043294280767 Time :  4621
accuracy train: 0.990073 val: 0.734328 test: 0.729409
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  44 loss training:  21.61920332349837 Time :  4652
accuracy train: 0.993051 val: 0.725373 test: 0.724462
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  45 loss training:  19.552296426147223 Time :  4706
accuracy train: 0.991727 val: 0.722388 test: 0.723967
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  46 loss training:  18.946095377206802 Time :  4747
accuracy train: 0.995698 val: 0.725373 test: 0.723225
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  47 loss training:  17.46775932610035 Time :  4783
accuracy train: 0.995698 val: 0.713433 test: 0.723225
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  48 loss training:  17.894270699471235 Time :  4815
accuracy train: 0.994705 val: 0.719403 test: 0.729409
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  49 loss training:  17.499534575268626 Time :  4859
accuracy train: 0.996029 val: 0.737313 test: 0.723967
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  50 loss training:  17.049587465822697 Time :  4923
accuracy train: 0.996360 val: 0.728358 test: 0.725451
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  51 loss training:  17.036342125386 Time :  4951
accuracy train: 0.997022 val: 0.734328 test: 0.727430
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  52 loss training:  15.017226949334145 Time :  4994
accuracy train: 0.997353 val: 0.731343 test: 0.727183
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  53 loss training:  14.875972209498286 Time :  5057
accuracy train: 0.998345 val: 0.728358 test: 0.724215
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

Epoch :  54 loss training:  14.147350121289492 Time :  5109
accuracy train: 0.998015 val: 0.719403 test: 0.726935
max validation accuracy : 0.737313 max acc epoch : 23 test accuracy : 0.722483

========================================================================================================================================================================================================
max acc epoch :  23
max validation accuracy :  0.7373134328358208
test accuracy :  0.7224833044768736
last test_accuracy :  0.7269354439772446
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=202, weight_decay=1e-08)
device :  cuda:0

Epoch :  1 loss training:  210.99787813425064 Time :  5150
accuracy train: 0.655195 val: 0.614925 test: 0.615137
max validation accuracy : 0.614925 max acc epoch : 1 test accuracy : 0.615137
Epoch-1 lr: 0.001

Epoch :  2 loss training:  142.92050743103027 Time :  5204
accuracy train: 0.735606 val: 0.650746 test: 0.669552
max validation accuracy : 0.650746 max acc epoch : 2 test accuracy : 0.669552
Epoch-2 lr: 0.001

Epoch :  3 loss training:  119.40727615356445 Time :  5258
accuracy train: 0.761416 val: 0.674627 test: 0.672520
max validation accuracy : 0.674627 max acc epoch : 3 test accuracy : 0.672520
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  96.49611493945122 Time :  5286
accuracy train: 0.809729 val: 0.692537 test: 0.697007
max validation accuracy : 0.692537 max acc epoch : 4 test accuracy : 0.697007
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.2289317548275 Time :  5316
accuracy train: 0.825943 val: 0.698507 test: 0.698739
max validation accuracy : 0.698507 max acc epoch : 5 test accuracy : 0.698739
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.55084639787674 Time :  5358
accuracy train: 0.837856 val: 0.683582 test: 0.695028
max validation accuracy : 0.698507 max acc epoch : 5 test accuracy : 0.698739
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  73.95675686001778 Time :  5423
accuracy train: 0.862343 val: 0.698507 test: 0.707148
max validation accuracy : 0.698507 max acc epoch : 5 test accuracy : 0.698739
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  70.38121339678764 Time :  5447
accuracy train: 0.867968 val: 0.704478 test: 0.714321
max validation accuracy : 0.704478 max acc epoch : 8 test accuracy : 0.714321
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  68.2374355494976 Time :  5475
accuracy train: 0.884183 val: 0.716418 test: 0.714074
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.714074
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.85199427604675 Time :  5506
accuracy train: 0.891463 val: 0.701493 test: 0.716300
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.714074
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.21345318853855 Time :  5577
accuracy train: 0.892455 val: 0.713433 test: 0.711106
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.714074
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  56.620795518159866 Time :  5615
accuracy train: 0.902052 val: 0.701493 test: 0.718773
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.714074
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  54.57763487100601 Time :  5637
accuracy train: 0.905030 val: 0.716418 test: 0.718773
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.714074
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  53.94239945709705 Time :  5666
accuracy train: 0.906023 val: 0.710448 test: 0.717042
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.714074
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  52.6166927665472 Time :  5734
accuracy train: 0.909001 val: 0.713433 test: 0.716794
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.714074

Epoch :  16 loss training:  50.39636418223381 Time :  5797
accuracy train: 0.916281 val: 0.716418 test: 0.713579
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.714074

Epoch :  17 loss training:  49.59768317639828 Time :  5827
accuracy train: 0.917935 val: 0.713433 test: 0.714321
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.714074

Epoch :  18 loss training:  49.55307571589947 Time :  5861
accuracy train: 0.923230 val: 0.713433 test: 0.713826
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.714074

Epoch :  19 loss training:  48.06532549858093 Time :  5914
accuracy train: 0.924222 val: 0.719403 test: 0.716052
max validation accuracy : 0.719403 max acc epoch : 19 test accuracy : 0.716052

Epoch :  20 loss training:  45.61953267455101 Time :  5991
accuracy train: 0.931502 val: 0.719403 test: 0.720999
max validation accuracy : 0.719403 max acc epoch : 19 test accuracy : 0.716052

Epoch :  21 loss training:  45.455923199653625 Time :  6041
accuracy train: 0.938451 val: 0.713433 test: 0.718279
max validation accuracy : 0.719403 max acc epoch : 19 test accuracy : 0.716052

Epoch :  22 loss training:  43.276116758584976 Time :  6076
accuracy train: 0.939444 val: 0.716418 test: 0.721247
max validation accuracy : 0.719403 max acc epoch : 19 test accuracy : 0.716052

Epoch :  23 loss training:  43.21772427856922 Time :  6130
accuracy train: 0.939444 val: 0.725373 test: 0.720257
max validation accuracy : 0.725373 max acc epoch : 23 test accuracy : 0.720257

Epoch :  24 loss training:  40.03808045387268 Time :  6208
accuracy train: 0.944408 val: 0.722388 test: 0.722483
max validation accuracy : 0.725373 max acc epoch : 23 test accuracy : 0.720257

Epoch :  25 loss training:  39.176619440317154 Time :  6248
accuracy train: 0.947717 val: 0.725373 test: 0.722236
max validation accuracy : 0.725373 max acc epoch : 23 test accuracy : 0.720257

Epoch :  26 loss training:  38.26407538354397 Time :  6296
accuracy train: 0.951357 val: 0.728358 test: 0.722483
max validation accuracy : 0.728358 max acc epoch : 26 test accuracy : 0.722483

Epoch :  27 loss training:  36.3722667619586 Time :  6360
accuracy train: 0.954004 val: 0.719403 test: 0.722483
max validation accuracy : 0.728358 max acc epoch : 26 test accuracy : 0.722483

Epoch :  28 loss training:  35.042533583939075 Time :  6434
accuracy train: 0.959298 val: 0.728358 test: 0.722483
max validation accuracy : 0.728358 max acc epoch : 26 test accuracy : 0.722483

Epoch :  29 loss training:  36.47801402211189 Time :  6480
accuracy train: 0.960622 val: 0.725373 test: 0.723473
max validation accuracy : 0.728358 max acc epoch : 26 test accuracy : 0.722483

Epoch :  30 loss training:  34.91524516046047 Time :  6527
accuracy train: 0.964593 val: 0.722388 test: 0.725699
max validation accuracy : 0.728358 max acc epoch : 26 test accuracy : 0.722483

Epoch :  31 loss training:  31.186742298305035 Time :  6594
accuracy train: 0.965917 val: 0.728358 test: 0.723720
max validation accuracy : 0.728358 max acc epoch : 26 test accuracy : 0.722483

Epoch :  32 loss training:  30.997415594756603 Time :  6645
accuracy train: 0.967902 val: 0.731343 test: 0.726441
max validation accuracy : 0.731343 max acc epoch : 32 test accuracy : 0.726441

Epoch :  33 loss training:  30.372322745621204 Time :  6695
accuracy train: 0.971211 val: 0.728358 test: 0.721247
max validation accuracy : 0.731343 max acc epoch : 32 test accuracy : 0.726441

Epoch :  34 loss training:  29.837592519819736 Time :  6742
accuracy train: 0.972535 val: 0.725373 test: 0.725946
max validation accuracy : 0.731343 max acc epoch : 32 test accuracy : 0.726441

Epoch :  35 loss training:  27.76463905721903 Time :  6816
accuracy train: 0.977167 val: 0.728358 test: 0.725451
max validation accuracy : 0.731343 max acc epoch : 32 test accuracy : 0.726441

Epoch :  36 loss training:  26.04613684490323 Time :  6874
accuracy train: 0.978491 val: 0.728358 test: 0.727677
max validation accuracy : 0.731343 max acc epoch : 32 test accuracy : 0.726441

Epoch :  37 loss training:  26.465022139251232 Time :  6923
accuracy train: 0.983786 val: 0.725373 test: 0.724957
max validation accuracy : 0.731343 max acc epoch : 32 test accuracy : 0.726441

Epoch :  38 loss training:  25.34043150395155 Time :  6980
accuracy train: 0.983124 val: 0.719403 test: 0.726688
max validation accuracy : 0.731343 max acc epoch : 32 test accuracy : 0.726441

Epoch :  39 loss training:  23.98705993965268 Time :  7038
accuracy train: 0.986433 val: 0.716418 test: 0.726688
max validation accuracy : 0.731343 max acc epoch : 32 test accuracy : 0.726441

Epoch :  40 loss training:  22.60288093984127 Time :  7092
accuracy train: 0.986102 val: 0.728358 test: 0.727183
max validation accuracy : 0.731343 max acc epoch : 32 test accuracy : 0.726441

Epoch :  41 loss training:  22.50032940879464 Time :  7139
accuracy train: 0.990404 val: 0.722388 test: 0.726935
max validation accuracy : 0.731343 max acc epoch : 32 test accuracy : 0.726441

Epoch :  42 loss training:  21.681052338331938 Time :  7210
accuracy train: 0.990735 val: 0.722388 test: 0.727677
max validation accuracy : 0.731343 max acc epoch : 32 test accuracy : 0.726441

Epoch :  43 loss training:  21.417322777211666 Time :  7258
accuracy train: 0.992058 val: 0.722388 test: 0.731140
max validation accuracy : 0.731343 max acc epoch : 32 test accuracy : 0.726441

Epoch :  44 loss training:  21.75215472280979 Time :  7312
accuracy train: 0.993382 val: 0.728358 test: 0.730151
max validation accuracy : 0.731343 max acc epoch : 32 test accuracy : 0.726441

Epoch :  45 loss training:  20.017001766711473 Time :  7374
accuracy train: 0.991727 val: 0.725373 test: 0.727925
max validation accuracy : 0.731343 max acc epoch : 32 test accuracy : 0.726441

Epoch :  46 loss training:  18.842975359410048 Time :  7433
accuracy train: 0.994375 val: 0.731343 test: 0.731140
max validation accuracy : 0.731343 max acc epoch : 32 test accuracy : 0.726441

Epoch :  47 loss training:  17.645307064056396 Time :  7498
accuracy train: 0.995036 val: 0.722388 test: 0.729904
max validation accuracy : 0.731343 max acc epoch : 32 test accuracy : 0.726441

Epoch :  48 loss training:  17.968457765877247 Time :  7559
accuracy train: 0.994705 val: 0.728358 test: 0.730151
max validation accuracy : 0.731343 max acc epoch : 32 test accuracy : 0.726441

Epoch :  49 loss training:  17.24735165759921 Time :  7613
accuracy train: 0.996360 val: 0.734328 test: 0.728667
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.728667

Epoch :  50 loss training:  16.93351369164884 Time :  7676
accuracy train: 0.996029 val: 0.719403 test: 0.731635
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.728667

Epoch :  51 loss training:  17.054912632331252 Time :  7749
accuracy train: 0.996691 val: 0.728358 test: 0.728419
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.728667

Epoch :  52 loss training:  15.022469390183687 Time :  7792
accuracy train: 0.997684 val: 0.725373 test: 0.733119
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.728667

Epoch :  53 loss training:  15.159665279090405 Time :  7863
accuracy train: 0.998676 val: 0.725373 test: 0.726441
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.728667

Epoch :  54 loss training:  14.58504544571042 Time :  7915
accuracy train: 0.997684 val: 0.719403 test: 0.732872
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.728667

Epoch :  55 loss training:  13.900988379493356 Time :  7969
accuracy train: 0.998676 val: 0.722388 test: 0.730398
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.728667

Epoch :  56 loss training:  13.25067381002009 Time :  8036
accuracy train: 0.998015 val: 0.725373 test: 0.729656
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.728667

Epoch :  57 loss training:  12.221886029466987 Time :  8092
accuracy train: 0.999007 val: 0.734328 test: 0.724709
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.728667

Epoch :  58 loss training:  12.923781109973788 Time :  8143
accuracy train: 0.999338 val: 0.722388 test: 0.731388
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.728667

Epoch :  59 loss training:  12.550384959205985 Time :  8196
accuracy train: 0.998676 val: 0.725373 test: 0.724957
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.728667

Epoch :  60 loss training:  11.494254233315587 Time :  8279
accuracy train: 0.999007 val: 0.731343 test: 0.727677
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.728667

Epoch :  61 loss training:  11.110606799833477 Time :  8317
accuracy train: 0.999338 val: 0.728358 test: 0.731635
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.728667

Epoch :  62 loss training:  10.222395511344075 Time :  8386
accuracy train: 0.999007 val: 0.734328 test: 0.728172
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.728667

Epoch :  63 loss training:  10.865942094475031 Time :  8447
accuracy train: 0.999338 val: 0.725373 test: 0.729409
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.728667

Epoch :  64 loss training:  10.15383741632104 Time :  8515
accuracy train: 0.999007 val: 0.728358 test: 0.726441
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.728667

Epoch :  65 loss training:  9.130212310701609 Time :  8559
accuracy train: 0.999669 val: 0.722388 test: 0.723967
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.728667

Epoch :  66 loss training:  9.290021043270826 Time :  8624
accuracy train: 0.999669 val: 0.722388 test: 0.725204
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.728667

Epoch :  67 loss training:  9.452568088658154 Time :  8677
accuracy train: 0.999669 val: 0.728358 test: 0.726688
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.728667

Epoch :  68 loss training:  8.322284827008843 Time :  8748
accuracy train: 0.999338 val: 0.722388 test: 0.728419
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.728667

Epoch :  69 loss training:  8.931839728727937 Time :  8821
accuracy train: 0.999669 val: 0.725373 test: 0.724957
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.728667

Epoch :  70 loss training:  8.303030675277114 Time :  8869
accuracy train: 0.999338 val: 0.731343 test: 0.727183
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.728667

Epoch :  71 loss training:  7.9178791446611285 Time :  8928
accuracy train: 1.000000 val: 0.731343 test: 0.723967
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.728667

Epoch :  72 loss training:  6.713127542287111 Time :  8976
accuracy train: 0.999338 val: 0.737313 test: 0.731140
max validation accuracy : 0.737313 max acc epoch : 72 test accuracy : 0.731140

Epoch :  73 loss training:  7.404053278267384 Time :  9050
accuracy train: 1.000000 val: 0.740299 test: 0.727183
max validation accuracy : 0.740299 max acc epoch : 73 test accuracy : 0.727183

Epoch :  74 loss training:  6.889073509722948 Time :  9092
accuracy train: 1.000000 val: 0.725373 test: 0.724709
max validation accuracy : 0.740299 max acc epoch : 73 test accuracy : 0.727183

Epoch :  75 loss training:  7.811045347712934 Time :  9170
accuracy train: 1.000000 val: 0.731343 test: 0.726935
max validation accuracy : 0.740299 max acc epoch : 73 test accuracy : 0.727183

Epoch :  76 loss training:  6.551305744796991 Time :  9222
accuracy train: 1.000000 val: 0.740299 test: 0.727925
max validation accuracy : 0.740299 max acc epoch : 73 test accuracy : 0.727183

Epoch :  77 loss training:  5.993050240445882 Time :  9276
accuracy train: 1.000000 val: 0.734328 test: 0.729409
max validation accuracy : 0.740299 max acc epoch : 73 test accuracy : 0.727183

Epoch :  78 loss training:  5.677615351974964 Time :  9328
accuracy train: 1.000000 val: 0.737313 test: 0.726441
max validation accuracy : 0.740299 max acc epoch : 73 test accuracy : 0.727183

Epoch :  79 loss training:  6.293648408725858 Time :  9384
accuracy train: 1.000000 val: 0.740299 test: 0.726935
max validation accuracy : 0.740299 max acc epoch : 73 test accuracy : 0.727183

Epoch :  80 loss training:  5.632442347705364 Time :  9453
accuracy train: 1.000000 val: 0.722388 test: 0.726193
max validation accuracy : 0.740299 max acc epoch : 73 test accuracy : 0.727183

Epoch :  81 loss training:  6.4238368147052824 Time :  9489
accuracy train: 1.000000 val: 0.731343 test: 0.728667
max validation accuracy : 0.740299 max acc epoch : 73 test accuracy : 0.727183

Epoch :  82 loss training:  5.508182914927602 Time :  9557
accuracy train: 1.000000 val: 0.737313 test: 0.728914
max validation accuracy : 0.740299 max acc epoch : 73 test accuracy : 0.727183

Epoch :  83 loss training:  5.3640197506174445 Time :  9627
accuracy train: 1.000000 val: 0.722388 test: 0.725204
max validation accuracy : 0.740299 max acc epoch : 73 test accuracy : 0.727183

Epoch :  84 loss training:  5.288748819380999 Time :  9678
accuracy train: 1.000000 val: 0.728358 test: 0.724957
max validation accuracy : 0.740299 max acc epoch : 73 test accuracy : 0.727183

Epoch :  85 loss training:  5.150970478542149 Time :  9739
accuracy train: 1.000000 val: 0.728358 test: 0.724462
max validation accuracy : 0.740299 max acc epoch : 73 test accuracy : 0.727183

Epoch :  86 loss training:  5.410844447556883 Time :  9814
accuracy train: 1.000000 val: 0.731343 test: 0.723473
max validation accuracy : 0.740299 max acc epoch : 73 test accuracy : 0.727183

Epoch :  87 loss training:  4.492778080981225 Time :  9861
accuracy train: 1.000000 val: 0.734328 test: 0.725946
max validation accuracy : 0.740299 max acc epoch : 73 test accuracy : 0.727183

Epoch :  88 loss training:  4.274378292262554 Time :  9914
accuracy train: 1.000000 val: 0.731343 test: 0.726688
max validation accuracy : 0.740299 max acc epoch : 73 test accuracy : 0.727183

Epoch :  89 loss training:  4.49675715318881 Time :  10006
accuracy train: 1.000000 val: 0.743284 test: 0.728667
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  90 loss training:  4.24412207910791 Time :  10054
accuracy train: 1.000000 val: 0.740299 test: 0.727183
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  91 loss training:  4.056355258915573 Time :  10111
accuracy train: 1.000000 val: 0.722388 test: 0.725204
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  92 loss training:  4.270257756579667 Time :  10171
accuracy train: 1.000000 val: 0.731343 test: 0.727925
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  93 loss training:  4.403095293790102 Time :  10234
accuracy train: 1.000000 val: 0.731343 test: 0.724957
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  94 loss training:  4.041185167385265 Time :  10274
accuracy train: 1.000000 val: 0.737313 test: 0.728172
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  95 loss training:  3.9410140900872648 Time :  10330
accuracy train: 1.000000 val: 0.740299 test: 0.729162
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  96 loss training:  3.4816234158352017 Time :  10398
accuracy train: 1.000000 val: 0.740299 test: 0.728667
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  97 loss training:  3.62318170722574 Time :  10459
accuracy train: 1.000000 val: 0.737313 test: 0.721741
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  98 loss training:  3.4670884889783338 Time :  10507
accuracy train: 1.000000 val: 0.737313 test: 0.723473
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  99 loss training:  4.181041797623038 Time :  10555
accuracy train: 1.000000 val: 0.725373 test: 0.726688
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  100 loss training:  3.642579783219844 Time :  10625
accuracy train: 0.999669 val: 0.740299 test: 0.721247
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  101 loss training:  3.120227004168555 Time :  10670
accuracy train: 1.000000 val: 0.734328 test: 0.723967
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  102 loss training:  2.722019661217928 Time :  10739
accuracy train: 1.000000 val: 0.737313 test: 0.722236
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  103 loss training:  3.122240500175394 Time :  10795
accuracy train: 1.000000 val: 0.743284 test: 0.722483
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  104 loss training:  2.865874737035483 Time :  10861
accuracy train: 1.000000 val: 0.734328 test: 0.720505
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  105 loss training:  2.8399647953920066 Time :  10915
accuracy train: 1.000000 val: 0.743284 test: 0.726441
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  106 loss training:  2.621911600988824 Time :  10968
accuracy train: 1.000000 val: 0.725373 test: 0.724215
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  107 loss training:  2.272940272698179 Time :  11040
accuracy train: 1.000000 val: 0.725373 test: 0.724709
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  108 loss training:  2.670594319002703 Time :  11099
accuracy train: 1.000000 val: 0.731343 test: 0.725699
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  109 loss training:  2.200558080978226 Time :  11163
accuracy train: 1.000000 val: 0.722388 test: 0.725204
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  110 loss training:  2.2318909654859453 Time :  11225
accuracy train: 1.000000 val: 0.725373 test: 0.723225
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  111 loss training:  2.189911859575659 Time :  11278
accuracy train: 1.000000 val: 0.737313 test: 0.725699
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  112 loss training:  2.3934775973903015 Time :  11319
accuracy train: 1.000000 val: 0.734328 test: 0.725204
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  113 loss training:  2.240686879493296 Time :  11403
accuracy train: 1.000000 val: 0.737313 test: 0.727430
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  114 loss training:  2.326121160760522 Time :  11447
accuracy train: 1.000000 val: 0.731343 test: 0.719763
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  115 loss training:  2.068870666087605 Time :  11500
accuracy train: 1.000000 val: 0.725373 test: 0.727183
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  116 loss training:  2.4651489733951166 Time :  11571
accuracy train: 1.000000 val: 0.734328 test: 0.729162
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  117 loss training:  1.6562812138581648 Time :  11639
accuracy train: 1.000000 val: 0.737313 test: 0.723473
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  118 loss training:  2.222450505476445 Time :  11676
accuracy train: 1.000000 val: 0.740299 test: 0.725451
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  119 loss training:  1.99542354256846 Time :  11713
accuracy train: 1.000000 val: 0.740299 test: 0.730398
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

Epoch :  120 loss training:  1.714980335556902 Time :  11763
accuracy train: 1.000000 val: 0.737313 test: 0.725699
max validation accuracy : 0.743284 max acc epoch : 89 test accuracy : 0.728667

========================================================================================================================================================================================================
max acc epoch :  89
max validation accuracy :  0.7432835820895523
test accuracy :  0.7286668315607222
last test_accuracy :  0.7256987385604748
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=202, weight_decay=1e-08)
device :  cuda:0

Epoch :  1 loss training:  210.97742742300034 Time :  11817
accuracy train: 0.654203 val: 0.611940 test: 0.614148
max validation accuracy : 0.611940 max acc epoch : 1 test accuracy : 0.614148
Epoch-1 lr: 0.001

Epoch :  2 loss training:  143.13722217082977 Time :  11836
accuracy train: 0.733620 val: 0.662687 test: 0.665348
max validation accuracy : 0.662687 max acc epoch : 2 test accuracy : 0.665348
Epoch-2 lr: 0.001

Epoch :  3 loss training:  119.56798556447029 Time :  11866
accuracy train: 0.758107 val: 0.674627 test: 0.672520
max validation accuracy : 0.674627 max acc epoch : 3 test accuracy : 0.672520
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  96.47847726941109 Time :  11894
accuracy train: 0.810390 val: 0.698507 test: 0.699728
max validation accuracy : 0.698507 max acc epoch : 4 test accuracy : 0.699728
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.53157478570938 Time :  11919
accuracy train: 0.818663 val: 0.686567 test: 0.695028
max validation accuracy : 0.698507 max acc epoch : 4 test accuracy : 0.699728
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  85.2291376888752 Time :  11947
accuracy train: 0.835208 val: 0.686567 test: 0.693297
max validation accuracy : 0.698507 max acc epoch : 4 test accuracy : 0.699728
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  74.50051215291023 Time :  11969
accuracy train: 0.863005 val: 0.692537 test: 0.707395
max validation accuracy : 0.698507 max acc epoch : 4 test accuracy : 0.699728
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  70.67736777663231 Time :  11995
accuracy train: 0.871608 val: 0.704478 test: 0.713579
max validation accuracy : 0.704478 max acc epoch : 8 test accuracy : 0.713579
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  68.25941225886345 Time :  12025
accuracy train: 0.883852 val: 0.716418 test: 0.712095
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.712095
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.38957421481609 Time :  12052
accuracy train: 0.890139 val: 0.710448 test: 0.718279
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.712095
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.009698525071144 Time :  12079
accuracy train: 0.893779 val: 0.701493 test: 0.715558
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.712095
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  57.234177738428116 Time :  12108
accuracy train: 0.901721 val: 0.710448 test: 0.719763
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.712095
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  54.74140648543835 Time :  12131
accuracy train: 0.908670 val: 0.716418 test: 0.717289
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.712095
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  53.77405862510204 Time :  12157
accuracy train: 0.911317 val: 0.716418 test: 0.717784
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.712095
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  52.886881202459335 Time :  12187
accuracy train: 0.915619 val: 0.716418 test: 0.720010
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.712095

Epoch :  16 loss training:  50.760032653808594 Time :  12213
accuracy train: 0.917273 val: 0.716418 test: 0.718279
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.712095

Epoch :  17 loss training:  49.65005959570408 Time :  12237
accuracy train: 0.916612 val: 0.722388 test: 0.718031
max validation accuracy : 0.722388 max acc epoch : 17 test accuracy : 0.718031

Epoch :  18 loss training:  49.699997797608376 Time :  12267
accuracy train: 0.923891 val: 0.710448 test: 0.718526
max validation accuracy : 0.722388 max acc epoch : 17 test accuracy : 0.718031

Epoch :  19 loss training:  47.57327589392662 Time :  12291
accuracy train: 0.925546 val: 0.719403 test: 0.719268
max validation accuracy : 0.722388 max acc epoch : 17 test accuracy : 0.718031

Epoch :  20 loss training:  45.571490190923214 Time :  12315
accuracy train: 0.933819 val: 0.719403 test: 0.722731
max validation accuracy : 0.722388 max acc epoch : 17 test accuracy : 0.718031

Epoch :  21 loss training:  45.59904424846172 Time :  12341
accuracy train: 0.939113 val: 0.725373 test: 0.721741
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.721741

Epoch :  22 loss training:  43.69929850101471 Time :  12368
accuracy train: 0.942753 val: 0.722388 test: 0.724462
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.721741

Epoch :  23 loss training:  43.081341579556465 Time :  12392
accuracy train: 0.942091 val: 0.716418 test: 0.721989
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.721741

Epoch :  24 loss training:  39.92150325328112 Time :  12421
accuracy train: 0.943084 val: 0.731343 test: 0.723720
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  25 loss training:  39.09947595000267 Time :  12442
accuracy train: 0.948709 val: 0.728358 test: 0.722483
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  26 loss training:  38.438066840171814 Time :  12467
accuracy train: 0.952680 val: 0.728358 test: 0.723225
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  27 loss training:  36.097151789814234 Time :  12496
accuracy train: 0.953673 val: 0.731343 test: 0.724215
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  28 loss training:  35.65266963839531 Time :  12523
accuracy train: 0.959298 val: 0.719403 test: 0.723967
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  29 loss training:  36.49259062856436 Time :  12553
accuracy train: 0.957975 val: 0.728358 test: 0.726935
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  30 loss training:  34.23673700541258 Time :  12583
accuracy train: 0.966578 val: 0.719403 test: 0.723473
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  31 loss training:  31.181344978511333 Time :  12603
accuracy train: 0.965255 val: 0.725373 test: 0.724215
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  32 loss training:  30.564554676413536 Time :  12630
accuracy train: 0.969557 val: 0.719403 test: 0.722731
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  33 loss training:  29.590374991297722 Time :  12653
accuracy train: 0.971211 val: 0.716418 test: 0.722978
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  34 loss training:  30.02775740996003 Time :  12680
accuracy train: 0.971873 val: 0.728358 test: 0.723473
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  35 loss training:  27.682382576167583 Time :  12709
accuracy train: 0.974189 val: 0.719403 test: 0.723720
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  36 loss training:  26.09864714741707 Time :  12729
accuracy train: 0.978491 val: 0.719403 test: 0.724709
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  37 loss training:  26.741988971829414 Time :  12758
accuracy train: 0.982462 val: 0.722388 test: 0.722978
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  38 loss training:  25.59707238152623 Time :  12784
accuracy train: 0.984116 val: 0.722388 test: 0.721494
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  39 loss training:  23.876622423529625 Time :  12808
accuracy train: 0.985109 val: 0.722388 test: 0.724215
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  40 loss training:  21.99487667530775 Time :  12838
accuracy train: 0.987095 val: 0.719403 test: 0.726688
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  41 loss training:  22.565725285559893 Time :  12861
accuracy train: 0.990073 val: 0.716418 test: 0.725451
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  42 loss training:  21.59423041343689 Time :  12891
accuracy train: 0.991396 val: 0.722388 test: 0.725451
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  43 loss training:  20.984153106808662 Time :  12916
accuracy train: 0.991066 val: 0.731343 test: 0.728419
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  44 loss training:  21.657644867897034 Time :  12940
accuracy train: 0.992389 val: 0.719403 test: 0.725699
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  45 loss training:  19.728044781833887 Time :  12970
accuracy train: 0.990735 val: 0.725373 test: 0.727430
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  46 loss training:  18.95380910113454 Time :  12998
accuracy train: 0.994705 val: 0.725373 test: 0.724709
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  47 loss training:  17.325901683419943 Time :  13018
accuracy train: 0.996360 val: 0.722388 test: 0.725946
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  48 loss training:  17.837899141013622 Time :  13043
accuracy train: 0.995698 val: 0.728358 test: 0.728172
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  49 loss training:  17.291272290050983 Time :  13068
accuracy train: 0.996029 val: 0.725373 test: 0.725204
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  50 loss training:  16.69786113500595 Time :  13096
accuracy train: 0.997022 val: 0.719403 test: 0.728667
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  51 loss training:  16.80314377322793 Time :  13125
accuracy train: 0.997684 val: 0.731343 test: 0.730151
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  52 loss training:  15.25266321375966 Time :  13145
accuracy train: 0.998015 val: 0.722388 test: 0.727430
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  53 loss training:  14.92978292889893 Time :  13172
accuracy train: 0.998015 val: 0.719403 test: 0.721741
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  54 loss training:  14.260730192065239 Time :  13198
accuracy train: 0.998345 val: 0.728358 test: 0.726935
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

Epoch :  55 loss training:  13.686532126739621 Time :  13222
accuracy train: 0.998015 val: 0.719403 test: 0.724957
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.723720

========================================================================================================================================================================================================
max acc epoch :  24
max validation accuracy :  0.7313432835820896
test accuracy :  0.7237200098936434
last test_accuracy :  0.7249567153104131
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.73731 	 test_accuracy : 0.72026 	 max_acc epoch :  33 	 last test_accuracy : 0.72471
k :  1 	 val_accuracy : 0.73731 	 test_accuracy : 0.72248 	 max_acc epoch :  23 	 last test_accuracy : 0.72694
k :  2 	 val_accuracy : 0.74328 	 test_accuracy : 0.72867 	 max_acc epoch :  89 	 last test_accuracy : 0.72570
k :  3 	 val_accuracy : 0.73134 	 test_accuracy : 0.72372 	 max_acc epoch :  24 	 last test_accuracy : 0.72496

avg :  	 val_accuracy : 0.73731 	 test_accuracy : 0.72378 	 last_accuracy : 0.72558
