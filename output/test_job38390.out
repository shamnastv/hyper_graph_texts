

date and time :  Sat Jul  3 10:31:14 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=305, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  96.26781138777733 Time :  10
accuracy train: 0.756538 val: 0.762664 test: 0.741699
max validation accuracy : 0.762664 max acc epoch : 1 test accuracy : 0.741699
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.41049826145172 Time :  20
accuracy train: 0.776730 val: 0.772983 test: 0.763928
max validation accuracy : 0.772983 max acc epoch : 2 test accuracy : 0.763928
Epoch-2 lr: 0.001

Epoch :  3 loss training:  87.02214586734772 Time :  30
accuracy train: 0.789970 val: 0.781426 test: 0.783905
max validation accuracy : 0.781426 max acc epoch : 3 test accuracy : 0.783905
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.6800163090229 Time :  39
accuracy train: 0.790798 val: 0.774859 test: 0.758863
max validation accuracy : 0.781426 max acc epoch : 3 test accuracy : 0.783905
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.64794200658798 Time :  49
accuracy train: 0.803542 val: 0.785178 test: 0.774057
max validation accuracy : 0.785178 max acc epoch : 5 test accuracy : 0.774057
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.58762437105179 Time :  58
accuracy train: 0.810659 val: 0.789869 test: 0.775746
max validation accuracy : 0.789869 max acc epoch : 6 test accuracy : 0.775746
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.64349761605263 Time :  67
accuracy train: 0.813638 val: 0.791745 test: 0.780248
max validation accuracy : 0.791745 max acc epoch : 7 test accuracy : 0.780248
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  77.07118806242943 Time :  76
accuracy train: 0.817279 val: 0.795497 test: 0.779403
max validation accuracy : 0.795497 max acc epoch : 8 test accuracy : 0.779403
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.57948127388954 Time :  85
accuracy train: 0.817445 val: 0.787992 test: 0.778841
max validation accuracy : 0.795497 max acc epoch : 8 test accuracy : 0.779403
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.71002745628357 Time :  95
accuracy train: 0.813969 val: 0.783302 test: 0.768711
max validation accuracy : 0.795497 max acc epoch : 8 test accuracy : 0.779403

Epoch :  11 loss training:  75.15499722957611 Time :  105
accuracy train: 0.828534 val: 0.789869 test: 0.782499
max validation accuracy : 0.795497 max acc epoch : 8 test accuracy : 0.779403

Epoch :  12 loss training:  73.66165298223495 Time :  114
accuracy train: 0.834326 val: 0.795497 test: 0.780810
max validation accuracy : 0.795497 max acc epoch : 8 test accuracy : 0.779403

Epoch :  13 loss training:  72.26102973520756 Time :  124
accuracy train: 0.841278 val: 0.795497 test: 0.783061
max validation accuracy : 0.795497 max acc epoch : 8 test accuracy : 0.779403

Epoch :  14 loss training:  68.9710554331541 Time :  133
accuracy train: 0.850877 val: 0.803940 test: 0.784187
max validation accuracy : 0.803940 max acc epoch : 14 test accuracy : 0.784187

Epoch :  15 loss training:  67.41023440659046 Time :  142
accuracy train: 0.863125 val: 0.808630 test: 0.787282
max validation accuracy : 0.808630 max acc epoch : 15 test accuracy : 0.787282

Epoch :  16 loss training:  65.254130423069 Time :  151
accuracy train: 0.866435 val: 0.802064 test: 0.783061
max validation accuracy : 0.808630 max acc epoch : 15 test accuracy : 0.787282

Epoch :  17 loss training:  63.34331315755844 Time :  161
accuracy train: 0.878352 val: 0.800188 test: 0.780248
max validation accuracy : 0.808630 max acc epoch : 15 test accuracy : 0.787282

Epoch :  18 loss training:  60.678362525999546 Time :  171
accuracy train: 0.881993 val: 0.811445 test: 0.782217
max validation accuracy : 0.811445 max acc epoch : 18 test accuracy : 0.782217

Epoch :  19 loss training:  59.243162736296654 Time :  180
accuracy train: 0.893413 val: 0.807692 test: 0.786438
max validation accuracy : 0.811445 max acc epoch : 18 test accuracy : 0.782217

Epoch :  20 loss training:  58.450020000338554 Time :  190
accuracy train: 0.902185 val: 0.813321 test: 0.787563
max validation accuracy : 0.813321 max acc epoch : 20 test accuracy : 0.787563

Epoch :  21 loss training:  57.24842029809952 Time :  200
accuracy train: 0.906322 val: 0.815197 test: 0.789814
max validation accuracy : 0.815197 max acc epoch : 21 test accuracy : 0.789814

Epoch :  22 loss training:  54.976494401693344 Time :  210
accuracy train: 0.912777 val: 0.807692 test: 0.786719
max validation accuracy : 0.815197 max acc epoch : 21 test accuracy : 0.789814

Epoch :  23 loss training:  51.78950470685959 Time :  219
accuracy train: 0.917246 val: 0.814259 test: 0.785875
max validation accuracy : 0.815197 max acc epoch : 21 test accuracy : 0.789814

Epoch :  24 loss training:  51.580934926867485 Time :  229
accuracy train: 0.928004 val: 0.804878 test: 0.787001
max validation accuracy : 0.815197 max acc epoch : 21 test accuracy : 0.789814

Epoch :  25 loss training:  48.31356470286846 Time :  238
accuracy train: 0.930156 val: 0.810507 test: 0.784750
max validation accuracy : 0.815197 max acc epoch : 21 test accuracy : 0.789814

Epoch :  26 loss training:  46.654977075755596 Time :  248
accuracy train: 0.936445 val: 0.809568 test: 0.787282
max validation accuracy : 0.815197 max acc epoch : 21 test accuracy : 0.789814

Epoch :  27 loss training:  45.82635109126568 Time :  257
accuracy train: 0.942072 val: 0.803940 test: 0.786156
max validation accuracy : 0.815197 max acc epoch : 21 test accuracy : 0.789814

Epoch :  28 loss training:  44.500309996306896 Time :  267
accuracy train: 0.945879 val: 0.799250 test: 0.786438
max validation accuracy : 0.815197 max acc epoch : 21 test accuracy : 0.789814

Epoch :  29 loss training:  40.97038406133652 Time :  277
accuracy train: 0.954816 val: 0.803002 test: 0.788970
max validation accuracy : 0.815197 max acc epoch : 21 test accuracy : 0.789814

Epoch :  30 loss training:  41.18386276811361 Time :  287
accuracy train: 0.954485 val: 0.798311 test: 0.783061
max validation accuracy : 0.815197 max acc epoch : 21 test accuracy : 0.789814

Epoch :  31 loss training:  38.63310403376818 Time :  297
accuracy train: 0.962926 val: 0.800188 test: 0.781092
max validation accuracy : 0.815197 max acc epoch : 21 test accuracy : 0.789814

Epoch :  32 loss training:  38.68216225504875 Time :  307
accuracy train: 0.964085 val: 0.804878 test: 0.788407
max validation accuracy : 0.815197 max acc epoch : 21 test accuracy : 0.789814

========================================================================================================================================================================================================
best acc epoch :  21
validation accuracy :  0.8151969981238274
test accuracy :  0.7898142937535172
last test_accuracy :  0.7884074282498593
second best val :  0.8142589118198874
second best test :  0.7898142937535172
max gap 6
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=382, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  96.94508573412895 Time :  317
accuracy train: 0.765475 val: 0.744841 test: 0.754924
max validation accuracy : 0.744841 max acc epoch : 1 test accuracy : 0.754924
Epoch-1 lr: 0.001

Epoch :  2 loss training:  88.52154842019081 Time :  327
accuracy train: 0.767627 val: 0.762664 test: 0.766179
max validation accuracy : 0.762664 max acc epoch : 2 test accuracy : 0.766179
Epoch-2 lr: 0.001

Epoch :  3 loss training:  84.95377883315086 Time :  336
accuracy train: 0.782688 val: 0.761726 test: 0.777434
max validation accuracy : 0.762664 max acc epoch : 2 test accuracy : 0.766179
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  83.01079735159874 Time :  346
accuracy train: 0.798080 val: 0.762664 test: 0.782780
max validation accuracy : 0.762664 max acc epoch : 2 test accuracy : 0.766179
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  81.37990632653236 Time :  356
accuracy train: 0.792949 val: 0.769231 test: 0.769555
max validation accuracy : 0.769231 max acc epoch : 5 test accuracy : 0.769555
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.07765486836433 Time :  367
accuracy train: 0.789143 val: 0.757036 test: 0.774057
max validation accuracy : 0.769231 max acc epoch : 5 test accuracy : 0.769555
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  78.12537190318108 Time :  377
accuracy train: 0.810824 val: 0.771107 test: 0.781092
max validation accuracy : 0.771107 max acc epoch : 7 test accuracy : 0.781092
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  77.68618351221085 Time :  387
accuracy train: 0.812479 val: 0.778612 test: 0.785875
max validation accuracy : 0.778612 max acc epoch : 8 test accuracy : 0.785875
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.65541107952595 Time :  397
accuracy train: 0.813638 val: 0.775797 test: 0.785312
max validation accuracy : 0.778612 max acc epoch : 8 test accuracy : 0.785875
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.69757291674614 Time :  407
accuracy train: 0.819596 val: 0.772045 test: 0.787563
max validation accuracy : 0.778612 max acc epoch : 8 test accuracy : 0.785875

Epoch :  11 loss training:  75.10931113362312 Time :  417
accuracy train: 0.824892 val: 0.770169 test: 0.787563
max validation accuracy : 0.778612 max acc epoch : 8 test accuracy : 0.785875

Epoch :  12 loss training:  73.26663082838058 Time :  427
accuracy train: 0.830354 val: 0.777674 test: 0.783905
max validation accuracy : 0.778612 max acc epoch : 8 test accuracy : 0.785875

Epoch :  13 loss training:  72.7187594473362 Time :  436
accuracy train: 0.843264 val: 0.780488 test: 0.788689
max validation accuracy : 0.780488 max acc epoch : 13 test accuracy : 0.788689

Epoch :  14 loss training:  69.42008519172668 Time :  442
accuracy train: 0.848064 val: 0.772045 test: 0.785594
max validation accuracy : 0.780488 max acc epoch : 13 test accuracy : 0.788689

Epoch :  15 loss training:  69.75839571654797 Time :  451
accuracy train: 0.855842 val: 0.772045 test: 0.786438
max validation accuracy : 0.780488 max acc epoch : 13 test accuracy : 0.788689

Epoch :  16 loss training:  66.533680960536 Time :  462
accuracy train: 0.867594 val: 0.777674 test: 0.786156
max validation accuracy : 0.780488 max acc epoch : 13 test accuracy : 0.788689

Epoch :  17 loss training:  63.56517827510834 Time :  471
accuracy train: 0.871235 val: 0.781426 test: 0.783624
max validation accuracy : 0.781426 max acc epoch : 17 test accuracy : 0.783624

Epoch :  18 loss training:  62.98549756407738 Time :  481
accuracy train: 0.877358 val: 0.782364 test: 0.788970
max validation accuracy : 0.782364 max acc epoch : 18 test accuracy : 0.788970

Epoch :  19 loss training:  58.99150975048542 Time :  491
accuracy train: 0.888613 val: 0.785178 test: 0.788126
max validation accuracy : 0.785178 max acc epoch : 19 test accuracy : 0.788126

Epoch :  20 loss training:  58.51616044342518 Time :  501
accuracy train: 0.897550 val: 0.787992 test: 0.787845
max validation accuracy : 0.787992 max acc epoch : 20 test accuracy : 0.787845

Epoch :  21 loss training:  56.71605113148689 Time :  511
accuracy train: 0.904833 val: 0.781426 test: 0.791784
max validation accuracy : 0.787992 max acc epoch : 20 test accuracy : 0.787845

Epoch :  22 loss training:  54.60940742492676 Time :  521
accuracy train: 0.906819 val: 0.788931 test: 0.789814
max validation accuracy : 0.788931 max acc epoch : 22 test accuracy : 0.789814

Epoch :  23 loss training:  51.982905112206936 Time :  531
accuracy train: 0.917908 val: 0.788931 test: 0.789814
max validation accuracy : 0.788931 max acc epoch : 22 test accuracy : 0.789814

Epoch :  24 loss training:  49.825099498033524 Time :  541
accuracy train: 0.924363 val: 0.789869 test: 0.789533
max validation accuracy : 0.789869 max acc epoch : 24 test accuracy : 0.789533

Epoch :  25 loss training:  48.06253299117088 Time :  551
accuracy train: 0.931811 val: 0.784240 test: 0.790377
max validation accuracy : 0.789869 max acc epoch : 24 test accuracy : 0.789533

Epoch :  26 loss training:  46.42634244263172 Time :  561
accuracy train: 0.938596 val: 0.797373 test: 0.790096
max validation accuracy : 0.797373 max acc epoch : 26 test accuracy : 0.790096

Epoch :  27 loss training:  45.92805132269859 Time :  570
accuracy train: 0.941576 val: 0.793621 test: 0.788126
max validation accuracy : 0.797373 max acc epoch : 26 test accuracy : 0.790096

Epoch :  28 loss training:  43.84444033354521 Time :  579
accuracy train: 0.944224 val: 0.787992 test: 0.788407
max validation accuracy : 0.797373 max acc epoch : 26 test accuracy : 0.790096

Epoch :  29 loss training:  41.67635257542133 Time :  589
accuracy train: 0.949355 val: 0.781426 test: 0.787282
max validation accuracy : 0.797373 max acc epoch : 26 test accuracy : 0.790096

Epoch :  30 loss training:  41.19246747344732 Time :  598
accuracy train: 0.953161 val: 0.789869 test: 0.788407
max validation accuracy : 0.797373 max acc epoch : 26 test accuracy : 0.790096

Epoch :  31 loss training:  39.02002979815006 Time :  608
accuracy train: 0.957464 val: 0.787054 test: 0.789533
max validation accuracy : 0.797373 max acc epoch : 26 test accuracy : 0.790096

Epoch :  32 loss training:  37.833359092473984 Time :  618
accuracy train: 0.960113 val: 0.783302 test: 0.792628
max validation accuracy : 0.797373 max acc epoch : 26 test accuracy : 0.790096

Epoch :  33 loss training:  35.48450259119272 Time :  628
accuracy train: 0.964250 val: 0.791745 test: 0.789533
max validation accuracy : 0.797373 max acc epoch : 26 test accuracy : 0.790096

Epoch :  34 loss training:  35.18131737411022 Time :  638
accuracy train: 0.968884 val: 0.782364 test: 0.790658
max validation accuracy : 0.797373 max acc epoch : 26 test accuracy : 0.790096

Epoch :  35 loss training:  34.11997980251908 Time :  647
accuracy train: 0.974512 val: 0.784240 test: 0.789252
max validation accuracy : 0.797373 max acc epoch : 26 test accuracy : 0.790096

Epoch :  36 loss training:  31.314133696258068 Time :  656
accuracy train: 0.974843 val: 0.782364 test: 0.785875
max validation accuracy : 0.797373 max acc epoch : 26 test accuracy : 0.790096

Epoch :  37 loss training:  30.634264022111893 Time :  666
accuracy train: 0.976332 val: 0.785178 test: 0.785312
max validation accuracy : 0.797373 max acc epoch : 26 test accuracy : 0.790096

========================================================================================================================================================================================================
best acc epoch :  26
validation accuracy :  0.797373358348968
test accuracy :  0.7900956668542487
last test_accuracy :  0.7853123241418121
second best val :  0.7936210131332082
second best test :  0.7900956668542487
max gap 5
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=634, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  97.61409240961075 Time :  677
accuracy train: 0.776399 val: 0.754221 test: 0.760833
max validation accuracy : 0.754221 max acc epoch : 1 test accuracy : 0.760833
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.87636515498161 Time :  686
accuracy train: 0.777061 val: 0.757974 test: 0.760270
max validation accuracy : 0.757974 max acc epoch : 2 test accuracy : 0.760270
Epoch-2 lr: 0.001

Epoch :  3 loss training:  86.44813591241837 Time :  696
accuracy train: 0.793115 val: 0.763602 test: 0.771244
max validation accuracy : 0.763602 max acc epoch : 3 test accuracy : 0.771244
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.81233489513397 Time :  705
accuracy train: 0.785336 val: 0.761726 test: 0.758301
max validation accuracy : 0.763602 max acc epoch : 3 test accuracy : 0.771244
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.23337736725807 Time :  715
accuracy train: 0.804535 val: 0.771107 test: 0.776590
max validation accuracy : 0.771107 max acc epoch : 5 test accuracy : 0.776590
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.26069822907448 Time :  724
accuracy train: 0.810162 val: 0.765478 test: 0.777153
max validation accuracy : 0.771107 max acc epoch : 5 test accuracy : 0.776590
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  78.20389284193516 Time :  734
accuracy train: 0.811321 val: 0.757036 test: 0.780248
max validation accuracy : 0.771107 max acc epoch : 5 test accuracy : 0.776590
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.81419336795807 Time :  743
accuracy train: 0.818272 val: 0.756098 test: 0.780248
max validation accuracy : 0.771107 max acc epoch : 5 test accuracy : 0.776590
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.18337613344193 Time :  753
accuracy train: 0.821417 val: 0.767355 test: 0.781373
max validation accuracy : 0.771107 max acc epoch : 5 test accuracy : 0.776590
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.02955231070518 Time :  762
accuracy train: 0.827706 val: 0.767355 test: 0.781936
max validation accuracy : 0.771107 max acc epoch : 5 test accuracy : 0.776590

Epoch :  11 loss training:  75.31270241737366 Time :  771
accuracy train: 0.832506 val: 0.771107 test: 0.780248
max validation accuracy : 0.771107 max acc epoch : 5 test accuracy : 0.776590

Epoch :  12 loss training:  72.72783598303795 Time :  780
accuracy train: 0.845415 val: 0.772045 test: 0.786719
max validation accuracy : 0.772045 max acc epoch : 12 test accuracy : 0.786719

Epoch :  13 loss training:  70.58936677873135 Time :  790
accuracy train: 0.847898 val: 0.770169 test: 0.784468
max validation accuracy : 0.772045 max acc epoch : 12 test accuracy : 0.786719

Epoch :  14 loss training:  69.18761676549911 Time :  800
accuracy train: 0.857829 val: 0.777674 test: 0.782217
max validation accuracy : 0.777674 max acc epoch : 14 test accuracy : 0.782217

Epoch :  15 loss training:  68.09991213679314 Time :  810
accuracy train: 0.868090 val: 0.775797 test: 0.786156
max validation accuracy : 0.777674 max acc epoch : 14 test accuracy : 0.782217

Epoch :  16 loss training:  65.34706185758114 Time :  820
accuracy train: 0.868256 val: 0.773921 test: 0.784187
max validation accuracy : 0.777674 max acc epoch : 14 test accuracy : 0.782217

Epoch :  17 loss training:  62.668523490428925 Time :  830
accuracy train: 0.880834 val: 0.770169 test: 0.785031
max validation accuracy : 0.777674 max acc epoch : 14 test accuracy : 0.782217

Epoch :  18 loss training:  62.23054610192776 Time :  839
accuracy train: 0.885303 val: 0.772983 test: 0.787845
max validation accuracy : 0.777674 max acc epoch : 14 test accuracy : 0.782217

Epoch :  19 loss training:  60.7316787391901 Time :  849
accuracy train: 0.896557 val: 0.767355 test: 0.789814
max validation accuracy : 0.777674 max acc epoch : 14 test accuracy : 0.782217

Epoch :  20 loss training:  57.14581744372845 Time :  858
accuracy train: 0.908143 val: 0.773921 test: 0.786438
max validation accuracy : 0.777674 max acc epoch : 14 test accuracy : 0.782217

Epoch :  21 loss training:  56.14759203791618 Time :  867
accuracy train: 0.911288 val: 0.773921 test: 0.786438
max validation accuracy : 0.777674 max acc epoch : 14 test accuracy : 0.782217

Epoch :  22 loss training:  53.91725313663483 Time :  876
accuracy train: 0.921218 val: 0.773921 test: 0.790658
max validation accuracy : 0.777674 max acc epoch : 14 test accuracy : 0.782217

Epoch :  23 loss training:  52.75802443921566 Time :  885
accuracy train: 0.926349 val: 0.775797 test: 0.785312
max validation accuracy : 0.777674 max acc epoch : 14 test accuracy : 0.782217

Epoch :  24 loss training:  50.404445111751556 Time :  894
accuracy train: 0.932142 val: 0.774859 test: 0.786156
max validation accuracy : 0.777674 max acc epoch : 14 test accuracy : 0.782217

Epoch :  25 loss training:  48.13028075546026 Time :  903
accuracy train: 0.933631 val: 0.771107 test: 0.782780
max validation accuracy : 0.777674 max acc epoch : 14 test accuracy : 0.782217

========================================================================================================================================================================================================
best acc epoch :  14
validation accuracy :  0.7776735459662288
test accuracy :  0.7822172200337648
last test_accuracy :  0.7827799662352279
second best val :  0.775797373358349
second best test :  0.7822172200337648
max gap 7
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=898, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  96.77391105890274 Time :  914
accuracy train: 0.765806 val: 0.759850 test: 0.754080
max validation accuracy : 0.759850 max acc epoch : 1 test accuracy : 0.754080
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.61257502436638 Time :  923
accuracy train: 0.774578 val: 0.757974 test: 0.764772
max validation accuracy : 0.759850 max acc epoch : 1 test accuracy : 0.754080
Epoch-2 lr: 0.001

Epoch :  3 loss training:  85.77998575568199 Time :  933
accuracy train: 0.782853 val: 0.760788 test: 0.765053
max validation accuracy : 0.760788 max acc epoch : 3 test accuracy : 0.765053
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.8377736210823 Time :  942
accuracy train: 0.795929 val: 0.772045 test: 0.770118
max validation accuracy : 0.772045 max acc epoch : 4 test accuracy : 0.770118
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  81.01901170611382 Time :  952
accuracy train: 0.801225 val: 0.771107 test: 0.780810
max validation accuracy : 0.772045 max acc epoch : 4 test accuracy : 0.770118
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  78.58299060165882 Time :  962
accuracy train: 0.808507 val: 0.772045 test: 0.781936
max validation accuracy : 0.772045 max acc epoch : 4 test accuracy : 0.770118
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  76.54941236972809 Time :  971
accuracy train: 0.809666 val: 0.778612 test: 0.784468
max validation accuracy : 0.778612 max acc epoch : 7 test accuracy : 0.784468
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  77.84876027703285 Time :  980
accuracy train: 0.817279 val: 0.777674 test: 0.782499
max validation accuracy : 0.778612 max acc epoch : 7 test accuracy : 0.784468
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  77.14421927928925 Time :  989
accuracy train: 0.819762 val: 0.776735 test: 0.778278
max validation accuracy : 0.778612 max acc epoch : 7 test accuracy : 0.784468
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.55281710624695 Time :  999
accuracy train: 0.824230 val: 0.768293 test: 0.778559
max validation accuracy : 0.778612 max acc epoch : 7 test accuracy : 0.784468

Epoch :  11 loss training:  74.02056600153446 Time :  1008
accuracy train: 0.824396 val: 0.776735 test: 0.778841
max validation accuracy : 0.778612 max acc epoch : 7 test accuracy : 0.784468

Epoch :  12 loss training:  73.55815480649471 Time :  1017
accuracy train: 0.833664 val: 0.777674 test: 0.783343
max validation accuracy : 0.778612 max acc epoch : 7 test accuracy : 0.784468

Epoch :  13 loss training:  70.57630869746208 Time :  1026
accuracy train: 0.840119 val: 0.776735 test: 0.783061
max validation accuracy : 0.778612 max acc epoch : 7 test accuracy : 0.784468

Epoch :  14 loss training:  69.3814964145422 Time :  1036
accuracy train: 0.852367 val: 0.773921 test: 0.784750
max validation accuracy : 0.778612 max acc epoch : 7 test accuracy : 0.784468

Epoch :  15 loss training:  66.60135205090046 Time :  1047
accuracy train: 0.862297 val: 0.772045 test: 0.780248
max validation accuracy : 0.778612 max acc epoch : 7 test accuracy : 0.784468

Epoch :  16 loss training:  65.43332020938396 Time :  1057
accuracy train: 0.872393 val: 0.765478 test: 0.781654
max validation accuracy : 0.778612 max acc epoch : 7 test accuracy : 0.784468

Epoch :  17 loss training:  63.354749754071236 Time :  1067
accuracy train: 0.883648 val: 0.772045 test: 0.784750
max validation accuracy : 0.778612 max acc epoch : 7 test accuracy : 0.784468

Epoch :  18 loss training:  62.00473213195801 Time :  1077
accuracy train: 0.888613 val: 0.766417 test: 0.779966
max validation accuracy : 0.778612 max acc epoch : 7 test accuracy : 0.784468

========================================================================================================================================================================================================
best acc epoch :  7
validation accuracy :  0.7786116322701688
test accuracy :  0.7844682048396173
last test_accuracy :  0.7799662352279122
second best val :  0.7776735459662288
second best test :  0.7844682048396173
max gap 3
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  21 	 val_accuracy : 0.81520 	 test_accuracy : 0.78981 	 last test_accuracy : 0.78841 	 second best val : 0.81426 	 second best test : 0.78981
k :  1 	 best_acc epoch :  26 	 val_accuracy : 0.79737 	 test_accuracy : 0.79010 	 last test_accuracy : 0.78531 	 second best val : 0.79362 	 second best test : 0.79010
k :  2 	 best_acc epoch :  14 	 val_accuracy : 0.77767 	 test_accuracy : 0.78222 	 last test_accuracy : 0.78278 	 second best val : 0.77580 	 second best test : 0.78222
k :  3 	 best_acc epoch :  7 	 val_accuracy : 0.77861 	 test_accuracy : 0.78447 	 last test_accuracy : 0.77997 	 second best val : 0.77767 	 second best test : 0.78447

avg :  	 val_accuracy : 0.79221 	 test_accuracy : 0.78665 	 last_accuracy : 0.78412 	 second best val : 0.79034 	 second best test : 0.78665

std :  	 val_accuracy : 0.01542 	 test_accuracy : 0.00340 	 last_accuracy : 0.00312 	 second best val : 0.01545 	 second best test : 0.00340


date and time :  Sat Jul  3 10:49:21 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=49, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  96.24644535779953 Time :  11
accuracy train: 0.767130 val: 0.730769 test: 0.758582
max validation accuracy : 0.730769 max acc epoch : 1 test accuracy : 0.758582
Epoch-1 lr: 0.001

Epoch :  2 loss training:  88.05585119128227 Time :  20
accuracy train: 0.785170 val: 0.756098 test: 0.771525
max validation accuracy : 0.756098 max acc epoch : 2 test accuracy : 0.771525
Epoch-2 lr: 0.001

Epoch :  3 loss training:  84.20508843660355 Time :  28
accuracy train: 0.769116 val: 0.743902 test: 0.758582
max validation accuracy : 0.756098 max acc epoch : 2 test accuracy : 0.771525
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.11386951804161 Time :  38
accuracy train: 0.791956 val: 0.771107 test: 0.772088
max validation accuracy : 0.771107 max acc epoch : 4 test accuracy : 0.772088
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  79.77083739638329 Time :  47
accuracy train: 0.792287 val: 0.760788 test: 0.767586
max validation accuracy : 0.771107 max acc epoch : 4 test accuracy : 0.772088
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.44416964054108 Time :  56
accuracy train: 0.802218 val: 0.775797 test: 0.774057
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.774057
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  76.13206148147583 Time :  66
accuracy train: 0.807845 val: 0.759850 test: 0.780248
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.774057
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.61453840136528 Time :  75
accuracy train: 0.810990 val: 0.762664 test: 0.776308
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.774057
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.28074786067009 Time :  86
accuracy train: 0.813803 val: 0.769231 test: 0.776027
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.774057
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.414176389575 Time :  96
accuracy train: 0.815293 val: 0.762664 test: 0.773495
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.774057

Epoch :  11 loss training:  74.74108166992664 Time :  106
accuracy train: 0.819596 val: 0.760788 test: 0.776590
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.774057

Epoch :  12 loss training:  72.28436616063118 Time :  116
accuracy train: 0.833168 val: 0.770169 test: 0.777997
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.774057

Epoch :  13 loss training:  70.41258881986141 Time :  125
accuracy train: 0.841278 val: 0.771107 test: 0.777153
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.774057

Epoch :  14 loss training:  69.57451598346233 Time :  135
accuracy train: 0.846574 val: 0.774859 test: 0.779685
max validation accuracy : 0.775797 max acc epoch : 6 test accuracy : 0.774057

Epoch :  15 loss training:  67.69482536613941 Time :  145
accuracy train: 0.856339 val: 0.777674 test: 0.780248
max validation accuracy : 0.777674 max acc epoch : 15 test accuracy : 0.780248

Epoch :  16 loss training:  65.48543345928192 Time :  155
accuracy train: 0.865607 val: 0.774859 test: 0.781373
max validation accuracy : 0.777674 max acc epoch : 15 test accuracy : 0.780248

Epoch :  17 loss training:  63.66978640854359 Time :  165
accuracy train: 0.863621 val: 0.772983 test: 0.775464
max validation accuracy : 0.777674 max acc epoch : 15 test accuracy : 0.780248

Epoch :  18 loss training:  62.41912564635277 Time :  175
accuracy train: 0.880172 val: 0.777674 test: 0.783905
max validation accuracy : 0.777674 max acc epoch : 15 test accuracy : 0.780248

Epoch :  19 loss training:  59.23792153596878 Time :  185
accuracy train: 0.887786 val: 0.774859 test: 0.782217
max validation accuracy : 0.777674 max acc epoch : 15 test accuracy : 0.780248

Epoch :  20 loss training:  57.47862799465656 Time :  195
accuracy train: 0.899868 val: 0.791745 test: 0.784468
max validation accuracy : 0.791745 max acc epoch : 20 test accuracy : 0.784468

Epoch :  21 loss training:  56.06060488522053 Time :  205
accuracy train: 0.903343 val: 0.785178 test: 0.781092
max validation accuracy : 0.791745 max acc epoch : 20 test accuracy : 0.784468

Epoch :  22 loss training:  54.86752736568451 Time :  214
accuracy train: 0.905329 val: 0.782364 test: 0.780529
max validation accuracy : 0.791745 max acc epoch : 20 test accuracy : 0.784468

Epoch :  23 loss training:  51.90180476009846 Time :  225
accuracy train: 0.909964 val: 0.790807 test: 0.778841
max validation accuracy : 0.791745 max acc epoch : 20 test accuracy : 0.784468

Epoch :  24 loss training:  50.627392932772636 Time :  234
accuracy train: 0.913770 val: 0.769231 test: 0.777434
max validation accuracy : 0.791745 max acc epoch : 20 test accuracy : 0.784468

Epoch :  25 loss training:  48.019828125834465 Time :  244
accuracy train: 0.925356 val: 0.785178 test: 0.780248
max validation accuracy : 0.791745 max acc epoch : 20 test accuracy : 0.784468

Epoch :  26 loss training:  45.5896265283227 Time :  254
accuracy train: 0.937107 val: 0.789869 test: 0.780529
max validation accuracy : 0.791745 max acc epoch : 20 test accuracy : 0.784468

Epoch :  27 loss training:  45.43085132539272 Time :  264
accuracy train: 0.944224 val: 0.787992 test: 0.784187
max validation accuracy : 0.791745 max acc epoch : 20 test accuracy : 0.784468

Epoch :  28 loss training:  42.85705637931824 Time :  274
accuracy train: 0.948030 val: 0.788931 test: 0.784187
max validation accuracy : 0.791745 max acc epoch : 20 test accuracy : 0.784468

Epoch :  29 loss training:  41.136560909450054 Time :  285
accuracy train: 0.951837 val: 0.782364 test: 0.778559
max validation accuracy : 0.791745 max acc epoch : 20 test accuracy : 0.784468

Epoch :  30 loss training:  39.728127755224705 Time :  294
accuracy train: 0.957299 val: 0.783302 test: 0.778559
max validation accuracy : 0.791745 max acc epoch : 20 test accuracy : 0.784468

Epoch :  31 loss training:  39.521274507045746 Time :  304
accuracy train: 0.956637 val: 0.784240 test: 0.779966
max validation accuracy : 0.791745 max acc epoch : 20 test accuracy : 0.784468

========================================================================================================================================================================================================
best acc epoch :  20
validation accuracy :  0.7917448405253283
test accuracy :  0.7844682048396173
last test_accuracy :  0.7799662352279122
second best val :  0.7908067542213884
second best test :  0.7844682048396173
max gap 9
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=282, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  96.3884949684143 Time :  315
accuracy train: 0.769944 val: 0.758912 test: 0.756331
max validation accuracy : 0.758912 max acc epoch : 1 test accuracy : 0.756331
Epoch-1 lr: 0.001

Epoch :  2 loss training:  88.27921175956726 Time :  324
accuracy train: 0.781695 val: 0.762664 test: 0.768993
max validation accuracy : 0.762664 max acc epoch : 2 test accuracy : 0.768993
Epoch-2 lr: 0.001

Epoch :  3 loss training:  85.13583073019981 Time :  334
accuracy train: 0.792784 val: 0.759850 test: 0.769274
max validation accuracy : 0.762664 max acc epoch : 2 test accuracy : 0.768993
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.40926168859005 Time :  343
accuracy train: 0.782191 val: 0.756098 test: 0.768993
max validation accuracy : 0.762664 max acc epoch : 2 test accuracy : 0.768993
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.91605412960052 Time :  353
accuracy train: 0.801225 val: 0.777674 test: 0.771525
max validation accuracy : 0.777674 max acc epoch : 5 test accuracy : 0.771525
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  82.22254684567451 Time :  363
accuracy train: 0.801556 val: 0.767355 test: 0.771525
max validation accuracy : 0.777674 max acc epoch : 5 test accuracy : 0.771525
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.76052051782608 Time :  372
accuracy train: 0.809997 val: 0.764540 test: 0.768711
max validation accuracy : 0.777674 max acc epoch : 5 test accuracy : 0.771525
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  78.08556905388832 Time :  382
accuracy train: 0.804866 val: 0.772983 test: 0.775746
max validation accuracy : 0.777674 max acc epoch : 5 test accuracy : 0.771525
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.19559074938297 Time :  392
accuracy train: 0.816452 val: 0.777674 test: 0.775746
max validation accuracy : 0.777674 max acc epoch : 5 test accuracy : 0.771525
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.03768342733383 Time :  403
accuracy train: 0.816948 val: 0.778612 test: 0.777434
max validation accuracy : 0.778612 max acc epoch : 10 test accuracy : 0.777434

Epoch :  11 loss training:  75.21684348583221 Time :  412
accuracy train: 0.823237 val: 0.780488 test: 0.778841
max validation accuracy : 0.780488 max acc epoch : 11 test accuracy : 0.778841

Epoch :  12 loss training:  73.69022281467915 Time :  422
accuracy train: 0.830189 val: 0.780488 test: 0.779122
max validation accuracy : 0.780488 max acc epoch : 11 test accuracy : 0.778841

Epoch :  13 loss training:  71.087351962924 Time :  432
accuracy train: 0.838795 val: 0.771107 test: 0.778841
max validation accuracy : 0.780488 max acc epoch : 11 test accuracy : 0.778841

Epoch :  14 loss training:  69.28822101652622 Time :  442
accuracy train: 0.845581 val: 0.781426 test: 0.779403
max validation accuracy : 0.781426 max acc epoch : 14 test accuracy : 0.779403

Epoch :  15 loss training:  68.02649059891701 Time :  453
accuracy train: 0.850215 val: 0.778612 test: 0.779685
max validation accuracy : 0.781426 max acc epoch : 14 test accuracy : 0.779403

Epoch :  16 loss training:  67.51061742007732 Time :  462
accuracy train: 0.861966 val: 0.790807 test: 0.778841
max validation accuracy : 0.790807 max acc epoch : 16 test accuracy : 0.778841

Epoch :  17 loss training:  64.93611034750938 Time :  472
accuracy train: 0.869580 val: 0.787054 test: 0.780810
max validation accuracy : 0.790807 max acc epoch : 16 test accuracy : 0.778841

Epoch :  18 loss training:  63.10411365330219 Time :  481
accuracy train: 0.873055 val: 0.781426 test: 0.777434
max validation accuracy : 0.790807 max acc epoch : 16 test accuracy : 0.778841

Epoch :  19 loss training:  62.031360134482384 Time :  491
accuracy train: 0.879841 val: 0.793621 test: 0.776590
max validation accuracy : 0.793621 max acc epoch : 19 test accuracy : 0.776590

Epoch :  20 loss training:  59.6331912279129 Time :  501
accuracy train: 0.882158 val: 0.787992 test: 0.779403
max validation accuracy : 0.793621 max acc epoch : 19 test accuracy : 0.776590

Epoch :  21 loss training:  57.5166916847229 Time :  511
accuracy train: 0.895730 val: 0.787992 test: 0.774057
max validation accuracy : 0.793621 max acc epoch : 19 test accuracy : 0.776590

Epoch :  22 loss training:  54.80204229056835 Time :  520
accuracy train: 0.906157 val: 0.784240 test: 0.776871
max validation accuracy : 0.793621 max acc epoch : 19 test accuracy : 0.776590

Epoch :  23 loss training:  53.15093043446541 Time :  530
accuracy train: 0.909798 val: 0.787992 test: 0.774057
max validation accuracy : 0.793621 max acc epoch : 19 test accuracy : 0.776590

Epoch :  24 loss training:  53.232559844851494 Time :  539
accuracy train: 0.919894 val: 0.787054 test: 0.773495
max validation accuracy : 0.793621 max acc epoch : 19 test accuracy : 0.776590

Epoch :  25 loss training:  49.00842563807964 Time :  550
accuracy train: 0.924859 val: 0.793621 test: 0.772651
max validation accuracy : 0.793621 max acc epoch : 19 test accuracy : 0.776590

Epoch :  26 loss training:  48.35450790822506 Time :  560
accuracy train: 0.928832 val: 0.785178 test: 0.769274
max validation accuracy : 0.793621 max acc epoch : 19 test accuracy : 0.776590

Epoch :  27 loss training:  46.065780967473984 Time :  570
accuracy train: 0.933797 val: 0.775797 test: 0.771244
max validation accuracy : 0.793621 max acc epoch : 19 test accuracy : 0.776590

Epoch :  28 loss training:  43.51032826304436 Time :  580
accuracy train: 0.941576 val: 0.786116 test: 0.774620
max validation accuracy : 0.793621 max acc epoch : 19 test accuracy : 0.776590

Epoch :  29 loss training:  43.505944937467575 Time :  590
accuracy train: 0.939921 val: 0.781426 test: 0.771244
max validation accuracy : 0.793621 max acc epoch : 19 test accuracy : 0.776590

Epoch :  30 loss training:  41.89887800067663 Time :  599
accuracy train: 0.952003 val: 0.785178 test: 0.768711
max validation accuracy : 0.793621 max acc epoch : 19 test accuracy : 0.776590

========================================================================================================================================================================================================
best acc epoch :  19
validation accuracy :  0.7936210131332082
test accuracy :  0.7765897580191333
last test_accuracy :  0.7687113111986494
second best val :  0.7908067542213884
second best test :  0.7788407428249859
max gap 5
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=363, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  96.14551541209221 Time :  610
accuracy train: 0.774578 val: 0.742026 test: 0.763647
max validation accuracy : 0.742026 max acc epoch : 1 test accuracy : 0.763647
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.72337061166763 Time :  619
accuracy train: 0.781198 val: 0.757036 test: 0.761114
max validation accuracy : 0.757036 max acc epoch : 2 test accuracy : 0.761114
Epoch-2 lr: 0.001

Epoch :  3 loss training:  84.59806242585182 Time :  628
accuracy train: 0.789474 val: 0.764540 test: 0.771806
max validation accuracy : 0.764540 max acc epoch : 3 test accuracy : 0.771806
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  80.0921640098095 Time :  638
accuracy train: 0.793611 val: 0.745779 test: 0.769274
max validation accuracy : 0.764540 max acc epoch : 3 test accuracy : 0.771806
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  81.46210598945618 Time :  648
accuracy train: 0.799735 val: 0.768293 test: 0.771244
max validation accuracy : 0.768293 max acc epoch : 5 test accuracy : 0.771244
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.55095171928406 Time :  658
accuracy train: 0.807183 val: 0.765478 test: 0.777153
max validation accuracy : 0.768293 max acc epoch : 5 test accuracy : 0.771244
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  76.64921873807907 Time :  668
accuracy train: 0.812645 val: 0.772983 test: 0.773776
max validation accuracy : 0.772983 max acc epoch : 7 test accuracy : 0.773776
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  77.05132460594177 Time :  679
accuracy train: 0.817610 val: 0.770169 test: 0.777434
max validation accuracy : 0.772983 max acc epoch : 7 test accuracy : 0.773776
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  75.70549355447292 Time :  690
accuracy train: 0.817279 val: 0.763602 test: 0.775746
max validation accuracy : 0.772983 max acc epoch : 7 test accuracy : 0.773776
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.15075784921646 Time :  700
accuracy train: 0.823072 val: 0.771107 test: 0.779966
max validation accuracy : 0.772983 max acc epoch : 7 test accuracy : 0.773776

Epoch :  11 loss training:  75.10524553060532 Time :  711
accuracy train: 0.830354 val: 0.769231 test: 0.779403
max validation accuracy : 0.772983 max acc epoch : 7 test accuracy : 0.773776

Epoch :  12 loss training:  72.82209533452988 Time :  723
accuracy train: 0.835319 val: 0.771107 test: 0.785875
max validation accuracy : 0.772983 max acc epoch : 7 test accuracy : 0.773776

Epoch :  13 loss training:  71.53022654354572 Time :  733
accuracy train: 0.839954 val: 0.768293 test: 0.782499
max validation accuracy : 0.772983 max acc epoch : 7 test accuracy : 0.773776

Epoch :  14 loss training:  69.44423152506351 Time :  743
accuracy train: 0.850050 val: 0.773921 test: 0.783905
max validation accuracy : 0.773921 max acc epoch : 14 test accuracy : 0.783905

Epoch :  15 loss training:  67.48540933430195 Time :  753
accuracy train: 0.857498 val: 0.776735 test: 0.783905
max validation accuracy : 0.776735 max acc epoch : 15 test accuracy : 0.783905

Epoch :  16 loss training:  66.62439869344234 Time :  763
accuracy train: 0.859153 val: 0.770169 test: 0.777715
max validation accuracy : 0.776735 max acc epoch : 15 test accuracy : 0.783905

Epoch :  17 loss training:  63.513680055737495 Time :  773
accuracy train: 0.873221 val: 0.783302 test: 0.783061
max validation accuracy : 0.783302 max acc epoch : 17 test accuracy : 0.783061

Epoch :  18 loss training:  61.79277764260769 Time :  783
accuracy train: 0.879014 val: 0.782364 test: 0.782780
max validation accuracy : 0.783302 max acc epoch : 17 test accuracy : 0.783061

Epoch :  19 loss training:  61.19710010290146 Time :  793
accuracy train: 0.888282 val: 0.773921 test: 0.782499
max validation accuracy : 0.783302 max acc epoch : 17 test accuracy : 0.783061

Epoch :  20 loss training:  59.585051745176315 Time :  804
accuracy train: 0.896557 val: 0.780488 test: 0.781936
max validation accuracy : 0.783302 max acc epoch : 17 test accuracy : 0.783061

Epoch :  21 loss training:  56.601076401770115 Time :  814
accuracy train: 0.900695 val: 0.783302 test: 0.783905
max validation accuracy : 0.783302 max acc epoch : 17 test accuracy : 0.783061

Epoch :  22 loss training:  55.76726511120796 Time :  824
accuracy train: 0.908309 val: 0.787992 test: 0.784468
max validation accuracy : 0.787992 max acc epoch : 22 test accuracy : 0.784468

Epoch :  23 loss training:  53.368822276592255 Time :  833
accuracy train: 0.911950 val: 0.782364 test: 0.781092
max validation accuracy : 0.787992 max acc epoch : 22 test accuracy : 0.784468

Epoch :  24 loss training:  51.365386575460434 Time :  843
accuracy train: 0.921053 val: 0.789869 test: 0.786156
max validation accuracy : 0.789869 max acc epoch : 24 test accuracy : 0.786156

Epoch :  25 loss training:  48.986732333898544 Time :  853
accuracy train: 0.924694 val: 0.778612 test: 0.782780
max validation accuracy : 0.789869 max acc epoch : 24 test accuracy : 0.786156

Epoch :  26 loss training:  48.319074258208275 Time :  863
accuracy train: 0.931645 val: 0.777674 test: 0.783343
max validation accuracy : 0.789869 max acc epoch : 24 test accuracy : 0.786156

Epoch :  27 loss training:  45.78320603072643 Time :  874
accuracy train: 0.939921 val: 0.780488 test: 0.781373
max validation accuracy : 0.789869 max acc epoch : 24 test accuracy : 0.786156

Epoch :  28 loss training:  45.43083695322275 Time :  884
accuracy train: 0.941576 val: 0.774859 test: 0.779966
max validation accuracy : 0.789869 max acc epoch : 24 test accuracy : 0.786156

Epoch :  29 loss training:  43.61273634433746 Time :  894
accuracy train: 0.944389 val: 0.770169 test: 0.780529
max validation accuracy : 0.789869 max acc epoch : 24 test accuracy : 0.786156

Epoch :  30 loss training:  41.844888374209404 Time :  903
accuracy train: 0.951175 val: 0.769231 test: 0.777997
max validation accuracy : 0.789869 max acc epoch : 24 test accuracy : 0.786156

Epoch :  31 loss training:  40.59119352698326 Time :  913
accuracy train: 0.955809 val: 0.770169 test: 0.776027
max validation accuracy : 0.789869 max acc epoch : 24 test accuracy : 0.786156

Epoch :  32 loss training:  38.49328000843525 Time :  923
accuracy train: 0.958954 val: 0.768293 test: 0.777997
max validation accuracy : 0.789869 max acc epoch : 24 test accuracy : 0.786156

Epoch :  33 loss training:  35.70974047482014 Time :  933
accuracy train: 0.961768 val: 0.769231 test: 0.781936
max validation accuracy : 0.789869 max acc epoch : 24 test accuracy : 0.786156

Epoch :  34 loss training:  35.38203239440918 Time :  942
accuracy train: 0.964250 val: 0.776735 test: 0.777153
max validation accuracy : 0.789869 max acc epoch : 24 test accuracy : 0.786156

Epoch :  35 loss training:  35.36267004907131 Time :  953
accuracy train: 0.970705 val: 0.766417 test: 0.779122
max validation accuracy : 0.789869 max acc epoch : 24 test accuracy : 0.786156

========================================================================================================================================================================================================
best acc epoch :  24
validation accuracy :  0.7898686679174484
test accuracy :  0.7861564434440067
last test_accuracy :  0.7791221159257175
second best val :  0.7879924953095685
second best test :  0.7844682048396173
max gap 7
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=58, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  97.52015498280525 Time :  965
accuracy train: 0.744455 val: 0.725141 test: 0.743950
max validation accuracy : 0.725141 max acc epoch : 1 test accuracy : 0.743950
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.8329656124115 Time :  974
accuracy train: 0.776564 val: 0.761726 test: 0.770681
max validation accuracy : 0.761726 max acc epoch : 2 test accuracy : 0.770681
Epoch-2 lr: 0.001

Epoch :  3 loss training:  83.26591569185257 Time :  984
accuracy train: 0.790632 val: 0.758912 test: 0.774057
max validation accuracy : 0.761726 max acc epoch : 2 test accuracy : 0.770681
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  80.37023982405663 Time :  993
accuracy train: 0.786495 val: 0.757036 test: 0.767867
max validation accuracy : 0.761726 max acc epoch : 2 test accuracy : 0.770681
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.32474836707115 Time :  1004
accuracy train: 0.802549 val: 0.752345 test: 0.778278
max validation accuracy : 0.761726 max acc epoch : 2 test accuracy : 0.770681
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.6016004383564 Time :  1014
accuracy train: 0.810659 val: 0.760788 test: 0.771525
max validation accuracy : 0.761726 max acc epoch : 2 test accuracy : 0.770681
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.87775698304176 Time :  1024
accuracy train: 0.817941 val: 0.766417 test: 0.776871
max validation accuracy : 0.766417 max acc epoch : 7 test accuracy : 0.776871
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.45486253499985 Time :  1034
accuracy train: 0.820424 val: 0.771107 test: 0.774057
max validation accuracy : 0.771107 max acc epoch : 8 test accuracy : 0.774057
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  74.65063297748566 Time :  1043
accuracy train: 0.820258 val: 0.774859 test: 0.772369
max validation accuracy : 0.774859 max acc epoch : 9 test accuracy : 0.772369
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  74.85190039873123 Time :  1053
accuracy train: 0.824230 val: 0.776735 test: 0.778559
max validation accuracy : 0.776735 max acc epoch : 10 test accuracy : 0.778559

Epoch :  11 loss training:  74.16964030265808 Time :  1062
accuracy train: 0.835485 val: 0.772983 test: 0.779685
max validation accuracy : 0.776735 max acc epoch : 10 test accuracy : 0.778559

Epoch :  12 loss training:  72.43630957603455 Time :  1073
accuracy train: 0.834657 val: 0.766417 test: 0.775746
max validation accuracy : 0.776735 max acc epoch : 10 test accuracy : 0.778559

Epoch :  13 loss training:  71.02596198022366 Time :  1083
accuracy train: 0.848064 val: 0.780488 test: 0.779403
max validation accuracy : 0.780488 max acc epoch : 13 test accuracy : 0.779403

Epoch :  14 loss training:  69.35629333555698 Time :  1092
accuracy train: 0.853856 val: 0.781426 test: 0.781936
max validation accuracy : 0.781426 max acc epoch : 14 test accuracy : 0.781936

Epoch :  15 loss training:  66.97148883342743 Time :  1102
accuracy train: 0.866435 val: 0.790807 test: 0.776027
max validation accuracy : 0.790807 max acc epoch : 15 test accuracy : 0.776027

Epoch :  16 loss training:  65.86633783578873 Time :  1112
accuracy train: 0.872393 val: 0.780488 test: 0.779966
max validation accuracy : 0.790807 max acc epoch : 15 test accuracy : 0.776027

Epoch :  17 loss training:  64.49996846914291 Time :  1121
accuracy train: 0.878848 val: 0.787054 test: 0.785312
max validation accuracy : 0.790807 max acc epoch : 15 test accuracy : 0.776027

Epoch :  18 loss training:  62.4925257563591 Time :  1132
accuracy train: 0.883317 val: 0.797373 test: 0.782217
max validation accuracy : 0.797373 max acc epoch : 18 test accuracy : 0.782217

Epoch :  19 loss training:  59.166816264390945 Time :  1142
accuracy train: 0.889937 val: 0.788931 test: 0.785594
max validation accuracy : 0.797373 max acc epoch : 18 test accuracy : 0.782217

Epoch :  20 loss training:  58.89152681827545 Time :  1153
accuracy train: 0.897054 val: 0.780488 test: 0.783905
max validation accuracy : 0.797373 max acc epoch : 18 test accuracy : 0.782217

Epoch :  21 loss training:  56.45077121257782 Time :  1163
accuracy train: 0.904171 val: 0.790807 test: 0.787001
max validation accuracy : 0.797373 max acc epoch : 18 test accuracy : 0.782217

Epoch :  22 loss training:  54.25290957093239 Time :  1174
accuracy train: 0.912777 val: 0.793621 test: 0.783061
max validation accuracy : 0.797373 max acc epoch : 18 test accuracy : 0.782217

Epoch :  23 loss training:  53.8998256623745 Time :  1183
accuracy train: 0.920225 val: 0.787054 test: 0.785312
max validation accuracy : 0.797373 max acc epoch : 18 test accuracy : 0.782217

Epoch :  24 loss training:  50.868452578783035 Time :  1193
accuracy train: 0.923039 val: 0.788931 test: 0.785875
max validation accuracy : 0.797373 max acc epoch : 18 test accuracy : 0.782217

Epoch :  25 loss training:  49.04272326827049 Time :  1204
accuracy train: 0.928500 val: 0.789869 test: 0.788407
max validation accuracy : 0.797373 max acc epoch : 18 test accuracy : 0.782217

Epoch :  26 loss training:  47.66569992154837 Time :  1214
accuracy train: 0.930818 val: 0.787054 test: 0.785875
max validation accuracy : 0.797373 max acc epoch : 18 test accuracy : 0.782217

Epoch :  27 loss training:  46.997169367969036 Time :  1225
accuracy train: 0.938928 val: 0.788931 test: 0.783905
max validation accuracy : 0.797373 max acc epoch : 18 test accuracy : 0.782217

Epoch :  28 loss training:  44.23431858420372 Time :  1236
accuracy train: 0.946210 val: 0.787992 test: 0.788407
max validation accuracy : 0.797373 max acc epoch : 18 test accuracy : 0.782217

Epoch :  29 loss training:  42.163743518292904 Time :  1246
accuracy train: 0.949024 val: 0.783302 test: 0.784468
max validation accuracy : 0.797373 max acc epoch : 18 test accuracy : 0.782217

========================================================================================================================================================================================================
best acc epoch :  18
validation accuracy :  0.797373358348968
test accuracy :  0.7822172200337648
last test_accuracy :  0.7844682048396173
second best val :  0.7936210131332082
second best test :  0.7822172200337648
max gap 5
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  20 	 val_accuracy : 0.79174 	 test_accuracy : 0.78447 	 last test_accuracy : 0.77997 	 second best val : 0.79081 	 second best test : 0.78447
k :  1 	 best_acc epoch :  19 	 val_accuracy : 0.79362 	 test_accuracy : 0.77659 	 last test_accuracy : 0.76871 	 second best val : 0.79081 	 second best test : 0.77884
k :  2 	 best_acc epoch :  24 	 val_accuracy : 0.78987 	 test_accuracy : 0.78616 	 last test_accuracy : 0.77912 	 second best val : 0.78799 	 second best test : 0.78447
k :  3 	 best_acc epoch :  18 	 val_accuracy : 0.79737 	 test_accuracy : 0.78222 	 last test_accuracy : 0.78447 	 second best val : 0.79362 	 second best test : 0.78222

avg :  	 val_accuracy : 0.79315 	 test_accuracy : 0.78236 	 last_accuracy : 0.77807 	 second best val : 0.79081 	 second best test : 0.78250

std :  	 val_accuracy : 0.00277 	 test_accuracy : 0.00361 	 last_accuracy : 0.00577 	 second best val : 0.00199 	 second best test : 0.00230


date and time :  Sat Jul  3 11:10:17 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=426, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({0: 6186, 1: 4476})

Epoch :  1 loss training:  97.23759213089943 Time :  13
accuracy train: 0.767461 val: 0.775797 test: 0.754643
max validation accuracy : 0.775797 max acc epoch : 1 test accuracy : 0.754643
Counter({1: 5685, 0: 4977})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  89.27546191215515 Time :  26
accuracy train: 0.782191 val: 0.764540 test: 0.763365
max validation accuracy : 0.775797 max acc epoch : 1 test accuracy : 0.754643
Counter({1: 5609, 0: 5053})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  84.80866223573685 Time :  39
accuracy train: 0.766634 val: 0.756098 test: 0.743388
max validation accuracy : 0.775797 max acc epoch : 1 test accuracy : 0.754643
Counter({1: 5560, 0: 5102})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  82.3720274567604 Time :  58
accuracy train: 0.786329 val: 0.765478 test: 0.774620
max validation accuracy : 0.775797 max acc epoch : 1 test accuracy : 0.754643
Counter({1: 5528, 0: 5134})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.08917737007141 Time :  71
accuracy train: 0.802052 val: 0.768293 test: 0.775746
max validation accuracy : 0.775797 max acc epoch : 1 test accuracy : 0.754643
Counter({1: 5549, 0: 5113})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  78.84417259693146 Time :  84
accuracy train: 0.809831 val: 0.769231 test: 0.771525
max validation accuracy : 0.775797 max acc epoch : 1 test accuracy : 0.754643
Counter({0: 5589, 1: 5073})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.1109270453453 Time :  97
accuracy train: 0.809997 val: 0.757974 test: 0.769837
max validation accuracy : 0.775797 max acc epoch : 1 test accuracy : 0.754643
Counter({0: 5683, 1: 4979})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.52856405079365 Time :  114
accuracy train: 0.811155 val: 0.764540 test: 0.774902
max validation accuracy : 0.775797 max acc epoch : 1 test accuracy : 0.754643
Counter({0: 5727, 1: 4935})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  75.25671944022179 Time :  126
accuracy train: 0.819100 val: 0.772983 test: 0.777153
max validation accuracy : 0.775797 max acc epoch : 1 test accuracy : 0.754643
Counter({1: 5774, 0: 4888})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  74.82804200053215 Time :  138
accuracy train: 0.818769 val: 0.769231 test: 0.777434
max validation accuracy : 0.775797 max acc epoch : 1 test accuracy : 0.754643
Counter({1: 5778, 0: 4884})

Epoch :  11 loss training:  74.94090756773949 Time :  152
accuracy train: 0.816617 val: 0.757974 test: 0.767867
max validation accuracy : 0.775797 max acc epoch : 1 test accuracy : 0.754643
Counter({1: 5790, 0: 4872})

Epoch :  12 loss training:  72.9577888995409 Time :  171
accuracy train: 0.820093 val: 0.757974 test: 0.763365
max validation accuracy : 0.775797 max acc epoch : 1 test accuracy : 0.754643
Counter({1: 5827, 0: 4835})

========================================================================================================================================================================================================
best acc epoch :  1
validation accuracy :  0.775797373358349
test accuracy :  0.7546426561620709
last test_accuracy :  0.7633652222847496
second best val :  0.7729831144465291
second best test :  0.7546426561620709
max gap 1
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=197, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 6237, 0: 4425})

Epoch :  1 loss training:  97.55564686655998 Time :  185
accuracy train: 0.768785 val: 0.723265 test: 0.758301
max validation accuracy : 0.723265 max acc epoch : 1 test accuracy : 0.758301
Counter({1: 5934, 0: 4728})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  88.30127561092377 Time :  198
accuracy train: 0.786826 val: 0.744841 test: 0.772369
max validation accuracy : 0.744841 max acc epoch : 2 test accuracy : 0.772369
Counter({1: 6188, 0: 4474})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  85.34956386685371 Time :  211
accuracy train: 0.776564 val: 0.731707 test: 0.765335
max validation accuracy : 0.744841 max acc epoch : 2 test accuracy : 0.772369
Counter({0: 5853, 1: 4809})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.38792979717255 Time :  224
accuracy train: 0.792453 val: 0.752345 test: 0.762240
max validation accuracy : 0.752345 max acc epoch : 4 test accuracy : 0.762240
Counter({0: 5710, 1: 4952})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  78.95399647951126 Time :  237
accuracy train: 0.792287 val: 0.737336 test: 0.769274
max validation accuracy : 0.752345 max acc epoch : 4 test accuracy : 0.762240
Counter({1: 6171, 0: 4491})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.66330561041832 Time :  250
accuracy train: 0.793611 val: 0.737336 test: 0.755768
max validation accuracy : 0.752345 max acc epoch : 4 test accuracy : 0.762240
Counter({1: 6458, 0: 4204})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.00654989480972 Time :  266
accuracy train: 0.807845 val: 0.753283 test: 0.774902
max validation accuracy : 0.753283 max acc epoch : 7 test accuracy : 0.774902
Counter({1: 6825, 0: 3837})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  77.11834171414375 Time :  279
accuracy train: 0.793611 val: 0.728893 test: 0.751829
max validation accuracy : 0.753283 max acc epoch : 7 test accuracy : 0.774902
Counter({1: 7157, 0: 3505})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  74.3481378108263 Time :  292
accuracy train: 0.813141 val: 0.741088 test: 0.773495
max validation accuracy : 0.753283 max acc epoch : 7 test accuracy : 0.774902
Counter({1: 6818, 0: 3844})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  74.1379339993 Time :  305
accuracy train: 0.816617 val: 0.750469 test: 0.772088
max validation accuracy : 0.753283 max acc epoch : 7 test accuracy : 0.774902
Counter({0: 6809, 1: 3853})

Epoch :  11 loss training:  74.15603005886078 Time :  319
accuracy train: 0.828037 val: 0.745779 test: 0.777715
max validation accuracy : 0.753283 max acc epoch : 7 test accuracy : 0.774902
Counter({0: 6670, 1: 3992})

Epoch :  12 loss training:  72.42508229613304 Time :  332
accuracy train: 0.831016 val: 0.750469 test: 0.776308
max validation accuracy : 0.753283 max acc epoch : 7 test accuracy : 0.774902
Counter({0: 6649, 1: 4013})

Epoch :  13 loss training:  70.17465464770794 Time :  345
accuracy train: 0.839954 val: 0.750469 test: 0.778559
max validation accuracy : 0.753283 max acc epoch : 7 test accuracy : 0.774902
Counter({1: 6569, 0: 4093})

Epoch :  14 loss training:  67.39078062772751 Time :  361
accuracy train: 0.849388 val: 0.757036 test: 0.776590
max validation accuracy : 0.757036 max acc epoch : 14 test accuracy : 0.776590
Counter({0: 6554, 1: 4108})

Epoch :  15 loss training:  66.1044190376997 Time :  375
accuracy train: 0.852367 val: 0.747655 test: 0.775464
max validation accuracy : 0.757036 max acc epoch : 14 test accuracy : 0.776590
Counter({1: 6583, 0: 4079})

Epoch :  16 loss training:  65.40677487850189 Time :  387
accuracy train: 0.862628 val: 0.746717 test: 0.773776
max validation accuracy : 0.757036 max acc epoch : 14 test accuracy : 0.776590
Counter({0: 6572, 1: 4090})

Epoch :  17 loss training:  63.425852447748184 Time :  401
accuracy train: 0.866600 val: 0.752345 test: 0.778841
max validation accuracy : 0.757036 max acc epoch : 14 test accuracy : 0.776590
Counter({0: 6602, 1: 4060})

Epoch :  18 loss training:  61.26095885038376 Time :  412
accuracy train: 0.880669 val: 0.759850 test: 0.777434
max validation accuracy : 0.759850 max acc epoch : 18 test accuracy : 0.777434
Counter({1: 6534, 0: 4128})

Epoch :  19 loss training:  58.876884177327156 Time :  425
accuracy train: 0.885634 val: 0.754221 test: 0.776308
max validation accuracy : 0.759850 max acc epoch : 18 test accuracy : 0.777434
Counter({0: 6536, 1: 4126})

Epoch :  20 loss training:  56.59589068591595 Time :  438
accuracy train: 0.889441 val: 0.753283 test: 0.776590
max validation accuracy : 0.759850 max acc epoch : 18 test accuracy : 0.777434
Counter({1: 6558, 0: 4104})

Epoch :  21 loss training:  56.263599544763565 Time :  452
accuracy train: 0.895399 val: 0.754221 test: 0.774057
max validation accuracy : 0.759850 max acc epoch : 18 test accuracy : 0.777434
Counter({0: 6519, 1: 4143})

Epoch :  22 loss training:  54.55172514915466 Time :  465
accuracy train: 0.906157 val: 0.756098 test: 0.775183
max validation accuracy : 0.759850 max acc epoch : 18 test accuracy : 0.777434
Counter({1: 6455, 0: 4207})

Epoch :  23 loss training:  51.73712208867073 Time :  478
accuracy train: 0.913936 val: 0.760788 test: 0.776590
max validation accuracy : 0.760788 max acc epoch : 23 test accuracy : 0.776590
Counter({1: 6317, 0: 4345})

Epoch :  24 loss training:  49.8019705042243 Time :  492
accuracy train: 0.922873 val: 0.757974 test: 0.776308
max validation accuracy : 0.760788 max acc epoch : 23 test accuracy : 0.776590
Counter({1: 6261, 0: 4401})

Epoch :  25 loss training:  47.956045500934124 Time :  506
accuracy train: 0.929328 val: 0.759850 test: 0.776308
max validation accuracy : 0.760788 max acc epoch : 23 test accuracy : 0.776590
Counter({0: 6206, 1: 4456})

Epoch :  26 loss training:  45.82696682214737 Time :  520
accuracy train: 0.935286 val: 0.747655 test: 0.775183
max validation accuracy : 0.760788 max acc epoch : 23 test accuracy : 0.776590
Counter({0: 6176, 1: 4486})

Epoch :  27 loss training:  44.426544316112995 Time :  532
accuracy train: 0.940583 val: 0.755159 test: 0.772932
max validation accuracy : 0.760788 max acc epoch : 23 test accuracy : 0.776590
Counter({0: 6216, 1: 4446})

Epoch :  28 loss training:  41.97450887039304 Time :  545
accuracy train: 0.944224 val: 0.750469 test: 0.774339
max validation accuracy : 0.760788 max acc epoch : 23 test accuracy : 0.776590
Counter({1: 6155, 0: 4507})

Epoch :  29 loss training:  42.10865329951048 Time :  557
accuracy train: 0.950513 val: 0.750469 test: 0.774902
max validation accuracy : 0.760788 max acc epoch : 23 test accuracy : 0.776590
Counter({0: 6132, 1: 4530})

Epoch :  30 loss training:  38.81170739978552 Time :  570
accuracy train: 0.950513 val: 0.752345 test: 0.781373
max validation accuracy : 0.760788 max acc epoch : 23 test accuracy : 0.776590
Counter({0: 6250, 1: 4412})

Epoch :  31 loss training:  38.73458851873875 Time :  583
accuracy train: 0.958788 val: 0.761726 test: 0.781373
max validation accuracy : 0.761726 max acc epoch : 31 test accuracy : 0.781373
Counter({1: 6180, 0: 4482})

Epoch :  32 loss training:  37.18400862812996 Time :  601
accuracy train: 0.964416 val: 0.755159 test: 0.779122
max validation accuracy : 0.761726 max acc epoch : 31 test accuracy : 0.781373
Counter({1: 6142, 0: 4520})

Epoch :  33 loss training:  35.81789659708738 Time :  614
accuracy train: 0.969050 val: 0.748593 test: 0.776027
max validation accuracy : 0.761726 max acc epoch : 31 test accuracy : 0.781373
Counter({1: 6125, 0: 4537})

Epoch :  34 loss training:  34.061603009700775 Time :  628
accuracy train: 0.967395 val: 0.749531 test: 0.778278
max validation accuracy : 0.761726 max acc epoch : 31 test accuracy : 0.781373
Counter({0: 6049, 1: 4613})

Epoch :  35 loss training:  33.54846376180649 Time :  641
accuracy train: 0.973188 val: 0.757036 test: 0.778841
max validation accuracy : 0.761726 max acc epoch : 31 test accuracy : 0.781373
Counter({1: 6061, 0: 4601})

Epoch :  36 loss training:  31.168879356235266 Time :  657
accuracy train: 0.975836 val: 0.756098 test: 0.776308
max validation accuracy : 0.761726 max acc epoch : 31 test accuracy : 0.781373
Counter({0: 6040, 1: 4622})

Epoch :  37 loss training:  29.433798506855965 Time :  670
accuracy train: 0.973684 val: 0.752345 test: 0.766179
max validation accuracy : 0.761726 max acc epoch : 31 test accuracy : 0.781373
Counter({0: 6050, 1: 4612})

Epoch :  38 loss training:  29.615818664431572 Time :  683
accuracy train: 0.979974 val: 0.757974 test: 0.777997
max validation accuracy : 0.761726 max acc epoch : 31 test accuracy : 0.781373
Counter({1: 6041, 0: 4621})

Epoch :  39 loss training:  27.683618988841772 Time :  696
accuracy train: 0.981794 val: 0.747655 test: 0.772088
max validation accuracy : 0.761726 max acc epoch : 31 test accuracy : 0.781373
Counter({1: 6027, 0: 4635})

Epoch :  40 loss training:  27.030259117484093 Time :  712
accuracy train: 0.983284 val: 0.747655 test: 0.780248
max validation accuracy : 0.761726 max acc epoch : 31 test accuracy : 0.781373
Counter({1: 6003, 0: 4659})

Epoch :  41 loss training:  26.535225354135036 Time :  726
accuracy train: 0.984939 val: 0.747655 test: 0.776027
max validation accuracy : 0.761726 max acc epoch : 31 test accuracy : 0.781373
Counter({0: 5995, 1: 4667})

Epoch :  42 loss training:  24.53702625259757 Time :  739
accuracy train: 0.986428 val: 0.750469 test: 0.775746
max validation accuracy : 0.761726 max acc epoch : 31 test accuracy : 0.781373
Counter({0: 5963, 1: 4699})

========================================================================================================================================================================================================
best acc epoch :  31
validation accuracy :  0.7617260787992496
test accuracy :  0.7813731007315701
last test_accuracy :  0.7757456387169387
second best val :  0.7607879924953096
second best test :  0.7765897580191333
max gap 8
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=33, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 6187, 0: 4475})

Epoch :  1 loss training:  95.35267129540443 Time :  755
accuracy train: 0.765144 val: 0.751407 test: 0.750141
max validation accuracy : 0.751407 max acc epoch : 1 test accuracy : 0.750141
Counter({0: 5706, 1: 4956})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.2170318365097 Time :  771
accuracy train: 0.783846 val: 0.751407 test: 0.771525
max validation accuracy : 0.751407 max acc epoch : 1 test accuracy : 0.750141
Counter({0: 5345, 1: 5317})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  84.01130548119545 Time :  785
accuracy train: 0.784839 val: 0.745779 test: 0.765335
max validation accuracy : 0.751407 max acc epoch : 1 test accuracy : 0.750141
Counter({0: 5471, 1: 5191})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.85064226388931 Time :  801
accuracy train: 0.795597 val: 0.760788 test: 0.776871
max validation accuracy : 0.760788 max acc epoch : 4 test accuracy : 0.776871
Counter({1: 5708, 0: 4954})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  79.56537242233753 Time :  815
accuracy train: 0.795929 val: 0.754221 test: 0.771244
max validation accuracy : 0.760788 max acc epoch : 4 test accuracy : 0.776871
Counter({0: 5713, 1: 4949})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.08822917938232 Time :  827
accuracy train: 0.807680 val: 0.749531 test: 0.776027
max validation accuracy : 0.760788 max acc epoch : 4 test accuracy : 0.776871
Counter({0: 5725, 1: 4937})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.27564680576324 Time :  840
accuracy train: 0.810659 val: 0.761726 test: 0.776308
max validation accuracy : 0.761726 max acc epoch : 7 test accuracy : 0.776308
Counter({0: 5766, 1: 4896})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.14165216684341 Time :  859
accuracy train: 0.799735 val: 0.750469 test: 0.774057
max validation accuracy : 0.761726 max acc epoch : 7 test accuracy : 0.776308
Counter({1: 5749, 0: 4913})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  75.52466575801373 Time :  872
accuracy train: 0.814631 val: 0.767355 test: 0.774620
max validation accuracy : 0.767355 max acc epoch : 9 test accuracy : 0.774620
Counter({0: 5796, 1: 4866})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.84685599803925 Time :  885
accuracy train: 0.810990 val: 0.755159 test: 0.777153
max validation accuracy : 0.767355 max acc epoch : 9 test accuracy : 0.774620
Counter({0: 5784, 1: 4878})

Epoch :  11 loss training:  74.0720250159502 Time :  898
accuracy train: 0.812314 val: 0.750469 test: 0.770400
max validation accuracy : 0.767355 max acc epoch : 9 test accuracy : 0.774620
Counter({0: 5781, 1: 4881})

Epoch :  12 loss training:  73.69251827895641 Time :  916
accuracy train: 0.826548 val: 0.760788 test: 0.780529
max validation accuracy : 0.767355 max acc epoch : 9 test accuracy : 0.774620
Counter({1: 5821, 0: 4841})

Epoch :  13 loss training:  71.12734012305737 Time :  929
accuracy train: 0.833664 val: 0.760788 test: 0.781092
max validation accuracy : 0.767355 max acc epoch : 9 test accuracy : 0.774620
Counter({0: 5867, 1: 4795})

Epoch :  14 loss training:  68.36580422520638 Time :  942
accuracy train: 0.840781 val: 0.758912 test: 0.780810
max validation accuracy : 0.767355 max acc epoch : 9 test accuracy : 0.774620
Counter({1: 5879, 0: 4783})

Epoch :  15 loss training:  67.5223154425621 Time :  956
accuracy train: 0.846077 val: 0.755159 test: 0.780529
max validation accuracy : 0.767355 max acc epoch : 9 test accuracy : 0.774620
Counter({0: 5936, 1: 4726})

Epoch :  16 loss training:  66.77584864199162 Time :  972
accuracy train: 0.857167 val: 0.764540 test: 0.775464
max validation accuracy : 0.767355 max acc epoch : 9 test accuracy : 0.774620
Counter({1: 5946, 0: 4716})

Epoch :  17 loss training:  63.90339531004429 Time :  986
accuracy train: 0.863456 val: 0.758912 test: 0.780529
max validation accuracy : 0.767355 max acc epoch : 9 test accuracy : 0.774620
Counter({0: 6004, 1: 4658})

Epoch :  18 loss training:  62.917585745453835 Time :  998
accuracy train: 0.876696 val: 0.762664 test: 0.778278
max validation accuracy : 0.767355 max acc epoch : 9 test accuracy : 0.774620
Counter({0: 6000, 1: 4662})

Epoch :  19 loss training:  60.41488014161587 Time :  1012
accuracy train: 0.886627 val: 0.765478 test: 0.782499
max validation accuracy : 0.767355 max acc epoch : 9 test accuracy : 0.774620
Counter({1: 6035, 0: 4627})

Epoch :  20 loss training:  57.09104244410992 Time :  1029
accuracy train: 0.892254 val: 0.760788 test: 0.779122
max validation accuracy : 0.767355 max acc epoch : 9 test accuracy : 0.774620
Counter({1: 6049, 0: 4613})

========================================================================================================================================================================================================
best acc epoch :  9
validation accuracy :  0.7673545966228893
test accuracy :  0.7746201463140123
last test_accuracy :  0.7791221159257175
second best val :  0.7654784240150094
second best test :  0.7746201463140123
max gap 3
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=762, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 6223, 0: 4439})

Epoch :  1 loss training:  96.5149946808815 Time :  1051
accuracy train: 0.774412 val: 0.751407 test: 0.763365
max validation accuracy : 0.751407 max acc epoch : 1 test accuracy : 0.763365
Counter({0: 6062, 1: 4600})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.66584768891335 Time :  1064
accuracy train: 0.790632 val: 0.764540 test: 0.769837
max validation accuracy : 0.764540 max acc epoch : 2 test accuracy : 0.769837
Counter({1: 5902, 0: 4760})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  84.7132770717144 Time :  1078
accuracy train: 0.784012 val: 0.755159 test: 0.762521
max validation accuracy : 0.764540 max acc epoch : 2 test accuracy : 0.769837
Counter({1: 6642, 0: 4020})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.57852646708488 Time :  1091
accuracy train: 0.793446 val: 0.752345 test: 0.764209
max validation accuracy : 0.764540 max acc epoch : 2 test accuracy : 0.769837
Counter({0: 6324, 1: 4338})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.16499862074852 Time :  1104
accuracy train: 0.793115 val: 0.746717 test: 0.765898
max validation accuracy : 0.764540 max acc epoch : 2 test accuracy : 0.769837
Counter({1: 5840, 0: 4822})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.40472450852394 Time :  1118
accuracy train: 0.805362 val: 0.768293 test: 0.764491
max validation accuracy : 0.768293 max acc epoch : 6 test accuracy : 0.764491
Counter({0: 5565, 1: 5097})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.40601354837418 Time :  1136
accuracy train: 0.813141 val: 0.762664 test: 0.773776
max validation accuracy : 0.768293 max acc epoch : 6 test accuracy : 0.764491
Counter({1: 5420, 0: 5242})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  75.61205698549747 Time :  1149
accuracy train: 0.820258 val: 0.765478 test: 0.776308
max validation accuracy : 0.768293 max acc epoch : 6 test accuracy : 0.764491
Counter({1: 5419, 0: 5243})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  75.76988905668259 Time :  1163
accuracy train: 0.819100 val: 0.772045 test: 0.777153
max validation accuracy : 0.772045 max acc epoch : 9 test accuracy : 0.777153
Counter({1: 5424, 0: 5238})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  73.97102373838425 Time :  1176
accuracy train: 0.820424 val: 0.776735 test: 0.776590
max validation accuracy : 0.776735 max acc epoch : 10 test accuracy : 0.776590
Counter({0: 5423, 1: 5239})

Epoch :  11 loss training:  74.57902625203133 Time :  1191
accuracy train: 0.828865 val: 0.772045 test: 0.779685
max validation accuracy : 0.776735 max acc epoch : 10 test accuracy : 0.776590
Counter({1: 5435, 0: 5227})

Epoch :  12 loss training:  72.7057711482048 Time :  1204
accuracy train: 0.836478 val: 0.770169 test: 0.776308
max validation accuracy : 0.776735 max acc epoch : 10 test accuracy : 0.776590
Counter({1: 5397, 0: 5265})

Epoch :  13 loss training:  70.83745548129082 Time :  1218
accuracy train: 0.845746 val: 0.771107 test: 0.777434
max validation accuracy : 0.776735 max acc epoch : 10 test accuracy : 0.776590
Counter({1: 5387, 0: 5275})

Epoch :  14 loss training:  68.96251188218594 Time :  1230
accuracy train: 0.851870 val: 0.777674 test: 0.779122
max validation accuracy : 0.777674 max acc epoch : 14 test accuracy : 0.779122
Counter({0: 5349, 1: 5313})

Epoch :  15 loss training:  67.61603961884975 Time :  1246
accuracy train: 0.854187 val: 0.774859 test: 0.775183
max validation accuracy : 0.777674 max acc epoch : 14 test accuracy : 0.779122
Counter({1: 5389, 0: 5273})

Epoch :  16 loss training:  66.09236267209053 Time :  1259
accuracy train: 0.865111 val: 0.780488 test: 0.775464
max validation accuracy : 0.780488 max acc epoch : 16 test accuracy : 0.775464
Counter({0: 5365, 1: 5297})

Epoch :  17 loss training:  63.91559851169586 Time :  1269
accuracy train: 0.871400 val: 0.781426 test: 0.775464
max validation accuracy : 0.781426 max acc epoch : 17 test accuracy : 0.775464
Counter({0: 5379, 1: 5283})

Epoch :  18 loss training:  62.166383653879166 Time :  1286
accuracy train: 0.880172 val: 0.778612 test: 0.778278
max validation accuracy : 0.781426 max acc epoch : 17 test accuracy : 0.775464
Counter({0: 5388, 1: 5274})

Epoch :  19 loss training:  58.48888571560383 Time :  1299
accuracy train: 0.885799 val: 0.780488 test: 0.774620
max validation accuracy : 0.781426 max acc epoch : 17 test accuracy : 0.775464
Counter({0: 5343, 1: 5319})

Epoch :  20 loss training:  57.06389133632183 Time :  1312
accuracy train: 0.893247 val: 0.782364 test: 0.780810
max validation accuracy : 0.782364 max acc epoch : 20 test accuracy : 0.780810
Counter({1: 5341, 0: 5321})

Epoch :  21 loss training:  55.0521821975708 Time :  1325
accuracy train: 0.902019 val: 0.780488 test: 0.778278
max validation accuracy : 0.782364 max acc epoch : 20 test accuracy : 0.780810
Counter({1: 5346, 0: 5316})

Epoch :  22 loss training:  54.00333086401224 Time :  1340
accuracy train: 0.907315 val: 0.795497 test: 0.778841
max validation accuracy : 0.795497 max acc epoch : 22 test accuracy : 0.778841
Counter({1: 5374, 0: 5288})

Epoch :  23 loss training:  52.54532067477703 Time :  1354
accuracy train: 0.914929 val: 0.789869 test: 0.780529
max validation accuracy : 0.795497 max acc epoch : 22 test accuracy : 0.778841
Counter({1: 5374, 0: 5288})

Epoch :  24 loss training:  51.6311639547348 Time :  1363
accuracy train: 0.922708 val: 0.789869 test: 0.780248
max validation accuracy : 0.795497 max acc epoch : 22 test accuracy : 0.778841
Counter({0: 5365, 1: 5297})

Epoch :  25 loss training:  48.41357984393835 Time :  1378
accuracy train: 0.928500 val: 0.782364 test: 0.783343
max validation accuracy : 0.795497 max acc epoch : 22 test accuracy : 0.778841
Counter({1: 5335, 0: 5327})

Epoch :  26 loss training:  47.72173040360212 Time :  1391
accuracy train: 0.933962 val: 0.786116 test: 0.782499
max validation accuracy : 0.795497 max acc epoch : 22 test accuracy : 0.778841
Counter({1: 5391, 0: 5271})

Epoch :  27 loss training:  45.17252677679062 Time :  1404
accuracy train: 0.941079 val: 0.797373 test: 0.779685
max validation accuracy : 0.797373 max acc epoch : 27 test accuracy : 0.779685
Counter({0: 5350, 1: 5312})

Epoch :  28 loss training:  44.48484119027853 Time :  1416
accuracy train: 0.944886 val: 0.794559 test: 0.779122
max validation accuracy : 0.797373 max acc epoch : 27 test accuracy : 0.779685
Counter({1: 5335, 0: 5327})

Epoch :  29 loss training:  41.283838614821434 Time :  1434
accuracy train: 0.954651 val: 0.797373 test: 0.780529
max validation accuracy : 0.797373 max acc epoch : 27 test accuracy : 0.779685
Counter({1: 5417, 0: 5245})

Epoch :  30 loss training:  41.15293610095978 Time :  1447
accuracy train: 0.954485 val: 0.796435 test: 0.778559
max validation accuracy : 0.797373 max acc epoch : 27 test accuracy : 0.779685
Counter({0: 5406, 1: 5256})

Epoch :  31 loss training:  38.54795514792204 Time :  1460
accuracy train: 0.958292 val: 0.797373 test: 0.774057
max validation accuracy : 0.797373 max acc epoch : 27 test accuracy : 0.779685
Counter({0: 5486, 1: 5176})

Epoch :  32 loss training:  37.03386793285608 Time :  1474
accuracy train: 0.962430 val: 0.792683 test: 0.772932
max validation accuracy : 0.797373 max acc epoch : 27 test accuracy : 0.779685
Counter({0: 5520, 1: 5142})

Epoch :  33 loss training:  35.72365088760853 Time :  1491
accuracy train: 0.964085 val: 0.794559 test: 0.776308
max validation accuracy : 0.797373 max acc epoch : 27 test accuracy : 0.779685
Counter({1: 5499, 0: 5163})

Epoch :  34 loss training:  33.030806701630354 Time :  1504
accuracy train: 0.965078 val: 0.795497 test: 0.774057
max validation accuracy : 0.797373 max acc epoch : 27 test accuracy : 0.779685
Counter({0: 5494, 1: 5168})

Epoch :  35 loss training:  31.671300280839205 Time :  1518
accuracy train: 0.969878 val: 0.786116 test: 0.773776
max validation accuracy : 0.797373 max acc epoch : 27 test accuracy : 0.779685
Counter({0: 5494, 1: 5168})

Epoch :  36 loss training:  31.22836034372449 Time :  1531
accuracy train: 0.975836 val: 0.791745 test: 0.774057
max validation accuracy : 0.797373 max acc epoch : 27 test accuracy : 0.779685
Counter({0: 5504, 1: 5158})

Epoch :  37 loss training:  29.371819764375687 Time :  1547
accuracy train: 0.977822 val: 0.787054 test: 0.768149
max validation accuracy : 0.797373 max acc epoch : 27 test accuracy : 0.779685
Counter({0: 5537, 1: 5125})

Epoch :  38 loss training:  28.944060616195202 Time :  1560
accuracy train: 0.977325 val: 0.790807 test: 0.772932
max validation accuracy : 0.797373 max acc epoch : 27 test accuracy : 0.779685
Counter({0: 5564, 1: 5098})

========================================================================================================================================================================================================
best acc epoch :  27
validation accuracy :  0.797373358348968
test accuracy :  0.7796848621271807
last test_accuracy :  0.772931907709623
second best val :  0.7964352720450282
second best test :  0.7796848621271807
max gap 5
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  1 	 val_accuracy : 0.77580 	 test_accuracy : 0.75464 	 last test_accuracy : 0.76337 	 second best val : 0.77298 	 second best test : 0.75464
k :  1 	 best_acc epoch :  31 	 val_accuracy : 0.76173 	 test_accuracy : 0.78137 	 last test_accuracy : 0.77575 	 second best val : 0.76079 	 second best test : 0.77659
k :  2 	 best_acc epoch :  9 	 val_accuracy : 0.76735 	 test_accuracy : 0.77462 	 last test_accuracy : 0.77912 	 second best val : 0.76548 	 second best test : 0.77462
k :  3 	 best_acc epoch :  27 	 val_accuracy : 0.79737 	 test_accuracy : 0.77968 	 last test_accuracy : 0.77293 	 second best val : 0.79644 	 second best test : 0.77968

avg :  	 val_accuracy : 0.77556 	 test_accuracy : 0.77258 	 last_accuracy : 0.77279 	 second best val : 0.77392 	 second best test : 0.77138

std :  	 val_accuracy : 0.01355 	 test_accuracy : 0.01065 	 last_accuracy : 0.00587 	 second best val : 0.01371 	 second best test : 0.00983
