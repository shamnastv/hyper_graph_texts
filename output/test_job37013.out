

date and time :  Thu Jun 10 10:08:14 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.2, early_stop=30, epochs=400, filename='', hidden_dim=300, lda=False, lr=0.005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=350, weight_decay=0)
device :  cuda:0
min_len_of_sentence : 0
max_len_of_sentence : 40
min_num_of_sentence : 1
max_num_of_sentence : 12
average_len_of_sentence: 8.81713073818157
average_num_of_sentence: 1.3709435377977865
Total_num_of_sentence : 14617
Counter({'1': 5331, '0': 5331})
Total_number_of_words: 16658
Total_number_of_categories: 2
vocab size : 16658
got embeddings of : 15770

Epoch :  1 loss training:  99.77667883038521 Time :  55
accuracy train: 0.727884 val: 0.714085 test: 0.710186
max validation accuracy : 0.714085 max acc epoch : 1 test accuracy : 0.710186
Epoch-1 lr: 0.005

Epoch :  2 loss training:  95.61948825418949 Time :  65
accuracy train: 0.685527 val: 0.667606 test: 0.666010
max validation accuracy : 0.714085 max acc epoch : 1 test accuracy : 0.710186
Epoch-2 lr: 0.005

Epoch :  3 loss training:  79.75333747267723 Time :  77
accuracy train: 0.688809 val: 0.669014 test: 0.658694
max validation accuracy : 0.714085 max acc epoch : 1 test accuracy : 0.710186
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  67.09082300961018 Time :  88
accuracy train: 0.871679 val: 0.745070 test: 0.767304
max validation accuracy : 0.745070 max acc epoch : 4 test accuracy : 0.767304
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  58.17303279042244 Time :  101
accuracy train: 0.869022 val: 0.754930 test: 0.758019
max validation accuracy : 0.754930 max acc epoch : 5 test accuracy : 0.758019
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  54.43866667151451 Time :  110
accuracy train: 0.931697 val: 0.781690 test: 0.779122
max validation accuracy : 0.781690 max acc epoch : 6 test accuracy : 0.779122
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  43.45123120397329 Time :  121
accuracy train: 0.954361 val: 0.773239 test: 0.775464
max validation accuracy : 0.781690 max acc epoch : 6 test accuracy : 0.779122
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  37.023854941129684 Time :  130
accuracy train: 0.972804 val: 0.773239 test: 0.773776
max validation accuracy : 0.781690 max acc epoch : 6 test accuracy : 0.779122
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  32.86064849048853 Time :  141
accuracy train: 0.983120 val: 0.780282 test: 0.773213
max validation accuracy : 0.781690 max acc epoch : 6 test accuracy : 0.779122
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  26.568385288119316 Time :  150
accuracy train: 0.990466 val: 0.783099 test: 0.770400
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  23.7330750413239 Time :  161
accuracy train: 0.985777 val: 0.770423 test: 0.768430
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  21.24607076868415 Time :  171
accuracy train: 0.993279 val: 0.774648 test: 0.772932
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  19.305671643465757 Time :  181
accuracy train: 0.996249 val: 0.781690 test: 0.770681
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  17.864801824092865 Time :  191
accuracy train: 0.997030 val: 0.780282 test: 0.771525
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  16.843246560543776 Time :  202
accuracy train: 0.997656 val: 0.780282 test: 0.772088
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

Epoch :  16 loss training:  16.33736572228372 Time :  213
accuracy train: 0.997968 val: 0.774648 test: 0.772369
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

Epoch :  17 loss training:  13.06530337780714 Time :  224
accuracy train: 0.999375 val: 0.774648 test: 0.771244
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

Epoch :  18 loss training:  10.149087032303214 Time :  231
accuracy train: 0.999687 val: 0.773239 test: 0.770681
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

Epoch :  19 loss training:  7.92189328931272 Time :  238
accuracy train: 0.999844 val: 0.780282 test: 0.772932
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

Epoch :  20 loss training:  6.359892433509231 Time :  249
accuracy train: 0.999687 val: 0.771831 test: 0.769555
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

Epoch :  21 loss training:  5.291966869495809 Time :  259
accuracy train: 0.999844 val: 0.774648 test: 0.769555
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

Epoch :  22 loss training:  4.56095045665279 Time :  269
accuracy train: 0.999844 val: 0.777465 test: 0.768430
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

Epoch :  23 loss training:  3.692752396222204 Time :  279
accuracy train: 0.999844 val: 0.770423 test: 0.769274
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

Epoch :  24 loss training:  3.2165707361418754 Time :  289
accuracy train: 1.000000 val: 0.769014 test: 0.769837
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

Epoch :  25 loss training:  2.8341719557065517 Time :  301
accuracy train: 0.999844 val: 0.766197 test: 0.770962
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

Epoch :  26 loss training:  2.279809633269906 Time :  310
accuracy train: 0.999844 val: 0.769014 test: 0.768430
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

Epoch :  27 loss training:  2.080497199553065 Time :  321
accuracy train: 1.000000 val: 0.770423 test: 0.769555
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

Epoch :  28 loss training:  1.894162385025993 Time :  333
accuracy train: 0.999687 val: 0.763380 test: 0.767023
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

Epoch :  29 loss training:  1.8018442786997184 Time :  344
accuracy train: 0.999844 val: 0.766197 test: 0.766742
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

Epoch :  30 loss training:  1.3273361282190308 Time :  354
accuracy train: 1.000000 val: 0.759155 test: 0.768430
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

Epoch :  31 loss training:  1.4363494537537917 Time :  365
accuracy train: 0.999844 val: 0.753521 test: 0.769555
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

Epoch :  32 loss training:  1.0411776977125555 Time :  374
accuracy train: 0.999844 val: 0.754930 test: 0.765335
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

Epoch :  33 loss training:  0.9204397150315344 Time :  385
accuracy train: 0.999844 val: 0.763380 test: 0.763647
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

Epoch :  34 loss training:  0.8586946910945699 Time :  395
accuracy train: 0.999687 val: 0.769014 test: 0.766179
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

Epoch :  35 loss training:  0.8966043684631586 Time :  406
accuracy train: 1.000000 val: 0.763380 test: 0.764491
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

Epoch :  36 loss training:  0.6708016045449767 Time :  416
accuracy train: 1.000000 val: 0.761972 test: 0.761396
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

Epoch :  37 loss training:  0.7961073915939778 Time :  426
accuracy train: 0.999531 val: 0.757746 test: 0.762802
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

Epoch :  38 loss training:  0.6585689878847916 Time :  436
accuracy train: 0.999844 val: 0.759155 test: 0.762802
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

Epoch :  39 loss training:  0.48886644779122435 Time :  451
accuracy train: 0.999844 val: 0.761972 test: 0.763365
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

Epoch :  40 loss training:  0.4722461679484695 Time :  464
accuracy train: 0.999844 val: 0.761972 test: 0.763647
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

Epoch :  41 loss training:  0.6532070671673864 Time :  473
accuracy train: 0.999844 val: 0.767606 test: 0.767304
max validation accuracy : 0.783099 max acc epoch : 10 test accuracy : 0.770400

========================================================================================================================================================================================================
max acc epoch :  10
max validation accuracy :  0.7830985915492957
test accuracy :  0.7703995498030388
last test_accuracy :  0.7673044456949916
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.2, early_stop=30, epochs=400, filename='', hidden_dim=300, lda=False, lr=0.005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=350, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  102.09791046380997 Time :  485
accuracy train: 0.648484 val: 0.628169 test: 0.623804
max validation accuracy : 0.628169 max acc epoch : 1 test accuracy : 0.623804
Epoch-1 lr: 0.005

Epoch :  2 loss training:  95.07891188561916 Time :  494
accuracy train: 0.602688 val: 0.605634 test: 0.599043
max validation accuracy : 0.628169 max acc epoch : 1 test accuracy : 0.623804
Epoch-2 lr: 0.005

Epoch :  3 loss training:  91.6901171952486 Time :  505
accuracy train: 0.789934 val: 0.743662 test: 0.754080
max validation accuracy : 0.743662 max acc epoch : 3 test accuracy : 0.754080
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  77.94837874174118 Time :  514
accuracy train: 0.828071 val: 0.764789 test: 0.778278
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.778278
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  75.99704833328724 Time :  523
accuracy train: 0.760081 val: 0.733803 test: 0.720597
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.778278
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  75.42036187648773 Time :  533
accuracy train: 0.822132 val: 0.747887 test: 0.757456
max validation accuracy : 0.764789 max acc epoch : 4 test accuracy : 0.778278
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  67.67067065834999 Time :  544
accuracy train: 0.854955 val: 0.780282 test: 0.776871
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  65.89624997973442 Time :  553
accuracy train: 0.854173 val: 0.759155 test: 0.770400
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  64.20386625826359 Time :  563
accuracy train: 0.869022 val: 0.746479 test: 0.773776
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  60.042092844843864 Time :  572
accuracy train: 0.879806 val: 0.774648 test: 0.772369
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  58.09438432753086 Time :  580
accuracy train: 0.860894 val: 0.754930 test: 0.756331
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  56.5931735932827 Time :  594
accuracy train: 0.887621 val: 0.761972 test: 0.769274
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  54.650635704398155 Time :  604
accuracy train: 0.896999 val: 0.764789 test: 0.772369
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  53.666354954242706 Time :  615
accuracy train: 0.899500 val: 0.766197 test: 0.770681
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  54.20878550410271 Time :  623
accuracy train: 0.904658 val: 0.769014 test: 0.769555
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871

Epoch :  16 loss training:  53.63658703863621 Time :  636
accuracy train: 0.921225 val: 0.769014 test: 0.769837
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871

Epoch :  17 loss training:  45.56127764284611 Time :  646
accuracy train: 0.941388 val: 0.756338 test: 0.771806
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871

Epoch :  18 loss training:  40.47485267370939 Time :  657
accuracy train: 0.955767 val: 0.764789 test: 0.768993
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871

Epoch :  19 loss training:  34.34096724539995 Time :  666
accuracy train: 0.969209 val: 0.746479 test: 0.774339
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871

Epoch :  20 loss training:  29.605122685432434 Time :  675
accuracy train: 0.977962 val: 0.757746 test: 0.767023
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871

Epoch :  21 loss training:  25.07254657521844 Time :  686
accuracy train: 0.985933 val: 0.759155 test: 0.764772
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871

Epoch :  22 loss training:  20.6933153886348 Time :  696
accuracy train: 0.990466 val: 0.769014 test: 0.763365
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871

Epoch :  23 loss training:  17.738510109484196 Time :  707
accuracy train: 0.991716 val: 0.753521 test: 0.760833
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871

Epoch :  24 loss training:  15.703255185857415 Time :  720
accuracy train: 0.994061 val: 0.759155 test: 0.759426
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871

Epoch :  25 loss training:  13.302146645262837 Time :  731
accuracy train: 0.995780 val: 0.763380 test: 0.761958
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871

Epoch :  26 loss training:  10.658284320496023 Time :  741
accuracy train: 0.996249 val: 0.750704 test: 0.764209
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871

Epoch :  27 loss training:  8.589003708213568 Time :  752
accuracy train: 0.998437 val: 0.763380 test: 0.757175
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871

Epoch :  28 loss training:  7.869690418243408 Time :  761
accuracy train: 0.999062 val: 0.763380 test: 0.753799
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871

Epoch :  29 loss training:  7.163056266494095 Time :  772
accuracy train: 0.999687 val: 0.750704 test: 0.752110
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871

Epoch :  30 loss training:  5.629571320489049 Time :  782
accuracy train: 0.999531 val: 0.747887 test: 0.753517
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871

Epoch :  31 loss training:  4.833843196043745 Time :  792
accuracy train: 0.999844 val: 0.747887 test: 0.753799
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871

Epoch :  32 loss training:  4.196268759900704 Time :  802
accuracy train: 0.999687 val: 0.749296 test: 0.748734
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871

Epoch :  33 loss training:  4.0387996167410165 Time :  813
accuracy train: 0.999844 val: 0.743662 test: 0.748452
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871

Epoch :  34 loss training:  3.305846874602139 Time :  821
accuracy train: 1.000000 val: 0.749296 test: 0.748171
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871

Epoch :  35 loss training:  3.026048353756778 Time :  833
accuracy train: 1.000000 val: 0.745070 test: 0.750141
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871

Epoch :  36 loss training:  2.39097563480027 Time :  846
accuracy train: 1.000000 val: 0.752113 test: 0.751829
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871

Epoch :  37 loss training:  2.325022239703685 Time :  856
accuracy train: 0.999844 val: 0.752113 test: 0.741137
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871

Epoch :  38 loss training:  2.132083451608196 Time :  867
accuracy train: 1.000000 val: 0.739437 test: 0.753236
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.776871

========================================================================================================================================================================================================
max acc epoch :  7
max validation accuracy :  0.780281690140845
test accuracy :  0.7768711311198649
last test_accuracy :  0.7532357906584131
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.2, early_stop=30, epochs=400, filename='', hidden_dim=300, lda=False, lr=0.005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=350, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  104.57215505838394 Time :  877
accuracy train: 0.749609 val: 0.718310 test: 0.738604
max validation accuracy : 0.718310 max acc epoch : 1 test accuracy : 0.738604
Epoch-1 lr: 0.005

Epoch :  2 loss training:  88.73838466405869 Time :  889
accuracy train: 0.755236 val: 0.718310 test: 0.720034
max validation accuracy : 0.718310 max acc epoch : 1 test accuracy : 0.738604
Epoch-2 lr: 0.005

Epoch :  3 loss training:  82.87577351927757 Time :  896
accuracy train: 0.773836 val: 0.718310 test: 0.724254
max validation accuracy : 0.718310 max acc epoch : 1 test accuracy : 0.738604
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  75.18267242610455 Time :  902
accuracy train: 0.871053 val: 0.774648 test: 0.779403
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  62.167985275387764 Time :  913
accuracy train: 0.879494 val: 0.759155 test: 0.765616
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  59.22055169939995 Time :  922
accuracy train: 0.910284 val: 0.754930 test: 0.771525
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  46.25866635143757 Time :  932
accuracy train: 0.940763 val: 0.752113 test: 0.774339
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  41.6464608758688 Time :  941
accuracy train: 0.960144 val: 0.764789 test: 0.778278
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  37.59824734181166 Time :  952
accuracy train: 0.969053 val: 0.761972 test: 0.775464
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  30.81509155035019 Time :  965
accuracy train: 0.980619 val: 0.754930 test: 0.778559
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  28.399730321019888 Time :  976
accuracy train: 0.981400 val: 0.747887 test: 0.770118
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  26.23958294093609 Time :  985
accuracy train: 0.985464 val: 0.746479 test: 0.775746
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  23.333679381757975 Time :  996
accuracy train: 0.992029 val: 0.747887 test: 0.777997
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  22.003397833555937 Time :  1005
accuracy train: 0.992810 val: 0.749296 test: 0.777997
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  21.21877497062087 Time :  1015
accuracy train: 0.994530 val: 0.750704 test: 0.774620
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403

Epoch :  16 loss training:  21.214360997080803 Time :  1025
accuracy train: 0.997030 val: 0.759155 test: 0.781936
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403

Epoch :  17 loss training:  16.776207868009806 Time :  1036
accuracy train: 0.997656 val: 0.752113 test: 0.778559
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403

Epoch :  18 loss training:  13.17826496809721 Time :  1045
accuracy train: 0.998124 val: 0.743662 test: 0.783905
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403

Epoch :  19 loss training:  10.46821765601635 Time :  1056
accuracy train: 0.998437 val: 0.747887 test: 0.777153
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403

Epoch :  20 loss training:  8.93744920566678 Time :  1065
accuracy train: 0.998906 val: 0.747887 test: 0.777153
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403

Epoch :  21 loss training:  7.507490091025829 Time :  1076
accuracy train: 0.999062 val: 0.740845 test: 0.782499
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403

Epoch :  22 loss training:  6.383959308732301 Time :  1088
accuracy train: 0.999375 val: 0.743662 test: 0.782217
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403

Epoch :  23 loss training:  5.562231429852545 Time :  1098
accuracy train: 0.997968 val: 0.740845 test: 0.776308
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403

Epoch :  24 loss training:  5.223199144937098 Time :  1104
accuracy train: 0.998593 val: 0.740845 test: 0.777434
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403

Epoch :  25 loss training:  4.136658162344247 Time :  1113
accuracy train: 0.999062 val: 0.746479 test: 0.777715
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403

Epoch :  26 loss training:  3.1067618196830153 Time :  1122
accuracy train: 0.999219 val: 0.743662 test: 0.779966
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403

Epoch :  27 loss training:  2.8635795330628753 Time :  1133
accuracy train: 0.999531 val: 0.745070 test: 0.777434
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403

Epoch :  28 loss training:  2.854788427706808 Time :  1141
accuracy train: 0.999219 val: 0.743662 test: 0.777153
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403

Epoch :  29 loss training:  2.6809341079788283 Time :  1151
accuracy train: 0.999844 val: 0.747887 test: 0.777997
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403

Epoch :  30 loss training:  2.1330163972452283 Time :  1159
accuracy train: 0.999687 val: 0.752113 test: 0.772651
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403

Epoch :  31 loss training:  1.7169552934356034 Time :  1170
accuracy train: 0.999844 val: 0.738028 test: 0.776590
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403

Epoch :  32 loss training:  1.536016843863763 Time :  1178
accuracy train: 0.999687 val: 0.745070 test: 0.777715
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403

Epoch :  33 loss training:  1.7268457900499925 Time :  1189
accuracy train: 0.999375 val: 0.750704 test: 0.777153
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403

Epoch :  34 loss training:  1.4160121808527038 Time :  1200
accuracy train: 0.998437 val: 0.743662 test: 0.777434
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403

Epoch :  35 loss training:  1.6707318542758003 Time :  1213
accuracy train: 0.998750 val: 0.746479 test: 0.772088
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.779403

========================================================================================================================================================================================================
max acc epoch :  4
max validation accuracy :  0.7746478873239436
test accuracy :  0.7794034890264491
last test_accuracy :  0.7720877884074282
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.2, early_stop=30, epochs=400, filename='', hidden_dim=300, lda=False, lr=0.005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=350, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  108.2620045542717 Time :  1223
accuracy train: 0.774148 val: 0.753521 test: 0.764772
max validation accuracy : 0.753521 max acc epoch : 1 test accuracy : 0.764772
Epoch-1 lr: 0.005

Epoch :  2 loss training:  95.07285004854202 Time :  1234
accuracy train: 0.622226 val: 0.616901 test: 0.606359
max validation accuracy : 0.753521 max acc epoch : 1 test accuracy : 0.764772
Epoch-2 lr: 0.005

Epoch :  3 loss training:  81.95269528031349 Time :  1242
accuracy train: 0.778368 val: 0.733803 test: 0.749297
max validation accuracy : 0.753521 max acc epoch : 1 test accuracy : 0.764772
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  75.92638562619686 Time :  1253
accuracy train: 0.813692 val: 0.749296 test: 0.776590
max validation accuracy : 0.753521 max acc epoch : 1 test accuracy : 0.764772
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  76.45445097982883 Time :  1262
accuracy train: 0.742732 val: 0.681690 test: 0.724254
max validation accuracy : 0.753521 max acc epoch : 1 test accuracy : 0.764772
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  72.6992825716734 Time :  1274
accuracy train: 0.804626 val: 0.740845 test: 0.761396
max validation accuracy : 0.753521 max acc epoch : 1 test accuracy : 0.764772
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  64.70046998560429 Time :  1283
accuracy train: 0.786808 val: 0.725352 test: 0.745357
max validation accuracy : 0.753521 max acc epoch : 1 test accuracy : 0.764772
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  60.490598157048225 Time :  1293
accuracy train: 0.770710 val: 0.698592 test: 0.734102
max validation accuracy : 0.753521 max acc epoch : 1 test accuracy : 0.764772
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  61.899014845490456 Time :  1299
accuracy train: 0.891216 val: 0.746479 test: 0.776871
max validation accuracy : 0.753521 max acc epoch : 1 test accuracy : 0.764772
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  55.57619009912014 Time :  1310
accuracy train: 0.871522 val: 0.742254 test: 0.764772
max validation accuracy : 0.753521 max acc epoch : 1 test accuracy : 0.764772
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  52.65692265331745 Time :  1317
accuracy train: 0.889966 val: 0.761972 test: 0.774057
max validation accuracy : 0.761972 max acc epoch : 11 test accuracy : 0.774057
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  51.11099849641323 Time :  1329
accuracy train: 0.914505 val: 0.747887 test: 0.772932
max validation accuracy : 0.761972 max acc epoch : 11 test accuracy : 0.774057
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  48.12376384437084 Time :  1344
accuracy train: 0.912473 val: 0.747887 test: 0.770681
max validation accuracy : 0.761972 max acc epoch : 11 test accuracy : 0.774057
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  45.91588839888573 Time :  1352
accuracy train: 0.923882 val: 0.747887 test: 0.775746
max validation accuracy : 0.761972 max acc epoch : 11 test accuracy : 0.774057
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  45.12104319036007 Time :  1363
accuracy train: 0.922476 val: 0.753521 test: 0.771525
max validation accuracy : 0.761972 max acc epoch : 11 test accuracy : 0.774057

Epoch :  16 loss training:  44.64446500688791 Time :  1372
accuracy train: 0.932635 val: 0.760563 test: 0.773213
max validation accuracy : 0.761972 max acc epoch : 11 test accuracy : 0.774057

Epoch :  17 loss training:  38.243018209934235 Time :  1383
accuracy train: 0.952798 val: 0.767606 test: 0.779122
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  18 loss training:  32.99472449719906 Time :  1392
accuracy train: 0.967490 val: 0.754930 test: 0.777997
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  19 loss training:  27.738768942654133 Time :  1403
accuracy train: 0.972804 val: 0.750704 test: 0.782499
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  20 loss training:  23.16417334601283 Time :  1412
accuracy train: 0.982495 val: 0.756338 test: 0.776027
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  21 loss training:  20.690260779112577 Time :  1423
accuracy train: 0.986246 val: 0.764789 test: 0.770681
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  22 loss training:  16.88267790712416 Time :  1431
accuracy train: 0.988903 val: 0.757746 test: 0.772369
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  23 loss training:  15.20657000131905 Time :  1442
accuracy train: 0.992185 val: 0.757746 test: 0.768711
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  24 loss training:  12.794845217838883 Time :  1453
accuracy train: 0.994373 val: 0.757746 test: 0.772088
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  25 loss training:  11.273264599964023 Time :  1467
accuracy train: 0.993748 val: 0.760563 test: 0.768993
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  26 loss training:  9.015755391679704 Time :  1476
accuracy train: 0.996093 val: 0.759155 test: 0.770118
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  27 loss training:  7.811056571081281 Time :  1487
accuracy train: 0.997812 val: 0.759155 test: 0.768993
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  28 loss training:  6.907954717986286 Time :  1495
accuracy train: 0.998281 val: 0.759155 test: 0.758019
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  29 loss training:  6.982730966061354 Time :  1506
accuracy train: 0.995311 val: 0.759155 test: 0.762802
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  30 loss training:  5.372881130781025 Time :  1512
accuracy train: 0.998750 val: 0.757746 test: 0.755487
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  31 loss training:  5.061285518109798 Time :  1521
accuracy train: 0.999062 val: 0.752113 test: 0.763084
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  32 loss training:  4.021909007802606 Time :  1530
accuracy train: 0.998750 val: 0.736620 test: 0.759707
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  33 loss training:  3.913802630500868 Time :  1540
accuracy train: 0.995780 val: 0.742254 test: 0.759989
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  34 loss training:  3.1480390020878986 Time :  1547
accuracy train: 0.998593 val: 0.754930 test: 0.762802
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  35 loss training:  2.7861422633286566 Time :  1554
accuracy train: 0.998124 val: 0.759155 test: 0.760551
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  36 loss training:  2.700676584849134 Time :  1564
accuracy train: 0.999219 val: 0.752113 test: 0.765616
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  37 loss training:  2.241781331365928 Time :  1575
accuracy train: 0.999062 val: 0.738028 test: 0.755487
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  38 loss training:  2.3237905958667397 Time :  1590
accuracy train: 0.999687 val: 0.749296 test: 0.757738
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  39 loss training:  1.7340584073681384 Time :  1599
accuracy train: 0.997499 val: 0.754930 test: 0.756612
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  40 loss training:  1.643887365120463 Time :  1609
accuracy train: 0.996718 val: 0.745070 test: 0.759426
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  41 loss training:  1.5667683389037848 Time :  1618
accuracy train: 0.999687 val: 0.746479 test: 0.758582
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  42 loss training:  1.7048784119833726 Time :  1629
accuracy train: 0.999687 val: 0.750704 test: 0.755768
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  43 loss training:  1.46744082972873 Time :  1638
accuracy train: 0.999844 val: 0.747887 test: 0.750985
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  44 loss training:  1.0921025292482227 Time :  1650
accuracy train: 0.999687 val: 0.752113 test: 0.754924
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  45 loss training:  1.0657057132339105 Time :  1659
accuracy train: 0.998750 val: 0.749296 test: 0.755487
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  46 loss training:  1.0631066194036976 Time :  1669
accuracy train: 0.996718 val: 0.753521 test: 0.752954
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  47 loss training:  0.843080343445763 Time :  1676
accuracy train: 0.999844 val: 0.752113 test: 0.753517
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

Epoch :  48 loss training:  1.091528149874648 Time :  1686
accuracy train: 1.000000 val: 0.753521 test: 0.752392
max validation accuracy : 0.767606 max acc epoch : 17 test accuracy : 0.779122

========================================================================================================================================================================================================
max acc epoch :  17
max validation accuracy :  0.7676056338028169
test accuracy :  0.7791221159257175
last test_accuracy :  0.7523916713562183
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.2, early_stop=30, epochs=400, filename='', hidden_dim=300, lda=False, lr=0.005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=350, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  102.24926641583443 Time :  1699
accuracy train: 0.767896 val: 0.740845 test: 0.747046
max validation accuracy : 0.740845 max acc epoch : 1 test accuracy : 0.747046
Epoch-1 lr: 0.005

Epoch :  2 loss training:  84.79202722012997 Time :  1714
accuracy train: 0.756486 val: 0.728169 test: 0.721722
max validation accuracy : 0.740845 max acc epoch : 1 test accuracy : 0.747046
Epoch-2 lr: 0.005

Epoch :  3 loss training:  78.93409216403961 Time :  1723
accuracy train: 0.792591 val: 0.728169 test: 0.737760
max validation accuracy : 0.740845 max acc epoch : 1 test accuracy : 0.747046
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  64.92809693515301 Time :  1734
accuracy train: 0.887934 val: 0.780282 test: 0.773495
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  56.80837692320347 Time :  1741
accuracy train: 0.848390 val: 0.722535 test: 0.740855
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  59.35955488681793 Time :  1752
accuracy train: 0.924977 val: 0.756338 test: 0.772088
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  42.64467277377844 Time :  1760
accuracy train: 0.957174 val: 0.778873 test: 0.776027
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  36.27784901857376 Time :  1770
accuracy train: 0.963426 val: 0.767606 test: 0.767023
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  32.189669236540794 Time :  1779
accuracy train: 0.971554 val: 0.773239 test: 0.760270
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  25.582969460636377 Time :  1789
accuracy train: 0.967646 val: 0.754930 test: 0.764209
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  23.96992864459753 Time :  1797
accuracy train: 0.964833 val: 0.761972 test: 0.753799
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  21.004338208585978 Time :  1809
accuracy train: 0.970460 val: 0.750704 test: 0.759145
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  19.382608849555254 Time :  1815
accuracy train: 0.956705 val: 0.759155 test: 0.746201
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  18.035373721271753 Time :  1826
accuracy train: 0.968271 val: 0.753521 test: 0.749015
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  16.592069070786238 Time :  1840
accuracy train: 0.985152 val: 0.770423 test: 0.755205
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495

Epoch :  16 loss training:  16.45494480058551 Time :  1851
accuracy train: 0.984214 val: 0.763380 test: 0.761396
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495

Epoch :  17 loss training:  12.692534817382693 Time :  1861
accuracy train: 0.984683 val: 0.759155 test: 0.762521
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495

Epoch :  18 loss training:  9.666033493354917 Time :  1872
accuracy train: 0.991560 val: 0.752113 test: 0.767586
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495

Epoch :  19 loss training:  7.474643505178392 Time :  1881
accuracy train: 0.993435 val: 0.760563 test: 0.765053
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495

Epoch :  20 loss training:  6.480433512479067 Time :  1892
accuracy train: 0.995936 val: 0.756338 test: 0.767586
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495

Epoch :  21 loss training:  5.380640788003802 Time :  1901
accuracy train: 0.984526 val: 0.754930 test: 0.756894
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495

Epoch :  22 loss training:  4.607032822910696 Time :  1911
accuracy train: 0.980775 val: 0.763380 test: 0.762802
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495

Epoch :  23 loss training:  3.838022275362164 Time :  1920
accuracy train: 0.982338 val: 0.747887 test: 0.761114
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495

Epoch :  24 loss training:  3.3387820285279304 Time :  1930
accuracy train: 0.979837 val: 0.763380 test: 0.755768
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495

Epoch :  25 loss training:  3.104362037964165 Time :  1937
accuracy train: 0.997968 val: 0.754930 test: 0.759707
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495

Epoch :  26 loss training:  2.23455169564113 Time :  1948
accuracy train: 0.997030 val: 0.754930 test: 0.759707
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495

Epoch :  27 loss training:  1.9672331565525383 Time :  1961
accuracy train: 0.994686 val: 0.750704 test: 0.759145
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495

Epoch :  28 loss training:  1.6785324297379702 Time :  1971
accuracy train: 0.997968 val: 0.756338 test: 0.758582
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495

Epoch :  29 loss training:  1.7266916104126722 Time :  1978
accuracy train: 0.997343 val: 0.752113 test: 0.758301
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495

Epoch :  30 loss training:  1.4635431274073198 Time :  1987
accuracy train: 0.996561 val: 0.750704 test: 0.764209
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495

Epoch :  31 loss training:  1.5792362820357084 Time :  1996
accuracy train: 0.995624 val: 0.754930 test: 0.764772
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495

Epoch :  32 loss training:  1.1105812513269484 Time :  2007
accuracy train: 0.997968 val: 0.740845 test: 0.761958
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495

Epoch :  33 loss training:  1.0575373886094894 Time :  2016
accuracy train: 0.996249 val: 0.732394 test: 0.764209
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495

Epoch :  34 loss training:  0.9840730667347088 Time :  2027
accuracy train: 0.992185 val: 0.736620 test: 0.759989
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495

Epoch :  35 loss training:  0.9413626232999377 Time :  2036
accuracy train: 0.998124 val: 0.746479 test: 0.768993
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.773495

========================================================================================================================================================================================================
max acc epoch :  4
max validation accuracy :  0.780281690140845
test accuracy :  0.7734946539110861
last test_accuracy :  0.768992684299381
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.2, early_stop=30, epochs=400, filename='', hidden_dim=300, lda=False, lr=0.005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=350, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  100.41725388169289 Time :  2048
accuracy train: 0.705533 val: 0.687324 test: 0.685988
max validation accuracy : 0.687324 max acc epoch : 1 test accuracy : 0.685988
Epoch-1 lr: 0.005

Epoch :  2 loss training:  91.4239988476038 Time :  2056
accuracy train: 0.726946 val: 0.721127 test: 0.699212
max validation accuracy : 0.721127 max acc epoch : 2 test accuracy : 0.699212
Epoch-2 lr: 0.005

Epoch :  3 loss training:  85.76413236558437 Time :  2067
accuracy train: 0.802595 val: 0.763380 test: 0.764772
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.764772
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  75.64791011810303 Time :  2080
accuracy train: 0.838856 val: 0.766197 test: 0.780248
max validation accuracy : 0.766197 max acc epoch : 4 test accuracy : 0.780248
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  70.16689436137676 Time :  2089
accuracy train: 0.852766 val: 0.771831 test: 0.769555
max validation accuracy : 0.771831 max acc epoch : 5 test accuracy : 0.769555
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  67.76986448466778 Time :  2097
accuracy train: 0.848234 val: 0.761972 test: 0.764209
max validation accuracy : 0.771831 max acc epoch : 5 test accuracy : 0.769555
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  58.74834558367729 Time :  2107
accuracy train: 0.902001 val: 0.790141 test: 0.780810
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  54.535446494817734 Time :  2115
accuracy train: 0.915911 val: 0.774648 test: 0.770400
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  51.65900698304176 Time :  2127
accuracy train: 0.929040 val: 0.759155 test: 0.773213
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  44.54006326198578 Time :  2136
accuracy train: 0.933729 val: 0.767606 test: 0.769274
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  41.82773929834366 Time :  2146
accuracy train: 0.942013 val: 0.773239 test: 0.764772
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  39.75446407496929 Time :  2155
accuracy train: 0.923726 val: 0.753521 test: 0.757456
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  36.80249076336622 Time :  2164
accuracy train: 0.962957 val: 0.771831 test: 0.771806
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  34.605351723730564 Time :  2173
accuracy train: 0.969209 val: 0.767606 test: 0.766460
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  34.005566358566284 Time :  2182
accuracy train: 0.972648 val: 0.778873 test: 0.763084
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810

Epoch :  16 loss training:  34.41124979406595 Time :  2198
accuracy train: 0.980619 val: 0.773239 test: 0.762521
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810

Epoch :  17 loss training:  27.07826116681099 Time :  2208
accuracy train: 0.983745 val: 0.764789 test: 0.770400
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810

Epoch :  18 loss training:  22.21232293918729 Time :  2218
accuracy train: 0.991716 val: 0.767606 test: 0.768149
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810

Epoch :  19 loss training:  17.67595673725009 Time :  2229
accuracy train: 0.995467 val: 0.763380 test: 0.765898
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810

Epoch :  20 loss training:  14.952024968340993 Time :  2237
accuracy train: 0.997030 val: 0.766197 test: 0.765616
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810

Epoch :  21 loss training:  11.959543163888156 Time :  2247
accuracy train: 0.997812 val: 0.766197 test: 0.761677
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810

Epoch :  22 loss training:  10.027580332942307 Time :  2256
accuracy train: 0.998906 val: 0.769014 test: 0.761958
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810

Epoch :  23 loss training:  8.896715610753745 Time :  2266
accuracy train: 0.999062 val: 0.763380 test: 0.763084
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810

Epoch :  24 loss training:  7.74183783121407 Time :  2276
accuracy train: 0.999375 val: 0.763380 test: 0.760833
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810

Epoch :  25 loss training:  5.740638803225011 Time :  2286
accuracy train: 0.999531 val: 0.754930 test: 0.759989
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810

Epoch :  26 loss training:  5.269785646814853 Time :  2293
accuracy train: 0.999531 val: 0.754930 test: 0.759989
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810

Epoch :  27 loss training:  4.298755032941699 Time :  2301
accuracy train: 0.999844 val: 0.760563 test: 0.759145
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810

Epoch :  28 loss training:  4.219311042688787 Time :  2315
accuracy train: 0.999844 val: 0.760563 test: 0.761114
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810

Epoch :  29 loss training:  3.6049278429709375 Time :  2326
accuracy train: 1.000000 val: 0.750704 test: 0.755205
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810

Epoch :  30 loss training:  3.118119103135541 Time :  2335
accuracy train: 0.999844 val: 0.752113 test: 0.756894
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810

Epoch :  31 loss training:  2.3059380075428635 Time :  2344
accuracy train: 1.000000 val: 0.750704 test: 0.754361
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810

Epoch :  32 loss training:  2.312176078208722 Time :  2353
accuracy train: 1.000000 val: 0.757746 test: 0.758301
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810

Epoch :  33 loss training:  2.0499098744476214 Time :  2363
accuracy train: 1.000000 val: 0.761972 test: 0.752954
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810

Epoch :  34 loss training:  1.7369289680500515 Time :  2370
accuracy train: 1.000000 val: 0.756338 test: 0.751266
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810

Epoch :  35 loss training:  1.7002981579862535 Time :  2376
accuracy train: 1.000000 val: 0.756338 test: 0.751266
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810

Epoch :  36 loss training:  1.6759894249262288 Time :  2386
accuracy train: 1.000000 val: 0.754930 test: 0.755768
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810

Epoch :  37 loss training:  1.3052281622658484 Time :  2394
accuracy train: 1.000000 val: 0.747887 test: 0.749297
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810

Epoch :  38 loss training:  1.1340745214838535 Time :  2406
accuracy train: 1.000000 val: 0.745070 test: 0.745076
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.780810

========================================================================================================================================================================================================
max acc epoch :  7
max validation accuracy :  0.7901408450704225
test accuracy :  0.7808103545301069
last test_accuracy :  0.7450759707371976
========================================================================================================================================================================================================

itr : 6
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.2, early_stop=30, epochs=400, filename='', hidden_dim=300, lda=False, lr=0.005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=350, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  105.65030592679977 Time :  2415
accuracy train: 0.661300 val: 0.642254 test: 0.643219
max validation accuracy : 0.642254 max acc epoch : 1 test accuracy : 0.643219
Epoch-1 lr: 0.005

Epoch :  2 loss training:  91.90845547616482 Time :  2429
accuracy train: 0.771491 val: 0.736620 test: 0.740855
max validation accuracy : 0.736620 max acc epoch : 2 test accuracy : 0.740855
Epoch-2 lr: 0.005

Epoch :  3 loss training:  82.85296654701233 Time :  2438
accuracy train: 0.685214 val: 0.660563 test: 0.657288
max validation accuracy : 0.736620 max acc epoch : 2 test accuracy : 0.740855
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  71.44776110351086 Time :  2448
accuracy train: 0.701469 val: 0.676056 test: 0.671075
max validation accuracy : 0.736620 max acc epoch : 2 test accuracy : 0.740855
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  66.77588894963264 Time :  2457
accuracy train: 0.740544 val: 0.709859 test: 0.706528
max validation accuracy : 0.736620 max acc epoch : 2 test accuracy : 0.740855
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  62.88238516449928 Time :  2467
accuracy train: 0.832448 val: 0.750704 test: 0.785594
max validation accuracy : 0.750704 max acc epoch : 6 test accuracy : 0.785594
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  52.97330169379711 Time :  2476
accuracy train: 0.833385 val: 0.743662 test: 0.765616
max validation accuracy : 0.750704 max acc epoch : 6 test accuracy : 0.785594
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  46.36480285227299 Time :  2486
accuracy train: 0.815567 val: 0.750704 test: 0.751548
max validation accuracy : 0.750704 max acc epoch : 6 test accuracy : 0.785594
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  42.635580360889435 Time :  2495
accuracy train: 0.837293 val: 0.747887 test: 0.769555
max validation accuracy : 0.750704 max acc epoch : 6 test accuracy : 0.785594
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  35.01794798672199 Time :  2505
accuracy train: 0.850266 val: 0.756338 test: 0.780529
max validation accuracy : 0.756338 max acc epoch : 10 test accuracy : 0.780529
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  32.12592841684818 Time :  2513
accuracy train: 0.819475 val: 0.739437 test: 0.751829
max validation accuracy : 0.756338 max acc epoch : 10 test accuracy : 0.780529
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  30.477963358163834 Time :  2522
accuracy train: 0.844639 val: 0.740845 test: 0.770118
max validation accuracy : 0.756338 max acc epoch : 10 test accuracy : 0.780529
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  26.586463253945112 Time :  2531
accuracy train: 0.830103 val: 0.732394 test: 0.763365
max validation accuracy : 0.756338 max acc epoch : 10 test accuracy : 0.780529
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  25.06846047192812 Time :  2543
accuracy train: 0.853861 val: 0.732394 test: 0.775746
max validation accuracy : 0.756338 max acc epoch : 10 test accuracy : 0.780529
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  24.200447667390108 Time :  2556
accuracy train: 0.860269 val: 0.757746 test: 0.774620
max validation accuracy : 0.757746 max acc epoch : 15 test accuracy : 0.774620

Epoch :  16 loss training:  23.302556466311216 Time :  2563
accuracy train: 0.869490 val: 0.764789 test: 0.771244
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  17 loss training:  19.272929221391678 Time :  2571
accuracy train: 0.857455 val: 0.743662 test: 0.765898
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  18 loss training:  15.793431594967842 Time :  2581
accuracy train: 0.899812 val: 0.759155 test: 0.774620
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  19 loss training:  13.999211385846138 Time :  2591
accuracy train: 0.995311 val: 0.752113 test: 0.774902
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  20 loss training:  11.82990752439946 Time :  2600
accuracy train: 0.997968 val: 0.745070 test: 0.764209
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  21 loss training:  8.72892208583653 Time :  2611
accuracy train: 0.998750 val: 0.746479 test: 0.771244
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  22 loss training:  7.589016185607761 Time :  2621
accuracy train: 0.999531 val: 0.745070 test: 0.771525
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  23 loss training:  6.269353803247213 Time :  2631
accuracy train: 0.967334 val: 0.743662 test: 0.771525
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  24 loss training:  5.395797172095627 Time :  2642
accuracy train: 0.998906 val: 0.747887 test: 0.762802
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  25 loss training:  4.6755765459965914 Time :  2652
accuracy train: 0.999375 val: 0.750704 test: 0.763365
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  26 loss training:  3.434261333430186 Time :  2662
accuracy train: 1.000000 val: 0.753521 test: 0.762240
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  27 loss training:  2.90599197242409 Time :  2676
accuracy train: 0.989059 val: 0.761972 test: 0.755487
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  28 loss training:  2.5969755549449474 Time :  2685
accuracy train: 0.922945 val: 0.694366 test: 0.701745
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  29 loss training:  2.5869564166059718 Time :  2696
accuracy train: 0.944983 val: 0.691549 test: 0.710748
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  30 loss training:  2.3303003986366093 Time :  2706
accuracy train: 0.946077 val: 0.700000 test: 0.706809
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  31 loss training:  1.8011440880363807 Time :  2716
accuracy train: 0.975774 val: 0.725352 test: 0.731851
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  32 loss training:  1.4239011998288333 Time :  2726
accuracy train: 0.962645 val: 0.712676 test: 0.719752
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  33 loss training:  1.7423438720870763 Time :  2737
accuracy train: 1.000000 val: 0.739437 test: 0.759426
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  34 loss training:  1.3531205223407596 Time :  2749
accuracy train: 1.000000 val: 0.740845 test: 0.758582
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  35 loss training:  1.2506682694074698 Time :  2758
accuracy train: 0.998593 val: 0.745070 test: 0.762240
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  36 loss training:  1.379991646273993 Time :  2768
accuracy train: 0.973898 val: 0.730986 test: 0.727631
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  37 loss training:  1.111661604809342 Time :  2776
accuracy train: 0.997343 val: 0.733803 test: 0.753799
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  38 loss training:  1.035067780816462 Time :  2789
accuracy train: 0.998906 val: 0.733803 test: 0.759145
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  39 loss training:  0.7503188709670212 Time :  2799
accuracy train: 0.975461 val: 0.698592 test: 0.714406
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  40 loss training:  0.6410441905609332 Time :  2811
accuracy train: 0.989997 val: 0.723944 test: 0.729319
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  41 loss training:  0.7476965313253459 Time :  2820
accuracy train: 0.999219 val: 0.735211 test: 0.753799
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  42 loss training:  0.4979421794996597 Time :  2830
accuracy train: 0.994061 val: 0.723944 test: 0.732696
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  43 loss training:  0.39625867336872034 Time :  2839
accuracy train: 0.999375 val: 0.739437 test: 0.752110
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  44 loss training:  0.6125382198952138 Time :  2849
accuracy train: 1.000000 val: 0.742254 test: 0.754643
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  45 loss training:  0.3886574084099266 Time :  2856
accuracy train: 1.000000 val: 0.736620 test: 0.754080
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  46 loss training:  0.41173911264922936 Time :  2867
accuracy train: 1.000000 val: 0.742254 test: 0.754361
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

Epoch :  47 loss training:  0.6597647211965523 Time :  2874
accuracy train: 1.000000 val: 0.739437 test: 0.751548
max validation accuracy : 0.764789 max acc epoch : 16 test accuracy : 0.771244

========================================================================================================================================================================================================
max acc epoch :  16
max validation accuracy :  0.7647887323943662
test accuracy :  0.7712436691052336
last test_accuracy :  0.7515475520540237
========================================================================================================================================================================================================

itr : 7
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.2, early_stop=30, epochs=400, filename='', hidden_dim=300, lda=False, lr=0.005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=350, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  102.87088909745216 Time :  2885
accuracy train: 0.696155 val: 0.677465 test: 0.680642
max validation accuracy : 0.677465 max acc epoch : 1 test accuracy : 0.680642
Epoch-1 lr: 0.005

Epoch :  2 loss training:  98.82688280940056 Time :  2894
accuracy train: 0.725852 val: 0.709859 test: 0.698368
max validation accuracy : 0.709859 max acc epoch : 2 test accuracy : 0.698368
Epoch-2 lr: 0.005

Epoch :  3 loss training:  84.16765497624874 Time :  2908
accuracy train: 0.829478 val: 0.757746 test: 0.777997
max validation accuracy : 0.757746 max acc epoch : 3 test accuracy : 0.777997
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  70.01312623918056 Time :  2918
accuracy train: 0.869647 val: 0.776056 test: 0.773495
max validation accuracy : 0.776056 max acc epoch : 4 test accuracy : 0.773495
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  62.35122409462929 Time :  2930
accuracy train: 0.891997 val: 0.766197 test: 0.780810
max validation accuracy : 0.776056 max acc epoch : 4 test accuracy : 0.773495
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  58.977093651890755 Time :  2938
accuracy train: 0.906064 val: 0.774648 test: 0.767867
max validation accuracy : 0.776056 max acc epoch : 4 test accuracy : 0.773495
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  51.18889756500721 Time :  2947
accuracy train: 0.924977 val: 0.778873 test: 0.777715
max validation accuracy : 0.778873 max acc epoch : 7 test accuracy : 0.777715
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  44.54756571352482 Time :  2954
accuracy train: 0.945452 val: 0.764789 test: 0.772651
max validation accuracy : 0.778873 max acc epoch : 7 test accuracy : 0.777715
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  41.38181097060442 Time :  2964
accuracy train: 0.961550 val: 0.763380 test: 0.775746
max validation accuracy : 0.778873 max acc epoch : 7 test accuracy : 0.777715
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  34.44116957485676 Time :  2971
accuracy train: 0.966552 val: 0.766197 test: 0.770400
max validation accuracy : 0.778873 max acc epoch : 7 test accuracy : 0.777715
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  32.09884664416313 Time :  2981
accuracy train: 0.969522 val: 0.763380 test: 0.767304
max validation accuracy : 0.778873 max acc epoch : 7 test accuracy : 0.777715
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  29.76050253212452 Time :  2989
accuracy train: 0.976711 val: 0.764789 test: 0.767867
max validation accuracy : 0.778873 max acc epoch : 7 test accuracy : 0.777715
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  27.748808294534683 Time :  3000
accuracy train: 0.979212 val: 0.781690 test: 0.768993
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  26.84475191310048 Time :  3009
accuracy train: 0.984526 val: 0.780282 test: 0.764209
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  26.06725787743926 Time :  3018
accuracy train: 0.986402 val: 0.773239 test: 0.765616
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  16 loss training:  25.177660174667835 Time :  3033
accuracy train: 0.991247 val: 0.781690 test: 0.768993
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  17 loss training:  20.217224523425102 Time :  3044
accuracy train: 0.993279 val: 0.773239 test: 0.769274
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  18 loss training:  15.873882208019495 Time :  3053
accuracy train: 0.996405 val: 0.767606 test: 0.765898
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  19 loss training:  13.193777916952968 Time :  3064
accuracy train: 0.998124 val: 0.757746 test: 0.766742
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  20 loss training:  10.915431834757328 Time :  3073
accuracy train: 0.998593 val: 0.753521 test: 0.760833
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  21 loss training:  9.072686753235757 Time :  3084
accuracy train: 0.998750 val: 0.757746 test: 0.767304
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  22 loss training:  7.981914171949029 Time :  3093
accuracy train: 0.999219 val: 0.756338 test: 0.770118
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  23 loss training:  6.2603969452902675 Time :  3105
accuracy train: 0.999687 val: 0.754930 test: 0.768711
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  24 loss training:  5.673934725113213 Time :  3114
accuracy train: 0.999687 val: 0.757746 test: 0.767304
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  25 loss training:  4.6355767250061035 Time :  3124
accuracy train: 0.999531 val: 0.752113 test: 0.770681
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  26 loss training:  4.227520185522735 Time :  3133
accuracy train: 0.999844 val: 0.749296 test: 0.767304
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  27 loss training:  3.3066483305301517 Time :  3143
accuracy train: 0.999844 val: 0.757746 test: 0.765053
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  28 loss training:  3.1560271808411926 Time :  3157
accuracy train: 0.999844 val: 0.760563 test: 0.764209
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  29 loss training:  2.6990952466148883 Time :  3167
accuracy train: 0.999844 val: 0.752113 test: 0.767586
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  30 loss training:  2.3117934939218685 Time :  3174
accuracy train: 0.999687 val: 0.756338 test: 0.764491
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  31 loss training:  2.118108540889807 Time :  3185
accuracy train: 1.000000 val: 0.753521 test: 0.763928
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  32 loss training:  1.6591956178890541 Time :  3194
accuracy train: 1.000000 val: 0.749296 test: 0.771244
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  33 loss training:  1.5532998795388266 Time :  3205
accuracy train: 1.000000 val: 0.750704 test: 0.766460
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  34 loss training:  1.4828356279758736 Time :  3215
accuracy train: 1.000000 val: 0.750704 test: 0.764491
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  35 loss training:  1.315661204047501 Time :  3227
accuracy train: 1.000000 val: 0.753521 test: 0.763084
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  36 loss training:  1.1510657948674634 Time :  3236
accuracy train: 1.000000 val: 0.746479 test: 0.765335
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  37 loss training:  1.3217054078704678 Time :  3247
accuracy train: 0.999687 val: 0.736620 test: 0.763928
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  38 loss training:  1.0468909030896612 Time :  3256
accuracy train: 1.000000 val: 0.742254 test: 0.768149
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  39 loss training:  1.0732494647381827 Time :  3266
accuracy train: 1.000000 val: 0.750704 test: 0.765898
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  40 loss training:  0.7420369041501544 Time :  3279
accuracy train: 1.000000 val: 0.756338 test: 0.763928
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  41 loss training:  0.6996869539143518 Time :  3288
accuracy train: 1.000000 val: 0.754930 test: 0.762521
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  42 loss training:  0.8215524445695337 Time :  3298
accuracy train: 1.000000 val: 0.746479 test: 0.764491
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  43 loss training:  0.5519230243517086 Time :  3308
accuracy train: 1.000000 val: 0.743662 test: 0.761958
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

Epoch :  44 loss training:  0.6766364535724279 Time :  3315
accuracy train: 1.000000 val: 0.752113 test: 0.761396
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.768993

========================================================================================================================================================================================================
max acc epoch :  13
max validation accuracy :  0.7816901408450704
test accuracy :  0.768992684299381
last test_accuracy :  0.7613956105796286
========================================================================================================================================================================================================

itr : 8
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.2, early_stop=30, epochs=400, filename='', hidden_dim=300, lda=False, lr=0.005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=350, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  100.16083106398582 Time :  3325
accuracy train: 0.700844 val: 0.684507 test: 0.685988
max validation accuracy : 0.684507 max acc epoch : 1 test accuracy : 0.685988
Epoch-1 lr: 0.005

Epoch :  2 loss training:  90.54425272345543 Time :  3333
accuracy train: 0.749609 val: 0.722535 test: 0.710467
max validation accuracy : 0.722535 max acc epoch : 2 test accuracy : 0.710467
Epoch-2 lr: 0.005

Epoch :  3 loss training:  82.2126207947731 Time :  3343
accuracy train: 0.812441 val: 0.745070 test: 0.771806
max validation accuracy : 0.745070 max acc epoch : 3 test accuracy : 0.771806
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  73.45404696464539 Time :  3352
accuracy train: 0.830885 val: 0.763380 test: 0.763365
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.763365
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  68.65235312283039 Time :  3361
accuracy train: 0.821350 val: 0.749296 test: 0.749297
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.763365
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  66.20581679046154 Time :  3372
accuracy train: 0.877305 val: 0.759155 test: 0.777434
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.763365
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  57.094104409217834 Time :  3381
accuracy train: 0.901063 val: 0.769014 test: 0.775746
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.775746
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  52.7059742808342 Time :  3393
accuracy train: 0.919662 val: 0.771831 test: 0.767304
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  50.36323991417885 Time :  3405
accuracy train: 0.919662 val: 0.770423 test: 0.770962
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  43.673741079866886 Time :  3416
accuracy train: 0.944358 val: 0.766197 test: 0.778278
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  40.77888102084398 Time :  3425
accuracy train: 0.938418 val: 0.756338 test: 0.762240
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  39.357005812227726 Time :  3435
accuracy train: 0.949047 val: 0.759155 test: 0.769274
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  35.79446068406105 Time :  3445
accuracy train: 0.966865 val: 0.769014 test: 0.774057
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  33.948334738612175 Time :  3454
accuracy train: 0.968115 val: 0.771831 test: 0.768430
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  33.12987234443426 Time :  3465
accuracy train: 0.970928 val: 0.769014 test: 0.769555
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304

Epoch :  16 loss training:  31.912462830543518 Time :  3474
accuracy train: 0.979994 val: 0.766197 test: 0.771244
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304

Epoch :  17 loss training:  25.94671795144677 Time :  3484
accuracy train: 0.988121 val: 0.757746 test: 0.774339
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304

Epoch :  18 loss training:  21.314098201692104 Time :  3492
accuracy train: 0.992341 val: 0.766197 test: 0.771525
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304

Epoch :  19 loss training:  16.61980064958334 Time :  3503
accuracy train: 0.996561 val: 0.763380 test: 0.768711
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304

Epoch :  20 loss training:  14.691884396597743 Time :  3514
accuracy train: 0.995624 val: 0.750704 test: 0.764491
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304

Epoch :  21 loss training:  11.845630183815956 Time :  3525
accuracy train: 0.998593 val: 0.757746 test: 0.766742
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304

Epoch :  22 loss training:  9.486802062951028 Time :  3532
accuracy train: 0.998437 val: 0.761972 test: 0.763365
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304

Epoch :  23 loss training:  8.246668869629502 Time :  3543
accuracy train: 0.999375 val: 0.763380 test: 0.760551
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304

Epoch :  24 loss training:  6.889508530497551 Time :  3552
accuracy train: 0.999687 val: 0.756338 test: 0.758019
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304

Epoch :  25 loss training:  5.873371725901961 Time :  3562
accuracy train: 0.999375 val: 0.766197 test: 0.763647
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304

Epoch :  26 loss training:  4.882788199000061 Time :  3571
accuracy train: 0.999844 val: 0.757746 test: 0.760270
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304

Epoch :  27 loss training:  4.291478367056698 Time :  3583
accuracy train: 0.999844 val: 0.767606 test: 0.759989
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304

Epoch :  28 loss training:  3.8119374359957874 Time :  3593
accuracy train: 1.000000 val: 0.757746 test: 0.757738
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304

Epoch :  29 loss training:  3.876262158853933 Time :  3604
accuracy train: 0.999062 val: 0.747887 test: 0.753517
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304

Epoch :  30 loss training:  3.5214480806607753 Time :  3615
accuracy train: 0.999844 val: 0.743662 test: 0.757175
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304

Epoch :  31 loss training:  2.679121702676639 Time :  3626
accuracy train: 1.000000 val: 0.742254 test: 0.748734
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304

Epoch :  32 loss training:  2.1662978066597134 Time :  3642
accuracy train: 1.000000 val: 0.746479 test: 0.755768
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304

Epoch :  33 loss training:  2.2891954517690465 Time :  3651
accuracy train: 0.999844 val: 0.733803 test: 0.751548
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304

Epoch :  34 loss training:  1.7626009995583445 Time :  3661
accuracy train: 1.000000 val: 0.752113 test: 0.751266
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304

Epoch :  35 loss training:  1.6226471064146608 Time :  3670
accuracy train: 1.000000 val: 0.745070 test: 0.749578
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304

Epoch :  36 loss training:  1.4178223084891215 Time :  3681
accuracy train: 1.000000 val: 0.747887 test: 0.755487
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304

Epoch :  37 loss training:  1.3468963198247366 Time :  3690
accuracy train: 1.000000 val: 0.747887 test: 0.753236
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304

Epoch :  38 loss training:  1.309340931562474 Time :  3701
accuracy train: 1.000000 val: 0.750704 test: 0.750703
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304

Epoch :  39 loss training:  0.9557338766171597 Time :  3708
accuracy train: 1.000000 val: 0.750704 test: 0.749578
max validation accuracy : 0.771831 max acc epoch : 8 test accuracy : 0.767304

========================================================================================================================================================================================================
max acc epoch :  8
max validation accuracy :  0.7718309859154929
test accuracy :  0.7673044456949916
last test_accuracy :  0.7495779403489027
========================================================================================================================================================================================================

itr : 9
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.2, early_stop=30, epochs=400, filename='', hidden_dim=300, lda=False, lr=0.005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=350, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  103.5070396065712 Time :  3719
accuracy train: 0.627540 val: 0.626761 test: 0.617895
max validation accuracy : 0.626761 max acc epoch : 1 test accuracy : 0.617895
Epoch-1 lr: 0.005

Epoch :  2 loss training:  92.91053971648216 Time :  3727
accuracy train: 0.780088 val: 0.766197 test: 0.768993
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768993
Epoch-2 lr: 0.005

Epoch :  3 loss training:  86.6441842019558 Time :  3737
accuracy train: 0.773367 val: 0.736620 test: 0.746201
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768993
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  79.40663248300552 Time :  3744
accuracy train: 0.706783 val: 0.680282 test: 0.678109
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768993
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  75.79350060224533 Time :  3755
accuracy train: 0.701000 val: 0.678873 test: 0.680642
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768993
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  76.098827496171 Time :  3768
accuracy train: 0.651766 val: 0.615493 test: 0.641531
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768993
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  70.6641357243061 Time :  3774
accuracy train: 0.644264 val: 0.594366 test: 0.623241
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768993
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  69.68387781083584 Time :  3783
accuracy train: 0.803845 val: 0.729577 test: 0.753517
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768993
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  68.21808722615242 Time :  3789
accuracy train: 0.830885 val: 0.750704 test: 0.765335
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768993
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  66.24876870214939 Time :  3796
accuracy train: 0.846827 val: 0.763380 test: 0.767867
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768993
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  64.3767159730196 Time :  3806
accuracy train: 0.835574 val: 0.756338 test: 0.759426
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768993
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  63.56628851592541 Time :  3815
accuracy train: 0.853704 val: 0.764789 test: 0.764209
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768993
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  62.199616730213165 Time :  3827
accuracy train: 0.858862 val: 0.771831 test: 0.767867
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  60.96875610947609 Time :  3836
accuracy train: 0.796186 val: 0.735211 test: 0.725661
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  61.281149208545685 Time :  3846
accuracy train: 0.830572 val: 0.759155 test: 0.741418
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  16 loss training:  61.081616416573524 Time :  3856
accuracy train: 0.810878 val: 0.725352 test: 0.723692
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  17 loss training:  54.09529575705528 Time :  3867
accuracy train: 0.868084 val: 0.746479 test: 0.753236
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  18 loss training:  47.96753332018852 Time :  3877
accuracy train: 0.888246 val: 0.747887 test: 0.751829
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  19 loss training:  41.76238548010588 Time :  3890
accuracy train: 0.894655 val: 0.738028 test: 0.743669
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  20 loss training:  37.90537003427744 Time :  3897
accuracy train: 0.940763 val: 0.760563 test: 0.759707
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  21 loss training:  33.29551959037781 Time :  3905
accuracy train: 0.961550 val: 0.759155 test: 0.767304
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  22 loss training:  27.896798316389322 Time :  3916
accuracy train: 0.969834 val: 0.760563 test: 0.765616
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  23 loss training:  24.80751053057611 Time :  3926
accuracy train: 0.974523 val: 0.756338 test: 0.760551
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  24 loss training:  22.443777887150645 Time :  3933
accuracy train: 0.981400 val: 0.760563 test: 0.765898
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  25 loss training:  19.058652950450778 Time :  3940
accuracy train: 0.986089 val: 0.766197 test: 0.765335
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  26 loss training:  16.627622731029987 Time :  3951
accuracy train: 0.990622 val: 0.769014 test: 0.759145
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  27 loss training:  14.088790450245142 Time :  3961
accuracy train: 0.990935 val: 0.749296 test: 0.752110
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  28 loss training:  12.855869784019887 Time :  3971
accuracy train: 0.994217 val: 0.757746 test: 0.752954
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  29 loss training:  10.817202593199909 Time :  3980
accuracy train: 0.995155 val: 0.750704 test: 0.755768
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  30 loss training:  9.521173251792789 Time :  3989
accuracy train: 0.996405 val: 0.757746 test: 0.754361
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  31 loss training:  8.489126024767756 Time :  4001
accuracy train: 0.997499 val: 0.750704 test: 0.751548
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  32 loss training:  6.879622335080057 Time :  4013
accuracy train: 0.997499 val: 0.754930 test: 0.753799
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  33 loss training:  6.2106804540380836 Time :  4022
accuracy train: 0.995467 val: 0.742254 test: 0.747608
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  34 loss training:  5.454847340472043 Time :  4032
accuracy train: 0.995467 val: 0.742254 test: 0.747327
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  35 loss training:  4.72338078264147 Time :  4041
accuracy train: 0.998593 val: 0.749296 test: 0.749297
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  36 loss training:  4.075475857127458 Time :  4053
accuracy train: 0.998593 val: 0.745070 test: 0.748171
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  37 loss training:  3.637813861016184 Time :  4064
accuracy train: 0.999531 val: 0.745070 test: 0.747890
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  38 loss training:  3.3779712396208197 Time :  4074
accuracy train: 0.999687 val: 0.738028 test: 0.748171
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  39 loss training:  2.863520067650825 Time :  4083
accuracy train: 0.998906 val: 0.739437 test: 0.746483
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  40 loss training:  2.452450785203837 Time :  4093
accuracy train: 0.999687 val: 0.742254 test: 0.747046
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  41 loss training:  2.441843460430391 Time :  4100
accuracy train: 0.998124 val: 0.726761 test: 0.741418
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  42 loss training:  2.4046727437525988 Time :  4112
accuracy train: 0.995155 val: 0.709859 test: 0.733540
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  43 loss training:  1.810716389096342 Time :  4127
accuracy train: 0.997968 val: 0.725352 test: 0.733821
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

Epoch :  44 loss training:  1.6450508071575314 Time :  4137
accuracy train: 0.999375 val: 0.738028 test: 0.742544
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.767867

========================================================================================================================================================================================================
max acc epoch :  13
max validation accuracy :  0.7718309859154929
test accuracy :  0.7678671918964547
last test_accuracy :  0.7425436128306134
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.78310 	 test_accuracy : 0.77040 	 max_acc epoch :  10 	 last test_accuracy : 0.76730
k :  1 	 val_accuracy : 0.78028 	 test_accuracy : 0.77687 	 max_acc epoch :  7 	 last test_accuracy : 0.75324
k :  2 	 val_accuracy : 0.77465 	 test_accuracy : 0.77940 	 max_acc epoch :  4 	 last test_accuracy : 0.77209
k :  3 	 val_accuracy : 0.76761 	 test_accuracy : 0.77912 	 max_acc epoch :  17 	 last test_accuracy : 0.75239
k :  4 	 val_accuracy : 0.78028 	 test_accuracy : 0.77349 	 max_acc epoch :  4 	 last test_accuracy : 0.76899
k :  5 	 val_accuracy : 0.79014 	 test_accuracy : 0.78081 	 max_acc epoch :  7 	 last test_accuracy : 0.74508
k :  6 	 val_accuracy : 0.76479 	 test_accuracy : 0.77124 	 max_acc epoch :  16 	 last test_accuracy : 0.75155
k :  7 	 val_accuracy : 0.78169 	 test_accuracy : 0.76899 	 max_acc epoch :  13 	 last test_accuracy : 0.76140
k :  8 	 val_accuracy : 0.77183 	 test_accuracy : 0.76730 	 max_acc epoch :  8 	 last test_accuracy : 0.74958
k :  9 	 val_accuracy : 0.77183 	 test_accuracy : 0.76787 	 max_acc epoch :  13 	 last test_accuracy : 0.74254

avg :  	 val_accuracy : 0.77662 	 test_accuracy : 0.77355 	 last_accuracy : 0.75642


date and time :  Thu Jun 10 11:17:16 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.2, early_stop=30, epochs=400, filename='', hidden_dim=100, lda=False, lr=0.0005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=82, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  89.15512827038765 Time :  13
accuracy train: 0.782119 val: 0.784507 test: 0.765616
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  81.33121460676193 Time :  22
accuracy train: 0.802126 val: 0.784507 test: 0.771525
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  76.51223945617676 Time :  34
accuracy train: 0.807440 val: 0.766197 test: 0.770962
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  72.14732939004898 Time :  44
accuracy train: 0.823382 val: 0.763380 test: 0.781936
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  71.25635127723217 Time :  56
accuracy train: 0.831197 val: 0.780282 test: 0.773213
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  68.5949415564537 Time :  66
accuracy train: 0.839481 val: 0.776056 test: 0.770118
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  66.3782504349947 Time :  76
accuracy train: 0.843545 val: 0.781690 test: 0.773495
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  65.13498087227345 Time :  88
accuracy train: 0.852141 val: 0.773239 test: 0.779685
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  64.51193833351135 Time :  98
accuracy train: 0.849953 val: 0.761972 test: 0.777153
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  62.7713607698679 Time :  108
accuracy train: 0.857924 val: 0.783099 test: 0.776590
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  61.852737575769424 Time :  120
accuracy train: 0.863239 val: 0.783099 test: 0.776308
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  61.83092863857746 Time :  132
accuracy train: 0.866364 val: 0.770423 test: 0.774620
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  60.38179834187031 Time :  139
accuracy train: 0.866208 val: 0.778873 test: 0.775746
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  61.66962173581123 Time :  147
accuracy train: 0.870585 val: 0.784507 test: 0.772651
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  59.802891448140144 Time :  156
accuracy train: 0.870428 val: 0.774648 test: 0.774620
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616

Epoch :  16 loss training:  59.54119196534157 Time :  165
accuracy train: 0.879650 val: 0.773239 test: 0.772088
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616

Epoch :  17 loss training:  58.64506138861179 Time :  176
accuracy train: 0.875899 val: 0.778873 test: 0.774902
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616

Epoch :  18 loss training:  58.0976909250021 Time :  187
accuracy train: 0.881838 val: 0.780282 test: 0.774902
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616

Epoch :  19 loss training:  57.49116566777229 Time :  199
accuracy train: 0.887465 val: 0.783099 test: 0.777434
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616

Epoch :  20 loss training:  56.952680855989456 Time :  209
accuracy train: 0.889966 val: 0.781690 test: 0.777434
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616

Epoch :  21 loss training:  54.97535797953606 Time :  221
accuracy train: 0.896843 val: 0.774648 test: 0.772088
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616

Epoch :  22 loss training:  54.25552149116993 Time :  232
accuracy train: 0.896061 val: 0.777465 test: 0.777715
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616

Epoch :  23 loss training:  52.94748283922672 Time :  243
accuracy train: 0.903407 val: 0.777465 test: 0.777997
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616

Epoch :  24 loss training:  51.43734012544155 Time :  255
accuracy train: 0.907158 val: 0.774648 test: 0.778841
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616

Epoch :  25 loss training:  50.159450367093086 Time :  267
accuracy train: 0.906533 val: 0.773239 test: 0.776308
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616

Epoch :  26 loss training:  48.625334814190865 Time :  279
accuracy train: 0.913567 val: 0.769014 test: 0.773213
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616

Epoch :  27 loss training:  48.91452743113041 Time :  286
accuracy train: 0.916536 val: 0.770423 test: 0.778278
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616

Epoch :  28 loss training:  48.06895914673805 Time :  294
accuracy train: 0.921069 val: 0.770423 test: 0.772651
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616

Epoch :  29 loss training:  47.61073896288872 Time :  305
accuracy train: 0.925602 val: 0.767606 test: 0.774057
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616

Epoch :  30 loss training:  46.19186852872372 Time :  318
accuracy train: 0.926852 val: 0.770423 test: 0.773213
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616

Epoch :  31 loss training:  45.074873462319374 Time :  328
accuracy train: 0.929822 val: 0.761972 test: 0.770118
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616

Epoch :  32 loss training:  44.607732109725475 Time :  339
accuracy train: 0.936230 val: 0.766197 test: 0.770962
max validation accuracy : 0.784507 max acc epoch : 1 test accuracy : 0.765616

========================================================================================================================================================================================================
max acc epoch :  1
max validation accuracy :  0.7845070422535211
test accuracy :  0.7656162070906022
last test_accuracy :  0.770962296004502
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.2, early_stop=30, epochs=400, filename='', hidden_dim=100, lda=False, lr=0.0005, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=82, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  89.15714693069458 Time :  351
accuracy train: 0.782745 val: 0.777465 test: 0.767023
max validation accuracy : 0.777465 max acc epoch : 1 test accuracy : 0.767023
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  81.36965790390968 Time :  364
accuracy train: 0.799312 val: 0.781690 test: 0.773213
max validation accuracy : 0.781690 max acc epoch : 2 test accuracy : 0.773213
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  76.42588990926743 Time :  371
accuracy train: 0.808378 val: 0.764789 test: 0.772088
max validation accuracy : 0.781690 max acc epoch : 2 test accuracy : 0.773213
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  72.21901151537895 Time :  378
accuracy train: 0.824476 val: 0.767606 test: 0.780810
max validation accuracy : 0.781690 max acc epoch : 2 test accuracy : 0.773213
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  71.11375372111797 Time :  388
accuracy train: 0.834167 val: 0.771831 test: 0.774339
max validation accuracy : 0.781690 max acc epoch : 2 test accuracy : 0.773213
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  68.58225516974926 Time :  397
accuracy train: 0.838387 val: 0.778873 test: 0.771525
max validation accuracy : 0.781690 max acc epoch : 2 test accuracy : 0.773213
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  66.4057898670435 Time :  408
accuracy train: 0.844483 val: 0.784507 test: 0.773213
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773213
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  65.10043393075466 Time :  416
accuracy train: 0.853704 val: 0.778873 test: 0.778278
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773213
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  64.40435715019703 Time :  428
accuracy train: 0.850735 val: 0.764789 test: 0.776871
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773213
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  62.683952912688255 Time :  438
accuracy train: 0.858550 val: 0.783099 test: 0.776027
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773213
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  61.924886494874954 Time :  449
accuracy train: 0.862301 val: 0.780282 test: 0.778841
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773213
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  61.738609597086906 Time :  460
accuracy train: 0.866677 val: 0.778873 test: 0.774057
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.773213
Epoch-12 lr: 3.125e-05

slurmstepd: error: *** JOB 37013 ON cl-gpusrv1 CANCELLED AT 2021-06-10T11:25:00 ***
