

date and time :  Sat Jun 12 18:39:33 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=965, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.82566368579865 Time :  11
accuracy train: 0.780400 val: 0.759155 test: 0.761958
max validation accuracy : 0.759155 max acc epoch : 1 test accuracy : 0.761958
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.48953583836555 Time :  20
accuracy train: 0.800719 val: 0.750704 test: 0.766179
max validation accuracy : 0.759155 max acc epoch : 1 test accuracy : 0.761958
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.75933969020844 Time :  30
accuracy train: 0.822913 val: 0.769014 test: 0.772932
max validation accuracy : 0.769014 max acc epoch : 3 test accuracy : 0.772932
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.03823736310005 Time :  39
accuracy train: 0.822601 val: 0.773239 test: 0.772932
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.772932
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.37862874567509 Time :  49
accuracy train: 0.838231 val: 0.767606 test: 0.769837
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.772932
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  69.81186239421368 Time :  58
accuracy train: 0.848703 val: 0.783099 test: 0.775183
max validation accuracy : 0.783099 max acc epoch : 6 test accuracy : 0.775183
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  65.960145637393 Time :  68
accuracy train: 0.864645 val: 0.769014 test: 0.773213
max validation accuracy : 0.783099 max acc epoch : 6 test accuracy : 0.775183
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.7288860976696 Time :  78
accuracy train: 0.859331 val: 0.767606 test: 0.767586
max validation accuracy : 0.783099 max acc epoch : 6 test accuracy : 0.775183
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.857192397117615 Time :  88
accuracy train: 0.873398 val: 0.785915 test: 0.767304
max validation accuracy : 0.785915 max acc epoch : 9 test accuracy : 0.767304
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.46533325314522 Time :  99
accuracy train: 0.883401 val: 0.785915 test: 0.768149
max validation accuracy : 0.785915 max acc epoch : 9 test accuracy : 0.767304

Epoch :  11 loss training:  59.40637493133545 Time :  109
accuracy train: 0.890747 val: 0.801408 test: 0.768711
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  12 loss training:  57.68956771492958 Time :  120
accuracy train: 0.899656 val: 0.794366 test: 0.770400
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  13 loss training:  54.88489054143429 Time :  131
accuracy train: 0.916068 val: 0.797183 test: 0.772369
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  14 loss training:  51.36667303740978 Time :  140
accuracy train: 0.927008 val: 0.795775 test: 0.769274
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  15 loss training:  47.89715786278248 Time :  152
accuracy train: 0.935292 val: 0.790141 test: 0.770400
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  16 loss training:  45.39086902886629 Time :  162
accuracy train: 0.942638 val: 0.792958 test: 0.767867
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  17 loss training:  42.91000987589359 Time :  174
accuracy train: 0.950453 val: 0.792958 test: 0.768149
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  18 loss training:  39.1352908089757 Time :  185
accuracy train: 0.958581 val: 0.788732 test: 0.763928
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  19 loss training:  37.98699835687876 Time :  193
accuracy train: 0.967490 val: 0.801408 test: 0.762240
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  20 loss training:  34.03568458929658 Time :  205
accuracy train: 0.972179 val: 0.792958 test: 0.759426
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  21 loss training:  30.927593022584915 Time :  214
accuracy train: 0.977337 val: 0.795775 test: 0.757738
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  22 loss training:  29.794960755854845 Time :  225
accuracy train: 0.981557 val: 0.788732 test: 0.765335
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  23 loss training:  28.5498389005661 Time :  232
accuracy train: 0.987496 val: 0.776056 test: 0.758019
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  24 loss training:  24.92349971458316 Time :  240
accuracy train: 0.989372 val: 0.780282 test: 0.763647
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  25 loss training:  24.264566283673048 Time :  252
accuracy train: 0.992029 val: 0.783099 test: 0.762240
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  26 loss training:  23.327400214970112 Time :  262
accuracy train: 0.994217 val: 0.783099 test: 0.763365
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  27 loss training:  21.467643385753036 Time :  274
accuracy train: 0.994217 val: 0.784507 test: 0.759989
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  28 loss training:  18.889722062274814 Time :  284
accuracy train: 0.996093 val: 0.788732 test: 0.757738
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  29 loss training:  17.400100521743298 Time :  295
accuracy train: 0.996718 val: 0.785915 test: 0.760270
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  30 loss training:  17.150932792574167 Time :  305
accuracy train: 0.996874 val: 0.776056 test: 0.766179
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  31 loss training:  15.349193196743727 Time :  316
accuracy train: 0.998281 val: 0.781690 test: 0.756331
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  32 loss training:  14.880443376488984 Time :  326
accuracy train: 0.998124 val: 0.791549 test: 0.753236
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  33 loss training:  13.219937615096569 Time :  335
accuracy train: 0.998906 val: 0.774648 test: 0.754361
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  34 loss training:  12.542906088754535 Time :  347
accuracy train: 0.999375 val: 0.777465 test: 0.759989
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  35 loss training:  12.124036601744592 Time :  357
accuracy train: 0.999531 val: 0.785915 test: 0.754361
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  36 loss training:  12.119569845497608 Time :  368
accuracy train: 0.999531 val: 0.784507 test: 0.757456
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  37 loss training:  9.659200330264866 Time :  379
accuracy train: 0.999687 val: 0.788732 test: 0.757456
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  38 loss training:  10.644025955931284 Time :  390
accuracy train: 0.999844 val: 0.788732 test: 0.759426
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  39 loss training:  9.508510762825608 Time :  402
accuracy train: 0.999687 val: 0.780282 test: 0.757175
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  40 loss training:  9.32608123170212 Time :  412
accuracy train: 1.000000 val: 0.787324 test: 0.757175
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  41 loss training:  9.101107895374298 Time :  425
accuracy train: 1.000000 val: 0.781690 test: 0.761114
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

Epoch :  42 loss training:  7.771511480212212 Time :  435
accuracy train: 0.999844 val: 0.776056 test: 0.755205
max validation accuracy : 0.801408 max acc epoch : 11 test accuracy : 0.768711

========================================================================================================================================================================================================
best acc epoch :  11
validation accuracy :  0.8014084507042254
test accuracy :  0.7687113111986494
last test_accuracy :  0.7552054023635341
second best val :  0.7971830985915493
second best test :  0.7687113111986494
max gap 3
========================================================================================================================================================================================================

(3554, 1400)
itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=965, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.8482266664505 Time :  523
accuracy train: 0.777118 val: 0.745070 test: 0.758863
max validation accuracy : 0.745070 max acc epoch : 1 test accuracy : 0.758863
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.51107263565063 Time :  535
accuracy train: 0.788215 val: 0.753521 test: 0.766742
max validation accuracy : 0.753521 max acc epoch : 2 test accuracy : 0.766742
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.9053630232811 Time :  545
accuracy train: 0.818068 val: 0.769014 test: 0.771806
max validation accuracy : 0.769014 max acc epoch : 3 test accuracy : 0.771806
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.4884775429964 Time :  556
accuracy train: 0.818224 val: 0.761972 test: 0.774620
max validation accuracy : 0.769014 max acc epoch : 3 test accuracy : 0.771806
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  73.1592176258564 Time :  567
accuracy train: 0.830259 val: 0.777465 test: 0.774057
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.774057
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.11212974786758 Time :  574
accuracy train: 0.841669 val: 0.771831 test: 0.776590
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.774057
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.49568548798561 Time :  586
accuracy train: 0.857768 val: 0.776056 test: 0.776027
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.774057
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.47868078947067 Time :  595
accuracy train: 0.853235 val: 0.770423 test: 0.765335
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.774057
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.56019793450832 Time :  608
accuracy train: 0.866990 val: 0.776056 test: 0.769274
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.774057
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.93018300831318 Time :  617
accuracy train: 0.874961 val: 0.773239 test: 0.772369
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.774057

Epoch :  11 loss training:  60.4833991676569 Time :  627
accuracy train: 0.882463 val: 0.776056 test: 0.769555
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.774057

Epoch :  12 loss training:  58.972661167383194 Time :  639
accuracy train: 0.894029 val: 0.776056 test: 0.768149
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.774057

Epoch :  13 loss training:  56.11285778880119 Time :  649
accuracy train: 0.910753 val: 0.774648 test: 0.770962
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.774057

Epoch :  14 loss training:  52.08926160633564 Time :  661
accuracy train: 0.921694 val: 0.781690 test: 0.767023
max validation accuracy : 0.781690 max acc epoch : 14 test accuracy : 0.767023

Epoch :  15 loss training:  49.082429617643356 Time :  668
accuracy train: 0.930603 val: 0.788732 test: 0.768993
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  16 loss training:  46.08596409112215 Time :  677
accuracy train: 0.935136 val: 0.785915 test: 0.770400
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  17 loss training:  43.497161500155926 Time :  688
accuracy train: 0.948421 val: 0.784507 test: 0.769837
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  18 loss training:  39.849174715578556 Time :  698
accuracy train: 0.956080 val: 0.785915 test: 0.768430
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  19 loss training:  38.05221091210842 Time :  710
accuracy train: 0.962488 val: 0.776056 test: 0.767023
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  20 loss training:  34.869934149086475 Time :  718
accuracy train: 0.967959 val: 0.776056 test: 0.762521
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  21 loss training:  31.950714632868767 Time :  725
accuracy train: 0.973898 val: 0.773239 test: 0.764491
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  22 loss training:  30.144968919456005 Time :  738
accuracy train: 0.978900 val: 0.770423 test: 0.761677
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  23 loss training:  28.881449833512306 Time :  748
accuracy train: 0.983589 val: 0.754930 test: 0.766742
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  24 loss training:  25.529518105089664 Time :  760
accuracy train: 0.986089 val: 0.776056 test: 0.768711
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  25 loss training:  24.75062270835042 Time :  770
accuracy train: 0.989372 val: 0.773239 test: 0.769837
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  26 loss training:  23.09326909482479 Time :  782
accuracy train: 0.991872 val: 0.776056 test: 0.759707
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  27 loss training:  21.260018901899457 Time :  792
accuracy train: 0.994686 val: 0.778873 test: 0.760833
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  28 loss training:  18.97594322450459 Time :  803
accuracy train: 0.994998 val: 0.777465 test: 0.763084
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  29 loss training:  17.98639242351055 Time :  813
accuracy train: 0.995936 val: 0.777465 test: 0.761396
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  30 loss training:  17.51010381244123 Time :  825
accuracy train: 0.997187 val: 0.777465 test: 0.763084
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  31 loss training:  15.506294229999185 Time :  836
accuracy train: 0.995780 val: 0.764789 test: 0.759989
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  32 loss training:  15.553772290237248 Time :  847
accuracy train: 0.998124 val: 0.770423 test: 0.761114
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  33 loss training:  14.104528940282762 Time :  858
accuracy train: 0.999062 val: 0.770423 test: 0.763928
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  34 loss training:  12.592304434627295 Time :  865
accuracy train: 0.999062 val: 0.761972 test: 0.763647
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  35 loss training:  11.422945268452168 Time :  877
accuracy train: 0.999375 val: 0.783099 test: 0.757175
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  36 loss training:  12.048731099814177 Time :  884
accuracy train: 0.999375 val: 0.774648 test: 0.758863
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  37 loss training:  10.3535464159213 Time :  891
accuracy train: 0.999687 val: 0.771831 test: 0.755487
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  38 loss training:  10.473914343863726 Time :  902
accuracy train: 0.999375 val: 0.773239 test: 0.759707
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  39 loss training:  9.307297298219055 Time :  912
accuracy train: 0.999844 val: 0.771831 test: 0.761958
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  40 loss training:  10.181087543489411 Time :  923
accuracy train: 0.999375 val: 0.767606 test: 0.758019
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  41 loss training:  7.724687509471551 Time :  935
accuracy train: 0.999687 val: 0.776056 test: 0.758301
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  42 loss training:  7.523157859919593 Time :  945
accuracy train: 1.000000 val: 0.770423 test: 0.759145
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  43 loss training:  7.4773333156481385 Time :  957
accuracy train: 0.999844 val: 0.773239 test: 0.762802
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  44 loss training:  6.217450507450849 Time :  967
accuracy train: 0.999687 val: 0.769014 test: 0.763365
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  45 loss training:  6.673624235554598 Time :  980
accuracy train: 1.000000 val: 0.771831 test: 0.754643
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

Epoch :  46 loss training:  6.950553820002824 Time :  987
accuracy train: 1.000000 val: 0.763380 test: 0.758301
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.768993

========================================================================================================================================================================================================
best acc epoch :  15
validation accuracy :  0.7887323943661971
test accuracy :  0.768992684299381
last test_accuracy :  0.7583005064715813
second best val :  0.7859154929577464
second best test :  0.768992684299381
max gap 9
========================================================================================================================================================================================================

(3554, 1400)
itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=965, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.88730919361115 Time :  1079
accuracy train: 0.778681 val: 0.752113 test: 0.765335
max validation accuracy : 0.752113 max acc epoch : 1 test accuracy : 0.765335
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.57157894968987 Time :  1088
accuracy train: 0.800563 val: 0.761972 test: 0.769555
max validation accuracy : 0.761972 max acc epoch : 2 test accuracy : 0.769555
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.39506962895393 Time :  1100
accuracy train: 0.820100 val: 0.767606 test: 0.771525
max validation accuracy : 0.767606 max acc epoch : 3 test accuracy : 0.771525
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.78458671271801 Time :  1110
accuracy train: 0.821507 val: 0.773239 test: 0.777715
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.777715
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.18091593682766 Time :  1122
accuracy train: 0.837449 val: 0.763380 test: 0.768993
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.777715
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  69.68532769382 Time :  1132
accuracy train: 0.845108 val: 0.785915 test: 0.778841
max validation accuracy : 0.785915 max acc epoch : 6 test accuracy : 0.778841
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  65.79495584964752 Time :  1143
accuracy train: 0.860738 val: 0.777465 test: 0.772369
max validation accuracy : 0.785915 max acc epoch : 6 test accuracy : 0.778841
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.89326232671738 Time :  1154
accuracy train: 0.861676 val: 0.773239 test: 0.768430
max validation accuracy : 0.785915 max acc epoch : 6 test accuracy : 0.778841
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.437376379966736 Time :  1163
accuracy train: 0.870897 val: 0.791549 test: 0.771806
max validation accuracy : 0.791549 max acc epoch : 9 test accuracy : 0.771806
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.81921397149563 Time :  1176
accuracy train: 0.879962 val: 0.788732 test: 0.769274
max validation accuracy : 0.791549 max acc epoch : 9 test accuracy : 0.771806

Epoch :  11 loss training:  59.93958331644535 Time :  1184
accuracy train: 0.891529 val: 0.788732 test: 0.771806
max validation accuracy : 0.791549 max acc epoch : 9 test accuracy : 0.771806

Epoch :  12 loss training:  57.6030765324831 Time :  1196
accuracy train: 0.901063 val: 0.790141 test: 0.766179
max validation accuracy : 0.791549 max acc epoch : 9 test accuracy : 0.771806

Epoch :  13 loss training:  54.85279615223408 Time :  1206
accuracy train: 0.912473 val: 0.792958 test: 0.770400
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  14 loss training:  51.357650712132454 Time :  1217
accuracy train: 0.923570 val: 0.788732 test: 0.766179
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  15 loss training:  48.0166297852993 Time :  1228
accuracy train: 0.936699 val: 0.790141 test: 0.768149
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  16 loss training:  44.69592548161745 Time :  1240
accuracy train: 0.937637 val: 0.783099 test: 0.767304
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  17 loss training:  42.000199511647224 Time :  1251
accuracy train: 0.953579 val: 0.788732 test: 0.761958
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  18 loss training:  39.45905451476574 Time :  1262
accuracy train: 0.961082 val: 0.785915 test: 0.764209
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  19 loss training:  37.88568829745054 Time :  1274
accuracy train: 0.967959 val: 0.783099 test: 0.759707
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  20 loss training:  34.39769984036684 Time :  1285
accuracy train: 0.973429 val: 0.777465 test: 0.757738
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  21 loss training:  31.247793406248093 Time :  1298
accuracy train: 0.978743 val: 0.784507 test: 0.761396
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  22 loss training:  29.488271288573742 Time :  1307
accuracy train: 0.982807 val: 0.783099 test: 0.763084
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  23 loss training:  27.77276984229684 Time :  1321
accuracy train: 0.986871 val: 0.783099 test: 0.759707
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  24 loss training:  24.8478629514575 Time :  1330
accuracy train: 0.990153 val: 0.787324 test: 0.765053
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  25 loss training:  23.97297339141369 Time :  1343
accuracy train: 0.992185 val: 0.780282 test: 0.760270
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  26 loss training:  22.024826522916555 Time :  1353
accuracy train: 0.994530 val: 0.781690 test: 0.757175
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  27 loss training:  20.935701245442033 Time :  1364
accuracy train: 0.994686 val: 0.783099 test: 0.758301
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  28 loss training:  17.757889607921243 Time :  1374
accuracy train: 0.996405 val: 0.777465 test: 0.752673
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  29 loss training:  17.477562541142106 Time :  1386
accuracy train: 0.996249 val: 0.771831 test: 0.754643
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  30 loss training:  16.82851905375719 Time :  1396
accuracy train: 0.997656 val: 0.773239 test: 0.762802
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  31 loss training:  14.887226064689457 Time :  1407
accuracy train: 0.997187 val: 0.771831 test: 0.754924
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  32 loss training:  15.366775060072541 Time :  1419
accuracy train: 0.998437 val: 0.767606 test: 0.754361
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  33 loss training:  13.57771160826087 Time :  1430
accuracy train: 0.998906 val: 0.766197 test: 0.755487
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  34 loss training:  11.714277686551213 Time :  1444
accuracy train: 0.998906 val: 0.764789 test: 0.761958
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  35 loss training:  11.389067739248276 Time :  1453
accuracy train: 0.999219 val: 0.773239 test: 0.759989
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  36 loss training:  11.055300840642303 Time :  1467
accuracy train: 0.999531 val: 0.767606 test: 0.755487
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  37 loss training:  10.377680906560272 Time :  1477
accuracy train: 0.999687 val: 0.776056 test: 0.755768
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  38 loss training:  10.437732961960137 Time :  1488
accuracy train: 0.999687 val: 0.781690 test: 0.752954
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  39 loss training:  9.809871884062886 Time :  1498
accuracy train: 0.999844 val: 0.771831 test: 0.752392
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  40 loss training:  9.585184737341478 Time :  1508
accuracy train: 0.999844 val: 0.778873 test: 0.751266
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  41 loss training:  7.872354998253286 Time :  1518
accuracy train: 1.000000 val: 0.774648 test: 0.759989
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  42 loss training:  7.34624671866186 Time :  1528
accuracy train: 0.999687 val: 0.771831 test: 0.756612
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  43 loss training:  6.9564848963636905 Time :  1538
accuracy train: 1.000000 val: 0.770423 test: 0.756612
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

Epoch :  44 loss training:  6.465388212818652 Time :  1545
accuracy train: 1.000000 val: 0.773239 test: 0.761677
max validation accuracy : 0.792958 max acc epoch : 13 test accuracy : 0.770400

========================================================================================================================================================================================================
best acc epoch :  13
validation accuracy :  0.7929577464788733
test accuracy :  0.7703995498030388
last test_accuracy :  0.7616769836803602
second best val :  0.7915492957746478
second best test :  0.7718064153066967
max gap 4
========================================================================================================================================================================================================

(3554, 1400)
itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=965, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.73257780075073 Time :  1625
accuracy train: 0.778056 val: 0.750704 test: 0.758863
max validation accuracy : 0.750704 max acc epoch : 1 test accuracy : 0.758863
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.6010217666626 Time :  1636
accuracy train: 0.796030 val: 0.756338 test: 0.768711
max validation accuracy : 0.756338 max acc epoch : 2 test accuracy : 0.768711
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.74287089705467 Time :  1647
accuracy train: 0.816505 val: 0.764789 test: 0.778841
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.778841
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.42300845682621 Time :  1658
accuracy train: 0.814630 val: 0.761972 test: 0.773495
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.778841
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.81328156590462 Time :  1668
accuracy train: 0.838231 val: 0.767606 test: 0.773213
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.773213
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  69.75306451320648 Time :  1680
accuracy train: 0.845577 val: 0.761972 test: 0.777997
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.773213
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  65.72988018393517 Time :  1690
accuracy train: 0.860425 val: 0.767606 test: 0.777715
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.773213
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.8659037053585 Time :  1701
accuracy train: 0.860581 val: 0.761972 test: 0.769837
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.773213
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.83352488279343 Time :  1711
accuracy train: 0.869022 val: 0.787324 test: 0.768993
max validation accuracy : 0.787324 max acc epoch : 9 test accuracy : 0.768993
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.84299559891224 Time :  1722
accuracy train: 0.880119 val: 0.783099 test: 0.778841
max validation accuracy : 0.787324 max acc epoch : 9 test accuracy : 0.768993

Epoch :  11 loss training:  60.166737496852875 Time :  1733
accuracy train: 0.887777 val: 0.780282 test: 0.770681
max validation accuracy : 0.787324 max acc epoch : 9 test accuracy : 0.768993

Epoch :  12 loss training:  58.019462659955025 Time :  1744
accuracy train: 0.900438 val: 0.787324 test: 0.773776
max validation accuracy : 0.787324 max acc epoch : 9 test accuracy : 0.768993

Epoch :  13 loss training:  55.1748943477869 Time :  1755
accuracy train: 0.911379 val: 0.780282 test: 0.776871
max validation accuracy : 0.787324 max acc epoch : 9 test accuracy : 0.768993

Epoch :  14 loss training:  51.74493916332722 Time :  1764
accuracy train: 0.925133 val: 0.780282 test: 0.776590
max validation accuracy : 0.787324 max acc epoch : 9 test accuracy : 0.768993

Epoch :  15 loss training:  48.165008544921875 Time :  1776
accuracy train: 0.931385 val: 0.788732 test: 0.776308
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  16 loss training:  45.49251548200846 Time :  1786
accuracy train: 0.934980 val: 0.788732 test: 0.773213
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  17 loss training:  42.626171350479126 Time :  1798
accuracy train: 0.951078 val: 0.781690 test: 0.771244
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  18 loss training:  39.73636168241501 Time :  1809
accuracy train: 0.955611 val: 0.780282 test: 0.767023
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  19 loss training:  37.77624259144068 Time :  1820
accuracy train: 0.967334 val: 0.774648 test: 0.766742
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  20 loss training:  33.98301928117871 Time :  1827
accuracy train: 0.970616 val: 0.778873 test: 0.766742
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  21 loss training:  31.03018930181861 Time :  1834
accuracy train: 0.976399 val: 0.773239 test: 0.761396
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  22 loss training:  29.444433566182852 Time :  1845
accuracy train: 0.979369 val: 0.777465 test: 0.766460
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  23 loss training:  28.102295868098736 Time :  1855
accuracy train: 0.985308 val: 0.783099 test: 0.767023
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  24 loss training:  24.922452189028263 Time :  1866
accuracy train: 0.987496 val: 0.788732 test: 0.766742
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  25 loss training:  24.161532759666443 Time :  1876
accuracy train: 0.991404 val: 0.780282 test: 0.767586
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  26 loss training:  22.590132601559162 Time :  1886
accuracy train: 0.991716 val: 0.774648 test: 0.761396
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  27 loss training:  21.362514432519674 Time :  1898
accuracy train: 0.995624 val: 0.780282 test: 0.764772
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  28 loss training:  17.92207084223628 Time :  1908
accuracy train: 0.996561 val: 0.783099 test: 0.763084
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  29 loss training:  16.519400504417717 Time :  1919
accuracy train: 0.996405 val: 0.770423 test: 0.767304
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  30 loss training:  16.088579551316798 Time :  1929
accuracy train: 0.997499 val: 0.771831 test: 0.762802
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  31 loss training:  15.014283700846136 Time :  1939
accuracy train: 0.997656 val: 0.774648 test: 0.764491
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  32 loss training:  14.67379737040028 Time :  1948
accuracy train: 0.998750 val: 0.773239 test: 0.762802
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  33 loss training:  13.576402569189668 Time :  1960
accuracy train: 0.998750 val: 0.766197 test: 0.763928
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  34 loss training:  12.058689154684544 Time :  1972
accuracy train: 0.999531 val: 0.763380 test: 0.765335
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  35 loss training:  11.67219107504934 Time :  1979
accuracy train: 0.999531 val: 0.770423 test: 0.760833
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  36 loss training:  11.086709002032876 Time :  1991
accuracy train: 0.999687 val: 0.771831 test: 0.756612
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  37 loss training:  10.232453973498195 Time :  2001
accuracy train: 0.999531 val: 0.774648 test: 0.764772
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  38 loss training:  10.429490540642291 Time :  2012
accuracy train: 0.999531 val: 0.780282 test: 0.763084
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  39 loss training:  9.403286078479141 Time :  2020
accuracy train: 1.000000 val: 0.773239 test: 0.763647
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  40 loss training:  9.485342089086771 Time :  2027
accuracy train: 0.999219 val: 0.774648 test: 0.760270
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  41 loss training:  7.761072295717895 Time :  2039
accuracy train: 0.999844 val: 0.766197 test: 0.767867
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  42 loss training:  7.497332254191861 Time :  2049
accuracy train: 1.000000 val: 0.767606 test: 0.762521
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  43 loss training:  6.934054889716208 Time :  2061
accuracy train: 1.000000 val: 0.759155 test: 0.763365
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  44 loss training:  6.334119704551995 Time :  2070
accuracy train: 1.000000 val: 0.769014 test: 0.763928
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  45 loss training:  6.470469670253806 Time :  2082
accuracy train: 1.000000 val: 0.764789 test: 0.759145
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

Epoch :  46 loss training:  7.050230483757332 Time :  2092
accuracy train: 1.000000 val: 0.756338 test: 0.763928
max validation accuracy : 0.788732 max acc epoch : 15 test accuracy : 0.776308

========================================================================================================================================================================================================
best acc epoch :  15
validation accuracy :  0.7887323943661971
test accuracy :  0.7763083849184018
last test_accuracy :  0.7639279684862127
second best val :  0.7873239436619718
second best test :  0.768992684299381
max gap 6
========================================================================================================================================================================================================

(3554, 1400)
itr : 4
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=965, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.93020737171173 Time :  2176
accuracy train: 0.780869 val: 0.754930 test: 0.762521
max validation accuracy : 0.754930 max acc epoch : 1 test accuracy : 0.762521
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.27157996594906 Time :  2185
accuracy train: 0.798531 val: 0.760563 test: 0.766742
max validation accuracy : 0.760563 max acc epoch : 2 test accuracy : 0.766742
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.14017045497894 Time :  2196
accuracy train: 0.814630 val: 0.767606 test: 0.776871
max validation accuracy : 0.767606 max acc epoch : 3 test accuracy : 0.776871
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.19902232289314 Time :  2205
accuracy train: 0.820413 val: 0.769014 test: 0.771244
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.771244
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.5238883793354 Time :  2215
accuracy train: 0.838543 val: 0.761972 test: 0.770400
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.771244
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  69.88866086304188 Time :  2227
accuracy train: 0.848546 val: 0.773239 test: 0.774902
max validation accuracy : 0.773239 max acc epoch : 6 test accuracy : 0.774902
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  65.7946765422821 Time :  2237
accuracy train: 0.858862 val: 0.780282 test: 0.764772
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.764772
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.55617126822472 Time :  2249
accuracy train: 0.861519 val: 0.764789 test: 0.764772
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.764772
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.35777911543846 Time :  2258
accuracy train: 0.871053 val: 0.790141 test: 0.767586
max validation accuracy : 0.790141 max acc epoch : 9 test accuracy : 0.767586
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.9901315420866 Time :  2269
accuracy train: 0.879962 val: 0.788732 test: 0.770681
max validation accuracy : 0.790141 max acc epoch : 9 test accuracy : 0.767586

Epoch :  11 loss training:  59.86625450849533 Time :  2279
accuracy train: 0.888872 val: 0.783099 test: 0.768711
max validation accuracy : 0.790141 max acc epoch : 9 test accuracy : 0.767586

Epoch :  12 loss training:  57.7177472114563 Time :  2289
accuracy train: 0.901063 val: 0.794366 test: 0.766460
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  13 loss training:  55.337459310889244 Time :  2299
accuracy train: 0.917162 val: 0.792958 test: 0.769555
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  14 loss training:  51.52258199453354 Time :  2306
accuracy train: 0.925445 val: 0.794366 test: 0.766742
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  15 loss training:  47.585267931222916 Time :  2313
accuracy train: 0.934042 val: 0.794366 test: 0.770118
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  16 loss training:  45.679283298552036 Time :  2325
accuracy train: 0.941544 val: 0.791549 test: 0.766742
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  17 loss training:  42.7753596380353 Time :  2335
accuracy train: 0.952016 val: 0.788732 test: 0.767304
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  18 loss training:  39.180385425686836 Time :  2345
accuracy train: 0.958268 val: 0.791549 test: 0.758301
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  19 loss training:  37.526690408587456 Time :  2355
accuracy train: 0.966239 val: 0.787324 test: 0.760833
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  20 loss training:  33.704569183290005 Time :  2365
accuracy train: 0.974211 val: 0.785915 test: 0.760833
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  21 loss training:  31.110774997621775 Time :  2376
accuracy train: 0.978743 val: 0.781690 test: 0.753799
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  22 loss training:  28.868585474789143 Time :  2386
accuracy train: 0.982651 val: 0.778873 test: 0.762240
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  23 loss training:  28.19634287059307 Time :  2398
accuracy train: 0.986246 val: 0.780282 test: 0.758301
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  24 loss training:  24.64957658946514 Time :  2408
accuracy train: 0.991091 val: 0.776056 test: 0.756894
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  25 loss training:  23.967051645740867 Time :  2418
accuracy train: 0.992654 val: 0.780282 test: 0.756331
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  26 loss training:  21.855850322172046 Time :  2430
accuracy train: 0.992810 val: 0.785915 test: 0.754080
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  27 loss training:  20.82354101166129 Time :  2440
accuracy train: 0.994530 val: 0.788732 test: 0.754080
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  28 loss training:  17.06036888435483 Time :  2452
accuracy train: 0.996249 val: 0.784507 test: 0.752954
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  29 loss training:  16.78631506115198 Time :  2461
accuracy train: 0.996718 val: 0.777465 test: 0.758019
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  30 loss training:  16.964204425923526 Time :  2474
accuracy train: 0.997656 val: 0.776056 test: 0.755205
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  31 loss training:  14.815673145465553 Time :  2484
accuracy train: 0.997968 val: 0.783099 test: 0.754924
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  32 loss training:  15.47179314121604 Time :  2496
accuracy train: 0.998437 val: 0.781690 test: 0.756331
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  33 loss training:  13.488952938467264 Time :  2508
accuracy train: 0.999375 val: 0.780282 test: 0.755205
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  34 loss training:  11.62207620870322 Time :  2517
accuracy train: 0.999062 val: 0.767606 test: 0.751548
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  35 loss training:  11.532141082920134 Time :  2531
accuracy train: 0.999375 val: 0.780282 test: 0.756331
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  36 loss training:  11.267724212259054 Time :  2541
accuracy train: 0.999531 val: 0.776056 test: 0.752110
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  37 loss training:  10.604225739836693 Time :  2553
accuracy train: 0.999844 val: 0.783099 test: 0.758301
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  38 loss training:  9.63405632134527 Time :  2564
accuracy train: 1.000000 val: 0.781690 test: 0.753517
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  39 loss training:  10.104666359722614 Time :  2574
accuracy train: 1.000000 val: 0.784507 test: 0.759707
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  40 loss training:  9.660417617298663 Time :  2586
accuracy train: 0.999844 val: 0.777465 test: 0.753236
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  41 loss training:  7.880076365079731 Time :  2596
accuracy train: 0.999844 val: 0.784507 test: 0.757456
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  42 loss training:  7.203058937564492 Time :  2610
accuracy train: 0.999844 val: 0.784507 test: 0.761114
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

Epoch :  43 loss training:  6.81351370876655 Time :  2620
accuracy train: 1.000000 val: 0.794366 test: 0.752954
max validation accuracy : 0.794366 max acc epoch : 12 test accuracy : 0.766460

========================================================================================================================================================================================================
best acc epoch :  12
validation accuracy :  0.7943661971830986
test accuracy :  0.7664603263927968
last test_accuracy :  0.7529544175576814
second best val :  0.7929577464788733
second best test :  0.7664603263927968
max gap 3
========================================================================================================================================================================================================

(3554, 1400)
itr : 5
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=965, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.87146154046059 Time :  2717
accuracy train: 0.777587 val: 0.756338 test: 0.761958
max validation accuracy : 0.756338 max acc epoch : 1 test accuracy : 0.761958
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.28666397929192 Time :  2726
accuracy train: 0.794780 val: 0.760563 test: 0.767867
max validation accuracy : 0.760563 max acc epoch : 2 test accuracy : 0.767867
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.76961487531662 Time :  2738
accuracy train: 0.815411 val: 0.760563 test: 0.774620
max validation accuracy : 0.760563 max acc epoch : 2 test accuracy : 0.767867
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.03615003824234 Time :  2748
accuracy train: 0.818224 val: 0.763380 test: 0.775746
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.775746
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.62441807985306 Time :  2759
accuracy train: 0.836980 val: 0.769014 test: 0.773776
max validation accuracy : 0.769014 max acc epoch : 5 test accuracy : 0.773776
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.09192453324795 Time :  2770
accuracy train: 0.839794 val: 0.771831 test: 0.774902
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.774902
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.20794609189034 Time :  2779
accuracy train: 0.857455 val: 0.761972 test: 0.778559
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.774902
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.8658687621355 Time :  2791
accuracy train: 0.860269 val: 0.763380 test: 0.769555
max validation accuracy : 0.771831 max acc epoch : 6 test accuracy : 0.774902
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.12851326167583 Time :  2801
accuracy train: 0.870116 val: 0.787324 test: 0.770962
max validation accuracy : 0.787324 max acc epoch : 9 test accuracy : 0.770962
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.01117239892483 Time :  2811
accuracy train: 0.875742 val: 0.774648 test: 0.772932
max validation accuracy : 0.787324 max acc epoch : 9 test accuracy : 0.770962

Epoch :  11 loss training:  60.41300672292709 Time :  2821
accuracy train: 0.886996 val: 0.780282 test: 0.771525
max validation accuracy : 0.787324 max acc epoch : 9 test accuracy : 0.770962

Epoch :  12 loss training:  58.10684145987034 Time :  2832
accuracy train: 0.898406 val: 0.780282 test: 0.768430
max validation accuracy : 0.787324 max acc epoch : 9 test accuracy : 0.770962

Epoch :  13 loss training:  55.33421178162098 Time :  2843
accuracy train: 0.908721 val: 0.784507 test: 0.773776
max validation accuracy : 0.787324 max acc epoch : 9 test accuracy : 0.770962

Epoch :  14 loss training:  51.930489748716354 Time :  2852
accuracy train: 0.919193 val: 0.787324 test: 0.770118
max validation accuracy : 0.787324 max acc epoch : 9 test accuracy : 0.770962

Epoch :  15 loss training:  48.7815378010273 Time :  2864
accuracy train: 0.927634 val: 0.797183 test: 0.777434
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  16 loss training:  46.4465257525444 Time :  2875
accuracy train: 0.934980 val: 0.797183 test: 0.777715
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  17 loss training:  43.343339174985886 Time :  2889
accuracy train: 0.945139 val: 0.790141 test: 0.770962
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  18 loss training:  39.78235790133476 Time :  2898
accuracy train: 0.953423 val: 0.787324 test: 0.766742
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  19 loss training:  38.60780989378691 Time :  2907
accuracy train: 0.960925 val: 0.781690 test: 0.766179
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  20 loss training:  34.80547300353646 Time :  2918
accuracy train: 0.968897 val: 0.781690 test: 0.761396
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  21 loss training:  31.868305172771215 Time :  2925
accuracy train: 0.975305 val: 0.783099 test: 0.758301
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  22 loss training:  30.98745572566986 Time :  2934
accuracy train: 0.978743 val: 0.783099 test: 0.763647
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  23 loss training:  28.560299586504698 Time :  2946
accuracy train: 0.983432 val: 0.776056 test: 0.757738
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  24 loss training:  25.65499598532915 Time :  2956
accuracy train: 0.987965 val: 0.770423 test: 0.763928
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  25 loss training:  24.733067832887173 Time :  2969
accuracy train: 0.989059 val: 0.776056 test: 0.758019
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  26 loss training:  23.057145677506924 Time :  2979
accuracy train: 0.991247 val: 0.781690 test: 0.760833
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  27 loss training:  21.40768182836473 Time :  2990
accuracy train: 0.994217 val: 0.774648 test: 0.758019
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  28 loss training:  18.821027820929885 Time :  3001
accuracy train: 0.994686 val: 0.776056 test: 0.757738
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  29 loss training:  17.32432647794485 Time :  3011
accuracy train: 0.995780 val: 0.771831 test: 0.753517
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  30 loss training:  16.94295840896666 Time :  3023
accuracy train: 0.994998 val: 0.770423 test: 0.766460
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  31 loss training:  15.366592428646982 Time :  3033
accuracy train: 0.995936 val: 0.770423 test: 0.756894
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  32 loss training:  15.611962290480733 Time :  3044
accuracy train: 0.998437 val: 0.767606 test: 0.755768
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  33 loss training:  13.745891530998051 Time :  3052
accuracy train: 0.998437 val: 0.774648 test: 0.752954
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  34 loss training:  12.348061714321375 Time :  3062
accuracy train: 0.998906 val: 0.767606 test: 0.755768
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  35 loss training:  11.47387811075896 Time :  3074
accuracy train: 0.999375 val: 0.774648 test: 0.752110
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  36 loss training:  12.230191177222878 Time :  3084
accuracy train: 0.999062 val: 0.776056 test: 0.753799
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  37 loss training:  10.241482889279723 Time :  3095
accuracy train: 0.999531 val: 0.787324 test: 0.758019
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  38 loss training:  10.60963493771851 Time :  3105
accuracy train: 0.999844 val: 0.781690 test: 0.754924
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  39 loss training:  9.978091379161924 Time :  3115
accuracy train: 0.999844 val: 0.790141 test: 0.750422
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  40 loss training:  9.989948444999754 Time :  3127
accuracy train: 0.999844 val: 0.780282 test: 0.756894
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  41 loss training:  7.916654486209154 Time :  3136
accuracy train: 0.999844 val: 0.777465 test: 0.754643
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  42 loss training:  7.950824669096619 Time :  3147
accuracy train: 1.000000 val: 0.776056 test: 0.752673
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  43 loss training:  6.979115664027631 Time :  3157
accuracy train: 1.000000 val: 0.761972 test: 0.750422
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  44 loss training:  6.680020567961037 Time :  3168
accuracy train: 1.000000 val: 0.777465 test: 0.756612
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  45 loss training:  6.513557229191065 Time :  3181
accuracy train: 1.000000 val: 0.780282 test: 0.752673
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

Epoch :  46 loss training:  7.454433193197474 Time :  3191
accuracy train: 0.999844 val: 0.763380 test: 0.751266
max validation accuracy : 0.797183 max acc epoch : 15 test accuracy : 0.777434

========================================================================================================================================================================================================
best acc epoch :  15
validation accuracy :  0.7971830985915493
test accuracy :  0.7774338773213281
last test_accuracy :  0.7512661789532921
second best val :  0.7901408450704225
second best test :  0.7774338773213281
max gap 6
========================================================================================================================================================================================================

(3554, 1400)
itr : 6
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=965, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  92.02262192964554 Time :  3281
accuracy train: 0.780088 val: 0.761972 test: 0.766742
max validation accuracy : 0.761972 max acc epoch : 1 test accuracy : 0.766742
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.37184983491898 Time :  3293
accuracy train: 0.796655 val: 0.749296 test: 0.774339
max validation accuracy : 0.761972 max acc epoch : 1 test accuracy : 0.766742
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.22288066148758 Time :  3308
accuracy train: 0.812441 val: 0.766197 test: 0.774339
max validation accuracy : 0.766197 max acc epoch : 3 test accuracy : 0.774339
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.96109503507614 Time :  3318
accuracy train: 0.820882 val: 0.769014 test: 0.774620
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.774620
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.22037687897682 Time :  3332
accuracy train: 0.841669 val: 0.771831 test: 0.776027
max validation accuracy : 0.771831 max acc epoch : 5 test accuracy : 0.776027
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  69.73765662312508 Time :  3341
accuracy train: 0.851829 val: 0.769014 test: 0.777153
max validation accuracy : 0.771831 max acc epoch : 5 test accuracy : 0.776027
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  65.48654855787754 Time :  3355
accuracy train: 0.860894 val: 0.773239 test: 0.774339
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774339
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  63.673620000481606 Time :  3365
accuracy train: 0.859331 val: 0.766197 test: 0.763084
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.774339
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.293180868029594 Time :  3372
accuracy train: 0.874805 val: 0.790141 test: 0.766742
max validation accuracy : 0.790141 max acc epoch : 9 test accuracy : 0.766742
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.505475744605064 Time :  3386
accuracy train: 0.881369 val: 0.785915 test: 0.765898
max validation accuracy : 0.790141 max acc epoch : 9 test accuracy : 0.766742

Epoch :  11 loss training:  59.91908414661884 Time :  3397
accuracy train: 0.893560 val: 0.791549 test: 0.767023
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.767023

Epoch :  12 loss training:  57.8810900747776 Time :  3410
accuracy train: 0.901219 val: 0.790141 test: 0.768149
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.767023

Epoch :  13 loss training:  54.12743964791298 Time :  3420
accuracy train: 0.915442 val: 0.787324 test: 0.764772
max validation accuracy : 0.791549 max acc epoch : 11 test accuracy : 0.767023

Epoch :  14 loss training:  51.392545118927956 Time :  3432
accuracy train: 0.925133 val: 0.795775 test: 0.763647
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  15 loss training:  48.4044343829155 Time :  3444
accuracy train: 0.931854 val: 0.794366 test: 0.773495
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  16 loss training:  45.54217863827944 Time :  3454
accuracy train: 0.941701 val: 0.791549 test: 0.766742
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  17 loss training:  42.72976750135422 Time :  3466
accuracy train: 0.952798 val: 0.783099 test: 0.765616
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  18 loss training:  39.68931517750025 Time :  3475
accuracy train: 0.958581 val: 0.778873 test: 0.762240
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  19 loss training:  37.998342379927635 Time :  3487
accuracy train: 0.965145 val: 0.778873 test: 0.761114
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  20 loss training:  34.13053284585476 Time :  3500
accuracy train: 0.969522 val: 0.783099 test: 0.762521
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  21 loss training:  30.978682450950146 Time :  3511
accuracy train: 0.975930 val: 0.781690 test: 0.761677
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  22 loss training:  28.991248704493046 Time :  3523
accuracy train: 0.977806 val: 0.774648 test: 0.760833
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  23 loss training:  28.9348301962018 Time :  3534
accuracy train: 0.985777 val: 0.784507 test: 0.759145
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  24 loss training:  25.010337848216295 Time :  3547
accuracy train: 0.988903 val: 0.783099 test: 0.764772
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  25 loss training:  24.23063080199063 Time :  3557
accuracy train: 0.990466 val: 0.780282 test: 0.759426
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  26 loss training:  22.732117105275393 Time :  3569
accuracy train: 0.993748 val: 0.771831 test: 0.763084
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  27 loss training:  20.646361077204347 Time :  3578
accuracy train: 0.993748 val: 0.774648 test: 0.756612
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  28 loss training:  18.159664625301957 Time :  3591
accuracy train: 0.994842 val: 0.774648 test: 0.756331
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  29 loss training:  17.478895001113415 Time :  3602
accuracy train: 0.996718 val: 0.776056 test: 0.764491
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  30 loss training:  16.941750958561897 Time :  3613
accuracy train: 0.997656 val: 0.770423 test: 0.768430
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  31 loss training:  15.310469334945083 Time :  3627
accuracy train: 0.997656 val: 0.764789 test: 0.757175
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  32 loss training:  15.187352895736694 Time :  3638
accuracy train: 0.998124 val: 0.760563 test: 0.752673
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  33 loss training:  12.807821344584227 Time :  3650
accuracy train: 0.999062 val: 0.754930 test: 0.759426
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  34 loss training:  12.086535681039095 Time :  3660
accuracy train: 0.998906 val: 0.777465 test: 0.756050
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  35 loss training:  11.12731750914827 Time :  3673
accuracy train: 0.999219 val: 0.770423 test: 0.758582
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  36 loss training:  11.823262366000563 Time :  3683
accuracy train: 0.999375 val: 0.767606 test: 0.762240
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  37 loss training:  10.152203714940697 Time :  3695
accuracy train: 0.999531 val: 0.767606 test: 0.765898
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  38 loss training:  10.498274196521379 Time :  3706
accuracy train: 0.999375 val: 0.764789 test: 0.763365
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  39 loss training:  9.492655829293653 Time :  3715
accuracy train: 0.999687 val: 0.771831 test: 0.758301
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  40 loss training:  9.289351802086458 Time :  3727
accuracy train: 0.999531 val: 0.771831 test: 0.759989
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  41 loss training:  7.8926877793855965 Time :  3738
accuracy train: 1.000000 val: 0.774648 test: 0.766742
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  42 loss training:  7.810932112857699 Time :  3751
accuracy train: 1.000000 val: 0.771831 test: 0.763365
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  43 loss training:  6.855695372913033 Time :  3761
accuracy train: 0.999844 val: 0.771831 test: 0.765616
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  44 loss training:  6.367596005322412 Time :  3773
accuracy train: 0.999844 val: 0.769014 test: 0.759707
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

Epoch :  45 loss training:  6.17470143083483 Time :  3786
accuracy train: 1.000000 val: 0.769014 test: 0.757738
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.763647

========================================================================================================================================================================================================
best acc epoch :  14
validation accuracy :  0.795774647887324
test accuracy :  0.7636465953854812
last test_accuracy :  0.7577377602701182
second best val :  0.7943661971830986
second best test :  0.7636465953854812
max gap 3
========================================================================================================================================================================================================

(3554, 1400)
itr : 7
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=965, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.76182514429092 Time :  3903
accuracy train: 0.777587 val: 0.753521 test: 0.764491
max validation accuracy : 0.753521 max acc epoch : 1 test accuracy : 0.764491
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.70124369859695 Time :  3914
accuracy train: 0.795561 val: 0.753521 test: 0.766742
max validation accuracy : 0.753521 max acc epoch : 1 test accuracy : 0.764491
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.11030948162079 Time :  3926
accuracy train: 0.825102 val: 0.766197 test: 0.771806
max validation accuracy : 0.766197 max acc epoch : 3 test accuracy : 0.771806
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.71018722653389 Time :  3936
accuracy train: 0.825102 val: 0.774648 test: 0.775746
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.775746
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.76711177825928 Time :  3950
accuracy train: 0.839794 val: 0.764789 test: 0.767586
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.775746
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  69.3171176314354 Time :  3957
accuracy train: 0.847452 val: 0.771831 test: 0.774057
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.775746
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  65.40625581145287 Time :  3964
accuracy train: 0.859956 val: 0.769014 test: 0.773213
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.775746
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.11788915097713 Time :  3977
accuracy train: 0.860581 val: 0.764789 test: 0.760833
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.775746
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.64164352416992 Time :  3986
accuracy train: 0.876211 val: 0.776056 test: 0.766742
max validation accuracy : 0.776056 max acc epoch : 9 test accuracy : 0.766742
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.147867292165756 Time :  3998
accuracy train: 0.882932 val: 0.777465 test: 0.765616
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.765616

Epoch :  11 loss training:  59.13315263390541 Time :  4010
accuracy train: 0.894811 val: 0.777465 test: 0.765335
max validation accuracy : 0.777465 max acc epoch : 10 test accuracy : 0.765616

Epoch :  12 loss training:  57.18226054310799 Time :  4021
accuracy train: 0.903251 val: 0.780282 test: 0.761396
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.761396

Epoch :  13 loss training:  54.4832474142313 Time :  4029
accuracy train: 0.916068 val: 0.785915 test: 0.767023
max validation accuracy : 0.785915 max acc epoch : 13 test accuracy : 0.767023

Epoch :  14 loss training:  51.07972572743893 Time :  4037
accuracy train: 0.925289 val: 0.780282 test: 0.763365
max validation accuracy : 0.785915 max acc epoch : 13 test accuracy : 0.767023

Epoch :  15 loss training:  47.476487919688225 Time :  4047
accuracy train: 0.934042 val: 0.777465 test: 0.766742
max validation accuracy : 0.785915 max acc epoch : 13 test accuracy : 0.767023

Epoch :  16 loss training:  44.722926169633865 Time :  4057
accuracy train: 0.944201 val: 0.781690 test: 0.762240
max validation accuracy : 0.785915 max acc epoch : 13 test accuracy : 0.767023

Epoch :  17 loss training:  42.06620581448078 Time :  4067
accuracy train: 0.950766 val: 0.778873 test: 0.760551
max validation accuracy : 0.785915 max acc epoch : 13 test accuracy : 0.767023

Epoch :  18 loss training:  38.7885901927948 Time :  4077
accuracy train: 0.959206 val: 0.776056 test: 0.760270
max validation accuracy : 0.785915 max acc epoch : 13 test accuracy : 0.767023

Epoch :  19 loss training:  36.93310574442148 Time :  4087
accuracy train: 0.964989 val: 0.770423 test: 0.756894
max validation accuracy : 0.785915 max acc epoch : 13 test accuracy : 0.767023

Epoch :  20 loss training:  33.88424690812826 Time :  4097
accuracy train: 0.972023 val: 0.776056 test: 0.761396
max validation accuracy : 0.785915 max acc epoch : 13 test accuracy : 0.767023

Epoch :  21 loss training:  30.34912469238043 Time :  4111
accuracy train: 0.976243 val: 0.770423 test: 0.758019
max validation accuracy : 0.785915 max acc epoch : 13 test accuracy : 0.767023

Epoch :  22 loss training:  29.32137429341674 Time :  4121
accuracy train: 0.982182 val: 0.783099 test: 0.760551
max validation accuracy : 0.785915 max acc epoch : 13 test accuracy : 0.767023

Epoch :  23 loss training:  27.30949328094721 Time :  4132
accuracy train: 0.986871 val: 0.788732 test: 0.758019
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  24 loss training:  24.481248769909143 Time :  4144
accuracy train: 0.989684 val: 0.781690 test: 0.760551
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  25 loss training:  23.68829818814993 Time :  4152
accuracy train: 0.991091 val: 0.771831 test: 0.754361
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  26 loss training:  21.852198291569948 Time :  4164
accuracy train: 0.994061 val: 0.781690 test: 0.760270
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  27 loss training:  20.00757778249681 Time :  4175
accuracy train: 0.995780 val: 0.777465 test: 0.757175
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  28 loss training:  17.851468728855252 Time :  4186
accuracy train: 0.995311 val: 0.764789 test: 0.750985
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  29 loss training:  16.83925662189722 Time :  4198
accuracy train: 0.996405 val: 0.774648 test: 0.755768
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  30 loss training:  16.464797316119075 Time :  4208
accuracy train: 0.997343 val: 0.788732 test: 0.764772
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  31 loss training:  15.032111684791744 Time :  4220
accuracy train: 0.998281 val: 0.777465 test: 0.756331
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  32 loss training:  15.337687420658767 Time :  4230
accuracy train: 0.999062 val: 0.777465 test: 0.753799
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  33 loss training:  13.61954152956605 Time :  4243
accuracy train: 0.998906 val: 0.771831 test: 0.750141
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  34 loss training:  12.547358892858028 Time :  4254
accuracy train: 0.999219 val: 0.771831 test: 0.751829
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  35 loss training:  11.58418298792094 Time :  4265
accuracy train: 0.999375 val: 0.770423 test: 0.752954
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  36 loss training:  12.275811560451984 Time :  4279
accuracy train: 0.999375 val: 0.780282 test: 0.754080
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  37 loss training:  10.489954438991845 Time :  4290
accuracy train: 0.999375 val: 0.781690 test: 0.756894
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  38 loss training:  10.449045710032806 Time :  4304
accuracy train: 0.999844 val: 0.784507 test: 0.754924
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  39 loss training:  9.572383961640298 Time :  4314
accuracy train: 0.999687 val: 0.774648 test: 0.756331
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  40 loss training:  9.252061641775072 Time :  4328
accuracy train: 0.999375 val: 0.778873 test: 0.756894
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  41 loss training:  8.218009650241584 Time :  4338
accuracy train: 1.000000 val: 0.784507 test: 0.758301
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  42 loss training:  7.407399624818936 Time :  4351
accuracy train: 1.000000 val: 0.780282 test: 0.759426
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  43 loss training:  7.244373058434576 Time :  4364
accuracy train: 1.000000 val: 0.788732 test: 0.756894
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  44 loss training:  6.354318474652246 Time :  4372
accuracy train: 1.000000 val: 0.781690 test: 0.758019
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  45 loss training:  6.151134122861549 Time :  4387
accuracy train: 1.000000 val: 0.783099 test: 0.749015
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  46 loss training:  6.565718804486096 Time :  4395
accuracy train: 1.000000 val: 0.770423 test: 0.760833
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  47 loss training:  6.770724647212774 Time :  4406
accuracy train: 1.000000 val: 0.761972 test: 0.758582
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  48 loss training:  5.943126398953609 Time :  4418
accuracy train: 1.000000 val: 0.778873 test: 0.755768
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  49 loss training:  6.134068598563317 Time :  4429
accuracy train: 1.000000 val: 0.771831 test: 0.754080
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  50 loss training:  4.642649938235991 Time :  4443
accuracy train: 1.000000 val: 0.769014 test: 0.763084
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  51 loss training:  5.126067394972779 Time :  4452
accuracy train: 1.000000 val: 0.773239 test: 0.753799
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  52 loss training:  5.155813958786894 Time :  4465
accuracy train: 1.000000 val: 0.763380 test: 0.756050
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  53 loss training:  4.695756839995738 Time :  4476
accuracy train: 1.000000 val: 0.774648 test: 0.754643
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

Epoch :  54 loss training:  4.818093571811914 Time :  4486
accuracy train: 1.000000 val: 0.777465 test: 0.756894
max validation accuracy : 0.788732 max acc epoch : 23 test accuracy : 0.758019

========================================================================================================================================================================================================
best acc epoch :  23
validation accuracy :  0.7887323943661971
test accuracy :  0.7580191333708497
last test_accuracy :  0.7568936409679234
second best val :  0.7859154929577464
second best test :  0.76702307259426
max gap 10
========================================================================================================================================================================================================

(3554, 1400)
itr : 8
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=965, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.7659563422203 Time :  4583
accuracy train: 0.779775 val: 0.747887 test: 0.763647
max validation accuracy : 0.747887 max acc epoch : 1 test accuracy : 0.763647
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.50391374528408 Time :  4595
accuracy train: 0.790091 val: 0.752113 test: 0.765053
max validation accuracy : 0.752113 max acc epoch : 2 test accuracy : 0.765053
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.66505202651024 Time :  4605
accuracy train: 0.813535 val: 0.760563 test: 0.776590
max validation accuracy : 0.760563 max acc epoch : 3 test accuracy : 0.776590
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.4532960653305 Time :  4620
accuracy train: 0.819162 val: 0.766197 test: 0.770400
max validation accuracy : 0.766197 max acc epoch : 4 test accuracy : 0.770400
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.92756915092468 Time :  4630
accuracy train: 0.839794 val: 0.760563 test: 0.770681
max validation accuracy : 0.766197 max acc epoch : 4 test accuracy : 0.770400
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  69.99837066233158 Time :  4641
accuracy train: 0.846046 val: 0.773239 test: 0.774902
max validation accuracy : 0.773239 max acc epoch : 6 test accuracy : 0.774902
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.2854064553976 Time :  4654
accuracy train: 0.858393 val: 0.767606 test: 0.775746
max validation accuracy : 0.773239 max acc epoch : 6 test accuracy : 0.774902
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.86128537356853 Time :  4664
accuracy train: 0.855580 val: 0.764789 test: 0.768711
max validation accuracy : 0.773239 max acc epoch : 6 test accuracy : 0.774902
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.11786510050297 Time :  4676
accuracy train: 0.869334 val: 0.784507 test: 0.768711
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.768711
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.153780564665794 Time :  4686
accuracy train: 0.877931 val: 0.778873 test: 0.770962
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.768711

Epoch :  11 loss training:  60.22650322318077 Time :  4700
accuracy train: 0.890747 val: 0.781690 test: 0.766742
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.768711

Epoch :  12 loss training:  58.61341780424118 Time :  4711
accuracy train: 0.895280 val: 0.781690 test: 0.767023
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.768711

Epoch :  13 loss training:  55.03328777849674 Time :  4721
accuracy train: 0.912004 val: 0.788732 test: 0.766460
max validation accuracy : 0.788732 max acc epoch : 13 test accuracy : 0.766460

Epoch :  14 loss training:  51.80770970880985 Time :  4736
accuracy train: 0.924039 val: 0.781690 test: 0.768711
max validation accuracy : 0.788732 max acc epoch : 13 test accuracy : 0.766460

Epoch :  15 loss training:  48.526031613349915 Time :  4745
accuracy train: 0.928884 val: 0.788732 test: 0.764772
max validation accuracy : 0.788732 max acc epoch : 13 test accuracy : 0.766460

Epoch :  16 loss training:  46.05689422786236 Time :  4760
accuracy train: 0.939825 val: 0.791549 test: 0.763647
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  17 loss training:  42.97226209938526 Time :  4770
accuracy train: 0.950297 val: 0.780282 test: 0.761677
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  18 loss training:  39.109937995672226 Time :  4782
accuracy train: 0.957956 val: 0.783099 test: 0.761396
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  19 loss training:  38.06842216849327 Time :  4792
accuracy train: 0.966083 val: 0.777465 test: 0.765616
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  20 loss training:  34.11866330355406 Time :  4805
accuracy train: 0.972023 val: 0.774648 test: 0.761114
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  21 loss training:  31.405321311205626 Time :  4817
accuracy train: 0.976399 val: 0.778873 test: 0.767304
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  22 loss training:  30.075815338641405 Time :  4825
accuracy train: 0.981869 val: 0.777465 test: 0.760551
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  23 loss training:  27.917979929596186 Time :  4838
accuracy train: 0.985777 val: 0.781690 test: 0.760833
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  24 loss training:  24.440741702914238 Time :  4847
accuracy train: 0.990309 val: 0.780282 test: 0.765335
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  25 loss training:  23.9846594594419 Time :  4859
accuracy train: 0.992654 val: 0.774648 test: 0.763365
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  26 loss training:  21.327531293034554 Time :  4869
accuracy train: 0.993279 val: 0.784507 test: 0.763084
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  27 loss training:  20.514858858659863 Time :  4881
accuracy train: 0.994061 val: 0.773239 test: 0.762802
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  28 loss training:  18.59431431442499 Time :  4894
accuracy train: 0.996561 val: 0.766197 test: 0.759145
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  29 loss training:  17.771470088511705 Time :  4903
accuracy train: 0.997499 val: 0.767606 test: 0.763365
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  30 loss training:  16.379005696624517 Time :  4917
accuracy train: 0.997499 val: 0.777465 test: 0.765335
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  31 loss training:  15.350092807784677 Time :  4927
accuracy train: 0.998593 val: 0.776056 test: 0.760551
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  32 loss training:  14.9492007358931 Time :  4936
accuracy train: 0.999062 val: 0.770423 test: 0.757738
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  33 loss training:  12.925009397789836 Time :  4951
accuracy train: 0.999375 val: 0.774648 test: 0.760270
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  34 loss training:  11.875674793496728 Time :  4961
accuracy train: 0.998750 val: 0.761972 test: 0.762802
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  35 loss training:  10.94532982679084 Time :  4973
accuracy train: 0.999375 val: 0.761972 test: 0.759426
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  36 loss training:  11.979488465934992 Time :  4981
accuracy train: 0.999375 val: 0.760563 test: 0.761958
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  37 loss training:  9.77854792540893 Time :  4989
accuracy train: 0.999375 val: 0.757746 test: 0.767023
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  38 loss training:  10.580343743320554 Time :  5002
accuracy train: 0.999531 val: 0.769014 test: 0.763365
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  39 loss training:  9.771042364649475 Time :  5013
accuracy train: 0.999687 val: 0.776056 test: 0.763365
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  40 loss training:  9.055300795705989 Time :  5025
accuracy train: 0.999531 val: 0.771831 test: 0.765053
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  41 loss training:  7.576249926816672 Time :  5036
accuracy train: 0.999844 val: 0.771831 test: 0.765335
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  42 loss training:  7.107313788961619 Time :  5047
accuracy train: 0.999844 val: 0.769014 test: 0.757738
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  43 loss training:  6.802190558053553 Time :  5060
accuracy train: 1.000000 val: 0.769014 test: 0.758863
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  44 loss training:  6.61361595033668 Time :  5070
accuracy train: 1.000000 val: 0.766197 test: 0.767586
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  45 loss training:  6.524807139765471 Time :  5081
accuracy train: 1.000000 val: 0.774648 test: 0.755205
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  46 loss training:  6.744842349085957 Time :  5092
accuracy train: 1.000000 val: 0.760563 test: 0.761114
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

Epoch :  47 loss training:  6.240523121086881 Time :  5104
accuracy train: 0.999844 val: 0.760563 test: 0.760551
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.763647

========================================================================================================================================================================================================
best acc epoch :  16
validation accuracy :  0.7915492957746478
test accuracy :  0.7636465953854812
last test_accuracy :  0.7605514912774338
second best val :  0.7887323943661971
second best test :  0.7664603263927968
max gap 4
========================================================================================================================================================================================================

(3554, 1400)
itr : 9
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=965, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.966731518507 Time :  5207
accuracy train: 0.778056 val: 0.756338 test: 0.766179
max validation accuracy : 0.756338 max acc epoch : 1 test accuracy : 0.766179
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.42383053898811 Time :  5220
accuracy train: 0.800250 val: 0.769014 test: 0.768711
max validation accuracy : 0.769014 max acc epoch : 2 test accuracy : 0.768711
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.31639483571053 Time :  5230
accuracy train: 0.816661 val: 0.759155 test: 0.774339
max validation accuracy : 0.769014 max acc epoch : 2 test accuracy : 0.768711
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.98953841626644 Time :  5242
accuracy train: 0.820256 val: 0.767606 test: 0.772369
max validation accuracy : 0.769014 max acc epoch : 2 test accuracy : 0.768711
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.12358359992504 Time :  5252
accuracy train: 0.836980 val: 0.756338 test: 0.767304
max validation accuracy : 0.769014 max acc epoch : 2 test accuracy : 0.768711
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.02145107090473 Time :  5262
accuracy train: 0.845264 val: 0.778873 test: 0.778841
max validation accuracy : 0.778873 max acc epoch : 6 test accuracy : 0.778841
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  65.40506233274937 Time :  5274
accuracy train: 0.859331 val: 0.770423 test: 0.772651
max validation accuracy : 0.778873 max acc epoch : 6 test accuracy : 0.778841
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.41919828951359 Time :  5283
accuracy train: 0.857768 val: 0.767606 test: 0.766742
max validation accuracy : 0.778873 max acc epoch : 6 test accuracy : 0.778841
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.43421892821789 Time :  5296
accuracy train: 0.870272 val: 0.794366 test: 0.768711
max validation accuracy : 0.794366 max acc epoch : 9 test accuracy : 0.768711
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.0001587420702 Time :  5306
accuracy train: 0.877149 val: 0.790141 test: 0.770681
max validation accuracy : 0.794366 max acc epoch : 9 test accuracy : 0.768711

Epoch :  11 loss training:  59.60266329348087 Time :  5318
accuracy train: 0.892154 val: 0.785915 test: 0.767023
max validation accuracy : 0.794366 max acc epoch : 9 test accuracy : 0.768711

Epoch :  12 loss training:  57.68587313592434 Time :  5328
accuracy train: 0.900594 val: 0.791549 test: 0.770962
max validation accuracy : 0.794366 max acc epoch : 9 test accuracy : 0.768711

Epoch :  13 loss training:  54.61425652354956 Time :  5338
accuracy train: 0.912473 val: 0.801408 test: 0.775183
max validation accuracy : 0.801408 max acc epoch : 13 test accuracy : 0.775183

Epoch :  14 loss training:  51.35970424115658 Time :  5350
accuracy train: 0.924039 val: 0.792958 test: 0.769837
max validation accuracy : 0.801408 max acc epoch : 13 test accuracy : 0.775183

Epoch :  15 loss training:  47.96064308285713 Time :  5360
accuracy train: 0.933260 val: 0.795775 test: 0.770118
max validation accuracy : 0.801408 max acc epoch : 13 test accuracy : 0.775183

Epoch :  16 loss training:  45.38757172226906 Time :  5373
accuracy train: 0.940138 val: 0.808451 test: 0.772932
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  17 loss training:  42.980094119906425 Time :  5382
accuracy train: 0.952329 val: 0.802817 test: 0.769837
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  18 loss training:  38.691472463309765 Time :  5393
accuracy train: 0.959987 val: 0.790141 test: 0.764209
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  19 loss training:  37.829766154289246 Time :  5406
accuracy train: 0.966239 val: 0.794366 test: 0.763084
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  20 loss training:  34.0855730175972 Time :  5417
accuracy train: 0.969678 val: 0.792958 test: 0.768430
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  21 loss training:  30.639821756631136 Time :  5430
accuracy train: 0.980306 val: 0.794366 test: 0.763647
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  22 loss training:  29.12008398771286 Time :  5437
accuracy train: 0.983276 val: 0.794366 test: 0.769274
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  23 loss training:  27.747124578803778 Time :  5446
accuracy train: 0.986715 val: 0.790141 test: 0.764772
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  24 loss training:  24.994795951992273 Time :  5459
accuracy train: 0.989841 val: 0.800000 test: 0.766460
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  25 loss training:  23.900276117026806 Time :  5467
accuracy train: 0.992498 val: 0.787324 test: 0.761396
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  26 loss training:  22.499435923993587 Time :  5478
accuracy train: 0.993748 val: 0.788732 test: 0.768149
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  27 loss training:  21.355347318574786 Time :  5490
accuracy train: 0.995155 val: 0.783099 test: 0.758582
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  28 loss training:  17.9331279322505 Time :  5498
accuracy train: 0.995155 val: 0.781690 test: 0.761677
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  29 loss training:  16.951642993837595 Time :  5513
accuracy train: 0.997030 val: 0.785915 test: 0.760551
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  30 loss training:  16.5911004813388 Time :  5522
accuracy train: 0.997499 val: 0.784507 test: 0.769555
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  31 loss training:  15.18363294005394 Time :  5534
accuracy train: 0.997343 val: 0.780282 test: 0.758301
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  32 loss training:  15.229355480521917 Time :  5548
accuracy train: 0.998593 val: 0.781690 test: 0.760551
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  33 loss training:  13.171728018671274 Time :  5557
accuracy train: 0.999062 val: 0.781690 test: 0.757456
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  34 loss training:  12.243012734688818 Time :  5571
accuracy train: 0.998750 val: 0.764789 test: 0.754924
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  35 loss training:  10.923924315720797 Time :  5581
accuracy train: 0.999531 val: 0.783099 test: 0.762521
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  36 loss training:  11.40906064491719 Time :  5593
accuracy train: 0.999531 val: 0.790141 test: 0.761677
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  37 loss training:  9.697330959141254 Time :  5603
accuracy train: 0.999844 val: 0.776056 test: 0.759707
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  38 loss training:  10.144220665795729 Time :  5614
accuracy train: 0.999687 val: 0.781690 test: 0.758863
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  39 loss training:  9.3808744228445 Time :  5627
accuracy train: 1.000000 val: 0.788732 test: 0.757175
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  40 loss training:  9.433076668996364 Time :  5636
accuracy train: 0.999687 val: 0.785915 test: 0.758301
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  41 loss training:  8.30532045615837 Time :  5650
accuracy train: 1.000000 val: 0.781690 test: 0.762240
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  42 loss training:  7.399790627881885 Time :  5660
accuracy train: 0.999844 val: 0.781690 test: 0.761958
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  43 loss training:  6.933954254724085 Time :  5669
accuracy train: 1.000000 val: 0.774648 test: 0.760551
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  44 loss training:  6.044415686745197 Time :  5679
accuracy train: 1.000000 val: 0.770423 test: 0.756894
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  45 loss training:  5.983461341122165 Time :  5689
accuracy train: 1.000000 val: 0.769014 test: 0.756894
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  46 loss training:  7.381681704660878 Time :  5699
accuracy train: 0.999844 val: 0.776056 test: 0.761114
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

Epoch :  47 loss training:  6.29309703677427 Time :  5709
accuracy train: 0.999844 val: 0.770423 test: 0.765616
max validation accuracy : 0.808451 max acc epoch : 16 test accuracy : 0.772932

========================================================================================================================================================================================================
best acc epoch :  16
validation accuracy :  0.8084507042253521
test accuracy :  0.772931907709623
last test_accuracy :  0.7656162070906022
second best val :  0.8028169014084507
second best test :  0.772931907709623
max gap 4
========================================================================================================================================================================================================

(3554, 1400)
=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  11 	 val_accuracy : 0.80141 	 test_accuracy : 0.76871 	 last test_accuracy : 0.75521 	 second best val : 0.79718 	 second best test : 0.76871
k :  1 	 best_acc epoch :  15 	 val_accuracy : 0.78873 	 test_accuracy : 0.76899 	 last test_accuracy : 0.75830 	 second best val : 0.78592 	 second best test : 0.76899
k :  2 	 best_acc epoch :  13 	 val_accuracy : 0.79296 	 test_accuracy : 0.77040 	 last test_accuracy : 0.76168 	 second best val : 0.79155 	 second best test : 0.77181
k :  3 	 best_acc epoch :  15 	 val_accuracy : 0.78873 	 test_accuracy : 0.77631 	 last test_accuracy : 0.76393 	 second best val : 0.78732 	 second best test : 0.76899
k :  4 	 best_acc epoch :  12 	 val_accuracy : 0.79437 	 test_accuracy : 0.76646 	 last test_accuracy : 0.75295 	 second best val : 0.79296 	 second best test : 0.76646
k :  5 	 best_acc epoch :  15 	 val_accuracy : 0.79718 	 test_accuracy : 0.77743 	 last test_accuracy : 0.75127 	 second best val : 0.79014 	 second best test : 0.77743
k :  6 	 best_acc epoch :  14 	 val_accuracy : 0.79577 	 test_accuracy : 0.76365 	 last test_accuracy : 0.75774 	 second best val : 0.79437 	 second best test : 0.76365
k :  7 	 best_acc epoch :  23 	 val_accuracy : 0.78873 	 test_accuracy : 0.75802 	 last test_accuracy : 0.75689 	 second best val : 0.78592 	 second best test : 0.76702
k :  8 	 best_acc epoch :  16 	 val_accuracy : 0.79155 	 test_accuracy : 0.76365 	 last test_accuracy : 0.76055 	 second best val : 0.78873 	 second best test : 0.76646
k :  9 	 best_acc epoch :  16 	 val_accuracy : 0.80845 	 test_accuracy : 0.77293 	 last test_accuracy : 0.76562 	 second best val : 0.80282 	 second best test : 0.77293

avg :  	 val_accuracy : 0.79479 	 test_accuracy : 0.76866 	 last_accuracy : 0.75841 	 second best val : 0.79169 	 second best test : 0.76925

std :  	 val_accuracy : 0.00601 	 test_accuracy : 0.00570 	 last_accuracy : 0.00438 	 second best val : 0.00510 	 second best test : 0.00373
