

date and time :  Fri Jul  9 11:21:22 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=931, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  39.93668455444276 Time :  12
accuracy train: 0.962432 val: 0.960000 test: 0.955708
max validation accuracy : 0.960000 max acc epoch : 1 test accuracy : 0.955708
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.710332591086626 Time :  22
accuracy train: 0.963038 val: 0.961818 test: 0.962557
max validation accuracy : 0.961818 max acc epoch : 2 test accuracy : 0.962557
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.295290016569197 Time :  32
accuracy train: 0.974147 val: 0.970909 test: 0.962557
max validation accuracy : 0.970909 max acc epoch : 3 test accuracy : 0.962557
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.065453349612653 Time :  43
accuracy train: 0.987073 val: 0.974545 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.968950
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.211119706975296 Time :  54
accuracy train: 0.987477 val: 0.980000 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 5 test accuracy : 0.973516
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  7.956611203029752 Time :  65
accuracy train: 0.986467 val: 0.981818 test: 0.961644
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.961644
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.377420277218334 Time :  76
accuracy train: 0.988285 val: 0.981818 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.961644
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.95372703881003 Time :  87
accuracy train: 0.990103 val: 0.980000 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.961644
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.746690889121965 Time :  96
accuracy train: 0.992729 val: 0.981818 test: 0.967580
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.961644
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.111018748139031 Time :  105
accuracy train: 0.992729 val: 0.980000 test: 0.962100
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.961644

Epoch :  11 loss training:  5.651883464073762 Time :  116
accuracy train: 0.994547 val: 0.980000 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.961644

Epoch :  12 loss training:  5.824664961313829 Time :  126
accuracy train: 0.993941 val: 0.980000 test: 0.967123
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.961644

Epoch :  13 loss training:  4.719549048109911 Time :  136
accuracy train: 0.994951 val: 0.980000 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.961644

Epoch :  14 loss training:  4.672584730607923 Time :  147
accuracy train: 0.994345 val: 0.981818 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.961644

Epoch :  15 loss training:  4.02655116218375 Time :  157
accuracy train: 0.995556 val: 0.976364 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.961644

Epoch :  16 loss training:  4.288006166112609 Time :  167
accuracy train: 0.995556 val: 0.980000 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.961644

Epoch :  17 loss training:  3.2333903101389296 Time :  178
accuracy train: 0.995758 val: 0.974545 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.961644

Epoch :  18 loss training:  3.2026975737098837 Time :  188
accuracy train: 0.996364 val: 0.978182 test: 0.967580
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.961644

Epoch :  19 loss training:  3.3143680082284845 Time :  198
accuracy train: 0.996162 val: 0.972727 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.961644

Epoch :  20 loss training:  3.059640926832799 Time :  208
accuracy train: 0.996364 val: 0.976364 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.961644

Epoch :  21 loss training:  2.4418653831235133 Time :  219
accuracy train: 0.996162 val: 0.981818 test: 0.967123
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.961644

Epoch :  22 loss training:  2.676891743700253 Time :  229
accuracy train: 0.996162 val: 0.972727 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.961644

Epoch :  23 loss training:  2.8898627937742276 Time :  239
accuracy train: 0.996162 val: 0.980000 test: 0.964840
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.961644

Epoch :  24 loss training:  2.4974454067705665 Time :  250
accuracy train: 0.996364 val: 0.980000 test: 0.967123
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.961644

Epoch :  25 loss training:  2.90303172901622 Time :  260
accuracy train: 0.996162 val: 0.980000 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.961644

Epoch :  26 loss training:  2.476143786974717 Time :  270
accuracy train: 0.996162 val: 0.980000 test: 0.966667
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.961644

Epoch :  27 loss training:  2.5821782559651183 Time :  281
accuracy train: 0.995960 val: 0.980000 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.961644

Epoch :  28 loss training:  2.04424782791466 Time :  291
accuracy train: 0.996162 val: 0.981818 test: 0.966667
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.961644

Epoch :  29 loss training:  2.6451458013616502 Time :  302
accuracy train: 0.996768 val: 0.980000 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.961644

Epoch :  30 loss training:  2.323555544600822 Time :  312
accuracy train: 0.996364 val: 0.978182 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.961644

Epoch :  31 loss training:  2.38807167201594 Time :  322
accuracy train: 0.996566 val: 0.978182 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 6 test accuracy : 0.961644

Epoch :  32 loss training:  1.9967392796534114 Time :  333
accuracy train: 0.996162 val: 0.983636 test: 0.969406
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.969406

Epoch :  33 loss training:  2.122251592518296 Time :  343
accuracy train: 0.996364 val: 0.981818 test: 0.969406
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.969406

Epoch :  34 loss training:  1.8420494023157516 Time :  353
accuracy train: 0.996364 val: 0.983636 test: 0.968950
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.969406

Epoch :  35 loss training:  1.736812786461087 Time :  363
accuracy train: 0.996566 val: 0.985455 test: 0.970776
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  36 loss training:  2.149748345182161 Time :  374
accuracy train: 0.996364 val: 0.980000 test: 0.968950
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  37 loss training:  1.9282771986545413 Time :  384
accuracy train: 0.996566 val: 0.978182 test: 0.969863
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  38 loss training:  1.9306060004510073 Time :  394
accuracy train: 0.996364 val: 0.980000 test: 0.970776
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  39 loss training:  1.818890612499672 Time :  405
accuracy train: 0.996566 val: 0.978182 test: 0.970776
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  40 loss training:  1.9352239329600707 Time :  415
accuracy train: 0.996364 val: 0.981818 test: 0.967580
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  41 loss training:  2.0856304442713736 Time :  425
accuracy train: 0.996566 val: 0.980000 test: 0.967123
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  42 loss training:  1.6261917953252123 Time :  436
accuracy train: 0.996364 val: 0.976364 test: 0.967580
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  43 loss training:  2.021771251984319 Time :  446
accuracy train: 0.996566 val: 0.980000 test: 0.967580
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  44 loss training:  1.8601865867240122 Time :  456
accuracy train: 0.996768 val: 0.985455 test: 0.967580
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  45 loss training:  1.8873978158330829 Time :  467
accuracy train: 0.996364 val: 0.980000 test: 0.967580
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  46 loss training:  1.764251387393415 Time :  477
accuracy train: 0.996566 val: 0.983636 test: 0.967580
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  47 loss training:  1.4656927594369336 Time :  487
accuracy train: 0.996364 val: 0.985455 test: 0.968493
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  48 loss training:  1.5378312064240163 Time :  497
accuracy train: 0.996162 val: 0.980000 test: 0.972603
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  49 loss training:  1.9150897138940763 Time :  508
accuracy train: 0.996970 val: 0.981818 test: 0.967123
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  50 loss training:  2.079301005698653 Time :  518
accuracy train: 0.996364 val: 0.985455 test: 0.965297
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  51 loss training:  2.050762395887432 Time :  528
accuracy train: 0.996970 val: 0.983636 test: 0.968493
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  52 loss training:  3.088435626181308 Time :  539
accuracy train: 0.996364 val: 0.981818 test: 0.968950
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  53 loss training:  2.557092741706583 Time :  549
accuracy train: 0.996566 val: 0.985455 test: 0.968037
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  54 loss training:  1.7527476318209665 Time :  559
accuracy train: 0.996566 val: 0.983636 test: 0.966210
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  55 loss training:  1.5035151879164914 Time :  570
accuracy train: 0.996566 val: 0.981818 test: 0.968950
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  56 loss training:  1.520588680774381 Time :  580
accuracy train: 0.997172 val: 0.981818 test: 0.966210
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  57 loss training:  1.5786381400739629 Time :  590
accuracy train: 0.996566 val: 0.978182 test: 0.967123
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  58 loss training:  1.5519353507643245 Time :  600
accuracy train: 0.996364 val: 0.978182 test: 0.966210
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  59 loss training:  1.7338756326935254 Time :  611
accuracy train: 0.996364 val: 0.976364 test: 0.968037
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  60 loss training:  1.677786456355534 Time :  621
accuracy train: 0.996162 val: 0.967273 test: 0.971233
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  61 loss training:  1.5941055069779395 Time :  631
accuracy train: 0.996364 val: 0.976364 test: 0.968037
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  62 loss training:  1.6678918840807455 Time :  642
accuracy train: 0.996566 val: 0.980000 test: 0.968037
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  63 loss training:  1.5161710060147016 Time :  652
accuracy train: 0.996970 val: 0.974545 test: 0.971233
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  64 loss training:  1.3566886444823467 Time :  662
accuracy train: 0.996364 val: 0.976364 test: 0.968950
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  65 loss training:  1.628809706575339 Time :  673
accuracy train: 0.997172 val: 0.983636 test: 0.966210
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

Epoch :  66 loss training:  1.5100528256807593 Time :  683
accuracy train: 0.996364 val: 0.976364 test: 0.968950
max validation accuracy : 0.985455 max acc epoch : 35 test accuracy : 0.970776

========================================================================================================================================================================================================
best acc epoch :  35
validation accuracy :  0.9854545454545455
test accuracy :  0.9707762557077626
last test_accuracy :  0.9689497716894977
second best val :  0.9836363636363636
second best test :  0.9694063926940639
max gap 26
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=265, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  41.703260380774736 Time :  694
accuracy train: 0.965260 val: 0.940000 test: 0.959817
max validation accuracy : 0.940000 max acc epoch : 1 test accuracy : 0.959817
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.113195503130555 Time :  704
accuracy train: 0.973743 val: 0.958182 test: 0.962557
max validation accuracy : 0.958182 max acc epoch : 2 test accuracy : 0.962557
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.529788464307785 Time :  714
accuracy train: 0.979196 val: 0.956364 test: 0.952511
max validation accuracy : 0.958182 max acc epoch : 2 test accuracy : 0.962557
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.251923422329128 Time :  724
accuracy train: 0.986467 val: 0.972727 test: 0.961644
max validation accuracy : 0.972727 max acc epoch : 4 test accuracy : 0.961644
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.455601969268173 Time :  734
accuracy train: 0.984044 val: 0.972727 test: 0.962557
max validation accuracy : 0.972727 max acc epoch : 4 test accuracy : 0.961644
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.121554865967482 Time :  745
accuracy train: 0.986669 val: 0.960000 test: 0.959817
max validation accuracy : 0.972727 max acc epoch : 4 test accuracy : 0.961644
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.58717852877453 Time :  755
accuracy train: 0.992123 val: 0.970909 test: 0.967580
max validation accuracy : 0.972727 max acc epoch : 4 test accuracy : 0.961644
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.192502292571589 Time :  765
accuracy train: 0.991517 val: 0.967273 test: 0.959817
max validation accuracy : 0.972727 max acc epoch : 4 test accuracy : 0.961644
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.232053202809766 Time :  775
accuracy train: 0.992123 val: 0.967273 test: 0.963927
max validation accuracy : 0.972727 max acc epoch : 4 test accuracy : 0.961644
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.649425262352452 Time :  786
accuracy train: 0.993739 val: 0.969091 test: 0.967580
max validation accuracy : 0.972727 max acc epoch : 4 test accuracy : 0.961644

Epoch :  11 loss training:  5.698220857186243 Time :  797
accuracy train: 0.993739 val: 0.970909 test: 0.965753
max validation accuracy : 0.972727 max acc epoch : 4 test accuracy : 0.961644

Epoch :  12 loss training:  5.128054496832192 Time :  808
accuracy train: 0.994143 val: 0.974545 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 12 test accuracy : 0.968493

Epoch :  13 loss training:  4.651558718876913 Time :  819
accuracy train: 0.995354 val: 0.972727 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 12 test accuracy : 0.968493

Epoch :  14 loss training:  4.4642800382571295 Time :  830
accuracy train: 0.995152 val: 0.972727 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 12 test accuracy : 0.968493

Epoch :  15 loss training:  3.734758007398341 Time :  842
accuracy train: 0.995556 val: 0.978182 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.968037

Epoch :  16 loss training:  4.03151390585117 Time :  853
accuracy train: 0.995556 val: 0.978182 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.968037

Epoch :  17 loss training:  3.7455414733849466 Time :  864
accuracy train: 0.995354 val: 0.974545 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.968037

Epoch :  18 loss training:  3.300672632525675 Time :  875
accuracy train: 0.995758 val: 0.972727 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.968037

Epoch :  19 loss training:  3.596615355752874 Time :  886
accuracy train: 0.996162 val: 0.974545 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.968037

Epoch :  20 loss training:  3.0557115789852105 Time :  898
accuracy train: 0.995960 val: 0.974545 test: 0.963470
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.968037

Epoch :  21 loss training:  2.745705110428389 Time :  909
accuracy train: 0.995960 val: 0.974545 test: 0.965753
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.968037

Epoch :  22 loss training:  2.9741988284804393 Time :  920
accuracy train: 0.996364 val: 0.974545 test: 0.965753
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.968037

Epoch :  23 loss training:  2.608756106114015 Time :  931
accuracy train: 0.996364 val: 0.970909 test: 0.966210
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.968037

Epoch :  24 loss training:  3.169746666389983 Time :  942
accuracy train: 0.996162 val: 0.976364 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.968037

Epoch :  25 loss training:  2.9934554821811616 Time :  954
accuracy train: 0.996364 val: 0.970909 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.968037

Epoch :  26 loss training:  2.3682612256525317 Time :  965
accuracy train: 0.996364 val: 0.969091 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.968037

Epoch :  27 loss training:  2.544696835509967 Time :  976
accuracy train: 0.996364 val: 0.974545 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.968037

Epoch :  28 loss training:  2.1050920554844197 Time :  987
accuracy train: 0.996566 val: 0.972727 test: 0.964840
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.968037

Epoch :  29 loss training:  2.2401736356987385 Time :  999
accuracy train: 0.996364 val: 0.974545 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.968037

Epoch :  30 loss training:  2.0980346619180636 Time :  1011
accuracy train: 0.996768 val: 0.978182 test: 0.967123
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.968037

Epoch :  31 loss training:  2.5732147441158304 Time :  1022
accuracy train: 0.996364 val: 0.974545 test: 0.967123
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.968037

Epoch :  32 loss training:  2.3071066823758883 Time :  1033
accuracy train: 0.997172 val: 0.972727 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.968037

Epoch :  33 loss training:  2.053150490450207 Time :  1045
accuracy train: 0.996566 val: 0.980000 test: 0.964840
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  34 loss training:  1.8415898330276832 Time :  1056
accuracy train: 0.996566 val: 0.972727 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  35 loss training:  1.68638878173806 Time :  1067
accuracy train: 0.996364 val: 0.969091 test: 0.965753
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  36 loss training:  1.969290448945685 Time :  1078
accuracy train: 0.996768 val: 0.970909 test: 0.967123
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  37 loss training:  1.985535197549325 Time :  1090
accuracy train: 0.996566 val: 0.974545 test: 0.968950
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  38 loss training:  1.7497072240075795 Time :  1101
accuracy train: 0.996162 val: 0.969091 test: 0.966667
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  39 loss training:  1.7229329360488919 Time :  1112
accuracy train: 0.996768 val: 0.972727 test: 0.965753
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  40 loss training:  1.7886289445013972 Time :  1123
accuracy train: 0.996566 val: 0.967273 test: 0.968950
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  41 loss training:  1.7375102482037619 Time :  1134
accuracy train: 0.996566 val: 0.970909 test: 0.964840
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  42 loss training:  1.5427713989265612 Time :  1146
accuracy train: 0.996566 val: 0.967273 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  43 loss training:  1.9584487365536916 Time :  1157
accuracy train: 0.996970 val: 0.972727 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  44 loss training:  1.9882471882956452 Time :  1168
accuracy train: 0.996566 val: 0.970909 test: 0.967580
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  45 loss training:  1.7233926892185991 Time :  1179
accuracy train: 0.996566 val: 0.974545 test: 0.967580
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  46 loss training:  1.427513335034746 Time :  1190
accuracy train: 0.996970 val: 0.978182 test: 0.970320
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  47 loss training:  1.4599833436950576 Time :  1202
accuracy train: 0.996970 val: 0.978182 test: 0.968950
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  48 loss training:  1.7927959804364946 Time :  1213
accuracy train: 0.996970 val: 0.974545 test: 0.967123
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  49 loss training:  1.3729323537118034 Time :  1224
accuracy train: 0.996768 val: 0.972727 test: 0.966667
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  50 loss training:  1.8390214175997244 Time :  1235
accuracy train: 0.996970 val: 0.970909 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  51 loss training:  1.656899247709589 Time :  1246
accuracy train: 0.996768 val: 0.972727 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  52 loss training:  1.6101503325335216 Time :  1258
accuracy train: 0.997172 val: 0.969091 test: 0.964384
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  53 loss training:  1.3068810419499641 Time :  1269
accuracy train: 0.996566 val: 0.967273 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  54 loss training:  1.4502702374920773 Time :  1280
accuracy train: 0.996566 val: 0.972727 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  55 loss training:  1.4191519943142339 Time :  1291
accuracy train: 0.996970 val: 0.974545 test: 0.967580
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  56 loss training:  1.3915264995503094 Time :  1302
accuracy train: 0.996970 val: 0.976364 test: 0.967580
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  57 loss training:  1.3096310748260294 Time :  1314
accuracy train: 0.996768 val: 0.972727 test: 0.967580
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  58 loss training:  1.4154206278890342 Time :  1325
accuracy train: 0.996566 val: 0.969091 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  59 loss training:  1.4327597187075298 Time :  1336
accuracy train: 0.996566 val: 0.970909 test: 0.968950
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  60 loss training:  1.5837306454959617 Time :  1346
accuracy train: 0.996566 val: 0.965455 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  61 loss training:  1.3950087114390044 Time :  1358
accuracy train: 0.996970 val: 0.970909 test: 0.968037
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  62 loss training:  1.544126211976618 Time :  1369
accuracy train: 0.996364 val: 0.967273 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  63 loss training:  1.2597884200731642 Time :  1382
accuracy train: 0.996768 val: 0.969091 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

Epoch :  64 loss training:  1.4119734741016146 Time :  1394
accuracy train: 0.996566 val: 0.967273 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 33 test accuracy : 0.964840

========================================================================================================================================================================================================
best acc epoch :  33
validation accuracy :  0.98
test accuracy :  0.9648401826484019
last test_accuracy :  0.971689497716895
second best val :  0.9781818181818182
second best test :  0.9680365296803652
max gap 18
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  35 	 val_accuracy : 0.98545 	 test_accuracy : 0.97078 	 last test_accuracy : 0.96895 	 second best val : 0.98364 	 second best test : 0.96941
k :  1 	 best_acc epoch :  33 	 val_accuracy : 0.98000 	 test_accuracy : 0.96484 	 last test_accuracy : 0.97169 	 second best val : 0.97818 	 second best test : 0.96804

avg :  	 val_accuracy : 0.98273 	 test_accuracy : 0.96781 	 last_accuracy : 0.97032 	 second best val : 0.98091 	 second best test : 0.96872

std :  	 val_accuracy : 0.00273 	 test_accuracy : 0.00297 	 last_accuracy : 0.00137 	 second best val : 0.00273 	 second best test : 0.00068


date and time :  Fri Jul  9 11:44:46 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=984, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  42.22727338783443 Time :  13
accuracy train: 0.943042 val: 0.941818 test: 0.957991
max validation accuracy : 0.941818 max acc epoch : 1 test accuracy : 0.957991
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.154555576154962 Time :  25
accuracy train: 0.965462 val: 0.954545 test: 0.962100
max validation accuracy : 0.954545 max acc epoch : 2 test accuracy : 0.962100
Epoch-2 lr: 0.001

Epoch :  3 loss training:  13.706316404044628 Time :  37
accuracy train: 0.974349 val: 0.967273 test: 0.956164
max validation accuracy : 0.967273 max acc epoch : 3 test accuracy : 0.956164
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.980949287302792 Time :  49
accuracy train: 0.984448 val: 0.967273 test: 0.966667
max validation accuracy : 0.967273 max acc epoch : 3 test accuracy : 0.956164
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.650472536217421 Time :  61
accuracy train: 0.985256 val: 0.974545 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.973059
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.735467768041417 Time :  74
accuracy train: 0.985861 val: 0.970909 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.973059
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.930781222647056 Time :  87
accuracy train: 0.989497 val: 0.974545 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.973059
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.905400323914364 Time :  101
accuracy train: 0.992123 val: 0.980000 test: 0.965297
max validation accuracy : 0.980000 max acc epoch : 8 test accuracy : 0.965297
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.315517218616151 Time :  115
accuracy train: 0.992123 val: 0.970909 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 8 test accuracy : 0.965297
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.176135697984137 Time :  128
accuracy train: 0.992325 val: 0.974545 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 8 test accuracy : 0.965297

Epoch :  11 loss training:  4.847782982629724 Time :  143
accuracy train: 0.994345 val: 0.981818 test: 0.964840
max validation accuracy : 0.981818 max acc epoch : 11 test accuracy : 0.964840

Epoch :  12 loss training:  3.953006280295085 Time :  158
accuracy train: 0.993941 val: 0.978182 test: 0.967580
max validation accuracy : 0.981818 max acc epoch : 11 test accuracy : 0.964840

Epoch :  13 loss training:  4.351729295449331 Time :  172
accuracy train: 0.995960 val: 0.985455 test: 0.968950
max validation accuracy : 0.985455 max acc epoch : 13 test accuracy : 0.968950

Epoch :  14 loss training:  4.26744344382314 Time :  187
accuracy train: 0.994547 val: 0.981818 test: 0.967123
max validation accuracy : 0.985455 max acc epoch : 13 test accuracy : 0.968950

Epoch :  15 loss training:  3.716750802763272 Time :  202
accuracy train: 0.995960 val: 0.985455 test: 0.969406
max validation accuracy : 0.985455 max acc epoch : 13 test accuracy : 0.968950

Epoch :  16 loss training:  3.7462889360103873 Time :  217
accuracy train: 0.995152 val: 0.983636 test: 0.966210
max validation accuracy : 0.985455 max acc epoch : 13 test accuracy : 0.968950

Epoch :  17 loss training:  3.4729521317058243 Time :  232
accuracy train: 0.995354 val: 0.981818 test: 0.969406
max validation accuracy : 0.985455 max acc epoch : 13 test accuracy : 0.968950

Epoch :  18 loss training:  3.6147547306027263 Time :  247
accuracy train: 0.995960 val: 0.983636 test: 0.969406
max validation accuracy : 0.985455 max acc epoch : 13 test accuracy : 0.968950

Epoch :  19 loss training:  3.337721397710993 Time :  262
accuracy train: 0.994951 val: 0.980000 test: 0.971689
max validation accuracy : 0.985455 max acc epoch : 13 test accuracy : 0.968950

Epoch :  20 loss training:  3.095007263298612 Time :  277
accuracy train: 0.996364 val: 0.983636 test: 0.970320
max validation accuracy : 0.985455 max acc epoch : 13 test accuracy : 0.968950

Epoch :  21 loss training:  3.0975938787159976 Time :  291
accuracy train: 0.996364 val: 0.981818 test: 0.968950
max validation accuracy : 0.985455 max acc epoch : 13 test accuracy : 0.968950

Epoch :  22 loss training:  2.643511290603783 Time :  306
accuracy train: 0.996566 val: 0.983636 test: 0.969863
max validation accuracy : 0.985455 max acc epoch : 13 test accuracy : 0.968950

Epoch :  23 loss training:  2.462620127975242 Time :  321
accuracy train: 0.996566 val: 0.980000 test: 0.965297
max validation accuracy : 0.985455 max acc epoch : 13 test accuracy : 0.968950

Epoch :  24 loss training:  2.878511198927299 Time :  335
accuracy train: 0.996364 val: 0.978182 test: 0.967123
max validation accuracy : 0.985455 max acc epoch : 13 test accuracy : 0.968950

Epoch :  25 loss training:  2.450160785800108 Time :  350
accuracy train: 0.996768 val: 0.983636 test: 0.970776
max validation accuracy : 0.985455 max acc epoch : 13 test accuracy : 0.968950

Epoch :  26 loss training:  2.407993491127854 Time :  365
accuracy train: 0.996162 val: 0.981818 test: 0.971689
max validation accuracy : 0.985455 max acc epoch : 13 test accuracy : 0.968950

Epoch :  27 loss training:  2.4833342373167397 Time :  379
accuracy train: 0.997172 val: 0.981818 test: 0.969863
max validation accuracy : 0.985455 max acc epoch : 13 test accuracy : 0.968950

Epoch :  28 loss training:  2.277322360983817 Time :  394
accuracy train: 0.996970 val: 0.983636 test: 0.969863
max validation accuracy : 0.985455 max acc epoch : 13 test accuracy : 0.968950

Epoch :  29 loss training:  2.037860794836888 Time :  409
accuracy train: 0.997172 val: 0.981818 test: 0.969863
max validation accuracy : 0.985455 max acc epoch : 13 test accuracy : 0.968950

Epoch :  30 loss training:  2.12974842110998 Time :  423
accuracy train: 0.996566 val: 0.983636 test: 0.973516
max validation accuracy : 0.985455 max acc epoch : 13 test accuracy : 0.968950

Epoch :  31 loss training:  1.9018700224114582 Time :  438
accuracy train: 0.996970 val: 0.983636 test: 0.972603
max validation accuracy : 0.985455 max acc epoch : 13 test accuracy : 0.968950

Epoch :  32 loss training:  2.1958379902207525 Time :  453
accuracy train: 0.997172 val: 0.985455 test: 0.969406
max validation accuracy : 0.985455 max acc epoch : 13 test accuracy : 0.968950

Epoch :  33 loss training:  2.008451196315036 Time :  468
accuracy train: 0.996970 val: 0.985455 test: 0.969406
max validation accuracy : 0.985455 max acc epoch : 13 test accuracy : 0.968950

Epoch :  34 loss training:  1.9353623092702037 Time :  482
accuracy train: 0.996768 val: 0.980000 test: 0.973516
max validation accuracy : 0.985455 max acc epoch : 13 test accuracy : 0.968950

Epoch :  35 loss training:  2.0187769249314442 Time :  497
accuracy train: 0.996768 val: 0.981818 test: 0.973059
max validation accuracy : 0.985455 max acc epoch : 13 test accuracy : 0.968950

Epoch :  36 loss training:  1.6861792924755719 Time :  512
accuracy train: 0.997172 val: 0.987273 test: 0.970776
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  37 loss training:  1.6304897227237234 Time :  527
accuracy train: 0.997172 val: 0.980000 test: 0.970320
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  38 loss training:  1.754758996074088 Time :  541
accuracy train: 0.996970 val: 0.983636 test: 0.972603
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  39 loss training:  1.6699597856058972 Time :  556
accuracy train: 0.997374 val: 0.981818 test: 0.970776
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  40 loss training:  1.8220143625148921 Time :  571
accuracy train: 0.997374 val: 0.985455 test: 0.967123
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  41 loss training:  1.860284360111109 Time :  585
accuracy train: 0.996970 val: 0.985455 test: 0.969863
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  42 loss training:  1.7009209681709763 Time :  600
accuracy train: 0.997374 val: 0.981818 test: 0.973516
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  43 loss training:  1.747540172033041 Time :  615
accuracy train: 0.997172 val: 0.983636 test: 0.971689
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  44 loss training:  1.7626730705087539 Time :  630
accuracy train: 0.997172 val: 0.987273 test: 0.972603
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  45 loss training:  1.9739420823116234 Time :  644
accuracy train: 0.997374 val: 0.983636 test: 0.970320
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  46 loss training:  1.4596087291211006 Time :  659
accuracy train: 0.997374 val: 0.980000 test: 0.968493
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  47 loss training:  1.6897673384410155 Time :  673
accuracy train: 0.997172 val: 0.983636 test: 0.971689
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  48 loss training:  1.3521330582661903 Time :  688
accuracy train: 0.996768 val: 0.985455 test: 0.969863
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  49 loss training:  1.6802563521086995 Time :  700
accuracy train: 0.997374 val: 0.980000 test: 0.970320
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  50 loss training:  1.4293266909189697 Time :  713
accuracy train: 0.997374 val: 0.978182 test: 0.972603
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  51 loss training:  1.6582532684187754 Time :  725
accuracy train: 0.997172 val: 0.983636 test: 0.973516
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  52 loss training:  1.6832224993922864 Time :  737
accuracy train: 0.997374 val: 0.983636 test: 0.969406
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  53 loss training:  1.3529006498356466 Time :  750
accuracy train: 0.997374 val: 0.983636 test: 0.968037
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  54 loss training:  1.314980337741872 Time :  762
accuracy train: 0.997374 val: 0.985455 test: 0.972603
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  55 loss training:  1.492353683195688 Time :  774
accuracy train: 0.997374 val: 0.981818 test: 0.973059
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  56 loss training:  1.6884667253125372 Time :  787
accuracy train: 0.997374 val: 0.974545 test: 0.970776
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  57 loss training:  1.3853742238889026 Time :  799
accuracy train: 0.997172 val: 0.981818 test: 0.974886
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  58 loss training:  1.6515716889516625 Time :  811
accuracy train: 0.997374 val: 0.981818 test: 0.973059
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  59 loss training:  1.6579585591516661 Time :  824
accuracy train: 0.997576 val: 0.981818 test: 0.972146
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  60 loss training:  1.40328173760372 Time :  836
accuracy train: 0.996566 val: 0.978182 test: 0.970776
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  61 loss training:  1.3705981588391296 Time :  849
accuracy train: 0.997172 val: 0.983636 test: 0.973059
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  62 loss training:  1.3533298869770078 Time :  861
accuracy train: 0.996970 val: 0.981818 test: 0.969863
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  63 loss training:  1.3078856776992325 Time :  873
accuracy train: 0.996768 val: 0.980000 test: 0.971233
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  64 loss training:  1.32407750368111 Time :  886
accuracy train: 0.997172 val: 0.985455 test: 0.970320
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  65 loss training:  1.4530620363111666 Time :  898
accuracy train: 0.997172 val: 0.983636 test: 0.971689
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  66 loss training:  1.506420630897992 Time :  911
accuracy train: 0.996768 val: 0.981818 test: 0.968950
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

Epoch :  67 loss training:  1.360390474770611 Time :  923
accuracy train: 0.996970 val: 0.983636 test: 0.970776
max validation accuracy : 0.987273 max acc epoch : 36 test accuracy : 0.970776

========================================================================================================================================================================================================
best acc epoch :  36
validation accuracy :  0.9872727272727273
test accuracy :  0.9707762557077626
last test_accuracy :  0.9707762557077626
second best val :  0.9854545454545455
second best test :  0.9689497716894977
max gap 23
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=202, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  42.25575240328908 Time :  936
accuracy train: 0.951727 val: 0.936364 test: 0.961187
max validation accuracy : 0.936364 max acc epoch : 1 test accuracy : 0.961187
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.576261955779046 Time :  947
accuracy train: 0.961826 val: 0.945455 test: 0.961644
max validation accuracy : 0.945455 max acc epoch : 2 test accuracy : 0.961644
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.534649651031941 Time :  959
accuracy train: 0.962836 val: 0.943636 test: 0.956621
max validation accuracy : 0.945455 max acc epoch : 2 test accuracy : 0.961644
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.333103341050446 Time :  972
accuracy train: 0.977984 val: 0.963636 test: 0.969863
max validation accuracy : 0.963636 max acc epoch : 4 test accuracy : 0.969863
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.71932619670406 Time :  984
accuracy train: 0.981822 val: 0.967273 test: 0.969406
max validation accuracy : 0.967273 max acc epoch : 5 test accuracy : 0.969406
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.64553467091173 Time :  996
accuracy train: 0.984246 val: 0.961818 test: 0.967580
max validation accuracy : 0.967273 max acc epoch : 5 test accuracy : 0.969406
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.180423197569326 Time :  1008
accuracy train: 0.988285 val: 0.961818 test: 0.973516
max validation accuracy : 0.967273 max acc epoch : 5 test accuracy : 0.969406
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.880980286281556 Time :  1020
accuracy train: 0.988285 val: 0.967273 test: 0.972603
max validation accuracy : 0.967273 max acc epoch : 5 test accuracy : 0.969406
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.680579018837307 Time :  1032
accuracy train: 0.990103 val: 0.972727 test: 0.973059
max validation accuracy : 0.972727 max acc epoch : 9 test accuracy : 0.973059
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.5290921406121925 Time :  1045
accuracy train: 0.990103 val: 0.970909 test: 0.969863
max validation accuracy : 0.972727 max acc epoch : 9 test accuracy : 0.973059

Epoch :  11 loss training:  5.596148636424914 Time :  1058
accuracy train: 0.992931 val: 0.974545 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 11 test accuracy : 0.971689

Epoch :  12 loss training:  5.2074158024042845 Time :  1071
accuracy train: 0.993739 val: 0.978182 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 12 test accuracy : 0.973059

Epoch :  13 loss training:  5.650522967684083 Time :  1084
accuracy train: 0.993941 val: 0.972727 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 12 test accuracy : 0.973059

Epoch :  14 loss training:  4.475051141809672 Time :  1098
accuracy train: 0.994143 val: 0.970909 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 12 test accuracy : 0.973059

Epoch :  15 loss training:  4.591718358453363 Time :  1112
accuracy train: 0.994547 val: 0.969091 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 12 test accuracy : 0.973059

Epoch :  16 loss training:  4.2221525182249025 Time :  1126
accuracy train: 0.993941 val: 0.976364 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 12 test accuracy : 0.973059

Epoch :  17 loss training:  4.3020770723233 Time :  1140
accuracy train: 0.994951 val: 0.976364 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 12 test accuracy : 0.973059

Epoch :  18 loss training:  3.8285881396150216 Time :  1155
accuracy train: 0.993941 val: 0.970909 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 12 test accuracy : 0.973059

Epoch :  19 loss training:  3.462907934212126 Time :  1170
accuracy train: 0.995758 val: 0.976364 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 12 test accuracy : 0.973059

Epoch :  20 loss training:  3.6201667189016007 Time :  1185
accuracy train: 0.995354 val: 0.976364 test: 0.975799
max validation accuracy : 0.978182 max acc epoch : 12 test accuracy : 0.973059

Epoch :  21 loss training:  3.6149372820582357 Time :  1200
accuracy train: 0.995758 val: 0.972727 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 12 test accuracy : 0.973059

Epoch :  22 loss training:  2.591942993021803 Time :  1214
accuracy train: 0.995960 val: 0.970909 test: 0.977169
max validation accuracy : 0.978182 max acc epoch : 12 test accuracy : 0.973059

Epoch :  23 loss training:  3.264441907813307 Time :  1228
accuracy train: 0.996364 val: 0.978182 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 12 test accuracy : 0.973059

Epoch :  24 loss training:  3.3078310983109986 Time :  1240
accuracy train: 0.996364 val: 0.981818 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  25 loss training:  2.6247573314612964 Time :  1253
accuracy train: 0.995960 val: 0.978182 test: 0.975342
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  26 loss training:  2.664197171165142 Time :  1267
accuracy train: 0.996162 val: 0.978182 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  27 loss training:  2.1913825515075587 Time :  1280
accuracy train: 0.996364 val: 0.978182 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  28 loss training:  2.3562323521910002 Time :  1293
accuracy train: 0.996364 val: 0.972727 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  29 loss training:  2.486102542025037 Time :  1307
accuracy train: 0.996970 val: 0.976364 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  30 loss training:  2.203920764120994 Time :  1319
accuracy train: 0.996566 val: 0.974545 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  31 loss training:  2.394268832227681 Time :  1333
accuracy train: 0.996566 val: 0.970909 test: 0.975799
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  32 loss training:  1.9989116134729557 Time :  1346
accuracy train: 0.996566 val: 0.976364 test: 0.974886
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  33 loss training:  2.0457718370307703 Time :  1360
accuracy train: 0.996970 val: 0.972727 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  34 loss training:  2.1574624918284826 Time :  1374
accuracy train: 0.996364 val: 0.974545 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  35 loss training:  1.9103311901562847 Time :  1388
accuracy train: 0.996364 val: 0.970909 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  36 loss training:  2.191421795374481 Time :  1402
accuracy train: 0.996970 val: 0.970909 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  37 loss training:  1.788118770447909 Time :  1415
accuracy train: 0.996768 val: 0.970909 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  38 loss training:  2.040111797876307 Time :  1428
accuracy train: 0.997374 val: 0.976364 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  39 loss training:  1.667851101832639 Time :  1441
accuracy train: 0.997172 val: 0.972727 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  40 loss training:  1.6635613240650855 Time :  1455
accuracy train: 0.996970 val: 0.976364 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  41 loss training:  1.5451621288666502 Time :  1469
accuracy train: 0.997576 val: 0.967273 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  42 loss training:  1.6262566977165989 Time :  1482
accuracy train: 0.996768 val: 0.967273 test: 0.976712
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  43 loss training:  1.8312788377515972 Time :  1496
accuracy train: 0.995758 val: 0.969091 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  44 loss training:  1.9682127294072416 Time :  1510
accuracy train: 0.996768 val: 0.969091 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  45 loss training:  1.830613303129212 Time :  1524
accuracy train: 0.996768 val: 0.972727 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  46 loss training:  1.604792073929275 Time :  1537
accuracy train: 0.997374 val: 0.969091 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  47 loss training:  2.0705522290372755 Time :  1550
accuracy train: 0.996970 val: 0.976364 test: 0.968037
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  48 loss training:  1.5065323985800205 Time :  1564
accuracy train: 0.997172 val: 0.967273 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  49 loss training:  1.5068138037759127 Time :  1576
accuracy train: 0.996768 val: 0.970909 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  50 loss training:  1.6377817340835463 Time :  1589
accuracy train: 0.997374 val: 0.974545 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  51 loss training:  1.9025575823980034 Time :  1602
accuracy train: 0.997172 val: 0.965455 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  52 loss training:  1.8455429177702172 Time :  1616
accuracy train: 0.997172 val: 0.969091 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  53 loss training:  1.4654962744825752 Time :  1628
accuracy train: 0.997374 val: 0.972727 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  54 loss training:  1.5464828561161994 Time :  1641
accuracy train: 0.997172 val: 0.976364 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

Epoch :  55 loss training:  1.50670804497895 Time :  1654
accuracy train: 0.997576 val: 0.972727 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 24 test accuracy : 0.973516

========================================================================================================================================================================================================
best acc epoch :  24
validation accuracy :  0.9818181818181818
test accuracy :  0.9735159817351599
last test_accuracy :  0.9694063926940639
second best val :  0.9781818181818182
second best test :  0.9730593607305936
max gap 12
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  36 	 val_accuracy : 0.98727 	 test_accuracy : 0.97078 	 last test_accuracy : 0.97078 	 second best val : 0.98545 	 second best test : 0.96895
k :  1 	 best_acc epoch :  24 	 val_accuracy : 0.98182 	 test_accuracy : 0.97352 	 last test_accuracy : 0.96941 	 second best val : 0.97818 	 second best test : 0.97306

avg :  	 val_accuracy : 0.98455 	 test_accuracy : 0.97215 	 last_accuracy : 0.97009 	 second best val : 0.98182 	 second best test : 0.97100

std :  	 val_accuracy : 0.00273 	 test_accuracy : 0.00137 	 last_accuracy : 0.00068 	 second best val : 0.00364 	 second best test : 0.00205


date and time :  Fri Jul  9 12:12:32 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=318, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0
Counter({0: 4723, 1: 2968})

Epoch :  1 loss training:  41.51280928403139 Time :  21
accuracy train: 0.963240 val: 0.934545 test: 0.952055
max validation accuracy : 0.934545 max acc epoch : 1 test accuracy : 0.952055
Counter({0: 4129, 1: 3562})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.429206807166338 Time :  38
accuracy train: 0.967683 val: 0.943636 test: 0.961187
max validation accuracy : 0.943636 max acc epoch : 2 test accuracy : 0.961187
Counter({0: 4028, 1: 3663})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.333402985241264 Time :  56
accuracy train: 0.971723 val: 0.936364 test: 0.954795
max validation accuracy : 0.943636 max acc epoch : 2 test accuracy : 0.961187
Counter({0: 3874, 1: 3817})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.20796378486557 Time :  73
accuracy train: 0.984448 val: 0.958182 test: 0.967123
max validation accuracy : 0.958182 max acc epoch : 4 test accuracy : 0.967123
Counter({1: 3917, 0: 3774})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.595027019269764 Time :  90
accuracy train: 0.983236 val: 0.956364 test: 0.965753
max validation accuracy : 0.958182 max acc epoch : 4 test accuracy : 0.967123
Counter({1: 3895, 0: 3796})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  7.980661406880245 Time :  105
accuracy train: 0.984246 val: 0.961818 test: 0.967123
max validation accuracy : 0.961818 max acc epoch : 6 test accuracy : 0.967123
Counter({0: 3875, 1: 3816})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.4712982043856755 Time :  126
accuracy train: 0.989093 val: 0.958182 test: 0.968037
max validation accuracy : 0.961818 max acc epoch : 6 test accuracy : 0.967123
Counter({0: 3857, 1: 3834})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.1577134660910815 Time :  141
accuracy train: 0.988487 val: 0.960000 test: 0.964384
max validation accuracy : 0.961818 max acc epoch : 6 test accuracy : 0.967123
Counter({1: 3856, 0: 3835})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.228964599547908 Time :  156
accuracy train: 0.991315 val: 0.958182 test: 0.962557
max validation accuracy : 0.961818 max acc epoch : 6 test accuracy : 0.967123
Counter({0: 3889, 1: 3802})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  4.84509154362604 Time :  172
accuracy train: 0.991719 val: 0.960000 test: 0.966210
max validation accuracy : 0.961818 max acc epoch : 6 test accuracy : 0.967123
Counter({1: 3888, 0: 3803})

Epoch :  11 loss training:  4.953075659926981 Time :  189
accuracy train: 0.993133 val: 0.952727 test: 0.966667
max validation accuracy : 0.961818 max acc epoch : 6 test accuracy : 0.967123
Counter({0: 3889, 1: 3802})

Epoch :  12 loss training:  4.8265768302371725 Time :  206
accuracy train: 0.993335 val: 0.958182 test: 0.965753
max validation accuracy : 0.961818 max acc epoch : 6 test accuracy : 0.967123
Counter({1: 3889, 0: 3802})

Epoch :  13 loss training:  4.663150224718265 Time :  223
accuracy train: 0.993941 val: 0.958182 test: 0.965753
max validation accuracy : 0.961818 max acc epoch : 6 test accuracy : 0.967123
Counter({1: 3900, 0: 3791})

Epoch :  14 loss training:  4.177251557062846 Time :  241
accuracy train: 0.994345 val: 0.954545 test: 0.965297
max validation accuracy : 0.961818 max acc epoch : 6 test accuracy : 0.967123
Counter({1: 3906, 0: 3785})

Epoch :  15 loss training:  3.897755926416721 Time :  258
accuracy train: 0.994951 val: 0.960000 test: 0.965753
max validation accuracy : 0.961818 max acc epoch : 6 test accuracy : 0.967123
Counter({1: 3906, 0: 3785})

Epoch :  16 loss training:  3.222015522653237 Time :  275
accuracy train: 0.995556 val: 0.956364 test: 0.967123
max validation accuracy : 0.961818 max acc epoch : 6 test accuracy : 0.967123
Counter({1: 3911, 0: 3780})

Epoch :  17 loss training:  3.4245899719535373 Time :  291
accuracy train: 0.995354 val: 0.960000 test: 0.967580
max validation accuracy : 0.961818 max acc epoch : 6 test accuracy : 0.967123
Counter({1: 3914, 0: 3777})

Epoch :  18 loss training:  3.135888556484133 Time :  308
accuracy train: 0.995758 val: 0.958182 test: 0.967123
max validation accuracy : 0.961818 max acc epoch : 6 test accuracy : 0.967123
Counter({1: 3914, 0: 3777})

Epoch :  19 loss training:  3.0517881408159155 Time :  324
accuracy train: 0.995354 val: 0.956364 test: 0.966210
max validation accuracy : 0.961818 max acc epoch : 6 test accuracy : 0.967123
Counter({0: 3920, 1: 3771})

Epoch :  20 loss training:  3.0166642646072432 Time :  341
accuracy train: 0.996162 val: 0.965455 test: 0.969406
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({1: 3922, 0: 3769})

Epoch :  21 loss training:  2.972986557346303 Time :  358
accuracy train: 0.996566 val: 0.961818 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({1: 3922, 0: 3769})

Epoch :  22 loss training:  2.5523854299390223 Time :  376
accuracy train: 0.996364 val: 0.960000 test: 0.967123
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({1: 3921, 0: 3770})

Epoch :  23 loss training:  2.601183565100655 Time :  395
accuracy train: 0.996566 val: 0.960000 test: 0.967580
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({0: 3922, 1: 3769})

Epoch :  24 loss training:  2.282145340926945 Time :  412
accuracy train: 0.996566 val: 0.960000 test: 0.966210
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({1: 3924, 0: 3767})

Epoch :  25 loss training:  2.197724453639239 Time :  429
accuracy train: 0.996768 val: 0.958182 test: 0.968950
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({1: 3925, 0: 3766})

Epoch :  26 loss training:  2.158854450623039 Time :  447
accuracy train: 0.996768 val: 0.956364 test: 0.967580
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({1: 3927, 0: 3764})

Epoch :  27 loss training:  2.3559167711937334 Time :  465
accuracy train: 0.997172 val: 0.960000 test: 0.964384
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({1: 3927, 0: 3764})

Epoch :  28 loss training:  2.0033521857403684 Time :  482
accuracy train: 0.996364 val: 0.954545 test: 0.963014
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({1: 3927, 0: 3764})

Epoch :  29 loss training:  1.7948443509812932 Time :  501
accuracy train: 0.996768 val: 0.956364 test: 0.968950
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({1: 3927, 0: 3764})

Epoch :  30 loss training:  1.8465589850529796 Time :  519
accuracy train: 0.996970 val: 0.958182 test: 0.967123
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({0: 3926, 1: 3765})

Epoch :  31 loss training:  2.1785086768795736 Time :  537
accuracy train: 0.996970 val: 0.956364 test: 0.971233
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({1: 3926, 0: 3765})

Epoch :  32 loss training:  1.9104490935133072 Time :  555
accuracy train: 0.997172 val: 0.960000 test: 0.970776
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({1: 3928, 0: 3763})

Epoch :  33 loss training:  1.8396282449102728 Time :  573
accuracy train: 0.997172 val: 0.960000 test: 0.970776
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({1: 3929, 0: 3762})

Epoch :  34 loss training:  1.622002997159143 Time :  593
accuracy train: 0.997172 val: 0.963636 test: 0.970776
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({1: 3931, 0: 3760})

Epoch :  35 loss training:  1.5488427964301081 Time :  611
accuracy train: 0.997172 val: 0.958182 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({1: 3933, 0: 3758})

Epoch :  36 loss training:  1.5464595413650386 Time :  628
accuracy train: 0.997172 val: 0.961818 test: 0.971233
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({0: 3933, 1: 3758})

Epoch :  37 loss training:  1.514128047740087 Time :  647
accuracy train: 0.997374 val: 0.963636 test: 0.965753
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({0: 3933, 1: 3758})

Epoch :  38 loss training:  1.5934093478745126 Time :  664
accuracy train: 0.997576 val: 0.965455 test: 0.968950
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({1: 3933, 0: 3758})

Epoch :  39 loss training:  1.6470833645871608 Time :  684
accuracy train: 0.996768 val: 0.963636 test: 0.971233
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({1: 3933, 0: 3758})

Epoch :  40 loss training:  1.4439869116613409 Time :  701
accuracy train: 0.997778 val: 0.960000 test: 0.966667
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({1: 3933, 0: 3758})

Epoch :  41 loss training:  1.1501637544934056 Time :  718
accuracy train: 0.997374 val: 0.956364 test: 0.968037
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({1: 3933, 0: 3758})

Epoch :  42 loss training:  1.387378893668938 Time :  736
accuracy train: 0.997374 val: 0.960000 test: 0.969406
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({1: 3933, 0: 3758})

Epoch :  43 loss training:  1.4230768985144095 Time :  752
accuracy train: 0.997576 val: 0.960000 test: 0.970320
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({1: 3933, 0: 3758})

Epoch :  44 loss training:  1.4979562408916536 Time :  772
accuracy train: 0.997576 val: 0.960000 test: 0.970320
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({1: 3933, 0: 3758})

Epoch :  45 loss training:  1.183563461570884 Time :  790
accuracy train: 0.995354 val: 0.956364 test: 0.967123
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({0: 3933, 1: 3758})

Epoch :  46 loss training:  2.1140237650179188 Time :  807
accuracy train: 0.997576 val: 0.956364 test: 0.970320
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({0: 3932, 1: 3759})

Epoch :  47 loss training:  1.6938716870427015 Time :  827
accuracy train: 0.997576 val: 0.956364 test: 0.967123
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({1: 3933, 0: 3758})

Epoch :  48 loss training:  1.3954350674903253 Time :  844
accuracy train: 0.997980 val: 0.952727 test: 0.965753
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({0: 3933, 1: 3758})

Epoch :  49 loss training:  1.1994085443002405 Time :  861
accuracy train: 0.997576 val: 0.952727 test: 0.969406
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({0: 3933, 1: 3758})

Epoch :  50 loss training:  1.281317114844569 Time :  880
accuracy train: 0.997980 val: 0.952727 test: 0.964840
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({0: 3933, 1: 3758})

Epoch :  51 loss training:  1.252258608554257 Time :  895
accuracy train: 0.997576 val: 0.958182 test: 0.968493
max validation accuracy : 0.965455 max acc epoch : 20 test accuracy : 0.969406
Counter({0: 3933, 1: 3758})

========================================================================================================================================================================================================
best acc epoch :  20
validation accuracy :  0.9654545454545455
test accuracy :  0.9694063926940639
last test_accuracy :  0.9684931506849315
second best val :  0.9636363636363636
second best test :  0.9694063926940639
max gap 14
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=651, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0
Counter({1: 4723, 0: 2968})

Epoch :  1 loss training:  42.04420052096248 Time :  915
accuracy train: 0.957382 val: 0.940000 test: 0.957078
max validation accuracy : 0.940000 max acc epoch : 1 test accuracy : 0.957078
Counter({0: 4090, 1: 3601})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.267836643382907 Time :  932
accuracy train: 0.963644 val: 0.936364 test: 0.948402
max validation accuracy : 0.940000 max acc epoch : 1 test accuracy : 0.957078
Counter({0: 4012, 1: 3679})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.900386969558895 Time :  949
accuracy train: 0.975157 val: 0.960000 test: 0.963014
max validation accuracy : 0.960000 max acc epoch : 3 test accuracy : 0.963014
Counter({0: 3858, 1: 3833})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.348772342782468 Time :  965
accuracy train: 0.976974 val: 0.956364 test: 0.963470
max validation accuracy : 0.960000 max acc epoch : 3 test accuracy : 0.963014
Counter({0: 3893, 1: 3798})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.747306660516188 Time :  981
accuracy train: 0.983236 val: 0.965455 test: 0.968493
max validation accuracy : 0.965455 max acc epoch : 5 test accuracy : 0.968493
Counter({0: 3860, 1: 3831})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.362304474459961 Time :  998
accuracy train: 0.986265 val: 0.961818 test: 0.970776
max validation accuracy : 0.965455 max acc epoch : 5 test accuracy : 0.968493
Counter({1: 3846, 0: 3845})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.78409073757939 Time :  1015
accuracy train: 0.987477 val: 0.965455 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 5 test accuracy : 0.968493
Counter({1: 3863, 0: 3828})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.703423940227367 Time :  1032
accuracy train: 0.990103 val: 0.969091 test: 0.967123
max validation accuracy : 0.969091 max acc epoch : 8 test accuracy : 0.967123
Counter({0: 3853, 1: 3838})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.759627356892452 Time :  1048
accuracy train: 0.989699 val: 0.967273 test: 0.965297
max validation accuracy : 0.969091 max acc epoch : 8 test accuracy : 0.967123
Counter({1: 3870, 0: 3821})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.380226686655078 Time :  1065
accuracy train: 0.990709 val: 0.969091 test: 0.964840
max validation accuracy : 0.969091 max acc epoch : 8 test accuracy : 0.967123
Counter({1: 3875, 0: 3816})

Epoch :  11 loss training:  4.780449767480604 Time :  1081
accuracy train: 0.991517 val: 0.970909 test: 0.966667
max validation accuracy : 0.970909 max acc epoch : 11 test accuracy : 0.966667
Counter({0: 3853, 1: 3838})

Epoch :  12 loss training:  4.855497292010114 Time :  1099
accuracy train: 0.992123 val: 0.969091 test: 0.963927
max validation accuracy : 0.970909 max acc epoch : 11 test accuracy : 0.966667
Counter({1: 3851, 0: 3840})

Epoch :  13 loss training:  4.3388950125081465 Time :  1115
accuracy train: 0.992729 val: 0.970909 test: 0.965753
max validation accuracy : 0.970909 max acc epoch : 11 test accuracy : 0.966667
Counter({1: 3876, 0: 3815})

Epoch :  14 loss training:  4.201602067099884 Time :  1134
accuracy train: 0.992931 val: 0.967273 test: 0.961187
max validation accuracy : 0.970909 max acc epoch : 11 test accuracy : 0.966667
Counter({1: 3857, 0: 3834})

Epoch :  15 loss training:  4.072870063595474 Time :  1151
accuracy train: 0.993335 val: 0.970909 test: 0.967123
max validation accuracy : 0.970909 max acc epoch : 11 test accuracy : 0.966667
Counter({0: 3859, 1: 3832})

Epoch :  16 loss training:  3.824865224887617 Time :  1169
accuracy train: 0.994547 val: 0.974545 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 16 test accuracy : 0.968037
Counter({1: 3873, 0: 3818})

Epoch :  17 loss training:  3.5487113251001574 Time :  1186
accuracy train: 0.993941 val: 0.972727 test: 0.965297
max validation accuracy : 0.974545 max acc epoch : 16 test accuracy : 0.968037
Counter({1: 3875, 0: 3816})

Epoch :  18 loss training:  3.719215609249659 Time :  1202
accuracy train: 0.994345 val: 0.972727 test: 0.966210
max validation accuracy : 0.974545 max acc epoch : 16 test accuracy : 0.968037
Counter({0: 3875, 1: 3816})

Epoch :  19 loss training:  3.2656398632461787 Time :  1219
accuracy train: 0.995556 val: 0.970909 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 16 test accuracy : 0.968037
Counter({1: 3875, 0: 3816})

Epoch :  20 loss training:  3.340238170727389 Time :  1238
accuracy train: 0.995758 val: 0.969091 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 16 test accuracy : 0.968037
Counter({1: 3875, 0: 3816})

Epoch :  21 loss training:  3.022229250113014 Time :  1255
accuracy train: 0.995354 val: 0.969091 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 16 test accuracy : 0.968037
Counter({0: 3875, 1: 3816})

Epoch :  22 loss training:  2.8331664485740475 Time :  1273
accuracy train: 0.996162 val: 0.970909 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 16 test accuracy : 0.968037
Counter({0: 3873, 1: 3818})

Epoch :  23 loss training:  2.7247081715031527 Time :  1290
accuracy train: 0.996364 val: 0.970909 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 16 test accuracy : 0.968037
Counter({1: 3873, 0: 3818})

Epoch :  24 loss training:  2.5465157082653604 Time :  1308
accuracy train: 0.995354 val: 0.974545 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 16 test accuracy : 0.968037
Counter({1: 3877, 0: 3814})

Epoch :  25 loss training:  2.664629531238461 Time :  1325
accuracy train: 0.995556 val: 0.970909 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 16 test accuracy : 0.968037
Counter({1: 3875, 0: 3816})

Epoch :  26 loss training:  1.9818143040174618 Time :  1343
accuracy train: 0.996162 val: 0.969091 test: 0.967123
max validation accuracy : 0.974545 max acc epoch : 16 test accuracy : 0.968037
Counter({1: 3875, 0: 3816})

Epoch :  27 loss training:  2.186820128612453 Time :  1360
accuracy train: 0.996364 val: 0.974545 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 16 test accuracy : 0.968037
Counter({1: 3902, 0: 3789})

Epoch :  28 loss training:  2.293944698467385 Time :  1377
accuracy train: 0.996566 val: 0.969091 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 16 test accuracy : 0.968037
Counter({0: 3876, 1: 3815})

Epoch :  29 loss training:  2.1323891426072805 Time :  1393
accuracy train: 0.995758 val: 0.965455 test: 0.965753
max validation accuracy : 0.974545 max acc epoch : 16 test accuracy : 0.968037
Counter({1: 3877, 0: 3814})

Epoch :  30 loss training:  2.007590648936457 Time :  1412
accuracy train: 0.996566 val: 0.969091 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 16 test accuracy : 0.968037
Counter({1: 3883, 0: 3808})

Epoch :  31 loss training:  2.202400010533893 Time :  1428
accuracy train: 0.996566 val: 0.969091 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 16 test accuracy : 0.968037
Counter({1: 3913, 0: 3778})

Epoch :  32 loss training:  1.9187138821398548 Time :  1446
accuracy train: 0.996162 val: 0.965455 test: 0.965297
max validation accuracy : 0.974545 max acc epoch : 16 test accuracy : 0.968037
Counter({1: 3880, 0: 3811})

Epoch :  33 loss training:  1.8426526827315683 Time :  1463
accuracy train: 0.996768 val: 0.969091 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 16 test accuracy : 0.968037
Counter({1: 3885, 0: 3806})

Epoch :  34 loss training:  1.912856402923353 Time :  1479
accuracy train: 0.996162 val: 0.970909 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 16 test accuracy : 0.968037
Counter({1: 3882, 0: 3809})

Epoch :  35 loss training:  1.7584138980091666 Time :  1496
accuracy train: 0.996162 val: 0.963636 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 16 test accuracy : 0.968037
Counter({1: 3882, 0: 3809})

Epoch :  36 loss training:  1.6150243823503843 Time :  1512
accuracy train: 0.996768 val: 0.965455 test: 0.966210
max validation accuracy : 0.974545 max acc epoch : 16 test accuracy : 0.968037
Counter({1: 3882, 0: 3809})

Epoch :  37 loss training:  1.6616681753803277 Time :  1531
accuracy train: 0.996566 val: 0.967273 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 16 test accuracy : 0.968037
Counter({0: 3883, 1: 3808})

Epoch :  38 loss training:  1.639735918608494 Time :  1548
accuracy train: 0.996364 val: 0.970909 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 16 test accuracy : 0.968037
Counter({0: 3882, 1: 3809})

Epoch :  39 loss training:  1.7432699711462192 Time :  1565
accuracy train: 0.996566 val: 0.970909 test: 0.964840
max validation accuracy : 0.974545 max acc epoch : 16 test accuracy : 0.968037
Counter({0: 3879, 1: 3812})

Epoch :  40 loss training:  1.6926818899664795 Time :  1581
accuracy train: 0.996768 val: 0.969091 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 16 test accuracy : 0.968037
Counter({1: 3877, 0: 3814})

Epoch :  41 loss training:  1.7709487988686305 Time :  1599
accuracy train: 0.996970 val: 0.976364 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({1: 3881, 0: 3810})

Epoch :  42 loss training:  1.653030726884026 Time :  1615
accuracy train: 0.996364 val: 0.972727 test: 0.964384
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({1: 3880, 0: 3811})

Epoch :  43 loss training:  1.4159117791859899 Time :  1632
accuracy train: 0.996768 val: 0.969091 test: 0.967123
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({1: 3881, 0: 3810})

Epoch :  44 loss training:  1.524288007098221 Time :  1650
accuracy train: 0.996970 val: 0.972727 test: 0.967580
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({1: 3881, 0: 3810})

Epoch :  45 loss training:  1.6279840436363884 Time :  1668
accuracy train: 0.996566 val: 0.970909 test: 0.966210
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({1: 3880, 0: 3811})

Epoch :  46 loss training:  2.737998948257882 Time :  1686
accuracy train: 0.996970 val: 0.972727 test: 0.965753
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({0: 3880, 1: 3811})

Epoch :  47 loss training:  1.8642253286270716 Time :  1704
accuracy train: 0.996364 val: 0.969091 test: 0.968493
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({1: 3880, 0: 3811})

Epoch :  48 loss training:  1.7309419097800856 Time :  1721
accuracy train: 0.996566 val: 0.967273 test: 0.967123
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({1: 3880, 0: 3811})

Epoch :  49 loss training:  1.8079053622896026 Time :  1739
accuracy train: 0.996768 val: 0.974545 test: 0.966210
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({1: 3883, 0: 3808})

Epoch :  50 loss training:  1.4346628453131416 Time :  1756
accuracy train: 0.996768 val: 0.969091 test: 0.965297
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({1: 3883, 0: 3808})

Epoch :  51 loss training:  1.302176291404976 Time :  1773
accuracy train: 0.996970 val: 0.974545 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({1: 3883, 0: 3808})

Epoch :  52 loss training:  1.3944412932924024 Time :  1791
accuracy train: 0.996566 val: 0.970909 test: 0.967123
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({1: 3884, 0: 3807})

Epoch :  53 loss training:  1.4203297435515196 Time :  1808
accuracy train: 0.996566 val: 0.969091 test: 0.967580
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({1: 3886, 0: 3805})

Epoch :  54 loss training:  1.5205888675955066 Time :  1825
accuracy train: 0.996768 val: 0.972727 test: 0.966210
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({1: 3886, 0: 3805})

Epoch :  55 loss training:  1.4986759482926573 Time :  1842
accuracy train: 0.997374 val: 0.974545 test: 0.966210
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({0: 3888, 1: 3803})

Epoch :  56 loss training:  1.4830882594869763 Time :  1859
accuracy train: 0.996364 val: 0.970909 test: 0.963927
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({1: 3885, 0: 3806})

Epoch :  57 loss training:  1.3250671597870678 Time :  1877
accuracy train: 0.996566 val: 0.972727 test: 0.966210
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({1: 3885, 0: 3806})

Epoch :  58 loss training:  1.3586813302199516 Time :  1894
accuracy train: 0.996768 val: 0.970909 test: 0.965297
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({1: 3885, 0: 3806})

Epoch :  59 loss training:  1.5309339242521673 Time :  1911
accuracy train: 0.996768 val: 0.969091 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({1: 3886, 0: 3805})

Epoch :  60 loss training:  1.2295449650300725 Time :  1927
accuracy train: 0.996970 val: 0.969091 test: 0.968493
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({1: 3886, 0: 3805})

Epoch :  61 loss training:  1.4169137795015558 Time :  1945
accuracy train: 0.997374 val: 0.969091 test: 0.963014
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({0: 3885, 1: 3806})

Epoch :  62 loss training:  1.542061894224389 Time :  1962
accuracy train: 0.996364 val: 0.969091 test: 0.963927
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({1: 3885, 0: 3806})

Epoch :  63 loss training:  1.4222208075007075 Time :  1979
accuracy train: 0.996970 val: 0.970909 test: 0.966667
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({1: 3885, 0: 3806})

Epoch :  64 loss training:  1.5463625433858397 Time :  1996
accuracy train: 0.997172 val: 0.970909 test: 0.966210
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({0: 3885, 1: 3806})

Epoch :  65 loss training:  1.4423039960729511 Time :  2013
accuracy train: 0.996768 val: 0.969091 test: 0.964840
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({1: 3885, 0: 3806})

Epoch :  66 loss training:  1.393566090733657 Time :  2030
accuracy train: 0.996768 val: 0.969091 test: 0.964384
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({1: 3885, 0: 3806})

Epoch :  67 loss training:  1.4986859737491613 Time :  2047
accuracy train: 0.996768 val: 0.969091 test: 0.963927
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({1: 3885, 0: 3806})

Epoch :  68 loss training:  1.219133960000363 Time :  2064
accuracy train: 0.997172 val: 0.974545 test: 0.964840
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({0: 3885, 1: 3806})

Epoch :  69 loss training:  1.4957397335529095 Time :  2079
accuracy train: 0.997374 val: 0.970909 test: 0.963470
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({1: 3885, 0: 3806})

Epoch :  70 loss training:  1.1978734712629375 Time :  2096
accuracy train: 0.996768 val: 0.974545 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({0: 3885, 1: 3806})

Epoch :  71 loss training:  1.2488507981961448 Time :  2113
accuracy train: 0.996768 val: 0.969091 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({1: 3884, 0: 3807})

Epoch :  72 loss training:  1.2778565915041327 Time :  2131
accuracy train: 0.997172 val: 0.970909 test: 0.965753
max validation accuracy : 0.976364 max acc epoch : 41 test accuracy : 0.970320
Counter({1: 3884, 0: 3807})

========================================================================================================================================================================================================
best acc epoch :  41
validation accuracy :  0.9763636363636363
test accuracy :  0.9703196347031964
last test_accuracy :  0.9657534246575342
second best val :  0.9745454545454545
second best test :  0.9680365296803652
max gap 25
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  20 	 val_accuracy : 0.96545 	 test_accuracy : 0.96941 	 last test_accuracy : 0.96849 	 second best val : 0.96364 	 second best test : 0.96941
k :  1 	 best_acc epoch :  41 	 val_accuracy : 0.97636 	 test_accuracy : 0.97032 	 last test_accuracy : 0.96575 	 second best val : 0.97455 	 second best test : 0.96804

avg :  	 val_accuracy : 0.97091 	 test_accuracy : 0.96986 	 last_accuracy : 0.96712 	 second best val : 0.96909 	 second best test : 0.96872

std :  	 val_accuracy : 0.00545 	 test_accuracy : 0.00046 	 last_accuracy : 0.00137 	 second best val : 0.00545 	 second best test : 0.00068
