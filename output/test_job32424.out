

date and time :  Fri May  7 18:45:56 2021
Namespace(batch_size=32, dataset='ohsumed', device=0, dropout=0.5, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=0)
device :  cuda:0
min_len_of_sentence : 1
max_len_of_sentence : 241
min_num_of_sentence : 5
max_num_of_sentence : 345
average_len_of_sentence: 5.897566187394481
average_num_of_sentence: 90.68743243243243
Total_num_of_sentence : 671087
Counter({'C14': 1175, 'C04': 1030, 'C23': 796, 'C10': 557, 'C21': 553, 'C20': 410, 'C06': 354, 'C12': 342, 'C18': 323, 'C08': 250, 'C17': 233, 'C05': 223, 'C01': 216, 'C13': 195, 'C15': 133, 'C16': 129, 'C11': 125, 'C19': 86, 'C02': 75, 'C07': 63, 'C09': 63, 'C03': 50, 'C22': 19})
Total_number_of_words: 12909
Total_number_of_categories: 23
vocab size : 12909
got embeddings of : 12169

Epoch :  1 loss training:  492.9620097875595 Time :  98
accuracy train: 0.608537 val: 0.585075 test: 0.575068
max validation accuracy : 0.585075 max acc epoch : 1 test accuracy : 0.575068
Epoch-1 lr: 0.001

Epoch :  2 loss training:  323.48542070388794 Time :  130
accuracy train: 0.679682 val: 0.644776 test: 0.638882
max validation accuracy : 0.644776 max acc epoch : 2 test accuracy : 0.638882
Epoch-2 lr: 0.001

Epoch :  3 loss training:  294.88033974170685 Time :  161
accuracy train: 0.670417 val: 0.626866 test: 0.627999
max validation accuracy : 0.644776 max acc epoch : 2 test accuracy : 0.638882
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  256.64413499832153 Time :  192
accuracy train: 0.727333 val: 0.659701 test: 0.660401
max validation accuracy : 0.659701 max acc epoch : 4 test accuracy : 0.660401
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  246.85304760932922 Time :  222
accuracy train: 0.742555 val: 0.665672 test: 0.669058
max validation accuracy : 0.665672 max acc epoch : 5 test accuracy : 0.669058
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  232.12079441547394 Time :  250
accuracy train: 0.773329 val: 0.713433 test: 0.676478
max validation accuracy : 0.713433 max acc epoch : 6 test accuracy : 0.676478
Counter({10: 1293, 1: 1059, 5: 695, 3: 670, 8: 668, 2: 491, 0: 475, 9: 437, 7: 417, 6: 415, 4: 404, 11: 376})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  355.05236303806305 Time :  283
accuracy train: 0.747518 val: 0.647761 test: 0.673015
max validation accuracy : 0.713433 max acc epoch : 6 test accuracy : 0.676478
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  284.41594409942627 Time :  313
accuracy train: 0.755791 val: 0.704478 test: 0.684887
max validation accuracy : 0.713433 max acc epoch : 6 test accuracy : 0.676478
Counter({0: 1364, 4: 1145, 8: 762, 1: 564, 9: 523, 7: 481, 3: 473, 10: 461, 2: 432, 11: 429, 5: 426, 6: 340})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  257.5400973558426 Time :  346
accuracy train: 0.760424 val: 0.725373 test: 0.689092
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.689092
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  238.90456533432007 Time :  376
accuracy train: 0.756122 val: 0.698507 test: 0.688103
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.689092
Counter({4: 1330, 9: 1133, 8: 797, 5: 580, 0: 505, 11: 497, 6: 464, 7: 439, 2: 438, 3: 432, 1: 414, 10: 371})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  233.41706442832947 Time :  407
accuracy train: 0.758769 val: 0.707463 test: 0.691071
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.689092
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  229.50457453727722 Time :  437
accuracy train: 0.763071 val: 0.698507 test: 0.691071
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.689092
Counter({2: 1320, 8: 1083, 10: 769, 4: 584, 3: 522, 7: 501, 11: 488, 0: 462, 6: 455, 5: 440, 9: 401, 1: 375})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  226.8808833360672 Time :  470
accuracy train: 0.762740 val: 0.710448 test: 0.692308
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.689092
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  226.70849120616913 Time :  500
accuracy train: 0.765387 val: 0.713433 test: 0.694039
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.689092
Counter({2: 1344, 11: 1094, 0: 671, 8: 607, 1: 595, 6: 502, 9: 502, 10: 444, 5: 434, 3: 431, 4: 413, 7: 363})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  221.59185403585434 Time :  535
accuracy train: 0.765387 val: 0.719403 test: 0.693297
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.689092

Epoch :  16 loss training:  218.2737619280815 Time :  564
accuracy train: 0.764725 val: 0.716418 test: 0.696512
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.689092
Counter({1: 1347, 2: 1108, 7: 781, 8: 596, 6: 513, 11: 496, 3: 486, 10: 443, 4: 426, 0: 421, 9: 420, 5: 363})

Epoch :  17 loss training:  223.7582015991211 Time :  596
accuracy train: 0.766049 val: 0.713433 test: 0.694534
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.689092

Epoch :  18 loss training:  221.59134018421173 Time :  625
accuracy train: 0.773660 val: 0.698507 test: 0.694781
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.689092
Counter({4: 1327, 3: 1105, 6: 673, 10: 609, 8: 590, 5: 518, 11: 475, 7: 456, 9: 431, 2: 418, 1: 411, 0: 387})

Epoch :  19 loss training:  216.9880452156067 Time :  657
accuracy train: 0.768034 val: 0.710448 test: 0.702449
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.689092

Epoch :  20 loss training:  214.003104865551 Time :  688
accuracy train: 0.771013 val: 0.704478 test: 0.696760
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.689092
Counter({2: 1349, 1: 1079, 3: 728, 7: 684, 11: 596, 9: 480, 6: 471, 4: 440, 10: 423, 8: 409, 5: 406, 0: 335})

Epoch :  21 loss training:  208.0455847978592 Time :  721
accuracy train: 0.766380 val: 0.704478 test: 0.693792
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.689092

Epoch :  22 loss training:  212.27624893188477 Time :  752
accuracy train: 0.772998 val: 0.698507 test: 0.694039
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.689092
Counter({3: 1335, 4: 1073, 8: 715, 1: 691, 2: 606, 0: 499, 6: 467, 9: 441, 7: 422, 10: 415, 5: 411, 11: 325})

Epoch :  23 loss training:  206.8285917043686 Time :  784
accuracy train: 0.779285 val: 0.719403 test: 0.701954
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.689092

Epoch :  24 loss training:  202.9754131436348 Time :  816
accuracy train: 0.782263 val: 0.716418 test: 0.697997
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.689092
Counter({6: 1337, 1: 1061, 2: 723, 0: 701, 3: 613, 11: 470, 9: 468, 10: 440, 8: 440, 5: 424, 4: 404, 7: 319})

Epoch :  25 loss training:  209.94145846366882 Time :  850
accuracy train: 0.782594 val: 0.716418 test: 0.701459
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.689092

Epoch :  26 loss training:  200.4989743232727 Time :  880
accuracy train: 0.782925 val: 0.707463 test: 0.702943
max validation accuracy : 0.725373 max acc epoch : 9 test accuracy : 0.689092
Counter({4: 1327, 1: 1051, 11: 684, 2: 605, 5: 595, 3: 507, 8: 473, 7: 465, 6: 446, 0: 424, 10: 417, 9: 406})

Epoch :  27 loss training:  197.07781249284744 Time :  913
accuracy train: 0.788551 val: 0.728358 test: 0.704427
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427

Epoch :  28 loss training:  194.37939697504044 Time :  943
accuracy train: 0.785572 val: 0.707463 test: 0.704427
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427
Counter({5: 1336, 7: 1064, 4: 660, 2: 614, 9: 581, 8: 536, 3: 502, 6: 465, 0: 448, 10: 408, 1: 397, 11: 389})

Epoch :  29 loss training:  197.5563598871231 Time :  975
accuracy train: 0.789874 val: 0.710448 test: 0.702201
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427

Epoch :  30 loss training:  194.62555849552155 Time :  1006
accuracy train: 0.794176 val: 0.728358 test: 0.705169
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427
Counter({1: 1343, 7: 1059, 3: 686, 10: 610, 0: 579, 6: 533, 2: 491, 4: 458, 5: 431, 8: 414, 11: 408, 9: 388})

Epoch :  31 loss training:  198.30741375684738 Time :  1039
accuracy train: 0.799471 val: 0.722388 test: 0.702943
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427

Epoch :  32 loss training:  190.6613095998764 Time :  1069
accuracy train: 0.800132 val: 0.722388 test: 0.706901
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427
Counter({1: 1343, 4: 1060, 3: 737, 6: 726, 5: 578, 2: 508, 11: 463, 7: 442, 0: 411, 9: 409, 8: 407, 10: 316})

Epoch :  33 loss training:  183.2441267967224 Time :  1102
accuracy train: 0.800463 val: 0.716418 test: 0.706159
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427

Epoch :  34 loss training:  186.62909352779388 Time :  1132
accuracy train: 0.800463 val: 0.713433 test: 0.703438
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427
Counter({5: 1337, 8: 1064, 0: 737, 3: 734, 10: 589, 4: 500, 2: 457, 11: 440, 1: 415, 9: 409, 7: 407, 6: 311})

Epoch :  35 loss training:  181.75044798851013 Time :  1165
accuracy train: 0.805758 val: 0.722388 test: 0.705911
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427

Epoch :  36 loss training:  179.63693088293076 Time :  1195
accuracy train: 0.801456 val: 0.716418 test: 0.706406
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427
Counter({1: 1348, 2: 1057, 9: 726, 4: 723, 3: 593, 0: 503, 6: 467, 10: 446, 5: 412, 7: 408, 8: 399, 11: 318})

Epoch :  37 loss training:  172.79103261232376 Time :  1228
accuracy train: 0.808405 val: 0.722388 test: 0.707395
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427

Epoch :  38 loss training:  178.35220462083817 Time :  1260
accuracy train: 0.808736 val: 0.722388 test: 0.706901
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427
Counter({9: 1346, 1: 1067, 3: 732, 7: 728, 5: 598, 2: 513, 6: 465, 8: 439, 11: 408, 0: 403, 4: 399, 10: 302})

Epoch :  39 loss training:  168.4313267469406 Time :  1293
accuracy train: 0.807743 val: 0.716418 test: 0.704675
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427

Epoch :  40 loss training:  173.2445713877678 Time :  1324
accuracy train: 0.813700 val: 0.722388 test: 0.707395
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427
Counter({7: 1352, 3: 1064, 2: 743, 9: 718, 8: 586, 1: 506, 5: 455, 6: 452, 4: 410, 10: 403, 11: 397, 0: 314})

Epoch :  41 loss training:  174.15035718679428 Time :  1356
accuracy train: 0.811714 val: 0.713433 test: 0.703933
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427

Epoch :  42 loss training:  170.490576505661 Time :  1387
accuracy train: 0.813369 val: 0.725373 test: 0.703685
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427
Counter({1: 1345, 6: 1068, 9: 796, 7: 665, 2: 592, 0: 536, 4: 459, 5: 442, 8: 406, 10: 395, 3: 391, 11: 305})

Epoch :  43 loss training:  166.09421145915985 Time :  1419
accuracy train: 0.817009 val: 0.719403 test: 0.709127
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427

Epoch :  44 loss training:  159.5229566693306 Time :  1451
accuracy train: 0.819987 val: 0.713433 test: 0.707395
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427
Counter({3: 1319, 8: 1068, 11: 701, 2: 586, 4: 560, 1: 555, 7: 534, 5: 453, 6: 450, 0: 403, 9: 397, 10: 374})

Epoch :  45 loss training:  166.5080183148384 Time :  1483
accuracy train: 0.820979 val: 0.716418 test: 0.710364
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427

Epoch :  46 loss training:  174.83831906318665 Time :  1513
accuracy train: 0.822965 val: 0.713433 test: 0.709127
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427
Counter({2: 1330, 8: 1077, 1: 822, 4: 679, 0: 567, 9: 516, 5: 460, 10: 453, 7: 398, 6: 395, 3: 393, 11: 310})

Epoch :  47 loss training:  166.67153310775757 Time :  1545
accuracy train: 0.825612 val: 0.725373 test: 0.709622
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427

Epoch :  48 loss training:  157.46894696354866 Time :  1575
accuracy train: 0.830245 val: 0.728358 test: 0.714074
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427
Counter({4: 1342, 2: 1076, 0: 762, 1: 724, 8: 589, 10: 509, 7: 463, 11: 452, 3: 397, 5: 395, 6: 392, 9: 299})

Epoch :  49 loss training:  158.80591049790382 Time :  1607
accuracy train: 0.831899 val: 0.725373 test: 0.712095
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427

Epoch :  50 loss training:  154.9986990094185 Time :  1637
accuracy train: 0.834547 val: 0.719403 test: 0.712095
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427
Counter({8: 1347, 4: 1074, 5: 823, 6: 663, 3: 587, 9: 507, 1: 466, 2: 450, 0: 399, 11: 395, 10: 384, 7: 305})

Epoch :  51 loss training:  151.48682934045792 Time :  1671
accuracy train: 0.832561 val: 0.716418 test: 0.708385
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427

Epoch :  52 loss training:  153.33643782138824 Time :  1701
accuracy train: 0.833223 val: 0.710448 test: 0.710611
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427
Counter({6: 1324, 1: 1065, 11: 692, 7: 600, 3: 598, 2: 539, 0: 498, 10: 470, 4: 442, 5: 410, 8: 403, 9: 359})

Epoch :  53 loss training:  150.1921842098236 Time :  1733
accuracy train: 0.838187 val: 0.713433 test: 0.710116
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427

Epoch :  54 loss training:  153.79608100652695 Time :  1762
accuracy train: 0.833554 val: 0.722388 test: 0.708138
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427
Counter({5: 1345, 1: 1043, 6: 751, 3: 705, 8: 652, 11: 505, 10: 467, 4: 448, 9: 400, 0: 398, 7: 389, 2: 297})

Epoch :  55 loss training:  147.75123113393784 Time :  1794
accuracy train: 0.845136 val: 0.713433 test: 0.711848
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427

Epoch :  56 loss training:  145.2956657409668 Time :  1826
accuracy train: 0.841165 val: 0.719403 test: 0.710858
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427
Counter({3: 1336, 1: 1048, 10: 708, 5: 627, 7: 611, 0: 506, 2: 501, 8: 461, 11: 438, 4: 405, 9: 399, 6: 360})

Epoch :  57 loss training:  143.85056501626968 Time :  1859
accuracy train: 0.844474 val: 0.713433 test: 0.714816
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427

Epoch :  58 loss training:  141.985176384449 Time :  1890
accuracy train: 0.841496 val: 0.710448 test: 0.713084
max validation accuracy : 0.728358 max acc epoch : 27 test accuracy : 0.704427
Counter({8: 1332, 6: 1057, 10: 725, 7: 611, 11: 604, 3: 529, 2: 469, 9: 467, 5: 434, 1: 405, 0: 395, 4: 372})

========================================================================================================================================================================================================
max acc epoch :  27
max validation accuracy :  0.7283582089552239
test accuracy :  0.7044274053920356
last test_accuracy :  0.7130843433094237
========================================================================================================================================================================================================

