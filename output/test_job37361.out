

date and time :  Mon Jun 14 12:44:43 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=208, tsne=False, weight_decay=1e-06)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  41.932660188525915 Time :  18
accuracy train: 0.954555 val: 0.949091 test: 0.952511
max validation accuracy : 0.949091 max acc epoch : 1 test accuracy : 0.952511
Counter({0: 4094, 1: 3597})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.96300725452602 Time :  52
accuracy train: 0.970309 val: 0.976364 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 2 test accuracy : 0.969406
Counter({0: 4007, 1: 3684})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.849957655183971 Time :  72
accuracy train: 0.961220 val: 0.963636 test: 0.946575
max validation accuracy : 0.976364 max acc epoch : 2 test accuracy : 0.969406
Counter({0: 3888, 1: 3803})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.37823718553409 Time :  100
accuracy train: 0.980610 val: 0.972727 test: 0.967580
max validation accuracy : 0.976364 max acc epoch : 2 test accuracy : 0.969406
Counter({0: 3872, 1: 3819})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.17642131599132 Time :  118
accuracy train: 0.984448 val: 0.969091 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 2 test accuracy : 0.969406
Counter({1: 3849, 0: 3842})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.773845702176914 Time :  144
accuracy train: 0.986265 val: 0.970909 test: 0.966667
max validation accuracy : 0.976364 max acc epoch : 2 test accuracy : 0.969406
Counter({0: 3854, 1: 3837})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.436656684149057 Time :  162
accuracy train: 0.989699 val: 0.974545 test: 0.968950
max validation accuracy : 0.976364 max acc epoch : 2 test accuracy : 0.969406
Counter({0: 3849, 1: 3842})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  7.048639293760061 Time :  191
accuracy train: 0.990911 val: 0.970909 test: 0.964840
max validation accuracy : 0.976364 max acc epoch : 2 test accuracy : 0.969406
Counter({1: 3853, 0: 3838})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.599078860832378 Time :  212
accuracy train: 0.989295 val: 0.976364 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 2 test accuracy : 0.969406
Counter({1: 3860, 0: 3831})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.758528807549737 Time :  240
accuracy train: 0.990103 val: 0.978182 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.973973
Counter({1: 3862, 0: 3829})

Epoch :  11 loss training:  5.560133433318697 Time :  258
accuracy train: 0.992123 val: 0.972727 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.973973
Counter({1: 3866, 0: 3825})

Epoch :  12 loss training:  5.021774507244118 Time :  287
accuracy train: 0.992931 val: 0.974545 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.973973
Counter({1: 3867, 0: 3824})

Epoch :  13 loss training:  4.612564842274878 Time :  307
accuracy train: 0.992729 val: 0.976364 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.973973
Counter({1: 3869, 0: 3822})

Epoch :  14 loss training:  4.352974656037986 Time :  334
accuracy train: 0.993739 val: 0.980000 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 14 test accuracy : 0.974429
Counter({1: 3875, 0: 3816})

Epoch :  15 loss training:  4.252175979316235 Time :  363
accuracy train: 0.994749 val: 0.974545 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 14 test accuracy : 0.974429
Counter({0: 3874, 1: 3817})

Epoch :  16 loss training:  4.5024164194474 Time :  384
accuracy train: 0.994143 val: 0.978182 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 14 test accuracy : 0.974429
Counter({1: 3891, 0: 3800})

Epoch :  17 loss training:  3.8226821995922364 Time :  404
accuracy train: 0.993739 val: 0.978182 test: 0.970320
max validation accuracy : 0.980000 max acc epoch : 14 test accuracy : 0.974429
Counter({1: 3891, 0: 3800})

Epoch :  18 loss training:  4.101047085481696 Time :  434
accuracy train: 0.994951 val: 0.981818 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 18 test accuracy : 0.972603
Counter({1: 3897, 0: 3794})

Epoch :  19 loss training:  3.8069370200973935 Time :  462
accuracy train: 0.995354 val: 0.976364 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 18 test accuracy : 0.972603
Counter({0: 3898, 1: 3793})

Epoch :  20 loss training:  3.3330650946008973 Time :  480
accuracy train: 0.994951 val: 0.980000 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 18 test accuracy : 0.972603
Counter({1: 3899, 0: 3792})

Epoch :  21 loss training:  3.085272465890739 Time :  517
accuracy train: 0.995556 val: 0.983636 test: 0.968037
max validation accuracy : 0.983636 max acc epoch : 21 test accuracy : 0.968037
Counter({1: 3908, 0: 3783})

Epoch :  22 loss training:  3.086089039570652 Time :  547
accuracy train: 0.995758 val: 0.976364 test: 0.973059
max validation accuracy : 0.983636 max acc epoch : 21 test accuracy : 0.968037
Counter({1: 3908, 0: 3783})

Epoch :  23 loss training:  2.49789165816037 Time :  567
accuracy train: 0.995354 val: 0.976364 test: 0.970320
max validation accuracy : 0.983636 max acc epoch : 21 test accuracy : 0.968037
Counter({0: 3912, 1: 3779})

Epoch :  24 loss training:  3.0035640020796563 Time :  605
accuracy train: 0.995960 val: 0.976364 test: 0.971233
max validation accuracy : 0.983636 max acc epoch : 21 test accuracy : 0.968037
Counter({1: 3914, 0: 3777})

Epoch :  25 loss training:  2.7021817651111633 Time :  630
accuracy train: 0.995556 val: 0.974545 test: 0.973516
max validation accuracy : 0.983636 max acc epoch : 21 test accuracy : 0.968037
Counter({1: 3920, 0: 3771})

Epoch :  26 loss training:  2.5096574019116815 Time :  653
accuracy train: 0.996162 val: 0.978182 test: 0.970776
max validation accuracy : 0.983636 max acc epoch : 21 test accuracy : 0.968037
Counter({1: 3921, 0: 3770})

Epoch :  27 loss training:  2.3197720341559034 Time :  686
accuracy train: 0.995354 val: 0.976364 test: 0.971233
max validation accuracy : 0.983636 max acc epoch : 21 test accuracy : 0.968037
Counter({1: 3923, 0: 3768})

Epoch :  28 loss training:  2.307045657769777 Time :  713
accuracy train: 0.995556 val: 0.983636 test: 0.969406
max validation accuracy : 0.983636 max acc epoch : 21 test accuracy : 0.968037
Counter({1: 3922, 0: 3769})

Epoch :  29 loss training:  2.270819443074288 Time :  731
accuracy train: 0.996364 val: 0.972727 test: 0.968493
max validation accuracy : 0.983636 max acc epoch : 21 test accuracy : 0.968037
Counter({1: 3924, 0: 3767})

Epoch :  30 loss training:  2.0337142520584166 Time :  764
accuracy train: 0.995960 val: 0.976364 test: 0.966210
max validation accuracy : 0.983636 max acc epoch : 21 test accuracy : 0.968037
Counter({1: 3924, 0: 3767})

Epoch :  31 loss training:  2.103051909842179 Time :  792
accuracy train: 0.995758 val: 0.978182 test: 0.971233
max validation accuracy : 0.983636 max acc epoch : 21 test accuracy : 0.968037
Counter({0: 3928, 1: 3763})

Epoch :  32 loss training:  3.4481786674587056 Time :  813
accuracy train: 0.996566 val: 0.983636 test: 0.967580
max validation accuracy : 0.983636 max acc epoch : 21 test accuracy : 0.968037
Counter({1: 3928, 0: 3763})

========================================================================================================================================================================================================
best acc epoch :  21
validation accuracy :  0.9836363636363636
test accuracy :  0.9680365296803652
last test_accuracy :  0.9675799086757991
second best val :  0.9818181818181818
second best test :  0.9726027397260274
max gap 8
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=579, tsne=False, weight_decay=1e-06)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  40.93979422003031 Time :  898
accuracy train: 0.958594 val: 0.969091 test: 0.957078
max validation accuracy : 0.969091 max acc epoch : 1 test accuracy : 0.957078
Counter({0: 3888, 1: 3803})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.807511907303706 Time :  917
accuracy train: 0.959200 val: 0.967273 test: 0.965297
max validation accuracy : 0.969091 max acc epoch : 1 test accuracy : 0.957078
Counter({0: 3925, 1: 3766})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.07990872580558 Time :  950
accuracy train: 0.972531 val: 0.956364 test: 0.952511
max validation accuracy : 0.969091 max acc epoch : 1 test accuracy : 0.957078
Counter({0: 3888, 1: 3803})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.206154918298125 Time :  976
accuracy train: 0.981418 val: 0.978182 test: 0.963927
max validation accuracy : 0.978182 max acc epoch : 4 test accuracy : 0.963927
Counter({0: 3882, 1: 3809})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.030761472182348 Time :  996
accuracy train: 0.983438 val: 0.983636 test: 0.961187
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.961187
Counter({0: 3849, 1: 3842})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.513551098294556 Time :  1030
accuracy train: 0.985054 val: 0.980000 test: 0.960274
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.961187
Counter({1: 3853, 0: 3838})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.740608714171685 Time :  1054
accuracy train: 0.990709 val: 0.983636 test: 0.964840
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.961187
Counter({1: 3858, 0: 3833})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.614886418916285 Time :  1077
accuracy train: 0.991113 val: 0.987273 test: 0.968037
max validation accuracy : 0.987273 max acc epoch : 8 test accuracy : 0.968037
Counter({1: 3865, 0: 3826})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.596644693985581 Time :  1108
accuracy train: 0.990911 val: 0.978182 test: 0.966210
max validation accuracy : 0.987273 max acc epoch : 8 test accuracy : 0.968037
Counter({0: 3874, 1: 3817})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.407177591463551 Time :  1128
accuracy train: 0.989901 val: 0.987273 test: 0.970776
max validation accuracy : 0.987273 max acc epoch : 8 test accuracy : 0.968037
Counter({1: 3874, 0: 3817})

Epoch :  11 loss training:  5.126447009504773 Time :  1149
accuracy train: 0.993133 val: 0.980000 test: 0.963927
max validation accuracy : 0.987273 max acc epoch : 8 test accuracy : 0.968037
Counter({1: 3884, 0: 3807})

Epoch :  12 loss training:  5.977811536053196 Time :  1185
accuracy train: 0.992123 val: 0.987273 test: 0.966210
max validation accuracy : 0.987273 max acc epoch : 8 test accuracy : 0.968037
Counter({1: 3889, 0: 3802})

Epoch :  13 loss training:  4.6983835537103005 Time :  1203
accuracy train: 0.993335 val: 0.987273 test: 0.970776
max validation accuracy : 0.987273 max acc epoch : 8 test accuracy : 0.968037
Counter({1: 3896, 0: 3795})

Epoch :  14 loss training:  4.468536767410114 Time :  1236
accuracy train: 0.993941 val: 0.989091 test: 0.967123
max validation accuracy : 0.989091 max acc epoch : 14 test accuracy : 0.967123
Counter({1: 3900, 0: 3791})

Epoch :  15 loss training:  4.233746435493231 Time :  1267
accuracy train: 0.993941 val: 0.989091 test: 0.971689
max validation accuracy : 0.989091 max acc epoch : 14 test accuracy : 0.967123
Counter({0: 3920, 1: 3771})

Epoch :  16 loss training:  4.0839938127901405 Time :  1286
accuracy train: 0.994345 val: 0.987273 test: 0.968493
max validation accuracy : 0.989091 max acc epoch : 14 test accuracy : 0.967123
Counter({1: 3923, 0: 3768})

Epoch :  17 loss training:  3.585967163380701 Time :  1321
accuracy train: 0.994547 val: 0.989091 test: 0.967123
max validation accuracy : 0.989091 max acc epoch : 14 test accuracy : 0.967123
Counter({1: 3922, 0: 3769})

Epoch :  18 loss training:  3.6271153485868126 Time :  1345
accuracy train: 0.994345 val: 0.987273 test: 0.968493
max validation accuracy : 0.989091 max acc epoch : 14 test accuracy : 0.967123
Counter({1: 3923, 0: 3768})

Epoch :  19 loss training:  3.69333483511582 Time :  1368
accuracy train: 0.994547 val: 0.987273 test: 0.965297
max validation accuracy : 0.989091 max acc epoch : 14 test accuracy : 0.967123
Counter({1: 3924, 0: 3767})

Epoch :  20 loss training:  3.2580819571157917 Time :  1403
accuracy train: 0.995152 val: 0.987273 test: 0.963927
max validation accuracy : 0.989091 max acc epoch : 14 test accuracy : 0.967123
Counter({1: 3926, 0: 3765})

Epoch :  21 loss training:  3.0867129190592095 Time :  1424
accuracy train: 0.994143 val: 0.985455 test: 0.964840
max validation accuracy : 0.989091 max acc epoch : 14 test accuracy : 0.967123
Counter({1: 3931, 0: 3760})

Epoch :  22 loss training:  2.9559500026516616 Time :  1455
accuracy train: 0.995556 val: 0.987273 test: 0.967123
max validation accuracy : 0.989091 max acc epoch : 14 test accuracy : 0.967123
Counter({1: 3932, 0: 3759})

Epoch :  23 loss training:  2.686959602171555 Time :  1490
accuracy train: 0.995758 val: 0.987273 test: 0.968950
max validation accuracy : 0.989091 max acc epoch : 14 test accuracy : 0.967123
Counter({0: 3934, 1: 3757})

Epoch :  24 loss training:  2.7734434496960603 Time :  1511
accuracy train: 0.995758 val: 0.985455 test: 0.968493
max validation accuracy : 0.989091 max acc epoch : 14 test accuracy : 0.967123
Counter({1: 3935, 0: 3756})

Epoch :  25 loss training:  2.393344106443692 Time :  1544
accuracy train: 0.995960 val: 0.987273 test: 0.967580
max validation accuracy : 0.989091 max acc epoch : 14 test accuracy : 0.967123
Counter({1: 3936, 0: 3755})

========================================================================================================================================================================================================
best acc epoch :  14
validation accuracy :  0.9890909090909091
test accuracy :  0.9671232876712329
last test_accuracy :  0.9675799086757991
second best val :  0.9872727272727273
second best test :  0.9680365296803652
max gap 6
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=313, tsne=False, weight_decay=1e-06)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  44.8809814080596 Time :  1575
accuracy train: 0.954151 val: 0.950909 test: 0.954338
max validation accuracy : 0.950909 max acc epoch : 1 test accuracy : 0.954338
Counter({0: 4028, 1: 3663})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.30915108602494 Time :  1610
accuracy train: 0.971925 val: 0.963636 test: 0.958904
max validation accuracy : 0.963636 max acc epoch : 2 test accuracy : 0.958904
Counter({0: 4027, 1: 3664})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.483939720317721 Time :  1644
accuracy train: 0.965462 val: 0.954545 test: 0.959361
max validation accuracy : 0.963636 max acc epoch : 2 test accuracy : 0.958904
Counter({0: 3956, 1: 3735})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.785762677202001 Time :  1662
accuracy train: 0.981822 val: 0.970909 test: 0.967123
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.967123
Counter({0: 3870, 1: 3821})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.604734466411173 Time :  1701
accuracy train: 0.985054 val: 0.970909 test: 0.964384
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.967123
Counter({0: 3874, 1: 3817})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.55589729687199 Time :  1719
accuracy train: 0.987073 val: 0.969091 test: 0.960274
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.967123
Counter({0: 3861, 1: 3830})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.83982895873487 Time :  1745
accuracy train: 0.989295 val: 0.974545 test: 0.963927
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.963927
Counter({1: 3866, 0: 3825})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  7.077363797929138 Time :  1778
accuracy train: 0.988891 val: 0.972727 test: 0.965753
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.963927
Counter({0: 3866, 1: 3825})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  7.026506509864703 Time :  1797
accuracy train: 0.990507 val: 0.976364 test: 0.967580
max validation accuracy : 0.976364 max acc epoch : 9 test accuracy : 0.967580
Counter({0: 3861, 1: 3830})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.3362742877798155 Time :  1828
accuracy train: 0.991517 val: 0.983636 test: 0.965297
max validation accuracy : 0.983636 max acc epoch : 10 test accuracy : 0.965297
Counter({1: 3855, 0: 3836})

Epoch :  11 loss training:  5.857293050503358 Time :  1859
accuracy train: 0.991113 val: 0.978182 test: 0.969406
max validation accuracy : 0.983636 max acc epoch : 10 test accuracy : 0.965297
Counter({0: 3852, 1: 3839})

Epoch :  12 loss training:  5.264343414688483 Time :  1877
accuracy train: 0.992931 val: 0.972727 test: 0.965297
max validation accuracy : 0.983636 max acc epoch : 10 test accuracy : 0.965297
Counter({0: 3849, 1: 3842})

Epoch :  13 loss training:  5.091408392123412 Time :  1909
accuracy train: 0.993335 val: 0.976364 test: 0.965297
max validation accuracy : 0.983636 max acc epoch : 10 test accuracy : 0.965297
Counter({1: 3858, 0: 3833})

Epoch :  14 loss training:  4.755858280346729 Time :  1940
accuracy train: 0.993739 val: 0.976364 test: 0.968950
max validation accuracy : 0.983636 max acc epoch : 10 test accuracy : 0.965297
Counter({1: 3868, 0: 3823})

Epoch :  15 loss training:  4.573695217608474 Time :  1959
accuracy train: 0.993739 val: 0.978182 test: 0.970776
max validation accuracy : 0.983636 max acc epoch : 10 test accuracy : 0.965297
Counter({1: 3873, 0: 3818})

Epoch :  16 loss training:  4.412413163227029 Time :  1991
accuracy train: 0.992931 val: 0.980000 test: 0.970776
max validation accuracy : 0.983636 max acc epoch : 10 test accuracy : 0.965297
Counter({1: 3879, 0: 3812})

Epoch :  17 loss training:  4.240760221960954 Time :  2021
accuracy train: 0.994345 val: 0.974545 test: 0.968950
max validation accuracy : 0.983636 max acc epoch : 10 test accuracy : 0.965297
Counter({0: 3888, 1: 3803})

Epoch :  18 loss training:  3.7819155694451183 Time :  2040
accuracy train: 0.994345 val: 0.980000 test: 0.969863
max validation accuracy : 0.983636 max acc epoch : 10 test accuracy : 0.965297
Counter({0: 3889, 1: 3802})

Epoch :  19 loss training:  3.42786753285327 Time :  2074
accuracy train: 0.994951 val: 0.972727 test: 0.968037
max validation accuracy : 0.983636 max acc epoch : 10 test accuracy : 0.965297
Counter({1: 3898, 0: 3793})

Epoch :  20 loss training:  3.282522792404052 Time :  2095
accuracy train: 0.995152 val: 0.974545 test: 0.970776
max validation accuracy : 0.983636 max acc epoch : 10 test accuracy : 0.965297
Counter({1: 3900, 0: 3791})

Epoch :  21 loss training:  3.1750203360570595 Time :  2118
accuracy train: 0.995152 val: 0.972727 test: 0.974886
max validation accuracy : 0.983636 max acc epoch : 10 test accuracy : 0.965297
Counter({0: 3903, 1: 3788})

========================================================================================================================================================================================================
best acc epoch :  10
validation accuracy :  0.9836363636363636
test accuracy :  0.965296803652968
last test_accuracy :  0.9748858447488584
second best val :  0.98
second best test :  0.965296803652968
max gap 3
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=110, tsne=False, weight_decay=1e-06)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  41.05355247762054 Time :  2183
accuracy train: 0.956170 val: 0.945455 test: 0.959361
max validation accuracy : 0.945455 max acc epoch : 1 test accuracy : 0.959361
Counter({0: 4074, 1: 3617})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.40192784741521 Time :  2202
accuracy train: 0.967077 val: 0.961818 test: 0.953881
max validation accuracy : 0.961818 max acc epoch : 2 test accuracy : 0.953881
Counter({0: 3918, 1: 3773})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.813617129810154 Time :  2234
accuracy train: 0.974753 val: 0.970909 test: 0.967580
max validation accuracy : 0.970909 max acc epoch : 3 test accuracy : 0.967580
Counter({0: 3917, 1: 3774})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.044171354267746 Time :  2261
accuracy train: 0.982832 val: 0.963636 test: 0.971689
max validation accuracy : 0.970909 max acc epoch : 3 test accuracy : 0.967580
Counter({1: 3910, 0: 3781})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.88806166104041 Time :  2280
accuracy train: 0.985256 val: 0.965455 test: 0.971689
max validation accuracy : 0.970909 max acc epoch : 3 test accuracy : 0.967580
Counter({1: 3907, 0: 3784})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  7.881132816546597 Time :  2314
accuracy train: 0.986669 val: 0.960000 test: 0.965753
max validation accuracy : 0.970909 max acc epoch : 3 test accuracy : 0.967580
Counter({0: 3886, 1: 3805})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.838734750519507 Time :  2334
accuracy train: 0.990709 val: 0.969091 test: 0.966667
max validation accuracy : 0.970909 max acc epoch : 3 test accuracy : 0.967580
Counter({1: 3885, 0: 3806})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.642942917300388 Time :  2354
accuracy train: 0.992123 val: 0.967273 test: 0.968493
max validation accuracy : 0.970909 max acc epoch : 3 test accuracy : 0.967580
Counter({1: 3882, 0: 3809})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.926930859917775 Time :  2390
accuracy train: 0.993941 val: 0.963636 test: 0.968950
max validation accuracy : 0.970909 max acc epoch : 3 test accuracy : 0.967580
Counter({1: 3873, 0: 3818})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.165606746566482 Time :  2408
accuracy train: 0.993941 val: 0.969091 test: 0.969406
max validation accuracy : 0.970909 max acc epoch : 3 test accuracy : 0.967580
Counter({0: 3858, 1: 3833})

Epoch :  11 loss training:  4.574038867955096 Time :  2431
accuracy train: 0.994749 val: 0.965455 test: 0.965297
max validation accuracy : 0.970909 max acc epoch : 3 test accuracy : 0.967580
Counter({1: 3850, 0: 3841})

Epoch :  12 loss training:  4.293966838391498 Time :  2468
accuracy train: 0.995152 val: 0.965455 test: 0.968493
max validation accuracy : 0.970909 max acc epoch : 3 test accuracy : 0.967580
Counter({0: 3848, 1: 3843})

Epoch :  13 loss training:  3.994498186511919 Time :  2486
accuracy train: 0.995758 val: 0.967273 test: 0.967580
max validation accuracy : 0.970909 max acc epoch : 3 test accuracy : 0.967580
Counter({1: 3848, 0: 3843})

Epoch :  14 loss training:  3.979421548661776 Time :  2523
accuracy train: 0.995556 val: 0.965455 test: 0.971233
max validation accuracy : 0.970909 max acc epoch : 3 test accuracy : 0.967580
Counter({0: 3855, 1: 3836})

========================================================================================================================================================================================================
best acc epoch :  3
validation accuracy :  0.9709090909090909
test accuracy :  0.9675799086757991
last test_accuracy :  0.9712328767123287
second best val :  0.9690909090909091
second best test :  0.9675799086757991
max gap 1
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=683, tsne=False, weight_decay=1e-06)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  43.24798062816262 Time :  2552
accuracy train: 0.955968 val: 0.949091 test: 0.963470
max validation accuracy : 0.949091 max acc epoch : 1 test accuracy : 0.963470
Counter({0: 4102, 1: 3589})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.172588639659807 Time :  2583
accuracy train: 0.968289 val: 0.960000 test: 0.955251
max validation accuracy : 0.960000 max acc epoch : 2 test accuracy : 0.955251
Counter({0: 3954, 1: 3737})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.584654200822115 Time :  2617
accuracy train: 0.952131 val: 0.916364 test: 0.927854
max validation accuracy : 0.960000 max acc epoch : 2 test accuracy : 0.955251
Counter({0: 3887, 1: 3804})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.283327207434922 Time :  2635
accuracy train: 0.985861 val: 0.967273 test: 0.971233
max validation accuracy : 0.967273 max acc epoch : 4 test accuracy : 0.971233
Counter({0: 3876, 1: 3815})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.621559735853225 Time :  2664
accuracy train: 0.987275 val: 0.961818 test: 0.966210
max validation accuracy : 0.967273 max acc epoch : 4 test accuracy : 0.971233
Counter({1: 3852, 0: 3839})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.509663464967161 Time :  2688
accuracy train: 0.978590 val: 0.949091 test: 0.950228
max validation accuracy : 0.967273 max acc epoch : 4 test accuracy : 0.971233
Counter({1: 3861, 0: 3830})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.956802488537505 Time :  2709
accuracy train: 0.988285 val: 0.967273 test: 0.968493
max validation accuracy : 0.967273 max acc epoch : 4 test accuracy : 0.971233
Counter({0: 3874, 1: 3817})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.734397598309442 Time :  2741
accuracy train: 0.989699 val: 0.963636 test: 0.968037
max validation accuracy : 0.967273 max acc epoch : 4 test accuracy : 0.971233
Counter({1: 3878, 0: 3813})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.787509139394388 Time :  2760
accuracy train: 0.991719 val: 0.965455 test: 0.963014
max validation accuracy : 0.967273 max acc epoch : 4 test accuracy : 0.971233
Counter({1: 3890, 0: 3801})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.401509282179177 Time :  2779
accuracy train: 0.992729 val: 0.967273 test: 0.968037
max validation accuracy : 0.967273 max acc epoch : 4 test accuracy : 0.971233
Counter({1: 3890, 0: 3801})

Epoch :  11 loss training:  4.635326174087822 Time :  2813
accuracy train: 0.993941 val: 0.963636 test: 0.971233
max validation accuracy : 0.967273 max acc epoch : 4 test accuracy : 0.971233
Counter({1: 3888, 0: 3803})

Epoch :  12 loss training:  4.499069715035148 Time :  2829
accuracy train: 0.994951 val: 0.965455 test: 0.968037
max validation accuracy : 0.967273 max acc epoch : 4 test accuracy : 0.971233
Counter({1: 3894, 0: 3797})

Epoch :  13 loss training:  4.141983776527923 Time :  2861
accuracy train: 0.994951 val: 0.965455 test: 0.970320
max validation accuracy : 0.967273 max acc epoch : 4 test accuracy : 0.971233
Counter({1: 3897, 0: 3794})

Epoch :  14 loss training:  4.252155140333343 Time :  2892
accuracy train: 0.995152 val: 0.967273 test: 0.968950
max validation accuracy : 0.967273 max acc epoch : 4 test accuracy : 0.971233
Counter({1: 3902, 0: 3789})

Epoch :  15 loss training:  3.2818969914806075 Time :  2910
accuracy train: 0.995152 val: 0.967273 test: 0.971233
max validation accuracy : 0.967273 max acc epoch : 4 test accuracy : 0.971233
Counter({1: 3908, 0: 3783})

========================================================================================================================================================================================================
best acc epoch :  4
validation accuracy :  0.9672727272727273
test accuracy :  0.9712328767123287
last test_accuracy :  0.9712328767123287
second best val :  0.9654545454545455
second best test :  0.9712328767123287
max gap 2
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=989, tsne=False, weight_decay=1e-06)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  40.61262498795986 Time :  2986
accuracy train: 0.959806 val: 0.958182 test: 0.959361
max validation accuracy : 0.958182 max acc epoch : 1 test accuracy : 0.959361
Counter({0: 4087, 1: 3604})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  20.18442563712597 Time :  3004
accuracy train: 0.973137 val: 0.967273 test: 0.964384
max validation accuracy : 0.967273 max acc epoch : 2 test accuracy : 0.964384
Counter({0: 3983, 1: 3708})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.829414727631956 Time :  3035
accuracy train: 0.975359 val: 0.972727 test: 0.965297
max validation accuracy : 0.972727 max acc epoch : 3 test accuracy : 0.965297
Counter({0: 3852, 1: 3839})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.949617135804147 Time :  3065
accuracy train: 0.984044 val: 0.974545 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.969406
Counter({1: 3855, 0: 3836})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.313398965168744 Time :  3083
accuracy train: 0.986063 val: 0.972727 test: 0.960731
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.969406
Counter({0: 3872, 1: 3819})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.166234217118472 Time :  3117
accuracy train: 0.987275 val: 0.978182 test: 0.963014
max validation accuracy : 0.978182 max acc epoch : 6 test accuracy : 0.963014
Counter({1: 3883, 0: 3808})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.332244474790059 Time :  3144
accuracy train: 0.985659 val: 0.974545 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 6 test accuracy : 0.963014
Counter({1: 3872, 0: 3819})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.605127704329789 Time :  3163
accuracy train: 0.990507 val: 0.980000 test: 0.966667
max validation accuracy : 0.980000 max acc epoch : 8 test accuracy : 0.966667
Counter({1: 3873, 0: 3818})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.239843343384564 Time :  3196
accuracy train: 0.991315 val: 0.972727 test: 0.968950
max validation accuracy : 0.980000 max acc epoch : 8 test accuracy : 0.966667
Counter({1: 3874, 0: 3817})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.515947528881952 Time :  3214
accuracy train: 0.991921 val: 0.976364 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 8 test accuracy : 0.966667
Counter({0: 3875, 1: 3816})

Epoch :  11 loss training:  5.093426325591281 Time :  3236
accuracy train: 0.992729 val: 0.974545 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 8 test accuracy : 0.966667
Counter({1: 3877, 0: 3814})

Epoch :  12 loss training:  5.500423085410148 Time :  3268
accuracy train: 0.993335 val: 0.974545 test: 0.970320
max validation accuracy : 0.980000 max acc epoch : 8 test accuracy : 0.966667
Counter({1: 3881, 0: 3810})

Epoch :  13 loss training:  4.830692811054178 Time :  3286
accuracy train: 0.992931 val: 0.970909 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 8 test accuracy : 0.966667
Counter({1: 3882, 0: 3809})

Epoch :  14 loss training:  4.488675339962356 Time :  3311
accuracy train: 0.992931 val: 0.974545 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 8 test accuracy : 0.966667
Counter({1: 3883, 0: 3808})

Epoch :  15 loss training:  4.3839375040261075 Time :  3347
accuracy train: 0.993537 val: 0.972727 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 8 test accuracy : 0.966667
Counter({1: 3886, 0: 3805})

Epoch :  16 loss training:  3.7314726106124 Time :  3365
accuracy train: 0.995354 val: 0.980000 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 8 test accuracy : 0.966667
Counter({1: 3886, 0: 3805})

Epoch :  17 loss training:  4.048675011494197 Time :  3397
accuracy train: 0.995152 val: 0.980000 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 8 test accuracy : 0.966667
Counter({1: 3894, 0: 3797})

Epoch :  18 loss training:  3.6449279001099057 Time :  3429
accuracy train: 0.995152 val: 0.978182 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 8 test accuracy : 0.966667
Counter({0: 3908, 1: 3783})

Epoch :  19 loss training:  3.3540588108589873 Time :  3449
accuracy train: 0.994951 val: 0.974545 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 8 test accuracy : 0.966667
Counter({1: 3908, 0: 3783})

========================================================================================================================================================================================================
best acc epoch :  8
validation accuracy :  0.98
test accuracy :  0.9666666666666667
last test_accuracy :  0.9744292237442922
second best val :  0.9781818181818182
second best test :  0.963013698630137
max gap 2
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  21 	 val_accuracy : 0.98364 	 test_accuracy : 0.96804 	 last test_accuracy : 0.96758 	 second best val : 0.98182 	 second best test : 0.97260
k :  1 	 best_acc epoch :  14 	 val_accuracy : 0.98909 	 test_accuracy : 0.96712 	 last test_accuracy : 0.96758 	 second best val : 0.98727 	 second best test : 0.96804
k :  2 	 best_acc epoch :  10 	 val_accuracy : 0.98364 	 test_accuracy : 0.96530 	 last test_accuracy : 0.97489 	 second best val : 0.98000 	 second best test : 0.96530
k :  3 	 best_acc epoch :  3 	 val_accuracy : 0.97091 	 test_accuracy : 0.96758 	 last test_accuracy : 0.97123 	 second best val : 0.96909 	 second best test : 0.96758
k :  4 	 best_acc epoch :  4 	 val_accuracy : 0.96727 	 test_accuracy : 0.97123 	 last test_accuracy : 0.97123 	 second best val : 0.96545 	 second best test : 0.97123
k :  5 	 best_acc epoch :  8 	 val_accuracy : 0.98000 	 test_accuracy : 0.96667 	 last test_accuracy : 0.97443 	 second best val : 0.97818 	 second best test : 0.96301

avg :  	 val_accuracy : 0.97909 	 test_accuracy : 0.96766 	 last_accuracy : 0.97116 	 second best val : 0.97697 	 second best test : 0.96796

std :  	 val_accuracy : 0.00762 	 test_accuracy : 0.00182 	 last_accuracy : 0.00289 	 second best val : 0.00747 	 second best test : 0.00327
