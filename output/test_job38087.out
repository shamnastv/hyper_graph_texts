

date and time :  Sat Jun 19 20:20:18 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=0, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=966, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  46.6918067317456 Time :  11
accuracy train: 0.961078 val: 0.960000 test: 0.963927
max validation accuracy : 0.960000 max acc epoch : 1 test accuracy : 0.963927

Epoch :  2 loss training:  19.177348021417856 Time :  20
accuracy train: 0.967066 val: 0.957576 test: 0.968950
max validation accuracy : 0.960000 max acc epoch : 1 test accuracy : 0.963927

Epoch :  3 loss training:  14.800204750150442 Time :  30
accuracy train: 0.973909 val: 0.970909 test: 0.962557
max validation accuracy : 0.970909 max acc epoch : 3 test accuracy : 0.962557

Epoch :  4 loss training:  12.189049995038658 Time :  40
accuracy train: 0.982036 val: 0.967273 test: 0.960731
max validation accuracy : 0.970909 max acc epoch : 3 test accuracy : 0.962557

Epoch :  5 loss training:  11.613242499995977 Time :  49
accuracy train: 0.977973 val: 0.967273 test: 0.961644
max validation accuracy : 0.970909 max acc epoch : 3 test accuracy : 0.962557

Epoch :  6 loss training:  10.9125367985107 Time :  59
accuracy train: 0.986955 val: 0.973333 test: 0.974429
max validation accuracy : 0.973333 max acc epoch : 6 test accuracy : 0.974429

Epoch :  7 loss training:  8.4106380273588 Time :  68
accuracy train: 0.986741 val: 0.969697 test: 0.967580
max validation accuracy : 0.973333 max acc epoch : 6 test accuracy : 0.974429

Epoch :  8 loss training:  8.826337958220392 Time :  78
accuracy train: 0.992301 val: 0.969697 test: 0.973059
max validation accuracy : 0.973333 max acc epoch : 6 test accuracy : 0.974429

Epoch :  9 loss training:  8.434397973469459 Time :  87
accuracy train: 0.990163 val: 0.973333 test: 0.968493
max validation accuracy : 0.973333 max acc epoch : 6 test accuracy : 0.974429

Epoch :  10 loss training:  7.663581263273954 Time :  96
accuracy train: 0.986955 val: 0.968485 test: 0.961187
max validation accuracy : 0.973333 max acc epoch : 6 test accuracy : 0.974429

Epoch :  11 loss training:  7.306730120675638 Time :  107
accuracy train: 0.994226 val: 0.978182 test: 0.963927
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.963927

Epoch :  12 loss training:  6.213405539281666 Time :  117
accuracy train: 0.995295 val: 0.973333 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.963927

Epoch :  13 loss training:  6.299492301070131 Time :  127
accuracy train: 0.995081 val: 0.973333 test: 0.962100
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.963927

Epoch :  14 loss training:  4.830451150832232 Time :  138
accuracy train: 0.995509 val: 0.975758 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.963927

Epoch :  15 loss training:  3.1656596026732586 Time :  148
accuracy train: 0.995937 val: 0.972121 test: 0.967123
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.963927

Epoch :  16 loss training:  3.1302870238141622 Time :  159
accuracy train: 0.995723 val: 0.973333 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.963927

Epoch :  17 loss training:  2.609462507578428 Time :  169
accuracy train: 0.996792 val: 0.972121 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.963927

Epoch :  18 loss training:  2.921369297488127 Time :  180
accuracy train: 0.996792 val: 0.970909 test: 0.962557
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.963927

Epoch :  19 loss training:  4.177863283563056 Time :  190
accuracy train: 0.997006 val: 0.973333 test: 0.963014
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.963927

Epoch :  20 loss training:  2.6338390810851706 Time :  200
accuracy train: 0.995295 val: 0.974545 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.963927

Epoch :  21 loss training:  2.823834191862261 Time :  211
accuracy train: 0.996792 val: 0.973333 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.963927

Epoch :  22 loss training:  2.633248874626588 Time :  221
accuracy train: 0.996792 val: 0.975758 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.963927

Epoch :  23 loss training:  3.90240296281263 Time :  232
accuracy train: 0.997220 val: 0.976970 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.963927

Epoch :  24 loss training:  1.9615934874673258 Time :  242
accuracy train: 0.996364 val: 0.975758 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.963927

Epoch :  25 loss training:  2.653022757060171 Time :  252
accuracy train: 0.993798 val: 0.972121 test: 0.963927
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.963927

Epoch :  26 loss training:  2.3643614023094415 Time :  263
accuracy train: 0.997434 val: 0.974545 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.963927

Epoch :  27 loss training:  2.0748494643376034 Time :  273
accuracy train: 0.997434 val: 0.975758 test: 0.964840
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.963927

Epoch :  28 loss training:  1.7286116204268183 Time :  284
accuracy train: 0.996792 val: 0.978182 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.963927

Epoch :  29 loss training:  1.3997552953733248 Time :  294
accuracy train: 0.996364 val: 0.979394 test: 0.968950
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  30 loss training:  1.8559938803846308 Time :  304
accuracy train: 0.996578 val: 0.970909 test: 0.964840
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  31 loss training:  1.635857489589398 Time :  315
accuracy train: 0.997434 val: 0.973333 test: 0.967580
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  32 loss training:  1.443023305369934 Time :  325
accuracy train: 0.997861 val: 0.970909 test: 0.965297
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  33 loss training:  1.8857657717799157 Time :  336
accuracy train: 0.996792 val: 0.972121 test: 0.966667
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  34 loss training:  1.894681780961946 Time :  346
accuracy train: 0.996364 val: 0.975758 test: 0.965753
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  35 loss training:  1.774124107985699 Time :  356
accuracy train: 0.996578 val: 0.973333 test: 0.964384
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  36 loss training:  1.9654805222289724 Time :  367
accuracy train: 0.997434 val: 0.972121 test: 0.966210
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  37 loss training:  2.531225452577928 Time :  377
accuracy train: 0.997006 val: 0.970909 test: 0.965753
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  38 loss training:  1.7114554026429687 Time :  388
accuracy train: 0.997434 val: 0.972121 test: 0.970776
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  39 loss training:  1.5509747085670824 Time :  398
accuracy train: 0.997648 val: 0.975758 test: 0.967580
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  40 loss training:  1.4875881999687408 Time :  408
accuracy train: 0.997434 val: 0.973333 test: 0.967123
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  41 loss training:  1.8571043683950847 Time :  419
accuracy train: 0.997220 val: 0.974545 test: 0.971689
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  42 loss training:  1.88117995092216 Time :  429
accuracy train: 0.997220 val: 0.973333 test: 0.970320
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  43 loss training:  1.4444804758713872 Time :  440
accuracy train: 0.997434 val: 0.973333 test: 0.970776
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  44 loss training:  1.1915769064689812 Time :  450
accuracy train: 0.997434 val: 0.970909 test: 0.971689
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  45 loss training:  1.4078957830151921 Time :  460
accuracy train: 0.997648 val: 0.970909 test: 0.970776
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  46 loss training:  1.3396951171553155 Time :  471
accuracy train: 0.997648 val: 0.973333 test: 0.971233
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  47 loss training:  1.0080760991922944 Time :  481
accuracy train: 0.997434 val: 0.969697 test: 0.970776
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  48 loss training:  1.0995348941578413 Time :  492
accuracy train: 0.997006 val: 0.968485 test: 0.972603
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  49 loss training:  1.1928862890499659 Time :  502
accuracy train: 0.997648 val: 0.975758 test: 0.969406
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  50 loss training:  2.074621420272706 Time :  512
accuracy train: 0.997006 val: 0.972121 test: 0.966667
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  51 loss training:  1.648697728879597 Time :  523
accuracy train: 0.997006 val: 0.974545 test: 0.969863
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  52 loss training:  1.8300903567524074 Time :  533
accuracy train: 0.997220 val: 0.968485 test: 0.957534
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  53 loss training:  1.4473043713478546 Time :  543
accuracy train: 0.997648 val: 0.973333 test: 0.967123
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  54 loss training:  1.3097015338753408 Time :  554
accuracy train: 0.997434 val: 0.973333 test: 0.969863
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  55 loss training:  1.293203606330735 Time :  564
accuracy train: 0.997861 val: 0.978182 test: 0.968493
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  56 loss training:  1.4913357327175163 Time :  574
accuracy train: 0.997648 val: 0.974545 test: 0.971233
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  57 loss training:  1.6169750292883691 Time :  585
accuracy train: 0.994867 val: 0.974545 test: 0.968950
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  58 loss training:  1.368142134876507 Time :  595
accuracy train: 0.997648 val: 0.972121 test: 0.971689
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  59 loss training:  1.3123576405405402 Time :  606
accuracy train: 0.995081 val: 0.972121 test: 0.970320
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

Epoch :  60 loss training:  1.2673686998550693 Time :  616
accuracy train: 0.997648 val: 0.976970 test: 0.969863
max validation accuracy : 0.979394 max acc epoch : 29 test accuracy : 0.968950

========================================================================================================================================================================================================
best acc epoch :  29
validation accuracy :  0.9793939393939394
test accuracy :  0.9689497716894977
last test_accuracy :  0.9698630136986301
second best val :  0.9781818181818182
second best test :  0.9639269406392694
max gap 18
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=0, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=367, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  44.85000817105174 Time :  627
accuracy train: 0.961506 val: 0.953939 test: 0.949772
max validation accuracy : 0.953939 max acc epoch : 1 test accuracy : 0.949772

Epoch :  2 loss training:  17.316755062900484 Time :  637
accuracy train: 0.972198 val: 0.964848 test: 0.965753
max validation accuracy : 0.964848 max acc epoch : 2 test accuracy : 0.965753

Epoch :  3 loss training:  14.92564051784575 Time :  646
accuracy train: 0.982036 val: 0.966061 test: 0.965753
max validation accuracy : 0.966061 max acc epoch : 3 test accuracy : 0.965753

Epoch :  4 loss training:  13.430950647685677 Time :  656
accuracy train: 0.982464 val: 0.962424 test: 0.961187
max validation accuracy : 0.966061 max acc epoch : 3 test accuracy : 0.965753

Epoch :  5 loss training:  11.240177483297884 Time :  666
accuracy train: 0.979256 val: 0.966061 test: 0.954795
max validation accuracy : 0.966061 max acc epoch : 3 test accuracy : 0.965753

Epoch :  6 loss training:  9.1150053946767 Time :  675
accuracy train: 0.982464 val: 0.964848 test: 0.964384
max validation accuracy : 0.966061 max acc epoch : 3 test accuracy : 0.965753

Epoch :  7 loss training:  9.226649061078206 Time :  685
accuracy train: 0.986741 val: 0.963636 test: 0.965297
max validation accuracy : 0.966061 max acc epoch : 3 test accuracy : 0.965753

Epoch :  8 loss training:  9.118909505428746 Time :  694
accuracy train: 0.988452 val: 0.967273 test: 0.962100
max validation accuracy : 0.967273 max acc epoch : 8 test accuracy : 0.962100

Epoch :  9 loss training:  9.146691856672987 Time :  704
accuracy train: 0.986099 val: 0.962424 test: 0.968950
max validation accuracy : 0.967273 max acc epoch : 8 test accuracy : 0.962100

Epoch :  10 loss training:  9.586551440646872 Time :  714
accuracy train: 0.989521 val: 0.967273 test: 0.967123
max validation accuracy : 0.967273 max acc epoch : 8 test accuracy : 0.962100

Epoch :  11 loss training:  7.339720812509768 Time :  724
accuracy train: 0.994012 val: 0.970909 test: 0.961187
max validation accuracy : 0.970909 max acc epoch : 11 test accuracy : 0.961187

Epoch :  12 loss training:  6.345579076674767 Time :  734
accuracy train: 0.994654 val: 0.972121 test: 0.967580
max validation accuracy : 0.972121 max acc epoch : 12 test accuracy : 0.967580

Epoch :  13 loss training:  5.5938544874079525 Time :  745
accuracy train: 0.995937 val: 0.978182 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.969863

Epoch :  14 loss training:  4.360919559258036 Time :  755
accuracy train: 0.996151 val: 0.978182 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.969863

Epoch :  15 loss training:  3.542326629627496 Time :  766
accuracy train: 0.997006 val: 0.972121 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.969863

Epoch :  16 loss training:  3.1098537381039932 Time :  776
accuracy train: 0.997006 val: 0.970909 test: 0.966210
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.969863

Epoch :  17 loss training:  2.6761688309779856 Time :  787
accuracy train: 0.995509 val: 0.974545 test: 0.967123
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.969863

Epoch :  18 loss training:  3.4972529299884627 Time :  797
accuracy train: 0.995509 val: 0.976970 test: 0.966667
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.969863

Epoch :  19 loss training:  3.833967412938364 Time :  808
accuracy train: 0.993798 val: 0.976970 test: 0.965297
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.969863

Epoch :  20 loss training:  2.3296473892305585 Time :  818
accuracy train: 0.997434 val: 0.980606 test: 0.969863
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  21 loss training:  1.8311347066191956 Time :  829
accuracy train: 0.997434 val: 0.973333 test: 0.972146
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  22 loss training:  2.3524687941608136 Time :  839
accuracy train: 0.997648 val: 0.974545 test: 0.971233
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  23 loss training:  1.8390799515182152 Time :  850
accuracy train: 0.997220 val: 0.979394 test: 0.972603
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  24 loss training:  1.8951408097345848 Time :  860
accuracy train: 0.997220 val: 0.978182 test: 0.973516
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  25 loss training:  2.3978878271518624 Time :  871
accuracy train: 0.996792 val: 0.976970 test: 0.970320
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  26 loss training:  1.8039635028981138 Time :  881
accuracy train: 0.997648 val: 0.979394 test: 0.969863
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  27 loss training:  2.0918583165475866 Time :  891
accuracy train: 0.997220 val: 0.972121 test: 0.968037
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  28 loss training:  2.094387169549009 Time :  902
accuracy train: 0.997220 val: 0.973333 test: 0.968950
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  29 loss training:  2.0492933449640987 Time :  912
accuracy train: 0.994867 val: 0.973333 test: 0.966667
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  30 loss training:  2.859112830799859 Time :  923
accuracy train: 0.996792 val: 0.970909 test: 0.967580
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  31 loss training:  1.940410512710514 Time :  933
accuracy train: 0.997648 val: 0.974545 test: 0.969863
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  32 loss training:  1.6559967117318592 Time :  944
accuracy train: 0.997648 val: 0.976970 test: 0.970776
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  33 loss training:  1.698997910547405 Time :  954
accuracy train: 0.997648 val: 0.976970 test: 0.968493
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  34 loss training:  1.7334116957281367 Time :  965
accuracy train: 0.997220 val: 0.978182 test: 0.971689
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  35 loss training:  2.0880587834362814 Time :  975
accuracy train: 0.997434 val: 0.972121 test: 0.971233
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  36 loss training:  2.1992638422816526 Time :  986
accuracy train: 0.997648 val: 0.979394 test: 0.971689
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  37 loss training:  1.674754018288695 Time :  996
accuracy train: 0.997434 val: 0.980606 test: 0.968493
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  38 loss training:  2.4259908827625623 Time :  1007
accuracy train: 0.997434 val: 0.964848 test: 0.963927
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  39 loss training:  1.6569803388410946 Time :  1017
accuracy train: 0.997648 val: 0.974545 test: 0.967580
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  40 loss training:  1.7867214805974072 Time :  1028
accuracy train: 0.997648 val: 0.970909 test: 0.968950
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  41 loss training:  1.5232453715252632 Time :  1038
accuracy train: 0.997648 val: 0.974545 test: 0.969406
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  42 loss training:  1.4487854382678051 Time :  1049
accuracy train: 0.997648 val: 0.976970 test: 0.971689
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  43 loss training:  1.2988808823956788 Time :  1059
accuracy train: 0.997220 val: 0.973333 test: 0.968493
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  44 loss training:  1.4687102443313051 Time :  1070
accuracy train: 0.997006 val: 0.975758 test: 0.968493
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  45 loss training:  1.5397763111204767 Time :  1080
accuracy train: 0.997220 val: 0.975758 test: 0.965753
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  46 loss training:  2.0070532525132876 Time :  1091
accuracy train: 0.997220 val: 0.970909 test: 0.965297
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  47 loss training:  2.6250223618844757 Time :  1101
accuracy train: 0.997220 val: 0.960000 test: 0.965297
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  48 loss training:  1.712777079400439 Time :  1112
accuracy train: 0.997434 val: 0.972121 test: 0.968493
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  49 loss training:  2.0630676312266587 Time :  1122
accuracy train: 0.997006 val: 0.973333 test: 0.965753
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  50 loss training:  2.1675075805032975 Time :  1133
accuracy train: 0.996792 val: 0.967273 test: 0.960731
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

Epoch :  51 loss training:  2.6479763378883945 Time :  1143
accuracy train: 0.997006 val: 0.964848 test: 0.970320
max validation accuracy : 0.980606 max acc epoch : 20 test accuracy : 0.969863

========================================================================================================================================================================================================
best acc epoch :  20
validation accuracy :  0.9806060606060606
test accuracy :  0.9698630136986301
last test_accuracy :  0.9703196347031964
second best val :  0.9793939393939394
second best test :  0.9698630136986301
max gap 7
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  29 	 val_accuracy : 0.97939 	 test_accuracy : 0.96895 	 last test_accuracy : 0.96986 	 second best val : 0.97818 	 second best test : 0.96393
k :  1 	 best_acc epoch :  20 	 val_accuracy : 0.98061 	 test_accuracy : 0.96986 	 last test_accuracy : 0.97032 	 second best val : 0.97939 	 second best test : 0.96986

avg :  	 val_accuracy : 0.98000 	 test_accuracy : 0.96941 	 last_accuracy : 0.97009 	 second best val : 0.97879 	 second best test : 0.96689

std :  	 val_accuracy : 0.00061 	 test_accuracy : 0.00046 	 last_accuracy : 0.00023 	 second best val : 0.00061 	 second best test : 0.00297


date and time :  Sat Jun 19 20:39:31 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=462, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  44.09775757044554 Time :  14
accuracy train: 0.949316 val: 0.943030 test: 0.958447
max validation accuracy : 0.943030 max acc epoch : 1 test accuracy : 0.958447

Epoch :  2 loss training:  17.457128578796983 Time :  28
accuracy train: 0.971343 val: 0.960000 test: 0.956621
max validation accuracy : 0.960000 max acc epoch : 2 test accuracy : 0.956621

Epoch :  3 loss training:  13.42799389641732 Time :  42
accuracy train: 0.978828 val: 0.962424 test: 0.962557
max validation accuracy : 0.962424 max acc epoch : 3 test accuracy : 0.962557

Epoch :  4 loss training:  13.094495783559978 Time :  56
accuracy train: 0.981822 val: 0.967273 test: 0.968037
max validation accuracy : 0.967273 max acc epoch : 4 test accuracy : 0.968037

Epoch :  5 loss training:  10.563165336847305 Time :  70
accuracy train: 0.985030 val: 0.967273 test: 0.963927
max validation accuracy : 0.967273 max acc epoch : 4 test accuracy : 0.968037

Epoch :  6 loss training:  10.192765808547847 Time :  83
accuracy train: 0.980753 val: 0.958788 test: 0.960274
max validation accuracy : 0.967273 max acc epoch : 4 test accuracy : 0.968037

Epoch :  7 loss training:  9.279066206654534 Time :  97
accuracy train: 0.987169 val: 0.972121 test: 0.965753
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.965753

Epoch :  8 loss training:  9.631637838901952 Time :  111
accuracy train: 0.988024 val: 0.963636 test: 0.969863
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.965753

Epoch :  9 loss training:  7.931889867875725 Time :  125
accuracy train: 0.991232 val: 0.969697 test: 0.970776
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.965753

Epoch :  10 loss training:  6.941864892607555 Time :  139
accuracy train: 0.989949 val: 0.974545 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.970776

Epoch :  11 loss training:  8.17286097991746 Time :  153
accuracy train: 0.985885 val: 0.969697 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.970776

Epoch :  12 loss training:  7.065282782306895 Time :  168
accuracy train: 0.993370 val: 0.967273 test: 0.963014
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.970776

Epoch :  13 loss training:  4.742283114232123 Time :  183
accuracy train: 0.995295 val: 0.973333 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.970776

Epoch :  14 loss training:  4.660663893795572 Time :  197
accuracy train: 0.994226 val: 0.972121 test: 0.965753
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.970776

Epoch :  15 loss training:  3.9128151986806188 Time :  212
accuracy train: 0.995937 val: 0.970909 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.970776

Epoch :  16 loss training:  3.2807331686490215 Time :  227
accuracy train: 0.996578 val: 0.969697 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.970776

Epoch :  17 loss training:  3.17218790120387 Time :  241
accuracy train: 0.996364 val: 0.969697 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.970776

Epoch :  18 loss training:  3.276949123304803 Time :  256
accuracy train: 0.996364 val: 0.968485 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.970776

Epoch :  19 loss training:  3.1655748676275834 Time :  271
accuracy train: 0.994867 val: 0.967273 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.970776

Epoch :  20 loss training:  2.6310810505528934 Time :  286
accuracy train: 0.996792 val: 0.978182 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  21 loss training:  2.83468033176905 Time :  300
accuracy train: 0.995509 val: 0.967273 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  22 loss training:  3.286895327975799 Time :  315
accuracy train: 0.995081 val: 0.969697 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  23 loss training:  4.837080298821093 Time :  330
accuracy train: 0.996364 val: 0.970909 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  24 loss training:  2.8777146749926032 Time :  344
accuracy train: 0.996578 val: 0.970909 test: 0.966667
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  25 loss training:  2.488118442931409 Time :  359
accuracy train: 0.996364 val: 0.969697 test: 0.965753
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  26 loss training:  2.1182883270375896 Time :  374
accuracy train: 0.996151 val: 0.972121 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  27 loss training:  2.004453171561181 Time :  388
accuracy train: 0.996151 val: 0.969697 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  28 loss training:  2.007007366628386 Time :  403
accuracy train: 0.996364 val: 0.975758 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  29 loss training:  1.9971515226570773 Time :  417
accuracy train: 0.996578 val: 0.968485 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  30 loss training:  2.5665898432125687 Time :  432
accuracy train: 0.996364 val: 0.972121 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  31 loss training:  2.258480507920467 Time :  447
accuracy train: 0.996364 val: 0.974545 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  32 loss training:  2.1866181052864704 Time :  461
accuracy train: 0.995937 val: 0.972121 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  33 loss training:  2.7153316091335 Time :  476
accuracy train: 0.996364 val: 0.974545 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  34 loss training:  1.9237745341233676 Time :  490
accuracy train: 0.996578 val: 0.970909 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  35 loss training:  1.992959053026425 Time :  505
accuracy train: 0.996151 val: 0.973333 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  36 loss training:  1.9144505281838065 Time :  519
accuracy train: 0.995937 val: 0.970909 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  37 loss training:  2.1111939331640315 Time :  534
accuracy train: 0.996151 val: 0.974545 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  38 loss training:  1.894793962535914 Time :  548
accuracy train: 0.996364 val: 0.972121 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  39 loss training:  1.80118415006109 Time :  563
accuracy train: 0.996151 val: 0.972121 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  40 loss training:  2.5757631397541445 Time :  578
accuracy train: 0.992087 val: 0.967273 test: 0.962100
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  41 loss training:  2.321160234854233 Time :  592
accuracy train: 0.996364 val: 0.960000 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  42 loss training:  2.5070698644522054 Time :  607
accuracy train: 0.993584 val: 0.963636 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  43 loss training:  2.055152502223791 Time :  621
accuracy train: 0.996364 val: 0.967273 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  44 loss training:  1.97276134862841 Time :  636
accuracy train: 0.996364 val: 0.970909 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  45 loss training:  1.3935821000833357 Time :  651
accuracy train: 0.997220 val: 0.967273 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  46 loss training:  1.6791065632314712 Time :  665
accuracy train: 0.996364 val: 0.963636 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  47 loss training:  1.5008354873596659 Time :  680
accuracy train: 0.996792 val: 0.969697 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  48 loss training:  1.7781250693908532 Time :  694
accuracy train: 0.996151 val: 0.970909 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  49 loss training:  1.8455663398890465 Time :  709
accuracy train: 0.996364 val: 0.968485 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  50 loss training:  1.7383546088121875 Time :  723
accuracy train: 0.993370 val: 0.968485 test: 0.967123
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

Epoch :  51 loss training:  1.8933989682868742 Time :  738
accuracy train: 0.996792 val: 0.966061 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 20 test accuracy : 0.969406

========================================================================================================================================================================================================
best acc epoch :  20
validation accuracy :  0.9781818181818182
test accuracy :  0.9694063926940639
last test_accuracy :  0.9675799086757991
second best val :  0.9757575757575757
second best test :  0.9694063926940639
max gap 10
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=594, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  44.81886629015207 Time :  753
accuracy train: 0.965997 val: 0.955152 test: 0.960274
max validation accuracy : 0.955152 max acc epoch : 1 test accuracy : 0.960274

Epoch :  2 loss training:  16.94251367636025 Time :  767
accuracy train: 0.975192 val: 0.963636 test: 0.968037
max validation accuracy : 0.963636 max acc epoch : 2 test accuracy : 0.968037

Epoch :  3 loss training:  14.421924582216889 Time :  781
accuracy train: 0.979683 val: 0.960000 test: 0.961644
max validation accuracy : 0.963636 max acc epoch : 2 test accuracy : 0.968037

Epoch :  4 loss training:  12.184844210743904 Time :  795
accuracy train: 0.981608 val: 0.962424 test: 0.963927
max validation accuracy : 0.963636 max acc epoch : 2 test accuracy : 0.968037

Epoch :  5 loss training:  9.686153235845268 Time :  809
accuracy train: 0.984388 val: 0.958788 test: 0.957991
max validation accuracy : 0.963636 max acc epoch : 2 test accuracy : 0.968037

Epoch :  6 loss training:  9.526397120207548 Time :  823
accuracy train: 0.988238 val: 0.970909 test: 0.973516
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973516

Epoch :  7 loss training:  9.204160938272253 Time :  837
accuracy train: 0.987810 val: 0.966061 test: 0.961644
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973516

Epoch :  8 loss training:  7.992543210508302 Time :  851
accuracy train: 0.988238 val: 0.966061 test: 0.965297
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973516

Epoch :  9 loss training:  8.704507045506034 Time :  864
accuracy train: 0.966210 val: 0.955152 test: 0.965753
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973516

Epoch :  10 loss training:  7.198597625945695 Time :  878
accuracy train: 0.986741 val: 0.966061 test: 0.966210
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973516

Epoch :  11 loss training:  6.570608816793538 Time :  893
accuracy train: 0.982891 val: 0.963636 test: 0.957534
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973516

Epoch :  12 loss training:  6.148996127827559 Time :  908
accuracy train: 0.992515 val: 0.964848 test: 0.970320
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973516

Epoch :  13 loss training:  4.837967972038314 Time :  921
accuracy train: 0.995081 val: 0.963636 test: 0.971233
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973516

Epoch :  14 loss training:  4.205525421130005 Time :  935
accuracy train: 0.993370 val: 0.966061 test: 0.975799
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973516

Epoch :  15 loss training:  3.8559071687050164 Time :  950
accuracy train: 0.996151 val: 0.968485 test: 0.968950
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973516

Epoch :  16 loss training:  3.5351837208436336 Time :  964
accuracy train: 0.995509 val: 0.970909 test: 0.973516
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973516

Epoch :  17 loss training:  3.268093942053383 Time :  978
accuracy train: 0.995081 val: 0.967273 test: 0.968493
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973516

Epoch :  18 loss training:  3.2678904680433334 Time :  994
accuracy train: 0.997006 val: 0.966061 test: 0.969863
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973516

Epoch :  19 loss training:  3.3838463295833208 Time :  1009
accuracy train: 0.996364 val: 0.969697 test: 0.969406
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973516

Epoch :  20 loss training:  2.227774124548887 Time :  1024
accuracy train: 0.996151 val: 0.967273 test: 0.965753
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973516

Epoch :  21 loss training:  2.386200337889022 Time :  1038
accuracy train: 0.995937 val: 0.964848 test: 0.963927
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973516

Epoch :  22 loss training:  2.161145343168755 Time :  1053
accuracy train: 0.996364 val: 0.966061 test: 0.970320
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973516

Epoch :  23 loss training:  2.2677081667934544 Time :  1068
accuracy train: 0.995081 val: 0.968485 test: 0.974886
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973516

Epoch :  24 loss training:  2.456670970474079 Time :  1083
accuracy train: 0.997006 val: 0.964848 test: 0.969863
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973516

Epoch :  25 loss training:  2.189201061581116 Time :  1098
accuracy train: 0.997220 val: 0.968485 test: 0.968493
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973516

Epoch :  26 loss training:  2.187394549335295 Time :  1113
accuracy train: 0.996364 val: 0.963636 test: 0.968493
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973516

Epoch :  27 loss training:  1.758002409900655 Time :  1127
accuracy train: 0.994654 val: 0.962424 test: 0.968950
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973516

Epoch :  28 loss training:  1.8619507514395082 Time :  1142
accuracy train: 0.994226 val: 0.970909 test: 0.972603
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973516

Epoch :  29 loss training:  1.877892125843573 Time :  1157
accuracy train: 0.996792 val: 0.963636 test: 0.970320
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973516

Epoch :  30 loss training:  1.9611511906186934 Time :  1171
accuracy train: 0.996151 val: 0.963636 test: 0.962100
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.973516

Epoch :  31 loss training:  2.4508440831123153 Time :  1186
accuracy train: 0.996792 val: 0.972121 test: 0.966210
max validation accuracy : 0.972121 max acc epoch : 31 test accuracy : 0.966210

Epoch :  32 loss training:  2.7490795679186704 Time :  1200
accuracy train: 0.992943 val: 0.969697 test: 0.971689
max validation accuracy : 0.972121 max acc epoch : 31 test accuracy : 0.966210

Epoch :  33 loss training:  1.8422288924484747 Time :  1215
accuracy train: 0.997220 val: 0.969697 test: 0.963470
max validation accuracy : 0.972121 max acc epoch : 31 test accuracy : 0.966210

Epoch :  34 loss training:  1.7720477763505187 Time :  1230
accuracy train: 0.996578 val: 0.966061 test: 0.975342
max validation accuracy : 0.972121 max acc epoch : 31 test accuracy : 0.966210

Epoch :  35 loss training:  2.4876375740968797 Time :  1244
accuracy train: 0.997434 val: 0.967273 test: 0.958904
max validation accuracy : 0.972121 max acc epoch : 31 test accuracy : 0.966210

Epoch :  36 loss training:  2.231563329223718 Time :  1259
accuracy train: 0.996364 val: 0.960000 test: 0.964840
max validation accuracy : 0.972121 max acc epoch : 31 test accuracy : 0.966210

Epoch :  37 loss training:  1.731597783142206 Time :  1274
accuracy train: 0.997648 val: 0.961212 test: 0.969406
max validation accuracy : 0.972121 max acc epoch : 31 test accuracy : 0.966210

Epoch :  38 loss training:  2.4012755402764014 Time :  1288
accuracy train: 0.997220 val: 0.966061 test: 0.966210
max validation accuracy : 0.972121 max acc epoch : 31 test accuracy : 0.966210

Epoch :  39 loss training:  1.853208737326895 Time :  1303
accuracy train: 0.997220 val: 0.967273 test: 0.965297
max validation accuracy : 0.972121 max acc epoch : 31 test accuracy : 0.966210

Epoch :  40 loss training:  1.5194199078214297 Time :  1317
accuracy train: 0.997006 val: 0.968485 test: 0.968493
max validation accuracy : 0.972121 max acc epoch : 31 test accuracy : 0.966210

Epoch :  41 loss training:  1.3957516446989757 Time :  1332
accuracy train: 0.997861 val: 0.972121 test: 0.970776
max validation accuracy : 0.972121 max acc epoch : 31 test accuracy : 0.966210

Epoch :  42 loss training:  1.4456413440748292 Time :  1347
accuracy train: 0.997220 val: 0.968485 test: 0.963927
max validation accuracy : 0.972121 max acc epoch : 31 test accuracy : 0.966210

Epoch :  43 loss training:  1.6420166976513428 Time :  1361
accuracy train: 0.997220 val: 0.969697 test: 0.972146
max validation accuracy : 0.972121 max acc epoch : 31 test accuracy : 0.966210

Epoch :  44 loss training:  1.3501743197057294 Time :  1376
accuracy train: 0.997006 val: 0.968485 test: 0.970776
max validation accuracy : 0.972121 max acc epoch : 31 test accuracy : 0.966210

Epoch :  45 loss training:  1.4600552468255046 Time :  1391
accuracy train: 0.997006 val: 0.973333 test: 0.970320
max validation accuracy : 0.973333 max acc epoch : 45 test accuracy : 0.970320

Epoch :  46 loss training:  1.2893959116322549 Time :  1405
accuracy train: 0.997006 val: 0.968485 test: 0.967580
max validation accuracy : 0.973333 max acc epoch : 45 test accuracy : 0.970320

Epoch :  47 loss training:  1.895394824041432 Time :  1419
accuracy train: 0.994440 val: 0.966061 test: 0.968950
max validation accuracy : 0.973333 max acc epoch : 45 test accuracy : 0.970320

Epoch :  48 loss training:  2.213411189607541 Time :  1434
accuracy train: 0.997648 val: 0.968485 test: 0.967123
max validation accuracy : 0.973333 max acc epoch : 45 test accuracy : 0.970320

Epoch :  49 loss training:  2.0653165714193165 Time :  1449
accuracy train: 0.996364 val: 0.967273 test: 0.951598
max validation accuracy : 0.973333 max acc epoch : 45 test accuracy : 0.970320

Epoch :  50 loss training:  1.9627610489387735 Time :  1463
accuracy train: 0.997434 val: 0.972121 test: 0.963470
max validation accuracy : 0.973333 max acc epoch : 45 test accuracy : 0.970320

Epoch :  51 loss training:  2.047956023052393 Time :  1478
accuracy train: 0.995295 val: 0.973333 test: 0.968950
max validation accuracy : 0.973333 max acc epoch : 45 test accuracy : 0.970320

Epoch :  52 loss training:  1.178403784836064 Time :  1492
accuracy train: 0.997434 val: 0.970909 test: 0.968037
max validation accuracy : 0.973333 max acc epoch : 45 test accuracy : 0.970320

Epoch :  53 loss training:  2.473385059861357 Time :  1507
accuracy train: 0.997006 val: 0.968485 test: 0.964840
max validation accuracy : 0.973333 max acc epoch : 45 test accuracy : 0.970320

Epoch :  54 loss training:  2.1102986778168997 Time :  1521
accuracy train: 0.997648 val: 0.973333 test: 0.963470
max validation accuracy : 0.973333 max acc epoch : 45 test accuracy : 0.970320

Epoch :  55 loss training:  1.9803478118792555 Time :  1536
accuracy train: 0.996792 val: 0.964848 test: 0.956164
max validation accuracy : 0.973333 max acc epoch : 45 test accuracy : 0.970320

Epoch :  56 loss training:  1.5616006517702772 Time :  1550
accuracy train: 0.997220 val: 0.969697 test: 0.956621
max validation accuracy : 0.973333 max acc epoch : 45 test accuracy : 0.970320

Epoch :  57 loss training:  1.301146907421753 Time :  1565
accuracy train: 0.997648 val: 0.966061 test: 0.960274
max validation accuracy : 0.973333 max acc epoch : 45 test accuracy : 0.970320

Epoch :  58 loss training:  2.6972124650492333 Time :  1580
accuracy train: 0.996578 val: 0.969697 test: 0.965297
max validation accuracy : 0.973333 max acc epoch : 45 test accuracy : 0.970320

Epoch :  59 loss training:  1.5507061287316901 Time :  1594
accuracy train: 0.997434 val: 0.969697 test: 0.965297
max validation accuracy : 0.973333 max acc epoch : 45 test accuracy : 0.970320

Epoch :  60 loss training:  1.361227881299783 Time :  1609
accuracy train: 0.997434 val: 0.975758 test: 0.964840
max validation accuracy : 0.975758 max acc epoch : 60 test accuracy : 0.964840

Epoch :  61 loss training:  1.4624210613665127 Time :  1623
accuracy train: 0.997220 val: 0.963636 test: 0.963014
max validation accuracy : 0.975758 max acc epoch : 60 test accuracy : 0.964840

Epoch :  62 loss training:  1.276942063642764 Time :  1638
accuracy train: 0.997648 val: 0.974545 test: 0.962100
max validation accuracy : 0.975758 max acc epoch : 60 test accuracy : 0.964840

Epoch :  63 loss training:  1.4578856451362299 Time :  1653
accuracy train: 0.997648 val: 0.973333 test: 0.967123
max validation accuracy : 0.975758 max acc epoch : 60 test accuracy : 0.964840

Epoch :  64 loss training:  1.6257598896891068 Time :  1667
accuracy train: 0.997220 val: 0.966061 test: 0.972603
max validation accuracy : 0.975758 max acc epoch : 60 test accuracy : 0.964840

Epoch :  65 loss training:  1.8032914941309173 Time :  1682
accuracy train: 0.997434 val: 0.972121 test: 0.967123
max validation accuracy : 0.975758 max acc epoch : 60 test accuracy : 0.964840

Epoch :  66 loss training:  1.4919485094906122 Time :  1697
accuracy train: 0.997434 val: 0.968485 test: 0.955708
max validation accuracy : 0.975758 max acc epoch : 60 test accuracy : 0.964840

Epoch :  67 loss training:  1.9865680340517429 Time :  1711
accuracy train: 0.997220 val: 0.972121 test: 0.965753
max validation accuracy : 0.975758 max acc epoch : 60 test accuracy : 0.964840

Epoch :  68 loss training:  1.2065134790955199 Time :  1726
accuracy train: 0.996792 val: 0.975758 test: 0.959817
max validation accuracy : 0.975758 max acc epoch : 60 test accuracy : 0.964840

Epoch :  69 loss training:  1.3931837961272322 Time :  1740
accuracy train: 0.997220 val: 0.974545 test: 0.967123
max validation accuracy : 0.975758 max acc epoch : 60 test accuracy : 0.964840

Epoch :  70 loss training:  1.5553724145693195 Time :  1755
accuracy train: 0.995295 val: 0.966061 test: 0.958904
max validation accuracy : 0.975758 max acc epoch : 60 test accuracy : 0.964840

Epoch :  71 loss training:  1.6731012238192307 Time :  1770
accuracy train: 0.997220 val: 0.969697 test: 0.965297
max validation accuracy : 0.975758 max acc epoch : 60 test accuracy : 0.964840

Epoch :  72 loss training:  1.6829302061000817 Time :  1784
accuracy train: 0.996792 val: 0.968485 test: 0.965297
max validation accuracy : 0.975758 max acc epoch : 60 test accuracy : 0.964840

Epoch :  73 loss training:  1.08867890055717 Time :  1799
accuracy train: 0.997648 val: 0.975758 test: 0.964840
max validation accuracy : 0.975758 max acc epoch : 60 test accuracy : 0.964840

Epoch :  74 loss training:  1.2125939487555115 Time :  1814
accuracy train: 0.997220 val: 0.973333 test: 0.967580
max validation accuracy : 0.975758 max acc epoch : 60 test accuracy : 0.964840

Epoch :  75 loss training:  1.199215596729573 Time :  1828
accuracy train: 0.997861 val: 0.976970 test: 0.968493
max validation accuracy : 0.976970 max acc epoch : 75 test accuracy : 0.968493

Epoch :  76 loss training:  1.080051520807956 Time :  1843
accuracy train: 0.997648 val: 0.976970 test: 0.967123
max validation accuracy : 0.976970 max acc epoch : 75 test accuracy : 0.968493

Epoch :  77 loss training:  1.3211299329125268 Time :  1858
accuracy train: 0.997434 val: 0.974545 test: 0.961187
max validation accuracy : 0.976970 max acc epoch : 75 test accuracy : 0.968493

Epoch :  78 loss training:  1.4213471480384214 Time :  1872
accuracy train: 0.997220 val: 0.975758 test: 0.969863
max validation accuracy : 0.976970 max acc epoch : 75 test accuracy : 0.968493

Epoch :  79 loss training:  1.2139765024207918 Time :  1887
accuracy train: 0.995295 val: 0.972121 test: 0.961187
max validation accuracy : 0.976970 max acc epoch : 75 test accuracy : 0.968493

Epoch :  80 loss training:  1.5990916419848418 Time :  1901
accuracy train: 0.997648 val: 0.973333 test: 0.957991
max validation accuracy : 0.976970 max acc epoch : 75 test accuracy : 0.968493

Epoch :  81 loss training:  1.327901041806399 Time :  1916
accuracy train: 0.997861 val: 0.972121 test: 0.965297
max validation accuracy : 0.976970 max acc epoch : 75 test accuracy : 0.968493

Epoch :  82 loss training:  1.1553331221252634 Time :  1930
accuracy train: 0.997648 val: 0.974545 test: 0.969406
max validation accuracy : 0.976970 max acc epoch : 75 test accuracy : 0.968493

Epoch :  83 loss training:  1.3626232356741639 Time :  1945
accuracy train: 0.997434 val: 0.973333 test: 0.968493
max validation accuracy : 0.976970 max acc epoch : 75 test accuracy : 0.968493

Epoch :  84 loss training:  1.2244373388257372 Time :  1960
accuracy train: 0.997648 val: 0.970909 test: 0.966667
max validation accuracy : 0.976970 max acc epoch : 75 test accuracy : 0.968493

Epoch :  85 loss training:  1.4994869570261926 Time :  1974
accuracy train: 0.997434 val: 0.961212 test: 0.952968
max validation accuracy : 0.976970 max acc epoch : 75 test accuracy : 0.968493

Epoch :  86 loss training:  1.3298788716838317 Time :  1989
accuracy train: 0.997434 val: 0.974545 test: 0.968493
max validation accuracy : 0.976970 max acc epoch : 75 test accuracy : 0.968493

Epoch :  87 loss training:  2.0615340301935703 Time :  2004
accuracy train: 0.995081 val: 0.962424 test: 0.962100
max validation accuracy : 0.976970 max acc epoch : 75 test accuracy : 0.968493

Epoch :  88 loss training:  2.7449394274153747 Time :  2018
accuracy train: 0.997648 val: 0.969697 test: 0.961644
max validation accuracy : 0.976970 max acc epoch : 75 test accuracy : 0.968493

Epoch :  89 loss training:  1.3047172431397485 Time :  2033
accuracy train: 0.997006 val: 0.970909 test: 0.960274
max validation accuracy : 0.976970 max acc epoch : 75 test accuracy : 0.968493

Epoch :  90 loss training:  1.4355987552062288 Time :  2048
accuracy train: 0.997006 val: 0.973333 test: 0.959361
max validation accuracy : 0.976970 max acc epoch : 75 test accuracy : 0.968493

Epoch :  91 loss training:  1.5226175507834796 Time :  2062
accuracy train: 0.997434 val: 0.978182 test: 0.962100
max validation accuracy : 0.978182 max acc epoch : 91 test accuracy : 0.962100

Epoch :  92 loss training:  1.2464373616089688 Time :  2077
accuracy train: 0.997861 val: 0.975758 test: 0.964384
max validation accuracy : 0.978182 max acc epoch : 91 test accuracy : 0.962100

Epoch :  93 loss training:  1.1434969296396957 Time :  2092
accuracy train: 0.997861 val: 0.974545 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 91 test accuracy : 0.962100

Epoch :  94 loss training:  1.3047820468253803 Time :  2106
accuracy train: 0.997648 val: 0.979394 test: 0.962557
max validation accuracy : 0.979394 max acc epoch : 94 test accuracy : 0.962557

Epoch :  95 loss training:  1.095760314708599 Time :  2121
accuracy train: 0.995295 val: 0.978182 test: 0.966667
max validation accuracy : 0.979394 max acc epoch : 94 test accuracy : 0.962557

Epoch :  96 loss training:  1.2196153770009914 Time :  2136
accuracy train: 0.997861 val: 0.976970 test: 0.966667
max validation accuracy : 0.979394 max acc epoch : 94 test accuracy : 0.962557

Epoch :  97 loss training:  1.4764912528303284 Time :  2150
accuracy train: 0.997861 val: 0.978182 test: 0.964384
max validation accuracy : 0.979394 max acc epoch : 94 test accuracy : 0.962557

Epoch :  98 loss training:  1.0940591142493759 Time :  2165
accuracy train: 0.997648 val: 0.979394 test: 0.969863
max validation accuracy : 0.979394 max acc epoch : 94 test accuracy : 0.962557

Epoch :  99 loss training:  1.3098217897920676 Time :  2179
accuracy train: 0.997648 val: 0.970909 test: 0.962100
max validation accuracy : 0.979394 max acc epoch : 94 test accuracy : 0.962557

Epoch :  100 loss training:  1.2691249689743813 Time :  2194
accuracy train: 0.997434 val: 0.978182 test: 0.962100
max validation accuracy : 0.979394 max acc epoch : 94 test accuracy : 0.962557

Epoch :  101 loss training:  1.0406678975432442 Time :  2209
accuracy train: 0.997648 val: 0.978182 test: 0.966667
max validation accuracy : 0.979394 max acc epoch : 94 test accuracy : 0.962557

Epoch :  102 loss training:  1.2083346545505265 Time :  2223
accuracy train: 0.997648 val: 0.973333 test: 0.960274
max validation accuracy : 0.979394 max acc epoch : 94 test accuracy : 0.962557

Epoch :  103 loss training:  2.172032059739422 Time :  2238
accuracy train: 0.997648 val: 0.970909 test: 0.957991
max validation accuracy : 0.979394 max acc epoch : 94 test accuracy : 0.962557

Epoch :  104 loss training:  1.2001969445743725 Time :  2252
accuracy train: 0.997648 val: 0.975758 test: 0.968037
max validation accuracy : 0.979394 max acc epoch : 94 test accuracy : 0.962557

Epoch :  105 loss training:  0.9533195070998772 Time :  2267
accuracy train: 0.997861 val: 0.972121 test: 0.965753
max validation accuracy : 0.979394 max acc epoch : 94 test accuracy : 0.962557

Epoch :  106 loss training:  1.010673007187961 Time :  2282
accuracy train: 0.997648 val: 0.978182 test: 0.973059
max validation accuracy : 0.979394 max acc epoch : 94 test accuracy : 0.962557

Epoch :  107 loss training:  1.631446886985259 Time :  2296
accuracy train: 0.997648 val: 0.979394 test: 0.965753
max validation accuracy : 0.979394 max acc epoch : 94 test accuracy : 0.962557

Epoch :  108 loss training:  1.312646223513866 Time :  2311
accuracy train: 0.997648 val: 0.980606 test: 0.964384
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  109 loss training:  1.0956015290350933 Time :  2326
accuracy train: 0.997434 val: 0.976970 test: 0.966210
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  110 loss training:  1.274228630552443 Time :  2340
accuracy train: 0.997648 val: 0.979394 test: 0.968950
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  111 loss training:  1.4061969315998795 Time :  2355
accuracy train: 0.997861 val: 0.978182 test: 0.968950
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  112 loss training:  1.8569069884715645 Time :  2369
accuracy train: 0.994867 val: 0.970909 test: 0.967123
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  113 loss training:  1.375027989609066 Time :  2384
accuracy train: 0.997648 val: 0.974545 test: 0.965753
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  114 loss training:  1.1990195982033782 Time :  2399
accuracy train: 0.997648 val: 0.978182 test: 0.969406
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  115 loss training:  1.1089274960570492 Time :  2413
accuracy train: 0.997861 val: 0.974545 test: 0.967123
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  116 loss training:  1.1164768142904222 Time :  2428
accuracy train: 0.997648 val: 0.973333 test: 0.967123
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  117 loss training:  1.1733701141447455 Time :  2443
accuracy train: 0.997861 val: 0.973333 test: 0.965753
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  118 loss training:  1.7614381705725464 Time :  2457
accuracy train: 0.997648 val: 0.978182 test: 0.960731
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  119 loss training:  1.0256128013127181 Time :  2472
accuracy train: 0.997861 val: 0.973333 test: 0.959817
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  120 loss training:  1.1313966178502142 Time :  2487
accuracy train: 0.997861 val: 0.974545 test: 0.965753
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  121 loss training:  1.1057758264551012 Time :  2501
accuracy train: 0.997861 val: 0.972121 test: 0.964384
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  122 loss training:  1.045067246521512 Time :  2516
accuracy train: 0.997861 val: 0.975758 test: 0.965297
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  123 loss training:  1.1581419255597893 Time :  2530
accuracy train: 0.997861 val: 0.973333 test: 0.962100
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  124 loss training:  1.1982596968232428 Time :  2545
accuracy train: 0.997861 val: 0.972121 test: 0.965297
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  125 loss training:  1.2612434913471589 Time :  2560
accuracy train: 0.995295 val: 0.968485 test: 0.965297
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  126 loss training:  1.080437782735089 Time :  2574
accuracy train: 0.997006 val: 0.970909 test: 0.968493
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  127 loss training:  1.2623278933889424 Time :  2589
accuracy train: 0.997861 val: 0.968485 test: 0.964840
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  128 loss training:  1.2117815931587756 Time :  2604
accuracy train: 0.997434 val: 0.973333 test: 0.967580
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  129 loss training:  2.910798042214992 Time :  2618
accuracy train: 0.997648 val: 0.962424 test: 0.963014
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  130 loss training:  1.4195390986494658 Time :  2633
accuracy train: 0.997861 val: 0.969697 test: 0.967123
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  131 loss training:  1.3224316400137468 Time :  2647
accuracy train: 0.997220 val: 0.967273 test: 0.966667
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  132 loss training:  1.1173188601333095 Time :  2662
accuracy train: 0.995723 val: 0.966061 test: 0.967580
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  133 loss training:  1.2708544962742963 Time :  2677
accuracy train: 0.997861 val: 0.970909 test: 0.967580
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  134 loss training:  1.1323007064877402 Time :  2691
accuracy train: 0.997861 val: 0.975758 test: 0.967123
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  135 loss training:  1.3310605272197336 Time :  2706
accuracy train: 0.997861 val: 0.967273 test: 0.957991
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  136 loss training:  1.1566129230261595 Time :  2720
accuracy train: 0.997648 val: 0.966061 test: 0.963014
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  137 loss training:  1.1253247134977755 Time :  2735
accuracy train: 0.997861 val: 0.972121 test: 0.964840
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  138 loss training:  1.1738410808807203 Time :  2750
accuracy train: 0.997861 val: 0.972121 test: 0.965753
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

Epoch :  139 loss training:  1.3466824368902053 Time :  2764
accuracy train: 0.997861 val: 0.974545 test: 0.965753
max validation accuracy : 0.980606 max acc epoch : 108 test accuracy : 0.964384

========================================================================================================================================================================================================
best acc epoch :  108
validation accuracy :  0.9806060606060606
test accuracy :  0.9643835616438357
last test_accuracy :  0.9657534246575342
second best val :  0.9793939393939394
second best test :  0.9625570776255707
max gap 25
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  20 	 val_accuracy : 0.97818 	 test_accuracy : 0.96941 	 last test_accuracy : 0.96758 	 second best val : 0.97576 	 second best test : 0.96941
k :  1 	 best_acc epoch :  108 	 val_accuracy : 0.98061 	 test_accuracy : 0.96438 	 last test_accuracy : 0.96575 	 second best val : 0.97939 	 second best test : 0.96256

avg :  	 val_accuracy : 0.97939 	 test_accuracy : 0.96689 	 last_accuracy : 0.96667 	 second best val : 0.97758 	 second best test : 0.96598

std :  	 val_accuracy : 0.00121 	 test_accuracy : 0.00251 	 last_accuracy : 0.00091 	 second best val : 0.00182 	 second best test : 0.00342


date and time :  Sat Jun 19 21:25:47 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=2, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=764, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  46.31837074458599 Time :  16
accuracy train: 0.960864 val: 0.956364 test: 0.951142
max validation accuracy : 0.956364 max acc epoch : 1 test accuracy : 0.951142
Counter({1: 3961, 0: 3730})

Epoch :  2 loss training:  16.651203504763544 Time :  33
accuracy train: 0.972412 val: 0.958788 test: 0.967580
max validation accuracy : 0.958788 max acc epoch : 2 test accuracy : 0.967580
Counter({1: 3928, 0: 3763})

Epoch :  3 loss training:  14.776269704569131 Time :  48
accuracy train: 0.984602 val: 0.966061 test: 0.965297
max validation accuracy : 0.966061 max acc epoch : 3 test accuracy : 0.965297
Counter({0: 3910, 1: 3781})

Epoch :  4 loss training:  12.56739877583459 Time :  65
accuracy train: 0.982891 val: 0.963636 test: 0.962100
max validation accuracy : 0.966061 max acc epoch : 3 test accuracy : 0.965297
Counter({1: 3897, 0: 3794})

Epoch :  5 loss training:  10.226931675802916 Time :  81
accuracy train: 0.980967 val: 0.961212 test: 0.965753
max validation accuracy : 0.966061 max acc epoch : 3 test accuracy : 0.965297
Counter({0: 3878, 1: 3813})

Epoch :  6 loss training:  10.376267178566195 Time :  99
accuracy train: 0.982891 val: 0.969697 test: 0.963014
max validation accuracy : 0.969697 max acc epoch : 6 test accuracy : 0.963014
Counter({1: 3888, 0: 3803})

Epoch :  7 loss training:  8.632875503448304 Time :  117
accuracy train: 0.989307 val: 0.972121 test: 0.967580
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({1: 3866, 0: 3825})

Epoch :  8 loss training:  7.49065637588501 Time :  134
accuracy train: 0.986741 val: 0.966061 test: 0.973059
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({1: 3848, 0: 3843})

Epoch :  9 loss training:  7.391102666268125 Time :  151
accuracy train: 0.988879 val: 0.966061 test: 0.966210
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({0: 3848, 1: 3843})

Epoch :  10 loss training:  6.659988630213775 Time :  167
accuracy train: 0.993157 val: 0.966061 test: 0.963470
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({1: 3890, 0: 3801})

Epoch :  11 loss training:  6.482623167219572 Time :  184
accuracy train: 0.993157 val: 0.966061 test: 0.967580
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({1: 3846, 0: 3845})

Epoch :  12 loss training:  5.3292270767487935 Time :  202
accuracy train: 0.991660 val: 0.958788 test: 0.969863
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({0: 3874, 1: 3817})

Epoch :  13 loss training:  4.509164661896648 Time :  219
accuracy train: 0.992301 val: 0.967273 test: 0.971233
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({1: 3864, 0: 3827})

Epoch :  14 loss training:  3.977471178106498 Time :  236
accuracy train: 0.994654 val: 0.962424 test: 0.972603
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({1: 3903, 0: 3788})

Epoch :  15 loss training:  3.5255111459991895 Time :  254
accuracy train: 0.995295 val: 0.966061 test: 0.968950
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({0: 3869, 1: 3822})

Epoch :  16 loss training:  4.7069366054056445 Time :  271
accuracy train: 0.995509 val: 0.963636 test: 0.968037
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({0: 3907, 1: 3784})

Epoch :  17 loss training:  2.994685022102203 Time :  287
accuracy train: 0.995509 val: 0.963636 test: 0.972146
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({1: 3878, 0: 3813})

Epoch :  18 loss training:  2.345656045115902 Time :  304
accuracy train: 0.995937 val: 0.963636 test: 0.970776
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({1: 3878, 0: 3813})

Epoch :  19 loss training:  3.2343169147061417 Time :  323
accuracy train: 0.996364 val: 0.962424 test: 0.968950
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({0: 3910, 1: 3781})

Epoch :  20 loss training:  2.4452722624118906 Time :  341
accuracy train: 0.996578 val: 0.963636 test: 0.974429
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({0: 3885, 1: 3806})

Epoch :  21 loss training:  1.947293487348361 Time :  358
accuracy train: 0.996151 val: 0.962424 test: 0.972146
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({1: 3888, 0: 3803})

Epoch :  22 loss training:  2.0002057016536128 Time :  376
accuracy train: 0.996364 val: 0.963636 test: 0.973059
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({1: 3881, 0: 3810})

Epoch :  23 loss training:  2.0306264473692863 Time :  393
accuracy train: 0.996578 val: 0.962424 test: 0.973059
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({0: 3881, 1: 3810})

Epoch :  24 loss training:  2.1547888335117023 Time :  411
accuracy train: 0.996364 val: 0.964848 test: 0.968950
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({1: 3882, 0: 3809})

Epoch :  25 loss training:  3.408805965194915 Time :  427
accuracy train: 0.993798 val: 0.958788 test: 0.972603
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({1: 3869, 0: 3822})

Epoch :  26 loss training:  3.0627928752546723 Time :  445
accuracy train: 0.996151 val: 0.956364 test: 0.970320
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({1: 3873, 0: 3818})

Epoch :  27 loss training:  2.091327921836637 Time :  461
accuracy train: 0.996364 val: 0.962424 test: 0.973973
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({0: 3878, 1: 3813})

Epoch :  28 loss training:  1.9682274841325125 Time :  480
accuracy train: 0.996792 val: 0.961212 test: 0.968950
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({0: 3880, 1: 3811})

Epoch :  29 loss training:  1.8588365406321827 Time :  498
accuracy train: 0.996364 val: 0.964848 test: 0.970320
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({1: 3878, 0: 3813})

Epoch :  30 loss training:  1.4357995206410124 Time :  516
accuracy train: 0.996792 val: 0.960000 test: 0.971233
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({1: 3877, 0: 3814})

Epoch :  31 loss training:  1.6100466851839883 Time :  533
accuracy train: 0.996578 val: 0.966061 test: 0.974886
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({1: 3912, 0: 3779})

Epoch :  32 loss training:  1.8442385603302682 Time :  550
accuracy train: 0.994440 val: 0.962424 test: 0.972146
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({0: 3873, 1: 3818})

Epoch :  33 loss training:  1.8509812975753448 Time :  568
accuracy train: 0.994440 val: 0.960000 test: 0.973059
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({0: 3875, 1: 3816})

Epoch :  34 loss training:  2.081070346681372 Time :  585
accuracy train: 0.996578 val: 0.964848 test: 0.972603
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({0: 3875, 1: 3816})

Epoch :  35 loss training:  1.7922853998916253 Time :  603
accuracy train: 0.996364 val: 0.964848 test: 0.973059
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({0: 3880, 1: 3811})

Epoch :  36 loss training:  3.2878966954231146 Time :  620
accuracy train: 0.994440 val: 0.960000 test: 0.968950
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({1: 3909, 0: 3782})

Epoch :  37 loss training:  1.9636405439086957 Time :  637
accuracy train: 0.996792 val: 0.964848 test: 0.975342
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({0: 3901, 1: 3790})

Epoch :  38 loss training:  2.694850592932198 Time :  655
accuracy train: 0.996792 val: 0.967273 test: 0.967580
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967580
Counter({0: 3907, 1: 3784})

========================================================================================================================================================================================================
best acc epoch :  7
validation accuracy :  0.9721212121212122
test accuracy :  0.9675799086757991
last test_accuracy :  0.9675799086757991
second best val :  0.9696969696969697
second best test :  0.963013698630137
max gap 3
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=2, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=558, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 4721, 0: 2970})

Epoch :  1 loss training:  45.28697754442692 Time :  673
accuracy train: 0.955518 val: 0.941818 test: 0.948858
max validation accuracy : 0.941818 max acc epoch : 1 test accuracy : 0.948858
Counter({1: 3908, 0: 3783})

Epoch :  2 loss training:  18.237651443108916 Time :  691
accuracy train: 0.974551 val: 0.957576 test: 0.968037
max validation accuracy : 0.957576 max acc epoch : 2 test accuracy : 0.968037
Counter({1: 3862, 0: 3829})

Epoch :  3 loss training:  14.179597286973149 Time :  707
accuracy train: 0.978614 val: 0.973333 test: 0.965297
max validation accuracy : 0.973333 max acc epoch : 3 test accuracy : 0.965297
Counter({0: 3852, 1: 3839})

Epoch :  4 loss training:  11.69192906934768 Time :  725
accuracy train: 0.979897 val: 0.968485 test: 0.971689
max validation accuracy : 0.973333 max acc epoch : 3 test accuracy : 0.965297
Counter({1: 3873, 0: 3818})

Epoch :  5 loss training:  11.020284837577492 Time :  742
accuracy train: 0.975834 val: 0.967273 test: 0.964840
max validation accuracy : 0.973333 max acc epoch : 3 test accuracy : 0.965297
Counter({1: 3850, 0: 3841})

Epoch :  6 loss training:  10.323057715315372 Time :  759
accuracy train: 0.988666 val: 0.976970 test: 0.974429
max validation accuracy : 0.976970 max acc epoch : 6 test accuracy : 0.974429
Counter({1: 3868, 0: 3823})

Epoch :  7 loss training:  8.042123365448788 Time :  774
accuracy train: 0.977545 val: 0.968485 test: 0.970320
max validation accuracy : 0.976970 max acc epoch : 6 test accuracy : 0.974429
Counter({0: 3856, 1: 3835})

Epoch :  8 loss training:  8.662766944093164 Time :  792
accuracy train: 0.987810 val: 0.970909 test: 0.974886
max validation accuracy : 0.976970 max acc epoch : 6 test accuracy : 0.974429
Counter({1: 3876, 0: 3815})

Epoch :  9 loss training:  7.770322060678154 Time :  808
accuracy train: 0.989521 val: 0.975758 test: 0.977169
max validation accuracy : 0.976970 max acc epoch : 6 test accuracy : 0.974429
Counter({0: 3916, 1: 3775})

Epoch :  10 loss training:  7.270502565777861 Time :  825
accuracy train: 0.991018 val: 0.972121 test: 0.964840
max validation accuracy : 0.976970 max acc epoch : 6 test accuracy : 0.974429
Counter({1: 3905, 0: 3786})

Epoch :  11 loss training:  6.599164865678176 Time :  843
accuracy train: 0.989307 val: 0.974545 test: 0.971689
max validation accuracy : 0.976970 max acc epoch : 6 test accuracy : 0.974429
Counter({0: 3887, 1: 3804})

Epoch :  12 loss training:  5.5184327400056645 Time :  860
accuracy train: 0.994654 val: 0.979394 test: 0.971689
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({1: 3926, 0: 3765})

Epoch :  13 loss training:  4.530345676990692 Time :  876
accuracy train: 0.994012 val: 0.974545 test: 0.967123
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({0: 3926, 1: 3765})

Epoch :  14 loss training:  4.24217357771704 Time :  891
accuracy train: 0.988666 val: 0.972121 test: 0.973059
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({1: 3909, 0: 3782})

Epoch :  15 loss training:  3.7518046774493996 Time :  907
accuracy train: 0.994440 val: 0.966061 test: 0.968950
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({0: 3954, 1: 3737})

Epoch :  16 loss training:  3.2650274808111135 Time :  921
accuracy train: 0.992729 val: 0.967273 test: 0.966667
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({1: 3948, 0: 3743})

Epoch :  17 loss training:  2.6778641048440477 Time :  937
accuracy train: 0.995509 val: 0.976970 test: 0.971689
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({0: 3930, 1: 3761})

Epoch :  18 loss training:  2.48189918549906 Time :  952
accuracy train: 0.997006 val: 0.973333 test: 0.972146
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({0: 3927, 1: 3764})

Epoch :  19 loss training:  2.554105217830511 Time :  969
accuracy train: 0.995723 val: 0.972121 test: 0.968950
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({0: 3944, 1: 3747})

Epoch :  20 loss training:  2.139763485538424 Time :  985
accuracy train: 0.992515 val: 0.973333 test: 0.967580
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({1: 3937, 0: 3754})

Epoch :  21 loss training:  1.997940560862844 Time :  1004
accuracy train: 0.995937 val: 0.976970 test: 0.974429
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({1: 3937, 0: 3754})

Epoch :  22 loss training:  2.137536127047497 Time :  1023
accuracy train: 0.996578 val: 0.975758 test: 0.967123
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({0: 3922, 1: 3769})

Epoch :  23 loss training:  2.184191635562456 Time :  1040
accuracy train: 0.996578 val: 0.976970 test: 0.974886
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({1: 3934, 0: 3757})

Epoch :  24 loss training:  2.2433602211021935 Time :  1056
accuracy train: 0.996792 val: 0.975758 test: 0.969406
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({0: 3932, 1: 3759})

Epoch :  25 loss training:  3.360349436858087 Time :  1075
accuracy train: 0.994226 val: 0.969697 test: 0.968037
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({1: 3892, 0: 3799})

Epoch :  26 loss training:  3.0245223911333596 Time :  1093
accuracy train: 0.996578 val: 0.975758 test: 0.969863
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({0: 3928, 1: 3763})

Epoch :  27 loss training:  2.0303981385804946 Time :  1110
accuracy train: 0.996792 val: 0.974545 test: 0.970776
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({0: 3923, 1: 3768})

Epoch :  28 loss training:  1.7015916251766612 Time :  1127
accuracy train: 0.996792 val: 0.976970 test: 0.971233
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({1: 3922, 0: 3769})

Epoch :  29 loss training:  1.9647816272299679 Time :  1145
accuracy train: 0.996578 val: 0.975758 test: 0.969406
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({0: 3922, 1: 3769})

Epoch :  30 loss training:  1.902246370951616 Time :  1163
accuracy train: 0.996578 val: 0.974545 test: 0.969406
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({1: 3893, 0: 3798})

Epoch :  31 loss training:  1.8595856740612362 Time :  1181
accuracy train: 0.996578 val: 0.973333 test: 0.969406
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({1: 3933, 0: 3758})

Epoch :  32 loss training:  1.9399091011291603 Time :  1198
accuracy train: 0.996792 val: 0.975758 test: 0.970776
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({0: 3926, 1: 3765})

Epoch :  33 loss training:  1.8354438916612708 Time :  1216
accuracy train: 0.996364 val: 0.974545 test: 0.974429
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({1: 3931, 0: 3760})

Epoch :  34 loss training:  1.9055089965149818 Time :  1234
accuracy train: 0.996578 val: 0.972121 test: 0.966667
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({0: 3892, 1: 3799})

Epoch :  35 loss training:  1.8434443440019095 Time :  1252
accuracy train: 0.997220 val: 0.976970 test: 0.968037
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({1: 3929, 0: 3762})

Epoch :  36 loss training:  1.8880579100459727 Time :  1267
accuracy train: 0.996151 val: 0.976970 test: 0.968950
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({1: 3923, 0: 3768})

Epoch :  37 loss training:  2.553215092350001 Time :  1284
accuracy train: 0.995723 val: 0.970909 test: 0.965753
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({1: 3916, 0: 3775})

Epoch :  38 loss training:  1.811920708323214 Time :  1303
accuracy train: 0.994226 val: 0.972121 test: 0.972603
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({0: 3920, 1: 3771})

Epoch :  39 loss training:  3.9201128995700856 Time :  1319
accuracy train: 0.993157 val: 0.970909 test: 0.969863
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({1: 3873, 0: 3818})

Epoch :  40 loss training:  2.1154188310783866 Time :  1337
accuracy train: 0.996151 val: 0.973333 test: 0.970776
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({0: 3924, 1: 3767})

Epoch :  41 loss training:  1.9442556806079665 Time :  1354
accuracy train: 0.995937 val: 0.975758 test: 0.968950
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({1: 3896, 0: 3795})

Epoch :  42 loss training:  1.8081123080664838 Time :  1372
accuracy train: 0.995937 val: 0.972121 test: 0.963927
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({1: 3889, 0: 3802})

Epoch :  43 loss training:  2.128497981302644 Time :  1390
accuracy train: 0.996578 val: 0.970909 test: 0.970320
max validation accuracy : 0.979394 max acc epoch : 12 test accuracy : 0.971689
Counter({1: 3915, 0: 3776})

========================================================================================================================================================================================================
best acc epoch :  12
validation accuracy :  0.9793939393939394
test accuracy :  0.971689497716895
last test_accuracy :  0.9703196347031964
second best val :  0.9769696969696969
second best test :  0.9744292237442922
max gap 6
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  7 	 val_accuracy : 0.97212 	 test_accuracy : 0.96758 	 last test_accuracy : 0.96758 	 second best val : 0.96970 	 second best test : 0.96301
k :  1 	 best_acc epoch :  12 	 val_accuracy : 0.97939 	 test_accuracy : 0.97169 	 last test_accuracy : 0.97032 	 second best val : 0.97697 	 second best test : 0.97443

avg :  	 val_accuracy : 0.97576 	 test_accuracy : 0.96963 	 last_accuracy : 0.96895 	 second best val : 0.97333 	 second best test : 0.96872

std :  	 val_accuracy : 0.00364 	 test_accuracy : 0.00205 	 last_accuracy : 0.00137 	 second best val : 0.00364 	 second best test : 0.00571
