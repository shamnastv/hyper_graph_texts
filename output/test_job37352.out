

date and time :  Mon Jun 14 11:24:20 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=855, tsne=False, weight_decay=1e-06)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  38.571995351463556 Time :  61
accuracy train: 0.956574 val: 0.949091 test: 0.953881
max validation accuracy : 0.949091 max acc epoch : 1 test accuracy : 0.953881
Counter({1: 4187, 0: 3504})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.27779469732195 Time :  86
accuracy train: 0.968491 val: 0.967273 test: 0.964840
max validation accuracy : 0.967273 max acc epoch : 2 test accuracy : 0.964840
Counter({1: 4025, 0: 3666})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.471018560230732 Time :  120
accuracy train: 0.974349 val: 0.965455 test: 0.959361
max validation accuracy : 0.967273 max acc epoch : 2 test accuracy : 0.964840
Counter({1: 3911, 0: 3780})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.326501832343638 Time :  143
accuracy train: 0.982428 val: 0.976364 test: 0.967580
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.967580
Counter({0: 3893, 1: 3798})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.271089740097523 Time :  170
accuracy train: 0.985054 val: 0.978182 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 5 test accuracy : 0.968037
Counter({1: 3895, 0: 3796})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.375694644171745 Time :  200
accuracy train: 0.985054 val: 0.969091 test: 0.959361
max validation accuracy : 0.978182 max acc epoch : 5 test accuracy : 0.968037
Counter({0: 3880, 1: 3811})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.0771507625468075 Time :  226
accuracy train: 0.986265 val: 0.972727 test: 0.966667
max validation accuracy : 0.978182 max acc epoch : 5 test accuracy : 0.968037
Counter({0: 3869, 1: 3822})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.65212337533012 Time :  254
accuracy train: 0.990507 val: 0.970909 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 5 test accuracy : 0.968037
Counter({1: 3860, 0: 3831})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.285222793463618 Time :  274
accuracy train: 0.990507 val: 0.976364 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 5 test accuracy : 0.968037
Counter({1: 3859, 0: 3832})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.814975497429259 Time :  304
accuracy train: 0.992527 val: 0.976364 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 5 test accuracy : 0.968037
Counter({1: 3850, 0: 3841})

Epoch :  11 loss training:  5.441894150571898 Time :  335
accuracy train: 0.993133 val: 0.978182 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 5 test accuracy : 0.968037
Counter({0: 3854, 1: 3837})

Epoch :  12 loss training:  4.805325576104224 Time :  362
accuracy train: 0.992931 val: 0.980000 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 12 test accuracy : 0.969406
Counter({1: 3868, 0: 3823})

Epoch :  13 loss training:  5.41107864305377 Time :  394
accuracy train: 0.994547 val: 0.974545 test: 0.968493
max validation accuracy : 0.980000 max acc epoch : 12 test accuracy : 0.969406
Counter({0: 3870, 1: 3821})

Epoch :  14 loss training:  4.9460903140716255 Time :  416
accuracy train: 0.994143 val: 0.981818 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 14 test accuracy : 0.969406
Counter({1: 3883, 0: 3808})

Epoch :  15 loss training:  4.017173575470224 Time :  448
accuracy train: 0.994143 val: 0.978182 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 14 test accuracy : 0.969406
Counter({0: 3884, 1: 3807})

Epoch :  16 loss training:  4.0063934564823285 Time :  470
accuracy train: 0.994749 val: 0.974545 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 14 test accuracy : 0.969406
Counter({1: 3887, 0: 3804})

Epoch :  17 loss training:  3.628763547021663 Time :  500
accuracy train: 0.994951 val: 0.978182 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 14 test accuracy : 0.969406
Counter({0: 3885, 1: 3806})

Epoch :  18 loss training:  3.379479356983211 Time :  524
accuracy train: 0.995960 val: 0.980000 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 14 test accuracy : 0.969406
Counter({1: 3892, 0: 3799})

Epoch :  19 loss training:  3.2074064309708774 Time :  555
accuracy train: 0.995152 val: 0.976364 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 14 test accuracy : 0.969406
Counter({1: 3880, 0: 3811})

Epoch :  20 loss training:  3.531692026532255 Time :  579
accuracy train: 0.996364 val: 0.981818 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 14 test accuracy : 0.969406
Counter({1: 3895, 0: 3796})

Epoch :  21 loss training:  3.1147402460337617 Time :  611
accuracy train: 0.996364 val: 0.972727 test: 0.968493
max validation accuracy : 0.981818 max acc epoch : 14 test accuracy : 0.969406
Counter({0: 3890, 1: 3801})

Epoch :  22 loss training:  2.847369961789809 Time :  633
accuracy train: 0.996162 val: 0.974545 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 14 test accuracy : 0.969406
Counter({1: 3905, 0: 3786})

Epoch :  23 loss training:  2.5498991216009017 Time :  664
accuracy train: 0.996364 val: 0.976364 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 14 test accuracy : 0.969406
Counter({0: 3893, 1: 3798})

Epoch :  24 loss training:  2.3536792624217924 Time :  686
accuracy train: 0.995960 val: 0.974545 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 14 test accuracy : 0.969406
Counter({0: 3908, 1: 3783})

Epoch :  25 loss training:  2.3920621296274476 Time :  717
accuracy train: 0.996768 val: 0.978182 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 14 test accuracy : 0.969406
Counter({1: 3912, 0: 3779})

========================================================================================================================================================================================================
best acc epoch :  14
validation accuracy :  0.9818181818181818
test accuracy :  0.9694063926940639
last test_accuracy :  0.9703196347031964
second best val :  0.98
second best test :  0.9694063926940639
max gap 7
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=246, tsne=False, weight_decay=1e-06)
device :  cuda:0
Counter({0: 4721, 1: 2970})

Epoch :  1 loss training:  44.766770269721746 Time :  797
accuracy train: 0.947889 val: 0.943636 test: 0.940183
max validation accuracy : 0.943636 max acc epoch : 1 test accuracy : 0.940183
Counter({1: 4228, 0: 3463})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.029665797948837 Time :  815
accuracy train: 0.955363 val: 0.943636 test: 0.958904
max validation accuracy : 0.943636 max acc epoch : 1 test accuracy : 0.940183
Counter({1: 4038, 0: 3653})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.195610783121083 Time :  852
accuracy train: 0.955968 val: 0.938182 test: 0.960274
max validation accuracy : 0.943636 max acc epoch : 1 test accuracy : 0.940183
Counter({0: 4036, 1: 3655})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.581926493905485 Time :  872
accuracy train: 0.985256 val: 0.974545 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.970776
Counter({0: 3986, 1: 3705})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.448422950692475 Time :  906
accuracy train: 0.984852 val: 0.970909 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.970776
Counter({0: 3955, 1: 3736})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.081456605810672 Time :  926
accuracy train: 0.987477 val: 0.972727 test: 0.963927
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.970776
Counter({0: 3864, 1: 3827})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.75610804441385 Time :  961
accuracy train: 0.989295 val: 0.969091 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.970776
Counter({0: 3865, 1: 3826})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.2716539243701845 Time :  978
accuracy train: 0.991719 val: 0.974545 test: 0.963014
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.970776
Counter({1: 3847, 0: 3844})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.472589870740194 Time :  1012
accuracy train: 0.993133 val: 0.972727 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.970776
Counter({0: 3855, 1: 3836})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.439675864763558 Time :  1031
accuracy train: 0.991113 val: 0.972727 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.970776
Counter({1: 3861, 0: 3830})

Epoch :  11 loss training:  5.400554143707268 Time :  1064
accuracy train: 0.991113 val: 0.972727 test: 0.966210
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.970776
Counter({0: 3846, 1: 3845})

Epoch :  12 loss training:  4.779662844026461 Time :  1083
accuracy train: 0.992325 val: 0.972727 test: 0.965753
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.970776
Counter({1: 3851, 0: 3840})

Epoch :  13 loss training:  4.695616266573779 Time :  1115
accuracy train: 0.991113 val: 0.974545 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.970776
Counter({0: 3857, 1: 3834})

Epoch :  14 loss training:  4.44622906355653 Time :  1136
accuracy train: 0.993537 val: 0.980000 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 14 test accuracy : 0.972603
Counter({0: 3870, 1: 3821})

Epoch :  15 loss training:  4.515847678063437 Time :  1171
accuracy train: 0.993739 val: 0.972727 test: 0.967580
max validation accuracy : 0.980000 max acc epoch : 14 test accuracy : 0.972603
Counter({0: 3864, 1: 3827})

Epoch :  16 loss training:  3.9325601488817483 Time :  1191
accuracy train: 0.993739 val: 0.972727 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 14 test accuracy : 0.972603
Counter({1: 3872, 0: 3819})

Epoch :  17 loss training:  3.831606357358396 Time :  1224
accuracy train: 0.995354 val: 0.976364 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 14 test accuracy : 0.972603
Counter({1: 3872, 0: 3819})

Epoch :  18 loss training:  3.372163244697731 Time :  1246
accuracy train: 0.994143 val: 0.972727 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 14 test accuracy : 0.972603
Counter({0: 3872, 1: 3819})

Epoch :  19 loss training:  3.233463654119987 Time :  1279
accuracy train: 0.994547 val: 0.974545 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 14 test accuracy : 0.972603
Counter({1: 3869, 0: 3822})

Epoch :  20 loss training:  3.3298177192918956 Time :  1299
accuracy train: 0.996566 val: 0.969091 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 14 test accuracy : 0.972603
Counter({1: 3882, 0: 3809})

Epoch :  21 loss training:  3.188404453219846 Time :  1332
accuracy train: 0.995960 val: 0.970909 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 14 test accuracy : 0.972603
Counter({0: 3877, 1: 3814})

Epoch :  22 loss training:  3.171327185293194 Time :  1352
accuracy train: 0.995960 val: 0.972727 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 14 test accuracy : 0.972603
Counter({1: 3887, 0: 3804})

Epoch :  23 loss training:  2.6700331085012294 Time :  1385
accuracy train: 0.995354 val: 0.976364 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 14 test accuracy : 0.972603
Counter({1: 3893, 0: 3798})

Epoch :  24 loss training:  2.5770092714228667 Time :  1405
accuracy train: 0.996162 val: 0.976364 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 14 test accuracy : 0.972603
Counter({1: 3888, 0: 3803})

Epoch :  25 loss training:  2.3964231141872006 Time :  1438
accuracy train: 0.996162 val: 0.974545 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 14 test accuracy : 0.972603
Counter({0: 3899, 1: 3792})

========================================================================================================================================================================================================
best acc epoch :  14
validation accuracy :  0.98
test accuracy :  0.9726027397260274
last test_accuracy :  0.9707762557077626
second best val :  0.9763636363636363
second best test :  0.9726027397260274
max gap 10
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=567, tsne=False, weight_decay=1e-06)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  37.94334606081247 Time :  1504
accuracy train: 0.962230 val: 0.936364 test: 0.951142
max validation accuracy : 0.936364 max acc epoch : 1 test accuracy : 0.951142
Counter({1: 4001, 0: 3690})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.01820972468704 Time :  1523
accuracy train: 0.975157 val: 0.947273 test: 0.961644
max validation accuracy : 0.947273 max acc epoch : 2 test accuracy : 0.961644
Counter({0: 3953, 1: 3738})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  13.695669231936336 Time :  1558
accuracy train: 0.974753 val: 0.947273 test: 0.963470
max validation accuracy : 0.947273 max acc epoch : 2 test accuracy : 0.961644
Counter({0: 3918, 1: 3773})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.262068426702172 Time :  1576
accuracy train: 0.986063 val: 0.947273 test: 0.962557
max validation accuracy : 0.947273 max acc epoch : 2 test accuracy : 0.961644
Counter({1: 3869, 0: 3822})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.753697395790368 Time :  1610
accuracy train: 0.985256 val: 0.947273 test: 0.951598
max validation accuracy : 0.947273 max acc epoch : 2 test accuracy : 0.961644
Counter({1: 3851, 0: 3840})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.921012956416234 Time :  1628
accuracy train: 0.985256 val: 0.950909 test: 0.962100
max validation accuracy : 0.950909 max acc epoch : 6 test accuracy : 0.962100
Counter({1: 3853, 0: 3838})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.173447559354827 Time :  1660
accuracy train: 0.991719 val: 0.956364 test: 0.960731
max validation accuracy : 0.956364 max acc epoch : 7 test accuracy : 0.960731
Counter({1: 3849, 0: 3842})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.1820446494966745 Time :  1682
accuracy train: 0.992527 val: 0.954545 test: 0.960731
max validation accuracy : 0.956364 max acc epoch : 7 test accuracy : 0.960731
Counter({0: 3859, 1: 3832})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.825503008207306 Time :  1715
accuracy train: 0.989699 val: 0.960000 test: 0.966667
max validation accuracy : 0.960000 max acc epoch : 9 test accuracy : 0.966667
Counter({1: 3857, 0: 3834})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  4.425773276365362 Time :  1735
accuracy train: 0.993537 val: 0.956364 test: 0.965753
max validation accuracy : 0.960000 max acc epoch : 9 test accuracy : 0.966667
Counter({0: 3864, 1: 3827})

Epoch :  11 loss training:  4.621334028895944 Time :  1766
accuracy train: 0.993941 val: 0.960000 test: 0.968950
max validation accuracy : 0.960000 max acc epoch : 9 test accuracy : 0.966667
Counter({1: 3868, 0: 3823})

Epoch :  12 loss training:  4.309189549123403 Time :  1788
accuracy train: 0.994547 val: 0.958182 test: 0.971689
max validation accuracy : 0.960000 max acc epoch : 9 test accuracy : 0.966667
Counter({0: 3879, 1: 3812})

Epoch :  13 loss training:  3.9377331604482606 Time :  1823
accuracy train: 0.994345 val: 0.958182 test: 0.964384
max validation accuracy : 0.960000 max acc epoch : 9 test accuracy : 0.966667
Counter({1: 3878, 0: 3813})

Epoch :  14 loss training:  3.8796514270215994 Time :  1843
accuracy train: 0.994547 val: 0.958182 test: 0.969406
max validation accuracy : 0.960000 max acc epoch : 9 test accuracy : 0.966667
Counter({0: 3885, 1: 3806})

Epoch :  15 loss training:  3.098599785938859 Time :  1876
accuracy train: 0.995556 val: 0.956364 test: 0.970320
max validation accuracy : 0.960000 max acc epoch : 9 test accuracy : 0.966667
Counter({0: 3886, 1: 3805})

Epoch :  16 loss training:  3.2629901693435386 Time :  1894
accuracy train: 0.995758 val: 0.956364 test: 0.970776
max validation accuracy : 0.960000 max acc epoch : 9 test accuracy : 0.966667
Counter({0: 3888, 1: 3803})

Epoch :  17 loss training:  3.121414065331919 Time :  1924
accuracy train: 0.995758 val: 0.958182 test: 0.963470
max validation accuracy : 0.960000 max acc epoch : 9 test accuracy : 0.966667
Counter({1: 3890, 0: 3801})

Epoch :  18 loss training:  3.014258982715546 Time :  1949
accuracy train: 0.996162 val: 0.956364 test: 0.967123
max validation accuracy : 0.960000 max acc epoch : 9 test accuracy : 0.966667
Counter({0: 3890, 1: 3801})

Epoch :  19 loss training:  2.5510271848761477 Time :  1979
accuracy train: 0.996364 val: 0.958182 test: 0.971689
max validation accuracy : 0.960000 max acc epoch : 9 test accuracy : 0.966667
Counter({0: 3897, 1: 3794})

Epoch :  20 loss training:  2.489005604002159 Time :  2009
accuracy train: 0.996566 val: 0.958182 test: 0.970776
max validation accuracy : 0.960000 max acc epoch : 9 test accuracy : 0.966667
Counter({1: 3897, 0: 3794})

========================================================================================================================================================================================================
best acc epoch :  9
validation accuracy :  0.96
test accuracy :  0.9666666666666667
last test_accuracy :  0.9707762557077626
second best val :  0.9581818181818181
second best test :  0.9666666666666667
max gap 4
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=754, tsne=False, weight_decay=1e-06)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  39.15509045496583 Time :  2085
accuracy train: 0.947283 val: 0.929091 test: 0.939269
max validation accuracy : 0.929091 max acc epoch : 1 test accuracy : 0.939269
Counter({1: 4054, 0: 3637})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.536819303408265 Time :  2107
accuracy train: 0.969905 val: 0.960000 test: 0.961187
max validation accuracy : 0.960000 max acc epoch : 2 test accuracy : 0.961187
Counter({1: 3971, 0: 3720})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.034055423922837 Time :  2139
accuracy train: 0.975964 val: 0.956364 test: 0.963927
max validation accuracy : 0.960000 max acc epoch : 2 test accuracy : 0.961187
Counter({0: 4016, 1: 3675})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.538267842959613 Time :  2158
accuracy train: 0.984650 val: 0.969091 test: 0.968037
max validation accuracy : 0.969091 max acc epoch : 4 test accuracy : 0.968037
Counter({1: 3879, 0: 3812})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.349916969891638 Time :  2192
accuracy train: 0.982630 val: 0.963636 test: 0.966210
max validation accuracy : 0.969091 max acc epoch : 4 test accuracy : 0.968037
Counter({0: 3900, 1: 3791})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.09307831316255 Time :  2215
accuracy train: 0.987881 val: 0.969091 test: 0.968950
max validation accuracy : 0.969091 max acc epoch : 4 test accuracy : 0.968037
Counter({1: 3885, 0: 3806})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.31632081605494 Time :  2249
accuracy train: 0.990305 val: 0.970909 test: 0.966667
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.966667
Counter({1: 3864, 0: 3827})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.16080699628219 Time :  2270
accuracy train: 0.989699 val: 0.970909 test: 0.973059
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.966667
Counter({0: 3879, 1: 3812})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.658564248471521 Time :  2303
accuracy train: 0.990709 val: 0.969091 test: 0.968493
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.966667
Counter({1: 3859, 0: 3832})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.35249471210409 Time :  2321
accuracy train: 0.992325 val: 0.969091 test: 0.967123
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.966667
Counter({0: 3858, 1: 3833})

Epoch :  11 loss training:  5.332824777346104 Time :  2354
accuracy train: 0.993941 val: 0.970909 test: 0.968493
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.966667
Counter({0: 3858, 1: 3833})

Epoch :  12 loss training:  4.735101232538 Time :  2374
accuracy train: 0.994143 val: 0.969091 test: 0.971689
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.966667
Counter({1: 3851, 0: 3840})

Epoch :  13 loss training:  4.252107940847054 Time :  2406
accuracy train: 0.993739 val: 0.970909 test: 0.967123
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.966667
Counter({1: 3850, 0: 3841})

Epoch :  14 loss training:  4.456962976139039 Time :  2428
accuracy train: 0.994547 val: 0.974545 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966667
Counter({1: 3858, 0: 3833})

Epoch :  15 loss training:  3.8449534566607326 Time :  2462
accuracy train: 0.995758 val: 0.974545 test: 0.965297
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966667
Counter({1: 3866, 0: 3825})

Epoch :  16 loss training:  4.166518543264829 Time :  2484
accuracy train: 0.994547 val: 0.976364 test: 0.962557
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.962557
Counter({0: 3865, 1: 3826})

Epoch :  17 loss training:  3.6084876419627108 Time :  2515
accuracy train: 0.996162 val: 0.970909 test: 0.966667
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.962557
Counter({1: 3881, 0: 3810})

Epoch :  18 loss training:  3.074214884720277 Time :  2536
accuracy train: 0.996162 val: 0.969091 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.962557
Counter({0: 3881, 1: 3810})

Epoch :  19 loss training:  3.0673725390224718 Time :  2570
accuracy train: 0.995960 val: 0.970909 test: 0.965297
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.962557
Counter({1: 3882, 0: 3809})

Epoch :  20 loss training:  2.8913934333249927 Time :  2591
accuracy train: 0.996364 val: 0.972727 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.962557
Counter({0: 3880, 1: 3811})

Epoch :  21 loss training:  2.905380466807401 Time :  2622
accuracy train: 0.995960 val: 0.970909 test: 0.968950
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.962557
Counter({1: 3884, 0: 3807})

Epoch :  22 loss training:  2.4032389393833 Time :  2641
accuracy train: 0.996566 val: 0.967273 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.962557
Counter({1: 3896, 0: 3795})

Epoch :  23 loss training:  2.5794816842244472 Time :  2673
accuracy train: 0.996970 val: 0.970909 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.962557
Counter({0: 3899, 1: 3792})

Epoch :  24 loss training:  2.2564126012439374 Time :  2695
accuracy train: 0.996364 val: 0.970909 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.962557
Counter({1: 3899, 0: 3792})

Epoch :  25 loss training:  2.5951974901836365 Time :  2726
accuracy train: 0.996768 val: 0.974545 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.962557
Counter({0: 3895, 1: 3796})

Epoch :  26 loss training:  2.3562091997882817 Time :  2747
accuracy train: 0.996768 val: 0.976364 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.962557
Counter({1: 3905, 0: 3786})

Epoch :  27 loss training:  2.4422562998515787 Time :  2777
accuracy train: 0.996768 val: 0.976364 test: 0.968493
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.962557
Counter({1: 3908, 0: 3783})

========================================================================================================================================================================================================
best acc epoch :  16
validation accuracy :  0.9763636363636363
test accuracy :  0.9625570776255707
last test_accuracy :  0.9684931506849315
second best val :  0.9745454545454545
second best test :  0.9666666666666667
max gap 7
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=617, tsne=False, weight_decay=1e-06)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  41.750053472816944 Time :  2846
accuracy train: 0.961018 val: 0.950909 test: 0.962100
max validation accuracy : 0.950909 max acc epoch : 1 test accuracy : 0.962100
Counter({0: 4036, 1: 3655})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.2107916418463 Time :  2866
accuracy train: 0.970309 val: 0.965455 test: 0.959361
max validation accuracy : 0.965455 max acc epoch : 2 test accuracy : 0.959361
Counter({1: 3956, 0: 3735})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.918045612052083 Time :  2898
accuracy train: 0.963846 val: 0.958182 test: 0.962557
max validation accuracy : 0.965455 max acc epoch : 2 test accuracy : 0.959361
Counter({1: 3877, 0: 3814})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.506906660273671 Time :  2918
accuracy train: 0.979802 val: 0.970909 test: 0.966667
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.966667
Counter({0: 3873, 1: 3818})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.315784088335931 Time :  2945
accuracy train: 0.982226 val: 0.967273 test: 0.964840
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.966667
Counter({1: 3863, 0: 3828})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.067482527345419 Time :  2964
accuracy train: 0.985054 val: 0.963636 test: 0.970776
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.966667
Counter({0: 3878, 1: 3813})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.463662460329942 Time :  2996
accuracy train: 0.989093 val: 0.963636 test: 0.963927
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.966667
Counter({1: 3850, 0: 3841})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.9090995823498815 Time :  3015
accuracy train: 0.991315 val: 0.969091 test: 0.968037
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.966667
Counter({0: 3847, 1: 3844})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.838830118649639 Time :  3045
accuracy train: 0.990305 val: 0.970909 test: 0.966667
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.966667
Counter({0: 3850, 1: 3841})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.080111991846934 Time :  3063
accuracy train: 0.991921 val: 0.970909 test: 0.968037
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.966667
Counter({0: 3848, 1: 3843})

Epoch :  11 loss training:  4.730435598408803 Time :  3094
accuracy train: 0.992931 val: 0.970909 test: 0.968493
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.966667
Counter({1: 3854, 0: 3837})

Epoch :  12 loss training:  4.053522781934589 Time :  3114
accuracy train: 0.992527 val: 0.967273 test: 0.964384
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.966667
Counter({0: 3868, 1: 3823})

Epoch :  13 loss training:  4.276938482420519 Time :  3147
accuracy train: 0.994345 val: 0.976364 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 13 test accuracy : 0.969406
Counter({0: 3871, 1: 3820})

Epoch :  14 loss training:  3.751616316207219 Time :  3166
accuracy train: 0.995152 val: 0.976364 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 13 test accuracy : 0.969406
Counter({1: 3877, 0: 3814})

Epoch :  15 loss training:  4.074748540704604 Time :  3197
accuracy train: 0.994749 val: 0.972727 test: 0.975799
max validation accuracy : 0.976364 max acc epoch : 13 test accuracy : 0.969406
Counter({0: 3879, 1: 3812})

Epoch :  16 loss training:  3.3907057972392067 Time :  3220
accuracy train: 0.995152 val: 0.970909 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 13 test accuracy : 0.969406
Counter({1: 3885, 0: 3806})

Epoch :  17 loss training:  3.4166235706652515 Time :  3245
accuracy train: 0.995354 val: 0.970909 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 13 test accuracy : 0.969406
Counter({0: 3891, 1: 3800})

Epoch :  18 loss training:  2.9441358807089273 Time :  3269
accuracy train: 0.995556 val: 0.970909 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 13 test accuracy : 0.969406
Counter({1: 3890, 0: 3801})

Epoch :  19 loss training:  2.9104038321238477 Time :  3290
accuracy train: 0.996364 val: 0.974545 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 13 test accuracy : 0.969406
Counter({1: 3891, 0: 3800})

Epoch :  20 loss training:  2.7101791805180255 Time :  3317
accuracy train: 0.996364 val: 0.972727 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 13 test accuracy : 0.969406
Counter({0: 3905, 1: 3786})

Epoch :  21 loss training:  2.4853740761172958 Time :  3335
accuracy train: 0.996566 val: 0.972727 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 13 test accuracy : 0.969406
Counter({1: 3904, 0: 3787})

Epoch :  22 loss training:  2.6200591458618874 Time :  3363
accuracy train: 0.996162 val: 0.972727 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 13 test accuracy : 0.969406
Counter({0: 3910, 1: 3781})

Epoch :  23 loss training:  2.218455252441345 Time :  3381
accuracy train: 0.995758 val: 0.970909 test: 0.968493
max validation accuracy : 0.976364 max acc epoch : 13 test accuracy : 0.969406
Counter({0: 3920, 1: 3771})

Epoch :  24 loss training:  2.285942035843618 Time :  3415
accuracy train: 0.996364 val: 0.972727 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 13 test accuracy : 0.969406
Counter({1: 3918, 0: 3773})

========================================================================================================================================================================================================
best acc epoch :  13
validation accuracy :  0.9763636363636363
test accuracy :  0.9694063926940639
last test_accuracy :  0.9703196347031964
second best val :  0.9745454545454545
second best test :  0.9694063926940639
max gap 9
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=627, tsne=False, weight_decay=1e-06)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  42.08510137535632 Time :  3444
accuracy train: 0.929307 val: 0.920000 test: 0.951142
max validation accuracy : 0.920000 max acc epoch : 1 test accuracy : 0.951142
Counter({1: 4233, 0: 3458})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.720102299004793 Time :  3473
accuracy train: 0.963442 val: 0.943636 test: 0.956621
max validation accuracy : 0.943636 max acc epoch : 2 test accuracy : 0.956621
Counter({0: 4027, 1: 3664})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.665101151913404 Time :  3493
accuracy train: 0.980408 val: 0.965455 test: 0.961187
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.961187
Counter({0: 3966, 1: 3725})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.835987261030823 Time :  3523
accuracy train: 0.980610 val: 0.963636 test: 0.963014
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.961187
Counter({1: 3933, 0: 3758})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.244298190809786 Time :  3543
accuracy train: 0.979398 val: 0.960000 test: 0.965297
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.961187
Counter({0: 3890, 1: 3801})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.91146021685563 Time :  3574
accuracy train: 0.982630 val: 0.963636 test: 0.969406
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.961187
Counter({1: 3910, 0: 3781})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.347434784285724 Time :  3598
accuracy train: 0.988487 val: 0.974545 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.969863
Counter({0: 3913, 1: 3778})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.919372038333677 Time :  3617
accuracy train: 0.990911 val: 0.970909 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.969863
Counter({0: 3899, 1: 3792})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.2818345880368724 Time :  3646
accuracy train: 0.991921 val: 0.978182 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.968950
Counter({1: 3884, 0: 3807})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.4703346631722525 Time :  3668
accuracy train: 0.992325 val: 0.967273 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.968950
Counter({0: 3874, 1: 3817})

Epoch :  11 loss training:  5.162157995160669 Time :  3692
accuracy train: 0.993133 val: 0.976364 test: 0.966210
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.968950
Counter({1: 3860, 0: 3831})

Epoch :  12 loss training:  5.556561823002994 Time :  3717
accuracy train: 0.993133 val: 0.976364 test: 0.966667
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.968950
Counter({1: 3853, 0: 3838})

Epoch :  13 loss training:  5.029015723383054 Time :  3741
accuracy train: 0.993133 val: 0.978182 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.968950
Counter({1: 3853, 0: 3838})

Epoch :  14 loss training:  4.130391472252086 Time :  3759
accuracy train: 0.992527 val: 0.970909 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.968950
Counter({0: 3846, 1: 3845})

Epoch :  15 loss training:  4.827378220681567 Time :  3795
accuracy train: 0.993335 val: 0.974545 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.968950
Counter({1: 3853, 0: 3838})

Epoch :  16 loss training:  4.149307586194482 Time :  3812
accuracy train: 0.994547 val: 0.980000 test: 0.967123
max validation accuracy : 0.980000 max acc epoch : 16 test accuracy : 0.967123
Counter({1: 3861, 0: 3830})

Epoch :  17 loss training:  4.011094195826445 Time :  3847
accuracy train: 0.993941 val: 0.976364 test: 0.967580
max validation accuracy : 0.980000 max acc epoch : 16 test accuracy : 0.967123
Counter({1: 3864, 0: 3827})

Epoch :  18 loss training:  3.886441506096162 Time :  3865
accuracy train: 0.994345 val: 0.980000 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 16 test accuracy : 0.967123
Counter({0: 3849, 1: 3842})

Epoch :  19 loss training:  3.8647204965236597 Time :  3899
accuracy train: 0.994547 val: 0.972727 test: 0.970320
max validation accuracy : 0.980000 max acc epoch : 16 test accuracy : 0.967123
Counter({0: 3866, 1: 3825})

Epoch :  20 loss training:  3.5203154532937333 Time :  3916
accuracy train: 0.995152 val: 0.981818 test: 0.966210
max validation accuracy : 0.981818 max acc epoch : 20 test accuracy : 0.966210
Counter({0: 3883, 1: 3808})

Epoch :  21 loss training:  3.204669522412587 Time :  3952
accuracy train: 0.995354 val: 0.985455 test: 0.972603
max validation accuracy : 0.985455 max acc epoch : 21 test accuracy : 0.972603
Counter({1: 3883, 0: 3808})

Epoch :  22 loss training:  3.3103939262218773 Time :  3972
accuracy train: 0.995556 val: 0.985455 test: 0.970776
max validation accuracy : 0.985455 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3885, 1: 3806})

Epoch :  23 loss training:  2.9469589474028908 Time :  4003
accuracy train: 0.994547 val: 0.978182 test: 0.970320
max validation accuracy : 0.985455 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3891, 1: 3800})

Epoch :  24 loss training:  2.7536840112006757 Time :  4026
accuracy train: 0.995758 val: 0.981818 test: 0.970776
max validation accuracy : 0.985455 max acc epoch : 21 test accuracy : 0.972603
Counter({1: 3896, 0: 3795})

Epoch :  25 loss training:  2.7854422440286726 Time :  4049
accuracy train: 0.995354 val: 0.983636 test: 0.967580
max validation accuracy : 0.985455 max acc epoch : 21 test accuracy : 0.972603
Counter({1: 3863, 0: 3828})

Epoch :  26 loss training:  2.6129256713902578 Time :  4078
accuracy train: 0.996162 val: 0.981818 test: 0.971233
max validation accuracy : 0.985455 max acc epoch : 21 test accuracy : 0.972603
Counter({1: 3904, 0: 3787})

Epoch :  27 loss training:  2.436396003628033 Time :  4100
accuracy train: 0.995960 val: 0.983636 test: 0.968950
max validation accuracy : 0.985455 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3873, 1: 3818})

Epoch :  28 loss training:  2.4442471894435585 Time :  4133
accuracy train: 0.995960 val: 0.980000 test: 0.968493
max validation accuracy : 0.985455 max acc epoch : 21 test accuracy : 0.972603
Counter({1: 3907, 0: 3784})

Epoch :  29 loss training:  2.096350824518595 Time :  4156
accuracy train: 0.996970 val: 0.981818 test: 0.965753
max validation accuracy : 0.985455 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3874, 1: 3817})

Epoch :  30 loss training:  2.3341740707401186 Time :  4181
accuracy train: 0.996566 val: 0.978182 test: 0.970320
max validation accuracy : 0.985455 max acc epoch : 21 test accuracy : 0.972603
Counter({1: 3868, 0: 3823})

Epoch :  31 loss training:  2.025549822312314 Time :  4212
accuracy train: 0.996364 val: 0.985455 test: 0.970776
max validation accuracy : 0.985455 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3877, 1: 3814})

Epoch :  32 loss training:  2.066549945026054 Time :  4231
accuracy train: 0.996768 val: 0.976364 test: 0.965753
max validation accuracy : 0.985455 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3866, 1: 3825})

========================================================================================================================================================================================================
best acc epoch :  21
validation accuracy :  0.9854545454545455
test accuracy :  0.9726027397260274
last test_accuracy :  0.9657534246575342
second best val :  0.9836363636363636
second best test :  0.9726027397260274
max gap 7
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  14 	 val_accuracy : 0.98182 	 test_accuracy : 0.96941 	 last test_accuracy : 0.97032 	 second best val : 0.98000 	 second best test : 0.96941
k :  1 	 best_acc epoch :  14 	 val_accuracy : 0.98000 	 test_accuracy : 0.97260 	 last test_accuracy : 0.97078 	 second best val : 0.97636 	 second best test : 0.97260
k :  2 	 best_acc epoch :  9 	 val_accuracy : 0.96000 	 test_accuracy : 0.96667 	 last test_accuracy : 0.97078 	 second best val : 0.95818 	 second best test : 0.96667
k :  3 	 best_acc epoch :  16 	 val_accuracy : 0.97636 	 test_accuracy : 0.96256 	 last test_accuracy : 0.96849 	 second best val : 0.97455 	 second best test : 0.96667
k :  4 	 best_acc epoch :  13 	 val_accuracy : 0.97636 	 test_accuracy : 0.96941 	 last test_accuracy : 0.97032 	 second best val : 0.97455 	 second best test : 0.96941
k :  5 	 best_acc epoch :  21 	 val_accuracy : 0.98545 	 test_accuracy : 0.97260 	 last test_accuracy : 0.96575 	 second best val : 0.98364 	 second best test : 0.97260

avg :  	 val_accuracy : 0.97667 	 test_accuracy : 0.96887 	 last_accuracy : 0.96941 	 second best val : 0.97455 	 second best test : 0.96956

std :  	 val_accuracy : 0.00809 	 test_accuracy : 0.00349 	 last_accuracy : 0.00181 	 second best val : 0.00799 	 second best test : 0.00243
