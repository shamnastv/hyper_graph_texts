date and time :  Tue Jan 26 19:47:51 2021
Namespace(batch_size=16, dataset='R52', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=1e-05)
device :  cuda:0
HGNNModel(
  (word_embeddings): Embedding(9333, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=52, bias=True)
    (1): Linear(in_features=200, out_features=52, bias=True)
    (2): Linear(in_features=200, out_features=52, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  301.2142754588276 Time :  12
accuracy train: 0.918869 val: 0.891768 test: 0.885992
max validation accuracy : 0.891768 max acc epoch : 1.000000 test accuracy : 0.885992

Epoch :  2 loss training:  124.34594966424629 Time :  23
accuracy train: 0.948679 val: 0.919207 test: 0.919066
max validation accuracy : 0.919207 max acc epoch : 2.000000 test accuracy : 0.919066

Epoch :  3 loss training:  83.00222464255057 Time :  33
accuracy train: 0.971545 val: 0.942073 test: 0.925681
max validation accuracy : 0.942073 max acc epoch : 3.000000 test accuracy : 0.925681

Epoch :  4 loss training:  65.47486415039748 Time :  42
accuracy train: 0.976626 val: 0.931402 test: 0.933074
max validation accuracy : 0.942073 max acc epoch : 3.000000 test accuracy : 0.925681

Epoch :  5 loss training:  52.940276938141324 Time :  51
accuracy train: 0.983909 val: 0.943598 test: 0.937354
max validation accuracy : 0.943598 max acc epoch : 5.000000 test accuracy : 0.937354

Epoch :  6 loss training:  37.11924837715924 Time :  61
accuracy train: 0.987466 val: 0.951220 test: 0.936965
max validation accuracy : 0.951220 max acc epoch : 6.000000 test accuracy : 0.936965

Epoch :  7 loss training:  28.595934333628975 Time :  70
accuracy train: 0.988991 val: 0.948171 test: 0.941245
max validation accuracy : 0.951220 max acc epoch : 6.000000 test accuracy : 0.936965

Epoch :  8 loss training:  25.633523451077053 Time :  79
accuracy train: 0.991870 val: 0.951220 test: 0.940078
max validation accuracy : 0.951220 max acc epoch : 6.000000 test accuracy : 0.936965

Epoch :  9 loss training:  23.069993735058233 Time :  89
accuracy train: 0.995766 val: 0.948171 test: 0.938521
max validation accuracy : 0.951220 max acc epoch : 6.000000 test accuracy : 0.936965

Epoch :  10 loss training:  24.852008902700618 Time :  100
accuracy train: 0.995766 val: 0.946646 test: 0.941634
max validation accuracy : 0.951220 max acc epoch : 6.000000 test accuracy : 0.936965

Epoch :  11 loss training:  17.39800145936897 Time :  110
accuracy train: 0.995766 val: 0.945122 test: 0.942802
max validation accuracy : 0.951220 max acc epoch : 6.000000 test accuracy : 0.936965

Epoch :  12 loss training:  14.752050845097983 Time :  120
accuracy train: 0.996274 val: 0.945122 test: 0.945525
max validation accuracy : 0.951220 max acc epoch : 6.000000 test accuracy : 0.936965

Epoch :  13 loss training:  12.690500346405315 Time :  129
accuracy train: 0.996951 val: 0.946646 test: 0.940078
max validation accuracy : 0.951220 max acc epoch : 6.000000 test accuracy : 0.936965

Epoch :  14 loss training:  13.215741936379345 Time :  139
accuracy train: 0.996782 val: 0.946646 test: 0.938132
max validation accuracy : 0.951220 max acc epoch : 6.000000 test accuracy : 0.936965

Epoch :  15 loss training:  12.86899619486212 Time :  148
accuracy train: 0.996951 val: 0.939024 test: 0.943191
max validation accuracy : 0.951220 max acc epoch : 6.000000 test accuracy : 0.936965

Epoch :  16 loss training:  10.60711850124062 Time :  158
accuracy train: 0.997967 val: 0.939024 test: 0.944358
max validation accuracy : 0.951220 max acc epoch : 6.000000 test accuracy : 0.936965

Epoch :  17 loss training:  9.443245273636421 Time :  167
accuracy train: 0.997798 val: 0.945122 test: 0.944358
max validation accuracy : 0.951220 max acc epoch : 6.000000 test accuracy : 0.936965

Epoch :  18 loss training:  9.992504188863677 Time :  177
accuracy train: 0.997967 val: 0.945122 test: 0.944747
max validation accuracy : 0.951220 max acc epoch : 6.000000 test accuracy : 0.936965

Epoch :  19 loss training:  9.32342398928813 Time :  185
accuracy train: 0.998137 val: 0.943598 test: 0.945136
max validation accuracy : 0.951220 max acc epoch : 6.000000 test accuracy : 0.936965

Epoch :  20 loss training:  8.441977674301597 Time :  193
accuracy train: 0.997798 val: 0.946646 test: 0.942412
max validation accuracy : 0.951220 max acc epoch : 6.000000 test accuracy : 0.936965

Epoch :  21 loss training:  8.322719944961136 Time :  202
accuracy train: 0.998137 val: 0.945122 test: 0.943191
max validation accuracy : 0.951220 max acc epoch : 6.000000 test accuracy : 0.936965

Epoch :  22 loss training:  8.463349177342025 Time :  211
accuracy train: 0.998137 val: 0.952744 test: 0.947082
max validation accuracy : 0.952744 max acc epoch : 22.000000 test accuracy : 0.947082

Epoch :  23 loss training:  6.508636815284262 Time :  219
accuracy train: 0.998137 val: 0.949695 test: 0.941245
max validation accuracy : 0.952744 max acc epoch : 22.000000 test accuracy : 0.947082

Epoch :  24 loss training:  7.244874250503926 Time :  228
accuracy train: 0.998137 val: 0.942073 test: 0.942802
max validation accuracy : 0.952744 max acc epoch : 22.000000 test accuracy : 0.947082

Epoch :  25 loss training:  6.906477253047342 Time :  236
accuracy train: 0.998137 val: 0.949695 test: 0.943969
max validation accuracy : 0.952744 max acc epoch : 22.000000 test accuracy : 0.947082

Epoch :  26 loss training:  6.243659859574109 Time :  245
accuracy train: 0.998137 val: 0.949695 test: 0.944358
max validation accuracy : 0.952744 max acc epoch : 22.000000 test accuracy : 0.947082

Epoch :  27 loss training:  5.96162154286867 Time :  254
accuracy train: 0.998137 val: 0.951220 test: 0.945136
max validation accuracy : 0.952744 max acc epoch : 22.000000 test accuracy : 0.947082

Epoch :  28 loss training:  5.745010914940394 Time :  261
accuracy train: 0.998137 val: 0.951220 test: 0.945914
max validation accuracy : 0.952744 max acc epoch : 22.000000 test accuracy : 0.947082

Epoch :  29 loss training:  6.313785376114538 Time :  267
accuracy train: 0.998137 val: 0.954268 test: 0.945914
max validation accuracy : 0.954268 max acc epoch : 29.000000 test accuracy : 0.945914

Epoch :  30 loss training:  6.118769210712344 Time :  274
accuracy train: 0.998306 val: 0.948171 test: 0.945914
max validation accuracy : 0.954268 max acc epoch : 29.000000 test accuracy : 0.945914

Epoch :  31 loss training:  6.012900072379125 Time :  282
accuracy train: 0.998306 val: 0.949695 test: 0.946304
max validation accuracy : 0.954268 max acc epoch : 29.000000 test accuracy : 0.945914

Epoch :  32 loss training:  5.902744262071792 Time :  290
accuracy train: 0.998306 val: 0.948171 test: 0.947082
max validation accuracy : 0.954268 max acc epoch : 29.000000 test accuracy : 0.945914

Epoch :  33 loss training:  6.4807787792160525 Time :  347
accuracy train: 0.998306 val: 0.949695 test: 0.944358
max validation accuracy : 0.954268 max acc epoch : 29.000000 test accuracy : 0.945914

Epoch :  34 loss training:  5.525268994078942 Time :  385
accuracy train: 0.998306 val: 0.949695 test: 0.943580
max validation accuracy : 0.954268 max acc epoch : 29.000000 test accuracy : 0.945914

Epoch :  35 loss training:  6.318414142171605 Time :  395
accuracy train: 0.998476 val: 0.952744 test: 0.943969
max validation accuracy : 0.954268 max acc epoch : 29.000000 test accuracy : 0.945914

Epoch :  36 loss training:  5.828691284863453 Time :  404
accuracy train: 0.998306 val: 0.949695 test: 0.945525
max validation accuracy : 0.954268 max acc epoch : 29.000000 test accuracy : 0.945914

Epoch :  37 loss training:  5.929777841178293 Time :  415
accuracy train: 0.998306 val: 0.951220 test: 0.945914
max validation accuracy : 0.954268 max acc epoch : 29.000000 test accuracy : 0.945914

Epoch :  38 loss training:  5.154097296850523 Time :  427
accuracy train: 0.998306 val: 0.951220 test: 0.945136
max validation accuracy : 0.954268 max acc epoch : 29.000000 test accuracy : 0.945914

Epoch :  39 loss training:  5.932360835657164 Time :  437
accuracy train: 0.998137 val: 0.952744 test: 0.946304
max validation accuracy : 0.954268 max acc epoch : 29.000000 test accuracy : 0.945914

Epoch :  40 loss training:  5.93261744055053 Time :  449
accuracy train: 0.998306 val: 0.952744 test: 0.946693
max validation accuracy : 0.954268 max acc epoch : 29.000000 test accuracy : 0.945914

Epoch :  41 loss training:  5.5226094509416725 Time :  460
accuracy train: 0.998476 val: 0.951220 test: 0.947082
max validation accuracy : 0.954268 max acc epoch : 29.000000 test accuracy : 0.945914

Epoch :  42 loss training:  5.458280900835234 Time :  470
accuracy train: 0.998306 val: 0.952744 test: 0.943969
max validation accuracy : 0.954268 max acc epoch : 29.000000 test accuracy : 0.945914

Epoch :  43 loss training:  5.818137338166025 Time :  481
accuracy train: 0.998137 val: 0.951220 test: 0.945136
max validation accuracy : 0.954268 max acc epoch : 29.000000 test accuracy : 0.945914

Epoch :  44 loss training:  5.170681479376071 Time :  492
accuracy train: 0.998306 val: 0.952744 test: 0.943969
max validation accuracy : 0.954268 max acc epoch : 29.000000 test accuracy : 0.945914

Epoch :  45 loss training:  5.510462917187397 Time :  503
accuracy train: 0.998306 val: 0.954268 test: 0.945136
max validation accuracy : 0.954268 max acc epoch : 29.000000 test accuracy : 0.945914

Epoch :  46 loss training:  6.808271129477362 Time :  514
accuracy train: 0.998137 val: 0.952744 test: 0.945136
max validation accuracy : 0.954268 max acc epoch : 29.000000 test accuracy : 0.945914

Epoch :  47 loss training:  5.208167238321039 Time :  526
accuracy train: 0.998137 val: 0.952744 test: 0.943580
max validation accuracy : 0.954268 max acc epoch : 29.000000 test accuracy : 0.945914

Epoch :  48 loss training:  5.771484883871381 Time :  537
accuracy train: 0.998306 val: 0.952744 test: 0.945914
max validation accuracy : 0.954268 max acc epoch : 29.000000 test accuracy : 0.945914

Epoch :  49 loss training:  5.486131736950483 Time :  548
accuracy train: 0.998306 val: 0.951220 test: 0.944747
max validation accuracy : 0.954268 max acc epoch : 29.000000 test accuracy : 0.945914

Epoch :  50 loss training:  5.988342037864641 Time :  559
accuracy train: 0.998306 val: 0.951220 test: 0.943969
max validation accuracy : 0.954268 max acc epoch : 29.000000 test accuracy : 0.945914

========================================================================================================================================================================================================
max acc epoch :  29
max validation accuracy :  0.9542682926829268
test accuracy :  0.9459143968871595
latest_test_accuracy :  0.9439688715953307
========================================================================================================================================================================================================

