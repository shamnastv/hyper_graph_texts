

date and time :  Fri Jun 18 20:28:27 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.5, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=722, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  51.76766254007816 Time :  11
accuracy train: 0.952524 val: 0.955152 test: 0.957991
max validation accuracy : 0.955152 max acc epoch : 1 test accuracy : 0.957991
Epoch-1 lr: 0.001

Epoch :  2 loss training:  21.674342723563313 Time :  22
accuracy train: 0.957442 val: 0.956364 test: 0.955708
max validation accuracy : 0.956364 max acc epoch : 2 test accuracy : 0.955708
Epoch-2 lr: 0.001

Epoch :  3 loss training:  19.411697522737086 Time :  33
accuracy train: 0.976048 val: 0.973333 test: 0.962557
max validation accuracy : 0.973333 max acc epoch : 3 test accuracy : 0.962557
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  15.167864787392318 Time :  46
accuracy train: 0.979683 val: 0.963636 test: 0.962557
max validation accuracy : 0.973333 max acc epoch : 3 test accuracy : 0.962557
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  15.090024855919182 Time :  58
accuracy train: 0.984388 val: 0.968485 test: 0.966667
max validation accuracy : 0.973333 max acc epoch : 3 test accuracy : 0.962557
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  13.05996824754402 Time :  70
accuracy train: 0.978400 val: 0.966061 test: 0.962557
max validation accuracy : 0.973333 max acc epoch : 3 test accuracy : 0.962557
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  11.36297466326505 Time :  81
accuracy train: 0.984388 val: 0.964848 test: 0.959361
max validation accuracy : 0.973333 max acc epoch : 3 test accuracy : 0.962557
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  11.356188777834177 Time :  92
accuracy train: 0.986527 val: 0.968485 test: 0.963927
max validation accuracy : 0.973333 max acc epoch : 3 test accuracy : 0.962557
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  9.528057459363481 Time :  103
accuracy train: 0.986527 val: 0.968485 test: 0.964840
max validation accuracy : 0.973333 max acc epoch : 3 test accuracy : 0.962557
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  9.492813937133178 Time :  114
accuracy train: 0.987596 val: 0.968485 test: 0.964384
max validation accuracy : 0.973333 max acc epoch : 3 test accuracy : 0.962557

Epoch :  11 loss training:  9.645547141786665 Time :  126
accuracy train: 0.988452 val: 0.973333 test: 0.965753
max validation accuracy : 0.973333 max acc epoch : 3 test accuracy : 0.962557

Epoch :  12 loss training:  8.102236634353176 Time :  138
accuracy train: 0.988879 val: 0.974545 test: 0.964384
max validation accuracy : 0.974545 max acc epoch : 12 test accuracy : 0.964384

Epoch :  13 loss training:  7.674766749609262 Time :  149
accuracy train: 0.990163 val: 0.970909 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 12 test accuracy : 0.964384

Epoch :  14 loss training:  8.290198251837865 Time :  162
accuracy train: 0.991873 val: 0.973333 test: 0.965753
max validation accuracy : 0.974545 max acc epoch : 12 test accuracy : 0.964384

Epoch :  15 loss training:  7.687193360645324 Time :  176
accuracy train: 0.992087 val: 0.973333 test: 0.964840
max validation accuracy : 0.974545 max acc epoch : 12 test accuracy : 0.964384

Epoch :  16 loss training:  7.335183327551931 Time :  187
accuracy train: 0.993157 val: 0.972121 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 12 test accuracy : 0.964384

Epoch :  17 loss training:  6.4575671155471355 Time :  200
accuracy train: 0.993584 val: 0.973333 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 12 test accuracy : 0.964384

Epoch :  18 loss training:  6.754642189000151 Time :  212
accuracy train: 0.994226 val: 0.973333 test: 0.967123
max validation accuracy : 0.974545 max acc epoch : 12 test accuracy : 0.964384

Epoch :  19 loss training:  6.210303312167525 Time :  224
accuracy train: 0.994226 val: 0.973333 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 12 test accuracy : 0.964384

Epoch :  20 loss training:  6.454458527034149 Time :  236
accuracy train: 0.993798 val: 0.972121 test: 0.965753
max validation accuracy : 0.974545 max acc epoch : 12 test accuracy : 0.964384

Epoch :  21 loss training:  5.821700687287375 Time :  248
accuracy train: 0.994226 val: 0.969697 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 12 test accuracy : 0.964384

Epoch :  22 loss training:  6.444393313024193 Time :  261
accuracy train: 0.994012 val: 0.972121 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 12 test accuracy : 0.964384

Epoch :  23 loss training:  5.948634056607261 Time :  272
accuracy train: 0.994654 val: 0.973333 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 12 test accuracy : 0.964384

Epoch :  24 loss training:  8.520058513211552 Time :  284
accuracy train: 0.995081 val: 0.973333 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 12 test accuracy : 0.964384

Epoch :  25 loss training:  6.1260012310231104 Time :  297
accuracy train: 0.994654 val: 0.975758 test: 0.970320
max validation accuracy : 0.975758 max acc epoch : 25 test accuracy : 0.970320

Epoch :  26 loss training:  4.960251952754334 Time :  308
accuracy train: 0.994440 val: 0.972121 test: 0.968950
max validation accuracy : 0.975758 max acc epoch : 25 test accuracy : 0.970320

Epoch :  27 loss training:  5.02400045550894 Time :  319
accuracy train: 0.995509 val: 0.972121 test: 0.969863
max validation accuracy : 0.975758 max acc epoch : 25 test accuracy : 0.970320

Epoch :  28 loss training:  4.799755809362978 Time :  331
accuracy train: 0.994867 val: 0.975758 test: 0.969406
max validation accuracy : 0.975758 max acc epoch : 25 test accuracy : 0.970320

Epoch :  29 loss training:  4.413197149988264 Time :  341
accuracy train: 0.995723 val: 0.973333 test: 0.967123
max validation accuracy : 0.975758 max acc epoch : 25 test accuracy : 0.970320

Epoch :  30 loss training:  4.652222219505347 Time :  353
accuracy train: 0.994654 val: 0.974545 test: 0.969406
max validation accuracy : 0.975758 max acc epoch : 25 test accuracy : 0.970320

Epoch :  31 loss training:  4.076196362730116 Time :  364
accuracy train: 0.995509 val: 0.973333 test: 0.970320
max validation accuracy : 0.975758 max acc epoch : 25 test accuracy : 0.970320

Epoch :  32 loss training:  4.709957122337073 Time :  375
accuracy train: 0.995937 val: 0.975758 test: 0.969863
max validation accuracy : 0.975758 max acc epoch : 25 test accuracy : 0.970320

Epoch :  33 loss training:  4.610643982072361 Time :  386
accuracy train: 0.995295 val: 0.974545 test: 0.968037
max validation accuracy : 0.975758 max acc epoch : 25 test accuracy : 0.970320

Epoch :  34 loss training:  4.513035069743637 Time :  400
accuracy train: 0.995723 val: 0.972121 test: 0.969863
max validation accuracy : 0.975758 max acc epoch : 25 test accuracy : 0.970320

Epoch :  35 loss training:  3.824045643908903 Time :  411
accuracy train: 0.995723 val: 0.972121 test: 0.969863
max validation accuracy : 0.975758 max acc epoch : 25 test accuracy : 0.970320

Epoch :  36 loss training:  4.108341110404581 Time :  423
accuracy train: 0.995295 val: 0.974545 test: 0.968493
max validation accuracy : 0.975758 max acc epoch : 25 test accuracy : 0.970320

Epoch :  37 loss training:  4.0318739945068955 Time :  435
accuracy train: 0.995723 val: 0.976970 test: 0.969863
max validation accuracy : 0.976970 max acc epoch : 37 test accuracy : 0.969863

Epoch :  38 loss training:  3.800569042970892 Time :  446
accuracy train: 0.995937 val: 0.973333 test: 0.967123
max validation accuracy : 0.976970 max acc epoch : 37 test accuracy : 0.969863

Epoch :  39 loss training:  3.397368322534021 Time :  458
accuracy train: 0.995937 val: 0.975758 test: 0.968950
max validation accuracy : 0.976970 max acc epoch : 37 test accuracy : 0.969863

Epoch :  40 loss training:  3.594143506663386 Time :  469
accuracy train: 0.995937 val: 0.974545 test: 0.968037
max validation accuracy : 0.976970 max acc epoch : 37 test accuracy : 0.969863

Epoch :  41 loss training:  3.6615646277205087 Time :  480
accuracy train: 0.995937 val: 0.970909 test: 0.970776
max validation accuracy : 0.976970 max acc epoch : 37 test accuracy : 0.969863

Epoch :  42 loss training:  2.8377707882900722 Time :  490
accuracy train: 0.995937 val: 0.972121 test: 0.967123
max validation accuracy : 0.976970 max acc epoch : 37 test accuracy : 0.969863

Epoch :  43 loss training:  3.0377896660356782 Time :  504
accuracy train: 0.995937 val: 0.975758 test: 0.969406
max validation accuracy : 0.976970 max acc epoch : 37 test accuracy : 0.969863

Epoch :  44 loss training:  3.3222924775327556 Time :  516
accuracy train: 0.996151 val: 0.974545 test: 0.968037
max validation accuracy : 0.976970 max acc epoch : 37 test accuracy : 0.969863

Epoch :  45 loss training:  3.345534121093806 Time :  527
accuracy train: 0.995937 val: 0.970909 test: 0.970776
max validation accuracy : 0.976970 max acc epoch : 37 test accuracy : 0.969863

Epoch :  46 loss training:  3.0633178694697563 Time :  539
accuracy train: 0.995937 val: 0.973333 test: 0.968950
max validation accuracy : 0.976970 max acc epoch : 37 test accuracy : 0.969863

Epoch :  47 loss training:  3.281316667300416 Time :  550
accuracy train: 0.996364 val: 0.972121 test: 0.967123
max validation accuracy : 0.976970 max acc epoch : 37 test accuracy : 0.969863

Epoch :  48 loss training:  2.8440650708507746 Time :  561
accuracy train: 0.995509 val: 0.969697 test: 0.966210
max validation accuracy : 0.976970 max acc epoch : 37 test accuracy : 0.969863

Epoch :  49 loss training:  2.614405875239754 Time :  573
accuracy train: 0.995937 val: 0.973333 test: 0.965753
max validation accuracy : 0.976970 max acc epoch : 37 test accuracy : 0.969863

Epoch :  50 loss training:  2.634353718807688 Time :  584
accuracy train: 0.996578 val: 0.973333 test: 0.969406
max validation accuracy : 0.976970 max acc epoch : 37 test accuracy : 0.969863

Epoch :  51 loss training:  2.6999149738403503 Time :  594
accuracy train: 0.996364 val: 0.973333 test: 0.968950
max validation accuracy : 0.976970 max acc epoch : 37 test accuracy : 0.969863

Epoch :  52 loss training:  2.730222464859253 Time :  607
accuracy train: 0.996364 val: 0.975758 test: 0.968950
max validation accuracy : 0.976970 max acc epoch : 37 test accuracy : 0.969863

Epoch :  53 loss training:  2.6750347900378983 Time :  618
accuracy train: 0.996364 val: 0.976970 test: 0.970320
max validation accuracy : 0.976970 max acc epoch : 37 test accuracy : 0.969863

Epoch :  54 loss training:  2.446741629508324 Time :  629
accuracy train: 0.996364 val: 0.976970 test: 0.968493
max validation accuracy : 0.976970 max acc epoch : 37 test accuracy : 0.969863

Epoch :  55 loss training:  2.3691253864963073 Time :  640
accuracy train: 0.996578 val: 0.978182 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  56 loss training:  2.300521348384791 Time :  650
accuracy train: 0.996364 val: 0.975758 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  57 loss training:  2.496552166514448 Time :  661
accuracy train: 0.996792 val: 0.975758 test: 0.967123
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  58 loss training:  2.335239962063497 Time :  672
accuracy train: 0.997006 val: 0.975758 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  59 loss training:  2.750794928477262 Time :  682
accuracy train: 0.997006 val: 0.975758 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  60 loss training:  2.3278586624655873 Time :  693
accuracy train: 0.996578 val: 0.975758 test: 0.965753
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  61 loss training:  2.438136731632767 Time :  705
accuracy train: 0.996364 val: 0.974545 test: 0.966210
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  62 loss training:  2.4343879416119307 Time :  717
accuracy train: 0.996578 val: 0.975758 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  63 loss training:  2.02362669770082 Time :  727
accuracy train: 0.997006 val: 0.976970 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  64 loss training:  1.9304673418373568 Time :  738
accuracy train: 0.996578 val: 0.976970 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  65 loss training:  2.401161860310822 Time :  748
accuracy train: 0.997434 val: 0.975758 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  66 loss training:  1.7839257640735013 Time :  759
accuracy train: 0.997006 val: 0.974545 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  67 loss training:  2.3961016341636423 Time :  770
accuracy train: 0.997006 val: 0.975758 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  68 loss training:  1.838765249325661 Time :  780
accuracy train: 0.997006 val: 0.976970 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  69 loss training:  2.2743287090561353 Time :  791
accuracy train: 0.997006 val: 0.973333 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  70 loss training:  2.22392706003302 Time :  802
accuracy train: 0.997006 val: 0.974545 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  71 loss training:  2.27067292661377 Time :  814
accuracy train: 0.997006 val: 0.975758 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  72 loss training:  2.2281385957321618 Time :  825
accuracy train: 0.996792 val: 0.975758 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  73 loss training:  2.247029354533879 Time :  836
accuracy train: 0.997006 val: 0.974545 test: 0.967123
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  74 loss training:  2.244585592783551 Time :  847
accuracy train: 0.997006 val: 0.974545 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  75 loss training:  1.6745270226383582 Time :  858
accuracy train: 0.997006 val: 0.973333 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  76 loss training:  1.9902495258647832 Time :  868
accuracy train: 0.996792 val: 0.973333 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  77 loss training:  1.7184955020638881 Time :  879
accuracy train: 0.996578 val: 0.974545 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  78 loss training:  1.5900364405788423 Time :  889
accuracy train: 0.996792 val: 0.973333 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  79 loss training:  1.7636436786633567 Time :  900
accuracy train: 0.996792 val: 0.973333 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  80 loss training:  1.8926089982123813 Time :  912
accuracy train: 0.997006 val: 0.974545 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  81 loss training:  2.0017458471520513 Time :  925
accuracy train: 0.996578 val: 0.970909 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  82 loss training:  1.942151380899304 Time :  936
accuracy train: 0.997006 val: 0.974545 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  83 loss training:  1.8753550853616616 Time :  946
accuracy train: 0.997006 val: 0.972121 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  84 loss training:  1.4996382447934593 Time :  957
accuracy train: 0.997006 val: 0.970909 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  85 loss training:  1.5213109037649701 Time :  969
accuracy train: 0.996792 val: 0.974545 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

Epoch :  86 loss training:  2.335571547790096 Time :  980
accuracy train: 0.996792 val: 0.973333 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 55 test accuracy : 0.968493

========================================================================================================================================================================================================
best acc epoch :  55
validation accuracy :  0.9781818181818182
test accuracy :  0.9684931506849315
last test_accuracy :  0.971689497716895
second best val :  0.9769696969696969
second best test :  0.9698630136986301
max gap 18
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.5, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=198, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  48.35308978706598 Time :  992
accuracy train: 0.949530 val: 0.934545 test: 0.956621
max validation accuracy : 0.934545 max acc epoch : 1 test accuracy : 0.956621
Epoch-1 lr: 0.001

Epoch :  2 loss training:  20.83701174519956 Time :  1001
accuracy train: 0.965355 val: 0.950303 test: 0.960731
max validation accuracy : 0.950303 max acc epoch : 2 test accuracy : 0.960731
Epoch-2 lr: 0.001

Epoch :  3 loss training:  18.00323090609163 Time :  1011
accuracy train: 0.979470 val: 0.960000 test: 0.968950
max validation accuracy : 0.960000 max acc epoch : 3 test accuracy : 0.968950
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  13.966159442439675 Time :  1023
accuracy train: 0.979042 val: 0.960000 test: 0.964840
max validation accuracy : 0.960000 max acc epoch : 3 test accuracy : 0.968950
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  13.83206220716238 Time :  1033
accuracy train: 0.976476 val: 0.957576 test: 0.969863
max validation accuracy : 0.960000 max acc epoch : 3 test accuracy : 0.968950
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  13.455377676524222 Time :  1043
accuracy train: 0.983961 val: 0.957576 test: 0.968037
max validation accuracy : 0.960000 max acc epoch : 3 test accuracy : 0.968950
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  10.701498891692609 Time :  1053
accuracy train: 0.985244 val: 0.960000 test: 0.970320
max validation accuracy : 0.960000 max acc epoch : 3 test accuracy : 0.968950
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  10.643237175187096 Time :  1062
accuracy train: 0.988452 val: 0.961212 test: 0.968950
max validation accuracy : 0.961212 max acc epoch : 8 test accuracy : 0.968950
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  10.269233691971749 Time :  1072
accuracy train: 0.988666 val: 0.961212 test: 0.970776
max validation accuracy : 0.961212 max acc epoch : 8 test accuracy : 0.968950
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  9.370782364625484 Time :  1082
accuracy train: 0.988666 val: 0.967273 test: 0.970320
max validation accuracy : 0.967273 max acc epoch : 10 test accuracy : 0.970320

Epoch :  11 loss training:  9.420292392838746 Time :  1094
accuracy train: 0.988452 val: 0.967273 test: 0.972603
max validation accuracy : 0.967273 max acc epoch : 10 test accuracy : 0.970320

Epoch :  12 loss training:  8.281972627155483 Time :  1104
accuracy train: 0.988879 val: 0.966061 test: 0.974429
max validation accuracy : 0.967273 max acc epoch : 10 test accuracy : 0.970320

Epoch :  13 loss training:  8.084902931936085 Time :  1115
accuracy train: 0.990804 val: 0.966061 test: 0.976712
max validation accuracy : 0.967273 max acc epoch : 10 test accuracy : 0.970320

Epoch :  14 loss training:  7.771289781900123 Time :  1129
accuracy train: 0.991660 val: 0.966061 test: 0.973973
max validation accuracy : 0.967273 max acc epoch : 10 test accuracy : 0.970320

Epoch :  15 loss training:  7.535512320464477 Time :  1140
accuracy train: 0.990804 val: 0.966061 test: 0.974886
max validation accuracy : 0.967273 max acc epoch : 10 test accuracy : 0.970320

Epoch :  16 loss training:  6.915388277033344 Time :  1151
accuracy train: 0.992087 val: 0.968485 test: 0.974429
max validation accuracy : 0.968485 max acc epoch : 16 test accuracy : 0.974429

Epoch :  17 loss training:  6.515858647340792 Time :  1163
accuracy train: 0.992943 val: 0.969697 test: 0.973516
max validation accuracy : 0.969697 max acc epoch : 17 test accuracy : 0.973516

Epoch :  18 loss training:  6.905669645871967 Time :  1175
accuracy train: 0.994440 val: 0.968485 test: 0.971689
max validation accuracy : 0.969697 max acc epoch : 17 test accuracy : 0.973516

Epoch :  19 loss training:  6.789344632299617 Time :  1186
accuracy train: 0.993584 val: 0.969697 test: 0.974886
max validation accuracy : 0.969697 max acc epoch : 17 test accuracy : 0.973516

Epoch :  20 loss training:  7.4426039510872215 Time :  1197
accuracy train: 0.994654 val: 0.970909 test: 0.975342
max validation accuracy : 0.970909 max acc epoch : 20 test accuracy : 0.975342

Epoch :  21 loss training:  5.9881877629086375 Time :  1208
accuracy train: 0.994654 val: 0.972121 test: 0.973516
max validation accuracy : 0.972121 max acc epoch : 21 test accuracy : 0.973516

Epoch :  22 loss training:  6.096362777403556 Time :  1220
accuracy train: 0.995509 val: 0.970909 test: 0.969863
max validation accuracy : 0.972121 max acc epoch : 21 test accuracy : 0.973516

Epoch :  23 loss training:  5.882382228039205 Time :  1233
accuracy train: 0.995509 val: 0.967273 test: 0.971233
max validation accuracy : 0.972121 max acc epoch : 21 test accuracy : 0.973516

Epoch :  24 loss training:  5.204874037823174 Time :  1244
accuracy train: 0.995937 val: 0.972121 test: 0.971233
max validation accuracy : 0.972121 max acc epoch : 21 test accuracy : 0.973516

Epoch :  25 loss training:  6.050913305371068 Time :  1255
accuracy train: 0.996151 val: 0.970909 test: 0.972146
max validation accuracy : 0.972121 max acc epoch : 21 test accuracy : 0.973516

Epoch :  26 loss training:  5.084521519718692 Time :  1268
accuracy train: 0.995937 val: 0.970909 test: 0.973973
max validation accuracy : 0.972121 max acc epoch : 21 test accuracy : 0.973516

Epoch :  27 loss training:  4.724284213327337 Time :  1280
accuracy train: 0.996578 val: 0.969697 test: 0.969406
max validation accuracy : 0.972121 max acc epoch : 21 test accuracy : 0.973516

Epoch :  28 loss training:  4.074442407931201 Time :  1291
accuracy train: 0.996151 val: 0.970909 test: 0.973059
max validation accuracy : 0.972121 max acc epoch : 21 test accuracy : 0.973516

Epoch :  29 loss training:  4.295022708363831 Time :  1303
accuracy train: 0.996578 val: 0.970909 test: 0.970320
max validation accuracy : 0.972121 max acc epoch : 21 test accuracy : 0.973516

Epoch :  30 loss training:  4.478827010956593 Time :  1313
accuracy train: 0.996364 val: 0.967273 test: 0.973516
max validation accuracy : 0.972121 max acc epoch : 21 test accuracy : 0.973516

Epoch :  31 loss training:  4.082001414499246 Time :  1325
accuracy train: 0.996364 val: 0.970909 test: 0.974429
max validation accuracy : 0.972121 max acc epoch : 21 test accuracy : 0.973516

Epoch :  32 loss training:  4.012006836477667 Time :  1339
accuracy train: 0.996364 val: 0.969697 test: 0.972146
max validation accuracy : 0.972121 max acc epoch : 21 test accuracy : 0.973516

Epoch :  33 loss training:  3.983029726194218 Time :  1350
accuracy train: 0.996578 val: 0.973333 test: 0.973516
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  34 loss training:  3.814362355740741 Time :  1362
accuracy train: 0.996578 val: 0.973333 test: 0.972603
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  35 loss training:  3.8281597858294845 Time :  1373
accuracy train: 0.996578 val: 0.972121 test: 0.971689
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  36 loss training:  3.585633652488468 Time :  1386
accuracy train: 0.996578 val: 0.972121 test: 0.972146
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  37 loss training:  3.6701110652647913 Time :  1398
accuracy train: 0.997006 val: 0.972121 test: 0.973516
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  38 loss training:  3.3908935768413357 Time :  1410
accuracy train: 0.997006 val: 0.972121 test: 0.973516
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  39 loss training:  2.6977104833058547 Time :  1422
accuracy train: 0.996792 val: 0.970909 test: 0.972603
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  40 loss training:  2.958278635109309 Time :  1436
accuracy train: 0.997220 val: 0.968485 test: 0.973973
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  41 loss training:  3.1163556181127205 Time :  1449
accuracy train: 0.996792 val: 0.970909 test: 0.972603
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  42 loss training:  3.3475529350689612 Time :  1460
accuracy train: 0.997006 val: 0.969697 test: 0.971689
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  43 loss training:  3.033107853902038 Time :  1471
accuracy train: 0.997006 val: 0.972121 test: 0.975342
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  44 loss training:  2.7308439623448066 Time :  1482
accuracy train: 0.997006 val: 0.970909 test: 0.975342
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  45 loss training:  3.116820612864103 Time :  1493
accuracy train: 0.997648 val: 0.972121 test: 0.973973
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  46 loss training:  2.7403849383699708 Time :  1506
accuracy train: 0.997220 val: 0.970909 test: 0.972603
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  47 loss training:  2.6507766801369144 Time :  1518
accuracy train: 0.997434 val: 0.970909 test: 0.976256
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  48 loss training:  2.4717788381967694 Time :  1531
accuracy train: 0.997220 val: 0.972121 test: 0.973516
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  49 loss training:  2.633740599223529 Time :  1543
accuracy train: 0.997648 val: 0.970909 test: 0.972603
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  50 loss training:  2.7191526333335787 Time :  1553
accuracy train: 0.997861 val: 0.967273 test: 0.970776
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  51 loss training:  2.192781375182676 Time :  1565
accuracy train: 0.997648 val: 0.970909 test: 0.973973
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  52 loss training:  2.2647165770613356 Time :  1576
accuracy train: 0.997861 val: 0.970909 test: 0.972146
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  53 loss training:  2.178646352396754 Time :  1588
accuracy train: 0.997648 val: 0.972121 test: 0.974429
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  54 loss training:  2.101631184701546 Time :  1599
accuracy train: 0.997648 val: 0.968485 test: 0.975342
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  55 loss training:  2.422535341240291 Time :  1610
accuracy train: 0.998075 val: 0.970909 test: 0.975342
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  56 loss training:  2.062119813315803 Time :  1621
accuracy train: 0.997434 val: 0.968485 test: 0.970776
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  57 loss training:  2.4561802825919585 Time :  1634
accuracy train: 0.997648 val: 0.969697 test: 0.972146
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  58 loss training:  2.372143217631674 Time :  1646
accuracy train: 0.997648 val: 0.969697 test: 0.972603
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  59 loss training:  2.172632689587772 Time :  1658
accuracy train: 0.997648 val: 0.969697 test: 0.975342
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  60 loss training:  2.171387929818593 Time :  1669
accuracy train: 0.997861 val: 0.972121 test: 0.977169
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  61 loss training:  2.0708296068987693 Time :  1681
accuracy train: 0.997648 val: 0.970909 test: 0.973973
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  62 loss training:  2.2235210302169435 Time :  1693
accuracy train: 0.997648 val: 0.972121 test: 0.976256
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  63 loss training:  2.151022332793218 Time :  1704
accuracy train: 0.997648 val: 0.972121 test: 0.976256
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

Epoch :  64 loss training:  2.1175949939060956 Time :  1716
accuracy train: 0.997648 val: 0.968485 test: 0.972603
max validation accuracy : 0.973333 max acc epoch : 33 test accuracy : 0.973516

========================================================================================================================================================================================================
best acc epoch :  33
validation accuracy :  0.9733333333333334
test accuracy :  0.9735159817351599
last test_accuracy :  0.9726027397260274
second best val :  0.9721212121212122
second best test :  0.9735159817351599
max gap 12
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  55 	 val_accuracy : 0.97818 	 test_accuracy : 0.96849 	 last test_accuracy : 0.97169 	 second best val : 0.97697 	 second best test : 0.96986
k :  1 	 best_acc epoch :  33 	 val_accuracy : 0.97333 	 test_accuracy : 0.97352 	 last test_accuracy : 0.97260 	 second best val : 0.97212 	 second best test : 0.97352

avg :  	 val_accuracy : 0.97576 	 test_accuracy : 0.97100 	 last_accuracy : 0.97215 	 second best val : 0.97455 	 second best test : 0.97169

std :  	 val_accuracy : 0.00242 	 test_accuracy : 0.00251 	 last_accuracy : 0.00046 	 second best val : 0.00242 	 second best test : 0.00183


date and time :  Fri Jun 18 20:57:13 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.5, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=313, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  50.639861203730106 Time :  15
accuracy train: 0.943755 val: 0.936970 test: 0.952511
max validation accuracy : 0.936970 max acc epoch : 1 test accuracy : 0.952511
Epoch-1 lr: 0.001

Epoch :  2 loss training:  23.241320449858904 Time :  28
accuracy train: 0.967494 val: 0.957576 test: 0.954795
max validation accuracy : 0.957576 max acc epoch : 2 test accuracy : 0.954795
Epoch-2 lr: 0.001

Epoch :  3 loss training:  18.626560412347317 Time :  42
accuracy train: 0.969204 val: 0.967273 test: 0.960731
max validation accuracy : 0.967273 max acc epoch : 3 test accuracy : 0.960731
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  14.541833357419819 Time :  55
accuracy train: 0.978400 val: 0.962424 test: 0.961644
max validation accuracy : 0.967273 max acc epoch : 3 test accuracy : 0.960731
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  13.980828654952347 Time :  69
accuracy train: 0.977117 val: 0.970909 test: 0.968950
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.968950
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  14.025719002820551 Time :  82
accuracy train: 0.982464 val: 0.974545 test: 0.962557
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.962557
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  11.393837335985154 Time :  95
accuracy train: 0.982678 val: 0.972121 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.962557
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  10.237381543964148 Time :  109
accuracy train: 0.982464 val: 0.968485 test: 0.967123
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.962557
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  10.749739336315542 Time :  123
accuracy train: 0.981822 val: 0.974545 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.962557
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  9.148645888548344 Time :  135
accuracy train: 0.986741 val: 0.974545 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.962557

Epoch :  11 loss training:  8.59527193964459 Time :  148
accuracy train: 0.987169 val: 0.975758 test: 0.970320
max validation accuracy : 0.975758 max acc epoch : 11 test accuracy : 0.970320

Epoch :  12 loss training:  9.282851259224117 Time :  161
accuracy train: 0.989735 val: 0.975758 test: 0.967580
max validation accuracy : 0.975758 max acc epoch : 11 test accuracy : 0.970320

Epoch :  13 loss training:  8.997706026770175 Time :  174
accuracy train: 0.989093 val: 0.978182 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.969406

Epoch :  14 loss training:  8.73878498421982 Time :  187
accuracy train: 0.990376 val: 0.976970 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.969406

Epoch :  15 loss training:  8.645270925015211 Time :  200
accuracy train: 0.989093 val: 0.973333 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.969406

Epoch :  16 loss training:  7.57871573464945 Time :  216
accuracy train: 0.991018 val: 0.975758 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.969406

Epoch :  17 loss training:  7.753085717791691 Time :  229
accuracy train: 0.991660 val: 0.975758 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.969406

Epoch :  18 loss training:  6.8555953714530915 Time :  242
accuracy train: 0.991446 val: 0.976970 test: 0.965753
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.969406

Epoch :  19 loss training:  6.769431710243225 Time :  254
accuracy train: 0.992301 val: 0.979394 test: 0.971233
max validation accuracy : 0.979394 max acc epoch : 19 test accuracy : 0.971233

Epoch :  20 loss training:  6.407655637478456 Time :  269
accuracy train: 0.992943 val: 0.978182 test: 0.971689
max validation accuracy : 0.979394 max acc epoch : 19 test accuracy : 0.971233

Epoch :  21 loss training:  6.151400544447824 Time :  282
accuracy train: 0.992729 val: 0.978182 test: 0.974886
max validation accuracy : 0.979394 max acc epoch : 19 test accuracy : 0.971233

Epoch :  22 loss training:  5.493845971534029 Time :  296
accuracy train: 0.993370 val: 0.980606 test: 0.975342
max validation accuracy : 0.980606 max acc epoch : 22 test accuracy : 0.975342

Epoch :  23 loss training:  7.122016335371882 Time :  309
accuracy train: 0.994226 val: 0.981818 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.971689

Epoch :  24 loss training:  5.952613522764295 Time :  324
accuracy train: 0.993798 val: 0.978182 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.971689

Epoch :  25 loss training:  5.498873553646263 Time :  335
accuracy train: 0.993584 val: 0.978182 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.971689

Epoch :  26 loss training:  5.396229502861388 Time :  347
accuracy train: 0.993798 val: 0.979394 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.971689

Epoch :  27 loss training:  5.458526341128163 Time :  359
accuracy train: 0.994012 val: 0.981818 test: 0.974886
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.971689

Epoch :  28 loss training:  4.954517483944073 Time :  372
accuracy train: 0.994226 val: 0.981818 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.971689

Epoch :  29 loss training:  4.875183285679668 Time :  386
accuracy train: 0.994440 val: 0.975758 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.971689

Epoch :  30 loss training:  4.306804672814906 Time :  399
accuracy train: 0.994226 val: 0.980606 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 23 test accuracy : 0.971689

Epoch :  31 loss training:  5.117933906498365 Time :  413
accuracy train: 0.994654 val: 0.983030 test: 0.971689
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.971689

Epoch :  32 loss training:  4.521584027213976 Time :  428
accuracy train: 0.994440 val: 0.979394 test: 0.970776
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.971689

Epoch :  33 loss training:  4.389290522201918 Time :  441
accuracy train: 0.995509 val: 0.981818 test: 0.974886
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.971689

Epoch :  34 loss training:  4.116339881962631 Time :  454
accuracy train: 0.995081 val: 0.984242 test: 0.968037
max validation accuracy : 0.984242 max acc epoch : 34 test accuracy : 0.968037

Epoch :  35 loss training:  4.26022352889413 Time :  468
accuracy train: 0.994867 val: 0.983030 test: 0.975799
max validation accuracy : 0.984242 max acc epoch : 34 test accuracy : 0.968037

Epoch :  36 loss training:  3.7091671883827075 Time :  481
accuracy train: 0.994867 val: 0.979394 test: 0.964384
max validation accuracy : 0.984242 max acc epoch : 34 test accuracy : 0.968037

Epoch :  37 loss training:  3.9621429970138706 Time :  495
accuracy train: 0.994654 val: 0.976970 test: 0.975342
max validation accuracy : 0.984242 max acc epoch : 34 test accuracy : 0.968037

Epoch :  38 loss training:  3.6384218777529895 Time :  509
accuracy train: 0.995295 val: 0.985455 test: 0.972603
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  39 loss training:  3.9629799546673894 Time :  525
accuracy train: 0.995723 val: 0.984242 test: 0.975342
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  40 loss training:  3.2306725092348643 Time :  538
accuracy train: 0.995509 val: 0.979394 test: 0.971233
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  41 loss training:  3.4774724464223254 Time :  551
accuracy train: 0.995509 val: 0.983030 test: 0.972603
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  42 loss training:  2.829900984885171 Time :  564
accuracy train: 0.995937 val: 0.981818 test: 0.974429
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  43 loss training:  2.9316865543369204 Time :  577
accuracy train: 0.995937 val: 0.979394 test: 0.968037
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  44 loss training:  3.5082755644107237 Time :  590
accuracy train: 0.996364 val: 0.976970 test: 0.973059
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  45 loss training:  3.602967265454936 Time :  604
accuracy train: 0.996151 val: 0.979394 test: 0.973516
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  46 loss training:  3.3259580312696926 Time :  618
accuracy train: 0.996151 val: 0.976970 test: 0.973059
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  47 loss training:  2.8691706460085697 Time :  634
accuracy train: 0.995937 val: 0.979394 test: 0.972603
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  48 loss training:  2.5213576632959303 Time :  648
accuracy train: 0.996364 val: 0.984242 test: 0.978082
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  49 loss training:  2.5718456865288317 Time :  661
accuracy train: 0.996364 val: 0.983030 test: 0.974886
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  50 loss training:  3.4481706553779077 Time :  674
accuracy train: 0.996364 val: 0.975758 test: 0.971689
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  51 loss training:  3.1749563014454907 Time :  686
accuracy train: 0.996364 val: 0.979394 test: 0.970776
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  52 loss training:  3.092402436188422 Time :  699
accuracy train: 0.996364 val: 0.980606 test: 0.975799
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  53 loss training:  2.922422280316823 Time :  712
accuracy train: 0.996151 val: 0.980606 test: 0.973973
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  54 loss training:  2.447451890700904 Time :  728
accuracy train: 0.996364 val: 0.983030 test: 0.973516
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  55 loss training:  2.559737303716247 Time :  741
accuracy train: 0.996792 val: 0.979394 test: 0.972146
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  56 loss training:  2.65307267344906 Time :  754
accuracy train: 0.996792 val: 0.981818 test: 0.974886
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  57 loss training:  2.5714144905941794 Time :  767
accuracy train: 0.996792 val: 0.979394 test: 0.970776
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  58 loss training:  1.8729389135260135 Time :  779
accuracy train: 0.996792 val: 0.976970 test: 0.973973
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  59 loss training:  1.9451705126848537 Time :  792
accuracy train: 0.996792 val: 0.981818 test: 0.974886
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  60 loss training:  2.2056521457561757 Time :  805
accuracy train: 0.996364 val: 0.979394 test: 0.974429
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  61 loss training:  2.1864991392205866 Time :  818
accuracy train: 0.996578 val: 0.980606 test: 0.974886
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  62 loss training:  2.012938499559823 Time :  833
accuracy train: 0.996578 val: 0.980606 test: 0.971689
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  63 loss training:  2.3511396395570046 Time :  847
accuracy train: 0.996792 val: 0.984242 test: 0.973973
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  64 loss training:  2.2017390486580553 Time :  860
accuracy train: 0.996792 val: 0.979394 test: 0.977169
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  65 loss training:  2.3859031593528925 Time :  873
accuracy train: 0.996792 val: 0.983030 test: 0.971689
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  66 loss training:  2.1501400149300025 Time :  886
accuracy train: 0.996792 val: 0.978182 test: 0.975342
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  67 loss training:  2.3627035046520177 Time :  899
accuracy train: 0.996578 val: 0.976970 test: 0.967580
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  68 loss training:  2.6572566307513625 Time :  912
accuracy train: 0.996792 val: 0.975758 test: 0.968950
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

Epoch :  69 loss training:  1.8492883272920153 Time :  925
accuracy train: 0.997220 val: 0.980606 test: 0.969863
max validation accuracy : 0.985455 max acc epoch : 38 test accuracy : 0.972603

========================================================================================================================================================================================================
best acc epoch :  38
validation accuracy :  0.9854545454545455
test accuracy :  0.9726027397260274
last test_accuracy :  0.9698630136986301
second best val :  0.9842424242424243
second best test :  0.9680365296803652
max gap 8
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.5, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=751, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  48.44400068372488 Time :  940
accuracy train: 0.955945 val: 0.955152 test: 0.955708
max validation accuracy : 0.955152 max acc epoch : 1 test accuracy : 0.955708
Epoch-1 lr: 0.001

Epoch :  2 loss training:  23.42966199107468 Time :  952
accuracy train: 0.957870 val: 0.955152 test: 0.949315
max validation accuracy : 0.955152 max acc epoch : 1 test accuracy : 0.955708
Epoch-2 lr: 0.001

Epoch :  3 loss training:  17.746729879640043 Time :  964
accuracy train: 0.968563 val: 0.960000 test: 0.957991
max validation accuracy : 0.960000 max acc epoch : 3 test accuracy : 0.957991
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  15.298537794034928 Time :  977
accuracy train: 0.968563 val: 0.963636 test: 0.971689
max validation accuracy : 0.963636 max acc epoch : 4 test accuracy : 0.971689
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  14.040739377960563 Time :  989
accuracy train: 0.977973 val: 0.972121 test: 0.969406
max validation accuracy : 0.972121 max acc epoch : 5 test accuracy : 0.969406
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  12.90723874233663 Time :  1001
accuracy train: 0.979470 val: 0.966061 test: 0.971689
max validation accuracy : 0.972121 max acc epoch : 5 test accuracy : 0.969406
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  10.855142092332244 Time :  1013
accuracy train: 0.982464 val: 0.972121 test: 0.970320
max validation accuracy : 0.972121 max acc epoch : 5 test accuracy : 0.969406
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  10.69666926190257 Time :  1024
accuracy train: 0.983961 val: 0.973333 test: 0.962557
max validation accuracy : 0.973333 max acc epoch : 8 test accuracy : 0.962557
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  10.209570140112191 Time :  1039
accuracy train: 0.983747 val: 0.973333 test: 0.971689
max validation accuracy : 0.973333 max acc epoch : 8 test accuracy : 0.962557
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  9.61072902037995 Time :  1050
accuracy train: 0.985458 val: 0.972121 test: 0.973059
max validation accuracy : 0.973333 max acc epoch : 8 test accuracy : 0.962557

Epoch :  11 loss training:  8.436372609925456 Time :  1064
accuracy train: 0.986313 val: 0.973333 test: 0.973059
max validation accuracy : 0.973333 max acc epoch : 8 test accuracy : 0.962557

Epoch :  12 loss training:  8.447112269932404 Time :  1078
accuracy train: 0.988879 val: 0.975758 test: 0.970320
max validation accuracy : 0.975758 max acc epoch : 12 test accuracy : 0.970320

Epoch :  13 loss training:  7.925292293308303 Time :  1091
accuracy train: 0.989093 val: 0.974545 test: 0.969406
max validation accuracy : 0.975758 max acc epoch : 12 test accuracy : 0.970320

Epoch :  14 loss training:  8.51158069469966 Time :  1104
accuracy train: 0.989521 val: 0.975758 test: 0.973516
max validation accuracy : 0.975758 max acc epoch : 12 test accuracy : 0.970320

Epoch :  15 loss training:  7.668251674622297 Time :  1117
accuracy train: 0.990590 val: 0.976970 test: 0.972603
max validation accuracy : 0.976970 max acc epoch : 15 test accuracy : 0.972603

Epoch :  16 loss training:  7.585628870758228 Time :  1130
accuracy train: 0.989949 val: 0.973333 test: 0.972603
max validation accuracy : 0.976970 max acc epoch : 15 test accuracy : 0.972603

Epoch :  17 loss training:  6.686087760608643 Time :  1145
accuracy train: 0.991446 val: 0.976970 test: 0.971689
max validation accuracy : 0.976970 max acc epoch : 15 test accuracy : 0.972603

Epoch :  18 loss training:  6.486346975667402 Time :  1158
accuracy train: 0.990804 val: 0.980606 test: 0.965753
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.965753

Epoch :  19 loss training:  6.243098076432943 Time :  1171
accuracy train: 0.991446 val: 0.976970 test: 0.975342
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.965753

Epoch :  20 loss training:  6.542640234343708 Time :  1184
accuracy train: 0.992301 val: 0.979394 test: 0.967580
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.965753

Epoch :  21 loss training:  6.358364352025092 Time :  1197
accuracy train: 0.991873 val: 0.979394 test: 0.968950
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.965753

Epoch :  22 loss training:  6.000628721201792 Time :  1212
accuracy train: 0.992943 val: 0.978182 test: 0.973973
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.965753

Epoch :  23 loss training:  5.588257597468328 Time :  1225
accuracy train: 0.994012 val: 0.975758 test: 0.969863
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.965753

Epoch :  24 loss training:  5.49220667348709 Time :  1241
accuracy train: 0.992943 val: 0.974545 test: 0.973516
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.965753

Epoch :  25 loss training:  4.743063393048942 Time :  1255
accuracy train: 0.993584 val: 0.975758 test: 0.971233
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.965753

Epoch :  26 loss training:  4.959116584883304 Time :  1269
accuracy train: 0.995295 val: 0.979394 test: 0.971233
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.965753

Epoch :  27 loss training:  4.7908892831765115 Time :  1282
accuracy train: 0.995081 val: 0.976970 test: 0.971689
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.965753

Epoch :  28 loss training:  4.287478336133063 Time :  1296
accuracy train: 0.994440 val: 0.976970 test: 0.972603
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.965753

Epoch :  29 loss training:  4.625578297214815 Time :  1310
accuracy train: 0.993798 val: 0.974545 test: 0.972603
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.965753

Epoch :  30 loss training:  4.6681665390206035 Time :  1324
accuracy train: 0.995081 val: 0.980606 test: 0.971233
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.965753

Epoch :  31 loss training:  4.812102377807605 Time :  1338
accuracy train: 0.995081 val: 0.978182 test: 0.973973
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.965753

Epoch :  32 loss training:  4.386401551601011 Time :  1354
accuracy train: 0.995937 val: 0.976970 test: 0.975799
max validation accuracy : 0.980606 max acc epoch : 18 test accuracy : 0.965753

Epoch :  33 loss training:  4.120298229390755 Time :  1366
accuracy train: 0.995937 val: 0.981818 test: 0.968493
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  34 loss training:  3.823865792597644 Time :  1380
accuracy train: 0.995937 val: 0.972121 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  35 loss training:  3.829547687404556 Time :  1395
accuracy train: 0.995723 val: 0.972121 test: 0.974886
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  36 loss training:  3.9604514482198283 Time :  1409
accuracy train: 0.994226 val: 0.978182 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  37 loss training:  3.800623394548893 Time :  1423
accuracy train: 0.995937 val: 0.978182 test: 0.975799
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  38 loss training:  3.551958026131615 Time :  1436
accuracy train: 0.996151 val: 0.974545 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  39 loss training:  3.336421016138047 Time :  1450
accuracy train: 0.996364 val: 0.979394 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  40 loss training:  3.3777795691858046 Time :  1467
accuracy train: 0.996364 val: 0.976970 test: 0.964840
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  41 loss training:  3.4380562072328757 Time :  1481
accuracy train: 0.996151 val: 0.975758 test: 0.976256
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  42 loss training:  3.774219725339208 Time :  1495
accuracy train: 0.996364 val: 0.980606 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  43 loss training:  3.0530240719235735 Time :  1509
accuracy train: 0.995937 val: 0.979394 test: 0.975342
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  44 loss training:  3.4085563935586833 Time :  1522
accuracy train: 0.996364 val: 0.976970 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  45 loss training:  3.096184350637486 Time :  1536
accuracy train: 0.995937 val: 0.979394 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  46 loss training:  3.062440648849588 Time :  1549
accuracy train: 0.996151 val: 0.979394 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  47 loss training:  3.0169864212803077 Time :  1564
accuracy train: 0.996578 val: 0.979394 test: 0.974886
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  48 loss training:  2.6901078999508172 Time :  1579
accuracy train: 0.996792 val: 0.979394 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  49 loss training:  2.6367312407237478 Time :  1593
accuracy train: 0.997006 val: 0.978182 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  50 loss training:  2.7438375029014423 Time :  1606
accuracy train: 0.996578 val: 0.981818 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  51 loss training:  2.637657266590395 Time :  1620
accuracy train: 0.997006 val: 0.980606 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  52 loss training:  2.400797625159612 Time :  1634
accuracy train: 0.996792 val: 0.980606 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  53 loss training:  2.285719734209124 Time :  1648
accuracy train: 0.997006 val: 0.979394 test: 0.974886
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  54 loss training:  2.4908804338774644 Time :  1660
accuracy train: 0.996364 val: 0.972121 test: 0.976256
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  55 loss training:  2.177534889568051 Time :  1675
accuracy train: 0.997006 val: 0.980606 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  56 loss training:  2.56289776241465 Time :  1690
accuracy train: 0.996792 val: 0.974545 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  57 loss training:  2.2680415119684767 Time :  1703
accuracy train: 0.997220 val: 0.981818 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  58 loss training:  2.376957552827662 Time :  1716
accuracy train: 0.997006 val: 0.978182 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  59 loss training:  2.094246661028592 Time :  1729
accuracy train: 0.996792 val: 0.978182 test: 0.975342
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  60 loss training:  2.2988594389830723 Time :  1743
accuracy train: 0.996578 val: 0.980606 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  61 loss training:  1.9514195839874446 Time :  1757
accuracy train: 0.996792 val: 0.981818 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  62 loss training:  1.9059655871242285 Time :  1771
accuracy train: 0.996792 val: 0.980606 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  63 loss training:  2.2546452045353362 Time :  1785
accuracy train: 0.996792 val: 0.981818 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

Epoch :  64 loss training:  1.6923399250590592 Time :  1800
accuracy train: 0.997220 val: 0.980606 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.968493

========================================================================================================================================================================================================
best acc epoch :  33
validation accuracy :  0.9818181818181818
test accuracy :  0.9684931506849315
last test_accuracy :  0.9698630136986301
second best val :  0.9806060606060606
second best test :  0.9657534246575342
max gap 15
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  38 	 val_accuracy : 0.98545 	 test_accuracy : 0.97260 	 last test_accuracy : 0.96986 	 second best val : 0.98424 	 second best test : 0.96804
k :  1 	 best_acc epoch :  33 	 val_accuracy : 0.98182 	 test_accuracy : 0.96849 	 last test_accuracy : 0.96986 	 second best val : 0.98061 	 second best test : 0.96575

avg :  	 val_accuracy : 0.98364 	 test_accuracy : 0.97055 	 last_accuracy : 0.96986 	 second best val : 0.98242 	 second best test : 0.96689

std :  	 val_accuracy : 0.00182 	 test_accuracy : 0.00205 	 last_accuracy : 0.00000 	 second best val : 0.00182 	 second best test : 0.00114


date and time :  Fri Jun 18 21:27:25 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.5, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=850, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  46.60293648019433 Time :  15
accuracy train: 0.946322 val: 0.951515 test: 0.947032
max validation accuracy : 0.951515 max acc epoch : 1 test accuracy : 0.947032
Counter({0: 3959, 1: 3732})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  21.69273472414352 Time :  31
accuracy train: 0.956587 val: 0.960000 test: 0.956164
max validation accuracy : 0.960000 max acc epoch : 2 test accuracy : 0.956164
Counter({1: 3947, 0: 3744})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  19.396369807072915 Time :  47
accuracy train: 0.967280 val: 0.973333 test: 0.969863
max validation accuracy : 0.973333 max acc epoch : 3 test accuracy : 0.969863
Counter({1: 3976, 0: 3715})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  14.02892249589786 Time :  63
accuracy train: 0.976689 val: 0.976970 test: 0.972146
max validation accuracy : 0.976970 max acc epoch : 4 test accuracy : 0.972146
Counter({0: 3915, 1: 3776})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  12.406988385599107 Time :  80
accuracy train: 0.977759 val: 0.970909 test: 0.974886
max validation accuracy : 0.976970 max acc epoch : 4 test accuracy : 0.972146
Counter({1: 3925, 0: 3766})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  11.782523472327739 Time :  104
accuracy train: 0.974979 val: 0.974545 test: 0.969863
max validation accuracy : 0.976970 max acc epoch : 4 test accuracy : 0.972146
Counter({1: 3900, 0: 3791})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  10.72643397282809 Time :  121
accuracy train: 0.980753 val: 0.975758 test: 0.974429
max validation accuracy : 0.976970 max acc epoch : 4 test accuracy : 0.972146
Counter({1: 3898, 0: 3793})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  10.106815320556052 Time :  137
accuracy train: 0.986955 val: 0.985455 test: 0.969406
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({1: 3893, 0: 3798})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  9.582615815801546 Time :  154
accuracy train: 0.986099 val: 0.974545 test: 0.973973
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({0: 3887, 1: 3804})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  8.456004888750613 Time :  170
accuracy train: 0.985030 val: 0.979394 test: 0.974429
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({1: 3888, 0: 3803})

Epoch :  11 loss training:  8.849726571002975 Time :  188
accuracy train: 0.985672 val: 0.976970 test: 0.974429
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({0: 3887, 1: 3804})

Epoch :  12 loss training:  8.481022632448003 Time :  206
accuracy train: 0.987169 val: 0.983030 test: 0.970776
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({0: 3878, 1: 3813})

Epoch :  13 loss training:  7.267645901534706 Time :  225
accuracy train: 0.988024 val: 0.983030 test: 0.974429
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({1: 3873, 0: 3818})

Epoch :  14 loss training:  7.3347710613161325 Time :  242
accuracy train: 0.989735 val: 0.981818 test: 0.973516
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({0: 3868, 1: 3823})

Epoch :  15 loss training:  7.636601283680648 Time :  260
accuracy train: 0.989735 val: 0.981818 test: 0.975799
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({1: 3866, 0: 3825})

Epoch :  16 loss training:  7.606811080360785 Time :  277
accuracy train: 0.991018 val: 0.983030 test: 0.973973
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({0: 3861, 1: 3830})

Epoch :  17 loss training:  7.272180908592418 Time :  294
accuracy train: 0.990804 val: 0.975758 test: 0.973516
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({1: 3856, 0: 3835})

Epoch :  18 loss training:  6.399535920005292 Time :  312
accuracy train: 0.991873 val: 0.980606 test: 0.976712
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({1: 3854, 0: 3837})

Epoch :  19 loss training:  6.214574934449047 Time :  331
accuracy train: 0.992087 val: 0.980606 test: 0.977169
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({1: 3852, 0: 3839})

Epoch :  20 loss training:  5.830684773391113 Time :  349
accuracy train: 0.992087 val: 0.980606 test: 0.974886
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({1: 3850, 0: 3841})

Epoch :  21 loss training:  5.5961676113074645 Time :  366
accuracy train: 0.991018 val: 0.981818 test: 0.976256
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({1: 3858, 0: 3833})

Epoch :  22 loss training:  5.468547676689923 Time :  385
accuracy train: 0.992515 val: 0.983030 test: 0.974429
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({0: 3858, 1: 3833})

Epoch :  23 loss training:  5.948430876713246 Time :  402
accuracy train: 0.993370 val: 0.981818 test: 0.973059
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({1: 3862, 0: 3829})

Epoch :  24 loss training:  5.2858799744572025 Time :  419
accuracy train: 0.992943 val: 0.983030 test: 0.974886
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({0: 3874, 1: 3817})

Epoch :  25 loss training:  4.983434198773466 Time :  436
accuracy train: 0.992729 val: 0.979394 test: 0.980365
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({0: 3878, 1: 3813})

Epoch :  26 loss training:  5.270696506893728 Time :  459
accuracy train: 0.995509 val: 0.984242 test: 0.974886
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({0: 3879, 1: 3812})

Epoch :  27 loss training:  4.757063305005431 Time :  475
accuracy train: 0.993370 val: 0.984242 test: 0.969406
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({1: 3884, 0: 3807})

Epoch :  28 loss training:  4.710620600148104 Time :  494
accuracy train: 0.994226 val: 0.981818 test: 0.976256
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({0: 3882, 1: 3809})

Epoch :  29 loss training:  4.37264377734391 Time :  511
accuracy train: 0.994226 val: 0.979394 test: 0.978539
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({1: 3884, 0: 3807})

Epoch :  30 loss training:  4.024139566230588 Time :  529
accuracy train: 0.995723 val: 0.984242 test: 0.976256
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({0: 3892, 1: 3799})

Epoch :  31 loss training:  4.069525446102489 Time :  546
accuracy train: 0.994440 val: 0.983030 test: 0.980365
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({0: 3893, 1: 3798})

Epoch :  32 loss training:  3.575624880439136 Time :  566
accuracy train: 0.994654 val: 0.984242 test: 0.974886
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({1: 3893, 0: 3798})

Epoch :  33 loss training:  3.4750251488003414 Time :  583
accuracy train: 0.995295 val: 0.981818 test: 0.975342
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({1: 3896, 0: 3795})

Epoch :  34 loss training:  3.692167403525673 Time :  599
accuracy train: 0.994012 val: 0.980606 test: 0.977169
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({0: 3899, 1: 3792})

Epoch :  35 loss training:  3.1031589155318215 Time :  618
accuracy train: 0.994867 val: 0.980606 test: 0.978082
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({1: 3901, 0: 3790})

Epoch :  36 loss training:  3.0853113822522573 Time :  636
accuracy train: 0.994440 val: 0.981818 test: 0.978539
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({0: 3902, 1: 3789})

Epoch :  37 loss training:  3.106842939683702 Time :  653
accuracy train: 0.995937 val: 0.981818 test: 0.974886
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({0: 3903, 1: 3788})

Epoch :  38 loss training:  2.9049835222249385 Time :  673
accuracy train: 0.995937 val: 0.981818 test: 0.974429
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({1: 3907, 0: 3784})

Epoch :  39 loss training:  3.0570263702829834 Time :  691
accuracy train: 0.995937 val: 0.981818 test: 0.973973
max validation accuracy : 0.985455 max acc epoch : 8 test accuracy : 0.969406
Counter({1: 3909, 0: 3782})

========================================================================================================================================================================================================
best acc epoch :  8
validation accuracy :  0.9854545454545455
test accuracy :  0.9694063926940639
last test_accuracy :  0.9739726027397261
second best val :  0.9842424242424243
second best test :  0.9694063926940639
max gap 4
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.5, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=589, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  45.95892361551523 Time :  711
accuracy train: 0.957442 val: 0.943030 test: 0.955708
max validation accuracy : 0.943030 max acc epoch : 1 test accuracy : 0.955708
Counter({0: 4098, 1: 3593})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  20.970224415883422 Time :  730
accuracy train: 0.962575 val: 0.941818 test: 0.959361
max validation accuracy : 0.943030 max acc epoch : 1 test accuracy : 0.955708
Counter({0: 3997, 1: 3694})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  17.308679229579866 Time :  749
accuracy train: 0.964927 val: 0.941818 test: 0.950685
max validation accuracy : 0.943030 max acc epoch : 1 test accuracy : 0.955708
Counter({0: 3915, 1: 3776})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  15.334182685241103 Time :  768
accuracy train: 0.979042 val: 0.955152 test: 0.968037
max validation accuracy : 0.955152 max acc epoch : 4 test accuracy : 0.968037
Counter({0: 3895, 1: 3796})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  13.001553050940856 Time :  785
accuracy train: 0.982036 val: 0.960000 test: 0.973516
max validation accuracy : 0.960000 max acc epoch : 5 test accuracy : 0.973516
Counter({1: 3928, 0: 3763})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  12.07601945195347 Time :  809
accuracy train: 0.976689 val: 0.953939 test: 0.969406
max validation accuracy : 0.960000 max acc epoch : 5 test accuracy : 0.973516
Counter({0: 3964, 1: 3727})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  10.127157011069357 Time :  825
accuracy train: 0.985458 val: 0.961212 test: 0.971233
max validation accuracy : 0.961212 max acc epoch : 7 test accuracy : 0.971233
Counter({1: 3933, 0: 3758})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  10.14156410843134 Time :  842
accuracy train: 0.986313 val: 0.963636 test: 0.971689
max validation accuracy : 0.963636 max acc epoch : 8 test accuracy : 0.971689
Counter({0: 3918, 1: 3773})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  9.091618147213012 Time :  858
accuracy train: 0.982678 val: 0.958788 test: 0.971233
max validation accuracy : 0.963636 max acc epoch : 8 test accuracy : 0.971689
Counter({1: 3906, 0: 3785})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  8.829392389161512 Time :  875
accuracy train: 0.984388 val: 0.953939 test: 0.972146
max validation accuracy : 0.963636 max acc epoch : 8 test accuracy : 0.971689
Counter({1: 3907, 0: 3784})

Epoch :  11 loss training:  8.544124884298071 Time :  893
accuracy train: 0.988238 val: 0.966061 test: 0.971233
max validation accuracy : 0.966061 max acc epoch : 11 test accuracy : 0.971233
Counter({0: 3890, 1: 3801})

Epoch :  12 loss training:  7.552036471897736 Time :  913
accuracy train: 0.989735 val: 0.969697 test: 0.972603
max validation accuracy : 0.969697 max acc epoch : 12 test accuracy : 0.972603
Counter({0: 3885, 1: 3806})

Epoch :  13 loss training:  7.896680533187464 Time :  931
accuracy train: 0.988238 val: 0.967273 test: 0.975799
max validation accuracy : 0.969697 max acc epoch : 12 test accuracy : 0.972603
Counter({1: 3883, 0: 3808})

Epoch :  14 loss training:  7.245895406929776 Time :  949
accuracy train: 0.987810 val: 0.960000 test: 0.974429
max validation accuracy : 0.969697 max acc epoch : 12 test accuracy : 0.972603
Counter({0: 3879, 1: 3812})

Epoch :  15 loss training:  6.480285304831341 Time :  967
accuracy train: 0.988238 val: 0.966061 test: 0.975342
max validation accuracy : 0.969697 max acc epoch : 12 test accuracy : 0.972603
Counter({1: 3879, 0: 3812})

Epoch :  16 loss training:  6.489180258940905 Time :  985
accuracy train: 0.992515 val: 0.967273 test: 0.973516
max validation accuracy : 0.969697 max acc epoch : 12 test accuracy : 0.972603
Counter({0: 3873, 1: 3818})

Epoch :  17 loss training:  6.2012204168131575 Time :  1002
accuracy train: 0.992087 val: 0.966061 test: 0.972146
max validation accuracy : 0.969697 max acc epoch : 12 test accuracy : 0.972603
Counter({1: 3868, 0: 3823})

Epoch :  18 loss training:  6.086561588337645 Time :  1019
accuracy train: 0.992301 val: 0.969697 test: 0.974886
max validation accuracy : 0.969697 max acc epoch : 12 test accuracy : 0.972603
Counter({0: 3863, 1: 3828})

Epoch :  19 loss training:  6.356533925281838 Time :  1044
accuracy train: 0.992729 val: 0.963636 test: 0.975799
max validation accuracy : 0.969697 max acc epoch : 12 test accuracy : 0.972603
Counter({0: 3863, 1: 3828})

Epoch :  20 loss training:  5.893946981988847 Time :  1061
accuracy train: 0.993157 val: 0.968485 test: 0.975799
max validation accuracy : 0.969697 max acc epoch : 12 test accuracy : 0.972603
Counter({0: 3849, 1: 3842})

Epoch :  21 loss training:  4.892460319213569 Time :  1078
accuracy train: 0.993584 val: 0.967273 test: 0.976256
max validation accuracy : 0.969697 max acc epoch : 12 test accuracy : 0.972603
Counter({1: 3850, 0: 3841})

Epoch :  22 loss training:  5.2610247224220075 Time :  1095
accuracy train: 0.994226 val: 0.970909 test: 0.975799
max validation accuracy : 0.970909 max acc epoch : 22 test accuracy : 0.975799
Counter({0: 3861, 1: 3830})

Epoch :  23 loss training:  4.646172007662244 Time :  1112
accuracy train: 0.994012 val: 0.966061 test: 0.976256
max validation accuracy : 0.970909 max acc epoch : 22 test accuracy : 0.975799
Counter({1: 3866, 0: 3825})

Epoch :  24 loss training:  4.538783931580838 Time :  1131
accuracy train: 0.994226 val: 0.967273 test: 0.975342
max validation accuracy : 0.970909 max acc epoch : 22 test accuracy : 0.975799
Counter({1: 3867, 0: 3824})

Epoch :  25 loss training:  4.271658134355675 Time :  1150
accuracy train: 0.994654 val: 0.972121 test: 0.975799
max validation accuracy : 0.972121 max acc epoch : 25 test accuracy : 0.975799
Counter({0: 3869, 1: 3822})

Epoch :  26 loss training:  4.274598188349046 Time :  1168
accuracy train: 0.994654 val: 0.968485 test: 0.974886
max validation accuracy : 0.972121 max acc epoch : 25 test accuracy : 0.975799
Counter({1: 3883, 0: 3808})

Epoch :  27 loss training:  3.8470755797461607 Time :  1186
accuracy train: 0.994440 val: 0.968485 test: 0.971233
max validation accuracy : 0.972121 max acc epoch : 25 test accuracy : 0.975799
Counter({1: 3890, 0: 3801})

Epoch :  28 loss training:  3.6602334731724113 Time :  1203
accuracy train: 0.995081 val: 0.968485 test: 0.972146
max validation accuracy : 0.972121 max acc epoch : 25 test accuracy : 0.975799
Counter({0: 3894, 1: 3797})

Epoch :  29 loss training:  3.5801820554188453 Time :  1221
accuracy train: 0.995723 val: 0.970909 test: 0.973973
max validation accuracy : 0.972121 max acc epoch : 25 test accuracy : 0.975799
Counter({1: 3898, 0: 3793})

Epoch :  30 loss training:  3.6887234951136634 Time :  1239
accuracy train: 0.995295 val: 0.972121 test: 0.973516
max validation accuracy : 0.972121 max acc epoch : 25 test accuracy : 0.975799
Counter({0: 3900, 1: 3791})

Epoch :  31 loss training:  4.000224481627811 Time :  1260
accuracy train: 0.996364 val: 0.973333 test: 0.973059
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.973059
Counter({0: 3913, 1: 3778})

Epoch :  32 loss training:  3.513552206917666 Time :  1278
accuracy train: 0.995723 val: 0.974545 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({1: 3912, 0: 3779})

Epoch :  33 loss training:  3.2398364247201243 Time :  1296
accuracy train: 0.996151 val: 0.969697 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({0: 3912, 1: 3779})

Epoch :  34 loss training:  3.2076818619389087 Time :  1313
accuracy train: 0.995295 val: 0.966061 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({1: 3912, 0: 3779})

Epoch :  35 loss training:  3.2418447390082292 Time :  1331
accuracy train: 0.996364 val: 0.967273 test: 0.975342
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({0: 3916, 1: 3775})

Epoch :  36 loss training:  3.178988301253412 Time :  1350
accuracy train: 0.995723 val: 0.968485 test: 0.974429
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({1: 3915, 0: 3776})

Epoch :  37 loss training:  2.5413748803257477 Time :  1367
accuracy train: 0.996364 val: 0.969697 test: 0.975342
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({0: 3921, 1: 3770})

Epoch :  38 loss training:  2.8220440064324066 Time :  1387
accuracy train: 0.996151 val: 0.968485 test: 0.976256
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({0: 3921, 1: 3770})

Epoch :  39 loss training:  2.6884441709844396 Time :  1405
accuracy train: 0.995937 val: 0.969697 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({0: 3921, 1: 3770})

Epoch :  40 loss training:  2.250251966819633 Time :  1422
accuracy train: 0.996364 val: 0.973333 test: 0.977169
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({1: 3923, 0: 3768})

Epoch :  41 loss training:  2.1911280264612287 Time :  1440
accuracy train: 0.996792 val: 0.970909 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({1: 3921, 0: 3770})

Epoch :  42 loss training:  2.5767774833075237 Time :  1458
accuracy train: 0.996151 val: 0.972121 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({1: 3922, 0: 3769})

Epoch :  43 loss training:  2.606349428417161 Time :  1475
accuracy train: 0.997006 val: 0.972121 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({0: 3922, 1: 3769})

Epoch :  44 loss training:  2.2596112936880672 Time :  1497
accuracy train: 0.996578 val: 0.966061 test: 0.975799
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({1: 3921, 0: 3770})

Epoch :  45 loss training:  2.2021748580446 Time :  1514
accuracy train: 0.996792 val: 0.967273 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({0: 3915, 1: 3776})

Epoch :  46 loss training:  2.549359174547135 Time :  1532
accuracy train: 0.996364 val: 0.970909 test: 0.975799
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({1: 3923, 0: 3768})

Epoch :  47 loss training:  2.307226960780099 Time :  1550
accuracy train: 0.996364 val: 0.968485 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({1: 3922, 0: 3769})

Epoch :  48 loss training:  2.133238728478318 Time :  1567
accuracy train: 0.997006 val: 0.966061 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({1: 3920, 0: 3771})

Epoch :  49 loss training:  2.28902178016142 Time :  1586
accuracy train: 0.996364 val: 0.970909 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({0: 3920, 1: 3771})

Epoch :  50 loss training:  2.281544970581308 Time :  1605
accuracy train: 0.997006 val: 0.970909 test: 0.974429
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({1: 3923, 0: 3768})

Epoch :  51 loss training:  2.1223362572782207 Time :  1624
accuracy train: 0.997006 val: 0.970909 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({0: 3923, 1: 3768})

Epoch :  52 loss training:  2.0135351434582844 Time :  1641
accuracy train: 0.996792 val: 0.969697 test: 0.974886
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({1: 3923, 0: 3768})

Epoch :  53 loss training:  1.7309826986165717 Time :  1659
accuracy train: 0.997434 val: 0.968485 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({0: 3922, 1: 3769})

Epoch :  54 loss training:  1.6536775267886696 Time :  1677
accuracy train: 0.997220 val: 0.967273 test: 0.976256
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({1: 3922, 0: 3769})

Epoch :  55 loss training:  1.797900631048833 Time :  1694
accuracy train: 0.997006 val: 0.969697 test: 0.974886
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({0: 3922, 1: 3769})

Epoch :  56 loss training:  1.7062362826691242 Time :  1712
accuracy train: 0.997220 val: 0.968485 test: 0.974429
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({1: 3921, 0: 3770})

Epoch :  57 loss training:  2.256482823526312 Time :  1735
accuracy train: 0.997006 val: 0.968485 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({1: 3922, 0: 3769})

Epoch :  58 loss training:  1.6923338855158363 Time :  1753
accuracy train: 0.997006 val: 0.969697 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({1: 3924, 0: 3767})

Epoch :  59 loss training:  1.8381288267191849 Time :  1771
accuracy train: 0.997006 val: 0.968485 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({0: 3924, 1: 3767})

Epoch :  60 loss training:  1.5958977158297785 Time :  1789
accuracy train: 0.997220 val: 0.966061 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({1: 3923, 0: 3768})

Epoch :  61 loss training:  1.9190150107315276 Time :  1806
accuracy train: 0.997220 val: 0.972121 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({0: 3923, 1: 3768})

Epoch :  62 loss training:  1.4586565046338364 Time :  1824
accuracy train: 0.997220 val: 0.967273 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({0: 3922, 1: 3769})

Epoch :  63 loss training:  1.62768210129434 Time :  1844
accuracy train: 0.997220 val: 0.964848 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 32 test accuracy : 0.973516
Counter({1: 3922, 0: 3769})

========================================================================================================================================================================================================
best acc epoch :  32
validation accuracy :  0.9745454545454545
test accuracy :  0.9735159817351599
last test_accuracy :  0.9739726027397261
second best val :  0.9733333333333334
second best test :  0.9730593607305936
max gap 10
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  8 	 val_accuracy : 0.98545 	 test_accuracy : 0.96941 	 last test_accuracy : 0.97397 	 second best val : 0.98424 	 second best test : 0.96941
k :  1 	 best_acc epoch :  32 	 val_accuracy : 0.97455 	 test_accuracy : 0.97352 	 last test_accuracy : 0.97397 	 second best val : 0.97333 	 second best test : 0.97306

avg :  	 val_accuracy : 0.98000 	 test_accuracy : 0.97146 	 last_accuracy : 0.97397 	 second best val : 0.97879 	 second best test : 0.97123

std :  	 val_accuracy : 0.00545 	 test_accuracy : 0.00205 	 last_accuracy : 0.00000 	 second best val : 0.00545 	 second best test : 0.00183
