

date and time :  Sat Jul  3 17:29:03 2021
itr : 0
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=404, tsne=False, val_prop=0.15, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  118.77908870577812 Time :  20
accuracy train: 0.917145 val: 0.898374 test: 0.898054
max validation accuracy : 0.898374 max acc epoch : 1 test accuracy : 0.898054
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.75185414403677 Time :  36
accuracy train: 0.940459 val: 0.926829 test: 0.925292
max validation accuracy : 0.926829 max acc epoch : 2 test accuracy : 0.925292
Epoch-2 lr: 0.001

Epoch :  3 loss training:  37.34265772253275 Time :  51
accuracy train: 0.950323 val: 0.922764 test: 0.922179
max validation accuracy : 0.926829 max acc epoch : 2 test accuracy : 0.925292
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  25.667843790724874 Time :  64
accuracy train: 0.973099 val: 0.945122 test: 0.938132
max validation accuracy : 0.945122 max acc epoch : 4 test accuracy : 0.938132
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  20.498963200487196 Time :  79
accuracy train: 0.981169 val: 0.950203 test: 0.942412
max validation accuracy : 0.950203 max acc epoch : 5 test accuracy : 0.942412
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  18.639394724741578 Time :  95
accuracy train: 0.982963 val: 0.945122 test: 0.936187
max validation accuracy : 0.950203 max acc epoch : 5 test accuracy : 0.942412
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  12.966108104214072 Time :  108
accuracy train: 0.988522 val: 0.952236 test: 0.943191
max validation accuracy : 0.952236 max acc epoch : 7 test accuracy : 0.943191
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  12.339821457862854 Time :  124
accuracy train: 0.990136 val: 0.956301 test: 0.944358
max validation accuracy : 0.956301 max acc epoch : 8 test accuracy : 0.944358
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  11.743632283993065 Time :  138
accuracy train: 0.992109 val: 0.953252 test: 0.944747
max validation accuracy : 0.956301 max acc epoch : 8 test accuracy : 0.944358
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  11.370395685080439 Time :  152
accuracy train: 0.992468 val: 0.954268 test: 0.946304
max validation accuracy : 0.956301 max acc epoch : 8 test accuracy : 0.944358

Epoch :  11 loss training:  10.247548788785934 Time :  166
accuracy train: 0.993364 val: 0.955285 test: 0.949416
max validation accuracy : 0.956301 max acc epoch : 8 test accuracy : 0.944358

Epoch :  12 loss training:  8.627003460656852 Time :  182
accuracy train: 0.994261 val: 0.954268 test: 0.949416
max validation accuracy : 0.956301 max acc epoch : 8 test accuracy : 0.944358

Epoch :  13 loss training:  7.150572125799954 Time :  197
accuracy train: 0.994620 val: 0.957317 test: 0.946693
max validation accuracy : 0.957317 max acc epoch : 13 test accuracy : 0.946693

Epoch :  14 loss training:  8.097238592803478 Time :  211
accuracy train: 0.994082 val: 0.952236 test: 0.946693
max validation accuracy : 0.957317 max acc epoch : 13 test accuracy : 0.946693

Epoch :  15 loss training:  7.453138652956113 Time :  226
accuracy train: 0.994440 val: 0.954268 test: 0.947082
max validation accuracy : 0.957317 max acc epoch : 13 test accuracy : 0.946693

Epoch :  16 loss training:  6.982698026113212 Time :  242
accuracy train: 0.995516 val: 0.955285 test: 0.948638
max validation accuracy : 0.957317 max acc epoch : 13 test accuracy : 0.946693

Epoch :  17 loss training:  6.130990623962134 Time :  256
accuracy train: 0.996055 val: 0.956301 test: 0.945136
max validation accuracy : 0.957317 max acc epoch : 13 test accuracy : 0.946693

Epoch :  18 loss training:  5.911980879725888 Time :  271
accuracy train: 0.995696 val: 0.955285 test: 0.947082
max validation accuracy : 0.957317 max acc epoch : 13 test accuracy : 0.946693

Epoch :  19 loss training:  5.752318522427231 Time :  286
accuracy train: 0.995696 val: 0.955285 test: 0.944747
max validation accuracy : 0.957317 max acc epoch : 13 test accuracy : 0.946693

Epoch :  20 loss training:  5.188565061194822 Time :  300
accuracy train: 0.995337 val: 0.958333 test: 0.948638
max validation accuracy : 0.958333 max acc epoch : 20 test accuracy : 0.948638

Epoch :  21 loss training:  5.4648768487386405 Time :  315
accuracy train: 0.995516 val: 0.952236 test: 0.943191
max validation accuracy : 0.958333 max acc epoch : 20 test accuracy : 0.948638

Epoch :  22 loss training:  4.719140368048102 Time :  331
accuracy train: 0.995516 val: 0.951220 test: 0.947082
max validation accuracy : 0.958333 max acc epoch : 20 test accuracy : 0.948638

Epoch :  23 loss training:  4.320882675296161 Time :  348
accuracy train: 0.995516 val: 0.953252 test: 0.946304
max validation accuracy : 0.958333 max acc epoch : 20 test accuracy : 0.948638

Epoch :  24 loss training:  4.368996000499465 Time :  362
accuracy train: 0.996055 val: 0.955285 test: 0.947082
max validation accuracy : 0.958333 max acc epoch : 20 test accuracy : 0.948638

Epoch :  25 loss training:  3.976139322272502 Time :  379
accuracy train: 0.996055 val: 0.951220 test: 0.947471
max validation accuracy : 0.958333 max acc epoch : 20 test accuracy : 0.948638

Epoch :  26 loss training:  4.071810545690823 Time :  394
accuracy train: 0.996772 val: 0.957317 test: 0.947860
max validation accuracy : 0.958333 max acc epoch : 20 test accuracy : 0.948638

Epoch :  27 loss training:  3.6776879641693085 Time :  409
accuracy train: 0.996413 val: 0.957317 test: 0.950973
max validation accuracy : 0.958333 max acc epoch : 20 test accuracy : 0.948638

Epoch :  28 loss training:  4.088127722265199 Time :  425
accuracy train: 0.996593 val: 0.961382 test: 0.948638
max validation accuracy : 0.961382 max acc epoch : 28 test accuracy : 0.948638

Epoch :  29 loss training:  3.8771798061206937 Time :  442
accuracy train: 0.996413 val: 0.954268 test: 0.952529
max validation accuracy : 0.961382 max acc epoch : 28 test accuracy : 0.948638

Epoch :  30 loss training:  3.398811991675757 Time :  456
accuracy train: 0.996593 val: 0.954268 test: 0.950973
max validation accuracy : 0.961382 max acc epoch : 28 test accuracy : 0.948638

Epoch :  31 loss training:  3.3364237220957875 Time :  470
accuracy train: 0.996593 val: 0.956301 test: 0.947860
max validation accuracy : 0.961382 max acc epoch : 28 test accuracy : 0.948638

Epoch :  32 loss training:  3.670723455492407 Time :  486
accuracy train: 0.996413 val: 0.958333 test: 0.950195
max validation accuracy : 0.961382 max acc epoch : 28 test accuracy : 0.948638

Epoch :  33 loss training:  3.737631523719756 Time :  500
accuracy train: 0.996951 val: 0.957317 test: 0.951362
max validation accuracy : 0.961382 max acc epoch : 28 test accuracy : 0.948638

Epoch :  34 loss training:  3.7078265177551657 Time :  515
accuracy train: 0.996593 val: 0.957317 test: 0.943969
max validation accuracy : 0.961382 max acc epoch : 28 test accuracy : 0.948638

Epoch :  35 loss training:  3.4680026358691975 Time :  530
accuracy train: 0.996593 val: 0.956301 test: 0.951751
max validation accuracy : 0.961382 max acc epoch : 28 test accuracy : 0.948638

Epoch :  36 loss training:  3.156755347154103 Time :  545
accuracy train: 0.996413 val: 0.958333 test: 0.948249
max validation accuracy : 0.961382 max acc epoch : 28 test accuracy : 0.948638

Epoch :  37 loss training:  2.8998365315492265 Time :  561
accuracy train: 0.997310 val: 0.962398 test: 0.947860
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  38 loss training:  2.4774839919700753 Time :  576
accuracy train: 0.996413 val: 0.959350 test: 0.948638
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  39 loss training:  2.608998230251018 Time :  590
accuracy train: 0.996772 val: 0.960366 test: 0.948638
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  40 loss training:  2.723750956443837 Time :  606
accuracy train: 0.996772 val: 0.957317 test: 0.947860
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  41 loss training:  2.289703289308818 Time :  620
accuracy train: 0.996593 val: 0.958333 test: 0.952140
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  42 loss training:  2.4659596795536345 Time :  635
accuracy train: 0.997310 val: 0.957317 test: 0.947471
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  43 loss training:  2.88212921450031 Time :  650
accuracy train: 0.997310 val: 0.956301 test: 0.947082
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  44 loss training:  2.212062204402173 Time :  663
accuracy train: 0.996772 val: 0.957317 test: 0.949805
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  45 loss training:  2.3906423824373633 Time :  679
accuracy train: 0.996593 val: 0.955285 test: 0.952140
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  46 loss training:  2.333110168838175 Time :  694
accuracy train: 0.997131 val: 0.957317 test: 0.946693
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  47 loss training:  2.436718284559902 Time :  706
accuracy train: 0.996593 val: 0.957317 test: 0.949805
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  48 loss training:  2.513343728176551 Time :  722
accuracy train: 0.996772 val: 0.955285 test: 0.946693
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  49 loss training:  2.3684655651595676 Time :  737
accuracy train: 0.996234 val: 0.953252 test: 0.946304
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  50 loss training:  1.9902334334110492 Time :  751
accuracy train: 0.996772 val: 0.956301 test: 0.951362
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  51 loss training:  2.0923085930699017 Time :  766
accuracy train: 0.997131 val: 0.959350 test: 0.950195
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  52 loss training:  2.2164139130472904 Time :  781
accuracy train: 0.996772 val: 0.953252 test: 0.945914
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  53 loss training:  2.121780843124725 Time :  795
accuracy train: 0.996772 val: 0.954268 test: 0.947471
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  54 loss training:  1.7712095103634056 Time :  810
accuracy train: 0.997310 val: 0.956301 test: 0.948638
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  55 loss training:  2.075704610644607 Time :  827
accuracy train: 0.996772 val: 0.955285 test: 0.950584
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  56 loss training:  2.3569923764298437 Time :  841
accuracy train: 0.996951 val: 0.956301 test: 0.951362
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  57 loss training:  1.8726910935365595 Time :  856
accuracy train: 0.996951 val: 0.961382 test: 0.945914
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  58 loss training:  2.0518771171191474 Time :  872
accuracy train: 0.997310 val: 0.959350 test: 0.949416
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  59 loss training:  1.9663884497640538 Time :  885
accuracy train: 0.997310 val: 0.953252 test: 0.951362
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  60 loss training:  2.2376837534247898 Time :  901
accuracy train: 0.996593 val: 0.956301 test: 0.946693
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  61 loss training:  2.0511642729543382 Time :  916
accuracy train: 0.996951 val: 0.956301 test: 0.947082
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  62 loss training:  1.9001595901791006 Time :  930
accuracy train: 0.997310 val: 0.959350 test: 0.949027
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  63 loss training:  2.135696493416617 Time :  947
accuracy train: 0.996593 val: 0.951220 test: 0.942802
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  64 loss training:  1.8179315706256602 Time :  963
accuracy train: 0.997131 val: 0.954268 test: 0.943969
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  65 loss training:  2.3288236569351284 Time :  977
accuracy train: 0.996772 val: 0.951220 test: 0.945914
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  66 loss training:  2.0500053992436733 Time :  992
accuracy train: 0.996772 val: 0.957317 test: 0.945136
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  67 loss training:  2.0480636552965734 Time :  1009
accuracy train: 0.997310 val: 0.956301 test: 0.948638
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

Epoch :  68 loss training:  2.1372022049181396 Time :  1025
accuracy train: 0.997131 val: 0.957317 test: 0.947082
max validation accuracy : 0.962398 max acc epoch : 37 test accuracy : 0.947860

========================================================================================================================================================================================================
best acc epoch :  37
validation accuracy :  0.9623983739837398
test accuracy :  0.9478599221789883
last test_accuracy :  0.9470817120622568
second best val :  0.9613821138211383
second best test :  0.9486381322957198
max gap 9
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=17, tsne=False, val_prop=0.15, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  120.23152235150337 Time :  1041
accuracy train: 0.907640 val: 0.884146 test: 0.884436
max validation accuracy : 0.884146 max acc epoch : 1 test accuracy : 0.884436
Epoch-1 lr: 0.001

Epoch :  2 loss training:  52.74510405957699 Time :  1057
accuracy train: 0.921987 val: 0.900407 test: 0.897276
max validation accuracy : 0.900407 max acc epoch : 2 test accuracy : 0.897276
Epoch-2 lr: 0.001

Epoch :  3 loss training:  39.146120293065906 Time :  1072
accuracy train: 0.953730 val: 0.925813 test: 0.915953
max validation accuracy : 0.925813 max acc epoch : 3 test accuracy : 0.915953
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  31.022167027927935 Time :  1085
accuracy train: 0.974713 val: 0.938008 test: 0.929183
max validation accuracy : 0.938008 max acc epoch : 4 test accuracy : 0.929183
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  25.85667642019689 Time :  1098
accuracy train: 0.978479 val: 0.947154 test: 0.931518
max validation accuracy : 0.947154 max acc epoch : 5 test accuracy : 0.931518
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  23.400747971609235 Time :  1112
accuracy train: 0.979914 val: 0.943089 test: 0.936576
max validation accuracy : 0.947154 max acc epoch : 5 test accuracy : 0.931518
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  17.354870347306132 Time :  1125
accuracy train: 0.984756 val: 0.951220 test: 0.944358
max validation accuracy : 0.951220 max acc epoch : 7 test accuracy : 0.944358
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  15.466396811418235 Time :  1139
accuracy train: 0.987984 val: 0.951220 test: 0.944747
max validation accuracy : 0.951220 max acc epoch : 7 test accuracy : 0.944358
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  12.567553955828771 Time :  1153
accuracy train: 0.989598 val: 0.946138 test: 0.948249
max validation accuracy : 0.951220 max acc epoch : 7 test accuracy : 0.944358
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  11.791918728500605 Time :  1166
accuracy train: 0.990495 val: 0.955285 test: 0.952529
max validation accuracy : 0.955285 max acc epoch : 10 test accuracy : 0.952529

Epoch :  11 loss training:  11.252674865536392 Time :  1183
accuracy train: 0.991930 val: 0.953252 test: 0.947082
max validation accuracy : 0.955285 max acc epoch : 10 test accuracy : 0.952529

Epoch :  12 loss training:  10.935935308225453 Time :  1197
accuracy train: 0.993544 val: 0.956301 test: 0.948638
max validation accuracy : 0.956301 max acc epoch : 12 test accuracy : 0.948638

Epoch :  13 loss training:  9.466644691303372 Time :  1212
accuracy train: 0.993902 val: 0.955285 test: 0.949805
max validation accuracy : 0.956301 max acc epoch : 12 test accuracy : 0.948638

Epoch :  14 loss training:  8.632519504986703 Time :  1228
accuracy train: 0.993544 val: 0.954268 test: 0.947860
max validation accuracy : 0.956301 max acc epoch : 12 test accuracy : 0.948638

Epoch :  15 loss training:  8.761684690369293 Time :  1243
accuracy train: 0.994440 val: 0.954268 test: 0.949027
max validation accuracy : 0.956301 max acc epoch : 12 test accuracy : 0.948638

Epoch :  16 loss training:  8.435803557978943 Time :  1257
accuracy train: 0.993544 val: 0.955285 test: 0.951362
max validation accuracy : 0.956301 max acc epoch : 12 test accuracy : 0.948638

Epoch :  17 loss training:  7.7889203717932105 Time :  1272
accuracy train: 0.994978 val: 0.956301 test: 0.948638
max validation accuracy : 0.956301 max acc epoch : 12 test accuracy : 0.948638

Epoch :  18 loss training:  6.784867810085416 Time :  1285
accuracy train: 0.995158 val: 0.956301 test: 0.946693
max validation accuracy : 0.956301 max acc epoch : 12 test accuracy : 0.948638

Epoch :  19 loss training:  7.075491926865652 Time :  1301
accuracy train: 0.995337 val: 0.954268 test: 0.948249
max validation accuracy : 0.956301 max acc epoch : 12 test accuracy : 0.948638

Epoch :  20 loss training:  6.576102141290903 Time :  1316
accuracy train: 0.995158 val: 0.954268 test: 0.950195
max validation accuracy : 0.956301 max acc epoch : 12 test accuracy : 0.948638

Epoch :  21 loss training:  6.023733825888485 Time :  1330
accuracy train: 0.995516 val: 0.951220 test: 0.944358
max validation accuracy : 0.956301 max acc epoch : 12 test accuracy : 0.948638

Epoch :  22 loss training:  5.457635203143582 Time :  1345
accuracy train: 0.995875 val: 0.951220 test: 0.948249
max validation accuracy : 0.956301 max acc epoch : 12 test accuracy : 0.948638

Epoch :  23 loss training:  5.322085220832378 Time :  1361
accuracy train: 0.995875 val: 0.955285 test: 0.948249
max validation accuracy : 0.956301 max acc epoch : 12 test accuracy : 0.948638

Epoch :  24 loss training:  5.040926009067334 Time :  1377
accuracy train: 0.995516 val: 0.956301 test: 0.950973
max validation accuracy : 0.956301 max acc epoch : 12 test accuracy : 0.948638

Epoch :  25 loss training:  4.618383719120175 Time :  1392
accuracy train: 0.995696 val: 0.955285 test: 0.947471
max validation accuracy : 0.956301 max acc epoch : 12 test accuracy : 0.948638

Epoch :  26 loss training:  4.532933564390987 Time :  1408
accuracy train: 0.995516 val: 0.951220 test: 0.950195
max validation accuracy : 0.956301 max acc epoch : 12 test accuracy : 0.948638

Epoch :  27 loss training:  4.85743844404351 Time :  1425
accuracy train: 0.996055 val: 0.953252 test: 0.946304
max validation accuracy : 0.956301 max acc epoch : 12 test accuracy : 0.948638

Epoch :  28 loss training:  4.681488866102882 Time :  1442
accuracy train: 0.996055 val: 0.952236 test: 0.947471
max validation accuracy : 0.956301 max acc epoch : 12 test accuracy : 0.948638

Epoch :  29 loss training:  4.073091269703582 Time :  1458
accuracy train: 0.996234 val: 0.952236 test: 0.947471
max validation accuracy : 0.956301 max acc epoch : 12 test accuracy : 0.948638

Epoch :  30 loss training:  3.8249060433590785 Time :  1474
accuracy train: 0.995696 val: 0.959350 test: 0.947082
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  31 loss training:  3.855893223779276 Time :  1490
accuracy train: 0.996055 val: 0.954268 test: 0.946693
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  32 loss training:  3.9533564339508303 Time :  1506
accuracy train: 0.996055 val: 0.956301 test: 0.947471
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  33 loss training:  3.523784584715031 Time :  1522
accuracy train: 0.996055 val: 0.959350 test: 0.950195
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  34 loss training:  3.6980017981259152 Time :  1540
accuracy train: 0.996234 val: 0.952236 test: 0.949027
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  35 loss training:  3.5285150906420313 Time :  1554
accuracy train: 0.996413 val: 0.957317 test: 0.950195
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  36 loss training:  3.3750561403576285 Time :  1570
accuracy train: 0.996234 val: 0.947154 test: 0.947471
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  37 loss training:  3.642440041701775 Time :  1587
accuracy train: 0.996234 val: 0.954268 test: 0.949416
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  38 loss training:  3.6029217800241895 Time :  1601
accuracy train: 0.996234 val: 0.954268 test: 0.946304
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  39 loss training:  3.0482946546107996 Time :  1617
accuracy train: 0.996413 val: 0.955285 test: 0.948249
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  40 loss training:  3.1419466289517004 Time :  1632
accuracy train: 0.996413 val: 0.956301 test: 0.947860
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  41 loss training:  2.729102204350056 Time :  1646
accuracy train: 0.996413 val: 0.955285 test: 0.948249
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  42 loss training:  2.9683154443919193 Time :  1662
accuracy train: 0.996413 val: 0.957317 test: 0.947860
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  43 loss training:  2.9341677728807554 Time :  1677
accuracy train: 0.996413 val: 0.958333 test: 0.947860
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  44 loss training:  2.8587562670581974 Time :  1690
accuracy train: 0.996413 val: 0.954268 test: 0.949027
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  45 loss training:  2.8407099139294587 Time :  1705
accuracy train: 0.996413 val: 0.959350 test: 0.949416
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  46 loss training:  3.1108400375014753 Time :  1719
accuracy train: 0.996413 val: 0.957317 test: 0.947860
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  47 loss training:  2.949515916610835 Time :  1734
accuracy train: 0.996413 val: 0.956301 test: 0.950195
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  48 loss training:  2.5909848214068916 Time :  1750
accuracy train: 0.996593 val: 0.953252 test: 0.951362
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  49 loss training:  2.8908803343219915 Time :  1764
accuracy train: 0.996413 val: 0.958333 test: 0.949027
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  50 loss training:  2.417758179246448 Time :  1779
accuracy train: 0.996413 val: 0.952236 test: 0.951362
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  51 loss training:  2.669971850933507 Time :  1795
accuracy train: 0.996234 val: 0.953252 test: 0.950195
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  52 loss training:  2.8089729823113885 Time :  1810
accuracy train: 0.996413 val: 0.954268 test: 0.948638
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  53 loss training:  2.8936057867103955 Time :  1824
accuracy train: 0.996413 val: 0.957317 test: 0.949805
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  54 loss training:  2.134476638006163 Time :  1840
accuracy train: 0.996413 val: 0.954268 test: 0.947471
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  55 loss training:  2.5728660575914546 Time :  1856
accuracy train: 0.996413 val: 0.954268 test: 0.947860
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  56 loss training:  2.557095101874438 Time :  1869
accuracy train: 0.996413 val: 0.956301 test: 0.949027
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  57 loss training:  2.611091463986668 Time :  1885
accuracy train: 0.996413 val: 0.954268 test: 0.947860
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  58 loss training:  2.178480001850403 Time :  1900
accuracy train: 0.996234 val: 0.959350 test: 0.948638
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  59 loss training:  2.6345760900585447 Time :  1914
accuracy train: 0.996234 val: 0.951220 test: 0.945914
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  60 loss training:  2.473096966918092 Time :  1929
accuracy train: 0.996413 val: 0.955285 test: 0.947860
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

Epoch :  61 loss training:  2.6978030518221203 Time :  1944
accuracy train: 0.996055 val: 0.952236 test: 0.946693
max validation accuracy : 0.959350 max acc epoch : 30 test accuracy : 0.947082

========================================================================================================================================================================================================
best acc epoch :  30
validation accuracy :  0.959349593495935
test accuracy :  0.9470817120622568
last test_accuracy :  0.946692607003891
second best val :  0.9583333333333334
second best test :  0.9470817120622568
max gap 18
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  37 	 val_accuracy : 0.96240 	 test_accuracy : 0.94786 	 last test_accuracy : 0.94708 	 second best val : 0.96138 	 second best test : 0.94864
k :  1 	 best_acc epoch :  30 	 val_accuracy : 0.95935 	 test_accuracy : 0.94708 	 last test_accuracy : 0.94669 	 second best val : 0.95833 	 second best test : 0.94708

avg :  	 val_accuracy : 0.96087 	 test_accuracy : 0.94747 	 last_accuracy : 0.94689 	 second best val : 0.95986 	 second best test : 0.94786

std :  	 val_accuracy : 0.00152 	 test_accuracy : 0.00039 	 last_accuracy : 0.00019 	 second best val : 0.00152 	 second best test : 0.00078


date and time :  Sat Jul  3 18:01:37 2021
itr : 0
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=927, tsne=False, val_prop=0.15, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  123.7488681152463 Time :  17
accuracy train: 0.905488 val: 0.890244 test: 0.889494
max validation accuracy : 0.890244 max acc epoch : 1 test accuracy : 0.889494
Epoch-1 lr: 0.001

Epoch :  2 loss training:  55.50580331683159 Time :  34
accuracy train: 0.921270 val: 0.895325 test: 0.908560
max validation accuracy : 0.895325 max acc epoch : 2 test accuracy : 0.908560
Epoch-2 lr: 0.001

Epoch :  3 loss training:  41.565967082977295 Time :  53
accuracy train: 0.952475 val: 0.924797 test: 0.926459
max validation accuracy : 0.924797 max acc epoch : 3 test accuracy : 0.926459
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  25.67160202562809 Time :  70
accuracy train: 0.976327 val: 0.935976 test: 0.936187
max validation accuracy : 0.935976 max acc epoch : 4 test accuracy : 0.936187
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  22.354222107678652 Time :  87
accuracy train: 0.978659 val: 0.951220 test: 0.943580
max validation accuracy : 0.951220 max acc epoch : 5 test accuracy : 0.943580
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  19.170238563790917 Time :  104
accuracy train: 0.978121 val: 0.946138 test: 0.945525
max validation accuracy : 0.951220 max acc epoch : 5 test accuracy : 0.943580
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  15.358782977797091 Time :  121
accuracy train: 0.986908 val: 0.952236 test: 0.947860
max validation accuracy : 0.952236 max acc epoch : 7 test accuracy : 0.947860
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  13.67352018551901 Time :  137
accuracy train: 0.988881 val: 0.947154 test: 0.948638
max validation accuracy : 0.952236 max acc epoch : 7 test accuracy : 0.947860
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  12.291905625257641 Time :  152
accuracy train: 0.986011 val: 0.945122 test: 0.936576
max validation accuracy : 0.952236 max acc epoch : 7 test accuracy : 0.947860
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  10.68611200619489 Time :  169
accuracy train: 0.990316 val: 0.956301 test: 0.948249
max validation accuracy : 0.956301 max acc epoch : 10 test accuracy : 0.948249

Epoch :  11 loss training:  10.207504127174616 Time :  188
accuracy train: 0.991392 val: 0.956301 test: 0.949027
max validation accuracy : 0.956301 max acc epoch : 10 test accuracy : 0.948249

Epoch :  12 loss training:  9.526746268151328 Time :  206
accuracy train: 0.991033 val: 0.954268 test: 0.952140
max validation accuracy : 0.956301 max acc epoch : 10 test accuracy : 0.948249

Epoch :  13 loss training:  9.043637314811349 Time :  223
accuracy train: 0.991033 val: 0.955285 test: 0.948249
max validation accuracy : 0.956301 max acc epoch : 10 test accuracy : 0.948249

Epoch :  14 loss training:  8.118027592543513 Time :  240
accuracy train: 0.992647 val: 0.952236 test: 0.950195
max validation accuracy : 0.956301 max acc epoch : 10 test accuracy : 0.948249

Epoch :  15 loss training:  7.68389199860394 Time :  259
accuracy train: 0.993902 val: 0.957317 test: 0.949805
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  16 loss training:  6.7709555176552385 Time :  278
accuracy train: 0.993902 val: 0.955285 test: 0.954864
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  17 loss training:  6.984124940354377 Time :  297
accuracy train: 0.993902 val: 0.953252 test: 0.952918
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  18 loss training:  6.660966196388472 Time :  313
accuracy train: 0.994440 val: 0.954268 test: 0.952140
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  19 loss training:  6.174431539140642 Time :  329
accuracy train: 0.995158 val: 0.953252 test: 0.952918
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  20 loss training:  6.516693694051355 Time :  344
accuracy train: 0.995158 val: 0.956301 test: 0.947082
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  21 loss training:  5.590674427105114 Time :  362
accuracy train: 0.994978 val: 0.954268 test: 0.953696
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  22 loss training:  5.370251443702728 Time :  378
accuracy train: 0.995875 val: 0.950203 test: 0.947860
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  23 loss training:  4.848290941445157 Time :  394
accuracy train: 0.995696 val: 0.952236 test: 0.949805
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  24 loss training:  4.572982164798304 Time :  410
accuracy train: 0.996055 val: 0.954268 test: 0.952918
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  25 loss training:  4.662057487410493 Time :  426
accuracy train: 0.996055 val: 0.954268 test: 0.950584
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  26 loss training:  3.9299501726636663 Time :  443
accuracy train: 0.996234 val: 0.954268 test: 0.952529
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  27 loss training:  3.564516519778408 Time :  459
accuracy train: 0.996234 val: 0.951220 test: 0.949805
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  28 loss training:  4.086509693879634 Time :  478
accuracy train: 0.995337 val: 0.952236 test: 0.949027
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  29 loss training:  3.6221414861502126 Time :  495
accuracy train: 0.996413 val: 0.956301 test: 0.949027
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  30 loss training:  4.202321243355982 Time :  512
accuracy train: 0.996593 val: 0.952236 test: 0.947082
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  31 loss training:  3.868824581382796 Time :  528
accuracy train: 0.996413 val: 0.951220 test: 0.946693
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  32 loss training:  3.2486044408287853 Time :  546
accuracy train: 0.996951 val: 0.953252 test: 0.950973
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  33 loss training:  3.5466650649905205 Time :  564
accuracy train: 0.996413 val: 0.955285 test: 0.951751
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  34 loss training:  2.9150518389069475 Time :  582
accuracy train: 0.996413 val: 0.952236 test: 0.949805
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  35 loss training:  2.817648456140887 Time :  599
accuracy train: 0.996772 val: 0.952236 test: 0.947860
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  36 loss training:  2.828043030400295 Time :  616
accuracy train: 0.996234 val: 0.951220 test: 0.951362
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  37 loss training:  2.5288998798350804 Time :  632
accuracy train: 0.996413 val: 0.955285 test: 0.948638
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  38 loss training:  2.9173335270315874 Time :  650
accuracy train: 0.996413 val: 0.952236 test: 0.948249
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  39 loss training:  2.7945001961197704 Time :  668
accuracy train: 0.996951 val: 0.952236 test: 0.947471
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  40 loss training:  2.407386900507845 Time :  686
accuracy train: 0.997131 val: 0.950203 test: 0.948638
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  41 loss training:  2.6433832848560996 Time :  703
accuracy train: 0.996772 val: 0.954268 test: 0.949027
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  42 loss training:  2.9650777908682358 Time :  722
accuracy train: 0.996055 val: 0.955285 test: 0.946304
max validation accuracy : 0.957317 max acc epoch : 15 test accuracy : 0.949805

Epoch :  43 loss training:  2.9857633809151594 Time :  740
accuracy train: 0.997310 val: 0.959350 test: 0.950195
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  44 loss training:  2.4679094525054097 Time :  758
accuracy train: 0.996772 val: 0.951220 test: 0.947860
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  45 loss training:  2.5666806674853433 Time :  777
accuracy train: 0.996951 val: 0.949187 test: 0.943969
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  46 loss training:  2.3036586852394976 Time :  796
accuracy train: 0.997131 val: 0.955285 test: 0.950195
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  47 loss training:  2.3163784893404227 Time :  815
accuracy train: 0.997131 val: 0.954268 test: 0.952918
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  48 loss training:  2.4814175366045674 Time :  833
accuracy train: 0.997310 val: 0.949187 test: 0.949416
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  49 loss training:  2.4034695060690865 Time :  851
accuracy train: 0.996951 val: 0.950203 test: 0.954864
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  50 loss training:  2.101497239273158 Time :  870
accuracy train: 0.997310 val: 0.952236 test: 0.950584
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  51 loss training:  2.3009752022917382 Time :  888
accuracy train: 0.996951 val: 0.951220 test: 0.953307
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  52 loss training:  2.478807721625344 Time :  906
accuracy train: 0.997131 val: 0.955285 test: 0.950195
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  53 loss training:  1.88791303015023 Time :  923
accuracy train: 0.997131 val: 0.954268 test: 0.952140
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  54 loss training:  1.7181682066584472 Time :  940
accuracy train: 0.997131 val: 0.952236 test: 0.950973
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  55 loss training:  2.0329009011256858 Time :  960
accuracy train: 0.996951 val: 0.953252 test: 0.954864
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  56 loss training:  1.9376151118340204 Time :  977
accuracy train: 0.997131 val: 0.954268 test: 0.954086
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  57 loss training:  1.9539846990955994 Time :  994
accuracy train: 0.996772 val: 0.955285 test: 0.949805
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  58 loss training:  2.2157269002927933 Time :  1011
accuracy train: 0.996951 val: 0.950203 test: 0.948249
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  59 loss training:  2.0274842673825333 Time :  1029
accuracy train: 0.996234 val: 0.952236 test: 0.945525
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  60 loss training:  2.389546021920978 Time :  1047
accuracy train: 0.997131 val: 0.949187 test: 0.951362
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  61 loss training:  2.2345012044825125 Time :  1064
accuracy train: 0.997489 val: 0.952236 test: 0.950584
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  62 loss training:  2.212861593841808 Time :  1082
accuracy train: 0.997310 val: 0.947154 test: 0.948638
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  63 loss training:  2.087447892787168 Time :  1099
accuracy train: 0.997310 val: 0.952236 test: 0.951751
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  64 loss training:  1.827217457277584 Time :  1116
accuracy train: 0.996951 val: 0.953252 test: 0.950584
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  65 loss training:  1.5769440903895884 Time :  1134
accuracy train: 0.997131 val: 0.953252 test: 0.951362
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  66 loss training:  1.8009960707422579 Time :  1152
accuracy train: 0.997310 val: 0.955285 test: 0.952140
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  67 loss training:  1.9572589388480992 Time :  1169
accuracy train: 0.997310 val: 0.953252 test: 0.951362
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  68 loss training:  1.8874094338571012 Time :  1187
accuracy train: 0.995516 val: 0.950203 test: 0.952529
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  69 loss training:  1.9329228417191189 Time :  1205
accuracy train: 0.997310 val: 0.953252 test: 0.948638
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  70 loss training:  1.5824407964537386 Time :  1222
accuracy train: 0.997310 val: 0.957317 test: 0.953307
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  71 loss training:  1.8651971316794516 Time :  1240
accuracy train: 0.997310 val: 0.952236 test: 0.950584
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  72 loss training:  2.2515178213070612 Time :  1257
accuracy train: 0.997131 val: 0.951220 test: 0.952529
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  73 loss training:  1.852311645016016 Time :  1275
accuracy train: 0.997131 val: 0.953252 test: 0.952529
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

Epoch :  74 loss training:  1.6540658476296812 Time :  1294
accuracy train: 0.997310 val: 0.953252 test: 0.953307
max validation accuracy : 0.959350 max acc epoch : 43 test accuracy : 0.950195

========================================================================================================================================================================================================
best acc epoch :  43
validation accuracy :  0.959349593495935
test accuracy :  0.9501945525291828
last test_accuracy :  0.953307392996109
second best val :  0.9573170731707317
second best test :  0.9498054474708171
max gap 28
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=904, tsne=False, val_prop=0.15, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  125.13982129096985 Time :  1315
accuracy train: 0.913379 val: 0.917683 test: 0.896887
max validation accuracy : 0.917683 max acc epoch : 1 test accuracy : 0.896887
Epoch-1 lr: 0.001

Epoch :  2 loss training:  55.837866209447384 Time :  1336
accuracy train: 0.937769 val: 0.925813 test: 0.915175
max validation accuracy : 0.925813 max acc epoch : 2 test accuracy : 0.915175
Epoch-2 lr: 0.001

Epoch :  3 loss training:  39.93726358935237 Time :  1355
accuracy train: 0.940997 val: 0.935976 test: 0.908171
max validation accuracy : 0.935976 max acc epoch : 3 test accuracy : 0.908171
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  26.470622703433037 Time :  1375
accuracy train: 0.966822 val: 0.943089 test: 0.934630
max validation accuracy : 0.943089 max acc epoch : 4 test accuracy : 0.934630
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  21.901948183774948 Time :  1395
accuracy train: 0.976686 val: 0.946138 test: 0.940856
max validation accuracy : 0.946138 max acc epoch : 5 test accuracy : 0.940856
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  19.069632718339562 Time :  1415
accuracy train: 0.979555 val: 0.953252 test: 0.942412
max validation accuracy : 0.953252 max acc epoch : 6 test accuracy : 0.942412
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  15.825568987987936 Time :  1432
accuracy train: 0.983859 val: 0.950203 test: 0.945136
max validation accuracy : 0.953252 max acc epoch : 6 test accuracy : 0.942412
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  14.133404002524912 Time :  1451
accuracy train: 0.987984 val: 0.954268 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 8 test accuracy : 0.949027
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  13.358366653323174 Time :  1471
accuracy train: 0.989419 val: 0.947154 test: 0.945914
max validation accuracy : 0.954268 max acc epoch : 8 test accuracy : 0.949027
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  11.389138465281576 Time :  1490
accuracy train: 0.991392 val: 0.960366 test: 0.948249
max validation accuracy : 0.960366 max acc epoch : 10 test accuracy : 0.948249

Epoch :  11 loss training:  9.839038494974375 Time :  1511
accuracy train: 0.990854 val: 0.958333 test: 0.949027
max validation accuracy : 0.960366 max acc epoch : 10 test accuracy : 0.948249

Epoch :  12 loss training:  10.075390741229057 Time :  1531
accuracy train: 0.991571 val: 0.958333 test: 0.953696
max validation accuracy : 0.960366 max acc epoch : 10 test accuracy : 0.948249

Epoch :  13 loss training:  9.691198429558426 Time :  1550
accuracy train: 0.993006 val: 0.956301 test: 0.948638
max validation accuracy : 0.960366 max acc epoch : 10 test accuracy : 0.948249

Epoch :  14 loss training:  8.543630912899971 Time :  1570
accuracy train: 0.993185 val: 0.959350 test: 0.951751
max validation accuracy : 0.960366 max acc epoch : 10 test accuracy : 0.948249

Epoch :  15 loss training:  8.27652410324663 Time :  1590
accuracy train: 0.993544 val: 0.963415 test: 0.950195
max validation accuracy : 0.963415 max acc epoch : 15 test accuracy : 0.950195

Epoch :  16 loss training:  7.581862157676369 Time :  1611
accuracy train: 0.994261 val: 0.966463 test: 0.949416
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  17 loss training:  7.444731037132442 Time :  1634
accuracy train: 0.994978 val: 0.963415 test: 0.947082
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  18 loss training:  6.957389016635716 Time :  1655
accuracy train: 0.994440 val: 0.961382 test: 0.952140
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  19 loss training:  6.22550480463542 Time :  1677
accuracy train: 0.995696 val: 0.960366 test: 0.950195
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  20 loss training:  6.036648818990216 Time :  1697
accuracy train: 0.995516 val: 0.960366 test: 0.948249
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  21 loss training:  5.6104620872065425 Time :  1719
accuracy train: 0.995158 val: 0.959350 test: 0.948638
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  22 loss training:  5.18709532788489 Time :  1738
accuracy train: 0.995516 val: 0.960366 test: 0.950973
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  23 loss training:  5.201055594719946 Time :  1754
accuracy train: 0.995696 val: 0.958333 test: 0.949027
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  24 loss training:  5.227707898127846 Time :  1770
accuracy train: 0.995696 val: 0.958333 test: 0.950584
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  25 loss training:  5.265667374711484 Time :  1787
accuracy train: 0.996234 val: 0.957317 test: 0.949805
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  26 loss training:  4.653618826298043 Time :  1804
accuracy train: 0.996055 val: 0.959350 test: 0.950973
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  27 loss training:  4.326072707190178 Time :  1820
accuracy train: 0.996055 val: 0.957317 test: 0.950195
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  28 loss training:  4.241367685375735 Time :  1835
accuracy train: 0.996055 val: 0.962398 test: 0.947860
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  29 loss training:  4.015669034793973 Time :  1851
accuracy train: 0.996593 val: 0.960366 test: 0.953307
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  30 loss training:  3.86909907090012 Time :  1867
accuracy train: 0.996055 val: 0.965447 test: 0.951362
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  31 loss training:  3.7218059996375814 Time :  1884
accuracy train: 0.996413 val: 0.964431 test: 0.951362
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  32 loss training:  3.9109489691909403 Time :  1900
accuracy train: 0.996413 val: 0.960366 test: 0.952529
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  33 loss training:  3.7031229125568643 Time :  1918
accuracy train: 0.996234 val: 0.960366 test: 0.951751
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  34 loss training:  3.8156369372736663 Time :  1936
accuracy train: 0.996593 val: 0.961382 test: 0.951751
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  35 loss training:  3.0061495160334744 Time :  1954
accuracy train: 0.996234 val: 0.963415 test: 0.951362
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  36 loss training:  3.5175995164900087 Time :  1971
accuracy train: 0.996772 val: 0.961382 test: 0.951751
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  37 loss training:  3.2001896496512927 Time :  1987
accuracy train: 0.996772 val: 0.964431 test: 0.950973
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  38 loss training:  3.2989122545113787 Time :  2002
accuracy train: 0.996772 val: 0.962398 test: 0.950973
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  39 loss training:  3.1751025513513014 Time :  2019
accuracy train: 0.996772 val: 0.958333 test: 0.952140
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  40 loss training:  2.962158065289259 Time :  2036
accuracy train: 0.996772 val: 0.960366 test: 0.950973
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  41 loss training:  3.1697527968208306 Time :  2052
accuracy train: 0.996772 val: 0.961382 test: 0.954086
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  42 loss training:  3.025269669073168 Time :  2068
accuracy train: 0.996772 val: 0.965447 test: 0.956809
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  43 loss training:  3.3547446322918404 Time :  2084
accuracy train: 0.996593 val: 0.956301 test: 0.953696
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  44 loss training:  3.2700754576944746 Time :  2101
accuracy train: 0.996772 val: 0.961382 test: 0.956031
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  45 loss training:  3.1649003753555007 Time :  2118
accuracy train: 0.996593 val: 0.957317 test: 0.952140
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  46 loss training:  2.622240690572653 Time :  2135
accuracy train: 0.996772 val: 0.963415 test: 0.954475
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

Epoch :  47 loss training:  2.8656800774042495 Time :  2152
accuracy train: 0.996593 val: 0.960366 test: 0.953307
max validation accuracy : 0.966463 max acc epoch : 16 test accuracy : 0.949416

========================================================================================================================================================================================================
best acc epoch :  16
validation accuracy :  0.9664634146341463
test accuracy :  0.9494163424124513
last test_accuracy :  0.953307392996109
second best val :  0.9654471544715447
second best test :  0.9494163424124513
max gap 5
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  43 	 val_accuracy : 0.95935 	 test_accuracy : 0.95019 	 last test_accuracy : 0.95331 	 second best val : 0.95732 	 second best test : 0.94981
k :  1 	 best_acc epoch :  16 	 val_accuracy : 0.96646 	 test_accuracy : 0.94942 	 last test_accuracy : 0.95331 	 second best val : 0.96545 	 second best test : 0.94942

avg :  	 val_accuracy : 0.96291 	 test_accuracy : 0.94981 	 last_accuracy : 0.95331 	 second best val : 0.96138 	 second best test : 0.94961

std :  	 val_accuracy : 0.00356 	 test_accuracy : 0.00039 	 last_accuracy : 0.00000 	 second best val : 0.00407 	 second best test : 0.00019


date and time :  Sat Jul  3 18:37:42 2021
itr : 0
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=659, tsne=False, val_prop=0.15, weight_decay=1e-10)
device :  cuda:0
Counter({1: 5412, 0: 2508, 2: 1210})

Epoch :  1 loss training:  124.44497139006853 Time :  22
accuracy train: 0.896521 val: 0.899390 test: 0.890272
max validation accuracy : 0.899390 max acc epoch : 1 test accuracy : 0.890272
Counter({2: 3662, 1: 2847, 0: 2621})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.29051495343447 Time :  41
accuracy train: 0.946198 val: 0.943089 test: 0.915564
max validation accuracy : 0.943089 max acc epoch : 2 test accuracy : 0.915564
Counter({1: 3789, 0: 2776, 2: 2565})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  38.870862264186144 Time :  61
accuracy train: 0.950143 val: 0.935976 test: 0.918677
max validation accuracy : 0.943089 max acc epoch : 2 test accuracy : 0.915564
Counter({1: 3848, 0: 2781, 2: 2501})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  25.22325518168509 Time :  85
accuracy train: 0.977044 val: 0.948171 test: 0.938132
max validation accuracy : 0.948171 max acc epoch : 4 test accuracy : 0.938132
Counter({2: 3856, 1: 2776, 0: 2498})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  20.650098215788603 Time :  106
accuracy train: 0.977224 val: 0.943089 test: 0.931128
max validation accuracy : 0.948171 max acc epoch : 4 test accuracy : 0.938132
Counter({1: 3874, 0: 2791, 2: 2465})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  18.48164432635531 Time :  126
accuracy train: 0.979017 val: 0.948171 test: 0.945136
max validation accuracy : 0.948171 max acc epoch : 4 test accuracy : 0.938132
Counter({1: 3886, 0: 2778, 2: 2466})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  14.764303389005363 Time :  147
accuracy train: 0.985653 val: 0.956301 test: 0.946304
max validation accuracy : 0.956301 max acc epoch : 7 test accuracy : 0.946304
Counter({1: 3889, 2: 2751, 0: 2490})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  12.896833137609065 Time :  167
accuracy train: 0.985653 val: 0.956301 test: 0.946304
max validation accuracy : 0.956301 max acc epoch : 7 test accuracy : 0.946304
Counter({1: 3891, 0: 2763, 2: 2476})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  11.86711347522214 Time :  186
accuracy train: 0.989240 val: 0.950203 test: 0.946693
max validation accuracy : 0.956301 max acc epoch : 7 test accuracy : 0.946304
Counter({2: 3898, 0: 2761, 1: 2471})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  10.865620783530176 Time :  209
accuracy train: 0.989598 val: 0.954268 test: 0.948249
max validation accuracy : 0.956301 max acc epoch : 7 test accuracy : 0.946304
Counter({1: 3895, 0: 2767, 2: 2468})

Epoch :  11 loss training:  10.345863127149642 Time :  229
accuracy train: 0.989240 val: 0.954268 test: 0.949416
max validation accuracy : 0.956301 max acc epoch : 7 test accuracy : 0.946304
Counter({1: 3893, 0: 2766, 2: 2471})

Epoch :  12 loss training:  10.158104496076703 Time :  250
accuracy train: 0.991033 val: 0.951220 test: 0.945914
max validation accuracy : 0.956301 max acc epoch : 7 test accuracy : 0.946304
Counter({2: 3897, 0: 2776, 1: 2457})

Epoch :  13 loss training:  8.237449092324823 Time :  271
accuracy train: 0.991033 val: 0.956301 test: 0.950973
max validation accuracy : 0.956301 max acc epoch : 7 test accuracy : 0.946304
Counter({1: 3894, 2: 2785, 0: 2451})

Epoch :  14 loss training:  8.6027996763587 Time :  292
accuracy train: 0.993185 val: 0.953252 test: 0.944747
max validation accuracy : 0.956301 max acc epoch : 7 test accuracy : 0.946304
Counter({1: 3899, 0: 2808, 2: 2423})

Epoch :  15 loss training:  7.86009361827746 Time :  311
accuracy train: 0.994440 val: 0.952236 test: 0.950195
max validation accuracy : 0.956301 max acc epoch : 7 test accuracy : 0.946304
Counter({1: 3903, 0: 2821, 2: 2406})

Epoch :  16 loss training:  7.2762091513723135 Time :  332
accuracy train: 0.993723 val: 0.951220 test: 0.951362
max validation accuracy : 0.956301 max acc epoch : 7 test accuracy : 0.946304
Counter({1: 3903, 0: 2823, 2: 2404})

Epoch :  17 loss training:  7.184123694663867 Time :  354
accuracy train: 0.993544 val: 0.956301 test: 0.951362
max validation accuracy : 0.956301 max acc epoch : 7 test accuracy : 0.946304
Counter({1: 3907, 0: 2824, 2: 2399})

Epoch :  18 loss training:  6.078384216642007 Time :  375
accuracy train: 0.994261 val: 0.959350 test: 0.953696
max validation accuracy : 0.959350 max acc epoch : 18 test accuracy : 0.953696
Counter({2: 3915, 0: 2816, 1: 2399})

Epoch :  19 loss training:  6.189926795079373 Time :  396
accuracy train: 0.994620 val: 0.953252 test: 0.950584
max validation accuracy : 0.959350 max acc epoch : 18 test accuracy : 0.953696
Counter({1: 3918, 2: 2819, 0: 2393})

Epoch :  20 loss training:  6.083606853382662 Time :  417
accuracy train: 0.995158 val: 0.953252 test: 0.951751
max validation accuracy : 0.959350 max acc epoch : 18 test accuracy : 0.953696
Counter({2: 3921, 0: 2825, 1: 2384})

Epoch :  21 loss training:  5.117547956993803 Time :  440
accuracy train: 0.994978 val: 0.954268 test: 0.953307
max validation accuracy : 0.959350 max acc epoch : 18 test accuracy : 0.953696
Counter({1: 3922, 0: 2827, 2: 2381})

Epoch :  22 loss training:  5.166547229746357 Time :  462
accuracy train: 0.994799 val: 0.960366 test: 0.953307
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({2: 3921, 0: 2840, 1: 2369})

Epoch :  23 loss training:  5.281616692256648 Time :  484
accuracy train: 0.994978 val: 0.952236 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({2: 3922, 0: 2844, 1: 2364})

Epoch :  24 loss training:  5.011085590347648 Time :  503
accuracy train: 0.994978 val: 0.953252 test: 0.950973
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({2: 3925, 0: 2845, 1: 2360})

Epoch :  25 loss training:  4.745614989195019 Time :  527
accuracy train: 0.994978 val: 0.957317 test: 0.950973
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({0: 3921, 1: 2851, 2: 2358})

Epoch :  26 loss training:  4.929315477842465 Time :  550
accuracy train: 0.995696 val: 0.952236 test: 0.948249
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({1: 3921, 2: 2853, 0: 2356})

Epoch :  27 loss training:  4.733308684779331 Time :  571
accuracy train: 0.995516 val: 0.956301 test: 0.954086
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({1: 3920, 0: 2860, 2: 2350})

Epoch :  28 loss training:  4.623397377552465 Time :  593
accuracy train: 0.995516 val: 0.958333 test: 0.951751
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({1: 3921, 2: 2862, 0: 2347})

Epoch :  29 loss training:  4.4245391668519005 Time :  614
accuracy train: 0.996234 val: 0.958333 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({2: 3921, 1: 2862, 0: 2347})

Epoch :  30 loss training:  4.387926395284012 Time :  637
accuracy train: 0.996055 val: 0.954268 test: 0.949027
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({1: 3921, 0: 2865, 2: 2344})

Epoch :  31 loss training:  4.297278921352699 Time :  659
accuracy train: 0.996055 val: 0.960366 test: 0.949027
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({1: 3921, 0: 2875, 2: 2334})

Epoch :  32 loss training:  4.307868309435435 Time :  681
accuracy train: 0.996055 val: 0.954268 test: 0.948638
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({1: 3921, 0: 2876, 2: 2333})

Epoch :  33 loss training:  4.306412730016746 Time :  701
accuracy train: 0.996234 val: 0.952236 test: 0.949416
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({1: 3921, 0: 2875, 2: 2334})

Epoch :  34 loss training:  4.006284647213761 Time :  724
accuracy train: 0.996234 val: 0.955285 test: 0.949416
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({1: 3920, 0: 2880, 2: 2330})

Epoch :  35 loss training:  3.7952830181457102 Time :  746
accuracy train: 0.996593 val: 0.954268 test: 0.949805
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({2: 3919, 0: 2880, 1: 2331})

Epoch :  36 loss training:  4.022572593501536 Time :  766
accuracy train: 0.996593 val: 0.957317 test: 0.949416
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({1: 3894, 2: 2907, 0: 2329})

Epoch :  37 loss training:  3.701199102360988 Time :  788
accuracy train: 0.996593 val: 0.952236 test: 0.950584
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({1: 3920, 0: 2884, 2: 2326})

Epoch :  38 loss training:  3.314250280149281 Time :  809
accuracy train: 0.996772 val: 0.953252 test: 0.949027
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({1: 3920, 0: 2885, 2: 2325})

Epoch :  39 loss training:  3.0929969312855974 Time :  832
accuracy train: 0.996413 val: 0.954268 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({1: 3920, 0: 2885, 2: 2325})

Epoch :  40 loss training:  3.3140143841155805 Time :  854
accuracy train: 0.996234 val: 0.953252 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({1: 3919, 2: 2883, 0: 2328})

Epoch :  41 loss training:  3.4749625263066264 Time :  876
accuracy train: 0.996413 val: 0.954268 test: 0.949805
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({1: 3919, 0: 2885, 2: 2326})

Epoch :  42 loss training:  3.1033204330306035 Time :  898
accuracy train: 0.996772 val: 0.951220 test: 0.949027
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({0: 3919, 2: 2885, 1: 2326})

Epoch :  43 loss training:  2.8543035148468334 Time :  918
accuracy train: 0.996593 val: 0.952236 test: 0.949027
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({1: 3919, 0: 2885, 2: 2326})

Epoch :  44 loss training:  2.7723097885609604 Time :  939
accuracy train: 0.996593 val: 0.956301 test: 0.949805
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({1: 3893, 0: 2910, 2: 2327})

Epoch :  45 loss training:  2.603633805149002 Time :  959
accuracy train: 0.996234 val: 0.957317 test: 0.949805
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({1: 3892, 0: 2911, 2: 2327})

Epoch :  46 loss training:  2.6399911276239436 Time :  979
accuracy train: 0.996055 val: 0.958333 test: 0.949805
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({1: 3892, 0: 2911, 2: 2327})

Epoch :  47 loss training:  3.033506302454043 Time :  998
accuracy train: 0.996593 val: 0.951220 test: 0.949805
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({1: 3892, 0: 2911, 2: 2327})

Epoch :  48 loss training:  2.7098734052706277 Time :  1018
accuracy train: 0.996593 val: 0.951220 test: 0.949416
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({1: 3918, 0: 2886, 2: 2326})

Epoch :  49 loss training:  2.6703157328011002 Time :  1037
accuracy train: 0.996234 val: 0.950203 test: 0.949416
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({1: 3918, 0: 2885, 2: 2327})

Epoch :  50 loss training:  2.9144741098134546 Time :  1057
accuracy train: 0.996234 val: 0.949187 test: 0.945914
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({2: 3918, 0: 2885, 1: 2327})

Epoch :  51 loss training:  2.389993115531979 Time :  1076
accuracy train: 0.996593 val: 0.954268 test: 0.949027
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({2: 3918, 0: 2885, 1: 2327})

Epoch :  52 loss training:  2.4309429946588352 Time :  1095
accuracy train: 0.996772 val: 0.953252 test: 0.949416
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({1: 3918, 0: 2886, 2: 2326})

Epoch :  53 loss training:  2.7333590333291795 Time :  1114
accuracy train: 0.996772 val: 0.956301 test: 0.950584
max validation accuracy : 0.960366 max acc epoch : 22 test accuracy : 0.953307
Counter({2: 3918, 0: 2886, 1: 2326})

========================================================================================================================================================================================================
best acc epoch :  22
validation accuracy :  0.9603658536585366
test accuracy :  0.953307392996109
last test_accuracy :  0.9505836575875486
second best val :  0.959349593495935
second best test :  0.9536964980544748
max gap 11
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=361, tsne=False, val_prop=0.15, weight_decay=1e-10)
device :  cuda:0
Counter({0: 5412, 2: 2508, 1: 1210})

Epoch :  1 loss training:  125.39950998872519 Time :  1137
accuracy train: 0.919118 val: 0.895325 test: 0.890272
max validation accuracy : 0.895325 max acc epoch : 1 test accuracy : 0.890272
Counter({0: 3741, 2: 2868, 1: 2521})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  52.07880903407931 Time :  1160
accuracy train: 0.943149 val: 0.918699 test: 0.915953
max validation accuracy : 0.918699 max acc epoch : 2 test accuracy : 0.915953
Counter({1: 3859, 2: 2788, 0: 2483})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  40.07316417619586 Time :  1179
accuracy train: 0.955524 val: 0.927846 test: 0.919844
max validation accuracy : 0.927846 max acc epoch : 3 test accuracy : 0.919844
Counter({1: 3844, 0: 2698, 2: 2588})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  24.663690757006407 Time :  1198
accuracy train: 0.965567 val: 0.932927 test: 0.935798
max validation accuracy : 0.932927 max acc epoch : 4 test accuracy : 0.935798
Counter({2: 3844, 1: 2727, 0: 2559})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  20.635322188958526 Time :  1216
accuracy train: 0.974534 val: 0.941057 test: 0.940467
max validation accuracy : 0.941057 max acc epoch : 5 test accuracy : 0.940467
Counter({1: 3856, 2: 2788, 0: 2486})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  18.704094268381596 Time :  1233
accuracy train: 0.981528 val: 0.948171 test: 0.945136
max validation accuracy : 0.948171 max acc epoch : 6 test accuracy : 0.945136
Counter({1: 3875, 2: 2810, 0: 2445})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  14.617955562658608 Time :  1252
accuracy train: 0.983859 val: 0.944106 test: 0.947860
max validation accuracy : 0.948171 max acc epoch : 6 test accuracy : 0.945136
Counter({1: 3882, 2: 2809, 0: 2439})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  13.537351501174271 Time :  1270
accuracy train: 0.984218 val: 0.942073 test: 0.947082
max validation accuracy : 0.948171 max acc epoch : 6 test accuracy : 0.945136
Counter({1: 3883, 2: 2808, 0: 2439})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  11.445034788921475 Time :  1292
accuracy train: 0.989240 val: 0.950203 test: 0.944747
max validation accuracy : 0.950203 max acc epoch : 9 test accuracy : 0.944747
Counter({1: 3884, 0: 2822, 2: 2424})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  11.273018205538392 Time :  1312
accuracy train: 0.987805 val: 0.944106 test: 0.949027
max validation accuracy : 0.950203 max acc epoch : 9 test accuracy : 0.944747
Counter({1: 3886, 2: 2822, 0: 2422})

Epoch :  11 loss training:  10.460664798505604 Time :  1335
accuracy train: 0.988702 val: 0.942073 test: 0.947860
max validation accuracy : 0.950203 max acc epoch : 9 test accuracy : 0.944747
Counter({1: 3888, 2: 2820, 0: 2422})

Epoch :  12 loss training:  9.295480570290238 Time :  1356
accuracy train: 0.992109 val: 0.946138 test: 0.945914
max validation accuracy : 0.950203 max acc epoch : 9 test accuracy : 0.944747
Counter({1: 3892, 2: 2820, 0: 2418})

Epoch :  13 loss training:  8.399536589626223 Time :  1379
accuracy train: 0.992647 val: 0.945122 test: 0.947860
max validation accuracy : 0.950203 max acc epoch : 9 test accuracy : 0.944747
Counter({1: 3892, 0: 2821, 2: 2417})

Epoch :  14 loss training:  7.701612624339759 Time :  1402
accuracy train: 0.992468 val: 0.942073 test: 0.945914
max validation accuracy : 0.950203 max acc epoch : 9 test accuracy : 0.944747
Counter({1: 3894, 2: 2821, 0: 2415})

Epoch :  15 loss training:  7.31354304542765 Time :  1422
accuracy train: 0.991571 val: 0.946138 test: 0.949027
max validation accuracy : 0.950203 max acc epoch : 9 test accuracy : 0.944747
Counter({1: 3900, 0: 2822, 2: 2408})

Epoch :  16 loss training:  7.103445501532406 Time :  1445
accuracy train: 0.993723 val: 0.945122 test: 0.951362
max validation accuracy : 0.950203 max acc epoch : 9 test accuracy : 0.944747
Counter({0: 3908, 2: 2826, 1: 2396})

Epoch :  17 loss training:  6.186468436615542 Time :  1467
accuracy train: 0.994261 val: 0.944106 test: 0.947471
max validation accuracy : 0.950203 max acc epoch : 9 test accuracy : 0.944747
Counter({2: 3910, 0: 2827, 1: 2393})

Epoch :  18 loss training:  6.111428308533505 Time :  1490
accuracy train: 0.994799 val: 0.949187 test: 0.950195
max validation accuracy : 0.950203 max acc epoch : 9 test accuracy : 0.944747
Counter({2: 3910, 1: 2828, 0: 2392})

Epoch :  19 loss training:  5.805973986629397 Time :  1512
accuracy train: 0.994082 val: 0.943089 test: 0.950195
max validation accuracy : 0.950203 max acc epoch : 9 test accuracy : 0.944747
Counter({1: 3910, 2: 2829, 0: 2391})

Epoch :  20 loss training:  5.119949830579571 Time :  1534
accuracy train: 0.996234 val: 0.948171 test: 0.952918
max validation accuracy : 0.950203 max acc epoch : 9 test accuracy : 0.944747
Counter({1: 3915, 0: 2831, 2: 2384})

Epoch :  21 loss training:  4.976235115667805 Time :  1555
accuracy train: 0.995516 val: 0.947154 test: 0.947860
max validation accuracy : 0.950203 max acc epoch : 9 test accuracy : 0.944747
Counter({1: 3916, 0: 2837, 2: 2377})

Epoch :  22 loss training:  4.680658814497292 Time :  1577
accuracy train: 0.996234 val: 0.946138 test: 0.946693
max validation accuracy : 0.950203 max acc epoch : 9 test accuracy : 0.944747
Counter({2: 3915, 1: 2844, 0: 2371})

Epoch :  23 loss training:  4.054454496130347 Time :  1600
accuracy train: 0.995696 val: 0.951220 test: 0.945525
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3915, 2: 2844, 0: 2371})

Epoch :  24 loss training:  3.891592762200162 Time :  1622
accuracy train: 0.996234 val: 0.949187 test: 0.947471
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3915, 2: 2844, 0: 2371})

Epoch :  25 loss training:  4.14104639692232 Time :  1643
accuracy train: 0.996593 val: 0.946138 test: 0.951362
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3915, 0: 2843, 2: 2372})

Epoch :  26 loss training:  3.741454274044372 Time :  1664
accuracy train: 0.996234 val: 0.946138 test: 0.949416
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({2: 3915, 1: 2849, 0: 2366})

Epoch :  27 loss training:  4.082117784186266 Time :  1687
accuracy train: 0.996772 val: 0.942073 test: 0.953307
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({0: 3917, 2: 2848, 1: 2365})

Epoch :  28 loss training:  4.2568946942919865 Time :  1707
accuracy train: 0.996413 val: 0.948171 test: 0.948249
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3913, 2: 2857, 0: 2360})

Epoch :  29 loss training:  3.9274293059133925 Time :  1729
accuracy train: 0.997131 val: 0.948171 test: 0.951362
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3913, 2: 2857, 0: 2360})

Epoch :  30 loss training:  3.3244238766492344 Time :  1750
accuracy train: 0.996772 val: 0.947154 test: 0.949805
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3913, 2: 2858, 0: 2359})

Epoch :  31 loss training:  2.7700384294148535 Time :  1773
accuracy train: 0.996951 val: 0.943089 test: 0.947471
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3913, 2: 2860, 0: 2357})

Epoch :  32 loss training:  3.2923125588567927 Time :  1795
accuracy train: 0.996593 val: 0.944106 test: 0.948638
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3913, 0: 2858, 2: 2359})

Epoch :  33 loss training:  3.3802285022684373 Time :  1816
accuracy train: 0.996951 val: 0.947154 test: 0.949805
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3915, 2: 2858, 0: 2357})

Epoch :  34 loss training:  2.6547319393139333 Time :  1838
accuracy train: 0.996772 val: 0.946138 test: 0.947082
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3915, 2: 2860, 0: 2355})

Epoch :  35 loss training:  2.7517824696551543 Time :  1858
accuracy train: 0.997310 val: 0.950203 test: 0.946304
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3919, 2: 2857, 0: 2354})

Epoch :  36 loss training:  2.963953419297468 Time :  1877
accuracy train: 0.997310 val: 0.943089 test: 0.947082
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3919, 2: 2857, 0: 2354})

Epoch :  37 loss training:  2.5871476109605283 Time :  1901
accuracy train: 0.997310 val: 0.945122 test: 0.947860
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3919, 2: 2857, 0: 2354})

Epoch :  38 loss training:  2.787111400451977 Time :  1921
accuracy train: 0.997131 val: 0.950203 test: 0.946304
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3919, 2: 2860, 0: 2351})

Epoch :  39 loss training:  2.4628983621660154 Time :  1944
accuracy train: 0.997310 val: 0.943089 test: 0.948249
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3919, 2: 2862, 0: 2349})

Epoch :  40 loss training:  2.2412153847981244 Time :  1965
accuracy train: 0.996951 val: 0.946138 test: 0.950195
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3917, 2: 2863, 0: 2350})

Epoch :  41 loss training:  2.1531543909804896 Time :  1983
accuracy train: 0.996951 val: 0.944106 test: 0.949416
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3917, 2: 2865, 0: 2348})

Epoch :  42 loss training:  2.3798756437317934 Time :  2002
accuracy train: 0.997489 val: 0.944106 test: 0.950195
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3917, 2: 2865, 0: 2348})

Epoch :  43 loss training:  2.1522313698078506 Time :  2021
accuracy train: 0.997310 val: 0.946138 test: 0.948249
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3917, 2: 2864, 0: 2349})

Epoch :  44 loss training:  2.1704213653865736 Time :  2040
accuracy train: 0.997310 val: 0.941057 test: 0.949805
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3917, 2: 2865, 0: 2348})

Epoch :  45 loss training:  2.370720249149599 Time :  2060
accuracy train: 0.997489 val: 0.943089 test: 0.947082
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3917, 2: 2865, 0: 2348})

Epoch :  46 loss training:  2.188619910470152 Time :  2078
accuracy train: 0.997131 val: 0.948171 test: 0.947471
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({0: 3917, 2: 2866, 1: 2347})

Epoch :  47 loss training:  2.5316559109196533 Time :  2098
accuracy train: 0.997310 val: 0.945122 test: 0.944747
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3917, 2: 2865, 0: 2348})

Epoch :  48 loss training:  2.1185298879427137 Time :  2117
accuracy train: 0.997131 val: 0.941057 test: 0.947082
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3917, 2: 2870, 0: 2343})

Epoch :  49 loss training:  1.8025405736480025 Time :  2140
accuracy train: 0.997131 val: 0.941057 test: 0.947471
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({0: 3917, 2: 2870, 1: 2343})

Epoch :  50 loss training:  2.111982318732771 Time :  2161
accuracy train: 0.997131 val: 0.945122 test: 0.947082
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3917, 0: 2876, 2: 2337})

Epoch :  51 loss training:  1.9064385708552436 Time :  2183
accuracy train: 0.997131 val: 0.943089 test: 0.949416
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3918, 2: 2875, 0: 2337})

Epoch :  52 loss training:  1.8358331126655685 Time :  2206
accuracy train: 0.997131 val: 0.940041 test: 0.951362
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3919, 2: 2874, 0: 2337})

Epoch :  53 loss training:  1.8989919906307478 Time :  2228
accuracy train: 0.997131 val: 0.944106 test: 0.950195
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3919, 0: 2874, 2: 2337})

Epoch :  54 loss training:  2.0606615449796664 Time :  2250
accuracy train: 0.997310 val: 0.942073 test: 0.951362
max validation accuracy : 0.951220 max acc epoch : 23 test accuracy : 0.945525
Counter({1: 3921, 2: 2872, 0: 2337})

========================================================================================================================================================================================================
best acc epoch :  23
validation accuracy :  0.9512195121951219
test accuracy :  0.9455252918287937
last test_accuracy :  0.9513618677042801
second best val :  0.9502032520325203
second best test :  0.9447470817120622
max gap 14
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  22 	 val_accuracy : 0.96037 	 test_accuracy : 0.95331 	 last test_accuracy : 0.95058 	 second best val : 0.95935 	 second best test : 0.95370
k :  1 	 best_acc epoch :  23 	 val_accuracy : 0.95122 	 test_accuracy : 0.94553 	 last test_accuracy : 0.95136 	 second best val : 0.95020 	 second best test : 0.94475

avg :  	 val_accuracy : 0.95579 	 test_accuracy : 0.94942 	 last_accuracy : 0.95097 	 second best val : 0.95478 	 second best test : 0.94922

std :  	 val_accuracy : 0.00457 	 test_accuracy : 0.00389 	 last_accuracy : 0.00039 	 second best val : 0.00457 	 second best test : 0.00447
