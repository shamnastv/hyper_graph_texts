

date and time :  Sun Jun 20 16:29:38 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=2, num_exp=2, num_layers=2, num_mlp_layers=1, random_vec=False, seed=176, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  58.32976856082678 Time :  11
accuracy train: 0.950599 val: 0.936970 test: 0.947489
max validation accuracy : 0.936970 max acc epoch : 1 test accuracy : 0.947489
Counter({0: 3962, 1: 3729})

Epoch :  2 loss training:  22.67065914720297 Time :  23
accuracy train: 0.961292 val: 0.939394 test: 0.964840
max validation accuracy : 0.939394 max acc epoch : 2 test accuracy : 0.964840
Counter({0: 4047, 1: 3644})

Epoch :  3 loss training:  15.908338975161314 Time :  34
accuracy train: 0.971129 val: 0.955152 test: 0.962100
max validation accuracy : 0.955152 max acc epoch : 3 test accuracy : 0.962100
Counter({1: 3974, 0: 3717})

Epoch :  4 loss training:  12.847461329540238 Time :  46
accuracy train: 0.964927 val: 0.946667 test: 0.961644
max validation accuracy : 0.955152 max acc epoch : 3 test accuracy : 0.962100
Counter({0: 3938, 1: 3753})

Epoch :  5 loss training:  12.270714758895338 Time :  57
accuracy train: 0.979683 val: 0.963636 test: 0.966667
max validation accuracy : 0.963636 max acc epoch : 5 test accuracy : 0.966667
Counter({1: 3899, 0: 3792})

Epoch :  6 loss training:  11.669229423627257 Time :  68
accuracy train: 0.978828 val: 0.955152 test: 0.964840
max validation accuracy : 0.963636 max acc epoch : 5 test accuracy : 0.966667
Counter({0: 3925, 1: 3766})

Epoch :  7 loss training:  10.883584652096033 Time :  80
accuracy train: 0.979683 val: 0.961212 test: 0.965297
max validation accuracy : 0.963636 max acc epoch : 5 test accuracy : 0.966667
Counter({1: 3863, 0: 3828})

Epoch :  8 loss training:  10.227587513625622 Time :  91
accuracy train: 0.983747 val: 0.958788 test: 0.959817
max validation accuracy : 0.963636 max acc epoch : 5 test accuracy : 0.966667
Counter({0: 3854, 1: 3837})

Epoch :  9 loss training:  9.884609320666641 Time :  102
accuracy train: 0.987169 val: 0.961212 test: 0.968037
max validation accuracy : 0.963636 max acc epoch : 5 test accuracy : 0.966667
Counter({0: 3872, 1: 3819})

Epoch :  10 loss training:  8.455977217294276 Time :  114
accuracy train: 0.984388 val: 0.967273 test: 0.959361
max validation accuracy : 0.967273 max acc epoch : 10 test accuracy : 0.959361
Counter({0: 3854, 1: 3837})

Epoch :  11 loss training:  8.041141787776724 Time :  126
accuracy train: 0.982464 val: 0.957576 test: 0.964384
max validation accuracy : 0.967273 max acc epoch : 10 test accuracy : 0.959361
Counter({1: 3921, 0: 3770})

Epoch :  12 loss training:  6.4479872529627755 Time :  138
accuracy train: 0.992943 val: 0.966061 test: 0.968493
max validation accuracy : 0.967273 max acc epoch : 10 test accuracy : 0.959361
Counter({0: 3848, 1: 3843})

Epoch :  13 loss training:  6.548725142376497 Time :  150
accuracy train: 0.986313 val: 0.960000 test: 0.966210
max validation accuracy : 0.967273 max acc epoch : 10 test accuracy : 0.959361
Counter({0: 3956, 1: 3735})

Epoch :  14 loss training:  6.699679187149741 Time :  162
accuracy train: 0.994440 val: 0.967273 test: 0.970320
max validation accuracy : 0.967273 max acc epoch : 10 test accuracy : 0.959361
Counter({0: 3964, 1: 3727})

Epoch :  15 loss training:  4.244204512739088 Time :  174
accuracy train: 0.994867 val: 0.967273 test: 0.974429
max validation accuracy : 0.967273 max acc epoch : 10 test accuracy : 0.959361
Counter({0: 3854, 1: 3837})

Epoch :  16 loss training:  4.069169519236311 Time :  186
accuracy train: 0.996151 val: 0.968485 test: 0.966667
max validation accuracy : 0.968485 max acc epoch : 16 test accuracy : 0.966667
Counter({1: 3874, 0: 3817})

Epoch :  17 loss training:  3.4503991952515207 Time :  198
accuracy train: 0.996364 val: 0.972121 test: 0.966667
max validation accuracy : 0.972121 max acc epoch : 17 test accuracy : 0.966667
Counter({0: 3865, 1: 3826})

Epoch :  18 loss training:  2.6221947837038897 Time :  211
accuracy train: 0.996151 val: 0.967273 test: 0.972146
max validation accuracy : 0.972121 max acc epoch : 17 test accuracy : 0.966667
Counter({0: 3848, 1: 3843})

Epoch :  19 loss training:  2.4540616883023176 Time :  223
accuracy train: 0.996578 val: 0.970909 test: 0.968037
max validation accuracy : 0.972121 max acc epoch : 17 test accuracy : 0.966667
Counter({0: 3897, 1: 3794})

Epoch :  20 loss training:  2.2983530269702896 Time :  235
accuracy train: 0.996364 val: 0.970909 test: 0.967580
max validation accuracy : 0.972121 max acc epoch : 17 test accuracy : 0.966667
Counter({0: 3896, 1: 3795})

Epoch :  21 loss training:  2.781111334101297 Time :  247
accuracy train: 0.996792 val: 0.972121 test: 0.968493
max validation accuracy : 0.972121 max acc epoch : 17 test accuracy : 0.966667
Counter({1: 3907, 0: 3784})

Epoch :  22 loss training:  1.844839662691811 Time :  259
accuracy train: 0.997648 val: 0.967273 test: 0.973516
max validation accuracy : 0.972121 max acc epoch : 17 test accuracy : 0.966667
Counter({0: 3920, 1: 3771})

Epoch :  23 loss training:  1.5910651154117659 Time :  271
accuracy train: 0.997006 val: 0.967273 test: 0.969406
max validation accuracy : 0.972121 max acc epoch : 17 test accuracy : 0.966667
Counter({1: 3904, 0: 3787})

Epoch :  24 loss training:  1.7052466071472736 Time :  283
accuracy train: 0.997434 val: 0.970909 test: 0.968950
max validation accuracy : 0.972121 max acc epoch : 17 test accuracy : 0.966667
Counter({1: 3906, 0: 3785})

Epoch :  25 loss training:  1.3917177698422165 Time :  295
accuracy train: 0.997220 val: 0.970909 test: 0.967123
max validation accuracy : 0.972121 max acc epoch : 17 test accuracy : 0.966667
Counter({0: 3902, 1: 3789})

Epoch :  26 loss training:  1.669533842454257 Time :  307
accuracy train: 0.997006 val: 0.967273 test: 0.969863
max validation accuracy : 0.972121 max acc epoch : 17 test accuracy : 0.966667
Counter({1: 3896, 0: 3795})

Epoch :  27 loss training:  1.7307832355290884 Time :  319
accuracy train: 0.994012 val: 0.966061 test: 0.959817
max validation accuracy : 0.972121 max acc epoch : 17 test accuracy : 0.966667
Counter({1: 3914, 0: 3777})

Epoch :  28 loss training:  2.2444603279727744 Time :  331
accuracy train: 0.996792 val: 0.972121 test: 0.968037
max validation accuracy : 0.972121 max acc epoch : 17 test accuracy : 0.966667
Counter({0: 3906, 1: 3785})

Epoch :  29 loss training:  1.8159153023734689 Time :  342
accuracy train: 0.996364 val: 0.964848 test: 0.969863
max validation accuracy : 0.972121 max acc epoch : 17 test accuracy : 0.966667
Counter({1: 3894, 0: 3797})

Epoch :  30 loss training:  1.4829156139203405 Time :  354
accuracy train: 0.996578 val: 0.969697 test: 0.971233
max validation accuracy : 0.972121 max acc epoch : 17 test accuracy : 0.966667
Counter({0: 3914, 1: 3777})

Epoch :  31 loss training:  1.8870065043811337 Time :  366
accuracy train: 0.997220 val: 0.967273 test: 0.964840
max validation accuracy : 0.972121 max acc epoch : 17 test accuracy : 0.966667
Counter({1: 3912, 0: 3779})

Epoch :  32 loss training:  1.548952796154481 Time :  378
accuracy train: 0.997006 val: 0.972121 test: 0.970320
max validation accuracy : 0.972121 max acc epoch : 17 test accuracy : 0.966667
Counter({0: 3913, 1: 3778})

Epoch :  33 loss training:  1.5583514417558035 Time :  390
accuracy train: 0.997220 val: 0.963636 test: 0.968493
max validation accuracy : 0.972121 max acc epoch : 17 test accuracy : 0.966667
Counter({1: 3899, 0: 3792})

Epoch :  34 loss training:  1.7016797067808511 Time :  402
accuracy train: 0.997006 val: 0.963636 test: 0.965297
max validation accuracy : 0.972121 max acc epoch : 17 test accuracy : 0.966667
Counter({1: 3864, 0: 3827})

Epoch :  35 loss training:  1.8696634470616118 Time :  415
accuracy train: 0.997006 val: 0.969697 test: 0.965753
max validation accuracy : 0.972121 max acc epoch : 17 test accuracy : 0.966667
Counter({1: 3899, 0: 3792})

Epoch :  36 loss training:  1.8468840357745648 Time :  427
accuracy train: 0.997220 val: 0.973333 test: 0.968037
max validation accuracy : 0.973333 max acc epoch : 36 test accuracy : 0.968037
Counter({0: 3899, 1: 3792})

Epoch :  37 loss training:  1.4555674245821137 Time :  439
accuracy train: 0.997434 val: 0.970909 test: 0.968037
max validation accuracy : 0.973333 max acc epoch : 36 test accuracy : 0.968037
Counter({0: 3908, 1: 3783})

Epoch :  38 loss training:  1.7038644697604468 Time :  451
accuracy train: 0.996792 val: 0.962424 test: 0.963470
max validation accuracy : 0.973333 max acc epoch : 36 test accuracy : 0.968037
Counter({1: 3897, 0: 3794})

Epoch :  39 loss training:  1.7622957029088866 Time :  463
accuracy train: 0.997006 val: 0.970909 test: 0.965753
max validation accuracy : 0.973333 max acc epoch : 36 test accuracy : 0.968037
Counter({0: 3903, 1: 3788})

Epoch :  40 loss training:  1.221100083363126 Time :  475
accuracy train: 0.997434 val: 0.969697 test: 0.969863
max validation accuracy : 0.973333 max acc epoch : 36 test accuracy : 0.968037
Counter({1: 3890, 0: 3801})

Epoch :  41 loss training:  1.5889663433335954 Time :  486
accuracy train: 0.997220 val: 0.961212 test: 0.966210
max validation accuracy : 0.973333 max acc epoch : 36 test accuracy : 0.968037
Counter({1: 3865, 0: 3826})

Epoch :  42 loss training:  1.5357158173610514 Time :  498
accuracy train: 0.997220 val: 0.967273 test: 0.970320
max validation accuracy : 0.973333 max acc epoch : 36 test accuracy : 0.968037
Counter({1: 3900, 0: 3791})

Epoch :  43 loss training:  1.4971568055098032 Time :  510
accuracy train: 0.997434 val: 0.962424 test: 0.969406
max validation accuracy : 0.973333 max acc epoch : 36 test accuracy : 0.968037
Counter({0: 3904, 1: 3787})

Epoch :  44 loss training:  1.4392583917542652 Time :  521
accuracy train: 0.997006 val: 0.968485 test: 0.973059
max validation accuracy : 0.973333 max acc epoch : 36 test accuracy : 0.968037
Counter({1: 3908, 0: 3783})

Epoch :  45 loss training:  1.8320507421540242 Time :  533
accuracy train: 0.997220 val: 0.969697 test: 0.969863
max validation accuracy : 0.973333 max acc epoch : 36 test accuracy : 0.968037
Counter({1: 3894, 0: 3797})

Epoch :  46 loss training:  1.8610242749928148 Time :  545
accuracy train: 0.995509 val: 0.960000 test: 0.963927
max validation accuracy : 0.973333 max acc epoch : 36 test accuracy : 0.968037
Counter({0: 3858, 1: 3833})

Epoch :  47 loss training:  1.4700382423397969 Time :  557
accuracy train: 0.997434 val: 0.968485 test: 0.970776
max validation accuracy : 0.973333 max acc epoch : 36 test accuracy : 0.968037
Counter({0: 3889, 1: 3802})

Epoch :  48 loss training:  1.4740003907463688 Time :  569
accuracy train: 0.997434 val: 0.972121 test: 0.968950
max validation accuracy : 0.973333 max acc epoch : 36 test accuracy : 0.968037
Counter({1: 3894, 0: 3797})

Epoch :  49 loss training:  1.5395519797493762 Time :  581
accuracy train: 0.997220 val: 0.967273 test: 0.969863
max validation accuracy : 0.973333 max acc epoch : 36 test accuracy : 0.968037
Counter({1: 3885, 0: 3806})

Epoch :  50 loss training:  1.6355299997485417 Time :  593
accuracy train: 0.997434 val: 0.974545 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 50 test accuracy : 0.968950
Counter({0: 3899, 1: 3792})

Epoch :  51 loss training:  2.1551104627524182 Time :  605
accuracy train: 0.981180 val: 0.932121 test: 0.953425
max validation accuracy : 0.974545 max acc epoch : 50 test accuracy : 0.968950
Counter({0: 3993, 1: 3698})

Epoch :  52 loss training:  1.5649063014934654 Time :  617
accuracy train: 0.997220 val: 0.973333 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 50 test accuracy : 0.968950
Counter({1: 3875, 0: 3816})

Epoch :  53 loss training:  1.353972568991594 Time :  629
accuracy train: 0.997861 val: 0.967273 test: 0.965753
max validation accuracy : 0.974545 max acc epoch : 50 test accuracy : 0.968950
Counter({0: 3888, 1: 3803})

Epoch :  54 loss training:  1.5091878858329437 Time :  641
accuracy train: 0.997434 val: 0.968485 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 50 test accuracy : 0.968950
Counter({1: 3895, 0: 3796})

Epoch :  55 loss training:  1.4091682454636612 Time :  653
accuracy train: 0.997648 val: 0.958788 test: 0.963927
max validation accuracy : 0.974545 max acc epoch : 50 test accuracy : 0.968950
Counter({1: 3869, 0: 3822})

Epoch :  56 loss training:  1.2749237331663608 Time :  665
accuracy train: 0.997861 val: 0.968485 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 50 test accuracy : 0.968950
Counter({0: 3884, 1: 3807})

Epoch :  57 loss training:  1.2405319281815537 Time :  677
accuracy train: 0.997220 val: 0.969697 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 50 test accuracy : 0.968950
Counter({1: 3894, 0: 3797})

Epoch :  58 loss training:  1.2397943219611989 Time :  689
accuracy train: 0.997220 val: 0.975758 test: 0.969406
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({1: 3894, 0: 3797})

Epoch :  59 loss training:  1.0962893248643013 Time :  701
accuracy train: 0.997648 val: 0.972121 test: 0.965753
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({1: 3903, 0: 3788})

Epoch :  60 loss training:  1.0941439531688957 Time :  713
accuracy train: 0.997434 val: 0.970909 test: 0.968950
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({0: 3894, 1: 3797})

Epoch :  61 loss training:  1.0573291450900797 Time :  725
accuracy train: 0.997220 val: 0.969697 test: 0.968493
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({1: 3910, 0: 3781})

Epoch :  62 loss training:  1.1053307912611672 Time :  737
accuracy train: 0.997648 val: 0.969697 test: 0.966210
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({1: 3912, 0: 3779})

Epoch :  63 loss training:  1.348112383168882 Time :  749
accuracy train: 0.997220 val: 0.973333 test: 0.967580
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({0: 3907, 1: 3784})

Epoch :  64 loss training:  1.1594642955151357 Time :  761
accuracy train: 0.997861 val: 0.972121 test: 0.966667
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({1: 3907, 0: 3784})

Epoch :  65 loss training:  1.3510736600455857 Time :  773
accuracy train: 0.997220 val: 0.972121 test: 0.966210
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({0: 3903, 1: 3788})

Epoch :  66 loss training:  1.1922796581363855 Time :  784
accuracy train: 0.997006 val: 0.970909 test: 0.964840
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({1: 3909, 0: 3782})

Epoch :  67 loss training:  1.0635052220841317 Time :  796
accuracy train: 0.997861 val: 0.968485 test: 0.967580
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({1: 3913, 0: 3778})

Epoch :  68 loss training:  1.125740162754937 Time :  808
accuracy train: 0.997861 val: 0.970909 test: 0.967123
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({0: 3904, 1: 3787})

Epoch :  69 loss training:  1.708711237019088 Time :  820
accuracy train: 0.997434 val: 0.960000 test: 0.963470
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({1: 3862, 0: 3829})

Epoch :  70 loss training:  1.5043147351480002 Time :  832
accuracy train: 0.997648 val: 0.964848 test: 0.957991
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({0: 3854, 1: 3837})

Epoch :  71 loss training:  1.621381559772999 Time :  844
accuracy train: 0.997434 val: 0.963636 test: 0.969863
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({1: 3849, 0: 3842})

Epoch :  72 loss training:  1.2154888848162955 Time :  856
accuracy train: 0.997434 val: 0.973333 test: 0.968950
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({0: 3869, 1: 3822})

Epoch :  73 loss training:  1.3652919146097702 Time :  868
accuracy train: 0.998075 val: 0.967273 test: 0.965753
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({0: 3882, 1: 3809})

Epoch :  74 loss training:  1.189144068681344 Time :  880
accuracy train: 0.997861 val: 0.957576 test: 0.959817
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({0: 3846, 1: 3845})

Epoch :  75 loss training:  1.3733938352161204 Time :  892
accuracy train: 0.997861 val: 0.968485 test: 0.967123
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({1: 3888, 0: 3803})

Epoch :  76 loss training:  1.1490124934889536 Time :  904
accuracy train: 0.997434 val: 0.964848 test: 0.968950
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({1: 3882, 0: 3809})

Epoch :  77 loss training:  1.3179817678374093 Time :  916
accuracy train: 0.997648 val: 0.964848 test: 0.961644
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({0: 3864, 1: 3827})

Epoch :  78 loss training:  1.18227016674291 Time :  928
accuracy train: 0.997648 val: 0.966061 test: 0.967123
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({1: 3878, 0: 3813})

Epoch :  79 loss training:  0.9822396402150844 Time :  940
accuracy train: 0.997861 val: 0.968485 test: 0.966667
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({1: 3863, 0: 3828})

Epoch :  80 loss training:  1.0812294880646505 Time :  952
accuracy train: 0.997648 val: 0.969697 test: 0.965753
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({1: 3878, 0: 3813})

Epoch :  81 loss training:  0.9711557580853878 Time :  964
accuracy train: 0.997434 val: 0.969697 test: 0.967123
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({1: 3891, 0: 3800})

Epoch :  82 loss training:  1.2301035128889453 Time :  976
accuracy train: 0.997648 val: 0.969697 test: 0.968950
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({0: 3890, 1: 3801})

Epoch :  83 loss training:  1.1687356007769267 Time :  988
accuracy train: 0.997861 val: 0.968485 test: 0.967580
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({0: 3889, 1: 3802})

Epoch :  84 loss training:  0.8874443949612214 Time :  1000
accuracy train: 0.997861 val: 0.964848 test: 0.961187
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({1: 3883, 0: 3808})

Epoch :  85 loss training:  1.2562712086746615 Time :  1012
accuracy train: 0.997434 val: 0.969697 test: 0.965753
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({0: 3869, 1: 3822})

Epoch :  86 loss training:  0.9297518207959001 Time :  1024
accuracy train: 0.997648 val: 0.969697 test: 0.964384
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({1: 3891, 0: 3800})

Epoch :  87 loss training:  1.2025807225245444 Time :  1036
accuracy train: 0.997220 val: 0.970909 test: 0.968037
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({0: 3890, 1: 3801})

Epoch :  88 loss training:  1.0692196190993855 Time :  1047
accuracy train: 0.997648 val: 0.970909 test: 0.964840
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({1: 3894, 0: 3797})

Epoch :  89 loss training:  1.3219218034191726 Time :  1059
accuracy train: 0.995081 val: 0.955152 test: 0.957534
max validation accuracy : 0.975758 max acc epoch : 58 test accuracy : 0.969406
Counter({0: 3855, 1: 3836})

========================================================================================================================================================================================================
best acc epoch :  58
validation accuracy :  0.9757575757575757
test accuracy :  0.9694063926940639
last test_accuracy :  0.9575342465753425
second best val :  0.9745454545454545
second best test :  0.9689497716894977
max gap 19
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=2, num_exp=2, num_layers=2, num_mlp_layers=1, random_vec=False, seed=925, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({0: 4721, 1: 2970})

Epoch :  1 loss training:  53.617065113037825 Time :  1074
accuracy train: 0.949102 val: 0.935758 test: 0.960731
max validation accuracy : 0.935758 max acc epoch : 1 test accuracy : 0.960731
Counter({1: 4108, 0: 3583})

Epoch :  2 loss training:  19.518710512667894 Time :  1086
accuracy train: 0.967921 val: 0.945455 test: 0.963014
max validation accuracy : 0.945455 max acc epoch : 2 test accuracy : 0.963014
Counter({1: 4036, 0: 3655})

Epoch :  3 loss training:  16.267547300085425 Time :  1097
accuracy train: 0.963430 val: 0.936970 test: 0.958447
max validation accuracy : 0.945455 max acc epoch : 2 test accuracy : 0.963014
Counter({1: 4050, 0: 3641})

Epoch :  4 loss training:  12.986283434554935 Time :  1108
accuracy train: 0.976689 val: 0.946667 test: 0.963014
max validation accuracy : 0.946667 max acc epoch : 4 test accuracy : 0.963014
Counter({0: 3921, 1: 3770})

Epoch :  5 loss training:  11.761093309265561 Time :  1120
accuracy train: 0.980967 val: 0.961212 test: 0.966210
max validation accuracy : 0.961212 max acc epoch : 5 test accuracy : 0.966210
Counter({0: 3926, 1: 3765})

Epoch :  6 loss training:  9.961566631216556 Time :  1131
accuracy train: 0.980539 val: 0.958788 test: 0.962557
max validation accuracy : 0.961212 max acc epoch : 5 test accuracy : 0.966210
Counter({1: 3969, 0: 3722})

Epoch :  7 loss training:  10.645684293936938 Time :  1142
accuracy train: 0.980111 val: 0.951515 test: 0.963014
max validation accuracy : 0.961212 max acc epoch : 5 test accuracy : 0.966210
Counter({1: 4036, 0: 3655})

Epoch :  8 loss training:  9.52973851095885 Time :  1154
accuracy train: 0.985458 val: 0.961212 test: 0.965297
max validation accuracy : 0.961212 max acc epoch : 5 test accuracy : 0.966210
Counter({1: 3970, 0: 3721})

Epoch :  9 loss training:  8.316529362462461 Time :  1165
accuracy train: 0.982678 val: 0.960000 test: 0.969406
max validation accuracy : 0.961212 max acc epoch : 5 test accuracy : 0.966210
Counter({0: 3931, 1: 3760})

Epoch :  10 loss training:  8.587871802505106 Time :  1177
accuracy train: 0.989735 val: 0.962424 test: 0.965753
max validation accuracy : 0.962424 max acc epoch : 10 test accuracy : 0.965753
Counter({0: 3901, 1: 3790})

Epoch :  11 loss training:  7.933156358543783 Time :  1189
accuracy train: 0.984816 val: 0.955152 test: 0.964840
max validation accuracy : 0.962424 max acc epoch : 10 test accuracy : 0.965753
Counter({1: 3943, 0: 3748})

Epoch :  12 loss training:  6.714556054212153 Time :  1201
accuracy train: 0.993370 val: 0.968485 test: 0.962557
max validation accuracy : 0.968485 max acc epoch : 12 test accuracy : 0.962557
Counter({0: 3872, 1: 3819})

Epoch :  13 loss training:  5.08084835880436 Time :  1213
accuracy train: 0.994012 val: 0.961212 test: 0.975342
max validation accuracy : 0.968485 max acc epoch : 12 test accuracy : 0.962557
Counter({0: 3900, 1: 3791})

Epoch :  14 loss training:  4.763694507535547 Time :  1225
accuracy train: 0.993584 val: 0.967273 test: 0.971233
max validation accuracy : 0.968485 max acc epoch : 12 test accuracy : 0.962557
Counter({1: 3853, 0: 3838})

Epoch :  15 loss training:  4.400477252318524 Time :  1237
accuracy train: 0.995723 val: 0.967273 test: 0.966210
max validation accuracy : 0.968485 max acc epoch : 12 test accuracy : 0.962557
Counter({1: 3852, 0: 3839})

Epoch :  16 loss training:  4.481842089095153 Time :  1249
accuracy train: 0.994654 val: 0.962424 test: 0.967123
max validation accuracy : 0.968485 max acc epoch : 12 test accuracy : 0.962557
Counter({1: 3880, 0: 3811})

Epoch :  17 loss training:  3.755609419022221 Time :  1262
accuracy train: 0.996151 val: 0.974545 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({1: 3860, 0: 3831})

Epoch :  18 loss training:  2.8308224835200235 Time :  1274
accuracy train: 0.997220 val: 0.973333 test: 0.966210
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({0: 3876, 1: 3815})

Epoch :  19 loss training:  2.8138521460350603 Time :  1286
accuracy train: 0.997648 val: 0.968485 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({1: 3867, 0: 3824})

Epoch :  20 loss training:  2.52511453666375 Time :  1298
accuracy train: 0.997434 val: 0.973333 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({0: 3872, 1: 3819})

Epoch :  21 loss training:  2.0405009300448 Time :  1310
accuracy train: 0.997861 val: 0.968485 test: 0.964384
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({0: 3851, 1: 3840})

Epoch :  22 loss training:  1.9594627141777892 Time :  1322
accuracy train: 0.997861 val: 0.968485 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({1: 3852, 0: 3839})

Epoch :  23 loss training:  1.3887878676468972 Time :  1333
accuracy train: 0.997434 val: 0.966061 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({1: 3864, 0: 3827})

Epoch :  24 loss training:  1.6019857778810547 Time :  1345
accuracy train: 0.997648 val: 0.969697 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({0: 3861, 1: 3830})

Epoch :  25 loss training:  2.008473960624542 Time :  1357
accuracy train: 0.997861 val: 0.963636 test: 0.965753
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({0: 3847, 1: 3844})

Epoch :  26 loss training:  1.9376589651365066 Time :  1369
accuracy train: 0.997861 val: 0.966061 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({0: 3874, 1: 3817})

Epoch :  27 loss training:  1.8725270686190925 Time :  1381
accuracy train: 0.997434 val: 0.967273 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({0: 3861, 1: 3830})

Epoch :  28 loss training:  1.4149395991044003 Time :  1393
accuracy train: 0.997861 val: 0.973333 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({0: 3872, 1: 3819})

Epoch :  29 loss training:  1.4391184915366466 Time :  1405
accuracy train: 0.998289 val: 0.966061 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({0: 3887, 1: 3804})

Epoch :  30 loss training:  1.3764564277080353 Time :  1417
accuracy train: 0.997220 val: 0.964848 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({1: 3883, 0: 3808})

Epoch :  31 loss training:  2.0197796901484253 Time :  1429
accuracy train: 0.997006 val: 0.949091 test: 0.959361
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({0: 3935, 1: 3756})

Epoch :  32 loss training:  1.6392494331776106 Time :  1441
accuracy train: 0.992943 val: 0.943030 test: 0.953881
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({1: 3890, 0: 3801})

Epoch :  33 loss training:  1.5809881328677875 Time :  1453
accuracy train: 0.997861 val: 0.966061 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({1: 3857, 0: 3834})

Epoch :  34 loss training:  1.3372479255485814 Time :  1465
accuracy train: 0.997861 val: 0.969697 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({0: 3868, 1: 3823})

Epoch :  35 loss training:  1.743364295380161 Time :  1478
accuracy train: 0.997648 val: 0.962424 test: 0.956621
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({1: 3890, 0: 3801})

Epoch :  36 loss training:  1.990476146216679 Time :  1490
accuracy train: 0.997648 val: 0.972121 test: 0.965297
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({1: 3847, 0: 3844})

Epoch :  37 loss training:  1.4979910838228534 Time :  1502
accuracy train: 0.997861 val: 0.970909 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({0: 3864, 1: 3827})

Epoch :  38 loss training:  1.2117762689085794 Time :  1514
accuracy train: 0.998075 val: 0.972121 test: 0.966210
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({0: 3847, 1: 3844})

Epoch :  39 loss training:  1.0328973324667459 Time :  1525
accuracy train: 0.997861 val: 0.970909 test: 0.965753
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({1: 3861, 0: 3830})

Epoch :  40 loss training:  1.073157340142643 Time :  1538
accuracy train: 0.998289 val: 0.970909 test: 0.964840
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({1: 3859, 0: 3832})

Epoch :  41 loss training:  1.2334540405081498 Time :  1550
accuracy train: 0.998075 val: 0.969697 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({1: 3880, 0: 3811})

Epoch :  42 loss training:  1.176270569781991 Time :  1562
accuracy train: 0.997861 val: 0.969697 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({0: 3883, 1: 3808})

Epoch :  43 loss training:  0.9961372365723946 Time :  1574
accuracy train: 0.998289 val: 0.974545 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({1: 3881, 0: 3810})

Epoch :  44 loss training:  1.0410827127761877 Time :  1586
accuracy train: 0.997861 val: 0.966061 test: 0.965297
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({0: 3889, 1: 3802})

Epoch :  45 loss training:  1.3056338969581702 Time :  1598
accuracy train: 0.998075 val: 0.969697 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({1: 3878, 0: 3813})

Epoch :  46 loss training:  1.2988277415233824 Time :  1609
accuracy train: 0.998075 val: 0.974545 test: 0.964384
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({0: 3878, 1: 3813})

Epoch :  47 loss training:  1.40113487923918 Time :  1621
accuracy train: 0.998289 val: 0.963636 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({1: 3846, 0: 3845})

Epoch :  48 loss training:  1.4594177509497968 Time :  1633
accuracy train: 0.997648 val: 0.964848 test: 0.964384
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.968950
Counter({1: 3853, 0: 3838})

========================================================================================================================================================================================================
best acc epoch :  17
validation accuracy :  0.9745454545454545
test accuracy :  0.9689497716894977
last test_accuracy :  0.9643835616438357
second best val :  0.9733333333333334
second best test :  0.9689497716894977
max gap 5
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  58 	 val_accuracy : 0.97576 	 test_accuracy : 0.96941 	 last test_accuracy : 0.95753 	 second best val : 0.97455 	 second best test : 0.96895
k :  1 	 best_acc epoch :  17 	 val_accuracy : 0.97455 	 test_accuracy : 0.96895 	 last test_accuracy : 0.96438 	 second best val : 0.97333 	 second best test : 0.96895

avg :  	 val_accuracy : 0.97515 	 test_accuracy : 0.96918 	 last_accuracy : 0.96096 	 second best val : 0.97394 	 second best test : 0.96895

std :  	 val_accuracy : 0.00061 	 test_accuracy : 0.00023 	 last_accuracy : 0.00342 	 second best val : 0.00061 	 second best test : 0.00000


date and time :  Sun Jun 20 16:57:04 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.5, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=2, num_exp=2, num_layers=2, num_mlp_layers=1, random_vec=False, seed=957, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  70.12458691000938 Time :  11
accuracy train: 0.932207 val: 0.917576 test: 0.939726
max validation accuracy : 0.917576 max acc epoch : 1 test accuracy : 0.939726
Counter({1: 4283, 0: 3408})

Epoch :  2 loss training:  27.443116676062346 Time :  22
accuracy train: 0.959153 val: 0.941818 test: 0.952968
max validation accuracy : 0.941818 max acc epoch : 2 test accuracy : 0.952968
Counter({0: 4175, 1: 3516})

Epoch :  3 loss training:  21.00612154044211 Time :  34
accuracy train: 0.970915 val: 0.951515 test: 0.967123
max validation accuracy : 0.951515 max acc epoch : 3 test accuracy : 0.967123
Counter({1: 4182, 0: 3509})

Epoch :  4 loss training:  16.646934673190117 Time :  45
accuracy train: 0.969418 val: 0.953939 test: 0.964840
max validation accuracy : 0.953939 max acc epoch : 4 test accuracy : 0.964840
Counter({0: 4071, 1: 3620})

Epoch :  5 loss training:  17.10772648639977 Time :  56
accuracy train: 0.971985 val: 0.950303 test: 0.952968
max validation accuracy : 0.953939 max acc epoch : 4 test accuracy : 0.964840
Counter({1: 4135, 0: 3556})

Epoch :  6 loss training:  15.570842491462827 Time :  68
accuracy train: 0.976476 val: 0.957576 test: 0.960274
max validation accuracy : 0.957576 max acc epoch : 6 test accuracy : 0.960274
Counter({0: 4110, 1: 3581})

Epoch :  7 loss training:  14.97539947507903 Time :  79
accuracy train: 0.980539 val: 0.966061 test: 0.964384
max validation accuracy : 0.966061 max acc epoch : 7 test accuracy : 0.964384
Counter({1: 4001, 0: 3690})

Epoch :  8 loss training:  13.877230254001915 Time :  91
accuracy train: 0.977759 val: 0.961212 test: 0.952055
max validation accuracy : 0.966061 max acc epoch : 7 test accuracy : 0.964384
Counter({0: 3995, 1: 3696})

Epoch :  9 loss training:  14.85463740886189 Time :  102
accuracy train: 0.976476 val: 0.952727 test: 0.967123
max validation accuracy : 0.966061 max acc epoch : 7 test accuracy : 0.964384
Counter({1: 4067, 0: 3624})

Epoch :  10 loss training:  13.391020202077925 Time :  113
accuracy train: 0.978828 val: 0.962424 test: 0.964384
max validation accuracy : 0.966061 max acc epoch : 7 test accuracy : 0.964384
Counter({1: 4076, 0: 3615})

Epoch :  11 loss training:  11.169180881232023 Time :  125
accuracy train: 0.983533 val: 0.966061 test: 0.961644
max validation accuracy : 0.966061 max acc epoch : 7 test accuracy : 0.964384
Counter({0: 4109, 1: 3582})

Epoch :  12 loss training:  10.399661975447088 Time :  137
accuracy train: 0.985030 val: 0.961212 test: 0.972146
max validation accuracy : 0.966061 max acc epoch : 7 test accuracy : 0.964384
Counter({1: 4053, 0: 3638})

Epoch :  13 loss training:  10.04683015588671 Time :  149
accuracy train: 0.987169 val: 0.960000 test: 0.958447
max validation accuracy : 0.966061 max acc epoch : 7 test accuracy : 0.964384
Counter({1: 3933, 0: 3758})

Epoch :  14 loss training:  8.265392662025988 Time :  161
accuracy train: 0.988452 val: 0.957576 test: 0.966210
max validation accuracy : 0.966061 max acc epoch : 7 test accuracy : 0.964384
Counter({0: 3904, 1: 3787})

Epoch :  15 loss training:  8.035792434005998 Time :  173
accuracy train: 0.989093 val: 0.966061 test: 0.956164
max validation accuracy : 0.966061 max acc epoch : 7 test accuracy : 0.964384
Counter({1: 3852, 0: 3839})

Epoch :  16 loss training:  7.177090704906732 Time :  185
accuracy train: 0.986099 val: 0.957576 test: 0.961644
max validation accuracy : 0.966061 max acc epoch : 7 test accuracy : 0.964384
Counter({1: 3955, 0: 3736})

Epoch :  17 loss training:  6.466087978915311 Time :  197
accuracy train: 0.992515 val: 0.963636 test: 0.967123
max validation accuracy : 0.966061 max acc epoch : 7 test accuracy : 0.964384
Counter({1: 3863, 0: 3828})

Epoch :  18 loss training:  5.689465497271158 Time :  209
accuracy train: 0.994226 val: 0.963636 test: 0.963470
max validation accuracy : 0.966061 max acc epoch : 7 test accuracy : 0.964384
Counter({0: 3858, 1: 3833})

Epoch :  19 loss training:  4.636986731085926 Time :  220
accuracy train: 0.995295 val: 0.963636 test: 0.965753
max validation accuracy : 0.966061 max acc epoch : 7 test accuracy : 0.964384
Counter({1: 3875, 0: 3816})

Epoch :  20 loss training:  4.258878587919753 Time :  232
accuracy train: 0.993584 val: 0.963636 test: 0.966210
max validation accuracy : 0.966061 max acc epoch : 7 test accuracy : 0.964384
Counter({0: 3884, 1: 3807})

Epoch :  21 loss training:  3.950035982124973 Time :  245
accuracy train: 0.997220 val: 0.967273 test: 0.968493
max validation accuracy : 0.967273 max acc epoch : 21 test accuracy : 0.968493
Counter({0: 3859, 1: 3832})

Epoch :  22 loss training:  4.0715464651584625 Time :  256
accuracy train: 0.995295 val: 0.963636 test: 0.965297
max validation accuracy : 0.967273 max acc epoch : 21 test accuracy : 0.968493
Counter({0: 3896, 1: 3795})

Epoch :  23 loss training:  3.638168532139389 Time :  269
accuracy train: 0.997220 val: 0.967273 test: 0.973059
max validation accuracy : 0.967273 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3899, 0: 3792})

Epoch :  24 loss training:  3.2683067431207746 Time :  281
accuracy train: 0.993584 val: 0.957576 test: 0.970776
max validation accuracy : 0.967273 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3917, 0: 3774})

Epoch :  25 loss training:  3.0403836886398494 Time :  293
accuracy train: 0.997648 val: 0.960000 test: 0.971233
max validation accuracy : 0.967273 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3870, 0: 3821})

Epoch :  26 loss training:  2.9415007064817473 Time :  304
accuracy train: 0.997434 val: 0.968485 test: 0.968037
max validation accuracy : 0.968485 max acc epoch : 26 test accuracy : 0.968037
Counter({1: 3860, 0: 3831})

Epoch :  27 loss training:  2.1487496181507595 Time :  316
accuracy train: 0.997861 val: 0.961212 test: 0.971689
max validation accuracy : 0.968485 max acc epoch : 26 test accuracy : 0.968037
Counter({1: 3849, 0: 3842})

Epoch :  28 loss training:  2.461643775779521 Time :  328
accuracy train: 0.997434 val: 0.969697 test: 0.974886
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({1: 3892, 0: 3799})

Epoch :  29 loss training:  2.490354852634482 Time :  340
accuracy train: 0.997861 val: 0.961212 test: 0.974429
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({1: 3910, 0: 3781})

Epoch :  30 loss training:  2.402412210998591 Time :  352
accuracy train: 0.996792 val: 0.960000 test: 0.973516
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({0: 3930, 1: 3761})

Epoch :  31 loss training:  2.61852616116812 Time :  364
accuracy train: 0.997434 val: 0.957576 test: 0.973059
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({1: 3900, 0: 3791})

Epoch :  32 loss training:  2.659584521839861 Time :  376
accuracy train: 0.997648 val: 0.964848 test: 0.972146
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({1: 3879, 0: 3812})

Epoch :  33 loss training:  2.3238176878367085 Time :  388
accuracy train: 0.997220 val: 0.964848 test: 0.965753
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({1: 3900, 0: 3791})

Epoch :  34 loss training:  2.5248560750478646 Time :  399
accuracy train: 0.997861 val: 0.961212 test: 0.968493
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({1: 3901, 0: 3790})

Epoch :  35 loss training:  3.8079528999551258 Time :  411
accuracy train: 0.997006 val: 0.961212 test: 0.972146
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({1: 3959, 0: 3732})

Epoch :  36 loss training:  3.2062414781103143 Time :  423
accuracy train: 0.997861 val: 0.964848 test: 0.966210
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({0: 3883, 1: 3808})

Epoch :  37 loss training:  2.5514048476179596 Time :  435
accuracy train: 0.997434 val: 0.964848 test: 0.968950
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({1: 3892, 0: 3799})

Epoch :  38 loss training:  2.2046375666977838 Time :  447
accuracy train: 0.998075 val: 0.968485 test: 0.970320
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({0: 3862, 1: 3829})

Epoch :  39 loss training:  2.3991303378497832 Time :  459
accuracy train: 0.997861 val: 0.968485 test: 0.967123
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({1: 3933, 0: 3758})

Epoch :  40 loss training:  1.856719105377124 Time :  471
accuracy train: 0.997648 val: 0.964848 test: 0.971233
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({0: 3901, 1: 3790})

Epoch :  41 loss training:  1.5530833493176033 Time :  482
accuracy train: 0.997648 val: 0.966061 test: 0.969863
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({1: 3855, 0: 3836})

Epoch :  42 loss training:  1.919100586534114 Time :  494
accuracy train: 0.997648 val: 0.966061 test: 0.971689
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({1: 3867, 0: 3824})

Epoch :  43 loss training:  2.0091910452756565 Time :  506
accuracy train: 0.997434 val: 0.963636 test: 0.966667
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({1: 3861, 0: 3830})

Epoch :  44 loss training:  2.0897269348351983 Time :  518
accuracy train: 0.997006 val: 0.968485 test: 0.972146
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({0: 3872, 1: 3819})

Epoch :  45 loss training:  1.7716576763814373 Time :  530
accuracy train: 0.997648 val: 0.963636 test: 0.972146
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({1: 3848, 0: 3843})

Epoch :  46 loss training:  1.8090483112900984 Time :  542
accuracy train: 0.998075 val: 0.961212 test: 0.971233
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({1: 3849, 0: 3842})

Epoch :  47 loss training:  1.3637935938495502 Time :  554
accuracy train: 0.997434 val: 0.964848 test: 0.964840
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({0: 3905, 1: 3786})

Epoch :  48 loss training:  2.2880686817734386 Time :  566
accuracy train: 0.998075 val: 0.953939 test: 0.963014
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({0: 3846, 1: 3845})

Epoch :  49 loss training:  2.218130696383014 Time :  577
accuracy train: 0.998075 val: 0.963636 test: 0.968950
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({0: 3872, 1: 3819})

Epoch :  50 loss training:  1.4343556806597917 Time :  589
accuracy train: 0.997220 val: 0.962424 test: 0.973973
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({0: 3868, 1: 3823})

Epoch :  51 loss training:  1.8913587084934989 Time :  601
accuracy train: 0.997434 val: 0.962424 test: 0.967123
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({0: 3870, 1: 3821})

Epoch :  52 loss training:  1.7393677640866372 Time :  613
accuracy train: 0.997648 val: 0.969697 test: 0.971689
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({1: 3865, 0: 3826})

Epoch :  53 loss training:  1.5469658758232754 Time :  625
accuracy train: 0.998075 val: 0.964848 test: 0.972603
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({1: 3854, 0: 3837})

Epoch :  54 loss training:  1.930222564646101 Time :  637
accuracy train: 0.998075 val: 0.962424 test: 0.969406
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({1: 3863, 0: 3828})

Epoch :  55 loss training:  1.4540322771918 Time :  649
accuracy train: 0.997220 val: 0.969697 test: 0.972146
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({1: 3869, 0: 3822})

Epoch :  56 loss training:  1.787928295259917 Time :  661
accuracy train: 0.997861 val: 0.962424 test: 0.974886
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({0: 3863, 1: 3828})

Epoch :  57 loss training:  1.8218164698082546 Time :  673
accuracy train: 0.997648 val: 0.957576 test: 0.966210
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({0: 4056, 1: 3635})

Epoch :  58 loss training:  1.5567329850018723 Time :  685
accuracy train: 0.997648 val: 0.955152 test: 0.973973
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({1: 3855, 0: 3836})

Epoch :  59 loss training:  1.5726644996793766 Time :  697
accuracy train: 0.998075 val: 0.962424 test: 0.969863
max validation accuracy : 0.969697 max acc epoch : 28 test accuracy : 0.974886
Counter({0: 3852, 1: 3839})

========================================================================================================================================================================================================
best acc epoch :  28
validation accuracy :  0.9696969696969697
test accuracy :  0.9748858447488584
last test_accuracy :  0.9698630136986301
second best val :  0.9684848484848485
second best test :  0.9680365296803652
max gap 14
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.5, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=2, num_exp=2, num_layers=2, num_mlp_layers=1, random_vec=False, seed=425, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  68.29191921651363 Time :  711
accuracy train: 0.943114 val: 0.922424 test: 0.934247
max validation accuracy : 0.922424 max acc epoch : 1 test accuracy : 0.934247
Counter({0: 4040, 1: 3651})

Epoch :  2 loss training:  27.333596723154187 Time :  722
accuracy train: 0.928785 val: 0.909091 test: 0.948402
max validation accuracy : 0.922424 max acc epoch : 1 test accuracy : 0.934247
Counter({0: 3998, 1: 3693})

Epoch :  3 loss training:  22.263401513919234 Time :  734
accuracy train: 0.961506 val: 0.940606 test: 0.946575
max validation accuracy : 0.940606 max acc epoch : 3 test accuracy : 0.946575
Counter({1: 3965, 0: 3726})

Epoch :  4 loss training:  17.33410856826231 Time :  745
accuracy train: 0.968991 val: 0.957576 test: 0.962100
max validation accuracy : 0.957576 max acc epoch : 4 test accuracy : 0.962100
Counter({0: 3919, 1: 3772})

Epoch :  5 loss training:  14.78134885802865 Time :  757
accuracy train: 0.963003 val: 0.943030 test: 0.955708
max validation accuracy : 0.957576 max acc epoch : 4 test accuracy : 0.962100
Counter({1: 3927, 0: 3764})

Epoch :  6 loss training:  16.034597887657583 Time :  768
accuracy train: 0.969204 val: 0.944242 test: 0.962100
max validation accuracy : 0.957576 max acc epoch : 4 test accuracy : 0.962100
Counter({1: 3942, 0: 3749})

Epoch :  7 loss training:  14.604088494554162 Time :  779
accuracy train: 0.977973 val: 0.958788 test: 0.963014
max validation accuracy : 0.958788 max acc epoch : 7 test accuracy : 0.963014
Counter({0: 3930, 1: 3761})

Epoch :  8 loss training:  15.307930270209908 Time :  791
accuracy train: 0.978400 val: 0.958788 test: 0.958447
max validation accuracy : 0.958788 max acc epoch : 7 test accuracy : 0.963014
Counter({1: 3921, 0: 3770})

Epoch :  9 loss training:  13.999474733602256 Time :  802
accuracy train: 0.978614 val: 0.961212 test: 0.968950
max validation accuracy : 0.961212 max acc epoch : 9 test accuracy : 0.968950
Counter({0: 3892, 1: 3799})

Epoch :  10 loss training:  12.576211235485971 Time :  814
accuracy train: 0.973482 val: 0.956364 test: 0.967123
max validation accuracy : 0.961212 max acc epoch : 9 test accuracy : 0.968950
Counter({1: 3894, 0: 3797})

Epoch :  11 loss training:  12.297770287841558 Time :  826
accuracy train: 0.978614 val: 0.956364 test: 0.956621
max validation accuracy : 0.961212 max acc epoch : 9 test accuracy : 0.968950
Counter({1: 3910, 0: 3781})

Epoch :  12 loss training:  10.200166546273977 Time :  838
accuracy train: 0.987382 val: 0.962424 test: 0.958447
max validation accuracy : 0.962424 max acc epoch : 12 test accuracy : 0.958447
Counter({0: 3851, 1: 3840})

Epoch :  13 loss training:  10.357286797370762 Time :  850
accuracy train: 0.986955 val: 0.963636 test: 0.962557
max validation accuracy : 0.963636 max acc epoch : 13 test accuracy : 0.962557
Counter({1: 3874, 0: 3817})

Epoch :  14 loss training:  8.868728655856103 Time :  861
accuracy train: 0.988452 val: 0.962424 test: 0.964384
max validation accuracy : 0.963636 max acc epoch : 13 test accuracy : 0.962557
Counter({1: 3854, 0: 3837})

Epoch :  15 loss training:  7.93397861905396 Time :  872
accuracy train: 0.991232 val: 0.966061 test: 0.972146
max validation accuracy : 0.966061 max acc epoch : 15 test accuracy : 0.972146
Counter({1: 3890, 0: 3801})

Epoch :  16 loss training:  6.321967965341173 Time :  884
accuracy train: 0.992943 val: 0.967273 test: 0.963927
max validation accuracy : 0.967273 max acc epoch : 16 test accuracy : 0.963927
Counter({0: 3870, 1: 3821})

Epoch :  17 loss training:  5.808775099460036 Time :  896
accuracy train: 0.993584 val: 0.964848 test: 0.972146
max validation accuracy : 0.967273 max acc epoch : 16 test accuracy : 0.963927
Counter({0: 3868, 1: 3823})

Epoch :  18 loss training:  6.101473307295237 Time :  908
accuracy train: 0.995081 val: 0.968485 test: 0.968950
max validation accuracy : 0.968485 max acc epoch : 18 test accuracy : 0.968950
Counter({1: 3864, 0: 3827})

Epoch :  19 loss training:  5.104765284340829 Time :  920
accuracy train: 0.994654 val: 0.969697 test: 0.968493
max validation accuracy : 0.969697 max acc epoch : 19 test accuracy : 0.968493
Counter({1: 3872, 0: 3819})

Epoch :  20 loss training:  4.993096561869606 Time :  932
accuracy train: 0.994654 val: 0.974545 test: 0.965753
max validation accuracy : 0.974545 max acc epoch : 20 test accuracy : 0.965753
Counter({1: 3903, 0: 3788})

Epoch :  21 loss training:  3.8866004864685237 Time :  944
accuracy train: 0.994867 val: 0.966061 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 20 test accuracy : 0.965753
Counter({1: 3860, 0: 3831})

Epoch :  22 loss training:  3.9026403871248476 Time :  956
accuracy train: 0.995295 val: 0.969697 test: 0.964840
max validation accuracy : 0.974545 max acc epoch : 20 test accuracy : 0.965753
Counter({0: 3886, 1: 3805})

Epoch :  23 loss training:  3.60289690704667 Time :  968
accuracy train: 0.994654 val: 0.960000 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 20 test accuracy : 0.965753
Counter({1: 3867, 0: 3824})

Epoch :  24 loss training:  3.0821281986136455 Time :  980
accuracy train: 0.997006 val: 0.975758 test: 0.969406
max validation accuracy : 0.975758 max acc epoch : 24 test accuracy : 0.969406
Counter({1: 3853, 0: 3838})

Epoch :  25 loss training:  3.449998040276114 Time :  992
accuracy train: 0.996364 val: 0.973333 test: 0.971689
max validation accuracy : 0.975758 max acc epoch : 24 test accuracy : 0.969406
Counter({0: 3856, 1: 3835})

Epoch :  26 loss training:  2.6015092352827196 Time :  1004
accuracy train: 0.996364 val: 0.966061 test: 0.970320
max validation accuracy : 0.975758 max acc epoch : 24 test accuracy : 0.969406
Counter({0: 3857, 1: 3834})

Epoch :  27 loss training:  3.0083177061751485 Time :  1016
accuracy train: 0.997006 val: 0.964848 test: 0.966210
max validation accuracy : 0.975758 max acc epoch : 24 test accuracy : 0.969406
Counter({1: 3854, 0: 3837})

Epoch :  28 loss training:  3.194998660357669 Time :  1028
accuracy train: 0.996792 val: 0.978182 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({0: 3855, 1: 3836})

Epoch :  29 loss training:  3.109817996592028 Time :  1040
accuracy train: 0.997220 val: 0.967273 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({0: 3851, 1: 3840})

Epoch :  30 loss training:  2.6067504884049413 Time :  1052
accuracy train: 0.997006 val: 0.969697 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({0: 3855, 1: 3836})

Epoch :  31 loss training:  2.340889898361638 Time :  1064
accuracy train: 0.995723 val: 0.962424 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({0: 3850, 1: 3841})

Epoch :  32 loss training:  2.379725283339212 Time :  1076
accuracy train: 0.997220 val: 0.966061 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({0: 3848, 1: 3843})

Epoch :  33 loss training:  2.3908382567897206 Time :  1088
accuracy train: 0.997220 val: 0.966061 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({0: 3867, 1: 3824})

Epoch :  34 loss training:  2.2907370313550928 Time :  1099
accuracy train: 0.997220 val: 0.966061 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({0: 3867, 1: 3824})

Epoch :  35 loss training:  2.1880164561735 Time :  1111
accuracy train: 0.997434 val: 0.972121 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({0: 3856, 1: 3835})

Epoch :  36 loss training:  2.4456416202119726 Time :  1123
accuracy train: 0.997434 val: 0.972121 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({1: 3862, 0: 3829})

Epoch :  37 loss training:  1.6549380291180569 Time :  1135
accuracy train: 0.997006 val: 0.969697 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({0: 3873, 1: 3818})

Epoch :  38 loss training:  1.7576262438597041 Time :  1147
accuracy train: 0.997648 val: 0.969697 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({1: 3857, 0: 3834})

Epoch :  39 loss training:  2.0279698920130613 Time :  1159
accuracy train: 0.997648 val: 0.969697 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({1: 3885, 0: 3806})

Epoch :  40 loss training:  2.3888373199370108 Time :  1171
accuracy train: 0.997434 val: 0.968485 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({1: 3871, 0: 3820})

Epoch :  41 loss training:  1.8067777003643641 Time :  1182
accuracy train: 0.997861 val: 0.972121 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({1: 3852, 0: 3839})

Epoch :  42 loss training:  2.179121795386891 Time :  1194
accuracy train: 0.997220 val: 0.967273 test: 0.965753
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({0: 3869, 1: 3822})

Epoch :  43 loss training:  2.3341709221513156 Time :  1207
accuracy train: 0.997006 val: 0.969697 test: 0.966210
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({0: 3865, 1: 3826})

Epoch :  44 loss training:  2.7327147350733867 Time :  1219
accuracy train: 0.996792 val: 0.970909 test: 0.963014
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({1: 3853, 0: 3838})

Epoch :  45 loss training:  2.0304354642357794 Time :  1230
accuracy train: 0.997434 val: 0.973333 test: 0.965297
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({1: 3881, 0: 3810})

Epoch :  46 loss training:  2.2637891538033728 Time :  1242
accuracy train: 0.997648 val: 0.973333 test: 0.965297
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({0: 3877, 1: 3814})

Epoch :  47 loss training:  1.8900025349867065 Time :  1255
accuracy train: 0.997006 val: 0.973333 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({1: 3862, 0: 3829})

Epoch :  48 loss training:  1.7362626314461522 Time :  1266
accuracy train: 0.997648 val: 0.972121 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({0: 3860, 1: 3831})

Epoch :  49 loss training:  1.6194619046200387 Time :  1278
accuracy train: 0.997861 val: 0.975758 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({0: 3875, 1: 3816})

Epoch :  50 loss training:  1.425551924010506 Time :  1290
accuracy train: 0.996364 val: 0.966061 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({1: 3896, 0: 3795})

Epoch :  51 loss training:  1.4901553736544884 Time :  1302
accuracy train: 0.997434 val: 0.972121 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({0: 3888, 1: 3803})

Epoch :  52 loss training:  1.7644727296119527 Time :  1314
accuracy train: 0.997861 val: 0.973333 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({0: 3872, 1: 3819})

Epoch :  53 loss training:  1.9471934478133335 Time :  1326
accuracy train: 0.996578 val: 0.967273 test: 0.964840
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({1: 3849, 0: 3842})

Epoch :  54 loss training:  1.512068939031451 Time :  1337
accuracy train: 0.997861 val: 0.973333 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({0: 3877, 1: 3814})

Epoch :  55 loss training:  1.4203405090138403 Time :  1349
accuracy train: 0.997220 val: 0.972121 test: 0.966210
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({0: 3883, 1: 3808})

Epoch :  56 loss training:  1.3390132735403313 Time :  1361
accuracy train: 0.997434 val: 0.975758 test: 0.966667
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({1: 3864, 0: 3827})

Epoch :  57 loss training:  1.3776868090026255 Time :  1372
accuracy train: 0.997861 val: 0.975758 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({1: 3872, 0: 3819})

Epoch :  58 loss training:  1.869613768238196 Time :  1384
accuracy train: 0.997220 val: 0.962424 test: 0.964384
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({1: 3871, 0: 3820})

Epoch :  59 loss training:  1.8283645467308816 Time :  1396
accuracy train: 0.997648 val: 0.969697 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.968493
Counter({0: 3868, 1: 3823})

========================================================================================================================================================================================================
best acc epoch :  28
validation accuracy :  0.9781818181818182
test accuracy :  0.9684931506849315
last test_accuracy :  0.9698630136986301
second best val :  0.9757575757575757
second best test :  0.9694063926940639
max gap 4
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  28 	 val_accuracy : 0.96970 	 test_accuracy : 0.97489 	 last test_accuracy : 0.96986 	 second best val : 0.96848 	 second best test : 0.96804
k :  1 	 best_acc epoch :  28 	 val_accuracy : 0.97818 	 test_accuracy : 0.96849 	 last test_accuracy : 0.96986 	 second best val : 0.97576 	 second best test : 0.96941

avg :  	 val_accuracy : 0.97394 	 test_accuracy : 0.97169 	 last_accuracy : 0.96986 	 second best val : 0.97212 	 second best test : 0.96872

std :  	 val_accuracy : 0.00424 	 test_accuracy : 0.00320 	 last_accuracy : 0.00000 	 second best val : 0.00364 	 second best test : 0.00068
