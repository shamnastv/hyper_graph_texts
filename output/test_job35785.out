

date and time :  Sun Jun  6 16:15:06 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=711, weight_decay=0)
device :  cuda:0
Counter({2: 4230, 0: 2303, 1: 1158})

Epoch :  1 loss training:  42.06744370050728 Time :  170
accuracy train: 0.963038 val: 0.945455 test: 0.947945
max validation accuracy : 0.945455 max acc epoch : 1 test accuracy : 0.947945
Counter({1: 3813, 2: 2400, 0: 1478})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  16.083837284357287 Time :  236
accuracy train: 0.955968 val: 0.940000 test: 0.944292
max validation accuracy : 0.945455 max acc epoch : 1 test accuracy : 0.947945
Counter({1: 3814, 2: 2722, 0: 1155})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  17.007915914990008 Time :  301
accuracy train: 0.967279 val: 0.963636 test: 0.964384
max validation accuracy : 0.963636 max acc epoch : 3 test accuracy : 0.964384
Counter({2: 3831, 1: 2496, 0: 1364})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.852074698079377 Time :  370
accuracy train: 0.984650 val: 0.970909 test: 0.968037
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.968037
Counter({0: 3845, 1: 2396, 2: 1450})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.174710656283423 Time :  434
accuracy train: 0.979802 val: 0.972727 test: 0.966210
max validation accuracy : 0.972727 max acc epoch : 5 test accuracy : 0.966210
Counter({1: 3858, 2: 2379, 0: 1454})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.58274477859959 Time :  484
accuracy train: 0.986871 val: 0.976364 test: 0.964840
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({0: 3872, 1: 2360, 2: 1459})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.23757825512439 Time :  525
accuracy train: 0.989699 val: 0.972727 test: 0.967123
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({0: 3883, 1: 2352, 2: 1456})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.927034672582522 Time :  575
accuracy train: 0.991315 val: 0.972727 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({1: 3887, 0: 2346, 2: 1458})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.7215895601548254 Time :  638
accuracy train: 0.988689 val: 0.972727 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({1: 3893, 0: 2343, 2: 1455})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.25080908020027 Time :  695
accuracy train: 0.990911 val: 0.969091 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({0: 3894, 1: 2341, 2: 1456})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.214913970907219 Time :  756
accuracy train: 0.993335 val: 0.974545 test: 0.968493
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({1: 3903, 2: 2337, 0: 1451})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.610999181866646 Time :  805
accuracy train: 0.994143 val: 0.970909 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({2: 3909, 1: 2332, 0: 1450})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  4.178469399223104 Time :  853
accuracy train: 0.993133 val: 0.972727 test: 0.968950
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({0: 3913, 2: 2330, 1: 1448})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.069922029972076 Time :  907
accuracy train: 0.993941 val: 0.974545 test: 0.968950
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({0: 3915, 1: 2329, 2: 1447})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  3.881736552109942 Time :  961
accuracy train: 0.993537 val: 0.972727 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({2: 3915, 0: 2329, 1: 1447})

Epoch :  16 loss training:  3.397288430540357 Time :  1014
accuracy train: 0.994547 val: 0.972727 test: 0.968493
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({1: 3915, 0: 2329, 2: 1447})

Epoch :  17 loss training:  3.574957580305636 Time :  1076
accuracy train: 0.994547 val: 0.974545 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({0: 3916, 1: 2330, 2: 1445})

Epoch :  18 loss training:  3.5181823288439773 Time :  1128
accuracy train: 0.993739 val: 0.970909 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({1: 3918, 0: 2328, 2: 1445})

Epoch :  19 loss training:  3.249040711147245 Time :  1175
accuracy train: 0.994143 val: 0.972727 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({0: 3918, 1: 2328, 2: 1445})

Epoch :  20 loss training:  3.1599103183834814 Time :  1226
accuracy train: 0.994749 val: 0.972727 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({0: 3918, 1: 2329, 2: 1444})

Epoch :  21 loss training:  3.1161464595934376 Time :  1276
accuracy train: 0.994951 val: 0.972727 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({0: 3918, 1: 2324, 2: 1449})

Epoch :  22 loss training:  3.2268856552545913 Time :  1335
accuracy train: 0.995354 val: 0.970909 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({1: 3921, 2: 2323, 0: 1447})

Epoch :  23 loss training:  3.054705193731934 Time :  1387
accuracy train: 0.994749 val: 0.974545 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({0: 3920, 2: 2322, 1: 1449})

Epoch :  24 loss training:  2.5856418330804445 Time :  1431
accuracy train: 0.995152 val: 0.974545 test: 0.973516
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({2: 3922, 1: 2319, 0: 1450})

Epoch :  25 loss training:  2.9172768763964996 Time :  1475
accuracy train: 0.995960 val: 0.972727 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({1: 3922, 0: 2319, 2: 1450})

Epoch :  26 loss training:  2.8877878717612475 Time :  1533
accuracy train: 0.995758 val: 0.974545 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({2: 3923, 1: 2317, 0: 1451})

Epoch :  27 loss training:  2.537616997375153 Time :  1587
accuracy train: 0.995758 val: 0.970909 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({1: 3923, 2: 2318, 0: 1450})

Epoch :  28 loss training:  2.513914969167672 Time :  1645
accuracy train: 0.995556 val: 0.974545 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({0: 3924, 1: 2317, 2: 1450})

Epoch :  29 loss training:  2.3242057141906116 Time :  1711
accuracy train: 0.995758 val: 0.974545 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({0: 3924, 1: 2316, 2: 1451})

Epoch :  30 loss training:  2.3042495390982367 Time :  1777
accuracy train: 0.995960 val: 0.974545 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({0: 3924, 1: 2315, 2: 1452})

Epoch :  31 loss training:  2.272316601331113 Time :  1834
accuracy train: 0.995758 val: 0.972727 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({0: 3924, 1: 2312, 2: 1455})

Epoch :  32 loss training:  2.3709104976878734 Time :  1902
accuracy train: 0.996364 val: 0.969091 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({1: 3924, 2: 2313, 0: 1454})

Epoch :  33 loss training:  2.2611062294163276 Time :  1964
accuracy train: 0.996162 val: 0.974545 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({1: 3924, 2: 2311, 0: 1456})

Epoch :  34 loss training:  2.1138158871472115 Time :  2028
accuracy train: 0.995960 val: 0.972727 test: 0.973516
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({1: 3924, 0: 2310, 2: 1457})

Epoch :  35 loss training:  2.0787847522296943 Time :  2090
accuracy train: 0.996162 val: 0.972727 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({1: 3925, 2: 2309, 0: 1457})

Epoch :  36 loss training:  2.0363823944935575 Time :  2149
accuracy train: 0.996364 val: 0.972727 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({0: 3925, 1: 2308, 2: 1458})

Epoch :  37 loss training:  1.9974976672965568 Time :  2209
accuracy train: 0.996566 val: 0.974545 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({1: 3927, 2: 2307, 0: 1457})

========================================================================================================================================================================================================
max acc epoch :  6
max validation accuracy :  0.9763636363636363
test accuracy :  0.9648401826484019
last test_accuracy :  0.9712328767123287
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=711, weight_decay=0)
device :  cuda:0
Counter({2: 4230, 0: 2303, 1: 1158})

Epoch :  1 loss training:  42.08903072029352 Time :  2431
accuracy train: 0.960614 val: 0.947273 test: 0.950228
max validation accuracy : 0.947273 max acc epoch : 1 test accuracy : 0.950228
Counter({0: 3794, 2: 2414, 1: 1483})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  15.97247716714628 Time :  2487
accuracy train: 0.953545 val: 0.943636 test: 0.944292
max validation accuracy : 0.947273 max acc epoch : 1 test accuracy : 0.950228
Counter({1: 3842, 2: 2729, 0: 1120})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  17.526151119265705 Time :  2564
accuracy train: 0.965260 val: 0.970909 test: 0.961644
max validation accuracy : 0.970909 max acc epoch : 3 test accuracy : 0.961644
Counter({2: 3877, 1: 2546, 0: 1268})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.133378821890801 Time :  2639
accuracy train: 0.985256 val: 0.970909 test: 0.967123
max validation accuracy : 0.970909 max acc epoch : 3 test accuracy : 0.961644
Counter({1: 3863, 2: 2374, 0: 1454})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.043854433344677 Time :  2712
accuracy train: 0.980408 val: 0.974545 test: 0.965753
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.965753
Counter({0: 3870, 1: 2356, 2: 1465})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.589298384613357 Time :  2767
accuracy train: 0.987275 val: 0.970909 test: 0.963927
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.965753
Counter({0: 3881, 1: 2349, 2: 1461})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.144082888262346 Time :  2829
accuracy train: 0.989901 val: 0.972727 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.965753
Counter({0: 3900, 2: 2333, 1: 1458})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.994065846083686 Time :  2880
accuracy train: 0.989497 val: 0.972727 test: 0.966210
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.965753
Counter({0: 3898, 1: 2331, 2: 1462})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.711733007803559 Time :  2934
accuracy train: 0.988689 val: 0.970909 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.965753
Counter({1: 3906, 2: 2329, 0: 1456})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.471250339760445 Time :  2988
accuracy train: 0.990103 val: 0.970909 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.965753
Counter({0: 3909, 2: 2329, 1: 1453})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.016841490054503 Time :  3051
accuracy train: 0.992123 val: 0.976364 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({1: 3914, 2: 2327, 0: 1450})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.780454702093266 Time :  3109
accuracy train: 0.993739 val: 0.972727 test: 0.967580
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({0: 3918, 1: 2324, 2: 1449})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  4.2551164659671485 Time :  3166
accuracy train: 0.993335 val: 0.974545 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({0: 3922, 1: 2323, 2: 1446})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.268009794061072 Time :  3226
accuracy train: 0.994143 val: 0.974545 test: 0.968950
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({2: 3923, 1: 2323, 0: 1445})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  3.835806468501687 Time :  3281
accuracy train: 0.993739 val: 0.972727 test: 0.966667
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({1: 3924, 0: 2322, 2: 1445})

Epoch :  16 loss training:  3.4494303334795404 Time :  3340
accuracy train: 0.994345 val: 0.972727 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({0: 3924, 1: 2322, 2: 1445})

Epoch :  17 loss training:  3.595806969795376 Time :  3404
accuracy train: 0.994749 val: 0.974545 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({0: 3924, 1: 2323, 2: 1444})

Epoch :  18 loss training:  3.5885831454215804 Time :  3462
accuracy train: 0.994143 val: 0.970909 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({0: 3925, 1: 2322, 2: 1444})

Epoch :  19 loss training:  3.315877898945473 Time :  3517
accuracy train: 0.994143 val: 0.972727 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({0: 3928, 1: 2319, 2: 1444})

Epoch :  20 loss training:  3.0382933102955576 Time :  3569
accuracy train: 0.994749 val: 0.970909 test: 0.968950
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({0: 3928, 1: 2318, 2: 1445})

Epoch :  21 loss training:  3.1691361065604724 Time :  3614
accuracy train: 0.994749 val: 0.972727 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({1: 3928, 0: 2314, 2: 1449})

Epoch :  22 loss training:  3.2105102124623954 Time :  3663
accuracy train: 0.994951 val: 0.970909 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({1: 3929, 0: 2315, 2: 1447})

Epoch :  23 loss training:  3.1666616410948336 Time :  3720
accuracy train: 0.995556 val: 0.972727 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({1: 3929, 0: 2313, 2: 1449})

Epoch :  24 loss training:  2.5805766212870367 Time :  3780
accuracy train: 0.994951 val: 0.974545 test: 0.968493
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({2: 3930, 1: 2313, 0: 1448})

Epoch :  25 loss training:  2.8061185576952994 Time :  3833
accuracy train: 0.995354 val: 0.970909 test: 0.968493
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({0: 3936, 1: 2312, 2: 1443})

Epoch :  26 loss training:  2.9071887630125275 Time :  3895
accuracy train: 0.995758 val: 0.972727 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({1: 3936, 0: 2312, 2: 1443})

Epoch :  27 loss training:  2.5241513422806747 Time :  3949
accuracy train: 0.995354 val: 0.967273 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({0: 3936, 2: 2311, 1: 1444})

Epoch :  28 loss training:  2.487926239380613 Time :  4008
accuracy train: 0.995354 val: 0.972727 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({0: 3937, 1: 2310, 2: 1444})

Epoch :  29 loss training:  2.515073596907314 Time :  4066
accuracy train: 0.995556 val: 0.974545 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({0: 3937, 1: 2307, 2: 1447})

Epoch :  30 loss training:  2.386057213647291 Time :  4128
accuracy train: 0.996162 val: 0.972727 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({0: 3937, 1: 2307, 2: 1447})

Epoch :  31 loss training:  2.3421132720832247 Time :  4181
accuracy train: 0.995960 val: 0.970909 test: 0.968493
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({0: 3938, 1: 2305, 2: 1448})

Epoch :  32 loss training:  2.440138849808136 Time :  4236
accuracy train: 0.996162 val: 0.970909 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({0: 3938, 1: 2303, 2: 1450})

Epoch :  33 loss training:  2.368986614383175 Time :  4298
accuracy train: 0.995960 val: 0.970909 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({0: 3938, 1: 2303, 2: 1450})

Epoch :  34 loss training:  2.1220656841469463 Time :  4357
accuracy train: 0.995960 val: 0.970909 test: 0.968950
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({1: 3939, 0: 2301, 2: 1451})

Epoch :  35 loss training:  2.047673828958068 Time :  4416
accuracy train: 0.996162 val: 0.969091 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({2: 3939, 0: 2301, 1: 1451})

Epoch :  36 loss training:  1.9833917412906885 Time :  4485
accuracy train: 0.996364 val: 0.969091 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({1: 3939, 0: 2301, 2: 1451})

Epoch :  37 loss training:  2.1008416455588304 Time :  4538
accuracy train: 0.996768 val: 0.972727 test: 0.968493
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({0: 3942, 2: 2297, 1: 1452})

Epoch :  38 loss training:  2.038425396560342 Time :  4595
accuracy train: 0.996768 val: 0.969091 test: 0.967580
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({1: 3941, 0: 2297, 2: 1453})

Epoch :  39 loss training:  2.2127701992430957 Time :  4651
accuracy train: 0.996970 val: 0.974545 test: 0.966210
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({1: 3941, 0: 2298, 2: 1452})

Epoch :  40 loss training:  1.9353337288775947 Time :  4703
accuracy train: 0.996162 val: 0.967273 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({1: 3941, 0: 2298, 2: 1452})

Epoch :  41 loss training:  1.756351821924909 Time :  4757
accuracy train: 0.996364 val: 0.969091 test: 0.968493
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({0: 3941, 2: 2295, 1: 1455})

Epoch :  42 loss training:  1.7381315380625892 Time :  4811
accuracy train: 0.996566 val: 0.969091 test: 0.968950
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969863
Counter({1: 3941, 0: 2294, 2: 1456})

========================================================================================================================================================================================================
max acc epoch :  11
max validation accuracy :  0.9763636363636363
test accuracy :  0.9698630136986301
last test_accuracy :  0.9689497716894977
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=711, weight_decay=0)
device :  cuda:0
Counter({2: 4230, 0: 2303, 1: 1158})

Epoch :  1 loss training:  42.14182616584003 Time :  5007
accuracy train: 0.961624 val: 0.947273 test: 0.950228
max validation accuracy : 0.947273 max acc epoch : 1 test accuracy : 0.950228
Counter({0: 3810, 2: 2398, 1: 1483})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  15.938089908333495 Time :  5062
accuracy train: 0.957786 val: 0.945455 test: 0.945662
max validation accuracy : 0.947273 max acc epoch : 1 test accuracy : 0.950228
Counter({0: 3842, 2: 2719, 1: 1130})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.815844796597958 Time :  5135
accuracy train: 0.963644 val: 0.969091 test: 0.961187
max validation accuracy : 0.969091 max acc epoch : 3 test accuracy : 0.961187
Counter({0: 3858, 1: 2470, 2: 1363})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.82924929773435 Time :  5207
accuracy train: 0.986063 val: 0.967273 test: 0.967123
max validation accuracy : 0.969091 max acc epoch : 3 test accuracy : 0.961187
Counter({0: 3858, 2: 2374, 1: 1459})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.786312266951427 Time :  5266
accuracy train: 0.981418 val: 0.974545 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.966667
Counter({1: 3863, 0: 2364, 2: 1464})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.17764536687173 Time :  5320
accuracy train: 0.985256 val: 0.970909 test: 0.961187
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.966667
Counter({0: 3868, 1: 2353, 2: 1470})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.250082438113168 Time :  5381
accuracy train: 0.990709 val: 0.974545 test: 0.967123
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.966667
Counter({0: 3880, 1: 2344, 2: 1467})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.672463460941799 Time :  5438
accuracy train: 0.991315 val: 0.972727 test: 0.965753
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.966667
Counter({1: 3888, 0: 2337, 2: 1466})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.41364681837149 Time :  5496
accuracy train: 0.989901 val: 0.972727 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.966667
Counter({1: 3892, 2: 2339, 0: 1460})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.2029362806351855 Time :  5554
accuracy train: 0.992325 val: 0.970909 test: 0.966210
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.966667
Counter({1: 3894, 2: 2338, 0: 1459})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.290905123925768 Time :  5599
accuracy train: 0.992123 val: 0.976364 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({1: 3896, 2: 2339, 0: 1456})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.771923097665422 Time :  5658
accuracy train: 0.993739 val: 0.972727 test: 0.968950
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({0: 3907, 2: 2329, 1: 1455})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  4.138423939235508 Time :  5717
accuracy train: 0.993537 val: 0.976364 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({1: 3911, 2: 2328, 0: 1452})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.108799058711156 Time :  5771
accuracy train: 0.993739 val: 0.976364 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({0: 3913, 1: 2327, 2: 1451})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  4.0251622080104426 Time :  5837
accuracy train: 0.993537 val: 0.976364 test: 0.968493
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({2: 3913, 1: 2328, 0: 1450})

Epoch :  16 loss training:  3.374408671981655 Time :  5895
accuracy train: 0.994547 val: 0.972727 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({0: 3913, 2: 2328, 1: 1450})

Epoch :  17 loss training:  3.5998717834008858 Time :  5944
accuracy train: 0.994345 val: 0.972727 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({1: 3913, 0: 2330, 2: 1448})

Epoch :  18 loss training:  3.492688393773278 Time :  5998
accuracy train: 0.994345 val: 0.970909 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({1: 3913, 0: 2331, 2: 1447})

Epoch :  19 loss training:  3.265774611325469 Time :  6042
accuracy train: 0.994547 val: 0.974545 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({0: 3915, 1: 2330, 2: 1446})

Epoch :  20 loss training:  3.0078885719703976 Time :  6090
accuracy train: 0.994547 val: 0.976364 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({0: 3917, 1: 2331, 2: 1443})

Epoch :  21 loss training:  3.1015605980646797 Time :  6155
accuracy train: 0.994749 val: 0.974545 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({0: 3920, 1: 2326, 2: 1445})

Epoch :  22 loss training:  3.221916099952068 Time :  6212
accuracy train: 0.995152 val: 0.970909 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({1: 3921, 2: 2326, 0: 1444})

Epoch :  23 loss training:  2.9681576095172204 Time :  6262
accuracy train: 0.995354 val: 0.970909 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({1: 3921, 0: 2324, 2: 1446})

Epoch :  24 loss training:  2.5449275479768403 Time :  6307
accuracy train: 0.995556 val: 0.972727 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({1: 3923, 0: 2321, 2: 1447})

Epoch :  25 loss training:  2.7382712220423855 Time :  6350
accuracy train: 0.995556 val: 0.974545 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({1: 3923, 0: 2321, 2: 1447})

Epoch :  26 loss training:  2.732145071349805 Time :  6398
accuracy train: 0.996162 val: 0.974545 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({1: 3923, 0: 2321, 2: 1447})

Epoch :  27 loss training:  2.484470156079624 Time :  6442
accuracy train: 0.995556 val: 0.972727 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({1: 3923, 2: 2318, 0: 1450})

Epoch :  28 loss training:  2.5460477275773883 Time :  6497
accuracy train: 0.995758 val: 0.976364 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({0: 3924, 1: 2318, 2: 1449})

Epoch :  29 loss training:  2.284674807364354 Time :  6539
accuracy train: 0.995960 val: 0.976364 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({0: 3923, 1: 2317, 2: 1451})

Epoch :  30 loss training:  2.31876488821581 Time :  6590
accuracy train: 0.995960 val: 0.974545 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({2: 3923, 0: 2316, 1: 1452})

Epoch :  31 loss training:  2.3249566225567833 Time :  6637
accuracy train: 0.996162 val: 0.974545 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({0: 3926, 1: 2314, 2: 1451})

Epoch :  32 loss training:  2.464465162542183 Time :  6682
accuracy train: 0.995960 val: 0.972727 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({1: 3926, 0: 2314, 2: 1451})

Epoch :  33 loss training:  2.2729632115224376 Time :  6730
accuracy train: 0.995556 val: 0.974545 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({1: 3926, 2: 2314, 0: 1451})

Epoch :  34 loss training:  2.1008834336389555 Time :  6780
accuracy train: 0.996162 val: 0.974545 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({1: 3926, 0: 2314, 2: 1451})

Epoch :  35 loss training:  1.9966913678799756 Time :  6830
accuracy train: 0.995556 val: 0.972727 test: 0.968950
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({1: 3927, 0: 2313, 2: 1451})

Epoch :  36 loss training:  1.9231686430430273 Time :  6872
accuracy train: 0.996162 val: 0.974545 test: 0.968950
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({0: 3925, 1: 2312, 2: 1454})

Epoch :  37 loss training:  2.057669530331623 Time :  6919
accuracy train: 0.996768 val: 0.974545 test: 0.968950
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({0: 3926, 1: 2311, 2: 1454})

Epoch :  38 loss training:  2.09257554798387 Time :  6972
accuracy train: 0.996768 val: 0.974545 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.969406
Counter({1: 3926, 2: 2311, 0: 1454})

Epoch :  39 loss training:  2.3061561545473523 Time :  7020
accuracy train: 0.996970 val: 0.980000 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({1: 3926, 0: 2311, 2: 1454})

Epoch :  40 loss training:  2.0264555400208337 Time :  7068
accuracy train: 0.996566 val: 0.974545 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({0: 3926, 1: 2309, 2: 1456})

Epoch :  41 loss training:  1.7524820653634379 Time :  7120
accuracy train: 0.996364 val: 0.974545 test: 0.968950
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({0: 3926, 1: 2308, 2: 1457})

Epoch :  42 loss training:  1.8312182386871427 Time :  7162
accuracy train: 0.996566 val: 0.974545 test: 0.970320
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({1: 3926, 0: 2308, 2: 1457})

Epoch :  43 loss training:  1.8355449014925398 Time :  7204
accuracy train: 0.996768 val: 0.972727 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({0: 3926, 1: 2308, 2: 1457})

Epoch :  44 loss training:  1.7781830056046601 Time :  7252
accuracy train: 0.996566 val: 0.974545 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({2: 3926, 1: 2308, 0: 1457})

Epoch :  45 loss training:  2.216582919791108 Time :  7296
accuracy train: 0.996970 val: 0.970909 test: 0.966667
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({1: 3926, 2: 2308, 0: 1457})

Epoch :  46 loss training:  2.303173199732555 Time :  7345
accuracy train: 0.996364 val: 0.972727 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({1: 3925, 0: 2308, 2: 1458})

Epoch :  47 loss training:  1.822494575753808 Time :  7386
accuracy train: 0.996768 val: 0.970909 test: 0.966667
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({0: 3926, 1: 2308, 2: 1457})

Epoch :  48 loss training:  1.8230925428360933 Time :  7433
accuracy train: 0.997172 val: 0.974545 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({0: 3925, 1: 2307, 2: 1459})

Epoch :  49 loss training:  1.682311468422995 Time :  7479
accuracy train: 0.996970 val: 0.974545 test: 0.970320
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({0: 3925, 1: 2307, 2: 1459})

Epoch :  50 loss training:  1.6371073954942403 Time :  7525
accuracy train: 0.996970 val: 0.974545 test: 0.968950
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({1: 3925, 0: 2307, 2: 1459})

Epoch :  51 loss training:  1.805798035056796 Time :  7573
accuracy train: 0.996970 val: 0.972727 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({1: 3925, 0: 2307, 2: 1459})

Epoch :  52 loss training:  1.9208045610357658 Time :  7620
accuracy train: 0.996768 val: 0.972727 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({0: 3926, 1: 2306, 2: 1459})

Epoch :  53 loss training:  1.8029718511097599 Time :  7672
accuracy train: 0.996364 val: 0.976364 test: 0.968950
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({1: 3926, 2: 2306, 0: 1459})

Epoch :  54 loss training:  1.6453417170559987 Time :  7717
accuracy train: 0.997172 val: 0.976364 test: 0.968950
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({0: 3926, 2: 2306, 1: 1459})

Epoch :  55 loss training:  1.5325605539328535 Time :  7760
accuracy train: 0.996364 val: 0.974545 test: 0.970320
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({1: 3926, 2: 2306, 0: 1459})

Epoch :  56 loss training:  1.6154844053889974 Time :  7801
accuracy train: 0.996970 val: 0.974545 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({0: 3925, 1: 2307, 2: 1459})

Epoch :  57 loss training:  1.4993629759628675 Time :  7851
accuracy train: 0.996566 val: 0.974545 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({1: 3925, 2: 2307, 0: 1459})

Epoch :  58 loss training:  1.478209703680477 Time :  7900
accuracy train: 0.996566 val: 0.976364 test: 0.966667
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({1: 3924, 2: 2308, 0: 1459})

Epoch :  59 loss training:  1.4948358560832276 Time :  7951
accuracy train: 0.996970 val: 0.974545 test: 0.966667
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({0: 3923, 1: 2308, 2: 1460})

Epoch :  60 loss training:  1.4724755413262756 Time :  8002
accuracy train: 0.997172 val: 0.969091 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({0: 3923, 1: 2308, 2: 1460})

Epoch :  61 loss training:  1.3363696424166847 Time :  8048
accuracy train: 0.997172 val: 0.969091 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({0: 3923, 1: 2308, 2: 1460})

Epoch :  62 loss training:  1.7730686806316953 Time :  8098
accuracy train: 0.996768 val: 0.974545 test: 0.968950
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({0: 3926, 1: 2308, 2: 1457})

Epoch :  63 loss training:  1.5018200729609816 Time :  8140
accuracy train: 0.996566 val: 0.974545 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({1: 3925, 0: 2309, 2: 1457})

Epoch :  64 loss training:  1.430090036796173 Time :  8181
accuracy train: 0.996768 val: 0.974545 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({2: 3925, 0: 2308, 1: 1458})

Epoch :  65 loss training:  1.2501972182326426 Time :  8227
accuracy train: 0.996768 val: 0.974545 test: 0.968037
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({1: 3925, 2: 2307, 0: 1459})

Epoch :  66 loss training:  1.5643527606252974 Time :  8272
accuracy train: 0.996566 val: 0.976364 test: 0.968493
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({0: 3926, 1: 2306, 2: 1459})

Epoch :  67 loss training:  1.2200874752743402 Time :  8320
accuracy train: 0.996566 val: 0.974545 test: 0.967123
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({1: 3925, 0: 2307, 2: 1459})

Epoch :  68 loss training:  1.4984245547475439 Time :  8357
accuracy train: 0.996768 val: 0.974545 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({0: 3925, 1: 2306, 2: 1460})

Epoch :  69 loss training:  1.4040977362747071 Time :  8405
accuracy train: 0.997374 val: 0.980000 test: 0.968493
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({0: 3925, 1: 2306, 2: 1460})

Epoch :  70 loss training:  1.4759772567631444 Time :  8451
accuracy train: 0.996768 val: 0.972727 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 39 test accuracy : 0.969863
Counter({1: 3925, 2: 2302, 0: 1464})

========================================================================================================================================================================================================
max acc epoch :  39
max validation accuracy :  0.98
test accuracy :  0.9698630136986301
last test_accuracy :  0.9698630136986301
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=711, weight_decay=0)
device :  cuda:0
Counter({2: 4230, 0: 2303, 1: 1158})

Epoch :  1 loss training:  42.05976889282465 Time :  8644
accuracy train: 0.961826 val: 0.947273 test: 0.944292
max validation accuracy : 0.947273 max acc epoch : 1 test accuracy : 0.944292
Counter({0: 3809, 2: 2401, 1: 1481})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  16.133142180973664 Time :  8693
accuracy train: 0.950515 val: 0.943636 test: 0.942009
max validation accuracy : 0.947273 max acc epoch : 1 test accuracy : 0.944292
Counter({0: 3836, 1: 2441, 2: 1414})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  17.58264763932675 Time :  8745
accuracy train: 0.965260 val: 0.969091 test: 0.962100
max validation accuracy : 0.969091 max acc epoch : 3 test accuracy : 0.962100
Counter({0: 3833, 1: 2379, 2: 1479})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.177103147376329 Time :  8800
accuracy train: 0.985054 val: 0.970909 test: 0.968037
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.968037
Counter({1: 3828, 0: 2358, 2: 1505})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.132425488671288 Time :  8858
accuracy train: 0.980206 val: 0.974545 test: 0.965297
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.965297
Counter({1: 3842, 0: 2355, 2: 1494})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.602219453896396 Time :  8911
accuracy train: 0.986467 val: 0.972727 test: 0.962557
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.965297
Counter({0: 3862, 2: 2351, 1: 1478})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.278407369507477 Time :  8961
accuracy train: 0.989901 val: 0.970909 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.965297
Counter({1: 3876, 2: 2342, 0: 1473})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.0015901032602414 Time :  9015
accuracy train: 0.990103 val: 0.965455 test: 0.966210
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.965297
Counter({1: 3887, 0: 2339, 2: 1465})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.551144260913134 Time :  9066
accuracy train: 0.988285 val: 0.970909 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.965297
Counter({1: 3895, 2: 2340, 0: 1456})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.403482696507126 Time :  9111
accuracy train: 0.990911 val: 0.970909 test: 0.965297
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.965297
Counter({0: 3896, 1: 2339, 2: 1456})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.276758088497445 Time :  9167
accuracy train: 0.991921 val: 0.970909 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.965297
Counter({1: 3901, 2: 2337, 0: 1453})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.852906555170193 Time :  9214
accuracy train: 0.993739 val: 0.970909 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.965297
Counter({1: 3907, 2: 2332, 0: 1452})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  4.192608865909278 Time :  9264
accuracy train: 0.993739 val: 0.974545 test: 0.967123
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.965297
Counter({1: 3912, 2: 2330, 0: 1449})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.197465826757252 Time :  9311
accuracy train: 0.994143 val: 0.974545 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.965297
Counter({2: 3918, 1: 2324, 0: 1449})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  4.068076320108958 Time :  9358
accuracy train: 0.994143 val: 0.974545 test: 0.967123
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.965297
Counter({1: 3920, 0: 2326, 2: 1445})

Epoch :  16 loss training:  3.5312936930567957 Time :  9408
accuracy train: 0.994547 val: 0.976364 test: 0.967123
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({0: 3920, 1: 2325, 2: 1446})

Epoch :  17 loss training:  3.6016616482520476 Time :  9457
accuracy train: 0.994951 val: 0.974545 test: 0.968493
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({1: 3922, 2: 2327, 0: 1442})

Epoch :  18 loss training:  3.4279633060796186 Time :  9507
accuracy train: 0.994345 val: 0.976364 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({0: 3921, 2: 2328, 1: 1442})

Epoch :  19 loss training:  3.176255072175991 Time :  9560
accuracy train: 0.994345 val: 0.972727 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({1: 3922, 2: 2331, 0: 1438})

Epoch :  20 loss training:  2.985778182512149 Time :  9606
accuracy train: 0.994951 val: 0.974545 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({0: 3922, 1: 2333, 2: 1436})

Epoch :  21 loss training:  3.114321798144374 Time :  9647
accuracy train: 0.995152 val: 0.974545 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({0: 3922, 1: 2333, 2: 1436})

Epoch :  22 loss training:  3.180815203639213 Time :  9698
accuracy train: 0.995152 val: 0.970909 test: 0.966667
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({1: 3923, 2: 2332, 0: 1436})

Epoch :  23 loss training:  3.111721859080717 Time :  9747
accuracy train: 0.995556 val: 0.972727 test: 0.968493
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({2: 3923, 0: 2327, 1: 1441})

Epoch :  24 loss training:  2.5619998939801008 Time :  9792
accuracy train: 0.995354 val: 0.972727 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({1: 3925, 2: 2324, 0: 1442})

Epoch :  25 loss training:  2.849097494909074 Time :  9837
accuracy train: 0.995152 val: 0.972727 test: 0.965753
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({0: 3926, 1: 2324, 2: 1441})

Epoch :  26 loss training:  2.8292807011166587 Time :  9883
accuracy train: 0.995556 val: 0.974545 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({2: 3926, 1: 2324, 0: 1441})

Epoch :  27 loss training:  2.572693509806413 Time :  9931
accuracy train: 0.995556 val: 0.970909 test: 0.967580
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({1: 3926, 2: 2324, 0: 1441})

Epoch :  28 loss training:  2.554316326219123 Time :  9977
accuracy train: 0.995152 val: 0.974545 test: 0.967580
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({1: 3927, 2: 2323, 0: 1441})

Epoch :  29 loss training:  2.4879352207062766 Time :  10023
accuracy train: 0.995354 val: 0.974545 test: 0.966667
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({0: 3927, 1: 2323, 2: 1441})

Epoch :  30 loss training:  2.2282698864291888 Time :  10074
accuracy train: 0.996162 val: 0.976364 test: 0.968493
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({0: 3927, 1: 2320, 2: 1444})

Epoch :  31 loss training:  2.356364643026609 Time :  10121
accuracy train: 0.995758 val: 0.970909 test: 0.968950
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({0: 3927, 2: 2318, 1: 1446})

Epoch :  32 loss training:  2.4589185205404647 Time :  10166
accuracy train: 0.996162 val: 0.972727 test: 0.967123
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({1: 3927, 0: 2316, 2: 1448})

Epoch :  33 loss training:  2.3379666750406614 Time :  10212
accuracy train: 0.995556 val: 0.972727 test: 0.968950
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({1: 3927, 2: 2315, 0: 1449})

Epoch :  34 loss training:  2.1385063805792015 Time :  10255
accuracy train: 0.995556 val: 0.970909 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({1: 3927, 0: 2315, 2: 1449})

Epoch :  35 loss training:  2.1234319665527437 Time :  10300
accuracy train: 0.995354 val: 0.972727 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({1: 3928, 0: 2314, 2: 1449})

Epoch :  36 loss training:  1.9884490777330939 Time :  10349
accuracy train: 0.996162 val: 0.974545 test: 0.966210
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({0: 3928, 1: 2312, 2: 1451})

Epoch :  37 loss training:  2.042296145024011 Time :  10399
accuracy train: 0.996566 val: 0.972727 test: 0.966667
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({1: 3930, 2: 2310, 0: 1451})

Epoch :  38 loss training:  2.11458561787731 Time :  10452
accuracy train: 0.996566 val: 0.972727 test: 0.964840
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({1: 3931, 0: 2309, 2: 1451})

Epoch :  39 loss training:  2.2243304331350373 Time :  10499
accuracy train: 0.996162 val: 0.976364 test: 0.966210
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({1: 3931, 0: 2309, 2: 1451})

Epoch :  40 loss training:  2.000755702581955 Time :  10551
accuracy train: 0.996162 val: 0.970909 test: 0.966667
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({1: 3931, 0: 2308, 2: 1452})

Epoch :  41 loss training:  1.7722097669902723 Time :  10594
accuracy train: 0.996364 val: 0.972727 test: 0.968493
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({0: 3931, 1: 2305, 2: 1455})

Epoch :  42 loss training:  1.8234843928948976 Time :  10643
accuracy train: 0.996768 val: 0.972727 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({1: 3931, 0: 2304, 2: 1456})

Epoch :  43 loss training:  1.90376554375689 Time :  10690
accuracy train: 0.996566 val: 0.972727 test: 0.967580
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({1: 3931, 0: 2303, 2: 1457})

Epoch :  44 loss training:  1.8425107076764107 Time :  10743
accuracy train: 0.996970 val: 0.974545 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({0: 3929, 1: 2303, 2: 1459})

Epoch :  45 loss training:  2.33686169826251 Time :  10785
accuracy train: 0.996162 val: 0.970909 test: 0.967123
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({2: 3929, 1: 2303, 0: 1459})

Epoch :  46 loss training:  2.284559378531412 Time :  10831
accuracy train: 0.996364 val: 0.972727 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({0: 3929, 1: 2303, 2: 1459})

Epoch :  47 loss training:  1.7715047027450055 Time :  10879
accuracy train: 0.996768 val: 0.972727 test: 0.966667
max validation accuracy : 0.976364 max acc epoch : 16 test accuracy : 0.967123
Counter({1: 3930, 0: 2303, 2: 1458})

========================================================================================================================================================================================================
max acc epoch :  16
max validation accuracy :  0.9763636363636363
test accuracy :  0.9671232876712329
last test_accuracy :  0.9666666666666667
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=711, weight_decay=0)
device :  cuda:0
Counter({2: 4230, 0: 2303, 1: 1158})

Epoch :  1 loss training:  42.11887721903622 Time :  11060
accuracy train: 0.961422 val: 0.943636 test: 0.943836
max validation accuracy : 0.943636 max acc epoch : 1 test accuracy : 0.943836
Counter({0: 3808, 1: 2394, 2: 1489})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  16.095453632064164 Time :  11114
accuracy train: 0.953343 val: 0.934545 test: 0.942009
max validation accuracy : 0.943636 max acc epoch : 1 test accuracy : 0.943836
Counter({1: 3826, 2: 2740, 0: 1125})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.821263123303652 Time :  11172
accuracy train: 0.971319 val: 0.963636 test: 0.961644
max validation accuracy : 0.963636 max acc epoch : 3 test accuracy : 0.961644
Counter({0: 3833, 1: 2455, 2: 1403})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.849331559147686 Time :  11232
accuracy train: 0.984852 val: 0.967273 test: 0.968950
max validation accuracy : 0.967273 max acc epoch : 4 test accuracy : 0.968950
Counter({1: 3847, 2: 2405, 0: 1439})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.084086992545053 Time :  11283
accuracy train: 0.980004 val: 0.970909 test: 0.968493
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.968493
Counter({1: 3849, 2: 2372, 0: 1470})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.596471120603383 Time :  11329
accuracy train: 0.985861 val: 0.976364 test: 0.959817
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({2: 3867, 1: 2364, 0: 1460})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.2207107150461525 Time :  11374
accuracy train: 0.989901 val: 0.972727 test: 0.967123
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({0: 3883, 1: 2347, 2: 1461})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.915001037414186 Time :  11429
accuracy train: 0.990103 val: 0.972727 test: 0.965297
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({1: 3885, 0: 2347, 2: 1459})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.797200165106915 Time :  11471
accuracy train: 0.988487 val: 0.967273 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({1: 3887, 2: 2353, 0: 1451})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.315350107033737 Time :  11517
accuracy train: 0.991719 val: 0.969091 test: 0.968493
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({0: 3887, 1: 2353, 2: 1451})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.189789883908816 Time :  11569
accuracy train: 0.992123 val: 0.970909 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({1: 3896, 2: 2348, 0: 1447})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.8115286426618695 Time :  11621
accuracy train: 0.993941 val: 0.970909 test: 0.968950
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({0: 3905, 1: 2341, 2: 1445})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  4.291496991063468 Time :  11666
accuracy train: 0.993537 val: 0.972727 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({1: 3910, 2: 2338, 0: 1443})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.2574589513242245 Time :  11715
accuracy train: 0.994345 val: 0.970909 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({0: 3914, 1: 2335, 2: 1442})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  4.029639441054314 Time :  11768
accuracy train: 0.994345 val: 0.967273 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({1: 3915, 0: 2334, 2: 1442})

Epoch :  16 loss training:  3.4453163656871766 Time :  11810
accuracy train: 0.994951 val: 0.970909 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({0: 3915, 1: 2334, 2: 1442})

Epoch :  17 loss training:  3.46789176389575 Time :  11857
accuracy train: 0.994749 val: 0.967273 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({1: 3916, 2: 2335, 0: 1440})

Epoch :  18 loss training:  3.5569646557269152 Time :  11905
accuracy train: 0.994143 val: 0.967273 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({0: 3917, 1: 2334, 2: 1440})

Epoch :  19 loss training:  3.1690425160632003 Time :  11946
accuracy train: 0.994547 val: 0.969091 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({0: 3917, 1: 2335, 2: 1439})

Epoch :  20 loss training:  3.0659243173140567 Time :  11998
accuracy train: 0.994345 val: 0.967273 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({0: 3917, 1: 2335, 2: 1439})

Epoch :  21 loss training:  3.0913301247055642 Time :  12049
accuracy train: 0.994951 val: 0.969091 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({0: 3918, 2: 2332, 1: 1441})

Epoch :  22 loss training:  3.2562925897655077 Time :  12096
accuracy train: 0.994951 val: 0.969091 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({1: 3921, 2: 2329, 0: 1441})

Epoch :  23 loss training:  3.0440113981603645 Time :  12141
accuracy train: 0.994951 val: 0.967273 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({1: 3921, 0: 2326, 2: 1444})

Epoch :  24 loss training:  2.484887186787091 Time :  12190
accuracy train: 0.995354 val: 0.969091 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({0: 3921, 1: 2323, 2: 1447})

Epoch :  25 loss training:  2.796510904241586 Time :  12241
accuracy train: 0.995556 val: 0.965455 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({1: 3921, 0: 2323, 2: 1447})

Epoch :  26 loss training:  2.9038396281248424 Time :  12289
accuracy train: 0.996162 val: 0.969091 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({1: 3922, 2: 2323, 0: 1446})

Epoch :  27 loss training:  2.468015518214088 Time :  12336
accuracy train: 0.995354 val: 0.969091 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({1: 3923, 2: 2318, 0: 1450})

Epoch :  28 loss training:  2.535010446968954 Time :  12392
accuracy train: 0.995960 val: 0.972727 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({1: 3924, 2: 2319, 0: 1448})

Epoch :  29 loss training:  2.407567252579611 Time :  12446
accuracy train: 0.995758 val: 0.974545 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({0: 3924, 1: 2317, 2: 1450})

Epoch :  30 loss training:  2.3723840423917864 Time :  12497
accuracy train: 0.995758 val: 0.970909 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({0: 3924, 1: 2316, 2: 1451})

Epoch :  31 loss training:  2.276255928678438 Time :  12548
accuracy train: 0.995960 val: 0.970909 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({0: 3927, 1: 2311, 2: 1453})

Epoch :  32 loss training:  2.3592902143718675 Time :  12594
accuracy train: 0.996162 val: 0.967273 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({1: 3927, 0: 2309, 2: 1455})

Epoch :  33 loss training:  2.2914663997653406 Time :  12642
accuracy train: 0.995960 val: 0.969091 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({1: 3927, 2: 2308, 0: 1456})

Epoch :  34 loss training:  2.090684137350763 Time :  12684
accuracy train: 0.996162 val: 0.969091 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({1: 3927, 0: 2308, 2: 1456})

Epoch :  35 loss training:  2.0855876631685533 Time :  12729
accuracy train: 0.995758 val: 0.967273 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({1: 3927, 0: 2307, 2: 1457})

Epoch :  36 loss training:  2.0183958190318663 Time :  12772
accuracy train: 0.996566 val: 0.970909 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({1: 3927, 2: 2304, 0: 1460})

Epoch :  37 loss training:  2.0715223152947146 Time :  12816
accuracy train: 0.996566 val: 0.972727 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.959817
Counter({1: 3927, 2: 2305, 0: 1459})

========================================================================================================================================================================================================
max acc epoch :  6
max validation accuracy :  0.9763636363636363
test accuracy :  0.9598173515981735
last test_accuracy :  0.9703196347031964
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.97636 	 test_accuracy : 0.96484 	 max_acc epoch :  6 	 last test_accuracy : 0.97123
k :  1 	 val_accuracy : 0.97636 	 test_accuracy : 0.96986 	 max_acc epoch :  11 	 last test_accuracy : 0.96895
k :  2 	 val_accuracy : 0.98000 	 test_accuracy : 0.96986 	 max_acc epoch :  39 	 last test_accuracy : 0.96986
k :  3 	 val_accuracy : 0.97636 	 test_accuracy : 0.96712 	 max_acc epoch :  16 	 last test_accuracy : 0.96667
k :  4 	 val_accuracy : 0.97636 	 test_accuracy : 0.95982 	 max_acc epoch :  6 	 last test_accuracy : 0.97032

avg :  	 val_accuracy : 0.97709 	 test_accuracy : 0.96630 	 last_accuracy : 0.96941
