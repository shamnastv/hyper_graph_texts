

date and time :  Fri Jul  9 16:31:32 2021
itr : 0
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=614, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  121.74130809307098 Time :  16
accuracy train: 0.897696 val: 0.887195 test: 0.891440
max validation accuracy : 0.887195 max acc epoch : 1 test accuracy : 0.891440
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.64467879384756 Time :  31
accuracy train: 0.939024 val: 0.913110 test: 0.919066
max validation accuracy : 0.913110 max acc epoch : 2 test accuracy : 0.919066
Epoch-2 lr: 0.001

Epoch :  3 loss training:  39.312554985284805 Time :  45
accuracy train: 0.962398 val: 0.940549 test: 0.932685
max validation accuracy : 0.940549 max acc epoch : 3 test accuracy : 0.932685
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  25.91142174601555 Time :  60
accuracy train: 0.975440 val: 0.945122 test: 0.934630
max validation accuracy : 0.945122 max acc epoch : 4 test accuracy : 0.934630
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  21.973894461989403 Time :  74
accuracy train: 0.976965 val: 0.949695 test: 0.936576
max validation accuracy : 0.949695 max acc epoch : 5 test accuracy : 0.936576
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  18.867514743469656 Time :  89
accuracy train: 0.974932 val: 0.940549 test: 0.942802
max validation accuracy : 0.949695 max acc epoch : 5 test accuracy : 0.936576
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  16.051733588799834 Time :  103
accuracy train: 0.986450 val: 0.954268 test: 0.943969
max validation accuracy : 0.954268 max acc epoch : 7 test accuracy : 0.943969
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  13.63514718785882 Time :  117
accuracy train: 0.986619 val: 0.945122 test: 0.945136
max validation accuracy : 0.954268 max acc epoch : 7 test accuracy : 0.943969
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  12.909387037158012 Time :  132
accuracy train: 0.990007 val: 0.955793 test: 0.942802
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.942802
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  11.903912704903632 Time :  146
accuracy train: 0.991362 val: 0.946646 test: 0.944358
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.942802

Epoch :  11 loss training:  11.637119140475988 Time :  162
accuracy train: 0.991023 val: 0.949695 test: 0.941634
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.942802

Epoch :  12 loss training:  10.491525925463066 Time :  177
accuracy train: 0.992717 val: 0.954268 test: 0.944358
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.942802

Epoch :  13 loss training:  9.275223966687918 Time :  193
accuracy train: 0.992717 val: 0.955793 test: 0.945914
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.942802

Epoch :  14 loss training:  8.537334892200306 Time :  208
accuracy train: 0.993564 val: 0.955793 test: 0.948249
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.942802

Epoch :  15 loss training:  8.011895154602826 Time :  224
accuracy train: 0.993225 val: 0.949695 test: 0.949027
max validation accuracy : 0.955793 max acc epoch : 9 test accuracy : 0.942802

Epoch :  16 loss training:  7.926231030840427 Time :  240
accuracy train: 0.994072 val: 0.958841 test: 0.947082
max validation accuracy : 0.958841 max acc epoch : 16 test accuracy : 0.947082

Epoch :  17 loss training:  7.642538212006912 Time :  255
accuracy train: 0.994580 val: 0.955793 test: 0.946304
max validation accuracy : 0.958841 max acc epoch : 16 test accuracy : 0.947082

Epoch :  18 loss training:  7.028613474685699 Time :  270
accuracy train: 0.994919 val: 0.955793 test: 0.949027
max validation accuracy : 0.958841 max acc epoch : 16 test accuracy : 0.947082

Epoch :  19 loss training:  6.67231360450387 Time :  286
accuracy train: 0.995088 val: 0.957317 test: 0.947082
max validation accuracy : 0.958841 max acc epoch : 16 test accuracy : 0.947082

Epoch :  20 loss training:  6.43509997962974 Time :  301
accuracy train: 0.994919 val: 0.958841 test: 0.946304
max validation accuracy : 0.958841 max acc epoch : 16 test accuracy : 0.947082

Epoch :  21 loss training:  5.788953687530011 Time :  317
accuracy train: 0.995596 val: 0.958841 test: 0.946693
max validation accuracy : 0.958841 max acc epoch : 16 test accuracy : 0.947082

Epoch :  22 loss training:  5.634153425926343 Time :  332
accuracy train: 0.995427 val: 0.954268 test: 0.946304
max validation accuracy : 0.958841 max acc epoch : 16 test accuracy : 0.947082

Epoch :  23 loss training:  5.006218024762347 Time :  348
accuracy train: 0.996104 val: 0.960366 test: 0.946693
max validation accuracy : 0.960366 max acc epoch : 23 test accuracy : 0.946693

Epoch :  24 loss training:  5.417076711077243 Time :  364
accuracy train: 0.996104 val: 0.955793 test: 0.948638
max validation accuracy : 0.960366 max acc epoch : 23 test accuracy : 0.946693

Epoch :  25 loss training:  5.190362422261387 Time :  379
accuracy train: 0.995935 val: 0.957317 test: 0.948638
max validation accuracy : 0.960366 max acc epoch : 23 test accuracy : 0.946693

Epoch :  26 loss training:  5.633934667275753 Time :  394
accuracy train: 0.996104 val: 0.964939 test: 0.949416
max validation accuracy : 0.964939 max acc epoch : 26 test accuracy : 0.949416

Epoch :  27 loss training:  4.538388628687244 Time :  410
accuracy train: 0.995935 val: 0.966463 test: 0.947471
max validation accuracy : 0.966463 max acc epoch : 27 test accuracy : 0.947471

Epoch :  28 loss training:  4.4703858197899535 Time :  425
accuracy train: 0.995766 val: 0.958841 test: 0.947082
max validation accuracy : 0.966463 max acc epoch : 27 test accuracy : 0.947471

Epoch :  29 loss training:  4.457245384575799 Time :  441
accuracy train: 0.996274 val: 0.960366 test: 0.945525
max validation accuracy : 0.966463 max acc epoch : 27 test accuracy : 0.947471

Epoch :  30 loss training:  3.861896584974602 Time :  456
accuracy train: 0.996612 val: 0.966463 test: 0.945914
max validation accuracy : 0.966463 max acc epoch : 27 test accuracy : 0.947471

Epoch :  31 loss training:  3.7924414380686358 Time :  472
accuracy train: 0.996274 val: 0.966463 test: 0.948249
max validation accuracy : 0.966463 max acc epoch : 27 test accuracy : 0.947471

Epoch :  32 loss training:  4.079970858525485 Time :  487
accuracy train: 0.997121 val: 0.967988 test: 0.949027
max validation accuracy : 0.967988 max acc epoch : 32 test accuracy : 0.949027

Epoch :  33 loss training:  3.6677730408264324 Time :  503
accuracy train: 0.996612 val: 0.961890 test: 0.948249
max validation accuracy : 0.967988 max acc epoch : 32 test accuracy : 0.949027

Epoch :  34 loss training:  3.4321487795677967 Time :  518
accuracy train: 0.996443 val: 0.960366 test: 0.942412
max validation accuracy : 0.967988 max acc epoch : 32 test accuracy : 0.949027

Epoch :  35 loss training:  3.3939276034361683 Time :  534
accuracy train: 0.996612 val: 0.963415 test: 0.948638
max validation accuracy : 0.967988 max acc epoch : 32 test accuracy : 0.949027

Epoch :  36 loss training:  3.736411656718701 Time :  549
accuracy train: 0.996443 val: 0.963415 test: 0.946304
max validation accuracy : 0.967988 max acc epoch : 32 test accuracy : 0.949027

Epoch :  37 loss training:  3.3735091820708476 Time :  565
accuracy train: 0.996782 val: 0.961890 test: 0.942412
max validation accuracy : 0.967988 max acc epoch : 32 test accuracy : 0.949027

Epoch :  38 loss training:  3.30528647423489 Time :  580
accuracy train: 0.996443 val: 0.960366 test: 0.943969
max validation accuracy : 0.967988 max acc epoch : 32 test accuracy : 0.949027

Epoch :  39 loss training:  3.1356868503498845 Time :  596
accuracy train: 0.996612 val: 0.961890 test: 0.943191
max validation accuracy : 0.967988 max acc epoch : 32 test accuracy : 0.949027

Epoch :  40 loss training:  2.9481372921727598 Time :  611
accuracy train: 0.996612 val: 0.964939 test: 0.943969
max validation accuracy : 0.967988 max acc epoch : 32 test accuracy : 0.949027

Epoch :  41 loss training:  3.2544944746769033 Time :  627
accuracy train: 0.996782 val: 0.961890 test: 0.944358
max validation accuracy : 0.967988 max acc epoch : 32 test accuracy : 0.949027

Epoch :  42 loss training:  2.899734606326092 Time :  642
accuracy train: 0.996443 val: 0.961890 test: 0.947082
max validation accuracy : 0.967988 max acc epoch : 32 test accuracy : 0.949027

Epoch :  43 loss training:  2.9496867904090323 Time :  657
accuracy train: 0.996443 val: 0.967988 test: 0.945525
max validation accuracy : 0.967988 max acc epoch : 32 test accuracy : 0.949027

Epoch :  44 loss training:  2.881142369704321 Time :  673
accuracy train: 0.996951 val: 0.964939 test: 0.947082
max validation accuracy : 0.967988 max acc epoch : 32 test accuracy : 0.949027

Epoch :  45 loss training:  2.5612028863833984 Time :  688
accuracy train: 0.996274 val: 0.960366 test: 0.945525
max validation accuracy : 0.967988 max acc epoch : 32 test accuracy : 0.949027

Epoch :  46 loss training:  2.963207864027936 Time :  704
accuracy train: 0.996612 val: 0.961890 test: 0.947082
max validation accuracy : 0.967988 max acc epoch : 32 test accuracy : 0.949027

Epoch :  47 loss training:  2.497841114993207 Time :  720
accuracy train: 0.996782 val: 0.964939 test: 0.947082
max validation accuracy : 0.967988 max acc epoch : 32 test accuracy : 0.949027

Epoch :  48 loss training:  3.2491348895273404 Time :  735
accuracy train: 0.996782 val: 0.958841 test: 0.946693
max validation accuracy : 0.967988 max acc epoch : 32 test accuracy : 0.949027

Epoch :  49 loss training:  3.021950025926344 Time :  751
accuracy train: 0.996443 val: 0.961890 test: 0.945914
max validation accuracy : 0.967988 max acc epoch : 32 test accuracy : 0.949027

Epoch :  50 loss training:  2.6490608152817003 Time :  766
accuracy train: 0.996782 val: 0.961890 test: 0.943191
max validation accuracy : 0.967988 max acc epoch : 32 test accuracy : 0.949027

Epoch :  51 loss training:  2.449712324596476 Time :  781
accuracy train: 0.997121 val: 0.964939 test: 0.947082
max validation accuracy : 0.967988 max acc epoch : 32 test accuracy : 0.949027

Epoch :  52 loss training:  2.704480748187052 Time :  797
accuracy train: 0.996951 val: 0.966463 test: 0.948638
max validation accuracy : 0.967988 max acc epoch : 32 test accuracy : 0.949027

Epoch :  53 loss training:  2.378866406957968 Time :  812
accuracy train: 0.996443 val: 0.966463 test: 0.943969
max validation accuracy : 0.967988 max acc epoch : 32 test accuracy : 0.949027

Epoch :  54 loss training:  2.8331453024293296 Time :  828
accuracy train: 0.996612 val: 0.971037 test: 0.949805
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  55 loss training:  2.6731476081477012 Time :  843
accuracy train: 0.996612 val: 0.963415 test: 0.947860
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  56 loss training:  2.4338547717488836 Time :  859
accuracy train: 0.996612 val: 0.964939 test: 0.945136
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  57 loss training:  2.342488725334988 Time :  874
accuracy train: 0.996782 val: 0.967988 test: 0.945136
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  58 loss training:  2.479070406014216 Time :  890
accuracy train: 0.996782 val: 0.961890 test: 0.941245
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  59 loss training:  2.1550838479743106 Time :  905
accuracy train: 0.996612 val: 0.967988 test: 0.947082
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  60 loss training:  2.0637223634839756 Time :  921
accuracy train: 0.996782 val: 0.963415 test: 0.945525
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  61 loss training:  2.2479363377351547 Time :  936
accuracy train: 0.997121 val: 0.963415 test: 0.943969
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  62 loss training:  2.4469858993397793 Time :  952
accuracy train: 0.996612 val: 0.960366 test: 0.945525
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  63 loss training:  2.217108124321385 Time :  967
accuracy train: 0.996612 val: 0.963415 test: 0.945914
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  64 loss training:  2.672944175734301 Time :  983
accuracy train: 0.996612 val: 0.966463 test: 0.945914
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  65 loss training:  2.3134238852653652 Time :  998
accuracy train: 0.996782 val: 0.966463 test: 0.945914
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  66 loss training:  2.4206315351329977 Time :  1014
accuracy train: 0.996782 val: 0.964939 test: 0.945136
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  67 loss training:  2.4684018639600254 Time :  1029
accuracy train: 0.996951 val: 0.964939 test: 0.944747
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  68 loss training:  2.037086529766384 Time :  1045
accuracy train: 0.996612 val: 0.964939 test: 0.949027
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  69 loss training:  2.2563114940130617 Time :  1060
accuracy train: 0.996612 val: 0.961890 test: 0.947471
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  70 loss training:  2.178794709543581 Time :  1076
accuracy train: 0.997121 val: 0.963415 test: 0.945525
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  71 loss training:  1.9583607287713676 Time :  1091
accuracy train: 0.996612 val: 0.961890 test: 0.948638
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  72 loss training:  2.18287335500645 Time :  1107
accuracy train: 0.996951 val: 0.967988 test: 0.949027
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  73 loss training:  2.178654072828067 Time :  1122
accuracy train: 0.996612 val: 0.966463 test: 0.949416
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  74 loss training:  2.1696830540677183 Time :  1138
accuracy train: 0.996612 val: 0.958841 test: 0.945136
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  75 loss training:  2.1040637130936375 Time :  1153
accuracy train: 0.996782 val: 0.969512 test: 0.949805
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  76 loss training:  2.4583977059155586 Time :  1169
accuracy train: 0.996612 val: 0.957317 test: 0.945525
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  77 loss training:  2.0624109580603545 Time :  1184
accuracy train: 0.996612 val: 0.964939 test: 0.949027
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  78 loss training:  1.8971723086942802 Time :  1200
accuracy train: 0.997121 val: 0.960366 test: 0.949027
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  79 loss training:  1.785716643826163 Time :  1215
accuracy train: 0.997121 val: 0.964939 test: 0.948249
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  80 loss training:  1.8687948282022262 Time :  1231
accuracy train: 0.997121 val: 0.966463 test: 0.946304
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  81 loss training:  1.9993774036629475 Time :  1246
accuracy train: 0.996951 val: 0.963415 test: 0.950584
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  82 loss training:  2.1313158743178064 Time :  1262
accuracy train: 0.996612 val: 0.966463 test: 0.950584
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  83 loss training:  2.032620670113829 Time :  1277
accuracy train: 0.996951 val: 0.964939 test: 0.946304
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  84 loss training:  2.0217894933375646 Time :  1292
accuracy train: 0.996951 val: 0.963415 test: 0.949416
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

Epoch :  85 loss training:  2.2151674282140448 Time :  1308
accuracy train: 0.996951 val: 0.964939 test: 0.949805
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.949805

========================================================================================================================================================================================================
best acc epoch :  54
validation accuracy :  0.9710365853658537
test accuracy :  0.9498054474708171
last test_accuracy :  0.9498054474708171
second best val :  0.9695121951219512
second best test :  0.9498054474708171
max gap 22
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=160, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  126.55076678097248 Time :  1324
accuracy train: 0.912432 val: 0.900915 test: 0.882879
max validation accuracy : 0.900915 max acc epoch : 1 test accuracy : 0.882879
Epoch-1 lr: 0.001

Epoch :  2 loss training:  54.275566421449184 Time :  1339
accuracy train: 0.939871 val: 0.920732 test: 0.908949
max validation accuracy : 0.920732 max acc epoch : 2 test accuracy : 0.908949
Epoch-2 lr: 0.001

Epoch :  3 loss training:  40.59042788669467 Time :  1353
accuracy train: 0.953252 val: 0.923780 test: 0.917510
max validation accuracy : 0.923780 max acc epoch : 3 test accuracy : 0.917510
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  26.590428406372666 Time :  1368
accuracy train: 0.964262 val: 0.929878 test: 0.918288
max validation accuracy : 0.929878 max acc epoch : 4 test accuracy : 0.918288
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  22.89772222749889 Time :  1383
accuracy train: 0.978150 val: 0.939024 test: 0.933463
max validation accuracy : 0.939024 max acc epoch : 5 test accuracy : 0.933463
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  20.52236940525472 Time :  1397
accuracy train: 0.979336 val: 0.940549 test: 0.935019
max validation accuracy : 0.940549 max acc epoch : 6 test accuracy : 0.935019
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  14.933402315713465 Time :  1412
accuracy train: 0.985264 val: 0.957317 test: 0.939300
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  14.61707033123821 Time :  1427
accuracy train: 0.987974 val: 0.948171 test: 0.941245
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  12.659251716919243 Time :  1441
accuracy train: 0.989499 val: 0.948171 test: 0.942023
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  11.290747190825641 Time :  1456
accuracy train: 0.990854 val: 0.946646 test: 0.940467
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  11 loss training:  10.305920858401805 Time :  1472
accuracy train: 0.990854 val: 0.949695 test: 0.941634
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  12 loss training:  9.798375776968896 Time :  1487
accuracy train: 0.992378 val: 0.952744 test: 0.941634
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  13 loss training:  10.024451627163216 Time :  1503
accuracy train: 0.993056 val: 0.954268 test: 0.942412
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  14 loss training:  9.030571681912988 Time :  1518
accuracy train: 0.993733 val: 0.952744 test: 0.943580
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  15 loss training:  8.33903844235465 Time :  1534
accuracy train: 0.994580 val: 0.951220 test: 0.943191
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  16 loss training:  8.024482416920364 Time :  1549
accuracy train: 0.994749 val: 0.943598 test: 0.942412
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  17 loss training:  7.712876865640283 Time :  1563
accuracy train: 0.995427 val: 0.946646 test: 0.940856
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  18 loss training:  6.4026669235900044 Time :  1578
accuracy train: 0.995088 val: 0.948171 test: 0.941245
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  19 loss training:  6.395936749177054 Time :  1592
accuracy train: 0.995596 val: 0.948171 test: 0.945525
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  20 loss training:  5.817598602036014 Time :  1607
accuracy train: 0.996104 val: 0.948171 test: 0.942023
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  21 loss training:  5.85851862153504 Time :  1621
accuracy train: 0.996104 val: 0.951220 test: 0.943191
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  22 loss training:  5.90895934519358 Time :  1635
accuracy train: 0.995935 val: 0.946646 test: 0.940078
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  23 loss training:  5.488784401211888 Time :  1649
accuracy train: 0.996104 val: 0.946646 test: 0.944358
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  24 loss training:  5.0314713476691395 Time :  1663
accuracy train: 0.995935 val: 0.946646 test: 0.944358
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  25 loss training:  4.681844494421966 Time :  1677
accuracy train: 0.996274 val: 0.943598 test: 0.942412
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  26 loss training:  4.987281309324317 Time :  1690
accuracy train: 0.996104 val: 0.946646 test: 0.944747
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  27 loss training:  4.414255346171558 Time :  1703
accuracy train: 0.995766 val: 0.948171 test: 0.944747
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  28 loss training:  4.688651557895355 Time :  1717
accuracy train: 0.996612 val: 0.948171 test: 0.942023
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  29 loss training:  4.031024070922285 Time :  1733
accuracy train: 0.996443 val: 0.945122 test: 0.941634
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  30 loss training:  4.374986274866387 Time :  1749
accuracy train: 0.996274 val: 0.946646 test: 0.942023
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  31 loss training:  4.040181748219766 Time :  1764
accuracy train: 0.996443 val: 0.951220 test: 0.944358
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  32 loss training:  3.859323198790662 Time :  1779
accuracy train: 0.996612 val: 0.949695 test: 0.942412
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  33 loss training:  3.604634466668358 Time :  1794
accuracy train: 0.996782 val: 0.946646 test: 0.942802
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  34 loss training:  3.2764725689194165 Time :  1808
accuracy train: 0.996782 val: 0.948171 test: 0.941245
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  35 loss training:  3.1795729731966276 Time :  1823
accuracy train: 0.996274 val: 0.946646 test: 0.940856
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  36 loss training:  3.184364321467001 Time :  1837
accuracy train: 0.996612 val: 0.946646 test: 0.940856
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  37 loss training:  3.15127872209996 Time :  1852
accuracy train: 0.996274 val: 0.949695 test: 0.938132
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

Epoch :  38 loss training:  3.0892620465601794 Time :  1866
accuracy train: 0.996612 val: 0.946646 test: 0.942412
max validation accuracy : 0.957317 max acc epoch : 7 test accuracy : 0.939300

========================================================================================================================================================================================================
best acc epoch :  7
validation accuracy :  0.9573170731707317
test accuracy :  0.9392996108949416
last test_accuracy :  0.9424124513618677
second best val :  0.9542682926829268
second best test :  0.9392996108949416
max gap 1
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  54 	 val_accuracy : 0.97104 	 test_accuracy : 0.94981 	 last test_accuracy : 0.94981 	 second best val : 0.96951 	 second best test : 0.94981
k :  1 	 best_acc epoch :  7 	 val_accuracy : 0.95732 	 test_accuracy : 0.93930 	 last test_accuracy : 0.94241 	 second best val : 0.95427 	 second best test : 0.93930

avg :  	 val_accuracy : 0.96418 	 test_accuracy : 0.94455 	 last_accuracy : 0.94611 	 second best val : 0.96189 	 second best test : 0.94455

std :  	 val_accuracy : 0.00686 	 test_accuracy : 0.00525 	 last_accuracy : 0.00370 	 second best val : 0.00762 	 second best test : 0.00525


date and time :  Fri Jul  9 17:02:49 2021
itr : 0
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=335, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  122.77334986627102 Time :  17
accuracy train: 0.914126 val: 0.914634 test: 0.889494
max validation accuracy : 0.914634 max acc epoch : 1 test accuracy : 0.889494
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.598936814814806 Time :  34
accuracy train: 0.944275 val: 0.914634 test: 0.912451
max validation accuracy : 0.914634 max acc epoch : 1 test accuracy : 0.889494
Epoch-2 lr: 0.001

Epoch :  3 loss training:  38.39693031460047 Time :  51
accuracy train: 0.945461 val: 0.908537 test: 0.902335
max validation accuracy : 0.914634 max acc epoch : 1 test accuracy : 0.889494
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  26.08742915838957 Time :  68
accuracy train: 0.972053 val: 0.942073 test: 0.934241
max validation accuracy : 0.942073 max acc epoch : 4 test accuracy : 0.934241
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  24.598573863506317 Time :  86
accuracy train: 0.963584 val: 0.925305 test: 0.928405
max validation accuracy : 0.942073 max acc epoch : 4 test accuracy : 0.934241
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  27.33848797902465 Time :  103
accuracy train: 0.970867 val: 0.935976 test: 0.933852
max validation accuracy : 0.942073 max acc epoch : 4 test accuracy : 0.934241
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  22.170490687247366 Time :  120
accuracy train: 0.981538 val: 0.948171 test: 0.937743
max validation accuracy : 0.948171 max acc epoch : 7 test accuracy : 0.937743
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  18.646138556301594 Time :  138
accuracy train: 0.981538 val: 0.942073 test: 0.940078
max validation accuracy : 0.948171 max acc epoch : 7 test accuracy : 0.937743
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  18.12090490013361 Time :  155
accuracy train: 0.984417 val: 0.942073 test: 0.944358
max validation accuracy : 0.948171 max acc epoch : 7 test accuracy : 0.937743
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  14.502884028479457 Time :  172
accuracy train: 0.984587 val: 0.943598 test: 0.947471
max validation accuracy : 0.948171 max acc epoch : 7 test accuracy : 0.937743

Epoch :  11 loss training:  14.024744157679379 Time :  190
accuracy train: 0.987127 val: 0.942073 test: 0.939689
max validation accuracy : 0.948171 max acc epoch : 7 test accuracy : 0.937743

Epoch :  12 loss training:  13.167341098189354 Time :  209
accuracy train: 0.987974 val: 0.946646 test: 0.945136
max validation accuracy : 0.948171 max acc epoch : 7 test accuracy : 0.937743

Epoch :  13 loss training:  11.849023224785924 Time :  227
accuracy train: 0.988482 val: 0.945122 test: 0.945525
max validation accuracy : 0.948171 max acc epoch : 7 test accuracy : 0.937743

Epoch :  14 loss training:  11.19175497815013 Time :  245
accuracy train: 0.991023 val: 0.943598 test: 0.945136
max validation accuracy : 0.948171 max acc epoch : 7 test accuracy : 0.937743

Epoch :  15 loss training:  10.993943470995873 Time :  263
accuracy train: 0.992039 val: 0.952744 test: 0.947860
max validation accuracy : 0.952744 max acc epoch : 15 test accuracy : 0.947860

Epoch :  16 loss training:  10.095845348201692 Time :  281
accuracy train: 0.991531 val: 0.954268 test: 0.951362
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.951362

Epoch :  17 loss training:  9.31821389682591 Time :  300
accuracy train: 0.992886 val: 0.948171 test: 0.947082
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.951362

Epoch :  18 loss training:  9.225288690533489 Time :  318
accuracy train: 0.993056 val: 0.946646 test: 0.945525
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.951362

Epoch :  19 loss training:  7.589692387962714 Time :  336
accuracy train: 0.993056 val: 0.955793 test: 0.945914
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.945914

Epoch :  20 loss training:  8.37133357487619 Time :  354
accuracy train: 0.994411 val: 0.955793 test: 0.949027
max validation accuracy : 0.955793 max acc epoch : 19 test accuracy : 0.945914

Epoch :  21 loss training:  7.3934936167206615 Time :  372
accuracy train: 0.995427 val: 0.957317 test: 0.946693
max validation accuracy : 0.957317 max acc epoch : 21 test accuracy : 0.946693

Epoch :  22 loss training:  7.184986251872033 Time :  390
accuracy train: 0.995257 val: 0.954268 test: 0.945136
max validation accuracy : 0.957317 max acc epoch : 21 test accuracy : 0.946693

Epoch :  23 loss training:  6.323383718729019 Time :  409
accuracy train: 0.995766 val: 0.957317 test: 0.947860
max validation accuracy : 0.957317 max acc epoch : 21 test accuracy : 0.946693

Epoch :  24 loss training:  6.239319295622408 Time :  427
accuracy train: 0.995935 val: 0.951220 test: 0.946304
max validation accuracy : 0.957317 max acc epoch : 21 test accuracy : 0.946693

Epoch :  25 loss training:  5.841547868447378 Time :  444
accuracy train: 0.995596 val: 0.960366 test: 0.950584
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  26 loss training:  5.401724292431027 Time :  463
accuracy train: 0.995596 val: 0.955793 test: 0.944358
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  27 loss training:  5.33779803966172 Time :  481
accuracy train: 0.995596 val: 0.955793 test: 0.948249
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  28 loss training:  4.759936596499756 Time :  499
accuracy train: 0.994919 val: 0.960366 test: 0.950584
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  29 loss training:  4.839949487475678 Time :  517
accuracy train: 0.996104 val: 0.954268 test: 0.947082
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  30 loss training:  4.82290922687389 Time :  535
accuracy train: 0.996612 val: 0.949695 test: 0.951362
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  31 loss training:  4.557293302263133 Time :  553
accuracy train: 0.995766 val: 0.948171 test: 0.948249
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  32 loss training:  4.617621672339737 Time :  571
accuracy train: 0.996782 val: 0.957317 test: 0.945136
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  33 loss training:  3.9504580139764585 Time :  589
accuracy train: 0.996782 val: 0.949695 test: 0.952140
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  34 loss training:  3.9312028768472373 Time :  608
accuracy train: 0.996274 val: 0.958841 test: 0.948249
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  35 loss training:  4.18101994949393 Time :  626
accuracy train: 0.996612 val: 0.949695 test: 0.948249
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  36 loss training:  3.603194028371945 Time :  644
accuracy train: 0.996612 val: 0.957317 test: 0.951751
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  37 loss training:  3.556408175092656 Time :  662
accuracy train: 0.996612 val: 0.949695 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  38 loss training:  3.6978786579566076 Time :  680
accuracy train: 0.996443 val: 0.955793 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  39 loss training:  3.7050223376136273 Time :  698
accuracy train: 0.996782 val: 0.952744 test: 0.948638
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  40 loss training:  3.7428029240109026 Time :  716
accuracy train: 0.996274 val: 0.955793 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  41 loss training:  3.094941370538436 Time :  734
accuracy train: 0.996274 val: 0.957317 test: 0.951751
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  42 loss training:  3.1229236744111404 Time :  753
accuracy train: 0.997121 val: 0.949695 test: 0.949416
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  43 loss training:  3.0108061510836706 Time :  771
accuracy train: 0.996951 val: 0.954268 test: 0.949416
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  44 loss training:  3.1525061409338377 Time :  789
accuracy train: 0.996782 val: 0.949695 test: 0.948249
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  45 loss training:  3.198220057442086 Time :  807
accuracy train: 0.996612 val: 0.960366 test: 0.948249
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  46 loss training:  2.815210178261623 Time :  825
accuracy train: 0.996782 val: 0.949695 test: 0.950973
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  47 loss training:  3.0112147897016257 Time :  843
accuracy train: 0.996782 val: 0.952744 test: 0.950973
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  48 loss training:  2.9114417522214353 Time :  861
accuracy train: 0.997121 val: 0.952744 test: 0.946304
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  49 loss training:  2.4970842055772664 Time :  880
accuracy train: 0.997290 val: 0.954268 test: 0.950584
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  50 loss training:  2.9537883585726377 Time :  898
accuracy train: 0.997290 val: 0.949695 test: 0.949805
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  51 loss training:  2.5034235580533277 Time :  916
accuracy train: 0.997121 val: 0.951220 test: 0.950584
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  52 loss training:  2.485213304811623 Time :  934
accuracy train: 0.996951 val: 0.955793 test: 0.951751
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  53 loss training:  2.6225080787262414 Time :  952
accuracy train: 0.996951 val: 0.955793 test: 0.951362
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  54 loss training:  2.761881161131896 Time :  970
accuracy train: 0.997121 val: 0.955793 test: 0.950584
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  55 loss training:  2.347651555261109 Time :  988
accuracy train: 0.996951 val: 0.945122 test: 0.952140
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

Epoch :  56 loss training:  2.685944900207687 Time :  1006
accuracy train: 0.996951 val: 0.952744 test: 0.947082
max validation accuracy : 0.960366 max acc epoch : 25 test accuracy : 0.950584

========================================================================================================================================================================================================
best acc epoch :  25
validation accuracy :  0.9603658536585366
test accuracy :  0.9505836575875486
last test_accuracy :  0.9470817120622568
second best val :  0.9588414634146342
second best test :  0.9505836575875486
max gap 8
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=398, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  128.82166704535484 Time :  1025
accuracy train: 0.897866 val: 0.873476 test: 0.864591
max validation accuracy : 0.873476 max acc epoch : 1 test accuracy : 0.864591
Epoch-1 lr: 0.001

Epoch :  2 loss training:  58.04258094727993 Time :  1042
accuracy train: 0.923611 val: 0.888720 test: 0.904669
max validation accuracy : 0.888720 max acc epoch : 2 test accuracy : 0.904669
Epoch-2 lr: 0.001

Epoch :  3 loss training:  41.69870032276958 Time :  1059
accuracy train: 0.959180 val: 0.935976 test: 0.926848
max validation accuracy : 0.935976 max acc epoch : 3 test accuracy : 0.926848
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  26.467721601948142 Time :  1076
accuracy train: 0.966802 val: 0.940549 test: 0.940856
max validation accuracy : 0.940549 max acc epoch : 4 test accuracy : 0.940856
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  22.907094871625304 Time :  1094
accuracy train: 0.972053 val: 0.942073 test: 0.938521
max validation accuracy : 0.942073 max acc epoch : 5 test accuracy : 0.938521
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  20.106662321835756 Time :  1111
accuracy train: 0.981707 val: 0.945122 test: 0.934241
max validation accuracy : 0.945122 max acc epoch : 6 test accuracy : 0.934241
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  15.6502315858379 Time :  1128
accuracy train: 0.984248 val: 0.948171 test: 0.939300
max validation accuracy : 0.948171 max acc epoch : 7 test accuracy : 0.939300
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  15.294369055889547 Time :  1146
accuracy train: 0.985434 val: 0.949695 test: 0.942023
max validation accuracy : 0.949695 max acc epoch : 8 test accuracy : 0.942023
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  14.268056767992675 Time :  1163
accuracy train: 0.987974 val: 0.952744 test: 0.948638
max validation accuracy : 0.952744 max acc epoch : 9 test accuracy : 0.948638
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  12.015631219372153 Time :  1180
accuracy train: 0.989329 val: 0.954268 test: 0.948249
max validation accuracy : 0.954268 max acc epoch : 10 test accuracy : 0.948249

Epoch :  11 loss training:  11.135858967434615 Time :  1198
accuracy train: 0.991023 val: 0.952744 test: 0.946693
max validation accuracy : 0.954268 max acc epoch : 10 test accuracy : 0.948249

Epoch :  12 loss training:  10.61622711038217 Time :  1217
accuracy train: 0.990515 val: 0.955793 test: 0.946304
max validation accuracy : 0.955793 max acc epoch : 12 test accuracy : 0.946304

Epoch :  13 loss training:  9.944512029644102 Time :  1235
accuracy train: 0.990854 val: 0.954268 test: 0.949805
max validation accuracy : 0.955793 max acc epoch : 12 test accuracy : 0.946304

Epoch :  14 loss training:  9.001102542737499 Time :  1253
accuracy train: 0.992378 val: 0.954268 test: 0.945136
max validation accuracy : 0.955793 max acc epoch : 12 test accuracy : 0.946304

Epoch :  15 loss training:  8.518581197131425 Time :  1271
accuracy train: 0.993394 val: 0.958841 test: 0.947082
max validation accuracy : 0.958841 max acc epoch : 15 test accuracy : 0.947082

Epoch :  16 loss training:  8.408520159078762 Time :  1290
accuracy train: 0.994241 val: 0.958841 test: 0.949416
max validation accuracy : 0.958841 max acc epoch : 15 test accuracy : 0.947082

Epoch :  17 loss training:  7.274547713808715 Time :  1308
accuracy train: 0.994072 val: 0.955793 test: 0.947471
max validation accuracy : 0.958841 max acc epoch : 15 test accuracy : 0.947082

Epoch :  18 loss training:  6.465179242193699 Time :  1326
accuracy train: 0.994241 val: 0.964939 test: 0.945136
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  19 loss training:  6.549445346929133 Time :  1345
accuracy train: 0.994241 val: 0.957317 test: 0.950973
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  20 loss training:  6.604040319100022 Time :  1363
accuracy train: 0.994749 val: 0.955793 test: 0.947471
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  21 loss training:  5.820462494855747 Time :  1381
accuracy train: 0.995766 val: 0.961890 test: 0.947860
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  22 loss training:  5.525209509534761 Time :  1399
accuracy train: 0.996104 val: 0.961890 test: 0.949416
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  23 loss training:  5.400221380172297 Time :  1418
accuracy train: 0.995596 val: 0.961890 test: 0.947082
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  24 loss training:  5.2293843714287505 Time :  1436
accuracy train: 0.996443 val: 0.957317 test: 0.947082
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  25 loss training:  4.846260650316253 Time :  1454
accuracy train: 0.995935 val: 0.964939 test: 0.949416
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  26 loss training:  4.694035236432683 Time :  1473
accuracy train: 0.995935 val: 0.958841 test: 0.950584
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  27 loss training:  4.5563340947264805 Time :  1491
accuracy train: 0.996443 val: 0.960366 test: 0.952529
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  28 loss training:  4.301491859601811 Time :  1509
accuracy train: 0.996612 val: 0.960366 test: 0.950195
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  29 loss training:  4.061617201543413 Time :  1528
accuracy train: 0.996274 val: 0.957317 test: 0.950584
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  30 loss training:  4.345099052996375 Time :  1546
accuracy train: 0.996612 val: 0.958841 test: 0.948249
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  31 loss training:  4.203267937526107 Time :  1564
accuracy train: 0.996274 val: 0.954268 test: 0.950973
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  32 loss training:  3.781901470152661 Time :  1582
accuracy train: 0.996274 val: 0.963415 test: 0.945914
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  33 loss training:  4.107216521748342 Time :  1600
accuracy train: 0.996274 val: 0.958841 test: 0.952918
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  34 loss training:  3.6783373821526766 Time :  1619
accuracy train: 0.996612 val: 0.964939 test: 0.949416
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  35 loss training:  3.288769260805566 Time :  1637
accuracy train: 0.996443 val: 0.961890 test: 0.950973
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  36 loss training:  3.6890797790838405 Time :  1655
accuracy train: 0.996612 val: 0.955793 test: 0.949416
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  37 loss training:  3.1840340768685564 Time :  1673
accuracy train: 0.996443 val: 0.957317 test: 0.950973
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  38 loss training:  3.1559210470004473 Time :  1692
accuracy train: 0.996782 val: 0.961890 test: 0.945136
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  39 loss training:  3.3125465471530333 Time :  1710
accuracy train: 0.996612 val: 0.957317 test: 0.950584
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  40 loss training:  3.4287664091098122 Time :  1728
accuracy train: 0.996612 val: 0.963415 test: 0.953696
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  41 loss training:  2.949074540869333 Time :  1746
accuracy train: 0.996782 val: 0.954268 test: 0.950584
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  42 loss training:  2.8540450278669596 Time :  1764
accuracy train: 0.996782 val: 0.952744 test: 0.948249
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  43 loss training:  3.0613871754612774 Time :  1783
accuracy train: 0.996612 val: 0.951220 test: 0.949416
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  44 loss training:  3.079583060054574 Time :  1801
accuracy train: 0.996782 val: 0.949695 test: 0.949027
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  45 loss training:  2.7248567728383932 Time :  1819
accuracy train: 0.996782 val: 0.958841 test: 0.948638
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  46 loss training:  2.733090178866405 Time :  1838
accuracy train: 0.996612 val: 0.952744 test: 0.949416
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  47 loss training:  2.730010337982094 Time :  1856
accuracy train: 0.996612 val: 0.958841 test: 0.948249
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  48 loss training:  2.8654239428287838 Time :  1874
accuracy train: 0.996782 val: 0.960366 test: 0.948638
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

Epoch :  49 loss training:  2.840279236988863 Time :  1892
accuracy train: 0.996612 val: 0.963415 test: 0.947471
max validation accuracy : 0.964939 max acc epoch : 18 test accuracy : 0.945136

========================================================================================================================================================================================================
best acc epoch :  18
validation accuracy :  0.9649390243902439
test accuracy :  0.945136186770428
last test_accuracy :  0.9474708171206225
second best val :  0.9634146341463414
second best test :  0.945136186770428
max gap 3
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  25 	 val_accuracy : 0.96037 	 test_accuracy : 0.95058 	 last test_accuracy : 0.94708 	 second best val : 0.95884 	 second best test : 0.95058
k :  1 	 best_acc epoch :  18 	 val_accuracy : 0.96494 	 test_accuracy : 0.94514 	 last test_accuracy : 0.94747 	 second best val : 0.96341 	 second best test : 0.94514

avg :  	 val_accuracy : 0.96265 	 test_accuracy : 0.94786 	 last_accuracy : 0.94728 	 second best val : 0.96113 	 second best test : 0.94786

std :  	 val_accuracy : 0.00229 	 test_accuracy : 0.00272 	 last_accuracy : 0.00019 	 second best val : 0.00229 	 second best test : 0.00272


date and time :  Fri Jul  9 17:34:33 2021
itr : 0
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=213, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0
Counter({2: 5412, 1: 2508, 0: 1210})

Epoch :  1 loss training:  125.22016322612762 Time :  19
accuracy train: 0.896172 val: 0.890244 test: 0.883268
max validation accuracy : 0.890244 max acc epoch : 1 test accuracy : 0.883268
Counter({0: 3567, 2: 2830, 1: 2733})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.208336025476456 Time :  40
accuracy train: 0.944783 val: 0.899390 test: 0.910117
max validation accuracy : 0.899390 max acc epoch : 2 test accuracy : 0.910117
Counter({0: 3746, 1: 2866, 2: 2518})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  38.35651897825301 Time :  61
accuracy train: 0.944444 val: 0.932927 test: 0.920623
max validation accuracy : 0.932927 max acc epoch : 3 test accuracy : 0.920623
Counter({0: 3748, 2: 2812, 1: 2570})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  27.048963086679578 Time :  81
accuracy train: 0.970867 val: 0.937500 test: 0.940078
max validation accuracy : 0.937500 max acc epoch : 4 test accuracy : 0.940078
Counter({0: 3749, 2: 2921, 1: 2460})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  20.989503778517246 Time :  101
accuracy train: 0.976795 val: 0.948171 test: 0.940467
max validation accuracy : 0.948171 max acc epoch : 5 test accuracy : 0.940467
Counter({2: 3786, 0: 2919, 1: 2425})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  20.17449189722538 Time :  124
accuracy train: 0.976118 val: 0.932927 test: 0.935409
max validation accuracy : 0.948171 max acc epoch : 5 test accuracy : 0.940467
Counter({0: 3789, 2: 2914, 1: 2427})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  15.85044109262526 Time :  145
accuracy train: 0.983570 val: 0.948171 test: 0.949416
max validation accuracy : 0.948171 max acc epoch : 5 test accuracy : 0.940467
Counter({0: 3760, 2: 2914, 1: 2456})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  14.836275143548846 Time :  166
accuracy train: 0.986789 val: 0.948171 test: 0.946693
max validation accuracy : 0.948171 max acc epoch : 5 test accuracy : 0.940467
Counter({1: 3758, 0: 2912, 2: 2460})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  13.407025156076998 Time :  187
accuracy train: 0.987466 val: 0.951220 test: 0.950195
max validation accuracy : 0.951220 max acc epoch : 9 test accuracy : 0.950195
Counter({1: 3794, 0: 2884, 2: 2452})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  11.259421804919839 Time :  208
accuracy train: 0.988991 val: 0.954268 test: 0.948249
max validation accuracy : 0.954268 max acc epoch : 10 test accuracy : 0.948249
Counter({0: 3800, 2: 2881, 1: 2449})

Epoch :  11 loss training:  11.235261425375938 Time :  230
accuracy train: 0.990346 val: 0.951220 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 10 test accuracy : 0.948249
Counter({1: 3798, 0: 2880, 2: 2452})

Epoch :  12 loss training:  10.010729127563536 Time :  251
accuracy train: 0.991531 val: 0.957317 test: 0.950973
max validation accuracy : 0.957317 max acc epoch : 12 test accuracy : 0.950973
Counter({0: 3805, 2: 2882, 1: 2443})

Epoch :  13 loss training:  9.422399421222508 Time :  274
accuracy train: 0.991701 val: 0.958841 test: 0.946693
max validation accuracy : 0.958841 max acc epoch : 13 test accuracy : 0.946693
Counter({1: 3805, 0: 2888, 2: 2437})

Epoch :  14 loss training:  8.952774702571332 Time :  296
accuracy train: 0.991023 val: 0.958841 test: 0.948638
max validation accuracy : 0.958841 max acc epoch : 13 test accuracy : 0.946693
Counter({1: 3826, 2: 2884, 0: 2420})

Epoch :  15 loss training:  8.177506260806695 Time :  318
accuracy train: 0.993056 val: 0.955793 test: 0.947860
max validation accuracy : 0.958841 max acc epoch : 13 test accuracy : 0.946693
Counter({0: 3830, 1: 2889, 2: 2411})

Epoch :  16 loss training:  7.584153225412592 Time :  338
accuracy train: 0.993564 val: 0.955793 test: 0.950584
max validation accuracy : 0.958841 max acc epoch : 13 test accuracy : 0.946693
Counter({1: 3835, 0: 2887, 2: 2408})

Epoch :  17 loss training:  7.285593427717686 Time :  359
accuracy train: 0.994241 val: 0.957317 test: 0.950973
max validation accuracy : 0.958841 max acc epoch : 13 test accuracy : 0.946693
Counter({1: 3841, 0: 2884, 2: 2405})

Epoch :  18 loss training:  7.386572840856388 Time :  380
accuracy train: 0.994072 val: 0.961890 test: 0.951751
max validation accuracy : 0.961890 max acc epoch : 18 test accuracy : 0.951751
Counter({0: 3852, 1: 2880, 2: 2398})

Epoch :  19 loss training:  6.222872138954699 Time :  400
accuracy train: 0.994580 val: 0.960366 test: 0.948249
max validation accuracy : 0.961890 max acc epoch : 18 test accuracy : 0.951751
Counter({0: 3864, 1: 2875, 2: 2391})

Epoch :  20 loss training:  6.031423840671778 Time :  419
accuracy train: 0.994580 val: 0.955793 test: 0.950195
max validation accuracy : 0.961890 max acc epoch : 18 test accuracy : 0.951751
Counter({1: 3866, 0: 2874, 2: 2390})

Epoch :  21 loss training:  5.4898833555635065 Time :  438
accuracy train: 0.994919 val: 0.960366 test: 0.949805
max validation accuracy : 0.961890 max acc epoch : 18 test accuracy : 0.951751
Counter({0: 3871, 1: 2881, 2: 2378})

Epoch :  22 loss training:  5.057789434911683 Time :  457
accuracy train: 0.995088 val: 0.957317 test: 0.952140
max validation accuracy : 0.961890 max acc epoch : 18 test accuracy : 0.951751
Counter({0: 3896, 1: 2887, 2: 2347})

Epoch :  23 loss training:  5.346179320244119 Time :  477
accuracy train: 0.995766 val: 0.958841 test: 0.952140
max validation accuracy : 0.961890 max acc epoch : 18 test accuracy : 0.951751
Counter({0: 3898, 1: 2886, 2: 2346})

Epoch :  24 loss training:  5.2212367811007425 Time :  498
accuracy train: 0.995427 val: 0.955793 test: 0.950973
max validation accuracy : 0.961890 max acc epoch : 18 test accuracy : 0.951751
Counter({0: 3901, 2: 2888, 1: 2341})

Epoch :  25 loss training:  4.867537224199623 Time :  517
accuracy train: 0.995766 val: 0.960366 test: 0.948249
max validation accuracy : 0.961890 max acc epoch : 18 test accuracy : 0.951751
Counter({1: 3903, 2: 2893, 0: 2334})

Epoch :  26 loss training:  4.767024439293891 Time :  536
accuracy train: 0.995596 val: 0.960366 test: 0.948638
max validation accuracy : 0.961890 max acc epoch : 18 test accuracy : 0.951751
Counter({0: 3902, 2: 2906, 1: 2322})

Epoch :  27 loss training:  4.1897880245232955 Time :  555
accuracy train: 0.996274 val: 0.957317 test: 0.948638
max validation accuracy : 0.961890 max acc epoch : 18 test accuracy : 0.951751
Counter({0: 3904, 1: 2903, 2: 2323})

Epoch :  28 loss training:  4.735468726954423 Time :  574
accuracy train: 0.995427 val: 0.960366 test: 0.946304
max validation accuracy : 0.961890 max acc epoch : 18 test accuracy : 0.951751
Counter({1: 3903, 0: 2906, 2: 2321})

Epoch :  29 loss training:  4.35810899536591 Time :  593
accuracy train: 0.995427 val: 0.963415 test: 0.948638
max validation accuracy : 0.963415 max acc epoch : 29 test accuracy : 0.948638
Counter({0: 3911, 1: 2899, 2: 2320})

Epoch :  30 loss training:  3.830240287759807 Time :  613
accuracy train: 0.996104 val: 0.961890 test: 0.949027
max validation accuracy : 0.963415 max acc epoch : 29 test accuracy : 0.948638
Counter({0: 3913, 1: 2900, 2: 2317})

Epoch :  31 loss training:  3.816479290020652 Time :  635
accuracy train: 0.996104 val: 0.960366 test: 0.952140
max validation accuracy : 0.963415 max acc epoch : 29 test accuracy : 0.948638
Counter({0: 3913, 2: 2902, 1: 2315})

Epoch :  32 loss training:  3.520792812574655 Time :  654
accuracy train: 0.995766 val: 0.961890 test: 0.950584
max validation accuracy : 0.963415 max acc epoch : 29 test accuracy : 0.948638
Counter({0: 3914, 2: 2902, 1: 2314})

Epoch :  33 loss training:  3.7404067436000332 Time :  673
accuracy train: 0.996274 val: 0.960366 test: 0.951362
max validation accuracy : 0.963415 max acc epoch : 29 test accuracy : 0.948638
Counter({0: 3914, 2: 2902, 1: 2314})

Epoch :  34 loss training:  3.3718167920596898 Time :  693
accuracy train: 0.995935 val: 0.960366 test: 0.947082
max validation accuracy : 0.963415 max acc epoch : 29 test accuracy : 0.948638
Counter({1: 3914, 0: 2902, 2: 2314})

Epoch :  35 loss training:  3.5255935207242146 Time :  712
accuracy train: 0.995935 val: 0.954268 test: 0.949027
max validation accuracy : 0.963415 max acc epoch : 29 test accuracy : 0.948638
Counter({0: 3915, 2: 2901, 1: 2314})

Epoch :  36 loss training:  3.2037232739967294 Time :  731
accuracy train: 0.996104 val: 0.960366 test: 0.949805
max validation accuracy : 0.963415 max acc epoch : 29 test accuracy : 0.948638
Counter({0: 3915, 2: 2901, 1: 2314})

Epoch :  37 loss training:  2.996262540400494 Time :  750
accuracy train: 0.995935 val: 0.958841 test: 0.947860
max validation accuracy : 0.963415 max acc epoch : 29 test accuracy : 0.948638
Counter({0: 3915, 2: 2901, 1: 2314})

Epoch :  38 loss training:  2.9531673783785664 Time :  770
accuracy train: 0.996104 val: 0.960366 test: 0.951751
max validation accuracy : 0.963415 max acc epoch : 29 test accuracy : 0.948638
Counter({0: 3915, 2: 2902, 1: 2313})

Epoch :  39 loss training:  2.870168412802741 Time :  789
accuracy train: 0.996612 val: 0.957317 test: 0.952918
max validation accuracy : 0.963415 max acc epoch : 29 test accuracy : 0.948638
Counter({1: 3915, 0: 2902, 2: 2313})

Epoch :  40 loss training:  3.093679724202957 Time :  811
accuracy train: 0.996274 val: 0.963415 test: 0.953696
max validation accuracy : 0.963415 max acc epoch : 29 test accuracy : 0.948638
Counter({0: 3916, 2: 2902, 1: 2312})

Epoch :  41 loss training:  2.7448336512607057 Time :  832
accuracy train: 0.996104 val: 0.957317 test: 0.949805
max validation accuracy : 0.963415 max acc epoch : 29 test accuracy : 0.948638
Counter({1: 3916, 0: 2902, 2: 2312})

Epoch :  42 loss training:  2.705053913552547 Time :  854
accuracy train: 0.996274 val: 0.960366 test: 0.948249
max validation accuracy : 0.963415 max acc epoch : 29 test accuracy : 0.948638
Counter({0: 3916, 2: 2902, 1: 2312})

Epoch :  43 loss training:  2.7615727172524203 Time :  877
accuracy train: 0.996443 val: 0.960366 test: 0.947471
max validation accuracy : 0.963415 max acc epoch : 29 test accuracy : 0.948638
Counter({0: 3918, 2: 2900, 1: 2312})

Epoch :  44 loss training:  2.794959286242374 Time :  898
accuracy train: 0.996104 val: 0.957317 test: 0.949416
max validation accuracy : 0.963415 max acc epoch : 29 test accuracy : 0.948638
Counter({0: 3919, 2: 2899, 1: 2312})

Epoch :  45 loss training:  2.713378929445753 Time :  920
accuracy train: 0.996104 val: 0.960366 test: 0.950195
max validation accuracy : 0.963415 max acc epoch : 29 test accuracy : 0.948638
Counter({1: 3920, 0: 2898, 2: 2312})

Epoch :  46 loss training:  3.1119829381932504 Time :  942
accuracy train: 0.996104 val: 0.958841 test: 0.946304
max validation accuracy : 0.963415 max acc epoch : 29 test accuracy : 0.948638
Counter({2: 3919, 1: 2900, 0: 2311})

Epoch :  47 loss training:  2.688553761545336 Time :  964
accuracy train: 0.995935 val: 0.961890 test: 0.949027
max validation accuracy : 0.963415 max acc epoch : 29 test accuracy : 0.948638
Counter({0: 3919, 2: 2900, 1: 2311})

Epoch :  48 loss training:  2.3658493920083856 Time :  984
accuracy train: 0.996274 val: 0.964939 test: 0.949027
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({1: 3919, 0: 2901, 2: 2310})

Epoch :  49 loss training:  2.552976689024945 Time :  1007
accuracy train: 0.996274 val: 0.963415 test: 0.950973
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({0: 3920, 1: 2900, 2: 2310})

Epoch :  50 loss training:  2.5965612412255723 Time :  1029
accuracy train: 0.996274 val: 0.963415 test: 0.947082
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({0: 3920, 2: 2899, 1: 2311})

Epoch :  51 loss training:  2.728713097909349 Time :  1050
accuracy train: 0.996274 val: 0.961890 test: 0.951751
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({0: 3920, 2: 2899, 1: 2311})

Epoch :  52 loss training:  2.5760929715179373 Time :  1072
accuracy train: 0.996104 val: 0.960366 test: 0.947860
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({0: 3921, 1: 2899, 2: 2310})

Epoch :  53 loss training:  2.409961317622219 Time :  1094
accuracy train: 0.996104 val: 0.961890 test: 0.949416
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({0: 3921, 1: 2902, 2: 2307})

Epoch :  54 loss training:  2.459019775764318 Time :  1114
accuracy train: 0.996274 val: 0.960366 test: 0.948638
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({0: 3922, 1: 2901, 2: 2307})

Epoch :  55 loss training:  2.4197227598924655 Time :  1137
accuracy train: 0.996274 val: 0.963415 test: 0.948249
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({0: 3923, 2: 2899, 1: 2308})

Epoch :  56 loss training:  2.335870864248136 Time :  1159
accuracy train: 0.996104 val: 0.960366 test: 0.947082
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({0: 3923, 1: 2899, 2: 2308})

Epoch :  57 loss training:  2.4157192968705203 Time :  1179
accuracy train: 0.996274 val: 0.964939 test: 0.945525
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({1: 3923, 0: 2899, 2: 2308})

Epoch :  58 loss training:  2.367038376061828 Time :  1202
accuracy train: 0.996104 val: 0.963415 test: 0.948249
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({0: 3923, 1: 2899, 2: 2308})

Epoch :  59 loss training:  2.225848806585418 Time :  1223
accuracy train: 0.996274 val: 0.963415 test: 0.947471
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({0: 3923, 1: 2899, 2: 2308})

Epoch :  60 loss training:  2.5617455897736363 Time :  1245
accuracy train: 0.996612 val: 0.955793 test: 0.943580
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({0: 3923, 1: 2902, 2: 2305})

Epoch :  61 loss training:  2.261661404321785 Time :  1266
accuracy train: 0.996274 val: 0.960366 test: 0.947471
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({2: 3923, 1: 2902, 0: 2305})

Epoch :  62 loss training:  2.308164789348666 Time :  1288
accuracy train: 0.996274 val: 0.960366 test: 0.948249
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({1: 3924, 0: 2901, 2: 2305})

Epoch :  63 loss training:  2.1943972539229435 Time :  1310
accuracy train: 0.996274 val: 0.961890 test: 0.944358
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({0: 3924, 2: 2901, 1: 2305})

Epoch :  64 loss training:  2.396422559992061 Time :  1331
accuracy train: 0.996274 val: 0.958841 test: 0.947471
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({0: 3924, 2: 2900, 1: 2306})

Epoch :  65 loss training:  2.4153958704555407 Time :  1353
accuracy train: 0.996443 val: 0.958841 test: 0.946693
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({0: 3924, 2: 2900, 1: 2306})

Epoch :  66 loss training:  2.2393614893517224 Time :  1375
accuracy train: 0.995766 val: 0.961890 test: 0.947471
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({1: 3928, 0: 2896, 2: 2306})

Epoch :  67 loss training:  2.2425458457073546 Time :  1396
accuracy train: 0.996104 val: 0.961890 test: 0.947082
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({0: 3928, 2: 2896, 1: 2306})

Epoch :  68 loss training:  2.2132866535976063 Time :  1417
accuracy train: 0.996443 val: 0.963415 test: 0.945136
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({0: 3928, 2: 2896, 1: 2306})

Epoch :  69 loss training:  2.3940529728279216 Time :  1439
accuracy train: 0.996612 val: 0.961890 test: 0.945525
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({0: 3929, 1: 2895, 2: 2306})

Epoch :  70 loss training:  1.925386067450745 Time :  1460
accuracy train: 0.996104 val: 0.963415 test: 0.947082
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({0: 3929, 2: 2895, 1: 2306})

Epoch :  71 loss training:  2.237308553965704 Time :  1482
accuracy train: 0.996274 val: 0.960366 test: 0.945525
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({0: 3929, 2: 2896, 1: 2305})

Epoch :  72 loss training:  2.293323105230229 Time :  1503
accuracy train: 0.996274 val: 0.963415 test: 0.944358
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({1: 3929, 0: 2894, 2: 2307})

Epoch :  73 loss training:  2.2745546210207976 Time :  1524
accuracy train: 0.996274 val: 0.957317 test: 0.945914
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({1: 3930, 0: 2894, 2: 2306})

Epoch :  74 loss training:  2.142125885351561 Time :  1547
accuracy train: 0.996612 val: 0.963415 test: 0.945136
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({0: 3930, 2: 2894, 1: 2306})

Epoch :  75 loss training:  2.3394590007046645 Time :  1567
accuracy train: 0.996274 val: 0.963415 test: 0.947860
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({0: 3930, 2: 2894, 1: 2306})

Epoch :  76 loss training:  2.0936864560862887 Time :  1589
accuracy train: 0.996612 val: 0.958841 test: 0.947082
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({1: 3930, 0: 2894, 2: 2306})

Epoch :  77 loss training:  2.073307033700985 Time :  1611
accuracy train: 0.996104 val: 0.963415 test: 0.948638
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({1: 3930, 0: 2894, 2: 2306})

Epoch :  78 loss training:  1.9963583153221407 Time :  1633
accuracy train: 0.996612 val: 0.961890 test: 0.947860
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({0: 3931, 2: 2893, 1: 2306})

Epoch :  79 loss training:  2.1251679249653534 Time :  1654
accuracy train: 0.996612 val: 0.958841 test: 0.945525
max validation accuracy : 0.964939 max acc epoch : 48 test accuracy : 0.949027
Counter({0: 3931, 2: 2893, 1: 2306})

========================================================================================================================================================================================================
best acc epoch :  48
validation accuracy :  0.9649390243902439
test accuracy :  0.9490272373540856
last test_accuracy :  0.9455252918287937
second best val :  0.9634146341463414
second best test :  0.9486381322957198
max gap 19
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=16, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0
Counter({1: 5412, 0: 2508, 2: 1210})

Epoch :  1 loss training:  124.5994246006012 Time :  1680
accuracy train: 0.906335 val: 0.891768 test: 0.893774
max validation accuracy : 0.891768 max acc epoch : 1 test accuracy : 0.893774
Counter({1: 3590, 0: 2810, 2: 2730})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.01193664968014 Time :  1702
accuracy train: 0.943598 val: 0.922256 test: 0.909728
max validation accuracy : 0.922256 max acc epoch : 2 test accuracy : 0.909728
Counter({1: 3701, 0: 2783, 2: 2646})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  41.27876280993223 Time :  1723
accuracy train: 0.951728 val: 0.932927 test: 0.925292
max validation accuracy : 0.932927 max acc epoch : 3 test accuracy : 0.925292
Counter({1: 3703, 0: 2902, 2: 2525})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  28.060592014342546 Time :  1744
accuracy train: 0.970359 val: 0.946646 test: 0.935409
max validation accuracy : 0.946646 max acc epoch : 4 test accuracy : 0.935409
Counter({0: 3730, 1: 2864, 2: 2536})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  21.404685771092772 Time :  1764
accuracy train: 0.977304 val: 0.960366 test: 0.936576
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({0: 3786, 1: 2851, 2: 2493})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  21.66336401551962 Time :  1786
accuracy train: 0.980014 val: 0.951220 test: 0.936965
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({0: 3807, 2: 2847, 1: 2476})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  16.724488561041653 Time :  1807
accuracy train: 0.985434 val: 0.955793 test: 0.937354
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({0: 3817, 2: 2842, 1: 2471})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  15.126090518198907 Time :  1829
accuracy train: 0.986958 val: 0.954268 test: 0.940856
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({2: 3832, 1: 2833, 0: 2465})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  13.261686930432916 Time :  1849
accuracy train: 0.987466 val: 0.958841 test: 0.946304
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({0: 3836, 1: 2846, 2: 2448})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  11.865560920443386 Time :  1870
accuracy train: 0.988313 val: 0.957317 test: 0.943969
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({0: 3835, 2: 2851, 1: 2444})

Epoch :  11 loss training:  10.928676223382354 Time :  1892
accuracy train: 0.990176 val: 0.955793 test: 0.946693
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({0: 3836, 1: 2858, 2: 2436})

Epoch :  12 loss training:  10.640365717932582 Time :  1914
accuracy train: 0.990176 val: 0.958841 test: 0.947082
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({0: 3839, 2: 2857, 1: 2434})

Epoch :  13 loss training:  10.023433572147042 Time :  1936
accuracy train: 0.992209 val: 0.955793 test: 0.945136
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({0: 3843, 1: 2863, 2: 2424})

Epoch :  14 loss training:  9.455693603958935 Time :  1958
accuracy train: 0.992717 val: 0.960366 test: 0.947082
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({0: 3848, 1: 2861, 2: 2421})

Epoch :  15 loss training:  9.175406023161486 Time :  1980
accuracy train: 0.993394 val: 0.955793 test: 0.947082
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({1: 3855, 2: 2861, 0: 2414})

Epoch :  16 loss training:  8.098434295505285 Time :  2002
accuracy train: 0.993225 val: 0.957317 test: 0.943580
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({2: 3872, 1: 2859, 0: 2399})

Epoch :  17 loss training:  7.375137153780088 Time :  2024
accuracy train: 0.994411 val: 0.954268 test: 0.944358
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({0: 3878, 2: 2863, 1: 2389})

Epoch :  18 loss training:  6.981319529935718 Time :  2048
accuracy train: 0.994580 val: 0.949695 test: 0.948249
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({1: 3884, 0: 2869, 2: 2377})

Epoch :  19 loss training:  6.866350760450587 Time :  2069
accuracy train: 0.994919 val: 0.955793 test: 0.947860
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({0: 3892, 2: 2871, 1: 2367})

Epoch :  20 loss training:  6.364821323659271 Time :  2091
accuracy train: 0.994749 val: 0.955793 test: 0.946693
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({1: 3897, 0: 2870, 2: 2363})

Epoch :  21 loss training:  6.244928018888459 Time :  2113
accuracy train: 0.994919 val: 0.954268 test: 0.946693
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({1: 3901, 0: 2867, 2: 2362})

Epoch :  22 loss training:  5.792575975647196 Time :  2135
accuracy train: 0.995427 val: 0.955793 test: 0.942802
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({0: 3903, 1: 2867, 2: 2360})

Epoch :  23 loss training:  5.77163118426688 Time :  2157
accuracy train: 0.996274 val: 0.957317 test: 0.948638
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({0: 3901, 1: 2870, 2: 2359})

Epoch :  24 loss training:  4.911671920097433 Time :  2178
accuracy train: 0.995257 val: 0.954268 test: 0.947471
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({2: 3903, 0: 2871, 1: 2356})

Epoch :  25 loss training:  4.819749088026583 Time :  2200
accuracy train: 0.995088 val: 0.952744 test: 0.944747
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({0: 3904, 2: 2875, 1: 2351})

Epoch :  26 loss training:  4.871107550687157 Time :  2221
accuracy train: 0.995596 val: 0.952744 test: 0.943969
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({0: 3908, 1: 2879, 2: 2343})

Epoch :  27 loss training:  4.479332111252006 Time :  2243
accuracy train: 0.996104 val: 0.955793 test: 0.944358
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({0: 3908, 1: 2880, 2: 2342})

Epoch :  28 loss training:  4.338180151185952 Time :  2264
accuracy train: 0.995935 val: 0.955793 test: 0.947471
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({0: 3909, 1: 2880, 2: 2341})

Epoch :  29 loss training:  4.239882805617526 Time :  2287
accuracy train: 0.996612 val: 0.954268 test: 0.945525
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({0: 3912, 1: 2882, 2: 2336})

Epoch :  30 loss training:  3.902114346739836 Time :  2309
accuracy train: 0.996612 val: 0.954268 test: 0.946304
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({2: 3913, 0: 2882, 1: 2335})

Epoch :  31 loss training:  3.749636903288774 Time :  2331
accuracy train: 0.996443 val: 0.949695 test: 0.947471
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({0: 3915, 1: 2881, 2: 2334})

Epoch :  32 loss training:  3.766957629355602 Time :  2352
accuracy train: 0.996612 val: 0.951220 test: 0.943969
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({0: 3916, 1: 2880, 2: 2334})

Epoch :  33 loss training:  3.2365820468694437 Time :  2374
accuracy train: 0.996104 val: 0.951220 test: 0.943191
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({2: 3915, 0: 2881, 1: 2334})

Epoch :  34 loss training:  3.201856959029101 Time :  2398
accuracy train: 0.996612 val: 0.952744 test: 0.945525
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({0: 3915, 2: 2881, 1: 2334})

Epoch :  35 loss training:  3.1267073504568543 Time :  2421
accuracy train: 0.996443 val: 0.952744 test: 0.943580
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({0: 3915, 2: 2882, 1: 2333})

Epoch :  36 loss training:  3.12019400135614 Time :  2442
accuracy train: 0.996443 val: 0.952744 test: 0.946304
max validation accuracy : 0.960366 max acc epoch : 5 test accuracy : 0.936576
Counter({0: 3913, 2: 2885, 1: 2332})

========================================================================================================================================================================================================
best acc epoch :  5
validation accuracy :  0.9603658536585366
test accuracy :  0.9365758754863813
last test_accuracy :  0.9463035019455253
second best val :  0.9588414634146342
second best test :  0.9365758754863813
max gap 1
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  48 	 val_accuracy : 0.96494 	 test_accuracy : 0.94903 	 last test_accuracy : 0.94553 	 second best val : 0.96341 	 second best test : 0.94864
k :  1 	 best_acc epoch :  5 	 val_accuracy : 0.96037 	 test_accuracy : 0.93658 	 last test_accuracy : 0.94630 	 second best val : 0.95884 	 second best test : 0.93658

avg :  	 val_accuracy : 0.96265 	 test_accuracy : 0.94280 	 last_accuracy : 0.94591 	 second best val : 0.96113 	 second best test : 0.94261

std :  	 val_accuracy : 0.00229 	 test_accuracy : 0.00623 	 last_accuracy : 0.00039 	 second best val : 0.00229 	 second best test : 0.00603
