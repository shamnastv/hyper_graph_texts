

date and time :  Sat May 22 18:49:17 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=275, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  90.61051768064499 Time :  20
accuracy train: 0.787434 val: 0.733803 test: 0.768711
max validation accuracy : 0.733803 max acc epoch : 1 test accuracy : 0.768711
Epoch-1 lr: 0.001

Epoch :  2 loss training:  81.61722011864185 Time :  35
accuracy train: 0.804783 val: 0.745070 test: 0.772088
max validation accuracy : 0.745070 max acc epoch : 2 test accuracy : 0.772088
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.75163090229034 Time :  51
accuracy train: 0.791966 val: 0.711268 test: 0.742544
max validation accuracy : 0.745070 max acc epoch : 2 test accuracy : 0.772088
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.95199835300446 Time :  68
accuracy train: 0.828384 val: 0.753521 test: 0.771244
max validation accuracy : 0.753521 max acc epoch : 4 test accuracy : 0.771244
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  70.8999503403902 Time :  84
accuracy train: 0.840263 val: 0.738028 test: 0.772369
max validation accuracy : 0.753521 max acc epoch : 4 test accuracy : 0.771244
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.7084544301033 Time :  96
accuracy train: 0.843232 val: 0.752113 test: 0.770962
max validation accuracy : 0.753521 max acc epoch : 4 test accuracy : 0.771244
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.0093646645546 Time :  112
accuracy train: 0.858237 val: 0.752113 test: 0.775464
max validation accuracy : 0.753521 max acc epoch : 4 test accuracy : 0.771244
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.50789903104305 Time :  131
accuracy train: 0.873242 val: 0.747887 test: 0.770400
max validation accuracy : 0.753521 max acc epoch : 4 test accuracy : 0.771244
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.38165362179279 Time :  149
accuracy train: 0.881682 val: 0.756338 test: 0.773213
max validation accuracy : 0.756338 max acc epoch : 9 test accuracy : 0.773213
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.06382381916046 Time :  167
accuracy train: 0.886683 val: 0.746479 test: 0.770118
max validation accuracy : 0.756338 max acc epoch : 9 test accuracy : 0.773213
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.00361454486847 Time :  197
accuracy train: 0.888559 val: 0.754930 test: 0.769555
max validation accuracy : 0.756338 max acc epoch : 9 test accuracy : 0.773213
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.533038422465324 Time :  216
accuracy train: 0.894498 val: 0.753521 test: 0.767586
max validation accuracy : 0.756338 max acc epoch : 9 test accuracy : 0.773213
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.056547313928604 Time :  227
accuracy train: 0.898562 val: 0.757746 test: 0.770118
max validation accuracy : 0.757746 max acc epoch : 13 test accuracy : 0.770118
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  55.71086783707142 Time :  249
accuracy train: 0.901844 val: 0.763380 test: 0.771244
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.09725286066532 Time :  272
accuracy train: 0.902470 val: 0.750704 test: 0.768149
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  16 loss training:  55.29463957250118 Time :  287
accuracy train: 0.908096 val: 0.760563 test: 0.765898
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  17 loss training:  53.679571986198425 Time :  308
accuracy train: 0.916380 val: 0.759155 test: 0.767867
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  18 loss training:  51.5926261395216 Time :  328
accuracy train: 0.923257 val: 0.757746 test: 0.767304
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  19 loss training:  50.521924167871475 Time :  343
accuracy train: 0.928259 val: 0.756338 test: 0.768711
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  20 loss training:  49.41165420413017 Time :  373
accuracy train: 0.932948 val: 0.752113 test: 0.767023
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  21 loss training:  47.56740364432335 Time :  395
accuracy train: 0.935761 val: 0.745070 test: 0.765898
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  22 loss training:  45.78912291675806 Time :  405
accuracy train: 0.939356 val: 0.749296 test: 0.768149
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  23 loss training:  43.930650785565376 Time :  430
accuracy train: 0.943889 val: 0.749296 test: 0.769274
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  24 loss training:  41.68872848153114 Time :  459
accuracy train: 0.949984 val: 0.754930 test: 0.768149
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  25 loss training:  41.34585443139076 Time :  476
accuracy train: 0.952173 val: 0.742254 test: 0.764209
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  26 loss training:  39.15298007428646 Time :  498
accuracy train: 0.956549 val: 0.740845 test: 0.762521
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  27 loss training:  37.51774476468563 Time :  514
accuracy train: 0.961863 val: 0.749296 test: 0.763365
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  28 loss training:  39.05441302806139 Time :  538
accuracy train: 0.965302 val: 0.750704 test: 0.764491
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  29 loss training:  36.438636511564255 Time :  568
accuracy train: 0.967802 val: 0.754930 test: 0.759145
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  30 loss training:  34.852534249424934 Time :  582
accuracy train: 0.970147 val: 0.749296 test: 0.760270
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  31 loss training:  33.76952809095383 Time :  597
accuracy train: 0.975774 val: 0.743662 test: 0.759426
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  32 loss training:  31.887583635747433 Time :  627
accuracy train: 0.978118 val: 0.754930 test: 0.763365
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  33 loss training:  30.024438619613647 Time :  645
accuracy train: 0.980306 val: 0.749296 test: 0.763084
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  34 loss training:  30.29111286997795 Time :  664
accuracy train: 0.981869 val: 0.749296 test: 0.760551
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  35 loss training:  28.68082047253847 Time :  684
accuracy train: 0.984370 val: 0.745070 test: 0.761396
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  36 loss training:  27.745025511831045 Time :  699
accuracy train: 0.986089 val: 0.743662 test: 0.760551
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  37 loss training:  25.622007552534342 Time :  726
accuracy train: 0.987340 val: 0.743662 test: 0.762521
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  38 loss training:  24.242945954203606 Time :  750
accuracy train: 0.989997 val: 0.738028 test: 0.764491
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  39 loss training:  24.019193034619093 Time :  761
accuracy train: 0.990309 val: 0.742254 test: 0.762521
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  40 loss training:  24.25990260578692 Time :  789
accuracy train: 0.991872 val: 0.738028 test: 0.759707
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  41 loss training:  22.59111664071679 Time :  813
accuracy train: 0.992498 val: 0.732394 test: 0.762802
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  42 loss training:  21.5261614844203 Time :  830
accuracy train: 0.994373 val: 0.746479 test: 0.766179
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  43 loss training:  20.561425169929862 Time :  853
accuracy train: 0.994686 val: 0.742254 test: 0.760833
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  44 loss training:  20.52148782648146 Time :  870
accuracy train: 0.996093 val: 0.736620 test: 0.759989
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

Epoch :  45 loss training:  19.789899108931422 Time :  898
accuracy train: 0.996874 val: 0.749296 test: 0.766460
max validation accuracy : 0.763380 max acc epoch : 14 test accuracy : 0.771244

========================================================================================================================================================================================================
max acc epoch :  14
max validation accuracy :  0.7633802816901408
test accuracy :  0.7712436691052336
last test_accuracy :  0.7664603263927968
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=275, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  90.5818175971508 Time :  920
accuracy train: 0.788684 val: 0.729577 test: 0.774057
max validation accuracy : 0.729577 max acc epoch : 1 test accuracy : 0.774057
Epoch-1 lr: 0.001

Epoch :  2 loss training:  81.78338088095188 Time :  930
accuracy train: 0.804783 val: 0.740845 test: 0.777715
max validation accuracy : 0.740845 max acc epoch : 2 test accuracy : 0.777715
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.98137331008911 Time :  959
accuracy train: 0.799937 val: 0.718310 test: 0.751266
max validation accuracy : 0.740845 max acc epoch : 2 test accuracy : 0.777715
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.771231174469 Time :  983
accuracy train: 0.821976 val: 0.747887 test: 0.769274
max validation accuracy : 0.747887 max acc epoch : 4 test accuracy : 0.769274
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.37052324414253 Time :  993
accuracy train: 0.836043 val: 0.743662 test: 0.774339
max validation accuracy : 0.747887 max acc epoch : 4 test accuracy : 0.769274
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.16208416223526 Time :  1020
accuracy train: 0.841669 val: 0.752113 test: 0.773495
max validation accuracy : 0.752113 max acc epoch : 6 test accuracy : 0.773495
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.17378652095795 Time :  1043
accuracy train: 0.857455 val: 0.760563 test: 0.774339
max validation accuracy : 0.760563 max acc epoch : 7 test accuracy : 0.774339
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.52693563699722 Time :  1053
accuracy train: 0.868553 val: 0.749296 test: 0.773776
max validation accuracy : 0.760563 max acc epoch : 7 test accuracy : 0.774339
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.801138296723366 Time :  1071
accuracy train: 0.877774 val: 0.756338 test: 0.772651
max validation accuracy : 0.760563 max acc epoch : 7 test accuracy : 0.774339
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.37307673692703 Time :  1098
accuracy train: 0.884964 val: 0.760563 test: 0.773776
max validation accuracy : 0.760563 max acc epoch : 7 test accuracy : 0.774339
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.359440952539444 Time :  1112
accuracy train: 0.884964 val: 0.753521 test: 0.773776
max validation accuracy : 0.760563 max acc epoch : 7 test accuracy : 0.774339
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.95100574195385 Time :  1131
accuracy train: 0.891529 val: 0.764789 test: 0.771525
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.60937111079693 Time :  1153
accuracy train: 0.894811 val: 0.757746 test: 0.776308
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.068497106432915 Time :  1172
accuracy train: 0.897937 val: 0.759155 test: 0.772088
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.30003896355629 Time :  1192
accuracy train: 0.900594 val: 0.752113 test: 0.768149
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  16 loss training:  55.53529250621796 Time :  1209
accuracy train: 0.904501 val: 0.754930 test: 0.773213
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  17 loss training:  53.691139966249466 Time :  1227
accuracy train: 0.913879 val: 0.752113 test: 0.774339
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  18 loss training:  52.15369039773941 Time :  1249
accuracy train: 0.921851 val: 0.754930 test: 0.776308
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  19 loss training:  51.31410498917103 Time :  1266
accuracy train: 0.922788 val: 0.750704 test: 0.770118
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  20 loss training:  49.57570733129978 Time :  1276
accuracy train: 0.930603 val: 0.743662 test: 0.773213
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  21 loss training:  47.40113778412342 Time :  1303
accuracy train: 0.934198 val: 0.752113 test: 0.770400
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  22 loss training:  46.50782064348459 Time :  1322
accuracy train: 0.936855 val: 0.747887 test: 0.774620
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  23 loss training:  44.06632871925831 Time :  1331
accuracy train: 0.941232 val: 0.746479 test: 0.772932
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  24 loss training:  42.65521828085184 Time :  1354
accuracy train: 0.947952 val: 0.749296 test: 0.774339
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  25 loss training:  41.57760852575302 Time :  1374
accuracy train: 0.950297 val: 0.753521 test: 0.768149
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  26 loss training:  39.712979800999165 Time :  1388
accuracy train: 0.953892 val: 0.754930 test: 0.770118
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  27 loss training:  38.12521281093359 Time :  1407
accuracy train: 0.960456 val: 0.752113 test: 0.767023
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  28 loss training:  39.18547108769417 Time :  1421
accuracy train: 0.962019 val: 0.753521 test: 0.772651
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  29 loss training:  36.684450313448906 Time :  1442
accuracy train: 0.965614 val: 0.746479 test: 0.765898
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  30 loss training:  35.363668479025364 Time :  1466
accuracy train: 0.968428 val: 0.749296 test: 0.768149
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  31 loss training:  33.87076951563358 Time :  1476
accuracy train: 0.972491 val: 0.753521 test: 0.769274
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  32 loss training:  32.1320885643363 Time :  1494
accuracy train: 0.973429 val: 0.750704 test: 0.768711
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  33 loss training:  30.80756228417158 Time :  1532
accuracy train: 0.976086 val: 0.742254 test: 0.767304
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  34 loss training:  30.7004778906703 Time :  1543
accuracy train: 0.978900 val: 0.743662 test: 0.767304
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  35 loss training:  28.31555101275444 Time :  1560
accuracy train: 0.983745 val: 0.740845 test: 0.765335
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  36 loss training:  28.216070419177413 Time :  1595
accuracy train: 0.982807 val: 0.745070 test: 0.766179
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  37 loss training:  26.144068520516157 Time :  1610
accuracy train: 0.987965 val: 0.750704 test: 0.767023
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  38 loss training:  24.366598907858133 Time :  1630
accuracy train: 0.988434 val: 0.750704 test: 0.769837
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  39 loss training:  24.51398876309395 Time :  1649
accuracy train: 0.990153 val: 0.743662 test: 0.769555
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  40 loss training:  23.74159349501133 Time :  1671
accuracy train: 0.991872 val: 0.740845 test: 0.763928
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  41 loss training:  21.877768322825432 Time :  1689
accuracy train: 0.990622 val: 0.730986 test: 0.765616
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  42 loss training:  22.083060264587402 Time :  1700
accuracy train: 0.993435 val: 0.749296 test: 0.773213
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

Epoch :  43 loss training:  21.566786291077733 Time :  1725
accuracy train: 0.994061 val: 0.742254 test: 0.770681
max validation accuracy : 0.764789 max acc epoch : 12 test accuracy : 0.771525

========================================================================================================================================================================================================
max acc epoch :  12
max validation accuracy :  0.7647887323943662
test accuracy :  0.7715250422059651
last test_accuracy :  0.7706809229037704
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=275, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  90.48136335611343 Time :  1749
accuracy train: 0.783682 val: 0.733803 test: 0.768430
max validation accuracy : 0.733803 max acc epoch : 1 test accuracy : 0.768430
Epoch-1 lr: 0.001

Epoch :  2 loss training:  81.66226018965244 Time :  1759
accuracy train: 0.805408 val: 0.726761 test: 0.774057
max validation accuracy : 0.733803 max acc epoch : 1 test accuracy : 0.768430
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.15569660067558 Time :  1781
accuracy train: 0.797437 val: 0.712676 test: 0.748452
max validation accuracy : 0.733803 max acc epoch : 1 test accuracy : 0.768430
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.21528571844101 Time :  1808
accuracy train: 0.825414 val: 0.740845 test: 0.767023
max validation accuracy : 0.740845 max acc epoch : 4 test accuracy : 0.767023
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.0435177385807 Time :  1821
accuracy train: 0.839012 val: 0.747887 test: 0.771806
max validation accuracy : 0.747887 max acc epoch : 5 test accuracy : 0.771806
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.91674001514912 Time :  1843
accuracy train: 0.842763 val: 0.752113 test: 0.768430
max validation accuracy : 0.752113 max acc epoch : 6 test accuracy : 0.768430
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.10072295367718 Time :  1862
accuracy train: 0.857768 val: 0.769014 test: 0.768993
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.5822206735611 Time :  1886
accuracy train: 0.870741 val: 0.759155 test: 0.764772
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.80853992700577 Time :  1909
accuracy train: 0.878868 val: 0.759155 test: 0.763365
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.258412316441536 Time :  1922
accuracy train: 0.884808 val: 0.749296 test: 0.764772
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.37228448688984 Time :  1944
accuracy train: 0.884964 val: 0.759155 test: 0.768711
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.24266366660595 Time :  1976
accuracy train: 0.893092 val: 0.760563 test: 0.766179
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.23918794095516 Time :  1988
accuracy train: 0.895123 val: 0.759155 test: 0.766742
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.30342571437359 Time :  1999
accuracy train: 0.898249 val: 0.764789 test: 0.767586
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.48680308461189 Time :  2035
accuracy train: 0.900907 val: 0.753521 test: 0.762802
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993

Epoch :  16 loss training:  55.53920729458332 Time :  2054
accuracy train: 0.904814 val: 0.757746 test: 0.767586
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993

Epoch :  17 loss training:  54.46346612274647 Time :  2066
accuracy train: 0.914192 val: 0.753521 test: 0.766179
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993

Epoch :  18 loss training:  51.799560219049454 Time :  2093
accuracy train: 0.921069 val: 0.763380 test: 0.767304
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993

Epoch :  19 loss training:  51.583199724555016 Time :  2115
accuracy train: 0.928884 val: 0.753521 test: 0.766179
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993

Epoch :  20 loss training:  49.601020969450474 Time :  2133
accuracy train: 0.934198 val: 0.757746 test: 0.766179
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993

Epoch :  21 loss training:  47.18824738264084 Time :  2155
accuracy train: 0.937012 val: 0.757746 test: 0.763084
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993

Epoch :  22 loss training:  46.31531044840813 Time :  2174
accuracy train: 0.941544 val: 0.750704 test: 0.767023
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993

Epoch :  23 loss training:  44.88084441423416 Time :  2196
accuracy train: 0.946702 val: 0.760563 test: 0.768711
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993

Epoch :  24 loss training:  42.17277926951647 Time :  2221
accuracy train: 0.950766 val: 0.767606 test: 0.768711
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993

Epoch :  25 loss training:  41.43014853447676 Time :  2233
accuracy train: 0.952954 val: 0.752113 test: 0.765335
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993

Epoch :  26 loss training:  39.566700637340546 Time :  2254
accuracy train: 0.956236 val: 0.760563 test: 0.761958
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993

Epoch :  27 loss training:  38.001217402517796 Time :  2283
accuracy train: 0.964520 val: 0.761972 test: 0.760833
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993

Epoch :  28 loss training:  39.79045560956001 Time :  2295
accuracy train: 0.965614 val: 0.761972 test: 0.764491
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993

Epoch :  29 loss training:  36.38070648908615 Time :  2310
accuracy train: 0.970303 val: 0.753521 test: 0.760833
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993

Epoch :  30 loss training:  35.02931518107653 Time :  2342
accuracy train: 0.971554 val: 0.750704 test: 0.764209
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993

Epoch :  31 loss training:  33.807532392442226 Time :  2361
accuracy train: 0.977649 val: 0.754930 test: 0.763084
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993

Epoch :  32 loss training:  32.10054109990597 Time :  2379
accuracy train: 0.977180 val: 0.767606 test: 0.764491
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993

Epoch :  33 loss training:  30.377677869051695 Time :  2401
accuracy train: 0.979837 val: 0.747887 test: 0.763084
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993

Epoch :  34 loss training:  31.155030973255634 Time :  2420
accuracy train: 0.981244 val: 0.754930 test: 0.762240
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993

Epoch :  35 loss training:  28.467757787555456 Time :  2441
accuracy train: 0.985464 val: 0.760563 test: 0.763647
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993

Epoch :  36 loss training:  27.95097705721855 Time :  2462
accuracy train: 0.986871 val: 0.760563 test: 0.763084
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993

Epoch :  37 loss training:  25.926510274410248 Time :  2476
accuracy train: 0.987027 val: 0.767606 test: 0.760270
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993

Epoch :  38 loss training:  24.334622152149677 Time :  2501
accuracy train: 0.989684 val: 0.754930 test: 0.762521
max validation accuracy : 0.769014 max acc epoch : 7 test accuracy : 0.768993

========================================================================================================================================================================================================
max acc epoch :  7
max validation accuracy :  0.7690140845070422
test accuracy :  0.768992684299381
last test_accuracy :  0.7625211029825548
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=275, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  90.78947940468788 Time :  2537
accuracy train: 0.786183 val: 0.733803 test: 0.770681
max validation accuracy : 0.733803 max acc epoch : 1 test accuracy : 0.770681
Epoch-1 lr: 0.001

Epoch :  2 loss training:  81.63083849847317 Time :  2548
accuracy train: 0.803689 val: 0.742254 test: 0.774339
max validation accuracy : 0.742254 max acc epoch : 2 test accuracy : 0.774339
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.85481461882591 Time :  2563
accuracy train: 0.797749 val: 0.711268 test: 0.748452
max validation accuracy : 0.742254 max acc epoch : 2 test accuracy : 0.774339
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.84203064441681 Time :  2597
accuracy train: 0.834636 val: 0.756338 test: 0.774339
max validation accuracy : 0.756338 max acc epoch : 4 test accuracy : 0.774339
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  70.9111480563879 Time :  2615
accuracy train: 0.844483 val: 0.752113 test: 0.773213
max validation accuracy : 0.756338 max acc epoch : 4 test accuracy : 0.774339
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.84935887157917 Time :  2635
accuracy train: 0.840888 val: 0.753521 test: 0.772088
max validation accuracy : 0.756338 max acc epoch : 4 test accuracy : 0.774339
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.01923103630543 Time :  2657
accuracy train: 0.859800 val: 0.754930 test: 0.771525
max validation accuracy : 0.756338 max acc epoch : 4 test accuracy : 0.774339
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.57872028648853 Time :  2671
accuracy train: 0.871679 val: 0.756338 test: 0.771806
max validation accuracy : 0.756338 max acc epoch : 4 test accuracy : 0.774339
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.47643332183361 Time :  2694
accuracy train: 0.878087 val: 0.760563 test: 0.768993
max validation accuracy : 0.760563 max acc epoch : 9 test accuracy : 0.768993
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.24977992475033 Time :  2722
accuracy train: 0.884183 val: 0.754930 test: 0.766742
max validation accuracy : 0.760563 max acc epoch : 9 test accuracy : 0.768993
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.05900092422962 Time :  2734
accuracy train: 0.889340 val: 0.757746 test: 0.775183
max validation accuracy : 0.760563 max acc epoch : 9 test accuracy : 0.768993
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.035839676856995 Time :  2756
accuracy train: 0.897468 val: 0.763380 test: 0.772932
max validation accuracy : 0.763380 max acc epoch : 12 test accuracy : 0.772932
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.32239319384098 Time :  2794
accuracy train: 0.901219 val: 0.759155 test: 0.772369
max validation accuracy : 0.763380 max acc epoch : 12 test accuracy : 0.772932
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  55.764179825782776 Time :  2808
accuracy train: 0.902001 val: 0.757746 test: 0.770118
max validation accuracy : 0.763380 max acc epoch : 12 test accuracy : 0.772932
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.57657325267792 Time :  2829
accuracy train: 0.906846 val: 0.759155 test: 0.768149
max validation accuracy : 0.763380 max acc epoch : 12 test accuracy : 0.772932

Epoch :  16 loss training:  55.13245248794556 Time :  2854
accuracy train: 0.911066 val: 0.760563 test: 0.766742
max validation accuracy : 0.763380 max acc epoch : 12 test accuracy : 0.772932

Epoch :  17 loss training:  53.25695799291134 Time :  2870
accuracy train: 0.915286 val: 0.752113 test: 0.771244
max validation accuracy : 0.763380 max acc epoch : 12 test accuracy : 0.772932

Epoch :  18 loss training:  51.987137854099274 Time :  2897
accuracy train: 0.919819 val: 0.754930 test: 0.770962
max validation accuracy : 0.763380 max acc epoch : 12 test accuracy : 0.772932

Epoch :  19 loss training:  50.79235574603081 Time :  2919
accuracy train: 0.928415 val: 0.749296 test: 0.764491
max validation accuracy : 0.763380 max acc epoch : 12 test accuracy : 0.772932

Epoch :  20 loss training:  49.67401645332575 Time :  2930
accuracy train: 0.933104 val: 0.756338 test: 0.764491
max validation accuracy : 0.763380 max acc epoch : 12 test accuracy : 0.772932

Epoch :  21 loss training:  47.2481894493103 Time :  2953
accuracy train: 0.936543 val: 0.752113 test: 0.764209
max validation accuracy : 0.763380 max acc epoch : 12 test accuracy : 0.772932

Epoch :  22 loss training:  45.79157841205597 Time :  2982
accuracy train: 0.942482 val: 0.757746 test: 0.767304
max validation accuracy : 0.763380 max acc epoch : 12 test accuracy : 0.772932

Epoch :  23 loss training:  44.24038653075695 Time :  2999
accuracy train: 0.946233 val: 0.754930 test: 0.767023
max validation accuracy : 0.763380 max acc epoch : 12 test accuracy : 0.772932

Epoch :  24 loss training:  42.37144723534584 Time :  3014
accuracy train: 0.948734 val: 0.766197 test: 0.767867
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  25 loss training:  41.20120865851641 Time :  3036
accuracy train: 0.953267 val: 0.763380 test: 0.770118
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  26 loss training:  39.559062249958515 Time :  3059
accuracy train: 0.956549 val: 0.757746 test: 0.763928
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  27 loss training:  38.75939130038023 Time :  3085
accuracy train: 0.962488 val: 0.760563 test: 0.762240
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  28 loss training:  38.98070704936981 Time :  3115
accuracy train: 0.963270 val: 0.764789 test: 0.766179
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  29 loss training:  36.274521850049496 Time :  3127
accuracy train: 0.966865 val: 0.759155 test: 0.759426
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  30 loss training:  35.26026304066181 Time :  3156
accuracy train: 0.969053 val: 0.749296 test: 0.764209
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  31 loss training:  33.66067937016487 Time :  3187
accuracy train: 0.974992 val: 0.760563 test: 0.760551
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  32 loss training:  31.948492884635925 Time :  3197
accuracy train: 0.977337 val: 0.760563 test: 0.764772
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  33 loss training:  30.1354945525527 Time :  3228
accuracy train: 0.977962 val: 0.752113 test: 0.762521
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  34 loss training:  31.142480313777924 Time :  3256
accuracy train: 0.982495 val: 0.750704 test: 0.765616
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  35 loss training:  28.355886101722717 Time :  3273
accuracy train: 0.984683 val: 0.753521 test: 0.763365
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  36 loss training:  28.276931112632155 Time :  3297
accuracy train: 0.985308 val: 0.752113 test: 0.763084
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  37 loss training:  25.877624046057463 Time :  3318
accuracy train: 0.985777 val: 0.752113 test: 0.764209
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  38 loss training:  24.82099055312574 Time :  3344
accuracy train: 0.987652 val: 0.754930 test: 0.763928
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  39 loss training:  24.140804950147867 Time :  3369
accuracy train: 0.989684 val: 0.749296 test: 0.761958
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  40 loss training:  24.463961197063327 Time :  3382
accuracy train: 0.991716 val: 0.745070 test: 0.759989
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  41 loss training:  22.432569090276957 Time :  3400
accuracy train: 0.992654 val: 0.743662 test: 0.760551
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  42 loss training:  21.713732846081257 Time :  3438
accuracy train: 0.994373 val: 0.740845 test: 0.764209
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  43 loss training:  20.89083045721054 Time :  3450
accuracy train: 0.994998 val: 0.749296 test: 0.763928
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  44 loss training:  21.3135727327317 Time :  3462
accuracy train: 0.995936 val: 0.747887 test: 0.760270
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  45 loss training:  20.181615276262164 Time :  3496
accuracy train: 0.996249 val: 0.746479 test: 0.764491
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  46 loss training:  20.18212676420808 Time :  3512
accuracy train: 0.996249 val: 0.754930 test: 0.766179
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  47 loss training:  18.257530042901635 Time :  3529
accuracy train: 0.997187 val: 0.746479 test: 0.763928
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  48 loss training:  16.861023731529713 Time :  3554
accuracy train: 0.997030 val: 0.749296 test: 0.759989
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  49 loss training:  17.977225266397 Time :  3573
accuracy train: 0.997968 val: 0.745070 test: 0.761958
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  50 loss training:  15.994675811380148 Time :  3604
accuracy train: 0.997812 val: 0.750704 test: 0.761677
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  51 loss training:  16.249763313680887 Time :  3622
accuracy train: 0.998281 val: 0.745070 test: 0.764772
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  52 loss training:  14.900260110385716 Time :  3636
accuracy train: 0.998437 val: 0.740845 test: 0.763365
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  53 loss training:  14.681923506781459 Time :  3663
accuracy train: 0.998593 val: 0.752113 test: 0.764772
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  54 loss training:  14.497522242367268 Time :  3693
accuracy train: 0.998750 val: 0.752113 test: 0.765898
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

Epoch :  55 loss training:  14.373075260780752 Time :  3708
accuracy train: 0.998750 val: 0.754930 test: 0.763365
max validation accuracy : 0.766197 max acc epoch : 24 test accuracy : 0.767867

========================================================================================================================================================================================================
max acc epoch :  24
max validation accuracy :  0.7661971830985915
test accuracy :  0.7678671918964547
last test_accuracy :  0.7633652222847496
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.76338 	 test_accuracy : 0.77124 	 max_acc epoch :  14 	 last test_accuracy : 0.76646
k :  1 	 val_accuracy : 0.76479 	 test_accuracy : 0.77153 	 max_acc epoch :  12 	 last test_accuracy : 0.77068
k :  2 	 val_accuracy : 0.76901 	 test_accuracy : 0.76899 	 max_acc epoch :  7 	 last test_accuracy : 0.76252
k :  3 	 val_accuracy : 0.76620 	 test_accuracy : 0.76787 	 max_acc epoch :  24 	 last test_accuracy : 0.76337

avg :  	 val_accuracy : 0.76585 	 test_accuracy : 0.76991 	 last_accuracy : 0.76576


date and time :  Sat May 22 19:51:12 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=614, weight_decay=1e-06)
device :  cuda:0
Counter({1: 6241, 0: 4421})

Epoch :  1 loss training:  92.286785364151 Time :  75
accuracy train: 0.777743 val: 0.747887 test: 0.755768
max validation accuracy : 0.747887 max acc epoch : 1 test accuracy : 0.755768
Counter({1: 5932, 0: 4730})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.46500086784363 Time :  157
accuracy train: 0.784776 val: 0.769014 test: 0.766179
max validation accuracy : 0.769014 max acc epoch : 2 test accuracy : 0.766179
Counter({1: 5878, 0: 4784})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.88506069779396 Time :  219
accuracy train: 0.810722 val: 0.784507 test: 0.766179
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({1: 5831, 0: 4831})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  71.83021454513073 Time :  284
accuracy train: 0.830572 val: 0.784507 test: 0.773776
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({0: 5838, 1: 4824})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  70.634122133255 Time :  338
accuracy train: 0.834011 val: 0.767606 test: 0.773495
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({1: 5785, 0: 4877})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  68.67940980195999 Time :  406
accuracy train: 0.852141 val: 0.763380 test: 0.771244
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({1: 5952, 0: 4710})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  64.65329226851463 Time :  468
accuracy train: 0.858862 val: 0.776056 test: 0.779403
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({0: 5984, 1: 4678})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  63.139932453632355 Time :  529
accuracy train: 0.865114 val: 0.780282 test: 0.777153
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({0: 5982, 1: 4680})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  61.48264878988266 Time :  585
accuracy train: 0.875274 val: 0.769014 test: 0.773495
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({1: 5987, 0: 4675})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  58.24277354776859 Time :  646
accuracy train: 0.879181 val: 0.769014 test: 0.777997
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({0: 6034, 1: 4628})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.902366161346436 Time :  718
accuracy train: 0.885589 val: 0.773239 test: 0.774902
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({0: 6048, 1: 4614})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  57.95701076090336 Time :  770
accuracy train: 0.890435 val: 0.777465 test: 0.773495
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({0: 6030, 1: 4632})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  55.93311543762684 Time :  831
accuracy train: 0.893404 val: 0.780282 test: 0.772651
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({1: 6042, 0: 4620})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  55.57708232104778 Time :  884
accuracy train: 0.895436 val: 0.778873 test: 0.769837
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({1: 6047, 0: 4615})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  55.43340526521206 Time :  952
accuracy train: 0.897468 val: 0.776056 test: 0.774057
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({0: 6054, 1: 4608})

Epoch :  16 loss training:  53.69918145239353 Time :  1008
accuracy train: 0.904189 val: 0.773239 test: 0.769555
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({0: 6066, 1: 4596})

Epoch :  17 loss training:  52.33552621304989 Time :  1070
accuracy train: 0.909503 val: 0.780282 test: 0.775183
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({0: 6086, 1: 4576})

Epoch :  18 loss training:  50.392909705638885 Time :  1123
accuracy train: 0.916224 val: 0.777465 test: 0.773213
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({0: 6088, 1: 4574})

Epoch :  19 loss training:  49.25507374852896 Time :  1188
accuracy train: 0.922319 val: 0.771831 test: 0.768149
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({0: 6107, 1: 4555})

Epoch :  20 loss training:  48.26488560438156 Time :  1238
accuracy train: 0.926852 val: 0.783099 test: 0.771244
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({1: 6148, 0: 4514})

Epoch :  21 loss training:  46.283951714634895 Time :  1299
accuracy train: 0.932635 val: 0.767606 test: 0.771525
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({1: 6173, 0: 4489})

Epoch :  22 loss training:  45.608159460127354 Time :  1351
accuracy train: 0.938262 val: 0.778873 test: 0.767867
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({0: 6174, 1: 4488})

Epoch :  23 loss training:  43.32474948465824 Time :  1409
accuracy train: 0.940919 val: 0.769014 test: 0.767586
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({0: 6186, 1: 4476})

Epoch :  24 loss training:  42.11617047339678 Time :  1458
accuracy train: 0.946389 val: 0.778873 test: 0.762240
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({1: 6219, 0: 4443})

Epoch :  25 loss training:  40.52341769635677 Time :  1519
accuracy train: 0.951704 val: 0.778873 test: 0.767304
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({0: 6222, 1: 4440})

Epoch :  26 loss training:  37.85012235492468 Time :  1574
accuracy train: 0.957643 val: 0.776056 test: 0.768149
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({0: 6225, 1: 4437})

Epoch :  27 loss training:  37.830855183303356 Time :  1631
accuracy train: 0.961082 val: 0.769014 test: 0.765898
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({0: 6245, 1: 4417})

Epoch :  28 loss training:  34.987102188169956 Time :  1683
accuracy train: 0.965614 val: 0.763380 test: 0.764772
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({1: 6261, 0: 4401})

Epoch :  29 loss training:  34.58229485154152 Time :  1742
accuracy train: 0.965145 val: 0.771831 test: 0.765053
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({0: 6264, 1: 4398})

Epoch :  30 loss training:  33.749049965292215 Time :  1799
accuracy train: 0.967646 val: 0.769014 test: 0.767586
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({0: 6264, 1: 4398})

Epoch :  31 loss training:  32.60138397663832 Time :  1864
accuracy train: 0.971397 val: 0.774648 test: 0.766460
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({0: 6252, 1: 4410})

Epoch :  32 loss training:  30.075496934354305 Time :  1923
accuracy train: 0.977024 val: 0.764789 test: 0.765053
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({0: 6270, 1: 4392})

Epoch :  33 loss training:  30.119945891201496 Time :  1973
accuracy train: 0.977180 val: 0.764789 test: 0.765053
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({1: 6271, 0: 4391})

Epoch :  34 loss training:  27.746220853179693 Time :  2039
accuracy train: 0.982182 val: 0.761972 test: 0.764209
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.766179
Counter({0: 6294, 1: 4368})

========================================================================================================================================================================================================
max acc epoch :  3
max validation accuracy :  0.7845070422535211
test accuracy :  0.7661789532920653
last test_accuracy :  0.7642093415869443
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=614, weight_decay=1e-06)
device :  cuda:0
Counter({1: 6241, 0: 4421})

Epoch :  1 loss training:  92.27031862735748 Time :  2144
accuracy train: 0.777118 val: 0.743662 test: 0.759989
max validation accuracy : 0.743662 max acc epoch : 1 test accuracy : 0.759989
Counter({0: 6132, 1: 4530})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.29783007502556 Time :  2212
accuracy train: 0.785558 val: 0.763380 test: 0.771806
max validation accuracy : 0.763380 max acc epoch : 2 test accuracy : 0.771806
Counter({0: 6022, 1: 4640})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.13053157925606 Time :  2285
accuracy train: 0.810410 val: 0.781690 test: 0.770681
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.770681
Counter({0: 5543, 1: 5119})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  71.94725148379803 Time :  2361
accuracy train: 0.829478 val: 0.788732 test: 0.778559
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({1: 5438, 0: 5224})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.31864555180073 Time :  2431
accuracy train: 0.831510 val: 0.770423 test: 0.773495
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({1: 5623, 0: 5039})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  68.63143654167652 Time :  2503
accuracy train: 0.849953 val: 0.770423 test: 0.774620
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 5783, 1: 4879})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  65.7486307322979 Time :  2581
accuracy train: 0.859331 val: 0.764789 test: 0.781654
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 5813, 1: 4849})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  63.79859235882759 Time :  2647
accuracy train: 0.860738 val: 0.769014 test: 0.771525
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 5856, 1: 4806})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  61.92322976887226 Time :  2703
accuracy train: 0.871366 val: 0.763380 test: 0.769837
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({1: 5910, 0: 4752})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  58.852885618805885 Time :  2773
accuracy train: 0.876368 val: 0.766197 test: 0.774902
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({1: 5931, 0: 4731})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.582096338272095 Time :  2843
accuracy train: 0.881057 val: 0.763380 test: 0.774902
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({1: 5943, 0: 4719})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.254496693611145 Time :  2913
accuracy train: 0.889184 val: 0.771831 test: 0.772651
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 5977, 1: 4685})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  56.332072511315346 Time :  2976
accuracy train: 0.889497 val: 0.769014 test: 0.775183
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({1: 6006, 0: 4656})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.36705480515957 Time :  3031
accuracy train: 0.894811 val: 0.770423 test: 0.774057
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6011, 1: 4651})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.13742160797119 Time :  3095
accuracy train: 0.895592 val: 0.769014 test: 0.768993
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({1: 6013, 0: 4649})

Epoch :  16 loss training:  54.66194623708725 Time :  3151
accuracy train: 0.901219 val: 0.771831 test: 0.771525
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6012, 1: 4650})

Epoch :  17 loss training:  52.611632004380226 Time :  3213
accuracy train: 0.907158 val: 0.764789 test: 0.774620
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6019, 1: 4643})

Epoch :  18 loss training:  51.707678124308586 Time :  3268
accuracy train: 0.912160 val: 0.771831 test: 0.772651
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({1: 6016, 0: 4646})

Epoch :  19 loss training:  49.94498908519745 Time :  3329
accuracy train: 0.919975 val: 0.761972 test: 0.765053
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({1: 6053, 0: 4609})

Epoch :  20 loss training:  48.26048055291176 Time :  3389
accuracy train: 0.922007 val: 0.764789 test: 0.771525
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({1: 6068, 0: 4594})

Epoch :  21 loss training:  47.09255948662758 Time :  3442
accuracy train: 0.930603 val: 0.773239 test: 0.772651
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6096, 1: 4566})

Epoch :  22 loss training:  45.78567977249622 Time :  3495
accuracy train: 0.932635 val: 0.773239 test: 0.770118
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6105, 1: 4557})

Epoch :  23 loss training:  44.31866234540939 Time :  3555
accuracy train: 0.939669 val: 0.764789 test: 0.768149
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({1: 6123, 0: 4539})

Epoch :  24 loss training:  43.22849544137716 Time :  3616
accuracy train: 0.941075 val: 0.769014 test: 0.768430
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6134, 1: 4528})

Epoch :  25 loss training:  40.19214301556349 Time :  3666
accuracy train: 0.945295 val: 0.761972 test: 0.768430
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({1: 6139, 0: 4523})

Epoch :  26 loss training:  38.929908603429794 Time :  3723
accuracy train: 0.951078 val: 0.769014 test: 0.767586
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6134, 1: 4528})

Epoch :  27 loss training:  39.35558707267046 Time :  3781
accuracy train: 0.957174 val: 0.761972 test: 0.769274
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6130, 1: 4532})

Epoch :  28 loss training:  35.87154692411423 Time :  3849
accuracy train: 0.961863 val: 0.766197 test: 0.770400
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6161, 1: 4501})

Epoch :  29 loss training:  35.2139278203249 Time :  3903
accuracy train: 0.963426 val: 0.769014 test: 0.767586
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6191, 1: 4471})

Epoch :  30 loss training:  34.30771469324827 Time :  3971
accuracy train: 0.965302 val: 0.771831 test: 0.765335
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6205, 1: 4457})

Epoch :  31 loss training:  32.65079604834318 Time :  4028
accuracy train: 0.970147 val: 0.763380 test: 0.764772
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({1: 6211, 0: 4451})

Epoch :  32 loss training:  30.90240440890193 Time :  4089
accuracy train: 0.975461 val: 0.764789 test: 0.768993
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6230, 1: 4432})

Epoch :  33 loss training:  31.35176730901003 Time :  4137
accuracy train: 0.975774 val: 0.764789 test: 0.764772
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6246, 1: 4416})

Epoch :  34 loss training:  28.94523163512349 Time :  4192
accuracy train: 0.981869 val: 0.763380 test: 0.768711
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6279, 1: 4383})

Epoch :  35 loss training:  26.96101175621152 Time :  4249
accuracy train: 0.982807 val: 0.759155 test: 0.770118
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.778559
Counter({1: 6311, 0: 4351})

========================================================================================================================================================================================================
max acc epoch :  4
max validation accuracy :  0.7887323943661971
test accuracy :  0.7785593697242543
last test_accuracy :  0.7701181767023073
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=614, weight_decay=1e-06)
device :  cuda:0
Counter({1: 6241, 0: 4421})

Epoch :  1 loss training:  92.3055377304554 Time :  4346
accuracy train: 0.775086 val: 0.740845 test: 0.751548
max validation accuracy : 0.740845 max acc epoch : 1 test accuracy : 0.751548
Counter({0: 6201, 1: 4461})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.27333322167397 Time :  4419
accuracy train: 0.780713 val: 0.770423 test: 0.762802
max validation accuracy : 0.770423 max acc epoch : 2 test accuracy : 0.762802
Counter({0: 5784, 1: 4878})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.17030081152916 Time :  4492
accuracy train: 0.811035 val: 0.778873 test: 0.763365
max validation accuracy : 0.778873 max acc epoch : 3 test accuracy : 0.763365
Counter({1: 5499, 0: 5163})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  71.93473687767982 Time :  4550
accuracy train: 0.827446 val: 0.778873 test: 0.775183
max validation accuracy : 0.778873 max acc epoch : 3 test accuracy : 0.763365
Counter({0: 5455, 1: 5207})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.28325074911118 Time :  4612
accuracy train: 0.833073 val: 0.771831 test: 0.778841
max validation accuracy : 0.778873 max acc epoch : 3 test accuracy : 0.763365
Counter({0: 5516, 1: 5146})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  68.53564164042473 Time :  4671
accuracy train: 0.846671 val: 0.771831 test: 0.768711
max validation accuracy : 0.778873 max acc epoch : 3 test accuracy : 0.763365
Counter({1: 5662, 0: 5000})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  65.36164382100105 Time :  4731
accuracy train: 0.856518 val: 0.791549 test: 0.779685
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({0: 5735, 1: 4927})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  63.767274901270866 Time :  4795
accuracy train: 0.858081 val: 0.777465 test: 0.770681
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({0: 5756, 1: 4906})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  61.73335516452789 Time :  4852
accuracy train: 0.869178 val: 0.781690 test: 0.770962
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({1: 5742, 0: 4920})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.53819514811039 Time :  4913
accuracy train: 0.874492 val: 0.773239 test: 0.772932
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({1: 5817, 0: 4845})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.47045734524727 Time :  4968
accuracy train: 0.876993 val: 0.773239 test: 0.771806
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({0: 5805, 1: 4857})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.20283855497837 Time :  5042
accuracy train: 0.884964 val: 0.764789 test: 0.766460
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({0: 5818, 1: 4844})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.007004871964455 Time :  5103
accuracy train: 0.887621 val: 0.777465 test: 0.771806
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({0: 5830, 1: 4832})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.844358041882515 Time :  5164
accuracy train: 0.888715 val: 0.776056 test: 0.765053
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({0: 5849, 1: 4813})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.7670456469059 Time :  5223
accuracy train: 0.891060 val: 0.773239 test: 0.763928
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({0: 5892, 1: 4770})

Epoch :  16 loss training:  55.31462587416172 Time :  5284
accuracy train: 0.898093 val: 0.764789 test: 0.765898
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({0: 5930, 1: 4732})

Epoch :  17 loss training:  53.28060953319073 Time :  5350
accuracy train: 0.901219 val: 0.776056 test: 0.767304
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({0: 5976, 1: 4686})

Epoch :  18 loss training:  51.84860396385193 Time :  5405
accuracy train: 0.909034 val: 0.766197 test: 0.770400
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({0: 6001, 1: 4661})

Epoch :  19 loss training:  50.75533843040466 Time :  5473
accuracy train: 0.919662 val: 0.769014 test: 0.763928
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({1: 6035, 0: 4627})

Epoch :  20 loss training:  49.01919287443161 Time :  5531
accuracy train: 0.920288 val: 0.774648 test: 0.766742
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({0: 6080, 1: 4582})

Epoch :  21 loss training:  47.41422763466835 Time :  5605
accuracy train: 0.927634 val: 0.766197 test: 0.764209
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({0: 6134, 1: 4528})

Epoch :  22 loss training:  46.427843019366264 Time :  5668
accuracy train: 0.930447 val: 0.767606 test: 0.768149
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({0: 6154, 1: 4508})

Epoch :  23 loss training:  44.75880479067564 Time :  5731
accuracy train: 0.936230 val: 0.764789 test: 0.764772
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({0: 6169, 1: 4493})

Epoch :  24 loss training:  43.35777300596237 Time :  5790
accuracy train: 0.942013 val: 0.769014 test: 0.763084
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({0: 6216, 1: 4446})

Epoch :  25 loss training:  40.97931709885597 Time :  5855
accuracy train: 0.947640 val: 0.763380 test: 0.764209
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({0: 6213, 1: 4449})

Epoch :  26 loss training:  38.55840300023556 Time :  5908
accuracy train: 0.951860 val: 0.770423 test: 0.767867
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({1: 6228, 0: 4434})

Epoch :  27 loss training:  38.99872950464487 Time :  5966
accuracy train: 0.955924 val: 0.770423 test: 0.762521
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({0: 6250, 1: 4412})

Epoch :  28 loss training:  36.07462114095688 Time :  6021
accuracy train: 0.960456 val: 0.770423 test: 0.762240
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({0: 6281, 1: 4381})

Epoch :  29 loss training:  35.605285316705704 Time :  6079
accuracy train: 0.959206 val: 0.769014 test: 0.767304
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({1: 6307, 0: 4355})

Epoch :  30 loss training:  34.64031979441643 Time :  6127
accuracy train: 0.963426 val: 0.771831 test: 0.763647
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({0: 6320, 1: 4342})

Epoch :  31 loss training:  32.42727470770478 Time :  6193
accuracy train: 0.969209 val: 0.771831 test: 0.759707
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({0: 6330, 1: 4332})

Epoch :  32 loss training:  30.837318040430546 Time :  6248
accuracy train: 0.973117 val: 0.767606 test: 0.762240
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({0: 6359, 1: 4303})

Epoch :  33 loss training:  31.249861378222704 Time :  6307
accuracy train: 0.973742 val: 0.767606 test: 0.761677
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({0: 6358, 1: 4304})

Epoch :  34 loss training:  28.280690483748913 Time :  6359
accuracy train: 0.979994 val: 0.769014 test: 0.761958
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({0: 6366, 1: 4296})

Epoch :  35 loss training:  27.125437188893557 Time :  6422
accuracy train: 0.981869 val: 0.761972 test: 0.757175
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({1: 6388, 0: 4274})

Epoch :  36 loss training:  27.042274441570044 Time :  6478
accuracy train: 0.983901 val: 0.764789 test: 0.760270
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({0: 6391, 1: 4271})

Epoch :  37 loss training:  25.41370363160968 Time :  6531
accuracy train: 0.986089 val: 0.770423 test: 0.758582
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({0: 6396, 1: 4266})

Epoch :  38 loss training:  24.398193672299385 Time :  6572
accuracy train: 0.986558 val: 0.764789 test: 0.758019
max validation accuracy : 0.791549 max acc epoch : 7 test accuracy : 0.779685
Counter({0: 6421, 1: 4241})

========================================================================================================================================================================================================
max acc epoch :  7
max validation accuracy :  0.7915492957746478
test accuracy :  0.7796848621271807
last test_accuracy :  0.7580191333708497
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=614, weight_decay=1e-06)
device :  cuda:0
Counter({1: 6241, 0: 4421})

Epoch :  1 loss training:  92.2371078133583 Time :  6687
accuracy train: 0.776649 val: 0.753521 test: 0.762802
max validation accuracy : 0.753521 max acc epoch : 1 test accuracy : 0.762802
Counter({1: 6304, 0: 4358})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.5429356098175 Time :  6769
accuracy train: 0.795561 val: 0.761972 test: 0.776308
max validation accuracy : 0.761972 max acc epoch : 2 test accuracy : 0.776308
Counter({0: 6608, 1: 4054})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.72688072919846 Time :  6849
accuracy train: 0.809941 val: 0.780282 test: 0.769837
max validation accuracy : 0.780282 max acc epoch : 3 test accuracy : 0.769837
Counter({0: 6253, 1: 4409})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  72.70607875287533 Time :  6930
accuracy train: 0.822913 val: 0.784507 test: 0.778559
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6246, 1: 4416})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.76556189358234 Time :  7008
accuracy train: 0.834948 val: 0.777465 test: 0.781373
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.778559
Counter({1: 6337, 0: 4325})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  69.65173204243183 Time :  7069
accuracy train: 0.842294 val: 0.777465 test: 0.778559
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6483, 1: 4179})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.82668247818947 Time :  7133
accuracy train: 0.852766 val: 0.763380 test: 0.777434
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6475, 1: 4187})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.37342067062855 Time :  7203
accuracy train: 0.858862 val: 0.771831 test: 0.774902
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6767, 1: 3895})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.26180279254913 Time :  7266
accuracy train: 0.864958 val: 0.770423 test: 0.777434
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6924, 1: 3738})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.96418821811676 Time :  7331
accuracy train: 0.868865 val: 0.776056 test: 0.776590
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6714, 1: 3948})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  61.65869925916195 Time :  7390
accuracy train: 0.871991 val: 0.776056 test: 0.775464
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.778559
Counter({1: 6755, 0: 3907})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  60.702331468462944 Time :  7454
accuracy train: 0.878243 val: 0.769014 test: 0.770400
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6682, 1: 3980})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  59.044905707240105 Time :  7523
accuracy train: 0.880900 val: 0.774648 test: 0.767304
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.778559
Counter({1: 6760, 0: 3902})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  59.274323374032974 Time :  7589
accuracy train: 0.882620 val: 0.777465 test: 0.772369
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6734, 1: 3928})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  58.49874821305275 Time :  7662
accuracy train: 0.887309 val: 0.770423 test: 0.773213
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6761, 1: 3901})

Epoch :  16 loss training:  57.084776163101196 Time :  7733
accuracy train: 0.891216 val: 0.766197 test: 0.775746
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6740, 1: 3922})

Epoch :  17 loss training:  55.34885495901108 Time :  7809
accuracy train: 0.895123 val: 0.784507 test: 0.773213
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6790, 1: 3872})

Epoch :  18 loss training:  54.2733982950449 Time :  7882
accuracy train: 0.902938 val: 0.766197 test: 0.771525
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.778559
Counter({1: 6763, 0: 3899})

Epoch :  19 loss training:  53.55795620381832 Time :  7971
accuracy train: 0.909190 val: 0.773239 test: 0.774902
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6839, 1: 3823})

Epoch :  20 loss training:  51.25946846604347 Time :  8050
accuracy train: 0.909659 val: 0.778873 test: 0.776590
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.778559
Counter({1: 6803, 0: 3859})

Epoch :  21 loss training:  49.97047721594572 Time :  8130
accuracy train: 0.921225 val: 0.766197 test: 0.772369
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.778559
Counter({1: 6811, 0: 3851})

Epoch :  22 loss training:  49.15460616350174 Time :  8209
accuracy train: 0.924351 val: 0.776056 test: 0.774902
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.778559
Counter({1: 6791, 0: 3871})

Epoch :  23 loss training:  46.50965069979429 Time :  8290
accuracy train: 0.931385 val: 0.770423 test: 0.773495
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6813, 1: 3849})

Epoch :  24 loss training:  45.60147723555565 Time :  8380
accuracy train: 0.936074 val: 0.777465 test: 0.774902
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6807, 1: 3855})

Epoch :  25 loss training:  43.34611131250858 Time :  8457
accuracy train: 0.939356 val: 0.773239 test: 0.771806
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6865, 1: 3797})

Epoch :  26 loss training:  41.80710279196501 Time :  8534
accuracy train: 0.948265 val: 0.776056 test: 0.771525
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6847, 1: 3815})

Epoch :  27 loss training:  40.65192711353302 Time :  8607
accuracy train: 0.947171 val: 0.777465 test: 0.773776
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.778559
Counter({1: 6822, 0: 3840})

Epoch :  28 loss training:  39.131035037338734 Time :  8699
accuracy train: 0.952485 val: 0.781690 test: 0.773213
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.778559
Counter({0: 6849, 1: 3813})

Epoch :  29 loss training:  38.15412403643131 Time :  8787
accuracy train: 0.949984 val: 0.788732 test: 0.770400
max validation accuracy : 0.788732 max acc epoch : 29 test accuracy : 0.770400
Counter({1: 6850, 0: 3812})

Epoch :  30 loss training:  36.38177835941315 Time :  8871
accuracy train: 0.955767 val: 0.791549 test: 0.775183
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({0: 6815, 1: 3847})

Epoch :  31 loss training:  35.164750047028065 Time :  8960
accuracy train: 0.963113 val: 0.784507 test: 0.774902
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({0: 6783, 1: 3879})

Epoch :  32 loss training:  33.114545933902264 Time :  9035
accuracy train: 0.966552 val: 0.780282 test: 0.774057
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({0: 6794, 1: 3868})

Epoch :  33 loss training:  33.83474226668477 Time :  9122
accuracy train: 0.966396 val: 0.781690 test: 0.777434
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({0: 6758, 1: 3904})

Epoch :  34 loss training:  30.569388210773468 Time :  9198
accuracy train: 0.972335 val: 0.781690 test: 0.774620
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({0: 6748, 1: 3914})

Epoch :  35 loss training:  29.804915089160204 Time :  9273
accuracy train: 0.975305 val: 0.781690 test: 0.775183
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({0: 6731, 1: 3931})

Epoch :  36 loss training:  29.374365162104368 Time :  9345
accuracy train: 0.977337 val: 0.776056 test: 0.772088
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({0: 6741, 1: 3921})

Epoch :  37 loss training:  28.08653214201331 Time :  9429
accuracy train: 0.979212 val: 0.783099 test: 0.774620
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({1: 6717, 0: 3945})

Epoch :  38 loss training:  26.127372939139605 Time :  9501
accuracy train: 0.984370 val: 0.778873 test: 0.770118
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({1: 6678, 0: 3984})

Epoch :  39 loss training:  24.466246724128723 Time :  9571
accuracy train: 0.986558 val: 0.774648 test: 0.764491
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({1: 6684, 0: 3978})

Epoch :  40 loss training:  25.09284045174718 Time :  9646
accuracy train: 0.987809 val: 0.771831 test: 0.766179
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({0: 6648, 1: 4014})

Epoch :  41 loss training:  21.90690838545561 Time :  9727
accuracy train: 0.988278 val: 0.780282 test: 0.767867
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({0: 6643, 1: 4019})

Epoch :  42 loss training:  21.13291541673243 Time :  9807
accuracy train: 0.988903 val: 0.780282 test: 0.770118
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({0: 6637, 1: 4025})

Epoch :  43 loss training:  21.777617689222097 Time :  9874
accuracy train: 0.989997 val: 0.781690 test: 0.765616
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({0: 6597, 1: 4065})

Epoch :  44 loss training:  20.313739102333784 Time :  9964
accuracy train: 0.991560 val: 0.783099 test: 0.768149
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({1: 6505, 0: 4157})

Epoch :  45 loss training:  19.180434508249164 Time :  10043
accuracy train: 0.991872 val: 0.778873 test: 0.766460
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({1: 6501, 0: 4161})

Epoch :  46 loss training:  18.1415335573256 Time :  10128
accuracy train: 0.993279 val: 0.783099 test: 0.765335
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({0: 6472, 1: 4190})

Epoch :  47 loss training:  17.37021293863654 Time :  10205
accuracy train: 0.994061 val: 0.773239 test: 0.764209
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({1: 6470, 0: 4192})

Epoch :  48 loss training:  18.139006732031703 Time :  10268
accuracy train: 0.994217 val: 0.777465 test: 0.763084
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({0: 6441, 1: 4221})

Epoch :  49 loss training:  16.0675738863647 Time :  10350
accuracy train: 0.995311 val: 0.773239 test: 0.766460
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({0: 6439, 1: 4223})

Epoch :  50 loss training:  15.728266704827547 Time :  10433
accuracy train: 0.995936 val: 0.777465 test: 0.766460
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({0: 6425, 1: 4237})

Epoch :  51 loss training:  14.608598615042865 Time :  10503
accuracy train: 0.997499 val: 0.773239 test: 0.766742
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({0: 6336, 1: 4326})

Epoch :  52 loss training:  14.715369537472725 Time :  10585
accuracy train: 0.995780 val: 0.780282 test: 0.765898
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({1: 6236, 0: 4426})

Epoch :  53 loss training:  13.568798911757767 Time :  10671
accuracy train: 0.997187 val: 0.780282 test: 0.764772
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({1: 6232, 0: 4430})

Epoch :  54 loss training:  13.174103336408734 Time :  10749
accuracy train: 0.997656 val: 0.785915 test: 0.766742
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({1: 6141, 0: 4521})

Epoch :  55 loss training:  11.703612945973873 Time :  10825
accuracy train: 0.998124 val: 0.781690 test: 0.768149
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({1: 6131, 0: 4531})

Epoch :  56 loss training:  11.078030141070485 Time :  10902
accuracy train: 0.998437 val: 0.790141 test: 0.763928
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({1: 6136, 0: 4526})

Epoch :  57 loss training:  10.91877754451707 Time :  10970
accuracy train: 0.998437 val: 0.777465 test: 0.765898
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({0: 6090, 1: 4572})

Epoch :  58 loss training:  10.836581815965474 Time :  11051
accuracy train: 0.998906 val: 0.783099 test: 0.764772
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({1: 6109, 0: 4553})

Epoch :  59 loss training:  9.863002546597272 Time :  11131
accuracy train: 0.999062 val: 0.785915 test: 0.763647
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({1: 6106, 0: 4556})

Epoch :  60 loss training:  9.064913811860606 Time :  11202
accuracy train: 0.999375 val: 0.774648 test: 0.764209
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({0: 6089, 1: 4573})

Epoch :  61 loss training:  9.433012390043586 Time :  11281
accuracy train: 0.999687 val: 0.776056 test: 0.759145
max validation accuracy : 0.791549 max acc epoch : 30 test accuracy : 0.775183
Counter({1: 6083, 0: 4579})

========================================================================================================================================================================================================
max acc epoch :  30
max validation accuracy :  0.7915492957746478
test accuracy :  0.7751828925154756
last test_accuracy :  0.7591446257737761
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.78451 	 test_accuracy : 0.76618 	 max_acc epoch :  3 	 last test_accuracy : 0.76421
k :  1 	 val_accuracy : 0.78873 	 test_accuracy : 0.77856 	 max_acc epoch :  4 	 last test_accuracy : 0.77012
k :  2 	 val_accuracy : 0.79155 	 test_accuracy : 0.77968 	 max_acc epoch :  7 	 last test_accuracy : 0.75802
k :  3 	 val_accuracy : 0.79155 	 test_accuracy : 0.77518 	 max_acc epoch :  30 	 last test_accuracy : 0.75914

avg :  	 val_accuracy : 0.78908 	 test_accuracy : 0.77490 	 last_accuracy : 0.76287


date and time :  Sat May 22 23:00:38 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=835, weight_decay=1e-06)
device :  cuda:0
Counter({1: 5076, 2: 3423, 0: 2163})

Epoch :  1 loss training:  92.08895114064217 Time :  147
accuracy train: 0.775555 val: 0.757746 test: 0.767023
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.767023
Counter({2: 4071, 1: 3545, 0: 3046})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.57494732737541 Time :  291
accuracy train: 0.791028 val: 0.732394 test: 0.774620
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.767023
Counter({0: 4162, 2: 3598, 1: 2902})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.46741005778313 Time :  418
accuracy train: 0.803376 val: 0.764789 test: 0.764491
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.764491
Counter({2: 4148, 0: 3315, 1: 3199})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.85478258132935 Time :  549
accuracy train: 0.824789 val: 0.777465 test: 0.774339
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.774339
Counter({2: 4418, 1: 3214, 0: 3030})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.2003063261509 Time :  673
accuracy train: 0.830103 val: 0.750704 test: 0.775464
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.774339
Counter({2: 4622, 1: 3100, 0: 2940})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.32480618357658 Time :  776
accuracy train: 0.840731 val: 0.777465 test: 0.772932
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.774339
Counter({2: 4661, 1: 3123, 0: 2878})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  65.87369786202908 Time :  893
accuracy train: 0.856049 val: 0.774648 test: 0.776027
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.774339
Counter({2: 4664, 1: 3144, 0: 2854})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.99274656176567 Time :  1004
accuracy train: 0.867146 val: 0.787324 test: 0.774902
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.774902
Counter({2: 4807, 1: 3035, 0: 2820})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.79418624937534 Time :  1110
accuracy train: 0.869490 val: 0.784507 test: 0.772369
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.774902
Counter({2: 4798, 0: 3095, 1: 2769})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.93104849755764 Time :  1238
accuracy train: 0.878556 val: 0.785915 test: 0.770400
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.774902
Counter({2: 4827, 0: 3122, 1: 2713})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.886093840003014 Time :  1353
accuracy train: 0.882776 val: 0.783099 test: 0.772369
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.774902
Counter({2: 4853, 0: 2946, 1: 2863})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.634558349847794 Time :  1459
accuracy train: 0.887465 val: 0.776056 test: 0.767304
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.774902
Counter({2: 4916, 0: 2875, 1: 2871})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  55.74315243959427 Time :  1567
accuracy train: 0.891685 val: 0.774648 test: 0.772651
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.774902
Counter({0: 4952, 2: 2862, 1: 2848})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.941250920295715 Time :  1665
accuracy train: 0.894342 val: 0.770423 test: 0.772088
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.774902
Counter({2: 4953, 0: 2857, 1: 2852})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.64640399813652 Time :  1775
accuracy train: 0.896843 val: 0.773239 test: 0.772369
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.774902
Counter({2: 4963, 1: 2853, 0: 2846})

Epoch :  16 loss training:  55.33784598112106 Time :  1884
accuracy train: 0.900438 val: 0.773239 test: 0.767304
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.774902
Counter({2: 4985, 1: 2842, 0: 2835})

Epoch :  17 loss training:  54.1830223351717 Time :  1991
accuracy train: 0.904814 val: 0.778873 test: 0.769837
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.774902
Counter({1: 4979, 2: 2859, 0: 2824})

Epoch :  18 loss training:  51.78654311597347 Time :  2095
accuracy train: 0.912942 val: 0.773239 test: 0.768711
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.774902
Counter({1: 5014, 2: 2849, 0: 2799})

Epoch :  19 loss training:  50.25679913163185 Time :  2207
accuracy train: 0.919506 val: 0.776056 test: 0.767023
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.774902
Counter({2: 4926, 0: 2944, 1: 2792})

Epoch :  20 loss training:  48.78256167471409 Time :  2319
accuracy train: 0.927008 val: 0.780282 test: 0.774620
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.774902
Counter({1: 4906, 0: 2931, 2: 2825})

Epoch :  21 loss training:  47.65383507311344 Time :  2421
accuracy train: 0.931385 val: 0.784507 test: 0.767304
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.774902
Counter({2: 4953, 0: 2942, 1: 2767})

Epoch :  22 loss training:  46.187535524368286 Time :  2517
accuracy train: 0.935136 val: 0.781690 test: 0.771244
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.774902
Counter({1: 4964, 0: 2915, 2: 2783})

Epoch :  23 loss training:  45.454805605113506 Time :  2613
accuracy train: 0.938418 val: 0.781690 test: 0.769274
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.774902
Counter({1: 4971, 2: 2918, 0: 2773})

Epoch :  24 loss training:  43.2522798627615 Time :  2707
accuracy train: 0.945921 val: 0.783099 test: 0.771244
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.774902
Counter({2: 4970, 1: 2916, 0: 2776})

Epoch :  25 loss training:  41.18762604147196 Time :  2799
accuracy train: 0.946702 val: 0.783099 test: 0.771806
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.774902
Counter({0: 4994, 2: 2891, 1: 2777})

Epoch :  26 loss training:  40.61483173072338 Time :  2900
accuracy train: 0.951547 val: 0.787324 test: 0.771525
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.774902
Counter({2: 4974, 0: 2908, 1: 2780})

Epoch :  27 loss training:  38.75116961449385 Time :  2997
accuracy train: 0.955924 val: 0.785915 test: 0.769555
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.774902
Counter({2: 4953, 0: 2950, 1: 2759})

Epoch :  28 loss training:  37.54043201357126 Time :  3099
accuracy train: 0.959831 val: 0.790141 test: 0.772651
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({1: 4963, 0: 2915, 2: 2784})

Epoch :  29 loss training:  35.751205272972584 Time :  3201
accuracy train: 0.963426 val: 0.787324 test: 0.770962
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({1: 4947, 0: 2947, 2: 2768})

Epoch :  30 loss training:  35.56333239376545 Time :  3301
accuracy train: 0.968740 val: 0.783099 test: 0.766460
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({2: 4989, 1: 2921, 0: 2752})

Epoch :  31 loss training:  33.64530802518129 Time :  3404
accuracy train: 0.971710 val: 0.783099 test: 0.765898
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({2: 5003, 0: 2932, 1: 2727})

Epoch :  32 loss training:  31.788772750645876 Time :  3502
accuracy train: 0.974992 val: 0.785915 test: 0.767586
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({1: 5007, 0: 2930, 2: 2725})

Epoch :  33 loss training:  29.467610206454992 Time :  3598
accuracy train: 0.977806 val: 0.781690 test: 0.764772
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({1: 5007, 0: 2909, 2: 2746})

Epoch :  34 loss training:  29.28222007676959 Time :  3691
accuracy train: 0.979681 val: 0.777465 test: 0.772651
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({2: 4983, 0: 2924, 1: 2755})

Epoch :  35 loss training:  28.89004848897457 Time :  3793
accuracy train: 0.982026 val: 0.780282 test: 0.771525
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({2: 4965, 1: 2929, 0: 2768})

Epoch :  36 loss training:  28.51031317561865 Time :  3880
accuracy train: 0.984683 val: 0.780282 test: 0.766742
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({2: 4924, 1: 2994, 0: 2744})

Epoch :  37 loss training:  26.394343059509993 Time :  3983
accuracy train: 0.984526 val: 0.784507 test: 0.768430
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({2: 4894, 0: 2990, 1: 2778})

Epoch :  38 loss training:  25.40902431309223 Time :  4074
accuracy train: 0.989684 val: 0.778873 test: 0.768149
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({1: 4912, 0: 2986, 2: 2764})

Epoch :  39 loss training:  23.47227841615677 Time :  4159
accuracy train: 0.990153 val: 0.778873 test: 0.767586
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({2: 4923, 1: 2972, 0: 2767})

Epoch :  40 loss training:  22.912616029381752 Time :  4258
accuracy train: 0.990778 val: 0.769014 test: 0.767304
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({2: 4920, 0: 2978, 1: 2764})

Epoch :  41 loss training:  22.41565953940153 Time :  4362
accuracy train: 0.992967 val: 0.776056 test: 0.772369
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({2: 4913, 0: 2982, 1: 2767})

Epoch :  42 loss training:  21.31715912371874 Time :  4449
accuracy train: 0.993592 val: 0.780282 test: 0.766179
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({2: 4915, 0: 2985, 1: 2762})

Epoch :  43 loss training:  21.354295616969466 Time :  4540
accuracy train: 0.994217 val: 0.778873 test: 0.772651
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({0: 4891, 1: 2997, 2: 2774})

Epoch :  44 loss training:  20.31027872301638 Time :  4636
accuracy train: 0.995155 val: 0.767606 test: 0.770400
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({1: 4910, 2: 2980, 0: 2772})

Epoch :  45 loss training:  18.81292506866157 Time :  4723
accuracy train: 0.996249 val: 0.777465 test: 0.764209
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({2: 4910, 0: 2961, 1: 2791})

Epoch :  46 loss training:  18.857504290528595 Time :  4811
accuracy train: 0.996405 val: 0.778873 test: 0.769274
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({2: 4911, 0: 2962, 1: 2789})

Epoch :  47 loss training:  17.41229923814535 Time :  4904
accuracy train: 0.995936 val: 0.766197 test: 0.765898
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({2: 4910, 0: 2964, 1: 2788})

Epoch :  48 loss training:  17.06275582499802 Time :  4992
accuracy train: 0.996718 val: 0.771831 test: 0.765335
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({0: 4901, 2: 2969, 1: 2792})

Epoch :  49 loss training:  15.908450443297625 Time :  5079
accuracy train: 0.997343 val: 0.780282 test: 0.768430
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({2: 4832, 0: 3018, 1: 2812})

Epoch :  50 loss training:  15.270862421020865 Time :  5169
accuracy train: 0.997030 val: 0.780282 test: 0.768149
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({2: 4836, 0: 3008, 1: 2818})

Epoch :  51 loss training:  14.86304081324488 Time :  5262
accuracy train: 0.997968 val: 0.784507 test: 0.769837
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({2: 4839, 1: 2999, 0: 2824})

Epoch :  52 loss training:  13.826822414062917 Time :  5342
accuracy train: 0.998281 val: 0.777465 test: 0.767304
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({0: 4846, 1: 2998, 2: 2818})

Epoch :  53 loss training:  14.504425048828125 Time :  5439
accuracy train: 0.998281 val: 0.776056 test: 0.766179
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({2: 4843, 0: 3002, 1: 2817})

Epoch :  54 loss training:  13.245261953677982 Time :  5539
accuracy train: 0.998437 val: 0.776056 test: 0.768430
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({1: 4866, 0: 2977, 2: 2819})

Epoch :  55 loss training:  12.479910668917 Time :  5631
accuracy train: 0.998437 val: 0.773239 test: 0.764209
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({2: 4873, 0: 2982, 1: 2807})

Epoch :  56 loss training:  11.494420864619315 Time :  5722
accuracy train: 0.998593 val: 0.780282 test: 0.765898
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({2: 4851, 0: 2992, 1: 2819})

Epoch :  57 loss training:  12.493179108016193 Time :  5818
accuracy train: 0.998750 val: 0.771831 test: 0.763647
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({2: 4849, 1: 2985, 0: 2828})

Epoch :  58 loss training:  11.392728672362864 Time :  5924
accuracy train: 0.999219 val: 0.781690 test: 0.765335
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({2: 4866, 1: 2995, 0: 2801})

Epoch :  59 loss training:  10.617896341718733 Time :  6028
accuracy train: 0.999062 val: 0.784507 test: 0.766460
max validation accuracy : 0.790141 max acc epoch : 28 test accuracy : 0.772651
Counter({2: 4822, 0: 3031, 1: 2809})

========================================================================================================================================================================================================
max acc epoch :  28
max validation accuracy :  0.7901408450704225
test accuracy :  0.7726505346088914
last test_accuracy :  0.7664603263927968
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=835, weight_decay=1e-06)
device :  cuda:0
Counter({1: 5076, 2: 3423, 0: 2163})

Epoch :  1 loss training:  92.17580604553223 Time :  6248
accuracy train: 0.778368 val: 0.753521 test: 0.765898
max validation accuracy : 0.753521 max acc epoch : 1 test accuracy : 0.765898
Counter({2: 3943, 1: 3428, 0: 3291})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.76459567248821 Time :  6364
accuracy train: 0.790403 val: 0.752113 test: 0.774339
max validation accuracy : 0.753521 max acc epoch : 1 test accuracy : 0.765898
Counter({1: 4081, 0: 3622, 2: 2959})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.07183235883713 Time :  6476
accuracy train: 0.800250 val: 0.769014 test: 0.775183
max validation accuracy : 0.769014 max acc epoch : 3 test accuracy : 0.775183
Counter({0: 4421, 1: 3257, 2: 2984})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.82222902774811 Time :  6606
accuracy train: 0.814317 val: 0.774648 test: 0.764491
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.764491
Counter({0: 4547, 1: 3252, 2: 2863})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.51194210350513 Time :  6705
accuracy train: 0.829165 val: 0.767606 test: 0.775183
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.764491
Counter({2: 4719, 1: 3213, 0: 2730})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.26402395963669 Time :  6827
accuracy train: 0.838543 val: 0.778873 test: 0.773495
max validation accuracy : 0.778873 max acc epoch : 6 test accuracy : 0.773495
Counter({2: 4614, 0: 3066, 1: 2982})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.08389203250408 Time :  6943
accuracy train: 0.854017 val: 0.790141 test: 0.774902
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.774902
Counter({1: 4565, 0: 3187, 2: 2910})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.60963712632656 Time :  7072
accuracy train: 0.861676 val: 0.784507 test: 0.775746
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.774902
Counter({2: 4708, 0: 3154, 1: 2800})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.23768858611584 Time :  7195
accuracy train: 0.866208 val: 0.788732 test: 0.777715
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.774902
Counter({0: 4648, 2: 3279, 1: 2735})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.219755947589874 Time :  7307
accuracy train: 0.872148 val: 0.794366 test: 0.773213
max validation accuracy : 0.794366 max acc epoch : 10 test accuracy : 0.773213
Counter({2: 4687, 1: 3233, 0: 2742})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.47810918092728 Time :  7425
accuracy train: 0.876993 val: 0.783099 test: 0.771244
max validation accuracy : 0.794366 max acc epoch : 10 test accuracy : 0.773213
Counter({2: 4668, 0: 3214, 1: 2780})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.292703077197075 Time :  7528
accuracy train: 0.885589 val: 0.790141 test: 0.771525
max validation accuracy : 0.794366 max acc epoch : 10 test accuracy : 0.773213
Counter({0: 4708, 1: 3253, 2: 2701})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  56.7452033162117 Time :  7634
accuracy train: 0.890591 val: 0.787324 test: 0.776308
max validation accuracy : 0.794366 max acc epoch : 10 test accuracy : 0.773213
Counter({0: 4741, 1: 3239, 2: 2682})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.19878497719765 Time :  7745
accuracy train: 0.891685 val: 0.783099 test: 0.772369
max validation accuracy : 0.794366 max acc epoch : 10 test accuracy : 0.773213
Counter({2: 4765, 1: 3210, 0: 2687})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  57.53867845237255 Time :  7851
accuracy train: 0.897624 val: 0.790141 test: 0.776027
max validation accuracy : 0.794366 max acc epoch : 10 test accuracy : 0.773213
Counter({2: 4790, 0: 3159, 1: 2713})

Epoch :  16 loss training:  56.41548927128315 Time :  7952
accuracy train: 0.900594 val: 0.783099 test: 0.772932
max validation accuracy : 0.794366 max acc epoch : 10 test accuracy : 0.773213
Counter({0: 4787, 1: 3162, 2: 2713})

Epoch :  17 loss training:  55.235064804553986 Time :  8058
accuracy train: 0.902157 val: 0.792958 test: 0.781092
max validation accuracy : 0.794366 max acc epoch : 10 test accuracy : 0.773213
Counter({0: 4789, 1: 3179, 2: 2694})

Epoch :  18 loss training:  52.166948437690735 Time :  8177
accuracy train: 0.911691 val: 0.785915 test: 0.776871
max validation accuracy : 0.794366 max acc epoch : 10 test accuracy : 0.773213
Counter({1: 4792, 0: 3178, 2: 2692})

Epoch :  19 loss training:  51.10704517364502 Time :  8287
accuracy train: 0.919037 val: 0.788732 test: 0.778841
max validation accuracy : 0.794366 max acc epoch : 10 test accuracy : 0.773213
Counter({2: 4799, 0: 3148, 1: 2715})

Epoch :  20 loss training:  49.060597002506256 Time :  8392
accuracy train: 0.922632 val: 0.787324 test: 0.783624
max validation accuracy : 0.794366 max acc epoch : 10 test accuracy : 0.773213
Counter({0: 4786, 2: 3140, 1: 2736})

Epoch :  21 loss training:  48.53199549019337 Time :  8502
accuracy train: 0.929666 val: 0.795775 test: 0.779966
max validation accuracy : 0.795775 max acc epoch : 21 test accuracy : 0.779966
Counter({1: 4777, 2: 3157, 0: 2728})

Epoch :  22 loss training:  46.94552560150623 Time :  8609
accuracy train: 0.933417 val: 0.800000 test: 0.781936
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({2: 4755, 0: 3154, 1: 2753})

Epoch :  23 loss training:  45.973392337560654 Time :  8728
accuracy train: 0.939981 val: 0.797183 test: 0.779122
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({2: 4748, 0: 3174, 1: 2740})

Epoch :  24 loss training:  43.7218974083662 Time :  8855
accuracy train: 0.943889 val: 0.798592 test: 0.780248
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({2: 4775, 0: 3146, 1: 2741})

Epoch :  25 loss training:  42.16436506807804 Time :  8972
accuracy train: 0.947327 val: 0.795775 test: 0.780529
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({0: 4757, 1: 3150, 2: 2755})

Epoch :  26 loss training:  40.222011998295784 Time :  9091
accuracy train: 0.952173 val: 0.794366 test: 0.783624
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({2: 4742, 0: 3153, 1: 2767})

Epoch :  27 loss training:  38.5929222330451 Time :  9223
accuracy train: 0.957018 val: 0.790141 test: 0.779122
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({1: 4734, 0: 3146, 2: 2782})

Epoch :  28 loss training:  37.36598262935877 Time :  9348
accuracy train: 0.963895 val: 0.790141 test: 0.778559
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({2: 4732, 0: 3127, 1: 2803})

Epoch :  29 loss training:  35.73247271776199 Time :  9459
accuracy train: 0.965614 val: 0.798592 test: 0.776027
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({1: 4702, 2: 3170, 0: 2790})

Epoch :  30 loss training:  35.32213244587183 Time :  9566
accuracy train: 0.969834 val: 0.788732 test: 0.771244
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({1: 4701, 2: 3187, 0: 2774})

Epoch :  31 loss training:  33.31980961561203 Time :  9681
accuracy train: 0.973273 val: 0.792958 test: 0.771525
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({0: 4734, 1: 3144, 2: 2784})

Epoch :  32 loss training:  31.264645110815763 Time :  9797
accuracy train: 0.974680 val: 0.784507 test: 0.767867
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({0: 4730, 2: 3186, 1: 2746})

Epoch :  33 loss training:  30.015323154628277 Time :  9912
accuracy train: 0.977180 val: 0.792958 test: 0.774057
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({0: 4753, 1: 3157, 2: 2752})

Epoch :  34 loss training:  29.432280614972115 Time :  10021
accuracy train: 0.980932 val: 0.787324 test: 0.773776
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({2: 4700, 0: 3213, 1: 2749})

Epoch :  35 loss training:  29.067441307008266 Time :  10136
accuracy train: 0.981244 val: 0.788732 test: 0.774339
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({1: 4696, 2: 3208, 0: 2758})

Epoch :  36 loss training:  28.109239410609007 Time :  10256
accuracy train: 0.984995 val: 0.776056 test: 0.770962
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({2: 4694, 0: 3217, 1: 2751})

Epoch :  37 loss training:  26.272882152348757 Time :  10366
accuracy train: 0.986871 val: 0.783099 test: 0.775746
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({2: 4673, 0: 3229, 1: 2760})

Epoch :  38 loss training:  25.24826366454363 Time :  10478
accuracy train: 0.989059 val: 0.788732 test: 0.768430
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({1: 4690, 0: 3228, 2: 2744})

Epoch :  39 loss training:  23.948415584862232 Time :  10589
accuracy train: 0.990622 val: 0.781690 test: 0.768430
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({1: 4657, 0: 3258, 2: 2747})

Epoch :  40 loss training:  22.60131860524416 Time :  10696
accuracy train: 0.991560 val: 0.785915 test: 0.769555
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({0: 4674, 2: 3236, 1: 2752})

Epoch :  41 loss training:  22.72426150739193 Time :  10813
accuracy train: 0.992185 val: 0.784507 test: 0.770118
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({2: 4682, 0: 3230, 1: 2750})

Epoch :  42 loss training:  21.144371900707483 Time :  10926
accuracy train: 0.992810 val: 0.784507 test: 0.768711
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({2: 4626, 1: 3302, 0: 2734})

Epoch :  43 loss training:  20.43124216236174 Time :  11032
accuracy train: 0.992967 val: 0.777465 test: 0.766460
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({2: 4626, 0: 3253, 1: 2783})

Epoch :  44 loss training:  20.274048388004303 Time :  11137
accuracy train: 0.995311 val: 0.778873 test: 0.770118
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({2: 4643, 0: 3232, 1: 2787})

Epoch :  45 loss training:  18.589751332998276 Time :  11246
accuracy train: 0.994842 val: 0.787324 test: 0.767867
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({1: 4635, 0: 3241, 2: 2786})

Epoch :  46 loss training:  18.005209617316723 Time :  11357
accuracy train: 0.995936 val: 0.780282 test: 0.771244
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({2: 4634, 0: 3252, 1: 2776})

Epoch :  47 loss training:  17.275267239660025 Time :  11463
accuracy train: 0.996718 val: 0.773239 test: 0.768993
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({1: 4601, 0: 3281, 2: 2780})

Epoch :  48 loss training:  17.044079277664423 Time :  11578
accuracy train: 0.997812 val: 0.776056 test: 0.768711
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({0: 4615, 1: 3265, 2: 2782})

Epoch :  49 loss training:  15.580021437257528 Time :  11691
accuracy train: 0.997499 val: 0.776056 test: 0.770962
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({2: 4539, 0: 3341, 1: 2782})

Epoch :  50 loss training:  15.787698464468122 Time :  11823
accuracy train: 0.997343 val: 0.780282 test: 0.766460
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({1: 4534, 0: 3327, 2: 2801})

Epoch :  51 loss training:  14.515971744433045 Time :  11956
accuracy train: 0.998750 val: 0.778873 test: 0.773213
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({2: 4498, 0: 3373, 1: 2791})

Epoch :  52 loss training:  13.895944465883076 Time :  12076
accuracy train: 0.998281 val: 0.776056 test: 0.770400
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({2: 4490, 0: 3415, 1: 2757})

Epoch :  53 loss training:  14.115946077741683 Time :  12193
accuracy train: 0.998906 val: 0.777465 test: 0.765053
max validation accuracy : 0.800000 max acc epoch : 22 test accuracy : 0.781936
Counter({2: 4528, 0: 3386, 1: 2748})

========================================================================================================================================================================================================
max acc epoch :  22
max validation accuracy :  0.8
test accuracy :  0.7819358469330332
last test_accuracy :  0.765053460889139
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=835, weight_decay=1e-06)
device :  cuda:0
Counter({1: 5076, 2: 3423, 0: 2163})

Epoch :  1 loss training:  92.04157835245132 Time :  12440
accuracy train: 0.774461 val: 0.759155 test: 0.763928
max validation accuracy : 0.759155 max acc epoch : 1 test accuracy : 0.763928
Counter({1: 3750, 2: 3580, 0: 3332})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.80173644423485 Time :  12569
accuracy train: 0.778212 val: 0.736620 test: 0.763928
max validation accuracy : 0.759155 max acc epoch : 1 test accuracy : 0.763928
Counter({2: 3889, 1: 3438, 0: 3335})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.84176725149155 Time :  12679
accuracy train: 0.811660 val: 0.763380 test: 0.777997
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.777997
Counter({2: 3885, 1: 3595, 0: 3182})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.23645135760307 Time :  12824
accuracy train: 0.825570 val: 0.769014 test: 0.772651
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.772651
Counter({2: 4081, 0: 3424, 1: 3157})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.98492529988289 Time :  12970
accuracy train: 0.833698 val: 0.764789 test: 0.776308
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.772651
Counter({2: 4543, 1: 3329, 0: 2790})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  69.84339892864227 Time :  13102
accuracy train: 0.839481 val: 0.784507 test: 0.780529
max validation accuracy : 0.784507 max acc epoch : 6 test accuracy : 0.780529
Counter({2: 4393, 0: 3534, 1: 2735})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.63475178182125 Time :  13215
accuracy train: 0.854173 val: 0.781690 test: 0.780248
max validation accuracy : 0.784507 max acc epoch : 6 test accuracy : 0.780529
Counter({0: 4466, 2: 3474, 1: 2722})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.4999134093523 Time :  13348
accuracy train: 0.867146 val: 0.770423 test: 0.772932
max validation accuracy : 0.784507 max acc epoch : 6 test accuracy : 0.780529
Counter({0: 4573, 1: 3267, 2: 2822})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.393029913306236 Time :  13467
accuracy train: 0.870585 val: 0.773239 test: 0.773495
max validation accuracy : 0.784507 max acc epoch : 6 test accuracy : 0.780529
Counter({1: 4650, 2: 3253, 0: 2759})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.94615113735199 Time :  13583
accuracy train: 0.876837 val: 0.773239 test: 0.770118
max validation accuracy : 0.784507 max acc epoch : 6 test accuracy : 0.780529
Counter({2: 4700, 1: 3190, 0: 2772})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.99160389602184 Time :  13695
accuracy train: 0.882307 val: 0.773239 test: 0.773213
max validation accuracy : 0.784507 max acc epoch : 6 test accuracy : 0.780529
Counter({2: 4702, 1: 3175, 0: 2785})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.008037745952606 Time :  13800
accuracy train: 0.886840 val: 0.777465 test: 0.769837
max validation accuracy : 0.784507 max acc epoch : 6 test accuracy : 0.780529
Counter({2: 4749, 0: 3121, 1: 2792})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  56.53787590563297 Time :  13918
accuracy train: 0.893873 val: 0.773239 test: 0.768711
max validation accuracy : 0.784507 max acc epoch : 6 test accuracy : 0.780529
Counter({2: 4769, 0: 3083, 1: 2810})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.59404845535755 Time :  14038
accuracy train: 0.897781 val: 0.764789 test: 0.769555
max validation accuracy : 0.784507 max acc epoch : 6 test accuracy : 0.780529
Counter({2: 4796, 1: 3065, 0: 2801})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  57.02156646549702 Time :  14147
accuracy train: 0.897781 val: 0.766197 test: 0.776308
max validation accuracy : 0.784507 max acc epoch : 6 test accuracy : 0.780529
Counter({2: 4808, 1: 3067, 0: 2787})

Epoch :  16 loss training:  56.268879160284996 Time :  14263
accuracy train: 0.904970 val: 0.773239 test: 0.771806
max validation accuracy : 0.784507 max acc epoch : 6 test accuracy : 0.780529
Counter({2: 4842, 1: 3030, 0: 2790})

Epoch :  17 loss training:  55.37416513264179 Time :  14377
accuracy train: 0.909347 val: 0.771831 test: 0.771525
max validation accuracy : 0.784507 max acc epoch : 6 test accuracy : 0.780529
Counter({1: 4849, 0: 3017, 2: 2796})

Epoch :  18 loss training:  52.39971624314785 Time :  14483
accuracy train: 0.917631 val: 0.771831 test: 0.770681
max validation accuracy : 0.784507 max acc epoch : 6 test accuracy : 0.780529
Counter({1: 4870, 2: 2988, 0: 2804})

Epoch :  19 loss training:  51.6488189548254 Time :  14596
accuracy train: 0.921694 val: 0.774648 test: 0.770962
max validation accuracy : 0.784507 max acc epoch : 6 test accuracy : 0.780529
Counter({2: 4871, 1: 2982, 0: 2809})

Epoch :  20 loss training:  49.132576033473015 Time :  14715
accuracy train: 0.924977 val: 0.776056 test: 0.779685
max validation accuracy : 0.784507 max acc epoch : 6 test accuracy : 0.780529
Counter({1: 4844, 2: 2998, 0: 2820})

Epoch :  21 loss training:  48.571978859603405 Time :  14820
accuracy train: 0.931697 val: 0.774648 test: 0.773495
max validation accuracy : 0.784507 max acc epoch : 6 test accuracy : 0.780529
Counter({2: 4872, 1: 2966, 0: 2824})

Epoch :  22 loss training:  47.6704735904932 Time :  14941
accuracy train: 0.937012 val: 0.778873 test: 0.775183
max validation accuracy : 0.784507 max acc epoch : 6 test accuracy : 0.780529
Counter({2: 4881, 1: 2952, 0: 2829})

Epoch :  23 loss training:  46.05569490790367 Time :  15055
accuracy train: 0.940138 val: 0.787324 test: 0.768711
max validation accuracy : 0.787324 max acc epoch : 23 test accuracy : 0.768711
Counter({2: 4920, 1: 2951, 0: 2791})

Epoch :  24 loss training:  43.34049315750599 Time :  15166
accuracy train: 0.946546 val: 0.788732 test: 0.772932
max validation accuracy : 0.788732 max acc epoch : 24 test accuracy : 0.772932
Counter({1: 4908, 2: 2946, 0: 2808})

Epoch :  25 loss training:  41.82378688454628 Time :  15270
accuracy train: 0.947952 val: 0.773239 test: 0.769555
max validation accuracy : 0.788732 max acc epoch : 24 test accuracy : 0.772932
Counter({2: 4928, 1: 2913, 0: 2821})

Epoch :  26 loss training:  40.78612181544304 Time :  15376
accuracy train: 0.954204 val: 0.784507 test: 0.770681
max validation accuracy : 0.788732 max acc epoch : 24 test accuracy : 0.772932
Counter({1: 4931, 0: 2923, 2: 2808})

Epoch :  27 loss training:  39.157877787947655 Time :  15495
accuracy train: 0.959050 val: 0.788732 test: 0.770681
max validation accuracy : 0.788732 max acc epoch : 24 test accuracy : 0.772932
Counter({1: 4936, 0: 2924, 2: 2802})

Epoch :  28 loss training:  38.0185537263751 Time :  15611
accuracy train: 0.964051 val: 0.787324 test: 0.771244
max validation accuracy : 0.788732 max acc epoch : 24 test accuracy : 0.772932
Counter({2: 4949, 0: 2903, 1: 2810})

Epoch :  29 loss training:  36.090994134545326 Time :  15716
accuracy train: 0.966239 val: 0.783099 test: 0.772651
max validation accuracy : 0.788732 max acc epoch : 24 test accuracy : 0.772932
Counter({1: 4967, 2: 2911, 0: 2784})

Epoch :  30 loss training:  35.82503444701433 Time :  15832
accuracy train: 0.971397 val: 0.777465 test: 0.765335
max validation accuracy : 0.788732 max acc epoch : 24 test accuracy : 0.772932
Counter({2: 4921, 0: 2913, 1: 2828})

Epoch :  31 loss training:  33.67493475973606 Time :  15965
accuracy train: 0.972491 val: 0.781690 test: 0.762802
max validation accuracy : 0.788732 max acc epoch : 24 test accuracy : 0.772932
Counter({1: 4940, 2: 2903, 0: 2819})

Epoch :  32 loss training:  32.01100555807352 Time :  16074
accuracy train: 0.978743 val: 0.784507 test: 0.762240
max validation accuracy : 0.788732 max acc epoch : 24 test accuracy : 0.772932
Counter({2: 4940, 1: 2880, 0: 2842})

Epoch :  33 loss training:  30.32872336357832 Time :  16176
accuracy train: 0.980619 val: 0.781690 test: 0.765616
max validation accuracy : 0.788732 max acc epoch : 24 test accuracy : 0.772932
Counter({1: 4940, 2: 2878, 0: 2844})

Epoch :  34 loss training:  30.3452858813107 Time :  16280
accuracy train: 0.982338 val: 0.783099 test: 0.767304
max validation accuracy : 0.788732 max acc epoch : 24 test accuracy : 0.772932
Counter({2: 4923, 0: 2875, 1: 2864})

Epoch :  35 loss training:  29.59380444139242 Time :  16391
accuracy train: 0.984839 val: 0.790141 test: 0.768711
max validation accuracy : 0.790141 max acc epoch : 35 test accuracy : 0.768711
Counter({2: 4884, 0: 2913, 1: 2865})

Epoch :  36 loss training:  27.948407974094152 Time :  16507
accuracy train: 0.987027 val: 0.794366 test: 0.761677
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({2: 4885, 1: 2917, 0: 2860})

Epoch :  37 loss training:  25.58071941882372 Time :  16611
accuracy train: 0.987809 val: 0.792958 test: 0.765053
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({2: 4875, 0: 2933, 1: 2854})

Epoch :  38 loss training:  24.809414334595203 Time :  16719
accuracy train: 0.991091 val: 0.792958 test: 0.758019
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({1: 4882, 0: 2925, 2: 2855})

Epoch :  39 loss training:  24.073644045740366 Time :  16823
accuracy train: 0.991404 val: 0.788732 test: 0.763365
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({1: 4884, 2: 2920, 0: 2858})

Epoch :  40 loss training:  23.429591063410044 Time :  16929
accuracy train: 0.993279 val: 0.784507 test: 0.765335
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({2: 4889, 1: 2910, 0: 2863})

Epoch :  41 loss training:  23.062125992029905 Time :  17042
accuracy train: 0.993279 val: 0.787324 test: 0.765616
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({0: 4877, 1: 2914, 2: 2871})

Epoch :  42 loss training:  21.573305001482368 Time :  17148
accuracy train: 0.994686 val: 0.781690 test: 0.763647
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({2: 4884, 0: 2923, 1: 2855})

Epoch :  43 loss training:  20.539336955174804 Time :  17253
accuracy train: 0.994998 val: 0.781690 test: 0.765616
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({2: 4846, 0: 2944, 1: 2872})

Epoch :  44 loss training:  20.10767513886094 Time :  17367
accuracy train: 0.995311 val: 0.777465 test: 0.765335
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({2: 4861, 0: 2927, 1: 2874})

Epoch :  45 loss training:  18.677227925509214 Time :  17489
accuracy train: 0.996718 val: 0.783099 test: 0.758863
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({2: 4873, 1: 2915, 0: 2874})

Epoch :  46 loss training:  18.505433671176434 Time :  17607
accuracy train: 0.996249 val: 0.785915 test: 0.761114
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({2: 4855, 1: 2933, 0: 2874})

Epoch :  47 loss training:  18.11019584722817 Time :  17717
accuracy train: 0.997656 val: 0.790141 test: 0.759707
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({2: 4872, 0: 2919, 1: 2871})

Epoch :  48 loss training:  17.67370000295341 Time :  17837
accuracy train: 0.997187 val: 0.784507 test: 0.763928
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({2: 4866, 1: 2927, 0: 2869})

Epoch :  49 loss training:  15.041126120835543 Time :  17958
accuracy train: 0.996874 val: 0.781690 test: 0.764209
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({2: 4822, 0: 2938, 1: 2902})

Epoch :  50 loss training:  16.096370235085487 Time :  18073
accuracy train: 0.997968 val: 0.785915 test: 0.762240
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({2: 4821, 1: 2931, 0: 2910})

Epoch :  51 loss training:  15.309719858691096 Time :  18178
accuracy train: 0.998281 val: 0.781690 test: 0.763928
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({1: 4806, 0: 2958, 2: 2898})

Epoch :  52 loss training:  14.2667355844751 Time :  18284
accuracy train: 0.998437 val: 0.781690 test: 0.761677
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({2: 4795, 0: 2962, 1: 2905})

Epoch :  53 loss training:  14.16336460551247 Time :  18393
accuracy train: 0.998750 val: 0.777465 test: 0.760270
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({1: 4815, 2: 2957, 0: 2890})

Epoch :  54 loss training:  13.012713054195046 Time :  18512
accuracy train: 0.998750 val: 0.785915 test: 0.764491
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({2: 4797, 1: 2966, 0: 2899})

Epoch :  55 loss training:  12.025137364398688 Time :  18630
accuracy train: 0.999062 val: 0.777465 test: 0.761396
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({2: 4824, 0: 2941, 1: 2897})

Epoch :  56 loss training:  11.94700831733644 Time :  18746
accuracy train: 0.999219 val: 0.784507 test: 0.764491
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({2: 4773, 0: 2989, 1: 2900})

Epoch :  57 loss training:  12.586667352356017 Time :  18856
accuracy train: 0.999531 val: 0.783099 test: 0.758582
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({1: 4763, 2: 2998, 0: 2901})

Epoch :  58 loss training:  11.447840191423893 Time :  18976
accuracy train: 0.999375 val: 0.785915 test: 0.765898
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({2: 4758, 0: 3004, 1: 2900})

Epoch :  59 loss training:  10.620743351988494 Time :  19095
accuracy train: 0.999687 val: 0.773239 test: 0.763928
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({2: 4733, 1: 3036, 0: 2893})

Epoch :  60 loss training:  10.48092517722398 Time :  19202
accuracy train: 0.999531 val: 0.778873 test: 0.763365
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({2: 4735, 0: 3019, 1: 2908})

Epoch :  61 loss training:  10.707541367970407 Time :  19299
accuracy train: 0.999531 val: 0.783099 test: 0.762802
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({2: 4762, 0: 3008, 1: 2892})

Epoch :  62 loss training:  9.575672685168684 Time :  19407
accuracy train: 0.999687 val: 0.770423 test: 0.763365
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({2: 4753, 0: 3000, 1: 2909})

Epoch :  63 loss training:  9.404129615984857 Time :  19517
accuracy train: 0.999844 val: 0.781690 test: 0.763928
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({0: 4730, 1: 3008, 2: 2924})

Epoch :  64 loss training:  9.424996922258288 Time :  19636
accuracy train: 0.999844 val: 0.769014 test: 0.756894
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({1: 4709, 0: 3021, 2: 2932})

Epoch :  65 loss training:  9.391834832727909 Time :  19747
accuracy train: 1.000000 val: 0.773239 test: 0.766460
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({1: 4700, 0: 3045, 2: 2917})

Epoch :  66 loss training:  7.993450557347387 Time :  19861
accuracy train: 1.000000 val: 0.776056 test: 0.761114
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({2: 4678, 0: 3032, 1: 2952})

Epoch :  67 loss training:  7.686440039426088 Time :  19971
accuracy train: 1.000000 val: 0.785915 test: 0.761958
max validation accuracy : 0.794366 max acc epoch : 36 test accuracy : 0.761677
Counter({2: 4662, 0: 3033, 1: 2967})

========================================================================================================================================================================================================
max acc epoch :  36
max validation accuracy :  0.7943661971830986
test accuracy :  0.7616769836803602
last test_accuracy :  0.7619583567810917
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=835, weight_decay=1e-06)
device :  cuda:0
Counter({1: 5076, 2: 3423, 0: 2163})

Epoch :  1 loss training:  92.09369349479675 Time :  20217
accuracy train: 0.776649 val: 0.757746 test: 0.767586
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.767586
Counter({0: 3895, 1: 3545, 2: 3222})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.05505853891373 Time :  20382
accuracy train: 0.784776 val: 0.735211 test: 0.763365
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.767586
Counter({2: 4074, 1: 3369, 0: 3219})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.99392187595367 Time :  20518
accuracy train: 0.805408 val: 0.752113 test: 0.777153
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.767586
Counter({1: 4281, 2: 3523, 0: 2858})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.42447918653488 Time :  20665
accuracy train: 0.817443 val: 0.780282 test: 0.772088
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.772088
Counter({2: 4350, 1: 3232, 0: 3080})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.88243044912815 Time :  20793
accuracy train: 0.834636 val: 0.763380 test: 0.772932
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.772088
Counter({1: 4750, 2: 3104, 0: 2808})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  69.74875999987125 Time :  20905
accuracy train: 0.843857 val: 0.774648 test: 0.777997
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.772088
Counter({1: 4740, 2: 3155, 0: 2767})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.01284243166447 Time :  21016
accuracy train: 0.861050 val: 0.777465 test: 0.771244
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.772088
Counter({1: 4426, 0: 3138, 2: 3098})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.88833194971085 Time :  21151
accuracy train: 0.870897 val: 0.767606 test: 0.774057
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.772088
Counter({1: 4597, 0: 3128, 2: 2937})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.12490074336529 Time :  21288
accuracy train: 0.876368 val: 0.781690 test: 0.774620
max validation accuracy : 0.781690 max acc epoch : 9 test accuracy : 0.774620
Counter({1: 4542, 0: 3083, 2: 3037})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.5439183562994 Time :  21394
accuracy train: 0.884651 val: 0.785915 test: 0.765335
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.765335
Counter({1: 4486, 2: 3108, 0: 3068})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.57609924674034 Time :  21509
accuracy train: 0.887152 val: 0.773239 test: 0.765053
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.765335
Counter({2: 4467, 0: 3114, 1: 3081})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.06180290877819 Time :  21629
accuracy train: 0.894186 val: 0.771831 test: 0.766742
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.765335
Counter({2: 4521, 1: 3079, 0: 3062})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  55.69572786986828 Time :  21754
accuracy train: 0.897468 val: 0.778873 test: 0.765898
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.765335
Counter({1: 4516, 0: 3086, 2: 3060})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.59995441138744 Time :  21850
accuracy train: 0.902313 val: 0.769014 test: 0.767304
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.765335
Counter({2: 4545, 0: 3076, 1: 3041})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.11062008142471 Time :  21956
accuracy train: 0.902938 val: 0.776056 test: 0.769837
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.765335
Counter({2: 4519, 0: 3085, 1: 3058})

Epoch :  16 loss training:  55.096232041716576 Time :  22075
accuracy train: 0.908721 val: 0.770423 test: 0.767867
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.765335
Counter({2: 4536, 1: 3077, 0: 3049})

Epoch :  17 loss training:  54.310674488544464 Time :  22182
accuracy train: 0.910441 val: 0.774648 test: 0.769555
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.765335
Counter({2: 4523, 0: 3099, 1: 3040})

Epoch :  18 loss training:  51.474597722291946 Time :  22287
accuracy train: 0.919975 val: 0.773239 test: 0.768430
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.765335
Counter({1: 4512, 0: 3137, 2: 3013})

Epoch :  19 loss training:  50.715768203139305 Time :  22392
accuracy train: 0.927321 val: 0.777465 test: 0.764772
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.765335
Counter({2: 4499, 0: 3128, 1: 3035})

Epoch :  20 loss training:  47.676134049892426 Time :  22486
accuracy train: 0.928728 val: 0.778873 test: 0.772088
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.765335
Counter({0: 4498, 2: 3148, 1: 3016})

Epoch :  21 loss training:  46.89367651939392 Time :  22594
accuracy train: 0.936230 val: 0.777465 test: 0.769555
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.765335
Counter({1: 4508, 0: 3160, 2: 2994})

Epoch :  22 loss training:  45.45151525735855 Time :  22710
accuracy train: 0.940450 val: 0.783099 test: 0.772088
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.765335
Counter({2: 4483, 0: 3204, 1: 2975})

Epoch :  23 loss training:  45.02879397571087 Time :  22815
accuracy train: 0.946233 val: 0.777465 test: 0.764491
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.765335
Counter({1: 4486, 0: 3192, 2: 2984})

Epoch :  24 loss training:  42.53592203557491 Time :  22916
accuracy train: 0.951235 val: 0.780282 test: 0.768430
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.765335
Counter({2: 4462, 1: 3217, 0: 2983})

Epoch :  25 loss training:  41.252384424209595 Time :  23032
accuracy train: 0.955299 val: 0.781690 test: 0.771806
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.765335
Counter({1: 4460, 2: 3228, 0: 2974})

Epoch :  26 loss training:  39.54644417762756 Time :  23157
accuracy train: 0.959675 val: 0.787324 test: 0.769555
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({1: 4471, 2: 3225, 0: 2966})

Epoch :  27 loss training:  38.64777820557356 Time :  23273
accuracy train: 0.962645 val: 0.776056 test: 0.766742
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({1: 4431, 0: 3257, 2: 2974})

Epoch :  28 loss training:  36.10646340996027 Time :  23404
accuracy train: 0.965302 val: 0.785915 test: 0.769555
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({2: 4440, 1: 3264, 0: 2958})

Epoch :  29 loss training:  35.38306652754545 Time :  23526
accuracy train: 0.967646 val: 0.777465 test: 0.766742
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({2: 4441, 0: 3273, 1: 2948})

Epoch :  30 loss training:  35.46538633853197 Time :  23652
accuracy train: 0.972804 val: 0.781690 test: 0.765616
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({1: 4442, 0: 3293, 2: 2927})

Epoch :  31 loss training:  33.06210768222809 Time :  23763
accuracy train: 0.975930 val: 0.777465 test: 0.764491
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({2: 4432, 0: 3311, 1: 2919})

Epoch :  32 loss training:  31.417904265224934 Time :  23878
accuracy train: 0.977806 val: 0.776056 test: 0.765616
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({2: 4431, 1: 3312, 0: 2919})

Epoch :  33 loss training:  29.303049203008413 Time :  23975
accuracy train: 0.980306 val: 0.777465 test: 0.768149
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({1: 4422, 0: 3317, 2: 2923})

Epoch :  34 loss training:  29.295559722930193 Time :  24085
accuracy train: 0.983589 val: 0.771831 test: 0.765616
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({2: 4377, 0: 3365, 1: 2920})

Epoch :  35 loss training:  29.45938179641962 Time :  24202
accuracy train: 0.984995 val: 0.778873 test: 0.765053
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({2: 4331, 0: 3417, 1: 2914})

Epoch :  36 loss training:  27.453880444169044 Time :  24315
accuracy train: 0.987340 val: 0.773239 test: 0.766460
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({1: 4311, 0: 3446, 2: 2905})

Epoch :  37 loss training:  25.262610603123903 Time :  24423
accuracy train: 0.988746 val: 0.770423 test: 0.767304
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({0: 4284, 2: 3471, 1: 2907})

Epoch :  38 loss training:  24.167436081916094 Time :  24541
accuracy train: 0.989059 val: 0.771831 test: 0.760551
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({1: 4298, 2: 3469, 0: 2895})

Epoch :  39 loss training:  22.824762104079127 Time :  24656
accuracy train: 0.990153 val: 0.773239 test: 0.762802
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({2: 4287, 0: 3487, 1: 2888})

Epoch :  40 loss training:  23.603754833340645 Time :  24775
accuracy train: 0.992498 val: 0.770423 test: 0.763084
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({2: 4280, 1: 3489, 0: 2893})

Epoch :  41 loss training:  21.86556472070515 Time :  24880
accuracy train: 0.993123 val: 0.773239 test: 0.760551
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({1: 4261, 0: 3513, 2: 2888})

Epoch :  42 loss training:  21.139969903975725 Time :  24992
accuracy train: 0.994530 val: 0.771831 test: 0.756894
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({0: 4248, 2: 3525, 1: 2889})

Epoch :  43 loss training:  20.91235893778503 Time :  25117
accuracy train: 0.995624 val: 0.773239 test: 0.757738
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({2: 4242, 1: 3540, 0: 2880})

Epoch :  44 loss training:  19.8255476038903 Time :  25222
accuracy train: 0.995780 val: 0.776056 test: 0.759145
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({1: 4255, 0: 3542, 2: 2865})

Epoch :  45 loss training:  18.90876852720976 Time :  25332
accuracy train: 0.996405 val: 0.760563 test: 0.757456
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({1: 4233, 2: 3523, 0: 2906})

Epoch :  46 loss training:  18.38857825472951 Time :  25447
accuracy train: 0.996874 val: 0.778873 test: 0.758582
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({2: 4197, 1: 3574, 0: 2891})

Epoch :  47 loss training:  16.884863454848528 Time :  25552
accuracy train: 0.997343 val: 0.770423 test: 0.756050
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({2: 4215, 1: 3552, 0: 2895})

Epoch :  48 loss training:  17.07625773176551 Time :  25678
accuracy train: 0.997812 val: 0.770423 test: 0.760551
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({1: 4203, 0: 3564, 2: 2895})

Epoch :  49 loss training:  14.976526694372296 Time :  25786
accuracy train: 0.998124 val: 0.770423 test: 0.762802
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({2: 4140, 1: 3641, 0: 2881})

Epoch :  50 loss training:  14.988349817693233 Time :  25892
accuracy train: 0.997812 val: 0.770423 test: 0.758301
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({1: 4131, 0: 3621, 2: 2910})

Epoch :  51 loss training:  14.371947477571666 Time :  26003
accuracy train: 0.998906 val: 0.781690 test: 0.765335
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({1: 4094, 0: 3662, 2: 2906})

Epoch :  52 loss training:  13.795716925524175 Time :  26118
accuracy train: 0.998750 val: 0.764789 test: 0.763928
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({2: 4108, 0: 3659, 1: 2895})

Epoch :  53 loss training:  14.37762188212946 Time :  26232
accuracy train: 0.999062 val: 0.766197 test: 0.758019
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({2: 4137, 1: 3642, 0: 2883})

Epoch :  54 loss training:  13.228323592804372 Time :  26351
accuracy train: 0.998906 val: 0.770423 test: 0.759707
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({1: 4127, 0: 3655, 2: 2880})

Epoch :  55 loss training:  11.904972922056913 Time :  26463
accuracy train: 0.998437 val: 0.777465 test: 0.756331
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({1: 4126, 0: 3666, 2: 2870})

Epoch :  56 loss training:  12.829210926778615 Time :  26568
accuracy train: 0.999531 val: 0.781690 test: 0.762521
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({2: 4107, 0: 3678, 1: 2877})

Epoch :  57 loss training:  12.11042489297688 Time :  26679
accuracy train: 0.999062 val: 0.776056 test: 0.756331
max validation accuracy : 0.787324 max acc epoch : 26 test accuracy : 0.769555
Counter({2: 4071, 1: 3689, 0: 2902})

========================================================================================================================================================================================================
max acc epoch :  26
max validation accuracy :  0.7873239436619718
test accuracy :  0.7695554305008441
last test_accuracy :  0.7563308947664603
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.79014 	 test_accuracy : 0.77265 	 max_acc epoch :  28 	 last test_accuracy : 0.76646
k :  1 	 val_accuracy : 0.80000 	 test_accuracy : 0.78194 	 max_acc epoch :  22 	 last test_accuracy : 0.76505
k :  2 	 val_accuracy : 0.79437 	 test_accuracy : 0.76168 	 max_acc epoch :  36 	 last test_accuracy : 0.76196
k :  3 	 val_accuracy : 0.78732 	 test_accuracy : 0.76956 	 max_acc epoch :  26 	 last test_accuracy : 0.75633

avg :  	 val_accuracy : 0.79296 	 test_accuracy : 0.77145 	 last_accuracy : 0.76245
