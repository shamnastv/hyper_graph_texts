

date and time :  Fri May  7 19:57:59 2021
Namespace(batch_size=32, dataset='ohsumed', device=0, dropout=0.5, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  492.2987563610077 Time :  29
accuracy train: 0.609530 val: 0.594030 test: 0.573089
max validation accuracy : 0.594030 max acc epoch : 1 test accuracy : 0.573089
Epoch-1 lr: 0.001

Epoch :  2 loss training:  321.83463859558105 Time :  64
accuracy train: 0.681999 val: 0.656716 test: 0.647539
max validation accuracy : 0.656716 max acc epoch : 2 test accuracy : 0.647539
Epoch-2 lr: 0.001

Epoch :  3 loss training:  296.512699007988 Time :  96
accuracy train: 0.679021 val: 0.629851 test: 0.634677
max validation accuracy : 0.656716 max acc epoch : 2 test accuracy : 0.647539
Epoch-3 lr: 0.001

Epoch :  4 loss training:  277.04816448688507 Time :  127
accuracy train: 0.714758 val: 0.641791 test: 0.637398
max validation accuracy : 0.656716 max acc epoch : 2 test accuracy : 0.647539
Epoch-4 lr: 0.001

Epoch :  5 loss training:  268.792697429657 Time :  159
accuracy train: 0.738915 val: 0.677612 test: 0.661637
max validation accuracy : 0.677612 max acc epoch : 5 test accuracy : 0.661637
Epoch-5 lr: 0.001

Epoch :  6 loss training:  245.9555742740631 Time :  189
accuracy train: 0.777962 val: 0.698507 test: 0.682661
max validation accuracy : 0.698507 max acc epoch : 6 test accuracy : 0.682661
Counter({11: 1275, 1: 1084, 5: 723, 9: 672, 3: 626, 4: 461, 6: 456, 8: 456, 2: 440, 7: 419, 10: 402, 0: 386})
Epoch-6 lr: 0.001

Epoch :  7 loss training:  411.50206899642944 Time :  222
accuracy train: 0.732958 val: 0.656716 test: 0.662132
max validation accuracy : 0.698507 max acc epoch : 6 test accuracy : 0.682661
Epoch-7 lr: 0.001

Epoch :  8 loss training:  302.75172889232635 Time :  253
accuracy train: 0.751489 val: 0.698507 test: 0.663369
max validation accuracy : 0.698507 max acc epoch : 6 test accuracy : 0.682661
Counter({2: 1304, 6: 1090, 3: 948, 8: 531, 4: 519, 0: 511, 11: 490, 10: 458, 5: 449, 9: 399, 7: 372, 1: 329})
Epoch-8 lr: 0.001

Epoch :  9 loss training:  273.5006603002548 Time :  286
accuracy train: 0.758769 val: 0.716418 test: 0.676478
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.676478
Epoch-9 lr: 0.001

Epoch :  10 loss training:  243.21774816513062 Time :  319
accuracy train: 0.774653 val: 0.695522 test: 0.688350
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.676478
Counter({4: 1340, 3: 1047, 6: 808, 8: 772, 7: 569, 1: 482, 10: 468, 11: 463, 2: 408, 5: 387, 0: 337, 9: 319})
Epoch-10 lr: 0.0005

Epoch :  11 loss training:  214.10054004192352 Time :  355
accuracy train: 0.776969 val: 0.716418 test: 0.686372
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.676478
Epoch-11 lr: 0.0005

Epoch :  12 loss training:  200.47631740570068 Time :  389
accuracy train: 0.787889 val: 0.728358 test: 0.696760
max validation accuracy : 0.728358 max acc epoch : 12 test accuracy : 0.696760
Counter({2: 1368, 1: 1095, 11: 830, 7: 807, 6: 554, 10: 482, 4: 458, 3: 454, 9: 420, 5: 397, 0: 361, 8: 174})
Epoch-12 lr: 0.0005

Epoch :  13 loss training:  211.07724559307098 Time :  426
accuracy train: 0.786234 val: 0.737313 test: 0.692555
max validation accuracy : 0.737313 max acc epoch : 13 test accuracy : 0.692555
Epoch-13 lr: 0.0005

Epoch :  14 loss training:  192.12021613121033 Time :  460
accuracy train: 0.791198 val: 0.704478 test: 0.688845
max validation accuracy : 0.737313 max acc epoch : 13 test accuracy : 0.692555
Counter({5: 1346, 4: 1087, 9: 852, 11: 810, 6: 597, 1: 460, 2: 454, 0: 422, 8: 409, 3: 408, 7: 392, 10: 163})
Epoch-14 lr: 0.0005

Epoch :  15 loss training:  200.2812317609787 Time :  494
accuracy train: 0.789543 val: 0.704478 test: 0.675241
max validation accuracy : 0.737313 max acc epoch : 13 test accuracy : 0.692555

Epoch :  16 loss training:  193.3797558248043 Time :  528
accuracy train: 0.819987 val: 0.722388 test: 0.688598
max validation accuracy : 0.737313 max acc epoch : 13 test accuracy : 0.692555
Counter({7: 1391, 4: 1125, 5: 775, 8: 739, 6: 562, 1: 510, 3: 467, 0: 446, 9: 438, 2: 417, 11: 374, 10: 156})

Epoch :  17 loss training:  178.910309612751 Time :  563
accuracy train: 0.827598 val: 0.716418 test: 0.697749
max validation accuracy : 0.737313 max acc epoch : 13 test accuracy : 0.692555

Epoch :  18 loss training:  168.04088646173477 Time :  595
accuracy train: 0.824950 val: 0.707463 test: 0.688598
max validation accuracy : 0.737313 max acc epoch : 13 test accuracy : 0.692555
Counter({8: 1360, 3: 1080, 9: 916, 6: 676, 5: 572, 0: 485, 10: 470, 4: 430, 1: 428, 2: 428, 7: 403, 11: 152})

Epoch :  19 loss training:  166.89687645435333 Time :  627
accuracy train: 0.831899 val: 0.707463 test: 0.692802
max validation accuracy : 0.737313 max acc epoch : 13 test accuracy : 0.692555

Epoch :  20 loss training:  165.9829387664795 Time :  659
accuracy train: 0.828921 val: 0.719403 test: 0.703933
max validation accuracy : 0.737313 max acc epoch : 13 test accuracy : 0.692555
Counter({1: 1364, 0: 1094, 3: 807, 2: 797, 4: 630, 9: 457, 7: 453, 6: 426, 11: 412, 8: 402, 5: 392, 10: 166})

Epoch :  21 loss training:  165.23798272013664 Time :  694
accuracy train: 0.845797 val: 0.734328 test: 0.696265
max validation accuracy : 0.737313 max acc epoch : 13 test accuracy : 0.692555

Epoch :  22 loss training:  153.6967974305153 Time :  726
accuracy train: 0.847452 val: 0.710448 test: 0.693792
max validation accuracy : 0.737313 max acc epoch : 13 test accuracy : 0.692555
Counter({0: 1357, 2: 964, 5: 865, 10: 780, 4: 589, 8: 550, 11: 453, 3: 441, 6: 417, 7: 416, 1: 387, 9: 181})

Epoch :  23 loss training:  140.66589522361755 Time :  760
accuracy train: 0.874255 val: 0.746269 test: 0.702449
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449

Epoch :  24 loss training:  128.90179359912872 Time :  793
accuracy train: 0.876903 val: 0.740299 test: 0.702449
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449
Counter({2: 1344, 1: 1070, 5: 861, 3: 711, 0: 603, 10: 519, 8: 445, 4: 438, 9: 435, 6: 414, 11: 405, 7: 155})

Epoch :  25 loss training:  118.85811215639114 Time :  826
accuracy train: 0.898743 val: 0.722388 test: 0.702201
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449

Epoch :  26 loss training:  118.95132258534431 Time :  861
accuracy train: 0.915288 val: 0.719403 test: 0.703191
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449
Counter({6: 1324, 5: 1080, 8: 739, 9: 726, 4: 574, 3: 537, 0: 464, 2: 441, 11: 438, 1: 431, 7: 384, 10: 262})

Epoch :  27 loss training:  102.31703782081604 Time :  896
accuracy train: 0.926539 val: 0.698507 test: 0.697007
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449

Epoch :  28 loss training:  87.78866618871689 Time :  927
accuracy train: 0.940106 val: 0.713433 test: 0.699481
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449
Counter({11: 1313, 2: 1109, 4: 820, 7: 672, 0: 621, 1: 523, 8: 513, 5: 437, 10: 423, 9: 406, 6: 393, 3: 170})

Epoch :  29 loss training:  84.8264888226986 Time :  962
accuracy train: 0.949702 val: 0.716418 test: 0.697749
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449

Epoch :  30 loss training:  83.61367073655128 Time :  995
accuracy train: 0.947717 val: 0.716418 test: 0.702943
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449
Counter({1: 1305, 2: 1099, 6: 958, 11: 798, 4: 546, 3: 515, 8: 445, 5: 423, 9: 420, 10: 414, 7: 331, 0: 146})

Epoch :  31 loss training:  84.73457929491997 Time :  1030
accuracy train: 0.958306 val: 0.713433 test: 0.691071
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449

Epoch :  32 loss training:  67.2023908495903 Time :  1067
accuracy train: 0.961284 val: 0.707463 test: 0.690082
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449
Counter({1: 1344, 0: 1079, 2: 796, 5: 710, 11: 698, 3: 547, 4: 440, 7: 434, 8: 406, 9: 400, 10: 398, 6: 148})

Epoch :  33 loss training:  59.293901443481445 Time :  1103
accuracy train: 0.970218 val: 0.725373 test: 0.708138
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449

Epoch :  34 loss training:  53.62197678536177 Time :  1135
accuracy train: 0.978822 val: 0.731343 test: 0.705664
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449
Counter({6: 1290, 8: 1083, 5: 939, 1: 717, 0: 715, 10: 676, 4: 432, 11: 397, 3: 390, 7: 369, 2: 238, 9: 154})

Epoch :  35 loss training:  52.428761675953865 Time :  1169
accuracy train: 0.976506 val: 0.713433 test: 0.693544
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449

Epoch :  36 loss training:  49.54218988120556 Time :  1205
accuracy train: 0.976175 val: 0.740299 test: 0.705169
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449
Counter({0: 1316, 6: 1110, 7: 929, 3: 705, 11: 582, 5: 565, 10: 447, 4: 432, 9: 392, 1: 387, 2: 383, 8: 152})

Epoch :  37 loss training:  41.2598569765687 Time :  1242
accuracy train: 0.982462 val: 0.713433 test: 0.704180
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449

Epoch :  38 loss training:  37.95221230387688 Time :  1275
accuracy train: 0.987426 val: 0.704478 test: 0.693297
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449
Counter({11: 1241, 6: 1065, 2: 811, 0: 758, 9: 710, 4: 652, 5: 431, 1: 424, 3: 372, 7: 365, 8: 329, 10: 242})

Epoch :  39 loss training:  34.90828715637326 Time :  1310
accuracy train: 0.990735 val: 0.701493 test: 0.695770
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449

Epoch :  40 loss training:  30.821028612554073 Time :  1343
accuracy train: 0.987095 val: 0.698507 test: 0.698739
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449
Counter({2: 1299, 4: 1088, 10: 960, 7: 759, 11: 677, 6: 530, 3: 437, 8: 420, 5: 415, 0: 370, 1: 288, 9: 157})

Epoch :  41 loss training:  29.213233970105648 Time :  1377
accuracy train: 0.996029 val: 0.725373 test: 0.704427
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449

Epoch :  42 loss training:  25.059028724208474 Time :  1408
accuracy train: 0.989080 val: 0.680597 test: 0.701212
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449
Counter({3: 1302, 4: 1037, 1: 789, 2: 736, 11: 653, 10: 620, 6: 478, 0: 474, 9: 434, 5: 382, 8: 343, 7: 152})

Epoch :  43 loss training:  24.552037727087736 Time :  1441
accuracy train: 0.989742 val: 0.677612 test: 0.684640
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449

Epoch :  44 loss training:  20.004857359454036 Time :  1473
accuracy train: 0.995698 val: 0.713433 test: 0.698491
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449
Counter({11: 1238, 5: 1081, 0: 837, 1: 832, 4: 585, 7: 551, 10: 497, 8: 429, 3: 427, 2: 380, 9: 367, 6: 176})

Epoch :  45 loss training:  20.111857544630766 Time :  1507
accuracy train: 0.994375 val: 0.710448 test: 0.688103
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449

Epoch :  46 loss training:  25.933316241949797 Time :  1538
accuracy train: 0.995367 val: 0.668657 test: 0.689092
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449
Counter({1: 1258, 6: 1048, 7: 901, 9: 893, 0: 719, 10: 605, 5: 425, 4: 407, 11: 378, 3: 375, 2: 228, 8: 163})

Epoch :  47 loss training:  20.126086773350835 Time :  1574
accuracy train: 0.991396 val: 0.686567 test: 0.690082
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449

Epoch :  48 loss training:  17.871758922934532 Time :  1607
accuracy train: 0.997353 val: 0.695522 test: 0.688845
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449
Counter({4: 1235, 2: 1108, 0: 824, 3: 734, 6: 696, 5: 560, 11: 556, 1: 413, 8: 388, 9: 376, 7: 369, 10: 141})

Epoch :  49 loss training:  16.475674156099558 Time :  1642
accuracy train: 0.997684 val: 0.722388 test: 0.698491
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449

Epoch :  50 loss training:  13.304366048425436 Time :  1675
accuracy train: 0.997684 val: 0.722388 test: 0.702201
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449
Counter({8: 1210, 11: 1042, 7: 847, 6: 655, 4: 631, 10: 558, 1: 529, 5: 528, 2: 426, 9: 393, 0: 370, 3: 211})

Epoch :  51 loss training:  15.849002867937088 Time :  1709
accuracy train: 0.997022 val: 0.719403 test: 0.696760
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449

Epoch :  52 loss training:  14.639874693006277 Time :  1742
accuracy train: 0.998676 val: 0.725373 test: 0.701707
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449
Counter({3: 1291, 6: 1101, 7: 819, 5: 736, 0: 672, 1: 594, 9: 510, 4: 426, 10: 418, 2: 353, 11: 334, 8: 146})

Epoch :  53 loss training:  11.736549553461373 Time :  1775
accuracy train: 0.998676 val: 0.701493 test: 0.701707
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449

Epoch :  54 loss training:  10.871646774932742 Time :  1807
accuracy train: 0.998015 val: 0.701493 test: 0.685135
max validation accuracy : 0.746269 max acc epoch : 23 test accuracy : 0.702449
Counter({8: 1253, 6: 1066, 10: 896, 5: 765, 3: 648, 4: 565, 2: 544, 0: 434, 9: 423, 7: 358, 1: 303, 11: 145})

========================================================================================================================================================================================================
max acc epoch :  23
max validation accuracy :  0.746268656716418
test accuracy :  0.7024486767252041
last test_accuracy :  0.6851348008904279
========================================================================================================================================================================================================

