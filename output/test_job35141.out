

date and time :  Fri Jun  4 01:02:27 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=420, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  92.62249454855919 Time :  14
accuracy train: 0.781494 val: 0.750704 test: 0.759426
max validation accuracy : 0.750704 max acc epoch : 1 test accuracy : 0.759426
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.27788537740707 Time :  25
accuracy train: 0.785402 val: 0.745070 test: 0.754924
max validation accuracy : 0.750704 max acc epoch : 1 test accuracy : 0.759426
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.44147109985352 Time :  37
accuracy train: 0.797280 val: 0.760563 test: 0.755205
max validation accuracy : 0.760563 max acc epoch : 3 test accuracy : 0.755205
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.99237468838692 Time :  49
accuracy train: 0.823226 val: 0.776056 test: 0.777434
max validation accuracy : 0.776056 max acc epoch : 4 test accuracy : 0.777434
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.85285344719887 Time :  58
accuracy train: 0.830572 val: 0.795775 test: 0.778278
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.51600697636604 Time :  71
accuracy train: 0.836511 val: 0.780282 test: 0.777153
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.45243355631828 Time :  84
accuracy train: 0.842451 val: 0.766197 test: 0.773213
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.54359595477581 Time :  94
accuracy train: 0.851672 val: 0.776056 test: 0.769837
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.88986900448799 Time :  106
accuracy train: 0.865739 val: 0.767606 test: 0.769274
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.744223579764366 Time :  116
accuracy train: 0.873242 val: 0.778873 test: 0.775183
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  61.67221415042877 Time :  129
accuracy train: 0.875899 val: 0.773239 test: 0.773495
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  60.66051842272282 Time :  142
accuracy train: 0.880744 val: 0.777465 test: 0.772932
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  58.463699385523796 Time :  152
accuracy train: 0.885277 val: 0.766197 test: 0.766460
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  58.51993931829929 Time :  165
accuracy train: 0.887934 val: 0.770423 test: 0.768430
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  57.2869725972414 Time :  174
accuracy train: 0.890122 val: 0.776056 test: 0.769837
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278

Epoch :  16 loss training:  57.659761264920235 Time :  185
accuracy train: 0.894029 val: 0.764789 test: 0.770962
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278

Epoch :  17 loss training:  56.709119856357574 Time :  198
accuracy train: 0.903720 val: 0.774648 test: 0.768430
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278

Epoch :  18 loss training:  54.51192134618759 Time :  213
accuracy train: 0.908253 val: 0.770423 test: 0.770118
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278

Epoch :  19 loss training:  53.72320160269737 Time :  225
accuracy train: 0.912785 val: 0.767606 test: 0.770962
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278

Epoch :  20 loss training:  51.595349848270416 Time :  235
accuracy train: 0.919662 val: 0.776056 test: 0.768430
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278

Epoch :  21 loss training:  49.89405472576618 Time :  248
accuracy train: 0.926696 val: 0.774648 test: 0.771806
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278

Epoch :  22 loss training:  49.128111600875854 Time :  256
accuracy train: 0.931072 val: 0.777465 test: 0.773213
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278

Epoch :  23 loss training:  45.915800005197525 Time :  269
accuracy train: 0.935136 val: 0.771831 test: 0.771244
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278

Epoch :  24 loss training:  45.485981076955795 Time :  279
accuracy train: 0.939825 val: 0.773239 test: 0.772088
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278

Epoch :  25 loss training:  43.72033843398094 Time :  290
accuracy train: 0.949203 val: 0.777465 test: 0.772369
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278

Epoch :  26 loss training:  41.883829057216644 Time :  301
accuracy train: 0.951547 val: 0.776056 test: 0.770118
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278

Epoch :  27 loss training:  40.609341733157635 Time :  311
accuracy train: 0.953892 val: 0.771831 test: 0.766460
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278

Epoch :  28 loss training:  39.83880256861448 Time :  323
accuracy train: 0.960300 val: 0.770423 test: 0.771244
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278

Epoch :  29 loss training:  37.562217243015766 Time :  337
accuracy train: 0.963895 val: 0.774648 test: 0.770118
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278

Epoch :  30 loss training:  37.04963195323944 Time :  348
accuracy train: 0.968115 val: 0.769014 test: 0.773776
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278

Epoch :  31 loss training:  35.53315506130457 Time :  360
accuracy train: 0.970303 val: 0.776056 test: 0.772369
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278

Epoch :  32 loss training:  35.23649311065674 Time :  369
accuracy train: 0.974367 val: 0.780282 test: 0.770962
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278

Epoch :  33 loss training:  33.34514682739973 Time :  381
accuracy train: 0.978274 val: 0.774648 test: 0.770118
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278

Epoch :  34 loss training:  31.054841378703713 Time :  391
accuracy train: 0.981088 val: 0.771831 test: 0.765335
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278

Epoch :  35 loss training:  30.176885951310396 Time :  402
accuracy train: 0.982651 val: 0.769014 test: 0.771806
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278

Epoch :  36 loss training:  30.880800679326057 Time :  414
accuracy train: 0.983589 val: 0.777465 test: 0.764772
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.778278

========================================================================================================================================================================================================
max acc epoch :  5
max validation accuracy :  0.795774647887324
test accuracy :  0.7782779966235228
last test_accuracy :  0.7647720877884074
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=420, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  92.57123783230782 Time :  424
accuracy train: 0.778525 val: 0.733803 test: 0.753517
max validation accuracy : 0.733803 max acc epoch : 1 test accuracy : 0.753517
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.13218912482262 Time :  435
accuracy train: 0.790560 val: 0.722535 test: 0.758863
max validation accuracy : 0.733803 max acc epoch : 1 test accuracy : 0.753517
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.03951114416122 Time :  447
accuracy train: 0.808378 val: 0.759155 test: 0.767023
max validation accuracy : 0.759155 max acc epoch : 3 test accuracy : 0.767023
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  75.24825903773308 Time :  465
accuracy train: 0.826352 val: 0.797183 test: 0.772088
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.75651746988297 Time :  475
accuracy train: 0.828228 val: 0.797183 test: 0.776871
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.07673950493336 Time :  488
accuracy train: 0.841982 val: 0.783099 test: 0.768149
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.44336451590061 Time :  499
accuracy train: 0.843701 val: 0.787324 test: 0.769555
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.16268020868301 Time :  509
accuracy train: 0.854642 val: 0.784507 test: 0.768711
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.55137528479099 Time :  522
accuracy train: 0.866833 val: 0.781690 test: 0.767867
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.67084200680256 Time :  532
accuracy train: 0.874179 val: 0.783099 test: 0.768711
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  61.29238514602184 Time :  543
accuracy train: 0.881057 val: 0.776056 test: 0.764491
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  60.314297795295715 Time :  555
accuracy train: 0.882151 val: 0.781690 test: 0.773776
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.96450734138489 Time :  563
accuracy train: 0.886214 val: 0.777465 test: 0.770400
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  58.393299505114555 Time :  575
accuracy train: 0.886371 val: 0.784507 test: 0.767023
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.89694099128246 Time :  587
accuracy train: 0.892623 val: 0.776056 test: 0.770681
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088

Epoch :  16 loss training:  57.35172252357006 Time :  600
accuracy train: 0.894967 val: 0.781690 test: 0.769555
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088

Epoch :  17 loss training:  56.364331498742104 Time :  611
accuracy train: 0.905127 val: 0.780282 test: 0.767023
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088

Epoch :  18 loss training:  53.84203304350376 Time :  621
accuracy train: 0.909347 val: 0.785915 test: 0.768993
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088

Epoch :  19 loss training:  53.626330599188805 Time :  632
accuracy train: 0.914505 val: 0.780282 test: 0.766179
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088

Epoch :  20 loss training:  50.93477879464626 Time :  642
accuracy train: 0.919662 val: 0.780282 test: 0.765898
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088

Epoch :  21 loss training:  49.4983316808939 Time :  653
accuracy train: 0.927634 val: 0.777465 test: 0.762521
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088

Epoch :  22 loss training:  48.54590746760368 Time :  664
accuracy train: 0.934667 val: 0.777465 test: 0.766460
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088

Epoch :  23 loss training:  45.677021235227585 Time :  673
accuracy train: 0.936699 val: 0.780282 test: 0.768993
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088

Epoch :  24 loss training:  45.65432646125555 Time :  685
accuracy train: 0.940919 val: 0.776056 test: 0.765335
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088

Epoch :  25 loss training:  43.8042197227478 Time :  697
accuracy train: 0.947327 val: 0.781690 test: 0.764491
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088

Epoch :  26 loss training:  41.45277104526758 Time :  709
accuracy train: 0.949515 val: 0.784507 test: 0.763365
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088

Epoch :  27 loss training:  40.623958230018616 Time :  719
accuracy train: 0.956862 val: 0.776056 test: 0.761958
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088

Epoch :  28 loss training:  39.37694971263409 Time :  726
accuracy train: 0.959206 val: 0.783099 test: 0.768711
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088

Epoch :  29 loss training:  37.5732841566205 Time :  737
accuracy train: 0.961707 val: 0.783099 test: 0.765898
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088

Epoch :  30 loss training:  36.77282354235649 Time :  749
accuracy train: 0.966552 val: 0.778873 test: 0.765898
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088

Epoch :  31 loss training:  35.217383064329624 Time :  758
accuracy train: 0.970303 val: 0.787324 test: 0.765335
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088

Epoch :  32 loss training:  35.03883180767298 Time :  770
accuracy train: 0.974836 val: 0.783099 test: 0.765053
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088

Epoch :  33 loss training:  33.10579755157232 Time :  780
accuracy train: 0.979056 val: 0.783099 test: 0.767586
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088

Epoch :  34 loss training:  30.29389540106058 Time :  790
accuracy train: 0.981088 val: 0.776056 test: 0.764209
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088

Epoch :  35 loss training:  30.812704779207706 Time :  801
accuracy train: 0.982495 val: 0.783099 test: 0.764772
max validation accuracy : 0.797183 max acc epoch : 4 test accuracy : 0.772088

========================================================================================================================================================================================================
max acc epoch :  4
max validation accuracy :  0.7971830985915493
test accuracy :  0.7720877884074282
last test_accuracy :  0.7647720877884074
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=420, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  92.58539786934853 Time :  812
accuracy train: 0.781494 val: 0.747887 test: 0.754643
max validation accuracy : 0.747887 max acc epoch : 1 test accuracy : 0.754643
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.37991401553154 Time :  826
accuracy train: 0.795405 val: 0.743662 test: 0.765616
max validation accuracy : 0.747887 max acc epoch : 1 test accuracy : 0.754643
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.22177016735077 Time :  836
accuracy train: 0.807284 val: 0.760563 test: 0.761677
max validation accuracy : 0.760563 max acc epoch : 3 test accuracy : 0.761677
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.85456436872482 Time :  846
accuracy train: 0.828071 val: 0.780282 test: 0.771525
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.771525
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.27828827500343 Time :  854
accuracy train: 0.830416 val: 0.800000 test: 0.775746
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.9563559293747 Time :  864
accuracy train: 0.845577 val: 0.777465 test: 0.775464
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.35300233960152 Time :  875
accuracy train: 0.847609 val: 0.784507 test: 0.772651
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.23006002604961 Time :  884
accuracy train: 0.856518 val: 0.780282 test: 0.772932
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.979960799217224 Time :  895
accuracy train: 0.875586 val: 0.776056 test: 0.766742
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.388013020157814 Time :  901
accuracy train: 0.879962 val: 0.774648 test: 0.767867
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.91635625064373 Time :  912
accuracy train: 0.887152 val: 0.771831 test: 0.767867
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.3255116045475 Time :  922
accuracy train: 0.888872 val: 0.774648 test: 0.771244
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  56.46080447733402 Time :  931
accuracy train: 0.894811 val: 0.769014 test: 0.770681
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.98768863081932 Time :  944
accuracy train: 0.896061 val: 0.769014 test: 0.769837
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  55.33347423374653 Time :  956
accuracy train: 0.899656 val: 0.777465 test: 0.768993
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746

Epoch :  16 loss training:  56.28836998343468 Time :  968
accuracy train: 0.904033 val: 0.773239 test: 0.769274
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746

Epoch :  17 loss training:  55.18760047852993 Time :  978
accuracy train: 0.917318 val: 0.767606 test: 0.767304
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746

Epoch :  18 loss training:  52.87283833324909 Time :  989
accuracy train: 0.917631 val: 0.778873 test: 0.768430
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746

Epoch :  19 loss training:  52.14402824640274 Time :  1002
accuracy train: 0.924820 val: 0.776056 test: 0.768711
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746

Epoch :  20 loss training:  49.90383245050907 Time :  1011
accuracy train: 0.928103 val: 0.776056 test: 0.765053
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746

Epoch :  21 loss training:  48.32371578365564 Time :  1024
accuracy train: 0.935605 val: 0.771831 test: 0.765335
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746

Epoch :  22 loss training:  47.40440221875906 Time :  1034
accuracy train: 0.943264 val: 0.770423 test: 0.769837
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746

Epoch :  23 loss training:  44.69207728654146 Time :  1044
accuracy train: 0.947484 val: 0.769014 test: 0.766742
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746

Epoch :  24 loss training:  44.04348262399435 Time :  1056
accuracy train: 0.952016 val: 0.769014 test: 0.769274
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746

Epoch :  25 loss training:  41.925346717238426 Time :  1069
accuracy train: 0.954673 val: 0.770423 test: 0.767304
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746

Epoch :  26 loss training:  39.671306781470776 Time :  1081
accuracy train: 0.957799 val: 0.760563 test: 0.767867
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746

Epoch :  27 loss training:  38.73161094635725 Time :  1088
accuracy train: 0.961863 val: 0.767606 test: 0.766742
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746

Epoch :  28 loss training:  38.64859049767256 Time :  1100
accuracy train: 0.968584 val: 0.767606 test: 0.766179
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746

Epoch :  29 loss training:  35.69517047703266 Time :  1111
accuracy train: 0.971866 val: 0.764789 test: 0.765335
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746

Epoch :  30 loss training:  35.17513021826744 Time :  1121
accuracy train: 0.972648 val: 0.763380 test: 0.764772
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746

Epoch :  31 loss training:  34.02998814731836 Time :  1133
accuracy train: 0.975774 val: 0.767606 test: 0.768149
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746

Epoch :  32 loss training:  33.55654515698552 Time :  1141
accuracy train: 0.978743 val: 0.763380 test: 0.764772
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746

Epoch :  33 loss training:  31.749789893627167 Time :  1153
accuracy train: 0.982182 val: 0.767606 test: 0.763647
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746

Epoch :  34 loss training:  29.074837025254965 Time :  1163
accuracy train: 0.984683 val: 0.753521 test: 0.761677
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746

Epoch :  35 loss training:  29.01557733491063 Time :  1173
accuracy train: 0.985933 val: 0.764789 test: 0.764209
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746

Epoch :  36 loss training:  28.988979797810316 Time :  1186
accuracy train: 0.988278 val: 0.761972 test: 0.759145
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.775746

========================================================================================================================================================================================================
max acc epoch :  5
max validation accuracy :  0.8
test accuracy :  0.7757456387169387
last test_accuracy :  0.7591446257737761
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=420, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  92.555046916008 Time :  1201
accuracy train: 0.781025 val: 0.742254 test: 0.755768
max validation accuracy : 0.742254 max acc epoch : 1 test accuracy : 0.755768
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.03761830925941 Time :  1213
accuracy train: 0.782588 val: 0.728169 test: 0.753799
max validation accuracy : 0.742254 max acc epoch : 1 test accuracy : 0.755768
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.33291977643967 Time :  1222
accuracy train: 0.812285 val: 0.769014 test: 0.763928
max validation accuracy : 0.769014 max acc epoch : 3 test accuracy : 0.763928
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  75.36234220862389 Time :  1234
accuracy train: 0.824320 val: 0.787324 test: 0.776308
max validation accuracy : 0.787324 max acc epoch : 4 test accuracy : 0.776308
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.4076824337244 Time :  1245
accuracy train: 0.830572 val: 0.798592 test: 0.774057
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.16735972464085 Time :  1252
accuracy train: 0.841669 val: 0.790141 test: 0.770962
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.94883444905281 Time :  1263
accuracy train: 0.844483 val: 0.776056 test: 0.770400
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.26203732192516 Time :  1271
accuracy train: 0.858081 val: 0.774648 test: 0.772651
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.36236643791199 Time :  1283
accuracy train: 0.867302 val: 0.773239 test: 0.769837
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.71541993319988 Time :  1292
accuracy train: 0.872929 val: 0.781690 test: 0.772088
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.89943063259125 Time :  1304
accuracy train: 0.877462 val: 0.784507 test: 0.768430
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  60.239624083042145 Time :  1321
accuracy train: 0.881057 val: 0.778873 test: 0.774902
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.71543711423874 Time :  1331
accuracy train: 0.882307 val: 0.773239 test: 0.770118
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  58.207063391804695 Time :  1343
accuracy train: 0.882620 val: 0.773239 test: 0.772088
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.99290677905083 Time :  1353
accuracy train: 0.887777 val: 0.771831 test: 0.770118
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057

Epoch :  16 loss training:  57.19735136628151 Time :  1364
accuracy train: 0.891685 val: 0.777465 test: 0.770681
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057

Epoch :  17 loss training:  55.96757951378822 Time :  1376
accuracy train: 0.902313 val: 0.777465 test: 0.771806
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057

Epoch :  18 loss training:  53.84399001300335 Time :  1386
accuracy train: 0.906221 val: 0.777465 test: 0.773495
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057

Epoch :  19 loss training:  53.29817533493042 Time :  1397
accuracy train: 0.911847 val: 0.781690 test: 0.772932
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057

Epoch :  20 loss training:  50.488119557499886 Time :  1409
accuracy train: 0.918412 val: 0.784507 test: 0.772088
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057

Epoch :  21 loss training:  49.26382628828287 Time :  1419
accuracy train: 0.926696 val: 0.769014 test: 0.774339
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057

Epoch :  22 loss training:  48.2756117656827 Time :  1432
accuracy train: 0.932323 val: 0.780282 test: 0.771244
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057

Epoch :  23 loss training:  45.52734216302633 Time :  1445
accuracy train: 0.937480 val: 0.771831 test: 0.773213
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057

Epoch :  24 loss training:  44.82192017138004 Time :  1456
accuracy train: 0.941544 val: 0.766197 test: 0.772369
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057

Epoch :  25 loss training:  43.60949829220772 Time :  1465
accuracy train: 0.946546 val: 0.783099 test: 0.768993
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057

Epoch :  26 loss training:  40.64768358319998 Time :  1476
accuracy train: 0.950297 val: 0.781690 test: 0.771806
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057

Epoch :  27 loss training:  40.14725273102522 Time :  1483
accuracy train: 0.956080 val: 0.766197 test: 0.768149
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057

Epoch :  28 loss training:  39.08704001456499 Time :  1494
accuracy train: 0.960925 val: 0.774648 test: 0.770681
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057

Epoch :  29 loss training:  37.110389582812786 Time :  1503
accuracy train: 0.965145 val: 0.785915 test: 0.767586
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057

Epoch :  30 loss training:  36.307187519967556 Time :  1515
accuracy train: 0.967490 val: 0.777465 test: 0.771244
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057

Epoch :  31 loss training:  35.090888537466526 Time :  1524
accuracy train: 0.973117 val: 0.777465 test: 0.771244
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057

Epoch :  32 loss training:  35.61897296085954 Time :  1536
accuracy train: 0.976711 val: 0.781690 test: 0.764209
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057

Epoch :  33 loss training:  33.43562791123986 Time :  1548
accuracy train: 0.980150 val: 0.783099 test: 0.769837
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057

Epoch :  34 loss training:  29.908292289823294 Time :  1563
accuracy train: 0.980306 val: 0.778873 test: 0.764772
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057

Epoch :  35 loss training:  30.553617876023054 Time :  1575
accuracy train: 0.981869 val: 0.784507 test: 0.769837
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057

Epoch :  36 loss training:  30.036523070186377 Time :  1587
accuracy train: 0.983901 val: 0.781690 test: 0.763928
max validation accuracy : 0.798592 max acc epoch : 5 test accuracy : 0.774057

========================================================================================================================================================================================================
max acc epoch :  5
max validation accuracy :  0.7985915492957747
test accuracy :  0.7740574001125492
last test_accuracy :  0.7639279684862127
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=420, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  92.55705541372299 Time :  1598
accuracy train: 0.781182 val: 0.760563 test: 0.758863
max validation accuracy : 0.760563 max acc epoch : 1 test accuracy : 0.758863
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.06490251421928 Time :  1610
accuracy train: 0.784933 val: 0.735211 test: 0.756050
max validation accuracy : 0.760563 max acc epoch : 1 test accuracy : 0.758863
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.24844388663769 Time :  1620
accuracy train: 0.805408 val: 0.756338 test: 0.765616
max validation accuracy : 0.760563 max acc epoch : 1 test accuracy : 0.758863
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.75821775197983 Time :  1627
accuracy train: 0.827446 val: 0.790141 test: 0.777715
max validation accuracy : 0.790141 max acc epoch : 4 test accuracy : 0.777715
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.12452186644077 Time :  1635
accuracy train: 0.832917 val: 0.804225 test: 0.776027
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.13863563537598 Time :  1646
accuracy train: 0.841669 val: 0.777465 test: 0.776590
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.52709428966045 Time :  1658
accuracy train: 0.848078 val: 0.778873 test: 0.773776
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.70224232971668 Time :  1666
accuracy train: 0.856518 val: 0.777465 test: 0.774620
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.2451431453228 Time :  1681
accuracy train: 0.871522 val: 0.774648 test: 0.771806
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.4537812769413 Time :  1695
accuracy train: 0.877931 val: 0.778873 test: 0.777434
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.6105650216341 Time :  1705
accuracy train: 0.884339 val: 0.774648 test: 0.770400
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.70666666328907 Time :  1716
accuracy train: 0.884651 val: 0.773239 test: 0.776590
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.044319957494736 Time :  1729
accuracy train: 0.888246 val: 0.763380 test: 0.773776
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.45766034722328 Time :  1738
accuracy train: 0.890747 val: 0.774648 test: 0.775183
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  55.801935374736786 Time :  1750
accuracy train: 0.895123 val: 0.774648 test: 0.773213
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027

Epoch :  16 loss training:  56.56043729186058 Time :  1762
accuracy train: 0.898562 val: 0.771831 test: 0.775183
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027

Epoch :  17 loss training:  55.896385848522186 Time :  1771
accuracy train: 0.910284 val: 0.778873 test: 0.776027
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027

Epoch :  18 loss training:  53.190764620900154 Time :  1783
accuracy train: 0.916068 val: 0.777465 test: 0.776027
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027

Epoch :  19 loss training:  52.05812647938728 Time :  1794
accuracy train: 0.919975 val: 0.783099 test: 0.773495
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027

Epoch :  20 loss training:  50.32811000943184 Time :  1806
accuracy train: 0.925914 val: 0.774648 test: 0.776590
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027

Epoch :  21 loss training:  48.93540393561125 Time :  1819
accuracy train: 0.932948 val: 0.777465 test: 0.775183
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027

Epoch :  22 loss training:  47.38321045786142 Time :  1829
accuracy train: 0.936543 val: 0.777465 test: 0.774339
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027

Epoch :  23 loss training:  44.20996595919132 Time :  1839
accuracy train: 0.940294 val: 0.774648 test: 0.773213
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027

Epoch :  24 loss training:  44.229288816452026 Time :  1851
accuracy train: 0.946077 val: 0.769014 test: 0.772369
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027

Epoch :  25 loss training:  42.575017265975475 Time :  1861
accuracy train: 0.950610 val: 0.769014 test: 0.770962
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027

Epoch :  26 loss training:  40.23465869575739 Time :  1872
accuracy train: 0.954048 val: 0.773239 test: 0.768430
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027

Epoch :  27 loss training:  39.325280867516994 Time :  1883
accuracy train: 0.959675 val: 0.764789 test: 0.771806
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027

Epoch :  28 loss training:  39.130814366042614 Time :  1892
accuracy train: 0.962332 val: 0.776056 test: 0.774057
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027

Epoch :  29 loss training:  35.48041867464781 Time :  1904
accuracy train: 0.968271 val: 0.769014 test: 0.771244
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027

Epoch :  30 loss training:  35.50285343080759 Time :  1917
accuracy train: 0.970928 val: 0.766197 test: 0.771525
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027

Epoch :  31 loss training:  34.176501117646694 Time :  1929
accuracy train: 0.974836 val: 0.771831 test: 0.772651
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027

Epoch :  32 loss training:  34.2988314665854 Time :  1944
accuracy train: 0.979681 val: 0.769014 test: 0.770118
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027

Epoch :  33 loss training:  31.490197144448757 Time :  1955
accuracy train: 0.980306 val: 0.767606 test: 0.773495
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027

Epoch :  34 loss training:  29.51834685727954 Time :  1967
accuracy train: 0.983745 val: 0.766197 test: 0.774339
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027

Epoch :  35 loss training:  29.040806889533997 Time :  1979
accuracy train: 0.985464 val: 0.773239 test: 0.772932
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027

Epoch :  36 loss training:  29.63605933263898 Time :  1990
accuracy train: 0.989372 val: 0.767606 test: 0.769837
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.776027

========================================================================================================================================================================================================
max acc epoch :  5
max validation accuracy :  0.8042253521126761
test accuracy :  0.7760270118176702
last test_accuracy :  0.7698368036015757
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=420, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  92.5274246931076 Time :  2002
accuracy train: 0.781807 val: 0.754930 test: 0.756894
max validation accuracy : 0.754930 max acc epoch : 1 test accuracy : 0.756894
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.24402931332588 Time :  2013
accuracy train: 0.789309 val: 0.745070 test: 0.760551
max validation accuracy : 0.754930 max acc epoch : 1 test accuracy : 0.756894
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.40605190396309 Time :  2022
accuracy train: 0.803845 val: 0.769014 test: 0.767867
max validation accuracy : 0.769014 max acc epoch : 3 test accuracy : 0.767867
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  75.24009570479393 Time :  2033
accuracy train: 0.824476 val: 0.781690 test: 0.776308
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.776308
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.72477093338966 Time :  2047
accuracy train: 0.828384 val: 0.795775 test: 0.782217
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.13779971003532 Time :  2060
accuracy train: 0.837918 val: 0.783099 test: 0.775464
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.89981004595757 Time :  2071
accuracy train: 0.844014 val: 0.784507 test: 0.768149
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.69148081541061 Time :  2082
accuracy train: 0.855736 val: 0.780282 test: 0.768993
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.212183743715286 Time :  2093
accuracy train: 0.865739 val: 0.778873 test: 0.771806
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.498425737023354 Time :  2105
accuracy train: 0.875117 val: 0.777465 test: 0.771244
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  61.04876644909382 Time :  2114
accuracy train: 0.876680 val: 0.773239 test: 0.768430
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.799320086836815 Time :  2126
accuracy train: 0.877931 val: 0.783099 test: 0.771806
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.74733228981495 Time :  2137
accuracy train: 0.881994 val: 0.769014 test: 0.772932
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  58.41655197739601 Time :  2146
accuracy train: 0.884808 val: 0.771831 test: 0.770400
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.85109083354473 Time :  2157
accuracy train: 0.888246 val: 0.766197 test: 0.770118
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217

Epoch :  16 loss training:  57.28400894999504 Time :  2168
accuracy train: 0.889184 val: 0.761972 test: 0.773776
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217

Epoch :  17 loss training:  55.87717632949352 Time :  2185
accuracy train: 0.903720 val: 0.764789 test: 0.770118
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217

Epoch :  18 loss training:  53.22079426050186 Time :  2197
accuracy train: 0.907940 val: 0.766197 test: 0.771244
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217

Epoch :  19 loss training:  53.72655525803566 Time :  2208
accuracy train: 0.912473 val: 0.761972 test: 0.770681
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217

Epoch :  20 loss training:  50.74616585671902 Time :  2218
accuracy train: 0.919193 val: 0.767606 test: 0.770118
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217

Epoch :  21 loss training:  49.31855887174606 Time :  2229
accuracy train: 0.927165 val: 0.764789 test: 0.768993
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217

Epoch :  22 loss training:  48.53315319865942 Time :  2241
accuracy train: 0.936386 val: 0.763380 test: 0.770681
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217

Epoch :  23 loss training:  45.24587966501713 Time :  2249
accuracy train: 0.935136 val: 0.770423 test: 0.773213
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217

Epoch :  24 loss training:  45.26591341197491 Time :  2261
accuracy train: 0.941388 val: 0.761972 test: 0.773495
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217

Epoch :  25 loss training:  43.699503034353256 Time :  2271
accuracy train: 0.947484 val: 0.763380 test: 0.770400
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217

Epoch :  26 loss training:  41.23009692132473 Time :  2282
accuracy train: 0.951391 val: 0.766197 test: 0.772651
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217

Epoch :  27 loss training:  40.216249741613865 Time :  2294
accuracy train: 0.957174 val: 0.759155 test: 0.771806
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217

Epoch :  28 loss training:  39.08632940798998 Time :  2305
accuracy train: 0.963739 val: 0.766197 test: 0.772088
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217

Epoch :  29 loss training:  37.315374076366425 Time :  2324
accuracy train: 0.966552 val: 0.766197 test: 0.773495
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217

Epoch :  30 loss training:  37.3841767013073 Time :  2334
accuracy train: 0.969209 val: 0.760563 test: 0.771244
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217

Epoch :  31 loss training:  35.21908496320248 Time :  2345
accuracy train: 0.971241 val: 0.760563 test: 0.769555
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217

Epoch :  32 loss training:  34.99253626167774 Time :  2357
accuracy train: 0.977024 val: 0.771831 test: 0.766742
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217

Epoch :  33 loss training:  33.657642267644405 Time :  2365
accuracy train: 0.979525 val: 0.769014 test: 0.769555
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217

Epoch :  34 loss training:  31.057457400485873 Time :  2376
accuracy train: 0.980463 val: 0.766197 test: 0.772088
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217

Epoch :  35 loss training:  30.75327929481864 Time :  2387
accuracy train: 0.983120 val: 0.761972 test: 0.768149
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217

Epoch :  36 loss training:  30.611339405179024 Time :  2398
accuracy train: 0.986558 val: 0.750704 test: 0.761677
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.782217

========================================================================================================================================================================================================
max acc epoch :  5
max validation accuracy :  0.795774647887324
test accuracy :  0.7822172200337648
last test_accuracy :  0.7616769836803602
========================================================================================================================================================================================================

itr : 6
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=420, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  92.5915724337101 Time :  2411
accuracy train: 0.783057 val: 0.756338 test: 0.758301
max validation accuracy : 0.756338 max acc epoch : 1 test accuracy : 0.758301
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.2792007625103 Time :  2421
accuracy train: 0.789778 val: 0.736620 test: 0.763365
max validation accuracy : 0.756338 max acc epoch : 1 test accuracy : 0.758301
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.02388255298138 Time :  2432
accuracy train: 0.807440 val: 0.746479 test: 0.759989
max validation accuracy : 0.756338 max acc epoch : 1 test accuracy : 0.758301
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.89678037166595 Time :  2446
accuracy train: 0.826665 val: 0.785915 test: 0.777153
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.777153
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.04830341041088 Time :  2459
accuracy train: 0.829165 val: 0.795775 test: 0.773495
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.52296969294548 Time :  2471
accuracy train: 0.844014 val: 0.780282 test: 0.770962
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.31082291901112 Time :  2480
accuracy train: 0.846202 val: 0.788732 test: 0.769837
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.3112972676754 Time :  2493
accuracy train: 0.858237 val: 0.783099 test: 0.766742
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.523047998547554 Time :  2505
accuracy train: 0.873867 val: 0.780282 test: 0.771244
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.12136350572109 Time :  2513
accuracy train: 0.881838 val: 0.784507 test: 0.771525
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.42390422523022 Time :  2525
accuracy train: 0.885902 val: 0.773239 test: 0.766742
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.34664662182331 Time :  2534
accuracy train: 0.888090 val: 0.770423 test: 0.770962
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  56.65273775160313 Time :  2545
accuracy train: 0.893873 val: 0.776056 test: 0.772932
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.448681101202965 Time :  2558
accuracy train: 0.893873 val: 0.776056 test: 0.770962
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  55.58774997293949 Time :  2571
accuracy train: 0.895280 val: 0.769014 test: 0.767867
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495

Epoch :  16 loss training:  56.30678002536297 Time :  2584
accuracy train: 0.900125 val: 0.776056 test: 0.772088
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495

Epoch :  17 loss training:  55.72538332641125 Time :  2595
accuracy train: 0.910128 val: 0.773239 test: 0.768993
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495

Epoch :  18 loss training:  52.698411360383034 Time :  2606
accuracy train: 0.914973 val: 0.773239 test: 0.770400
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495

Epoch :  19 loss training:  52.33898603916168 Time :  2618
accuracy train: 0.921538 val: 0.773239 test: 0.770400
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495

Epoch :  20 loss training:  50.08476921916008 Time :  2631
accuracy train: 0.925445 val: 0.774648 test: 0.767867
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495

Epoch :  21 loss training:  48.33995619416237 Time :  2641
accuracy train: 0.932635 val: 0.776056 test: 0.768993
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495

Epoch :  22 loss training:  47.11288136988878 Time :  2653
accuracy train: 0.939669 val: 0.769014 test: 0.767586
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495

Epoch :  23 loss training:  44.48550435900688 Time :  2664
accuracy train: 0.943732 val: 0.769014 test: 0.770400
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495

Epoch :  24 loss training:  43.79219890385866 Time :  2675
accuracy train: 0.948734 val: 0.761972 test: 0.767867
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495

Epoch :  25 loss training:  42.543605364859104 Time :  2687
accuracy train: 0.951860 val: 0.778873 test: 0.771525
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495

Epoch :  26 loss training:  39.93966115266085 Time :  2701
accuracy train: 0.956080 val: 0.777465 test: 0.768711
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495

Epoch :  27 loss training:  39.074635446071625 Time :  2713
accuracy train: 0.959831 val: 0.764789 test: 0.764491
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495

Epoch :  28 loss training:  38.46167968958616 Time :  2724
accuracy train: 0.966552 val: 0.767606 test: 0.769837
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495

Epoch :  29 loss training:  35.447991117835045 Time :  2734
accuracy train: 0.968897 val: 0.771831 test: 0.771806
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495

Epoch :  30 loss training:  35.56704783439636 Time :  2745
accuracy train: 0.973117 val: 0.769014 test: 0.769555
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495

Epoch :  31 loss training:  34.059836748987436 Time :  2757
accuracy train: 0.975930 val: 0.769014 test: 0.771806
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495

Epoch :  32 loss training:  33.65385387837887 Time :  2766
accuracy train: 0.978274 val: 0.776056 test: 0.767304
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495

Epoch :  33 loss training:  31.912713035941124 Time :  2778
accuracy train: 0.982026 val: 0.770423 test: 0.767023
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495

Epoch :  34 loss training:  29.724257968366146 Time :  2789
accuracy train: 0.983276 val: 0.773239 test: 0.765898
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495

Epoch :  35 loss training:  29.550198771059513 Time :  2799
accuracy train: 0.985308 val: 0.766197 test: 0.769555
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495

Epoch :  36 loss training:  28.877361476421356 Time :  2812
accuracy train: 0.988590 val: 0.771831 test: 0.762521
max validation accuracy : 0.795775 max acc epoch : 5 test accuracy : 0.773495

========================================================================================================================================================================================================
max acc epoch :  5
max validation accuracy :  0.795774647887324
test accuracy :  0.7734946539110861
last test_accuracy :  0.7625211029825548
========================================================================================================================================================================================================

itr : 7
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=420, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  92.53229770064354 Time :  2825
accuracy train: 0.779775 val: 0.743662 test: 0.757456
max validation accuracy : 0.743662 max acc epoch : 1 test accuracy : 0.757456
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.33357912302017 Time :  2836
accuracy train: 0.799625 val: 0.753521 test: 0.771244
max validation accuracy : 0.753521 max acc epoch : 2 test accuracy : 0.771244
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.44624504446983 Time :  2846
accuracy train: 0.807127 val: 0.766197 test: 0.762240
max validation accuracy : 0.766197 max acc epoch : 3 test accuracy : 0.762240
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  75.22505390644073 Time :  2859
accuracy train: 0.826977 val: 0.785915 test: 0.778841
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.778841
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.75325466692448 Time :  2868
accuracy train: 0.830416 val: 0.804225 test: 0.777715
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.89436319470406 Time :  2880
accuracy train: 0.842451 val: 0.766197 test: 0.774902
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.30571959912777 Time :  2893
accuracy train: 0.844326 val: 0.770423 test: 0.772369
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.06546688079834 Time :  2900
accuracy train: 0.856049 val: 0.767606 test: 0.769274
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.45282346010208 Time :  2912
accuracy train: 0.865427 val: 0.776056 test: 0.765053
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.49376428127289 Time :  2921
accuracy train: 0.874492 val: 0.767606 test: 0.767867
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.62438027560711 Time :  2935
accuracy train: 0.880431 val: 0.778873 test: 0.765335
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  60.23304794728756 Time :  2948
accuracy train: 0.884026 val: 0.773239 test: 0.770962
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.162758111953735 Time :  2957
accuracy train: 0.886058 val: 0.767606 test: 0.769274
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.87492993474007 Time :  2970
accuracy train: 0.888246 val: 0.777465 test: 0.768993
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.515988394618034 Time :  2979
accuracy train: 0.894186 val: 0.766197 test: 0.766460
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715

Epoch :  16 loss training:  56.546295538544655 Time :  2992
accuracy train: 0.896061 val: 0.776056 test: 0.767867
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715

Epoch :  17 loss training:  56.29360769689083 Time :  3005
accuracy train: 0.907158 val: 0.778873 test: 0.765898
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715

Epoch :  18 loss training:  53.30719989538193 Time :  3013
accuracy train: 0.912473 val: 0.781690 test: 0.768711
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715

Epoch :  19 loss training:  52.95750792324543 Time :  3026
accuracy train: 0.915755 val: 0.781690 test: 0.765335
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715

Epoch :  20 loss training:  50.62889052927494 Time :  3035
accuracy train: 0.925289 val: 0.777465 test: 0.766179
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715

Epoch :  21 loss training:  49.175109304487705 Time :  3047
accuracy train: 0.932323 val: 0.777465 test: 0.767586
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715

Epoch :  22 loss training:  48.28738781809807 Time :  3061
accuracy train: 0.937324 val: 0.778873 test: 0.768711
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715

Epoch :  23 loss training:  45.64554933458567 Time :  3076
accuracy train: 0.938106 val: 0.773239 test: 0.770400
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715

Epoch :  24 loss training:  44.92625907063484 Time :  3086
accuracy train: 0.946389 val: 0.778873 test: 0.770400
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715

Epoch :  25 loss training:  42.87548879534006 Time :  3099
accuracy train: 0.950766 val: 0.774648 test: 0.767586
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715

Epoch :  26 loss training:  40.58059751242399 Time :  3111
accuracy train: 0.951704 val: 0.780282 test: 0.766179
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715

Epoch :  27 loss training:  39.40754148364067 Time :  3124
accuracy train: 0.959831 val: 0.773239 test: 0.765335
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715

Epoch :  28 loss training:  39.01695020496845 Time :  3136
accuracy train: 0.964989 val: 0.773239 test: 0.769837
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715

Epoch :  29 loss training:  36.6918680742383 Time :  3144
accuracy train: 0.969209 val: 0.769014 test: 0.767304
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715

Epoch :  30 loss training:  37.067081324756145 Time :  3156
accuracy train: 0.967802 val: 0.780282 test: 0.766460
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715

Epoch :  31 loss training:  35.31727261841297 Time :  3165
accuracy train: 0.972960 val: 0.776056 test: 0.763365
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715

Epoch :  32 loss training:  35.24164217710495 Time :  3176
accuracy train: 0.976868 val: 0.784507 test: 0.762240
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715

Epoch :  33 loss training:  33.43728282302618 Time :  3185
accuracy train: 0.979837 val: 0.780282 test: 0.764772
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715

Epoch :  34 loss training:  30.29950143955648 Time :  3197
accuracy train: 0.981244 val: 0.767606 test: 0.761677
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715

Epoch :  35 loss training:  29.836212821304798 Time :  3206
accuracy train: 0.982182 val: 0.773239 test: 0.764209
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715

Epoch :  36 loss training:  29.8499043174088 Time :  3220
accuracy train: 0.985464 val: 0.773239 test: 0.760551
max validation accuracy : 0.804225 max acc epoch : 5 test accuracy : 0.777715

========================================================================================================================================================================================================
max acc epoch :  5
max validation accuracy :  0.8042253521126761
test accuracy :  0.7777152504220597
last test_accuracy :  0.7605514912774338
========================================================================================================================================================================================================

itr : 8
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=420, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  92.55303022265434 Time :  3235
accuracy train: 0.783370 val: 0.750704 test: 0.753799
max validation accuracy : 0.750704 max acc epoch : 1 test accuracy : 0.753799
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.10593637824059 Time :  3245
accuracy train: 0.784464 val: 0.732394 test: 0.757456
max validation accuracy : 0.750704 max acc epoch : 1 test accuracy : 0.753799
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.9958615899086 Time :  3257
accuracy train: 0.806346 val: 0.764789 test: 0.761677
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.761677
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.65513348579407 Time :  3269
accuracy train: 0.829009 val: 0.788732 test: 0.773495
max validation accuracy : 0.788732 max acc epoch : 4 test accuracy : 0.773495
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.58051058650017 Time :  3278
accuracy train: 0.830259 val: 0.792958 test: 0.777997
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.95244745910168 Time :  3289
accuracy train: 0.841044 val: 0.777465 test: 0.768711
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.81146544218063 Time :  3299
accuracy train: 0.844170 val: 0.783099 test: 0.769555
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.44111305475235 Time :  3310
accuracy train: 0.857455 val: 0.780282 test: 0.765616
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.807916298508644 Time :  3323
accuracy train: 0.871991 val: 0.771831 test: 0.767304
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.58456276357174 Time :  3330
accuracy train: 0.877149 val: 0.763380 test: 0.770118
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.43932081758976 Time :  3342
accuracy train: 0.881525 val: 0.769014 test: 0.771806
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.17828972637653 Time :  3357
accuracy train: 0.883245 val: 0.776056 test: 0.774057
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.061244413256645 Time :  3370
accuracy train: 0.890278 val: 0.766197 test: 0.769837
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.676019951701164 Time :  3378
accuracy train: 0.890122 val: 0.774648 test: 0.768993
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  55.84357684850693 Time :  3391
accuracy train: 0.895123 val: 0.766197 test: 0.774620
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997

Epoch :  16 loss training:  56.21013097465038 Time :  3404
accuracy train: 0.896061 val: 0.770423 test: 0.772651
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997

Epoch :  17 loss training:  55.90570080280304 Time :  3414
accuracy train: 0.910128 val: 0.770423 test: 0.770962
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997

Epoch :  18 loss training:  52.97299426794052 Time :  3426
accuracy train: 0.914192 val: 0.769014 test: 0.770681
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997

Epoch :  19 loss training:  52.40935927629471 Time :  3436
accuracy train: 0.920131 val: 0.769014 test: 0.773213
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997

Epoch :  20 loss training:  49.962627440690994 Time :  3448
accuracy train: 0.924977 val: 0.778873 test: 0.767304
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997

Epoch :  21 loss training:  48.53408958762884 Time :  3459
accuracy train: 0.932010 val: 0.778873 test: 0.770118
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997

Epoch :  22 loss training:  47.61703220754862 Time :  3473
accuracy train: 0.936699 val: 0.773239 test: 0.770962
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997

Epoch :  23 loss training:  44.4625441506505 Time :  3486
accuracy train: 0.942326 val: 0.774648 test: 0.771525
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997

Epoch :  24 loss training:  44.603782653808594 Time :  3498
accuracy train: 0.949047 val: 0.774648 test: 0.770681
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997

Epoch :  25 loss training:  42.73929297924042 Time :  3507
accuracy train: 0.952641 val: 0.781690 test: 0.770118
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997

Epoch :  26 loss training:  40.04900135099888 Time :  3518
accuracy train: 0.958268 val: 0.770423 test: 0.770400
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997

Epoch :  27 loss training:  39.459738075733185 Time :  3528
accuracy train: 0.960613 val: 0.760563 test: 0.767867
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997

Epoch :  28 loss training:  38.98819409310818 Time :  3541
accuracy train: 0.966083 val: 0.774648 test: 0.771806
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997

Epoch :  29 loss training:  36.31296910345554 Time :  3550
accuracy train: 0.969365 val: 0.774648 test: 0.772369
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997

Epoch :  30 loss training:  35.678747199475765 Time :  3559
accuracy train: 0.971554 val: 0.777465 test: 0.770400
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997

Epoch :  31 loss training:  34.31562419235706 Time :  3568
accuracy train: 0.975617 val: 0.763380 test: 0.772088
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997

Epoch :  32 loss training:  33.80217567458749 Time :  3581
accuracy train: 0.977649 val: 0.773239 test: 0.767586
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997

Epoch :  33 loss training:  32.47090755403042 Time :  3591
accuracy train: 0.980463 val: 0.771831 test: 0.772369
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997

Epoch :  34 loss training:  29.747450932860374 Time :  3600
accuracy train: 0.982651 val: 0.770423 test: 0.770400
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997

Epoch :  35 loss training:  29.81658446788788 Time :  3610
accuracy train: 0.984995 val: 0.776056 test: 0.774057
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997

Epoch :  36 loss training:  29.746447563171387 Time :  3619
accuracy train: 0.987652 val: 0.776056 test: 0.769837
max validation accuracy : 0.792958 max acc epoch : 5 test accuracy : 0.777997

========================================================================================================================================================================================================
max acc epoch :  5
max validation accuracy :  0.7929577464788733
test accuracy :  0.7779966235227912
last test_accuracy :  0.7698368036015757
========================================================================================================================================================================================================

itr : 9
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=420, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  92.51115101575851 Time :  3629
accuracy train: 0.783682 val: 0.766197 test: 0.763647
max validation accuracy : 0.766197 max acc epoch : 1 test accuracy : 0.763647
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.14033323526382 Time :  3638
accuracy train: 0.786339 val: 0.732394 test: 0.753799
max validation accuracy : 0.766197 max acc epoch : 1 test accuracy : 0.763647
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.22317174077034 Time :  3646
accuracy train: 0.801813 val: 0.754930 test: 0.759145
max validation accuracy : 0.766197 max acc epoch : 1 test accuracy : 0.763647
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.86115157604218 Time :  3655
accuracy train: 0.829478 val: 0.780282 test: 0.772932
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.772932
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.8739605396986 Time :  3668
accuracy train: 0.828853 val: 0.790141 test: 0.772651
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.17896254360676 Time :  3677
accuracy train: 0.840888 val: 0.777465 test: 0.774902
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.27025973796844 Time :  3684
accuracy train: 0.846983 val: 0.773239 test: 0.774057
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.76661792397499 Time :  3690
accuracy train: 0.852141 val: 0.766197 test: 0.770681
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.913660511374474 Time :  3697
accuracy train: 0.864020 val: 0.769014 test: 0.769555
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.417648032307625 Time :  3704
accuracy train: 0.872304 val: 0.757746 test: 0.770962
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  61.120531007647514 Time :  3713
accuracy train: 0.878399 val: 0.776056 test: 0.765898
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  60.11139467358589 Time :  3722
accuracy train: 0.876993 val: 0.771831 test: 0.771525
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.7513634711504 Time :  3730
accuracy train: 0.883714 val: 0.760563 test: 0.774057
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  58.60670420527458 Time :  3739
accuracy train: 0.881994 val: 0.769014 test: 0.772369
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.9395771920681 Time :  3748
accuracy train: 0.889653 val: 0.766197 test: 0.770118
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651

Epoch :  16 loss training:  57.24228122830391 Time :  3762
accuracy train: 0.891685 val: 0.767606 test: 0.773213
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651

Epoch :  17 loss training:  56.4006293118 Time :  3771
accuracy train: 0.902782 val: 0.770423 test: 0.770400
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651

Epoch :  18 loss training:  54.552086278796196 Time :  3780
accuracy train: 0.905127 val: 0.764789 test: 0.769837
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651

Epoch :  19 loss training:  53.76473808288574 Time :  3789
accuracy train: 0.909347 val: 0.769014 test: 0.770962
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651

Epoch :  20 loss training:  50.90324495732784 Time :  3798
accuracy train: 0.917631 val: 0.770423 test: 0.770118
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651

Epoch :  21 loss training:  49.975176244974136 Time :  3807
accuracy train: 0.924351 val: 0.769014 test: 0.769555
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651

Epoch :  22 loss training:  49.10914719104767 Time :  3816
accuracy train: 0.930916 val: 0.770423 test: 0.767586
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651

Epoch :  23 loss training:  46.22543574869633 Time :  3825
accuracy train: 0.934198 val: 0.773239 test: 0.769837
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651

Epoch :  24 loss training:  45.96685641258955 Time :  3834
accuracy train: 0.939200 val: 0.764789 test: 0.768430
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651

Epoch :  25 loss training:  44.29687039554119 Time :  3844
accuracy train: 0.944827 val: 0.773239 test: 0.766460
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651

Epoch :  26 loss training:  41.95235697925091 Time :  3856
accuracy train: 0.947327 val: 0.773239 test: 0.765898
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651

Epoch :  27 loss training:  40.56604325026274 Time :  3865
accuracy train: 0.951704 val: 0.757746 test: 0.767586
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651

Epoch :  28 loss training:  39.77084552496672 Time :  3874
accuracy train: 0.957643 val: 0.769014 test: 0.770681
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651

Epoch :  29 loss training:  38.12031597644091 Time :  3882
accuracy train: 0.961238 val: 0.774648 test: 0.770681
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651

Epoch :  30 loss training:  36.915749311447144 Time :  3891
accuracy train: 0.962488 val: 0.771831 test: 0.773213
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651

Epoch :  31 loss training:  36.15168374031782 Time :  3900
accuracy train: 0.967959 val: 0.767606 test: 0.770118
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651

Epoch :  32 loss training:  35.53934746235609 Time :  3909
accuracy train: 0.972335 val: 0.770423 test: 0.772932
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651

Epoch :  33 loss training:  33.427500523626804 Time :  3918
accuracy train: 0.974992 val: 0.770423 test: 0.771525
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651

Epoch :  34 loss training:  31.00358876772225 Time :  3927
accuracy train: 0.976086 val: 0.763380 test: 0.769274
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651

Epoch :  35 loss training:  31.17917064577341 Time :  3940
accuracy train: 0.980150 val: 0.776056 test: 0.777153
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651

Epoch :  36 loss training:  30.82705146819353 Time :  3947
accuracy train: 0.982182 val: 0.771831 test: 0.768993
max validation accuracy : 0.790141 max acc epoch : 5 test accuracy : 0.772651

========================================================================================================================================================================================================
max acc epoch :  5
max validation accuracy :  0.7901408450704225
test accuracy :  0.7726505346088914
last test_accuracy :  0.768992684299381
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.79577 	 test_accuracy : 0.77828 	 max_acc epoch :  5 	 last test_accuracy : 0.76477
k :  1 	 val_accuracy : 0.79718 	 test_accuracy : 0.77209 	 max_acc epoch :  4 	 last test_accuracy : 0.76477
k :  2 	 val_accuracy : 0.80000 	 test_accuracy : 0.77575 	 max_acc epoch :  5 	 last test_accuracy : 0.75914
k :  3 	 val_accuracy : 0.79859 	 test_accuracy : 0.77406 	 max_acc epoch :  5 	 last test_accuracy : 0.76393
k :  4 	 val_accuracy : 0.80423 	 test_accuracy : 0.77603 	 max_acc epoch :  5 	 last test_accuracy : 0.76984
k :  5 	 val_accuracy : 0.79577 	 test_accuracy : 0.78222 	 max_acc epoch :  5 	 last test_accuracy : 0.76168
k :  6 	 val_accuracy : 0.79577 	 test_accuracy : 0.77349 	 max_acc epoch :  5 	 last test_accuracy : 0.76252
k :  7 	 val_accuracy : 0.80423 	 test_accuracy : 0.77772 	 max_acc epoch :  5 	 last test_accuracy : 0.76055
k :  8 	 val_accuracy : 0.79296 	 test_accuracy : 0.77800 	 max_acc epoch :  5 	 last test_accuracy : 0.76984
k :  9 	 val_accuracy : 0.79014 	 test_accuracy : 0.77265 	 max_acc epoch :  5 	 last test_accuracy : 0.76899

avg :  	 val_accuracy : 0.79746 	 test_accuracy : 0.77603 	 last_accuracy : 0.76460


date and time :  Fri Jun  4 02:08:19 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=657, weight_decay=0)
device :  cuda:0
Counter({0: 6243, 1: 4419})

Epoch :  1 loss training:  90.67563685774803 Time :  14
accuracy train: 0.774461 val: 0.705634 test: 0.767586
max validation accuracy : 0.705634 max acc epoch : 1 test accuracy : 0.767586
Counter({0: 6165, 1: 4497})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.40729093551636 Time :  29
accuracy train: 0.789622 val: 0.733803 test: 0.762240
max validation accuracy : 0.733803 max acc epoch : 2 test accuracy : 0.762240
Counter({0: 5734, 1: 4928})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.76873955130577 Time :  43
accuracy train: 0.801813 val: 0.746479 test: 0.762521
max validation accuracy : 0.746479 max acc epoch : 3 test accuracy : 0.762521
Counter({1: 6497, 0: 4165})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.93859845399857 Time :  57
accuracy train: 0.816974 val: 0.743662 test: 0.765898
max validation accuracy : 0.746479 max acc epoch : 3 test accuracy : 0.762521
Counter({1: 6463, 0: 4199})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.31373111903667 Time :  73
accuracy train: 0.839481 val: 0.767606 test: 0.771244
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.771244
Counter({0: 6534, 1: 4128})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.09209029376507 Time :  88
accuracy train: 0.838700 val: 0.757746 test: 0.772932
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.771244
Counter({1: 6437, 0: 4225})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.93404982984066 Time :  104
accuracy train: 0.851204 val: 0.780282 test: 0.768711
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.768711
Counter({1: 6573, 0: 4089})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.51914621889591 Time :  118
accuracy train: 0.862457 val: 0.769014 test: 0.776308
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.768711
Counter({0: 6602, 1: 4060})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.32969281077385 Time :  134
accuracy train: 0.870428 val: 0.780282 test: 0.770118
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.768711
Counter({0: 6761, 1: 3901})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.099637255072594 Time :  147
accuracy train: 0.864802 val: 0.776056 test: 0.769837
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.768711
Counter({0: 6765, 1: 3897})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.14295710623264 Time :  162
accuracy train: 0.879181 val: 0.780282 test: 0.774339
max validation accuracy : 0.780282 max acc epoch : 7 test accuracy : 0.768711
Counter({1: 6807, 0: 3855})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.51435324549675 Time :  176
accuracy train: 0.882463 val: 0.784507 test: 0.777434
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.777434
Counter({1: 6880, 0: 3782})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  58.385358929634094 Time :  192
accuracy train: 0.885746 val: 0.790141 test: 0.772369
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({0: 6905, 1: 3757})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  58.29268604516983 Time :  209
accuracy train: 0.886527 val: 0.773239 test: 0.769555
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({0: 6949, 1: 3713})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  58.01531222462654 Time :  224
accuracy train: 0.891529 val: 0.773239 test: 0.777153
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({0: 6974, 1: 3688})

Epoch :  16 loss training:  56.279589265584946 Time :  239
accuracy train: 0.889028 val: 0.771831 test: 0.769274
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({0: 7081, 1: 3581})

Epoch :  17 loss training:  54.89190934598446 Time :  253
accuracy train: 0.899187 val: 0.778873 test: 0.773776
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({1: 7078, 0: 3584})

Epoch :  18 loss training:  54.002035930752754 Time :  269
accuracy train: 0.907471 val: 0.783099 test: 0.774902
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({1: 7091, 0: 3571})

Epoch :  19 loss training:  51.76911221444607 Time :  283
accuracy train: 0.916849 val: 0.773239 test: 0.777434
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({1: 7110, 0: 3552})

Epoch :  20 loss training:  51.62661254405975 Time :  299
accuracy train: 0.921225 val: 0.781690 test: 0.776871
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({0: 7131, 1: 3531})

Epoch :  21 loss training:  48.999977707862854 Time :  317
accuracy train: 0.927634 val: 0.771831 test: 0.775183
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({0: 7147, 1: 3515})

Epoch :  22 loss training:  48.69119054079056 Time :  331
accuracy train: 0.932166 val: 0.785915 test: 0.775746
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({0: 7158, 1: 3504})

Epoch :  23 loss training:  45.76719707250595 Time :  347
accuracy train: 0.936543 val: 0.764789 test: 0.774057
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({1: 7169, 0: 3493})

Epoch :  24 loss training:  45.19719357788563 Time :  362
accuracy train: 0.942795 val: 0.773239 test: 0.771525
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({0: 7182, 1: 3480})

Epoch :  25 loss training:  42.444725409150124 Time :  376
accuracy train: 0.947171 val: 0.766197 test: 0.773495
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({0: 7162, 1: 3500})

Epoch :  26 loss training:  42.268076345324516 Time :  392
accuracy train: 0.952329 val: 0.780282 test: 0.770962
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({0: 7158, 1: 3504})

Epoch :  27 loss training:  39.85034793615341 Time :  408
accuracy train: 0.955142 val: 0.771831 test: 0.774057
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({0: 7170, 1: 3492})

Epoch :  28 loss training:  38.510797806084156 Time :  423
accuracy train: 0.956236 val: 0.774648 test: 0.774620
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({1: 7179, 0: 3483})

Epoch :  29 loss training:  37.04106220602989 Time :  438
accuracy train: 0.957174 val: 0.769014 test: 0.772651
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({1: 7185, 0: 3477})

Epoch :  30 loss training:  37.18840506672859 Time :  452
accuracy train: 0.965302 val: 0.760563 test: 0.772369
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({1: 7165, 0: 3497})

Epoch :  31 loss training:  34.2472078204155 Time :  467
accuracy train: 0.965145 val: 0.771831 test: 0.767586
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({0: 7176, 1: 3486})

Epoch :  32 loss training:  32.64362443238497 Time :  481
accuracy train: 0.972491 val: 0.773239 test: 0.766460
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({1: 7166, 0: 3496})

Epoch :  33 loss training:  32.99245208129287 Time :  496
accuracy train: 0.976711 val: 0.769014 test: 0.765616
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({1: 7164, 0: 3498})

Epoch :  34 loss training:  30.29360570758581 Time :  511
accuracy train: 0.977493 val: 0.766197 test: 0.768993
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({0: 7134, 1: 3528})

Epoch :  35 loss training:  29.52815242856741 Time :  528
accuracy train: 0.981557 val: 0.769014 test: 0.767586
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({0: 7129, 1: 3533})

Epoch :  36 loss training:  28.263188011944294 Time :  543
accuracy train: 0.983276 val: 0.757746 test: 0.767304
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({1: 7121, 0: 3541})

Epoch :  37 loss training:  28.126825973391533 Time :  557
accuracy train: 0.985308 val: 0.766197 test: 0.769837
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({0: 7125, 1: 3537})

Epoch :  38 loss training:  26.95991449058056 Time :  571
accuracy train: 0.987965 val: 0.766197 test: 0.766742
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({0: 7137, 1: 3525})

Epoch :  39 loss training:  25.659223146736622 Time :  585
accuracy train: 0.988903 val: 0.769014 test: 0.768711
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({0: 7136, 1: 3526})

Epoch :  40 loss training:  23.4923675917089 Time :  601
accuracy train: 0.989372 val: 0.766197 test: 0.761677
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({0: 7119, 1: 3543})

Epoch :  41 loss training:  23.649795603007078 Time :  616
accuracy train: 0.990778 val: 0.770423 test: 0.770400
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({0: 7067, 1: 3595})

Epoch :  42 loss training:  21.00246432237327 Time :  634
accuracy train: 0.993279 val: 0.771831 test: 0.767586
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({0: 7057, 1: 3605})

Epoch :  43 loss training:  21.819193597882986 Time :  648
accuracy train: 0.992654 val: 0.761972 test: 0.764491
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({1: 7054, 0: 3608})

Epoch :  44 loss training:  21.0081297904253 Time :  663
accuracy train: 0.994998 val: 0.766197 test: 0.768149
max validation accuracy : 0.790141 max acc epoch : 13 test accuracy : 0.772369
Counter({1: 6988, 0: 3674})

========================================================================================================================================================================================================
max acc epoch :  13
max validation accuracy :  0.7901408450704225
test accuracy :  0.7723691615081598
last test_accuracy :  0.7681485649971863
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=657, weight_decay=0)
device :  cuda:0
Counter({0: 6243, 1: 4419})

Epoch :  1 loss training:  90.66030687093735 Time :  681
accuracy train: 0.779775 val: 0.719718 test: 0.760833
max validation accuracy : 0.719718 max acc epoch : 1 test accuracy : 0.760833
Counter({1: 6367, 0: 4295})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.39621949195862 Time :  695
accuracy train: 0.794780 val: 0.732394 test: 0.767023
max validation accuracy : 0.732394 max acc epoch : 2 test accuracy : 0.767023
Counter({0: 6085, 1: 4577})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.82480826973915 Time :  709
accuracy train: 0.797593 val: 0.740845 test: 0.768993
max validation accuracy : 0.740845 max acc epoch : 3 test accuracy : 0.768993
Counter({1: 6305, 0: 4357})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.33712643384933 Time :  724
accuracy train: 0.816505 val: 0.753521 test: 0.770681
max validation accuracy : 0.753521 max acc epoch : 4 test accuracy : 0.770681
Counter({1: 6357, 0: 4305})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.00890049338341 Time :  739
accuracy train: 0.832760 val: 0.759155 test: 0.771525
max validation accuracy : 0.759155 max acc epoch : 5 test accuracy : 0.771525
Counter({1: 6437, 0: 4225})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  69.74661265313625 Time :  754
accuracy train: 0.833385 val: 0.747887 test: 0.770681
max validation accuracy : 0.759155 max acc epoch : 5 test accuracy : 0.771525
Counter({1: 6606, 0: 4056})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.07909272611141 Time :  769
accuracy train: 0.847609 val: 0.763380 test: 0.775464
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({0: 6634, 1: 4028})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.19385674595833 Time :  784
accuracy train: 0.865896 val: 0.759155 test: 0.774620
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({1: 6572, 0: 4090})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.897664308547974 Time :  798
accuracy train: 0.875586 val: 0.761972 test: 0.770118
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({1: 6641, 0: 4021})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.717125326395035 Time :  812
accuracy train: 0.865896 val: 0.752113 test: 0.774339
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({0: 6640, 1: 4022})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.94053637981415 Time :  826
accuracy train: 0.877618 val: 0.757746 test: 0.773495
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({0: 6642, 1: 4020})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.51632246375084 Time :  841
accuracy train: 0.885746 val: 0.754930 test: 0.772088
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({0: 6642, 1: 4020})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.74895188212395 Time :  856
accuracy train: 0.884651 val: 0.761972 test: 0.772369
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({1: 6616, 0: 4046})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.555832505226135 Time :  871
accuracy train: 0.887309 val: 0.749296 test: 0.769837
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({1: 6621, 0: 4041})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.70688645541668 Time :  886
accuracy train: 0.895749 val: 0.749296 test: 0.768993
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({0: 6609, 1: 4053})

Epoch :  16 loss training:  55.398763090372086 Time :  901
accuracy train: 0.893404 val: 0.761972 test: 0.768993
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({1: 6629, 0: 4033})

Epoch :  17 loss training:  53.98409026861191 Time :  915
accuracy train: 0.898562 val: 0.757746 test: 0.769274
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({1: 6599, 0: 4063})

Epoch :  18 loss training:  53.34019112586975 Time :  930
accuracy train: 0.902938 val: 0.756338 test: 0.768993
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({0: 6585, 1: 4077})

Epoch :  19 loss training:  51.42330759763718 Time :  944
accuracy train: 0.918256 val: 0.752113 test: 0.765616
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({1: 6585, 0: 4077})

Epoch :  20 loss training:  50.80066569149494 Time :  965
accuracy train: 0.921382 val: 0.750704 test: 0.769274
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({1: 6578, 0: 4084})

Epoch :  21 loss training:  48.46009520441294 Time :  980
accuracy train: 0.925289 val: 0.749296 test: 0.771244
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({0: 6567, 1: 4095})

Epoch :  22 loss training:  46.90106078982353 Time :  994
accuracy train: 0.927477 val: 0.740845 test: 0.772088
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({1: 6567, 0: 4095})

Epoch :  23 loss training:  44.61002530157566 Time :  1009
accuracy train: 0.936543 val: 0.747887 test: 0.772369
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({1: 6526, 0: 4136})

Epoch :  24 loss training:  44.594077952206135 Time :  1023
accuracy train: 0.942638 val: 0.739437 test: 0.763647
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({1: 6537, 0: 4125})

Epoch :  25 loss training:  41.77881008386612 Time :  1038
accuracy train: 0.948421 val: 0.742254 test: 0.767304
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({1: 6454, 0: 4208})

Epoch :  26 loss training:  40.22572581470013 Time :  1053
accuracy train: 0.953579 val: 0.750704 test: 0.770681
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({1: 6426, 0: 4236})

Epoch :  27 loss training:  38.95247433334589 Time :  1068
accuracy train: 0.955455 val: 0.745070 test: 0.769837
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({0: 6415, 1: 4247})

Epoch :  28 loss training:  37.849469885230064 Time :  1082
accuracy train: 0.958268 val: 0.747887 test: 0.766742
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({1: 6372, 0: 4290})

Epoch :  29 loss training:  36.63377448171377 Time :  1096
accuracy train: 0.961082 val: 0.747887 test: 0.766179
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({1: 6373, 0: 4289})

Epoch :  30 loss training:  35.755395866930485 Time :  1110
accuracy train: 0.969053 val: 0.756338 test: 0.769837
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({1: 6359, 0: 4303})

Epoch :  31 loss training:  33.300952307879925 Time :  1124
accuracy train: 0.967021 val: 0.747887 test: 0.763647
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({1: 6362, 0: 4300})

Epoch :  32 loss training:  31.544540032744408 Time :  1138
accuracy train: 0.974992 val: 0.761972 test: 0.769274
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({1: 6356, 0: 4306})

Epoch :  33 loss training:  31.638378344476223 Time :  1153
accuracy train: 0.977649 val: 0.750704 test: 0.768711
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({0: 6341, 1: 4321})

Epoch :  34 loss training:  29.93140871450305 Time :  1167
accuracy train: 0.979837 val: 0.756338 test: 0.766460
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({0: 6312, 1: 4350})

Epoch :  35 loss training:  28.279855355620384 Time :  1184
accuracy train: 0.982338 val: 0.752113 test: 0.769274
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({1: 6270, 0: 4392})

Epoch :  36 loss training:  27.385627705603838 Time :  1198
accuracy train: 0.983120 val: 0.753521 test: 0.771525
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({1: 6259, 0: 4403})

Epoch :  37 loss training:  26.692855816334486 Time :  1212
accuracy train: 0.986871 val: 0.746479 test: 0.768430
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({0: 6242, 1: 4420})

Epoch :  38 loss training:  25.689889382570982 Time :  1226
accuracy train: 0.986871 val: 0.754930 test: 0.770962
max validation accuracy : 0.763380 max acc epoch : 7 test accuracy : 0.775464
Counter({0: 6225, 1: 4437})

========================================================================================================================================================================================================
max acc epoch :  7
max validation accuracy :  0.7633802816901408
test accuracy :  0.7754642656162071
last test_accuracy :  0.770962296004502
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=657, weight_decay=0)
device :  cuda:0
Counter({0: 6243, 1: 4419})

Epoch :  1 loss training:  90.6262389421463 Time :  1244
accuracy train: 0.779150 val: 0.722535 test: 0.765335
max validation accuracy : 0.722535 max acc epoch : 1 test accuracy : 0.765335
Counter({0: 6510, 1: 4152})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.49536044895649 Time :  1258
accuracy train: 0.792435 val: 0.736620 test: 0.765335
max validation accuracy : 0.736620 max acc epoch : 2 test accuracy : 0.765335
Counter({1: 6005, 0: 4657})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.4157954454422 Time :  1271
accuracy train: 0.796812 val: 0.750704 test: 0.765898
max validation accuracy : 0.750704 max acc epoch : 3 test accuracy : 0.765898
Counter({1: 6102, 0: 4560})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.35578590631485 Time :  1294
accuracy train: 0.816661 val: 0.759155 test: 0.773495
max validation accuracy : 0.759155 max acc epoch : 4 test accuracy : 0.773495
Counter({1: 6287, 0: 4375})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.95017318427563 Time :  1309
accuracy train: 0.834323 val: 0.740845 test: 0.769555
max validation accuracy : 0.759155 max acc epoch : 4 test accuracy : 0.773495
Counter({0: 6480, 1: 4182})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.3827877342701 Time :  1322
accuracy train: 0.834948 val: 0.753521 test: 0.772088
max validation accuracy : 0.759155 max acc epoch : 4 test accuracy : 0.773495
Counter({0: 6768, 1: 3894})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.79939767718315 Time :  1336
accuracy train: 0.849172 val: 0.760563 test: 0.780248
max validation accuracy : 0.760563 max acc epoch : 7 test accuracy : 0.780248
Counter({1: 6989, 0: 3673})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.93285728991032 Time :  1350
accuracy train: 0.861519 val: 0.761972 test: 0.773495
max validation accuracy : 0.761972 max acc epoch : 8 test accuracy : 0.773495
Counter({0: 6919, 1: 3743})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.03386348485947 Time :  1364
accuracy train: 0.866521 val: 0.750704 test: 0.774339
max validation accuracy : 0.761972 max acc epoch : 8 test accuracy : 0.773495
Counter({0: 6985, 1: 3677})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.09771525859833 Time :  1378
accuracy train: 0.867146 val: 0.766197 test: 0.774339
max validation accuracy : 0.766197 max acc epoch : 10 test accuracy : 0.774339
Counter({1: 6954, 0: 3708})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  61.113992527127266 Time :  1392
accuracy train: 0.877149 val: 0.769014 test: 0.772088
max validation accuracy : 0.769014 max acc epoch : 11 test accuracy : 0.772088
Counter({0: 6943, 1: 3719})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  60.14424501359463 Time :  1407
accuracy train: 0.880431 val: 0.766197 test: 0.776871
max validation accuracy : 0.769014 max acc epoch : 11 test accuracy : 0.772088
Counter({0: 6933, 1: 3729})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  58.68066854774952 Time :  1421
accuracy train: 0.881525 val: 0.767606 test: 0.775464
max validation accuracy : 0.769014 max acc epoch : 11 test accuracy : 0.772088
Counter({0: 6911, 1: 3751})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  58.29948930442333 Time :  1434
accuracy train: 0.887934 val: 0.767606 test: 0.771806
max validation accuracy : 0.769014 max acc epoch : 11 test accuracy : 0.772088
Counter({0: 6926, 1: 3736})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  58.246625646948814 Time :  1448
accuracy train: 0.890278 val: 0.771831 test: 0.775464
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.775464
Counter({1: 6922, 0: 3740})

Epoch :  16 loss training:  56.816028505563736 Time :  1462
accuracy train: 0.891997 val: 0.774648 test: 0.769555
max validation accuracy : 0.774648 max acc epoch : 16 test accuracy : 0.769555
Counter({1: 6946, 0: 3716})

Epoch :  17 loss training:  55.289659291505814 Time :  1477
accuracy train: 0.896218 val: 0.771831 test: 0.771244
max validation accuracy : 0.774648 max acc epoch : 16 test accuracy : 0.769555
Counter({0: 6913, 1: 3749})

Epoch :  18 loss training:  54.453504517674446 Time :  1491
accuracy train: 0.902470 val: 0.773239 test: 0.768993
max validation accuracy : 0.774648 max acc epoch : 16 test accuracy : 0.769555
Counter({1: 6903, 0: 3759})

Epoch :  19 loss training:  52.674489215016365 Time :  1506
accuracy train: 0.914817 val: 0.774648 test: 0.771525
max validation accuracy : 0.774648 max acc epoch : 16 test accuracy : 0.769555
Counter({0: 6879, 1: 3783})

Epoch :  20 loss training:  51.91788476705551 Time :  1519
accuracy train: 0.918881 val: 0.780282 test: 0.769555
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.769555
Counter({1: 6880, 0: 3782})

Epoch :  21 loss training:  48.93906421214342 Time :  1533
accuracy train: 0.924351 val: 0.781690 test: 0.770681
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({1: 6868, 0: 3794})

Epoch :  22 loss training:  47.968828588724136 Time :  1547
accuracy train: 0.926852 val: 0.781690 test: 0.768149
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({0: 6879, 1: 3783})

Epoch :  23 loss training:  45.738041900098324 Time :  1561
accuracy train: 0.934980 val: 0.780282 test: 0.770962
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({0: 6844, 1: 3818})

Epoch :  24 loss training:  45.00603997707367 Time :  1576
accuracy train: 0.941701 val: 0.774648 test: 0.762240
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({0: 6867, 1: 3795})

Epoch :  25 loss training:  42.37529116123915 Time :  1590
accuracy train: 0.948578 val: 0.770423 test: 0.765616
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({1: 6831, 0: 3831})

Epoch :  26 loss training:  41.62769562751055 Time :  1604
accuracy train: 0.951078 val: 0.766197 test: 0.768430
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({1: 6796, 0: 3866})

Epoch :  27 loss training:  39.76554861664772 Time :  1627
accuracy train: 0.957174 val: 0.769014 test: 0.766742
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({0: 6799, 1: 3863})

Epoch :  28 loss training:  39.241166330873966 Time :  1642
accuracy train: 0.961707 val: 0.780282 test: 0.769555
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({1: 6808, 0: 3854})

Epoch :  29 loss training:  37.135784700512886 Time :  1657
accuracy train: 0.963426 val: 0.770423 test: 0.767867
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({1: 6795, 0: 3867})

Epoch :  30 loss training:  36.47009514272213 Time :  1673
accuracy train: 0.968115 val: 0.773239 test: 0.764491
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({1: 6791, 0: 3871})

Epoch :  31 loss training:  34.18934404850006 Time :  1687
accuracy train: 0.967802 val: 0.776056 test: 0.759707
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({0: 6784, 1: 3878})

Epoch :  32 loss training:  32.57609958946705 Time :  1700
accuracy train: 0.974054 val: 0.773239 test: 0.766742
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({1: 6770, 0: 3892})

Epoch :  33 loss training:  33.02093539386988 Time :  1714
accuracy train: 0.976243 val: 0.769014 test: 0.765053
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({0: 6771, 1: 3891})

Epoch :  34 loss training:  30.112231835722923 Time :  1729
accuracy train: 0.979369 val: 0.777465 test: 0.763928
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({1: 6733, 0: 3929})

Epoch :  35 loss training:  29.025860857218504 Time :  1743
accuracy train: 0.981869 val: 0.777465 test: 0.763365
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({1: 6754, 0: 3908})

Epoch :  36 loss training:  27.57287960126996 Time :  1757
accuracy train: 0.984214 val: 0.776056 test: 0.762240
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({0: 6740, 1: 3922})

Epoch :  37 loss training:  27.32674551010132 Time :  1771
accuracy train: 0.986871 val: 0.777465 test: 0.765053
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({0: 6752, 1: 3910})

Epoch :  38 loss training:  26.74172893539071 Time :  1785
accuracy train: 0.987965 val: 0.777465 test: 0.763365
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({1: 6753, 0: 3909})

Epoch :  39 loss training:  24.87920719012618 Time :  1799
accuracy train: 0.989841 val: 0.778873 test: 0.767023
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({1: 6738, 0: 3924})

Epoch :  40 loss training:  23.889774398878217 Time :  1813
accuracy train: 0.990935 val: 0.773239 test: 0.763365
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({0: 6752, 1: 3910})

Epoch :  41 loss training:  23.81980354897678 Time :  1827
accuracy train: 0.991716 val: 0.777465 test: 0.767586
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({0: 6678, 1: 3984})

Epoch :  42 loss training:  21.556320548057556 Time :  1850
accuracy train: 0.992498 val: 0.773239 test: 0.768149
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({0: 6567, 1: 4095})

Epoch :  43 loss training:  20.526602491736412 Time :  1864
accuracy train: 0.994842 val: 0.769014 test: 0.763084
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({1: 6551, 0: 4111})

Epoch :  44 loss training:  19.960576601326466 Time :  1878
accuracy train: 0.995624 val: 0.770423 test: 0.766460
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({1: 6548, 0: 4114})

Epoch :  45 loss training:  18.748865488916636 Time :  1892
accuracy train: 0.995936 val: 0.763380 test: 0.763365
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({0: 6488, 1: 4174})

Epoch :  46 loss training:  18.48148555867374 Time :  1908
accuracy train: 0.997499 val: 0.761972 test: 0.766460
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({1: 6489, 0: 4173})

Epoch :  47 loss training:  17.80193997733295 Time :  1922
accuracy train: 0.997030 val: 0.763380 test: 0.763365
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({0: 6473, 1: 4189})

Epoch :  48 loss training:  16.200272794812918 Time :  1936
accuracy train: 0.997187 val: 0.763380 test: 0.756612
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({1: 6431, 0: 4231})

Epoch :  49 loss training:  15.948794946074486 Time :  1952
accuracy train: 0.997968 val: 0.760563 test: 0.758582
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({0: 6397, 1: 4265})

Epoch :  50 loss training:  14.856934143230319 Time :  1969
accuracy train: 0.998281 val: 0.773239 test: 0.767304
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({0: 6291, 1: 4371})

Epoch :  51 loss training:  14.942652514204383 Time :  1985
accuracy train: 0.998593 val: 0.780282 test: 0.762240
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({0: 5915, 1: 4747})

Epoch :  52 loss training:  14.497958039864898 Time :  2000
accuracy train: 0.998750 val: 0.776056 test: 0.762802
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.770681
Counter({1: 5927, 0: 4735})

========================================================================================================================================================================================================
max acc epoch :  21
max validation accuracy :  0.7816901408450704
test accuracy :  0.7706809229037704
last test_accuracy :  0.7628024760832864
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=657, weight_decay=0)
device :  cuda:0
Counter({0: 6243, 1: 4419})

Epoch :  1 loss training:  90.81557136774063 Time :  2017
accuracy train: 0.777899 val: 0.719718 test: 0.760833
max validation accuracy : 0.719718 max acc epoch : 1 test accuracy : 0.760833
Counter({0: 6534, 1: 4128})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.60634435713291 Time :  2032
accuracy train: 0.794623 val: 0.735211 test: 0.764491
max validation accuracy : 0.735211 max acc epoch : 2 test accuracy : 0.764491
Counter({1: 5532, 0: 5130})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.27310961484909 Time :  2046
accuracy train: 0.791028 val: 0.747887 test: 0.766179
max validation accuracy : 0.747887 max acc epoch : 3 test accuracy : 0.766179
Counter({0: 5436, 1: 5226})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.80372773110867 Time :  2060
accuracy train: 0.814630 val: 0.742254 test: 0.771244
max validation accuracy : 0.747887 max acc epoch : 3 test accuracy : 0.766179
Counter({0: 6094, 1: 4568})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.5329321026802 Time :  2086
accuracy train: 0.829478 val: 0.750704 test: 0.776027
max validation accuracy : 0.750704 max acc epoch : 5 test accuracy : 0.776027
Counter({1: 6117, 0: 4545})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.51006186008453 Time :  2100
accuracy train: 0.831822 val: 0.753521 test: 0.772932
max validation accuracy : 0.753521 max acc epoch : 6 test accuracy : 0.772932
Counter({0: 6074, 1: 4588})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.80079743266106 Time :  2115
accuracy train: 0.846671 val: 0.756338 test: 0.769555
max validation accuracy : 0.756338 max acc epoch : 7 test accuracy : 0.769555
Counter({0: 6154, 1: 4508})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.42071022093296 Time :  2129
accuracy train: 0.851516 val: 0.747887 test: 0.772088
max validation accuracy : 0.756338 max acc epoch : 7 test accuracy : 0.769555
Counter({0: 6162, 1: 4500})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.10494670271873 Time :  2143
accuracy train: 0.870585 val: 0.761972 test: 0.773495
max validation accuracy : 0.761972 max acc epoch : 9 test accuracy : 0.773495
Counter({0: 6176, 1: 4486})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.121276780962944 Time :  2158
accuracy train: 0.860425 val: 0.763380 test: 0.779403
max validation accuracy : 0.763380 max acc epoch : 10 test accuracy : 0.779403
Counter({0: 6185, 1: 4477})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.97826011478901 Time :  2171
accuracy train: 0.872929 val: 0.769014 test: 0.776308
max validation accuracy : 0.769014 max acc epoch : 11 test accuracy : 0.776308
Counter({0: 6227, 1: 4435})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.92241029441357 Time :  2185
accuracy train: 0.876368 val: 0.757746 test: 0.778841
max validation accuracy : 0.769014 max acc epoch : 11 test accuracy : 0.776308
Counter({0: 6225, 1: 4437})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  59.31360965967178 Time :  2209
accuracy train: 0.880588 val: 0.763380 test: 0.777997
max validation accuracy : 0.769014 max acc epoch : 11 test accuracy : 0.776308
Counter({1: 6293, 0: 4369})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  58.94639293849468 Time :  2222
accuracy train: 0.881994 val: 0.763380 test: 0.774620
max validation accuracy : 0.769014 max acc epoch : 11 test accuracy : 0.776308
Counter({1: 6277, 0: 4385})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  57.40934194624424 Time :  2237
accuracy train: 0.888559 val: 0.771831 test: 0.772651
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.772651
Counter({0: 6298, 1: 4364})

Epoch :  16 loss training:  56.96334281563759 Time :  2251
accuracy train: 0.887465 val: 0.763380 test: 0.770962
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.772651
Counter({1: 6339, 0: 4323})

Epoch :  17 loss training:  54.896043330430984 Time :  2266
accuracy train: 0.892310 val: 0.767606 test: 0.770118
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.772651
Counter({0: 6372, 1: 4290})

Epoch :  18 loss training:  54.59916877746582 Time :  2280
accuracy train: 0.901532 val: 0.773239 test: 0.772932
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({0: 6411, 1: 4251})

Epoch :  19 loss training:  52.20859421789646 Time :  2295
accuracy train: 0.913098 val: 0.759155 test: 0.771244
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({0: 6412, 1: 4250})

Epoch :  20 loss training:  51.18948324024677 Time :  2307
accuracy train: 0.917631 val: 0.760563 test: 0.772369
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({0: 6422, 1: 4240})

Epoch :  21 loss training:  49.724189937114716 Time :  2328
accuracy train: 0.920756 val: 0.759155 test: 0.771806
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({0: 6428, 1: 4234})

Epoch :  22 loss training:  48.783065646886826 Time :  2343
accuracy train: 0.927946 val: 0.766197 test: 0.768993
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({0: 6435, 1: 4227})

Epoch :  23 loss training:  45.614710837602615 Time :  2359
accuracy train: 0.930916 val: 0.764789 test: 0.770681
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({0: 6504, 1: 4158})

Epoch :  24 loss training:  45.5866014957428 Time :  2373
accuracy train: 0.934667 val: 0.756338 test: 0.771244
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({0: 6507, 1: 4155})

Epoch :  25 loss training:  43.24920370429754 Time :  2387
accuracy train: 0.946546 val: 0.769014 test: 0.771525
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({0: 6543, 1: 4119})

Epoch :  26 loss training:  41.44629353284836 Time :  2402
accuracy train: 0.948421 val: 0.763380 test: 0.771525
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({0: 6552, 1: 4110})

Epoch :  27 loss training:  40.22760136425495 Time :  2416
accuracy train: 0.956549 val: 0.759155 test: 0.774902
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({0: 6544, 1: 4118})

Epoch :  28 loss training:  39.75082615762949 Time :  2430
accuracy train: 0.956393 val: 0.756338 test: 0.774902
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({0: 6548, 1: 4114})

Epoch :  29 loss training:  37.6374152302742 Time :  2447
accuracy train: 0.955455 val: 0.754930 test: 0.769837
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({1: 6561, 0: 4101})

Epoch :  30 loss training:  37.057955004274845 Time :  2461
accuracy train: 0.964051 val: 0.767606 test: 0.770118
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({1: 6567, 0: 4095})

Epoch :  31 loss training:  35.04365448653698 Time :  2476
accuracy train: 0.963895 val: 0.766197 test: 0.769274
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({0: 6579, 1: 4083})

Epoch :  32 loss training:  32.77272355556488 Time :  2490
accuracy train: 0.969365 val: 0.763380 test: 0.769555
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({0: 6553, 1: 4109})

Epoch :  33 loss training:  33.11428748071194 Time :  2504
accuracy train: 0.972491 val: 0.764789 test: 0.769837
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({0: 6592, 1: 4070})

Epoch :  34 loss training:  30.861913204193115 Time :  2519
accuracy train: 0.977493 val: 0.759155 test: 0.770400
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({0: 6610, 1: 4052})

Epoch :  35 loss training:  29.536153487861156 Time :  2533
accuracy train: 0.978743 val: 0.764789 test: 0.769555
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({0: 6582, 1: 4080})

Epoch :  36 loss training:  28.32277672737837 Time :  2549
accuracy train: 0.983120 val: 0.759155 test: 0.770400
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({0: 6579, 1: 4083})

Epoch :  37 loss training:  27.65652474015951 Time :  2563
accuracy train: 0.983745 val: 0.760563 test: 0.769274
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({1: 6583, 0: 4079})

Epoch :  38 loss training:  25.503036350011826 Time :  2578
accuracy train: 0.985933 val: 0.767606 test: 0.766460
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({0: 6582, 1: 4080})

Epoch :  39 loss training:  25.298528464511037 Time :  2592
accuracy train: 0.987340 val: 0.760563 test: 0.766460
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({1: 6586, 0: 4076})

Epoch :  40 loss training:  23.515589244663715 Time :  2607
accuracy train: 0.989215 val: 0.764789 test: 0.765616
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({1: 6579, 0: 4083})

Epoch :  41 loss training:  23.414004188030958 Time :  2621
accuracy train: 0.990153 val: 0.763380 test: 0.765898
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({0: 6556, 1: 4106})

Epoch :  42 loss training:  21.04375983774662 Time :  2635
accuracy train: 0.990622 val: 0.761972 test: 0.768993
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({0: 6544, 1: 4118})

Epoch :  43 loss training:  21.567067746073008 Time :  2650
accuracy train: 0.993279 val: 0.761972 test: 0.766460
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({0: 6569, 1: 4093})

Epoch :  44 loss training:  19.936220470815897 Time :  2671
accuracy train: 0.993748 val: 0.756338 test: 0.767867
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({0: 6567, 1: 4095})

Epoch :  45 loss training:  18.862571880221367 Time :  2685
accuracy train: 0.994998 val: 0.760563 test: 0.765616
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({1: 6574, 0: 4088})

Epoch :  46 loss training:  18.56108769029379 Time :  2699
accuracy train: 0.995311 val: 0.756338 test: 0.766179
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({0: 6577, 1: 4085})

Epoch :  47 loss training:  18.32316417247057 Time :  2714
accuracy train: 0.995467 val: 0.757746 test: 0.764772
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({1: 6563, 0: 4099})

Epoch :  48 loss training:  16.658521739766 Time :  2728
accuracy train: 0.997030 val: 0.746479 test: 0.760551
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({0: 6567, 1: 4095})

Epoch :  49 loss training:  16.383484534919262 Time :  2743
accuracy train: 0.998124 val: 0.764789 test: 0.763928
max validation accuracy : 0.773239 max acc epoch : 18 test accuracy : 0.772932
Counter({1: 6562, 0: 4100})

========================================================================================================================================================================================================
max acc epoch :  18
max validation accuracy :  0.7732394366197183
test accuracy :  0.772931907709623
last test_accuracy :  0.7639279684862127
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=657, weight_decay=0)
device :  cuda:0
Counter({0: 6243, 1: 4419})

Epoch :  1 loss training:  90.54736107587814 Time :  2761
accuracy train: 0.775711 val: 0.704225 test: 0.758301
max validation accuracy : 0.704225 max acc epoch : 1 test accuracy : 0.758301
Counter({0: 6464, 1: 4198})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.82952255010605 Time :  2777
accuracy train: 0.788215 val: 0.725352 test: 0.758863
max validation accuracy : 0.725352 max acc epoch : 2 test accuracy : 0.758863
Counter({0: 5425, 1: 5237})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.20843973755836 Time :  2791
accuracy train: 0.803532 val: 0.743662 test: 0.770118
max validation accuracy : 0.743662 max acc epoch : 3 test accuracy : 0.770118
Counter({1: 6065, 0: 4597})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.16950178146362 Time :  2805
accuracy train: 0.816818 val: 0.750704 test: 0.769555
max validation accuracy : 0.750704 max acc epoch : 4 test accuracy : 0.769555
Counter({0: 6137, 1: 4525})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  70.92962127923965 Time :  2820
accuracy train: 0.840575 val: 0.749296 test: 0.774620
max validation accuracy : 0.750704 max acc epoch : 4 test accuracy : 0.769555
Counter({0: 6205, 1: 4457})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  69.19731479883194 Time :  2835
accuracy train: 0.829009 val: 0.747887 test: 0.768711
max validation accuracy : 0.750704 max acc epoch : 4 test accuracy : 0.769555
Counter({0: 6304, 1: 4358})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.2737390100956 Time :  2851
accuracy train: 0.839325 val: 0.747887 test: 0.773776
max validation accuracy : 0.750704 max acc epoch : 4 test accuracy : 0.769555
Counter({1: 6320, 0: 4342})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.32848180830479 Time :  2865
accuracy train: 0.868553 val: 0.770423 test: 0.776027
max validation accuracy : 0.770423 max acc epoch : 8 test accuracy : 0.776027
Counter({0: 6255, 1: 4407})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.92465263605118 Time :  2879
accuracy train: 0.871835 val: 0.766197 test: 0.774902
max validation accuracy : 0.770423 max acc epoch : 8 test accuracy : 0.776027
Counter({0: 6254, 1: 4408})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.70118705928326 Time :  2899
accuracy train: 0.863551 val: 0.747887 test: 0.773776
max validation accuracy : 0.770423 max acc epoch : 8 test accuracy : 0.776027
Counter({0: 6228, 1: 4434})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.91175892949104 Time :  2913
accuracy train: 0.876055 val: 0.760563 test: 0.770400
max validation accuracy : 0.770423 max acc epoch : 8 test accuracy : 0.776027
Counter({0: 6219, 1: 4443})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.77793863415718 Time :  2928
accuracy train: 0.886683 val: 0.756338 test: 0.772651
max validation accuracy : 0.770423 max acc epoch : 8 test accuracy : 0.776027
Counter({1: 6164, 0: 4498})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.69452365487814 Time :  2942
accuracy train: 0.887465 val: 0.760563 test: 0.773495
max validation accuracy : 0.770423 max acc epoch : 8 test accuracy : 0.776027
Counter({1: 6157, 0: 4505})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.93314714729786 Time :  2956
accuracy train: 0.887465 val: 0.761972 test: 0.772651
max validation accuracy : 0.770423 max acc epoch : 8 test accuracy : 0.776027
Counter({1: 6160, 0: 4502})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.50154900550842 Time :  2970
accuracy train: 0.896999 val: 0.767606 test: 0.773213
max validation accuracy : 0.770423 max acc epoch : 8 test accuracy : 0.776027
Counter({0: 6170, 1: 4492})

Epoch :  16 loss training:  55.17112937569618 Time :  2985
accuracy train: 0.894186 val: 0.767606 test: 0.768993
max validation accuracy : 0.770423 max acc epoch : 8 test accuracy : 0.776027
Counter({0: 6170, 1: 4492})

Epoch :  17 loss training:  54.389686182141304 Time :  3001
accuracy train: 0.896374 val: 0.767606 test: 0.767867
max validation accuracy : 0.770423 max acc epoch : 8 test accuracy : 0.776027
Counter({1: 6145, 0: 4517})

Epoch :  18 loss training:  53.69949780404568 Time :  3019
accuracy train: 0.906690 val: 0.776056 test: 0.770400
max validation accuracy : 0.776056 max acc epoch : 18 test accuracy : 0.770400
Counter({1: 6145, 0: 4517})

Epoch :  19 loss training:  50.89843064546585 Time :  3033
accuracy train: 0.920600 val: 0.774648 test: 0.769274
max validation accuracy : 0.776056 max acc epoch : 18 test accuracy : 0.770400
Counter({1: 6128, 0: 4534})

Epoch :  20 loss training:  50.86244413256645 Time :  3047
accuracy train: 0.923101 val: 0.771831 test: 0.773213
max validation accuracy : 0.776056 max acc epoch : 18 test accuracy : 0.770400
Counter({1: 6125, 0: 4537})

Epoch :  21 loss training:  48.25529595464468 Time :  3062
accuracy train: 0.926696 val: 0.773239 test: 0.772651
max validation accuracy : 0.776056 max acc epoch : 18 test accuracy : 0.770400
Counter({1: 6099, 0: 4563})

Epoch :  22 loss training:  47.46603426337242 Time :  3076
accuracy train: 0.934354 val: 0.777465 test: 0.770962
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.770962
Counter({1: 6104, 0: 4558})

Epoch :  23 loss training:  44.826879531145096 Time :  3091
accuracy train: 0.939825 val: 0.769014 test: 0.770118
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.770962
Counter({1: 6094, 0: 4568})

Epoch :  24 loss training:  44.94880557060242 Time :  3106
accuracy train: 0.942638 val: 0.764789 test: 0.768993
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.770962
Counter({0: 6093, 1: 4569})

Epoch :  25 loss training:  42.338200740516186 Time :  3126
accuracy train: 0.947796 val: 0.771831 test: 0.768711
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.770962
Counter({1: 6046, 0: 4616})

Epoch :  26 loss training:  40.767260782420635 Time :  3140
accuracy train: 0.953579 val: 0.773239 test: 0.768149
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.770962
Counter({1: 6015, 0: 4647})

Epoch :  27 loss training:  39.244903802871704 Time :  3155
accuracy train: 0.960613 val: 0.770423 test: 0.767304
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.770962
Counter({1: 6005, 0: 4657})

Epoch :  28 loss training:  37.883029229938984 Time :  3170
accuracy train: 0.960613 val: 0.774648 test: 0.768430
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.770962
Counter({0: 6001, 1: 4661})

Epoch :  29 loss training:  36.32175935059786 Time :  3185
accuracy train: 0.963426 val: 0.769014 test: 0.768993
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.770962
Counter({0: 5988, 1: 4674})

Epoch :  30 loss training:  36.295371271669865 Time :  3199
accuracy train: 0.970460 val: 0.776056 test: 0.771806
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.770962
Counter({1: 5994, 0: 4668})

Epoch :  31 loss training:  33.35049645230174 Time :  3214
accuracy train: 0.970616 val: 0.770423 test: 0.768149
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.770962
Counter({0: 6000, 1: 4662})

Epoch :  32 loss training:  32.031840082257986 Time :  3228
accuracy train: 0.975305 val: 0.771831 test: 0.770400
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.770962
Counter({0: 5998, 1: 4664})

Epoch :  33 loss training:  32.04776334017515 Time :  3249
accuracy train: 0.980775 val: 0.767606 test: 0.766179
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.770962
Counter({0: 5992, 1: 4670})

Epoch :  34 loss training:  30.223592590540648 Time :  3263
accuracy train: 0.981557 val: 0.769014 test: 0.765616
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.770962
Counter({1: 6000, 0: 4662})

Epoch :  35 loss training:  27.878037840127945 Time :  3278
accuracy train: 0.982338 val: 0.769014 test: 0.770118
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.770962
Counter({0: 5990, 1: 4672})

Epoch :  36 loss training:  27.201593980193138 Time :  3293
accuracy train: 0.983745 val: 0.774648 test: 0.768993
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.770962
Counter({0: 5983, 1: 4679})

Epoch :  37 loss training:  26.92161375284195 Time :  3308
accuracy train: 0.985777 val: 0.767606 test: 0.766742
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.770962
Counter({1: 5938, 0: 4724})

Epoch :  38 loss training:  25.89113539084792 Time :  3322
accuracy train: 0.989372 val: 0.778873 test: 0.766460
max validation accuracy : 0.778873 max acc epoch : 38 test accuracy : 0.766460
Counter({0: 5919, 1: 4743})

Epoch :  39 loss training:  24.185685547068715 Time :  3337
accuracy train: 0.989841 val: 0.774648 test: 0.766179
max validation accuracy : 0.778873 max acc epoch : 38 test accuracy : 0.766460
Counter({0: 5870, 1: 4792})

Epoch :  40 loss training:  23.073375219479203 Time :  3352
accuracy train: 0.989528 val: 0.774648 test: 0.759145
max validation accuracy : 0.778873 max acc epoch : 38 test accuracy : 0.766460
Counter({0: 5879, 1: 4783})

Epoch :  41 loss training:  23.47173747420311 Time :  3377
accuracy train: 0.991872 val: 0.773239 test: 0.766460
max validation accuracy : 0.778873 max acc epoch : 38 test accuracy : 0.766460
Counter({0: 5872, 1: 4790})

Epoch :  42 loss training:  20.742737662047148 Time :  3392
accuracy train: 0.991716 val: 0.780282 test: 0.768430
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({1: 5839, 0: 4823})

Epoch :  43 loss training:  20.630805771797895 Time :  3406
accuracy train: 0.994217 val: 0.771831 test: 0.763084
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({1: 5845, 0: 4817})

Epoch :  44 loss training:  19.848928133025765 Time :  3421
accuracy train: 0.995311 val: 0.769014 test: 0.765616
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({0: 5845, 1: 4817})

Epoch :  45 loss training:  18.45898107998073 Time :  3435
accuracy train: 0.994998 val: 0.764789 test: 0.762521
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({0: 5866, 1: 4796})

Epoch :  46 loss training:  18.057346902787685 Time :  3449
accuracy train: 0.995624 val: 0.759155 test: 0.762802
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({1: 5864, 0: 4798})

Epoch :  47 loss training:  17.33881640434265 Time :  3463
accuracy train: 0.996093 val: 0.770423 test: 0.763365
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({1: 5855, 0: 4807})

Epoch :  48 loss training:  16.297078667208552 Time :  3482
accuracy train: 0.995155 val: 0.766197 test: 0.759426
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({0: 5858, 1: 4804})

Epoch :  49 loss training:  15.923013707622886 Time :  3496
accuracy train: 0.997343 val: 0.764789 test: 0.759707
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({0: 5841, 1: 4821})

Epoch :  50 loss training:  14.922501871362329 Time :  3510
accuracy train: 0.997812 val: 0.776056 test: 0.767023
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({1: 5843, 0: 4819})

Epoch :  51 loss training:  14.71697448566556 Time :  3524
accuracy train: 0.998593 val: 0.767606 test: 0.760833
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({1: 5818, 0: 4844})

Epoch :  52 loss training:  14.976376843638718 Time :  3539
accuracy train: 0.998437 val: 0.769014 test: 0.760551
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({1: 5815, 0: 4847})

Epoch :  53 loss training:  13.548311607912183 Time :  3553
accuracy train: 0.998750 val: 0.763380 test: 0.759707
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({0: 5808, 1: 4854})

Epoch :  54 loss training:  14.464447631500661 Time :  3568
accuracy train: 0.998593 val: 0.770423 test: 0.758301
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({1: 5799, 0: 4863})

Epoch :  55 loss training:  12.8182701645419 Time :  3582
accuracy train: 0.999219 val: 0.764789 test: 0.758019
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({1: 5787, 0: 4875})

Epoch :  56 loss training:  11.534226393327117 Time :  3606
accuracy train: 0.999375 val: 0.773239 test: 0.764209
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({1: 5661, 0: 5001})

Epoch :  57 loss training:  11.053713751025498 Time :  3621
accuracy train: 0.998906 val: 0.773239 test: 0.760551
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({1: 5680, 0: 4982})

Epoch :  58 loss training:  11.225933343172073 Time :  3634
accuracy train: 0.998906 val: 0.761972 test: 0.755768
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({1: 5694, 0: 4968})

Epoch :  59 loss training:  10.659808799624443 Time :  3649
accuracy train: 0.999687 val: 0.766197 test: 0.757175
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({0: 5698, 1: 4964})

Epoch :  60 loss training:  9.86579397181049 Time :  3664
accuracy train: 0.999375 val: 0.767606 test: 0.760833
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({1: 5682, 0: 4980})

Epoch :  61 loss training:  9.76625175634399 Time :  3677
accuracy train: 0.999219 val: 0.770423 test: 0.762521
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({1: 5680, 0: 4982})

Epoch :  62 loss training:  8.97502966504544 Time :  3691
accuracy train: 0.999375 val: 0.774648 test: 0.759426
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({0: 5665, 1: 4997})

Epoch :  63 loss training:  10.186225787736475 Time :  3705
accuracy train: 0.999687 val: 0.763380 test: 0.763084
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({0: 5650, 1: 5012})

Epoch :  64 loss training:  9.224293146515265 Time :  3729
accuracy train: 0.999375 val: 0.764789 test: 0.753517
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({1: 5584, 0: 5078})

Epoch :  65 loss training:  8.195477641187608 Time :  3743
accuracy train: 0.999687 val: 0.764789 test: 0.756612
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({1: 5576, 0: 5086})

Epoch :  66 loss training:  7.595716357696801 Time :  3757
accuracy train: 1.000000 val: 0.761972 test: 0.757738
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({0: 5551, 1: 5111})

Epoch :  67 loss training:  7.367720347945578 Time :  3772
accuracy train: 1.000000 val: 0.757746 test: 0.750422
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({1: 5570, 0: 5092})

Epoch :  68 loss training:  6.99351839045994 Time :  3786
accuracy train: 1.000000 val: 0.770423 test: 0.759426
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({1: 5548, 0: 5114})

Epoch :  69 loss training:  6.861795882927254 Time :  3800
accuracy train: 1.000000 val: 0.771831 test: 0.751829
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({0: 5539, 1: 5123})

Epoch :  70 loss training:  6.924677336122841 Time :  3815
accuracy train: 1.000000 val: 0.767606 test: 0.759145
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({1: 5519, 0: 5143})

Epoch :  71 loss training:  6.905446202959865 Time :  3831
accuracy train: 1.000000 val: 0.766197 test: 0.757456
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({1: 5528, 0: 5134})

Epoch :  72 loss training:  6.072254822589457 Time :  3846
accuracy train: 1.000000 val: 0.764789 test: 0.760270
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({0: 5523, 1: 5139})

Epoch :  73 loss training:  5.582698445301503 Time :  3860
accuracy train: 1.000000 val: 0.763380 test: 0.757738
max validation accuracy : 0.780282 max acc epoch : 42 test accuracy : 0.768430
Counter({1: 5510, 0: 5152})

========================================================================================================================================================================================================
max acc epoch :  42
max validation accuracy :  0.780281690140845
test accuracy :  0.7684299380979178
last test_accuracy :  0.7577377602701182
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=657, weight_decay=0)
device :  cuda:0
Counter({0: 6243, 1: 4419})

Epoch :  1 loss training:  90.7311133146286 Time :  3878
accuracy train: 0.776649 val: 0.715493 test: 0.761114
max validation accuracy : 0.715493 max acc epoch : 1 test accuracy : 0.761114
Counter({1: 6303, 0: 4359})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.12996220588684 Time :  3892
accuracy train: 0.798062 val: 0.749296 test: 0.766742
max validation accuracy : 0.749296 max acc epoch : 2 test accuracy : 0.766742
Counter({1: 5727, 0: 4935})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.01291862130165 Time :  3906
accuracy train: 0.801500 val: 0.746479 test: 0.763928
max validation accuracy : 0.749296 max acc epoch : 2 test accuracy : 0.766742
Counter({0: 5756, 1: 4906})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.43370540440083 Time :  3921
accuracy train: 0.815255 val: 0.745070 test: 0.767586
max validation accuracy : 0.749296 max acc epoch : 2 test accuracy : 0.766742
Counter({0: 5603, 1: 5059})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  70.91496689617634 Time :  3935
accuracy train: 0.834636 val: 0.740845 test: 0.766460
max validation accuracy : 0.749296 max acc epoch : 2 test accuracy : 0.766742
Counter({1: 5679, 0: 4983})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  69.11281734704971 Time :  3959
accuracy train: 0.833698 val: 0.745070 test: 0.765053
max validation accuracy : 0.749296 max acc epoch : 2 test accuracy : 0.766742
Counter({1: 5773, 0: 4889})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  65.73835079371929 Time :  3974
accuracy train: 0.844014 val: 0.750704 test: 0.770681
max validation accuracy : 0.750704 max acc epoch : 7 test accuracy : 0.770681
Counter({0: 5705, 1: 4957})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.22101578116417 Time :  3989
accuracy train: 0.865114 val: 0.753521 test: 0.776027
max validation accuracy : 0.753521 max acc epoch : 8 test accuracy : 0.776027
Counter({0: 5749, 1: 4913})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.681067764759064 Time :  4004
accuracy train: 0.874961 val: 0.763380 test: 0.771244
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({0: 5715, 1: 4947})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.76296325027943 Time :  4020
accuracy train: 0.860738 val: 0.757746 test: 0.770400
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({0: 5648, 1: 5014})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.46093665063381 Time :  4034
accuracy train: 0.879962 val: 0.754930 test: 0.773495
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 5621, 0: 5041})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  57.941877737641335 Time :  4049
accuracy train: 0.880744 val: 0.759155 test: 0.772651
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 5571, 0: 5091})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.319081500172615 Time :  4063
accuracy train: 0.883088 val: 0.754930 test: 0.773213
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 5557, 0: 5105})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.039008155465126 Time :  4087
accuracy train: 0.886371 val: 0.754930 test: 0.769555
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 5558, 0: 5104})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.044552102684975 Time :  4102
accuracy train: 0.894811 val: 0.757746 test: 0.774339
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({0: 5559, 1: 5103})

Epoch :  16 loss training:  54.78871065378189 Time :  4114
accuracy train: 0.883557 val: 0.743662 test: 0.762802
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 5492, 0: 5170})

Epoch :  17 loss training:  53.473101541399956 Time :  4129
accuracy train: 0.891841 val: 0.759155 test: 0.767304
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 5481, 0: 5181})

Epoch :  18 loss training:  52.67958238720894 Time :  4144
accuracy train: 0.902470 val: 0.757746 test: 0.767867
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 5397, 0: 5265})

Epoch :  19 loss training:  50.826688289642334 Time :  4159
accuracy train: 0.920131 val: 0.761972 test: 0.771244
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 5392, 0: 5270})

Epoch :  20 loss training:  50.147055611014366 Time :  4174
accuracy train: 0.918568 val: 0.757746 test: 0.767586
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 5384, 0: 5278})

Epoch :  21 loss training:  47.574084773659706 Time :  4191
accuracy train: 0.926696 val: 0.757746 test: 0.771806
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 5380, 0: 5282})

Epoch :  22 loss training:  47.05661468207836 Time :  4208
accuracy train: 0.922945 val: 0.750704 test: 0.767586
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({0: 5369, 1: 5293})

Epoch :  23 loss training:  44.48117882758379 Time :  4223
accuracy train: 0.934980 val: 0.749296 test: 0.768149
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({0: 5332, 1: 5330})

Epoch :  24 loss training:  44.09988549351692 Time :  4237
accuracy train: 0.935292 val: 0.745070 test: 0.762802
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 5369, 0: 5293})

Epoch :  25 loss training:  41.684630773961544 Time :  4252
accuracy train: 0.946389 val: 0.750704 test: 0.765335
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({0: 5432, 1: 5230})

Epoch :  26 loss training:  40.83750744909048 Time :  4267
accuracy train: 0.950610 val: 0.756338 test: 0.770118
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 5454, 0: 5208})

Epoch :  27 loss training:  39.17076086252928 Time :  4281
accuracy train: 0.954673 val: 0.745070 test: 0.767867
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({0: 5454, 1: 5208})

Epoch :  28 loss training:  38.66865051537752 Time :  4296
accuracy train: 0.952641 val: 0.752113 test: 0.766742
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({0: 5458, 1: 5204})

Epoch :  29 loss training:  36.50948030501604 Time :  4321
accuracy train: 0.957956 val: 0.742254 test: 0.766179
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({0: 5465, 1: 5197})

Epoch :  30 loss training:  36.055665738880634 Time :  4335
accuracy train: 0.962332 val: 0.749296 test: 0.765616
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({0: 5471, 1: 5191})

Epoch :  31 loss training:  33.790792502462864 Time :  4350
accuracy train: 0.961394 val: 0.750704 test: 0.759989
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({0: 5485, 1: 5177})

Epoch :  32 loss training:  32.3710233643651 Time :  4364
accuracy train: 0.970147 val: 0.756338 test: 0.766460
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({0: 5495, 1: 5167})

Epoch :  33 loss training:  33.25550927221775 Time :  4379
accuracy train: 0.974836 val: 0.753521 test: 0.764491
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 5509, 0: 5153})

Epoch :  34 loss training:  30.32256618142128 Time :  4392
accuracy train: 0.978587 val: 0.756338 test: 0.762521
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({0: 5566, 1: 5096})

Epoch :  35 loss training:  28.37170497328043 Time :  4407
accuracy train: 0.979212 val: 0.745070 test: 0.761396
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({0: 5558, 1: 5104})

Epoch :  36 loss training:  27.947412721812725 Time :  4422
accuracy train: 0.981713 val: 0.749296 test: 0.764209
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({0: 5572, 1: 5090})

Epoch :  37 loss training:  27.33187048882246 Time :  4446
accuracy train: 0.982807 val: 0.753521 test: 0.760833
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({0: 5574, 1: 5088})

Epoch :  38 loss training:  26.17954497784376 Time :  4461
accuracy train: 0.984683 val: 0.761972 test: 0.760833
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 5581, 0: 5081})

Epoch :  39 loss training:  24.874003626406193 Time :  4474
accuracy train: 0.987809 val: 0.749296 test: 0.758863
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({1: 5641, 0: 5021})

Epoch :  40 loss training:  23.442103223875165 Time :  4489
accuracy train: 0.988278 val: 0.745070 test: 0.756894
max validation accuracy : 0.763380 max acc epoch : 9 test accuracy : 0.771244
Counter({0: 5646, 1: 5016})

========================================================================================================================================================================================================
max acc epoch :  9
max validation accuracy :  0.7633802816901408
test accuracy :  0.7712436691052336
last test_accuracy :  0.7568936409679234
========================================================================================================================================================================================================

itr : 6
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=657, weight_decay=0)
device :  cuda:0
Counter({0: 6243, 1: 4419})

Epoch :  1 loss training:  90.67887592315674 Time :  4506
accuracy train: 0.772585 val: 0.711268 test: 0.759707
max validation accuracy : 0.711268 max acc epoch : 1 test accuracy : 0.759707
Counter({0: 6528, 1: 4134})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.19448994100094 Time :  4520
accuracy train: 0.790091 val: 0.729577 test: 0.763647
max validation accuracy : 0.729577 max acc epoch : 2 test accuracy : 0.763647
Counter({0: 5542, 1: 5120})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.97304272651672 Time :  4535
accuracy train: 0.795874 val: 0.753521 test: 0.769555
max validation accuracy : 0.753521 max acc epoch : 3 test accuracy : 0.769555
Counter({1: 5919, 0: 4743})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.87302835285664 Time :  4551
accuracy train: 0.814317 val: 0.753521 test: 0.774339
max validation accuracy : 0.753521 max acc epoch : 3 test accuracy : 0.769555
Counter({0: 6075, 1: 4587})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.39191100001335 Time :  4570
accuracy train: 0.832760 val: 0.746479 test: 0.777715
max validation accuracy : 0.753521 max acc epoch : 3 test accuracy : 0.769555
Counter({0: 6208, 1: 4454})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  69.44770854711533 Time :  4584
accuracy train: 0.840419 val: 0.753521 test: 0.772088
max validation accuracy : 0.753521 max acc epoch : 3 test accuracy : 0.769555
Counter({1: 6212, 0: 4450})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.33030299842358 Time :  4598
accuracy train: 0.845889 val: 0.754930 test: 0.772651
max validation accuracy : 0.754930 max acc epoch : 7 test accuracy : 0.772651
Counter({1: 6260, 0: 4402})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.52761945128441 Time :  4612
accuracy train: 0.865114 val: 0.766197 test: 0.774902
max validation accuracy : 0.766197 max acc epoch : 8 test accuracy : 0.774902
Counter({1: 6182, 0: 4480})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.63616581261158 Time :  4627
accuracy train: 0.875899 val: 0.770423 test: 0.770400
max validation accuracy : 0.770423 max acc epoch : 9 test accuracy : 0.770400
Counter({0: 6270, 1: 4392})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.05784185230732 Time :  4641
accuracy train: 0.865896 val: 0.763380 test: 0.769555
max validation accuracy : 0.770423 max acc epoch : 9 test accuracy : 0.770400
Counter({0: 6277, 1: 4385})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.92586073279381 Time :  4656
accuracy train: 0.877774 val: 0.770423 test: 0.775746
max validation accuracy : 0.770423 max acc epoch : 9 test accuracy : 0.770400
Counter({0: 6298, 1: 4364})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.40063637495041 Time :  4673
accuracy train: 0.885746 val: 0.766197 test: 0.774902
max validation accuracy : 0.770423 max acc epoch : 9 test accuracy : 0.770400
Counter({0: 6308, 1: 4354})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  58.49253334105015 Time :  4688
accuracy train: 0.882620 val: 0.770423 test: 0.771806
max validation accuracy : 0.770423 max acc epoch : 9 test accuracy : 0.770400
Counter({1: 6332, 0: 4330})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  58.610102862119675 Time :  4702
accuracy train: 0.889809 val: 0.774648 test: 0.773495
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({0: 6337, 1: 4325})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  57.74295274913311 Time :  4716
accuracy train: 0.895123 val: 0.767606 test: 0.775464
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({0: 6331, 1: 4331})

Epoch :  16 loss training:  56.3563296943903 Time :  4731
accuracy train: 0.891372 val: 0.760563 test: 0.763647
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({0: 6351, 1: 4311})

Epoch :  17 loss training:  55.247729912400246 Time :  4746
accuracy train: 0.897781 val: 0.770423 test: 0.770962
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({1: 6329, 0: 4333})

Epoch :  18 loss training:  54.36680783331394 Time :  4759
accuracy train: 0.904501 val: 0.774648 test: 0.770681
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({1: 6348, 0: 4314})

Epoch :  19 loss training:  51.99913239479065 Time :  4774
accuracy train: 0.919193 val: 0.761972 test: 0.778278
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({0: 6362, 1: 4300})

Epoch :  20 loss training:  51.49125549197197 Time :  4791
accuracy train: 0.919662 val: 0.766197 test: 0.774620
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({0: 6371, 1: 4291})

Epoch :  21 loss training:  49.08494472503662 Time :  4807
accuracy train: 0.923570 val: 0.767606 test: 0.776871
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({0: 6365, 1: 4297})

Epoch :  22 loss training:  48.086073115468025 Time :  4821
accuracy train: 0.929197 val: 0.763380 test: 0.772369
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({1: 6374, 0: 4288})

Epoch :  23 loss training:  45.772752061486244 Time :  4837
accuracy train: 0.935449 val: 0.764789 test: 0.773776
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({1: 6384, 0: 4278})

Epoch :  24 loss training:  45.769666731357574 Time :  4852
accuracy train: 0.938106 val: 0.769014 test: 0.769274
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({1: 6410, 0: 4252})

Epoch :  25 loss training:  42.993977800011635 Time :  4866
accuracy train: 0.947640 val: 0.767606 test: 0.772369
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({0: 6364, 1: 4298})

Epoch :  26 loss training:  41.21389602124691 Time :  4880
accuracy train: 0.951547 val: 0.769014 test: 0.769837
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({1: 6366, 0: 4296})

Epoch :  27 loss training:  39.48461348563433 Time :  4894
accuracy train: 0.956393 val: 0.756338 test: 0.772088
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({0: 6400, 1: 4262})

Epoch :  28 loss training:  38.665209382772446 Time :  4910
accuracy train: 0.955455 val: 0.767606 test: 0.771244
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({1: 6428, 0: 4234})

Epoch :  29 loss training:  36.96635973453522 Time :  4928
accuracy train: 0.958737 val: 0.766197 test: 0.765616
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({1: 6436, 0: 4226})

Epoch :  30 loss training:  36.36280618607998 Time :  4942
accuracy train: 0.964989 val: 0.767606 test: 0.771244
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({1: 6423, 0: 4239})

Epoch :  31 loss training:  33.91036859154701 Time :  4957
accuracy train: 0.961394 val: 0.771831 test: 0.765898
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({0: 6429, 1: 4233})

Epoch :  32 loss training:  32.471671245992184 Time :  4972
accuracy train: 0.969991 val: 0.764789 test: 0.772932
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({1: 6428, 0: 4234})

Epoch :  33 loss training:  32.469700895249844 Time :  4988
accuracy train: 0.973742 val: 0.771831 test: 0.777434
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({0: 6436, 1: 4226})

Epoch :  34 loss training:  30.430233009159565 Time :  5003
accuracy train: 0.975617 val: 0.763380 test: 0.770118
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({0: 6438, 1: 4224})

Epoch :  35 loss training:  28.00291132926941 Time :  5018
accuracy train: 0.979369 val: 0.769014 test: 0.768993
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({0: 6456, 1: 4206})

Epoch :  36 loss training:  27.849310107529163 Time :  5036
accuracy train: 0.983120 val: 0.764789 test: 0.768993
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({1: 6433, 0: 4229})

Epoch :  37 loss training:  27.053711008280516 Time :  5052
accuracy train: 0.984370 val: 0.763380 test: 0.768149
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({1: 6421, 0: 4241})

Epoch :  38 loss training:  25.831166923046112 Time :  5067
accuracy train: 0.985464 val: 0.759155 test: 0.767867
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({1: 6433, 0: 4229})

Epoch :  39 loss training:  25.196038905531168 Time :  5082
accuracy train: 0.986871 val: 0.759155 test: 0.769274
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({0: 6414, 1: 4248})

Epoch :  40 loss training:  23.44417953491211 Time :  5097
accuracy train: 0.985933 val: 0.761972 test: 0.761396
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({0: 6411, 1: 4251})

Epoch :  41 loss training:  23.55397086031735 Time :  5111
accuracy train: 0.989528 val: 0.761972 test: 0.762802
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({1: 6377, 0: 4285})

Epoch :  42 loss training:  20.767767246812582 Time :  5126
accuracy train: 0.990935 val: 0.756338 test: 0.766179
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({0: 6341, 1: 4321})

Epoch :  43 loss training:  21.871258076280355 Time :  5142
accuracy train: 0.994061 val: 0.745070 test: 0.758301
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({0: 6342, 1: 4320})

Epoch :  44 loss training:  20.093189975246787 Time :  5168
accuracy train: 0.994686 val: 0.750704 test: 0.765335
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({1: 6344, 0: 4318})

Epoch :  45 loss training:  18.99568003974855 Time :  5183
accuracy train: 0.995467 val: 0.760563 test: 0.761114
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.773495
Counter({1: 6337, 0: 4325})

========================================================================================================================================================================================================
max acc epoch :  14
max validation accuracy :  0.7746478873239436
test accuracy :  0.7734946539110861
last test_accuracy :  0.7611142374788971
========================================================================================================================================================================================================

itr : 7
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=657, weight_decay=0)
device :  cuda:0
Counter({0: 6243, 1: 4419})

Epoch :  1 loss training:  90.57500648498535 Time :  5202
accuracy train: 0.776649 val: 0.709859 test: 0.763647
max validation accuracy : 0.709859 max acc epoch : 1 test accuracy : 0.763647
Counter({0: 6410, 1: 4252})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.96813549101353 Time :  5217
accuracy train: 0.794780 val: 0.736620 test: 0.767586
max validation accuracy : 0.736620 max acc epoch : 2 test accuracy : 0.767586
Counter({0: 6215, 1: 4447})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.66195422410965 Time :  5232
accuracy train: 0.796186 val: 0.746479 test: 0.766742
max validation accuracy : 0.746479 max acc epoch : 3 test accuracy : 0.766742
Counter({0: 6480, 1: 4182})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.72993418574333 Time :  5247
accuracy train: 0.819475 val: 0.740845 test: 0.772932
max validation accuracy : 0.746479 max acc epoch : 3 test accuracy : 0.766742
Counter({0: 6574, 1: 4088})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.55598559975624 Time :  5262
accuracy train: 0.840731 val: 0.743662 test: 0.771525
max validation accuracy : 0.746479 max acc epoch : 3 test accuracy : 0.766742
Counter({1: 6656, 0: 4006})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  69.77596712112427 Time :  5280
accuracy train: 0.839950 val: 0.736620 test: 0.770400
max validation accuracy : 0.746479 max acc epoch : 3 test accuracy : 0.766742
Counter({0: 6853, 1: 3809})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.74637784063816 Time :  5295
accuracy train: 0.852610 val: 0.753521 test: 0.770681
max validation accuracy : 0.753521 max acc epoch : 7 test accuracy : 0.770681
Counter({1: 6910, 0: 3752})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.51311752200127 Time :  5309
accuracy train: 0.860269 val: 0.753521 test: 0.766742
max validation accuracy : 0.753521 max acc epoch : 7 test accuracy : 0.770681
Counter({0: 6896, 1: 3766})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.60250455141068 Time :  5323
accuracy train: 0.874805 val: 0.764789 test: 0.767867
max validation accuracy : 0.764789 max acc epoch : 9 test accuracy : 0.767867
Counter({0: 7086, 1: 3576})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.23029154539108 Time :  5338
accuracy train: 0.866677 val: 0.757746 test: 0.771244
max validation accuracy : 0.764789 max acc epoch : 9 test accuracy : 0.767867
Counter({0: 7081, 1: 3581})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.98778334259987 Time :  5352
accuracy train: 0.884339 val: 0.774648 test: 0.775746
max validation accuracy : 0.774648 max acc epoch : 11 test accuracy : 0.775746
Counter({0: 7112, 1: 3550})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.60262332856655 Time :  5366
accuracy train: 0.889184 val: 0.767606 test: 0.773213
max validation accuracy : 0.774648 max acc epoch : 11 test accuracy : 0.775746
Counter({0: 7095, 1: 3567})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  58.509676426649094 Time :  5381
accuracy train: 0.889966 val: 0.770423 test: 0.770400
max validation accuracy : 0.774648 max acc epoch : 11 test accuracy : 0.775746
Counter({1: 7088, 0: 3574})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.917509853839874 Time :  5402
accuracy train: 0.890903 val: 0.777465 test: 0.766460
max validation accuracy : 0.777465 max acc epoch : 14 test accuracy : 0.766460
Counter({0: 7116, 1: 3546})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  57.4271302819252 Time :  5418
accuracy train: 0.900125 val: 0.778873 test: 0.768711
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({1: 7113, 0: 3549})

Epoch :  16 loss training:  56.39477324485779 Time :  5432
accuracy train: 0.893560 val: 0.764789 test: 0.764209
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({0: 7134, 1: 3528})

Epoch :  17 loss training:  54.83746516704559 Time :  5447
accuracy train: 0.899812 val: 0.763380 test: 0.771525
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({0: 7111, 1: 3551})

Epoch :  18 loss training:  53.72018061578274 Time :  5462
accuracy train: 0.907627 val: 0.769014 test: 0.768711
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({1: 7113, 0: 3549})

Epoch :  19 loss training:  52.212910652160645 Time :  5476
accuracy train: 0.918881 val: 0.771831 test: 0.765898
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({1: 7116, 0: 3546})

Epoch :  20 loss training:  50.98082211613655 Time :  5491
accuracy train: 0.922788 val: 0.776056 test: 0.768430
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({0: 7110, 1: 3552})

Epoch :  21 loss training:  48.662205547094345 Time :  5508
accuracy train: 0.927790 val: 0.770423 test: 0.770681
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({0: 7096, 1: 3566})

Epoch :  22 loss training:  47.50393669307232 Time :  5527
accuracy train: 0.929353 val: 0.763380 test: 0.767867
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({0: 7106, 1: 3556})

Epoch :  23 loss training:  45.53970427066088 Time :  5539
accuracy train: 0.935917 val: 0.771831 test: 0.768430
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({0: 7081, 1: 3581})

Epoch :  24 loss training:  45.261344738304615 Time :  5554
accuracy train: 0.940138 val: 0.769014 test: 0.766742
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({1: 7084, 0: 3578})

Epoch :  25 loss training:  42.75478711724281 Time :  5568
accuracy train: 0.946546 val: 0.773239 test: 0.765616
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({1: 7024, 0: 3638})

Epoch :  26 loss training:  40.85023611038923 Time :  5583
accuracy train: 0.950610 val: 0.764789 test: 0.766179
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({1: 7004, 0: 3658})

Epoch :  27 loss training:  39.19972863048315 Time :  5597
accuracy train: 0.956236 val: 0.767606 test: 0.762240
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({1: 7010, 0: 3652})

Epoch :  28 loss training:  38.490500047802925 Time :  5612
accuracy train: 0.956080 val: 0.769014 test: 0.765898
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({0: 7025, 1: 3637})

Epoch :  29 loss training:  36.61009404063225 Time :  5628
accuracy train: 0.957799 val: 0.763380 test: 0.766742
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({0: 7024, 1: 3638})

Epoch :  30 loss training:  36.48443116247654 Time :  5644
accuracy train: 0.964676 val: 0.767606 test: 0.763647
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({1: 7010, 0: 3652})

Epoch :  31 loss training:  34.46129909902811 Time :  5659
accuracy train: 0.963739 val: 0.770423 test: 0.763365
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({0: 7016, 1: 3646})

Epoch :  32 loss training:  32.742588080465794 Time :  5673
accuracy train: 0.971554 val: 0.769014 test: 0.764491
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({0: 7018, 1: 3644})

Epoch :  33 loss training:  32.831305008381605 Time :  5688
accuracy train: 0.976555 val: 0.763380 test: 0.763365
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({0: 7007, 1: 3655})

Epoch :  34 loss training:  30.179155759513378 Time :  5703
accuracy train: 0.977962 val: 0.761972 test: 0.764209
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({1: 6998, 0: 3664})

Epoch :  35 loss training:  28.44448684155941 Time :  5717
accuracy train: 0.979369 val: 0.764789 test: 0.766742
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({1: 7029, 0: 3633})

Epoch :  36 loss training:  27.40124962478876 Time :  5732
accuracy train: 0.983745 val: 0.764789 test: 0.760833
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({0: 7024, 1: 3638})

Epoch :  37 loss training:  27.09072045236826 Time :  5750
accuracy train: 0.987340 val: 0.769014 test: 0.763365
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({0: 7014, 1: 3648})

Epoch :  38 loss training:  26.433170042932034 Time :  5764
accuracy train: 0.988278 val: 0.770423 test: 0.760833
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({0: 7005, 1: 3657})

Epoch :  39 loss training:  25.681368432939053 Time :  5779
accuracy train: 0.988746 val: 0.766197 test: 0.764209
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({0: 7009, 1: 3653})

Epoch :  40 loss training:  22.560865385457873 Time :  5794
accuracy train: 0.990309 val: 0.766197 test: 0.756331
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({0: 7009, 1: 3653})

Epoch :  41 loss training:  22.93424730747938 Time :  5809
accuracy train: 0.990778 val: 0.769014 test: 0.758582
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({0: 6992, 1: 3670})

Epoch :  42 loss training:  20.737200535833836 Time :  5824
accuracy train: 0.992654 val: 0.771831 test: 0.763647
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({0: 6945, 1: 3717})

Epoch :  43 loss training:  21.588529700413346 Time :  5839
accuracy train: 0.994686 val: 0.774648 test: 0.758301
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({1: 6934, 0: 3728})

Epoch :  44 loss training:  20.614955373108387 Time :  5855
accuracy train: 0.994530 val: 0.774648 test: 0.761396
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({1: 6921, 0: 3741})

Epoch :  45 loss training:  19.679961770772934 Time :  5875
accuracy train: 0.995467 val: 0.763380 test: 0.758301
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({1: 6927, 0: 3735})

Epoch :  46 loss training:  18.17815194092691 Time :  5890
accuracy train: 0.996561 val: 0.761972 test: 0.759707
max validation accuracy : 0.778873 max acc epoch : 15 test accuracy : 0.768711
Counter({1: 6890, 0: 3772})

========================================================================================================================================================================================================
max acc epoch :  15
max validation accuracy :  0.7788732394366197
test accuracy :  0.7687113111986494
last test_accuracy :  0.7597073719752392
========================================================================================================================================================================================================

itr : 8
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=657, weight_decay=0)
device :  cuda:0
Counter({0: 6243, 1: 4419})

Epoch :  1 loss training:  90.67862784862518 Time :  5909
accuracy train: 0.777430 val: 0.718310 test: 0.762240
max validation accuracy : 0.718310 max acc epoch : 1 test accuracy : 0.762240
Counter({0: 6122, 1: 4540})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.3378276526928 Time :  5923
accuracy train: 0.790091 val: 0.730986 test: 0.761677
max validation accuracy : 0.730986 max acc epoch : 2 test accuracy : 0.761677
Counter({0: 5333, 1: 5329})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.64166885614395 Time :  5938
accuracy train: 0.806971 val: 0.749296 test: 0.759707
max validation accuracy : 0.749296 max acc epoch : 3 test accuracy : 0.759707
Counter({1: 5867, 0: 4795})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  72.95696902275085 Time :  5953
accuracy train: 0.814317 val: 0.753521 test: 0.766460
max validation accuracy : 0.753521 max acc epoch : 4 test accuracy : 0.766460
Counter({1: 5857, 0: 4805})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  70.84670248627663 Time :  5968
accuracy train: 0.835261 val: 0.756338 test: 0.774057
max validation accuracy : 0.756338 max acc epoch : 5 test accuracy : 0.774057
Counter({1: 5957, 0: 4705})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  69.78888177871704 Time :  5985
accuracy train: 0.830572 val: 0.767606 test: 0.769555
max validation accuracy : 0.767606 max acc epoch : 6 test accuracy : 0.769555
Counter({1: 6660, 0: 4002})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.46818339824677 Time :  6000
accuracy train: 0.849953 val: 0.761972 test: 0.770962
max validation accuracy : 0.767606 max acc epoch : 6 test accuracy : 0.769555
Counter({0: 6753, 1: 3909})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.68821002542973 Time :  6015
accuracy train: 0.868709 val: 0.769014 test: 0.771244
max validation accuracy : 0.769014 max acc epoch : 8 test accuracy : 0.771244
Counter({1: 6661, 0: 4001})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.56930159032345 Time :  6029
accuracy train: 0.875117 val: 0.771831 test: 0.773776
max validation accuracy : 0.771831 max acc epoch : 9 test accuracy : 0.773776
Counter({1: 6666, 0: 3996})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.573090344667435 Time :  6045
accuracy train: 0.865896 val: 0.771831 test: 0.770681
max validation accuracy : 0.771831 max acc epoch : 9 test accuracy : 0.773776
Counter({0: 6684, 1: 3978})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.72287593781948 Time :  6059
accuracy train: 0.881838 val: 0.771831 test: 0.769837
max validation accuracy : 0.771831 max acc epoch : 9 test accuracy : 0.773776
Counter({1: 6708, 0: 3954})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.83680386841297 Time :  6073
accuracy train: 0.885120 val: 0.778873 test: 0.771806
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.771806
Counter({1: 6677, 0: 3985})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  58.90152584016323 Time :  6088
accuracy train: 0.886058 val: 0.774648 test: 0.771806
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.771806
Counter({0: 6640, 1: 4022})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  58.198100462555885 Time :  6106
accuracy train: 0.885589 val: 0.770423 test: 0.768711
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.771806
Counter({1: 6645, 0: 4017})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  57.50762616097927 Time :  6119
accuracy train: 0.897312 val: 0.776056 test: 0.768711
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.771806
Counter({1: 6667, 0: 3995})

Epoch :  16 loss training:  56.629420310258865 Time :  6134
accuracy train: 0.887621 val: 0.761972 test: 0.762240
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.771806
Counter({1: 6671, 0: 3991})

Epoch :  17 loss training:  54.729480504989624 Time :  6149
accuracy train: 0.894186 val: 0.761972 test: 0.767586
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.771806
Counter({0: 6656, 1: 4006})

Epoch :  18 loss training:  54.24279913306236 Time :  6164
accuracy train: 0.904033 val: 0.771831 test: 0.767304
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.771806
Counter({1: 6630, 0: 4032})

Epoch :  19 loss training:  51.73549143970013 Time :  6179
accuracy train: 0.916849 val: 0.771831 test: 0.766460
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.771806
Counter({0: 6627, 1: 4035})

Epoch :  20 loss training:  51.43899217247963 Time :  6195
accuracy train: 0.918099 val: 0.780282 test: 0.768711
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({0: 6629, 1: 4033})

Epoch :  21 loss training:  49.20765936374664 Time :  6209
accuracy train: 0.924195 val: 0.771831 test: 0.769837
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({1: 6628, 0: 4034})

Epoch :  22 loss training:  48.075974971055984 Time :  6225
accuracy train: 0.927946 val: 0.776056 test: 0.767586
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({1: 6653, 0: 4009})

Epoch :  23 loss training:  45.84842786937952 Time :  6243
accuracy train: 0.934823 val: 0.773239 test: 0.767867
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({1: 6658, 0: 4004})

Epoch :  24 loss training:  45.84427481889725 Time :  6258
accuracy train: 0.938106 val: 0.774648 test: 0.765335
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({0: 6676, 1: 3986})

Epoch :  25 loss training:  43.35041033476591 Time :  6273
accuracy train: 0.944358 val: 0.776056 test: 0.766179
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({1: 6660, 0: 4002})

Epoch :  26 loss training:  41.480970092117786 Time :  6289
accuracy train: 0.949203 val: 0.778873 test: 0.765616
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({1: 6663, 0: 3999})

Epoch :  27 loss training:  39.76514536142349 Time :  6303
accuracy train: 0.951860 val: 0.774648 test: 0.766742
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({1: 6686, 0: 3976})

Epoch :  28 loss training:  39.6653104275465 Time :  6319
accuracy train: 0.955767 val: 0.773239 test: 0.766742
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({1: 6677, 0: 3985})

Epoch :  29 loss training:  37.4519237652421 Time :  6333
accuracy train: 0.956549 val: 0.767606 test: 0.768993
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({1: 6696, 0: 3966})

Epoch :  30 loss training:  36.89980737119913 Time :  6349
accuracy train: 0.964051 val: 0.773239 test: 0.767023
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({1: 6696, 0: 3966})

Epoch :  31 loss training:  34.97514698654413 Time :  6370
accuracy train: 0.960456 val: 0.764789 test: 0.764491
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({1: 6710, 0: 3952})

Epoch :  32 loss training:  33.65444038063288 Time :  6385
accuracy train: 0.971710 val: 0.770423 test: 0.764772
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({0: 6714, 1: 3948})

Epoch :  33 loss training:  33.56694447249174 Time :  6400
accuracy train: 0.972960 val: 0.774648 test: 0.767304
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({0: 6726, 1: 3936})

Epoch :  34 loss training:  31.304889041930437 Time :  6415
accuracy train: 0.977180 val: 0.773239 test: 0.764209
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({1: 6699, 0: 3963})

Epoch :  35 loss training:  29.556677907705307 Time :  6431
accuracy train: 0.976399 val: 0.761972 test: 0.760833
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({0: 6685, 1: 3977})

Epoch :  36 loss training:  28.44173301011324 Time :  6444
accuracy train: 0.982338 val: 0.759155 test: 0.763928
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({1: 6685, 0: 3977})

Epoch :  37 loss training:  28.528763111680746 Time :  6456
accuracy train: 0.982651 val: 0.767606 test: 0.761114
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({1: 6696, 0: 3966})

Epoch :  38 loss training:  27.406725712120533 Time :  6470
accuracy train: 0.983901 val: 0.770423 test: 0.763647
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({1: 6702, 0: 3960})

Epoch :  39 loss training:  25.302010666579008 Time :  6494
accuracy train: 0.986246 val: 0.757746 test: 0.763647
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({1: 6688, 0: 3974})

Epoch :  40 loss training:  24.034631848335266 Time :  6508
accuracy train: 0.988121 val: 0.760563 test: 0.756894
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({1: 6720, 0: 3942})

Epoch :  41 loss training:  24.595703922212124 Time :  6523
accuracy train: 0.989528 val: 0.767606 test: 0.760551
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({0: 6709, 1: 3953})

Epoch :  42 loss training:  22.185586102306843 Time :  6536
accuracy train: 0.990466 val: 0.761972 test: 0.762240
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({1: 6693, 0: 3969})

Epoch :  43 loss training:  22.560357972979546 Time :  6551
accuracy train: 0.992654 val: 0.759155 test: 0.759707
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({0: 6694, 1: 3968})

Epoch :  44 loss training:  20.904446413740516 Time :  6565
accuracy train: 0.994686 val: 0.763380 test: 0.759989
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({1: 6675, 0: 3987})

Epoch :  45 loss training:  20.161634851247072 Time :  6579
accuracy train: 0.995155 val: 0.752113 test: 0.760270
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({0: 6646, 1: 4016})

Epoch :  46 loss training:  19.166918896138668 Time :  6592
accuracy train: 0.995311 val: 0.756338 test: 0.762240
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({1: 6620, 0: 4042})

Epoch :  47 loss training:  18.375129332765937 Time :  6619
accuracy train: 0.996093 val: 0.759155 test: 0.758019
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({1: 6622, 0: 4040})

Epoch :  48 loss training:  18.43412027321756 Time :  6633
accuracy train: 0.996249 val: 0.760563 test: 0.761396
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({0: 6587, 1: 4075})

Epoch :  49 loss training:  17.47721377760172 Time :  6647
accuracy train: 0.997499 val: 0.767606 test: 0.757738
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({1: 6570, 0: 4092})

Epoch :  50 loss training:  16.505427988246083 Time :  6661
accuracy train: 0.997499 val: 0.761972 test: 0.763365
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({1: 6524, 0: 4138})

Epoch :  51 loss training:  15.995163638144732 Time :  6675
accuracy train: 0.998124 val: 0.757746 test: 0.759145
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.768711
Counter({1: 6292, 0: 4370})

========================================================================================================================================================================================================
max acc epoch :  20
max validation accuracy :  0.780281690140845
test accuracy :  0.7687113111986494
last test_accuracy :  0.7591446257737761
========================================================================================================================================================================================================

itr : 9
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=657, weight_decay=0)
device :  cuda:0
Counter({0: 6243, 1: 4419})

Epoch :  1 loss training:  90.74828213453293 Time :  6693
accuracy train: 0.773523 val: 0.709859 test: 0.761677
max validation accuracy : 0.709859 max acc epoch : 1 test accuracy : 0.761677
Counter({0: 6506, 1: 4156})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.50554832816124 Time :  6707
accuracy train: 0.795405 val: 0.750704 test: 0.761114
max validation accuracy : 0.750704 max acc epoch : 2 test accuracy : 0.761114
Counter({0: 5742, 1: 4920})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.0391711294651 Time :  6721
accuracy train: 0.796812 val: 0.749296 test: 0.765898
max validation accuracy : 0.750704 max acc epoch : 2 test accuracy : 0.761114
Counter({1: 6264, 0: 4398})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.40219730138779 Time :  6745
accuracy train: 0.814161 val: 0.740845 test: 0.767586
max validation accuracy : 0.750704 max acc epoch : 2 test accuracy : 0.761114
Counter({0: 6383, 1: 4279})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.29632768034935 Time :  6759
accuracy train: 0.830885 val: 0.738028 test: 0.767023
max validation accuracy : 0.750704 max acc epoch : 2 test accuracy : 0.761114
Counter({0: 6350, 1: 4312})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  69.9932340234518 Time :  6773
accuracy train: 0.828696 val: 0.742254 test: 0.766460
max validation accuracy : 0.750704 max acc epoch : 2 test accuracy : 0.761114
Counter({1: 6401, 0: 4261})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.3890073299408 Time :  6787
accuracy train: 0.845264 val: 0.752113 test: 0.765898
max validation accuracy : 0.752113 max acc epoch : 7 test accuracy : 0.765898
Counter({0: 6256, 1: 4406})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.46799340844154 Time :  6801
accuracy train: 0.860894 val: 0.753521 test: 0.772088
max validation accuracy : 0.753521 max acc epoch : 8 test accuracy : 0.772088
Counter({0: 6207, 1: 4455})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.17255760729313 Time :  6815
accuracy train: 0.872616 val: 0.761972 test: 0.761958
max validation accuracy : 0.761972 max acc epoch : 9 test accuracy : 0.761958
Counter({0: 6198, 1: 4464})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.99164415895939 Time :  6829
accuracy train: 0.871835 val: 0.756338 test: 0.767867
max validation accuracy : 0.761972 max acc epoch : 9 test accuracy : 0.761958
Counter({1: 6127, 0: 4535})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.77466006577015 Time :  6844
accuracy train: 0.881525 val: 0.764789 test: 0.765616
max validation accuracy : 0.764789 max acc epoch : 11 test accuracy : 0.765616
Counter({1: 6097, 0: 4565})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.567867174744606 Time :  6858
accuracy train: 0.884183 val: 0.760563 test: 0.760551
max validation accuracy : 0.764789 max acc epoch : 11 test accuracy : 0.765616
Counter({1: 6055, 0: 4607})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  58.7102537304163 Time :  6878
accuracy train: 0.886058 val: 0.767606 test: 0.761677
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({0: 6009, 1: 4653})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  58.1813046336174 Time :  6892
accuracy train: 0.888872 val: 0.761972 test: 0.761114
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({0: 6012, 1: 4650})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  57.083599120378494 Time :  6906
accuracy train: 0.893092 val: 0.753521 test: 0.761114
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({0: 6002, 1: 4660})

Epoch :  16 loss training:  56.051195442676544 Time :  6920
accuracy train: 0.889809 val: 0.752113 test: 0.757456
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({1: 5998, 0: 4664})

Epoch :  17 loss training:  55.02609674632549 Time :  6934
accuracy train: 0.895592 val: 0.759155 test: 0.757175
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({1: 5989, 0: 4673})

Epoch :  18 loss training:  54.179602682590485 Time :  6945
accuracy train: 0.902938 val: 0.761972 test: 0.757738
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({1: 5978, 0: 4684})

Epoch :  19 loss training:  52.10442669689655 Time :  6958
accuracy train: 0.914505 val: 0.757746 test: 0.756894
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({1: 5958, 0: 4704})

Epoch :  20 loss training:  51.505217269062996 Time :  6972
accuracy train: 0.920600 val: 0.759155 test: 0.758019
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({1: 5971, 0: 4691})

Epoch :  21 loss training:  48.57911919057369 Time :  6988
accuracy train: 0.927946 val: 0.760563 test: 0.763084
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({1: 5963, 0: 4699})

Epoch :  22 loss training:  47.899213403463364 Time :  7004
accuracy train: 0.929666 val: 0.754930 test: 0.756050
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({1: 5994, 0: 4668})

Epoch :  23 loss training:  46.08619325608015 Time :  7018
accuracy train: 0.934667 val: 0.766197 test: 0.757456
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({1: 5973, 0: 4689})

Epoch :  24 loss training:  45.010150626301765 Time :  7032
accuracy train: 0.935136 val: 0.747887 test: 0.751266
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({1: 5985, 0: 4677})

Epoch :  25 loss training:  42.438609175384045 Time :  7046
accuracy train: 0.947171 val: 0.757746 test: 0.756894
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({1: 5967, 0: 4695})

Epoch :  26 loss training:  41.581653378903866 Time :  7060
accuracy train: 0.951704 val: 0.767606 test: 0.758582
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({1: 5938, 0: 4724})

Epoch :  27 loss training:  39.51381645351648 Time :  7073
accuracy train: 0.953110 val: 0.759155 test: 0.758863
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({0: 5949, 1: 4713})

Epoch :  28 loss training:  38.00783181935549 Time :  7087
accuracy train: 0.953110 val: 0.752113 test: 0.757175
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({1: 5923, 0: 4739})

Epoch :  29 loss training:  37.32027077674866 Time :  7102
accuracy train: 0.959675 val: 0.759155 test: 0.753517
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({0: 5931, 1: 4731})

Epoch :  30 loss training:  36.340051759034395 Time :  7127
accuracy train: 0.967490 val: 0.756338 test: 0.754643
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({1: 5925, 0: 4737})

Epoch :  31 loss training:  34.63568776100874 Time :  7141
accuracy train: 0.966552 val: 0.752113 test: 0.749859
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({0: 5918, 1: 4744})

Epoch :  32 loss training:  32.930378161370754 Time :  7154
accuracy train: 0.972491 val: 0.763380 test: 0.754643
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({1: 5920, 0: 4742})

Epoch :  33 loss training:  32.70120431482792 Time :  7168
accuracy train: 0.975774 val: 0.754930 test: 0.758582
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({0: 5918, 1: 4744})

Epoch :  34 loss training:  30.788370341062546 Time :  7180
accuracy train: 0.977649 val: 0.757746 test: 0.753517
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({0: 5909, 1: 4753})

Epoch :  35 loss training:  28.711952857673168 Time :  7193
accuracy train: 0.981557 val: 0.753521 test: 0.749859
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({0: 5888, 1: 4774})

Epoch :  36 loss training:  27.890146233141422 Time :  7207
accuracy train: 0.983276 val: 0.756338 test: 0.752954
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({0: 5884, 1: 4778})

Epoch :  37 loss training:  27.464899588376284 Time :  7222
accuracy train: 0.983901 val: 0.745070 test: 0.751829
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({1: 5870, 0: 4792})

Epoch :  38 loss training:  26.38965681195259 Time :  7238
accuracy train: 0.986871 val: 0.754930 test: 0.751266
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({0: 5851, 1: 4811})

Epoch :  39 loss training:  25.091156233102083 Time :  7253
accuracy train: 0.989215 val: 0.750704 test: 0.749297
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({0: 5840, 1: 4822})

Epoch :  40 loss training:  23.332824548706412 Time :  7268
accuracy train: 0.989684 val: 0.752113 test: 0.742825
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({1: 5849, 0: 4813})

Epoch :  41 loss training:  23.208662651479244 Time :  7282
accuracy train: 0.991560 val: 0.754930 test: 0.748171
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({1: 5812, 0: 4850})

Epoch :  42 loss training:  21.78261436522007 Time :  7297
accuracy train: 0.991404 val: 0.759155 test: 0.750703
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({0: 5785, 1: 4877})

Epoch :  43 loss training:  21.1471616178751 Time :  7311
accuracy train: 0.992029 val: 0.747887 test: 0.744513
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({0: 5770, 1: 4892})

Epoch :  44 loss training:  20.60248762369156 Time :  7325
accuracy train: 0.994686 val: 0.757746 test: 0.752110
max validation accuracy : 0.767606 max acc epoch : 13 test accuracy : 0.761677
Counter({0: 5773, 1: 4889})

========================================================================================================================================================================================================
max acc epoch :  13
max validation accuracy :  0.7676056338028169
test accuracy :  0.7616769836803602
last test_accuracy :  0.7521102982554868
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.79014 	 test_accuracy : 0.77237 	 max_acc epoch :  13 	 last test_accuracy : 0.76815
k :  1 	 val_accuracy : 0.76338 	 test_accuracy : 0.77546 	 max_acc epoch :  7 	 last test_accuracy : 0.77096
k :  2 	 val_accuracy : 0.78169 	 test_accuracy : 0.77068 	 max_acc epoch :  21 	 last test_accuracy : 0.76280
k :  3 	 val_accuracy : 0.77324 	 test_accuracy : 0.77293 	 max_acc epoch :  18 	 last test_accuracy : 0.76393
k :  4 	 val_accuracy : 0.78028 	 test_accuracy : 0.76843 	 max_acc epoch :  42 	 last test_accuracy : 0.75774
k :  5 	 val_accuracy : 0.76338 	 test_accuracy : 0.77124 	 max_acc epoch :  9 	 last test_accuracy : 0.75689
k :  6 	 val_accuracy : 0.77465 	 test_accuracy : 0.77349 	 max_acc epoch :  14 	 last test_accuracy : 0.76111
k :  7 	 val_accuracy : 0.77887 	 test_accuracy : 0.76871 	 max_acc epoch :  15 	 last test_accuracy : 0.75971
k :  8 	 val_accuracy : 0.78028 	 test_accuracy : 0.76871 	 max_acc epoch :  20 	 last test_accuracy : 0.75914
k :  9 	 val_accuracy : 0.76761 	 test_accuracy : 0.76168 	 max_acc epoch :  13 	 last test_accuracy : 0.75211

avg :  	 val_accuracy : 0.77535 	 test_accuracy : 0.77037 	 last_accuracy : 0.76125


date and time :  Fri Jun  4 04:10:34 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=441, weight_decay=0)
device :  cuda:0
Counter({0: 5133, 1: 3267, 2: 2262})

Epoch :  1 loss training:  91.13616266846657 Time :  14
accuracy train: 0.784620 val: 0.757746 test: 0.771806
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.771806
Counter({2: 4056, 1: 3558, 0: 3048})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.05159552395344 Time :  51
accuracy train: 0.792591 val: 0.759155 test: 0.763928
max validation accuracy : 0.759155 max acc epoch : 2 test accuracy : 0.763928
Counter({1: 4209, 0: 3402, 2: 3051})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.38592183589935 Time :  68
accuracy train: 0.813223 val: 0.757746 test: 0.775183
max validation accuracy : 0.759155 max acc epoch : 2 test accuracy : 0.763928
Counter({1: 3897, 2: 3829, 0: 2936})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.93886429071426 Time :  84
accuracy train: 0.822445 val: 0.766197 test: 0.775464
max validation accuracy : 0.766197 max acc epoch : 4 test accuracy : 0.775464
Counter({2: 3893, 0: 3880, 1: 2889})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.3055630326271 Time :  100
accuracy train: 0.827602 val: 0.761972 test: 0.767304
max validation accuracy : 0.766197 max acc epoch : 4 test accuracy : 0.775464
Counter({0: 3990, 2: 3808, 1: 2864})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.87938345968723 Time :  117
accuracy train: 0.837606 val: 0.770423 test: 0.766742
max validation accuracy : 0.770423 max acc epoch : 6 test accuracy : 0.766742
Counter({0: 3898, 2: 3889, 1: 2875})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.37454010546207 Time :  132
accuracy train: 0.851672 val: 0.767606 test: 0.775183
max validation accuracy : 0.770423 max acc epoch : 6 test accuracy : 0.766742
Counter({0: 3924, 1: 3889, 2: 2849})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  63.994444742798805 Time :  147
accuracy train: 0.862457 val: 0.774648 test: 0.774339
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.774339
Counter({2: 3972, 1: 3915, 0: 2775})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.00243900716305 Time :  164
accuracy train: 0.860113 val: 0.763380 test: 0.774902
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.774339
Counter({1: 4161, 2: 3638, 0: 2863})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.46383640170097 Time :  191
accuracy train: 0.876680 val: 0.749296 test: 0.767867
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.774339
Counter({0: 4182, 2: 3636, 1: 2844})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.61542049050331 Time :  206
accuracy train: 0.882151 val: 0.757746 test: 0.769555
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.774339
Counter({2: 4152, 1: 3678, 0: 2832})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.982395961880684 Time :  222
accuracy train: 0.886840 val: 0.771831 test: 0.766179
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.774339
Counter({1: 4202, 0: 3662, 2: 2798})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.751636266708374 Time :  237
accuracy train: 0.891685 val: 0.777465 test: 0.766179
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({0: 4184, 2: 3662, 1: 2816})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.667257741093636 Time :  252
accuracy train: 0.891841 val: 0.769014 test: 0.772369
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({0: 4193, 2: 3670, 1: 2799})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  57.043990179896355 Time :  267
accuracy train: 0.893560 val: 0.776056 test: 0.769837
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({2: 4226, 0: 3667, 1: 2769})

Epoch :  16 loss training:  56.04571782052517 Time :  283
accuracy train: 0.901844 val: 0.770423 test: 0.771525
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({2: 4210, 0: 3671, 1: 2781})

Epoch :  17 loss training:  55.447985127568245 Time :  299
accuracy train: 0.904814 val: 0.771831 test: 0.768711
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({2: 4199, 0: 3684, 1: 2779})

Epoch :  18 loss training:  52.61573977768421 Time :  318
accuracy train: 0.914505 val: 0.767606 test: 0.771525
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({2: 4184, 0: 3678, 1: 2800})

Epoch :  19 loss training:  52.01777195930481 Time :  333
accuracy train: 0.917631 val: 0.773239 test: 0.768149
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({0: 4228, 2: 3643, 1: 2791})

Epoch :  20 loss training:  50.16996414959431 Time :  348
accuracy train: 0.924508 val: 0.770423 test: 0.770400
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({0: 4218, 1: 3661, 2: 2783})

Epoch :  21 loss training:  48.15606579184532 Time :  364
accuracy train: 0.931385 val: 0.761972 test: 0.770681
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({0: 4212, 2: 3664, 1: 2786})

Epoch :  22 loss training:  46.175451815128326 Time :  379
accuracy train: 0.935292 val: 0.769014 test: 0.773776
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({2: 4210, 0: 3656, 1: 2796})

Epoch :  23 loss training:  45.22416193783283 Time :  394
accuracy train: 0.942951 val: 0.770423 test: 0.774057
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({0: 4193, 2: 3683, 1: 2786})

Epoch :  24 loss training:  43.74532816559076 Time :  407
accuracy train: 0.947015 val: 0.769014 test: 0.771244
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({0: 4206, 2: 3670, 1: 2786})

Epoch :  25 loss training:  42.37099862098694 Time :  425
accuracy train: 0.953110 val: 0.766197 test: 0.772088
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({0: 4166, 1: 3702, 2: 2794})

Epoch :  26 loss training:  39.52709420770407 Time :  442
accuracy train: 0.958112 val: 0.773239 test: 0.775464
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({1: 4185, 2: 3685, 0: 2792})

Epoch :  27 loss training:  38.8790273591876 Time :  457
accuracy train: 0.961238 val: 0.769014 test: 0.773776
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({0: 4186, 2: 3690, 1: 2786})

Epoch :  28 loss training:  38.2773547694087 Time :  472
accuracy train: 0.964520 val: 0.767606 test: 0.770400
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({0: 4189, 2: 3694, 1: 2779})

Epoch :  29 loss training:  35.730232536792755 Time :  487
accuracy train: 0.969209 val: 0.773239 test: 0.773776
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({2: 4185, 1: 3699, 0: 2778})

Epoch :  30 loss training:  36.30306665599346 Time :  502
accuracy train: 0.973117 val: 0.764789 test: 0.769837
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({2: 4189, 0: 3681, 1: 2792})

Epoch :  31 loss training:  33.56626918539405 Time :  517
accuracy train: 0.974836 val: 0.774648 test: 0.770681
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({0: 4182, 2: 3709, 1: 2771})

Epoch :  32 loss training:  31.723901443183422 Time :  531
accuracy train: 0.978743 val: 0.763380 test: 0.763928
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({2: 4180, 0: 3699, 1: 2783})

Epoch :  33 loss training:  31.599673360586166 Time :  544
accuracy train: 0.980932 val: 0.761972 test: 0.766179
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({2: 4181, 0: 3723, 1: 2758})

Epoch :  34 loss training:  30.758854057639837 Time :  571
accuracy train: 0.982651 val: 0.759155 test: 0.765053
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({0: 4176, 2: 3723, 1: 2763})

Epoch :  35 loss training:  28.777641039341688 Time :  586
accuracy train: 0.984214 val: 0.763380 test: 0.762521
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({2: 4167, 0: 3727, 1: 2768})

Epoch :  36 loss training:  27.649937439709902 Time :  600
accuracy train: 0.986246 val: 0.767606 test: 0.766460
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({0: 4136, 1: 3754, 2: 2772})

Epoch :  37 loss training:  26.976524855941534 Time :  616
accuracy train: 0.989372 val: 0.761972 test: 0.759707
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({1: 4148, 2: 3759, 0: 2755})

Epoch :  38 loss training:  24.252315064892173 Time :  631
accuracy train: 0.992029 val: 0.766197 test: 0.759426
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({0: 4153, 2: 3744, 1: 2765})

Epoch :  39 loss training:  24.61981501802802 Time :  647
accuracy train: 0.992029 val: 0.759155 test: 0.760551
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({0: 4162, 2: 3764, 1: 2736})

Epoch :  40 loss training:  23.09166982024908 Time :  662
accuracy train: 0.992341 val: 0.764789 test: 0.761958
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({2: 4134, 1: 3774, 0: 2754})

Epoch :  41 loss training:  21.907771347090602 Time :  676
accuracy train: 0.992810 val: 0.764789 test: 0.761958
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({0: 4137, 2: 3780, 1: 2745})

Epoch :  42 loss training:  20.56132752634585 Time :  704
accuracy train: 0.993904 val: 0.761972 test: 0.763928
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({0: 4141, 2: 3760, 1: 2761})

Epoch :  43 loss training:  19.823900217190385 Time :  720
accuracy train: 0.995624 val: 0.756338 test: 0.763365
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({0: 4152, 1: 3780, 2: 2730})

Epoch :  44 loss training:  19.977902317419648 Time :  735
accuracy train: 0.995624 val: 0.747887 test: 0.766179
max validation accuracy : 0.777465 max acc epoch : 13 test accuracy : 0.766179
Counter({2: 4125, 0: 3791, 1: 2746})

========================================================================================================================================================================================================
max acc epoch :  13
max validation accuracy :  0.7774647887323943
test accuracy :  0.7661789532920653
last test_accuracy :  0.7661789532920653
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=441, weight_decay=0)
device :  cuda:0
Counter({0: 5133, 1: 3267, 2: 2262})

Epoch :  1 loss training:  91.3120967745781 Time :  755
accuracy train: 0.783839 val: 0.742254 test: 0.766742
max validation accuracy : 0.742254 max acc epoch : 1 test accuracy : 0.766742
Counter({1: 4079, 0: 3820, 2: 2763})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.84072830528021 Time :  770
accuracy train: 0.791654 val: 0.763380 test: 0.761958
max validation accuracy : 0.763380 max acc epoch : 2 test accuracy : 0.761958
Counter({0: 3979, 2: 3350, 1: 3333})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.60819467902184 Time :  787
accuracy train: 0.814004 val: 0.754930 test: 0.765898
max validation accuracy : 0.763380 max acc epoch : 2 test accuracy : 0.761958
Counter({2: 4161, 0: 3345, 1: 3156})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.18754690885544 Time :  803
accuracy train: 0.826352 val: 0.766197 test: 0.768993
max validation accuracy : 0.766197 max acc epoch : 4 test accuracy : 0.768993
Counter({1: 4257, 2: 3228, 0: 3177})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.51096008718014 Time :  821
accuracy train: 0.830728 val: 0.761972 test: 0.765898
max validation accuracy : 0.766197 max acc epoch : 4 test accuracy : 0.768993
Counter({0: 4377, 2: 3173, 1: 3112})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.08899620175362 Time :  838
accuracy train: 0.839012 val: 0.761972 test: 0.763928
max validation accuracy : 0.766197 max acc epoch : 4 test accuracy : 0.768993
Counter({1: 4388, 2: 3216, 0: 3058})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.5624889433384 Time :  852
accuracy train: 0.856361 val: 0.757746 test: 0.763928
max validation accuracy : 0.766197 max acc epoch : 4 test accuracy : 0.768993
Counter({0: 4438, 1: 3185, 2: 3039})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  63.24897192418575 Time :  868
accuracy train: 0.865739 val: 0.770423 test: 0.765898
max validation accuracy : 0.770423 max acc epoch : 8 test accuracy : 0.765898
Counter({0: 4494, 1: 3113, 2: 3055})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.483783572912216 Time :  883
accuracy train: 0.870897 val: 0.757746 test: 0.768430
max validation accuracy : 0.770423 max acc epoch : 8 test accuracy : 0.765898
Counter({1: 4520, 0: 3111, 2: 3031})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.2606064081192 Time :  898
accuracy train: 0.880275 val: 0.773239 test: 0.760270
max validation accuracy : 0.773239 max acc epoch : 10 test accuracy : 0.760270
Counter({0: 4577, 1: 3095, 2: 2990})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.127692207694054 Time :  914
accuracy train: 0.882307 val: 0.770423 test: 0.762521
max validation accuracy : 0.773239 max acc epoch : 10 test accuracy : 0.760270
Counter({2: 4589, 1: 3064, 0: 3009})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.750846549868584 Time :  930
accuracy train: 0.885746 val: 0.778873 test: 0.761114
max validation accuracy : 0.778873 max acc epoch : 12 test accuracy : 0.761114
Counter({1: 4616, 0: 3103, 2: 2943})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.46293541789055 Time :  959
accuracy train: 0.888559 val: 0.781690 test: 0.757738
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.757738
Counter({0: 4616, 1: 3095, 2: 2951})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.68960605561733 Time :  974
accuracy train: 0.891685 val: 0.777465 test: 0.759707
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.757738
Counter({2: 4642, 1: 3106, 0: 2914})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.572833836078644 Time :  990
accuracy train: 0.895749 val: 0.778873 test: 0.760551
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.757738
Counter({1: 4631, 2: 3111, 0: 2920})

Epoch :  16 loss training:  55.48890082538128 Time :  1004
accuracy train: 0.897312 val: 0.776056 test: 0.758019
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.757738
Counter({0: 4674, 2: 3075, 1: 2913})

Epoch :  17 loss training:  55.18381167948246 Time :  1020
accuracy train: 0.906846 val: 0.771831 test: 0.756612
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.757738
Counter({2: 4627, 1: 3084, 0: 2951})

Epoch :  18 loss training:  52.06314140558243 Time :  1035
accuracy train: 0.914973 val: 0.777465 test: 0.756050
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.757738
Counter({2: 4646, 0: 3081, 1: 2935})

Epoch :  19 loss training:  51.230660021305084 Time :  1050
accuracy train: 0.914036 val: 0.780282 test: 0.759989
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.757738
Counter({0: 4622, 2: 3101, 1: 2939})

Epoch :  20 loss training:  50.09231600165367 Time :  1066
accuracy train: 0.924664 val: 0.778873 test: 0.757738
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.757738
Counter({2: 4644, 1: 3071, 0: 2947})

Epoch :  21 loss training:  48.72621141374111 Time :  1087
accuracy train: 0.929822 val: 0.780282 test: 0.762802
max validation accuracy : 0.781690 max acc epoch : 13 test accuracy : 0.757738
Counter({0: 4623, 1: 3085, 2: 2954})

Epoch :  22 loss training:  45.795704409480095 Time :  1103
accuracy train: 0.932948 val: 0.784507 test: 0.763365
max validation accuracy : 0.784507 max acc epoch : 22 test accuracy : 0.763365
Counter({0: 4640, 1: 3079, 2: 2943})

Epoch :  23 loss training:  44.55655508488417 Time :  1118
accuracy train: 0.941075 val: 0.780282 test: 0.763928
max validation accuracy : 0.784507 max acc epoch : 22 test accuracy : 0.763365
Counter({2: 4616, 1: 3087, 0: 2959})

Epoch :  24 loss training:  43.67720717936754 Time :  1134
accuracy train: 0.945921 val: 0.776056 test: 0.761677
max validation accuracy : 0.784507 max acc epoch : 22 test accuracy : 0.763365
Counter({0: 4637, 2: 3068, 1: 2957})

Epoch :  25 loss training:  41.7760272026062 Time :  1150
accuracy train: 0.949359 val: 0.774648 test: 0.762802
max validation accuracy : 0.784507 max acc epoch : 22 test accuracy : 0.763365
Counter({2: 4621, 0: 3080, 1: 2961})

Epoch :  26 loss training:  39.49644121527672 Time :  1164
accuracy train: 0.951860 val: 0.774648 test: 0.762240
max validation accuracy : 0.784507 max acc epoch : 22 test accuracy : 0.763365
Counter({2: 4625, 0: 3078, 1: 2959})

Epoch :  27 loss training:  38.38364417850971 Time :  1180
accuracy train: 0.956862 val: 0.774648 test: 0.762240
max validation accuracy : 0.784507 max acc epoch : 22 test accuracy : 0.763365
Counter({2: 4613, 1: 3065, 0: 2984})

Epoch :  28 loss training:  38.19437500834465 Time :  1199
accuracy train: 0.961550 val: 0.778873 test: 0.763365
max validation accuracy : 0.784507 max acc epoch : 22 test accuracy : 0.763365
Counter({1: 4631, 0: 3054, 2: 2977})

Epoch :  29 loss training:  35.24948821216822 Time :  1214
accuracy train: 0.967177 val: 0.784507 test: 0.763084
max validation accuracy : 0.784507 max acc epoch : 22 test accuracy : 0.763365
Counter({2: 4621, 1: 3050, 0: 2991})

Epoch :  30 loss training:  35.24648912996054 Time :  1229
accuracy train: 0.970303 val: 0.778873 test: 0.759989
max validation accuracy : 0.784507 max acc epoch : 22 test accuracy : 0.763365
Counter({2: 4636, 0: 3062, 1: 2964})

Epoch :  31 loss training:  33.61850703507662 Time :  1244
accuracy train: 0.972648 val: 0.780282 test: 0.764772
max validation accuracy : 0.784507 max acc epoch : 22 test accuracy : 0.763365
Counter({2: 4651, 0: 3040, 1: 2971})

Epoch :  32 loss training:  32.078653782606125 Time :  1260
accuracy train: 0.974836 val: 0.774648 test: 0.763928
max validation accuracy : 0.784507 max acc epoch : 22 test accuracy : 0.763365
Counter({2: 4642, 1: 3054, 0: 2966})

Epoch :  33 loss training:  30.572289008647203 Time :  1275
accuracy train: 0.979056 val: 0.787324 test: 0.766460
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({0: 4651, 2: 3032, 1: 2979})

Epoch :  34 loss training:  29.31355668604374 Time :  1292
accuracy train: 0.981869 val: 0.776056 test: 0.763928
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({0: 4637, 1: 3046, 2: 2979})

Epoch :  35 loss training:  27.428751945495605 Time :  1306
accuracy train: 0.981088 val: 0.781690 test: 0.757456
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({1: 4626, 2: 3058, 0: 2978})

Epoch :  36 loss training:  26.67675894871354 Time :  1333
accuracy train: 0.984995 val: 0.778873 test: 0.761958
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({1: 4615, 2: 3054, 0: 2993})

Epoch :  37 loss training:  25.27113337442279 Time :  1349
accuracy train: 0.986871 val: 0.778873 test: 0.761114
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({1: 4632, 2: 3034, 0: 2996})

Epoch :  38 loss training:  23.19450182467699 Time :  1364
accuracy train: 0.989528 val: 0.769014 test: 0.760551
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({2: 4604, 1: 3047, 0: 3011})

Epoch :  39 loss training:  23.751304615288973 Time :  1380
accuracy train: 0.989059 val: 0.773239 test: 0.757456
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({0: 4650, 2: 3021, 1: 2991})

Epoch :  40 loss training:  22.707975074648857 Time :  1395
accuracy train: 0.990153 val: 0.777465 test: 0.761396
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({1: 4628, 0: 3033, 2: 3001})

Epoch :  41 loss training:  21.69744523614645 Time :  1411
accuracy train: 0.991560 val: 0.781690 test: 0.761114
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({0: 4610, 2: 3028, 1: 3024})

Epoch :  42 loss training:  21.39123273268342 Time :  1426
accuracy train: 0.992967 val: 0.777465 test: 0.761396
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({0: 4602, 1: 3052, 2: 3008})

Epoch :  43 loss training:  18.98746212758124 Time :  1447
accuracy train: 0.994998 val: 0.780282 test: 0.761396
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({1: 4595, 2: 3044, 0: 3023})

Epoch :  44 loss training:  19.109818931668997 Time :  1462
accuracy train: 0.993904 val: 0.770423 test: 0.766179
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({2: 4586, 1: 3042, 0: 3034})

Epoch :  45 loss training:  16.9821125715971 Time :  1477
accuracy train: 0.996249 val: 0.771831 test: 0.756331
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({0: 4581, 1: 3045, 2: 3036})

Epoch :  46 loss training:  17.06848571076989 Time :  1492
accuracy train: 0.997030 val: 0.781690 test: 0.763647
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({0: 4527, 2: 3104, 1: 3031})

Epoch :  47 loss training:  17.380288353189826 Time :  1508
accuracy train: 0.997187 val: 0.777465 test: 0.759145
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({0: 4514, 2: 3093, 1: 3055})

Epoch :  48 loss training:  15.544259071350098 Time :  1523
accuracy train: 0.997968 val: 0.771831 test: 0.757738
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({2: 4517, 1: 3101, 0: 3044})

Epoch :  49 loss training:  15.266298476606607 Time :  1538
accuracy train: 0.998906 val: 0.776056 test: 0.763084
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({2: 4533, 0: 3079, 1: 3050})

Epoch :  50 loss training:  14.722040331922472 Time :  1555
accuracy train: 0.998124 val: 0.767606 test: 0.754924
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({2: 4526, 0: 3081, 1: 3055})

Epoch :  51 loss training:  13.70644084457308 Time :  1571
accuracy train: 0.999375 val: 0.774648 test: 0.759145
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({0: 4510, 2: 3101, 1: 3051})

Epoch :  52 loss training:  14.092056862078607 Time :  1587
accuracy train: 0.999375 val: 0.773239 test: 0.758301
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({0: 4513, 1: 3090, 2: 3059})

Epoch :  53 loss training:  12.94075356516987 Time :  1604
accuracy train: 0.999375 val: 0.764789 test: 0.754924
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({2: 4510, 0: 3103, 1: 3049})

Epoch :  54 loss training:  12.236184978857636 Time :  1619
accuracy train: 0.999062 val: 0.773239 test: 0.757738
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({2: 4528, 0: 3087, 1: 3047})

Epoch :  55 loss training:  12.317499083466828 Time :  1634
accuracy train: 0.999687 val: 0.774648 test: 0.757175
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({1: 4536, 0: 3083, 2: 3043})

Epoch :  56 loss training:  11.276309011504054 Time :  1651
accuracy train: 0.999687 val: 0.769014 test: 0.753517
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({0: 4555, 2: 3084, 1: 3023})

Epoch :  57 loss training:  11.357155081816018 Time :  1666
accuracy train: 0.999531 val: 0.769014 test: 0.760833
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({2: 4540, 1: 3095, 0: 3027})

Epoch :  58 loss training:  11.018417546525598 Time :  1695
accuracy train: 0.999844 val: 0.776056 test: 0.758019
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({0: 4552, 1: 3102, 2: 3008})

Epoch :  59 loss training:  10.560626074671745 Time :  1709
accuracy train: 0.999687 val: 0.773239 test: 0.753236
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({1: 4535, 0: 3105, 2: 3022})

Epoch :  60 loss training:  11.229790847748518 Time :  1724
accuracy train: 0.999844 val: 0.777465 test: 0.761677
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({2: 4549, 0: 3111, 1: 3002})

Epoch :  61 loss training:  9.660071790684015 Time :  1740
accuracy train: 1.000000 val: 0.773239 test: 0.757738
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({2: 4548, 0: 3102, 1: 3012})

Epoch :  62 loss training:  9.58136633830145 Time :  1756
accuracy train: 1.000000 val: 0.769014 test: 0.756331
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({0: 4551, 2: 3100, 1: 3011})

Epoch :  63 loss training:  9.029123629676178 Time :  1771
accuracy train: 0.999844 val: 0.761972 test: 0.756894
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({2: 4548, 0: 3098, 1: 3016})

Epoch :  64 loss training:  8.74563033087179 Time :  1786
accuracy train: 1.000000 val: 0.766197 test: 0.758301
max validation accuracy : 0.787324 max acc epoch : 33 test accuracy : 0.766460
Counter({2: 4567, 1: 3101, 0: 2994})

========================================================================================================================================================================================================
max acc epoch :  33
max validation accuracy :  0.7873239436619718
test accuracy :  0.7664603263927968
last test_accuracy :  0.7583005064715813
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=441, weight_decay=0)
device :  cuda:0
Counter({0: 5133, 1: 3267, 2: 2262})

Epoch :  1 loss training:  91.25118830800056 Time :  1829
accuracy train: 0.782745 val: 0.745070 test: 0.765898
max validation accuracy : 0.745070 max acc epoch : 1 test accuracy : 0.765898
Counter({1: 4056, 0: 3933, 2: 2673})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.67661011219025 Time :  1845
accuracy train: 0.789622 val: 0.745070 test: 0.756894
max validation accuracy : 0.745070 max acc epoch : 1 test accuracy : 0.765898
Counter({0: 4185, 1: 3554, 2: 2923})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.47956138849258 Time :  1860
accuracy train: 0.809315 val: 0.766197 test: 0.769837
max validation accuracy : 0.766197 max acc epoch : 3 test accuracy : 0.769837
Counter({2: 4128, 1: 3389, 0: 3145})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.20138700306416 Time :  1876
accuracy train: 0.827446 val: 0.774648 test: 0.777997
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({2: 4169, 1: 3252, 0: 3241})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.71658338606358 Time :  1891
accuracy train: 0.826039 val: 0.764789 test: 0.766460
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({2: 4093, 0: 3343, 1: 3226})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.94929984211922 Time :  1906
accuracy train: 0.833698 val: 0.753521 test: 0.764209
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({2: 4419, 0: 3193, 1: 3050})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  68.06278032064438 Time :  1921
accuracy train: 0.854017 val: 0.754930 test: 0.773495
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({1: 4463, 0: 3256, 2: 2943})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.87577971816063 Time :  1940
accuracy train: 0.862613 val: 0.764789 test: 0.772369
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({0: 4462, 2: 3326, 1: 2874})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.321128487586975 Time :  1956
accuracy train: 0.869022 val: 0.756338 test: 0.764491
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({0: 4571, 2: 3219, 1: 2872})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.99762246012688 Time :  1973
accuracy train: 0.877618 val: 0.756338 test: 0.768149
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({1: 4602, 0: 3208, 2: 2852})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  61.15489903092384 Time :  1988
accuracy train: 0.879025 val: 0.761972 test: 0.770400
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({1: 4516, 2: 3315, 0: 2831})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.07154807448387 Time :  2003
accuracy train: 0.882307 val: 0.757746 test: 0.768149
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({1: 4576, 0: 3265, 2: 2821})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  58.735790461301804 Time :  2018
accuracy train: 0.888872 val: 0.753521 test: 0.767586
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({0: 4539, 1: 3295, 2: 2828})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  58.18865357339382 Time :  2033
accuracy train: 0.893560 val: 0.763380 test: 0.762521
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({0: 4571, 2: 3268, 1: 2823})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  57.708065524697304 Time :  2046
accuracy train: 0.894967 val: 0.761972 test: 0.765335
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({0: 4563, 2: 3273, 1: 2826})

Epoch :  16 loss training:  56.48175209760666 Time :  2075
accuracy train: 0.899656 val: 0.760563 test: 0.767304
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({0: 4585, 2: 3292, 1: 2785})

Epoch :  17 loss training:  55.714986339211464 Time :  2092
accuracy train: 0.905283 val: 0.763380 test: 0.766179
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({2: 4560, 0: 3308, 1: 2794})

Epoch :  18 loss training:  52.89960381388664 Time :  2109
accuracy train: 0.913254 val: 0.757746 test: 0.764209
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({2: 4573, 0: 3309, 1: 2780})

Epoch :  19 loss training:  51.91583360731602 Time :  2125
accuracy train: 0.916693 val: 0.754930 test: 0.769274
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({1: 4590, 0: 3269, 2: 2803})

Epoch :  20 loss training:  50.63280914723873 Time :  2141
accuracy train: 0.923257 val: 0.760563 test: 0.764209
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({1: 4604, 2: 3282, 0: 2776})

Epoch :  21 loss training:  48.96046865731478 Time :  2157
accuracy train: 0.926696 val: 0.766197 test: 0.765335
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({0: 4566, 1: 3313, 2: 2783})

Epoch :  22 loss training:  46.731445625424385 Time :  2174
accuracy train: 0.930916 val: 0.757746 test: 0.767586
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({0: 4570, 2: 3310, 1: 2782})

Epoch :  23 loss training:  45.68902810662985 Time :  2194
accuracy train: 0.938575 val: 0.764789 test: 0.763365
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({2: 4566, 1: 3329, 0: 2767})

Epoch :  24 loss training:  44.819178350269794 Time :  2210
accuracy train: 0.943264 val: 0.763380 test: 0.763647
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({1: 4495, 2: 3399, 0: 2768})

Epoch :  25 loss training:  42.48003746569157 Time :  2225
accuracy train: 0.948734 val: 0.763380 test: 0.763928
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({0: 4492, 1: 3383, 2: 2787})

Epoch :  26 loss training:  40.60564509034157 Time :  2241
accuracy train: 0.950453 val: 0.760563 test: 0.768711
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({0: 4530, 2: 3350, 1: 2782})

Epoch :  27 loss training:  38.85961329936981 Time :  2257
accuracy train: 0.956080 val: 0.764789 test: 0.761677
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({1: 4483, 2: 3411, 0: 2768})

Epoch :  28 loss training:  38.47307901084423 Time :  2275
accuracy train: 0.958737 val: 0.757746 test: 0.765053
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({2: 4480, 0: 3422, 1: 2760})

Epoch :  29 loss training:  36.90341102331877 Time :  2292
accuracy train: 0.965614 val: 0.759155 test: 0.765335
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({1: 4483, 2: 3453, 0: 2726})

Epoch :  30 loss training:  36.82006748020649 Time :  2309
accuracy train: 0.967021 val: 0.760563 test: 0.763365
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({1: 4496, 2: 3425, 0: 2741})

Epoch :  31 loss training:  34.303065307438374 Time :  2338
accuracy train: 0.970303 val: 0.769014 test: 0.767023
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({2: 4488, 0: 3457, 1: 2717})

Epoch :  32 loss training:  32.64107210934162 Time :  2355
accuracy train: 0.972491 val: 0.766197 test: 0.759426
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({2: 4474, 1: 3464, 0: 2724})

Epoch :  33 loss training:  31.444705363363028 Time :  2370
accuracy train: 0.977493 val: 0.773239 test: 0.762521
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({1: 4462, 0: 3482, 2: 2718})

Epoch :  34 loss training:  30.714605163782835 Time :  2387
accuracy train: 0.978900 val: 0.771831 test: 0.761114
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({2: 4461, 1: 3476, 0: 2725})

Epoch :  35 loss training:  28.91739973425865 Time :  2403
accuracy train: 0.979681 val: 0.753521 test: 0.757456
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.777997
Counter({0: 4454, 1: 3439, 2: 2769})

========================================================================================================================================================================================================
max acc epoch :  4
max validation accuracy :  0.7746478873239436
test accuracy :  0.7779966235227912
last test_accuracy :  0.7574563871693866
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=441, weight_decay=0)
device :  cuda:0
Counter({0: 5133, 1: 3267, 2: 2262})

Epoch :  1 loss training:  91.27334859967232 Time :  2425
accuracy train: 0.780556 val: 0.749296 test: 0.767867
max validation accuracy : 0.749296 max acc epoch : 1 test accuracy : 0.767867
Counter({0: 4201, 2: 3488, 1: 2973})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.18120601773262 Time :  2443
accuracy train: 0.786183 val: 0.754930 test: 0.756050
max validation accuracy : 0.754930 max acc epoch : 2 test accuracy : 0.756050
Counter({1: 4196, 2: 3270, 0: 3196})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.4432515501976 Time :  2464
accuracy train: 0.815098 val: 0.752113 test: 0.774339
max validation accuracy : 0.754930 max acc epoch : 2 test accuracy : 0.756050
Counter({2: 4071, 1: 3447, 0: 3144})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.18330854177475 Time :  2481
accuracy train: 0.822288 val: 0.763380 test: 0.770681
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.770681
Counter({2: 4179, 1: 3357, 0: 3126})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.93915711343288 Time :  2499
accuracy train: 0.821976 val: 0.759155 test: 0.765898
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.770681
Counter({1: 4495, 0: 3201, 2: 2966})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.89739406108856 Time :  2517
accuracy train: 0.830259 val: 0.763380 test: 0.765616
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.770681
Counter({0: 4673, 2: 3086, 1: 2903})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  68.03440369665623 Time :  2533
accuracy train: 0.849953 val: 0.763380 test: 0.773495
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.770681
Counter({1: 4806, 0: 3024, 2: 2832})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.5634271800518 Time :  2548
accuracy train: 0.858706 val: 0.767606 test: 0.770962
max validation accuracy : 0.767606 max acc epoch : 8 test accuracy : 0.770962
Counter({0: 4947, 2: 2880, 1: 2835})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.247548162937164 Time :  2563
accuracy train: 0.859644 val: 0.743662 test: 0.774902
max validation accuracy : 0.767606 max acc epoch : 8 test accuracy : 0.770962
Counter({0: 5048, 1: 2813, 2: 2801})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.09777349233627 Time :  2579
accuracy train: 0.877462 val: 0.763380 test: 0.767586
max validation accuracy : 0.767606 max acc epoch : 8 test accuracy : 0.770962
Counter({1: 5107, 2: 2780, 0: 2775})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.36960506439209 Time :  2611
accuracy train: 0.878087 val: 0.766197 test: 0.768993
max validation accuracy : 0.767606 max acc epoch : 8 test accuracy : 0.770962
Counter({1: 5111, 2: 2776, 0: 2775})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.238337740302086 Time :  2627
accuracy train: 0.881369 val: 0.783099 test: 0.766179
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({2: 5192, 1: 2769, 0: 2701})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  58.067464768886566 Time :  2643
accuracy train: 0.890435 val: 0.771831 test: 0.765053
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({2: 5179, 0: 2760, 1: 2723})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.76867014169693 Time :  2658
accuracy train: 0.893873 val: 0.770423 test: 0.764772
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({1: 5209, 2: 2745, 0: 2708})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  57.14784000813961 Time :  2673
accuracy train: 0.894967 val: 0.771831 test: 0.768430
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({2: 5194, 0: 2749, 1: 2719})

Epoch :  16 loss training:  55.3852801322937 Time :  2689
accuracy train: 0.901219 val: 0.761972 test: 0.766460
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({2: 5198, 0: 2743, 1: 2721})

Epoch :  17 loss training:  54.946959018707275 Time :  2705
accuracy train: 0.909972 val: 0.763380 test: 0.768711
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({1: 5191, 2: 2737, 0: 2734})

Epoch :  18 loss training:  52.242208793759346 Time :  2721
accuracy train: 0.913879 val: 0.769014 test: 0.770681
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({2: 5208, 0: 2737, 1: 2717})

Epoch :  19 loss training:  51.767669424414635 Time :  2747
accuracy train: 0.918725 val: 0.773239 test: 0.771244
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({1: 5207, 0: 2747, 2: 2708})

Epoch :  20 loss training:  50.32928894460201 Time :  2762
accuracy train: 0.926540 val: 0.769014 test: 0.769274
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({1: 5223, 0: 2733, 2: 2706})

Epoch :  21 loss training:  48.00728975981474 Time :  2777
accuracy train: 0.928884 val: 0.771831 test: 0.771244
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({2: 5202, 0: 2751, 1: 2709})

Epoch :  22 loss training:  46.47919289022684 Time :  2793
accuracy train: 0.936855 val: 0.777465 test: 0.769555
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({2: 5206, 1: 2736, 0: 2720})

Epoch :  23 loss training:  44.60289214551449 Time :  2807
accuracy train: 0.941857 val: 0.774648 test: 0.770681
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({1: 5194, 0: 2739, 2: 2729})

Epoch :  24 loss training:  43.6088562682271 Time :  2823
accuracy train: 0.945764 val: 0.776056 test: 0.767023
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({1: 5197, 0: 2735, 2: 2730})

Epoch :  25 loss training:  42.91884460300207 Time :  2839
accuracy train: 0.949672 val: 0.770423 test: 0.768430
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({2: 5177, 1: 2744, 0: 2741})

Epoch :  26 loss training:  39.67779383063316 Time :  2854
accuracy train: 0.955455 val: 0.771831 test: 0.772088
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({1: 5198, 0: 2738, 2: 2726})

Epoch :  27 loss training:  38.09119387716055 Time :  2872
accuracy train: 0.958425 val: 0.767606 test: 0.771806
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({2: 5190, 1: 2747, 0: 2725})

Epoch :  28 loss training:  37.86635081470013 Time :  2888
accuracy train: 0.963582 val: 0.763380 test: 0.770962
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({0: 5197, 1: 2738, 2: 2727})

Epoch :  29 loss training:  35.909306079149246 Time :  2904
accuracy train: 0.966552 val: 0.767606 test: 0.771244
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({0: 5170, 2: 2750, 1: 2742})

Epoch :  30 loss training:  35.88475972414017 Time :  2919
accuracy train: 0.969834 val: 0.763380 test: 0.770118
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({1: 5170, 0: 2754, 2: 2738})

Epoch :  31 loss training:  33.63106381520629 Time :  2934
accuracy train: 0.970616 val: 0.769014 test: 0.772369
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({1: 5179, 0: 2760, 2: 2723})

Epoch :  32 loss training:  31.96116414666176 Time :  2948
accuracy train: 0.974836 val: 0.761972 test: 0.776027
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({2: 5155, 1: 2775, 0: 2732})

Epoch :  33 loss training:  30.92673397064209 Time :  2962
accuracy train: 0.978900 val: 0.761972 test: 0.774339
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({1: 5157, 2: 2762, 0: 2743})

Epoch :  34 loss training:  29.968090634793043 Time :  2976
accuracy train: 0.978587 val: 0.757746 test: 0.765616
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({2: 5167, 0: 2760, 1: 2735})

Epoch :  35 loss training:  28.407350480556488 Time :  2998
accuracy train: 0.984058 val: 0.750704 test: 0.771525
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({2: 5148, 1: 2781, 0: 2733})

Epoch :  36 loss training:  27.378809556365013 Time :  3013
accuracy train: 0.984683 val: 0.754930 test: 0.773776
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({2: 5124, 0: 2786, 1: 2752})

Epoch :  37 loss training:  25.447637513279915 Time :  3029
accuracy train: 0.987652 val: 0.753521 test: 0.768993
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({2: 5145, 0: 2778, 1: 2739})

Epoch :  38 loss training:  24.17841518856585 Time :  3045
accuracy train: 0.988746 val: 0.757746 test: 0.768149
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({1: 5138, 0: 2786, 2: 2738})

Epoch :  39 loss training:  23.90374195203185 Time :  3060
accuracy train: 0.992341 val: 0.756338 test: 0.766179
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({2: 5126, 1: 2790, 0: 2746})

Epoch :  40 loss training:  22.88883143477142 Time :  3075
accuracy train: 0.990778 val: 0.759155 test: 0.774339
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({2: 5125, 0: 2802, 1: 2735})

Epoch :  41 loss training:  21.70451333746314 Time :  3090
accuracy train: 0.992185 val: 0.753521 test: 0.768711
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({1: 5143, 0: 2805, 2: 2714})

Epoch :  42 loss training:  20.774309150874615 Time :  3107
accuracy train: 0.993748 val: 0.760563 test: 0.771244
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({2: 5134, 0: 2820, 1: 2708})

Epoch :  43 loss training:  19.76054196059704 Time :  3132
accuracy train: 0.994217 val: 0.754930 test: 0.767304
max validation accuracy : 0.783099 max acc epoch : 12 test accuracy : 0.766179
Counter({1: 5111, 0: 2828, 2: 2723})

========================================================================================================================================================================================================
max acc epoch :  12
max validation accuracy :  0.7830985915492957
test accuracy :  0.7661789532920653
last test_accuracy :  0.7673044456949916
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=441, weight_decay=0)
device :  cuda:0
Counter({0: 5133, 1: 3267, 2: 2262})

Epoch :  1 loss training:  91.25657185912132 Time :  3151
accuracy train: 0.781182 val: 0.743662 test: 0.766742
max validation accuracy : 0.743662 max acc epoch : 1 test accuracy : 0.766742
Counter({2: 4064, 1: 4018, 0: 2580})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.08179764449596 Time :  3164
accuracy train: 0.790560 val: 0.746479 test: 0.759989
max validation accuracy : 0.746479 max acc epoch : 2 test accuracy : 0.759989
Counter({2: 3664, 0: 3551, 1: 3447})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.53550285100937 Time :  3180
accuracy train: 0.809784 val: 0.759155 test: 0.771244
max validation accuracy : 0.759155 max acc epoch : 3 test accuracy : 0.771244
Counter({0: 4214, 2: 3323, 1: 3125})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.1388831436634 Time :  3194
accuracy train: 0.826508 val: 0.760563 test: 0.767304
max validation accuracy : 0.760563 max acc epoch : 4 test accuracy : 0.767304
Counter({2: 4264, 1: 3257, 0: 3141})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.01627396047115 Time :  3209
accuracy train: 0.822445 val: 0.761972 test: 0.764772
max validation accuracy : 0.761972 max acc epoch : 5 test accuracy : 0.764772
Counter({0: 4305, 2: 3256, 1: 3101})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.79902677237988 Time :  3223
accuracy train: 0.841200 val: 0.761972 test: 0.774057
max validation accuracy : 0.761972 max acc epoch : 5 test accuracy : 0.764772
Counter({1: 4430, 2: 3150, 0: 3082})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.32907536625862 Time :  3239
accuracy train: 0.859018 val: 0.776056 test: 0.776590
max validation accuracy : 0.776056 max acc epoch : 7 test accuracy : 0.776590
Counter({0: 4539, 2: 3063, 1: 3060})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.29392808675766 Time :  3257
accuracy train: 0.862144 val: 0.780282 test: 0.773495
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({2: 4575, 1: 3071, 0: 3016})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.97344656288624 Time :  3271
accuracy train: 0.867771 val: 0.757746 test: 0.770681
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({0: 4555, 2: 3106, 1: 3001})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.5241114795208 Time :  3286
accuracy train: 0.879806 val: 0.754930 test: 0.769555
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({1: 4569, 2: 3088, 0: 3005})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.65156689286232 Time :  3299
accuracy train: 0.880119 val: 0.776056 test: 0.767304
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({1: 4600, 2: 3063, 0: 2999})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.96416589617729 Time :  3315
accuracy train: 0.885433 val: 0.769014 test: 0.761958
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({1: 4729, 2: 3022, 0: 2911})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  58.05773268640041 Time :  3330
accuracy train: 0.891372 val: 0.774648 test: 0.765898
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({2: 4729, 1: 2992, 0: 2941})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.638231724500656 Time :  3344
accuracy train: 0.897312 val: 0.780282 test: 0.763647
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({0: 4764, 1: 2974, 2: 2924})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.94175073504448 Time :  3360
accuracy train: 0.898093 val: 0.771831 test: 0.769274
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({2: 4765, 0: 2972, 1: 2925})

Epoch :  16 loss training:  55.63095389306545 Time :  3377
accuracy train: 0.902938 val: 0.769014 test: 0.765053
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({2: 4755, 1: 2973, 0: 2934})

Epoch :  17 loss training:  55.35057380795479 Time :  3392
accuracy train: 0.909972 val: 0.764789 test: 0.766179
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({2: 4766, 1: 2964, 0: 2932})

Epoch :  18 loss training:  52.72609907388687 Time :  3407
accuracy train: 0.917474 val: 0.766197 test: 0.765898
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({2: 4752, 1: 2974, 0: 2936})

Epoch :  19 loss training:  52.110342144966125 Time :  3422
accuracy train: 0.920600 val: 0.776056 test: 0.767867
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({2: 4752, 1: 2982, 0: 2928})

Epoch :  20 loss training:  50.48416458070278 Time :  3436
accuracy train: 0.928728 val: 0.774648 test: 0.769555
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({1: 4723, 2: 3000, 0: 2939})

Epoch :  21 loss training:  48.13355180621147 Time :  3450
accuracy train: 0.931072 val: 0.764789 test: 0.770681
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({2: 4745, 0: 2991, 1: 2926})

Epoch :  22 loss training:  46.52485781908035 Time :  3465
accuracy train: 0.935761 val: 0.766197 test: 0.769555
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({2: 4745, 1: 3004, 0: 2913})

Epoch :  23 loss training:  45.07062977552414 Time :  3483
accuracy train: 0.943732 val: 0.764789 test: 0.769274
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({0: 4736, 1: 2992, 2: 2934})

Epoch :  24 loss training:  43.810205563902855 Time :  3498
accuracy train: 0.944983 val: 0.767606 test: 0.768711
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({2: 4770, 1: 2971, 0: 2921})

Epoch :  25 loss training:  42.274023815989494 Time :  3514
accuracy train: 0.950453 val: 0.766197 test: 0.764491
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({1: 4735, 0: 2997, 2: 2930})

Epoch :  26 loss training:  40.21475216001272 Time :  3529
accuracy train: 0.952798 val: 0.766197 test: 0.767867
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({0: 4739, 2: 3008, 1: 2915})

Epoch :  27 loss training:  38.5358020067215 Time :  3542
accuracy train: 0.958268 val: 0.761972 test: 0.766742
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({2: 4760, 0: 2999, 1: 2903})

Epoch :  28 loss training:  37.97859559208155 Time :  3555
accuracy train: 0.963739 val: 0.756338 test: 0.769274
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({1: 4733, 2: 2986, 0: 2943})

Epoch :  29 loss training:  35.57590314373374 Time :  3570
accuracy train: 0.967021 val: 0.767606 test: 0.769837
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({0: 4723, 2: 2998, 1: 2941})

Epoch :  30 loss training:  36.88746403157711 Time :  3585
accuracy train: 0.969834 val: 0.770423 test: 0.768993
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({2: 4704, 1: 3023, 0: 2935})

Epoch :  31 loss training:  33.84136852622032 Time :  3603
accuracy train: 0.972023 val: 0.773239 test: 0.768149
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({0: 4691, 2: 3028, 1: 2943})

Epoch :  32 loss training:  32.712564669549465 Time :  3620
accuracy train: 0.976243 val: 0.771831 test: 0.767586
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({1: 4687, 0: 3042, 2: 2933})

Epoch :  33 loss training:  31.67025149613619 Time :  3633
accuracy train: 0.978743 val: 0.763380 test: 0.768993
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({0: 4680, 2: 3052, 1: 2930})

Epoch :  34 loss training:  29.861098054796457 Time :  3648
accuracy train: 0.980150 val: 0.766197 test: 0.765898
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({2: 4678, 0: 3056, 1: 2928})

Epoch :  35 loss training:  28.478525392711163 Time :  3663
accuracy train: 0.981869 val: 0.759155 test: 0.762240
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({0: 4656, 2: 3066, 1: 2940})

Epoch :  36 loss training:  27.60977042466402 Time :  3678
accuracy train: 0.983589 val: 0.769014 test: 0.765898
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({1: 4631, 2: 3085, 0: 2946})

Epoch :  37 loss training:  25.84143514558673 Time :  3693
accuracy train: 0.985621 val: 0.759155 test: 0.761958
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({0: 4661, 2: 3066, 1: 2935})

Epoch :  38 loss training:  24.525615092366934 Time :  3707
accuracy train: 0.987809 val: 0.760563 test: 0.760551
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({1: 4665, 0: 3053, 2: 2944})

Epoch :  39 loss training:  24.258175138384104 Time :  3726
accuracy train: 0.989215 val: 0.760563 test: 0.762802
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.773495
Counter({0: 4655, 1: 3045, 2: 2962})

========================================================================================================================================================================================================
max acc epoch :  8
max validation accuracy :  0.780281690140845
test accuracy :  0.7734946539110861
last test_accuracy :  0.7628024760832864
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=441, weight_decay=0)
device :  cuda:0
Counter({0: 5133, 1: 3267, 2: 2262})

Epoch :  1 loss training:  91.18936413526535 Time :  3746
accuracy train: 0.784933 val: 0.745070 test: 0.770400
max validation accuracy : 0.745070 max acc epoch : 1 test accuracy : 0.770400
Counter({0: 4067, 2: 3990, 1: 2605})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.03948184847832 Time :  3761
accuracy train: 0.792123 val: 0.749296 test: 0.758019
max validation accuracy : 0.749296 max acc epoch : 2 test accuracy : 0.758019
Counter({0: 4026, 1: 3598, 2: 3038})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.26622539758682 Time :  3777
accuracy train: 0.808690 val: 0.764789 test: 0.768430
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.768430
Counter({1: 4354, 0: 3400, 2: 2908})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.6810183674097 Time :  3790
accuracy train: 0.821194 val: 0.777465 test: 0.769837
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({2: 4387, 1: 3224, 0: 3051})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.16501919925213 Time :  3804
accuracy train: 0.824789 val: 0.753521 test: 0.766742
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({2: 4273, 1: 3230, 0: 3159})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  72.14920055866241 Time :  3817
accuracy train: 0.840106 val: 0.754930 test: 0.772369
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({1: 4467, 2: 3185, 0: 3010})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.12840162217617 Time :  3832
accuracy train: 0.851829 val: 0.760563 test: 0.772932
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({2: 4644, 1: 3166, 0: 2852})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.20990361273289 Time :  3851
accuracy train: 0.864958 val: 0.767606 test: 0.765898
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({2: 4613, 1: 3117, 0: 2932})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.779326766729355 Time :  3866
accuracy train: 0.866677 val: 0.750704 test: 0.765053
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({1: 4717, 0: 3124, 2: 2821})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.75405924022198 Time :  3882
accuracy train: 0.882307 val: 0.761972 test: 0.768149
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({2: 4733, 0: 3118, 1: 2811})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.47747726738453 Time :  3898
accuracy train: 0.876993 val: 0.770423 test: 0.765616
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({0: 4730, 1: 3112, 2: 2820})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.443205550312996 Time :  3914
accuracy train: 0.887309 val: 0.771831 test: 0.765335
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({2: 4828, 1: 3083, 0: 2751})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  58.525708094239235 Time :  3928
accuracy train: 0.891216 val: 0.767606 test: 0.764772
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({0: 4806, 1: 3092, 2: 2764})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.85826389491558 Time :  3942
accuracy train: 0.894811 val: 0.774648 test: 0.765616
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({0: 4859, 1: 3087, 2: 2716})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  57.54053582251072 Time :  3958
accuracy train: 0.896530 val: 0.773239 test: 0.772088
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({0: 4876, 2: 3072, 1: 2714})

Epoch :  16 loss training:  56.826946929097176 Time :  3978
accuracy train: 0.902157 val: 0.770423 test: 0.767304
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({2: 4885, 1: 3066, 0: 2711})

Epoch :  17 loss training:  55.710486352443695 Time :  3993
accuracy train: 0.907315 val: 0.769014 test: 0.769837
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({2: 4860, 0: 3057, 1: 2745})

Epoch :  18 loss training:  52.884772911667824 Time :  4009
accuracy train: 0.913723 val: 0.767606 test: 0.769274
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({0: 4879, 2: 3064, 1: 2719})

Epoch :  19 loss training:  51.334464371204376 Time :  4024
accuracy train: 0.918099 val: 0.769014 test: 0.772088
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({2: 4883, 0: 3060, 1: 2719})

Epoch :  20 loss training:  50.235221832990646 Time :  4040
accuracy train: 0.923414 val: 0.776056 test: 0.768993
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({0: 4878, 2: 3044, 1: 2740})

Epoch :  21 loss training:  48.64596801251173 Time :  4056
accuracy train: 0.927321 val: 0.773239 test: 0.768149
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({2: 4848, 1: 3044, 0: 2770})

Epoch :  22 loss training:  46.320820443332195 Time :  4071
accuracy train: 0.932635 val: 0.773239 test: 0.770400
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({0: 4811, 2: 3048, 1: 2803})

Epoch :  23 loss training:  45.171882063150406 Time :  4090
accuracy train: 0.938418 val: 0.776056 test: 0.766179
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({0: 4784, 2: 3029, 1: 2849})

Epoch :  24 loss training:  43.97861272841692 Time :  4105
accuracy train: 0.940763 val: 0.771831 test: 0.769274
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({1: 4766, 0: 3040, 2: 2856})

Epoch :  25 loss training:  42.67761607468128 Time :  4121
accuracy train: 0.945139 val: 0.753521 test: 0.761396
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({1: 4693, 2: 3037, 0: 2932})

Epoch :  26 loss training:  40.14957331120968 Time :  4137
accuracy train: 0.951704 val: 0.769014 test: 0.769555
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({2: 4726, 0: 3034, 1: 2902})

Epoch :  27 loss training:  39.17576690763235 Time :  4154
accuracy train: 0.955611 val: 0.754930 test: 0.765335
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({2: 4760, 1: 3003, 0: 2899})

Epoch :  28 loss training:  37.84221974015236 Time :  4169
accuracy train: 0.960925 val: 0.757746 test: 0.766179
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({2: 4711, 1: 3026, 0: 2925})

Epoch :  29 loss training:  36.589470282197 Time :  4185
accuracy train: 0.965458 val: 0.757746 test: 0.765053
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({2: 4714, 0: 3009, 1: 2939})

Epoch :  30 loss training:  36.69123683124781 Time :  4200
accuracy train: 0.968428 val: 0.757746 test: 0.767023
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({2: 4713, 0: 3036, 1: 2913})

Epoch :  31 loss training:  34.17122868448496 Time :  4223
accuracy train: 0.971241 val: 0.759155 test: 0.770118
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({2: 4722, 0: 3004, 1: 2936})

Epoch :  32 loss training:  32.9336629062891 Time :  4237
accuracy train: 0.973742 val: 0.767606 test: 0.767023
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({0: 4639, 1: 3024, 2: 2999})

Epoch :  33 loss training:  31.74007737636566 Time :  4253
accuracy train: 0.976868 val: 0.767606 test: 0.768711
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({0: 4652, 1: 3010, 2: 3000})

Epoch :  34 loss training:  30.57175485789776 Time :  4267
accuracy train: 0.977962 val: 0.763380 test: 0.764491
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({2: 4640, 1: 3019, 0: 3003})

Epoch :  35 loss training:  27.99972139298916 Time :  4282
accuracy train: 0.983276 val: 0.770423 test: 0.765053
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.769837
Counter({1: 4615, 0: 3034, 2: 3013})

========================================================================================================================================================================================================
max acc epoch :  4
max validation accuracy :  0.7774647887323943
test accuracy :  0.7698368036015757
last test_accuracy :  0.765053460889139
========================================================================================================================================================================================================

itr : 6
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=441, weight_decay=0)
device :  cuda:0
Counter({0: 5133, 1: 3267, 2: 2262})

Epoch :  1 loss training:  91.34458148479462 Time :  4301
accuracy train: 0.783526 val: 0.746479 test: 0.765335
max validation accuracy : 0.746479 max acc epoch : 1 test accuracy : 0.765335
Counter({2: 3966, 0: 3848, 1: 2848})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.016774892807 Time :  4318
accuracy train: 0.792748 val: 0.747887 test: 0.759707
max validation accuracy : 0.747887 max acc epoch : 2 test accuracy : 0.759707
Counter({0: 4096, 2: 3601, 1: 2965})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.45324069261551 Time :  4336
accuracy train: 0.807440 val: 0.763380 test: 0.774620
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.774620
Counter({2: 4067, 1: 3597, 0: 2998})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.06034111976624 Time :  4350
accuracy train: 0.829009 val: 0.770423 test: 0.773495
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.773495
Counter({0: 4114, 2: 3590, 1: 2958})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.32759682834148 Time :  4365
accuracy train: 0.823851 val: 0.771831 test: 0.767586
max validation accuracy : 0.771831 max acc epoch : 5 test accuracy : 0.767586
Counter({2: 4169, 0: 3548, 1: 2945})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.03996331989765 Time :  4380
accuracy train: 0.834792 val: 0.761972 test: 0.767586
max validation accuracy : 0.771831 max acc epoch : 5 test accuracy : 0.767586
Counter({0: 4192, 2: 3508, 1: 2962})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.78553713858128 Time :  4392
accuracy train: 0.852766 val: 0.759155 test: 0.774057
max validation accuracy : 0.771831 max acc epoch : 5 test accuracy : 0.767586
Counter({2: 4271, 1: 3398, 0: 2993})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  63.58435009419918 Time :  4406
accuracy train: 0.860894 val: 0.763380 test: 0.768711
max validation accuracy : 0.771831 max acc epoch : 5 test accuracy : 0.767586
Counter({1: 4340, 2: 3343, 0: 2979})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.84746100008488 Time :  4421
accuracy train: 0.864020 val: 0.749296 test: 0.763647
max validation accuracy : 0.771831 max acc epoch : 5 test accuracy : 0.767586
Counter({2: 4385, 0: 3322, 1: 2955})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.86523777246475 Time :  4437
accuracy train: 0.876680 val: 0.757746 test: 0.765616
max validation accuracy : 0.771831 max acc epoch : 5 test accuracy : 0.767586
Counter({1: 4383, 2: 3307, 0: 2972})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.20752418041229 Time :  4455
accuracy train: 0.877618 val: 0.767606 test: 0.765616
max validation accuracy : 0.771831 max acc epoch : 5 test accuracy : 0.767586
Counter({1: 4380, 2: 3321, 0: 2961})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.05791726708412 Time :  4470
accuracy train: 0.888715 val: 0.764789 test: 0.766460
max validation accuracy : 0.771831 max acc epoch : 5 test accuracy : 0.767586
Counter({1: 4396, 0: 3327, 2: 2939})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.04869897663593 Time :  4486
accuracy train: 0.890278 val: 0.764789 test: 0.762802
max validation accuracy : 0.771831 max acc epoch : 5 test accuracy : 0.767586
Counter({1: 4409, 2: 3302, 0: 2951})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.26493684947491 Time :  4501
accuracy train: 0.894498 val: 0.767606 test: 0.759989
max validation accuracy : 0.771831 max acc epoch : 5 test accuracy : 0.767586
Counter({1: 4441, 0: 3300, 2: 2921})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  55.32803377509117 Time :  4516
accuracy train: 0.898093 val: 0.767606 test: 0.766460
max validation accuracy : 0.771831 max acc epoch : 5 test accuracy : 0.767586
Counter({0: 4449, 1: 3295, 2: 2918})

Epoch :  16 loss training:  54.90879261493683 Time :  4531
accuracy train: 0.901063 val: 0.767606 test: 0.765616
max validation accuracy : 0.771831 max acc epoch : 5 test accuracy : 0.767586
Counter({0: 4475, 2: 3256, 1: 2931})

Epoch :  17 loss training:  54.40408597886562 Time :  4546
accuracy train: 0.907158 val: 0.767606 test: 0.766179
max validation accuracy : 0.771831 max acc epoch : 5 test accuracy : 0.767586
Counter({1: 4481, 2: 3249, 0: 2932})

Epoch :  18 loss training:  51.902289524674416 Time :  4562
accuracy train: 0.913879 val: 0.776056 test: 0.765616
max validation accuracy : 0.776056 max acc epoch : 18 test accuracy : 0.765616
Counter({2: 4483, 0: 3251, 1: 2928})

Epoch :  19 loss training:  51.017852142453194 Time :  4587
accuracy train: 0.920913 val: 0.769014 test: 0.766179
max validation accuracy : 0.776056 max acc epoch : 18 test accuracy : 0.765616
Counter({2: 4480, 1: 3260, 0: 2922})

Epoch :  20 loss training:  50.00929057598114 Time :  4602
accuracy train: 0.925914 val: 0.773239 test: 0.765335
max validation accuracy : 0.776056 max acc epoch : 18 test accuracy : 0.765616
Counter({0: 4497, 2: 3239, 1: 2926})

Epoch :  21 loss training:  47.09585376083851 Time :  4617
accuracy train: 0.932010 val: 0.763380 test: 0.765335
max validation accuracy : 0.776056 max acc epoch : 18 test accuracy : 0.765616
Counter({2: 4493, 0: 3240, 1: 2929})

Epoch :  22 loss training:  46.16984039545059 Time :  4632
accuracy train: 0.938262 val: 0.770423 test: 0.762521
max validation accuracy : 0.776056 max acc epoch : 18 test accuracy : 0.765616
Counter({0: 4502, 2: 3239, 1: 2921})

Epoch :  23 loss training:  43.90627843141556 Time :  4648
accuracy train: 0.942326 val: 0.780282 test: 0.766179
max validation accuracy : 0.780282 max acc epoch : 23 test accuracy : 0.766179
Counter({2: 4511, 0: 3213, 1: 2938})

Epoch :  24 loss training:  42.95888190716505 Time :  4663
accuracy train: 0.947171 val: 0.774648 test: 0.764491
max validation accuracy : 0.780282 max acc epoch : 23 test accuracy : 0.766179
Counter({2: 4500, 0: 3216, 1: 2946})

Epoch :  25 loss training:  41.42390505224466 Time :  4680
accuracy train: 0.949984 val: 0.770423 test: 0.763928
max validation accuracy : 0.780282 max acc epoch : 23 test accuracy : 0.766179
Counter({2: 4511, 0: 3217, 1: 2934})

Epoch :  26 loss training:  38.87397298961878 Time :  4697
accuracy train: 0.954830 val: 0.776056 test: 0.764491
max validation accuracy : 0.780282 max acc epoch : 23 test accuracy : 0.766179
Counter({2: 4490, 1: 3225, 0: 2947})

Epoch :  27 loss training:  37.34232361614704 Time :  4713
accuracy train: 0.958581 val: 0.780282 test: 0.760833
max validation accuracy : 0.780282 max acc epoch : 23 test accuracy : 0.766179
Counter({2: 4530, 1: 3213, 0: 2919})

Epoch :  28 loss training:  36.66763438284397 Time :  4729
accuracy train: 0.964520 val: 0.773239 test: 0.761114
max validation accuracy : 0.780282 max acc epoch : 23 test accuracy : 0.766179
Counter({2: 4510, 0: 3212, 1: 2940})

Epoch :  29 loss training:  34.682990193367004 Time :  4745
accuracy train: 0.967177 val: 0.777465 test: 0.763084
max validation accuracy : 0.780282 max acc epoch : 23 test accuracy : 0.766179
Counter({2: 4525, 1: 3196, 0: 2941})

Epoch :  30 loss training:  34.78146284073591 Time :  4761
accuracy train: 0.970460 val: 0.776056 test: 0.761958
max validation accuracy : 0.780282 max acc epoch : 23 test accuracy : 0.766179
Counter({2: 4526, 1: 3202, 0: 2934})

Epoch :  31 loss training:  32.94270383939147 Time :  4777
accuracy train: 0.972023 val: 0.784507 test: 0.763365
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({2: 4547, 1: 3204, 0: 2911})

Epoch :  32 loss training:  32.10502541437745 Time :  4793
accuracy train: 0.976399 val: 0.781690 test: 0.763928
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({2: 4540, 0: 3200, 1: 2922})

Epoch :  33 loss training:  30.639008320868015 Time :  4810
accuracy train: 0.979212 val: 0.773239 test: 0.763365
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({2: 4581, 0: 3154, 1: 2927})

Epoch :  34 loss training:  29.318204298615456 Time :  4827
accuracy train: 0.980150 val: 0.773239 test: 0.761114
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({2: 4576, 0: 3151, 1: 2935})

Epoch :  35 loss training:  27.160599391907454 Time :  4843
accuracy train: 0.984058 val: 0.771831 test: 0.755487
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({2: 4563, 0: 3165, 1: 2934})

Epoch :  36 loss training:  26.457779686897993 Time :  4859
accuracy train: 0.984058 val: 0.773239 test: 0.765898
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({0: 4563, 2: 3170, 1: 2929})

Epoch :  37 loss training:  25.45808594673872 Time :  4875
accuracy train: 0.988278 val: 0.767606 test: 0.763084
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({2: 4574, 1: 3158, 0: 2930})

Epoch :  38 loss training:  23.314614698290825 Time :  4891
accuracy train: 0.990153 val: 0.769014 test: 0.758863
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({0: 4547, 2: 3165, 1: 2950})

Epoch :  39 loss training:  23.639419592916965 Time :  4909
accuracy train: 0.991247 val: 0.770423 test: 0.758301
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({0: 4541, 2: 3172, 1: 2949})

Epoch :  40 loss training:  22.416077118366957 Time :  4924
accuracy train: 0.992185 val: 0.769014 test: 0.762521
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({0: 4566, 2: 3156, 1: 2940})

Epoch :  41 loss training:  21.399123080074787 Time :  4942
accuracy train: 0.991872 val: 0.776056 test: 0.763365
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({2: 4557, 1: 3154, 0: 2951})

Epoch :  42 loss training:  20.27728360891342 Time :  4958
accuracy train: 0.994217 val: 0.771831 test: 0.764491
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({0: 4564, 2: 3161, 1: 2937})

Epoch :  43 loss training:  20.071625720709562 Time :  4974
accuracy train: 0.993904 val: 0.778873 test: 0.765616
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({1: 4557, 2: 3143, 0: 2962})

Epoch :  44 loss training:  19.045025765895844 Time :  4991
accuracy train: 0.995624 val: 0.769014 test: 0.759989
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({2: 4574, 0: 3131, 1: 2957})

Epoch :  45 loss training:  17.486946772783995 Time :  5007
accuracy train: 0.996093 val: 0.753521 test: 0.755487
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({0: 4568, 2: 3128, 1: 2966})

Epoch :  46 loss training:  17.27682569809258 Time :  5023
accuracy train: 0.997187 val: 0.769014 test: 0.761114
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({2: 4565, 1: 3134, 0: 2963})

Epoch :  47 loss training:  16.845151839777827 Time :  5040
accuracy train: 0.996561 val: 0.764789 test: 0.762802
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({2: 4573, 1: 3156, 0: 2933})

Epoch :  48 loss training:  15.43352465517819 Time :  5060
accuracy train: 0.997656 val: 0.757746 test: 0.762240
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({2: 4579, 0: 3139, 1: 2944})

Epoch :  49 loss training:  15.598707217723131 Time :  5076
accuracy train: 0.998593 val: 0.761972 test: 0.761677
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({2: 4603, 1: 3133, 0: 2926})

Epoch :  50 loss training:  14.630323302000761 Time :  5091
accuracy train: 0.997812 val: 0.759155 test: 0.759989
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({2: 4578, 0: 3142, 1: 2942})

Epoch :  51 loss training:  13.673727141693234 Time :  5106
accuracy train: 0.998750 val: 0.760563 test: 0.761677
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({0: 4579, 2: 3134, 1: 2949})

Epoch :  52 loss training:  13.448587304912508 Time :  5122
accuracy train: 0.999219 val: 0.761972 test: 0.760833
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({0: 4607, 1: 3138, 2: 2917})

Epoch :  53 loss training:  12.927735249511898 Time :  5140
accuracy train: 0.999219 val: 0.761972 test: 0.762240
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({0: 4590, 2: 3142, 1: 2930})

Epoch :  54 loss training:  12.241311357356608 Time :  5156
accuracy train: 0.998750 val: 0.756338 test: 0.757738
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({2: 4616, 0: 3125, 1: 2921})

Epoch :  55 loss training:  12.63281505741179 Time :  5182
accuracy train: 0.999219 val: 0.757746 test: 0.759707
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({1: 4618, 2: 3123, 0: 2921})

Epoch :  56 loss training:  11.35308459494263 Time :  5197
accuracy train: 0.999531 val: 0.761972 test: 0.758863
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({0: 4648, 2: 3098, 1: 2916})

Epoch :  57 loss training:  11.767620704136789 Time :  5214
accuracy train: 0.999687 val: 0.767606 test: 0.763365
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({0: 4643, 2: 3098, 1: 2921})

Epoch :  58 loss training:  10.887581656686962 Time :  5229
accuracy train: 0.999844 val: 0.753521 test: 0.761114
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({2: 4663, 0: 3078, 1: 2921})

Epoch :  59 loss training:  10.98167337058112 Time :  5246
accuracy train: 0.999687 val: 0.766197 test: 0.760833
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({0: 4649, 1: 3084, 2: 2929})

Epoch :  60 loss training:  11.505675280466676 Time :  5263
accuracy train: 0.999687 val: 0.764789 test: 0.765616
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({0: 4668, 2: 3060, 1: 2934})

Epoch :  61 loss training:  9.936784346587956 Time :  5280
accuracy train: 1.000000 val: 0.754930 test: 0.761958
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({2: 4684, 0: 3068, 1: 2910})

Epoch :  62 loss training:  9.94890158623457 Time :  5298
accuracy train: 0.999687 val: 0.757746 test: 0.761396
max validation accuracy : 0.784507 max acc epoch : 31 test accuracy : 0.763365
Counter({0: 4685, 1: 3056, 2: 2921})

========================================================================================================================================================================================================
max acc epoch :  31
max validation accuracy :  0.7845070422535211
test accuracy :  0.7633652222847496
last test_accuracy :  0.7613956105796286
========================================================================================================================================================================================================

itr : 7
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=441, weight_decay=0)
device :  cuda:0
Counter({0: 5133, 1: 3267, 2: 2262})

Epoch :  1 loss training:  91.26154294610023 Time :  5316
accuracy train: 0.783682 val: 0.756338 test: 0.768430
max validation accuracy : 0.756338 max acc epoch : 1 test accuracy : 0.768430
Counter({1: 4180, 2: 3730, 0: 2752})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.0042986124754 Time :  5333
accuracy train: 0.788840 val: 0.750704 test: 0.759707
max validation accuracy : 0.756338 max acc epoch : 1 test accuracy : 0.768430
Counter({0: 3960, 1: 3678, 2: 3024})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.06211400032043 Time :  5349
accuracy train: 0.806815 val: 0.753521 test: 0.770681
max validation accuracy : 0.756338 max acc epoch : 1 test accuracy : 0.768430
Counter({0: 4314, 1: 3334, 2: 3014})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.04088559746742 Time :  5366
accuracy train: 0.826665 val: 0.757746 test: 0.768993
max validation accuracy : 0.757746 max acc epoch : 4 test accuracy : 0.768993
Counter({2: 4516, 1: 3138, 0: 3008})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.74463449418545 Time :  5381
accuracy train: 0.830728 val: 0.754930 test: 0.771525
max validation accuracy : 0.757746 max acc epoch : 4 test accuracy : 0.768993
Counter({2: 4640, 1: 3118, 0: 2904})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.09180913865566 Time :  5397
accuracy train: 0.836668 val: 0.761972 test: 0.763365
max validation accuracy : 0.761972 max acc epoch : 6 test accuracy : 0.763365
Counter({1: 4602, 2: 3233, 0: 2827})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.79512086510658 Time :  5415
accuracy train: 0.859956 val: 0.756338 test: 0.773495
max validation accuracy : 0.761972 max acc epoch : 6 test accuracy : 0.763365
Counter({1: 4714, 2: 3170, 0: 2778})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  63.16381900012493 Time :  5431
accuracy train: 0.863551 val: 0.761972 test: 0.768993
max validation accuracy : 0.761972 max acc epoch : 6 test accuracy : 0.763365
Counter({2: 4738, 1: 3122, 0: 2802})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.90763734281063 Time :  5445
accuracy train: 0.872460 val: 0.760563 test: 0.768430
max validation accuracy : 0.761972 max acc epoch : 6 test accuracy : 0.763365
Counter({0: 4679, 2: 3261, 1: 2722})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.79280073940754 Time :  5461
accuracy train: 0.875742 val: 0.752113 test: 0.764491
max validation accuracy : 0.761972 max acc epoch : 6 test accuracy : 0.763365
Counter({0: 4696, 2: 3228, 1: 2738})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.680875301361084 Time :  5477
accuracy train: 0.882463 val: 0.766197 test: 0.766179
max validation accuracy : 0.766197 max acc epoch : 11 test accuracy : 0.766179
Counter({0: 4681, 2: 3256, 1: 2725})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.13688966631889 Time :  5493
accuracy train: 0.880431 val: 0.757746 test: 0.758582
max validation accuracy : 0.766197 max acc epoch : 11 test accuracy : 0.766179
Counter({1: 4686, 2: 3290, 0: 2686})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.86492916941643 Time :  5510
accuracy train: 0.888872 val: 0.763380 test: 0.759145
max validation accuracy : 0.766197 max acc epoch : 11 test accuracy : 0.766179
Counter({2: 4690, 1: 3261, 0: 2711})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.013199001550674 Time :  5527
accuracy train: 0.892935 val: 0.763380 test: 0.761396
max validation accuracy : 0.766197 max acc epoch : 11 test accuracy : 0.766179
Counter({1: 4720, 0: 3268, 2: 2674})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.28211370110512 Time :  5543
accuracy train: 0.895436 val: 0.761972 test: 0.758582
max validation accuracy : 0.766197 max acc epoch : 11 test accuracy : 0.766179
Counter({1: 4717, 0: 3272, 2: 2673})

Epoch :  16 loss training:  55.70479702949524 Time :  5558
accuracy train: 0.895905 val: 0.763380 test: 0.759426
max validation accuracy : 0.766197 max acc epoch : 11 test accuracy : 0.766179
Counter({0: 4719, 1: 3254, 2: 2689})

Epoch :  17 loss training:  54.33545619249344 Time :  5573
accuracy train: 0.903251 val: 0.752113 test: 0.758863
max validation accuracy : 0.766197 max acc epoch : 11 test accuracy : 0.766179
Counter({0: 4721, 2: 3253, 1: 2688})

Epoch :  18 loss training:  52.42504280805588 Time :  5590
accuracy train: 0.912785 val: 0.769014 test: 0.761396
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({1: 4711, 0: 3268, 2: 2683})

Epoch :  19 loss training:  51.388538643717766 Time :  5606
accuracy train: 0.914505 val: 0.754930 test: 0.759707
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({0: 4729, 2: 3278, 1: 2655})

Epoch :  20 loss training:  50.03664727509022 Time :  5622
accuracy train: 0.922319 val: 0.759155 test: 0.760833
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({2: 4725, 1: 3269, 0: 2668})

Epoch :  21 loss training:  48.081079103052616 Time :  5640
accuracy train: 0.928571 val: 0.769014 test: 0.763647
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({0: 4719, 2: 3282, 1: 2661})

Epoch :  22 loss training:  46.30902528017759 Time :  5656
accuracy train: 0.932948 val: 0.761972 test: 0.758019
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({2: 4719, 1: 3287, 0: 2656})

Epoch :  23 loss training:  44.51540443301201 Time :  5671
accuracy train: 0.940138 val: 0.757746 test: 0.762240
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({1: 4719, 2: 3277, 0: 2666})

Epoch :  24 loss training:  43.07417057454586 Time :  5688
accuracy train: 0.943264 val: 0.763380 test: 0.764491
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({0: 4719, 1: 3266, 2: 2677})

Epoch :  25 loss training:  41.94647604227066 Time :  5705
accuracy train: 0.948265 val: 0.759155 test: 0.764772
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({2: 4715, 0: 3293, 1: 2654})

Epoch :  26 loss training:  39.49548879265785 Time :  5721
accuracy train: 0.954517 val: 0.760563 test: 0.763365
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({2: 4723, 0: 3296, 1: 2643})

Epoch :  27 loss training:  38.69046048820019 Time :  5737
accuracy train: 0.960300 val: 0.769014 test: 0.763647
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({0: 4709, 2: 3288, 1: 2665})

Epoch :  28 loss training:  37.52706044912338 Time :  5754
accuracy train: 0.961707 val: 0.760563 test: 0.760270
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({1: 4728, 2: 3253, 0: 2681})

Epoch :  29 loss training:  35.65439087152481 Time :  5771
accuracy train: 0.966865 val: 0.764789 test: 0.763084
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({2: 4731, 1: 3247, 0: 2684})

Epoch :  30 loss training:  36.21460461616516 Time :  5788
accuracy train: 0.970616 val: 0.756338 test: 0.761114
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({2: 4721, 0: 3288, 1: 2653})

Epoch :  31 loss training:  33.51062197983265 Time :  5801
accuracy train: 0.972179 val: 0.764789 test: 0.764209
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({0: 4715, 2: 3275, 1: 2672})

Epoch :  32 loss training:  32.06769474968314 Time :  5817
accuracy train: 0.975148 val: 0.761972 test: 0.764491
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({2: 4715, 1: 3286, 0: 2661})

Epoch :  33 loss training:  30.61605851724744 Time :  5834
accuracy train: 0.977337 val: 0.760563 test: 0.759145
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({0: 4717, 2: 3269, 1: 2676})

Epoch :  34 loss training:  29.957636326551437 Time :  5850
accuracy train: 0.978743 val: 0.767606 test: 0.761114
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({0: 4714, 2: 3276, 1: 2672})

Epoch :  35 loss training:  28.392415054142475 Time :  5867
accuracy train: 0.982338 val: 0.752113 test: 0.754924
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({2: 4705, 1: 3278, 0: 2679})

Epoch :  36 loss training:  27.82807458564639 Time :  5884
accuracy train: 0.983901 val: 0.769014 test: 0.768149
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({2: 4666, 1: 3311, 0: 2685})

Epoch :  37 loss training:  25.81221852079034 Time :  5900
accuracy train: 0.985933 val: 0.754930 test: 0.759426
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({0: 4707, 1: 3275, 2: 2680})

Epoch :  38 loss training:  24.18395321816206 Time :  5915
accuracy train: 0.987965 val: 0.752113 test: 0.757738
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({0: 4719, 1: 3287, 2: 2656})

Epoch :  39 loss training:  24.273343939334154 Time :  5932
accuracy train: 0.987496 val: 0.753521 test: 0.758582
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({2: 4717, 0: 3265, 1: 2680})

Epoch :  40 loss training:  23.154627066105604 Time :  5948
accuracy train: 0.990153 val: 0.760563 test: 0.757738
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({0: 4730, 2: 3259, 1: 2673})

Epoch :  41 loss training:  22.11436937749386 Time :  5962
accuracy train: 0.991716 val: 0.769014 test: 0.763647
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({0: 4723, 2: 3258, 1: 2681})

Epoch :  42 loss training:  21.450595377013087 Time :  5978
accuracy train: 0.994061 val: 0.764789 test: 0.762521
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({0: 4713, 2: 3280, 1: 2669})

Epoch :  43 loss training:  19.38959449529648 Time :  6004
accuracy train: 0.994686 val: 0.757746 test: 0.764772
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({0: 4711, 2: 3267, 1: 2684})

Epoch :  44 loss training:  19.983910147100687 Time :  6020
accuracy train: 0.994373 val: 0.761972 test: 0.764491
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({2: 4711, 1: 3277, 0: 2674})

Epoch :  45 loss training:  16.98993207514286 Time :  6034
accuracy train: 0.995467 val: 0.754930 test: 0.757175
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({2: 4693, 1: 3295, 0: 2674})

Epoch :  46 loss training:  17.93189611285925 Time :  6050
accuracy train: 0.996093 val: 0.757746 test: 0.763084
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({0: 4679, 2: 3302, 1: 2681})

Epoch :  47 loss training:  17.096971575170755 Time :  6066
accuracy train: 0.997187 val: 0.759155 test: 0.764772
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({2: 4685, 0: 3315, 1: 2662})

Epoch :  48 loss training:  15.978465219959617 Time :  6082
accuracy train: 0.997343 val: 0.763380 test: 0.760551
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({2: 4684, 1: 3325, 0: 2653})

Epoch :  49 loss training:  15.419395894743502 Time :  6098
accuracy train: 0.997656 val: 0.761972 test: 0.759707
max validation accuracy : 0.769014 max acc epoch : 18 test accuracy : 0.761396
Counter({1: 4681, 0: 3337, 2: 2644})

========================================================================================================================================================================================================
max acc epoch :  18
max validation accuracy :  0.7690140845070422
test accuracy :  0.7613956105796286
last test_accuracy :  0.7597073719752392
========================================================================================================================================================================================================

itr : 8
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=441, weight_decay=0)
device :  cuda:0
Counter({0: 5133, 1: 3267, 2: 2262})

Epoch :  1 loss training:  91.35615423321724 Time :  6132
accuracy train: 0.783057 val: 0.738028 test: 0.767586
max validation accuracy : 0.738028 max acc epoch : 1 test accuracy : 0.767586
Counter({0: 4115, 2: 3726, 1: 2821})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.95269916951656 Time :  6148
accuracy train: 0.791341 val: 0.759155 test: 0.760270
max validation accuracy : 0.759155 max acc epoch : 2 test accuracy : 0.760270
Counter({2: 4322, 1: 3505, 0: 2835})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.23895817995071 Time :  6164
accuracy train: 0.808221 val: 0.766197 test: 0.770962
max validation accuracy : 0.766197 max acc epoch : 3 test accuracy : 0.770962
Counter({1: 4626, 0: 3223, 2: 2813})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.23082530498505 Time :  6179
accuracy train: 0.828696 val: 0.767606 test: 0.771525
max validation accuracy : 0.767606 max acc epoch : 4 test accuracy : 0.771525
Counter({2: 4746, 1: 3056, 0: 2860})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.47673581540585 Time :  6194
accuracy train: 0.828228 val: 0.773239 test: 0.768149
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.768149
Counter({1: 4842, 2: 3065, 0: 2755})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.20152270793915 Time :  6210
accuracy train: 0.834323 val: 0.752113 test: 0.766742
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.768149
Counter({1: 4878, 0: 3049, 2: 2735})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.58810053765774 Time :  6226
accuracy train: 0.856361 val: 0.776056 test: 0.772088
max validation accuracy : 0.776056 max acc epoch : 7 test accuracy : 0.772088
Counter({0: 4967, 2: 2945, 1: 2750})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  63.238780066370964 Time :  6253
accuracy train: 0.861988 val: 0.761972 test: 0.767586
max validation accuracy : 0.776056 max acc epoch : 7 test accuracy : 0.772088
Counter({2: 4985, 1: 2893, 0: 2784})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.39234386384487 Time :  6268
accuracy train: 0.862770 val: 0.766197 test: 0.765616
max validation accuracy : 0.776056 max acc epoch : 7 test accuracy : 0.772088
Counter({0: 4968, 2: 2877, 1: 2817})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.879036247730255 Time :  6283
accuracy train: 0.880275 val: 0.767606 test: 0.767304
max validation accuracy : 0.776056 max acc epoch : 7 test accuracy : 0.772088
Counter({2: 5010, 0: 2855, 1: 2797})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.192898988723755 Time :  6296
accuracy train: 0.879181 val: 0.776056 test: 0.763647
max validation accuracy : 0.776056 max acc epoch : 7 test accuracy : 0.772088
Counter({2: 5029, 1: 2833, 0: 2800})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.191796630620956 Time :  6312
accuracy train: 0.885277 val: 0.760563 test: 0.765898
max validation accuracy : 0.776056 max acc epoch : 7 test accuracy : 0.772088
Counter({1: 5093, 2: 2803, 0: 2766})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.45037987828255 Time :  6327
accuracy train: 0.893873 val: 0.769014 test: 0.765335
max validation accuracy : 0.776056 max acc epoch : 7 test accuracy : 0.772088
Counter({1: 5070, 0: 2800, 2: 2792})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.54775695502758 Time :  6343
accuracy train: 0.893560 val: 0.776056 test: 0.763928
max validation accuracy : 0.776056 max acc epoch : 7 test accuracy : 0.772088
Counter({0: 5092, 2: 2785, 1: 2785})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.16287934780121 Time :  6360
accuracy train: 0.898093 val: 0.781690 test: 0.766179
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({2: 5089, 0: 2789, 1: 2784})

Epoch :  16 loss training:  55.06270731985569 Time :  6376
accuracy train: 0.904658 val: 0.776056 test: 0.764772
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({1: 5107, 2: 2783, 0: 2772})

Epoch :  17 loss training:  54.60490968823433 Time :  6392
accuracy train: 0.911535 val: 0.770423 test: 0.764209
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({1: 5108, 2: 2790, 0: 2764})

Epoch :  18 loss training:  51.42921021580696 Time :  6407
accuracy train: 0.916380 val: 0.760563 test: 0.763365
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({1: 5110, 2: 2788, 0: 2764})

Epoch :  19 loss training:  50.70334081351757 Time :  6423
accuracy train: 0.921225 val: 0.771831 test: 0.765335
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({1: 5114, 0: 2783, 2: 2765})

Epoch :  20 loss training:  49.80833311378956 Time :  6439
accuracy train: 0.927477 val: 0.764789 test: 0.761677
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({1: 5114, 2: 2797, 0: 2751})

Epoch :  21 loss training:  47.42955157905817 Time :  6455
accuracy train: 0.932791 val: 0.770423 test: 0.763928
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({1: 5110, 2: 2791, 0: 2761})

Epoch :  22 loss training:  46.159106992185116 Time :  6473
accuracy train: 0.936543 val: 0.773239 test: 0.768711
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({1: 5094, 0: 2801, 2: 2767})

Epoch :  23 loss training:  44.504024386405945 Time :  6490
accuracy train: 0.944827 val: 0.764789 test: 0.763928
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({2: 5085, 1: 2821, 0: 2756})

Epoch :  24 loss training:  43.40541769564152 Time :  6507
accuracy train: 0.949828 val: 0.764789 test: 0.764209
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({2: 5095, 1: 2819, 0: 2748})

Epoch :  25 loss training:  41.412511341273785 Time :  6522
accuracy train: 0.950453 val: 0.763380 test: 0.766460
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({0: 5084, 2: 2817, 1: 2761})

Epoch :  26 loss training:  38.941748686134815 Time :  6536
accuracy train: 0.954048 val: 0.767606 test: 0.765616
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({1: 5095, 2: 2799, 0: 2768})

Epoch :  27 loss training:  38.353000432252884 Time :  6552
accuracy train: 0.959675 val: 0.767606 test: 0.765335
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({1: 5101, 0: 2795, 2: 2766})

Epoch :  28 loss training:  37.608951926231384 Time :  6567
accuracy train: 0.964364 val: 0.761972 test: 0.761958
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({2: 5077, 0: 2818, 1: 2767})

Epoch :  29 loss training:  35.27700596302748 Time :  6582
accuracy train: 0.966865 val: 0.767606 test: 0.765053
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({2: 5072, 0: 2811, 1: 2779})

Epoch :  30 loss training:  35.33182268589735 Time :  6599
accuracy train: 0.969522 val: 0.760563 test: 0.761958
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({1: 5088, 0: 2792, 2: 2782})

Epoch :  31 loss training:  32.991643097251654 Time :  6617
accuracy train: 0.972023 val: 0.759155 test: 0.761396
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({1: 5074, 2: 2803, 0: 2785})

Epoch :  32 loss training:  32.23755756393075 Time :  6633
accuracy train: 0.977024 val: 0.761972 test: 0.762240
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({0: 5074, 2: 2811, 1: 2777})

Epoch :  33 loss training:  29.83901959657669 Time :  6648
accuracy train: 0.980932 val: 0.767606 test: 0.765053
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({0: 5016, 1: 2860, 2: 2786})

Epoch :  34 loss training:  29.80063746869564 Time :  6664
accuracy train: 0.981088 val: 0.756338 test: 0.759145
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({1: 5005, 0: 2870, 2: 2787})

Epoch :  35 loss training:  27.672187101095915 Time :  6679
accuracy train: 0.984683 val: 0.753521 test: 0.759426
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({0: 4995, 1: 2870, 2: 2797})

Epoch :  36 loss training:  27.19070255383849 Time :  6695
accuracy train: 0.983589 val: 0.761972 test: 0.761114
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({2: 4960, 1: 2890, 0: 2812})

Epoch :  37 loss training:  25.724816892296076 Time :  6711
accuracy train: 0.987340 val: 0.757746 test: 0.756612
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({1: 4968, 2: 2893, 0: 2801})

Epoch :  38 loss training:  23.683115527033806 Time :  6729
accuracy train: 0.988434 val: 0.764789 test: 0.758301
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({1: 4964, 2: 2884, 0: 2814})

Epoch :  39 loss training:  24.57753436639905 Time :  6745
accuracy train: 0.990309 val: 0.759155 test: 0.756612
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({2: 4960, 1: 2895, 0: 2807})

Epoch :  40 loss training:  23.301004622131586 Time :  6761
accuracy train: 0.992029 val: 0.761972 test: 0.757456
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({2: 4940, 1: 2898, 0: 2824})

Epoch :  41 loss training:  21.973430432379246 Time :  6776
accuracy train: 0.990935 val: 0.760563 test: 0.764491
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({1: 4939, 0: 2914, 2: 2809})

Epoch :  42 loss training:  21.14213977754116 Time :  6791
accuracy train: 0.994217 val: 0.760563 test: 0.764772
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({1: 4941, 2: 2895, 0: 2826})

Epoch :  43 loss training:  20.231623800471425 Time :  6806
accuracy train: 0.994530 val: 0.754930 test: 0.759989
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({2: 4942, 1: 2909, 0: 2811})

Epoch :  44 loss training:  18.39935269393027 Time :  6821
accuracy train: 0.995155 val: 0.752113 test: 0.760551
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({1: 4934, 0: 2912, 2: 2816})

Epoch :  45 loss training:  17.869169399142265 Time :  6838
accuracy train: 0.996405 val: 0.756338 test: 0.762240
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({0: 4920, 1: 2914, 2: 2828})

Epoch :  46 loss training:  16.96263795439154 Time :  6855
accuracy train: 0.996249 val: 0.757746 test: 0.758863
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.766179
Counter({0: 4900, 1: 2914, 2: 2848})

========================================================================================================================================================================================================
max acc epoch :  15
max validation accuracy :  0.7816901408450704
test accuracy :  0.7661789532920653
last test_accuracy :  0.7588632526730444
========================================================================================================================================================================================================

itr : 9
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=441, weight_decay=0)
device :  cuda:0
Counter({0: 5133, 1: 3267, 2: 2262})

Epoch :  1 loss training:  91.18554997444153 Time :  6876
accuracy train: 0.782901 val: 0.750704 test: 0.766742
max validation accuracy : 0.750704 max acc epoch : 1 test accuracy : 0.766742
Counter({2: 3972, 1: 3862, 0: 2828})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.13008439540863 Time :  6892
accuracy train: 0.785402 val: 0.745070 test: 0.756331
max validation accuracy : 0.750704 max acc epoch : 1 test accuracy : 0.766742
Counter({1: 4047, 2: 3547, 0: 3068})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.36020120978355 Time :  6907
accuracy train: 0.808534 val: 0.766197 test: 0.768993
max validation accuracy : 0.766197 max acc epoch : 3 test accuracy : 0.768993
Counter({2: 3952, 1: 3388, 0: 3322})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.3504213988781 Time :  6922
accuracy train: 0.826352 val: 0.773239 test: 0.774902
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.774902
Counter({2: 4038, 1: 3367, 0: 3257})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.78899708390236 Time :  6938
accuracy train: 0.834011 val: 0.767606 test: 0.771244
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.774902
Counter({2: 4208, 0: 3281, 1: 3173})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  72.0106049478054 Time :  6956
accuracy train: 0.835574 val: 0.764789 test: 0.764772
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.774902
Counter({0: 4333, 2: 3166, 1: 3163})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.61632263660431 Time :  6971
accuracy train: 0.854017 val: 0.757746 test: 0.774902
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.774902
Counter({0: 4410, 1: 3133, 2: 3119})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.06449067592621 Time :  6987
accuracy train: 0.866052 val: 0.761972 test: 0.773776
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.774902
Counter({1: 4418, 0: 3186, 2: 3058})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.24286067485809 Time :  7002
accuracy train: 0.870428 val: 0.745070 test: 0.772651
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.774902
Counter({0: 4429, 2: 3136, 1: 3097})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.706529930233955 Time :  7018
accuracy train: 0.880744 val: 0.754930 test: 0.766742
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.774902
Counter({0: 4421, 1: 3152, 2: 3089})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.320550456643105 Time :  7034
accuracy train: 0.884808 val: 0.764789 test: 0.765616
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.774902
Counter({2: 4428, 0: 3154, 1: 3080})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.4629663079977 Time :  7050
accuracy train: 0.885433 val: 0.767606 test: 0.768149
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.774902
Counter({2: 4492, 0: 3096, 1: 3074})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  58.07110567390919 Time :  7066
accuracy train: 0.892466 val: 0.760563 test: 0.766460
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.774902
Counter({2: 4484, 0: 3125, 1: 3053})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.99267806112766 Time :  7088
accuracy train: 0.895436 val: 0.774648 test: 0.763365
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.763365
Counter({0: 4488, 1: 3116, 2: 3058})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  57.137161299586296 Time :  7103
accuracy train: 0.899656 val: 0.764789 test: 0.766742
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.763365
Counter({2: 4495, 0: 3119, 1: 3048})

Epoch :  16 loss training:  56.25355353951454 Time :  7119
accuracy train: 0.903407 val: 0.763380 test: 0.767023
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.763365
Counter({2: 4526, 0: 3124, 1: 3012})

Epoch :  17 loss training:  55.49189577996731 Time :  7134
accuracy train: 0.909347 val: 0.771831 test: 0.769274
max validation accuracy : 0.774648 max acc epoch : 14 test accuracy : 0.763365
Counter({1: 4500, 2: 3141, 0: 3021})

Epoch :  18 loss training:  52.130827859044075 Time :  7150
accuracy train: 0.917787 val: 0.776056 test: 0.765898
max validation accuracy : 0.776056 max acc epoch : 18 test accuracy : 0.765898
Counter({1: 4516, 0: 3145, 2: 3001})

Epoch :  19 loss training:  51.468423560261726 Time :  7165
accuracy train: 0.919506 val: 0.780282 test: 0.768711
max validation accuracy : 0.780282 max acc epoch : 19 test accuracy : 0.768711
Counter({2: 4527, 0: 3138, 1: 2997})

Epoch :  20 loss training:  50.02450440824032 Time :  7181
accuracy train: 0.930760 val: 0.773239 test: 0.767867
max validation accuracy : 0.780282 max acc epoch : 19 test accuracy : 0.768711
Counter({1: 4500, 0: 3157, 2: 3005})

Epoch :  21 loss training:  48.18666436523199 Time :  7198
accuracy train: 0.933573 val: 0.774648 test: 0.767867
max validation accuracy : 0.780282 max acc epoch : 19 test accuracy : 0.768711
Counter({0: 4475, 1: 3182, 2: 3005})

Epoch :  22 loss training:  46.4436889141798 Time :  7214
accuracy train: 0.937637 val: 0.778873 test: 0.768149
max validation accuracy : 0.780282 max acc epoch : 19 test accuracy : 0.768711
Counter({2: 4469, 0: 3171, 1: 3022})

Epoch :  23 loss training:  44.34057965874672 Time :  7228
accuracy train: 0.946389 val: 0.777465 test: 0.763365
max validation accuracy : 0.780282 max acc epoch : 19 test accuracy : 0.768711
Counter({2: 4414, 0: 3233, 1: 3015})

Epoch :  24 loss training:  43.63408862054348 Time :  7243
accuracy train: 0.949984 val: 0.780282 test: 0.764491
max validation accuracy : 0.780282 max acc epoch : 19 test accuracy : 0.768711
Counter({2: 4404, 1: 3256, 0: 3002})

Epoch :  25 loss training:  42.25614769756794 Time :  7259
accuracy train: 0.953267 val: 0.784507 test: 0.762240
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({1: 4400, 2: 3264, 0: 2998})

Epoch :  26 loss training:  40.05532902479172 Time :  7276
accuracy train: 0.956705 val: 0.781690 test: 0.766460
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({1: 4410, 2: 3230, 0: 3022})

Epoch :  27 loss training:  37.773382030427456 Time :  7292
accuracy train: 0.959519 val: 0.771831 test: 0.761677
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({2: 4392, 0: 3264, 1: 3006})

Epoch :  28 loss training:  38.17791558802128 Time :  7307
accuracy train: 0.964208 val: 0.773239 test: 0.762240
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({1: 4382, 2: 3273, 0: 3007})

Epoch :  29 loss training:  36.0867807790637 Time :  7336
accuracy train: 0.967334 val: 0.774648 test: 0.764491
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({2: 4383, 0: 3296, 1: 2983})

Epoch :  30 loss training:  36.40169967710972 Time :  7350
accuracy train: 0.971710 val: 0.773239 test: 0.764209
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({1: 4355, 2: 3301, 0: 3006})

Epoch :  31 loss training:  33.503050431609154 Time :  7366
accuracy train: 0.973585 val: 0.769014 test: 0.769555
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({1: 4335, 2: 3343, 0: 2984})

Epoch :  32 loss training:  31.630926989018917 Time :  7381
accuracy train: 0.976555 val: 0.769014 test: 0.760833
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({2: 4309, 1: 3363, 0: 2990})

Epoch :  33 loss training:  30.971870809793472 Time :  7397
accuracy train: 0.977962 val: 0.774648 test: 0.762802
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({1: 4328, 0: 3392, 2: 2942})

Epoch :  34 loss training:  29.789608150720596 Time :  7412
accuracy train: 0.980775 val: 0.766197 test: 0.759145
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({2: 4317, 0: 3373, 1: 2972})

Epoch :  35 loss training:  28.279378060251474 Time :  7427
accuracy train: 0.982338 val: 0.756338 test: 0.758301
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({0: 4292, 1: 3386, 2: 2984})

Epoch :  36 loss training:  27.259921863675117 Time :  7443
accuracy train: 0.984058 val: 0.759155 test: 0.765335
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({0: 4312, 2: 3400, 1: 2950})

Epoch :  37 loss training:  25.835358310490847 Time :  7474
accuracy train: 0.986715 val: 0.766197 test: 0.759989
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({1: 4318, 0: 3398, 2: 2946})

Epoch :  38 loss training:  23.93202619254589 Time :  7500
accuracy train: 0.989215 val: 0.760563 test: 0.761114
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({1: 4327, 0: 3387, 2: 2948})

Epoch :  39 loss training:  24.466983802616596 Time :  7515
accuracy train: 0.989997 val: 0.759155 test: 0.758582
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({0: 4321, 1: 3404, 2: 2937})

Epoch :  40 loss training:  22.57971228286624 Time :  7531
accuracy train: 0.990466 val: 0.759155 test: 0.761114
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({1: 4314, 0: 3411, 2: 2937})

Epoch :  41 loss training:  21.756922729313374 Time :  7546
accuracy train: 0.991091 val: 0.764789 test: 0.758863
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({0: 4290, 1: 3442, 2: 2930})

Epoch :  42 loss training:  20.676337840035558 Time :  7562
accuracy train: 0.992967 val: 0.766197 test: 0.762521
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({0: 4266, 2: 3451, 1: 2945})

Epoch :  43 loss training:  20.02439840324223 Time :  7578
accuracy train: 0.994061 val: 0.771831 test: 0.756050
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({1: 4254, 0: 3478, 2: 2930})

Epoch :  44 loss training:  19.477974807843566 Time :  7594
accuracy train: 0.994686 val: 0.771831 test: 0.763928
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({2: 4252, 0: 3484, 1: 2926})

Epoch :  45 loss training:  18.157891686074436 Time :  7615
accuracy train: 0.996405 val: 0.769014 test: 0.763647
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({2: 4233, 1: 3495, 0: 2934})

Epoch :  46 loss training:  16.974190579727292 Time :  7631
accuracy train: 0.995624 val: 0.763380 test: 0.766460
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({1: 4180, 2: 3556, 0: 2926})

Epoch :  47 loss training:  17.312485782429576 Time :  7648
accuracy train: 0.996874 val: 0.769014 test: 0.765616
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({2: 4171, 0: 3551, 1: 2940})

Epoch :  48 loss training:  15.806029498577118 Time :  7663
accuracy train: 0.996718 val: 0.757746 test: 0.759707
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({0: 4161, 1: 3554, 2: 2947})

Epoch :  49 loss training:  15.04765086248517 Time :  7679
accuracy train: 0.998124 val: 0.753521 test: 0.758582
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({2: 4182, 0: 3533, 1: 2947})

Epoch :  50 loss training:  14.930691360495985 Time :  7695
accuracy train: 0.998750 val: 0.757746 test: 0.759145
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({0: 4154, 2: 3546, 1: 2962})

Epoch :  51 loss training:  13.095320699736476 Time :  7713
accuracy train: 0.998437 val: 0.757746 test: 0.757456
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({0: 4134, 1: 3569, 2: 2959})

Epoch :  52 loss training:  13.738693797029555 Time :  7729
accuracy train: 0.998281 val: 0.745070 test: 0.754924
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({0: 4119, 1: 3575, 2: 2968})

Epoch :  53 loss training:  13.976294751279056 Time :  7745
accuracy train: 0.998906 val: 0.745070 test: 0.757175
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({0: 4120, 1: 3572, 2: 2970})

Epoch :  54 loss training:  12.377953074872494 Time :  7761
accuracy train: 0.999687 val: 0.750704 test: 0.754924
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({2: 4131, 1: 3566, 0: 2965})

Epoch :  55 loss training:  12.099465342238545 Time :  7777
accuracy train: 0.999531 val: 0.754930 test: 0.748734
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({2: 4122, 1: 3564, 0: 2976})

Epoch :  56 loss training:  11.517653222661465 Time :  7793
accuracy train: 0.999844 val: 0.752113 test: 0.752673
max validation accuracy : 0.784507 max acc epoch : 25 test accuracy : 0.762240
Counter({0: 4118, 2: 3593, 1: 2951})

========================================================================================================================================================================================================
max acc epoch :  25
max validation accuracy :  0.7845070422535211
test accuracy :  0.7622397298818233
last test_accuracy :  0.7526730444569499
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.77746 	 test_accuracy : 0.76618 	 max_acc epoch :  13 	 last test_accuracy : 0.76618
k :  1 	 val_accuracy : 0.78732 	 test_accuracy : 0.76646 	 max_acc epoch :  33 	 last test_accuracy : 0.75830
k :  2 	 val_accuracy : 0.77465 	 test_accuracy : 0.77800 	 max_acc epoch :  4 	 last test_accuracy : 0.75746
k :  3 	 val_accuracy : 0.78310 	 test_accuracy : 0.76618 	 max_acc epoch :  12 	 last test_accuracy : 0.76730
k :  4 	 val_accuracy : 0.78028 	 test_accuracy : 0.77349 	 max_acc epoch :  8 	 last test_accuracy : 0.76280
k :  5 	 val_accuracy : 0.77746 	 test_accuracy : 0.76984 	 max_acc epoch :  4 	 last test_accuracy : 0.76505
k :  6 	 val_accuracy : 0.78451 	 test_accuracy : 0.76337 	 max_acc epoch :  31 	 last test_accuracy : 0.76140
k :  7 	 val_accuracy : 0.76901 	 test_accuracy : 0.76140 	 max_acc epoch :  18 	 last test_accuracy : 0.75971
k :  8 	 val_accuracy : 0.78169 	 test_accuracy : 0.76618 	 max_acc epoch :  15 	 last test_accuracy : 0.75886
k :  9 	 val_accuracy : 0.78451 	 test_accuracy : 0.76224 	 max_acc epoch :  25 	 last test_accuracy : 0.75267

avg :  	 val_accuracy : 0.78000 	 test_accuracy : 0.76733 	 last_accuracy : 0.76097
