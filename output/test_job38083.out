

date and time :  Sat Jun 19 14:10:52 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=0, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=276, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  46.43686144798994 Time :  13
accuracy train: 0.954234 val: 0.945455 test: 0.959817
max validation accuracy : 0.945455 max acc epoch : 1 test accuracy : 0.959817

Epoch :  2 loss training:  16.2331085447222 Time :  25
accuracy train: 0.972840 val: 0.966061 test: 0.965297
max validation accuracy : 0.966061 max acc epoch : 2 test accuracy : 0.965297

Epoch :  3 loss training:  13.551132754888386 Time :  37
accuracy train: 0.978614 val: 0.956364 test: 0.952511
max validation accuracy : 0.966061 max acc epoch : 2 test accuracy : 0.965297

Epoch :  4 loss training:  12.218287770170718 Time :  48
accuracy train: 0.976476 val: 0.961212 test: 0.963470
max validation accuracy : 0.966061 max acc epoch : 2 test accuracy : 0.965297

Epoch :  5 loss training:  10.620003557065502 Time :  60
accuracy train: 0.982250 val: 0.958788 test: 0.971233
max validation accuracy : 0.966061 max acc epoch : 2 test accuracy : 0.965297

Epoch :  6 loss training:  9.891000654548407 Time :  72
accuracy train: 0.983105 val: 0.970909 test: 0.967123
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.967123

Epoch :  7 loss training:  9.077355472370982 Time :  83
accuracy train: 0.989307 val: 0.972121 test: 0.967123
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967123

Epoch :  8 loss training:  8.24301871075295 Time :  95
accuracy train: 0.988024 val: 0.963636 test: 0.966667
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967123

Epoch :  9 loss training:  7.89474038220942 Time :  107
accuracy train: 0.987169 val: 0.957576 test: 0.964384
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967123

Epoch :  10 loss training:  8.102467976277694 Time :  119
accuracy train: 0.991446 val: 0.966061 test: 0.964840
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967123

Epoch :  11 loss training:  8.080208230763674 Time :  131
accuracy train: 0.990804 val: 0.966061 test: 0.962100
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.967123

Epoch :  12 loss training:  5.458788263844326 Time :  144
accuracy train: 0.994226 val: 0.973333 test: 0.964384
max validation accuracy : 0.973333 max acc epoch : 12 test accuracy : 0.964384

Epoch :  13 loss training:  4.979058588622138 Time :  157
accuracy train: 0.995509 val: 0.972121 test: 0.970776
max validation accuracy : 0.973333 max acc epoch : 12 test accuracy : 0.964384

Epoch :  14 loss training:  3.1290221550152637 Time :  168
accuracy train: 0.994440 val: 0.976970 test: 0.971689
max validation accuracy : 0.976970 max acc epoch : 14 test accuracy : 0.971689

Epoch :  15 loss training:  3.4589059392747004 Time :  178
accuracy train: 0.995509 val: 0.979394 test: 0.970320
max validation accuracy : 0.979394 max acc epoch : 15 test accuracy : 0.970320

Epoch :  16 loss training:  3.5296842454990838 Time :  189
accuracy train: 0.995937 val: 0.976970 test: 0.969863
max validation accuracy : 0.979394 max acc epoch : 15 test accuracy : 0.970320

Epoch :  17 loss training:  3.0544732879207004 Time :  199
accuracy train: 0.996364 val: 0.979394 test: 0.968037
max validation accuracy : 0.979394 max acc epoch : 15 test accuracy : 0.970320

Epoch :  18 loss training:  2.8050057155196555 Time :  209
accuracy train: 0.996151 val: 0.978182 test: 0.968037
max validation accuracy : 0.979394 max acc epoch : 15 test accuracy : 0.970320

Epoch :  19 loss training:  2.4713142676118878 Time :  220
accuracy train: 0.995295 val: 0.976970 test: 0.966667
max validation accuracy : 0.979394 max acc epoch : 15 test accuracy : 0.970320

Epoch :  20 loss training:  2.905489942182612 Time :  230
accuracy train: 0.996578 val: 0.974545 test: 0.966210
max validation accuracy : 0.979394 max acc epoch : 15 test accuracy : 0.970320

Epoch :  21 loss training:  2.7096858829827397 Time :  240
accuracy train: 0.996578 val: 0.978182 test: 0.966210
max validation accuracy : 0.979394 max acc epoch : 15 test accuracy : 0.970320

Epoch :  22 loss training:  2.909563929992146 Time :  251
accuracy train: 0.995723 val: 0.981818 test: 0.966667
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  23 loss training:  3.0503283998623374 Time :  261
accuracy train: 0.994654 val: 0.976970 test: 0.967580
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  24 loss training:  2.6369081652737805 Time :  272
accuracy train: 0.996151 val: 0.980606 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  25 loss training:  2.098928383747989 Time :  282
accuracy train: 0.996151 val: 0.978182 test: 0.975799
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  26 loss training:  2.271702128877223 Time :  292
accuracy train: 0.996578 val: 0.979394 test: 0.975799
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  27 loss training:  2.037040446732135 Time :  303
accuracy train: 0.995937 val: 0.975758 test: 0.966667
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  28 loss training:  1.8001199059945066 Time :  313
accuracy train: 0.994654 val: 0.974545 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  29 loss training:  1.835164581923891 Time :  324
accuracy train: 0.996364 val: 0.978182 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  30 loss training:  2.432397407148528 Time :  334
accuracy train: 0.996151 val: 0.975758 test: 0.966210
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  31 loss training:  2.7997578437771153 Time :  345
accuracy train: 0.995937 val: 0.975758 test: 0.960731
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  32 loss training:  2.2419436986638175 Time :  355
accuracy train: 0.996151 val: 0.978182 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  33 loss training:  2.1435976339053013 Time :  367
accuracy train: 0.994867 val: 0.975758 test: 0.966210
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  34 loss training:  2.027952635762631 Time :  379
accuracy train: 0.994654 val: 0.968485 test: 0.967580
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  35 loss training:  1.921403348835156 Time :  391
accuracy train: 0.996578 val: 0.976970 test: 0.968037
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  36 loss training:  2.3564815833960893 Time :  402
accuracy train: 0.996578 val: 0.973333 test: 0.966210
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  37 loss training:  1.9390374110971607 Time :  414
accuracy train: 0.994226 val: 0.970909 test: 0.966210
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  38 loss training:  1.7834411005696893 Time :  426
accuracy train: 0.996364 val: 0.975758 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  39 loss training:  2.1062853149687726 Time :  437
accuracy train: 0.996578 val: 0.980606 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  40 loss training:  2.372508797492628 Time :  449
accuracy train: 0.996578 val: 0.976970 test: 0.967580
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  41 loss training:  3.414403350881912 Time :  461
accuracy train: 0.994654 val: 0.973333 test: 0.964840
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  42 loss training:  2.3580945477442583 Time :  473
accuracy train: 0.995081 val: 0.969697 test: 0.958447
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  43 loss training:  1.8288361685845302 Time :  484
accuracy train: 0.996364 val: 0.978182 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  44 loss training:  1.6863051189670841 Time :  497
accuracy train: 0.996578 val: 0.978182 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  45 loss training:  1.6824828457865806 Time :  508
accuracy train: 0.996364 val: 0.975758 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  46 loss training:  1.6473493912126287 Time :  520
accuracy train: 0.996578 val: 0.974545 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  47 loss training:  1.5015013680258562 Time :  531
accuracy train: 0.996578 val: 0.978182 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  48 loss training:  1.5359125565000795 Time :  543
accuracy train: 0.996578 val: 0.973333 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  49 loss training:  1.796585841850174 Time :  555
accuracy train: 0.996151 val: 0.974545 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  50 loss training:  2.426205302705057 Time :  567
accuracy train: 0.996151 val: 0.968485 test: 0.962100
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.966667

Epoch :  51 loss training:  2.1276881840312853 Time :  578
accuracy train: 0.995723 val: 0.983030 test: 0.972146
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  52 loss training:  1.600389644918323 Time :  590
accuracy train: 0.994654 val: 0.973333 test: 0.974429
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  53 loss training:  1.8785487626391841 Time :  602
accuracy train: 0.994654 val: 0.973333 test: 0.968493
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  54 loss training:  2.143383801325399 Time :  614
accuracy train: 0.996578 val: 0.980606 test: 0.968037
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  55 loss training:  1.820829214375408 Time :  625
accuracy train: 0.996578 val: 0.981818 test: 0.971233
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  56 loss training:  1.5888259197417938 Time :  637
accuracy train: 0.996578 val: 0.976970 test: 0.972603
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  57 loss training:  2.0428872942629823 Time :  649
accuracy train: 0.996364 val: 0.981818 test: 0.969863
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  58 loss training:  2.0147410918725654 Time :  661
accuracy train: 0.996578 val: 0.979394 test: 0.964840
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  59 loss training:  1.8411873547447613 Time :  673
accuracy train: 0.996578 val: 0.978182 test: 0.966667
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  60 loss training:  1.8876585825055372 Time :  684
accuracy train: 0.996578 val: 0.979394 test: 0.964384
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  61 loss training:  1.438217290549801 Time :  695
accuracy train: 0.996578 val: 0.974545 test: 0.969406
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  62 loss training:  1.6673006914897996 Time :  707
accuracy train: 0.996578 val: 0.983030 test: 0.964840
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  63 loss training:  2.2716625492539606 Time :  718
accuracy train: 0.996792 val: 0.974545 test: 0.965297
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  64 loss training:  1.8950003078571171 Time :  729
accuracy train: 0.996151 val: 0.976970 test: 0.967123
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  65 loss training:  1.9012390446059726 Time :  740
accuracy train: 0.996792 val: 0.974545 test: 0.959361
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  66 loss training:  1.7593786714460293 Time :  752
accuracy train: 0.994867 val: 0.972121 test: 0.964384
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  67 loss training:  1.4477828702356383 Time :  763
accuracy train: 0.996578 val: 0.978182 test: 0.961644
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  68 loss training:  1.4467320475614542 Time :  774
accuracy train: 0.996364 val: 0.976970 test: 0.966210
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  69 loss training:  1.4043555393145652 Time :  785
accuracy train: 0.996364 val: 0.979394 test: 0.960731
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  70 loss training:  1.398628061567706 Time :  796
accuracy train: 0.997006 val: 0.978182 test: 0.962557
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  71 loss training:  1.3079497007929604 Time :  808
accuracy train: 0.996792 val: 0.979394 test: 0.966667
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  72 loss training:  1.598227445777411 Time :  819
accuracy train: 0.996364 val: 0.978182 test: 0.968037
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  73 loss training:  1.674849367545903 Time :  830
accuracy train: 0.996792 val: 0.976970 test: 0.963927
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  74 loss training:  1.7176881141176636 Time :  841
accuracy train: 0.991232 val: 0.970909 test: 0.954338
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  75 loss training:  1.8626589970344867 Time :  852
accuracy train: 0.996578 val: 0.973333 test: 0.967580
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  76 loss training:  1.7048577891418972 Time :  864
accuracy train: 0.996792 val: 0.976970 test: 0.956164
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  77 loss training:  1.4875116790226457 Time :  875
accuracy train: 0.996578 val: 0.976970 test: 0.963470
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  78 loss training:  1.332622815655668 Time :  886
accuracy train: 0.994867 val: 0.972121 test: 0.964384
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  79 loss training:  1.9768238812266645 Time :  897
accuracy train: 0.997006 val: 0.975758 test: 0.960731
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  80 loss training:  1.7706885140969462 Time :  908
accuracy train: 0.995295 val: 0.967273 test: 0.958447
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  81 loss training:  2.0927259932504967 Time :  920
accuracy train: 0.996578 val: 0.976970 test: 0.961644
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

Epoch :  82 loss training:  1.4983739063245594 Time :  931
accuracy train: 0.997006 val: 0.973333 test: 0.958447
max validation accuracy : 0.983030 max acc epoch : 51 test accuracy : 0.972146

========================================================================================================================================================================================================
best acc epoch :  51
validation accuracy :  0.983030303030303
test accuracy :  0.9721461187214612
last test_accuracy :  0.9584474885844749
second best val :  0.9818181818181818
second best test :  0.9666666666666667
max gap 29
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=0, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=832, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  47.03232016786933 Time :  943
accuracy train: 0.959153 val: 0.947879 test: 0.963014
max validation accuracy : 0.947879 max acc epoch : 1 test accuracy : 0.963014

Epoch :  2 loss training:  18.08287742594257 Time :  953
accuracy train: 0.966638 val: 0.951515 test: 0.963470
max validation accuracy : 0.951515 max acc epoch : 2 test accuracy : 0.963470

Epoch :  3 loss training:  14.041629517450929 Time :  964
accuracy train: 0.981608 val: 0.967273 test: 0.966667
max validation accuracy : 0.967273 max acc epoch : 3 test accuracy : 0.966667

Epoch :  4 loss training:  11.385049729608 Time :  974
accuracy train: 0.976476 val: 0.957576 test: 0.966667
max validation accuracy : 0.967273 max acc epoch : 3 test accuracy : 0.966667

Epoch :  5 loss training:  9.939305492676795 Time :  984
accuracy train: 0.983105 val: 0.964848 test: 0.963014
max validation accuracy : 0.967273 max acc epoch : 3 test accuracy : 0.966667

Epoch :  6 loss training:  9.0159404235892 Time :  995
accuracy train: 0.986955 val: 0.966061 test: 0.957991
max validation accuracy : 0.967273 max acc epoch : 3 test accuracy : 0.966667

Epoch :  7 loss training:  9.406954770209268 Time :  1005
accuracy train: 0.984175 val: 0.967273 test: 0.966210
max validation accuracy : 0.967273 max acc epoch : 3 test accuracy : 0.966667

Epoch :  8 loss training:  7.5891221889760345 Time :  1015
accuracy train: 0.991660 val: 0.970909 test: 0.963927
max validation accuracy : 0.970909 max acc epoch : 8 test accuracy : 0.963927

Epoch :  9 loss training:  8.765947452979162 Time :  1026
accuracy train: 0.991873 val: 0.968485 test: 0.964840
max validation accuracy : 0.970909 max acc epoch : 8 test accuracy : 0.963927

Epoch :  10 loss training:  8.648029795615003 Time :  1036
accuracy train: 0.993157 val: 0.970909 test: 0.967123
max validation accuracy : 0.970909 max acc epoch : 8 test accuracy : 0.963927

Epoch :  11 loss training:  6.463508772896603 Time :  1047
accuracy train: 0.993157 val: 0.968485 test: 0.966210
max validation accuracy : 0.970909 max acc epoch : 8 test accuracy : 0.963927

Epoch :  12 loss training:  5.6273471621098 Time :  1059
accuracy train: 0.995509 val: 0.967273 test: 0.960731
max validation accuracy : 0.970909 max acc epoch : 8 test accuracy : 0.963927

Epoch :  13 loss training:  4.680329888011329 Time :  1070
accuracy train: 0.993370 val: 0.962424 test: 0.969863
max validation accuracy : 0.970909 max acc epoch : 8 test accuracy : 0.963927

Epoch :  14 loss training:  4.624234082992189 Time :  1081
accuracy train: 0.996151 val: 0.967273 test: 0.969406
max validation accuracy : 0.970909 max acc epoch : 8 test accuracy : 0.963927

Epoch :  15 loss training:  3.4092526221793378 Time :  1092
accuracy train: 0.996364 val: 0.968485 test: 0.964384
max validation accuracy : 0.970909 max acc epoch : 8 test accuracy : 0.963927

Epoch :  16 loss training:  2.848279302037554 Time :  1104
accuracy train: 0.996792 val: 0.968485 test: 0.968037
max validation accuracy : 0.970909 max acc epoch : 8 test accuracy : 0.963927

Epoch :  17 loss training:  3.678847426417633 Time :  1115
accuracy train: 0.996151 val: 0.963636 test: 0.968950
max validation accuracy : 0.970909 max acc epoch : 8 test accuracy : 0.963927

Epoch :  18 loss training:  2.6675951474462636 Time :  1126
accuracy train: 0.996792 val: 0.962424 test: 0.971233
max validation accuracy : 0.970909 max acc epoch : 8 test accuracy : 0.963927

Epoch :  19 loss training:  2.4643211202783277 Time :  1138
accuracy train: 0.997434 val: 0.967273 test: 0.970776
max validation accuracy : 0.970909 max acc epoch : 8 test accuracy : 0.963927

Epoch :  20 loss training:  2.1194439005194 Time :  1149
accuracy train: 0.997434 val: 0.962424 test: 0.970776
max validation accuracy : 0.970909 max acc epoch : 8 test accuracy : 0.963927

Epoch :  21 loss training:  2.3436260310845682 Time :  1160
accuracy train: 0.997434 val: 0.969697 test: 0.964840
max validation accuracy : 0.970909 max acc epoch : 8 test accuracy : 0.963927

Epoch :  22 loss training:  1.9687794357378152 Time :  1171
accuracy train: 0.997434 val: 0.968485 test: 0.966667
max validation accuracy : 0.970909 max acc epoch : 8 test accuracy : 0.963927

Epoch :  23 loss training:  1.7667392723324156 Time :  1183
accuracy train: 0.997434 val: 0.967273 test: 0.969863
max validation accuracy : 0.970909 max acc epoch : 8 test accuracy : 0.963927

Epoch :  24 loss training:  1.9811741522444208 Time :  1194
accuracy train: 0.997861 val: 0.968485 test: 0.971233
max validation accuracy : 0.970909 max acc epoch : 8 test accuracy : 0.963927

Epoch :  25 loss training:  1.743713985057184 Time :  1205
accuracy train: 0.997434 val: 0.967273 test: 0.966667
max validation accuracy : 0.970909 max acc epoch : 8 test accuracy : 0.963927

Epoch :  26 loss training:  1.8155794172403148 Time :  1217
accuracy train: 0.997006 val: 0.968485 test: 0.969863
max validation accuracy : 0.970909 max acc epoch : 8 test accuracy : 0.963927

Epoch :  27 loss training:  1.9974195481881907 Time :  1228
accuracy train: 0.997220 val: 0.969697 test: 0.972603
max validation accuracy : 0.970909 max acc epoch : 8 test accuracy : 0.963927

Epoch :  28 loss training:  1.8126100817062252 Time :  1239
accuracy train: 0.997434 val: 0.968485 test: 0.970320
max validation accuracy : 0.970909 max acc epoch : 8 test accuracy : 0.963927

Epoch :  29 loss training:  1.8974206709062855 Time :  1251
accuracy train: 0.997220 val: 0.968485 test: 0.968037
max validation accuracy : 0.970909 max acc epoch : 8 test accuracy : 0.963927

Epoch :  30 loss training:  2.0149887410989322 Time :  1263
accuracy train: 0.996792 val: 0.974545 test: 0.965753
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  31 loss training:  1.7973629882526438 Time :  1274
accuracy train: 0.997006 val: 0.964848 test: 0.965753
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  32 loss training:  2.077574542940056 Time :  1285
accuracy train: 0.997861 val: 0.963636 test: 0.965297
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  33 loss training:  1.7864491045947943 Time :  1297
accuracy train: 0.995509 val: 0.960000 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  34 loss training:  1.5971453280180867 Time :  1308
accuracy train: 0.997434 val: 0.968485 test: 0.966210
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  35 loss training:  1.3947767752988511 Time :  1319
accuracy train: 0.997434 val: 0.969697 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  36 loss training:  1.7528650547374127 Time :  1330
accuracy train: 0.997861 val: 0.972121 test: 0.963014
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  37 loss training:  1.8015411755550303 Time :  1342
accuracy train: 0.997648 val: 0.972121 test: 0.967123
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  38 loss training:  1.762568100266435 Time :  1353
accuracy train: 0.997434 val: 0.968485 test: 0.965753
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  39 loss training:  2.338830237138609 Time :  1365
accuracy train: 0.997434 val: 0.967273 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  40 loss training:  2.412367334769442 Time :  1376
accuracy train: 0.992943 val: 0.951515 test: 0.933333
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  41 loss training:  2.5812195924481784 Time :  1388
accuracy train: 0.997434 val: 0.962424 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  42 loss training:  1.8126256281975657 Time :  1399
accuracy train: 0.996151 val: 0.961212 test: 0.965753
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  43 loss training:  1.7425927944623254 Time :  1411
accuracy train: 0.997434 val: 0.972121 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  44 loss training:  1.5855609458512845 Time :  1422
accuracy train: 0.997220 val: 0.970909 test: 0.966210
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  45 loss training:  1.6092371937436383 Time :  1433
accuracy train: 0.997434 val: 0.970909 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  46 loss training:  1.6259889622365336 Time :  1445
accuracy train: 0.997434 val: 0.969697 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  47 loss training:  1.5405721562065082 Time :  1456
accuracy train: 0.997434 val: 0.974545 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  48 loss training:  1.1783523458270793 Time :  1468
accuracy train: 0.997434 val: 0.970909 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  49 loss training:  1.206884177767165 Time :  1479
accuracy train: 0.995937 val: 0.967273 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  50 loss training:  1.2105079970078805 Time :  1490
accuracy train: 0.997434 val: 0.974545 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  51 loss training:  1.365933480507465 Time :  1502
accuracy train: 0.997648 val: 0.962424 test: 0.965297
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  52 loss training:  1.965810471979239 Time :  1513
accuracy train: 0.996792 val: 0.968485 test: 0.965297
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  53 loss training:  4.298021285329924 Time :  1525
accuracy train: 0.996792 val: 0.957576 test: 0.959817
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  54 loss training:  1.649215770417868 Time :  1536
accuracy train: 0.997434 val: 0.969697 test: 0.965297
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  55 loss training:  1.6859363668099832 Time :  1547
accuracy train: 0.997861 val: 0.966061 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  56 loss training:  1.841854182195675 Time :  1559
accuracy train: 0.997434 val: 0.964848 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  57 loss training:  1.3653699414144285 Time :  1570
accuracy train: 0.997220 val: 0.968485 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  58 loss training:  1.4362551573083238 Time :  1581
accuracy train: 0.997220 val: 0.968485 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  59 loss training:  1.3544390497616234 Time :  1592
accuracy train: 0.997861 val: 0.974545 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  60 loss training:  1.5869571805269516 Time :  1604
accuracy train: 0.997434 val: 0.972121 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

Epoch :  61 loss training:  1.1589172780575154 Time :  1615
accuracy train: 0.995723 val: 0.967273 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 30 test accuracy : 0.965753

========================================================================================================================================================================================================
best acc epoch :  30
validation accuracy :  0.9745454545454545
test accuracy :  0.9657534246575342
last test_accuracy :  0.9703196347031964
second best val :  0.9721212121212122
second best test :  0.9657534246575342
max gap 22
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  51 	 val_accuracy : 0.98303 	 test_accuracy : 0.97215 	 last test_accuracy : 0.95845 	 second best val : 0.98182 	 second best test : 0.96667
k :  1 	 best_acc epoch :  30 	 val_accuracy : 0.97455 	 test_accuracy : 0.96575 	 last test_accuracy : 0.97032 	 second best val : 0.97212 	 second best test : 0.96575

avg :  	 val_accuracy : 0.97879 	 test_accuracy : 0.96895 	 last_accuracy : 0.96438 	 second best val : 0.97697 	 second best test : 0.96621

std :  	 val_accuracy : 0.00424 	 test_accuracy : 0.00320 	 last_accuracy : 0.00594 	 second best val : 0.00485 	 second best test : 0.00046


date and time :  Sat Jun 19 14:37:58 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=833, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  46.42568323761225 Time :  13
accuracy train: 0.960009 val: 0.957576 test: 0.958447
max validation accuracy : 0.957576 max acc epoch : 1 test accuracy : 0.958447

Epoch :  2 loss training:  18.654690811410546 Time :  26
accuracy train: 0.973909 val: 0.970909 test: 0.967580
max validation accuracy : 0.970909 max acc epoch : 2 test accuracy : 0.967580

Epoch :  3 loss training:  16.02633787645027 Time :  38
accuracy train: 0.975834 val: 0.968485 test: 0.968037
max validation accuracy : 0.970909 max acc epoch : 2 test accuracy : 0.967580

Epoch :  4 loss training:  12.865123432595283 Time :  49
accuracy train: 0.975620 val: 0.960000 test: 0.962557
max validation accuracy : 0.970909 max acc epoch : 2 test accuracy : 0.967580

Epoch :  5 loss training:  11.280030048335902 Time :  61
accuracy train: 0.984388 val: 0.974545 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.966667

Epoch :  6 loss training:  9.4155900250189 Time :  72
accuracy train: 0.981394 val: 0.962424 test: 0.963014
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.966667

Epoch :  7 loss training:  9.954983111703768 Time :  83
accuracy train: 0.987169 val: 0.973333 test: 0.963470
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.966667

Epoch :  8 loss training:  9.452541895676404 Time :  95
accuracy train: 0.988452 val: 0.969697 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.966667

Epoch :  9 loss training:  7.912978287204169 Time :  107
accuracy train: 0.987382 val: 0.968485 test: 0.962557
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.966667

Epoch :  10 loss training:  7.967498190118931 Time :  118
accuracy train: 0.986955 val: 0.960000 test: 0.955708
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.966667

Epoch :  11 loss training:  7.282836654223502 Time :  130
accuracy train: 0.991018 val: 0.970909 test: 0.963470
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.966667

Epoch :  12 loss training:  6.7737790934043005 Time :  143
accuracy train: 0.990804 val: 0.970909 test: 0.959361
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.966667

Epoch :  13 loss training:  5.284100227931049 Time :  155
accuracy train: 0.994226 val: 0.968485 test: 0.965297
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.966667

Epoch :  14 loss training:  5.426684849662706 Time :  168
accuracy train: 0.994226 val: 0.974545 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.966667

Epoch :  15 loss training:  3.6489504211349413 Time :  180
accuracy train: 0.995295 val: 0.973333 test: 0.959361
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.966667

Epoch :  16 loss training:  2.9928645898762625 Time :  192
accuracy train: 0.991232 val: 0.973333 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.966667

Epoch :  17 loss training:  3.674298697267659 Time :  205
accuracy train: 0.995081 val: 0.974545 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.966667

Epoch :  18 loss training:  2.7638703597476706 Time :  217
accuracy train: 0.995723 val: 0.975758 test: 0.968950
max validation accuracy : 0.975758 max acc epoch : 18 test accuracy : 0.968950

Epoch :  19 loss training:  2.2318980900599854 Time :  230
accuracy train: 0.996364 val: 0.975758 test: 0.964840
max validation accuracy : 0.975758 max acc epoch : 18 test accuracy : 0.968950

Epoch :  20 loss training:  2.4365488515468314 Time :  242
accuracy train: 0.994867 val: 0.976970 test: 0.974429
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.974429

Epoch :  21 loss training:  2.78992261577514 Time :  254
accuracy train: 0.996792 val: 0.978182 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603

Epoch :  22 loss training:  2.336760295293061 Time :  267
accuracy train: 0.996792 val: 0.974545 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603

Epoch :  23 loss training:  2.1203005001116253 Time :  280
accuracy train: 0.996364 val: 0.973333 test: 0.967123
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603

Epoch :  24 loss training:  2.1403669625251496 Time :  292
accuracy train: 0.985458 val: 0.973333 test: 0.950685
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603

Epoch :  25 loss training:  2.6236608520775917 Time :  304
accuracy train: 0.996792 val: 0.974545 test: 0.966210
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603

Epoch :  26 loss training:  2.4286211730523064 Time :  317
accuracy train: 0.996364 val: 0.976970 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603

Epoch :  27 loss training:  3.726887489485307 Time :  329
accuracy train: 0.993798 val: 0.967273 test: 0.964384
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603

Epoch :  28 loss training:  2.6693443315380136 Time :  342
accuracy train: 0.996578 val: 0.973333 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603

Epoch :  29 loss training:  1.9937737266554905 Time :  354
accuracy train: 0.996578 val: 0.980606 test: 0.971233
max validation accuracy : 0.980606 max acc epoch : 29 test accuracy : 0.971233

Epoch :  30 loss training:  2.100454201685352 Time :  366
accuracy train: 0.996578 val: 0.972121 test: 0.968037
max validation accuracy : 0.980606 max acc epoch : 29 test accuracy : 0.971233

Epoch :  31 loss training:  2.214975286879053 Time :  379
accuracy train: 0.996578 val: 0.968485 test: 0.960274
max validation accuracy : 0.980606 max acc epoch : 29 test accuracy : 0.971233

Epoch :  32 loss training:  1.8452881743542093 Time :  391
accuracy train: 0.996151 val: 0.978182 test: 0.969406
max validation accuracy : 0.980606 max acc epoch : 29 test accuracy : 0.971233

Epoch :  33 loss training:  2.0280139895603497 Time :  403
accuracy train: 0.994012 val: 0.975758 test: 0.968493
max validation accuracy : 0.980606 max acc epoch : 29 test accuracy : 0.971233

Epoch :  34 loss training:  1.603387260603995 Time :  416
accuracy train: 0.996792 val: 0.976970 test: 0.971689
max validation accuracy : 0.980606 max acc epoch : 29 test accuracy : 0.971233

Epoch :  35 loss training:  1.6266646676413075 Time :  428
accuracy train: 0.993798 val: 0.975758 test: 0.970320
max validation accuracy : 0.980606 max acc epoch : 29 test accuracy : 0.971233

Epoch :  36 loss training:  1.8873947979409422 Time :  440
accuracy train: 0.995509 val: 0.961212 test: 0.949772
max validation accuracy : 0.980606 max acc epoch : 29 test accuracy : 0.971233

Epoch :  37 loss training:  1.7767193496492837 Time :  453
accuracy train: 0.996792 val: 0.976970 test: 0.967123
max validation accuracy : 0.980606 max acc epoch : 29 test accuracy : 0.971233

Epoch :  38 loss training:  1.7808874531783658 Time :  465
accuracy train: 0.996364 val: 0.975758 test: 0.966210
max validation accuracy : 0.980606 max acc epoch : 29 test accuracy : 0.971233

Epoch :  39 loss training:  1.8613567747879642 Time :  477
accuracy train: 0.996792 val: 0.976970 test: 0.965297
max validation accuracy : 0.980606 max acc epoch : 29 test accuracy : 0.971233

Epoch :  40 loss training:  2.4491142060651327 Time :  490
accuracy train: 0.994440 val: 0.978182 test: 0.968037
max validation accuracy : 0.980606 max acc epoch : 29 test accuracy : 0.971233

Epoch :  41 loss training:  2.249264075080646 Time :  502
accuracy train: 0.996792 val: 0.981818 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 41 test accuracy : 0.969863

Epoch :  42 loss training:  2.029911965768406 Time :  515
accuracy train: 0.996792 val: 0.978182 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 41 test accuracy : 0.969863

Epoch :  43 loss training:  1.7342875329331946 Time :  527
accuracy train: 0.996578 val: 0.975758 test: 0.965753
max validation accuracy : 0.981818 max acc epoch : 41 test accuracy : 0.969863

Epoch :  44 loss training:  1.7942439507387462 Time :  540
accuracy train: 0.996792 val: 0.978182 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 41 test accuracy : 0.969863

Epoch :  45 loss training:  1.8645733091525472 Time :  552
accuracy train: 0.996792 val: 0.975758 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 41 test accuracy : 0.969863

Epoch :  46 loss training:  1.6733968667340378 Time :  565
accuracy train: 0.997220 val: 0.983030 test: 0.969406
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  47 loss training:  1.5924376113243852 Time :  577
accuracy train: 0.994654 val: 0.980606 test: 0.967123
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  48 loss training:  1.626176482935989 Time :  589
accuracy train: 0.997220 val: 0.979394 test: 0.969406
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  49 loss training:  1.69496221054942 Time :  602
accuracy train: 0.996792 val: 0.981818 test: 0.971233
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  50 loss training:  1.8045790156702424 Time :  614
accuracy train: 0.997220 val: 0.976970 test: 0.959817
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  51 loss training:  1.8420620779806995 Time :  627
accuracy train: 0.997220 val: 0.979394 test: 0.968493
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  52 loss training:  1.576380199761843 Time :  639
accuracy train: 0.997006 val: 0.980606 test: 0.969863
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  53 loss training:  1.6414327616794253 Time :  651
accuracy train: 0.997220 val: 0.978182 test: 0.969406
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  54 loss training:  1.6574987632275224 Time :  664
accuracy train: 0.997220 val: 0.980606 test: 0.968037
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  55 loss training:  1.5146047467414974 Time :  676
accuracy train: 0.994226 val: 0.980606 test: 0.968493
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  56 loss training:  1.5082172296606586 Time :  689
accuracy train: 0.997006 val: 0.975758 test: 0.964840
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  57 loss training:  1.9352140457585847 Time :  701
accuracy train: 0.993584 val: 0.974545 test: 0.964840
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  58 loss training:  2.10158167604925 Time :  713
accuracy train: 0.994654 val: 0.975758 test: 0.964840
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  59 loss training:  2.401369581630206 Time :  726
accuracy train: 0.993370 val: 0.973333 test: 0.965297
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  60 loss training:  2.141525415916476 Time :  738
accuracy train: 0.996151 val: 0.966061 test: 0.965297
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  61 loss training:  1.7927954274182412 Time :  751
accuracy train: 0.997006 val: 0.978182 test: 0.968950
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  62 loss training:  1.5188862371874166 Time :  763
accuracy train: 0.996792 val: 0.976970 test: 0.965753
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  63 loss training:  1.4490772227969018 Time :  775
accuracy train: 0.996792 val: 0.972121 test: 0.968493
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  64 loss training:  1.4598652980105271 Time :  788
accuracy train: 0.997220 val: 0.974545 test: 0.968037
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  65 loss training:  1.5601844176669601 Time :  800
accuracy train: 0.997006 val: 0.979394 test: 0.966667
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  66 loss training:  1.645709824111691 Time :  813
accuracy train: 0.997006 val: 0.976970 test: 0.966210
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  67 loss training:  1.6456769504743534 Time :  825
accuracy train: 0.997006 val: 0.979394 test: 0.969406
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  68 loss training:  1.450429522612012 Time :  837
accuracy train: 0.997006 val: 0.974545 test: 0.969863
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  69 loss training:  1.8426395621338543 Time :  850
accuracy train: 0.997006 val: 0.974545 test: 0.968493
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  70 loss training:  1.4740123609824138 Time :  862
accuracy train: 0.997006 val: 0.975758 test: 0.968037
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  71 loss training:  1.5690551515963307 Time :  875
accuracy train: 0.997220 val: 0.976970 test: 0.963927
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  72 loss training:  1.3005216120991463 Time :  887
accuracy train: 0.997220 val: 0.975758 test: 0.967580
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  73 loss training:  1.5660496062373568 Time :  900
accuracy train: 0.997220 val: 0.979394 test: 0.970320
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  74 loss training:  1.4901103967650897 Time :  912
accuracy train: 0.997220 val: 0.979394 test: 0.970776
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  75 loss training:  1.7150404917751985 Time :  925
accuracy train: 0.997220 val: 0.973333 test: 0.962557
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  76 loss training:  1.9069420238101884 Time :  937
accuracy train: 0.996792 val: 0.976970 test: 0.964840
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

Epoch :  77 loss training:  1.4485089164500096 Time :  949
accuracy train: 0.997220 val: 0.973333 test: 0.967580
max validation accuracy : 0.983030 max acc epoch : 46 test accuracy : 0.969406

========================================================================================================================================================================================================
best acc epoch :  46
validation accuracy :  0.983030303030303
test accuracy :  0.9694063926940639
last test_accuracy :  0.9675799086757991
second best val :  0.9818181818181818
second best test :  0.9698630136986301
max gap 13
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=333, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  44.56216184981167 Time :  962
accuracy train: 0.955731 val: 0.932121 test: 0.946119
max validation accuracy : 0.932121 max acc epoch : 1 test accuracy : 0.946119

Epoch :  2 loss training:  16.617974370718002 Time :  974
accuracy train: 0.974551 val: 0.947879 test: 0.970320
max validation accuracy : 0.947879 max acc epoch : 2 test accuracy : 0.970320

Epoch :  3 loss training:  13.812183022499084 Time :  986
accuracy train: 0.975834 val: 0.952727 test: 0.965753
max validation accuracy : 0.952727 max acc epoch : 3 test accuracy : 0.965753

Epoch :  4 loss training:  13.341036967933178 Time :  997
accuracy train: 0.982464 val: 0.961212 test: 0.961187
max validation accuracy : 0.961212 max acc epoch : 4 test accuracy : 0.961187

Epoch :  5 loss training:  10.845118404831737 Time :  1009
accuracy train: 0.986099 val: 0.962424 test: 0.966210
max validation accuracy : 0.962424 max acc epoch : 5 test accuracy : 0.966210

Epoch :  6 loss training:  9.654657815466635 Time :  1020
accuracy train: 0.976476 val: 0.951515 test: 0.954795
max validation accuracy : 0.962424 max acc epoch : 5 test accuracy : 0.966210

Epoch :  7 loss training:  9.142288730014116 Time :  1032
accuracy train: 0.986099 val: 0.958788 test: 0.970776
max validation accuracy : 0.962424 max acc epoch : 5 test accuracy : 0.966210

Epoch :  8 loss training:  7.0424738803412765 Time :  1044
accuracy train: 0.986741 val: 0.957576 test: 0.972146
max validation accuracy : 0.962424 max acc epoch : 5 test accuracy : 0.966210

Epoch :  9 loss training:  7.776672642678022 Time :  1055
accuracy train: 0.987596 val: 0.955152 test: 0.968037
max validation accuracy : 0.962424 max acc epoch : 5 test accuracy : 0.966210

Epoch :  10 loss training:  8.315502129727975 Time :  1067
accuracy train: 0.988452 val: 0.969697 test: 0.951598
max validation accuracy : 0.969697 max acc epoch : 10 test accuracy : 0.951598

Epoch :  11 loss training:  7.037511511007324 Time :  1079
accuracy train: 0.988238 val: 0.960000 test: 0.963927
max validation accuracy : 0.969697 max acc epoch : 10 test accuracy : 0.951598

Epoch :  12 loss training:  5.353459443664178 Time :  1092
accuracy train: 0.994226 val: 0.968485 test: 0.970776
max validation accuracy : 0.969697 max acc epoch : 10 test accuracy : 0.951598

Epoch :  13 loss training:  4.432573778263759 Time :  1104
accuracy train: 0.994226 val: 0.962424 test: 0.965753
max validation accuracy : 0.969697 max acc epoch : 10 test accuracy : 0.951598

Epoch :  14 loss training:  3.5383022967143916 Time :  1116
accuracy train: 0.991660 val: 0.957576 test: 0.968037
max validation accuracy : 0.969697 max acc epoch : 10 test accuracy : 0.951598

Epoch :  15 loss training:  4.530764995026402 Time :  1129
accuracy train: 0.994867 val: 0.962424 test: 0.964384
max validation accuracy : 0.969697 max acc epoch : 10 test accuracy : 0.951598

Epoch :  16 loss training:  3.6011740620306227 Time :  1141
accuracy train: 0.996151 val: 0.961212 test: 0.973516
max validation accuracy : 0.969697 max acc epoch : 10 test accuracy : 0.951598

Epoch :  17 loss training:  2.9128673417435493 Time :  1154
accuracy train: 0.996151 val: 0.974545 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.969406

Epoch :  18 loss training:  2.5132780544809066 Time :  1166
accuracy train: 0.995081 val: 0.960000 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.969406

Epoch :  19 loss training:  3.8651129031495657 Time :  1178
accuracy train: 0.996578 val: 0.968485 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.969406

Epoch :  20 loss training:  3.5792933871562127 Time :  1191
accuracy train: 0.997220 val: 0.964848 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.969406

Epoch :  21 loss training:  2.950471046176972 Time :  1203
accuracy train: 0.997220 val: 0.964848 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 17 test accuracy : 0.969406

Epoch :  22 loss training:  1.9162857113042264 Time :  1216
accuracy train: 0.996578 val: 0.975758 test: 0.970320
max validation accuracy : 0.975758 max acc epoch : 22 test accuracy : 0.970320

Epoch :  23 loss training:  2.056393651619146 Time :  1228
accuracy train: 0.997434 val: 0.974545 test: 0.972146
max validation accuracy : 0.975758 max acc epoch : 22 test accuracy : 0.970320

Epoch :  24 loss training:  2.0564474830243853 Time :  1240
accuracy train: 0.997006 val: 0.972121 test: 0.972146
max validation accuracy : 0.975758 max acc epoch : 22 test accuracy : 0.970320

Epoch :  25 loss training:  1.8328206995902292 Time :  1253
accuracy train: 0.997006 val: 0.967273 test: 0.972146
max validation accuracy : 0.975758 max acc epoch : 22 test accuracy : 0.970320

Epoch :  26 loss training:  1.8698390983881836 Time :  1265
accuracy train: 0.997434 val: 0.967273 test: 0.973516
max validation accuracy : 0.975758 max acc epoch : 22 test accuracy : 0.970320

Epoch :  27 loss training:  2.0296776960349234 Time :  1278
accuracy train: 0.996364 val: 0.969697 test: 0.968950
max validation accuracy : 0.975758 max acc epoch : 22 test accuracy : 0.970320

Epoch :  28 loss training:  2.3874704324043705 Time :  1290
accuracy train: 0.994867 val: 0.963636 test: 0.961644
max validation accuracy : 0.975758 max acc epoch : 22 test accuracy : 0.970320

Epoch :  29 loss training:  2.649065333942417 Time :  1302
accuracy train: 0.994012 val: 0.953939 test: 0.963927
max validation accuracy : 0.975758 max acc epoch : 22 test accuracy : 0.970320

Epoch :  30 loss training:  2.0068385707127163 Time :  1315
accuracy train: 0.997220 val: 0.968485 test: 0.969863
max validation accuracy : 0.975758 max acc epoch : 22 test accuracy : 0.970320

Epoch :  31 loss training:  1.4157878963997064 Time :  1327
accuracy train: 0.997006 val: 0.967273 test: 0.970776
max validation accuracy : 0.975758 max acc epoch : 22 test accuracy : 0.970320

Epoch :  32 loss training:  1.65722896841271 Time :  1340
accuracy train: 0.997006 val: 0.963636 test: 0.964384
max validation accuracy : 0.975758 max acc epoch : 22 test accuracy : 0.970320

Epoch :  33 loss training:  2.610662591359869 Time :  1352
accuracy train: 0.997220 val: 0.955152 test: 0.964840
max validation accuracy : 0.975758 max acc epoch : 22 test accuracy : 0.970320

Epoch :  34 loss training:  1.9311911590957607 Time :  1364
accuracy train: 0.996364 val: 0.964848 test: 0.968493
max validation accuracy : 0.975758 max acc epoch : 22 test accuracy : 0.970320

Epoch :  35 loss training:  2.075184212451859 Time :  1377
accuracy train: 0.997434 val: 0.976970 test: 0.972603
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  36 loss training:  2.066799103460653 Time :  1389
accuracy train: 0.997434 val: 0.974545 test: 0.972146
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  37 loss training:  2.6754518032503256 Time :  1402
accuracy train: 0.997434 val: 0.966061 test: 0.966667
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  38 loss training:  1.5248380741736582 Time :  1414
accuracy train: 0.997006 val: 0.962424 test: 0.971689
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  39 loss training:  1.6958862951796618 Time :  1427
accuracy train: 0.997648 val: 0.968485 test: 0.967580
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  40 loss training:  1.4470491144411426 Time :  1439
accuracy train: 0.997220 val: 0.969697 test: 0.967580
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  41 loss training:  1.4394882558790414 Time :  1452
accuracy train: 0.997648 val: 0.969697 test: 0.972146
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  42 loss training:  1.2839664423236172 Time :  1464
accuracy train: 0.996578 val: 0.947879 test: 0.968950
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  43 loss training:  1.7180976129002374 Time :  1477
accuracy train: 0.997861 val: 0.961212 test: 0.966210
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  44 loss training:  1.6009551467577694 Time :  1489
accuracy train: 0.997648 val: 0.972121 test: 0.971689
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  45 loss training:  1.4296398024762311 Time :  1501
accuracy train: 0.997434 val: 0.972121 test: 0.975342
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  46 loss training:  2.3227806199101906 Time :  1514
accuracy train: 0.997434 val: 0.968485 test: 0.971689
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  47 loss training:  3.1629483256401727 Time :  1526
accuracy train: 0.995723 val: 0.966061 test: 0.956621
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  48 loss training:  3.003418316740863 Time :  1538
accuracy train: 0.996151 val: 0.945455 test: 0.959817
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  49 loss training:  2.437589867509814 Time :  1551
accuracy train: 0.997648 val: 0.967273 test: 0.968950
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  50 loss training:  1.366319686510451 Time :  1563
accuracy train: 0.997648 val: 0.960000 test: 0.967580
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  51 loss training:  1.7982876861387922 Time :  1576
accuracy train: 0.997648 val: 0.957576 test: 0.968037
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  52 loss training:  1.3726040105129869 Time :  1588
accuracy train: 0.997648 val: 0.967273 test: 0.966210
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  53 loss training:  1.4705177344858384 Time :  1600
accuracy train: 0.997861 val: 0.974545 test: 0.965297
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  54 loss training:  1.9637588076657266 Time :  1613
accuracy train: 0.997648 val: 0.973333 test: 0.967123
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  55 loss training:  1.485493246279475 Time :  1625
accuracy train: 0.997648 val: 0.969697 test: 0.963014
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  56 loss training:  1.23874555083421 Time :  1637
accuracy train: 0.997648 val: 0.969697 test: 0.968493
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  57 loss training:  1.4776108910864423 Time :  1650
accuracy train: 0.997434 val: 0.968485 test: 0.967580
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  58 loss training:  1.1094789734252117 Time :  1662
accuracy train: 0.997861 val: 0.970909 test: 0.971233
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  59 loss training:  1.3163267514664767 Time :  1675
accuracy train: 0.997434 val: 0.972121 test: 0.965753
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  60 loss training:  1.5354374893431668 Time :  1687
accuracy train: 0.997648 val: 0.974545 test: 0.967123
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  61 loss training:  1.4033219188072508 Time :  1699
accuracy train: 0.997861 val: 0.957576 test: 0.971233
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  62 loss training:  1.2424715652359737 Time :  1712
accuracy train: 0.997648 val: 0.970909 test: 0.967123
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  63 loss training:  1.535790681213257 Time :  1724
accuracy train: 0.997648 val: 0.967273 test: 0.969863
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  64 loss training:  1.2353047523738496 Time :  1737
accuracy train: 0.997648 val: 0.967273 test: 0.969406
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  65 loss training:  1.4506504917353595 Time :  1749
accuracy train: 0.997434 val: 0.969697 test: 0.966667
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

Epoch :  66 loss training:  1.492737160413526 Time :  1762
accuracy train: 0.997434 val: 0.964848 test: 0.964384
max validation accuracy : 0.976970 max acc epoch : 35 test accuracy : 0.972603

========================================================================================================================================================================================================
best acc epoch :  35
validation accuracy :  0.9769696969696969
test accuracy :  0.9726027397260274
last test_accuracy :  0.9643835616438357
second best val :  0.9757575757575757
second best test :  0.9703196347031964
max gap 13
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  46 	 val_accuracy : 0.98303 	 test_accuracy : 0.96941 	 last test_accuracy : 0.96758 	 second best val : 0.98182 	 second best test : 0.96986
k :  1 	 best_acc epoch :  35 	 val_accuracy : 0.97697 	 test_accuracy : 0.97260 	 last test_accuracy : 0.96438 	 second best val : 0.97576 	 second best test : 0.97032

avg :  	 val_accuracy : 0.98000 	 test_accuracy : 0.97100 	 last_accuracy : 0.96598 	 second best val : 0.97879 	 second best test : 0.97009

std :  	 val_accuracy : 0.00303 	 test_accuracy : 0.00160 	 last_accuracy : 0.00160 	 second best val : 0.00303 	 second best test : 0.00023


date and time :  Sat Jun 19 15:07:30 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=2, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=630, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  44.71715201437473 Time :  13
accuracy train: 0.960864 val: 0.951515 test: 0.955708
max validation accuracy : 0.951515 max acc epoch : 1 test accuracy : 0.955708
Counter({0: 3905, 1: 3786})

Epoch :  2 loss training:  16.922158646397293 Time :  28
accuracy train: 0.973268 val: 0.961212 test: 0.961644
max validation accuracy : 0.961212 max acc epoch : 2 test accuracy : 0.961644
Counter({0: 3852, 1: 3839})

Epoch :  3 loss training:  13.0390176740475 Time :  43
accuracy train: 0.965141 val: 0.950303 test: 0.963927
max validation accuracy : 0.961212 max acc epoch : 2 test accuracy : 0.961644
Counter({1: 3909, 0: 3782})

Epoch :  4 loss training:  12.397191210882738 Time :  58
accuracy train: 0.973695 val: 0.953939 test: 0.968037
max validation accuracy : 0.961212 max acc epoch : 2 test accuracy : 0.961644
Counter({0: 3895, 1: 3796})

Epoch :  5 loss training:  10.952186725335196 Time :  73
accuracy train: 0.983533 val: 0.970909 test: 0.970320
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.970320
Counter({1: 3888, 0: 3803})

Epoch :  6 loss training:  9.477697289607022 Time :  87
accuracy train: 0.985672 val: 0.964848 test: 0.972603
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.970320
Counter({1: 3894, 0: 3797})

Epoch :  7 loss training:  8.992392876883969 Time :  102
accuracy train: 0.984175 val: 0.967273 test: 0.966667
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.970320
Counter({1: 3863, 0: 3828})

Epoch :  8 loss training:  8.017243047012016 Time :  116
accuracy train: 0.985030 val: 0.964848 test: 0.966667
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3880, 1: 3811})

Epoch :  9 loss training:  8.159475706750527 Time :  131
accuracy train: 0.986955 val: 0.964848 test: 0.968950
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.970320
Counter({1: 3849, 0: 3842})

Epoch :  10 loss training:  7.322714666603133 Time :  145
accuracy train: 0.989949 val: 0.964848 test: 0.968493
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3877, 1: 3814})

Epoch :  11 loss training:  5.8295666424091905 Time :  160
accuracy train: 0.992087 val: 0.969697 test: 0.971689
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.970320
Counter({1: 3864, 0: 3827})

Epoch :  12 loss training:  6.402681409264915 Time :  176
accuracy train: 0.991873 val: 0.972121 test: 0.967123
max validation accuracy : 0.972121 max acc epoch : 12 test accuracy : 0.967123
Counter({0: 3899, 1: 3792})

Epoch :  13 loss training:  5.485877629194874 Time :  191
accuracy train: 0.994654 val: 0.979394 test: 0.973059
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({1: 3909, 0: 3782})

Epoch :  14 loss training:  3.4180886209360324 Time :  207
accuracy train: 0.991232 val: 0.970909 test: 0.969406
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({0: 3886, 1: 3805})

Epoch :  15 loss training:  3.415318191604456 Time :  222
accuracy train: 0.995509 val: 0.978182 test: 0.969863
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({1: 3913, 0: 3778})

Epoch :  16 loss training:  2.8761940491531277 Time :  237
accuracy train: 0.995937 val: 0.976970 test: 0.974886
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({0: 3929, 1: 3762})

Epoch :  17 loss training:  2.473950519663049 Time :  253
accuracy train: 0.996578 val: 0.968485 test: 0.975342
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({0: 3909, 1: 3782})

Epoch :  18 loss training:  2.212308660749841 Time :  268
accuracy train: 0.995937 val: 0.972121 test: 0.970320
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({1: 3931, 0: 3760})

Epoch :  19 loss training:  2.2482632220780943 Time :  284
accuracy train: 0.996578 val: 0.973333 test: 0.971233
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({0: 3903, 1: 3788})

Epoch :  20 loss training:  2.256510056766274 Time :  299
accuracy train: 0.994654 val: 0.962424 test: 0.971689
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({1: 3882, 0: 3809})

Epoch :  21 loss training:  2.3341983694263035 Time :  315
accuracy train: 0.996578 val: 0.972121 test: 0.969863
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({1: 3882, 0: 3809})

Epoch :  22 loss training:  2.8573157878854545 Time :  330
accuracy train: 0.995937 val: 0.969697 test: 0.974886
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({1: 3892, 0: 3799})

Epoch :  23 loss training:  2.0729687726743578 Time :  346
accuracy train: 0.996364 val: 0.970909 test: 0.975342
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({1: 3849, 0: 3842})

Epoch :  24 loss training:  3.0148336335023487 Time :  361
accuracy train: 0.994867 val: 0.972121 test: 0.970776
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({0: 3866, 1: 3825})

Epoch :  25 loss training:  2.6495665062975604 Time :  376
accuracy train: 0.997006 val: 0.972121 test: 0.971689
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({1: 3882, 0: 3809})

Epoch :  26 loss training:  1.7924645956481982 Time :  391
accuracy train: 0.997006 val: 0.974545 test: 0.976256
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({0: 3898, 1: 3793})

Epoch :  27 loss training:  1.5621569602653835 Time :  406
accuracy train: 0.996578 val: 0.973333 test: 0.975799
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({1: 3928, 0: 3763})

Epoch :  28 loss training:  2.0197117071802495 Time :  421
accuracy train: 0.996792 val: 0.974545 test: 0.969863
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({1: 3905, 0: 3786})

Epoch :  29 loss training:  2.5502650202906807 Time :  436
accuracy train: 0.997006 val: 0.974545 test: 0.968493
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({1: 3888, 0: 3803})

Epoch :  30 loss training:  2.3292667537898524 Time :  451
accuracy train: 0.996364 val: 0.969697 test: 0.968493
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({0: 3902, 1: 3789})

Epoch :  31 loss training:  1.6508701766633749 Time :  467
accuracy train: 0.997220 val: 0.972121 test: 0.969863
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({1: 3882, 0: 3809})

Epoch :  32 loss training:  1.6892370038804074 Time :  482
accuracy train: 0.995723 val: 0.974545 test: 0.968493
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({0: 3910, 1: 3781})

Epoch :  33 loss training:  2.493098559163627 Time :  498
accuracy train: 0.996792 val: 0.970909 test: 0.970320
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({0: 3887, 1: 3804})

Epoch :  34 loss training:  2.2301586374887847 Time :  513
accuracy train: 0.996151 val: 0.974545 test: 0.965297
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({1: 3861, 0: 3830})

Epoch :  35 loss training:  3.477958794359438 Time :  529
accuracy train: 0.997006 val: 0.978182 test: 0.969863
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({1: 3879, 0: 3812})

Epoch :  36 loss training:  1.9392209296056535 Time :  545
accuracy train: 0.996578 val: 0.973333 test: 0.969406
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({0: 3885, 1: 3806})

Epoch :  37 loss training:  1.7329641269461717 Time :  560
accuracy train: 0.997006 val: 0.972121 test: 0.971689
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({1: 3889, 0: 3802})

Epoch :  38 loss training:  1.3975632654637593 Time :  575
accuracy train: 0.997006 val: 0.970909 test: 0.970776
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({0: 3884, 1: 3807})

Epoch :  39 loss training:  1.3658887155770572 Time :  591
accuracy train: 0.996578 val: 0.973333 test: 0.970320
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({1: 3889, 0: 3802})

Epoch :  40 loss training:  1.509782430438463 Time :  606
accuracy train: 0.994867 val: 0.968485 test: 0.968037
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({0: 3881, 1: 3810})

Epoch :  41 loss training:  1.6910290635851197 Time :  621
accuracy train: 0.997006 val: 0.967273 test: 0.972603
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({1: 3887, 0: 3804})

Epoch :  42 loss training:  1.6584073975491265 Time :  637
accuracy train: 0.996151 val: 0.974545 test: 0.968037
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({0: 3876, 1: 3815})

Epoch :  43 loss training:  2.817285333401742 Time :  652
accuracy train: 0.993798 val: 0.975758 test: 0.968037
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({1: 3887, 0: 3804})

Epoch :  44 loss training:  2.412563367448456 Time :  668
accuracy train: 0.997006 val: 0.968485 test: 0.965753
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.973059
Counter({0: 3872, 1: 3819})

========================================================================================================================================================================================================
best acc epoch :  13
validation accuracy :  0.9793939393939394
test accuracy :  0.9730593607305936
last test_accuracy :  0.9657534246575342
second best val :  0.9781818181818182
second best test :  0.9730593607305936
max gap 7
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=2, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=677, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  46.1860138066113 Time :  686
accuracy train: 0.965355 val: 0.952727 test: 0.965297
max validation accuracy : 0.952727 max acc epoch : 1 test accuracy : 0.965297
Counter({1: 3949, 0: 3742})

Epoch :  2 loss training:  17.520665799966082 Time :  701
accuracy train: 0.975834 val: 0.967273 test: 0.971233
max validation accuracy : 0.967273 max acc epoch : 2 test accuracy : 0.971233
Counter({0: 3910, 1: 3781})

Epoch :  3 loss training:  13.795788197312504 Time :  715
accuracy train: 0.971343 val: 0.967273 test: 0.956164
max validation accuracy : 0.967273 max acc epoch : 2 test accuracy : 0.971233
Counter({0: 3893, 1: 3798})

Epoch :  4 loss training:  13.773627244401723 Time :  730
accuracy train: 0.973909 val: 0.962424 test: 0.966210
max validation accuracy : 0.967273 max acc epoch : 2 test accuracy : 0.971233
Counter({1: 3870, 0: 3821})

Epoch :  5 loss training:  12.486012704437599 Time :  744
accuracy train: 0.983533 val: 0.964848 test: 0.969863
max validation accuracy : 0.967273 max acc epoch : 2 test accuracy : 0.971233
Counter({1: 3865, 0: 3826})

Epoch :  6 loss training:  9.39419413660653 Time :  759
accuracy train: 0.986955 val: 0.969697 test: 0.972146
max validation accuracy : 0.969697 max acc epoch : 6 test accuracy : 0.972146
Counter({0: 3869, 1: 3822})

Epoch :  7 loss training:  10.090155708719976 Time :  774
accuracy train: 0.987596 val: 0.962424 test: 0.963927
max validation accuracy : 0.969697 max acc epoch : 6 test accuracy : 0.972146
Counter({1: 3880, 0: 3811})

Epoch :  8 loss training:  8.19530178885907 Time :  789
accuracy train: 0.985885 val: 0.966061 test: 0.971689
max validation accuracy : 0.969697 max acc epoch : 6 test accuracy : 0.972146
Counter({0: 3876, 1: 3815})

Epoch :  9 loss training:  8.044202310731634 Time :  803
accuracy train: 0.990376 val: 0.968485 test: 0.961187
max validation accuracy : 0.969697 max acc epoch : 6 test accuracy : 0.972146
Counter({1: 3923, 0: 3768})

Epoch :  10 loss training:  7.904824646888301 Time :  818
accuracy train: 0.983747 val: 0.962424 test: 0.965753
max validation accuracy : 0.969697 max acc epoch : 6 test accuracy : 0.972146
Counter({0: 3900, 1: 3791})

Epoch :  11 loss training:  7.357763239881024 Time :  834
accuracy train: 0.990376 val: 0.968485 test: 0.966210
max validation accuracy : 0.969697 max acc epoch : 6 test accuracy : 0.972146
Counter({0: 3896, 1: 3795})

Epoch :  12 loss training:  5.43893035966903 Time :  849
accuracy train: 0.990376 val: 0.964848 test: 0.973973
max validation accuracy : 0.969697 max acc epoch : 6 test accuracy : 0.972146
Counter({0: 3896, 1: 3795})

Epoch :  13 loss training:  5.435235011857003 Time :  865
accuracy train: 0.994440 val: 0.967273 test: 0.964840
max validation accuracy : 0.969697 max acc epoch : 6 test accuracy : 0.972146
Counter({1: 3909, 0: 3782})

Epoch :  14 loss training:  3.370307477307506 Time :  880
accuracy train: 0.994012 val: 0.966061 test: 0.970776
max validation accuracy : 0.969697 max acc epoch : 6 test accuracy : 0.972146
Counter({1: 3901, 0: 3790})

Epoch :  15 loss training:  3.5057013596815523 Time :  895
accuracy train: 0.994440 val: 0.966061 test: 0.965753
max validation accuracy : 0.969697 max acc epoch : 6 test accuracy : 0.972146
Counter({0: 3902, 1: 3789})

Epoch :  16 loss training:  3.5290417764917947 Time :  910
accuracy train: 0.995295 val: 0.969697 test: 0.968037
max validation accuracy : 0.969697 max acc epoch : 6 test accuracy : 0.972146
Counter({1: 3918, 0: 3773})

Epoch :  17 loss training:  3.2830704139196314 Time :  926
accuracy train: 0.995509 val: 0.972121 test: 0.969406
max validation accuracy : 0.972121 max acc epoch : 17 test accuracy : 0.969406
Counter({0: 3922, 1: 3769})

Epoch :  18 loss training:  2.7615144395676907 Time :  941
accuracy train: 0.993370 val: 0.966061 test: 0.972146
max validation accuracy : 0.972121 max acc epoch : 17 test accuracy : 0.969406
Counter({0: 3919, 1: 3772})

Epoch :  19 loss training:  3.110617991478648 Time :  957
accuracy train: 0.996151 val: 0.968485 test: 0.968950
max validation accuracy : 0.972121 max acc epoch : 17 test accuracy : 0.969406
Counter({1: 3914, 0: 3777})

Epoch :  20 loss training:  2.3463018898037262 Time :  972
accuracy train: 0.995723 val: 0.974545 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 20 test accuracy : 0.971689
Counter({1: 3911, 0: 3780})

Epoch :  21 loss training:  2.4506697988399537 Time :  988
accuracy train: 0.996578 val: 0.976970 test: 0.969406
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({0: 3915, 1: 3776})

Epoch :  22 loss training:  2.3251924327923916 Time :  1005
accuracy train: 0.989521 val: 0.966061 test: 0.968493
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({0: 3872, 1: 3819})

Epoch :  23 loss training:  5.401300645753508 Time :  1021
accuracy train: 0.994226 val: 0.973333 test: 0.966210
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({1: 3872, 0: 3819})

Epoch :  24 loss training:  2.9917284791590646 Time :  1036
accuracy train: 0.992515 val: 0.963636 test: 0.971689
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({0: 3890, 1: 3801})

Epoch :  25 loss training:  2.5798155439274524 Time :  1052
accuracy train: 0.993584 val: 0.968485 test: 0.968493
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({0: 3910, 1: 3781})

Epoch :  26 loss training:  2.0597361588152125 Time :  1068
accuracy train: 0.995723 val: 0.969697 test: 0.968493
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({1: 3906, 0: 3785})

Epoch :  27 loss training:  2.5003116634179605 Time :  1083
accuracy train: 0.996364 val: 0.973333 test: 0.970776
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({0: 3909, 1: 3782})

Epoch :  28 loss training:  2.861750586263952 Time :  1098
accuracy train: 0.996364 val: 0.974545 test: 0.969406
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({0: 3904, 1: 3787})

Epoch :  29 loss training:  1.7732223097809765 Time :  1113
accuracy train: 0.996792 val: 0.970909 test: 0.968037
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({1: 3913, 0: 3778})

Epoch :  30 loss training:  1.3564487671865209 Time :  1128
accuracy train: 0.997006 val: 0.975758 test: 0.970776
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({0: 3911, 1: 3780})

Epoch :  31 loss training:  1.8517546848634083 Time :  1144
accuracy train: 0.996364 val: 0.968485 test: 0.968493
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({1: 3911, 0: 3780})

Epoch :  32 loss training:  1.4234962655937125 Time :  1160
accuracy train: 0.997220 val: 0.970909 test: 0.970320
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({0: 3912, 1: 3779})

Epoch :  33 loss training:  1.868445923031686 Time :  1175
accuracy train: 0.996364 val: 0.974545 test: 0.968950
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({1: 3909, 0: 3782})

Epoch :  34 loss training:  1.6529951288212033 Time :  1190
accuracy train: 0.996578 val: 0.970909 test: 0.970320
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({1: 3912, 0: 3779})

Epoch :  35 loss training:  2.2916791378920607 Time :  1205
accuracy train: 0.995937 val: 0.968485 test: 0.965297
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({0: 3910, 1: 3781})

Epoch :  36 loss training:  2.1006729112523317 Time :  1221
accuracy train: 0.996151 val: 0.966061 test: 0.969406
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({1: 3902, 0: 3789})

Epoch :  37 loss training:  2.0214781793765724 Time :  1236
accuracy train: 0.996792 val: 0.966061 test: 0.969863
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({0: 3900, 1: 3791})

Epoch :  38 loss training:  2.257822138717529 Time :  1251
accuracy train: 0.994226 val: 0.963636 test: 0.966667
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({1: 3918, 0: 3773})

Epoch :  39 loss training:  1.6290334472469112 Time :  1267
accuracy train: 0.996578 val: 0.973333 test: 0.968950
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({0: 3917, 1: 3774})

Epoch :  40 loss training:  2.3874922410050203 Time :  1283
accuracy train: 0.994226 val: 0.963636 test: 0.959361
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({0: 3913, 1: 3778})

Epoch :  41 loss training:  2.2242091663520114 Time :  1298
accuracy train: 0.995509 val: 0.962424 test: 0.964384
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({1: 3905, 0: 3786})

Epoch :  42 loss training:  2.819799664867787 Time :  1314
accuracy train: 0.997006 val: 0.970909 test: 0.969406
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({1: 3902, 0: 3789})

Epoch :  43 loss training:  1.8893548291853222 Time :  1329
accuracy train: 0.996578 val: 0.973333 test: 0.967580
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({1: 3907, 0: 3784})

Epoch :  44 loss training:  1.7023418927565217 Time :  1345
accuracy train: 0.997648 val: 0.975758 test: 0.969863
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({0: 3909, 1: 3782})

Epoch :  45 loss training:  1.6062799664359773 Time :  1360
accuracy train: 0.997648 val: 0.972121 test: 0.968037
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({1: 3889, 0: 3802})

Epoch :  46 loss training:  1.8706441645299492 Time :  1377
accuracy train: 0.996792 val: 0.974545 test: 0.967580
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({1: 3903, 0: 3788})

Epoch :  47 loss training:  1.6296633892407044 Time :  1393
accuracy train: 0.997220 val: 0.970909 test: 0.972146
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({0: 3899, 1: 3792})

Epoch :  48 loss training:  1.257562266808236 Time :  1409
accuracy train: 0.994867 val: 0.967273 test: 0.968950
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({1: 3896, 0: 3795})

Epoch :  49 loss training:  1.835460329781199 Time :  1424
accuracy train: 0.997434 val: 0.968485 test: 0.972603
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({1: 3895, 0: 3796})

Epoch :  50 loss training:  3.193428989248787 Time :  1439
accuracy train: 0.995509 val: 0.960000 test: 0.968037
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({1: 3888, 0: 3803})

Epoch :  51 loss training:  1.7191084165679058 Time :  1455
accuracy train: 0.996578 val: 0.968485 test: 0.967123
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({0: 3898, 1: 3793})

Epoch :  52 loss training:  1.6390737099650323 Time :  1470
accuracy train: 0.996364 val: 0.969697 test: 0.969863
max validation accuracy : 0.976970 max acc epoch : 21 test accuracy : 0.969406
Counter({0: 3893, 1: 3798})

========================================================================================================================================================================================================
best acc epoch :  21
validation accuracy :  0.9769696969696969
test accuracy :  0.9694063926940639
last test_accuracy :  0.9698630136986301
second best val :  0.9757575757575757
second best test :  0.9694063926940639
max gap 11
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  13 	 val_accuracy : 0.97939 	 test_accuracy : 0.97306 	 last test_accuracy : 0.96575 	 second best val : 0.97818 	 second best test : 0.97306
k :  1 	 best_acc epoch :  21 	 val_accuracy : 0.97697 	 test_accuracy : 0.96941 	 last test_accuracy : 0.96986 	 second best val : 0.97576 	 second best test : 0.96941

avg :  	 val_accuracy : 0.97818 	 test_accuracy : 0.97123 	 last_accuracy : 0.96781 	 second best val : 0.97697 	 second best test : 0.97123

std :  	 val_accuracy : 0.00121 	 test_accuracy : 0.00183 	 last_accuracy : 0.00205 	 second best val : 0.00121 	 second best test : 0.00183
