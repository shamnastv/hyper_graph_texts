

date and time :  Wed Jun 16 01:59:37 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=15, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=2, num_mlp_layers=1, random_vec=False, seed=9, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({0: 2586, 1: 2553, 2: 2261})

Epoch :  1 loss training:  226.26705193519592 Time :  63
accuracy train: 0.627540 val: 0.622266 test: 0.607717
max validation accuracy : 0.622266 max acc epoch : 1 test accuracy : 0.607717
Counter({0: 2924, 1: 2730, 2: 1746})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  144.4671007990837 Time :  113
accuracy train: 0.686405 val: 0.660040 test: 0.636656
max validation accuracy : 0.660040 max acc epoch : 2 test accuracy : 0.636656
Counter({2: 3030, 0: 2711, 1: 1659})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  126.63694953918457 Time :  154
accuracy train: 0.736160 val: 0.703777 test: 0.654712
max validation accuracy : 0.703777 max acc epoch : 3 test accuracy : 0.654712
Counter({2: 2838, 1: 2418, 0: 2144})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  101.54877237975597 Time :  191
accuracy train: 0.788017 val: 0.709742 test: 0.687361
max validation accuracy : 0.709742 max acc epoch : 4 test accuracy : 0.687361
Counter({2: 2874, 1: 2417, 0: 2109})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  96.00692203640938 Time :  239
accuracy train: 0.810441 val: 0.707753 test: 0.689340
max validation accuracy : 0.709742 max acc epoch : 4 test accuracy : 0.687361
Counter({2: 3299, 0: 2598, 1: 1503})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  87.9904423058033 Time :  297
accuracy train: 0.807288 val: 0.719682 test: 0.689092
max validation accuracy : 0.719682 max acc epoch : 6 test accuracy : 0.689092
Counter({2: 3077, 1: 2634, 0: 1689})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  78.7185292840004 Time :  365
accuracy train: 0.833217 val: 0.729622 test: 0.700717
max validation accuracy : 0.729622 max acc epoch : 7 test accuracy : 0.700717
Counter({2: 3138, 0: 2643, 1: 1619})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.58462631702423 Time :  413
accuracy train: 0.841976 val: 0.725646 test: 0.710116
max validation accuracy : 0.729622 max acc epoch : 7 test accuracy : 0.700717
Counter({2: 3174, 0: 2572, 1: 1654})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  74.68582010269165 Time :  468
accuracy train: 0.850736 val: 0.725646 test: 0.702943
max validation accuracy : 0.729622 max acc epoch : 7 test accuracy : 0.700717
Counter({2: 3059, 0: 2669, 1: 1672})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  70.9772621691227 Time :  510
accuracy train: 0.856692 val: 0.725646 test: 0.706653
max validation accuracy : 0.729622 max acc epoch : 7 test accuracy : 0.700717
Counter({2: 2654, 1: 2596, 0: 2150})

Epoch :  11 loss training:  68.8026371896267 Time :  569
accuracy train: 0.867905 val: 0.727634 test: 0.710116
max validation accuracy : 0.729622 max acc epoch : 7 test accuracy : 0.700717
Counter({0: 3007, 1: 2746, 2: 1647})

Epoch :  12 loss training:  63.895611107349396 Time :  622
accuracy train: 0.872460 val: 0.727634 test: 0.711848
max validation accuracy : 0.729622 max acc epoch : 7 test accuracy : 0.700717
Counter({1: 3126, 2: 2621, 0: 1653})

Epoch :  13 loss training:  60.59792657196522 Time :  664
accuracy train: 0.883322 val: 0.727634 test: 0.708385
max validation accuracy : 0.729622 max acc epoch : 7 test accuracy : 0.700717
Counter({2: 3170, 1: 2615, 0: 1615})

Epoch :  14 loss training:  59.42355273663998 Time :  703
accuracy train: 0.895235 val: 0.725646 test: 0.707148
max validation accuracy : 0.729622 max acc epoch : 7 test accuracy : 0.700717
Counter({1: 2657, 2: 2578, 0: 2165})

Epoch :  15 loss training:  57.25733605027199 Time :  746
accuracy train: 0.898038 val: 0.735586 test: 0.708880
max validation accuracy : 0.735586 max acc epoch : 15 test accuracy : 0.708880
Counter({0: 2678, 2: 2609, 1: 2113})

Epoch :  16 loss training:  54.024595715105534 Time :  790
accuracy train: 0.907849 val: 0.725646 test: 0.711848
max validation accuracy : 0.735586 max acc epoch : 15 test accuracy : 0.708880
Counter({0: 3113, 1: 2695, 2: 1592})

Epoch :  17 loss training:  52.51785470545292 Time :  834
accuracy train: 0.920463 val: 0.727634 test: 0.713332
max validation accuracy : 0.735586 max acc epoch : 15 test accuracy : 0.708880
Counter({1: 2714, 0: 2573, 2: 2113})

Epoch :  18 loss training:  50.93178243935108 Time :  884
accuracy train: 0.919762 val: 0.733598 test: 0.710116
max validation accuracy : 0.735586 max acc epoch : 15 test accuracy : 0.708880
Counter({1: 2672, 2: 2619, 0: 2109})

Epoch :  19 loss training:  47.360326662659645 Time :  924
accuracy train: 0.930624 val: 0.739563 test: 0.711600
max validation accuracy : 0.739563 max acc epoch : 19 test accuracy : 0.711600
Counter({1: 2641, 2: 2571, 0: 2188})

Epoch :  20 loss training:  43.3157592266798 Time :  972
accuracy train: 0.934828 val: 0.721670 test: 0.709869
max validation accuracy : 0.739563 max acc epoch : 19 test accuracy : 0.711600
Counter({1: 3043, 0: 2735, 2: 1622})

Epoch :  21 loss training:  41.8561565130949 Time :  1020
accuracy train: 0.937631 val: 0.733598 test: 0.710611
max validation accuracy : 0.739563 max acc epoch : 19 test accuracy : 0.711600
Counter({2: 3114, 0: 2660, 1: 1626})

Epoch :  22 loss training:  39.62025147676468 Time :  1061
accuracy train: 0.945690 val: 0.733598 test: 0.709869
max validation accuracy : 0.739563 max acc epoch : 19 test accuracy : 0.711600
Counter({2: 3066, 1: 2724, 0: 1610})

Epoch :  23 loss training:  37.223359897732735 Time :  1098
accuracy train: 0.957253 val: 0.731610 test: 0.715310
max validation accuracy : 0.739563 max acc epoch : 19 test accuracy : 0.711600
Counter({2: 2681, 1: 2645, 0: 2074})

Epoch :  24 loss training:  33.8132791928947 Time :  1142
accuracy train: 0.959355 val: 0.739563 test: 0.718279
max validation accuracy : 0.739563 max acc epoch : 19 test accuracy : 0.711600
Counter({2: 2668, 1: 2627, 0: 2105})

Epoch :  25 loss training:  33.84858898818493 Time :  1195
accuracy train: 0.966363 val: 0.737575 test: 0.716794
max validation accuracy : 0.739563 max acc epoch : 19 test accuracy : 0.711600
Counter({1: 3123, 2: 2673, 0: 1604})

Epoch :  26 loss training:  31.50236015766859 Time :  1257
accuracy train: 0.966363 val: 0.733598 test: 0.715805
max validation accuracy : 0.739563 max acc epoch : 19 test accuracy : 0.711600
Counter({0: 3193, 1: 2612, 2: 1595})

Epoch :  27 loss training:  30.701721228659153 Time :  1326
accuracy train: 0.974422 val: 0.743539 test: 0.715310
max validation accuracy : 0.743539 max acc epoch : 27 test accuracy : 0.715310
Counter({0: 3098, 2: 2668, 1: 1634})

Epoch :  28 loss training:  28.09033028781414 Time :  1381
accuracy train: 0.980028 val: 0.739563 test: 0.719515
max validation accuracy : 0.743539 max acc epoch : 27 test accuracy : 0.715310
Counter({1: 3178, 0: 2674, 2: 1548})

Epoch :  29 loss training:  27.943883776664734 Time :  1439
accuracy train: 0.981780 val: 0.745527 test: 0.714568
max validation accuracy : 0.745527 max acc epoch : 29 test accuracy : 0.714568
Counter({2: 3182, 0: 2673, 1: 1545})

Epoch :  30 loss training:  25.79004657268524 Time :  1492
accuracy train: 0.978977 val: 0.737575 test: 0.715310
max validation accuracy : 0.745527 max acc epoch : 29 test accuracy : 0.714568
Counter({0: 3220, 2: 2624, 1: 1556})

Epoch :  31 loss training:  23.85929649695754 Time :  1544
accuracy train: 0.989488 val: 0.735586 test: 0.717784
max validation accuracy : 0.745527 max acc epoch : 29 test accuracy : 0.714568
Counter({0: 3222, 2: 2652, 1: 1526})

Epoch :  32 loss training:  21.843235347419977 Time :  1607
accuracy train: 0.988788 val: 0.731610 test: 0.710858
max validation accuracy : 0.745527 max acc epoch : 29 test accuracy : 0.714568
Counter({2: 3419, 1: 2490, 0: 1491})

Epoch :  33 loss training:  22.32294188439846 Time :  1673
accuracy train: 0.991941 val: 0.741551 test: 0.719763
max validation accuracy : 0.745527 max acc epoch : 29 test accuracy : 0.714568
Counter({0: 3317, 1: 2592, 2: 1491})

Epoch :  34 loss training:  20.627527989447117 Time :  1740
accuracy train: 0.991941 val: 0.733598 test: 0.717042
max validation accuracy : 0.745527 max acc epoch : 29 test accuracy : 0.714568
Counter({0: 3250, 2: 2654, 1: 1496})

Epoch :  35 loss training:  19.100963540375233 Time :  1803
accuracy train: 0.992292 val: 0.729622 test: 0.718526
max validation accuracy : 0.745527 max acc epoch : 29 test accuracy : 0.714568
Counter({1: 3304, 0: 2596, 2: 1500})

Epoch :  36 loss training:  18.159140821546316 Time :  1858
accuracy train: 0.994394 val: 0.737575 test: 0.715558
max validation accuracy : 0.745527 max acc epoch : 29 test accuracy : 0.714568
Counter({0: 3272, 1: 2624, 2: 1504})

Epoch :  37 loss training:  16.205776821821928 Time :  1919
accuracy train: 0.995445 val: 0.729622 test: 0.718773
max validation accuracy : 0.745527 max acc epoch : 29 test accuracy : 0.714568
Counter({1: 3339, 0: 2589, 2: 1472})

Epoch :  38 loss training:  15.383355664089322 Time :  1986
accuracy train: 0.996496 val: 0.739563 test: 0.714568
max validation accuracy : 0.745527 max acc epoch : 29 test accuracy : 0.714568
Counter({2: 3277, 0: 2640, 1: 1483})

Epoch :  39 loss training:  14.128258801996708 Time :  2045
accuracy train: 0.996146 val: 0.727634 test: 0.718526
max validation accuracy : 0.745527 max acc epoch : 29 test accuracy : 0.714568
Counter({2: 3305, 0: 2646, 1: 1449})

Epoch :  40 loss training:  14.050728283822536 Time :  2101
accuracy train: 0.996847 val: 0.737575 test: 0.715805
max validation accuracy : 0.745527 max acc epoch : 29 test accuracy : 0.714568
Counter({1: 3283, 0: 2647, 2: 1470})

Epoch :  41 loss training:  12.006185381673276 Time :  2154
accuracy train: 0.996847 val: 0.727634 test: 0.718031
max validation accuracy : 0.745527 max acc epoch : 29 test accuracy : 0.714568
Counter({2: 4365, 0: 1561, 1: 1474})

Epoch :  42 loss training:  12.314753608778119 Time :  2212
accuracy train: 0.998248 val: 0.729622 test: 0.719268
max validation accuracy : 0.745527 max acc epoch : 29 test accuracy : 0.714568
Counter({0: 3237, 2: 2698, 1: 1465})

Epoch :  43 loss training:  10.746204121038318 Time :  2269
accuracy train: 0.998598 val: 0.721670 test: 0.713579
max validation accuracy : 0.745527 max acc epoch : 29 test accuracy : 0.714568
Counter({0: 3265, 2: 2675, 1: 1460})

Epoch :  44 loss training:  11.29065230768174 Time :  2337
accuracy train: 0.999299 val: 0.729622 test: 0.716794
max validation accuracy : 0.745527 max acc epoch : 29 test accuracy : 0.714568
Counter({0: 3218, 2: 2759, 1: 1423})

Epoch :  45 loss training:  10.078146290034056 Time :  2398
accuracy train: 0.998598 val: 0.725646 test: 0.718279
max validation accuracy : 0.745527 max acc epoch : 29 test accuracy : 0.714568
Counter({0: 3276, 2: 2692, 1: 1432})

========================================================================================================================================================================================================
best acc epoch :  29
validation accuracy :  0.7455268389662028
test accuracy :  0.7145683898095474
last test_accuracy :  0.7182785060598565
second best val :  0.7435387673956262
second best test :  0.7153104130596092
max gap 8
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=15, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=2, num_mlp_layers=1, random_vec=False, seed=283, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 2604, 2: 2534, 0: 2262})

Epoch :  1 loss training:  221.3456336259842 Time :  2532
accuracy train: 0.639103 val: 0.600398 test: 0.605491
max validation accuracy : 0.600398 max acc epoch : 1 test accuracy : 0.605491
Counter({2: 3478, 0: 2140, 1: 1782})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  141.75001853704453 Time :  2595
accuracy train: 0.715137 val: 0.654076 test: 0.652486
max validation accuracy : 0.654076 max acc epoch : 2 test accuracy : 0.652486
Counter({2: 3709, 0: 2079, 1: 1612})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.52206808328629 Time :  2684
accuracy train: 0.761738 val: 0.705765 test: 0.679199
max validation accuracy : 0.705765 max acc epoch : 3 test accuracy : 0.679199
Counter({1: 3977, 0: 1977, 2: 1446})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  100.8324608206749 Time :  2766
accuracy train: 0.791521 val: 0.711730 test: 0.689834
max validation accuracy : 0.711730 max acc epoch : 4 test accuracy : 0.689834
Counter({0: 2919, 1: 2412, 2: 2069})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  92.40518489480019 Time :  2814
accuracy train: 0.800981 val: 0.703777 test: 0.690082
max validation accuracy : 0.711730 max acc epoch : 4 test accuracy : 0.689834
Counter({1: 3724, 0: 2040, 2: 1636})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  86.44454702734947 Time :  2857
accuracy train: 0.816398 val: 0.705765 test: 0.692802
max validation accuracy : 0.711730 max acc epoch : 4 test accuracy : 0.689834
Counter({0: 3051, 2: 2254, 1: 2095})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  79.83722472190857 Time :  2901
accuracy train: 0.841976 val: 0.719682 test: 0.710116
max validation accuracy : 0.719682 max acc epoch : 7 test accuracy : 0.710116
Counter({1: 3030, 2: 2352, 0: 2018})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  74.78780981898308 Time :  2956
accuracy train: 0.848283 val: 0.715706 test: 0.704180
max validation accuracy : 0.719682 max acc epoch : 7 test accuracy : 0.710116
Counter({1: 3009, 2: 2286, 0: 2105})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  73.40118607878685 Time :  3010
accuracy train: 0.852137 val: 0.701789 test: 0.706406
max validation accuracy : 0.719682 max acc epoch : 7 test accuracy : 0.710116
Counter({1: 2984, 2: 2315, 0: 2101})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  67.29708144068718 Time :  3061
accuracy train: 0.862999 val: 0.713718 test: 0.712095
max validation accuracy : 0.719682 max acc epoch : 7 test accuracy : 0.710116
Counter({0: 2975, 2: 2782, 1: 1643})

Epoch :  11 loss training:  65.6949731707573 Time :  3114
accuracy train: 0.871409 val: 0.717694 test: 0.711848
max validation accuracy : 0.719682 max acc epoch : 7 test accuracy : 0.710116
Counter({2: 2931, 0: 2818, 1: 1651})

Epoch :  12 loss training:  62.553300246596336 Time :  3172
accuracy train: 0.881219 val: 0.723658 test: 0.711106
max validation accuracy : 0.723658 max acc epoch : 12 test accuracy : 0.711106
Counter({1: 2944, 2: 2351, 0: 2105})

Epoch :  13 loss training:  58.81341049075127 Time :  3239
accuracy train: 0.892782 val: 0.715706 test: 0.712837
max validation accuracy : 0.723658 max acc epoch : 12 test accuracy : 0.711106
Counter({2: 2946, 0: 2808, 1: 1646})

Epoch :  14 loss training:  56.847594544291496 Time :  3308
accuracy train: 0.896987 val: 0.725646 test: 0.710611
max validation accuracy : 0.725646 max acc epoch : 14 test accuracy : 0.710611
Counter({2: 3037, 1: 2373, 0: 1990})

Epoch :  15 loss training:  53.237411096692085 Time :  3375
accuracy train: 0.908199 val: 0.721670 test: 0.704675
max validation accuracy : 0.725646 max acc epoch : 14 test accuracy : 0.710611
Counter({2: 3015, 1: 2366, 0: 2019})

Epoch :  16 loss training:  52.87863504886627 Time :  3434
accuracy train: 0.914856 val: 0.723658 test: 0.711353
max validation accuracy : 0.725646 max acc epoch : 14 test accuracy : 0.710611
Counter({0: 3733, 1: 2051, 2: 1616})

Epoch :  17 loss training:  49.81598077714443 Time :  3491
accuracy train: 0.925718 val: 0.719682 test: 0.713332
max validation accuracy : 0.725646 max acc epoch : 14 test accuracy : 0.710611
Counter({1: 3020, 0: 2359, 2: 2021})

Epoch :  18 loss training:  46.61483255028725 Time :  3549
accuracy train: 0.927470 val: 0.715706 test: 0.713579
max validation accuracy : 0.725646 max acc epoch : 14 test accuracy : 0.710611
Counter({2: 2986, 0: 2380, 1: 2034})

Epoch :  19 loss training:  46.21765133738518 Time :  3622
accuracy train: 0.935529 val: 0.727634 test: 0.706653
max validation accuracy : 0.727634 max acc epoch : 19 test accuracy : 0.706653
Counter({1: 3024, 2: 2366, 0: 2010})

Epoch :  20 loss training:  42.1189786568284 Time :  3677
accuracy train: 0.943238 val: 0.719682 test: 0.713084
max validation accuracy : 0.727634 max acc epoch : 19 test accuracy : 0.706653
Counter({2: 2996, 1: 2402, 0: 2002})

Epoch :  21 loss training:  39.47076313197613 Time :  3734
accuracy train: 0.947442 val: 0.729622 test: 0.714074
max validation accuracy : 0.729622 max acc epoch : 21 test accuracy : 0.714074
Counter({1: 2994, 0: 2383, 2: 2023})

Epoch :  22 loss training:  37.56967771798372 Time :  3794
accuracy train: 0.958655 val: 0.725646 test: 0.711106
max validation accuracy : 0.729622 max acc epoch : 21 test accuracy : 0.714074
Counter({1: 3011, 0: 2373, 2: 2016})

Epoch :  23 loss training:  36.04687274992466 Time :  3863
accuracy train: 0.961107 val: 0.719682 test: 0.714321
max validation accuracy : 0.729622 max acc epoch : 21 test accuracy : 0.714074
Counter({2: 2963, 0: 2820, 1: 1617})

Epoch :  24 loss training:  34.76695629954338 Time :  3932
accuracy train: 0.966013 val: 0.719682 test: 0.709127
max validation accuracy : 0.729622 max acc epoch : 21 test accuracy : 0.714074
Counter({2: 2953, 1: 2397, 0: 2050})

Epoch :  25 loss training:  31.499784752726555 Time :  3985
accuracy train: 0.971969 val: 0.721670 test: 0.711106
max validation accuracy : 0.729622 max acc epoch : 21 test accuracy : 0.714074
Counter({0: 3022, 1: 2339, 2: 2039})

Epoch :  26 loss training:  28.80005069077015 Time :  4041
accuracy train: 0.977575 val: 0.723658 test: 0.713332
max validation accuracy : 0.729622 max acc epoch : 21 test accuracy : 0.714074
Counter({0: 2996, 2: 2387, 1: 2017})

Epoch :  27 loss training:  26.97878537327051 Time :  4106
accuracy train: 0.977926 val: 0.727634 test: 0.708138
max validation accuracy : 0.729622 max acc epoch : 21 test accuracy : 0.714074
Counter({0: 2990, 1: 2353, 2: 2057})

Epoch :  28 loss training:  27.14603065699339 Time :  4165
accuracy train: 0.978977 val: 0.721670 test: 0.716052
max validation accuracy : 0.729622 max acc epoch : 21 test accuracy : 0.714074
Counter({0: 3006, 2: 2380, 1: 2014})

Epoch :  29 loss training:  26.200894825160503 Time :  4230
accuracy train: 0.983882 val: 0.723658 test: 0.713826
max validation accuracy : 0.729622 max acc epoch : 21 test accuracy : 0.714074
Counter({0: 2979, 2: 2395, 1: 2026})

Epoch :  30 loss training:  23.185545846819878 Time :  4291
accuracy train: 0.985634 val: 0.719682 test: 0.711106
max validation accuracy : 0.729622 max acc epoch : 21 test accuracy : 0.714074
Counter({0: 3046, 1: 2336, 2: 2018})

Epoch :  31 loss training:  21.421106282621622 Time :  4331
accuracy train: 0.990540 val: 0.715706 test: 0.713579
max validation accuracy : 0.729622 max acc epoch : 21 test accuracy : 0.714074
Counter({1: 3016, 2: 2339, 0: 2045})

Epoch :  32 loss training:  20.55331457592547 Time :  4389
accuracy train: 0.989839 val: 0.709742 test: 0.714074
max validation accuracy : 0.729622 max acc epoch : 21 test accuracy : 0.714074
Counter({1: 2945, 2: 2349, 0: 2106})

Epoch :  33 loss training:  18.030741538852453 Time :  4446
accuracy train: 0.990890 val: 0.727634 test: 0.713084
max validation accuracy : 0.729622 max acc epoch : 21 test accuracy : 0.714074
Counter({0: 2999, 2: 2349, 1: 2052})

Epoch :  34 loss training:  17.24455484561622 Time :  4507
accuracy train: 0.993343 val: 0.715706 test: 0.713332
max validation accuracy : 0.729622 max acc epoch : 21 test accuracy : 0.714074
Counter({0: 2933, 1: 2921, 2: 1546})

Epoch :  35 loss training:  17.358464393764734 Time :  4545
accuracy train: 0.995445 val: 0.731610 test: 0.713084
max validation accuracy : 0.731610 max acc epoch : 35 test accuracy : 0.713084
Counter({2: 4529, 0: 1508, 1: 1363})

Epoch :  36 loss training:  16.619834426790476 Time :  4579
accuracy train: 0.996496 val: 0.723658 test: 0.715063
max validation accuracy : 0.731610 max acc epoch : 35 test accuracy : 0.713084
Counter({1: 3029, 0: 2896, 2: 1475})

Epoch :  37 loss training:  15.983438931405544 Time :  4623
accuracy train: 0.996847 val: 0.721670 test: 0.708138
max validation accuracy : 0.731610 max acc epoch : 35 test accuracy : 0.713084
Counter({0: 3839, 2: 2031, 1: 1530})

Epoch :  38 loss training:  12.966232800856233 Time :  4687
accuracy train: 0.998598 val: 0.725646 test: 0.712095
max validation accuracy : 0.731610 max acc epoch : 35 test accuracy : 0.713084
Counter({2: 2965, 0: 2945, 1: 1490})

Epoch :  39 loss training:  13.643600471317768 Time :  4734
accuracy train: 0.997898 val: 0.725646 test: 0.716300
max validation accuracy : 0.731610 max acc epoch : 35 test accuracy : 0.713084
Counter({2: 3016, 0: 2927, 1: 1457})

Epoch :  40 loss training:  12.878140363842249 Time :  4774
accuracy train: 0.998248 val: 0.727634 test: 0.709869
max validation accuracy : 0.731610 max acc epoch : 35 test accuracy : 0.713084
Counter({2: 3013, 0: 2912, 1: 1475})

Epoch :  41 loss training:  10.84901287406683 Time :  4821
accuracy train: 0.997547 val: 0.729622 test: 0.713332
max validation accuracy : 0.731610 max acc epoch : 35 test accuracy : 0.713084
Counter({1: 2963, 0: 2935, 2: 1502})

Epoch :  42 loss training:  11.964004239067435 Time :  4873
accuracy train: 0.998598 val: 0.729622 test: 0.712590
max validation accuracy : 0.731610 max acc epoch : 35 test accuracy : 0.713084
Counter({1: 3783, 0: 2073, 2: 1544})

Epoch :  43 loss training:  10.114368932321668 Time :  4933
accuracy train: 0.999299 val: 0.739563 test: 0.708880
max validation accuracy : 0.739563 max acc epoch : 43 test accuracy : 0.708880
Counter({2: 2987, 1: 2316, 0: 2097})

Epoch :  44 loss training:  10.640448279678822 Time :  4988
accuracy train: 1.000000 val: 0.723658 test: 0.708632
max validation accuracy : 0.739563 max acc epoch : 43 test accuracy : 0.708880
Counter({2: 2948, 1: 2318, 0: 2134})

Epoch :  45 loss training:  8.30699317716062 Time :  5038
accuracy train: 0.999299 val: 0.727634 test: 0.710858
max validation accuracy : 0.739563 max acc epoch : 43 test accuracy : 0.708880
Counter({2: 3003, 0: 2916, 1: 1481})

Epoch :  46 loss training:  9.181244742125273 Time :  5076
accuracy train: 1.000000 val: 0.729622 test: 0.712095
max validation accuracy : 0.739563 max acc epoch : 43 test accuracy : 0.708880
Counter({2: 3827, 1: 2081, 0: 1492})

Epoch :  47 loss training:  8.168966699391603 Time :  5101
accuracy train: 1.000000 val: 0.713718 test: 0.712590
max validation accuracy : 0.739563 max acc epoch : 43 test accuracy : 0.708880
Counter({1: 4607, 2: 1438, 0: 1355})

Epoch :  48 loss training:  8.368963389657438 Time :  5140
accuracy train: 1.000000 val: 0.729622 test: 0.712095
max validation accuracy : 0.739563 max acc epoch : 43 test accuracy : 0.708880
Counter({2: 3015, 0: 2943, 1: 1442})

Epoch :  49 loss training:  7.150182537268847 Time :  5187
accuracy train: 1.000000 val: 0.729622 test: 0.715310
max validation accuracy : 0.739563 max acc epoch : 43 test accuracy : 0.708880
Counter({2: 4590, 0: 1459, 1: 1351})

Epoch :  50 loss training:  7.092760154977441 Time :  5224
accuracy train: 1.000000 val: 0.731610 test: 0.712342
max validation accuracy : 0.739563 max acc epoch : 43 test accuracy : 0.708880
Counter({0: 3097, 1: 2849, 2: 1454})

Epoch :  51 loss training:  6.638236603233963 Time :  5258
accuracy train: 1.000000 val: 0.723658 test: 0.713579
max validation accuracy : 0.739563 max acc epoch : 43 test accuracy : 0.708880
Counter({0: 4613, 2: 1442, 1: 1345})

Epoch :  52 loss training:  6.548986010253429 Time :  5302
accuracy train: 1.000000 val: 0.707753 test: 0.712095
max validation accuracy : 0.739563 max acc epoch : 43 test accuracy : 0.708880
Counter({2: 3016, 1: 2974, 0: 1410})

Epoch :  53 loss training:  6.410725026391447 Time :  5358
accuracy train: 1.000000 val: 0.711730 test: 0.710611
max validation accuracy : 0.739563 max acc epoch : 43 test accuracy : 0.708880
Counter({2: 4645, 0: 1416, 1: 1339})

Epoch :  54 loss training:  5.5264143561944366 Time :  5413
accuracy train: 1.000000 val: 0.735586 test: 0.714568
max validation accuracy : 0.739563 max acc epoch : 43 test accuracy : 0.708880
Counter({2: 4702, 1: 1393, 0: 1305})

Epoch :  55 loss training:  5.197520263493061 Time :  5466
accuracy train: 1.000000 val: 0.717694 test: 0.714321
max validation accuracy : 0.739563 max acc epoch : 43 test accuracy : 0.708880
Counter({0: 4673, 1: 1406, 2: 1321})

Epoch :  56 loss training:  5.195616987533867 Time :  5517
accuracy train: 1.000000 val: 0.723658 test: 0.712095
max validation accuracy : 0.739563 max acc epoch : 43 test accuracy : 0.708880
Counter({2: 4665, 0: 1417, 1: 1318})

Epoch :  57 loss training:  4.773243261966854 Time :  5566
accuracy train: 1.000000 val: 0.723658 test: 0.716547
max validation accuracy : 0.739563 max acc epoch : 43 test accuracy : 0.708880
Counter({2: 4699, 0: 1396, 1: 1305})

Epoch :  58 loss training:  4.870643158443272 Time :  5628
accuracy train: 1.000000 val: 0.725646 test: 0.717784
max validation accuracy : 0.739563 max acc epoch : 43 test accuracy : 0.708880
Counter({1: 4654, 0: 1437, 2: 1309})

Epoch :  59 loss training:  4.4890893753618 Time :  5684
accuracy train: 1.000000 val: 0.715706 test: 0.711353
max validation accuracy : 0.739563 max acc epoch : 43 test accuracy : 0.708880
Counter({1: 4687, 2: 1402, 0: 1311})

========================================================================================================================================================================================================
best acc epoch :  43
validation accuracy :  0.7395626242544732
test accuracy :  0.7088795448924067
last test_accuracy :  0.711352955725946
second best val :  0.73558648111332
second best test :  0.7088795448924067
max gap 14
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  29 	 val_accuracy : 0.74553 	 test_accuracy : 0.71457 	 last test_accuracy : 0.71828 	 second best val : 0.74354 	 second best test : 0.71531
k :  1 	 best_acc epoch :  43 	 val_accuracy : 0.73956 	 test_accuracy : 0.70888 	 last test_accuracy : 0.71135 	 second best val : 0.73559 	 second best test : 0.70888

avg :  	 val_accuracy : 0.74254 	 test_accuracy : 0.71172 	 last_accuracy : 0.71482 	 second best val : 0.73956 	 second best test : 0.71209

std :  	 val_accuracy : 0.00298 	 test_accuracy : 0.00284 	 last_accuracy : 0.00346 	 second best val : 0.00398 	 second best test : 0.00322


date and time :  Wed Jun 16 03:35:18 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=15, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=4, num_mlp_layers=1, random_vec=False, seed=383, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 2604, 2: 2534, 0: 2262})

Epoch :  1 loss training:  224.66693317890167 Time :  71
accuracy train: 0.642607 val: 0.600398 test: 0.595103
max validation accuracy : 0.600398 max acc epoch : 1 test accuracy : 0.595103
Counter({0: 2811, 2: 2403, 1: 2186})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  157.70667499303818 Time :  147
accuracy train: 0.709881 val: 0.630219 test: 0.643829
max validation accuracy : 0.630219 max acc epoch : 2 test accuracy : 0.643829
Counter({2: 2674, 0: 2507, 1: 2219})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  129.4213527739048 Time :  203
accuracy train: 0.720392 val: 0.671968 test: 0.640861
max validation accuracy : 0.671968 max acc epoch : 3 test accuracy : 0.640861
Counter({2: 2720, 0: 2492, 1: 2188})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  99.2429787516594 Time :  254
accuracy train: 0.769797 val: 0.685885 test: 0.667574
max validation accuracy : 0.685885 max acc epoch : 4 test accuracy : 0.667574
Counter({0: 2768, 1: 2534, 2: 2098})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  89.77393427491188 Time :  308
accuracy train: 0.821303 val: 0.697813 test: 0.693792
max validation accuracy : 0.697813 max acc epoch : 5 test accuracy : 0.693792
Counter({0: 2705, 1: 2574, 2: 2121})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.08851942420006 Time :  361
accuracy train: 0.842677 val: 0.705765 test: 0.690329
max validation accuracy : 0.705765 max acc epoch : 6 test accuracy : 0.690329
Counter({0: 2662, 1: 2563, 2: 2175})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  72.64879557490349 Time :  423
accuracy train: 0.860897 val: 0.713718 test: 0.703933
max validation accuracy : 0.713718 max acc epoch : 7 test accuracy : 0.703933
Counter({2: 2713, 0: 2468, 1: 2219})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.57741372287273 Time :  480
accuracy train: 0.862999 val: 0.711730 test: 0.702201
max validation accuracy : 0.713718 max acc epoch : 7 test accuracy : 0.703933
Counter({2: 2690, 1: 2482, 0: 2228})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.58268345892429 Time :  536
accuracy train: 0.884022 val: 0.707753 test: 0.700965
max validation accuracy : 0.713718 max acc epoch : 7 test accuracy : 0.703933
Counter({0: 2688, 2: 2488, 1: 2224})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  56.07976633310318 Time :  596
accuracy train: 0.899089 val: 0.729622 test: 0.708385
max validation accuracy : 0.729622 max acc epoch : 10 test accuracy : 0.708385
Counter({1: 2660, 2: 2497, 0: 2243})

Epoch :  11 loss training:  52.66103681921959 Time :  653
accuracy train: 0.904695 val: 0.719682 test: 0.710364
max validation accuracy : 0.729622 max acc epoch : 10 test accuracy : 0.708385
Counter({1: 2675, 0: 2482, 2: 2243})

Epoch :  12 loss training:  51.407802268862724 Time :  714
accuracy train: 0.912404 val: 0.703777 test: 0.708632
max validation accuracy : 0.729622 max acc epoch : 10 test accuracy : 0.708385
Counter({1: 2698, 0: 2456, 2: 2246})

Epoch :  13 loss training:  48.49761480093002 Time :  772
accuracy train: 0.921514 val: 0.719682 test: 0.712837
max validation accuracy : 0.729622 max acc epoch : 10 test accuracy : 0.708385
Counter({2: 2683, 1: 2470, 0: 2247})

Epoch :  14 loss training:  45.838684268295765 Time :  827
accuracy train: 0.940434 val: 0.699801 test: 0.714321
max validation accuracy : 0.729622 max acc epoch : 10 test accuracy : 0.708385
Counter({1: 2679, 2: 2467, 0: 2254})

Epoch :  15 loss training:  42.67683679610491 Time :  886
accuracy train: 0.947092 val: 0.713718 test: 0.707890
max validation accuracy : 0.729622 max acc epoch : 10 test accuracy : 0.708385
Counter({2: 2671, 0: 2471, 1: 2258})

Epoch :  16 loss training:  40.54252724349499 Time :  946
accuracy train: 0.951296 val: 0.713718 test: 0.712590
max validation accuracy : 0.729622 max acc epoch : 10 test accuracy : 0.708385
Counter({2: 2668, 0: 2474, 1: 2258})

Epoch :  17 loss training:  36.79514899849892 Time :  1007
accuracy train: 0.957603 val: 0.721670 test: 0.716300
max validation accuracy : 0.729622 max acc epoch : 10 test accuracy : 0.708385
Counter({0: 2676, 1: 2467, 2: 2257})

Epoch :  18 loss training:  35.102054700255394 Time :  1068
accuracy train: 0.960406 val: 0.709742 test: 0.713084
max validation accuracy : 0.729622 max acc epoch : 10 test accuracy : 0.708385
Counter({0: 2660, 1: 2482, 2: 2258})

Epoch :  19 loss training:  32.432593770325184 Time :  1130
accuracy train: 0.966013 val: 0.729622 test: 0.709869
max validation accuracy : 0.729622 max acc epoch : 10 test accuracy : 0.708385
Counter({0: 2660, 2: 2492, 1: 2248})

Epoch :  20 loss training:  30.71570435911417 Time :  1196
accuracy train: 0.968115 val: 0.723658 test: 0.711106
max validation accuracy : 0.729622 max acc epoch : 10 test accuracy : 0.708385
Counter({0: 2657, 2: 2489, 1: 2254})

Epoch :  21 loss training:  28.682747587561607 Time :  1257
accuracy train: 0.976875 val: 0.715706 test: 0.712590
max validation accuracy : 0.729622 max acc epoch : 10 test accuracy : 0.708385
Counter({2: 2651, 0: 2493, 1: 2256})

Epoch :  22 loss training:  26.985159404575825 Time :  1309
accuracy train: 0.980028 val: 0.721670 test: 0.715063
max validation accuracy : 0.729622 max acc epoch : 10 test accuracy : 0.708385
Counter({0: 2645, 1: 2502, 2: 2253})

Epoch :  23 loss training:  25.150244139134884 Time :  1354
accuracy train: 0.977575 val: 0.723658 test: 0.717289
max validation accuracy : 0.729622 max acc epoch : 10 test accuracy : 0.708385
Counter({0: 2659, 1: 2487, 2: 2254})

Epoch :  24 loss training:  22.01913658902049 Time :  1400
accuracy train: 0.978276 val: 0.727634 test: 0.711600
max validation accuracy : 0.729622 max acc epoch : 10 test accuracy : 0.708385
Counter({1: 2662, 0: 2485, 2: 2253})

Epoch :  25 loss training:  22.285354282706976 Time :  1444
accuracy train: 0.986335 val: 0.737575 test: 0.709127
max validation accuracy : 0.737575 max acc epoch : 25 test accuracy : 0.709127
Counter({2: 2653, 1: 2492, 0: 2255})

Epoch :  26 loss training:  20.661116912961006 Time :  1496
accuracy train: 0.988437 val: 0.721670 test: 0.715063
max validation accuracy : 0.737575 max acc epoch : 25 test accuracy : 0.709127
Counter({0: 2644, 2: 2495, 1: 2261})

Epoch :  27 loss training:  19.650794181972742 Time :  1547
accuracy train: 0.992292 val: 0.731610 test: 0.708385
max validation accuracy : 0.737575 max acc epoch : 25 test accuracy : 0.709127
Counter({1: 2657, 2: 2495, 0: 2248})

Epoch :  28 loss training:  18.300131419673562 Time :  1603
accuracy train: 0.991941 val: 0.719682 test: 0.709374
max validation accuracy : 0.737575 max acc epoch : 25 test accuracy : 0.709127
Counter({1: 2650, 0: 2503, 2: 2247})

Epoch :  29 loss training:  15.64161547087133 Time :  1662
accuracy train: 0.989839 val: 0.723658 test: 0.712837
max validation accuracy : 0.737575 max acc epoch : 25 test accuracy : 0.709127
Counter({1: 2653, 0: 2495, 2: 2252})

Epoch :  30 loss training:  15.312399612739682 Time :  1721
accuracy train: 0.994394 val: 0.741551 test: 0.714568
max validation accuracy : 0.741551 max acc epoch : 30 test accuracy : 0.714568
Counter({1: 2650, 2: 2505, 0: 2245})

Epoch :  31 loss training:  15.25356131605804 Time :  1783
accuracy train: 0.997898 val: 0.725646 test: 0.708138
max validation accuracy : 0.741551 max acc epoch : 30 test accuracy : 0.714568
Counter({1: 2661, 0: 2496, 2: 2243})

Epoch :  32 loss training:  12.733153808861971 Time :  1848
accuracy train: 0.996496 val: 0.741551 test: 0.711106
max validation accuracy : 0.741551 max acc epoch : 30 test accuracy : 0.714568
Counter({1: 2668, 0: 2486, 2: 2246})

Epoch :  33 loss training:  11.403855804353952 Time :  1902
accuracy train: 0.996146 val: 0.735586 test: 0.711848
max validation accuracy : 0.741551 max acc epoch : 30 test accuracy : 0.714568
Counter({2: 2683, 1: 2465, 0: 2252})

Epoch :  34 loss training:  11.153214925900102 Time :  1965
accuracy train: 0.995795 val: 0.735586 test: 0.716794
max validation accuracy : 0.741551 max acc epoch : 30 test accuracy : 0.714568
Counter({0: 2657, 1: 2505, 2: 2238})

Epoch :  35 loss training:  11.029831897467375 Time :  2025
accuracy train: 0.999299 val: 0.739563 test: 0.716794
max validation accuracy : 0.741551 max acc epoch : 30 test accuracy : 0.714568
Counter({1: 2660, 2: 2501, 0: 2239})

Epoch :  36 loss training:  9.776858562603593 Time :  2088
accuracy train: 0.997547 val: 0.741551 test: 0.715558
max validation accuracy : 0.741551 max acc epoch : 30 test accuracy : 0.714568
Counter({1: 2672, 0: 2493, 2: 2235})

Epoch :  37 loss training:  9.502252155914903 Time :  2146
accuracy train: 0.997898 val: 0.729622 test: 0.716547
max validation accuracy : 0.741551 max acc epoch : 30 test accuracy : 0.714568
Counter({1: 2698, 0: 2469, 2: 2233})

Epoch :  38 loss training:  9.025405641645193 Time :  2201
accuracy train: 0.997898 val: 0.725646 test: 0.711106
max validation accuracy : 0.741551 max acc epoch : 30 test accuracy : 0.714568
Counter({1: 2687, 2: 2490, 0: 2223})

Epoch :  39 loss training:  9.580286897718906 Time :  2259
accuracy train: 0.998949 val: 0.731610 test: 0.714074
max validation accuracy : 0.741551 max acc epoch : 30 test accuracy : 0.714568
Counter({1: 2686, 0: 2485, 2: 2229})

Epoch :  40 loss training:  8.139223045203835 Time :  2315
accuracy train: 0.998949 val: 0.725646 test: 0.718526
max validation accuracy : 0.741551 max acc epoch : 30 test accuracy : 0.714568
Counter({0: 2698, 2: 2473, 1: 2229})

Epoch :  41 loss training:  7.254344132263213 Time :  2372
accuracy train: 0.998949 val: 0.721670 test: 0.714321
max validation accuracy : 0.741551 max acc epoch : 30 test accuracy : 0.714568
Counter({2: 2686, 0: 2487, 1: 2227})

Epoch :  42 loss training:  6.2506070784293115 Time :  2438
accuracy train: 0.999650 val: 0.735586 test: 0.719763
max validation accuracy : 0.741551 max acc epoch : 30 test accuracy : 0.714568
Counter({0: 2688, 1: 2487, 2: 2225})

Epoch :  43 loss training:  5.887814295943826 Time :  2489
accuracy train: 0.998949 val: 0.733598 test: 0.718526
max validation accuracy : 0.741551 max acc epoch : 30 test accuracy : 0.714568
Counter({2: 2696, 0: 2481, 1: 2223})

Epoch :  44 loss training:  6.43093691021204 Time :  2538
accuracy train: 0.999650 val: 0.737575 test: 0.713084
max validation accuracy : 0.741551 max acc epoch : 30 test accuracy : 0.714568
Counter({1: 2682, 2: 2494, 0: 2224})

Epoch :  45 loss training:  5.863557115662843 Time :  2597
accuracy train: 0.999299 val: 0.729622 test: 0.717536
max validation accuracy : 0.741551 max acc epoch : 30 test accuracy : 0.714568
Counter({0: 2723, 1: 2472, 2: 2205})

Epoch :  46 loss training:  5.730994250159711 Time :  2654
accuracy train: 0.999299 val: 0.729622 test: 0.713826
max validation accuracy : 0.741551 max acc epoch : 30 test accuracy : 0.714568
Counter({1: 2694, 0: 2503, 2: 2203})

========================================================================================================================================================================================================
best acc epoch :  30
validation accuracy :  0.7415506958250497
test accuracy :  0.7145683898095474
last test_accuracy :  0.7138263665594855
second best val :  0.7395626242544732
second best test :  0.7145683898095474
max gap 15
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=15, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=4, num_mlp_layers=1, random_vec=False, seed=562, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 2587, 2: 2555, 0: 2258})

Epoch :  1 loss training:  215.5573159456253 Time :  2763
accuracy train: 0.565522 val: 0.542744 test: 0.542914
max validation accuracy : 0.542744 max acc epoch : 1 test accuracy : 0.542914
Counter({2: 3244, 0: 2656, 1: 1500})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  155.53488326072693 Time :  2841
accuracy train: 0.674142 val: 0.608350 test: 0.618353
max validation accuracy : 0.608350 max acc epoch : 2 test accuracy : 0.618353
Counter({1: 3231, 2: 2705, 0: 1464})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  129.80221110582352 Time :  2910
accuracy train: 0.725999 val: 0.652087 test: 0.638635
max validation accuracy : 0.652087 max acc epoch : 3 test accuracy : 0.638635
Counter({1: 2830, 2: 2729, 0: 1841})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  99.18322336673737 Time :  2973
accuracy train: 0.796076 val: 0.687873 test: 0.692802
max validation accuracy : 0.687873 max acc epoch : 4 test accuracy : 0.692802
Counter({0: 2770, 1: 2750, 2: 1880})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  90.21854022145271 Time :  3045
accuracy train: 0.812894 val: 0.681909 test: 0.686124
max validation accuracy : 0.687873 max acc epoch : 4 test accuracy : 0.692802
Counter({2: 3366, 1: 2547, 0: 1487})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.59189593791962 Time :  3112
accuracy train: 0.798879 val: 0.666004 test: 0.682909
max validation accuracy : 0.687873 max acc epoch : 4 test accuracy : 0.692802
Counter({2: 3430, 1: 2484, 0: 1486})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  72.22806844115257 Time :  3171
accuracy train: 0.854590 val: 0.689861 test: 0.696512
max validation accuracy : 0.689861 max acc epoch : 7 test accuracy : 0.696512
Counter({2: 3394, 1: 2532, 0: 1474})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.99596163630486 Time :  3222
accuracy train: 0.866153 val: 0.695825 test: 0.700223
max validation accuracy : 0.695825 max acc epoch : 8 test accuracy : 0.700223
Counter({1: 3405, 2: 2509, 0: 1486})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  61.37710481882095 Time :  3273
accuracy train: 0.874912 val: 0.699801 test: 0.700717
max validation accuracy : 0.699801 max acc epoch : 9 test accuracy : 0.700717
Counter({1: 3410, 2: 2508, 0: 1482})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  57.85587726533413 Time :  3328
accuracy train: 0.890329 val: 0.695825 test: 0.706653
max validation accuracy : 0.699801 max acc epoch : 9 test accuracy : 0.700717
Counter({0: 3424, 1: 2488, 2: 1488})

Epoch :  11 loss training:  55.61146867275238 Time :  3381
accuracy train: 0.900841 val: 0.709742 test: 0.710858
max validation accuracy : 0.709742 max acc epoch : 11 test accuracy : 0.710858
Counter({1: 3441, 2: 2474, 0: 1485})

Epoch :  12 loss training:  54.944747656583786 Time :  3434
accuracy train: 0.909951 val: 0.707753 test: 0.703685
max validation accuracy : 0.709742 max acc epoch : 11 test accuracy : 0.710858
Counter({0: 3394, 1: 2512, 2: 1494})

Epoch :  13 loss training:  49.023777306079865 Time :  3498
accuracy train: 0.919411 val: 0.707753 test: 0.705417
max validation accuracy : 0.709742 max acc epoch : 11 test accuracy : 0.710858
Counter({0: 3411, 1: 2487, 2: 1502})

Epoch :  14 loss training:  45.60464006662369 Time :  3567
accuracy train: 0.926769 val: 0.713718 test: 0.703191
max validation accuracy : 0.713718 max acc epoch : 14 test accuracy : 0.703191
Counter({0: 3412, 2: 2481, 1: 1507})

Epoch :  15 loss training:  41.72718667984009 Time :  3628
accuracy train: 0.944989 val: 0.717694 test: 0.703933
max validation accuracy : 0.717694 max acc epoch : 15 test accuracy : 0.703933
Counter({2: 3466, 0: 2426, 1: 1508})

Epoch :  16 loss training:  42.139289647340775 Time :  3690
accuracy train: 0.944989 val: 0.709742 test: 0.706159
max validation accuracy : 0.717694 max acc epoch : 15 test accuracy : 0.703933
Counter({0: 3421, 1: 2472, 2: 1507})

Epoch :  17 loss training:  38.97019873559475 Time :  3739
accuracy train: 0.951997 val: 0.719682 test: 0.711106
max validation accuracy : 0.719682 max acc epoch : 17 test accuracy : 0.711106
Counter({1: 3396, 0: 2498, 2: 1506})

Epoch :  18 loss training:  34.85551992058754 Time :  3795
accuracy train: 0.954800 val: 0.715706 test: 0.710116
max validation accuracy : 0.719682 max acc epoch : 17 test accuracy : 0.711106
Counter({0: 3445, 1: 2446, 2: 1509})

Epoch :  19 loss training:  33.51543199270964 Time :  3859
accuracy train: 0.968816 val: 0.717694 test: 0.710116
max validation accuracy : 0.719682 max acc epoch : 17 test accuracy : 0.711106
Counter({0: 3375, 2: 2517, 1: 1508})

Epoch :  20 loss training:  31.371045362204313 Time :  3923
accuracy train: 0.966363 val: 0.707753 test: 0.704427
max validation accuracy : 0.719682 max acc epoch : 17 test accuracy : 0.711106
Counter({0: 3352, 2: 2539, 1: 1509})

Epoch :  21 loss training:  28.228368557989597 Time :  3982
accuracy train: 0.977225 val: 0.715706 test: 0.700223
max validation accuracy : 0.719682 max acc epoch : 17 test accuracy : 0.711106
Counter({0: 3361, 1: 2528, 2: 1511})

Epoch :  22 loss training:  27.173228837549686 Time :  4044
accuracy train: 0.975823 val: 0.717694 test: 0.710858
max validation accuracy : 0.719682 max acc epoch : 17 test accuracy : 0.711106
Counter({0: 3421, 2: 2472, 1: 1507})

Epoch :  23 loss training:  25.177363950759172 Time :  4117
accuracy train: 0.980729 val: 0.729622 test: 0.710611
max validation accuracy : 0.729622 max acc epoch : 23 test accuracy : 0.710611
Counter({1: 3422, 2: 2484, 0: 1494})

Epoch :  24 loss training:  22.898457136005163 Time :  4187
accuracy train: 0.983532 val: 0.727634 test: 0.710858
max validation accuracy : 0.729622 max acc epoch : 23 test accuracy : 0.710611
Counter({2: 3447, 1: 2445, 0: 1508})

Epoch :  25 loss training:  23.476880095899105 Time :  4257
accuracy train: 0.985634 val: 0.721670 test: 0.710611
max validation accuracy : 0.729622 max acc epoch : 23 test accuracy : 0.710611
Counter({2: 2510, 0: 2477, 1: 2413})

Epoch :  26 loss training:  21.554401010274887 Time :  4318
accuracy train: 0.992642 val: 0.729622 test: 0.707890
max validation accuracy : 0.729622 max acc epoch : 23 test accuracy : 0.710611
Counter({2: 3407, 0: 2502, 1: 1491})

Epoch :  27 loss training:  18.004355300217867 Time :  4387
accuracy train: 0.992992 val: 0.721670 test: 0.703685
max validation accuracy : 0.729622 max acc epoch : 23 test accuracy : 0.710611
Counter({2: 2578, 0: 2436, 1: 2386})

Epoch :  28 loss training:  17.274403281509876 Time :  4443
accuracy train: 0.994043 val: 0.719682 test: 0.708138
max validation accuracy : 0.729622 max acc epoch : 23 test accuracy : 0.710611
Counter({2: 2559, 1: 2440, 0: 2401})

Epoch :  29 loss training:  15.674527829512954 Time :  4494
accuracy train: 0.994394 val: 0.719682 test: 0.708385
max validation accuracy : 0.729622 max acc epoch : 23 test accuracy : 0.710611
Counter({2: 2562, 1: 2430, 0: 2408})

Epoch :  30 loss training:  15.428885873407125 Time :  4538
accuracy train: 0.996146 val: 0.713718 test: 0.705911
max validation accuracy : 0.729622 max acc epoch : 23 test accuracy : 0.710611
Counter({1: 2595, 0: 2440, 2: 2365})

Epoch :  31 loss training:  14.362089026719332 Time :  4594
accuracy train: 0.996146 val: 0.719682 test: 0.709374
max validation accuracy : 0.729622 max acc epoch : 23 test accuracy : 0.710611
Counter({1: 2609, 0: 2447, 2: 2344})

Epoch :  32 loss training:  13.31051492318511 Time :  4656
accuracy train: 0.997898 val: 0.705765 test: 0.710858
max validation accuracy : 0.729622 max acc epoch : 23 test accuracy : 0.710611
Counter({0: 3335, 2: 2569, 1: 1496})

Epoch :  33 loss training:  11.929854489862919 Time :  4716
accuracy train: 0.995445 val: 0.719682 test: 0.708632
max validation accuracy : 0.729622 max acc epoch : 23 test accuracy : 0.710611
Counter({2: 2600, 0: 2469, 1: 2331})

Epoch :  34 loss training:  11.24439539667219 Time :  4772
accuracy train: 0.998598 val: 0.711730 test: 0.707890
max validation accuracy : 0.729622 max acc epoch : 23 test accuracy : 0.710611
Counter({1: 3372, 2: 2533, 0: 1495})

Epoch :  35 loss training:  9.923150513321161 Time :  4832
accuracy train: 0.997547 val: 0.711730 test: 0.711106
max validation accuracy : 0.729622 max acc epoch : 23 test accuracy : 0.710611
Counter({1: 3365, 2: 2543, 0: 1492})

Epoch :  36 loss training:  9.557438245043159 Time :  4891
accuracy train: 0.999650 val: 0.711730 test: 0.711353
max validation accuracy : 0.729622 max acc epoch : 23 test accuracy : 0.710611
Counter({2: 2572, 0: 2455, 1: 2373})

Epoch :  37 loss training:  8.968106864951551 Time :  4932
accuracy train: 0.999650 val: 0.725646 test: 0.710116
max validation accuracy : 0.729622 max acc epoch : 23 test accuracy : 0.710611
Counter({1: 3347, 0: 2571, 2: 1482})

Epoch :  38 loss training:  9.32577435579151 Time :  4982
accuracy train: 0.999650 val: 0.715706 test: 0.709374
max validation accuracy : 0.729622 max acc epoch : 23 test accuracy : 0.710611
Counter({1: 2614, 2: 2427, 0: 2359})

Epoch :  39 loss training:  8.337647766806185 Time :  5040
accuracy train: 0.999299 val: 0.715706 test: 0.708880
max validation accuracy : 0.729622 max acc epoch : 23 test accuracy : 0.710611
Counter({1: 2611, 0: 2422, 2: 2367})

========================================================================================================================================================================================================
best acc epoch :  23
validation accuracy :  0.7296222664015904
test accuracy :  0.7106109324758842
last test_accuracy :  0.7088795448924067
second best val :  0.7276341948310139
second best test :  0.7106109324758842
max gap 6
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  30 	 val_accuracy : 0.74155 	 test_accuracy : 0.71457 	 last test_accuracy : 0.71383 	 second best val : 0.73956 	 second best test : 0.71457
k :  1 	 best_acc epoch :  23 	 val_accuracy : 0.72962 	 test_accuracy : 0.71061 	 last test_accuracy : 0.70888 	 second best val : 0.72763 	 second best test : 0.71061

avg :  	 val_accuracy : 0.73559 	 test_accuracy : 0.71259 	 last_accuracy : 0.71135 	 second best val : 0.73360 	 second best test : 0.71259

std :  	 val_accuracy : 0.00596 	 test_accuracy : 0.00198 	 last_accuracy : 0.00247 	 second best val : 0.00596 	 second best test : 0.00198


date and time :  Wed Jun 16 05:00:13 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=15, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=5, num_mlp_layers=1, random_vec=False, seed=196, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 2604, 0: 2534, 2: 2262})

Epoch :  1 loss training:  222.10031497478485 Time :  58
accuracy train: 0.569026 val: 0.552684 test: 0.556765
max validation accuracy : 0.552684 max acc epoch : 1 test accuracy : 0.556765
Counter({0: 3576, 1: 2444, 2: 1380})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  163.3481655716896 Time :  135
accuracy train: 0.683602 val: 0.602386 test: 0.630720
max validation accuracy : 0.602386 max acc epoch : 2 test accuracy : 0.630720
Counter({0: 3405, 2: 2640, 1: 1355})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  134.72226306796074 Time :  207
accuracy train: 0.734057 val: 0.667992 test: 0.652980
max validation accuracy : 0.667992 max acc epoch : 3 test accuracy : 0.652980
Counter({0: 3232, 1: 2779, 2: 1389})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  104.91072690486908 Time :  277
accuracy train: 0.767344 val: 0.669980 test: 0.669305
max validation accuracy : 0.669980 max acc epoch : 4 test accuracy : 0.669305
Counter({2: 3181, 1: 2786, 0: 1433})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  93.72701728343964 Time :  353
accuracy train: 0.803784 val: 0.687873 test: 0.692060
max validation accuracy : 0.687873 max acc epoch : 5 test accuracy : 0.692060
Counter({0: 3254, 2: 2598, 1: 1548})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  87.96022453904152 Time :  432
accuracy train: 0.812544 val: 0.685885 test: 0.689587
max validation accuracy : 0.687873 max acc epoch : 5 test accuracy : 0.692060
Counter({2: 3127, 1: 2732, 0: 1541})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  72.60321797430515 Time :  487
accuracy train: 0.843027 val: 0.709742 test: 0.696512
max validation accuracy : 0.709742 max acc epoch : 7 test accuracy : 0.696512
Counter({2: 3097, 1: 2767, 0: 1536})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  71.67833480238914 Time :  547
accuracy train: 0.859495 val: 0.669980 test: 0.692555
max validation accuracy : 0.709742 max acc epoch : 7 test accuracy : 0.696512
Counter({2: 3060, 0: 2807, 1: 1533})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.9798346310854 Time :  608
accuracy train: 0.873511 val: 0.679920 test: 0.699233
max validation accuracy : 0.709742 max acc epoch : 7 test accuracy : 0.696512
Counter({1: 2957, 2: 2924, 0: 1519})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.00467795133591 Time :  661
accuracy train: 0.889979 val: 0.701789 test: 0.698739
max validation accuracy : 0.709742 max acc epoch : 7 test accuracy : 0.696512
Counter({1: 2992, 0: 2881, 2: 1527})

Epoch :  11 loss training:  56.83803267776966 Time :  711
accuracy train: 0.893833 val: 0.689861 test: 0.704675
max validation accuracy : 0.709742 max acc epoch : 7 test accuracy : 0.696512
Counter({2: 3024, 0: 2852, 1: 1524})

Epoch :  12 loss training:  54.98594373464584 Time :  770
accuracy train: 0.907148 val: 0.689861 test: 0.699728
max validation accuracy : 0.709742 max acc epoch : 7 test accuracy : 0.696512
Counter({0: 3014, 2: 2851, 1: 1535})

Epoch :  13 loss training:  50.00624157488346 Time :  836
accuracy train: 0.914856 val: 0.691849 test: 0.703685
max validation accuracy : 0.709742 max acc epoch : 7 test accuracy : 0.696512
Counter({2: 3041, 0: 2820, 1: 1539})

Epoch :  14 loss training:  49.00685791671276 Time :  908
accuracy train: 0.918711 val: 0.679920 test: 0.704675
max validation accuracy : 0.709742 max acc epoch : 7 test accuracy : 0.696512
Counter({2: 3002, 1: 2856, 0: 1542})

Epoch :  15 loss training:  43.95021753013134 Time :  975
accuracy train: 0.921514 val: 0.699801 test: 0.705417
max validation accuracy : 0.709742 max acc epoch : 7 test accuracy : 0.696512
Counter({0: 2988, 1: 2873, 2: 1539})

Epoch :  16 loss training:  42.39939095079899 Time :  1037
accuracy train: 0.937281 val: 0.691849 test: 0.705911
max validation accuracy : 0.709742 max acc epoch : 7 test accuracy : 0.696512
Counter({1: 2987, 2: 2879, 0: 1534})

Epoch :  17 loss training:  38.36445038020611 Time :  1096
accuracy train: 0.940084 val: 0.701789 test: 0.710364
max validation accuracy : 0.709742 max acc epoch : 7 test accuracy : 0.696512
Counter({2: 2980, 1: 2887, 0: 1533})

Epoch :  18 loss training:  36.20416263118386 Time :  1156
accuracy train: 0.951647 val: 0.697813 test: 0.707890
max validation accuracy : 0.709742 max acc epoch : 7 test accuracy : 0.696512
Counter({2: 2975, 1: 2895, 0: 1530})

Epoch :  19 loss training:  34.84417533129454 Time :  1203
accuracy train: 0.953399 val: 0.687873 test: 0.711106
max validation accuracy : 0.709742 max acc epoch : 7 test accuracy : 0.696512
Counter({1: 2969, 2: 2908, 0: 1523})

Epoch :  20 loss training:  31.60385325551033 Time :  1259
accuracy train: 0.969516 val: 0.685885 test: 0.709622
max validation accuracy : 0.709742 max acc epoch : 7 test accuracy : 0.696512
Counter({0: 2974, 1: 2903, 2: 1523})

Epoch :  21 loss training:  29.368664290755987 Time :  1313
accuracy train: 0.973371 val: 0.689861 test: 0.710858
max validation accuracy : 0.709742 max acc epoch : 7 test accuracy : 0.696512
Counter({0: 2969, 1: 2910, 2: 1521})

Epoch :  22 loss training:  29.451515309512615 Time :  1384
accuracy train: 0.973721 val: 0.703777 test: 0.709869
max validation accuracy : 0.709742 max acc epoch : 7 test accuracy : 0.696512
Counter({2: 2960, 0: 2914, 1: 1526})

Epoch :  23 loss training:  27.387910321354866 Time :  1457
accuracy train: 0.977926 val: 0.693837 test: 0.709622
max validation accuracy : 0.709742 max acc epoch : 7 test accuracy : 0.696512
Counter({2: 2957, 1: 2909, 0: 1534})

========================================================================================================================================================================================================
best acc epoch :  7
validation accuracy :  0.709741550695825
test accuracy :  0.6965124907247093
last test_accuracy :  0.7096215681424685
second best val :  0.7037773359840954
second best test :  0.6965124907247093
max gap 2
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=15, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=5, num_mlp_layers=1, random_vec=False, seed=908, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({0: 2587, 1: 2546, 2: 2267})

Epoch :  1 loss training:  225.77279710769653 Time :  1602
accuracy train: 0.591451 val: 0.588469 test: 0.556023
max validation accuracy : 0.588469 max acc epoch : 1 test accuracy : 0.556023
Counter({0: 4108, 2: 1897, 1: 1395})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  158.6944300532341 Time :  1655
accuracy train: 0.675893 val: 0.638171 test: 0.616127
max validation accuracy : 0.638171 max acc epoch : 2 test accuracy : 0.616127
Counter({1: 3572, 0: 2038, 2: 1790})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  136.57124748826027 Time :  1714
accuracy train: 0.733357 val: 0.662028 test: 0.640119
max validation accuracy : 0.662028 max acc epoch : 3 test accuracy : 0.640119
Counter({1: 3613, 2: 2004, 0: 1783})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  104.42105361819267 Time :  1778
accuracy train: 0.785214 val: 0.705765 test: 0.679693
max validation accuracy : 0.705765 max acc epoch : 4 test accuracy : 0.679693
Counter({2: 4235, 0: 1794, 1: 1371})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  93.74998614192009 Time :  1843
accuracy train: 0.820603 val: 0.713718 test: 0.689340
max validation accuracy : 0.713718 max acc epoch : 5 test accuracy : 0.689340
Counter({1: 3521, 0: 2067, 2: 1812})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  88.49766165018082 Time :  1899
accuracy train: 0.825158 val: 0.709742 test: 0.694039
max validation accuracy : 0.713718 max acc epoch : 5 test accuracy : 0.689340
Counter({2: 3456, 0: 2117, 1: 1827})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  75.91087427735329 Time :  1960
accuracy train: 0.850736 val: 0.691849 test: 0.694534
max validation accuracy : 0.713718 max acc epoch : 5 test accuracy : 0.689340
Counter({2: 3470, 1: 2097, 0: 1833})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  70.2895073890686 Time :  2030
accuracy train: 0.867905 val: 0.717694 test: 0.700717
max validation accuracy : 0.717694 max acc epoch : 8 test accuracy : 0.700717
Counter({2: 4237, 0: 1775, 1: 1388})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.84395670890808 Time :  2100
accuracy train: 0.867905 val: 0.697813 test: 0.699233
max validation accuracy : 0.717694 max acc epoch : 8 test accuracy : 0.700717
Counter({0: 3524, 2: 2085, 1: 1791})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  58.80087198317051 Time :  2171
accuracy train: 0.878767 val: 0.727634 test: 0.699481
max validation accuracy : 0.727634 max acc epoch : 10 test accuracy : 0.699481
Counter({0: 3520, 2: 2087, 1: 1793})

Epoch :  11 loss training:  57.05575221776962 Time :  2239
accuracy train: 0.896636 val: 0.715706 test: 0.708138
max validation accuracy : 0.727634 max acc epoch : 10 test accuracy : 0.699481
Counter({1: 3522, 0: 2083, 2: 1795})

Epoch :  12 loss training:  53.21117512881756 Time :  2291
accuracy train: 0.906447 val: 0.709742 test: 0.713332
max validation accuracy : 0.727634 max acc epoch : 10 test accuracy : 0.699481
Counter({1: 3526, 2: 2084, 0: 1790})

Epoch :  13 loss training:  48.513003535568714 Time :  2349
accuracy train: 0.919411 val: 0.729622 test: 0.711106
max validation accuracy : 0.729622 max acc epoch : 13 test accuracy : 0.711106
Counter({0: 3476, 1: 2130, 2: 1794})

Epoch :  14 loss training:  46.27919164299965 Time :  2417
accuracy train: 0.922915 val: 0.709742 test: 0.709869
max validation accuracy : 0.729622 max acc epoch : 13 test accuracy : 0.711106
Counter({1: 3485, 2: 2115, 0: 1800})

Epoch :  15 loss training:  44.48988298326731 Time :  2487
accuracy train: 0.925018 val: 0.717694 test: 0.710364
max validation accuracy : 0.729622 max acc epoch : 13 test accuracy : 0.711106
Counter({2: 3477, 1: 2118, 0: 1805})

Epoch :  16 loss training:  41.83481737226248 Time :  2556
accuracy train: 0.938683 val: 0.719682 test: 0.715558
max validation accuracy : 0.729622 max acc epoch : 13 test accuracy : 0.711106
Counter({1: 3457, 2: 2146, 0: 1797})

Epoch :  17 loss training:  39.69945438206196 Time :  2614
accuracy train: 0.943938 val: 0.717694 test: 0.708632
max validation accuracy : 0.729622 max acc epoch : 13 test accuracy : 0.711106
Counter({2: 3439, 0: 2161, 1: 1800})

Epoch :  18 loss training:  36.33887376636267 Time :  2683
accuracy train: 0.953048 val: 0.723658 test: 0.713332
max validation accuracy : 0.729622 max acc epoch : 13 test accuracy : 0.711106
Counter({1: 3434, 0: 2167, 2: 1799})

Epoch :  19 loss training:  34.57864210009575 Time :  2746
accuracy train: 0.962158 val: 0.713718 test: 0.709869
max validation accuracy : 0.729622 max acc epoch : 13 test accuracy : 0.711106
Counter({2: 3436, 1: 2169, 0: 1795})

Epoch :  20 loss training:  32.34495049715042 Time :  2819
accuracy train: 0.968816 val: 0.735586 test: 0.708880
max validation accuracy : 0.735586 max acc epoch : 20 test accuracy : 0.708880
Counter({0: 3432, 1: 2176, 2: 1792})

Epoch :  21 loss training:  30.430959925055504 Time :  2881
accuracy train: 0.964611 val: 0.727634 test: 0.711353
max validation accuracy : 0.735586 max acc epoch : 20 test accuracy : 0.708880
Counter({1: 3432, 2: 2178, 0: 1790})

Epoch :  22 loss training:  28.48672877252102 Time :  2949
accuracy train: 0.969516 val: 0.731610 test: 0.713579
max validation accuracy : 0.735586 max acc epoch : 20 test accuracy : 0.708880
Counter({1: 3434, 0: 2176, 2: 1790})

Epoch :  23 loss training:  26.77398421242833 Time :  3013
accuracy train: 0.975823 val: 0.727634 test: 0.712342
max validation accuracy : 0.735586 max acc epoch : 20 test accuracy : 0.708880
Counter({1: 3423, 2: 2180, 0: 1797})

Epoch :  24 loss training:  24.531628608703613 Time :  3080
accuracy train: 0.980028 val: 0.727634 test: 0.713084
max validation accuracy : 0.735586 max acc epoch : 20 test accuracy : 0.708880
Counter({1: 3430, 0: 2168, 2: 1802})

Epoch :  25 loss training:  22.55886936187744 Time :  3147
accuracy train: 0.985284 val: 0.727634 test: 0.713332
max validation accuracy : 0.735586 max acc epoch : 20 test accuracy : 0.708880
Counter({0: 3421, 1: 2182, 2: 1797})

Epoch :  26 loss training:  20.240738041698933 Time :  3197
accuracy train: 0.990540 val: 0.725646 test: 0.716794
max validation accuracy : 0.735586 max acc epoch : 20 test accuracy : 0.708880
Counter({0: 3422, 1: 2181, 2: 1797})

Epoch :  27 loss training:  19.628355238586664 Time :  3253
accuracy train: 0.989488 val: 0.729622 test: 0.711106
max validation accuracy : 0.735586 max acc epoch : 20 test accuracy : 0.708880
Counter({1: 3431, 2: 2162, 0: 1807})

Epoch :  28 loss training:  19.369100481271744 Time :  3312
accuracy train: 0.992292 val: 0.733598 test: 0.710611
max validation accuracy : 0.735586 max acc epoch : 20 test accuracy : 0.708880
Counter({1: 3423, 0: 2171, 2: 1806})

Epoch :  29 loss training:  17.760377882048488 Time :  3378
accuracy train: 0.990890 val: 0.727634 test: 0.705911
max validation accuracy : 0.735586 max acc epoch : 20 test accuracy : 0.708880
Counter({1: 3438, 2: 2172, 0: 1790})

Epoch :  30 loss training:  14.94814376346767 Time :  3450
accuracy train: 0.992642 val: 0.731610 test: 0.713826
max validation accuracy : 0.735586 max acc epoch : 20 test accuracy : 0.708880
Counter({0: 3433, 1: 2180, 2: 1787})

Epoch :  31 loss training:  13.87218175129965 Time :  3514
accuracy train: 0.995095 val: 0.719682 test: 0.707395
max validation accuracy : 0.735586 max acc epoch : 20 test accuracy : 0.708880
Counter({1: 3423, 2: 2194, 0: 1783})

Epoch :  32 loss training:  13.627056350931525 Time :  3577
accuracy train: 0.995095 val: 0.725646 test: 0.706159
max validation accuracy : 0.735586 max acc epoch : 20 test accuracy : 0.708880
Counter({2: 3409, 1: 2208, 0: 1783})

Epoch :  33 loss training:  12.837344342842698 Time :  3632
accuracy train: 0.996496 val: 0.721670 test: 0.710364
max validation accuracy : 0.735586 max acc epoch : 20 test accuracy : 0.708880
Counter({0: 3408, 2: 2203, 1: 1789})

Epoch :  34 loss training:  11.540780993178487 Time :  3673
accuracy train: 0.998598 val: 0.741551 test: 0.708138
max validation accuracy : 0.741551 max acc epoch : 34 test accuracy : 0.708138
Counter({0: 3402, 2: 2224, 1: 1774})

Epoch :  35 loss training:  10.241799420677125 Time :  3720
accuracy train: 0.996146 val: 0.719682 test: 0.708880
max validation accuracy : 0.741551 max acc epoch : 34 test accuracy : 0.708138
Counter({1: 3405, 2: 2209, 0: 1786})

Epoch :  36 loss training:  10.981989288702607 Time :  3772
accuracy train: 0.997547 val: 0.725646 test: 0.706159
max validation accuracy : 0.741551 max acc epoch : 34 test accuracy : 0.708138
Counter({1: 3420, 0: 2194, 2: 1786})

Epoch :  37 loss training:  8.374231053050607 Time :  3825
accuracy train: 0.998949 val: 0.723658 test: 0.711353
max validation accuracy : 0.741551 max acc epoch : 34 test accuracy : 0.708138
Counter({1: 3421, 0: 2195, 2: 1784})

Epoch :  38 loss training:  8.62622938863933 Time :  3881
accuracy train: 0.998949 val: 0.741551 test: 0.704427
max validation accuracy : 0.741551 max acc epoch : 34 test accuracy : 0.708138
Counter({2: 3401, 1: 2215, 0: 1784})

Epoch :  39 loss training:  8.511718668974936 Time :  3929
accuracy train: 0.998949 val: 0.727634 test: 0.705169
max validation accuracy : 0.741551 max acc epoch : 34 test accuracy : 0.708138
Counter({0: 3398, 2: 2212, 1: 1790})

Epoch :  40 loss training:  8.546580700203776 Time :  3970
accuracy train: 0.999650 val: 0.727634 test: 0.701459
max validation accuracy : 0.741551 max acc epoch : 34 test accuracy : 0.708138
Counter({0: 3377, 1: 2227, 2: 1796})

Epoch :  41 loss training:  7.741623275447637 Time :  4011
accuracy train: 0.998598 val: 0.725646 test: 0.709127
max validation accuracy : 0.741551 max acc epoch : 34 test accuracy : 0.708138
Counter({2: 3401, 1: 2204, 0: 1795})

Epoch :  42 loss training:  6.803494996391237 Time :  4065
accuracy train: 1.000000 val: 0.735586 test: 0.707890
max validation accuracy : 0.741551 max acc epoch : 34 test accuracy : 0.708138
Counter({1: 3392, 0: 2213, 2: 1795})

Epoch :  43 loss training:  7.165300347842276 Time :  4117
accuracy train: 0.999299 val: 0.731610 test: 0.707395
max validation accuracy : 0.741551 max acc epoch : 34 test accuracy : 0.708138
Counter({2: 3415, 1: 2190, 0: 1795})

Epoch :  44 loss training:  7.635157250100747 Time :  4160
accuracy train: 0.999299 val: 0.721670 test: 0.699481
max validation accuracy : 0.741551 max acc epoch : 34 test accuracy : 0.708138
Counter({1: 3402, 2: 2192, 0: 1806})

Epoch :  45 loss training:  6.799331511836499 Time :  4204
accuracy train: 0.999299 val: 0.727634 test: 0.710611
max validation accuracy : 0.741551 max acc epoch : 34 test accuracy : 0.708138
Counter({1: 3399, 2: 2208, 0: 1793})

Epoch :  46 loss training:  5.877918839454651 Time :  4257
accuracy train: 0.999299 val: 0.729622 test: 0.708632
max validation accuracy : 0.741551 max acc epoch : 34 test accuracy : 0.708138
Counter({1: 3394, 0: 2223, 2: 1783})

Epoch :  47 loss training:  5.521350961411372 Time :  4315
accuracy train: 0.999299 val: 0.723658 test: 0.707643
max validation accuracy : 0.741551 max acc epoch : 34 test accuracy : 0.708138
Counter({2: 3391, 1: 2222, 0: 1787})

Epoch :  48 loss training:  7.018429201445542 Time :  4365
accuracy train: 0.999650 val: 0.723658 test: 0.707395
max validation accuracy : 0.741551 max acc epoch : 34 test accuracy : 0.708138
Counter({0: 3386, 1: 2225, 2: 1789})

Epoch :  49 loss training:  4.848137051798403 Time :  4409
accuracy train: 0.999299 val: 0.719682 test: 0.709869
max validation accuracy : 0.741551 max acc epoch : 34 test accuracy : 0.708138
Counter({1: 3399, 2: 2215, 0: 1786})

Epoch :  50 loss training:  5.395533158443868 Time :  4460
accuracy train: 0.998598 val: 0.731610 test: 0.712095
max validation accuracy : 0.741551 max acc epoch : 34 test accuracy : 0.708138
Counter({1: 3409, 0: 2211, 2: 1780})

========================================================================================================================================================================================================
best acc epoch :  34
validation accuracy :  0.7415506958250497
test accuracy :  0.7081375216423448
last test_accuracy :  0.7120949789760079
second best val :  0.73558648111332
second best test :  0.7088795448924067
max gap 14
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  7 	 val_accuracy : 0.70974 	 test_accuracy : 0.69651 	 last test_accuracy : 0.70962 	 second best val : 0.70378 	 second best test : 0.69651
k :  1 	 best_acc epoch :  34 	 val_accuracy : 0.74155 	 test_accuracy : 0.70814 	 last test_accuracy : 0.71209 	 second best val : 0.73559 	 second best test : 0.70888

avg :  	 val_accuracy : 0.72565 	 test_accuracy : 0.70233 	 last_accuracy : 0.71086 	 second best val : 0.71968 	 second best test : 0.70270

std :  	 val_accuracy : 0.01590 	 test_accuracy : 0.00581 	 last_accuracy : 0.00124 	 second best val : 0.01590 	 second best test : 0.00618
