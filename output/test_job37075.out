

date and time :  Thu Jun 10 20:49:22 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=535, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4721, 0: 2970})

Epoch :  1 loss training:  38.35212746448815 Time :  20
accuracy train: 0.962432 val: 0.938182 test: 0.962100
max validation accuracy : 0.938182 max acc epoch : 1 test accuracy : 0.962100
Counter({1: 3962, 0: 3729})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.31672819983214 Time :  40
accuracy train: 0.974955 val: 0.958182 test: 0.970320
max validation accuracy : 0.958182 max acc epoch : 2 test accuracy : 0.970320
Counter({0: 3949, 1: 3742})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.61521048960276 Time :  58
accuracy train: 0.972935 val: 0.956364 test: 0.964840
max validation accuracy : 0.958182 max acc epoch : 2 test accuracy : 0.970320
Counter({0: 3919, 1: 3772})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.89746674336493 Time :  79
accuracy train: 0.985659 val: 0.969091 test: 0.969406
max validation accuracy : 0.969091 max acc epoch : 4 test accuracy : 0.969406
Counter({1: 3903, 0: 3788})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.076530534191988 Time :  104
accuracy train: 0.988285 val: 0.970909 test: 0.964840
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.964840
Counter({0: 3898, 1: 3793})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  7.983322035288438 Time :  123
accuracy train: 0.984852 val: 0.961818 test: 0.969406
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.964840
Counter({0: 3910, 1: 3781})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.685447362018749 Time :  141
accuracy train: 0.989699 val: 0.969091 test: 0.978082
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.964840
Counter({1: 3906, 0: 3785})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.961717062513344 Time :  158
accuracy train: 0.991315 val: 0.974545 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971689
Counter({1: 3903, 0: 3788})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.668353947345167 Time :  183
accuracy train: 0.990305 val: 0.970909 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971689
Counter({1: 3900, 0: 3791})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  4.937092134729028 Time :  211
accuracy train: 0.991113 val: 0.970909 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971689
Counter({1: 3897, 0: 3794})

Epoch :  11 loss training:  4.915852923993953 Time :  234
accuracy train: 0.991719 val: 0.969091 test: 0.974886
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971689
Counter({1: 3894, 0: 3797})

Epoch :  12 loss training:  4.787190814153291 Time :  253
accuracy train: 0.993335 val: 0.970909 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971689
Counter({1: 3891, 0: 3800})

Epoch :  13 loss training:  4.227015363052487 Time :  271
accuracy train: 0.993739 val: 0.970909 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971689
Counter({0: 3887, 1: 3804})

Epoch :  14 loss training:  3.752224130133982 Time :  296
accuracy train: 0.995152 val: 0.974545 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.971689
Counter({0: 3880, 1: 3811})

Epoch :  15 loss training:  3.4852745626412798 Time :  317
accuracy train: 0.995960 val: 0.978182 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3871, 1: 3820})

Epoch :  16 loss training:  3.423707993933931 Time :  333
accuracy train: 0.994143 val: 0.974545 test: 0.977626
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({1: 3864, 0: 3827})

Epoch :  17 loss training:  3.4017580005311174 Time :  356
accuracy train: 0.995556 val: 0.961818 test: 0.975799
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({1: 3862, 0: 3829})

Epoch :  18 loss training:  3.388119352166541 Time :  375
accuracy train: 0.995960 val: 0.974545 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({1: 3846, 0: 3845})

Epoch :  19 loss training:  2.9679902471543755 Time :  393
accuracy train: 0.995758 val: 0.970909 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({1: 3846, 0: 3845})

Epoch :  20 loss training:  2.7230478337733075 Time :  419
accuracy train: 0.995960 val: 0.969091 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({1: 3848, 0: 3843})

Epoch :  21 loss training:  2.6411653575487435 Time :  442
accuracy train: 0.996162 val: 0.969091 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3855, 1: 3836})

Epoch :  22 loss training:  2.8161508802731987 Time :  462
accuracy train: 0.996162 val: 0.974545 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({1: 3866, 0: 3825})

Epoch :  23 loss training:  2.6577212340489496 Time :  479
accuracy train: 0.995960 val: 0.970909 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({1: 3872, 0: 3819})

Epoch :  24 loss training:  2.243742059217766 Time :  512
accuracy train: 0.996768 val: 0.976364 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({1: 3877, 0: 3814})

Epoch :  25 loss training:  2.1241792356595397 Time :  533
accuracy train: 0.996364 val: 0.963636 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({1: 3877, 0: 3814})

Epoch :  26 loss training:  2.2116949033079436 Time :  551
accuracy train: 0.996162 val: 0.974545 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({1: 3880, 0: 3811})

Epoch :  27 loss training:  2.0787217125471216 Time :  571
accuracy train: 0.996566 val: 0.954545 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({1: 3880, 0: 3811})

Epoch :  28 loss training:  2.011033548595151 Time :  595
accuracy train: 0.996970 val: 0.967273 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({1: 3880, 0: 3811})

Epoch :  29 loss training:  1.8007994146755664 Time :  615
accuracy train: 0.996364 val: 0.969091 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({1: 3887, 0: 3804})

Epoch :  30 loss training:  2.049799580461695 Time :  634
accuracy train: 0.996768 val: 0.969091 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3888, 1: 3803})

Epoch :  31 loss training:  1.7204814200740657 Time :  653
accuracy train: 0.996768 val: 0.969091 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3888, 1: 3803})

Epoch :  32 loss training:  1.7777722914615879 Time :  679
accuracy train: 0.996364 val: 0.972727 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3890, 1: 3801})

Epoch :  33 loss training:  1.6242719440415385 Time :  701
accuracy train: 0.996970 val: 0.969091 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3889, 1: 3802})

Epoch :  34 loss training:  1.721943757707777 Time :  720
accuracy train: 0.996566 val: 0.972727 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3895, 1: 3796})

Epoch :  35 loss training:  1.5918092412830447 Time :  738
accuracy train: 0.996970 val: 0.965455 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({1: 3895, 0: 3796})

Epoch :  36 loss training:  1.5806745584341115 Time :  758
accuracy train: 0.997172 val: 0.969091 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3896, 1: 3795})

Epoch :  37 loss training:  2.1406708859212813 Time :  784
accuracy train: 0.996970 val: 0.969091 test: 0.975799
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({1: 3900, 0: 3791})

Epoch :  38 loss training:  1.5465183638443705 Time :  803
accuracy train: 0.996970 val: 0.969091 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3900, 1: 3791})

Epoch :  39 loss training:  1.8955426963293576 Time :  821
accuracy train: 0.996768 val: 0.961818 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({1: 3900, 0: 3791})

Epoch :  40 loss training:  2.059870877288631 Time :  846
accuracy train: 0.996162 val: 0.956364 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3900, 1: 3791})

Epoch :  41 loss training:  1.6872208515451348 Time :  869
accuracy train: 0.995960 val: 0.956364 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({1: 3900, 0: 3791})

Epoch :  42 loss training:  1.564600041754602 Time :  890
accuracy train: 0.996566 val: 0.963636 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({1: 3900, 0: 3791})

Epoch :  43 loss training:  1.4535759839309321 Time :  910
accuracy train: 0.996768 val: 0.958182 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3899, 1: 3792})

Epoch :  44 loss training:  1.3348841725819511 Time :  930
accuracy train: 0.997172 val: 0.960000 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({1: 3899, 0: 3792})

Epoch :  45 loss training:  1.2192483130347682 Time :  956
accuracy train: 0.997172 val: 0.958182 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3899, 1: 3792})

Epoch :  46 loss training:  1.342368244069803 Time :  978
accuracy train: 0.996364 val: 0.958182 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3900, 1: 3791})

========================================================================================================================================================================================================
max acc epoch :  15
max validation accuracy :  0.9781818181818182
test accuracy :  0.9748858447488584
last test_accuracy :  0.9748858447488584
max gap 7
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=535, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4721, 0: 2970})

Epoch :  1 loss training:  38.29166421294212 Time :  1002
accuracy train: 0.961422 val: 0.938182 test: 0.961187
max validation accuracy : 0.938182 max acc epoch : 1 test accuracy : 0.961187
Counter({0: 3970, 1: 3721})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.290138814598322 Time :  1019
accuracy train: 0.975359 val: 0.960000 test: 0.970320
max validation accuracy : 0.960000 max acc epoch : 2 test accuracy : 0.970320
Counter({0: 3952, 1: 3739})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.313862363342196 Time :  1043
accuracy train: 0.975157 val: 0.958182 test: 0.962557
max validation accuracy : 0.960000 max acc epoch : 2 test accuracy : 0.970320
Counter({0: 3924, 1: 3767})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.8745239416603 Time :  1062
accuracy train: 0.986063 val: 0.967273 test: 0.968950
max validation accuracy : 0.967273 max acc epoch : 4 test accuracy : 0.968950
Counter({1: 3910, 0: 3781})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.32850742537994 Time :  1080
accuracy train: 0.988083 val: 0.969091 test: 0.968037
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.968037
Counter({1: 3915, 0: 3776})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.221755408449098 Time :  1103
accuracy train: 0.981418 val: 0.949091 test: 0.963927
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.968037
Counter({0: 3933, 1: 3758})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.722177735297009 Time :  1123
accuracy train: 0.989901 val: 0.969091 test: 0.974429
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.968037
Counter({0: 3926, 1: 3765})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.034750162390992 Time :  1141
accuracy train: 0.991921 val: 0.974545 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.970320
Counter({0: 3908, 1: 3783})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.582520661497256 Time :  1159
accuracy train: 0.989901 val: 0.969091 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.970320
Counter({0: 3903, 1: 3788})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.019180859671906 Time :  1187
accuracy train: 0.991113 val: 0.972727 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.970320
Counter({0: 3900, 1: 3791})

Epoch :  11 loss training:  5.087625191546977 Time :  1210
accuracy train: 0.992931 val: 0.969091 test: 0.974429
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.970320
Counter({1: 3897, 0: 3794})

Epoch :  12 loss training:  4.941121852956712 Time :  1234
accuracy train: 0.993537 val: 0.969091 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.970320
Counter({1: 3891, 0: 3800})

Epoch :  13 loss training:  4.27483919961378 Time :  1256
accuracy train: 0.993739 val: 0.972727 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.970320
Counter({0: 3887, 1: 3804})

Epoch :  14 loss training:  3.8812396491121035 Time :  1280
accuracy train: 0.994951 val: 0.972727 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.970320
Counter({0: 3881, 1: 3810})

Epoch :  15 loss training:  3.624961723922752 Time :  1298
accuracy train: 0.995556 val: 0.978182 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3870, 1: 3821})

Epoch :  16 loss training:  3.4985684716375545 Time :  1322
accuracy train: 0.994749 val: 0.976364 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3866, 0: 3825})

Epoch :  17 loss training:  3.5026822234794963 Time :  1345
accuracy train: 0.995758 val: 0.967273 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3866, 0: 3825})

Epoch :  18 loss training:  3.409659225551877 Time :  1363
accuracy train: 0.995556 val: 0.974545 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3856, 1: 3835})

Epoch :  19 loss training:  3.028143839153927 Time :  1384
accuracy train: 0.995758 val: 0.970909 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3856, 1: 3835})

Epoch :  20 loss training:  2.711155401339056 Time :  1408
accuracy train: 0.995758 val: 0.970909 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3848, 1: 3843})

Epoch :  21 loss training:  2.653390444756951 Time :  1430
accuracy train: 0.996162 val: 0.969091 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3856, 1: 3835})

Epoch :  22 loss training:  2.807938843383454 Time :  1451
accuracy train: 0.996162 val: 0.972727 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3868, 0: 3823})

Epoch :  23 loss training:  2.663451585191069 Time :  1470
accuracy train: 0.996364 val: 0.970909 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3876, 0: 3815})

Epoch :  24 loss training:  2.1932729894760996 Time :  1491
accuracy train: 0.996970 val: 0.976364 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3881, 0: 3810})

Epoch :  25 loss training:  2.0364199918549275 Time :  1518
accuracy train: 0.996566 val: 0.963636 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3881, 1: 3810})

Epoch :  26 loss training:  2.2735934049269417 Time :  1541
accuracy train: 0.995758 val: 0.972727 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3883, 0: 3808})

Epoch :  27 loss training:  2.0306862420984544 Time :  1560
accuracy train: 0.996364 val: 0.956364 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3883, 0: 3808})

Epoch :  28 loss training:  2.062765019480139 Time :  1578
accuracy train: 0.996768 val: 0.967273 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3884, 1: 3807})

Epoch :  29 loss training:  1.6203698471654207 Time :  1601
accuracy train: 0.996768 val: 0.970909 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3890, 1: 3801})

Epoch :  30 loss training:  2.030645903025288 Time :  1629
accuracy train: 0.996768 val: 0.969091 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3890, 1: 3801})

Epoch :  31 loss training:  1.678875765959674 Time :  1649
accuracy train: 0.996768 val: 0.970909 test: 0.966667
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3890, 1: 3801})

Epoch :  32 loss training:  1.7057370102556888 Time :  1667
accuracy train: 0.996162 val: 0.970909 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3896, 1: 3795})

Epoch :  33 loss training:  1.6286100615106989 Time :  1688
accuracy train: 0.996768 val: 0.967273 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3896, 1: 3795})

Epoch :  34 loss training:  1.6989764769896283 Time :  1712
accuracy train: 0.996364 val: 0.969091 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3898, 0: 3793})

Epoch :  35 loss training:  1.6927159365513944 Time :  1734
accuracy train: 0.996970 val: 0.965455 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3898, 0: 3793})

Epoch :  36 loss training:  1.5114599953303696 Time :  1754
accuracy train: 0.996768 val: 0.967273 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3898, 0: 3793})

Epoch :  37 loss training:  2.117650683707325 Time :  1775
accuracy train: 0.996970 val: 0.965455 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3901, 0: 3790})

Epoch :  38 loss training:  1.5207425483313273 Time :  1798
accuracy train: 0.996768 val: 0.963636 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3901, 1: 3790})

Epoch :  39 loss training:  1.5618516310896666 Time :  1821
accuracy train: 0.996768 val: 0.961818 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3903, 0: 3788})

Epoch :  40 loss training:  1.4234563093305042 Time :  1839
accuracy train: 0.996162 val: 0.965455 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3903, 1: 3788})

Epoch :  41 loss training:  1.479336363299808 Time :  1861
accuracy train: 0.996162 val: 0.956364 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3903, 1: 3788})

Epoch :  42 loss training:  1.5356379235890927 Time :  1884
accuracy train: 0.996566 val: 0.961818 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3903, 0: 3788})

Epoch :  43 loss training:  1.4585251403223083 Time :  1905
accuracy train: 0.996566 val: 0.956364 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3902, 1: 3789})

Epoch :  44 loss training:  1.348807575093815 Time :  1925
accuracy train: 0.996970 val: 0.961818 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3902, 0: 3789})

Epoch :  45 loss training:  1.2361822422099067 Time :  1945
accuracy train: 0.996970 val: 0.960000 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3902, 0: 3789})

Epoch :  46 loss training:  1.3284784617644618 Time :  1969
accuracy train: 0.996768 val: 0.958182 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3902, 1: 3789})

========================================================================================================================================================================================================
max acc epoch :  15
max validation accuracy :  0.9781818181818182
test accuracy :  0.9712328767123287
last test_accuracy :  0.9735159817351599
max gap 7
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=535, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4721, 0: 2970})

Epoch :  1 loss training:  38.368998097255826 Time :  2000
accuracy train: 0.962432 val: 0.936364 test: 0.960274
max validation accuracy : 0.936364 max acc epoch : 1 test accuracy : 0.960274
Counter({1: 3960, 0: 3731})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.433433855883777 Time :  2026
accuracy train: 0.974551 val: 0.960000 test: 0.969863
max validation accuracy : 0.960000 max acc epoch : 2 test accuracy : 0.969863
Counter({0: 3952, 1: 3739})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.246694065630436 Time :  2047
accuracy train: 0.973743 val: 0.954545 test: 0.966210
max validation accuracy : 0.960000 max acc epoch : 2 test accuracy : 0.969863
Counter({0: 3920, 1: 3771})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.737477781251073 Time :  2067
accuracy train: 0.986467 val: 0.967273 test: 0.968037
max validation accuracy : 0.967273 max acc epoch : 4 test accuracy : 0.968037
Counter({1: 3908, 0: 3783})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.194280970026739 Time :  2086
accuracy train: 0.988083 val: 0.976364 test: 0.966667
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.966667
Counter({1: 3904, 0: 3787})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.049802991328761 Time :  2107
accuracy train: 0.982024 val: 0.950909 test: 0.964840
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.966667
Counter({0: 3919, 1: 3772})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.600445215124637 Time :  2130
accuracy train: 0.989901 val: 0.969091 test: 0.974886
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.966667
Counter({0: 3912, 1: 3779})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.9842733518453315 Time :  2148
accuracy train: 0.991921 val: 0.972727 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.966667
Counter({1: 3904, 0: 3787})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.595841147005558 Time :  2167
accuracy train: 0.990305 val: 0.965455 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.966667
Counter({1: 3898, 0: 3793})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  4.828422457445413 Time :  2190
accuracy train: 0.991315 val: 0.969091 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.966667
Counter({1: 3895, 0: 3796})

Epoch :  11 loss training:  5.015341006219387 Time :  2212
accuracy train: 0.993537 val: 0.969091 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.966667
Counter({1: 3892, 0: 3799})

Epoch :  12 loss training:  4.895121939363889 Time :  2233
accuracy train: 0.993739 val: 0.965455 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.966667
Counter({1: 3884, 0: 3807})

Epoch :  13 loss training:  4.320364085433539 Time :  2251
accuracy train: 0.993739 val: 0.970909 test: 0.968950
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.966667
Counter({0: 3880, 1: 3811})

Epoch :  14 loss training:  3.9569591473264154 Time :  2274
accuracy train: 0.994749 val: 0.972727 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.966667
Counter({0: 3873, 1: 3818})

Epoch :  15 loss training:  3.570590504037682 Time :  2294
accuracy train: 0.995354 val: 0.978182 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({0: 3865, 1: 3826})

Epoch :  16 loss training:  3.484070385398809 Time :  2316
accuracy train: 0.994547 val: 0.976364 test: 0.976712
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({1: 3861, 0: 3830})

Epoch :  17 loss training:  3.3887688184913713 Time :  2335
accuracy train: 0.995758 val: 0.965455 test: 0.976256
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({1: 3859, 0: 3832})

Epoch :  18 loss training:  3.4511991556501016 Time :  2356
accuracy train: 0.995960 val: 0.974545 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({1: 3847, 0: 3844})

Epoch :  19 loss training:  3.037829491047887 Time :  2379
accuracy train: 0.996162 val: 0.969091 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({0: 3846, 1: 3845})

Epoch :  20 loss training:  2.6771417940908577 Time :  2400
accuracy train: 0.995758 val: 0.970909 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({1: 3847, 0: 3844})

Epoch :  21 loss training:  2.5923967679264024 Time :  2420
accuracy train: 0.996364 val: 0.969091 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({1: 3859, 0: 3832})

Epoch :  22 loss training:  2.7398511079954915 Time :  2444
accuracy train: 0.996364 val: 0.976364 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({1: 3872, 0: 3819})

Epoch :  23 loss training:  2.669208478590008 Time :  2464
accuracy train: 0.995960 val: 0.970909 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({1: 3877, 0: 3814})

Epoch :  24 loss training:  2.2525126152322628 Time :  2484
accuracy train: 0.996566 val: 0.976364 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({1: 3879, 0: 3812})

Epoch :  25 loss training:  2.008723192164325 Time :  2504
accuracy train: 0.996162 val: 0.960000 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({1: 3878, 0: 3813})

Epoch :  26 loss training:  2.227900824829703 Time :  2527
accuracy train: 0.996162 val: 0.976364 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({1: 3888, 0: 3803})

Epoch :  27 loss training:  2.067192299524322 Time :  2553
accuracy train: 0.996364 val: 0.956364 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({1: 3888, 0: 3803})

Epoch :  28 loss training:  2.041285988583695 Time :  2575
accuracy train: 0.996768 val: 0.974545 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({1: 3890, 0: 3801})

Epoch :  29 loss training:  1.7451337251259247 Time :  2595
accuracy train: 0.996768 val: 0.969091 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({1: 3894, 0: 3797})

Epoch :  30 loss training:  2.0006762033735868 Time :  2616
accuracy train: 0.996768 val: 0.967273 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({0: 3894, 1: 3797})

Epoch :  31 loss training:  1.7385190109926043 Time :  2641
accuracy train: 0.996970 val: 0.970909 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({1: 3894, 0: 3797})

Epoch :  32 loss training:  1.6660755496486672 Time :  2666
accuracy train: 0.996364 val: 0.969091 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({0: 3896, 1: 3795})

Epoch :  33 loss training:  1.629216038105369 Time :  2689
accuracy train: 0.996970 val: 0.965455 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({0: 3896, 1: 3795})

Epoch :  34 loss training:  1.6719773556833388 Time :  2707
accuracy train: 0.996566 val: 0.972727 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({1: 3902, 0: 3789})

Epoch :  35 loss training:  1.6267896785502671 Time :  2729
accuracy train: 0.996970 val: 0.965455 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({1: 3902, 0: 3789})

Epoch :  36 loss training:  1.522684340383421 Time :  2752
accuracy train: 0.997374 val: 0.967273 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({1: 3902, 0: 3789})

Epoch :  37 loss training:  2.055746713114786 Time :  2775
accuracy train: 0.996970 val: 0.970909 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({1: 3905, 0: 3786})

Epoch :  38 loss training:  1.5298943008674541 Time :  2797
accuracy train: 0.996970 val: 0.969091 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({1: 3905, 0: 3786})

Epoch :  39 loss training:  1.6668530075185117 Time :  2815
accuracy train: 0.996970 val: 0.965455 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({1: 3906, 0: 3785})

Epoch :  40 loss training:  1.5357300467730965 Time :  2837
accuracy train: 0.996162 val: 0.960000 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({1: 3908, 0: 3783})

Epoch :  41 loss training:  1.57503069723316 Time :  2864
accuracy train: 0.996364 val: 0.956364 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({1: 3908, 0: 3783})

Epoch :  42 loss training:  1.5474849423480919 Time :  2886
accuracy train: 0.996566 val: 0.960000 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({0: 3908, 1: 3783})

Epoch :  43 loss training:  1.5545462551563105 Time :  2905
accuracy train: 0.996970 val: 0.963636 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({1: 3908, 0: 3783})

Epoch :  44 loss training:  1.3370234045032703 Time :  2928
accuracy train: 0.997172 val: 0.960000 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({1: 3908, 0: 3783})

Epoch :  45 loss training:  1.21151932336943 Time :  2955
accuracy train: 0.997374 val: 0.965455 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({1: 3908, 0: 3783})

Epoch :  46 loss training:  1.3667132321934332 Time :  2979
accuracy train: 0.996970 val: 0.963636 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.972603
Counter({1: 3908, 0: 3783})

========================================================================================================================================================================================================
max acc epoch :  15
max validation accuracy :  0.9781818181818182
test accuracy :  0.9726027397260274
last test_accuracy :  0.9730593607305936
max gap 10
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=535, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4721, 0: 2970})

Epoch :  1 loss training:  38.41638078354299 Time :  3001
accuracy train: 0.962634 val: 0.936364 test: 0.962100
max validation accuracy : 0.936364 max acc epoch : 1 test accuracy : 0.962100
Counter({0: 3960, 1: 3731})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.477312171831727 Time :  3019
accuracy train: 0.974753 val: 0.960000 test: 0.970776
max validation accuracy : 0.960000 max acc epoch : 2 test accuracy : 0.970776
Counter({0: 3938, 1: 3753})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.32422241056338 Time :  3043
accuracy train: 0.973743 val: 0.958182 test: 0.963014
max validation accuracy : 0.960000 max acc epoch : 2 test accuracy : 0.970776
Counter({0: 3918, 1: 3773})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.971974712330848 Time :  3064
accuracy train: 0.986467 val: 0.967273 test: 0.969406
max validation accuracy : 0.967273 max acc epoch : 4 test accuracy : 0.969406
Counter({1: 3910, 0: 3781})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.227739561232738 Time :  3081
accuracy train: 0.988285 val: 0.969091 test: 0.965753
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.965753
Counter({0: 3922, 1: 3769})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.112785218050703 Time :  3104
accuracy train: 0.982428 val: 0.954545 test: 0.964840
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.965753
Counter({0: 3937, 1: 3754})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.808290453860536 Time :  3125
accuracy train: 0.989497 val: 0.969091 test: 0.976712
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.965753
Counter({0: 3926, 1: 3765})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.224488653475419 Time :  3143
accuracy train: 0.991921 val: 0.970909 test: 0.972603
max validation accuracy : 0.970909 max acc epoch : 8 test accuracy : 0.972603
Counter({1: 3911, 0: 3780})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.62207002856303 Time :  3162
accuracy train: 0.989699 val: 0.969091 test: 0.969863
max validation accuracy : 0.970909 max acc epoch : 8 test accuracy : 0.972603
Counter({0: 3908, 1: 3783})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.072630356065929 Time :  3189
accuracy train: 0.990911 val: 0.974545 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.970776
Counter({1: 3902, 0: 3789})

Epoch :  11 loss training:  5.0081896936753765 Time :  3212
accuracy train: 0.993739 val: 0.969091 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.970776
Counter({0: 3900, 1: 3791})

Epoch :  12 loss training:  4.903233486926183 Time :  3229
accuracy train: 0.993133 val: 0.969091 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.970776
Counter({1: 3896, 0: 3795})

Epoch :  13 loss training:  4.40285459056031 Time :  3252
accuracy train: 0.993739 val: 0.970909 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.970776
Counter({0: 3895, 1: 3796})

Epoch :  14 loss training:  4.015644403451006 Time :  3279
accuracy train: 0.994951 val: 0.974545 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.970776
Counter({0: 3890, 1: 3801})

Epoch :  15 loss training:  3.7205749336862937 Time :  3300
accuracy train: 0.995354 val: 0.978182 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3872, 1: 3819})

Epoch :  16 loss training:  3.6017315431672614 Time :  3319
accuracy train: 0.994143 val: 0.976364 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3871, 0: 3820})

Epoch :  17 loss training:  3.4781180257414235 Time :  3348
accuracy train: 0.995960 val: 0.970909 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3871, 0: 3820})

Epoch :  18 loss training:  3.4575410958495922 Time :  3369
accuracy train: 0.995758 val: 0.976364 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3860, 0: 3831})

Epoch :  19 loss training:  3.0714741770061664 Time :  3388
accuracy train: 0.995960 val: 0.970909 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3860, 0: 3831})

Epoch :  20 loss training:  2.777344891335815 Time :  3409
accuracy train: 0.996162 val: 0.967273 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3855, 1: 3836})

Epoch :  21 loss training:  2.6548373255645856 Time :  3434
accuracy train: 0.996364 val: 0.970909 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3852, 0: 3839})

Epoch :  22 loss training:  2.704435620311415 Time :  3457
accuracy train: 0.996162 val: 0.978182 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3857, 0: 3834})

Epoch :  23 loss training:  2.6968559840752278 Time :  3480
accuracy train: 0.996162 val: 0.974545 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3867, 0: 3824})

Epoch :  24 loss training:  2.253287067171186 Time :  3499
accuracy train: 0.996364 val: 0.976364 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3881, 0: 3810})

Epoch :  25 loss training:  2.112958508951124 Time :  3520
accuracy train: 0.996162 val: 0.961818 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3881, 0: 3810})

Epoch :  26 loss training:  2.2639695864199894 Time :  3541
accuracy train: 0.996162 val: 0.972727 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3884, 1: 3807})

Epoch :  27 loss training:  2.0562554901262047 Time :  3567
accuracy train: 0.996364 val: 0.958182 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3882, 0: 3809})

Epoch :  28 loss training:  2.021309480071068 Time :  3590
accuracy train: 0.996970 val: 0.970909 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3884, 0: 3807})

Epoch :  29 loss training:  1.7127596622740384 Time :  3609
accuracy train: 0.996566 val: 0.969091 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3889, 1: 3802})

Epoch :  30 loss training:  1.9812622805475257 Time :  3629
accuracy train: 0.996970 val: 0.969091 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3890, 1: 3801})

Epoch :  31 loss training:  1.7335762705188245 Time :  3652
accuracy train: 0.996768 val: 0.970909 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3891, 1: 3800})

Epoch :  32 loss training:  1.784859795763623 Time :  3678
accuracy train: 0.996364 val: 0.970909 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3896, 1: 3795})

Epoch :  33 loss training:  1.6700159990068641 Time :  3707
accuracy train: 0.996768 val: 0.969091 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3896, 0: 3795})

Epoch :  34 loss training:  1.8311213470733492 Time :  3730
accuracy train: 0.996364 val: 0.974545 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3904, 1: 3787})

Epoch :  35 loss training:  1.6741471898276359 Time :  3751
accuracy train: 0.996768 val: 0.965455 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3904, 0: 3787})

Epoch :  36 loss training:  1.607606717680028 Time :  3770
accuracy train: 0.997172 val: 0.967273 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3904, 1: 3787})

Epoch :  37 loss training:  2.0531973977849702 Time :  3795
accuracy train: 0.996768 val: 0.961818 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3904, 0: 3787})

Epoch :  38 loss training:  1.532503777249076 Time :  3821
accuracy train: 0.997374 val: 0.969091 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3906, 1: 3785})

Epoch :  39 loss training:  1.6963684540969552 Time :  3844
accuracy train: 0.996768 val: 0.963636 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3906, 0: 3785})

Epoch :  40 loss training:  1.7126758007361786 Time :  3872
accuracy train: 0.996162 val: 0.958182 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3906, 1: 3785})

Epoch :  41 loss training:  1.628205649460142 Time :  3893
accuracy train: 0.996768 val: 0.956364 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3906, 0: 3785})

Epoch :  42 loss training:  1.611561630750657 Time :  3915
accuracy train: 0.996768 val: 0.958182 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3906, 1: 3785})

Epoch :  43 loss training:  1.4578188914274506 Time :  3935
accuracy train: 0.996970 val: 0.960000 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3906, 1: 3785})

Epoch :  44 loss training:  1.308749901400006 Time :  3955
accuracy train: 0.996970 val: 0.958182 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3906, 1: 3785})

Epoch :  45 loss training:  1.1677481770457234 Time :  3983
accuracy train: 0.996970 val: 0.956364 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3906, 1: 3785})

Epoch :  46 loss training:  1.319888498448563 Time :  4003
accuracy train: 0.996566 val: 0.958182 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3906, 0: 3785})

========================================================================================================================================================================================================
max acc epoch :  15
max validation accuracy :  0.9781818181818182
test accuracy :  0.9712328767123287
last test_accuracy :  0.9739726027397261
max gap 5
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=535, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4721, 0: 2970})

Epoch :  1 loss training:  38.45595024898648 Time :  4029
accuracy train: 0.962230 val: 0.940000 test: 0.961187
max validation accuracy : 0.940000 max acc epoch : 1 test accuracy : 0.961187
Counter({0: 3969, 1: 3722})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.38685111887753 Time :  4045
accuracy train: 0.974349 val: 0.963636 test: 0.971233
max validation accuracy : 0.963636 max acc epoch : 2 test accuracy : 0.971233
Counter({0: 3937, 1: 3754})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.236465186346322 Time :  4066
accuracy train: 0.972935 val: 0.956364 test: 0.963014
max validation accuracy : 0.963636 max acc epoch : 2 test accuracy : 0.971233
Counter({0: 3902, 1: 3789})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.863182130735368 Time :  4088
accuracy train: 0.985659 val: 0.967273 test: 0.970320
max validation accuracy : 0.967273 max acc epoch : 4 test accuracy : 0.970320
Counter({1: 3899, 0: 3792})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.191104609402828 Time :  4108
accuracy train: 0.988487 val: 0.970909 test: 0.965297
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.965297
Counter({1: 3914, 0: 3777})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.055630951654166 Time :  4126
accuracy train: 0.981822 val: 0.954545 test: 0.965297
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.965297
Counter({0: 3931, 1: 3760})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.706806345842779 Time :  4153
accuracy train: 0.989699 val: 0.969091 test: 0.974886
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.965297
Counter({0: 3918, 1: 3773})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.063042822177522 Time :  4179
accuracy train: 0.992325 val: 0.972727 test: 0.969863
max validation accuracy : 0.972727 max acc epoch : 8 test accuracy : 0.969863
Counter({1: 3910, 0: 3781})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.463156087265816 Time :  4201
accuracy train: 0.990103 val: 0.967273 test: 0.967580
max validation accuracy : 0.972727 max acc epoch : 8 test accuracy : 0.969863
Counter({1: 3904, 0: 3787})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  4.89696888322942 Time :  4225
accuracy train: 0.991113 val: 0.969091 test: 0.969863
max validation accuracy : 0.972727 max acc epoch : 8 test accuracy : 0.969863
Counter({0: 3900, 1: 3791})

Epoch :  11 loss training:  5.003244618419558 Time :  4243
accuracy train: 0.992729 val: 0.969091 test: 0.972603
max validation accuracy : 0.972727 max acc epoch : 8 test accuracy : 0.969863
Counter({1: 3896, 0: 3795})

Epoch :  12 loss training:  4.884038973599672 Time :  4264
accuracy train: 0.993941 val: 0.969091 test: 0.972146
max validation accuracy : 0.972727 max acc epoch : 8 test accuracy : 0.969863
Counter({1: 3890, 0: 3801})

Epoch :  13 loss training:  4.286744577926584 Time :  4290
accuracy train: 0.993941 val: 0.970909 test: 0.968950
max validation accuracy : 0.972727 max acc epoch : 8 test accuracy : 0.969863
Counter({1: 3886, 0: 3805})

Epoch :  14 loss training:  3.954346331389388 Time :  4313
accuracy train: 0.995354 val: 0.976364 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 14 test accuracy : 0.971689
Counter({0: 3880, 1: 3811})

Epoch :  15 loss training:  3.604078842443414 Time :  4332
accuracy train: 0.995556 val: 0.978182 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3873, 1: 3818})

Epoch :  16 loss training:  3.47606100741541 Time :  4355
accuracy train: 0.994951 val: 0.974545 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3871, 0: 3820})

Epoch :  17 loss training:  3.4785822069097776 Time :  4376
accuracy train: 0.995556 val: 0.969091 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3865, 0: 3826})

Epoch :  18 loss training:  3.3669392102747224 Time :  4398
accuracy train: 0.996162 val: 0.974545 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3847, 0: 3844})

Epoch :  19 loss training:  2.983307579444954 Time :  4417
accuracy train: 0.996162 val: 0.972727 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3847, 1: 3844})

Epoch :  20 loss training:  2.6778447478136513 Time :  4440
accuracy train: 0.995960 val: 0.970909 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3849, 0: 3842})

Epoch :  21 loss training:  2.6038241935311817 Time :  4464
accuracy train: 0.996364 val: 0.969091 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3859, 1: 3832})

Epoch :  22 loss training:  2.8345056633406784 Time :  4487
accuracy train: 0.995960 val: 0.976364 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3869, 0: 3822})

Epoch :  23 loss training:  2.7297988842474297 Time :  4506
accuracy train: 0.996162 val: 0.972727 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3876, 0: 3815})

Epoch :  24 loss training:  2.2032314077368937 Time :  4527
accuracy train: 0.996970 val: 0.976364 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3884, 0: 3807})

Epoch :  25 loss training:  2.0308870745066088 Time :  4550
accuracy train: 0.996364 val: 0.967273 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3883, 0: 3808})

Epoch :  26 loss training:  2.2357614919892512 Time :  4574
accuracy train: 0.996162 val: 0.965455 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3882, 0: 3809})

Epoch :  27 loss training:  2.1252564465103205 Time :  4596
accuracy train: 0.996364 val: 0.961818 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3882, 0: 3809})

Epoch :  28 loss training:  2.0129655264900066 Time :  4616
accuracy train: 0.996970 val: 0.972727 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3887, 0: 3804})

Epoch :  29 loss training:  1.7118289098143578 Time :  4640
accuracy train: 0.996566 val: 0.970909 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3895, 0: 3796})

Epoch :  30 loss training:  2.0046335180813912 Time :  4664
accuracy train: 0.996768 val: 0.969091 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3896, 1: 3795})

Epoch :  31 loss training:  1.6924124372017104 Time :  4688
accuracy train: 0.996970 val: 0.969091 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3897, 1: 3794})

Epoch :  32 loss training:  1.62646707741078 Time :  4714
accuracy train: 0.996364 val: 0.970909 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3902, 1: 3789})

Epoch :  33 loss training:  1.6363450545904925 Time :  4734
accuracy train: 0.996970 val: 0.965455 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3902, 1: 3789})

Epoch :  34 loss training:  1.744650579195877 Time :  4756
accuracy train: 0.996566 val: 0.972727 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3906, 0: 3785})

Epoch :  35 loss training:  1.7208400702511426 Time :  4778
accuracy train: 0.996566 val: 0.967273 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3906, 0: 3785})

Epoch :  36 loss training:  1.573261840378109 Time :  4799
accuracy train: 0.996970 val: 0.970909 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3906, 0: 3785})

Epoch :  37 loss training:  2.027124892338179 Time :  4816
accuracy train: 0.996768 val: 0.967273 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3908, 0: 3783})

Epoch :  38 loss training:  1.4749774401570903 Time :  4838
accuracy train: 0.997172 val: 0.972727 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3908, 1: 3783})

Epoch :  39 loss training:  1.743644133413909 Time :  4859
accuracy train: 0.996970 val: 0.963636 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3909, 0: 3782})

Epoch :  40 loss training:  1.9264030764607014 Time :  4881
accuracy train: 0.996364 val: 0.954545 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3909, 1: 3782})

Epoch :  41 loss training:  1.5275761319498997 Time :  4900
accuracy train: 0.996162 val: 0.958182 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3909, 1: 3782})

Epoch :  42 loss training:  1.6039273596034036 Time :  4924
accuracy train: 0.996566 val: 0.958182 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3909, 1: 3782})

Epoch :  43 loss training:  1.4927061839516682 Time :  4943
accuracy train: 0.996768 val: 0.958182 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3909, 0: 3782})

Epoch :  44 loss training:  1.3156393275530718 Time :  4962
accuracy train: 0.996768 val: 0.958182 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3909, 1: 3782})

Epoch :  45 loss training:  1.16856160662428 Time :  4984
accuracy train: 0.996768 val: 0.960000 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3909, 1: 3782})

Epoch :  46 loss training:  1.3533016814908478 Time :  5012
accuracy train: 0.996768 val: 0.958182 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3909, 0: 3782})

========================================================================================================================================================================================================
max acc epoch :  15
max validation accuracy :  0.9781818181818182
test accuracy :  0.9712328767123287
last test_accuracy :  0.9721461187214612
max gap 6
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=535, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4721, 0: 2970})

Epoch :  1 loss training:  38.38193088024855 Time :  5050
accuracy train: 0.963442 val: 0.943636 test: 0.961187
max validation accuracy : 0.943636 max acc epoch : 1 test accuracy : 0.961187
Counter({1: 3973, 0: 3718})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.381946524605155 Time :  5074
accuracy train: 0.974349 val: 0.958182 test: 0.969406
max validation accuracy : 0.958182 max acc epoch : 2 test accuracy : 0.969406
Counter({0: 3959, 1: 3732})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.583188687684014 Time :  5099
accuracy train: 0.973541 val: 0.961818 test: 0.964384
max validation accuracy : 0.961818 max acc epoch : 3 test accuracy : 0.964384
Counter({1: 3933, 0: 3758})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.6892757024616 Time :  5123
accuracy train: 0.985256 val: 0.963636 test: 0.969406
max validation accuracy : 0.963636 max acc epoch : 4 test accuracy : 0.969406
Counter({1: 3922, 0: 3769})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.189763355534524 Time :  5142
accuracy train: 0.988487 val: 0.972727 test: 0.968493
max validation accuracy : 0.972727 max acc epoch : 5 test accuracy : 0.968493
Counter({0: 3917, 1: 3774})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.154194993432611 Time :  5160
accuracy train: 0.984650 val: 0.954545 test: 0.968037
max validation accuracy : 0.972727 max acc epoch : 5 test accuracy : 0.968493
Counter({0: 3933, 1: 3758})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.5659538267645985 Time :  5180
accuracy train: 0.989699 val: 0.969091 test: 0.974886
max validation accuracy : 0.972727 max acc epoch : 5 test accuracy : 0.968493
Counter({0: 3926, 1: 3765})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.994737423257902 Time :  5204
accuracy train: 0.991921 val: 0.970909 test: 0.971689
max validation accuracy : 0.972727 max acc epoch : 5 test accuracy : 0.968493
Counter({1: 3920, 0: 3771})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.546932051773183 Time :  5226
accuracy train: 0.989295 val: 0.969091 test: 0.967580
max validation accuracy : 0.972727 max acc epoch : 5 test accuracy : 0.968493
Counter({1: 3914, 0: 3777})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  4.875575753161684 Time :  5242
accuracy train: 0.991517 val: 0.974545 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.970776
Counter({1: 3906, 0: 3785})

Epoch :  11 loss training:  4.918591442867182 Time :  5265
accuracy train: 0.992729 val: 0.967273 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.970776
Counter({0: 3907, 1: 3784})

Epoch :  12 loss training:  4.755147698451765 Time :  5287
accuracy train: 0.993133 val: 0.967273 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.970776
Counter({1: 3901, 0: 3790})

Epoch :  13 loss training:  4.245832513086498 Time :  5307
accuracy train: 0.993537 val: 0.972727 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.970776
Counter({0: 3892, 1: 3799})

Epoch :  14 loss training:  3.8869530315860175 Time :  5329
accuracy train: 0.995152 val: 0.974545 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.970776
Counter({0: 3890, 1: 3801})

Epoch :  15 loss training:  3.530627930886112 Time :  5347
accuracy train: 0.995556 val: 0.978182 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3879, 1: 3812})

Epoch :  16 loss training:  3.519442972028628 Time :  5373
accuracy train: 0.994951 val: 0.974545 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3873, 1: 3818})

Epoch :  17 loss training:  3.491517482267227 Time :  5393
accuracy train: 0.995960 val: 0.969091 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3871, 0: 3820})

Epoch :  18 loss training:  3.389300683455076 Time :  5414
accuracy train: 0.995960 val: 0.972727 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3857, 0: 3834})

Epoch :  19 loss training:  3.066555159399286 Time :  5435
accuracy train: 0.995960 val: 0.970909 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3856, 1: 3835})

Epoch :  20 loss training:  2.7565942983492278 Time :  5454
accuracy train: 0.996566 val: 0.970909 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3851, 1: 3840})

Epoch :  21 loss training:  2.629502689349465 Time :  5478
accuracy train: 0.996566 val: 0.969091 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3852, 1: 3839})

Epoch :  22 loss training:  2.7893502647057176 Time :  5500
accuracy train: 0.996162 val: 0.974545 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3858, 0: 3833})

Epoch :  23 loss training:  2.5829696494038217 Time :  5523
accuracy train: 0.995960 val: 0.970909 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3862, 0: 3829})

Epoch :  24 loss training:  2.257033785688691 Time :  5541
accuracy train: 0.996970 val: 0.976364 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3871, 0: 3820})

Epoch :  25 loss training:  2.0340780119004194 Time :  5562
accuracy train: 0.996768 val: 0.965455 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3872, 0: 3819})

Epoch :  26 loss training:  2.1673907396179857 Time :  5588
accuracy train: 0.996162 val: 0.978182 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3880, 0: 3811})

Epoch :  27 loss training:  2.0890374686860014 Time :  5611
accuracy train: 0.996566 val: 0.954545 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3880, 0: 3811})

Epoch :  28 loss training:  2.0135845508484636 Time :  5630
accuracy train: 0.996970 val: 0.970909 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3883, 0: 3808})

Epoch :  29 loss training:  1.8222114229865838 Time :  5650
accuracy train: 0.996364 val: 0.970909 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3887, 0: 3804})

Epoch :  30 loss training:  2.065924788970733 Time :  5671
accuracy train: 0.996768 val: 0.970909 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3888, 1: 3803})

Epoch :  31 loss training:  1.7322599607650773 Time :  5698
accuracy train: 0.996970 val: 0.969091 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3888, 1: 3803})

Epoch :  32 loss training:  1.8291367783822352 Time :  5719
accuracy train: 0.996364 val: 0.972727 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3891, 1: 3800})

Epoch :  33 loss training:  1.656674650083005 Time :  5737
accuracy train: 0.996970 val: 0.965455 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3890, 1: 3801})

Epoch :  34 loss training:  1.70013111193839 Time :  5758
accuracy train: 0.996566 val: 0.976364 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3895, 0: 3796})

Epoch :  35 loss training:  1.6443381227290956 Time :  5783
accuracy train: 0.996768 val: 0.967273 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3895, 0: 3796})

Epoch :  36 loss training:  1.5945342749582778 Time :  5803
accuracy train: 0.996970 val: 0.967273 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3896, 1: 3795})

Epoch :  37 loss training:  2.053788439494383 Time :  5821
accuracy train: 0.996970 val: 0.967273 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3896, 0: 3795})

Epoch :  38 loss training:  1.4552788818400586 Time :  5841
accuracy train: 0.997172 val: 0.967273 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3898, 0: 3793})

Epoch :  39 loss training:  1.8937227426868048 Time :  5865
accuracy train: 0.996970 val: 0.963636 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3899, 0: 3792})

Epoch :  40 loss training:  2.068187629149179 Time :  5887
accuracy train: 0.996162 val: 0.958182 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3900, 0: 3791})

Epoch :  41 loss training:  1.745601463066123 Time :  5905
accuracy train: 0.996162 val: 0.960000 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3900, 0: 3791})

Epoch :  42 loss training:  1.6302551684348145 Time :  5927
accuracy train: 0.996768 val: 0.961818 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3900, 1: 3791})

Epoch :  43 loss training:  1.4832623680740653 Time :  5951
accuracy train: 0.996970 val: 0.958182 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3899, 0: 3792})

Epoch :  44 loss training:  1.3594587302395666 Time :  5973
accuracy train: 0.996970 val: 0.960000 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3899, 0: 3792})

Epoch :  45 loss training:  1.281997576730646 Time :  5991
accuracy train: 0.997172 val: 0.960000 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3899, 1: 3792})

Epoch :  46 loss training:  1.3582403951659217 Time :  6014
accuracy train: 0.996364 val: 0.960000 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3900, 1: 3791})

========================================================================================================================================================================================================
max acc epoch :  15
max validation accuracy :  0.9781818181818182
test accuracy :  0.9712328767123287
last test_accuracy :  0.9748858447488584
max gap 5
========================================================================================================================================================================================================

itr : 6
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=535, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4721, 0: 2970})

Epoch :  1 loss training:  38.352165795862675 Time :  6043
accuracy train: 0.961018 val: 0.936364 test: 0.959817
max validation accuracy : 0.936364 max acc epoch : 1 test accuracy : 0.959817
Counter({0: 3978, 1: 3713})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.356414270587265 Time :  6071
accuracy train: 0.975157 val: 0.961818 test: 0.970320
max validation accuracy : 0.961818 max acc epoch : 2 test accuracy : 0.970320
Counter({1: 3976, 0: 3715})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.223935921676457 Time :  6089
accuracy train: 0.971925 val: 0.954545 test: 0.964384
max validation accuracy : 0.961818 max acc epoch : 2 test accuracy : 0.970320
Counter({1: 3942, 0: 3749})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.780731529928744 Time :  6113
accuracy train: 0.985256 val: 0.970909 test: 0.968037
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.968037
Counter({1: 3928, 0: 3763})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.056269131891895 Time :  6136
accuracy train: 0.988487 val: 0.974545 test: 0.967123
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.967123
Counter({1: 3944, 0: 3747})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.264052130980417 Time :  6155
accuracy train: 0.978792 val: 0.954545 test: 0.964384
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.967123
Counter({0: 3964, 1: 3727})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.8755177720449865 Time :  6173
accuracy train: 0.989497 val: 0.970909 test: 0.975799
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.967123
Counter({1: 3948, 0: 3743})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.155374980415218 Time :  6197
accuracy train: 0.991719 val: 0.972727 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.967123
Counter({1: 3916, 0: 3775})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.515543812594842 Time :  6216
accuracy train: 0.990507 val: 0.970909 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.967123
Counter({0: 3908, 1: 3783})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  4.9706731180194765 Time :  6236
accuracy train: 0.990911 val: 0.970909 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.967123
Counter({1: 3906, 0: 3785})

Epoch :  11 loss training:  4.992901392630301 Time :  6258
accuracy train: 0.992729 val: 0.969091 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.967123
Counter({1: 3903, 0: 3788})

Epoch :  12 loss training:  4.945014293771237 Time :  6278
accuracy train: 0.993335 val: 0.965455 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.967123
Counter({0: 3898, 1: 3793})

Epoch :  13 loss training:  4.277441879035905 Time :  6302
accuracy train: 0.993739 val: 0.972727 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.967123
Counter({1: 3892, 0: 3799})

Epoch :  14 loss training:  3.9291366412653588 Time :  6330
accuracy train: 0.994547 val: 0.970909 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.967123
Counter({0: 3889, 1: 3802})

Epoch :  15 loss training:  3.6553037738776766 Time :  6352
accuracy train: 0.995758 val: 0.978182 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3875, 1: 3816})

Epoch :  16 loss training:  3.5193672826862894 Time :  6371
accuracy train: 0.994951 val: 0.974545 test: 0.976256
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3871, 1: 3820})

Epoch :  17 loss training:  3.4787309139501303 Time :  6391
accuracy train: 0.995758 val: 0.967273 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3871, 0: 3820})

Epoch :  18 loss training:  3.4448716251645237 Time :  6419
accuracy train: 0.996162 val: 0.976364 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3860, 0: 3831})

Epoch :  19 loss training:  2.9478521498385817 Time :  6442
accuracy train: 0.996162 val: 0.972727 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3857, 0: 3834})

Epoch :  20 loss training:  2.724734027084196 Time :  6463
accuracy train: 0.996162 val: 0.969091 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3852, 0: 3839})

Epoch :  21 loss training:  2.80609614594141 Time :  6483
accuracy train: 0.995758 val: 0.969091 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3855, 1: 3836})

Epoch :  22 loss training:  2.6459616498323157 Time :  6504
accuracy train: 0.996162 val: 0.967273 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3856, 0: 3835})

Epoch :  23 loss training:  2.5223293420276605 Time :  6529
accuracy train: 0.996162 val: 0.970909 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3871, 0: 3820})

Epoch :  24 loss training:  2.166446808114415 Time :  6552
accuracy train: 0.996162 val: 0.978182 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3874, 0: 3817})

Epoch :  25 loss training:  2.444871222760412 Time :  6572
accuracy train: 0.996566 val: 0.967273 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3876, 0: 3815})

Epoch :  26 loss training:  2.3396450691798236 Time :  6591
accuracy train: 0.996768 val: 0.965455 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3878, 0: 3813})

Epoch :  27 loss training:  1.9715139562031254 Time :  6611
accuracy train: 0.996364 val: 0.967273 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3878, 0: 3813})

Epoch :  28 loss training:  1.8599072860670276 Time :  6634
accuracy train: 0.996566 val: 0.974545 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3882, 0: 3809})

Epoch :  29 loss training:  1.87939379447198 Time :  6660
accuracy train: 0.996768 val: 0.963636 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3892, 0: 3799})

Epoch :  30 loss training:  1.670200579217635 Time :  6683
accuracy train: 0.996566 val: 0.970909 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3892, 1: 3799})

Epoch :  31 loss training:  1.6665204959863331 Time :  6701
accuracy train: 0.996768 val: 0.963636 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3894, 1: 3797})

Epoch :  32 loss training:  1.6713852233951911 Time :  6729
accuracy train: 0.996162 val: 0.970909 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3898, 1: 3793})

Epoch :  33 loss training:  1.7355956781830173 Time :  6751
accuracy train: 0.996970 val: 0.974545 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3903, 1: 3788})

Epoch :  34 loss training:  1.5821431322219723 Time :  6772
accuracy train: 0.995960 val: 0.965455 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3903, 1: 3788})

Epoch :  35 loss training:  1.7369615144980344 Time :  6789
accuracy train: 0.996970 val: 0.969091 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3905, 1: 3786})

Epoch :  36 loss training:  1.6546034614366363 Time :  6818
accuracy train: 0.996970 val: 0.967273 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3905, 1: 3786})

Epoch :  37 loss training:  1.9454527297493769 Time :  6839
accuracy train: 0.996768 val: 0.965455 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3906, 0: 3785})

Epoch :  38 loss training:  1.6271462916774908 Time :  6856
accuracy train: 0.996566 val: 0.961818 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3906, 1: 3785})

Epoch :  39 loss training:  1.5243513693421846 Time :  6878
accuracy train: 0.996970 val: 0.960000 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3906, 0: 3785})

Epoch :  40 loss training:  1.3967382563787396 Time :  6901
accuracy train: 0.996364 val: 0.963636 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3906, 1: 3785})

Epoch :  41 loss training:  1.4473590192828851 Time :  6921
accuracy train: 0.996566 val: 0.960000 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3906, 1: 3785})

Epoch :  42 loss training:  1.5240174689934065 Time :  6938
accuracy train: 0.996970 val: 0.961818 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3906, 1: 3785})

Epoch :  43 loss training:  1.4630755316411523 Time :  6961
accuracy train: 0.996768 val: 0.958182 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3906, 0: 3785})

Epoch :  44 loss training:  1.4586472433802555 Time :  6981
accuracy train: 0.996768 val: 0.961818 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({1: 3906, 0: 3785})

Epoch :  45 loss training:  1.174971576590906 Time :  7000
accuracy train: 0.997172 val: 0.954545 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3906, 1: 3785})

Epoch :  46 loss training:  1.4079648996812466 Time :  7028
accuracy train: 0.996566 val: 0.961818 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.971233
Counter({0: 3906, 1: 3785})

========================================================================================================================================================================================================
max acc epoch :  15
max validation accuracy :  0.9781818181818182
test accuracy :  0.9712328767123287
last test_accuracy :  0.9735159817351599
max gap 10
========================================================================================================================================================================================================

itr : 7
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=535, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4721, 0: 2970})

Epoch :  1 loss training:  38.3904043789953 Time :  7067
accuracy train: 0.961624 val: 0.938182 test: 0.961187
max validation accuracy : 0.938182 max acc epoch : 1 test accuracy : 0.961187
Counter({1: 3970, 0: 3721})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.319212465547025 Time :  7097
accuracy train: 0.973339 val: 0.960000 test: 0.970776
max validation accuracy : 0.960000 max acc epoch : 2 test accuracy : 0.970776
Counter({1: 3964, 0: 3727})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.147544018458575 Time :  7118
accuracy train: 0.974551 val: 0.958182 test: 0.966210
max validation accuracy : 0.960000 max acc epoch : 2 test accuracy : 0.970776
Counter({0: 3928, 1: 3763})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.656273820903152 Time :  7136
accuracy train: 0.985659 val: 0.965455 test: 0.972603
max validation accuracy : 0.965455 max acc epoch : 4 test accuracy : 0.972603
Counter({1: 3901, 0: 3790})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.094588167848997 Time :  7155
accuracy train: 0.988487 val: 0.976364 test: 0.965297
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.965297
Counter({1: 3898, 0: 3793})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.083250461844727 Time :  7183
accuracy train: 0.983034 val: 0.960000 test: 0.966210
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.965297
Counter({0: 3916, 1: 3775})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.781619899906218 Time :  7203
accuracy train: 0.989901 val: 0.969091 test: 0.974886
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.965297
Counter({0: 3904, 1: 3787})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.904432171722874 Time :  7220
accuracy train: 0.992123 val: 0.974545 test: 0.967123
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.965297
Counter({0: 3900, 1: 3791})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.492465354240267 Time :  7248
accuracy train: 0.990305 val: 0.970909 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.965297
Counter({1: 3884, 0: 3807})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  4.921491001266986 Time :  7270
accuracy train: 0.991517 val: 0.972727 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.965297
Counter({1: 3878, 0: 3813})

Epoch :  11 loss training:  4.8429653466446325 Time :  7290
accuracy train: 0.993537 val: 0.970909 test: 0.973516
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.965297
Counter({1: 3877, 0: 3814})

Epoch :  12 loss training:  4.789366716053337 Time :  7311
accuracy train: 0.993739 val: 0.969091 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.965297
Counter({1: 3872, 0: 3819})

Epoch :  13 loss training:  4.174047080159653 Time :  7336
accuracy train: 0.993739 val: 0.972727 test: 0.968950
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.965297
Counter({0: 3868, 1: 3823})

Epoch :  14 loss training:  3.7504493838641793 Time :  7361
accuracy train: 0.995354 val: 0.972727 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.965297
Counter({1: 3863, 0: 3828})

Epoch :  15 loss training:  3.5402050519478507 Time :  7382
accuracy train: 0.995556 val: 0.978182 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({0: 3858, 1: 3833})

Epoch :  16 loss training:  3.473795461410191 Time :  7411
accuracy train: 0.994951 val: 0.974545 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({1: 3856, 0: 3835})

Epoch :  17 loss training:  3.3511873325915076 Time :  7434
accuracy train: 0.995758 val: 0.967273 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({0: 3855, 1: 3836})

Epoch :  18 loss training:  3.342389079014538 Time :  7452
accuracy train: 0.995960 val: 0.976364 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({0: 3853, 1: 3838})

Epoch :  19 loss training:  2.942604814597871 Time :  7476
accuracy train: 0.995758 val: 0.969091 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({1: 3853, 0: 3838})

Epoch :  20 loss training:  2.6598455355269834 Time :  7504
accuracy train: 0.995758 val: 0.970909 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({1: 3856, 0: 3835})

Epoch :  21 loss training:  2.7102520113112405 Time :  7526
accuracy train: 0.996162 val: 0.969091 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({0: 3865, 1: 3826})

Epoch :  22 loss training:  2.871111746819224 Time :  7544
accuracy train: 0.996162 val: 0.978182 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({0: 3871, 1: 3820})

Epoch :  23 loss training:  2.654115190729499 Time :  7567
accuracy train: 0.995960 val: 0.970909 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({1: 3881, 0: 3810})

Epoch :  24 loss training:  2.2469676120672375 Time :  7590
accuracy train: 0.996768 val: 0.974545 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({1: 3882, 0: 3809})

Epoch :  25 loss training:  2.1328782342898194 Time :  7614
accuracy train: 0.996566 val: 0.965455 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({0: 3882, 1: 3809})

Epoch :  26 loss training:  2.2039346670208033 Time :  7634
accuracy train: 0.996364 val: 0.965455 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({0: 3881, 1: 3810})

Epoch :  27 loss training:  1.9761537465674337 Time :  7654
accuracy train: 0.996364 val: 0.958182 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({0: 3883, 1: 3808})

Epoch :  28 loss training:  1.9647880737902597 Time :  7674
accuracy train: 0.996768 val: 0.967273 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({1: 3885, 0: 3806})

Epoch :  29 loss training:  1.7011216448881896 Time :  7698
accuracy train: 0.996364 val: 0.970909 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({1: 3890, 0: 3801})

Epoch :  30 loss training:  2.045288482506294 Time :  7727
accuracy train: 0.996768 val: 0.965455 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({1: 3890, 0: 3801})

Epoch :  31 loss training:  1.7890843233544729 Time :  7750
accuracy train: 0.996970 val: 0.970909 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({0: 3891, 1: 3800})

Epoch :  32 loss training:  1.7855983034387464 Time :  7774
accuracy train: 0.996364 val: 0.967273 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({0: 3896, 1: 3795})

Epoch :  33 loss training:  1.7154470546956873 Time :  7792
accuracy train: 0.996768 val: 0.965455 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({0: 3896, 1: 3795})

Epoch :  34 loss training:  1.8291884856807883 Time :  7813
accuracy train: 0.996566 val: 0.969091 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({1: 3902, 0: 3789})

Epoch :  35 loss training:  1.6852594288502587 Time :  7840
accuracy train: 0.996768 val: 0.965455 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({1: 3902, 0: 3789})

Epoch :  36 loss training:  1.5642960160112125 Time :  7863
accuracy train: 0.997172 val: 0.967273 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({0: 3902, 1: 3789})

Epoch :  37 loss training:  2.1773492917564 Time :  7882
accuracy train: 0.996768 val: 0.969091 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({0: 3904, 1: 3787})

Epoch :  38 loss training:  1.6943903343344573 Time :  7902
accuracy train: 0.996970 val: 0.960000 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({0: 3903, 1: 3788})

Epoch :  39 loss training:  1.749825289218279 Time :  7924
accuracy train: 0.996768 val: 0.958182 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({1: 3903, 0: 3788})

Epoch :  40 loss training:  1.6603293268271955 Time :  7949
accuracy train: 0.996364 val: 0.958182 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({0: 3904, 1: 3787})

Epoch :  41 loss training:  1.625249522687227 Time :  7971
accuracy train: 0.996364 val: 0.956364 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({0: 3904, 1: 3787})

Epoch :  42 loss training:  1.6343080534425098 Time :  7991
accuracy train: 0.996768 val: 0.963636 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({0: 3904, 1: 3787})

Epoch :  43 loss training:  1.4752003734975006 Time :  8010
accuracy train: 0.997172 val: 0.958182 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({0: 3903, 1: 3788})

Epoch :  44 loss training:  1.3048088331270264 Time :  8031
accuracy train: 0.996970 val: 0.960000 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({1: 3903, 0: 3788})

Epoch :  45 loss training:  1.218131110239483 Time :  8056
accuracy train: 0.997172 val: 0.960000 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({1: 3903, 0: 3788})

Epoch :  46 loss training:  1.3134663629971328 Time :  8098
accuracy train: 0.996970 val: 0.960000 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973516
Counter({0: 3903, 1: 3788})

========================================================================================================================================================================================================
max acc epoch :  15
max validation accuracy :  0.9781818181818182
test accuracy :  0.9735159817351599
last test_accuracy :  0.9739726027397261
max gap 10
========================================================================================================================================================================================================

itr : 8
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=535, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4721, 0: 2970})

Epoch :  1 loss training:  38.336386762559414 Time :  8127
accuracy train: 0.962230 val: 0.938182 test: 0.960274
max validation accuracy : 0.938182 max acc epoch : 1 test accuracy : 0.960274
Counter({1: 3966, 0: 3725})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.407938715070486 Time :  8148
accuracy train: 0.975359 val: 0.963636 test: 0.971233
max validation accuracy : 0.963636 max acc epoch : 2 test accuracy : 0.971233
Counter({1: 3951, 0: 3740})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.166693402221426 Time :  8176
accuracy train: 0.974955 val: 0.961818 test: 0.963927
max validation accuracy : 0.963636 max acc epoch : 2 test accuracy : 0.971233
Counter({0: 3944, 1: 3747})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.817431758157909 Time :  8198
accuracy train: 0.985054 val: 0.965455 test: 0.971233
max validation accuracy : 0.965455 max acc epoch : 4 test accuracy : 0.971233
Counter({1: 3936, 0: 3755})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.201440542470664 Time :  8216
accuracy train: 0.988285 val: 0.976364 test: 0.967123
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.967123
Counter({1: 3921, 0: 3770})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.149544313549995 Time :  8239
accuracy train: 0.983034 val: 0.956364 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.967123
Counter({0: 3930, 1: 3761})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.766661283094436 Time :  8258
accuracy train: 0.990103 val: 0.970909 test: 0.976712
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.967123
Counter({0: 3927, 1: 3764})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.09084289742168 Time :  8276
accuracy train: 0.991719 val: 0.972727 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.967123
Counter({1: 3916, 0: 3775})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.656372362805996 Time :  8296
accuracy train: 0.990507 val: 0.969091 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.967123
Counter({1: 3909, 0: 3782})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  4.9181152493692935 Time :  8328
accuracy train: 0.991113 val: 0.972727 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.967123
Counter({1: 3906, 0: 3785})

Epoch :  11 loss training:  4.969228851376101 Time :  8350
accuracy train: 0.992931 val: 0.969091 test: 0.975342
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.967123
Counter({1: 3903, 0: 3788})

Epoch :  12 loss training:  4.9835731035564095 Time :  8371
accuracy train: 0.993739 val: 0.965455 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.967123
Counter({1: 3900, 0: 3791})

Epoch :  13 loss training:  4.245285112177953 Time :  8396
accuracy train: 0.993941 val: 0.976364 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.967123
Counter({0: 3892, 1: 3799})

Epoch :  14 loss training:  3.8042622982466128 Time :  8424
accuracy train: 0.995152 val: 0.974545 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 5 test accuracy : 0.967123
Counter({0: 3889, 1: 3802})

Epoch :  15 loss training:  3.557743916840991 Time :  8445
accuracy train: 0.995152 val: 0.978182 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({0: 3877, 1: 3814})

Epoch :  16 loss training:  3.441028284985805 Time :  8464
accuracy train: 0.994951 val: 0.976364 test: 0.977169
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({1: 3872, 0: 3819})

Epoch :  17 loss training:  3.4879605792084476 Time :  8487
accuracy train: 0.995758 val: 0.969091 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({0: 3869, 1: 3822})

Epoch :  18 loss training:  3.59056162298657 Time :  8513
accuracy train: 0.995758 val: 0.972727 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({0: 3855, 1: 3836})

Epoch :  19 loss training:  3.0788776333793066 Time :  8537
accuracy train: 0.996162 val: 0.969091 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({0: 3854, 1: 3837})

Epoch :  20 loss training:  2.802583653421607 Time :  8556
accuracy train: 0.996162 val: 0.965455 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({0: 3849, 1: 3842})

Epoch :  21 loss training:  2.7459611736412626 Time :  8577
accuracy train: 0.996364 val: 0.967273 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({0: 3852, 1: 3839})

Epoch :  22 loss training:  2.907118560106028 Time :  8604
accuracy train: 0.996364 val: 0.974545 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({1: 3862, 0: 3829})

Epoch :  23 loss training:  2.7495269813225605 Time :  8628
accuracy train: 0.995556 val: 0.970909 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({0: 3865, 1: 3826})

Epoch :  24 loss training:  2.2805565096787177 Time :  8647
accuracy train: 0.996768 val: 0.978182 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({1: 3868, 0: 3823})

Epoch :  25 loss training:  2.146763664626633 Time :  8668
accuracy train: 0.996364 val: 0.961818 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({0: 3868, 1: 3823})

Epoch :  26 loss training:  2.243889817269519 Time :  8696
accuracy train: 0.996364 val: 0.976364 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({0: 3875, 1: 3816})

Epoch :  27 loss training:  2.0642867039714474 Time :  8721
accuracy train: 0.996364 val: 0.958182 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({1: 3875, 0: 3816})

Epoch :  28 loss training:  1.981262949120719 Time :  8739
accuracy train: 0.997172 val: 0.972727 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({1: 3875, 0: 3816})

Epoch :  29 loss training:  1.7159390730957966 Time :  8761
accuracy train: 0.996566 val: 0.970909 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({1: 3880, 0: 3811})

Epoch :  30 loss training:  1.9309508808073588 Time :  8793
accuracy train: 0.996768 val: 0.967273 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({1: 3881, 0: 3810})

Epoch :  31 loss training:  1.6698717082908843 Time :  8815
accuracy train: 0.996970 val: 0.969091 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({0: 3881, 1: 3810})

Epoch :  32 loss training:  1.8025962838582927 Time :  8837
accuracy train: 0.996364 val: 0.969091 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({0: 3888, 1: 3803})

Epoch :  33 loss training:  1.6923341254732804 Time :  8860
accuracy train: 0.996970 val: 0.967273 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({1: 3888, 0: 3803})

Epoch :  34 loss training:  1.7894710634354851 Time :  8882
accuracy train: 0.996566 val: 0.967273 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({1: 3891, 0: 3800})

Epoch :  35 loss training:  1.7374277406051988 Time :  8905
accuracy train: 0.996768 val: 0.967273 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({0: 3892, 1: 3799})

Epoch :  36 loss training:  1.6038025865564123 Time :  8929
accuracy train: 0.996970 val: 0.965455 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({1: 3892, 0: 3799})

Epoch :  37 loss training:  2.1642104006168665 Time :  8950
accuracy train: 0.996970 val: 0.969091 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({1: 3896, 0: 3795})

Epoch :  38 loss training:  1.5153544545828481 Time :  8968
accuracy train: 0.996970 val: 0.967273 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({0: 3896, 1: 3795})

Epoch :  39 loss training:  1.7982927213379298 Time :  8990
accuracy train: 0.996768 val: 0.963636 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({1: 3898, 0: 3793})

Epoch :  40 loss training:  1.8067596133914776 Time :  9015
accuracy train: 0.996162 val: 0.956364 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({0: 3898, 1: 3793})

Epoch :  41 loss training:  1.6226999690661614 Time :  9039
accuracy train: 0.996364 val: 0.960000 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({0: 3898, 1: 3793})

Epoch :  42 loss training:  1.5690152902752743 Time :  9058
accuracy train: 0.996768 val: 0.967273 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({0: 3901, 1: 3790})

Epoch :  43 loss training:  1.5486511112612789 Time :  9081
accuracy train: 0.997576 val: 0.956364 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({0: 3900, 1: 3791})

Epoch :  44 loss training:  1.2885169720029808 Time :  9100
accuracy train: 0.996768 val: 0.960000 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({1: 3900, 0: 3791})

Epoch :  45 loss training:  1.2035884972210624 Time :  9118
accuracy train: 0.996970 val: 0.960000 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({1: 3900, 0: 3791})

Epoch :  46 loss training:  1.3549543877525139 Time :  9134
accuracy train: 0.996970 val: 0.958182 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973059
Counter({0: 3900, 1: 3791})

========================================================================================================================================================================================================
max acc epoch :  15
max validation accuracy :  0.9781818181818182
test accuracy :  0.9730593607305936
last test_accuracy :  0.9730593607305936
max gap 10
========================================================================================================================================================================================================

itr : 9
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=535, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4721, 0: 2970})

Epoch :  1 loss training:  38.39449238590896 Time :  9158
accuracy train: 0.963644 val: 0.938182 test: 0.962100
max validation accuracy : 0.938182 max acc epoch : 1 test accuracy : 0.962100
Counter({1: 3970, 0: 3721})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.294604134745896 Time :  9176
accuracy train: 0.976166 val: 0.963636 test: 0.970320
max validation accuracy : 0.963636 max acc epoch : 2 test accuracy : 0.970320
Counter({0: 3951, 1: 3740})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.469096107175574 Time :  9192
accuracy train: 0.974551 val: 0.965455 test: 0.963014
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.963014
Counter({1: 3938, 0: 3753})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.88133403356187 Time :  9211
accuracy train: 0.985256 val: 0.963636 test: 0.970320
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.963014
Counter({0: 3910, 1: 3781})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.205391795374453 Time :  9231
accuracy train: 0.988689 val: 0.970909 test: 0.967580
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.967580
Counter({1: 3908, 0: 3783})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.159978212905116 Time :  9249
accuracy train: 0.980206 val: 0.950909 test: 0.965753
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.967580
Counter({0: 3921, 1: 3770})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.735577648272738 Time :  9264
accuracy train: 0.989497 val: 0.969091 test: 0.976712
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.967580
Counter({0: 3917, 1: 3774})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.864563458017074 Time :  9283
accuracy train: 0.991517 val: 0.974545 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.970776
Counter({1: 3911, 0: 3780})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.618785188940819 Time :  9302
accuracy train: 0.990305 val: 0.972727 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.970776
Counter({0: 3901, 1: 3790})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  4.998209118610248 Time :  9318
accuracy train: 0.991517 val: 0.972727 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.970776
Counter({0: 3899, 1: 3792})

Epoch :  11 loss training:  5.016722897998989 Time :  9338
accuracy train: 0.993335 val: 0.970909 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.970776
Counter({0: 3896, 1: 3795})

Epoch :  12 loss training:  4.846275930758566 Time :  9357
accuracy train: 0.993335 val: 0.970909 test: 0.974429
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.970776
Counter({1: 3888, 0: 3803})

Epoch :  13 loss training:  4.272149728960358 Time :  9377
accuracy train: 0.993537 val: 0.974545 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.970776
Counter({0: 3884, 1: 3807})

Epoch :  14 loss training:  3.931562255631434 Time :  9394
accuracy train: 0.995556 val: 0.978182 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({0: 3877, 1: 3814})

Epoch :  15 loss training:  3.593417889031116 Time :  9412
accuracy train: 0.995758 val: 0.978182 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({0: 3865, 1: 3826})

Epoch :  16 loss training:  3.541935963148717 Time :  9433
accuracy train: 0.994749 val: 0.976364 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({1: 3860, 0: 3831})

Epoch :  17 loss training:  3.396948097331915 Time :  9452
accuracy train: 0.995758 val: 0.969091 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({1: 3858, 0: 3833})

Epoch :  18 loss training:  3.3227026064996608 Time :  9470
accuracy train: 0.995758 val: 0.976364 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({1: 3846, 0: 3845})

Epoch :  19 loss training:  3.02638178653433 Time :  9488
accuracy train: 0.995960 val: 0.970909 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({0: 3846, 1: 3845})

Epoch :  20 loss training:  2.709522416786058 Time :  9511
accuracy train: 0.996364 val: 0.972727 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({1: 3849, 0: 3842})

Epoch :  21 loss training:  2.7023384168278426 Time :  9528
accuracy train: 0.996364 val: 0.970909 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({1: 3857, 0: 3834})

Epoch :  22 loss training:  2.833599938894622 Time :  9544
accuracy train: 0.995960 val: 0.976364 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({1: 3869, 0: 3822})

Epoch :  23 loss training:  2.659475033171475 Time :  9563
accuracy train: 0.995960 val: 0.970909 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({0: 3870, 1: 3821})

Epoch :  24 loss training:  2.3150846248609014 Time :  9582
accuracy train: 0.996566 val: 0.976364 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({1: 3872, 0: 3819})

Epoch :  25 loss training:  2.0757289760149433 Time :  9598
accuracy train: 0.996566 val: 0.967273 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({1: 3871, 0: 3820})

Epoch :  26 loss training:  2.1766321516479366 Time :  9614
accuracy train: 0.996162 val: 0.976364 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({1: 3874, 0: 3817})

Epoch :  27 loss training:  2.0231350834073965 Time :  9632
accuracy train: 0.996364 val: 0.956364 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({1: 3873, 0: 3818})

Epoch :  28 loss training:  1.9877067605557386 Time :  9658
accuracy train: 0.997172 val: 0.972727 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({0: 3873, 1: 3818})

Epoch :  29 loss training:  1.7405186830292223 Time :  9676
accuracy train: 0.996768 val: 0.970909 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({0: 3882, 1: 3809})

Epoch :  30 loss training:  1.9503287231782451 Time :  9693
accuracy train: 0.996970 val: 0.969091 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({0: 3883, 1: 3808})

Epoch :  31 loss training:  1.6728883766772924 Time :  9709
accuracy train: 0.996768 val: 0.967273 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({0: 3885, 1: 3806})

Epoch :  32 loss training:  1.7832679023267701 Time :  9728
accuracy train: 0.996364 val: 0.970909 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({0: 3887, 1: 3804})

Epoch :  33 loss training:  1.6183507524910965 Time :  9749
accuracy train: 0.996768 val: 0.969091 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({1: 3888, 0: 3803})

Epoch :  34 loss training:  1.7859761771542253 Time :  9767
accuracy train: 0.996970 val: 0.970909 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({1: 3893, 0: 3798})

Epoch :  35 loss training:  1.6740652460721321 Time :  9783
accuracy train: 0.996768 val: 0.963636 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({0: 3893, 1: 3798})

Epoch :  36 loss training:  1.631173826448503 Time :  9803
accuracy train: 0.996970 val: 0.967273 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({1: 3894, 0: 3797})

Epoch :  37 loss training:  2.1549425142802647 Time :  9827
accuracy train: 0.996768 val: 0.969091 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({1: 3899, 0: 3792})

Epoch :  38 loss training:  1.4737901965272613 Time :  9846
accuracy train: 0.996970 val: 0.974545 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({0: 3900, 1: 3791})

Epoch :  39 loss training:  1.843029999268765 Time :  9864
accuracy train: 0.996768 val: 0.965455 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({1: 3902, 0: 3789})

Epoch :  40 loss training:  2.1979026387489284 Time :  9880
accuracy train: 0.996364 val: 0.958182 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({0: 3903, 1: 3788})

Epoch :  41 loss training:  1.637936392759002 Time :  9899
accuracy train: 0.996364 val: 0.956364 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({1: 3903, 0: 3788})

Epoch :  42 loss training:  1.6311311902609305 Time :  9918
accuracy train: 0.996768 val: 0.965455 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({0: 3904, 1: 3787})

Epoch :  43 loss training:  1.5630250809990685 Time :  9935
accuracy train: 0.996566 val: 0.958182 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({0: 3904, 1: 3787})

Epoch :  44 loss training:  1.3056153120996896 Time :  9951
accuracy train: 0.996970 val: 0.958182 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({1: 3904, 0: 3787})

Epoch :  45 loss training:  1.2181327688922465 Time :  9970
accuracy train: 0.996970 val: 0.958182 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.973059
Counter({1: 3904, 0: 3787})

========================================================================================================================================================================================================
max acc epoch :  14
max validation accuracy :  0.9781818181818182
test accuracy :  0.9730593607305936
last test_accuracy :  0.9721461187214612
max gap 6
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.97818 	 test_accuracy : 0.97489 	 max_acc epoch :  15 	 last test_accuracy : 0.97489
k :  1 	 val_accuracy : 0.97818 	 test_accuracy : 0.97123 	 max_acc epoch :  15 	 last test_accuracy : 0.97352
k :  2 	 val_accuracy : 0.97818 	 test_accuracy : 0.97260 	 max_acc epoch :  15 	 last test_accuracy : 0.97306
k :  3 	 val_accuracy : 0.97818 	 test_accuracy : 0.97123 	 max_acc epoch :  15 	 last test_accuracy : 0.97397
k :  4 	 val_accuracy : 0.97818 	 test_accuracy : 0.97123 	 max_acc epoch :  15 	 last test_accuracy : 0.97215
k :  5 	 val_accuracy : 0.97818 	 test_accuracy : 0.97123 	 max_acc epoch :  15 	 last test_accuracy : 0.97489
k :  6 	 val_accuracy : 0.97818 	 test_accuracy : 0.97123 	 max_acc epoch :  15 	 last test_accuracy : 0.97352
k :  7 	 val_accuracy : 0.97818 	 test_accuracy : 0.97352 	 max_acc epoch :  15 	 last test_accuracy : 0.97397
k :  8 	 val_accuracy : 0.97818 	 test_accuracy : 0.97306 	 max_acc epoch :  15 	 last test_accuracy : 0.97306
k :  9 	 val_accuracy : 0.97818 	 test_accuracy : 0.97306 	 max_acc epoch :  14 	 last test_accuracy : 0.97215

avg :  	 val_accuracy : 0.97818 	 test_accuracy : 0.97233 	 last_accuracy : 0.97352
