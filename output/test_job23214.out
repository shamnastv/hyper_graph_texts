date and time :  Tue Jan 26 15:41:44 2021
Namespace(batch_size=16, dataset='R52', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=1e-06)
device :  cuda:0
HGNNModel(
  (word_embeddings): Embedding(9333, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=52, bias=True)
    (1): Linear(in_features=200, out_features=52, bias=True)
    (2): Linear(in_features=200, out_features=52, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
)
Epoch :  1 loss training:  298.71939238067716 Time :  13
accuracy train: 0.923950 val: 0.897866 test: 0.898054
max validation accuracy : 0.8978658536585366 max acc epoch : 1 test accuracy : 0.8980544747081712

Epoch :  2 loss training:  114.32614487828687 Time :  20
accuracy train: 0.951050 val: 0.923780 test: 0.921401
max validation accuracy : 0.9237804878048781 max acc epoch : 2 test accuracy : 0.9214007782101167

Epoch :  3 loss training:  78.04213547636755 Time :  28
accuracy train: 0.976118 val: 0.931402 test: 0.924125
max validation accuracy : 0.9314024390243902 max acc epoch : 3 test accuracy : 0.9241245136186771

Epoch :  4 loss training:  58.20426139375195 Time :  35
accuracy train: 0.981199 val: 0.939024 test: 0.932685
max validation accuracy : 0.9390243902439024 max acc epoch : 4 test accuracy : 0.9326848249027238

Epoch :  5 loss training:  45.841785950702615 Time :  43
accuracy train: 0.980352 val: 0.934451 test: 0.932296
max validation accuracy : 0.9390243902439024 max acc epoch : 4 test accuracy : 0.9326848249027238

Epoch :  6 loss training:  39.57979930238798 Time :  51
accuracy train: 0.980183 val: 0.931402 test: 0.932685
max validation accuracy : 0.9390243902439024 max acc epoch : 4 test accuracy : 0.9326848249027238

Epoch :  7 loss training:  33.29728002182674 Time :  59
accuracy train: 0.991362 val: 0.931402 test: 0.936187
max validation accuracy : 0.9390243902439024 max acc epoch : 4 test accuracy : 0.9326848249027238

Epoch :  8 loss training:  28.68437236326281 Time :  67
accuracy train: 0.990007 val: 0.939024 test: 0.931518
max validation accuracy : 0.9390243902439024 max acc epoch : 4 test accuracy : 0.9326848249027238

Epoch :  9 loss training:  28.87243281339761 Time :  74
accuracy train: 0.979844 val: 0.926829 test: 0.928794
max validation accuracy : 0.9390243902439024 max acc epoch : 4 test accuracy : 0.9326848249027238

Epoch :  10 loss training:  23.663280788707198 Time :  82
accuracy train: 0.992039 val: 0.932927 test: 0.935798
max validation accuracy : 0.9390243902439024 max acc epoch : 4 test accuracy : 0.9326848249027238

Epoch :  11 loss training:  23.301449455910188 Time :  90
accuracy train: 0.985095 val: 0.939024 test: 0.929572
max validation accuracy : 0.9390243902439024 max acc epoch : 4 test accuracy : 0.9326848249027238

Epoch :  12 loss training:  21.10519736915012 Time :  98
accuracy train: 0.994411 val: 0.939024 test: 0.930739
max validation accuracy : 0.9390243902439024 max acc epoch : 4 test accuracy : 0.9326848249027238

Epoch :  13 loss training:  15.099115828154027 Time :  106
accuracy train: 0.995088 val: 0.937500 test: 0.933852
max validation accuracy : 0.9390243902439024 max acc epoch : 4 test accuracy : 0.9326848249027238

Epoch :  14 loss training:  18.52709334667452 Time :  113
accuracy train: 0.991701 val: 0.942073 test: 0.922179
max validation accuracy : 0.9420731707317073 max acc epoch : 14 test accuracy : 0.9221789883268483

Epoch :  15 loss training:  18.04611244497437 Time :  121
accuracy train: 0.993225 val: 0.937500 test: 0.923735
max validation accuracy : 0.9420731707317073 max acc epoch : 14 test accuracy : 0.9221789883268483

Epoch :  16 loss training:  14.180970192104724 Time :  129
accuracy train: 0.996782 val: 0.946646 test: 0.935798
max validation accuracy : 0.9466463414634146 max acc epoch : 16 test accuracy : 0.9357976653696498

Epoch :  17 loss training:  14.457334465649183 Time :  137
accuracy train: 0.993733 val: 0.937500 test: 0.932685
max validation accuracy : 0.9466463414634146 max acc epoch : 16 test accuracy : 0.9357976653696498

Epoch :  18 loss training:  13.203218964041298 Time :  145
accuracy train: 0.992378 val: 0.934451 test: 0.926848
max validation accuracy : 0.9466463414634146 max acc epoch : 16 test accuracy : 0.9357976653696498

Epoch :  19 loss training:  12.92289342310687 Time :  157
accuracy train: 0.995766 val: 0.951220 test: 0.938911
max validation accuracy : 0.9512195121951219 max acc epoch : 19 test accuracy : 0.9389105058365759

Epoch :  20 loss training:  11.387203120026243 Time :  169
accuracy train: 0.997290 val: 0.954268 test: 0.922568
max validation accuracy : 0.9542682926829268 max acc epoch : 20 test accuracy : 0.9225680933852141

Epoch :  21 loss training:  11.2356837685129 Time :  180
accuracy train: 0.997121 val: 0.945122 test: 0.939300
max validation accuracy : 0.9542682926829268 max acc epoch : 20 test accuracy : 0.9225680933852141

Epoch :  22 loss training:  10.921916212438191 Time :  190
accuracy train: 0.993394 val: 0.935976 test: 0.928016
max validation accuracy : 0.9542682926829268 max acc epoch : 20 test accuracy : 0.9225680933852141

Epoch :  23 loss training:  11.463539128646516 Time :  201
accuracy train: 0.995088 val: 0.951220 test: 0.929183
max validation accuracy : 0.9542682926829268 max acc epoch : 20 test accuracy : 0.9225680933852141

Epoch :  24 loss training:  13.118965867783118 Time :  213
accuracy train: 0.994072 val: 0.940549 test: 0.921401
max validation accuracy : 0.9542682926829268 max acc epoch : 20 test accuracy : 0.9225680933852141

Epoch :  25 loss training:  9.964323845963008 Time :  225
accuracy train: 0.996782 val: 0.940549 test: 0.932685
max validation accuracy : 0.9542682926829268 max acc epoch : 20 test accuracy : 0.9225680933852141

Epoch :  26 loss training:  9.273069561320881 Time :  237
accuracy train: 0.995935 val: 0.929878 test: 0.933852
max validation accuracy : 0.9542682926829268 max acc epoch : 20 test accuracy : 0.9225680933852141

Epoch :  27 loss training:  10.027734900213545 Time :  249
accuracy train: 0.995427 val: 0.935976 test: 0.933852
max validation accuracy : 0.9542682926829268 max acc epoch : 20 test accuracy : 0.9225680933852141

Epoch :  28 loss training:  7.856011052846952 Time :  261
accuracy train: 0.996104 val: 0.929878 test: 0.931518
max validation accuracy : 0.9542682926829268 max acc epoch : 20 test accuracy : 0.9225680933852141

Epoch :  29 loss training:  8.19052645948068 Time :  271
accuracy train: 0.995427 val: 0.931402 test: 0.924514
max validation accuracy : 0.9542682926829268 max acc epoch : 20 test accuracy : 0.9225680933852141

Epoch :  30 loss training:  11.45904141929077 Time :  281
accuracy train: 0.996612 val: 0.942073 test: 0.933463
max validation accuracy : 0.9542682926829268 max acc epoch : 20 test accuracy : 0.9225680933852141

Epoch :  31 loss training:  8.311900919920845 Time :  292
accuracy train: 0.996274 val: 0.935976 test: 0.935019
max validation accuracy : 0.9542682926829268 max acc epoch : 20 test accuracy : 0.9225680933852141

Epoch :  32 loss training:  10.56445200982671 Time :  303
accuracy train: 0.993733 val: 0.926829 test: 0.929961
max validation accuracy : 0.9542682926829268 max acc epoch : 20 test accuracy : 0.9225680933852141

Epoch :  33 loss training:  9.247540259195375 Time :  315
accuracy train: 0.996443 val: 0.934451 test: 0.937354
max validation accuracy : 0.9542682926829268 max acc epoch : 20 test accuracy : 0.9225680933852141

Epoch :  34 loss training:  6.938743142228304 Time :  326
accuracy train: 0.997967 val: 0.948171 test: 0.937354
max validation accuracy : 0.9542682926829268 max acc epoch : 20 test accuracy : 0.9225680933852141

Epoch :  35 loss training:  6.496497847224418 Time :  337
accuracy train: 0.997798 val: 0.943598 test: 0.935019
max validation accuracy : 0.9542682926829268 max acc epoch : 20 test accuracy : 0.9225680933852141

Epoch :  36 loss training:  8.562116149092617 Time :  347
accuracy train: 0.996274 val: 0.937500 test: 0.932685
max validation accuracy : 0.9542682926829268 max acc epoch : 20 test accuracy : 0.9225680933852141

Epoch :  37 loss training:  8.8336194177391 Time :  358
accuracy train: 0.997459 val: 0.939024 test: 0.932685
max validation accuracy : 0.9542682926829268 max acc epoch : 20 test accuracy : 0.9225680933852141

Epoch :  38 loss training:  7.162630149000506 Time :  368
accuracy train: 0.996951 val: 0.935976 test: 0.931128
max validation accuracy : 0.9542682926829268 max acc epoch : 20 test accuracy : 0.9225680933852141

Epoch :  39 loss training:  7.39000385382451 Time :  378
accuracy train: 0.996782 val: 0.943598 test: 0.929961
max validation accuracy : 0.9542682926829268 max acc epoch : 20 test accuracy : 0.9225680933852141

Epoch :  40 loss training:  7.416007279487303 Time :  390
accuracy train: 0.996951 val: 0.942073 test: 0.931518
max validation accuracy : 0.9542682926829268 max acc epoch : 20 test accuracy : 0.9225680933852141

Epoch :  41 loss training:  7.441950726156392 Time :  400
accuracy train: 0.994241 val: 0.946646 test: 0.924514
max validation accuracy : 0.9542682926829268 max acc epoch : 20 test accuracy : 0.9225680933852141

========================================================================================================================================================================================================
max acc epoch :  20
max validation accuracy :  0.9542682926829268
test accuracy :  0.9225680933852141
latest_test_accuracy :  0.9245136186770428
========================================================================================================================================================================================================

