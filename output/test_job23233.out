date and time :  Tue Jan 26 19:41:52 2021
Namespace(batch_size=16, dataset='R52', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_layers=3, num_mlp_layers=1, random_vec=True, seed=0, weight_decay=1e-05)
device :  cuda:0
HGNNModel(
  (word_embeddings): Embedding(9333, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=52, bias=True)
    (1): Linear(in_features=200, out_features=52, bias=True)
    (2): Linear(in_features=200, out_features=52, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  389.15234274044633 Time :  13
accuracy train: 0.893462 val: 0.876524 test: 0.854864
max validation accuracy : 0.876524 max acc epoch : 1.000000 test accuracy : 0.854864

Epoch :  2 loss training:  163.49208929017186 Time :  25
accuracy train: 0.940549 val: 0.896341 test: 0.889105
max validation accuracy : 0.896341 max acc epoch : 2.000000 test accuracy : 0.889105

Epoch :  3 loss training:  103.42944246623665 Time :  36
accuracy train: 0.976626 val: 0.916159 test: 0.898833
max validation accuracy : 0.916159 max acc epoch : 3.000000 test accuracy : 0.898833

Epoch :  4 loss training:  62.436978419544175 Time :  46
accuracy train: 0.987636 val: 0.923780 test: 0.912451
max validation accuracy : 0.923780 max acc epoch : 4.000000 test accuracy : 0.912451

Epoch :  5 loss training:  46.075711738551036 Time :  57
accuracy train: 0.993225 val: 0.928354 test: 0.910117
max validation accuracy : 0.928354 max acc epoch : 5.000000 test accuracy : 0.910117

Epoch :  6 loss training:  28.168695661384845 Time :  67
accuracy train: 0.996612 val: 0.929878 test: 0.911673
max validation accuracy : 0.929878 max acc epoch : 6.000000 test accuracy : 0.911673

Epoch :  7 loss training:  18.823023657896556 Time :  79
accuracy train: 0.996443 val: 0.928354 test: 0.910506
max validation accuracy : 0.929878 max acc epoch : 6.000000 test accuracy : 0.911673

Epoch :  8 loss training:  15.54198284712038 Time :  91
accuracy train: 0.998645 val: 0.928354 test: 0.915953
max validation accuracy : 0.929878 max acc epoch : 6.000000 test accuracy : 0.911673

Epoch :  9 loss training:  14.152168379951036 Time :  102
accuracy train: 0.997967 val: 0.932927 test: 0.914397
max validation accuracy : 0.932927 max acc epoch : 9.000000 test accuracy : 0.914397

Epoch :  10 loss training:  11.91486894783884 Time :  114
accuracy train: 0.998137 val: 0.932927 test: 0.914397
max validation accuracy : 0.932927 max acc epoch : 9.000000 test accuracy : 0.914397

Epoch :  11 loss training:  10.645778195306775 Time :  124
accuracy train: 0.998645 val: 0.931402 test: 0.912062
max validation accuracy : 0.932927 max acc epoch : 9.000000 test accuracy : 0.914397

Epoch :  12 loss training:  8.373933058741386 Time :  135
accuracy train: 0.998476 val: 0.932927 test: 0.913230
max validation accuracy : 0.932927 max acc epoch : 9.000000 test accuracy : 0.914397

Epoch :  13 loss training:  7.246878016136179 Time :  147
accuracy train: 0.999153 val: 0.934451 test: 0.912062
max validation accuracy : 0.934451 max acc epoch : 13.000000 test accuracy : 0.912062

Epoch :  14 loss training:  7.133170802422683 Time :  157
accuracy train: 0.998814 val: 0.926829 test: 0.911673
max validation accuracy : 0.934451 max acc epoch : 13.000000 test accuracy : 0.912062

Epoch :  15 loss training:  6.608382608603279 Time :  170
accuracy train: 0.999153 val: 0.934451 test: 0.914008
max validation accuracy : 0.934451 max acc epoch : 13.000000 test accuracy : 0.912062

Epoch :  16 loss training:  5.966337434620073 Time :  180
accuracy train: 0.998984 val: 0.935976 test: 0.914786
max validation accuracy : 0.935976 max acc epoch : 16.000000 test accuracy : 0.914786

Epoch :  17 loss training:  3.9858341731742257 Time :  191
accuracy train: 0.998984 val: 0.934451 test: 0.913230
max validation accuracy : 0.935976 max acc epoch : 16.000000 test accuracy : 0.914786

Epoch :  18 loss training:  4.034611600462085 Time :  202
accuracy train: 0.998984 val: 0.934451 test: 0.910895
max validation accuracy : 0.935976 max acc epoch : 16.000000 test accuracy : 0.914786

Epoch :  19 loss training:  4.9895357838358905 Time :  214
accuracy train: 0.998645 val: 0.934451 test: 0.913230
max validation accuracy : 0.935976 max acc epoch : 16.000000 test accuracy : 0.914786

Epoch :  20 loss training:  3.4718182494980283 Time :  225
accuracy train: 0.999153 val: 0.932927 test: 0.914008
max validation accuracy : 0.935976 max acc epoch : 16.000000 test accuracy : 0.914786

Epoch :  21 loss training:  3.3417632874043193 Time :  237
accuracy train: 0.998984 val: 0.932927 test: 0.910117
max validation accuracy : 0.935976 max acc epoch : 16.000000 test accuracy : 0.914786

Epoch :  22 loss training:  4.479480670064731 Time :  248
accuracy train: 0.998814 val: 0.934451 test: 0.912062
max validation accuracy : 0.935976 max acc epoch : 16.000000 test accuracy : 0.914786

Epoch :  23 loss training:  3.1440463814633404 Time :  259
accuracy train: 0.998814 val: 0.935976 test: 0.912062
max validation accuracy : 0.935976 max acc epoch : 16.000000 test accuracy : 0.914786

Epoch :  24 loss training:  3.4748813300066104 Time :  270
accuracy train: 0.998814 val: 0.935976 test: 0.912451
max validation accuracy : 0.935976 max acc epoch : 16.000000 test accuracy : 0.914786

Epoch :  25 loss training:  2.9126996164686716 Time :  281
accuracy train: 0.998984 val: 0.934451 test: 0.911673
max validation accuracy : 0.935976 max acc epoch : 16.000000 test accuracy : 0.914786

Epoch :  26 loss training:  4.011229395298869 Time :  293
accuracy train: 0.998814 val: 0.934451 test: 0.911673
max validation accuracy : 0.935976 max acc epoch : 16.000000 test accuracy : 0.914786

Epoch :  27 loss training:  2.777945256944804 Time :  304
accuracy train: 0.998984 val: 0.932927 test: 0.910117
max validation accuracy : 0.935976 max acc epoch : 16.000000 test accuracy : 0.914786

Epoch :  28 loss training:  2.8258101313986117 Time :  313
accuracy train: 0.998984 val: 0.932927 test: 0.908949
max validation accuracy : 0.935976 max acc epoch : 16.000000 test accuracy : 0.914786

Epoch :  29 loss training:  2.5709506495950336 Time :  322
accuracy train: 0.998814 val: 0.939024 test: 0.910895
max validation accuracy : 0.939024 max acc epoch : 29.000000 test accuracy : 0.910895

Epoch :  30 loss training:  3.061363173295831 Time :  330
accuracy train: 0.998984 val: 0.932927 test: 0.911673
max validation accuracy : 0.939024 max acc epoch : 29.000000 test accuracy : 0.910895

Epoch :  31 loss training:  2.605236394426356 Time :  337
accuracy train: 0.998984 val: 0.932927 test: 0.911673
max validation accuracy : 0.939024 max acc epoch : 29.000000 test accuracy : 0.910895

Epoch :  32 loss training:  2.932309791519401 Time :  345
accuracy train: 0.998984 val: 0.939024 test: 0.910117
max validation accuracy : 0.939024 max acc epoch : 29.000000 test accuracy : 0.910895

Epoch :  33 loss training:  2.8292289303208236 Time :  353
accuracy train: 0.998984 val: 0.935976 test: 0.908949
max validation accuracy : 0.939024 max acc epoch : 29.000000 test accuracy : 0.910895

Epoch :  34 loss training:  3.2181950153526486 Time :  361
accuracy train: 0.998984 val: 0.932927 test: 0.910895
max validation accuracy : 0.939024 max acc epoch : 29.000000 test accuracy : 0.910895

Epoch :  35 loss training:  3.0464597965847133 Time :  370
accuracy train: 0.998984 val: 0.932927 test: 0.909728
max validation accuracy : 0.939024 max acc epoch : 29.000000 test accuracy : 0.910895

Epoch :  36 loss training:  2.5481201778238756 Time :  381
accuracy train: 0.998984 val: 0.932927 test: 0.910895
max validation accuracy : 0.939024 max acc epoch : 29.000000 test accuracy : 0.910895

Epoch :  37 loss training:  2.682032322489249 Time :  392
accuracy train: 0.998984 val: 0.934451 test: 0.910117
max validation accuracy : 0.939024 max acc epoch : 29.000000 test accuracy : 0.910895

Epoch :  38 loss training:  2.623268601431846 Time :  402
accuracy train: 0.998984 val: 0.932927 test: 0.910895
max validation accuracy : 0.939024 max acc epoch : 29.000000 test accuracy : 0.910895

Epoch :  39 loss training:  2.0537629946543916 Time :  412
accuracy train: 0.998984 val: 0.932927 test: 0.910506
max validation accuracy : 0.939024 max acc epoch : 29.000000 test accuracy : 0.910895

Epoch :  40 loss training:  2.399158456938949 Time :  423
accuracy train: 0.998984 val: 0.932927 test: 0.909339
max validation accuracy : 0.939024 max acc epoch : 29.000000 test accuracy : 0.910895

Epoch :  41 loss training:  2.750956768039032 Time :  433
accuracy train: 0.998814 val: 0.935976 test: 0.911284
max validation accuracy : 0.939024 max acc epoch : 29.000000 test accuracy : 0.910895

Epoch :  42 loss training:  2.0666844436791507 Time :  444
accuracy train: 0.998984 val: 0.934451 test: 0.911673
max validation accuracy : 0.939024 max acc epoch : 29.000000 test accuracy : 0.910895

Epoch :  43 loss training:  2.3535773006183263 Time :  455
accuracy train: 0.998984 val: 0.931402 test: 0.909728
max validation accuracy : 0.939024 max acc epoch : 29.000000 test accuracy : 0.910895

Epoch :  44 loss training:  2.9111946007078586 Time :  466
accuracy train: 0.998984 val: 0.931402 test: 0.911673
max validation accuracy : 0.939024 max acc epoch : 29.000000 test accuracy : 0.910895

Epoch :  45 loss training:  2.5997940282832133 Time :  476
accuracy train: 0.998984 val: 0.935976 test: 0.909339
max validation accuracy : 0.939024 max acc epoch : 29.000000 test accuracy : 0.910895

Epoch :  46 loss training:  2.034741173582006 Time :  487
accuracy train: 0.998814 val: 0.934451 test: 0.908560
max validation accuracy : 0.939024 max acc epoch : 29.000000 test accuracy : 0.910895

Epoch :  47 loss training:  2.4473214323734283 Time :  498
accuracy train: 0.998984 val: 0.934451 test: 0.909728
max validation accuracy : 0.939024 max acc epoch : 29.000000 test accuracy : 0.910895

Epoch :  48 loss training:  2.8056091370572176 Time :  508
accuracy train: 0.998814 val: 0.934451 test: 0.912451
max validation accuracy : 0.939024 max acc epoch : 29.000000 test accuracy : 0.910895

Epoch :  49 loss training:  2.6301394902566244 Time :  519
accuracy train: 0.998984 val: 0.931402 test: 0.911284
max validation accuracy : 0.939024 max acc epoch : 29.000000 test accuracy : 0.910895

Epoch :  50 loss training:  2.9713990254495 Time :  529
accuracy train: 0.998984 val: 0.932927 test: 0.908949
max validation accuracy : 0.939024 max acc epoch : 29.000000 test accuracy : 0.910895

========================================================================================================================================================================================================
max acc epoch :  29
max validation accuracy :  0.9390243902439024
test accuracy :  0.9108949416342412
latest_test_accuracy :  0.9089494163424124
========================================================================================================================================================================================================

