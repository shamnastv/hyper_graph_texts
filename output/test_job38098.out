

date and time :  Sun Jun 20 18:17:02 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=2, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=602, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  43.243698090314865 Time :  13
accuracy train: 0.956587 val: 0.944242 test: 0.955708
max validation accuracy : 0.944242 max acc epoch : 1 test accuracy : 0.955708
Counter({1: 4202, 0: 3489})

Epoch :  2 loss training:  18.077116396278143 Time :  28
accuracy train: 0.975620 val: 0.956364 test: 0.962557
max validation accuracy : 0.956364 max acc epoch : 2 test accuracy : 0.962557
Counter({0: 4116, 1: 3575})

Epoch :  3 loss training:  14.179081154055893 Time :  42
accuracy train: 0.971557 val: 0.956364 test: 0.959361
max validation accuracy : 0.956364 max acc epoch : 2 test accuracy : 0.962557
Counter({1: 4087, 0: 3604})

Epoch :  4 loss training:  11.869965338381007 Time :  55
accuracy train: 0.973695 val: 0.950303 test: 0.958904
max validation accuracy : 0.956364 max acc epoch : 2 test accuracy : 0.962557
Counter({0: 4032, 1: 3659})

Epoch :  5 loss training:  12.33586006751284 Time :  69
accuracy train: 0.973695 val: 0.943030 test: 0.960274
max validation accuracy : 0.956364 max acc epoch : 2 test accuracy : 0.962557
Counter({1: 3992, 0: 3699})

Epoch :  6 loss training:  10.718750355066732 Time :  83
accuracy train: 0.981394 val: 0.958788 test: 0.966210
max validation accuracy : 0.958788 max acc epoch : 6 test accuracy : 0.966210
Counter({1: 3959, 0: 3732})

Epoch :  7 loss training:  10.007376198424026 Time :  96
accuracy train: 0.982036 val: 0.963636 test: 0.965753
max validation accuracy : 0.963636 max acc epoch : 7 test accuracy : 0.965753
Counter({0: 3949, 1: 3742})

Epoch :  8 loss training:  8.576004578266293 Time :  110
accuracy train: 0.982464 val: 0.955152 test: 0.956621
max validation accuracy : 0.963636 max acc epoch : 7 test accuracy : 0.965753
Counter({1: 3943, 0: 3748})

Epoch :  9 loss training:  8.92055797460489 Time :  124
accuracy train: 0.990376 val: 0.963636 test: 0.966667
max validation accuracy : 0.963636 max acc epoch : 7 test accuracy : 0.965753
Counter({0: 3933, 1: 3758})

Epoch :  10 loss training:  7.763075007358566 Time :  137
accuracy train: 0.986741 val: 0.960000 test: 0.963927
max validation accuracy : 0.963636 max acc epoch : 7 test accuracy : 0.965753
Counter({1: 3913, 0: 3778})

Epoch :  11 loss training:  7.869374732486904 Time :  152
accuracy train: 0.990590 val: 0.963636 test: 0.962100
max validation accuracy : 0.963636 max acc epoch : 7 test accuracy : 0.965753
Counter({1: 3932, 0: 3759})

Epoch :  12 loss training:  6.396054989658296 Time :  167
accuracy train: 0.992943 val: 0.963636 test: 0.970320
max validation accuracy : 0.963636 max acc epoch : 7 test accuracy : 0.965753
Counter({0: 3890, 1: 3801})

Epoch :  13 loss training:  6.656149027287029 Time :  182
accuracy train: 0.984816 val: 0.952727 test: 0.962100
max validation accuracy : 0.963636 max acc epoch : 7 test accuracy : 0.965753
Counter({1: 3961, 0: 3730})

Epoch :  14 loss training:  5.209422257205006 Time :  196
accuracy train: 0.995081 val: 0.967273 test: 0.970320
max validation accuracy : 0.967273 max acc epoch : 14 test accuracy : 0.970320
Counter({0: 3902, 1: 3789})

Epoch :  15 loss training:  3.9066723595024087 Time :  211
accuracy train: 0.995937 val: 0.968485 test: 0.974886
max validation accuracy : 0.968485 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3872, 1: 3819})

Epoch :  16 loss training:  3.6153918189229444 Time :  225
accuracy train: 0.996578 val: 0.968485 test: 0.965297
max validation accuracy : 0.968485 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3848, 1: 3843})

Epoch :  17 loss training:  2.9058105686563067 Time :  240
accuracy train: 0.997006 val: 0.967273 test: 0.971689
max validation accuracy : 0.968485 max acc epoch : 15 test accuracy : 0.974886
Counter({1: 3846, 0: 3845})

Epoch :  18 loss training:  2.791953333595302 Time :  254
accuracy train: 0.996792 val: 0.967273 test: 0.973516
max validation accuracy : 0.968485 max acc epoch : 15 test accuracy : 0.974886
Counter({1: 3860, 0: 3831})

Epoch :  19 loss training:  2.6911517711996567 Time :  269
accuracy train: 0.996792 val: 0.973333 test: 0.968037
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({1: 3862, 0: 3829})

Epoch :  20 loss training:  2.246806250535883 Time :  282
accuracy train: 0.995937 val: 0.966061 test: 0.963470
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({0: 3881, 1: 3810})

Epoch :  21 loss training:  3.1429894411558053 Time :  297
accuracy train: 0.994654 val: 0.964848 test: 0.971689
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({0: 3859, 1: 3832})

Epoch :  22 loss training:  4.25185527082067 Time :  312
accuracy train: 0.996151 val: 0.968485 test: 0.963927
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({0: 3872, 1: 3819})

Epoch :  23 loss training:  5.671763029335125 Time :  327
accuracy train: 0.996578 val: 0.957576 test: 0.969863
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({1: 3849, 0: 3842})

Epoch :  24 loss training:  2.3146602174529107 Time :  341
accuracy train: 0.994440 val: 0.963636 test: 0.965753
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({0: 3885, 1: 3806})

Epoch :  25 loss training:  1.8028210716583999 Time :  356
accuracy train: 0.995937 val: 0.969697 test: 0.966667
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({1: 3910, 0: 3781})

Epoch :  26 loss training:  2.3284040604703478 Time :  371
accuracy train: 0.995937 val: 0.969697 test: 0.970320
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({0: 3888, 1: 3803})

Epoch :  27 loss training:  1.686460972086934 Time :  385
accuracy train: 0.997434 val: 0.970909 test: 0.970320
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({1: 3879, 0: 3812})

Epoch :  28 loss training:  1.970352309570444 Time :  400
accuracy train: 0.997006 val: 0.967273 test: 0.969406
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({0: 3898, 1: 3793})

Epoch :  29 loss training:  1.7119268467467919 Time :  415
accuracy train: 0.997006 val: 0.967273 test: 0.971233
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({1: 3883, 0: 3808})

Epoch :  30 loss training:  1.7344149853743147 Time :  429
accuracy train: 0.997006 val: 0.964848 test: 0.967123
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({0: 3885, 1: 3806})

Epoch :  31 loss training:  2.4344253000635945 Time :  444
accuracy train: 0.997220 val: 0.967273 test: 0.966210
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({1: 3901, 0: 3790})

Epoch :  32 loss training:  1.8033188340705237 Time :  459
accuracy train: 0.996364 val: 0.968485 test: 0.968493
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({0: 3907, 1: 3784})

Epoch :  33 loss training:  1.617850114547764 Time :  474
accuracy train: 0.996151 val: 0.964848 test: 0.968493
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({0: 3858, 1: 3833})

Epoch :  34 loss training:  1.8536866841095616 Time :  488
accuracy train: 0.997220 val: 0.970909 test: 0.970776
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({0: 3862, 1: 3829})

Epoch :  35 loss training:  2.118534435350739 Time :  503
accuracy train: 0.996151 val: 0.960000 test: 0.961644
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({1: 3905, 0: 3786})

Epoch :  36 loss training:  1.8126500163816672 Time :  518
accuracy train: 0.997006 val: 0.963636 test: 0.968037
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({0: 3868, 1: 3823})

Epoch :  37 loss training:  1.7961526622548263 Time :  532
accuracy train: 0.996578 val: 0.966061 test: 0.964384
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({1: 3881, 0: 3810})

Epoch :  38 loss training:  1.693486187941744 Time :  548
accuracy train: 0.996578 val: 0.955152 test: 0.959817
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({1: 3849, 0: 3842})

Epoch :  39 loss training:  2.3688625053582655 Time :  563
accuracy train: 0.997434 val: 0.964848 test: 0.967123
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({1: 3897, 0: 3794})

Epoch :  40 loss training:  5.847952343188808 Time :  577
accuracy train: 0.996578 val: 0.962424 test: 0.964840
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({0: 3859, 1: 3832})

Epoch :  41 loss training:  2.369969506995403 Time :  591
accuracy train: 0.997006 val: 0.961212 test: 0.969406
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({1: 3953, 0: 3738})

Epoch :  42 loss training:  2.1085782616428332 Time :  607
accuracy train: 0.996578 val: 0.967273 test: 0.967580
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({0: 3898, 1: 3793})

Epoch :  43 loss training:  1.8423499309210456 Time :  621
accuracy train: 0.997006 val: 0.964848 test: 0.968493
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({0: 3857, 1: 3834})

Epoch :  44 loss training:  1.3514397814918766 Time :  636
accuracy train: 0.996578 val: 0.968485 test: 0.966667
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({1: 3873, 0: 3818})

Epoch :  45 loss training:  2.1736562609366956 Time :  651
accuracy train: 0.997006 val: 0.964848 test: 0.969863
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({1: 3859, 0: 3832})

Epoch :  46 loss training:  2.062897269208406 Time :  666
accuracy train: 0.997220 val: 0.964848 test: 0.968037
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({1: 3899, 0: 3792})

Epoch :  47 loss training:  1.8307423755577474 Time :  682
accuracy train: 0.997861 val: 0.964848 test: 0.966667
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({0: 3859, 1: 3832})

Epoch :  48 loss training:  1.6595843576615152 Time :  696
accuracy train: 0.997434 val: 0.962424 test: 0.964840
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({0: 3880, 1: 3811})

Epoch :  49 loss training:  1.4121159382939368 Time :  711
accuracy train: 0.997006 val: 0.964848 test: 0.969406
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({1: 3859, 0: 3832})

Epoch :  50 loss training:  1.3298781874509586 Time :  725
accuracy train: 0.996792 val: 0.966061 test: 0.965753
max validation accuracy : 0.973333 max acc epoch : 19 test accuracy : 0.968037
Counter({0: 3881, 1: 3810})

========================================================================================================================================================================================================
best acc epoch :  19
validation accuracy :  0.9733333333333334
test accuracy :  0.9680365296803652
last test_accuracy :  0.9657534246575342
second best val :  0.9709090909090909
second best test :  0.9680365296803652
max gap 7
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=2, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=142, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  43.85296205058694 Time :  743
accuracy train: 0.960009 val: 0.953939 test: 0.954338
max validation accuracy : 0.953939 max acc epoch : 1 test accuracy : 0.954338
Counter({0: 4234, 1: 3457})

Epoch :  2 loss training:  18.041692498140037 Time :  757
accuracy train: 0.972626 val: 0.947879 test: 0.962100
max validation accuracy : 0.953939 max acc epoch : 1 test accuracy : 0.954338
Counter({1: 4193, 0: 3498})

Epoch :  3 loss training:  14.589967471547425 Time :  771
accuracy train: 0.978186 val: 0.953939 test: 0.961187
max validation accuracy : 0.953939 max acc epoch : 1 test accuracy : 0.954338
Counter({1: 3983, 0: 3708})

Epoch :  4 loss training:  12.940610480960459 Time :  785
accuracy train: 0.973482 val: 0.957576 test: 0.962557
max validation accuracy : 0.957576 max acc epoch : 4 test accuracy : 0.962557
Counter({0: 3954, 1: 3737})

Epoch :  5 loss training:  10.898621348198503 Time :  799
accuracy train: 0.982891 val: 0.960000 test: 0.957991
max validation accuracy : 0.960000 max acc epoch : 5 test accuracy : 0.957991
Counter({0: 3915, 1: 3776})

Epoch :  6 loss training:  10.16096431168262 Time :  813
accuracy train: 0.985244 val: 0.950303 test: 0.966667
max validation accuracy : 0.960000 max acc epoch : 5 test accuracy : 0.957991
Counter({1: 3914, 0: 3777})

Epoch :  7 loss training:  10.094791329698637 Time :  827
accuracy train: 0.986955 val: 0.964848 test: 0.964384
max validation accuracy : 0.964848 max acc epoch : 7 test accuracy : 0.964384
Counter({1: 3910, 0: 3781})

Epoch :  8 loss training:  8.602567650843412 Time :  840
accuracy train: 0.986955 val: 0.963636 test: 0.957991
max validation accuracy : 0.964848 max acc epoch : 7 test accuracy : 0.964384
Counter({0: 3879, 1: 3812})

Epoch :  9 loss training:  8.94140781601891 Time :  855
accuracy train: 0.987382 val: 0.963636 test: 0.958904
max validation accuracy : 0.964848 max acc epoch : 7 test accuracy : 0.964384
Counter({1: 3883, 0: 3808})

Epoch :  10 loss training:  8.274253323674202 Time :  869
accuracy train: 0.990804 val: 0.957576 test: 0.966210
max validation accuracy : 0.964848 max acc epoch : 7 test accuracy : 0.964384
Counter({0: 3873, 1: 3818})

Epoch :  11 loss training:  7.365712538128719 Time :  884
accuracy train: 0.991018 val: 0.962424 test: 0.969406
max validation accuracy : 0.964848 max acc epoch : 7 test accuracy : 0.964384
Counter({1: 3847, 0: 3844})

Epoch :  12 loss training:  7.0948426570685115 Time :  899
accuracy train: 0.992943 val: 0.967273 test: 0.962557
max validation accuracy : 0.967273 max acc epoch : 12 test accuracy : 0.962557
Counter({0: 3867, 1: 3824})

Epoch :  13 loss training:  6.127173182321712 Time :  914
accuracy train: 0.994440 val: 0.960000 test: 0.963470
max validation accuracy : 0.967273 max acc epoch : 12 test accuracy : 0.962557
Counter({1: 3891, 0: 3800})

Epoch :  14 loss training:  5.074728318024427 Time :  929
accuracy train: 0.993584 val: 0.961212 test: 0.968037
max validation accuracy : 0.967273 max acc epoch : 12 test accuracy : 0.962557
Counter({1: 3846, 0: 3845})

Epoch :  15 loss training:  5.7762231030501425 Time :  943
accuracy train: 0.994226 val: 0.963636 test: 0.972603
max validation accuracy : 0.967273 max acc epoch : 12 test accuracy : 0.962557
Counter({1: 3861, 0: 3830})

Epoch :  16 loss training:  5.347808093531057 Time :  958
accuracy train: 0.991873 val: 0.964848 test: 0.969406
max validation accuracy : 0.967273 max acc epoch : 12 test accuracy : 0.962557
Counter({0: 3871, 1: 3820})

Epoch :  17 loss training:  4.552425985835725 Time :  973
accuracy train: 0.995937 val: 0.962424 test: 0.968493
max validation accuracy : 0.967273 max acc epoch : 12 test accuracy : 0.962557
Counter({1: 3878, 0: 3813})

Epoch :  18 loss training:  3.6784879458864452 Time :  987
accuracy train: 0.994012 val: 0.957576 test: 0.964840
max validation accuracy : 0.967273 max acc epoch : 12 test accuracy : 0.962557
Counter({0: 3896, 1: 3795})

Epoch :  19 loss training:  3.096859293815214 Time :  1002
accuracy train: 0.993584 val: 0.963636 test: 0.968493
max validation accuracy : 0.967273 max acc epoch : 12 test accuracy : 0.962557
Counter({1: 3892, 0: 3799})

Epoch :  20 loss training:  3.038753641594667 Time :  1016
accuracy train: 0.996364 val: 0.967273 test: 0.969863
max validation accuracy : 0.967273 max acc epoch : 12 test accuracy : 0.962557
Counter({1: 3888, 0: 3803})

Epoch :  21 loss training:  2.7381778900598874 Time :  1031
accuracy train: 0.995937 val: 0.963636 test: 0.965297
max validation accuracy : 0.967273 max acc epoch : 12 test accuracy : 0.962557
Counter({1: 3879, 0: 3812})

Epoch :  22 loss training:  2.468682165534119 Time :  1047
accuracy train: 0.996364 val: 0.962424 test: 0.968493
max validation accuracy : 0.967273 max acc epoch : 12 test accuracy : 0.962557
Counter({1: 3873, 0: 3818})

Epoch :  23 loss training:  2.4460819216037635 Time :  1062
accuracy train: 0.996151 val: 0.967273 test: 0.965297
max validation accuracy : 0.967273 max acc epoch : 12 test accuracy : 0.962557
Counter({1: 3876, 0: 3815})

Epoch :  24 loss training:  2.4336231266643154 Time :  1076
accuracy train: 0.995509 val: 0.970909 test: 0.964384
max validation accuracy : 0.970909 max acc epoch : 24 test accuracy : 0.964384
Counter({0: 3873, 1: 3818})

Epoch :  25 loss training:  2.664787000627257 Time :  1091
accuracy train: 0.997006 val: 0.962424 test: 0.970320
max validation accuracy : 0.970909 max acc epoch : 24 test accuracy : 0.964384
Counter({0: 3882, 1: 3809})

Epoch :  26 loss training:  2.7089153157730834 Time :  1105
accuracy train: 0.995937 val: 0.964848 test: 0.968037
max validation accuracy : 0.970909 max acc epoch : 24 test accuracy : 0.964384
Counter({1: 3968, 0: 3723})

Epoch :  27 loss training:  2.5648669243091717 Time :  1121
accuracy train: 0.996364 val: 0.966061 test: 0.969406
max validation accuracy : 0.970909 max acc epoch : 24 test accuracy : 0.964384
Counter({1: 3893, 0: 3798})

Epoch :  28 loss training:  2.87256640191481 Time :  1136
accuracy train: 0.994440 val: 0.958788 test: 0.962557
max validation accuracy : 0.970909 max acc epoch : 24 test accuracy : 0.964384
Counter({0: 3873, 1: 3818})

Epoch :  29 loss training:  2.3794028475531377 Time :  1151
accuracy train: 0.996792 val: 0.961212 test: 0.965753
max validation accuracy : 0.970909 max acc epoch : 24 test accuracy : 0.964384
Counter({1: 3898, 0: 3793})

Epoch :  30 loss training:  2.0918871480607777 Time :  1165
accuracy train: 0.996578 val: 0.966061 test: 0.969406
max validation accuracy : 0.970909 max acc epoch : 24 test accuracy : 0.964384
Counter({0: 3892, 1: 3799})

Epoch :  31 loss training:  3.1528429374084226 Time :  1180
accuracy train: 0.996792 val: 0.958788 test: 0.968950
max validation accuracy : 0.970909 max acc epoch : 24 test accuracy : 0.964384
Counter({1: 3854, 0: 3837})

Epoch :  32 loss training:  3.3132845393774915 Time :  1194
accuracy train: 0.997006 val: 0.960000 test: 0.972146
max validation accuracy : 0.970909 max acc epoch : 24 test accuracy : 0.964384
Counter({0: 3877, 1: 3814})

Epoch :  33 loss training:  2.3700243355087878 Time :  1209
accuracy train: 0.997006 val: 0.964848 test: 0.969406
max validation accuracy : 0.970909 max acc epoch : 24 test accuracy : 0.964384
Counter({0: 3882, 1: 3809})

Epoch :  34 loss training:  2.261328757427691 Time :  1224
accuracy train: 0.996792 val: 0.963636 test: 0.969863
max validation accuracy : 0.970909 max acc epoch : 24 test accuracy : 0.964384
Counter({0: 3898, 1: 3793})

Epoch :  35 loss training:  2.100196911043895 Time :  1239
accuracy train: 0.997006 val: 0.964848 test: 0.968950
max validation accuracy : 0.970909 max acc epoch : 24 test accuracy : 0.964384
Counter({1: 3856, 0: 3835})

Epoch :  36 loss training:  2.0162750241761387 Time :  1253
accuracy train: 0.996578 val: 0.968485 test: 0.968950
max validation accuracy : 0.970909 max acc epoch : 24 test accuracy : 0.964384
Counter({0: 3875, 1: 3816})

Epoch :  37 loss training:  2.0404157334523916 Time :  1268
accuracy train: 0.997220 val: 0.964848 test: 0.972146
max validation accuracy : 0.970909 max acc epoch : 24 test accuracy : 0.964384
Counter({1: 3897, 0: 3794})

Epoch :  38 loss training:  1.924868475216499 Time :  1283
accuracy train: 0.997006 val: 0.975758 test: 0.969406
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({0: 3866, 1: 3825})

Epoch :  39 loss training:  2.25110796287845 Time :  1298
accuracy train: 0.997006 val: 0.964848 test: 0.972603
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({0: 3865, 1: 3826})

Epoch :  40 loss training:  2.4002415851937258 Time :  1313
accuracy train: 0.992515 val: 0.957576 test: 0.968950
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({1: 3861, 0: 3830})

Epoch :  41 loss training:  2.253848154732623 Time :  1328
accuracy train: 0.997220 val: 0.969697 test: 0.971233
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({0: 3878, 1: 3813})

Epoch :  42 loss training:  1.7504565923300106 Time :  1343
accuracy train: 0.996792 val: 0.972121 test: 0.971689
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({1: 3891, 0: 3800})

Epoch :  43 loss training:  1.6320733922148065 Time :  1358
accuracy train: 0.997006 val: 0.964848 test: 0.970320
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({0: 3874, 1: 3817})

Epoch :  44 loss training:  2.069706455040432 Time :  1373
accuracy train: 0.996792 val: 0.962424 test: 0.970776
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({0: 3848, 1: 3843})

Epoch :  45 loss training:  1.7303842097935558 Time :  1387
accuracy train: 0.997006 val: 0.972121 test: 0.963927
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({1: 3928, 0: 3763})

Epoch :  46 loss training:  1.7774100757560518 Time :  1402
accuracy train: 0.997220 val: 0.966061 test: 0.968493
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({0: 3924, 1: 3767})

Epoch :  47 loss training:  1.8295781391352648 Time :  1417
accuracy train: 0.996792 val: 0.960000 test: 0.958447
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({1: 3905, 0: 3786})

Epoch :  48 loss training:  1.829601332123275 Time :  1432
accuracy train: 0.997006 val: 0.960000 test: 0.967580
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({0: 3893, 1: 3798})

Epoch :  49 loss training:  2.1641802950819056 Time :  1446
accuracy train: 0.997220 val: 0.968485 test: 0.965297
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({1: 3900, 0: 3791})

Epoch :  50 loss training:  1.7352989551400242 Time :  1461
accuracy train: 0.997434 val: 0.964848 test: 0.965753
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({0: 3922, 1: 3769})

Epoch :  51 loss training:  1.933901068774503 Time :  1477
accuracy train: 0.996578 val: 0.960000 test: 0.964840
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({0: 3913, 1: 3778})

Epoch :  52 loss training:  2.39894949549398 Time :  1491
accuracy train: 0.997220 val: 0.973333 test: 0.966667
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({1: 3939, 0: 3752})

Epoch :  53 loss training:  2.525212173102773 Time :  1507
accuracy train: 0.995937 val: 0.963636 test: 0.965297
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({0: 3978, 1: 3713})

Epoch :  54 loss training:  1.9804444989877084 Time :  1521
accuracy train: 0.997006 val: 0.957576 test: 0.964840
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({0: 3953, 1: 3738})

Epoch :  55 loss training:  1.9088678955340583 Time :  1535
accuracy train: 0.997006 val: 0.974545 test: 0.966210
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({1: 3911, 0: 3780})

Epoch :  56 loss training:  2.0603830716222546 Time :  1550
accuracy train: 0.997006 val: 0.964848 test: 0.964384
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({0: 3945, 1: 3746})

Epoch :  57 loss training:  1.765704222550994 Time :  1565
accuracy train: 0.997220 val: 0.964848 test: 0.967580
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({1: 3929, 0: 3762})

Epoch :  58 loss training:  1.6435278842000116 Time :  1579
accuracy train: 0.994654 val: 0.966061 test: 0.966210
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({1: 3938, 0: 3753})

Epoch :  59 loss training:  1.910147388610767 Time :  1594
accuracy train: 0.996578 val: 0.969697 test: 0.968037
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({0: 3940, 1: 3751})

Epoch :  60 loss training:  2.563239115334909 Time :  1609
accuracy train: 0.997220 val: 0.972121 test: 0.963014
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({0: 3847, 1: 3844})

Epoch :  61 loss training:  2.5568150708240864 Time :  1623
accuracy train: 0.997006 val: 0.967273 test: 0.967580
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({1: 3926, 0: 3765})

Epoch :  62 loss training:  1.658406973541787 Time :  1638
accuracy train: 0.994654 val: 0.960000 test: 0.966210
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({1: 3917, 0: 3774})

Epoch :  63 loss training:  1.4804003134668164 Time :  1652
accuracy train: 0.997220 val: 0.975758 test: 0.969406
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({1: 3911, 0: 3780})

Epoch :  64 loss training:  1.6854575532197487 Time :  1667
accuracy train: 0.997220 val: 0.975758 test: 0.967580
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({0: 3912, 1: 3779})

Epoch :  65 loss training:  1.560506195482958 Time :  1683
accuracy train: 0.997006 val: 0.967273 test: 0.967123
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({1: 3875, 0: 3816})

Epoch :  66 loss training:  1.8668992798393447 Time :  1698
accuracy train: 0.997006 val: 0.963636 test: 0.964840
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({1: 3896, 0: 3795})

Epoch :  67 loss training:  1.8830553006619084 Time :  1713
accuracy train: 0.994654 val: 0.973333 test: 0.967123
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({1: 3906, 0: 3785})

Epoch :  68 loss training:  1.635490463775568 Time :  1729
accuracy train: 0.997006 val: 0.962424 test: 0.964384
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({0: 3846, 1: 3845})

Epoch :  69 loss training:  1.5962294426426524 Time :  1743
accuracy train: 0.997006 val: 0.973333 test: 0.966667
max validation accuracy : 0.975758 max acc epoch : 38 test accuracy : 0.969406
Counter({1: 3910, 0: 3781})

========================================================================================================================================================================================================
best acc epoch :  38
validation accuracy :  0.9757575757575757
test accuracy :  0.9694063926940639
last test_accuracy :  0.9666666666666667
second best val :  0.9745454545454545
second best test :  0.9694063926940639
max gap 14
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  19 	 val_accuracy : 0.97333 	 test_accuracy : 0.96804 	 last test_accuracy : 0.96575 	 second best val : 0.97091 	 second best test : 0.96804
k :  1 	 best_acc epoch :  38 	 val_accuracy : 0.97576 	 test_accuracy : 0.96941 	 last test_accuracy : 0.96667 	 second best val : 0.97455 	 second best test : 0.96941

avg :  	 val_accuracy : 0.97455 	 test_accuracy : 0.96872 	 last_accuracy : 0.96621 	 second best val : 0.97273 	 second best test : 0.96872

std :  	 val_accuracy : 0.00121 	 test_accuracy : 0.00068 	 last_accuracy : 0.00046 	 second best val : 0.00182 	 second best test : 0.00068


date and time :  Sun Jun 20 18:46:19 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.5, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=2, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=573, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  65.99546604976058 Time :  13
accuracy train: 0.927074 val: 0.915152 test: 0.945205
max validation accuracy : 0.915152 max acc epoch : 1 test accuracy : 0.945205
Counter({0: 4216, 1: 3475})

Epoch :  2 loss training:  24.794344410300255 Time :  30
accuracy train: 0.961078 val: 0.952727 test: 0.968493
max validation accuracy : 0.952727 max acc epoch : 2 test accuracy : 0.968493
Counter({1: 4003, 0: 3688})

Epoch :  3 loss training:  19.595764939207584 Time :  45
accuracy train: 0.968991 val: 0.960000 test: 0.961187
max validation accuracy : 0.960000 max acc epoch : 3 test accuracy : 0.961187
Counter({0: 3996, 1: 3695})

Epoch :  4 loss training:  17.21569463261403 Time :  60
accuracy train: 0.973695 val: 0.956364 test: 0.965753
max validation accuracy : 0.960000 max acc epoch : 3 test accuracy : 0.961187
Counter({1: 4001, 0: 3690})

Epoch :  5 loss training:  15.29580744355917 Time :  75
accuracy train: 0.969418 val: 0.944242 test: 0.966667
max validation accuracy : 0.960000 max acc epoch : 3 test accuracy : 0.961187
Counter({0: 3975, 1: 3716})

Epoch :  6 loss training:  16.212179546244442 Time :  89
accuracy train: 0.970274 val: 0.951515 test: 0.972146
max validation accuracy : 0.960000 max acc epoch : 3 test accuracy : 0.961187
Counter({1: 3969, 0: 3722})

Epoch :  7 loss training:  16.359288326464593 Time :  102
accuracy train: 0.975620 val: 0.956364 test: 0.963014
max validation accuracy : 0.960000 max acc epoch : 3 test accuracy : 0.961187
Counter({1: 3938, 0: 3753})

Epoch :  8 loss training:  13.809361242223531 Time :  117
accuracy train: 0.984816 val: 0.964848 test: 0.963927
max validation accuracy : 0.964848 max acc epoch : 8 test accuracy : 0.963927
Counter({0: 3915, 1: 3776})

Epoch :  9 loss training:  13.277251346968114 Time :  130
accuracy train: 0.974551 val: 0.949091 test: 0.952968
max validation accuracy : 0.964848 max acc epoch : 8 test accuracy : 0.963927
Counter({0: 3892, 1: 3799})

Epoch :  10 loss training:  13.176022785250098 Time :  144
accuracy train: 0.980539 val: 0.962424 test: 0.966667
max validation accuracy : 0.964848 max acc epoch : 8 test accuracy : 0.963927
Counter({0: 3938, 1: 3753})

Epoch :  11 loss training:  12.927408183924854 Time :  158
accuracy train: 0.986099 val: 0.961212 test: 0.968493
max validation accuracy : 0.964848 max acc epoch : 8 test accuracy : 0.963927
Counter({1: 3908, 0: 3783})

Epoch :  12 loss training:  11.4121826402843 Time :  172
accuracy train: 0.984175 val: 0.958788 test: 0.964840
max validation accuracy : 0.964848 max acc epoch : 8 test accuracy : 0.963927
Counter({0: 3896, 1: 3795})

Epoch :  13 loss training:  9.028581032995135 Time :  187
accuracy train: 0.986527 val: 0.949091 test: 0.968950
max validation accuracy : 0.964848 max acc epoch : 8 test accuracy : 0.963927
Counter({1: 3850, 0: 3841})

Epoch :  14 loss training:  8.085937349358574 Time :  201
accuracy train: 0.983533 val: 0.949091 test: 0.968037
max validation accuracy : 0.964848 max acc epoch : 8 test accuracy : 0.963927
Counter({0: 3882, 1: 3809})

Epoch :  15 loss training:  8.186280335532501 Time :  216
accuracy train: 0.992729 val: 0.967273 test: 0.969863
max validation accuracy : 0.967273 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3860, 1: 3831})

Epoch :  16 loss training:  6.856896195677109 Time :  231
accuracy train: 0.990376 val: 0.962424 test: 0.968950
max validation accuracy : 0.967273 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3859, 0: 3832})

Epoch :  17 loss training:  6.077526888344437 Time :  246
accuracy train: 0.992301 val: 0.968485 test: 0.965753
max validation accuracy : 0.968485 max acc epoch : 17 test accuracy : 0.965753
Counter({1: 3888, 0: 3803})

Epoch :  18 loss training:  4.87337206187658 Time :  260
accuracy train: 0.986527 val: 0.949091 test: 0.970320
max validation accuracy : 0.968485 max acc epoch : 17 test accuracy : 0.965753
Counter({1: 3856, 0: 3835})

Epoch :  19 loss training:  4.593524926807731 Time :  275
accuracy train: 0.996364 val: 0.970909 test: 0.973059
max validation accuracy : 0.970909 max acc epoch : 19 test accuracy : 0.973059
Counter({0: 3922, 1: 3769})

Epoch :  20 loss training:  5.043441094516311 Time :  289
accuracy train: 0.995295 val: 0.968485 test: 0.973059
max validation accuracy : 0.970909 max acc epoch : 19 test accuracy : 0.973059
Counter({1: 3899, 0: 3792})

Epoch :  21 loss training:  4.521687905478757 Time :  304
accuracy train: 0.994654 val: 0.960000 test: 0.972146
max validation accuracy : 0.970909 max acc epoch : 19 test accuracy : 0.973059
Counter({0: 3880, 1: 3811})

Epoch :  22 loss training:  4.964388894033618 Time :  319
accuracy train: 0.993798 val: 0.958788 test: 0.968950
max validation accuracy : 0.970909 max acc epoch : 19 test accuracy : 0.973059
Counter({0: 3889, 1: 3802})

Epoch :  23 loss training:  5.681588015140733 Time :  334
accuracy train: 0.995723 val: 0.963636 test: 0.971689
max validation accuracy : 0.970909 max acc epoch : 19 test accuracy : 0.973059
Counter({1: 3893, 0: 3798})

Epoch :  24 loss training:  3.6546367710398044 Time :  348
accuracy train: 0.994654 val: 0.961212 test: 0.970776
max validation accuracy : 0.970909 max acc epoch : 19 test accuracy : 0.973059
Counter({0: 3901, 1: 3790})

Epoch :  25 loss training:  3.202805673412513 Time :  362
accuracy train: 0.996151 val: 0.970909 test: 0.972603
max validation accuracy : 0.970909 max acc epoch : 19 test accuracy : 0.973059
Counter({1: 3907, 0: 3784})

Epoch :  26 loss training:  2.7390916410804493 Time :  377
accuracy train: 0.996792 val: 0.970909 test: 0.976256
max validation accuracy : 0.970909 max acc epoch : 19 test accuracy : 0.973059
Counter({0: 3909, 1: 3782})

Epoch :  27 loss training:  2.3083462020076695 Time :  393
accuracy train: 0.995081 val: 0.963636 test: 0.971233
max validation accuracy : 0.970909 max acc epoch : 19 test accuracy : 0.973059
Counter({0: 3904, 1: 3787})

Epoch :  28 loss training:  1.8440754512266722 Time :  407
accuracy train: 0.997006 val: 0.968485 test: 0.971233
max validation accuracy : 0.970909 max acc epoch : 19 test accuracy : 0.973059
Counter({0: 3865, 1: 3826})

Epoch :  29 loss training:  2.8974723188293865 Time :  422
accuracy train: 0.996578 val: 0.973333 test: 0.971233
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3907, 0: 3784})

Epoch :  30 loss training:  2.6132642794254934 Time :  436
accuracy train: 0.995081 val: 0.961212 test: 0.968493
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3879, 0: 3812})

Epoch :  31 loss training:  2.9111874676818843 Time :  451
accuracy train: 0.995081 val: 0.960000 test: 0.969863
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3896, 0: 3795})

Epoch :  32 loss training:  4.831854688858584 Time :  466
accuracy train: 0.994867 val: 0.950303 test: 0.969863
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3847, 0: 3844})

Epoch :  33 loss training:  4.142603171378141 Time :  481
accuracy train: 0.995509 val: 0.961212 test: 0.973059
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3902, 0: 3789})

Epoch :  34 loss training:  2.5270247661683243 Time :  496
accuracy train: 0.995509 val: 0.960000 test: 0.973516
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({0: 3897, 1: 3794})

Epoch :  35 loss training:  2.7256956886316175 Time :  510
accuracy train: 0.995081 val: 0.963636 test: 0.974886
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({0: 3908, 1: 3783})

Epoch :  36 loss training:  2.1242902672565833 Time :  525
accuracy train: 0.995723 val: 0.958788 test: 0.971689
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3848, 0: 3843})

Epoch :  37 loss training:  2.2508588601922384 Time :  540
accuracy train: 0.995509 val: 0.963636 test: 0.971689
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({0: 3915, 1: 3776})

Epoch :  38 loss training:  2.505885178971994 Time :  556
accuracy train: 0.997434 val: 0.969697 test: 0.969863
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({0: 3907, 1: 3784})

Epoch :  39 loss training:  1.866590996193736 Time :  571
accuracy train: 0.996578 val: 0.967273 test: 0.975799
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3882, 0: 3809})

Epoch :  40 loss training:  2.2889430965005886 Time :  585
accuracy train: 0.997006 val: 0.968485 test: 0.972146
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({0: 3893, 1: 3798})

Epoch :  41 loss training:  2.515981462889613 Time :  600
accuracy train: 0.997434 val: 0.967273 test: 0.970320
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3902, 0: 3789})

Epoch :  42 loss training:  2.0141938886372373 Time :  616
accuracy train: 0.997220 val: 0.961212 test: 0.972146
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({0: 3893, 1: 3798})

Epoch :  43 loss training:  1.9887972463475307 Time :  631
accuracy train: 0.997006 val: 0.968485 test: 0.968037
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3915, 0: 3776})

Epoch :  44 loss training:  2.4566633294089115 Time :  645
accuracy train: 0.997006 val: 0.969697 test: 0.971689
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({0: 3858, 1: 3833})

Epoch :  45 loss training:  2.4615867704123957 Time :  660
accuracy train: 0.995509 val: 0.963636 test: 0.971689
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3910, 0: 3781})

Epoch :  46 loss training:  2.0320989236624882 Time :  675
accuracy train: 0.993798 val: 0.955152 test: 0.968950
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({0: 3896, 1: 3795})

Epoch :  47 loss training:  1.590530993504217 Time :  690
accuracy train: 0.997434 val: 0.967273 test: 0.972603
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3901, 0: 3790})

Epoch :  48 loss training:  1.890629108176654 Time :  705
accuracy train: 0.997220 val: 0.963636 test: 0.969863
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({0: 3949, 1: 3742})

Epoch :  49 loss training:  2.8687820726117934 Time :  719
accuracy train: 0.997220 val: 0.970909 test: 0.969863
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3888, 0: 3803})

Epoch :  50 loss training:  2.0899683939423994 Time :  734
accuracy train: 0.997220 val: 0.962424 test: 0.974886
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({0: 3902, 1: 3789})

Epoch :  51 loss training:  1.8927634620704321 Time :  748
accuracy train: 0.997220 val: 0.967273 test: 0.970776
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3909, 0: 3782})

Epoch :  52 loss training:  1.922734079651491 Time :  763
accuracy train: 0.997220 val: 0.963636 test: 0.971689
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3889, 0: 3802})

Epoch :  53 loss training:  1.8647138006053865 Time :  778
accuracy train: 0.997006 val: 0.963636 test: 0.969863
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3861, 0: 3830})

Epoch :  54 loss training:  2.382482808025088 Time :  792
accuracy train: 0.996151 val: 0.964848 test: 0.972146
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({0: 3894, 1: 3797})

Epoch :  55 loss training:  2.176849030187441 Time :  807
accuracy train: 0.995081 val: 0.962424 test: 0.967123
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3868, 0: 3823})

Epoch :  56 loss training:  1.7132579702511066 Time :  823
accuracy train: 0.997220 val: 0.964848 test: 0.971233
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3891, 0: 3800})

Epoch :  57 loss training:  1.6143383823618933 Time :  838
accuracy train: 0.997220 val: 0.964848 test: 0.968950
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({0: 3893, 1: 3798})

Epoch :  58 loss training:  1.8360933065996505 Time :  852
accuracy train: 0.995937 val: 0.957576 test: 0.969406
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({0: 3877, 1: 3814})

Epoch :  59 loss training:  1.8497710952569832 Time :  866
accuracy train: 0.997220 val: 0.962424 test: 0.973516
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({0: 3896, 1: 3795})

Epoch :  60 loss training:  1.6999753966911157 Time :  881
accuracy train: 0.997434 val: 0.968485 test: 0.968037
max validation accuracy : 0.973333 max acc epoch : 29 test accuracy : 0.971233
Counter({1: 3871, 0: 3820})

========================================================================================================================================================================================================
best acc epoch :  29
validation accuracy :  0.9733333333333334
test accuracy :  0.9712328767123287
last test_accuracy :  0.9680365296803652
second best val :  0.9709090909090909
second best test :  0.9730593607305936
max gap 10
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.5, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=2, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=770, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  55.456310261040926 Time :  899
accuracy train: 0.948033 val: 0.915152 test: 0.952055
max validation accuracy : 0.915152 max acc epoch : 1 test accuracy : 0.952055
Counter({0: 4113, 1: 3578})

Epoch :  2 loss training:  23.17592748813331 Time :  913
accuracy train: 0.953593 val: 0.941818 test: 0.961644
max validation accuracy : 0.941818 max acc epoch : 2 test accuracy : 0.961644
Counter({1: 4050, 0: 3641})

Epoch :  3 loss training:  18.55985341221094 Time :  927
accuracy train: 0.963430 val: 0.951515 test: 0.963470
max validation accuracy : 0.951515 max acc epoch : 3 test accuracy : 0.963470
Counter({1: 3976, 0: 3715})

Epoch :  4 loss training:  16.747854616027325 Time :  941
accuracy train: 0.973695 val: 0.955152 test: 0.963927
max validation accuracy : 0.955152 max acc epoch : 4 test accuracy : 0.963927
Counter({1: 3947, 0: 3744})

Epoch :  5 loss training:  15.880073698237538 Time :  956
accuracy train: 0.973695 val: 0.958788 test: 0.965297
max validation accuracy : 0.958788 max acc epoch : 5 test accuracy : 0.965297
Counter({0: 3912, 1: 3779})

Epoch :  6 loss training:  14.81452375324443 Time :  970
accuracy train: 0.976903 val: 0.962424 test: 0.955708
max validation accuracy : 0.962424 max acc epoch : 6 test accuracy : 0.955708
Counter({1: 3882, 0: 3809})

Epoch :  7 loss training:  15.732574695721269 Time :  984
accuracy train: 0.976689 val: 0.962424 test: 0.963014
max validation accuracy : 0.962424 max acc epoch : 6 test accuracy : 0.955708
Counter({0: 3946, 1: 3745})

Epoch :  8 loss training:  15.477128557860851 Time :  998
accuracy train: 0.978614 val: 0.966061 test: 0.965753
max validation accuracy : 0.966061 max acc epoch : 8 test accuracy : 0.965753
Counter({0: 3950, 1: 3741})

Epoch :  9 loss training:  13.660735871875659 Time :  1012
accuracy train: 0.969846 val: 0.951515 test: 0.961187
max validation accuracy : 0.966061 max acc epoch : 8 test accuracy : 0.965753
Counter({0: 3931, 1: 3760})

Epoch :  10 loss training:  13.965043778531253 Time :  1026
accuracy train: 0.980967 val: 0.967273 test: 0.959817
max validation accuracy : 0.967273 max acc epoch : 10 test accuracy : 0.959817
Counter({1: 3913, 0: 3778})

Epoch :  11 loss training:  12.816462124697864 Time :  1040
accuracy train: 0.981394 val: 0.953939 test: 0.965753
max validation accuracy : 0.967273 max acc epoch : 10 test accuracy : 0.959817
Counter({0: 3900, 1: 3791})

Epoch :  12 loss training:  11.680870840325952 Time :  1055
accuracy train: 0.980539 val: 0.946667 test: 0.972603
max validation accuracy : 0.967273 max acc epoch : 10 test accuracy : 0.959817
Counter({1: 3900, 0: 3791})

Epoch :  13 loss training:  9.56559784617275 Time :  1069
accuracy train: 0.989949 val: 0.970909 test: 0.963470
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.963470
Counter({0: 3868, 1: 3823})

Epoch :  14 loss training:  8.335533875972033 Time :  1084
accuracy train: 0.989521 val: 0.957576 test: 0.968950
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.963470
Counter({1: 3871, 0: 3820})

Epoch :  15 loss training:  7.800038130953908 Time :  1098
accuracy train: 0.990804 val: 0.962424 test: 0.972603
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.963470
Counter({0: 3859, 1: 3832})

Epoch :  16 loss training:  6.092274624155834 Time :  1113
accuracy train: 0.991446 val: 0.960000 test: 0.971233
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.963470
Counter({1: 3862, 0: 3829})

Epoch :  17 loss training:  6.412280990742147 Time :  1128
accuracy train: 0.991232 val: 0.966061 test: 0.964840
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.963470
Counter({1: 3860, 0: 3831})

Epoch :  18 loss training:  6.27046147082001 Time :  1143
accuracy train: 0.993798 val: 0.963636 test: 0.972603
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.963470
Counter({0: 3852, 1: 3839})

Epoch :  19 loss training:  5.701258195971604 Time :  1158
accuracy train: 0.994654 val: 0.964848 test: 0.967580
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.963470
Counter({0: 3848, 1: 3843})

Epoch :  20 loss training:  4.860464725526981 Time :  1173
accuracy train: 0.995081 val: 0.963636 test: 0.971689
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.963470
Counter({1: 3857, 0: 3834})

Epoch :  21 loss training:  4.536646002205089 Time :  1187
accuracy train: 0.994012 val: 0.968485 test: 0.969406
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.963470
Counter({1: 3846, 0: 3845})

Epoch :  22 loss training:  3.9665630294475704 Time :  1202
accuracy train: 0.994012 val: 0.967273 test: 0.963927
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.963470
Counter({0: 3881, 1: 3810})

Epoch :  23 loss training:  3.3418670706741977 Time :  1216
accuracy train: 0.995081 val: 0.964848 test: 0.969406
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.963470
Counter({0: 3865, 1: 3826})

Epoch :  24 loss training:  4.303494857245823 Time :  1231
accuracy train: 0.995723 val: 0.964848 test: 0.971233
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.963470
Counter({0: 3854, 1: 3837})

Epoch :  25 loss training:  3.8871925672719954 Time :  1246
accuracy train: 0.994654 val: 0.961212 test: 0.969863
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.963470
Counter({1: 3882, 0: 3809})

Epoch :  26 loss training:  3.289447796254535 Time :  1260
accuracy train: 0.996151 val: 0.966061 test: 0.969863
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.963470
Counter({0: 3888, 1: 3803})

Epoch :  27 loss training:  3.3900916209822753 Time :  1275
accuracy train: 0.996792 val: 0.956364 test: 0.970320
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.963470
Counter({1: 3848, 0: 3843})

Epoch :  28 loss training:  3.1098097616340965 Time :  1291
accuracy train: 0.996364 val: 0.963636 test: 0.969406
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.963470
Counter({1: 3876, 0: 3815})

Epoch :  29 loss training:  3.406409120449098 Time :  1306
accuracy train: 0.995937 val: 0.970909 test: 0.967123
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.963470
Counter({0: 3856, 1: 3835})

Epoch :  30 loss training:  2.905213057543733 Time :  1321
accuracy train: 0.996792 val: 0.966061 test: 0.973516
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.963470
Counter({1: 3856, 0: 3835})

Epoch :  31 loss training:  2.4568065357161686 Time :  1334
accuracy train: 0.995509 val: 0.973333 test: 0.969406
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.969406
Counter({0: 3867, 1: 3824})

Epoch :  32 loss training:  3.4902501859869517 Time :  1349
accuracy train: 0.996151 val: 0.968485 test: 0.971689
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.969406
Counter({0: 3871, 1: 3820})

Epoch :  33 loss training:  2.848322201796691 Time :  1363
accuracy train: 0.995937 val: 0.969697 test: 0.969863
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.969406
Counter({1: 3864, 0: 3827})

Epoch :  34 loss training:  3.4288535269806744 Time :  1378
accuracy train: 0.995937 val: 0.964848 test: 0.966667
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.969406
Counter({0: 3863, 1: 3828})

Epoch :  35 loss training:  3.0220226161327446 Time :  1393
accuracy train: 0.996578 val: 0.969697 test: 0.970776
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.969406
Counter({1: 3874, 0: 3817})

Epoch :  36 loss training:  2.5769552760502847 Time :  1408
accuracy train: 0.996792 val: 0.966061 test: 0.973059
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.969406
Counter({1: 3866, 0: 3825})

Epoch :  37 loss training:  2.9442926718547824 Time :  1422
accuracy train: 0.996792 val: 0.968485 test: 0.972603
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.969406
Counter({0: 3864, 1: 3827})

Epoch :  38 loss training:  3.1029837325113476 Time :  1437
accuracy train: 0.995937 val: 0.955152 test: 0.968493
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.969406
Counter({1: 3924, 0: 3767})

Epoch :  39 loss training:  3.134970122759114 Time :  1452
accuracy train: 0.995509 val: 0.963636 test: 0.968950
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.969406
Counter({0: 3864, 1: 3827})

Epoch :  40 loss training:  2.980695495614782 Time :  1467
accuracy train: 0.996364 val: 0.964848 test: 0.971233
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.969406
Counter({0: 3884, 1: 3807})

Epoch :  41 loss training:  2.087550369615201 Time :  1482
accuracy train: 0.994440 val: 0.953939 test: 0.970776
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.969406
Counter({1: 3878, 0: 3813})

Epoch :  42 loss training:  2.3579775945836445 Time :  1497
accuracy train: 0.997220 val: 0.962424 test: 0.973059
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.969406
Counter({0: 3878, 1: 3813})

Epoch :  43 loss training:  2.214096340510878 Time :  1512
accuracy train: 0.996792 val: 0.964848 test: 0.973059
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.969406
Counter({1: 3896, 0: 3795})

Epoch :  44 loss training:  2.7280766623443924 Time :  1527
accuracy train: 0.996578 val: 0.967273 test: 0.971689
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.969406
Counter({0: 3897, 1: 3794})

Epoch :  45 loss training:  2.3603226932500547 Time :  1542
accuracy train: 0.996792 val: 0.956364 test: 0.968950
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.969406
Counter({1: 3887, 0: 3804})

Epoch :  46 loss training:  1.820746450794104 Time :  1557
accuracy train: 0.997006 val: 0.966061 test: 0.972146
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.969406
Counter({0: 3902, 1: 3789})

Epoch :  47 loss training:  2.1877186255223933 Time :  1571
accuracy train: 0.996792 val: 0.966061 test: 0.971233
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.969406
Counter({1: 3902, 0: 3789})

Epoch :  48 loss training:  2.1332844924059344 Time :  1585
accuracy train: 0.997220 val: 0.966061 test: 0.970320
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.969406
Counter({0: 3858, 1: 3833})

Epoch :  49 loss training:  2.222845702553059 Time :  1600
accuracy train: 0.996792 val: 0.966061 test: 0.974429
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.969406
Counter({1: 3863, 0: 3828})

Epoch :  50 loss training:  1.9279855392105674 Time :  1615
accuracy train: 0.997220 val: 0.966061 test: 0.969406
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.969406
Counter({1: 3869, 0: 3822})

Epoch :  51 loss training:  2.0057203505675716 Time :  1630
accuracy train: 0.996792 val: 0.969697 test: 0.969863
max validation accuracy : 0.973333 max acc epoch : 31 test accuracy : 0.969406
Counter({0: 3891, 1: 3800})

Epoch :  52 loss training:  1.6493003465129732 Time :  1645
accuracy train: 0.996792 val: 0.974545 test: 0.974429
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({1: 3913, 0: 3778})

Epoch :  53 loss training:  2.438430558829168 Time :  1660
accuracy train: 0.996578 val: 0.967273 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({0: 3893, 1: 3798})

Epoch :  54 loss training:  1.8580514968743955 Time :  1675
accuracy train: 0.996151 val: 0.968485 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({1: 3901, 0: 3790})

Epoch :  55 loss training:  2.3937093204913253 Time :  1690
accuracy train: 0.997220 val: 0.964848 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({0: 3891, 1: 3800})

Epoch :  56 loss training:  2.107778047764441 Time :  1704
accuracy train: 0.996792 val: 0.972121 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({0: 3896, 1: 3795})

Epoch :  57 loss training:  2.444819911625018 Time :  1718
accuracy train: 0.996578 val: 0.961212 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({0: 3895, 1: 3796})

Epoch :  58 loss training:  2.3493070059048478 Time :  1733
accuracy train: 0.997220 val: 0.966061 test: 0.965297
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({1: 3874, 0: 3817})

Epoch :  59 loss training:  2.020424851853022 Time :  1747
accuracy train: 0.997434 val: 0.957576 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({0: 3879, 1: 3812})

Epoch :  60 loss training:  1.886759247734517 Time :  1763
accuracy train: 0.997434 val: 0.966061 test: 0.964840
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({1: 3876, 0: 3815})

Epoch :  61 loss training:  2.178158628118581 Time :  1777
accuracy train: 0.997006 val: 0.969697 test: 0.963927
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({1: 3898, 0: 3793})

Epoch :  62 loss training:  1.5846032597655721 Time :  1792
accuracy train: 0.996364 val: 0.964848 test: 0.965753
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({0: 3901, 1: 3790})

Epoch :  63 loss training:  1.6472869718036236 Time :  1807
accuracy train: 0.997006 val: 0.966061 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({0: 3890, 1: 3801})

Epoch :  64 loss training:  2.0133649731947116 Time :  1822
accuracy train: 0.997006 val: 0.966061 test: 0.962557
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({0: 3879, 1: 3812})

Epoch :  65 loss training:  2.5576251171078184 Time :  1837
accuracy train: 0.997006 val: 0.960000 test: 0.965297
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({1: 3847, 0: 3844})

Epoch :  66 loss training:  1.6919259386686463 Time :  1852
accuracy train: 0.997220 val: 0.970909 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({0: 3892, 1: 3799})

Epoch :  67 loss training:  1.6892797891359805 Time :  1866
accuracy train: 0.997006 val: 0.956364 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({0: 3871, 1: 3820})

Epoch :  68 loss training:  2.370299563619483 Time :  1880
accuracy train: 0.996151 val: 0.953939 test: 0.957991
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({1: 3860, 0: 3831})

Epoch :  69 loss training:  2.3050756751144945 Time :  1894
accuracy train: 0.996792 val: 0.962424 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({0: 3910, 1: 3781})

Epoch :  70 loss training:  1.8157084264125842 Time :  1908
accuracy train: 0.996364 val: 0.964848 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({0: 3914, 1: 3777})

Epoch :  71 loss training:  1.387810063039069 Time :  1923
accuracy train: 0.996578 val: 0.964848 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({1: 3889, 0: 3802})

Epoch :  72 loss training:  2.0619832230640895 Time :  1938
accuracy train: 0.997006 val: 0.961212 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({1: 3879, 0: 3812})

Epoch :  73 loss training:  1.8874527809371102 Time :  1953
accuracy train: 0.996792 val: 0.967273 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({1: 3893, 0: 3798})

Epoch :  74 loss training:  2.0800769806592143 Time :  1968
accuracy train: 0.997434 val: 0.968485 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({1: 3882, 0: 3809})

Epoch :  75 loss training:  1.779586132728582 Time :  1983
accuracy train: 0.997006 val: 0.964848 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({1: 3878, 0: 3813})

Epoch :  76 loss training:  1.9774884468461096 Time :  1998
accuracy train: 0.997220 val: 0.967273 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({1: 3887, 0: 3804})

Epoch :  77 loss training:  1.7086137396861432 Time :  2012
accuracy train: 0.997220 val: 0.962424 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({0: 3892, 1: 3799})

Epoch :  78 loss training:  2.1002259862470964 Time :  2027
accuracy train: 0.996578 val: 0.961212 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({1: 3885, 0: 3806})

Epoch :  79 loss training:  1.934252632654534 Time :  2042
accuracy train: 0.997006 val: 0.967273 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({1: 3867, 0: 3824})

Epoch :  80 loss training:  1.9076903336845135 Time :  2057
accuracy train: 0.997006 val: 0.958788 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({0: 3870, 1: 3821})

Epoch :  81 loss training:  2.9645536281213936 Time :  2072
accuracy train: 0.997220 val: 0.960000 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({0: 3865, 1: 3826})

Epoch :  82 loss training:  1.7115023274614032 Time :  2087
accuracy train: 0.997220 val: 0.967273 test: 0.962100
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({0: 3896, 1: 3795})

Epoch :  83 loss training:  1.9466767446301674 Time :  2102
accuracy train: 0.996578 val: 0.966061 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 52 test accuracy : 0.974429
Counter({0: 3900, 1: 3791})

========================================================================================================================================================================================================
best acc epoch :  52
validation accuracy :  0.9745454545454545
test accuracy :  0.9744292237442922
last test_accuracy :  0.9694063926940639
second best val :  0.9733333333333334
second best test :  0.9694063926940639
max gap 21
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  29 	 val_accuracy : 0.97333 	 test_accuracy : 0.97123 	 last test_accuracy : 0.96804 	 second best val : 0.97091 	 second best test : 0.97306
k :  1 	 best_acc epoch :  52 	 val_accuracy : 0.97455 	 test_accuracy : 0.97443 	 last test_accuracy : 0.96941 	 second best val : 0.97333 	 second best test : 0.96941

avg :  	 val_accuracy : 0.97394 	 test_accuracy : 0.97283 	 last_accuracy : 0.96872 	 second best val : 0.97212 	 second best test : 0.97123

std :  	 val_accuracy : 0.00061 	 test_accuracy : 0.00160 	 last_accuracy : 0.00068 	 second best val : 0.00121 	 second best test : 0.00183
