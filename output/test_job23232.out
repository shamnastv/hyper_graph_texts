date and time :  Tue Jan 26 19:41:46 2021
Namespace(batch_size=16, dataset='R52', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=200, lda=True, lr=0.0005, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=1e-05)
device :  cuda:0
HGNNModel(
  (word_embeddings): Embedding(9333, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=52, bias=True)
    (1): Linear(in_features=200, out_features=52, bias=True)
    (2): Linear(in_features=200, out_features=52, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  305.7695158608258 Time :  17
accuracy train: 0.912093 val: 0.882622 test: 0.885992
max validation accuracy : 0.882622 max acc epoch : 1.000000 test accuracy : 0.885992

Epoch :  2 loss training:  130.56230628862977 Time :  28
accuracy train: 0.938686 val: 0.903963 test: 0.915175
max validation accuracy : 0.903963 max acc epoch : 2.000000 test accuracy : 0.915175

Epoch :  3 loss training:  92.67224876210093 Time :  39
accuracy train: 0.966294 val: 0.937500 test: 0.921012
max validation accuracy : 0.937500 max acc epoch : 3.000000 test accuracy : 0.921012

Epoch :  4 loss training:  71.2759519747924 Time :  50
accuracy train: 0.974763 val: 0.939024 test: 0.927626
max validation accuracy : 0.939024 max acc epoch : 4.000000 test accuracy : 0.927626

Epoch :  5 loss training:  58.794583698618226 Time :  61
accuracy train: 0.975949 val: 0.931402 test: 0.934630
max validation accuracy : 0.939024 max acc epoch : 4.000000 test accuracy : 0.927626

Epoch :  6 loss training:  40.35995699861087 Time :  72
accuracy train: 0.984417 val: 0.949695 test: 0.936576
max validation accuracy : 0.949695 max acc epoch : 6.000000 test accuracy : 0.936576

Epoch :  7 loss training:  33.602626513224095 Time :  82
accuracy train: 0.989837 val: 0.943598 test: 0.940467
max validation accuracy : 0.949695 max acc epoch : 6.000000 test accuracy : 0.936576

Epoch :  8 loss training:  31.080418927944265 Time :  92
accuracy train: 0.990346 val: 0.948171 test: 0.935409
max validation accuracy : 0.949695 max acc epoch : 6.000000 test accuracy : 0.936576

Epoch :  9 loss training:  28.291068002581596 Time :  103
accuracy train: 0.994411 val: 0.945122 test: 0.938521
max validation accuracy : 0.949695 max acc epoch : 6.000000 test accuracy : 0.936576

Epoch :  10 loss training:  27.55323549179593 Time :  114
accuracy train: 0.995257 val: 0.946646 test: 0.939689
max validation accuracy : 0.949695 max acc epoch : 6.000000 test accuracy : 0.936576

Epoch :  11 loss training:  19.050127397538745 Time :  126
accuracy train: 0.996104 val: 0.945122 test: 0.943580
max validation accuracy : 0.949695 max acc epoch : 6.000000 test accuracy : 0.936576

Epoch :  12 loss training:  17.756800627917983 Time :  137
accuracy train: 0.996782 val: 0.943598 test: 0.941634
max validation accuracy : 0.949695 max acc epoch : 6.000000 test accuracy : 0.936576

Epoch :  13 loss training:  15.662818712502485 Time :  148
accuracy train: 0.996274 val: 0.943598 test: 0.937743
max validation accuracy : 0.949695 max acc epoch : 6.000000 test accuracy : 0.936576

Epoch :  14 loss training:  14.797602449340047 Time :  159
accuracy train: 0.996782 val: 0.946646 test: 0.939689
max validation accuracy : 0.949695 max acc epoch : 6.000000 test accuracy : 0.936576

Epoch :  15 loss training:  13.53608531883583 Time :  170
accuracy train: 0.995935 val: 0.942073 test: 0.939300
max validation accuracy : 0.949695 max acc epoch : 6.000000 test accuracy : 0.936576

Epoch :  16 loss training:  11.532629106783133 Time :  181
accuracy train: 0.996782 val: 0.946646 test: 0.942802
max validation accuracy : 0.949695 max acc epoch : 6.000000 test accuracy : 0.936576

Epoch :  17 loss training:  11.471284708299208 Time :  192
accuracy train: 0.997459 val: 0.945122 test: 0.941634
max validation accuracy : 0.949695 max acc epoch : 6.000000 test accuracy : 0.936576

Epoch :  18 loss training:  10.684913592514931 Time :  203
accuracy train: 0.997290 val: 0.945122 test: 0.941245
max validation accuracy : 0.949695 max acc epoch : 6.000000 test accuracy : 0.936576

Epoch :  19 loss training:  11.556734597761533 Time :  214
accuracy train: 0.996951 val: 0.946646 test: 0.943191
max validation accuracy : 0.949695 max acc epoch : 6.000000 test accuracy : 0.936576

Epoch :  20 loss training:  9.923005038901465 Time :  225
accuracy train: 0.996951 val: 0.945122 test: 0.944747
max validation accuracy : 0.949695 max acc epoch : 6.000000 test accuracy : 0.936576

Epoch :  21 loss training:  9.646173499248107 Time :  236
accuracy train: 0.997629 val: 0.940549 test: 0.942412
max validation accuracy : 0.949695 max acc epoch : 6.000000 test accuracy : 0.936576

Epoch :  22 loss training:  10.162815641542693 Time :  248
accuracy train: 0.997459 val: 0.948171 test: 0.944747
max validation accuracy : 0.949695 max acc epoch : 6.000000 test accuracy : 0.936576

Epoch :  23 loss training:  8.10463438318402 Time :  259
accuracy train: 0.997798 val: 0.946646 test: 0.942023
max validation accuracy : 0.949695 max acc epoch : 6.000000 test accuracy : 0.936576

Epoch :  24 loss training:  8.391498469292856 Time :  270
accuracy train: 0.997967 val: 0.945122 test: 0.942412
max validation accuracy : 0.949695 max acc epoch : 6.000000 test accuracy : 0.936576

Epoch :  25 loss training:  8.333388538783765 Time :  281
accuracy train: 0.997798 val: 0.946646 test: 0.941245
max validation accuracy : 0.949695 max acc epoch : 6.000000 test accuracy : 0.936576

Epoch :  26 loss training:  7.626702195702819 Time :  292
accuracy train: 0.997629 val: 0.948171 test: 0.944358
max validation accuracy : 0.949695 max acc epoch : 6.000000 test accuracy : 0.936576

Epoch :  27 loss training:  7.646054867702333 Time :  303
accuracy train: 0.998137 val: 0.946646 test: 0.941634
max validation accuracy : 0.949695 max acc epoch : 6.000000 test accuracy : 0.936576

========================================================================================================================================================================================================
max acc epoch :  6
max validation accuracy :  0.9496951219512195
test accuracy :  0.9365758754863813
latest_test_accuracy :  0.9416342412451362
========================================================================================================================================================================================================

