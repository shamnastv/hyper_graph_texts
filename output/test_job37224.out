

date and time :  Fri Jun 11 23:51:32 2021
itr : 0
Namespace(batch_size=64, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=25, weight_decay=1e-10)
device :  cuda:0
Counter({0: 7569, 2: 6376, 1: 4901})

Epoch :  1 loss training:  341.5140326321125 Time :  385
accuracy train: 0.797506 val: 0.779841 test: 0.724509
max validation accuracy : 0.779841 max acc epoch : 1 test accuracy : 0.724509
Counter({2: 7618, 0: 6400, 1: 4828})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  203.71135711669922 Time :  519
accuracy train: 0.832368 val: 0.799293 test: 0.750133
max validation accuracy : 0.799293 max acc epoch : 2 test accuracy : 0.750133
Counter({2: 7280, 1: 6751, 0: 4815})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  178.24890285730362 Time :  702
accuracy train: 0.860945 val: 0.817860 test: 0.759825
max validation accuracy : 0.817860 max acc epoch : 3 test accuracy : 0.759825
Counter({0: 8447, 1: 8374, 2: 2025})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  136.37896170467138 Time :  840
accuracy train: 0.908770 val: 0.861185 test: 0.789432
max validation accuracy : 0.861185 max acc epoch : 4 test accuracy : 0.789432
Counter({0: 8477, 1: 8383, 2: 1986})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  119.16072946041822 Time :  947
accuracy train: 0.914269 val: 0.855880 test: 0.794211
max validation accuracy : 0.861185 max acc epoch : 4 test accuracy : 0.789432
Counter({1: 8505, 0: 8367, 2: 1974})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  111.68637432903051 Time :  1051
accuracy train: 0.926937 val: 0.860301 test: 0.799257
max validation accuracy : 0.861185 max acc epoch : 4 test accuracy : 0.789432
Counter({1: 8496, 0: 8381, 2: 1969})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  94.1589732542634 Time :  1155
accuracy train: 0.937248 val: 0.879752 test: 0.809214
max validation accuracy : 0.879752 max acc epoch : 7 test accuracy : 0.809214
Counter({0: 8561, 1: 8320, 2: 1965})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  87.61654897779226 Time :  1265
accuracy train: 0.946185 val: 0.881521 test: 0.810276
max validation accuracy : 0.881521 max acc epoch : 8 test accuracy : 0.810276
Counter({0: 8573, 1: 8305, 2: 1968})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  87.28558136150241 Time :  1374
accuracy train: 0.941569 val: 0.869142 test: 0.807754
max validation accuracy : 0.881521 max acc epoch : 8 test accuracy : 0.810276
Counter({0: 8646, 1: 8231, 2: 1969})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  77.94291619211435 Time :  1475
accuracy train: 0.951095 val: 0.879752 test: 0.814126
max validation accuracy : 0.881521 max acc epoch : 8 test accuracy : 0.810276
Counter({0: 8673, 1: 8207, 2: 1966})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  74.8416497092694 Time :  1581
accuracy train: 0.961799 val: 0.893899 test: 0.820101
max validation accuracy : 0.893899 max acc epoch : 11 test accuracy : 0.820101
Counter({1: 8713, 2: 8169, 0: 1964})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  66.35770072415471 Time :  1696
accuracy train: 0.969459 val: 0.890363 test: 0.818508
max validation accuracy : 0.893899 max acc epoch : 11 test accuracy : 0.820101
Counter({1: 8726, 0: 8157, 2: 1963})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  60.41460494324565 Time :  1801
accuracy train: 0.972798 val: 0.898320 test: 0.823155
max validation accuracy : 0.898320 max acc epoch : 13 test accuracy : 0.823155
Counter({0: 8742, 1: 8142, 2: 1962})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  53.358401130884886 Time :  1908
accuracy train: 0.976038 val: 0.899204 test: 0.826208
max validation accuracy : 0.899204 max acc epoch : 14 test accuracy : 0.826208
Counter({1: 8787, 2: 8097, 0: 1962})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  51.74966857582331 Time :  2011
accuracy train: 0.979083 val: 0.900973 test: 0.825544
max validation accuracy : 0.900973 max acc epoch : 15 test accuracy : 0.825544
Counter({2: 8796, 1: 8087, 0: 1963})

Epoch :  16 loss training:  48.087059147655964 Time :  2116
accuracy train: 0.980654 val: 0.900088 test: 0.828465
max validation accuracy : 0.900973 max acc epoch : 15 test accuracy : 0.825544
Counter({1: 8810, 0: 8073, 2: 1963})

Epoch :  17 loss training:  44.683283193036914 Time :  2224
accuracy train: 0.982029 val: 0.904509 test: 0.828864
max validation accuracy : 0.904509 max acc epoch : 17 test accuracy : 0.828864
Counter({0: 8824, 1: 8060, 2: 1962})

Epoch :  18 loss training:  43.54104474000633 Time :  2332
accuracy train: 0.984288 val: 0.902741 test: 0.828864
max validation accuracy : 0.904509 max acc epoch : 17 test accuracy : 0.828864
Counter({0: 8847, 1: 8035, 2: 1964})

Epoch :  19 loss training:  41.035245571285486 Time :  2440
accuracy train: 0.985957 val: 0.903625 test: 0.832183
max validation accuracy : 0.904509 max acc epoch : 17 test accuracy : 0.828864
Counter({2: 8937, 0: 7943, 1: 1966})

Epoch :  20 loss training:  38.30143572948873 Time :  2545
accuracy train: 0.988117 val: 0.905393 test: 0.834440
max validation accuracy : 0.905393 max acc epoch : 20 test accuracy : 0.834440
Counter({0: 7504, 2: 7158, 1: 4184})

Epoch :  21 loss training:  35.78315347991884 Time :  2655
accuracy train: 0.988314 val: 0.910698 test: 0.830191
max validation accuracy : 0.910698 max acc epoch : 21 test accuracy : 0.830191
Counter({0: 7504, 2: 7160, 1: 4182})

Epoch :  22 loss training:  33.271880719810724 Time :  2775
accuracy train: 0.989198 val: 0.908930 test: 0.832979
max validation accuracy : 0.910698 max acc epoch : 21 test accuracy : 0.830191
Counter({2: 7498, 0: 7166, 1: 4182})

Epoch :  23 loss training:  31.109750352799892 Time :  2882
accuracy train: 0.992046 val: 0.905393 test: 0.835767
max validation accuracy : 0.910698 max acc epoch : 21 test accuracy : 0.830191
Counter({2: 7500, 0: 7160, 1: 4186})

Epoch :  24 loss training:  30.40686284005642 Time :  2986
accuracy train: 0.992733 val: 0.906278 test: 0.835369
max validation accuracy : 0.910698 max acc epoch : 21 test accuracy : 0.830191
Counter({1: 7493, 0: 7161, 2: 4192})

Epoch :  25 loss training:  27.7611271077767 Time :  3093
accuracy train: 0.993715 val: 0.908930 test: 0.834705
max validation accuracy : 0.910698 max acc epoch : 21 test accuracy : 0.830191
Counter({0: 7460, 2: 7197, 1: 4189})

Epoch :  26 loss training:  24.395889059174806 Time :  3196
accuracy train: 0.994402 val: 0.911583 test: 0.837228
max validation accuracy : 0.911583 max acc epoch : 26 test accuracy : 0.837228
Counter({1: 7453, 0: 7199, 2: 4194})

Epoch :  27 loss training:  22.574284707196057 Time :  3304
accuracy train: 0.995483 val: 0.916888 test: 0.836564
max validation accuracy : 0.916888 max acc epoch : 27 test accuracy : 0.836564
Counter({1: 7451, 0: 7197, 2: 4198})

Epoch :  28 loss training:  23.762468183413148 Time :  3406
accuracy train: 0.995679 val: 0.913351 test: 0.837626
max validation accuracy : 0.916888 max acc epoch : 27 test accuracy : 0.836564
Counter({1: 7422, 0: 7214, 2: 4210})

Epoch :  29 loss training:  22.354223967529833 Time :  3514
accuracy train: 0.995974 val: 0.914235 test: 0.841078
max validation accuracy : 0.916888 max acc epoch : 27 test accuracy : 0.836564
Counter({0: 7364, 2: 7262, 1: 4220})

Epoch :  30 loss training:  20.121533941011876 Time :  3620
accuracy train: 0.996759 val: 0.915119 test: 0.838157
max validation accuracy : 0.916888 max acc epoch : 27 test accuracy : 0.836564
Counter({2: 7357, 0: 7266, 1: 4223})

Epoch :  31 loss training:  19.71226711338386 Time :  3726
accuracy train: 0.997152 val: 0.910698 test: 0.838423
max validation accuracy : 0.916888 max acc epoch : 27 test accuracy : 0.836564
Counter({1: 7338, 0: 7278, 2: 4230})

Epoch :  32 loss training:  18.438526533078402 Time :  3828
accuracy train: 0.997250 val: 0.914235 test: 0.840680
max validation accuracy : 0.916888 max acc epoch : 27 test accuracy : 0.836564
Counter({0: 7334, 1: 7279, 2: 4233})

Epoch :  33 loss training:  17.053352679591626 Time :  3932
accuracy train: 0.997643 val: 0.913351 test: 0.837493
max validation accuracy : 0.916888 max acc epoch : 27 test accuracy : 0.836564
Counter({1: 7331, 0: 7282, 2: 4233})

Epoch :  34 loss training:  14.620538162067533 Time :  4035
accuracy train: 0.998036 val: 0.916004 test: 0.838423
max validation accuracy : 0.916888 max acc epoch : 27 test accuracy : 0.836564
Counter({1: 7319, 0: 7292, 2: 4235})

Epoch :  35 loss training:  14.33978619473055 Time :  4139
accuracy train: 0.998134 val: 0.916888 test: 0.837493
max validation accuracy : 0.916888 max acc epoch : 27 test accuracy : 0.836564
Counter({1: 7326, 0: 7290, 2: 4230})

Epoch :  36 loss training:  13.536305082496256 Time :  4244
accuracy train: 0.998429 val: 0.914235 test: 0.838423
max validation accuracy : 0.916888 max acc epoch : 27 test accuracy : 0.836564
Counter({1: 7303, 0: 7299, 2: 4244})

Epoch :  37 loss training:  12.818169670412317 Time :  4346
accuracy train: 0.998723 val: 0.910698 test: 0.841875
max validation accuracy : 0.916888 max acc epoch : 27 test accuracy : 0.836564
Counter({2: 7302, 1: 7298, 0: 4246})

Epoch :  38 loss training:  11.630326315294951 Time :  4456
accuracy train: 0.998920 val: 0.917772 test: 0.839883
max validation accuracy : 0.917772 max acc epoch : 38 test accuracy : 0.839883
Counter({1: 7312, 0: 7286, 2: 4248})

Epoch :  39 loss training:  11.284798516659066 Time :  4573
accuracy train: 0.999018 val: 0.918656 test: 0.841078
max validation accuracy : 0.918656 max acc epoch : 39 test accuracy : 0.841078
Counter({0: 7322, 1: 7277, 2: 4247})

Epoch :  40 loss training:  11.27419675863348 Time :  4691
accuracy train: 0.999116 val: 0.916004 test: 0.842539
max validation accuracy : 0.918656 max acc epoch : 39 test accuracy : 0.841078
Counter({2: 7326, 0: 7271, 1: 4249})

Epoch :  41 loss training:  9.85177735448815 Time :  4798
accuracy train: 0.999018 val: 0.918656 test: 0.843335
max validation accuracy : 0.918656 max acc epoch : 39 test accuracy : 0.841078
Counter({2: 7330, 0: 7267, 1: 4249})

Epoch :  42 loss training:  10.029606715892442 Time :  4898
accuracy train: 0.999214 val: 0.921309 test: 0.840149
max validation accuracy : 0.921309 max acc epoch : 42 test accuracy : 0.840149
Counter({0: 7340, 1: 7253, 2: 4253})

Epoch :  43 loss training:  9.061706553213298 Time :  5006
accuracy train: 0.999214 val: 0.922193 test: 0.842804
max validation accuracy : 0.922193 max acc epoch : 43 test accuracy : 0.842804
Counter({0: 7349, 1: 7245, 2: 4252})

Epoch :  44 loss training:  8.510011285194196 Time :  5118
accuracy train: 0.999116 val: 0.919540 test: 0.847318
max validation accuracy : 0.922193 max acc epoch : 43 test accuracy : 0.842804
Counter({1: 7385, 0: 7207, 2: 4254})

Epoch :  45 loss training:  8.075865469349083 Time :  5233
accuracy train: 0.999116 val: 0.922193 test: 0.844663
max validation accuracy : 0.922193 max acc epoch : 43 test accuracy : 0.842804
Counter({0: 7387, 1: 7202, 2: 4257})

Epoch :  46 loss training:  7.70030676771421 Time :  5339
accuracy train: 0.999214 val: 0.919540 test: 0.844530
max validation accuracy : 0.922193 max acc epoch : 43 test accuracy : 0.842804
Counter({1: 7391, 2: 7196, 0: 4259})

Epoch :  47 loss training:  7.2445425286423415 Time :  5449
accuracy train: 0.999116 val: 0.925729 test: 0.844530
max validation accuracy : 0.925729 max acc epoch : 47 test accuracy : 0.844530
Counter({0: 7400, 1: 7185, 2: 4261})

Epoch :  48 loss training:  6.747686129529029 Time :  5553
accuracy train: 0.999214 val: 0.919540 test: 0.847849
max validation accuracy : 0.925729 max acc epoch : 47 test accuracy : 0.844530
Counter({0: 7406, 2: 7177, 1: 4263})

Epoch :  49 loss training:  6.682207052595913 Time :  5658
accuracy train: 0.999607 val: 0.923961 test: 0.847849
max validation accuracy : 0.925729 max acc epoch : 47 test accuracy : 0.844530
Counter({1: 7407, 0: 7176, 2: 4263})

Epoch :  50 loss training:  6.118649781681597 Time :  5764
accuracy train: 0.999607 val: 0.922193 test: 0.847849
max validation accuracy : 0.925729 max acc epoch : 47 test accuracy : 0.844530
Counter({2: 7415, 0: 7166, 1: 4265})

Epoch :  51 loss training:  5.022234612610191 Time :  5876
accuracy train: 0.999607 val: 0.923077 test: 0.846920
max validation accuracy : 0.925729 max acc epoch : 47 test accuracy : 0.844530
Counter({0: 7426, 1: 7156, 2: 4264})

Epoch :  52 loss training:  5.835872395458864 Time :  5977
accuracy train: 0.999411 val: 0.921309 test: 0.847716
max validation accuracy : 0.925729 max acc epoch : 47 test accuracy : 0.844530
Counter({0: 7429, 1: 7149, 2: 4268})

Epoch :  53 loss training:  4.643537140102126 Time :  6082
accuracy train: 0.999509 val: 0.923961 test: 0.847318
max validation accuracy : 0.925729 max acc epoch : 47 test accuracy : 0.844530
Counter({0: 7428, 1: 7149, 2: 4269})

Epoch :  54 loss training:  4.669413343362976 Time :  6191
accuracy train: 0.999116 val: 0.921309 test: 0.845061
max validation accuracy : 0.925729 max acc epoch : 47 test accuracy : 0.844530
Counter({0: 7434, 1: 7143, 2: 4269})

Epoch :  55 loss training:  5.381374955060892 Time :  6311
accuracy train: 0.999214 val: 0.917772 test: 0.846787
max validation accuracy : 0.925729 max acc epoch : 47 test accuracy : 0.844530
Counter({1: 7506, 2: 7074, 0: 4266})

Epoch :  56 loss training:  4.693390206841286 Time :  6416
accuracy train: 0.999509 val: 0.923961 test: 0.846123
max validation accuracy : 0.925729 max acc epoch : 47 test accuracy : 0.844530
Counter({0: 7513, 2: 7066, 1: 4267})

Epoch :  57 loss training:  4.6754473897162825 Time :  6519
accuracy train: 0.999607 val: 0.926614 test: 0.846123
max validation accuracy : 0.926614 max acc epoch : 57 test accuracy : 0.846123
Counter({0: 7515, 2: 7063, 1: 4268})

Epoch :  58 loss training:  5.006866391573567 Time :  6623
accuracy train: 0.999411 val: 0.924845 test: 0.849841
max validation accuracy : 0.926614 max acc epoch : 57 test accuracy : 0.846123
Counter({2: 7546, 0: 7039, 1: 4261})

Epoch :  59 loss training:  3.6615354400128126 Time :  6733
accuracy train: 0.999607 val: 0.926614 test: 0.848380
max validation accuracy : 0.926614 max acc epoch : 57 test accuracy : 0.846123
Counter({1: 7552, 0: 7034, 2: 4260})

Epoch :  60 loss training:  3.892827160190791 Time :  6837
accuracy train: 0.999607 val: 0.924845 test: 0.851301
max validation accuracy : 0.926614 max acc epoch : 57 test accuracy : 0.846123
Counter({1: 7592, 0: 6995, 2: 4259})

Epoch :  61 loss training:  3.343419056152925 Time :  6936
accuracy train: 0.999607 val: 0.922193 test: 0.848646
max validation accuracy : 0.926614 max acc epoch : 57 test accuracy : 0.846123
Counter({0: 7599, 1: 6989, 2: 4258})

Epoch :  62 loss training:  3.7078799918235745 Time :  7043
accuracy train: 0.999607 val: 0.928382 test: 0.849841
max validation accuracy : 0.928382 max acc epoch : 62 test accuracy : 0.849841
Counter({0: 7607, 1: 6979, 2: 4260})

Epoch :  63 loss training:  3.6900623714900576 Time :  7151
accuracy train: 0.999509 val: 0.924845 test: 0.846123
max validation accuracy : 0.928382 max acc epoch : 62 test accuracy : 0.849841
Counter({0: 7624, 2: 6959, 1: 4263})

Epoch :  64 loss training:  3.138141250878107 Time :  7259
accuracy train: 0.999705 val: 0.923961 test: 0.849575
max validation accuracy : 0.928382 max acc epoch : 62 test accuracy : 0.849841
Counter({1: 7639, 0: 6944, 2: 4263})

Epoch :  65 loss training:  2.664034424640704 Time :  7360
accuracy train: 0.999607 val: 0.919540 test: 0.850372
max validation accuracy : 0.928382 max acc epoch : 62 test accuracy : 0.849841
Counter({0: 7638, 1: 6941, 2: 4267})

Epoch :  66 loss training:  3.108240188572381 Time :  7462
accuracy train: 0.999607 val: 0.923077 test: 0.851301
max validation accuracy : 0.928382 max acc epoch : 62 test accuracy : 0.849841
Counter({0: 7643, 1: 6934, 2: 4269})

Epoch :  67 loss training:  3.1600162721879315 Time :  7565
accuracy train: 0.999607 val: 0.921309 test: 0.850239
max validation accuracy : 0.928382 max acc epoch : 62 test accuracy : 0.849841
Counter({0: 7643, 2: 6931, 1: 4272})

Epoch :  68 loss training:  2.7755388181685703 Time :  7672
accuracy train: 0.999607 val: 0.921309 test: 0.848380
max validation accuracy : 0.928382 max acc epoch : 62 test accuracy : 0.849841
Counter({0: 7643, 2: 6928, 1: 4275})

Epoch :  69 loss training:  2.7458791510143783 Time :  7776
accuracy train: 0.999607 val: 0.928382 test: 0.846787
max validation accuracy : 0.928382 max acc epoch : 62 test accuracy : 0.849841
Counter({0: 7649, 2: 6922, 1: 4275})

Epoch :  70 loss training:  2.5060895508213434 Time :  7881
accuracy train: 0.999607 val: 0.923961 test: 0.850372
max validation accuracy : 0.928382 max acc epoch : 62 test accuracy : 0.849841
Counter({2: 7648, 0: 6918, 1: 4280})

Epoch :  71 loss training:  2.6531924285227433 Time :  7982
accuracy train: 0.999607 val: 0.921309 test: 0.852629
max validation accuracy : 0.928382 max acc epoch : 62 test accuracy : 0.849841
Counter({2: 7649, 1: 6912, 0: 4285})

Epoch :  72 loss training:  2.4085632252681535 Time :  8091
accuracy train: 0.999509 val: 0.923961 test: 0.850903
max validation accuracy : 0.928382 max acc epoch : 62 test accuracy : 0.849841
Counter({1: 7665, 0: 6896, 2: 4285})

Epoch :  73 loss training:  2.461231695546303 Time :  8203
accuracy train: 0.999411 val: 0.924845 test: 0.848779
max validation accuracy : 0.928382 max acc epoch : 62 test accuracy : 0.849841
Counter({2: 7676, 0: 6885, 1: 4285})

Epoch :  74 loss training:  2.125914242846193 Time :  8322
accuracy train: 0.999607 val: 0.925729 test: 0.844663
max validation accuracy : 0.928382 max acc epoch : 62 test accuracy : 0.849841
Counter({0: 7675, 1: 6887, 2: 4284})

Epoch :  75 loss training:  2.926146797311958 Time :  8445
accuracy train: 0.999607 val: 0.918656 test: 0.851301
max validation accuracy : 0.928382 max acc epoch : 62 test accuracy : 0.849841
Counter({1: 7692, 2: 6871, 0: 4283})

Epoch :  76 loss training:  2.01267632310919 Time :  8561
accuracy train: 0.999607 val: 0.924845 test: 0.853027
max validation accuracy : 0.928382 max acc epoch : 62 test accuracy : 0.849841
Counter({1: 7698, 0: 6865, 2: 4283})

Epoch :  77 loss training:  1.9942254649286042 Time :  8670
accuracy train: 0.999607 val: 0.923961 test: 0.849442
max validation accuracy : 0.928382 max acc epoch : 62 test accuracy : 0.849841
Counter({2: 7696, 0: 6865, 1: 4285})

Epoch :  78 loss training:  1.940995405166177 Time :  8776
accuracy train: 0.999607 val: 0.923077 test: 0.848513
max validation accuracy : 0.928382 max acc epoch : 62 test accuracy : 0.849841
Counter({1: 7701, 0: 6862, 2: 4283})

Epoch :  79 loss training:  2.171197839154047 Time :  8886
accuracy train: 0.999607 val: 0.927498 test: 0.849044
max validation accuracy : 0.928382 max acc epoch : 62 test accuracy : 0.849841
Counter({1: 7714, 0: 6848, 2: 4284})

Epoch :  80 loss training:  2.0128804685300565 Time :  8986
accuracy train: 0.999607 val: 0.929266 test: 0.848513
max validation accuracy : 0.929266 max acc epoch : 80 test accuracy : 0.848513
Counter({1: 7719, 2: 6844, 0: 4283})

Epoch :  81 loss training:  1.8566018330893712 Time :  9086
accuracy train: 0.999607 val: 0.926614 test: 0.851301
max validation accuracy : 0.929266 max acc epoch : 80 test accuracy : 0.848513
Counter({2: 7727, 0: 6839, 1: 4280})

Epoch :  82 loss training:  1.8029718163379584 Time :  9192
accuracy train: 0.999607 val: 0.923077 test: 0.848911
max validation accuracy : 0.929266 max acc epoch : 80 test accuracy : 0.848513
Counter({0: 7728, 1: 6839, 2: 4279})

Epoch :  83 loss training:  1.8958838944381569 Time :  9313
accuracy train: 0.999607 val: 0.923961 test: 0.849708
max validation accuracy : 0.929266 max acc epoch : 80 test accuracy : 0.848513
Counter({0: 7729, 1: 6836, 2: 4281})

Epoch :  84 loss training:  1.9919796416725148 Time :  9416
accuracy train: 0.999509 val: 0.923077 test: 0.853160
max validation accuracy : 0.929266 max acc epoch : 80 test accuracy : 0.848513
Counter({0: 7733, 1: 6846, 2: 4267})

Epoch :  85 loss training:  1.9780533086304786 Time :  9525
accuracy train: 0.999509 val: 0.925729 test: 0.853691
max validation accuracy : 0.929266 max acc epoch : 80 test accuracy : 0.848513
Counter({2: 7738, 1: 6839, 0: 4269})

Epoch :  86 loss training:  1.5930902360996697 Time :  9628
accuracy train: 0.999509 val: 0.925729 test: 0.853027
max validation accuracy : 0.929266 max acc epoch : 80 test accuracy : 0.848513
Counter({2: 7742, 0: 6835, 1: 4269})

Epoch :  87 loss training:  1.6886131225983263 Time :  9736
accuracy train: 0.999705 val: 0.929266 test: 0.853425
max validation accuracy : 0.929266 max acc epoch : 80 test accuracy : 0.848513
Counter({0: 7749, 1: 6826, 2: 4271})

Epoch :  88 loss training:  1.456621162185911 Time :  9840
accuracy train: 0.999705 val: 0.926614 test: 0.853027
max validation accuracy : 0.929266 max acc epoch : 80 test accuracy : 0.848513
Counter({0: 7752, 1: 6823, 2: 4271})

Epoch :  89 loss training:  1.9010236299509415 Time :  9944
accuracy train: 0.999607 val: 0.929266 test: 0.855284
max validation accuracy : 0.929266 max acc epoch : 80 test accuracy : 0.848513
Counter({0: 7755, 1: 6820, 2: 4271})

Epoch :  90 loss training:  1.7287458790669916 Time :  10051
accuracy train: 0.999607 val: 0.925729 test: 0.856479
max validation accuracy : 0.929266 max acc epoch : 80 test accuracy : 0.848513
Counter({0: 7765, 2: 6807, 1: 4274})

Epoch :  91 loss training:  1.5236737867307966 Time :  10156
accuracy train: 0.999607 val: 0.929266 test: 0.853558
max validation accuracy : 0.929266 max acc epoch : 80 test accuracy : 0.848513
Counter({2: 7776, 0: 6796, 1: 4274})

Epoch :  92 loss training:  1.4357930497353664 Time :  10267
accuracy train: 0.999509 val: 0.930150 test: 0.852496
max validation accuracy : 0.930150 max acc epoch : 92 test accuracy : 0.852496
Counter({0: 7781, 1: 6791, 2: 4274})

Epoch :  93 loss training:  1.6599134816788137 Time :  10372
accuracy train: 0.999607 val: 0.933687 test: 0.852629
max validation accuracy : 0.933687 max acc epoch : 93 test accuracy : 0.852629
Counter({2: 7788, 0: 6787, 1: 4271})

Epoch :  94 loss training:  1.2139145818764518 Time :  10478
accuracy train: 0.999607 val: 0.928382 test: 0.854886
max validation accuracy : 0.933687 max acc epoch : 93 test accuracy : 0.852629
Counter({0: 7794, 1: 6782, 2: 4270})

Epoch :  95 loss training:  1.2398146242048824 Time :  10582
accuracy train: 0.999607 val: 0.927498 test: 0.852496
max validation accuracy : 0.933687 max acc epoch : 93 test accuracy : 0.852629
Counter({2: 7801, 0: 6773, 1: 4272})

Epoch :  96 loss training:  1.1540902269734943 Time :  10685
accuracy train: 0.999607 val: 0.931034 test: 0.854753
max validation accuracy : 0.933687 max acc epoch : 93 test accuracy : 0.852629
Counter({0: 7807, 1: 6766, 2: 4273})

Epoch :  97 loss training:  1.5504522469855146 Time :  10790
accuracy train: 0.999705 val: 0.934571 test: 0.855550
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({0: 7808, 1: 6769, 2: 4269})

Epoch :  98 loss training:  1.3109991026503849 Time :  10893
accuracy train: 0.999607 val: 0.930150 test: 0.857010
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({0: 7816, 1: 6761, 2: 4269})

Epoch :  99 loss training:  0.9749797077383846 Time :  10995
accuracy train: 0.999509 val: 0.927498 test: 0.856479
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({0: 7813, 2: 6758, 1: 4275})

Epoch :  100 loss training:  1.011285856104223 Time :  11103
accuracy train: 0.999705 val: 0.926614 test: 0.856745
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({0: 7814, 2: 6758, 1: 4274})

Epoch :  101 loss training:  1.384509435716609 Time :  11208
accuracy train: 0.999705 val: 0.934571 test: 0.854089
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({2: 7809, 1: 6758, 0: 4279})

Epoch :  102 loss training:  1.1036498470693914 Time :  11313
accuracy train: 0.999607 val: 0.924845 test: 0.855815
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({1: 7807, 0: 6755, 2: 4284})

Epoch :  103 loss training:  1.2368278242956876 Time :  11424
accuracy train: 0.999607 val: 0.927498 test: 0.855284
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({0: 7809, 1: 6753, 2: 4284})

Epoch :  104 loss training:  1.3602114426648768 Time :  11529
accuracy train: 0.999607 val: 0.928382 test: 0.855948
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({2: 7813, 0: 6749, 1: 4284})

Epoch :  105 loss training:  1.430737931645126 Time :  11633
accuracy train: 0.999607 val: 0.928382 test: 0.853558
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({1: 7817, 0: 6743, 2: 4286})

Epoch :  106 loss training:  0.952133328304626 Time :  11734
accuracy train: 0.999705 val: 0.928382 test: 0.856745
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({2: 7830, 0: 6737, 1: 4279})

Epoch :  107 loss training:  1.0928400916491228 Time :  11837
accuracy train: 0.999705 val: 0.930150 test: 0.855948
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({0: 7835, 2: 6735, 1: 4276})

Epoch :  108 loss training:  1.335679281342891 Time :  11941
accuracy train: 0.999705 val: 0.927498 test: 0.857541
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({1: 7837, 0: 6733, 2: 4276})

Epoch :  109 loss training:  1.0485469515551813 Time :  12044
accuracy train: 0.999705 val: 0.925729 test: 0.858338
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({0: 7836, 1: 6735, 2: 4275})

Epoch :  110 loss training:  1.177820145872829 Time :  12154
accuracy train: 0.999607 val: 0.928382 test: 0.856612
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({2: 7841, 0: 6736, 1: 4269})

Epoch :  111 loss training:  0.9818844702922433 Time :  12276
accuracy train: 0.999607 val: 0.925729 test: 0.856745
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({1: 7845, 0: 6735, 2: 4266})

Epoch :  112 loss training:  1.0941886421460367 Time :  12381
accuracy train: 0.999705 val: 0.923077 test: 0.859267
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({0: 7853, 1: 6724, 2: 4269})

Epoch :  113 loss training:  1.1269848418451147 Time :  12490
accuracy train: 0.999607 val: 0.923961 test: 0.854488
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({2: 7854, 1: 6724, 0: 4268})

Epoch :  114 loss training:  0.8136742800124921 Time :  12595
accuracy train: 0.999509 val: 0.925729 test: 0.857939
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({0: 7852, 1: 6723, 2: 4271})

Epoch :  115 loss training:  0.7413056999221226 Time :  12700
accuracy train: 0.999509 val: 0.923077 test: 0.854886
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({2: 7853, 0: 6719, 1: 4274})

Epoch :  116 loss training:  1.3119868752037291 Time :  12829
accuracy train: 0.999607 val: 0.924845 test: 0.856612
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({0: 7864, 2: 6710, 1: 4272})

Epoch :  117 loss training:  0.9997840537762386 Time :  12932
accuracy train: 0.999705 val: 0.926614 test: 0.857276
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({2: 7865, 0: 6712, 1: 4269})

Epoch :  118 loss training:  1.1142249940348847 Time :  13037
accuracy train: 0.999705 val: 0.927498 test: 0.857674
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({0: 7868, 1: 6709, 2: 4269})

Epoch :  119 loss training:  0.5331437890799862 Time :  13152
accuracy train: 0.999607 val: 0.925729 test: 0.855682
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({0: 7876, 1: 6702, 2: 4268})

Epoch :  120 loss training:  1.1960041430065758 Time :  13260
accuracy train: 0.999607 val: 0.928382 test: 0.857939
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({0: 7874, 1: 6711, 2: 4261})

Epoch :  121 loss training:  0.9010317513166228 Time :  13366
accuracy train: 0.999705 val: 0.924845 test: 0.856479
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({2: 7876, 0: 6707, 1: 4263})

Epoch :  122 loss training:  0.8546092605538433 Time :  13472
accuracy train: 0.999607 val: 0.927498 test: 0.855417
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({0: 7880, 2: 6711, 1: 4255})

Epoch :  123 loss training:  0.7900916995931766 Time :  13581
accuracy train: 0.999607 val: 0.925729 test: 0.857010
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({0: 7880, 1: 6712, 2: 4254})

Epoch :  124 loss training:  0.9090438317880398 Time :  13687
accuracy train: 0.999607 val: 0.926614 test: 0.855948
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({0: 7890, 1: 6706, 2: 4250})

Epoch :  125 loss training:  0.8992326856960062 Time :  13791
accuracy train: 0.999607 val: 0.924845 test: 0.853824
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({0: 7892, 1: 6705, 2: 4249})

Epoch :  126 loss training:  0.9490295758005232 Time :  13897
accuracy train: 0.999607 val: 0.930150 test: 0.855151
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({1: 7877, 0: 6724, 2: 4245})

Epoch :  127 loss training:  0.7727727011879324 Time :  13999
accuracy train: 0.999607 val: 0.927498 test: 0.857541
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({1: 7876, 0: 6726, 2: 4244})

Epoch :  128 loss training:  0.9240722055019432 Time :  14106
accuracy train: 0.999705 val: 0.930150 test: 0.854753
max validation accuracy : 0.934571 max acc epoch : 97 test accuracy : 0.855550
Counter({2: 7875, 0: 6725, 1: 4246})

========================================================================================================================================================================================================
best acc epoch :  97
validation accuracy :  0.9345711759504863
test accuracy :  0.8555496548061604
last test_accuracy :  0.854753053637812
second best val :  0.9336870026525199
second best test :  0.8526287838555496
max gap 18
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=25, weight_decay=1e-10)
device :  cuda:0
Counter({0: 7569, 2: 6376, 1: 4901})

Epoch :  1 loss training:  341.12461534142494 Time :  14222
accuracy train: 0.795247 val: 0.767462 test: 0.726102
max validation accuracy : 0.767462 max acc epoch : 1 test accuracy : 0.726102
Counter({1: 7520, 0: 6457, 2: 4869})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  203.69940039515495 Time :  14331
accuracy train: 0.838063 val: 0.799293 test: 0.761152
max validation accuracy : 0.799293 max acc epoch : 2 test accuracy : 0.761152
Counter({1: 7755, 0: 6243, 2: 4848})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  175.98765444755554 Time :  14430
accuracy train: 0.852696 val: 0.823165 test: 0.753319
max validation accuracy : 0.823165 max acc epoch : 3 test accuracy : 0.753319
Counter({1: 8029, 2: 6341, 0: 4476})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  136.60980305075645 Time :  14542
accuracy train: 0.906314 val: 0.851459 test: 0.791158
max validation accuracy : 0.851459 max acc epoch : 4 test accuracy : 0.791158
Counter({0: 7922, 1: 6587, 2: 4337})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  117.8357749953866 Time :  14646
accuracy train: 0.914367 val: 0.847922 test: 0.792087
max validation accuracy : 0.851459 max acc epoch : 4 test accuracy : 0.791158
Counter({0: 8007, 1: 6529, 2: 4310})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  111.71834971755743 Time :  14744
accuracy train: 0.926151 val: 0.857648 test: 0.800319
max validation accuracy : 0.857648 max acc epoch : 6 test accuracy : 0.800319
Counter({1: 8011, 2: 6551, 0: 4284})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  93.17850466817617 Time :  14845
accuracy train: 0.942551 val: 0.876216 test: 0.812002
max validation accuracy : 0.876216 max acc epoch : 7 test accuracy : 0.812002
Counter({1: 7940, 0: 6553, 2: 4353})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  88.1799663901329 Time :  14948
accuracy train: 0.947461 val: 0.879752 test: 0.809214
max validation accuracy : 0.879752 max acc epoch : 8 test accuracy : 0.809214
Counter({1: 7927, 2: 6543, 0: 4376})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  85.7902582027018 Time :  15044
accuracy train: 0.950997 val: 0.882405 test: 0.813064
max validation accuracy : 0.882405 max acc epoch : 9 test accuracy : 0.813064
Counter({0: 7922, 1: 6538, 2: 4386})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  77.59621255099773 Time :  15147
accuracy train: 0.955809 val: 0.877984 test: 0.814392
max validation accuracy : 0.882405 max acc epoch : 9 test accuracy : 0.813064
Counter({1: 7898, 2: 6535, 0: 4413})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  75.32313209585845 Time :  15257
accuracy train: 0.963861 val: 0.889478 test: 0.821694
max validation accuracy : 0.889478 max acc epoch : 11 test accuracy : 0.821694
Counter({0: 7896, 1: 6539, 2: 4411})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  67.70341691747308 Time :  15368
accuracy train: 0.968968 val: 0.890363 test: 0.820366
max validation accuracy : 0.890363 max acc epoch : 12 test accuracy : 0.820366
Counter({2: 7885, 0: 6551, 1: 4410})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  58.07235085219145 Time :  15488
accuracy train: 0.973878 val: 0.896552 test: 0.824084
max validation accuracy : 0.896552 max acc epoch : 13 test accuracy : 0.824084
Counter({0: 7881, 1: 6556, 2: 4409})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.07603136077523 Time :  15598
accuracy train: 0.975351 val: 0.901857 test: 0.827005
max validation accuracy : 0.901857 max acc epoch : 14 test accuracy : 0.827005
Counter({0: 7870, 1: 6564, 2: 4412})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  50.83429549820721 Time :  15712
accuracy train: 0.977904 val: 0.898320 test: 0.825943
max validation accuracy : 0.901857 max acc epoch : 14 test accuracy : 0.827005
Counter({2: 7858, 0: 6567, 1: 4421})

Epoch :  16 loss training:  47.478724563494325 Time :  15819
accuracy train: 0.980163 val: 0.900088 test: 0.828731
max validation accuracy : 0.901857 max acc epoch : 14 test accuracy : 0.827005
Counter({1: 7850, 0: 6576, 2: 4420})

Epoch :  17 loss training:  44.832847226411104 Time :  15930
accuracy train: 0.983011 val: 0.900973 test: 0.828731
max validation accuracy : 0.901857 max acc epoch : 14 test accuracy : 0.827005
Counter({0: 7851, 2: 6576, 1: 4419})

Epoch :  18 loss training:  42.96245602145791 Time :  16037
accuracy train: 0.983895 val: 0.902741 test: 0.830988
max validation accuracy : 0.902741 max acc epoch : 18 test accuracy : 0.830988
Counter({2: 7825, 0: 6602, 1: 4419})

Epoch :  19 loss training:  40.164994424209 Time :  16148
accuracy train: 0.985270 val: 0.903625 test: 0.832714
max validation accuracy : 0.903625 max acc epoch : 19 test accuracy : 0.832714
Counter({1: 7814, 0: 6600, 2: 4432})

Epoch :  20 loss training:  38.560336481779814 Time :  16252
accuracy train: 0.987332 val: 0.905393 test: 0.830722
max validation accuracy : 0.905393 max acc epoch : 20 test accuracy : 0.830722
Counter({2: 7808, 0: 6608, 1: 4430})

Epoch :  21 loss training:  35.07928181812167 Time :  16361
accuracy train: 0.989099 val: 0.903625 test: 0.831253
max validation accuracy : 0.905393 max acc epoch : 20 test accuracy : 0.830722
Counter({1: 7794, 0: 6619, 2: 4433})

Epoch :  22 loss training:  32.9219338404946 Time :  16467
accuracy train: 0.990965 val: 0.908046 test: 0.835502
max validation accuracy : 0.908046 max acc epoch : 22 test accuracy : 0.835502
Counter({1: 7782, 0: 6633, 2: 4431})

Epoch :  23 loss training:  31.18879281822592 Time :  16576
accuracy train: 0.992340 val: 0.907162 test: 0.834572
max validation accuracy : 0.908046 max acc epoch : 22 test accuracy : 0.835502
Counter({0: 7757, 2: 6666, 1: 4423})

Epoch :  24 loss training:  28.967644727788866 Time :  16679
accuracy train: 0.992733 val: 0.912467 test: 0.836564
max validation accuracy : 0.912467 max acc epoch : 24 test accuracy : 0.836564
Counter({2: 7749, 0: 6675, 1: 4422})

Epoch :  25 loss training:  27.504520173184574 Time :  16784
accuracy train: 0.993715 val: 0.909814 test: 0.837493
max validation accuracy : 0.912467 max acc epoch : 24 test accuracy : 0.836564
Counter({1: 7722, 0: 6705, 2: 4419})

Epoch :  26 loss training:  26.31903258524835 Time :  16891
accuracy train: 0.994599 val: 0.914235 test: 0.839352
max validation accuracy : 0.914235 max acc epoch : 26 test accuracy : 0.839352
Counter({0: 7708, 2: 6718, 1: 4420})

Epoch :  27 loss training:  24.81657486502081 Time :  16997
accuracy train: 0.995286 val: 0.910698 test: 0.837759
max validation accuracy : 0.914235 max acc epoch : 26 test accuracy : 0.839352
Counter({1: 7680, 0: 6742, 2: 4424})

Epoch :  28 loss training:  22.40575381089002 Time :  17133
accuracy train: 0.995384 val: 0.913351 test: 0.838157
max validation accuracy : 0.914235 max acc epoch : 26 test accuracy : 0.839352
Counter({0: 7653, 2: 6774, 1: 4419})

Epoch :  29 loss training:  22.11196092586033 Time :  17247
accuracy train: 0.996268 val: 0.911583 test: 0.838157
max validation accuracy : 0.914235 max acc epoch : 26 test accuracy : 0.839352
Counter({1: 7622, 0: 6804, 2: 4420})

Epoch :  30 loss training:  21.128813105635345 Time :  17353
accuracy train: 0.996465 val: 0.912467 test: 0.837892
max validation accuracy : 0.914235 max acc epoch : 26 test accuracy : 0.839352
Counter({1: 7559, 0: 6871, 2: 4416})

Epoch :  31 loss training:  18.947575457859784 Time :  17456
accuracy train: 0.997545 val: 0.912467 test: 0.842140
max validation accuracy : 0.914235 max acc epoch : 26 test accuracy : 0.839352
Counter({0: 7445, 2: 6991, 1: 4410})

Epoch :  32 loss training:  17.997617865446955 Time :  17564
accuracy train: 0.997741 val: 0.911583 test: 0.840281
max validation accuracy : 0.914235 max acc epoch : 26 test accuracy : 0.839352
Counter({1: 7438, 0: 6994, 2: 4414})

Epoch :  33 loss training:  15.646746147889644 Time :  17673
accuracy train: 0.997741 val: 0.914235 test: 0.841742
max validation accuracy : 0.914235 max acc epoch : 26 test accuracy : 0.839352
Counter({0: 7437, 2: 6997, 1: 4412})

Epoch :  34 loss training:  15.77813134668395 Time :  17775
accuracy train: 0.998134 val: 0.914235 test: 0.839485
max validation accuracy : 0.914235 max acc epoch : 26 test accuracy : 0.839352
Counter({0: 7421, 2: 7013, 1: 4412})

Epoch :  35 loss training:  14.401687074452639 Time :  17886
accuracy train: 0.998331 val: 0.910698 test: 0.839219
max validation accuracy : 0.914235 max acc epoch : 26 test accuracy : 0.839352
Counter({0: 7415, 2: 7020, 1: 4411})

Epoch :  36 loss training:  13.097783590201288 Time :  17996
accuracy train: 0.998134 val: 0.915119 test: 0.840680
max validation accuracy : 0.915119 max acc epoch : 36 test accuracy : 0.840680
Counter({1: 7413, 0: 7026, 2: 4407})

Epoch :  37 loss training:  12.380587345920503 Time :  18109
accuracy train: 0.998723 val: 0.913351 test: 0.842937
max validation accuracy : 0.915119 max acc epoch : 36 test accuracy : 0.840680
Counter({2: 7410, 1: 7024, 0: 4412})

Epoch :  38 loss training:  12.425493652001023 Time :  18225
accuracy train: 0.998822 val: 0.914235 test: 0.840281
max validation accuracy : 0.915119 max acc epoch : 36 test accuracy : 0.840680
Counter({2: 7413, 1: 7022, 0: 4411})

Epoch :  39 loss training:  11.637811986496672 Time :  18331
accuracy train: 0.999116 val: 0.912467 test: 0.842539
max validation accuracy : 0.915119 max acc epoch : 36 test accuracy : 0.840680
Counter({2: 7362, 0: 7071, 1: 4413})

Epoch :  40 loss training:  10.941046190680936 Time :  18438
accuracy train: 0.998920 val: 0.912467 test: 0.842671
max validation accuracy : 0.915119 max acc epoch : 36 test accuracy : 0.840680
Counter({2: 7358, 1: 7077, 0: 4411})

Epoch :  41 loss training:  9.513259030645713 Time :  18545
accuracy train: 0.999116 val: 0.913351 test: 0.841609
max validation accuracy : 0.915119 max acc epoch : 36 test accuracy : 0.840680
Counter({1: 7360, 0: 7081, 2: 4405})

Epoch :  42 loss training:  9.636111377738416 Time :  18649
accuracy train: 0.999214 val: 0.915119 test: 0.843202
max validation accuracy : 0.915119 max acc epoch : 36 test accuracy : 0.840680
Counter({0: 7355, 1: 7088, 2: 4403})

Epoch :  43 loss training:  7.861374029889703 Time :  18756
accuracy train: 0.999214 val: 0.916004 test: 0.841609
max validation accuracy : 0.916004 max acc epoch : 43 test accuracy : 0.841609
Counter({2: 7338, 0: 7107, 1: 4401})

Epoch :  44 loss training:  8.236818908248097 Time :  18861
accuracy train: 0.999116 val: 0.918656 test: 0.842140
max validation accuracy : 0.918656 max acc epoch : 44 test accuracy : 0.842140
Counter({0: 7318, 2: 7123, 1: 4405})

Epoch :  45 loss training:  7.834219985990785 Time :  18965
accuracy train: 0.999116 val: 0.919540 test: 0.841211
max validation accuracy : 0.919540 max acc epoch : 45 test accuracy : 0.841211
Counter({1: 7306, 0: 7134, 2: 4406})

Epoch :  46 loss training:  7.152666845591739 Time :  19074
accuracy train: 0.999313 val: 0.919540 test: 0.844397
max validation accuracy : 0.919540 max acc epoch : 45 test accuracy : 0.841211
Counter({2: 7275, 0: 7162, 1: 4409})

Epoch :  47 loss training:  7.731563582841773 Time :  19183
accuracy train: 0.999411 val: 0.918656 test: 0.843070
max validation accuracy : 0.919540 max acc epoch : 45 test accuracy : 0.841211
Counter({2: 7267, 1: 7164, 0: 4415})

Epoch :  48 loss training:  7.259886837622616 Time :  19303
accuracy train: 0.999313 val: 0.916888 test: 0.839750
max validation accuracy : 0.919540 max acc epoch : 45 test accuracy : 0.841211
Counter({1: 7251, 0: 7184, 2: 4411})

Epoch :  49 loss training:  5.819705484434962 Time :  19408
accuracy train: 0.999313 val: 0.919540 test: 0.841476
max validation accuracy : 0.919540 max acc epoch : 45 test accuracy : 0.841211
Counter({0: 7253, 1: 7190, 2: 4403})

Epoch :  50 loss training:  6.649328711442649 Time :  19511
accuracy train: 0.999607 val: 0.918656 test: 0.843999
max validation accuracy : 0.919540 max acc epoch : 45 test accuracy : 0.841211
Counter({1: 7245, 0: 7203, 2: 4398})

Epoch :  51 loss training:  5.80939768999815 Time :  19620
accuracy train: 0.999607 val: 0.920424 test: 0.843468
max validation accuracy : 0.920424 max acc epoch : 51 test accuracy : 0.843468
Counter({2: 7243, 1: 7205, 0: 4398})

Epoch :  52 loss training:  5.5922675168840215 Time :  19724
accuracy train: 0.999509 val: 0.920424 test: 0.845327
max validation accuracy : 0.920424 max acc epoch : 51 test accuracy : 0.843468
Counter({0: 7236, 2: 7214, 1: 4396})

Epoch :  53 loss training:  5.5037655539345 Time :  19826
accuracy train: 0.999411 val: 0.916004 test: 0.843999
max validation accuracy : 0.920424 max acc epoch : 51 test accuracy : 0.843468
Counter({0: 7271, 1: 7179, 2: 4396})

Epoch :  54 loss training:  5.151032125751954 Time :  19931
accuracy train: 0.999509 val: 0.919540 test: 0.845725
max validation accuracy : 0.920424 max acc epoch : 51 test accuracy : 0.843468
Counter({2: 7284, 1: 7166, 0: 4396})

Epoch :  55 loss training:  4.187635796319228 Time :  20039
accuracy train: 0.999116 val: 0.916888 test: 0.842671
max validation accuracy : 0.920424 max acc epoch : 51 test accuracy : 0.843468
Counter({2: 7309, 1: 7144, 0: 4393})

Epoch :  56 loss training:  4.291437560721533 Time :  20149
accuracy train: 0.999607 val: 0.920424 test: 0.843601
max validation accuracy : 0.920424 max acc epoch : 51 test accuracy : 0.843468
Counter({2: 7370, 1: 7091, 0: 4385})

Epoch :  57 loss training:  4.231383854930755 Time :  20256
accuracy train: 0.999509 val: 0.920424 test: 0.845592
max validation accuracy : 0.920424 max acc epoch : 51 test accuracy : 0.843468
Counter({0: 7374, 1: 7087, 2: 4385})

Epoch :  58 loss training:  4.041316241782624 Time :  20363
accuracy train: 0.999509 val: 0.919540 test: 0.846123
max validation accuracy : 0.920424 max acc epoch : 51 test accuracy : 0.843468
Counter({1: 7432, 0: 7034, 2: 4380})

Epoch :  59 loss training:  4.4737858230946586 Time :  20468
accuracy train: 0.999607 val: 0.925729 test: 0.848380
max validation accuracy : 0.925729 max acc epoch : 59 test accuracy : 0.848380
Counter({0: 7439, 2: 7031, 1: 4376})

Epoch :  60 loss training:  3.9487743226636667 Time :  20572
accuracy train: 0.999313 val: 0.923077 test: 0.846787
max validation accuracy : 0.925729 max acc epoch : 59 test accuracy : 0.848380
Counter({1: 7461, 2: 7023, 0: 4362})

Epoch :  61 loss training:  3.8199451889668126 Time :  20678
accuracy train: 0.999509 val: 0.922193 test: 0.848646
max validation accuracy : 0.925729 max acc epoch : 59 test accuracy : 0.848380
Counter({0: 7466, 1: 7019, 2: 4361})

Epoch :  62 loss training:  3.3410384164744755 Time :  20790
accuracy train: 0.999509 val: 0.925729 test: 0.846920
max validation accuracy : 0.925729 max acc epoch : 59 test accuracy : 0.848380
Counter({0: 7462, 1: 7025, 2: 4359})

Epoch :  63 loss training:  3.3519109034969006 Time :  20902
accuracy train: 0.999509 val: 0.920424 test: 0.843468
max validation accuracy : 0.925729 max acc epoch : 59 test accuracy : 0.848380
Counter({0: 7455, 2: 7043, 1: 4348})

Epoch :  64 loss training:  3.1818440544593614 Time :  21011
accuracy train: 0.999509 val: 0.918656 test: 0.847584
max validation accuracy : 0.925729 max acc epoch : 59 test accuracy : 0.848380
Counter({2: 7466, 1: 7034, 0: 4346})

Epoch :  65 loss training:  2.911328823567601 Time :  21137
accuracy train: 0.999509 val: 0.924845 test: 0.850239
max validation accuracy : 0.925729 max acc epoch : 59 test accuracy : 0.848380
Counter({2: 7461, 0: 7040, 1: 4345})

Epoch :  66 loss training:  3.1049564829736482 Time :  21251
accuracy train: 0.999411 val: 0.923961 test: 0.849708
max validation accuracy : 0.925729 max acc epoch : 59 test accuracy : 0.848380
Counter({2: 7470, 1: 7039, 0: 4337})

Epoch :  67 loss training:  2.651770517375553 Time :  21356
accuracy train: 0.999607 val: 0.925729 test: 0.850770
max validation accuracy : 0.925729 max acc epoch : 59 test accuracy : 0.848380
Counter({1: 7476, 0: 7030, 2: 4340})

Epoch :  68 loss training:  2.7962693070439855 Time :  21463
accuracy train: 0.999509 val: 0.923077 test: 0.851699
max validation accuracy : 0.925729 max acc epoch : 59 test accuracy : 0.848380
Counter({2: 7486, 0: 7020, 1: 4340})

Epoch :  69 loss training:  2.5643270706641488 Time :  21568
accuracy train: 0.999509 val: 0.929266 test: 0.849177
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({1: 7494, 0: 7018, 2: 4334})

Epoch :  70 loss training:  2.4195889054535655 Time :  21676
accuracy train: 0.999509 val: 0.923961 test: 0.847982
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({1: 7501, 0: 7016, 2: 4329})

Epoch :  71 loss training:  2.766919813293498 Time :  21777
accuracy train: 0.999411 val: 0.924845 test: 0.847185
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({0: 7512, 1: 7005, 2: 4329})

Epoch :  72 loss training:  2.5075092441111337 Time :  21886
accuracy train: 0.999411 val: 0.928382 test: 0.848646
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({0: 7521, 1: 7005, 2: 4320})

Epoch :  73 loss training:  1.815427041001385 Time :  21994
accuracy train: 0.999411 val: 0.921309 test: 0.851301
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({2: 7526, 1: 7006, 0: 4314})

Epoch :  74 loss training:  2.1376396124687744 Time :  22099
accuracy train: 0.999509 val: 0.916888 test: 0.851168
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({0: 7529, 1: 7003, 2: 4314})

Epoch :  75 loss training:  2.636904458020581 Time :  22214
accuracy train: 0.999509 val: 0.922193 test: 0.851301
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({1: 7535, 0: 6999, 2: 4312})

Epoch :  76 loss training:  2.117126161872875 Time :  22316
accuracy train: 0.999509 val: 0.926614 test: 0.850505
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({0: 7540, 1: 6994, 2: 4312})

Epoch :  77 loss training:  2.2933627741003875 Time :  22422
accuracy train: 0.999607 val: 0.926614 test: 0.851168
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({0: 7544, 2: 6989, 1: 4313})

Epoch :  78 loss training:  2.0730326991906622 Time :  22528
accuracy train: 0.999509 val: 0.922193 test: 0.849044
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({0: 7552, 1: 6983, 2: 4311})

Epoch :  79 loss training:  1.9974715506468783 Time :  22630
accuracy train: 0.999214 val: 0.917772 test: 0.851567
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({1: 7561, 2: 6972, 0: 4313})

Epoch :  80 loss training:  1.936756394825352 Time :  22737
accuracy train: 0.999607 val: 0.923961 test: 0.850637
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({2: 7571, 1: 6960, 0: 4315})

Epoch :  81 loss training:  1.8874890895895078 Time :  22848
accuracy train: 0.999607 val: 0.917772 test: 0.849973
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({0: 7581, 1: 6952, 2: 4313})

Epoch :  82 loss training:  2.322893788907095 Time :  22954
accuracy train: 0.999509 val: 0.922193 test: 0.848911
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({0: 7601, 1: 6931, 2: 4314})

Epoch :  83 loss training:  1.8234756013334845 Time :  23060
accuracy train: 0.999411 val: 0.924845 test: 0.852363
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({0: 7620, 1: 6912, 2: 4314})

Epoch :  84 loss training:  2.1811626237431483 Time :  23173
accuracy train: 0.999607 val: 0.922193 test: 0.851832
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({0: 7625, 1: 6912, 2: 4309})

Epoch :  85 loss training:  1.3193136537302053 Time :  23281
accuracy train: 0.999607 val: 0.925729 test: 0.850372
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({0: 7629, 1: 6908, 2: 4309})

Epoch :  86 loss training:  1.9919995570744504 Time :  23397
accuracy train: 0.999607 val: 0.927498 test: 0.846787
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({2: 7634, 1: 6903, 0: 4309})

Epoch :  87 loss training:  1.4426836001948686 Time :  23513
accuracy train: 0.999607 val: 0.923961 test: 0.853425
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({0: 7639, 1: 6896, 2: 4311})

Epoch :  88 loss training:  1.6990974307263969 Time :  23624
accuracy train: 0.999607 val: 0.923077 test: 0.850637
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({0: 7648, 1: 6887, 2: 4311})

Epoch :  89 loss training:  1.7212602322397288 Time :  23731
accuracy train: 0.999607 val: 0.925729 test: 0.852098
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({0: 7647, 1: 6887, 2: 4312})

Epoch :  90 loss training:  1.4733788399535115 Time :  23835
accuracy train: 0.999607 val: 0.921309 test: 0.852762
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({0: 7656, 2: 6879, 1: 4311})

Epoch :  91 loss training:  1.9000451927568065 Time :  23942
accuracy train: 0.999411 val: 0.920424 test: 0.852894
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({1: 7655, 0: 6882, 2: 4309})

Epoch :  92 loss training:  1.5992348379586474 Time :  24047
accuracy train: 0.999607 val: 0.920424 test: 0.853293
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({1: 7661, 2: 6876, 0: 4309})

Epoch :  93 loss training:  1.601103213884926 Time :  24151
accuracy train: 0.999607 val: 0.919540 test: 0.853956
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({0: 7662, 2: 6874, 1: 4310})

Epoch :  94 loss training:  1.4121879112790339 Time :  24255
accuracy train: 0.999607 val: 0.925729 test: 0.852230
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({1: 7663, 2: 6869, 0: 4314})

Epoch :  95 loss training:  0.9870351785648381 Time :  24363
accuracy train: 0.999607 val: 0.923961 test: 0.852629
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({0: 7666, 1: 6867, 2: 4313})

Epoch :  96 loss training:  1.6781608048986527 Time :  24478
accuracy train: 0.999607 val: 0.926614 test: 0.851567
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({0: 7668, 1: 6863, 2: 4315})

Epoch :  97 loss training:  1.5459449236623186 Time :  24584
accuracy train: 0.999607 val: 0.923961 test: 0.852762
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({1: 7671, 2: 6864, 0: 4311})

Epoch :  98 loss training:  1.1408901129871083 Time :  24696
accuracy train: 0.999705 val: 0.927498 test: 0.853691
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({0: 7674, 1: 6863, 2: 4309})

Epoch :  99 loss training:  1.1413798871053586 Time :  24800
accuracy train: 0.999607 val: 0.923961 test: 0.856081
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({2: 7677, 0: 6860, 1: 4309})

Epoch :  100 loss training:  0.9822529310258687 Time :  24908
accuracy train: 0.999607 val: 0.926614 test: 0.856877
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.849177
Counter({1: 7678, 2: 6860, 0: 4308})

========================================================================================================================================================================================================
best acc epoch :  69
validation accuracy :  0.9292661361626879
test accuracy :  0.8491768454593733
last test_accuracy :  0.8568773234200744
second best val :  0.9283819628647215
second best test :  0.8491768454593733
max gap 10
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=25, weight_decay=1e-10)
device :  cuda:0
Counter({0: 7569, 2: 6376, 1: 4901})

Epoch :  1 loss training:  340.7520911991596 Time :  25027
accuracy train: 0.793087 val: 0.769231 test: 0.724642
max validation accuracy : 0.769231 max acc epoch : 1 test accuracy : 0.724642
Counter({2: 7528, 0: 6459, 1: 4859})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  203.1525217294693 Time :  25130
accuracy train: 0.841402 val: 0.804598 test: 0.761152
max validation accuracy : 0.804598 max acc epoch : 2 test accuracy : 0.761152
Counter({1: 7619, 2: 6370, 0: 4857})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  174.69599299132824 Time :  25230
accuracy train: 0.866935 val: 0.825818 test: 0.758630
max validation accuracy : 0.825818 max acc epoch : 3 test accuracy : 0.758630
Counter({0: 8466, 2: 8342, 1: 2038})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  135.42679005116224 Time :  25331
accuracy train: 0.903467 val: 0.851459 test: 0.786113
max validation accuracy : 0.851459 max acc epoch : 4 test accuracy : 0.786113
Counter({0: 8442, 1: 8382, 2: 2022})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  118.71253471076488 Time :  25434
accuracy train: 0.918884 val: 0.849691 test: 0.796468
max validation accuracy : 0.851459 max acc epoch : 4 test accuracy : 0.786113
Counter({1: 8450, 0: 8390, 2: 2006})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  113.59130391478539 Time :  25548
accuracy train: 0.927919 val: 0.857648 test: 0.801912
max validation accuracy : 0.857648 max acc epoch : 6 test accuracy : 0.801912
Counter({2: 8465, 0: 8385, 1: 1996})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  92.22182891517878 Time :  25646
accuracy train: 0.944319 val: 0.877100 test: 0.810542
max validation accuracy : 0.877100 max acc epoch : 7 test accuracy : 0.810542
Counter({1: 8561, 0: 8288, 2: 1997})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  88.18189259618521 Time :  25745
accuracy train: 0.948345 val: 0.876216 test: 0.808816
max validation accuracy : 0.877100 max acc epoch : 7 test accuracy : 0.810542
Counter({0: 8590, 2: 8260, 1: 1996})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  84.61046423763037 Time :  25842
accuracy train: 0.950800 val: 0.885942 test: 0.810674
max validation accuracy : 0.885942 max acc epoch : 9 test accuracy : 0.810674
Counter({2: 8661, 1: 8197, 0: 1988})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  76.83333990722895 Time :  25944
accuracy train: 0.955809 val: 0.884173 test: 0.814657
max validation accuracy : 0.885942 max acc epoch : 9 test accuracy : 0.810674
Counter({0: 8679, 1: 8180, 2: 1987})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  74.47291391342878 Time :  26054
accuracy train: 0.961897 val: 0.888594 test: 0.820898
max validation accuracy : 0.888594 max acc epoch : 11 test accuracy : 0.820898
Counter({1: 8681, 0: 8180, 2: 1985})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  66.45812263339758 Time :  26161
accuracy train: 0.970932 val: 0.893899 test: 0.822623
max validation accuracy : 0.893899 max acc epoch : 12 test accuracy : 0.822623
Counter({2: 8694, 1: 8171, 0: 1981})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  59.972508650273085 Time :  26274
accuracy train: 0.974467 val: 0.894783 test: 0.823287
max validation accuracy : 0.894783 max acc epoch : 13 test accuracy : 0.823287
Counter({2: 8699, 0: 8166, 1: 1981})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  52.90209816582501 Time :  26378
accuracy train: 0.976333 val: 0.897436 test: 0.825943
max validation accuracy : 0.897436 max acc epoch : 14 test accuracy : 0.825943
Counter({2: 8702, 0: 8161, 1: 1983})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  50.16413184814155 Time :  26490
accuracy train: 0.977904 val: 0.897436 test: 0.826739
max validation accuracy : 0.897436 max acc epoch : 14 test accuracy : 0.825943
Counter({0: 8703, 1: 8160, 2: 1983})

Epoch :  16 loss training:  48.78167896345258 Time :  26599
accuracy train: 0.980850 val: 0.901857 test: 0.828864
max validation accuracy : 0.901857 max acc epoch : 16 test accuracy : 0.828864
Counter({1: 8710, 0: 8155, 2: 1981})

Epoch :  17 loss training:  45.09757383167744 Time :  26708
accuracy train: 0.982422 val: 0.901857 test: 0.828067
max validation accuracy : 0.901857 max acc epoch : 16 test accuracy : 0.828864
Counter({1: 8729, 0: 8136, 2: 1981})

Epoch :  18 loss training:  42.697714917361736 Time :  26821
accuracy train: 0.985564 val: 0.904509 test: 0.829926
max validation accuracy : 0.904509 max acc epoch : 18 test accuracy : 0.829926
Counter({2: 8803, 1: 8060, 0: 1983})

Epoch :  19 loss training:  40.504203813150525 Time :  26931
accuracy train: 0.986350 val: 0.905393 test: 0.830589
max validation accuracy : 0.905393 max acc epoch : 19 test accuracy : 0.830589
Counter({1: 8844, 0: 8018, 2: 1984})

Epoch :  20 loss training:  37.36523765511811 Time :  27040
accuracy train: 0.988019 val: 0.897436 test: 0.831652
max validation accuracy : 0.905393 max acc epoch : 19 test accuracy : 0.830589
Counter({0: 8900, 1: 7962, 2: 1984})

Epoch :  21 loss training:  34.722669161856174 Time :  27150
accuracy train: 0.989001 val: 0.904509 test: 0.830722
max validation accuracy : 0.905393 max acc epoch : 19 test accuracy : 0.830589
Counter({1: 8977, 2: 7886, 0: 1983})

Epoch :  22 loss training:  33.45953454822302 Time :  27276
accuracy train: 0.990965 val: 0.906278 test: 0.833112
max validation accuracy : 0.906278 max acc epoch : 22 test accuracy : 0.833112
Counter({1: 9037, 0: 7826, 2: 1983})

Epoch :  23 loss training:  31.433127927593887 Time :  27386
accuracy train: 0.992438 val: 0.910698 test: 0.835900
max validation accuracy : 0.910698 max acc epoch : 23 test accuracy : 0.835900
Counter({1: 9043, 0: 7820, 2: 1983})

Epoch :  24 loss training:  29.207635151222348 Time :  27518
accuracy train: 0.993617 val: 0.905393 test: 0.835900
max validation accuracy : 0.910698 max acc epoch : 23 test accuracy : 0.835900
Counter({2: 9079, 0: 7787, 1: 1980})

Epoch :  25 loss training:  27.11709666904062 Time :  27645
accuracy train: 0.994304 val: 0.907162 test: 0.832714
max validation accuracy : 0.910698 max acc epoch : 23 test accuracy : 0.835900
Counter({2: 9114, 0: 7752, 1: 1980})

Epoch :  26 loss training:  24.75941064208746 Time :  27754
accuracy train: 0.993813 val: 0.916888 test: 0.834572
max validation accuracy : 0.916888 max acc epoch : 26 test accuracy : 0.834572
Counter({1: 9147, 0: 7719, 2: 1980})

Epoch :  27 loss training:  24.248946007806808 Time :  27860
accuracy train: 0.994304 val: 0.913351 test: 0.837228
max validation accuracy : 0.916888 max acc epoch : 26 test accuracy : 0.834572
Counter({1: 7517, 2: 7226, 0: 4103})

Epoch :  28 loss training:  22.628997907973826 Time :  27969
accuracy train: 0.995286 val: 0.910698 test: 0.837493
max validation accuracy : 0.916888 max acc epoch : 26 test accuracy : 0.834572
Counter({1: 7502, 0: 7232, 2: 4112})

Epoch :  29 loss training:  20.629865976283327 Time :  28079
accuracy train: 0.995875 val: 0.910698 test: 0.838688
max validation accuracy : 0.916888 max acc epoch : 26 test accuracy : 0.834572
Counter({2: 7496, 0: 7229, 1: 4121})

Epoch :  30 loss training:  20.883145560510457 Time :  28185
accuracy train: 0.996366 val: 0.908930 test: 0.838290
max validation accuracy : 0.916888 max acc epoch : 26 test accuracy : 0.834572
Counter({1: 7497, 0: 7226, 2: 4123})

Epoch :  31 loss training:  18.02917264541611 Time :  28296
accuracy train: 0.997643 val: 0.912467 test: 0.841344
max validation accuracy : 0.916888 max acc epoch : 26 test accuracy : 0.834572
Counter({0: 7483, 1: 7233, 2: 4130})

Epoch :  32 loss training:  16.85715498123318 Time :  28405
accuracy train: 0.997349 val: 0.910698 test: 0.843202
max validation accuracy : 0.916888 max acc epoch : 26 test accuracy : 0.834572
Counter({0: 7477, 2: 7226, 1: 4143})

Epoch :  33 loss training:  15.61812304565683 Time :  28514
accuracy train: 0.997545 val: 0.914235 test: 0.842007
max validation accuracy : 0.916888 max acc epoch : 26 test accuracy : 0.834572
Counter({0: 7467, 1: 7237, 2: 4142})

Epoch :  34 loss training:  14.361367074772716 Time :  28621
accuracy train: 0.998331 val: 0.913351 test: 0.841344
max validation accuracy : 0.916888 max acc epoch : 26 test accuracy : 0.834572
Counter({2: 7446, 0: 7252, 1: 4148})

Epoch :  35 loss training:  13.86801806697622 Time :  28734
accuracy train: 0.998723 val: 0.914235 test: 0.843070
max validation accuracy : 0.916888 max acc epoch : 26 test accuracy : 0.834572
Counter({0: 7437, 2: 7258, 1: 4151})

Epoch :  36 loss training:  13.202191120013595 Time :  28849
accuracy train: 0.998822 val: 0.913351 test: 0.844530
max validation accuracy : 0.916888 max acc epoch : 26 test accuracy : 0.834572
Counter({2: 7429, 0: 7263, 1: 4154})

Epoch :  37 loss training:  11.678206185810268 Time :  28961
accuracy train: 0.998920 val: 0.916888 test: 0.841609
max validation accuracy : 0.916888 max acc epoch : 26 test accuracy : 0.834572
Counter({2: 7427, 0: 7267, 1: 4152})

Epoch :  38 loss training:  11.120697263628244 Time :  29074
accuracy train: 0.998822 val: 0.918656 test: 0.843733
max validation accuracy : 0.918656 max acc epoch : 38 test accuracy : 0.843733
Counter({0: 7429, 1: 7257, 2: 4160})

Epoch :  39 loss training:  10.901101852534339 Time :  29186
accuracy train: 0.999018 val: 0.916888 test: 0.843468
max validation accuracy : 0.918656 max acc epoch : 38 test accuracy : 0.843733
Counter({2: 7420, 0: 7262, 1: 4164})

Epoch :  40 loss training:  10.63979273964651 Time :  29296
accuracy train: 0.999214 val: 0.918656 test: 0.842406
max validation accuracy : 0.918656 max acc epoch : 38 test accuracy : 0.843733
Counter({0: 7412, 2: 7274, 1: 4160})

Epoch :  41 loss training:  9.719160586595535 Time :  29407
accuracy train: 0.999116 val: 0.916888 test: 0.846123
max validation accuracy : 0.918656 max acc epoch : 38 test accuracy : 0.843733
Counter({1: 7415, 0: 7272, 2: 4159})

Epoch :  42 loss training:  10.647710712626576 Time :  29517
accuracy train: 0.999214 val: 0.917772 test: 0.846389
max validation accuracy : 0.918656 max acc epoch : 38 test accuracy : 0.843733
Counter({0: 7402, 2: 7286, 1: 4158})

Epoch :  43 loss training:  9.49423834332265 Time :  29628
accuracy train: 0.999411 val: 0.917772 test: 0.846920
max validation accuracy : 0.918656 max acc epoch : 38 test accuracy : 0.843733
Counter({0: 7377, 1: 7315, 2: 4154})

Epoch :  44 loss training:  8.435348523431458 Time :  29737
accuracy train: 0.999214 val: 0.918656 test: 0.845725
max validation accuracy : 0.918656 max acc epoch : 38 test accuracy : 0.843733
Counter({2: 7368, 1: 7319, 0: 4159})

Epoch :  45 loss training:  7.4015866201370955 Time :  29849
accuracy train: 0.999116 val: 0.918656 test: 0.848646
max validation accuracy : 0.918656 max acc epoch : 38 test accuracy : 0.843733
Counter({2: 7347, 0: 7341, 1: 4158})

Epoch :  46 loss training:  7.27691825653892 Time :  29957
accuracy train: 0.999313 val: 0.918656 test: 0.844530
max validation accuracy : 0.918656 max acc epoch : 38 test accuracy : 0.843733
Counter({0: 7358, 1: 7325, 2: 4163})

Epoch :  47 loss training:  6.751506596338004 Time :  30067
accuracy train: 0.999313 val: 0.922193 test: 0.843733
max validation accuracy : 0.922193 max acc epoch : 47 test accuracy : 0.843733
Counter({0: 7363, 1: 7318, 2: 4165})

Epoch :  48 loss training:  6.917943455395289 Time :  30178
accuracy train: 0.999116 val: 0.919540 test: 0.846787
max validation accuracy : 0.922193 max acc epoch : 47 test accuracy : 0.843733
Counter({0: 7393, 2: 7288, 1: 4165})

Epoch :  49 loss training:  6.073984872666188 Time :  30288
accuracy train: 0.999411 val: 0.919540 test: 0.847053
max validation accuracy : 0.922193 max acc epoch : 47 test accuracy : 0.843733
Counter({1: 7394, 2: 7289, 0: 4163})

Epoch :  50 loss training:  6.9132557709817775 Time :  30397
accuracy train: 0.999509 val: 0.918656 test: 0.848779
max validation accuracy : 0.922193 max acc epoch : 47 test accuracy : 0.843733
Counter({0: 7397, 2: 7285, 1: 4164})

Epoch :  51 loss training:  5.947775388602167 Time :  30518
accuracy train: 0.999411 val: 0.918656 test: 0.847053
max validation accuracy : 0.922193 max acc epoch : 47 test accuracy : 0.843733
Counter({0: 7417, 1: 7268, 2: 4161})

Epoch :  52 loss training:  6.069358391163405 Time :  30627
accuracy train: 0.999411 val: 0.922193 test: 0.849177
max validation accuracy : 0.922193 max acc epoch : 47 test accuracy : 0.843733
Counter({1: 7418, 0: 7266, 2: 4162})

Epoch :  53 loss training:  4.175685020512901 Time :  30742
accuracy train: 0.999509 val: 0.921309 test: 0.848646
max validation accuracy : 0.922193 max acc epoch : 47 test accuracy : 0.843733
Counter({2: 7419, 0: 7263, 1: 4164})

Epoch :  54 loss training:  4.844827922643162 Time :  30858
accuracy train: 0.999313 val: 0.923077 test: 0.846654
max validation accuracy : 0.923077 max acc epoch : 54 test accuracy : 0.846654
Counter({1: 7445, 2: 7236, 0: 4165})

Epoch :  55 loss training:  5.517033177195117 Time :  30965
accuracy train: 0.999607 val: 0.926614 test: 0.847584
max validation accuracy : 0.926614 max acc epoch : 55 test accuracy : 0.847584
Counter({1: 7465, 0: 7215, 2: 4166})

Epoch :  56 loss training:  4.185353193839546 Time :  31077
accuracy train: 0.999214 val: 0.919540 test: 0.845990
max validation accuracy : 0.926614 max acc epoch : 55 test accuracy : 0.847584
Counter({0: 7470, 2: 7206, 1: 4170})

Epoch :  57 loss training:  4.5426885561901145 Time :  31182
accuracy train: 0.999607 val: 0.922193 test: 0.847053
max validation accuracy : 0.926614 max acc epoch : 55 test accuracy : 0.847584
Counter({0: 7471, 1: 7203, 2: 4172})

Epoch :  58 loss training:  4.030989917839179 Time :  31288
accuracy train: 0.999509 val: 0.920424 test: 0.850770
max validation accuracy : 0.926614 max acc epoch : 55 test accuracy : 0.847584
Counter({0: 7510, 1: 7165, 2: 4171})

Epoch :  59 loss training:  4.307330400653882 Time :  31393
accuracy train: 0.999509 val: 0.922193 test: 0.848513
max validation accuracy : 0.926614 max acc epoch : 55 test accuracy : 0.847584
Counter({0: 7549, 1: 7126, 2: 4171})

Epoch :  60 loss training:  3.2793004104169086 Time :  31504
accuracy train: 0.999509 val: 0.920424 test: 0.848646
max validation accuracy : 0.926614 max acc epoch : 55 test accuracy : 0.847584
Counter({0: 7558, 1: 7115, 2: 4173})

Epoch :  61 loss training:  4.36397519876482 Time :  31621
accuracy train: 0.999411 val: 0.922193 test: 0.850505
max validation accuracy : 0.926614 max acc epoch : 55 test accuracy : 0.847584
Counter({2: 7563, 0: 7110, 1: 4173})

Epoch :  62 loss training:  3.2373607952031307 Time :  31731
accuracy train: 0.999411 val: 0.924845 test: 0.850239
max validation accuracy : 0.926614 max acc epoch : 55 test accuracy : 0.847584
Counter({0: 7573, 2: 7099, 1: 4174})

Epoch :  63 loss training:  3.203490996558685 Time :  31846
accuracy train: 0.999509 val: 0.923077 test: 0.849177
max validation accuracy : 0.926614 max acc epoch : 55 test accuracy : 0.847584
Counter({0: 7573, 1: 7097, 2: 4176})

Epoch :  64 loss training:  2.9609729171497747 Time :  31960
accuracy train: 0.999607 val: 0.922193 test: 0.849841
max validation accuracy : 0.926614 max acc epoch : 55 test accuracy : 0.847584
Counter({0: 7582, 1: 7088, 2: 4176})

Epoch :  65 loss training:  2.9197153991553932 Time :  32071
accuracy train: 0.999607 val: 0.919540 test: 0.851036
max validation accuracy : 0.926614 max acc epoch : 55 test accuracy : 0.847584
Counter({2: 7583, 0: 7086, 1: 4177})

Epoch :  66 loss training:  3.7459397350467043 Time :  32194
accuracy train: 0.999607 val: 0.923077 test: 0.852629
max validation accuracy : 0.926614 max acc epoch : 55 test accuracy : 0.847584
Counter({2: 7583, 0: 7089, 1: 4174})

Epoch :  67 loss training:  2.8926585493027233 Time :  32300
accuracy train: 0.999509 val: 0.924845 test: 0.849708
max validation accuracy : 0.926614 max acc epoch : 55 test accuracy : 0.847584
Counter({0: 7587, 2: 7085, 1: 4174})

Epoch :  68 loss training:  2.541743307534489 Time :  32407
accuracy train: 0.999509 val: 0.921309 test: 0.849575
max validation accuracy : 0.926614 max acc epoch : 55 test accuracy : 0.847584
Counter({2: 7590, 1: 7081, 0: 4175})

Epoch :  69 loss training:  2.358219423345872 Time :  32513
accuracy train: 0.999607 val: 0.929266 test: 0.850106
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.850106
Counter({1: 7606, 0: 7066, 2: 4174})

Epoch :  70 loss training:  2.650929118899512 Time :  32615
accuracy train: 0.999607 val: 0.928382 test: 0.851832
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.850106
Counter({0: 7641, 1: 7031, 2: 4174})

Epoch :  71 loss training:  2.1392293208191404 Time :  32776
accuracy train: 0.999509 val: 0.925729 test: 0.846787
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.850106
Counter({1: 7641, 0: 7030, 2: 4175})

Epoch :  72 loss training:  2.4118373597666505 Time :  32930
accuracy train: 0.999509 val: 0.924845 test: 0.849973
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.850106
Counter({2: 7640, 1: 7034, 0: 4172})

Epoch :  73 loss training:  2.679315344823408 Time :  33084
accuracy train: 0.999313 val: 0.925729 test: 0.851699
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.850106
Counter({1: 7648, 0: 7028, 2: 4170})

Epoch :  74 loss training:  2.459136657533236 Time :  33238
accuracy train: 0.999509 val: 0.925729 test: 0.852762
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.850106
Counter({0: 7649, 1: 7027, 2: 4170})

Epoch :  75 loss training:  2.367422426075791 Time :  33397
accuracy train: 0.999509 val: 0.926614 test: 0.851301
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.850106
Counter({0: 7654, 2: 7023, 1: 4169})

Epoch :  76 loss training:  2.179072524420917 Time :  33563
accuracy train: 0.999509 val: 0.921309 test: 0.852629
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.850106
Counter({2: 7670, 1: 7006, 0: 4170})

Epoch :  77 loss training:  2.0219110890611773 Time :  33747
accuracy train: 0.999607 val: 0.929266 test: 0.853425
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.850106
Counter({2: 7670, 1: 7006, 0: 4170})

Epoch :  78 loss training:  2.177576869762561 Time :  33901
accuracy train: 0.999214 val: 0.929266 test: 0.853691
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.850106
Counter({2: 7685, 1: 7000, 0: 4161})

Epoch :  79 loss training:  2.4197383170758258 Time :  34059
accuracy train: 0.999509 val: 0.922193 test: 0.856213
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.850106
Counter({1: 7681, 0: 7004, 2: 4161})

Epoch :  80 loss training:  1.5716037300298922 Time :  34227
accuracy train: 0.999509 val: 0.923077 test: 0.853293
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.850106
Counter({2: 7682, 1: 7003, 0: 4161})

Epoch :  81 loss training:  1.7488362898002379 Time :  34389
accuracy train: 0.999607 val: 0.924845 test: 0.855948
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.850106
Counter({0: 7684, 1: 7003, 2: 4159})

Epoch :  82 loss training:  2.0105058269546134 Time :  34538
accuracy train: 0.999607 val: 0.924845 test: 0.850106
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.850106
Counter({0: 7696, 2: 6990, 1: 4160})

Epoch :  83 loss training:  2.37266517203534 Time :  34689
accuracy train: 0.999607 val: 0.926614 test: 0.854355
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.850106
Counter({0: 7699, 1: 6985, 2: 4162})

Epoch :  84 loss training:  2.0839560746971983 Time :  34839
accuracy train: 0.999607 val: 0.923961 test: 0.851832
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.850106
Counter({2: 7703, 0: 6977, 1: 4166})

Epoch :  85 loss training:  1.6632860330646508 Time :  34985
accuracy train: 0.999509 val: 0.920424 test: 0.854753
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.850106
Counter({0: 7703, 2: 6978, 1: 4165})

Epoch :  86 loss training:  1.4199274833808886 Time :  35136
accuracy train: 0.999607 val: 0.926614 test: 0.853160
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.850106
Counter({1: 7701, 0: 6979, 2: 4166})

Epoch :  87 loss training:  1.4929403739661211 Time :  35291
accuracy train: 0.999607 val: 0.923077 test: 0.851036
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.850106
Counter({2: 7724, 1: 6958, 0: 4164})

Epoch :  88 loss training:  1.715035633489606 Time :  35433
accuracy train: 0.999705 val: 0.923077 test: 0.855284
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.850106
Counter({0: 7726, 1: 6954, 2: 4166})

Epoch :  89 loss training:  1.735558389176731 Time :  35581
accuracy train: 0.999607 val: 0.923077 test: 0.853293
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.850106
Counter({0: 7730, 1: 6949, 2: 4167})

Epoch :  90 loss training:  1.4342574916081503 Time :  35732
accuracy train: 0.999607 val: 0.925729 test: 0.858205
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.850106
Counter({2: 7739, 0: 6940, 1: 4167})

Epoch :  91 loss training:  1.7090180998056894 Time :  35889
accuracy train: 0.999607 val: 0.923077 test: 0.856081
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.850106
Counter({2: 7760, 0: 6918, 1: 4168})

Epoch :  92 loss training:  1.390926410596876 Time :  36050
accuracy train: 0.999607 val: 0.926614 test: 0.855948
max validation accuracy : 0.929266 max acc epoch : 69 test accuracy : 0.850106
Counter({2: 7761, 1: 6916, 0: 4169})

Epoch :  93 loss training:  1.1875557370585739 Time :  36204
accuracy train: 0.999607 val: 0.930150 test: 0.856479
max validation accuracy : 0.930150 max acc epoch : 93 test accuracy : 0.856479
Counter({0: 7763, 1: 6915, 2: 4168})

Epoch :  94 loss training:  1.7614083609660156 Time :  36351
accuracy train: 0.999509 val: 0.931034 test: 0.856346
max validation accuracy : 0.931034 max acc epoch : 94 test accuracy : 0.856346
Counter({2: 7765, 1: 6916, 0: 4165})

Epoch :  95 loss training:  1.0918042746379797 Time :  36499
accuracy train: 0.999705 val: 0.929266 test: 0.858338
max validation accuracy : 0.931034 max acc epoch : 94 test accuracy : 0.856346
Counter({2: 7765, 0: 6917, 1: 4164})

Epoch :  96 loss training:  1.4879541144728137 Time :  36647
accuracy train: 0.999705 val: 0.929266 test: 0.853293
max validation accuracy : 0.931034 max acc epoch : 94 test accuracy : 0.856346
Counter({0: 7763, 1: 6913, 2: 4170})

Epoch :  97 loss training:  1.4397074226144468 Time :  36799
accuracy train: 0.999607 val: 0.929266 test: 0.855417
max validation accuracy : 0.931034 max acc epoch : 94 test accuracy : 0.856346
Counter({2: 7768, 0: 6909, 1: 4169})

Epoch :  98 loss training:  1.1553820061526494 Time :  36946
accuracy train: 0.999705 val: 0.931034 test: 0.856346
max validation accuracy : 0.931034 max acc epoch : 94 test accuracy : 0.856346
Counter({0: 7769, 2: 6908, 1: 4169})

Epoch :  99 loss training:  1.2501039673225023 Time :  37095
accuracy train: 0.999509 val: 0.932803 test: 0.855948
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({0: 7767, 1: 6908, 2: 4171})

Epoch :  100 loss training:  1.2330901578789053 Time :  37241
accuracy train: 0.999607 val: 0.929266 test: 0.854753
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({0: 7763, 2: 6910, 1: 4173})

Epoch :  101 loss training:  1.3048289193757228 Time :  37387
accuracy train: 0.999607 val: 0.931034 test: 0.856612
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({0: 7764, 2: 6909, 1: 4173})

Epoch :  102 loss training:  1.368712932773633 Time :  37534
accuracy train: 0.999705 val: 0.928382 test: 0.856081
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({2: 7761, 0: 6912, 1: 4173})

Epoch :  103 loss training:  1.2328715178191487 Time :  37680
accuracy train: 0.999705 val: 0.932803 test: 0.853691
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({0: 7763, 1: 6910, 2: 4173})

Epoch :  104 loss training:  1.1663991424829874 Time :  37827
accuracy train: 0.999607 val: 0.928382 test: 0.854753
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({1: 7780, 0: 6892, 2: 4174})

Epoch :  105 loss training:  0.997263120210846 Time :  37974
accuracy train: 0.999607 val: 0.925729 test: 0.855682
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({1: 7807, 0: 6863, 2: 4176})

Epoch :  106 loss training:  1.0497833835797792 Time :  38121
accuracy train: 0.999705 val: 0.924845 test: 0.853558
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({0: 7818, 1: 6853, 2: 4175})

Epoch :  107 loss training:  1.1577370381655783 Time :  38267
accuracy train: 0.999607 val: 0.930150 test: 0.853956
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({0: 7822, 2: 6849, 1: 4175})

Epoch :  108 loss training:  1.1543058566567197 Time :  38413
accuracy train: 0.999705 val: 0.930150 test: 0.854488
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({2: 7819, 0: 6848, 1: 4179})

Epoch :  109 loss training:  0.8263730460548686 Time :  38561
accuracy train: 0.999705 val: 0.928382 test: 0.856612
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({1: 7820, 2: 6847, 0: 4179})

Epoch :  110 loss training:  1.2033726331028447 Time :  38711
accuracy train: 0.999705 val: 0.926614 test: 0.855682
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({2: 7822, 1: 6847, 0: 4177})

Epoch :  111 loss training:  1.2503963597300753 Time :  38864
accuracy train: 0.999607 val: 0.926614 test: 0.855682
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({0: 7829, 1: 6840, 2: 4177})

Epoch :  112 loss training:  1.0172696805420856 Time :  39016
accuracy train: 0.999705 val: 0.928382 test: 0.856877
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({0: 7836, 1: 6834, 2: 4176})

Epoch :  113 loss training:  0.977102801321962 Time :  39166
accuracy train: 0.999705 val: 0.925729 test: 0.856346
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({1: 7836, 0: 6834, 2: 4176})

Epoch :  114 loss training:  0.9025305326358648 Time :  39323
accuracy train: 0.999607 val: 0.926614 test: 0.857807
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({2: 7836, 0: 6837, 1: 4173})

Epoch :  115 loss training:  1.0278478844738856 Time :  39489
accuracy train: 0.999705 val: 0.925729 test: 0.857807
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({2: 7837, 0: 6836, 1: 4173})

Epoch :  116 loss training:  0.7473561088481802 Time :  39651
accuracy train: 0.999705 val: 0.926614 test: 0.857807
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({0: 7837, 1: 6837, 2: 4172})

Epoch :  117 loss training:  0.9759845275475527 Time :  39826
accuracy train: 0.999705 val: 0.930150 test: 0.857541
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({0: 7839, 1: 6835, 2: 4172})

Epoch :  118 loss training:  0.7122222873786086 Time :  40006
accuracy train: 0.999705 val: 0.926614 test: 0.857143
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({1: 7837, 2: 6841, 0: 4168})

Epoch :  119 loss training:  0.9317810571374139 Time :  40178
accuracy train: 0.999607 val: 0.928382 test: 0.852496
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({0: 7841, 2: 6838, 1: 4167})

Epoch :  120 loss training:  0.9063943858745915 Time :  40357
accuracy train: 0.999607 val: 0.928382 test: 0.856081
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({0: 7843, 2: 6837, 1: 4166})

Epoch :  121 loss training:  0.9155737384626264 Time :  40528
accuracy train: 0.999705 val: 0.925729 test: 0.855948
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({0: 7834, 1: 6839, 2: 4173})

Epoch :  122 loss training:  1.0414380095826345 Time :  40701
accuracy train: 0.999705 val: 0.924845 test: 0.858205
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({0: 7835, 1: 6837, 2: 4174})

Epoch :  123 loss training:  0.7225669725630723 Time :  40878
accuracy train: 0.999705 val: 0.928382 test: 0.856081
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({0: 7835, 2: 6837, 1: 4174})

Epoch :  124 loss training:  0.9661972621379391 Time :  41048
accuracy train: 0.999509 val: 0.929266 test: 0.856745
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({0: 7838, 1: 6834, 2: 4174})

Epoch :  125 loss training:  1.0558409555560502 Time :  41212
accuracy train: 0.999607 val: 0.924845 test: 0.856346
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({0: 7838, 1: 6835, 2: 4173})

Epoch :  126 loss training:  0.7376311589105171 Time :  41366
accuracy train: 0.999607 val: 0.927498 test: 0.856612
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({2: 7838, 0: 6838, 1: 4170})

Epoch :  127 loss training:  1.1381621811788136 Time :  41515
accuracy train: 0.999705 val: 0.930150 test: 0.855815
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({0: 7838, 1: 6840, 2: 4168})

Epoch :  128 loss training:  0.7658644576258666 Time :  41668
accuracy train: 0.999705 val: 0.930150 test: 0.854753
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({0: 7837, 1: 6839, 2: 4170})

Epoch :  129 loss training:  0.5650495259487798 Time :  41783
accuracy train: 0.999705 val: 0.925729 test: 0.854488
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({0: 7839, 1: 6840, 2: 4167})

Epoch :  130 loss training:  0.8525068790695514 Time :  41888
accuracy train: 0.999607 val: 0.930150 test: 0.854886
max validation accuracy : 0.932803 max acc epoch : 99 test accuracy : 0.855948
Counter({2: 7839, 1: 6839, 0: 4168})

========================================================================================================================================================================================================
best acc epoch :  99
validation accuracy :  0.9328028293545535
test accuracy :  0.8559479553903345
last test_accuracy :  0.8548858204992034
second best val :  0.9310344827586207
second best test :  0.8563462559745088
max gap 24
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=25, weight_decay=1e-10)
device :  cuda:0
Counter({0: 7569, 2: 6376, 1: 4901})

Epoch :  1 loss training:  340.93111142516136 Time :  42002
accuracy train: 0.798586 val: 0.770999 test: 0.723845
max validation accuracy : 0.770999 max acc epoch : 1 test accuracy : 0.723845
Counter({0: 7670, 2: 6353, 1: 4823})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  203.66514140367508 Time :  42101
accuracy train: 0.836983 val: 0.794872 test: 0.759426
max validation accuracy : 0.794872 max acc epoch : 2 test accuracy : 0.759426
Counter({0: 7787, 1: 6312, 2: 4747})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  177.27769228816032 Time :  42201
accuracy train: 0.857409 val: 0.819629 test: 0.763409
max validation accuracy : 0.819629 max acc epoch : 3 test accuracy : 0.763409
Counter({0: 8646, 1: 8179, 2: 2021})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  135.33156161010265 Time :  42299
accuracy train: 0.902485 val: 0.850575 test: 0.787839
max validation accuracy : 0.850575 max acc epoch : 4 test accuracy : 0.787839
Counter({1: 8619, 0: 8227, 2: 2000})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  120.8104657754302 Time :  42397
accuracy train: 0.918197 val: 0.847922 test: 0.795672
max validation accuracy : 0.850575 max acc epoch : 4 test accuracy : 0.787839
Counter({1: 8667, 0: 8205, 2: 1974})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  112.84345275908709 Time :  42496
accuracy train: 0.930571 val: 0.865606 test: 0.804833
max validation accuracy : 0.865606 max acc epoch : 6 test accuracy : 0.804833
Counter({0: 8643, 1: 8226, 2: 1977})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  92.46186996996403 Time :  42593
accuracy train: 0.942257 val: 0.881521 test: 0.813861
max validation accuracy : 0.881521 max acc epoch : 7 test accuracy : 0.813861
Counter({0: 8563, 2: 8307, 1: 1976})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  88.5655866637826 Time :  42693
accuracy train: 0.943141 val: 0.872679 test: 0.811073
max validation accuracy : 0.881521 max acc epoch : 7 test accuracy : 0.813861
Counter({1: 8493, 0: 8374, 2: 1979})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  85.63728412240744 Time :  42792
accuracy train: 0.948443 val: 0.877984 test: 0.808550
max validation accuracy : 0.881521 max acc epoch : 7 test accuracy : 0.813861
Counter({0: 8518, 1: 8351, 2: 1977})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  79.0369273647666 Time :  42897
accuracy train: 0.951291 val: 0.884173 test: 0.811869
max validation accuracy : 0.884173 max acc epoch : 10 test accuracy : 0.811869
Counter({1: 8529, 0: 8337, 2: 1980})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  74.93389793857932 Time :  43002
accuracy train: 0.962388 val: 0.889478 test: 0.819039
max validation accuracy : 0.889478 max acc epoch : 11 test accuracy : 0.819039
Counter({2: 8548, 0: 8320, 1: 1978})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  67.30543807893991 Time :  43106
accuracy train: 0.969361 val: 0.890363 test: 0.820765
max validation accuracy : 0.890363 max acc epoch : 12 test accuracy : 0.820765
Counter({2: 8569, 0: 8299, 1: 1978})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  59.075172293931246 Time :  43209
accuracy train: 0.972209 val: 0.895668 test: 0.823155
max validation accuracy : 0.895668 max acc epoch : 13 test accuracy : 0.823155
Counter({0: 8580, 1: 8290, 2: 1976})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  54.32402574270964 Time :  43317
accuracy train: 0.975547 val: 0.898320 test: 0.826739
max validation accuracy : 0.898320 max acc epoch : 14 test accuracy : 0.826739
Counter({0: 8613, 1: 8257, 2: 1976})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  51.62402195855975 Time :  43420
accuracy train: 0.977904 val: 0.896552 test: 0.825146
max validation accuracy : 0.898320 max acc epoch : 14 test accuracy : 0.826739
Counter({2: 8613, 0: 8256, 1: 1977})

Epoch :  16 loss training:  47.73703616298735 Time :  43523
accuracy train: 0.979181 val: 0.899204 test: 0.827403
max validation accuracy : 0.899204 max acc epoch : 16 test accuracy : 0.827403
Counter({1: 8631, 0: 8237, 2: 1978})

Epoch :  17 loss training:  46.7937968429178 Time :  43634
accuracy train: 0.982127 val: 0.902741 test: 0.827005
max validation accuracy : 0.902741 max acc epoch : 17 test accuracy : 0.827005
Counter({1: 8640, 0: 8228, 2: 1978})

Epoch :  18 loss training:  43.05871356278658 Time :  43738
accuracy train: 0.984288 val: 0.901857 test: 0.829395
max validation accuracy : 0.902741 max acc epoch : 17 test accuracy : 0.827005
Counter({0: 8667, 1: 8200, 2: 1979})

Epoch :  19 loss training:  40.79182805493474 Time :  43843
accuracy train: 0.985368 val: 0.902741 test: 0.829660
max validation accuracy : 0.902741 max acc epoch : 17 test accuracy : 0.827005
Counter({0: 8683, 1: 8185, 2: 1978})

Epoch :  20 loss training:  37.52414008695632 Time :  43952
accuracy train: 0.986939 val: 0.905393 test: 0.830324
max validation accuracy : 0.905393 max acc epoch : 20 test accuracy : 0.830324
Counter({1: 8750, 0: 8117, 2: 1979})

Epoch :  21 loss training:  35.23395454324782 Time :  44059
accuracy train: 0.989394 val: 0.902741 test: 0.832581
max validation accuracy : 0.905393 max acc epoch : 20 test accuracy : 0.830324
Counter({1: 8798, 0: 8071, 2: 1977})

Epoch :  22 loss training:  34.14940189290792 Time :  44164
accuracy train: 0.990376 val: 0.904509 test: 0.832847
max validation accuracy : 0.905393 max acc epoch : 20 test accuracy : 0.830324
Counter({2: 8814, 0: 8055, 1: 1977})

Epoch :  23 loss training:  31.469055681489408 Time :  44272
accuracy train: 0.991751 val: 0.908930 test: 0.834838
max validation accuracy : 0.908930 max acc epoch : 23 test accuracy : 0.834838
Counter({2: 8833, 0: 8033, 1: 1980})

Epoch :  24 loss training:  29.281066722236574 Time :  44383
accuracy train: 0.992340 val: 0.904509 test: 0.830855
max validation accuracy : 0.908930 max acc epoch : 23 test accuracy : 0.834838
Counter({1: 8862, 0: 8003, 2: 1981})

Epoch :  25 loss training:  26.777428968809545 Time :  44489
accuracy train: 0.993224 val: 0.908930 test: 0.835767
max validation accuracy : 0.908930 max acc epoch : 23 test accuracy : 0.834838
Counter({1: 7850, 0: 6932, 2: 4064})

Epoch :  26 loss training:  25.63175032939762 Time :  44597
accuracy train: 0.993813 val: 0.908930 test: 0.835369
max validation accuracy : 0.908930 max acc epoch : 23 test accuracy : 0.834838
Counter({1: 7860, 2: 6922, 0: 4064})

Epoch :  27 loss training:  24.71748473495245 Time :  44704
accuracy train: 0.994697 val: 0.906278 test: 0.834971
max validation accuracy : 0.908930 max acc epoch : 23 test accuracy : 0.834838
Counter({1: 7786, 0: 6991, 2: 4069})

Epoch :  28 loss training:  23.28336406685412 Time :  44817
accuracy train: 0.995679 val: 0.908046 test: 0.838024
max validation accuracy : 0.908930 max acc epoch : 23 test accuracy : 0.834838
Counter({1: 7783, 2: 6989, 0: 4074})

Epoch :  29 loss training:  21.97995694493875 Time :  44921
accuracy train: 0.996170 val: 0.912467 test: 0.840149
max validation accuracy : 0.912467 max acc epoch : 29 test accuracy : 0.840149
Counter({0: 7771, 2: 6997, 1: 4078})

Epoch :  30 loss training:  19.97307931864634 Time :  45030
accuracy train: 0.996366 val: 0.910698 test: 0.838290
max validation accuracy : 0.912467 max acc epoch : 29 test accuracy : 0.840149
Counter({0: 7765, 1: 7001, 2: 4080})

Epoch :  31 loss training:  19.289281270932406 Time :  45132
accuracy train: 0.996956 val: 0.911583 test: 0.837759
max validation accuracy : 0.912467 max acc epoch : 29 test accuracy : 0.840149
Counter({1: 7747, 0: 7016, 2: 4083})

Epoch :  32 loss training:  17.448249955195934 Time :  45237
accuracy train: 0.997741 val: 0.912467 test: 0.838423
max validation accuracy : 0.912467 max acc epoch : 29 test accuracy : 0.840149
Counter({0: 7745, 1: 7007, 2: 4094})

Epoch :  33 loss training:  16.744796061888337 Time :  45345
accuracy train: 0.997349 val: 0.910698 test: 0.840016
max validation accuracy : 0.912467 max acc epoch : 29 test accuracy : 0.840149
Counter({0: 7738, 1: 7012, 2: 4096})

Epoch :  34 loss training:  15.902667022775859 Time :  45457
accuracy train: 0.997938 val: 0.915119 test: 0.839219
max validation accuracy : 0.915119 max acc epoch : 34 test accuracy : 0.839219
Counter({2: 7727, 0: 7019, 1: 4100})

Epoch :  35 loss training:  13.479297140846029 Time :  45579
accuracy train: 0.998232 val: 0.915119 test: 0.836166
max validation accuracy : 0.915119 max acc epoch : 34 test accuracy : 0.839219
Counter({2: 7725, 1: 7021, 0: 4100})

Epoch :  36 loss training:  13.08064484084025 Time :  45684
accuracy train: 0.998429 val: 0.911583 test: 0.841609
max validation accuracy : 0.915119 max acc epoch : 34 test accuracy : 0.839219
Counter({0: 7722, 1: 7023, 2: 4101})

Epoch :  37 loss training:  13.13354131183587 Time :  45794
accuracy train: 0.998429 val: 0.916888 test: 0.839485
max validation accuracy : 0.916888 max acc epoch : 37 test accuracy : 0.839485
Counter({0: 7694, 1: 7050, 2: 4102})

Epoch :  38 loss training:  11.735318373888731 Time :  45896
accuracy train: 0.998723 val: 0.916004 test: 0.839883
max validation accuracy : 0.916888 max acc epoch : 37 test accuracy : 0.839485
Counter({0: 7685, 2: 7059, 1: 4102})

Epoch :  39 loss training:  11.681956767337397 Time :  46003
accuracy train: 0.998822 val: 0.916888 test: 0.841609
max validation accuracy : 0.916888 max acc epoch : 37 test accuracy : 0.839485
Counter({0: 7656, 2: 7089, 1: 4101})

Epoch :  40 loss training:  10.299207072006539 Time :  46111
accuracy train: 0.999116 val: 0.918656 test: 0.840547
max validation accuracy : 0.918656 max acc epoch : 40 test accuracy : 0.840547
Counter({1: 7649, 0: 7095, 2: 4102})

Epoch :  41 loss training:  10.122268049279228 Time :  46214
accuracy train: 0.999116 val: 0.914235 test: 0.841344
max validation accuracy : 0.918656 max acc epoch : 40 test accuracy : 0.840547
Counter({0: 7643, 1: 7100, 2: 4103})

Epoch :  42 loss training:  8.682570013334043 Time :  46313
accuracy train: 0.999018 val: 0.912467 test: 0.839883
max validation accuracy : 0.918656 max acc epoch : 40 test accuracy : 0.840547
Counter({2: 7634, 1: 7109, 0: 4103})

Epoch :  43 loss training:  8.828868457116187 Time :  46415
accuracy train: 0.999018 val: 0.919540 test: 0.841211
max validation accuracy : 0.919540 max acc epoch : 43 test accuracy : 0.841211
Counter({1: 7605, 0: 7138, 2: 4103})

Epoch :  44 loss training:  8.929740470368415 Time :  46520
accuracy train: 0.999116 val: 0.921309 test: 0.843335
max validation accuracy : 0.921309 max acc epoch : 44 test accuracy : 0.843335
Counter({0: 7587, 1: 7151, 2: 4108})

Epoch :  45 loss training:  7.988246590131894 Time :  46621
accuracy train: 0.999018 val: 0.918656 test: 0.842937
max validation accuracy : 0.921309 max acc epoch : 44 test accuracy : 0.843335
Counter({2: 7561, 1: 7176, 0: 4109})

Epoch :  46 loss training:  7.301645293482579 Time :  46724
accuracy train: 0.999116 val: 0.921309 test: 0.844928
max validation accuracy : 0.921309 max acc epoch : 44 test accuracy : 0.843335
Counter({0: 7547, 2: 7186, 1: 4113})

Epoch :  47 loss training:  7.239361794665456 Time :  46826
accuracy train: 0.999214 val: 0.919540 test: 0.843601
max validation accuracy : 0.921309 max acc epoch : 44 test accuracy : 0.843335
Counter({2: 7521, 0: 7212, 1: 4113})

Epoch :  48 loss training:  6.893296691938303 Time :  46926
accuracy train: 0.999116 val: 0.920424 test: 0.845061
max validation accuracy : 0.921309 max acc epoch : 44 test accuracy : 0.843335
Counter({1: 7485, 0: 7247, 2: 4114})

Epoch :  49 loss training:  6.947252803947777 Time :  47028
accuracy train: 0.999116 val: 0.922193 test: 0.843202
max validation accuracy : 0.922193 max acc epoch : 49 test accuracy : 0.843202
Counter({1: 7456, 0: 7274, 2: 4116})

Epoch :  50 loss training:  6.359262248850428 Time :  47128
accuracy train: 0.999411 val: 0.920424 test: 0.845725
max validation accuracy : 0.922193 max acc epoch : 49 test accuracy : 0.843202
Counter({1: 7365, 0: 7361, 2: 4120})

Epoch :  51 loss training:  5.150862279580906 Time :  47229
accuracy train: 0.999411 val: 0.922193 test: 0.844663
max validation accuracy : 0.922193 max acc epoch : 49 test accuracy : 0.843202
Counter({2: 7443, 0: 7282, 1: 4121})

Epoch :  52 loss training:  6.452365114702843 Time :  47332
accuracy train: 0.999509 val: 0.919540 test: 0.846787
max validation accuracy : 0.922193 max acc epoch : 49 test accuracy : 0.843202
Counter({0: 7453, 2: 7268, 1: 4125})

Epoch :  53 loss training:  5.0094617329887114 Time :  47432
accuracy train: 0.999509 val: 0.916888 test: 0.845459
max validation accuracy : 0.922193 max acc epoch : 49 test accuracy : 0.843202
Counter({2: 7466, 0: 7255, 1: 4125})

Epoch :  54 loss training:  4.826655053475406 Time :  47533
accuracy train: 0.999509 val: 0.919540 test: 0.845459
max validation accuracy : 0.922193 max acc epoch : 49 test accuracy : 0.843202
Counter({2: 7471, 0: 7247, 1: 4128})

Epoch :  55 loss training:  4.883947268303018 Time :  47635
accuracy train: 0.999313 val: 0.919540 test: 0.845327
max validation accuracy : 0.922193 max acc epoch : 49 test accuracy : 0.843202
Counter({0: 7471, 2: 7240, 1: 4135})

Epoch :  56 loss training:  4.658661226625554 Time :  47733
accuracy train: 0.999509 val: 0.919540 test: 0.848115
max validation accuracy : 0.922193 max acc epoch : 49 test accuracy : 0.843202
Counter({1: 7529, 2: 7165, 0: 4152})

Epoch :  57 loss training:  4.061060507432558 Time :  47835
accuracy train: 0.999411 val: 0.921309 test: 0.845061
max validation accuracy : 0.922193 max acc epoch : 49 test accuracy : 0.843202
Counter({0: 7557, 2: 7132, 1: 4157})

Epoch :  58 loss training:  3.925194420211483 Time :  47937
accuracy train: 0.999411 val: 0.920424 test: 0.847584
max validation accuracy : 0.922193 max acc epoch : 49 test accuracy : 0.843202
Counter({2: 7599, 0: 7087, 1: 4160})

Epoch :  59 loss training:  3.6034379240882117 Time :  48038
accuracy train: 0.999509 val: 0.922193 test: 0.848779
max validation accuracy : 0.922193 max acc epoch : 49 test accuracy : 0.843202
Counter({0: 7598, 1: 7088, 2: 4160})

Epoch :  60 loss training:  4.155247727583628 Time :  48140
accuracy train: 0.999607 val: 0.921309 test: 0.846920
max validation accuracy : 0.922193 max acc epoch : 49 test accuracy : 0.843202
Counter({1: 7602, 2: 7082, 0: 4162})

Epoch :  61 loss training:  3.5217146814684384 Time :  48240
accuracy train: 0.999411 val: 0.924845 test: 0.845725
max validation accuracy : 0.924845 max acc epoch : 61 test accuracy : 0.845725
Counter({0: 7603, 1: 7075, 2: 4168})

Epoch :  62 loss training:  3.8231621055165306 Time :  48339
accuracy train: 0.999607 val: 0.923961 test: 0.846256
max validation accuracy : 0.924845 max acc epoch : 61 test accuracy : 0.845725
Counter({0: 7620, 1: 7058, 2: 4168})

Epoch :  63 loss training:  3.3843399647739716 Time :  48440
accuracy train: 0.999411 val: 0.922193 test: 0.849442
max validation accuracy : 0.924845 max acc epoch : 61 test accuracy : 0.845725
Counter({1: 7621, 0: 7056, 2: 4169})

Epoch :  64 loss training:  3.466129285952775 Time :  48543
accuracy train: 0.999509 val: 0.917772 test: 0.848911
max validation accuracy : 0.924845 max acc epoch : 61 test accuracy : 0.845725
Counter({2: 7637, 0: 7042, 1: 4167})

Epoch :  65 loss training:  3.110200698080007 Time :  48643
accuracy train: 0.999509 val: 0.924845 test: 0.846654
max validation accuracy : 0.924845 max acc epoch : 61 test accuracy : 0.845725
Counter({0: 7637, 1: 7042, 2: 4167})

Epoch :  66 loss training:  3.3383257720270194 Time :  48742
accuracy train: 0.999411 val: 0.921309 test: 0.849973
max validation accuracy : 0.924845 max acc epoch : 61 test accuracy : 0.845725
Counter({2: 7646, 1: 7034, 0: 4166})

Epoch :  67 loss training:  2.710458435380133 Time :  48843
accuracy train: 0.999411 val: 0.920424 test: 0.848646
max validation accuracy : 0.924845 max acc epoch : 61 test accuracy : 0.845725
Counter({0: 7644, 1: 7035, 2: 4167})

Epoch :  68 loss training:  2.6804676694009686 Time :  48943
accuracy train: 0.999607 val: 0.917772 test: 0.852762
max validation accuracy : 0.924845 max acc epoch : 61 test accuracy : 0.845725
Counter({0: 7656, 1: 7021, 2: 4169})

Epoch :  69 loss training:  2.5382707354438026 Time :  49045
accuracy train: 0.999411 val: 0.916888 test: 0.848646
max validation accuracy : 0.924845 max acc epoch : 61 test accuracy : 0.845725
Counter({1: 7696, 2: 6979, 0: 4171})

Epoch :  70 loss training:  2.553168412501691 Time :  49147
accuracy train: 0.999607 val: 0.916888 test: 0.849442
max validation accuracy : 0.924845 max acc epoch : 61 test accuracy : 0.845725
Counter({1: 7705, 0: 6971, 2: 4170})

Epoch :  71 loss training:  2.1806407150870655 Time :  49246
accuracy train: 0.999607 val: 0.926614 test: 0.849841
max validation accuracy : 0.926614 max acc epoch : 71 test accuracy : 0.849841
Counter({2: 7705, 1: 6973, 0: 4168})

Epoch :  72 loss training:  2.323937651264714 Time :  49345
accuracy train: 0.999607 val: 0.923077 test: 0.849708
max validation accuracy : 0.926614 max acc epoch : 71 test accuracy : 0.849841
Counter({0: 7710, 1: 6968, 2: 4168})

Epoch :  73 loss training:  2.172797211991565 Time :  49448
accuracy train: 0.999509 val: 0.923961 test: 0.850903
max validation accuracy : 0.926614 max acc epoch : 71 test accuracy : 0.849841
Counter({0: 7713, 1: 6965, 2: 4168})

Epoch :  74 loss training:  2.2068920084711863 Time :  49551
accuracy train: 0.999411 val: 0.917772 test: 0.849708
max validation accuracy : 0.926614 max acc epoch : 71 test accuracy : 0.849841
Counter({1: 7717, 2: 6957, 0: 4172})

Epoch :  75 loss training:  2.214755400287686 Time :  49652
accuracy train: 0.999509 val: 0.918656 test: 0.850106
max validation accuracy : 0.926614 max acc epoch : 71 test accuracy : 0.849841
Counter({0: 7720, 1: 6954, 2: 4172})

Epoch :  76 loss training:  2.1055176085210405 Time :  49765
accuracy train: 0.999607 val: 0.923961 test: 0.851036
max validation accuracy : 0.926614 max acc epoch : 71 test accuracy : 0.849841
Counter({1: 7714, 2: 6958, 0: 4174})

Epoch :  77 loss training:  2.410749624574237 Time :  49883
accuracy train: 0.999509 val: 0.924845 test: 0.853027
max validation accuracy : 0.926614 max acc epoch : 71 test accuracy : 0.849841
Counter({2: 7732, 0: 6944, 1: 4170})

Epoch :  78 loss training:  2.018839450989617 Time :  49999
accuracy train: 0.999607 val: 0.927498 test: 0.851434
max validation accuracy : 0.927498 max acc epoch : 78 test accuracy : 0.851434
Counter({2: 7737, 0: 6938, 1: 4171})

Epoch :  79 loss training:  2.5405765952018555 Time :  50115
accuracy train: 0.999509 val: 0.923077 test: 0.847584
max validation accuracy : 0.927498 max acc epoch : 78 test accuracy : 0.851434
Counter({1: 7731, 0: 6941, 2: 4174})

Epoch :  80 loss training:  2.244426617784484 Time :  50241
accuracy train: 0.999509 val: 0.923077 test: 0.850505
max validation accuracy : 0.927498 max acc epoch : 78 test accuracy : 0.851434
Counter({1: 7734, 2: 6938, 0: 4174})

Epoch :  81 loss training:  1.9499250084918458 Time :  50380
accuracy train: 0.999509 val: 0.924845 test: 0.853293
max validation accuracy : 0.927498 max acc epoch : 78 test accuracy : 0.851434
Counter({2: 7741, 0: 6932, 1: 4173})

Epoch :  82 loss training:  1.8627606930967886 Time :  50514
accuracy train: 0.999607 val: 0.925729 test: 0.851301
max validation accuracy : 0.927498 max acc epoch : 78 test accuracy : 0.851434
Counter({0: 7741, 1: 6932, 2: 4173})

Epoch :  83 loss training:  2.338274471767363 Time :  50654
accuracy train: 0.999607 val: 0.925729 test: 0.852098
max validation accuracy : 0.927498 max acc epoch : 78 test accuracy : 0.851434
Counter({2: 7742, 0: 6931, 1: 4173})

Epoch :  84 loss training:  1.9242989708000096 Time :  50787
accuracy train: 0.999607 val: 0.919540 test: 0.853824
max validation accuracy : 0.927498 max acc epoch : 78 test accuracy : 0.851434
Counter({2: 7758, 0: 6916, 1: 4172})

Epoch :  85 loss training:  1.756497795424366 Time :  50913
accuracy train: 0.999411 val: 0.923961 test: 0.854355
max validation accuracy : 0.927498 max acc epoch : 78 test accuracy : 0.851434
Counter({0: 7756, 2: 6920, 1: 4170})

Epoch :  86 loss training:  1.5599557865498355 Time :  51046
accuracy train: 0.999509 val: 0.924845 test: 0.853425
max validation accuracy : 0.927498 max acc epoch : 78 test accuracy : 0.851434
Counter({1: 7758, 0: 6918, 2: 4170})

Epoch :  87 loss training:  1.4038607204493019 Time :  51171
accuracy train: 0.999607 val: 0.930150 test: 0.853027
max validation accuracy : 0.930150 max acc epoch : 87 test accuracy : 0.853027
Counter({1: 7756, 0: 6919, 2: 4171})

Epoch :  88 loss training:  1.675745519598422 Time :  51300
accuracy train: 0.999509 val: 0.926614 test: 0.850239
max validation accuracy : 0.930150 max acc epoch : 87 test accuracy : 0.853027
Counter({0: 7758, 1: 6915, 2: 4173})

Epoch :  89 loss training:  1.3395848287109402 Time :  51429
accuracy train: 0.999607 val: 0.925729 test: 0.852098
max validation accuracy : 0.930150 max acc epoch : 87 test accuracy : 0.853027
Counter({0: 7759, 1: 6914, 2: 4173})

Epoch :  90 loss training:  1.730615173415572 Time :  51554
accuracy train: 0.999509 val: 0.927498 test: 0.855284
max validation accuracy : 0.930150 max acc epoch : 87 test accuracy : 0.853027
Counter({0: 7762, 2: 6912, 1: 4172})

Epoch :  91 loss training:  1.1267953761125682 Time :  51685
accuracy train: 0.999509 val: 0.926614 test: 0.853160
max validation accuracy : 0.930150 max acc epoch : 87 test accuracy : 0.853027
Counter({0: 7762, 1: 6912, 2: 4172})

Epoch :  92 loss training:  1.3196988532763498 Time :  51811
accuracy train: 0.999607 val: 0.928382 test: 0.853293
max validation accuracy : 0.930150 max acc epoch : 87 test accuracy : 0.853027
Counter({0: 7763, 1: 6910, 2: 4173})

Epoch :  93 loss training:  1.3423850524050067 Time :  51939
accuracy train: 0.999607 val: 0.932803 test: 0.851567
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({0: 7764, 1: 6910, 2: 4172})

Epoch :  94 loss training:  1.6206388737409725 Time :  52071
accuracy train: 0.999607 val: 0.927498 test: 0.856081
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({0: 7771, 1: 6901, 2: 4174})

Epoch :  95 loss training:  1.4085383070632815 Time :  52201
accuracy train: 0.999607 val: 0.929266 test: 0.854089
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({0: 7772, 1: 6900, 2: 4174})

Epoch :  96 loss training:  1.118141250903136 Time :  52328
accuracy train: 0.999607 val: 0.930150 test: 0.850637
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({2: 7777, 0: 6893, 1: 4176})

Epoch :  97 loss training:  1.1483142116703675 Time :  52452
accuracy train: 0.999509 val: 0.925729 test: 0.853293
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({0: 7782, 1: 6888, 2: 4176})

Epoch :  98 loss training:  0.9704368118400453 Time :  52579
accuracy train: 0.999705 val: 0.924845 test: 0.855550
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({2: 7785, 0: 6885, 1: 4176})

Epoch :  99 loss training:  1.2079475240898319 Time :  52709
accuracy train: 0.999607 val: 0.922193 test: 0.855019
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({0: 7785, 1: 6885, 2: 4176})

Epoch :  100 loss training:  1.2286824821821938 Time :  52837
accuracy train: 0.999509 val: 0.928382 test: 0.851434
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({2: 7794, 1: 6879, 0: 4173})

Epoch :  101 loss training:  1.3093961859813135 Time :  52963
accuracy train: 0.999509 val: 0.929266 test: 0.851699
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({0: 7797, 1: 6876, 2: 4173})

Epoch :  102 loss training:  1.190181391324586 Time :  53097
accuracy train: 0.999607 val: 0.924845 test: 0.855682
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({2: 7811, 1: 6861, 0: 4174})

Epoch :  103 loss training:  1.0959795616399788 Time :  53229
accuracy train: 0.999607 val: 0.926614 test: 0.854886
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({0: 7813, 1: 6862, 2: 4171})

Epoch :  104 loss training:  1.185871569061419 Time :  53357
accuracy train: 0.999607 val: 0.926614 test: 0.853691
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({0: 7828, 1: 6847, 2: 4171})

Epoch :  105 loss training:  1.2769390339199163 Time :  53488
accuracy train: 0.999607 val: 0.927498 test: 0.855948
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({2: 7865, 0: 6806, 1: 4175})

Epoch :  106 loss training:  1.0992226919406676 Time :  53622
accuracy train: 0.999607 val: 0.926614 test: 0.852230
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({0: 7872, 1: 6798, 2: 4176})

Epoch :  107 loss training:  1.3508644721077872 Time :  53758
accuracy train: 0.999607 val: 0.926614 test: 0.849310
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({0: 7872, 1: 6799, 2: 4175})

Epoch :  108 loss training:  1.2135466841427842 Time :  53886
accuracy train: 0.999607 val: 0.925729 test: 0.855815
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({0: 7871, 1: 6800, 2: 4175})

Epoch :  109 loss training:  0.9411207176199241 Time :  54014
accuracy train: 0.999607 val: 0.928382 test: 0.853558
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({2: 7870, 0: 6801, 1: 4175})

Epoch :  110 loss training:  0.9444513439775619 Time :  54137
accuracy train: 0.999509 val: 0.925729 test: 0.853691
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({0: 7866, 2: 6806, 1: 4174})

Epoch :  111 loss training:  1.126646132557653 Time :  54259
accuracy train: 0.999607 val: 0.925729 test: 0.854488
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({1: 7865, 0: 6807, 2: 4174})

Epoch :  112 loss training:  1.3898826401236875 Time :  54387
accuracy train: 0.999705 val: 0.930150 test: 0.853027
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({1: 7873, 0: 6797, 2: 4176})

Epoch :  113 loss training:  1.068011788165677 Time :  54514
accuracy train: 0.999607 val: 0.931034 test: 0.854620
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({0: 7876, 1: 6795, 2: 4175})

Epoch :  114 loss training:  0.9379955293479725 Time :  54647
accuracy train: 0.999607 val: 0.927498 test: 0.853160
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({0: 7873, 1: 6798, 2: 4175})

Epoch :  115 loss training:  0.9261204909271328 Time :  54761
accuracy train: 0.999607 val: 0.929266 test: 0.852496
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({0: 7874, 1: 6798, 2: 4174})

Epoch :  116 loss training:  1.0012421157989593 Time :  54865
accuracy train: 0.999411 val: 0.930150 test: 0.853956
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({0: 7869, 1: 6802, 2: 4175})

Epoch :  117 loss training:  0.8965108388692897 Time :  54978
accuracy train: 0.999509 val: 0.931919 test: 0.857276
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({0: 7870, 1: 6801, 2: 4175})

Epoch :  118 loss training:  0.7271124586986843 Time :  55104
accuracy train: 0.999607 val: 0.930150 test: 0.856745
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({0: 7875, 1: 6796, 2: 4175})

Epoch :  119 loss training:  1.0578807853235048 Time :  55240
accuracy train: 0.999607 val: 0.931034 test: 0.855284
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({0: 7876, 1: 6792, 2: 4178})

Epoch :  120 loss training:  0.7977887634642684 Time :  55370
accuracy train: 0.999705 val: 0.928382 test: 0.855550
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({0: 7873, 2: 6796, 1: 4177})

Epoch :  121 loss training:  0.6213368823719065 Time :  55502
accuracy train: 0.999607 val: 0.929266 test: 0.856479
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({1: 7870, 0: 6797, 2: 4179})

Epoch :  122 loss training:  0.7616161363093852 Time :  55624
accuracy train: 0.999607 val: 0.923961 test: 0.856346
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({2: 7864, 0: 6803, 1: 4179})

Epoch :  123 loss training:  1.1162418858875753 Time :  55732
accuracy train: 0.999705 val: 0.927498 test: 0.857143
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({0: 7862, 1: 6805, 2: 4179})

Epoch :  124 loss training:  0.7901049540269014 Time :  55840
accuracy train: 0.999607 val: 0.929266 test: 0.857674
max validation accuracy : 0.932803 max acc epoch : 93 test accuracy : 0.851567
Counter({1: 7862, 2: 6804, 0: 4180})

========================================================================================================================================================================================================
best acc epoch :  93
validation accuracy :  0.9328028293545535
test accuracy :  0.8515666489644185
last test_accuracy :  0.8576739245884227
second best val :  0.9319186560565871
second best test :  0.8515666489644185
max gap 12
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  97 	 val_accuracy : 0.93457 	 test_accuracy : 0.85555 	 last test_accuracy : 0.85475 	 second best val : 0.93369 	 second best test : 0.85263
k :  1 	 best_acc epoch :  69 	 val_accuracy : 0.92927 	 test_accuracy : 0.84918 	 last test_accuracy : 0.85688 	 second best val : 0.92838 	 second best test : 0.84918
k :  2 	 best_acc epoch :  99 	 val_accuracy : 0.93280 	 test_accuracy : 0.85595 	 last test_accuracy : 0.85489 	 second best val : 0.93103 	 second best test : 0.85635
k :  3 	 best_acc epoch :  93 	 val_accuracy : 0.93280 	 test_accuracy : 0.85157 	 last test_accuracy : 0.85767 	 second best val : 0.93192 	 second best test : 0.85157

avg :  	 val_accuracy : 0.93236 	 test_accuracy : 0.85306 	 last_accuracy : 0.85605 	 second best val : 0.93126 	 second best test : 0.85243

std :  	 val_accuracy : 0.00193 	 test_accuracy : 0.00282 	 last_accuracy : 0.00126 	 second best val : 0.00191 	 second best test : 0.00258


date and time :  Sat Jun 12 15:22:59 2021
itr : 0
Namespace(batch_size=64, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.005, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=994, weight_decay=0)
device :  cuda:0
Counter({0: 7614, 2: 6355, 1: 4877})

Epoch :  1 loss training:  438.79593881964684 Time :  79
accuracy train: 0.763626 val: 0.740053 test: 0.687467
max validation accuracy : 0.740053 max acc epoch : 1 test accuracy : 0.687467
Counter({0: 9431, 2: 7531, 1: 1884})
Epoch-1 lr: 0.005

Epoch :  2 loss training:  254.92758022248745 Time :  175
accuracy train: 0.836983 val: 0.818744 test: 0.743627
max validation accuracy : 0.818744 max acc epoch : 2 test accuracy : 0.743627
Counter({1: 9799, 0: 7129, 2: 1918})
Epoch-2 lr: 0.005

Epoch :  3 loss training:  201.30281229317188 Time :  271
accuracy train: 0.861338 val: 0.826702 test: 0.748407
max validation accuracy : 0.826702 max acc epoch : 3 test accuracy : 0.748407
Counter({2: 7227, 0: 7165, 1: 4454})
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  123.63281708210707 Time :  370
accuracy train: 0.922911 val: 0.869142 test: 0.787307
max validation accuracy : 0.869142 max acc epoch : 4 test accuracy : 0.787307
Counter({2: 9789, 1: 7139, 0: 1918})
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  108.7250356823206 Time :  468
accuracy train: 0.943042 val: 0.880637 test: 0.798460
max validation accuracy : 0.880637 max acc epoch : 5 test accuracy : 0.798460
Counter({1: 9912, 2: 7007, 0: 1927})
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  98.07989787310362 Time :  565
accuracy train: 0.934106 val: 0.868258 test: 0.779076
max validation accuracy : 0.880637 max acc epoch : 5 test accuracy : 0.798460
Counter({1: 9653, 2: 7220, 0: 1973})
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  69.65649747475982 Time :  663
accuracy train: 0.526760 val: 0.534925 test: 0.455125
max validation accuracy : 0.880637 max acc epoch : 5 test accuracy : 0.798460
Counter({1: 12405, 2: 5412, 0: 1029})
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  58.24321964196861 Time :  756
accuracy train: 0.581066 val: 0.573828 test: 0.500664
max validation accuracy : 0.880637 max acc epoch : 5 test accuracy : 0.798460
Counter({2: 12298, 1: 5193, 0: 1355})
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  52.35357812605798 Time :  853
accuracy train: 0.947069 val: 0.858532 test: 0.774695
max validation accuracy : 0.880637 max acc epoch : 5 test accuracy : 0.798460
Counter({2: 8922, 1: 8586, 0: 1338})
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  42.377776984125376 Time :  949
accuracy train: 0.984484 val: 0.906278 test: 0.810143
max validation accuracy : 0.906278 max acc epoch : 10 test accuracy : 0.810143
Counter({0: 6891, 2: 6851, 1: 5104})

Epoch :  11 loss training:  39.2744246404618 Time :  1052
accuracy train: 0.988903 val: 0.906278 test: 0.816516
max validation accuracy : 0.906278 max acc epoch : 10 test accuracy : 0.810143
Counter({1: 9254, 0: 7612, 2: 1980})

Epoch :  12 loss training:  27.792599527165294 Time :  1151
accuracy train: 0.995581 val: 0.909814 test: 0.822225
max validation accuracy : 0.909814 max acc epoch : 12 test accuracy : 0.822225
Counter({0: 8949, 1: 7916, 2: 1981})

Epoch :  13 loss training:  18.60305194114335 Time :  1276
accuracy train: 0.996170 val: 0.914235 test: 0.820366
max validation accuracy : 0.914235 max acc epoch : 13 test accuracy : 0.820366
Counter({0: 8910, 1: 7972, 2: 1964})

Epoch :  14 loss training:  13.034499280154705 Time :  1407
accuracy train: 0.998331 val: 0.914235 test: 0.819703
max validation accuracy : 0.914235 max acc epoch : 13 test accuracy : 0.820366
Counter({2: 8949, 1: 7925, 0: 1972})

Epoch :  15 loss training:  9.752531298436224 Time :  1535
accuracy train: 0.998331 val: 0.916888 test: 0.823155
max validation accuracy : 0.916888 max acc epoch : 15 test accuracy : 0.823155
Counter({2: 8852, 1: 8027, 0: 1967})

Epoch :  16 loss training:  8.61454857653007 Time :  1663
accuracy train: 0.984877 val: 0.901857 test: 0.813197
max validation accuracy : 0.916888 max acc epoch : 15 test accuracy : 0.823155
Counter({2: 9407, 1: 8417, 0: 1022})

Epoch :  17 loss training:  7.060710605583154 Time :  1791
accuracy train: 0.988314 val: 0.901857 test: 0.818375
max validation accuracy : 0.916888 max acc epoch : 15 test accuracy : 0.823155
Counter({2: 9648, 1: 8367, 0: 831})

Epoch :  18 loss training:  4.97771191271022 Time :  1915
accuracy train: 0.999116 val: 0.911583 test: 0.827934
max validation accuracy : 0.916888 max acc epoch : 15 test accuracy : 0.823155
Counter({1: 8599, 2: 8292, 0: 1955})

Epoch :  19 loss training:  4.208701492520049 Time :  2043
accuracy train: 0.999411 val: 0.920424 test: 0.830589
max validation accuracy : 0.920424 max acc epoch : 19 test accuracy : 0.830589
Counter({1: 8468, 0: 8441, 2: 1937})

Epoch :  20 loss training:  3.0973818459315225 Time :  2169
accuracy train: 0.999411 val: 0.913351 test: 0.830324
max validation accuracy : 0.920424 max acc epoch : 19 test accuracy : 0.830589
Counter({2: 8516, 1: 8384, 0: 1946})

Epoch :  21 loss training:  3.5470164679863956 Time :  2322
accuracy train: 0.997938 val: 0.912467 test: 0.826208
max validation accuracy : 0.920424 max acc epoch : 19 test accuracy : 0.830589
Counter({2: 8497, 1: 8405, 0: 1944})

Epoch :  22 loss training:  3.011581515776925 Time :  2455
accuracy train: 0.999313 val: 0.915119 test: 0.827934
max validation accuracy : 0.920424 max acc epoch : 19 test accuracy : 0.830589
Counter({2: 8535, 1: 8366, 0: 1945})

Epoch :  23 loss training:  2.601350622397149 Time :  2580
accuracy train: 0.999411 val: 0.917772 test: 0.829660
max validation accuracy : 0.920424 max acc epoch : 19 test accuracy : 0.830589
Counter({1: 8771, 2: 8136, 0: 1939})

Epoch :  24 loss training:  2.967443353292765 Time :  2705
accuracy train: 0.999411 val: 0.909814 test: 0.829262
max validation accuracy : 0.920424 max acc epoch : 19 test accuracy : 0.830589
Counter({1: 8822, 2: 8091, 0: 1933})

Epoch :  25 loss training:  2.1267993540968746 Time :  2841
accuracy train: 0.999411 val: 0.923961 test: 0.831652
max validation accuracy : 0.923961 max acc epoch : 25 test accuracy : 0.831652
Counter({2: 8642, 1: 8267, 0: 1937})

Epoch :  26 loss training:  2.4125225948228035 Time :  2965
accuracy train: 0.999313 val: 0.919540 test: 0.829793
max validation accuracy : 0.923961 max acc epoch : 25 test accuracy : 0.831652
Counter({1: 9012, 2: 7934, 0: 1900})

Epoch :  27 loss training:  1.8274806894914946 Time :  3094
accuracy train: 0.999313 val: 0.923077 test: 0.828067
max validation accuracy : 0.923961 max acc epoch : 25 test accuracy : 0.831652
Counter({1: 8823, 2: 8082, 0: 1941})

Epoch :  28 loss training:  2.276463958209206 Time :  3221
accuracy train: 0.999214 val: 0.921309 test: 0.828200
max validation accuracy : 0.923961 max acc epoch : 25 test accuracy : 0.831652
Counter({2: 8991, 1: 7930, 0: 1925})

Epoch :  29 loss training:  1.696936891959922 Time :  3348
accuracy train: 0.999313 val: 0.914235 test: 0.831253
max validation accuracy : 0.923961 max acc epoch : 25 test accuracy : 0.831652
Counter({2: 8882, 0: 8034, 1: 1930})

Epoch :  30 loss training:  1.5482850779444561 Time :  3471
accuracy train: 0.999411 val: 0.924845 test: 0.828200
max validation accuracy : 0.924845 max acc epoch : 30 test accuracy : 0.828200
Counter({1: 9032, 2: 7895, 0: 1919})

Epoch :  31 loss training:  1.4383422913306276 Time :  3592
accuracy train: 0.999509 val: 0.921309 test: 0.823287
max validation accuracy : 0.924845 max acc epoch : 30 test accuracy : 0.828200
Counter({1: 8873, 0: 8045, 2: 1928})

Epoch :  32 loss training:  1.5253458272491116 Time :  3728
accuracy train: 0.999509 val: 0.920424 test: 0.827801
max validation accuracy : 0.924845 max acc epoch : 30 test accuracy : 0.828200
Counter({1: 8793, 2: 8127, 0: 1926})

Epoch :  33 loss training:  1.5602997626592696 Time :  3858
accuracy train: 0.999509 val: 0.912467 test: 0.827138
max validation accuracy : 0.924845 max acc epoch : 30 test accuracy : 0.828200
Counter({1: 8842, 2: 8076, 0: 1928})

Epoch :  34 loss training:  1.557254075192759 Time :  3979
accuracy train: 0.999509 val: 0.923077 test: 0.831917
max validation accuracy : 0.924845 max acc epoch : 30 test accuracy : 0.828200
Counter({0: 9014, 1: 7915, 2: 1917})

Epoch :  35 loss training:  1.5833320672336413 Time :  4104
accuracy train: 0.999509 val: 0.916004 test: 0.820499
max validation accuracy : 0.924845 max acc epoch : 30 test accuracy : 0.828200
Counter({1: 8909, 0: 8003, 2: 1934})

Epoch :  36 loss training:  1.6495160531803776 Time :  4241
accuracy train: 0.999509 val: 0.916888 test: 0.832183
max validation accuracy : 0.924845 max acc epoch : 30 test accuracy : 0.828200
Counter({2: 9055, 0: 7868, 1: 1923})

Epoch :  37 loss training:  0.8977908959113847 Time :  4379
accuracy train: 0.999509 val: 0.919540 test: 0.828067
max validation accuracy : 0.924845 max acc epoch : 30 test accuracy : 0.828200
Counter({1: 9054, 2: 7861, 0: 1931})

Epoch :  38 loss training:  0.9969379489757557 Time :  4506
accuracy train: 0.999509 val: 0.920424 test: 0.830589
max validation accuracy : 0.924845 max acc epoch : 30 test accuracy : 0.828200
Counter({1: 9172, 0: 7764, 2: 1910})

Epoch :  39 loss training:  1.2710829861789534 Time :  4633
accuracy train: 0.999509 val: 0.919540 test: 0.822889
max validation accuracy : 0.924845 max acc epoch : 30 test accuracy : 0.828200
Counter({1: 9087, 2: 7853, 0: 1906})

Epoch :  40 loss training:  1.0242269878972365 Time :  4760
accuracy train: 0.999509 val: 0.910698 test: 0.829262
max validation accuracy : 0.924845 max acc epoch : 30 test accuracy : 0.828200
Counter({2: 9238, 1: 7706, 0: 1902})

Epoch :  41 loss training:  2.1082823822889623 Time :  4879
accuracy train: 0.999509 val: 0.912467 test: 0.827801
max validation accuracy : 0.924845 max acc epoch : 30 test accuracy : 0.828200
Counter({2: 9306, 0: 7640, 1: 1900})

Epoch :  42 loss training:  0.7982733316530357 Time :  5003
accuracy train: 0.999607 val: 0.916004 test: 0.826739
max validation accuracy : 0.924845 max acc epoch : 30 test accuracy : 0.828200
Counter({1: 9317, 2: 7646, 0: 1883})

Epoch :  43 loss training:  1.076537817629287 Time :  5128
accuracy train: 0.999509 val: 0.908930 test: 0.821561
max validation accuracy : 0.924845 max acc epoch : 30 test accuracy : 0.828200
Counter({0: 9199, 1: 7720, 2: 1927})

Epoch :  44 loss training:  1.5323335429029612 Time :  5253
accuracy train: 0.999607 val: 0.912467 test: 0.821694
max validation accuracy : 0.924845 max acc epoch : 30 test accuracy : 0.828200
Counter({2: 9090, 1: 7835, 0: 1921})

Epoch :  45 loss training:  1.1289705953781777 Time :  5404
accuracy train: 0.999607 val: 0.925729 test: 0.831784
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({1: 9127, 0: 7819, 2: 1900})

Epoch :  46 loss training:  0.8045413261722842 Time :  5534
accuracy train: 0.999607 val: 0.922193 test: 0.831784
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({1: 9124, 2: 7805, 0: 1917})

Epoch :  47 loss training:  1.3232291288568376 Time :  5656
accuracy train: 0.999509 val: 0.923077 test: 0.823951
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({1: 9227, 2: 7714, 0: 1905})

Epoch :  48 loss training:  0.9378525907472977 Time :  5780
accuracy train: 0.999509 val: 0.912467 test: 0.825943
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({1: 9137, 0: 7806, 2: 1903})

Epoch :  49 loss training:  0.6721049868247064 Time :  5917
accuracy train: 0.999509 val: 0.916888 test: 0.828200
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({0: 9040, 1: 7910, 2: 1896})

Epoch :  50 loss training:  1.3864136498377775 Time :  6037
accuracy train: 0.998822 val: 0.917772 test: 0.827934
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({0: 9406, 1: 7547, 2: 1893})

Epoch :  51 loss training:  1.0188806888887711 Time :  6167
accuracy train: 0.998920 val: 0.920424 test: 0.824881
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({1: 9375, 0: 7578, 2: 1893})

Epoch :  52 loss training:  1.2964632279677062 Time :  6298
accuracy train: 0.999509 val: 0.918656 test: 0.823553
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({0: 9323, 2: 7621, 1: 1902})

Epoch :  53 loss training:  1.2376275197632367 Time :  6422
accuracy train: 0.999607 val: 0.915119 test: 0.822092
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({1: 9309, 0: 7642, 2: 1895})

Epoch :  54 loss training:  0.6583506018439493 Time :  6548
accuracy train: 0.999607 val: 0.912467 test: 0.821827
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({1: 9212, 0: 7742, 2: 1892})

Epoch :  55 loss training:  0.6107265676861289 Time :  6673
accuracy train: 0.999411 val: 0.911583 test: 0.827005
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({1: 7426, 0: 6120, 2: 5300})

Epoch :  56 loss training:  0.8442748421850865 Time :  6799
accuracy train: 0.999607 val: 0.914235 test: 0.818242
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({0: 9177, 1: 7789, 2: 1880})

Epoch :  57 loss training:  1.1373225881784492 Time :  6935
accuracy train: 0.999607 val: 0.917772 test: 0.825412
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({2: 9287, 1: 7678, 0: 1881})

Epoch :  58 loss training:  0.7112203246625768 Time :  7060
accuracy train: 0.999607 val: 0.909814 test: 0.813595
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({2: 9288, 1: 7676, 0: 1882})

Epoch :  59 loss training:  0.8837783682372446 Time :  7192
accuracy train: 0.999607 val: 0.916004 test: 0.815056
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({1: 9220, 2: 7739, 0: 1887})

Epoch :  60 loss training:  0.8701786495236092 Time :  7316
accuracy train: 0.999607 val: 0.915119 test: 0.815985
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({1: 9374, 0: 7577, 2: 1895})

Epoch :  61 loss training:  1.2024730534108699 Time :  7443
accuracy train: 0.999607 val: 0.911583 test: 0.817844
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({0: 9316, 2: 7634, 1: 1896})

Epoch :  62 loss training:  1.0418891280322669 Time :  7568
accuracy train: 0.999509 val: 0.913351 test: 0.814657
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({2: 9229, 1: 7693, 0: 1924})

Epoch :  63 loss training:  0.938462209880413 Time :  7671
accuracy train: 0.999607 val: 0.916004 test: 0.813197
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({2: 9165, 1: 7776, 0: 1905})

Epoch :  64 loss training:  0.7505204640369811 Time :  7772
accuracy train: 0.999509 val: 0.903625 test: 0.820632
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({1: 9175, 0: 7756, 2: 1915})

Epoch :  65 loss training:  1.1130036110955643 Time :  7873
accuracy train: 0.999607 val: 0.918656 test: 0.823155
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({0: 9163, 1: 7765, 2: 1918})

Epoch :  66 loss training:  0.8911227810611422 Time :  7976
accuracy train: 0.999607 val: 0.913351 test: 0.821429
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({1: 9274, 2: 7662, 0: 1910})

Epoch :  67 loss training:  0.900931545516471 Time :  8080
accuracy train: 0.999607 val: 0.909814 test: 0.821827
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({0: 9285, 2: 7661, 1: 1900})

Epoch :  68 loss training:  0.5513160491658198 Time :  8184
accuracy train: 0.999509 val: 0.910698 test: 0.820632
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({2: 9264, 0: 7679, 1: 1903})

Epoch :  69 loss training:  0.8389959106867764 Time :  8286
accuracy train: 0.999607 val: 0.905393 test: 0.816516
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({2: 9247, 1: 7676, 0: 1923})

Epoch :  70 loss training:  1.1267704025290755 Time :  8388
accuracy train: 0.999607 val: 0.912467 test: 0.817313
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({0: 9241, 2: 7726, 1: 1879})

Epoch :  71 loss training:  0.6312303687699341 Time :  8490
accuracy train: 0.999607 val: 0.912467 test: 0.817711
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({2: 9241, 0: 7739, 1: 1866})

Epoch :  72 loss training:  0.7655571679915312 Time :  8595
accuracy train: 0.999607 val: 0.916888 test: 0.827403
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({1: 9223, 2: 7765, 0: 1858})

Epoch :  73 loss training:  0.937837612951057 Time :  8699
accuracy train: 0.924482 val: 0.834660 test: 0.741901
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({2: 7088, 1: 5958, 0: 5800})

Epoch :  74 loss training:  1.2570705599812726 Time :  8800
accuracy train: 0.699892 val: 0.603890 test: 0.512480
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({1: 7626, 0: 7139, 2: 4081})

Epoch :  75 loss training:  0.796305417021145 Time :  8903
accuracy train: 0.706570 val: 0.622458 test: 0.527881
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({2: 7483, 1: 7021, 0: 4342})

Epoch :  76 loss training:  0.7108556760336739 Time :  9003
accuracy train: 0.637042 val: 0.566755 test: 0.476500
max validation accuracy : 0.925729 max acc epoch : 45 test accuracy : 0.831784
Counter({2: 9601, 1: 8795, 0: 450})

========================================================================================================================================================================================================
best acc epoch :  45
validation accuracy :  0.9257294429708223
test accuracy :  0.8317843866171004
last test_accuracy :  0.47650026553372277
second best val :  0.9248452696728559
second best test :  0.8281996813595327
max gap 15
========================================================================================================================================================================================================

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.6/site-packages/matplotlib/colors.py", line 174, in to_rgba
    rgba = _colors_full_map.cache[c, alpha]
KeyError: (9, None)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.6/site-packages/matplotlib/axes/_axes.py", line 4232, in scatter
    colors = mcolors.to_rgba_array(c)
  File "/opt/anaconda3/lib/python3.6/site-packages/matplotlib/colors.py", line 275, in to_rgba_array
    result[i] = to_rgba(cc, alpha)
  File "/opt/anaconda3/lib/python3.6/site-packages/matplotlib/colors.py", line 176, in to_rgba
    rgba = _to_rgba_no_colorcycle(c, alpha)
  File "/opt/anaconda3/lib/python3.6/site-packages/matplotlib/colors.py", line 227, in _to_rgba_no_colorcycle
    raise ValueError("Invalid RGBA argument: {!r}".format(orig_c))
ValueError: Invalid RGBA argument: 9

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "main.py", line 367, in <module>
    
  File "main.py", line 291, in main
    for i in range(args.num_layers):
  File "main.py", line 334, in plot_tsne
    h = tsne.fit_transform(embed)
  File "/opt/anaconda3/lib/python3.6/site-packages/matplotlib/pyplot.py", line 2864, in scatter
    is not None else {}), **kwargs)
  File "/opt/anaconda3/lib/python3.6/site-packages/matplotlib/__init__.py", line 1810, in inner
    return func(ax, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.6/site-packages/matplotlib/axes/_axes.py", line 4245, in scatter
    .format(nc=n_elem, xs=x.size, ys=y.size)
ValueError: 'c' argument has 7532 elements, which is not acceptable for use with 'x' with size 300, 'y' with size 300.
