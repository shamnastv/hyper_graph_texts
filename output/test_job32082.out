

date and time :  Wed Apr 21 21:17:27 2021
Namespace(batch_size=32, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=0)
device :  cuda:0
Counter({2: 7634, 1: 6227, 0: 4985})

Epoch :  1 loss training:  703.3909946978092 Time :  72
accuracy train: 0.821860 val: 0.793988 test: 0.742432
max validation accuracy : 0.793988 max acc epoch : 1 test accuracy : 0.742432
Epoch-1 lr: 0.001

Epoch :  2 loss training:  403.8335599601269 Time :  117
accuracy train: 0.841108 val: 0.790451 test: 0.751593
max validation accuracy : 0.793988 max acc epoch : 1 test accuracy : 0.742432
Counter({1: 9231, 0: 7747, 2: 1868})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  378.33705735206604 Time :  166
accuracy train: 0.874693 val: 0.814324 test: 0.770048
max validation accuracy : 0.814324 max acc epoch : 3 test accuracy : 0.770048
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  285.0380846261978 Time :  211
accuracy train: 0.903467 val: 0.834660 test: 0.782130
max validation accuracy : 0.834660 max acc epoch : 4 test accuracy : 0.782130
Counter({0: 6302, 2: 6289, 1: 6255})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  276.75450667738914 Time :  261
accuracy train: 0.912501 val: 0.855880 test: 0.791954
max validation accuracy : 0.855880 max acc epoch : 5 test accuracy : 0.791954
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  240.01922984421253 Time :  307
accuracy train: 0.921929 val: 0.852343 test: 0.798194
max validation accuracy : 0.855880 max acc epoch : 5 test accuracy : 0.791954
Counter({0: 7989, 1: 6109, 2: 4748})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  237.14638075232506 Time :  355
accuracy train: 0.937936 val: 0.871795 test: 0.800584
max validation accuracy : 0.871795 max acc epoch : 7 test accuracy : 0.800584
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  207.3152793198824 Time :  401
accuracy train: 0.943239 val: 0.861185 test: 0.802974
max validation accuracy : 0.871795 max acc epoch : 7 test accuracy : 0.800584
Counter({1: 7636, 2: 6474, 0: 4736})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  210.13182197511196 Time :  455
accuracy train: 0.942748 val: 0.858532 test: 0.804434
max validation accuracy : 0.871795 max acc epoch : 7 test accuracy : 0.800584
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  177.6236832216382 Time :  503
accuracy train: 0.950997 val: 0.874447 test: 0.808152
max validation accuracy : 0.874447 max acc epoch : 10 test accuracy : 0.808152
Counter({2: 7448, 1: 5770, 0: 5628})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  189.57034684717655 Time :  551
accuracy train: 0.952077 val: 0.875332 test: 0.811869
max validation accuracy : 0.875332 max acc epoch : 11 test accuracy : 0.811869
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  169.07962888479233 Time :  596
accuracy train: 0.956103 val: 0.876216 test: 0.813994
max validation accuracy : 0.876216 max acc epoch : 12 test accuracy : 0.813994
Counter({1: 7787, 2: 5621, 0: 5438})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  176.73798455297947 Time :  654
accuracy train: 0.956103 val: 0.876216 test: 0.812268
max validation accuracy : 0.876216 max acc epoch : 12 test accuracy : 0.813994
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  161.72821623831987 Time :  698
accuracy train: 0.955907 val: 0.879752 test: 0.812002
max validation accuracy : 0.879752 max acc epoch : 14 test accuracy : 0.812002
Counter({1: 6673, 0: 6099, 2: 6074})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  170.9812983572483 Time :  748
accuracy train: 0.959049 val: 0.878868 test: 0.812400
max validation accuracy : 0.879752 max acc epoch : 14 test accuracy : 0.812002
Epoch-15 lr: 3.125e-05

Epoch :  16 loss training:  156.1846191585064 Time :  793
accuracy train: 0.962978 val: 0.880637 test: 0.812268
max validation accuracy : 0.880637 max acc epoch : 16 test accuracy : 0.812268
Counter({0: 7297, 2: 5970, 1: 5579})
Epoch-16 lr: 3.125e-05

Epoch :  17 loss training:  158.16490188241005 Time :  841
accuracy train: 0.961603 val: 0.884173 test: 0.813728
max validation accuracy : 0.884173 max acc epoch : 17 test accuracy : 0.813728
Epoch-17 lr: 3.125e-05

Epoch :  18 loss training:  150.94899639487267 Time :  886
accuracy train: 0.961799 val: 0.881521 test: 0.813463
max validation accuracy : 0.884173 max acc epoch : 17 test accuracy : 0.813728
Counter({2: 7957, 1: 5840, 0: 5049})
Epoch-18 lr: 1.5625e-05

Epoch :  19 loss training:  149.28982530534267 Time :  934
accuracy train: 0.962978 val: 0.885057 test: 0.815056
max validation accuracy : 0.885057 max acc epoch : 19 test accuracy : 0.815056
Epoch-19 lr: 1.5625e-05

Epoch :  20 loss training:  148.5897767096758 Time :  982
accuracy train: 0.961799 val: 0.877984 test: 0.814923
max validation accuracy : 0.885057 max acc epoch : 19 test accuracy : 0.815056
Counter({1: 8004, 2: 5519, 0: 5323})

Epoch :  21 loss training:  152.98324713110924 Time :  1031
accuracy train: 0.962683 val: 0.882405 test: 0.813728
max validation accuracy : 0.885057 max acc epoch : 19 test accuracy : 0.815056

Epoch :  22 loss training:  150.89252364635468 Time :  1077
accuracy train: 0.964352 val: 0.878868 test: 0.815056
max validation accuracy : 0.885057 max acc epoch : 19 test accuracy : 0.815056
Counter({1: 7572, 2: 5954, 0: 5320})

Epoch :  23 loss training:  156.06522167474031 Time :  1125
accuracy train: 0.964451 val: 0.885057 test: 0.812533
max validation accuracy : 0.885057 max acc epoch : 19 test accuracy : 0.815056

Epoch :  24 loss training:  146.37194274365902 Time :  1168
accuracy train: 0.965334 val: 0.877100 test: 0.815587
max validation accuracy : 0.885057 max acc epoch : 19 test accuracy : 0.815056
Counter({2: 7396, 1: 6474, 0: 4976})

Epoch :  25 loss training:  147.83685551583767 Time :  1218
accuracy train: 0.964156 val: 0.887710 test: 0.818109
max validation accuracy : 0.887710 max acc epoch : 25 test accuracy : 0.818109

Epoch :  26 loss training:  151.07374349981546 Time :  1262
accuracy train: 0.964352 val: 0.881521 test: 0.814392
max validation accuracy : 0.887710 max acc epoch : 25 test accuracy : 0.818109
Counter({2: 7467, 1: 6494, 0: 4885})

Epoch :  27 loss training:  148.57327158749104 Time :  1311
accuracy train: 0.965924 val: 0.884173 test: 0.815056
max validation accuracy : 0.887710 max acc epoch : 25 test accuracy : 0.818109

Epoch :  28 loss training:  143.49757712334394 Time :  1355
accuracy train: 0.963174 val: 0.890363 test: 0.815720
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720
Counter({0: 6818, 2: 6057, 1: 5971})

Epoch :  29 loss training:  147.64946453645825 Time :  1404
accuracy train: 0.966415 val: 0.874447 test: 0.815189
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720

Epoch :  30 loss training:  146.39309822767973 Time :  1448
accuracy train: 0.965334 val: 0.877984 test: 0.815321
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720
Counter({2: 6685, 1: 6105, 0: 6056})

Epoch :  31 loss training:  145.5781700015068 Time :  1499
accuracy train: 0.966316 val: 0.876216 test: 0.814126
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720

Epoch :  32 loss training:  143.92271587997675 Time :  1544
accuracy train: 0.965727 val: 0.876216 test: 0.814923
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720
Counter({1: 7478, 0: 6717, 2: 4651})

Epoch :  33 loss training:  148.06154622137547 Time :  1597
accuracy train: 0.965629 val: 0.881521 test: 0.814392
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720

Epoch :  34 loss training:  146.44201171398163 Time :  1642
accuracy train: 0.967004 val: 0.879752 test: 0.815189
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720
Counter({0: 7560, 2: 6659, 1: 4627})

Epoch :  35 loss training:  141.90337351709604 Time :  1693
accuracy train: 0.966513 val: 0.879752 test: 0.810409
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720

Epoch :  36 loss training:  142.48389162123203 Time :  1740
accuracy train: 0.966022 val: 0.888594 test: 0.816516
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720
Counter({2: 8430, 0: 7358, 1: 3058})

Epoch :  37 loss training:  137.58916875720024 Time :  1788
accuracy train: 0.967004 val: 0.883289 test: 0.817313
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720

Epoch :  38 loss training:  144.49225836247206 Time :  1834
accuracy train: 0.969754 val: 0.885057 test: 0.816383
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720
Counter({0: 6932, 1: 6420, 2: 5494})

Epoch :  39 loss training:  137.68669714778662 Time :  1879
accuracy train: 0.968379 val: 0.878868 test: 0.816649
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720

Epoch :  40 loss training:  137.90067014843225 Time :  1924
accuracy train: 0.967298 val: 0.884173 test: 0.816118
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720
Counter({2: 7108, 0: 6112, 1: 5626})

Epoch :  41 loss training:  136.0039158910513 Time :  1977
accuracy train: 0.968182 val: 0.883289 test: 0.813994
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720

Epoch :  42 loss training:  133.47448644042015 Time :  2023
accuracy train: 0.968968 val: 0.882405 test: 0.815189
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720
Counter({2: 8449, 1: 5707, 0: 4690})

Epoch :  43 loss training:  140.6455280482769 Time :  2076
accuracy train: 0.969655 val: 0.879752 test: 0.817578
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720

Epoch :  44 loss training:  141.14002227038145 Time :  2122
accuracy train: 0.968870 val: 0.884173 test: 0.816516
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720
Counter({1: 8453, 0: 5730, 2: 4663})

Epoch :  45 loss training:  138.66529319435358 Time :  2175
accuracy train: 0.969262 val: 0.881521 test: 0.817047
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720

Epoch :  46 loss training:  135.99310211092234 Time :  2221
accuracy train: 0.969262 val: 0.884173 test: 0.819172
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720
Counter({1: 7844, 0: 6798, 2: 4204})

Epoch :  47 loss training:  134.09699280560017 Time :  2277
accuracy train: 0.970441 val: 0.884173 test: 0.817180
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720

Epoch :  48 loss training:  132.69415859133005 Time :  2324
accuracy train: 0.969557 val: 0.883289 test: 0.819304
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720
Counter({1: 7929, 2: 7471, 0: 3446})

Epoch :  49 loss training:  134.5828425064683 Time :  2372
accuracy train: 0.969557 val: 0.881521 test: 0.815852
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720

Epoch :  50 loss training:  131.3743268251419 Time :  2417
accuracy train: 0.969754 val: 0.882405 test: 0.814525
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720
Counter({2: 7827, 0: 7251, 1: 3768})

Epoch :  51 loss training:  135.01320327073336 Time :  2466
accuracy train: 0.971030 val: 0.879752 test: 0.815852
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720

Epoch :  52 loss training:  132.1034485846758 Time :  2509
accuracy train: 0.971914 val: 0.873563 test: 0.814126
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720
Counter({2: 7595, 1: 7566, 0: 3685})

Epoch :  53 loss training:  128.96154173463583 Time :  2555
accuracy train: 0.971816 val: 0.882405 test: 0.816649
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720

Epoch :  54 loss training:  130.9726478755474 Time :  2597
accuracy train: 0.972012 val: 0.883289 test: 0.817578
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720
Counter({2: 7395, 1: 6614, 0: 4837})

Epoch :  55 loss training:  125.3570553585887 Time :  2643
accuracy train: 0.973780 val: 0.880637 test: 0.819304
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720

Epoch :  56 loss training:  125.32782056182623 Time :  2685
accuracy train: 0.973780 val: 0.880637 test: 0.814126
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720
Counter({2: 7491, 1: 7372, 0: 3983})

Epoch :  57 loss training:  132.5682914480567 Time :  2733
accuracy train: 0.972896 val: 0.880637 test: 0.815852
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720

Epoch :  58 loss training:  128.02871902287006 Time :  2776
accuracy train: 0.971914 val: 0.885942 test: 0.818640
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720
Counter({1: 7442, 0: 7436, 2: 3968})

Epoch :  59 loss training:  128.03158596530557 Time :  2822
accuracy train: 0.971718 val: 0.879752 test: 0.816516
max validation accuracy : 0.890363 max acc epoch : 28 test accuracy : 0.815720

========================================================================================================================================================================================================
max acc epoch :  28
max validation accuracy :  0.8903625110521662
test accuracy :  0.8157195963887414
last test_accuracy :  0.8165161975570897
========================================================================================================================================================================================================



date and time :  Wed Apr 21 22:04:52 2021
Namespace(batch_size=32, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=True, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=0)
device :  cuda:0
Counter({1: 7629, 2: 6246, 0: 4971})

Epoch :  1 loss training:  689.7014664411545 Time :  52
accuracy train: 0.820780 val: 0.778957 test: 0.739644
max validation accuracy : 0.778957 max acc epoch : 1 test accuracy : 0.739644
Epoch-1 lr: 0.001

Epoch :  2 loss training:  408.3372315168381 Time :  99
accuracy train: 0.856231 val: 0.809019 test: 0.761285
max validation accuracy : 0.809019 max acc epoch : 2 test accuracy : 0.761285
Counter({2: 8904, 0: 7983, 1: 1959})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  366.6548829972744 Time :  148
accuracy train: 0.874202 val: 0.825818 test: 0.771907
max validation accuracy : 0.825818 max acc epoch : 3 test accuracy : 0.771907
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  282.3154793381691 Time :  194
accuracy train: 0.906904 val: 0.846154 test: 0.796867
max validation accuracy : 0.846154 max acc epoch : 4 test accuracy : 0.796867
Counter({2: 9135, 1: 7052, 0: 2659})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  281.6529414355755 Time :  247
accuracy train: 0.919474 val: 0.865606 test: 0.800053
max validation accuracy : 0.865606 max acc epoch : 5 test accuracy : 0.800053
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  234.71171435713768 Time :  294
accuracy train: 0.926348 val: 0.861185 test: 0.793149
max validation accuracy : 0.865606 max acc epoch : 5 test accuracy : 0.800053
Counter({0: 9057, 1: 6677, 2: 3112})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  233.0757966786623 Time :  349
accuracy train: 0.935284 val: 0.868258 test: 0.803505
max validation accuracy : 0.868258 max acc epoch : 7 test accuracy : 0.803505
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  205.27232502400875 Time :  395
accuracy train: 0.944221 val: 0.874447 test: 0.807754
max validation accuracy : 0.874447 max acc epoch : 8 test accuracy : 0.807754
Counter({2: 9022, 0: 5836, 1: 3988})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  204.54185064136982 Time :  447
accuracy train: 0.948836 val: 0.883289 test: 0.806691
max validation accuracy : 0.883289 max acc epoch : 9 test accuracy : 0.806691
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  172.70618061721325 Time :  496
accuracy train: 0.952764 val: 0.884173 test: 0.811869
max validation accuracy : 0.884173 max acc epoch : 10 test accuracy : 0.811869
Counter({1: 7090, 2: 6239, 0: 5517})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  180.9330376535654 Time :  550
accuracy train: 0.956594 val: 0.880637 test: 0.809745
max validation accuracy : 0.884173 max acc epoch : 10 test accuracy : 0.811869
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  164.63581769913435 Time :  597
accuracy train: 0.960031 val: 0.877984 test: 0.812666
max validation accuracy : 0.884173 max acc epoch : 10 test accuracy : 0.811869
Counter({2: 8617, 1: 6688, 0: 3541})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  169.9353642091155 Time :  651
accuracy train: 0.962388 val: 0.878868 test: 0.815056
max validation accuracy : 0.884173 max acc epoch : 10 test accuracy : 0.811869
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  156.86066307872534 Time :  699
accuracy train: 0.963960 val: 0.879752 test: 0.813463
max validation accuracy : 0.884173 max acc epoch : 10 test accuracy : 0.811869
Counter({1: 7294, 0: 5854, 2: 5698})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  165.44064120948315 Time :  753
accuracy train: 0.964843 val: 0.882405 test: 0.815985
max validation accuracy : 0.884173 max acc epoch : 10 test accuracy : 0.811869
Epoch-15 lr: 3.125e-05

Epoch :  16 loss training:  150.68141197413206 Time :  802
accuracy train: 0.963763 val: 0.885057 test: 0.815587
max validation accuracy : 0.885057 max acc epoch : 16 test accuracy : 0.815587
Counter({2: 7825, 1: 7294, 0: 3727})
Epoch-16 lr: 3.125e-05

Epoch :  17 loss training:  151.2388070821762 Time :  855
accuracy train: 0.965433 val: 0.873563 test: 0.819172
max validation accuracy : 0.885057 max acc epoch : 16 test accuracy : 0.815587
Epoch-17 lr: 3.125e-05

Epoch :  18 loss training:  150.05688659101725 Time :  904
accuracy train: 0.967004 val: 0.885942 test: 0.817977
max validation accuracy : 0.885942 max acc epoch : 18 test accuracy : 0.817977
Counter({2: 7038, 1: 6644, 0: 5164})
Epoch-18 lr: 1.5625e-05

Epoch :  19 loss training:  150.7864610105753 Time :  957
accuracy train: 0.966316 val: 0.881521 test: 0.815985
max validation accuracy : 0.885942 max acc epoch : 18 test accuracy : 0.817977
Epoch-19 lr: 1.5625e-05

Epoch :  20 loss training:  147.73402815312147 Time :  1005
accuracy train: 0.967200 val: 0.886826 test: 0.818109
max validation accuracy : 0.886826 max acc epoch : 20 test accuracy : 0.818109
Counter({2: 7312, 1: 6453, 0: 5081})

Epoch :  21 loss training:  146.85978879779577 Time :  1058
accuracy train: 0.967102 val: 0.885057 test: 0.817313
max validation accuracy : 0.886826 max acc epoch : 20 test accuracy : 0.818109

Epoch :  22 loss training:  145.22125978022814 Time :  1106
accuracy train: 0.965825 val: 0.882405 test: 0.817446
max validation accuracy : 0.886826 max acc epoch : 20 test accuracy : 0.818109
Counter({2: 7528, 1: 7394, 0: 3924})

Epoch :  23 loss training:  156.0161663070321 Time :  1158
accuracy train: 0.966611 val: 0.885057 test: 0.817313
max validation accuracy : 0.886826 max acc epoch : 20 test accuracy : 0.818109

Epoch :  24 loss training:  146.0942061841488 Time :  1208
accuracy train: 0.967593 val: 0.886826 test: 0.818375
max validation accuracy : 0.886826 max acc epoch : 20 test accuracy : 0.818109
Counter({2: 8203, 1: 6933, 0: 3710})

Epoch :  25 loss training:  141.05167225003242 Time :  1266
accuracy train: 0.968673 val: 0.885942 test: 0.818375
max validation accuracy : 0.886826 max acc epoch : 20 test accuracy : 0.818109

Epoch :  26 loss training:  140.86242052912712 Time :  1313
accuracy train: 0.968673 val: 0.888594 test: 0.819172
max validation accuracy : 0.888594 max acc epoch : 26 test accuracy : 0.819172
Counter({2: 8408, 1: 6033, 0: 4405})

Epoch :  27 loss training:  142.18966053426266 Time :  1366
accuracy train: 0.968771 val: 0.886826 test: 0.820234
max validation accuracy : 0.888594 max acc epoch : 26 test accuracy : 0.819172

Epoch :  28 loss training:  139.66690819710493 Time :  1413
accuracy train: 0.970048 val: 0.888594 test: 0.818640
max validation accuracy : 0.888594 max acc epoch : 26 test accuracy : 0.819172
Counter({1: 7045, 0: 6023, 2: 5778})

Epoch :  29 loss training:  144.16343221068382 Time :  1466
accuracy train: 0.970441 val: 0.884173 test: 0.821030
max validation accuracy : 0.888594 max acc epoch : 26 test accuracy : 0.819172

Epoch :  30 loss training:  141.11783236265182 Time :  1516
accuracy train: 0.970539 val: 0.885942 test: 0.820765
max validation accuracy : 0.888594 max acc epoch : 26 test accuracy : 0.819172
Counter({1: 6980, 0: 6811, 2: 5055})

Epoch :  31 loss training:  140.43788516521454 Time :  1567
accuracy train: 0.969754 val: 0.889478 test: 0.817446
max validation accuracy : 0.889478 max acc epoch : 31 test accuracy : 0.817446

Epoch :  32 loss training:  135.5405609421432 Time :  1620
accuracy train: 0.969361 val: 0.885057 test: 0.818242
max validation accuracy : 0.889478 max acc epoch : 31 test accuracy : 0.817446
Counter({1: 7869, 0: 6594, 2: 4383})

Epoch :  33 loss training:  141.97410113364458 Time :  1674
accuracy train: 0.969262 val: 0.888594 test: 0.815985
max validation accuracy : 0.889478 max acc epoch : 31 test accuracy : 0.817446

Epoch :  34 loss training:  148.74967823922634 Time :  1724
accuracy train: 0.970736 val: 0.884173 test: 0.817844
max validation accuracy : 0.889478 max acc epoch : 31 test accuracy : 0.817446
Counter({0: 7706, 2: 6702, 1: 4438})

Epoch :  35 loss training:  143.45339038968086 Time :  1777
accuracy train: 0.971423 val: 0.886826 test: 0.818773
max validation accuracy : 0.889478 max acc epoch : 31 test accuracy : 0.817446

Epoch :  36 loss training:  136.93309092521667 Time :  1828
accuracy train: 0.971325 val: 0.892131 test: 0.816516
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516
Counter({1: 6801, 0: 6406, 2: 5639})

Epoch :  37 loss training:  135.74150981009007 Time :  1883
accuracy train: 0.970736 val: 0.886826 test: 0.817977
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516

Epoch :  38 loss training:  137.81444784253836 Time :  1933
accuracy train: 0.972896 val: 0.888594 test: 0.820366
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516
Counter({2: 7172, 1: 6627, 0: 5047})

Epoch :  39 loss training:  137.42176489531994 Time :  1986
accuracy train: 0.971521 val: 0.888594 test: 0.817711
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516

Epoch :  40 loss training:  133.30923042446375 Time :  2034
accuracy train: 0.974271 val: 0.888594 test: 0.819172
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516
Counter({2: 8492, 0: 5321, 1: 5033})

Epoch :  41 loss training:  135.71448669582605 Time :  2090
accuracy train: 0.973485 val: 0.890363 test: 0.818375
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516

Epoch :  42 loss training:  138.16875606030226 Time :  2140
accuracy train: 0.972601 val: 0.891247 test: 0.820366
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516
Counter({1: 7409, 2: 6120, 0: 5317})

Epoch :  43 loss training:  136.3499589562416 Time :  2196
accuracy train: 0.972209 val: 0.885942 test: 0.818109
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516

Epoch :  44 loss training:  135.59442929178476 Time :  2247
accuracy train: 0.971816 val: 0.883289 test: 0.818773
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516
Counter({1: 8723, 2: 5153, 0: 4970})

Epoch :  45 loss training:  135.27393548190594 Time :  2306
accuracy train: 0.972012 val: 0.884173 test: 0.818773
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516

Epoch :  46 loss training:  132.17856499552727 Time :  2355
accuracy train: 0.972601 val: 0.892131 test: 0.819304
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516
Counter({2: 7314, 1: 6199, 0: 5333})

Epoch :  47 loss training:  131.22827091813087 Time :  2409
accuracy train: 0.972601 val: 0.892131 test: 0.818640
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516

Epoch :  48 loss training:  133.73462957143784 Time :  2460
accuracy train: 0.973976 val: 0.890363 test: 0.820632
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516
Counter({0: 7089, 2: 6904, 1: 4853})

Epoch :  49 loss training:  133.27043998986483 Time :  2517
accuracy train: 0.973976 val: 0.888594 test: 0.819570
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516

Epoch :  50 loss training:  125.76859186962247 Time :  2568
accuracy train: 0.974271 val: 0.890363 test: 0.822623
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516
Counter({2: 8011, 1: 6845, 0: 3990})

Epoch :  51 loss training:  126.71669659763575 Time :  2620
accuracy train: 0.974565 val: 0.889478 test: 0.819835
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516

Epoch :  52 loss training:  128.39600964263082 Time :  2670
accuracy train: 0.973780 val: 0.887710 test: 0.817844
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516
Counter({2: 6486, 0: 6196, 1: 6164})

Epoch :  53 loss training:  133.12843803316355 Time :  2717
accuracy train: 0.974958 val: 0.886826 test: 0.819570
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516

Epoch :  54 loss training:  131.50964642316103 Time :  2765
accuracy train: 0.974565 val: 0.887710 test: 0.816516
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516
Counter({0: 6610, 1: 6404, 2: 5832})

Epoch :  55 loss training:  129.02232109755278 Time :  2816
accuracy train: 0.975351 val: 0.890363 test: 0.820234
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516

Epoch :  56 loss training:  126.71262734383345 Time :  2863
accuracy train: 0.974173 val: 0.885942 test: 0.818508
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516
Counter({1: 6964, 0: 6532, 2: 5350})

Epoch :  57 loss training:  130.17239037901163 Time :  2914
accuracy train: 0.976137 val: 0.886826 test: 0.819703
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516

Epoch :  58 loss training:  126.4319786503911 Time :  2960
accuracy train: 0.976530 val: 0.882405 test: 0.819172
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516
Counter({2: 7608, 1: 6310, 0: 4928})

Epoch :  59 loss training:  130.77252308279276 Time :  3011
accuracy train: 0.976333 val: 0.887710 test: 0.819570
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516

Epoch :  60 loss training:  125.62275088578463 Time :  3057
accuracy train: 0.975940 val: 0.889478 test: 0.818109
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516
Counter({1: 9229, 2: 5495, 0: 4122})

Epoch :  61 loss training:  118.68546236306429 Time :  3109
accuracy train: 0.976726 val: 0.892131 test: 0.821827
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516

Epoch :  62 loss training:  125.84323805570602 Time :  3158
accuracy train: 0.976333 val: 0.884173 test: 0.820499
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516
Counter({1: 8111, 2: 6673, 0: 4062})

Epoch :  63 loss training:  118.01388655230403 Time :  3208
accuracy train: 0.976922 val: 0.886826 test: 0.820898
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516

Epoch :  64 loss training:  120.47292783111334 Time :  3256
accuracy train: 0.977904 val: 0.890363 test: 0.823287
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516
Counter({0: 6914, 1: 6059, 2: 5873})

Epoch :  65 loss training:  126.93241068720818 Time :  3309
accuracy train: 0.978690 val: 0.888594 test: 0.819437
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516

Epoch :  66 loss training:  121.84682003036141 Time :  3356
accuracy train: 0.978199 val: 0.888594 test: 0.822623
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516
Counter({1: 7482, 2: 6949, 0: 4415})

Epoch :  67 loss training:  124.94629018008709 Time :  3410
accuracy train: 0.977610 val: 0.882405 test: 0.819703
max validation accuracy : 0.892131 max acc epoch : 36 test accuracy : 0.816516

========================================================================================================================================================================================================
max acc epoch :  36
max validation accuracy :  0.8921308576480991
test accuracy :  0.8165161975570897
last test_accuracy :  0.8197026022304833
========================================================================================================================================================================================================



date and time :  Wed Apr 21 23:02:07 2021
Namespace(batch_size=32, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=True, seed=0, weight_decay=0)
device :  cuda:0
Counter({2: 7634, 1: 6227, 0: 4985})

Epoch :  1 loss training:  1156.0658935308456 Time :  43
accuracy train: 0.730728 val: 0.668435 test: 0.607541
max validation accuracy : 0.668435 max acc epoch : 1 test accuracy : 0.607541
Epoch-1 lr: 0.001

Epoch :  2 loss training:  600.0031878352165 Time :  87
accuracy train: 0.850437 val: 0.778957 test: 0.699814
max validation accuracy : 0.778957 max acc epoch : 2 test accuracy : 0.699814
Counter({2: 8405, 0: 5758, 1: 4683})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  433.18958884477615 Time :  139
accuracy train: 0.916037 val: 0.820513 test: 0.731678
max validation accuracy : 0.820513 max acc epoch : 3 test accuracy : 0.731678
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  266.55487325787544 Time :  182
accuracy train: 0.945596 val: 0.834660 test: 0.761551
max validation accuracy : 0.834660 max acc epoch : 4 test accuracy : 0.761551
Counter({2: 7047, 0: 6509, 1: 5290})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  228.90620177984238 Time :  229
accuracy train: 0.963567 val: 0.851459 test: 0.771774
max validation accuracy : 0.851459 max acc epoch : 5 test accuracy : 0.771774
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  175.70193184912205 Time :  274
accuracy train: 0.977708 val: 0.856764 test: 0.777748
max validation accuracy : 0.856764 max acc epoch : 6 test accuracy : 0.777748
Counter({0: 7593, 1: 5751, 2: 5502})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  143.02882431447506 Time :  320
accuracy train: 0.984091 val: 0.860301 test: 0.778147
max validation accuracy : 0.860301 max acc epoch : 7 test accuracy : 0.778147
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  122.2173066958785 Time :  364
accuracy train: 0.987921 val: 0.873563 test: 0.781200
max validation accuracy : 0.873563 max acc epoch : 8 test accuracy : 0.781200
Counter({2: 8459, 0: 5882, 1: 4505})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  120.23480371385813 Time :  411
accuracy train: 0.989492 val: 0.870027 test: 0.782661
max validation accuracy : 0.873563 max acc epoch : 8 test accuracy : 0.781200
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  93.78270463272929 Time :  457
accuracy train: 0.992831 val: 0.879752 test: 0.786511
max validation accuracy : 0.879752 max acc epoch : 10 test accuracy : 0.786511
Counter({1: 9187, 0: 4915, 2: 4744})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  94.23405137658119 Time :  507
accuracy train: 0.993911 val: 0.871795 test: 0.788635
max validation accuracy : 0.879752 max acc epoch : 10 test accuracy : 0.786511
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  82.68092908523977 Time :  554
accuracy train: 0.994697 val: 0.875332 test: 0.788370
max validation accuracy : 0.879752 max acc epoch : 10 test accuracy : 0.786511
Counter({0: 8060, 1: 6582, 2: 4204})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  78.49784329906106 Time :  602
accuracy train: 0.995777 val: 0.880637 test: 0.790494
max validation accuracy : 0.880637 max acc epoch : 13 test accuracy : 0.790494
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  75.18093842454255 Time :  650
accuracy train: 0.995581 val: 0.877100 test: 0.788370
max validation accuracy : 0.880637 max acc epoch : 13 test accuracy : 0.790494
Counter({0: 7261, 2: 6527, 1: 5058})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  74.98895686957985 Time :  700
accuracy train: 0.995777 val: 0.877100 test: 0.789830
max validation accuracy : 0.880637 max acc epoch : 13 test accuracy : 0.790494
Epoch-15 lr: 3.125e-05

Epoch :  16 loss training:  69.31294273585081 Time :  746
accuracy train: 0.996366 val: 0.877100 test: 0.791158
max validation accuracy : 0.880637 max acc epoch : 13 test accuracy : 0.790494
Counter({0: 9175, 2: 6246, 1: 3425})
Epoch-16 lr: 3.125e-05

Epoch :  17 loss training:  65.07656889408827 Time :  795
accuracy train: 0.996268 val: 0.880637 test: 0.791822
max validation accuracy : 0.880637 max acc epoch : 13 test accuracy : 0.790494
Epoch-17 lr: 3.125e-05

Epoch :  18 loss training:  66.49708898365498 Time :  841
accuracy train: 0.996661 val: 0.882405 test: 0.788901
max validation accuracy : 0.882405 max acc epoch : 18 test accuracy : 0.788901
Counter({1: 10892, 2: 4513, 0: 3441})
Epoch-18 lr: 1.5625e-05

Epoch :  19 loss training:  63.684066601097584 Time :  889
accuracy train: 0.996956 val: 0.883289 test: 0.789033
max validation accuracy : 0.883289 max acc epoch : 19 test accuracy : 0.789033
Epoch-19 lr: 1.5625e-05

Epoch :  20 loss training:  63.104510294273496 Time :  934
accuracy train: 0.996465 val: 0.879752 test: 0.790096
max validation accuracy : 0.883289 max acc epoch : 19 test accuracy : 0.789033
Counter({2: 9919, 1: 5483, 0: 3444})

Epoch :  21 loss training:  64.49803323484957 Time :  983
accuracy train: 0.996759 val: 0.881521 test: 0.790627
max validation accuracy : 0.883289 max acc epoch : 19 test accuracy : 0.789033

Epoch :  22 loss training:  64.81155791506171 Time :  1027
accuracy train: 0.996366 val: 0.877100 test: 0.788370
max validation accuracy : 0.883289 max acc epoch : 19 test accuracy : 0.789033
Counter({1: 9226, 0: 5849, 2: 3771})

Epoch :  23 loss training:  66.45297509804368 Time :  1074
accuracy train: 0.996268 val: 0.874447 test: 0.791290
max validation accuracy : 0.883289 max acc epoch : 19 test accuracy : 0.789033

Epoch :  24 loss training:  64.48590702936053 Time :  1119
accuracy train: 0.995679 val: 0.874447 test: 0.789565
max validation accuracy : 0.883289 max acc epoch : 19 test accuracy : 0.789033
Counter({1: 9867, 0: 4828, 2: 4151})

Epoch :  25 loss training:  69.75558620132506 Time :  1167
accuracy train: 0.996465 val: 0.878868 test: 0.792087
max validation accuracy : 0.883289 max acc epoch : 19 test accuracy : 0.789033

Epoch :  26 loss training:  58.614719182252884 Time :  1212
accuracy train: 0.997152 val: 0.876216 test: 0.790759
max validation accuracy : 0.883289 max acc epoch : 19 test accuracy : 0.789033
Counter({1: 9175, 2: 5339, 0: 4332})

Epoch :  27 loss training:  59.43488532677293 Time :  1259
accuracy train: 0.996956 val: 0.877984 test: 0.790228
max validation accuracy : 0.883289 max acc epoch : 19 test accuracy : 0.789033

Epoch :  28 loss training:  57.30412734858692 Time :  1302
accuracy train: 0.997643 val: 0.877984 test: 0.788901
max validation accuracy : 0.883289 max acc epoch : 19 test accuracy : 0.789033
Counter({1: 8927, 2: 6661, 0: 3258})

Epoch :  29 loss training:  54.66802127659321 Time :  1349
accuracy train: 0.997152 val: 0.880637 test: 0.790096
max validation accuracy : 0.883289 max acc epoch : 19 test accuracy : 0.789033

Epoch :  30 loss training:  51.333537481725216 Time :  1393
accuracy train: 0.997643 val: 0.880637 test: 0.790494
max validation accuracy : 0.883289 max acc epoch : 19 test accuracy : 0.789033
Counter({0: 8050, 2: 7899, 1: 2897})

Epoch :  31 loss training:  53.576960898935795 Time :  1440
accuracy train: 0.997447 val: 0.880637 test: 0.790361
max validation accuracy : 0.883289 max acc epoch : 19 test accuracy : 0.789033

Epoch :  32 loss training:  53.07785864453763 Time :  1483
accuracy train: 0.997840 val: 0.878868 test: 0.792751
max validation accuracy : 0.883289 max acc epoch : 19 test accuracy : 0.789033
Counter({0: 7517, 2: 7241, 1: 4088})

Epoch :  33 loss training:  55.79825524613261 Time :  1532
accuracy train: 0.997545 val: 0.885942 test: 0.792485
max validation accuracy : 0.885942 max acc epoch : 33 test accuracy : 0.792485

Epoch :  34 loss training:  50.6073906077072 Time :  1576
accuracy train: 0.997349 val: 0.882405 test: 0.792353
max validation accuracy : 0.885942 max acc epoch : 33 test accuracy : 0.792485
Counter({0: 6700, 2: 6654, 1: 5492})

Epoch :  35 loss training:  61.71117218956351 Time :  1622
accuracy train: 0.997840 val: 0.879752 test: 0.791822
max validation accuracy : 0.885942 max acc epoch : 33 test accuracy : 0.792485

Epoch :  36 loss training:  55.29480717331171 Time :  1666
accuracy train: 0.997545 val: 0.877984 test: 0.793548
max validation accuracy : 0.885942 max acc epoch : 33 test accuracy : 0.792485
Counter({2: 9284, 1: 5181, 0: 4381})

Epoch :  37 loss training:  53.813091955147684 Time :  1713
accuracy train: 0.997643 val: 0.882405 test: 0.791025
max validation accuracy : 0.885942 max acc epoch : 33 test accuracy : 0.792485

Epoch :  38 loss training:  52.43512031715363 Time :  1755
accuracy train: 0.997741 val: 0.880637 test: 0.790627
max validation accuracy : 0.885942 max acc epoch : 33 test accuracy : 0.792485
Counter({2: 10251, 1: 5348, 0: 3247})

Epoch :  39 loss training:  51.38582521863282 Time :  1802
accuracy train: 0.997545 val: 0.882405 test: 0.789963
max validation accuracy : 0.885942 max acc epoch : 33 test accuracy : 0.792485

Epoch :  40 loss training:  51.616701806895435 Time :  1845
accuracy train: 0.998036 val: 0.879752 test: 0.793813
max validation accuracy : 0.885942 max acc epoch : 33 test accuracy : 0.792485
Counter({1: 10435, 2: 5307, 0: 3104})

Epoch :  41 loss training:  50.34375334484503 Time :  1893
accuracy train: 0.997741 val: 0.884173 test: 0.790759
max validation accuracy : 0.885942 max acc epoch : 33 test accuracy : 0.792485

Epoch :  42 loss training:  46.27806275617331 Time :  1937
accuracy train: 0.998036 val: 0.877984 test: 0.791954
max validation accuracy : 0.885942 max acc epoch : 33 test accuracy : 0.792485
Counter({1: 7515, 0: 7055, 2: 4276})

Epoch :  43 loss training:  53.60873909667134 Time :  1988
accuracy train: 0.997741 val: 0.880637 test: 0.794875
max validation accuracy : 0.885942 max acc epoch : 33 test accuracy : 0.792485

Epoch :  44 loss training:  49.049436153844 Time :  2031
accuracy train: 0.998036 val: 0.879752 test: 0.794079
max validation accuracy : 0.885942 max acc epoch : 33 test accuracy : 0.792485
Counter({1: 7129, 2: 6524, 0: 5193})

Epoch :  45 loss training:  51.20084635261446 Time :  2077
accuracy train: 0.998134 val: 0.882405 test: 0.794211
max validation accuracy : 0.885942 max acc epoch : 33 test accuracy : 0.792485

Epoch :  46 loss training:  53.86446999013424 Time :  2121
accuracy train: 0.998429 val: 0.881521 test: 0.792353
max validation accuracy : 0.885942 max acc epoch : 33 test accuracy : 0.792485
Counter({1: 7559, 2: 6954, 0: 4333})

Epoch :  47 loss training:  49.6017355825752 Time :  2168
accuracy train: 0.998232 val: 0.885057 test: 0.790627
max validation accuracy : 0.885942 max acc epoch : 33 test accuracy : 0.792485

Epoch :  48 loss training:  47.964852310717106 Time :  2211
accuracy train: 0.998723 val: 0.879752 test: 0.794477
max validation accuracy : 0.885942 max acc epoch : 33 test accuracy : 0.792485
Counter({1: 7740, 0: 7024, 2: 4082})

Epoch :  49 loss training:  47.94926387723535 Time :  2259
accuracy train: 0.998527 val: 0.884173 test: 0.791025
max validation accuracy : 0.885942 max acc epoch : 33 test accuracy : 0.792485

Epoch :  50 loss training:  48.316656990908086 Time :  2303
accuracy train: 0.998331 val: 0.880637 test: 0.792353
max validation accuracy : 0.885942 max acc epoch : 33 test accuracy : 0.792485
Counter({2: 6793, 1: 6344, 0: 5709})

Epoch :  51 loss training:  47.21984976902604 Time :  2352
accuracy train: 0.998429 val: 0.880637 test: 0.794742
max validation accuracy : 0.885942 max acc epoch : 33 test accuracy : 0.792485

Epoch :  52 loss training:  46.43563799466938 Time :  2394
accuracy train: 0.998625 val: 0.886826 test: 0.793548
max validation accuracy : 0.886826 max acc epoch : 52 test accuracy : 0.793548
slurmstepd: error: *** JOB 32082 ON cl-gpusrv1 CANCELLED AT 2021-04-21T23:42:59 ***
