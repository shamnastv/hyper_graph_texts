

date and time :  Mon Jun 14 21:40:46 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=375, tsne=False, weight_decay=0)
device :  cuda:0
Counter({1: 4547, 0: 2853})

Epoch :  1 loss training:  210.55496442317963 Time :  83
accuracy train: 0.653210 val: 0.641791 test: 0.617363
max validation accuracy : 0.641791 max acc epoch : 1 test accuracy : 0.617363
Counter({0: 4408, 1: 2992})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  144.73442482948303 Time :  137
accuracy train: 0.722038 val: 0.701493 test: 0.652733
max validation accuracy : 0.701493 max acc epoch : 2 test accuracy : 0.652733
Counter({0: 4458, 1: 2942})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.23026484251022 Time :  182
accuracy train: 0.750165 val: 0.668657 test: 0.664358
max validation accuracy : 0.701493 max acc epoch : 2 test accuracy : 0.652733
Counter({1: 4491, 0: 2909})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  101.88850131630898 Time :  226
accuracy train: 0.786565 val: 0.701493 test: 0.688598
max validation accuracy : 0.701493 max acc epoch : 2 test accuracy : 0.652733
Counter({0: 4415, 1: 2985})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  89.92288741469383 Time :  274
accuracy train: 0.815023 val: 0.698507 test: 0.695028
max validation accuracy : 0.701493 max acc epoch : 2 test accuracy : 0.652733
Counter({0: 4359, 1: 3041})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  86.53896936774254 Time :  337
accuracy train: 0.841827 val: 0.716418 test: 0.701459
max validation accuracy : 0.716418 max acc epoch : 6 test accuracy : 0.701459
Counter({1: 4694, 0: 2706})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  75.03912623226643 Time :  387
accuracy train: 0.847452 val: 0.740299 test: 0.702943
max validation accuracy : 0.740299 max acc epoch : 7 test accuracy : 0.702943
Counter({0: 4329, 1: 3071})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  69.49052122235298 Time :  416
accuracy train: 0.859696 val: 0.710448 test: 0.706901
max validation accuracy : 0.740299 max acc epoch : 7 test accuracy : 0.702943
Counter({1: 4717, 0: 2683})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  67.72120970487595 Time :  440
accuracy train: 0.872270 val: 0.737313 test: 0.708138
max validation accuracy : 0.740299 max acc epoch : 7 test accuracy : 0.702943
Counter({1: 4316, 0: 3084})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.64151680469513 Time :  465
accuracy train: 0.887492 val: 0.722388 test: 0.716794
max validation accuracy : 0.740299 max acc epoch : 7 test accuracy : 0.702943
Counter({0: 4286, 1: 3114})

Epoch :  11 loss training:  58.4672375023365 Time :  491
accuracy train: 0.892124 val: 0.746269 test: 0.712837
max validation accuracy : 0.746269 max acc epoch : 11 test accuracy : 0.712837
Counter({0: 4256, 1: 3144})

Epoch :  12 loss training:  55.32710999250412 Time :  517
accuracy train: 0.905361 val: 0.737313 test: 0.716547
max validation accuracy : 0.746269 max acc epoch : 11 test accuracy : 0.712837
Counter({1: 4273, 0: 3127})

Epoch :  13 loss training:  53.30404055118561 Time :  543
accuracy train: 0.909332 val: 0.749254 test: 0.719268
max validation accuracy : 0.749254 max acc epoch : 13 test accuracy : 0.719268
Counter({0: 4671, 1: 2729})

Epoch :  14 loss training:  50.77704907953739 Time :  566
accuracy train: 0.916281 val: 0.737313 test: 0.718526
max validation accuracy : 0.749254 max acc epoch : 13 test accuracy : 0.719268
Counter({1: 4242, 0: 3158})

Epoch :  15 loss training:  48.66642275452614 Time :  593
accuracy train: 0.924553 val: 0.737313 test: 0.717289
max validation accuracy : 0.749254 max acc epoch : 13 test accuracy : 0.719268
Counter({0: 4234, 1: 3166})

Epoch :  16 loss training:  44.691919304430485 Time :  621
accuracy train: 0.939113 val: 0.728358 test: 0.716300
max validation accuracy : 0.749254 max acc epoch : 13 test accuracy : 0.719268
Counter({1: 4221, 0: 3179})

Epoch :  17 loss training:  42.61682826280594 Time :  644
accuracy train: 0.938120 val: 0.737313 test: 0.721989
max validation accuracy : 0.749254 max acc epoch : 13 test accuracy : 0.719268
Counter({1: 4240, 0: 3160})

Epoch :  18 loss training:  39.39406610280275 Time :  670
accuracy train: 0.954335 val: 0.740299 test: 0.717042
max validation accuracy : 0.749254 max acc epoch : 13 test accuracy : 0.719268
Counter({0: 4224, 1: 3176})

Epoch :  19 loss training:  37.636843144893646 Time :  727
accuracy train: 0.950695 val: 0.746269 test: 0.718773
max validation accuracy : 0.749254 max acc epoch : 13 test accuracy : 0.719268
Counter({0: 4207, 1: 3193})

Epoch :  20 loss training:  36.43927991390228 Time :  784
accuracy train: 0.964593 val: 0.749254 test: 0.721247
max validation accuracy : 0.749254 max acc epoch : 13 test accuracy : 0.719268
Counter({1: 4193, 0: 3207})

Epoch :  21 loss training:  33.58627437800169 Time :  831
accuracy train: 0.965255 val: 0.755224 test: 0.712590
max validation accuracy : 0.755224 max acc epoch : 21 test accuracy : 0.712590
Counter({1: 4189, 0: 3211})

Epoch :  22 loss training:  31.54715121537447 Time :  887
accuracy train: 0.974189 val: 0.749254 test: 0.720752
max validation accuracy : 0.755224 max acc epoch : 21 test accuracy : 0.712590
Counter({1: 4201, 0: 3199})

Epoch :  23 loss training:  28.61760861054063 Time :  943
accuracy train: 0.974189 val: 0.755224 test: 0.714321
max validation accuracy : 0.755224 max acc epoch : 21 test accuracy : 0.712590
Counter({0: 4735, 1: 2665})

Epoch :  24 loss training:  26.893751986324787 Time :  998
accuracy train: 0.980807 val: 0.752239 test: 0.719021
max validation accuracy : 0.755224 max acc epoch : 21 test accuracy : 0.712590
Counter({1: 4208, 0: 3192})

Epoch :  25 loss training:  25.07595232874155 Time :  1055
accuracy train: 0.972204 val: 0.746269 test: 0.717784
max validation accuracy : 0.755224 max acc epoch : 21 test accuracy : 0.712590
Counter({1: 4213, 0: 3187})

Epoch :  26 loss training:  24.361744675785303 Time :  1099
accuracy train: 0.984447 val: 0.749254 test: 0.719763
max validation accuracy : 0.755224 max acc epoch : 21 test accuracy : 0.712590
Counter({1: 4199, 0: 3201})

Epoch :  27 loss training:  20.796063730493188 Time :  1123
accuracy train: 0.987756 val: 0.758209 test: 0.720752
max validation accuracy : 0.758209 max acc epoch : 27 test accuracy : 0.720752
Counter({0: 4233, 1: 3167})

Epoch :  28 loss training:  19.788193698972464 Time :  1146
accuracy train: 0.991396 val: 0.764179 test: 0.724462
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({1: 4189, 0: 3211})

Epoch :  29 loss training:  19.238710027188063 Time :  1184
accuracy train: 0.989742 val: 0.752239 test: 0.724462
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({1: 4205, 0: 3195})

Epoch :  30 loss training:  17.580253936350346 Time :  1210
accuracy train: 0.993713 val: 0.755224 test: 0.720999
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({0: 4154, 1: 3246})

Epoch :  31 loss training:  16.305771036073565 Time :  1237
accuracy train: 0.994705 val: 0.749254 test: 0.719268
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({1: 4169, 0: 3231})

Epoch :  32 loss training:  15.191428096964955 Time :  1270
accuracy train: 0.995698 val: 0.755224 test: 0.720257
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({1: 4248, 0: 3152})

Epoch :  33 loss training:  15.138534612953663 Time :  1308
accuracy train: 0.997022 val: 0.758209 test: 0.716547
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({0: 4168, 1: 3232})

Epoch :  34 loss training:  14.348247766494751 Time :  1337
accuracy train: 0.998345 val: 0.758209 test: 0.721741
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({0: 4822, 1: 2578})

Epoch :  35 loss training:  13.713841380551457 Time :  1373
accuracy train: 0.998345 val: 0.746269 test: 0.719763
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({0: 4137, 1: 3263})

Epoch :  36 loss training:  12.146179683506489 Time :  1408
accuracy train: 0.998676 val: 0.758209 test: 0.721989
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({1: 4197, 0: 3203})

Epoch :  37 loss training:  11.93178859911859 Time :  1440
accuracy train: 0.998345 val: 0.749254 test: 0.720505
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({1: 4166, 0: 3234})

Epoch :  38 loss training:  10.167522706091404 Time :  1488
accuracy train: 0.999338 val: 0.749254 test: 0.720505
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({0: 4810, 1: 2590})

Epoch :  39 loss training:  9.654174847528338 Time :  1519
accuracy train: 1.000000 val: 0.758209 test: 0.723967
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({0: 4872, 1: 2528})

Epoch :  40 loss training:  9.428455589339137 Time :  1550
accuracy train: 0.999669 val: 0.740299 test: 0.718526
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({0: 4157, 1: 3243})

Epoch :  41 loss training:  8.534795509651303 Time :  1591
accuracy train: 1.000000 val: 0.752239 test: 0.722731
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({1: 4881, 0: 2519})

Epoch :  42 loss training:  7.933557792566717 Time :  1624
accuracy train: 0.999669 val: 0.743284 test: 0.717784
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({1: 4245, 0: 3155})

Epoch :  43 loss training:  7.9273026045411825 Time :  1656
accuracy train: 0.999669 val: 0.743284 test: 0.718526
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({0: 4164, 1: 3236})

Epoch :  44 loss training:  6.95353168528527 Time :  1693
accuracy train: 0.999669 val: 0.740299 test: 0.718031
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({1: 4180, 0: 3220})

Epoch :  45 loss training:  7.417010081466287 Time :  1728
accuracy train: 0.999669 val: 0.749254 test: 0.724215
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({1: 4214, 0: 3186})

Epoch :  46 loss training:  5.6119868704117835 Time :  1757
accuracy train: 0.999669 val: 0.749254 test: 0.722236
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({1: 4107, 0: 3293})

Epoch :  47 loss training:  5.989246664568782 Time :  1798
accuracy train: 0.999669 val: 0.749254 test: 0.718526
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({1: 4083, 0: 3317})

Epoch :  48 loss training:  6.148310491815209 Time :  1850
accuracy train: 0.999669 val: 0.743284 test: 0.722236
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({1: 4108, 0: 3292})

Epoch :  49 loss training:  5.238388368859887 Time :  1885
accuracy train: 1.000000 val: 0.740299 test: 0.728419
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({1: 4188, 0: 3212})

Epoch :  50 loss training:  4.417438833974302 Time :  1921
accuracy train: 1.000000 val: 0.740299 test: 0.720999
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({0: 4202, 1: 3198})

Epoch :  51 loss training:  4.588661515619606 Time :  1955
accuracy train: 0.999669 val: 0.758209 test: 0.720257
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({1: 4143, 0: 3257})

Epoch :  52 loss training:  4.590712097007781 Time :  2011
accuracy train: 1.000000 val: 0.755224 test: 0.723720
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({1: 4146, 0: 3254})

Epoch :  53 loss training:  5.041270801099017 Time :  2052
accuracy train: 0.999338 val: 0.737313 test: 0.720752
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({0: 4925, 1: 2475})

Epoch :  54 loss training:  3.9202157384715974 Time :  2095
accuracy train: 1.000000 val: 0.746269 test: 0.719515
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({1: 4177, 0: 3223})

Epoch :  55 loss training:  3.7421465101651847 Time :  2143
accuracy train: 1.000000 val: 0.743284 test: 0.725946
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({0: 4170, 1: 3230})

Epoch :  56 loss training:  3.447987566469237 Time :  2179
accuracy train: 1.000000 val: 0.755224 test: 0.720505
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({1: 4185, 0: 3215})

Epoch :  57 loss training:  3.324952330440283 Time :  2217
accuracy train: 1.000000 val: 0.743284 test: 0.721989
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({0: 4160, 1: 3240})

Epoch :  58 loss training:  3.7538159042596817 Time :  2254
accuracy train: 1.000000 val: 0.755224 test: 0.718526
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({1: 4147, 0: 3253})

Epoch :  59 loss training:  3.5650702747516334 Time :  2294
accuracy train: 1.000000 val: 0.740299 test: 0.719515
max validation accuracy : 0.764179 max acc epoch : 28 test accuracy : 0.724462
Counter({1: 4122, 0: 3278})

========================================================================================================================================================================================================
best acc epoch :  28
validation accuracy :  0.764179104477612
test accuracy :  0.7244620331437052
last test_accuracy :  0.7195152114766262
second best val :  0.7582089552238805
second best test :  0.720751916893396
max gap 8
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=93, tsne=False, weight_decay=0)
device :  cuda:0
Counter({0: 4561, 1: 2839})

Epoch :  1 loss training:  208.75562703609467 Time :  2373
accuracy train: 0.641297 val: 0.600000 test: 0.609943
max validation accuracy : 0.600000 max acc epoch : 1 test accuracy : 0.609943
Counter({1: 4753, 0: 2647})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  146.48809397220612 Time :  2434
accuracy train: 0.688286 val: 0.588060 test: 0.635172
max validation accuracy : 0.600000 max acc epoch : 1 test accuracy : 0.609943
Counter({1: 4221, 0: 3179})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  125.48217499256134 Time :  2484
accuracy train: 0.750827 val: 0.674627 test: 0.673757
max validation accuracy : 0.674627 max acc epoch : 3 test accuracy : 0.673757
Counter({0: 5130, 1: 2270})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  100.00451603531837 Time :  2539
accuracy train: 0.794507 val: 0.683582 test: 0.691813
max validation accuracy : 0.683582 max acc epoch : 4 test accuracy : 0.691813
Counter({1: 4442, 0: 2958})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  89.84148353338242 Time :  2577
accuracy train: 0.811052 val: 0.680597 test: 0.695523
max validation accuracy : 0.683582 max acc epoch : 4 test accuracy : 0.691813
Counter({1: 4414, 0: 2986})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.11494234204292 Time :  2609
accuracy train: 0.836863 val: 0.692537 test: 0.703191
max validation accuracy : 0.692537 max acc epoch : 6 test accuracy : 0.703191
Counter({1: 4450, 0: 2950})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  73.72212901711464 Time :  2663
accuracy train: 0.855725 val: 0.704478 test: 0.718279
max validation accuracy : 0.704478 max acc epoch : 7 test accuracy : 0.718279
Counter({1: 4462, 0: 2938})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  69.25336834788322 Time :  2700
accuracy train: 0.871608 val: 0.698507 test: 0.711353
max validation accuracy : 0.704478 max acc epoch : 7 test accuracy : 0.718279
Counter({1: 4429, 0: 2971})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.9603224247694 Time :  2757
accuracy train: 0.872270 val: 0.698507 test: 0.717784
max validation accuracy : 0.704478 max acc epoch : 7 test accuracy : 0.718279
Counter({1: 4493, 0: 2907})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.48518081009388 Time :  2838
accuracy train: 0.892455 val: 0.734328 test: 0.721741
max validation accuracy : 0.734328 max acc epoch : 10 test accuracy : 0.721741
Counter({0: 4471, 1: 2929})

Epoch :  11 loss training:  59.08167389035225 Time :  2891
accuracy train: 0.899404 val: 0.719403 test: 0.724709
max validation accuracy : 0.734328 max acc epoch : 10 test accuracy : 0.721741
Counter({0: 4447, 1: 2953})

Epoch :  12 loss training:  56.90698792040348 Time :  2940
accuracy train: 0.904699 val: 0.725373 test: 0.724215
max validation accuracy : 0.734328 max acc epoch : 10 test accuracy : 0.721741
Counter({0: 4506, 1: 2894})

Epoch :  13 loss training:  54.251672476530075 Time :  2984
accuracy train: 0.906684 val: 0.722388 test: 0.720505
max validation accuracy : 0.734328 max acc epoch : 10 test accuracy : 0.721741
Counter({1: 4497, 0: 2903})

Epoch :  14 loss training:  51.27854543924332 Time :  3025
accuracy train: 0.924884 val: 0.734328 test: 0.725451
max validation accuracy : 0.734328 max acc epoch : 10 test accuracy : 0.721741
Counter({0: 4512, 1: 2888})

Epoch :  15 loss training:  48.934276252985 Time :  3063
accuracy train: 0.923561 val: 0.734328 test: 0.721247
max validation accuracy : 0.734328 max acc epoch : 10 test accuracy : 0.721741
Counter({1: 4488, 0: 2912})

Epoch :  16 loss training:  45.79258166253567 Time :  3104
accuracy train: 0.936466 val: 0.734328 test: 0.719515
max validation accuracy : 0.734328 max acc epoch : 10 test accuracy : 0.721741
Counter({1: 4504, 0: 2896})

Epoch :  17 loss training:  42.104238621890545 Time :  3163
accuracy train: 0.941430 val: 0.737313 test: 0.727925
max validation accuracy : 0.737313 max acc epoch : 17 test accuracy : 0.727925
Counter({0: 4530, 1: 2870})

Epoch :  18 loss training:  41.257452957332134 Time :  3205
accuracy train: 0.953011 val: 0.752239 test: 0.724709
max validation accuracy : 0.752239 max acc epoch : 18 test accuracy : 0.724709
Counter({0: 4540, 1: 2860})

Epoch :  19 loss training:  38.84923443198204 Time :  3253
accuracy train: 0.959298 val: 0.761194 test: 0.727183
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({1: 4541, 0: 2859})

Epoch :  20 loss training:  35.80172187834978 Time :  3302
accuracy train: 0.964262 val: 0.731343 test: 0.723225
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({0: 4542, 1: 2858})

Epoch :  21 loss training:  33.87286574393511 Time :  3353
accuracy train: 0.967240 val: 0.737313 test: 0.720752
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({0: 4529, 1: 2871})

Epoch :  22 loss training:  31.101497881114483 Time :  3397
accuracy train: 0.970880 val: 0.746269 test: 0.721741
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({1: 4504, 0: 2896})

Epoch :  23 loss training:  29.063977643847466 Time :  3441
accuracy train: 0.975844 val: 0.743284 test: 0.719021
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({1: 4520, 0: 2880})

Epoch :  24 loss training:  27.88350097090006 Time :  3504
accuracy train: 0.981138 val: 0.746269 test: 0.725451
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({1: 4525, 0: 2875})

Epoch :  25 loss training:  24.91737625002861 Time :  3554
accuracy train: 0.981800 val: 0.752239 test: 0.721989
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({1: 4482, 0: 2918})

Epoch :  26 loss training:  25.17362131550908 Time :  3606
accuracy train: 0.983786 val: 0.725373 test: 0.722483
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({0: 4515, 1: 2885})

Epoch :  27 loss training:  22.228566948324442 Time :  3651
accuracy train: 0.982793 val: 0.734328 test: 0.728914
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({0: 4507, 1: 2893})

Epoch :  28 loss training:  21.400088150054216 Time :  3689
accuracy train: 0.987426 val: 0.737313 test: 0.727430
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({0: 4524, 1: 2876})

Epoch :  29 loss training:  20.036853428930044 Time :  3728
accuracy train: 0.994375 val: 0.734328 test: 0.720257
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({1: 4501, 0: 2899})

Epoch :  30 loss training:  17.8798387683928 Time :  3765
accuracy train: 0.990073 val: 0.728358 test: 0.724709
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({0: 4469, 1: 2931})

Epoch :  31 loss training:  18.427017003297806 Time :  3806
accuracy train: 0.992058 val: 0.737313 test: 0.724709
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({1: 4447, 0: 2953})

Epoch :  32 loss training:  17.18075285665691 Time :  3850
accuracy train: 0.995698 val: 0.743284 test: 0.723473
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({1: 4506, 0: 2894})

Epoch :  33 loss training:  15.669941395521164 Time :  3888
accuracy train: 0.996360 val: 0.740299 test: 0.718773
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({1: 4552, 0: 2848})

Epoch :  34 loss training:  14.86736062169075 Time :  3925
accuracy train: 0.996691 val: 0.731343 test: 0.718526
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({1: 4516, 0: 2884})

Epoch :  35 loss training:  12.280420172959566 Time :  3959
accuracy train: 0.998015 val: 0.737313 test: 0.719763
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({1: 4541, 0: 2859})

Epoch :  36 loss training:  12.097228152677417 Time :  3990
accuracy train: 0.998015 val: 0.713433 test: 0.723225
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({0: 4488, 1: 2912})

Epoch :  37 loss training:  11.22580720577389 Time :  4023
accuracy train: 0.999338 val: 0.737313 test: 0.725204
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({1: 4543, 0: 2857})

Epoch :  38 loss training:  11.12141614034772 Time :  4055
accuracy train: 0.998676 val: 0.719403 test: 0.725946
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({0: 4508, 1: 2892})

Epoch :  39 loss training:  9.614147594198585 Time :  4103
accuracy train: 0.999338 val: 0.728358 test: 0.716052
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({0: 4438, 1: 2962})

Epoch :  40 loss training:  9.709333745762706 Time :  4152
accuracy train: 0.999007 val: 0.719403 test: 0.726935
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({1: 4405, 0: 2995})

Epoch :  41 loss training:  9.20036126114428 Time :  4196
accuracy train: 0.999669 val: 0.722388 test: 0.725946
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({0: 4479, 1: 2921})

Epoch :  42 loss training:  8.171332388184965 Time :  4229
accuracy train: 0.999669 val: 0.719403 test: 0.721494
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({1: 4405, 0: 2995})

Epoch :  43 loss training:  8.0588771244511 Time :  4278
accuracy train: 1.000000 val: 0.719403 test: 0.724957
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({1: 4415, 0: 2985})

Epoch :  44 loss training:  7.4534346223808825 Time :  4313
accuracy train: 1.000000 val: 0.725373 test: 0.718031
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({0: 4486, 1: 2914})

Epoch :  45 loss training:  6.963520267978311 Time :  4351
accuracy train: 1.000000 val: 0.713433 test: 0.723720
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({0: 4382, 1: 3018})

Epoch :  46 loss training:  5.80476338416338 Time :  4393
accuracy train: 1.000000 val: 0.731343 test: 0.720999
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({1: 4468, 0: 2932})

Epoch :  47 loss training:  5.956941771320999 Time :  4433
accuracy train: 1.000000 val: 0.731343 test: 0.724462
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({0: 4483, 1: 2917})

Epoch :  48 loss training:  5.763925323728472 Time :  4466
accuracy train: 1.000000 val: 0.725373 test: 0.727183
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({1: 4417, 0: 2983})

Epoch :  49 loss training:  5.662399096414447 Time :  4508
accuracy train: 1.000000 val: 0.725373 test: 0.725699
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({0: 4492, 1: 2908})

Epoch :  50 loss training:  4.726867253426462 Time :  4543
accuracy train: 1.000000 val: 0.731343 test: 0.720752
max validation accuracy : 0.761194 max acc epoch : 19 test accuracy : 0.727183
Counter({1: 4465, 0: 2935})

========================================================================================================================================================================================================
best acc epoch :  19
validation accuracy :  0.7611940298507462
test accuracy :  0.7271827850605985
last test_accuracy :  0.720751916893396
second best val :  0.7522388059701492
second best test :  0.7247093742270592
max gap 7
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=237, tsne=False, weight_decay=0)
device :  cuda:0
Counter({1: 4547, 0: 2853})

Epoch :  1 loss training:  212.6791751384735 Time :  4603
accuracy train: 0.643944 val: 0.570149 test: 0.598565
max validation accuracy : 0.570149 max acc epoch : 1 test accuracy : 0.598565
Counter({1: 4806, 0: 2594})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  140.52238929271698 Time :  4646
accuracy train: 0.719391 val: 0.632836 test: 0.645808
max validation accuracy : 0.632836 max acc epoch : 2 test accuracy : 0.645808
Counter({1: 4805, 0: 2595})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  120.5478281378746 Time :  4676
accuracy train: 0.767373 val: 0.641791 test: 0.668068
max validation accuracy : 0.641791 max acc epoch : 3 test accuracy : 0.668068
Counter({0: 4709, 1: 2691})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  94.52360346913338 Time :  4717
accuracy train: 0.784911 val: 0.662687 test: 0.687114
max validation accuracy : 0.662687 max acc epoch : 4 test accuracy : 0.687114
Counter({1: 4678, 0: 2722})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  87.73177906870842 Time :  4753
accuracy train: 0.818001 val: 0.665672 test: 0.690082
max validation accuracy : 0.665672 max acc epoch : 5 test accuracy : 0.690082
Counter({0: 4632, 1: 2768})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  85.03338488936424 Time :  4794
accuracy train: 0.845797 val: 0.680597 test: 0.695276
max validation accuracy : 0.680597 max acc epoch : 6 test accuracy : 0.695276
Counter({0: 4628, 1: 2772})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  70.82377536594868 Time :  4827
accuracy train: 0.856717 val: 0.701493 test: 0.705664
max validation accuracy : 0.701493 max acc epoch : 7 test accuracy : 0.705664
Counter({0: 4615, 1: 2785})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.54967091977596 Time :  4868
accuracy train: 0.873594 val: 0.698507 test: 0.712342
max validation accuracy : 0.701493 max acc epoch : 7 test accuracy : 0.705664
Counter({1: 4615, 0: 2785})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.50233007222414 Time :  4898
accuracy train: 0.879881 val: 0.713433 test: 0.709127
max validation accuracy : 0.713433 max acc epoch : 9 test accuracy : 0.709127
Counter({1: 4615, 0: 2785})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.50724236667156 Time :  4939
accuracy train: 0.888154 val: 0.716418 test: 0.718031
max validation accuracy : 0.716418 max acc epoch : 10 test accuracy : 0.718031
Counter({1: 4610, 0: 2790})

Epoch :  11 loss training:  56.604542657732964 Time :  4971
accuracy train: 0.899404 val: 0.701493 test: 0.719021
max validation accuracy : 0.716418 max acc epoch : 10 test accuracy : 0.718031
Counter({1: 4609, 0: 2791})

Epoch :  12 loss training:  53.11805059015751 Time :  5010
accuracy train: 0.911317 val: 0.716418 test: 0.717784
max validation accuracy : 0.716418 max acc epoch : 10 test accuracy : 0.718031
Counter({1: 4615, 0: 2785})

Epoch :  13 loss training:  51.10653127729893 Time :  5050
accuracy train: 0.913302 val: 0.710448 test: 0.713579
max validation accuracy : 0.716418 max acc epoch : 10 test accuracy : 0.718031
Counter({0: 4585, 1: 2815})

Epoch :  14 loss training:  47.97110778093338 Time :  5082
accuracy train: 0.919259 val: 0.722388 test: 0.715063
max validation accuracy : 0.722388 max acc epoch : 14 test accuracy : 0.715063
Counter({1: 4593, 0: 2807})

Epoch :  15 loss training:  46.522835701704025 Time :  5119
accuracy train: 0.926208 val: 0.725373 test: 0.720010
max validation accuracy : 0.725373 max acc epoch : 15 test accuracy : 0.720010
Counter({1: 4586, 0: 2814})

Epoch :  16 loss training:  43.90192097425461 Time :  5152
accuracy train: 0.941099 val: 0.725373 test: 0.716794
max validation accuracy : 0.725373 max acc epoch : 15 test accuracy : 0.720010
Counter({1: 4600, 0: 2800})

Epoch :  17 loss training:  41.17677913606167 Time :  5191
accuracy train: 0.948048 val: 0.731343 test: 0.720010
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({1: 4591, 0: 2809})

Epoch :  18 loss training:  37.450664676725864 Time :  5222
accuracy train: 0.954997 val: 0.704478 test: 0.710858
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({0: 4590, 1: 2810})

Epoch :  19 loss training:  36.12329734116793 Time :  5250
accuracy train: 0.962277 val: 0.716418 test: 0.715310
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({1: 4598, 0: 2802})

Epoch :  20 loss training:  33.0758287794888 Time :  5282
accuracy train: 0.968895 val: 0.725373 test: 0.714568
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({1: 4574, 0: 2826})

Epoch :  21 loss training:  32.61876332014799 Time :  5319
accuracy train: 0.973527 val: 0.719403 test: 0.720752
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({0: 4597, 1: 2803})

Epoch :  22 loss training:  28.879410080611706 Time :  5358
accuracy train: 0.979484 val: 0.713433 test: 0.718279
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({1: 4625, 0: 2775})

Epoch :  23 loss training:  28.382668681442738 Time :  5391
accuracy train: 0.977829 val: 0.698507 test: 0.716300
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({0: 4596, 1: 2804})

Epoch :  24 loss training:  25.7914402410388 Time :  5429
accuracy train: 0.973197 val: 0.725373 test: 0.717536
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({1: 4581, 0: 2819})

Epoch :  25 loss training:  25.156492471694946 Time :  5465
accuracy train: 0.984447 val: 0.719403 test: 0.719515
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({0: 4574, 1: 2826})

Epoch :  26 loss training:  20.862934052944183 Time :  5505
accuracy train: 0.989080 val: 0.707463 test: 0.720752
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({1: 4598, 0: 2802})

Epoch :  27 loss training:  21.190746195614338 Time :  5538
accuracy train: 0.987756 val: 0.716418 test: 0.715805
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({0: 4557, 1: 2843})

Epoch :  28 loss training:  20.23981460928917 Time :  5575
accuracy train: 0.989742 val: 0.707463 test: 0.722978
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({1: 4584, 0: 2816})

Epoch :  29 loss training:  18.080210026353598 Time :  5608
accuracy train: 0.992720 val: 0.704478 test: 0.724215
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({0: 4602, 1: 2798})

Epoch :  30 loss training:  16.721505200490355 Time :  5645
accuracy train: 0.994705 val: 0.713433 test: 0.716547
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({0: 4637, 1: 2763})

Epoch :  31 loss training:  16.339518003165722 Time :  5689
accuracy train: 0.996360 val: 0.710448 test: 0.722483
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({1: 4617, 0: 2783})

Epoch :  32 loss training:  15.730859912931919 Time :  5727
accuracy train: 0.996029 val: 0.707463 test: 0.718526
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({1: 4650, 0: 2750})

Epoch :  33 loss training:  13.916965151205659 Time :  5763
accuracy train: 0.998345 val: 0.710448 test: 0.725946
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({1: 4570, 0: 2830})

Epoch :  34 loss training:  11.90003801509738 Time :  5803
accuracy train: 0.997684 val: 0.710448 test: 0.720257
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({0: 4588, 1: 2812})

Epoch :  35 loss training:  11.361670894548297 Time :  5843
accuracy train: 0.998015 val: 0.698507 test: 0.720257
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({1: 4579, 0: 2821})

Epoch :  36 loss training:  11.206771306693554 Time :  5880
accuracy train: 0.998015 val: 0.704478 test: 0.714568
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({1: 4559, 0: 2841})

Epoch :  37 loss training:  11.060010091401637 Time :  5919
accuracy train: 0.999338 val: 0.722388 test: 0.723720
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({1: 4582, 0: 2818})

Epoch :  38 loss training:  9.340944360010326 Time :  5949
accuracy train: 0.999338 val: 0.710448 test: 0.726688
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({0: 4556, 1: 2844})

Epoch :  39 loss training:  9.91483224183321 Time :  5989
accuracy train: 0.999669 val: 0.710448 test: 0.721247
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({0: 4567, 1: 2833})

Epoch :  40 loss training:  9.032459611073136 Time :  6029
accuracy train: 0.999669 val: 0.710448 test: 0.721494
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({1: 4577, 0: 2823})

Epoch :  41 loss training:  8.39292735978961 Time :  6063
accuracy train: 0.999669 val: 0.710448 test: 0.724957
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({1: 4556, 0: 2844})

Epoch :  42 loss training:  7.937221681699157 Time :  6100
accuracy train: 1.000000 val: 0.719403 test: 0.723720
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({1: 4580, 0: 2820})

Epoch :  43 loss training:  7.385704906657338 Time :  6131
accuracy train: 1.000000 val: 0.728358 test: 0.721741
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({0: 4593, 1: 2807})

Epoch :  44 loss training:  6.951711642090231 Time :  6159
accuracy train: 1.000000 val: 0.728358 test: 0.727430
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({1: 4520, 0: 2880})

Epoch :  45 loss training:  6.565963678993285 Time :  6186
accuracy train: 0.999669 val: 0.713433 test: 0.718031
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({1: 4543, 0: 2857})

Epoch :  46 loss training:  6.393909108359367 Time :  6225
accuracy train: 1.000000 val: 0.719403 test: 0.720752
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({1: 4539, 0: 2861})

Epoch :  47 loss training:  5.749341025017202 Time :  6259
accuracy train: 0.999669 val: 0.704478 test: 0.717289
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({0: 4555, 1: 2845})

Epoch :  48 loss training:  4.9225423648022115 Time :  6299
accuracy train: 1.000000 val: 0.719403 test: 0.723473
max validation accuracy : 0.731343 max acc epoch : 17 test accuracy : 0.720010
Counter({0: 4525, 1: 2875})

========================================================================================================================================================================================================
best acc epoch :  17
validation accuracy :  0.7313432835820896
test accuracy :  0.7200098936433341
last test_accuracy :  0.7234726688102894
second best val :  0.7283582089552239
second best test :  0.7200098936433341
max gap 4
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=581, tsne=False, weight_decay=0)
device :  cuda:0
Counter({1: 4561, 0: 2839})

Epoch :  1 loss training:  212.71877455711365 Time :  6351
accuracy train: 0.650563 val: 0.623881 test: 0.607222
max validation accuracy : 0.623881 max acc epoch : 1 test accuracy : 0.607222
Counter({0: 4174, 1: 3226})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  143.70908546447754 Time :  6400
accuracy train: 0.713766 val: 0.662687 test: 0.656938
max validation accuracy : 0.662687 max acc epoch : 2 test accuracy : 0.656938
Counter({1: 4419, 0: 2981})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  122.63166239857674 Time :  6437
accuracy train: 0.733620 val: 0.662687 test: 0.676725
max validation accuracy : 0.662687 max acc epoch : 2 test accuracy : 0.656938
Counter({1: 4770, 0: 2630})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  97.7449437379837 Time :  6479
accuracy train: 0.785242 val: 0.656716 test: 0.696018
max validation accuracy : 0.662687 max acc epoch : 2 test accuracy : 0.656938
Counter({0: 4321, 1: 3079})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  89.78746163845062 Time :  6519
accuracy train: 0.810060 val: 0.671642 test: 0.691071
max validation accuracy : 0.671642 max acc epoch : 5 test accuracy : 0.691071
Counter({0: 4326, 1: 3074})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.75300908088684 Time :  6553
accuracy train: 0.828590 val: 0.689552 test: 0.700717
max validation accuracy : 0.689552 max acc epoch : 6 test accuracy : 0.700717
Counter({0: 4850, 1: 2550})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  73.31500644981861 Time :  6584
accuracy train: 0.860688 val: 0.689552 test: 0.712095
max validation accuracy : 0.689552 max acc epoch : 6 test accuracy : 0.700717
Counter({1: 4814, 0: 2586})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.83719345927238 Time :  6623
accuracy train: 0.862343 val: 0.707463 test: 0.715310
max validation accuracy : 0.707463 max acc epoch : 8 test accuracy : 0.715310
Counter({1: 4423, 0: 2977})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  67.97434762120247 Time :  6666
accuracy train: 0.874917 val: 0.713433 test: 0.711106
max validation accuracy : 0.713433 max acc epoch : 9 test accuracy : 0.711106
Counter({0: 4788, 1: 2612})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.9623716622591 Time :  6707
accuracy train: 0.884514 val: 0.707463 test: 0.716547
max validation accuracy : 0.713433 max acc epoch : 9 test accuracy : 0.711106
Counter({0: 4546, 1: 2854})

Epoch :  11 loss training:  60.59077776968479 Time :  6750
accuracy train: 0.888815 val: 0.707463 test: 0.720752
max validation accuracy : 0.713433 max acc epoch : 9 test accuracy : 0.711106
Counter({1: 4548, 0: 2852})

Epoch :  12 loss training:  56.27809841930866 Time :  6788
accuracy train: 0.897750 val: 0.713433 test: 0.717042
max validation accuracy : 0.713433 max acc epoch : 9 test accuracy : 0.711106
Counter({1: 4516, 0: 2884})

Epoch :  13 loss training:  52.43972638249397 Time :  6828
accuracy train: 0.907346 val: 0.716418 test: 0.717784
max validation accuracy : 0.716418 max acc epoch : 13 test accuracy : 0.717784
Counter({0: 4491, 1: 2909})

Epoch :  14 loss training:  51.49711258709431 Time :  6866
accuracy train: 0.919590 val: 0.722388 test: 0.721741
max validation accuracy : 0.722388 max acc epoch : 14 test accuracy : 0.721741
Counter({0: 4761, 1: 2639})

Epoch :  15 loss training:  48.48154377192259 Time :  6901
accuracy train: 0.923561 val: 0.731343 test: 0.721247
max validation accuracy : 0.731343 max acc epoch : 15 test accuracy : 0.721247
Counter({1: 4749, 0: 2651})

Epoch :  16 loss training:  44.74454504996538 Time :  6943
accuracy train: 0.927201 val: 0.740299 test: 0.722978
max validation accuracy : 0.740299 max acc epoch : 16 test accuracy : 0.722978
Counter({1: 4737, 0: 2663})

Epoch :  17 loss training:  44.60335920006037 Time :  6998
accuracy train: 0.942422 val: 0.731343 test: 0.717536
max validation accuracy : 0.740299 max acc epoch : 16 test accuracy : 0.722978
Counter({0: 4737, 1: 2663})

Epoch :  18 loss training:  40.406799875199795 Time :  7038
accuracy train: 0.949371 val: 0.749254 test: 0.717289
max validation accuracy : 0.749254 max acc epoch : 18 test accuracy : 0.717289
Counter({0: 4509, 1: 2891})

Epoch :  19 loss training:  37.75017510354519 Time :  7076
accuracy train: 0.946062 val: 0.743284 test: 0.720257
max validation accuracy : 0.749254 max acc epoch : 18 test accuracy : 0.717289
Counter({0: 4729, 1: 2671})

Epoch :  20 loss training:  36.9082572683692 Time :  7116
accuracy train: 0.960291 val: 0.746269 test: 0.720010
max validation accuracy : 0.749254 max acc epoch : 18 test accuracy : 0.717289
Counter({0: 4729, 1: 2671})

Epoch :  21 loss training:  34.50595922768116 Time :  7160
accuracy train: 0.964262 val: 0.749254 test: 0.721989
max validation accuracy : 0.749254 max acc epoch : 18 test accuracy : 0.717289
Counter({0: 4717, 1: 2683})

Epoch :  22 loss training:  31.824940003454685 Time :  7212
accuracy train: 0.962938 val: 0.752239 test: 0.725204
max validation accuracy : 0.752239 max acc epoch : 22 test accuracy : 0.725204
Counter({1: 4483, 0: 2917})

Epoch :  23 loss training:  29.808288618922234 Time :  7256
accuracy train: 0.973527 val: 0.737313 test: 0.719763
max validation accuracy : 0.752239 max acc epoch : 22 test accuracy : 0.725204
Counter({1: 4722, 0: 2678})

Epoch :  24 loss training:  28.464248798787594 Time :  7288
accuracy train: 0.976175 val: 0.737313 test: 0.724709
max validation accuracy : 0.752239 max acc epoch : 22 test accuracy : 0.725204
Counter({1: 4474, 0: 2926})

Epoch :  25 loss training:  27.751519411802292 Time :  7323
accuracy train: 0.975513 val: 0.764179 test: 0.721494
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.721494
Counter({1: 4727, 0: 2673})

Epoch :  26 loss training:  26.56622004508972 Time :  7364
accuracy train: 0.978491 val: 0.758209 test: 0.722236
max validation accuracy : 0.764179 max acc epoch : 25 test accuracy : 0.721494
Counter({0: 4515, 1: 2885})

Epoch :  27 loss training:  23.3750144764781 Time :  7409
accuracy train: 0.981800 val: 0.776119 test: 0.722236
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({1: 4709, 0: 2691})

Epoch :  28 loss training:  22.07467580586672 Time :  7442
accuracy train: 0.986102 val: 0.776119 test: 0.726441
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({0: 4537, 1: 2863})

Epoch :  29 loss training:  20.172364849597216 Time :  7480
accuracy train: 0.990735 val: 0.770149 test: 0.724957
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({1: 4690, 0: 2710})

Epoch :  30 loss training:  19.470441810786724 Time :  7510
accuracy train: 0.990735 val: 0.758209 test: 0.721989
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({0: 4708, 1: 2692})

Epoch :  31 loss training:  17.42091618105769 Time :  7542
accuracy train: 0.996029 val: 0.752239 test: 0.721494
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({1: 4549, 0: 2851})

Epoch :  32 loss training:  16.981488343328238 Time :  7572
accuracy train: 0.995367 val: 0.761194 test: 0.721247
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({0: 4568, 1: 2832})

Epoch :  33 loss training:  16.24119260907173 Time :  7630
accuracy train: 0.996691 val: 0.764179 test: 0.719515
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({0: 4722, 1: 2678})

Epoch :  34 loss training:  15.427300978451967 Time :  7665
accuracy train: 0.997353 val: 0.761194 test: 0.718279
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({1: 4560, 0: 2840})

Epoch :  35 loss training:  13.27507458627224 Time :  7694
accuracy train: 0.996360 val: 0.758209 test: 0.724462
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({1: 4727, 0: 2673})

Epoch :  36 loss training:  12.806833885610104 Time :  7725
accuracy train: 0.998676 val: 0.770149 test: 0.718526
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({0: 4683, 1: 2717})

Epoch :  37 loss training:  11.60808477550745 Time :  7764
accuracy train: 0.998015 val: 0.761194 test: 0.713579
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({1: 4681, 0: 2719})

Epoch :  38 loss training:  11.878789259120822 Time :  7797
accuracy train: 0.999007 val: 0.752239 test: 0.718526
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({0: 4691, 1: 2709})

Epoch :  39 loss training:  10.681252621114254 Time :  7827
accuracy train: 1.000000 val: 0.755224 test: 0.719021
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({1: 4688, 0: 2712})

Epoch :  40 loss training:  9.590060781687498 Time :  7857
accuracy train: 1.000000 val: 0.764179 test: 0.719268
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({1: 4728, 0: 2672})

Epoch :  41 loss training:  10.19538114592433 Time :  7896
accuracy train: 0.999338 val: 0.764179 test: 0.716052
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({1: 4687, 0: 2713})

Epoch :  42 loss training:  8.504991730675101 Time :  7935
accuracy train: 1.000000 val: 0.755224 test: 0.720505
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({1: 4752, 0: 2648})

Epoch :  43 loss training:  7.118842486292124 Time :  7978
accuracy train: 1.000000 val: 0.767164 test: 0.720257
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({0: 4765, 1: 2635})

Epoch :  44 loss training:  6.5904760072007775 Time :  8011
accuracy train: 1.000000 val: 0.764179 test: 0.720505
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({0: 4763, 1: 2637})

Epoch :  45 loss training:  6.986712479032576 Time :  8075
accuracy train: 1.000000 val: 0.770149 test: 0.719763
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({1: 4762, 0: 2638})

Epoch :  46 loss training:  6.5896340580657125 Time :  8122
accuracy train: 1.000000 val: 0.761194 test: 0.714816
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({0: 4751, 1: 2649})

Epoch :  47 loss training:  6.846353957429528 Time :  8168
accuracy train: 1.000000 val: 0.773134 test: 0.716300
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({0: 4774, 1: 2626})

Epoch :  48 loss training:  7.10342827392742 Time :  8216
accuracy train: 1.000000 val: 0.770149 test: 0.713826
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({1: 4760, 0: 2640})

Epoch :  49 loss training:  6.044978296384215 Time :  8263
accuracy train: 1.000000 val: 0.767164 test: 0.711600
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({0: 4732, 1: 2668})

Epoch :  50 loss training:  6.563981860876083 Time :  8310
accuracy train: 1.000000 val: 0.755224 test: 0.713332
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({1: 4714, 0: 2686})

Epoch :  51 loss training:  4.944378934800625 Time :  8353
accuracy train: 1.000000 val: 0.755224 test: 0.714321
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({0: 4711, 1: 2689})

Epoch :  52 loss training:  4.68779766606167 Time :  8384
accuracy train: 1.000000 val: 0.758209 test: 0.717042
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({1: 4599, 0: 2801})

Epoch :  53 loss training:  3.6547170216217637 Time :  8417
accuracy train: 1.000000 val: 0.767164 test: 0.716547
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({0: 4763, 1: 2637})

Epoch :  54 loss training:  5.007735944353044 Time :  8452
accuracy train: 1.000000 val: 0.773134 test: 0.720505
max validation accuracy : 0.776119 max acc epoch : 27 test accuracy : 0.722236
Counter({1: 4830, 0: 2570})

Epoch :  55 loss training:  4.370546522084624 Time :  8507
accuracy train: 1.000000 val: 0.782090 test: 0.717536
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({0: 4620, 1: 2780})

Epoch :  56 loss training:  4.442187307402492 Time :  8550
accuracy train: 1.000000 val: 0.749254 test: 0.721494
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({1: 4830, 0: 2570})

Epoch :  57 loss training:  4.473389440914616 Time :  8584
accuracy train: 1.000000 val: 0.758209 test: 0.720010
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({1: 4596, 0: 2804})

Epoch :  58 loss training:  4.299926336854696 Time :  8615
accuracy train: 1.000000 val: 0.761194 test: 0.721247
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({1: 4849, 0: 2551})

Epoch :  59 loss training:  3.8770995629020035 Time :  8646
accuracy train: 1.000000 val: 0.761194 test: 0.713332
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({0: 4794, 1: 2606})

Epoch :  60 loss training:  4.0325440496671945 Time :  8683
accuracy train: 1.000000 val: 0.758209 test: 0.716300
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({1: 4816, 0: 2584})

Epoch :  61 loss training:  2.9161756676621735 Time :  8752
accuracy train: 1.000000 val: 0.770149 test: 0.715805
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({1: 4757, 0: 2643})

Epoch :  62 loss training:  2.9009828723501414 Time :  8788
accuracy train: 1.000000 val: 0.758209 test: 0.720752
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({1: 4749, 0: 2651})

Epoch :  63 loss training:  2.6851091736461967 Time :  8816
accuracy train: 1.000000 val: 0.755224 test: 0.716300
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({0: 4556, 1: 2844})

Epoch :  64 loss training:  3.158239871263504 Time :  8851
accuracy train: 1.000000 val: 0.767164 test: 0.717289
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({1: 4836, 0: 2564})

Epoch :  65 loss training:  2.9013988580554724 Time :  8893
accuracy train: 1.000000 val: 0.758209 test: 0.720257
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({0: 4586, 1: 2814})

Epoch :  66 loss training:  2.622184715466574 Time :  8926
accuracy train: 1.000000 val: 0.746269 test: 0.722236
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({0: 4559, 1: 2841})

Epoch :  67 loss training:  3.3249412273289636 Time :  8957
accuracy train: 1.000000 val: 0.749254 test: 0.722236
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({1: 4573, 0: 2827})

Epoch :  68 loss training:  2.7798146915156394 Time :  8991
accuracy train: 1.000000 val: 0.746269 test: 0.720257
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({1: 4558, 0: 2842})

Epoch :  69 loss training:  2.2827727823751047 Time :  9031
accuracy train: 1.000000 val: 0.764179 test: 0.712342
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({1: 4796, 0: 2604})

Epoch :  70 loss training:  2.6772186616435647 Time :  9059
accuracy train: 1.000000 val: 0.761194 test: 0.720505
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({1: 4764, 0: 2636})

Epoch :  71 loss training:  1.9206069342326373 Time :  9092
accuracy train: 1.000000 val: 0.743284 test: 0.721494
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({1: 4855, 0: 2545})

Epoch :  72 loss training:  1.545940617506858 Time :  9137
accuracy train: 1.000000 val: 0.749254 test: 0.718031
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({1: 4872, 0: 2528})

Epoch :  73 loss training:  1.8969539902172983 Time :  9170
accuracy train: 1.000000 val: 0.746269 test: 0.718773
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({0: 4641, 1: 2759})

Epoch :  74 loss training:  2.5247127413749695 Time :  9210
accuracy train: 1.000000 val: 0.746269 test: 0.715558
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({1: 4788, 0: 2612})

Epoch :  75 loss training:  2.2663847100920975 Time :  9251
accuracy train: 1.000000 val: 0.758209 test: 0.717289
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({0: 4682, 1: 2718})

Epoch :  76 loss training:  2.018879982526414 Time :  9283
accuracy train: 1.000000 val: 0.743284 test: 0.709869
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({1: 4819, 0: 2581})

Epoch :  77 loss training:  1.9625244644703344 Time :  9324
accuracy train: 1.000000 val: 0.767164 test: 0.715310
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({1: 4659, 0: 2741})

Epoch :  78 loss training:  1.5165386306471191 Time :  9367
accuracy train: 1.000000 val: 0.752239 test: 0.718773
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({1: 4806, 0: 2594})

Epoch :  79 loss training:  1.535032071522437 Time :  9407
accuracy train: 1.000000 val: 0.752239 test: 0.714321
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({0: 4782, 1: 2618})

Epoch :  80 loss training:  1.7711118261213414 Time :  9439
accuracy train: 0.999669 val: 0.743284 test: 0.709127
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({0: 4798, 1: 2602})

Epoch :  81 loss training:  1.845902006723918 Time :  9477
accuracy train: 1.000000 val: 0.755224 test: 0.711848
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({1: 4670, 0: 2730})

Epoch :  82 loss training:  2.081694660941139 Time :  9511
accuracy train: 1.000000 val: 0.752239 test: 0.715805
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({1: 4641, 0: 2759})

Epoch :  83 loss training:  1.7906744970241562 Time :  9543
accuracy train: 1.000000 val: 0.758209 test: 0.715063
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({0: 4774, 1: 2626})

Epoch :  84 loss training:  1.4390046736807562 Time :  9583
accuracy train: 1.000000 val: 0.752239 test: 0.715805
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({1: 4884, 0: 2516})

Epoch :  85 loss training:  1.3956604478880763 Time :  9612
accuracy train: 1.000000 val: 0.755224 test: 0.718279
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({1: 4768, 0: 2632})

Epoch :  86 loss training:  1.2189755117869936 Time :  9650
accuracy train: 1.000000 val: 0.764179 test: 0.721494
max validation accuracy : 0.782090 max acc epoch : 55 test accuracy : 0.717536
Counter({0: 4627, 1: 2773})

========================================================================================================================================================================================================
best acc epoch :  55
validation accuracy :  0.7820895522388059
test accuracy :  0.7175364828097948
last test_accuracy :  0.7214939401434578
second best val :  0.7761194029850746
second best test :  0.7222359633935197
max gap 28
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  28 	 val_accuracy : 0.76418 	 test_accuracy : 0.72446 	 last test_accuracy : 0.71952 	 second best val : 0.75821 	 second best test : 0.72075
k :  1 	 best_acc epoch :  19 	 val_accuracy : 0.76119 	 test_accuracy : 0.72718 	 last test_accuracy : 0.72075 	 second best val : 0.75224 	 second best test : 0.72471
k :  2 	 best_acc epoch :  17 	 val_accuracy : 0.73134 	 test_accuracy : 0.72001 	 last test_accuracy : 0.72347 	 second best val : 0.72836 	 second best test : 0.72001
k :  3 	 best_acc epoch :  55 	 val_accuracy : 0.78209 	 test_accuracy : 0.71754 	 last test_accuracy : 0.72149 	 second best val : 0.77612 	 second best test : 0.72224

avg :  	 val_accuracy : 0.75970 	 test_accuracy : 0.72230 	 last_accuracy : 0.72131 	 second best val : 0.75373 	 second best test : 0.72193

std :  	 val_accuracy : 0.01822 	 test_accuracy : 0.00376 	 last_accuracy : 0.00144 	 second best val : 0.01708 	 second best test : 0.00180


date and time :  Tue Jun 15 00:22:13 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=4, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=267, tsne=False, weight_decay=0)
device :  cuda:0
Counter({0: 2084, 2: 1942, 1: 1845, 3: 1529})

Epoch :  1 loss training:  212.74782133102417 Time :  45
accuracy train: 0.657842 val: 0.617910 test: 0.609201
max validation accuracy : 0.617910 max acc epoch : 1 test accuracy : 0.609201
Counter({2: 2974, 3: 1694, 1: 1368, 0: 1364})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  139.73126351833344 Time :  76
accuracy train: 0.691264 val: 0.588060 test: 0.623300
max validation accuracy : 0.617910 max acc epoch : 1 test accuracy : 0.609201
Counter({1: 2445, 3: 1689, 2: 1673, 0: 1593})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  120.30873769521713 Time :  110
accuracy train: 0.747187 val: 0.644776 test: 0.665100
max validation accuracy : 0.644776 max acc epoch : 3 test accuracy : 0.665100
Counter({1: 3073, 3: 1593, 2: 1442, 0: 1292})
Epoch-3 lr: 0.001

Epoch :  4 loss training:  109.17705765366554 Time :  145
accuracy train: 0.781932 val: 0.650746 test: 0.666584
max validation accuracy : 0.650746 max acc epoch : 4 test accuracy : 0.666584
Counter({2: 2570, 1: 1795, 3: 1527, 0: 1508})
Epoch-4 lr: 0.001

Epoch :  5 loss training:  99.18357014656067 Time :  180
accuracy train: 0.804103 val: 0.644776 test: 0.677962
max validation accuracy : 0.650746 max acc epoch : 4 test accuracy : 0.666584
Counter({1: 2559, 0: 1836, 3: 1533, 2: 1472})
Epoch-5 lr: 0.001

Epoch :  6 loss training:  87.45216697454453 Time :  218
accuracy train: 0.792522 val: 0.623881 test: 0.652980
max validation accuracy : 0.650746 max acc epoch : 4 test accuracy : 0.666584
Counter({1: 2374, 0: 1781, 2: 1714, 3: 1531})
Epoch-6 lr: 0.001

Epoch :  7 loss training:  81.51775757968426 Time :  263
accuracy train: 0.826274 val: 0.635821 test: 0.682414
max validation accuracy : 0.650746 max acc epoch : 4 test accuracy : 0.666584
Counter({0: 2520, 1: 1811, 2: 1549, 3: 1520})
Epoch-7 lr: 0.001

Epoch :  8 loss training:  78.27962449193001 Time :  302
accuracy train: 0.856386 val: 0.668657 test: 0.696265
max validation accuracy : 0.668657 max acc epoch : 8 test accuracy : 0.696265
Counter({2: 3191, 1: 1517, 0: 1434, 3: 1258})
Epoch-8 lr: 0.001

Epoch :  9 loss training:  71.8307883143425 Time :  347
accuracy train: 0.887823 val: 0.665672 test: 0.701212
max validation accuracy : 0.668657 max acc epoch : 8 test accuracy : 0.696265
Counter({2: 2607, 1: 1803, 3: 1496, 0: 1494})
Epoch-9 lr: 0.001

Epoch :  10 loss training:  68.8930908292532 Time :  392
accuracy train: 0.885837 val: 0.650746 test: 0.685382
max validation accuracy : 0.668657 max acc epoch : 8 test accuracy : 0.696265
Counter({1: 2587, 0: 1835, 3: 1528, 2: 1450})

Epoch :  11 loss training:  62.1205158829689 Time :  428
accuracy train: 0.919590 val: 0.686567 test: 0.703191
max validation accuracy : 0.686567 max acc epoch : 11 test accuracy : 0.703191
Counter({3: 2481, 1: 1805, 0: 1623, 2: 1491})

Epoch :  12 loss training:  54.22251445055008 Time :  492
accuracy train: 0.911979 val: 0.680597 test: 0.692060
max validation accuracy : 0.686567 max acc epoch : 11 test accuracy : 0.703191
Counter({1: 2477, 0: 1884, 3: 1587, 2: 1452})

Epoch :  13 loss training:  43.65668090432882 Time :  563
accuracy train: 0.954004 val: 0.689552 test: 0.703685
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.703685
Counter({1: 2444, 0: 1767, 3: 1722, 2: 1467})

Epoch :  14 loss training:  35.35717407241464 Time :  634
accuracy train: 0.950364 val: 0.671642 test: 0.698491
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.703685
Counter({2: 2593, 0: 1832, 1: 1552, 3: 1423})

Epoch :  15 loss training:  26.054062362760305 Time :  709
accuracy train: 0.982793 val: 0.686567 test: 0.706901
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.703685
Counter({1: 2441, 2: 1836, 0: 1733, 3: 1390})

Epoch :  16 loss training:  17.46846585161984 Time :  779
accuracy train: 0.989411 val: 0.707463 test: 0.717784
max validation accuracy : 0.707463 max acc epoch : 16 test accuracy : 0.717784
Counter({1: 2508, 2: 1835, 0: 1689, 3: 1368})

Epoch :  17 loss training:  14.44022925477475 Time :  853
accuracy train: 0.995698 val: 0.680597 test: 0.713084
max validation accuracy : 0.707463 max acc epoch : 16 test accuracy : 0.717784
Counter({3: 2501, 1: 1877, 0: 1688, 2: 1334})

Epoch :  18 loss training:  10.123259507119656 Time :  931
accuracy train: 0.998676 val: 0.689552 test: 0.713579
max validation accuracy : 0.707463 max acc epoch : 16 test accuracy : 0.717784
Counter({1: 3103, 2: 1776, 3: 1355, 0: 1166})

Epoch :  19 loss training:  9.991065897978842 Time :  1009
accuracy train: 0.995698 val: 0.707463 test: 0.710858
max validation accuracy : 0.707463 max acc epoch : 16 test accuracy : 0.717784
Counter({1: 3027, 2: 1801, 0: 1370, 3: 1202})

Epoch :  20 loss training:  7.168691483326256 Time :  1083
accuracy train: 0.998345 val: 0.683582 test: 0.713826
max validation accuracy : 0.707463 max acc epoch : 16 test accuracy : 0.717784
Counter({3: 2473, 1: 1827, 0: 1751, 2: 1349})

Epoch :  21 loss training:  4.825432866811752 Time :  1123
accuracy train: 0.999007 val: 0.731343 test: 0.720505
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({2: 3097, 1: 1785, 0: 1357, 3: 1161})

Epoch :  22 loss training:  5.353230189997703 Time :  1158
accuracy train: 0.999338 val: 0.698507 test: 0.721247
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({2: 3142, 3: 1707, 0: 1376, 1: 1175})

Epoch :  23 loss training:  2.8395187399582937 Time :  1193
accuracy train: 0.997022 val: 0.704478 test: 0.709869
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({1: 3078, 3: 1789, 0: 1350, 2: 1183})

Epoch :  24 loss training:  2.1893231036374345 Time :  1236
accuracy train: 1.000000 val: 0.704478 test: 0.710611
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({0: 3154, 3: 1729, 1: 1364, 2: 1153})

Epoch :  25 loss training:  3.8283377680927515 Time :  1277
accuracy train: 0.999669 val: 0.719403 test: 0.719268
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({3: 3072, 0: 1851, 1: 1328, 2: 1149})

Epoch :  26 loss training:  2.8935275701223873 Time :  1314
accuracy train: 0.999669 val: 0.689552 test: 0.712342
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({1: 3214, 3: 1701, 0: 1361, 2: 1124})

Epoch :  27 loss training:  3.114292449899949 Time :  1352
accuracy train: 0.997684 val: 0.674627 test: 0.698739
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({0: 3176, 2: 1720, 3: 1355, 1: 1149})

Epoch :  28 loss training:  3.229596968565602 Time :  1409
accuracy train: 1.000000 val: 0.713433 test: 0.710611
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({0: 3257, 2: 1686, 1: 1323, 3: 1134})

Epoch :  29 loss training:  1.9302308990445454 Time :  1448
accuracy train: 0.999669 val: 0.695522 test: 0.711600
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({2: 3432, 0: 1528, 1: 1314, 3: 1126})

Epoch :  30 loss training:  2.8098935178131796 Time :  1485
accuracy train: 1.000000 val: 0.689552 test: 0.717784
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({0: 3355, 1: 1547, 3: 1309, 2: 1189})

Epoch :  31 loss training:  2.1602143816417083 Time :  1545
accuracy train: 0.999669 val: 0.659701 test: 0.697255
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({1: 2712, 0: 2261, 2: 1315, 3: 1112})

Epoch :  32 loss training:  3.569066959549673 Time :  1584
accuracy train: 0.998015 val: 0.668657 test: 0.703685
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({1: 3532, 3: 1389, 2: 1326, 0: 1153})

Epoch :  33 loss training:  4.928417370014358 Time :  1623
accuracy train: 0.998015 val: 0.635821 test: 0.688350
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({2: 3010, 0: 2194, 3: 1289, 1: 907})

Epoch :  34 loss training:  4.450751213094918 Time :  1673
accuracy train: 0.999338 val: 0.668657 test: 0.702449
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({3: 3585, 0: 1382, 1: 1288, 2: 1145})

Epoch :  35 loss training:  4.227636401832569 Time :  1713
accuracy train: 0.998015 val: 0.683582 test: 0.682167
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({1: 2508, 3: 2096, 0: 1560, 2: 1236})

Epoch :  36 loss training:  5.045689609542023 Time :  1750
accuracy train: 0.997684 val: 0.671642 test: 0.698739
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({1: 3492, 2: 1517, 0: 1270, 3: 1121})

Epoch :  37 loss training:  2.8267383030906785 Time :  1789
accuracy train: 1.000000 val: 0.653731 test: 0.701459
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({0: 3954, 1: 1283, 3: 1156, 2: 1007})

Epoch :  38 loss training:  2.2730061034963 Time :  1845
accuracy train: 1.000000 val: 0.689552 test: 0.702696
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({2: 2538, 3: 2464, 1: 1272, 0: 1126})

Epoch :  39 loss training:  0.7069820948236156 Time :  1883
accuracy train: 1.000000 val: 0.695522 test: 0.714074
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({1: 3380, 2: 1645, 3: 1263, 0: 1112})

Epoch :  40 loss training:  1.0552911478080205 Time :  1923
accuracy train: 0.999338 val: 0.689552 test: 0.692802
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({3: 3361, 2: 1667, 1: 1270, 0: 1102})

Epoch :  41 loss training:  1.847908143303357 Time :  1978
accuracy train: 0.998676 val: 0.674627 test: 0.697502
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({1: 2849, 3: 2168, 2: 1261, 0: 1122})

Epoch :  42 loss training:  3.9505011657602154 Time :  2014
accuracy train: 1.000000 val: 0.686567 test: 0.696265
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({2: 3687, 3: 1320, 0: 1252, 1: 1141})

Epoch :  43 loss training:  5.614810554456199 Time :  2052
accuracy train: 0.995698 val: 0.641791 test: 0.674252
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({3: 2802, 0: 2083, 2: 1313, 1: 1202})

Epoch :  44 loss training:  6.317614507977851 Time :  2093
accuracy train: 0.999007 val: 0.632836 test: 0.679693
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({1: 4509, 2: 1265, 0: 990, 3: 636})

Epoch :  45 loss training:  5.667186673701508 Time :  2135
accuracy train: 0.998345 val: 0.620896 test: 0.674499
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({2: 3493, 3: 2219, 1: 1276, 0: 412})

Epoch :  46 loss training:  2.868053045720444 Time :  2173
accuracy train: 1.000000 val: 0.659701 test: 0.700965
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({0: 2927, 2: 2061, 1: 1258, 3: 1154})

Epoch :  47 loss training:  2.508616048784461 Time :  2210
accuracy train: 1.000000 val: 0.641791 test: 0.692060
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({3: 4444, 2: 1257, 1: 1080, 0: 619})

Epoch :  48 loss training:  1.2964039590369794 Time :  2270
accuracy train: 1.000000 val: 0.674627 test: 0.712837
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({1: 3422, 2: 1676, 3: 1251, 0: 1051})

Epoch :  49 loss training:  0.8454265874133853 Time :  2306
accuracy train: 1.000000 val: 0.659701 test: 0.707643
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({0: 4464, 1: 1226, 3: 1090, 2: 620})

Epoch :  50 loss training:  0.7771995077446263 Time :  2340
accuracy train: 0.999007 val: 0.674627 test: 0.707643
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({1: 4127, 2: 1243, 3: 1075, 0: 955})

Epoch :  51 loss training:  1.600217167007031 Time :  2376
accuracy train: 1.000000 val: 0.662687 test: 0.697007
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({0: 3444, 1: 1670, 2: 1263, 3: 1023})

Epoch :  52 loss training:  1.1603846708749188 Time :  2419
accuracy train: 0.998345 val: 0.665672 test: 0.698739
max validation accuracy : 0.731343 max acc epoch : 21 test accuracy : 0.720505
Counter({0: 3335, 1: 1741, 2: 1276, 3: 1048})

========================================================================================================================================================================================================
best acc epoch :  21
validation accuracy :  0.7313432835820896
test accuracy :  0.720504575810042
last test_accuracy :  0.6987385604748949
second best val :  0.7194029850746269
second best test :  0.720504575810042
max gap 5
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=4, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=265, tsne=False, weight_decay=0)
device :  cuda:0
Counter({0: 2083, 1: 1944, 2: 1843, 3: 1530})

Epoch :  1 loss training:  213.50942128896713 Time :  2465
accuracy train: 0.636995 val: 0.525373 test: 0.584220
max validation accuracy : 0.525373 max acc epoch : 1 test accuracy : 0.584220
Counter({0: 2895, 1: 1833, 3: 1463, 2: 1209})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  137.79563975334167 Time :  2499
accuracy train: 0.720053 val: 0.570149 test: 0.636903
max validation accuracy : 0.570149 max acc epoch : 2 test accuracy : 0.636903
Counter({1: 3193, 3: 1618, 0: 1388, 2: 1201})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  117.24524754285812 Time :  2553
accuracy train: 0.744540 val: 0.611940 test: 0.652733
max validation accuracy : 0.611940 max acc epoch : 3 test accuracy : 0.652733
Counter({3: 3130, 0: 1586, 1: 1434, 2: 1250})
Epoch-3 lr: 0.001

Epoch :  4 loss training:  105.68936702609062 Time :  2586
accuracy train: 0.796823 val: 0.626866 test: 0.682167
max validation accuracy : 0.626866 max acc epoch : 4 test accuracy : 0.682167
Counter({1: 3227, 2: 1539, 0: 1342, 3: 1292})
Epoch-4 lr: 0.001

Epoch :  5 loss training:  100.60952481627464 Time :  2621
accuracy train: 0.809398 val: 0.635821 test: 0.681672
max validation accuracy : 0.635821 max acc epoch : 5 test accuracy : 0.681672
Counter({1: 3112, 2: 1531, 0: 1422, 3: 1335})
Epoch-5 lr: 0.001

Epoch :  6 loss training:  90.00584533810616 Time :  2658
accuracy train: 0.818001 val: 0.647761 test: 0.665348
max validation accuracy : 0.647761 max acc epoch : 6 test accuracy : 0.665348
Counter({3: 3341, 2: 1500, 0: 1348, 1: 1211})
Epoch-6 lr: 0.001

Epoch :  7 loss training:  85.57415905594826 Time :  2699
accuracy train: 0.816016 val: 0.620896 test: 0.675983
max validation accuracy : 0.647761 max acc epoch : 6 test accuracy : 0.665348
Counter({1: 3183, 2: 1576, 0: 1428, 3: 1213})
Epoch-7 lr: 0.001

Epoch :  8 loss training:  78.72960682213306 Time :  2732
accuracy train: 0.852747 val: 0.641791 test: 0.687608
max validation accuracy : 0.647761 max acc epoch : 6 test accuracy : 0.665348
Counter({3: 3262, 1: 1525, 0: 1345, 2: 1268})
Epoch-8 lr: 0.001

Epoch :  9 loss training:  74.47309038043022 Time :  2765
accuracy train: 0.846128 val: 0.629851 test: 0.691071
max validation accuracy : 0.647761 max acc epoch : 6 test accuracy : 0.665348
Counter({3: 3156, 2: 1565, 0: 1425, 1: 1254})
Epoch-9 lr: 0.001

Epoch :  10 loss training:  69.1921983063221 Time :  2802
accuracy train: 0.875248 val: 0.659701 test: 0.678209
max validation accuracy : 0.659701 max acc epoch : 10 test accuracy : 0.678209
Counter({0: 3268, 1: 1492, 2: 1395, 3: 1245})

Epoch :  11 loss training:  61.681526497006416 Time :  2834
accuracy train: 0.910655 val: 0.647761 test: 0.695028
max validation accuracy : 0.659701 max acc epoch : 10 test accuracy : 0.678209
Counter({0: 3346, 1: 1512, 2: 1317, 3: 1225})

Epoch :  12 loss training:  46.08041329681873 Time :  2864
accuracy train: 0.951357 val: 0.647761 test: 0.701459
max validation accuracy : 0.659701 max acc epoch : 10 test accuracy : 0.678209
Counter({3: 3307, 0: 1473, 1: 1343, 2: 1277})

Epoch :  13 loss training:  34.71367294713855 Time :  2897
accuracy train: 0.968564 val: 0.659701 test: 0.714816
max validation accuracy : 0.659701 max acc epoch : 10 test accuracy : 0.678209
Counter({0: 3256, 1: 1485, 3: 1352, 2: 1307})

Epoch :  14 loss training:  26.27723141759634 Time :  2935
accuracy train: 0.988418 val: 0.662687 test: 0.709374
max validation accuracy : 0.662687 max acc epoch : 14 test accuracy : 0.709374
Counter({1: 3389, 3: 1445, 0: 1333, 2: 1233})

Epoch :  15 loss training:  19.39228044450283 Time :  2967
accuracy train: 0.987756 val: 0.656716 test: 0.715310
max validation accuracy : 0.662687 max acc epoch : 14 test accuracy : 0.709374
Counter({3: 3284, 1: 1443, 0: 1415, 2: 1258})

Epoch :  16 loss training:  13.995218301191926 Time :  2998
accuracy train: 0.989411 val: 0.674627 test: 0.704675
max validation accuracy : 0.674627 max acc epoch : 16 test accuracy : 0.704675
Counter({2: 3347, 0: 1407, 1: 1398, 3: 1248})

Epoch :  17 loss training:  9.452971745282412 Time :  3031
accuracy train: 0.996691 val: 0.662687 test: 0.711600
max validation accuracy : 0.674627 max acc epoch : 16 test accuracy : 0.704675
Counter({2: 3195, 1: 1552, 0: 1426, 3: 1227})

Epoch :  18 loss training:  7.311846357770264 Time :  3068
accuracy train: 0.998345 val: 0.668657 test: 0.710611
max validation accuracy : 0.674627 max acc epoch : 16 test accuracy : 0.704675
Counter({0: 3287, 3: 1474, 1: 1410, 2: 1229})

Epoch :  19 loss training:  6.395567077212036 Time :  3101
accuracy train: 0.998676 val: 0.659701 test: 0.710611
max validation accuracy : 0.674627 max acc epoch : 16 test accuracy : 0.704675
Counter({0: 2517, 2: 2243, 1: 1403, 3: 1237})

Epoch :  20 loss training:  8.522643598727882 Time :  3131
accuracy train: 0.995698 val: 0.662687 test: 0.696018
max validation accuracy : 0.674627 max acc epoch : 16 test accuracy : 0.704675
Counter({0: 3356, 2: 1437, 1: 1404, 3: 1203})

Epoch :  21 loss training:  6.784539439948276 Time :  3163
accuracy train: 0.996691 val: 0.686567 test: 0.708385
max validation accuracy : 0.686567 max acc epoch : 21 test accuracy : 0.708385
Counter({3: 2558, 0: 2266, 1: 1341, 2: 1235})

Epoch :  22 loss training:  10.301239759195596 Time :  3199
accuracy train: 0.995698 val: 0.656716 test: 0.699728
max validation accuracy : 0.686567 max acc epoch : 21 test accuracy : 0.708385
Counter({3: 2569, 2: 2248, 0: 1384, 1: 1199})

Epoch :  23 loss training:  7.186363014159724 Time :  3234
accuracy train: 0.997022 val: 0.656716 test: 0.690824
max validation accuracy : 0.686567 max acc epoch : 21 test accuracy : 0.708385
Counter({2: 2490, 3: 2373, 0: 1354, 1: 1183})

Epoch :  24 loss training:  6.08938719809521 Time :  3264
accuracy train: 0.998015 val: 0.668657 test: 0.710611
max validation accuracy : 0.686567 max acc epoch : 21 test accuracy : 0.708385
Counter({3: 2501, 2: 2347, 1: 1359, 0: 1193})

Epoch :  25 loss training:  5.540872336598113 Time :  3300
accuracy train: 0.995698 val: 0.674627 test: 0.689340
max validation accuracy : 0.686567 max acc epoch : 21 test accuracy : 0.708385
Counter({1: 2674, 3: 2241, 0: 1303, 2: 1182})

Epoch :  26 loss training:  3.965127171133645 Time :  3336
accuracy train: 0.998676 val: 0.674627 test: 0.704675
max validation accuracy : 0.686567 max acc epoch : 21 test accuracy : 0.708385
Counter({2: 3513, 0: 1389, 1: 1333, 3: 1165})

Epoch :  27 loss training:  3.292315304512158 Time :  3369
accuracy train: 1.000000 val: 0.683582 test: 0.699728
max validation accuracy : 0.686567 max acc epoch : 21 test accuracy : 0.708385
Counter({2: 3217, 0: 1732, 1: 1312, 3: 1139})

Epoch :  28 loss training:  1.6985977644799277 Time :  3402
accuracy train: 0.999669 val: 0.674627 test: 0.710858
max validation accuracy : 0.686567 max acc epoch : 21 test accuracy : 0.708385
Counter({2: 3171, 3: 1787, 0: 1293, 1: 1149})

Epoch :  29 loss training:  2.4736658374313265 Time :  3434
accuracy train: 1.000000 val: 0.677612 test: 0.712590
max validation accuracy : 0.686567 max acc epoch : 21 test accuracy : 0.708385
Counter({3: 3093, 1: 1869, 2: 1307, 0: 1131})

Epoch :  30 loss training:  1.6832886116753798 Time :  3473
accuracy train: 1.000000 val: 0.692537 test: 0.703191
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({2: 2594, 0: 2379, 3: 1295, 1: 1132})

Epoch :  31 loss training:  2.576206973171793 Time :  3504
accuracy train: 0.996360 val: 0.647761 test: 0.702696
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({2: 3110, 0: 1835, 3: 1328, 1: 1127})

Epoch :  32 loss training:  2.693004740489414 Time :  3539
accuracy train: 0.999669 val: 0.662687 test: 0.700717
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({0: 3248, 3: 1720, 1: 1312, 2: 1120})

Epoch :  33 loss training:  2.025420012330869 Time :  3573
accuracy train: 1.000000 val: 0.653731 test: 0.698739
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({1: 3214, 0: 1771, 3: 1312, 2: 1103})

Epoch :  34 loss training:  2.486978361121146 Time :  3632
accuracy train: 0.998676 val: 0.668657 test: 0.693544
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({1: 3125, 0: 1846, 3: 1302, 2: 1127})

Epoch :  35 loss training:  5.4506657887250185 Time :  3666
accuracy train: 0.997022 val: 0.680597 test: 0.681672
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({0: 2651, 2: 2346, 1: 1238, 3: 1165})

Epoch :  36 loss training:  5.577016713155899 Time :  3697
accuracy train: 0.999669 val: 0.641791 test: 0.684393
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({1: 3487, 2: 1420, 3: 1285, 0: 1208})

Epoch :  37 loss training:  4.241834431479219 Time :  3730
accuracy train: 1.000000 val: 0.665672 test: 0.703438
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({3: 3147, 0: 1854, 1: 1248, 2: 1151})

Epoch :  38 loss training:  3.534382666926831 Time :  3783
accuracy train: 0.999007 val: 0.668657 test: 0.687361
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({0: 3437, 3: 1522, 1: 1248, 2: 1193})

Epoch :  39 loss training:  3.4772847402782645 Time :  3812
accuracy train: 0.999338 val: 0.647761 test: 0.694534
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({1: 3179, 3: 1807, 0: 1249, 2: 1165})

Epoch :  40 loss training:  2.8206244612956652 Time :  3841
accuracy train: 0.999007 val: 0.623881 test: 0.694039
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({1: 2656, 3: 2349, 0: 1249, 2: 1146})

Epoch :  41 loss training:  2.501819587268983 Time :  3870
accuracy train: 0.998676 val: 0.632836 test: 0.676725
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({2: 3149, 3: 1836, 0: 1274, 1: 1141})

Epoch :  42 loss training:  1.798854459717404 Time :  3918
accuracy train: 1.000000 val: 0.656716 test: 0.701459
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({0: 3166, 1: 1856, 2: 1260, 3: 1118})

Epoch :  43 loss training:  1.085841710701061 Time :  3946
accuracy train: 0.999669 val: 0.641791 test: 0.693544
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({1: 3173, 3: 1850, 2: 1251, 0: 1126})

Epoch :  44 loss training:  1.5727877213776082 Time :  3975
accuracy train: 1.000000 val: 0.626866 test: 0.693050
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({3: 2720, 1: 2287, 0: 1252, 2: 1141})

Epoch :  45 loss training:  0.755075591536297 Time :  4006
accuracy train: 1.000000 val: 0.647761 test: 0.697997
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({2: 3198, 3: 1843, 0: 1231, 1: 1128})

Epoch :  46 loss training:  0.42115878692493425 Time :  4042
accuracy train: 0.999669 val: 0.662687 test: 0.695523
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({3: 3195, 0: 1852, 2: 1225, 1: 1128})

Epoch :  47 loss training:  0.403612583213544 Time :  4070
accuracy train: 1.000000 val: 0.641791 test: 0.699975
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({2: 3163, 0: 1887, 1: 1224, 3: 1126})

Epoch :  48 loss training:  0.8556052321691823 Time :  4100
accuracy train: 0.996029 val: 0.632836 test: 0.692060
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({0: 3168, 1: 1863, 3: 1245, 2: 1124})

Epoch :  49 loss training:  1.1339477100736985 Time :  4129
accuracy train: 1.000000 val: 0.650746 test: 0.702449
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({1: 3170, 3: 1878, 0: 1235, 2: 1117})

Epoch :  50 loss training:  1.6407759541179985 Time :  4162
accuracy train: 1.000000 val: 0.662687 test: 0.690824
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({3: 3202, 0: 1852, 2: 1229, 1: 1117})

Epoch :  51 loss training:  3.4348268790399743 Time :  4190
accuracy train: 0.998015 val: 0.614925 test: 0.678209
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({0: 3220, 2: 1845, 3: 1229, 1: 1106})

Epoch :  52 loss training:  3.337548747378605 Time :  4218
accuracy train: 0.998015 val: 0.597015 test: 0.664358
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({1: 2582, 2: 2493, 0: 1245, 3: 1080})

Epoch :  53 loss training:  12.669286183845543 Time :  4246
accuracy train: 0.998676 val: 0.623881 test: 0.682414
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({2: 2620, 3: 2347, 1: 1224, 0: 1209})

Epoch :  54 loss training:  2.882884878839832 Time :  4279
accuracy train: 0.999338 val: 0.668657 test: 0.692555
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({0: 3682, 2: 1404, 3: 1185, 1: 1129})

Epoch :  55 loss training:  1.1052481908118352 Time :  4310
accuracy train: 1.000000 val: 0.635821 test: 0.694039
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({0: 2931, 2: 2166, 3: 1213, 1: 1090})

Epoch :  56 loss training:  0.5630301154014887 Time :  4337
accuracy train: 1.000000 val: 0.632836 test: 0.691071
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({0: 2948, 3: 2159, 1: 1213, 2: 1080})

Epoch :  57 loss training:  0.7271176921422011 Time :  4368
accuracy train: 0.999338 val: 0.647761 test: 0.697997
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({0: 2861, 2: 2257, 3: 1203, 1: 1079})

Epoch :  58 loss training:  0.48520096390529943 Time :  4395
accuracy train: 1.000000 val: 0.647761 test: 0.690082
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({3: 2809, 0: 2328, 2: 1185, 1: 1078})

Epoch :  59 loss training:  0.5461640036373865 Time :  4431
accuracy train: 1.000000 val: 0.644776 test: 0.696018
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({3: 2631, 2: 2501, 0: 1208, 1: 1060})

Epoch :  60 loss training:  0.4982572380831698 Time :  4459
accuracy train: 1.000000 val: 0.638806 test: 0.685877
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({0: 2869, 3: 2248, 1: 1180, 2: 1103})

Epoch :  61 loss training:  0.9166691612554132 Time :  4490
accuracy train: 0.999338 val: 0.656716 test: 0.697997
max validation accuracy : 0.692537 max acc epoch : 30 test accuracy : 0.703191
Counter({0: 2935, 1: 2223, 3: 1208, 2: 1034})

========================================================================================================================================================================================================
best acc epoch :  30
validation accuracy :  0.6925373134328359
test accuracy :  0.7031906999752658
last test_accuracy :  0.697996537224833
second best val :  0.6865671641791045
second best test :  0.7083848627256988
max gap 9
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=4, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=910, tsne=False, weight_decay=0)
device :  cuda:0
Counter({3: 2082, 0: 1941, 1: 1843, 2: 1534})

Epoch :  1 loss training:  206.10969930887222 Time :  4530
accuracy train: 0.658835 val: 0.632836 test: 0.614890
max validation accuracy : 0.632836 max acc epoch : 1 test accuracy : 0.614890
Counter({2: 2378, 0: 1832, 1: 1633, 3: 1557})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  140.94871732592583 Time :  4561
accuracy train: 0.723031 val: 0.689552 test: 0.661885
max validation accuracy : 0.689552 max acc epoch : 2 test accuracy : 0.661885
Counter({0: 2448, 2: 1873, 1: 1567, 3: 1512})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  126.25490108132362 Time :  4591
accuracy train: 0.742224 val: 0.677612 test: 0.664605
max validation accuracy : 0.689552 max acc epoch : 2 test accuracy : 0.661885
Counter({1: 2487, 2: 1843, 0: 1566, 3: 1504})
Epoch-3 lr: 0.001

Epoch :  4 loss training:  113.0959769487381 Time :  4621
accuracy train: 0.783256 val: 0.695522 test: 0.669552
max validation accuracy : 0.695522 max acc epoch : 4 test accuracy : 0.669552
Counter({3: 2488, 2: 1835, 0: 1616, 1: 1461})
Epoch-4 lr: 0.001

Epoch :  5 loss training:  100.62188124656677 Time :  4650
accuracy train: 0.800794 val: 0.686567 test: 0.691318
max validation accuracy : 0.695522 max acc epoch : 4 test accuracy : 0.669552
Counter({3: 2428, 0: 1945, 2: 1573, 1: 1454})
Epoch-5 lr: 0.001

Epoch :  6 loss training:  91.21382051706314 Time :  4684
accuracy train: 0.800463 val: 0.686567 test: 0.682661
max validation accuracy : 0.695522 max acc epoch : 4 test accuracy : 0.669552
Counter({3: 2416, 2: 1916, 0: 1630, 1: 1438})
Epoch-6 lr: 0.001

Epoch :  7 loss training:  86.54618787765503 Time :  4713
accuracy train: 0.826936 val: 0.692537 test: 0.695770
max validation accuracy : 0.695522 max acc epoch : 4 test accuracy : 0.669552
Counter({2: 2370, 1: 1918, 3: 1695, 0: 1417})
Epoch-7 lr: 0.001

Epoch :  8 loss training:  80.10892656445503 Time :  4741
accuracy train: 0.866645 val: 0.722388 test: 0.705417
max validation accuracy : 0.722388 max acc epoch : 8 test accuracy : 0.705417
Counter({3: 2484, 2: 1906, 1: 1585, 0: 1425})
Epoch-8 lr: 0.001

Epoch :  9 loss training:  70.0575461089611 Time :  4768
accuracy train: 0.879550 val: 0.674627 test: 0.676725
max validation accuracy : 0.722388 max acc epoch : 8 test accuracy : 0.705417
Counter({3: 2410, 0: 1864, 1: 1676, 2: 1450})
Epoch-9 lr: 0.001

Epoch :  10 loss training:  64.51766641438007 Time :  4815
accuracy train: 0.896426 val: 0.719403 test: 0.687856
max validation accuracy : 0.722388 max acc epoch : 8 test accuracy : 0.705417
Counter({1: 2460, 0: 1877, 2: 1592, 3: 1471})

Epoch :  11 loss training:  61.56180192530155 Time :  4844
accuracy train: 0.909332 val: 0.701493 test: 0.679693
max validation accuracy : 0.722388 max acc epoch : 8 test accuracy : 0.705417
Counter({0: 2394, 3: 1821, 2: 1718, 1: 1467})

Epoch :  12 loss training:  50.61872860789299 Time :  4873
accuracy train: 0.949702 val: 0.704478 test: 0.706901
max validation accuracy : 0.722388 max acc epoch : 8 test accuracy : 0.705417
Counter({2: 2365, 3: 1876, 0: 1724, 1: 1435})

Epoch :  13 loss training:  35.393725886940956 Time :  4901
accuracy train: 0.970880 val: 0.704478 test: 0.690329
max validation accuracy : 0.722388 max acc epoch : 8 test accuracy : 0.705417
Counter({3: 2317, 1: 1810, 2: 1799, 0: 1474})

Epoch :  14 loss training:  26.811867281794548 Time :  4946
accuracy train: 0.979153 val: 0.710448 test: 0.698739
max validation accuracy : 0.722388 max acc epoch : 8 test accuracy : 0.705417
Counter({1: 2468, 0: 1831, 3: 1654, 2: 1447})

Epoch :  15 loss training:  18.82109326682985 Time :  4974
accuracy train: 0.991066 val: 0.695522 test: 0.698491
max validation accuracy : 0.722388 max acc epoch : 8 test accuracy : 0.705417
Counter({3: 2431, 0: 1938, 1: 1579, 2: 1452})

Epoch :  16 loss training:  13.180205218493938 Time :  5004
accuracy train: 0.991727 val: 0.731343 test: 0.689587
max validation accuracy : 0.731343 max acc epoch : 16 test accuracy : 0.689587
Counter({2: 2366, 0: 1956, 1: 1703, 3: 1375})

Epoch :  17 loss training:  10.910317434929311 Time :  5033
accuracy train: 0.996691 val: 0.704478 test: 0.695770
max validation accuracy : 0.731343 max acc epoch : 16 test accuracy : 0.689587
Counter({3: 2561, 0: 1907, 1: 1502, 2: 1430})

Epoch :  18 loss training:  8.204667954705656 Time :  5068
accuracy train: 0.997684 val: 0.728358 test: 0.703933
max validation accuracy : 0.731343 max acc epoch : 16 test accuracy : 0.689587
Counter({3: 2454, 2: 1946, 0: 1572, 1: 1428})

Epoch :  19 loss training:  6.68662084126845 Time :  5098
accuracy train: 0.999338 val: 0.734328 test: 0.703933
max validation accuracy : 0.734328 max acc epoch : 19 test accuracy : 0.703933
Counter({3: 2547, 0: 1922, 2: 1503, 1: 1428})

Epoch :  20 loss training:  4.5946776126511395 Time :  5127
accuracy train: 0.999338 val: 0.716418 test: 0.708385
max validation accuracy : 0.734328 max acc epoch : 19 test accuracy : 0.703933
Counter({3: 2411, 2: 2002, 0: 1558, 1: 1429})

Epoch :  21 loss training:  3.362103527644649 Time :  5154
accuracy train: 1.000000 val: 0.737313 test: 0.710858
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({2: 2385, 1: 1864, 0: 1734, 3: 1417})

Epoch :  22 loss training:  4.296843556454405 Time :  5187
accuracy train: 0.997353 val: 0.713433 test: 0.698986
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({2: 2382, 0: 2088, 1: 1508, 3: 1422})

Epoch :  23 loss training:  2.763017073040828 Time :  5218
accuracy train: 0.999669 val: 0.716418 test: 0.711106
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({2: 2361, 1: 2130, 3: 1499, 0: 1410})

Epoch :  24 loss training:  3.222516159177758 Time :  5245
accuracy train: 0.999669 val: 0.692537 test: 0.700965
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({2: 2926, 0: 1994, 1: 1390, 3: 1090})

Epoch :  25 loss training:  3.626141205080785 Time :  5273
accuracy train: 0.999338 val: 0.734328 test: 0.709869
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({1: 2685, 3: 2254, 0: 1378, 2: 1083})

Epoch :  26 loss training:  2.7275585018796846 Time :  5301
accuracy train: 0.999007 val: 0.728358 test: 0.698739
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({1: 2872, 3: 2010, 2: 1368, 0: 1150})

Epoch :  27 loss training:  2.6661416408605874 Time :  5347
accuracy train: 0.999007 val: 0.719403 test: 0.693792
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({3: 2806, 0: 2150, 1: 1370, 2: 1074})

Epoch :  28 loss training:  2.672359968535602 Time :  5374
accuracy train: 0.999669 val: 0.734328 test: 0.704427
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({1: 2868, 2: 2047, 0: 1391, 3: 1094})

Epoch :  29 loss training:  1.8585591309238225 Time :  5403
accuracy train: 0.998676 val: 0.725373 test: 0.688103
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({1: 2371, 3: 2002, 0: 1674, 2: 1353})

Epoch :  30 loss training:  3.3736151437624358 Time :  5433
accuracy train: 0.999338 val: 0.698507 test: 0.686866
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({2: 3101, 3: 1837, 0: 1356, 1: 1106})

Epoch :  31 loss training:  3.8515834474528674 Time :  5473
accuracy train: 1.000000 val: 0.728358 test: 0.696265
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({0: 2194, 2: 2131, 1: 1713, 3: 1362})

Epoch :  32 loss training:  1.659008806629572 Time :  5503
accuracy train: 1.000000 val: 0.725373 test: 0.701954
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({0: 3607, 3: 1373, 2: 1344, 1: 1076})

Epoch :  33 loss training:  1.8500677344709402 Time :  5531
accuracy train: 0.999338 val: 0.725373 test: 0.683651
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({2: 2717, 3: 2205, 0: 1351, 1: 1127})

Epoch :  34 loss training:  1.6592653045081533 Time :  5561
accuracy train: 1.000000 val: 0.719403 test: 0.703438
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({1: 2813, 0: 2175, 3: 1358, 2: 1054})

Epoch :  35 loss training:  1.8136854973854497 Time :  5599
accuracy train: 1.000000 val: 0.716418 test: 0.688845
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({2: 3210, 3: 1780, 1: 1354, 0: 1056})

Epoch :  36 loss training:  1.6663781844545156 Time :  5630
accuracy train: 0.999007 val: 0.734328 test: 0.701212
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({2: 3197, 0: 1749, 3: 1358, 1: 1096})

Epoch :  37 loss training:  0.9068618430901552 Time :  5660
accuracy train: 1.000000 val: 0.716418 test: 0.694286
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({0: 3236, 2: 1752, 1: 1332, 3: 1080})

Epoch :  38 loss training:  1.6000977906369371 Time :  5690
accuracy train: 0.999007 val: 0.698507 test: 0.677715
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({0: 2951, 2: 2036, 3: 1332, 1: 1081})

Epoch :  39 loss training:  3.5631497088324977 Time :  5724
accuracy train: 0.997022 val: 0.704478 test: 0.674004
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({0: 3283, 1: 1746, 2: 1284, 3: 1087})

Epoch :  40 loss training:  7.089522468013456 Time :  5754
accuracy train: 0.985771 val: 0.692537 test: 0.655454
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({0: 3039, 3: 1955, 1: 1336, 2: 1070})

Epoch :  41 loss training:  5.1636264958942775 Time :  5782
accuracy train: 0.998015 val: 0.695522 test: 0.689340
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({2: 3261, 3: 1689, 1: 1303, 0: 1147})

Epoch :  42 loss training:  8.091836264793528 Time :  5809
accuracy train: 0.997022 val: 0.689552 test: 0.664358
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({2: 2235, 0: 1955, 3: 1876, 1: 1334})

Epoch :  43 loss training:  8.246647697407752 Time :  5843
accuracy train: 0.998345 val: 0.719403 test: 0.681177
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({3: 2362, 2: 2007, 0: 1740, 1: 1291})

Epoch :  44 loss training:  6.283548802166479 Time :  5874
accuracy train: 0.998676 val: 0.704478 test: 0.686124
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({1: 3241, 0: 1824, 3: 1271, 2: 1064})

Epoch :  45 loss training:  3.3563798080722336 Time :  5902
accuracy train: 1.000000 val: 0.710448 test: 0.693050
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({3: 2290, 0: 1944, 2: 1899, 1: 1267})

Epoch :  46 loss training:  1.3090077326705796 Time :  5930
accuracy train: 0.999669 val: 0.710448 test: 0.691071
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({2: 3357, 0: 1741, 3: 1294, 1: 1008})

Epoch :  47 loss training:  2.0645282502664486 Time :  5961
accuracy train: 0.999007 val: 0.695522 test: 0.680683
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({2: 3337, 0: 1762, 1: 1278, 3: 1023})

Epoch :  48 loss training:  2.023017567313218 Time :  5994
accuracy train: 0.998015 val: 0.701493 test: 0.684640
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({3: 3371, 0: 1731, 1: 1290, 2: 1008})

Epoch :  49 loss training:  2.917337354607298 Time :  6021
accuracy train: 0.998676 val: 0.692537 test: 0.673757
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({0: 3340, 2: 1711, 3: 1289, 1: 1060})

Epoch :  50 loss training:  2.0748173538850097 Time :  6051
accuracy train: 0.999007 val: 0.701493 test: 0.684393
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({2: 3285, 1: 1867, 3: 1250, 0: 998})

Epoch :  51 loss training:  4.14877456893737 Time :  6079
accuracy train: 0.999007 val: 0.707463 test: 0.672768
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({3: 3755, 2: 1544, 1: 1055, 0: 1046})

Epoch :  52 loss training:  2.142987071769312 Time :  6130
accuracy train: 1.000000 val: 0.692537 test: 0.684145
max validation accuracy : 0.737313 max acc epoch : 21 test accuracy : 0.710858
Counter({1: 3576, 3: 1555, 2: 1196, 0: 1073})

========================================================================================================================================================================================================
best acc epoch :  21
validation accuracy :  0.7373134328358208
test accuracy :  0.7108582735592381
last test_accuracy :  0.6841454365570121
second best val :  0.7343283582089553
second best test :  0.7039327232253277
max gap 8
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=4, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=200, tsne=False, weight_decay=0)
device :  cuda:0
Counter({3: 2083, 2: 1943, 0: 1843, 1: 1531})

Epoch :  1 loss training:  213.29253858327866 Time :  6165
accuracy train: 0.647253 val: 0.591045 test: 0.614395
max validation accuracy : 0.591045 max acc epoch : 1 test accuracy : 0.614395
Counter({0: 2377, 3: 1732, 1: 1699, 2: 1592})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  144.3392835855484 Time :  6191
accuracy train: 0.688948 val: 0.656716 test: 0.643581
max validation accuracy : 0.656716 max acc epoch : 2 test accuracy : 0.643581
Counter({3: 2450, 2: 1768, 0: 1665, 1: 1517})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  122.44441312551498 Time :  6217
accuracy train: 0.734282 val: 0.641791 test: 0.652486
max validation accuracy : 0.656716 max acc epoch : 2 test accuracy : 0.643581
Counter({1: 2499, 3: 1773, 2: 1658, 0: 1470})
Epoch-3 lr: 0.001

Epoch :  4 loss training:  109.67581924796104 Time :  6263
accuracy train: 0.746525 val: 0.650746 test: 0.645560
max validation accuracy : 0.656716 max acc epoch : 2 test accuracy : 0.643581
Counter({1: 2865, 2: 1570, 0: 1558, 3: 1407})
Epoch-4 lr: 0.001

Epoch :  5 loss training:  102.22350278496742 Time :  6290
accuracy train: 0.805758 val: 0.680597 test: 0.674499
max validation accuracy : 0.680597 max acc epoch : 5 test accuracy : 0.674499
Counter({0: 2284, 1: 1844, 3: 1785, 2: 1487})
Epoch-5 lr: 0.001

Epoch :  6 loss training:  95.06433403491974 Time :  6316
accuracy train: 0.816678 val: 0.683582 test: 0.679199
max validation accuracy : 0.683582 max acc epoch : 6 test accuracy : 0.679199
Counter({1: 2952, 2: 1538, 3: 1526, 0: 1384})
Epoch-6 lr: 0.001

Epoch :  7 loss training:  81.28551386296749 Time :  6343
accuracy train: 0.825612 val: 0.680597 test: 0.680930
max validation accuracy : 0.683582 max acc epoch : 6 test accuracy : 0.679199
Counter({2: 2398, 0: 1771, 3: 1738, 1: 1493})
Epoch-7 lr: 0.001

Epoch :  8 loss training:  78.03810846805573 Time :  6373
accuracy train: 0.857710 val: 0.695522 test: 0.679446
max validation accuracy : 0.695522 max acc epoch : 8 test accuracy : 0.679446
Counter({1: 2905, 2: 1576, 0: 1460, 3: 1459})
Epoch-8 lr: 0.001

Epoch :  9 loss training:  72.07257424294949 Time :  6403
accuracy train: 0.881535 val: 0.713433 test: 0.693792
max validation accuracy : 0.713433 max acc epoch : 9 test accuracy : 0.693792
Counter({3: 2401, 1: 1801, 2: 1725, 0: 1473})
Epoch-9 lr: 0.001

Epoch :  10 loss training:  66.44066867232323 Time :  6432
accuracy train: 0.881535 val: 0.692537 test: 0.696265
max validation accuracy : 0.713433 max acc epoch : 9 test accuracy : 0.693792
Counter({2: 2470, 1: 1956, 3: 1493, 0: 1481})

Epoch :  11 loss training:  57.99454703181982 Time :  6461
accuracy train: 0.912641 val: 0.683582 test: 0.691071
max validation accuracy : 0.713433 max acc epoch : 9 test accuracy : 0.693792
Counter({1: 2623, 0: 1851, 3: 1467, 2: 1459})

Epoch :  12 loss training:  47.20989626646042 Time :  6488
accuracy train: 0.944408 val: 0.725373 test: 0.702449
max validation accuracy : 0.725373 max acc epoch : 12 test accuracy : 0.702449
Counter({1: 2615, 2: 1782, 3: 1527, 0: 1476})

Epoch :  13 loss training:  36.89766300469637 Time :  6541
accuracy train: 0.964593 val: 0.710448 test: 0.706159
max validation accuracy : 0.725373 max acc epoch : 12 test accuracy : 0.702449
Counter({3: 2903, 0: 1800, 2: 1463, 1: 1234})

Epoch :  14 loss training:  26.381133928894997 Time :  6570
accuracy train: 0.976506 val: 0.737313 test: 0.702943
max validation accuracy : 0.737313 max acc epoch : 14 test accuracy : 0.702943
Counter({0: 3045, 2: 1672, 1: 1464, 3: 1219})

Epoch :  15 loss training:  19.89247744716704 Time :  6599
accuracy train: 0.994044 val: 0.725373 test: 0.705664
max validation accuracy : 0.737313 max acc epoch : 14 test accuracy : 0.702943
Counter({0: 3326, 1: 1446, 3: 1420, 2: 1208})

Epoch :  16 loss training:  14.093942357227206 Time :  6630
accuracy train: 0.995036 val: 0.734328 test: 0.702201
max validation accuracy : 0.737313 max acc epoch : 14 test accuracy : 0.702943
Counter({0: 3220, 1: 1643, 2: 1381, 3: 1156})

Epoch :  17 loss training:  9.898073613643646 Time :  6671
accuracy train: 0.995698 val: 0.749254 test: 0.713332
max validation accuracy : 0.749254 max acc epoch : 17 test accuracy : 0.713332
Counter({0: 3132, 1: 1687, 2: 1416, 3: 1165})

Epoch :  18 loss training:  7.489857137668878 Time :  6699
accuracy train: 0.997022 val: 0.722388 test: 0.709869
max validation accuracy : 0.749254 max acc epoch : 17 test accuracy : 0.713332
Counter({0: 3206, 1: 1618, 2: 1416, 3: 1160})

Epoch :  19 loss training:  7.691964603960514 Time :  6726
accuracy train: 0.998676 val: 0.731343 test: 0.705417
max validation accuracy : 0.749254 max acc epoch : 17 test accuracy : 0.713332
Counter({3: 3292, 1: 1559, 0: 1408, 2: 1141})

Epoch :  20 loss training:  5.93745024735108 Time :  6754
accuracy train: 0.999338 val: 0.737313 test: 0.712095
max validation accuracy : 0.749254 max acc epoch : 17 test accuracy : 0.713332
Counter({2: 3329, 0: 1533, 1: 1400, 3: 1138})

Epoch :  21 loss training:  3.6215232794638723 Time :  6787
accuracy train: 1.000000 val: 0.740299 test: 0.716052
max validation accuracy : 0.749254 max acc epoch : 17 test accuracy : 0.713332
Counter({1: 3449, 0: 1401, 3: 1396, 2: 1154})

Epoch :  22 loss training:  3.132353008259088 Time :  6816
accuracy train: 0.999007 val: 0.737313 test: 0.701954
max validation accuracy : 0.749254 max acc epoch : 17 test accuracy : 0.713332
Counter({3: 3394, 0: 1475, 1: 1385, 2: 1146})

Epoch :  23 loss training:  2.326526637072675 Time :  6844
accuracy train: 0.999007 val: 0.746269 test: 0.714321
max validation accuracy : 0.749254 max acc epoch : 17 test accuracy : 0.713332
Counter({3: 3437, 0: 1416, 2: 1392, 1: 1155})

Epoch :  24 loss training:  3.656729709065985 Time :  6874
accuracy train: 0.999338 val: 0.719403 test: 0.718526
max validation accuracy : 0.749254 max acc epoch : 17 test accuracy : 0.713332
Counter({0: 3276, 2: 1553, 3: 1417, 1: 1154})

Epoch :  25 loss training:  3.3090156819671392 Time :  6903
accuracy train: 0.998015 val: 0.752239 test: 0.697997
max validation accuracy : 0.752239 max acc epoch : 25 test accuracy : 0.697997
Counter({2: 3400, 0: 1427, 3: 1378, 1: 1195})

Epoch :  26 loss training:  2.939717202913016 Time :  6941
accuracy train: 1.000000 val: 0.758209 test: 0.714074
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({0: 3441, 1: 1443, 2: 1369, 3: 1147})

Epoch :  27 loss training:  1.175376266706735 Time :  6970
accuracy train: 1.000000 val: 0.740299 test: 0.713579
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({2: 3468, 3: 1462, 1: 1356, 0: 1114})

Epoch :  28 loss training:  2.317343697475735 Time :  6997
accuracy train: 0.998676 val: 0.731343 test: 0.705664
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({2: 3577, 0: 1368, 1: 1348, 3: 1107})

Epoch :  29 loss training:  2.811601516965311 Time :  7025
accuracy train: 1.000000 val: 0.749254 test: 0.708385
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({1: 3106, 3: 1797, 0: 1373, 2: 1124})

Epoch :  30 loss training:  2.1296828660124447 Time :  7077
accuracy train: 1.000000 val: 0.731343 test: 0.713332
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({1: 3636, 3: 1363, 0: 1297, 2: 1104})

Epoch :  31 loss training:  2.6216521756723523 Time :  7106
accuracy train: 0.995367 val: 0.722388 test: 0.693297
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({2: 3438, 3: 1510, 0: 1329, 1: 1123})

Epoch :  32 loss training:  3.948727923911065 Time :  7134
accuracy train: 0.999007 val: 0.713433 test: 0.708138
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({0: 3557, 3: 1393, 2: 1366, 1: 1084})

Epoch :  33 loss training:  3.4655859112972394 Time :  7163
accuracy train: 0.998345 val: 0.725373 test: 0.701707
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({0: 3520, 1: 1478, 2: 1323, 3: 1079})

Epoch :  34 loss training:  2.43920828125556 Time :  7194
accuracy train: 0.999338 val: 0.740299 test: 0.691071
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({0: 3661, 3: 1349, 1: 1324, 2: 1066})

Epoch :  35 loss training:  2.7062788871407975 Time :  7222
accuracy train: 0.998676 val: 0.701493 test: 0.692308
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({0: 3652, 1: 1393, 3: 1268, 2: 1087})

Epoch :  36 loss training:  3.8645630486425944 Time :  7253
accuracy train: 1.000000 val: 0.728358 test: 0.706406
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({1: 3514, 0: 1513, 3: 1310, 2: 1063})

Epoch :  37 loss training:  4.004154966300121 Time :  7282
accuracy train: 0.999338 val: 0.728358 test: 0.703685
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({3: 3447, 2: 1341, 1: 1310, 0: 1302})

Epoch :  38 loss training:  2.958381649979856 Time :  7311
accuracy train: 0.999338 val: 0.740299 test: 0.694534
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({0: 2771, 3: 2178, 1: 1350, 2: 1101})

Epoch :  39 loss training:  3.74235717751435 Time :  7341
accuracy train: 0.998345 val: 0.731343 test: 0.694781
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({1: 3647, 0: 1421, 3: 1288, 2: 1044})

Epoch :  40 loss training:  3.7018590761581436 Time :  7372
accuracy train: 0.995698 val: 0.707463 test: 0.691071
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({2: 3303, 3: 1729, 1: 1314, 0: 1054})

Epoch :  41 loss training:  4.384008561872179 Time :  7402
accuracy train: 0.999669 val: 0.713433 test: 0.701954
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({0: 3140, 1: 1865, 2: 1320, 3: 1075})

Epoch :  42 loss training:  2.647342456271872 Time :  7471
accuracy train: 0.999669 val: 0.728358 test: 0.692802
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({0: 3747, 2: 1300, 1: 1285, 3: 1068})

Epoch :  43 loss training:  4.968328548624413 Time :  7532
accuracy train: 0.996360 val: 0.719403 test: 0.682909
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({0: 3569, 1: 1406, 3: 1310, 2: 1115})

Epoch :  44 loss training:  3.884759645559825 Time :  7562
accuracy train: 0.998676 val: 0.704478 test: 0.690576
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({0: 3524, 2: 1548, 3: 1286, 1: 1042})

Epoch :  45 loss training:  4.744268557056785 Time :  7591
accuracy train: 0.995036 val: 0.689552 test: 0.696018
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({1: 3739, 0: 1311, 3: 1272, 2: 1078})

Epoch :  46 loss training:  5.366304469614988 Time :  7626
accuracy train: 0.998015 val: 0.728358 test: 0.699728
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({0: 3615, 3: 1475, 1: 1291, 2: 1019})

Epoch :  47 loss training:  4.7389580997260055 Time :  7656
accuracy train: 1.000000 val: 0.734328 test: 0.700223
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({1: 3783, 3: 1362, 0: 1257, 2: 998})

Epoch :  48 loss training:  3.622706496884348 Time :  7685
accuracy train: 0.998676 val: 0.713433 test: 0.688350
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({3: 3493, 0: 1600, 1: 1243, 2: 1064})

Epoch :  49 loss training:  1.9471009740955196 Time :  7713
accuracy train: 1.000000 val: 0.710448 test: 0.693792
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({3: 3654, 0: 1505, 1: 1193, 2: 1048})

Epoch :  50 loss training:  0.6596309039741755 Time :  7746
accuracy train: 1.000000 val: 0.725373 test: 0.701212
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({0: 3625, 1: 1559, 2: 1171, 3: 1045})

Epoch :  51 loss training:  0.39844978613837156 Time :  7776
accuracy train: 1.000000 val: 0.734328 test: 0.703933
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({3: 3505, 1: 1621, 2: 1204, 0: 1070})

Epoch :  52 loss training:  0.590694091966725 Time :  7807
accuracy train: 1.000000 val: 0.722388 test: 0.713826
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({3: 3511, 0: 1580, 2: 1242, 1: 1067})

Epoch :  53 loss training:  0.20391633005056065 Time :  7835
accuracy train: 1.000000 val: 0.728358 test: 0.711106
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({0: 3564, 2: 1539, 1: 1228, 3: 1069})

Epoch :  54 loss training:  0.2198578043098678 Time :  7868
accuracy train: 1.000000 val: 0.731343 test: 0.712095
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({0: 3865, 1: 1265, 3: 1201, 2: 1069})

Epoch :  55 loss training:  0.29342021345837566 Time :  7899
accuracy train: 1.000000 val: 0.728358 test: 0.713332
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({2: 3861, 1: 1268, 3: 1202, 0: 1069})

Epoch :  56 loss training:  0.1206937440620095 Time :  7929
accuracy train: 1.000000 val: 0.716418 test: 0.709869
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({1: 3832, 3: 1300, 0: 1194, 2: 1074})

Epoch :  57 loss training:  0.4605537788120273 Time :  7959
accuracy train: 0.999669 val: 0.713433 test: 0.695028
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.714074
Counter({1: 3879, 3: 1302, 2: 1181, 0: 1038})

========================================================================================================================================================================================================
best acc epoch :  26
validation accuracy :  0.7582089552238805
test accuracy :  0.7140737076428395
last test_accuracy :  0.6950284442245857
second best val :  0.7522388059701492
second best test :  0.697996537224833
max gap 8
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  21 	 val_accuracy : 0.73134 	 test_accuracy : 0.72050 	 last test_accuracy : 0.69874 	 second best val : 0.71940 	 second best test : 0.72050
k :  1 	 best_acc epoch :  30 	 val_accuracy : 0.69254 	 test_accuracy : 0.70319 	 last test_accuracy : 0.69800 	 second best val : 0.68657 	 second best test : 0.70838
k :  2 	 best_acc epoch :  21 	 val_accuracy : 0.73731 	 test_accuracy : 0.71086 	 last test_accuracy : 0.68415 	 second best val : 0.73433 	 second best test : 0.70393
k :  3 	 best_acc epoch :  26 	 val_accuracy : 0.75821 	 test_accuracy : 0.71407 	 last test_accuracy : 0.69503 	 second best val : 0.75224 	 second best test : 0.69800

avg :  	 val_accuracy : 0.72985 	 test_accuracy : 0.71216 	 last_accuracy : 0.69398 	 second best val : 0.72313 	 second best test : 0.70770

std :  	 val_accuracy : 0.02374 	 test_accuracy : 0.00623 	 last_accuracy : 0.00584 	 second best val : 0.02410 	 second best test : 0.00826


date and time :  Tue Jun 15 02:35:17 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=8, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=727, tsne=False, weight_decay=0)
device :  cuda:0
Counter({6: 1189, 0: 1163, 2: 1058, 3: 1024, 5: 863, 1: 851, 7: 680, 4: 572})

Epoch :  1 loss training:  212.03287160396576 Time :  55
accuracy train: 0.655195 val: 0.656716 test: 0.614890
max validation accuracy : 0.656716 max acc epoch : 1 test accuracy : 0.614890
Counter({6: 1508, 0: 1148, 2: 1069, 5: 1019, 7: 785, 4: 753, 3: 727, 1: 391})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  142.0058107972145 Time :  90
accuracy train: 0.721046 val: 0.701493 test: 0.662627
max validation accuracy : 0.701493 max acc epoch : 2 test accuracy : 0.662627
Counter({2: 1451, 1: 1143, 6: 1004, 3: 941, 4: 857, 7: 828, 5: 809, 0: 367})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  118.82742717862129 Time :  119
accuracy train: 0.703177 val: 0.665672 test: 0.642839
max validation accuracy : 0.701493 max acc epoch : 2 test accuracy : 0.662627
Counter({4: 1465, 0: 1166, 2: 1041, 7: 851, 1: 776, 3: 734, 5: 696, 6: 671})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.17831486463547 Time :  157
accuracy train: 0.798147 val: 0.728358 test: 0.695523
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.695523
Counter({1: 1419, 3: 1207, 4: 1197, 2: 1119, 0: 772, 5: 740, 7: 499, 6: 447})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  86.6323211491108 Time :  194
accuracy train: 0.816016 val: 0.719403 test: 0.696512
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.695523
Counter({1: 1391, 2: 1094, 3: 1075, 7: 863, 5: 823, 6: 759, 4: 715, 0: 680})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  85.40124824643135 Time :  227
accuracy train: 0.818001 val: 0.719403 test: 0.693050
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.695523
Counter({4: 1390, 1: 1100, 2: 1040, 5: 859, 6: 837, 3: 796, 7: 693, 0: 685})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  72.02801150083542 Time :  261
accuracy train: 0.837525 val: 0.734328 test: 0.700717
max validation accuracy : 0.734328 max acc epoch : 7 test accuracy : 0.700717
Counter({4: 1381, 7: 1276, 3: 1132, 5: 1069, 2: 789, 0: 723, 1: 654, 6: 376})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.23836782574654 Time :  295
accuracy train: 0.855394 val: 0.740299 test: 0.709127
max validation accuracy : 0.740299 max acc epoch : 8 test accuracy : 0.709127
Counter({3: 1364, 2: 1262, 0: 1141, 1: 1078, 5: 816, 7: 720, 6: 651, 4: 368})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.16257536411285 Time :  327
accuracy train: 0.869623 val: 0.728358 test: 0.712837
max validation accuracy : 0.740299 max acc epoch : 8 test accuracy : 0.709127
Counter({5: 1374, 3: 1255, 2: 1147, 4: 1072, 0: 805, 1: 710, 7: 670, 6: 367})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  58.85099798440933 Time :  361
accuracy train: 0.879550 val: 0.740299 test: 0.713332
max validation accuracy : 0.740299 max acc epoch : 8 test accuracy : 0.709127
Counter({7: 1374, 1: 1253, 2: 1159, 6: 1070, 3: 800, 5: 711, 0: 665, 4: 368})

Epoch :  11 loss training:  57.97902092337608 Time :  394
accuracy train: 0.896095 val: 0.734328 test: 0.710116
max validation accuracy : 0.740299 max acc epoch : 8 test accuracy : 0.709127
Counter({1: 1377, 5: 1258, 4: 1162, 3: 1068, 6: 800, 7: 692, 2: 673, 0: 370})

Epoch :  12 loss training:  53.01624462008476 Time :  426
accuracy train: 0.901390 val: 0.749254 test: 0.714568
max validation accuracy : 0.749254 max acc epoch : 12 test accuracy : 0.714568
Counter({6: 1372, 1: 1252, 3: 1159, 2: 1071, 7: 806, 0: 692, 4: 678, 5: 370})

Epoch :  13 loss training:  51.55185033380985 Time :  467
accuracy train: 0.904368 val: 0.752239 test: 0.710611
max validation accuracy : 0.752239 max acc epoch : 13 test accuracy : 0.710611
Counter({1: 1366, 6: 1251, 3: 1165, 0: 1066, 5: 806, 4: 692, 2: 683, 7: 371})

Epoch :  14 loss training:  48.521637961268425 Time :  503
accuracy train: 0.918928 val: 0.749254 test: 0.716794
max validation accuracy : 0.752239 max acc epoch : 13 test accuracy : 0.710611
Counter({6: 1365, 5: 1256, 1: 1163, 4: 1073, 0: 802, 7: 692, 3: 677, 2: 372})

Epoch :  15 loss training:  45.68356528878212 Time :  535
accuracy train: 0.932495 val: 0.752239 test: 0.718279
max validation accuracy : 0.752239 max acc epoch : 13 test accuracy : 0.710611
Counter({2: 1364, 3: 1255, 4: 1157, 1: 1077, 6: 801, 7: 686, 0: 685, 5: 375})

Epoch :  16 loss training:  42.72886933386326 Time :  570
accuracy train: 0.934480 val: 0.749254 test: 0.716300
max validation accuracy : 0.752239 max acc epoch : 13 test accuracy : 0.710611
Counter({3: 1367, 6: 1251, 7: 1160, 4: 1081, 0: 802, 2: 683, 5: 680, 1: 376})

Epoch :  17 loss training:  39.3482351526618 Time :  604
accuracy train: 0.941430 val: 0.752239 test: 0.714816
max validation accuracy : 0.752239 max acc epoch : 13 test accuracy : 0.710611
Counter({5: 1364, 4: 1253, 7: 1159, 6: 1071, 3: 805, 2: 690, 1: 681, 0: 377})

Epoch :  18 loss training:  37.95439714193344 Time :  641
accuracy train: 0.952019 val: 0.758209 test: 0.719515
max validation accuracy : 0.758209 max acc epoch : 18 test accuracy : 0.719515
Counter({4: 1365, 0: 1253, 7: 1163, 2: 1076, 6: 798, 3: 689, 1: 677, 5: 379})

Epoch :  19 loss training:  36.29735404998064 Time :  677
accuracy train: 0.953673 val: 0.770149 test: 0.714074
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({3: 1366, 4: 1256, 2: 1160, 0: 1076, 7: 796, 1: 694, 6: 669, 5: 383})

Epoch :  20 loss training:  33.26396147161722 Time :  732
accuracy train: 0.953342 val: 0.758209 test: 0.714321
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({4: 1368, 2: 1245, 0: 1166, 3: 1075, 7: 796, 1: 703, 5: 665, 6: 382})

Epoch :  21 loss training:  31.718388456851244 Time :  769
accuracy train: 0.964262 val: 0.746269 test: 0.720505
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({3: 1367, 5: 1255, 1: 1163, 2: 1075, 6: 797, 7: 701, 0: 659, 4: 383})

Epoch :  22 loss training:  29.487040109932423 Time :  802
accuracy train: 0.971211 val: 0.764179 test: 0.722483
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({1: 1364, 6: 1260, 7: 1168, 2: 1076, 3: 791, 0: 708, 5: 650, 4: 383})

Epoch :  23 loss training:  25.839655105024576 Time :  837
accuracy train: 0.973197 val: 0.743284 test: 0.717536
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({4: 1363, 1: 1262, 0: 1180, 3: 1077, 2: 787, 6: 698, 7: 647, 5: 386})

Epoch :  24 loss training:  25.017541345208883 Time :  881
accuracy train: 0.979153 val: 0.761194 test: 0.719763
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({6: 1364, 3: 1261, 7: 1179, 5: 1079, 4: 789, 1: 694, 2: 647, 0: 387})

Epoch :  25 loss training:  23.503413047641516 Time :  916
accuracy train: 0.978160 val: 0.755224 test: 0.719268
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({2: 1359, 1: 1258, 3: 1176, 7: 1083, 4: 792, 5: 692, 6: 652, 0: 388})

Epoch :  26 loss training:  22.42708895355463 Time :  949
accuracy train: 0.978491 val: 0.746269 test: 0.720752
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({4: 1358, 2: 1264, 3: 1175, 1: 1080, 6: 792, 7: 692, 5: 651, 0: 388})

Epoch :  27 loss training:  19.64771071076393 Time :  989
accuracy train: 0.981469 val: 0.761194 test: 0.722236
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({4: 1355, 1: 1262, 2: 1168, 6: 1080, 0: 790, 5: 706, 3: 651, 7: 388})

Epoch :  28 loss training:  18.928977634757757 Time :  1025
accuracy train: 0.984778 val: 0.746269 test: 0.722978
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({1: 1352, 0: 1262, 6: 1167, 7: 1079, 3: 785, 2: 713, 4: 652, 5: 390})

Epoch :  29 loss training:  18.642203260213137 Time :  1063
accuracy train: 0.985440 val: 0.752239 test: 0.718526
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({5: 1351, 3: 1256, 7: 1166, 2: 1086, 0: 774, 1: 724, 4: 650, 6: 393})

Epoch :  30 loss training:  16.87712935730815 Time :  1097
accuracy train: 0.989411 val: 0.758209 test: 0.719763
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({7: 1350, 1: 1256, 5: 1168, 4: 1090, 2: 776, 3: 724, 6: 643, 0: 393})

Epoch :  31 loss training:  15.418176164850593 Time :  1147
accuracy train: 0.994044 val: 0.764179 test: 0.717784
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({0: 1333, 6: 1253, 3: 1170, 2: 1084, 4: 773, 1: 750, 7: 645, 5: 392})

Epoch :  32 loss training:  14.61222043633461 Time :  1181
accuracy train: 0.992720 val: 0.752239 test: 0.724957
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({7: 1334, 0: 1249, 1: 1165, 2: 1090, 6: 773, 4: 755, 5: 640, 3: 394})

Epoch :  33 loss training:  13.184570897370577 Time :  1218
accuracy train: 0.993713 val: 0.761194 test: 0.720010
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({5: 1333, 6: 1247, 0: 1161, 3: 1091, 2: 774, 7: 759, 1: 641, 4: 394})

Epoch :  34 loss training:  12.883134845644236 Time :  1254
accuracy train: 0.994705 val: 0.752239 test: 0.722483
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({6: 1327, 2: 1251, 1: 1153, 5: 1091, 4: 770, 0: 766, 3: 647, 7: 395})

Epoch :  35 loss training:  11.243060160428286 Time :  1311
accuracy train: 0.995367 val: 0.761194 test: 0.718031
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({0: 1325, 7: 1256, 4: 1152, 3: 1090, 2: 772, 5: 768, 1: 642, 6: 395})

Epoch :  36 loss training:  11.425038073211908 Time :  1343
accuracy train: 0.995698 val: 0.749254 test: 0.719763
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({0: 1324, 6: 1249, 7: 1149, 1: 1092, 5: 775, 2: 771, 4: 645, 3: 395})

Epoch :  37 loss training:  10.439053038135171 Time :  1378
accuracy train: 0.997022 val: 0.734328 test: 0.718279
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({0: 1324, 4: 1235, 1: 1148, 2: 1091, 5: 792, 3: 773, 6: 643, 7: 394})

Epoch :  38 loss training:  9.4343042653054 Time :  1412
accuracy train: 0.997022 val: 0.749254 test: 0.722483
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({3: 1322, 4: 1238, 2: 1149, 6: 1094, 0: 789, 1: 768, 7: 645, 5: 395})

Epoch :  39 loss training:  9.042958698235452 Time :  1456
accuracy train: 0.996691 val: 0.752239 test: 0.719763
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({4: 1321, 3: 1246, 5: 1145, 1: 1095, 7: 788, 0: 765, 6: 643, 2: 397})

Epoch :  40 loss training:  8.778316264040768 Time :  1491
accuracy train: 0.996029 val: 0.755224 test: 0.714816
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({5: 1322, 2: 1247, 3: 1151, 4: 1093, 7: 790, 1: 762, 0: 637, 6: 398})

Epoch :  41 loss training:  7.479725471697748 Time :  1522
accuracy train: 0.997022 val: 0.758209 test: 0.725946
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({1: 1314, 5: 1249, 4: 1146, 7: 1091, 3: 799, 2: 762, 0: 640, 6: 399})

Epoch :  42 loss training:  8.402181296609342 Time :  1557
accuracy train: 0.998345 val: 0.755224 test: 0.717289
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({4: 1311, 1: 1250, 5: 1138, 6: 1095, 7: 805, 3: 761, 2: 641, 0: 399})

Epoch :  43 loss training:  6.63732225028798 Time :  1610
accuracy train: 0.998676 val: 0.734328 test: 0.716300
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({0: 1303, 7: 1251, 1: 1142, 2: 1097, 5: 823, 6: 758, 4: 626, 3: 400})

Epoch :  44 loss training:  6.319600825663656 Time :  1647
accuracy train: 0.999007 val: 0.749254 test: 0.716547
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({5: 1300, 0: 1256, 6: 1129, 2: 1089, 1: 841, 4: 750, 7: 633, 3: 402})

Epoch :  45 loss training:  5.926632544025779 Time :  1681
accuracy train: 0.999007 val: 0.752239 test: 0.715558
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({7: 1293, 5: 1256, 4: 1124, 6: 1090, 2: 857, 3: 747, 1: 631, 0: 402})

Epoch :  46 loss training:  5.253632373176515 Time :  1713
accuracy train: 0.998345 val: 0.764179 test: 0.719515
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({2: 1295, 4: 1254, 1: 1122, 3: 1099, 6: 854, 0: 743, 5: 630, 7: 403})

Epoch :  47 loss training:  5.610709281638265 Time :  1754
accuracy train: 0.998676 val: 0.749254 test: 0.716547
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({0: 1294, 4: 1251, 1: 1117, 3: 1097, 5: 869, 6: 739, 7: 632, 2: 401})

Epoch :  48 loss training:  5.920053516048938 Time :  1786
accuracy train: 0.999338 val: 0.764179 test: 0.715063
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({0: 1292, 4: 1245, 2: 1121, 7: 1096, 5: 874, 3: 739, 6: 631, 1: 402})

Epoch :  49 loss training:  4.3524534474126995 Time :  1821
accuracy train: 0.999007 val: 0.752239 test: 0.717784
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({5: 1291, 7: 1244, 1: 1121, 0: 1094, 3: 877, 2: 741, 4: 630, 6: 402})

Epoch :  50 loss training:  4.774811168201268 Time :  1856
accuracy train: 0.998676 val: 0.749254 test: 0.716300
max validation accuracy : 0.770149 max acc epoch : 19 test accuracy : 0.714074
Counter({3: 1289, 5: 1244, 4: 1119, 1: 1096, 2: 881, 7: 736, 6: 635, 0: 400})

========================================================================================================================================================================================================
best acc epoch :  19
validation accuracy :  0.7701492537313432
test accuracy :  0.7140737076428395
last test_accuracy :  0.716299777393025
second best val :  0.764179104477612
second best test :  0.7140737076428395
max gap 5
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=8, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=141, tsne=False, weight_decay=0)
device :  cuda:0
Counter({5: 1115, 4: 1045, 1: 1028, 2: 1013, 7: 997, 3: 784, 0: 748, 6: 670})

Epoch :  1 loss training:  209.42530250549316 Time :  1919
accuracy train: 0.643283 val: 0.626866 test: 0.611427
max validation accuracy : 0.626866 max acc epoch : 1 test accuracy : 0.611427
Counter({2: 1561, 3: 1145, 0: 932, 1: 926, 5: 864, 4: 811, 7: 768, 6: 393})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  144.8056379854679 Time :  1951
accuracy train: 0.698213 val: 0.644776 test: 0.640119
max validation accuracy : 0.644776 max acc epoch : 2 test accuracy : 0.640119
Counter({2: 1515, 5: 1146, 7: 919, 6: 861, 4: 855, 3: 768, 1: 761, 0: 575})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  124.51510348916054 Time :  1985
accuracy train: 0.756784 val: 0.692537 test: 0.655454
max validation accuracy : 0.692537 max acc epoch : 3 test accuracy : 0.655454
Counter({0: 1475, 3: 1110, 7: 1041, 5: 878, 2: 860, 1: 763, 6: 676, 4: 597})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  99.25086596608162 Time :  2026
accuracy train: 0.789543 val: 0.704478 test: 0.678457
max validation accuracy : 0.704478 max acc epoch : 4 test accuracy : 0.678457
Counter({7: 1457, 2: 1169, 4: 968, 1: 844, 0: 834, 5: 783, 3: 702, 6: 643})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  89.56653860211372 Time :  2061
accuracy train: 0.816016 val: 0.692537 test: 0.689092
max validation accuracy : 0.704478 max acc epoch : 4 test accuracy : 0.678457
Counter({3: 1463, 4: 1167, 2: 954, 5: 841, 1: 832, 0: 781, 6: 695, 7: 667})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  83.48675641417503 Time :  2092
accuracy train: 0.835870 val: 0.710448 test: 0.695276
max validation accuracy : 0.710448 max acc epoch : 6 test accuracy : 0.695276
Counter({1: 1417, 6: 1183, 4: 960, 7: 900, 0: 883, 2: 775, 5: 643, 3: 639})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  73.74768881499767 Time :  2123
accuracy train: 0.856056 val: 0.710448 test: 0.712095
max validation accuracy : 0.710448 max acc epoch : 6 test accuracy : 0.695276
Counter({5: 1416, 2: 1165, 4: 962, 7: 931, 3: 851, 6: 778, 1: 664, 0: 633})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.00767374038696 Time :  2157
accuracy train: 0.867306 val: 0.734328 test: 0.718031
max validation accuracy : 0.734328 max acc epoch : 8 test accuracy : 0.718031
Counter({4: 1414, 1: 1163, 0: 966, 6: 927, 5: 850, 2: 784, 3: 670, 7: 626})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.97846092283726 Time :  2187
accuracy train: 0.864990 val: 0.710448 test: 0.708385
max validation accuracy : 0.734328 max acc epoch : 8 test accuracy : 0.718031
Counter({1: 1416, 0: 1150, 2: 965, 4: 923, 5: 861, 6: 831, 7: 646, 3: 608})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.1789885610342 Time :  2218
accuracy train: 0.878557 val: 0.731343 test: 0.713579
max validation accuracy : 0.734328 max acc epoch : 8 test accuracy : 0.718031
Counter({3: 1421, 5: 1146, 1: 952, 0: 904, 7: 861, 2: 835, 6: 649, 4: 632})

Epoch :  11 loss training:  56.62496779859066 Time :  2248
accuracy train: 0.893117 val: 0.719403 test: 0.720505
max validation accuracy : 0.734328 max acc epoch : 8 test accuracy : 0.718031
Counter({3: 1423, 7: 1134, 4: 962, 2: 907, 1: 848, 0: 830, 5: 662, 6: 634})

Epoch :  12 loss training:  55.49292266368866 Time :  2280
accuracy train: 0.895433 val: 0.725373 test: 0.717536
max validation accuracy : 0.734328 max acc epoch : 8 test accuracy : 0.718031
Counter({5: 1424, 6: 1134, 4: 960, 1: 908, 2: 846, 0: 834, 7: 661, 3: 633})

Epoch :  13 loss training:  51.8149710893631 Time :  2316
accuracy train: 0.907677 val: 0.737313 test: 0.713826
max validation accuracy : 0.737313 max acc epoch : 13 test accuracy : 0.713826
Counter({6: 1427, 2: 1122, 0: 957, 3: 906, 1: 854, 7: 843, 4: 655, 5: 636})

Epoch :  14 loss training:  46.48324313759804 Time :  2350
accuracy train: 0.920582 val: 0.731343 test: 0.717289
max validation accuracy : 0.737313 max acc epoch : 13 test accuracy : 0.713826
Counter({2: 1425, 4: 1127, 7: 968, 6: 898, 3: 852, 5: 843, 1: 660, 0: 627})

Epoch :  15 loss training:  46.34826980531216 Time :  2381
accuracy train: 0.930510 val: 0.749254 test: 0.717784
max validation accuracy : 0.749254 max acc epoch : 15 test accuracy : 0.717784
Counter({3: 1421, 6: 1122, 5: 970, 0: 895, 1: 858, 7: 853, 4: 652, 2: 629})

Epoch :  16 loss training:  43.11030387878418 Time :  2417
accuracy train: 0.934811 val: 0.737313 test: 0.718031
max validation accuracy : 0.749254 max acc epoch : 15 test accuracy : 0.717784
Counter({3: 1424, 5: 1113, 7: 977, 6: 904, 4: 859, 2: 847, 1: 646, 0: 630})

Epoch :  17 loss training:  40.673488453030586 Time :  2449
accuracy train: 0.941760 val: 0.728358 test: 0.720999
max validation accuracy : 0.749254 max acc epoch : 15 test accuracy : 0.717784
Counter({1: 1422, 2: 1112, 7: 1001, 4: 929, 5: 855, 0: 844, 6: 651, 3: 586})

Epoch :  18 loss training:  39.1628335416317 Time :  2483
accuracy train: 0.939113 val: 0.728358 test: 0.719268
max validation accuracy : 0.749254 max acc epoch : 15 test accuracy : 0.717784
Counter({6: 1420, 3: 1117, 1: 1008, 4: 935, 7: 845, 0: 839, 5: 656, 2: 580})

Epoch :  19 loss training:  35.96429705619812 Time :  2514
accuracy train: 0.954004 val: 0.755224 test: 0.720257
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({1: 1427, 0: 1120, 7: 1011, 3: 925, 2: 841, 4: 839, 6: 656, 5: 581})

Epoch :  20 loss training:  33.94336422532797 Time :  2552
accuracy train: 0.956982 val: 0.752239 test: 0.720999
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({7: 1428, 1: 1127, 2: 1009, 5: 921, 4: 842, 3: 840, 6: 653, 0: 580})

Epoch :  21 loss training:  30.475492373108864 Time :  2583
accuracy train: 0.961615 val: 0.746269 test: 0.724215
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({6: 1429, 0: 1127, 7: 1020, 2: 932, 5: 843, 3: 841, 4: 644, 1: 564})

Epoch :  22 loss training:  30.21970222890377 Time :  2617
accuracy train: 0.968233 val: 0.731343 test: 0.721741
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({2: 1426, 3: 1124, 1: 1037, 7: 940, 0: 856, 4: 840, 6: 645, 5: 532})

Epoch :  23 loss training:  28.083099633455276 Time :  2648
accuracy train: 0.965255 val: 0.734328 test: 0.720010
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({1: 1423, 4: 1129, 3: 1038, 6: 944, 7: 858, 0: 844, 2: 645, 5: 519})

Epoch :  24 loss training:  26.70030951499939 Time :  2691
accuracy train: 0.969226 val: 0.728358 test: 0.720999
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({1: 1424, 4: 1125, 2: 1063, 7: 949, 6: 869, 5: 831, 0: 645, 3: 494})

Epoch :  25 loss training:  24.601596537977457 Time :  2724
accuracy train: 0.976175 val: 0.743284 test: 0.720752
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({7: 1425, 6: 1119, 2: 1076, 5: 954, 3: 869, 4: 832, 1: 645, 0: 480})

Epoch :  26 loss training:  22.937219314277172 Time :  2755
accuracy train: 0.982131 val: 0.740299 test: 0.719763
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({0: 1420, 7: 1112, 4: 1089, 3: 967, 1: 873, 5: 830, 6: 642, 2: 467})

Epoch :  27 loss training:  20.303686447441578 Time :  2787
accuracy train: 0.981800 val: 0.740299 test: 0.723225
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({5: 1417, 6: 1114, 1: 1096, 0: 971, 7: 878, 4: 825, 2: 639, 3: 460})

Epoch :  28 loss training:  18.482330314815044 Time :  2822
accuracy train: 0.989080 val: 0.743284 test: 0.718773
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({2: 1416, 6: 1111, 0: 1103, 3: 975, 7: 880, 5: 824, 4: 639, 1: 452})

Epoch :  29 loss training:  18.611576486378908 Time :  2855
accuracy train: 0.986433 val: 0.743284 test: 0.721494
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({5: 1419, 2: 1122, 6: 1114, 7: 967, 3: 887, 4: 816, 1: 631, 0: 444})

Epoch :  30 loss training:  17.111954279243946 Time :  2887
accuracy train: 0.985771 val: 0.743284 test: 0.720752
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({1: 1417, 4: 1121, 2: 1120, 0: 968, 5: 898, 6: 813, 7: 631, 3: 432})

Epoch :  31 loss training:  14.59129286184907 Time :  2917
accuracy train: 0.991727 val: 0.749254 test: 0.715805
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({6: 1419, 3: 1128, 1: 1113, 0: 969, 5: 904, 7: 813, 2: 627, 4: 427})

Epoch :  32 loss training:  14.666107754223049 Time :  2955
accuracy train: 0.991727 val: 0.740299 test: 0.719763
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({2: 1422, 3: 1138, 1: 1120, 7: 959, 6: 904, 4: 806, 5: 625, 0: 426})

Epoch :  33 loss training:  14.562346871942282 Time :  2989
accuracy train: 0.992720 val: 0.737313 test: 0.720752
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({1: 1420, 4: 1144, 6: 1120, 3: 1016, 2: 962, 7: 796, 0: 523, 5: 419})

Epoch :  34 loss training:  12.667297201231122 Time :  3021
accuracy train: 0.994705 val: 0.731343 test: 0.715805
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({1: 1422, 4: 1140, 0: 1116, 3: 965, 2: 923, 6: 794, 5: 620, 7: 420})

Epoch :  35 loss training:  11.564842600375414 Time :  3052
accuracy train: 0.994705 val: 0.737313 test: 0.721247
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({0: 1419, 3: 1147, 2: 1118, 5: 1024, 6: 966, 4: 785, 1: 523, 7: 418})

Epoch :  36 loss training:  11.601086219772696 Time :  3103
accuracy train: 0.995036 val: 0.740299 test: 0.720505
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({0: 1419, 7: 1153, 1: 1120, 3: 978, 4: 918, 5: 776, 2: 622, 6: 414})

Epoch :  37 loss training:  9.8990338165313 Time :  3133
accuracy train: 0.995036 val: 0.740299 test: 0.720505
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({5: 1418, 1: 1152, 6: 1122, 4: 974, 7: 919, 2: 783, 3: 616, 0: 416})

Epoch :  38 loss training:  9.525751528330147 Time :  3165
accuracy train: 0.996691 val: 0.734328 test: 0.715063
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({4: 1418, 0: 1153, 7: 1120, 1: 976, 2: 920, 5: 780, 6: 620, 3: 413})

Epoch :  39 loss training:  8.495164406951517 Time :  3196
accuracy train: 0.998345 val: 0.740299 test: 0.713579
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({4: 1413, 7: 1156, 6: 1119, 1: 978, 2: 923, 0: 777, 3: 624, 5: 410})

Epoch :  40 loss training:  8.28397136926651 Time :  3245
accuracy train: 0.999007 val: 0.728358 test: 0.716300
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({1: 1412, 3: 1159, 2: 1117, 5: 976, 0: 924, 7: 773, 4: 627, 6: 412})

Epoch :  41 loss training:  7.643922554329038 Time :  3278
accuracy train: 0.998676 val: 0.737313 test: 0.713579
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({5: 1418, 6: 1164, 0: 1111, 4: 971, 3: 929, 2: 769, 1: 626, 7: 412})

Epoch :  42 loss training:  8.359817958436906 Time :  3310
accuracy train: 0.999007 val: 0.728358 test: 0.716052
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({2: 1412, 3: 1175, 0: 1109, 7: 970, 4: 924, 5: 771, 6: 630, 1: 409})

Epoch :  43 loss training:  7.230569119565189 Time :  3344
accuracy train: 0.997022 val: 0.740299 test: 0.714816
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({0: 1411, 4: 1169, 1: 1115, 5: 1018, 7: 965, 2: 741, 6: 571, 3: 410})

Epoch :  44 loss training:  7.391469093039632 Time :  3386
accuracy train: 0.998015 val: 0.737313 test: 0.712095
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({3: 1410, 0: 1177, 7: 1110, 5: 974, 4: 935, 1: 757, 2: 626, 6: 411})

Epoch :  45 loss training:  5.727723692543805 Time :  3419
accuracy train: 0.999007 val: 0.728358 test: 0.716547
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({3: 1513, 4: 1405, 1: 1199, 5: 1109, 6: 760, 7: 594, 0: 411, 2: 409})

Epoch :  46 loss training:  6.210242898669094 Time :  3452
accuracy train: 0.998345 val: 0.725373 test: 0.719515
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({0: 1402, 5: 1192, 3: 1106, 4: 1000, 7: 915, 2: 755, 6: 621, 1: 409})

Epoch :  47 loss training:  5.100237644277513 Time :  3483
accuracy train: 0.999338 val: 0.734328 test: 0.716794
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({1: 1501, 2: 1403, 7: 1216, 4: 1109, 5: 763, 0: 587, 3: 412, 6: 409})

Epoch :  48 loss training:  5.267568227835 Time :  3533
accuracy train: 0.999338 val: 0.737313 test: 0.718279
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({1: 1404, 3: 1206, 7: 1103, 0: 989, 6: 910, 2: 751, 5: 627, 4: 410})

Epoch :  49 loss training:  5.395850020926446 Time :  3563
accuracy train: 0.999669 val: 0.740299 test: 0.715805
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({1: 1404, 0: 1199, 2: 1103, 5: 991, 7: 916, 3: 751, 6: 629, 4: 407})

Epoch :  50 loss training:  5.72915869532153 Time :  3595
accuracy train: 0.999007 val: 0.740299 test: 0.713579
max validation accuracy : 0.755224 max acc epoch : 19 test accuracy : 0.720257
Counter({1: 1405, 5: 1211, 2: 1099, 6: 987, 3: 915, 7: 746, 0: 629, 4: 408})

========================================================================================================================================================================================================
best acc epoch :  19
validation accuracy :  0.755223880597015
test accuracy :  0.7202572347266881
last test_accuracy :  0.7135790254761316
second best val :  0.7522388059701492
second best test :  0.7202572347266881
max gap 5
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=8, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=2, tsne=False, weight_decay=0)
device :  cuda:0
Counter({6: 1198, 1: 1045, 5: 1029, 0: 1022, 7: 999, 3: 787, 4: 684, 2: 636})

Epoch :  1 loss training:  212.74615359306335 Time :  3639
accuracy train: 0.648246 val: 0.611940 test: 0.602770
max validation accuracy : 0.611940 max acc epoch : 1 test accuracy : 0.602770
Counter({2: 1328, 6: 1125, 1: 1101, 5: 1038, 7: 925, 3: 897, 0: 627, 4: 359})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  141.25973510742188 Time :  3677
accuracy train: 0.701853 val: 0.570149 test: 0.638387
max validation accuracy : 0.611940 max acc epoch : 1 test accuracy : 0.602770
Counter({6: 1305, 1: 1228, 2: 1128, 4: 1022, 3: 867, 7: 705, 5: 694, 0: 451})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  120.73957669734955 Time :  3709
accuracy train: 0.744540 val: 0.605970 test: 0.646550
max validation accuracy : 0.611940 max acc epoch : 1 test accuracy : 0.602770
Counter({1: 1381, 2: 1249, 0: 1132, 4: 981, 3: 862, 7: 836, 5: 575, 6: 384})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  99.24935737252235 Time :  3745
accuracy train: 0.797816 val: 0.671642 test: 0.694781
max validation accuracy : 0.671642 max acc epoch : 4 test accuracy : 0.694781
Counter({0: 1389, 3: 1261, 7: 1232, 1: 1132, 2: 801, 5: 592, 6: 584, 4: 409})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.1199996471405 Time :  3784
accuracy train: 0.815685 val: 0.662687 test: 0.694286
max validation accuracy : 0.671642 max acc epoch : 4 test accuracy : 0.694781
Counter({2: 1419, 5: 1267, 1: 1240, 4: 1139, 7: 794, 0: 592, 3: 544, 6: 405})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  83.55944338440895 Time :  3817
accuracy train: 0.821641 val: 0.671642 test: 0.699728
max validation accuracy : 0.671642 max acc epoch : 4 test accuracy : 0.694781
Counter({1: 1413, 6: 1229, 7: 1225, 4: 1118, 2: 827, 5: 600, 3: 600, 0: 388})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  73.63669821619987 Time :  3851
accuracy train: 0.847452 val: 0.674627 test: 0.705664
max validation accuracy : 0.674627 max acc epoch : 7 test accuracy : 0.705664
Counter({2: 1422, 6: 1225, 7: 1203, 5: 1141, 1: 811, 0: 603, 4: 595, 3: 400})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.18377369642258 Time :  3884
accuracy train: 0.860026 val: 0.707463 test: 0.710858
max validation accuracy : 0.707463 max acc epoch : 8 test accuracy : 0.710858
Counter({1: 1427, 6: 1222, 4: 1211, 7: 1142, 5: 806, 0: 601, 2: 592, 3: 399})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.78246681392193 Time :  3932
accuracy train: 0.872601 val: 0.692537 test: 0.715063
max validation accuracy : 0.707463 max acc epoch : 8 test accuracy : 0.710858
Counter({2: 1422, 4: 1240, 3: 1206, 1: 1143, 7: 802, 6: 593, 0: 580, 5: 414})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.920544266700745 Time :  3963
accuracy train: 0.876572 val: 0.692537 test: 0.710116
max validation accuracy : 0.707463 max acc epoch : 8 test accuracy : 0.710858
Counter({3: 1421, 4: 1241, 2: 1200, 6: 1142, 1: 801, 0: 596, 5: 585, 7: 414})

Epoch :  11 loss training:  57.986149951815605 Time :  3995
accuracy train: 0.883190 val: 0.686567 test: 0.710116
max validation accuracy : 0.707463 max acc epoch : 8 test accuracy : 0.710858
Counter({4: 1418, 2: 1236, 6: 1208, 7: 1143, 0: 802, 1: 594, 3: 586, 5: 413})

Epoch :  12 loss training:  54.535314336419106 Time :  4030
accuracy train: 0.900397 val: 0.695522 test: 0.713826
max validation accuracy : 0.707463 max acc epoch : 8 test accuracy : 0.710858
Counter({2: 1420, 4: 1234, 0: 1213, 3: 1139, 1: 805, 6: 590, 5: 584, 7: 415})

Epoch :  13 loss training:  51.86044158041477 Time :  4084
accuracy train: 0.905030 val: 0.686567 test: 0.715063
max validation accuracy : 0.707463 max acc epoch : 8 test accuracy : 0.710858
Counter({5: 1424, 2: 1237, 0: 1211, 1: 1147, 4: 794, 3: 587, 7: 586, 6: 414})

Epoch :  14 loss training:  49.61900594830513 Time :  4119
accuracy train: 0.901390 val: 0.692537 test: 0.711848
max validation accuracy : 0.707463 max acc epoch : 8 test accuracy : 0.710858
Counter({2: 1423, 5: 1236, 0: 1213, 1: 1144, 6: 789, 4: 592, 7: 588, 3: 415})

Epoch :  15 loss training:  45.7839080542326 Time :  4153
accuracy train: 0.917935 val: 0.686567 test: 0.716300
max validation accuracy : 0.707463 max acc epoch : 8 test accuracy : 0.710858
Counter({1: 1422, 5: 1243, 0: 1215, 6: 1145, 4: 782, 2: 587, 7: 587, 3: 419})

Epoch :  16 loss training:  45.19379486888647 Time :  4183
accuracy train: 0.926870 val: 0.698507 test: 0.719021
max validation accuracy : 0.707463 max acc epoch : 8 test accuracy : 0.710858
Counter({5: 1417, 1: 1250, 0: 1214, 3: 1134, 4: 792, 2: 587, 6: 584, 7: 422})

Epoch :  17 loss training:  40.66270634531975 Time :  4220
accuracy train: 0.935804 val: 0.689552 test: 0.716547
max validation accuracy : 0.707463 max acc epoch : 8 test accuracy : 0.710858
Counter({2: 1418, 6: 1253, 0: 1212, 4: 1137, 7: 792, 5: 585, 3: 583, 1: 420})

Epoch :  18 loss training:  37.91093011945486 Time :  4253
accuracy train: 0.937459 val: 0.689552 test: 0.716052
max validation accuracy : 0.707463 max acc epoch : 8 test accuracy : 0.710858
Counter({0: 1421, 1: 1255, 7: 1205, 3: 1138, 6: 782, 5: 589, 2: 586, 4: 424})

Epoch :  19 loss training:  37.493634298443794 Time :  4286
accuracy train: 0.951026 val: 0.686567 test: 0.719021
max validation accuracy : 0.707463 max acc epoch : 8 test accuracy : 0.710858
Counter({0: 1424, 5: 1257, 4: 1202, 1: 1138, 7: 784, 2: 588, 3: 581, 6: 426})

Epoch :  20 loss training:  35.079550080001354 Time :  4315
accuracy train: 0.949371 val: 0.704478 test: 0.710364
max validation accuracy : 0.707463 max acc epoch : 8 test accuracy : 0.710858
Counter({0: 1423, 5: 1266, 1: 1197, 6: 1138, 3: 777, 7: 587, 2: 579, 4: 433})

Epoch :  21 loss training:  30.985265009105206 Time :  4354
accuracy train: 0.953673 val: 0.701493 test: 0.718526
max validation accuracy : 0.707463 max acc epoch : 8 test accuracy : 0.710858
Counter({5: 1421, 6: 1272, 3: 1198, 0: 1136, 4: 775, 1: 587, 2: 579, 7: 432})

Epoch :  22 loss training:  30.312918230891228 Time :  4387
accuracy train: 0.960622 val: 0.713433 test: 0.716300
max validation accuracy : 0.713433 max acc epoch : 22 test accuracy : 0.716300
Counter({0: 1415, 3: 1279, 5: 1194, 1: 1136, 4: 773, 7: 586, 2: 580, 6: 437})

Epoch :  23 loss training:  28.652429185807705 Time :  4418
accuracy train: 0.965917 val: 0.695522 test: 0.712342
max validation accuracy : 0.713433 max acc epoch : 22 test accuracy : 0.716300
Counter({0: 1418, 7: 1279, 2: 1188, 4: 1137, 1: 775, 6: 590, 5: 580, 3: 433})

Epoch :  24 loss training:  26.076940171420574 Time :  4455
accuracy train: 0.972204 val: 0.701493 test: 0.720752
max validation accuracy : 0.713433 max acc epoch : 22 test accuracy : 0.716300
Counter({2: 1417, 6: 1278, 0: 1193, 1: 1143, 7: 766, 3: 597, 4: 571, 5: 435})

Epoch :  25 loss training:  26.676043566316366 Time :  4488
accuracy train: 0.967571 val: 0.701493 test: 0.711353
max validation accuracy : 0.713433 max acc epoch : 22 test accuracy : 0.716300
Counter({0: 1413, 7: 1286, 1: 1189, 3: 1146, 2: 760, 5: 600, 4: 571, 6: 435})

Epoch :  26 loss training:  21.652844205498695 Time :  4519
accuracy train: 0.983124 val: 0.713433 test: 0.721247
max validation accuracy : 0.713433 max acc epoch : 22 test accuracy : 0.716300
Counter({1: 1407, 3: 1283, 7: 1192, 4: 1145, 5: 760, 2: 601, 0: 573, 6: 439})

Epoch :  27 loss training:  21.295819129794836 Time :  4552
accuracy train: 0.980146 val: 0.701493 test: 0.721247
max validation accuracy : 0.713433 max acc epoch : 22 test accuracy : 0.716300
Counter({0: 1407, 7: 1289, 1: 1187, 3: 1145, 2: 761, 5: 603, 6: 573, 4: 435})

Epoch :  28 loss training:  19.579966321587563 Time :  4589
accuracy train: 0.987426 val: 0.686567 test: 0.720257
max validation accuracy : 0.713433 max acc epoch : 22 test accuracy : 0.716300
Counter({5: 1406, 0: 1282, 6: 1191, 4: 1146, 2: 761, 7: 607, 1: 574, 3: 433})

Epoch :  29 loss training:  18.98656552657485 Time :  4623
accuracy train: 0.983124 val: 0.707463 test: 0.720752
max validation accuracy : 0.713433 max acc epoch : 22 test accuracy : 0.716300
Counter({3: 1407, 1: 1280, 7: 1190, 4: 1146, 0: 758, 2: 610, 5: 577, 6: 432})

Epoch :  30 loss training:  18.317841693758965 Time :  4655
accuracy train: 0.985109 val: 0.716418 test: 0.717042
max validation accuracy : 0.716418 max acc epoch : 30 test accuracy : 0.717042
Counter({1: 1405, 2: 1264, 0: 1211, 4: 1128, 5: 758, 7: 637, 3: 566, 6: 431})

Epoch :  31 loss training:  16.627062864601612 Time :  4689
accuracy train: 0.989411 val: 0.728358 test: 0.718031
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({3: 1398, 2: 1264, 1: 1204, 6: 1131, 0: 758, 4: 646, 5: 566, 7: 433})

Epoch :  32 loss training:  14.872628193348646 Time :  4726
accuracy train: 0.990735 val: 0.707463 test: 0.718526
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({2: 1396, 3: 1262, 4: 1201, 0: 1135, 5: 757, 6: 648, 1: 567, 7: 434})

Epoch :  33 loss training:  14.462660390883684 Time :  4759
accuracy train: 0.991396 val: 0.728358 test: 0.723225
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({5: 1379, 2: 1279, 3: 1200, 1: 1135, 7: 754, 4: 654, 6: 567, 0: 432})

Epoch :  34 loss training:  13.27437499165535 Time :  4792
accuracy train: 0.990073 val: 0.725373 test: 0.722483
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({2: 1380, 3: 1274, 1: 1194, 0: 1141, 6: 752, 7: 661, 5: 567, 4: 431})

Epoch :  35 loss training:  12.364454811438918 Time :  4824
accuracy train: 0.993713 val: 0.719403 test: 0.719515
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({0: 1378, 1: 1280, 6: 1188, 7: 1141, 2: 748, 5: 663, 4: 569, 3: 433})

Epoch :  36 loss training:  12.356602109503001 Time :  4861
accuracy train: 0.996029 val: 0.716418 test: 0.719268
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({7: 1381, 4: 1279, 0: 1183, 2: 1140, 1: 748, 3: 665, 6: 571, 5: 433})

Epoch :  37 loss training:  10.625950468704104 Time :  4893
accuracy train: 0.995698 val: 0.710448 test: 0.720752
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({7: 1381, 6: 1278, 0: 1176, 2: 1142, 5: 745, 1: 681, 4: 565, 3: 432})

Epoch :  38 loss training:  10.178508641198277 Time :  4925
accuracy train: 0.995698 val: 0.707463 test: 0.716052
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({1: 1381, 4: 1286, 3: 1169, 2: 1142, 7: 748, 6: 679, 5: 567, 0: 428})

Epoch :  39 loss training:  9.216407315805554 Time :  4956
accuracy train: 0.997684 val: 0.701493 test: 0.720752
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({0: 1376, 7: 1289, 1: 1175, 6: 1142, 3: 754, 5: 681, 2: 558, 4: 425})

Epoch :  40 loss training:  8.268615813925862 Time :  4993
accuracy train: 0.998015 val: 0.713433 test: 0.721989
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({2: 1367, 1: 1282, 0: 1177, 4: 1138, 3: 757, 7: 688, 6: 565, 5: 426})

Epoch :  41 loss training:  7.964616047684103 Time :  5024
accuracy train: 0.998676 val: 0.707463 test: 0.722731
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({3: 1353, 6: 1273, 1: 1179, 4: 1136, 0: 751, 2: 715, 5: 568, 7: 425})

Epoch :  42 loss training:  7.577268241904676 Time :  5057
accuracy train: 0.996360 val: 0.698507 test: 0.719763
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({1: 1352, 3: 1278, 2: 1176, 0: 1135, 5: 751, 4: 714, 7: 566, 6: 428})

Epoch :  43 loss training:  7.4853573818691075 Time :  5090
accuracy train: 0.998676 val: 0.716418 test: 0.720752
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({1: 1347, 3: 1272, 5: 1185, 0: 1134, 2: 755, 7: 720, 6: 558, 4: 429})

Epoch :  44 loss training:  6.701629641465843 Time :  5127
accuracy train: 0.999338 val: 0.704478 test: 0.718031
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({1: 1339, 7: 1268, 3: 1180, 2: 1136, 5: 748, 6: 734, 4: 562, 0: 433})

Epoch :  45 loss training:  5.926360351964831 Time :  5159
accuracy train: 0.997684 val: 0.704478 test: 0.723967
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({6: 1335, 0: 1272, 3: 1179, 2: 1137, 1: 745, 7: 737, 4: 562, 5: 433})

Epoch :  46 loss training:  5.191233436111361 Time :  5189
accuracy train: 0.998345 val: 0.698507 test: 0.721247
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({0: 1333, 2: 1279, 5: 1177, 1: 1132, 4: 743, 7: 742, 6: 562, 3: 432})

Epoch :  47 loss training:  6.2438257383182645 Time :  5220
accuracy train: 0.998676 val: 0.698507 test: 0.723720
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({3: 1331, 1: 1281, 4: 1168, 2: 1133, 7: 749, 6: 743, 5: 563, 0: 432})

Epoch :  48 loss training:  5.409006238915026 Time :  5256
accuracy train: 0.999338 val: 0.704478 test: 0.722483
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({1: 1329, 5: 1278, 3: 1170, 6: 1131, 0: 759, 2: 740, 4: 561, 7: 432})

Epoch :  49 loss training:  5.3937374744564295 Time :  5289
accuracy train: 0.999338 val: 0.719403 test: 0.720257
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({3: 1330, 7: 1274, 0: 1168, 2: 1127, 1: 770, 5: 738, 4: 564, 6: 429})

Epoch :  50 loss training:  4.58756798831746 Time :  5320
accuracy train: 0.999669 val: 0.704478 test: 0.722483
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({3: 1328, 6: 1272, 2: 1169, 0: 1131, 7: 772, 4: 740, 1: 561, 5: 427})

Epoch :  51 loss training:  4.7376760127954185 Time :  5351
accuracy train: 0.998345 val: 0.713433 test: 0.720505
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({4: 1326, 1: 1269, 6: 1172, 2: 1130, 7: 773, 3: 745, 5: 558, 0: 427})

Epoch :  52 loss training:  4.397358783520758 Time :  5389
accuracy train: 0.998345 val: 0.710448 test: 0.717042
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({1: 1325, 0: 1270, 2: 1169, 5: 1126, 3: 777, 7: 748, 4: 558, 6: 427})

Epoch :  53 loss training:  4.274154256796464 Time :  5418
accuracy train: 0.999669 val: 0.722388 test: 0.726935
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({0: 1322, 7: 1266, 5: 1162, 2: 1126, 4: 799, 6: 739, 1: 557, 3: 429})

Epoch :  54 loss training:  3.7635828179772943 Time :  5449
accuracy train: 0.999669 val: 0.722388 test: 0.722978
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({5: 1314, 0: 1265, 6: 1170, 1: 1128, 3: 807, 2: 737, 7: 550, 4: 429})

Epoch :  55 loss training:  3.572287165094167 Time :  5478
accuracy train: 1.000000 val: 0.716418 test: 0.719763
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({7: 1308, 5: 1274, 0: 1169, 4: 1122, 3: 820, 1: 727, 2: 552, 6: 428})

Epoch :  56 loss training:  3.4188189127016813 Time :  5512
accuracy train: 0.999669 val: 0.722388 test: 0.720010
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({1: 1307, 2: 1275, 4: 1158, 5: 1124, 3: 826, 0: 727, 6: 554, 7: 429})

Epoch :  57 loss training:  2.9229801138862967 Time :  5543
accuracy train: 0.998676 val: 0.716418 test: 0.715805
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({3: 1305, 4: 1276, 0: 1150, 2: 1123, 1: 830, 7: 725, 5: 556, 6: 435})

Epoch :  58 loss training:  3.0849853651598096 Time :  5573
accuracy train: 0.999007 val: 0.701493 test: 0.714568
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({5: 1301, 6: 1270, 7: 1154, 4: 1122, 3: 837, 2: 724, 1: 554, 0: 438})

Epoch :  59 loss training:  2.6248828414827585 Time :  5603
accuracy train: 0.999338 val: 0.728358 test: 0.718526
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({1: 1287, 3: 1276, 4: 1146, 0: 1121, 5: 856, 6: 722, 2: 552, 7: 440})

Epoch :  60 loss training:  3.271098659839481 Time :  5642
accuracy train: 0.999338 val: 0.707463 test: 0.713579
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({6: 1288, 4: 1281, 3: 1152, 1: 1116, 7: 861, 2: 719, 0: 548, 5: 435})

Epoch :  61 loss training:  2.7415103507228196 Time :  5670
accuracy train: 1.000000 val: 0.719403 test: 0.718031
max validation accuracy : 0.728358 max acc epoch : 31 test accuracy : 0.718031
Counter({2: 1283, 4: 1273, 7: 1158, 0: 1115, 3: 869, 5: 716, 6: 552, 1: 434})

Epoch :  62 loss training:  2.415285967348609 Time :  5699
accuracy train: 0.999669 val: 0.734328 test: 0.713826
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({3: 1283, 4: 1280, 5: 1155, 1: 1119, 0: 871, 6: 711, 7: 549, 2: 432})

Epoch :  63 loss training:  2.807468245504424 Time :  5775
accuracy train: 0.999669 val: 0.731343 test: 0.717784
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({4: 1283, 6: 1279, 1: 1154, 2: 1119, 5: 868, 3: 713, 7: 552, 0: 432})

Epoch :  64 loss training:  2.5721140245441347 Time :  5808
accuracy train: 0.999669 val: 0.728358 test: 0.718031
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({1: 1283, 7: 1279, 0: 1156, 2: 1119, 5: 870, 6: 708, 4: 553, 3: 432})

Epoch :  65 loss training:  2.397195923374966 Time :  5878
accuracy train: 0.999669 val: 0.713433 test: 0.715558
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({2: 1286, 5: 1279, 7: 1161, 0: 1119, 1: 867, 4: 708, 3: 552, 6: 428})

Epoch :  66 loss training:  2.0817859461531043 Time :  5912
accuracy train: 0.999669 val: 0.716418 test: 0.715310
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({4: 1285, 3: 1279, 6: 1156, 2: 1118, 5: 874, 7: 705, 1: 554, 0: 429})

Epoch :  67 loss training:  1.910846994491294 Time :  6000
accuracy train: 1.000000 val: 0.716418 test: 0.718031
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({7: 1286, 5: 1278, 2: 1152, 0: 1121, 4: 877, 1: 702, 3: 555, 6: 429})

Epoch :  68 loss training:  1.7805463741533458 Time :  6059
accuracy train: 1.000000 val: 0.719403 test: 0.717289
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({5: 1286, 6: 1276, 2: 1147, 1: 1121, 4: 883, 3: 702, 0: 556, 7: 429})

Epoch :  69 loss training:  1.7214403114048764 Time :  6095
accuracy train: 0.999007 val: 0.695522 test: 0.717042
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({6: 1289, 2: 1276, 0: 1137, 1: 1127, 3: 885, 5: 702, 4: 555, 7: 429})

Epoch :  70 loss training:  1.8634577326010913 Time :  6128
accuracy train: 1.000000 val: 0.719403 test: 0.716547
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({3: 1282, 6: 1275, 2: 1138, 0: 1126, 5: 899, 1: 696, 7: 555, 4: 429})

Epoch :  71 loss training:  1.520524398307316 Time :  6163
accuracy train: 1.000000 val: 0.713433 test: 0.716052
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({6: 1278, 7: 1276, 4: 1140, 1: 1127, 0: 903, 5: 691, 2: 555, 3: 430})

Epoch :  72 loss training:  1.7789150564349256 Time :  6196
accuracy train: 0.999669 val: 0.713433 test: 0.714816
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({2: 1277, 1: 1272, 4: 1150, 5: 1122, 7: 902, 3: 693, 0: 557, 6: 427})

Epoch :  73 loss training:  1.5845186535152607 Time :  6231
accuracy train: 1.000000 val: 0.728358 test: 0.715310
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({6: 1276, 0: 1276, 2: 1145, 1: 1122, 3: 903, 4: 691, 7: 560, 5: 427})

Epoch :  74 loss training:  1.2670723828487098 Time :  6267
accuracy train: 1.000000 val: 0.719403 test: 0.716300
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({7: 1285, 2: 1277, 5: 1139, 3: 1115, 0: 903, 4: 694, 6: 560, 1: 427})

Epoch :  75 loss training:  1.3707904597977176 Time :  6300
accuracy train: 1.000000 val: 0.734328 test: 0.719021
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({2: 1295, 0: 1276, 6: 1122, 1: 1109, 4: 917, 5: 697, 3: 558, 7: 426})

Epoch :  76 loss training:  1.1913172325585037 Time :  6335
accuracy train: 1.000000 val: 0.728358 test: 0.715558
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({3: 1296, 2: 1277, 1: 1119, 4: 1109, 6: 922, 7: 693, 0: 559, 5: 425})

Epoch :  77 loss training:  1.0825777225545608 Time :  6370
accuracy train: 1.000000 val: 0.728358 test: 0.718773
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({3: 1300, 1: 1276, 6: 1114, 4: 1111, 0: 924, 7: 693, 5: 559, 2: 423})

Epoch :  78 loss training:  1.5930470184539445 Time :  6402
accuracy train: 1.000000 val: 0.710448 test: 0.720257
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({7: 1296, 1: 1272, 0: 1113, 2: 1110, 3: 931, 5: 702, 4: 558, 6: 418})

Epoch :  79 loss training:  0.9697449605446309 Time :  6448
accuracy train: 1.000000 val: 0.722388 test: 0.718279
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({3: 1290, 2: 1272, 1: 1114, 5: 1106, 6: 939, 0: 700, 4: 558, 7: 421})

Epoch :  80 loss training:  1.3484219560632482 Time :  6484
accuracy train: 1.000000 val: 0.707463 test: 0.718773
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({5: 1288, 1: 1271, 4: 1113, 3: 1106, 7: 938, 2: 701, 6: 561, 0: 422})

Epoch :  81 loss training:  1.2621565259760246 Time :  6521
accuracy train: 1.000000 val: 0.722388 test: 0.715063
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({2: 1281, 0: 1272, 6: 1118, 7: 1109, 3: 940, 1: 701, 5: 560, 4: 419})

Epoch :  82 loss training:  1.3506048301351257 Time :  6555
accuracy train: 1.000000 val: 0.713433 test: 0.716794
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({6: 1281, 7: 1270, 5: 1119, 2: 1108, 1: 945, 3: 698, 0: 561, 4: 418})

Epoch :  83 loss training:  1.3741817443515174 Time :  6590
accuracy train: 1.000000 val: 0.728358 test: 0.714816
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({4: 1288, 0: 1270, 3: 1114, 1: 1109, 6: 942, 5: 698, 7: 561, 2: 418})

Epoch :  84 loss training:  1.5909148020436987 Time :  6640
accuracy train: 1.000000 val: 0.719403 test: 0.715063
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({3: 1288, 0: 1271, 6: 1110, 1: 1107, 5: 949, 2: 696, 7: 561, 4: 418})

Epoch :  85 loss training:  1.1113009228138253 Time :  6674
accuracy train: 0.999669 val: 0.713433 test: 0.713826
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({4: 1287, 0: 1273, 7: 1111, 2: 1107, 1: 950, 5: 697, 3: 559, 6: 416})

Epoch :  86 loss training:  0.9332958946470171 Time :  6708
accuracy train: 1.000000 val: 0.707463 test: 0.716547
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({2: 1282, 1: 1273, 3: 1114, 0: 1101, 7: 956, 5: 701, 6: 558, 4: 415})

Epoch :  87 loss training:  0.9587843754852656 Time :  6740
accuracy train: 1.000000 val: 0.710448 test: 0.720257
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({2: 1274, 4: 1273, 5: 1116, 1: 1101, 3: 961, 7: 703, 0: 559, 6: 413})

Epoch :  88 loss training:  0.8535325651464518 Time :  6794
accuracy train: 0.999669 val: 0.716418 test: 0.714568
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({5: 1273, 4: 1273, 2: 1112, 1: 1104, 0: 966, 6: 701, 3: 559, 7: 412})

Epoch :  89 loss training:  1.10791245684959 Time :  6831
accuracy train: 1.000000 val: 0.713433 test: 0.720752
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({0: 1273, 3: 1266, 1: 1112, 2: 1105, 7: 972, 4: 709, 5: 556, 6: 407})

Epoch :  90 loss training:  0.8743899568507914 Time :  6868
accuracy train: 1.000000 val: 0.707463 test: 0.719763
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({5: 1274, 2: 1261, 4: 1115, 1: 1103, 7: 976, 3: 708, 6: 556, 0: 407})

Epoch :  91 loss training:  1.0358831772464328 Time :  6905
accuracy train: 1.000000 val: 0.710448 test: 0.720999
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({3: 1273, 7: 1263, 5: 1113, 4: 1101, 6: 979, 1: 710, 0: 554, 2: 407})

Epoch :  92 loss training:  0.7372890690166969 Time :  6942
accuracy train: 1.000000 val: 0.704478 test: 0.720257
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({1: 1273, 5: 1263, 4: 1115, 0: 1100, 6: 976, 2: 711, 7: 556, 3: 406})

Epoch :  93 loss training:  0.9031431363837328 Time :  6977
accuracy train: 1.000000 val: 0.698507 test: 0.717784
max validation accuracy : 0.734328 max acc epoch : 62 test accuracy : 0.713826
Counter({4: 1268, 6: 1268, 3: 1116, 5: 1097, 7: 976, 2: 710, 1: 561, 0: 404})

========================================================================================================================================================================================================
best acc epoch :  62
validation accuracy :  0.7343283582089553
test accuracy :  0.7138263665594855
last test_accuracy :  0.7177838238931487
second best val :  0.7313432835820896
second best test :  0.7138263665594855
max gap 31
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=8, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=971, tsne=False, weight_decay=0)
device :  cuda:0
Counter({4: 1149, 2: 1044, 6: 1017, 7: 1016, 3: 979, 0: 808, 5: 721, 1: 666})

Epoch :  1 loss training:  208.71244287490845 Time :  7021
accuracy train: 0.652548 val: 0.558209 test: 0.607717
max validation accuracy : 0.558209 max acc epoch : 1 test accuracy : 0.607717
Counter({3: 1499, 6: 1167, 4: 1041, 1: 902, 2: 786, 0: 763, 7: 683, 5: 559})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  136.95508235692978 Time :  7062
accuracy train: 0.740238 val: 0.594030 test: 0.669800
max validation accuracy : 0.594030 max acc epoch : 2 test accuracy : 0.669800
Counter({0: 1360, 6: 1174, 3: 1145, 5: 1051, 1: 889, 2: 637, 7: 625, 4: 519})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  116.39491266012192 Time :  7096
accuracy train: 0.762740 val: 0.641791 test: 0.667574
max validation accuracy : 0.641791 max acc epoch : 3 test accuracy : 0.667574
Counter({0: 1405, 1: 1184, 7: 1180, 6: 1160, 2: 702, 3: 692, 4: 566, 5: 511})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  96.57060113549232 Time :  7128
accuracy train: 0.797816 val: 0.629851 test: 0.688350
max validation accuracy : 0.641791 max acc epoch : 3 test accuracy : 0.667574
Counter({3: 1400, 7: 1222, 2: 1144, 6: 973, 1: 922, 5: 673, 4: 554, 0: 512})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  87.3393665254116 Time :  7164
accuracy train: 0.817009 val: 0.650746 test: 0.696512
max validation accuracy : 0.650746 max acc epoch : 5 test accuracy : 0.696512
Counter({5: 1395, 1: 1248, 4: 1243, 2: 1133, 0: 674, 3: 649, 6: 549, 7: 509})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  81.78038084506989 Time :  7237
accuracy train: 0.835208 val: 0.644776 test: 0.692308
max validation accuracy : 0.650746 max acc epoch : 5 test accuracy : 0.696512
Counter({2: 1381, 1: 1251, 4: 1234, 3: 1139, 7: 673, 0: 673, 5: 549, 6: 500})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  70.49809455871582 Time :  7271
accuracy train: 0.857048 val: 0.665672 test: 0.699481
max validation accuracy : 0.665672 max acc epoch : 7 test accuracy : 0.699481
Counter({0: 1384, 6: 1226, 2: 1141, 1: 1037, 7: 896, 5: 681, 3: 534, 4: 501})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.56461508572102 Time :  7309
accuracy train: 0.863005 val: 0.677612 test: 0.704180
max validation accuracy : 0.677612 max acc epoch : 8 test accuracy : 0.704180
Counter({3: 1384, 2: 1258, 4: 1226, 6: 1144, 0: 682, 7: 681, 5: 527, 1: 498})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.82908001542091 Time :  7342
accuracy train: 0.864659 val: 0.647761 test: 0.702449
max validation accuracy : 0.677612 max acc epoch : 8 test accuracy : 0.704180
Counter({5: 1391, 6: 1237, 3: 1130, 1: 1046, 7: 880, 0: 691, 4: 528, 2: 497})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.469247832894325 Time :  7376
accuracy train: 0.884514 val: 0.680597 test: 0.708880
max validation accuracy : 0.680597 max acc epoch : 10 test accuracy : 0.708880
Counter({2: 1392, 1: 1242, 6: 1123, 0: 1018, 4: 907, 3: 695, 7: 525, 5: 498})

Epoch :  11 loss training:  57.26656028628349 Time :  7413
accuracy train: 0.895103 val: 0.677612 test: 0.710858
max validation accuracy : 0.680597 max acc epoch : 10 test accuracy : 0.708880
Counter({1: 1392, 4: 1256, 6: 1247, 3: 1127, 0: 692, 7: 667, 5: 526, 2: 493})

Epoch :  12 loss training:  53.50289058685303 Time :  7469
accuracy train: 0.906023 val: 0.659701 test: 0.711848
max validation accuracy : 0.680597 max acc epoch : 10 test accuracy : 0.708880
Counter({6: 1395, 3: 1267, 0: 1248, 5: 1123, 7: 692, 4: 664, 2: 527, 1: 484})

Epoch :  13 loss training:  51.71677106618881 Time :  7505
accuracy train: 0.915619 val: 0.677612 test: 0.711106
max validation accuracy : 0.680597 max acc epoch : 10 test accuracy : 0.708880
Counter({1: 1387, 3: 1253, 4: 1123, 0: 1037, 6: 905, 2: 691, 5: 521, 7: 483})

Epoch :  14 loss training:  46.852988600730896 Time :  7542
accuracy train: 0.913964 val: 0.680597 test: 0.712837
max validation accuracy : 0.680597 max acc epoch : 10 test accuracy : 0.708880
Counter({7: 1388, 4: 1253, 0: 1123, 1: 1042, 2: 897, 6: 694, 3: 520, 5: 483})

Epoch :  15 loss training:  45.674195289611816 Time :  7578
accuracy train: 0.921906 val: 0.674627 test: 0.712342
max validation accuracy : 0.680597 max acc epoch : 10 test accuracy : 0.708880
Counter({4: 1385, 5: 1254, 0: 1130, 6: 1050, 3: 883, 7: 699, 1: 517, 2: 482})

Epoch :  16 loss training:  42.899363681674004 Time :  7616
accuracy train: 0.938120 val: 0.680597 test: 0.710611
max validation accuracy : 0.680597 max acc epoch : 10 test accuracy : 0.708880
Counter({5: 1392, 2: 1275, 0: 1260, 1: 1132, 7: 696, 6: 654, 3: 515, 4: 476})

Epoch :  17 loss training:  39.34071612358093 Time :  7652
accuracy train: 0.938451 val: 0.674627 test: 0.709374
max validation accuracy : 0.680597 max acc epoch : 10 test accuracy : 0.708880
Counter({2: 1388, 7: 1269, 0: 1261, 6: 1129, 1: 701, 5: 660, 4: 513, 3: 479})

Epoch :  18 loss training:  37.23529697954655 Time :  7689
accuracy train: 0.946724 val: 0.680597 test: 0.712837
max validation accuracy : 0.680597 max acc epoch : 10 test accuracy : 0.708880
Counter({1: 1393, 6: 1270, 3: 1254, 2: 1128, 7: 706, 0: 659, 4: 512, 5: 478})

Epoch :  19 loss training:  36.89698979258537 Time :  7725
accuracy train: 0.953673 val: 0.698507 test: 0.717042
max validation accuracy : 0.698507 max acc epoch : 19 test accuracy : 0.717042
Counter({3: 1390, 0: 1288, 5: 1251, 2: 1121, 4: 706, 1: 655, 6: 510, 7: 479})

Epoch :  20 loss training:  33.47091367095709 Time :  7766
accuracy train: 0.959629 val: 0.707463 test: 0.716794
max validation accuracy : 0.707463 max acc epoch : 20 test accuracy : 0.716794
Counter({0: 1399, 3: 1282, 7: 1254, 1: 1123, 5: 711, 2: 650, 6: 505, 4: 476})

Epoch :  21 loss training:  30.602258637547493 Time :  7800
accuracy train: 0.966248 val: 0.686567 test: 0.716547
max validation accuracy : 0.707463 max acc epoch : 20 test accuracy : 0.716794
Counter({3: 1403, 1: 1279, 4: 1245, 7: 1131, 5: 717, 6: 646, 2: 504, 0: 475})

Epoch :  22 loss training:  30.374686807394028 Time :  7835
accuracy train: 0.971873 val: 0.686567 test: 0.714816
max validation accuracy : 0.707463 max acc epoch : 20 test accuracy : 0.716794
Counter({5: 1406, 6: 1289, 1: 1245, 0: 1133, 4: 712, 3: 645, 2: 499, 7: 471})

Epoch :  23 loss training:  27.397485814988613 Time :  7874
accuracy train: 0.974851 val: 0.716418 test: 0.714074
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({4: 1408, 3: 1289, 2: 1242, 7: 1135, 0: 717, 1: 644, 5: 495, 6: 470})

Epoch :  24 loss training:  24.178019240498543 Time :  7908
accuracy train: 0.975844 val: 0.689552 test: 0.714568
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({3: 1408, 0: 1296, 6: 1232, 2: 1139, 4: 717, 5: 646, 1: 495, 7: 467})

Epoch :  25 loss training:  22.62652252987027 Time :  7942
accuracy train: 0.974189 val: 0.689552 test: 0.714321
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({1: 1406, 2: 1295, 3: 1236, 0: 1139, 7: 714, 4: 647, 6: 496, 5: 467})

Epoch :  26 loss training:  23.275056764483452 Time :  7975
accuracy train: 0.978491 val: 0.692537 test: 0.711848
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({2: 1401, 3: 1292, 4: 1232, 5: 1144, 0: 714, 1: 655, 7: 494, 6: 468})

Epoch :  27 loss training:  20.577151134610176 Time :  8013
accuracy train: 0.982462 val: 0.701493 test: 0.713084
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({2: 1402, 3: 1291, 7: 1234, 0: 1144, 5: 716, 4: 655, 1: 493, 6: 465})

Epoch :  28 loss training:  19.71609102189541 Time :  8049
accuracy train: 0.984447 val: 0.689552 test: 0.712837
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({4: 1402, 2: 1296, 0: 1242, 5: 1143, 3: 708, 6: 651, 1: 491, 7: 467})

Epoch :  29 loss training:  17.470057658851147 Time :  8085
accuracy train: 0.989080 val: 0.716418 test: 0.709622
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({3: 1402, 2: 1297, 6: 1247, 7: 1138, 0: 709, 1: 649, 4: 490, 5: 468})

Epoch :  30 loss training:  15.640577148646116 Time :  8121
accuracy train: 0.991066 val: 0.683582 test: 0.709374
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({1: 1395, 4: 1300, 5: 1254, 2: 1137, 3: 713, 7: 646, 6: 487, 0: 468})

Epoch :  31 loss training:  14.897067684680223 Time :  8160
accuracy train: 0.989080 val: 0.695522 test: 0.714074
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({6: 1397, 1: 1300, 4: 1254, 2: 1138, 7: 717, 5: 642, 0: 485, 3: 467})

Epoch :  32 loss training:  13.928165528923273 Time :  8192
accuracy train: 0.994705 val: 0.698507 test: 0.709869
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({0: 1394, 6: 1303, 7: 1256, 1: 1142, 3: 712, 2: 645, 5: 482, 4: 466})

Epoch :  33 loss training:  13.30554392375052 Time :  8227
accuracy train: 0.994375 val: 0.698507 test: 0.710364
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({6: 1390, 0: 1298, 5: 1267, 3: 1143, 1: 715, 2: 641, 7: 481, 4: 465})

Epoch :  34 loss training:  12.284207358956337 Time :  8261
accuracy train: 0.995367 val: 0.698507 test: 0.714321
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({2: 1387, 7: 1303, 4: 1267, 1: 1147, 3: 710, 6: 642, 5: 480, 0: 464})

Epoch :  35 loss training:  12.336155697703362 Time :  8300
accuracy train: 0.997684 val: 0.677612 test: 0.712837
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({4: 1387, 3: 1306, 6: 1271, 0: 1144, 7: 711, 1: 639, 5: 478, 2: 464})

Epoch :  36 loss training:  10.445060409605503 Time :  8337
accuracy train: 0.997684 val: 0.710448 test: 0.711353
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({0: 1384, 5: 1311, 2: 1261, 3: 1144, 1: 717, 7: 640, 4: 479, 6: 464})

Epoch :  37 loss training:  8.980598764494061 Time :  8372
accuracy train: 0.997353 val: 0.701493 test: 0.716052
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({0: 1385, 2: 1311, 7: 1270, 6: 1142, 4: 715, 3: 636, 5: 477, 1: 464})

Epoch :  38 loss training:  9.286156440153718 Time :  8405
accuracy train: 0.996029 val: 0.704478 test: 0.714074
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({2: 1389, 3: 1320, 1: 1266, 7: 1142, 0: 711, 5: 633, 6: 475, 4: 464})

Epoch :  39 loss training:  9.871509298682213 Time :  8456
accuracy train: 0.998676 val: 0.686567 test: 0.712342
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({0: 1390, 1: 1320, 5: 1288, 2: 1142, 6: 694, 3: 626, 4: 476, 7: 464})

Epoch :  40 loss training:  8.24057417921722 Time :  8487
accuracy train: 0.999007 val: 0.695522 test: 0.714321
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({5: 1390, 3: 1310, 7: 1298, 1: 1144, 0: 691, 4: 627, 6: 476, 2: 464})

Epoch :  41 loss training:  7.571058331988752 Time :  8521
accuracy train: 0.998676 val: 0.701493 test: 0.713332
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({4: 1390, 6: 1309, 0: 1309, 1: 1141, 7: 687, 5: 626, 3: 475, 2: 463})

Epoch :  42 loss training:  6.823253673501313 Time :  8554
accuracy train: 0.998676 val: 0.695522 test: 0.711353
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({6: 1389, 1: 1313, 0: 1306, 4: 1136, 2: 691, 7: 624, 5: 479, 3: 462})

Epoch :  43 loss training:  7.408152217045426 Time :  8603
accuracy train: 0.998676 val: 0.707463 test: 0.712095
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({2: 1392, 3: 1314, 1: 1301, 4: 1137, 5: 699, 7: 617, 6: 478, 0: 462})

Epoch :  44 loss training:  5.949035534635186 Time :  8640
accuracy train: 0.998345 val: 0.701493 test: 0.709869
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({5: 1392, 7: 1318, 0: 1303, 1: 1137, 2: 692, 3: 619, 4: 478, 6: 461})

Epoch :  45 loss training:  6.399712627753615 Time :  8673
accuracy train: 0.998676 val: 0.686567 test: 0.708880
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({1: 1395, 0: 1311, 5: 1307, 4: 1137, 3: 690, 2: 623, 7: 477, 6: 460})

Epoch :  46 loss training:  6.04873231658712 Time :  8708
accuracy train: 0.995367 val: 0.695522 test: 0.706901
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({3: 1394, 2: 1312, 0: 1309, 1: 1135, 5: 693, 4: 622, 6: 477, 7: 458})

Epoch :  47 loss training:  4.4507964053191245 Time :  8754
accuracy train: 0.999007 val: 0.704478 test: 0.715310
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({3: 1394, 2: 1313, 0: 1309, 1: 1136, 7: 695, 5: 619, 6: 477, 4: 457})

Epoch :  48 loss training:  4.574584677815437 Time :  8787
accuracy train: 0.999669 val: 0.686567 test: 0.713579
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({5: 1390, 6: 1315, 1: 1311, 4: 1135, 0: 695, 2: 619, 7: 478, 3: 457})

Epoch :  49 loss training:  4.28226930857636 Time :  8819
accuracy train: 0.998015 val: 0.710448 test: 0.710116
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({1: 1386, 6: 1317, 2: 1312, 3: 1139, 5: 696, 0: 619, 7: 475, 4: 456})

Epoch :  50 loss training:  4.995632216334343 Time :  8854
accuracy train: 0.999007 val: 0.689552 test: 0.708138
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({0: 1385, 1: 1326, 5: 1314, 4: 1135, 7: 692, 2: 617, 6: 475, 3: 456})

Epoch :  51 loss training:  4.150815426371992 Time :  8908
accuracy train: 0.999669 val: 0.701493 test: 0.712837
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({3: 1384, 5: 1321, 4: 1314, 1: 1135, 7: 697, 6: 618, 0: 475, 2: 456})

Epoch :  52 loss training:  4.56571485218592 Time :  8943
accuracy train: 0.999338 val: 0.704478 test: 0.709869
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({5: 1384, 3: 1316, 7: 1315, 0: 1136, 2: 694, 1: 618, 6: 475, 4: 462})

Epoch :  53 loss training:  3.7462010292802006 Time :  8976
accuracy train: 0.999338 val: 0.704478 test: 0.710611
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({2: 1384, 5: 1319, 1: 1318, 3: 1136, 4: 697, 0: 615, 7: 469, 6: 462})

Epoch :  54 loss training:  3.73266677884385 Time :  9010
accuracy train: 0.999669 val: 0.704478 test: 0.710116
max validation accuracy : 0.716418 max acc epoch : 23 test accuracy : 0.714074
Counter({4: 1386, 1: 1320, 3: 1318, 5: 1136, 2: 691, 7: 615, 0: 470, 6: 464})

========================================================================================================================================================================================================
best acc epoch :  23
validation accuracy :  0.7164179104477612
test accuracy :  0.7140737076428395
last test_accuracy :  0.7101162503091764
second best val :  0.7104477611940299
second best test :  0.7140737076428395
max gap 9
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  19 	 val_accuracy : 0.77015 	 test_accuracy : 0.71407 	 last test_accuracy : 0.71630 	 second best val : 0.76418 	 second best test : 0.71407
k :  1 	 best_acc epoch :  19 	 val_accuracy : 0.75522 	 test_accuracy : 0.72026 	 last test_accuracy : 0.71358 	 second best val : 0.75224 	 second best test : 0.72026
k :  2 	 best_acc epoch :  62 	 val_accuracy : 0.73433 	 test_accuracy : 0.71383 	 last test_accuracy : 0.71778 	 second best val : 0.73134 	 second best test : 0.71383
k :  3 	 best_acc epoch :  23 	 val_accuracy : 0.71642 	 test_accuracy : 0.71407 	 last test_accuracy : 0.71012 	 second best val : 0.71045 	 second best test : 0.71407

avg :  	 val_accuracy : 0.74403 	 test_accuracy : 0.71556 	 last_accuracy : 0.71444 	 second best val : 0.73955 	 second best test : 0.71556

std :  	 val_accuracy : 0.02040 	 test_accuracy : 0.00272 	 last_accuracy : 0.00292 	 second best val : 0.02051 	 second best test : 0.00272


date and time :  Tue Jun 15 05:06:13 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=16, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=322, tsne=False, weight_decay=0)
device :  cuda:0
Counter({5: 607, 4: 549, 11: 528, 9: 527, 7: 525, 13: 506, 8: 504, 0: 495, 1: 492, 12: 492, 15: 441, 6: 440, 10: 407, 2: 332, 3: 318, 14: 237})

Epoch :  1 loss training:  208.65761280059814 Time :  24
accuracy train: 0.664461 val: 0.600000 test: 0.612417
max validation accuracy : 0.600000 max acc epoch : 1 test accuracy : 0.612417
Counter({9: 799, 11: 680, 6: 585, 12: 555, 13: 551, 2: 495, 4: 477, 7: 465, 5: 449, 8: 441, 15: 386, 14: 333, 3: 305, 0: 304, 1: 290, 10: 285})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  141.00019931793213 Time :  65
accuracy train: 0.722038 val: 0.653731 test: 0.647786
max validation accuracy : 0.653731 max acc epoch : 2 test accuracy : 0.647786
Counter({1: 811, 10: 709, 14: 549, 0: 549, 7: 500, 15: 488, 3: 469, 5: 453, 6: 444, 4: 403, 9: 395, 13: 387, 12: 371, 8: 306, 11: 284, 2: 282})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  119.14888587594032 Time :  113
accuracy train: 0.764725 val: 0.656716 test: 0.665100
max validation accuracy : 0.656716 max acc epoch : 3 test accuracy : 0.665100
Counter({2: 800, 11: 740, 9: 601, 15: 514, 14: 510, 13: 504, 10: 462, 6: 452, 3: 450, 4: 388, 12: 363, 0: 360, 1: 360, 5: 332, 7: 290, 8: 274})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  93.48175629973412 Time :  160
accuracy train: 0.787558 val: 0.638806 test: 0.685629
max validation accuracy : 0.656716 max acc epoch : 3 test accuracy : 0.665100
Counter({1: 813, 7: 760, 14: 585, 6: 523, 2: 497, 3: 488, 11: 461, 13: 455, 4: 442, 12: 396, 5: 366, 0: 357, 15: 350, 9: 325, 8: 301, 10: 281})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  87.2760421782732 Time :  202
accuracy train: 0.798478 val: 0.665672 test: 0.686372
max validation accuracy : 0.665672 max acc epoch : 5 test accuracy : 0.686372
Counter({13: 869, 0: 803, 7: 580, 9: 526, 4: 480, 8: 456, 12: 456, 1: 413, 3: 407, 10: 393, 5: 389, 2: 363, 15: 360, 6: 328, 14: 291, 11: 286})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  78.5841365903616 Time :  249
accuracy train: 0.832230 val: 0.677612 test: 0.701212
max validation accuracy : 0.677612 max acc epoch : 6 test accuracy : 0.701212
Counter({5: 865, 6: 738, 0: 555, 1: 534, 9: 498, 15: 488, 4: 449, 3: 419, 12: 411, 2: 401, 10: 398, 14: 383, 7: 357, 13: 324, 8: 290, 11: 290})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  68.74333827197552 Time :  305
accuracy train: 0.861350 val: 0.689552 test: 0.708138
max validation accuracy : 0.689552 max acc epoch : 7 test accuracy : 0.708138
Counter({8: 864, 9: 788, 12: 555, 1: 540, 2: 487, 11: 464, 6: 445, 5: 420, 0: 417, 13: 391, 14: 390, 3: 387, 15: 349, 7: 325, 4: 290, 10: 288})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.8332956135273 Time :  344
accuracy train: 0.859365 val: 0.689552 test: 0.705911
max validation accuracy : 0.689552 max acc epoch : 7 test accuracy : 0.708138
Counter({3: 1084, 5: 861, 9: 551, 7: 500, 6: 485, 0: 441, 15: 416, 8: 414, 11: 401, 13: 386, 14: 379, 1: 340, 4: 327, 2: 293, 12: 290, 10: 232})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.077950328588486 Time :  387
accuracy train: 0.874255 val: 0.689552 test: 0.706653
max validation accuracy : 0.689552 max acc epoch : 7 test accuracy : 0.708138
Counter({0: 1003, 4: 870, 9: 582, 11: 572, 10: 465, 13: 444, 14: 409, 12: 402, 2: 394, 15: 391, 1: 372, 3: 342, 6: 326, 5: 295, 8: 292, 7: 241})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  58.48930352926254 Time :  426
accuracy train: 0.878888 val: 0.686567 test: 0.706901
max validation accuracy : 0.689552 max acc epoch : 7 test accuracy : 0.708138
Counter({14: 873, 3: 634, 9: 593, 12: 581, 11: 556, 15: 461, 7: 454, 8: 445, 2: 401, 10: 392, 0: 387, 6: 374, 5: 340, 13: 326, 4: 295, 1: 288})

Epoch :  11 loss training:  55.16958285868168 Time :  482
accuracy train: 0.889808 val: 0.671642 test: 0.708880
max validation accuracy : 0.689552 max acc epoch : 7 test accuracy : 0.708138
Counter({13: 1029, 2: 876, 5: 590, 6: 553, 4: 463, 0: 446, 8: 402, 10: 401, 1: 397, 12: 393, 15: 366, 7: 341, 14: 329, 9: 293, 11: 288, 3: 233})

Epoch :  12 loss training:  51.067819744348526 Time :  525
accuracy train: 0.900066 val: 0.683582 test: 0.714321
max validation accuracy : 0.689552 max acc epoch : 7 test accuracy : 0.708138
Counter({0: 1018, 6: 875, 15: 591, 7: 552, 11: 460, 5: 446, 1: 411, 3: 402, 9: 396, 10: 388, 13: 371, 14: 338, 8: 331, 12: 295, 2: 287, 4: 239})

Epoch :  13 loss training:  49.3270663022995 Time :  570
accuracy train: 0.906353 val: 0.692537 test: 0.712342
max validation accuracy : 0.692537 max acc epoch : 13 test accuracy : 0.712342
Counter({11: 1018, 1: 877, 6: 594, 3: 542, 7: 461, 13: 445, 15: 413, 12: 400, 0: 396, 4: 388, 5: 368, 8: 338, 14: 330, 9: 296, 2: 288, 10: 246})

Epoch :  14 loss training:  45.80427946895361 Time :  636
accuracy train: 0.914626 val: 0.698507 test: 0.712095
max validation accuracy : 0.698507 max acc epoch : 14 test accuracy : 0.712095
Counter({8: 1001, 15: 882, 13: 592, 9: 539, 0: 465, 7: 442, 4: 418, 6: 406, 1: 400, 2: 389, 5: 367, 3: 334, 10: 330, 12: 297, 11: 288, 14: 250})

Epoch :  15 loss training:  44.80200809240341 Time :  676
accuracy train: 0.921575 val: 0.689552 test: 0.715805
max validation accuracy : 0.698507 max acc epoch : 14 test accuracy : 0.712095
Counter({11: 992, 9: 886, 7: 597, 10: 541, 5: 462, 3: 445, 4: 414, 1: 413, 2: 398, 15: 387, 13: 367, 12: 332, 6: 330, 8: 298, 14: 290, 0: 248})

Epoch :  16 loss training:  42.88462258130312 Time :  721
accuracy train: 0.932826 val: 0.689552 test: 0.720010
max validation accuracy : 0.698507 max acc epoch : 14 test accuracy : 0.712095
Counter({9: 886, 11: 709, 4: 688, 12: 594, 8: 540, 15: 466, 0: 446, 3: 420, 2: 399, 6: 390, 1: 367, 13: 330, 14: 327, 7: 300, 10: 289, 5: 249})

Epoch :  17 loss training:  38.10012832283974 Time :  767
accuracy train: 0.944739 val: 0.698507 test: 0.723720
max validation accuracy : 0.698507 max acc epoch : 14 test accuracy : 0.712095
Counter({9: 947, 13: 892, 0: 598, 2: 541, 8: 466, 1: 446, 3: 446, 5: 421, 12: 399, 4: 386, 10: 366, 15: 328, 7: 328, 14: 302, 6: 290, 11: 244})

Epoch :  18 loss training:  35.699857883155346 Time :  816
accuracy train: 0.958306 val: 0.704478 test: 0.719021
max validation accuracy : 0.704478 max acc epoch : 18 test accuracy : 0.719021
Counter({0: 899, 1: 612, 8: 567, 10: 552, 3: 546, 5: 493, 13: 470, 7: 441, 14: 402, 12: 402, 4: 393, 15: 377, 2: 329, 6: 328, 9: 308, 11: 281})

Epoch :  19 loss training:  35.51475137472153 Time :  863
accuracy train: 0.960291 val: 0.704478 test: 0.714568
max validation accuracy : 0.704478 max acc epoch : 18 test accuracy : 0.719021
Counter({12: 898, 0: 721, 5: 704, 13: 607, 2: 525, 3: 490, 8: 441, 7: 401, 9: 400, 15: 380, 4: 343, 1: 326, 6: 323, 11: 320, 14: 283, 10: 238})

Epoch :  20 loss training:  31.803889118134975 Time :  902
accuracy train: 0.965255 val: 0.701493 test: 0.719268
max validation accuracy : 0.704478 max acc epoch : 18 test accuracy : 0.719021
Counter({1: 892, 4: 620, 0: 558, 8: 543, 11: 533, 6: 493, 9: 490, 12: 444, 15: 401, 5: 399, 7: 393, 14: 372, 10: 325, 3: 324, 2: 324, 13: 289})

Epoch :  21 loss training:  30.9673108831048 Time :  958
accuracy train: 0.968233 val: 0.701493 test: 0.719763
max validation accuracy : 0.704478 max acc epoch : 18 test accuracy : 0.719021
Counter({5: 893, 0: 618, 14: 560, 13: 544, 10: 535, 6: 495, 11: 495, 2: 442, 1: 401, 8: 399, 4: 393, 9: 367, 3: 326, 15: 322, 7: 322, 12: 288})

Epoch :  22 loss training:  26.578627094626427 Time :  998
accuracy train: 0.968233 val: 0.698507 test: 0.723473
max validation accuracy : 0.704478 max acc epoch : 18 test accuracy : 0.719021
Counter({1: 892, 11: 618, 13: 572, 2: 543, 7: 536, 12: 498, 6: 488, 14: 439, 15: 398, 10: 396, 5: 395, 4: 370, 3: 326, 9: 321, 0: 320, 8: 288})

Epoch :  23 loss training:  26.257918193936348 Time :  1037
accuracy train: 0.966248 val: 0.704478 test: 0.715063
max validation accuracy : 0.704478 max acc epoch : 18 test accuracy : 0.719021
Counter({9: 896, 0: 809, 4: 635, 10: 603, 3: 524, 1: 499, 14: 439, 2: 401, 11: 397, 5: 373, 6: 344, 8: 329, 7: 318, 15: 315, 12: 285, 13: 233})

Epoch :  24 loss training:  23.037717022001743 Time :  1081
accuracy train: 0.978160 val: 0.710448 test: 0.723720
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({7: 902, 0: 845, 12: 605, 13: 599, 6: 527, 5: 501, 3: 434, 15: 403, 11: 398, 9: 370, 14: 347, 4: 329, 10: 314, 2: 313, 1: 280, 8: 233})

Epoch :  25 loss training:  23.604494586586952 Time :  1122
accuracy train: 0.983124 val: 0.698507 test: 0.722731
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({2: 907, 15: 897, 8: 606, 0: 549, 3: 525, 1: 501, 10: 434, 7: 402, 14: 395, 5: 368, 9: 344, 4: 328, 6: 318, 12: 310, 13: 280, 11: 236})

Epoch :  26 loss training:  20.620209518820047 Time :  1161
accuracy train: 0.982793 val: 0.695522 test: 0.719515
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({12: 910, 1: 882, 13: 606, 10: 570, 0: 527, 4: 499, 8: 435, 11: 411, 14: 388, 6: 367, 15: 345, 5: 329, 2: 310, 9: 305, 3: 280, 7: 236})

Epoch :  27 loss training:  18.940278865396976 Time :  1201
accuracy train: 0.985109 val: 0.695522 test: 0.721494
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({3: 918, 10: 879, 4: 598, 2: 573, 15: 525, 8: 504, 6: 435, 7: 406, 5: 390, 9: 367, 1: 347, 0: 330, 13: 310, 12: 304, 14: 280, 11: 234})

Epoch :  28 loss training:  18.12166517972946 Time :  1269
accuracy train: 0.988749 val: 0.695522 test: 0.724462
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({1: 919, 6: 872, 4: 596, 12: 582, 14: 512, 9: 506, 3: 434, 13: 406, 8: 387, 11: 370, 2: 349, 7: 335, 0: 309, 15: 303, 10: 282, 5: 238})

Epoch :  29 loss training:  17.861613132059574 Time :  1310
accuracy train: 0.992720 val: 0.692537 test: 0.720999
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({12: 929, 2: 908, 0: 598, 9: 545, 15: 507, 10: 506, 6: 432, 3: 404, 14: 390, 11: 367, 5: 349, 4: 338, 13: 303, 7: 301, 1: 285, 8: 238})

Epoch :  30 loss training:  16.441939014941454 Time :  1354
accuracy train: 0.993382 val: 0.695522 test: 0.720752
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({8: 931, 11: 890, 5: 592, 7: 566, 10: 513, 0: 510, 6: 432, 2: 401, 1: 388, 9: 363, 14: 342, 15: 341, 3: 303, 12: 302, 4: 285, 13: 241})

Epoch :  31 loss training:  14.254926750436425 Time :  1406
accuracy train: 0.992389 val: 0.695522 test: 0.719763
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({9: 938, 8: 895, 13: 594, 1: 563, 11: 513, 5: 507, 3: 431, 15: 399, 4: 392, 7: 364, 6: 343, 12: 339, 0: 301, 10: 292, 14: 284, 2: 245})

Epoch :  32 loss training:  14.201960006728768 Time :  1444
accuracy train: 0.996691 val: 0.701493 test: 0.715805
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({3: 938, 4: 891, 11: 588, 2: 568, 8: 515, 6: 509, 0: 430, 5: 407, 12: 385, 10: 364, 14: 344, 15: 341, 7: 300, 13: 290, 9: 283, 1: 247})

Epoch :  33 loss training:  13.016453785821795 Time :  1488
accuracy train: 0.995367 val: 0.698507 test: 0.721247
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({1: 939, 0: 921, 7: 591, 4: 552, 12: 544, 8: 527, 10: 472, 14: 430, 11: 403, 2: 386, 6: 364, 3: 302, 13: 300, 5: 287, 15: 281, 9: 101})

Epoch :  34 loss training:  12.282722080126405 Time :  1535
accuracy train: 0.995698 val: 0.695522 test: 0.716547
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({2: 950, 11: 916, 5: 583, 0: 556, 14: 519, 8: 517, 3: 431, 7: 389, 9: 382, 12: 362, 6: 346, 13: 339, 15: 303, 1: 285, 10: 281, 4: 241})

Epoch :  35 loss training:  9.635800190269947 Time :  1576
accuracy train: 0.996029 val: 0.692537 test: 0.718773
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({0: 964, 2: 929, 15: 587, 4: 544, 11: 521, 13: 514, 3: 429, 8: 377, 5: 377, 14: 362, 7: 346, 12: 341, 6: 306, 9: 282, 1: 281, 10: 240})

Epoch :  36 loss training:  10.409250730648637 Time :  1618
accuracy train: 0.997353 val: 0.704478 test: 0.717042
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({10: 927, 9: 596, 14: 559, 1: 548, 5: 545, 8: 522, 0: 514, 15: 463, 13: 424, 3: 371, 6: 362, 4: 347, 7: 347, 2: 308, 12: 286, 11: 281})

Epoch :  37 loss training:  10.269341424107552 Time :  1661
accuracy train: 0.995698 val: 0.695522 test: 0.718526
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({4: 984, 0: 933, 1: 591, 10: 543, 5: 541, 3: 517, 9: 424, 2: 371, 6: 362, 14: 360, 15: 345, 13: 324, 7: 305, 8: 285, 11: 280, 12: 235})

Epoch :  38 loss training:  8.718832842074335 Time :  1700
accuracy train: 0.997684 val: 0.704478 test: 0.713332
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({5: 981, 1: 929, 9: 584, 6: 554, 8: 543, 10: 520, 11: 424, 13: 367, 7: 367, 4: 359, 14: 345, 2: 317, 15: 305, 0: 283, 3: 279, 12: 243})

Epoch :  39 loss training:  8.061495531350374 Time :  1742
accuracy train: 0.997684 val: 0.704478 test: 0.722731
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({0: 942, 8: 593, 4: 548, 2: 542, 5: 535, 3: 532, 11: 513, 14: 472, 15: 424, 10: 375, 13: 359, 7: 354, 9: 347, 6: 303, 1: 285, 12: 276})

Epoch :  40 loss training:  9.044366586953402 Time :  1784
accuracy train: 0.997684 val: 0.698507 test: 0.720010
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({10: 991, 2: 954, 6: 578, 5: 551, 1: 530, 9: 516, 11: 423, 13: 386, 7: 361, 8: 348, 4: 347, 3: 316, 12: 304, 0: 280, 15: 275, 14: 240})

Epoch :  41 loss training:  7.392986623570323 Time :  1827
accuracy train: 0.999007 val: 0.689552 test: 0.716547
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({5: 986, 0: 958, 12: 582, 15: 549, 9: 527, 8: 513, 7: 423, 3: 385, 13: 362, 6: 351, 10: 348, 1: 316, 4: 302, 2: 282, 11: 274, 14: 242})

Epoch :  42 loss training:  6.591068221256137 Time :  1869
accuracy train: 0.998015 val: 0.698507 test: 0.712837
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({12: 961, 9: 590, 2: 552, 0: 542, 8: 535, 1: 527, 11: 511, 6: 464, 10: 421, 5: 382, 7: 361, 4: 353, 3: 345, 15: 302, 13: 280, 14: 274})

Epoch :  43 loss training:  6.610485305078328 Time :  1906
accuracy train: 0.998345 val: 0.701493 test: 0.712590
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({6: 998, 2: 970, 8: 582, 0: 550, 5: 524, 9: 508, 12: 417, 15: 393, 14: 360, 7: 352, 1: 338, 13: 318, 11: 302, 10: 280, 3: 269, 4: 239})

Epoch :  44 loss training:  6.292876378633082 Time :  1970
accuracy train: 0.998015 val: 0.698507 test: 0.714568
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({15: 977, 14: 584, 11: 566, 8: 549, 10: 528, 1: 517, 0: 494, 6: 475, 2: 417, 4: 392, 7: 360, 5: 352, 3: 342, 12: 301, 13: 280, 9: 266})

Epoch :  45 loss training:  5.365937313530594 Time :  2016
accuracy train: 0.998676 val: 0.695522 test: 0.716052
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({2: 1003, 8: 987, 3: 577, 13: 562, 10: 507, 0: 497, 9: 421, 6: 418, 12: 360, 15: 354, 5: 321, 14: 306, 7: 301, 1: 278, 4: 260, 11: 248})

Epoch :  46 loss training:  6.140459520742297 Time :  2050
accuracy train: 0.999338 val: 0.704478 test: 0.712590
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({2: 1007, 3: 993, 0: 569, 4: 560, 12: 511, 15: 503, 10: 418, 6: 417, 13: 358, 7: 351, 1: 315, 9: 311, 11: 298, 5: 276, 14: 257, 8: 256})

Epoch :  47 loss training:  5.326726370956749 Time :  2094
accuracy train: 0.999338 val: 0.701493 test: 0.715558
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({0: 999, 7: 574, 6: 569, 12: 543, 5: 542, 14: 507, 10: 500, 13: 470, 4: 424, 3: 416, 15: 358, 8: 354, 1: 317, 2: 298, 9: 276, 11: 253})

Epoch :  48 loss training:  5.207310555968434 Time :  2135
accuracy train: 0.998345 val: 0.710448 test: 0.718526
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({0: 1020, 3: 1006, 4: 571, 1: 559, 6: 510, 7: 480, 15: 427, 9: 418, 10: 357, 11: 356, 5: 311, 8: 308, 13: 300, 14: 273, 2: 254, 12: 250})

Epoch :  49 loss training:  4.542365314438939 Time :  2174
accuracy train: 0.999007 val: 0.701493 test: 0.714568
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({1: 1013, 2: 572, 13: 569, 6: 561, 11: 542, 8: 509, 12: 489, 0: 461, 15: 423, 10: 415, 9: 357, 14: 356, 3: 310, 5: 298, 4: 272, 7: 253})

Epoch :  50 loss training:  4.496492239413783 Time :  2222
accuracy train: 0.999007 val: 0.698507 test: 0.713579
max validation accuracy : 0.710448 max acc epoch : 24 test accuracy : 0.723720
Counter({12: 1017, 1: 1014, 15: 568, 7: 560, 9: 509, 4: 485, 8: 426, 10: 414, 6: 357, 0: 356, 5: 309, 3: 308, 11: 298, 2: 271, 13: 258, 14: 250})

Epoch :  51 loss training:  3.8987505009863526 Time :  2265
accuracy train: 0.999669 val: 0.713433 test: 0.710364
max validation accuracy : 0.713433 max acc epoch : 51 test accuracy : 0.710364
Counter({0: 1024, 2: 570, 14: 567, 13: 545, 4: 533, 9: 513, 8: 486, 7: 480, 12: 434, 3: 412, 1: 356, 6: 356, 11: 300, 10: 300, 15: 272, 5: 252})

Epoch :  52 loss training:  3.60949066048488 Time :  2308
accuracy train: 0.998345 val: 0.704478 test: 0.713826
max validation accuracy : 0.713433 max acc epoch : 51 test accuracy : 0.710364
Counter({3: 1030, 4: 1018, 7: 570, 5: 565, 0: 512, 6: 478, 10: 436, 14: 412, 9: 356, 15: 355, 2: 302, 11: 296, 8: 295, 13: 276, 12: 253, 1: 246})

Epoch :  53 loss training:  3.856295255245641 Time :  2354
accuracy train: 0.999007 val: 0.704478 test: 0.717042
max validation accuracy : 0.713433 max acc epoch : 51 test accuracy : 0.710364
Counter({5: 1035, 1: 572, 8: 562, 12: 547, 13: 518, 3: 506, 6: 475, 4: 473, 9: 450, 14: 410, 0: 356, 2: 354, 15: 311, 11: 298, 7: 276, 10: 257})

Epoch :  54 loss training:  3.3384958948008716 Time :  2395
accuracy train: 0.999338 val: 0.710448 test: 0.716547
max validation accuracy : 0.713433 max acc epoch : 51 test accuracy : 0.710364
Counter({3: 1036, 7: 1015, 0: 573, 11: 563, 6: 511, 14: 476, 1: 454, 4: 410, 10: 356, 15: 354, 12: 310, 9: 294, 8: 291, 5: 275, 2: 259, 13: 223})

Epoch :  55 loss training:  3.5043510422110558 Time :  2437
accuracy train: 0.999007 val: 0.710448 test: 0.709622
max validation accuracy : 0.713433 max acc epoch : 51 test accuracy : 0.710364
Counter({15: 1028, 13: 571, 9: 568, 14: 553, 3: 552, 7: 512, 0: 486, 5: 471, 10: 455, 12: 411, 8: 356, 2: 353, 11: 294, 6: 293, 4: 272, 1: 225})

Epoch :  56 loss training:  2.5864541933406144 Time :  2488
accuracy train: 0.998676 val: 0.719403 test: 0.713826
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({7: 1035, 9: 575, 14: 565, 15: 560, 8: 550, 13: 511, 1: 482, 12: 467, 3: 450, 2: 410, 10: 357, 5: 353, 11: 293, 4: 292, 6: 271, 0: 229})

Epoch :  57 loss training:  3.145454896148294 Time :  2535
accuracy train: 1.000000 val: 0.698507 test: 0.717289
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({0: 1046, 3: 577, 14: 571, 15: 566, 6: 547, 1: 503, 11: 474, 4: 461, 7: 452, 10: 408, 13: 355, 9: 354, 5: 292, 2: 292, 12: 271, 8: 231})

Epoch :  58 loss training:  3.2063560157548636 Time :  2575
accuracy train: 0.999007 val: 0.701493 test: 0.712837
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({15: 1048, 8: 576, 11: 571, 14: 565, 6: 547, 10: 497, 1: 479, 0: 464, 5: 447, 7: 405, 4: 355, 9: 354, 13: 294, 12: 294, 3: 270, 2: 234})

Epoch :  59 loss training:  2.6769469347782433 Time :  2623
accuracy train: 0.998345 val: 0.701493 test: 0.714816
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({2: 1160, 7: 848, 3: 572, 12: 560, 9: 557, 6: 480, 13: 445, 8: 405, 10: 361, 14: 352, 11: 308, 5: 296, 15: 295, 1: 272, 0: 253, 4: 236})

Epoch :  60 loss training:  2.4349002407398075 Time :  2670
accuracy train: 1.000000 val: 0.698507 test: 0.718279
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({5: 1159, 1: 855, 7: 569, 13: 562, 3: 555, 2: 480, 6: 442, 14: 404, 10: 361, 8: 352, 11: 309, 9: 299, 15: 295, 4: 265, 12: 257, 0: 236})

Epoch :  61 loss training:  2.7344027222134173 Time :  2712
accuracy train: 0.999338 val: 0.698507 test: 0.714074
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({3: 1162, 1: 853, 0: 571, 4: 569, 10: 557, 12: 472, 9: 440, 6: 402, 11: 363, 15: 352, 8: 308, 14: 298, 2: 295, 13: 264, 7: 257, 5: 237})

Epoch :  62 loss training:  1.8180800444679335 Time :  2751
accuracy train: 0.999669 val: 0.701493 test: 0.713826
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({0: 1034, 11: 627, 3: 566, 2: 558, 1: 539, 7: 538, 10: 498, 8: 440, 15: 404, 14: 395, 12: 358, 6: 352, 9: 298, 5: 297, 13: 260, 4: 236})

Epoch :  63 loss training:  2.650597997708246 Time :  2797
accuracy train: 0.999338 val: 0.716418 test: 0.717784
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({1: 1186, 5: 1034, 12: 559, 15: 545, 6: 502, 11: 438, 2: 404, 10: 394, 8: 356, 9: 352, 14: 297, 7: 297, 13: 294, 0: 255, 4: 250, 3: 237})

Epoch :  64 loss training:  1.859135795617476 Time :  2836
accuracy train: 0.998345 val: 0.695522 test: 0.715063
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({10: 1183, 3: 814, 5: 577, 8: 559, 9: 548, 2: 467, 1: 449, 14: 394, 4: 360, 6: 351, 15: 318, 13: 298, 11: 292, 7: 289, 0: 255, 12: 246})

Epoch :  65 loss training:  1.8923415945318993 Time :  2883
accuracy train: 0.999669 val: 0.704478 test: 0.720752
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({2: 1182, 4: 565, 10: 557, 13: 548, 7: 545, 1: 489, 5: 477, 12: 454, 15: 410, 6: 391, 0: 353, 11: 352, 8: 301, 9: 285, 14: 251, 3: 240})

Epoch :  66 loss training:  1.9325483534485102 Time :  2941
accuracy train: 0.999669 val: 0.701493 test: 0.718279
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({1: 1039, 2: 618, 12: 592, 15: 556, 9: 544, 5: 534, 14: 519, 11: 452, 10: 397, 6: 389, 8: 352, 13: 349, 7: 295, 0: 286, 3: 250, 4: 228})

Epoch :  67 loss training:  1.580711610848084 Time :  2983
accuracy train: 0.999338 val: 0.701493 test: 0.717784
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({4: 1192, 15: 743, 11: 562, 5: 558, 12: 548, 8: 486, 3: 454, 10: 397, 6: 389, 0: 355, 1: 352, 9: 292, 14: 291, 2: 284, 13: 261, 7: 236})

Epoch :  68 loss training:  1.9440907649695873 Time :  3023
accuracy train: 0.999338 val: 0.689552 test: 0.717042
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({9: 1189, 10: 709, 2: 569, 3: 567, 7: 553, 1: 536, 5: 483, 13: 446, 12: 382, 4: 354, 0: 350, 11: 293, 8: 288, 14: 232, 15: 227, 6: 222})

Epoch :  69 loss training:  1.9084072705591097 Time :  3082
accuracy train: 0.999669 val: 0.707463 test: 0.717536
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({1: 1188, 11: 707, 14: 574, 4: 563, 12: 551, 0: 485, 2: 448, 8: 433, 10: 382, 5: 359, 6: 349, 15: 294, 9: 288, 7: 282, 3: 262, 13: 235})

Epoch :  70 loss training:  1.4928226384799927 Time :  3121
accuracy train: 0.999669 val: 0.707463 test: 0.715063
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({2: 1058, 12: 816, 14: 721, 9: 562, 7: 544, 13: 450, 5: 425, 11: 384, 1: 372, 4: 358, 8: 350, 10: 294, 0: 287, 15: 282, 6: 262, 3: 235})

Epoch :  71 loss training:  1.7964868822018616 Time :  3160
accuracy train: 0.999669 val: 0.701493 test: 0.716300
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({5: 1058, 13: 705, 2: 609, 14: 597, 1: 562, 9: 543, 12: 452, 0: 424, 10: 383, 4: 359, 8: 350, 11: 292, 15: 285, 7: 282, 3: 264, 6: 235})

Epoch :  72 loss training:  2.080136032716837 Time :  3206
accuracy train: 0.999669 val: 0.701493 test: 0.718773
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({5: 1204, 0: 1053, 4: 709, 13: 560, 11: 539, 3: 448, 7: 383, 8: 360, 15: 350, 6: 294, 9: 287, 12: 280, 1: 262, 2: 235, 10: 229, 14: 207})

Epoch :  73 loss training:  1.2340536618139595 Time :  3251
accuracy train: 0.999669 val: 0.704478 test: 0.720999
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({1: 1201, 2: 1053, 12: 715, 4: 561, 9: 538, 5: 448, 6: 380, 3: 360, 15: 352, 8: 295, 11: 288, 10: 280, 14: 260, 13: 235, 7: 227, 0: 207})

Epoch :  74 loss training:  1.2422098179231398 Time :  3292
accuracy train: 0.999669 val: 0.713433 test: 0.715805
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({0: 1200, 15: 726, 6: 559, 1: 558, 4: 538, 14: 506, 12: 454, 11: 388, 7: 379, 5: 368, 3: 352, 8: 298, 2: 288, 13: 284, 10: 264, 9: 238})

Epoch :  75 loss training:  1.7554560192511417 Time :  3333
accuracy train: 0.999669 val: 0.704478 test: 0.719515
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({6: 725, 15: 606, 13: 601, 3: 565, 0: 565, 1: 544, 9: 540, 14: 502, 5: 459, 2: 376, 11: 375, 8: 368, 10: 352, 4: 299, 7: 283, 12: 240})

Epoch :  76 loss training:  1.7471503448905423 Time :  3375
accuracy train: 0.999669 val: 0.710448 test: 0.720257
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({9: 1205, 6: 729, 12: 567, 13: 565, 1: 541, 2: 501, 14: 454, 10: 375, 8: 367, 0: 352, 3: 351, 15: 300, 7: 285, 4: 282, 11: 264, 5: 262})

Epoch :  77 loss training:  1.6541547737433575 Time :  3415
accuracy train: 0.999338 val: 0.698507 test: 0.718773
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({0: 1200, 6: 734, 2: 563, 11: 560, 5: 543, 1: 512, 3: 456, 8: 374, 7: 367, 9: 366, 10: 352, 13: 299, 15: 284, 14: 282, 4: 263, 12: 245})

Epoch :  78 loss training:  0.9715758768434171 Time :  3454
accuracy train: 0.999007 val: 0.707463 test: 0.721494
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({0: 1071, 13: 833, 5: 738, 6: 563, 1: 540, 12: 457, 11: 374, 3: 367, 4: 366, 10: 365, 8: 351, 9: 299, 14: 284, 7: 282, 2: 266, 15: 244})

Epoch :  79 loss training:  1.5414963155053556 Time :  3510
accuracy train: 0.999338 val: 0.701493 test: 0.720505
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({2: 1200, 1: 1071, 13: 733, 0: 557, 4: 457, 9: 375, 10: 368, 14: 366, 6: 351, 15: 334, 8: 300, 7: 286, 11: 283, 3: 265, 12: 242, 5: 212})

Epoch :  80 loss training:  0.974900332163088 Time :  3549
accuracy train: 0.999338 val: 0.695522 test: 0.720752
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({6: 1199, 1: 1071, 3: 731, 12: 557, 4: 545, 2: 452, 11: 374, 10: 368, 5: 351, 14: 294, 7: 286, 0: 283, 8: 266, 15: 250, 9: 240, 13: 133})

Epoch :  81 loss training:  0.945446147758048 Time :  3588
accuracy train: 0.999669 val: 0.707463 test: 0.721494
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({4: 1199, 5: 733, 2: 563, 10: 560, 7: 551, 12: 542, 15: 508, 13: 449, 1: 374, 9: 369, 3: 351, 14: 300, 11: 283, 0: 248, 6: 239, 8: 131})

Epoch :  82 loss training:  1.0321629000245593 Time :  3652
accuracy train: 0.999669 val: 0.698507 test: 0.719763
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({14: 1071, 8: 729, 1: 607, 12: 593, 6: 559, 3: 541, 9: 531, 0: 449, 10: 375, 11: 369, 15: 352, 5: 287, 13: 286, 4: 269, 7: 251, 2: 131})

Epoch :  83 loss training:  1.3549758128356189 Time :  3690
accuracy train: 1.000000 val: 0.704478 test: 0.718279
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({2: 1200, 3: 1071, 1: 731, 13: 559, 15: 542, 4: 445, 7: 375, 8: 369, 9: 352, 11: 299, 10: 286, 5: 285, 6: 270, 0: 250, 14: 235, 12: 131})

Epoch :  84 loss training:  0.975234747340437 Time :  3732
accuracy train: 1.000000 val: 0.704478 test: 0.718279
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({15: 1200, 1: 730, 0: 562, 2: 559, 5: 557, 7: 543, 6: 509, 9: 445, 11: 375, 3: 366, 10: 352, 4: 300, 14: 284, 12: 251, 8: 235, 13: 132})

Epoch :  85 loss training:  0.6637002105708234 Time :  3782
accuracy train: 1.000000 val: 0.704478 test: 0.716300
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({1: 1200, 3: 1071, 13: 729, 7: 557, 10: 543, 11: 445, 8: 375, 5: 366, 4: 352, 12: 300, 6: 287, 15: 284, 0: 270, 9: 251, 14: 237, 2: 133})

Epoch :  86 loss training:  0.7254314858000726 Time :  3820
accuracy train: 1.000000 val: 0.707463 test: 0.719763
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({4: 1200, 1: 736, 2: 560, 5: 554, 14: 547, 3: 543, 7: 511, 10: 443, 6: 374, 9: 367, 11: 362, 15: 353, 0: 300, 13: 255, 12: 156, 8: 139})

Epoch :  87 loss training:  0.890439195180079 Time :  3858
accuracy train: 0.999669 val: 0.710448 test: 0.721741
max validation accuracy : 0.719403 max acc epoch : 56 test accuracy : 0.713826
Counter({2: 1068, 15: 741, 9: 611, 3: 589, 0: 552, 10: 545, 7: 542, 14: 446, 5: 373, 13: 367, 6: 355, 11: 300, 8: 292, 1: 249, 4: 236, 12: 134})

========================================================================================================================================================================================================
best acc epoch :  56
validation accuracy :  0.7194029850746269
test accuracy :  0.7138263665594855
last test_accuracy :  0.7217412812268118
second best val :  0.7164179104477612
second best test :  0.7138263665594855
max gap 27
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=16, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=329, tsne=False, weight_decay=0)
device :  cuda:0
Counter({9: 678, 10: 628, 4: 547, 13: 544, 3: 515, 12: 512, 14: 507, 2: 503, 11: 494, 7: 485, 6: 477, 15: 353, 8: 352, 1: 296, 5: 280, 0: 229})

Epoch :  1 loss training:  211.48823446035385 Time :  3913
accuracy train: 0.623428 val: 0.585075 test: 0.589166
max validation accuracy : 0.585075 max acc epoch : 1 test accuracy : 0.589166
Counter({11: 918, 5: 663, 4: 556, 9: 525, 13: 519, 14: 473, 12: 469, 8: 461, 6: 445, 0: 398, 3: 375, 2: 367, 7: 349, 1: 325, 10: 311, 15: 246})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  143.30130976438522 Time :  3953
accuracy train: 0.730973 val: 0.647761 test: 0.660648
max validation accuracy : 0.647761 max acc epoch : 2 test accuracy : 0.660648
Counter({12: 885, 10: 707, 9: 534, 3: 517, 8: 509, 7: 483, 13: 443, 6: 432, 14: 418, 5: 409, 4: 386, 1: 375, 15: 350, 0: 334, 11: 323, 2: 295})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  122.36168619990349 Time :  3995
accuracy train: 0.753475 val: 0.650746 test: 0.668810
max validation accuracy : 0.650746 max acc epoch : 3 test accuracy : 0.668810
Counter({12: 880, 10: 799, 9: 645, 1: 504, 13: 491, 7: 461, 3: 457, 6: 423, 4: 401, 15: 386, 5: 374, 0: 338, 2: 335, 8: 320, 14: 293, 11: 293})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.44727703928947 Time :  4031
accuracy train: 0.791198 val: 0.677612 test: 0.683898
max validation accuracy : 0.677612 max acc epoch : 4 test accuracy : 0.683898
Counter({13: 876, 6: 864, 4: 702, 3: 653, 7: 478, 9: 464, 8: 452, 2: 412, 12: 388, 0: 373, 15: 340, 14: 328, 11: 316, 1: 303, 5: 233, 10: 218})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  87.9971453845501 Time :  4076
accuracy train: 0.815023 val: 0.683582 test: 0.697502
max validation accuracy : 0.683582 max acc epoch : 5 test accuracy : 0.697502
Counter({2: 906, 8: 796, 1: 558, 3: 512, 9: 497, 12: 442, 0: 427, 13: 425, 11: 406, 14: 401, 10: 394, 4: 387, 5: 386, 15: 331, 6: 280, 7: 252})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  83.44374588131905 Time :  4112
accuracy train: 0.825281 val: 0.689552 test: 0.695770
max validation accuracy : 0.689552 max acc epoch : 6 test accuracy : 0.695770
Counter({6: 884, 9: 771, 7: 579, 1: 542, 11: 527, 15: 441, 4: 441, 13: 405, 8: 401, 12: 396, 2: 382, 14: 351, 5: 343, 10: 334, 0: 302, 3: 301})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  74.24803839623928 Time :  4151
accuracy train: 0.843481 val: 0.680597 test: 0.709622
max validation accuracy : 0.689552 max acc epoch : 6 test accuracy : 0.695770
Counter({4: 882, 1: 793, 5: 583, 15: 547, 12: 519, 8: 444, 2: 434, 7: 408, 0: 399, 6: 393, 13: 381, 14: 344, 9: 343, 10: 333, 3: 301, 11: 296})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  67.08109188079834 Time :  4212
accuracy train: 0.861019 val: 0.713433 test: 0.715558
max validation accuracy : 0.713433 max acc epoch : 8 test accuracy : 0.715558
Counter({5: 883, 2: 802, 6: 583, 14: 534, 1: 512, 13: 443, 9: 438, 3: 425, 7: 401, 8: 396, 12: 388, 11: 339, 15: 339, 4: 327, 0: 296, 10: 294})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.31303235888481 Time :  4247
accuracy train: 0.870946 val: 0.704478 test: 0.705417
max validation accuracy : 0.713433 max acc epoch : 8 test accuracy : 0.715558
Counter({1: 878, 6: 803, 5: 586, 2: 540, 12: 499, 0: 447, 4: 438, 13: 431, 3: 403, 11: 393, 15: 374, 10: 339, 9: 338, 7: 330, 14: 305, 8: 296})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.33443209528923 Time :  4285
accuracy train: 0.872270 val: 0.704478 test: 0.714074
max validation accuracy : 0.713433 max acc epoch : 8 test accuracy : 0.715558
Counter({4: 883, 11: 792, 5: 577, 7: 544, 3: 506, 14: 452, 0: 435, 8: 432, 1: 401, 13: 392, 2: 373, 10: 341, 12: 340, 9: 329, 6: 306, 15: 297})

Epoch :  11 loss training:  56.83135962486267 Time :  4331
accuracy train: 0.881205 val: 0.710448 test: 0.717784
max validation accuracy : 0.713433 max acc epoch : 8 test accuracy : 0.715558
Counter({4: 1024, 14: 878, 0: 595, 6: 575, 5: 512, 10: 496, 1: 436, 7: 393, 3: 363, 13: 344, 9: 331, 8: 327, 15: 326, 12: 299, 11: 282, 2: 219})

Epoch :  12 loss training:  53.37223547697067 Time :  4372
accuracy train: 0.887823 val: 0.728358 test: 0.719515
max validation accuracy : 0.728358 max acc epoch : 12 test accuracy : 0.719515
Counter({4: 1017, 3: 890, 0: 600, 14: 508, 13: 485, 1: 478, 2: 434, 5: 392, 12: 388, 10: 365, 8: 345, 6: 334, 9: 329, 11: 322, 7: 297, 15: 216})

Epoch :  13 loss training:  50.5387624502182 Time :  4410
accuracy train: 0.899073 val: 0.719403 test: 0.715558
max validation accuracy : 0.728358 max acc epoch : 12 test accuracy : 0.719515
Counter({6: 1022, 4: 884, 5: 600, 1: 512, 9: 488, 7: 481, 11: 429, 12: 391, 2: 379, 14: 365, 0: 342, 13: 331, 15: 325, 8: 322, 3: 301, 10: 228})

Epoch :  14 loss training:  47.50590954720974 Time :  4450
accuracy train: 0.911648 val: 0.728358 test: 0.721247
max validation accuracy : 0.728358 max acc epoch : 12 test accuracy : 0.719515
Counter({2: 1011, 5: 887, 0: 599, 10: 527, 12: 479, 11: 478, 1: 429, 4: 393, 9: 381, 14: 364, 8: 346, 15: 334, 6: 328, 13: 320, 3: 294, 7: 230})

Epoch :  15 loss training:  44.93533034622669 Time :  4496
accuracy train: 0.914957 val: 0.719403 test: 0.717536
max validation accuracy : 0.728358 max acc epoch : 12 test accuracy : 0.719515
Counter({8: 894, 13: 733, 5: 650, 7: 577, 3: 490, 12: 464, 2: 435, 9: 423, 0: 396, 4: 391, 15: 374, 14: 352, 10: 335, 11: 335, 1: 320, 6: 231})

Epoch :  16 loss training:  42.5505850315094 Time :  4536
accuracy train: 0.920913 val: 0.722388 test: 0.716794
max validation accuracy : 0.728358 max acc epoch : 12 test accuracy : 0.719515
Counter({3: 995, 4: 891, 14: 595, 12: 494, 5: 488, 7: 478, 11: 423, 2: 399, 8: 390, 1: 362, 9: 361, 6: 336, 0: 335, 13: 326, 10: 293, 15: 234})

Epoch :  17 loss training:  41.080473840236664 Time :  4579
accuracy train: 0.932164 val: 0.722388 test: 0.718031
max validation accuracy : 0.728358 max acc epoch : 12 test accuracy : 0.719515
Counter({2: 891, 15: 639, 6: 600, 10: 572, 9: 486, 8: 475, 3: 473, 7: 450, 11: 422, 12: 398, 5: 362, 4: 359, 13: 336, 0: 326, 1: 317, 14: 294})

Epoch :  18 loss training:  38.00976590812206 Time :  4635
accuracy train: 0.946062 val: 0.737313 test: 0.720752
max validation accuracy : 0.737313 max acc epoch : 18 test accuracy : 0.720752
Counter({2: 903, 3: 680, 6: 638, 9: 595, 4: 483, 15: 482, 13: 478, 8: 422, 7: 393, 10: 381, 14: 371, 12: 356, 11: 334, 5: 332, 0: 316, 1: 236})

Epoch :  19 loss training:  35.760618664324284 Time :  4674
accuracy train: 0.944077 val: 0.716418 test: 0.717042
max validation accuracy : 0.737313 max acc epoch : 18 test accuracy : 0.720752
Counter({12: 905, 2: 636, 1: 600, 6: 583, 7: 493, 13: 485, 10: 467, 11: 421, 4: 415, 9: 391, 14: 377, 3: 358, 8: 331, 0: 327, 15: 318, 5: 293})

Epoch :  20 loss training:  33.38276234269142 Time :  4713
accuracy train: 0.951026 val: 0.722388 test: 0.719268
max validation accuracy : 0.737313 max acc epoch : 18 test accuracy : 0.720752
Counter({13: 1016, 4: 907, 10: 612, 12: 491, 11: 486, 8: 470, 7: 420, 9: 391, 14: 370, 3: 357, 6: 355, 2: 342, 5: 328, 15: 323, 0: 293, 1: 239})

Epoch :  21 loss training:  30.884135648608208 Time :  4766
accuracy train: 0.950695 val: 0.716418 test: 0.719268
max validation accuracy : 0.737313 max acc epoch : 18 test accuracy : 0.720752
Counter({5: 919, 8: 687, 3: 617, 9: 617, 4: 484, 11: 482, 7: 478, 1: 419, 6: 392, 14: 379, 13: 360, 0: 355, 12: 329, 10: 322, 2: 318, 15: 242})

Epoch :  22 loss training:  28.16520730406046 Time :  4805
accuracy train: 0.965586 val: 0.722388 test: 0.721989
max validation accuracy : 0.737313 max acc epoch : 18 test accuracy : 0.720752
Counter({8: 992, 0: 907, 12: 629, 15: 489, 9: 475, 13: 475, 5: 414, 11: 389, 6: 381, 3: 363, 14: 355, 1: 350, 4: 326, 2: 311, 10: 299, 7: 245})

Epoch :  23 loss training:  26.504449918866158 Time :  4845
accuracy train: 0.964593 val: 0.734328 test: 0.722483
max validation accuracy : 0.737313 max acc epoch : 18 test accuracy : 0.720752
Counter({0: 980, 11: 907, 9: 627, 2: 492, 7: 482, 12: 473, 4: 412, 13: 390, 8: 378, 14: 362, 10: 362, 5: 359, 1: 325, 3: 304, 6: 296, 15: 251})

Epoch :  24 loss training:  25.83506401628256 Time :  4889
accuracy train: 0.972204 val: 0.728358 test: 0.715805
max validation accuracy : 0.737313 max acc epoch : 18 test accuracy : 0.720752
Counter({6: 1300, 12: 630, 7: 514, 11: 499, 0: 491, 2: 467, 4: 419, 10: 414, 5: 396, 14: 383, 13: 361, 8: 358, 15: 318, 9: 299, 1: 292, 3: 259})

Epoch :  25 loss training:  24.787122294306755 Time :  4932
accuracy train: 0.979153 val: 0.725373 test: 0.717536
max validation accuracy : 0.737313 max acc epoch : 18 test accuracy : 0.720752
Counter({6: 959, 2: 916, 3: 629, 11: 505, 8: 495, 12: 473, 15: 418, 14: 395, 13: 380, 9: 361, 7: 358, 5: 346, 4: 317, 0: 297, 10: 292, 1: 259})

Epoch :  26 loss training:  22.275943115353584 Time :  4970
accuracy train: 0.979484 val: 0.725373 test: 0.719763
max validation accuracy : 0.737313 max acc epoch : 18 test accuracy : 0.720752
Counter({14: 953, 0: 919, 1: 631, 10: 496, 13: 495, 3: 476, 7: 417, 8: 396, 11: 377, 15: 359, 5: 359, 9: 358, 6: 312, 2: 297, 12: 295, 4: 260})

Epoch :  27 loss training:  20.510474652051926 Time :  5011
accuracy train: 0.980146 val: 0.728358 test: 0.720752
max validation accuracy : 0.737313 max acc epoch : 18 test accuracy : 0.720752
Counter({0: 954, 5: 916, 13: 631, 1: 499, 15: 494, 12: 476, 9: 416, 7: 394, 14: 378, 6: 362, 4: 360, 11: 358, 3: 311, 8: 296, 10: 296, 2: 259})

Epoch :  28 loss training:  19.140700362622738 Time :  5050
accuracy train: 0.979484 val: 0.749254 test: 0.717784
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.717784
Counter({14: 954, 4: 922, 5: 629, 6: 502, 1: 501, 15: 471, 13: 417, 11: 392, 2: 378, 3: 360, 8: 357, 0: 356, 7: 310, 10: 297, 12: 296, 9: 258})

Epoch :  29 loss training:  19.567406583577394 Time :  5087
accuracy train: 0.985440 val: 0.746269 test: 0.723225
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.717784
Counter({1: 700, 7: 694, 4: 671, 10: 636, 3: 497, 0: 495, 2: 481, 14: 456, 5: 418, 8: 396, 9: 382, 15: 361, 6: 356, 11: 309, 12: 298, 13: 250})

Epoch :  30 loss training:  17.286413624882698 Time :  5127
accuracy train: 0.985771 val: 0.734328 test: 0.720010
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.717784
Counter({3: 949, 1: 725, 12: 644, 2: 637, 6: 496, 0: 474, 4: 443, 15: 415, 14: 395, 11: 383, 13: 360, 9: 352, 7: 305, 10: 297, 8: 277, 5: 248})

Epoch :  31 loss training:  15.027461424469948 Time :  5171
accuracy train: 0.987095 val: 0.728358 test: 0.716300
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.717784
Counter({1: 1292, 5: 656, 2: 505, 0: 494, 3: 488, 14: 463, 11: 462, 4: 417, 7: 392, 15: 386, 13: 353, 10: 353, 8: 306, 6: 295, 12: 282, 9: 256})

Epoch :  32 loss training:  15.743897005915642 Time :  5208
accuracy train: 0.991727 val: 0.731343 test: 0.719515
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.717784
Counter({2: 959, 10: 935, 8: 646, 15: 499, 5: 498, 11: 468, 1: 413, 4: 387, 9: 385, 6: 366, 14: 353, 0: 352, 7: 304, 13: 294, 3: 283, 12: 258})

Epoch :  33 loss training:  13.131210997700691 Time :  5247
accuracy train: 0.989742 val: 0.737313 test: 0.720752
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.717784
Counter({9: 942, 12: 632, 11: 549, 0: 529, 2: 506, 13: 490, 6: 473, 10: 466, 3: 412, 1: 387, 8: 386, 4: 371, 15: 358, 5: 312, 7: 302, 14: 285})

Epoch :  34 loss training:  12.79310892894864 Time :  5314
accuracy train: 0.988418 val: 0.743284 test: 0.718279
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.717784
Counter({15: 939, 1: 632, 11: 530, 0: 528, 7: 518, 10: 511, 13: 483, 12: 465, 8: 410, 9: 384, 6: 381, 5: 370, 2: 356, 3: 352, 14: 286, 4: 255})

Epoch :  35 loss training:  12.843991758301854 Time :  5351
accuracy train: 0.992720 val: 0.734328 test: 0.719763
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.717784
Counter({3: 973, 6: 935, 13: 638, 8: 533, 10: 529, 0: 476, 11: 410, 14: 386, 12: 379, 15: 378, 1: 348, 2: 330, 9: 288, 5: 287, 7: 259, 4: 251})

Epoch :  36 loss training:  10.645174852572381 Time :  5387
accuracy train: 0.995698 val: 0.725373 test: 0.722978
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.717784
Counter({4: 972, 14: 942, 13: 638, 3: 537, 12: 532, 2: 473, 10: 412, 9: 385, 6: 378, 1: 372, 8: 345, 15: 328, 11: 290, 5: 289, 7: 257, 0: 250})

Epoch :  37 loss training:  10.758278299123049 Time :  5442
accuracy train: 0.996029 val: 0.731343 test: 0.717784
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.717784
Counter({9: 984, 10: 672, 7: 639, 1: 529, 2: 528, 3: 469, 12: 469, 5: 451, 4: 404, 11: 386, 15: 374, 8: 339, 0: 311, 6: 291, 13: 291, 14: 263})

Epoch :  38 loss training:  9.983233788982034 Time :  5481
accuracy train: 0.996691 val: 0.725373 test: 0.720505
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.717784
Counter({0: 978, 9: 683, 12: 627, 10: 532, 7: 526, 2: 464, 1: 463, 6: 457, 14: 397, 11: 384, 4: 371, 13: 338, 8: 332, 5: 293, 15: 291, 3: 264})

Epoch :  39 loss training:  8.608665029518306 Time :  5520
accuracy train: 0.997684 val: 0.716418 test: 0.722483
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.717784
Counter({2: 983, 6: 713, 15: 622, 7: 529, 13: 527, 1: 472, 11: 463, 10: 442, 9: 396, 12: 384, 5: 372, 4: 338, 8: 311, 3: 294, 0: 291, 14: 263})

Epoch :  40 loss training:  8.647908360697329 Time :  5565
accuracy train: 0.995367 val: 0.734328 test: 0.717042
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.717784
Counter({14: 932, 15: 644, 3: 598, 2: 536, 9: 531, 5: 505, 12: 494, 10: 448, 1: 397, 11: 388, 0: 372, 8: 367, 4: 341, 6: 294, 7: 291, 13: 262})

Epoch :  41 loss training:  7.181664918549359 Time :  5606
accuracy train: 0.996691 val: 0.725373 test: 0.720752
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.717784
Counter({8: 990, 11: 986, 4: 621, 14: 526, 15: 493, 1: 456, 6: 443, 0: 394, 3: 389, 13: 371, 12: 333, 10: 321, 9: 294, 2: 292, 5: 259, 7: 232})

Epoch :  42 loss training:  8.008942306041718 Time :  5644
accuracy train: 0.996360 val: 0.728358 test: 0.722731
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.717784
Counter({0: 1157, 8: 701, 12: 617, 5: 529, 9: 511, 14: 503, 1: 494, 7: 396, 10: 389, 2: 371, 11: 329, 4: 320, 13: 295, 3: 292, 6: 260, 15: 236})

Epoch :  43 loss training:  6.971037975978106 Time :  5686
accuracy train: 0.999338 val: 0.734328 test: 0.719763
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.717784
Counter({0: 990, 13: 826, 1: 687, 9: 607, 6: 525, 4: 519, 5: 398, 2: 389, 7: 366, 3: 363, 10: 328, 12: 315, 15: 296, 14: 290, 8: 261, 11: 240})

Epoch :  44 loss training:  6.780711312312633 Time :  5728
accuracy train: 0.998345 val: 0.734328 test: 0.719763
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.717784
Counter({0: 1150, 13: 720, 6: 604, 5: 526, 3: 525, 4: 524, 8: 466, 2: 397, 12: 391, 7: 371, 14: 333, 9: 313, 1: 295, 15: 291, 10: 260, 11: 234})

Epoch :  45 loss training:  6.207283486612141 Time :  5767
accuracy train: 0.998345 val: 0.746269 test: 0.715805
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.717784
Counter({11: 1148, 1: 721, 0: 607, 3: 523, 5: 522, 4: 510, 9: 488, 2: 397, 7: 391, 15: 371, 10: 331, 13: 313, 14: 294, 12: 293, 6: 259, 8: 232})

Epoch :  46 loss training:  5.341170734493062 Time :  5810
accuracy train: 0.999007 val: 0.731343 test: 0.716052
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.717784
Counter({1: 1152, 12: 724, 15: 600, 2: 522, 8: 522, 6: 514, 14: 487, 10: 398, 4: 391, 9: 375, 3: 331, 5: 308, 13: 294, 0: 291, 11: 259, 7: 232})

Epoch :  47 loss training:  5.435833842027932 Time :  5861
accuracy train: 0.999669 val: 0.740299 test: 0.714568
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.717784
Counter({7: 1002, 11: 827, 4: 712, 5: 601, 15: 529, 12: 524, 8: 399, 3: 389, 13: 374, 6: 331, 9: 329, 14: 308, 0: 295, 1: 289, 10: 257, 2: 234})

Epoch :  48 loss training:  4.926633984781802 Time :  5899
accuracy train: 0.998015 val: 0.737313 test: 0.716794
max validation accuracy : 0.749254 max acc epoch : 28 test accuracy : 0.717784
Counter({2: 1141, 1: 1002, 6: 728, 0: 601, 7: 527, 5: 399, 13: 389, 10: 374, 11: 328, 12: 296, 8: 295, 4: 293, 14: 291, 3: 257, 9: 245, 15: 234})

Epoch :  49 loss training:  4.281977495644242 Time :  5946
accuracy train: 0.998676 val: 0.755224 test: 0.718031
max validation accuracy : 0.755224 max acc epoch : 49 test accuracy : 0.718031
Counter({4: 1001, 11: 823, 5: 713, 3: 603, 1: 532, 12: 528, 9: 399, 13: 389, 10: 372, 2: 339, 6: 326, 15: 297, 0: 295, 14: 292, 7: 257, 8: 234})

Epoch :  50 loss training:  4.411331076174974 Time :  6005
accuracy train: 0.998676 val: 0.743284 test: 0.715063
max validation accuracy : 0.755224 max acc epoch : 49 test accuracy : 0.718031
Counter({0: 1146, 5: 729, 12: 605, 9: 530, 3: 530, 4: 517, 15: 484, 8: 399, 10: 392, 13: 373, 7: 327, 2: 294, 6: 293, 1: 291, 11: 257, 14: 233})

Epoch :  51 loss training:  4.421703626401722 Time :  6044
accuracy train: 0.998676 val: 0.737313 test: 0.719268
max validation accuracy : 0.755224 max acc epoch : 49 test accuracy : 0.718031
Counter({0: 1142, 6: 737, 3: 600, 9: 532, 11: 529, 10: 521, 1: 483, 4: 400, 7: 391, 8: 373, 2: 324, 13: 297, 14: 294, 15: 290, 12: 254, 5: 233})

Epoch :  52 loss training:  3.5698353587649763 Time :  6086
accuracy train: 0.997684 val: 0.743284 test: 0.723473
max validation accuracy : 0.755224 max acc epoch : 49 test accuracy : 0.718031
Counter({0: 1141, 4: 740, 9: 600, 7: 535, 14: 529, 1: 513, 15: 492, 10: 396, 2: 391, 11: 373, 6: 322, 3: 297, 12: 293, 13: 290, 5: 254, 8: 234})

Epoch :  53 loss training:  3.366432646056637 Time :  6138
accuracy train: 0.997684 val: 0.746269 test: 0.718526
max validation accuracy : 0.755224 max acc epoch : 49 test accuracy : 0.718031
Counter({0: 828, 15: 731, 14: 621, 3: 552, 10: 535, 2: 517, 13: 491, 9: 489, 1: 398, 6: 390, 7: 372, 4: 333, 12: 318, 8: 295, 5: 291, 11: 239})

Epoch :  54 loss training:  4.261004483094439 Time :  6183
accuracy train: 0.998676 val: 0.752239 test: 0.719515
max validation accuracy : 0.755224 max acc epoch : 49 test accuracy : 0.718031
Counter({5: 1155, 2: 745, 0: 606, 12: 543, 11: 535, 15: 533, 4: 474, 14: 400, 9: 388, 3: 371, 10: 314, 13: 295, 1: 291, 8: 265, 7: 246, 6: 239})

Epoch :  55 loss training:  3.106994612608105 Time :  6219
accuracy train: 0.999007 val: 0.743284 test: 0.722236
max validation accuracy : 0.755224 max acc epoch : 49 test accuracy : 0.718031
Counter({5: 1007, 1: 827, 14: 743, 11: 608, 10: 542, 15: 534, 7: 398, 9: 387, 0: 370, 8: 333, 13: 314, 2: 295, 3: 290, 4: 264, 12: 248, 6: 240})

Epoch :  56 loss training:  2.7974744292441756 Time :  6262
accuracy train: 0.998676 val: 0.737313 test: 0.718279
max validation accuracy : 0.755224 max acc epoch : 49 test accuracy : 0.718031
Counter({9: 1156, 1: 746, 11: 606, 3: 543, 14: 536, 10: 536, 5: 471, 7: 400, 6: 383, 8: 370, 15: 314, 2: 296, 0: 290, 13: 265, 4: 246, 12: 242})

Epoch :  57 loss training:  3.3571318122558296 Time :  6300
accuracy train: 0.998676 val: 0.740299 test: 0.720010
max validation accuracy : 0.755224 max acc epoch : 49 test accuracy : 0.718031
Counter({0: 1007, 15: 849, 1: 745, 3: 605, 9: 545, 8: 541, 5: 401, 4: 383, 6: 370, 2: 311, 11: 308, 13: 295, 7: 287, 14: 268, 12: 243, 10: 242})

Epoch :  58 loss training:  2.5227438912261277 Time :  6337
accuracy train: 0.999338 val: 0.737313 test: 0.725699
max validation accuracy : 0.755224 max acc epoch : 49 test accuracy : 0.718031
Counter({12: 1007, 2: 836, 6: 748, 0: 602, 11: 541, 1: 539, 3: 401, 8: 383, 7: 370, 13: 323, 14: 313, 5: 295, 10: 287, 15: 268, 4: 244, 9: 243})

Epoch :  59 loss training:  2.1806210898794234 Time :  6377
accuracy train: 0.999669 val: 0.752239 test: 0.719763
max validation accuracy : 0.755224 max acc epoch : 49 test accuracy : 0.718031
Counter({6: 1154, 10: 1005, 11: 589, 13: 541, 2: 508, 4: 445, 8: 391, 12: 384, 3: 372, 7: 368, 14: 312, 5: 294, 1: 284, 9: 264, 0: 246, 15: 243})

Epoch :  60 loss training:  2.3091749229934067 Time :  6427
accuracy train: 0.998676 val: 0.734328 test: 0.718031
max validation accuracy : 0.755224 max acc epoch : 49 test accuracy : 0.718031
Counter({9: 1148, 8: 1005, 10: 588, 13: 540, 1: 528, 11: 439, 14: 392, 0: 384, 12: 371, 5: 370, 7: 311, 15: 291, 4: 286, 6: 261, 3: 243, 2: 243})

Epoch :  61 loss training:  2.385969907976687 Time :  6466
accuracy train: 0.999338 val: 0.749254 test: 0.720010
max validation accuracy : 0.755224 max acc epoch : 49 test accuracy : 0.718031
Counter({4: 1147, 6: 607, 2: 542, 11: 539, 0: 535, 1: 476, 9: 473, 15: 429, 5: 395, 13: 384, 10: 373, 7: 363, 8: 312, 12: 295, 3: 286, 14: 244})

Epoch :  62 loss training:  3.241476576658897 Time :  6502
accuracy train: 0.998015 val: 0.746269 test: 0.720999
max validation accuracy : 0.755224 max acc epoch : 49 test accuracy : 0.718031
Counter({0: 1150, 7: 767, 5: 591, 6: 543, 2: 535, 15: 516, 1: 497, 4: 405, 11: 383, 12: 374, 13: 312, 10: 294, 14: 289, 9: 258, 8: 244, 3: 242})

Epoch :  63 loss training:  2.814005433348939 Time :  6562
accuracy train: 0.998015 val: 0.725373 test: 0.719021
max validation accuracy : 0.755224 max acc epoch : 49 test accuracy : 0.718031
Counter({1: 1016, 10: 836, 14: 760, 3: 595, 2: 536, 9: 531, 6: 406, 8: 383, 5: 371, 0: 317, 12: 312, 11: 293, 7: 292, 15: 264, 4: 245, 13: 243})

Epoch :  64 loss training:  2.469780833926052 Time :  6600
accuracy train: 0.999669 val: 0.731343 test: 0.715063
max validation accuracy : 0.755224 max acc epoch : 49 test accuracy : 0.718031
Counter({1: 1015, 0: 837, 3: 764, 14: 596, 7: 534, 6: 528, 5: 406, 8: 383, 10: 371, 12: 318, 11: 314, 15: 292, 13: 291, 4: 262, 2: 246, 9: 243})

Epoch :  65 loss training:  2.4755878014257178 Time :  6638
accuracy train: 0.999338 val: 0.746269 test: 0.717536
max validation accuracy : 0.755224 max acc epoch : 49 test accuracy : 0.718031
Counter({0: 1014, 3: 837, 12: 747, 7: 591, 14: 542, 4: 484, 10: 423, 11: 406, 8: 383, 6: 371, 9: 317, 13: 315, 2: 294, 15: 289, 1: 249, 5: 138})

Epoch :  66 loss training:  2.201335128280334 Time :  6687
accuracy train: 0.999007 val: 0.749254 test: 0.719268
max validation accuracy : 0.755224 max acc epoch : 49 test accuracy : 0.718031
Counter({5: 1014, 12: 837, 15: 746, 9: 586, 13: 552, 3: 541, 11: 405, 6: 383, 10: 371, 1: 316, 8: 315, 2: 297, 4: 290, 14: 263, 0: 244, 7: 240})

Epoch :  67 loss training:  2.3939108493505046 Time :  6724
accuracy train: 0.999669 val: 0.731343 test: 0.716794
max validation accuracy : 0.755224 max acc epoch : 49 test accuracy : 0.718031
Counter({4: 1012, 12: 845, 6: 747, 9: 582, 15: 553, 8: 542, 13: 404, 14: 384, 5: 371, 7: 312, 2: 310, 3: 298, 1: 290, 10: 262, 11: 246, 0: 242})

Epoch :  68 loss training:  1.552646353840828 Time :  6762
accuracy train: 1.000000 val: 0.746269 test: 0.719021
max validation accuracy : 0.755224 max acc epoch : 49 test accuracy : 0.718031
Counter({0: 1158, 14: 578, 8: 544, 13: 542, 12: 530, 9: 521, 2: 495, 6: 470, 5: 393, 4: 383, 15: 366, 7: 313, 1: 296, 10: 289, 3: 278, 11: 244})

Epoch :  69 loss training:  1.6620307507691905 Time :  6803
accuracy train: 0.999338 val: 0.737313 test: 0.718773
max validation accuracy : 0.755224 max acc epoch : 49 test accuracy : 0.718031
Counter({0: 1157, 8: 754, 12: 581, 5: 545, 7: 541, 3: 536, 9: 490, 6: 408, 10: 382, 4: 365, 1: 308, 15: 295, 11: 289, 2: 266, 14: 242, 13: 241})

Epoch :  70 loss training:  1.7314648155588657 Time :  6842
accuracy train: 0.999669 val: 0.728358 test: 0.712095
max validation accuracy : 0.755224 max acc epoch : 49 test accuracy : 0.718031
Counter({0: 1156, 7: 1026, 5: 752, 11: 585, 6: 494, 4: 423, 3: 408, 2: 381, 15: 365, 13: 325, 14: 304, 10: 295, 12: 289, 8: 242, 9: 224, 1: 131})

Epoch :  71 loss training:  1.390341849590186 Time :  6878
accuracy train: 0.999007 val: 0.746269 test: 0.715063
max validation accuracy : 0.755224 max acc epoch : 49 test accuracy : 0.718031
Counter({5: 1156, 6: 1026, 1: 748, 0: 585, 13: 547, 7: 424, 11: 409, 12: 381, 8: 365, 9: 304, 4: 293, 15: 287, 3: 269, 10: 239, 14: 235, 2: 132})

Epoch :  72 loss training:  1.4891156133962795 Time :  6917
accuracy train: 1.000000 val: 0.734328 test: 0.714568
max validation accuracy : 0.755224 max acc epoch : 49 test accuracy : 0.718031
Counter({1: 1156, 3: 746, 13: 583, 0: 559, 5: 552, 7: 551, 9: 467, 4: 409, 8: 381, 2: 366, 14: 302, 12: 296, 6: 290, 11: 267, 10: 238, 15: 237})

Epoch :  73 loss training:  1.6818808873358648 Time :  6975
accuracy train: 0.999007 val: 0.728358 test: 0.717289
max validation accuracy : 0.755224 max acc epoch : 49 test accuracy : 0.718031
Counter({7: 837, 14: 745, 3: 583, 9: 575, 6: 554, 13: 549, 12: 503, 15: 475, 8: 430, 0: 411, 10: 381, 4: 366, 1: 320, 5: 293, 2: 239, 11: 139})

Epoch :  74 loss training:  1.7783367678057402 Time :  7009
accuracy train: 0.999669 val: 0.746269 test: 0.717289
max validation accuracy : 0.755224 max acc epoch : 49 test accuracy : 0.718031
Counter({1: 1158, 2: 743, 13: 584, 0: 552, 5: 550, 9: 500, 15: 475, 8: 423, 12: 410, 10: 381, 6: 369, 7: 293, 11: 293, 14: 292, 3: 238, 4: 139})

Epoch :  75 loss training:  1.3030013334937394 Time :  7052
accuracy train: 0.999007 val: 0.758209 test: 0.716547
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({2: 1027, 13: 834, 5: 749, 11: 584, 14: 550, 9: 549, 6: 409, 7: 380, 8: 370, 1: 324, 4: 298, 10: 293, 15: 292, 12: 265, 3: 240, 0: 236})

Epoch :  76 loss training:  1.348236086545512 Time :  7095
accuracy train: 1.000000 val: 0.743284 test: 0.716794
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({0: 1014, 15: 832, 2: 758, 8: 589, 6: 555, 5: 547, 12: 408, 10: 379, 1: 370, 3: 327, 13: 298, 11: 294, 4: 292, 9: 260, 7: 242, 14: 235})

Epoch :  77 loss training:  1.3840165654546581 Time :  7131
accuracy train: 1.000000 val: 0.737313 test: 0.717784
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({3: 1013, 5: 746, 6: 586, 4: 554, 1: 546, 12: 499, 2: 486, 14: 431, 9: 406, 10: 378, 13: 368, 11: 299, 7: 298, 0: 292, 8: 261, 15: 237})

Epoch :  78 loss training:  1.7703366103814915 Time :  7171
accuracy train: 1.000000 val: 0.743284 test: 0.714321
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({1: 862, 2: 755, 6: 587, 0: 557, 3: 546, 13: 518, 15: 507, 5: 496, 9: 404, 12: 378, 10: 369, 14: 313, 4: 296, 7: 292, 11: 283, 8: 237})

Epoch :  79 loss training:  1.0559967221925035 Time :  7211
accuracy train: 1.000000 val: 0.743284 test: 0.717042
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({6: 1175, 12: 752, 3: 581, 2: 546, 0: 520, 9: 495, 1: 484, 5: 431, 11: 405, 8: 378, 14: 369, 13: 302, 4: 295, 7: 294, 10: 237, 15: 136})

Epoch :  80 loss training:  1.5073938975983765 Time :  7251
accuracy train: 0.999669 val: 0.731343 test: 0.714568
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({7: 1175, 1: 749, 4: 580, 14: 559, 0: 547, 2: 516, 13: 501, 5: 405, 3: 377, 8: 369, 15: 298, 10: 294, 6: 293, 9: 254, 12: 246, 11: 237})

Epoch :  81 loss training:  1.1088098072796129 Time :  7289
accuracy train: 1.000000 val: 0.749254 test: 0.717042
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({2: 1175, 12: 749, 13: 587, 7: 548, 8: 522, 0: 496, 1: 475, 9: 433, 3: 405, 4: 377, 10: 369, 15: 297, 14: 293, 5: 289, 11: 252, 6: 133})

Epoch :  82 loss training:  1.2484178851009347 Time :  7327
accuracy train: 1.000000 val: 0.737313 test: 0.717536
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({11: 864, 2: 750, 9: 585, 0: 563, 1: 547, 13: 543, 10: 487, 3: 475, 4: 404, 8: 377, 6: 369, 12: 311, 14: 298, 5: 295, 15: 291, 7: 241})

Epoch :  83 loss training:  0.9971534743672237 Time :  7392
accuracy train: 0.999669 val: 0.743284 test: 0.716300
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({0: 1175, 5: 752, 8: 579, 2: 565, 10: 547, 1: 544, 11: 474, 7: 404, 14: 377, 9: 369, 4: 298, 15: 293, 6: 291, 3: 251, 12: 247, 13: 234})

Epoch :  84 loss training:  1.3432703996659257 Time :  7431
accuracy train: 1.000000 val: 0.743284 test: 0.717289
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({2: 1017, 5: 751, 7: 589, 12: 587, 3: 579, 6: 567, 4: 548, 10: 404, 8: 376, 1: 369, 9: 295, 14: 293, 15: 293, 0: 254, 11: 247, 13: 231})

Epoch :  85 loss training:  1.3878863150603138 Time :  7469
accuracy train: 0.999338 val: 0.743284 test: 0.716547
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({3: 1164, 14: 593, 15: 575, 10: 550, 5: 517, 6: 502, 8: 469, 4: 436, 12: 397, 13: 376, 0: 369, 2: 312, 7: 296, 1: 295, 9: 292, 11: 257})

Epoch :  86 loss training:  1.159427268372383 Time :  7525
accuracy train: 1.000000 val: 0.740299 test: 0.716052
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({3: 1016, 0: 763, 12: 716, 6: 575, 14: 548, 13: 469, 4: 449, 2: 439, 8: 402, 7: 376, 5: 371, 9: 300, 1: 294, 10: 290, 11: 257, 15: 135})

Epoch :  87 loss training:  0.9879695701529272 Time :  7565
accuracy train: 1.000000 val: 0.743284 test: 0.714568
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({2: 1165, 6: 769, 3: 571, 13: 546, 15: 545, 0: 470, 4: 454, 7: 405, 10: 404, 14: 376, 5: 370, 11: 302, 12: 291, 1: 254, 8: 252, 9: 226})

Epoch :  88 loss training:  1.0500552867015358 Time :  7601
accuracy train: 1.000000 val: 0.758209 test: 0.715063
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({4: 1165, 14: 772, 11: 568, 15: 560, 0: 547, 2: 509, 13: 506, 7: 404, 1: 375, 9: 370, 5: 302, 6: 298, 12: 291, 3: 255, 8: 252, 10: 226})

Epoch :  89 loss training:  0.8491662463056855 Time :  7643
accuracy train: 1.000000 val: 0.743284 test: 0.715063
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({0: 1165, 3: 774, 10: 567, 2: 561, 7: 548, 9: 519, 1: 496, 4: 404, 12: 375, 8: 370, 6: 302, 14: 300, 11: 287, 13: 255, 5: 252, 15: 225})

Epoch :  90 loss training:  1.0496550268144347 Time :  7681
accuracy train: 1.000000 val: 0.743284 test: 0.710364
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({11: 850, 7: 773, 10: 568, 4: 564, 6: 552, 13: 536, 15: 480, 2: 470, 14: 404, 3: 375, 12: 370, 1: 315, 5: 302, 9: 300, 0: 284, 8: 257})

Epoch :  91 loss training:  0.9461328386969399 Time :  7718
accuracy train: 1.000000 val: 0.740299 test: 0.713084
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({2: 1016, 3: 848, 0: 777, 12: 567, 1: 564, 6: 552, 7: 404, 5: 375, 8: 370, 13: 317, 4: 302, 10: 300, 11: 281, 15: 255, 9: 244, 14: 228})

Epoch :  92 loss training:  0.982135772384936 Time :  7758
accuracy train: 1.000000 val: 0.740299 test: 0.714321
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({0: 1165, 5: 1016, 15: 774, 14: 564, 6: 552, 10: 441, 9: 403, 8: 375, 11: 370, 1: 300, 3: 299, 12: 279, 2: 255, 7: 246, 13: 228, 4: 133})

Epoch :  93 loss training:  0.9659119676798582 Time :  7828
accuracy train: 1.000000 val: 0.737313 test: 0.717042
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({3: 1163, 7: 777, 15: 565, 1: 552, 12: 521, 4: 495, 13: 471, 11: 443, 14: 403, 5: 375, 8: 370, 2: 302, 0: 298, 9: 280, 10: 254, 6: 131})

Epoch :  94 loss training:  1.2769213683204725 Time :  7864
accuracy train: 1.000000 val: 0.728358 test: 0.716794
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({12: 850, 2: 778, 5: 569, 9: 565, 10: 552, 8: 523, 13: 495, 4: 489, 6: 405, 3: 375, 11: 369, 1: 313, 15: 303, 7: 302, 14: 287, 0: 225})

Epoch :  95 loss training:  1.7551333863520995 Time :  7901
accuracy train: 1.000000 val: 0.731343 test: 0.709869
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({2: 1161, 4: 1018, 5: 781, 10: 564, 8: 551, 11: 445, 6: 406, 7: 376, 12: 368, 1: 303, 9: 303, 13: 284, 3: 249, 15: 247, 14: 220, 0: 124})

Epoch :  96 loss training:  0.886358860792825 Time :  7949
accuracy train: 1.000000 val: 0.746269 test: 0.711848
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({1: 1161, 2: 1018, 6: 781, 4: 562, 14: 551, 9: 445, 5: 406, 8: 376, 15: 368, 13: 303, 11: 300, 0: 283, 10: 250, 12: 249, 7: 220, 3: 127})

Epoch :  97 loss training:  1.006812130799517 Time :  7987
accuracy train: 0.999669 val: 0.740299 test: 0.711600
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({6: 827, 7: 784, 14: 566, 13: 564, 2: 550, 4: 516, 12: 503, 15: 464, 8: 408, 11: 376, 9: 368, 10: 335, 0: 304, 1: 300, 5: 281, 3: 254})

Epoch :  98 loss training:  1.6933634965971578 Time :  8028
accuracy train: 1.000000 val: 0.734328 test: 0.709622
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({2: 1019, 15: 866, 9: 787, 11: 566, 14: 560, 7: 549, 5: 406, 8: 376, 4: 368, 13: 305, 1: 297, 3: 296, 12: 282, 0: 255, 6: 248, 10: 220})

Epoch :  99 loss training:  1.236102283524815 Time :  8070
accuracy train: 1.000000 val: 0.734328 test: 0.714568
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({3: 781, 13: 770, 11: 565, 0: 561, 2: 549, 6: 518, 12: 501, 5: 467, 14: 407, 4: 393, 9: 376, 1: 368, 15: 306, 10: 298, 8: 282, 7: 258})

Epoch :  100 loss training:  1.0421345858921995 Time :  8110
accuracy train: 1.000000 val: 0.740299 test: 0.713579
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({9: 1020, 15: 777, 7: 690, 3: 557, 4: 548, 14: 491, 0: 479, 1: 443, 5: 408, 13: 376, 8: 370, 2: 303, 10: 300, 6: 279, 11: 231, 12: 128})

Epoch :  101 loss training:  0.6856611659459304 Time :  8149
accuracy train: 0.999669 val: 0.743284 test: 0.714568
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({3: 1169, 1: 776, 7: 562, 5: 548, 14: 529, 2: 491, 0: 462, 13: 442, 12: 408, 9: 376, 10: 370, 8: 300, 11: 297, 4: 277, 15: 257, 6: 136})

Epoch :  102 loss training:  1.2086474746174645 Time :  8191
accuracy train: 1.000000 val: 0.740299 test: 0.714074
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({7: 1168, 1: 776, 10: 561, 9: 548, 8: 545, 6: 485, 2: 476, 3: 447, 4: 408, 5: 376, 12: 370, 13: 300, 15: 297, 0: 277, 14: 236, 11: 130})

Epoch :  103 loss training:  0.82075573898328 Time :  8235
accuracy train: 0.999338 val: 0.740299 test: 0.713579
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({1: 1169, 3: 777, 11: 559, 6: 555, 4: 547, 0: 518, 12: 509, 2: 447, 14: 407, 10: 377, 9: 369, 5: 299, 7: 264, 15: 246, 13: 221, 8: 136})

Epoch :  104 loss training:  0.8340664972638479 Time :  8271
accuracy train: 1.000000 val: 0.740299 test: 0.713332
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({0: 1169, 2: 1026, 7: 774, 15: 560, 10: 549, 1: 462, 12: 445, 11: 377, 5: 368, 9: 327, 14: 299, 13: 290, 6: 269, 3: 264, 4: 136, 8: 85})

Epoch :  105 loss training:  0.9831310696608853 Time :  8310
accuracy train: 1.000000 val: 0.743284 test: 0.711848
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({1: 1169, 12: 774, 0: 572, 2: 557, 3: 530, 15: 496, 4: 466, 6: 408, 10: 377, 9: 368, 7: 349, 13: 303, 5: 294, 14: 270, 11: 264, 8: 203})

Epoch :  106 loss training:  1.0772909583465662 Time :  8369
accuracy train: 0.999669 val: 0.740299 test: 0.709869
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716547
Counter({4: 1168, 0: 773, 10: 570, 5: 557, 2: 554, 6: 552, 12: 467, 14: 408, 3: 377, 8: 368, 13: 306, 11: 292, 7: 276, 9: 265, 1: 246, 15: 221})

========================================================================================================================================================================================================
best acc epoch :  75
validation accuracy :  0.7582089552238805
test accuracy :  0.716547118476379
last test_accuracy :  0.7098689092258225
second best val :  0.755223880597015
second best test :  0.7180311649765025
max gap 26
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=16, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=224, tsne=False, weight_decay=0)
device :  cuda:0
Counter({12: 661, 0: 576, 10: 549, 15: 543, 1: 542, 7: 521, 13: 511, 6: 501, 4: 491, 3: 457, 14: 415, 11: 395, 9: 386, 2: 322, 8: 302, 5: 228})

Epoch :  1 loss training:  214.51243352890015 Time :  8415
accuracy train: 0.639312 val: 0.585075 test: 0.595350
max validation accuracy : 0.585075 max acc epoch : 1 test accuracy : 0.595350
Counter({14: 976, 2: 689, 5: 585, 3: 573, 8: 494, 12: 488, 1: 461, 6: 410, 9: 394, 0: 390, 4: 390, 13: 332, 11: 326, 10: 322, 7: 304, 15: 266})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  139.59838140010834 Time :  8556
accuracy train: 0.707478 val: 0.641791 test: 0.649270
max validation accuracy : 0.641791 max acc epoch : 2 test accuracy : 0.649270
Counter({3: 1037, 2: 750, 0: 604, 1: 569, 10: 533, 11: 522, 8: 433, 7: 367, 5: 365, 12: 359, 4: 350, 14: 335, 6: 316, 15: 302, 9: 292, 13: 266})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  119.71094763278961 Time :  8592
accuracy train: 0.736267 val: 0.644776 test: 0.657433
max validation accuracy : 0.644776 max acc epoch : 3 test accuracy : 0.657433
Counter({9: 840, 5: 752, 8: 587, 1: 556, 7: 531, 6: 517, 11: 493, 4: 446, 13: 372, 15: 363, 10: 341, 14: 331, 0: 329, 2: 328, 3: 310, 12: 304})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  96.0446029305458 Time :  8680
accuracy train: 0.792191 val: 0.659701 test: 0.687114
max validation accuracy : 0.659701 max acc epoch : 4 test accuracy : 0.687114
Counter({9: 968, 0: 751, 6: 596, 15: 549, 1: 534, 12: 493, 14: 459, 11: 396, 8: 386, 4: 361, 2: 349, 7: 330, 3: 324, 13: 318, 10: 306, 5: 280})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  87.01302260160446 Time :  8715
accuracy train: 0.808074 val: 0.641791 test: 0.691318
max validation accuracy : 0.659701 max acc epoch : 4 test accuracy : 0.687114
Counter({13: 923, 15: 759, 2: 598, 3: 557, 5: 536, 9: 509, 11: 476, 12: 400, 4: 391, 7: 358, 8: 347, 1: 324, 10: 320, 14: 319, 6: 300, 0: 283})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  81.85897193849087 Time :  8812
accuracy train: 0.829914 val: 0.665672 test: 0.699728
max validation accuracy : 0.665672 max acc epoch : 6 test accuracy : 0.699728
Counter({10: 978, 13: 759, 14: 603, 15: 554, 1: 526, 4: 503, 6: 451, 7: 412, 5: 391, 12: 360, 9: 344, 11: 323, 0: 315, 2: 314, 3: 290, 8: 277})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  71.34928584098816 Time :  8910
accuracy train: 0.850761 val: 0.635821 test: 0.703933
max validation accuracy : 0.665672 max acc epoch : 6 test accuracy : 0.699728
Counter({3: 970, 10: 740, 11: 610, 14: 549, 15: 535, 5: 503, 0: 453, 4: 411, 12: 396, 9: 364, 2: 338, 7: 330, 1: 324, 13: 307, 6: 296, 8: 274})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.94325530529022 Time :  8947
accuracy train: 0.852085 val: 0.668657 test: 0.711600
max validation accuracy : 0.668657 max acc epoch : 8 test accuracy : 0.711600
Counter({7: 994, 15: 974, 3: 586, 1: 534, 8: 476, 4: 465, 14: 455, 0: 412, 13: 401, 2: 365, 11: 352, 10: 327, 5: 307, 9: 298, 6: 275, 12: 179})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.46729592978954 Time :  8986
accuracy train: 0.873263 val: 0.659701 test: 0.706159
max validation accuracy : 0.668657 max acc epoch : 8 test accuracy : 0.711600
Counter({7: 1053, 3: 963, 2: 590, 4: 541, 5: 462, 10: 462, 8: 422, 11: 417, 6: 411, 13: 351, 0: 327, 1: 325, 15: 305, 14: 302, 9: 276, 12: 193})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  58.74656002223492 Time :  9032
accuracy train: 0.868299 val: 0.665672 test: 0.711600
max validation accuracy : 0.668657 max acc epoch : 8 test accuracy : 0.711600
Counter({2: 961, 13: 670, 8: 654, 14: 527, 15: 513, 1: 494, 6: 463, 0: 425, 9: 418, 11: 410, 7: 346, 12: 333, 10: 306, 5: 304, 3: 299, 4: 277})

Epoch :  11 loss training:  56.467548578977585 Time :  9077
accuracy train: 0.882528 val: 0.671642 test: 0.707643
max validation accuracy : 0.671642 max acc epoch : 11 test accuracy : 0.707643
Counter({9: 1045, 0: 951, 14: 588, 5: 535, 10: 471, 3: 463, 1: 433, 4: 432, 15: 406, 7: 349, 8: 331, 11: 328, 13: 300, 6: 299, 12: 282, 2: 187})

Epoch :  12 loss training:  53.04474966228008 Time :  9116
accuracy train: 0.892124 val: 0.671642 test: 0.715558
max validation accuracy : 0.671642 max acc epoch : 11 test accuracy : 0.707643
Counter({1: 1046, 3: 948, 9: 574, 11: 549, 2: 465, 13: 463, 0: 437, 6: 429, 7: 410, 10: 351, 5: 333, 8: 327, 12: 302, 15: 300, 14: 280, 4: 186})

Epoch :  13 loss training:  52.383893221616745 Time :  9159
accuracy train: 0.908339 val: 0.665672 test: 0.713084
max validation accuracy : 0.671642 max acc epoch : 11 test accuracy : 0.707643
Counter({5: 939, 7: 668, 15: 652, 1: 532, 10: 514, 0: 471, 4: 460, 12: 434, 8: 433, 9: 415, 11: 352, 14: 334, 13: 311, 6: 302, 2: 302, 3: 281})

Epoch :  14 loss training:  48.0819501504302 Time :  9201
accuracy train: 0.910986 val: 0.677612 test: 0.715558
max validation accuracy : 0.677612 max acc epoch : 14 test accuracy : 0.715558
Counter({0: 940, 5: 673, 2: 655, 11: 528, 4: 506, 1: 479, 14: 458, 10: 439, 3: 432, 9: 412, 8: 348, 15: 334, 12: 310, 13: 305, 7: 297, 6: 284})

Epoch :  15 loss training:  45.81511637568474 Time :  9243
accuracy train: 0.923230 val: 0.680597 test: 0.715063
max validation accuracy : 0.680597 max acc epoch : 15 test accuracy : 0.715063
Counter({12: 944, 6: 742, 5: 677, 4: 545, 2: 536, 13: 457, 8: 451, 1: 442, 15: 431, 11: 409, 7: 353, 10: 341, 9: 302, 14: 294, 3: 286, 0: 190})

Epoch :  16 loss training:  43.04771611094475 Time :  9290
accuracy train: 0.923561 val: 0.680597 test: 0.714568
max validation accuracy : 0.680597 max acc epoch : 15 test accuracy : 0.715063
Counter({1: 930, 11: 741, 4: 682, 7: 548, 6: 526, 3: 458, 12: 451, 5: 441, 0: 434, 8: 412, 9: 358, 15: 346, 13: 300, 2: 294, 10: 288, 14: 191})

Epoch :  17 loss training:  40.66379863023758 Time :  9330
accuracy train: 0.925546 val: 0.680597 test: 0.711848
max validation accuracy : 0.680597 max acc epoch : 15 test accuracy : 0.715063
Counter({8: 762, 1: 678, 9: 577, 3: 560, 15: 541, 12: 513, 0: 479, 6: 456, 4: 455, 5: 432, 10: 368, 7: 357, 2: 350, 11: 298, 13: 290, 14: 284})

Epoch :  18 loss training:  39.10416278988123 Time :  9371
accuracy train: 0.946724 val: 0.671642 test: 0.715805
max validation accuracy : 0.680597 max acc epoch : 15 test accuracy : 0.715063
Counter({6: 756, 10: 682, 8: 577, 4: 556, 1: 553, 5: 513, 2: 482, 9: 457, 3: 453, 11: 435, 7: 361, 14: 354, 12: 349, 0: 298, 15: 291, 13: 283})

Epoch :  19 loss training:  35.91891450434923 Time :  9410
accuracy train: 0.949371 val: 0.677612 test: 0.720505
max validation accuracy : 0.680597 max acc epoch : 15 test accuracy : 0.715063
Counter({3: 945, 4: 746, 1: 680, 15: 571, 0: 514, 14: 466, 5: 450, 13: 432, 6: 429, 2: 422, 8: 354, 9: 348, 12: 297, 11: 292, 7: 283, 10: 171})

Epoch :  20 loss training:  34.219049260020256 Time :  9457
accuracy train: 0.949040 val: 0.674627 test: 0.720010
max validation accuracy : 0.680597 max acc epoch : 15 test accuracy : 0.715063
Counter({6: 937, 5: 748, 0: 681, 2: 572, 3: 520, 11: 465, 4: 442, 12: 428, 15: 425, 1: 424, 13: 358, 9: 349, 10: 295, 7: 292, 8: 282, 14: 182})

Epoch :  21 loss training:  32.76795956492424 Time :  9495
accuracy train: 0.953673 val: 0.674627 test: 0.717042
max validation accuracy : 0.680597 max acc epoch : 15 test accuracy : 0.715063
Counter({3: 933, 4: 771, 7: 661, 1: 568, 15: 520, 11: 466, 0: 440, 9: 428, 12: 426, 13: 425, 5: 356, 6: 351, 10: 296, 14: 290, 2: 281, 8: 188})

Epoch :  22 loss training:  31.13787480816245 Time :  9534
accuracy train: 0.967571 val: 0.677612 test: 0.711106
max validation accuracy : 0.680597 max acc epoch : 15 test accuracy : 0.715063
Counter({6: 927, 15: 774, 4: 656, 0: 570, 1: 515, 12: 471, 11: 441, 14: 428, 7: 428, 5: 423, 9: 356, 3: 351, 13: 295, 10: 290, 2: 282, 8: 193})

Epoch :  23 loss training:  28.624832689762115 Time :  9580
accuracy train: 0.964262 val: 0.683582 test: 0.721989
max validation accuracy : 0.683582 max acc epoch : 23 test accuracy : 0.721989
Counter({6: 781, 0: 654, 4: 581, 14: 573, 11: 548, 7: 511, 2: 487, 3: 454, 12: 443, 9: 427, 10: 364, 15: 354, 13: 352, 5: 299, 1: 289, 8: 283})

Epoch :  24 loss training:  24.886655755341053 Time :  9621
accuracy train: 0.961615 val: 0.680597 test: 0.714568
max validation accuracy : 0.683582 max acc epoch : 23 test accuracy : 0.721989
Counter({3: 941, 14: 635, 4: 579, 5: 575, 7: 518, 1: 502, 12: 488, 0: 444, 8: 419, 2: 412, 13: 354, 9: 351, 15: 311, 11: 299, 10: 289, 6: 283})

Epoch :  25 loss training:  24.81213954091072 Time :  9660
accuracy train: 0.969887 val: 0.686567 test: 0.721494
max validation accuracy : 0.686567 max acc epoch : 25 test accuracy : 0.721494
Counter({5: 941, 2: 785, 14: 664, 1: 569, 13: 506, 4: 476, 3: 446, 11: 418, 8: 411, 12: 402, 10: 355, 9: 352, 7: 295, 15: 286, 6: 284, 0: 210})

Epoch :  26 loss training:  22.66696796193719 Time :  9708
accuracy train: 0.971873 val: 0.689552 test: 0.721989
max validation accuracy : 0.689552 max acc epoch : 26 test accuracy : 0.721989
Counter({1: 941, 15: 781, 6: 663, 5: 569, 3: 512, 11: 477, 4: 448, 10: 416, 14: 410, 9: 388, 8: 355, 0: 353, 7: 294, 13: 286, 12: 282, 2: 225})

Epoch :  27 loss training:  21.073063753545284 Time :  9748
accuracy train: 0.982131 val: 0.695522 test: 0.712837
max validation accuracy : 0.695522 max acc epoch : 27 test accuracy : 0.712837
Counter({2: 942, 10: 628, 11: 581, 0: 562, 9: 524, 4: 508, 13: 507, 12: 445, 1: 413, 8: 412, 14: 354, 3: 353, 6: 314, 5: 294, 15: 284, 7: 279})

Epoch :  28 loss training:  19.817357197403908 Time :  9788
accuracy train: 0.986433 val: 0.686567 test: 0.717536
max validation accuracy : 0.695522 max acc epoch : 27 test accuracy : 0.712837
Counter({2: 944, 11: 772, 1: 682, 12: 575, 3: 508, 5: 488, 13: 438, 4: 411, 9: 406, 0: 388, 8: 354, 6: 352, 10: 295, 7: 285, 14: 278, 15: 224})

Epoch :  29 loss training:  18.318898890167475 Time :  9834
accuracy train: 0.985440 val: 0.695522 test: 0.717784
max validation accuracy : 0.695522 max acc epoch : 27 test accuracy : 0.712837
Counter({4: 943, 7: 617, 0: 584, 13: 565, 8: 530, 2: 520, 11: 506, 1: 435, 15: 430, 10: 394, 14: 352, 12: 351, 9: 318, 3: 291, 6: 285, 5: 279})

Epoch :  30 loss training:  17.09728778898716 Time :  9869
accuracy train: 0.987426 val: 0.686567 test: 0.716052
max validation accuracy : 0.695522 max acc epoch : 27 test accuracy : 0.712837
Counter({2: 945, 4: 818, 0: 641, 11: 576, 6: 509, 15: 494, 14: 436, 12: 427, 13: 388, 3: 382, 5: 353, 7: 348, 9: 292, 8: 285, 1: 280, 10: 226})

Epoch :  31 loss training:  15.282822467386723 Time :  9909
accuracy train: 0.990404 val: 0.686567 test: 0.718526
max validation accuracy : 0.695522 max acc epoch : 27 test accuracy : 0.712837
Counter({5: 945, 15: 807, 2: 650, 7: 576, 14: 506, 12: 495, 3: 437, 0: 429, 1: 387, 4: 378, 9: 353, 11: 349, 8: 292, 13: 285, 6: 279, 10: 232})

Epoch :  32 loss training:  14.504922049120069 Time :  9972
accuracy train: 0.988749 val: 0.701493 test: 0.720257
max validation accuracy : 0.701493 max acc epoch : 32 test accuracy : 0.720257
Counter({1: 947, 4: 807, 3: 648, 5: 577, 0: 510, 12: 503, 9: 438, 11: 428, 13: 385, 7: 369, 2: 354, 6: 350, 10: 290, 8: 284, 15: 273, 14: 237})

Epoch :  33 loss training:  14.438961185514927 Time :  10008
accuracy train: 0.994044 val: 0.683582 test: 0.719763
max validation accuracy : 0.701493 max acc epoch : 32 test accuracy : 0.720257
Counter({0: 818, 8: 638, 14: 592, 6: 561, 1: 557, 5: 521, 4: 517, 10: 448, 11: 435, 15: 384, 3: 381, 13: 354, 12: 352, 7: 286, 9: 283, 2: 273})

Epoch :  34 loss training:  13.28747883066535 Time :  10045
accuracy train: 0.992058 val: 0.683582 test: 0.716547
max validation accuracy : 0.701493 max acc epoch : 32 test accuracy : 0.720257
Counter({9: 970, 7: 806, 4: 648, 11: 583, 10: 515, 14: 501, 8: 434, 12: 412, 13: 387, 1: 357, 2: 355, 5: 352, 6: 286, 0: 283, 3: 273, 15: 238})

Epoch :  35 loss training:  12.178739845752716 Time :  10113
accuracy train: 0.994375 val: 0.680597 test: 0.714568
max validation accuracy : 0.701493 max acc epoch : 32 test accuracy : 0.720257
Counter({1: 969, 6: 834, 0: 622, 11: 579, 5: 522, 4: 495, 10: 435, 9: 414, 13: 385, 8: 356, 3: 353, 12: 352, 15: 286, 14: 283, 2: 273, 7: 242})

Epoch :  36 loss training:  10.506902119144797 Time :  10148
accuracy train: 0.993713 val: 0.695522 test: 0.716547
max validation accuracy : 0.701493 max acc epoch : 32 test accuracy : 0.720257
Counter({5: 870, 10: 590, 7: 586, 3: 566, 2: 543, 14: 536, 1: 524, 4: 435, 12: 431, 0: 404, 11: 361, 15: 358, 9: 353, 6: 285, 13: 283, 8: 275})

Epoch :  37 loss training:  10.564680127426982 Time :  10187
accuracy train: 0.995698 val: 0.692537 test: 0.717536
max validation accuracy : 0.701493 max acc epoch : 32 test accuracy : 0.720257
Counter({0: 895, 7: 588, 5: 569, 8: 561, 13: 549, 15: 533, 10: 526, 12: 435, 1: 433, 11: 402, 6: 363, 14: 358, 3: 350, 2: 283, 4: 283, 9: 272})

Epoch :  38 loss training:  10.105808990076184 Time :  10231
accuracy train: 0.997022 val: 0.674627 test: 0.713826
max validation accuracy : 0.701493 max acc epoch : 32 test accuracy : 0.720257
Counter({0: 973, 8: 909, 7: 575, 2: 549, 3: 529, 6: 503, 15: 435, 9: 423, 14: 360, 1: 359, 11: 352, 12: 348, 10: 283, 5: 279, 13: 273, 4: 250})

Epoch :  39 loss training:  8.944820005446672 Time :  10269
accuracy train: 0.995367 val: 0.686567 test: 0.713084
max validation accuracy : 0.701493 max acc epoch : 32 test accuracy : 0.720257
Counter({11: 975, 4: 914, 0: 574, 1: 544, 3: 533, 8: 507, 10: 434, 12: 422, 5: 360, 15: 359, 9: 349, 7: 348, 14: 283, 6: 276, 2: 270, 13: 252})

Epoch :  40 loss training:  8.040327484719455 Time :  10307
accuracy train: 0.995036 val: 0.704478 test: 0.713332
max validation accuracy : 0.704478 max acc epoch : 40 test accuracy : 0.713332
Counter({3: 967, 1: 657, 11: 581, 4: 550, 15: 545, 5: 529, 14: 512, 13: 433, 7: 422, 6: 365, 12: 359, 0: 350, 9: 301, 10: 282, 8: 276, 2: 271})

Epoch :  41 loss training:  8.02105202153325 Time :  10345
accuracy train: 0.997022 val: 0.683582 test: 0.714074
max validation accuracy : 0.704478 max acc epoch : 40 test accuracy : 0.713332
Counter({3: 967, 15: 949, 7: 566, 1: 541, 4: 520, 2: 519, 5: 433, 11: 414, 8: 365, 13: 359, 14: 350, 10: 344, 6: 282, 0: 274, 9: 269, 12: 248})

Epoch :  42 loss training:  7.071961675770581 Time :  10394
accuracy train: 0.996029 val: 0.692537 test: 0.711848
max validation accuracy : 0.704478 max acc epoch : 40 test accuracy : 0.713332
Counter({0: 969, 1: 954, 3: 560, 2: 543, 5: 519, 8: 517, 11: 433, 12: 420, 4: 361, 7: 355, 9: 349, 10: 346, 6: 283, 14: 269, 15: 269, 13: 253})

Epoch :  43 loss training:  7.2316819643601775 Time :  10430
accuracy train: 0.998015 val: 0.680597 test: 0.714568
max validation accuracy : 0.704478 max acc epoch : 40 test accuracy : 0.713332
Counter({5: 957, 12: 590, 4: 566, 2: 551, 6: 533, 1: 525, 3: 524, 13: 439, 9: 431, 7: 407, 14: 361, 8: 349, 11: 348, 10: 285, 0: 268, 15: 266})

Epoch :  44 loss training:  6.24873450351879 Time :  10469
accuracy train: 0.998676 val: 0.689552 test: 0.716052
max validation accuracy : 0.704478 max acc epoch : 40 test accuracy : 0.713332
Counter({1: 976, 0: 569, 15: 567, 10: 551, 11: 534, 4: 528, 5: 507, 13: 440, 12: 432, 8: 431, 9: 358, 7: 348, 3: 341, 6: 286, 14: 267, 2: 265})

Epoch :  45 loss training:  6.478632879443467 Time :  10514
accuracy train: 0.997684 val: 0.701493 test: 0.710611
max validation accuracy : 0.704478 max acc epoch : 40 test accuracy : 0.713332
Counter({14: 984, 5: 570, 13: 566, 6: 552, 11: 534, 4: 524, 1: 504, 0: 436, 3: 434, 7: 432, 10: 357, 9: 347, 15: 344, 8: 286, 2: 266, 12: 264})

Epoch :  46 loss training:  5.980414221994579 Time :  10551
accuracy train: 0.997684 val: 0.689552 test: 0.715310
max validation accuracy : 0.704478 max acc epoch : 40 test accuracy : 0.713332
Counter({6: 995, 0: 994, 3: 559, 7: 536, 9: 520, 2: 500, 10: 436, 5: 431, 14: 360, 12: 346, 1: 340, 8: 328, 4: 285, 15: 266, 13: 261, 11: 243})

Epoch :  47 loss training:  5.634823141153902 Time :  10594
accuracy train: 0.997022 val: 0.692537 test: 0.714568
max validation accuracy : 0.704478 max acc epoch : 40 test accuracy : 0.713332
Counter({2: 997, 13: 572, 0: 565, 11: 547, 4: 547, 12: 522, 14: 495, 15: 438, 10: 431, 1: 429, 9: 363, 3: 343, 5: 342, 6: 284, 7: 265, 8: 260})

Epoch :  48 loss training:  5.02177792461589 Time :  10634
accuracy train: 0.996691 val: 0.686567 test: 0.711848
max validation accuracy : 0.704478 max acc epoch : 40 test accuracy : 0.713332
Counter({5: 1005, 11: 571, 13: 562, 7: 540, 10: 539, 3: 527, 15: 489, 4: 443, 2: 434, 12: 429, 1: 364, 9: 343, 8: 341, 6: 285, 0: 267, 14: 261})

Epoch :  49 loss training:  4.6340586808510125 Time :  10683
accuracy train: 0.998676 val: 0.692537 test: 0.711353
max validation accuracy : 0.704478 max acc epoch : 40 test accuracy : 0.713332
Counter({4: 1006, 0: 721, 3: 567, 9: 537, 1: 534, 5: 525, 15: 479, 10: 438, 12: 423, 2: 363, 11: 334, 14: 333, 6: 324, 8: 288, 7: 265, 13: 263})

Epoch :  50 loss training:  4.616273422259837 Time :  10722
accuracy train: 0.999007 val: 0.698507 test: 0.712590
max validation accuracy : 0.704478 max acc epoch : 40 test accuracy : 0.713332
Counter({3: 1031, 2: 1002, 5: 558, 7: 532, 11: 517, 1: 491, 8: 435, 9: 424, 0: 364, 10: 341, 14: 340, 4: 318, 13: 288, 12: 264, 15: 261, 6: 234})

Epoch :  51 loss training:  3.832935477141291 Time :  10763
accuracy train: 0.998345 val: 0.701493 test: 0.714074
max validation accuracy : 0.704478 max acc epoch : 40 test accuracy : 0.713332
Counter({9: 1042, 2: 1001, 1: 558, 4: 532, 7: 514, 0: 479, 14: 436, 13: 426, 11: 364, 12: 343, 10: 338, 3: 314, 8: 287, 5: 264, 6: 262, 15: 240})

Epoch :  52 loss training:  3.2465858361683786 Time :  10827
accuracy train: 0.998676 val: 0.695522 test: 0.711106
max validation accuracy : 0.704478 max acc epoch : 40 test accuracy : 0.713332
Counter({4: 751, 2: 571, 1: 566, 7: 557, 11: 552, 5: 539, 0: 529, 6: 481, 9: 455, 3: 440, 10: 421, 15: 365, 14: 334, 12: 317, 13: 263, 8: 259})

Epoch :  53 loss training:  4.544432589085773 Time :  10867
accuracy train: 0.998345 val: 0.707463 test: 0.713826
max validation accuracy : 0.707463 max acc epoch : 53 test accuracy : 0.713826
Counter({2: 1007, 0: 756, 13: 575, 5: 549, 10: 535, 3: 524, 4: 471, 11: 445, 7: 421, 1: 366, 15: 334, 14: 316, 8: 291, 6: 287, 12: 263, 9: 260})

Epoch :  54 loss training:  3.6322892252355814 Time :  10903
accuracy train: 0.999007 val: 0.707463 test: 0.714321
max validation accuracy : 0.707463 max acc epoch : 53 test accuracy : 0.713826
Counter({6: 1008, 1: 879, 8: 847, 5: 546, 12: 514, 11: 444, 13: 422, 15: 374, 0: 365, 14: 335, 2: 320, 4: 287, 9: 286, 10: 261, 7: 261, 3: 251})

Epoch :  55 loss training:  3.023283537477255 Time :  10950
accuracy train: 0.999669 val: 0.713433 test: 0.710858
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({5: 1137, 1: 900, 0: 550, 2: 539, 9: 515, 4: 470, 11: 443, 8: 418, 7: 374, 12: 364, 13: 336, 6: 290, 10: 286, 14: 263, 3: 261, 15: 254})

Epoch :  56 loss training:  2.8577735532307997 Time :  10990
accuracy train: 0.998676 val: 0.713433 test: 0.713579
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({2: 1151, 13: 886, 9: 554, 0: 548, 7: 519, 6: 457, 8: 442, 14: 417, 11: 376, 4: 361, 3: 336, 5: 290, 12: 286, 10: 262, 15: 261, 1: 254})

Epoch :  57 loss training:  3.3171516429865733 Time :  11025
accuracy train: 0.998676 val: 0.695522 test: 0.709869
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({15: 1114, 4: 1006, 1: 549, 9: 520, 8: 489, 5: 446, 0: 438, 7: 416, 2: 375, 3: 355, 12: 335, 6: 292, 14: 286, 11: 263, 13: 259, 10: 257})

Epoch :  58 loss training:  2.918819934828207 Time :  11065
accuracy train: 0.999338 val: 0.698507 test: 0.711353
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({1: 1108, 5: 1006, 9: 546, 4: 523, 14: 485, 2: 452, 10: 445, 6: 413, 0: 376, 12: 354, 15: 335, 7: 288, 3: 284, 8: 265, 11: 261, 13: 259})

Epoch :  59 loss training:  2.832936506951228 Time :  11120
accuracy train: 0.999669 val: 0.692537 test: 0.709127
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({2: 1008, 1: 800, 3: 580, 11: 546, 0: 523, 10: 495, 13: 460, 9: 442, 4: 412, 7: 375, 14: 335, 15: 319, 8: 303, 5: 283, 6: 260, 12: 259})

Epoch :  60 loss training:  2.3374554000329226 Time :  11158
accuracy train: 0.999338 val: 0.689552 test: 0.711353
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({4: 1011, 0: 809, 5: 579, 15: 545, 2: 518, 13: 495, 8: 465, 1: 439, 14: 412, 9: 375, 3: 335, 7: 314, 10: 307, 12: 284, 11: 257, 6: 255})

Epoch :  61 loss training:  2.12719632324297 Time :  11199
accuracy train: 0.999007 val: 0.698507 test: 0.716052
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({3: 1011, 10: 810, 2: 577, 6: 544, 9: 517, 1: 495, 4: 462, 15: 439, 11: 411, 7: 374, 5: 335, 0: 315, 13: 309, 8: 285, 14: 260, 12: 256})

Epoch :  62 loss training:  2.1464857396204025 Time :  11249
accuracy train: 0.999669 val: 0.695522 test: 0.714816
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({4: 1014, 1: 811, 14: 571, 9: 539, 3: 518, 0: 490, 2: 478, 7: 439, 11: 402, 5: 374, 6: 335, 12: 318, 8: 308, 10: 287, 15: 261, 13: 255})

Epoch :  63 loss training:  2.269936574739404 Time :  11287
accuracy train: 0.999338 val: 0.695522 test: 0.712837
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({6: 937, 8: 826, 9: 567, 3: 539, 4: 520, 5: 520, 7: 496, 13: 439, 15: 401, 1: 375, 12: 335, 0: 323, 14: 315, 2: 287, 11: 266, 10: 254})

Epoch :  64 loss training:  2.535711010103114 Time :  11325
accuracy train: 0.998676 val: 0.701493 test: 0.716794
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({1: 1129, 2: 561, 5: 540, 15: 535, 6: 521, 10: 484, 0: 483, 4: 479, 8: 439, 7: 402, 3: 368, 9: 338, 13: 314, 12: 288, 11: 266, 14: 253})

Epoch :  65 loss training:  2.1025330894626677 Time :  11363
accuracy train: 0.999007 val: 0.707463 test: 0.716052
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({13: 1125, 3: 559, 8: 542, 4: 526, 0: 523, 6: 495, 1: 491, 5: 479, 12: 439, 11: 402, 2: 369, 14: 335, 9: 311, 7: 287, 15: 264, 10: 253})

Epoch :  66 loss training:  1.8240789078408852 Time :  11406
accuracy train: 1.000000 val: 0.701493 test: 0.715558
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({7: 1120, 1: 1021, 12: 537, 2: 520, 11: 508, 10: 464, 4: 439, 3: 402, 15: 369, 5: 345, 9: 335, 14: 287, 0: 284, 6: 260, 13: 257, 8: 252})

Epoch :  67 loss training:  1.9183218678226694 Time :  11444
accuracy train: 1.000000 val: 0.701493 test: 0.710611
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({1: 945, 5: 826, 8: 580, 2: 537, 12: 524, 6: 521, 13: 498, 0: 442, 9: 402, 7: 373, 3: 335, 10: 307, 14: 306, 15: 286, 4: 265, 11: 253})

Epoch :  68 loss training:  1.7120972067932598 Time :  11479
accuracy train: 0.999669 val: 0.686567 test: 0.708880
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({1: 1125, 6: 543, 9: 534, 0: 522, 3: 520, 2: 519, 5: 503, 11: 449, 7: 444, 13: 402, 4: 373, 12: 348, 10: 335, 15: 270, 14: 260, 8: 253})

Epoch :  69 loss training:  2.2462720353505574 Time :  11537
accuracy train: 0.999669 val: 0.689552 test: 0.708632
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({2: 959, 1: 824, 5: 555, 6: 533, 10: 526, 15: 524, 4: 500, 11: 447, 3: 401, 14: 373, 8: 335, 7: 317, 12: 307, 9: 284, 13: 262, 0: 253})

Epoch :  70 loss training:  1.5005429771263152 Time :  11576
accuracy train: 0.999338 val: 0.704478 test: 0.713826
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({2: 1123, 6: 1024, 13: 534, 1: 529, 15: 525, 7: 456, 9: 447, 0: 403, 8: 369, 11: 334, 5: 326, 3: 283, 10: 272, 14: 261, 4: 259, 12: 255})

Epoch :  71 loss training:  1.1707120307837613 Time :  11615
accuracy train: 0.999669 val: 0.695522 test: 0.709622
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({7: 1124, 8: 542, 5: 536, 4: 532, 1: 529, 3: 524, 6: 500, 10: 453, 9: 447, 14: 403, 13: 369, 12: 335, 15: 309, 0: 283, 2: 260, 11: 254})

Epoch :  72 loss training:  1.5178498040186241 Time :  11658
accuracy train: 0.999669 val: 0.698507 test: 0.713084
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({1: 1129, 0: 812, 10: 542, 9: 530, 3: 522, 15: 506, 13: 447, 2: 408, 8: 403, 12: 373, 7: 335, 5: 326, 4: 282, 6: 268, 11: 260, 14: 257})

Epoch :  73 loss training:  1.2036246516508982 Time :  11702
accuracy train: 0.999338 val: 0.686567 test: 0.712095
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({3: 804, 10: 626, 2: 543, 8: 536, 4: 532, 12: 517, 1: 512, 0: 508, 15: 447, 13: 410, 14: 403, 9: 373, 5: 335, 11: 316, 6: 281, 7: 257})

Epoch :  74 loss training:  1.5490348889143206 Time :  11736
accuracy train: 0.999669 val: 0.689552 test: 0.711106
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({9: 793, 1: 628, 13: 539, 6: 537, 4: 530, 7: 526, 11: 512, 0: 503, 3: 448, 10: 423, 8: 402, 14: 372, 15: 335, 2: 317, 12: 280, 5: 255})

Epoch :  75 loss training:  2.2023248395416886 Time :  11779
accuracy train: 1.000000 val: 0.686567 test: 0.713579
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({8: 1140, 4: 793, 3: 536, 0: 535, 2: 516, 5: 513, 10: 447, 14: 425, 11: 399, 6: 372, 9: 335, 12: 330, 7: 279, 15: 269, 1: 256, 13: 255})

Epoch :  76 loss training:  1.1867640417767689 Time :  11832
accuracy train: 1.000000 val: 0.698507 test: 0.712590
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({4: 836, 1: 790, 15: 539, 9: 536, 11: 535, 14: 516, 3: 513, 6: 447, 2: 426, 7: 399, 8: 372, 5: 335, 13: 317, 12: 305, 0: 279, 10: 255})

Epoch :  77 loss training:  1.559842174348887 Time :  11870
accuracy train: 1.000000 val: 0.695522 test: 0.709127
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({1: 1142, 10: 788, 11: 535, 8: 533, 0: 515, 6: 512, 5: 447, 12: 430, 3: 397, 4: 373, 15: 341, 13: 334, 7: 279, 9: 264, 2: 256, 14: 254})

Epoch :  78 loss training:  1.329010436515091 Time :  11912
accuracy train: 1.000000 val: 0.689552 test: 0.712837
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({12: 1027, 13: 906, 0: 620, 2: 536, 4: 531, 14: 528, 10: 448, 11: 397, 5: 374, 6: 338, 9: 334, 1: 303, 7: 278, 3: 265, 15: 262, 8: 253})

Epoch :  79 loss training:  1.3825284396880306 Time :  11958
accuracy train: 1.000000 val: 0.695522 test: 0.710116
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({3: 1148, 11: 905, 7: 536, 14: 531, 9: 529, 0: 497, 8: 449, 4: 392, 6: 374, 1: 338, 13: 334, 10: 307, 5: 278, 2: 265, 12: 262, 15: 255})

Epoch :  80 loss training:  1.2244880352955079 Time :  12001
accuracy train: 1.000000 val: 0.698507 test: 0.710858
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({2: 1026, 3: 784, 4: 636, 14: 536, 11: 531, 12: 512, 6: 449, 13: 427, 7: 392, 9: 374, 5: 337, 1: 335, 15: 278, 0: 266, 10: 263, 8: 254})

Epoch :  81 loss training:  1.13516633893596 Time :  12045
accuracy train: 1.000000 val: 0.701493 test: 0.711600
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({3: 1147, 0: 1025, 2: 552, 7: 534, 14: 525, 10: 449, 12: 395, 5: 391, 11: 374, 13: 335, 9: 335, 6: 278, 15: 276, 4: 268, 8: 264, 1: 252})

Epoch :  82 loss training:  1.1265602843486704 Time :  12086
accuracy train: 1.000000 val: 0.701493 test: 0.712590
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({4: 1147, 0: 928, 5: 534, 13: 523, 3: 513, 1: 512, 7: 450, 9: 391, 10: 374, 6: 335, 2: 335, 11: 293, 14: 278, 15: 271, 12: 264, 8: 252})

Epoch :  83 loss training:  1.203181877557654 Time :  12145
accuracy train: 1.000000 val: 0.692537 test: 0.714568
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({2: 1147, 1: 566, 9: 535, 14: 530, 15: 522, 6: 517, 0: 509, 8: 451, 11: 401, 4: 391, 13: 371, 7: 335, 5: 332, 10: 278, 12: 267, 3: 248})

Epoch :  84 loss training:  1.135694550612243 Time :  12182
accuracy train: 1.000000 val: 0.692537 test: 0.710611
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({0: 1144, 9: 615, 2: 594, 3: 534, 11: 521, 1: 514, 12: 513, 6: 451, 5: 390, 4: 370, 7: 335, 14: 327, 10: 309, 8: 279, 15: 259, 13: 245})

Epoch :  85 loss training:  1.1629047998576425 Time :  12219
accuracy train: 0.999669 val: 0.680597 test: 0.712342
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({2: 1144, 3: 1027, 8: 616, 9: 519, 0: 507, 14: 450, 7: 419, 1: 391, 11: 371, 12: 334, 10: 309, 15: 288, 6: 279, 13: 253, 4: 248, 5: 245})

Epoch :  86 loss training:  0.8735658584628254 Time :  12256
accuracy train: 0.999338 val: 0.692537 test: 0.712095
max validation accuracy : 0.713433 max acc epoch : 55 test accuracy : 0.710858
Counter({2: 1144, 4: 1027, 0: 611, 15: 536, 6: 520, 14: 504, 3: 444, 5: 392, 10: 371, 8: 333, 13: 321, 12: 312, 7: 278, 11: 249, 1: 245, 9: 113})

========================================================================================================================================================================================================
best acc epoch :  55
validation accuracy :  0.7134328358208956
test accuracy :  0.7108582735592381
last test_accuracy :  0.7120949789760079
second best val :  0.7074626865671642
second best test :  0.7138263665594855
max gap 13
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=16, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=535, tsne=False, weight_decay=0)
device :  cuda:0
Counter({13: 672, 1: 632, 6: 556, 2: 545, 3: 520, 7: 505, 5: 505, 0: 484, 15: 482, 11: 481, 14: 454, 10: 367, 12: 348, 9: 327, 8: 299, 4: 223})

Epoch :  1 loss training:  209.57377111911774 Time :  12329
accuracy train: 0.672402 val: 0.623881 test: 0.642345
max validation accuracy : 0.623881 max acc epoch : 1 test accuracy : 0.642345
Counter({1: 1128, 5: 943, 12: 473, 13: 452, 10: 442, 15: 418, 7: 395, 3: 386, 9: 379, 0: 378, 11: 364, 2: 356, 6: 342, 8: 330, 14: 314, 4: 300})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  142.7857000231743 Time :  12368
accuracy train: 0.718729 val: 0.674627 test: 0.664605
max validation accuracy : 0.674627 max acc epoch : 2 test accuracy : 0.664605
Counter({1: 1097, 0: 1014, 2: 478, 3: 473, 11: 455, 4: 448, 5: 436, 14: 391, 13: 367, 6: 356, 12: 345, 7: 331, 10: 319, 15: 318, 8: 299, 9: 273})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  119.97856545448303 Time :  12409
accuracy train: 0.744540 val: 0.662687 test: 0.675241
max validation accuracy : 0.674627 max acc epoch : 2 test accuracy : 0.664605
Counter({4: 1100, 1: 1052, 15: 551, 11: 471, 0: 448, 14: 437, 13: 430, 2: 400, 9: 372, 12: 343, 3: 326, 6: 318, 5: 307, 10: 304, 7: 272, 8: 269})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.1807672381401 Time :  12471
accuracy train: 0.790867 val: 0.665672 test: 0.697749
max validation accuracy : 0.674627 max acc epoch : 2 test accuracy : 0.664605
Counter({8: 1008, 1: 664, 4: 612, 3: 524, 5: 520, 0: 499, 10: 448, 13: 448, 6: 391, 15: 353, 11: 350, 2: 343, 7: 326, 14: 322, 9: 318, 12: 274})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  86.59886944293976 Time :  12510
accuracy train: 0.802449 val: 0.686567 test: 0.700717
max validation accuracy : 0.686567 max acc epoch : 5 test accuracy : 0.700717
Counter({14: 1018, 3: 811, 11: 570, 4: 511, 1: 488, 13: 486, 9: 446, 12: 394, 2: 363, 5: 353, 8: 351, 0: 333, 7: 324, 15: 320, 10: 319, 6: 313})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  82.00383380055428 Time :  12552
accuracy train: 0.832892 val: 0.671642 test: 0.698244
max validation accuracy : 0.686567 max acc epoch : 5 test accuracy : 0.700717
Counter({11: 1025, 12: 819, 15: 570, 8: 521, 0: 483, 7: 469, 13: 447, 10: 415, 3: 397, 4: 355, 2: 341, 9: 327, 1: 325, 5: 323, 6: 312, 14: 271})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  71.89186251163483 Time :  12596
accuracy train: 0.835870 val: 0.683582 test: 0.702201
max validation accuracy : 0.686567 max acc epoch : 5 test accuracy : 0.700717
Counter({11: 1021, 9: 629, 7: 563, 3: 512, 1: 490, 4: 485, 6: 473, 14: 450, 15: 447, 0: 400, 2: 350, 13: 350, 10: 324, 5: 324, 12: 311, 8: 271})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  67.72953593730927 Time :  12633
accuracy train: 0.846790 val: 0.701493 test: 0.711600
max validation accuracy : 0.701493 max acc epoch : 8 test accuracy : 0.711600
Counter({11: 986, 10: 629, 4: 564, 14: 514, 6: 485, 3: 484, 8: 474, 15: 445, 7: 445, 12: 405, 1: 385, 13: 349, 0: 323, 2: 323, 9: 317, 5: 272})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.27383333444595 Time :  12673
accuracy train: 0.855063 val: 0.698507 test: 0.705169
max validation accuracy : 0.701493 max acc epoch : 8 test accuracy : 0.711600
Counter({10: 998, 6: 969, 4: 576, 14: 478, 15: 471, 5: 453, 9: 439, 2: 427, 0: 395, 13: 361, 1: 353, 3: 324, 12: 319, 8: 318, 7: 268, 11: 251})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.68736134469509 Time :  12715
accuracy train: 0.861019 val: 0.710448 test: 0.708632
max validation accuracy : 0.710448 max acc epoch : 10 test accuracy : 0.708632
Counter({9: 995, 8: 966, 14: 575, 15: 476, 2: 472, 3: 461, 13: 441, 0: 427, 4: 393, 11: 366, 1: 353, 7: 326, 10: 321, 12: 316, 5: 266, 6: 246})

Epoch :  11 loss training:  56.55955243110657 Time :  12784
accuracy train: 0.876241 val: 0.713433 test: 0.715805
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.715805
Counter({11: 993, 6: 964, 1: 579, 5: 477, 13: 472, 4: 463, 10: 441, 15: 431, 8: 390, 12: 365, 9: 352, 2: 326, 3: 319, 7: 316, 14: 265, 0: 247})

Epoch :  12 loss training:  53.63487687706947 Time :  12826
accuracy train: 0.886499 val: 0.704478 test: 0.718773
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.715805
Counter({4: 992, 12: 960, 1: 580, 3: 475, 9: 467, 15: 467, 11: 446, 10: 434, 14: 385, 5: 366, 8: 356, 2: 328, 0: 322, 6: 315, 7: 266, 13: 241})

Epoch :  13 loss training:  51.94547539949417 Time :  12862
accuracy train: 0.898412 val: 0.725373 test: 0.717289
max validation accuracy : 0.725373 max acc epoch : 13 test accuracy : 0.717289
Counter({1: 985, 6: 963, 15: 580, 10: 478, 4: 475, 9: 465, 14: 443, 11: 439, 13: 382, 8: 376, 2: 354, 12: 325, 7: 323, 3: 317, 5: 265, 0: 230})

Epoch :  14 loss training:  48.484471306204796 Time :  12906
accuracy train: 0.899404 val: 0.719403 test: 0.718773
max validation accuracy : 0.725373 max acc epoch : 13 test accuracy : 0.717289
Counter({0: 981, 1: 948, 3: 581, 8: 484, 13: 479, 6: 460, 12: 449, 11: 441, 15: 385, 9: 381, 2: 354, 7: 323, 5: 322, 4: 314, 10: 266, 14: 232})

Epoch :  15 loss training:  45.92089365422726 Time :  12949
accuracy train: 0.917604 val: 0.710448 test: 0.718031
max validation accuracy : 0.725373 max acc epoch : 13 test accuracy : 0.717289
Counter({2: 936, 8: 614, 5: 588, 6: 576, 4: 479, 3: 473, 0: 467, 7: 439, 1: 424, 11: 387, 15: 380, 9: 350, 12: 331, 13: 323, 10: 320, 14: 313})

Epoch :  16 loss training:  42.70235515385866 Time :  12985
accuracy train: 0.928524 val: 0.716418 test: 0.718773
max validation accuracy : 0.725373 max acc epoch : 13 test accuracy : 0.717289
Counter({1: 958, 12: 955, 2: 595, 6: 494, 15: 482, 8: 460, 11: 456, 13: 437, 4: 405, 0: 388, 7: 353, 3: 322, 10: 319, 5: 312, 9: 263, 14: 201})

Epoch :  17 loss training:  40.68114098161459 Time :  13023
accuracy train: 0.936466 val: 0.710448 test: 0.721741
max validation accuracy : 0.725373 max acc epoch : 13 test accuracy : 0.717289
Counter({12: 956, 13: 956, 6: 588, 1: 504, 10: 486, 14: 453, 3: 448, 5: 439, 0: 401, 7: 386, 8: 361, 15: 322, 2: 321, 9: 312, 11: 261, 4: 206})

Epoch :  18 loss training:  38.71935346722603 Time :  13070
accuracy train: 0.941099 val: 0.722388 test: 0.717042
max validation accuracy : 0.725373 max acc epoch : 13 test accuracy : 0.717289
Counter({7: 968, 1: 946, 15: 589, 9: 499, 8: 489, 4: 443, 5: 439, 6: 437, 11: 417, 10: 383, 14: 358, 0: 326, 3: 323, 13: 316, 2: 261, 12: 206})

Epoch :  19 loss training:  34.994307175278664 Time :  13112
accuracy train: 0.940768 val: 0.722388 test: 0.718526
max validation accuracy : 0.725373 max acc epoch : 13 test accuracy : 0.717289
Counter({3: 972, 1: 931, 2: 594, 10: 495, 13: 488, 0: 448, 6: 437, 11: 436, 7: 435, 12: 380, 9: 350, 14: 325, 15: 321, 4: 315, 5: 265, 8: 208})

Epoch :  20 loss training:  33.23415604233742 Time :  13151
accuracy train: 0.951688 val: 0.731343 test: 0.726441
max validation accuracy : 0.731343 max acc epoch : 20 test accuracy : 0.726441
Counter({1: 971, 15: 926, 10: 606, 6: 499, 0: 483, 7: 439, 4: 438, 11: 438, 2: 434, 3: 375, 12: 354, 8: 326, 13: 321, 5: 317, 9: 265, 14: 208})

Epoch :  21 loss training:  31.630189031362534 Time :  13221
accuracy train: 0.956320 val: 0.722388 test: 0.719021
max validation accuracy : 0.731343 max acc epoch : 20 test accuracy : 0.726441
Counter({14: 957, 6: 918, 12: 611, 13: 502, 1: 487, 9: 448, 7: 446, 5: 437, 4: 428, 3: 375, 2: 354, 15: 324, 8: 323, 10: 319, 0: 265, 11: 206})

Epoch :  22 loss training:  29.500920236110687 Time :  13259
accuracy train: 0.969226 val: 0.728358 test: 0.720752
max validation accuracy : 0.731343 max acc epoch : 20 test accuracy : 0.726441
Counter({14: 963, 0: 908, 6: 617, 1: 497, 15: 489, 7: 456, 4: 452, 9: 437, 5: 426, 13: 373, 10: 348, 11: 326, 12: 323, 2: 319, 8: 263, 3: 203})

Epoch :  23 loss training:  28.108511332422495 Time :  13297
accuracy train: 0.966248 val: 0.722388 test: 0.723720
max validation accuracy : 0.731343 max acc epoch : 20 test accuracy : 0.726441
Counter({3: 954, 10: 919, 5: 621, 15: 505, 14: 490, 9: 462, 12: 444, 6: 436, 2: 422, 1: 373, 0: 346, 4: 330, 8: 329, 11: 316, 13: 254, 7: 199})

Epoch :  24 loss training:  26.502532247453928 Time :  13342
accuracy train: 0.968895 val: 0.719403 test: 0.721741
max validation accuracy : 0.731343 max acc epoch : 20 test accuracy : 0.726441
Counter({8: 904, 3: 628, 4: 612, 5: 587, 9: 498, 13: 470, 2: 451, 11: 427, 1: 415, 14: 392, 12: 364, 15: 344, 6: 333, 0: 331, 10: 330, 7: 314})

Epoch :  25 loss training:  25.0241158939898 Time :  13382
accuracy train: 0.977829 val: 0.731343 test: 0.720999
max validation accuracy : 0.731343 max acc epoch : 20 test accuracy : 0.726441
Counter({3: 991, 12: 906, 0: 622, 10: 504, 6: 497, 13: 466, 1: 453, 7: 427, 5: 412, 15: 362, 2: 345, 8: 333, 14: 319, 9: 309, 11: 255, 4: 199})

Epoch :  26 loss training:  21.754303000867367 Time :  13420
accuracy train: 0.975844 val: 0.725373 test: 0.721989
max validation accuracy : 0.731343 max acc epoch : 20 test accuracy : 0.726441
Counter({3: 983, 4: 897, 13: 622, 6: 513, 8: 503, 7: 466, 2: 458, 0: 428, 9: 404, 10: 359, 5: 350, 11: 334, 15: 322, 12: 308, 14: 255, 1: 198})

Epoch :  27 loss training:  20.609692942351103 Time :  13459
accuracy train: 0.982462 val: 0.737313 test: 0.719763
max validation accuracy : 0.737313 max acc epoch : 27 test accuracy : 0.719763
Counter({15: 973, 2: 895, 1: 624, 3: 512, 5: 511, 14: 479, 7: 459, 6: 429, 10: 406, 4: 359, 13: 344, 12: 335, 8: 319, 0: 309, 9: 254, 11: 192})

Epoch :  28 loss training:  18.950885262340307 Time :  13513
accuracy train: 0.982462 val: 0.737313 test: 0.725204
max validation accuracy : 0.737313 max acc epoch : 27 test accuracy : 0.719763
Counter({8: 986, 0: 875, 9: 618, 2: 571, 10: 514, 13: 470, 11: 468, 12: 429, 4: 421, 15: 356, 3: 343, 7: 333, 14: 317, 6: 305, 1: 262, 5: 132})

Epoch :  29 loss training:  17.84538834914565 Time :  13551
accuracy train: 0.983786 val: 0.725373 test: 0.723967
max validation accuracy : 0.737313 max acc epoch : 27 test accuracy : 0.719763
Counter({1: 986, 4: 839, 11: 627, 13: 516, 14: 512, 0: 505, 12: 475, 8: 427, 7: 423, 10: 356, 2: 341, 9: 334, 6: 318, 3: 305, 5: 253, 15: 183})

Epoch :  30 loss training:  15.996523313224316 Time :  13591
accuracy train: 0.988749 val: 0.734328 test: 0.729162
max validation accuracy : 0.737313 max acc epoch : 27 test accuracy : 0.719763
Counter({1: 984, 15: 854, 7: 629, 12: 521, 4: 521, 6: 491, 5: 476, 3: 426, 8: 416, 2: 357, 0: 339, 10: 336, 11: 316, 14: 302, 13: 250, 9: 182})

Epoch :  31 loss training:  15.808929663151503 Time :  13652
accuracy train: 0.991066 val: 0.725373 test: 0.723967
max validation accuracy : 0.737313 max acc epoch : 27 test accuracy : 0.719763
Counter({1: 996, 10: 851, 5: 634, 7: 523, 12: 521, 4: 493, 6: 466, 0: 428, 3: 406, 9: 359, 8: 337, 11: 335, 2: 316, 15: 300, 13: 248, 14: 187})

Epoch :  32 loss training:  14.958850849419832 Time :  13700
accuracy train: 0.992720 val: 0.725373 test: 0.724957
max validation accuracy : 0.737313 max acc epoch : 27 test accuracy : 0.719763
Counter({12: 1004, 1: 850, 3: 632, 8: 533, 0: 526, 13: 493, 2: 462, 5: 427, 4: 403, 11: 357, 6: 335, 14: 332, 10: 314, 9: 299, 15: 247, 7: 186})

Epoch :  33 loss training:  13.482826052233577 Time :  13741
accuracy train: 0.994375 val: 0.722388 test: 0.721741
max validation accuracy : 0.737313 max acc epoch : 27 test accuracy : 0.719763
Counter({3: 1008, 2: 836, 4: 635, 7: 529, 5: 527, 11: 510, 1: 459, 15: 426, 8: 404, 14: 354, 10: 336, 12: 335, 6: 305, 0: 305, 13: 246, 9: 185})

Epoch :  34 loss training:  12.9750319654122 Time :  13804
accuracy train: 0.993713 val: 0.734328 test: 0.717536
max validation accuracy : 0.737313 max acc epoch : 27 test accuracy : 0.719763
Counter({9: 1007, 1: 824, 15: 635, 13: 536, 4: 527, 5: 526, 0: 452, 6: 427, 14: 399, 8: 352, 2: 336, 7: 333, 10: 309, 11: 306, 12: 245, 3: 186})

Epoch :  35 loss training:  12.078202364966273 Time :  13849
accuracy train: 0.996029 val: 0.734328 test: 0.723473
max validation accuracy : 0.737313 max acc epoch : 27 test accuracy : 0.719763
Counter({5: 1000, 1: 807, 4: 637, 10: 542, 6: 539, 12: 531, 11: 452, 8: 428, 3: 399, 2: 355, 14: 335, 0: 333, 13: 306, 7: 305, 15: 244, 9: 187})

Epoch :  36 loss training:  11.110023340210319 Time :  13889
accuracy train: 0.997684 val: 0.725373 test: 0.726193
max validation accuracy : 0.737313 max acc epoch : 27 test accuracy : 0.719763
Counter({1: 802, 5: 631, 0: 621, 6: 547, 11: 544, 7: 534, 9: 517, 12: 426, 13: 411, 2: 396, 14: 351, 4: 339, 8: 335, 15: 334, 10: 308, 3: 304})

Epoch :  37 loss training:  10.447325425222516 Time :  13933
accuracy train: 0.995367 val: 0.725373 test: 0.723225
max validation accuracy : 0.737313 max acc epoch : 27 test accuracy : 0.719763
Counter({0: 814, 10: 625, 13: 624, 11: 555, 2: 534, 14: 534, 8: 530, 1: 424, 15: 406, 5: 397, 7: 352, 3: 335, 9: 334, 12: 333, 4: 308, 6: 295})

Epoch :  38 loss training:  9.421782841905951 Time :  13975
accuracy train: 0.996360 val: 0.725373 test: 0.722483
max validation accuracy : 0.737313 max acc epoch : 27 test accuracy : 0.719763
Counter({3: 805, 4: 625, 11: 622, 7: 553, 14: 547, 5: 543, 6: 530, 9: 422, 13: 410, 0: 397, 8: 350, 15: 335, 10: 334, 12: 320, 1: 309, 2: 298})

Epoch :  39 loss training:  9.680160872638226 Time :  14018
accuracy train: 0.995367 val: 0.740299 test: 0.720010
max validation accuracy : 0.740299 max acc epoch : 39 test accuracy : 0.720010
Counter({5: 1046, 0: 779, 2: 633, 10: 565, 14: 552, 4: 546, 15: 419, 11: 418, 13: 397, 12: 352, 8: 335, 7: 322, 1: 309, 9: 298, 6: 239, 3: 190})

Epoch :  40 loss training:  8.302755784243345 Time :  14057
accuracy train: 0.998015 val: 0.746269 test: 0.719268
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({0: 1027, 15: 773, 7: 633, 11: 570, 4: 566, 5: 546, 2: 436, 6: 419, 14: 393, 1: 350, 9: 335, 12: 320, 10: 309, 13: 296, 8: 238, 3: 189})

Epoch :  41 loss training:  8.064799054525793 Time :  14126
accuracy train: 0.997684 val: 0.725373 test: 0.722483
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({1: 1027, 2: 730, 6: 636, 10: 614, 15: 565, 4: 545, 5: 435, 9: 421, 13: 383, 7: 348, 8: 337, 11: 324, 3: 309, 0: 296, 12: 238, 14: 192})

Epoch :  42 loss training:  7.845546908676624 Time :  14162
accuracy train: 0.998015 val: 0.731343 test: 0.725204
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({4: 1028, 3: 724, 9: 641, 7: 611, 6: 544, 0: 504, 11: 433, 5: 415, 12: 381, 10: 345, 2: 339, 15: 325, 1: 314, 13: 310, 14: 295, 8: 191})

Epoch :  43 loss training:  7.018886593170464 Time :  14202
accuracy train: 0.998345 val: 0.743284 test: 0.721741
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({0: 1030, 13: 721, 9: 632, 6: 611, 1: 547, 5: 530, 3: 431, 8: 411, 12: 379, 10: 343, 7: 339, 2: 321, 11: 314, 4: 309, 15: 296, 14: 186})

Epoch :  44 loss training:  5.966120334342122 Time :  14247
accuracy train: 0.998676 val: 0.731343 test: 0.722978
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({1: 1029, 4: 703, 11: 614, 15: 602, 6: 582, 0: 551, 3: 434, 8: 406, 9: 374, 13: 343, 5: 339, 7: 321, 14: 316, 2: 307, 10: 295, 12: 184})

Epoch :  45 loss training:  6.024405444972217 Time :  14289
accuracy train: 0.999007 val: 0.734328 test: 0.720752
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({0: 1029, 5: 722, 14: 603, 6: 589, 4: 585, 13: 551, 15: 437, 1: 405, 11: 375, 12: 340, 10: 337, 8: 321, 9: 315, 7: 307, 3: 297, 2: 187})

Epoch :  46 loss training:  5.884070391766727 Time :  14327
accuracy train: 0.998345 val: 0.731343 test: 0.720010
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({2: 1034, 14: 721, 10: 600, 11: 599, 4: 583, 3: 557, 6: 437, 0: 404, 9: 368, 15: 345, 5: 337, 13: 316, 8: 314, 7: 304, 12: 296, 1: 185})

Epoch :  47 loss training:  5.067367989104241 Time :  14369
accuracy train: 0.997684 val: 0.713433 test: 0.718031
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({12: 1034, 14: 748, 0: 722, 1: 597, 13: 588, 2: 553, 3: 418, 7: 405, 11: 375, 9: 347, 5: 338, 15: 321, 4: 303, 8: 294, 10: 237, 6: 120})

Epoch :  48 loss training:  4.037853837711737 Time :  14425
accuracy train: 0.999007 val: 0.734328 test: 0.723967
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({2: 1035, 1: 708, 3: 616, 4: 598, 0: 591, 12: 551, 9: 430, 10: 402, 13: 367, 15: 347, 11: 338, 14: 328, 6: 318, 5: 303, 7: 295, 8: 173})

Epoch :  49 loss training:  4.915832716971636 Time :  14465
accuracy train: 0.998676 val: 0.743284 test: 0.723720
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({1: 1036, 0: 781, 9: 721, 8: 584, 14: 584, 3: 552, 2: 418, 11: 399, 4: 366, 7: 351, 15: 338, 5: 320, 12: 301, 6: 292, 10: 238, 13: 119})

Epoch :  50 loss training:  4.5987707381136715 Time :  14504
accuracy train: 0.998676 val: 0.719403 test: 0.722483
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({3: 718, 13: 652, 10: 590, 6: 580, 7: 557, 2: 547, 4: 543, 12: 524, 5: 453, 0: 395, 11: 370, 9: 351, 8: 336, 1: 326, 14: 291, 15: 167})

Epoch :  51 loss training:  4.189803816843778 Time :  14546
accuracy train: 0.998345 val: 0.719403 test: 0.722731
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({4: 1211, 1: 719, 12: 578, 5: 559, 7: 558, 3: 513, 14: 437, 2: 394, 15: 371, 11: 352, 13: 333, 9: 326, 0: 300, 6: 290, 10: 285, 8: 174})

Epoch :  52 loss training:  4.2219149235170335 Time :  14589
accuracy train: 0.999669 val: 0.716418 test: 0.723225
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({12: 1062, 15: 706, 1: 695, 6: 574, 4: 560, 8: 538, 7: 520, 13: 416, 10: 390, 11: 355, 0: 334, 5: 303, 14: 297, 2: 288, 3: 241, 9: 121})

Epoch :  53 loss training:  3.629625543951988 Time :  14629
accuracy train: 1.000000 val: 0.725373 test: 0.720010
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({2: 1219, 10: 713, 14: 576, 12: 559, 15: 558, 5: 507, 11: 431, 4: 390, 7: 365, 13: 358, 6: 335, 9: 335, 1: 303, 8: 302, 0: 286, 3: 163})

Epoch :  54 loss training:  3.9673216291703284 Time :  14669
accuracy train: 1.000000 val: 0.725373 test: 0.723225
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({2: 1056, 6: 831, 4: 710, 13: 579, 10: 559, 15: 527, 7: 417, 3: 392, 9: 371, 0: 363, 11: 336, 5: 309, 8: 301, 1: 287, 14: 247, 12: 115})

Epoch :  55 loss training:  3.2743192007765174 Time :  14738
accuracy train: 1.000000 val: 0.725373 test: 0.720505
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({15: 814, 7: 704, 1: 578, 8: 562, 2: 542, 4: 533, 5: 524, 14: 438, 3: 390, 6: 382, 12: 364, 0: 342, 9: 333, 11: 310, 13: 299, 10: 285})

Epoch :  56 loss training:  2.8866584966890514 Time :  14778
accuracy train: 1.000000 val: 0.722388 test: 0.722236
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({4: 714, 2: 707, 1: 574, 12: 570, 5: 562, 13: 525, 3: 504, 0: 492, 11: 436, 6: 387, 7: 365, 15: 343, 9: 333, 8: 307, 10: 300, 14: 281})

Epoch :  57 loss training:  3.307439763331786 Time :  14815
accuracy train: 0.999338 val: 0.725373 test: 0.723225
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({3: 1057, 6: 720, 0: 682, 5: 573, 9: 565, 4: 525, 8: 439, 1: 386, 15: 370, 12: 365, 13: 347, 14: 332, 11: 304, 7: 300, 2: 280, 10: 155})

Epoch :  58 loss training:  2.8408877570182085 Time :  14866
accuracy train: 1.000000 val: 0.716418 test: 0.725699
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({8: 803, 15: 695, 1: 574, 4: 566, 5: 559, 10: 506, 7: 504, 0: 440, 3: 435, 2: 387, 6: 366, 14: 349, 11: 329, 9: 302, 12: 298, 13: 287})

Epoch :  59 loss training:  2.960533130215481 Time :  14906
accuracy train: 1.000000 val: 0.722388 test: 0.721989
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({3: 1063, 4: 803, 6: 679, 15: 573, 13: 566, 11: 443, 12: 436, 10: 386, 5: 365, 14: 362, 0: 350, 1: 328, 2: 301, 8: 297, 7: 283, 9: 165})

Epoch :  60 loss training:  2.5644573465688154 Time :  14947
accuracy train: 0.999338 val: 0.722388 test: 0.722236
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({4: 1063, 1: 747, 9: 681, 13: 577, 0: 566, 12: 499, 2: 432, 6: 382, 8: 365, 11: 363, 5: 352, 10: 329, 15: 300, 14: 298, 7: 281, 3: 165})

Epoch :  61 loss training:  2.5280961710959673 Time :  14992
accuracy train: 0.999338 val: 0.716418 test: 0.722731
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({12: 752, 11: 682, 5: 673, 3: 571, 7: 566, 0: 560, 6: 508, 2: 496, 9: 381, 14: 374, 10: 366, 1: 353, 4: 332, 15: 317, 13: 300, 8: 169})

Epoch :  62 loss training:  2.6962642925791442 Time :  15032
accuracy train: 0.999338 val: 0.731343 test: 0.730151
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({1: 1066, 3: 744, 11: 679, 2: 570, 7: 565, 0: 513, 15: 422, 8: 382, 13: 371, 5: 365, 9: 353, 4: 333, 6: 303, 10: 298, 14: 272, 12: 164})

Epoch :  63 loss training:  2.606719972216524 Time :  15070
accuracy train: 1.000000 val: 0.704478 test: 0.722978
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({1: 1235, 4: 1064, 0: 690, 11: 568, 5: 564, 2: 406, 6: 379, 7: 373, 9: 370, 15: 332, 14: 308, 10: 299, 8: 271, 3: 255, 12: 171, 13: 115})

Epoch :  64 loss training:  2.0671441298909485 Time :  15112
accuracy train: 1.000000 val: 0.713433 test: 0.727925
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({0: 1227, 6: 702, 15: 570, 4: 565, 5: 532, 10: 531, 3: 418, 9: 380, 12: 370, 14: 369, 13: 350, 7: 331, 8: 307, 2: 299, 1: 277, 11: 172})

Epoch :  65 loss training:  2.4649728385265917 Time :  15163
accuracy train: 1.000000 val: 0.722388 test: 0.726441
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({13: 824, 7: 720, 4: 571, 3: 566, 6: 551, 15: 516, 2: 514, 5: 418, 1: 406, 11: 380, 9: 372, 12: 352, 8: 331, 14: 306, 10: 298, 0: 275})

Epoch :  66 loss training:  2.364704814972356 Time :  15201
accuracy train: 0.999338 val: 0.716418 test: 0.723720
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({1: 1065, 5: 824, 15: 707, 9: 571, 6: 565, 13: 418, 0: 406, 2: 379, 11: 372, 10: 362, 8: 350, 12: 331, 3: 310, 7: 300, 14: 275, 4: 165})

Epoch :  67 loss training:  2.025179234216921 Time :  15236
accuracy train: 0.999338 val: 0.722388 test: 0.726441
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({0: 1229, 2: 1064, 11: 705, 9: 572, 1: 561, 3: 417, 4: 371, 15: 363, 5: 351, 6: 331, 14: 310, 8: 300, 10: 275, 13: 201, 7: 180, 12: 170})

Epoch :  68 loss training:  1.4826770776417106 Time :  15294
accuracy train: 0.999669 val: 0.719403 test: 0.723720
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({1: 854, 2: 840, 13: 570, 10: 561, 0: 550, 6: 516, 5: 417, 3: 397, 11: 377, 4: 374, 9: 374, 8: 350, 7: 332, 14: 310, 15: 301, 12: 277})

Epoch :  69 loss training:  2.1000621168059297 Time :  15330
accuracy train: 0.999669 val: 0.710448 test: 0.720752
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({6: 850, 12: 735, 7: 565, 10: 563, 9: 561, 3: 507, 1: 500, 11: 417, 0: 385, 4: 377, 2: 374, 14: 350, 5: 333, 8: 307, 15: 301, 13: 275})

Epoch :  70 loss training:  1.4574599276529625 Time :  15367
accuracy train: 1.000000 val: 0.731343 test: 0.722236
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({6: 1067, 14: 840, 5: 708, 7: 565, 13: 563, 12: 419, 2: 396, 4: 375, 0: 374, 3: 362, 1: 350, 15: 334, 9: 304, 11: 300, 10: 274, 8: 169})

Epoch :  71 loss training:  1.9037095491075888 Time :  15410
accuracy train: 1.000000 val: 0.728358 test: 0.721989
max validation accuracy : 0.746269 max acc epoch : 40 test accuracy : 0.719268
Counter({1: 1233, 2: 1071, 5: 702, 8: 565, 4: 561, 3: 406, 7: 374, 13: 369, 6: 363, 14: 334, 9: 305, 10: 300, 11: 270, 0: 258, 15: 176, 12: 113})

========================================================================================================================================================================================================
best acc epoch :  40
validation accuracy :  0.746268656716418
test accuracy :  0.7192678703932723
last test_accuracy :  0.7219886223101657
second best val :  0.7432835820895523
second best test :  0.7192678703932723
max gap 12
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  56 	 val_accuracy : 0.71940 	 test_accuracy : 0.71383 	 last test_accuracy : 0.72174 	 second best val : 0.71642 	 second best test : 0.71383
k :  1 	 best_acc epoch :  75 	 val_accuracy : 0.75821 	 test_accuracy : 0.71655 	 last test_accuracy : 0.70987 	 second best val : 0.75522 	 second best test : 0.71803
k :  2 	 best_acc epoch :  55 	 val_accuracy : 0.71343 	 test_accuracy : 0.71086 	 last test_accuracy : 0.71209 	 second best val : 0.70746 	 second best test : 0.71383
k :  3 	 best_acc epoch :  40 	 val_accuracy : 0.74627 	 test_accuracy : 0.71927 	 last test_accuracy : 0.72199 	 second best val : 0.74328 	 second best test : 0.71927

avg :  	 val_accuracy : 0.73433 	 test_accuracy : 0.71512 	 last_accuracy : 0.71642 	 second best val : 0.73060 	 second best test : 0.71624

std :  	 val_accuracy : 0.01852 	 test_accuracy : 0.00313 	 last_accuracy : 0.00550 	 second best val : 0.01939 	 second best test : 0.00245


date and time :  Tue Jun 15 09:23:41 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=32, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=701, tsne=False, weight_decay=0)
device :  cuda:0
Counter({4: 348, 0: 339, 14: 297, 15: 296, 1: 287, 30: 281, 26: 269, 28: 267, 23: 265, 3: 261, 24: 240, 20: 237, 13: 229, 8: 228, 27: 224, 2: 224, 16: 220, 22: 219, 9: 219, 25: 219, 11: 210, 18: 208, 10: 205, 29: 205, 6: 204, 17: 197, 12: 191, 5: 188, 19: 162, 31: 160, 7: 153, 21: 148})

Epoch :  1 loss training:  212.41342222690582 Time :  33
accuracy train: 0.628723 val: 0.516418 test: 0.570369
max validation accuracy : 0.516418 max acc epoch : 1 test accuracy : 0.570369
Counter({16: 412, 31: 358, 11: 353, 2: 329, 5: 281, 17: 281, 30: 280, 28: 279, 29: 277, 12: 255, 20: 253, 1: 250, 10: 243, 7: 239, 9: 237, 6: 231, 23: 213, 25: 213, 24: 205, 18: 205, 0: 204, 3: 192, 26: 192, 21: 188, 22: 187, 19: 177, 14: 176, 27: 168, 13: 153, 4: 143, 15: 123, 8: 103})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  141.4413673877716 Time :  98
accuracy train: 0.705162 val: 0.579104 test: 0.647539
max validation accuracy : 0.579104 max acc epoch : 2 test accuracy : 0.647539
Counter({17: 444, 5: 371, 11: 370, 25: 275, 10: 266, 2: 263, 13: 255, 3: 251, 4: 246, 21: 244, 0: 243, 16: 241, 27: 240, 19: 239, 26: 238, 18: 237, 31: 235, 15: 228, 1: 228, 7: 224, 30: 221, 8: 219, 28: 213, 9: 209, 23: 196, 22: 186, 24: 178, 12: 166, 29: 147, 6: 122, 20: 110, 14: 95})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  122.66491356492043 Time :  196
accuracy train: 0.743216 val: 0.582090 test: 0.650012
max validation accuracy : 0.582090 max acc epoch : 3 test accuracy : 0.650012
Counter({15: 366, 3: 355, 12: 353, 22: 316, 27: 294, 6: 290, 23: 277, 8: 267, 19: 262, 11: 260, 21: 256, 4: 252, 31: 250, 13: 245, 14: 243, 28: 230, 9: 226, 29: 222, 30: 220, 20: 215, 7: 207, 18: 204, 17: 203, 10: 199, 5: 194, 1: 192, 16: 186, 2: 167, 0: 138, 26: 119, 24: 107, 25: 85})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  93.64772018790245 Time :  262
accuracy train: 0.796492 val: 0.623881 test: 0.683898
max validation accuracy : 0.623881 max acc epoch : 4 test accuracy : 0.683898
Counter({7: 568, 16: 407, 8: 345, 5: 336, 1: 313, 10: 277, 12: 272, 28: 264, 15: 261, 3: 257, 0: 256, 6: 250, 13: 246, 19: 241, 9: 241, 4: 231, 30: 223, 23: 222, 20: 219, 26: 214, 17: 197, 11: 194, 27: 193, 21: 192, 29: 179, 25: 141, 18: 135, 2: 125, 22: 114, 24: 109, 31: 90, 14: 88})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  87.54596763849258 Time :  326
accuracy train: 0.813369 val: 0.626866 test: 0.695276
max validation accuracy : 0.626866 max acc epoch : 5 test accuracy : 0.695276
Counter({9: 415, 22: 340, 29: 340, 5: 332, 8: 300, 23: 289, 3: 284, 7: 279, 25: 274, 10: 264, 21: 258, 31: 255, 26: 253, 17: 238, 12: 236, 18: 233, 4: 229, 14: 228, 16: 225, 19: 219, 30: 198, 1: 191, 11: 190, 24: 189, 2: 185, 28: 177, 27: 165, 0: 146, 6: 136, 20: 124, 15: 113, 13: 95})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  81.4413004219532 Time :  391
accuracy train: 0.842488 val: 0.659701 test: 0.692308
max validation accuracy : 0.659701 max acc epoch : 6 test accuracy : 0.692308
Counter({4: 623, 27: 553, 10: 431, 23: 328, 25: 277, 0: 276, 18: 271, 3: 260, 12: 254, 11: 247, 2: 245, 26: 239, 22: 233, 9: 233, 24: 225, 28: 224, 15: 221, 19: 196, 21: 190, 13: 189, 20: 185, 14: 182, 7: 182, 29: 143, 6: 140, 31: 138, 5: 132, 8: 126, 30: 122, 16: 121, 1: 117, 17: 97})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  69.99780854582787 Time :  455
accuracy train: 0.846790 val: 0.638806 test: 0.702201
max validation accuracy : 0.659701 max acc epoch : 6 test accuracy : 0.692308
Counter({12: 435, 18: 391, 5: 345, 0: 332, 6: 315, 19: 295, 16: 295, 2: 292, 8: 282, 21: 276, 1: 272, 9: 271, 23: 259, 15: 256, 13: 240, 3: 228, 17: 224, 20: 217, 7: 216, 4: 206, 28: 187, 26: 183, 27: 180, 14: 177, 24: 176, 30: 156, 22: 153, 11: 141, 29: 129, 10: 125, 31: 97, 25: 49})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  67.23315382003784 Time :  552
accuracy train: 0.852085 val: 0.647761 test: 0.703191
max validation accuracy : 0.659701 max acc epoch : 6 test accuracy : 0.692308
Counter({10: 570, 18: 395, 1: 362, 21: 329, 5: 323, 3: 290, 15: 280, 6: 279, 7: 273, 20: 262, 23: 261, 11: 257, 0: 255, 14: 236, 22: 230, 28: 221, 29: 217, 25: 214, 13: 206, 16: 205, 19: 190, 8: 186, 9: 180, 4: 174, 12: 164, 30: 164, 27: 142, 2: 132, 24: 119, 17: 116, 31: 91, 26: 77})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.27986642718315 Time :  612
accuracy train: 0.875910 val: 0.647761 test: 0.706653
max validation accuracy : 0.659701 max acc epoch : 6 test accuracy : 0.692308
Counter({11: 388, 14: 361, 5: 347, 10: 335, 30: 321, 15: 305, 29: 282, 7: 276, 16: 275, 3: 265, 21: 260, 19: 253, 23: 247, 26: 240, 28: 238, 27: 234, 20: 232, 4: 227, 8: 224, 9: 209, 12: 190, 1: 185, 18: 173, 0: 168, 24: 165, 25: 163, 17: 163, 2: 155, 31: 146, 13: 127, 22: 126, 6: 120})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  57.2134115844965 Time :  705
accuracy train: 0.879881 val: 0.650746 test: 0.707395
max validation accuracy : 0.659701 max acc epoch : 6 test accuracy : 0.692308
Counter({21: 360, 15: 337, 1: 322, 3: 317, 31: 298, 5: 281, 30: 272, 23: 267, 22: 260, 20: 258, 25: 257, 6: 255, 4: 239, 11: 238, 14: 236, 18: 235, 24: 232, 12: 220, 0: 218, 28: 216, 10: 215, 13: 206, 7: 203, 27: 181, 9: 176, 2: 173, 16: 171, 8: 169, 19: 166, 29: 163, 17: 133, 26: 126})

Epoch :  11 loss training:  55.32633511722088 Time :  766
accuracy train: 0.883190 val: 0.659701 test: 0.710116
max validation accuracy : 0.659701 max acc epoch : 6 test accuracy : 0.692308
Counter({6: 426, 5: 388, 31: 371, 27: 335, 15: 318, 18: 317, 3: 301, 26: 269, 14: 257, 2: 256, 12: 251, 23: 250, 9: 241, 30: 241, 20: 237, 19: 233, 16: 212, 7: 209, 29: 193, 11: 192, 0: 185, 10: 183, 28: 182, 25: 173, 22: 172, 21: 167, 13: 166, 8: 163, 4: 139, 1: 133, 24: 126, 17: 114})

Epoch :  12 loss training:  53.19917096197605 Time :  832
accuracy train: 0.890139 val: 0.671642 test: 0.711353
max validation accuracy : 0.671642 max acc epoch : 12 test accuracy : 0.711353
Counter({18: 574, 19: 367, 0: 325, 1: 290, 23: 285, 11: 278, 24: 272, 4: 269, 22: 266, 13: 265, 2: 259, 16: 253, 25: 248, 21: 247, 17: 246, 7: 238, 6: 226, 9: 211, 26: 211, 8: 206, 10: 202, 12: 199, 3: 183, 5: 175, 31: 172, 27: 160, 14: 145, 29: 135, 15: 132, 20: 126, 30: 121, 28: 114})

Epoch :  13 loss training:  50.60844222456217 Time :  895
accuracy train: 0.908339 val: 0.677612 test: 0.712095
max validation accuracy : 0.677612 max acc epoch : 13 test accuracy : 0.712095
Counter({5: 563, 19: 359, 10: 345, 11: 300, 29: 276, 0: 269, 22: 269, 2: 265, 25: 260, 15: 258, 27: 254, 31: 252, 28: 251, 13: 242, 16: 242, 9: 231, 1: 227, 30: 225, 8: 212, 12: 206, 20: 192, 4: 186, 23: 186, 17: 184, 26: 173, 24: 167, 7: 154, 14: 150, 6: 147, 3: 129, 18: 125, 21: 101})

Epoch :  14 loss training:  46.1518909484148 Time :  956
accuracy train: 0.913633 val: 0.662687 test: 0.710364
max validation accuracy : 0.677612 max acc epoch : 13 test accuracy : 0.712095
Counter({13: 416, 1: 387, 28: 383, 8: 358, 10: 294, 3: 271, 9: 270, 15: 264, 20: 264, 30: 262, 11: 260, 4: 259, 2: 250, 16: 243, 5: 242, 26: 241, 21: 237, 23: 235, 17: 234, 24: 231, 6: 204, 19: 188, 25: 183, 18: 175, 27: 155, 0: 154, 12: 145, 7: 141, 29: 129, 22: 120, 14: 112, 31: 93})

Epoch :  15 loss training:  44.58973316848278 Time :  1045
accuracy train: 0.919259 val: 0.671642 test: 0.714816
max validation accuracy : 0.677612 max acc epoch : 13 test accuracy : 0.712095
Counter({4: 414, 25: 366, 13: 339, 2: 334, 14: 332, 16: 292, 5: 278, 24: 265, 27: 256, 21: 255, 17: 254, 11: 247, 8: 240, 15: 239, 3: 237, 23: 236, 6: 232, 29: 231, 7: 226, 20: 195, 0: 187, 12: 181, 22: 179, 19: 177, 26: 175, 18: 171, 10: 168, 1: 158, 9: 157, 31: 146, 28: 128, 30: 105})

Epoch :  16 loss training:  42.125416591763496 Time :  1111
accuracy train: 0.932826 val: 0.665672 test: 0.710858
max validation accuracy : 0.677612 max acc epoch : 13 test accuracy : 0.712095
Counter({10: 577, 5: 413, 3: 370, 28: 325, 18: 293, 29: 278, 21: 276, 11: 271, 14: 268, 7: 262, 16: 262, 15: 257, 9: 253, 8: 245, 26: 238, 19: 218, 27: 217, 12: 204, 25: 202, 4: 192, 0: 182, 24: 171, 17: 170, 22: 165, 13: 158, 30: 157, 6: 156, 20: 129, 1: 128, 31: 123, 23: 123, 2: 117})

Epoch :  17 loss training:  38.61811002343893 Time :  1179
accuracy train: 0.940437 val: 0.668657 test: 0.707890
max validation accuracy : 0.677612 max acc epoch : 13 test accuracy : 0.712095
Counter({20: 378, 28: 373, 0: 363, 11: 308, 1: 303, 16: 291, 10: 275, 23: 273, 31: 269, 13: 269, 9: 265, 24: 261, 15: 252, 4: 245, 30: 245, 21: 241, 12: 236, 17: 231, 29: 227, 5: 219, 3: 206, 2: 201, 18: 183, 22: 182, 19: 175, 26: 170, 14: 158, 7: 157, 8: 140, 27: 127, 25: 95, 6: 82})

Epoch :  18 loss training:  36.096335023641586 Time :  1241
accuracy train: 0.948709 val: 0.668657 test: 0.710858
max validation accuracy : 0.677612 max acc epoch : 13 test accuracy : 0.712095
Counter({12: 345, 1: 341, 11: 333, 2: 320, 26: 314, 3: 309, 31: 303, 29: 279, 13: 261, 18: 250, 9: 250, 22: 250, 19: 249, 23: 245, 7: 241, 24: 235, 21: 229, 14: 227, 20: 227, 4: 223, 15: 222, 16: 199, 30: 184, 17: 183, 25: 170, 10: 162, 8: 161, 28: 159, 0: 156, 5: 128, 27: 125, 6: 120})

Epoch :  19 loss training:  35.13962395489216 Time :  1302
accuracy train: 0.954335 val: 0.677612 test: 0.710364
max validation accuracy : 0.677612 max acc epoch : 13 test accuracy : 0.712095
Counter({27: 371, 29: 362, 26: 324, 2: 323, 24: 309, 1: 301, 13: 282, 14: 281, 7: 271, 25: 263, 6: 261, 23: 258, 16: 251, 30: 250, 21: 245, 15: 237, 9: 231, 0: 229, 17: 225, 3: 214, 10: 212, 5: 206, 4: 201, 31: 177, 20: 169, 22: 160, 8: 159, 19: 139, 18: 133, 11: 131, 28: 126, 12: 99})

Epoch :  20 loss training:  32.39716535061598 Time :  1393
accuracy train: 0.962277 val: 0.680597 test: 0.710364
max validation accuracy : 0.680597 max acc epoch : 20 test accuracy : 0.710364
Counter({1: 434, 7: 366, 3: 324, 27: 314, 0: 313, 23: 312, 28: 310, 26: 275, 20: 268, 8: 261, 18: 258, 16: 254, 30: 247, 14: 239, 13: 238, 2: 231, 29: 229, 9: 222, 25: 200, 11: 199, 22: 195, 6: 181, 5: 181, 21: 179, 15: 174, 12: 168, 4: 168, 17: 158, 10: 156, 19: 134, 31: 121, 24: 91})

Epoch :  21 loss training:  31.379191994667053 Time :  1456
accuracy train: 0.967571 val: 0.677612 test: 0.708632
max validation accuracy : 0.680597 max acc epoch : 20 test accuracy : 0.710364
Counter({30: 416, 14: 399, 4: 380, 5: 372, 0: 361, 24: 310, 25: 308, 2: 291, 1: 287, 18: 258, 11: 254, 20: 252, 28: 243, 26: 235, 29: 234, 9: 234, 8: 233, 16: 227, 23: 201, 3: 199, 31: 189, 13: 176, 10: 174, 22: 171, 12: 168, 15: 158, 6: 156, 21: 121, 17: 114, 19: 99, 27: 93, 7: 87})

Epoch :  22 loss training:  27.588769145309925 Time :  1549
accuracy train: 0.968233 val: 0.689552 test: 0.712837
max validation accuracy : 0.689552 max acc epoch : 22 test accuracy : 0.712837
Counter({1: 415, 5: 407, 11: 382, 12: 362, 7: 315, 26: 303, 18: 294, 9: 292, 28: 259, 2: 255, 21: 255, 30: 255, 27: 242, 19: 241, 23: 240, 10: 237, 22: 234, 0: 233, 14: 225, 20: 201, 25: 197, 17: 178, 13: 174, 8: 169, 29: 166, 3: 166, 15: 155, 24: 137, 31: 121, 4: 97, 16: 97, 6: 96})

Epoch :  23 loss training:  25.91978993266821 Time :  1609
accuracy train: 0.975844 val: 0.689552 test: 0.710858
max validation accuracy : 0.689552 max acc epoch : 22 test accuracy : 0.712837
Counter({4: 416, 10: 398, 6: 381, 7: 365, 24: 314, 14: 302, 16: 294, 23: 280, 11: 255, 17: 255, 22: 254, 30: 248, 9: 240, 21: 240, 3: 235, 31: 235, 27: 234, 13: 234, 8: 217, 5: 200, 0: 199, 15: 178, 26: 175, 19: 170, 20: 167, 18: 166, 25: 157, 1: 150, 2: 134, 29: 122, 28: 101, 12: 84})

Epoch :  24 loss training:  24.118972539901733 Time :  1668
accuracy train: 0.975182 val: 0.689552 test: 0.717784
max validation accuracy : 0.689552 max acc epoch : 22 test accuracy : 0.712837
Counter({0: 569, 2: 413, 8: 393, 4: 383, 31: 376, 3: 298, 28: 270, 15: 266, 11: 251, 10: 245, 20: 241, 9: 239, 14: 237, 17: 235, 26: 234, 29: 233, 13: 211, 1: 198, 22: 197, 12: 187, 16: 177, 21: 176, 19: 172, 24: 167, 30: 166, 25: 162, 6: 159, 7: 156, 5: 124, 27: 122, 18: 92, 23: 51})

Epoch :  25 loss training:  23.905997175723314 Time :  1753
accuracy train: 0.979153 val: 0.677612 test: 0.717536
max validation accuracy : 0.689552 max acc epoch : 22 test accuracy : 0.712837
Counter({11: 382, 5: 333, 31: 331, 8: 331, 15: 329, 2: 314, 25: 310, 7: 285, 1: 275, 14: 264, 26: 248, 10: 247, 18: 239, 12: 238, 17: 235, 6: 232, 0: 230, 29: 229, 3: 224, 21: 209, 13: 199, 27: 197, 16: 194, 30: 169, 22: 167, 24: 167, 4: 165, 9: 159, 23: 159, 28: 125, 20: 117, 19: 97})

Epoch :  26 loss training:  21.078183848410845 Time :  1819
accuracy train: 0.984447 val: 0.695522 test: 0.714816
max validation accuracy : 0.695522 max acc epoch : 26 test accuracy : 0.714816
Counter({19: 377, 10: 334, 3: 329, 5: 328, 0: 327, 4: 319, 7: 306, 21: 295, 9: 285, 1: 282, 11: 262, 23: 250, 20: 246, 2: 239, 26: 235, 17: 230, 18: 229, 15: 222, 22: 211, 30: 201, 29: 200, 14: 185, 6: 185, 13: 167, 28: 165, 24: 163, 27: 163, 31: 163, 16: 162, 25: 126, 8: 118, 12: 96})

Epoch :  27 loss training:  18.69416832178831 Time :  1882
accuracy train: 0.984447 val: 0.704478 test: 0.714568
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({0: 433, 19: 389, 14: 350, 13: 328, 20: 325, 30: 324, 4: 323, 1: 315, 15: 294, 6: 262, 12: 254, 3: 252, 24: 243, 17: 234, 26: 232, 21: 231, 11: 230, 9: 227, 22: 224, 16: 211, 8: 191, 23: 190, 18: 187, 29: 164, 2: 162, 5: 162, 27: 132, 25: 129, 31: 126, 10: 121, 7: 102, 28: 53})

Epoch :  28 loss training:  17.715285934507847 Time :  1944
accuracy train: 0.987426 val: 0.689552 test: 0.714568
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({11: 374, 3: 343, 23: 326, 30: 323, 21: 322, 26: 316, 8: 283, 1: 281, 19: 278, 12: 269, 25: 268, 9: 253, 16: 243, 0: 241, 17: 238, 24: 238, 5: 235, 29: 230, 31: 227, 15: 213, 10: 197, 7: 193, 27: 168, 20: 166, 22: 163, 6: 162, 2: 161, 28: 156, 18: 152, 13: 128, 14: 127, 4: 126})

Epoch :  29 loss training:  17.00732709094882 Time :  2002
accuracy train: 0.986433 val: 0.686567 test: 0.713579
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({13: 504, 1: 460, 12: 438, 5: 358, 19: 307, 18: 286, 8: 280, 14: 266, 23: 261, 10: 255, 27: 241, 6: 240, 25: 235, 24: 232, 15: 228, 21: 225, 7: 215, 3: 214, 2: 199, 0: 196, 4: 178, 16: 171, 22: 169, 28: 163, 29: 161, 20: 153, 26: 138, 17: 136, 9: 131, 30: 125, 31: 119, 11: 116})

Epoch :  30 loss training:  16.83410499058664 Time :  2084
accuracy train: 0.990735 val: 0.686567 test: 0.711600
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({30: 455, 4: 446, 14: 411, 15: 324, 6: 302, 27: 286, 22: 279, 24: 278, 23: 277, 8: 265, 31: 257, 11: 253, 13: 242, 0: 241, 29: 238, 18: 238, 10: 232, 25: 218, 17: 212, 1: 198, 2: 195, 12: 187, 3: 171, 26: 157, 16: 153, 20: 151, 9: 148, 19: 142, 5: 135, 28: 129, 21: 129, 7: 51})

Epoch :  31 loss training:  13.968722989782691 Time :  2141
accuracy train: 0.992720 val: 0.686567 test: 0.711848
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({2: 452, 17: 450, 15: 408, 13: 369, 7: 327, 10: 311, 3: 300, 5: 279, 14: 264, 29: 256, 11: 245, 30: 243, 16: 243, 19: 240, 20: 238, 12: 232, 1: 220, 22: 211, 31: 201, 28: 194, 6: 184, 18: 170, 25: 167, 0: 163, 21: 158, 4: 151, 27: 151, 26: 150, 9: 145, 24: 129, 23: 93, 8: 56})

Epoch :  32 loss training:  14.622999245300889 Time :  2208
accuracy train: 0.993713 val: 0.683582 test: 0.712590
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({7: 359, 14: 339, 3: 331, 16: 323, 30: 311, 17: 302, 28: 298, 20: 294, 10: 287, 1: 286, 0: 276, 2: 254, 31: 249, 22: 241, 18: 238, 25: 233, 21: 232, 19: 225, 5: 222, 9: 215, 8: 207, 4: 199, 23: 198, 11: 170, 12: 168, 26: 158, 27: 152, 13: 151, 6: 144, 29: 128, 24: 119, 15: 91})

Epoch :  33 loss training:  13.330682059749961 Time :  2269
accuracy train: 0.993382 val: 0.704478 test: 0.711848
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({11: 457, 13: 378, 1: 361, 0: 342, 14: 324, 31: 321, 10: 318, 4: 314, 15: 303, 21: 297, 2: 274, 9: 253, 5: 249, 28: 240, 18: 233, 7: 232, 23: 224, 8: 216, 24: 211, 12: 209, 17: 200, 6: 171, 3: 170, 19: 160, 16: 155, 27: 151, 26: 128, 20: 125, 25: 118, 30: 112, 29: 93, 22: 61})

Epoch :  34 loss training:  11.630719785578549 Time :  2362
accuracy train: 0.992389 val: 0.686567 test: 0.718773
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({6: 423, 0: 358, 14: 330, 22: 329, 16: 329, 12: 315, 17: 306, 29: 300, 11: 298, 20: 289, 28: 253, 15: 250, 9: 249, 5: 249, 31: 243, 19: 240, 2: 232, 21: 224, 1: 220, 8: 219, 13: 206, 24: 202, 4: 191, 18: 168, 27: 150, 25: 150, 7: 129, 26: 125, 30: 118, 23: 114, 10: 97, 3: 94})

Epoch :  35 loss training:  10.48899606615305 Time :  2424
accuracy train: 0.995698 val: 0.695522 test: 0.713826
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({3: 504, 28: 476, 0: 407, 13: 374, 9: 330, 15: 329, 18: 311, 16: 303, 12: 250, 23: 248, 21: 240, 11: 236, 20: 230, 10: 225, 19: 221, 24: 220, 1: 219, 27: 219, 30: 217, 22: 203, 29: 199, 2: 181, 31: 170, 14: 155, 6: 151, 5: 147, 4: 145, 17: 121, 26: 117, 7: 100, 8: 97, 25: 55})

Epoch :  36 loss training:  10.121638314798474 Time :  2484
accuracy train: 0.996360 val: 0.689552 test: 0.714074
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({7: 455, 1: 415, 19: 413, 8: 386, 26: 349, 10: 318, 14: 316, 15: 308, 24: 290, 20: 251, 9: 249, 5: 245, 16: 237, 22: 233, 17: 228, 4: 218, 13: 217, 29: 211, 2: 208, 25: 204, 3: 184, 12: 171, 11: 168, 0: 159, 28: 155, 30: 153, 21: 152, 18: 119, 6: 117, 31: 106, 23: 88, 27: 77})

Epoch :  37 loss training:  9.383143058978021 Time :  2574
accuracy train: 0.995698 val: 0.692537 test: 0.713579
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({20: 445, 4: 431, 5: 431, 17: 430, 12: 382, 29: 323, 3: 307, 11: 289, 16: 252, 15: 249, 8: 244, 9: 224, 25: 217, 7: 216, 1: 212, 24: 208, 27: 203, 31: 200, 26: 183, 0: 183, 19: 170, 13: 170, 18: 167, 10: 162, 22: 158, 23: 157, 28: 154, 14: 151, 6: 133, 2: 125, 30: 117, 21: 107})

Epoch :  38 loss training:  9.130353814922273 Time :  2634
accuracy train: 0.996691 val: 0.695522 test: 0.717289
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({20: 450, 22: 422, 5: 422, 11: 380, 8: 352, 23: 342, 30: 314, 7: 290, 26: 272, 29: 256, 25: 250, 3: 247, 17: 235, 6: 228, 9: 223, 31: 218, 28: 209, 27: 203, 4: 202, 2: 178, 16: 178, 10: 170, 15: 166, 18: 164, 12: 163, 14: 152, 1: 150, 19: 123, 24: 119, 13: 118, 0: 108, 21: 96})

Epoch :  39 loss training:  7.978960221633315 Time :  2697
accuracy train: 0.996691 val: 0.683582 test: 0.718031
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({11: 570, 4: 443, 13: 429, 1: 350, 10: 339, 7: 316, 18: 312, 27: 304, 3: 288, 31: 278, 26: 258, 30: 237, 15: 224, 24: 221, 16: 212, 5: 211, 19: 205, 0: 199, 29: 196, 12: 182, 21: 181, 9: 170, 8: 167, 20: 164, 28: 154, 17: 148, 14: 122, 25: 119, 22: 112, 23: 109, 2: 95, 6: 85})

Epoch :  40 loss training:  7.669586417265236 Time :  2767
accuracy train: 0.999338 val: 0.689552 test: 0.717784
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({0: 442, 17: 423, 7: 354, 20: 347, 24: 329, 15: 323, 28: 312, 6: 307, 30: 287, 19: 282, 13: 247, 16: 237, 4: 226, 22: 224, 3: 219, 9: 213, 23: 211, 18: 209, 26: 205, 21: 204, 2: 198, 27: 197, 8: 170, 10: 170, 29: 164, 11: 155, 1: 155, 14: 151, 25: 123, 12: 120, 5: 114, 31: 82})

Epoch :  41 loss training:  7.070553211029619 Time :  2824
accuracy train: 0.999338 val: 0.689552 test: 0.716794
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({10: 355, 4: 353, 14: 353, 2: 344, 28: 344, 7: 315, 6: 306, 23: 299, 17: 286, 19: 275, 31: 263, 9: 256, 27: 251, 8: 239, 29: 234, 20: 227, 5: 219, 22: 218, 15: 210, 21: 209, 24: 207, 12: 198, 1: 191, 3: 167, 26: 167, 25: 165, 16: 156, 18: 153, 11: 123, 13: 122, 0: 111, 30: 84})

Epoch :  42 loss training:  6.20103266928345 Time :  2908
accuracy train: 0.998015 val: 0.692537 test: 0.715063
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({5: 460, 14: 414, 6: 388, 8: 359, 16: 357, 20: 323, 2: 314, 18: 300, 22: 278, 12: 261, 28: 238, 29: 237, 25: 235, 26: 234, 23: 232, 30: 222, 13: 216, 7: 213, 10: 212, 19: 209, 11: 201, 24: 194, 15: 163, 0: 162, 21: 158, 27: 155, 9: 154, 17: 123, 31: 123, 4: 110, 1: 98, 3: 57})

Epoch :  43 loss training:  6.41627097222954 Time :  2973
accuracy train: 0.998676 val: 0.683582 test: 0.718279
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({27: 371, 15: 360, 13: 351, 17: 333, 6: 330, 1: 329, 16: 311, 7: 310, 31: 294, 24: 288, 0: 282, 8: 263, 5: 262, 2: 256, 28: 253, 20: 238, 12: 232, 11: 231, 10: 226, 18: 225, 4: 220, 23: 208, 21: 207, 3: 186, 25: 155, 9: 122, 26: 116, 30: 108, 14: 107, 29: 94, 22: 75, 19: 57})

Epoch :  44 loss training:  5.133184764534235 Time :  3029
accuracy train: 0.999669 val: 0.683582 test: 0.719763
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({1: 495, 5: 388, 4: 373, 24: 354, 0: 332, 30: 332, 12: 313, 11: 307, 15: 304, 13: 283, 9: 263, 17: 252, 23: 247, 2: 237, 29: 235, 25: 226, 20: 225, 26: 207, 10: 206, 7: 206, 19: 183, 14: 171, 28: 160, 16: 157, 3: 152, 31: 151, 27: 124, 21: 122, 18: 118, 22: 107, 8: 94, 6: 76})

Epoch :  45 loss training:  5.334496697876602 Time :  3120
accuracy train: 0.998015 val: 0.662687 test: 0.719515
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({22: 450, 11: 434, 0: 358, 14: 353, 9: 335, 7: 319, 3: 317, 30: 313, 23: 309, 8: 277, 13: 270, 24: 266, 6: 265, 16: 244, 26: 234, 10: 233, 2: 230, 12: 229, 19: 206, 29: 198, 18: 195, 28: 176, 4: 159, 17: 155, 1: 154, 5: 126, 21: 124, 15: 122, 31: 111, 25: 107, 20: 78, 27: 53})

Epoch :  46 loss training:  4.912252526730299 Time :  3194
accuracy train: 0.999007 val: 0.671642 test: 0.720257
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({2: 492, 22: 405, 6: 352, 9: 350, 1: 325, 14: 313, 11: 311, 5: 299, 3: 266, 24: 254, 28: 248, 4: 232, 20: 231, 30: 231, 0: 230, 15: 229, 10: 226, 25: 218, 31: 213, 16: 206, 19: 200, 8: 195, 29: 187, 23: 186, 13: 177, 27: 158, 12: 153, 7: 145, 26: 126, 21: 112, 17: 77, 18: 53})

Epoch :  47 loss training:  5.180826633702964 Time :  3268
accuracy train: 0.999338 val: 0.680597 test: 0.719021
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({5: 481, 23: 410, 16: 363, 4: 356, 2: 324, 21: 316, 12: 311, 6: 298, 18: 289, 27: 287, 15: 280, 7: 238, 8: 238, 19: 236, 13: 230, 24: 224, 30: 220, 22: 205, 20: 202, 3: 193, 9: 192, 0: 191, 1: 188, 29: 156, 11: 150, 28: 143, 10: 126, 17: 122, 14: 122, 25: 117, 26: 114, 31: 78})

Epoch :  48 loss training:  4.675264751072973 Time :  3347
accuracy train: 0.999669 val: 0.680597 test: 0.719763
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({0: 460, 14: 429, 7: 348, 26: 342, 18: 311, 23: 304, 31: 299, 1: 296, 8: 279, 20: 255, 9: 254, 30: 253, 17: 250, 2: 239, 13: 238, 4: 232, 5: 228, 22: 226, 16: 225, 3: 202, 27: 191, 19: 189, 24: 188, 10: 177, 11: 157, 21: 149, 28: 149, 25: 123, 15: 118, 12: 117, 29: 95, 6: 77})

Epoch :  49 loss training:  4.645566304214299 Time :  3415
accuracy train: 0.999669 val: 0.680597 test: 0.719268
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({25: 493, 9: 404, 1: 375, 29: 364, 17: 351, 15: 313, 7: 308, 10: 300, 2: 295, 24: 264, 31: 245, 12: 235, 19: 234, 14: 232, 6: 229, 0: 227, 3: 222, 11: 222, 5: 207, 30: 205, 28: 198, 27: 188, 20: 186, 13: 175, 8: 151, 4: 148, 16: 141, 23: 124, 18: 120, 26: 115, 21: 78, 22: 51})

Epoch :  50 loss training:  4.127411821624264 Time :  3492
accuracy train: 0.999669 val: 0.674627 test: 0.719763
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({0: 458, 13: 427, 8: 391, 4: 347, 5: 329, 15: 322, 28: 313, 19: 310, 29: 287, 17: 284, 24: 280, 22: 271, 2: 260, 14: 253, 7: 231, 1: 229, 25: 226, 6: 225, 27: 225, 26: 208, 30: 182, 11: 153, 12: 152, 20: 146, 16: 135, 31: 124, 21: 120, 18: 117, 23: 115, 9: 106, 3: 99, 10: 75})

Epoch :  51 loss training:  4.148456088732928 Time :  3549
accuracy train: 1.000000 val: 0.689552 test: 0.722483
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({2: 388, 25: 374, 10: 347, 30: 326, 12: 321, 29: 312, 24: 311, 19: 295, 11: 285, 9: 283, 5: 265, 13: 257, 21: 250, 8: 229, 14: 228, 23: 226, 0: 226, 16: 220, 4: 211, 7: 208, 20: 207, 28: 206, 1: 193, 27: 186, 6: 185, 18: 160, 3: 142, 17: 124, 15: 122, 26: 121, 22: 117, 31: 75})

Epoch :  52 loss training:  3.712177692214027 Time :  3628
accuracy train: 1.000000 val: 0.683582 test: 0.720752
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({29: 371, 2: 370, 17: 356, 0: 347, 7: 325, 11: 317, 5: 311, 12: 310, 22: 304, 30: 295, 18: 274, 16: 263, 20: 253, 21: 240, 9: 239, 4: 234, 6: 229, 19: 228, 13: 225, 3: 220, 10: 209, 24: 205, 15: 183, 14: 173, 28: 147, 31: 147, 1: 143, 26: 122, 23: 120, 8: 115, 25: 75, 27: 50})

Epoch :  53 loss training:  3.483942203456536 Time :  3713
accuracy train: 1.000000 val: 0.677612 test: 0.722978
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({5: 455, 28: 451, 14: 364, 20: 361, 21: 319, 2: 315, 1: 312, 10: 311, 17: 295, 27: 265, 15: 258, 6: 254, 11: 234, 24: 232, 13: 232, 8: 231, 4: 226, 18: 223, 25: 220, 9: 209, 31: 205, 30: 200, 29: 191, 16: 180, 19: 144, 7: 139, 12: 122, 23: 121, 22: 116, 26: 89, 3: 75, 0: 51})

Epoch :  54 loss training:  2.691806893562898 Time :  3782
accuracy train: 0.999669 val: 0.674627 test: 0.719268
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({12: 442, 19: 436, 11: 373, 5: 348, 2: 337, 15: 331, 9: 319, 22: 310, 10: 307, 18: 284, 7: 263, 0: 253, 30: 237, 1: 230, 29: 219, 23: 219, 31: 215, 13: 209, 14: 206, 6: 199, 28: 192, 8: 177, 17: 168, 3: 166, 27: 161, 20: 145, 16: 144, 4: 123, 21: 121, 25: 116, 24: 76, 26: 74})

Epoch :  55 loss training:  3.405117114074528 Time :  3853
accuracy train: 1.000000 val: 0.683582 test: 0.721494
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({9: 455, 20: 449, 1: 440, 8: 432, 10: 344, 31: 318, 17: 309, 23: 308, 30: 256, 26: 255, 22: 235, 18: 234, 25: 233, 0: 221, 19: 220, 14: 216, 28: 212, 21: 206, 12: 206, 16: 201, 29: 188, 15: 182, 4: 179, 5: 173, 7: 158, 27: 145, 13: 142, 2: 121, 24: 121, 6: 117, 3: 74, 11: 50})

Epoch :  56 loss training:  2.4978968997020274 Time :  3928
accuracy train: 0.999669 val: 0.686567 test: 0.720752
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({14: 377, 12: 375, 1: 374, 11: 345, 24: 338, 18: 330, 15: 321, 8: 307, 25: 294, 5: 282, 23: 280, 4: 261, 16: 251, 31: 238, 29: 236, 7: 235, 20: 235, 10: 234, 6: 223, 30: 220, 26: 213, 17: 172, 9: 171, 3: 151, 21: 147, 0: 146, 19: 121, 2: 121, 13: 117, 22: 112, 27: 97, 28: 76})

Epoch :  57 loss training:  3.5319939363980666 Time :  4024
accuracy train: 1.000000 val: 0.677612 test: 0.720010
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({17: 403, 26: 367, 12: 363, 5: 346, 13: 335, 4: 324, 8: 315, 25: 313, 7: 311, 15: 297, 9: 273, 2: 261, 31: 256, 24: 246, 1: 236, 11: 235, 20: 222, 27: 222, 28: 218, 18: 216, 16: 210, 22: 188, 3: 175, 6: 149, 19: 145, 30: 141, 29: 130, 14: 121, 21: 121, 0: 114, 23: 76, 10: 71})

Epoch :  58 loss training:  2.4812582856975496 Time :  4095
accuracy train: 0.999669 val: 0.689552 test: 0.724462
max validation accuracy : 0.704478 max acc epoch : 27 test accuracy : 0.714568
Counter({7: 456, 13: 427, 3: 399, 8: 363, 29: 347, 2: 312, 5: 312, 18: 284, 12: 278, 22: 267, 21: 245, 15: 235, 1: 234, 16: 223, 23: 223, 4: 221, 26: 220, 10: 214, 27: 209, 30: 208, 24: 194, 6: 193, 28: 177, 14: 174, 0: 154, 31: 145, 19: 142, 17: 122, 20: 121, 11: 115, 9: 111, 25: 75})

========================================================================================================================================================================================================
best acc epoch :  27
validation accuracy :  0.7044776119402985
test accuracy :  0.7145683898095474
last test_accuracy :  0.7244620331437052
second best val :  0.6955223880597015
second best test :  0.7148157308929013
max gap 7
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=32, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=450, tsne=False, weight_decay=0)
device :  cuda:0
Counter({16: 333, 9: 331, 15: 298, 20: 292, 0: 281, 25: 279, 12: 274, 11: 260, 8: 253, 10: 252, 3: 244, 14: 243, 13: 239, 4: 238, 5: 235, 29: 234, 30: 225, 7: 222, 1: 220, 24: 216, 23: 214, 2: 210, 22: 202, 19: 195, 21: 195, 28: 191, 26: 190, 18: 183, 17: 178, 6: 169, 27: 160, 31: 144})

Epoch :  1 loss training:  208.11581498384476 Time :  4196
accuracy train: 0.640635 val: 0.632836 test: 0.594113
max validation accuracy : 0.632836 max acc epoch : 1 test accuracy : 0.594113
Counter({6: 372, 5: 313, 21: 306, 12: 294, 29: 291, 7: 286, 10: 275, 27: 274, 23: 263, 4: 258, 13: 253, 25: 246, 11: 242, 20: 242, 16: 236, 24: 229, 28: 225, 0: 225, 1: 222, 9: 218, 3: 217, 17: 216, 18: 205, 26: 197, 22: 197, 15: 191, 19: 175, 8: 166, 31: 165, 2: 162, 14: 120, 30: 119})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  142.66453766822815 Time :  4266
accuracy train: 0.705162 val: 0.680597 test: 0.638140
max validation accuracy : 0.680597 max acc epoch : 2 test accuracy : 0.638140
Counter({0: 408, 12: 384, 18: 362, 7: 331, 14: 298, 13: 295, 19: 277, 23: 272, 24: 269, 5: 267, 9: 253, 17: 246, 21: 237, 27: 235, 2: 234, 6: 234, 4: 226, 26: 222, 28: 221, 22: 220, 15: 197, 31: 196, 3: 189, 25: 179, 16: 171, 8: 161, 10: 158, 1: 155, 30: 141, 11: 134, 29: 122, 20: 106})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.1569852232933 Time :  4341
accuracy train: 0.743216 val: 0.704478 test: 0.668316
max validation accuracy : 0.704478 max acc epoch : 3 test accuracy : 0.668316
Counter({30: 430, 0: 328, 13: 304, 7: 304, 6: 299, 17: 299, 28: 298, 26: 298, 11: 296, 5: 282, 2: 274, 29: 264, 8: 258, 25: 251, 22: 245, 15: 242, 14: 236, 9: 230, 19: 212, 21: 194, 4: 188, 12: 185, 10: 173, 31: 171, 27: 160, 18: 160, 1: 153, 24: 153, 23: 133, 3: 131, 20: 126, 16: 123})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  95.4041593670845 Time :  4468
accuracy train: 0.790536 val: 0.716418 test: 0.686372
max validation accuracy : 0.716418 max acc epoch : 4 test accuracy : 0.686372
Counter({28: 438, 4: 365, 27: 312, 10: 308, 11: 308, 7: 301, 3: 297, 19: 287, 17: 285, 5: 266, 2: 262, 31: 260, 24: 250, 18: 249, 14: 238, 26: 233, 30: 217, 8: 216, 12: 211, 16: 211, 25: 203, 20: 197, 23: 196, 13: 181, 21: 158, 22: 155, 1: 149, 29: 145, 6: 141, 0: 127, 15: 119, 9: 115})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  89.06153443455696 Time :  4561
accuracy train: 0.794507 val: 0.719403 test: 0.685382
max validation accuracy : 0.719403 max acc epoch : 5 test accuracy : 0.685382
Counter({13: 506, 0: 494, 22: 320, 1: 304, 12: 303, 28: 292, 21: 291, 30: 280, 18: 276, 31: 267, 5: 257, 15: 250, 10: 238, 20: 224, 7: 222, 23: 219, 11: 218, 3: 210, 8: 207, 6: 201, 4: 201, 9: 183, 2: 179, 29: 163, 17: 161, 16: 156, 25: 147, 26: 145, 27: 137, 19: 121, 14: 118, 24: 110})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.56368958950043 Time :  4628
accuracy train: 0.824619 val: 0.743284 test: 0.693792
max validation accuracy : 0.743284 max acc epoch : 6 test accuracy : 0.693792
Counter({12: 445, 26: 381, 21: 365, 5: 337, 13: 330, 7: 296, 19: 289, 24: 288, 6: 280, 18: 277, 30: 267, 14: 264, 2: 254, 1: 241, 11: 232, 27: 219, 4: 217, 25: 212, 3: 211, 9: 210, 10: 207, 16: 175, 0: 156, 22: 154, 20: 147, 17: 147, 31: 143, 15: 143, 8: 140, 28: 140, 29: 129, 23: 104})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  73.8570803552866 Time :  4699
accuracy train: 0.846790 val: 0.761194 test: 0.705169
max validation accuracy : 0.761194 max acc epoch : 7 test accuracy : 0.705169
Counter({10: 496, 28: 424, 5: 343, 0: 321, 18: 319, 30: 298, 13: 287, 7: 284, 20: 281, 29: 274, 9: 266, 15: 265, 22: 244, 2: 237, 3: 228, 12: 226, 17: 225, 27: 212, 6: 204, 4: 202, 26: 199, 1: 188, 24: 165, 11: 164, 31: 163, 14: 143, 8: 140, 16: 140, 21: 138, 23: 128, 25: 109, 19: 87})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  69.04061000049114 Time :  4773
accuracy train: 0.854401 val: 0.764179 test: 0.708632
max validation accuracy : 0.764179 max acc epoch : 8 test accuracy : 0.708632
Counter({13: 452, 24: 351, 0: 323, 2: 312, 21: 307, 4: 301, 23: 293, 12: 292, 1: 276, 27: 270, 22: 267, 15: 266, 7: 260, 11: 244, 30: 241, 19: 238, 3: 230, 29: 217, 5: 215, 6: 210, 16: 202, 31: 200, 18: 198, 14: 178, 17: 166, 9: 164, 20: 140, 26: 140, 10: 128, 8: 121, 25: 114, 28: 84})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.36126612126827 Time :  4836
accuracy train: 0.866314 val: 0.755224 test: 0.707148
max validation accuracy : 0.764179 max acc epoch : 8 test accuracy : 0.708632
Counter({3: 516, 12: 455, 1: 332, 25: 312, 16: 300, 15: 299, 9: 292, 6: 273, 18: 269, 27: 263, 13: 263, 11: 249, 20: 249, 29: 242, 21: 230, 10: 229, 30: 228, 4: 219, 19: 203, 14: 193, 22: 188, 28: 184, 0: 167, 26: 167, 23: 159, 31: 156, 2: 148, 5: 142, 8: 138, 17: 126, 7: 117, 24: 92})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  57.62729178369045 Time :  4934
accuracy train: 0.877895 val: 0.755224 test: 0.714074
max validation accuracy : 0.764179 max acc epoch : 8 test accuracy : 0.708632
Counter({0: 492, 24: 413, 18: 321, 15: 306, 8: 306, 13: 298, 17: 295, 6: 289, 26: 277, 10: 271, 12: 268, 19: 266, 3: 249, 2: 236, 11: 230, 28: 229, 20: 228, 31: 222, 27: 195, 30: 192, 4: 190, 23: 183, 22: 180, 5: 170, 29: 168, 21: 168, 7: 156, 25: 139, 9: 138, 14: 126, 1: 109, 16: 90})

Epoch :  11 loss training:  57.96629923582077 Time :  5000
accuracy train: 0.890139 val: 0.758209 test: 0.711106
max validation accuracy : 0.764179 max acc epoch : 8 test accuracy : 0.708632
Counter({20: 421, 9: 354, 30: 317, 10: 313, 24: 304, 27: 301, 12: 298, 6: 292, 2: 277, 5: 270, 0: 263, 31: 259, 18: 257, 21: 248, 19: 230, 11: 229, 4: 226, 1: 221, 16: 215, 13: 211, 25: 207, 28: 206, 22: 205, 15: 198, 14: 172, 26: 162, 7: 143, 17: 142, 3: 140, 23: 116, 8: 112, 29: 91})

Epoch :  12 loss training:  53.91416412591934 Time :  5065
accuracy train: 0.902052 val: 0.770149 test: 0.715558
max validation accuracy : 0.770149 max acc epoch : 12 test accuracy : 0.715558
Counter({20: 552, 17: 490, 29: 381, 28: 360, 4: 307, 3: 301, 23: 293, 12: 291, 24: 273, 1: 266, 5: 254, 21: 249, 6: 231, 14: 229, 16: 228, 11: 227, 9: 223, 19: 217, 10: 215, 0: 201, 31: 187, 18: 163, 13: 162, 8: 161, 26: 144, 15: 143, 30: 142, 7: 139, 27: 118, 25: 115, 22: 87, 2: 51})

Epoch :  13 loss training:  52.06809598207474 Time :  5126
accuracy train: 0.907346 val: 0.752239 test: 0.716794
max validation accuracy : 0.770149 max acc epoch : 12 test accuracy : 0.715558
Counter({3: 489, 23: 360, 15: 356, 29: 341, 18: 314, 6: 306, 7: 304, 1: 295, 21: 294, 14: 284, 4: 272, 22: 264, 0: 257, 26: 246, 31: 223, 28: 222, 10: 213, 20: 213, 11: 207, 13: 200, 27: 198, 8: 167, 5: 165, 9: 162, 25: 157, 19: 151, 24: 146, 30: 140, 12: 134, 16: 118, 2: 113, 17: 89})

Epoch :  14 loss training:  48.207326382398605 Time :  5222
accuracy train: 0.913964 val: 0.752239 test: 0.718279
max validation accuracy : 0.770149 max acc epoch : 12 test accuracy : 0.715558
Counter({16: 482, 4: 415, 3: 379, 24: 309, 30: 303, 21: 300, 9: 292, 23: 280, 28: 269, 0: 263, 13: 260, 27: 249, 1: 236, 12: 231, 14: 222, 5: 220, 8: 217, 18: 211, 26: 202, 17: 201, 31: 197, 20: 197, 2: 197, 25: 185, 15: 168, 11: 164, 7: 144, 6: 143, 19: 133, 29: 132, 22: 109, 10: 90})

Epoch :  15 loss training:  44.8986257314682 Time :  5316
accuracy train: 0.919590 val: 0.755224 test: 0.715558
max validation accuracy : 0.770149 max acc epoch : 12 test accuracy : 0.715558
Counter({18: 515, 6: 425, 10: 385, 4: 305, 28: 303, 12: 303, 0: 294, 14: 288, 25: 266, 27: 260, 26: 245, 24: 238, 16: 232, 19: 230, 3: 225, 15: 218, 22: 217, 1: 214, 5: 206, 2: 199, 8: 191, 20: 190, 23: 180, 21: 173, 7: 172, 13: 161, 29: 145, 17: 141, 9: 134, 11: 120, 31: 119, 30: 106})

Epoch :  16 loss training:  42.57824365794659 Time :  5387
accuracy train: 0.931833 val: 0.773134 test: 0.718031
max validation accuracy : 0.773134 max acc epoch : 16 test accuracy : 0.718031
Counter({14: 572, 4: 496, 9: 439, 18: 412, 19: 347, 13: 298, 25: 291, 20: 287, 3: 265, 12: 252, 11: 223, 24: 216, 8: 214, 28: 214, 2: 213, 0: 203, 21: 199, 30: 194, 22: 188, 1: 184, 5: 173, 31: 172, 16: 164, 23: 160, 15: 148, 6: 144, 27: 143, 26: 139, 29: 134, 17: 119, 10: 108, 7: 89})

Epoch :  17 loss training:  41.415581837296486 Time :  5468
accuracy train: 0.940437 val: 0.761194 test: 0.721247
max validation accuracy : 0.773134 max acc epoch : 16 test accuracy : 0.718031
Counter({7: 486, 23: 398, 16: 360, 9: 352, 18: 318, 20: 301, 31: 291, 8: 289, 15: 286, 1: 268, 14: 268, 21: 245, 24: 232, 17: 228, 27: 218, 12: 215, 0: 211, 2: 211, 26: 208, 19: 201, 6: 193, 29: 192, 28: 191, 30: 188, 4: 178, 11: 158, 3: 145, 5: 134, 25: 121, 22: 114, 10: 107, 13: 93})

Epoch :  18 loss training:  37.73800199478865 Time :  5539
accuracy train: 0.946724 val: 0.770149 test: 0.721741
max validation accuracy : 0.773134 max acc epoch : 16 test accuracy : 0.718031
Counter({1: 530, 2: 430, 22: 399, 15: 358, 7: 303, 0: 300, 4: 292, 9: 272, 11: 271, 26: 267, 31: 237, 30: 235, 12: 227, 6: 219, 20: 214, 23: 209, 17: 209, 28: 207, 18: 197, 13: 193, 29: 189, 25: 189, 24: 177, 3: 172, 8: 166, 14: 150, 5: 146, 21: 145, 10: 139, 16: 130, 19: 118, 27: 110})

Epoch :  19 loss training:  35.70948826521635 Time :  5628
accuracy train: 0.949371 val: 0.773134 test: 0.721494
max validation accuracy : 0.773134 max acc epoch : 16 test accuracy : 0.718031
Counter({24: 543, 5: 475, 19: 428, 15: 360, 17: 303, 9: 300, 12: 292, 23: 292, 2: 269, 31: 260, 25: 238, 22: 229, 3: 227, 8: 223, 14: 215, 7: 210, 10: 208, 28: 204, 0: 196, 4: 191, 20: 184, 26: 174, 13: 168, 6: 159, 16: 156, 1: 146, 21: 146, 11: 143, 18: 131, 27: 121, 30: 110, 29: 99})

Epoch :  20 loss training:  32.35397720336914 Time :  5689
accuracy train: 0.951688 val: 0.770149 test: 0.718773
max validation accuracy : 0.773134 max acc epoch : 16 test accuracy : 0.718031
Counter({18: 492, 4: 459, 17: 368, 30: 360, 14: 309, 19: 298, 11: 289, 15: 287, 8: 286, 25: 268, 9: 260, 10: 259, 27: 236, 21: 233, 7: 226, 28: 209, 31: 208, 16: 208, 5: 197, 29: 197, 3: 194, 26: 193, 6: 186, 1: 174, 12: 172, 24: 160, 22: 143, 13: 130, 23: 123, 20: 113, 0: 106, 2: 57})

Epoch :  21 loss training:  29.650237254798412 Time :  5746
accuracy train: 0.961284 val: 0.764179 test: 0.718526
max validation accuracy : 0.773134 max acc epoch : 16 test accuracy : 0.718031
Counter({8: 528, 27: 456, 13: 420, 15: 354, 17: 342, 7: 312, 4: 296, 21: 291, 11: 289, 6: 269, 10: 254, 0: 231, 9: 229, 28: 228, 25: 221, 26: 214, 31: 211, 5: 209, 12: 208, 3: 204, 22: 188, 2: 178, 19: 169, 20: 160, 29: 146, 23: 144, 1: 140, 18: 130, 16: 124, 24: 116, 30: 74, 14: 65})

Epoch :  22 loss training:  28.806216783821583 Time :  5831
accuracy train: 0.960622 val: 0.785075 test: 0.718279
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({7: 531, 17: 442, 6: 433, 5: 352, 27: 299, 16: 290, 9: 290, 14: 289, 13: 274, 3: 267, 28: 254, 11: 242, 23: 235, 30: 233, 26: 226, 15: 221, 10: 214, 4: 212, 18: 206, 25: 200, 8: 190, 21: 181, 12: 170, 24: 167, 19: 151, 31: 147, 22: 143, 29: 131, 0: 123, 20: 117, 2: 94, 1: 76})

Epoch :  23 loss training:  26.569750390946865 Time :  5922
accuracy train: 0.973858 val: 0.776119 test: 0.721494
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({16: 538, 15: 447, 14: 414, 18: 352, 8: 333, 4: 305, 21: 287, 17: 287, 24: 286, 3: 275, 29: 242, 11: 237, 2: 229, 5: 221, 13: 218, 12: 210, 10: 207, 1: 207, 9: 186, 6: 184, 26: 182, 22: 175, 7: 164, 30: 161, 31: 159, 20: 150, 27: 145, 0: 134, 23: 130, 25: 123, 19: 118, 28: 94})

Epoch :  24 loss training:  25.84924302622676 Time :  6008
accuracy train: 0.973527 val: 0.773134 test: 0.716300
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({3: 520, 6: 423, 12: 348, 11: 342, 29: 330, 15: 306, 16: 305, 4: 294, 0: 294, 7: 286, 23: 276, 24: 266, 28: 242, 17: 240, 22: 229, 20: 228, 13: 226, 25: 225, 5: 222, 31: 212, 2: 211, 26: 198, 1: 165, 19: 141, 30: 139, 8: 134, 27: 127, 18: 122, 21: 120, 10: 92, 14: 74, 9: 63})

Epoch :  25 loss training:  24.261828545480967 Time :  6064
accuracy train: 0.979484 val: 0.776119 test: 0.717536
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({27: 453, 11: 366, 25: 358, 4: 356, 1: 312, 10: 301, 2: 288, 13: 287, 7: 285, 24: 273, 20: 269, 5: 254, 22: 252, 19: 245, 21: 237, 12: 230, 9: 228, 15: 226, 6: 219, 14: 215, 31: 200, 23: 196, 28: 167, 16: 160, 18: 158, 3: 141, 0: 141, 30: 129, 26: 124, 29: 122, 8: 118, 17: 90})

Epoch :  26 loss training:  20.839597560465336 Time :  6141
accuracy train: 0.983455 val: 0.773134 test: 0.719021
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({0: 499, 6: 466, 14: 322, 1: 318, 12: 317, 9: 301, 26: 288, 23: 286, 15: 274, 19: 262, 21: 259, 24: 254, 29: 245, 18: 235, 22: 223, 31: 221, 2: 217, 28: 215, 3: 209, 20: 208, 4: 197, 17: 194, 27: 193, 25: 166, 5: 160, 30: 142, 8: 141, 7: 138, 10: 124, 13: 119, 16: 118, 11: 89})

Epoch :  27 loss training:  20.434888530522585 Time :  6209
accuracy train: 0.982131 val: 0.776119 test: 0.725204
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({16: 489, 30: 358, 6: 329, 0: 318, 11: 305, 13: 301, 5: 291, 9: 283, 4: 278, 12: 277, 7: 277, 24: 275, 15: 251, 8: 246, 18: 242, 26: 240, 22: 227, 2: 226, 29: 219, 31: 216, 23: 208, 3: 204, 27: 202, 19: 163, 28: 152, 20: 144, 10: 143, 21: 130, 1: 121, 14: 121, 25: 89, 17: 75})

Epoch :  28 loss training:  18.42323058284819 Time :  6271
accuracy train: 0.988418 val: 0.761194 test: 0.727183
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({20: 466, 8: 447, 4: 357, 16: 331, 30: 310, 21: 295, 5: 288, 10: 286, 9: 283, 14: 279, 6: 278, 17: 277, 18: 240, 0: 238, 22: 230, 26: 230, 27: 227, 23: 210, 2: 210, 11: 179, 29: 179, 1: 176, 13: 169, 24: 166, 7: 164, 15: 155, 12: 152, 19: 145, 31: 140, 25: 125, 28: 122, 3: 46})

Epoch :  29 loss training:  18.930366085842252 Time :  6359
accuracy train: 0.984447 val: 0.773134 test: 0.722483
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({6: 360, 16: 359, 27: 330, 13: 323, 12: 321, 9: 313, 0: 306, 21: 298, 17: 284, 15: 273, 11: 259, 23: 250, 18: 249, 1: 245, 7: 243, 26: 240, 30: 231, 8: 227, 19: 226, 24: 226, 3: 209, 5: 191, 4: 188, 2: 167, 28: 163, 31: 162, 25: 152, 14: 145, 29: 137, 10: 136, 22: 127, 20: 60})

Epoch :  30 loss training:  16.360679294914007 Time :  6419
accuracy train: 0.992720 val: 0.770149 test: 0.725204
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({6: 476, 22: 427, 5: 422, 16: 401, 14: 316, 3: 300, 7: 298, 8: 289, 17: 288, 26: 287, 1: 258, 21: 255, 11: 237, 12: 235, 4: 224, 18: 210, 31: 202, 10: 201, 24: 199, 2: 188, 23: 184, 20: 168, 25: 165, 15: 163, 30: 152, 28: 140, 19: 137, 9: 130, 0: 130, 27: 126, 13: 121, 29: 71})

Epoch :  31 loss training:  14.33765716664493 Time :  6487
accuracy train: 0.989742 val: 0.773134 test: 0.729162
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({1: 461, 0: 418, 14: 409, 17: 402, 9: 373, 4: 302, 8: 299, 5: 288, 6: 284, 28: 273, 16: 273, 22: 246, 11: 233, 24: 231, 30: 228, 3: 218, 19: 204, 7: 196, 2: 189, 25: 187, 18: 182, 10: 161, 21: 157, 26: 155, 15: 151, 29: 146, 31: 143, 12: 130, 13: 130, 27: 128, 23: 122, 20: 81})

Epoch :  32 loss training:  14.183279106393456 Time :  6571
accuracy train: 0.994375 val: 0.776119 test: 0.721247
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({22: 440, 2: 420, 1: 404, 12: 378, 6: 302, 4: 299, 0: 290, 15: 289, 7: 272, 18: 271, 8: 268, 25: 250, 31: 244, 23: 244, 16: 231, 27: 226, 24: 222, 26: 218, 3: 202, 30: 193, 10: 192, 20: 181, 21: 175, 14: 153, 11: 149, 13: 147, 5: 146, 29: 145, 17: 132, 19: 130, 9: 107, 28: 80})

Epoch :  33 loss training:  13.583107460290194 Time :  6627
accuracy train: 0.993713 val: 0.761194 test: 0.721494
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({16: 472, 6: 419, 17: 380, 13: 377, 1: 327, 29: 302, 4: 299, 9: 295, 26: 292, 8: 269, 28: 257, 3: 245, 23: 237, 5: 233, 12: 230, 0: 217, 31: 201, 20: 198, 22: 190, 11: 187, 19: 176, 15: 170, 25: 161, 24: 155, 10: 149, 30: 148, 7: 148, 18: 146, 2: 135, 27: 131, 14: 131, 21: 123})

Epoch :  34 loss training:  12.906018754467368 Time :  6718
accuracy train: 0.995367 val: 0.767164 test: 0.721247
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({28: 473, 1: 410, 6: 331, 2: 324, 5: 303, 25: 301, 19: 300, 21: 298, 13: 293, 24: 276, 7: 262, 20: 242, 23: 235, 30: 234, 9: 227, 18: 225, 10: 221, 4: 220, 11: 207, 29: 207, 3: 207, 14: 192, 16: 185, 22: 158, 15: 149, 12: 146, 0: 145, 26: 144, 8: 133, 17: 131, 27: 126, 31: 95})

Epoch :  35 loss training:  10.697256403043866 Time :  6777
accuracy train: 0.996360 val: 0.770149 test: 0.718031
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({5: 522, 23: 465, 3: 393, 18: 321, 6: 309, 28: 300, 9: 298, 11: 297, 10: 292, 1: 288, 25: 278, 12: 272, 29: 261, 0: 235, 15: 233, 31: 230, 13: 223, 14: 203, 4: 200, 2: 196, 7: 158, 16: 149, 19: 149, 8: 144, 17: 143, 22: 140, 24: 139, 20: 135, 27: 125, 21: 120, 30: 102, 26: 80})

Epoch :  36 loss training:  11.208198772743344 Time :  6843
accuracy train: 0.997022 val: 0.758209 test: 0.719021
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({13: 471, 27: 398, 25: 368, 4: 323, 6: 307, 3: 304, 29: 289, 1: 289, 15: 267, 20: 261, 2: 248, 5: 238, 24: 237, 21: 232, 22: 232, 17: 226, 18: 225, 8: 217, 31: 213, 19: 213, 23: 206, 12: 205, 9: 204, 0: 177, 30: 151, 16: 148, 14: 143, 11: 138, 7: 138, 10: 137, 26: 106, 28: 89})

Epoch :  37 loss training:  10.280768347904086 Time :  6907
accuracy train: 0.996691 val: 0.776119 test: 0.715805
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({22: 520, 9: 453, 25: 412, 2: 390, 7: 307, 10: 303, 20: 291, 29: 268, 1: 266, 4: 265, 0: 253, 5: 238, 21: 238, 14: 235, 26: 224, 12: 214, 28: 210, 15: 207, 6: 200, 16: 197, 30: 182, 18: 171, 8: 168, 23: 150, 19: 148, 17: 148, 13: 143, 24: 141, 31: 138, 11: 134, 3: 131, 27: 55})

Epoch :  38 loss training:  9.534565227106214 Time :  6994
accuracy train: 0.997022 val: 0.770149 test: 0.713332
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({3: 515, 16: 423, 10: 323, 15: 314, 31: 308, 13: 295, 9: 289, 4: 289, 26: 264, 29: 261, 19: 256, 6: 253, 27: 243, 14: 241, 28: 221, 23: 215, 24: 214, 7: 202, 1: 198, 5: 193, 0: 192, 17: 185, 21: 179, 30: 172, 2: 170, 25: 148, 11: 145, 20: 145, 12: 145, 8: 139, 18: 132, 22: 131})

Epoch :  39 loss training:  8.950607791543007 Time :  7048
accuracy train: 0.998676 val: 0.782090 test: 0.714816
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({12: 535, 29: 481, 3: 403, 4: 319, 8: 315, 1: 308, 5: 302, 16: 293, 24: 289, 28: 277, 31: 268, 19: 263, 13: 247, 9: 246, 17: 236, 11: 203, 2: 202, 0: 194, 15: 187, 26: 175, 18: 156, 30: 151, 21: 150, 23: 148, 20: 147, 14: 146, 7: 145, 10: 140, 25: 132, 22: 127, 6: 123, 27: 92})

Epoch :  40 loss training:  8.521942425519228 Time :  7110
accuracy train: 0.997684 val: 0.767164 test: 0.718526
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({20: 478, 2: 401, 9: 386, 3: 376, 28: 315, 7: 311, 8: 291, 27: 289, 11: 265, 13: 264, 16: 259, 14: 254, 26: 249, 17: 246, 12: 227, 18: 220, 10: 218, 25: 210, 23: 203, 24: 202, 5: 202, 4: 191, 0: 180, 21: 175, 6: 146, 15: 145, 1: 144, 29: 135, 22: 133, 19: 106, 31: 90, 30: 89})

Epoch :  41 loss training:  6.9653654508292675 Time :  7197
accuracy train: 0.996691 val: 0.761194 test: 0.722483
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({1: 521, 2: 419, 29: 381, 13: 318, 17: 317, 5: 315, 18: 294, 15: 277, 4: 264, 14: 256, 23: 246, 20: 242, 3: 242, 22: 242, 16: 239, 27: 228, 0: 225, 10: 210, 8: 208, 31: 205, 7: 199, 11: 195, 24: 191, 28: 185, 12: 151, 21: 147, 30: 146, 19: 143, 26: 131, 25: 125, 9: 83, 6: 55})

Epoch :  42 loss training:  7.1360442684963346 Time :  7262
accuracy train: 0.997684 val: 0.776119 test: 0.722978
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({22: 460, 16: 436, 1: 360, 0: 338, 12: 314, 17: 307, 15: 294, 10: 287, 3: 282, 9: 260, 4: 257, 18: 253, 26: 245, 19: 240, 21: 240, 13: 210, 8: 209, 11: 202, 25: 191, 23: 187, 20: 187, 31: 179, 2: 172, 28: 163, 6: 159, 27: 156, 24: 149, 29: 148, 5: 141, 30: 131, 14: 126, 7: 117})

Epoch :  43 loss training:  7.780425493605435 Time :  7328
accuracy train: 0.997684 val: 0.758209 test: 0.709374
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({25: 488, 7: 414, 2: 372, 3: 352, 6: 309, 31: 305, 19: 297, 5: 293, 26: 266, 17: 262, 30: 256, 18: 253, 9: 242, 8: 237, 21: 233, 4: 212, 12: 209, 24: 209, 13: 205, 15: 200, 16: 191, 0: 185, 14: 176, 10: 171, 27: 150, 22: 150, 23: 143, 1: 137, 11: 130, 20: 127, 28: 114, 29: 112})

Epoch :  44 loss training:  5.713312976062298 Time :  7412
accuracy train: 0.999007 val: 0.770149 test: 0.714816
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({6: 481, 1: 426, 3: 371, 25: 355, 12: 316, 4: 312, 5: 310, 8: 309, 9: 305, 31: 268, 28: 259, 11: 247, 21: 237, 20: 227, 27: 226, 10: 214, 18: 212, 30: 208, 2: 203, 14: 200, 26: 199, 16: 194, 17: 191, 23: 155, 22: 146, 29: 144, 24: 137, 13: 129, 15: 122, 19: 118, 7: 113, 0: 66})

Epoch :  45 loss training:  6.1386101841926575 Time :  7496
accuracy train: 0.998676 val: 0.773134 test: 0.716794
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({2: 475, 31: 426, 22: 389, 1: 329, 26: 316, 13: 310, 16: 307, 7: 304, 15: 292, 23: 273, 10: 260, 12: 250, 3: 244, 24: 238, 9: 232, 17: 227, 4: 218, 5: 210, 30: 205, 6: 203, 14: 191, 25: 184, 0: 169, 8: 155, 21: 146, 29: 144, 20: 136, 19: 130, 27: 125, 18: 123, 28: 97, 11: 92})

Epoch :  46 loss training:  5.459897132590413 Time :  7600
accuracy train: 0.998676 val: 0.779104 test: 0.716052
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({2: 469, 7: 466, 3: 437, 24: 358, 25: 311, 10: 309, 4: 303, 15: 291, 18: 267, 22: 261, 5: 252, 12: 243, 29: 241, 23: 228, 16: 213, 1: 207, 0: 206, 20: 203, 30: 198, 6: 198, 8: 184, 21: 171, 14: 170, 28: 153, 13: 147, 27: 145, 19: 139, 31: 136, 11: 131, 17: 130, 26: 127, 9: 106})

Epoch :  47 loss training:  5.245296468725428 Time :  7674
accuracy train: 0.998676 val: 0.761194 test: 0.719763
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({1: 393, 23: 362, 20: 356, 0: 343, 4: 320, 12: 311, 2: 309, 10: 301, 5: 294, 31: 260, 14: 256, 29: 252, 17: 248, 22: 248, 6: 239, 8: 228, 16: 208, 3: 205, 28: 201, 26: 201, 11: 200, 21: 186, 9: 180, 25: 177, 7: 172, 18: 167, 15: 145, 30: 144, 24: 137, 19: 130, 27: 123, 13: 104})

Epoch :  48 loss training:  4.983129917643964 Time :  7774
accuracy train: 0.999007 val: 0.770149 test: 0.714816
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({13: 837, 10: 318, 30: 317, 1: 317, 24: 309, 11: 305, 9: 295, 8: 272, 22: 272, 29: 261, 4: 250, 19: 239, 27: 237, 16: 226, 6: 214, 20: 211, 21: 203, 0: 201, 17: 197, 12: 187, 5: 181, 31: 177, 3: 169, 7: 149, 18: 148, 26: 146, 15: 144, 14: 137, 2: 129, 23: 123, 25: 121, 28: 108})

Epoch :  49 loss training:  4.6876302633900195 Time :  7853
accuracy train: 0.998345 val: 0.773134 test: 0.713826
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({10: 406, 3: 388, 14: 373, 16: 351, 20: 325, 4: 319, 19: 316, 12: 309, 25: 302, 18: 270, 22: 259, 26: 244, 8: 240, 9: 239, 5: 238, 21: 236, 1: 222, 29: 220, 27: 211, 0: 205, 11: 202, 23: 198, 6: 191, 24: 151, 28: 147, 31: 146, 15: 139, 13: 137, 7: 129, 2: 123, 30: 108, 17: 56})

Epoch :  50 loss training:  4.780995165463537 Time :  7991
accuracy train: 0.997353 val: 0.752239 test: 0.717042
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({27: 474, 1: 392, 28: 373, 4: 369, 31: 329, 26: 310, 12: 302, 3: 301, 16: 257, 10: 251, 0: 248, 19: 238, 5: 237, 30: 237, 24: 237, 23: 233, 7: 227, 17: 223, 20: 220, 6: 205, 22: 203, 13: 201, 15: 168, 18: 166, 9: 155, 25: 147, 2: 145, 14: 137, 8: 129, 29: 119, 11: 108, 21: 59})

Epoch :  51 loss training:  5.20551714906469 Time :  8232
accuracy train: 0.997684 val: 0.758209 test: 0.718279
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({4: 492, 18: 428, 22: 378, 15: 368, 2: 360, 7: 318, 16: 316, 8: 304, 13: 304, 26: 271, 0: 248, 21: 246, 6: 242, 31: 242, 3: 238, 1: 236, 12: 233, 19: 222, 10: 206, 9: 203, 17: 201, 24: 197, 23: 167, 28: 154, 27: 137, 14: 132, 30: 131, 25: 116, 29: 105, 20: 92, 11: 58, 5: 55})

Epoch :  52 loss training:  4.5793166807852685 Time :  8309
accuracy train: 0.998345 val: 0.767164 test: 0.719021
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({16: 514, 0: 414, 29: 337, 1: 314, 6: 305, 7: 305, 4: 296, 21: 282, 3: 269, 22: 266, 5: 251, 28: 248, 13: 240, 26: 238, 24: 236, 9: 235, 25: 226, 12: 220, 17: 207, 15: 200, 31: 191, 30: 190, 27: 172, 14: 170, 10: 153, 8: 148, 11: 147, 20: 137, 2: 136, 19: 129, 23: 116, 18: 108})

Epoch :  53 loss training:  4.481462551280856 Time :  8393
accuracy train: 0.999007 val: 0.776119 test: 0.720257
max validation accuracy : 0.785075 max acc epoch : 22 test accuracy : 0.718279
Counter({2: 477, 11: 405, 29: 393, 27: 386, 20: 334, 3: 321, 9: 315, 30: 304, 15: 247, 21: 246, 22: 243, 16: 243, 7: 240, 17: 239, 23: 234, 5: 224, 25: 220, 1: 213, 8: 199, 13: 198, 14: 193, 18: 184, 6: 182, 10: 169, 4: 158, 28: 148, 19: 140, 0: 136, 31: 129, 26: 120, 12: 108, 24: 52})

========================================================================================================================================================================================================
best acc epoch :  22
validation accuracy :  0.7850746268656716
test accuracy :  0.7182785060598565
last test_accuracy :  0.7202572347266881
second best val :  0.7820895522388059
second best test :  0.7182785060598565
max gap 6
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=32, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=117, tsne=False, weight_decay=0)
device :  cuda:0
Counter({7: 331, 8: 319, 19: 307, 13: 292, 16: 279, 5: 276, 6: 270, 22: 268, 28: 264, 3: 264, 18: 261, 2: 259, 10: 256, 4: 247, 21: 246, 24: 238, 0: 222, 23: 220, 26: 217, 11: 214, 1: 209, 12: 201, 15: 197, 31: 194, 27: 186, 25: 185, 17: 185, 14: 173, 30: 157, 29: 156, 20: 155, 9: 152})

Epoch :  1 loss training:  209.0624025464058 Time :  8561
accuracy train: 0.630046 val: 0.644776 test: 0.600297
max validation accuracy : 0.644776 max acc epoch : 1 test accuracy : 0.600297
Counter({10: 401, 9: 397, 22: 346, 25: 305, 13: 304, 31: 304, 5: 299, 6: 299, 0: 285, 18: 275, 11: 250, 12: 246, 7: 238, 28: 228, 17: 224, 3: 221, 15: 219, 23: 215, 20: 206, 16: 201, 27: 189, 21: 189, 4: 178, 2: 176, 19: 171, 8: 164, 14: 158, 24: 153, 26: 150, 1: 149, 29: 141, 30: 119})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  143.19075244665146 Time :  8667
accuracy train: 0.685970 val: 0.635821 test: 0.632451
max validation accuracy : 0.644776 max acc epoch : 1 test accuracy : 0.600297
Counter({8: 436, 16: 331, 9: 325, 17: 315, 6: 310, 3: 307, 2: 287, 1: 286, 5: 277, 4: 270, 22: 268, 11: 258, 15: 241, 26: 238, 18: 232, 27: 231, 30: 229, 31: 220, 0: 217, 13: 211, 28: 210, 20: 190, 14: 183, 12: 168, 24: 166, 7: 162, 23: 158, 10: 153, 19: 144, 21: 136, 25: 134, 29: 107})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  120.86877304315567 Time :  8736
accuracy train: 0.740238 val: 0.665672 test: 0.657433
max validation accuracy : 0.665672 max acc epoch : 3 test accuracy : 0.657433
Counter({18: 350, 13: 347, 12: 335, 15: 330, 11: 308, 23: 287, 17: 286, 28: 278, 9: 275, 27: 273, 8: 269, 6: 267, 21: 262, 10: 258, 1: 257, 30: 252, 0: 236, 5: 219, 25: 208, 3: 205, 7: 198, 16: 196, 14: 184, 19: 172, 2: 170, 31: 170, 4: 157, 22: 155, 29: 145, 26: 139, 20: 127, 24: 85})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  95.5872551202774 Time :  8826
accuracy train: 0.796161 val: 0.704478 test: 0.690082
max validation accuracy : 0.704478 max acc epoch : 4 test accuracy : 0.690082
Counter({10: 366, 21: 363, 22: 336, 8: 328, 1: 326, 23: 300, 25: 295, 6: 273, 18: 270, 0: 267, 19: 267, 14: 267, 9: 261, 11: 259, 12: 247, 28: 245, 4: 245, 16: 242, 5: 226, 7: 222, 3: 198, 29: 186, 15: 185, 2: 184, 24: 169, 30: 161, 31: 139, 26: 136, 13: 127, 17: 117, 27: 109, 20: 84})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  89.30568170547485 Time :  8902
accuracy train: 0.811383 val: 0.722388 test: 0.692802
max validation accuracy : 0.722388 max acc epoch : 5 test accuracy : 0.692802
Counter({8: 432, 25: 414, 12: 336, 13: 316, 30: 310, 28: 300, 21: 299, 2: 291, 0: 277, 22: 262, 24: 262, 7: 262, 26: 262, 1: 250, 31: 243, 3: 237, 18: 229, 11: 217, 14: 212, 4: 210, 15: 190, 19: 183, 16: 181, 20: 173, 27: 160, 29: 149, 17: 138, 23: 134, 5: 130, 6: 128, 10: 112, 9: 101})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  82.52150768041611 Time :  9100
accuracy train: 0.826605 val: 0.707463 test: 0.691318
max validation accuracy : 0.722388 max acc epoch : 5 test accuracy : 0.692802
Counter({9: 413, 14: 406, 31: 387, 28: 381, 4: 316, 19: 314, 22: 307, 26: 289, 12: 281, 2: 263, 11: 263, 16: 260, 23: 250, 25: 247, 29: 243, 15: 222, 7: 216, 1: 205, 3: 199, 18: 186, 13: 181, 17: 174, 5: 171, 21: 169, 30: 163, 10: 147, 8: 140, 20: 136, 24: 135, 6: 125, 0: 113, 27: 98})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  70.68108794093132 Time :  9352
accuracy train: 0.836532 val: 0.707463 test: 0.704180
max validation accuracy : 0.722388 max acc epoch : 5 test accuracy : 0.692802
Counter({1: 436, 2: 415, 8: 407, 11: 402, 26: 339, 3: 321, 15: 308, 14: 291, 12: 289, 13: 265, 17: 262, 20: 247, 21: 242, 9: 234, 30: 225, 5: 218, 19: 209, 4: 200, 23: 180, 16: 179, 0: 176, 7: 172, 6: 167, 18: 164, 10: 155, 27: 153, 28: 141, 29: 136, 31: 134, 22: 123, 24: 112, 25: 98})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  67.93908147513866 Time :  9435
accuracy train: 0.852085 val: 0.737313 test: 0.703933
max validation accuracy : 0.737313 max acc epoch : 8 test accuracy : 0.703933
Counter({7: 432, 13: 388, 1: 382, 25: 316, 2: 306, 4: 306, 22: 305, 27: 289, 10: 288, 20: 266, 21: 263, 15: 261, 8: 247, 18: 229, 29: 225, 5: 222, 28: 218, 17: 216, 6: 215, 26: 201, 9: 196, 19: 195, 23: 185, 31: 166, 11: 158, 30: 155, 12: 141, 14: 141, 16: 134, 24: 134, 0: 122, 3: 98})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  66.87014000117779 Time :  9509
accuracy train: 0.856717 val: 0.728358 test: 0.708880
max validation accuracy : 0.737313 max acc epoch : 8 test accuracy : 0.703933
Counter({14: 399, 0: 328, 29: 319, 12: 318, 5: 313, 13: 296, 15: 295, 27: 292, 11: 292, 7: 290, 19: 270, 1: 269, 3: 266, 31: 260, 2: 259, 4: 238, 25: 234, 18: 228, 20: 226, 9: 219, 6: 207, 28: 204, 23: 193, 26: 193, 17: 188, 22: 160, 21: 134, 16: 133, 30: 120, 10: 108, 8: 98, 24: 51})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.226805686950684 Time :  9600
accuracy train: 0.876241 val: 0.728358 test: 0.711848
max validation accuracy : 0.737313 max acc epoch : 8 test accuracy : 0.703933
Counter({10: 400, 28: 344, 15: 324, 23: 316, 31: 300, 22: 295, 1: 290, 17: 290, 11: 286, 3: 272, 16: 270, 2: 260, 13: 251, 25: 241, 30: 240, 4: 237, 18: 232, 20: 231, 7: 216, 9: 207, 14: 204, 19: 204, 26: 202, 6: 193, 8: 182, 5: 176, 0: 152, 21: 135, 29: 126, 24: 113, 12: 111, 27: 100})

Epoch :  11 loss training:  58.21238251030445 Time :  9680
accuracy train: 0.880212 val: 0.734328 test: 0.712095
max validation accuracy : 0.737313 max acc epoch : 8 test accuracy : 0.703933
Counter({26: 403, 7: 375, 9: 354, 6: 316, 20: 309, 29: 309, 23: 294, 11: 288, 4: 280, 0: 276, 13: 271, 30: 267, 2: 265, 18: 263, 15: 255, 22: 249, 10: 230, 21: 216, 3: 211, 5: 205, 17: 204, 8: 198, 12: 184, 31: 181, 14: 178, 25: 162, 16: 134, 24: 122, 19: 118, 27: 107, 28: 100, 1: 76})

Epoch :  12 loss training:  53.75354167819023 Time :  9776
accuracy train: 0.893779 val: 0.716418 test: 0.716794
max validation accuracy : 0.737313 max acc epoch : 8 test accuracy : 0.703933
Counter({5: 539, 4: 407, 18: 350, 17: 327, 26: 302, 12: 297, 24: 294, 10: 294, 11: 270, 9: 269, 7: 269, 13: 258, 20: 239, 16: 233, 23: 220, 28: 216, 29: 215, 1: 215, 21: 205, 14: 205, 15: 204, 0: 188, 3: 182, 6: 169, 19: 161, 30: 156, 8: 134, 27: 129, 2: 122, 22: 120, 25: 109, 31: 102})

Epoch :  13 loss training:  52.47720976173878 Time :  9851
accuracy train: 0.897088 val: 0.734328 test: 0.714321
max validation accuracy : 0.737313 max acc epoch : 8 test accuracy : 0.703933
Counter({4: 548, 14: 415, 20: 341, 30: 309, 24: 302, 5: 294, 1: 288, 3: 285, 25: 277, 21: 271, 28: 269, 23: 251, 6: 230, 11: 229, 7: 225, 8: 218, 26: 217, 17: 215, 0: 214, 13: 212, 29: 209, 16: 205, 2: 178, 12: 173, 31: 159, 19: 154, 9: 133, 15: 132, 22: 128, 18: 121, 27: 101, 10: 97})

Epoch :  14 loss training:  49.56803943216801 Time :  9927
accuracy train: 0.901721 val: 0.722388 test: 0.716300
max validation accuracy : 0.737313 max acc epoch : 8 test accuracy : 0.703933
Counter({6: 402, 2: 344, 3: 338, 20: 329, 10: 329, 7: 306, 14: 300, 8: 294, 16: 278, 31: 271, 17: 266, 15: 259, 11: 251, 5: 251, 26: 247, 30: 243, 25: 242, 24: 232, 1: 220, 12: 218, 29: 212, 18: 208, 27: 189, 4: 183, 13: 153, 23: 136, 9: 132, 22: 129, 19: 121, 28: 108, 21: 106, 0: 103})

Epoch :  15 loss training:  46.362636148929596 Time :  9988
accuracy train: 0.909332 val: 0.725373 test: 0.715310
max validation accuracy : 0.737313 max acc epoch : 8 test accuracy : 0.703933
Counter({2: 530, 0: 346, 14: 320, 3: 311, 22: 298, 17: 296, 31: 291, 27: 274, 21: 264, 29: 250, 6: 239, 7: 235, 9: 226, 8: 224, 23: 224, 5: 221, 1: 219, 26: 218, 30: 216, 18: 214, 4: 209, 15: 204, 16: 203, 12: 198, 28: 185, 20: 168, 24: 166, 10: 152, 25: 133, 11: 128, 19: 121, 13: 117})

Epoch :  16 loss training:  42.44681101292372 Time :  10080
accuracy train: 0.925215 val: 0.722388 test: 0.716794
max validation accuracy : 0.737313 max acc epoch : 8 test accuracy : 0.703933
Counter({1: 513, 2: 354, 10: 351, 28: 302, 30: 298, 7: 292, 12: 288, 4: 276, 27: 275, 16: 272, 19: 261, 15: 251, 18: 242, 5: 239, 11: 227, 8: 226, 9: 220, 22: 220, 31: 210, 17: 205, 3: 202, 23: 192, 0: 192, 13: 186, 14: 184, 20: 180, 6: 141, 21: 131, 29: 129, 24: 124, 26: 120, 25: 97})

Epoch :  17 loss training:  40.70217214524746 Time :  10162
accuracy train: 0.928524 val: 0.743284 test: 0.716300
max validation accuracy : 0.743284 max acc epoch : 17 test accuracy : 0.716300
Counter({4: 510, 5: 335, 2: 309, 13: 304, 6: 288, 21: 287, 24: 287, 3: 283, 8: 274, 29: 273, 9: 267, 18: 260, 31: 252, 25: 249, 0: 248, 19: 246, 15: 244, 11: 220, 12: 208, 17: 207, 30: 205, 28: 198, 27: 187, 14: 183, 7: 178, 1: 167, 10: 132, 26: 131, 20: 127, 22: 124, 23: 117, 16: 100})

Epoch :  18 loss training:  40.90785089880228 Time :  10242
accuracy train: 0.938451 val: 0.746269 test: 0.716794
max validation accuracy : 0.746269 max acc epoch : 18 test accuracy : 0.716794
Counter({10: 344, 18: 330, 28: 314, 20: 295, 19: 295, 14: 287, 7: 285, 2: 281, 21: 279, 27: 279, 9: 272, 23: 272, 11: 267, 29: 266, 12: 253, 16: 243, 3: 240, 31: 237, 4: 224, 5: 218, 24: 214, 8: 206, 25: 205, 17: 184, 15: 178, 0: 172, 13: 152, 6: 132, 30: 131, 1: 127, 22: 118, 26: 100})

Epoch :  19 loss training:  35.978740483522415 Time :  10343
accuracy train: 0.949371 val: 0.749254 test: 0.724709
max validation accuracy : 0.749254 max acc epoch : 19 test accuracy : 0.724709
Counter({0: 474, 9: 361, 16: 315, 19: 303, 31: 299, 10: 290, 8: 289, 25: 284, 27: 279, 5: 270, 1: 269, 24: 259, 23: 238, 29: 230, 17: 228, 28: 224, 30: 221, 2: 211, 12: 208, 14: 204, 18: 201, 22: 200, 20: 178, 21: 178, 11: 174, 15: 174, 3: 174, 4: 161, 13: 132, 7: 132, 26: 127, 6: 113})

Epoch :  20 loss training:  34.157430998981 Time :  10670
accuracy train: 0.952680 val: 0.743284 test: 0.717784
max validation accuracy : 0.749254 max acc epoch : 19 test accuracy : 0.724709
Counter({30: 364, 22: 359, 9: 354, 4: 350, 18: 348, 2: 317, 15: 300, 25: 293, 13: 292, 3: 268, 8: 263, 24: 259, 7: 255, 28: 254, 12: 239, 27: 238, 1: 222, 5: 219, 31: 215, 11: 206, 23: 205, 6: 189, 19: 171, 29: 158, 20: 154, 10: 150, 21: 147, 14: 132, 26: 132, 0: 128, 17: 115, 16: 104})

Epoch :  21 loss training:  32.22657499462366 Time :  10801
accuracy train: 0.957644 val: 0.743284 test: 0.721989
max validation accuracy : 0.749254 max acc epoch : 19 test accuracy : 0.724709
Counter({1: 476, 20: 468, 0: 348, 29: 316, 22: 315, 6: 301, 2: 293, 15: 291, 23: 289, 3: 259, 14: 245, 10: 242, 28: 228, 4: 223, 17: 220, 13: 213, 24: 212, 9: 207, 5: 204, 12: 194, 7: 187, 26: 185, 30: 179, 25: 175, 31: 168, 8: 167, 27: 163, 21: 142, 16: 131, 18: 129, 11: 120, 19: 110})

Epoch :  22 loss training:  31.169644482433796 Time :  10961
accuracy train: 0.964593 val: 0.722388 test: 0.721989
max validation accuracy : 0.749254 max acc epoch : 19 test accuracy : 0.724709
Counter({29: 458, 11: 313, 17: 308, 21: 307, 10: 302, 18: 300, 15: 292, 5: 291, 3: 274, 22: 266, 14: 265, 31: 261, 16: 258, 0: 252, 27: 251, 30: 247, 24: 242, 1: 226, 4: 225, 6: 211, 8: 206, 7: 191, 19: 190, 9: 180, 12: 176, 25: 162, 23: 159, 2: 132, 28: 128, 20: 117, 13: 111, 26: 99})

Epoch :  23 loss training:  28.194726552814245 Time :  11069
accuracy train: 0.966909 val: 0.746269 test: 0.718773
max validation accuracy : 0.749254 max acc epoch : 19 test accuracy : 0.724709
Counter({7: 366, 27: 365, 5: 359, 1: 351, 13: 347, 3: 319, 12: 300, 9: 287, 18: 286, 0: 285, 15: 279, 22: 256, 19: 248, 23: 241, 24: 239, 30: 227, 14: 223, 4: 216, 25: 196, 29: 196, 31: 195, 16: 188, 26: 183, 11: 182, 10: 179, 17: 162, 2: 146, 28: 133, 6: 127, 21: 117, 8: 101, 20: 101})

Epoch :  24 loss training:  25.799756981432438 Time :  11169
accuracy train: 0.966578 val: 0.725373 test: 0.720999
max validation accuracy : 0.749254 max acc epoch : 19 test accuracy : 0.724709
Counter({18: 503, 1: 412, 17: 361, 4: 358, 5: 308, 8: 301, 23: 296, 12: 285, 30: 271, 7: 266, 19: 255, 6: 254, 26: 253, 25: 250, 16: 246, 20: 218, 0: 215, 3: 209, 24: 193, 2: 188, 27: 187, 29: 185, 22: 179, 14: 179, 13: 163, 15: 145, 10: 138, 31: 135, 21: 125, 9: 119, 11: 102, 28: 101})

Epoch :  25 loss training:  24.12993512302637 Time :  11259
accuracy train: 0.971211 val: 0.737313 test: 0.722483
max validation accuracy : 0.749254 max acc epoch : 19 test accuracy : 0.724709
Counter({2: 467, 7: 464, 31: 339, 15: 318, 16: 305, 10: 298, 26: 284, 23: 276, 3: 270, 4: 267, 8: 264, 20: 262, 18: 254, 6: 253, 17: 224, 12: 222, 9: 219, 11: 219, 25: 217, 28: 194, 14: 192, 1: 189, 5: 182, 24: 178, 27: 161, 0: 150, 19: 144, 21: 136, 22: 126, 29: 121, 30: 104, 13: 101})

Epoch :  26 loss training:  22.79302753135562 Time :  11346
accuracy train: 0.972204 val: 0.746269 test: 0.725699
max validation accuracy : 0.749254 max acc epoch : 19 test accuracy : 0.724709
Counter({14: 458, 20: 380, 11: 371, 30: 336, 19: 318, 10: 302, 15: 299, 28: 299, 5: 296, 29: 288, 6: 259, 23: 257, 1: 256, 2: 254, 12: 252, 22: 221, 24: 220, 4: 219, 13: 207, 7: 183, 17: 179, 3: 178, 25: 176, 0: 174, 26: 167, 16: 156, 9: 136, 31: 132, 8: 122, 18: 109, 27: 101, 21: 95})

Epoch :  27 loss training:  21.192137021571398 Time :  11460
accuracy train: 0.978822 val: 0.752239 test: 0.723225
max validation accuracy : 0.752239 max acc epoch : 27 test accuracy : 0.723225
Counter({9: 440, 15: 379, 8: 377, 13: 339, 6: 321, 4: 304, 18: 300, 12: 265, 30: 258, 24: 258, 14: 256, 23: 256, 28: 254, 20: 251, 3: 246, 2: 240, 27: 229, 10: 222, 22: 217, 26: 207, 31: 193, 17: 179, 11: 175, 1: 172, 16: 167, 5: 158, 0: 152, 29: 135, 19: 120, 7: 119, 25: 109, 21: 102})

Epoch :  28 loss training:  19.908684317022562 Time :  11552
accuracy train: 0.981800 val: 0.761194 test: 0.721741
max validation accuracy : 0.761194 max acc epoch : 28 test accuracy : 0.721741
Counter({11: 527, 3: 511, 4: 402, 26: 305, 12: 297, 5: 295, 7: 289, 25: 268, 14: 262, 9: 259, 1: 258, 29: 257, 6: 250, 16: 231, 10: 219, 18: 219, 17: 216, 30: 212, 27: 196, 0: 185, 24: 185, 8: 174, 15: 174, 2: 172, 20: 171, 21: 158, 31: 134, 19: 133, 23: 125, 13: 122, 28: 102, 22: 92})

Epoch :  29 loss training:  17.768538035452366 Time :  11639
accuracy train: 0.983786 val: 0.752239 test: 0.723720
max validation accuracy : 0.761194 max acc epoch : 28 test accuracy : 0.721741
Counter({5: 517, 23: 488, 11: 365, 18: 356, 27: 346, 15: 304, 30: 288, 20: 282, 7: 274, 13: 269, 28: 261, 17: 254, 8: 254, 31: 250, 26: 245, 4: 216, 12: 205, 6: 194, 0: 185, 10: 173, 22: 173, 14: 172, 24: 171, 29: 160, 1: 158, 25: 134, 9: 132, 21: 130, 3: 123, 19: 122, 2: 102, 16: 97})

Epoch :  30 loss training:  16.808688331395388 Time :  11724
accuracy train: 0.985771 val: 0.740299 test: 0.725699
max validation accuracy : 0.761194 max acc epoch : 28 test accuracy : 0.721741
Counter({6: 469, 0: 380, 27: 377, 22: 355, 17: 341, 5: 319, 3: 318, 11: 289, 15: 271, 10: 269, 14: 269, 9: 262, 18: 257, 4: 256, 23: 252, 31: 233, 25: 226, 30: 220, 13: 205, 24: 203, 19: 186, 26: 182, 28: 169, 7: 165, 16: 164, 29: 135, 8: 129, 20: 124, 1: 123, 12: 102, 21: 96, 2: 54})

Epoch :  31 loss training:  16.959821859374642 Time :  11827
accuracy train: 0.984447 val: 0.728358 test: 0.726935
max validation accuracy : 0.761194 max acc epoch : 28 test accuracy : 0.721741
Counter({1: 480, 6: 479, 21: 369, 28: 355, 24: 349, 10: 313, 11: 310, 29: 287, 17: 280, 14: 268, 2: 255, 4: 253, 18: 252, 8: 241, 9: 217, 12: 216, 19: 210, 23: 209, 27: 190, 0: 170, 3: 169, 5: 168, 26: 166, 20: 163, 25: 161, 7: 152, 22: 138, 30: 128, 16: 125, 13: 124, 31: 102, 15: 101})

Epoch :  32 loss training:  14.842168111354113 Time :  11964
accuracy train: 0.989080 val: 0.731343 test: 0.722978
max validation accuracy : 0.761194 max acc epoch : 28 test accuracy : 0.721741
Counter({26: 473, 7: 369, 23: 350, 30: 346, 14: 312, 8: 307, 20: 299, 21: 291, 22: 290, 24: 270, 17: 270, 16: 253, 10: 252, 18: 239, 3: 227, 1: 225, 11: 224, 0: 215, 5: 212, 4: 200, 29: 195, 13: 191, 31: 175, 15: 171, 28: 163, 27: 157, 12: 138, 2: 130, 6: 126, 19: 124, 9: 107, 25: 99})

Epoch :  33 loss training:  13.196727091446519 Time :  12289
accuracy train: 0.991396 val: 0.734328 test: 0.726935
max validation accuracy : 0.761194 max acc epoch : 28 test accuracy : 0.721741
Counter({25: 478, 2: 378, 7: 306, 14: 306, 1: 290, 26: 288, 17: 287, 5: 272, 21: 271, 9: 251, 30: 250, 12: 248, 6: 242, 0: 231, 13: 228, 8: 220, 3: 219, 10: 214, 28: 205, 11: 203, 18: 199, 16: 199, 23: 193, 29: 191, 31: 181, 15: 173, 24: 170, 27: 163, 22: 151, 4: 138, 20: 130, 19: 125})

Epoch :  34 loss training:  13.04855122603476 Time :  12362
accuracy train: 0.993713 val: 0.743284 test: 0.723720
max validation accuracy : 0.761194 max acc epoch : 28 test accuracy : 0.721741
Counter({21: 465, 0: 395, 12: 306, 13: 296, 1: 288, 2: 288, 18: 271, 28: 265, 8: 265, 16: 264, 23: 245, 7: 245, 20: 244, 25: 243, 17: 237, 3: 224, 6: 222, 9: 221, 30: 213, 5: 202, 27: 202, 24: 198, 26: 194, 31: 189, 22: 180, 14: 168, 4: 168, 15: 162, 11: 149, 10: 137, 29: 130, 19: 124})

Epoch :  35 loss training:  12.440950552001595 Time :  12450
accuracy train: 0.996029 val: 0.743284 test: 0.724709
max validation accuracy : 0.761194 max acc epoch : 28 test accuracy : 0.721741
Counter({0: 387, 8: 361, 31: 350, 16: 329, 29: 318, 14: 308, 23: 289, 17: 288, 20: 270, 1: 270, 26: 269, 5: 268, 11: 264, 7: 251, 18: 238, 28: 223, 27: 213, 13: 210, 3: 210, 10: 202, 15: 198, 2: 184, 9: 178, 25: 178, 6: 176, 24: 167, 4: 156, 30: 156, 19: 139, 22: 129, 12: 121, 21: 100})

Epoch :  36 loss training:  10.73879775032401 Time :  12514
accuracy train: 0.994705 val: 0.746269 test: 0.725204
max validation accuracy : 0.761194 max acc epoch : 28 test accuracy : 0.721741
Counter({5: 384, 11: 356, 6: 346, 2: 343, 17: 326, 16: 311, 23: 303, 25: 297, 27: 291, 28: 268, 18: 266, 10: 252, 19: 251, 8: 240, 3: 236, 0: 226, 20: 223, 30: 214, 1: 214, 4: 209, 9: 200, 12: 198, 14: 188, 29: 173, 22: 168, 31: 161, 7: 157, 21: 138, 26: 129, 13: 121, 24: 111, 15: 100})

Epoch :  37 loss training:  10.376853086054325 Time :  12570
accuracy train: 0.993382 val: 0.740299 test: 0.726441
max validation accuracy : 0.761194 max acc epoch : 28 test accuracy : 0.721741
Counter({9: 415, 10: 371, 30: 340, 14: 338, 7: 320, 6: 302, 28: 293, 15: 274, 2: 265, 24: 262, 4: 261, 12: 255, 18: 240, 8: 237, 19: 227, 1: 220, 23: 219, 27: 214, 11: 212, 29: 210, 13: 209, 5: 187, 3: 180, 26: 178, 22: 176, 16: 167, 17: 163, 20: 156, 31: 139, 25: 130, 0: 128, 21: 112})

Epoch :  38 loss training:  9.255408869124949 Time :  12647
accuracy train: 0.995036 val: 0.752239 test: 0.728914
max validation accuracy : 0.761194 max acc epoch : 28 test accuracy : 0.721741
Counter({0: 529, 17: 457, 1: 418, 7: 365, 23: 325, 2: 307, 22: 301, 10: 299, 4: 291, 5: 279, 8: 276, 15: 256, 20: 242, 14: 240, 18: 213, 9: 209, 24: 204, 11: 204, 12: 192, 31: 177, 27: 170, 19: 166, 13: 162, 28: 151, 16: 147, 25: 140, 29: 130, 3: 124, 30: 124, 6: 104, 26: 100, 21: 98})

Epoch :  39 loss training:  8.865147283766419 Time :  12715
accuracy train: 0.997022 val: 0.752239 test: 0.727430
max validation accuracy : 0.761194 max acc epoch : 28 test accuracy : 0.721741
Counter({29: 477, 26: 436, 9: 377, 1: 365, 6: 358, 22: 318, 2: 308, 13: 303, 12: 287, 7: 267, 23: 255, 24: 240, 5: 236, 14: 235, 10: 226, 15: 221, 30: 210, 19: 204, 0: 198, 16: 191, 11: 189, 3: 184, 21: 169, 27: 167, 17: 162, 18: 140, 8: 130, 20: 125, 31: 125, 25: 111, 4: 102, 28: 84})

Epoch :  40 loss training:  8.747595365159214 Time :  12806
accuracy train: 0.997353 val: 0.749254 test: 0.727925
max validation accuracy : 0.761194 max acc epoch : 28 test accuracy : 0.721741
Counter({11: 476, 20: 362, 29: 335, 6: 330, 7: 321, 17: 319, 8: 304, 0: 302, 14: 287, 3: 287, 25: 256, 31: 255, 2: 237, 21: 236, 26: 227, 5: 221, 23: 221, 1: 199, 13: 197, 4: 195, 18: 187, 30: 185, 27: 171, 10: 171, 22: 166, 12: 165, 28: 165, 19: 139, 16: 131, 24: 129, 15: 115, 9: 109})

Epoch :  41 loss training:  7.704140299931169 Time :  12869
accuracy train: 0.998345 val: 0.752239 test: 0.723225
max validation accuracy : 0.761194 max acc epoch : 28 test accuracy : 0.721741
Counter({17: 469, 12: 335, 9: 332, 3: 330, 16: 321, 19: 320, 10: 305, 5: 305, 2: 299, 6: 265, 14: 256, 30: 255, 7: 253, 21: 239, 22: 226, 13: 223, 8: 221, 25: 209, 4: 201, 26: 192, 27: 187, 0: 177, 23: 176, 20: 172, 1: 165, 11: 161, 29: 155, 18: 140, 15: 139, 31: 131, 24: 127, 28: 114})

Epoch :  42 loss training:  8.671719265170395 Time :  12965
accuracy train: 0.998015 val: 0.740299 test: 0.730151
max validation accuracy : 0.761194 max acc epoch : 28 test accuracy : 0.721741
Counter({5: 471, 29: 350, 22: 340, 14: 335, 26: 328, 16: 322, 23: 319, 20: 303, 15: 285, 13: 256, 1: 252, 8: 251, 28: 246, 3: 237, 24: 236, 9: 228, 12: 223, 21: 219, 6: 214, 18: 197, 2: 189, 27: 187, 0: 179, 17: 175, 7: 162, 30: 157, 19: 157, 11: 139, 4: 126, 10: 116, 25: 110, 31: 91})

Epoch :  43 loss training:  6.860374114476144 Time :  13062
accuracy train: 0.997684 val: 0.743284 test: 0.722978
max validation accuracy : 0.761194 max acc epoch : 28 test accuracy : 0.721741
Counter({22: 459, 5: 362, 7: 343, 28: 332, 13: 328, 26: 328, 29: 314, 0: 302, 6: 301, 2: 261, 12: 252, 25: 251, 27: 245, 19: 240, 8: 238, 20: 229, 18: 225, 3: 224, 16: 218, 15: 198, 24: 195, 10: 189, 11: 184, 17: 169, 31: 163, 1: 154, 9: 140, 21: 129, 30: 121, 14: 113, 23: 98, 4: 95})

Epoch :  44 loss training:  6.7983497539535165 Time :  13161
accuracy train: 0.998345 val: 0.764179 test: 0.717042
max validation accuracy : 0.764179 max acc epoch : 44 test accuracy : 0.717042
Counter({0: 508, 7: 408, 12: 362, 11: 359, 2: 349, 17: 345, 16: 323, 3: 319, 1: 286, 10: 270, 6: 249, 8: 243, 5: 228, 18: 225, 9: 219, 24: 218, 26: 213, 23: 198, 19: 195, 27: 193, 25: 178, 29: 171, 30: 164, 22: 162, 13: 153, 15: 140, 21: 137, 31: 130, 14: 127, 28: 124, 20: 109, 4: 95})

Epoch :  45 loss training:  6.5089313252829015 Time :  13252
accuracy train: 0.998345 val: 0.746269 test: 0.721247
max validation accuracy : 0.764179 max acc epoch : 44 test accuracy : 0.717042
Counter({5: 532, 6: 463, 16: 463, 3: 394, 13: 365, 30: 343, 2: 328, 9: 321, 17: 286, 19: 274, 22: 235, 28: 225, 25: 219, 24: 214, 12: 208, 18: 203, 26: 194, 20: 194, 21: 188, 31: 187, 29: 184, 11: 154, 23: 152, 8: 147, 15: 141, 1: 139, 7: 132, 14: 124, 27: 122, 10: 110, 4: 99, 0: 60})

Epoch :  46 loss training:  5.6758300182409585 Time :  13324
accuracy train: 0.997684 val: 0.755224 test: 0.721989
max validation accuracy : 0.764179 max acc epoch : 44 test accuracy : 0.717042
Counter({21: 461, 25: 376, 1: 360, 26: 339, 12: 334, 15: 322, 22: 322, 17: 321, 30: 302, 23: 283, 7: 249, 9: 248, 29: 235, 11: 222, 31: 222, 6: 215, 19: 211, 10: 205, 14: 205, 18: 195, 13: 194, 4: 190, 27: 163, 2: 163, 5: 159, 8: 154, 16: 153, 0: 139, 20: 136, 3: 131, 28: 126, 24: 65})

Epoch :  47 loss training:  4.925409630406648 Time :  13378
accuracy train: 0.998015 val: 0.761194 test: 0.721741
max validation accuracy : 0.764179 max acc epoch : 44 test accuracy : 0.717042
Counter({13: 368, 14: 355, 27: 350, 15: 348, 22: 338, 23: 331, 1: 322, 30: 321, 12: 303, 28: 301, 26: 281, 20: 252, 4: 241, 5: 240, 2: 234, 9: 217, 29: 216, 18: 212, 31: 205, 25: 196, 19: 193, 11: 168, 0: 167, 8: 159, 24: 150, 17: 148, 6: 141, 7: 137, 16: 130, 10: 129, 3: 128, 21: 119})

Epoch :  48 loss training:  5.210572287905961 Time :  13450
accuracy train: 0.998345 val: 0.761194 test: 0.719268
max validation accuracy : 0.764179 max acc epoch : 44 test accuracy : 0.717042
Counter({3: 432, 6: 369, 12: 367, 19: 355, 27: 355, 26: 340, 0: 337, 21: 332, 23: 320, 9: 309, 8: 282, 15: 253, 17: 236, 11: 228, 5: 214, 13: 207, 4: 206, 25: 206, 16: 195, 1: 185, 30: 171, 28: 160, 29: 158, 22: 155, 24: 153, 18: 148, 31: 137, 14: 135, 2: 130, 20: 129, 10: 115, 7: 81})

Epoch :  49 loss training:  5.397923958022147 Time :  13528
accuracy train: 0.999338 val: 0.767164 test: 0.719763
max validation accuracy : 0.767164 max acc epoch : 49 test accuracy : 0.719763
Counter({17: 437, 6: 368, 21: 365, 31: 340, 7: 331, 1: 323, 0: 311, 9: 311, 28: 306, 27: 282, 23: 272, 11: 265, 15: 254, 12: 251, 30: 236, 19: 227, 24: 227, 20: 226, 13: 211, 16: 208, 3: 199, 4: 188, 10: 162, 8: 161, 22: 150, 14: 135, 25: 125, 26: 120, 2: 114, 18: 109, 29: 96, 5: 90})

Epoch :  50 loss training:  4.36812197836116 Time :  13593
accuracy train: 0.999007 val: 0.749254 test: 0.720505
max validation accuracy : 0.767164 max acc epoch : 49 test accuracy : 0.719763
Counter({15: 362, 11: 352, 4: 350, 13: 340, 19: 326, 28: 323, 8: 317, 1: 313, 18: 312, 0: 280, 16: 273, 23: 259, 7: 248, 10: 237, 14: 225, 31: 223, 2: 215, 30: 211, 9: 210, 3: 207, 24: 186, 20: 181, 5: 177, 27: 175, 25: 165, 26: 157, 17: 153, 22: 149, 29: 134, 6: 127, 21: 111, 12: 102})

Epoch :  51 loss training:  4.5874473843723536 Time :  13680
accuracy train: 0.997684 val: 0.758209 test: 0.723967
max validation accuracy : 0.767164 max acc epoch : 49 test accuracy : 0.719763
Counter({6: 365, 23: 356, 22: 354, 19: 349, 25: 336, 16: 329, 8: 326, 12: 304, 5: 288, 18: 281, 4: 281, 10: 262, 7: 253, 29: 252, 9: 248, 31: 238, 1: 237, 2: 225, 17: 214, 20: 212, 13: 209, 3: 167, 30: 159, 0: 157, 15: 156, 28: 146, 26: 134, 24: 131, 14: 128, 21: 127, 27: 109, 11: 67})

Epoch :  52 loss training:  4.179867155617103 Time :  13731
accuracy train: 0.998676 val: 0.767164 test: 0.724462
max validation accuracy : 0.767164 max acc epoch : 49 test accuracy : 0.719763
Counter({7: 372, 13: 354, 29: 346, 4: 343, 15: 338, 3: 322, 9: 319, 10: 306, 0: 295, 25: 283, 5: 262, 8: 256, 21: 245, 1: 238, 12: 235, 31: 233, 14: 215, 18: 213, 28: 208, 30: 204, 24: 190, 11: 182, 23: 179, 26: 169, 6: 164, 19: 156, 22: 155, 2: 147, 20: 133, 17: 129, 27: 116, 16: 93})

Epoch :  53 loss training:  4.219524106243625 Time :  13821
accuracy train: 0.999669 val: 0.752239 test: 0.723720
max validation accuracy : 0.767164 max acc epoch : 49 test accuracy : 0.719763
Counter({19: 516, 2: 482, 3: 425, 7: 349, 10: 329, 29: 328, 15: 326, 17: 300, 6: 285, 5: 275, 21: 252, 14: 232, 28: 227, 27: 227, 9: 224, 13: 207, 30: 206, 8: 197, 23: 189, 1: 186, 24: 174, 4: 173, 16: 157, 18: 153, 0: 149, 31: 147, 20: 133, 25: 125, 22: 117, 12: 114, 26: 104, 11: 92})

Epoch :  54 loss training:  4.372692135628313 Time :  13998
accuracy train: 0.999669 val: 0.752239 test: 0.721989
max validation accuracy : 0.767164 max acc epoch : 49 test accuracy : 0.719763
Counter({24: 379, 5: 352, 10: 351, 6: 348, 3: 347, 2: 328, 20: 326, 11: 326, 12: 314, 9: 285, 28: 266, 18: 261, 26: 256, 30: 244, 19: 242, 4: 239, 16: 227, 21: 212, 17: 209, 23: 206, 0: 193, 29: 185, 25: 168, 31: 168, 1: 159, 27: 150, 13: 132, 8: 126, 22: 120, 14: 101, 7: 90, 15: 90})

Epoch :  55 loss training:  4.2762011415325105 Time :  14188
accuracy train: 0.999669 val: 0.755224 test: 0.724215
max validation accuracy : 0.767164 max acc epoch : 49 test accuracy : 0.719763
Counter({7: 376, 31: 362, 29: 360, 18: 354, 14: 348, 6: 346, 30: 327, 25: 322, 26: 315, 8: 306, 4: 264, 13: 259, 16: 259, 28: 248, 17: 245, 2: 240, 22: 227, 21: 215, 3: 214, 5: 210, 12: 193, 0: 162, 1: 154, 19: 150, 15: 138, 11: 133, 10: 132, 20: 124, 23: 123, 27: 116, 9: 91, 24: 87})

Epoch :  56 loss training:  3.430541447829455 Time :  14335
accuracy train: 0.999669 val: 0.755224 test: 0.723225
max validation accuracy : 0.767164 max acc epoch : 49 test accuracy : 0.719763
Counter({16: 520, 5: 471, 12: 362, 3: 355, 2: 332, 7: 326, 29: 302, 10: 262, 15: 246, 4: 245, 18: 244, 26: 239, 22: 232, 8: 230, 24: 227, 23: 224, 13: 223, 27: 210, 30: 204, 14: 197, 28: 181, 11: 178, 19: 174, 6: 154, 31: 153, 1: 150, 25: 147, 9: 141, 0: 132, 20: 123, 17: 119, 21: 97})

Epoch :  57 loss training:  3.7563017674256116 Time :  14429
accuracy train: 0.999669 val: 0.752239 test: 0.724957
max validation accuracy : 0.767164 max acc epoch : 49 test accuracy : 0.719763
Counter({24: 510, 17: 474, 7: 370, 28: 355, 6: 330, 10: 329, 21: 329, 8: 300, 11: 277, 2: 263, 26: 244, 19: 237, 9: 230, 27: 227, 25: 221, 23: 215, 31: 204, 0: 201, 13: 188, 30: 185, 15: 179, 3: 172, 22: 151, 20: 151, 16: 150, 14: 150, 29: 145, 12: 138, 1: 134, 5: 123, 18: 117, 4: 101})

Epoch :  58 loss training:  3.0361683340743184 Time :  14562
accuracy train: 0.999338 val: 0.767164 test: 0.725204
max validation accuracy : 0.767164 max acc epoch : 49 test accuracy : 0.719763
Counter({26: 511, 18: 475, 15: 433, 21: 368, 0: 328, 28: 328, 8: 302, 9: 287, 13: 271, 11: 269, 24: 251, 7: 244, 30: 235, 3: 234, 10: 222, 27: 208, 25: 200, 6: 195, 5: 188, 19: 186, 23: 186, 17: 172, 1: 154, 29: 153, 2: 149, 12: 147, 22: 144, 31: 132, 20: 125, 4: 117, 14: 98, 16: 88})

Epoch :  59 loss training:  3.7160472655668855 Time :  14729
accuracy train: 0.999669 val: 0.752239 test: 0.725451
max validation accuracy : 0.767164 max acc epoch : 49 test accuracy : 0.719763
Counter({4: 504, 27: 467, 3: 427, 24: 382, 31: 369, 11: 327, 17: 322, 16: 282, 22: 274, 18: 269, 25: 250, 1: 249, 26: 236, 13: 232, 6: 226, 29: 213, 20: 200, 2: 193, 0: 190, 23: 189, 10: 185, 12: 161, 15: 159, 28: 155, 14: 146, 30: 144, 5: 130, 8: 124, 7: 119, 21: 98, 9: 97, 19: 81})

Epoch :  60 loss training:  3.535219057230279 Time :  14876
accuracy train: 0.999669 val: 0.770149 test: 0.726441
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({2: 508, 3: 454, 7: 424, 10: 357, 0: 341, 26: 314, 23: 302, 25: 284, 24: 269, 31: 254, 14: 250, 13: 249, 8: 246, 16: 236, 27: 221, 21: 216, 1: 204, 28: 200, 9: 197, 12: 193, 20: 186, 17: 182, 6: 167, 5: 147, 11: 146, 18: 144, 22: 140, 29: 130, 4: 125, 19: 119, 30: 101, 15: 94})

Epoch :  61 loss training:  2.899307082290761 Time :  14982
accuracy train: 1.000000 val: 0.761194 test: 0.721989
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({5: 505, 20: 455, 1: 419, 3: 361, 11: 339, 17: 338, 8: 327, 27: 278, 14: 273, 13: 256, 21: 246, 16: 246, 29: 244, 18: 236, 24: 225, 30: 213, 31: 203, 28: 200, 23: 200, 4: 199, 25: 193, 9: 188, 2: 180, 6: 145, 0: 142, 12: 140, 7: 138, 22: 131, 26: 124, 10: 119, 15: 86, 19: 51})

Epoch :  62 loss training:  2.5973226162604988 Time :  15121
accuracy train: 1.000000 val: 0.758209 test: 0.719268
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({10: 529, 3: 434, 24: 413, 27: 344, 12: 337, 17: 328, 26: 282, 1: 276, 29: 274, 13: 255, 9: 253, 19: 247, 15: 246, 11: 235, 30: 225, 28: 211, 16: 206, 18: 200, 31: 197, 25: 191, 23: 191, 7: 189, 0: 177, 6: 146, 5: 142, 8: 140, 22: 139, 14: 132, 21: 132, 2: 123, 4: 119, 20: 87})

Epoch :  63 loss training:  2.447121352190152 Time :  15251
accuracy train: 0.999338 val: 0.764179 test: 0.721741
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({18: 496, 23: 472, 0: 370, 5: 330, 24: 329, 7: 323, 4: 313, 22: 290, 11: 273, 14: 270, 8: 260, 15: 251, 21: 245, 2: 244, 26: 236, 13: 211, 6: 203, 17: 199, 12: 197, 30: 195, 20: 185, 31: 184, 29: 180, 3: 158, 10: 149, 1: 141, 19: 140, 16: 132, 28: 124, 25: 119, 9: 101, 27: 80})

Epoch :  64 loss training:  2.4672527192160487 Time :  15375
accuracy train: 0.999669 val: 0.761194 test: 0.724709
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({27: 514, 1: 462, 6: 367, 26: 335, 8: 328, 31: 321, 23: 309, 10: 294, 30: 284, 5: 273, 22: 269, 3: 269, 17: 251, 9: 248, 16: 243, 7: 236, 13: 236, 20: 234, 29: 197, 0: 173, 24: 165, 2: 163, 19: 161, 15: 158, 28: 144, 11: 140, 18: 132, 25: 130, 14: 119, 12: 95, 21: 80, 4: 70})

Epoch :  65 loss training:  2.106755921151489 Time :  15483
accuracy train: 1.000000 val: 0.764179 test: 0.721247
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({25: 498, 0: 493, 22: 483, 4: 382, 11: 381, 28: 368, 27: 324, 8: 307, 17: 271, 16: 268, 10: 251, 18: 244, 9: 242, 20: 237, 26: 233, 13: 203, 21: 201, 1: 194, 19: 188, 3: 172, 14: 172, 6: 167, 5: 166, 23: 138, 15: 131, 12: 127, 31: 118, 29: 118, 24: 88, 7: 83, 2: 80, 30: 72})

Epoch :  66 loss training:  2.138299164013006 Time :  15606
accuracy train: 1.000000 val: 0.752239 test: 0.721494
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({1: 532, 30: 462, 10: 420, 2: 375, 4: 371, 0: 331, 6: 316, 29: 282, 5: 267, 22: 265, 17: 253, 15: 245, 24: 242, 20: 232, 9: 223, 23: 223, 28: 211, 16: 203, 19: 199, 25: 190, 7: 189, 14: 173, 21: 173, 12: 172, 18: 141, 11: 131, 13: 127, 3: 118, 26: 93, 8: 88, 31: 80, 27: 73})

Epoch :  67 loss training:  2.246059005963616 Time :  15766
accuracy train: 1.000000 val: 0.761194 test: 0.724462
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({2: 535, 16: 457, 9: 401, 15: 338, 12: 328, 17: 322, 31: 312, 22: 308, 6: 266, 3: 254, 20: 254, 7: 246, 14: 242, 30: 221, 24: 215, 11: 208, 27: 203, 18: 197, 4: 195, 10: 173, 23: 172, 19: 167, 26: 166, 28: 163, 21: 161, 13: 156, 25: 140, 5: 137, 8: 131, 1: 130, 29: 116, 0: 86})

Epoch :  68 loss training:  2.1880035385256633 Time :  15900
accuracy train: 0.999338 val: 0.758209 test: 0.722731
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({1: 494, 24: 401, 2: 381, 25: 379, 14: 344, 27: 328, 3: 320, 9: 302, 12: 272, 17: 267, 16: 255, 6: 246, 19: 242, 21: 241, 10: 235, 5: 214, 29: 209, 0: 204, 15: 197, 13: 190, 31: 173, 4: 173, 26: 171, 7: 159, 20: 152, 23: 138, 18: 138, 30: 131, 22: 129, 28: 127, 11: 115, 8: 73})

Epoch :  69 loss training:  1.5499349707970396 Time :  16036
accuracy train: 0.999669 val: 0.752239 test: 0.722978
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({21: 508, 14: 497, 25: 480, 3: 388, 27: 329, 6: 313, 11: 294, 23: 269, 9: 257, 19: 248, 15: 246, 0: 245, 17: 223, 2: 221, 20: 211, 5: 208, 7: 202, 1: 201, 28: 198, 30: 195, 8: 181, 12: 174, 10: 170, 13: 169, 22: 149, 4: 149, 16: 137, 31: 131, 24: 129, 18: 115, 26: 83, 29: 80})

Epoch :  70 loss training:  1.7722404395462945 Time :  16144
accuracy train: 0.999338 val: 0.752239 test: 0.725204
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({5: 525, 4: 460, 12: 441, 7: 373, 15: 325, 21: 324, 6: 315, 1: 287, 17: 268, 18: 257, 16: 249, 23: 246, 3: 243, 24: 235, 25: 233, 29: 226, 13: 222, 22: 210, 14: 198, 26: 197, 31: 187, 0: 178, 2: 148, 11: 141, 30: 137, 19: 131, 20: 129, 27: 126, 9: 119, 28: 116, 10: 81, 8: 73})

Epoch :  71 loss training:  2.263806486618705 Time :  16289
accuracy train: 0.999669 val: 0.761194 test: 0.726935
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({22: 525, 1: 460, 16: 342, 31: 327, 15: 325, 2: 322, 19: 313, 3: 307, 14: 297, 27: 274, 28: 257, 30: 248, 4: 245, 8: 236, 0: 226, 29: 216, 21: 210, 17: 199, 10: 198, 20: 197, 9: 191, 7: 176, 18: 169, 5: 158, 23: 145, 26: 140, 25: 136, 13: 131, 12: 127, 24: 116, 11: 110, 6: 77})

Epoch :  72 loss training:  2.2046081021544524 Time :  16499
accuracy train: 0.999669 val: 0.749254 test: 0.721741
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({26: 398, 24: 396, 13: 372, 23: 348, 25: 342, 27: 330, 17: 327, 14: 307, 31: 293, 8: 274, 30: 258, 4: 256, 10: 249, 12: 246, 22: 245, 20: 230, 19: 225, 18: 225, 1: 207, 5: 207, 15: 198, 29: 189, 6: 168, 21: 155, 7: 151, 2: 138, 11: 135, 28: 130, 9: 129, 16: 115, 0: 82, 3: 75})

Epoch :  73 loss training:  1.4739527371129952 Time :  16640
accuracy train: 0.999669 val: 0.752239 test: 0.725204
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({21: 530, 1: 475, 5: 373, 2: 343, 6: 339, 19: 335, 16: 319, 27: 294, 31: 266, 4: 258, 18: 257, 14: 251, 23: 248, 15: 246, 22: 242, 7: 233, 8: 232, 26: 221, 24: 217, 30: 211, 17: 196, 10: 191, 25: 153, 20: 138, 12: 130, 29: 128, 11: 117, 9: 114, 3: 97, 28: 95, 0: 76, 13: 75})

Epoch :  74 loss training:  1.392894055636134 Time :  16803
accuracy train: 0.999669 val: 0.755224 test: 0.722978
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({5: 532, 13: 531, 7: 514, 4: 486, 2: 379, 8: 338, 20: 294, 21: 291, 11: 257, 22: 250, 15: 245, 23: 243, 19: 241, 30: 226, 9: 216, 16: 205, 14: 196, 25: 192, 3: 186, 0: 183, 26: 158, 31: 143, 27: 138, 1: 135, 18: 130, 28: 128, 24: 117, 12: 115, 10: 94, 17: 87, 6: 76, 29: 74})

Epoch :  75 loss training:  1.7808160404674709 Time :  17058
accuracy train: 0.999338 val: 0.752239 test: 0.721247
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({23: 441, 6: 405, 30: 393, 28: 347, 19: 337, 17: 336, 14: 336, 12: 311, 18: 308, 27: 290, 10: 267, 20: 258, 4: 251, 13: 248, 7: 247, 16: 238, 11: 225, 3: 211, 25: 208, 0: 203, 29: 203, 21: 167, 5: 155, 2: 140, 26: 136, 24: 130, 8: 129, 31: 118, 1: 114, 15: 89, 22: 83, 9: 76})

Epoch :  76 loss training:  1.5573411879013292 Time :  17336
accuracy train: 0.999338 val: 0.746269 test: 0.719763
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({13: 541, 0: 497, 22: 393, 5: 341, 26: 339, 20: 290, 11: 271, 19: 266, 25: 263, 6: 256, 18: 256, 23: 249, 16: 242, 17: 236, 27: 235, 31: 228, 4: 212, 29: 209, 3: 200, 10: 197, 15: 186, 14: 185, 8: 166, 28: 164, 21: 164, 7: 144, 2: 138, 1: 130, 24: 129, 30: 115, 9: 79, 12: 79})

Epoch :  77 loss training:  1.577453094883822 Time :  17506
accuracy train: 1.000000 val: 0.749254 test: 0.720257
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({11: 533, 1: 478, 9: 376, 17: 339, 6: 337, 26: 333, 24: 309, 19: 306, 0: 291, 21: 265, 15: 263, 10: 262, 28: 255, 31: 249, 14: 246, 3: 242, 8: 226, 23: 210, 7: 205, 18: 198, 4: 194, 22: 158, 5: 144, 20: 139, 16: 130, 13: 129, 27: 119, 30: 116, 2: 101, 25: 88, 12: 81, 29: 78})

Epoch :  78 loss training:  1.2805240759043954 Time :  17648
accuracy train: 0.999669 val: 0.755224 test: 0.719763
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({14: 426, 3: 407, 17: 345, 8: 342, 2: 341, 5: 340, 24: 306, 4: 292, 16: 284, 11: 280, 7: 262, 28: 257, 13: 247, 9: 245, 27: 237, 6: 235, 26: 224, 29: 201, 21: 200, 19: 199, 1: 199, 25: 198, 30: 178, 10: 176, 0: 172, 22: 138, 18: 131, 20: 130, 12: 123, 15: 114, 23: 92, 31: 79})

Epoch :  79 loss training:  1.4870580396382138 Time :  17778
accuracy train: 1.000000 val: 0.749254 test: 0.719763
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({8: 516, 19: 390, 6: 361, 21: 339, 16: 331, 12: 328, 25: 321, 7: 295, 11: 282, 2: 265, 13: 262, 26: 249, 27: 245, 28: 244, 31: 243, 23: 232, 5: 225, 1: 210, 3: 204, 9: 200, 15: 198, 22: 182, 4: 181, 17: 178, 24: 139, 29: 131, 20: 128, 18: 124, 10: 121, 30: 115, 14: 83, 0: 78})

Epoch :  80 loss training:  1.7635071049444377 Time :  17953
accuracy train: 0.999669 val: 0.764179 test: 0.719515
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({22: 563, 2: 475, 0: 403, 1: 392, 24: 333, 15: 329, 21: 325, 3: 292, 30: 288, 25: 288, 10: 262, 13: 246, 5: 244, 31: 244, 18: 229, 11: 212, 12: 202, 20: 196, 7: 194, 14: 193, 26: 182, 8: 178, 9: 140, 23: 133, 28: 133, 29: 131, 4: 126, 16: 116, 19: 105, 27: 89, 6: 84, 17: 73})

Epoch :  81 loss training:  1.6723880876088515 Time :  18063
accuracy train: 0.999669 val: 0.758209 test: 0.722731
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({21: 458, 17: 393, 12: 375, 26: 367, 1: 359, 31: 332, 3: 328, 5: 325, 23: 300, 6: 295, 20: 262, 8: 260, 19: 250, 4: 243, 15: 230, 28: 207, 9: 205, 16: 204, 0: 199, 14: 197, 7: 196, 24: 174, 18: 165, 25: 149, 2: 148, 27: 140, 10: 131, 11: 126, 13: 116, 29: 102, 22: 89, 30: 75})

Epoch :  82 loss training:  1.44414178020088 Time :  18191
accuracy train: 0.999338 val: 0.758209 test: 0.718031
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({26: 468, 17: 386, 4: 354, 16: 352, 21: 340, 7: 324, 11: 317, 20: 309, 3: 296, 23: 262, 27: 261, 22: 249, 14: 240, 25: 237, 1: 218, 13: 216, 29: 215, 9: 209, 31: 198, 2: 197, 8: 197, 10: 192, 15: 189, 24: 165, 19: 161, 0: 158, 30: 139, 18: 131, 12: 125, 6: 116, 28: 105, 5: 74})

Epoch :  83 loss training:  1.3427049109013751 Time :  18321
accuracy train: 0.999338 val: 0.761194 test: 0.718526
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({16: 522, 22: 505, 30: 446, 15: 393, 0: 378, 14: 366, 18: 342, 23: 297, 3: 260, 10: 245, 24: 239, 29: 229, 6: 213, 26: 208, 9: 206, 25: 206, 19: 200, 7: 199, 11: 196, 8: 193, 12: 183, 31: 170, 17: 168, 20: 162, 27: 140, 2: 131, 28: 126, 5: 116, 13: 106, 4: 99, 1: 78, 21: 78})

Epoch :  84 loss training:  1.059389918053057 Time :  18459
accuracy train: 0.999669 val: 0.749254 test: 0.718031
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({26: 534, 19: 485, 3: 446, 27: 338, 9: 338, 10: 323, 23: 305, 2: 302, 5: 292, 20: 282, 12: 278, 8: 261, 21: 245, 6: 239, 11: 217, 31: 216, 17: 209, 4: 206, 16: 195, 28: 180, 29: 165, 13: 158, 22: 147, 14: 144, 24: 140, 0: 131, 25: 123, 15: 119, 1: 115, 30: 107, 18: 83, 7: 77})

Epoch :  85 loss training:  1.1474569028941914 Time :  18584
accuracy train: 0.999007 val: 0.749254 test: 0.719021
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({4: 533, 8: 474, 13: 377, 0: 340, 3: 324, 9: 322, 18: 319, 28: 291, 14: 278, 29: 278, 15: 247, 2: 245, 25: 237, 5: 236, 17: 222, 21: 216, 24: 209, 30: 201, 11: 201, 22: 192, 1: 190, 27: 187, 26: 178, 7: 161, 20: 157, 10: 147, 16: 138, 19: 131, 23: 124, 31: 116, 6: 77, 12: 52})

Epoch :  86 loss training:  1.0575190598028712 Time :  18710
accuracy train: 0.999338 val: 0.746269 test: 0.718279
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({7: 551, 29: 475, 11: 468, 13: 395, 27: 368, 17: 341, 2: 340, 4: 337, 8: 290, 15: 257, 19: 240, 25: 232, 21: 232, 22: 229, 1: 210, 23: 203, 9: 200, 10: 196, 14: 193, 0: 184, 24: 177, 6: 146, 5: 145, 16: 136, 3: 132, 31: 131, 26: 125, 20: 118, 30: 115, 12: 102, 18: 77, 28: 55})

Epoch :  87 loss training:  0.9996611205278896 Time :  18808
accuracy train: 0.999669 val: 0.740299 test: 0.718279
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({5: 553, 4: 526, 7: 524, 1: 522, 27: 471, 2: 335, 8: 320, 20: 289, 21: 272, 18: 255, 6: 247, 19: 241, 22: 239, 14: 232, 0: 231, 12: 208, 16: 200, 31: 197, 30: 171, 24: 150, 29: 147, 26: 141, 10: 131, 13: 124, 17: 115, 3: 106, 28: 98, 15: 83, 23: 80, 9: 78, 11: 58, 25: 56})

Epoch :  88 loss training:  0.829320360411657 Time :  18910
accuracy train: 0.999338 val: 0.755224 test: 0.721741
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({9: 525, 28: 520, 27: 439, 15: 377, 31: 328, 30: 320, 13: 320, 22: 290, 20: 275, 24: 274, 17: 255, 0: 250, 14: 236, 8: 228, 19: 220, 25: 214, 4: 207, 5: 203, 29: 199, 11: 199, 3: 164, 23: 145, 12: 145, 1: 141, 2: 132, 18: 132, 26: 125, 21: 121, 16: 118, 6: 114, 7: 106, 10: 78})

Epoch :  89 loss training:  0.9970006285002455 Time :  19015
accuracy train: 0.999338 val: 0.761194 test: 0.715063
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({2: 522, 3: 489, 1: 421, 23: 351, 20: 340, 0: 317, 11: 317, 24: 289, 25: 280, 31: 265, 19: 258, 14: 253, 21: 243, 7: 237, 4: 237, 27: 220, 16: 218, 26: 206, 6: 198, 30: 198, 12: 196, 15: 156, 9: 142, 29: 141, 17: 140, 18: 132, 22: 127, 13: 115, 28: 114, 10: 107, 8: 91, 5: 80})

Epoch :  90 loss training:  1.4574015466787387 Time :  19167
accuracy train: 0.999338 val: 0.764179 test: 0.720999
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({1: 509, 24: 493, 16: 454, 25: 425, 15: 357, 0: 337, 8: 332, 22: 294, 4: 286, 23: 279, 19: 267, 30: 265, 12: 243, 7: 240, 5: 237, 2: 223, 9: 216, 11: 213, 31: 204, 18: 165, 27: 141, 29: 132, 6: 130, 21: 125, 14: 124, 26: 123, 28: 119, 10: 113, 17: 108, 20: 83, 13: 83, 3: 80})

Epoch :  91 loss training:  1.2800935499253683 Time :  19347
accuracy train: 0.999669 val: 0.758209 test: 0.723967
max validation accuracy : 0.770149 max acc epoch : 60 test accuracy : 0.726441
Counter({11: 515, 16: 508, 13: 485, 20: 472, 30: 331, 21: 294, 14: 286, 19: 284, 26: 277, 2: 271, 17: 255, 3: 249, 10: 246, 22: 243, 18: 230, 12: 225, 25: 221, 4: 209, 7: 201, 24: 157, 5: 153, 8: 141, 29: 139, 15: 132, 31: 132, 6: 127, 9: 125, 0: 116, 23: 108, 28: 96, 27: 94, 1: 78})

========================================================================================================================================================================================================
best acc epoch :  60
validation accuracy :  0.7701492537313432
test accuracy :  0.7264407618105367
last test_accuracy :  0.7239673509769973
second best val :  0.7671641791044777
second best test :  0.7197625525599802
max gap 16
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=32, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=304, tsne=False, weight_decay=0)
device :  cuda:0
Counter({1: 397, 21: 356, 24: 338, 25: 305, 23: 300, 3: 288, 22: 276, 11: 274, 18: 255, 13: 249, 16: 246, 28: 244, 12: 234, 10: 234, 14: 232, 29: 227, 6: 225, 8: 225, 26: 217, 4: 203, 0: 201, 20: 196, 15: 189, 31: 187, 9: 184, 2: 182, 7: 182, 30: 160, 5: 152, 19: 150, 27: 146, 17: 146})

Epoch :  1 loss training:  208.6460680961609 Time :  19608
accuracy train: 0.675711 val: 0.635821 test: 0.617116
max validation accuracy : 0.635821 max acc epoch : 1 test accuracy : 0.617116
Counter({6: 446, 3: 433, 23: 355, 7: 347, 26: 333, 11: 279, 19: 270, 16: 266, 2: 262, 27: 260, 0: 252, 20: 248, 13: 243, 24: 226, 31: 225, 21: 221, 22: 218, 18: 214, 5: 208, 4: 207, 29: 202, 17: 200, 15: 196, 12: 181, 1: 173, 30: 151, 28: 146, 10: 140, 14: 138, 25: 135, 9: 118, 8: 107})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  144.04043287038803 Time :  19839
accuracy train: 0.720384 val: 0.662687 test: 0.662627
max validation accuracy : 0.662687 max acc epoch : 2 test accuracy : 0.662627
Counter({17: 493, 4: 456, 3: 372, 10: 303, 18: 292, 5: 287, 0: 287, 29: 266, 24: 263, 31: 257, 9: 249, 14: 247, 25: 247, 27: 235, 26: 231, 11: 231, 23: 224, 7: 224, 6: 219, 28: 209, 2: 189, 1: 187, 19: 187, 13: 177, 22: 176, 16: 171, 8: 148, 21: 133, 20: 123, 15: 117, 12: 114, 30: 86})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  120.60684233903885 Time :  20183
accuracy train: 0.750165 val: 0.680597 test: 0.662379
max validation accuracy : 0.680597 max acc epoch : 3 test accuracy : 0.662379
Counter({24: 385, 28: 376, 21: 341, 4: 337, 1: 328, 14: 289, 10: 271, 3: 269, 6: 262, 7: 259, 13: 256, 23: 256, 5: 254, 2: 253, 22: 251, 26: 249, 29: 241, 17: 235, 11: 223, 16: 216, 25: 214, 30: 206, 19: 188, 20: 161, 8: 157, 27: 157, 15: 156, 0: 144, 12: 132, 31: 132, 9: 123, 18: 79})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  94.55448871850967 Time :  20502
accuracy train: 0.797154 val: 0.689552 test: 0.701954
max validation accuracy : 0.689552 max acc epoch : 4 test accuracy : 0.701954
Counter({6: 437, 2: 392, 22: 357, 12: 345, 18: 288, 30: 278, 10: 271, 11: 271, 5: 261, 19: 258, 20: 254, 21: 250, 23: 247, 7: 247, 29: 242, 17: 241, 8: 240, 31: 230, 1: 216, 26: 216, 3: 215, 15: 209, 27: 168, 24: 168, 13: 161, 0: 160, 4: 152, 16: 143, 14: 140, 25: 131, 9: 128, 28: 84})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  87.09255209565163 Time :  20858
accuracy train: 0.815685 val: 0.692537 test: 0.699728
max validation accuracy : 0.692537 max acc epoch : 5 test accuracy : 0.699728
Counter({4: 413, 19: 401, 11: 396, 8: 395, 2: 331, 25: 321, 1: 270, 20: 269, 13: 268, 28: 257, 7: 249, 9: 247, 0: 243, 31: 239, 26: 238, 22: 235, 29: 234, 30: 221, 17: 213, 10: 198, 14: 195, 3: 173, 27: 165, 12: 160, 5: 158, 6: 157, 15: 154, 24: 131, 18: 128, 16: 128, 21: 127, 23: 86})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  81.8328842818737 Time :  21073
accuracy train: 0.824619 val: 0.701493 test: 0.697502
max validation accuracy : 0.701493 max acc epoch : 6 test accuracy : 0.697502
Counter({8: 396, 13: 391, 26: 374, 20: 365, 11: 363, 12: 346, 15: 334, 3: 316, 19: 274, 25: 271, 17: 260, 4: 257, 9: 256, 30: 255, 6: 249, 16: 242, 22: 232, 10: 218, 21: 216, 24: 211, 7: 173, 29: 160, 23: 156, 0: 152, 1: 144, 31: 140, 2: 137, 28: 128, 18: 121, 5: 118, 27: 86, 14: 59})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  70.3149455934763 Time :  21286
accuracy train: 0.848114 val: 0.701493 test: 0.709374
max validation accuracy : 0.701493 max acc epoch : 6 test accuracy : 0.697502
Counter({15: 547, 18: 393, 8: 389, 6: 353, 0: 344, 28: 337, 26: 332, 25: 271, 3: 270, 11: 268, 19: 263, 10: 259, 21: 250, 2: 245, 9: 233, 30: 225, 24: 223, 1: 222, 22: 199, 5: 192, 14: 173, 29: 160, 4: 157, 31: 154, 12: 152, 13: 139, 23: 133, 20: 131, 16: 122, 27: 113, 17: 88, 7: 63})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.02748747169971 Time :  21475
accuracy train: 0.860688 val: 0.722388 test: 0.709869
max validation accuracy : 0.722388 max acc epoch : 8 test accuracy : 0.709869
Counter({31: 521, 3: 420, 16: 392, 30: 341, 6: 334, 13: 314, 15: 268, 8: 267, 11: 266, 0: 263, 17: 263, 29: 260, 28: 238, 2: 236, 21: 224, 25: 224, 4: 220, 9: 220, 1: 202, 14: 195, 12: 190, 23: 175, 26: 164, 19: 160, 5: 159, 7: 151, 27: 146, 24: 132, 18: 123, 22: 117, 20: 117, 10: 98})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.82751166820526 Time :  21761
accuracy train: 0.871277 val: 0.722388 test: 0.707890
max validation accuracy : 0.722388 max acc epoch : 8 test accuracy : 0.709869
Counter({10: 404, 8: 385, 12: 354, 23: 326, 1: 324, 6: 318, 29: 271, 18: 270, 0: 264, 19: 261, 2: 256, 13: 250, 17: 247, 14: 230, 31: 230, 28: 229, 15: 222, 25: 219, 16: 208, 9: 205, 22: 203, 4: 201, 5: 185, 30: 174, 3: 168, 11: 162, 21: 156, 24: 152, 7: 150, 26: 132, 27: 125, 20: 119})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  56.73752349615097 Time :  21992
accuracy train: 0.887492 val: 0.728358 test: 0.717042
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.717042
Counter({10: 417, 13: 400, 19: 375, 30: 336, 28: 300, 12: 269, 25: 268, 18: 266, 8: 260, 2: 259, 11: 256, 15: 253, 26: 252, 21: 242, 29: 232, 22: 227, 3: 225, 17: 210, 9: 210, 16: 208, 4: 205, 6: 199, 1: 198, 23: 186, 7: 178, 5: 168, 14: 164, 20: 163, 31: 144, 0: 125, 27: 116, 24: 89})

Epoch :  11 loss training:  55.18036599457264 Time :  22237
accuracy train: 0.884514 val: 0.731343 test: 0.711106
max validation accuracy : 0.731343 max acc epoch : 11 test accuracy : 0.711106
Counter({9: 405, 18: 370, 19: 349, 28: 349, 25: 348, 1: 332, 0: 273, 26: 267, 20: 266, 2: 266, 5: 263, 6: 259, 31: 249, 15: 249, 22: 239, 12: 224, 14: 223, 13: 222, 7: 213, 4: 209, 3: 201, 21: 201, 16: 179, 27: 171, 11: 165, 10: 160, 8: 145, 23: 138, 24: 133, 17: 126, 30: 116, 29: 90})

Epoch :  12 loss training:  52.586386024951935 Time :  22552
accuracy train: 0.902713 val: 0.722388 test: 0.715310
max validation accuracy : 0.731343 max acc epoch : 11 test accuracy : 0.711106
Counter({20: 415, 7: 377, 14: 346, 12: 339, 9: 317, 13: 272, 2: 271, 24: 268, 16: 267, 10: 266, 23: 264, 28: 263, 5: 259, 11: 257, 17: 255, 21: 253, 8: 240, 3: 224, 29: 216, 31: 214, 25: 208, 1: 198, 15: 179, 4: 171, 0: 157, 27: 157, 30: 144, 26: 139, 18: 131, 22: 127, 6: 116, 19: 90})

Epoch :  13 loss training:  49.777094691991806 Time :  22885
accuracy train: 0.908339 val: 0.725373 test: 0.715310
max validation accuracy : 0.731343 max acc epoch : 11 test accuracy : 0.711106
Counter({10: 456, 5: 432, 20: 388, 16: 339, 21: 334, 17: 333, 27: 332, 14: 268, 2: 268, 11: 267, 26: 265, 7: 261, 0: 231, 9: 222, 12: 214, 23: 210, 8: 210, 30: 207, 3: 196, 28: 188, 31: 186, 25: 185, 15: 173, 24: 157, 19: 156, 13: 145, 1: 140, 22: 134, 4: 131, 29: 128, 18: 128, 6: 116})

Epoch :  14 loss training:  47.39903536438942 Time :  23080
accuracy train: 0.914295 val: 0.734328 test: 0.714074
max validation accuracy : 0.734328 max acc epoch : 14 test accuracy : 0.714074
Counter({0: 428, 28: 336, 25: 335, 23: 332, 19: 332, 30: 329, 3: 306, 20: 272, 7: 269, 27: 267, 24: 266, 13: 261, 6: 260, 31: 229, 4: 213, 2: 213, 17: 212, 9: 211, 14: 210, 1: 209, 8: 199, 12: 197, 10: 188, 16: 180, 29: 173, 11: 156, 26: 155, 5: 151, 22: 137, 18: 130, 15: 128, 21: 116})

Epoch :  15 loss training:  43.14028339087963 Time :  23350
accuracy train: 0.915950 val: 0.734328 test: 0.713579
max validation accuracy : 0.734328 max acc epoch : 14 test accuracy : 0.714074
Counter({29: 389, 24: 369, 13: 351, 10: 335, 19: 333, 6: 327, 5: 316, 28: 310, 18: 270, 9: 269, 8: 267, 27: 266, 15: 250, 12: 230, 23: 228, 7: 224, 16: 224, 25: 214, 4: 211, 0: 209, 14: 202, 20: 196, 21: 190, 2: 186, 11: 182, 1: 157, 22: 137, 17: 134, 30: 130, 26: 117, 31: 105, 3: 72})

Epoch :  16 loss training:  40.94424472749233 Time :  23508
accuracy train: 0.931502 val: 0.731343 test: 0.719515
max validation accuracy : 0.734328 max acc epoch : 14 test accuracy : 0.714074
Counter({2: 399, 5: 391, 12: 387, 28: 355, 14: 347, 0: 342, 1: 324, 17: 309, 9: 273, 16: 259, 10: 258, 7: 252, 19: 248, 29: 247, 23: 237, 13: 232, 8: 216, 15: 215, 18: 198, 20: 197, 6: 189, 25: 186, 22: 183, 24: 158, 3: 142, 4: 141, 31: 136, 21: 134, 11: 130, 26: 116, 27: 108, 30: 91})

Epoch :  17 loss training:  39.20239636301994 Time :  23686
accuracy train: 0.934480 val: 0.728358 test: 0.721494
max validation accuracy : 0.734328 max acc epoch : 14 test accuracy : 0.714074
Counter({30: 417, 10: 389, 23: 386, 2: 350, 6: 339, 0: 316, 28: 316, 12: 272, 9: 266, 26: 256, 22: 254, 15: 249, 21: 243, 20: 237, 25: 220, 8: 219, 1: 219, 13: 216, 31: 204, 16: 198, 29: 195, 5: 191, 27: 182, 7: 179, 19: 168, 4: 157, 18: 146, 3: 140, 14: 135, 11: 134, 24: 117, 17: 90})

Epoch :  18 loss training:  36.684638008475304 Time :  23991
accuracy train: 0.946393 val: 0.737313 test: 0.721494
max validation accuracy : 0.737313 max acc epoch : 18 test accuracy : 0.721494
Counter({13: 405, 21: 390, 5: 353, 9: 330, 26: 322, 25: 318, 19: 311, 23: 294, 12: 264, 7: 264, 22: 256, 14: 252, 15: 250, 0: 243, 11: 226, 20: 221, 16: 219, 18: 217, 4: 215, 8: 201, 10: 201, 2: 197, 29: 192, 17: 184, 27: 169, 24: 154, 3: 153, 1: 135, 28: 134, 31: 122, 30: 118, 6: 90})

slurmstepd: error: *** JOB 37342 ON cl-gpusrv1 CANCELLED AT 2021-06-15T16:08:47 ***
