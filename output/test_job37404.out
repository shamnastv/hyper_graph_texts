

date and time :  Tue Jun 15 00:29:26 2021
itr : 0
Namespace(batch_size=64, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=857, tsne=True, weight_decay=0)
device :  cuda:0
Counter({2: 7573, 0: 6370, 1: 4903})

Epoch :  1 loss training:  350.20683738589287 Time :  746
accuracy train: 0.779338 val: 0.765694 test: 0.705656
max validation accuracy : 0.765694 max acc epoch : 1 test accuracy : 0.705656
Counter({0: 9093, 2: 5826, 1: 3927})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  211.90527832508087 Time :  881
accuracy train: 0.842286 val: 0.812555 test: 0.750797
max validation accuracy : 0.812555 max acc epoch : 2 test accuracy : 0.750797
Counter({1: 8215, 2: 6189, 0: 4442})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  182.80002923309803 Time :  1030
accuracy train: 0.868015 val: 0.834660 test: 0.768720
max validation accuracy : 0.834660 max acc epoch : 3 test accuracy : 0.768720
Counter({1: 9196, 0: 5780, 2: 3870})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  133.75384993851185 Time :  1178
accuracy train: 0.907787 val: 0.875332 test: 0.798062
max validation accuracy : 0.875332 max acc epoch : 4 test accuracy : 0.798062
Counter({1: 6684, 2: 6110, 0: 6052})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  121.88845807313919 Time :  1313
accuracy train: 0.920063 val: 0.885942 test: 0.798327
max validation accuracy : 0.885942 max acc epoch : 5 test accuracy : 0.798327
Counter({2: 6463, 0: 6299, 1: 6084})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  112.54261288791895 Time :  1459
accuracy train: 0.923205 val: 0.883289 test: 0.795539
max validation accuracy : 0.885942 max acc epoch : 5 test accuracy : 0.798327
Counter({1: 6650, 2: 6191, 0: 6005})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  95.18731750175357 Time :  1609
accuracy train: 0.939998 val: 0.896552 test: 0.805231
max validation accuracy : 0.896552 max acc epoch : 7 test accuracy : 0.805231
Counter({2: 6560, 0: 6297, 1: 5989})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  90.281499363482 Time :  1743
accuracy train: 0.942158 val: 0.890363 test: 0.807090
max validation accuracy : 0.896552 max acc epoch : 7 test accuracy : 0.805231
Counter({0: 6699, 2: 6127, 1: 6020})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  84.86621294543147 Time :  1898
accuracy train: 0.949917 val: 0.894783 test: 0.811604
max validation accuracy : 0.896552 max acc epoch : 7 test accuracy : 0.805231
Counter({1: 6634, 0: 6185, 2: 6027})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  77.67634706571698 Time :  2031
accuracy train: 0.953157 val: 0.902741 test: 0.815321
max validation accuracy : 0.902741 max acc epoch : 10 test accuracy : 0.815321
Counter({1: 6689, 0: 6128, 2: 6029})

Epoch :  11 loss training:  72.00452624633908 Time :  2179
accuracy train: 0.961504 val: 0.901857 test: 0.817047
max validation accuracy : 0.902741 max acc epoch : 10 test accuracy : 0.815321
Counter({1: 9191, 2: 5916, 0: 3739})

Epoch :  12 loss training:  65.91994715481997 Time :  2315
accuracy train: 0.967986 val: 0.907162 test: 0.818773
max validation accuracy : 0.907162 max acc epoch : 12 test accuracy : 0.818773
Counter({1: 9142, 2: 5959, 0: 3745})

Epoch :  13 loss training:  57.96817548200488 Time :  2446
accuracy train: 0.973387 val: 0.914235 test: 0.823686
max validation accuracy : 0.914235 max acc epoch : 13 test accuracy : 0.823686
Counter({1: 9107, 0: 5985, 2: 3754})

Epoch :  14 loss training:  52.21984162181616 Time :  2584
accuracy train: 0.977610 val: 0.911583 test: 0.827138
max validation accuracy : 0.914235 max acc epoch : 13 test accuracy : 0.823686
Counter({2: 6546, 1: 6235, 0: 6065})

Epoch :  15 loss training:  44.87299318239093 Time :  2718
accuracy train: 0.981145 val: 0.913351 test: 0.828067
max validation accuracy : 0.914235 max acc epoch : 13 test accuracy : 0.823686
Counter({2: 9146, 1: 5981, 0: 3719})

Epoch :  16 loss training:  40.83300594985485 Time :  2855
accuracy train: 0.986448 val: 0.917772 test: 0.829793
max validation accuracy : 0.917772 max acc epoch : 16 test accuracy : 0.829793
Counter({2: 6609, 0: 6228, 1: 6009})

Epoch :  17 loss training:  37.29769640509039 Time :  2983
accuracy train: 0.988805 val: 0.918656 test: 0.832315
max validation accuracy : 0.918656 max acc epoch : 17 test accuracy : 0.832315
Counter({2: 6671, 0: 6200, 1: 5975})

Epoch :  18 loss training:  32.434302719309926 Time :  3112
accuracy train: 0.991162 val: 0.926614 test: 0.833112
max validation accuracy : 0.926614 max acc epoch : 18 test accuracy : 0.833112
Counter({0: 6662, 2: 6197, 1: 5987})

Epoch :  19 loss training:  29.67604366876185 Time :  3264
accuracy train: 0.993322 val: 0.923961 test: 0.832183
max validation accuracy : 0.926614 max acc epoch : 18 test accuracy : 0.833112
Counter({0: 9176, 1: 5967, 2: 3703})

Epoch :  20 loss training:  26.588242079131305 Time :  3410
accuracy train: 0.993519 val: 0.923961 test: 0.836033
max validation accuracy : 0.926614 max acc epoch : 18 test accuracy : 0.833112
Counter({0: 6418, 2: 6402, 1: 6026})

Epoch :  21 loss training:  23.11884111072868 Time :  3548
accuracy train: 0.995483 val: 0.923961 test: 0.839750
max validation accuracy : 0.926614 max acc epoch : 18 test accuracy : 0.833112
Counter({2: 6468, 0: 6352, 1: 6026})

Epoch :  22 loss training:  19.8433417705819 Time :  3678
accuracy train: 0.996268 val: 0.923961 test: 0.839352
max validation accuracy : 0.926614 max acc epoch : 18 test accuracy : 0.833112
Counter({1: 9217, 2: 5987, 0: 3642})

Epoch :  23 loss training:  18.675733842886984 Time :  3805
accuracy train: 0.997054 val: 0.919540 test: 0.838024
max validation accuracy : 0.926614 max acc epoch : 18 test accuracy : 0.833112
Counter({1: 6460, 0: 6367, 2: 6019})

Epoch :  24 loss training:  15.9761926648207 Time :  3929
accuracy train: 0.998429 val: 0.926614 test: 0.839883
max validation accuracy : 0.926614 max acc epoch : 18 test accuracy : 0.833112
Counter({1: 6567, 0: 6275, 2: 6004})

Epoch :  25 loss training:  13.919243868906051 Time :  4054
accuracy train: 0.998232 val: 0.922193 test: 0.842671
max validation accuracy : 0.926614 max acc epoch : 18 test accuracy : 0.833112
Counter({1: 9202, 2: 6001, 0: 3643})

Epoch :  26 loss training:  13.230176608543843 Time :  4179
accuracy train: 0.998134 val: 0.928382 test: 0.842406
max validation accuracy : 0.928382 max acc epoch : 26 test accuracy : 0.842406
Counter({1: 6442, 2: 6390, 0: 6014})

Epoch :  27 loss training:  12.245331586804241 Time :  4305
accuracy train: 0.998527 val: 0.927498 test: 0.845459
max validation accuracy : 0.928382 max acc epoch : 26 test accuracy : 0.842406
Counter({1: 9217, 0: 5973, 2: 3656})

Epoch :  28 loss training:  11.353966547874734 Time :  4443
accuracy train: 0.998723 val: 0.927498 test: 0.839618
max validation accuracy : 0.928382 max acc epoch : 26 test accuracy : 0.842406
Counter({2: 9266, 0: 5924, 1: 3656})

Epoch :  29 loss training:  9.810754381120205 Time :  4580
accuracy train: 0.999214 val: 0.929266 test: 0.844928
max validation accuracy : 0.929266 max acc epoch : 29 test accuracy : 0.844928
Counter({1: 9239, 2: 5972, 0: 3635})

Epoch :  30 loss training:  8.733546171279158 Time :  4712
accuracy train: 0.999116 val: 0.927498 test: 0.846389
max validation accuracy : 0.929266 max acc epoch : 29 test accuracy : 0.844928
Counter({1: 9250, 2: 5958, 0: 3638})

Epoch :  31 loss training:  8.206050369306467 Time :  4837
accuracy train: 0.998920 val: 0.928382 test: 0.846920
max validation accuracy : 0.929266 max acc epoch : 29 test accuracy : 0.844928
Counter({0: 6457, 2: 6379, 1: 6010})

Epoch :  32 loss training:  7.105793623137288 Time :  4975
accuracy train: 0.999018 val: 0.929266 test: 0.846522
max validation accuracy : 0.929266 max acc epoch : 29 test accuracy : 0.844928
Counter({2: 9236, 1: 5974, 0: 3636})

Epoch :  33 loss training:  7.172884280094877 Time :  5104
accuracy train: 0.999214 val: 0.928382 test: 0.847318
max validation accuracy : 0.929266 max acc epoch : 29 test accuracy : 0.844928
Counter({2: 6439, 0: 6426, 1: 5981})

Epoch :  34 loss training:  6.34945091966074 Time :  5234
accuracy train: 0.999509 val: 0.929266 test: 0.852230
max validation accuracy : 0.929266 max acc epoch : 29 test accuracy : 0.844928
Counter({0: 7897, 1: 6038, 2: 4911})

Epoch :  35 loss training:  6.605972529388964 Time :  5362
accuracy train: 0.999313 val: 0.926614 test: 0.848380
max validation accuracy : 0.929266 max acc epoch : 29 test accuracy : 0.844928
Counter({0: 7817, 1: 6273, 2: 4756})

Epoch :  36 loss training:  4.519447350001428 Time :  5486
accuracy train: 0.999313 val: 0.931919 test: 0.850372
max validation accuracy : 0.931919 max acc epoch : 36 test accuracy : 0.850372
Counter({0: 9304, 1: 5925, 2: 3617})

Epoch :  37 loss training:  4.865192083292641 Time :  5610
accuracy train: 0.999313 val: 0.931919 test: 0.847584
max validation accuracy : 0.931919 max acc epoch : 36 test accuracy : 0.850372
Counter({0: 9278, 1: 5987, 2: 3581})

Epoch :  38 loss training:  5.492535572848283 Time :  5756
accuracy train: 0.999214 val: 0.931034 test: 0.845725
max validation accuracy : 0.931919 max acc epoch : 36 test accuracy : 0.850372
Counter({2: 7825, 1: 6350, 0: 4671})

Epoch :  39 loss training:  6.23581663123332 Time :  5892
accuracy train: 0.999214 val: 0.929266 test: 0.847849
max validation accuracy : 0.931919 max acc epoch : 36 test accuracy : 0.850372
Counter({1: 8073, 0: 6184, 2: 4589})

Epoch :  40 loss training:  4.66848655679496 Time :  6024
accuracy train: 0.999411 val: 0.931034 test: 0.851168
max validation accuracy : 0.931919 max acc epoch : 36 test accuracy : 0.850372
Counter({0: 8075, 1: 6322, 2: 4449})

Epoch :  41 loss training:  3.8637642886315007 Time :  6168
accuracy train: 0.999313 val: 0.931919 test: 0.847185
max validation accuracy : 0.931919 max acc epoch : 36 test accuracy : 0.850372
Counter({1: 8052, 0: 6206, 2: 4588})

Epoch :  42 loss training:  2.857533449860057 Time :  6303
accuracy train: 0.999214 val: 0.932803 test: 0.849973
max validation accuracy : 0.932803 max acc epoch : 42 test accuracy : 0.849973
Counter({1: 8001, 2: 6328, 0: 4517})

Epoch :  43 loss training:  3.4010784845741 Time :  6433
accuracy train: 0.999411 val: 0.925729 test: 0.847982
max validation accuracy : 0.932803 max acc epoch : 42 test accuracy : 0.849973
Counter({2: 7960, 0: 6385, 1: 4501})

Epoch :  44 loss training:  3.6044155304552987 Time :  6565
accuracy train: 0.999411 val: 0.926614 test: 0.851699
max validation accuracy : 0.932803 max acc epoch : 42 test accuracy : 0.849973
Counter({2: 7939, 1: 6428, 0: 4479})

Epoch :  45 loss training:  2.9596370360814035 Time :  6706
accuracy train: 0.999411 val: 0.934571 test: 0.849973
max validation accuracy : 0.934571 max acc epoch : 45 test accuracy : 0.849973
Counter({2: 7934, 1: 6405, 0: 4507})

Epoch :  46 loss training:  3.099856526736403 Time :  6828
accuracy train: 0.999313 val: 0.930150 test: 0.849841
max validation accuracy : 0.934571 max acc epoch : 45 test accuracy : 0.849973
Counter({2: 7955, 1: 6348, 0: 4543})

Epoch :  47 loss training:  2.754157932184171 Time :  6961
accuracy train: 0.999509 val: 0.925729 test: 0.850505
max validation accuracy : 0.934571 max acc epoch : 45 test accuracy : 0.849973
Counter({0: 7940, 1: 6426, 2: 4480})

Epoch :  48 loss training:  2.2162767299523694 Time :  7134
accuracy train: 0.999313 val: 0.932803 test: 0.850903
max validation accuracy : 0.934571 max acc epoch : 45 test accuracy : 0.849973
Counter({2: 7954, 1: 6406, 0: 4486})

Epoch :  49 loss training:  2.155589041096391 Time :  7262
accuracy train: 0.999411 val: 0.930150 test: 0.854753
max validation accuracy : 0.934571 max acc epoch : 45 test accuracy : 0.849973
Counter({0: 7943, 2: 6423, 1: 4480})

Epoch :  50 loss training:  3.2658063501876313 Time :  7391
accuracy train: 0.999509 val: 0.931919 test: 0.852230
max validation accuracy : 0.934571 max acc epoch : 45 test accuracy : 0.849973
Counter({0: 7945, 2: 6436, 1: 4465})

Epoch :  51 loss training:  2.136954122710449 Time :  7515
accuracy train: 0.999509 val: 0.930150 test: 0.855550
max validation accuracy : 0.934571 max acc epoch : 45 test accuracy : 0.849973
Counter({0: 7951, 2: 6434, 1: 4461})

Epoch :  52 loss training:  2.3457406469387934 Time :  7665
accuracy train: 0.999411 val: 0.934571 test: 0.848779
max validation accuracy : 0.934571 max acc epoch : 45 test accuracy : 0.849973
Counter({1: 7937, 2: 6442, 0: 4467})

Epoch :  53 loss training:  2.177927611846826 Time :  7804
accuracy train: 0.999607 val: 0.934571 test: 0.854355
max validation accuracy : 0.934571 max acc epoch : 45 test accuracy : 0.849973
Counter({0: 7995, 1: 6397, 2: 4454})

Epoch :  54 loss training:  2.602526292524999 Time :  7939
accuracy train: 0.999509 val: 0.932803 test: 0.850903
max validation accuracy : 0.934571 max acc epoch : 45 test accuracy : 0.849973
Counter({1: 8000, 0: 6384, 2: 4462})

Epoch :  55 loss training:  2.525961917694076 Time :  8075
accuracy train: 0.999411 val: 0.934571 test: 0.853027
max validation accuracy : 0.934571 max acc epoch : 45 test accuracy : 0.849973
Counter({2: 7921, 1: 6452, 0: 4473})

Epoch :  56 loss training:  2.0036781364688068 Time :  8201
accuracy train: 0.999411 val: 0.934571 test: 0.850770
max validation accuracy : 0.934571 max acc epoch : 45 test accuracy : 0.849973
Counter({0: 7949, 2: 6457, 1: 4440})

Epoch :  57 loss training:  2.4261963622338953 Time :  8350
accuracy train: 0.999509 val: 0.934571 test: 0.851036
max validation accuracy : 0.934571 max acc epoch : 45 test accuracy : 0.849973
Counter({1: 7934, 0: 6430, 2: 4482})

Epoch :  58 loss training:  1.879872955763858 Time :  8485
accuracy train: 0.999411 val: 0.934571 test: 0.852230
max validation accuracy : 0.934571 max acc epoch : 45 test accuracy : 0.849973
Counter({0: 7948, 2: 6532, 1: 4366})

Epoch :  59 loss training:  1.9169593952829018 Time :  8622
accuracy train: 0.999214 val: 0.932803 test: 0.853293
max validation accuracy : 0.934571 max acc epoch : 45 test accuracy : 0.849973
Counter({2: 7960, 0: 6507, 1: 4379})

Epoch :  60 loss training:  2.0619886364183913 Time :  8770
accuracy train: 0.999509 val: 0.932803 test: 0.853691
max validation accuracy : 0.934571 max acc epoch : 45 test accuracy : 0.849973
Counter({2: 8057, 1: 6450, 0: 4339})

Epoch :  61 loss training:  1.8205344287271146 Time :  8927
accuracy train: 0.999607 val: 0.936340 test: 0.853956
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({2: 7984, 1: 6542, 0: 4320})

Epoch :  62 loss training:  1.681163291730627 Time :  9070
accuracy train: 0.999313 val: 0.924845 test: 0.853425
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({0: 7958, 2: 6479, 1: 4409})

Epoch :  63 loss training:  1.5419918322513695 Time :  9227
accuracy train: 0.999313 val: 0.931919 test: 0.853824
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({1: 7931, 0: 6452, 2: 4463})

Epoch :  64 loss training:  1.263122381082212 Time :  9370
accuracy train: 0.999411 val: 0.929266 test: 0.851699
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({0: 7945, 2: 6448, 1: 4453})

Epoch :  65 loss training:  2.2514136144527583 Time :  9527
accuracy train: 0.999411 val: 0.927498 test: 0.850505
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({1: 7993, 0: 6449, 2: 4404})

Epoch :  66 loss training:  1.557360883893125 Time :  9660
accuracy train: 0.999509 val: 0.930150 test: 0.852762
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({1: 7949, 2: 6519, 0: 4378})

Epoch :  67 loss training:  1.9659887618981884 Time :  9792
accuracy train: 0.999411 val: 0.922193 test: 0.854488
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({1: 7962, 0: 6470, 2: 4414})

Epoch :  68 loss training:  1.7424727999132301 Time :  9923
accuracy train: 0.999509 val: 0.932803 test: 0.858072
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({2: 7911, 1: 6576, 0: 4359})

Epoch :  69 loss training:  1.584910459096136 Time :  10052
accuracy train: 0.999509 val: 0.932803 test: 0.855284
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({2: 7926, 1: 6559, 0: 4361})

Epoch :  70 loss training:  1.7619408919090347 Time :  10176
accuracy train: 0.999607 val: 0.931034 test: 0.852762
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({1: 7928, 0: 6536, 2: 4382})

Epoch :  71 loss training:  1.2872416780737694 Time :  10313
accuracy train: 0.999313 val: 0.934571 test: 0.854222
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({2: 7999, 1: 6473, 0: 4374})

Epoch :  72 loss training:  1.4775229994775145 Time :  10454
accuracy train: 0.999509 val: 0.936340 test: 0.853558
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({1: 7955, 0: 6523, 2: 4368})

Epoch :  73 loss training:  1.2759062753830221 Time :  10579
accuracy train: 0.999509 val: 0.931034 test: 0.852098
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({0: 7941, 2: 6550, 1: 4355})

Epoch :  74 loss training:  2.0346250874135876 Time :  10721
accuracy train: 0.999313 val: 0.928382 test: 0.852894
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({1: 7983, 0: 6568, 2: 4295})

Epoch :  75 loss training:  0.9712162886680744 Time :  10866
accuracy train: 0.999607 val: 0.932803 test: 0.855019
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({1: 7967, 0: 6579, 2: 4300})

Epoch :  76 loss training:  1.323143056812114 Time :  11008
accuracy train: 0.999607 val: 0.931034 test: 0.851301
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({1: 7970, 2: 6534, 0: 4342})

Epoch :  77 loss training:  1.0201500830917212 Time :  11149
accuracy train: 0.999509 val: 0.926614 test: 0.854753
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({1: 7958, 2: 6479, 0: 4409})

Epoch :  78 loss training:  1.1045287387896678 Time :  11281
accuracy train: 0.999411 val: 0.927498 test: 0.852894
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({1: 7995, 0: 6482, 2: 4369})

Epoch :  79 loss training:  1.2717256451032881 Time :  11410
accuracy train: 0.999411 val: 0.931919 test: 0.854620
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({2: 8035, 0: 6479, 1: 4332})

Epoch :  80 loss training:  1.3211125817870197 Time :  11551
accuracy train: 0.999509 val: 0.932803 test: 0.852230
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({0: 8124, 2: 6362, 1: 4360})

Epoch :  81 loss training:  1.5844660966613446 Time :  11699
accuracy train: 0.999411 val: 0.934571 test: 0.854222
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({0: 8003, 2: 6542, 1: 4301})

Epoch :  82 loss training:  1.1267595529625396 Time :  11830
accuracy train: 0.999509 val: 0.933687 test: 0.860595
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({0: 8048, 2: 6527, 1: 4271})

Epoch :  83 loss training:  1.5107957418567821 Time :  11961
accuracy train: 0.999411 val: 0.932803 test: 0.854222
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({1: 8064, 0: 6429, 2: 4353})

Epoch :  84 loss training:  1.3617199923446606 Time :  12090
accuracy train: 0.999509 val: 0.933687 test: 0.859002
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({1: 7987, 2: 6476, 0: 4383})

Epoch :  85 loss training:  0.7571358643745043 Time :  12217
accuracy train: 0.999411 val: 0.931919 test: 0.860462
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({0: 7956, 2: 6554, 1: 4336})

Epoch :  86 loss training:  0.9465554817347765 Time :  12351
accuracy train: 0.999411 val: 0.929266 test: 0.855815
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({0: 7990, 1: 6549, 2: 4307})

Epoch :  87 loss training:  1.1187905172300816 Time :  12493
accuracy train: 0.999411 val: 0.929266 test: 0.857541
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({2: 6971, 1: 6440, 0: 5435})

Epoch :  88 loss training:  1.4140980335469067 Time :  12625
accuracy train: 0.999509 val: 0.929266 test: 0.856081
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({0: 7997, 1: 6501, 2: 4348})

Epoch :  89 loss training:  0.9998144665159998 Time :  12757
accuracy train: 0.999509 val: 0.932803 test: 0.855417
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({1: 7995, 0: 6507, 2: 4344})

Epoch :  90 loss training:  1.0980889999791543 Time :  12887
accuracy train: 0.999509 val: 0.933687 test: 0.856877
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({0: 7984, 2: 6509, 1: 4353})

Epoch :  91 loss training:  1.0892241193332666 Time :  13016
accuracy train: 0.999607 val: 0.931919 test: 0.860196
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({0: 7978, 2: 6500, 1: 4368})

Epoch :  92 loss training:  1.2584094950752842 Time :  13144
accuracy train: 0.999509 val: 0.934571 test: 0.851301
max validation accuracy : 0.936340 max acc epoch : 61 test accuracy : 0.853956
Counter({0: 7937, 2: 6660, 1: 4249})

========================================================================================================================================================================================================
best acc epoch :  61
validation accuracy :  0.9363395225464191
test accuracy :  0.8539564524694636
last test_accuracy :  0.8513011152416357
second best val :  0.9345711759504863
second best test :  0.8499734466277217
max gap 16
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=726, tsne=True, weight_decay=0)
device :  cuda:0
Counter({1: 7615, 2: 6357, 0: 4874})

Epoch :  1 loss training:  338.6830161511898 Time :  13695
accuracy train: 0.811450 val: 0.788683 test: 0.738582
max validation accuracy : 0.788683 max acc epoch : 1 test accuracy : 0.738582
Counter({0: 7058, 2: 6095, 1: 5693})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  206.12420883774757 Time :  13834
accuracy train: 0.844643 val: 0.818744 test: 0.763277
max validation accuracy : 0.818744 max acc epoch : 2 test accuracy : 0.763277
Counter({0: 7109, 2: 5984, 1: 5753})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  174.37634873390198 Time :  13968
accuracy train: 0.876461 val: 0.824934 test: 0.777217
max validation accuracy : 0.824934 max acc epoch : 3 test accuracy : 0.777217
Counter({2: 6731, 0: 6097, 1: 6018})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  135.4826723113656 Time :  14110
accuracy train: 0.903368 val: 0.855880 test: 0.792485
max validation accuracy : 0.855880 max acc epoch : 4 test accuracy : 0.792485
Counter({0: 6948, 1: 5979, 2: 5919})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  123.28550589084625 Time :  14257
accuracy train: 0.915055 val: 0.855880 test: 0.795008
max validation accuracy : 0.855880 max acc epoch : 4 test accuracy : 0.792485
Counter({0: 7025, 1: 5975, 2: 5846})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  115.2134555876255 Time :  14406
accuracy train: 0.920259 val: 0.865606 test: 0.797929
max validation accuracy : 0.865606 max acc epoch : 6 test accuracy : 0.797929
Counter({1: 7054, 2: 6043, 0: 5749})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  97.19843875989318 Time :  14531
accuracy train: 0.933713 val: 0.866490 test: 0.807754
max validation accuracy : 0.866490 max acc epoch : 7 test accuracy : 0.807754
Counter({0: 7026, 1: 6087, 2: 5733})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  89.66889380663633 Time :  14659
accuracy train: 0.940784 val: 0.878868 test: 0.812002
max validation accuracy : 0.878868 max acc epoch : 8 test accuracy : 0.812002
Counter({1: 7040, 2: 6056, 0: 5750})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  87.84619327634573 Time :  14801
accuracy train: 0.942650 val: 0.874447 test: 0.807090
max validation accuracy : 0.878868 max acc epoch : 8 test accuracy : 0.812002
Counter({0: 7035, 2: 6018, 1: 5793})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  79.64342340826988 Time :  14929
accuracy train: 0.948738 val: 0.876216 test: 0.811471
max validation accuracy : 0.878868 max acc epoch : 8 test accuracy : 0.812002
Counter({2: 7048, 1: 6024, 0: 5774})

Epoch :  11 loss training:  75.073934674263 Time :  15091
accuracy train: 0.956005 val: 0.882405 test: 0.815587
max validation accuracy : 0.882405 max acc epoch : 11 test accuracy : 0.815587
Counter({2: 7040, 1: 5995, 0: 5811})

Epoch :  12 loss training:  68.25969337299466 Time :  15230
accuracy train: 0.963174 val: 0.885942 test: 0.819968
max validation accuracy : 0.885942 max acc epoch : 12 test accuracy : 0.819968
Counter({1: 7060, 0: 5995, 2: 5791})

Epoch :  13 loss training:  60.89655654504895 Time :  15372
accuracy train: 0.968379 val: 0.890363 test: 0.823553
max validation accuracy : 0.890363 max acc epoch : 13 test accuracy : 0.823553
Counter({1: 7038, 2: 5906, 0: 5902})

Epoch :  14 loss training:  53.79953431710601 Time :  15507
accuracy train: 0.973485 val: 0.896552 test: 0.823818
max validation accuracy : 0.896552 max acc epoch : 14 test accuracy : 0.823818
Counter({2: 7060, 0: 5960, 1: 5826})

Epoch :  15 loss training:  49.34964422881603 Time :  15643
accuracy train: 0.979476 val: 0.893899 test: 0.827801
max validation accuracy : 0.896552 max acc epoch : 14 test accuracy : 0.823818
Counter({2: 7074, 1: 5921, 0: 5851})

Epoch :  16 loss training:  43.3403827669099 Time :  15785
accuracy train: 0.984288 val: 0.900088 test: 0.828598
max validation accuracy : 0.900088 max acc epoch : 16 test accuracy : 0.828598
Counter({1: 7042, 2: 5926, 0: 5878})

Epoch :  17 loss training:  40.11020497791469 Time :  15927
accuracy train: 0.987823 val: 0.900088 test: 0.828731
max validation accuracy : 0.900088 max acc epoch : 16 test accuracy : 0.828598
Counter({2: 7073, 0: 5919, 1: 5854})

Epoch :  18 loss training:  35.173539145849645 Time :  16076
accuracy train: 0.990082 val: 0.899204 test: 0.833245
max validation accuracy : 0.900088 max acc epoch : 16 test accuracy : 0.828598
Counter({1: 7103, 0: 5900, 2: 5843})

Epoch :  19 loss training:  31.72930361237377 Time :  16226
accuracy train: 0.992242 val: 0.907162 test: 0.832714
max validation accuracy : 0.907162 max acc epoch : 19 test accuracy : 0.832714
Counter({1: 7127, 2: 5868, 0: 5851})

Epoch :  20 loss training:  27.022967448458076 Time :  16374
accuracy train: 0.994501 val: 0.911583 test: 0.839087
max validation accuracy : 0.911583 max acc epoch : 20 test accuracy : 0.839087
Counter({0: 7119, 2: 5874, 1: 5853})

Epoch :  21 loss training:  23.951316251419485 Time :  16526
accuracy train: 0.994795 val: 0.907162 test: 0.837095
max validation accuracy : 0.911583 max acc epoch : 20 test accuracy : 0.839087
Counter({0: 7130, 1: 5873, 2: 5843})

Epoch :  22 loss training:  22.931639764923602 Time :  16673
accuracy train: 0.996563 val: 0.916004 test: 0.836033
max validation accuracy : 0.916004 max acc epoch : 22 test accuracy : 0.836033
Counter({1: 7123, 2: 5901, 0: 5822})

Epoch :  23 loss training:  18.2779745538719 Time :  16823
accuracy train: 0.997741 val: 0.916004 test: 0.838821
max validation accuracy : 0.916004 max acc epoch : 22 test accuracy : 0.836033
Counter({1: 7089, 2: 5989, 0: 5768})

Epoch :  24 loss training:  15.959475684445351 Time :  16990
accuracy train: 0.997840 val: 0.916888 test: 0.840016
max validation accuracy : 0.916888 max acc epoch : 24 test accuracy : 0.840016
Counter({2: 7108, 1: 6020, 0: 5718})

Epoch :  25 loss training:  14.725735142361373 Time :  17144
accuracy train: 0.997840 val: 0.914235 test: 0.844264
max validation accuracy : 0.916888 max acc epoch : 24 test accuracy : 0.840016
Counter({2: 7090, 1: 6080, 0: 5676})

Epoch :  26 loss training:  14.959258857415989 Time :  17321
accuracy train: 0.998625 val: 0.918656 test: 0.843202
max validation accuracy : 0.918656 max acc epoch : 26 test accuracy : 0.843202
Counter({1: 7133, 0: 6144, 2: 5569})

Epoch :  27 loss training:  12.029389102710411 Time :  17468
accuracy train: 0.999018 val: 0.919540 test: 0.842804
max validation accuracy : 0.919540 max acc epoch : 27 test accuracy : 0.842804
Counter({0: 7162, 1: 6093, 2: 5591})

Epoch :  28 loss training:  11.072837415151298 Time :  17632
accuracy train: 0.999313 val: 0.925729 test: 0.845459
max validation accuracy : 0.925729 max acc epoch : 28 test accuracy : 0.845459
Counter({0: 7219, 2: 6120, 1: 5507})

Epoch :  29 loss training:  9.86372663907241 Time :  17771
accuracy train: 0.999116 val: 0.925729 test: 0.844132
max validation accuracy : 0.925729 max acc epoch : 28 test accuracy : 0.845459
Counter({0: 7060, 2: 6298, 1: 5488})

Epoch :  30 loss training:  9.625478494912386 Time :  17937
accuracy train: 0.999116 val: 0.917772 test: 0.845061
max validation accuracy : 0.925729 max acc epoch : 28 test accuracy : 0.845459
Counter({2: 7083, 0: 6267, 1: 5496})

Epoch :  31 loss training:  8.197845190996304 Time :  18086
accuracy train: 0.999214 val: 0.925729 test: 0.847318
max validation accuracy : 0.925729 max acc epoch : 28 test accuracy : 0.845459
Counter({1: 7024, 0: 6336, 2: 5486})

Epoch :  32 loss training:  7.2474590199417435 Time :  18219
accuracy train: 0.999313 val: 0.926614 test: 0.849442
max validation accuracy : 0.926614 max acc epoch : 32 test accuracy : 0.849442
Counter({0: 6995, 1: 6365, 2: 5486})

Epoch :  33 loss training:  7.526573291863315 Time :  18349
accuracy train: 0.999214 val: 0.925729 test: 0.847451
max validation accuracy : 0.926614 max acc epoch : 32 test accuracy : 0.849442
Counter({2: 6971, 1: 6367, 0: 5508})

Epoch :  34 loss training:  6.150332345278002 Time :  18482
accuracy train: 0.999214 val: 0.927498 test: 0.847584
max validation accuracy : 0.927498 max acc epoch : 34 test accuracy : 0.847584
Counter({1: 6940, 2: 6402, 0: 5504})

Epoch :  35 loss training:  6.087497455184348 Time :  18638
accuracy train: 0.999116 val: 0.924845 test: 0.848380
max validation accuracy : 0.927498 max acc epoch : 34 test accuracy : 0.847584
Counter({1: 6852, 2: 6476, 0: 5518})

Epoch :  36 loss training:  5.157605994376354 Time :  18775
accuracy train: 0.999411 val: 0.932803 test: 0.849310
max validation accuracy : 0.932803 max acc epoch : 36 test accuracy : 0.849310
Counter({1: 6876, 0: 6486, 2: 5484})

Epoch :  37 loss training:  5.1785160706494935 Time :  18909
accuracy train: 0.999214 val: 0.930150 test: 0.849310
max validation accuracy : 0.932803 max acc epoch : 36 test accuracy : 0.849310
Counter({1: 6771, 2: 6629, 0: 5446})

Epoch :  38 loss training:  6.1014286176650785 Time :  19045
accuracy train: 0.999313 val: 0.925729 test: 0.851567
max validation accuracy : 0.932803 max acc epoch : 36 test accuracy : 0.849310
Counter({1: 6752, 2: 6646, 0: 5448})

Epoch :  39 loss training:  4.251506584638264 Time :  19181
accuracy train: 0.999313 val: 0.928382 test: 0.851965
max validation accuracy : 0.932803 max acc epoch : 36 test accuracy : 0.849310
Counter({0: 7149, 1: 6206, 2: 5491})

Epoch :  40 loss training:  3.9050855021341704 Time :  19317
accuracy train: 0.999411 val: 0.921309 test: 0.851965
max validation accuracy : 0.932803 max acc epoch : 36 test accuracy : 0.849310
Counter({0: 6759, 1: 6619, 2: 5468})

Epoch :  41 loss training:  4.156108921248233 Time :  19451
accuracy train: 0.999411 val: 0.924845 test: 0.846256
max validation accuracy : 0.932803 max acc epoch : 36 test accuracy : 0.849310
Counter({2: 6842, 1: 6559, 0: 5445})

Epoch :  42 loss training:  3.6623103707970586 Time :  19603
accuracy train: 0.999411 val: 0.926614 test: 0.851832
max validation accuracy : 0.932803 max acc epoch : 36 test accuracy : 0.849310
Counter({0: 6912, 1: 6535, 2: 5399})

Epoch :  43 loss training:  3.4570915031363256 Time :  19760
accuracy train: 0.999313 val: 0.926614 test: 0.852762
max validation accuracy : 0.932803 max acc epoch : 36 test accuracy : 0.849310
Counter({2: 6798, 0: 6628, 1: 5420})

Epoch :  44 loss training:  2.8311689245456364 Time :  19893
accuracy train: 0.999313 val: 0.930150 test: 0.850637
max validation accuracy : 0.932803 max acc epoch : 36 test accuracy : 0.849310
Counter({2: 6805, 0: 6605, 1: 5436})

Epoch :  45 loss training:  3.4502960393729154 Time :  20021
accuracy train: 0.999313 val: 0.931034 test: 0.853691
max validation accuracy : 0.932803 max acc epoch : 36 test accuracy : 0.849310
Counter({1: 6888, 2: 6598, 0: 5360})

Epoch :  46 loss training:  3.4426943461294286 Time :  20163
accuracy train: 0.999411 val: 0.930150 test: 0.853824
max validation accuracy : 0.932803 max acc epoch : 36 test accuracy : 0.849310
Counter({1: 6844, 2: 6659, 0: 5343})

Epoch :  47 loss training:  3.2174041374528315 Time :  20326
accuracy train: 0.999411 val: 0.931919 test: 0.852629
max validation accuracy : 0.932803 max acc epoch : 36 test accuracy : 0.849310
Counter({0: 6858, 2: 6649, 1: 5339})

Epoch :  48 loss training:  2.902037745108828 Time :  20460
accuracy train: 0.999411 val: 0.931034 test: 0.850637
max validation accuracy : 0.932803 max acc epoch : 36 test accuracy : 0.849310
Counter({0: 6825, 2: 6659, 1: 5362})

Epoch :  49 loss training:  2.825609500941937 Time :  20599
accuracy train: 0.999411 val: 0.937224 test: 0.852496
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({2: 6857, 0: 6629, 1: 5360})

Epoch :  50 loss training:  2.4978479734745633 Time :  20736
accuracy train: 0.999411 val: 0.935455 test: 0.855417
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({2: 6867, 1: 6642, 0: 5337})

Epoch :  51 loss training:  3.0329680949798785 Time :  20886
accuracy train: 0.999313 val: 0.932803 test: 0.854355
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({2: 6831, 0: 6648, 1: 5367})

Epoch :  52 loss training:  1.803647268228815 Time :  21019
accuracy train: 0.999313 val: 0.936340 test: 0.853824
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({0: 6880, 1: 6585, 2: 5381})

Epoch :  53 loss training:  1.9609890775609529 Time :  21151
accuracy train: 0.999509 val: 0.933687 test: 0.854886
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({2: 6891, 0: 6633, 1: 5322})

Epoch :  54 loss training:  2.5725170749647077 Time :  21298
accuracy train: 0.999411 val: 0.933687 test: 0.856346
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({2: 6849, 0: 6650, 1: 5347})

Epoch :  55 loss training:  2.6560430841345806 Time :  21443
accuracy train: 0.999509 val: 0.926614 test: 0.853558
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({0: 6880, 1: 6641, 2: 5325})

Epoch :  56 loss training:  2.3917282165712095 Time :  21571
accuracy train: 0.999411 val: 0.928382 test: 0.852230
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({2: 6820, 1: 6595, 0: 5431})

Epoch :  57 loss training:  1.8095021244080272 Time :  21695
accuracy train: 0.999411 val: 0.935455 test: 0.852230
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({2: 6714, 0: 6658, 1: 5474})

Epoch :  58 loss training:  1.9312679336944711 Time :  21825
accuracy train: 0.999509 val: 0.935455 test: 0.854222
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({2: 6714, 1: 6656, 0: 5476})

Epoch :  59 loss training:  1.9952629264334973 Time :  21975
accuracy train: 0.999411 val: 0.931919 test: 0.853425
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({1: 6782, 2: 6617, 0: 5447})

Epoch :  60 loss training:  2.9191432201332645 Time :  22120
accuracy train: 0.999509 val: 0.933687 test: 0.851567
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({0: 6861, 1: 6577, 2: 5408})

Epoch :  61 loss training:  1.1936502123171522 Time :  22248
accuracy train: 0.999411 val: 0.924845 test: 0.853160
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({0: 6875, 1: 6576, 2: 5395})

Epoch :  62 loss training:  2.194894461557851 Time :  22378
accuracy train: 0.999411 val: 0.931034 test: 0.854753
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({1: 6872, 2: 6573, 0: 5401})

Epoch :  63 loss training:  1.6276393651896797 Time :  22523
accuracy train: 0.999509 val: 0.927498 test: 0.856479
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({2: 6848, 0: 6547, 1: 5451})

Epoch :  64 loss training:  1.8778999380665482 Time :  22681
accuracy train: 0.999411 val: 0.930150 test: 0.855948
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({0: 6867, 2: 6475, 1: 5504})

Epoch :  65 loss training:  2.089067706659989 Time :  22817
accuracy train: 0.999411 val: 0.936340 test: 0.854753
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({0: 7044, 2: 6471, 1: 5331})

Epoch :  66 loss training:  1.568536772778316 Time :  22946
accuracy train: 0.999411 val: 0.931034 test: 0.854355
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({0: 6928, 2: 6489, 1: 5429})

Epoch :  67 loss training:  1.3241181461708038 Time :  23078
accuracy train: 0.999509 val: 0.929266 test: 0.854222
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({2: 6821, 0: 6545, 1: 5480})

Epoch :  68 loss training:  0.9829753632438951 Time :  23233
accuracy train: 0.999411 val: 0.934571 test: 0.855151
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({2: 6878, 1: 6591, 0: 5377})

Epoch :  69 loss training:  1.5675413698390912 Time :  23365
accuracy train: 0.999411 val: 0.932803 test: 0.853956
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({2: 6823, 1: 6640, 0: 5383})

Epoch :  70 loss training:  1.7984697307565511 Time :  23490
accuracy train: 0.999411 val: 0.927498 test: 0.854753
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({1: 7317, 0: 6245, 2: 5284})

Epoch :  71 loss training:  1.9679745595240092 Time :  23639
accuracy train: 0.999411 val: 0.932803 test: 0.849708
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({1: 7323, 0: 6261, 2: 5262})

Epoch :  72 loss training:  1.4883260037568107 Time :  23776
accuracy train: 0.999411 val: 0.931919 test: 0.855550
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({2: 7306, 0: 6287, 1: 5253})

Epoch :  73 loss training:  1.3803815708179172 Time :  23905
accuracy train: 0.999411 val: 0.933687 test: 0.854488
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({0: 6946, 2: 6619, 1: 5281})

Epoch :  74 loss training:  1.4167638339713449 Time :  24062
accuracy train: 0.999607 val: 0.934571 test: 0.854355
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({0: 6989, 2: 6647, 1: 5210})

Epoch :  75 loss training:  1.1748526910841974 Time :  24202
accuracy train: 0.999509 val: 0.928382 test: 0.855019
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({1: 7379, 0: 6285, 2: 5182})

Epoch :  76 loss training:  1.0192503282105463 Time :  24331
accuracy train: 0.999607 val: 0.931034 test: 0.853956
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({0: 7367, 1: 6306, 2: 5173})

Epoch :  77 loss training:  1.1234961602840485 Time :  24497
accuracy train: 0.999509 val: 0.931919 test: 0.857276
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({0: 6924, 1: 6687, 2: 5235})

Epoch :  78 loss training:  1.2866825942983269 Time :  24628
accuracy train: 0.999411 val: 0.929266 test: 0.857674
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({0: 6896, 1: 6608, 2: 5342})

Epoch :  79 loss training:  1.3346435441835638 Time :  24755
accuracy train: 0.999411 val: 0.930150 test: 0.857408
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({0: 6902, 1: 6665, 2: 5279})

Epoch :  80 loss training:  1.2066880698212117 Time :  24885
accuracy train: 0.999411 val: 0.936340 test: 0.859931
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.852496
Counter({1: 6933, 2: 6678, 0: 5235})

========================================================================================================================================================================================================
best acc epoch :  49
validation accuracy :  0.9372236958443855
test accuracy :  0.8524960169941582
last test_accuracy :  0.8599309612320765
second best val :  0.9363395225464191
second best test :  0.8524960169941582
max gap 13
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=224, tsne=True, weight_decay=0)
device :  cuda:0
Counter({1: 7614, 2: 6358, 0: 4874})

Epoch :  1 loss training:  348.45101046562195 Time :  25585
accuracy train: 0.790140 val: 0.755968 test: 0.707913
max validation accuracy : 0.755968 max acc epoch : 1 test accuracy : 0.707913
Counter({2: 7688, 0: 6810, 1: 4348})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  207.7212539166212 Time :  25717
accuracy train: 0.834725 val: 0.796640 test: 0.751062
max validation accuracy : 0.796640 max acc epoch : 2 test accuracy : 0.751062
Counter({2: 9103, 0: 7729, 1: 2014})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  179.81423807144165 Time :  25841
accuracy train: 0.875970 val: 0.824934 test: 0.768720
max validation accuracy : 0.824934 max acc epoch : 3 test accuracy : 0.768720
Counter({2: 9350, 1: 7495, 0: 2001})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  134.67357190698385 Time :  25972
accuracy train: 0.907787 val: 0.854111 test: 0.792618
max validation accuracy : 0.854111 max acc epoch : 4 test accuracy : 0.792618
Counter({0: 9212, 1: 7636, 2: 1998})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  122.43668171018362 Time :  26100
accuracy train: 0.913090 val: 0.850575 test: 0.795273
max validation accuracy : 0.854111 max acc epoch : 4 test accuracy : 0.792618
Counter({1: 9591, 0: 7259, 2: 1996})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  113.37406302988529 Time :  26228
accuracy train: 0.921143 val: 0.863837 test: 0.800850
max validation accuracy : 0.863837 max acc epoch : 6 test accuracy : 0.800850
Counter({1: 9701, 0: 7138, 2: 2007})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  94.90191841870546 Time :  26355
accuracy train: 0.936954 val: 0.872679 test: 0.810143
max validation accuracy : 0.872679 max acc epoch : 7 test accuracy : 0.810143
Counter({0: 9512, 1: 7329, 2: 2005})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  89.95994192361832 Time :  26480
accuracy train: 0.937936 val: 0.873563 test: 0.809480
max validation accuracy : 0.873563 max acc epoch : 8 test accuracy : 0.809480
Counter({2: 9451, 1: 7391, 0: 2004})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  85.43775974214077 Time :  26625
accuracy train: 0.953354 val: 0.879752 test: 0.817047
max validation accuracy : 0.879752 max acc epoch : 9 test accuracy : 0.817047
Counter({1: 9483, 0: 7367, 2: 1996})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  76.76525905542076 Time :  26781
accuracy train: 0.952077 val: 0.882405 test: 0.815720
max validation accuracy : 0.882405 max acc epoch : 10 test accuracy : 0.815720
Counter({0: 6677, 1: 6428, 2: 5741})

Epoch :  11 loss training:  74.43770476058125 Time :  26913
accuracy train: 0.959246 val: 0.885057 test: 0.815454
max validation accuracy : 0.885057 max acc epoch : 11 test accuracy : 0.815454
Counter({2: 9818, 1: 7022, 0: 2006})

Epoch :  12 loss training:  65.63051113113761 Time :  27055
accuracy train: 0.963861 val: 0.888594 test: 0.823287
max validation accuracy : 0.888594 max acc epoch : 12 test accuracy : 0.823287
Counter({1: 9787, 0: 7052, 2: 2007})

Epoch :  13 loss training:  59.76972313597798 Time :  27198
accuracy train: 0.970441 val: 0.893899 test: 0.825544
max validation accuracy : 0.893899 max acc epoch : 13 test accuracy : 0.825544
Counter({1: 9854, 0: 6985, 2: 2007})

Epoch :  14 loss training:  53.40615360625088 Time :  27346
accuracy train: 0.976431 val: 0.890363 test: 0.825013
max validation accuracy : 0.893899 max acc epoch : 13 test accuracy : 0.825544
Counter({1: 9811, 0: 7028, 2: 2007})

Epoch :  15 loss training:  47.548754593357444 Time :  27504
accuracy train: 0.980359 val: 0.896552 test: 0.831386
max validation accuracy : 0.896552 max acc epoch : 15 test accuracy : 0.831386
Counter({1: 9820, 0: 7019, 2: 2007})

Epoch :  16 loss training:  42.352670611813664 Time :  27635
accuracy train: 0.985564 val: 0.896552 test: 0.832847
max validation accuracy : 0.896552 max acc epoch : 15 test accuracy : 0.831386
Counter({0: 9876, 2: 6963, 1: 2007})

Epoch :  17 loss training:  38.074781481176615 Time :  27790
accuracy train: 0.987037 val: 0.897436 test: 0.834307
max validation accuracy : 0.897436 max acc epoch : 17 test accuracy : 0.834307
Counter({0: 9913, 2: 6929, 1: 2004})

Epoch :  18 loss training:  33.73468031361699 Time :  27927
accuracy train: 0.989885 val: 0.900088 test: 0.834041
max validation accuracy : 0.900088 max acc epoch : 18 test accuracy : 0.834041
Counter({0: 9892, 2: 6951, 1: 2003})

Epoch :  19 loss training:  31.14442699449137 Time :  28061
accuracy train: 0.993617 val: 0.900973 test: 0.837759
max validation accuracy : 0.900973 max acc epoch : 19 test accuracy : 0.837759
Counter({0: 9910, 2: 6936, 1: 2000})

Epoch :  20 loss training:  27.423591455444694 Time :  28218
accuracy train: 0.994697 val: 0.905393 test: 0.836564
max validation accuracy : 0.905393 max acc epoch : 20 test accuracy : 0.836564
Counter({0: 8893, 2: 7963, 1: 1990})

Epoch :  21 loss training:  23.99977342505008 Time :  28355
accuracy train: 0.995286 val: 0.911583 test: 0.839087
max validation accuracy : 0.911583 max acc epoch : 21 test accuracy : 0.839087
Counter({2: 9944, 1: 6910, 0: 1992})

Epoch :  22 loss training:  22.468445255421102 Time :  28513
accuracy train: 0.996170 val: 0.906278 test: 0.838555
max validation accuracy : 0.911583 max acc epoch : 21 test accuracy : 0.839087
Counter({0: 9000, 1: 7853, 2: 1993})

Epoch :  23 loss training:  20.665168984793127 Time :  28662
accuracy train: 0.997250 val: 0.910698 test: 0.842273
max validation accuracy : 0.911583 max acc epoch : 21 test accuracy : 0.839087
Counter({0: 9947, 2: 6906, 1: 1993})

Epoch :  24 loss training:  16.896153941983357 Time :  28827
accuracy train: 0.997643 val: 0.908046 test: 0.841742
max validation accuracy : 0.911583 max acc epoch : 21 test accuracy : 0.839087
Counter({2: 9944, 1: 6908, 0: 1994})

Epoch :  25 loss training:  14.628725736401975 Time :  28990
accuracy train: 0.997938 val: 0.909814 test: 0.842406
max validation accuracy : 0.911583 max acc epoch : 21 test accuracy : 0.839087
Counter({1: 9972, 2: 6881, 0: 1993})

Epoch :  26 loss training:  13.483958196360618 Time :  29154
accuracy train: 0.998134 val: 0.909814 test: 0.841344
max validation accuracy : 0.911583 max acc epoch : 21 test accuracy : 0.839087
Counter({1: 9932, 0: 6919, 2: 1995})

Epoch :  27 loss training:  12.001377445529215 Time :  29285
accuracy train: 0.999018 val: 0.915119 test: 0.843733
max validation accuracy : 0.915119 max acc epoch : 27 test accuracy : 0.843733
Counter({2: 8820, 1: 8029, 0: 1997})

Epoch :  28 loss training:  10.904960170388222 Time :  29457
accuracy train: 0.999116 val: 0.910698 test: 0.843335
max validation accuracy : 0.915119 max acc epoch : 27 test accuracy : 0.843733
Counter({1: 8819, 2: 8028, 0: 1999})

Epoch :  29 loss training:  10.067697602789849 Time :  29590
accuracy train: 0.999214 val: 0.907162 test: 0.844530
max validation accuracy : 0.915119 max acc epoch : 27 test accuracy : 0.843733
Counter({1: 9999, 2: 6847, 0: 2000})

Epoch :  30 loss training:  9.942661310895346 Time :  29725
accuracy train: 0.999411 val: 0.914235 test: 0.846787
max validation accuracy : 0.915119 max acc epoch : 27 test accuracy : 0.843733
Counter({1: 9965, 0: 6881, 2: 2000})

Epoch :  31 loss training:  8.750228700810112 Time :  29893
accuracy train: 0.999411 val: 0.917772 test: 0.846522
max validation accuracy : 0.917772 max acc epoch : 31 test accuracy : 0.846522
Counter({1: 9987, 0: 6859, 2: 2000})

Epoch :  32 loss training:  7.241652501747012 Time :  30030
accuracy train: 0.999313 val: 0.914235 test: 0.848513
max validation accuracy : 0.917772 max acc epoch : 31 test accuracy : 0.846522
Counter({1: 10004, 0: 6841, 2: 2001})

Epoch :  33 loss training:  6.888753318693489 Time :  30180
accuracy train: 0.999411 val: 0.916004 test: 0.846522
max validation accuracy : 0.917772 max acc epoch : 31 test accuracy : 0.846522
Counter({0: 9953, 2: 6895, 1: 1998})

Epoch :  34 loss training:  6.629478630260564 Time :  30330
accuracy train: 0.999509 val: 0.916888 test: 0.848779
max validation accuracy : 0.917772 max acc epoch : 31 test accuracy : 0.846522
Counter({2: 9978, 0: 6867, 1: 2001})

Epoch :  35 loss training:  5.262546369456686 Time :  30486
accuracy train: 0.999509 val: 0.916004 test: 0.849973
max validation accuracy : 0.917772 max acc epoch : 31 test accuracy : 0.846522
Counter({0: 10007, 2: 6838, 1: 2001})

Epoch :  36 loss training:  5.363065252720844 Time :  30625
accuracy train: 0.999313 val: 0.911583 test: 0.846787
max validation accuracy : 0.917772 max acc epoch : 31 test accuracy : 0.846522
Counter({2: 10052, 1: 6793, 0: 2001})

Epoch :  37 loss training:  4.615752769168466 Time :  30802
accuracy train: 0.999411 val: 0.919540 test: 0.852629
max validation accuracy : 0.919540 max acc epoch : 37 test accuracy : 0.852629
Counter({0: 10005, 1: 6842, 2: 1999})

Epoch :  38 loss training:  5.784279326733667 Time :  30949
accuracy train: 0.999411 val: 0.921309 test: 0.847716
max validation accuracy : 0.921309 max acc epoch : 38 test accuracy : 0.847716
Counter({0: 6790, 2: 6413, 1: 5643})

Epoch :  39 loss training:  4.467638801026624 Time :  31105
accuracy train: 0.999607 val: 0.918656 test: 0.851434
max validation accuracy : 0.921309 max acc epoch : 38 test accuracy : 0.847716
Counter({2: 7874, 0: 6429, 1: 4543})

Epoch :  40 loss training:  4.412353121675551 Time :  31239
accuracy train: 0.999509 val: 0.922193 test: 0.851168
max validation accuracy : 0.922193 max acc epoch : 40 test accuracy : 0.851168
Counter({2: 10199, 1: 6649, 0: 1998})

Epoch :  41 loss training:  3.6723923746903893 Time :  31403
accuracy train: 0.999411 val: 0.921309 test: 0.854355
max validation accuracy : 0.922193 max acc epoch : 40 test accuracy : 0.851168
Counter({0: 6899, 1: 6341, 2: 5606})

Epoch :  42 loss training:  4.158281150273979 Time :  31547
accuracy train: 0.999509 val: 0.921309 test: 0.850637
max validation accuracy : 0.922193 max acc epoch : 40 test accuracy : 0.851168
Counter({0: 6812, 1: 6218, 2: 5816})

Epoch :  43 loss training:  3.387038343207678 Time :  31678
accuracy train: 0.999509 val: 0.916004 test: 0.852098
max validation accuracy : 0.922193 max acc epoch : 40 test accuracy : 0.851168
Counter({0: 10293, 1: 6561, 2: 1992})

Epoch :  44 loss training:  3.42687982134521 Time :  31823
accuracy train: 0.999607 val: 0.921309 test: 0.852496
max validation accuracy : 0.922193 max acc epoch : 40 test accuracy : 0.851168
Counter({2: 10191, 1: 6671, 0: 1984})

Epoch :  45 loss training:  3.012928188254591 Time :  31973
accuracy train: 0.999509 val: 0.918656 test: 0.852629
max validation accuracy : 0.922193 max acc epoch : 40 test accuracy : 0.851168
Counter({1: 8831, 0: 8027, 2: 1988})

Epoch :  46 loss training:  2.9648461285687517 Time :  32122
accuracy train: 0.999509 val: 0.919540 test: 0.856479
max validation accuracy : 0.922193 max acc epoch : 40 test accuracy : 0.851168
Counter({2: 8816, 1: 8043, 0: 1987})

Epoch :  47 loss training:  2.972960297833197 Time :  32314
accuracy train: 0.999509 val: 0.921309 test: 0.856745
max validation accuracy : 0.922193 max acc epoch : 40 test accuracy : 0.851168
Counter({2: 6952, 1: 6285, 0: 5609})

Epoch :  48 loss training:  3.0910809339547995 Time :  32467
accuracy train: 0.999705 val: 0.918656 test: 0.852629
max validation accuracy : 0.922193 max acc epoch : 40 test accuracy : 0.851168
Counter({2: 10054, 1: 6806, 0: 1986})

Epoch :  49 loss training:  2.653219872896443 Time :  32657
accuracy train: 0.999705 val: 0.921309 test: 0.856346
max validation accuracy : 0.922193 max acc epoch : 40 test accuracy : 0.851168
Counter({2: 10139, 1: 6720, 0: 1987})

Epoch :  50 loss training:  2.8504500278650085 Time :  32830
accuracy train: 0.999607 val: 0.919540 test: 0.853824
max validation accuracy : 0.922193 max acc epoch : 40 test accuracy : 0.851168
Counter({0: 10190, 1: 6669, 2: 1987})

Epoch :  51 loss training:  2.4017547913827 Time :  32988
accuracy train: 0.999509 val: 0.921309 test: 0.856081
max validation accuracy : 0.922193 max acc epoch : 40 test accuracy : 0.851168
Counter({2: 10144, 1: 6714, 0: 1988})

Epoch :  52 loss training:  2.1968509198341053 Time :  33162
accuracy train: 0.999607 val: 0.917772 test: 0.855019
max validation accuracy : 0.922193 max acc epoch : 40 test accuracy : 0.851168
Counter({0: 10113, 1: 6744, 2: 1989})

Epoch :  53 loss training:  2.271582756729913 Time :  33316
accuracy train: 0.999607 val: 0.921309 test: 0.856479
max validation accuracy : 0.922193 max acc epoch : 40 test accuracy : 0.851168
Counter({1: 10238, 2: 6617, 0: 1991})

Epoch :  54 loss training:  2.0714720015384955 Time :  33500
accuracy train: 0.999509 val: 0.919540 test: 0.857010
max validation accuracy : 0.922193 max acc epoch : 40 test accuracy : 0.851168
Counter({1: 8654, 0: 8201, 2: 1991})

Epoch :  55 loss training:  1.5141692582838004 Time :  33675
accuracy train: 0.999607 val: 0.923961 test: 0.858072
max validation accuracy : 0.923961 max acc epoch : 55 test accuracy : 0.858072
Counter({2: 6986, 0: 6295, 1: 5565})

Epoch :  56 loss training:  1.8071901617659023 Time :  33865
accuracy train: 0.999509 val: 0.916888 test: 0.853425
max validation accuracy : 0.923961 max acc epoch : 55 test accuracy : 0.858072
Counter({2: 6997, 0: 6203, 1: 5646})

Epoch :  57 loss training:  1.8376484570471803 Time :  34025
accuracy train: 0.999509 val: 0.918656 test: 0.853160
max validation accuracy : 0.923961 max acc epoch : 55 test accuracy : 0.858072
Counter({0: 7058, 1: 6202, 2: 5586})

Epoch :  58 loss training:  2.5598189990996616 Time :  34194
accuracy train: 0.999607 val: 0.921309 test: 0.852629
max validation accuracy : 0.923961 max acc epoch : 55 test accuracy : 0.858072
Counter({0: 10062, 1: 6802, 2: 1982})

Epoch :  59 loss training:  1.796954581157479 Time :  34348
accuracy train: 0.999607 val: 0.919540 test: 0.855151
max validation accuracy : 0.923961 max acc epoch : 55 test accuracy : 0.858072
Counter({1: 10166, 2: 6702, 0: 1978})

Epoch :  60 loss training:  1.6924397530819988 Time :  34516
accuracy train: 0.999705 val: 0.922193 test: 0.855151
max validation accuracy : 0.923961 max acc epoch : 55 test accuracy : 0.858072
Counter({2: 10104, 0: 6765, 1: 1977})

Epoch :  61 loss training:  1.6853237933573837 Time :  34701
accuracy train: 0.999705 val: 0.922193 test: 0.849044
max validation accuracy : 0.923961 max acc epoch : 55 test accuracy : 0.858072
Counter({2: 10230, 0: 6639, 1: 1977})

Epoch :  62 loss training:  1.8048620394329191 Time :  34868
accuracy train: 0.999509 val: 0.917772 test: 0.858736
max validation accuracy : 0.923961 max acc epoch : 55 test accuracy : 0.858072
Counter({1: 10203, 2: 6667, 0: 1976})

Epoch :  63 loss training:  1.5046110582916299 Time :  35043
accuracy train: 0.999607 val: 0.925729 test: 0.855284
max validation accuracy : 0.925729 max acc epoch : 63 test accuracy : 0.855284
Counter({0: 7028, 2: 6226, 1: 5592})

Epoch :  64 loss training:  1.9146522276751057 Time :  35242
accuracy train: 0.999509 val: 0.926614 test: 0.859002
max validation accuracy : 0.926614 max acc epoch : 64 test accuracy : 0.859002
Counter({1: 10161, 0: 6704, 2: 1981})

Epoch :  65 loss training:  1.4474864192125096 Time :  35422
accuracy train: 0.999607 val: 0.925729 test: 0.852762
max validation accuracy : 0.926614 max acc epoch : 64 test accuracy : 0.859002
Counter({1: 6977, 0: 6207, 2: 5662})

Epoch :  66 loss training:  1.4095311765486258 Time :  35599
accuracy train: 0.999607 val: 0.925729 test: 0.857674
max validation accuracy : 0.926614 max acc epoch : 64 test accuracy : 0.859002
Counter({2: 10016, 1: 6849, 0: 1981})

Epoch :  67 loss training:  1.4056707779163844 Time :  35772
accuracy train: 0.999705 val: 0.929266 test: 0.858736
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({0: 6975, 2: 6146, 1: 5725})

Epoch :  68 loss training:  1.2836065547526232 Time :  35942
accuracy train: 0.999607 val: 0.928382 test: 0.857010
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({1: 10269, 2: 6596, 0: 1981})

Epoch :  69 loss training:  1.2357000701995275 Time :  36136
accuracy train: 0.999607 val: 0.926614 test: 0.856346
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({0: 10350, 1: 6509, 2: 1987})

Epoch :  70 loss training:  1.2868358484338387 Time :  36317
accuracy train: 0.999509 val: 0.927498 test: 0.856745
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({0: 6992, 1: 6017, 2: 5837})

Epoch :  71 loss training:  1.0323060178634478 Time :  36500
accuracy train: 0.999607 val: 0.925729 test: 0.858338
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({2: 10281, 1: 6579, 0: 1986})

Epoch :  72 loss training:  1.1817442199971993 Time :  36687
accuracy train: 0.999607 val: 0.925729 test: 0.854355
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({0: 10241, 1: 6619, 2: 1986})

Epoch :  73 loss training:  0.8282591465176665 Time :  36858
accuracy train: 0.999705 val: 0.926614 test: 0.857143
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({0: 6938, 1: 5961, 2: 5947})

Epoch :  74 loss training:  0.9550146235178545 Time :  37055
accuracy train: 0.999607 val: 0.928382 test: 0.852496
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({2: 10230, 0: 6635, 1: 1981})

Epoch :  75 loss training:  1.4074957476987038 Time :  37211
accuracy train: 0.999804 val: 0.926614 test: 0.848115
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({2: 6939, 1: 6004, 0: 5903})

Epoch :  76 loss training:  1.6228828919065563 Time :  37392
accuracy train: 0.999705 val: 0.923961 test: 0.849575
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({0: 10462, 2: 6397, 1: 1987})

Epoch :  77 loss training:  1.116806658983478 Time :  37580
accuracy train: 0.999607 val: 0.920424 test: 0.853824
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({1: 10266, 2: 6597, 0: 1983})

Epoch :  78 loss training:  0.9918699910813302 Time :  37754
accuracy train: 0.999705 val: 0.924845 test: 0.857674
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({1: 10268, 0: 6595, 2: 1983})

Epoch :  79 loss training:  1.1698071274186077 Time :  37947
accuracy train: 0.999607 val: 0.928382 test: 0.855948
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({1: 10354, 2: 6509, 0: 1983})

Epoch :  80 loss training:  1.030134948068735 Time :  38123
accuracy train: 0.999705 val: 0.925729 test: 0.854753
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({0: 10246, 1: 6617, 2: 1983})

Epoch :  81 loss training:  0.7938744474540727 Time :  38291
accuracy train: 0.999705 val: 0.922193 test: 0.855019
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({2: 8698, 0: 8165, 1: 1983})

Epoch :  82 loss training:  1.137767071115377 Time :  38472
accuracy train: 0.999705 val: 0.924845 test: 0.855948
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({1: 10125, 0: 6735, 2: 1986})

Epoch :  83 loss training:  0.6501778363817721 Time :  38639
accuracy train: 0.999705 val: 0.926614 test: 0.855682
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({0: 10148, 2: 6712, 1: 1986})

Epoch :  84 loss training:  1.0670612563444593 Time :  38831
accuracy train: 0.999705 val: 0.924845 test: 0.857939
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({0: 10124, 2: 6736, 1: 1986})

Epoch :  85 loss training:  0.8221725088696985 Time :  38986
accuracy train: 0.999705 val: 0.923077 test: 0.857939
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({0: 10130, 2: 6730, 1: 1986})

Epoch :  86 loss training:  0.8629910576783004 Time :  39150
accuracy train: 0.999705 val: 0.925729 test: 0.857408
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({2: 6964, 0: 5990, 1: 5892})

Epoch :  87 loss training:  1.0059457974548422 Time :  39333
accuracy train: 0.999705 val: 0.926614 test: 0.858471
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({1: 8807, 2: 8063, 0: 1976})

Epoch :  88 loss training:  1.2114157615069416 Time :  39516
accuracy train: 0.999705 val: 0.922193 test: 0.855948
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({1: 10043, 0: 6826, 2: 1977})

Epoch :  89 loss training:  0.9372292459484015 Time :  39718
accuracy train: 0.999705 val: 0.924845 test: 0.859931
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({1: 9996, 2: 6875, 0: 1975})

Epoch :  90 loss training:  1.061582483791426 Time :  39915
accuracy train: 0.999705 val: 0.923961 test: 0.861259
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({1: 8667, 0: 8203, 2: 1976})

Epoch :  91 loss training:  0.7458187920447017 Time :  40155
accuracy train: 0.999705 val: 0.923077 test: 0.859533
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({2: 9986, 1: 6883, 0: 1977})

Epoch :  92 loss training:  0.5274770700980298 Time :  40387
accuracy train: 0.999607 val: 0.925729 test: 0.859798
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({2: 6880, 1: 5998, 0: 5968})

Epoch :  93 loss training:  0.839145553308299 Time :  40611
accuracy train: 0.999705 val: 0.926614 test: 0.858471
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({2: 9966, 1: 6911, 0: 1969})

Epoch :  94 loss training:  0.8607245338589564 Time :  40803
accuracy train: 0.999705 val: 0.927498 test: 0.856081
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({0: 9911, 1: 6964, 2: 1971})

Epoch :  95 loss training:  0.7812426223836155 Time :  40985
accuracy train: 0.999705 val: 0.928382 test: 0.859134
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({1: 9633, 2: 7238, 0: 1975})

Epoch :  96 loss training:  0.8448889482606319 Time :  41239
accuracy train: 0.999804 val: 0.926614 test: 0.854620
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({2: 9003, 0: 7867, 1: 1976})

Epoch :  97 loss training:  1.1715122546374914 Time :  41488
accuracy train: 0.999705 val: 0.929266 test: 0.855550
max validation accuracy : 0.929266 max acc epoch : 67 test accuracy : 0.858736
Counter({1: 9628, 2: 7245, 0: 1973})

Epoch :  98 loss training:  1.1974421048480508 Time :  41685
accuracy train: 0.999804 val: 0.930150 test: 0.856213
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({1: 9642, 2: 7232, 0: 1972})

Epoch :  99 loss training:  1.1428813585152966 Time :  41901
accuracy train: 0.999705 val: 0.928382 test: 0.857939
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({0: 6986, 1: 5996, 2: 5864})

Epoch :  100 loss training:  0.9277139275782247 Time :  42063
accuracy train: 0.999705 val: 0.929266 test: 0.856877
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({2: 6860, 0: 5994, 1: 5992})

Epoch :  101 loss training:  0.7346547707388709 Time :  42246
accuracy train: 0.999705 val: 0.929266 test: 0.859267
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({1: 9966, 0: 6911, 2: 1969})

Epoch :  102 loss training:  0.5504174018324193 Time :  42435
accuracy train: 0.999804 val: 0.925729 test: 0.860860
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({1: 9641, 2: 7237, 0: 1968})

Epoch :  103 loss training:  0.6101058914155146 Time :  42697
accuracy train: 0.999705 val: 0.930150 test: 0.857541
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({0: 10195, 1: 6683, 2: 1968})

Epoch :  104 loss training:  0.950517391145695 Time :  42918
accuracy train: 0.999705 val: 0.930150 test: 0.856081
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({1: 8940, 0: 7937, 2: 1969})

Epoch :  105 loss training:  0.7021896420487792 Time :  43145
accuracy train: 0.999705 val: 0.927498 test: 0.857939
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({1: 8798, 0: 8079, 2: 1969})

Epoch :  106 loss training:  0.4698908047075747 Time :  43346
accuracy train: 0.999705 val: 0.928382 test: 0.858869
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({1: 10080, 2: 6797, 0: 1969})

Epoch :  107 loss training:  0.7628776145575102 Time :  43543
accuracy train: 0.999705 val: 0.923077 test: 0.859665
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({1: 10039, 0: 6838, 2: 1969})

Epoch :  108 loss training:  0.5116157723982724 Time :  43729
accuracy train: 0.999804 val: 0.925729 test: 0.856213
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({1: 9923, 0: 6955, 2: 1968})

Epoch :  109 loss training:  0.30304581711652645 Time :  43930
accuracy train: 0.999705 val: 0.930150 test: 0.859267
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({1: 9897, 0: 6981, 2: 1968})

Epoch :  110 loss training:  0.4615923654141625 Time :  44159
accuracy train: 0.999705 val: 0.921309 test: 0.854355
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({1: 9614, 0: 7264, 2: 1968})

Epoch :  111 loss training:  0.5951793844847089 Time :  44413
accuracy train: 0.999804 val: 0.925729 test: 0.860993
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({1: 9841, 0: 7036, 2: 1969})

Epoch :  112 loss training:  0.5758229297193793 Time :  44586
accuracy train: 0.999902 val: 0.921309 test: 0.857939
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({2: 6878, 0: 6026, 1: 5942})

Epoch :  113 loss training:  0.20787128134156774 Time :  44751
accuracy train: 0.999804 val: 0.923077 test: 0.858205
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({2: 6937, 0: 6012, 1: 5897})

Epoch :  114 loss training:  0.6500839633761188 Time :  44924
accuracy train: 0.999902 val: 0.922193 test: 0.855417
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({2: 6921, 0: 6068, 1: 5857})

Epoch :  115 loss training:  0.32195706267884816 Time :  45113
accuracy train: 0.999804 val: 0.925729 test: 0.855019
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({0: 10167, 2: 6709, 1: 1970})

Epoch :  116 loss training:  0.5841469543188396 Time :  45304
accuracy train: 0.999902 val: 0.927498 test: 0.860064
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({0: 10161, 2: 6715, 1: 1970})

Epoch :  117 loss training:  0.762065014460859 Time :  45458
accuracy train: 0.999804 val: 0.917772 test: 0.859533
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({0: 9515, 2: 7362, 1: 1969})

Epoch :  118 loss training:  0.6278489691676441 Time :  45627
accuracy train: 0.999804 val: 0.921309 test: 0.857674
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({0: 8598, 2: 8279, 1: 1969})

Epoch :  119 loss training:  0.5429049514864346 Time :  45789
accuracy train: 0.999705 val: 0.923077 test: 0.857010
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({1: 10134, 2: 6742, 0: 1970})

Epoch :  120 loss training:  0.9963852393509569 Time :  46016
accuracy train: 0.999902 val: 0.923077 test: 0.860329
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({0: 8624, 1: 8252, 2: 1970})

Epoch :  121 loss training:  0.9199810768527641 Time :  46298
accuracy train: 0.999902 val: 0.923961 test: 0.860462
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({0: 8687, 1: 8189, 2: 1970})

Epoch :  122 loss training:  0.5859426767178775 Time :  46519
accuracy train: 0.999804 val: 0.921309 test: 0.858471
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({0: 10246, 2: 6625, 1: 1975})

Epoch :  123 loss training:  0.37374553358267804 Time :  46752
accuracy train: 0.999804 val: 0.923961 test: 0.858338
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({0: 7048, 2: 5961, 1: 5837})

Epoch :  124 loss training:  0.6743923734711643 Time :  46992
accuracy train: 0.999705 val: 0.914235 test: 0.850505
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({0: 8490, 1: 8383, 2: 1973})

Epoch :  125 loss training:  0.3486106904238113 Time :  47227
accuracy train: 0.999705 val: 0.923961 test: 0.859931
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({0: 8701, 1: 8172, 2: 1973})

Epoch :  126 loss training:  0.5188288091899267 Time :  47450
accuracy train: 0.999902 val: 0.923961 test: 0.865374
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({0: 9705, 2: 7167, 1: 1974})

Epoch :  127 loss training:  0.5481593422114202 Time :  47676
accuracy train: 0.999804 val: 0.926614 test: 0.857408
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({0: 9704, 2: 7168, 1: 1974})

Epoch :  128 loss training:  0.9268861903424295 Time :  47933
accuracy train: 0.999902 val: 0.930150 test: 0.857408
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({2: 8743, 0: 8121, 1: 1982})

Epoch :  129 loss training:  0.7122568463432799 Time :  48169
accuracy train: 0.999804 val: 0.924845 test: 0.855151
max validation accuracy : 0.930150 max acc epoch : 98 test accuracy : 0.856213
Counter({1: 8632, 0: 8236, 2: 1978})

========================================================================================================================================================================================================
best acc epoch :  98
validation accuracy :  0.9301503094606542
test accuracy :  0.8562134891131173
last test_accuracy :  0.8551513542219862
second best val :  0.9292661361626879
second best test :  0.8587360594795539
max gap 31
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=383, tsne=True, weight_decay=0)
device :  cuda:0
slurmstepd: error: *** JOB 37404 ON cl-gpusrv1 CANCELLED AT 2021-06-15T14:14:50 ***
