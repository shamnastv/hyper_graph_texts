

date and time :  Sat Jul  3 00:14:27 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=314, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  41.613070864230394 Time :  19
accuracy train: 0.958939 val: 0.947879 test: 0.957534
max validation accuracy : 0.947879 max acc epoch : 1 test accuracy : 0.957534
Epoch-1 lr: 0.001

Epoch :  2 loss training:  22.14196839183569 Time :  29
accuracy train: 0.967494 val: 0.963636 test: 0.955251
max validation accuracy : 0.963636 max acc epoch : 2 test accuracy : 0.955251
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.28422027081251 Time :  40
accuracy train: 0.979683 val: 0.968485 test: 0.959361
max validation accuracy : 0.968485 max acc epoch : 3 test accuracy : 0.959361
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.268709331052378 Time :  51
accuracy train: 0.982678 val: 0.966061 test: 0.964840
max validation accuracy : 0.968485 max acc epoch : 3 test accuracy : 0.959361
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.112236197688617 Time :  62
accuracy train: 0.984816 val: 0.969697 test: 0.967123
max validation accuracy : 0.969697 max acc epoch : 5 test accuracy : 0.967123
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.310187761671841 Time :  73
accuracy train: 0.990376 val: 0.974545 test: 0.965297
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.162170023890212 Time :  83
accuracy train: 0.991873 val: 0.974545 test: 0.964384
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.547575750388205 Time :  94
accuracy train: 0.992729 val: 0.978182 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.968950
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.33161721524084 Time :  104
accuracy train: 0.993370 val: 0.975758 test: 0.967123
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.968950
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  6.189765723465825 Time :  114
accuracy train: 0.993584 val: 0.976970 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.968950

Epoch :  11 loss training:  5.21006750757806 Time :  125
accuracy train: 0.993584 val: 0.976970 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.968950

Epoch :  12 loss training:  4.827206261572428 Time :  136
accuracy train: 0.995295 val: 0.974545 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.968950

Epoch :  13 loss training:  4.383633783494588 Time :  146
accuracy train: 0.995509 val: 0.979394 test: 0.968493
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.968493

Epoch :  14 loss training:  4.0117540447972715 Time :  157
accuracy train: 0.995295 val: 0.978182 test: 0.966667
max validation accuracy : 0.979394 max acc epoch : 13 test accuracy : 0.968493

Epoch :  15 loss training:  3.0974129032110795 Time :  167
accuracy train: 0.995937 val: 0.981818 test: 0.968493
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  16 loss training:  4.2483001438668 Time :  178
accuracy train: 0.995937 val: 0.974545 test: 0.966667
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  17 loss training:  3.928870430623647 Time :  188
accuracy train: 0.995509 val: 0.973333 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  18 loss training:  3.149250930931885 Time :  199
accuracy train: 0.995937 val: 0.975758 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  19 loss training:  3.3141499012708664 Time :  209
accuracy train: 0.995723 val: 0.976970 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  20 loss training:  2.662112603225978 Time :  220
accuracy train: 0.996151 val: 0.976970 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  21 loss training:  2.8669014144688845 Time :  230
accuracy train: 0.996364 val: 0.974545 test: 0.967580
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  22 loss training:  2.882519486680394 Time :  240
accuracy train: 0.995937 val: 0.970909 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  23 loss training:  3.000593098186073 Time :  251
accuracy train: 0.996578 val: 0.972121 test: 0.965753
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  24 loss training:  2.9193263498018496 Time :  261
accuracy train: 0.996792 val: 0.976970 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  25 loss training:  2.748070361019927 Time :  272
accuracy train: 0.996578 val: 0.974545 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  26 loss training:  2.4853857797425007 Time :  282
accuracy train: 0.996151 val: 0.973333 test: 0.968493
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  27 loss training:  2.164173154931632 Time :  293
accuracy train: 0.996792 val: 0.979394 test: 0.966210
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  28 loss training:  3.24519950922695 Time :  303
accuracy train: 0.996792 val: 0.975758 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  29 loss training:  2.456429168669274 Time :  313
accuracy train: 0.996792 val: 0.973333 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  30 loss training:  2.336310408776626 Time :  324
accuracy train: 0.996792 val: 0.974545 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  31 loss training:  2.055695274932077 Time :  334
accuracy train: 0.996792 val: 0.975758 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  32 loss training:  2.1449715004710015 Time :  345
accuracy train: 0.996792 val: 0.972121 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  33 loss training:  1.9905042939062696 Time :  355
accuracy train: 0.996792 val: 0.974545 test: 0.968493
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  34 loss training:  1.8709152138471836 Time :  365
accuracy train: 0.996792 val: 0.978182 test: 0.968037
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  35 loss training:  2.1361118442873703 Time :  376
accuracy train: 0.997220 val: 0.978182 test: 0.968493
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  36 loss training:  2.1151572395465337 Time :  386
accuracy train: 0.996792 val: 0.976970 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  37 loss training:  1.6622087547293631 Time :  396
accuracy train: 0.996792 val: 0.975758 test: 0.966667
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  38 loss training:  2.5498709479288664 Time :  407
accuracy train: 0.996792 val: 0.975758 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  39 loss training:  2.169691673692796 Time :  417
accuracy train: 0.996792 val: 0.969697 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  40 loss training:  1.698057153262198 Time :  428
accuracy train: 0.996792 val: 0.978182 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  41 loss training:  1.9739489954445162 Time :  438
accuracy train: 0.996792 val: 0.976970 test: 0.968037
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  42 loss training:  1.5146079226869915 Time :  449
accuracy train: 0.997006 val: 0.976970 test: 0.964840
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  43 loss training:  1.579413254427891 Time :  461
accuracy train: 0.996792 val: 0.973333 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  44 loss training:  1.7546011246740818 Time :  472
accuracy train: 0.997006 val: 0.975758 test: 0.964384
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  45 loss training:  2.1229734017688315 Time :  484
accuracy train: 0.997006 val: 0.978182 test: 0.967123
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

Epoch :  46 loss training:  1.5141357919746952 Time :  495
accuracy train: 0.996792 val: 0.972121 test: 0.968037
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.968493

========================================================================================================================================================================================================
best acc epoch :  15
validation accuracy :  0.9818181818181818
test accuracy :  0.9684931506849315
last test_accuracy :  0.9680365296803652
second best val :  0.9793939393939394
second best test :  0.9684931506849315
max gap 5
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=647, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  41.18438966572285 Time :  507
accuracy train: 0.955731 val: 0.941818 test: 0.963014
max validation accuracy : 0.941818 max acc epoch : 1 test accuracy : 0.963014
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.549798855558038 Time :  517
accuracy train: 0.961292 val: 0.949091 test: 0.957534
max validation accuracy : 0.949091 max acc epoch : 2 test accuracy : 0.957534
Epoch-2 lr: 0.001

Epoch :  3 loss training:  17.49186533410102 Time :  528
accuracy train: 0.978614 val: 0.966061 test: 0.958904
max validation accuracy : 0.966061 max acc epoch : 3 test accuracy : 0.958904
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.447738007176667 Time :  540
accuracy train: 0.984816 val: 0.972121 test: 0.968493
max validation accuracy : 0.972121 max acc epoch : 4 test accuracy : 0.968493
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.909242707770318 Time :  551
accuracy train: 0.985672 val: 0.969697 test: 0.971689
max validation accuracy : 0.972121 max acc epoch : 4 test accuracy : 0.968493
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.070743002637755 Time :  562
accuracy train: 0.988666 val: 0.972121 test: 0.967123
max validation accuracy : 0.972121 max acc epoch : 4 test accuracy : 0.968493
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.505760714877397 Time :  573
accuracy train: 0.989735 val: 0.973333 test: 0.971689
max validation accuracy : 0.973333 max acc epoch : 7 test accuracy : 0.971689
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.266454971628264 Time :  585
accuracy train: 0.988879 val: 0.978182 test: 0.960731
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.3333673478337005 Time :  596
accuracy train: 0.991446 val: 0.976970 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  6.019446696271189 Time :  608
accuracy train: 0.991873 val: 0.973333 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  11 loss training:  5.654199527343735 Time :  620
accuracy train: 0.992943 val: 0.976970 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  12 loss training:  4.86779713165015 Time :  633
accuracy train: 0.994654 val: 0.974545 test: 0.964384
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  13 loss training:  4.9436656549805775 Time :  645
accuracy train: 0.994654 val: 0.973333 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  14 loss training:  4.446501113474369 Time :  657
accuracy train: 0.995509 val: 0.970909 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  15 loss training:  4.609604685509112 Time :  669
accuracy train: 0.996151 val: 0.974545 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  16 loss training:  3.8854927967768162 Time :  682
accuracy train: 0.995295 val: 0.968485 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  17 loss training:  3.943511977500748 Time :  694
accuracy train: 0.995295 val: 0.972121 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  18 loss training:  3.52791854145471 Time :  706
accuracy train: 0.996151 val: 0.973333 test: 0.966667
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  19 loss training:  3.3488417379558086 Time :  718
accuracy train: 0.995723 val: 0.972121 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  20 loss training:  3.2329015930881724 Time :  730
accuracy train: 0.995937 val: 0.968485 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  21 loss training:  3.4001414271770045 Time :  742
accuracy train: 0.995509 val: 0.967273 test: 0.966210
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  22 loss training:  2.9612992389593273 Time :  754
accuracy train: 0.995937 val: 0.967273 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  23 loss training:  3.0933329734543804 Time :  766
accuracy train: 0.996792 val: 0.968485 test: 0.966210
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  24 loss training:  3.0354188426572364 Time :  778
accuracy train: 0.996578 val: 0.972121 test: 0.964384
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  25 loss training:  2.45454569242429 Time :  791
accuracy train: 0.996151 val: 0.970909 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  26 loss training:  2.4966521101014223 Time :  803
accuracy train: 0.996792 val: 0.973333 test: 0.965297
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  27 loss training:  2.446229881272302 Time :  815
accuracy train: 0.995509 val: 0.973333 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  28 loss training:  2.5427234818635043 Time :  826
accuracy train: 0.996364 val: 0.972121 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  29 loss training:  2.2912985967996065 Time :  838
accuracy train: 0.996578 val: 0.972121 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  30 loss training:  2.2624447526904987 Time :  851
accuracy train: 0.996578 val: 0.968485 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  31 loss training:  2.3352514566940954 Time :  863
accuracy train: 0.997006 val: 0.973333 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  32 loss training:  1.976671660784632 Time :  876
accuracy train: 0.996578 val: 0.974545 test: 0.964840
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  33 loss training:  2.0130851815702044 Time :  887
accuracy train: 0.996792 val: 0.970909 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  34 loss training:  2.1169575780950254 Time :  899
accuracy train: 0.996578 val: 0.968485 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  35 loss training:  2.1124811386544025 Time :  911
accuracy train: 0.996792 val: 0.972121 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  36 loss training:  1.7835986641221098 Time :  923
accuracy train: 0.996792 val: 0.972121 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  37 loss training:  1.6311379687831504 Time :  935
accuracy train: 0.997220 val: 0.974545 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  38 loss training:  2.0483862523251446 Time :  947
accuracy train: 0.997006 val: 0.968485 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

Epoch :  39 loss training:  2.0552570914733224 Time :  960
accuracy train: 0.996792 val: 0.967273 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.960731

========================================================================================================================================================================================================
best acc epoch :  8
validation accuracy :  0.9781818181818182
test accuracy :  0.960730593607306
last test_accuracy :  0.9698630136986301
second best val :  0.9769696969696969
second best test :  0.960730593607306
max gap 3
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  15 	 val_accuracy : 0.98182 	 test_accuracy : 0.96849 	 last test_accuracy : 0.96804 	 second best val : 0.97939 	 second best test : 0.96849
k :  1 	 best_acc epoch :  8 	 val_accuracy : 0.97818 	 test_accuracy : 0.96073 	 last test_accuracy : 0.96986 	 second best val : 0.97697 	 second best test : 0.96073

avg :  	 val_accuracy : 0.98000 	 test_accuracy : 0.96461 	 last_accuracy : 0.96895 	 second best val : 0.97818 	 second best test : 0.96461

std :  	 val_accuracy : 0.00182 	 test_accuracy : 0.00388 	 last_accuracy : 0.00091 	 second best val : 0.00121 	 second best test : 0.00388


date and time :  Sat Jul  3 00:30:36 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=136, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  41.539847522974014 Time :  13
accuracy train: 0.936912 val: 0.927273 test: 0.937443
max validation accuracy : 0.927273 max acc epoch : 1 test accuracy : 0.937443
Epoch-1 lr: 0.001

Epoch :  2 loss training:  20.005080852657557 Time :  27
accuracy train: 0.966424 val: 0.947879 test: 0.951142
max validation accuracy : 0.947879 max acc epoch : 2 test accuracy : 0.951142
Epoch-2 lr: 0.001

Epoch :  3 loss training:  17.14765107445419 Time :  41
accuracy train: 0.975192 val: 0.958788 test: 0.963927
max validation accuracy : 0.958788 max acc epoch : 3 test accuracy : 0.963927
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.418152505531907 Time :  54
accuracy train: 0.984602 val: 0.966061 test: 0.963014
max validation accuracy : 0.966061 max acc epoch : 4 test accuracy : 0.963014
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.869682034710422 Time :  68
accuracy train: 0.986741 val: 0.964848 test: 0.971233
max validation accuracy : 0.966061 max acc epoch : 4 test accuracy : 0.963014
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.12603054754436 Time :  81
accuracy train: 0.978400 val: 0.950303 test: 0.962557
max validation accuracy : 0.966061 max acc epoch : 4 test accuracy : 0.963014
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.400432842085138 Time :  95
accuracy train: 0.990804 val: 0.966061 test: 0.964840
max validation accuracy : 0.966061 max acc epoch : 4 test accuracy : 0.963014
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.631654591998085 Time :  109
accuracy train: 0.989735 val: 0.966061 test: 0.968037
max validation accuracy : 0.966061 max acc epoch : 4 test accuracy : 0.963014
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.175153520453023 Time :  123
accuracy train: 0.991232 val: 0.968485 test: 0.969863
max validation accuracy : 0.968485 max acc epoch : 9 test accuracy : 0.969863
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.494860079837963 Time :  137
accuracy train: 0.992943 val: 0.969697 test: 0.969863
max validation accuracy : 0.969697 max acc epoch : 10 test accuracy : 0.969863

Epoch :  11 loss training:  5.253147554991301 Time :  151
accuracy train: 0.993370 val: 0.978182 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  12 loss training:  4.89388863084605 Time :  166
accuracy train: 0.994654 val: 0.970909 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  13 loss training:  4.494204063201323 Time :  181
accuracy train: 0.995081 val: 0.968485 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  14 loss training:  4.425509800959844 Time :  194
accuracy train: 0.995723 val: 0.972121 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  15 loss training:  3.514153439900838 Time :  208
accuracy train: 0.995509 val: 0.975758 test: 0.965753
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  16 loss training:  3.661541049950756 Time :  223
accuracy train: 0.995295 val: 0.969697 test: 0.963927
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  17 loss training:  4.0804111853503855 Time :  237
accuracy train: 0.995295 val: 0.962424 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  18 loss training:  3.5940986021596473 Time :  252
accuracy train: 0.996792 val: 0.974545 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  19 loss training:  3.416380269045476 Time :  267
accuracy train: 0.996578 val: 0.972121 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  20 loss training:  3.060201749613043 Time :  282
accuracy train: 0.995723 val: 0.966061 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  21 loss training:  3.2010801252909005 Time :  297
accuracy train: 0.996578 val: 0.972121 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  22 loss training:  2.8884048396430444 Time :  310
accuracy train: 0.996578 val: 0.975758 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  23 loss training:  2.6472123329294845 Time :  324
accuracy train: 0.996792 val: 0.973333 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  24 loss training:  2.364706370368367 Time :  339
accuracy train: 0.996792 val: 0.972121 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  25 loss training:  2.1832217147457413 Time :  353
accuracy train: 0.997006 val: 0.973333 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  26 loss training:  2.48844188721705 Time :  368
accuracy train: 0.997434 val: 0.968485 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  27 loss training:  2.085018634694279 Time :  383
accuracy train: 0.997006 val: 0.973333 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  28 loss training:  1.966339656704804 Time :  397
accuracy train: 0.997220 val: 0.972121 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  29 loss training:  1.9995113810291514 Time :  412
accuracy train: 0.997220 val: 0.969697 test: 0.967123
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  30 loss training:  1.8714752537634922 Time :  427
accuracy train: 0.997220 val: 0.973333 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  31 loss training:  2.1594737138366327 Time :  441
accuracy train: 0.997648 val: 0.972121 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  32 loss training:  2.237340255989693 Time :  454
accuracy train: 0.997434 val: 0.967273 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  33 loss training:  2.1813099158898694 Time :  467
accuracy train: 0.997220 val: 0.968485 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  34 loss training:  1.8151582724967739 Time :  481
accuracy train: 0.997220 val: 0.970909 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  35 loss training:  1.6384837809491728 Time :  496
accuracy train: 0.997861 val: 0.968485 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  36 loss training:  1.5534283304514247 Time :  511
accuracy train: 0.997220 val: 0.973333 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  37 loss training:  1.648811712526367 Time :  525
accuracy train: 0.997220 val: 0.972121 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  38 loss training:  1.5280932485111407 Time :  540
accuracy train: 0.997434 val: 0.969697 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  39 loss training:  1.4476032854799996 Time :  556
accuracy train: 0.998075 val: 0.972121 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  40 loss training:  1.5037285826583684 Time :  571
accuracy train: 0.997861 val: 0.966061 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  41 loss training:  1.4067075059356284 Time :  584
accuracy train: 0.998075 val: 0.967273 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

Epoch :  42 loss training:  1.3706030053799623 Time :  598
accuracy train: 0.997434 val: 0.970909 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.968037

========================================================================================================================================================================================================
best acc epoch :  11
validation accuracy :  0.9781818181818182
test accuracy :  0.9680365296803652
last test_accuracy :  0.971689497716895
second best val :  0.9757575757575757
second best test :  0.9680365296803652
max gap 5
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=841, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  44.96755864471197 Time :  612
accuracy train: 0.917451 val: 0.905455 test: 0.900913
max validation accuracy : 0.905455 max acc epoch : 1 test accuracy : 0.900913
Epoch-1 lr: 0.001

Epoch :  2 loss training:  20.322053627111018 Time :  624
accuracy train: 0.969204 val: 0.963636 test: 0.952511
max validation accuracy : 0.963636 max acc epoch : 2 test accuracy : 0.952511
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.77922701695934 Time :  637
accuracy train: 0.960650 val: 0.956364 test: 0.961644
max validation accuracy : 0.963636 max acc epoch : 2 test accuracy : 0.952511
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.817883747862652 Time :  650
accuracy train: 0.981394 val: 0.969697 test: 0.960731
max validation accuracy : 0.969697 max acc epoch : 4 test accuracy : 0.960731
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.225314161740243 Time :  662
accuracy train: 0.983533 val: 0.972121 test: 0.967580
max validation accuracy : 0.972121 max acc epoch : 5 test accuracy : 0.967580
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.25772395893 Time :  674
accuracy train: 0.988879 val: 0.978182 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 6 test accuracy : 0.968037
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.805944110266864 Time :  686
accuracy train: 0.990804 val: 0.973333 test: 0.966210
max validation accuracy : 0.978182 max acc epoch : 6 test accuracy : 0.968037
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.07468374480959 Time :  697
accuracy train: 0.989949 val: 0.976970 test: 0.960274
max validation accuracy : 0.978182 max acc epoch : 6 test accuracy : 0.968037
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.474861300899647 Time :  709
accuracy train: 0.991232 val: 0.979394 test: 0.967580
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  6.218171020271257 Time :  721
accuracy train: 0.992301 val: 0.974545 test: 0.967123
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  11 loss training:  5.426310466835275 Time :  734
accuracy train: 0.992301 val: 0.970909 test: 0.965753
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  12 loss training:  4.815979993989458 Time :  746
accuracy train: 0.992301 val: 0.975758 test: 0.968950
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  13 loss training:  4.861032449174672 Time :  759
accuracy train: 0.993370 val: 0.973333 test: 0.968950
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  14 loss training:  4.393239801516756 Time :  771
accuracy train: 0.994440 val: 0.978182 test: 0.972146
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  15 loss training:  4.245764521532692 Time :  784
accuracy train: 0.994226 val: 0.972121 test: 0.973059
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  16 loss training:  4.520555702794809 Time :  798
accuracy train: 0.995723 val: 0.976970 test: 0.970776
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  17 loss training:  3.269668369553983 Time :  812
accuracy train: 0.995081 val: 0.978182 test: 0.975342
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  18 loss training:  3.7069498603232205 Time :  826
accuracy train: 0.995937 val: 0.974545 test: 0.974429
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  19 loss training:  3.4733779898379 Time :  839
accuracy train: 0.995723 val: 0.975758 test: 0.970776
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  20 loss training:  3.2448261636673124 Time :  852
accuracy train: 0.995723 val: 0.972121 test: 0.974429
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  21 loss training:  3.0117880743346177 Time :  865
accuracy train: 0.995723 val: 0.975758 test: 0.966210
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  22 loss training:  2.4452174348116387 Time :  879
accuracy train: 0.996792 val: 0.975758 test: 0.970320
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  23 loss training:  2.529108657647157 Time :  892
accuracy train: 0.996578 val: 0.970909 test: 0.973973
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  24 loss training:  2.6339475580025464 Time :  905
accuracy train: 0.996792 val: 0.973333 test: 0.973516
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  25 loss training:  2.584673706733156 Time :  918
accuracy train: 0.996792 val: 0.978182 test: 0.971233
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  26 loss training:  2.3681262020545546 Time :  931
accuracy train: 0.994867 val: 0.975758 test: 0.961644
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  27 loss training:  2.1951621839834843 Time :  944
accuracy train: 0.996792 val: 0.969697 test: 0.974886
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  28 loss training:  2.273976856689842 Time :  958
accuracy train: 0.997006 val: 0.973333 test: 0.968037
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  29 loss training:  2.3925276605586987 Time :  970
accuracy train: 0.996578 val: 0.974545 test: 0.963470
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  30 loss training:  2.3699154940841254 Time :  983
accuracy train: 0.997434 val: 0.974545 test: 0.965297
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  31 loss training:  1.9899473837431287 Time :  996
accuracy train: 0.997434 val: 0.970909 test: 0.967580
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  32 loss training:  2.1047533141900203 Time :  1009
accuracy train: 0.996792 val: 0.972121 test: 0.969406
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  33 loss training:  1.7898678138008108 Time :  1021
accuracy train: 0.997006 val: 0.973333 test: 0.970320
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  34 loss training:  1.8029450647736667 Time :  1034
accuracy train: 0.997006 val: 0.975758 test: 0.970776
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  35 loss training:  1.7005534072523005 Time :  1047
accuracy train: 0.997006 val: 0.974545 test: 0.971689
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  36 loss training:  1.5441788366770197 Time :  1059
accuracy train: 0.996792 val: 0.976970 test: 0.969863
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  37 loss training:  1.583255165245646 Time :  1072
accuracy train: 0.997648 val: 0.970909 test: 0.972146
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  38 loss training:  1.8635761547702714 Time :  1084
accuracy train: 0.996792 val: 0.973333 test: 0.971233
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  39 loss training:  1.8701348645745384 Time :  1097
accuracy train: 0.997434 val: 0.974545 test: 0.971233
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

Epoch :  40 loss training:  1.8612402893340914 Time :  1110
accuracy train: 0.997220 val: 0.974545 test: 0.971689
max validation accuracy : 0.979394 max acc epoch : 9 test accuracy : 0.967580

========================================================================================================================================================================================================
best acc epoch :  9
validation accuracy :  0.9793939393939394
test accuracy :  0.9675799086757991
last test_accuracy :  0.971689497716895
second best val :  0.9781818181818182
second best test :  0.9680365296803652
max gap 3
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  11 	 val_accuracy : 0.97818 	 test_accuracy : 0.96804 	 last test_accuracy : 0.97169 	 second best val : 0.97576 	 second best test : 0.96804
k :  1 	 best_acc epoch :  9 	 val_accuracy : 0.97939 	 test_accuracy : 0.96758 	 last test_accuracy : 0.97169 	 second best val : 0.97818 	 second best test : 0.96804

avg :  	 val_accuracy : 0.97879 	 test_accuracy : 0.96781 	 last_accuracy : 0.97169 	 second best val : 0.97697 	 second best test : 0.96804

std :  	 val_accuracy : 0.00061 	 test_accuracy : 0.00023 	 last_accuracy : 0.00000 	 second best val : 0.00121 	 second best test : 0.00000


date and time :  Sat Jul  3 00:49:16 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=566, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 4723, 0: 2968})

Epoch :  1 loss training:  39.50669725239277 Time :  16
accuracy train: 0.956159 val: 0.936970 test: 0.956164
max validation accuracy : 0.936970 max acc epoch : 1 test accuracy : 0.956164
Counter({0: 4078, 1: 3613})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  20.22667217068374 Time :  31
accuracy train: 0.950171 val: 0.932121 test: 0.959817
max validation accuracy : 0.936970 max acc epoch : 1 test accuracy : 0.956164
Counter({1: 3994, 0: 3697})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.84448494296521 Time :  46
accuracy train: 0.969846 val: 0.951515 test: 0.966210
max validation accuracy : 0.951515 max acc epoch : 3 test accuracy : 0.966210
Counter({0: 3918, 1: 3773})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.158486504224129 Time :  61
accuracy train: 0.984175 val: 0.968485 test: 0.966210
max validation accuracy : 0.968485 max acc epoch : 4 test accuracy : 0.966210
Counter({1: 3890, 0: 3801})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.79634948587045 Time :  76
accuracy train: 0.984602 val: 0.973333 test: 0.957534
max validation accuracy : 0.973333 max acc epoch : 5 test accuracy : 0.957534
Counter({0: 3891, 1: 3800})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.901403345167637 Time :  91
accuracy train: 0.983747 val: 0.963636 test: 0.970320
max validation accuracy : 0.973333 max acc epoch : 5 test accuracy : 0.957534
Counter({1: 3901, 0: 3790})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.800686207367107 Time :  107
accuracy train: 0.988879 val: 0.969697 test: 0.968493
max validation accuracy : 0.973333 max acc epoch : 5 test accuracy : 0.957534
Counter({0: 3874, 1: 3817})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  7.178529556025751 Time :  122
accuracy train: 0.991232 val: 0.975758 test: 0.964840
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({1: 3860, 0: 3831})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.8963098775129765 Time :  137
accuracy train: 0.990376 val: 0.973333 test: 0.966210
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({0: 3849, 1: 3842})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.804392995778471 Time :  152
accuracy train: 0.994012 val: 0.972121 test: 0.967123
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({1: 3857, 0: 3834})

Epoch :  11 loss training:  5.219296660623513 Time :  168
accuracy train: 0.994012 val: 0.970909 test: 0.966667
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({0: 3858, 1: 3833})

Epoch :  12 loss training:  4.50986280530924 Time :  185
accuracy train: 0.995295 val: 0.973333 test: 0.968037
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({1: 3872, 0: 3819})

Epoch :  13 loss training:  4.401973414118402 Time :  201
accuracy train: 0.994867 val: 0.974545 test: 0.966667
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({1: 3872, 0: 3819})

Epoch :  14 loss training:  3.883056648191996 Time :  218
accuracy train: 0.994226 val: 0.970909 test: 0.973973
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({0: 3872, 1: 3819})

Epoch :  15 loss training:  3.6776635735295713 Time :  235
accuracy train: 0.995295 val: 0.970909 test: 0.971689
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({1: 3876, 0: 3815})

Epoch :  16 loss training:  3.878749532974325 Time :  250
accuracy train: 0.995723 val: 0.972121 test: 0.971233
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({1: 3890, 0: 3801})

Epoch :  17 loss training:  3.2991890588891692 Time :  266
accuracy train: 0.996578 val: 0.972121 test: 0.967580
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({1: 3894, 0: 3797})

Epoch :  18 loss training:  3.3247513292590156 Time :  282
accuracy train: 0.996151 val: 0.973333 test: 0.967123
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({0: 3902, 1: 3789})

Epoch :  19 loss training:  3.1185574689880013 Time :  297
accuracy train: 0.996792 val: 0.972121 test: 0.971689
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({1: 3905, 0: 3786})

Epoch :  20 loss training:  2.4279790923174005 Time :  313
accuracy train: 0.997006 val: 0.968485 test: 0.968950
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({1: 3905, 0: 3786})

Epoch :  21 loss training:  2.45269722212106 Time :  329
accuracy train: 0.996792 val: 0.970909 test: 0.968037
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({0: 3910, 1: 3781})

Epoch :  22 loss training:  2.4440020719193853 Time :  344
accuracy train: 0.996578 val: 0.970909 test: 0.971689
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({1: 3907, 0: 3784})

Epoch :  23 loss training:  2.3122152245487086 Time :  360
accuracy train: 0.996578 val: 0.972121 test: 0.972146
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({0: 3910, 1: 3781})

Epoch :  24 loss training:  2.2021787945705 Time :  377
accuracy train: 0.996364 val: 0.969697 test: 0.971233
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({1: 3912, 0: 3779})

Epoch :  25 loss training:  1.9525220647046808 Time :  393
accuracy train: 0.996578 val: 0.975758 test: 0.972603
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({0: 3917, 1: 3774})

Epoch :  26 loss training:  2.333419465867337 Time :  409
accuracy train: 0.996364 val: 0.975758 test: 0.968493
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({1: 3911, 0: 3780})

Epoch :  27 loss training:  2.1656685223715613 Time :  425
accuracy train: 0.997220 val: 0.974545 test: 0.970776
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({1: 3917, 0: 3774})

Epoch :  28 loss training:  1.9279989312635735 Time :  440
accuracy train: 0.996578 val: 0.973333 test: 0.971233
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({0: 3918, 1: 3773})

Epoch :  29 loss training:  1.8970817584195174 Time :  456
accuracy train: 0.996364 val: 0.973333 test: 0.969406
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({1: 3919, 0: 3772})

Epoch :  30 loss training:  1.8955940345767885 Time :  472
accuracy train: 0.997220 val: 0.969697 test: 0.971689
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({0: 3916, 1: 3775})

Epoch :  31 loss training:  1.9440804977348307 Time :  488
accuracy train: 0.997220 val: 0.972121 test: 0.970776
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({1: 3918, 0: 3773})

Epoch :  32 loss training:  1.6855861146032112 Time :  504
accuracy train: 0.995937 val: 0.970909 test: 0.971689
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({0: 3901, 1: 3790})

Epoch :  33 loss training:  2.0011103877186542 Time :  521
accuracy train: 0.996151 val: 0.968485 test: 0.972146
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({1: 3890, 0: 3801})

Epoch :  34 loss training:  1.472048700627056 Time :  536
accuracy train: 0.997220 val: 0.970909 test: 0.973059
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({1: 3904, 0: 3787})

Epoch :  35 loss training:  1.918027979794715 Time :  552
accuracy train: 0.997006 val: 0.972121 test: 0.973516
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({0: 3910, 1: 3781})

Epoch :  36 loss training:  1.6540910686308052 Time :  568
accuracy train: 0.997220 val: 0.973333 test: 0.971689
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({0: 3911, 1: 3780})

Epoch :  37 loss training:  1.783847969796625 Time :  584
accuracy train: 0.997006 val: 0.973333 test: 0.970320
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({1: 3911, 0: 3780})

Epoch :  38 loss training:  1.8751158250743174 Time :  599
accuracy train: 0.997006 val: 0.972121 test: 0.970320
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({0: 3918, 1: 3773})

Epoch :  39 loss training:  1.6405788815463893 Time :  615
accuracy train: 0.997434 val: 0.973333 test: 0.974886
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.964840
Counter({0: 3920, 1: 3771})

========================================================================================================================================================================================================
best acc epoch :  8
validation accuracy :  0.9757575757575757
test accuracy :  0.9648401826484019
last test_accuracy :  0.9748858447488584
second best val :  0.9745454545454545
second best test :  0.9648401826484019
max gap 3
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=347, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 4723, 0: 2968})

Epoch :  1 loss training:  42.04646176099777 Time :  634
accuracy train: 0.961506 val: 0.951515 test: 0.953881
max validation accuracy : 0.951515 max acc epoch : 1 test accuracy : 0.953881
Counter({0: 4132, 1: 3559})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.382239875383675 Time :  650
accuracy train: 0.975192 val: 0.964848 test: 0.961644
max validation accuracy : 0.964848 max acc epoch : 2 test accuracy : 0.961644
Counter({1: 3974, 0: 3717})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.49383842246607 Time :  666
accuracy train: 0.974337 val: 0.961212 test: 0.966667
max validation accuracy : 0.964848 max acc epoch : 2 test accuracy : 0.961644
Counter({0: 3870, 1: 3821})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.11900113336742 Time :  682
accuracy train: 0.981608 val: 0.966061 test: 0.969863
max validation accuracy : 0.966061 max acc epoch : 4 test accuracy : 0.969863
Counter({1: 3879, 0: 3812})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.815891666337848 Time :  698
accuracy train: 0.985458 val: 0.969697 test: 0.968493
max validation accuracy : 0.969697 max acc epoch : 5 test accuracy : 0.968493
Counter({1: 3848, 0: 3843})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.119238402810879 Time :  714
accuracy train: 0.988879 val: 0.970909 test: 0.954338
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.954338
Counter({1: 3848, 0: 3843})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  8.160428053699434 Time :  730
accuracy train: 0.990804 val: 0.968485 test: 0.958904
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.954338
Counter({0: 3847, 1: 3844})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.2519665732979774 Time :  746
accuracy train: 0.989521 val: 0.972121 test: 0.963014
max validation accuracy : 0.972121 max acc epoch : 8 test accuracy : 0.963014
Counter({0: 3850, 1: 3841})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.100466549745761 Time :  762
accuracy train: 0.992087 val: 0.974545 test: 0.963927
max validation accuracy : 0.974545 max acc epoch : 9 test accuracy : 0.963927
Counter({1: 3856, 0: 3835})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.147614269633777 Time :  777
accuracy train: 0.992515 val: 0.969697 test: 0.964840
max validation accuracy : 0.974545 max acc epoch : 9 test accuracy : 0.963927
Counter({0: 3865, 1: 3826})

Epoch :  11 loss training:  5.163339446356986 Time :  793
accuracy train: 0.993584 val: 0.969697 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 9 test accuracy : 0.963927
Counter({1: 3871, 0: 3820})

Epoch :  12 loss training:  4.942578009329736 Time :  810
accuracy train: 0.992515 val: 0.968485 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 9 test accuracy : 0.963927
Counter({1: 3863, 0: 3828})

Epoch :  13 loss training:  4.62789165751019 Time :  827
accuracy train: 0.994440 val: 0.973333 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 9 test accuracy : 0.963927
Counter({1: 3861, 0: 3830})

Epoch :  14 loss training:  4.444269944680855 Time :  843
accuracy train: 0.994654 val: 0.973333 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 9 test accuracy : 0.963927
Counter({0: 3870, 1: 3821})

Epoch :  15 loss training:  3.9078073808923364 Time :  859
accuracy train: 0.994867 val: 0.972121 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 9 test accuracy : 0.963927
Counter({1: 3882, 0: 3809})

Epoch :  16 loss training:  4.425641925248783 Time :  875
accuracy train: 0.995295 val: 0.973333 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 9 test accuracy : 0.963927
Counter({0: 3883, 1: 3808})

Epoch :  17 loss training:  3.521178918890655 Time :  892
accuracy train: 0.995081 val: 0.969697 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 9 test accuracy : 0.963927
Counter({1: 3888, 0: 3803})

Epoch :  18 loss training:  3.370487349908217 Time :  908
accuracy train: 0.995295 val: 0.973333 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 9 test accuracy : 0.963927
Counter({1: 3889, 0: 3802})

Epoch :  19 loss training:  3.0178222921385895 Time :  925
accuracy train: 0.995081 val: 0.973333 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 9 test accuracy : 0.963927
Counter({0: 3905, 1: 3786})

Epoch :  20 loss training:  3.406175004900433 Time :  942
accuracy train: 0.995723 val: 0.976970 test: 0.970320
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({1: 3905, 0: 3786})

Epoch :  21 loss training:  2.7424477151362225 Time :  958
accuracy train: 0.995723 val: 0.973333 test: 0.972146
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({0: 3897, 1: 3794})

Epoch :  22 loss training:  2.959744385909289 Time :  975
accuracy train: 0.995937 val: 0.969697 test: 0.965297
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({1: 3910, 0: 3781})

Epoch :  23 loss training:  2.4872943646187196 Time :  991
accuracy train: 0.996364 val: 0.974545 test: 0.971233
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({0: 3905, 1: 3786})

Epoch :  24 loss training:  2.3661892756063025 Time :  1006
accuracy train: 0.995509 val: 0.976970 test: 0.968950
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({0: 3911, 1: 3780})

Epoch :  25 loss training:  3.60868783906335 Time :  1023
accuracy train: 0.996364 val: 0.969697 test: 0.968950
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({1: 3901, 0: 3790})

Epoch :  26 loss training:  3.0183262495556846 Time :  1040
accuracy train: 0.996364 val: 0.972121 test: 0.963927
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({0: 3903, 1: 3788})

Epoch :  27 loss training:  1.960066694766283 Time :  1057
accuracy train: 0.996364 val: 0.975758 test: 0.963927
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({1: 3913, 0: 3778})

Epoch :  28 loss training:  1.99767968285596 Time :  1075
accuracy train: 0.996578 val: 0.975758 test: 0.968950
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({0: 3906, 1: 3785})

Epoch :  29 loss training:  1.987845216266578 Time :  1095
accuracy train: 0.996578 val: 0.976970 test: 0.971689
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({0: 3912, 1: 3779})

Epoch :  30 loss training:  1.914057627771399 Time :  1114
accuracy train: 0.996578 val: 0.974545 test: 0.968950
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({1: 3912, 0: 3779})

Epoch :  31 loss training:  1.8336385517613962 Time :  1132
accuracy train: 0.996792 val: 0.975758 test: 0.970320
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({0: 3915, 1: 3776})

Epoch :  32 loss training:  1.6108440918033011 Time :  1152
accuracy train: 0.996578 val: 0.973333 test: 0.971689
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({0: 3915, 1: 3776})

Epoch :  33 loss training:  1.6542984453080862 Time :  1171
accuracy train: 0.997006 val: 0.973333 test: 0.969863
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({0: 3911, 1: 3780})

Epoch :  34 loss training:  1.5997947607247625 Time :  1188
accuracy train: 0.996792 val: 0.970909 test: 0.970320
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({1: 3909, 0: 3782})

Epoch :  35 loss training:  1.8414931311126566 Time :  1208
accuracy train: 0.996792 val: 0.970909 test: 0.971233
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({0: 3909, 1: 3782})

Epoch :  36 loss training:  1.9480451908602845 Time :  1226
accuracy train: 0.996578 val: 0.972121 test: 0.968950
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({1: 3917, 0: 3774})

Epoch :  37 loss training:  1.510917770297965 Time :  1243
accuracy train: 0.996792 val: 0.968485 test: 0.971689
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({0: 3917, 1: 3774})

Epoch :  38 loss training:  1.5545365651450993 Time :  1262
accuracy train: 0.996792 val: 0.976970 test: 0.974429
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({0: 3918, 1: 3773})

Epoch :  39 loss training:  1.4823562904130085 Time :  1280
accuracy train: 0.996792 val: 0.969697 test: 0.968950
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({1: 3918, 0: 3773})

Epoch :  40 loss training:  1.425003088566882 Time :  1297
accuracy train: 0.997006 val: 0.972121 test: 0.969406
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({0: 3917, 1: 3774})

Epoch :  41 loss training:  1.8034640130827029 Time :  1314
accuracy train: 0.996792 val: 0.974545 test: 0.972146
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({1: 3919, 0: 3772})

Epoch :  42 loss training:  1.6367507653740176 Time :  1335
accuracy train: 0.997006 val: 0.972121 test: 0.971233
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({1: 3920, 0: 3771})

Epoch :  43 loss training:  1.391159696460818 Time :  1353
accuracy train: 0.996792 val: 0.972121 test: 0.971233
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({0: 3920, 1: 3771})

Epoch :  44 loss training:  1.4545438103959896 Time :  1370
accuracy train: 0.996792 val: 0.967273 test: 0.965297
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({0: 3917, 1: 3774})

Epoch :  45 loss training:  1.335548194772855 Time :  1391
accuracy train: 0.997006 val: 0.970909 test: 0.969406
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({1: 3919, 0: 3772})

Epoch :  46 loss training:  1.3275127105334832 Time :  1410
accuracy train: 0.997006 val: 0.970909 test: 0.971233
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({1: 3919, 0: 3772})

Epoch :  47 loss training:  1.4834108671057038 Time :  1427
accuracy train: 0.996792 val: 0.973333 test: 0.970776
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({0: 3919, 1: 3772})

Epoch :  48 loss training:  1.4551282388674736 Time :  1443
accuracy train: 0.997006 val: 0.970909 test: 0.970320
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({1: 3919, 0: 3772})

Epoch :  49 loss training:  1.3691659179739872 Time :  1466
accuracy train: 0.997006 val: 0.970909 test: 0.970776
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({0: 3920, 1: 3771})

Epoch :  50 loss training:  1.4733430483211123 Time :  1485
accuracy train: 0.996792 val: 0.973333 test: 0.971233
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({1: 3923, 0: 3768})

Epoch :  51 loss training:  1.5395794444884814 Time :  1503
accuracy train: 0.997006 val: 0.967273 test: 0.971233
max validation accuracy : 0.976970 max acc epoch : 20 test accuracy : 0.970320
Counter({0: 3922, 1: 3769})

========================================================================================================================================================================================================
best acc epoch :  20
validation accuracy :  0.9769696969696969
test accuracy :  0.9703196347031964
last test_accuracy :  0.9712328767123287
second best val :  0.9757575757575757
second best test :  0.9703196347031964
max gap 11
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  8 	 val_accuracy : 0.97576 	 test_accuracy : 0.96484 	 last test_accuracy : 0.97489 	 second best val : 0.97455 	 second best test : 0.96484
k :  1 	 best_acc epoch :  20 	 val_accuracy : 0.97697 	 test_accuracy : 0.97032 	 last test_accuracy : 0.97123 	 second best val : 0.97576 	 second best test : 0.97032

avg :  	 val_accuracy : 0.97636 	 test_accuracy : 0.96758 	 last_accuracy : 0.97306 	 second best val : 0.97515 	 second best test : 0.96758

std :  	 val_accuracy : 0.00061 	 test_accuracy : 0.00274 	 last_accuracy : 0.00183 	 second best val : 0.00061 	 second best test : 0.00274
