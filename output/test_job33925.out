

date and time :  Wed May 26 18:56:07 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=143, weight_decay=1e-08)
device :  cuda:0
Counter({1: 2597, 0: 2547, 2: 2256})

Epoch :  1 loss training:  211.47000098228455 Time :  236
accuracy train: 0.665453 val: 0.605970 test: 0.621815
max validation accuracy : 0.605970 max acc epoch : 1 test accuracy : 0.621815
Counter({0: 3307, 2: 2335, 1: 1758})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  142.6488778591156 Time :  396
accuracy train: 0.714097 val: 0.629851 test: 0.654465
max validation accuracy : 0.629851 max acc epoch : 2 test accuracy : 0.654465
Counter({2: 4475, 0: 1606, 1: 1319})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  124.01562434434891 Time :  517
accuracy train: 0.767042 val: 0.668657 test: 0.671531
max validation accuracy : 0.668657 max acc epoch : 3 test accuracy : 0.671531
Counter({1: 2806, 0: 2514, 2: 2080})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  96.34821793437004 Time :  654
accuracy train: 0.808405 val: 0.674627 test: 0.709374
max validation accuracy : 0.674627 max acc epoch : 4 test accuracy : 0.709374
Counter({1: 2769, 2: 2518, 0: 2113})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  86.9939079284668 Time :  779
accuracy train: 0.830245 val: 0.695522 test: 0.692555
max validation accuracy : 0.695522 max acc epoch : 5 test accuracy : 0.692555
Counter({2: 3625, 1: 2410, 0: 1365})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  82.51609812676907 Time :  901
accuracy train: 0.829914 val: 0.698507 test: 0.702696
max validation accuracy : 0.698507 max acc epoch : 6 test accuracy : 0.702696
Counter({2: 2641, 1: 2420, 0: 2339})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  72.16237930953503 Time :  1014
accuracy train: 0.872601 val: 0.692537 test: 0.707643
max validation accuracy : 0.698507 max acc epoch : 6 test accuracy : 0.702696
Counter({1: 2708, 0: 2556, 2: 2136})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.36830937862396 Time :  1122
accuracy train: 0.878226 val: 0.716418 test: 0.716052
max validation accuracy : 0.716418 max acc epoch : 8 test accuracy : 0.716052
Counter({0: 2649, 1: 2537, 2: 2214})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.72354732453823 Time :  1254
accuracy train: 0.885175 val: 0.701493 test: 0.709127
max validation accuracy : 0.716418 max acc epoch : 8 test accuracy : 0.716052
Counter({0: 3582, 2: 2397, 1: 1421})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  58.06312993168831 Time :  1395
accuracy train: 0.907015 val: 0.707463 test: 0.717042
max validation accuracy : 0.716418 max acc epoch : 8 test accuracy : 0.716052
Counter({0: 3470, 1: 2483, 2: 1447})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  56.86103707551956 Time :  1553
accuracy train: 0.905692 val: 0.695522 test: 0.721741
max validation accuracy : 0.716418 max acc epoch : 8 test accuracy : 0.716052
Counter({2: 3478, 0: 2461, 1: 1461})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  54.841728791594505 Time :  1667
accuracy train: 0.913964 val: 0.701493 test: 0.719021
max validation accuracy : 0.716418 max acc epoch : 8 test accuracy : 0.716052
Counter({1: 3443, 2: 2467, 0: 1490})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  50.273240864276886 Time :  1790
accuracy train: 0.919590 val: 0.701493 test: 0.720010
max validation accuracy : 0.716418 max acc epoch : 8 test accuracy : 0.716052
Counter({0: 3535, 2: 2465, 1: 1400})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  51.35247480869293 Time :  1898
accuracy train: 0.921906 val: 0.698507 test: 0.720257
max validation accuracy : 0.716418 max acc epoch : 8 test accuracy : 0.716052
Counter({0: 2643, 2: 2551, 1: 2206})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  49.67954345047474 Time :  2020
accuracy train: 0.920251 val: 0.719403 test: 0.720999
max validation accuracy : 0.719403 max acc epoch : 15 test accuracy : 0.720999
Counter({0: 2627, 1: 2569, 2: 2204})

Epoch :  16 loss training:  47.97563527524471 Time :  2145
accuracy train: 0.928855 val: 0.704478 test: 0.716547
max validation accuracy : 0.719403 max acc epoch : 15 test accuracy : 0.720999
Counter({0: 2614, 1: 2573, 2: 2213})

Epoch :  17 loss training:  48.4767119884491 Time :  2262
accuracy train: 0.934480 val: 0.710448 test: 0.718279
max validation accuracy : 0.719403 max acc epoch : 15 test accuracy : 0.720999
Counter({0: 2674, 1: 2584, 2: 2142})

Epoch :  18 loss training:  46.886634424328804 Time :  2405
accuracy train: 0.937459 val: 0.716418 test: 0.721247
max validation accuracy : 0.719403 max acc epoch : 15 test accuracy : 0.720999
Counter({0: 2673, 2: 2600, 1: 2127})

Epoch :  19 loss training:  45.154714331030846 Time :  2557
accuracy train: 0.940106 val: 0.701493 test: 0.721989
max validation accuracy : 0.719403 max acc epoch : 15 test accuracy : 0.720999
Counter({2: 2712, 0: 2488, 1: 2200})

Epoch :  20 loss training:  42.616795763373375 Time :  2686
accuracy train: 0.946062 val: 0.716418 test: 0.720257
max validation accuracy : 0.719403 max acc epoch : 15 test accuracy : 0.720999
Counter({2: 3528, 1: 2477, 0: 1395})

Epoch :  21 loss training:  41.956028029322624 Time :  2817
accuracy train: 0.949371 val: 0.716418 test: 0.720257
max validation accuracy : 0.719403 max acc epoch : 15 test accuracy : 0.720999
Counter({0: 3537, 1: 2486, 2: 1377})

Epoch :  22 loss training:  40.048102393746376 Time :  2945
accuracy train: 0.957313 val: 0.707463 test: 0.721494
max validation accuracy : 0.719403 max acc epoch : 15 test accuracy : 0.720999
Counter({0: 3570, 1: 2457, 2: 1373})

Epoch :  23 loss training:  38.6416082829237 Time :  3055
accuracy train: 0.957975 val: 0.716418 test: 0.718773
max validation accuracy : 0.719403 max acc epoch : 15 test accuracy : 0.720999
Counter({0: 2723, 2: 2538, 1: 2139})

Epoch :  24 loss training:  37.02043014019728 Time :  3204
accuracy train: 0.960622 val: 0.707463 test: 0.722731
max validation accuracy : 0.719403 max acc epoch : 15 test accuracy : 0.720999
Counter({0: 3611, 1: 2426, 2: 1363})

Epoch :  25 loss training:  37.54458160698414 Time :  3315
accuracy train: 0.962608 val: 0.719403 test: 0.720257
max validation accuracy : 0.719403 max acc epoch : 15 test accuracy : 0.720999
Counter({1: 3548, 2: 2486, 0: 1366})

Epoch :  26 loss training:  35.56033805757761 Time :  3448
accuracy train: 0.963931 val: 0.704478 test: 0.718773
max validation accuracy : 0.719403 max acc epoch : 15 test accuracy : 0.720999
Counter({1: 2716, 0: 2613, 2: 2071})

Epoch :  27 loss training:  34.56512152031064 Time :  3561
accuracy train: 0.969557 val: 0.716418 test: 0.716794
max validation accuracy : 0.719403 max acc epoch : 15 test accuracy : 0.720999
Counter({2: 2695, 1: 2627, 0: 2078})

Epoch :  28 loss training:  32.57915456593037 Time :  3713
accuracy train: 0.971211 val: 0.704478 test: 0.718773
max validation accuracy : 0.719403 max acc epoch : 15 test accuracy : 0.720999
Counter({1: 2755, 2: 2610, 0: 2035})

Epoch :  29 loss training:  32.309649772942066 Time :  3854
accuracy train: 0.970218 val: 0.716418 test: 0.719021
max validation accuracy : 0.719403 max acc epoch : 15 test accuracy : 0.720999
Counter({0: 2736, 1: 2580, 2: 2084})

Epoch :  30 loss training:  29.995086431503296 Time :  3972
accuracy train: 0.975182 val: 0.725373 test: 0.720505
max validation accuracy : 0.725373 max acc epoch : 30 test accuracy : 0.720505
Counter({0: 2717, 2: 2577, 1: 2106})

Epoch :  31 loss training:  29.493849508464336 Time :  4110
accuracy train: 0.976837 val: 0.719403 test: 0.717042
max validation accuracy : 0.725373 max acc epoch : 30 test accuracy : 0.720505
Counter({0: 3507, 2: 2508, 1: 1385})

Epoch :  32 loss training:  27.82366331666708 Time :  4240
accuracy train: 0.978822 val: 0.701493 test: 0.720999
max validation accuracy : 0.725373 max acc epoch : 30 test accuracy : 0.720505
Counter({2: 2739, 1: 2534, 0: 2127})

Epoch :  33 loss training:  26.749473460018635 Time :  4366
accuracy train: 0.984447 val: 0.713433 test: 0.714816
max validation accuracy : 0.725373 max acc epoch : 30 test accuracy : 0.720505
Counter({0: 2694, 2: 2612, 1: 2094})

Epoch :  34 loss training:  26.78780948743224 Time :  4517
accuracy train: 0.982793 val: 0.713433 test: 0.720752
max validation accuracy : 0.725373 max acc epoch : 30 test accuracy : 0.720505
Counter({2: 2728, 0: 2569, 1: 2103})

Epoch :  35 loss training:  25.260881021618843 Time :  4633
accuracy train: 0.986102 val: 0.710448 test: 0.718526
max validation accuracy : 0.725373 max acc epoch : 30 test accuracy : 0.720505
Counter({0: 2713, 1: 2546, 2: 2141})

Epoch :  36 loss training:  25.46996223181486 Time :  4776
accuracy train: 0.987095 val: 0.722388 test: 0.716300
max validation accuracy : 0.725373 max acc epoch : 30 test accuracy : 0.720505
Counter({0: 2695, 1: 2619, 2: 2086})

Epoch :  37 loss training:  23.901901476085186 Time :  4898
accuracy train: 0.987426 val: 0.725373 test: 0.719021
max validation accuracy : 0.725373 max acc epoch : 30 test accuracy : 0.720505
Counter({0: 3527, 2: 2541, 1: 1332})

Epoch :  38 loss training:  22.89367739111185 Time :  5055
accuracy train: 0.989080 val: 0.722388 test: 0.722236
max validation accuracy : 0.725373 max acc epoch : 30 test accuracy : 0.720505
Counter({0: 2720, 2: 2542, 1: 2138})

Epoch :  39 loss training:  22.575980253517628 Time :  5177
accuracy train: 0.990735 val: 0.728358 test: 0.717784
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({1: 3586, 2: 2481, 0: 1333})

Epoch :  40 loss training:  20.883631713688374 Time :  5319
accuracy train: 0.994044 val: 0.716418 test: 0.715310
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({0: 3526, 2: 2528, 1: 1346})

Epoch :  41 loss training:  18.902061078697443 Time :  5431
accuracy train: 0.993713 val: 0.710448 test: 0.717042
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({1: 3602, 0: 2453, 2: 1345})

Epoch :  42 loss training:  20.051595401018858 Time :  5575
accuracy train: 0.994044 val: 0.707463 test: 0.716052
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({2: 2762, 0: 2482, 1: 2156})

Epoch :  43 loss training:  19.545027270913124 Time :  5689
accuracy train: 0.994044 val: 0.725373 test: 0.716794
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({0: 3560, 2: 2520, 1: 1320})

Epoch :  44 loss training:  18.64965059608221 Time :  5831
accuracy train: 0.996029 val: 0.719403 test: 0.715063
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({0: 3543, 2: 2553, 1: 1304})

Epoch :  45 loss training:  18.400161929428577 Time :  5969
accuracy train: 0.996691 val: 0.722388 test: 0.717289
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({1: 3641, 2: 2461, 0: 1298})

Epoch :  46 loss training:  16.788812652230263 Time :  6108
accuracy train: 0.996360 val: 0.719403 test: 0.722236
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({2: 3641, 1: 2425, 0: 1334})

Epoch :  47 loss training:  17.397106483578682 Time :  6244
accuracy train: 0.997684 val: 0.722388 test: 0.719515
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({1: 3570, 2: 2521, 0: 1309})

Epoch :  48 loss training:  15.90947199612856 Time :  6372
accuracy train: 0.998345 val: 0.707463 test: 0.718526
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({1: 3548, 2: 2562, 0: 1290})

Epoch :  49 loss training:  14.971485435962677 Time :  6491
accuracy train: 0.998345 val: 0.725373 test: 0.718526
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({1: 3609, 2: 2504, 0: 1287})

Epoch :  50 loss training:  14.175270691514015 Time :  6624
accuracy train: 0.998015 val: 0.713433 test: 0.719515
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({0: 3627, 1: 2480, 2: 1293})

Epoch :  51 loss training:  14.596289440989494 Time :  6751
accuracy train: 0.997353 val: 0.725373 test: 0.725204
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({0: 3631, 2: 2454, 1: 1315})

Epoch :  52 loss training:  12.905111283063889 Time :  6869
accuracy train: 0.998345 val: 0.725373 test: 0.722731
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({0: 4674, 2: 1403, 1: 1323})

Epoch :  53 loss training:  13.272921804338694 Time :  6976
accuracy train: 0.999007 val: 0.719403 test: 0.715310
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({0: 4710, 2: 1391, 1: 1299})

Epoch :  54 loss training:  14.074588850140572 Time :  7125
accuracy train: 0.999669 val: 0.725373 test: 0.720257
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({1: 4659, 2: 1420, 0: 1321})

Epoch :  55 loss training:  12.466196356341243 Time :  7266
accuracy train: 0.999669 val: 0.728358 test: 0.718526
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({1: 3371, 0: 2663, 2: 1366})

Epoch :  56 loss training:  12.892695849761367 Time :  7409
accuracy train: 0.999669 val: 0.725373 test: 0.718526
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({1: 3392, 0: 2661, 2: 1347})

Epoch :  57 loss training:  11.668344426900148 Time :  7520
accuracy train: 1.000000 val: 0.719403 test: 0.716300
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({2: 2763, 0: 2561, 1: 2076})

Epoch :  58 loss training:  10.37050150334835 Time :  7656
accuracy train: 1.000000 val: 0.728358 test: 0.717042
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({1: 3608, 2: 2459, 0: 1333})

Epoch :  59 loss training:  10.614844002760947 Time :  7761
accuracy train: 0.999669 val: 0.710448 test: 0.715310
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({1: 3648, 2: 2482, 0: 1270})

Epoch :  60 loss training:  9.86120080947876 Time :  7896
accuracy train: 0.999669 val: 0.716418 test: 0.716794
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({0: 3631, 1: 2520, 2: 1249})

Epoch :  61 loss training:  9.890654888935387 Time :  8039
accuracy train: 1.000000 val: 0.722388 test: 0.718773
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({1: 4728, 2: 1369, 0: 1303})

Epoch :  62 loss training:  9.868239101022482 Time :  8201
accuracy train: 1.000000 val: 0.719403 test: 0.717042
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({0: 3555, 2: 2582, 1: 1263})

Epoch :  63 loss training:  8.83057150337845 Time :  8309
accuracy train: 1.000000 val: 0.716418 test: 0.720999
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({1: 4700, 2: 1372, 0: 1328})

Epoch :  64 loss training:  9.041597974486649 Time :  8458
accuracy train: 1.000000 val: 0.722388 test: 0.715805
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({0: 4730, 2: 1365, 1: 1305})

Epoch :  65 loss training:  8.344732388854027 Time :  8602
accuracy train: 1.000000 val: 0.713433 test: 0.719763
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({0: 4708, 1: 1385, 2: 1307})

Epoch :  66 loss training:  8.215707089751959 Time :  8715
accuracy train: 1.000000 val: 0.722388 test: 0.718526
max validation accuracy : 0.728358 max acc epoch : 39 test accuracy : 0.717784
Counter({0: 4737, 2: 1355, 1: 1308})

Epoch :  67 loss training:  8.40097993798554 Time :  8861
accuracy train: 1.000000 val: 0.734328 test: 0.725946
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({0: 4745, 1: 1356, 2: 1299})

Epoch :  68 loss training:  8.434447505511343 Time :  8998
accuracy train: 1.000000 val: 0.716418 test: 0.720505
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({0: 4742, 2: 1361, 1: 1297})

Epoch :  69 loss training:  7.199332887772471 Time :  9118
accuracy train: 1.000000 val: 0.719403 test: 0.721494
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({0: 4717, 2: 1372, 1: 1311})

Epoch :  70 loss training:  6.836387727409601 Time :  9246
accuracy train: 1.000000 val: 0.734328 test: 0.721741
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({0: 4694, 2: 1375, 1: 1331})

Epoch :  71 loss training:  7.797385534271598 Time :  9360
accuracy train: 1.000000 val: 0.716418 test: 0.720505
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({0: 4768, 1: 1371, 2: 1261})

Epoch :  72 loss training:  6.473800292238593 Time :  9496
accuracy train: 1.000000 val: 0.731343 test: 0.722236
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({1: 4726, 2: 1367, 0: 1307})

Epoch :  73 loss training:  7.622199631296098 Time :  9629
accuracy train: 1.000000 val: 0.719403 test: 0.720752
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({0: 3628, 1: 2540, 2: 1232})

Epoch :  74 loss training:  6.447477883659303 Time :  9756
accuracy train: 1.000000 val: 0.734328 test: 0.718526
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({0: 4760, 1: 1362, 2: 1278})

Epoch :  75 loss training:  6.651315389666706 Time :  9892
accuracy train: 1.000000 val: 0.719403 test: 0.717536
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({0: 4750, 2: 1368, 1: 1282})

Epoch :  76 loss training:  6.300039210356772 Time :  10005
accuracy train: 1.000000 val: 0.716418 test: 0.719515
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({0: 4732, 2: 1361, 1: 1307})

Epoch :  77 loss training:  5.768319261260331 Time :  10148
accuracy train: 1.000000 val: 0.728358 test: 0.719515
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({0: 4760, 2: 1356, 1: 1284})

Epoch :  78 loss training:  6.119020646903664 Time :  10274
accuracy train: 1.000000 val: 0.728358 test: 0.719515
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({1: 3661, 2: 2452, 0: 1287})

Epoch :  79 loss training:  5.904570069629699 Time :  10375
accuracy train: 1.000000 val: 0.716418 test: 0.719268
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({1: 3690, 2: 2475, 0: 1235})

Epoch :  80 loss training:  5.805895023979247 Time :  10518
accuracy train: 1.000000 val: 0.716418 test: 0.718279
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({0: 3552, 1: 2595, 2: 1253})

Epoch :  81 loss training:  5.28384591685608 Time :  10643
accuracy train: 1.000000 val: 0.728358 test: 0.720010
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({0: 4761, 2: 1346, 1: 1293})

Epoch :  82 loss training:  5.090595189947635 Time :  10791
accuracy train: 1.000000 val: 0.734328 test: 0.725204
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({2: 3682, 1: 2470, 0: 1248})

Epoch :  83 loss training:  4.657028328627348 Time :  10907
accuracy train: 1.000000 val: 0.719403 test: 0.718526
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({1: 4768, 2: 1347, 0: 1285})

Epoch :  84 loss training:  5.2019083253107965 Time :  11055
accuracy train: 1.000000 val: 0.722388 test: 0.719021
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({1: 4817, 2: 1340, 0: 1243})

Epoch :  85 loss training:  4.3680564975366 Time :  11180
accuracy train: 1.000000 val: 0.722388 test: 0.723720
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({0: 4778, 2: 1337, 1: 1285})

Epoch :  86 loss training:  4.590484068496153 Time :  11319
accuracy train: 1.000000 val: 0.704478 test: 0.718773
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({0: 3758, 1: 2400, 2: 1242})

Epoch :  87 loss training:  4.064631721004844 Time :  11460
accuracy train: 1.000000 val: 0.707463 test: 0.717536
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({2: 4817, 0: 1356, 1: 1227})

Epoch :  88 loss training:  4.060396565590054 Time :  11578
accuracy train: 1.000000 val: 0.713433 test: 0.721494
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({0: 4056, 1: 2123, 2: 1221})

Epoch :  89 loss training:  4.153807587921619 Time :  11717
accuracy train: 1.000000 val: 0.716418 test: 0.719268
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({0: 4176, 2: 2028, 1: 1196})

Epoch :  90 loss training:  3.9184588890057057 Time :  11841
accuracy train: 1.000000 val: 0.698507 test: 0.722731
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({1: 3720, 0: 2453, 2: 1227})

Epoch :  91 loss training:  3.182493611006066 Time :  11983
accuracy train: 1.000000 val: 0.710448 test: 0.720752
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({1: 4826, 2: 1329, 0: 1245})

Epoch :  92 loss training:  4.050625634146854 Time :  12098
accuracy train: 1.000000 val: 0.710448 test: 0.721741
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({0: 4814, 2: 1340, 1: 1246})

Epoch :  93 loss training:  3.843235373031348 Time :  12235
accuracy train: 1.000000 val: 0.713433 test: 0.722978
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({1: 4803, 2: 1344, 0: 1253})

Epoch :  94 loss training:  3.2203365662135184 Time :  12392
accuracy train: 1.000000 val: 0.713433 test: 0.720010
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({0: 4790, 1: 1364, 2: 1246})

Epoch :  95 loss training:  3.7430042210035026 Time :  12568
accuracy train: 1.000000 val: 0.713433 test: 0.720999
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({0: 4766, 2: 1374, 1: 1260})

Epoch :  96 loss training:  3.329518223647028 Time :  12699
accuracy train: 1.000000 val: 0.710448 test: 0.723967
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({0: 4828, 2: 1316, 1: 1256})

Epoch :  97 loss training:  3.1720688592176884 Time :  12848
accuracy train: 1.000000 val: 0.707463 test: 0.721247
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({2: 4835, 1: 1321, 0: 1244})

Epoch :  98 loss training:  3.181044626282528 Time :  12980
accuracy train: 1.000000 val: 0.719403 test: 0.720999
max validation accuracy : 0.734328 max acc epoch : 67 test accuracy : 0.725946
Counter({1: 4912, 2: 1292, 0: 1196})

========================================================================================================================================================================================================
max acc epoch :  67
max validation accuracy :  0.7343283582089553
test accuracy :  0.7259460796438288
last test_accuracy :  0.7209992579767499
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=143, weight_decay=1e-08)
device :  cuda:0
Counter({1: 2597, 0: 2547, 2: 2256})

Epoch :  1 loss training:  211.5775464773178 Time :  13315
accuracy train: 0.664130 val: 0.597015 test: 0.618600
max validation accuracy : 0.597015 max acc epoch : 1 test accuracy : 0.618600
Counter({2: 3282, 1: 2342, 0: 1776})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  142.84271830320358 Time :  13418
accuracy train: 0.715751 val: 0.626866 test: 0.655454
max validation accuracy : 0.626866 max acc epoch : 2 test accuracy : 0.655454
Counter({2: 4447, 0: 1635, 1: 1318})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  124.7022175192833 Time :  13590
accuracy train: 0.765718 val: 0.656716 test: 0.672273
max validation accuracy : 0.656716 max acc epoch : 3 test accuracy : 0.672273
Counter({1: 2776, 0: 2478, 2: 2146})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  96.06512796878815 Time :  13737
accuracy train: 0.807412 val: 0.677612 test: 0.707890
max validation accuracy : 0.677612 max acc epoch : 4 test accuracy : 0.707890
Counter({0: 2850, 1: 2449, 2: 2101})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  87.20799389481544 Time :  13876
accuracy train: 0.831238 val: 0.695522 test: 0.698244
max validation accuracy : 0.695522 max acc epoch : 5 test accuracy : 0.698244
Counter({0: 3236, 1: 2644, 2: 1520})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  83.08570228517056 Time :  13984
accuracy train: 0.833885 val: 0.689552 test: 0.699728
max validation accuracy : 0.695522 max acc epoch : 5 test accuracy : 0.698244
Counter({0: 2730, 1: 2442, 2: 2228})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  71.91942590475082 Time :  14102
accuracy train: 0.873263 val: 0.692537 test: 0.709374
max validation accuracy : 0.695522 max acc epoch : 5 test accuracy : 0.698244
Counter({1: 2751, 0: 2532, 2: 2117})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.51707290112972 Time :  14224
accuracy train: 0.879219 val: 0.710448 test: 0.712342
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.712342
Counter({0: 2742, 2: 2504, 1: 2154})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.060614585876465 Time :  14337
accuracy train: 0.886168 val: 0.704478 test: 0.709127
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.712342
Counter({1: 3527, 2: 2418, 0: 1455})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  58.52514471113682 Time :  14499
accuracy train: 0.907346 val: 0.710448 test: 0.717042
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.712342
Counter({1: 3504, 2: 2446, 0: 1450})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  56.58096581697464 Time :  14639
accuracy train: 0.908339 val: 0.689552 test: 0.720257
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.712342
Counter({0: 2540, 1: 2469, 2: 2391})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  55.13737516105175 Time :  14756
accuracy train: 0.917273 val: 0.698507 test: 0.723473
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.712342
Counter({1: 3419, 0: 2486, 2: 1495})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  50.7283800393343 Time :  14869
accuracy train: 0.919921 val: 0.698507 test: 0.722483
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.712342
Counter({0: 2732, 2: 2495, 1: 2173})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  51.590593963861465 Time :  15012
accuracy train: 0.921906 val: 0.698507 test: 0.717042
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.712342
Counter({2: 2700, 0: 2514, 1: 2186})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  49.695619001984596 Time :  15122
accuracy train: 0.922568 val: 0.698507 test: 0.719021
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.712342
Counter({0: 2635, 1: 2534, 2: 2231})

Epoch :  16 loss training:  48.02585771679878 Time :  15258
accuracy train: 0.929848 val: 0.707463 test: 0.716300
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.712342
Counter({0: 2702, 2: 2513, 1: 2185})

Epoch :  17 loss training:  49.15568119287491 Time :  15370
accuracy train: 0.936797 val: 0.695522 test: 0.718031
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.712342
Counter({1: 2734, 2: 2505, 0: 2161})

Epoch :  18 loss training:  47.33453744649887 Time :  15509
accuracy train: 0.938120 val: 0.701493 test: 0.718279
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.712342
Counter({0: 2729, 1: 2536, 2: 2135})

Epoch :  19 loss training:  45.21609526872635 Time :  15634
accuracy train: 0.944408 val: 0.707463 test: 0.717784
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.712342
Counter({1: 2739, 2: 2489, 0: 2172})

Epoch :  20 loss training:  43.31334863603115 Time :  15764
accuracy train: 0.946393 val: 0.710448 test: 0.718031
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.712342
Counter({1: 2717, 2: 2510, 0: 2173})

Epoch :  21 loss training:  41.84593465924263 Time :  15875
accuracy train: 0.950033 val: 0.719403 test: 0.719763
max validation accuracy : 0.719403 max acc epoch : 21 test accuracy : 0.719763
Counter({1: 2721, 2: 2485, 0: 2194})

Epoch :  22 loss training:  40.081370659172535 Time :  16007
accuracy train: 0.955989 val: 0.710448 test: 0.720999
max validation accuracy : 0.719403 max acc epoch : 21 test accuracy : 0.719763
Counter({2: 2763, 0: 2461, 1: 2176})

Epoch :  23 loss training:  38.31762187182903 Time :  16129
accuracy train: 0.960291 val: 0.719403 test: 0.717536
max validation accuracy : 0.719403 max acc epoch : 21 test accuracy : 0.719763
Counter({0: 2766, 1: 2532, 2: 2102})

Epoch :  24 loss training:  37.49172707647085 Time :  16254
accuracy train: 0.961946 val: 0.719403 test: 0.720752
max validation accuracy : 0.719403 max acc epoch : 21 test accuracy : 0.719763
Counter({0: 2783, 2: 2434, 1: 2183})

Epoch :  25 loss training:  37.91486082226038 Time :  16365
accuracy train: 0.963931 val: 0.716418 test: 0.719515
max validation accuracy : 0.719403 max acc epoch : 21 test accuracy : 0.719763
Counter({0: 2735, 2: 2469, 1: 2196})

Epoch :  26 loss training:  35.7280794903636 Time :  16508
accuracy train: 0.966578 val: 0.707463 test: 0.716794
max validation accuracy : 0.719403 max acc epoch : 21 test accuracy : 0.719763
Counter({0: 2764, 1: 2575, 2: 2061})

Epoch :  27 loss training:  34.55822182819247 Time :  16632
accuracy train: 0.969887 val: 0.710448 test: 0.717536
max validation accuracy : 0.719403 max acc epoch : 21 test accuracy : 0.719763
Counter({1: 2760, 0: 2581, 2: 2059})

Epoch :  28 loss training:  32.44436414539814 Time :  16762
accuracy train: 0.971542 val: 0.713433 test: 0.717536
max validation accuracy : 0.719403 max acc epoch : 21 test accuracy : 0.719763
Counter({0: 2798, 2: 2539, 1: 2063})

Epoch :  29 loss training:  32.1417985111475 Time :  16902
accuracy train: 0.971211 val: 0.716418 test: 0.719515
max validation accuracy : 0.719403 max acc epoch : 21 test accuracy : 0.719763
Counter({0: 2753, 2: 2511, 1: 2136})

Epoch :  30 loss training:  29.817210771143436 Time :  17038
accuracy train: 0.978491 val: 0.716418 test: 0.717042
max validation accuracy : 0.719403 max acc epoch : 21 test accuracy : 0.719763
Counter({0: 2747, 2: 2524, 1: 2129})

Epoch :  31 loss training:  29.226384572684765 Time :  17173
accuracy train: 0.977829 val: 0.707463 test: 0.717042
max validation accuracy : 0.719403 max acc epoch : 21 test accuracy : 0.719763
Counter({2: 2732, 0: 2581, 1: 2087})

Epoch :  32 loss training:  28.05506557971239 Time :  17327
accuracy train: 0.979484 val: 0.710448 test: 0.718031
max validation accuracy : 0.719403 max acc epoch : 21 test accuracy : 0.719763
Counter({2: 2796, 0: 2501, 1: 2103})

Epoch :  33 loss training:  26.95485534518957 Time :  17451
accuracy train: 0.985771 val: 0.713433 test: 0.718031
max validation accuracy : 0.719403 max acc epoch : 21 test accuracy : 0.719763
Counter({0: 2741, 2: 2584, 1: 2075})

Epoch :  34 loss training:  26.700213473290205 Time :  17582
accuracy train: 0.985109 val: 0.722388 test: 0.719268
max validation accuracy : 0.722388 max acc epoch : 34 test accuracy : 0.719268
Counter({0: 2768, 2: 2513, 1: 2119})

Epoch :  35 loss training:  25.332385875284672 Time :  17705
accuracy train: 0.986764 val: 0.719403 test: 0.716052
max validation accuracy : 0.722388 max acc epoch : 34 test accuracy : 0.719268
Counter({0: 2769, 2: 2505, 1: 2126})

Epoch :  36 loss training:  25.009264081716537 Time :  17841
accuracy train: 0.987095 val: 0.719403 test: 0.718773
max validation accuracy : 0.722388 max acc epoch : 34 test accuracy : 0.719268
Counter({1: 2755, 2: 2590, 0: 2055})

Epoch :  37 loss training:  24.100415587425232 Time :  17987
accuracy train: 0.987756 val: 0.716418 test: 0.719515
max validation accuracy : 0.722388 max acc epoch : 34 test accuracy : 0.719268
Counter({0: 3509, 1: 2512, 2: 1379})

Epoch :  38 loss training:  22.93988934159279 Time :  18110
accuracy train: 0.990735 val: 0.719403 test: 0.718773
max validation accuracy : 0.722388 max acc epoch : 34 test accuracy : 0.719268
Counter({1: 2809, 2: 2484, 0: 2107})

Epoch :  39 loss training:  22.569924797862768 Time :  18238
accuracy train: 0.992389 val: 0.719403 test: 0.718031
max validation accuracy : 0.722388 max acc epoch : 34 test accuracy : 0.719268
Counter({0: 2758, 2: 2508, 1: 2134})

Epoch :  40 loss training:  21.429647881537676 Time :  18356
accuracy train: 0.993713 val: 0.719403 test: 0.718279
max validation accuracy : 0.722388 max acc epoch : 34 test accuracy : 0.719268
Counter({1: 2762, 2: 2491, 0: 2147})

Epoch :  41 loss training:  18.89343908801675 Time :  18485
accuracy train: 0.993382 val: 0.710448 test: 0.717536
max validation accuracy : 0.722388 max acc epoch : 34 test accuracy : 0.719268
Counter({0: 3549, 1: 2456, 2: 1395})

Epoch :  42 loss training:  19.821223568171263 Time :  18583
accuracy train: 0.994044 val: 0.716418 test: 0.714321
max validation accuracy : 0.722388 max acc epoch : 34 test accuracy : 0.719268
Counter({2: 2827, 0: 2440, 1: 2133})

Epoch :  43 loss training:  19.452180113643408 Time :  18703
accuracy train: 0.993382 val: 0.707463 test: 0.716300
max validation accuracy : 0.722388 max acc epoch : 34 test accuracy : 0.719268
Counter({0: 3531, 1: 2477, 2: 1392})

Epoch :  44 loss training:  18.38598346710205 Time :  18806
accuracy train: 0.994375 val: 0.713433 test: 0.715558
max validation accuracy : 0.722388 max acc epoch : 34 test accuracy : 0.719268
Counter({1: 2816, 2: 2548, 0: 2036})

Epoch :  45 loss training:  18.16759459860623 Time :  18945
accuracy train: 0.995367 val: 0.722388 test: 0.719763
max validation accuracy : 0.722388 max acc epoch : 34 test accuracy : 0.719268
Counter({0: 3603, 2: 2464, 1: 1333})

Epoch :  46 loss training:  16.594625394791365 Time :  19068
accuracy train: 0.996360 val: 0.716418 test: 0.721247
max validation accuracy : 0.722388 max acc epoch : 34 test accuracy : 0.719268
Counter({2: 2825, 1: 2410, 0: 2165})

Epoch :  47 loss training:  17.492589777335525 Time :  19216
accuracy train: 0.997353 val: 0.719403 test: 0.720999
max validation accuracy : 0.722388 max acc epoch : 34 test accuracy : 0.719268
Counter({2: 2788, 0: 2501, 1: 2111})

Epoch :  48 loss training:  16.019141372293234 Time :  19335
accuracy train: 0.997353 val: 0.713433 test: 0.720505
max validation accuracy : 0.722388 max acc epoch : 34 test accuracy : 0.719268
Counter({1: 2756, 2: 2556, 0: 2088})

Epoch :  49 loss training:  14.96107848919928 Time :  19487
accuracy train: 0.998345 val: 0.722388 test: 0.718526
max validation accuracy : 0.722388 max acc epoch : 34 test accuracy : 0.719268
Counter({0: 2783, 1: 2527, 2: 2090})

Epoch :  50 loss training:  13.996706737205386 Time :  19612
accuracy train: 0.998015 val: 0.719403 test: 0.720257
max validation accuracy : 0.722388 max acc epoch : 34 test accuracy : 0.719268
Counter({1: 3597, 2: 2468, 0: 1335})

Epoch :  51 loss training:  14.276655953377485 Time :  19770
accuracy train: 0.998676 val: 0.728358 test: 0.722978
max validation accuracy : 0.728358 max acc epoch : 51 test accuracy : 0.722978
Counter({0: 2785, 1: 2472, 2: 2143})

Epoch :  52 loss training:  12.777143584564328 Time :  19908
accuracy train: 0.998345 val: 0.719403 test: 0.725699
max validation accuracy : 0.728358 max acc epoch : 51 test accuracy : 0.722978
Counter({0: 4623, 2: 1421, 1: 1356})

Epoch :  53 loss training:  13.01397117972374 Time :  20034
accuracy train: 0.999338 val: 0.722388 test: 0.719763
max validation accuracy : 0.728358 max acc epoch : 51 test accuracy : 0.722978
Counter({0: 4678, 2: 1391, 1: 1331})

Epoch :  54 loss training:  13.749120673164725 Time :  20178
accuracy train: 1.000000 val: 0.716418 test: 0.721247
max validation accuracy : 0.728358 max acc epoch : 51 test accuracy : 0.722978
Counter({0: 4621, 2: 1428, 1: 1351})

Epoch :  55 loss training:  12.024034086614847 Time :  20296
accuracy train: 0.999669 val: 0.734328 test: 0.721494
max validation accuracy : 0.734328 max acc epoch : 55 test accuracy : 0.721494
Counter({0: 3319, 1: 2726, 2: 1355})

Epoch :  56 loss training:  12.74585783854127 Time :  20424
accuracy train: 1.000000 val: 0.719403 test: 0.716300
max validation accuracy : 0.734328 max acc epoch : 55 test accuracy : 0.721494
Counter({2: 3347, 1: 2704, 0: 1349})

Epoch :  57 loss training:  11.369472544640303 Time :  20543
accuracy train: 1.000000 val: 0.722388 test: 0.719763
max validation accuracy : 0.734328 max acc epoch : 55 test accuracy : 0.721494
Counter({0: 3324, 1: 2727, 2: 1349})

Epoch :  58 loss training:  10.278556359931827 Time :  20664
accuracy train: 1.000000 val: 0.719403 test: 0.717042
max validation accuracy : 0.734328 max acc epoch : 55 test accuracy : 0.721494
Counter({0: 4658, 1: 1372, 2: 1370})

Epoch :  59 loss training:  10.462587531656027 Time :  20774
accuracy train: 1.000000 val: 0.716418 test: 0.720999
max validation accuracy : 0.734328 max acc epoch : 55 test accuracy : 0.721494
Counter({1: 4679, 2: 1404, 0: 1317})

Epoch :  60 loss training:  9.871692256070673 Time :  20902
accuracy train: 1.000000 val: 0.713433 test: 0.717536
max validation accuracy : 0.734328 max acc epoch : 55 test accuracy : 0.721494
Counter({1: 3616, 2: 2493, 0: 1291})

Epoch :  61 loss training:  9.769975421950221 Time :  21028
accuracy train: 1.000000 val: 0.728358 test: 0.720010
max validation accuracy : 0.734328 max acc epoch : 55 test accuracy : 0.721494
Counter({0: 4693, 2: 1358, 1: 1349})

Epoch :  62 loss training:  9.880663951858878 Time :  21149
accuracy train: 1.000000 val: 0.707463 test: 0.716547
max validation accuracy : 0.734328 max acc epoch : 55 test accuracy : 0.721494
Counter({2: 4688, 0: 1378, 1: 1334})

Epoch :  63 loss training:  8.521476246416569 Time :  21297
accuracy train: 1.000000 val: 0.713433 test: 0.722731
max validation accuracy : 0.734328 max acc epoch : 55 test accuracy : 0.721494
Counter({0: 4682, 2: 1370, 1: 1348})

Epoch :  64 loss training:  8.85845757368952 Time :  21455
accuracy train: 1.000000 val: 0.719403 test: 0.719268
max validation accuracy : 0.734328 max acc epoch : 55 test accuracy : 0.721494
Counter({2: 4708, 0: 1353, 1: 1339})

Epoch :  65 loss training:  8.104842850007117 Time :  21595
accuracy train: 1.000000 val: 0.713433 test: 0.720010
max validation accuracy : 0.734328 max acc epoch : 55 test accuracy : 0.721494
Counter({0: 4677, 2: 1395, 1: 1328})

Epoch :  66 loss training:  8.163173168897629 Time :  21736
accuracy train: 1.000000 val: 0.725373 test: 0.719268
max validation accuracy : 0.734328 max acc epoch : 55 test accuracy : 0.721494
Counter({0: 4695, 2: 1359, 1: 1346})

Epoch :  67 loss training:  8.033227455802262 Time :  21863
accuracy train: 1.000000 val: 0.731343 test: 0.721494
max validation accuracy : 0.734328 max acc epoch : 55 test accuracy : 0.721494
Counter({0: 4717, 2: 1366, 1: 1317})

Epoch :  68 loss training:  8.350894619710743 Time :  22000
accuracy train: 1.000000 val: 0.722388 test: 0.720999
max validation accuracy : 0.734328 max acc epoch : 55 test accuracy : 0.721494
Counter({0: 4723, 2: 1354, 1: 1323})

Epoch :  69 loss training:  7.341633944772184 Time :  22116
accuracy train: 1.000000 val: 0.722388 test: 0.720257
max validation accuracy : 0.734328 max acc epoch : 55 test accuracy : 0.721494
Counter({1: 4690, 0: 1379, 2: 1331})

Epoch :  70 loss training:  6.779269061982632 Time :  22224
accuracy train: 1.000000 val: 0.731343 test: 0.719515
max validation accuracy : 0.734328 max acc epoch : 55 test accuracy : 0.721494
Counter({0: 4678, 2: 1368, 1: 1354})

Epoch :  71 loss training:  7.388514321297407 Time :  22347
accuracy train: 1.000000 val: 0.722388 test: 0.718773
max validation accuracy : 0.734328 max acc epoch : 55 test accuracy : 0.721494
Counter({1: 4778, 0: 1351, 2: 1271})

Epoch :  72 loss training:  6.407328678295016 Time :  22478
accuracy train: 1.000000 val: 0.719403 test: 0.720999
max validation accuracy : 0.734328 max acc epoch : 55 test accuracy : 0.721494
Counter({0: 4153, 2: 1922, 1: 1325})

Epoch :  73 loss training:  7.660550180822611 Time :  22590
accuracy train: 1.000000 val: 0.725373 test: 0.715805
max validation accuracy : 0.734328 max acc epoch : 55 test accuracy : 0.721494
Counter({1: 4761, 2: 1372, 0: 1267})

Epoch :  74 loss training:  6.607631064020097 Time :  22699
accuracy train: 1.000000 val: 0.737313 test: 0.716547
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4760, 2: 1356, 1: 1284})

Epoch :  75 loss training:  6.801232021301985 Time :  22804
accuracy train: 1.000000 val: 0.728358 test: 0.719021
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4752, 1: 1369, 2: 1279})

Epoch :  76 loss training:  5.829204628244042 Time :  22932
accuracy train: 1.000000 val: 0.722388 test: 0.722236
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4697, 1: 1373, 2: 1330})

Epoch :  77 loss training:  5.633595352992415 Time :  23057
accuracy train: 1.000000 val: 0.710448 test: 0.719021
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({2: 4756, 0: 1347, 1: 1297})

Epoch :  78 loss training:  6.148957779631019 Time :  23176
accuracy train: 1.000000 val: 0.713433 test: 0.722731
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({2: 4715, 0: 1354, 1: 1331})

Epoch :  79 loss training:  5.596599605400115 Time :  23301
accuracy train: 1.000000 val: 0.716418 test: 0.716052
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 3655, 2: 2477, 1: 1268})

Epoch :  80 loss training:  5.525802158750594 Time :  23421
accuracy train: 1.000000 val: 0.722388 test: 0.718773
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({1: 3609, 2: 2492, 0: 1299})

Epoch :  81 loss training:  5.228702045045793 Time :  23525
accuracy train: 1.000000 val: 0.722388 test: 0.719763
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4755, 2: 1343, 1: 1302})

Epoch :  82 loss training:  5.100428872741759 Time :  23640
accuracy train: 1.000000 val: 0.728358 test: 0.722731
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({1: 3671, 0: 2436, 2: 1293})

Epoch :  83 loss training:  4.617602871730924 Time :  23753
accuracy train: 1.000000 val: 0.716418 test: 0.718279
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4744, 2: 1341, 1: 1315})

Epoch :  84 loss training:  5.138970385771245 Time :  23859
accuracy train: 1.000000 val: 0.716418 test: 0.718279
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({2: 3717, 1: 2401, 0: 1282})

Epoch :  85 loss training:  4.38723592273891 Time :  23983
accuracy train: 1.000000 val: 0.719403 test: 0.722236
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({1: 4787, 0: 1328, 2: 1285})

Epoch :  86 loss training:  4.158390616998076 Time :  24151
accuracy train: 1.000000 val: 0.704478 test: 0.718279
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4827, 1: 1314, 2: 1259})

Epoch :  87 loss training:  3.9256120070349425 Time :  24266
accuracy train: 1.000000 val: 0.710448 test: 0.714568
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 3693, 2: 2440, 1: 1267})

Epoch :  88 loss training:  3.9955493449233472 Time :  24378
accuracy train: 1.000000 val: 0.707463 test: 0.720257
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({1: 3437, 0: 2687, 2: 1276})

Epoch :  89 loss training:  4.1558333076536655 Time :  24497
accuracy train: 1.000000 val: 0.698507 test: 0.721741
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4874, 1: 1330, 2: 1196})

Epoch :  90 loss training:  4.011096611153334 Time :  24640
accuracy train: 1.000000 val: 0.698507 test: 0.721989
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({1: 3718, 2: 2433, 0: 1249})

Epoch :  91 loss training:  3.4271762238349766 Time :  24771
accuracy train: 1.000000 val: 0.725373 test: 0.717784
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4802, 2: 1340, 1: 1258})

Epoch :  92 loss training:  3.739070773590356 Time :  24900
accuracy train: 1.000000 val: 0.704478 test: 0.720999
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({2: 4824, 0: 1324, 1: 1252})

Epoch :  93 loss training:  3.7951604267582297 Time :  25019
accuracy train: 1.000000 val: 0.701493 test: 0.719021
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({1: 4823, 0: 1310, 2: 1267})

Epoch :  94 loss training:  3.476188889471814 Time :  25143
accuracy train: 1.000000 val: 0.704478 test: 0.719763
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4792, 1: 1346, 2: 1262})

Epoch :  95 loss training:  3.5914424180518836 Time :  25263
accuracy train: 1.000000 val: 0.704478 test: 0.720999
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4774, 1: 1358, 2: 1268})

Epoch :  96 loss training:  3.2129160517361015 Time :  25383
accuracy train: 1.000000 val: 0.701493 test: 0.718031
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({2: 4804, 0: 1322, 1: 1274})

Epoch :  97 loss training:  2.9808558323420584 Time :  25509
accuracy train: 1.000000 val: 0.707463 test: 0.720505
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({1: 4787, 2: 1314, 0: 1299})

Epoch :  98 loss training:  2.98161319619976 Time :  25630
accuracy train: 1.000000 val: 0.710448 test: 0.720010
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({1: 4879, 2: 1301, 0: 1220})

Epoch :  99 loss training:  3.0773234132211655 Time :  25752
accuracy train: 1.000000 val: 0.710448 test: 0.719021
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 3513, 1: 2610, 2: 1277})

Epoch :  100 loss training:  3.8244839978870004 Time :  25858
accuracy train: 1.000000 val: 0.704478 test: 0.721741
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4780, 1: 1360, 2: 1260})

Epoch :  101 loss training:  3.0435617174953222 Time :  25984
accuracy train: 1.000000 val: 0.710448 test: 0.718773
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({2: 4819, 0: 1332, 1: 1249})

Epoch :  102 loss training:  3.157818229170516 Time :  26126
accuracy train: 1.000000 val: 0.689552 test: 0.719021
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({1: 3600, 0: 2569, 2: 1231})

Epoch :  103 loss training:  2.6280427710153162 Time :  26250
accuracy train: 1.000000 val: 0.701493 test: 0.717289
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({1: 4860, 0: 1309, 2: 1231})

Epoch :  104 loss training:  2.6410331369843334 Time :  26364
accuracy train: 1.000000 val: 0.701493 test: 0.716052
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4873, 1: 1309, 2: 1218})

Epoch :  105 loss training:  2.244134850334376 Time :  26471
accuracy train: 1.000000 val: 0.707463 test: 0.720999
max validation accuracy : 0.737313 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4077, 1: 2094, 2: 1229})

========================================================================================================================================================================================================
max acc epoch :  74
max validation accuracy :  0.7373134328358208
test accuracy :  0.716547118476379
last test_accuracy :  0.7209992579767499
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=143, weight_decay=1e-08)
device :  cuda:0
Counter({1: 2597, 0: 2547, 2: 2256})

Epoch :  1 loss training:  211.56546318531036 Time :  26701
accuracy train: 0.668432 val: 0.600000 test: 0.619095
max validation accuracy : 0.600000 max acc epoch : 1 test accuracy : 0.619095
Counter({0: 3289, 1: 2334, 2: 1777})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  142.69030392169952 Time :  26813
accuracy train: 0.716744 val: 0.635821 test: 0.655207
max validation accuracy : 0.635821 max acc epoch : 2 test accuracy : 0.655207
Counter({1: 4474, 0: 1628, 2: 1298})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  124.22362625598907 Time :  26945
accuracy train: 0.768365 val: 0.662687 test: 0.667574
max validation accuracy : 0.662687 max acc epoch : 3 test accuracy : 0.667574
Counter({1: 2877, 0: 2277, 2: 2246})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  95.87582328915596 Time :  27057
accuracy train: 0.810060 val: 0.674627 test: 0.706406
max validation accuracy : 0.674627 max acc epoch : 4 test accuracy : 0.706406
Counter({0: 2818, 1: 2525, 2: 2057})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  87.26401799917221 Time :  27156
accuracy train: 0.830907 val: 0.698507 test: 0.691813
max validation accuracy : 0.698507 max acc epoch : 5 test accuracy : 0.691813
Counter({0: 3542, 2: 2455, 1: 1403})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  82.51944759488106 Time :  27245
accuracy train: 0.833223 val: 0.680597 test: 0.702696
max validation accuracy : 0.698507 max acc epoch : 5 test accuracy : 0.691813
Counter({1: 2670, 0: 2465, 2: 2265})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  72.01275679469109 Time :  27354
accuracy train: 0.874255 val: 0.689552 test: 0.706901
max validation accuracy : 0.698507 max acc epoch : 5 test accuracy : 0.691813
Counter({1: 2756, 0: 2564, 2: 2080})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.86490514874458 Time :  27457
accuracy train: 0.886168 val: 0.710448 test: 0.714568
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.714568
Counter({1: 2668, 2: 2564, 0: 2168})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.351183578372 Time :  27565
accuracy train: 0.886499 val: 0.701493 test: 0.711106
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.714568
Counter({1: 3496, 0: 2468, 2: 1436})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  58.21955128014088 Time :  27674
accuracy train: 0.908339 val: 0.704478 test: 0.719021
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.714568
Counter({1: 3423, 2: 2524, 0: 1453})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  56.650023475289345 Time :  27788
accuracy train: 0.908339 val: 0.686567 test: 0.721247
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.714568
Counter({0: 3436, 1: 2527, 2: 1437})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  55.141400292515755 Time :  27900
accuracy train: 0.915288 val: 0.701493 test: 0.721494
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.714568
Counter({2: 3421, 0: 2459, 1: 1520})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  50.72106944024563 Time :  27996
accuracy train: 0.919921 val: 0.707463 test: 0.724215
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.714568
Counter({1: 2703, 2: 2540, 0: 2157})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  51.994110852479935 Time :  28104
accuracy train: 0.922237 val: 0.707463 test: 0.720257
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.714568
Counter({2: 2648, 1: 2579, 0: 2173})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  50.32903832197189 Time :  28200
accuracy train: 0.922899 val: 0.716418 test: 0.720999
max validation accuracy : 0.716418 max acc epoch : 15 test accuracy : 0.720999
Counter({0: 2599, 1: 2592, 2: 2209})

Epoch :  16 loss training:  48.27397133409977 Time :  28297
accuracy train: 0.927862 val: 0.716418 test: 0.717536
max validation accuracy : 0.716418 max acc epoch : 15 test accuracy : 0.720999
Counter({0: 2627, 1: 2601, 2: 2172})

Epoch :  17 loss training:  48.761955842375755 Time :  28405
accuracy train: 0.935804 val: 0.710448 test: 0.719268
max validation accuracy : 0.716418 max acc epoch : 15 test accuracy : 0.720999
Counter({2: 2653, 0: 2605, 1: 2142})

Epoch :  18 loss training:  47.54081366956234 Time :  28520
accuracy train: 0.941099 val: 0.716418 test: 0.721741
max validation accuracy : 0.716418 max acc epoch : 15 test accuracy : 0.720999
Counter({0: 2673, 1: 2592, 2: 2135})

Epoch :  19 loss training:  45.51390090584755 Time :  28646
accuracy train: 0.943746 val: 0.713433 test: 0.719515
max validation accuracy : 0.716418 max acc epoch : 15 test accuracy : 0.720999
Counter({1: 3454, 2: 2537, 0: 1409})

Epoch :  20 loss training:  43.09988234937191 Time :  28755
accuracy train: 0.949040 val: 0.722388 test: 0.722236
max validation accuracy : 0.722388 max acc epoch : 20 test accuracy : 0.722236
Counter({1: 2656, 2: 2585, 0: 2159})

Epoch :  21 loss training:  42.68772388994694 Time :  28855
accuracy train: 0.950695 val: 0.728358 test: 0.724957
max validation accuracy : 0.728358 max acc epoch : 21 test accuracy : 0.724957
Counter({0: 2688, 2: 2554, 1: 2158})

Epoch :  22 loss training:  40.54453895241022 Time :  28949
accuracy train: 0.955328 val: 0.719403 test: 0.723967
max validation accuracy : 0.728358 max acc epoch : 21 test accuracy : 0.724957
Counter({2: 2691, 1: 2588, 0: 2121})

Epoch :  23 loss training:  38.65728776156902 Time :  29062
accuracy train: 0.957975 val: 0.722388 test: 0.719021
max validation accuracy : 0.728358 max acc epoch : 21 test accuracy : 0.724957
Counter({0: 2724, 1: 2582, 2: 2094})

Epoch :  24 loss training:  37.9237365424633 Time :  29173
accuracy train: 0.959298 val: 0.722388 test: 0.718526
max validation accuracy : 0.728358 max acc epoch : 21 test accuracy : 0.724957
Counter({0: 2720, 1: 2524, 2: 2156})

Epoch :  25 loss training:  38.16786190122366 Time :  29286
accuracy train: 0.963600 val: 0.728358 test: 0.724462
max validation accuracy : 0.728358 max acc epoch : 21 test accuracy : 0.724957
Counter({2: 2706, 0: 2559, 1: 2135})

Epoch :  26 loss training:  35.798011377453804 Time :  29372
accuracy train: 0.967571 val: 0.710448 test: 0.719515
max validation accuracy : 0.728358 max acc epoch : 21 test accuracy : 0.724957
Counter({1: 2721, 2: 2618, 0: 2061})

Epoch :  27 loss training:  35.02046611905098 Time :  29461
accuracy train: 0.969887 val: 0.710448 test: 0.720257
max validation accuracy : 0.728358 max acc epoch : 21 test accuracy : 0.724957
Counter({2: 2735, 0: 2610, 1: 2055})

Epoch :  28 loss training:  32.71189009398222 Time :  29551
accuracy train: 0.970880 val: 0.716418 test: 0.722236
max validation accuracy : 0.728358 max acc epoch : 21 test accuracy : 0.724957
Counter({2: 2735, 1: 2619, 0: 2046})

Epoch :  29 loss training:  31.998424917459488 Time :  29630
accuracy train: 0.971542 val: 0.719403 test: 0.722731
max validation accuracy : 0.728358 max acc epoch : 21 test accuracy : 0.724957
Counter({1: 2705, 2: 2580, 0: 2115})

Epoch :  30 loss training:  30.156594157218933 Time :  29709
accuracy train: 0.975844 val: 0.728358 test: 0.720505
max validation accuracy : 0.728358 max acc epoch : 21 test accuracy : 0.724957
Counter({0: 2724, 1: 2589, 2: 2087})

Epoch :  31 loss training:  29.639647640287876 Time :  29789
accuracy train: 0.976506 val: 0.716418 test: 0.720257
max validation accuracy : 0.728358 max acc epoch : 21 test accuracy : 0.724957
Counter({1: 3427, 2: 2583, 0: 1390})

Epoch :  32 loss training:  28.024894520640373 Time :  29871
accuracy train: 0.977498 val: 0.710448 test: 0.719021
max validation accuracy : 0.728358 max acc epoch : 21 test accuracy : 0.724957
Counter({0: 2759, 1: 2556, 2: 2085})

Epoch :  33 loss training:  27.019771549850702 Time :  29946
accuracy train: 0.984778 val: 0.731343 test: 0.720505
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({1: 2719, 2: 2631, 0: 2050})

Epoch :  34 loss training:  26.94961492717266 Time :  30022
accuracy train: 0.982793 val: 0.728358 test: 0.724215
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({1: 2739, 2: 2589, 0: 2072})

Epoch :  35 loss training:  25.344436306506395 Time :  30100
accuracy train: 0.985440 val: 0.713433 test: 0.719763
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({1: 2733, 2: 2586, 0: 2081})

Epoch :  36 loss training:  25.460029248148203 Time :  30186
accuracy train: 0.986764 val: 0.716418 test: 0.719268
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({2: 2679, 1: 2674, 0: 2047})

Epoch :  37 loss training:  24.35219866782427 Time :  30259
accuracy train: 0.988749 val: 0.725373 test: 0.723720
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({1: 3449, 2: 2593, 0: 1358})

Epoch :  38 loss training:  23.09167842939496 Time :  30335
accuracy train: 0.988749 val: 0.719403 test: 0.722978
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({0: 2783, 2: 2542, 1: 2075})

Epoch :  39 loss training:  22.77671080455184 Time :  30409
accuracy train: 0.991727 val: 0.719403 test: 0.720752
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({0: 2704, 2: 2541, 1: 2155})

Epoch :  40 loss training:  21.38499078154564 Time :  30479
accuracy train: 0.993382 val: 0.722388 test: 0.718526
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({1: 3465, 2: 2575, 0: 1360})

Epoch :  41 loss training:  18.805435214191675 Time :  30544
accuracy train: 0.993382 val: 0.713433 test: 0.718773
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({1: 3469, 2: 2551, 0: 1380})

Epoch :  42 loss training:  19.780353527516127 Time :  30620
accuracy train: 0.993713 val: 0.713433 test: 0.718773
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({1: 2749, 0: 2525, 2: 2126})

Epoch :  43 loss training:  19.294439554214478 Time :  30688
accuracy train: 0.993382 val: 0.719403 test: 0.718526
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({1: 3458, 2: 2591, 0: 1351})

Epoch :  44 loss training:  18.64398367330432 Time :  30763
accuracy train: 0.994375 val: 0.713433 test: 0.719515
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({0: 3515, 2: 2563, 1: 1322})

Epoch :  45 loss training:  18.791582733392715 Time :  30831
accuracy train: 0.995698 val: 0.713433 test: 0.718279
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({1: 3559, 2: 2530, 0: 1311})

Epoch :  46 loss training:  16.64909017086029 Time :  30925
accuracy train: 0.996360 val: 0.716418 test: 0.724215
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({0: 3528, 2: 2503, 1: 1369})

Epoch :  47 loss training:  17.44763927347958 Time :  31004
accuracy train: 0.996691 val: 0.716418 test: 0.720752
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({0: 2771, 2: 2517, 1: 2112})

Epoch :  48 loss training:  16.000215630978346 Time :  31080
accuracy train: 0.997684 val: 0.716418 test: 0.721989
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({0: 3464, 1: 2609, 2: 1327})

Epoch :  49 loss training:  15.23982104845345 Time :  31143
accuracy train: 0.998345 val: 0.722388 test: 0.720505
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({0: 3516, 2: 2578, 1: 1306})

Epoch :  50 loss training:  14.255507173016667 Time :  31209
accuracy train: 0.998345 val: 0.725373 test: 0.721741
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({1: 3511, 2: 2552, 0: 1337})

Epoch :  51 loss training:  14.66209519840777 Time :  31275
accuracy train: 0.998345 val: 0.722388 test: 0.725451
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({2: 3566, 1: 2523, 0: 1311})

Epoch :  52 loss training:  13.083512054756284 Time :  31337
accuracy train: 0.998345 val: 0.713433 test: 0.723967
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({0: 3540, 1: 2539, 2: 1321})

Epoch :  53 loss training:  13.12246736139059 Time :  31399
accuracy train: 0.999338 val: 0.704478 test: 0.718526
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({1: 4688, 2: 1409, 0: 1303})

Epoch :  54 loss training:  14.267670635133982 Time :  31463
accuracy train: 0.999338 val: 0.728358 test: 0.722483
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({1: 3502, 2: 2587, 0: 1311})

Epoch :  55 loss training:  12.394693713635206 Time :  31526
accuracy train: 0.999669 val: 0.728358 test: 0.723473
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({0: 3361, 1: 2669, 2: 1370})

Epoch :  56 loss training:  12.83842707425356 Time :  31595
accuracy train: 1.000000 val: 0.713433 test: 0.720752
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({0: 4671, 2: 1423, 1: 1306})

Epoch :  57 loss training:  11.363994378596544 Time :  31661
accuracy train: 1.000000 val: 0.719403 test: 0.718773
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({0: 2752, 2: 2576, 1: 2072})

Epoch :  58 loss training:  10.323459370061755 Time :  31723
accuracy train: 1.000000 val: 0.725373 test: 0.722978
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({0: 4665, 1: 1388, 2: 1347})

Epoch :  59 loss training:  10.482293794862926 Time :  31790
accuracy train: 1.000000 val: 0.701493 test: 0.722731
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({1: 3556, 2: 2573, 0: 1271})

Epoch :  60 loss training:  9.863893054425716 Time :  31856
accuracy train: 0.999669 val: 0.707463 test: 0.719021
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({0: 3592, 2: 2553, 1: 1255})

Epoch :  61 loss training:  9.725193664431572 Time :  31918
accuracy train: 1.000000 val: 0.731343 test: 0.722483
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({0: 4680, 2: 1383, 1: 1337})

Epoch :  62 loss training:  10.006949691101909 Time :  31979
accuracy train: 1.000000 val: 0.713433 test: 0.718031
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({0: 3494, 2: 2613, 1: 1293})

Epoch :  63 loss training:  8.589735104702413 Time :  32043
accuracy train: 1.000000 val: 0.725373 test: 0.723225
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({0: 4678, 1: 1397, 2: 1325})

Epoch :  64 loss training:  8.646594321355224 Time :  32109
accuracy train: 1.000000 val: 0.722388 test: 0.723967
max validation accuracy : 0.731343 max acc epoch : 33 test accuracy : 0.720505
Counter({1: 4688, 2: 1386, 0: 1326})

========================================================================================================================================================================================================
max acc epoch :  33
max validation accuracy :  0.7313432835820896
test accuracy :  0.720504575810042
last test_accuracy :  0.7239673509769973
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=143, weight_decay=1e-08)
device :  cuda:0
Counter({1: 2597, 0: 2547, 2: 2256})

Epoch :  1 loss training:  211.61600023508072 Time :  32229
accuracy train: 0.664130 val: 0.600000 test: 0.619095
max validation accuracy : 0.600000 max acc epoch : 1 test accuracy : 0.619095
Counter({2: 3268, 0: 2369, 1: 1763})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  142.93592476844788 Time :  32289
accuracy train: 0.711449 val: 0.638806 test: 0.655949
max validation accuracy : 0.638806 max acc epoch : 2 test accuracy : 0.655949
Counter({0: 4504, 1: 1598, 2: 1298})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  124.89694428443909 Time :  32356
accuracy train: 0.764725 val: 0.650746 test: 0.666584
max validation accuracy : 0.650746 max acc epoch : 3 test accuracy : 0.666584
Counter({0: 2803, 1: 2393, 2: 2204})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  96.47230315208435 Time :  32414
accuracy train: 0.808736 val: 0.680597 test: 0.704922
max validation accuracy : 0.680597 max acc epoch : 4 test accuracy : 0.704922
Counter({1: 2825, 0: 2521, 2: 2054})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  87.49761781096458 Time :  32482
accuracy train: 0.818663 val: 0.692537 test: 0.693050
max validation accuracy : 0.692537 max acc epoch : 5 test accuracy : 0.693050
Counter({2: 3517, 0: 2469, 1: 1414})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  82.67212443053722 Time :  32540
accuracy train: 0.830907 val: 0.686567 test: 0.704180
max validation accuracy : 0.692537 max acc epoch : 5 test accuracy : 0.693050
Counter({1: 2698, 0: 2506, 2: 2196})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  72.10739427804947 Time :  32606
accuracy train: 0.871939 val: 0.695522 test: 0.707643
max validation accuracy : 0.695522 max acc epoch : 7 test accuracy : 0.707643
Counter({0: 2751, 1: 2605, 2: 2044})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.54530157148838 Time :  32665
accuracy train: 0.882528 val: 0.707463 test: 0.716052
max validation accuracy : 0.707463 max acc epoch : 8 test accuracy : 0.716052
Counter({1: 2723, 2: 2541, 0: 2136})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.8843155503273 Time :  32722
accuracy train: 0.888484 val: 0.695522 test: 0.708385
max validation accuracy : 0.707463 max acc epoch : 8 test accuracy : 0.716052
Counter({0: 3440, 1: 2523, 2: 1437})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  58.030111238360405 Time :  32788
accuracy train: 0.904699 val: 0.698507 test: 0.719021
max validation accuracy : 0.707463 max acc epoch : 8 test accuracy : 0.716052
Counter({1: 3411, 2: 2545, 0: 1444})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  56.71173141896725 Time :  32859
accuracy train: 0.909662 val: 0.695522 test: 0.720999
max validation accuracy : 0.707463 max acc epoch : 8 test accuracy : 0.716052
Counter({1: 3410, 2: 2545, 0: 1445})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  55.15909090638161 Time :  32931
accuracy train: 0.912310 val: 0.698507 test: 0.721494
max validation accuracy : 0.707463 max acc epoch : 8 test accuracy : 0.716052
Counter({1: 3438, 2: 2504, 0: 1458})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  50.706746965646744 Time :  32998
accuracy train: 0.919590 val: 0.710448 test: 0.721989
max validation accuracy : 0.710448 max acc epoch : 13 test accuracy : 0.721989
Counter({0: 3447, 1: 2533, 2: 1420})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  51.464925304055214 Time :  33063
accuracy train: 0.923561 val: 0.698507 test: 0.718773
max validation accuracy : 0.710448 max acc epoch : 13 test accuracy : 0.721989
Counter({0: 2674, 2: 2571, 1: 2155})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  50.28649388253689 Time :  33128
accuracy train: 0.922568 val: 0.695522 test: 0.717289
max validation accuracy : 0.710448 max acc epoch : 13 test accuracy : 0.721989
Counter({0: 2609, 1: 2592, 2: 2199})

Epoch :  16 loss training:  48.41876804828644 Time :  33195
accuracy train: 0.930179 val: 0.710448 test: 0.718031
max validation accuracy : 0.710448 max acc epoch : 13 test accuracy : 0.721989
Counter({0: 3449, 1: 2559, 2: 1392})

Epoch :  17 loss training:  48.601538851857185 Time :  33256
accuracy train: 0.936466 val: 0.698507 test: 0.716547
max validation accuracy : 0.710448 max acc epoch : 13 test accuracy : 0.721989
Counter({0: 3436, 1: 2553, 2: 1411})

Epoch :  18 loss training:  47.10135543346405 Time :  33320
accuracy train: 0.938782 val: 0.707463 test: 0.718031
max validation accuracy : 0.710448 max acc epoch : 13 test accuracy : 0.721989
Counter({0: 3487, 1: 2506, 2: 1407})

Epoch :  19 loss training:  45.31000803411007 Time :  33384
accuracy train: 0.941430 val: 0.710448 test: 0.720257
max validation accuracy : 0.710448 max acc epoch : 13 test accuracy : 0.721989
Counter({2: 3465, 0: 2500, 1: 1435})

Epoch :  20 loss training:  42.966932252049446 Time :  33446
accuracy train: 0.947717 val: 0.716418 test: 0.719268
max validation accuracy : 0.716418 max acc epoch : 20 test accuracy : 0.719268
Counter({2: 3464, 0: 2531, 1: 1405})

Epoch :  21 loss training:  41.78304181993008 Time :  33508
accuracy train: 0.951688 val: 0.725373 test: 0.719268
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({1: 3479, 2: 2523, 0: 1398})

Epoch :  22 loss training:  40.03193621337414 Time :  33573
accuracy train: 0.955659 val: 0.710448 test: 0.720010
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({0: 3532, 2: 2491, 1: 1377})

Epoch :  23 loss training:  38.22295746207237 Time :  33632
accuracy train: 0.961284 val: 0.713433 test: 0.718526
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({0: 3497, 1: 2535, 2: 1368})

Epoch :  24 loss training:  37.214450001716614 Time :  33695
accuracy train: 0.960622 val: 0.713433 test: 0.719021
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({0: 3542, 1: 2491, 2: 1367})

Epoch :  25 loss training:  37.74837926030159 Time :  33760
accuracy train: 0.962608 val: 0.713433 test: 0.723967
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({2: 3503, 0: 2514, 1: 1383})

Epoch :  26 loss training:  35.39607997238636 Time :  33823
accuracy train: 0.965917 val: 0.704478 test: 0.717784
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({0: 2772, 2: 2571, 1: 2057})

Epoch :  27 loss training:  34.736420545727015 Time :  33885
accuracy train: 0.971211 val: 0.713433 test: 0.718526
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({1: 2712, 2: 2626, 0: 2062})

Epoch :  28 loss training:  32.35775829106569 Time :  33947
accuracy train: 0.973527 val: 0.722388 test: 0.720010
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({0: 2777, 2: 2574, 1: 2049})

Epoch :  29 loss training:  32.01917142421007 Time :  34013
accuracy train: 0.971873 val: 0.716418 test: 0.717784
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({0: 3460, 1: 2532, 2: 1408})

Epoch :  30 loss training:  30.045262567698956 Time :  34076
accuracy train: 0.977829 val: 0.716418 test: 0.719515
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({2: 3450, 0: 2550, 1: 1400})

Epoch :  31 loss training:  29.217632614076138 Time :  34141
accuracy train: 0.979484 val: 0.698507 test: 0.716300
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({1: 3465, 2: 2549, 0: 1386})

Epoch :  32 loss training:  27.909946881234646 Time :  34202
accuracy train: 0.980477 val: 0.698507 test: 0.718031
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({2: 2776, 0: 2540, 1: 2084})

Epoch :  33 loss training:  26.85688817128539 Time :  34263
accuracy train: 0.983786 val: 0.722388 test: 0.717536
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({0: 3443, 2: 2559, 1: 1398})

Epoch :  34 loss training:  26.609139505773783 Time :  34321
accuracy train: 0.984116 val: 0.713433 test: 0.722731
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({1: 3491, 2: 2517, 0: 1392})

Epoch :  35 loss training:  25.376974776387215 Time :  34382
accuracy train: 0.986433 val: 0.713433 test: 0.719515
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({0: 3457, 1: 2552, 2: 1391})

Epoch :  36 loss training:  25.066459633409977 Time :  34444
accuracy train: 0.986433 val: 0.722388 test: 0.717536
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({0: 3473, 2: 2565, 1: 1362})

Epoch :  37 loss training:  23.752708598971367 Time :  34507
accuracy train: 0.988087 val: 0.725373 test: 0.719021
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({0: 3495, 1: 2542, 2: 1363})

Epoch :  38 loss training:  22.814614180475473 Time :  34568
accuracy train: 0.988418 val: 0.725373 test: 0.720010
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({2: 2782, 0: 2532, 1: 2086})

Epoch :  39 loss training:  22.643314842134714 Time :  34628
accuracy train: 0.992720 val: 0.713433 test: 0.716547
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({0: 3470, 2: 2539, 1: 1391})

Epoch :  40 loss training:  21.022512640804052 Time :  34689
accuracy train: 0.993051 val: 0.713433 test: 0.716052
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({0: 3489, 2: 2524, 1: 1387})

Epoch :  41 loss training:  18.53667574748397 Time :  34750
accuracy train: 0.994375 val: 0.713433 test: 0.716300
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({0: 3507, 1: 2486, 2: 1407})

Epoch :  42 loss training:  19.559713568538427 Time :  34810
accuracy train: 0.993051 val: 0.719403 test: 0.716547
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({0: 3509, 1: 2481, 2: 1410})

Epoch :  43 loss training:  19.481824703514576 Time :  34867
accuracy train: 0.994375 val: 0.725373 test: 0.714074
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({0: 3514, 2: 2525, 1: 1361})

Epoch :  44 loss training:  18.43009677156806 Time :  34925
accuracy train: 0.994705 val: 0.713433 test: 0.716300
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({1: 3517, 2: 2541, 0: 1342})

Epoch :  45 loss training:  18.571012876927853 Time :  34985
accuracy train: 0.994705 val: 0.722388 test: 0.719763
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({2: 3572, 0: 2501, 1: 1327})

Epoch :  46 loss training:  16.769857252016664 Time :  35044
accuracy train: 0.995367 val: 0.716418 test: 0.721494
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({0: 3581, 2: 2478, 1: 1341})

Epoch :  47 loss training:  17.301172096282244 Time :  35107
accuracy train: 0.997353 val: 0.719403 test: 0.720257
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({0: 3541, 1: 2521, 2: 1338})

Epoch :  48 loss training:  15.582624308764935 Time :  35169
accuracy train: 0.997353 val: 0.725373 test: 0.714074
max validation accuracy : 0.725373 max acc epoch : 21 test accuracy : 0.719268
Counter({0: 3524, 1: 2540, 2: 1336})

Epoch :  49 loss training:  14.896744579076767 Time :  35234
accuracy train: 0.998015 val: 0.734328 test: 0.717536
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.717536
Counter({0: 3561, 2: 2533, 1: 1306})

Epoch :  50 loss training:  14.01749250665307 Time :  35300
accuracy train: 0.998015 val: 0.716418 test: 0.718279
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.717536
Counter({0: 3566, 2: 2501, 1: 1333})

Epoch :  51 loss training:  14.483019508421421 Time :  35352
accuracy train: 0.998015 val: 0.716418 test: 0.722731
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.717536
Counter({2: 3576, 0: 2497, 1: 1327})

Epoch :  52 loss training:  12.834509199485183 Time :  35400
accuracy train: 0.998345 val: 0.725373 test: 0.720010
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.717536
Counter({1: 3547, 2: 2509, 0: 1344})

Epoch :  53 loss training:  13.068134110420942 Time :  35449
accuracy train: 1.000000 val: 0.716418 test: 0.716794
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.717536
Counter({1: 3618, 2: 2478, 0: 1304})

Epoch :  54 loss training:  14.02483950741589 Time :  35495
accuracy train: 0.999007 val: 0.725373 test: 0.716547
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.717536
Counter({0: 3581, 2: 2485, 1: 1334})

Epoch :  55 loss training:  12.343015052378178 Time :  35537
accuracy train: 0.999669 val: 0.731343 test: 0.714816
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.717536
Counter({0: 4644, 1: 1421, 2: 1335})

Epoch :  56 loss training:  12.818391811102629 Time :  35579
accuracy train: 1.000000 val: 0.719403 test: 0.715063
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.717536
Counter({0: 4649, 2: 1423, 1: 1328})

Epoch :  57 loss training:  11.356533113867044 Time :  35619
accuracy train: 1.000000 val: 0.722388 test: 0.715805
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.717536
Counter({1: 3566, 2: 2489, 0: 1345})

Epoch :  58 loss training:  10.323697524145246 Time :  35656
accuracy train: 1.000000 val: 0.731343 test: 0.718526
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.717536
Counter({1: 3565, 2: 2480, 0: 1355})

Epoch :  59 loss training:  10.482930755242705 Time :  35695
accuracy train: 0.999669 val: 0.713433 test: 0.717536
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.717536
Counter({0: 3624, 1: 2508, 2: 1268})

Epoch :  60 loss training:  9.996159225702286 Time :  35733
accuracy train: 1.000000 val: 0.704478 test: 0.714074
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.717536
Counter({0: 3603, 2: 2524, 1: 1273})

Epoch :  61 loss training:  9.587427768856287 Time :  35771
accuracy train: 1.000000 val: 0.725373 test: 0.714816
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.717536
Counter({1: 4703, 2: 1351, 0: 1346})

Epoch :  62 loss training:  10.184924816712737 Time :  35817
accuracy train: 1.000000 val: 0.716418 test: 0.713332
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.717536
Counter({1: 3500, 2: 2601, 0: 1299})

Epoch :  63 loss training:  8.51913049723953 Time :  35858
accuracy train: 1.000000 val: 0.725373 test: 0.719021
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.717536
Counter({1: 4692, 2: 1370, 0: 1338})

Epoch :  64 loss training:  9.057538188062608 Time :  35899
accuracy train: 1.000000 val: 0.722388 test: 0.716794
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.717536
Counter({2: 4733, 0: 1357, 1: 1310})

Epoch :  65 loss training:  8.194554851390421 Time :  35942
accuracy train: 1.000000 val: 0.713433 test: 0.717042
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.717536
Counter({1: 4707, 2: 1384, 0: 1309})

Epoch :  66 loss training:  7.991262109950185 Time :  35985
accuracy train: 1.000000 val: 0.725373 test: 0.718279
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.717536
Counter({0: 4735, 2: 1357, 1: 1308})

Epoch :  67 loss training:  8.038130232132971 Time :  36028
accuracy train: 1.000000 val: 0.722388 test: 0.719021
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.717536
Counter({2: 4730, 1: 1375, 0: 1295})

Epoch :  68 loss training:  8.403174814768136 Time :  36071
accuracy train: 1.000000 val: 0.725373 test: 0.715310
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.717536
Counter({1: 4738, 2: 1352, 0: 1310})

Epoch :  69 loss training:  7.130642614327371 Time :  36113
accuracy train: 1.000000 val: 0.719403 test: 0.717289
max validation accuracy : 0.734328 max acc epoch : 49 test accuracy : 0.717536
Counter({2: 4721, 0: 1378, 1: 1301})

Epoch :  70 loss training:  7.094562490470707 Time :  36159
accuracy train: 1.000000 val: 0.737313 test: 0.718526
max validation accuracy : 0.737313 max acc epoch : 70 test accuracy : 0.718526
Counter({2: 4703, 1: 1377, 0: 1320})

Epoch :  71 loss training:  7.432641497813165 Time :  36202
accuracy train: 1.000000 val: 0.716418 test: 0.716794
max validation accuracy : 0.737313 max acc epoch : 70 test accuracy : 0.718526
Counter({0: 4752, 2: 1378, 1: 1270})

Epoch :  72 loss training:  6.488008444197476 Time :  36244
accuracy train: 1.000000 val: 0.728358 test: 0.718773
max validation accuracy : 0.737313 max acc epoch : 70 test accuracy : 0.718526
Counter({0: 3629, 2: 2471, 1: 1300})

Epoch :  73 loss training:  7.791520251892507 Time :  36286
accuracy train: 1.000000 val: 0.719403 test: 0.717042
max validation accuracy : 0.737313 max acc epoch : 70 test accuracy : 0.718526
Counter({0: 3607, 2: 2561, 1: 1232})

Epoch :  74 loss training:  6.578705234453082 Time :  36327
accuracy train: 1.000000 val: 0.740299 test: 0.716547
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({1: 4738, 2: 1361, 0: 1301})

Epoch :  75 loss training:  6.62647979427129 Time :  36370
accuracy train: 1.000000 val: 0.728358 test: 0.715805
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({1: 4750, 0: 1359, 2: 1291})

Epoch :  76 loss training:  5.9440099047496915 Time :  36410
accuracy train: 1.000000 val: 0.719403 test: 0.716052
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4705, 2: 1366, 1: 1329})

Epoch :  77 loss training:  5.883989045396447 Time :  36451
accuracy train: 1.000000 val: 0.713433 test: 0.715063
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({1: 4734, 2: 1367, 0: 1299})

Epoch :  78 loss training:  6.073427593801171 Time :  36493
accuracy train: 1.000000 val: 0.722388 test: 0.717536
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4683, 1: 1359, 2: 1358})

Epoch :  79 loss training:  5.804680525558069 Time :  36534
accuracy train: 1.000000 val: 0.722388 test: 0.711106
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4714, 2: 1378, 1: 1308})

Epoch :  80 loss training:  5.684543136972934 Time :  36577
accuracy train: 1.000000 val: 0.725373 test: 0.715805
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({1: 3510, 2: 2575, 0: 1315})

Epoch :  81 loss training:  5.13826357992366 Time :  36620
accuracy train: 1.000000 val: 0.716418 test: 0.716794
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4716, 2: 1361, 1: 1323})

Epoch :  82 loss training:  4.957172385882586 Time :  36661
accuracy train: 1.000000 val: 0.722388 test: 0.718279
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({1: 3666, 0: 2445, 2: 1289})

Epoch :  83 loss training:  4.346811164170504 Time :  36704
accuracy train: 1.000000 val: 0.716418 test: 0.716794
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({2: 4731, 1: 1361, 0: 1308})

Epoch :  84 loss training:  5.526817659381777 Time :  36747
accuracy train: 1.000000 val: 0.716418 test: 0.712590
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4758, 2: 1348, 1: 1294})

Epoch :  85 loss training:  4.253778804093599 Time :  36788
accuracy train: 1.000000 val: 0.716418 test: 0.720010
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4753, 2: 1344, 1: 1303})

Epoch :  86 loss training:  4.135959119070321 Time :  36833
accuracy train: 1.000000 val: 0.716418 test: 0.713579
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4787, 2: 1333, 1: 1280})

Epoch :  87 loss training:  4.013672421919182 Time :  36877
accuracy train: 1.000000 val: 0.719403 test: 0.713579
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({1: 4796, 2: 1341, 0: 1263})

Epoch :  88 loss training:  3.9382363432087004 Time :  36919
accuracy train: 1.000000 val: 0.719403 test: 0.718279
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({1: 4829, 0: 1331, 2: 1240})

Epoch :  89 loss training:  4.126706290990114 Time :  36963
accuracy train: 1.000000 val: 0.722388 test: 0.717536
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4123, 1: 2053, 2: 1224})

Epoch :  90 loss training:  4.04439065232873 Time :  37006
accuracy train: 1.000000 val: 0.695522 test: 0.718031
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4771, 2: 1342, 1: 1287})

Epoch :  91 loss training:  3.3781706587178633 Time :  37050
accuracy train: 1.000000 val: 0.716418 test: 0.713579
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({1: 3647, 2: 2494, 0: 1259})

Epoch :  92 loss training:  3.845433815382421 Time :  37094
accuracy train: 1.000000 val: 0.701493 test: 0.715310
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4799, 1: 1335, 2: 1266})

Epoch :  93 loss training:  4.06951114628464 Time :  37136
accuracy train: 1.000000 val: 0.707463 test: 0.717042
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4795, 2: 1332, 1: 1273})

Epoch :  94 loss training:  3.5161837772466242 Time :  37182
accuracy train: 1.000000 val: 0.716418 test: 0.714816
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({1: 4800, 0: 1343, 2: 1257})

Epoch :  95 loss training:  3.8007526956498623 Time :  37228
accuracy train: 1.000000 val: 0.719403 test: 0.718279
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4800, 1: 1350, 2: 1250})

Epoch :  96 loss training:  3.1705591436475515 Time :  37271
accuracy train: 1.000000 val: 0.716418 test: 0.715558
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4816, 1: 1319, 2: 1265})

Epoch :  97 loss training:  2.961405645357445 Time :  37314
accuracy train: 1.000000 val: 0.707463 test: 0.714816
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4783, 2: 1322, 1: 1295})

Epoch :  98 loss training:  3.1051522677298635 Time :  37357
accuracy train: 1.000000 val: 0.710448 test: 0.715310
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({1: 4854, 0: 1323, 2: 1223})

Epoch :  99 loss training:  2.9670818399172276 Time :  37401
accuracy train: 1.000000 val: 0.725373 test: 0.715063
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({1: 3478, 0: 2647, 2: 1275})

Epoch :  100 loss training:  3.5001304449979216 Time :  37444
accuracy train: 1.000000 val: 0.719403 test: 0.718773
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4771, 2: 1373, 1: 1256})

Epoch :  101 loss training:  2.723646174184978 Time :  37486
accuracy train: 1.000000 val: 0.710448 test: 0.718279
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4782, 2: 1349, 1: 1269})

Epoch :  102 loss training:  3.2588670302648097 Time :  37529
accuracy train: 1.000000 val: 0.713433 test: 0.712342
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({2: 4787, 1: 1361, 0: 1252})

Epoch :  103 loss training:  2.657193468301557 Time :  37572
accuracy train: 1.000000 val: 0.719403 test: 0.714568
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4841, 2: 1324, 1: 1235})

Epoch :  104 loss training:  2.5760340344859287 Time :  37616
accuracy train: 1.000000 val: 0.719403 test: 0.717289
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4835, 2: 1336, 1: 1229})

Epoch :  105 loss training:  2.1904562143608928 Time :  37663
accuracy train: 1.000000 val: 0.710448 test: 0.716300
max validation accuracy : 0.740299 max acc epoch : 74 test accuracy : 0.716547
Counter({0: 4083, 2: 2093, 1: 1224})

========================================================================================================================================================================================================
max acc epoch :  74
max validation accuracy :  0.7402985074626866
test accuracy :  0.716547118476379
last test_accuracy :  0.716299777393025
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.73433 	 test_accuracy : 0.72595 	 max_acc epoch :  67 	 last test_accuracy : 0.72100
k :  1 	 val_accuracy : 0.73731 	 test_accuracy : 0.71655 	 max_acc epoch :  74 	 last test_accuracy : 0.72100
k :  2 	 val_accuracy : 0.73134 	 test_accuracy : 0.72050 	 max_acc epoch :  33 	 last test_accuracy : 0.72397
k :  3 	 val_accuracy : 0.74030 	 test_accuracy : 0.71655 	 max_acc epoch :  74 	 last test_accuracy : 0.71630

avg :  	 val_accuracy : 0.73582 	 test_accuracy : 0.71989 	 last_accuracy : 0.72057
