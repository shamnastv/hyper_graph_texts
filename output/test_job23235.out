date and time :  Tue Jan 26 19:52:37 2021
Namespace(batch_size=16, dataset='R52', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=200, lda=True, lr=0.0005, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=1e-05)
device :  cuda:0
HGNNModel(
  (word_embeddings): Embedding(9333, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=52, bias=True)
    (1): Linear(in_features=200, out_features=52, bias=True)
    (2): Linear(in_features=200, out_features=52, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  307.50963298790157 Time :  38
accuracy train: 0.912771 val: 0.885671 test: 0.886770
max validation accuracy : 0.885671 max acc epoch : 1.000000 test accuracy : 0.886770

Epoch :  2 loss training:  131.49898117221892 Time :  96
accuracy train: 0.935298 val: 0.900915 test: 0.910506
max validation accuracy : 0.900915 max acc epoch : 2.000000 test accuracy : 0.910506

Epoch :  3 loss training:  93.34205138951074 Time :  107
accuracy train: 0.958672 val: 0.932927 test: 0.923346
max validation accuracy : 0.932927 max acc epoch : 3.000000 test accuracy : 0.923346

Epoch :  4 loss training:  74.75519352639094 Time :  117
accuracy train: 0.975779 val: 0.943598 test: 0.928016
max validation accuracy : 0.943598 max acc epoch : 4.000000 test accuracy : 0.928016

Epoch :  5 loss training:  62.59554325044155 Time :  128
accuracy train: 0.977812 val: 0.939024 test: 0.937743
max validation accuracy : 0.943598 max acc epoch : 4.000000 test accuracy : 0.928016

Epoch :  6 loss training:  44.12752676499076 Time :  138
accuracy train: 0.981199 val: 0.940549 test: 0.939689
max validation accuracy : 0.943598 max acc epoch : 4.000000 test accuracy : 0.928016

Epoch :  7 loss training:  36.34956773347221 Time :  148
accuracy train: 0.986111 val: 0.929878 test: 0.941634
max validation accuracy : 0.943598 max acc epoch : 4.000000 test accuracy : 0.928016

Epoch :  8 loss training:  33.282403619756224 Time :  159
accuracy train: 0.990346 val: 0.942073 test: 0.938132
max validation accuracy : 0.943598 max acc epoch : 4.000000 test accuracy : 0.928016

Epoch :  9 loss training:  30.467285747174174 Time :  169
accuracy train: 0.994749 val: 0.939024 test: 0.937743
max validation accuracy : 0.943598 max acc epoch : 4.000000 test accuracy : 0.928016

Epoch :  10 loss training:  27.04369503824273 Time :  180
accuracy train: 0.994580 val: 0.945122 test: 0.937743
max validation accuracy : 0.945122 max acc epoch : 10.000000 test accuracy : 0.937743

Epoch :  11 loss training:  22.45698981411988 Time :  190
accuracy train: 0.994072 val: 0.946646 test: 0.936965
max validation accuracy : 0.946646 max acc epoch : 11.000000 test accuracy : 0.936965

Epoch :  12 loss training:  20.09076016175095 Time :  201
accuracy train: 0.996274 val: 0.943598 test: 0.940467
max validation accuracy : 0.946646 max acc epoch : 11.000000 test accuracy : 0.936965

Epoch :  13 loss training:  16.971186472364934 Time :  212
accuracy train: 0.996443 val: 0.935976 test: 0.939689
max validation accuracy : 0.946646 max acc epoch : 11.000000 test accuracy : 0.936965

Epoch :  14 loss training:  17.108373605820816 Time :  223
accuracy train: 0.996274 val: 0.949695 test: 0.938132
max validation accuracy : 0.949695 max acc epoch : 14.000000 test accuracy : 0.938132

Epoch :  15 loss training:  14.345360701467143 Time :  234
accuracy train: 0.996443 val: 0.951220 test: 0.941245
max validation accuracy : 0.951220 max acc epoch : 15.000000 test accuracy : 0.941245

Epoch :  16 loss training:  12.509783144574612 Time :  245
accuracy train: 0.997121 val: 0.945122 test: 0.940467
max validation accuracy : 0.951220 max acc epoch : 15.000000 test accuracy : 0.941245

Epoch :  17 loss training:  13.30198229540838 Time :  256
accuracy train: 0.997290 val: 0.951220 test: 0.939689
max validation accuracy : 0.951220 max acc epoch : 15.000000 test accuracy : 0.941245

Epoch :  18 loss training:  11.625003886914783 Time :  268
accuracy train: 0.997290 val: 0.945122 test: 0.942802
max validation accuracy : 0.951220 max acc epoch : 15.000000 test accuracy : 0.941245

Epoch :  19 loss training:  12.042966981956852 Time :  279
accuracy train: 0.996612 val: 0.946646 test: 0.943969
max validation accuracy : 0.951220 max acc epoch : 15.000000 test accuracy : 0.941245

Epoch :  20 loss training:  10.190973912023765 Time :  287
accuracy train: 0.996612 val: 0.946646 test: 0.941634
max validation accuracy : 0.951220 max acc epoch : 15.000000 test accuracy : 0.941245

Epoch :  21 loss training:  9.94098172973463 Time :  294
accuracy train: 0.997290 val: 0.943598 test: 0.941634
max validation accuracy : 0.951220 max acc epoch : 15.000000 test accuracy : 0.941245

Epoch :  22 loss training:  11.074447880891967 Time :  302
accuracy train: 0.997121 val: 0.946646 test: 0.942412
max validation accuracy : 0.951220 max acc epoch : 15.000000 test accuracy : 0.941245

Epoch :  23 loss training:  9.306082402836182 Time :  310
accuracy train: 0.997629 val: 0.948171 test: 0.943969
max validation accuracy : 0.951220 max acc epoch : 15.000000 test accuracy : 0.941245

Epoch :  24 loss training:  9.68014671621495 Time :  318
accuracy train: 0.997459 val: 0.949695 test: 0.943969
max validation accuracy : 0.951220 max acc epoch : 15.000000 test accuracy : 0.941245

Epoch :  25 loss training:  9.46166862296377 Time :  327
accuracy train: 0.997459 val: 0.951220 test: 0.944358
max validation accuracy : 0.951220 max acc epoch : 15.000000 test accuracy : 0.941245

Epoch :  26 loss training:  10.239533106738236 Time :  339
accuracy train: 0.997290 val: 0.949695 test: 0.942802
max validation accuracy : 0.951220 max acc epoch : 15.000000 test accuracy : 0.941245

Epoch :  27 loss training:  8.416938834074244 Time :  349
accuracy train: 0.997629 val: 0.946646 test: 0.945525
max validation accuracy : 0.951220 max acc epoch : 15.000000 test accuracy : 0.941245

Epoch :  28 loss training:  7.593789206213842 Time :  360
accuracy train: 0.997459 val: 0.949695 test: 0.942802
max validation accuracy : 0.951220 max acc epoch : 15.000000 test accuracy : 0.941245

Epoch :  29 loss training:  8.031936750761815 Time :  371
accuracy train: 0.997629 val: 0.948171 test: 0.943969
max validation accuracy : 0.951220 max acc epoch : 15.000000 test accuracy : 0.941245

Epoch :  30 loss training:  8.550713172931864 Time :  383
accuracy train: 0.997629 val: 0.948171 test: 0.942802
max validation accuracy : 0.951220 max acc epoch : 15.000000 test accuracy : 0.941245

Epoch :  31 loss training:  8.46559203958168 Time :  395
accuracy train: 0.997290 val: 0.952744 test: 0.943969
max validation accuracy : 0.952744 max acc epoch : 31.000000 test accuracy : 0.943969

Epoch :  32 loss training:  8.501738775870763 Time :  405
accuracy train: 0.997459 val: 0.948171 test: 0.942412
max validation accuracy : 0.952744 max acc epoch : 31.000000 test accuracy : 0.943969

Epoch :  33 loss training:  9.504752284243295 Time :  416
accuracy train: 0.997290 val: 0.948171 test: 0.940856
max validation accuracy : 0.952744 max acc epoch : 31.000000 test accuracy : 0.943969

Epoch :  34 loss training:  8.930051633215044 Time :  427
accuracy train: 0.997629 val: 0.945122 test: 0.942412
max validation accuracy : 0.952744 max acc epoch : 31.000000 test accuracy : 0.943969

Epoch :  35 loss training:  8.838320281021879 Time :  437
accuracy train: 0.997629 val: 0.943598 test: 0.944358
max validation accuracy : 0.952744 max acc epoch : 31.000000 test accuracy : 0.943969

Epoch :  36 loss training:  7.6609092069775215 Time :  448
accuracy train: 0.997290 val: 0.946646 test: 0.942802
max validation accuracy : 0.952744 max acc epoch : 31.000000 test accuracy : 0.943969

Epoch :  37 loss training:  8.65320273936959 Time :  458
accuracy train: 0.997459 val: 0.946646 test: 0.945136
max validation accuracy : 0.952744 max acc epoch : 31.000000 test accuracy : 0.943969

Epoch :  38 loss training:  7.6327339579875115 Time :  468
accuracy train: 0.997459 val: 0.946646 test: 0.945525
max validation accuracy : 0.952744 max acc epoch : 31.000000 test accuracy : 0.943969

Epoch :  39 loss training:  8.23625810552403 Time :  479
accuracy train: 0.997629 val: 0.946646 test: 0.946693
max validation accuracy : 0.952744 max acc epoch : 31.000000 test accuracy : 0.943969

Epoch :  40 loss training:  7.768000526950345 Time :  490
accuracy train: 0.997629 val: 0.946646 test: 0.945525
max validation accuracy : 0.952744 max acc epoch : 31.000000 test accuracy : 0.943969

Epoch :  41 loss training:  8.414778751903214 Time :  500
accuracy train: 0.997629 val: 0.951220 test: 0.945914
max validation accuracy : 0.952744 max acc epoch : 31.000000 test accuracy : 0.943969

Epoch :  42 loss training:  8.453852396836737 Time :  510
accuracy train: 0.997798 val: 0.945122 test: 0.944358
max validation accuracy : 0.952744 max acc epoch : 31.000000 test accuracy : 0.943969

Epoch :  43 loss training:  7.383029502738282 Time :  520
accuracy train: 0.997629 val: 0.948171 test: 0.944747
max validation accuracy : 0.952744 max acc epoch : 31.000000 test accuracy : 0.943969

Epoch :  44 loss training:  7.995357347826939 Time :  531
accuracy train: 0.997459 val: 0.948171 test: 0.943969
max validation accuracy : 0.952744 max acc epoch : 31.000000 test accuracy : 0.943969

Epoch :  45 loss training:  8.472242990348605 Time :  542
accuracy train: 0.997459 val: 0.949695 test: 0.942802
max validation accuracy : 0.952744 max acc epoch : 31.000000 test accuracy : 0.943969

Epoch :  46 loss training:  7.6753491542403935 Time :  552
accuracy train: 0.997290 val: 0.948171 test: 0.943580
max validation accuracy : 0.952744 max acc epoch : 31.000000 test accuracy : 0.943969

Epoch :  47 loss training:  7.450659546928364 Time :  563
accuracy train: 0.997290 val: 0.946646 test: 0.942802
max validation accuracy : 0.952744 max acc epoch : 31.000000 test accuracy : 0.943969

Epoch :  48 loss training:  7.638380509510171 Time :  575
accuracy train: 0.997290 val: 0.948171 test: 0.943969
max validation accuracy : 0.952744 max acc epoch : 31.000000 test accuracy : 0.943969

Epoch :  49 loss training:  8.010382985667093 Time :  587
accuracy train: 0.997629 val: 0.948171 test: 0.942802
max validation accuracy : 0.952744 max acc epoch : 31.000000 test accuracy : 0.943969

Epoch :  50 loss training:  8.080653955199523 Time :  598
accuracy train: 0.997459 val: 0.946646 test: 0.942023
max validation accuracy : 0.952744 max acc epoch : 31.000000 test accuracy : 0.943969

Epoch :  51 loss training:  7.52568104081729 Time :  609
accuracy train: 0.997459 val: 0.943598 test: 0.945914
max validation accuracy : 0.952744 max acc epoch : 31.000000 test accuracy : 0.943969

Epoch :  52 loss training:  6.788455848156445 Time :  620
accuracy train: 0.997798 val: 0.949695 test: 0.944358
max validation accuracy : 0.952744 max acc epoch : 31.000000 test accuracy : 0.943969

========================================================================================================================================================================================================
max acc epoch :  31
max validation accuracy :  0.9527439024390244
test accuracy :  0.9439688715953307
latest_test_accuracy :  0.9443579766536965
========================================================================================================================================================================================================

