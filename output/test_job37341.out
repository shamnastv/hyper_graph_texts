

date and time :  Sun Jun 13 23:36:51 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=35, tsne=False, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  209.29541909694672 Time :  40
accuracy train: 0.643614 val: 0.594030 test: 0.625031
max validation accuracy : 0.594030 max acc epoch : 1 test accuracy : 0.625031
Epoch-1 lr: 0.001

Epoch :  2 loss training:  140.50697946548462 Time :  53
accuracy train: 0.711449 val: 0.635821 test: 0.657433
max validation accuracy : 0.635821 max acc epoch : 2 test accuracy : 0.657433
Epoch-2 lr: 0.001

Epoch :  3 loss training:  122.69368696212769 Time :  69
accuracy train: 0.756784 val: 0.650746 test: 0.685382
max validation accuracy : 0.650746 max acc epoch : 3 test accuracy : 0.685382
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  95.13776236772537 Time :  82
accuracy train: 0.809729 val: 0.683582 test: 0.705417
max validation accuracy : 0.683582 max acc epoch : 4 test accuracy : 0.705417
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.00455510616302 Time :  97
accuracy train: 0.821641 val: 0.683582 test: 0.693050
max validation accuracy : 0.683582 max acc epoch : 4 test accuracy : 0.705417
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.17802411317825 Time :  111
accuracy train: 0.853077 val: 0.707463 test: 0.714568
max validation accuracy : 0.707463 max acc epoch : 6 test accuracy : 0.714568
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  70.22260370850563 Time :  124
accuracy train: 0.869623 val: 0.710448 test: 0.715063
max validation accuracy : 0.710448 max acc epoch : 7 test accuracy : 0.715063
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.19391858577728 Time :  139
accuracy train: 0.883852 val: 0.704478 test: 0.715063
max validation accuracy : 0.710448 max acc epoch : 7 test accuracy : 0.715063
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.818580240011215 Time :  155
accuracy train: 0.890801 val: 0.719403 test: 0.705417
max validation accuracy : 0.719403 max acc epoch : 9 test accuracy : 0.705417
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  57.447014570236206 Time :  170
accuracy train: 0.902383 val: 0.728358 test: 0.716300
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  55.169926047325134 Time :  187
accuracy train: 0.914626 val: 0.716418 test: 0.716794
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  53.60400813817978 Time :  200
accuracy train: 0.920913 val: 0.713433 test: 0.715805
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  49.3838107585907 Time :  217
accuracy train: 0.925215 val: 0.713433 test: 0.719021
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  46.77131363004446 Time :  230
accuracy train: 0.927531 val: 0.713433 test: 0.720257
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  46.84416837990284 Time :  246
accuracy train: 0.930179 val: 0.713433 test: 0.721989
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300

Epoch :  16 loss training:  43.68238143622875 Time :  259
accuracy train: 0.941099 val: 0.719403 test: 0.720257
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300

Epoch :  17 loss training:  42.85370482504368 Time :  276
accuracy train: 0.946062 val: 0.722388 test: 0.720999
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300

Epoch :  18 loss training:  41.07303377985954 Time :  289
accuracy train: 0.944408 val: 0.716418 test: 0.722978
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300

Epoch :  19 loss training:  39.59078665077686 Time :  306
accuracy train: 0.950033 val: 0.722388 test: 0.721247
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300

Epoch :  20 loss training:  39.9080990627408 Time :  322
accuracy train: 0.954666 val: 0.713433 test: 0.721989
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300

Epoch :  21 loss training:  36.35460399836302 Time :  336
accuracy train: 0.959298 val: 0.722388 test: 0.721989
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300

Epoch :  22 loss training:  37.23755390197039 Time :  353
accuracy train: 0.963931 val: 0.722388 test: 0.719268
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300

Epoch :  23 loss training:  33.67000977694988 Time :  366
accuracy train: 0.964924 val: 0.707463 test: 0.721247
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300

Epoch :  24 loss training:  33.14935316890478 Time :  382
accuracy train: 0.966248 val: 0.716418 test: 0.725451
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300

Epoch :  25 loss training:  33.46900173276663 Time :  394
accuracy train: 0.972535 val: 0.722388 test: 0.724462
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300

Epoch :  26 loss training:  31.581288538873196 Time :  412
accuracy train: 0.974189 val: 0.725373 test: 0.720999
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300

Epoch :  27 loss training:  28.656083665788174 Time :  424
accuracy train: 0.976506 val: 0.722388 test: 0.718773
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300

Epoch :  28 loss training:  28.54438393563032 Time :  439
accuracy train: 0.977167 val: 0.722388 test: 0.720010
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300

Epoch :  29 loss training:  28.818127050995827 Time :  453
accuracy train: 0.980146 val: 0.713433 test: 0.716547
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300

Epoch :  30 loss training:  27.437777649611235 Time :  471
accuracy train: 0.981469 val: 0.716418 test: 0.719763
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300

Epoch :  31 loss training:  25.099586714059114 Time :  485
accuracy train: 0.982793 val: 0.716418 test: 0.717042
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300

Epoch :  32 loss training:  25.387104284018278 Time :  501
accuracy train: 0.983786 val: 0.719403 test: 0.722978
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300

Epoch :  33 loss training:  24.592030744999647 Time :  518
accuracy train: 0.985440 val: 0.716418 test: 0.717784
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300

Epoch :  34 loss training:  21.961441658437252 Time :  531
accuracy train: 0.988087 val: 0.719403 test: 0.720505
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300

Epoch :  35 loss training:  22.159182481467724 Time :  549
accuracy train: 0.986102 val: 0.719403 test: 0.721989
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300

Epoch :  36 loss training:  21.352219745516777 Time :  561
accuracy train: 0.989411 val: 0.722388 test: 0.722236
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.716300

Epoch :  37 loss training:  20.328889839351177 Time :  578
accuracy train: 0.992389 val: 0.731343 test: 0.720257
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  38 loss training:  20.624849636107683 Time :  592
accuracy train: 0.992058 val: 0.722388 test: 0.719515
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  39 loss training:  19.02850789576769 Time :  607
accuracy train: 0.993382 val: 0.713433 test: 0.722236
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  40 loss training:  18.734453044831753 Time :  621
accuracy train: 0.994375 val: 0.728358 test: 0.721247
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  41 loss training:  18.222589567303658 Time :  637
accuracy train: 0.996360 val: 0.716418 test: 0.722483
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  42 loss training:  18.091523308306932 Time :  652
accuracy train: 0.995367 val: 0.713433 test: 0.724462
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  43 loss training:  16.080777261406183 Time :  667
accuracy train: 0.996029 val: 0.713433 test: 0.720999
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  44 loss training:  14.159993456676602 Time :  684
accuracy train: 0.996360 val: 0.719403 test: 0.724957
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  45 loss training:  15.490895235911012 Time :  697
accuracy train: 0.996691 val: 0.716418 test: 0.722731
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  46 loss training:  15.662775298580527 Time :  714
accuracy train: 0.998015 val: 0.719403 test: 0.722978
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  47 loss training:  14.810447746887803 Time :  727
accuracy train: 0.997684 val: 0.725373 test: 0.718773
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  48 loss training:  13.678762700408697 Time :  743
accuracy train: 0.998345 val: 0.725373 test: 0.722483
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  49 loss training:  13.860458374023438 Time :  756
accuracy train: 0.999338 val: 0.725373 test: 0.717536
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  50 loss training:  13.242410091683269 Time :  773
accuracy train: 0.998676 val: 0.719403 test: 0.719021
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  51 loss training:  12.288969269022346 Time :  788
accuracy train: 0.998676 val: 0.722388 test: 0.720752
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  52 loss training:  11.111559124663472 Time :  803
accuracy train: 0.999007 val: 0.716418 test: 0.721989
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  53 loss training:  11.19582094065845 Time :  819
accuracy train: 0.999669 val: 0.713433 test: 0.720010
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  54 loss training:  10.655796686187387 Time :  832
accuracy train: 0.998676 val: 0.710448 test: 0.721494
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  55 loss training:  9.843591736629605 Time :  850
accuracy train: 0.998676 val: 0.716418 test: 0.721247
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  56 loss training:  10.596582595258951 Time :  862
accuracy train: 0.998676 val: 0.704478 test: 0.715063
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  57 loss training:  10.124292174354196 Time :  879
accuracy train: 0.999669 val: 0.707463 test: 0.719515
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  58 loss training:  8.40195394679904 Time :  892
accuracy train: 0.999669 val: 0.722388 test: 0.722236
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  59 loss training:  9.203027159906924 Time :  908
accuracy train: 0.999338 val: 0.713433 test: 0.721989
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  60 loss training:  9.434416633099318 Time :  924
accuracy train: 0.999669 val: 0.716418 test: 0.723720
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  61 loss training:  8.265075934585184 Time :  939
accuracy train: 1.000000 val: 0.725373 test: 0.720257
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  62 loss training:  8.720093118026853 Time :  956
accuracy train: 0.999669 val: 0.731343 test: 0.719268
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  63 loss training:  8.372435927391052 Time :  969
accuracy train: 0.999669 val: 0.719403 test: 0.722236
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  64 loss training:  8.18173889350146 Time :  983
accuracy train: 0.999669 val: 0.731343 test: 0.720505
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  65 loss training:  7.647021482698619 Time :  996
accuracy train: 1.000000 val: 0.716418 test: 0.718031
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  66 loss training:  7.387740236707032 Time :  1013
accuracy train: 1.000000 val: 0.716418 test: 0.725204
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  67 loss training:  6.621951394714415 Time :  1029
accuracy train: 0.999669 val: 0.731343 test: 0.720505
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

Epoch :  68 loss training:  7.7857280084863305 Time :  1043
accuracy train: 1.000000 val: 0.728358 test: 0.719515
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.720257

========================================================================================================================================================================================================
best acc epoch :  37
validation accuracy :  0.7313432835820896
test accuracy :  0.7202572347266881
last test_accuracy :  0.7195152114766262
second best val :  0.7283582089552239
second best test :  0.716299777393025
max gap 27
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=35, tsne=False, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  209.52067041397095 Time :  1082
accuracy train: 0.644606 val: 0.597015 test: 0.624042
max validation accuracy : 0.597015 max acc epoch : 1 test accuracy : 0.624042
Epoch-1 lr: 0.001

Epoch :  2 loss training:  140.65119814872742 Time :  1098
accuracy train: 0.709795 val: 0.647761 test: 0.657680
max validation accuracy : 0.647761 max acc epoch : 2 test accuracy : 0.657680
Epoch-2 lr: 0.001

Epoch :  3 loss training:  122.58324709534645 Time :  1111
accuracy train: 0.754467 val: 0.635821 test: 0.683651
max validation accuracy : 0.647761 max acc epoch : 2 test accuracy : 0.657680
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  95.491155564785 Time :  1127
accuracy train: 0.813700 val: 0.683582 test: 0.701212
max validation accuracy : 0.683582 max acc epoch : 4 test accuracy : 0.701212
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.0650447010994 Time :  1141
accuracy train: 0.823296 val: 0.674627 test: 0.697007
max validation accuracy : 0.683582 max acc epoch : 4 test accuracy : 0.701212
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  83.85845267772675 Time :  1157
accuracy train: 0.854070 val: 0.710448 test: 0.713579
max validation accuracy : 0.710448 max acc epoch : 6 test accuracy : 0.713579
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  70.23171965777874 Time :  1172
accuracy train: 0.871277 val: 0.710448 test: 0.716794
max validation accuracy : 0.710448 max acc epoch : 6 test accuracy : 0.713579
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.38439109921455 Time :  1187
accuracy train: 0.882528 val: 0.704478 test: 0.717042
max validation accuracy : 0.710448 max acc epoch : 6 test accuracy : 0.713579
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.300342455506325 Time :  1202
accuracy train: 0.887492 val: 0.701493 test: 0.705664
max validation accuracy : 0.710448 max acc epoch : 6 test accuracy : 0.713579
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  58.03483693301678 Time :  1217
accuracy train: 0.903375 val: 0.710448 test: 0.715805
max validation accuracy : 0.710448 max acc epoch : 6 test accuracy : 0.713579
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  55.45347686111927 Time :  1234
accuracy train: 0.913633 val: 0.716418 test: 0.718279
max validation accuracy : 0.716418 max acc epoch : 11 test accuracy : 0.718279
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  53.61621256172657 Time :  1249
accuracy train: 0.920582 val: 0.719403 test: 0.717289
max validation accuracy : 0.719403 max acc epoch : 12 test accuracy : 0.717289
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  49.727981969714165 Time :  1265
accuracy train: 0.922899 val: 0.710448 test: 0.721989
max validation accuracy : 0.719403 max acc epoch : 12 test accuracy : 0.717289
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  46.78491058945656 Time :  1279
accuracy train: 0.925877 val: 0.707463 test: 0.719268
max validation accuracy : 0.719403 max acc epoch : 12 test accuracy : 0.717289
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  46.825817197561264 Time :  1296
accuracy train: 0.930510 val: 0.713433 test: 0.720010
max validation accuracy : 0.719403 max acc epoch : 12 test accuracy : 0.717289

Epoch :  16 loss training:  43.9864746183157 Time :  1311
accuracy train: 0.939113 val: 0.710448 test: 0.723720
max validation accuracy : 0.719403 max acc epoch : 12 test accuracy : 0.717289

Epoch :  17 loss training:  42.883833691477776 Time :  1326
accuracy train: 0.945069 val: 0.704478 test: 0.724709
max validation accuracy : 0.719403 max acc epoch : 12 test accuracy : 0.717289

Epoch :  18 loss training:  41.09177570044994 Time :  1341
accuracy train: 0.946393 val: 0.716418 test: 0.723473
max validation accuracy : 0.719403 max acc epoch : 12 test accuracy : 0.717289

Epoch :  19 loss training:  39.65857957303524 Time :  1356
accuracy train: 0.949702 val: 0.710448 test: 0.721741
max validation accuracy : 0.719403 max acc epoch : 12 test accuracy : 0.717289

Epoch :  20 loss training:  40.097046956419945 Time :  1372
accuracy train: 0.953011 val: 0.707463 test: 0.720752
max validation accuracy : 0.719403 max acc epoch : 12 test accuracy : 0.717289

Epoch :  21 loss training:  36.58440484106541 Time :  1385
accuracy train: 0.956651 val: 0.710448 test: 0.720505
max validation accuracy : 0.719403 max acc epoch : 12 test accuracy : 0.717289

Epoch :  22 loss training:  37.22553391754627 Time :  1402
accuracy train: 0.964924 val: 0.716418 test: 0.721741
max validation accuracy : 0.719403 max acc epoch : 12 test accuracy : 0.717289

Epoch :  23 loss training:  33.919823214411736 Time :  1415
accuracy train: 0.962938 val: 0.719403 test: 0.722483
max validation accuracy : 0.719403 max acc epoch : 12 test accuracy : 0.717289

Epoch :  24 loss training:  32.7666876539588 Time :  1431
accuracy train: 0.964924 val: 0.710448 test: 0.723967
max validation accuracy : 0.719403 max acc epoch : 12 test accuracy : 0.717289

Epoch :  25 loss training:  33.6368771828711 Time :  1444
accuracy train: 0.970218 val: 0.722388 test: 0.722731
max validation accuracy : 0.722388 max acc epoch : 25 test accuracy : 0.722731

Epoch :  26 loss training:  31.563773438334465 Time :  1462
accuracy train: 0.973858 val: 0.719403 test: 0.719515
max validation accuracy : 0.722388 max acc epoch : 25 test accuracy : 0.722731

Epoch :  27 loss training:  28.755255959928036 Time :  1475
accuracy train: 0.975513 val: 0.719403 test: 0.719763
max validation accuracy : 0.722388 max acc epoch : 25 test accuracy : 0.722731

Epoch :  28 loss training:  29.187749557197094 Time :  1493
accuracy train: 0.978160 val: 0.716418 test: 0.720257
max validation accuracy : 0.722388 max acc epoch : 25 test accuracy : 0.722731

Epoch :  29 loss training:  28.76118255779147 Time :  1508
accuracy train: 0.980477 val: 0.707463 test: 0.721494
max validation accuracy : 0.722388 max acc epoch : 25 test accuracy : 0.722731

Epoch :  30 loss training:  27.05382690578699 Time :  1523
accuracy train: 0.981138 val: 0.716418 test: 0.721989
max validation accuracy : 0.722388 max acc epoch : 25 test accuracy : 0.722731

Epoch :  31 loss training:  25.521280575543642 Time :  1541
accuracy train: 0.983124 val: 0.710448 test: 0.722236
max validation accuracy : 0.722388 max acc epoch : 25 test accuracy : 0.722731

Epoch :  32 loss training:  25.414869979023933 Time :  1554
accuracy train: 0.984447 val: 0.710448 test: 0.723473
max validation accuracy : 0.722388 max acc epoch : 25 test accuracy : 0.722731

Epoch :  33 loss training:  24.589561883360147 Time :  1570
accuracy train: 0.985109 val: 0.719403 test: 0.720010
max validation accuracy : 0.722388 max acc epoch : 25 test accuracy : 0.722731

Epoch :  34 loss training:  22.12453057616949 Time :  1583
accuracy train: 0.987095 val: 0.716418 test: 0.721494
max validation accuracy : 0.722388 max acc epoch : 25 test accuracy : 0.722731

Epoch :  35 loss training:  21.850454211235046 Time :  1599
accuracy train: 0.986764 val: 0.722388 test: 0.721741
max validation accuracy : 0.722388 max acc epoch : 25 test accuracy : 0.722731

Epoch :  36 loss training:  21.625297121703625 Time :  1612
accuracy train: 0.989411 val: 0.722388 test: 0.723720
max validation accuracy : 0.722388 max acc epoch : 25 test accuracy : 0.722731

Epoch :  37 loss training:  20.42660490423441 Time :  1629
accuracy train: 0.989411 val: 0.734328 test: 0.720752
max validation accuracy : 0.734328 max acc epoch : 37 test accuracy : 0.720752

Epoch :  38 loss training:  20.556410655379295 Time :  1644
accuracy train: 0.991727 val: 0.728358 test: 0.719763
max validation accuracy : 0.734328 max acc epoch : 37 test accuracy : 0.720752

Epoch :  39 loss training:  19.17155957967043 Time :  1660
accuracy train: 0.992720 val: 0.722388 test: 0.721989
max validation accuracy : 0.734328 max acc epoch : 37 test accuracy : 0.720752

Epoch :  40 loss training:  19.003300059586763 Time :  1676
accuracy train: 0.994044 val: 0.722388 test: 0.723720
max validation accuracy : 0.734328 max acc epoch : 37 test accuracy : 0.720752

Epoch :  41 loss training:  18.37632989883423 Time :  1690
accuracy train: 0.994375 val: 0.713433 test: 0.723473
max validation accuracy : 0.734328 max acc epoch : 37 test accuracy : 0.720752

Epoch :  42 loss training:  18.536490762606263 Time :  1707
accuracy train: 0.996029 val: 0.719403 test: 0.724957
max validation accuracy : 0.734328 max acc epoch : 37 test accuracy : 0.720752

Epoch :  43 loss training:  16.219741731882095 Time :  1720
accuracy train: 0.996360 val: 0.722388 test: 0.722483
max validation accuracy : 0.734328 max acc epoch : 37 test accuracy : 0.720752

Epoch :  44 loss training:  14.274465318769217 Time :  1737
accuracy train: 0.996360 val: 0.731343 test: 0.721741
max validation accuracy : 0.734328 max acc epoch : 37 test accuracy : 0.720752

Epoch :  45 loss training:  15.451208220794797 Time :  1751
accuracy train: 0.997022 val: 0.716418 test: 0.720010
max validation accuracy : 0.734328 max acc epoch : 37 test accuracy : 0.720752

Epoch :  46 loss training:  15.86142940632999 Time :  1766
accuracy train: 0.997353 val: 0.719403 test: 0.719763
max validation accuracy : 0.734328 max acc epoch : 37 test accuracy : 0.720752

Epoch :  47 loss training:  15.166585616767406 Time :  1781
accuracy train: 0.998015 val: 0.734328 test: 0.723967
max validation accuracy : 0.734328 max acc epoch : 37 test accuracy : 0.720752

Epoch :  48 loss training:  13.721204794943333 Time :  1795
accuracy train: 0.999338 val: 0.725373 test: 0.723967
max validation accuracy : 0.734328 max acc epoch : 37 test accuracy : 0.720752

Epoch :  49 loss training:  13.803310887888074 Time :  1812
accuracy train: 0.999338 val: 0.725373 test: 0.721247
max validation accuracy : 0.734328 max acc epoch : 37 test accuracy : 0.720752

Epoch :  50 loss training:  13.482907636091113 Time :  1826
accuracy train: 0.999338 val: 0.728358 test: 0.718279
max validation accuracy : 0.734328 max acc epoch : 37 test accuracy : 0.720752

Epoch :  51 loss training:  12.392650609835982 Time :  1843
accuracy train: 0.998676 val: 0.719403 test: 0.723720
max validation accuracy : 0.734328 max acc epoch : 37 test accuracy : 0.720752

Epoch :  52 loss training:  11.262376179918647 Time :  1856
accuracy train: 0.999007 val: 0.713433 test: 0.718031
max validation accuracy : 0.734328 max acc epoch : 37 test accuracy : 0.720752

Epoch :  53 loss training:  11.148494663648307 Time :  1874
accuracy train: 0.999338 val: 0.734328 test: 0.722978
max validation accuracy : 0.734328 max acc epoch : 37 test accuracy : 0.720752

Epoch :  54 loss training:  10.831426318734884 Time :  1890
accuracy train: 0.998676 val: 0.734328 test: 0.721494
max validation accuracy : 0.734328 max acc epoch : 37 test accuracy : 0.720752

Epoch :  55 loss training:  9.815356638282537 Time :  1905
accuracy train: 0.998676 val: 0.719403 test: 0.723225
max validation accuracy : 0.734328 max acc epoch : 37 test accuracy : 0.720752

Epoch :  56 loss training:  10.555855177342892 Time :  1922
accuracy train: 0.999007 val: 0.722388 test: 0.716547
max validation accuracy : 0.734328 max acc epoch : 37 test accuracy : 0.720752

Epoch :  57 loss training:  9.8704050835222 Time :  1935
accuracy train: 0.999669 val: 0.737313 test: 0.718773
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  58 loss training:  8.953856069594622 Time :  1951
accuracy train: 0.999669 val: 0.716418 test: 0.719021
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  59 loss training:  9.089324853383005 Time :  1964
accuracy train: 0.999669 val: 0.710448 test: 0.719021
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  60 loss training:  9.572257010266185 Time :  1982
accuracy train: 0.999669 val: 0.722388 test: 0.721989
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  61 loss training:  8.321742076426744 Time :  1997
accuracy train: 1.000000 val: 0.722388 test: 0.717536
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  62 loss training:  8.9950756970793 Time :  2012
accuracy train: 0.999669 val: 0.731343 test: 0.719763
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  63 loss training:  8.409797705709934 Time :  2028
accuracy train: 1.000000 val: 0.725373 test: 0.721741
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  64 loss training:  8.501377211883664 Time :  2041
accuracy train: 0.999669 val: 0.722388 test: 0.721494
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  65 loss training:  7.742337377741933 Time :  2057
accuracy train: 1.000000 val: 0.716418 test: 0.718279
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  66 loss training:  7.761451826430857 Time :  2071
accuracy train: 1.000000 val: 0.719403 test: 0.724215
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  67 loss training:  6.727921376004815 Time :  2088
accuracy train: 1.000000 val: 0.737313 test: 0.722731
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  68 loss training:  7.821779353544116 Time :  2103
accuracy train: 1.000000 val: 0.719403 test: 0.720505
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  69 loss training:  7.3344393176957965 Time :  2118
accuracy train: 0.999669 val: 0.734328 test: 0.722978
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  70 loss training:  5.957636533305049 Time :  2134
accuracy train: 1.000000 val: 0.722388 test: 0.720752
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  71 loss training:  5.973336120136082 Time :  2148
accuracy train: 1.000000 val: 0.716418 test: 0.719268
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  72 loss training:  6.238261021673679 Time :  2164
accuracy train: 0.999669 val: 0.710448 test: 0.720999
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  73 loss training:  5.909149423241615 Time :  2178
accuracy train: 1.000000 val: 0.725373 test: 0.723473
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  74 loss training:  6.015645812265575 Time :  2195
accuracy train: 1.000000 val: 0.722388 test: 0.720010
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  75 loss training:  5.0217190640978515 Time :  2211
accuracy train: 1.000000 val: 0.722388 test: 0.721741
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  76 loss training:  5.643834065180272 Time :  2225
accuracy train: 1.000000 val: 0.728358 test: 0.723967
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  77 loss training:  5.0899797743186355 Time :  2242
accuracy train: 1.000000 val: 0.728358 test: 0.723225
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  78 loss training:  4.866717695724219 Time :  2255
accuracy train: 1.000000 val: 0.722388 test: 0.722483
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  79 loss training:  4.768186416011304 Time :  2272
accuracy train: 1.000000 val: 0.728358 test: 0.720010
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  80 loss training:  4.5366499540396035 Time :  2285
accuracy train: 1.000000 val: 0.737313 test: 0.720505
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  81 loss training:  4.310711071826518 Time :  2302
accuracy train: 1.000000 val: 0.728358 test: 0.721989
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  82 loss training:  4.2595231810119 Time :  2316
accuracy train: 1.000000 val: 0.719403 test: 0.721741
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  83 loss training:  4.161264894763008 Time :  2333
accuracy train: 1.000000 val: 0.719403 test: 0.723473
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  84 loss training:  3.7869445610558614 Time :  2350
accuracy train: 1.000000 val: 0.707463 test: 0.722731
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  85 loss training:  4.245868738275021 Time :  2363
accuracy train: 1.000000 val: 0.707463 test: 0.719763
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  86 loss training:  3.766151330899447 Time :  2381
accuracy train: 1.000000 val: 0.713433 test: 0.716547
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  87 loss training:  3.6967237053904682 Time :  2394
accuracy train: 1.000000 val: 0.728358 test: 0.718526
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

Epoch :  88 loss training:  3.682454308960587 Time :  2410
accuracy train: 1.000000 val: 0.725373 test: 0.720752
max validation accuracy : 0.737313 max acc epoch : 57 test accuracy : 0.718773

========================================================================================================================================================================================================
best acc epoch :  57
validation accuracy :  0.7373134328358208
test accuracy :  0.7187731882265644
last test_accuracy :  0.720751916893396
second best val :  0.7343283582089553
second best test :  0.720751916893396
max gap 20
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=35, tsne=False, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  209.43000447750092 Time :  2447
accuracy train: 0.646923 val: 0.591045 test: 0.623052
max validation accuracy : 0.591045 max acc epoch : 1 test accuracy : 0.623052
Epoch-1 lr: 0.001

Epoch :  2 loss training:  140.6276683807373 Time :  2462
accuracy train: 0.707478 val: 0.641791 test: 0.658917
max validation accuracy : 0.641791 max acc epoch : 2 test accuracy : 0.658917
Epoch-2 lr: 0.001

Epoch :  3 loss training:  122.24518224596977 Time :  2475
accuracy train: 0.753475 val: 0.644776 test: 0.683651
max validation accuracy : 0.644776 max acc epoch : 3 test accuracy : 0.683651
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  95.66154110431671 Time :  2492
accuracy train: 0.813700 val: 0.689552 test: 0.700223
max validation accuracy : 0.689552 max acc epoch : 4 test accuracy : 0.700223
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.25959604978561 Time :  2504
accuracy train: 0.821310 val: 0.674627 test: 0.696018
max validation accuracy : 0.689552 max acc epoch : 4 test accuracy : 0.700223
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.06693667173386 Time :  2521
accuracy train: 0.849768 val: 0.704478 test: 0.710858
max validation accuracy : 0.704478 max acc epoch : 6 test accuracy : 0.710858
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  70.46647764742374 Time :  2533
accuracy train: 0.870615 val: 0.707463 test: 0.714074
max validation accuracy : 0.707463 max acc epoch : 7 test accuracy : 0.714074
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.43318688869476 Time :  2550
accuracy train: 0.884514 val: 0.701493 test: 0.715063
max validation accuracy : 0.707463 max acc epoch : 7 test accuracy : 0.714074
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.90205955505371 Time :  2565
accuracy train: 0.887161 val: 0.716418 test: 0.706159
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.706159
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  57.77306570112705 Time :  2581
accuracy train: 0.900728 val: 0.716418 test: 0.714568
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.706159
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  55.08756536245346 Time :  2599
accuracy train: 0.911317 val: 0.710448 test: 0.716547
max validation accuracy : 0.716418 max acc epoch : 9 test accuracy : 0.706159
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  53.641759142279625 Time :  2611
accuracy train: 0.919921 val: 0.719403 test: 0.719268
max validation accuracy : 0.719403 max acc epoch : 12 test accuracy : 0.719268
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  49.47909742593765 Time :  2629
accuracy train: 0.922568 val: 0.701493 test: 0.719763
max validation accuracy : 0.719403 max acc epoch : 12 test accuracy : 0.719268
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  46.78072417527437 Time :  2643
accuracy train: 0.926539 val: 0.704478 test: 0.720257
max validation accuracy : 0.719403 max acc epoch : 12 test accuracy : 0.719268
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  46.92483901977539 Time :  2661
accuracy train: 0.930179 val: 0.704478 test: 0.720010
max validation accuracy : 0.719403 max acc epoch : 12 test accuracy : 0.719268

Epoch :  16 loss training:  43.839507564902306 Time :  2679
accuracy train: 0.941099 val: 0.719403 test: 0.719763
max validation accuracy : 0.719403 max acc epoch : 12 test accuracy : 0.719268

Epoch :  17 loss training:  42.761403903365135 Time :  2692
accuracy train: 0.944739 val: 0.716418 test: 0.721989
max validation accuracy : 0.719403 max acc epoch : 12 test accuracy : 0.719268

Epoch :  18 loss training:  41.014978379011154 Time :  2710
accuracy train: 0.945731 val: 0.719403 test: 0.723225
max validation accuracy : 0.719403 max acc epoch : 12 test accuracy : 0.719268

Epoch :  19 loss training:  39.36284817755222 Time :  2727
accuracy train: 0.951357 val: 0.716418 test: 0.720010
max validation accuracy : 0.719403 max acc epoch : 12 test accuracy : 0.719268

Epoch :  20 loss training:  39.73089750111103 Time :  2741
accuracy train: 0.952019 val: 0.716418 test: 0.722978
max validation accuracy : 0.719403 max acc epoch : 12 test accuracy : 0.719268

Epoch :  21 loss training:  36.657457157969475 Time :  2759
accuracy train: 0.958968 val: 0.710448 test: 0.722978
max validation accuracy : 0.719403 max acc epoch : 12 test accuracy : 0.719268

Epoch :  22 loss training:  37.168871596455574 Time :  2771
accuracy train: 0.965917 val: 0.710448 test: 0.721741
max validation accuracy : 0.719403 max acc epoch : 12 test accuracy : 0.719268

Epoch :  23 loss training:  34.00072028487921 Time :  2788
accuracy train: 0.965255 val: 0.728358 test: 0.721741
max validation accuracy : 0.728358 max acc epoch : 23 test accuracy : 0.721741

Epoch :  24 loss training:  32.739214316010475 Time :  2801
accuracy train: 0.966248 val: 0.710448 test: 0.725204
max validation accuracy : 0.728358 max acc epoch : 23 test accuracy : 0.721741

Epoch :  25 loss training:  33.361324302852154 Time :  2817
accuracy train: 0.971211 val: 0.725373 test: 0.721989
max validation accuracy : 0.728358 max acc epoch : 23 test accuracy : 0.721741

Epoch :  26 loss training:  31.32837126031518 Time :  2834
accuracy train: 0.972204 val: 0.716418 test: 0.718773
max validation accuracy : 0.728358 max acc epoch : 23 test accuracy : 0.721741

Epoch :  27 loss training:  28.499566920101643 Time :  2848
accuracy train: 0.976506 val: 0.728358 test: 0.718031
max validation accuracy : 0.728358 max acc epoch : 23 test accuracy : 0.721741

Epoch :  28 loss training:  28.858310282230377 Time :  2865
accuracy train: 0.977167 val: 0.731343 test: 0.719021
max validation accuracy : 0.731343 max acc epoch : 28 test accuracy : 0.719021

Epoch :  29 loss training:  28.643379490822554 Time :  2877
accuracy train: 0.980807 val: 0.719403 test: 0.718526
max validation accuracy : 0.731343 max acc epoch : 28 test accuracy : 0.719021

Epoch :  30 loss training:  27.61927715688944 Time :  2895
accuracy train: 0.981800 val: 0.722388 test: 0.720010
max validation accuracy : 0.731343 max acc epoch : 28 test accuracy : 0.719021

Epoch :  31 loss training:  25.090261973440647 Time :  2908
accuracy train: 0.981800 val: 0.731343 test: 0.719515
max validation accuracy : 0.731343 max acc epoch : 28 test accuracy : 0.719021

Epoch :  32 loss training:  25.085470382124186 Time :  2926
accuracy train: 0.984778 val: 0.716418 test: 0.721494
max validation accuracy : 0.731343 max acc epoch : 28 test accuracy : 0.719021

Epoch :  33 loss training:  24.727084543555975 Time :  2940
accuracy train: 0.985440 val: 0.728358 test: 0.719515
max validation accuracy : 0.731343 max acc epoch : 28 test accuracy : 0.719021

Epoch :  34 loss training:  22.482377666980028 Time :  2957
accuracy train: 0.987756 val: 0.713433 test: 0.722236
max validation accuracy : 0.731343 max acc epoch : 28 test accuracy : 0.719021

Epoch :  35 loss training:  21.99060283228755 Time :  2975
accuracy train: 0.985440 val: 0.731343 test: 0.717289
max validation accuracy : 0.731343 max acc epoch : 28 test accuracy : 0.719021

Epoch :  36 loss training:  21.43858988210559 Time :  2987
accuracy train: 0.990073 val: 0.728358 test: 0.720752
max validation accuracy : 0.731343 max acc epoch : 28 test accuracy : 0.719021

Epoch :  37 loss training:  20.690752115100622 Time :  3003
accuracy train: 0.992389 val: 0.740299 test: 0.720010
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  38 loss training:  20.717342246323824 Time :  3017
accuracy train: 0.991727 val: 0.740299 test: 0.720010
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  39 loss training:  19.393886797130108 Time :  3035
accuracy train: 0.993382 val: 0.722388 test: 0.723473
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  40 loss training:  19.05779116600752 Time :  3049
accuracy train: 0.994375 val: 0.728358 test: 0.722236
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  41 loss training:  18.378143209964037 Time :  3064
accuracy train: 0.995367 val: 0.713433 test: 0.721247
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  42 loss training:  18.144402351230383 Time :  3079
accuracy train: 0.995698 val: 0.722388 test: 0.724462
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  43 loss training:  16.117219656705856 Time :  3095
accuracy train: 0.996691 val: 0.716418 test: 0.719021
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  44 loss training:  14.344411073252559 Time :  3109
accuracy train: 0.996360 val: 0.728358 test: 0.719763
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  45 loss training:  15.563445247709751 Time :  3124
accuracy train: 0.997022 val: 0.725373 test: 0.716794
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  46 loss training:  15.769307114183903 Time :  3141
accuracy train: 0.996691 val: 0.719403 test: 0.720010
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  47 loss training:  14.56593594327569 Time :  3154
accuracy train: 0.997353 val: 0.737313 test: 0.720257
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  48 loss training:  13.799159325659275 Time :  3171
accuracy train: 0.998676 val: 0.734328 test: 0.719763
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  49 loss training:  13.769635016098619 Time :  3184
accuracy train: 0.999338 val: 0.725373 test: 0.718773
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  50 loss training:  13.676594585180283 Time :  3201
accuracy train: 0.998676 val: 0.731343 test: 0.719268
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  51 loss training:  12.497572895139456 Time :  3217
accuracy train: 0.998676 val: 0.728358 test: 0.721741
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  52 loss training:  11.356334453448653 Time :  3230
accuracy train: 0.999338 val: 0.719403 test: 0.721494
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  53 loss training:  11.188301117159426 Time :  3246
accuracy train: 0.998676 val: 0.722388 test: 0.720257
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  54 loss training:  10.43694830685854 Time :  3260
accuracy train: 0.998676 val: 0.731343 test: 0.719515
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  55 loss training:  9.909737790934741 Time :  3277
accuracy train: 0.998676 val: 0.734328 test: 0.720752
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  56 loss training:  10.666905671358109 Time :  3290
accuracy train: 0.999007 val: 0.719403 test: 0.713579
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  57 loss training:  10.003421327099204 Time :  3308
accuracy train: 0.999669 val: 0.728358 test: 0.716547
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  58 loss training:  8.987855528481305 Time :  3325
accuracy train: 0.999007 val: 0.707463 test: 0.718526
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  59 loss training:  8.773725503124297 Time :  3337
accuracy train: 0.999338 val: 0.731343 test: 0.717784
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  60 loss training:  9.678948430344462 Time :  3354
accuracy train: 0.999338 val: 0.725373 test: 0.720257
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  61 loss training:  8.358142571523786 Time :  3367
accuracy train: 0.999669 val: 0.722388 test: 0.715310
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  62 loss training:  9.037129990756512 Time :  3383
accuracy train: 0.999338 val: 0.713433 test: 0.714568
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  63 loss training:  8.483725629746914 Time :  3397
accuracy train: 0.999007 val: 0.719403 test: 0.719515
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  64 loss training:  8.404256360605359 Time :  3415
accuracy train: 0.999338 val: 0.731343 test: 0.717289
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  65 loss training:  7.586021453142166 Time :  3431
accuracy train: 1.000000 val: 0.725373 test: 0.716300
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  66 loss training:  7.833729900419712 Time :  3446
accuracy train: 0.999669 val: 0.725373 test: 0.723720
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  67 loss training:  6.842775262426585 Time :  3465
accuracy train: 0.999669 val: 0.734328 test: 0.719268
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

Epoch :  68 loss training:  7.703428572509438 Time :  3478
accuracy train: 0.999669 val: 0.728358 test: 0.720505
max validation accuracy : 0.740299 max acc epoch : 37 test accuracy : 0.720010

========================================================================================================================================================================================================
best acc epoch :  37
validation accuracy :  0.7402985074626866
test accuracy :  0.7200098936433341
last test_accuracy :  0.720504575810042
second best val :  0.7373134328358208
second best test :  0.7200098936433341
max gap 11
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=35, tsne=False, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  209.56617957353592 Time :  3517
accuracy train: 0.648577 val: 0.588060 test: 0.619589
max validation accuracy : 0.588060 max acc epoch : 1 test accuracy : 0.619589
Epoch-1 lr: 0.001

Epoch :  2 loss training:  141.0976756811142 Time :  3529
accuracy train: 0.712442 val: 0.644776 test: 0.658175
max validation accuracy : 0.644776 max acc epoch : 2 test accuracy : 0.658175
Epoch-2 lr: 0.001

Epoch :  3 loss training:  122.2476224899292 Time :  3545
accuracy train: 0.756453 val: 0.650746 test: 0.686372
max validation accuracy : 0.650746 max acc epoch : 3 test accuracy : 0.686372
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  95.55342444777489 Time :  3558
accuracy train: 0.810060 val: 0.686567 test: 0.705169
max validation accuracy : 0.686567 max acc epoch : 4 test accuracy : 0.705169
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.16635796427727 Time :  3574
accuracy train: 0.818663 val: 0.671642 test: 0.692802
max validation accuracy : 0.686567 max acc epoch : 4 test accuracy : 0.705169
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  83.98851653933525 Time :  3587
accuracy train: 0.849768 val: 0.713433 test: 0.714321
max validation accuracy : 0.713433 max acc epoch : 6 test accuracy : 0.714321
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  70.60265539586544 Time :  3601
accuracy train: 0.868630 val: 0.707463 test: 0.714816
max validation accuracy : 0.713433 max acc epoch : 6 test accuracy : 0.714321
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.56194199621677 Time :  3616
accuracy train: 0.884183 val: 0.719403 test: 0.717042
max validation accuracy : 0.719403 max acc epoch : 8 test accuracy : 0.717042
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.049561724066734 Time :  3629
accuracy train: 0.884514 val: 0.722388 test: 0.709622
max validation accuracy : 0.722388 max acc epoch : 9 test accuracy : 0.709622
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  57.92785903811455 Time :  3646
accuracy train: 0.897419 val: 0.716418 test: 0.717536
max validation accuracy : 0.722388 max acc epoch : 9 test accuracy : 0.709622
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  55.613267585635185 Time :  3662
accuracy train: 0.910655 val: 0.725373 test: 0.717784
max validation accuracy : 0.725373 max acc epoch : 11 test accuracy : 0.717784
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  54.03743955492973 Time :  3676
accuracy train: 0.919921 val: 0.737313 test: 0.720010
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.720010
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  49.98661867529154 Time :  3693
accuracy train: 0.922237 val: 0.719403 test: 0.723225
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.720010
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  47.20922013372183 Time :  3707
accuracy train: 0.927862 val: 0.719403 test: 0.720010
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.720010
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  46.705715499818325 Time :  3724
accuracy train: 0.927531 val: 0.716418 test: 0.721741
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.720010

Epoch :  16 loss training:  44.36347818374634 Time :  3738
accuracy train: 0.940437 val: 0.731343 test: 0.724709
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.720010

Epoch :  17 loss training:  43.32472540438175 Time :  3755
accuracy train: 0.940437 val: 0.725373 test: 0.723473
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.720010

Epoch :  18 loss training:  40.88069058954716 Time :  3768
accuracy train: 0.946393 val: 0.725373 test: 0.723225
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.720010

Epoch :  19 loss training:  39.699871346354485 Time :  3785
accuracy train: 0.947717 val: 0.722388 test: 0.723720
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.720010

Epoch :  20 loss training:  39.87609573453665 Time :  3800
accuracy train: 0.953342 val: 0.710448 test: 0.720999
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.720010

Epoch :  21 loss training:  36.702871426939964 Time :  3815
accuracy train: 0.955989 val: 0.713433 test: 0.722483
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.720010

Epoch :  22 loss training:  37.511760376393795 Time :  3831
accuracy train: 0.964593 val: 0.722388 test: 0.721989
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.720010

Epoch :  23 loss training:  33.89363944530487 Time :  3846
accuracy train: 0.962938 val: 0.725373 test: 0.720752
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.720010

Epoch :  24 loss training:  32.810355342924595 Time :  3863
accuracy train: 0.964593 val: 0.713433 test: 0.723225
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.720010

Epoch :  25 loss training:  33.81772522628307 Time :  3875
accuracy train: 0.971542 val: 0.719403 test: 0.726441
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.720010

Epoch :  26 loss training:  31.858800664544106 Time :  3891
accuracy train: 0.973527 val: 0.725373 test: 0.721989
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.720010

Epoch :  27 loss training:  28.926382541656494 Time :  3903
accuracy train: 0.975513 val: 0.725373 test: 0.723720
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.720010

Epoch :  28 loss training:  28.908669158816338 Time :  3920
accuracy train: 0.977498 val: 0.728358 test: 0.721741
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.720010

Epoch :  29 loss training:  28.994247253984213 Time :  3933
accuracy train: 0.979815 val: 0.719403 test: 0.720010
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.720010

Epoch :  30 loss training:  27.51636454463005 Time :  3950
accuracy train: 0.981469 val: 0.716418 test: 0.720505
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.720010

Epoch :  31 loss training:  25.453926019370556 Time :  3962
accuracy train: 0.980477 val: 0.725373 test: 0.719763
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.720010

Epoch :  32 loss training:  25.396333683282137 Time :  3978
accuracy train: 0.982462 val: 0.713433 test: 0.724215
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.720010

Epoch :  33 loss training:  25.176876660436392 Time :  3995
accuracy train: 0.984778 val: 0.716418 test: 0.721494
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.720010

Epoch :  34 loss training:  22.442344449460506 Time :  4008
accuracy train: 0.985771 val: 0.716418 test: 0.722731
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.720010

Epoch :  35 loss training:  21.967786613851786 Time :  4024
accuracy train: 0.984116 val: 0.716418 test: 0.720010
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.720010

Epoch :  36 loss training:  21.74761762842536 Time :  4037
accuracy train: 0.988749 val: 0.728358 test: 0.722236
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.720010

Epoch :  37 loss training:  20.710077214986086 Time :  4053
accuracy train: 0.990404 val: 0.734328 test: 0.721741
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.720010

Epoch :  38 loss training:  20.83903592079878 Time :  4066
accuracy train: 0.990404 val: 0.743284 test: 0.719268
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  39 loss training:  18.957257874310017 Time :  4083
accuracy train: 0.993713 val: 0.722388 test: 0.721494
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  40 loss training:  18.812375213950872 Time :  4100
accuracy train: 0.993382 val: 0.725373 test: 0.724709
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  41 loss training:  18.71755551546812 Time :  4114
accuracy train: 0.995367 val: 0.716418 test: 0.720999
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  42 loss training:  18.38380996324122 Time :  4131
accuracy train: 0.995698 val: 0.725373 test: 0.721741
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  43 loss training:  16.106567554175854 Time :  4144
accuracy train: 0.995698 val: 0.728358 test: 0.721989
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  44 loss training:  14.413613272830844 Time :  4162
accuracy train: 0.996029 val: 0.731343 test: 0.724957
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  45 loss training:  15.646897843107581 Time :  4175
accuracy train: 0.997022 val: 0.728358 test: 0.721741
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  46 loss training:  16.171429000794888 Time :  4191
accuracy train: 0.996691 val: 0.731343 test: 0.723473
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  47 loss training:  15.04876385256648 Time :  4205
accuracy train: 0.998015 val: 0.734328 test: 0.718526
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  48 loss training:  14.06113376840949 Time :  4222
accuracy train: 0.998676 val: 0.731343 test: 0.722483
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  49 loss training:  13.750094529241323 Time :  4239
accuracy train: 0.999007 val: 0.722388 test: 0.720010
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  50 loss training:  13.541520221158862 Time :  4252
accuracy train: 0.998676 val: 0.734328 test: 0.715310
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  51 loss training:  12.788083374500275 Time :  4269
accuracy train: 0.998676 val: 0.722388 test: 0.722978
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  52 loss training:  11.174750188365579 Time :  4282
accuracy train: 0.999338 val: 0.716418 test: 0.719515
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  53 loss training:  11.400879031047225 Time :  4300
accuracy train: 0.998676 val: 0.734328 test: 0.720505
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  54 loss training:  10.825866892933846 Time :  4313
accuracy train: 0.998676 val: 0.722388 test: 0.717536
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  55 loss training:  9.786540046334267 Time :  4330
accuracy train: 0.998676 val: 0.731343 test: 0.719268
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  56 loss training:  10.614641670137644 Time :  4344
accuracy train: 0.998676 val: 0.710448 test: 0.716052
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  57 loss training:  9.947320565581322 Time :  4358
accuracy train: 0.999669 val: 0.722388 test: 0.714816
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  58 loss training:  8.803638289682567 Time :  4375
accuracy train: 0.999007 val: 0.722388 test: 0.717784
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  59 loss training:  9.032425043173134 Time :  4389
accuracy train: 0.999338 val: 0.725373 test: 0.717042
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  60 loss training:  9.494171116501093 Time :  4406
accuracy train: 0.999669 val: 0.728358 test: 0.719268
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  61 loss training:  8.485992055386305 Time :  4419
accuracy train: 1.000000 val: 0.737313 test: 0.719515
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  62 loss training:  9.115163589827716 Time :  4436
accuracy train: 0.999669 val: 0.725373 test: 0.719268
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  63 loss training:  8.71834619436413 Time :  4449
accuracy train: 1.000000 val: 0.728358 test: 0.720999
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  64 loss training:  8.757272464223206 Time :  4465
accuracy train: 1.000000 val: 0.731343 test: 0.721494
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  65 loss training:  7.62916596326977 Time :  4482
accuracy train: 1.000000 val: 0.734328 test: 0.717536
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  66 loss training:  7.626701059751213 Time :  4496
accuracy train: 0.999338 val: 0.728358 test: 0.722731
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  67 loss training:  6.732083165086806 Time :  4513
accuracy train: 1.000000 val: 0.728358 test: 0.720010
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  68 loss training:  8.210507874377072 Time :  4526
accuracy train: 1.000000 val: 0.731343 test: 0.720752
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

Epoch :  69 loss training:  7.2474300460889935 Time :  4542
accuracy train: 0.999669 val: 0.734328 test: 0.720257
max validation accuracy : 0.743284 max acc epoch : 38 test accuracy : 0.719268

========================================================================================================================================================================================================
best acc epoch :  38
validation accuracy :  0.7432835820895523
test accuracy :  0.7192678703932723
last test_accuracy :  0.7202572347266881
second best val :  0.7373134328358208
second best test :  0.7200098936433341
max gap 26
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  37 	 val_accuracy : 0.73134 	 test_accuracy : 0.72026 	 last test_accuracy : 0.71952 	 second best val : 0.72836 	 second best test : 0.71630
k :  1 	 best_acc epoch :  57 	 val_accuracy : 0.73731 	 test_accuracy : 0.71877 	 last test_accuracy : 0.72075 	 second best val : 0.73433 	 second best test : 0.72075
k :  2 	 best_acc epoch :  37 	 val_accuracy : 0.74030 	 test_accuracy : 0.72001 	 last test_accuracy : 0.72050 	 second best val : 0.73731 	 second best test : 0.72001
k :  3 	 best_acc epoch :  38 	 val_accuracy : 0.74328 	 test_accuracy : 0.71927 	 last test_accuracy : 0.72026 	 second best val : 0.73731 	 second best test : 0.72001

avg :  	 val_accuracy : 0.73806 	 test_accuracy : 0.71958 	 last_accuracy : 0.72026 	 second best val : 0.73433 	 second best test : 0.71927

std :  	 val_accuracy : 0.00441 	 test_accuracy : 0.00059 	 last_accuracy : 0.00046 	 second best val : 0.00366 	 second best test : 0.00174


date and time :  Mon Jun 14 00:52:40 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=882, tsne=False, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  211.17357152700424 Time :  37
accuracy train: 0.654533 val: 0.570149 test: 0.616374
max validation accuracy : 0.570149 max acc epoch : 1 test accuracy : 0.616374
Epoch-1 lr: 0.001

Epoch :  2 loss training:  147.06881469488144 Time :  57
accuracy train: 0.719391 val: 0.614925 test: 0.665348
max validation accuracy : 0.614925 max acc epoch : 2 test accuracy : 0.665348
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.71392440795898 Time :  76
accuracy train: 0.728657 val: 0.600000 test: 0.654712
max validation accuracy : 0.614925 max acc epoch : 2 test accuracy : 0.665348
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.82081478834152 Time :  93
accuracy train: 0.798147 val: 0.677612 test: 0.698739
max validation accuracy : 0.677612 max acc epoch : 4 test accuracy : 0.698739
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  89.00484663248062 Time :  114
accuracy train: 0.812376 val: 0.653731 test: 0.694286
max validation accuracy : 0.677612 max acc epoch : 4 test accuracy : 0.698739
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  81.78608283400536 Time :  134
accuracy train: 0.835539 val: 0.671642 test: 0.694781
max validation accuracy : 0.677612 max acc epoch : 4 test accuracy : 0.698739
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  71.11301109194756 Time :  153
accuracy train: 0.862012 val: 0.680597 test: 0.709127
max validation accuracy : 0.680597 max acc epoch : 7 test accuracy : 0.709127
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.07618822157383 Time :  170
accuracy train: 0.863997 val: 0.677612 test: 0.709127
max validation accuracy : 0.680597 max acc epoch : 7 test accuracy : 0.709127
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.63821548223495 Time :  191
accuracy train: 0.880212 val: 0.656716 test: 0.706406
max validation accuracy : 0.680597 max acc epoch : 7 test accuracy : 0.709127
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.08103747665882 Time :  212
accuracy train: 0.886830 val: 0.680597 test: 0.716300
max validation accuracy : 0.680597 max acc epoch : 7 test accuracy : 0.709127
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.56853261590004 Time :  232
accuracy train: 0.891463 val: 0.683582 test: 0.716052
max validation accuracy : 0.683582 max acc epoch : 11 test accuracy : 0.716052
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  55.43808928132057 Time :  252
accuracy train: 0.910324 val: 0.683582 test: 0.720505
max validation accuracy : 0.683582 max acc epoch : 11 test accuracy : 0.716052
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  52.57634252309799 Time :  273
accuracy train: 0.915288 val: 0.677612 test: 0.719515
max validation accuracy : 0.683582 max acc epoch : 11 test accuracy : 0.716052
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  49.23738174140453 Time :  293
accuracy train: 0.923561 val: 0.692537 test: 0.718031
max validation accuracy : 0.692537 max acc epoch : 14 test accuracy : 0.718031
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  48.04955177009106 Time :  311
accuracy train: 0.925215 val: 0.686567 test: 0.714074
max validation accuracy : 0.692537 max acc epoch : 14 test accuracy : 0.718031

Epoch :  16 loss training:  46.25037270784378 Time :  333
accuracy train: 0.926539 val: 0.686567 test: 0.713826
max validation accuracy : 0.692537 max acc epoch : 14 test accuracy : 0.718031

Epoch :  17 loss training:  44.915510430932045 Time :  353
accuracy train: 0.931502 val: 0.695522 test: 0.715805
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  18 loss training:  43.313139386475086 Time :  372
accuracy train: 0.936797 val: 0.683582 test: 0.719021
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  19 loss training:  42.80634995549917 Time :  392
accuracy train: 0.940106 val: 0.677612 test: 0.719763
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  20 loss training:  41.37023388594389 Time :  414
accuracy train: 0.949040 val: 0.680597 test: 0.716547
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  21 loss training:  40.770598001778126 Time :  436
accuracy train: 0.947386 val: 0.692537 test: 0.719021
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  22 loss training:  38.86921067535877 Time :  455
accuracy train: 0.953011 val: 0.695522 test: 0.721741
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  23 loss training:  36.722038112580776 Time :  472
accuracy train: 0.955989 val: 0.689552 test: 0.719763
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  24 loss training:  35.21218229085207 Time :  493
accuracy train: 0.963269 val: 0.683582 test: 0.719763
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  25 loss training:  35.289373993873596 Time :  513
accuracy train: 0.964262 val: 0.695522 test: 0.719763
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  26 loss training:  33.62807060778141 Time :  529
accuracy train: 0.965917 val: 0.686567 test: 0.720505
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  27 loss training:  32.46095081418753 Time :  550
accuracy train: 0.968564 val: 0.680597 test: 0.716300
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  28 loss training:  31.95594135671854 Time :  570
accuracy train: 0.968895 val: 0.677612 test: 0.719021
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  29 loss training:  30.85661782324314 Time :  590
accuracy train: 0.970880 val: 0.680597 test: 0.718279
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  30 loss training:  28.761835388839245 Time :  608
accuracy train: 0.977829 val: 0.677612 test: 0.723225
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  31 loss training:  29.230572409927845 Time :  630
accuracy train: 0.979153 val: 0.680597 test: 0.720010
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  32 loss training:  26.476087097078562 Time :  651
accuracy train: 0.981469 val: 0.671642 test: 0.719021
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  33 loss training:  27.88281738385558 Time :  671
accuracy train: 0.980477 val: 0.671642 test: 0.719515
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  34 loss training:  26.357235588133335 Time :  690
accuracy train: 0.981469 val: 0.671642 test: 0.719021
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  35 loss training:  25.902627907693386 Time :  710
accuracy train: 0.985440 val: 0.662687 test: 0.719763
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  36 loss training:  23.248969927430153 Time :  730
accuracy train: 0.987095 val: 0.671642 test: 0.717042
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  37 loss training:  22.867843940854073 Time :  747
accuracy train: 0.986102 val: 0.671642 test: 0.716052
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  38 loss training:  22.59028236195445 Time :  768
accuracy train: 0.988087 val: 0.680597 test: 0.716300
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  39 loss training:  21.202070400118828 Time :  789
accuracy train: 0.988418 val: 0.695522 test: 0.718279
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  40 loss training:  21.33337687328458 Time :  809
accuracy train: 0.990404 val: 0.674627 test: 0.714568
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  41 loss training:  19.71724820882082 Time :  829
accuracy train: 0.992389 val: 0.677612 test: 0.720505
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  42 loss training:  19.376181043684483 Time :  850
accuracy train: 0.991396 val: 0.689552 test: 0.724215
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  43 loss training:  17.78778080176562 Time :  870
accuracy train: 0.993051 val: 0.686567 test: 0.717042
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  44 loss training:  17.463766522705555 Time :  887
accuracy train: 0.993382 val: 0.695522 test: 0.716547
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  45 loss training:  17.220116153359413 Time :  908
accuracy train: 0.994044 val: 0.695522 test: 0.719763
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  46 loss training:  16.721035078167915 Time :  929
accuracy train: 0.994375 val: 0.686567 test: 0.719268
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  47 loss training:  16.4272813051939 Time :  948
accuracy train: 0.995036 val: 0.683582 test: 0.716300
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

Epoch :  48 loss training:  14.791331332176924 Time :  967
accuracy train: 0.994375 val: 0.683582 test: 0.717042
max validation accuracy : 0.695522 max acc epoch : 17 test accuracy : 0.715805

========================================================================================================================================================================================================
best acc epoch :  17
validation accuracy :  0.6955223880597015
test accuracy :  0.7158050952263171
last test_accuracy :  0.7170418006430869
second best val :  0.6925373134328359
second best test :  0.7180311649765025
max gap 4
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=882, tsne=False, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  211.0697517991066 Time :  1004
accuracy train: 0.654203 val: 0.564179 test: 0.611922
max validation accuracy : 0.564179 max acc epoch : 1 test accuracy : 0.611922
Epoch-1 lr: 0.001

Epoch :  2 loss training:  147.14437299966812 Time :  1022
accuracy train: 0.717406 val: 0.638806 test: 0.664358
max validation accuracy : 0.638806 max acc epoch : 2 test accuracy : 0.664358
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.3010458946228 Time :  1041
accuracy train: 0.733620 val: 0.597015 test: 0.655454
max validation accuracy : 0.638806 max acc epoch : 2 test accuracy : 0.664358
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.05123579502106 Time :  1059
accuracy train: 0.799140 val: 0.671642 test: 0.695276
max validation accuracy : 0.671642 max acc epoch : 4 test accuracy : 0.695276
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.68785619735718 Time :  1075
accuracy train: 0.815354 val: 0.650746 test: 0.695276
max validation accuracy : 0.671642 max acc epoch : 4 test accuracy : 0.695276
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  82.15898951888084 Time :  1094
accuracy train: 0.836532 val: 0.662687 test: 0.693792
max validation accuracy : 0.671642 max acc epoch : 4 test accuracy : 0.695276
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  71.0316536128521 Time :  1113
accuracy train: 0.859365 val: 0.677612 test: 0.711106
max validation accuracy : 0.677612 max acc epoch : 7 test accuracy : 0.711106
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  67.42765595018864 Time :  1129
accuracy train: 0.866976 val: 0.671642 test: 0.713332
max validation accuracy : 0.677612 max acc epoch : 7 test accuracy : 0.711106
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.52446554601192 Time :  1148
accuracy train: 0.877895 val: 0.659701 test: 0.708880
max validation accuracy : 0.677612 max acc epoch : 7 test accuracy : 0.711106
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.19964261353016 Time :  1166
accuracy train: 0.888815 val: 0.668657 test: 0.715558
max validation accuracy : 0.677612 max acc epoch : 7 test accuracy : 0.711106
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.45408225059509 Time :  1182
accuracy train: 0.891794 val: 0.683582 test: 0.712095
max validation accuracy : 0.683582 max acc epoch : 11 test accuracy : 0.712095
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  55.34942923486233 Time :  1204
accuracy train: 0.911979 val: 0.695522 test: 0.716547
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  52.07879060506821 Time :  1221
accuracy train: 0.918928 val: 0.695522 test: 0.719515
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  49.15698018670082 Time :  1238
accuracy train: 0.924222 val: 0.686567 test: 0.718279
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  47.92760343849659 Time :  1257
accuracy train: 0.925877 val: 0.686567 test: 0.716300
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  16 loss training:  46.218258529901505 Time :  1277
accuracy train: 0.929517 val: 0.692537 test: 0.715063
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  17 loss training:  45.134172797203064 Time :  1296
accuracy train: 0.932164 val: 0.695522 test: 0.719268
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  18 loss training:  42.99298591911793 Time :  1314
accuracy train: 0.940437 val: 0.689552 test: 0.719763
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  19 loss training:  42.966883562505245 Time :  1334
accuracy train: 0.938451 val: 0.674627 test: 0.719268
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  20 loss training:  40.83542146533728 Time :  1353
accuracy train: 0.947055 val: 0.677612 test: 0.717042
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  21 loss training:  40.398780941963196 Time :  1370
accuracy train: 0.952019 val: 0.677612 test: 0.719515
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  22 loss training:  38.88050606101751 Time :  1389
accuracy train: 0.954335 val: 0.689552 test: 0.717536
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  23 loss training:  36.491957515478134 Time :  1409
accuracy train: 0.958968 val: 0.686567 test: 0.720257
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  24 loss training:  35.2326867505908 Time :  1426
accuracy train: 0.962608 val: 0.671642 test: 0.716300
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  25 loss training:  34.85484390705824 Time :  1446
accuracy train: 0.963931 val: 0.686567 test: 0.717784
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  26 loss training:  33.446759916841984 Time :  1465
accuracy train: 0.967571 val: 0.683582 test: 0.717289
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  27 loss training:  32.21774221211672 Time :  1483
accuracy train: 0.968564 val: 0.683582 test: 0.717784
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  28 loss training:  31.88165231794119 Time :  1501
accuracy train: 0.971211 val: 0.680597 test: 0.718773
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  29 loss training:  30.610385805368423 Time :  1521
accuracy train: 0.970880 val: 0.692537 test: 0.717784
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  30 loss training:  28.91183277964592 Time :  1539
accuracy train: 0.977829 val: 0.680597 test: 0.720010
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  31 loss training:  29.14743295684457 Time :  1556
accuracy train: 0.978491 val: 0.686567 test: 0.720257
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  32 loss training:  26.240715753287077 Time :  1576
accuracy train: 0.981800 val: 0.677612 test: 0.721741
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  33 loss training:  27.52985144406557 Time :  1594
accuracy train: 0.984116 val: 0.680597 test: 0.717784
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  34 loss training:  25.986219696700573 Time :  1612
accuracy train: 0.982462 val: 0.671642 test: 0.722483
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  35 loss training:  25.18442017585039 Time :  1632
accuracy train: 0.986102 val: 0.680597 test: 0.716794
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  36 loss training:  23.020683746784925 Time :  1651
accuracy train: 0.985771 val: 0.680597 test: 0.715558
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  37 loss training:  22.63313052430749 Time :  1670
accuracy train: 0.987095 val: 0.680597 test: 0.715805
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  38 loss training:  22.564675830304623 Time :  1688
accuracy train: 0.988087 val: 0.680597 test: 0.719515
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  39 loss training:  21.03563704714179 Time :  1707
accuracy train: 0.988749 val: 0.689552 test: 0.718526
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  40 loss training:  21.108199577778578 Time :  1726
accuracy train: 0.989742 val: 0.677612 test: 0.717289
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  41 loss training:  19.840585384517908 Time :  1743
accuracy train: 0.990735 val: 0.677612 test: 0.719021
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  42 loss training:  19.162097562104464 Time :  1763
accuracy train: 0.991066 val: 0.686567 test: 0.722236
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

Epoch :  43 loss training:  17.533988122828305 Time :  1781
accuracy train: 0.992720 val: 0.683582 test: 0.718773
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.716547

========================================================================================================================================================================================================
best acc epoch :  12
validation accuracy :  0.6955223880597015
test accuracy :  0.716547118476379
last test_accuracy :  0.7187731882265644
second best val :  0.6925373134328359
second best test :  0.716547118476379
max gap 4
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=882, tsne=False, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  211.1436044573784 Time :  1820
accuracy train: 0.651224 val: 0.564179 test: 0.610932
max validation accuracy : 0.564179 max acc epoch : 1 test accuracy : 0.610932
Epoch-1 lr: 0.001

Epoch :  2 loss training:  147.38182246685028 Time :  1840
accuracy train: 0.721707 val: 0.632836 test: 0.666337
max validation accuracy : 0.632836 max acc epoch : 2 test accuracy : 0.666337
Epoch-2 lr: 0.001

Epoch :  3 loss training:  120.71409711241722 Time :  1857
accuracy train: 0.734944 val: 0.597015 test: 0.652980
max validation accuracy : 0.632836 max acc epoch : 2 test accuracy : 0.666337
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.27553656697273 Time :  1876
accuracy train: 0.797154 val: 0.674627 test: 0.694534
max validation accuracy : 0.674627 max acc epoch : 4 test accuracy : 0.694534
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.87912467122078 Time :  1895
accuracy train: 0.815023 val: 0.653731 test: 0.696760
max validation accuracy : 0.674627 max acc epoch : 4 test accuracy : 0.694534
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  82.17245161533356 Time :  1912
accuracy train: 0.833554 val: 0.659701 test: 0.692802
max validation accuracy : 0.674627 max acc epoch : 4 test accuracy : 0.694534
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  71.30396415293217 Time :  1932
accuracy train: 0.861350 val: 0.674627 test: 0.710364
max validation accuracy : 0.674627 max acc epoch : 4 test accuracy : 0.694534
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  67.64733693003654 Time :  1950
accuracy train: 0.863336 val: 0.659701 test: 0.709374
max validation accuracy : 0.674627 max acc epoch : 4 test accuracy : 0.694534
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.15725322067738 Time :  1968
accuracy train: 0.879881 val: 0.665672 test: 0.709374
max validation accuracy : 0.674627 max acc epoch : 4 test accuracy : 0.694534
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.13317643105984 Time :  1986
accuracy train: 0.886499 val: 0.659701 test: 0.714321
max validation accuracy : 0.674627 max acc epoch : 4 test accuracy : 0.694534
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.785672068595886 Time :  2005
accuracy train: 0.890470 val: 0.668657 test: 0.717289
max validation accuracy : 0.674627 max acc epoch : 4 test accuracy : 0.694534
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  55.54166977107525 Time :  2024
accuracy train: 0.910655 val: 0.674627 test: 0.718773
max validation accuracy : 0.674627 max acc epoch : 4 test accuracy : 0.694534
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  52.231906831264496 Time :  2041
accuracy train: 0.917935 val: 0.668657 test: 0.717536
max validation accuracy : 0.674627 max acc epoch : 4 test accuracy : 0.694534
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  49.275983706116676 Time :  2061
accuracy train: 0.923561 val: 0.680597 test: 0.719515
max validation accuracy : 0.680597 max acc epoch : 14 test accuracy : 0.719515
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  48.15118718147278 Time :  2081
accuracy train: 0.926208 val: 0.683582 test: 0.718279
max validation accuracy : 0.683582 max acc epoch : 15 test accuracy : 0.718279

Epoch :  16 loss training:  46.24821496754885 Time :  2098
accuracy train: 0.927531 val: 0.674627 test: 0.716794
max validation accuracy : 0.683582 max acc epoch : 15 test accuracy : 0.718279

Epoch :  17 loss training:  44.739165902137756 Time :  2118
accuracy train: 0.936466 val: 0.686567 test: 0.722483
max validation accuracy : 0.686567 max acc epoch : 17 test accuracy : 0.722483

Epoch :  18 loss training:  43.060325123369694 Time :  2138
accuracy train: 0.934480 val: 0.677612 test: 0.723720
max validation accuracy : 0.686567 max acc epoch : 17 test accuracy : 0.722483

Epoch :  19 loss training:  42.320149302482605 Time :  2157
accuracy train: 0.939444 val: 0.683582 test: 0.720257
max validation accuracy : 0.686567 max acc epoch : 17 test accuracy : 0.722483

Epoch :  20 loss training:  41.374772019684315 Time :  2176
accuracy train: 0.949702 val: 0.674627 test: 0.720752
max validation accuracy : 0.686567 max acc epoch : 17 test accuracy : 0.722483

Epoch :  21 loss training:  40.90921428799629 Time :  2196
accuracy train: 0.952019 val: 0.668657 test: 0.720752
max validation accuracy : 0.686567 max acc epoch : 17 test accuracy : 0.722483

Epoch :  22 loss training:  38.895034305751324 Time :  2215
accuracy train: 0.953673 val: 0.674627 test: 0.720257
max validation accuracy : 0.686567 max acc epoch : 17 test accuracy : 0.722483

Epoch :  23 loss training:  36.68036010861397 Time :  2233
accuracy train: 0.956982 val: 0.677612 test: 0.721741
max validation accuracy : 0.686567 max acc epoch : 17 test accuracy : 0.722483

Epoch :  24 loss training:  35.26001838594675 Time :  2253
accuracy train: 0.961946 val: 0.665672 test: 0.718279
max validation accuracy : 0.686567 max acc epoch : 17 test accuracy : 0.722483

Epoch :  25 loss training:  34.99410815536976 Time :  2271
accuracy train: 0.966909 val: 0.671642 test: 0.720010
max validation accuracy : 0.686567 max acc epoch : 17 test accuracy : 0.722483

Epoch :  26 loss training:  33.859477166086435 Time :  2289
accuracy train: 0.966909 val: 0.668657 test: 0.719268
max validation accuracy : 0.686567 max acc epoch : 17 test accuracy : 0.722483

Epoch :  27 loss training:  32.54049884527922 Time :  2309
accuracy train: 0.966578 val: 0.668657 test: 0.718773
max validation accuracy : 0.686567 max acc epoch : 17 test accuracy : 0.722483

Epoch :  28 loss training:  31.845761686563492 Time :  2328
accuracy train: 0.969226 val: 0.671642 test: 0.721494
max validation accuracy : 0.686567 max acc epoch : 17 test accuracy : 0.722483

Epoch :  29 loss training:  30.535678394138813 Time :  2346
accuracy train: 0.969557 val: 0.671642 test: 0.717784
max validation accuracy : 0.686567 max acc epoch : 17 test accuracy : 0.722483

Epoch :  30 loss training:  28.75964353978634 Time :  2365
accuracy train: 0.975182 val: 0.665672 test: 0.724215
max validation accuracy : 0.686567 max acc epoch : 17 test accuracy : 0.722483

Epoch :  31 loss training:  28.880215298384428 Time :  2385
accuracy train: 0.978491 val: 0.668657 test: 0.722236
max validation accuracy : 0.686567 max acc epoch : 17 test accuracy : 0.722483

Epoch :  32 loss training:  26.675006985664368 Time :  2405
accuracy train: 0.978822 val: 0.674627 test: 0.721494
max validation accuracy : 0.686567 max acc epoch : 17 test accuracy : 0.722483

Epoch :  33 loss training:  27.975783102214336 Time :  2424
accuracy train: 0.982462 val: 0.662687 test: 0.720999
max validation accuracy : 0.686567 max acc epoch : 17 test accuracy : 0.722483

Epoch :  34 loss training:  26.09096183627844 Time :  2443
accuracy train: 0.981800 val: 0.662687 test: 0.719268
max validation accuracy : 0.686567 max acc epoch : 17 test accuracy : 0.722483

Epoch :  35 loss training:  25.858366273343563 Time :  2463
accuracy train: 0.985771 val: 0.674627 test: 0.719763
max validation accuracy : 0.686567 max acc epoch : 17 test accuracy : 0.722483

Epoch :  36 loss training:  23.159371450543404 Time :  2481
accuracy train: 0.985440 val: 0.671642 test: 0.719763
max validation accuracy : 0.686567 max acc epoch : 17 test accuracy : 0.722483

Epoch :  37 loss training:  22.85054538398981 Time :  2498
accuracy train: 0.987095 val: 0.665672 test: 0.716052
max validation accuracy : 0.686567 max acc epoch : 17 test accuracy : 0.722483

Epoch :  38 loss training:  22.415292840451002 Time :  2518
accuracy train: 0.988749 val: 0.671642 test: 0.720505
max validation accuracy : 0.686567 max acc epoch : 17 test accuracy : 0.722483

Epoch :  39 loss training:  21.321027640253305 Time :  2537
accuracy train: 0.988418 val: 0.683582 test: 0.720257
max validation accuracy : 0.686567 max acc epoch : 17 test accuracy : 0.722483

Epoch :  40 loss training:  21.156279131770134 Time :  2555
accuracy train: 0.990404 val: 0.677612 test: 0.722483
max validation accuracy : 0.686567 max acc epoch : 17 test accuracy : 0.722483

Epoch :  41 loss training:  19.69573387131095 Time :  2573
accuracy train: 0.992058 val: 0.680597 test: 0.720010
max validation accuracy : 0.686567 max acc epoch : 17 test accuracy : 0.722483

Epoch :  42 loss training:  19.361844573169947 Time :  2592
accuracy train: 0.991066 val: 0.689552 test: 0.721741
max validation accuracy : 0.689552 max acc epoch : 42 test accuracy : 0.721741

Epoch :  43 loss training:  17.787187656387687 Time :  2609
accuracy train: 0.993382 val: 0.680597 test: 0.718031
max validation accuracy : 0.689552 max acc epoch : 42 test accuracy : 0.721741

Epoch :  44 loss training:  17.512859858572483 Time :  2627
accuracy train: 0.993713 val: 0.695522 test: 0.720010
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  45 loss training:  17.377553049474955 Time :  2647
accuracy train: 0.994705 val: 0.689552 test: 0.720999
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  46 loss training:  16.768840949982405 Time :  2673
accuracy train: 0.995036 val: 0.686567 test: 0.722236
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  47 loss training:  16.61578548885882 Time :  2690
accuracy train: 0.995698 val: 0.680597 test: 0.718031
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  48 loss training:  14.974454205483198 Time :  2712
accuracy train: 0.996029 val: 0.689552 test: 0.716794
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  49 loss training:  14.887793529778719 Time :  2732
accuracy train: 0.997353 val: 0.668657 test: 0.714321
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  50 loss training:  14.83416129462421 Time :  2755
accuracy train: 0.997022 val: 0.686567 test: 0.717536
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  51 loss training:  13.734256064519286 Time :  2778
accuracy train: 0.997353 val: 0.671642 test: 0.716794
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  52 loss training:  13.691234931349754 Time :  2797
accuracy train: 0.997684 val: 0.674627 test: 0.719021
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  53 loss training:  12.119633069261909 Time :  2821
accuracy train: 0.998015 val: 0.686567 test: 0.719021
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  54 loss training:  11.981022574007511 Time :  2844
accuracy train: 0.998015 val: 0.692537 test: 0.719763
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  55 loss training:  10.908499762415886 Time :  2863
accuracy train: 0.997684 val: 0.683582 test: 0.720257
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  56 loss training:  11.159959400072694 Time :  2884
accuracy train: 0.998676 val: 0.674627 test: 0.719268
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  57 loss training:  10.942610573023558 Time :  2908
accuracy train: 0.998345 val: 0.680597 test: 0.718279
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  58 loss training:  12.610612875781953 Time :  2932
accuracy train: 0.999669 val: 0.680597 test: 0.716300
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  59 loss training:  10.53646634425968 Time :  2950
accuracy train: 0.999007 val: 0.677612 test: 0.715805
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  60 loss training:  9.191710671409965 Time :  2975
accuracy train: 0.999338 val: 0.680597 test: 0.716794
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  61 loss training:  10.636701919138432 Time :  2999
accuracy train: 0.999007 val: 0.680597 test: 0.718031
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  62 loss training:  8.357267454266548 Time :  3019
accuracy train: 1.000000 val: 0.680597 test: 0.717042
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  63 loss training:  8.5972266420722 Time :  3040
accuracy train: 1.000000 val: 0.674627 test: 0.715558
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  64 loss training:  7.713710119947791 Time :  3064
accuracy train: 1.000000 val: 0.695522 test: 0.716794
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  65 loss training:  8.356358903460205 Time :  3087
accuracy train: 1.000000 val: 0.671642 test: 0.718031
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  66 loss training:  9.43961915653199 Time :  3104
accuracy train: 1.000000 val: 0.686567 test: 0.717042
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  67 loss training:  6.914073984138668 Time :  3128
accuracy train: 1.000000 val: 0.674627 test: 0.717536
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  68 loss training:  7.465272723697126 Time :  3152
accuracy train: 1.000000 val: 0.677612 test: 0.720257
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  69 loss training:  6.713920631445944 Time :  3168
accuracy train: 1.000000 val: 0.686567 test: 0.715310
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  70 loss training:  7.67801420763135 Time :  3194
accuracy train: 1.000000 val: 0.686567 test: 0.721741
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  71 loss training:  6.618343106471002 Time :  3219
accuracy train: 1.000000 val: 0.686567 test: 0.721494
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  72 loss training:  6.370287112891674 Time :  3239
accuracy train: 1.000000 val: 0.680597 test: 0.718031
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  73 loss training:  7.58573716878891 Time :  3259
accuracy train: 1.000000 val: 0.683582 test: 0.718773
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  74 loss training:  6.36216697935015 Time :  3281
accuracy train: 1.000000 val: 0.674627 test: 0.721989
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

Epoch :  75 loss training:  6.106392910704017 Time :  3304
accuracy train: 1.000000 val: 0.683582 test: 0.723225
max validation accuracy : 0.695522 max acc epoch : 44 test accuracy : 0.720010

========================================================================================================================================================================================================
best acc epoch :  44
validation accuracy :  0.6955223880597015
test accuracy :  0.7200098936433341
last test_accuracy :  0.7232253277269355
second best val :  0.6925373134328359
second best test :  0.7200098936433341
max gap 25
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=882, tsne=False, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  211.4148906469345 Time :  3327
accuracy train: 0.650893 val: 0.564179 test: 0.613653
max validation accuracy : 0.564179 max acc epoch : 1 test accuracy : 0.613653
Epoch-1 lr: 0.001

Epoch :  2 loss training:  147.0004648566246 Time :  3351
accuracy train: 0.727002 val: 0.620896 test: 0.664605
max validation accuracy : 0.620896 max acc epoch : 2 test accuracy : 0.664605
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.2107358276844 Time :  3374
accuracy train: 0.735936 val: 0.597015 test: 0.655949
max validation accuracy : 0.620896 max acc epoch : 2 test accuracy : 0.664605
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.14291298389435 Time :  3392
accuracy train: 0.800794 val: 0.674627 test: 0.694534
max validation accuracy : 0.674627 max acc epoch : 4 test accuracy : 0.694534
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.73411589860916 Time :  3415
accuracy train: 0.817670 val: 0.659701 test: 0.695770
max validation accuracy : 0.674627 max acc epoch : 4 test accuracy : 0.694534
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  82.04767459630966 Time :  3439
accuracy train: 0.835208 val: 0.677612 test: 0.695523
max validation accuracy : 0.677612 max acc epoch : 6 test accuracy : 0.695523
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  71.14263978600502 Time :  3456
accuracy train: 0.862674 val: 0.680597 test: 0.711106
max validation accuracy : 0.680597 max acc epoch : 7 test accuracy : 0.711106
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  67.50773876905441 Time :  3477
accuracy train: 0.861350 val: 0.668657 test: 0.707395
max validation accuracy : 0.680597 max acc epoch : 7 test accuracy : 0.711106
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.21666923165321 Time :  3499
accuracy train: 0.878226 val: 0.662687 test: 0.706159
max validation accuracy : 0.680597 max acc epoch : 7 test accuracy : 0.711106
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.027747467160225 Time :  3517
accuracy train: 0.886830 val: 0.659701 test: 0.716794
max validation accuracy : 0.680597 max acc epoch : 7 test accuracy : 0.711106
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.4229034781456 Time :  3540
accuracy train: 0.890470 val: 0.677612 test: 0.713826
max validation accuracy : 0.680597 max acc epoch : 7 test accuracy : 0.711106
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  55.24926836788654 Time :  3561
accuracy train: 0.912972 val: 0.686567 test: 0.720010
max validation accuracy : 0.686567 max acc epoch : 12 test accuracy : 0.720010
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  52.24720595777035 Time :  3578
accuracy train: 0.917604 val: 0.689552 test: 0.719515
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.719515
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  49.24672773480415 Time :  3604
accuracy train: 0.925215 val: 0.686567 test: 0.718526
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.719515
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  47.681180477142334 Time :  3625
accuracy train: 0.926208 val: 0.677612 test: 0.715310
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.719515

Epoch :  16 loss training:  46.301900431513786 Time :  3645
accuracy train: 0.929186 val: 0.668657 test: 0.716547
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.719515

Epoch :  17 loss training:  45.38104899227619 Time :  3666
accuracy train: 0.934811 val: 0.683582 test: 0.717289
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.719515

Epoch :  18 loss training:  43.27385701984167 Time :  3690
accuracy train: 0.936797 val: 0.683582 test: 0.721741
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.719515

Epoch :  19 loss training:  42.39788279682398 Time :  3713
accuracy train: 0.937790 val: 0.668657 test: 0.721247
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.719515

Epoch :  20 loss training:  40.74180242419243 Time :  3731
accuracy train: 0.947717 val: 0.677612 test: 0.718279
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.719515

Epoch :  21 loss training:  40.422038316726685 Time :  3754
accuracy train: 0.948709 val: 0.686567 test: 0.719268
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.719515

Epoch :  22 loss training:  38.50455889850855 Time :  3777
accuracy train: 0.951688 val: 0.692537 test: 0.722731
max validation accuracy : 0.692537 max acc epoch : 22 test accuracy : 0.722731

Epoch :  23 loss training:  36.64903365075588 Time :  3796
accuracy train: 0.954666 val: 0.701493 test: 0.725946
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  24 loss training:  35.017719477415085 Time :  3820
accuracy train: 0.962277 val: 0.680597 test: 0.720999
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  25 loss training:  34.81461717188358 Time :  3843
accuracy train: 0.965586 val: 0.680597 test: 0.723473
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  26 loss training:  33.20253986865282 Time :  3860
accuracy train: 0.966248 val: 0.677612 test: 0.726193
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  27 loss training:  32.2758846282959 Time :  3883
accuracy train: 0.969226 val: 0.677612 test: 0.722236
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  28 loss training:  31.99173752218485 Time :  3907
accuracy train: 0.970549 val: 0.677612 test: 0.720505
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  29 loss training:  30.696869142353535 Time :  3924
accuracy train: 0.972204 val: 0.677612 test: 0.721989
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  30 loss training:  28.799612499773502 Time :  3947
accuracy train: 0.976506 val: 0.686567 test: 0.725699
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  31 loss training:  29.191751033067703 Time :  3972
accuracy train: 0.976506 val: 0.680597 test: 0.725946
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  32 loss training:  26.554701760411263 Time :  3989
accuracy train: 0.979153 val: 0.671642 test: 0.723967
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  33 loss training:  27.709327168762684 Time :  4014
accuracy train: 0.981138 val: 0.677612 test: 0.720999
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  34 loss training:  25.93574796617031 Time :  4038
accuracy train: 0.982793 val: 0.671642 test: 0.720257
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  35 loss training:  25.49345012009144 Time :  4058
accuracy train: 0.985109 val: 0.665672 test: 0.719021
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  36 loss training:  22.76403947174549 Time :  4079
accuracy train: 0.986433 val: 0.677612 test: 0.721247
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  37 loss training:  22.98645642399788 Time :  4105
accuracy train: 0.987095 val: 0.671642 test: 0.717784
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  38 loss training:  21.968096498399973 Time :  4124
accuracy train: 0.988749 val: 0.683582 test: 0.722236
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  39 loss training:  20.955020915716887 Time :  4148
accuracy train: 0.988087 val: 0.686567 test: 0.717289
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  40 loss training:  20.849673971533775 Time :  4171
accuracy train: 0.990073 val: 0.680597 test: 0.722978
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  41 loss training:  19.94826503098011 Time :  4188
accuracy train: 0.991727 val: 0.680597 test: 0.719763
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  42 loss training:  18.792478881776333 Time :  4213
accuracy train: 0.990735 val: 0.680597 test: 0.721741
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  43 loss training:  17.570614969357848 Time :  4234
accuracy train: 0.993051 val: 0.686567 test: 0.720752
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  44 loss training:  17.519151862710714 Time :  4253
accuracy train: 0.994375 val: 0.695522 test: 0.723720
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  45 loss training:  17.123988647013903 Time :  4278
accuracy train: 0.993713 val: 0.686567 test: 0.721494
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  46 loss training:  16.208317313343287 Time :  4299
accuracy train: 0.995036 val: 0.689552 test: 0.719021
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  47 loss training:  16.34263194166124 Time :  4321
accuracy train: 0.995367 val: 0.680597 test: 0.720257
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  48 loss training:  14.652460286393762 Time :  4347
accuracy train: 0.996029 val: 0.677612 test: 0.718526
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  49 loss training:  14.69815531000495 Time :  4366
accuracy train: 0.997022 val: 0.689552 test: 0.718031
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  50 loss training:  14.615450529381633 Time :  4387
accuracy train: 0.997353 val: 0.683582 test: 0.719268
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  51 loss training:  13.470155229791999 Time :  4411
accuracy train: 0.997353 val: 0.671642 test: 0.717289
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  52 loss training:  13.589961243793368 Time :  4429
accuracy train: 0.997022 val: 0.671642 test: 0.720999
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  53 loss training:  12.25427719950676 Time :  4453
accuracy train: 0.998015 val: 0.689552 test: 0.719268
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

Epoch :  54 loss training:  11.816967777907848 Time :  4473
accuracy train: 0.998015 val: 0.701493 test: 0.716547
max validation accuracy : 0.701493 max acc epoch : 23 test accuracy : 0.725946

========================================================================================================================================================================================================
best acc epoch :  23
validation accuracy :  0.7014925373134329
test accuracy :  0.7259460796438288
last test_accuracy :  0.716547118476379
second best val :  0.6955223880597015
second best test :  0.7259460796438288
max gap 9
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  17 	 val_accuracy : 0.69552 	 test_accuracy : 0.71581 	 last test_accuracy : 0.71704 	 second best val : 0.69254 	 second best test : 0.71803
k :  1 	 best_acc epoch :  12 	 val_accuracy : 0.69552 	 test_accuracy : 0.71655 	 last test_accuracy : 0.71877 	 second best val : 0.69254 	 second best test : 0.71655
k :  2 	 best_acc epoch :  44 	 val_accuracy : 0.69552 	 test_accuracy : 0.72001 	 last test_accuracy : 0.72323 	 second best val : 0.69254 	 second best test : 0.72001
k :  3 	 best_acc epoch :  23 	 val_accuracy : 0.70149 	 test_accuracy : 0.72595 	 last test_accuracy : 0.71655 	 second best val : 0.69552 	 second best test : 0.72595

avg :  	 val_accuracy : 0.69701 	 test_accuracy : 0.71958 	 last_accuracy : 0.71890 	 second best val : 0.69328 	 second best test : 0.72013

std :  	 val_accuracy : 0.00259 	 test_accuracy : 0.00400 	 last_accuracy : 0.00263 	 second best val : 0.00129 	 second best test : 0.00357


date and time :  Mon Jun 14 02:07:27 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=160, tsne=True, weight_decay=0)
device :  cuda:0
Counter({2: 2591, 1: 2542, 0: 2267})

Epoch :  1 loss training:  211.76259315013885 Time :  46
accuracy train: 0.620781 val: 0.558209 test: 0.577294
max validation accuracy : 0.558209 max acc epoch : 1 test accuracy : 0.577294
Counter({0: 2816, 1: 2752, 2: 1832})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  141.44890815019608 Time :  95
accuracy train: 0.709795 val: 0.626866 test: 0.643087
max validation accuracy : 0.626866 max acc epoch : 2 test accuracy : 0.643087
Counter({0: 3062, 2: 2565, 1: 1773})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  124.19377318024635 Time :  147
accuracy train: 0.741893 val: 0.671642 test: 0.662132
max validation accuracy : 0.671642 max acc epoch : 3 test accuracy : 0.662132
Counter({0: 2972, 2: 2844, 1: 1584})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.23733702301979 Time :  184
accuracy train: 0.804434 val: 0.692537 test: 0.685629
max validation accuracy : 0.692537 max acc epoch : 4 test accuracy : 0.685629
Counter({0: 3284, 1: 2622, 2: 1494})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  87.87640354037285 Time :  225
accuracy train: 0.829252 val: 0.689552 test: 0.677467
max validation accuracy : 0.692537 max acc epoch : 4 test accuracy : 0.685629
Counter({0: 3263, 2: 2615, 1: 1522})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.33759224414825 Time :  258
accuracy train: 0.833554 val: 0.707463 test: 0.694781
max validation accuracy : 0.707463 max acc epoch : 6 test accuracy : 0.694781
Counter({0: 3347, 1: 2545, 2: 1508})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  71.87566159665585 Time :  296
accuracy train: 0.859365 val: 0.704478 test: 0.705664
max validation accuracy : 0.707463 max acc epoch : 6 test accuracy : 0.694781
Counter({2: 3350, 0: 2544, 1: 1506})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.08080273866653 Time :  335
accuracy train: 0.867637 val: 0.707463 test: 0.707890
max validation accuracy : 0.707463 max acc epoch : 6 test accuracy : 0.694781
Counter({0: 3391, 1: 2517, 2: 1492})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  66.18917867541313 Time :  372
accuracy train: 0.880212 val: 0.722388 test: 0.714321
max validation accuracy : 0.722388 max acc epoch : 9 test accuracy : 0.714321
Counter({2: 3382, 1: 2519, 0: 1499})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.12287175655365 Time :  407
accuracy train: 0.894110 val: 0.716418 test: 0.713084
max validation accuracy : 0.722388 max acc epoch : 9 test accuracy : 0.714321
Counter({0: 3354, 1: 2547, 2: 1499})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  57.829915672540665 Time :  444
accuracy train: 0.897750 val: 0.722388 test: 0.715310
max validation accuracy : 0.722388 max acc epoch : 9 test accuracy : 0.714321
Counter({0: 3393, 2: 2513, 1: 1494})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  55.61331456899643 Time :  489
accuracy train: 0.914957 val: 0.734328 test: 0.710364
max validation accuracy : 0.734328 max acc epoch : 12 test accuracy : 0.710364
Counter({2: 3378, 1: 2524, 0: 1498})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  50.51491132378578 Time :  539
accuracy train: 0.915288 val: 0.737313 test: 0.714568
max validation accuracy : 0.737313 max acc epoch : 13 test accuracy : 0.714568
Counter({2: 3375, 1: 2527, 0: 1498})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  49.61386273056269 Time :  587
accuracy train: 0.924222 val: 0.734328 test: 0.715063
max validation accuracy : 0.737313 max acc epoch : 13 test accuracy : 0.714568
Counter({1: 3371, 2: 2534, 0: 1495})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  49.239067167043686 Time :  636
accuracy train: 0.923561 val: 0.722388 test: 0.713826
max validation accuracy : 0.737313 max acc epoch : 13 test accuracy : 0.714568
Counter({0: 3363, 1: 2541, 2: 1496})

Epoch :  16 loss training:  46.21356637775898 Time :  685
accuracy train: 0.929848 val: 0.731343 test: 0.714816
max validation accuracy : 0.737313 max acc epoch : 13 test accuracy : 0.714568
Counter({0: 3357, 1: 2546, 2: 1497})

Epoch :  17 loss training:  44.87393316626549 Time :  734
accuracy train: 0.932826 val: 0.731343 test: 0.715805
max validation accuracy : 0.737313 max acc epoch : 13 test accuracy : 0.714568
Counter({0: 3352, 1: 2551, 2: 1497})

Epoch :  18 loss training:  43.3989754319191 Time :  779
accuracy train: 0.937790 val: 0.731343 test: 0.716547
max validation accuracy : 0.737313 max acc epoch : 13 test accuracy : 0.714568
Counter({0: 3335, 2: 2567, 1: 1498})

Epoch :  19 loss training:  41.71270594000816 Time :  829
accuracy train: 0.943415 val: 0.731343 test: 0.715063
max validation accuracy : 0.737313 max acc epoch : 13 test accuracy : 0.714568
Counter({0: 3316, 1: 2590, 2: 1494})

Epoch :  20 loss training:  42.50820776075125 Time :  886
accuracy train: 0.946724 val: 0.731343 test: 0.719515
max validation accuracy : 0.737313 max acc epoch : 13 test accuracy : 0.714568
Counter({1: 3317, 0: 2593, 2: 1490})

Epoch :  21 loss training:  40.204141929745674 Time :  941
accuracy train: 0.954666 val: 0.734328 test: 0.714568
max validation accuracy : 0.737313 max acc epoch : 13 test accuracy : 0.714568
Counter({0: 3326, 1: 2584, 2: 1490})

Epoch :  22 loss training:  38.14529265463352 Time :  990
accuracy train: 0.951688 val: 0.734328 test: 0.714816
max validation accuracy : 0.737313 max acc epoch : 13 test accuracy : 0.714568
Counter({0: 3325, 1: 2585, 2: 1490})

Epoch :  23 loss training:  37.367726504802704 Time :  1025
accuracy train: 0.954997 val: 0.737313 test: 0.716547
max validation accuracy : 0.737313 max acc epoch : 13 test accuracy : 0.714568
Counter({2: 3313, 1: 2597, 0: 1490})

Epoch :  24 loss training:  35.69047902524471 Time :  1061
accuracy train: 0.959298 val: 0.731343 test: 0.716052
max validation accuracy : 0.737313 max acc epoch : 13 test accuracy : 0.714568
Counter({0: 3305, 1: 2606, 2: 1489})

Epoch :  25 loss training:  35.03333492577076 Time :  1101
accuracy train: 0.961284 val: 0.737313 test: 0.711848
max validation accuracy : 0.737313 max acc epoch : 13 test accuracy : 0.714568
Counter({0: 3261, 1: 2649, 2: 1490})

Epoch :  26 loss training:  34.35513439774513 Time :  1140
accuracy train: 0.965255 val: 0.743284 test: 0.717784
max validation accuracy : 0.743284 max acc epoch : 26 test accuracy : 0.717784
Counter({0: 3260, 1: 2649, 2: 1491})

Epoch :  27 loss training:  32.61288170516491 Time :  1173
accuracy train: 0.969226 val: 0.734328 test: 0.717289
max validation accuracy : 0.743284 max acc epoch : 26 test accuracy : 0.717784
Counter({0: 3245, 1: 2660, 2: 1495})

Epoch :  28 loss training:  31.47011934965849 Time :  1214
accuracy train: 0.968895 val: 0.740299 test: 0.719268
max validation accuracy : 0.743284 max acc epoch : 26 test accuracy : 0.717784
Counter({0: 3254, 1: 2656, 2: 1490})

Epoch :  29 loss training:  29.70268365740776 Time :  1248
accuracy train: 0.972866 val: 0.740299 test: 0.714074
max validation accuracy : 0.743284 max acc epoch : 26 test accuracy : 0.717784
Counter({0: 3269, 1: 2651, 2: 1480})

Epoch :  30 loss training:  29.841134645044804 Time :  1291
accuracy train: 0.978822 val: 0.740299 test: 0.718526
max validation accuracy : 0.743284 max acc epoch : 26 test accuracy : 0.717784
Counter({0: 3275, 2: 2649, 1: 1476})

Epoch :  31 loss training:  29.320381071418524 Time :  1336
accuracy train: 0.975844 val: 0.752239 test: 0.718526
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({0: 3293, 2: 2634, 1: 1473})

Epoch :  32 loss training:  28.53718786686659 Time :  1379
accuracy train: 0.979815 val: 0.743284 test: 0.719268
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({2: 3299, 0: 2628, 1: 1473})

Epoch :  33 loss training:  27.629860565066338 Time :  1422
accuracy train: 0.981469 val: 0.734328 test: 0.718526
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({0: 3303, 2: 2628, 1: 1469})

Epoch :  34 loss training:  25.73398070782423 Time :  1479
accuracy train: 0.983786 val: 0.722388 test: 0.718031
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({0: 3318, 2: 2621, 1: 1461})

Epoch :  35 loss training:  23.723381768912077 Time :  1523
accuracy train: 0.984116 val: 0.746269 test: 0.717042
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({0: 3322, 1: 2621, 2: 1457})

Epoch :  36 loss training:  22.924758162349463 Time :  1564
accuracy train: 0.986102 val: 0.740299 test: 0.716052
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({2: 3355, 0: 2592, 1: 1453})

Epoch :  37 loss training:  22.075901743024588 Time :  1608
accuracy train: 0.988418 val: 0.743284 test: 0.715805
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({0: 3355, 1: 2593, 2: 1452})

Epoch :  38 loss training:  22.28617997094989 Time :  1650
accuracy train: 0.989080 val: 0.737313 test: 0.714321
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({0: 3363, 1: 2591, 2: 1446})

Epoch :  39 loss training:  21.30351970344782 Time :  1689
accuracy train: 0.991727 val: 0.731343 test: 0.710611
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({0: 3356, 1: 2610, 2: 1434})

Epoch :  40 loss training:  19.341085700318217 Time :  1725
accuracy train: 0.991727 val: 0.740299 test: 0.719763
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({0: 3359, 2: 2611, 1: 1430})

Epoch :  41 loss training:  20.276644056662917 Time :  1762
accuracy train: 0.993713 val: 0.728358 test: 0.720257
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({2: 3352, 0: 2623, 1: 1425})

Epoch :  42 loss training:  17.725384276360273 Time :  1796
accuracy train: 0.993382 val: 0.740299 test: 0.716794
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({0: 3358, 2: 2619, 1: 1423})

Epoch :  43 loss training:  18.982915602624416 Time :  1832
accuracy train: 0.994044 val: 0.731343 test: 0.717536
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({0: 3357, 2: 2621, 1: 1422})

Epoch :  44 loss training:  17.174786027520895 Time :  1868
accuracy train: 0.996360 val: 0.728358 test: 0.718279
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({2: 3364, 1: 2621, 0: 1415})

Epoch :  45 loss training:  16.50170760974288 Time :  1904
accuracy train: 0.995698 val: 0.719403 test: 0.720010
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({0: 3393, 1: 2596, 2: 1411})

Epoch :  46 loss training:  16.589977864176035 Time :  1942
accuracy train: 0.996360 val: 0.740299 test: 0.719515
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({1: 3403, 0: 2593, 2: 1404})

Epoch :  47 loss training:  15.446552440524101 Time :  1978
accuracy train: 0.996691 val: 0.743284 test: 0.715805
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({0: 3400, 2: 2596, 1: 1404})

Epoch :  48 loss training:  15.341898804530501 Time :  2015
accuracy train: 0.997684 val: 0.731343 test: 0.713579
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({0: 3400, 1: 2596, 2: 1404})

Epoch :  49 loss training:  15.167834280058742 Time :  2051
accuracy train: 0.997353 val: 0.725373 test: 0.717536
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({0: 3376, 1: 2613, 2: 1411})

Epoch :  50 loss training:  14.117815993726254 Time :  2088
accuracy train: 0.997353 val: 0.731343 test: 0.717536
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({2: 3380, 0: 2609, 1: 1411})

Epoch :  51 loss training:  12.394339695572853 Time :  2124
accuracy train: 0.997022 val: 0.737313 test: 0.719268
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({1: 3374, 2: 2611, 0: 1415})

Epoch :  52 loss training:  13.147744884714484 Time :  2161
accuracy train: 0.998345 val: 0.731343 test: 0.719268
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({2: 3370, 1: 2615, 0: 1415})

Epoch :  53 loss training:  12.146462330594659 Time :  2195
accuracy train: 0.999338 val: 0.728358 test: 0.719021
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({0: 3385, 2: 2608, 1: 1407})

Epoch :  54 loss training:  11.958983259275556 Time :  2231
accuracy train: 0.999338 val: 0.734328 test: 0.718773
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({0: 3379, 2: 2614, 1: 1407})

Epoch :  55 loss training:  12.006278229877353 Time :  2264
accuracy train: 0.999338 val: 0.734328 test: 0.719763
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({0: 3385, 1: 2610, 2: 1405})

Epoch :  56 loss training:  11.190379340201616 Time :  2302
accuracy train: 0.999338 val: 0.740299 test: 0.720010
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({2: 3402, 1: 2595, 0: 1403})

Epoch :  57 loss training:  10.780814262107015 Time :  2340
accuracy train: 0.999669 val: 0.734328 test: 0.715805
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({1: 3398, 2: 2598, 0: 1404})

Epoch :  58 loss training:  10.017010498791933 Time :  2377
accuracy train: 1.000000 val: 0.731343 test: 0.717042
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({2: 3413, 0: 2590, 1: 1397})

Epoch :  59 loss training:  9.728674808517098 Time :  2415
accuracy train: 0.999669 val: 0.740299 test: 0.715063
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({0: 3408, 1: 2595, 2: 1397})

Epoch :  60 loss training:  9.52113196067512 Time :  2451
accuracy train: 0.999338 val: 0.731343 test: 0.716794
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({0: 3416, 2: 2594, 1: 1390})

Epoch :  61 loss training:  8.914890203624964 Time :  2487
accuracy train: 0.999669 val: 0.725373 test: 0.717042
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({0: 3417, 1: 2596, 2: 1387})

Epoch :  62 loss training:  7.986720410641283 Time :  2525
accuracy train: 0.999669 val: 0.737313 test: 0.720010
max validation accuracy : 0.752239 max acc epoch : 31 test accuracy : 0.718526
Counter({1: 3414, 0: 2602, 2: 1384})

========================================================================================================================================================================================================
best acc epoch :  31
validation accuracy :  0.7522388059701492
test accuracy :  0.7185258471432104
last test_accuracy :  0.7200098936433341
second best val :  0.746268656716418
second best test :  0.7185258471432104
max gap 13
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=160, tsne=True, weight_decay=0)
device :  cuda:0
Counter({2: 2591, 1: 2542, 0: 2267})

Epoch :  1 loss training:  211.57395207881927 Time :  2731
accuracy train: 0.624421 val: 0.561194 test: 0.580510
max validation accuracy : 0.561194 max acc epoch : 1 test accuracy : 0.580510
Counter({2: 2789, 0: 2448, 1: 2163})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  140.97256463766098 Time :  2773
accuracy train: 0.712442 val: 0.647761 test: 0.651002
max validation accuracy : 0.647761 max acc epoch : 2 test accuracy : 0.651002
Counter({2: 2680, 1: 2425, 0: 2295})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  124.00508686900139 Time :  2823
accuracy train: 0.743547 val: 0.671642 test: 0.669058
max validation accuracy : 0.671642 max acc epoch : 3 test accuracy : 0.669058
Counter({0: 2837, 2: 2835, 1: 1728})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.32491171360016 Time :  2872
accuracy train: 0.806420 val: 0.701493 test: 0.684640
max validation accuracy : 0.701493 max acc epoch : 4 test accuracy : 0.684640
Counter({2: 3281, 0: 2627, 1: 1492})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.2209979891777 Time :  2925
accuracy train: 0.829583 val: 0.692537 test: 0.680683
max validation accuracy : 0.701493 max acc epoch : 4 test accuracy : 0.684640
Counter({1: 3187, 0: 2704, 2: 1509})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.32486179471016 Time :  2974
accuracy train: 0.835208 val: 0.692537 test: 0.689587
max validation accuracy : 0.701493 max acc epoch : 4 test accuracy : 0.684640
Counter({0: 3267, 1: 2630, 2: 1503})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  72.10105231404305 Time :  3020
accuracy train: 0.858041 val: 0.707463 test: 0.701212
max validation accuracy : 0.707463 max acc epoch : 7 test accuracy : 0.701212
Counter({0: 3290, 1: 2614, 2: 1496})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.83207368850708 Time :  3068
accuracy train: 0.860688 val: 0.710448 test: 0.706653
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.706653
Counter({0: 3301, 1: 2606, 2: 1493})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  66.77627737820148 Time :  3111
accuracy train: 0.879550 val: 0.722388 test: 0.708632
max validation accuracy : 0.722388 max acc epoch : 9 test accuracy : 0.708632
Counter({1: 3305, 0: 2604, 2: 1491})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.07159963995218 Time :  3157
accuracy train: 0.892786 val: 0.728358 test: 0.710364
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.710364
Counter({0: 3302, 1: 2609, 2: 1489})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  57.49818824976683 Time :  3196
accuracy train: 0.894772 val: 0.722388 test: 0.714568
max validation accuracy : 0.728358 max acc epoch : 10 test accuracy : 0.710364
Counter({0: 3295, 2: 2615, 1: 1490})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  54.28564451634884 Time :  3240
accuracy train: 0.911979 val: 0.731343 test: 0.706653
max validation accuracy : 0.731343 max acc epoch : 12 test accuracy : 0.706653
Counter({0: 3288, 2: 2618, 1: 1494})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  49.686624959111214 Time :  3291
accuracy train: 0.917273 val: 0.740299 test: 0.712837
max validation accuracy : 0.740299 max acc epoch : 13 test accuracy : 0.712837
Counter({0: 3302, 2: 2605, 1: 1493})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  50.45020201802254 Time :  3339
accuracy train: 0.920913 val: 0.734328 test: 0.710858
max validation accuracy : 0.740299 max acc epoch : 13 test accuracy : 0.712837
Counter({2: 3300, 0: 2608, 1: 1492})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  48.72693391144276 Time :  3386
accuracy train: 0.919259 val: 0.725373 test: 0.717536
max validation accuracy : 0.740299 max acc epoch : 13 test accuracy : 0.712837
Counter({0: 3291, 1: 2620, 2: 1489})

Epoch :  16 loss training:  46.69629938900471 Time :  3432
accuracy train: 0.928524 val: 0.728358 test: 0.718773
max validation accuracy : 0.740299 max acc epoch : 13 test accuracy : 0.712837
Counter({0: 3293, 2: 2616, 1: 1491})

Epoch :  17 loss training:  44.64675346016884 Time :  3472
accuracy train: 0.931171 val: 0.722388 test: 0.716547
max validation accuracy : 0.740299 max acc epoch : 13 test accuracy : 0.712837
Counter({2: 3291, 0: 2611, 1: 1498})

Epoch :  18 loss training:  44.09711077809334 Time :  3514
accuracy train: 0.935473 val: 0.734328 test: 0.721741
max validation accuracy : 0.740299 max acc epoch : 13 test accuracy : 0.712837
Counter({0: 3286, 2: 2612, 1: 1502})

Epoch :  19 loss training:  42.909107491374016 Time :  3550
accuracy train: 0.940106 val: 0.725373 test: 0.718279
max validation accuracy : 0.740299 max acc epoch : 13 test accuracy : 0.712837
Counter({1: 3286, 2: 2613, 0: 1501})

Epoch :  20 loss training:  40.598278760910034 Time :  3585
accuracy train: 0.945731 val: 0.719403 test: 0.720010
max validation accuracy : 0.740299 max acc epoch : 13 test accuracy : 0.712837
Counter({0: 3286, 1: 2614, 2: 1500})

Epoch :  21 loss training:  39.18793970346451 Time :  3621
accuracy train: 0.952349 val: 0.722388 test: 0.717536
max validation accuracy : 0.740299 max acc epoch : 13 test accuracy : 0.712837
Counter({2: 3304, 0: 2600, 1: 1496})

Epoch :  22 loss training:  38.841094337403774 Time :  3659
accuracy train: 0.954004 val: 0.731343 test: 0.719021
max validation accuracy : 0.740299 max acc epoch : 13 test accuracy : 0.712837
Counter({0: 3301, 2: 2606, 1: 1493})

Epoch :  23 loss training:  37.54078236222267 Time :  3701
accuracy train: 0.954004 val: 0.731343 test: 0.719763
max validation accuracy : 0.740299 max acc epoch : 13 test accuracy : 0.712837
Counter({0: 3292, 2: 2615, 1: 1493})

Epoch :  24 loss training:  36.24161896854639 Time :  3741
accuracy train: 0.958306 val: 0.734328 test: 0.721247
max validation accuracy : 0.740299 max acc epoch : 13 test accuracy : 0.712837
Counter({2: 3288, 1: 2617, 0: 1495})

Epoch :  25 loss training:  34.58351023495197 Time :  3781
accuracy train: 0.963600 val: 0.728358 test: 0.718031
max validation accuracy : 0.740299 max acc epoch : 13 test accuracy : 0.712837
Counter({1: 3259, 2: 2649, 0: 1492})

Epoch :  26 loss training:  33.75846250355244 Time :  3819
accuracy train: 0.967240 val: 0.734328 test: 0.718031
max validation accuracy : 0.740299 max acc epoch : 13 test accuracy : 0.712837
Counter({0: 3267, 1: 2643, 2: 1490})

Epoch :  27 loss training:  32.35565331950784 Time :  3857
accuracy train: 0.967902 val: 0.737313 test: 0.717042
max validation accuracy : 0.740299 max acc epoch : 13 test accuracy : 0.712837
Counter({1: 3266, 2: 2649, 0: 1485})

Epoch :  28 loss training:  31.607274364680052 Time :  3900
accuracy train: 0.970549 val: 0.734328 test: 0.718279
max validation accuracy : 0.740299 max acc epoch : 13 test accuracy : 0.712837
Counter({1: 3266, 0: 2651, 2: 1483})

Epoch :  29 loss training:  31.456234984099865 Time :  3945
accuracy train: 0.972204 val: 0.725373 test: 0.717536
max validation accuracy : 0.740299 max acc epoch : 13 test accuracy : 0.712837
Counter({0: 3265, 1: 2648, 2: 1487})

Epoch :  30 loss training:  30.722500763833523 Time :  3991
accuracy train: 0.976175 val: 0.737313 test: 0.715063
max validation accuracy : 0.740299 max acc epoch : 13 test accuracy : 0.712837
Counter({2: 3264, 0: 2648, 1: 1488})

Epoch :  31 loss training:  29.07486654818058 Time :  4035
accuracy train: 0.977167 val: 0.746269 test: 0.717536
max validation accuracy : 0.746269 max acc epoch : 31 test accuracy : 0.717536
Counter({0: 3263, 2: 2646, 1: 1491})

Epoch :  32 loss training:  28.58554846793413 Time :  4081
accuracy train: 0.980807 val: 0.731343 test: 0.720010
max validation accuracy : 0.746269 max acc epoch : 31 test accuracy : 0.717536
Counter({0: 3262, 2: 2642, 1: 1496})

Epoch :  33 loss training:  27.676938369870186 Time :  4122
accuracy train: 0.981138 val: 0.731343 test: 0.715310
max validation accuracy : 0.746269 max acc epoch : 31 test accuracy : 0.717536
Counter({1: 3265, 0: 2641, 2: 1494})

Epoch :  34 loss training:  25.917814888060093 Time :  4162
accuracy train: 0.985771 val: 0.746269 test: 0.717784
max validation accuracy : 0.746269 max acc epoch : 31 test accuracy : 0.717536
Counter({2: 3266, 0: 2640, 1: 1494})

Epoch :  35 loss training:  23.801253102719784 Time :  4200
accuracy train: 0.984116 val: 0.746269 test: 0.718279
max validation accuracy : 0.746269 max acc epoch : 31 test accuracy : 0.717536
Counter({1: 3263, 0: 2649, 2: 1488})

Epoch :  36 loss training:  22.929634269326925 Time :  4235
accuracy train: 0.986102 val: 0.740299 test: 0.717784
max validation accuracy : 0.746269 max acc epoch : 31 test accuracy : 0.717536
Counter({0: 3266, 1: 2650, 2: 1484})

Epoch :  37 loss training:  22.580175008624792 Time :  4272
accuracy train: 0.990073 val: 0.749254 test: 0.718773
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({0: 3273, 1: 2649, 2: 1478})

Epoch :  38 loss training:  22.809161216020584 Time :  4308
accuracy train: 0.987756 val: 0.743284 test: 0.719515
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({0: 3272, 1: 2652, 2: 1476})

Epoch :  39 loss training:  21.397734869271517 Time :  4339
accuracy train: 0.990404 val: 0.716418 test: 0.714074
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({0: 3275, 1: 2662, 2: 1463})

Epoch :  40 loss training:  19.96170425787568 Time :  4373
accuracy train: 0.988749 val: 0.740299 test: 0.721741
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({0: 3283, 1: 2661, 2: 1456})

Epoch :  41 loss training:  19.87453280389309 Time :  4412
accuracy train: 0.993051 val: 0.725373 test: 0.717784
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({0: 3273, 2: 2670, 1: 1457})

Epoch :  42 loss training:  18.406220115721226 Time :  4446
accuracy train: 0.992389 val: 0.731343 test: 0.714321
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({0: 3270, 1: 2671, 2: 1459})

Epoch :  43 loss training:  17.886182514950633 Time :  4480
accuracy train: 0.993051 val: 0.734328 test: 0.720999
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({0: 3284, 1: 2668, 2: 1448})

Epoch :  44 loss training:  16.99922202154994 Time :  4515
accuracy train: 0.994044 val: 0.740299 test: 0.716300
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({1: 3292, 2: 2667, 0: 1441})

Epoch :  45 loss training:  16.358287435024977 Time :  4549
accuracy train: 0.996029 val: 0.728358 test: 0.715310
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({0: 3289, 2: 2666, 1: 1445})

Epoch :  46 loss training:  15.975214470177889 Time :  4585
accuracy train: 0.995036 val: 0.737313 test: 0.718773
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({2: 3307, 0: 2667, 1: 1426})

Epoch :  47 loss training:  16.038698080927134 Time :  4625
accuracy train: 0.995698 val: 0.737313 test: 0.718773
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({0: 3301, 2: 2676, 1: 1423})

Epoch :  48 loss training:  16.106860239058733 Time :  4663
accuracy train: 0.997353 val: 0.728358 test: 0.715558
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({0: 3299, 1: 2678, 2: 1423})

Epoch :  49 loss training:  15.392650350928307 Time :  4701
accuracy train: 0.996691 val: 0.716418 test: 0.719268
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({0: 3295, 1: 2683, 2: 1422})

Epoch :  50 loss training:  14.055697310715914 Time :  4738
accuracy train: 0.997022 val: 0.737313 test: 0.717042
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({2: 3295, 0: 2681, 1: 1424})

Epoch :  51 loss training:  12.829725161194801 Time :  4773
accuracy train: 0.997022 val: 0.743284 test: 0.717289
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({1: 3297, 2: 2681, 0: 1422})

Epoch :  52 loss training:  13.135727919638157 Time :  4808
accuracy train: 0.997684 val: 0.734328 test: 0.718279
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({2: 3294, 1: 2686, 0: 1420})

Epoch :  53 loss training:  12.723775293678045 Time :  4845
accuracy train: 0.997684 val: 0.725373 test: 0.720257
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({0: 3302, 1: 2683, 2: 1415})

Epoch :  54 loss training:  11.665893878787756 Time :  4890
accuracy train: 0.999007 val: 0.728358 test: 0.718031
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({0: 3303, 2: 2686, 1: 1411})

Epoch :  55 loss training:  11.909645926207304 Time :  4933
accuracy train: 0.999669 val: 0.728358 test: 0.720505
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({0: 3295, 2: 2693, 1: 1412})

Epoch :  56 loss training:  11.404684137552977 Time :  4973
accuracy train: 0.999669 val: 0.737313 test: 0.720999
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({0: 3300, 1: 2686, 2: 1414})

Epoch :  57 loss training:  11.058969996869564 Time :  5014
accuracy train: 1.000000 val: 0.731343 test: 0.716052
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({0: 3298, 1: 2688, 2: 1414})

Epoch :  58 loss training:  10.5908817127347 Time :  5050
accuracy train: 0.999669 val: 0.728358 test: 0.713332
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({2: 3300, 0: 2689, 1: 1411})

Epoch :  59 loss training:  9.03004933334887 Time :  5085
accuracy train: 0.999669 val: 0.731343 test: 0.716547
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({0: 3306, 1: 2689, 2: 1405})

Epoch :  60 loss training:  9.277085622772574 Time :  5122
accuracy train: 0.999669 val: 0.731343 test: 0.714816
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({1: 3309, 2: 2690, 0: 1401})

Epoch :  61 loss training:  9.638472901657224 Time :  5158
accuracy train: 0.999669 val: 0.740299 test: 0.720010
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({0: 3316, 2: 2684, 1: 1400})

Epoch :  62 loss training:  8.785347679629922 Time :  5193
accuracy train: 1.000000 val: 0.722388 test: 0.718279
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({2: 3303, 0: 2692, 1: 1405})

Epoch :  63 loss training:  8.29850741662085 Time :  5227
accuracy train: 0.999669 val: 0.728358 test: 0.720752
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({0: 3311, 1: 2690, 2: 1399})

Epoch :  64 loss training:  8.899515914730728 Time :  5272
accuracy train: 0.999669 val: 0.737313 test: 0.724215
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({0: 3324, 1: 2676, 2: 1400})

Epoch :  65 loss training:  8.046339908614755 Time :  5308
accuracy train: 1.000000 val: 0.725373 test: 0.718031
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({2: 3353, 1: 2654, 0: 1393})

Epoch :  66 loss training:  7.422515363432467 Time :  5347
accuracy train: 0.999669 val: 0.722388 test: 0.716794
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({2: 3374, 0: 2630, 1: 1396})

Epoch :  67 loss training:  7.262102029286325 Time :  5384
accuracy train: 1.000000 val: 0.722388 test: 0.714816
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({2: 3374, 1: 2631, 0: 1395})

Epoch :  68 loss training:  6.152399689890444 Time :  5418
accuracy train: 1.000000 val: 0.725373 test: 0.719515
max validation accuracy : 0.749254 max acc epoch : 37 test accuracy : 0.718773
Counter({2: 3373, 0: 2632, 1: 1395})

========================================================================================================================================================================================================
best acc epoch :  37
validation accuracy :  0.7492537313432835
test accuracy :  0.7187731882265644
last test_accuracy :  0.7195152114766262
second best val :  0.746268656716418
second best test :  0.7175364828097948
max gap 18
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=160, tsne=True, weight_decay=0)
device :  cuda:0
Counter({2: 2591, 1: 2542, 0: 2267})

Epoch :  1 loss training:  211.55467295646667 Time :  5577
accuracy train: 0.624421 val: 0.555224 test: 0.580757
max validation accuracy : 0.555224 max acc epoch : 1 test accuracy : 0.580757
Counter({2: 2815, 0: 2520, 1: 2065})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  140.90714728832245 Time :  5621
accuracy train: 0.708140 val: 0.632836 test: 0.642592
max validation accuracy : 0.632836 max acc epoch : 2 test accuracy : 0.642592
Counter({2: 2921, 0: 2684, 1: 1795})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  124.31155407428741 Time :  5666
accuracy train: 0.744209 val: 0.680597 test: 0.669305
max validation accuracy : 0.680597 max acc epoch : 3 test accuracy : 0.669305
Counter({1: 3019, 2: 2797, 0: 1584})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.72148475050926 Time :  5704
accuracy train: 0.799471 val: 0.689552 test: 0.687114
max validation accuracy : 0.689552 max acc epoch : 4 test accuracy : 0.687114
Counter({0: 3339, 1: 2577, 2: 1484})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.25124126672745 Time :  5741
accuracy train: 0.832230 val: 0.701493 test: 0.681919
max validation accuracy : 0.701493 max acc epoch : 5 test accuracy : 0.681919
Counter({0: 3319, 2: 2597, 1: 1484})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.72300592064857 Time :  5784
accuracy train: 0.839841 val: 0.716418 test: 0.690824
max validation accuracy : 0.716418 max acc epoch : 6 test accuracy : 0.690824
Counter({0: 3365, 2: 2543, 1: 1492})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  71.80836130678654 Time :  5820
accuracy train: 0.857710 val: 0.698507 test: 0.705169
max validation accuracy : 0.716418 max acc epoch : 6 test accuracy : 0.690824
Counter({1: 3350, 2: 2561, 0: 1489})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.46974729001522 Time :  5858
accuracy train: 0.869623 val: 0.713433 test: 0.711106
max validation accuracy : 0.716418 max acc epoch : 6 test accuracy : 0.690824
Counter({2: 3362, 0: 2556, 1: 1482})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  66.96988825500011 Time :  5893
accuracy train: 0.880874 val: 0.734328 test: 0.715805
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.715805
Counter({0: 3368, 2: 2550, 1: 1482})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  57.775067523121834 Time :  5930
accuracy train: 0.891463 val: 0.731343 test: 0.713826
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.715805
Counter({0: 3359, 1: 2556, 2: 1485})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  57.74904225021601 Time :  5966
accuracy train: 0.899404 val: 0.734328 test: 0.712342
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.715805
Counter({0: 3354, 2: 2567, 1: 1479})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  53.5641693174839 Time :  6000
accuracy train: 0.911979 val: 0.737313 test: 0.709869
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.709869
Counter({0: 3347, 2: 2571, 1: 1482})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  49.52437327802181 Time :  6035
accuracy train: 0.916281 val: 0.743284 test: 0.713579
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.713579
Counter({0: 3353, 2: 2563, 1: 1484})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  49.96556942164898 Time :  6070
accuracy train: 0.926870 val: 0.740299 test: 0.715310
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.713579
Counter({0: 3354, 2: 2560, 1: 1486})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  49.001475527882576 Time :  6104
accuracy train: 0.924222 val: 0.734328 test: 0.715063
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.713579
Counter({0: 3335, 1: 2577, 2: 1488})

Epoch :  16 loss training:  46.4139261841774 Time :  6136
accuracy train: 0.927862 val: 0.743284 test: 0.718031
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.713579
Counter({2: 3347, 0: 2564, 1: 1489})

Epoch :  17 loss training:  44.384079560637474 Time :  6172
accuracy train: 0.933488 val: 0.737313 test: 0.720010
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.713579
Counter({1: 3345, 2: 2565, 0: 1490})

Epoch :  18 loss training:  43.49159033596516 Time :  6208
accuracy train: 0.934480 val: 0.737313 test: 0.718031
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.713579
Counter({2: 3335, 0: 2568, 1: 1497})

Epoch :  19 loss training:  42.74612307548523 Time :  6247
accuracy train: 0.941430 val: 0.734328 test: 0.720752
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.713579
Counter({0: 3333, 2: 2570, 1: 1497})

Epoch :  20 loss training:  40.68242723494768 Time :  6286
accuracy train: 0.947055 val: 0.731343 test: 0.720999
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.713579
Counter({0: 3333, 1: 2575, 2: 1492})

Epoch :  21 loss training:  39.254573568701744 Time :  6316
accuracy train: 0.950364 val: 0.731343 test: 0.720505
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.713579
Counter({0: 3340, 2: 2570, 1: 1490})

Epoch :  22 loss training:  38.941496290266514 Time :  6350
accuracy train: 0.954335 val: 0.743284 test: 0.716547
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.713579
Counter({0: 3341, 1: 2571, 2: 1488})

Epoch :  23 loss training:  37.28799007087946 Time :  6383
accuracy train: 0.954666 val: 0.734328 test: 0.719021
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.713579
Counter({1: 3331, 2: 2583, 0: 1486})

Epoch :  24 loss training:  35.751867078244686 Time :  6419
accuracy train: 0.957644 val: 0.740299 test: 0.717784
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.713579
Counter({0: 3331, 2: 2583, 1: 1486})

Epoch :  25 loss training:  34.55329788476229 Time :  6451
accuracy train: 0.959960 val: 0.734328 test: 0.718526
max validation accuracy : 0.743284 max acc epoch : 13 test accuracy : 0.713579
Counter({0: 3309, 1: 2605, 2: 1486})

Epoch :  26 loss training:  33.33942986279726 Time :  6488
accuracy train: 0.966578 val: 0.746269 test: 0.720010
max validation accuracy : 0.746269 max acc epoch : 26 test accuracy : 0.720010
Counter({0: 3313, 2: 2603, 1: 1484})

Epoch :  27 loss training:  31.690126590430737 Time :  6528
accuracy train: 0.968233 val: 0.743284 test: 0.714816
max validation accuracy : 0.746269 max acc epoch : 26 test accuracy : 0.720010
Counter({0: 3315, 1: 2604, 2: 1481})

Epoch :  28 loss training:  30.433803521096706 Time :  6568
accuracy train: 0.971542 val: 0.731343 test: 0.715063
max validation accuracy : 0.746269 max acc epoch : 26 test accuracy : 0.720010
Counter({0: 3322, 1: 2603, 2: 1475})

Epoch :  29 loss training:  29.983451791107655 Time :  6616
accuracy train: 0.972204 val: 0.728358 test: 0.712837
max validation accuracy : 0.746269 max acc epoch : 26 test accuracy : 0.720010
Counter({0: 3325, 2: 2601, 1: 1474})

Epoch :  30 loss training:  31.202458418905735 Time :  6663
accuracy train: 0.975513 val: 0.734328 test: 0.718773
max validation accuracy : 0.746269 max acc epoch : 26 test accuracy : 0.720010
Counter({0: 3310, 2: 2617, 1: 1473})

Epoch :  31 loss training:  27.711509991437197 Time :  6718
accuracy train: 0.975844 val: 0.749254 test: 0.719763
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({1: 3311, 0: 2618, 2: 1471})

Epoch :  32 loss training:  27.740229107439518 Time :  6764
accuracy train: 0.978822 val: 0.737313 test: 0.716547
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({0: 3312, 2: 2619, 1: 1469})

Epoch :  33 loss training:  25.129779063165188 Time :  6800
accuracy train: 0.980477 val: 0.740299 test: 0.716300
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({0: 3315, 2: 2621, 1: 1464})

Epoch :  34 loss training:  24.77783389389515 Time :  6837
accuracy train: 0.985109 val: 0.743284 test: 0.713826
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({0: 3316, 1: 2617, 2: 1467})

Epoch :  35 loss training:  24.956709820777178 Time :  6874
accuracy train: 0.983786 val: 0.740299 test: 0.722236
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({0: 3305, 1: 2629, 2: 1466})

Epoch :  36 loss training:  23.288699600845575 Time :  6912
accuracy train: 0.987426 val: 0.740299 test: 0.717289
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({2: 3303, 0: 2636, 1: 1461})

Epoch :  37 loss training:  22.648897647857666 Time :  6946
accuracy train: 0.990404 val: 0.737313 test: 0.718031
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({2: 3295, 1: 2642, 0: 1463})

Epoch :  38 loss training:  21.5116785466671 Time :  6979
accuracy train: 0.991066 val: 0.746269 test: 0.719515
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({1: 3289, 2: 2648, 0: 1463})

Epoch :  39 loss training:  21.012339361011982 Time :  7015
accuracy train: 0.991396 val: 0.749254 test: 0.722978
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({0: 3290, 1: 2645, 2: 1465})

Epoch :  40 loss training:  20.232881009578705 Time :  7052
accuracy train: 0.992389 val: 0.746269 test: 0.720505
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({1: 3286, 0: 2650, 2: 1464})

Epoch :  41 loss training:  19.36617636308074 Time :  7087
accuracy train: 0.995036 val: 0.728358 test: 0.718279
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({0: 3280, 1: 2653, 2: 1467})

Epoch :  42 loss training:  18.243489135056734 Time :  7124
accuracy train: 0.994705 val: 0.740299 test: 0.720999
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({0: 3278, 1: 2653, 2: 1469})

Epoch :  43 loss training:  17.734344581142068 Time :  7162
accuracy train: 0.996029 val: 0.746269 test: 0.719515
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({0: 3277, 2: 2658, 1: 1465})

Epoch :  44 loss training:  16.518330711871386 Time :  7197
accuracy train: 0.996029 val: 0.737313 test: 0.718773
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({2: 3277, 0: 2666, 1: 1457})

Epoch :  45 loss training:  16.146883185952902 Time :  7234
accuracy train: 0.996360 val: 0.728358 test: 0.718773
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({2: 3281, 1: 2664, 0: 1455})

Epoch :  46 loss training:  15.782216127961874 Time :  7271
accuracy train: 0.996360 val: 0.728358 test: 0.721247
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({1: 3286, 2: 2669, 0: 1445})

Epoch :  47 loss training:  15.573980294167995 Time :  7307
accuracy train: 0.996691 val: 0.731343 test: 0.718279
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({1: 3291, 2: 2668, 0: 1441})

Epoch :  48 loss training:  15.262139175087214 Time :  7344
accuracy train: 0.998676 val: 0.728358 test: 0.720999
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({1: 3296, 0: 2668, 2: 1436})

Epoch :  49 loss training:  15.304976319894195 Time :  7380
accuracy train: 0.996691 val: 0.722388 test: 0.722236
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({0: 3292, 2: 2671, 1: 1437})

Epoch :  50 loss training:  13.91199929639697 Time :  7418
accuracy train: 0.997684 val: 0.734328 test: 0.718031
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({0: 3290, 1: 2676, 2: 1434})

Epoch :  51 loss training:  13.79156844690442 Time :  7454
accuracy train: 0.998345 val: 0.731343 test: 0.719268
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({2: 3297, 1: 2677, 0: 1426})

Epoch :  52 loss training:  13.479513401165605 Time :  7493
accuracy train: 0.998676 val: 0.743284 test: 0.720505
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({2: 3309, 1: 2677, 0: 1414})

Epoch :  53 loss training:  11.013307388871908 Time :  7538
accuracy train: 0.998676 val: 0.731343 test: 0.718526
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({0: 3320, 1: 2668, 2: 1412})

Epoch :  54 loss training:  12.022266848012805 Time :  7587
accuracy train: 1.000000 val: 0.725373 test: 0.716794
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({0: 3315, 2: 2671, 1: 1414})

Epoch :  55 loss training:  11.723967760801315 Time :  7629
accuracy train: 1.000000 val: 0.731343 test: 0.720999
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({2: 3314, 0: 2675, 1: 1411})

Epoch :  56 loss training:  11.198512738570571 Time :  7675
accuracy train: 1.000000 val: 0.734328 test: 0.720257
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({1: 3322, 0: 2672, 2: 1406})

Epoch :  57 loss training:  10.540122659411281 Time :  7722
accuracy train: 1.000000 val: 0.731343 test: 0.718773
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({2: 3329, 0: 2669, 1: 1402})

Epoch :  58 loss training:  9.72175969183445 Time :  7770
accuracy train: 1.000000 val: 0.737313 test: 0.719763
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({2: 3339, 0: 2663, 1: 1398})

Epoch :  59 loss training:  9.224477203562856 Time :  7814
accuracy train: 1.000000 val: 0.731343 test: 0.721989
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({0: 3339, 1: 2665, 2: 1396})

Epoch :  60 loss training:  9.232967835851014 Time :  7858
accuracy train: 0.999669 val: 0.728358 test: 0.717042
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({0: 3342, 1: 2671, 2: 1387})

Epoch :  61 loss training:  8.876036824658513 Time :  7902
accuracy train: 0.999669 val: 0.734328 test: 0.719021
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({0: 3335, 2: 2677, 1: 1388})

Epoch :  62 loss training:  8.18286621151492 Time :  7941
accuracy train: 0.999669 val: 0.740299 test: 0.719763
max validation accuracy : 0.749254 max acc epoch : 31 test accuracy : 0.719763
Counter({2: 3329, 0: 2686, 1: 1385})

========================================================================================================================================================================================================
best acc epoch :  31
validation accuracy :  0.7492537313432835
test accuracy :  0.7197625525599802
last test_accuracy :  0.7197625525599802
second best val :  0.746268656716418
second best test :  0.7200098936433341
max gap 13
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=160, tsne=True, weight_decay=0)
device :  cuda:0
Counter({2: 2591, 1: 2542, 0: 2267})

Epoch :  1 loss training:  211.5390940308571 Time :  8119
accuracy train: 0.624090 val: 0.570149 test: 0.575068
max validation accuracy : 0.570149 max acc epoch : 1 test accuracy : 0.575068
Counter({2: 2863, 0: 2751, 1: 1786})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  141.62680333852768 Time :  8151
accuracy train: 0.710457 val: 0.650746 test: 0.646797
max validation accuracy : 0.650746 max acc epoch : 2 test accuracy : 0.646797
Counter({2: 4171, 1: 1766, 0: 1463})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  124.45012906193733 Time :  8183
accuracy train: 0.738584 val: 0.689552 test: 0.670789
max validation accuracy : 0.689552 max acc epoch : 3 test accuracy : 0.670789
Counter({2: 3141, 0: 2664, 1: 1595})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.4024948477745 Time :  8216
accuracy train: 0.797816 val: 0.698507 test: 0.686866
max validation accuracy : 0.698507 max acc epoch : 4 test accuracy : 0.686866
Counter({2: 3327, 0: 2561, 1: 1512})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  87.75255128741264 Time :  8247
accuracy train: 0.823627 val: 0.701493 test: 0.682661
max validation accuracy : 0.701493 max acc epoch : 5 test accuracy : 0.682661
Counter({0: 3274, 2: 2609, 1: 1517})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.65042877197266 Time :  8276
accuracy train: 0.833885 val: 0.701493 test: 0.686619
max validation accuracy : 0.701493 max acc epoch : 5 test accuracy : 0.682661
Counter({0: 3313, 1: 2583, 2: 1504})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  71.90140049159527 Time :  8312
accuracy train: 0.858041 val: 0.704478 test: 0.704922
max validation accuracy : 0.704478 max acc epoch : 7 test accuracy : 0.704922
Counter({1: 3297, 0: 2600, 2: 1503})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.12233348190784 Time :  8353
accuracy train: 0.863997 val: 0.713433 test: 0.707643
max validation accuracy : 0.713433 max acc epoch : 8 test accuracy : 0.707643
Counter({0: 3296, 2: 2595, 1: 1509})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  66.20799072086811 Time :  8399
accuracy train: 0.873594 val: 0.713433 test: 0.710364
max validation accuracy : 0.713433 max acc epoch : 8 test accuracy : 0.707643
Counter({0: 3293, 2: 2599, 1: 1508})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.396985709667206 Time :  8445
accuracy train: 0.888815 val: 0.731343 test: 0.712342
max validation accuracy : 0.731343 max acc epoch : 10 test accuracy : 0.712342
Counter({2: 3280, 1: 2614, 0: 1506})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.263802617788315 Time :  8495
accuracy train: 0.894441 val: 0.725373 test: 0.714074
max validation accuracy : 0.731343 max acc epoch : 10 test accuracy : 0.712342
Counter({1: 3300, 2: 2596, 0: 1504})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  55.68189425766468 Time :  8537
accuracy train: 0.910986 val: 0.740299 test: 0.712342
max validation accuracy : 0.740299 max acc epoch : 12 test accuracy : 0.712342
Counter({0: 3275, 1: 2622, 2: 1503})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  51.68930050730705 Time :  8578
accuracy train: 0.913302 val: 0.758209 test: 0.716052
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({0: 3277, 1: 2625, 2: 1498})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  49.96113362163305 Time :  8621
accuracy train: 0.916942 val: 0.734328 test: 0.719515
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({2: 3270, 0: 2638, 1: 1492})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  49.21443811058998 Time :  8671
accuracy train: 0.918266 val: 0.746269 test: 0.718526
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({0: 3271, 2: 2636, 1: 1493})

Epoch :  16 loss training:  47.12384317815304 Time :  8722
accuracy train: 0.926870 val: 0.737313 test: 0.719268
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({0: 3270, 2: 2639, 1: 1491})

Epoch :  17 loss training:  44.96947333961725 Time :  8769
accuracy train: 0.925877 val: 0.743284 test: 0.716052
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({0: 3269, 1: 2642, 2: 1489})

Epoch :  18 loss training:  43.34268078953028 Time :  8809
accuracy train: 0.930179 val: 0.737313 test: 0.717784
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({0: 3257, 1: 2653, 2: 1490})

Epoch :  19 loss training:  41.70253722369671 Time :  8846
accuracy train: 0.941099 val: 0.740299 test: 0.716052
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({0: 3262, 1: 2650, 2: 1488})

Epoch :  20 loss training:  41.31216532737017 Time :  8881
accuracy train: 0.942422 val: 0.737313 test: 0.722483
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({0: 3246, 1: 2664, 2: 1490})

Epoch :  21 loss training:  39.906347170472145 Time :  8915
accuracy train: 0.950695 val: 0.725373 test: 0.717536
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({1: 3255, 2: 2657, 0: 1488})

Epoch :  22 loss training:  38.694465801119804 Time :  8950
accuracy train: 0.950033 val: 0.737313 test: 0.722978
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({1: 3246, 0: 2664, 2: 1490})

Epoch :  23 loss training:  37.184869304299355 Time :  8983
accuracy train: 0.954666 val: 0.731343 test: 0.718279
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({0: 3240, 1: 2670, 2: 1490})

Epoch :  24 loss training:  35.60196712613106 Time :  9013
accuracy train: 0.954335 val: 0.734328 test: 0.719515
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({2: 3229, 1: 2677, 0: 1494})

Epoch :  25 loss training:  35.57569255679846 Time :  9061
accuracy train: 0.960953 val: 0.734328 test: 0.720752
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({2: 3210, 0: 2699, 1: 1491})

Epoch :  26 loss training:  34.28324946761131 Time :  9097
accuracy train: 0.961615 val: 0.737313 test: 0.719268
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({0: 3206, 1: 2702, 2: 1492})

Epoch :  27 loss training:  33.58511691913009 Time :  9134
accuracy train: 0.968564 val: 0.752239 test: 0.720999
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({2: 3206, 1: 2704, 0: 1490})

Epoch :  28 loss training:  31.9886432364583 Time :  9189
accuracy train: 0.967902 val: 0.728358 test: 0.722236
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({2: 3214, 0: 2703, 1: 1483})

Epoch :  29 loss training:  31.297462418675423 Time :  9239
accuracy train: 0.970880 val: 0.728358 test: 0.722731
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({0: 3214, 1: 2700, 2: 1486})

Epoch :  30 loss training:  30.843195781111717 Time :  9274
accuracy train: 0.974520 val: 0.734328 test: 0.715805
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({0: 3218, 1: 2698, 2: 1484})

Epoch :  31 loss training:  27.913691394031048 Time :  9313
accuracy train: 0.978160 val: 0.746269 test: 0.719515
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({1: 3225, 0: 2694, 2: 1481})

Epoch :  32 loss training:  26.793887980282307 Time :  9366
accuracy train: 0.977167 val: 0.746269 test: 0.721989
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({0: 3219, 2: 2699, 1: 1482})

Epoch :  33 loss training:  26.728543039411306 Time :  9421
accuracy train: 0.977498 val: 0.740299 test: 0.722483
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({0: 3220, 1: 2702, 2: 1478})

Epoch :  34 loss training:  25.955384895205498 Time :  9462
accuracy train: 0.983124 val: 0.746269 test: 0.718773
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({0: 3237, 2: 2693, 1: 1470})

Epoch :  35 loss training:  23.97180190309882 Time :  9500
accuracy train: 0.983124 val: 0.734328 test: 0.718773
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({1: 3245, 0: 2696, 2: 1459})

Epoch :  36 loss training:  22.948732122778893 Time :  9539
accuracy train: 0.985440 val: 0.728358 test: 0.718279
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({0: 3237, 1: 2705, 2: 1458})

Epoch :  37 loss training:  22.970405273139477 Time :  9583
accuracy train: 0.988749 val: 0.722388 test: 0.714321
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({1: 3229, 2: 2712, 0: 1459})

Epoch :  38 loss training:  21.81574586033821 Time :  9640
accuracy train: 0.989080 val: 0.725373 test: 0.720010
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({2: 3218, 0: 2722, 1: 1460})

Epoch :  39 loss training:  21.458398394286633 Time :  9688
accuracy train: 0.989080 val: 0.743284 test: 0.721989
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({0: 3210, 2: 2733, 1: 1457})

Epoch :  40 loss training:  20.878595631569624 Time :  9744
accuracy train: 0.990735 val: 0.746269 test: 0.721494
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({1: 3216, 0: 2733, 2: 1451})

Epoch :  41 loss training:  20.12120036035776 Time :  9800
accuracy train: 0.992720 val: 0.722388 test: 0.718773
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({2: 3230, 0: 2721, 1: 1449})

Epoch :  42 loss training:  18.62701203301549 Time :  9860
accuracy train: 0.993713 val: 0.734328 test: 0.717042
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({1: 3227, 2: 2723, 0: 1450})

Epoch :  43 loss training:  17.731877226382494 Time :  9919
accuracy train: 0.993713 val: 0.737313 test: 0.719763
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({0: 3242, 2: 2715, 1: 1443})

Epoch :  44 loss training:  17.181346341967583 Time :  9964
accuracy train: 0.995367 val: 0.734328 test: 0.717784
max validation accuracy : 0.758209 max acc epoch : 13 test accuracy : 0.716052
Counter({2: 3251, 1: 2709, 0: 1440})

========================================================================================================================================================================================================
best acc epoch :  13
validation accuracy :  0.7582089552238805
test accuracy :  0.7160524363096711
last test_accuracy :  0.7177838238931487
second best val :  0.7522388059701492
second best test :  0.7160524363096711
max gap 2
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  31 	 val_accuracy : 0.75224 	 test_accuracy : 0.71853 	 last test_accuracy : 0.72001 	 second best val : 0.74627 	 second best test : 0.71853
k :  1 	 best_acc epoch :  37 	 val_accuracy : 0.74925 	 test_accuracy : 0.71877 	 last test_accuracy : 0.71952 	 second best val : 0.74627 	 second best test : 0.71754
k :  2 	 best_acc epoch :  31 	 val_accuracy : 0.74925 	 test_accuracy : 0.71976 	 last test_accuracy : 0.71976 	 second best val : 0.74627 	 second best test : 0.72001
k :  3 	 best_acc epoch :  13 	 val_accuracy : 0.75821 	 test_accuracy : 0.71605 	 last test_accuracy : 0.71778 	 second best val : 0.75224 	 second best test : 0.71605

avg :  	 val_accuracy : 0.75224 	 test_accuracy : 0.71828 	 last_accuracy : 0.71927 	 second best val : 0.74776 	 second best test : 0.71803

std :  	 val_accuracy : 0.00366 	 test_accuracy : 0.00137 	 last_accuracy : 0.00087 	 second best val : 0.00259 	 second best test : 0.00144
