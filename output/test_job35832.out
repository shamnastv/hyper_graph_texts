

date and time :  Mon Jun  7 00:14:52 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.005, num_Exp=5, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=476, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  101.54632723331451 Time :  17
accuracy train: 0.788215 val: 0.756338 test: 0.770400
max validation accuracy : 0.756338 max acc epoch : 1 test accuracy : 0.770400
Epoch-1 lr: 0.005

Epoch :  2 loss training:  87.0720252096653 Time :  36
accuracy train: 0.800406 val: 0.766197 test: 0.771244
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.771244
Epoch-2 lr: 0.005

Epoch :  3 loss training:  80.6652398109436 Time :  49
accuracy train: 0.795405 val: 0.750704 test: 0.756331
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.771244
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  78.66303715109825 Time :  60
accuracy train: 0.853861 val: 0.769014 test: 0.781373
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.781373
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  68.35863421857357 Time :  78
accuracy train: 0.845108 val: 0.747887 test: 0.767304
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.781373
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  64.02415814995766 Time :  93
accuracy train: 0.888403 val: 0.757746 test: 0.778278
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.781373
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  56.09248647093773 Time :  105
accuracy train: 0.907471 val: 0.771831 test: 0.777997
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  54.47325450927019 Time :  119
accuracy train: 0.865739 val: 0.759155 test: 0.758301
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  52.32557635009289 Time :  139
accuracy train: 0.924351 val: 0.759155 test: 0.780810
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  44.736193343997 Time :  150
accuracy train: 0.946077 val: 0.759155 test: 0.781936
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  43.3886301741004 Time :  166
accuracy train: 0.967021 val: 0.766197 test: 0.782499
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  34.943953804671764 Time :  183
accuracy train: 0.980775 val: 0.770423 test: 0.783343
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  25.195310685783625 Time :  202
accuracy train: 0.986715 val: 0.770423 test: 0.779685
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  22.683646008372307 Time :  214
accuracy train: 0.991560 val: 0.761972 test: 0.779122
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  20.32788734510541 Time :  226
accuracy train: 0.990622 val: 0.757746 test: 0.776027
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997

Epoch :  16 loss training:  16.25896211527288 Time :  242
accuracy train: 0.992654 val: 0.766197 test: 0.776871
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997

Epoch :  17 loss training:  14.557993832975626 Time :  255
accuracy train: 0.996561 val: 0.764789 test: 0.777997
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997

Epoch :  18 loss training:  13.283346204087138 Time :  267
accuracy train: 0.997343 val: 0.739437 test: 0.772369
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997

Epoch :  19 loss training:  11.855255376547575 Time :  281
accuracy train: 0.998750 val: 0.756338 test: 0.774057
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997

Epoch :  20 loss training:  10.77388244960457 Time :  297
accuracy train: 0.997656 val: 0.735211 test: 0.770962
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997

Epoch :  21 loss training:  8.623377908952534 Time :  308
accuracy train: 0.998750 val: 0.753521 test: 0.768430
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997

Epoch :  22 loss training:  7.335286826826632 Time :  321
accuracy train: 0.998906 val: 0.745070 test: 0.767586
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997

Epoch :  23 loss training:  7.404919530265033 Time :  336
accuracy train: 0.998906 val: 0.736620 test: 0.765898
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997

Epoch :  24 loss training:  6.1966528608463705 Time :  348
accuracy train: 0.999375 val: 0.745070 test: 0.768430
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997

Epoch :  25 loss training:  5.05381566635333 Time :  359
accuracy train: 0.999687 val: 0.739437 test: 0.761396
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997

Epoch :  26 loss training:  5.035311971325427 Time :  371
accuracy train: 0.999687 val: 0.753521 test: 0.763084
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997

Epoch :  27 loss training:  3.954223311273381 Time :  387
accuracy train: 0.999844 val: 0.749296 test: 0.758863
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997

Epoch :  28 loss training:  3.6502640864346176 Time :  402
accuracy train: 0.999844 val: 0.756338 test: 0.759989
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997

Epoch :  29 loss training:  3.44037277426105 Time :  419
accuracy train: 0.999844 val: 0.753521 test: 0.754080
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997

Epoch :  30 loss training:  2.864916740101762 Time :  435
accuracy train: 1.000000 val: 0.759155 test: 0.754080
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997

Epoch :  31 loss training:  3.2058608835795894 Time :  456
accuracy train: 0.999844 val: 0.742254 test: 0.757738
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997

Epoch :  32 loss training:  2.7481074649840593 Time :  481
accuracy train: 1.000000 val: 0.733803 test: 0.755768
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997

Epoch :  33 loss training:  2.3031194888753816 Time :  492
accuracy train: 1.000000 val: 0.742254 test: 0.752954
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997

Epoch :  34 loss training:  2.0270499212201685 Time :  503
accuracy train: 1.000000 val: 0.745070 test: 0.756894
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997

Epoch :  35 loss training:  2.2896231467602775 Time :  514
accuracy train: 1.000000 val: 0.749296 test: 0.756894
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997

Epoch :  36 loss training:  1.5699248942546546 Time :  526
accuracy train: 1.000000 val: 0.733803 test: 0.754924
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997

Epoch :  37 loss training:  1.6980906121898443 Time :  537
accuracy train: 1.000000 val: 0.736620 test: 0.752673
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997

Epoch :  38 loss training:  1.5547168508928735 Time :  550
accuracy train: 1.000000 val: 0.743662 test: 0.751829
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777997

========================================================================================================================================================================================================
max acc epoch :  7
max validation accuracy :  0.7718309859154929
test accuracy :  0.7779966235227912
last test_accuracy :  0.7518289251547552
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.005, num_Exp=5, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=476, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  103.4143216907978 Time :  563
accuracy train: 0.771022 val: 0.757746 test: 0.766460
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.766460
Epoch-1 lr: 0.005

Epoch :  2 loss training:  91.20507055521011 Time :  573
accuracy train: 0.641607 val: 0.621127 test: 0.628588
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.766460
Epoch-2 lr: 0.005

Epoch :  3 loss training:  87.88432398438454 Time :  583
accuracy train: 0.760394 val: 0.716901 test: 0.732414
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.766460
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  80.00675919651985 Time :  597
accuracy train: 0.801969 val: 0.776056 test: 0.763365
max validation accuracy : 0.776056 max acc epoch : 4 test accuracy : 0.763365
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  76.4560055732727 Time :  614
accuracy train: 0.803063 val: 0.750704 test: 0.765053
max validation accuracy : 0.776056 max acc epoch : 4 test accuracy : 0.763365
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  76.03542502224445 Time :  624
accuracy train: 0.837449 val: 0.795775 test: 0.770681
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  69.915362149477 Time :  634
accuracy train: 0.839168 val: 0.774648 test: 0.768149
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  67.55844010412693 Time :  645
accuracy train: 0.813223 val: 0.739437 test: 0.746483
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  66.81633895635605 Time :  658
accuracy train: 0.858237 val: 0.783099 test: 0.777153
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  61.79764047265053 Time :  674
accuracy train: 0.873554 val: 0.781690 test: 0.772088
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  60.86369524896145 Time :  685
accuracy train: 0.908253 val: 0.780282 test: 0.774620
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  51.43802732974291 Time :  698
accuracy train: 0.936386 val: 0.785915 test: 0.776027
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  39.74718724936247 Time :  713
accuracy train: 0.947640 val: 0.777465 test: 0.777434
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  35.32244956865907 Time :  725
accuracy train: 0.960300 val: 0.769014 test: 0.771806
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  32.14929696172476 Time :  737
accuracy train: 0.971241 val: 0.773239 test: 0.770962
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681

Epoch :  16 loss training:  27.53441283479333 Time :  750
accuracy train: 0.978431 val: 0.776056 test: 0.766742
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681

Epoch :  17 loss training:  24.130798555910587 Time :  761
accuracy train: 0.979056 val: 0.763380 test: 0.762802
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681

Epoch :  18 loss training:  20.893908163532615 Time :  780
accuracy train: 0.988434 val: 0.764789 test: 0.763365
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681

Epoch :  19 loss training:  18.358244482427835 Time :  793
accuracy train: 0.991716 val: 0.761972 test: 0.758863
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681

Epoch :  20 loss training:  15.898994915187359 Time :  805
accuracy train: 0.992810 val: 0.750704 test: 0.761396
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681

Epoch :  21 loss training:  14.21105084195733 Time :  815
accuracy train: 0.995155 val: 0.743662 test: 0.753517
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681

Epoch :  22 loss training:  11.789341025054455 Time :  827
accuracy train: 0.996249 val: 0.752113 test: 0.753236
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681

Epoch :  23 loss training:  11.215901312418282 Time :  839
accuracy train: 0.997343 val: 0.752113 test: 0.748171
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681

Epoch :  24 loss training:  9.917999133467674 Time :  851
accuracy train: 0.998124 val: 0.754930 test: 0.747327
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681

Epoch :  25 loss training:  8.7077701035887 Time :  862
accuracy train: 0.998281 val: 0.749296 test: 0.751548
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681

Epoch :  26 loss training:  6.938637613784522 Time :  872
accuracy train: 0.998437 val: 0.761972 test: 0.745639
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681

Epoch :  27 loss training:  6.55573347909376 Time :  884
accuracy train: 0.999062 val: 0.745070 test: 0.745076
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681

Epoch :  28 loss training:  5.974260134855285 Time :  898
accuracy train: 0.999062 val: 0.746479 test: 0.747608
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681

Epoch :  29 loss training:  5.239171949680895 Time :  909
accuracy train: 0.999531 val: 0.747887 test: 0.749015
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681

Epoch :  30 loss training:  4.452250980306417 Time :  920
accuracy train: 0.999687 val: 0.746479 test: 0.748734
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681

Epoch :  31 loss training:  4.052678199484944 Time :  932
accuracy train: 0.999844 val: 0.740845 test: 0.747890
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681

Epoch :  32 loss training:  3.8832326906267554 Time :  943
accuracy train: 1.000000 val: 0.747887 test: 0.744795
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681

Epoch :  33 loss training:  3.2581050188746303 Time :  959
accuracy train: 0.999844 val: 0.745070 test: 0.748452
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681

Epoch :  34 loss training:  2.966881675645709 Time :  970
accuracy train: 0.999844 val: 0.747887 test: 0.744513
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681

Epoch :  35 loss training:  2.3948548254556954 Time :  987
accuracy train: 0.999844 val: 0.740845 test: 0.747890
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681

Epoch :  36 loss training:  2.474072856712155 Time :  1007
accuracy train: 1.000000 val: 0.747887 test: 0.747608
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681

Epoch :  37 loss training:  2.3220281132962555 Time :  1020
accuracy train: 0.999844 val: 0.746479 test: 0.748734
max validation accuracy : 0.795775 max acc epoch : 6 test accuracy : 0.770681

========================================================================================================================================================================================================
max acc epoch :  6
max validation accuracy :  0.795774647887324
test accuracy :  0.7706809229037704
last test_accuracy :  0.7487338210467079
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.005, num_Exp=5, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=476, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  104.78026607632637 Time :  1036
accuracy train: 0.779462 val: 0.766197 test: 0.758301
max validation accuracy : 0.766197 max acc epoch : 1 test accuracy : 0.758301
Epoch-1 lr: 0.005

Epoch :  2 loss training:  92.61125403642654 Time :  1050
accuracy train: 0.785714 val: 0.767606 test: 0.773495
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.773495
Epoch-2 lr: 0.005

Epoch :  3 loss training:  85.68592196702957 Time :  1066
accuracy train: 0.707877 val: 0.687324 test: 0.694992
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.773495
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  80.67934149503708 Time :  1076
accuracy train: 0.817130 val: 0.776056 test: 0.774902
max validation accuracy : 0.776056 max acc epoch : 4 test accuracy : 0.774902
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  75.94109919667244 Time :  1087
accuracy train: 0.808847 val: 0.753521 test: 0.763928
max validation accuracy : 0.776056 max acc epoch : 4 test accuracy : 0.774902
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  74.33291864395142 Time :  1100
accuracy train: 0.842451 val: 0.778873 test: 0.770962
max validation accuracy : 0.778873 max acc epoch : 6 test accuracy : 0.770962
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  66.87938794493675 Time :  1114
accuracy train: 0.864802 val: 0.781690 test: 0.777715
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777715
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  65.51750330626965 Time :  1127
accuracy train: 0.842607 val: 0.776056 test: 0.771244
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777715
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  62.730890706181526 Time :  1139
accuracy train: 0.882932 val: 0.774648 test: 0.780248
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777715
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  59.53725877404213 Time :  1156
accuracy train: 0.894498 val: 0.785915 test: 0.776590
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  56.18375509977341 Time :  1170
accuracy train: 0.935917 val: 0.771831 test: 0.783905
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  45.19431834667921 Time :  1183
accuracy train: 0.959519 val: 0.769014 test: 0.779685
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  33.924851171672344 Time :  1195
accuracy train: 0.969053 val: 0.773239 test: 0.779403
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  28.627513993531466 Time :  1209
accuracy train: 0.976399 val: 0.771831 test: 0.773495
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  25.52136615663767 Time :  1223
accuracy train: 0.982182 val: 0.777465 test: 0.777997
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

Epoch :  16 loss training:  22.114445075392723 Time :  1234
accuracy train: 0.989528 val: 0.769014 test: 0.767867
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

Epoch :  17 loss training:  18.345662739127874 Time :  1248
accuracy train: 0.992967 val: 0.763380 test: 0.766460
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

Epoch :  18 loss training:  15.42074273712933 Time :  1279
accuracy train: 0.996561 val: 0.750704 test: 0.765616
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

Epoch :  19 loss training:  13.07936855405569 Time :  1298
accuracy train: 0.997030 val: 0.756338 test: 0.761958
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

Epoch :  20 loss training:  11.229180560447276 Time :  1309
accuracy train: 0.997499 val: 0.753521 test: 0.754361
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

Epoch :  21 loss training:  9.323582184500992 Time :  1323
accuracy train: 0.999219 val: 0.760563 test: 0.751829
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

Epoch :  22 loss training:  7.9705128339119256 Time :  1338
accuracy train: 0.999375 val: 0.753521 test: 0.748452
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

Epoch :  23 loss training:  7.886612444650382 Time :  1350
accuracy train: 0.998906 val: 0.750704 test: 0.751266
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

Epoch :  24 loss training:  6.498928093351424 Time :  1362
accuracy train: 0.999375 val: 0.760563 test: 0.751829
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

Epoch :  25 loss training:  5.520020604599267 Time :  1377
accuracy train: 0.999219 val: 0.750704 test: 0.749297
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

Epoch :  26 loss training:  4.6775116715580225 Time :  1394
accuracy train: 0.999844 val: 0.754930 test: 0.748452
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

Epoch :  27 loss training:  4.531810886459425 Time :  1405
accuracy train: 0.999531 val: 0.754930 test: 0.747890
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

Epoch :  28 loss training:  3.864342416636646 Time :  1417
accuracy train: 0.999375 val: 0.750704 test: 0.749297
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

Epoch :  29 loss training:  4.030323000624776 Time :  1432
accuracy train: 0.999844 val: 0.747887 test: 0.748452
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

Epoch :  30 loss training:  3.146518123918213 Time :  1450
accuracy train: 0.999687 val: 0.750704 test: 0.745639
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

Epoch :  31 loss training:  3.0342902309494093 Time :  1460
accuracy train: 0.999844 val: 0.753521 test: 0.749578
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

Epoch :  32 loss training:  2.6154128939961083 Time :  1472
accuracy train: 1.000000 val: 0.753521 test: 0.749015
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

Epoch :  33 loss training:  2.077031706168782 Time :  1487
accuracy train: 0.999844 val: 0.749296 test: 0.749578
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

Epoch :  34 loss training:  1.8614387302077375 Time :  1500
accuracy train: 1.000000 val: 0.742254 test: 0.748171
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

Epoch :  35 loss training:  1.7988293200614862 Time :  1511
accuracy train: 1.000000 val: 0.746479 test: 0.746483
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

Epoch :  36 loss training:  1.7349061506101862 Time :  1523
accuracy train: 1.000000 val: 0.746479 test: 0.747890
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

Epoch :  37 loss training:  2.2491697134973947 Time :  1541
accuracy train: 0.995936 val: 0.753521 test: 0.740293
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

Epoch :  38 loss training:  1.2340454232762568 Time :  1566
accuracy train: 0.999062 val: 0.745070 test: 0.745639
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

Epoch :  39 loss training:  2.081852707226062 Time :  1581
accuracy train: 0.999375 val: 0.745070 test: 0.736916
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

Epoch :  40 loss training:  1.583439189067576 Time :  1597
accuracy train: 1.000000 val: 0.747887 test: 0.742544
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

Epoch :  41 loss training:  1.5228522350516869 Time :  1611
accuracy train: 1.000000 val: 0.743662 test: 0.741981
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.776590

========================================================================================================================================================================================================
max acc epoch :  10
max validation accuracy :  0.7859154929577464
test accuracy :  0.7765897580191333
last test_accuracy :  0.7419808666291503
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.005, num_Exp=5, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=476, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  100.94895735383034 Time :  1626
accuracy train: 0.765708 val: 0.746479 test: 0.750703
max validation accuracy : 0.746479 max acc epoch : 1 test accuracy : 0.750703
Epoch-1 lr: 0.005

Epoch :  2 loss training:  97.31445503234863 Time :  1640
accuracy train: 0.766021 val: 0.749296 test: 0.737479
max validation accuracy : 0.749296 max acc epoch : 2 test accuracy : 0.737479
Epoch-2 lr: 0.005

Epoch :  3 loss training:  97.50483083724976 Time :  1654
accuracy train: 0.752423 val: 0.719718 test: 0.735791
max validation accuracy : 0.749296 max acc epoch : 2 test accuracy : 0.737479
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  83.20073196291924 Time :  1665
accuracy train: 0.809003 val: 0.774648 test: 0.773776
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.773776
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  79.57855406403542 Time :  1675
accuracy train: 0.807127 val: 0.770423 test: 0.773213
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.773776
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  78.7559412419796 Time :  1687
accuracy train: 0.833698 val: 0.774648 test: 0.772932
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.773776
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  72.96110025048256 Time :  1700
accuracy train: 0.808847 val: 0.745070 test: 0.753517
max validation accuracy : 0.774648 max acc epoch : 4 test accuracy : 0.773776
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  72.33200618624687 Time :  1715
accuracy train: 0.838074 val: 0.781690 test: 0.775183
max validation accuracy : 0.781690 max acc epoch : 8 test accuracy : 0.775183
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  71.4744508266449 Time :  1726
accuracy train: 0.848703 val: 0.785915 test: 0.776871
max validation accuracy : 0.785915 max acc epoch : 9 test accuracy : 0.776871
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  66.67486542463303 Time :  1737
accuracy train: 0.862457 val: 0.795775 test: 0.777997
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  66.28752893209457 Time :  1752
accuracy train: 0.898718 val: 0.792958 test: 0.779966
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  55.72768983244896 Time :  1774
accuracy train: 0.927477 val: 0.781690 test: 0.777715
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  45.64426890015602 Time :  1784
accuracy train: 0.939981 val: 0.788732 test: 0.780529
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  39.89624375849962 Time :  1795
accuracy train: 0.949984 val: 0.785915 test: 0.777153
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  36.32163452357054 Time :  1808
accuracy train: 0.960769 val: 0.767606 test: 0.776308
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

Epoch :  16 loss training:  32.84625877439976 Time :  1828
accuracy train: 0.967334 val: 0.771831 test: 0.774057
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

Epoch :  17 loss training:  28.427092134952545 Time :  1843
accuracy train: 0.971397 val: 0.769014 test: 0.772932
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

Epoch :  18 loss training:  25.273096300661564 Time :  1855
accuracy train: 0.980619 val: 0.763380 test: 0.772088
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

Epoch :  19 loss training:  21.575422197580338 Time :  1872
accuracy train: 0.986402 val: 0.757746 test: 0.760551
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

Epoch :  20 loss training:  19.724816095083952 Time :  1886
accuracy train: 0.985152 val: 0.750704 test: 0.766742
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

Epoch :  21 loss training:  16.846362525597215 Time :  1896
accuracy train: 0.992654 val: 0.760563 test: 0.759145
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

Epoch :  22 loss training:  14.800072968006134 Time :  1907
accuracy train: 0.994998 val: 0.759155 test: 0.756894
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

Epoch :  23 loss training:  14.008154931478202 Time :  1922
accuracy train: 0.996405 val: 0.750704 test: 0.759707
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

Epoch :  24 loss training:  11.879524893127382 Time :  1937
accuracy train: 0.997187 val: 0.754930 test: 0.757175
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

Epoch :  25 loss training:  10.704478684812784 Time :  1948
accuracy train: 0.997656 val: 0.754930 test: 0.753517
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

Epoch :  26 loss training:  8.262546851299703 Time :  1960
accuracy train: 0.998750 val: 0.750704 test: 0.747327
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

Epoch :  27 loss training:  7.561327513540164 Time :  1974
accuracy train: 0.998906 val: 0.750704 test: 0.748734
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

Epoch :  28 loss training:  6.742239142302424 Time :  1987
accuracy train: 0.999062 val: 0.743662 test: 0.743669
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

Epoch :  29 loss training:  6.0247131627984345 Time :  1997
accuracy train: 0.999375 val: 0.739437 test: 0.746483
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

Epoch :  30 loss training:  5.467478279955685 Time :  2011
accuracy train: 0.999219 val: 0.746479 test: 0.746483
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

Epoch :  31 loss training:  5.051507784053683 Time :  2028
accuracy train: 0.999375 val: 0.749296 test: 0.745920
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

Epoch :  32 loss training:  4.611978612840176 Time :  2044
accuracy train: 0.999531 val: 0.745070 test: 0.747608
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

Epoch :  33 loss training:  4.054996636114083 Time :  2054
accuracy train: 0.999687 val: 0.747887 test: 0.742544
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

Epoch :  34 loss training:  3.5131956349359825 Time :  2065
accuracy train: 0.999687 val: 0.745070 test: 0.742825
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

Epoch :  35 loss training:  3.6000993724446744 Time :  2082
accuracy train: 0.999844 val: 0.746479 test: 0.745639
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

Epoch :  36 loss training:  2.7386045493767597 Time :  2110
accuracy train: 0.999844 val: 0.736620 test: 0.742262
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

Epoch :  37 loss training:  2.422088705992792 Time :  2123
accuracy train: 1.000000 val: 0.739437 test: 0.743388
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

Epoch :  38 loss training:  2.3227073131129146 Time :  2135
accuracy train: 0.999844 val: 0.742254 test: 0.746201
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

Epoch :  39 loss training:  2.160701923072338 Time :  2150
accuracy train: 0.999844 val: 0.728169 test: 0.744795
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

Epoch :  40 loss training:  2.0440122832078487 Time :  2162
accuracy train: 1.000000 val: 0.739437 test: 0.744795
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

Epoch :  41 loss training:  1.8888876588316634 Time :  2174
accuracy train: 1.000000 val: 0.736620 test: 0.745076
max validation accuracy : 0.795775 max acc epoch : 10 test accuracy : 0.777997

========================================================================================================================================================================================================
max acc epoch :  10
max validation accuracy :  0.795774647887324
test accuracy :  0.7779966235227912
last test_accuracy :  0.7450759707371976
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.005, num_Exp=5, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=476, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  102.4988212287426 Time :  2197
accuracy train: 0.784151 val: 0.752113 test: 0.761396
max validation accuracy : 0.752113 max acc epoch : 1 test accuracy : 0.761396
Epoch-1 lr: 0.005

Epoch :  2 loss training:  90.59604349732399 Time :  2210
accuracy train: 0.790716 val: 0.757746 test: 0.771806
max validation accuracy : 0.757746 max acc epoch : 2 test accuracy : 0.771806
Epoch-2 lr: 0.005

Epoch :  3 loss training:  84.80130061507225 Time :  2224
accuracy train: 0.686308 val: 0.669014 test: 0.671356
max validation accuracy : 0.757746 max acc epoch : 2 test accuracy : 0.771806
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  78.06323581933975 Time :  2235
accuracy train: 0.836668 val: 0.761972 test: 0.772651
max validation accuracy : 0.761972 max acc epoch : 4 test accuracy : 0.772651
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  71.61793312430382 Time :  2246
accuracy train: 0.830728 val: 0.749296 test: 0.764491
max validation accuracy : 0.761972 max acc epoch : 4 test accuracy : 0.772651
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  70.38841699063778 Time :  2261
accuracy train: 0.862770 val: 0.788732 test: 0.777434
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  62.915412530303 Time :  2273
accuracy train: 0.854955 val: 0.757746 test: 0.763647
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  60.760199919342995 Time :  2286
accuracy train: 0.861050 val: 0.761972 test: 0.759426
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  58.62433525919914 Time :  2298
accuracy train: 0.904345 val: 0.776056 test: 0.772088
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  52.67382371425629 Time :  2316
accuracy train: 0.913567 val: 0.773239 test: 0.769555
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434
Epoch-10 lr: 0.000625

Epoch :  11 loss training:  51.88955146819353 Time :  2331
accuracy train: 0.941388 val: 0.778873 test: 0.774057
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434
Epoch-11 lr: 0.000625

Epoch :  12 loss training:  42.53309740871191 Time :  2342
accuracy train: 0.961550 val: 0.780282 test: 0.780248
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434
Epoch-12 lr: 0.0003125

Epoch :  13 loss training:  31.25631708651781 Time :  2355
accuracy train: 0.973273 val: 0.770423 test: 0.773776
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434
Epoch-13 lr: 0.0003125

Epoch :  14 loss training:  27.167438112199306 Time :  2367
accuracy train: 0.978587 val: 0.767606 test: 0.776308
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434
Epoch-14 lr: 0.0003125

Epoch :  15 loss training:  24.52200522646308 Time :  2381
accuracy train: 0.984526 val: 0.766197 test: 0.768430
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434

Epoch :  16 loss training:  20.86283017322421 Time :  2394
accuracy train: 0.989528 val: 0.761972 test: 0.770118
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434

Epoch :  17 loss training:  17.999868527054787 Time :  2411
accuracy train: 0.991716 val: 0.764789 test: 0.766460
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434

Epoch :  18 loss training:  14.789924183860421 Time :  2423
accuracy train: 0.995155 val: 0.756338 test: 0.764772
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434

Epoch :  19 loss training:  13.704072212800384 Time :  2436
accuracy train: 0.996249 val: 0.752113 test: 0.761396
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434

Epoch :  20 loss training:  11.192068224772811 Time :  2453
accuracy train: 0.997812 val: 0.754930 test: 0.759426
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434

Epoch :  21 loss training:  9.72398379445076 Time :  2466
accuracy train: 0.998593 val: 0.752113 test: 0.755205
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434

Epoch :  22 loss training:  8.726024622097611 Time :  2484
accuracy train: 0.998750 val: 0.763380 test: 0.753236
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434

Epoch :  23 loss training:  8.302128170616925 Time :  2497
accuracy train: 0.999219 val: 0.761972 test: 0.756894
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434

Epoch :  24 loss training:  7.223377156071365 Time :  2519
accuracy train: 0.999375 val: 0.760563 test: 0.753517
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434

Epoch :  25 loss training:  6.214920127764344 Time :  2538
accuracy train: 0.998906 val: 0.759155 test: 0.748171
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434

Epoch :  26 loss training:  5.198686260264367 Time :  2552
accuracy train: 0.999375 val: 0.761972 test: 0.754643
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434

Epoch :  27 loss training:  4.966364634921774 Time :  2566
accuracy train: 0.999375 val: 0.753521 test: 0.753799
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434

Epoch :  28 loss training:  4.506532611325383 Time :  2581
accuracy train: 0.999844 val: 0.759155 test: 0.758301
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434

Epoch :  29 loss training:  3.886007810011506 Time :  2595
accuracy train: 1.000000 val: 0.760563 test: 0.753236
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434

Epoch :  30 loss training:  3.23966264387127 Time :  2611
accuracy train: 0.999687 val: 0.760563 test: 0.753236
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434

Epoch :  31 loss training:  3.438987410336267 Time :  2625
accuracy train: 0.999844 val: 0.767606 test: 0.752954
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434

Epoch :  32 loss training:  2.9920454415259883 Time :  2638
accuracy train: 0.999844 val: 0.757746 test: 0.749578
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434

Epoch :  33 loss training:  2.6982094718841836 Time :  2658
accuracy train: 1.000000 val: 0.764789 test: 0.749297
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434

Epoch :  34 loss training:  2.5001742424210533 Time :  2672
accuracy train: 1.000000 val: 0.753521 test: 0.748171
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434

Epoch :  35 loss training:  2.3872542163007893 Time :  2686
accuracy train: 1.000000 val: 0.756338 test: 0.750985
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434

Epoch :  36 loss training:  1.9976905103540048 Time :  2700
accuracy train: 1.000000 val: 0.752113 test: 0.746764
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434

Epoch :  37 loss training:  1.7957426006905735 Time :  2719
accuracy train: 1.000000 val: 0.757746 test: 0.754361
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.777434

========================================================================================================================================================================================================
max acc epoch :  6
max validation accuracy :  0.7887323943661971
test accuracy :  0.7774338773213281
last test_accuracy :  0.7543612830613393
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.77183 	 test_accuracy : 0.77800 	 max_acc epoch :  7 	 last test_accuracy : 0.75183
k :  1 	 val_accuracy : 0.79577 	 test_accuracy : 0.77068 	 max_acc epoch :  6 	 last test_accuracy : 0.74873
k :  2 	 val_accuracy : 0.78592 	 test_accuracy : 0.77659 	 max_acc epoch :  10 	 last test_accuracy : 0.74198
k :  3 	 val_accuracy : 0.79577 	 test_accuracy : 0.77800 	 max_acc epoch :  10 	 last test_accuracy : 0.74508
k :  4 	 val_accuracy : 0.78873 	 test_accuracy : 0.77743 	 max_acc epoch :  6 	 last test_accuracy : 0.75436

avg :  	 val_accuracy : 0.78761 	 test_accuracy : 0.77614 	 last_accuracy : 0.74840


date and time :  Mon Jun  7 01:00:21 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_Exp=5, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=956, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.05473840236664 Time :  17
accuracy train: 0.783839 val: 0.761972 test: 0.765898
max validation accuracy : 0.761972 max acc epoch : 1 test accuracy : 0.765898
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.22764724493027 Time :  28
accuracy train: 0.779306 val: 0.750704 test: 0.764491
max validation accuracy : 0.761972 max acc epoch : 1 test accuracy : 0.765898
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.7800347507 Time :  38
accuracy train: 0.806189 val: 0.766197 test: 0.775183
max validation accuracy : 0.766197 max acc epoch : 3 test accuracy : 0.775183
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  74.48942609131336 Time :  48
accuracy train: 0.811191 val: 0.766197 test: 0.778559
max validation accuracy : 0.766197 max acc epoch : 3 test accuracy : 0.775183
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  74.33742472529411 Time :  60
accuracy train: 0.825883 val: 0.770423 test: 0.775746
max validation accuracy : 0.770423 max acc epoch : 5 test accuracy : 0.775746
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.57171553373337 Time :  75
accuracy train: 0.832760 val: 0.757746 test: 0.772088
max validation accuracy : 0.770423 max acc epoch : 5 test accuracy : 0.775746
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  68.91352370381355 Time :  86
accuracy train: 0.838387 val: 0.766197 test: 0.772932
max validation accuracy : 0.770423 max acc epoch : 5 test accuracy : 0.775746
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.55494007468224 Time :  99
accuracy train: 0.838700 val: 0.770423 test: 0.772932
max validation accuracy : 0.770423 max acc epoch : 5 test accuracy : 0.775746
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  66.52026687562466 Time :  111
accuracy train: 0.851829 val: 0.760563 test: 0.772088
max validation accuracy : 0.770423 max acc epoch : 5 test accuracy : 0.775746
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  66.18100447952747 Time :  122
accuracy train: 0.853235 val: 0.778873 test: 0.773495
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.773495
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  65.05912484228611 Time :  132
accuracy train: 0.858862 val: 0.771831 test: 0.774620
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.773495
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.61519956588745 Time :  143
accuracy train: 0.862144 val: 0.771831 test: 0.775746
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.773495
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  62.2243478000164 Time :  156
accuracy train: 0.870428 val: 0.770423 test: 0.771525
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.773495
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  62.16692864894867 Time :  167
accuracy train: 0.875742 val: 0.773239 test: 0.774057
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.773495
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  58.9766416400671 Time :  179
accuracy train: 0.879650 val: 0.778873 test: 0.774620
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.773495

Epoch :  16 loss training:  59.93590135872364 Time :  190
accuracy train: 0.878712 val: 0.774648 test: 0.776308
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.773495

Epoch :  17 loss training:  58.56855085492134 Time :  203
accuracy train: 0.886527 val: 0.776056 test: 0.775746
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.773495

Epoch :  18 loss training:  58.21496684849262 Time :  218
accuracy train: 0.888872 val: 0.771831 test: 0.768149
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.773495

Epoch :  19 loss training:  56.70628024637699 Time :  230
accuracy train: 0.891997 val: 0.774648 test: 0.776027
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.773495

Epoch :  20 loss training:  55.647778913378716 Time :  242
accuracy train: 0.897781 val: 0.771831 test: 0.778278
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.773495

Epoch :  21 loss training:  55.7854665517807 Time :  253
accuracy train: 0.900750 val: 0.777465 test: 0.772369
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.773495

Epoch :  22 loss training:  55.34058307111263 Time :  266
accuracy train: 0.903876 val: 0.767606 test: 0.774620
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.773495

Epoch :  23 loss training:  53.18855492770672 Time :  278
accuracy train: 0.910597 val: 0.776056 test: 0.776590
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.773495

Epoch :  24 loss training:  52.75370606780052 Time :  297
accuracy train: 0.910441 val: 0.764789 test: 0.774339
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.773495

Epoch :  25 loss training:  53.00570785999298 Time :  307
accuracy train: 0.916224 val: 0.760563 test: 0.770118
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.773495

Epoch :  26 loss training:  50.83293527364731 Time :  318
accuracy train: 0.913098 val: 0.778873 test: 0.770400
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.773495

Epoch :  27 loss training:  50.719281777739525 Time :  329
accuracy train: 0.917474 val: 0.778873 test: 0.774339
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.773495

Epoch :  28 loss training:  49.46352341026068 Time :  341
accuracy train: 0.923570 val: 0.773239 test: 0.770962
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.773495

Epoch :  29 loss training:  48.0922637283802 Time :  356
accuracy train: 0.925289 val: 0.769014 test: 0.772369
max validation accuracy : 0.778873 max acc epoch : 10 test accuracy : 0.773495

Epoch :  30 loss training:  48.08461718261242 Time :  368
accuracy train: 0.929978 val: 0.780282 test: 0.770400
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  31 loss training:  47.488794073462486 Time :  379
accuracy train: 0.926071 val: 0.773239 test: 0.768711
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  32 loss training:  45.69264183938503 Time :  392
accuracy train: 0.934042 val: 0.773239 test: 0.770962
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  33 loss training:  45.594575107097626 Time :  405
accuracy train: 0.938575 val: 0.773239 test: 0.769837
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  34 loss training:  45.71049763262272 Time :  422
accuracy train: 0.940294 val: 0.771831 test: 0.771525
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  35 loss training:  43.70198126882315 Time :  434
accuracy train: 0.942169 val: 0.774648 test: 0.769837
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  36 loss training:  43.16277173161507 Time :  446
accuracy train: 0.944045 val: 0.773239 test: 0.769555
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  37 loss training:  41.564591854810715 Time :  457
accuracy train: 0.948578 val: 0.764789 test: 0.770962
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  38 loss training:  41.515664473176 Time :  467
accuracy train: 0.952485 val: 0.771831 test: 0.771525
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  39 loss training:  41.46062646061182 Time :  478
accuracy train: 0.952016 val: 0.766197 test: 0.770400
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  40 loss training:  39.34795594215393 Time :  490
accuracy train: 0.957174 val: 0.767606 test: 0.766742
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  41 loss training:  38.82258819043636 Time :  501
accuracy train: 0.957330 val: 0.766197 test: 0.770962
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  42 loss training:  38.00917921960354 Time :  511
accuracy train: 0.958581 val: 0.759155 test: 0.764491
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  43 loss training:  37.9665437117219 Time :  523
accuracy train: 0.960300 val: 0.759155 test: 0.767867
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  44 loss training:  36.62090338021517 Time :  534
accuracy train: 0.960300 val: 0.761972 test: 0.769274
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  45 loss training:  36.29927463084459 Time :  546
accuracy train: 0.963270 val: 0.761972 test: 0.769837
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  46 loss training:  35.19011292234063 Time :  557
accuracy train: 0.967021 val: 0.760563 test: 0.768993
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  47 loss training:  34.67543691396713 Time :  568
accuracy train: 0.966552 val: 0.763380 test: 0.770962
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  48 loss training:  33.93436202406883 Time :  579
accuracy train: 0.969365 val: 0.746479 test: 0.768711
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  49 loss training:  33.37905301898718 Time :  589
accuracy train: 0.966239 val: 0.769014 test: 0.770962
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  50 loss training:  32.73064872249961 Time :  601
accuracy train: 0.972023 val: 0.757746 test: 0.770118
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  51 loss training:  32.26934051513672 Time :  620
accuracy train: 0.972023 val: 0.766197 test: 0.770400
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  52 loss training:  32.127561554312706 Time :  630
accuracy train: 0.975930 val: 0.763380 test: 0.766179
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  53 loss training:  31.12688895314932 Time :  644
accuracy train: 0.975461 val: 0.763380 test: 0.770962
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  54 loss training:  30.505311489105225 Time :  654
accuracy train: 0.978431 val: 0.759155 test: 0.767304
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  55 loss training:  29.166962880641222 Time :  664
accuracy train: 0.978743 val: 0.767606 test: 0.770681
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  56 loss training:  29.06806328892708 Time :  675
accuracy train: 0.978587 val: 0.759155 test: 0.767867
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  57 loss training:  28.18061450868845 Time :  688
accuracy train: 0.982182 val: 0.764789 test: 0.763647
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  58 loss training:  28.34283074364066 Time :  702
accuracy train: 0.982338 val: 0.760563 test: 0.768430
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  59 loss training:  27.93927861750126 Time :  713
accuracy train: 0.985621 val: 0.757746 test: 0.772088
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  60 loss training:  25.628338657319546 Time :  726
accuracy train: 0.984526 val: 0.763380 test: 0.763647
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

Epoch :  61 loss training:  26.68591073527932 Time :  737
accuracy train: 0.986402 val: 0.759155 test: 0.770118
max validation accuracy : 0.780282 max acc epoch : 30 test accuracy : 0.770400

========================================================================================================================================================================================================
max acc epoch :  30
max validation accuracy :  0.780281690140845
test accuracy :  0.7703995498030388
last test_accuracy :  0.7701181767023073
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_Exp=5, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=956, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.06457221508026 Time :  751
accuracy train: 0.784308 val: 0.760563 test: 0.765616
max validation accuracy : 0.760563 max acc epoch : 1 test accuracy : 0.765616
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.26642325520515 Time :  762
accuracy train: 0.780556 val: 0.753521 test: 0.765053
max validation accuracy : 0.760563 max acc epoch : 1 test accuracy : 0.765616
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.87312313914299 Time :  774
accuracy train: 0.807440 val: 0.774648 test: 0.779122
max validation accuracy : 0.774648 max acc epoch : 3 test accuracy : 0.779122
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  74.66226351261139 Time :  785
accuracy train: 0.811660 val: 0.764789 test: 0.780529
max validation accuracy : 0.774648 max acc epoch : 3 test accuracy : 0.779122
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  74.22315186262131 Time :  798
accuracy train: 0.824633 val: 0.763380 test: 0.772932
max validation accuracy : 0.774648 max acc epoch : 3 test accuracy : 0.779122
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.56719723343849 Time :  812
accuracy train: 0.830259 val: 0.760563 test: 0.771244
max validation accuracy : 0.774648 max acc epoch : 3 test accuracy : 0.779122
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.04408776760101 Time :  830
accuracy train: 0.839168 val: 0.763380 test: 0.773495
max validation accuracy : 0.774648 max acc epoch : 3 test accuracy : 0.779122
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.57264043390751 Time :  841
accuracy train: 0.840419 val: 0.770423 test: 0.773776
max validation accuracy : 0.774648 max acc epoch : 3 test accuracy : 0.779122
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  66.54920928180218 Time :  854
accuracy train: 0.852141 val: 0.761972 test: 0.773776
max validation accuracy : 0.774648 max acc epoch : 3 test accuracy : 0.779122
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  66.25043922662735 Time :  864
accuracy train: 0.848859 val: 0.776056 test: 0.770962
max validation accuracy : 0.776056 max acc epoch : 10 test accuracy : 0.770962
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  64.7991641163826 Time :  876
accuracy train: 0.859644 val: 0.770423 test: 0.773213
max validation accuracy : 0.776056 max acc epoch : 10 test accuracy : 0.770962
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.31861644983292 Time :  886
accuracy train: 0.866052 val: 0.760563 test: 0.775183
max validation accuracy : 0.776056 max acc epoch : 10 test accuracy : 0.770962
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  62.383271619677544 Time :  898
accuracy train: 0.872616 val: 0.766197 test: 0.773776
max validation accuracy : 0.776056 max acc epoch : 10 test accuracy : 0.770962
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  62.101843789219856 Time :  909
accuracy train: 0.875742 val: 0.766197 test: 0.774620
max validation accuracy : 0.776056 max acc epoch : 10 test accuracy : 0.770962
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  59.05936327576637 Time :  922
accuracy train: 0.881213 val: 0.766197 test: 0.771525
max validation accuracy : 0.776056 max acc epoch : 10 test accuracy : 0.770962

Epoch :  16 loss training:  59.61752286553383 Time :  935
accuracy train: 0.881057 val: 0.774648 test: 0.774057
max validation accuracy : 0.776056 max acc epoch : 10 test accuracy : 0.770962

Epoch :  17 loss training:  58.07324197888374 Time :  944
accuracy train: 0.887934 val: 0.767606 test: 0.777715
max validation accuracy : 0.776056 max acc epoch : 10 test accuracy : 0.770962

Epoch :  18 loss training:  57.78598755598068 Time :  956
accuracy train: 0.893404 val: 0.771831 test: 0.773776
max validation accuracy : 0.776056 max acc epoch : 10 test accuracy : 0.770962

Epoch :  19 loss training:  56.46786794066429 Time :  967
accuracy train: 0.895905 val: 0.770423 test: 0.773495
max validation accuracy : 0.776056 max acc epoch : 10 test accuracy : 0.770962

Epoch :  20 loss training:  55.30956944823265 Time :  980
accuracy train: 0.897781 val: 0.769014 test: 0.777997
max validation accuracy : 0.776056 max acc epoch : 10 test accuracy : 0.770962

Epoch :  21 loss training:  55.81439346075058 Time :  993
accuracy train: 0.901688 val: 0.778873 test: 0.769274
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  22 loss training:  54.852486819028854 Time :  1005
accuracy train: 0.906690 val: 0.769014 test: 0.768993
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  23 loss training:  52.82451221346855 Time :  1014
accuracy train: 0.912629 val: 0.767606 test: 0.773776
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  24 loss training:  52.40698891878128 Time :  1027
accuracy train: 0.911691 val: 0.764789 test: 0.771244
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  25 loss training:  52.80667853355408 Time :  1036
accuracy train: 0.916224 val: 0.763380 test: 0.769274
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  26 loss training:  50.84999957680702 Time :  1047
accuracy train: 0.915130 val: 0.770423 test: 0.772088
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  27 loss training:  50.38974395394325 Time :  1059
accuracy train: 0.922476 val: 0.770423 test: 0.771806
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  28 loss training:  49.12857845425606 Time :  1069
accuracy train: 0.927477 val: 0.764789 test: 0.771525
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  29 loss training:  48.420975759625435 Time :  1079
accuracy train: 0.926540 val: 0.773239 test: 0.772088
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  30 loss training:  47.92198584228754 Time :  1090
accuracy train: 0.930760 val: 0.766197 test: 0.770118
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  31 loss training:  47.37279957532883 Time :  1101
accuracy train: 0.928728 val: 0.769014 test: 0.770962
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  32 loss training:  45.45009060949087 Time :  1114
accuracy train: 0.935136 val: 0.769014 test: 0.768149
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  33 loss training:  45.30344815552235 Time :  1128
accuracy train: 0.939356 val: 0.766197 test: 0.766742
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  34 loss training:  45.59479158371687 Time :  1141
accuracy train: 0.941232 val: 0.770423 test: 0.769555
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  35 loss training:  43.91548453271389 Time :  1153
accuracy train: 0.940450 val: 0.767606 test: 0.769837
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  36 loss training:  42.8316814750433 Time :  1163
accuracy train: 0.945764 val: 0.764789 test: 0.769837
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  37 loss training:  41.481416299939156 Time :  1173
accuracy train: 0.949359 val: 0.759155 test: 0.770118
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  38 loss training:  41.304650731384754 Time :  1185
accuracy train: 0.952954 val: 0.771831 test: 0.768149
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  39 loss training:  41.15697129815817 Time :  1195
accuracy train: 0.953423 val: 0.757746 test: 0.770118
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  40 loss training:  38.60847369581461 Time :  1204
accuracy train: 0.957643 val: 0.764789 test: 0.770400
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  41 loss training:  38.206154987215996 Time :  1216
accuracy train: 0.959362 val: 0.766197 test: 0.771806
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  42 loss training:  37.56805606931448 Time :  1226
accuracy train: 0.960769 val: 0.753521 test: 0.766742
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  43 loss training:  37.57797688245773 Time :  1239
accuracy train: 0.962176 val: 0.753521 test: 0.770118
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  44 loss training:  36.52549973130226 Time :  1249
accuracy train: 0.962332 val: 0.760563 test: 0.767023
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  45 loss training:  36.158618591725826 Time :  1259
accuracy train: 0.965302 val: 0.763380 test: 0.768430
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  46 loss training:  35.087465554475784 Time :  1270
accuracy train: 0.968584 val: 0.754930 test: 0.771806
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  47 loss training:  34.78739254921675 Time :  1286
accuracy train: 0.967802 val: 0.754930 test: 0.765898
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  48 loss training:  33.53100308775902 Time :  1296
accuracy train: 0.970303 val: 0.760563 test: 0.771244
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  49 loss training:  32.82443717122078 Time :  1307
accuracy train: 0.969991 val: 0.759155 test: 0.768711
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  50 loss training:  32.48077629879117 Time :  1319
accuracy train: 0.973898 val: 0.747887 test: 0.766742
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  51 loss training:  32.14446946233511 Time :  1328
accuracy train: 0.974836 val: 0.763380 test: 0.771525
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

Epoch :  52 loss training:  32.03199456632137 Time :  1344
accuracy train: 0.977962 val: 0.759155 test: 0.766460
max validation accuracy : 0.778873 max acc epoch : 21 test accuracy : 0.769274

========================================================================================================================================================================================================
max acc epoch :  21
max validation accuracy :  0.7788732394366197
test accuracy :  0.7692740574001126
last test_accuracy :  0.7664603263927968
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_Exp=5, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=956, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.05700945854187 Time :  1355
accuracy train: 0.784620 val: 0.757746 test: 0.766179
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.766179
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.33193576335907 Time :  1366
accuracy train: 0.783057 val: 0.747887 test: 0.768149
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.766179
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.8271249383688 Time :  1379
accuracy train: 0.809784 val: 0.770423 test: 0.776590
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.776590
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  74.5760428160429 Time :  1388
accuracy train: 0.811972 val: 0.763380 test: 0.778559
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.776590
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  74.33140003681183 Time :  1400
accuracy train: 0.826039 val: 0.771831 test: 0.780529
max validation accuracy : 0.771831 max acc epoch : 5 test accuracy : 0.780529
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.55181896686554 Time :  1411
accuracy train: 0.831822 val: 0.764789 test: 0.771244
max validation accuracy : 0.771831 max acc epoch : 5 test accuracy : 0.780529
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  68.89547738432884 Time :  1423
accuracy train: 0.840731 val: 0.767606 test: 0.774057
max validation accuracy : 0.771831 max acc epoch : 5 test accuracy : 0.780529
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.51651857793331 Time :  1438
accuracy train: 0.839481 val: 0.769014 test: 0.775746
max validation accuracy : 0.771831 max acc epoch : 5 test accuracy : 0.780529
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  66.4991395175457 Time :  1449
accuracy train: 0.852766 val: 0.763380 test: 0.774057
max validation accuracy : 0.771831 max acc epoch : 5 test accuracy : 0.780529
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  66.17521035671234 Time :  1460
accuracy train: 0.851829 val: 0.773239 test: 0.776871
max validation accuracy : 0.773239 max acc epoch : 10 test accuracy : 0.776871
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  64.84830379486084 Time :  1473
accuracy train: 0.863707 val: 0.771831 test: 0.770962
max validation accuracy : 0.773239 max acc epoch : 10 test accuracy : 0.776871
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.49903613328934 Time :  1485
accuracy train: 0.865739 val: 0.767606 test: 0.776027
max validation accuracy : 0.773239 max acc epoch : 10 test accuracy : 0.776871
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  62.082194313406944 Time :  1496
accuracy train: 0.874648 val: 0.767606 test: 0.770962
max validation accuracy : 0.773239 max acc epoch : 10 test accuracy : 0.776871
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  62.210105419158936 Time :  1508
accuracy train: 0.875586 val: 0.770423 test: 0.774902
max validation accuracy : 0.773239 max acc epoch : 10 test accuracy : 0.776871
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  58.92762205004692 Time :  1518
accuracy train: 0.881525 val: 0.766197 test: 0.776590
max validation accuracy : 0.773239 max acc epoch : 10 test accuracy : 0.776871

Epoch :  16 loss training:  59.476829409599304 Time :  1530
accuracy train: 0.881994 val: 0.773239 test: 0.774057
max validation accuracy : 0.773239 max acc epoch : 10 test accuracy : 0.776871

Epoch :  17 loss training:  58.04532417654991 Time :  1543
accuracy train: 0.888559 val: 0.767606 test: 0.774902
max validation accuracy : 0.773239 max acc epoch : 10 test accuracy : 0.776871

Epoch :  18 loss training:  57.80304692685604 Time :  1554
accuracy train: 0.892154 val: 0.774648 test: 0.772369
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.772369

Epoch :  19 loss training:  56.6182901263237 Time :  1565
accuracy train: 0.894811 val: 0.770423 test: 0.776308
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.772369

Epoch :  20 loss training:  55.43429870903492 Time :  1578
accuracy train: 0.900594 val: 0.767606 test: 0.777434
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.772369

Epoch :  21 loss training:  55.770899802446365 Time :  1590
accuracy train: 0.903876 val: 0.773239 test: 0.773495
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.772369

Epoch :  22 loss training:  54.97549620270729 Time :  1601
accuracy train: 0.907940 val: 0.774648 test: 0.773213
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.772369

Epoch :  23 loss training:  52.66642540693283 Time :  1611
accuracy train: 0.912316 val: 0.770423 test: 0.774902
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.772369

Epoch :  24 loss training:  52.449840024113655 Time :  1622
accuracy train: 0.911847 val: 0.764789 test: 0.772088
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.772369

Epoch :  25 loss training:  52.72726155817509 Time :  1636
accuracy train: 0.919193 val: 0.766197 test: 0.771244
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.772369

Epoch :  26 loss training:  50.55336416512728 Time :  1646
accuracy train: 0.915599 val: 0.771831 test: 0.770400
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.772369

Epoch :  27 loss training:  50.32521861791611 Time :  1657
accuracy train: 0.920600 val: 0.771831 test: 0.772932
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.772369

Epoch :  28 loss training:  49.21464331448078 Time :  1667
accuracy train: 0.924508 val: 0.771831 test: 0.773776
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.772369

Epoch :  29 loss training:  47.99431191384792 Time :  1678
accuracy train: 0.926071 val: 0.771831 test: 0.772088
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.772369

Epoch :  30 loss training:  48.01087762415409 Time :  1689
accuracy train: 0.930447 val: 0.769014 test: 0.770681
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.772369

Epoch :  31 loss training:  47.35687340050936 Time :  1700
accuracy train: 0.928415 val: 0.777465 test: 0.772088
max validation accuracy : 0.777465 max acc epoch : 31 test accuracy : 0.772088

Epoch :  32 loss training:  45.4567166864872 Time :  1709
accuracy train: 0.935136 val: 0.781690 test: 0.775464
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  33 loss training:  45.232148207724094 Time :  1725
accuracy train: 0.939512 val: 0.777465 test: 0.769555
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  34 loss training:  45.6511722356081 Time :  1739
accuracy train: 0.943107 val: 0.777465 test: 0.774339
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  35 loss training:  43.85514236986637 Time :  1750
accuracy train: 0.941857 val: 0.773239 test: 0.771806
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  36 loss training:  43.134363792836666 Time :  1761
accuracy train: 0.947484 val: 0.769014 test: 0.770400
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  37 loss training:  41.19231913983822 Time :  1772
accuracy train: 0.948421 val: 0.764789 test: 0.771244
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  38 loss training:  41.22834389656782 Time :  1781
accuracy train: 0.953267 val: 0.776056 test: 0.772932
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  39 loss training:  41.189893789589405 Time :  1796
accuracy train: 0.952485 val: 0.766197 test: 0.770400
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  40 loss training:  38.84459130465984 Time :  1805
accuracy train: 0.955767 val: 0.764789 test: 0.771525
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  41 loss training:  38.13686551898718 Time :  1818
accuracy train: 0.957487 val: 0.771831 test: 0.775464
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  42 loss training:  37.66144844889641 Time :  1832
accuracy train: 0.961394 val: 0.764789 test: 0.768993
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  43 loss training:  37.73697356879711 Time :  1841
accuracy train: 0.961238 val: 0.767606 test: 0.771525
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  44 loss training:  36.43942033499479 Time :  1852
accuracy train: 0.961082 val: 0.764789 test: 0.768149
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  45 loss training:  35.905202247202396 Time :  1863
accuracy train: 0.964676 val: 0.764789 test: 0.769837
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  46 loss training:  34.93213704228401 Time :  1877
accuracy train: 0.968271 val: 0.764789 test: 0.770118
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  47 loss training:  34.81676199287176 Time :  1888
accuracy train: 0.969209 val: 0.763380 test: 0.771525
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  48 loss training:  33.65094501525164 Time :  1900
accuracy train: 0.969522 val: 0.761972 test: 0.767304
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  49 loss training:  33.24883350729942 Time :  1909
accuracy train: 0.968897 val: 0.774648 test: 0.770118
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  50 loss training:  32.640983797609806 Time :  1922
accuracy train: 0.973429 val: 0.763380 test: 0.769555
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  51 loss training:  32.20759931951761 Time :  1932
accuracy train: 0.974054 val: 0.769014 test: 0.768993
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  52 loss training:  32.06615664809942 Time :  1944
accuracy train: 0.976711 val: 0.769014 test: 0.763647
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  53 loss training:  30.513497389853 Time :  1956
accuracy train: 0.977493 val: 0.763380 test: 0.768149
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  54 loss training:  30.642544467002153 Time :  1966
accuracy train: 0.978900 val: 0.759155 test: 0.768149
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  55 loss training:  28.6847763620317 Time :  1979
accuracy train: 0.979369 val: 0.761972 test: 0.769837
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  56 loss training:  28.80555410683155 Time :  1989
accuracy train: 0.979681 val: 0.756338 test: 0.770962
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  57 loss training:  27.934495132416487 Time :  2002
accuracy train: 0.983120 val: 0.756338 test: 0.765335
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  58 loss training:  28.169041506946087 Time :  2015
accuracy train: 0.984526 val: 0.757746 test: 0.770118
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  59 loss training:  27.317553736269474 Time :  2026
accuracy train: 0.985777 val: 0.759155 test: 0.769837
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  60 loss training:  25.26689782552421 Time :  2036
accuracy train: 0.984214 val: 0.764789 test: 0.766460
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  61 loss training:  26.398202378302813 Time :  2050
accuracy train: 0.987340 val: 0.760563 test: 0.767867
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  62 loss training:  26.323552537709475 Time :  2059
accuracy train: 0.986715 val: 0.774648 test: 0.765898
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

Epoch :  63 loss training:  26.024591455236077 Time :  2070
accuracy train: 0.988590 val: 0.769014 test: 0.771244
max validation accuracy : 0.781690 max acc epoch : 32 test accuracy : 0.775464

========================================================================================================================================================================================================
max acc epoch :  32
max validation accuracy :  0.7816901408450704
test accuracy :  0.7754642656162071
last test_accuracy :  0.7712436691052336
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_Exp=5, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=956, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.03042832016945 Time :  2083
accuracy train: 0.784464 val: 0.756338 test: 0.767023
max validation accuracy : 0.756338 max acc epoch : 1 test accuracy : 0.767023
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.29570907354355 Time :  2095
accuracy train: 0.781807 val: 0.746479 test: 0.765053
max validation accuracy : 0.756338 max acc epoch : 1 test accuracy : 0.767023
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  80.00964984297752 Time :  2106
accuracy train: 0.805721 val: 0.767606 test: 0.777153
max validation accuracy : 0.767606 max acc epoch : 3 test accuracy : 0.777153
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  74.64674603939056 Time :  2117
accuracy train: 0.812598 val: 0.770423 test: 0.778841
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.778841
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  74.47759211063385 Time :  2127
accuracy train: 0.826039 val: 0.764789 test: 0.775464
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.778841
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.68093520402908 Time :  2141
accuracy train: 0.831822 val: 0.761972 test: 0.771244
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.778841
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.09579542279243 Time :  2154
accuracy train: 0.838856 val: 0.764789 test: 0.772651
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.778841
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.88738839328289 Time :  2165
accuracy train: 0.839481 val: 0.773239 test: 0.774339
max validation accuracy : 0.773239 max acc epoch : 8 test accuracy : 0.774339
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  66.60781420767307 Time :  2177
accuracy train: 0.852141 val: 0.764789 test: 0.772088
max validation accuracy : 0.773239 max acc epoch : 8 test accuracy : 0.774339
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  66.26320917904377 Time :  2186
accuracy train: 0.850266 val: 0.774648 test: 0.773495
max validation accuracy : 0.774648 max acc epoch : 10 test accuracy : 0.773495
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  65.12168110907078 Time :  2201
accuracy train: 0.859956 val: 0.777465 test: 0.773776
max validation accuracy : 0.777465 max acc epoch : 11 test accuracy : 0.773776
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.86094072461128 Time :  2211
accuracy train: 0.864802 val: 0.767606 test: 0.772651
max validation accuracy : 0.777465 max acc epoch : 11 test accuracy : 0.773776
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  62.40352050960064 Time :  2221
accuracy train: 0.871210 val: 0.774648 test: 0.775464
max validation accuracy : 0.777465 max acc epoch : 11 test accuracy : 0.773776
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  62.05250273644924 Time :  2233
accuracy train: 0.876993 val: 0.767606 test: 0.776308
max validation accuracy : 0.777465 max acc epoch : 11 test accuracy : 0.773776
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  59.11169058084488 Time :  2245
accuracy train: 0.880119 val: 0.769014 test: 0.772932
max validation accuracy : 0.777465 max acc epoch : 11 test accuracy : 0.773776

Epoch :  16 loss training:  60.0539473593235 Time :  2256
accuracy train: 0.880119 val: 0.778873 test: 0.775464
max validation accuracy : 0.778873 max acc epoch : 16 test accuracy : 0.775464

Epoch :  17 loss training:  58.64598028361797 Time :  2268
accuracy train: 0.886996 val: 0.776056 test: 0.773776
max validation accuracy : 0.778873 max acc epoch : 16 test accuracy : 0.775464

Epoch :  18 loss training:  57.91500452160835 Time :  2277
accuracy train: 0.889966 val: 0.776056 test: 0.770118
max validation accuracy : 0.778873 max acc epoch : 16 test accuracy : 0.775464

Epoch :  19 loss training:  56.80700023472309 Time :  2291
accuracy train: 0.893873 val: 0.774648 test: 0.771806
max validation accuracy : 0.778873 max acc epoch : 16 test accuracy : 0.775464

Epoch :  20 loss training:  55.48015049099922 Time :  2308
accuracy train: 0.899656 val: 0.769014 test: 0.776590
max validation accuracy : 0.778873 max acc epoch : 16 test accuracy : 0.775464

Epoch :  21 loss training:  55.910515412688255 Time :  2318
accuracy train: 0.902157 val: 0.774648 test: 0.772369
max validation accuracy : 0.778873 max acc epoch : 16 test accuracy : 0.775464

Epoch :  22 loss training:  55.26479257643223 Time :  2331
accuracy train: 0.906533 val: 0.771831 test: 0.772088
max validation accuracy : 0.778873 max acc epoch : 16 test accuracy : 0.775464

Epoch :  23 loss training:  53.04227504134178 Time :  2342
accuracy train: 0.910910 val: 0.770423 test: 0.776027
max validation accuracy : 0.778873 max acc epoch : 16 test accuracy : 0.775464

Epoch :  24 loss training:  52.65892545878887 Time :  2353
accuracy train: 0.911535 val: 0.764789 test: 0.772932
max validation accuracy : 0.778873 max acc epoch : 16 test accuracy : 0.775464

Epoch :  25 loss training:  52.91440433263779 Time :  2363
accuracy train: 0.917162 val: 0.763380 test: 0.770400
max validation accuracy : 0.778873 max acc epoch : 16 test accuracy : 0.775464

Epoch :  26 loss training:  50.68277791887522 Time :  2374
accuracy train: 0.916068 val: 0.783099 test: 0.773213
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  27 loss training:  50.53707320988178 Time :  2385
accuracy train: 0.920600 val: 0.774648 test: 0.772088
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  28 loss training:  49.311622343957424 Time :  2397
accuracy train: 0.926696 val: 0.769014 test: 0.771806
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  29 loss training:  48.14792640507221 Time :  2407
accuracy train: 0.927946 val: 0.771831 test: 0.773495
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  30 loss training:  48.00668440014124 Time :  2418
accuracy train: 0.930603 val: 0.773239 test: 0.771244
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  31 loss training:  47.20252335816622 Time :  2429
accuracy train: 0.930447 val: 0.771831 test: 0.771525
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  32 loss training:  45.573118299245834 Time :  2440
accuracy train: 0.936230 val: 0.769014 test: 0.774902
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  33 loss training:  45.42949102818966 Time :  2454
accuracy train: 0.940294 val: 0.771831 test: 0.765616
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  34 loss training:  45.452434197068214 Time :  2464
accuracy train: 0.943264 val: 0.769014 test: 0.768711
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  35 loss training:  43.73251135647297 Time :  2474
accuracy train: 0.943889 val: 0.771831 test: 0.770118
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  36 loss training:  42.956989362835884 Time :  2486
accuracy train: 0.946858 val: 0.764789 test: 0.770681
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  37 loss training:  41.232478089630604 Time :  2496
accuracy train: 0.949828 val: 0.759155 test: 0.772651
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  38 loss training:  40.72740898281336 Time :  2509
accuracy train: 0.952173 val: 0.774648 test: 0.771244
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  39 loss training:  41.076217621564865 Time :  2520
accuracy train: 0.954361 val: 0.766197 test: 0.772651
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  40 loss training:  38.653849095106125 Time :  2530
accuracy train: 0.957643 val: 0.767606 test: 0.767867
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  41 loss training:  38.38714271783829 Time :  2542
accuracy train: 0.959362 val: 0.761972 test: 0.770118
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  42 loss training:  37.307684406638145 Time :  2552
accuracy train: 0.961863 val: 0.754930 test: 0.767586
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  43 loss training:  37.26063648611307 Time :  2562
accuracy train: 0.962801 val: 0.763380 test: 0.769837
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  44 loss training:  36.0564631447196 Time :  2575
accuracy train: 0.963739 val: 0.750704 test: 0.767023
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  45 loss training:  35.729878917336464 Time :  2588
accuracy train: 0.964364 val: 0.766197 test: 0.770118
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  46 loss training:  34.87888760864735 Time :  2598
accuracy train: 0.968428 val: 0.759155 test: 0.771806
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  47 loss training:  34.59681038931012 Time :  2611
accuracy train: 0.969209 val: 0.754930 test: 0.769274
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  48 loss training:  33.67205608636141 Time :  2622
accuracy train: 0.971397 val: 0.753521 test: 0.768711
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  49 loss training:  33.17801248282194 Time :  2631
accuracy train: 0.969834 val: 0.761972 test: 0.769555
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  50 loss training:  32.16719340160489 Time :  2645
accuracy train: 0.974680 val: 0.756338 test: 0.767586
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  51 loss training:  32.152136988937855 Time :  2658
accuracy train: 0.973429 val: 0.757746 test: 0.766742
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  52 loss training:  31.760005220770836 Time :  2667
accuracy train: 0.976711 val: 0.757746 test: 0.761114
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  53 loss training:  30.430110156536102 Time :  2682
accuracy train: 0.976711 val: 0.761972 test: 0.766460
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  54 loss training:  30.11793313920498 Time :  2692
accuracy train: 0.981400 val: 0.753521 test: 0.768993
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  55 loss training:  28.56955275684595 Time :  2703
accuracy train: 0.979837 val: 0.756338 test: 0.770962
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  56 loss training:  28.793844927102327 Time :  2716
accuracy train: 0.980150 val: 0.747887 test: 0.765335
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

Epoch :  57 loss training:  27.901913341134787 Time :  2730
accuracy train: 0.983745 val: 0.759155 test: 0.768149
max validation accuracy : 0.783099 max acc epoch : 26 test accuracy : 0.773213

========================================================================================================================================================================================================
max acc epoch :  26
max validation accuracy :  0.7830985915492957
test accuracy :  0.7732132808103546
last test_accuracy :  0.7681485649971863
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_Exp=5, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=956, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.03934529423714 Time :  2744
accuracy train: 0.783839 val: 0.757746 test: 0.767586
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.767586
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.35748612880707 Time :  2757
accuracy train: 0.779306 val: 0.738028 test: 0.760551
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.767586
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.90236565470695 Time :  2769
accuracy train: 0.804783 val: 0.764789 test: 0.776027
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  74.5536435842514 Time :  2780
accuracy train: 0.813223 val: 0.759155 test: 0.776027
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  74.20140263438225 Time :  2792
accuracy train: 0.825727 val: 0.764789 test: 0.777715
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.776027
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.47299128770828 Time :  2804
accuracy train: 0.831354 val: 0.766197 test: 0.778841
max validation accuracy : 0.766197 max acc epoch : 6 test accuracy : 0.778841
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  68.90807250142097 Time :  2813
accuracy train: 0.840106 val: 0.761972 test: 0.772932
max validation accuracy : 0.766197 max acc epoch : 6 test accuracy : 0.778841
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.8259562253952 Time :  2824
accuracy train: 0.840575 val: 0.766197 test: 0.771244
max validation accuracy : 0.766197 max acc epoch : 6 test accuracy : 0.778841
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  66.75264747440815 Time :  2836
accuracy train: 0.854329 val: 0.761972 test: 0.771525
max validation accuracy : 0.766197 max acc epoch : 6 test accuracy : 0.778841
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  66.33451080322266 Time :  2846
accuracy train: 0.851985 val: 0.771831 test: 0.768711
max validation accuracy : 0.771831 max acc epoch : 10 test accuracy : 0.768711
Epoch-10 lr: 6.25e-05

Epoch :  11 loss training:  65.08040675520897 Time :  2857
accuracy train: 0.861207 val: 0.773239 test: 0.772932
max validation accuracy : 0.773239 max acc epoch : 11 test accuracy : 0.772932
Epoch-11 lr: 6.25e-05

Epoch :  12 loss training:  64.41886189579964 Time :  2870
accuracy train: 0.865896 val: 0.780282 test: 0.773776
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776
Epoch-12 lr: 3.125e-05

Epoch :  13 loss training:  62.27971576154232 Time :  2882
accuracy train: 0.872304 val: 0.769014 test: 0.772088
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776
Epoch-13 lr: 3.125e-05

Epoch :  14 loss training:  62.007662162184715 Time :  2895
accuracy train: 0.878243 val: 0.773239 test: 0.774057
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776
Epoch-14 lr: 3.125e-05

Epoch :  15 loss training:  59.1120929569006 Time :  2911
accuracy train: 0.879181 val: 0.774648 test: 0.774339
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  16 loss training:  59.68029308319092 Time :  2921
accuracy train: 0.881525 val: 0.773239 test: 0.774620
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  17 loss training:  58.33798839151859 Time :  2933
accuracy train: 0.888872 val: 0.776056 test: 0.771806
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  18 loss training:  57.824909031391144 Time :  2944
accuracy train: 0.892154 val: 0.778873 test: 0.769555
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  19 loss training:  56.75776521861553 Time :  2957
accuracy train: 0.895280 val: 0.777465 test: 0.774057
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  20 loss training:  55.32756306231022 Time :  2968
accuracy train: 0.899031 val: 0.771831 test: 0.776590
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  21 loss training:  55.91872864961624 Time :  2979
accuracy train: 0.903407 val: 0.780282 test: 0.770118
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  22 loss training:  55.12947550415993 Time :  2989
accuracy train: 0.905127 val: 0.771831 test: 0.773213
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  23 loss training:  52.850872203707695 Time :  3005
accuracy train: 0.912942 val: 0.764789 test: 0.774902
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  24 loss training:  52.40015748143196 Time :  3015
accuracy train: 0.912004 val: 0.770423 test: 0.776590
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  25 loss training:  53.1194848716259 Time :  3026
accuracy train: 0.917631 val: 0.767606 test: 0.769555
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  26 loss training:  50.4824547842145 Time :  3040
accuracy train: 0.916536 val: 0.778873 test: 0.773776
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  27 loss training:  50.43718919157982 Time :  3053
accuracy train: 0.919975 val: 0.773239 test: 0.772088
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  28 loss training:  49.320772141218185 Time :  3064
accuracy train: 0.926540 val: 0.766197 test: 0.773495
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  29 loss training:  47.860368475317955 Time :  3073
accuracy train: 0.927790 val: 0.764789 test: 0.771806
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  30 loss training:  47.83937807381153 Time :  3087
accuracy train: 0.930291 val: 0.764789 test: 0.772088
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  31 loss training:  47.291739873588085 Time :  3097
accuracy train: 0.931541 val: 0.773239 test: 0.771244
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  32 loss training:  45.56534145027399 Time :  3108
accuracy train: 0.935917 val: 0.770423 test: 0.774620
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  33 loss training:  45.65331234037876 Time :  3120
accuracy train: 0.941701 val: 0.769014 test: 0.772088
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  34 loss training:  45.22165007889271 Time :  3131
accuracy train: 0.942013 val: 0.774648 test: 0.773213
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  35 loss training:  44.087108090519905 Time :  3142
accuracy train: 0.942482 val: 0.780282 test: 0.770681
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  36 loss training:  42.71732176095247 Time :  3154
accuracy train: 0.947952 val: 0.763380 test: 0.772932
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  37 loss training:  41.545902490615845 Time :  3163
accuracy train: 0.948890 val: 0.764789 test: 0.774339
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  38 loss training:  41.034917429089546 Time :  3177
accuracy train: 0.952173 val: 0.769014 test: 0.771244
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  39 loss training:  41.08966813981533 Time :  3190
accuracy train: 0.952798 val: 0.770423 test: 0.771806
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  40 loss training:  38.81946851313114 Time :  3202
accuracy train: 0.958425 val: 0.761972 test: 0.776308
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  41 loss training:  38.19030334800482 Time :  3212
accuracy train: 0.959206 val: 0.771831 test: 0.776027
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  42 loss training:  37.818177945911884 Time :  3224
accuracy train: 0.959831 val: 0.760563 test: 0.773495
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

Epoch :  43 loss training:  37.63010912388563 Time :  3236
accuracy train: 0.961863 val: 0.760563 test: 0.769837
max validation accuracy : 0.780282 max acc epoch : 12 test accuracy : 0.773776

========================================================================================================================================================================================================
max acc epoch :  12
max validation accuracy :  0.780281690140845
test accuracy :  0.7737760270118177
last test_accuracy :  0.7698368036015757
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.78028 	 test_accuracy : 0.77040 	 max_acc epoch :  30 	 last test_accuracy : 0.77012
k :  1 	 val_accuracy : 0.77887 	 test_accuracy : 0.76927 	 max_acc epoch :  21 	 last test_accuracy : 0.76646
k :  2 	 val_accuracy : 0.78169 	 test_accuracy : 0.77546 	 max_acc epoch :  32 	 last test_accuracy : 0.77124
k :  3 	 val_accuracy : 0.78310 	 test_accuracy : 0.77321 	 max_acc epoch :  26 	 last test_accuracy : 0.76815
k :  4 	 val_accuracy : 0.78028 	 test_accuracy : 0.77378 	 max_acc epoch :  12 	 last test_accuracy : 0.76984

avg :  	 val_accuracy : 0.78085 	 test_accuracy : 0.77243 	 last_accuracy : 0.76916
