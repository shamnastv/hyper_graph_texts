

date and time :  Wed Jun 16 01:59:37 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=15, epochs=300, hidden_dim=50, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=742, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 2587, 0: 2555, 2: 2258})

Epoch :  1 loss training:  246.23119592666626 Time :  66
accuracy train: 0.578486 val: 0.564612 test: 0.548850
max validation accuracy : 0.564612 max acc epoch : 1 test accuracy : 0.548850
Counter({0: 4178, 2: 1648, 1: 1574})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  167.91620987653732 Time :  119
accuracy train: 0.649965 val: 0.624254 test: 0.613406
max validation accuracy : 0.624254 max acc epoch : 2 test accuracy : 0.613406
Counter({1: 3279, 0: 2320, 2: 1801})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  139.33476048707962 Time :  175
accuracy train: 0.694114 val: 0.656064 test: 0.635914
max validation accuracy : 0.656064 max acc epoch : 3 test accuracy : 0.635914
Counter({1: 3261, 2: 2249, 0: 1890})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  122.60973078012466 Time :  219
accuracy train: 0.717589 val: 0.675944 test: 0.656196
max validation accuracy : 0.675944 max acc epoch : 4 test accuracy : 0.656196
Counter({2: 3281, 0: 2160, 1: 1959})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  114.60741704702377 Time :  281
accuracy train: 0.748774 val: 0.707753 test: 0.671531
max validation accuracy : 0.707753 max acc epoch : 5 test accuracy : 0.671531
Counter({2: 4282, 1: 1660, 0: 1458})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  110.45423197746277 Time :  340
accuracy train: 0.762439 val: 0.697813 test: 0.668316
max validation accuracy : 0.707753 max acc epoch : 5 test accuracy : 0.671531
Counter({0: 2979, 2: 2426, 1: 1995})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  102.4763553738594 Time :  400
accuracy train: 0.761388 val: 0.697813 test: 0.681919
max validation accuracy : 0.707753 max acc epoch : 5 test accuracy : 0.671531
Counter({1: 2960, 2: 2452, 0: 1988})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  99.25051426887512 Time :  453
accuracy train: 0.772950 val: 0.711730 test: 0.686866
max validation accuracy : 0.711730 max acc epoch : 8 test accuracy : 0.686866
Counter({0: 2962, 2: 2442, 1: 1996})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  98.39760956168175 Time :  496
accuracy train: 0.779958 val: 0.715706 test: 0.680930
max validation accuracy : 0.715706 max acc epoch : 9 test accuracy : 0.680930
Counter({1: 2967, 2: 2439, 0: 1994})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  93.32448768615723 Time :  549
accuracy train: 0.780308 val: 0.707753 test: 0.687114
max validation accuracy : 0.715706 max acc epoch : 9 test accuracy : 0.680930
Counter({1: 2969, 0: 2439, 2: 1992})

Epoch :  11 loss training:  92.1021938920021 Time :  598
accuracy train: 0.789769 val: 0.721670 test: 0.691813
max validation accuracy : 0.721670 max acc epoch : 11 test accuracy : 0.691813
Counter({1: 2971, 0: 2438, 2: 1991})

Epoch :  12 loss training:  89.76211416721344 Time :  642
accuracy train: 0.793623 val: 0.717694 test: 0.690576
max validation accuracy : 0.721670 max acc epoch : 11 test accuracy : 0.691813
Counter({0: 2971, 1: 2437, 2: 1992})

Epoch :  13 loss training:  86.86222487688065 Time :  674
accuracy train: 0.804135 val: 0.721670 test: 0.696018
max validation accuracy : 0.721670 max acc epoch : 11 test accuracy : 0.691813
Counter({0: 2977, 2: 2424, 1: 1999})

Epoch :  14 loss training:  84.94407135248184 Time :  715
accuracy train: 0.808339 val: 0.719682 test: 0.696018
max validation accuracy : 0.721670 max acc epoch : 11 test accuracy : 0.691813
Counter({0: 2966, 2: 2433, 1: 2001})

Epoch :  15 loss training:  81.30033683776855 Time :  763
accuracy train: 0.821654 val: 0.719682 test: 0.695028
max validation accuracy : 0.721670 max acc epoch : 11 test accuracy : 0.691813
Counter({0: 2962, 2: 2434, 1: 2004})

Epoch :  16 loss training:  79.09291313588619 Time :  809
accuracy train: 0.823756 val: 0.731610 test: 0.696512
max validation accuracy : 0.731610 max acc epoch : 16 test accuracy : 0.696512
Counter({0: 2962, 2: 2437, 1: 2001})

Epoch :  17 loss training:  75.96198131144047 Time :  861
accuracy train: 0.838472 val: 0.731610 test: 0.696018
max validation accuracy : 0.731610 max acc epoch : 16 test accuracy : 0.696512
Counter({0: 2945, 2: 2446, 1: 2009})

Epoch :  18 loss training:  73.08197304606438 Time :  896
accuracy train: 0.840224 val: 0.727634 test: 0.696512
max validation accuracy : 0.731610 max acc epoch : 16 test accuracy : 0.696512
Counter({0: 2956, 2: 2439, 1: 2005})

Epoch :  19 loss training:  71.8551478087902 Time :  937
accuracy train: 0.855641 val: 0.729622 test: 0.693297
max validation accuracy : 0.731610 max acc epoch : 16 test accuracy : 0.696512
Counter({0: 2947, 2: 2454, 1: 1999})

Epoch :  20 loss training:  68.10155683755875 Time :  987
accuracy train: 0.853539 val: 0.725646 test: 0.699975
max validation accuracy : 0.731610 max acc epoch : 16 test accuracy : 0.696512
Counter({2: 2933, 1: 2471, 0: 1996})

Epoch :  21 loss training:  67.26305237412453 Time :  1035
accuracy train: 0.857744 val: 0.725646 test: 0.698739
max validation accuracy : 0.731610 max acc epoch : 16 test accuracy : 0.696512
Counter({0: 2936, 1: 2473, 2: 1991})

Epoch :  22 loss training:  62.636034071445465 Time :  1082
accuracy train: 0.869306 val: 0.731610 test: 0.701212
max validation accuracy : 0.731610 max acc epoch : 16 test accuracy : 0.696512
Counter({0: 2935, 1: 2472, 2: 1993})

Epoch :  23 loss training:  62.87781395018101 Time :  1128
accuracy train: 0.874212 val: 0.729622 test: 0.699233
max validation accuracy : 0.731610 max acc epoch : 16 test accuracy : 0.696512
Counter({1: 2929, 2: 2479, 0: 1992})

Epoch :  24 loss training:  58.419205978512764 Time :  1176
accuracy train: 0.882621 val: 0.729622 test: 0.703685
max validation accuracy : 0.731610 max acc epoch : 16 test accuracy : 0.696512
Counter({1: 2923, 0: 2482, 2: 1995})

Epoch :  25 loss training:  57.38618391752243 Time :  1231
accuracy train: 0.891731 val: 0.723658 test: 0.700470
max validation accuracy : 0.731610 max acc epoch : 16 test accuracy : 0.696512
Counter({1: 2916, 2: 2491, 0: 1993})

Epoch :  26 loss training:  54.75134067237377 Time :  1289
accuracy train: 0.898038 val: 0.733598 test: 0.705417
max validation accuracy : 0.733598 max acc epoch : 26 test accuracy : 0.705417
Counter({1: 2929, 2: 2496, 0: 1975})

Epoch :  27 loss training:  54.53733482956886 Time :  1344
accuracy train: 0.901542 val: 0.725646 test: 0.705169
max validation accuracy : 0.733598 max acc epoch : 26 test accuracy : 0.705417
Counter({0: 2939, 2: 2495, 1: 1966})

Epoch :  28 loss training:  49.63735418021679 Time :  1395
accuracy train: 0.911703 val: 0.731610 test: 0.703685
max validation accuracy : 0.733598 max acc epoch : 26 test accuracy : 0.705417
Counter({0: 2946, 1: 2484, 2: 1970})

Epoch :  29 loss training:  48.93473318219185 Time :  1452
accuracy train: 0.918360 val: 0.735586 test: 0.702696
max validation accuracy : 0.735586 max acc epoch : 29 test accuracy : 0.702696
Counter({0: 2944, 2: 2479, 1: 1977})

Epoch :  30 loss training:  46.27439710497856 Time :  1506
accuracy train: 0.924667 val: 0.733598 test: 0.706406
max validation accuracy : 0.735586 max acc epoch : 29 test accuracy : 0.702696
Counter({1: 2947, 2: 2480, 0: 1973})

Epoch :  31 loss training:  44.34942215681076 Time :  1556
accuracy train: 0.933427 val: 0.735586 test: 0.702696
max validation accuracy : 0.735586 max acc epoch : 29 test accuracy : 0.702696
Counter({2: 2937, 1: 2484, 0: 1979})

Epoch :  32 loss training:  41.89223952591419 Time :  1609
accuracy train: 0.940434 val: 0.731610 test: 0.703933
max validation accuracy : 0.735586 max acc epoch : 29 test accuracy : 0.702696
Counter({2: 2921, 0: 2513, 1: 1966})

Epoch :  33 loss training:  40.90506812930107 Time :  1672
accuracy train: 0.941135 val: 0.745527 test: 0.709374
max validation accuracy : 0.745527 max acc epoch : 33 test accuracy : 0.709374
Counter({2: 2927, 0: 2512, 1: 1961})

Epoch :  34 loss training:  39.34171688556671 Time :  1731
accuracy train: 0.943238 val: 0.741551 test: 0.703191
max validation accuracy : 0.745527 max acc epoch : 33 test accuracy : 0.709374
Counter({2: 2925, 1: 2514, 0: 1961})

Epoch :  35 loss training:  35.783806450665 Time :  1789
accuracy train: 0.953749 val: 0.735586 test: 0.703685
max validation accuracy : 0.745527 max acc epoch : 33 test accuracy : 0.709374
Counter({0: 2917, 2: 2517, 1: 1966})

Epoch :  36 loss training:  35.601272240281105 Time :  1842
accuracy train: 0.952348 val: 0.747515 test: 0.703685
max validation accuracy : 0.747515 max acc epoch : 36 test accuracy : 0.703685
Counter({1: 2938, 0: 2511, 2: 1951})

Epoch :  37 loss training:  32.56306214630604 Time :  1890
accuracy train: 0.961107 val: 0.743539 test: 0.707148
max validation accuracy : 0.747515 max acc epoch : 36 test accuracy : 0.703685
Counter({0: 2939, 1: 2514, 2: 1947})

Epoch :  38 loss training:  32.0361445620656 Time :  1945
accuracy train: 0.964611 val: 0.741551 test: 0.705664
max validation accuracy : 0.747515 max acc epoch : 36 test accuracy : 0.703685
Counter({0: 2940, 1: 2512, 2: 1948})

Epoch :  39 loss training:  30.82413589209318 Time :  2001
accuracy train: 0.969516 val: 0.743539 test: 0.708385
max validation accuracy : 0.747515 max acc epoch : 36 test accuracy : 0.703685
Counter({0: 2946, 1: 2527, 2: 1927})

Epoch :  40 loss training:  28.055508829653263 Time :  2058
accuracy train: 0.972670 val: 0.743539 test: 0.703933
max validation accuracy : 0.747515 max acc epoch : 36 test accuracy : 0.703685
Counter({1: 2930, 2: 2534, 0: 1936})

Epoch :  41 loss training:  26.51163449883461 Time :  2110
accuracy train: 0.974772 val: 0.737575 test: 0.703191
max validation accuracy : 0.747515 max acc epoch : 36 test accuracy : 0.703685
Counter({0: 2937, 1: 2529, 2: 1934})

Epoch :  42 loss training:  26.05705726146698 Time :  2163
accuracy train: 0.975123 val: 0.745527 test: 0.706653
max validation accuracy : 0.747515 max acc epoch : 36 test accuracy : 0.703685
Counter({1: 2946, 0: 2518, 2: 1936})

Epoch :  43 loss training:  24.830444633960724 Time :  2220
accuracy train: 0.981430 val: 0.743539 test: 0.703685
max validation accuracy : 0.747515 max acc epoch : 36 test accuracy : 0.703685
Counter({0: 2957, 2: 2498, 1: 1945})

Epoch :  44 loss training:  24.29425337910652 Time :  2277
accuracy train: 0.982481 val: 0.741551 test: 0.703191
max validation accuracy : 0.747515 max acc epoch : 36 test accuracy : 0.703685
Counter({1: 2970, 0: 2483, 2: 1947})

Epoch :  45 loss training:  22.21129945665598 Time :  2343
accuracy train: 0.983181 val: 0.743539 test: 0.705169
max validation accuracy : 0.747515 max acc epoch : 36 test accuracy : 0.703685
Counter({1: 2956, 2: 2494, 0: 1950})

Epoch :  46 loss training:  21.5057580396533 Time :  2402
accuracy train: 0.987036 val: 0.735586 test: 0.706159
max validation accuracy : 0.747515 max acc epoch : 36 test accuracy : 0.703685
Counter({0: 2966, 2: 2468, 1: 1966})

Epoch :  47 loss training:  19.371454179286957 Time :  2464
accuracy train: 0.987737 val: 0.735586 test: 0.705664
max validation accuracy : 0.747515 max acc epoch : 36 test accuracy : 0.703685
Counter({1: 2966, 2: 2467, 0: 1967})

Epoch :  48 loss training:  18.27381887473166 Time :  2526
accuracy train: 0.989138 val: 0.745527 test: 0.702201
max validation accuracy : 0.747515 max acc epoch : 36 test accuracy : 0.703685
Counter({1: 2964, 2: 2463, 0: 1973})

Epoch :  49 loss training:  17.477613367140293 Time :  2592
accuracy train: 0.991941 val: 0.745527 test: 0.704180
max validation accuracy : 0.747515 max acc epoch : 36 test accuracy : 0.703685
Counter({0: 2976, 2: 2441, 1: 1983})

Epoch :  50 loss training:  16.248162783682346 Time :  2661
accuracy train: 0.995445 val: 0.749503 test: 0.701954
max validation accuracy : 0.749503 max acc epoch : 50 test accuracy : 0.701954
Counter({0: 2974, 1: 2454, 2: 1972})

Epoch :  51 loss training:  15.733706794679165 Time :  2721
accuracy train: 0.993343 val: 0.749503 test: 0.704180
max validation accuracy : 0.749503 max acc epoch : 50 test accuracy : 0.701954
Counter({1: 2984, 0: 2447, 2: 1969})

Epoch :  52 loss training:  14.853569749742746 Time :  2781
accuracy train: 0.994744 val: 0.739563 test: 0.701707
max validation accuracy : 0.749503 max acc epoch : 50 test accuracy : 0.701954
Counter({0: 2984, 1: 2438, 2: 1978})

Epoch :  53 loss training:  14.706590611487627 Time :  2832
accuracy train: 0.996496 val: 0.743539 test: 0.702696
max validation accuracy : 0.749503 max acc epoch : 50 test accuracy : 0.701954
Counter({1: 2985, 0: 2451, 2: 1964})

Epoch :  54 loss training:  13.21307821571827 Time :  2871
accuracy train: 0.995795 val: 0.737575 test: 0.699728
max validation accuracy : 0.749503 max acc epoch : 50 test accuracy : 0.701954
Counter({1: 2997, 0: 2433, 2: 1970})

Epoch :  55 loss training:  12.55131752602756 Time :  2913
accuracy train: 0.995795 val: 0.737575 test: 0.700223
max validation accuracy : 0.749503 max acc epoch : 50 test accuracy : 0.701954
Counter({2: 3012, 1: 2408, 0: 1980})

Epoch :  56 loss training:  12.16915138438344 Time :  2974
accuracy train: 0.997547 val: 0.739563 test: 0.704427
max validation accuracy : 0.749503 max acc epoch : 50 test accuracy : 0.701954
Counter({1: 3010, 0: 2405, 2: 1985})

Epoch :  57 loss training:  11.647918026894331 Time :  3022
accuracy train: 0.996496 val: 0.731610 test: 0.702696
max validation accuracy : 0.749503 max acc epoch : 50 test accuracy : 0.701954
Counter({0: 3002, 1: 2403, 2: 1995})

Epoch :  58 loss training:  10.664744358509779 Time :  3070
accuracy train: 0.998598 val: 0.731610 test: 0.701954
max validation accuracy : 0.749503 max acc epoch : 50 test accuracy : 0.701954
Counter({0: 3009, 2: 2397, 1: 1994})

Epoch :  59 loss training:  10.89638858474791 Time :  3117
accuracy train: 0.998598 val: 0.735586 test: 0.703933
max validation accuracy : 0.749503 max acc epoch : 50 test accuracy : 0.701954
Counter({1: 3011, 0: 2399, 2: 1990})

Epoch :  60 loss training:  9.223370870575309 Time :  3172
accuracy train: 0.997898 val: 0.733598 test: 0.701707
max validation accuracy : 0.749503 max acc epoch : 50 test accuracy : 0.701954
Counter({1: 3019, 0: 2385, 2: 1996})

Epoch :  61 loss training:  9.513799708336592 Time :  3234
accuracy train: 0.999650 val: 0.743539 test: 0.702201
max validation accuracy : 0.749503 max acc epoch : 50 test accuracy : 0.701954
Counter({1: 3024, 0: 2378, 2: 1998})

Epoch :  62 loss training:  8.788341021165252 Time :  3298
accuracy train: 0.999299 val: 0.737575 test: 0.700965
max validation accuracy : 0.749503 max acc epoch : 50 test accuracy : 0.701954
Counter({2: 3026, 1: 2387, 0: 1987})

Epoch :  63 loss training:  8.342620272189379 Time :  3356
accuracy train: 0.999650 val: 0.739563 test: 0.699481
max validation accuracy : 0.749503 max acc epoch : 50 test accuracy : 0.701954
Counter({2: 3021, 0: 2388, 1: 1991})

Epoch :  64 loss training:  8.370482875965536 Time :  3414
accuracy train: 0.999650 val: 0.747515 test: 0.703933
max validation accuracy : 0.749503 max acc epoch : 50 test accuracy : 0.701954
Counter({2: 3026, 0: 2384, 1: 1990})

Epoch :  65 loss training:  8.140635076910257 Time :  3469
accuracy train: 0.999650 val: 0.747515 test: 0.703191
max validation accuracy : 0.749503 max acc epoch : 50 test accuracy : 0.701954
Counter({2: 3424, 1: 2079, 0: 1897})

Epoch :  66 loss training:  7.3167225401848555 Time :  3531
accuracy train: 0.999299 val: 0.737575 test: 0.703685
max validation accuracy : 0.749503 max acc epoch : 50 test accuracy : 0.701954
Counter({0: 3033, 2: 2359, 1: 2008})

========================================================================================================================================================================================================
best acc epoch :  50
validation accuracy :  0.7495029821073559
test accuracy :  0.7019539945584962
last test_accuracy :  0.7036853821419737
second best val :  0.7475149105367793
second best test :  0.7036853821419737
max gap 14
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=15, epochs=300, hidden_dim=50, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=476, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({2: 2604, 0: 2534, 1: 2262})

Epoch :  1 loss training:  246.26365733146667 Time :  3656
accuracy train: 0.605816 val: 0.594433 test: 0.572347
max validation accuracy : 0.594433 max acc epoch : 1 test accuracy : 0.572347
Counter({1: 4194, 0: 1844, 2: 1362})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  160.53822201490402 Time :  3712
accuracy train: 0.682901 val: 0.652087 test: 0.634925
max validation accuracy : 0.652087 max acc epoch : 2 test accuracy : 0.634925
Counter({2: 4363, 1: 1658, 0: 1379})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  134.0024003982544 Time :  3773
accuracy train: 0.717589 val: 0.638171 test: 0.646302
max validation accuracy : 0.652087 max acc epoch : 2 test accuracy : 0.634925
Counter({1: 2931, 0: 2775, 2: 1694})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  116.99455797672272 Time :  3842
accuracy train: 0.745620 val: 0.677932 test: 0.681425
max validation accuracy : 0.677932 max acc epoch : 4 test accuracy : 0.681425
Counter({0: 2941, 2: 2803, 1: 1656})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  109.42951747775078 Time :  3915
accuracy train: 0.747372 val: 0.673956 test: 0.682167
max validation accuracy : 0.677932 max acc epoch : 4 test accuracy : 0.681425
Counter({0: 2932, 1: 2717, 2: 1751})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  103.30652487277985 Time :  3976
accuracy train: 0.746321 val: 0.675944 test: 0.665842
max validation accuracy : 0.677932 max acc epoch : 4 test accuracy : 0.681425
Counter({0: 2866, 1: 2747, 2: 1787})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  98.04144394397736 Time :  4029
accuracy train: 0.776804 val: 0.693837 test: 0.685135
max validation accuracy : 0.693837 max acc epoch : 7 test accuracy : 0.685135
Counter({0: 2920, 1: 2730, 2: 1750})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  94.9964111149311 Time :  4081
accuracy train: 0.782761 val: 0.703777 test: 0.691813
max validation accuracy : 0.703777 max acc epoch : 8 test accuracy : 0.691813
Counter({0: 2936, 2: 2744, 1: 1720})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  91.6725202202797 Time :  4142
accuracy train: 0.797477 val: 0.701789 test: 0.691813
max validation accuracy : 0.703777 max acc epoch : 8 test accuracy : 0.691813
Counter({1: 2929, 2: 2729, 0: 1742})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  87.85810405015945 Time :  4193
accuracy train: 0.800631 val: 0.709742 test: 0.689340
max validation accuracy : 0.709742 max acc epoch : 10 test accuracy : 0.689340
Counter({2: 2915, 0: 2735, 1: 1750})

Epoch :  11 loss training:  87.16388693451881 Time :  4245
accuracy train: 0.806237 val: 0.701789 test: 0.695276
max validation accuracy : 0.709742 max acc epoch : 10 test accuracy : 0.689340
Counter({2: 2908, 1: 2740, 0: 1752})

Epoch :  12 loss training:  84.96796368062496 Time :  4299
accuracy train: 0.814646 val: 0.703777 test: 0.694534
max validation accuracy : 0.709742 max acc epoch : 10 test accuracy : 0.689340
Counter({0: 2915, 2: 2732, 1: 1753})

Epoch :  13 loss training:  81.25465020537376 Time :  4340
accuracy train: 0.821654 val: 0.699801 test: 0.694781
max validation accuracy : 0.709742 max acc epoch : 10 test accuracy : 0.689340
Counter({1: 2920, 2: 2731, 0: 1749})

Epoch :  14 loss training:  78.1415644288063 Time :  4390
accuracy train: 0.835319 val: 0.705765 test: 0.698491
max validation accuracy : 0.709742 max acc epoch : 10 test accuracy : 0.689340
Counter({1: 2909, 2: 2735, 0: 1756})

Epoch :  15 loss training:  76.20741331577301 Time :  4443
accuracy train: 0.844078 val: 0.693837 test: 0.702696
max validation accuracy : 0.709742 max acc epoch : 10 test accuracy : 0.689340
Counter({0: 2929, 2: 2731, 1: 1740})

Epoch :  16 loss training:  75.14109805226326 Time :  4500
accuracy train: 0.848984 val: 0.699801 test: 0.700223
max validation accuracy : 0.709742 max acc epoch : 10 test accuracy : 0.689340
Counter({1: 2937, 2: 2727, 0: 1736})

Epoch :  17 loss training:  71.84180988371372 Time :  4541
accuracy train: 0.856342 val: 0.691849 test: 0.702201
max validation accuracy : 0.709742 max acc epoch : 10 test accuracy : 0.689340
Counter({1: 2932, 0: 2729, 2: 1739})

Epoch :  18 loss training:  67.63363201916218 Time :  4576
accuracy train: 0.869657 val: 0.703777 test: 0.703191
max validation accuracy : 0.709742 max acc epoch : 10 test accuracy : 0.689340
Counter({0: 2925, 2: 2734, 1: 1741})

Epoch :  19 loss training:  66.92431834340096 Time :  4619
accuracy train: 0.871759 val: 0.707753 test: 0.701707
max validation accuracy : 0.709742 max acc epoch : 10 test accuracy : 0.689340
Counter({0: 2926, 2: 2730, 1: 1744})

Epoch :  20 loss training:  64.17069056630135 Time :  4672
accuracy train: 0.879467 val: 0.695825 test: 0.698491
max validation accuracy : 0.709742 max acc epoch : 10 test accuracy : 0.689340
Counter({0: 2921, 1: 2741, 2: 1738})

Epoch :  21 loss training:  59.859504118561745 Time :  4721
accuracy train: 0.889278 val: 0.701789 test: 0.705169
max validation accuracy : 0.709742 max acc epoch : 10 test accuracy : 0.689340
Counter({2: 2915, 1: 2750, 0: 1735})

Epoch :  22 loss training:  57.95015172660351 Time :  4766
accuracy train: 0.894534 val: 0.711730 test: 0.704427
max validation accuracy : 0.711730 max acc epoch : 22 test accuracy : 0.704427
Counter({0: 2914, 1: 2753, 2: 1733})

Epoch :  23 loss training:  55.89705817401409 Time :  4808
accuracy train: 0.900140 val: 0.703777 test: 0.706901
max validation accuracy : 0.711730 max acc epoch : 22 test accuracy : 0.704427
Counter({2: 2914, 1: 2750, 0: 1736})

Epoch :  24 loss training:  54.863790079951286 Time :  4851
accuracy train: 0.913805 val: 0.703777 test: 0.701212
max validation accuracy : 0.711730 max acc epoch : 22 test accuracy : 0.704427
Counter({1: 2930, 2: 2733, 0: 1737})

Epoch :  25 loss training:  53.41396987438202 Time :  4907
accuracy train: 0.917659 val: 0.695825 test: 0.707395
max validation accuracy : 0.711730 max acc epoch : 22 test accuracy : 0.704427
Counter({1: 2930, 2: 2727, 0: 1743})

Epoch :  26 loss training:  49.520741268992424 Time :  4957
accuracy train: 0.920813 val: 0.705765 test: 0.707643
max validation accuracy : 0.711730 max acc epoch : 22 test accuracy : 0.704427
Counter({1: 2913, 2: 2743, 0: 1744})

Epoch :  27 loss training:  47.64297216385603 Time :  5011
accuracy train: 0.927821 val: 0.699801 test: 0.710858
max validation accuracy : 0.711730 max acc epoch : 22 test accuracy : 0.704427
Counter({1: 2909, 0: 2743, 2: 1748})

Epoch :  28 loss training:  46.67038160562515 Time :  5048
accuracy train: 0.934828 val: 0.709742 test: 0.704427
max validation accuracy : 0.711730 max acc epoch : 22 test accuracy : 0.704427
Counter({1: 2902, 0: 2739, 2: 1759})

Epoch :  29 loss training:  43.19595094025135 Time :  5091
accuracy train: 0.942537 val: 0.695825 test: 0.705664
max validation accuracy : 0.711730 max acc epoch : 22 test accuracy : 0.704427
Counter({0: 2874, 2: 2756, 1: 1770})

Epoch :  30 loss training:  43.33291117846966 Time :  5131
accuracy train: 0.945340 val: 0.699801 test: 0.707148
max validation accuracy : 0.711730 max acc epoch : 22 test accuracy : 0.704427
Counter({0: 2889, 2: 2740, 1: 1771})

Epoch :  31 loss training:  39.24100138247013 Time :  5165
accuracy train: 0.953749 val: 0.699801 test: 0.707395
max validation accuracy : 0.711730 max acc epoch : 22 test accuracy : 0.704427
Counter({0: 2884, 1: 2741, 2: 1775})

Epoch :  32 loss training:  37.813124507665634 Time :  5210
accuracy train: 0.954450 val: 0.697813 test: 0.704922
max validation accuracy : 0.711730 max acc epoch : 22 test accuracy : 0.704427
Counter({0: 2871, 1: 2750, 2: 1779})

Epoch :  33 loss training:  35.017196141183376 Time :  5250
accuracy train: 0.961458 val: 0.695825 test: 0.705664
max validation accuracy : 0.711730 max acc epoch : 22 test accuracy : 0.704427
Counter({1: 2875, 2: 2743, 0: 1782})

Epoch :  34 loss training:  34.566703014075756 Time :  5289
accuracy train: 0.959355 val: 0.695825 test: 0.703438
max validation accuracy : 0.711730 max acc epoch : 22 test accuracy : 0.704427
Counter({1: 2854, 0: 2761, 2: 1785})

Epoch :  35 loss training:  32.47972501069307 Time :  5337
accuracy train: 0.961107 val: 0.693837 test: 0.704427
max validation accuracy : 0.711730 max acc epoch : 22 test accuracy : 0.704427
Counter({2: 2843, 0: 2786, 1: 1771})

Epoch :  36 loss training:  31.70797449350357 Time :  5390
accuracy train: 0.968816 val: 0.695825 test: 0.703933
max validation accuracy : 0.711730 max acc epoch : 22 test accuracy : 0.704427
Counter({2: 2820, 0: 2789, 1: 1791})

Epoch :  37 loss training:  29.440850667655468 Time :  5447
accuracy train: 0.970918 val: 0.691849 test: 0.705417
max validation accuracy : 0.711730 max acc epoch : 22 test accuracy : 0.704427
Counter({1: 2819, 2: 2793, 0: 1788})

Epoch :  38 loss training:  27.834608294069767 Time :  5493
accuracy train: 0.973020 val: 0.685885 test: 0.706159
max validation accuracy : 0.711730 max acc epoch : 22 test accuracy : 0.704427
Counter({0: 2813, 2: 2797, 1: 1790})

========================================================================================================================================================================================================
best acc epoch :  22
validation accuracy :  0.7117296222664016
test accuracy :  0.7044274053920356
last test_accuracy :  0.7061587929755132
second best val :  0.709741550695825
second best test :  0.6893395993074449
max gap 12
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  50 	 val_accuracy : 0.74950 	 test_accuracy : 0.70195 	 last test_accuracy : 0.70369 	 second best val : 0.74751 	 second best test : 0.70369
k :  1 	 best_acc epoch :  22 	 val_accuracy : 0.71173 	 test_accuracy : 0.70443 	 last test_accuracy : 0.70616 	 second best val : 0.70974 	 second best test : 0.68934

avg :  	 val_accuracy : 0.73062 	 test_accuracy : 0.70319 	 last_accuracy : 0.70492 	 second best val : 0.72863 	 second best test : 0.69651

std :  	 val_accuracy : 0.01889 	 test_accuracy : 0.00124 	 last_accuracy : 0.00124 	 second best val : 0.01889 	 second best test : 0.00717


date and time :  Wed Jun 16 03:31:49 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=15, epochs=300, hidden_dim=100, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=361, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({0: 2596, 2: 2547, 1: 2257})

Epoch :  1 loss training:  232.7188422679901 Time :  101
accuracy train: 0.620182 val: 0.542744 test: 0.574821
max validation accuracy : 0.542744 max acc epoch : 1 test accuracy : 0.574821
Counter({2: 3161, 1: 2501, 0: 1738})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  147.89881175756454 Time :  160
accuracy train: 0.708830 val: 0.610338 test: 0.643334
max validation accuracy : 0.610338 max acc epoch : 2 test accuracy : 0.643334
Counter({1: 3184, 0: 2555, 2: 1661})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  124.7327521443367 Time :  213
accuracy train: 0.732306 val: 0.636183 test: 0.651744
max validation accuracy : 0.636183 max acc epoch : 3 test accuracy : 0.651744
Counter({2: 3251, 1: 2495, 0: 1654})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  104.4194727241993 Time :  263
accuracy train: 0.782060 val: 0.628231 test: 0.678704
max validation accuracy : 0.636183 max acc epoch : 3 test accuracy : 0.651744
Counter({0: 3238, 2: 2498, 1: 1664})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  96.94555768370628 Time :  309
accuracy train: 0.794674 val: 0.636183 test: 0.688103
max validation accuracy : 0.636183 max acc epoch : 3 test accuracy : 0.651744
Counter({2: 3281, 1: 2498, 0: 1621})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  92.47997382283211 Time :  358
accuracy train: 0.805186 val: 0.648111 test: 0.688598
max validation accuracy : 0.648111 max acc epoch : 6 test accuracy : 0.688598
Counter({0: 3274, 1: 2517, 2: 1609})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  81.34177538752556 Time :  406
accuracy train: 0.823406 val: 0.634195 test: 0.694781
max validation accuracy : 0.648111 max acc epoch : 6 test accuracy : 0.688598
Counter({2: 3271, 1: 2504, 0: 1625})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  79.96576231718063 Time :  449
accuracy train: 0.832866 val: 0.636183 test: 0.698491
max validation accuracy : 0.648111 max acc epoch : 6 test accuracy : 0.688598
Counter({2: 3281, 0: 2498, 1: 1621})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  77.11619395017624 Time :  487
accuracy train: 0.839173 val: 0.650099 test: 0.694534
max validation accuracy : 0.650099 max acc epoch : 9 test accuracy : 0.694534
Counter({1: 3276, 0: 2505, 2: 1619})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  71.21820919215679 Time :  540
accuracy train: 0.847582 val: 0.646123 test: 0.702943
max validation accuracy : 0.650099 max acc epoch : 9 test accuracy : 0.694534
Counter({1: 3268, 2: 2517, 0: 1615})

Epoch :  11 loss training:  70.35768616199493 Time :  578
accuracy train: 0.854590 val: 0.646123 test: 0.705911
max validation accuracy : 0.650099 max acc epoch : 9 test accuracy : 0.694534
Counter({1: 3280, 2: 2508, 0: 1612})

Epoch :  12 loss training:  69.09009400010109 Time :  634
accuracy train: 0.867554 val: 0.648111 test: 0.707148
max validation accuracy : 0.650099 max acc epoch : 9 test accuracy : 0.694534
Counter({2: 3288, 1: 2499, 0: 1613})

Epoch :  13 loss training:  65.97878822684288 Time :  685
accuracy train: 0.869657 val: 0.642147 test: 0.706653
max validation accuracy : 0.650099 max acc epoch : 9 test accuracy : 0.694534
Counter({2: 3273, 1: 2518, 0: 1609})

Epoch :  14 loss training:  63.04903990030289 Time :  735
accuracy train: 0.876664 val: 0.646123 test: 0.712095
max validation accuracy : 0.650099 max acc epoch : 9 test accuracy : 0.694534
Counter({2: 3284, 1: 2512, 0: 1604})

Epoch :  15 loss training:  59.58627139031887 Time :  786
accuracy train: 0.879818 val: 0.648111 test: 0.714321
max validation accuracy : 0.650099 max acc epoch : 9 test accuracy : 0.694534
Counter({2: 3283, 0: 2505, 1: 1612})

Epoch :  16 loss training:  57.14983381330967 Time :  831
accuracy train: 0.895936 val: 0.652087 test: 0.708385
max validation accuracy : 0.652087 max acc epoch : 16 test accuracy : 0.708385
Counter({2: 3287, 0: 2500, 1: 1613})

Epoch :  17 loss training:  54.228277802467346 Time :  877
accuracy train: 0.901542 val: 0.652087 test: 0.715063
max validation accuracy : 0.652087 max acc epoch : 16 test accuracy : 0.708385
Counter({0: 3289, 2: 2492, 1: 1619})

Epoch :  18 loss training:  53.34821420907974 Time :  929
accuracy train: 0.905046 val: 0.648111 test: 0.712837
max validation accuracy : 0.652087 max acc epoch : 16 test accuracy : 0.708385
Counter({0: 3277, 1: 2507, 2: 1616})

Epoch :  19 loss training:  49.84950239956379 Time :  983
accuracy train: 0.917309 val: 0.652087 test: 0.713826
max validation accuracy : 0.652087 max acc epoch : 16 test accuracy : 0.708385
Counter({1: 3279, 0: 2510, 2: 1611})

Epoch :  20 loss training:  49.12235891819 Time :  1032
accuracy train: 0.922915 val: 0.660040 test: 0.714074
max validation accuracy : 0.660040 max acc epoch : 20 test accuracy : 0.714074
Counter({2: 3288, 0: 2510, 1: 1602})

Epoch :  21 loss training:  44.23218656331301 Time :  1088
accuracy train: 0.931675 val: 0.658052 test: 0.713579
max validation accuracy : 0.660040 max acc epoch : 20 test accuracy : 0.714074
Counter({0: 3288, 1: 2509, 2: 1603})

Epoch :  22 loss training:  41.35032398253679 Time :  1145
accuracy train: 0.941836 val: 0.667992 test: 0.714568
max validation accuracy : 0.667992 max acc epoch : 22 test accuracy : 0.714568
Counter({1: 3290, 2: 2515, 0: 1595})

Epoch :  23 loss training:  40.48229628801346 Time :  1200
accuracy train: 0.951296 val: 0.673956 test: 0.710116
max validation accuracy : 0.673956 max acc epoch : 23 test accuracy : 0.710116
Counter({1: 3287, 2: 2525, 0: 1588})

Epoch :  24 loss training:  39.98102759569883 Time :  1252
accuracy train: 0.956202 val: 0.654076 test: 0.712590
max validation accuracy : 0.673956 max acc epoch : 23 test accuracy : 0.710116
Counter({0: 3280, 2: 2538, 1: 1582})

Epoch :  25 loss training:  36.64529523253441 Time :  1306
accuracy train: 0.953048 val: 0.656064 test: 0.712837
max validation accuracy : 0.673956 max acc epoch : 23 test accuracy : 0.710116
Counter({0: 3272, 2: 2547, 1: 1581})

Epoch :  26 loss training:  34.948089472949505 Time :  1363
accuracy train: 0.959005 val: 0.662028 test: 0.714321
max validation accuracy : 0.673956 max acc epoch : 23 test accuracy : 0.710116
Counter({1: 3275, 2: 2549, 0: 1576})

Epoch :  27 loss training:  33.42525504529476 Time :  1427
accuracy train: 0.960757 val: 0.666004 test: 0.715063
max validation accuracy : 0.673956 max acc epoch : 23 test accuracy : 0.710116
Counter({1: 3270, 0: 2540, 2: 1590})

Epoch :  28 loss training:  31.758998304605484 Time :  1480
accuracy train: 0.971969 val: 0.673956 test: 0.712837
max validation accuracy : 0.673956 max acc epoch : 23 test accuracy : 0.710116
Counter({1: 3283, 0: 2539, 2: 1578})

Epoch :  29 loss training:  29.93206225335598 Time :  1521
accuracy train: 0.978626 val: 0.664016 test: 0.712342
max validation accuracy : 0.673956 max acc epoch : 23 test accuracy : 0.710116
Counter({1: 3278, 0: 2542, 2: 1580})

Epoch :  30 loss training:  27.205088064074516 Time :  1563
accuracy train: 0.981079 val: 0.671968 test: 0.713826
max validation accuracy : 0.673956 max acc epoch : 23 test accuracy : 0.710116
Counter({1: 3266, 2: 2558, 0: 1576})

Epoch :  31 loss training:  25.19352461397648 Time :  1602
accuracy train: 0.979327 val: 0.658052 test: 0.711848
max validation accuracy : 0.673956 max acc epoch : 23 test accuracy : 0.710116
Counter({1: 3263, 2: 2575, 0: 1562})

Epoch :  32 loss training:  24.506856486201286 Time :  1636
accuracy train: 0.980729 val: 0.673956 test: 0.714321
max validation accuracy : 0.673956 max acc epoch : 23 test accuracy : 0.710116
Counter({0: 3286, 2: 2559, 1: 1555})

Epoch :  33 loss training:  23.195837568491697 Time :  1689
accuracy train: 0.984233 val: 0.660040 test: 0.712342
max validation accuracy : 0.673956 max acc epoch : 23 test accuracy : 0.710116
Counter({0: 3316, 1: 2536, 2: 1548})

Epoch :  34 loss training:  21.458470333367586 Time :  1729
accuracy train: 0.986685 val: 0.666004 test: 0.717289
max validation accuracy : 0.673956 max acc epoch : 23 test accuracy : 0.710116
Counter({1: 3310, 2: 2550, 0: 1540})

Epoch :  35 loss training:  19.070371437817812 Time :  1767
accuracy train: 0.989138 val: 0.662028 test: 0.711600
max validation accuracy : 0.673956 max acc epoch : 23 test accuracy : 0.710116
Counter({0: 3326, 1: 2540, 2: 1534})

Epoch :  36 loss training:  19.61059010401368 Time :  1818
accuracy train: 0.991240 val: 0.667992 test: 0.711848
max validation accuracy : 0.673956 max acc epoch : 23 test accuracy : 0.710116
Counter({1: 3336, 2: 2535, 0: 1529})

Epoch :  37 loss training:  19.03254800476134 Time :  1873
accuracy train: 0.992642 val: 0.662028 test: 0.713826
max validation accuracy : 0.673956 max acc epoch : 23 test accuracy : 0.710116
Counter({1: 3300, 2: 2573, 0: 1527})

Epoch :  38 loss training:  15.695799618959427 Time :  1925
accuracy train: 0.993693 val: 0.671968 test: 0.712095
max validation accuracy : 0.673956 max acc epoch : 23 test accuracy : 0.710116
Counter({0: 3290, 2: 2577, 1: 1533})

Epoch :  39 loss training:  16.902714744210243 Time :  1982
accuracy train: 0.995445 val: 0.673956 test: 0.710116
max validation accuracy : 0.673956 max acc epoch : 23 test accuracy : 0.710116
Counter({0: 3320, 1: 2554, 2: 1526})

========================================================================================================================================================================================================
best acc epoch :  23
validation accuracy :  0.6739562624254473
test accuracy :  0.7101162503091764
last test_accuracy :  0.7101162503091764
second best val :  0.6719681908548708
second best test :  0.7101162503091764
max gap 7
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=15, epochs=300, hidden_dim=100, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=127, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 2604, 0: 2534, 2: 2262})

Epoch :  1 loss training:  230.80973625183105 Time :  2088
accuracy train: 0.639103 val: 0.578529 test: 0.601781
max validation accuracy : 0.578529 max acc epoch : 1 test accuracy : 0.601781
Counter({2: 3641, 1: 1998, 0: 1761})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  149.54812693595886 Time :  2145
accuracy train: 0.709180 val: 0.638171 test: 0.641850
max validation accuracy : 0.638171 max acc epoch : 2 test accuracy : 0.641850
Counter({0: 2691, 2: 2613, 1: 2096})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  125.36114865541458 Time :  2211
accuracy train: 0.740014 val: 0.652087 test: 0.673015
max validation accuracy : 0.652087 max acc epoch : 3 test accuracy : 0.673015
Counter({0: 2644, 1: 2626, 2: 2130})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  104.37891864776611 Time :  2265
accuracy train: 0.769096 val: 0.644135 test: 0.687856
max validation accuracy : 0.652087 max acc epoch : 3 test accuracy : 0.673015
Counter({1: 2820, 2: 2362, 0: 2218})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  98.13213804364204 Time :  2314
accuracy train: 0.790119 val: 0.660040 test: 0.698491
max validation accuracy : 0.660040 max acc epoch : 5 test accuracy : 0.698491
Counter({0: 2701, 2: 2484, 1: 2215})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  91.64534220099449 Time :  2372
accuracy train: 0.803434 val: 0.662028 test: 0.695770
max validation accuracy : 0.662028 max acc epoch : 6 test accuracy : 0.695770
Counter({0: 2695, 1: 2529, 2: 2176})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  82.47378930449486 Time :  2422
accuracy train: 0.818851 val: 0.658052 test: 0.700965
max validation accuracy : 0.662028 max acc epoch : 6 test accuracy : 0.695770
Counter({0: 2606, 1: 2568, 2: 2226})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  78.2297934293747 Time :  2476
accuracy train: 0.838472 val: 0.669980 test: 0.702696
max validation accuracy : 0.669980 max acc epoch : 8 test accuracy : 0.702696
Counter({2: 2590, 0: 2574, 1: 2236})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  77.57744431495667 Time :  2528
accuracy train: 0.844429 val: 0.681909 test: 0.704675
max validation accuracy : 0.681909 max acc epoch : 9 test accuracy : 0.704675
Counter({2: 2628, 0: 2596, 1: 2176})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  72.36697007715702 Time :  2590
accuracy train: 0.852838 val: 0.687873 test: 0.706653
max validation accuracy : 0.687873 max acc epoch : 10 test accuracy : 0.706653
Counter({1: 2630, 2: 2560, 0: 2210})

Epoch :  11 loss training:  70.5670598000288 Time :  2648
accuracy train: 0.858795 val: 0.666004 test: 0.709127
max validation accuracy : 0.687873 max acc epoch : 10 test accuracy : 0.706653
Counter({2: 2619, 0: 2575, 1: 2206})

Epoch :  12 loss training:  67.83439134061337 Time :  2695
accuracy train: 0.862999 val: 0.679920 test: 0.707643
max validation accuracy : 0.687873 max acc epoch : 10 test accuracy : 0.706653
Counter({1: 2626, 0: 2563, 2: 2211})

Epoch :  13 loss training:  64.30243436992168 Time :  2741
accuracy train: 0.870708 val: 0.673956 test: 0.706653
max validation accuracy : 0.687873 max acc epoch : 10 test accuracy : 0.706653
Counter({1: 2638, 2: 2560, 0: 2202})

Epoch :  14 loss training:  62.34678350389004 Time :  2792
accuracy train: 0.867905 val: 0.671968 test: 0.707148
max validation accuracy : 0.687873 max acc epoch : 10 test accuracy : 0.706653
Counter({2: 2656, 1: 2547, 0: 2197})

Epoch :  15 loss training:  59.773812368512154 Time :  2835
accuracy train: 0.887176 val: 0.673956 test: 0.714321
max validation accuracy : 0.687873 max acc epoch : 10 test accuracy : 0.706653
Counter({2: 2639, 1: 2588, 0: 2173})

Epoch :  16 loss training:  56.428074181079865 Time :  2885
accuracy train: 0.893833 val: 0.677932 test: 0.713579
max validation accuracy : 0.687873 max acc epoch : 10 test accuracy : 0.706653
Counter({2: 2636, 1: 2592, 0: 2172})

Epoch :  17 loss training:  53.37900325655937 Time :  2935
accuracy train: 0.904695 val: 0.677932 test: 0.711353
max validation accuracy : 0.687873 max acc epoch : 10 test accuracy : 0.706653
Counter({1: 2635, 0: 2633, 2: 2132})

Epoch :  18 loss training:  52.2820608317852 Time :  2996
accuracy train: 0.905746 val: 0.671968 test: 0.715558
max validation accuracy : 0.687873 max acc epoch : 10 test accuracy : 0.706653
Counter({2: 2653, 1: 2553, 0: 2194})

Epoch :  19 loss training:  51.087287217378616 Time :  3054
accuracy train: 0.921163 val: 0.689861 test: 0.717289
max validation accuracy : 0.689861 max acc epoch : 19 test accuracy : 0.717289
Counter({1: 2654, 0: 2550, 2: 2196})

Epoch :  20 loss training:  45.42799923568964 Time :  3118
accuracy train: 0.925368 val: 0.683897 test: 0.716052
max validation accuracy : 0.689861 max acc epoch : 19 test accuracy : 0.717289
Counter({0: 2651, 1: 2555, 2: 2194})

Epoch :  21 loss training:  44.864596389234066 Time :  3174
accuracy train: 0.929222 val: 0.677932 test: 0.716052
max validation accuracy : 0.689861 max acc epoch : 19 test accuracy : 0.717289
Counter({2: 2635, 1: 2559, 0: 2206})

Epoch :  22 loss training:  41.84619737416506 Time :  3233
accuracy train: 0.934828 val: 0.691849 test: 0.715063
max validation accuracy : 0.691849 max acc epoch : 22 test accuracy : 0.715063
Counter({0: 2636, 2: 2582, 1: 2182})

Epoch :  23 loss training:  39.90447807312012 Time :  3282
accuracy train: 0.937281 val: 0.689861 test: 0.718526
max validation accuracy : 0.691849 max acc epoch : 22 test accuracy : 0.715063
Counter({0: 2628, 2: 2627, 1: 2145})

Epoch :  24 loss training:  38.50236098468304 Time :  3336
accuracy train: 0.942887 val: 0.677932 test: 0.717042
max validation accuracy : 0.691849 max acc epoch : 22 test accuracy : 0.715063
Counter({0: 2674, 1: 2620, 2: 2106})

Epoch :  25 loss training:  35.524911403656006 Time :  3386
accuracy train: 0.951296 val: 0.679920 test: 0.715310
max validation accuracy : 0.691849 max acc epoch : 22 test accuracy : 0.715063
Counter({1: 2687, 2: 2619, 0: 2094})

Epoch :  26 loss training:  36.27113851159811 Time :  3430
accuracy train: 0.956202 val: 0.701789 test: 0.716052
max validation accuracy : 0.701789 max acc epoch : 26 test accuracy : 0.716052
Counter({2: 2688, 1: 2618, 0: 2094})

Epoch :  27 loss training:  33.37910458445549 Time :  3471
accuracy train: 0.959355 val: 0.685885 test: 0.713332
max validation accuracy : 0.701789 max acc epoch : 26 test accuracy : 0.716052
Counter({2: 2692, 1: 2631, 0: 2077})

Epoch :  28 loss training:  31.293982289731503 Time :  3506
accuracy train: 0.966013 val: 0.693837 test: 0.717042
max validation accuracy : 0.701789 max acc epoch : 26 test accuracy : 0.716052
Counter({1: 2700, 0: 2612, 2: 2088})

Epoch :  29 loss training:  29.403385531157255 Time :  3552
accuracy train: 0.972320 val: 0.689861 test: 0.713826
max validation accuracy : 0.701789 max acc epoch : 26 test accuracy : 0.716052
Counter({1: 2684, 2: 2648, 0: 2068})

Epoch :  30 loss training:  27.830830283463 Time :  3598
accuracy train: 0.970918 val: 0.697813 test: 0.716300
max validation accuracy : 0.701789 max acc epoch : 26 test accuracy : 0.716052
Counter({1: 2689, 2: 2653, 0: 2058})

Epoch :  31 loss training:  25.551499601453543 Time :  3645
accuracy train: 0.975473 val: 0.697813 test: 0.717536
max validation accuracy : 0.701789 max acc epoch : 26 test accuracy : 0.716052
Counter({0: 2673, 1: 2652, 2: 2075})

Epoch :  32 loss training:  23.09240150079131 Time :  3700
accuracy train: 0.980729 val: 0.689861 test: 0.714816
max validation accuracy : 0.701789 max acc epoch : 26 test accuracy : 0.716052
Counter({0: 2690, 2: 2612, 1: 2098})

Epoch :  33 loss training:  22.490986712276936 Time :  3753
accuracy train: 0.982130 val: 0.683897 test: 0.709869
max validation accuracy : 0.701789 max acc epoch : 26 test accuracy : 0.716052
Counter({1: 2670, 0: 2644, 2: 2086})

Epoch :  34 loss training:  21.238367650657892 Time :  3803
accuracy train: 0.986685 val: 0.693837 test: 0.714074
max validation accuracy : 0.701789 max acc epoch : 26 test accuracy : 0.716052
Counter({2: 2663, 1: 2643, 0: 2094})

Epoch :  35 loss training:  21.060660306364298 Time :  3848
accuracy train: 0.989488 val: 0.687873 test: 0.711848
max validation accuracy : 0.701789 max acc epoch : 26 test accuracy : 0.716052
Counter({2: 2678, 1: 2623, 0: 2099})

Epoch :  36 loss training:  19.02853276953101 Time :  3902
accuracy train: 0.992292 val: 0.695825 test: 0.712837
max validation accuracy : 0.701789 max acc epoch : 26 test accuracy : 0.716052
Counter({2: 2653, 1: 2643, 0: 2104})

Epoch :  37 loss training:  17.543129608035088 Time :  3947
accuracy train: 0.991591 val: 0.677932 test: 0.714816
max validation accuracy : 0.701789 max acc epoch : 26 test accuracy : 0.716052
Counter({0: 2677, 2: 2641, 1: 2082})

Epoch :  38 loss training:  16.84646064043045 Time :  3996
accuracy train: 0.994744 val: 0.707753 test: 0.711848
max validation accuracy : 0.707753 max acc epoch : 38 test accuracy : 0.711848
Counter({0: 2692, 2: 2657, 1: 2051})

Epoch :  39 loss training:  15.858393918722868 Time :  4028
accuracy train: 0.991591 val: 0.685885 test: 0.713332
max validation accuracy : 0.707753 max acc epoch : 38 test accuracy : 0.711848
Counter({0: 2718, 1: 2632, 2: 2050})

Epoch :  40 loss training:  15.384449802339077 Time :  4075
accuracy train: 0.994744 val: 0.693837 test: 0.713826
max validation accuracy : 0.707753 max acc epoch : 38 test accuracy : 0.711848
Counter({0: 2730, 2: 2632, 1: 2038})

Epoch :  41 loss training:  14.733405655249953 Time :  4128
accuracy train: 0.994744 val: 0.699801 test: 0.713826
max validation accuracy : 0.707753 max acc epoch : 38 test accuracy : 0.711848
Counter({1: 2707, 0: 2619, 2: 2074})

Epoch :  42 loss training:  12.184879632666707 Time :  4172
accuracy train: 0.997197 val: 0.691849 test: 0.710116
max validation accuracy : 0.707753 max acc epoch : 38 test accuracy : 0.711848
Counter({2: 2733, 1: 2642, 0: 2025})

Epoch :  43 loss training:  12.86012733541429 Time :  4218
accuracy train: 0.998248 val: 0.689861 test: 0.707395
max validation accuracy : 0.707753 max acc epoch : 38 test accuracy : 0.711848
Counter({2: 2735, 0: 2653, 1: 2012})

Epoch :  44 loss training:  11.66713541187346 Time :  4264
accuracy train: 0.998598 val: 0.683897 test: 0.712837
max validation accuracy : 0.707753 max acc epoch : 38 test accuracy : 0.711848
Counter({1: 2719, 0: 2664, 2: 2017})

Epoch :  45 loss training:  11.318834207952023 Time :  4323
accuracy train: 0.998949 val: 0.681909 test: 0.713084
max validation accuracy : 0.707753 max acc epoch : 38 test accuracy : 0.711848
Counter({2: 2738, 1: 2649, 0: 2013})

Epoch :  46 loss training:  10.404169773682952 Time :  4377
accuracy train: 0.998598 val: 0.691849 test: 0.710116
max validation accuracy : 0.707753 max acc epoch : 38 test accuracy : 0.711848
Counter({2: 2736, 1: 2642, 0: 2022})

Epoch :  47 loss training:  9.95993410423398 Time :  4432
accuracy train: 0.999299 val: 0.689861 test: 0.709622
max validation accuracy : 0.707753 max acc epoch : 38 test accuracy : 0.711848
Counter({1: 2750, 0: 2621, 2: 2029})

Epoch :  48 loss training:  9.788990566506982 Time :  4480
accuracy train: 0.998248 val: 0.681909 test: 0.711600
max validation accuracy : 0.707753 max acc epoch : 38 test accuracy : 0.711848
Counter({1: 2736, 2: 2563, 0: 2101})

Epoch :  49 loss training:  8.105996428057551 Time :  4532
accuracy train: 0.998949 val: 0.691849 test: 0.711106
max validation accuracy : 0.707753 max acc epoch : 38 test accuracy : 0.711848
Counter({1: 2726, 0: 2575, 2: 2099})

Epoch :  50 loss training:  8.444164225831628 Time :  4591
accuracy train: 0.999299 val: 0.697813 test: 0.710364
max validation accuracy : 0.707753 max acc epoch : 38 test accuracy : 0.711848
Counter({1: 2740, 0: 2555, 2: 2105})

Epoch :  51 loss training:  7.670997750945389 Time :  4645
accuracy train: 0.999299 val: 0.683897 test: 0.708632
max validation accuracy : 0.707753 max acc epoch : 38 test accuracy : 0.711848
Counter({1: 2720, 0: 2545, 2: 2135})

Epoch :  52 loss training:  7.00744816288352 Time :  4690
accuracy train: 0.999650 val: 0.685885 test: 0.710858
max validation accuracy : 0.707753 max acc epoch : 38 test accuracy : 0.711848
Counter({2: 2742, 0: 2513, 1: 2145})

Epoch :  53 loss training:  6.899114963598549 Time :  4724
accuracy train: 0.999299 val: 0.681909 test: 0.713579
max validation accuracy : 0.707753 max acc epoch : 38 test accuracy : 0.711848
Counter({1: 2767, 0: 2534, 2: 2099})

Epoch :  54 loss training:  6.890531321056187 Time :  4764
accuracy train: 0.999650 val: 0.695825 test: 0.713332
max validation accuracy : 0.707753 max acc epoch : 38 test accuracy : 0.711848
Counter({1: 2780, 0: 2595, 2: 2025})

========================================================================================================================================================================================================
best acc epoch :  38
validation accuracy :  0.7077534791252486
test accuracy :  0.7118476378926539
last test_accuracy :  0.7133316843927776
second best val :  0.7017892644135189
second best test :  0.7160524363096711
max gap 12
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  23 	 val_accuracy : 0.67396 	 test_accuracy : 0.71012 	 last test_accuracy : 0.71012 	 second best val : 0.67197 	 second best test : 0.71012
k :  1 	 best_acc epoch :  38 	 val_accuracy : 0.70775 	 test_accuracy : 0.71185 	 last test_accuracy : 0.71333 	 second best val : 0.70179 	 second best test : 0.71605

avg :  	 val_accuracy : 0.69085 	 test_accuracy : 0.71098 	 last_accuracy : 0.71172 	 second best val : 0.68688 	 second best test : 0.71308

std :  	 val_accuracy : 0.01690 	 test_accuracy : 0.00087 	 last_accuracy : 0.00161 	 second best val : 0.01491 	 second best test : 0.00297


date and time :  Wed Jun 16 04:51:53 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=15, epochs=300, hidden_dim=300, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=946, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 2604, 2: 2534, 0: 2262})

Epoch :  1 loss training:  212.51190829277039 Time :  75
accuracy train: 0.658725 val: 0.662028 test: 0.622558
max validation accuracy : 0.662028 max acc epoch : 1 test accuracy : 0.622558
Counter({1: 2998, 0: 2560, 2: 1842})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  147.49277067184448 Time :  138
accuracy train: 0.707078 val: 0.667992 test: 0.651991
max validation accuracy : 0.667992 max acc epoch : 2 test accuracy : 0.651991
Counter({0: 2988, 1: 2747, 2: 1665})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  125.97639948129654 Time :  196
accuracy train: 0.762088 val: 0.705765 test: 0.675736
max validation accuracy : 0.705765 max acc epoch : 3 test accuracy : 0.675736
Counter({0: 3744, 2: 2077, 1: 1579})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  95.63115110993385 Time :  252
accuracy train: 0.795025 val: 0.685885 test: 0.680930
max validation accuracy : 0.705765 max acc epoch : 3 test accuracy : 0.675736
Counter({1: 3093, 2: 2729, 0: 1578})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  86.62017557024956 Time :  311
accuracy train: 0.838122 val: 0.717694 test: 0.693544
max validation accuracy : 0.717694 max acc epoch : 5 test accuracy : 0.693544
Counter({0: 3148, 2: 2688, 1: 1564})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  81.39061623811722 Time :  350
accuracy train: 0.848283 val: 0.711730 test: 0.696760
max validation accuracy : 0.717694 max acc epoch : 5 test accuracy : 0.693544
Counter({0: 3075, 2: 2768, 1: 1557})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.85212141275406 Time :  393
accuracy train: 0.865802 val: 0.737575 test: 0.698244
max validation accuracy : 0.737575 max acc epoch : 7 test accuracy : 0.698244
Counter({0: 3070, 2: 2778, 1: 1552})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  67.179916664958 Time :  447
accuracy train: 0.872810 val: 0.717694 test: 0.705911
max validation accuracy : 0.737575 max acc epoch : 7 test accuracy : 0.698244
Counter({2: 3143, 0: 2691, 1: 1566})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  60.437255188822746 Time :  516
accuracy train: 0.902242 val: 0.745527 test: 0.710116
max validation accuracy : 0.745527 max acc epoch : 9 test accuracy : 0.710116
Counter({2: 3181, 0: 2681, 1: 1538})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  54.10351663827896 Time :  563
accuracy train: 0.902943 val: 0.735586 test: 0.714321
max validation accuracy : 0.745527 max acc epoch : 9 test accuracy : 0.710116
Counter({0: 2974, 2: 2384, 1: 2042})

Epoch :  11 loss training:  52.56905360519886 Time :  631
accuracy train: 0.920463 val: 0.741551 test: 0.712095
max validation accuracy : 0.745527 max acc epoch : 9 test accuracy : 0.710116
Counter({2: 3178, 0: 2698, 1: 1524})

Epoch :  12 loss training:  47.65791495889425 Time :  695
accuracy train: 0.924317 val: 0.743539 test: 0.710611
max validation accuracy : 0.745527 max acc epoch : 9 test accuracy : 0.710116
Counter({0: 3013, 1: 2349, 2: 2038})

Epoch :  13 loss training:  44.431442216038704 Time :  763
accuracy train: 0.935179 val: 0.741551 test: 0.711600
max validation accuracy : 0.745527 max acc epoch : 9 test accuracy : 0.710116
Counter({0: 3230, 2: 2661, 1: 1509})

Epoch :  14 loss training:  42.54841424524784 Time :  837
accuracy train: 0.939033 val: 0.737575 test: 0.719763
max validation accuracy : 0.745527 max acc epoch : 9 test accuracy : 0.710116
Counter({1: 3204, 2: 2694, 0: 1502})

Epoch :  15 loss training:  38.2068922445178 Time :  908
accuracy train: 0.948143 val: 0.733598 test: 0.714321
max validation accuracy : 0.745527 max acc epoch : 9 test accuracy : 0.710116
Counter({0: 3902, 1: 1995, 2: 1503})

Epoch :  16 loss training:  36.554027274250984 Time :  968
accuracy train: 0.950946 val: 0.755467 test: 0.716052
max validation accuracy : 0.755467 max acc epoch : 16 test accuracy : 0.716052
Counter({1: 3310, 0: 2611, 2: 1479})

Epoch :  17 loss training:  34.859255772084 Time :  1022
accuracy train: 0.967765 val: 0.741551 test: 0.717042
max validation accuracy : 0.755467 max acc epoch : 16 test accuracy : 0.716052
Counter({2: 3861, 1: 2009, 0: 1530})

Epoch :  18 loss training:  33.05366651713848 Time :  1082
accuracy train: 0.966363 val: 0.733598 test: 0.715310
max validation accuracy : 0.755467 max acc epoch : 16 test accuracy : 0.716052
Counter({0: 3272, 2: 2660, 1: 1468})

Epoch :  19 loss training:  29.026032768189907 Time :  1141
accuracy train: 0.966013 val: 0.733598 test: 0.716794
max validation accuracy : 0.755467 max acc epoch : 16 test accuracy : 0.716052
Counter({0: 3301, 1: 2626, 2: 1473})

Epoch :  20 loss training:  27.90134648606181 Time :  1180
accuracy train: 0.973721 val: 0.737575 test: 0.719268
max validation accuracy : 0.755467 max acc epoch : 16 test accuracy : 0.716052
Counter({2: 3415, 1: 2523, 0: 1462})

Epoch :  21 loss training:  26.646549567580223 Time :  1233
accuracy train: 0.979678 val: 0.737575 test: 0.720257
max validation accuracy : 0.755467 max acc epoch : 16 test accuracy : 0.716052
Counter({1: 3305, 0: 2636, 2: 1459})

Epoch :  22 loss training:  24.024211559444666 Time :  1291
accuracy train: 0.985284 val: 0.747515 test: 0.716794
max validation accuracy : 0.755467 max acc epoch : 16 test accuracy : 0.716052
Counter({2: 3317, 0: 2631, 1: 1452})

Epoch :  23 loss training:  21.302325014024973 Time :  1356
accuracy train: 0.984933 val: 0.743539 test: 0.712590
max validation accuracy : 0.755467 max acc epoch : 16 test accuracy : 0.716052
Counter({2: 3288, 1: 2657, 0: 1455})

Epoch :  24 loss training:  20.450411178171635 Time :  1426
accuracy train: 0.988788 val: 0.749503 test: 0.720257
max validation accuracy : 0.755467 max acc epoch : 16 test accuracy : 0.716052
Counter({1: 3403, 2: 2535, 0: 1462})

Epoch :  25 loss training:  20.552407708019018 Time :  1488
accuracy train: 0.989488 val: 0.735586 test: 0.716547
max validation accuracy : 0.755467 max acc epoch : 16 test accuracy : 0.716052
Counter({1: 3383, 0: 2559, 2: 1458})

Epoch :  26 loss training:  17.117891293019056 Time :  1547
accuracy train: 0.994394 val: 0.733598 test: 0.719021
max validation accuracy : 0.755467 max acc epoch : 16 test accuracy : 0.716052
Counter({0: 3430, 2: 2530, 1: 1440})

Epoch :  27 loss training:  16.385265935212374 Time :  1613
accuracy train: 0.994043 val: 0.743539 test: 0.720010
max validation accuracy : 0.755467 max acc epoch : 16 test accuracy : 0.716052
Counter({2: 3587, 0: 2313, 1: 1500})

Epoch :  28 loss training:  14.68770131841302 Time :  1673
accuracy train: 0.994394 val: 0.739563 test: 0.718526
max validation accuracy : 0.755467 max acc epoch : 16 test accuracy : 0.716052
Counter({1: 3426, 0: 2528, 2: 1446})

Epoch :  29 loss training:  14.15692938491702 Time :  1720
accuracy train: 0.991941 val: 0.737575 test: 0.710858
max validation accuracy : 0.755467 max acc epoch : 16 test accuracy : 0.716052
Counter({1: 3335, 0: 2622, 2: 1443})

Epoch :  30 loss training:  12.690860329195857 Time :  1770
accuracy train: 0.994043 val: 0.743539 test: 0.711848
max validation accuracy : 0.755467 max acc epoch : 16 test accuracy : 0.716052
Counter({1: 3392, 2: 2561, 0: 1447})

Epoch :  31 loss training:  12.084976384416223 Time :  1837
accuracy train: 0.996146 val: 0.747515 test: 0.719268
max validation accuracy : 0.755467 max acc epoch : 16 test accuracy : 0.716052
Counter({0: 3389, 1: 2553, 2: 1458})

Epoch :  32 loss training:  11.430215280503035 Time :  1915
accuracy train: 0.999299 val: 0.733598 test: 0.715310
max validation accuracy : 0.755467 max acc epoch : 16 test accuracy : 0.716052
Counter({2: 3450, 1: 2508, 0: 1442})

========================================================================================================================================================================================================
best acc epoch :  16
validation accuracy :  0.7554671968190855
test accuracy :  0.7160524363096711
last test_accuracy :  0.7153104130596092
second best val :  0.7495029821073559
second best test :  0.7160524363096711
max gap 7
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=15, epochs=300, hidden_dim=300, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=299, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({2: 2608, 1: 2527, 0: 2265})

Epoch :  1 loss training:  211.4923324584961 Time :  2066
accuracy train: 0.655221 val: 0.626243 test: 0.625773
max validation accuracy : 0.626243 max acc epoch : 1 test accuracy : 0.625773
Counter({2: 2847, 0: 2623, 1: 1930})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  147.85253620147705 Time :  2121
accuracy train: 0.703924 val: 0.640159 test: 0.628988
max validation accuracy : 0.640159 max acc epoch : 2 test accuracy : 0.628988
Counter({2: 3260, 0: 2226, 1: 1914})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  127.43340626358986 Time :  2162
accuracy train: 0.770498 val: 0.699801 test: 0.664605
max validation accuracy : 0.699801 max acc epoch : 3 test accuracy : 0.664605
Counter({0: 2581, 1: 2523, 2: 2296})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  94.24088451266289 Time :  2212
accuracy train: 0.817800 val: 0.723658 test: 0.682909
max validation accuracy : 0.723658 max acc epoch : 4 test accuracy : 0.682909
Counter({2: 2966, 0: 2502, 1: 1932})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  85.28604888916016 Time :  2267
accuracy train: 0.818851 val: 0.695825 test: 0.687856
max validation accuracy : 0.723658 max acc epoch : 4 test accuracy : 0.682909
Counter({2: 3169, 0: 2305, 1: 1926})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  82.37963029742241 Time :  2326
accuracy train: 0.841626 val: 0.691849 test: 0.691566
max validation accuracy : 0.723658 max acc epoch : 4 test accuracy : 0.682909
Counter({0: 2691, 1: 2383, 2: 2326})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.74633277952671 Time :  2379
accuracy train: 0.883322 val: 0.741551 test: 0.705169
max validation accuracy : 0.741551 max acc epoch : 7 test accuracy : 0.705169
Counter({1: 2734, 0: 2354, 2: 2312})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  61.86727227270603 Time :  2434
accuracy train: 0.884022 val: 0.731610 test: 0.710116
max validation accuracy : 0.741551 max acc epoch : 7 test accuracy : 0.705169
Counter({0: 3259, 2: 2241, 1: 1900})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  58.80556720495224 Time :  2492
accuracy train: 0.891381 val: 0.733598 test: 0.704427
max validation accuracy : 0.741551 max acc epoch : 7 test accuracy : 0.705169
Counter({0: 3186, 1: 2264, 2: 1950})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  52.814157009124756 Time :  2561
accuracy train: 0.915557 val: 0.745527 test: 0.713579
max validation accuracy : 0.745527 max acc epoch : 10 test accuracy : 0.713579
Counter({0: 3266, 1: 2196, 2: 1938})

Epoch :  11 loss training:  49.772986471652985 Time :  2627
accuracy train: 0.919061 val: 0.735586 test: 0.711106
max validation accuracy : 0.745527 max acc epoch : 10 test accuracy : 0.713579
Counter({1: 3225, 2: 2212, 0: 1963})

Epoch :  12 loss training:  47.981606528162956 Time :  2687
accuracy train: 0.927821 val: 0.749503 test: 0.717289
max validation accuracy : 0.749503 max acc epoch : 12 test accuracy : 0.717289
Counter({1: 3226, 2: 2231, 0: 1943})

Epoch :  13 loss training:  41.706709302961826 Time :  2756
accuracy train: 0.936230 val: 0.745527 test: 0.719268
max validation accuracy : 0.749503 max acc epoch : 12 test accuracy : 0.717289
Counter({1: 2748, 2: 2399, 0: 2253})

Epoch :  14 loss training:  42.184792041778564 Time :  2805
accuracy train: 0.952698 val: 0.743539 test: 0.717289
max validation accuracy : 0.749503 max acc epoch : 12 test accuracy : 0.717289
Counter({0: 2736, 1: 2429, 2: 2235})

Epoch :  15 loss training:  39.86017682403326 Time :  2862
accuracy train: 0.955151 val: 0.741551 test: 0.719268
max validation accuracy : 0.749503 max acc epoch : 12 test accuracy : 0.717289
Counter({1: 2752, 0: 2468, 2: 2180})

Epoch :  16 loss training:  35.61171145737171 Time :  2924
accuracy train: 0.960757 val: 0.751491 test: 0.712342
max validation accuracy : 0.751491 max acc epoch : 16 test accuracy : 0.712342
Counter({1: 2784, 2: 2434, 0: 2182})

Epoch :  17 loss training:  33.70636294782162 Time :  2989
accuracy train: 0.968465 val: 0.743539 test: 0.716052
max validation accuracy : 0.751491 max acc epoch : 16 test accuracy : 0.712342
Counter({1: 3329, 0: 2162, 2: 1909})

Epoch :  18 loss training:  31.927514895796776 Time :  3050
accuracy train: 0.973371 val: 0.751491 test: 0.711848
max validation accuracy : 0.751491 max acc epoch : 16 test accuracy : 0.712342
Counter({0: 2760, 2: 2505, 1: 2135})

Epoch :  19 loss training:  28.86913899332285 Time :  3106
accuracy train: 0.977225 val: 0.767396 test: 0.715558
max validation accuracy : 0.767396 max acc epoch : 19 test accuracy : 0.715558
Counter({1: 2742, 0: 2535, 2: 2123})

Epoch :  20 loss training:  26.462807908654213 Time :  3169
accuracy train: 0.978977 val: 0.741551 test: 0.711848
max validation accuracy : 0.767396 max acc epoch : 19 test accuracy : 0.715558
Counter({1: 2709, 0: 2588, 2: 2103})

Epoch :  21 loss training:  25.37573655694723 Time :  3229
accuracy train: 0.981780 val: 0.751491 test: 0.717536
max validation accuracy : 0.767396 max acc epoch : 19 test accuracy : 0.715558
Counter({0: 2728, 2: 2576, 1: 2096})

Epoch :  22 loss training:  23.17654401436448 Time :  3296
accuracy train: 0.982130 val: 0.755467 test: 0.710611
max validation accuracy : 0.767396 max acc epoch : 19 test accuracy : 0.715558
Counter({2: 2739, 0: 2573, 1: 2088})

Epoch :  23 loss training:  21.441561844199896 Time :  3360
accuracy train: 0.988087 val: 0.753479 test: 0.711848
max validation accuracy : 0.767396 max acc epoch : 19 test accuracy : 0.715558
Counter({1: 3348, 2: 2095, 0: 1957})

Epoch :  24 loss training:  20.152795488014817 Time :  3404
accuracy train: 0.989138 val: 0.731610 test: 0.712837
max validation accuracy : 0.767396 max acc epoch : 19 test accuracy : 0.715558
Counter({2: 3355, 0: 2065, 1: 1980})

Epoch :  25 loss training:  17.741124782711267 Time :  3466
accuracy train: 0.992992 val: 0.759443 test: 0.713332
max validation accuracy : 0.767396 max acc epoch : 19 test accuracy : 0.715558
Counter({0: 3325, 1: 2060, 2: 2015})

Epoch :  26 loss training:  17.153285576030612 Time :  3532
accuracy train: 0.995795 val: 0.747515 test: 0.715310
max validation accuracy : 0.767396 max acc epoch : 19 test accuracy : 0.715558
Counter({0: 3352, 1: 2044, 2: 2004})

Epoch :  27 loss training:  15.39498845487833 Time :  3589
accuracy train: 0.997547 val: 0.747515 test: 0.715558
max validation accuracy : 0.767396 max acc epoch : 19 test accuracy : 0.715558
Counter({0: 3349, 1: 2047, 2: 2004})

Epoch :  28 loss training:  13.597783487290144 Time :  3653
accuracy train: 0.995445 val: 0.749503 test: 0.719763
max validation accuracy : 0.767396 max acc epoch : 19 test accuracy : 0.715558
Counter({0: 3337, 2: 2070, 1: 1993})

Epoch :  29 loss training:  12.921205390244722 Time :  3704
accuracy train: 0.998598 val: 0.739563 test: 0.715805
max validation accuracy : 0.767396 max acc epoch : 19 test accuracy : 0.715558
Counter({0: 3320, 1: 2073, 2: 2007})

Epoch :  30 loss training:  13.22885593213141 Time :  3762
accuracy train: 0.998248 val: 0.743539 test: 0.720010
max validation accuracy : 0.767396 max acc epoch : 19 test accuracy : 0.715558
Counter({0: 3397, 2: 2006, 1: 1997})

Epoch :  31 loss training:  11.893928318284452 Time :  3825
accuracy train: 0.998949 val: 0.745527 test: 0.716052
max validation accuracy : 0.767396 max acc epoch : 19 test accuracy : 0.715558
Counter({2: 3399, 1: 2015, 0: 1986})

Epoch :  32 loss training:  9.958143001422286 Time :  3891
accuracy train: 0.998598 val: 0.741551 test: 0.714321
max validation accuracy : 0.767396 max acc epoch : 19 test accuracy : 0.715558
Counter({2: 3435, 1: 1989, 0: 1976})

Epoch :  33 loss training:  10.479254372417927 Time :  3961
accuracy train: 0.998949 val: 0.743539 test: 0.715805
max validation accuracy : 0.767396 max acc epoch : 19 test accuracy : 0.715558
Counter({1: 3397, 2: 2020, 0: 1983})

Epoch :  34 loss training:  9.92577775940299 Time :  4025
accuracy train: 0.999299 val: 0.741551 test: 0.721741
max validation accuracy : 0.767396 max acc epoch : 19 test accuracy : 0.715558
Counter({1: 3444, 0: 1988, 2: 1968})

Epoch :  35 loss training:  9.038967173546553 Time :  4080
accuracy train: 1.000000 val: 0.733598 test: 0.713579
max validation accuracy : 0.767396 max acc epoch : 19 test accuracy : 0.715558
Counter({0: 3448, 1: 1984, 2: 1968})

========================================================================================================================================================================================================
best acc epoch :  19
validation accuracy :  0.7673956262425448
test accuracy :  0.7155577541429632
last test_accuracy :  0.7135790254761316
second best val :  0.7594433399602386
second best test :  0.7155577541429632
max gap 4
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  16 	 val_accuracy : 0.75547 	 test_accuracy : 0.71605 	 last test_accuracy : 0.71531 	 second best val : 0.74950 	 second best test : 0.71605
k :  1 	 best_acc epoch :  19 	 val_accuracy : 0.76740 	 test_accuracy : 0.71556 	 last test_accuracy : 0.71358 	 second best val : 0.75944 	 second best test : 0.71556

avg :  	 val_accuracy : 0.76143 	 test_accuracy : 0.71581 	 last_accuracy : 0.71444 	 second best val : 0.75447 	 second best test : 0.71581

std :  	 val_accuracy : 0.00596 	 test_accuracy : 0.00025 	 last_accuracy : 0.00087 	 second best val : 0.00497 	 second best test : 0.00025
