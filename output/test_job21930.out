date and time :  Thu Jan  7 11:50:16 2021
Namespace(batch_size=32, dataset='R52', debug=False, device=0, dropout=0.4, early_stop=30, epochs=400, filename='', hidden_dim=200, lr=0.0005, num_layers=3, num_mlp_layers=2, seed=0, weight_decay=1e-06)
device :  cuda:0
min_len_of_sentence : 0
max_len_of_sentence : 453
min_num_of_sentence : 1
max_num_of_sentence : 43
average_len_of_sentence: 15.948564209083706
average_num_of_sentence: 5.114895947426068
Total_num_of_sentence : 46699
Counter({'earn': 3923, 'acq': 2292, 'crude': 374, 'trade': 326, 'money-fx': 309, 'interest': 272, 'money-supply': 151, 'ship': 144, 'sugar': 122, 'coffee': 112, 'gold': 90, 'gnp': 74, 'cpi': 71, 'cocoa': 61, 'grain': 51, 'alum': 50, 'reserves': 49, 'jobs': 49, 'ipi': 45, 'copper': 44, 'rubber': 40, 'iron-steel': 38, 'nat-gas': 36, 'bop': 31, 'veg-oil': 30, 'tin': 27, 'cotton': 24, 'wpi': 23, 'livestock': 22, 'orange': 22, 'retail': 20, 'pet-chem': 19, 'gas': 18, 'housing': 17, 'strategic-metal': 15, 'lei': 14, 'lumber': 14, 'zinc': 13, 'income': 11, 'meal-feed': 11, 'carcass': 11, 'fuel': 11, 'heat': 10, 'lead': 8, 'instal-debt': 6, 'dlr': 6, 'tea': 5, 'potato': 5, 'nickel': 4, 'cpu': 4, 'platinum': 3, 'jet': 3})
Total_number_of_words: 9334
Total_number_of_categories: 52
vocab size : 9333
got embeddings of : 8713
Epoch :  1 loss training:  577.0030914545059 Time :  64
accuracy train: 0.740854 val: 0.716463 test: 0.778210
max validation accuracy : 0.7164634146341463 max acc epoch : 1 test accuracy : 0.7782101167315175

Epoch :  2 loss training:  312.4059833884239 Time :  75
accuracy train: 0.807165 val: 0.788110 test: 0.823346
max validation accuracy : 0.788109756097561 max acc epoch : 2 test accuracy : 0.8233463035019455

Epoch :  3 loss training:  203.58635522425175 Time :  86
accuracy train: 0.836700 val: 0.812500 test: 0.852140
max validation accuracy : 0.8125 max acc epoch : 3 test accuracy : 0.8521400778210116

Epoch :  4 loss training:  139.7558963522315 Time :  97
accuracy train: 0.860899 val: 0.829268 test: 0.864591
max validation accuracy : 0.8292682926829268 max acc epoch : 4 test accuracy : 0.864591439688716

Epoch :  5 loss training:  132.447319958359 Time :  107
accuracy train: 0.864901 val: 0.839939 test: 0.875097
max validation accuracy : 0.8399390243902439 max acc epoch : 5 test accuracy : 0.8750972762645914

Epoch :  6 loss training:  92.37174369394779 Time :  118
accuracy train: 0.866616 val: 0.827744 test: 0.866148
max validation accuracy : 0.8399390243902439 max acc epoch : 5 test accuracy : 0.8750972762645914

Epoch :  7 loss training:  75.31783974170685 Time :  129
accuracy train: 0.899009 val: 0.857470 test: 0.887160
max validation accuracy : 0.8574695121951219 max acc epoch : 7 test accuracy : 0.8871595330739299

Epoch :  8 loss training:  66.02302166819572 Time :  140
accuracy train: 0.921303 val: 0.885671 test: 0.901946
max validation accuracy : 0.885670731707317 max acc epoch : 8 test accuracy : 0.9019455252918288

Epoch :  9 loss training:  41.972129207104445 Time :  151
accuracy train: 0.927020 val: 0.879573 test: 0.892996
max validation accuracy : 0.885670731707317 max acc epoch : 8 test accuracy : 0.9019455252918288

Epoch :  10 loss training:  42.56641584075987 Time :  162
accuracy train: 0.902058 val: 0.853659 test: 0.888327
max validation accuracy : 0.885670731707317 max acc epoch : 8 test accuracy : 0.9019455252918288

Epoch :  11 loss training:  41.67403153702617 Time :  172
accuracy train: 0.920160 val: 0.876524 test: 0.895720
max validation accuracy : 0.885670731707317 max acc epoch : 8 test accuracy : 0.9019455252918288

Epoch :  12 loss training:  30.5011691134423 Time :  183
accuracy train: 0.943216 val: 0.889482 test: 0.907782
max validation accuracy : 0.8894817073170732 max acc epoch : 12 test accuracy : 0.9077821011673152

Epoch :  13 loss training:  29.659935678355396 Time :  194
accuracy train: 0.925877 val: 0.877287 test: 0.904280
max validation accuracy : 0.8894817073170732 max acc epoch : 12 test accuracy : 0.9077821011673152

Epoch :  14 loss training:  31.09395140502602 Time :  205
accuracy train: 0.950838 val: 0.894817 test: 0.907393
max validation accuracy : 0.8948170731707317 max acc epoch : 14 test accuracy : 0.9073929961089494

Epoch :  15 loss training:  30.517808912321925 Time :  216
accuracy train: 0.962271 val: 0.908537 test: 0.922957
max validation accuracy : 0.9085365853658537 max acc epoch : 15 test accuracy : 0.9229571984435798

Epoch :  16 loss training:  19.672749317251146 Time :  227
accuracy train: 0.959604 val: 0.904726 test: 0.917121
max validation accuracy : 0.9085365853658537 max acc epoch : 15 test accuracy : 0.9229571984435798

Epoch :  17 loss training:  14.49174135667272 Time :  238
accuracy train: 0.969131 val: 0.907774 test: 0.918677
max validation accuracy : 0.9085365853658537 max acc epoch : 15 test accuracy : 0.9229571984435798

Epoch :  18 loss training:  18.002062687883154 Time :  248
accuracy train: 0.965511 val: 0.897104 test: 0.917899
max validation accuracy : 0.9085365853658537 max acc epoch : 15 test accuracy : 0.9229571984435798

Epoch :  19 loss training:  13.541019946336746 Time :  259
accuracy train: 0.974085 val: 0.910823 test: 0.922179
max validation accuracy : 0.9108231707317073 max acc epoch : 19 test accuracy : 0.9221789883268483

Epoch :  20 loss training:  9.560943706310354 Time :  270
accuracy train: 0.979040 val: 0.915396 test: 0.922957
max validation accuracy : 0.9153963414634146 max acc epoch : 20 test accuracy : 0.9229571984435798

Epoch :  21 loss training:  12.490895427763462 Time :  281
accuracy train: 0.943026 val: 0.895579 test: 0.905837
max validation accuracy : 0.9153963414634146 max acc epoch : 20 test accuracy : 0.9229571984435798

Epoch :  22 loss training:  13.77728709159419 Time :  292
accuracy train: 0.972752 val: 0.899390 test: 0.915564
max validation accuracy : 0.9153963414634146 max acc epoch : 20 test accuracy : 0.9229571984435798

Epoch :  23 loss training:  6.751132406061515 Time :  303
accuracy train: 0.984947 val: 0.916921 test: 0.929961
max validation accuracy : 0.916920731707317 max acc epoch : 23 test accuracy : 0.9299610894941635

Epoch :  24 loss training:  7.5963925793766975 Time :  313
accuracy train: 0.988758 val: 0.917683 test: 0.922179
max validation accuracy : 0.9176829268292683 max acc epoch : 24 test accuracy : 0.9221789883268483

Epoch :  25 loss training:  6.61157259833999 Time :  324
accuracy train: 0.985709 val: 0.919970 test: 0.930350
max validation accuracy : 0.9199695121951219 max acc epoch : 25 test accuracy : 0.9303501945525292

Epoch :  26 loss training:  11.973546630702913 Time :  335
accuracy train: 0.974848 val: 0.905488 test: 0.908949
max validation accuracy : 0.9199695121951219 max acc epoch : 25 test accuracy : 0.9303501945525292

Epoch :  27 loss training:  7.940362677909434 Time :  346
accuracy train: 0.983613 val: 0.917683 test: 0.921401
max validation accuracy : 0.9199695121951219 max acc epoch : 25 test accuracy : 0.9303501945525292

Epoch :  28 loss training:  5.996697808499448 Time :  357
accuracy train: 0.987233 val: 0.917683 test: 0.926848
max validation accuracy : 0.9199695121951219 max acc epoch : 25 test accuracy : 0.9303501945525292

Epoch :  29 loss training:  4.947497327812016 Time :  368
accuracy train: 0.986280 val: 0.914634 test: 0.923735
max validation accuracy : 0.9199695121951219 max acc epoch : 25 test accuracy : 0.9303501945525292

Epoch :  30 loss training:  5.2925858257949585 Time :  379
accuracy train: 0.990473 val: 0.920732 test: 0.922568
max validation accuracy : 0.9207317073170732 max acc epoch : 30 test accuracy : 0.9225680933852141

Epoch :  31 loss training:  5.765307209017919 Time :  389
accuracy train: 0.990282 val: 0.915396 test: 0.926070
max validation accuracy : 0.9207317073170732 max acc epoch : 30 test accuracy : 0.9225680933852141

Epoch :  32 loss training:  4.280045628285734 Time :  400
accuracy train: 0.994093 val: 0.922256 test: 0.929183
max validation accuracy : 0.9222560975609756 max acc epoch : 32 test accuracy : 0.9291828793774319

Epoch :  33 loss training:  5.650193679728545 Time :  411
accuracy train: 0.990854 val: 0.910061 test: 0.921012
max validation accuracy : 0.9222560975609756 max acc epoch : 32 test accuracy : 0.9291828793774319

Epoch :  34 loss training:  2.8998595642042346 Time :  422
accuracy train: 0.992569 val: 0.923018 test: 0.923735
max validation accuracy : 0.9230182926829268 max acc epoch : 34 test accuracy : 0.9237354085603113

Epoch :  35 loss training:  2.717241326288786 Time :  433
accuracy train: 0.992378 val: 0.923780 test: 0.928794
max validation accuracy : 0.9237804878048781 max acc epoch : 35 test accuracy : 0.9287937743190662

Epoch :  36 loss training:  9.437600288263639 Time :  443
accuracy train: 0.993521 val: 0.921494 test: 0.921401
max validation accuracy : 0.9237804878048781 max acc epoch : 35 test accuracy : 0.9287937743190662

Epoch :  37 loss training:  2.462708560284227 Time :  454
accuracy train: 0.995046 val: 0.920732 test: 0.922957
max validation accuracy : 0.9237804878048781 max acc epoch : 35 test accuracy : 0.9287937743190662

Epoch :  38 loss training:  2.1281400489388034 Time :  465
accuracy train: 0.995998 val: 0.923780 test: 0.925681
max validation accuracy : 0.9237804878048781 max acc epoch : 35 test accuracy : 0.9287937743190662

Epoch :  39 loss training:  2.3746986615878996 Time :  476
accuracy train: 0.994474 val: 0.911585 test: 0.914008
max validation accuracy : 0.9237804878048781 max acc epoch : 35 test accuracy : 0.9287937743190662

Epoch :  40 loss training:  4.68306997657055 Time :  487
accuracy train: 0.990473 val: 0.915396 test: 0.918288
max validation accuracy : 0.9237804878048781 max acc epoch : 35 test accuracy : 0.9287937743190662

Epoch :  41 loss training:  5.832892051781528 Time :  498
accuracy train: 0.994855 val: 0.916159 test: 0.924903
max validation accuracy : 0.9237804878048781 max acc epoch : 35 test accuracy : 0.9287937743190662

Epoch :  42 loss training:  2.6660046072356636 Time :  509
accuracy train: 0.995998 val: 0.922256 test: 0.921401
max validation accuracy : 0.9237804878048781 max acc epoch : 35 test accuracy : 0.9287937743190662

Epoch :  43 loss training:  2.7178637476463336 Time :  519
accuracy train: 0.996761 val: 0.918445 test: 0.927626
max validation accuracy : 0.9237804878048781 max acc epoch : 35 test accuracy : 0.9287937743190662

Epoch :  44 loss training:  2.788332110052579 Time :  530
accuracy train: 0.993902 val: 0.918445 test: 0.922957
max validation accuracy : 0.9237804878048781 max acc epoch : 35 test accuracy : 0.9287937743190662

Epoch :  45 loss training:  10.06139331922168 Time :  541
accuracy train: 0.990854 val: 0.907012 test: 0.908949
max validation accuracy : 0.9237804878048781 max acc epoch : 35 test accuracy : 0.9287937743190662

Epoch :  46 loss training:  8.792553935141768 Time :  552
accuracy train: 0.988377 val: 0.912348 test: 0.917121
max validation accuracy : 0.9237804878048781 max acc epoch : 35 test accuracy : 0.9287937743190662

Epoch :  47 loss training:  13.089197475812398 Time :  563
accuracy train: 0.991044 val: 0.910823 test: 0.919455
max validation accuracy : 0.9237804878048781 max acc epoch : 35 test accuracy : 0.9287937743190662

Epoch :  48 loss training:  7.608253012003843 Time :  574
accuracy train: 0.990282 val: 0.905488 test: 0.909339
max validation accuracy : 0.9237804878048781 max acc epoch : 35 test accuracy : 0.9287937743190662

Epoch :  49 loss training:  11.039567610801896 Time :  585
accuracy train: 0.992188 val: 0.913872 test: 0.915953
max validation accuracy : 0.9237804878048781 max acc epoch : 35 test accuracy : 0.9287937743190662

Epoch :  50 loss training:  4.4667836958833504 Time :  596
accuracy train: 0.995808 val: 0.919207 test: 0.921012
max validation accuracy : 0.9237804878048781 max acc epoch : 35 test accuracy : 0.9287937743190662

Epoch :  51 loss training:  2.527653093522531 Time :  606
accuracy train: 0.996761 val: 0.920732 test: 0.924514
max validation accuracy : 0.9237804878048781 max acc epoch : 35 test accuracy : 0.9287937743190662

Epoch :  52 loss training:  1.768284947029315 Time :  617
accuracy train: 0.997332 val: 0.918445 test: 0.922568
max validation accuracy : 0.9237804878048781 max acc epoch : 35 test accuracy : 0.9287937743190662

Epoch :  53 loss training:  1.1227107348386198 Time :  628
accuracy train: 0.999047 val: 0.923780 test: 0.925681
max validation accuracy : 0.9237804878048781 max acc epoch : 35 test accuracy : 0.9287937743190662

Epoch :  54 loss training:  0.826335843783454 Time :  639
accuracy train: 0.998857 val: 0.923018 test: 0.927626
max validation accuracy : 0.9237804878048781 max acc epoch : 35 test accuracy : 0.9287937743190662

Epoch :  55 loss training:  1.3698186870897189 Time :  650
accuracy train: 0.997904 val: 0.923780 test: 0.923346
max validation accuracy : 0.9237804878048781 max acc epoch : 35 test accuracy : 0.9287937743190662

Epoch :  56 loss training:  0.8006869621167425 Time :  661
accuracy train: 0.998285 val: 0.924543 test: 0.924903
max validation accuracy : 0.9245426829268293 max acc epoch : 56 test accuracy : 0.9249027237354086

Epoch :  57 loss training:  1.474863682182331 Time :  672
accuracy train: 0.998666 val: 0.921494 test: 0.926459
max validation accuracy : 0.9245426829268293 max acc epoch : 56 test accuracy : 0.9249027237354086

Epoch :  58 loss training:  1.635622915415297 Time :  683
accuracy train: 0.996570 val: 0.919207 test: 0.925681
max validation accuracy : 0.9245426829268293 max acc epoch : 56 test accuracy : 0.9249027237354086

Epoch :  59 loss training:  1.1037493125259061 Time :  693
accuracy train: 0.998666 val: 0.924543 test: 0.924125
max validation accuracy : 0.9245426829268293 max acc epoch : 56 test accuracy : 0.9249027237354086

Epoch :  60 loss training:  2.1929825212064316 Time :  704
accuracy train: 0.998857 val: 0.923780 test: 0.926459
max validation accuracy : 0.9245426829268293 max acc epoch : 56 test accuracy : 0.9249027237354086

Epoch :  61 loss training:  1.365104103970225 Time :  715
accuracy train: 0.999047 val: 0.926829 test: 0.928405
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  62 loss training:  1.3716427664840012 Time :  726
accuracy train: 0.994665 val: 0.915396 test: 0.914397
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  63 loss training:  0.9936364418481389 Time :  737
accuracy train: 0.998666 val: 0.919970 test: 0.921401
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  64 loss training:  1.0591027011287224 Time :  747
accuracy train: 0.997523 val: 0.923780 test: 0.918288
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  65 loss training:  1.1666969836005592 Time :  758
accuracy train: 0.997523 val: 0.919207 test: 0.918677
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  66 loss training:  2.312841998791555 Time :  769
accuracy train: 0.998285 val: 0.921494 test: 0.917510
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  67 loss training:  10.531458598026802 Time :  780
accuracy train: 0.993140 val: 0.912348 test: 0.911673
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  68 loss training:  6.266068930970505 Time :  791
accuracy train: 0.995617 val: 0.913872 test: 0.914786
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  69 loss training:  2.732191883085761 Time :  801
accuracy train: 0.997523 val: 0.913872 test: 0.909728
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  70 loss training:  1.9300317440065555 Time :  812
accuracy train: 0.995427 val: 0.913872 test: 0.907782
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  71 loss training:  1.0170469681397662 Time :  823
accuracy train: 0.998666 val: 0.919970 test: 0.915175
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  72 loss training:  0.9127158805276849 Time :  834
accuracy train: 0.998476 val: 0.919207 test: 0.915175
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  73 loss training:  0.7562969758582767 Time :  845
accuracy train: 0.997904 val: 0.916921 test: 0.918677
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  74 loss training:  0.6912977024985594 Time :  856
accuracy train: 0.999047 val: 0.918445 test: 0.921790
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  75 loss training:  0.8399824927109876 Time :  865
accuracy train: 0.998857 val: 0.918445 test: 0.917121
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  76 loss training:  0.6174261864871369 Time :  874
accuracy train: 0.999238 val: 0.921494 test: 0.922568
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  77 loss training:  0.5439528328897723 Time :  883
accuracy train: 0.999047 val: 0.919970 test: 0.919844
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  78 loss training:  0.573977591192488 Time :  893
accuracy train: 0.999428 val: 0.917683 test: 0.918677
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  79 loss training:  0.7412297803493857 Time :  902
accuracy train: 0.999047 val: 0.917683 test: 0.923735
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  80 loss training:  0.7809778585797176 Time :  911
accuracy train: 0.999428 val: 0.922256 test: 0.918677
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  81 loss training:  0.42926623775201733 Time :  922
accuracy train: 0.999428 val: 0.920732 test: 0.921401
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  82 loss training:  0.3452793315464078 Time :  933
accuracy train: 0.997523 val: 0.917683 test: 0.924514
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  83 loss training:  0.4944757586454216 Time :  944
accuracy train: 0.998857 val: 0.919970 test: 0.922957
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  84 loss training:  0.4450047142127005 Time :  954
accuracy train: 0.998857 val: 0.923018 test: 0.922568
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  85 loss training:  0.48164267804259 Time :  965
accuracy train: 0.999238 val: 0.922256 test: 0.920233
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  86 loss training:  0.7212782145388701 Time :  976
accuracy train: 0.999238 val: 0.919207 test: 0.923735
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  87 loss training:  0.47877782107752864 Time :  987
accuracy train: 0.999238 val: 0.922256 test: 0.925681
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  88 loss training:  1.694192166929497 Time :  998
accuracy train: 0.996189 val: 0.912348 test: 0.904669
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  89 loss training:  4.5313062702989555 Time :  1008
accuracy train: 0.997332 val: 0.921494 test: 0.923735
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  90 loss training:  4.677616641052737 Time :  1020
accuracy train: 0.995998 val: 0.913110 test: 0.913619
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  91 loss training:  6.411703155543364 Time :  1030
accuracy train: 0.997523 val: 0.914634 test: 0.914397
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

Epoch :  92 loss training:  3.092241058981017 Time :  1041
accuracy train: 0.990282 val: 0.909299 test: 0.905447
max validation accuracy : 0.926829268292683 max acc epoch : 61 test accuracy : 0.9284046692607004

========================================================================================================================================================================================================
max acc epoch :  61
max validation accuracy :  0.926829268292683
test accuracy :  0.9284046692607004
latest_test_accuracy :  0.9054474708171206
========================================================================================================================================================================================================

