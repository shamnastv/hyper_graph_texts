

date and time :  Tue Jun  8 23:34:18 2021
itr : 0
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.5, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=996, weight_decay=0)
device :  cuda:0
Counter({1: 3513, 0: 3067, 2: 2550})

Epoch :  1 loss training:  192.16885796189308 Time :  221
accuracy train: 0.875000 val: 0.876524 test: 0.873541
max validation accuracy : 0.876524 max acc epoch : 1 test accuracy : 0.873541
Counter({2: 3164, 0: 3163, 1: 2803})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  89.12552236765623 Time :  257
accuracy train: 0.916159 val: 0.910061 test: 0.892996
max validation accuracy : 0.910061 max acc epoch : 2 test accuracy : 0.892996
Counter({0: 3203, 2: 3119, 1: 2808})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  67.96166722849011 Time :  316
accuracy train: 0.944275 val: 0.917683 test: 0.926848
max validation accuracy : 0.917683 max acc epoch : 3 test accuracy : 0.926848
Counter({1: 3213, 2: 3104, 0: 2813})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  35.06502489652485 Time :  359
accuracy train: 0.964770 val: 0.923780 test: 0.928405
max validation accuracy : 0.923780 max acc epoch : 4 test accuracy : 0.928405
Counter({1: 3211, 0: 3103, 2: 2816})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  29.780358457006514 Time :  413
accuracy train: 0.977134 val: 0.940549 test: 0.932685
max validation accuracy : 0.940549 max acc epoch : 5 test accuracy : 0.932685
Counter({2: 3213, 0: 3106, 1: 2811})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  25.645759919425473 Time :  459
accuracy train: 0.978489 val: 0.931402 test: 0.936965
max validation accuracy : 0.940549 max acc epoch : 5 test accuracy : 0.932685
Counter({1: 3218, 0: 3102, 2: 2810})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  19.54205361707136 Time :  513
accuracy train: 0.984756 val: 0.939024 test: 0.943969
max validation accuracy : 0.940549 max acc epoch : 5 test accuracy : 0.932685
Counter({1: 3214, 0: 3105, 2: 2811})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  16.014089912641793 Time :  566
accuracy train: 0.984079 val: 0.928354 test: 0.935409
max validation accuracy : 0.940549 max acc epoch : 5 test accuracy : 0.932685
Counter({1: 3216, 0: 3105, 2: 2809})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  14.895194076932967 Time :  608
accuracy train: 0.987297 val: 0.939024 test: 0.937354
max validation accuracy : 0.940549 max acc epoch : 5 test accuracy : 0.932685
Counter({1: 3215, 0: 3104, 2: 2811})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  13.155755877261981 Time :  651
accuracy train: 0.990176 val: 0.940549 test: 0.945525
max validation accuracy : 0.940549 max acc epoch : 5 test accuracy : 0.932685
Counter({2: 3214, 0: 3105, 1: 2811})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  10.82949165487662 Time :  699
accuracy train: 0.990515 val: 0.939024 test: 0.942412
max validation accuracy : 0.940549 max acc epoch : 5 test accuracy : 0.932685
Counter({2: 3212, 1: 3108, 0: 2810})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  12.58275115583092 Time :  752
accuracy train: 0.990176 val: 0.939024 test: 0.947082
max validation accuracy : 0.940549 max acc epoch : 5 test accuracy : 0.932685
Counter({0: 3212, 1: 3108, 2: 2810})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  10.624658238724805 Time :  795
accuracy train: 0.992039 val: 0.940549 test: 0.942412
max validation accuracy : 0.940549 max acc epoch : 5 test accuracy : 0.932685
Counter({0: 3210, 1: 3110, 2: 2810})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  9.581933904439211 Time :  822
accuracy train: 0.991701 val: 0.940549 test: 0.946304
max validation accuracy : 0.940549 max acc epoch : 5 test accuracy : 0.932685
Counter({1: 3211, 0: 3108, 2: 2811})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  9.833040869561955 Time :  871
accuracy train: 0.992039 val: 0.943598 test: 0.946693
max validation accuracy : 0.943598 max acc epoch : 15 test accuracy : 0.946693
Counter({1: 3211, 2: 3108, 0: 2811})

Epoch :  16 loss training:  9.605230926768854 Time :  922
accuracy train: 0.992717 val: 0.943598 test: 0.945525
max validation accuracy : 0.943598 max acc epoch : 15 test accuracy : 0.946693
Counter({1: 3211, 0: 3109, 2: 2810})

Epoch :  17 loss training:  9.14866655273363 Time :  954
accuracy train: 0.992717 val: 0.945122 test: 0.944358
max validation accuracy : 0.945122 max acc epoch : 17 test accuracy : 0.944358
Counter({0: 3209, 2: 3111, 1: 2810})

Epoch :  18 loss training:  8.885320314206183 Time :  1005
accuracy train: 0.992547 val: 0.942073 test: 0.943580
max validation accuracy : 0.945122 max acc epoch : 17 test accuracy : 0.944358
Counter({2: 3209, 0: 3112, 1: 2809})

Epoch :  19 loss training:  8.150976741686463 Time :  1052
accuracy train: 0.993056 val: 0.949695 test: 0.944747
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({2: 3208, 0: 3114, 1: 2808})

Epoch :  20 loss training:  8.740228089271113 Time :  1093
accuracy train: 0.993902 val: 0.940549 test: 0.946693
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({1: 3208, 2: 3113, 0: 2809})

Epoch :  21 loss training:  7.477507029892877 Time :  1138
accuracy train: 0.993056 val: 0.942073 test: 0.947860
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({2: 3209, 1: 3111, 0: 2810})

Epoch :  22 loss training:  8.308078453643247 Time :  1189
accuracy train: 0.993225 val: 0.939024 test: 0.945136
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({0: 3207, 1: 3113, 2: 2810})

Epoch :  23 loss training:  8.144484156160615 Time :  1248
accuracy train: 0.993225 val: 0.945122 test: 0.943191
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({2: 3206, 1: 3115, 0: 2809})

Epoch :  24 loss training:  7.298796649090946 Time :  1300
accuracy train: 0.994411 val: 0.942073 test: 0.947860
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({0: 3206, 2: 3114, 1: 2810})

Epoch :  25 loss training:  7.5798094109632075 Time :  1336
accuracy train: 0.992886 val: 0.942073 test: 0.944358
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({0: 3206, 2: 3115, 1: 2809})

Epoch :  26 loss training:  7.43644235515967 Time :  1382
accuracy train: 0.994241 val: 0.935976 test: 0.948249
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({1: 3205, 0: 3116, 2: 2809})

Epoch :  27 loss training:  7.100179685046896 Time :  1426
accuracy train: 0.994072 val: 0.948171 test: 0.946304
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({1: 3205, 2: 3116, 0: 2809})

Epoch :  28 loss training:  7.374800828052685 Time :  1485
accuracy train: 0.993225 val: 0.945122 test: 0.946693
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({1: 3208, 0: 3113, 2: 2809})

Epoch :  29 loss training:  6.82313241972588 Time :  1535
accuracy train: 0.993564 val: 0.949695 test: 0.947860
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({1: 3206, 2: 3114, 0: 2810})

Epoch :  30 loss training:  6.596519557526335 Time :  1567
accuracy train: 0.993733 val: 0.940549 test: 0.945914
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({0: 3205, 1: 3115, 2: 2810})

Epoch :  31 loss training:  6.6395840547047555 Time :  1614
accuracy train: 0.994241 val: 0.943598 test: 0.950195
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({0: 3211, 1: 3109, 2: 2810})

Epoch :  32 loss training:  6.377969646593556 Time :  1672
accuracy train: 0.994072 val: 0.942073 test: 0.945136
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({1: 3212, 0: 3106, 2: 2812})

Epoch :  33 loss training:  6.523554696468636 Time :  1725
accuracy train: 0.994919 val: 0.948171 test: 0.947860
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({1: 3209, 2: 3110, 0: 2811})

Epoch :  34 loss training:  5.888673357781954 Time :  1763
accuracy train: 0.994580 val: 0.949695 test: 0.949416
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({0: 3210, 1: 3111, 2: 2809})

Epoch :  35 loss training:  6.221934976638295 Time :  1811
accuracy train: 0.994919 val: 0.948171 test: 0.949416
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({2: 3209, 1: 3110, 0: 2811})

Epoch :  36 loss training:  6.2096706186421216 Time :  1876
accuracy train: 0.995088 val: 0.948171 test: 0.947082
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({1: 3205, 0: 3113, 2: 2812})

Epoch :  37 loss training:  6.505929308477789 Time :  1926
accuracy train: 0.994241 val: 0.948171 test: 0.945914
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({1: 3205, 0: 3113, 2: 2812})

Epoch :  38 loss training:  5.813328391115647 Time :  1968
accuracy train: 0.995257 val: 0.946646 test: 0.949416
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({1: 3205, 0: 3113, 2: 2812})

Epoch :  39 loss training:  6.173786411061883 Time :  2020
accuracy train: 0.995088 val: 0.945122 test: 0.944747
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({0: 3204, 1: 3113, 2: 2813})

Epoch :  40 loss training:  5.8755353424930945 Time :  2070
accuracy train: 0.994919 val: 0.945122 test: 0.945914
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({1: 3204, 0: 3113, 2: 2813})

Epoch :  41 loss training:  5.419863554066978 Time :  2109
accuracy train: 0.995088 val: 0.946646 test: 0.946693
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({1: 3202, 2: 3116, 0: 2812})

Epoch :  42 loss training:  5.487876498722471 Time :  2158
accuracy train: 0.995257 val: 0.948171 test: 0.948249
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({1: 3200, 2: 3117, 0: 2813})

Epoch :  43 loss training:  5.550160564598627 Time :  2211
accuracy train: 0.994241 val: 0.948171 test: 0.947082
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({1: 3202, 0: 3115, 2: 2813})

Epoch :  44 loss training:  5.167461395030841 Time :  2262
accuracy train: 0.994919 val: 0.945122 test: 0.948638
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({0: 3203, 2: 3112, 1: 2815})

Epoch :  45 loss training:  5.5051080187549815 Time :  2302
accuracy train: 0.995257 val: 0.942073 test: 0.945136
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({0: 3202, 2: 3114, 1: 2814})

Epoch :  46 loss training:  4.785735961515456 Time :  2350
accuracy train: 0.995935 val: 0.946646 test: 0.947860
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({1: 3202, 0: 3113, 2: 2815})

Epoch :  47 loss training:  4.888846186338924 Time :  2406
accuracy train: 0.995257 val: 0.945122 test: 0.945914
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({2: 3201, 0: 3114, 1: 2815})

Epoch :  48 loss training:  4.895679083303548 Time :  2464
accuracy train: 0.995935 val: 0.946646 test: 0.947860
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({1: 3204, 0: 3113, 2: 2813})

Epoch :  49 loss training:  4.751676852116361 Time :  2509
accuracy train: 0.995766 val: 0.946646 test: 0.946304
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({2: 3202, 0: 3112, 1: 2816})

Epoch :  50 loss training:  4.638033005176112 Time :  2552
accuracy train: 0.995766 val: 0.945122 test: 0.945525
max validation accuracy : 0.949695 max acc epoch : 19 test accuracy : 0.944747
Counter({2: 3202, 0: 3113, 1: 2815})

========================================================================================================================================================================================================
max acc epoch :  19
max validation accuracy :  0.9496951219512195
test accuracy :  0.9447470817120622
last test_accuracy :  0.9455252918287937
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.5, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=996, weight_decay=0)
device :  cuda:0
Counter({1: 3513, 0: 3067, 2: 2550})

Epoch :  1 loss training:  191.77059198915958 Time :  2787
accuracy train: 0.877202 val: 0.876524 test: 0.873930
max validation accuracy : 0.876524 max acc epoch : 1 test accuracy : 0.873930
Counter({2: 3185, 0: 3142, 1: 2803})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  89.74475111812353 Time :  2824
accuracy train: 0.918360 val: 0.905488 test: 0.889105
max validation accuracy : 0.905488 max acc epoch : 2 test accuracy : 0.889105
Counter({0: 3199, 1: 3119, 2: 2812})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  69.18772597750649 Time :  2876
accuracy train: 0.938008 val: 0.923780 test: 0.915953
max validation accuracy : 0.923780 max acc epoch : 3 test accuracy : 0.915953
Counter({1: 3159, 2: 3155, 0: 2816})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  37.2016515750438 Time :  2929
accuracy train: 0.960366 val: 0.925305 test: 0.928405
max validation accuracy : 0.925305 max acc epoch : 4 test accuracy : 0.928405
Counter({2: 3197, 1: 3126, 0: 2807})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  30.519534911494702 Time :  2974
accuracy train: 0.977473 val: 0.934451 test: 0.937743
max validation accuracy : 0.934451 max acc epoch : 5 test accuracy : 0.937743
Counter({0: 3208, 1: 3116, 2: 2806})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  29.23049073200673 Time :  3013
accuracy train: 0.966802 val: 0.928354 test: 0.935798
max validation accuracy : 0.934451 max acc epoch : 5 test accuracy : 0.937743
Counter({1: 3217, 0: 3103, 2: 2810})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  20.80536906607449 Time :  3068
accuracy train: 0.982893 val: 0.942073 test: 0.942412
max validation accuracy : 0.942073 max acc epoch : 7 test accuracy : 0.942412
Counter({1: 3219, 2: 3101, 0: 2810})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  16.536496630404145 Time :  3119
accuracy train: 0.980014 val: 0.932927 test: 0.942023
max validation accuracy : 0.942073 max acc epoch : 7 test accuracy : 0.942412
Counter({1: 3219, 0: 3104, 2: 2807})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  14.216984850121662 Time :  3164
accuracy train: 0.987466 val: 0.942073 test: 0.939689
max validation accuracy : 0.942073 max acc epoch : 7 test accuracy : 0.942412
Counter({0: 3219, 2: 3107, 1: 2804})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  13.522768602473661 Time :  3213
accuracy train: 0.990176 val: 0.942073 test: 0.944358
max validation accuracy : 0.942073 max acc epoch : 7 test accuracy : 0.942412
Counter({2: 3219, 0: 3105, 1: 2806})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  11.159388932166621 Time :  3259
accuracy train: 0.989837 val: 0.940549 test: 0.945525
max validation accuracy : 0.942073 max acc epoch : 7 test accuracy : 0.942412
Counter({1: 3219, 2: 3105, 0: 2806})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  12.763717303052545 Time :  3304
accuracy train: 0.990515 val: 0.940549 test: 0.947082
max validation accuracy : 0.942073 max acc epoch : 7 test accuracy : 0.942412
Counter({0: 3217, 2: 3107, 1: 2806})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  10.605140744475648 Time :  3347
accuracy train: 0.991701 val: 0.939024 test: 0.945914
max validation accuracy : 0.942073 max acc epoch : 7 test accuracy : 0.942412
Counter({0: 3220, 1: 3105, 2: 2805})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  10.07561684702523 Time :  3399
accuracy train: 0.991023 val: 0.945122 test: 0.949805
max validation accuracy : 0.945122 max acc epoch : 14 test accuracy : 0.949805
Counter({0: 3220, 2: 3102, 1: 2808})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  10.055806766729802 Time :  3448
accuracy train: 0.991701 val: 0.940549 test: 0.948638
max validation accuracy : 0.945122 max acc epoch : 14 test accuracy : 0.949805
Counter({1: 3219, 2: 3104, 0: 2807})

Epoch :  16 loss training:  9.423050078330562 Time :  3498
accuracy train: 0.992717 val: 0.945122 test: 0.943969
max validation accuracy : 0.945122 max acc epoch : 14 test accuracy : 0.949805
Counter({0: 3219, 2: 3106, 1: 2805})

Epoch :  17 loss training:  9.179020092822611 Time :  3537
accuracy train: 0.992547 val: 0.940549 test: 0.947082
max validation accuracy : 0.945122 max acc epoch : 14 test accuracy : 0.949805
Counter({0: 3221, 1: 3104, 2: 2805})

Epoch :  18 loss training:  9.318136020097882 Time :  3589
accuracy train: 0.992717 val: 0.945122 test: 0.947471
max validation accuracy : 0.945122 max acc epoch : 14 test accuracy : 0.949805
Counter({0: 3221, 1: 3104, 2: 2805})

Epoch :  19 loss training:  8.281045053619891 Time :  3637
accuracy train: 0.992378 val: 0.946646 test: 0.947471
max validation accuracy : 0.946646 max acc epoch : 19 test accuracy : 0.947471
Counter({1: 3221, 0: 3105, 2: 2804})

Epoch :  20 loss training:  9.221635446418077 Time :  3692
accuracy train: 0.993056 val: 0.940549 test: 0.946304
max validation accuracy : 0.946646 max acc epoch : 19 test accuracy : 0.947471
Counter({1: 3222, 2: 3104, 0: 2804})

Epoch :  21 loss training:  7.518456677207723 Time :  3742
accuracy train: 0.993225 val: 0.945122 test: 0.950195
max validation accuracy : 0.946646 max acc epoch : 19 test accuracy : 0.947471
Counter({1: 3220, 0: 3105, 2: 2805})

Epoch :  22 loss training:  8.123813316458836 Time :  3799
accuracy train: 0.992547 val: 0.937500 test: 0.948638
max validation accuracy : 0.946646 max acc epoch : 19 test accuracy : 0.947471
Counter({1: 3218, 2: 3107, 0: 2805})

Epoch :  23 loss training:  8.123745323275216 Time :  3851
accuracy train: 0.993394 val: 0.945122 test: 0.948249
max validation accuracy : 0.946646 max acc epoch : 19 test accuracy : 0.947471
Counter({1: 3219, 0: 3106, 2: 2805})

Epoch :  24 loss training:  7.531066282419488 Time :  3902
accuracy train: 0.993902 val: 0.946646 test: 0.950195
max validation accuracy : 0.946646 max acc epoch : 19 test accuracy : 0.947471
Counter({2: 3218, 0: 3108, 1: 2804})

Epoch :  25 loss training:  8.173473918694071 Time :  3942
accuracy train: 0.993225 val: 0.943598 test: 0.946693
max validation accuracy : 0.946646 max acc epoch : 19 test accuracy : 0.947471
Counter({1: 3217, 0: 3109, 2: 2804})

Epoch :  26 loss training:  7.588375051738694 Time :  3991
accuracy train: 0.993902 val: 0.935976 test: 0.948638
max validation accuracy : 0.946646 max acc epoch : 19 test accuracy : 0.947471
Counter({1: 3218, 0: 3107, 2: 2805})

Epoch :  27 loss training:  7.12369448854588 Time :  4028
accuracy train: 0.994580 val: 0.945122 test: 0.949805
max validation accuracy : 0.946646 max acc epoch : 19 test accuracy : 0.947471
Counter({1: 3221, 2: 3105, 0: 2804})

Epoch :  28 loss training:  7.245530165266246 Time :  4073
accuracy train: 0.993902 val: 0.946646 test: 0.948249
max validation accuracy : 0.946646 max acc epoch : 19 test accuracy : 0.947471
Counter({0: 3218, 2: 3108, 1: 2804})

Epoch :  29 loss training:  6.798919972032309 Time :  4123
accuracy train: 0.994241 val: 0.949695 test: 0.949805
max validation accuracy : 0.949695 max acc epoch : 29 test accuracy : 0.949805
Counter({0: 3216, 2: 3109, 1: 2805})

Epoch :  30 loss training:  6.7236823559505865 Time :  4176
accuracy train: 0.994072 val: 0.943598 test: 0.948249
max validation accuracy : 0.949695 max acc epoch : 29 test accuracy : 0.949805
Counter({0: 3217, 2: 3108, 1: 2805})

Epoch :  31 loss training:  6.885909844888374 Time :  4230
accuracy train: 0.993902 val: 0.948171 test: 0.950195
max validation accuracy : 0.949695 max acc epoch : 29 test accuracy : 0.949805
Counter({0: 3219, 1: 3106, 2: 2805})

Epoch :  32 loss training:  6.460713987937197 Time :  4278
accuracy train: 0.994241 val: 0.946646 test: 0.947860
max validation accuracy : 0.949695 max acc epoch : 29 test accuracy : 0.949805
Counter({2: 3218, 0: 3103, 1: 2809})

Epoch :  33 loss training:  6.38533018482849 Time :  4314
accuracy train: 0.994580 val: 0.952744 test: 0.947860
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({0: 3217, 1: 3106, 2: 2807})

Epoch :  34 loss training:  5.827525815228 Time :  4359
accuracy train: 0.994749 val: 0.951220 test: 0.950195
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({1: 3217, 2: 3106, 0: 2807})

Epoch :  35 loss training:  6.208253868273459 Time :  4416
accuracy train: 0.994919 val: 0.949695 test: 0.949027
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({2: 3217, 1: 3106, 0: 2807})

Epoch :  36 loss training:  6.239432344562374 Time :  4479
accuracy train: 0.994919 val: 0.948171 test: 0.949027
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({0: 3214, 2: 3110, 1: 2806})

Epoch :  37 loss training:  6.385757368640043 Time :  4548
accuracy train: 0.994749 val: 0.949695 test: 0.948638
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({1: 3214, 0: 3109, 2: 2807})

Epoch :  38 loss training:  5.713005657191388 Time :  4612
accuracy train: 0.994919 val: 0.952744 test: 0.949416
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({2: 3214, 0: 3110, 1: 2806})

Epoch :  39 loss training:  6.200677677989006 Time :  4672
accuracy train: 0.995088 val: 0.948171 test: 0.947471
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({0: 3215, 2: 3108, 1: 2807})

Epoch :  40 loss training:  6.18820451857755 Time :  4712
accuracy train: 0.995427 val: 0.946646 test: 0.947860
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({0: 3212, 1: 3111, 2: 2807})

Epoch :  41 loss training:  5.462060562102124 Time :  4764
accuracy train: 0.995766 val: 0.946646 test: 0.949805
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({0: 3212, 2: 3111, 1: 2807})

Epoch :  42 loss training:  5.524184659472667 Time :  4822
accuracy train: 0.995596 val: 0.946646 test: 0.948638
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({2: 3210, 0: 3113, 1: 2807})

Epoch :  43 loss training:  5.697728791739792 Time :  4878
accuracy train: 0.994749 val: 0.949695 test: 0.947082
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({1: 3210, 2: 3113, 0: 2807})

Epoch :  44 loss training:  5.116524967015721 Time :  4907
accuracy train: 0.995088 val: 0.943598 test: 0.949805
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({1: 3212, 0: 3110, 2: 2808})

Epoch :  45 loss training:  5.734711162920576 Time :  4952
accuracy train: 0.995257 val: 0.943598 test: 0.947860
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({0: 3215, 1: 3107, 2: 2808})

Epoch :  46 loss training:  5.208210554672405 Time :  5009
accuracy train: 0.995596 val: 0.951220 test: 0.950973
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({1: 3216, 0: 3105, 2: 2809})

Epoch :  47 loss training:  5.022565070656128 Time :  5060
accuracy train: 0.995766 val: 0.949695 test: 0.944747
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({1: 3214, 2: 3107, 0: 2809})

Epoch :  48 loss training:  5.05522933480097 Time :  5121
accuracy train: 0.995766 val: 0.948171 test: 0.950584
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({1: 3208, 2: 3112, 0: 2810})

Epoch :  49 loss training:  5.018016174202785 Time :  5170
accuracy train: 0.995596 val: 0.948171 test: 0.949027
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({1: 3207, 2: 3115, 0: 2808})

Epoch :  50 loss training:  4.664562391350046 Time :  5215
accuracy train: 0.995935 val: 0.946646 test: 0.949027
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({1: 3207, 0: 3115, 2: 2808})

Epoch :  51 loss training:  5.130376090586651 Time :  5260
accuracy train: 0.995427 val: 0.946646 test: 0.950973
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({0: 3206, 2: 3112, 1: 2812})

Epoch :  52 loss training:  4.390153811255004 Time :  5317
accuracy train: 0.995935 val: 0.943598 test: 0.947471
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({1: 3208, 0: 3111, 2: 2811})

Epoch :  53 loss training:  4.688996019773185 Time :  5372
accuracy train: 0.995766 val: 0.946646 test: 0.947082
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({1: 3210, 0: 3108, 2: 2812})

Epoch :  54 loss training:  4.6828882764675654 Time :  5424
accuracy train: 0.995935 val: 0.945122 test: 0.949027
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({0: 3210, 2: 3112, 1: 2808})

Epoch :  55 loss training:  4.5108228618628345 Time :  5466
accuracy train: 0.995766 val: 0.948171 test: 0.949805
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({2: 3208, 1: 3112, 0: 2810})

Epoch :  56 loss training:  4.281204097322188 Time :  5497
accuracy train: 0.996274 val: 0.943598 test: 0.950584
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({1: 3208, 2: 3114, 0: 2808})

Epoch :  57 loss training:  4.292366460082121 Time :  5541
accuracy train: 0.996104 val: 0.945122 test: 0.945914
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({0: 3211, 1: 3111, 2: 2808})

Epoch :  58 loss training:  4.416233831085265 Time :  5597
accuracy train: 0.995935 val: 0.945122 test: 0.948638
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({2: 3207, 1: 3116, 0: 2807})

Epoch :  59 loss training:  4.583099485607818 Time :  5646
accuracy train: 0.996104 val: 0.948171 test: 0.947860
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({0: 3209, 1: 3113, 2: 2808})

Epoch :  60 loss training:  3.730797715630615 Time :  5696
accuracy train: 0.996104 val: 0.946646 test: 0.947471
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({0: 3207, 1: 3115, 2: 2808})

Epoch :  61 loss training:  4.057758149909205 Time :  5744
accuracy train: 0.995935 val: 0.949695 test: 0.952529
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({0: 3206, 1: 3116, 2: 2808})

Epoch :  62 loss training:  4.059939135215245 Time :  5788
accuracy train: 0.995935 val: 0.945122 test: 0.948249
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({1: 3206, 0: 3117, 2: 2807})

Epoch :  63 loss training:  3.615461998328101 Time :  5846
accuracy train: 0.995766 val: 0.946646 test: 0.946304
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({0: 3207, 2: 3115, 1: 2808})

Epoch :  64 loss training:  4.012449543457478 Time :  5899
accuracy train: 0.996274 val: 0.948171 test: 0.949805
max validation accuracy : 0.952744 max acc epoch : 33 test accuracy : 0.947860
Counter({1: 3207, 0: 3113, 2: 2810})

========================================================================================================================================================================================================
max acc epoch :  33
max validation accuracy :  0.9527439024390244
test accuracy :  0.9478599221789883
last test_accuracy :  0.9498054474708171
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.5, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=996, weight_decay=0)
device :  cuda:0
Counter({1: 3513, 0: 3067, 2: 2550})

Epoch :  1 loss training:  191.98587583005428 Time :  6078
accuracy train: 0.880589 val: 0.878049 test: 0.876654
max validation accuracy : 0.878049 max acc epoch : 1 test accuracy : 0.876654
Counter({2: 3176, 0: 3149, 1: 2805})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.95568891614676 Time :  6134
accuracy train: 0.930894 val: 0.914634 test: 0.904669
max validation accuracy : 0.914634 max acc epoch : 2 test accuracy : 0.904669
Counter({0: 3198, 2: 3121, 1: 2811})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  67.4337849766016 Time :  6191
accuracy train: 0.940041 val: 0.928354 test: 0.924903
max validation accuracy : 0.928354 max acc epoch : 3 test accuracy : 0.924903
Counter({0: 3190, 1: 3136, 2: 2804})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  38.7174684535712 Time :  6246
accuracy train: 0.969004 val: 0.925305 test: 0.936965
max validation accuracy : 0.928354 max acc epoch : 3 test accuracy : 0.924903
Counter({2: 3187, 1: 3134, 0: 2809})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  30.454476477578282 Time :  6299
accuracy train: 0.976457 val: 0.939024 test: 0.936576
max validation accuracy : 0.939024 max acc epoch : 5 test accuracy : 0.936576
Counter({1: 3205, 0: 3117, 2: 2808})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  27.097153516835533 Time :  6339
accuracy train: 0.975102 val: 0.929878 test: 0.935019
max validation accuracy : 0.939024 max acc epoch : 5 test accuracy : 0.936576
Counter({2: 3214, 0: 3108, 1: 2808})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  20.188703939551488 Time :  6387
accuracy train: 0.982554 val: 0.943598 test: 0.942412
max validation accuracy : 0.943598 max acc epoch : 7 test accuracy : 0.942412
Counter({0: 3212, 1: 3107, 2: 2811})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  16.234656451735646 Time :  6443
accuracy train: 0.983909 val: 0.932927 test: 0.938521
max validation accuracy : 0.943598 max acc epoch : 7 test accuracy : 0.942412
Counter({2: 3212, 0: 3108, 1: 2810})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  14.475693542975932 Time :  6492
accuracy train: 0.986111 val: 0.945122 test: 0.938521
max validation accuracy : 0.945122 max acc epoch : 9 test accuracy : 0.938521
Counter({2: 3216, 0: 3109, 1: 2805})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  13.316018991172314 Time :  6542
accuracy train: 0.989837 val: 0.939024 test: 0.945914
max validation accuracy : 0.945122 max acc epoch : 9 test accuracy : 0.938521
Counter({1: 3214, 0: 3109, 2: 2807})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  10.820819855900481 Time :  6584
accuracy train: 0.990007 val: 0.940549 test: 0.944358
max validation accuracy : 0.945122 max acc epoch : 9 test accuracy : 0.938521
Counter({2: 3212, 1: 3112, 0: 2806})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  12.691549081355333 Time :  6626
accuracy train: 0.989329 val: 0.937500 test: 0.948638
max validation accuracy : 0.945122 max acc epoch : 9 test accuracy : 0.938521
Counter({0: 3210, 2: 3114, 1: 2806})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  10.454199455445632 Time :  6671
accuracy train: 0.992039 val: 0.942073 test: 0.949027
max validation accuracy : 0.945122 max acc epoch : 9 test accuracy : 0.938521
Counter({0: 3211, 2: 3113, 1: 2806})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  10.022391669917852 Time :  6713
accuracy train: 0.990854 val: 0.943598 test: 0.949805
max validation accuracy : 0.945122 max acc epoch : 9 test accuracy : 0.938521
Counter({0: 3211, 2: 3111, 1: 2808})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  9.620557360118255 Time :  6760
accuracy train: 0.991362 val: 0.945122 test: 0.949027
max validation accuracy : 0.945122 max acc epoch : 9 test accuracy : 0.938521
Counter({0: 3210, 2: 3112, 1: 2808})

Epoch :  16 loss training:  9.70352021115832 Time :  6816
accuracy train: 0.992547 val: 0.949695 test: 0.946693
max validation accuracy : 0.949695 max acc epoch : 16 test accuracy : 0.946693
Counter({1: 3207, 2: 3117, 0: 2806})

Epoch :  17 loss training:  9.025790327694267 Time :  6872
accuracy train: 0.991870 val: 0.945122 test: 0.949416
max validation accuracy : 0.949695 max acc epoch : 16 test accuracy : 0.946693
Counter({2: 3208, 0: 3116, 1: 2806})

Epoch :  18 loss training:  8.886420100461692 Time :  6927
accuracy train: 0.992209 val: 0.945122 test: 0.946693
max validation accuracy : 0.949695 max acc epoch : 16 test accuracy : 0.946693
Counter({2: 3207, 1: 3115, 0: 2808})

Epoch :  19 loss training:  8.169201326090842 Time :  6972
accuracy train: 0.992378 val: 0.951220 test: 0.949027
max validation accuracy : 0.951220 max acc epoch : 19 test accuracy : 0.949027
Counter({1: 3204, 0: 3119, 2: 2807})

Epoch :  20 loss training:  8.90393070410937 Time :  7016
accuracy train: 0.993564 val: 0.939024 test: 0.947860
max validation accuracy : 0.951220 max acc epoch : 19 test accuracy : 0.949027
Counter({1: 3205, 2: 3117, 0: 2808})

Epoch :  21 loss training:  7.495894810184836 Time :  7074
accuracy train: 0.992378 val: 0.940549 test: 0.950584
max validation accuracy : 0.951220 max acc epoch : 19 test accuracy : 0.949027
Counter({2: 3206, 1: 3116, 0: 2808})

Epoch :  22 loss training:  8.387296226806939 Time :  7118
accuracy train: 0.992717 val: 0.942073 test: 0.951362
max validation accuracy : 0.951220 max acc epoch : 19 test accuracy : 0.949027
Counter({1: 3207, 2: 3115, 0: 2808})

Epoch :  23 loss training:  8.227036366704851 Time :  7170
accuracy train: 0.993564 val: 0.943598 test: 0.945136
max validation accuracy : 0.951220 max acc epoch : 19 test accuracy : 0.949027
Counter({1: 3205, 0: 3116, 2: 2809})

Epoch :  24 loss training:  7.236665940145031 Time :  7208
accuracy train: 0.994580 val: 0.943598 test: 0.951751
max validation accuracy : 0.951220 max acc epoch : 19 test accuracy : 0.949027
Counter({0: 3207, 1: 3115, 2: 2808})

Epoch :  25 loss training:  7.663328807335347 Time :  7256
accuracy train: 0.993564 val: 0.946646 test: 0.948249
max validation accuracy : 0.951220 max acc epoch : 19 test accuracy : 0.949027
Counter({1: 3207, 2: 3116, 0: 2807})

Epoch :  26 loss training:  7.56657202047063 Time :  7304
accuracy train: 0.994411 val: 0.943598 test: 0.948638
max validation accuracy : 0.951220 max acc epoch : 19 test accuracy : 0.949027
Counter({0: 3206, 2: 3115, 1: 2809})

Epoch :  27 loss training:  7.231614307034761 Time :  7351
accuracy train: 0.994580 val: 0.943598 test: 0.949805
max validation accuracy : 0.951220 max acc epoch : 19 test accuracy : 0.949027
Counter({1: 3207, 2: 3114, 0: 2809})

Epoch :  28 loss training:  7.571772340685129 Time :  7402
accuracy train: 0.993733 val: 0.946646 test: 0.949027
max validation accuracy : 0.951220 max acc epoch : 19 test accuracy : 0.949027
Counter({1: 3205, 0: 3117, 2: 2808})

Epoch :  29 loss training:  6.765638675307855 Time :  7461
accuracy train: 0.993902 val: 0.946646 test: 0.950195
max validation accuracy : 0.951220 max acc epoch : 19 test accuracy : 0.949027
Counter({2: 3206, 0: 3116, 1: 2808})

Epoch :  30 loss training:  6.7514079784741625 Time :  7515
accuracy train: 0.994241 val: 0.945122 test: 0.946693
max validation accuracy : 0.951220 max acc epoch : 19 test accuracy : 0.949027
Counter({0: 3206, 1: 3117, 2: 2807})

Epoch :  31 loss training:  7.096396448556334 Time :  7570
accuracy train: 0.993902 val: 0.948171 test: 0.947082
max validation accuracy : 0.951220 max acc epoch : 19 test accuracy : 0.949027
Counter({0: 3208, 1: 3114, 2: 2808})

Epoch :  32 loss training:  6.357844756683335 Time :  7628
accuracy train: 0.994411 val: 0.946646 test: 0.945136
max validation accuracy : 0.951220 max acc epoch : 19 test accuracy : 0.949027
Counter({2: 3209, 1: 3113, 0: 2808})

Epoch :  33 loss training:  6.488035053713247 Time :  7686
accuracy train: 0.994749 val: 0.949695 test: 0.946693
max validation accuracy : 0.951220 max acc epoch : 19 test accuracy : 0.949027
Counter({1: 3206, 0: 3118, 2: 2806})

Epoch :  34 loss training:  5.392222409835085 Time :  7722
accuracy train: 0.994580 val: 0.951220 test: 0.951362
max validation accuracy : 0.951220 max acc epoch : 19 test accuracy : 0.949027
Counter({2: 3207, 0: 3114, 1: 2809})

Epoch :  35 loss training:  6.004143547615968 Time :  7768
accuracy train: 0.994749 val: 0.951220 test: 0.950195
max validation accuracy : 0.951220 max acc epoch : 19 test accuracy : 0.949027
Counter({2: 3206, 1: 3115, 0: 2809})

Epoch :  36 loss training:  6.162990513606928 Time :  7812
accuracy train: 0.995257 val: 0.946646 test: 0.950195
max validation accuracy : 0.951220 max acc epoch : 19 test accuracy : 0.949027
Counter({0: 3206, 1: 3117, 2: 2807})

Epoch :  37 loss training:  6.207396274316125 Time :  7869
accuracy train: 0.994749 val: 0.949695 test: 0.948249
max validation accuracy : 0.951220 max acc epoch : 19 test accuracy : 0.949027
Counter({1: 3204, 0: 3116, 2: 2810})

Epoch :  38 loss training:  5.850822786742356 Time :  7918
accuracy train: 0.995257 val: 0.949695 test: 0.949416
max validation accuracy : 0.951220 max acc epoch : 19 test accuracy : 0.949027
Counter({0: 3206, 2: 3116, 1: 2808})

Epoch :  39 loss training:  5.893803584505804 Time :  7974
accuracy train: 0.995088 val: 0.952744 test: 0.947082
max validation accuracy : 0.952744 max acc epoch : 39 test accuracy : 0.947082
Counter({0: 3205, 2: 3118, 1: 2807})

Epoch :  40 loss training:  5.751011784537695 Time :  8025
accuracy train: 0.994919 val: 0.949695 test: 0.949027
max validation accuracy : 0.952744 max acc epoch : 39 test accuracy : 0.947082
Counter({0: 3204, 2: 3117, 1: 2809})

Epoch :  41 loss training:  5.655466862255707 Time :  8079
accuracy train: 0.995427 val: 0.952744 test: 0.949027
max validation accuracy : 0.952744 max acc epoch : 39 test accuracy : 0.947082
Counter({0: 3203, 1: 3121, 2: 2806})

Epoch :  42 loss training:  5.521225105039775 Time :  8131
accuracy train: 0.995427 val: 0.949695 test: 0.949027
max validation accuracy : 0.952744 max acc epoch : 39 test accuracy : 0.947082
Counter({0: 3202, 1: 3122, 2: 2806})

Epoch :  43 loss training:  5.759625959442928 Time :  8182
accuracy train: 0.994580 val: 0.949695 test: 0.950195
max validation accuracy : 0.952744 max acc epoch : 39 test accuracy : 0.947082
Counter({1: 3204, 2: 3117, 0: 2809})

Epoch :  44 loss training:  5.153106348938309 Time :  8226
accuracy train: 0.995427 val: 0.949695 test: 0.950973
max validation accuracy : 0.952744 max acc epoch : 39 test accuracy : 0.947082
Counter({2: 3202, 1: 3119, 0: 2809})

Epoch :  45 loss training:  5.489683399675414 Time :  8273
accuracy train: 0.995596 val: 0.948171 test: 0.948638
max validation accuracy : 0.952744 max acc epoch : 39 test accuracy : 0.947082
Counter({0: 3202, 1: 3119, 2: 2809})

Epoch :  46 loss training:  4.933225829619914 Time :  8326
accuracy train: 0.995766 val: 0.948171 test: 0.947860
max validation accuracy : 0.952744 max acc epoch : 39 test accuracy : 0.947082
Counter({1: 3201, 0: 3119, 2: 2810})

Epoch :  47 loss training:  5.030823062406853 Time :  8364
accuracy train: 0.995596 val: 0.954268 test: 0.949805
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({2: 3199, 0: 3120, 1: 2811})

Epoch :  48 loss training:  4.816179270099383 Time :  8417
accuracy train: 0.995427 val: 0.951220 test: 0.948638
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({1: 3197, 0: 3121, 2: 2812})

Epoch :  49 loss training:  4.994973294902593 Time :  8477
accuracy train: 0.996104 val: 0.948171 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({2: 3197, 0: 3121, 1: 2812})

Epoch :  50 loss training:  4.456110138562508 Time :  8525
accuracy train: 0.996104 val: 0.951220 test: 0.946693
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({2: 3198, 0: 3120, 1: 2812})

Epoch :  51 loss training:  4.963515134179033 Time :  8573
accuracy train: 0.995766 val: 0.951220 test: 0.950584
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({0: 3200, 1: 3115, 2: 2815})

Epoch :  52 loss training:  4.476852750725811 Time :  8626
accuracy train: 0.996104 val: 0.942073 test: 0.947471
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({2: 3199, 0: 3115, 1: 2816})

Epoch :  53 loss training:  4.438816945068538 Time :  8682
accuracy train: 0.996104 val: 0.949695 test: 0.945525
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({2: 3202, 1: 3112, 0: 2816})

Epoch :  54 loss training:  4.635176666546613 Time :  8736
accuracy train: 0.996104 val: 0.945122 test: 0.945136
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({2: 3202, 1: 3113, 0: 2815})

Epoch :  55 loss training:  4.701984183251625 Time :  8785
accuracy train: 0.995935 val: 0.951220 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({0: 3202, 1: 3114, 2: 2814})

Epoch :  56 loss training:  4.0196996719168965 Time :  8824
accuracy train: 0.996274 val: 0.951220 test: 0.951751
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({1: 3203, 0: 3114, 2: 2813})

Epoch :  57 loss training:  4.344975663290825 Time :  8874
accuracy train: 0.996104 val: 0.952744 test: 0.946693
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({0: 3205, 2: 3113, 1: 2812})

Epoch :  58 loss training:  4.308168357296381 Time :  8920
accuracy train: 0.996104 val: 0.940549 test: 0.950973
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({2: 3203, 0: 3115, 1: 2812})

Epoch :  59 loss training:  4.7619036512915045 Time :  8960
accuracy train: 0.995935 val: 0.948171 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({0: 3209, 2: 3109, 1: 2812})

Epoch :  60 loss training:  3.770597762631951 Time :  9015
accuracy train: 0.996104 val: 0.948171 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({1: 3209, 2: 3108, 0: 2813})

Epoch :  61 loss training:  3.958761963949655 Time :  9074
accuracy train: 0.996104 val: 0.948171 test: 0.954086
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({2: 3208, 0: 3109, 1: 2813})

Epoch :  62 loss training:  3.7750656779680867 Time :  9120
accuracy train: 0.996104 val: 0.945122 test: 0.949805
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({2: 3208, 0: 3109, 1: 2813})

Epoch :  63 loss training:  3.7301950952387415 Time :  9173
accuracy train: 0.996274 val: 0.949695 test: 0.946304
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({2: 3208, 0: 3108, 1: 2814})

Epoch :  64 loss training:  4.035792702808976 Time :  9218
accuracy train: 0.996274 val: 0.951220 test: 0.950973
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({0: 3207, 1: 3110, 2: 2813})

Epoch :  65 loss training:  3.7787379525834695 Time :  9273
accuracy train: 0.996104 val: 0.945122 test: 0.946304
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({0: 3207, 2: 3109, 1: 2814})

Epoch :  66 loss training:  3.9196440929663368 Time :  9323
accuracy train: 0.996443 val: 0.943598 test: 0.945525
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({1: 3208, 0: 3109, 2: 2813})

Epoch :  67 loss training:  3.8874076459323987 Time :  9370
accuracy train: 0.996443 val: 0.945122 test: 0.950584
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({1: 3207, 2: 3109, 0: 2814})

Epoch :  68 loss training:  4.011609562614467 Time :  9423
accuracy train: 0.995766 val: 0.940549 test: 0.948638
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({0: 3207, 2: 3109, 1: 2814})

Epoch :  69 loss training:  3.5497482231003232 Time :  9477
accuracy train: 0.996104 val: 0.943598 test: 0.952140
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({2: 3206, 1: 3108, 0: 2816})

Epoch :  70 loss training:  4.145057590329088 Time :  9526
accuracy train: 0.996104 val: 0.945122 test: 0.950195
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({0: 3205, 2: 3109, 1: 2816})

Epoch :  71 loss training:  3.5739804871263914 Time :  9576
accuracy train: 0.996274 val: 0.942073 test: 0.951362
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({1: 3204, 2: 3110, 0: 2816})

Epoch :  72 loss training:  3.569867505284492 Time :  9627
accuracy train: 0.996443 val: 0.940549 test: 0.946693
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({0: 3204, 1: 3113, 2: 2813})

Epoch :  73 loss training:  3.293721260910388 Time :  9679
accuracy train: 0.996274 val: 0.945122 test: 0.950195
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({1: 3202, 0: 3112, 2: 2816})

Epoch :  74 loss training:  3.704996012558695 Time :  9730
accuracy train: 0.996274 val: 0.946646 test: 0.949416
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({1: 3202, 2: 3113, 0: 2815})

Epoch :  75 loss training:  3.4053138277085964 Time :  9775
accuracy train: 0.996782 val: 0.943598 test: 0.949027
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({1: 3201, 0: 3113, 2: 2816})

Epoch :  76 loss training:  3.525230528030079 Time :  9826
accuracy train: 0.996274 val: 0.942073 test: 0.949805
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({1: 3201, 2: 3113, 0: 2816})

Epoch :  77 loss training:  3.422443666466279 Time :  9880
accuracy train: 0.996104 val: 0.948171 test: 0.951751
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({0: 3205, 2: 3112, 1: 2813})

Epoch :  78 loss training:  3.5446739857725333 Time :  9933
accuracy train: 0.996274 val: 0.945122 test: 0.953307
max validation accuracy : 0.954268 max acc epoch : 47 test accuracy : 0.949805
Counter({1: 3205, 2: 3112, 0: 2813})

========================================================================================================================================================================================================
max acc epoch :  47
max validation accuracy :  0.9542682926829268
test accuracy :  0.9498054474708171
last test_accuracy :  0.953307392996109
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.5, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=996, weight_decay=0)
device :  cuda:0
Counter({1: 3513, 0: 3067, 2: 2550})

Epoch :  1 loss training:  192.01576828956604 Time :  10123
accuracy train: 0.875169 val: 0.875000 test: 0.873930
max validation accuracy : 0.875000 max acc epoch : 1 test accuracy : 0.873930
Counter({0: 3185, 2: 3143, 1: 2802})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  88.35294856131077 Time :  10173
accuracy train: 0.920393 val: 0.900915 test: 0.897665
max validation accuracy : 0.900915 max acc epoch : 2 test accuracy : 0.897665
Counter({0: 3194, 2: 3125, 1: 2811})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  71.49906136188656 Time :  10220
accuracy train: 0.936653 val: 0.922256 test: 0.922957
max validation accuracy : 0.922256 max acc epoch : 3 test accuracy : 0.922957
Counter({0: 3206, 1: 3115, 2: 2809})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  37.54026106465608 Time :  10279
accuracy train: 0.965108 val: 0.925305 test: 0.935798
max validation accuracy : 0.925305 max acc epoch : 4 test accuracy : 0.935798
Counter({1: 3207, 0: 3109, 2: 2814})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  30.5736962526571 Time :  10336
accuracy train: 0.975949 val: 0.937500 test: 0.938521
max validation accuracy : 0.937500 max acc epoch : 5 test accuracy : 0.938521
Counter({0: 3205, 1: 3114, 2: 2811})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  27.72476904420182 Time :  10387
accuracy train: 0.969173 val: 0.925305 test: 0.934630
max validation accuracy : 0.937500 max acc epoch : 5 test accuracy : 0.938521
Counter({2: 3211, 0: 3109, 1: 2810})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  19.598689278122038 Time :  10444
accuracy train: 0.983401 val: 0.939024 test: 0.944358
max validation accuracy : 0.939024 max acc epoch : 7 test accuracy : 0.944358
Counter({0: 3206, 1: 3112, 2: 2812})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  16.217733347322792 Time :  10491
accuracy train: 0.984587 val: 0.928354 test: 0.939300
max validation accuracy : 0.939024 max acc epoch : 7 test accuracy : 0.944358
Counter({1: 3210, 0: 3112, 2: 2808})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  14.300228493986651 Time :  10535
accuracy train: 0.984925 val: 0.948171 test: 0.938911
max validation accuracy : 0.948171 max acc epoch : 9 test accuracy : 0.938911
Counter({0: 3205, 1: 3113, 2: 2812})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  13.631203488213941 Time :  10578
accuracy train: 0.988821 val: 0.942073 test: 0.945136
max validation accuracy : 0.948171 max acc epoch : 9 test accuracy : 0.938911
Counter({1: 3211, 0: 3110, 2: 2809})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  11.055433701490983 Time :  10625
accuracy train: 0.989499 val: 0.939024 test: 0.943969
max validation accuracy : 0.948171 max acc epoch : 9 test accuracy : 0.938911
Counter({2: 3207, 1: 3111, 0: 2812})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  12.535184102831408 Time :  10678
accuracy train: 0.989668 val: 0.940549 test: 0.947860
max validation accuracy : 0.948171 max acc epoch : 9 test accuracy : 0.938911
Counter({0: 3205, 1: 3113, 2: 2812})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  10.749760085251182 Time :  10724
accuracy train: 0.991531 val: 0.940549 test: 0.944747
max validation accuracy : 0.948171 max acc epoch : 9 test accuracy : 0.938911
Counter({0: 3208, 2: 3110, 1: 2812})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  10.172912033158354 Time :  10774
accuracy train: 0.991531 val: 0.946646 test: 0.946693
max validation accuracy : 0.948171 max acc epoch : 9 test accuracy : 0.938911
Counter({0: 3207, 2: 3110, 1: 2813})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  10.224384129047394 Time :  10808
accuracy train: 0.991023 val: 0.940549 test: 0.946304
max validation accuracy : 0.948171 max acc epoch : 9 test accuracy : 0.938911
Counter({2: 3208, 0: 3113, 1: 2809})

Epoch :  16 loss training:  9.786643230356276 Time :  10873
accuracy train: 0.993056 val: 0.946646 test: 0.945136
max validation accuracy : 0.948171 max acc epoch : 9 test accuracy : 0.938911
Counter({1: 3208, 2: 3113, 0: 2809})

Epoch :  17 loss training:  9.371212197700515 Time :  10934
accuracy train: 0.991531 val: 0.943598 test: 0.946693
max validation accuracy : 0.948171 max acc epoch : 9 test accuracy : 0.938911
Counter({0: 3208, 2: 3114, 1: 2808})

Epoch :  18 loss training:  9.083774253260344 Time :  10994
accuracy train: 0.992209 val: 0.943598 test: 0.943580
max validation accuracy : 0.948171 max acc epoch : 9 test accuracy : 0.938911
Counter({0: 3208, 2: 3111, 1: 2811})

Epoch :  19 loss training:  8.507850569672883 Time :  11047
accuracy train: 0.992039 val: 0.946646 test: 0.945914
max validation accuracy : 0.948171 max acc epoch : 9 test accuracy : 0.938911
Counter({0: 3208, 2: 3113, 1: 2809})

Epoch :  20 loss training:  9.220862241927534 Time :  11107
accuracy train: 0.993394 val: 0.939024 test: 0.947082
max validation accuracy : 0.948171 max acc epoch : 9 test accuracy : 0.938911
Counter({2: 3204, 1: 3114, 0: 2812})

Epoch :  21 loss training:  7.898630097974092 Time :  11166
accuracy train: 0.993056 val: 0.945122 test: 0.948249
max validation accuracy : 0.948171 max acc epoch : 9 test accuracy : 0.938911
Counter({1: 3206, 0: 3112, 2: 2812})

Epoch :  22 loss training:  8.467117726337165 Time :  11222
accuracy train: 0.992717 val: 0.940549 test: 0.949416
max validation accuracy : 0.948171 max acc epoch : 9 test accuracy : 0.938911
Counter({1: 3203, 2: 3114, 0: 2813})

Epoch :  23 loss training:  8.088075561681762 Time :  11274
accuracy train: 0.993733 val: 0.943598 test: 0.943969
max validation accuracy : 0.948171 max acc epoch : 9 test accuracy : 0.938911
Counter({1: 3203, 0: 3115, 2: 2812})

Epoch :  24 loss training:  7.206379119656049 Time :  11326
accuracy train: 0.993733 val: 0.942073 test: 0.947082
max validation accuracy : 0.948171 max acc epoch : 9 test accuracy : 0.938911
Counter({1: 3204, 0: 3113, 2: 2813})

Epoch :  25 loss training:  8.019249740988016 Time :  11371
accuracy train: 0.993902 val: 0.940549 test: 0.945914
max validation accuracy : 0.948171 max acc epoch : 9 test accuracy : 0.938911
Counter({1: 3202, 0: 3116, 2: 2812})

Epoch :  26 loss training:  7.5650316084502265 Time :  11411
accuracy train: 0.993564 val: 0.937500 test: 0.947860
max validation accuracy : 0.948171 max acc epoch : 9 test accuracy : 0.938911
Counter({2: 3205, 1: 3114, 0: 2811})

Epoch :  27 loss training:  7.303181753261015 Time :  11462
accuracy train: 0.994580 val: 0.943598 test: 0.946693
max validation accuracy : 0.948171 max acc epoch : 9 test accuracy : 0.938911
Counter({0: 3204, 2: 3112, 1: 2814})

Epoch :  28 loss training:  7.429801011923701 Time :  11515
accuracy train: 0.993733 val: 0.951220 test: 0.945914
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({1: 3209, 0: 3111, 2: 2810})

Epoch :  29 loss training:  6.871272161719389 Time :  11566
accuracy train: 0.993902 val: 0.946646 test: 0.949027
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({0: 3208, 1: 3110, 2: 2812})

Epoch :  30 loss training:  7.075088631012477 Time :  11612
accuracy train: 0.993902 val: 0.939024 test: 0.945136
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({0: 3207, 2: 3115, 1: 2808})

Epoch :  31 loss training:  7.021447621751577 Time :  11658
accuracy train: 0.993733 val: 0.943598 test: 0.947471
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({0: 3208, 1: 3111, 2: 2811})

Epoch :  32 loss training:  6.286764297168702 Time :  11712
accuracy train: 0.994072 val: 0.942073 test: 0.948638
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({1: 3207, 0: 3113, 2: 2810})

Epoch :  33 loss training:  6.797990197432227 Time :  11770
accuracy train: 0.994241 val: 0.942073 test: 0.949416
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({1: 3203, 0: 3113, 2: 2814})

Epoch :  34 loss training:  6.155951191904023 Time :  11824
accuracy train: 0.993902 val: 0.948171 test: 0.950584
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({0: 3206, 2: 3116, 1: 2808})

Epoch :  35 loss training:  6.181730379583314 Time :  11855
accuracy train: 0.994749 val: 0.945122 test: 0.949416
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({1: 3205, 2: 3117, 0: 2808})

Epoch :  36 loss training:  6.509498554165475 Time :  11908
accuracy train: 0.994749 val: 0.948171 test: 0.947860
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({0: 3199, 2: 3119, 1: 2812})

Epoch :  37 loss training:  6.4825313506880775 Time :  11956
accuracy train: 0.994749 val: 0.948171 test: 0.946304
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({1: 3200, 0: 3117, 2: 2813})

Epoch :  38 loss training:  6.152177481446415 Time :  12002
accuracy train: 0.995088 val: 0.945122 test: 0.950584
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({2: 3198, 0: 3120, 1: 2812})

Epoch :  39 loss training:  6.239068610360846 Time :  12042
accuracy train: 0.994411 val: 0.946646 test: 0.946304
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({2: 3197, 0: 3121, 1: 2812})

Epoch :  40 loss training:  6.042643323307857 Time :  12095
accuracy train: 0.995257 val: 0.945122 test: 0.947860
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({1: 3200, 2: 3118, 0: 2812})

Epoch :  41 loss training:  5.520102485199459 Time :  12154
accuracy train: 0.995257 val: 0.948171 test: 0.946693
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({0: 3199, 1: 3120, 2: 2811})

Epoch :  42 loss training:  5.5687564932741225 Time :  12202
accuracy train: 0.995427 val: 0.948171 test: 0.949805
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({1: 3199, 2: 3118, 0: 2813})

Epoch :  43 loss training:  5.7130420642206445 Time :  12250
accuracy train: 0.994241 val: 0.949695 test: 0.947860
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({0: 3199, 2: 3117, 1: 2814})

Epoch :  44 loss training:  5.121142685122322 Time :  12295
accuracy train: 0.994919 val: 0.939024 test: 0.949805
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({0: 3199, 2: 3117, 1: 2814})

Epoch :  45 loss training:  5.501005703466944 Time :  12349
accuracy train: 0.995257 val: 0.940549 test: 0.947082
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({0: 3196, 1: 3120, 2: 2814})

Epoch :  46 loss training:  5.093136055627838 Time :  12404
accuracy train: 0.995766 val: 0.948171 test: 0.949027
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({1: 3195, 0: 3118, 2: 2817})

Epoch :  47 loss training:  5.087372660171241 Time :  12442
accuracy train: 0.995766 val: 0.943598 test: 0.948249
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({0: 3195, 2: 3119, 1: 2816})

Epoch :  48 loss training:  4.603375167236663 Time :  12497
accuracy train: 0.995257 val: 0.942073 test: 0.947860
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({1: 3197, 0: 3118, 2: 2815})

Epoch :  49 loss training:  4.9076878720661625 Time :  12544
accuracy train: 0.995766 val: 0.943598 test: 0.946693
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({2: 3195, 0: 3120, 1: 2815})

Epoch :  50 loss training:  4.8066179166780785 Time :  12596
accuracy train: 0.995935 val: 0.943598 test: 0.948638
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({1: 3195, 0: 3120, 2: 2815})

Epoch :  51 loss training:  5.184973179770168 Time :  12640
accuracy train: 0.995766 val: 0.945122 test: 0.947082
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({0: 3199, 2: 3115, 1: 2816})

Epoch :  52 loss training:  4.454351098975167 Time :  12695
accuracy train: 0.995935 val: 0.945122 test: 0.950195
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({1: 3198, 0: 3115, 2: 2817})

Epoch :  53 loss training:  4.715475509816315 Time :  12755
accuracy train: 0.995088 val: 0.946646 test: 0.949416
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({1: 3200, 0: 3112, 2: 2818})

Epoch :  54 loss training:  4.668339797644876 Time :  12805
accuracy train: 0.995935 val: 0.946646 test: 0.946304
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({1: 3202, 2: 3112, 0: 2816})

Epoch :  55 loss training:  4.46141739084851 Time :  12852
accuracy train: 0.995766 val: 0.948171 test: 0.948249
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({0: 3200, 1: 3113, 2: 2817})

Epoch :  56 loss training:  3.78374077603803 Time :  12899
accuracy train: 0.995935 val: 0.943598 test: 0.948638
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({1: 3195, 0: 3115, 2: 2820})

Epoch :  57 loss training:  4.153079112526029 Time :  12950
accuracy train: 0.996104 val: 0.945122 test: 0.947471
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({0: 3195, 2: 3115, 1: 2820})

Epoch :  58 loss training:  4.625521107926033 Time :  13004
accuracy train: 0.995766 val: 0.942073 test: 0.949416
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({0: 3197, 1: 3115, 2: 2818})

Epoch :  59 loss training:  4.684402167331427 Time :  13067
accuracy train: 0.996104 val: 0.943598 test: 0.948249
max validation accuracy : 0.951220 max acc epoch : 28 test accuracy : 0.945914
Counter({0: 3194, 2: 3116, 1: 2820})

========================================================================================================================================================================================================
max acc epoch :  28
max validation accuracy :  0.9512195121951219
test accuracy :  0.9459143968871595
last test_accuracy :  0.948249027237354
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.5, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=996, weight_decay=0)
device :  cuda:0
Counter({1: 3513, 0: 3067, 2: 2550})

Epoch :  1 loss training:  192.1398245692253 Time :  13292
accuracy train: 0.881944 val: 0.878049 test: 0.875486
max validation accuracy : 0.878049 max acc epoch : 1 test accuracy : 0.875486
Counter({2: 3187, 0: 3137, 1: 2806})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  88.45090287178755 Time :  13352
accuracy train: 0.918191 val: 0.905488 test: 0.891829
max validation accuracy : 0.905488 max acc epoch : 2 test accuracy : 0.891829
Counter({0: 3206, 2: 3118, 1: 2806})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  72.84899509279057 Time :  13415
accuracy train: 0.943428 val: 0.920732 test: 0.926070
max validation accuracy : 0.920732 max acc epoch : 3 test accuracy : 0.926070
Counter({1: 3219, 0: 3102, 2: 2809})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  34.98123197816312 Time :  13465
accuracy train: 0.967818 val: 0.926829 test: 0.933852
max validation accuracy : 0.926829 max acc epoch : 4 test accuracy : 0.933852
Counter({1: 3219, 0: 3100, 2: 2811})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  30.557217549998313 Time :  13516
accuracy train: 0.979336 val: 0.943598 test: 0.940467
max validation accuracy : 0.943598 max acc epoch : 5 test accuracy : 0.940467
Counter({1: 3212, 0: 3105, 2: 2813})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  27.99040236324072 Time :  13570
accuracy train: 0.973747 val: 0.934451 test: 0.938521
max validation accuracy : 0.943598 max acc epoch : 5 test accuracy : 0.940467
Counter({0: 3223, 1: 3099, 2: 2808})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  20.444530179724097 Time :  13625
accuracy train: 0.984925 val: 0.949695 test: 0.944747
max validation accuracy : 0.949695 max acc epoch : 7 test accuracy : 0.944747
Counter({1: 3218, 0: 3100, 2: 2812})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  16.454843365587294 Time :  13670
accuracy train: 0.984079 val: 0.929878 test: 0.940856
max validation accuracy : 0.949695 max acc epoch : 7 test accuracy : 0.944747
Counter({1: 3218, 0: 3103, 2: 2809})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  14.145194430137053 Time :  13721
accuracy train: 0.987297 val: 0.948171 test: 0.937743
max validation accuracy : 0.949695 max acc epoch : 7 test accuracy : 0.944747
Counter({0: 3218, 2: 3107, 1: 2805})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  13.238280340912752 Time :  13777
accuracy train: 0.989499 val: 0.946646 test: 0.945914
max validation accuracy : 0.949695 max acc epoch : 7 test accuracy : 0.944747
Counter({1: 3218, 0: 3108, 2: 2804})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  10.962455387460068 Time :  13831
accuracy train: 0.988821 val: 0.942073 test: 0.943969
max validation accuracy : 0.949695 max acc epoch : 7 test accuracy : 0.944747
Counter({1: 3216, 2: 3110, 0: 2804})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  12.809531000442803 Time :  13871
accuracy train: 0.989499 val: 0.943598 test: 0.946304
max validation accuracy : 0.949695 max acc epoch : 7 test accuracy : 0.944747
Counter({1: 3216, 2: 3110, 0: 2804})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  10.796407830668613 Time :  13917
accuracy train: 0.991870 val: 0.942073 test: 0.946693
max validation accuracy : 0.949695 max acc epoch : 7 test accuracy : 0.944747
Counter({0: 3215, 2: 3111, 1: 2804})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  9.688895623665303 Time :  13971
accuracy train: 0.991362 val: 0.948171 test: 0.948249
max validation accuracy : 0.949695 max acc epoch : 7 test accuracy : 0.944747
Counter({1: 3213, 0: 3112, 2: 2805})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  9.73175678635016 Time :  14021
accuracy train: 0.991531 val: 0.943598 test: 0.949027
max validation accuracy : 0.949695 max acc epoch : 7 test accuracy : 0.944747
Counter({1: 3212, 0: 3113, 2: 2805})

Epoch :  16 loss training:  9.446219354867935 Time :  14075
accuracy train: 0.992547 val: 0.952744 test: 0.944358
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({1: 3211, 0: 3114, 2: 2805})

Epoch :  17 loss training:  9.121028612367809 Time :  14135
accuracy train: 0.992209 val: 0.946646 test: 0.948638
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({1: 3211, 0: 3114, 2: 2805})

Epoch :  18 loss training:  8.968788350466639 Time :  14190
accuracy train: 0.992547 val: 0.949695 test: 0.946304
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({1: 3212, 2: 3113, 0: 2805})

Epoch :  19 loss training:  8.395136222243309 Time :  14240
accuracy train: 0.992209 val: 0.952744 test: 0.946693
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({0: 3213, 1: 3112, 2: 2805})

Epoch :  20 loss training:  9.140438206959516 Time :  14286
accuracy train: 0.993225 val: 0.945122 test: 0.947082
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({1: 3213, 2: 3112, 0: 2805})

Epoch :  21 loss training:  7.698242311831564 Time :  14340
accuracy train: 0.993564 val: 0.949695 test: 0.948638
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({1: 3213, 0: 3112, 2: 2805})

Epoch :  22 loss training:  8.330767613835633 Time :  14392
accuracy train: 0.993056 val: 0.943598 test: 0.948249
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({0: 3212, 1: 3113, 2: 2805})

Epoch :  23 loss training:  8.013131329324096 Time :  14449
accuracy train: 0.993564 val: 0.946646 test: 0.944358
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({0: 3212, 2: 3112, 1: 2806})

Epoch :  24 loss training:  7.355265060905367 Time :  14502
accuracy train: 0.994241 val: 0.945122 test: 0.948249
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({2: 3212, 0: 3113, 1: 2805})

Epoch :  25 loss training:  7.784226661897264 Time :  14551
accuracy train: 0.993564 val: 0.943598 test: 0.945914
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({1: 3212, 0: 3113, 2: 2805})

Epoch :  26 loss training:  7.771905119181611 Time :  14600
accuracy train: 0.994580 val: 0.946646 test: 0.948249
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({0: 3213, 2: 3110, 1: 2807})

Epoch :  27 loss training:  7.031525751342997 Time :  14643
accuracy train: 0.994241 val: 0.945122 test: 0.944747
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({1: 3215, 0: 3108, 2: 2807})

Epoch :  28 loss training:  7.202239281265065 Time :  14697
accuracy train: 0.993394 val: 0.951220 test: 0.946304
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({1: 3213, 0: 3112, 2: 2805})

Epoch :  29 loss training:  6.787618993781507 Time :  14756
accuracy train: 0.993902 val: 0.946646 test: 0.946693
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({0: 3213, 1: 3112, 2: 2805})

Epoch :  30 loss training:  6.542241852730513 Time :  14809
accuracy train: 0.994072 val: 0.942073 test: 0.947082
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({0: 3212, 1: 3112, 2: 2806})

Epoch :  31 loss training:  6.762256901012734 Time :  14857
accuracy train: 0.994241 val: 0.949695 test: 0.944358
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({0: 3214, 1: 3108, 2: 2808})

Epoch :  32 loss training:  6.345979958539829 Time :  14909
accuracy train: 0.994072 val: 0.940549 test: 0.945914
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({1: 3215, 0: 3107, 2: 2808})

Epoch :  33 loss training:  6.462799551198259 Time :  14955
accuracy train: 0.995088 val: 0.949695 test: 0.947082
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({0: 3214, 1: 3111, 2: 2805})

Epoch :  34 loss training:  5.833992645377293 Time :  15006
accuracy train: 0.994580 val: 0.951220 test: 0.949805
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({2: 3216, 0: 3108, 1: 2806})

Epoch :  35 loss training:  6.227120078692678 Time :  15057
accuracy train: 0.995088 val: 0.948171 test: 0.947471
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({1: 3215, 2: 3109, 0: 2806})

Epoch :  36 loss training:  6.268191955750808 Time :  15117
accuracy train: 0.995257 val: 0.948171 test: 0.947471
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({0: 3217, 1: 3107, 2: 2806})

Epoch :  37 loss training:  6.17817809805274 Time :  15175
accuracy train: 0.995427 val: 0.948171 test: 0.947471
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({1: 3215, 0: 3107, 2: 2808})

Epoch :  38 loss training:  5.943228738615289 Time :  15221
accuracy train: 0.995088 val: 0.951220 test: 0.947082
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({0: 3212, 2: 3112, 1: 2806})

Epoch :  39 loss training:  6.029056482133456 Time :  15266
accuracy train: 0.995766 val: 0.946646 test: 0.945525
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({0: 3213, 2: 3110, 1: 2807})

Epoch :  40 loss training:  5.898778811329976 Time :  15318
accuracy train: 0.995766 val: 0.946646 test: 0.945914
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({1: 3211, 0: 3110, 2: 2809})

Epoch :  41 loss training:  5.539335566048976 Time :  15373
accuracy train: 0.995766 val: 0.946646 test: 0.948638
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({1: 3208, 0: 3116, 2: 2806})

Epoch :  42 loss training:  5.667241565417498 Time :  15420
accuracy train: 0.995596 val: 0.949695 test: 0.946304
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({1: 3208, 0: 3116, 2: 2806})

Epoch :  43 loss training:  6.052361674723215 Time :  15469
accuracy train: 0.994241 val: 0.945122 test: 0.947082
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({0: 3206, 2: 3118, 1: 2806})

Epoch :  44 loss training:  5.084474925533868 Time :  15523
accuracy train: 0.995088 val: 0.946646 test: 0.948638
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({0: 3203, 2: 3118, 1: 2809})

Epoch :  45 loss training:  5.477085844730027 Time :  15580
accuracy train: 0.995935 val: 0.945122 test: 0.945914
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({1: 3203, 2: 3119, 0: 2808})

Epoch :  46 loss training:  4.930038912105374 Time :  15641
accuracy train: 0.995596 val: 0.949695 test: 0.949027
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({0: 3203, 1: 3118, 2: 2809})

Epoch :  47 loss training:  4.782204301794991 Time :  15692
accuracy train: 0.995766 val: 0.943598 test: 0.945525
max validation accuracy : 0.952744 max acc epoch : 16 test accuracy : 0.944358
Counter({0: 3204, 2: 3118, 1: 2808})

========================================================================================================================================================================================================
max acc epoch :  16
max validation accuracy :  0.9527439024390244
test accuracy :  0.9443579766536965
last test_accuracy :  0.9455252918287937
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.94970 	 test_accuracy : 0.94475 	 max_acc epoch :  19 	 last test_accuracy : 0.94553
k :  1 	 val_accuracy : 0.95274 	 test_accuracy : 0.94786 	 max_acc epoch :  33 	 last test_accuracy : 0.94981
k :  2 	 val_accuracy : 0.95427 	 test_accuracy : 0.94981 	 max_acc epoch :  47 	 last test_accuracy : 0.95331
k :  3 	 val_accuracy : 0.95122 	 test_accuracy : 0.94591 	 max_acc epoch :  28 	 last test_accuracy : 0.94825
k :  4 	 val_accuracy : 0.95274 	 test_accuracy : 0.94436 	 max_acc epoch :  16 	 last test_accuracy : 0.94553

avg :  	 val_accuracy : 0.95213 	 test_accuracy : 0.94654 	 last_accuracy : 0.94848
