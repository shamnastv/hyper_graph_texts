

date and time :  Sun Jul  4 17:41:14 2021
itr : 0
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=988, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  118.59266333281994 Time :  16
accuracy train: 0.901901 val: 0.878049 test: 0.890661
max validation accuracy : 0.878049 max acc epoch : 1 test accuracy : 0.890661
Epoch-1 lr: 0.001

Epoch :  2 loss training:  52.08065517991781 Time :  28
accuracy train: 0.952116 val: 0.917683 test: 0.926070
max validation accuracy : 0.917683 max acc epoch : 2 test accuracy : 0.926070
Epoch-2 lr: 0.001

Epoch :  3 loss training:  36.34619202837348 Time :  41
accuracy train: 0.959828 val: 0.920732 test: 0.921790
max validation accuracy : 0.920732 max acc epoch : 3 test accuracy : 0.921790
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  24.233401438221335 Time :  53
accuracy train: 0.975072 val: 0.934959 test: 0.940467
max validation accuracy : 0.934959 max acc epoch : 4 test accuracy : 0.940467
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  19.516249153763056 Time :  65
accuracy train: 0.980093 val: 0.932927 test: 0.947471
max validation accuracy : 0.934959 max acc epoch : 4 test accuracy : 0.940467
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  16.734027365222573 Time :  77
accuracy train: 0.985653 val: 0.942073 test: 0.940078
max validation accuracy : 0.942073 max acc epoch : 6 test accuracy : 0.940078
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  13.40199866052717 Time :  89
accuracy train: 0.987088 val: 0.940041 test: 0.949805
max validation accuracy : 0.942073 max acc epoch : 6 test accuracy : 0.940078
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  12.680336582940072 Time :  101
accuracy train: 0.990854 val: 0.942073 test: 0.949027
max validation accuracy : 0.942073 max acc epoch : 6 test accuracy : 0.940078
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  10.750174297951162 Time :  113
accuracy train: 0.990854 val: 0.944106 test: 0.949805
max validation accuracy : 0.944106 max acc epoch : 9 test accuracy : 0.949805
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  9.99656143086031 Time :  125
accuracy train: 0.991212 val: 0.945122 test: 0.948249
max validation accuracy : 0.945122 max acc epoch : 10 test accuracy : 0.948249

Epoch :  11 loss training:  9.747887977398932 Time :  140
accuracy train: 0.991750 val: 0.948171 test: 0.948249
max validation accuracy : 0.948171 max acc epoch : 11 test accuracy : 0.948249

Epoch :  12 loss training:  8.091149057494476 Time :  154
accuracy train: 0.992826 val: 0.950203 test: 0.950973
max validation accuracy : 0.950203 max acc epoch : 12 test accuracy : 0.950973

Epoch :  13 loss training:  8.245362264104187 Time :  168
accuracy train: 0.993544 val: 0.948171 test: 0.952529
max validation accuracy : 0.950203 max acc epoch : 12 test accuracy : 0.950973

Epoch :  14 loss training:  7.560311702894978 Time :  181
accuracy train: 0.993902 val: 0.949187 test: 0.950195
max validation accuracy : 0.950203 max acc epoch : 12 test accuracy : 0.950973

Epoch :  15 loss training:  6.656034859828651 Time :  194
accuracy train: 0.994440 val: 0.948171 test: 0.951751
max validation accuracy : 0.950203 max acc epoch : 12 test accuracy : 0.950973

Epoch :  16 loss training:  6.77271247562021 Time :  207
accuracy train: 0.995158 val: 0.947154 test: 0.951751
max validation accuracy : 0.950203 max acc epoch : 12 test accuracy : 0.950973

Epoch :  17 loss training:  5.612371832830831 Time :  222
accuracy train: 0.995158 val: 0.951220 test: 0.953696
max validation accuracy : 0.951220 max acc epoch : 17 test accuracy : 0.953696

Epoch :  18 loss training:  5.586752091767266 Time :  237
accuracy train: 0.994620 val: 0.949187 test: 0.952918
max validation accuracy : 0.951220 max acc epoch : 17 test accuracy : 0.953696

Epoch :  19 loss training:  4.857900510774925 Time :  252
accuracy train: 0.995158 val: 0.945122 test: 0.948638
max validation accuracy : 0.951220 max acc epoch : 17 test accuracy : 0.953696

Epoch :  20 loss training:  5.168944590957835 Time :  266
accuracy train: 0.995516 val: 0.949187 test: 0.955642
max validation accuracy : 0.951220 max acc epoch : 17 test accuracy : 0.953696

Epoch :  21 loss training:  4.843235040316358 Time :  281
accuracy train: 0.995875 val: 0.951220 test: 0.952529
max validation accuracy : 0.951220 max acc epoch : 17 test accuracy : 0.953696

Epoch :  22 loss training:  4.603938533458859 Time :  295
accuracy train: 0.996593 val: 0.947154 test: 0.953307
max validation accuracy : 0.951220 max acc epoch : 17 test accuracy : 0.953696

Epoch :  23 loss training:  4.2398259959882125 Time :  309
accuracy train: 0.995696 val: 0.953252 test: 0.955253
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  24 loss training:  4.2031519239535555 Time :  323
accuracy train: 0.995158 val: 0.949187 test: 0.956420
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  25 loss training:  4.0110766352154315 Time :  336
accuracy train: 0.996772 val: 0.951220 test: 0.952529
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  26 loss training:  3.8608689649845473 Time :  349
accuracy train: 0.996593 val: 0.949187 test: 0.952529
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  27 loss training:  3.552184740663506 Time :  363
accuracy train: 0.996234 val: 0.953252 test: 0.954475
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  28 loss training:  3.915465666214004 Time :  376
accuracy train: 0.996772 val: 0.948171 test: 0.952529
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  29 loss training:  3.603640298359096 Time :  389
accuracy train: 0.996413 val: 0.947154 test: 0.953696
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  30 loss training:  3.2493301816284657 Time :  403
accuracy train: 0.996593 val: 0.951220 test: 0.950195
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  31 loss training:  3.2845963540894445 Time :  418
accuracy train: 0.996593 val: 0.948171 test: 0.954086
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  32 loss training:  3.4116650162031874 Time :  433
accuracy train: 0.996593 val: 0.952236 test: 0.952140
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  33 loss training:  3.023135699593695 Time :  448
accuracy train: 0.996413 val: 0.949187 test: 0.951751
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  34 loss training:  3.058990875200834 Time :  462
accuracy train: 0.996413 val: 0.953252 test: 0.954086
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  35 loss training:  3.236922308075009 Time :  477
accuracy train: 0.996772 val: 0.953252 test: 0.952529
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  36 loss training:  3.2215309898601845 Time :  492
accuracy train: 0.996234 val: 0.949187 test: 0.952140
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  37 loss training:  2.7098156479769386 Time :  506
accuracy train: 0.995875 val: 0.947154 test: 0.953307
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  38 loss training:  2.822359848563792 Time :  519
accuracy train: 0.996772 val: 0.953252 test: 0.952918
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  39 loss training:  2.7768039827642497 Time :  532
accuracy train: 0.996413 val: 0.950203 test: 0.949416
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  40 loss training:  3.0150248358841054 Time :  545
accuracy train: 0.996593 val: 0.946138 test: 0.949416
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  41 loss training:  2.6296190736466087 Time :  559
accuracy train: 0.996593 val: 0.949187 test: 0.955642
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  42 loss training:  2.9645512057759333 Time :  572
accuracy train: 0.995875 val: 0.945122 test: 0.952140
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  43 loss training:  2.694644172792323 Time :  585
accuracy train: 0.996413 val: 0.951220 test: 0.950584
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  44 loss training:  2.9099241864751093 Time :  600
accuracy train: 0.996593 val: 0.942073 test: 0.950973
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  45 loss training:  2.3617595417890698 Time :  614
accuracy train: 0.996951 val: 0.950203 test: 0.954086
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  46 loss training:  2.7162314280867577 Time :  628
accuracy train: 0.996772 val: 0.951220 test: 0.952918
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  47 loss training:  2.3592717906285543 Time :  642
accuracy train: 0.996413 val: 0.951220 test: 0.952918
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  48 loss training:  2.2423984597990056 Time :  657
accuracy train: 0.996234 val: 0.951220 test: 0.952140
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  49 loss training:  2.3869005801097956 Time :  672
accuracy train: 0.996234 val: 0.947154 test: 0.951751
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  50 loss training:  2.558223780564731 Time :  687
accuracy train: 0.996055 val: 0.952236 test: 0.952529
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  51 loss training:  2.210271194286179 Time :  702
accuracy train: 0.996413 val: 0.951220 test: 0.950584
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  52 loss training:  2.329301548146759 Time :  716
accuracy train: 0.996593 val: 0.949187 test: 0.947860
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  53 loss training:  2.426764326984994 Time :  731
accuracy train: 0.996413 val: 0.952236 test: 0.954086
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

Epoch :  54 loss training:  2.2980473889183486 Time :  745
accuracy train: 0.996593 val: 0.950203 test: 0.955253
max validation accuracy : 0.953252 max acc epoch : 23 test accuracy : 0.955253

========================================================================================================================================================================================================
best acc epoch :  23
validation accuracy :  0.9532520325203252
test accuracy :  0.9552529182879378
last test_accuracy :  0.9552529182879378
second best val :  0.9522357723577236
second best test :  0.9552529182879378
max gap 6
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=729, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  115.45784722268581 Time :  760
accuracy train: 0.909792 val: 0.880081 test: 0.899611
max validation accuracy : 0.880081 max acc epoch : 1 test accuracy : 0.899611
Epoch-1 lr: 0.001

Epoch :  2 loss training:  51.794089898467064 Time :  773
accuracy train: 0.943867 val: 0.901423 test: 0.913619
max validation accuracy : 0.901423 max acc epoch : 2 test accuracy : 0.913619
Epoch-2 lr: 0.001

Epoch :  3 loss training:  37.20071539282799 Time :  785
accuracy train: 0.956600 val: 0.916667 test: 0.925292
max validation accuracy : 0.916667 max acc epoch : 3 test accuracy : 0.925292
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  24.349117878824472 Time :  797
accuracy train: 0.974892 val: 0.935976 test: 0.935019
max validation accuracy : 0.935976 max acc epoch : 4 test accuracy : 0.935019
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  19.51066292077303 Time :  809
accuracy train: 0.980273 val: 0.942073 test: 0.936576
max validation accuracy : 0.942073 max acc epoch : 5 test accuracy : 0.936576
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  17.392965137027204 Time :  822
accuracy train: 0.980631 val: 0.940041 test: 0.935019
max validation accuracy : 0.942073 max acc epoch : 5 test accuracy : 0.936576
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  13.92820731876418 Time :  835
accuracy train: 0.988881 val: 0.948171 test: 0.945914
max validation accuracy : 0.948171 max acc epoch : 7 test accuracy : 0.945914
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  11.49199778586626 Time :  848
accuracy train: 0.990674 val: 0.947154 test: 0.947471
max validation accuracy : 0.948171 max acc epoch : 7 test accuracy : 0.945914
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  11.111683490686119 Time :  860
accuracy train: 0.991033 val: 0.949187 test: 0.947860
max validation accuracy : 0.949187 max acc epoch : 9 test accuracy : 0.947860
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  9.718054242432117 Time :  873
accuracy train: 0.992647 val: 0.942073 test: 0.947082
max validation accuracy : 0.949187 max acc epoch : 9 test accuracy : 0.947860

Epoch :  11 loss training:  9.321706991642714 Time :  887
accuracy train: 0.992109 val: 0.950203 test: 0.943969
max validation accuracy : 0.950203 max acc epoch : 11 test accuracy : 0.943969

Epoch :  12 loss training:  8.375885679619387 Time :  901
accuracy train: 0.993364 val: 0.948171 test: 0.948638
max validation accuracy : 0.950203 max acc epoch : 11 test accuracy : 0.943969

Epoch :  13 loss training:  7.64614622364752 Time :  915
accuracy train: 0.993185 val: 0.948171 test: 0.947860
max validation accuracy : 0.950203 max acc epoch : 11 test accuracy : 0.943969

Epoch :  14 loss training:  7.21764523210004 Time :  928
accuracy train: 0.993723 val: 0.948171 test: 0.945525
max validation accuracy : 0.950203 max acc epoch : 11 test accuracy : 0.943969

Epoch :  15 loss training:  7.51724551897496 Time :  942
accuracy train: 0.994440 val: 0.949187 test: 0.948638
max validation accuracy : 0.950203 max acc epoch : 11 test accuracy : 0.943969

Epoch :  16 loss training:  6.97862413385883 Time :  955
accuracy train: 0.993364 val: 0.953252 test: 0.944358
max validation accuracy : 0.953252 max acc epoch : 16 test accuracy : 0.944358

Epoch :  17 loss training:  6.448185823624954 Time :  968
accuracy train: 0.994620 val: 0.951220 test: 0.947860
max validation accuracy : 0.953252 max acc epoch : 16 test accuracy : 0.944358

Epoch :  18 loss training:  6.044107901863754 Time :  982
accuracy train: 0.994261 val: 0.950203 test: 0.946693
max validation accuracy : 0.953252 max acc epoch : 16 test accuracy : 0.944358

Epoch :  19 loss training:  5.924287763191387 Time :  995
accuracy train: 0.994799 val: 0.953252 test: 0.946304
max validation accuracy : 0.953252 max acc epoch : 16 test accuracy : 0.944358

Epoch :  20 loss training:  5.216991270426661 Time :  1009
accuracy train: 0.994799 val: 0.951220 test: 0.949805
max validation accuracy : 0.953252 max acc epoch : 16 test accuracy : 0.944358

Epoch :  21 loss training:  5.16793634952046 Time :  1022
accuracy train: 0.995337 val: 0.951220 test: 0.952140
max validation accuracy : 0.953252 max acc epoch : 16 test accuracy : 0.944358

Epoch :  22 loss training:  4.612214121967554 Time :  1035
accuracy train: 0.995158 val: 0.949187 test: 0.948249
max validation accuracy : 0.953252 max acc epoch : 16 test accuracy : 0.944358

Epoch :  23 loss training:  4.747170791262761 Time :  1049
accuracy train: 0.995875 val: 0.952236 test: 0.947471
max validation accuracy : 0.953252 max acc epoch : 16 test accuracy : 0.944358

Epoch :  24 loss training:  4.219734143931419 Time :  1062
accuracy train: 0.995696 val: 0.947154 test: 0.949027
max validation accuracy : 0.953252 max acc epoch : 16 test accuracy : 0.944358

Epoch :  25 loss training:  4.612412251648493 Time :  1075
accuracy train: 0.996234 val: 0.947154 test: 0.950584
max validation accuracy : 0.953252 max acc epoch : 16 test accuracy : 0.944358

Epoch :  26 loss training:  4.294867922319099 Time :  1089
accuracy train: 0.996055 val: 0.948171 test: 0.945914
max validation accuracy : 0.953252 max acc epoch : 16 test accuracy : 0.944358

Epoch :  27 loss training:  3.600845656939782 Time :  1102
accuracy train: 0.995516 val: 0.948171 test: 0.947471
max validation accuracy : 0.953252 max acc epoch : 16 test accuracy : 0.944358

Epoch :  28 loss training:  4.609578495786991 Time :  1115
accuracy train: 0.996055 val: 0.951220 test: 0.948249
max validation accuracy : 0.953252 max acc epoch : 16 test accuracy : 0.944358

Epoch :  29 loss training:  3.592396484222263 Time :  1129
accuracy train: 0.996055 val: 0.947154 test: 0.946693
max validation accuracy : 0.953252 max acc epoch : 16 test accuracy : 0.944358

Epoch :  30 loss training:  3.634128321893513 Time :  1142
accuracy train: 0.996055 val: 0.945122 test: 0.949805
max validation accuracy : 0.953252 max acc epoch : 16 test accuracy : 0.944358

Epoch :  31 loss training:  3.488369078200776 Time :  1155
accuracy train: 0.995875 val: 0.952236 test: 0.947860
max validation accuracy : 0.953252 max acc epoch : 16 test accuracy : 0.944358

Epoch :  32 loss training:  3.4234409870114177 Time :  1169
accuracy train: 0.996593 val: 0.952236 test: 0.947860
max validation accuracy : 0.953252 max acc epoch : 16 test accuracy : 0.944358

Epoch :  33 loss training:  3.556303259858396 Time :  1182
accuracy train: 0.996055 val: 0.950203 test: 0.948249
max validation accuracy : 0.953252 max acc epoch : 16 test accuracy : 0.944358

Epoch :  34 loss training:  3.3764145188615657 Time :  1195
accuracy train: 0.995875 val: 0.952236 test: 0.951751
max validation accuracy : 0.953252 max acc epoch : 16 test accuracy : 0.944358

Epoch :  35 loss training:  2.992455612111371 Time :  1209
accuracy train: 0.996593 val: 0.952236 test: 0.949027
max validation accuracy : 0.953252 max acc epoch : 16 test accuracy : 0.944358

Epoch :  36 loss training:  3.016400994238211 Time :  1222
accuracy train: 0.995875 val: 0.956301 test: 0.949027
max validation accuracy : 0.956301 max acc epoch : 36 test accuracy : 0.949027

Epoch :  37 loss training:  2.8932710959779797 Time :  1236
accuracy train: 0.996055 val: 0.955285 test: 0.948638
max validation accuracy : 0.956301 max acc epoch : 36 test accuracy : 0.949027

Epoch :  38 loss training:  3.335953322297428 Time :  1249
accuracy train: 0.996055 val: 0.955285 test: 0.950195
max validation accuracy : 0.956301 max acc epoch : 36 test accuracy : 0.949027

Epoch :  39 loss training:  3.048034630541224 Time :  1262
accuracy train: 0.996234 val: 0.954268 test: 0.950973
max validation accuracy : 0.956301 max acc epoch : 36 test accuracy : 0.949027

Epoch :  40 loss training:  3.158842214848846 Time :  1276
accuracy train: 0.996234 val: 0.953252 test: 0.949805
max validation accuracy : 0.956301 max acc epoch : 36 test accuracy : 0.949027

Epoch :  41 loss training:  2.579305648803711 Time :  1289
accuracy train: 0.996234 val: 0.955285 test: 0.951362
max validation accuracy : 0.956301 max acc epoch : 36 test accuracy : 0.949027

Epoch :  42 loss training:  3.0938604291004594 Time :  1302
accuracy train: 0.996055 val: 0.956301 test: 0.947860
max validation accuracy : 0.956301 max acc epoch : 36 test accuracy : 0.949027

Epoch :  43 loss training:  3.0913544598734006 Time :  1316
accuracy train: 0.996055 val: 0.952236 test: 0.948638
max validation accuracy : 0.956301 max acc epoch : 36 test accuracy : 0.949027

Epoch :  44 loss training:  2.656109562900383 Time :  1330
accuracy train: 0.995875 val: 0.950203 test: 0.950584
max validation accuracy : 0.956301 max acc epoch : 36 test accuracy : 0.949027

Epoch :  45 loss training:  2.8236044408695307 Time :  1344
accuracy train: 0.996234 val: 0.953252 test: 0.949805
max validation accuracy : 0.956301 max acc epoch : 36 test accuracy : 0.949027

Epoch :  46 loss training:  2.812138497378328 Time :  1358
accuracy train: 0.996593 val: 0.951220 test: 0.953696
max validation accuracy : 0.956301 max acc epoch : 36 test accuracy : 0.949027

Epoch :  47 loss training:  2.317488809087081 Time :  1372
accuracy train: 0.996593 val: 0.955285 test: 0.952918
max validation accuracy : 0.956301 max acc epoch : 36 test accuracy : 0.949027

Epoch :  48 loss training:  2.7864934519748203 Time :  1387
accuracy train: 0.996234 val: 0.953252 test: 0.949027
max validation accuracy : 0.956301 max acc epoch : 36 test accuracy : 0.949027

Epoch :  49 loss training:  2.3629577600950142 Time :  1401
accuracy train: 0.996413 val: 0.953252 test: 0.948638
max validation accuracy : 0.956301 max acc epoch : 36 test accuracy : 0.949027

Epoch :  50 loss training:  2.4638201398338424 Time :  1416
accuracy train: 0.996413 val: 0.953252 test: 0.950584
max validation accuracy : 0.956301 max acc epoch : 36 test accuracy : 0.949027

Epoch :  51 loss training:  2.6479791888559703 Time :  1430
accuracy train: 0.996234 val: 0.956301 test: 0.947860
max validation accuracy : 0.956301 max acc epoch : 36 test accuracy : 0.949027

Epoch :  52 loss training:  2.907681935437722 Time :  1444
accuracy train: 0.996055 val: 0.952236 test: 0.945136
max validation accuracy : 0.956301 max acc epoch : 36 test accuracy : 0.949027

Epoch :  53 loss training:  2.2665458049450535 Time :  1458
accuracy train: 0.996413 val: 0.953252 test: 0.946304
max validation accuracy : 0.956301 max acc epoch : 36 test accuracy : 0.949027

Epoch :  54 loss training:  2.226539870200213 Time :  1472
accuracy train: 0.995875 val: 0.950203 test: 0.950973
max validation accuracy : 0.956301 max acc epoch : 36 test accuracy : 0.949027

Epoch :  55 loss training:  2.3730293372500455 Time :  1487
accuracy train: 0.996234 val: 0.956301 test: 0.950195
max validation accuracy : 0.956301 max acc epoch : 36 test accuracy : 0.949027

Epoch :  56 loss training:  2.531568075879477 Time :  1501
accuracy train: 0.996413 val: 0.955285 test: 0.948249
max validation accuracy : 0.956301 max acc epoch : 36 test accuracy : 0.949027

Epoch :  57 loss training:  2.3360964045132278 Time :  1516
accuracy train: 0.996055 val: 0.951220 test: 0.950584
max validation accuracy : 0.956301 max acc epoch : 36 test accuracy : 0.949027

Epoch :  58 loss training:  2.3463512200542027 Time :  1531
accuracy train: 0.996593 val: 0.951220 test: 0.947471
max validation accuracy : 0.956301 max acc epoch : 36 test accuracy : 0.949027

Epoch :  59 loss training:  2.1919050826181774 Time :  1545
accuracy train: 0.996413 val: 0.952236 test: 0.947471
max validation accuracy : 0.956301 max acc epoch : 36 test accuracy : 0.949027

Epoch :  60 loss training:  2.230675310114748 Time :  1560
accuracy train: 0.996234 val: 0.957317 test: 0.947860
max validation accuracy : 0.957317 max acc epoch : 60 test accuracy : 0.947860

Epoch :  61 loss training:  2.5727044967061374 Time :  1574
accuracy train: 0.996055 val: 0.954268 test: 0.950973
max validation accuracy : 0.957317 max acc epoch : 60 test accuracy : 0.947860

Epoch :  62 loss training:  2.5628066691861022 Time :  1589
accuracy train: 0.996055 val: 0.957317 test: 0.950584
max validation accuracy : 0.957317 max acc epoch : 60 test accuracy : 0.947860

Epoch :  63 loss training:  2.354368299616908 Time :  1603
accuracy train: 0.996413 val: 0.950203 test: 0.944358
max validation accuracy : 0.957317 max acc epoch : 60 test accuracy : 0.947860

Epoch :  64 loss training:  2.3938107721769484 Time :  1618
accuracy train: 0.996413 val: 0.958333 test: 0.946304
max validation accuracy : 0.958333 max acc epoch : 64 test accuracy : 0.946304

Epoch :  65 loss training:  2.1638493092686986 Time :  1633
accuracy train: 0.996234 val: 0.955285 test: 0.948249
max validation accuracy : 0.958333 max acc epoch : 64 test accuracy : 0.946304

Epoch :  66 loss training:  2.2571228593878914 Time :  1647
accuracy train: 0.996234 val: 0.956301 test: 0.949805
max validation accuracy : 0.958333 max acc epoch : 64 test accuracy : 0.946304

Epoch :  67 loss training:  2.401039532800496 Time :  1660
accuracy train: 0.996413 val: 0.957317 test: 0.950973
max validation accuracy : 0.958333 max acc epoch : 64 test accuracy : 0.946304

Epoch :  68 loss training:  2.2018557659030193 Time :  1674
accuracy train: 0.996772 val: 0.956301 test: 0.949805
max validation accuracy : 0.958333 max acc epoch : 64 test accuracy : 0.946304

Epoch :  69 loss training:  2.104513610014692 Time :  1689
accuracy train: 0.996234 val: 0.951220 test: 0.947860
max validation accuracy : 0.958333 max acc epoch : 64 test accuracy : 0.946304

Epoch :  70 loss training:  2.7368735125237436 Time :  1704
accuracy train: 0.996413 val: 0.954268 test: 0.947471
max validation accuracy : 0.958333 max acc epoch : 64 test accuracy : 0.946304

Epoch :  71 loss training:  1.973950139239605 Time :  1718
accuracy train: 0.996593 val: 0.953252 test: 0.946693
max validation accuracy : 0.958333 max acc epoch : 64 test accuracy : 0.946304

Epoch :  72 loss training:  2.1333984713128302 Time :  1732
accuracy train: 0.996772 val: 0.954268 test: 0.947082
max validation accuracy : 0.958333 max acc epoch : 64 test accuracy : 0.946304

Epoch :  73 loss training:  2.3030706982535776 Time :  1747
accuracy train: 0.996413 val: 0.951220 test: 0.950195
max validation accuracy : 0.958333 max acc epoch : 64 test accuracy : 0.946304

Epoch :  74 loss training:  2.1113380406968645 Time :  1762
accuracy train: 0.996772 val: 0.951220 test: 0.949805
max validation accuracy : 0.958333 max acc epoch : 64 test accuracy : 0.946304

Epoch :  75 loss training:  1.9101934069549316 Time :  1777
accuracy train: 0.996772 val: 0.956301 test: 0.949805
max validation accuracy : 0.958333 max acc epoch : 64 test accuracy : 0.946304

Epoch :  76 loss training:  2.1118414493612363 Time :  1791
accuracy train: 0.996772 val: 0.956301 test: 0.950584
max validation accuracy : 0.958333 max acc epoch : 64 test accuracy : 0.946304

Epoch :  77 loss training:  2.2003823580089374 Time :  1805
accuracy train: 0.996772 val: 0.957317 test: 0.951751
max validation accuracy : 0.958333 max acc epoch : 64 test accuracy : 0.946304

Epoch :  78 loss training:  2.1827334830668406 Time :  1819
accuracy train: 0.996234 val: 0.959350 test: 0.952140
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  79 loss training:  2.0988401171780424 Time :  1832
accuracy train: 0.996234 val: 0.956301 test: 0.951362
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  80 loss training:  2.0947464832279366 Time :  1846
accuracy train: 0.996055 val: 0.955285 test: 0.952918
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  81 loss training:  1.8576000236716936 Time :  1859
accuracy train: 0.996772 val: 0.953252 test: 0.949416
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  82 loss training:  2.0586682878565625 Time :  1872
accuracy train: 0.996055 val: 0.956301 test: 0.951362
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  83 loss training:  1.8743421694925928 Time :  1886
accuracy train: 0.996772 val: 0.957317 test: 0.951362
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  84 loss training:  2.013627354215714 Time :  1899
accuracy train: 0.996413 val: 0.955285 test: 0.952918
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  85 loss training:  1.9759404715532582 Time :  1913
accuracy train: 0.996413 val: 0.955285 test: 0.949416
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  86 loss training:  2.1705679417391366 Time :  1928
accuracy train: 0.996234 val: 0.952236 test: 0.951362
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  87 loss training:  1.9823577149945777 Time :  1943
accuracy train: 0.996413 val: 0.955285 test: 0.947471
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  88 loss training:  1.9933964251977159 Time :  1958
accuracy train: 0.996772 val: 0.955285 test: 0.948249
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  89 loss training:  1.838355715968646 Time :  1972
accuracy train: 0.996234 val: 0.955285 test: 0.950584
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  90 loss training:  1.8691915212766617 Time :  1986
accuracy train: 0.996413 val: 0.957317 test: 0.951362
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  91 loss training:  2.167733558177133 Time :  1999
accuracy train: 0.996055 val: 0.951220 test: 0.949805
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  92 loss training:  2.0032175636515603 Time :  2012
accuracy train: 0.996593 val: 0.953252 test: 0.950584
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  93 loss training:  2.084617716838693 Time :  2025
accuracy train: 0.996772 val: 0.949187 test: 0.952918
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  94 loss training:  1.9593460137075454 Time :  2039
accuracy train: 0.996593 val: 0.952236 test: 0.947860
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  95 loss training:  1.8704425215637457 Time :  2053
accuracy train: 0.995875 val: 0.955285 test: 0.953696
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  96 loss training:  1.855041165050352 Time :  2066
accuracy train: 0.996772 val: 0.955285 test: 0.949027
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  97 loss training:  1.7938216096008546 Time :  2080
accuracy train: 0.996772 val: 0.956301 test: 0.951362
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  98 loss training:  1.7774688025237992 Time :  2093
accuracy train: 0.996772 val: 0.952236 test: 0.948249
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  99 loss training:  1.8164780881488696 Time :  2107
accuracy train: 0.996593 val: 0.954268 test: 0.952529
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  100 loss training:  1.8055961691816265 Time :  2122
accuracy train: 0.996772 val: 0.954268 test: 0.951751
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  101 loss training:  1.7556651017721379 Time :  2137
accuracy train: 0.996593 val: 0.954268 test: 0.950195
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  102 loss training:  2.1063088442970184 Time :  2151
accuracy train: 0.996772 val: 0.954268 test: 0.950584
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  103 loss training:  1.7806811373920937 Time :  2165
accuracy train: 0.996772 val: 0.954268 test: 0.949416
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  104 loss training:  1.8790229814439954 Time :  2180
accuracy train: 0.996772 val: 0.952236 test: 0.947471
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  105 loss training:  1.8727636296916899 Time :  2195
accuracy train: 0.996593 val: 0.953252 test: 0.949416
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  106 loss training:  1.934098393883687 Time :  2210
accuracy train: 0.996234 val: 0.956301 test: 0.953307
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  107 loss training:  1.8991321113717277 Time :  2224
accuracy train: 0.996413 val: 0.952236 test: 0.948638
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  108 loss training:  1.697624650232683 Time :  2238
accuracy train: 0.996772 val: 0.957317 test: 0.950195
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

Epoch :  109 loss training:  1.907521650675335 Time :  2252
accuracy train: 0.996413 val: 0.959350 test: 0.951751
max validation accuracy : 0.959350 max acc epoch : 78 test accuracy : 0.952140

========================================================================================================================================================================================================
best acc epoch :  78
validation accuracy :  0.959349593495935
test accuracy :  0.9521400778210116
last test_accuracy :  0.9517509727626459
second best val :  0.9583333333333334
second best test :  0.9463035019455253
max gap 24
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  23 	 val_accuracy : 0.95325 	 test_accuracy : 0.95525 	 last test_accuracy : 0.95525 	 second best val : 0.95224 	 second best test : 0.95525
k :  1 	 best_acc epoch :  78 	 val_accuracy : 0.95935 	 test_accuracy : 0.95214 	 last test_accuracy : 0.95175 	 second best val : 0.95833 	 second best test : 0.94630

avg :  	 val_accuracy : 0.95630 	 test_accuracy : 0.95370 	 last_accuracy : 0.95350 	 second best val : 0.95528 	 second best test : 0.95078

std :  	 val_accuracy : 0.00305 	 test_accuracy : 0.00156 	 last_accuracy : 0.00175 	 second best val : 0.00305 	 second best test : 0.00447


date and time :  Sun Jul  4 18:18:56 2021
itr : 0
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=64, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  125.47958715260029 Time :  14
accuracy train: 0.905667 val: 0.904472 test: 0.888327
max validation accuracy : 0.904472 max acc epoch : 1 test accuracy : 0.888327
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.468845531344414 Time :  30
accuracy train: 0.941176 val: 0.920732 test: 0.909728
max validation accuracy : 0.920732 max acc epoch : 2 test accuracy : 0.909728
Epoch-2 lr: 0.001

Epoch :  3 loss training:  40.025337709113955 Time :  45
accuracy train: 0.952475 val: 0.929878 test: 0.920233
max validation accuracy : 0.929878 max acc epoch : 3 test accuracy : 0.920233
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  26.848457186482847 Time :  59
accuracy train: 0.968077 val: 0.933943 test: 0.932296
max validation accuracy : 0.933943 max acc epoch : 4 test accuracy : 0.932296
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  22.749054180458188 Time :  73
accuracy train: 0.975789 val: 0.936992 test: 0.935798
max validation accuracy : 0.936992 max acc epoch : 5 test accuracy : 0.935798
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  19.31943173520267 Time :  89
accuracy train: 0.977762 val: 0.938008 test: 0.937354
max validation accuracy : 0.938008 max acc epoch : 6 test accuracy : 0.937354
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  15.919138255529106 Time :  105
accuracy train: 0.985294 val: 0.946138 test: 0.944358
max validation accuracy : 0.946138 max acc epoch : 7 test accuracy : 0.944358
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  13.366277267225087 Time :  121
accuracy train: 0.988164 val: 0.941057 test: 0.943191
max validation accuracy : 0.946138 max acc epoch : 7 test accuracy : 0.944358
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  12.701011499855667 Time :  137
accuracy train: 0.987088 val: 0.944106 test: 0.945136
max validation accuracy : 0.946138 max acc epoch : 7 test accuracy : 0.944358
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  11.251268229912966 Time :  153
accuracy train: 0.990136 val: 0.945122 test: 0.944747
max validation accuracy : 0.946138 max acc epoch : 7 test accuracy : 0.944358

Epoch :  11 loss training:  10.634050342720002 Time :  171
accuracy train: 0.991212 val: 0.947154 test: 0.944747
max validation accuracy : 0.947154 max acc epoch : 11 test accuracy : 0.944747

Epoch :  12 loss training:  9.833295977441594 Time :  188
accuracy train: 0.992647 val: 0.947154 test: 0.941245
max validation accuracy : 0.947154 max acc epoch : 11 test accuracy : 0.944747

Epoch :  13 loss training:  8.82006001076661 Time :  205
accuracy train: 0.994261 val: 0.945122 test: 0.945525
max validation accuracy : 0.947154 max acc epoch : 11 test accuracy : 0.944747

Epoch :  14 loss training:  8.64188325125724 Time :  223
accuracy train: 0.993006 val: 0.944106 test: 0.941634
max validation accuracy : 0.947154 max acc epoch : 11 test accuracy : 0.944747

Epoch :  15 loss training:  7.183860606048256 Time :  241
accuracy train: 0.993902 val: 0.945122 test: 0.942802
max validation accuracy : 0.947154 max acc epoch : 11 test accuracy : 0.944747

Epoch :  16 loss training:  7.770693121943623 Time :  260
accuracy train: 0.994440 val: 0.944106 test: 0.945136
max validation accuracy : 0.947154 max acc epoch : 11 test accuracy : 0.944747

Epoch :  17 loss training:  7.4043428734876215 Time :  278
accuracy train: 0.994978 val: 0.945122 test: 0.944358
max validation accuracy : 0.947154 max acc epoch : 11 test accuracy : 0.944747

Epoch :  18 loss training:  6.460833323886618 Time :  297
accuracy train: 0.995696 val: 0.946138 test: 0.943191
max validation accuracy : 0.947154 max acc epoch : 11 test accuracy : 0.944747

Epoch :  19 loss training:  6.377481209812686 Time :  316
accuracy train: 0.995516 val: 0.945122 test: 0.948249
max validation accuracy : 0.947154 max acc epoch : 11 test accuracy : 0.944747

Epoch :  20 loss training:  5.756439468823373 Time :  335
accuracy train: 0.995875 val: 0.947154 test: 0.943580
max validation accuracy : 0.947154 max acc epoch : 11 test accuracy : 0.944747

Epoch :  21 loss training:  5.809679863508791 Time :  353
accuracy train: 0.995337 val: 0.948171 test: 0.947471
max validation accuracy : 0.948171 max acc epoch : 21 test accuracy : 0.947471

Epoch :  22 loss training:  5.604464243398979 Time :  372
accuracy train: 0.995516 val: 0.949187 test: 0.945914
max validation accuracy : 0.949187 max acc epoch : 22 test accuracy : 0.945914

Epoch :  23 loss training:  5.074627794791013 Time :  391
accuracy train: 0.996413 val: 0.950203 test: 0.942802
max validation accuracy : 0.950203 max acc epoch : 23 test accuracy : 0.942802

Epoch :  24 loss training:  4.819356925436296 Time :  411
accuracy train: 0.996234 val: 0.952236 test: 0.948249
max validation accuracy : 0.952236 max acc epoch : 24 test accuracy : 0.948249

Epoch :  25 loss training:  4.846339026931673 Time :  428
accuracy train: 0.996413 val: 0.946138 test: 0.942802
max validation accuracy : 0.952236 max acc epoch : 24 test accuracy : 0.948249

Epoch :  26 loss training:  4.185978419613093 Time :  447
accuracy train: 0.996413 val: 0.953252 test: 0.945914
max validation accuracy : 0.953252 max acc epoch : 26 test accuracy : 0.945914

Epoch :  27 loss training:  4.535008504928555 Time :  466
accuracy train: 0.996234 val: 0.948171 test: 0.949805
max validation accuracy : 0.953252 max acc epoch : 26 test accuracy : 0.945914

Epoch :  28 loss training:  3.752856620005332 Time :  486
accuracy train: 0.996413 val: 0.948171 test: 0.943191
max validation accuracy : 0.953252 max acc epoch : 26 test accuracy : 0.945914

Epoch :  29 loss training:  4.096007620333694 Time :  505
accuracy train: 0.996593 val: 0.953252 test: 0.947860
max validation accuracy : 0.953252 max acc epoch : 26 test accuracy : 0.945914

Epoch :  30 loss training:  3.5009758872329257 Time :  524
accuracy train: 0.996772 val: 0.946138 test: 0.947471
max validation accuracy : 0.953252 max acc epoch : 26 test accuracy : 0.945914

Epoch :  31 loss training:  3.6367257426609285 Time :  542
accuracy train: 0.996234 val: 0.953252 test: 0.947860
max validation accuracy : 0.953252 max acc epoch : 26 test accuracy : 0.945914

Epoch :  32 loss training:  3.45392323328997 Time :  559
accuracy train: 0.996593 val: 0.955285 test: 0.947860
max validation accuracy : 0.955285 max acc epoch : 32 test accuracy : 0.947860

Epoch :  33 loss training:  3.3140348899178207 Time :  578
accuracy train: 0.996951 val: 0.951220 test: 0.945914
max validation accuracy : 0.955285 max acc epoch : 32 test accuracy : 0.947860

Epoch :  34 loss training:  2.705281235219445 Time :  595
accuracy train: 0.996772 val: 0.951220 test: 0.948249
max validation accuracy : 0.955285 max acc epoch : 32 test accuracy : 0.947860

Epoch :  35 loss training:  2.5659744460717775 Time :  613
accuracy train: 0.996772 val: 0.953252 test: 0.949805
max validation accuracy : 0.955285 max acc epoch : 32 test accuracy : 0.947860

Epoch :  36 loss training:  3.236071714753052 Time :  632
accuracy train: 0.996772 val: 0.954268 test: 0.946304
max validation accuracy : 0.955285 max acc epoch : 32 test accuracy : 0.947860

Epoch :  37 loss training:  3.3588542848010547 Time :  651
accuracy train: 0.996951 val: 0.947154 test: 0.943191
max validation accuracy : 0.955285 max acc epoch : 32 test accuracy : 0.947860

Epoch :  38 loss training:  2.6129788506950717 Time :  668
accuracy train: 0.997310 val: 0.948171 test: 0.952140
max validation accuracy : 0.955285 max acc epoch : 32 test accuracy : 0.947860

Epoch :  39 loss training:  2.8743258484173566 Time :  686
accuracy train: 0.997131 val: 0.952236 test: 0.947082
max validation accuracy : 0.955285 max acc epoch : 32 test accuracy : 0.947860

Epoch :  40 loss training:  3.0021596896112897 Time :  706
accuracy train: 0.996951 val: 0.947154 test: 0.945914
max validation accuracy : 0.955285 max acc epoch : 32 test accuracy : 0.947860

Epoch :  41 loss training:  2.5835897974320687 Time :  724
accuracy train: 0.996772 val: 0.947154 test: 0.945136
max validation accuracy : 0.955285 max acc epoch : 32 test accuracy : 0.947860

Epoch :  42 loss training:  2.45509816633421 Time :  742
accuracy train: 0.996951 val: 0.948171 test: 0.946693
max validation accuracy : 0.955285 max acc epoch : 32 test accuracy : 0.947860

Epoch :  43 loss training:  2.6694188511901302 Time :  761
accuracy train: 0.996772 val: 0.950203 test: 0.948249
max validation accuracy : 0.955285 max acc epoch : 32 test accuracy : 0.947860

Epoch :  44 loss training:  2.8769818764849333 Time :  779
accuracy train: 0.996951 val: 0.951220 test: 0.945525
max validation accuracy : 0.955285 max acc epoch : 32 test accuracy : 0.947860

Epoch :  45 loss training:  2.56535672058817 Time :  797
accuracy train: 0.997310 val: 0.955285 test: 0.947860
max validation accuracy : 0.955285 max acc epoch : 32 test accuracy : 0.947860

Epoch :  46 loss training:  2.246406220307108 Time :  816
accuracy train: 0.997310 val: 0.957317 test: 0.946693
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  47 loss training:  2.3422919451550115 Time :  837
accuracy train: 0.996772 val: 0.946138 test: 0.942412
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  48 loss training:  2.2131659194346867 Time :  855
accuracy train: 0.997131 val: 0.954268 test: 0.946693
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  49 loss training:  2.2848047215666156 Time :  873
accuracy train: 0.997131 val: 0.946138 test: 0.947082
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  50 loss training:  2.411962712649256 Time :  893
accuracy train: 0.996951 val: 0.951220 test: 0.947471
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  51 loss training:  2.7293677365523763 Time :  910
accuracy train: 0.996593 val: 0.951220 test: 0.947082
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  52 loss training:  2.4096506960049737 Time :  929
accuracy train: 0.997131 val: 0.954268 test: 0.946693
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  53 loss training:  2.3835191849648254 Time :  947
accuracy train: 0.997131 val: 0.954268 test: 0.947082
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  54 loss training:  2.135502042758162 Time :  967
accuracy train: 0.996772 val: 0.957317 test: 0.952918
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  55 loss training:  2.11493937594787 Time :  985
accuracy train: 0.996951 val: 0.951220 test: 0.949416
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  56 loss training:  1.9607860836258624 Time :  1003
accuracy train: 0.995158 val: 0.948171 test: 0.949805
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  57 loss training:  2.147076821755036 Time :  1022
accuracy train: 0.997131 val: 0.956301 test: 0.947082
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  58 loss training:  1.880875782640942 Time :  1041
accuracy train: 0.997131 val: 0.953252 test: 0.947082
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  59 loss training:  1.7010858095891308 Time :  1059
accuracy train: 0.996772 val: 0.952236 test: 0.949027
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  60 loss training:  2.3429095912724733 Time :  1079
accuracy train: 0.996951 val: 0.950203 test: 0.950195
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  61 loss training:  2.0461312316401745 Time :  1099
accuracy train: 0.996951 val: 0.952236 test: 0.949416
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  62 loss training:  2.2874529069231357 Time :  1117
accuracy train: 0.996951 val: 0.948171 test: 0.946304
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  63 loss training:  2.06462393237598 Time :  1135
accuracy train: 0.996772 val: 0.954268 test: 0.950584
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  64 loss training:  2.152302658840199 Time :  1153
accuracy train: 0.997131 val: 0.955285 test: 0.949027
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  65 loss training:  2.0523373617797915 Time :  1171
accuracy train: 0.997131 val: 0.953252 test: 0.947471
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  66 loss training:  2.1685265674313996 Time :  1191
accuracy train: 0.996772 val: 0.951220 test: 0.950584
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  67 loss training:  2.015972209039319 Time :  1209
accuracy train: 0.997131 val: 0.952236 test: 0.951362
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  68 loss training:  2.0516967570438283 Time :  1227
accuracy train: 0.996951 val: 0.953252 test: 0.948638
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  69 loss training:  2.0527843870841025 Time :  1246
accuracy train: 0.997131 val: 0.952236 test: 0.949416
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  70 loss training:  1.8966181156647508 Time :  1265
accuracy train: 0.996951 val: 0.955285 test: 0.953307
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  71 loss training:  1.660004620498512 Time :  1283
accuracy train: 0.997131 val: 0.954268 test: 0.947471
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  72 loss training:  1.859728801118763 Time :  1300
accuracy train: 0.997310 val: 0.955285 test: 0.950973
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  73 loss training:  1.9739889602351468 Time :  1317
accuracy train: 0.996951 val: 0.956301 test: 0.948638
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  74 loss training:  2.0799547564820386 Time :  1337
accuracy train: 0.997131 val: 0.956301 test: 0.949027
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  75 loss training:  1.9376770270973793 Time :  1355
accuracy train: 0.997131 val: 0.956301 test: 0.941634
max validation accuracy : 0.957317 max acc epoch : 46 test accuracy : 0.946693

Epoch :  76 loss training:  1.8415639747618116 Time :  1374
accuracy train: 0.997310 val: 0.959350 test: 0.949416
max validation accuracy : 0.959350 max acc epoch : 76 test accuracy : 0.949416

Epoch :  77 loss training:  1.9781531778062345 Time :  1393
accuracy train: 0.996951 val: 0.953252 test: 0.949805
max validation accuracy : 0.959350 max acc epoch : 76 test accuracy : 0.949416

Epoch :  78 loss training:  1.671591295475082 Time :  1414
accuracy train: 0.996413 val: 0.956301 test: 0.950195
max validation accuracy : 0.959350 max acc epoch : 76 test accuracy : 0.949416

Epoch :  79 loss training:  1.8183145153234364 Time :  1432
accuracy train: 0.997131 val: 0.960366 test: 0.951362
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  80 loss training:  1.8110194229557237 Time :  1451
accuracy train: 0.997131 val: 0.954268 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  81 loss training:  1.7790830028025084 Time :  1471
accuracy train: 0.997310 val: 0.960366 test: 0.949805
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  82 loss training:  1.8695862069580471 Time :  1488
accuracy train: 0.997310 val: 0.955285 test: 0.950584
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  83 loss training:  1.8588583248529176 Time :  1506
accuracy train: 0.997310 val: 0.955285 test: 0.951751
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  84 loss training:  2.368646322625864 Time :  1525
accuracy train: 0.997310 val: 0.953252 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  85 loss training:  1.7577442878173315 Time :  1543
accuracy train: 0.997310 val: 0.952236 test: 0.950973
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  86 loss training:  2.1113495714998862 Time :  1562
accuracy train: 0.997131 val: 0.958333 test: 0.943191
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  87 loss training:  1.889908487581124 Time :  1581
accuracy train: 0.997131 val: 0.954268 test: 0.946304
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  88 loss training:  1.911355717231345 Time :  1599
accuracy train: 0.997310 val: 0.952236 test: 0.947082
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  89 loss training:  1.6240665269069723 Time :  1618
accuracy train: 0.997310 val: 0.955285 test: 0.949416
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  90 loss training:  1.8787516618249356 Time :  1636
accuracy train: 0.997310 val: 0.957317 test: 0.953696
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  91 loss training:  1.634184244692733 Time :  1654
accuracy train: 0.997310 val: 0.956301 test: 0.954086
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  92 loss training:  1.4470779648290772 Time :  1673
accuracy train: 0.997131 val: 0.955285 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  93 loss training:  1.8642464898948674 Time :  1691
accuracy train: 0.996951 val: 0.954268 test: 0.949805
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  94 loss training:  1.599861715501902 Time :  1709
accuracy train: 0.996772 val: 0.949187 test: 0.949027
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  95 loss training:  1.5362580626151612 Time :  1727
accuracy train: 0.997131 val: 0.953252 test: 0.950973
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  96 loss training:  1.75835978653231 Time :  1745
accuracy train: 0.997310 val: 0.952236 test: 0.946304
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  97 loss training:  1.6114868681615917 Time :  1763
accuracy train: 0.996951 val: 0.954268 test: 0.948638
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  98 loss training:  2.2512139625941927 Time :  1783
accuracy train: 0.997131 val: 0.952236 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  99 loss training:  1.6641169548529433 Time :  1801
accuracy train: 0.997131 val: 0.949187 test: 0.942802
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  100 loss training:  1.663949069697992 Time :  1819
accuracy train: 0.997131 val: 0.957317 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  101 loss training:  1.6311322236142587 Time :  1836
accuracy train: 0.997131 val: 0.954268 test: 0.948638
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  102 loss training:  1.41298850531075 Time :  1855
accuracy train: 0.997310 val: 0.954268 test: 0.949416
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  103 loss training:  1.8291501187413814 Time :  1874
accuracy train: 0.996772 val: 0.955285 test: 0.949805
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  104 loss training:  1.583458811026503 Time :  1894
accuracy train: 0.996951 val: 0.954268 test: 0.949416
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  105 loss training:  1.641902044391827 Time :  1913
accuracy train: 0.996951 val: 0.955285 test: 0.946693
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  106 loss training:  1.4775851872145722 Time :  1931
accuracy train: 0.997131 val: 0.958333 test: 0.950584
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  107 loss training:  1.532913815273787 Time :  1950
accuracy train: 0.997310 val: 0.953252 test: 0.950584
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  108 loss training:  1.6110137328214478 Time :  1967
accuracy train: 0.997310 val: 0.957317 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  109 loss training:  1.7750537908214028 Time :  1985
accuracy train: 0.996951 val: 0.958333 test: 0.951362
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

Epoch :  110 loss training:  1.581971963201795 Time :  2004
accuracy train: 0.996951 val: 0.960366 test: 0.949805
max validation accuracy : 0.960366 max acc epoch : 79 test accuracy : 0.951362

========================================================================================================================================================================================================
best acc epoch :  79
validation accuracy :  0.9603658536585366
test accuracy :  0.9513618677042801
last test_accuracy :  0.9498054474708171
second best val :  0.959349593495935
second best test :  0.9494163424124513
max gap 30
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=96, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  118.77674423158169 Time :  2023
accuracy train: 0.899390 val: 0.870935 test: 0.878210
max validation accuracy : 0.870935 max acc epoch : 1 test accuracy : 0.878210
Epoch-1 lr: 0.001

Epoch :  2 loss training:  51.44621795415878 Time :  2039
accuracy train: 0.927367 val: 0.897358 test: 0.894553
max validation accuracy : 0.897358 max acc epoch : 2 test accuracy : 0.894553
Epoch-2 lr: 0.001

Epoch :  3 loss training:  38.477923488244414 Time :  2057
accuracy train: 0.951220 val: 0.926829 test: 0.912840
max validation accuracy : 0.926829 max acc epoch : 3 test accuracy : 0.912840
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  24.913070548325777 Time :  2074
accuracy train: 0.970588 val: 0.921748 test: 0.935798
max validation accuracy : 0.926829 max acc epoch : 3 test accuracy : 0.912840
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  21.55001962929964 Time :  2090
accuracy train: 0.978479 val: 0.940041 test: 0.931128
max validation accuracy : 0.940041 max acc epoch : 5 test accuracy : 0.931128
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  17.712628287263215 Time :  2107
accuracy train: 0.978300 val: 0.934959 test: 0.936576
max validation accuracy : 0.940041 max acc epoch : 5 test accuracy : 0.931128
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  14.127151981927454 Time :  2124
accuracy train: 0.987088 val: 0.947154 test: 0.939300
max validation accuracy : 0.947154 max acc epoch : 7 test accuracy : 0.939300
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  13.029241878073663 Time :  2140
accuracy train: 0.988881 val: 0.943089 test: 0.939689
max validation accuracy : 0.947154 max acc epoch : 7 test accuracy : 0.939300
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  11.954295503906906 Time :  2156
accuracy train: 0.989957 val: 0.943089 test: 0.940467
max validation accuracy : 0.947154 max acc epoch : 7 test accuracy : 0.939300
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  10.13596458081156 Time :  2171
accuracy train: 0.992647 val: 0.940041 test: 0.940467
max validation accuracy : 0.947154 max acc epoch : 7 test accuracy : 0.939300

Epoch :  11 loss training:  9.945245782844722 Time :  2189
accuracy train: 0.992468 val: 0.951220 test: 0.941245
max validation accuracy : 0.951220 max acc epoch : 11 test accuracy : 0.941245

Epoch :  12 loss training:  8.672875055577606 Time :  2206
accuracy train: 0.993185 val: 0.945122 test: 0.940467
max validation accuracy : 0.951220 max acc epoch : 11 test accuracy : 0.941245

Epoch :  13 loss training:  8.603195640956983 Time :  2222
accuracy train: 0.994261 val: 0.947154 test: 0.947471
max validation accuracy : 0.951220 max acc epoch : 11 test accuracy : 0.941245

Epoch :  14 loss training:  7.988349219318479 Time :  2240
accuracy train: 0.993364 val: 0.948171 test: 0.945525
max validation accuracy : 0.951220 max acc epoch : 11 test accuracy : 0.941245

Epoch :  15 loss training:  6.8987817000597715 Time :  2256
accuracy train: 0.994978 val: 0.946138 test: 0.943580
max validation accuracy : 0.951220 max acc epoch : 11 test accuracy : 0.941245

Epoch :  16 loss training:  7.952552089234814 Time :  2273
accuracy train: 0.995516 val: 0.954268 test: 0.944358
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.944358

Epoch :  17 loss training:  6.636543073225766 Time :  2290
accuracy train: 0.995158 val: 0.953252 test: 0.946304
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.944358

Epoch :  18 loss training:  6.159106345847249 Time :  2307
accuracy train: 0.995158 val: 0.950203 test: 0.945525
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.944358

Epoch :  19 loss training:  5.765104817925021 Time :  2324
accuracy train: 0.996055 val: 0.954268 test: 0.943191
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.944358

Epoch :  20 loss training:  5.40710952761583 Time :  2339
accuracy train: 0.995875 val: 0.948171 test: 0.941245
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.944358

Epoch :  21 loss training:  5.3245438154553995 Time :  2355
accuracy train: 0.996951 val: 0.950203 test: 0.941245
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.944358

Epoch :  22 loss training:  5.241296653170139 Time :  2371
accuracy train: 0.996772 val: 0.950203 test: 0.942412
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.944358

Epoch :  23 loss training:  4.859165572328493 Time :  2386
accuracy train: 0.996413 val: 0.950203 test: 0.944358
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.944358

Epoch :  24 loss training:  4.453598516411148 Time :  2402
accuracy train: 0.996413 val: 0.950203 test: 0.947471
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.944358

Epoch :  25 loss training:  4.331255437689833 Time :  2418
accuracy train: 0.996413 val: 0.951220 test: 0.946304
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.944358

Epoch :  26 loss training:  3.85052132664714 Time :  2433
accuracy train: 0.997131 val: 0.953252 test: 0.947860
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.944358

Epoch :  27 loss training:  3.643539856071584 Time :  2449
accuracy train: 0.996772 val: 0.951220 test: 0.947082
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.944358

Epoch :  28 loss training:  3.695527490461245 Time :  2465
accuracy train: 0.997131 val: 0.951220 test: 0.947471
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.944358

Epoch :  29 loss training:  3.298691517440602 Time :  2480
accuracy train: 0.997310 val: 0.950203 test: 0.944358
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.944358

Epoch :  30 loss training:  3.3157388086547144 Time :  2496
accuracy train: 0.997310 val: 0.952236 test: 0.945914
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.944358

Epoch :  31 loss training:  3.276573312119581 Time :  2512
accuracy train: 0.997131 val: 0.952236 test: 0.947082
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.944358

Epoch :  32 loss training:  3.5318520946020726 Time :  2527
accuracy train: 0.997489 val: 0.948171 test: 0.945525
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.944358

Epoch :  33 loss training:  3.225419783964753 Time :  2543
accuracy train: 0.996951 val: 0.949187 test: 0.945525
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.944358

Epoch :  34 loss training:  2.983338189078495 Time :  2558
accuracy train: 0.997310 val: 0.951220 test: 0.944747
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.944358

Epoch :  35 loss training:  3.403390108316671 Time :  2574
accuracy train: 0.997310 val: 0.948171 test: 0.943969
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.944358

Epoch :  36 loss training:  3.0247179632715415 Time :  2590
accuracy train: 0.997489 val: 0.952236 test: 0.943191
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.944358

Epoch :  37 loss training:  2.6320284862304106 Time :  2605
accuracy train: 0.997310 val: 0.952236 test: 0.945136
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.944358

Epoch :  38 loss training:  2.7684825863107108 Time :  2621
accuracy train: 0.997131 val: 0.952236 test: 0.946693
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.944358

Epoch :  39 loss training:  2.832738908007741 Time :  2637
accuracy train: 0.996772 val: 0.949187 test: 0.940467
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.944358

Epoch :  40 loss training:  2.548273747845087 Time :  2653
accuracy train: 0.997310 val: 0.949187 test: 0.944358
max validation accuracy : 0.954268 max acc epoch : 16 test accuracy : 0.944358

Epoch :  41 loss training:  2.511015639815014 Time :  2668
accuracy train: 0.997310 val: 0.955285 test: 0.945525
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  42 loss training:  2.902956080826698 Time :  2684
accuracy train: 0.997310 val: 0.952236 test: 0.947860
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  43 loss training:  2.6961140569183044 Time :  2700
accuracy train: 0.997310 val: 0.950203 test: 0.948638
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  44 loss training:  2.7610970009409357 Time :  2716
accuracy train: 0.996772 val: 0.952236 test: 0.945136
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  45 loss training:  2.2880275449424516 Time :  2731
accuracy train: 0.997669 val: 0.954268 test: 0.947082
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  46 loss training:  2.444858494127402 Time :  2747
accuracy train: 0.997310 val: 0.953252 test: 0.947860
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  47 loss training:  2.6710388753563166 Time :  2763
accuracy train: 0.996951 val: 0.950203 test: 0.947860
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  48 loss training:  2.3327143462374806 Time :  2779
accuracy train: 0.996951 val: 0.951220 test: 0.947860
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  49 loss training:  2.391387892079365 Time :  2794
accuracy train: 0.997489 val: 0.954268 test: 0.947471
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  50 loss training:  2.326501376417582 Time :  2810
accuracy train: 0.997669 val: 0.954268 test: 0.949027
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  51 loss training:  2.3570419991301605 Time :  2825
accuracy train: 0.997489 val: 0.954268 test: 0.948638
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  52 loss training:  2.0625032504904084 Time :  2841
accuracy train: 0.997489 val: 0.952236 test: 0.947082
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  53 loss training:  2.236703539980226 Time :  2857
accuracy train: 0.997669 val: 0.954268 test: 0.949416
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  54 loss training:  2.320059813617263 Time :  2872
accuracy train: 0.997669 val: 0.951220 test: 0.947860
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  55 loss training:  2.3323646590288263 Time :  2888
accuracy train: 0.996951 val: 0.951220 test: 0.948249
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  56 loss training:  2.0713732195508783 Time :  2904
accuracy train: 0.997489 val: 0.953252 test: 0.949027
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  57 loss training:  1.948581015196396 Time :  2919
accuracy train: 0.997669 val: 0.952236 test: 0.949805
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  58 loss training:  1.8949472280801274 Time :  2935
accuracy train: 0.997131 val: 0.952236 test: 0.948638
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  59 loss training:  2.129159441246884 Time :  2950
accuracy train: 0.997669 val: 0.948171 test: 0.949027
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  60 loss training:  2.1451694231363945 Time :  2966
accuracy train: 0.997669 val: 0.945122 test: 0.949027
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  61 loss training:  2.006348898517899 Time :  2982
accuracy train: 0.997669 val: 0.950203 test: 0.948638
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  62 loss training:  2.0978091967554064 Time :  2997
accuracy train: 0.997669 val: 0.953252 test: 0.943969
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  63 loss training:  2.1638281165869557 Time :  3013
accuracy train: 0.997669 val: 0.949187 test: 0.950584
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  64 loss training:  2.045559588666947 Time :  3029
accuracy train: 0.997669 val: 0.948171 test: 0.951362
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  65 loss training:  1.825917526104604 Time :  3044
accuracy train: 0.997310 val: 0.954268 test: 0.950195
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  66 loss training:  2.18598041000223 Time :  3060
accuracy train: 0.997669 val: 0.952236 test: 0.949416
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  67 loss training:  1.6274401198643318 Time :  3075
accuracy train: 0.997489 val: 0.952236 test: 0.948249
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  68 loss training:  1.8353246815822786 Time :  3091
accuracy train: 0.997489 val: 0.950203 test: 0.949805
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  69 loss training:  2.0466055872657307 Time :  3107
accuracy train: 0.997489 val: 0.948171 test: 0.949027
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  70 loss training:  2.001840659577283 Time :  3122
accuracy train: 0.997669 val: 0.952236 test: 0.946304
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  71 loss training:  1.7107911678249366 Time :  3138
accuracy train: 0.997131 val: 0.948171 test: 0.942412
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

Epoch :  72 loss training:  1.8852590113965562 Time :  3153
accuracy train: 0.997489 val: 0.953252 test: 0.942802
max validation accuracy : 0.955285 max acc epoch : 41 test accuracy : 0.945525

========================================================================================================================================================================================================
best acc epoch :  41
validation accuracy :  0.9552845528455285
test accuracy :  0.9455252918287937
last test_accuracy :  0.9428015564202334
second best val :  0.9542682926829268
second best test :  0.9443579766536965
max gap 25
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  79 	 val_accuracy : 0.96037 	 test_accuracy : 0.95136 	 last test_accuracy : 0.94981 	 second best val : 0.95935 	 second best test : 0.94942
k :  1 	 best_acc epoch :  41 	 val_accuracy : 0.95528 	 test_accuracy : 0.94553 	 last test_accuracy : 0.94280 	 second best val : 0.95427 	 second best test : 0.94436

avg :  	 val_accuracy : 0.95783 	 test_accuracy : 0.94844 	 last_accuracy : 0.94630 	 second best val : 0.95681 	 second best test : 0.94689

std :  	 val_accuracy : 0.00254 	 test_accuracy : 0.00292 	 last_accuracy : 0.00350 	 second best val : 0.00254 	 second best test : 0.00253


date and time :  Sun Jul  4 19:11:42 2021
itr : 0
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=708, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0
Counter({0: 5412, 1: 2508, 2: 1210})

Epoch :  1 loss training:  120.41886246204376 Time :  20
accuracy train: 0.898135 val: 0.879065 test: 0.876654
max validation accuracy : 0.879065 max acc epoch : 1 test accuracy : 0.876654
Counter({2: 3603, 0: 2905, 1: 2622})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  52.37570063024759 Time :  40
accuracy train: 0.941535 val: 0.902439 test: 0.922957
max validation accuracy : 0.902439 max acc epoch : 2 test accuracy : 0.922957
Counter({1: 3786, 0: 2888, 2: 2456})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  40.083960734307766 Time :  58
accuracy train: 0.941894 val: 0.903455 test: 0.917510
max validation accuracy : 0.903455 max acc epoch : 3 test accuracy : 0.917510
Counter({0: 3824, 2: 2871, 1: 2435})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  24.569901389069855 Time :  76
accuracy train: 0.972023 val: 0.943089 test: 0.935798
max validation accuracy : 0.943089 max acc epoch : 4 test accuracy : 0.935798
Counter({1: 3860, 2: 2858, 0: 2412})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  19.42197227384895 Time :  95
accuracy train: 0.978659 val: 0.933943 test: 0.937743
max validation accuracy : 0.943089 max acc epoch : 4 test accuracy : 0.935798
Counter({1: 3836, 0: 2872, 2: 2422})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  18.119489095639437 Time :  113
accuracy train: 0.971485 val: 0.921748 test: 0.938521
max validation accuracy : 0.943089 max acc epoch : 4 test accuracy : 0.935798
Counter({1: 3810, 0: 2878, 2: 2442})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  14.47422065678984 Time :  131
accuracy train: 0.985115 val: 0.938008 test: 0.944358
max validation accuracy : 0.943089 max acc epoch : 4 test accuracy : 0.935798
Counter({0: 3842, 2: 2877, 1: 2411})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  13.173897015862167 Time :  149
accuracy train: 0.985832 val: 0.935976 test: 0.942802
max validation accuracy : 0.943089 max acc epoch : 4 test accuracy : 0.935798
Counter({1: 3842, 0: 2876, 2: 2412})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  11.969198491889983 Time :  167
accuracy train: 0.988702 val: 0.941057 test: 0.948638
max validation accuracy : 0.943089 max acc epoch : 4 test accuracy : 0.935798
Counter({1: 3847, 0: 2876, 2: 2407})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  10.225728956982493 Time :  185
accuracy train: 0.990316 val: 0.940041 test: 0.946304
max validation accuracy : 0.943089 max acc epoch : 4 test accuracy : 0.935798
Counter({1: 3848, 0: 2873, 2: 2409})

Epoch :  11 loss training:  9.315305035561323 Time :  205
accuracy train: 0.991392 val: 0.947154 test: 0.949416
max validation accuracy : 0.947154 max acc epoch : 11 test accuracy : 0.949416
Counter({0: 3852, 1: 2874, 2: 2404})

Epoch :  12 loss training:  9.055464748293161 Time :  223
accuracy train: 0.992468 val: 0.946138 test: 0.948249
max validation accuracy : 0.947154 max acc epoch : 11 test accuracy : 0.949416
Counter({0: 3857, 1: 2875, 2: 2398})

Epoch :  13 loss training:  8.393084479030222 Time :  243
accuracy train: 0.992647 val: 0.948171 test: 0.951751
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({1: 3867, 2: 2877, 0: 2386})

Epoch :  14 loss training:  7.373583026230335 Time :  262
accuracy train: 0.994261 val: 0.945122 test: 0.945525
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({1: 3874, 0: 2877, 2: 2379})

Epoch :  15 loss training:  6.841400339151733 Time :  282
accuracy train: 0.993364 val: 0.944106 test: 0.948638
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({1: 3876, 0: 2875, 2: 2379})

Epoch :  16 loss training:  6.778492212062702 Time :  306
accuracy train: 0.993544 val: 0.943089 test: 0.947860
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({1: 3881, 0: 2877, 2: 2372})

Epoch :  17 loss training:  6.242371929110959 Time :  327
accuracy train: 0.993902 val: 0.948171 test: 0.945914
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({1: 3882, 2: 2877, 0: 2371})

Epoch :  18 loss training:  5.683392221806571 Time :  350
accuracy train: 0.994978 val: 0.944106 test: 0.947860
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({1: 3884, 0: 2876, 2: 2370})

Epoch :  19 loss training:  5.092760454397649 Time :  371
accuracy train: 0.994978 val: 0.942073 test: 0.950195
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({1: 3889, 0: 2874, 2: 2367})

Epoch :  20 loss training:  4.9007176796440035 Time :  390
accuracy train: 0.995158 val: 0.941057 test: 0.946304
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({1: 3891, 2: 2873, 0: 2366})

Epoch :  21 loss training:  5.113739331136458 Time :  409
accuracy train: 0.995337 val: 0.944106 test: 0.948638
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({1: 3890, 0: 2879, 2: 2361})

Epoch :  22 loss training:  4.462999512557872 Time :  429
accuracy train: 0.995158 val: 0.943089 test: 0.946693
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({1: 3894, 0: 2878, 2: 2358})

Epoch :  23 loss training:  4.618996518431231 Time :  448
accuracy train: 0.994799 val: 0.943089 test: 0.946693
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({1: 3895, 0: 2879, 2: 2356})

Epoch :  24 loss training:  4.074422673147637 Time :  471
accuracy train: 0.995337 val: 0.943089 test: 0.947471
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({0: 3896, 2: 2878, 1: 2356})

Epoch :  25 loss training:  4.07894990616478 Time :  496
accuracy train: 0.995875 val: 0.944106 test: 0.950973
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({0: 3897, 2: 2877, 1: 2356})

Epoch :  26 loss training:  3.897644738550298 Time :  518
accuracy train: 0.995516 val: 0.944106 test: 0.947471
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({1: 3898, 0: 2875, 2: 2357})

Epoch :  27 loss training:  3.4483596242498606 Time :  540
accuracy train: 0.996055 val: 0.947154 test: 0.948249
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({1: 3898, 2: 2874, 0: 2358})

Epoch :  28 loss training:  3.3974825122277252 Time :  559
accuracy train: 0.996055 val: 0.944106 test: 0.947082
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({1: 3898, 2: 2873, 0: 2359})

Epoch :  29 loss training:  3.4260474677430466 Time :  578
accuracy train: 0.996234 val: 0.941057 test: 0.946693
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({1: 3898, 0: 2876, 2: 2356})

Epoch :  30 loss training:  3.6612337033147924 Time :  598
accuracy train: 0.995516 val: 0.940041 test: 0.947471
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({1: 3898, 0: 2876, 2: 2356})

Epoch :  31 loss training:  3.103866837162059 Time :  617
accuracy train: 0.995875 val: 0.940041 test: 0.947082
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({1: 3898, 0: 2877, 2: 2355})

Epoch :  32 loss training:  2.8627901698928326 Time :  637
accuracy train: 0.996593 val: 0.941057 test: 0.945525
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({0: 3898, 2: 2877, 1: 2355})

Epoch :  33 loss training:  3.101895442872774 Time :  660
accuracy train: 0.996234 val: 0.942073 test: 0.947860
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({1: 3898, 0: 2877, 2: 2355})

Epoch :  34 loss training:  2.967295974434819 Time :  681
accuracy train: 0.995158 val: 0.941057 test: 0.949805
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({1: 3898, 0: 2879, 2: 2353})

Epoch :  35 loss training:  3.000759059068514 Time :  703
accuracy train: 0.996413 val: 0.945122 test: 0.946304
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({2: 3897, 0: 2883, 1: 2350})

Epoch :  36 loss training:  2.782871762319701 Time :  724
accuracy train: 0.996593 val: 0.944106 test: 0.943969
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({2: 3897, 0: 2887, 1: 2346})

Epoch :  37 loss training:  2.5906175585114397 Time :  746
accuracy train: 0.996055 val: 0.946138 test: 0.949416
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({1: 3897, 2: 2887, 0: 2346})

Epoch :  38 loss training:  2.980018977134023 Time :  769
accuracy train: 0.996234 val: 0.944106 test: 0.947082
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({1: 3897, 2: 2887, 0: 2346})

Epoch :  39 loss training:  2.963521285157185 Time :  791
accuracy train: 0.996413 val: 0.942073 test: 0.949416
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({0: 3897, 1: 2887, 2: 2346})

Epoch :  40 loss training:  2.8687528737355024 Time :  812
accuracy train: 0.996413 val: 0.947154 test: 0.946304
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({1: 3899, 0: 2886, 2: 2345})

Epoch :  41 loss training:  2.782315142598236 Time :  832
accuracy train: 0.996234 val: 0.946138 test: 0.947471
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({1: 3899, 0: 2886, 2: 2345})

Epoch :  42 loss training:  2.766382698348025 Time :  854
accuracy train: 0.995875 val: 0.945122 test: 0.947082
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({0: 3899, 2: 2886, 1: 2345})

Epoch :  43 loss training:  2.7768091348261805 Time :  877
accuracy train: 0.996413 val: 0.948171 test: 0.946304
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({0: 3899, 2: 2886, 1: 2345})

Epoch :  44 loss training:  2.7913794297201093 Time :  897
accuracy train: 0.996234 val: 0.944106 test: 0.947471
max validation accuracy : 0.948171 max acc epoch : 13 test accuracy : 0.951751
Counter({1: 3899, 2: 2886, 0: 2345})

========================================================================================================================================================================================================
best acc epoch :  13
validation accuracy :  0.948170731707317
test accuracy :  0.9517509727626459
last test_accuracy :  0.9474708171206225
second best val :  0.9471544715447154
second best test :  0.9494163424124513
max gap 7
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=171, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0
Counter({0: 5416, 2: 2504, 1: 1210})

Epoch :  1 loss training:  122.88604870438576 Time :  923
accuracy train: 0.899211 val: 0.884146 test: 0.874708
max validation accuracy : 0.884146 max acc epoch : 1 test accuracy : 0.874708
Counter({1: 3696, 2: 2875, 0: 2559})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  51.24101810902357 Time :  944
accuracy train: 0.946377 val: 0.910569 test: 0.927237
max validation accuracy : 0.910569 max acc epoch : 2 test accuracy : 0.927237
Counter({0: 3825, 1: 2883, 2: 2422})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  34.962508933618665 Time :  966
accuracy train: 0.956062 val: 0.925813 test: 0.920623
max validation accuracy : 0.925813 max acc epoch : 3 test accuracy : 0.920623
Counter({1: 3860, 0: 2865, 2: 2405})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  23.663363302126527 Time :  988
accuracy train: 0.975789 val: 0.942073 test: 0.942802
max validation accuracy : 0.942073 max acc epoch : 4 test accuracy : 0.942802
Counter({1: 3874, 0: 2860, 2: 2396})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  20.174003888852894 Time :  1009
accuracy train: 0.975789 val: 0.943089 test: 0.943191
max validation accuracy : 0.943089 max acc epoch : 5 test accuracy : 0.943191
Counter({1: 3866, 0: 2851, 2: 2413})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  17.88837071042508 Time :  1030
accuracy train: 0.976865 val: 0.940041 test: 0.940856
max validation accuracy : 0.943089 max acc epoch : 5 test accuracy : 0.943191
Counter({2: 3865, 0: 2857, 1: 2408})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  13.073480293620378 Time :  1051
accuracy train: 0.984756 val: 0.949187 test: 0.947860
max validation accuracy : 0.949187 max acc epoch : 7 test accuracy : 0.947860
Counter({1: 3867, 2: 2857, 0: 2406})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  12.910003838595003 Time :  1072
accuracy train: 0.986370 val: 0.948171 test: 0.948638
max validation accuracy : 0.949187 max acc epoch : 7 test accuracy : 0.947860
Counter({1: 3868, 2: 2855, 0: 2407})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  11.154332614969462 Time :  1093
accuracy train: 0.985653 val: 0.942073 test: 0.945136
max validation accuracy : 0.949187 max acc epoch : 7 test accuracy : 0.947860
Counter({1: 3872, 0: 2855, 2: 2403})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  9.961373570375144 Time :  1114
accuracy train: 0.989060 val: 0.948171 test: 0.944358
max validation accuracy : 0.949187 max acc epoch : 7 test accuracy : 0.947860
Counter({0: 3883, 2: 2853, 1: 2394})

Epoch :  11 loss training:  9.202347703278065 Time :  1135
accuracy train: 0.990136 val: 0.949187 test: 0.947860
max validation accuracy : 0.949187 max acc epoch : 7 test accuracy : 0.947860
Counter({1: 3887, 2: 2853, 0: 2390})

Epoch :  12 loss training:  8.722088303416967 Time :  1158
accuracy train: 0.990674 val: 0.944106 test: 0.948249
max validation accuracy : 0.949187 max acc epoch : 7 test accuracy : 0.947860
Counter({1: 3888, 2: 2854, 0: 2388})

Epoch :  13 loss training:  8.198639931157231 Time :  1180
accuracy train: 0.991930 val: 0.948171 test: 0.948249
max validation accuracy : 0.949187 max acc epoch : 7 test accuracy : 0.947860
Counter({1: 3890, 0: 2853, 2: 2387})

Epoch :  14 loss training:  7.233593470416963 Time :  1202
accuracy train: 0.993006 val: 0.950203 test: 0.950584
max validation accuracy : 0.950203 max acc epoch : 14 test accuracy : 0.950584
Counter({1: 3892, 0: 2853, 2: 2385})

Epoch :  15 loss training:  7.155535576632246 Time :  1224
accuracy train: 0.992647 val: 0.948171 test: 0.950973
max validation accuracy : 0.950203 max acc epoch : 14 test accuracy : 0.950584
Counter({1: 3903, 0: 2850, 2: 2377})

Epoch :  16 loss training:  6.886435536900535 Time :  1246
accuracy train: 0.993723 val: 0.947154 test: 0.947471
max validation accuracy : 0.950203 max acc epoch : 14 test accuracy : 0.950584
Counter({2: 3906, 0: 2850, 1: 2374})

Epoch :  17 loss training:  5.865609818836674 Time :  1268
accuracy train: 0.993364 val: 0.949187 test: 0.949805
max validation accuracy : 0.950203 max acc epoch : 14 test accuracy : 0.950584
Counter({0: 3909, 2: 2851, 1: 2370})

Epoch :  18 loss training:  5.883484347257763 Time :  1290
accuracy train: 0.994082 val: 0.947154 test: 0.947082
max validation accuracy : 0.950203 max acc epoch : 14 test accuracy : 0.950584
Counter({2: 3911, 1: 2851, 0: 2368})

Epoch :  19 loss training:  5.221165418159217 Time :  1313
accuracy train: 0.994799 val: 0.950203 test: 0.951362
max validation accuracy : 0.950203 max acc epoch : 14 test accuracy : 0.950584
Counter({0: 3914, 2: 2853, 1: 2363})

Epoch :  20 loss training:  4.945232930709608 Time :  1334
accuracy train: 0.995158 val: 0.949187 test: 0.949416
max validation accuracy : 0.950203 max acc epoch : 14 test accuracy : 0.950584
Counter({1: 3915, 2: 2853, 0: 2362})

Epoch :  21 loss training:  4.947642766986974 Time :  1356
accuracy train: 0.995696 val: 0.951220 test: 0.949027
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({1: 3917, 0: 2853, 2: 2360})

Epoch :  22 loss training:  4.143301869160496 Time :  1377
accuracy train: 0.995875 val: 0.948171 test: 0.951362
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({0: 3913, 2: 2856, 1: 2361})

Epoch :  23 loss training:  3.904254690394737 Time :  1402
accuracy train: 0.995696 val: 0.948171 test: 0.950973
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({1: 3915, 0: 2855, 2: 2360})

Epoch :  24 loss training:  4.0176353675778955 Time :  1423
accuracy train: 0.996772 val: 0.948171 test: 0.950584
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({2: 3916, 0: 2854, 1: 2360})

Epoch :  25 loss training:  3.5617841369239613 Time :  1445
accuracy train: 0.996234 val: 0.949187 test: 0.950195
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({0: 3918, 2: 2853, 1: 2359})

Epoch :  26 loss training:  3.305006214068271 Time :  1467
accuracy train: 0.996593 val: 0.945122 test: 0.949805
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({2: 3918, 1: 2860, 0: 2352})

Epoch :  27 loss training:  3.232498094323091 Time :  1489
accuracy train: 0.996055 val: 0.948171 test: 0.952140
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({1: 3921, 0: 2865, 2: 2344})

Epoch :  28 loss training:  3.4834646512172185 Time :  1511
accuracy train: 0.996234 val: 0.945122 test: 0.952529
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({1: 3921, 2: 2866, 0: 2343})

Epoch :  29 loss training:  3.1099247398087755 Time :  1533
accuracy train: 0.996055 val: 0.948171 test: 0.953696
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({0: 3921, 2: 2866, 1: 2343})

Epoch :  30 loss training:  3.157037026103353 Time :  1555
accuracy train: 0.996234 val: 0.945122 test: 0.948638
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({0: 3922, 1: 2864, 2: 2344})

Epoch :  31 loss training:  3.245166926761158 Time :  1576
accuracy train: 0.996234 val: 0.948171 test: 0.950584
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({1: 3922, 0: 2865, 2: 2343})

Epoch :  32 loss training:  2.9542078284721356 Time :  1598
accuracy train: 0.996234 val: 0.946138 test: 0.949416
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({0: 3923, 1: 2871, 2: 2336})

Epoch :  33 loss training:  2.973742622009013 Time :  1618
accuracy train: 0.995516 val: 0.948171 test: 0.952529
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({1: 3923, 0: 2871, 2: 2336})

Epoch :  34 loss training:  2.7177663343318272 Time :  1640
accuracy train: 0.995875 val: 0.951220 test: 0.949805
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({1: 3925, 0: 2869, 2: 2336})

Epoch :  35 loss training:  3.134398380876519 Time :  1664
accuracy train: 0.996772 val: 0.948171 test: 0.949416
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({1: 3925, 0: 2869, 2: 2336})

Epoch :  36 loss training:  2.736633076798171 Time :  1685
accuracy train: 0.996413 val: 0.949187 test: 0.948638
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({1: 3926, 2: 2868, 0: 2336})

Epoch :  37 loss training:  2.491585582596599 Time :  1707
accuracy train: 0.996413 val: 0.945122 test: 0.949805
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({0: 3926, 2: 2868, 1: 2336})

Epoch :  38 loss training:  2.434709280030802 Time :  1730
accuracy train: 0.996413 val: 0.946138 test: 0.947860
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({0: 3926, 2: 2869, 1: 2335})

Epoch :  39 loss training:  2.8232517869619187 Time :  1751
accuracy train: 0.996772 val: 0.946138 test: 0.948638
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({0: 3926, 2: 2870, 1: 2334})

Epoch :  40 loss training:  2.808395340689458 Time :  1773
accuracy train: 0.996234 val: 0.946138 test: 0.947860
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({2: 3926, 0: 2870, 1: 2334})

Epoch :  41 loss training:  2.5644848657248076 Time :  1795
accuracy train: 0.996413 val: 0.948171 test: 0.948249
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({2: 3926, 0: 2870, 1: 2334})

Epoch :  42 loss training:  2.470356491074199 Time :  1817
accuracy train: 0.996951 val: 0.948171 test: 0.950584
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({0: 3926, 2: 2870, 1: 2334})

Epoch :  43 loss training:  2.534429263949278 Time :  1838
accuracy train: 0.996413 val: 0.944106 test: 0.949416
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({0: 3926, 2: 2870, 1: 2334})

Epoch :  44 loss training:  2.203761307959212 Time :  1860
accuracy train: 0.996413 val: 0.949187 test: 0.945914
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({1: 3926, 2: 2870, 0: 2334})

Epoch :  45 loss training:  2.466093633469427 Time :  1881
accuracy train: 0.996055 val: 0.949187 test: 0.947471
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({2: 3926, 0: 2870, 1: 2334})

Epoch :  46 loss training:  2.415098155819578 Time :  1904
accuracy train: 0.996772 val: 0.951220 test: 0.948638
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({1: 3925, 0: 2871, 2: 2334})

Epoch :  47 loss training:  2.3109223141509574 Time :  1925
accuracy train: 0.996593 val: 0.947154 test: 0.950584
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({1: 3925, 0: 2871, 2: 2334})

Epoch :  48 loss training:  2.3503816035954515 Time :  1944
accuracy train: 0.996234 val: 0.949187 test: 0.948249
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({1: 3925, 2: 2872, 0: 2333})

Epoch :  49 loss training:  2.2431414747261442 Time :  1963
accuracy train: 0.996234 val: 0.946138 test: 0.947860
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({1: 3925, 0: 2872, 2: 2333})

Epoch :  50 loss training:  2.4081531107076444 Time :  1987
accuracy train: 0.996413 val: 0.948171 test: 0.948249
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({1: 3925, 0: 2872, 2: 2333})

Epoch :  51 loss training:  2.3677112662262516 Time :  2008
accuracy train: 0.996772 val: 0.947154 test: 0.946304
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({1: 3925, 0: 2872, 2: 2333})

Epoch :  52 loss training:  2.145794853422558 Time :  2028
accuracy train: 0.996413 val: 0.947154 test: 0.948638
max validation accuracy : 0.951220 max acc epoch : 21 test accuracy : 0.949027
Counter({1: 3925, 0: 2872, 2: 2333})

========================================================================================================================================================================================================
best acc epoch :  21
validation accuracy :  0.9512195121951219
test accuracy :  0.9490272373540856
last test_accuracy :  0.9486381322957198
second best val :  0.9502032520325203
second best test :  0.9505836575875486
max gap 7
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  13 	 val_accuracy : 0.94817 	 test_accuracy : 0.95175 	 last test_accuracy : 0.94747 	 second best val : 0.94715 	 second best test : 0.94942
k :  1 	 best_acc epoch :  21 	 val_accuracy : 0.95122 	 test_accuracy : 0.94903 	 last test_accuracy : 0.94864 	 second best val : 0.95020 	 second best test : 0.95058

avg :  	 val_accuracy : 0.94970 	 test_accuracy : 0.95039 	 last_accuracy : 0.94805 	 second best val : 0.94868 	 second best test : 0.95000

std :  	 val_accuracy : 0.00152 	 test_accuracy : 0.00136 	 last_accuracy : 0.00058 	 second best val : 0.00152 	 second best test : 0.00058
