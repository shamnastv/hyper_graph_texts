

date and time :  Wed Apr 21 14:31:19 2021
Namespace(batch_size=32, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=0)
device :  cuda:0
Counter({0: 5142, 1: 3280, 2: 2240})

Epoch :  1 loss training:  191.9270195364952 Time :  19
accuracy train: 0.774930 val: 0.756338 test: 0.753799
max validation accuracy : 0.756338 max acc epoch : 1 test accuracy : 0.753799
Epoch-1 lr: 0.001

Epoch :  2 loss training:  166.25685328245163 Time :  29
accuracy train: 0.796343 val: 0.770423 test: 0.773213
max validation accuracy : 0.770423 max acc epoch : 2 test accuracy : 0.773213
Counter({1: 5714, 0: 2689, 2: 2259})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  180.71107304096222 Time :  41
accuracy train: 0.782588 val: 0.756338 test: 0.761958
max validation accuracy : 0.770423 max acc epoch : 2 test accuracy : 0.773213
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  159.91773837804794 Time :  52
accuracy train: 0.802751 val: 0.764789 test: 0.774339
max validation accuracy : 0.770423 max acc epoch : 2 test accuracy : 0.773213
Counter({0: 5575, 1: 3009, 2: 2078})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  153.6166509091854 Time :  64
accuracy train: 0.808378 val: 0.761972 test: 0.774620
max validation accuracy : 0.770423 max acc epoch : 2 test accuracy : 0.773213
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  151.63890585303307 Time :  76
accuracy train: 0.817756 val: 0.774648 test: 0.780248
max validation accuracy : 0.774648 max acc epoch : 6 test accuracy : 0.780248
Counter({2: 5638, 1: 2614, 0: 2410})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  145.25564670562744 Time :  88
accuracy train: 0.826039 val: 0.783099 test: 0.776308
max validation accuracy : 0.783099 max acc epoch : 7 test accuracy : 0.776308
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  142.81970050930977 Time :  98
accuracy train: 0.833073 val: 0.760563 test: 0.783061
max validation accuracy : 0.783099 max acc epoch : 7 test accuracy : 0.776308
Counter({2: 5930, 1: 2562, 0: 2170})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  142.30634421110153 Time :  110
accuracy train: 0.835261 val: 0.774648 test: 0.783624
max validation accuracy : 0.783099 max acc epoch : 7 test accuracy : 0.776308
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  137.74439576268196 Time :  122
accuracy train: 0.835574 val: 0.785915 test: 0.779403
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403
Counter({0: 6019, 1: 2616, 2: 2027})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  135.91863179206848 Time :  134
accuracy train: 0.842451 val: 0.773239 test: 0.780810
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  137.22897863388062 Time :  145
accuracy train: 0.847452 val: 0.773239 test: 0.779403
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403
Counter({1: 6058, 0: 2673, 2: 1931})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  134.44304791092873 Time :  157
accuracy train: 0.849328 val: 0.764789 test: 0.778559
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  132.60596439242363 Time :  167
accuracy train: 0.849797 val: 0.766197 test: 0.781654
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403
Counter({1: 5987, 2: 2550, 0: 2125})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  131.87728559970856 Time :  180
accuracy train: 0.849172 val: 0.770423 test: 0.782217
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403

Epoch :  16 loss training:  134.13186272978783 Time :  190
accuracy train: 0.854017 val: 0.778873 test: 0.777434
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403
Counter({0: 5927, 2: 2691, 1: 2044})

Epoch :  17 loss training:  130.21936139464378 Time :  203
accuracy train: 0.853704 val: 0.785915 test: 0.778278
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403

Epoch :  18 loss training:  132.51313892006874 Time :  214
accuracy train: 0.854017 val: 0.761972 test: 0.777153
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403
Counter({0: 5858, 1: 3054, 2: 1750})

Epoch :  19 loss training:  131.31326067447662 Time :  226
accuracy train: 0.854955 val: 0.773239 test: 0.772088
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403

Epoch :  20 loss training:  130.95124167203903 Time :  237
accuracy train: 0.858081 val: 0.776056 test: 0.778559
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403
Counter({0: 5999, 1: 2935, 2: 1728})

Epoch :  21 loss training:  127.05799162387848 Time :  249
accuracy train: 0.858081 val: 0.769014 test: 0.776027
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403

Epoch :  22 loss training:  130.24185672402382 Time :  260
accuracy train: 0.860581 val: 0.770423 test: 0.770400
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403
Counter({1: 5845, 0: 3050, 2: 1767})

Epoch :  23 loss training:  126.44050952792168 Time :  272
accuracy train: 0.861519 val: 0.771831 test: 0.776027
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403

Epoch :  24 loss training:  125.94910056889057 Time :  282
accuracy train: 0.865270 val: 0.767606 test: 0.775746
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403
Counter({0: 5651, 2: 2970, 1: 2041})

Epoch :  25 loss training:  126.90996795892715 Time :  295
accuracy train: 0.864645 val: 0.763380 test: 0.777434
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403

Epoch :  26 loss training:  127.09403058886528 Time :  307
accuracy train: 0.866052 val: 0.771831 test: 0.780810
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403
Counter({1: 5708, 2: 2904, 0: 2050})

Epoch :  27 loss training:  125.92247702181339 Time :  319
accuracy train: 0.865739 val: 0.770423 test: 0.778278
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403

Epoch :  28 loss training:  124.02913609147072 Time :  329
accuracy train: 0.869803 val: 0.776056 test: 0.776590
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403
Counter({0: 5801, 2: 2803, 1: 2058})

Epoch :  29 loss training:  124.81057086586952 Time :  342
accuracy train: 0.871835 val: 0.781690 test: 0.777434
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403

Epoch :  30 loss training:  122.13123577833176 Time :  353
accuracy train: 0.872304 val: 0.781690 test: 0.779966
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403
Counter({1: 6125, 0: 3030, 2: 1507})

Epoch :  31 loss training:  122.95833159983158 Time :  365
accuracy train: 0.873867 val: 0.760563 test: 0.779122
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403

Epoch :  32 loss training:  122.531255453825 Time :  375
accuracy train: 0.876368 val: 0.777465 test: 0.777153
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403
Counter({0: 6085, 1: 3013, 2: 1564})

Epoch :  33 loss training:  123.64105488359928 Time :  387
accuracy train: 0.877931 val: 0.774648 test: 0.774339
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403

Epoch :  34 loss training:  122.10122728347778 Time :  398
accuracy train: 0.883870 val: 0.771831 test: 0.776027
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403
Counter({2: 6305, 0: 2367, 1: 1990})

Epoch :  35 loss training:  119.68589919805527 Time :  411
accuracy train: 0.884651 val: 0.780282 test: 0.777715
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403

Epoch :  36 loss training:  119.67640817165375 Time :  421
accuracy train: 0.883870 val: 0.773239 test: 0.774339
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403
Counter({0: 6108, 2: 2715, 1: 1839})

Epoch :  37 loss training:  121.54458492994308 Time :  434
accuracy train: 0.882307 val: 0.777465 test: 0.781373
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403

Epoch :  38 loss training:  119.10002303123474 Time :  445
accuracy train: 0.887465 val: 0.783099 test: 0.777997
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403
Counter({2: 5822, 0: 3363, 1: 1477})

Epoch :  39 loss training:  120.2122737467289 Time :  458
accuracy train: 0.889028 val: 0.785915 test: 0.772932
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403

Epoch :  40 loss training:  118.50104981660843 Time :  468
accuracy train: 0.885589 val: 0.776056 test: 0.776027
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403
Counter({1: 6183, 2: 2653, 0: 1826})

Epoch :  41 loss training:  113.83357574045658 Time :  480
accuracy train: 0.890591 val: 0.777465 test: 0.776590
max validation accuracy : 0.785915 max acc epoch : 10 test accuracy : 0.779403

========================================================================================================================================================================================================
max acc epoch :  10
max validation accuracy :  0.7859154929577464
test accuracy :  0.7794034890264491
last test_accuracy :  0.7765897580191333
========================================================================================================================================================================================================



date and time :  Wed Apr 21 14:39:29 2021
Namespace(batch_size=32, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=True, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=0)
device :  cuda:0
Counter({1: 5147, 0: 3254, 2: 2261})

Epoch :  1 loss training:  194.18105959892273 Time :  14
accuracy train: 0.777587 val: 0.745070 test: 0.764209
max validation accuracy : 0.745070 max acc epoch : 1 test accuracy : 0.764209
Epoch-1 lr: 0.001

Epoch :  2 loss training:  167.95615768432617 Time :  24
accuracy train: 0.796186 val: 0.760563 test: 0.773776
max validation accuracy : 0.760563 max acc epoch : 2 test accuracy : 0.773776
Counter({0: 6521, 2: 3233, 1: 908})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  175.98659425973892 Time :  37
accuracy train: 0.791341 val: 0.738028 test: 0.771806
max validation accuracy : 0.760563 max acc epoch : 2 test accuracy : 0.773776
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  158.22589534521103 Time :  48
accuracy train: 0.804626 val: 0.759155 test: 0.777715
max validation accuracy : 0.760563 max acc epoch : 2 test accuracy : 0.773776
Counter({2: 5656, 0: 3773, 1: 1233})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  152.15665557980537 Time :  60
accuracy train: 0.818224 val: 0.759155 test: 0.780248
max validation accuracy : 0.760563 max acc epoch : 2 test accuracy : 0.773776
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  150.61668825149536 Time :  71
accuracy train: 0.824164 val: 0.759155 test: 0.777434
max validation accuracy : 0.760563 max acc epoch : 2 test accuracy : 0.773776
Counter({2: 6698, 0: 3050, 1: 914})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  144.17448756098747 Time :  83
accuracy train: 0.829009 val: 0.757746 test: 0.779966
max validation accuracy : 0.760563 max acc epoch : 2 test accuracy : 0.773776
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  142.008063018322 Time :  94
accuracy train: 0.836511 val: 0.752113 test: 0.780810
max validation accuracy : 0.760563 max acc epoch : 2 test accuracy : 0.773776
Counter({0: 7092, 2: 2859, 1: 711})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  137.73038429021835 Time :  106
accuracy train: 0.840419 val: 0.752113 test: 0.778559
max validation accuracy : 0.760563 max acc epoch : 2 test accuracy : 0.773776
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  137.5777542591095 Time :  117
accuracy train: 0.839950 val: 0.746479 test: 0.781092
max validation accuracy : 0.760563 max acc epoch : 2 test accuracy : 0.773776
Counter({1: 7246, 0: 2816, 2: 600})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  137.18915513157845 Time :  127
accuracy train: 0.847140 val: 0.749296 test: 0.783905
max validation accuracy : 0.760563 max acc epoch : 2 test accuracy : 0.773776
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  133.3017825782299 Time :  137
accuracy train: 0.849015 val: 0.760563 test: 0.777997
max validation accuracy : 0.760563 max acc epoch : 2 test accuracy : 0.773776
Counter({0: 7011, 2: 3144, 1: 507})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  132.8608904182911 Time :  150
accuracy train: 0.852610 val: 0.770423 test: 0.780529
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.780529
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  131.947859197855 Time :  160
accuracy train: 0.850266 val: 0.763380 test: 0.779122
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.780529
Counter({0: 6761, 1: 3391, 2: 510})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  131.96634247899055 Time :  173
accuracy train: 0.852610 val: 0.759155 test: 0.778559
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.780529

Epoch :  16 loss training:  129.15351432561874 Time :  184
accuracy train: 0.850422 val: 0.757746 test: 0.778559
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.780529
Counter({2: 6628, 1: 3504, 0: 530})

Epoch :  17 loss training:  130.9012375175953 Time :  197
accuracy train: 0.849797 val: 0.766197 test: 0.778559
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.780529

Epoch :  18 loss training:  127.2670151591301 Time :  208
accuracy train: 0.854486 val: 0.761972 test: 0.781092
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.780529
Counter({0: 6928, 1: 3311, 2: 423})

Epoch :  19 loss training:  128.22540405392647 Time :  220
accuracy train: 0.856049 val: 0.757746 test: 0.777715
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.780529

Epoch :  20 loss training:  129.54682981967926 Time :  232
accuracy train: 0.859800 val: 0.753521 test: 0.778278
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.780529
Counter({2: 5659, 1: 4522, 0: 481})

Epoch :  21 loss training:  125.91548717021942 Time :  244
accuracy train: 0.860425 val: 0.764789 test: 0.778841
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.780529

Epoch :  22 loss training:  124.72456212341785 Time :  255
accuracy train: 0.862144 val: 0.767606 test: 0.783624
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.780529
Counter({2: 6817, 0: 3421, 1: 424})

Epoch :  23 loss training:  123.59496268630028 Time :  267
accuracy train: 0.866833 val: 0.754930 test: 0.776590
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.780529

Epoch :  24 loss training:  124.82117640972137 Time :  279
accuracy train: 0.869647 val: 0.756338 test: 0.776027
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.780529
Counter({0: 6971, 2: 3236, 1: 455})

Epoch :  25 loss training:  124.39782544970512 Time :  291
accuracy train: 0.866364 val: 0.763380 test: 0.775464
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.780529

Epoch :  26 loss training:  125.24166049063206 Time :  302
accuracy train: 0.869490 val: 0.757746 test: 0.778278
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.780529
Counter({0: 6906, 1: 3274, 2: 482})

Epoch :  27 loss training:  121.40834212303162 Time :  314
accuracy train: 0.870116 val: 0.769014 test: 0.778278
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.780529

Epoch :  28 loss training:  122.10929915308952 Time :  325
accuracy train: 0.872304 val: 0.760563 test: 0.778841
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.780529
Counter({2: 6937, 0: 3264, 1: 461})

Epoch :  29 loss training:  123.46773967146873 Time :  338
accuracy train: 0.873554 val: 0.757746 test: 0.777434
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.780529

Epoch :  30 loss training:  122.53664834797382 Time :  348
accuracy train: 0.874336 val: 0.764789 test: 0.779685
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.780529
Counter({1: 6112, 2: 4168, 0: 382})

Epoch :  31 loss training:  121.11724516749382 Time :  359
accuracy train: 0.878712 val: 0.757746 test: 0.777434
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.780529

Epoch :  32 loss training:  119.3461746275425 Time :  368
accuracy train: 0.878712 val: 0.764789 test: 0.777715
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.780529
Counter({0: 7168, 1: 3094, 2: 400})

Epoch :  33 loss training:  120.64470393955708 Time :  386
accuracy train: 0.878087 val: 0.763380 test: 0.777434
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.780529

Epoch :  34 loss training:  118.2911641895771 Time :  398
accuracy train: 0.878399 val: 0.754930 test: 0.778841
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.780529
Counter({1: 7319, 0: 3070, 2: 273})

Epoch :  35 loss training:  120.43862149119377 Time :  411
accuracy train: 0.878243 val: 0.759155 test: 0.774620
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.780529

Epoch :  36 loss training:  120.08197286725044 Time :  423
accuracy train: 0.878243 val: 0.761972 test: 0.775183
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.780529
Counter({0: 7787, 1: 2519, 2: 356})

Epoch :  37 loss training:  119.23342834413052 Time :  435
accuracy train: 0.886058 val: 0.760563 test: 0.776308
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.780529

Epoch :  38 loss training:  117.19932109117508 Time :  445
accuracy train: 0.886996 val: 0.770423 test: 0.779122
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.780529
Counter({1: 7786, 0: 2531, 2: 345})

Epoch :  39 loss training:  118.23549443483353 Time :  457
accuracy train: 0.889028 val: 0.771831 test: 0.775183
max validation accuracy : 0.771831 max acc epoch : 39 test accuracy : 0.775183

Epoch :  40 loss training:  116.3858051598072 Time :  468
accuracy train: 0.892310 val: 0.774648 test: 0.775746
max validation accuracy : 0.774648 max acc epoch : 40 test accuracy : 0.775746
Counter({2: 8090, 0: 2211, 1: 361})

Epoch :  41 loss training:  115.69570863246918 Time :  481
accuracy train: 0.887934 val: 0.771831 test: 0.774620
max validation accuracy : 0.774648 max acc epoch : 40 test accuracy : 0.775746

Epoch :  42 loss training:  113.54391694068909 Time :  492
accuracy train: 0.893248 val: 0.776056 test: 0.773776
max validation accuracy : 0.776056 max acc epoch : 42 test accuracy : 0.773776
Counter({2: 7835, 0: 2467, 1: 360})

Epoch :  43 loss training:  113.83353425562382 Time :  505
accuracy train: 0.896061 val: 0.764789 test: 0.772932
max validation accuracy : 0.776056 max acc epoch : 42 test accuracy : 0.773776

Epoch :  44 loss training:  113.00146749615669 Time :  516
accuracy train: 0.899344 val: 0.769014 test: 0.772369
max validation accuracy : 0.776056 max acc epoch : 42 test accuracy : 0.773776
Counter({1: 8271, 0: 2050, 2: 341})

Epoch :  45 loss training:  112.04390494525433 Time :  528
accuracy train: 0.900125 val: 0.771831 test: 0.771525
max validation accuracy : 0.776056 max acc epoch : 42 test accuracy : 0.773776

Epoch :  46 loss training:  110.85382321476936 Time :  538
accuracy train: 0.895592 val: 0.767606 test: 0.774339
max validation accuracy : 0.776056 max acc epoch : 42 test accuracy : 0.773776
Counter({1: 8077, 2: 2241, 0: 344})

Epoch :  47 loss training:  109.5435793697834 Time :  551
accuracy train: 0.896686 val: 0.760563 test: 0.772088
max validation accuracy : 0.776056 max acc epoch : 42 test accuracy : 0.773776

Epoch :  48 loss training:  112.75206369161606 Time :  561
accuracy train: 0.901688 val: 0.763380 test: 0.771525
max validation accuracy : 0.776056 max acc epoch : 42 test accuracy : 0.773776
Counter({1: 8183, 2: 2097, 0: 382})

Epoch :  49 loss training:  112.60297087579966 Time :  575
accuracy train: 0.903407 val: 0.771831 test: 0.776308
max validation accuracy : 0.776056 max acc epoch : 42 test accuracy : 0.773776

Epoch :  50 loss training:  110.73387856781483 Time :  586
accuracy train: 0.907627 val: 0.783099 test: 0.769837
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837
Counter({0: 8412, 2: 1928, 1: 322})

Epoch :  51 loss training:  106.21961742639542 Time :  599
accuracy train: 0.903095 val: 0.771831 test: 0.770681
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837

Epoch :  52 loss training:  108.77151529490948 Time :  610
accuracy train: 0.908721 val: 0.767606 test: 0.774057
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837
Counter({1: 8373, 0: 1979, 2: 310})

Epoch :  53 loss training:  107.24106711149216 Time :  622
accuracy train: 0.907940 val: 0.766197 test: 0.772932
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837

Epoch :  54 loss training:  107.09798088669777 Time :  633
accuracy train: 0.909972 val: 0.770423 test: 0.768993
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837
Counter({0: 8540, 2: 1812, 1: 310})

Epoch :  55 loss training:  105.6118705868721 Time :  645
accuracy train: 0.911222 val: 0.777465 test: 0.770962
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837

Epoch :  56 loss training:  102.96833679825068 Time :  657
accuracy train: 0.910910 val: 0.769014 test: 0.769274
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837
Counter({1: 8735, 0: 1598, 2: 329})

Epoch :  57 loss training:  105.53707899153233 Time :  670
accuracy train: 0.913567 val: 0.771831 test: 0.777153
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837

Epoch :  58 loss training:  105.09142811596394 Time :  680
accuracy train: 0.914973 val: 0.774648 test: 0.772369
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837
Counter({0: 8740, 2: 1617, 1: 305})

Epoch :  59 loss training:  102.04708215594292 Time :  693
accuracy train: 0.915599 val: 0.763380 test: 0.775746
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837

Epoch :  60 loss training:  103.33652596920729 Time :  703
accuracy train: 0.920131 val: 0.764789 test: 0.771244
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837
Counter({1: 8675, 0: 1668, 2: 319})

Epoch :  61 loss training:  104.2906064838171 Time :  716
accuracy train: 0.918725 val: 0.764789 test: 0.769274
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837

Epoch :  62 loss training:  103.79552256315947 Time :  726
accuracy train: 0.919662 val: 0.771831 test: 0.776308
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837
Counter({2: 8443, 0: 1906, 1: 313})

Epoch :  63 loss training:  103.07610538601875 Time :  738
accuracy train: 0.920444 val: 0.780282 test: 0.773495
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837

Epoch :  64 loss training:  101.22496671974659 Time :  748
accuracy train: 0.925602 val: 0.774648 test: 0.771806
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837
Counter({0: 8593, 2: 1768, 1: 301})

Epoch :  65 loss training:  101.37637450546026 Time :  762
accuracy train: 0.924508 val: 0.770423 test: 0.770962
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837

Epoch :  66 loss training:  99.95018775761127 Time :  772
accuracy train: 0.926852 val: 0.770423 test: 0.770118
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837
Counter({2: 8375, 0: 2014, 1: 273})

Epoch :  67 loss training:  99.95094187557697 Time :  785
accuracy train: 0.926383 val: 0.764789 test: 0.768993
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837

Epoch :  68 loss training:  98.61340567469597 Time :  796
accuracy train: 0.929197 val: 0.771831 test: 0.770118
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837
Counter({0: 8963, 2: 1398, 1: 301})

Epoch :  69 loss training:  98.07375327497721 Time :  809
accuracy train: 0.928415 val: 0.773239 test: 0.775464
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837

Epoch :  70 loss training:  99.38467505574226 Time :  821
accuracy train: 0.934042 val: 0.763380 test: 0.771806
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837
Counter({1: 8594, 0: 1809, 2: 259})

Epoch :  71 loss training:  99.75855282694101 Time :  843
accuracy train: 0.935292 val: 0.774648 test: 0.768430
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837

Epoch :  72 loss training:  97.79584476351738 Time :  854
accuracy train: 0.937949 val: 0.771831 test: 0.770400
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837
Counter({1: 8755, 0: 1688, 2: 219})

Epoch :  73 loss training:  96.43563581258059 Time :  868
accuracy train: 0.934042 val: 0.771831 test: 0.769837
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837

Epoch :  74 loss training:  94.46365991979837 Time :  880
accuracy train: 0.932166 val: 0.773239 test: 0.767867
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837
Counter({1: 7604, 0: 2903, 2: 155})

Epoch :  75 loss training:  97.09616953134537 Time :  892
accuracy train: 0.936699 val: 0.777465 test: 0.768993
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837

Epoch :  76 loss training:  97.9091489315033 Time :  902
accuracy train: 0.933886 val: 0.774648 test: 0.773495
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837
Counter({1: 8916, 0: 1488, 2: 258})

Epoch :  77 loss training:  96.23134799301624 Time :  915
accuracy train: 0.936543 val: 0.769014 test: 0.771244
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837

Epoch :  78 loss training:  93.57101936638355 Time :  925
accuracy train: 0.942795 val: 0.769014 test: 0.769555
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837
Counter({1: 8882, 0: 1554, 2: 226})

Epoch :  79 loss training:  98.09022982418537 Time :  945
accuracy train: 0.944983 val: 0.773239 test: 0.769274
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837

Epoch :  80 loss training:  93.35349579900503 Time :  956
accuracy train: 0.945139 val: 0.766197 test: 0.769837
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837
Counter({1: 8703, 0: 1719, 2: 240})

Epoch :  81 loss training:  91.41932791471481 Time :  969
accuracy train: 0.940450 val: 0.757746 test: 0.768711
max validation accuracy : 0.783099 max acc epoch : 50 test accuracy : 0.769837

========================================================================================================================================================================================================
max acc epoch :  50
max validation accuracy :  0.7830985915492957
test accuracy :  0.7698368036015757
last test_accuracy :  0.7687113111986494
========================================================================================================================================================================================================



date and time :  Wed Apr 21 14:55:47 2021
Namespace(batch_size=32, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=True, seed=0, weight_decay=0)
device :  cuda:0
Counter({0: 5142, 1: 3280, 2: 2240})

Epoch :  1 loss training:  238.58147114515305 Time :  14
accuracy train: 0.678962 val: 0.623944 test: 0.617614
max validation accuracy : 0.623944 max acc epoch : 1 test accuracy : 0.617614
Epoch-1 lr: 0.001

Epoch :  2 loss training:  210.62262725830078 Time :  24
accuracy train: 0.748828 val: 0.635211 test: 0.643219
max validation accuracy : 0.635211 max acc epoch : 2 test accuracy : 0.643219
Counter({1: 5380, 0: 5031, 2: 251})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  189.9060995578766 Time :  37
accuracy train: 0.815567 val: 0.636620 test: 0.680079
max validation accuracy : 0.636620 max acc epoch : 3 test accuracy : 0.680079
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  165.76062041521072 Time :  47
accuracy train: 0.852610 val: 0.659155 test: 0.690208
max validation accuracy : 0.659155 max acc epoch : 4 test accuracy : 0.690208
Counter({1: 4886, 2: 3772, 0: 2004})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  164.8447430729866 Time :  62
accuracy train: 0.861519 val: 0.669014 test: 0.695273
max validation accuracy : 0.669014 max acc epoch : 5 test accuracy : 0.695273
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  148.76663357019424 Time :  72
accuracy train: 0.891060 val: 0.653521 test: 0.693303
max validation accuracy : 0.669014 max acc epoch : 5 test accuracy : 0.695273
Counter({1: 5306, 2: 3621, 0: 1735})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  126.27409301698208 Time :  85
accuracy train: 0.902313 val: 0.654930 test: 0.701745
max validation accuracy : 0.669014 max acc epoch : 5 test accuracy : 0.695273
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  118.3614396750927 Time :  95
accuracy train: 0.912785 val: 0.653521 test: 0.704277
max validation accuracy : 0.669014 max acc epoch : 5 test accuracy : 0.695273
Counter({1: 3968, 2: 3607, 0: 3087})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  122.70096978545189 Time :  109
accuracy train: 0.915911 val: 0.640845 test: 0.698087
max validation accuracy : 0.669014 max acc epoch : 5 test accuracy : 0.695273
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  113.51603186130524 Time :  119
accuracy train: 0.929509 val: 0.652113 test: 0.706528
max validation accuracy : 0.669014 max acc epoch : 5 test accuracy : 0.695273
Counter({2: 4603, 1: 3458, 0: 2601})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  111.45004931092262 Time :  129
accuracy train: 0.929822 val: 0.643662 test: 0.706528
max validation accuracy : 0.669014 max acc epoch : 5 test accuracy : 0.695273
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  105.04850614070892 Time :  140
accuracy train: 0.929197 val: 0.639437 test: 0.703714
max validation accuracy : 0.669014 max acc epoch : 5 test accuracy : 0.695273
Counter({1: 5016, 0: 2920, 2: 2726})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  101.02529190480709 Time :  154
accuracy train: 0.936074 val: 0.636620 test: 0.706809
max validation accuracy : 0.669014 max acc epoch : 5 test accuracy : 0.695273
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  100.90726673603058 Time :  164
accuracy train: 0.940294 val: 0.643662 test: 0.703995
max validation accuracy : 0.669014 max acc epoch : 5 test accuracy : 0.695273
Counter({1: 5004, 0: 3367, 2: 2291})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  96.61481359601021 Time :  177
accuracy train: 0.942013 val: 0.640845 test: 0.709060
max validation accuracy : 0.669014 max acc epoch : 5 test accuracy : 0.695273

Epoch :  16 loss training:  94.73644710332155 Time :  187
accuracy train: 0.940138 val: 0.632394 test: 0.702589
max validation accuracy : 0.669014 max acc epoch : 5 test accuracy : 0.695273
Counter({1: 5272, 2: 3096, 0: 2294})

Epoch :  17 loss training:  96.68863701820374 Time :  200
accuracy train: 0.945764 val: 0.638028 test: 0.705402
max validation accuracy : 0.669014 max acc epoch : 5 test accuracy : 0.695273

Epoch :  18 loss training:  92.57542905211449 Time :  211
accuracy train: 0.944670 val: 0.642254 test: 0.698368
max validation accuracy : 0.669014 max acc epoch : 5 test accuracy : 0.695273
Counter({2: 5347, 0: 3227, 1: 2088})

Epoch :  19 loss training:  92.02264447510242 Time :  224
accuracy train: 0.949984 val: 0.650704 test: 0.700338
max validation accuracy : 0.669014 max acc epoch : 5 test accuracy : 0.695273

Epoch :  20 loss training:  88.6315341591835 Time :  234
accuracy train: 0.951391 val: 0.640845 test: 0.702026
max validation accuracy : 0.669014 max acc epoch : 5 test accuracy : 0.695273
Counter({0: 5489, 1: 2975, 2: 2198})

Epoch :  21 loss training:  87.53998410701752 Time :  253
accuracy train: 0.956705 val: 0.654930 test: 0.704840
max validation accuracy : 0.669014 max acc epoch : 5 test accuracy : 0.695273

Epoch :  22 loss training:  87.34896710515022 Time :  264
accuracy train: 0.956080 val: 0.657746 test: 0.707091
max validation accuracy : 0.669014 max acc epoch : 5 test accuracy : 0.695273
Counter({2: 5272, 1: 3560, 0: 1830})

Epoch :  23 loss training:  83.98410005867481 Time :  277
accuracy train: 0.959831 val: 0.643662 test: 0.705121
max validation accuracy : 0.669014 max acc epoch : 5 test accuracy : 0.695273

Epoch :  24 loss training:  84.48053115606308 Time :  288
accuracy train: 0.962176 val: 0.673239 test: 0.710467
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467
Counter({1: 5167, 2: 3909, 0: 1586})

Epoch :  25 loss training:  80.00301896035671 Time :  298
accuracy train: 0.963426 val: 0.652113 test: 0.705965
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467

Epoch :  26 loss training:  80.82399859279394 Time :  310
accuracy train: 0.961863 val: 0.652113 test: 0.705965
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467
Counter({2: 5379, 0: 3127, 1: 2156})

Epoch :  27 loss training:  77.33004108071327 Time :  322
accuracy train: 0.964520 val: 0.654930 test: 0.710748
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467

Epoch :  28 loss training:  81.09483844786882 Time :  332
accuracy train: 0.966552 val: 0.660563 test: 0.706246
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467
Counter({2: 5421, 0: 3655, 1: 1586})

Epoch :  29 loss training:  74.51394146680832 Time :  346
accuracy train: 0.970303 val: 0.656338 test: 0.709342
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467

Epoch :  30 loss training:  74.20874816179276 Time :  357
accuracy train: 0.970772 val: 0.670423 test: 0.708779
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467
Counter({2: 5531, 1: 3589, 0: 1542})

Epoch :  31 loss training:  73.76413168758154 Time :  370
accuracy train: 0.969991 val: 0.663380 test: 0.707935
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467

Epoch :  32 loss training:  71.58918446302414 Time :  381
accuracy train: 0.972804 val: 0.670423 test: 0.704558
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467
Counter({2: 5532, 1: 3346, 0: 1784})

Epoch :  33 loss training:  75.20903065800667 Time :  393
accuracy train: 0.971397 val: 0.659155 test: 0.702589
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467

Epoch :  34 loss training:  72.50920784845948 Time :  404
accuracy train: 0.975461 val: 0.660563 test: 0.704277
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467
Counter({2: 5839, 1: 2794, 0: 2029})

Epoch :  35 loss training:  72.48043383657932 Time :  417
accuracy train: 0.975305 val: 0.667606 test: 0.705965
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467

Epoch :  36 loss training:  69.16902663558722 Time :  427
accuracy train: 0.974836 val: 0.659155 test: 0.705121
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467
Counter({1: 5659, 2: 3427, 0: 1576})

Epoch :  37 loss training:  65.1211615651846 Time :  442
accuracy train: 0.977024 val: 0.661972 test: 0.702870
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467

Epoch :  38 loss training:  65.18783695995808 Time :  454
accuracy train: 0.977493 val: 0.663380 test: 0.704277
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467
Counter({1: 5952, 0: 2812, 2: 1898})

Epoch :  39 loss training:  64.35161753743887 Time :  467
accuracy train: 0.980150 val: 0.663380 test: 0.707372
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467

Epoch :  40 loss training:  65.43465826660395 Time :  478
accuracy train: 0.978900 val: 0.649296 test: 0.704840
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467
Counter({1: 6066, 0: 2525, 2: 2071})

Epoch :  41 loss training:  65.47999042272568 Time :  491
accuracy train: 0.979056 val: 0.657746 test: 0.707091
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467

Epoch :  42 loss training:  67.05809342861176 Time :  501
accuracy train: 0.980932 val: 0.659155 test: 0.707935
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467
Counter({1: 5827, 2: 3067, 0: 1768})

Epoch :  43 loss training:  62.639391995966434 Time :  514
accuracy train: 0.981713 val: 0.669014 test: 0.705121
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467

Epoch :  44 loss training:  62.372640550136566 Time :  524
accuracy train: 0.981400 val: 0.669014 test: 0.708216
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467
Counter({1: 5937, 0: 2777, 2: 1948})

Epoch :  45 loss training:  61.80200330913067 Time :  543
accuracy train: 0.982182 val: 0.663380 test: 0.704558
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467

Epoch :  46 loss training:  61.93451115116477 Time :  554
accuracy train: 0.983745 val: 0.664789 test: 0.706809
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467
Counter({0: 5786, 2: 2511, 1: 2365})

Epoch :  47 loss training:  59.94409255683422 Time :  567
accuracy train: 0.986089 val: 0.664789 test: 0.707935
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467

Epoch :  48 loss training:  60.05415268056095 Time :  577
accuracy train: 0.986558 val: 0.659155 test: 0.708216
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467
Counter({2: 5783, 0: 2791, 1: 2088})

Epoch :  49 loss training:  62.014656245708466 Time :  590
accuracy train: 0.986715 val: 0.659155 test: 0.703714
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467

Epoch :  50 loss training:  55.72343184053898 Time :  601
accuracy train: 0.987027 val: 0.666197 test: 0.703995
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467
Counter({2: 5569, 0: 2551, 1: 2542})

Epoch :  51 loss training:  59.15211395174265 Time :  614
accuracy train: 0.986558 val: 0.664789 test: 0.703151
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467

Epoch :  52 loss training:  55.14586351066828 Time :  624
accuracy train: 0.987652 val: 0.661972 test: 0.709342
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467
Counter({2: 5962, 0: 2689, 1: 2011})

Epoch :  53 loss training:  56.273737497627735 Time :  640
accuracy train: 0.990309 val: 0.673239 test: 0.705965
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467

Epoch :  54 loss training:  52.231879111379385 Time :  651
accuracy train: 0.990622 val: 0.669014 test: 0.708779
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467
Counter({0: 5953, 1: 2864, 2: 1845})

Epoch :  55 loss training:  55.52130877971649 Time :  664
accuracy train: 0.990466 val: 0.669014 test: 0.704558
max validation accuracy : 0.673239 max acc epoch : 24 test accuracy : 0.710467

========================================================================================================================================================================================================
max acc epoch :  24
max validation accuracy :  0.6732394366197183
test accuracy :  0.7104670793472144
last test_accuracy :  0.7045582442318514
========================================================================================================================================================================================================

