date and time :  Sat Apr  3 15:42:10 2021
Namespace(batch_size=16, dataset='R8', debug=False, device=0, dropout=0.4, early_stop=10, epochs=400, filename='', hidden_dim=100, lda=False, lr=0.001, num_layers=4, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=0)
device :  cuda:0
Counter({5: 1472, 2: 1266, 1: 1168, 7: 1131, 4: 1106, 6: 909, 3: 602, 0: 37})
HGNNModel(
  (word_embeddings): Embedding(8232, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
    (2): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=8, bias=True)
    (1): Linear(in_features=100, out_features=8, bias=True)
    (2): Linear(in_features=100, out_features=8, bias=True)
    (3): Linear(in_features=100, out_features=8, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (3): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
  )
  (graph_pool_layer): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (3): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  317.77768469881266 Time :  58
accuracy train: 0.879620 val: 0.878182 test: 0.897717
max validation accuracy : 0.878182 max acc epoch : 1 test accuracy : 0.897717
Counter({0: 6207, 1: 933, 4: 350, 3: 111, 5: 56, 2: 23, 6: 7, 7: 4})

Epoch :  2 loss training:  108.55061438679695 Time :  76
accuracy train: 0.953545 val: 0.938182 test: 0.942466
max validation accuracy : 0.938182 max acc epoch : 2 test accuracy : 0.942466
Counter({2: 4685, 0: 2618, 5: 312, 4: 45, 1: 23, 3: 5, 7: 2, 6: 1})

Epoch :  3 loss training:  67.90879720076919 Time :  111
accuracy train: 0.963442 val: 0.936364 test: 0.946119
max validation accuracy : 0.938182 max acc epoch : 2 test accuracy : 0.942466
Counter({2: 4657, 0: 1325, 3: 762, 5: 556, 7: 285, 4: 80, 1: 23, 6: 3})

Epoch :  4 loss training:  61.69910700619221 Time :  176
accuracy train: 0.961624 val: 0.929091 test: 0.943379
max validation accuracy : 0.938182 max acc epoch : 2 test accuracy : 0.942466
Counter({1: 4182, 4: 1773, 6: 769, 3: 628, 0: 165, 2: 145, 5: 23, 7: 6})

Epoch :  5 loss training:  61.45410863030702 Time :  217
accuracy train: 0.969299 val: 0.943636 test: 0.953881
max validation accuracy : 0.943636 max acc epoch : 5 test accuracy : 0.953881
Counter({3: 3683, 5: 2019, 0: 926, 6: 587, 1: 361, 4: 85, 2: 23, 7: 7})

Epoch :  6 loss training:  49.65175982192159 Time :  268
accuracy train: 0.976570 val: 0.932727 test: 0.942466
max validation accuracy : 0.943636 max acc epoch : 5 test accuracy : 0.953881
Counter({0: 3756, 4: 2191, 2: 723, 1: 684, 7: 303, 5: 26, 6: 7, 3: 1})

Epoch :  7 loss training:  33.72237845137715 Time :  325
accuracy train: 0.982630 val: 0.958182 test: 0.957078
max validation accuracy : 0.958182 max acc epoch : 7 test accuracy : 0.957078
Counter({7: 4390, 1: 1240, 3: 974, 0: 543, 4: 383, 5: 87, 6: 51, 2: 23})

Epoch :  8 loss training:  35.377417341805995 Time :  391
accuracy train: 0.973743 val: 0.950909 test: 0.957991
max validation accuracy : 0.958182 max acc epoch : 7 test accuracy : 0.957078
Counter({0: 5633, 3: 1392, 7: 464, 4: 147, 6: 28, 5: 11, 1: 10, 2: 6})

Epoch :  9 loss training:  32.67966017453 Time :  432
accuracy train: 0.983842 val: 0.956364 test: 0.950685
max validation accuracy : 0.958182 max acc epoch : 7 test accuracy : 0.957078
Counter({0: 6247, 5: 865, 2: 322, 7: 222, 1: 23, 6: 5, 3: 4, 4: 3})

Epoch :  10 loss training:  32.414985198527575 Time :  460
accuracy train: 0.981216 val: 0.954545 test: 0.957991
max validation accuracy : 0.958182 max acc epoch : 7 test accuracy : 0.957078
Counter({0: 5555, 1: 794, 6: 680, 7: 373, 5: 159, 2: 87, 3: 24, 4: 19})

Epoch :  11 loss training:  31.978077383711934 Time :  500
accuracy train: 0.987073 val: 0.947273 test: 0.955251
max validation accuracy : 0.958182 max acc epoch : 7 test accuracy : 0.957078
Counter({2: 4658, 6: 1022, 1: 812, 0: 484, 7: 425, 4: 189, 5: 84, 3: 17})

Epoch :  12 loss training:  27.253695672377944 Time :  536
accuracy train: 0.985659 val: 0.960000 test: 0.957078
max validation accuracy : 0.960000 max acc epoch : 12 test accuracy : 0.957078
Counter({1: 5008, 4: 1163, 0: 847, 7: 387, 5: 154, 2: 65, 3: 42, 6: 25})

Epoch :  13 loss training:  24.057803551556844 Time :  561
accuracy train: 0.988285 val: 0.956364 test: 0.959817
max validation accuracy : 0.960000 max acc epoch : 12 test accuracy : 0.957078
Counter({7: 3802, 0: 2072, 4: 668, 2: 377, 3: 359, 1: 262, 5: 116, 6: 35})

Epoch :  14 loss training:  25.05383442249149 Time :  581
accuracy train: 0.986467 val: 0.952727 test: 0.953881
max validation accuracy : 0.960000 max acc epoch : 12 test accuracy : 0.957078
Counter({4: 4812, 1: 830, 0: 806, 5: 748, 6: 210, 2: 184, 7: 82, 3: 19})

Epoch :  15 loss training:  41.24143845774233 Time :  638
accuracy train: 0.983236 val: 0.940000 test: 0.949772
max validation accuracy : 0.960000 max acc epoch : 12 test accuracy : 0.957078
Counter({0: 7450, 7: 121, 6: 69, 1: 23, 4: 19, 3: 6, 5: 2, 2: 1})

Epoch :  16 loss training:  30.996388288214803 Time :  791
accuracy train: 0.988083 val: 0.954545 test: 0.955708
max validation accuracy : 0.960000 max acc epoch : 12 test accuracy : 0.957078
Counter({3: 6721, 6: 593, 5: 255, 0: 77, 1: 23, 2: 14, 7: 7, 4: 1})

Epoch :  17 loss training:  16.84029186144471 Time :  923
accuracy train: 0.992527 val: 0.949091 test: 0.958447
max validation accuracy : 0.960000 max acc epoch : 12 test accuracy : 0.957078
Counter({2: 5092, 0: 871, 7: 666, 3: 531, 5: 322, 4: 166, 1: 23, 6: 20})

Epoch :  18 loss training:  18.638247556897113 Time :  1041
accuracy train: 0.990103 val: 0.950909 test: 0.957534
max validation accuracy : 0.960000 max acc epoch : 12 test accuracy : 0.957078
Counter({4: 5506, 6: 750, 0: 705, 2: 630, 7: 67, 1: 23, 5: 9, 3: 1})

Epoch :  19 loss training:  17.361309505766258 Time :  1117
accuracy train: 0.992931 val: 0.954545 test: 0.958904
max validation accuracy : 0.960000 max acc epoch : 12 test accuracy : 0.957078
Counter({5: 5433, 4: 1037, 2: 513, 0: 307, 6: 303, 7: 66, 1: 23, 3: 9})

Epoch :  20 loss training:  19.32882277900353 Time :  1191
accuracy train: 0.990103 val: 0.947273 test: 0.953425
max validation accuracy : 0.960000 max acc epoch : 12 test accuracy : 0.957078
Counter({6: 4644, 0: 1079, 5: 744, 3: 664, 2: 268, 4: 204, 7: 65, 1: 23})

Epoch :  21 loss training:  21.132855823729187 Time :  1268
accuracy train: 0.991113 val: 0.958182 test: 0.957534
max validation accuracy : 0.960000 max acc epoch : 12 test accuracy : 0.957078
Counter({0: 4891, 7: 1351, 6: 585, 4: 440, 2: 324, 3: 70, 1: 23, 5: 7})

Epoch :  22 loss training:  17.63533926731907 Time :  1371
accuracy train: 0.993941 val: 0.949091 test: 0.954338
max validation accuracy : 0.960000 max acc epoch : 12 test accuracy : 0.957078
Counter({3: 4250, 5: 1548, 6: 723, 4: 635, 2: 253, 7: 250, 1: 23, 0: 9})

Epoch :  23 loss training:  11.085600280435756 Time :  1543
accuracy train: 0.995556 val: 0.956364 test: 0.962100
max validation accuracy : 0.960000 max acc epoch : 12 test accuracy : 0.957078
Counter({6: 3730, 5: 1305, 0: 987, 7: 662, 3: 379, 2: 314, 4: 291, 1: 23})

========================================================================================================================================================================================================
max acc epoch :  12
max validation accuracy :  0.96
test accuracy :  0.9570776255707762
last test_accuracy :  0.9621004566210045
========================================================================================================================================================================================================

date and time :  Sat Apr  3 16:10:40 2021
Namespace(batch_size=16, dataset='R8', debug=False, device=0, dropout=0.4, early_stop=10, epochs=400, filename='', hidden_dim=100, lda=False, lr=0.0005, num_layers=4, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=0)
device :  cuda:0
Counter({5: 1472, 2: 1266, 1: 1168, 7: 1131, 4: 1106, 6: 909, 3: 602, 0: 37})
HGNNModel(
  (word_embeddings): Embedding(8232, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
    (2): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=8, bias=True)
    (1): Linear(in_features=100, out_features=8, bias=True)
    (2): Linear(in_features=100, out_features=8, bias=True)
    (3): Linear(in_features=100, out_features=8, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (3): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
  )
  (graph_pool_layer): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (3): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  390.2097798883915 Time :  95
accuracy train: 0.834175 val: 0.810909 test: 0.853881
max validation accuracy : 0.810909 max acc epoch : 1 test accuracy : 0.853881
Counter({2: 5367, 6: 1274, 4: 516, 5: 249, 1: 129, 0: 93, 3: 58, 7: 5})

Epoch :  2 loss training:  135.7077888250351 Time :  153
accuracy train: 0.933549 val: 0.903636 test: 0.926941
max validation accuracy : 0.903636 max acc epoch : 2 test accuracy : 0.926941
Counter({4: 4500, 0: 1074, 2: 872, 7: 609, 3: 582, 5: 30, 1: 23, 6: 1})

Epoch :  3 loss training:  83.47196762263775 Time :  217
accuracy train: 0.956776 val: 0.934545 test: 0.936530
max validation accuracy : 0.934545 max acc epoch : 3 test accuracy : 0.936530
Counter({3: 4245, 0: 1574, 5: 711, 2: 542, 7: 327, 4: 163, 6: 106, 1: 23})

Epoch :  4 loss training:  67.18559896945953 Time :  303
accuracy train: 0.964250 val: 0.938182 test: 0.949772
max validation accuracy : 0.938182 max acc epoch : 4 test accuracy : 0.949772
Counter({6: 3866, 7: 1227, 2: 988, 0: 716, 4: 485, 3: 332, 5: 54, 1: 23})

Epoch :  5 loss training:  57.48793828487396 Time :  346
accuracy train: 0.966875 val: 0.943636 test: 0.959361
max validation accuracy : 0.943636 max acc epoch : 5 test accuracy : 0.959361
Counter({1: 5081, 7: 1102, 0: 655, 3: 626, 6: 174, 4: 28, 2: 23, 5: 2})

Epoch :  6 loss training:  46.31113722920418 Time :  390
accuracy train: 0.975157 val: 0.947273 test: 0.953425
max validation accuracy : 0.947273 max acc epoch : 6 test accuracy : 0.953425
Counter({1: 4977, 5: 1968, 0: 453, 3: 234, 4: 27, 2: 23, 7: 7, 6: 2})

Epoch :  7 loss training:  45.24893593788147 Time :  443
accuracy train: 0.974753 val: 0.952727 test: 0.948402
max validation accuracy : 0.952727 max acc epoch : 7 test accuracy : 0.948402
Counter({5: 4551, 0: 1226, 6: 1163, 3: 473, 1: 131, 4: 114, 2: 27, 7: 6})

Epoch :  8 loss training:  40.81491659581661 Time :  491
accuracy train: 0.981216 val: 0.954545 test: 0.961187
max validation accuracy : 0.954545 max acc epoch : 8 test accuracy : 0.961187
Counter({0: 3980, 4: 1586, 2: 1281, 6: 373, 7: 299, 5: 145, 1: 23, 3: 4})

Epoch :  9 loss training:  35.754917587619275 Time :  531
accuracy train: 0.985659 val: 0.960000 test: 0.963014
max validation accuracy : 0.960000 max acc epoch : 9 test accuracy : 0.963014
Counter({2: 3953, 7: 1228, 0: 1150, 3: 773, 5: 435, 6: 84, 4: 45, 1: 23})

Epoch :  10 loss training:  30.587168807163835 Time :  571
accuracy train: 0.988083 val: 0.958182 test: 0.958904
max validation accuracy : 0.960000 max acc epoch : 9 test accuracy : 0.963014
Counter({4: 3859, 3: 1145, 2: 1105, 6: 554, 0: 510, 5: 340, 7: 155, 1: 23})

Epoch :  11 loss training:  27.443429646315053 Time :  621
accuracy train: 0.989093 val: 0.963636 test: 0.963927
max validation accuracy : 0.963636 max acc epoch : 11 test accuracy : 0.963927
Counter({4: 3976, 5: 959, 3: 938, 0: 681, 1: 547, 7: 381, 6: 186, 2: 23})

Epoch :  12 loss training:  31.15460948832333 Time :  667
accuracy train: 0.988285 val: 0.969091 test: 0.964840
max validation accuracy : 0.969091 max acc epoch : 12 test accuracy : 0.964840
Counter({2: 4522, 0: 1123, 4: 719, 5: 630, 7: 372, 3: 272, 6: 30, 1: 23})

Epoch :  13 loss training:  27.630698636174202 Time :  718
accuracy train: 0.987073 val: 0.954545 test: 0.961644
max validation accuracy : 0.969091 max acc epoch : 12 test accuracy : 0.964840
Counter({7: 4312, 5: 1295, 3: 835, 2: 663, 0: 480, 4: 82, 1: 23, 6: 1})

Epoch :  14 loss training:  27.12526003457606 Time :  765
accuracy train: 0.989093 val: 0.958182 test: 0.961644
max validation accuracy : 0.969091 max acc epoch : 12 test accuracy : 0.964840
Counter({1: 3386, 0: 1548, 7: 1031, 3: 579, 2: 538, 4: 399, 5: 184, 6: 26})

Epoch :  15 loss training:  25.80903465813026 Time :  826
accuracy train: 0.988487 val: 0.967273 test: 0.959817
max validation accuracy : 0.969091 max acc epoch : 12 test accuracy : 0.964840
Counter({6: 4026, 3: 1005, 0: 1002, 4: 615, 1: 543, 7: 288, 2: 185, 5: 27})

Epoch :  16 loss training:  19.665947215631604 Time :  883
accuracy train: 0.991719 val: 0.952727 test: 0.956621
max validation accuracy : 0.969091 max acc epoch : 12 test accuracy : 0.964840
Counter({3: 3526, 0: 1447, 6: 1058, 1: 984, 4: 289, 5: 207, 7: 154, 2: 26})

Epoch :  17 loss training:  23.581049062428065 Time :  943
accuracy train: 0.990709 val: 0.950909 test: 0.950685
max validation accuracy : 0.969091 max acc epoch : 12 test accuracy : 0.964840
Counter({3: 4525, 4: 985, 0: 672, 6: 562, 7: 446, 1: 346, 5: 132, 2: 23})

Epoch :  18 loss training:  19.52489800611511 Time :  984
accuracy train: 0.992527 val: 0.952727 test: 0.953881
max validation accuracy : 0.969091 max acc epoch : 12 test accuracy : 0.964840
Counter({2: 4010, 4: 1223, 0: 940, 7: 611, 5: 484, 3: 258, 6: 142, 1: 23})

Epoch :  19 loss training:  20.266169262118638 Time :  1037
accuracy train: 0.993335 val: 0.954545 test: 0.958904
max validation accuracy : 0.969091 max acc epoch : 12 test accuracy : 0.964840
Counter({7: 4235, 4: 1200, 1: 984, 0: 576, 6: 431, 2: 172, 3: 69, 5: 24})

Epoch :  20 loss training:  19.25564168486744 Time :  1080
accuracy train: 0.994547 val: 0.961818 test: 0.959361
max validation accuracy : 0.969091 max acc epoch : 12 test accuracy : 0.964840
Counter({2: 4826, 0: 675, 1: 585, 4: 559, 6: 476, 7: 455, 5: 91, 3: 24})

Epoch :  21 loss training:  19.12570321233943 Time :  1108
accuracy train: 0.994749 val: 0.956364 test: 0.961644
max validation accuracy : 0.969091 max acc epoch : 12 test accuracy : 0.964840
Counter({7: 4802, 5: 1121, 2: 678, 3: 570, 0: 265, 1: 133, 4: 96, 6: 26})

Epoch :  22 loss training:  23.895090945647098 Time :  1178
accuracy train: 0.995354 val: 0.965455 test: 0.956164
max validation accuracy : 0.969091 max acc epoch : 12 test accuracy : 0.964840
Counter({3: 3748, 1: 1087, 7: 976, 6: 772, 4: 501, 0: 239, 5: 226, 2: 142})

Epoch :  23 loss training:  15.98255242779851 Time :  1232
accuracy train: 0.988891 val: 0.950909 test: 0.943836
max validation accuracy : 0.969091 max acc epoch : 12 test accuracy : 0.964840
Counter({5: 4364, 7: 832, 0: 752, 4: 547, 6: 540, 2: 413, 3: 220, 1: 23})

========================================================================================================================================================================================================
max acc epoch :  12
max validation accuracy :  0.9690909090909091
test accuracy :  0.9648401826484019
last test_accuracy :  0.9438356164383561
========================================================================================================================================================================================================

date and time :  Sat Apr  3 16:32:14 2021
Namespace(batch_size=16, dataset='R8', debug=False, device=0, dropout=0.4, early_stop=10, epochs=400, filename='', hidden_dim=100, lda=False, lr=0.001, num_layers=3, num_mlp_layers=2, random_vec=False, seed=0, weight_decay=0)
device :  cuda:0
Counter({5: 1472, 2: 1266, 1: 1168, 7: 1131, 4: 1106, 6: 909, 3: 602, 0: 37})
HGNNModel(
  (word_embeddings): Embedding(8232, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=100, bias=True)
          (1): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
          (1): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
          (1): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
          (1): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=8, bias=True)
    (1): Linear(in_features=100, out_features=8, bias=True)
    (2): Linear(in_features=100, out_features=8, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
  )
  (graph_pool_layer): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  293.01052446104586 Time :  87
accuracy train: 0.906686 val: 0.872727 test: 0.902283
max validation accuracy : 0.872727 max acc epoch : 1 test accuracy : 0.902283
Counter({4: 2326, 1: 2235, 7: 1273, 0: 952, 6: 295, 3: 293, 5: 195, 2: 122})

Epoch :  2 loss training:  124.13902640342712 Time :  121
accuracy train: 0.939608 val: 0.914545 test: 0.934247
max validation accuracy : 0.914545 max acc epoch : 2 test accuracy : 0.934247
Counter({0: 2864, 7: 1900, 4: 1233, 3: 644, 1: 512, 6: 281, 2: 171, 5: 86})

Epoch :  3 loss training:  93.35995391011238 Time :  172
accuracy train: 0.952939 val: 0.921818 test: 0.957078
max validation accuracy : 0.921818 max acc epoch : 3 test accuracy : 0.957078
Counter({5: 3160, 1: 1820, 3: 919, 0: 778, 6: 498, 2: 209, 7: 203, 4: 104})

Epoch :  4 loss training:  79.42993940412998 Time :  228
accuracy train: 0.954151 val: 0.938182 test: 0.949315
max validation accuracy : 0.938182 max acc epoch : 4 test accuracy : 0.949315
Counter({0: 3073, 7: 1610, 2: 1138, 5: 466, 3: 398, 6: 391, 1: 387, 4: 228})

Epoch :  5 loss training:  76.00090961903334 Time :  279
accuracy train: 0.961422 val: 0.936364 test: 0.957991
max validation accuracy : 0.938182 max acc epoch : 4 test accuracy : 0.949315
Counter({1: 3548, 6: 1293, 7: 1061, 5: 818, 0: 347, 4: 272, 3: 231, 2: 121})

Epoch :  6 loss training:  67.53818425536156 Time :  317
accuracy train: 0.964654 val: 0.940000 test: 0.951598
max validation accuracy : 0.940000 max acc epoch : 6 test accuracy : 0.951598
Counter({6: 3068, 7: 1505, 0: 1344, 5: 528, 2: 520, 1: 324, 3: 262, 4: 140})

Epoch :  7 loss training:  63.28830646548886 Time :  357
accuracy train: 0.969905 val: 0.945455 test: 0.958904
max validation accuracy : 0.945455 max acc epoch : 7 test accuracy : 0.958904
Counter({7: 2774, 0: 1604, 6: 1472, 5: 668, 1: 471, 4: 406, 3: 177, 2: 119})

Epoch :  8 loss training:  68.75085780024529 Time :  399
accuracy train: 0.971925 val: 0.950909 test: 0.956621
max validation accuracy : 0.950909 max acc epoch : 8 test accuracy : 0.956621
Counter({2: 3451, 5: 1653, 4: 827, 6: 623, 3: 485, 0: 318, 7: 219, 1: 115})

Epoch :  9 loss training:  48.75909823179245 Time :  464
accuracy train: 0.975359 val: 0.949091 test: 0.958904
max validation accuracy : 0.950909 max acc epoch : 8 test accuracy : 0.956621
Counter({6: 3396, 7: 1403, 1: 1223, 2: 617, 4: 501, 3: 264, 0: 193, 5: 94})

Epoch :  10 loss training:  89.35399016737938 Time :  514
accuracy train: 0.973541 val: 0.945455 test: 0.953425
max validation accuracy : 0.950909 max acc epoch : 8 test accuracy : 0.956621
Counter({5: 2886, 3: 1381, 0: 1229, 1: 774, 7: 595, 2: 351, 6: 310, 4: 165})

Epoch :  11 loss training:  45.69462341070175 Time :  555
accuracy train: 0.974955 val: 0.956364 test: 0.965297
max validation accuracy : 0.956364 max acc epoch : 11 test accuracy : 0.965297
Counter({5: 2305, 2: 1678, 3: 1659, 0: 713, 4: 466, 6: 464, 1: 203, 7: 203})

Epoch :  12 loss training:  44.829432006925344 Time :  631
accuracy train: 0.977580 val: 0.947273 test: 0.953425
max validation accuracy : 0.956364 max acc epoch : 11 test accuracy : 0.965297
Counter({4: 3192, 3: 1433, 1: 1204, 0: 790, 6: 373, 2: 343, 5: 188, 7: 168})

Epoch :  13 loss training:  36.91775478422642 Time :  669
accuracy train: 0.982024 val: 0.956364 test: 0.961187
max validation accuracy : 0.956364 max acc epoch : 11 test accuracy : 0.965297
Counter({7: 2856, 3: 1548, 0: 1534, 2: 744, 6: 476, 1: 321, 4: 118, 5: 94})

Epoch :  14 loss training:  31.762647725641727 Time :  727
accuracy train: 0.983640 val: 0.954545 test: 0.957991
max validation accuracy : 0.956364 max acc epoch : 11 test accuracy : 0.965297
Counter({1: 2734, 6: 1538, 2: 1470, 5: 795, 7: 473, 0: 417, 4: 138, 3: 126})

Epoch :  15 loss training:  27.114664264023304 Time :  780
accuracy train: 0.985659 val: 0.950909 test: 0.961187
max validation accuracy : 0.956364 max acc epoch : 11 test accuracy : 0.965297
Counter({4: 2786, 6: 1552, 1: 1307, 0: 714, 5: 592, 2: 440, 7: 175, 3: 125})

Epoch :  16 loss training:  29.304009843617678 Time :  849
accuracy train: 0.986467 val: 0.949091 test: 0.959361
max validation accuracy : 0.956364 max acc epoch : 11 test accuracy : 0.965297
Counter({0: 3879, 3: 1273, 7: 937, 5: 634, 2: 468, 1: 233, 4: 150, 6: 117})

Epoch :  17 loss training:  49.92764702811837 Time :  906
accuracy train: 0.961624 val: 0.940000 test: 0.944749
max validation accuracy : 0.956364 max acc epoch : 11 test accuracy : 0.965297
Counter({0: 3148, 2: 1565, 5: 1142, 7: 748, 4: 522, 6: 201, 1: 191, 3: 174})

Epoch :  18 loss training:  54.65207788720727 Time :  965
accuracy train: 0.984448 val: 0.956364 test: 0.955251
max validation accuracy : 0.956364 max acc epoch : 11 test accuracy : 0.965297
Counter({0: 2872, 7: 1683, 4: 1088, 3: 644, 6: 581, 5: 496, 1: 186, 2: 141})

Epoch :  19 loss training:  38.74124648049474 Time :  1010
accuracy train: 0.980408 val: 0.956364 test: 0.956164
max validation accuracy : 0.956364 max acc epoch : 11 test accuracy : 0.965297
Counter({6: 2248, 0: 2057, 1: 1345, 7: 654, 5: 612, 3: 392, 4: 271, 2: 112})

Epoch :  20 loss training:  29.990283793827984 Time :  1056
accuracy train: 0.988689 val: 0.960000 test: 0.954795
max validation accuracy : 0.960000 max acc epoch : 20 test accuracy : 0.954795
Counter({0: 3744, 6: 1656, 5: 800, 3: 632, 1: 305, 2: 254, 7: 175, 4: 125})

Epoch :  21 loss training:  23.83486150112003 Time :  1100
accuracy train: 0.988285 val: 0.956364 test: 0.953425
max validation accuracy : 0.960000 max acc epoch : 20 test accuracy : 0.954795
Counter({3: 3882, 1: 1626, 0: 822, 5: 407, 2: 350, 6: 323, 7: 187, 4: 94})

Epoch :  22 loss training:  31.4150481633842 Time :  1138
accuracy train: 0.988689 val: 0.958182 test: 0.957078
max validation accuracy : 0.960000 max acc epoch : 20 test accuracy : 0.954795
Counter({1: 3866, 2: 1249, 3: 994, 7: 706, 4: 393, 6: 274, 5: 129, 0: 80})

Epoch :  23 loss training:  32.751893911510706 Time :  1169
accuracy train: 0.986265 val: 0.956364 test: 0.961644
max validation accuracy : 0.960000 max acc epoch : 20 test accuracy : 0.954795
Counter({4: 4184, 1: 1349, 0: 778, 3: 554, 5: 335, 6: 225, 2: 162, 7: 104})

Epoch :  24 loss training:  24.928785123862326 Time :  1199
accuracy train: 0.990911 val: 0.950909 test: 0.954338
max validation accuracy : 0.960000 max acc epoch : 20 test accuracy : 0.954795
Counter({0: 4067, 2: 1347, 6: 977, 1: 498, 3: 383, 5: 173, 4: 133, 7: 113})

Epoch :  25 loss training:  24.77211078070104 Time :  1226
accuracy train: 0.992325 val: 0.954545 test: 0.957078
max validation accuracy : 0.960000 max acc epoch : 20 test accuracy : 0.954795
Counter({6: 4014, 1: 1423, 4: 918, 0: 495, 3: 326, 7: 278, 5: 137, 2: 100})

Epoch :  26 loss training:  19.927596725523472 Time :  1255
accuracy train: 0.993739 val: 0.958182 test: 0.963014
max validation accuracy : 0.960000 max acc epoch : 20 test accuracy : 0.954795
Counter({5: 4061, 1: 983, 6: 743, 0: 735, 2: 469, 3: 449, 7: 142, 4: 109})

Epoch :  27 loss training:  20.769132429733872 Time :  1276
accuracy train: 0.982428 val: 0.941818 test: 0.943836
max validation accuracy : 0.960000 max acc epoch : 20 test accuracy : 0.954795
Counter({0: 3825, 6: 1759, 4: 635, 2: 494, 1: 319, 7: 305, 3: 232, 5: 122})

Epoch :  28 loss training:  29.94479940738529 Time :  1321
accuracy train: 0.993335 val: 0.956364 test: 0.961644
max validation accuracy : 0.960000 max acc epoch : 20 test accuracy : 0.954795
Counter({0: 4138, 1: 1049, 3: 756, 5: 730, 6: 466, 7: 288, 2: 149, 4: 115})

Epoch :  29 loss training:  20.05375900864601 Time :  1344
accuracy train: 0.992527 val: 0.952727 test: 0.962100
max validation accuracy : 0.960000 max acc epoch : 20 test accuracy : 0.954795
Counter({2: 4258, 4: 1134, 0: 1060, 1: 390, 5: 314, 7: 297, 3: 126, 6: 112})

Epoch :  30 loss training:  13.846118303015828 Time :  1382
accuracy train: 0.992325 val: 0.949091 test: 0.953425
max validation accuracy : 0.960000 max acc epoch : 20 test accuracy : 0.954795
Counter({0: 4055, 3: 1137, 5: 976, 1: 581, 6: 480, 7: 217, 4: 164, 2: 81})

Epoch :  31 loss training:  16.4760390164447 Time :  1423
accuracy train: 0.992729 val: 0.952727 test: 0.953425
max validation accuracy : 0.960000 max acc epoch : 20 test accuracy : 0.954795
Counter({0: 4227, 3: 1067, 6: 947, 1: 494, 5: 452, 2: 246, 7: 160, 4: 98})

========================================================================================================================================================================================================
max acc epoch :  20
max validation accuracy :  0.96
test accuracy :  0.9547945205479452
last test_accuracy :  0.9534246575342465
========================================================================================================================================================================================================

date and time :  Sat Apr  3 16:57:00 2021
Namespace(batch_size=16, dataset='R8', debug=False, device=0, dropout=0.4, early_stop=10, epochs=400, filename='', hidden_dim=100, lda=False, lr=0.0005, num_layers=3, num_mlp_layers=2, random_vec=False, seed=0, weight_decay=0)
device :  cuda:0
Counter({5: 1472, 2: 1266, 1: 1168, 7: 1131, 4: 1106, 6: 909, 3: 602, 0: 37})
HGNNModel(
  (word_embeddings): Embedding(8232, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=100, bias=True)
          (1): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
          (1): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
          (1): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
          (1): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=8, bias=True)
    (1): Linear(in_features=100, out_features=8, bias=True)
    (2): Linear(in_features=100, out_features=8, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
  )
  (graph_pool_layer): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  337.947881937027 Time :  69
accuracy train: 0.865482 val: 0.850909 test: 0.871233
max validation accuracy : 0.850909 max acc epoch : 1 test accuracy : 0.871233
Counter({0: 2881, 7: 1440, 2: 1191, 5: 1006, 1: 504, 4: 351, 3: 257, 6: 61})

Epoch :  2 loss training:  141.08479400724173 Time :  106
accuracy train: 0.932539 val: 0.912727 test: 0.939269
max validation accuracy : 0.912727 max acc epoch : 2 test accuracy : 0.939269
Counter({3: 2481, 7: 2075, 6: 1232, 2: 627, 1: 624, 4: 320, 5: 179, 0: 153})

Epoch :  3 loss training:  105.23084811121225 Time :  129
accuracy train: 0.942840 val: 0.918182 test: 0.945205
max validation accuracy : 0.918182 max acc epoch : 3 test accuracy : 0.945205
Counter({1: 2603, 0: 1745, 3: 1170, 6: 932, 4: 529, 2: 357, 5: 258, 7: 97})

Epoch :  4 loss training:  95.12934640049934 Time :  151
accuracy train: 0.946475 val: 0.932727 test: 0.941096
max validation accuracy : 0.932727 max acc epoch : 4 test accuracy : 0.941096
Counter({3: 2356, 1: 1564, 6: 1363, 7: 964, 2: 562, 0: 523, 5: 210, 4: 149})

Epoch :  5 loss training:  79.354048371315 Time :  189
accuracy train: 0.957180 val: 0.936364 test: 0.953425
max validation accuracy : 0.936364 max acc epoch : 5 test accuracy : 0.953425
Counter({0: 2516, 3: 1821, 7: 1073, 1: 997, 4: 446, 2: 433, 6: 275, 5: 130})

Epoch :  6 loss training:  70.38439147919416 Time :  230
accuracy train: 0.963644 val: 0.947273 test: 0.952968
max validation accuracy : 0.947273 max acc epoch : 6 test accuracy : 0.952968
Counter({1: 2679, 6: 1241, 7: 1143, 4: 1093, 5: 651, 0: 371, 3: 305, 2: 208})

Epoch :  7 loss training:  68.47215302288532 Time :  246
accuracy train: 0.962836 val: 0.941818 test: 0.958904
max validation accuracy : 0.947273 max acc epoch : 6 test accuracy : 0.952968
Counter({1: 2822, 7: 1454, 6: 1110, 4: 1030, 3: 634, 5: 299, 2: 191, 0: 151})

Epoch :  8 loss training:  60.4393597766757 Time :  305
accuracy train: 0.968087 val: 0.947273 test: 0.952511
max validation accuracy : 0.947273 max acc epoch : 6 test accuracy : 0.952968
Counter({4: 2763, 3: 1760, 0: 1133, 5: 631, 1: 619, 7: 381, 6: 318, 2: 86})

Epoch :  9 loss training:  55.837308406829834 Time :  350
accuracy train: 0.973945 val: 0.949091 test: 0.955708
max validation accuracy : 0.949091 max acc epoch : 9 test accuracy : 0.955708
Counter({2: 2900, 5: 1439, 6: 1176, 0: 758, 3: 649, 4: 362, 7: 318, 1: 89})

Epoch :  10 loss training:  61.13454049825668 Time :  377
accuracy train: 0.972127 val: 0.947273 test: 0.957991
max validation accuracy : 0.949091 max acc epoch : 9 test accuracy : 0.955708
Counter({0: 2810, 7: 1386, 2: 1154, 5: 1029, 1: 554, 6: 396, 3: 200, 4: 162})

Epoch :  11 loss training:  55.57081628777087 Time :  398
accuracy train: 0.973339 val: 0.950909 test: 0.961644
max validation accuracy : 0.950909 max acc epoch : 11 test accuracy : 0.961644
Counter({7: 2746, 1: 1588, 3: 1071, 0: 729, 6: 541, 4: 522, 5: 372, 2: 122})

Epoch :  12 loss training:  45.37837461382151 Time :  422
accuracy train: 0.975762 val: 0.952727 test: 0.959361
max validation accuracy : 0.952727 max acc epoch : 12 test accuracy : 0.959361
Counter({1: 2369, 3: 1905, 7: 1104, 5: 928, 0: 538, 2: 399, 6: 331, 4: 117})

Epoch :  13 loss training:  41.18625704199076 Time :  442
accuracy train: 0.975964 val: 0.956364 test: 0.958904
max validation accuracy : 0.956364 max acc epoch : 13 test accuracy : 0.958904
Counter({3: 2228, 6: 1369, 1: 1307, 4: 968, 5: 896, 0: 386, 2: 362, 7: 175})

Epoch :  14 loss training:  43.17682604491711 Time :  478
accuracy train: 0.978994 val: 0.941818 test: 0.950685
max validation accuracy : 0.956364 max acc epoch : 13 test accuracy : 0.958904
Counter({7: 2663, 5: 1725, 3: 1220, 2: 773, 1: 489, 6: 353, 0: 256, 4: 212})

Epoch :  15 loss training:  40.334798488765955 Time :  506
accuracy train: 0.980004 val: 0.954545 test: 0.951598
max validation accuracy : 0.956364 max acc epoch : 13 test accuracy : 0.958904
Counter({1: 2672, 2: 1657, 4: 1201, 0: 764, 7: 504, 6: 488, 3: 245, 5: 160})

Epoch :  16 loss training:  41.05636884085834 Time :  546
accuracy train: 0.975560 val: 0.947273 test: 0.946119
max validation accuracy : 0.956364 max acc epoch : 13 test accuracy : 0.958904
Counter({5: 2175, 0: 2010, 2: 993, 3: 706, 6: 631, 7: 609, 1: 408, 4: 159})

Epoch :  17 loss training:  36.310324339196086 Time :  587
accuracy train: 0.987275 val: 0.961818 test: 0.961644
max validation accuracy : 0.961818 max acc epoch : 17 test accuracy : 0.961644
Counter({3: 3135, 1: 1246, 7: 1195, 2: 699, 4: 688, 6: 452, 0: 145, 5: 131})

Epoch :  18 loss training:  35.00313017144799 Time :  623
accuracy train: 0.985659 val: 0.952727 test: 0.959817
max validation accuracy : 0.961818 max acc epoch : 17 test accuracy : 0.961644
Counter({6: 3204, 0: 1621, 5: 1210, 1: 694, 2: 661, 7: 152, 3: 148, 4: 1})

Epoch :  19 loss training:  35.59076044894755 Time :  646
accuracy train: 0.984246 val: 0.961818 test: 0.967580
max validation accuracy : 0.961818 max acc epoch : 17 test accuracy : 0.961644
Counter({3: 2990, 0: 1095, 5: 1064, 6: 787, 2: 747, 4: 498, 7: 321, 1: 189})

Epoch :  20 loss training:  34.95447414042428 Time :  665
accuracy train: 0.985054 val: 0.958182 test: 0.965753
max validation accuracy : 0.961818 max acc epoch : 17 test accuracy : 0.961644
Counter({4: 3236, 7: 1539, 1: 1009, 5: 692, 6: 536, 0: 376, 3: 179, 2: 124})

Epoch :  21 loss training:  34.34409072995186 Time :  687
accuracy train: 0.989497 val: 0.961818 test: 0.957534
max validation accuracy : 0.961818 max acc epoch : 17 test accuracy : 0.961644
Counter({0: 3717, 4: 1463, 2: 880, 1: 511, 5: 502, 3: 309, 7: 217, 6: 92})

Epoch :  22 loss training:  30.00614385306835 Time :  706
accuracy train: 0.990305 val: 0.956364 test: 0.966210
max validation accuracy : 0.961818 max acc epoch : 17 test accuracy : 0.961644
Counter({1: 3270, 6: 1128, 0: 1066, 3: 1041, 4: 428, 5: 351, 2: 263, 7: 144})

Epoch :  23 loss training:  27.87960066460073 Time :  727
accuracy train: 0.991113 val: 0.954545 test: 0.958447
max validation accuracy : 0.961818 max acc epoch : 17 test accuracy : 0.961644
Counter({6: 3262, 0: 1487, 3: 1387, 7: 541, 4: 454, 1: 322, 2: 145, 5: 93})

Epoch :  24 loss training:  31.732637617271394 Time :  748
accuracy train: 0.988891 val: 0.952727 test: 0.963014
max validation accuracy : 0.961818 max acc epoch : 17 test accuracy : 0.961644
Counter({3: 2836, 0: 1597, 2: 1487, 6: 669, 5: 625, 4: 201, 1: 192, 7: 84})

Epoch :  25 loss training:  30.876220472157 Time :  773
accuracy train: 0.990911 val: 0.950909 test: 0.958447
max validation accuracy : 0.961818 max acc epoch : 17 test accuracy : 0.961644
Counter({1: 2667, 3: 1614, 4: 1236, 2: 644, 6: 637, 5: 453, 0: 332, 7: 108})

Epoch :  26 loss training:  24.64812777750194 Time :  809
accuracy train: 0.990305 val: 0.970909 test: 0.963470
max validation accuracy : 0.970909 max acc epoch : 26 test accuracy : 0.963470
Counter({3: 2915, 1: 1383, 2: 1227, 5: 818, 6: 512, 4: 394, 0: 299, 7: 143})

Epoch :  27 loss training:  26.973960226401687 Time :  827
accuracy train: 0.992123 val: 0.960000 test: 0.954338
max validation accuracy : 0.970909 max acc epoch : 26 test accuracy : 0.963470
Counter({3: 2921, 1: 1318, 7: 1203, 2: 1086, 0: 617, 4: 270, 5: 179, 6: 97})

Epoch :  28 loss training:  21.2513433881104 Time :  871
accuracy train: 0.992123 val: 0.965455 test: 0.963927
max validation accuracy : 0.970909 max acc epoch : 26 test accuracy : 0.963470
Counter({2: 2838, 5: 1402, 6: 1341, 0: 768, 4: 678, 7: 279, 3: 250, 1: 135})

Epoch :  29 loss training:  23.661630605347455 Time :  973
accuracy train: 0.989093 val: 0.954545 test: 0.963014
max validation accuracy : 0.970909 max acc epoch : 26 test accuracy : 0.963470
Counter({5: 3528, 0: 1431, 7: 937, 4: 643, 3: 614, 6: 274, 2: 169, 1: 95})

Epoch :  30 loss training:  25.3981243763119 Time :  1036
accuracy train: 0.993537 val: 0.961818 test: 0.957078
max validation accuracy : 0.970909 max acc epoch : 26 test accuracy : 0.963470
Counter({0: 3243, 3: 1556, 1: 991, 5: 626, 7: 536, 2: 354, 4: 280, 6: 105})

Epoch :  31 loss training:  22.768168287351727 Time :  1084
accuracy train: 0.991921 val: 0.954545 test: 0.954338
max validation accuracy : 0.970909 max acc epoch : 26 test accuracy : 0.963470
Counter({5: 3195, 0: 1484, 1: 1089, 6: 680, 3: 619, 4: 280, 7: 261, 2: 83})

Epoch :  32 loss training:  21.607440962456167 Time :  1162
accuracy train: 0.992325 val: 0.961818 test: 0.964840
max validation accuracy : 0.970909 max acc epoch : 26 test accuracy : 0.963470
Counter({3: 3627, 7: 1316, 0: 1283, 5: 523, 6: 418, 1: 260, 4: 177, 2: 87})

Epoch :  33 loss training:  20.760447477921844 Time :  1252
accuracy train: 0.992931 val: 0.949091 test: 0.961644
max validation accuracy : 0.970909 max acc epoch : 26 test accuracy : 0.963470
Counter({1: 3247, 0: 1500, 4: 1458, 7: 599, 5: 360, 6: 253, 2: 154, 3: 120})

Epoch :  34 loss training:  124.21708371862769 Time :  1343
accuracy train: 0.983842 val: 0.958182 test: 0.960274
max validation accuracy : 0.970909 max acc epoch : 26 test accuracy : 0.963470
Counter({0: 3156, 7: 1389, 1: 1389, 5: 710, 2: 395, 3: 335, 4: 231, 6: 86})

Epoch :  35 loss training:  33.10814740601927 Time :  1405
accuracy train: 0.987275 val: 0.960000 test: 0.961644
max validation accuracy : 0.970909 max acc epoch : 26 test accuracy : 0.963470
Counter({7: 4003, 2: 1611, 3: 953, 5: 491, 1: 207, 0: 178, 6: 125, 4: 123})

Epoch :  36 loss training:  34.96275158971548 Time :  1467
accuracy train: 0.990709 val: 0.956364 test: 0.961187
max validation accuracy : 0.970909 max acc epoch : 26 test accuracy : 0.963470
Counter({1: 3402, 5: 1218, 3: 1158, 4: 752, 2: 410, 0: 362, 6: 289, 7: 100})

Epoch :  37 loss training:  24.106435649096966 Time :  1512
accuracy train: 0.992527 val: 0.954545 test: 0.962100
max validation accuracy : 0.970909 max acc epoch : 26 test accuracy : 0.963470
Counter({7: 4343, 0: 1496, 5: 599, 4: 480, 2: 323, 1: 216, 3: 147, 6: 87})

========================================================================================================================================================================================================
max acc epoch :  26
max validation accuracy :  0.9709090909090909
test accuracy :  0.9634703196347032
last test_accuracy :  0.9621004566210045
========================================================================================================================================================================================================

date and time :  Sat Apr  3 17:23:20 2021
Namespace(batch_size=16, dataset='R8', debug=False, device=0, dropout=0.4, early_stop=10, epochs=400, filename='', hidden_dim=100, lda=False, lr=0.001, num_layers=4, num_mlp_layers=2, random_vec=False, seed=0, weight_decay=0)
device :  cuda:0
Counter({5: 1472, 2: 1266, 1: 1168, 7: 1131, 4: 1106, 6: 909, 3: 602, 0: 37})
HGNNModel(
  (word_embeddings): Embedding(8232, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=100, bias=True)
          (1): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
          (1): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
          (1): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
          (1): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
    (2): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
          (1): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
          (1): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=8, bias=True)
    (1): Linear(in_features=100, out_features=8, bias=True)
    (2): Linear(in_features=100, out_features=8, bias=True)
    (3): Linear(in_features=100, out_features=8, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (3): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
  )
  (graph_pool_layer): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (3): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  330.3967782482505 Time :  67
accuracy train: 0.899212 val: 0.890909 test: 0.911416
max validation accuracy : 0.890909 max acc epoch : 1 test accuracy : 0.911416
Counter({0: 2965, 6: 1433, 5: 1187, 2: 728, 3: 708, 7: 283, 1: 251, 4: 136})

Epoch :  2 loss training:  126.32571503520012 Time :  127
accuracy train: 0.915573 val: 0.910909 test: 0.912329
max validation accuracy : 0.910909 max acc epoch : 2 test accuracy : 0.912329
Counter({6: 3826, 0: 1383, 2: 1146, 7: 675, 3: 256, 5: 206, 1: 147, 4: 52})

Epoch :  3 loss training:  102.17921030521393 Time :  211
accuracy train: 0.939204 val: 0.910909 test: 0.929224
max validation accuracy : 0.910909 max acc epoch : 2 test accuracy : 0.912329
Counter({2: 2826, 1: 1635, 0: 965, 7: 731, 6: 720, 4: 337, 5: 318, 3: 159})

Epoch :  4 loss training:  97.14665991067886 Time :  271
accuracy train: 0.951525 val: 0.925455 test: 0.949772
max validation accuracy : 0.925455 max acc epoch : 4 test accuracy : 0.949772
Counter({7: 3043, 0: 1628, 5: 834, 3: 822, 6: 741, 1: 418, 4: 166, 2: 39})

Epoch :  5 loss training:  65.22842800151557 Time :  340
accuracy train: 0.965865 val: 0.950909 test: 0.950685
max validation accuracy : 0.950909 max acc epoch : 5 test accuracy : 0.950685
Counter({0: 3134, 2: 1784, 6: 1042, 3: 789, 1: 313, 4: 303, 5: 271, 7: 55})

Epoch :  6 loss training:  64.17295816540718 Time :  397
accuracy train: 0.965865 val: 0.940000 test: 0.955251
max validation accuracy : 0.950909 max acc epoch : 5 test accuracy : 0.950685
Counter({4: 2766, 1: 1318, 0: 1241, 5: 705, 3: 680, 7: 655, 2: 238, 6: 88})

Epoch :  7 loss training:  55.39500752091408 Time :  460
accuracy train: 0.968693 val: 0.943636 test: 0.957991
max validation accuracy : 0.950909 max acc epoch : 5 test accuracy : 0.950685
Counter({3: 3492, 6: 1475, 0: 1058, 5: 649, 7: 530, 2: 215, 1: 183, 4: 89})

Epoch :  8 loss training:  54.8828965947032 Time :  533
accuracy train: 0.974753 val: 0.952727 test: 0.963927
max validation accuracy : 0.952727 max acc epoch : 8 test accuracy : 0.963927
Counter({3: 3327, 5: 1234, 6: 1188, 0: 757, 2: 434, 1: 320, 7: 296, 4: 135})

Epoch :  9 loss training:  49.73987025022507 Time :  624
accuracy train: 0.975762 val: 0.945455 test: 0.957078
max validation accuracy : 0.952727 max acc epoch : 8 test accuracy : 0.963927
Counter({1: 3551, 5: 1409, 3: 1085, 6: 738, 7: 345, 4: 220, 0: 196, 2: 147})

Epoch :  10 loss training:  55.43385291285813 Time :  723
accuracy train: 0.967481 val: 0.947273 test: 0.960274
max validation accuracy : 0.952727 max acc epoch : 8 test accuracy : 0.963927
Counter({5: 3233, 1: 1627, 0: 1087, 2: 633, 3: 374, 7: 367, 4: 220, 6: 150})

Epoch :  11 loss training:  44.602333057671785 Time :  806
accuracy train: 0.970309 val: 0.940000 test: 0.958447
max validation accuracy : 0.952727 max acc epoch : 8 test accuracy : 0.963927
Counter({0: 2881, 4: 1512, 3: 1418, 7: 787, 6: 520, 5: 373, 1: 156, 2: 44})

Epoch :  12 loss training:  52.79023436456919 Time :  881
accuracy train: 0.981418 val: 0.943636 test: 0.960274
max validation accuracy : 0.952727 max acc epoch : 8 test accuracy : 0.963927
Counter({0: 3344, 4: 1524, 7: 1195, 5: 526, 2: 433, 1: 393, 6: 219, 3: 57})

Epoch :  13 loss training:  41.67527550458908 Time :  964
accuracy train: 0.982226 val: 0.943636 test: 0.962557
max validation accuracy : 0.952727 max acc epoch : 8 test accuracy : 0.963927
Counter({1: 3606, 5: 1550, 6: 961, 3: 527, 2: 469, 0: 255, 7: 219, 4: 104})

Epoch :  14 loss training:  43.37417183816433 Time :  1059
accuracy train: 0.982024 val: 0.952727 test: 0.959361
max validation accuracy : 0.952727 max acc epoch : 8 test accuracy : 0.963927
Counter({1: 3505, 2: 1963, 0: 735, 7: 502, 5: 448, 3: 388, 4: 86, 6: 64})

Epoch :  15 loss training:  44.32038373500109 Time :  1140
accuracy train: 0.980408 val: 0.954545 test: 0.954795
max validation accuracy : 0.954545 max acc epoch : 15 test accuracy : 0.954795
Counter({0: 3527, 4: 1631, 2: 894, 5: 738, 3: 457, 7: 262, 1: 134, 6: 48})

Epoch :  16 loss training:  30.384627477265894 Time :  1219
accuracy train: 0.988689 val: 0.958182 test: 0.962557
max validation accuracy : 0.958182 max acc epoch : 16 test accuracy : 0.962557
Counter({0: 3462, 7: 1643, 3: 986, 6: 635, 2: 546, 1: 254, 5: 120, 4: 45})

Epoch :  17 loss training:  25.7355212662369 Time :  1290
accuracy train: 0.986871 val: 0.954545 test: 0.962557
max validation accuracy : 0.958182 max acc epoch : 16 test accuracy : 0.962557
Counter({4: 3575, 0: 1666, 7: 1046, 6: 614, 1: 333, 2: 204, 5: 187, 3: 66})

Epoch :  18 loss training:  34.525855131447315 Time :  1356
accuracy train: 0.983438 val: 0.947273 test: 0.948858
max validation accuracy : 0.958182 max acc epoch : 16 test accuracy : 0.962557
Counter({3: 3056, 4: 1858, 1: 1050, 7: 497, 0: 495, 6: 465, 2: 148, 5: 122})

Epoch :  19 loss training:  44.53093742579222 Time :  1414
accuracy train: 0.981216 val: 0.941818 test: 0.966210
max validation accuracy : 0.958182 max acc epoch : 16 test accuracy : 0.962557
Counter({0: 3669, 2: 1460, 4: 914, 1: 666, 6: 320, 5: 259, 7: 251, 3: 152})

Epoch :  20 loss training:  35.63470512256026 Time :  1476
accuracy train: 0.984044 val: 0.954545 test: 0.942922
max validation accuracy : 0.958182 max acc epoch : 16 test accuracy : 0.962557
Counter({0: 3321, 5: 1584, 3: 928, 7: 669, 6: 512, 4: 331, 1: 239, 2: 107})

Epoch :  21 loss training:  30.66798555292189 Time :  1529
accuracy train: 0.991113 val: 0.956364 test: 0.956621
max validation accuracy : 0.958182 max acc epoch : 16 test accuracy : 0.962557
Counter({1: 3389, 3: 1438, 6: 972, 2: 605, 5: 467, 0: 324, 7: 318, 4: 178})

Epoch :  22 loss training:  28.74346388527192 Time :  1620
accuracy train: 0.989497 val: 0.950909 test: 0.954795
max validation accuracy : 0.958182 max acc epoch : 16 test accuracy : 0.962557
Counter({6: 3530, 0: 1627, 3: 776, 5: 764, 1: 379, 7: 273, 4: 213, 2: 129})

Epoch :  23 loss training:  21.052754716947675 Time :  1714
accuracy train: 0.990103 val: 0.960000 test: 0.963470
max validation accuracy : 0.960000 max acc epoch : 23 test accuracy : 0.963470
Counter({7: 3657, 4: 1421, 5: 822, 2: 733, 1: 443, 0: 304, 3: 225, 6: 86})

Epoch :  24 loss training:  28.31924588046968 Time :  1780
accuracy train: 0.991921 val: 0.952727 test: 0.961644
max validation accuracy : 0.960000 max acc epoch : 23 test accuracy : 0.963470
Counter({6: 3006, 1: 2111, 7: 835, 3: 586, 4: 556, 0: 322, 2: 178, 5: 97})

Epoch :  25 loss training:  24.7871820256114 Time :  1867
accuracy train: 0.991921 val: 0.958182 test: 0.963014
max validation accuracy : 0.960000 max acc epoch : 23 test accuracy : 0.963470
Counter({4: 3662, 5: 1128, 2: 841, 6: 809, 1: 660, 7: 336, 0: 157, 3: 98})

Epoch :  26 loss training:  22.666966630145907 Time :  1911
accuracy train: 0.990911 val: 0.950909 test: 0.962100
max validation accuracy : 0.960000 max acc epoch : 23 test accuracy : 0.963470
Counter({0: 3740, 4: 1293, 2: 975, 1: 559, 6: 414, 3: 266, 7: 241, 5: 203})

Epoch :  27 loss training:  23.78231748379767 Time :  1979
accuracy train: 0.992729 val: 0.965455 test: 0.963014
max validation accuracy : 0.965455 max acc epoch : 27 test accuracy : 0.963014
Counter({0: 3527, 7: 1311, 3: 1025, 5: 679, 1: 597, 6: 289, 4: 178, 2: 85})

Epoch :  28 loss training:  31.750984624028206 Time :  2015
accuracy train: 0.991921 val: 0.956364 test: 0.961644
max validation accuracy : 0.965455 max acc epoch : 27 test accuracy : 0.963014
Counter({0: 3857, 2: 1423, 6: 1117, 7: 462, 5: 301, 4: 230, 3: 181, 1: 120})

Epoch :  29 loss training:  23.040162371238694 Time :  2074
accuracy train: 0.994143 val: 0.958182 test: 0.963470
max validation accuracy : 0.965455 max acc epoch : 27 test accuracy : 0.963014
Counter({3: 4204, 1: 1185, 2: 761, 7: 469, 5: 349, 0: 331, 6: 226, 4: 166})

Epoch :  30 loss training:  19.21694368030876 Time :  2130
accuracy train: 0.989093 val: 0.954545 test: 0.956621
max validation accuracy : 0.965455 max acc epoch : 27 test accuracy : 0.963014
Counter({0: 3958, 7: 1282, 5: 847, 3: 815, 1: 373, 2: 232, 6: 147, 4: 37})

Epoch :  31 loss training:  22.451325507834554 Time :  2158
accuracy train: 0.994345 val: 0.960000 test: 0.962557
max validation accuracy : 0.965455 max acc epoch : 27 test accuracy : 0.963014
Counter({1: 4064, 2: 1651, 5: 530, 7: 486, 0: 376, 6: 320, 3: 194, 4: 70})

Epoch :  32 loss training:  19.64354963088408 Time :  2197
accuracy train: 0.993941 val: 0.956364 test: 0.964840
max validation accuracy : 0.965455 max acc epoch : 27 test accuracy : 0.963014
Counter({5: 3915, 0: 1747, 3: 573, 7: 469, 2: 464, 1: 346, 6: 151, 4: 26})

Epoch :  33 loss training:  16.64439645409584 Time :  2217
accuracy train: 0.995960 val: 0.960000 test: 0.960731
max validation accuracy : 0.965455 max acc epoch : 27 test accuracy : 0.963014
Counter({0: 3479, 2: 1605, 1: 1158, 3: 699, 6: 350, 4: 182, 7: 126, 5: 92})

Epoch :  34 loss training:  18.63398214802146 Time :  2237
accuracy train: 0.995758 val: 0.958182 test: 0.963014
max validation accuracy : 0.965455 max acc epoch : 27 test accuracy : 0.963014
Counter({1: 3432, 3: 1535, 0: 1138, 6: 552, 5: 449, 2: 327, 7: 143, 4: 115})

Epoch :  35 loss training:  21.15251155565784 Time :  2257
accuracy train: 0.994345 val: 0.954545 test: 0.958447
max validation accuracy : 0.965455 max acc epoch : 27 test accuracy : 0.963014
Counter({0: 3752, 3: 1300, 7: 1191, 1: 442, 6: 400, 5: 364, 2: 148, 4: 94})

Epoch :  36 loss training:  15.136365516489604 Time :  2283
accuracy train: 0.995152 val: 0.960000 test: 0.963014
max validation accuracy : 0.965455 max acc epoch : 27 test accuracy : 0.963014
Counter({7: 3777, 6: 1118, 5: 1029, 4: 619, 2: 431, 0: 366, 1: 227, 3: 124})

Epoch :  37 loss training:  16.324202174087986 Time :  2320
accuracy train: 0.995960 val: 0.949091 test: 0.961644
max validation accuracy : 0.965455 max acc epoch : 27 test accuracy : 0.963014
Counter({4: 3213, 5: 1327, 6: 1233, 0: 653, 1: 619, 2: 395, 3: 159, 7: 92})

Epoch :  38 loss training:  11.540855204104446 Time :  2346
accuracy train: 0.994951 val: 0.960000 test: 0.966210
max validation accuracy : 0.965455 max acc epoch : 27 test accuracy : 0.963014
Counter({5: 3269, 0: 1418, 7: 1081, 2: 638, 6: 491, 3: 448, 1: 219, 4: 127})

========================================================================================================================================================================================================
max acc epoch :  27
max validation accuracy :  0.9654545454545455
test accuracy :  0.963013698630137
last test_accuracy :  0.9662100456621004
========================================================================================================================================================================================================

date and time :  Sat Apr  3 18:02:56 2021
Namespace(batch_size=16, dataset='R8', debug=False, device=0, dropout=0.4, early_stop=10, epochs=400, filename='', hidden_dim=100, lda=False, lr=0.0005, num_layers=4, num_mlp_layers=2, random_vec=False, seed=0, weight_decay=0)
device :  cuda:0
Counter({5: 1472, 2: 1266, 1: 1168, 7: 1131, 4: 1106, 6: 909, 3: 602, 0: 37})
HGNNModel(
  (word_embeddings): Embedding(8232, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=100, bias=True)
          (1): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
          (1): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
          (1): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
          (1): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
    (2): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
          (1): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
          (1): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList(
          (0): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=8, bias=True)
    (1): Linear(in_features=100, out_features=8, bias=True)
    (2): Linear(in_features=100, out_features=8, bias=True)
    (3): Linear(in_features=100, out_features=8, bias=True)
  )
  (graph_pool_layer): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (3): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  433.7987280488014 Time :  49
accuracy train: 0.796405 val: 0.796364 test: 0.800913
max validation accuracy : 0.796364 max acc epoch : 1 test accuracy : 0.800913

Epoch :  2 loss training:  158.32506278157234 Time :  71
accuracy train: 0.889517 val: 0.881818 test: 0.913242
max validation accuracy : 0.881818 max acc epoch : 2 test accuracy : 0.913242

Epoch :  3 loss training:  109.737155854702 Time :  88
accuracy train: 0.928903 val: 0.927273 test: 0.934703
max validation accuracy : 0.927273 max acc epoch : 3 test accuracy : 0.934703

Epoch :  4 loss training:  93.30007990822196 Time :  107
accuracy train: 0.925672 val: 0.921818 test: 0.932877
max validation accuracy : 0.927273 max acc epoch : 3 test accuracy : 0.934703

Epoch :  5 loss training:  81.83135590981692 Time :  125
accuracy train: 0.944254 val: 0.923636 test: 0.941096
max validation accuracy : 0.927273 max acc epoch : 3 test accuracy : 0.934703

Epoch :  6 loss training:  73.12320178747177 Time :  143
accuracy train: 0.942638 val: 0.923636 test: 0.942466
max validation accuracy : 0.927273 max acc epoch : 3 test accuracy : 0.934703

Epoch :  7 loss training:  66.930151514709 Time :  157
accuracy train: 0.945062 val: 0.938182 test: 0.940639
max validation accuracy : 0.938182 max acc epoch : 7 test accuracy : 0.940639

Epoch :  8 loss training:  65.7331177778542 Time :  172
accuracy train: 0.957584 val: 0.943636 test: 0.945205
max validation accuracy : 0.943636 max acc epoch : 8 test accuracy : 0.945205

Epoch :  9 loss training:  57.837958936579525 Time :  185
accuracy train: 0.917592 val: 0.914545 test: 0.913699
max validation accuracy : 0.943636 max acc epoch : 8 test accuracy : 0.945205

Epoch :  10 loss training:  56.245023522526026 Time :  200
accuracy train: 0.914159 val: 0.912727 test: 0.906849
max validation accuracy : 0.943636 max acc epoch : 8 test accuracy : 0.945205

Epoch :  11 loss training:  55.23275515809655 Time :  215
accuracy train: 0.919208 val: 0.910909 test: 0.913699
max validation accuracy : 0.943636 max acc epoch : 8 test accuracy : 0.945205

Epoch :  12 loss training:  50.096557195764035 Time :  230
accuracy train: 0.938194 val: 0.920000 test: 0.929680
max validation accuracy : 0.943636 max acc epoch : 8 test accuracy : 0.945205

Epoch :  13 loss training:  53.06165351253003 Time :  245
accuracy train: 0.967481 val: 0.950909 test: 0.955708
max validation accuracy : 0.950909 max acc epoch : 13 test accuracy : 0.955708

Epoch :  14 loss training:  45.81643032748252 Time :  258
accuracy train: 0.957786 val: 0.943636 test: 0.937900
max validation accuracy : 0.950909 max acc epoch : 13 test accuracy : 0.955708

Epoch :  15 loss training:  41.003339018672705 Time :  270
accuracy train: 0.962028 val: 0.940000 test: 0.944292
max validation accuracy : 0.950909 max acc epoch : 13 test accuracy : 0.955708

Epoch :  16 loss training:  43.021347384899855 Time :  282
accuracy train: 0.969905 val: 0.947273 test: 0.954795
max validation accuracy : 0.950909 max acc epoch : 13 test accuracy : 0.955708

Epoch :  17 loss training:  37.39864582940936 Time :  294
accuracy train: 0.980610 val: 0.960000 test: 0.956164
max validation accuracy : 0.960000 max acc epoch : 17 test accuracy : 0.956164

Epoch :  18 loss training:  37.18433684390038 Time :  306
accuracy train: 0.958796 val: 0.938182 test: 0.953881
max validation accuracy : 0.960000 max acc epoch : 17 test accuracy : 0.956164

Epoch :  19 loss training:  35.43311190372333 Time :  317
accuracy train: 0.979600 val: 0.956364 test: 0.959817
max validation accuracy : 0.960000 max acc epoch : 17 test accuracy : 0.956164

Epoch :  20 loss training:  32.977826142683625 Time :  328
accuracy train: 0.979196 val: 0.949091 test: 0.959361
max validation accuracy : 0.960000 max acc epoch : 17 test accuracy : 0.956164

Epoch :  21 loss training:  36.474505458027124 Time :  341
accuracy train: 0.974349 val: 0.950909 test: 0.962100
max validation accuracy : 0.960000 max acc epoch : 17 test accuracy : 0.956164

Epoch :  22 loss training:  28.884217008948326 Time :  355
accuracy train: 0.977378 val: 0.954545 test: 0.951142
max validation accuracy : 0.960000 max acc epoch : 17 test accuracy : 0.956164

Epoch :  23 loss training:  31.50920583959669 Time :  373
accuracy train: 0.987275 val: 0.960000 test: 0.961187
max validation accuracy : 0.960000 max acc epoch : 17 test accuracy : 0.956164

Epoch :  24 loss training:  30.747864003060386 Time :  394
accuracy train: 0.988285 val: 0.960000 test: 0.960274
max validation accuracy : 0.960000 max acc epoch : 17 test accuracy : 0.956164

Epoch :  25 loss training:  26.20985250861122 Time :  413
accuracy train: 0.977378 val: 0.949091 test: 0.948402
max validation accuracy : 0.960000 max acc epoch : 17 test accuracy : 0.956164

Epoch :  26 loss training:  24.71514065284282 Time :  433
accuracy train: 0.972733 val: 0.950909 test: 0.952968
max validation accuracy : 0.960000 max acc epoch : 17 test accuracy : 0.956164

Epoch :  27 loss training:  23.366834985092282 Time :  449
accuracy train: 0.988083 val: 0.952727 test: 0.960274
max validation accuracy : 0.960000 max acc epoch : 17 test accuracy : 0.956164

Epoch :  28 loss training:  26.210238302097423 Time :  465
accuracy train: 0.988083 val: 0.954545 test: 0.958904
max validation accuracy : 0.960000 max acc epoch : 17 test accuracy : 0.956164

========================================================================================================================================================================================================
max acc epoch :  17
max validation accuracy :  0.96
test accuracy :  0.9561643835616438
last test_accuracy :  0.958904109589041
========================================================================================================================================================================================================

