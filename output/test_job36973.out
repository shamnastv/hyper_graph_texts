

date and time :  Wed Jun  9 21:29:52 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.5, early_stop=30, epochs=400, filename='', hidden_dim=300, lda=False, lr=0.001, num_Exp=5, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=877, weight_decay=0)
device :  cuda:0
min_len_of_sentence : 0
max_len_of_sentence : 448
min_num_of_sentence : 1
max_num_of_sentence : 43
average_len_of_sentence: 15.622783101633148
average_num_of_sentence: 4.816668833701729
Total_num_of_sentence : 37045
Counter({'earn': 3923, 'acq': 2292, 'crude': 374, 'trade': 326, 'money-fx': 309, 'interest': 272, 'ship': 144, 'grain': 51})
Total_number_of_words: 7097
Total_number_of_categories: 8
vocab size : 7097
got embeddings of : 6573
Counter({0: 4724, 1: 2967})

Epoch :  1 loss training:  45.263756331056356 Time :  166
accuracy train: 0.953747 val: 0.936364 test: 0.954795
max validation accuracy : 0.936364 max acc epoch : 1 test accuracy : 0.954795
Counter({0: 4018, 1: 3673})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  21.733283950015903 Time :  209
accuracy train: 0.948495 val: 0.938182 test: 0.955251
max validation accuracy : 0.938182 max acc epoch : 2 test accuracy : 0.955251
Counter({0: 4025, 1: 3666})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  22.03510664962232 Time :  248
accuracy train: 0.965462 val: 0.947273 test: 0.956164
max validation accuracy : 0.947273 max acc epoch : 3 test accuracy : 0.956164
Counter({1: 4030, 0: 3661})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  12.863882076460868 Time :  289
accuracy train: 0.974955 val: 0.970909 test: 0.969406
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.969406
Counter({1: 3967, 0: 3724})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  13.227273828350008 Time :  325
accuracy train: 0.975964 val: 0.969091 test: 0.962557
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.969406
Counter({0: 3900, 1: 3791})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  13.53050692891702 Time :  370
accuracy train: 0.980812 val: 0.963636 test: 0.962557
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.969406
Counter({1: 3916, 0: 3775})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  10.685226656729355 Time :  415
accuracy train: 0.979802 val: 0.967273 test: 0.972146
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.969406
Counter({1: 3926, 0: 3765})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  9.695591703755781 Time :  451
accuracy train: 0.978792 val: 0.974545 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.966667
Counter({0: 3917, 1: 3774})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  9.551495444495231 Time :  492
accuracy train: 0.984044 val: 0.969091 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.966667
Counter({0: 3911, 1: 3780})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  8.401133212260902 Time :  534
accuracy train: 0.985054 val: 0.967273 test: 0.965753
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.966667
Counter({0: 3910, 1: 3781})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  8.649919374845922 Time :  569
accuracy train: 0.987679 val: 0.972727 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.966667
Counter({1: 3902, 0: 3789})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  7.700164878857322 Time :  611
accuracy train: 0.985659 val: 0.965455 test: 0.966210
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.966667
Counter({1: 3897, 0: 3794})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  7.368689835071564 Time :  644
accuracy train: 0.989699 val: 0.974545 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.966667
Counter({1: 3887, 0: 3804})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  7.095528881298378 Time :  686
accuracy train: 0.989093 val: 0.978182 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.970320
Counter({0: 3884, 1: 3807})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  7.282499627559446 Time :  734
accuracy train: 0.987073 val: 0.976364 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.970320
Counter({0: 3885, 1: 3806})

Epoch :  16 loss training:  6.781577369431034 Time :  770
accuracy train: 0.990305 val: 0.974545 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.970320
Counter({1: 3880, 0: 3811})

Epoch :  17 loss training:  6.496698016650043 Time :  814
accuracy train: 0.987275 val: 0.980000 test: 0.975799
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.975799
Counter({1: 3878, 0: 3813})

Epoch :  18 loss training:  7.7025605322560295 Time :  857
accuracy train: 0.986871 val: 0.972727 test: 0.967123
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.975799
Counter({1: 3877, 0: 3814})

Epoch :  19 loss training:  7.298638703301549 Time :  896
accuracy train: 0.989497 val: 0.976364 test: 0.968037
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.975799
Counter({1: 3869, 0: 3822})

Epoch :  20 loss training:  6.262042848044075 Time :  939
accuracy train: 0.990507 val: 0.978182 test: 0.968037
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.975799
Counter({0: 3867, 1: 3824})

Epoch :  21 loss training:  6.428365698084235 Time :  983
accuracy train: 0.990709 val: 0.974545 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.975799
Counter({1: 3867, 0: 3824})

Epoch :  22 loss training:  6.25860511593055 Time :  1026
accuracy train: 0.990305 val: 0.981818 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({1: 3865, 0: 3826})

Epoch :  23 loss training:  6.152126745553687 Time :  1064
accuracy train: 0.991921 val: 0.978182 test: 0.968037
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({1: 3859, 0: 3832})

Epoch :  24 loss training:  6.039004567312077 Time :  1103
accuracy train: 0.991719 val: 0.974545 test: 0.967580
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({1: 3860, 0: 3831})

Epoch :  25 loss training:  6.153775344602764 Time :  1145
accuracy train: 0.990911 val: 0.976364 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({0: 3855, 1: 3836})

Epoch :  26 loss training:  6.539651919621974 Time :  1175
accuracy train: 0.992123 val: 0.976364 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({1: 3851, 0: 3840})

Epoch :  27 loss training:  5.665738789131865 Time :  1212
accuracy train: 0.993941 val: 0.978182 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({0: 3849, 1: 3842})

Epoch :  28 loss training:  5.331722672446631 Time :  1259
accuracy train: 0.992729 val: 0.976364 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({0: 3846, 1: 3845})

Epoch :  29 loss training:  5.10451519896742 Time :  1300
accuracy train: 0.993537 val: 0.976364 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({0: 3848, 1: 3843})

Epoch :  30 loss training:  5.317708645481616 Time :  1338
accuracy train: 0.993335 val: 0.978182 test: 0.968493
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({0: 3856, 1: 3835})

Epoch :  31 loss training:  4.441272048978135 Time :  1377
accuracy train: 0.991517 val: 0.980000 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({0: 3856, 1: 3835})

Epoch :  32 loss training:  4.835544525645673 Time :  1421
accuracy train: 0.993335 val: 0.978182 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({1: 3856, 0: 3835})

Epoch :  33 loss training:  5.006503876531497 Time :  1468
accuracy train: 0.994143 val: 0.981818 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({0: 3857, 1: 3834})

Epoch :  34 loss training:  4.510200249846093 Time :  1510
accuracy train: 0.994143 val: 0.976364 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({0: 3858, 1: 3833})

Epoch :  35 loss training:  4.91703079151921 Time :  1546
accuracy train: 0.994345 val: 0.980000 test: 0.968493
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({0: 3865, 1: 3826})

Epoch :  36 loss training:  4.214820979279466 Time :  1597
accuracy train: 0.994547 val: 0.980000 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({0: 3867, 1: 3824})

Epoch :  37 loss training:  4.119083845755085 Time :  1641
accuracy train: 0.994345 val: 0.978182 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({1: 3871, 0: 3820})

Epoch :  38 loss training:  4.570950933906715 Time :  1682
accuracy train: 0.994951 val: 0.976364 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({0: 3870, 1: 3821})

Epoch :  39 loss training:  4.3239270884078 Time :  1725
accuracy train: 0.993739 val: 0.978182 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({1: 3872, 0: 3819})

Epoch :  40 loss training:  4.9091272306395695 Time :  1773
accuracy train: 0.994143 val: 0.976364 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({0: 3872, 1: 3819})

Epoch :  41 loss training:  4.4127902429318056 Time :  1816
accuracy train: 0.995152 val: 0.976364 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({0: 3880, 1: 3811})

Epoch :  42 loss training:  3.9993497270625085 Time :  1861
accuracy train: 0.995758 val: 0.976364 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({0: 3884, 1: 3807})

Epoch :  43 loss training:  3.570640041027218 Time :  1903
accuracy train: 0.994345 val: 0.978182 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({1: 3885, 0: 3806})

Epoch :  44 loss training:  3.447978984506335 Time :  1937
accuracy train: 0.995556 val: 0.974545 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({1: 3887, 0: 3804})

Epoch :  45 loss training:  3.584420548460912 Time :  1983
accuracy train: 0.994951 val: 0.976364 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({1: 3889, 0: 3802})

Epoch :  46 loss training:  3.6345701053505763 Time :  2030
accuracy train: 0.994951 val: 0.972727 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({0: 3890, 1: 3801})

Epoch :  47 loss training:  3.221366325044073 Time :  2065
accuracy train: 0.995758 val: 0.974545 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({0: 3891, 1: 3800})

Epoch :  48 loss training:  3.2103203320293687 Time :  2106
accuracy train: 0.995354 val: 0.978182 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({0: 3894, 1: 3797})

Epoch :  49 loss training:  3.33381293353159 Time :  2151
accuracy train: 0.995152 val: 0.978182 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({1: 3897, 0: 3794})

Epoch :  50 loss training:  3.081952151871519 Time :  2200
accuracy train: 0.996162 val: 0.976364 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({0: 3899, 1: 3792})

Epoch :  51 loss training:  3.015963073063176 Time :  2245
accuracy train: 0.994749 val: 0.976364 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({1: 3901, 0: 3790})

Epoch :  52 loss training:  3.4886211347475182 Time :  2292
accuracy train: 0.994951 val: 0.974545 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({1: 3901, 0: 3790})

Epoch :  53 loss training:  3.029730624257354 Time :  2337
accuracy train: 0.995960 val: 0.972727 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 22 test accuracy : 0.969406
Counter({1: 3902, 0: 3789})

========================================================================================================================================================================================================
max acc epoch :  22
max validation accuracy :  0.9818181818181818
test accuracy :  0.9694063926940639
last test_accuracy :  0.9698630136986301
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.5, early_stop=30, epochs=400, filename='', hidden_dim=300, lda=False, lr=0.001, num_Exp=5, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=877, weight_decay=0)
device :  cuda:0
Counter({0: 4724, 1: 2967})

Epoch :  1 loss training:  45.3741420507431 Time :  2457
accuracy train: 0.952131 val: 0.932727 test: 0.954795
max validation accuracy : 0.932727 max acc epoch : 1 test accuracy : 0.954795
Counter({1: 4013, 0: 3678})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  22.031184567138553 Time :  2505
accuracy train: 0.953343 val: 0.947273 test: 0.953881
max validation accuracy : 0.947273 max acc epoch : 2 test accuracy : 0.953881
Counter({1: 4021, 0: 3670})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  22.207314076833427 Time :  2536
accuracy train: 0.959402 val: 0.945455 test: 0.956621
max validation accuracy : 0.947273 max acc epoch : 2 test accuracy : 0.953881
Counter({1: 4026, 0: 3665})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  13.269342687446624 Time :  2579
accuracy train: 0.969501 val: 0.958182 test: 0.967123
max validation accuracy : 0.958182 max acc epoch : 4 test accuracy : 0.967123
Counter({0: 3989, 1: 3702})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  13.371184757445008 Time :  2621
accuracy train: 0.978590 val: 0.970909 test: 0.962100
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.962100
Counter({0: 3941, 1: 3750})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  12.0814965441823 Time :  2652
accuracy train: 0.978186 val: 0.969091 test: 0.960731
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.962100
Counter({0: 3907, 1: 3784})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  9.830930880038068 Time :  2699
accuracy train: 0.978792 val: 0.972727 test: 0.969863
max validation accuracy : 0.972727 max acc epoch : 7 test accuracy : 0.969863
Counter({1: 3901, 0: 3790})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  9.44657127559185 Time :  2729
accuracy train: 0.982226 val: 0.974545 test: 0.966210
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.966210
Counter({0: 3892, 1: 3799})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  8.41040984611027 Time :  2773
accuracy train: 0.985659 val: 0.969091 test: 0.967123
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.966210
Counter({0: 3884, 1: 3807})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  7.873789742356166 Time :  2804
accuracy train: 0.987073 val: 0.970909 test: 0.963470
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.966210
Counter({0: 3875, 1: 3816})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  8.259787695249543 Time :  2845
accuracy train: 0.987477 val: 0.974545 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.966210
Counter({1: 3872, 0: 3819})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  8.285936307976954 Time :  2890
accuracy train: 0.986265 val: 0.963636 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.966210
Counter({1: 3871, 0: 3820})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  7.424056362360716 Time :  2924
accuracy train: 0.989093 val: 0.969091 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.966210
Counter({0: 3869, 1: 3822})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  7.702458418207243 Time :  2965
accuracy train: 0.988487 val: 0.974545 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.966210
Counter({0: 3867, 1: 3824})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  7.958079098723829 Time :  3002
accuracy train: 0.987679 val: 0.970909 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.966210
Counter({0: 3866, 1: 3825})

Epoch :  16 loss training:  6.77322630956769 Time :  3040
accuracy train: 0.990305 val: 0.969091 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.966210
Counter({1: 3862, 0: 3829})

Epoch :  17 loss training:  7.061863194219768 Time :  3084
accuracy train: 0.989093 val: 0.972727 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.966210
Counter({1: 3857, 0: 3834})

Epoch :  18 loss training:  6.797018452547491 Time :  3120
accuracy train: 0.988891 val: 0.969091 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.966210
Counter({1: 3854, 0: 3837})

Epoch :  19 loss training:  7.219437853898853 Time :  3158
accuracy train: 0.991315 val: 0.969091 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.966210
Counter({1: 3848, 0: 3843})

Epoch :  20 loss training:  6.222219675546512 Time :  3193
accuracy train: 0.990709 val: 0.976364 test: 0.968493
max validation accuracy : 0.976364 max acc epoch : 20 test accuracy : 0.968493
Counter({0: 3847, 1: 3844})

Epoch :  21 loss training:  5.948503858642653 Time :  3234
accuracy train: 0.990103 val: 0.976364 test: 0.968493
max validation accuracy : 0.976364 max acc epoch : 20 test accuracy : 0.968493
Counter({0: 3846, 1: 3845})

Epoch :  22 loss training:  5.917933203745633 Time :  3275
accuracy train: 0.988487 val: 0.972727 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 20 test accuracy : 0.968493
Counter({1: 3848, 0: 3843})

Epoch :  23 loss training:  5.77168054250069 Time :  3317
accuracy train: 0.992527 val: 0.978182 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.968493
Counter({0: 3850, 1: 3841})

Epoch :  24 loss training:  5.791583038400859 Time :  3351
accuracy train: 0.991517 val: 0.978182 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.968493
Counter({1: 3849, 0: 3842})

Epoch :  25 loss training:  5.597206255653873 Time :  3396
accuracy train: 0.990507 val: 0.970909 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.968493
Counter({0: 3848, 1: 3843})

Epoch :  26 loss training:  5.158538548042998 Time :  3439
accuracy train: 0.991921 val: 0.976364 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.968493
Counter({0: 3850, 1: 3841})

Epoch :  27 loss training:  5.513638658565469 Time :  3475
accuracy train: 0.993537 val: 0.976364 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.968493
Counter({0: 3851, 1: 3840})

Epoch :  28 loss training:  5.4617960716132075 Time :  3513
accuracy train: 0.991315 val: 0.976364 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.968493
Counter({1: 3850, 0: 3841})

Epoch :  29 loss training:  4.937640440650284 Time :  3548
accuracy train: 0.993133 val: 0.969091 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.968493
Counter({0: 3852, 1: 3839})

Epoch :  30 loss training:  5.404595321480883 Time :  3587
accuracy train: 0.992729 val: 0.972727 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.968493
Counter({0: 3852, 1: 3839})

Epoch :  31 loss training:  4.890634740237147 Time :  3623
accuracy train: 0.992325 val: 0.978182 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.968493
Counter({0: 3852, 1: 3839})

Epoch :  32 loss training:  4.428829297772609 Time :  3665
accuracy train: 0.993739 val: 0.969091 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.968493
Counter({0: 3852, 1: 3839})

Epoch :  33 loss training:  4.52526108751772 Time :  3701
accuracy train: 0.993739 val: 0.972727 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.968493
Counter({1: 3856, 0: 3835})

Epoch :  34 loss training:  4.700397374021122 Time :  3749
accuracy train: 0.993941 val: 0.974545 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.968493
Counter({1: 3863, 0: 3828})

Epoch :  35 loss training:  4.533536992908921 Time :  3794
accuracy train: 0.994345 val: 0.980000 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({0: 3866, 1: 3825})

Epoch :  36 loss training:  3.810803458443843 Time :  3829
accuracy train: 0.992325 val: 0.969091 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({1: 3870, 0: 3821})

Epoch :  37 loss training:  4.380295292241499 Time :  3873
accuracy train: 0.994143 val: 0.969091 test: 0.974886
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({0: 3871, 1: 3820})

Epoch :  38 loss training:  4.068707885046024 Time :  3909
accuracy train: 0.994547 val: 0.967273 test: 0.975342
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({1: 3876, 0: 3815})

Epoch :  39 loss training:  3.821334933047183 Time :  3956
accuracy train: 0.993941 val: 0.972727 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({1: 3879, 0: 3812})

Epoch :  40 loss training:  5.0648227233905345 Time :  3998
accuracy train: 0.993537 val: 0.969091 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({0: 3880, 1: 3811})

Epoch :  41 loss training:  4.7298614147584885 Time :  4033
accuracy train: 0.995152 val: 0.976364 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({1: 3883, 0: 3808})

Epoch :  42 loss training:  3.940894161351025 Time :  4075
accuracy train: 0.994749 val: 0.970909 test: 0.975342
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({0: 3884, 1: 3807})

Epoch :  43 loss training:  3.706204747897573 Time :  4107
accuracy train: 0.994345 val: 0.969091 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({1: 3882, 0: 3809})

Epoch :  44 loss training:  3.4925485004787333 Time :  4147
accuracy train: 0.994547 val: 0.969091 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({1: 3882, 0: 3809})

Epoch :  45 loss training:  3.2754367512534373 Time :  4187
accuracy train: 0.994951 val: 0.970909 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({1: 3883, 0: 3808})

Epoch :  46 loss training:  3.2751411806675605 Time :  4225
accuracy train: 0.995960 val: 0.970909 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({1: 3889, 0: 3802})

Epoch :  47 loss training:  3.4714954117080197 Time :  4272
accuracy train: 0.994951 val: 0.969091 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({1: 3892, 0: 3799})

Epoch :  48 loss training:  3.1873362955229823 Time :  4318
accuracy train: 0.995556 val: 0.976364 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({1: 3896, 0: 3795})

Epoch :  49 loss training:  3.6138976967777126 Time :  4353
accuracy train: 0.995354 val: 0.967273 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({1: 3900, 0: 3791})

Epoch :  50 loss training:  2.833369914267678 Time :  4401
accuracy train: 0.995960 val: 0.974545 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({0: 3900, 1: 3791})

Epoch :  51 loss training:  3.2886737380176783 Time :  4443
accuracy train: 0.994345 val: 0.969091 test: 0.967580
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({1: 3900, 0: 3791})

Epoch :  52 loss training:  3.512395545199979 Time :  4485
accuracy train: 0.994749 val: 0.970909 test: 0.968950
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({1: 3900, 0: 3791})

Epoch :  53 loss training:  3.0065261962008663 Time :  4524
accuracy train: 0.995556 val: 0.972727 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({1: 3903, 0: 3788})

Epoch :  54 loss training:  3.001942887509358 Time :  4563
accuracy train: 0.995758 val: 0.980000 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({1: 3904, 0: 3787})

Epoch :  55 loss training:  2.8802177839679644 Time :  4611
accuracy train: 0.995758 val: 0.969091 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({1: 3904, 0: 3787})

Epoch :  56 loss training:  2.5512734127114527 Time :  4650
accuracy train: 0.996162 val: 0.969091 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({0: 3905, 1: 3786})

Epoch :  57 loss training:  3.1928699964482803 Time :  4689
accuracy train: 0.995758 val: 0.965455 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({1: 3908, 0: 3783})

Epoch :  58 loss training:  3.2703234505315777 Time :  4728
accuracy train: 0.996162 val: 0.974545 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({1: 3908, 0: 3783})

Epoch :  59 loss training:  2.9305246789299417 Time :  4768
accuracy train: 0.995758 val: 0.970909 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({0: 3910, 1: 3781})

Epoch :  60 loss training:  2.7313338728272356 Time :  4818
accuracy train: 0.995758 val: 0.974545 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({1: 3910, 0: 3781})

Epoch :  61 loss training:  2.8556320535572013 Time :  4861
accuracy train: 0.995354 val: 0.974545 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({0: 3911, 1: 3780})

Epoch :  62 loss training:  2.8921794683410553 Time :  4896
accuracy train: 0.995960 val: 0.969091 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({0: 3914, 1: 3777})

Epoch :  63 loss training:  2.7223218982690014 Time :  4941
accuracy train: 0.996768 val: 0.969091 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({1: 3913, 0: 3778})

Epoch :  64 loss training:  2.5708781784342136 Time :  4982
accuracy train: 0.996768 val: 0.969091 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({1: 3915, 0: 3776})

Epoch :  65 loss training:  2.123571465956047 Time :  5019
accuracy train: 0.996566 val: 0.970909 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({0: 3915, 1: 3776})

Epoch :  66 loss training:  2.816987130412599 Time :  5060
accuracy train: 0.996768 val: 0.969091 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 35 test accuracy : 0.973973
Counter({0: 3915, 1: 3776})

========================================================================================================================================================================================================
max acc epoch :  35
max validation accuracy :  0.98
test accuracy :  0.9739726027397261
last test_accuracy :  0.9735159817351599
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.5, early_stop=30, epochs=400, filename='', hidden_dim=300, lda=False, lr=0.001, num_Exp=5, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=877, weight_decay=0)
device :  cuda:0
Counter({0: 4724, 1: 2967})

Epoch :  1 loss training:  45.41494608670473 Time :  5150
accuracy train: 0.957180 val: 0.941818 test: 0.953425
max validation accuracy : 0.941818 max acc epoch : 1 test accuracy : 0.953425
Counter({0: 4065, 1: 3626})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  21.489737633615732 Time :  5203
accuracy train: 0.942840 val: 0.934545 test: 0.956164
max validation accuracy : 0.941818 max acc epoch : 1 test accuracy : 0.953425
Counter({0: 4084, 1: 3607})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  21.62210160586983 Time :  5242
accuracy train: 0.963442 val: 0.956364 test: 0.957534
max validation accuracy : 0.956364 max acc epoch : 3 test accuracy : 0.957534
Counter({1: 4017, 0: 3674})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  13.307102129445411 Time :  5280
accuracy train: 0.970107 val: 0.960000 test: 0.965297
max validation accuracy : 0.960000 max acc epoch : 4 test accuracy : 0.965297
Counter({1: 3985, 0: 3706})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  13.161361187696457 Time :  5334
accuracy train: 0.977782 val: 0.965455 test: 0.958904
max validation accuracy : 0.965455 max acc epoch : 5 test accuracy : 0.958904
Counter({1: 3922, 0: 3769})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  12.26881460659206 Time :  5378
accuracy train: 0.981216 val: 0.970909 test: 0.963470
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.963470
Counter({0: 3939, 1: 3752})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  10.660807496868074 Time :  5423
accuracy train: 0.982226 val: 0.972727 test: 0.967580
max validation accuracy : 0.972727 max acc epoch : 7 test accuracy : 0.967580
Counter({1: 3939, 0: 3752})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  10.241554167121649 Time :  5465
accuracy train: 0.981418 val: 0.972727 test: 0.966210
max validation accuracy : 0.972727 max acc epoch : 7 test accuracy : 0.967580
Counter({1: 3931, 0: 3760})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  9.167329229414463 Time :  5511
accuracy train: 0.983438 val: 0.974545 test: 0.962557
max validation accuracy : 0.974545 max acc epoch : 9 test accuracy : 0.962557
Counter({0: 3895, 1: 3796})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  8.539352574851364 Time :  5544
accuracy train: 0.986467 val: 0.972727 test: 0.963014
max validation accuracy : 0.974545 max acc epoch : 9 test accuracy : 0.962557
Counter({0: 3896, 1: 3795})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  8.20390047505498 Time :  5583
accuracy train: 0.987275 val: 0.972727 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 9 test accuracy : 0.962557
Counter({1: 3893, 0: 3798})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  8.081636459799483 Time :  5626
accuracy train: 0.985861 val: 0.969091 test: 0.964384
max validation accuracy : 0.974545 max acc epoch : 9 test accuracy : 0.962557
Counter({1: 3887, 0: 3804})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  7.1557223135605454 Time :  5657
accuracy train: 0.989295 val: 0.978182 test: 0.965753
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.965753
Counter({0: 3881, 1: 3810})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  7.915232105879113 Time :  5700
accuracy train: 0.988285 val: 0.972727 test: 0.965753
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.965753
Counter({0: 3880, 1: 3811})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  7.4544147931737825 Time :  5735
accuracy train: 0.988689 val: 0.970909 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.965753
Counter({1: 3881, 0: 3810})

Epoch :  16 loss training:  6.842397533357143 Time :  5778
accuracy train: 0.989901 val: 0.976364 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.965753
Counter({1: 3878, 0: 3813})

Epoch :  17 loss training:  7.1137331096688285 Time :  5816
accuracy train: 0.989093 val: 0.972727 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.965753
Counter({1: 3873, 0: 3818})

Epoch :  18 loss training:  7.2926330477930605 Time :  5855
accuracy train: 0.988891 val: 0.972727 test: 0.966210
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.965753
Counter({0: 3872, 1: 3819})

Epoch :  19 loss training:  6.413229767698795 Time :  5891
accuracy train: 0.989295 val: 0.970909 test: 0.961187
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.965753
Counter({1: 3855, 0: 3836})

Epoch :  20 loss training:  6.24241211626213 Time :  5927
accuracy train: 0.991517 val: 0.972727 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.965753
Counter({0: 3851, 1: 3840})

Epoch :  21 loss training:  6.508182934485376 Time :  5973
accuracy train: 0.990911 val: 0.972727 test: 0.966210
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.965753
Counter({1: 3850, 0: 3841})

Epoch :  22 loss training:  5.865930383326486 Time :  6015
accuracy train: 0.989699 val: 0.969091 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.965753
Counter({1: 3850, 0: 3841})

Epoch :  23 loss training:  6.106296107638627 Time :  6049
accuracy train: 0.991517 val: 0.976364 test: 0.966210
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.965753
Counter({1: 3846, 0: 3845})

Epoch :  24 loss training:  5.504630458308384 Time :  6094
accuracy train: 0.991517 val: 0.972727 test: 0.965753
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.965753
Counter({0: 3847, 1: 3844})

Epoch :  25 loss training:  5.700696432031691 Time :  6135
accuracy train: 0.991719 val: 0.965455 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.965753
Counter({0: 3850, 1: 3841})

Epoch :  26 loss training:  5.615698326844722 Time :  6172
accuracy train: 0.991719 val: 0.970909 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.965753
Counter({1: 3849, 0: 3842})

Epoch :  27 loss training:  5.216285805450752 Time :  6219
accuracy train: 0.992931 val: 0.974545 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.965753
Counter({0: 3847, 1: 3844})

Epoch :  28 loss training:  5.098376891342923 Time :  6253
accuracy train: 0.993335 val: 0.970909 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.965753
Counter({0: 3848, 1: 3843})

slurmstepd: error: *** JOB 36973 ON cl-gpusrv1 CANCELLED AT 2021-06-09T23:15:10 ***
