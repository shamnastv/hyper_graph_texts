date and time :  Wed Apr 21 09:56:10 2021
Namespace(batch_size=32, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=0)
device :  cuda:0
min_len_of_sentence : 0
max_len_of_sentence : 241
min_num_of_sentence : 2
max_num_of_sentence : 25
average_len_of_sentence: 14.536844939264844
average_num_of_sentence: 8.532837837837837
Total_num_of_sentence : 63143
Counter({'C14': 1175, 'C04': 1030, 'C23': 796, 'C10': 557, 'C21': 553, 'C20': 410, 'C06': 354, 'C12': 342, 'C18': 323, 'C08': 250, 'C17': 233, 'C05': 223, 'C01': 216, 'C13': 195, 'C15': 133, 'C16': 129, 'C11': 125, 'C19': 86, 'C02': 75, 'C07': 63, 'C09': 63, 'C03': 50, 'C22': 19})
Total_number_of_words: 12909
Total_number_of_categories: 23
vocab size : 12909
got embeddings of : 12169

Epoch :  1 loss training:  431.8070492744446 Time :  72
accuracy train: 0.664130 val: 0.647761 test: 0.631214
max validation accuracy : 0.647761 max acc epoch : 1 test accuracy : 0.631214

Epoch :  2 loss training:  282.576402425766 Time :  82
accuracy train: 0.722038 val: 0.701493 test: 0.651991
max validation accuracy : 0.701493 max acc epoch : 2 test accuracy : 0.651991

Epoch :  3 loss training:  243.6938355565071 Time :  92
accuracy train: 0.761747 val: 0.707463 test: 0.670789
max validation accuracy : 0.707463 max acc epoch : 3 test accuracy : 0.670789

Epoch :  4 loss training:  202.89818906784058 Time :  103
accuracy train: 0.803111 val: 0.716418 test: 0.691071
max validation accuracy : 0.716418 max acc epoch : 4 test accuracy : 0.691071

Epoch :  5 loss training:  182.4294809103012 Time :  113
accuracy train: 0.825943 val: 0.728358 test: 0.697255
max validation accuracy : 0.728358 max acc epoch : 5 test accuracy : 0.697255

Epoch :  6 loss training:  173.41774678230286 Time :  123
accuracy train: 0.835208 val: 0.728358 test: 0.697007
max validation accuracy : 0.728358 max acc epoch : 5 test accuracy : 0.697255

Epoch :  7 loss training:  153.6411828994751 Time :  133
accuracy train: 0.862012 val: 0.716418 test: 0.706653
max validation accuracy : 0.728358 max acc epoch : 5 test accuracy : 0.697255

Epoch :  8 loss training:  141.61289036273956 Time :  143
accuracy train: 0.879550 val: 0.728358 test: 0.706159
max validation accuracy : 0.728358 max acc epoch : 5 test accuracy : 0.697255

Epoch :  9 loss training:  138.36286532878876 Time :  153
accuracy train: 0.890139 val: 0.734328 test: 0.708138
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.708138

Epoch :  10 loss training:  130.48179885745049 Time :  164
accuracy train: 0.889808 val: 0.731343 test: 0.709127
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.708138

Epoch :  11 loss training:  119.76716685295105 Time :  174
accuracy train: 0.902383 val: 0.725373 test: 0.713084
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.708138

Epoch :  12 loss training:  121.94339019060135 Time :  184
accuracy train: 0.908008 val: 0.731343 test: 0.710364
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.708138

Epoch :  13 loss training:  111.58976745605469 Time :  194
accuracy train: 0.910986 val: 0.734328 test: 0.715805
max validation accuracy : 0.734328 max acc epoch : 9 test accuracy : 0.708138

Epoch :  14 loss training:  112.46658229827881 Time :  205
accuracy train: 0.914626 val: 0.737313 test: 0.713826
max validation accuracy : 0.737313 max acc epoch : 14 test accuracy : 0.713826

Epoch :  15 loss training:  107.88579326868057 Time :  215
accuracy train: 0.919921 val: 0.740299 test: 0.715310
max validation accuracy : 0.740299 max acc epoch : 15 test accuracy : 0.715310

Epoch :  16 loss training:  108.55627453327179 Time :  225
accuracy train: 0.916942 val: 0.737313 test: 0.715063
max validation accuracy : 0.740299 max acc epoch : 15 test accuracy : 0.715310

Epoch :  17 loss training:  103.36518573760986 Time :  235
accuracy train: 0.917935 val: 0.719403 test: 0.715063
max validation accuracy : 0.740299 max acc epoch : 15 test accuracy : 0.715310

Epoch :  18 loss training:  104.24532735347748 Time :  245
accuracy train: 0.921244 val: 0.743284 test: 0.713084
max validation accuracy : 0.743284 max acc epoch : 18 test accuracy : 0.713084

Epoch :  19 loss training:  104.91843223571777 Time :  256
accuracy train: 0.922568 val: 0.746269 test: 0.713332
max validation accuracy : 0.746269 max acc epoch : 19 test accuracy : 0.713332

Epoch :  20 loss training:  103.42125478386879 Time :  267
accuracy train: 0.924222 val: 0.737313 test: 0.715558
max validation accuracy : 0.746269 max acc epoch : 19 test accuracy : 0.713332

Epoch :  21 loss training:  104.38343614339828 Time :  278
accuracy train: 0.923561 val: 0.734328 test: 0.712342
max validation accuracy : 0.746269 max acc epoch : 19 test accuracy : 0.713332

Epoch :  22 loss training:  102.87323951721191 Time :  290
accuracy train: 0.922237 val: 0.728358 test: 0.715063
max validation accuracy : 0.746269 max acc epoch : 19 test accuracy : 0.713332

Epoch :  23 loss training:  103.81566965579987 Time :  301
accuracy train: 0.925215 val: 0.737313 test: 0.709622
max validation accuracy : 0.746269 max acc epoch : 19 test accuracy : 0.713332

Epoch :  24 loss training:  102.9737828373909 Time :  311
accuracy train: 0.929517 val: 0.734328 test: 0.712342
max validation accuracy : 0.746269 max acc epoch : 19 test accuracy : 0.713332

Epoch :  25 loss training:  102.31628657877445 Time :  322
accuracy train: 0.926870 val: 0.746269 test: 0.715805
max validation accuracy : 0.746269 max acc epoch : 19 test accuracy : 0.713332

Epoch :  26 loss training:  103.501570135355 Time :  332
accuracy train: 0.928193 val: 0.740299 test: 0.713826
max validation accuracy : 0.746269 max acc epoch : 19 test accuracy : 0.713332

Epoch :  27 loss training:  101.74577328562737 Time :  342
accuracy train: 0.929848 val: 0.740299 test: 0.715558
max validation accuracy : 0.746269 max acc epoch : 19 test accuracy : 0.713332

Epoch :  28 loss training:  101.92543438076973 Time :  352
accuracy train: 0.925215 val: 0.746269 test: 0.716052
max validation accuracy : 0.746269 max acc epoch : 19 test accuracy : 0.713332

Epoch :  29 loss training:  99.52659657597542 Time :  362
accuracy train: 0.932826 val: 0.746269 test: 0.711353
max validation accuracy : 0.746269 max acc epoch : 19 test accuracy : 0.713332

Epoch :  30 loss training:  99.56721323728561 Time :  372
accuracy train: 0.932164 val: 0.728358 test: 0.715805
max validation accuracy : 0.746269 max acc epoch : 19 test accuracy : 0.713332

Epoch :  31 loss training:  98.69903376698494 Time :  383
accuracy train: 0.929848 val: 0.734328 test: 0.710858
max validation accuracy : 0.746269 max acc epoch : 19 test accuracy : 0.713332

Epoch :  32 loss training:  99.0556212067604 Time :  393
accuracy train: 0.932164 val: 0.740299 test: 0.719515
max validation accuracy : 0.746269 max acc epoch : 19 test accuracy : 0.713332

Epoch :  33 loss training:  100.53825131058693 Time :  404
accuracy train: 0.931171 val: 0.737313 test: 0.712837
max validation accuracy : 0.746269 max acc epoch : 19 test accuracy : 0.713332

Epoch :  34 loss training:  100.4085837751627 Time :  415
accuracy train: 0.931833 val: 0.740299 test: 0.713332
max validation accuracy : 0.746269 max acc epoch : 19 test accuracy : 0.713332

Epoch :  35 loss training:  99.47762987017632 Time :  426
accuracy train: 0.932495 val: 0.728358 test: 0.713826
max validation accuracy : 0.746269 max acc epoch : 19 test accuracy : 0.713332

Epoch :  36 loss training:  97.37362086772919 Time :  436
accuracy train: 0.933488 val: 0.737313 test: 0.713579
max validation accuracy : 0.746269 max acc epoch : 19 test accuracy : 0.713332

Epoch :  37 loss training:  99.61836841702461 Time :  446
accuracy train: 0.935473 val: 0.737313 test: 0.714321
max validation accuracy : 0.746269 max acc epoch : 19 test accuracy : 0.713332

Epoch :  38 loss training:  99.0517648756504 Time :  457
accuracy train: 0.935142 val: 0.728358 test: 0.715063
max validation accuracy : 0.746269 max acc epoch : 19 test accuracy : 0.713332

Epoch :  39 loss training:  98.62696915864944 Time :  467
accuracy train: 0.937128 val: 0.737313 test: 0.714568
max validation accuracy : 0.746269 max acc epoch : 19 test accuracy : 0.713332

Epoch :  40 loss training:  92.84788671135902 Time :  477
accuracy train: 0.935473 val: 0.749254 test: 0.716794
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  41 loss training:  97.1535752415657 Time :  487
accuracy train: 0.937790 val: 0.746269 test: 0.718279
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  42 loss training:  96.47283577919006 Time :  498
accuracy train: 0.936466 val: 0.740299 test: 0.713332
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  43 loss training:  99.6852496266365 Time :  508
accuracy train: 0.942753 val: 0.740299 test: 0.714568
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  44 loss training:  96.3555922806263 Time :  520
accuracy train: 0.935804 val: 0.722388 test: 0.714816
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  45 loss training:  92.03031104803085 Time :  531
accuracy train: 0.937790 val: 0.740299 test: 0.717784
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  46 loss training:  93.46889400482178 Time :  541
accuracy train: 0.939775 val: 0.740299 test: 0.714074
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  47 loss training:  92.23869186639786 Time :  552
accuracy train: 0.940768 val: 0.731343 test: 0.713826
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  48 loss training:  93.48984962701797 Time :  562
accuracy train: 0.942091 val: 0.734328 test: 0.715063
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  49 loss training:  92.93268030881882 Time :  572
accuracy train: 0.941430 val: 0.740299 test: 0.717784
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  50 loss training:  92.86662417650223 Time :  582
accuracy train: 0.944739 val: 0.740299 test: 0.713826
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  51 loss training:  94.46283185482025 Time :  592
accuracy train: 0.946062 val: 0.725373 test: 0.712342
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  52 loss training:  93.30175033211708 Time :  602
accuracy train: 0.945400 val: 0.731343 test: 0.713084
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  53 loss training:  94.19793087244034 Time :  612
accuracy train: 0.947717 val: 0.734328 test: 0.710611
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  54 loss training:  91.25391566753387 Time :  623
accuracy train: 0.945069 val: 0.743284 test: 0.713332
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  55 loss training:  90.92949593067169 Time :  633
accuracy train: 0.946724 val: 0.728358 test: 0.714816
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  56 loss training:  90.3088931441307 Time :  643
accuracy train: 0.946724 val: 0.746269 test: 0.713579
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  57 loss training:  92.22171124815941 Time :  653
accuracy train: 0.947055 val: 0.740299 test: 0.719763
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  58 loss training:  86.87176629900932 Time :  663
accuracy train: 0.945400 val: 0.728358 test: 0.716794
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  59 loss training:  91.75448060035706 Time :  674
accuracy train: 0.950364 val: 0.746269 test: 0.713826
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  60 loss training:  88.82397702336311 Time :  684
accuracy train: 0.947717 val: 0.728358 test: 0.714816
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  61 loss training:  90.81969901919365 Time :  694
accuracy train: 0.945731 val: 0.740299 test: 0.716794
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  62 loss training:  90.16131767630577 Time :  704
accuracy train: 0.951357 val: 0.728358 test: 0.717536
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  63 loss training:  87.58022665977478 Time :  714
accuracy train: 0.950033 val: 0.737313 test: 0.717536
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  64 loss training:  85.44827485084534 Time :  724
accuracy train: 0.949040 val: 0.740299 test: 0.713579
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  65 loss training:  84.63591930270195 Time :  734
accuracy train: 0.951026 val: 0.743284 test: 0.715805
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  66 loss training:  90.45113527774811 Time :  744
accuracy train: 0.953011 val: 0.740299 test: 0.715310
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  67 loss training:  89.09908571839333 Time :  755
accuracy train: 0.952019 val: 0.725373 test: 0.711848
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  68 loss training:  86.52219548821449 Time :  765
accuracy train: 0.955328 val: 0.734328 test: 0.714074
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  69 loss training:  87.65154194831848 Time :  775
accuracy train: 0.953342 val: 0.725373 test: 0.712590
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  70 loss training:  85.33640098571777 Time :  785
accuracy train: 0.954004 val: 0.737313 test: 0.713826
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

Epoch :  71 loss training:  86.71757659316063 Time :  796
accuracy train: 0.954666 val: 0.743284 test: 0.714816
max validation accuracy : 0.749254 max acc epoch : 40 test accuracy : 0.716794

========================================================================================================================================================================================================
max acc epoch :  40
max validation accuracy :  0.7492537313432835
test accuracy :  0.7167944595597329
last test_accuracy :  0.7148157308929013
========================================================================================================================================================================================================

date and time :  Wed Apr 21 10:09:36 2021
Namespace(batch_size=32, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=True, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=0)
device :  cuda:0
min_len_of_sentence : 0
max_len_of_sentence : 241
min_num_of_sentence : 2
max_num_of_sentence : 25
average_len_of_sentence: 14.536844939264844
average_num_of_sentence: 8.532837837837837
Total_num_of_sentence : 63143
Counter({'C14': 1175, 'C04': 1030, 'C23': 796, 'C10': 557, 'C21': 553, 'C20': 410, 'C06': 354, 'C12': 342, 'C18': 323, 'C08': 250, 'C17': 233, 'C05': 223, 'C01': 216, 'C13': 195, 'C15': 133, 'C16': 129, 'C11': 125, 'C19': 86, 'C02': 75, 'C07': 63, 'C09': 63, 'C03': 50, 'C22': 19})
Total_number_of_words: 12909
Total_number_of_categories: 23
vocab size : 12909
got embeddings of : 12169

Epoch :  1 loss training:  428.0399491786957 Time :  74
accuracy train: 0.670086 val: 0.647761 test: 0.632698
max validation accuracy : 0.647761 max acc epoch : 1 test accuracy : 0.632698

Epoch :  2 loss training:  278.5560986995697 Time :  85
accuracy train: 0.729980 val: 0.716418 test: 0.662874
max validation accuracy : 0.716418 max acc epoch : 2 test accuracy : 0.662874

Epoch :  3 loss training:  239.23896038532257 Time :  96
accuracy train: 0.760754 val: 0.737313 test: 0.668068
max validation accuracy : 0.737313 max acc epoch : 3 test accuracy : 0.668068

Epoch :  4 loss training:  199.03726816177368 Time :  107
accuracy train: 0.807081 val: 0.719403 test: 0.694039
max validation accuracy : 0.737313 max acc epoch : 3 test accuracy : 0.668068

Epoch :  5 loss training:  181.39692550897598 Time :  117
accuracy train: 0.829914 val: 0.761194 test: 0.703438
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  6 loss training:  170.39659237861633 Time :  128
accuracy train: 0.847783 val: 0.740299 test: 0.703933
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  7 loss training:  150.2607901096344 Time :  139
accuracy train: 0.862343 val: 0.734328 test: 0.707643
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  8 loss training:  148.41729772090912 Time :  151
accuracy train: 0.877565 val: 0.743284 test: 0.707148
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  9 loss training:  137.77695178985596 Time :  162
accuracy train: 0.889146 val: 0.746269 test: 0.712590
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  10 loss training:  129.3712198138237 Time :  173
accuracy train: 0.889146 val: 0.752239 test: 0.713826
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  11 loss training:  119.75298911333084 Time :  184
accuracy train: 0.897419 val: 0.740299 test: 0.712095
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  12 loss training:  120.76838690042496 Time :  195
accuracy train: 0.904699 val: 0.749254 test: 0.710116
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  13 loss training:  115.70007538795471 Time :  206
accuracy train: 0.902052 val: 0.752239 test: 0.714074
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  14 loss training:  115.23154124617577 Time :  217
accuracy train: 0.909001 val: 0.755224 test: 0.714321
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  15 loss training:  111.035839676857 Time :  228
accuracy train: 0.916281 val: 0.749254 test: 0.717536
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  16 loss training:  106.98564910888672 Time :  239
accuracy train: 0.914295 val: 0.755224 test: 0.716052
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  17 loss training:  103.62506228685379 Time :  250
accuracy train: 0.913964 val: 0.740299 test: 0.713826
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  18 loss training:  104.31494662165642 Time :  261
accuracy train: 0.912972 val: 0.740299 test: 0.714568
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  19 loss training:  107.05857855081558 Time :  272
accuracy train: 0.918928 val: 0.752239 test: 0.716052
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  20 loss training:  107.35931950807571 Time :  283
accuracy train: 0.921244 val: 0.743284 test: 0.714816
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  21 loss training:  106.05158424377441 Time :  294
accuracy train: 0.916942 val: 0.746269 test: 0.716300
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  22 loss training:  109.66007155179977 Time :  305
accuracy train: 0.918597 val: 0.737313 test: 0.719268
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  23 loss training:  103.59678143262863 Time :  316
accuracy train: 0.919921 val: 0.746269 test: 0.715805
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  24 loss training:  104.10387444496155 Time :  326
accuracy train: 0.921575 val: 0.740299 test: 0.716794
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  25 loss training:  104.01422470808029 Time :  337
accuracy train: 0.923891 val: 0.743284 test: 0.715063
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  26 loss training:  105.58034858107567 Time :  349
accuracy train: 0.925215 val: 0.749254 test: 0.717042
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  27 loss training:  101.27037954330444 Time :  360
accuracy train: 0.923230 val: 0.743284 test: 0.719515
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  28 loss training:  101.57477688789368 Time :  372
accuracy train: 0.924884 val: 0.740299 test: 0.713084
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  29 loss training:  104.23258271813393 Time :  383
accuracy train: 0.926870 val: 0.743284 test: 0.715063
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  30 loss training:  98.23741966485977 Time :  394
accuracy train: 0.925877 val: 0.752239 test: 0.717784
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  31 loss training:  99.79653599858284 Time :  405
accuracy train: 0.925215 val: 0.734328 test: 0.711600
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  32 loss training:  99.48116385936737 Time :  416
accuracy train: 0.926539 val: 0.737313 test: 0.717536
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  33 loss training:  101.13596647977829 Time :  427
accuracy train: 0.930841 val: 0.743284 test: 0.716794
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  34 loss training:  96.43970343470573 Time :  438
accuracy train: 0.932164 val: 0.746269 test: 0.719268
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  35 loss training:  98.62058436870575 Time :  448
accuracy train: 0.927531 val: 0.749254 test: 0.715063
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

Epoch :  36 loss training:  100.69293522834778 Time :  459
accuracy train: 0.928193 val: 0.746269 test: 0.718526
max validation accuracy : 0.761194 max acc epoch : 5 test accuracy : 0.703438

========================================================================================================================================================================================================
max acc epoch :  5
max validation accuracy :  0.7611940298507462
test accuracy :  0.7034380410586198
last test_accuracy :  0.7185258471432104
========================================================================================================================================================================================================

date and time :  Wed Apr 21 10:17:26 2021
Namespace(batch_size=32, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=True, seed=0, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  589.9577467441559 Time :  11
accuracy train: 0.412972 val: 0.408955 test: 0.369280
max validation accuracy : 0.408955 max acc epoch : 1 test accuracy : 0.369280

Epoch :  2 loss training:  465.1478431224823 Time :  22
accuracy train: 0.577432 val: 0.504478 test: 0.451397
max validation accuracy : 0.504478 max acc epoch : 2 test accuracy : 0.451397

Epoch :  3 loss training:  382.0447051525116 Time :  33
accuracy train: 0.699206 val: 0.579104 test: 0.503092
max validation accuracy : 0.579104 max acc epoch : 3 test accuracy : 0.503092

Epoch :  4 loss training:  297.49705159664154 Time :  44
accuracy train: 0.776638 val: 0.614925 test: 0.527826
max validation accuracy : 0.614925 max acc epoch : 4 test accuracy : 0.527826

Epoch :  5 loss training:  253.8368673324585 Time :  56
accuracy train: 0.833554 val: 0.602985 test: 0.524858
max validation accuracy : 0.614925 max acc epoch : 4 test accuracy : 0.527826

Epoch :  6 loss training:  228.03702008724213 Time :  68
accuracy train: 0.870615 val: 0.620896 test: 0.542419
max validation accuracy : 0.620896 max acc epoch : 6 test accuracy : 0.542419

Epoch :  7 loss training:  186.98878872394562 Time :  79
accuracy train: 0.889477 val: 0.647761 test: 0.548603
max validation accuracy : 0.647761 max acc epoch : 7 test accuracy : 0.548603

Epoch :  8 loss training:  171.77079713344574 Time :  90
accuracy train: 0.909993 val: 0.623881 test: 0.554539
max validation accuracy : 0.647761 max acc epoch : 7 test accuracy : 0.548603

Epoch :  9 loss training:  158.370168030262 Time :  102
accuracy train: 0.926208 val: 0.635821 test: 0.559486
max validation accuracy : 0.647761 max acc epoch : 7 test accuracy : 0.548603

Epoch :  10 loss training:  145.61085605621338 Time :  113
accuracy train: 0.938451 val: 0.638806 test: 0.561217
max validation accuracy : 0.647761 max acc epoch : 7 test accuracy : 0.548603

Epoch :  11 loss training:  137.1915585398674 Time :  124
accuracy train: 0.941760 val: 0.644776 test: 0.566164
max validation accuracy : 0.647761 max acc epoch : 7 test accuracy : 0.548603

Epoch :  12 loss training:  131.42688009142876 Time :  135
accuracy train: 0.946724 val: 0.635821 test: 0.565174
max validation accuracy : 0.647761 max acc epoch : 7 test accuracy : 0.548603

Epoch :  13 loss training:  122.67297667264938 Time :  146
accuracy train: 0.947717 val: 0.638806 test: 0.566164
max validation accuracy : 0.647761 max acc epoch : 7 test accuracy : 0.548603

Epoch :  14 loss training:  117.14455199241638 Time :  157
accuracy train: 0.949702 val: 0.638806 test: 0.566411
max validation accuracy : 0.647761 max acc epoch : 7 test accuracy : 0.548603

Epoch :  15 loss training:  119.23312711715698 Time :  168
accuracy train: 0.956320 val: 0.647761 test: 0.566164
max validation accuracy : 0.647761 max acc epoch : 7 test accuracy : 0.548603

Epoch :  16 loss training:  112.08185142278671 Time :  180
accuracy train: 0.955328 val: 0.644776 test: 0.569132
max validation accuracy : 0.647761 max acc epoch : 7 test accuracy : 0.548603

Epoch :  17 loss training:  109.58505499362946 Time :  191
accuracy train: 0.954335 val: 0.635821 test: 0.567895
max validation accuracy : 0.647761 max acc epoch : 7 test accuracy : 0.548603

Epoch :  18 loss training:  109.46064341068268 Time :  202
accuracy train: 0.956651 val: 0.644776 test: 0.567895
max validation accuracy : 0.647761 max acc epoch : 7 test accuracy : 0.548603

Epoch :  19 loss training:  109.35053032636642 Time :  213
accuracy train: 0.959960 val: 0.635821 test: 0.565669
max validation accuracy : 0.647761 max acc epoch : 7 test accuracy : 0.548603

Epoch :  20 loss training:  108.52210587263107 Time :  224
accuracy train: 0.962277 val: 0.644776 test: 0.567895
max validation accuracy : 0.647761 max acc epoch : 7 test accuracy : 0.548603

Epoch :  21 loss training:  107.22585952281952 Time :  235
accuracy train: 0.961615 val: 0.641791 test: 0.566906
max validation accuracy : 0.647761 max acc epoch : 7 test accuracy : 0.548603

Epoch :  22 loss training:  108.28813737630844 Time :  246
accuracy train: 0.960953 val: 0.656716 test: 0.570863
max validation accuracy : 0.656716 max acc epoch : 22 test accuracy : 0.570863

Epoch :  23 loss training:  106.03115427494049 Time :  257
accuracy train: 0.962938 val: 0.641791 test: 0.571111
max validation accuracy : 0.656716 max acc epoch : 22 test accuracy : 0.570863

Epoch :  24 loss training:  103.27258318662643 Time :  268
accuracy train: 0.964593 val: 0.653731 test: 0.568390
max validation accuracy : 0.656716 max acc epoch : 22 test accuracy : 0.570863

Epoch :  25 loss training:  104.60140573978424 Time :  279
accuracy train: 0.960622 val: 0.641791 test: 0.567895
max validation accuracy : 0.656716 max acc epoch : 22 test accuracy : 0.570863

Epoch :  26 loss training:  105.01249730587006 Time :  290
accuracy train: 0.963600 val: 0.641791 test: 0.568637
max validation accuracy : 0.656716 max acc epoch : 22 test accuracy : 0.570863

Epoch :  27 loss training:  104.44880728423595 Time :  300
accuracy train: 0.967240 val: 0.641791 test: 0.572347
max validation accuracy : 0.656716 max acc epoch : 22 test accuracy : 0.570863

Epoch :  28 loss training:  102.98151421546936 Time :  312
accuracy train: 0.964924 val: 0.650746 test: 0.572842
max validation accuracy : 0.656716 max acc epoch : 22 test accuracy : 0.570863

Epoch :  29 loss training:  103.92973247170448 Time :  324
accuracy train: 0.965255 val: 0.644776 test: 0.573089
max validation accuracy : 0.656716 max acc epoch : 22 test accuracy : 0.570863

Epoch :  30 loss training:  103.84944194555283 Time :  335
accuracy train: 0.968233 val: 0.635821 test: 0.570863
max validation accuracy : 0.656716 max acc epoch : 22 test accuracy : 0.570863

Epoch :  31 loss training:  97.48250502347946 Time :  346
accuracy train: 0.965255 val: 0.653731 test: 0.571358
max validation accuracy : 0.656716 max acc epoch : 22 test accuracy : 0.570863

Epoch :  32 loss training:  100.09091246128082 Time :  357
accuracy train: 0.967902 val: 0.647761 test: 0.572595
max validation accuracy : 0.656716 max acc epoch : 22 test accuracy : 0.570863

Epoch :  33 loss training:  98.45507079362869 Time :  368
accuracy train: 0.967902 val: 0.644776 test: 0.572347
max validation accuracy : 0.656716 max acc epoch : 22 test accuracy : 0.570863

Epoch :  34 loss training:  103.15802671015263 Time :  380
accuracy train: 0.969557 val: 0.644776 test: 0.573089
max validation accuracy : 0.656716 max acc epoch : 22 test accuracy : 0.570863

Epoch :  35 loss training:  98.92771834135056 Time :  391
accuracy train: 0.966578 val: 0.656716 test: 0.572842
max validation accuracy : 0.656716 max acc epoch : 22 test accuracy : 0.570863

Epoch :  36 loss training:  98.81995469331741 Time :  402
accuracy train: 0.970880 val: 0.641791 test: 0.574326
max validation accuracy : 0.656716 max acc epoch : 22 test accuracy : 0.570863

Epoch :  37 loss training:  99.8189050257206 Time :  413
accuracy train: 0.970218 val: 0.644776 test: 0.571605
max validation accuracy : 0.656716 max acc epoch : 22 test accuracy : 0.570863

Epoch :  38 loss training:  96.33493065834045 Time :  424
accuracy train: 0.969226 val: 0.638806 test: 0.575068
max validation accuracy : 0.656716 max acc epoch : 22 test accuracy : 0.570863

Epoch :  39 loss training:  99.43588399887085 Time :  436
accuracy train: 0.970880 val: 0.647761 test: 0.574079
max validation accuracy : 0.656716 max acc epoch : 22 test accuracy : 0.570863

Epoch :  40 loss training:  96.5862688422203 Time :  447
accuracy train: 0.970218 val: 0.650746 test: 0.573831
max validation accuracy : 0.656716 max acc epoch : 22 test accuracy : 0.570863

Epoch :  41 loss training:  93.19374287128448 Time :  458
accuracy train: 0.972866 val: 0.656716 test: 0.573089
max validation accuracy : 0.656716 max acc epoch : 22 test accuracy : 0.570863

Epoch :  42 loss training:  95.19646671414375 Time :  469
accuracy train: 0.967902 val: 0.659701 test: 0.576057
max validation accuracy : 0.659701 max acc epoch : 42 test accuracy : 0.576057

Epoch :  43 loss training:  92.96841397881508 Time :  481
accuracy train: 0.970218 val: 0.644776 test: 0.571853
max validation accuracy : 0.659701 max acc epoch : 42 test accuracy : 0.576057

Epoch :  44 loss training:  99.41566723585129 Time :  493
accuracy train: 0.971211 val: 0.656716 test: 0.572100
max validation accuracy : 0.659701 max acc epoch : 42 test accuracy : 0.576057

Epoch :  45 loss training:  92.4949976503849 Time :  505
accuracy train: 0.973527 val: 0.644776 test: 0.572842
max validation accuracy : 0.659701 max acc epoch : 42 test accuracy : 0.576057

Epoch :  46 loss training:  93.07569479942322 Time :  517
accuracy train: 0.971542 val: 0.662687 test: 0.574326
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  47 loss training:  91.55436880886555 Time :  528
accuracy train: 0.973858 val: 0.644776 test: 0.571358
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  48 loss training:  92.80244261026382 Time :  540
accuracy train: 0.971211 val: 0.656716 test: 0.573089
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  49 loss training:  91.64767995476723 Time :  551
accuracy train: 0.973527 val: 0.644776 test: 0.571111
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  50 loss training:  91.53453826904297 Time :  562
accuracy train: 0.973858 val: 0.653731 test: 0.575315
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  51 loss training:  96.44939541816711 Time :  573
accuracy train: 0.974520 val: 0.647761 test: 0.577294
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  52 loss training:  88.99855428934097 Time :  584
accuracy train: 0.973858 val: 0.656716 test: 0.573831
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  53 loss training:  89.23071122169495 Time :  595
accuracy train: 0.973197 val: 0.650746 test: 0.574326
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  54 loss training:  91.85701155662537 Time :  606
accuracy train: 0.973858 val: 0.635821 test: 0.573337
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  55 loss training:  89.81822946667671 Time :  617
accuracy train: 0.974520 val: 0.650746 test: 0.572595
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  56 loss training:  88.3066064119339 Time :  628
accuracy train: 0.975182 val: 0.647761 test: 0.575315
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  57 loss training:  85.35799001157284 Time :  639
accuracy train: 0.974189 val: 0.641791 test: 0.576057
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  58 loss training:  81.57307225465775 Time :  650
accuracy train: 0.976175 val: 0.644776 test: 0.572347
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  59 loss training:  90.44021481275558 Time :  662
accuracy train: 0.975513 val: 0.650746 test: 0.571358
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  60 loss training:  87.28326353430748 Time :  673
accuracy train: 0.976175 val: 0.644776 test: 0.575810
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  61 loss training:  87.35025730729103 Time :  684
accuracy train: 0.977829 val: 0.644776 test: 0.577047
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  62 loss training:  82.97951966524124 Time :  696
accuracy train: 0.976837 val: 0.638806 test: 0.577047
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  63 loss training:  83.14720353484154 Time :  707
accuracy train: 0.976506 val: 0.650746 test: 0.575563
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  64 loss training:  82.05821888148785 Time :  718
accuracy train: 0.982793 val: 0.656716 test: 0.573337
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  65 loss training:  85.1772396415472 Time :  729
accuracy train: 0.979484 val: 0.644776 test: 0.572100
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  66 loss training:  89.47535160183907 Time :  741
accuracy train: 0.980477 val: 0.650746 test: 0.575563
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  67 loss training:  85.245814204216 Time :  752
accuracy train: 0.980807 val: 0.647761 test: 0.575810
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  68 loss training:  83.90389278531075 Time :  764
accuracy train: 0.980807 val: 0.650746 test: 0.573337
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  69 loss training:  81.41774463653564 Time :  777
accuracy train: 0.981138 val: 0.656716 test: 0.577047
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  70 loss training:  81.25206312537193 Time :  788
accuracy train: 0.982793 val: 0.647761 test: 0.576799
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  71 loss training:  83.45270052552223 Time :  800
accuracy train: 0.981138 val: 0.656716 test: 0.579025
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  72 loss training:  80.90711569786072 Time :  811
accuracy train: 0.981138 val: 0.653731 test: 0.573089
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  73 loss training:  81.11302763223648 Time :  824
accuracy train: 0.983124 val: 0.641791 test: 0.572595
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  74 loss training:  82.56004399061203 Time :  835
accuracy train: 0.981800 val: 0.644776 test: 0.575563
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  75 loss training:  80.07933142781258 Time :  847
accuracy train: 0.983786 val: 0.659701 test: 0.578778
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  76 loss training:  83.00504359602928 Time :  858
accuracy train: 0.981469 val: 0.650746 test: 0.576305
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

Epoch :  77 loss training:  75.12056478857994 Time :  869
accuracy train: 0.982462 val: 0.644776 test: 0.575315
max validation accuracy : 0.662687 max acc epoch : 46 test accuracy : 0.574326

========================================================================================================================================================================================================
max acc epoch :  46
max validation accuracy :  0.6626865671641791
test accuracy :  0.5743259955478605
last test_accuracy :  0.5753153598812762
========================================================================================================================================================================================================

