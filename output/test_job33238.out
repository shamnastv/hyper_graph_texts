

date and time :  Mon May 17 16:03:40 2021
Namespace(batch_size=32, dataset='ohsumed', device=0, dropout=0.5, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=0)
device :  cuda:0
Counter({6: 1276, 4: 1051, 2: 1048, 5: 1002, 3: 866, 0: 774, 1: 736, 7: 647})

Epoch :  1 loss training:  472.6680328845978 Time :  268
accuracy train: 0.542687 val: 0.579104 test: 0.499382
max validation accuracy : 0.579104 max acc epoch : 1 test accuracy : 0.499382
Epoch :  1 loss training:  625.4826724529266 Time :  292
accuracy train: 0.564196 val: 0.576119 test: 0.532773
Counter({1: 1171, 5: 1144, 3: 1073, 2: 971, 4: 938, 6: 883, 0: 616, 7: 604})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  350.4814024269581 Time :  310
accuracy train: 0.657181 val: 0.623881 test: 0.615385
max validation accuracy : 0.623881 max acc epoch : 2 test accuracy : 0.615385
Epoch :  2 loss training:  440.4958818256855 Time :  337
accuracy train: 0.627068 val: 0.570149 test: 0.578531
Counter({4: 1310, 7: 1204, 1: 1111, 0: 975, 6: 836, 3: 736, 5: 654, 2: 574})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  308.05241353809834 Time :  354
accuracy train: 0.694573 val: 0.686567 test: 0.626268
max validation accuracy : 0.686567 max acc epoch : 3 test accuracy : 0.626268
Epoch :  3 loss training:  376.1075703203678 Time :  383
accuracy train: 0.658835 val: 0.620896 test: 0.605244
Counter({3: 1342, 6: 1264, 7: 1050, 0: 880, 5: 786, 2: 784, 1: 685, 4: 609})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  260.0818362236023 Time :  401
accuracy train: 0.737260 val: 0.698507 test: 0.661637
max validation accuracy : 0.698507 max acc epoch : 4 test accuracy : 0.661637
Epoch :  4 loss training:  287.99499517679214 Time :  428
accuracy train: 0.662475 val: 0.626866 test: 0.606975
Counter({1: 1275, 4: 1100, 0: 1079, 3: 920, 6: 828, 2: 826, 5: 808, 7: 564})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  241.46022794395685 Time :  446
accuracy train: 0.741231 val: 0.710448 test: 0.676725
max validation accuracy : 0.710448 max acc epoch : 5 test accuracy : 0.676725
Epoch :  5 loss training:  264.86205588281155 Time :  473
accuracy train: 0.696228 val: 0.629851 test: 0.630967
Counter({5: 1525, 1: 1352, 0: 1041, 2: 871, 7: 830, 6: 604, 4: 594, 3: 583})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  223.0926013290882 Time :  490
accuracy train: 0.771343 val: 0.701493 test: 0.672768
max validation accuracy : 0.710448 max acc epoch : 5 test accuracy : 0.676725
Epoch :  6 loss training:  250.42319187521935 Time :  516
accuracy train: 0.687624 val: 0.653731 test: 0.616374
Counter({3: 1545, 4: 1382, 6: 1110, 5: 949, 1: 842, 7: 603, 2: 496, 0: 473})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  204.53751987218857 Time :  537
accuracy train: 0.784580 val: 0.719403 test: 0.697255
max validation accuracy : 0.719403 max acc epoch : 7 test accuracy : 0.697255
Epoch :  7 loss training:  221.19610503315926 Time :  558
accuracy train: 0.713104 val: 0.668657 test: 0.634925
Counter({5: 1603, 3: 1398, 4: 1110, 7: 932, 6: 683, 1: 597, 2: 574, 0: 503})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  198.81398750841618 Time :  577
accuracy train: 0.796823 val: 0.725373 test: 0.688103
max validation accuracy : 0.725373 max acc epoch : 8 test accuracy : 0.688103
Epoch :  8 loss training:  198.9780204296112 Time :  600
accuracy train: 0.718729 val: 0.653731 test: 0.624042
Counter({4: 1343, 6: 1091, 3: 1012, 2: 976, 1: 966, 5: 742, 7: 681, 0: 589})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  196.0761427283287 Time :  619
accuracy train: 0.811052 val: 0.728358 test: 0.695028
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.695028
Epoch :  9 loss training:  192.99761559069157 Time :  645
accuracy train: 0.714428 val: 0.662687 test: 0.630225
Counter({4: 1319, 6: 1052, 2: 1000, 1: 990, 5: 984, 3: 768, 7: 714, 0: 573})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  178.4808256328106 Time :  662
accuracy train: 0.814361 val: 0.716418 test: 0.701954
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.695028
Epoch :  10 loss training:  182.6965053975582 Time :  690
accuracy train: 0.725678 val: 0.665672 test: 0.644818
Counter({1: 1326, 7: 1049, 0: 995, 2: 991, 6: 958, 4: 777, 5: 727, 3: 577})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  174.60524706542492 Time :  707
accuracy train: 0.823627 val: 0.722388 test: 0.695770
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.695028
Epoch :  11 loss training:  171.5436235666275 Time :  736
accuracy train: 0.728326 val: 0.674627 test: 0.643087
Counter({3: 1334, 7: 1041, 0: 1016, 4: 962, 2: 955, 6: 789, 5: 727, 1: 576})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  180.22117798030376 Time :  753
accuracy train: 0.826936 val: 0.713433 test: 0.700965
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.695028
Epoch :  12 loss training:  174.7865763604641 Time :  781
accuracy train: 0.748180 val: 0.674627 test: 0.651002
Counter({2: 1342, 5: 1035, 0: 998, 1: 962, 7: 956, 6: 790, 3: 733, 4: 584})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  169.57628145813942 Time :  798
accuracy train: 0.833223 val: 0.722388 test: 0.698739
max validation accuracy : 0.728358 max acc epoch : 9 test accuracy : 0.695028
Epoch :  13 loss training:  163.7554888278246 Time :  824
accuracy train: 0.747187 val: 0.692537 test: 0.647539
Counter({2: 1636, 7: 1355, 4: 964, 5: 917, 1: 749, 6: 686, 0: 561, 3: 532})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  164.57643941044807 Time :  842
accuracy train: 0.830245 val: 0.743284 test: 0.701707
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  14 loss training:  169.02491926401854 Time :  870
accuracy train: 0.753475 val: 0.689552 test: 0.649023
Counter({5: 1635, 4: 1349, 6: 978, 3: 946, 1: 713, 7: 696, 0: 556, 2: 527})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  162.6641177907586 Time :  888
accuracy train: 0.833885 val: 0.719403 test: 0.703933
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  15 loss training:  168.49413269758224 Time :  914
accuracy train: 0.757114 val: 0.692537 test: 0.657927
Counter({1: 1626, 2: 1352, 5: 986, 3: 957, 7: 852, 6: 711, 4: 554, 0: 362})

Epoch :  16 loss training:  159.77662947773933 Time :  931
accuracy train: 0.835870 val: 0.728358 test: 0.698986
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  16 loss training:  160.43520502746105 Time :  956
accuracy train: 0.762078 val: 0.719403 test: 0.656443
Counter({1: 1635, 2: 1346, 3: 987, 6: 958, 4: 851, 7: 703, 5: 549, 0: 371})

Epoch :  17 loss training:  159.5523880571127 Time :  971
accuracy train: 0.841827 val: 0.722388 test: 0.703191
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  17 loss training:  166.62232260406017 Time :  994
accuracy train: 0.760093 val: 0.704478 test: 0.657433
Counter({1: 1628, 2: 1336, 3: 993, 7: 960, 4: 857, 5: 695, 6: 551, 0: 380})

Epoch :  18 loss training:  157.39663057029247 Time :  1024
accuracy train: 0.842158 val: 0.728358 test: 0.699728
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  18 loss training:  159.40310187637806 Time :  1048
accuracy train: 0.758438 val: 0.701493 test: 0.655949
Counter({1: 1633, 2: 1335, 4: 1005, 0: 964, 7: 859, 6: 686, 5: 534, 3: 384})

Epoch :  19 loss training:  150.20517517626286 Time :  1067
accuracy train: 0.850761 val: 0.728358 test: 0.706406
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  19 loss training:  160.5780742764473 Time :  1091
accuracy train: 0.764064 val: 0.704478 test: 0.659164
Counter({1: 1618, 2: 1328, 4: 996, 5: 971, 0: 856, 7: 698, 3: 541, 6: 392})

Epoch :  20 loss training:  152.99750810861588 Time :  1110
accuracy train: 0.857710 val: 0.728358 test: 0.703438
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  20 loss training:  159.7590955644846 Time :  1135
accuracy train: 0.764064 val: 0.716418 test: 0.655949
Counter({6: 1613, 1: 1334, 7: 999, 5: 967, 3: 868, 2: 701, 4: 526, 0: 392})

Epoch :  21 loss training:  148.42767782509327 Time :  1154
accuracy train: 0.861019 val: 0.731343 test: 0.703933
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  21 loss training:  158.3195378780365 Time :  1181
accuracy train: 0.766380 val: 0.713433 test: 0.660895
Counter({3: 1590, 1: 1326, 2: 999, 7: 976, 5: 865, 6: 714, 4: 540, 0: 390})

Epoch :  22 loss training:  146.1963686645031 Time :  1198
accuracy train: 0.858372 val: 0.713433 test: 0.707395
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  22 loss training:  152.1246592849493 Time :  1225
accuracy train: 0.769689 val: 0.707463 test: 0.664358
Counter({6: 1590, 3: 1325, 4: 1012, 5: 977, 7: 863, 1: 713, 2: 530, 0: 390})

Epoch :  23 loss training:  144.25819813460112 Time :  1244
accuracy train: 0.866645 val: 0.740299 test: 0.698491
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  23 loss training:  151.83081120997667 Time :  1269
accuracy train: 0.767373 val: 0.710448 test: 0.656938
Counter({5: 1594, 1: 1327, 2: 1019, 7: 975, 4: 862, 6: 705, 3: 526, 0: 392})

Epoch :  24 loss training:  141.62134148180485 Time :  1288
accuracy train: 0.867968 val: 0.719403 test: 0.708138
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  24 loss training:  152.09468614310026 Time :  1314
accuracy train: 0.772667 val: 0.713433 test: 0.659906
Counter({4: 1573, 0: 1339, 6: 1019, 1: 977, 3: 856, 5: 717, 7: 530, 2: 389})

Epoch :  25 loss training:  138.7853256240487 Time :  1333
accuracy train: 0.876241 val: 0.725373 test: 0.707643
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  25 loss training:  148.89160239696503 Time :  1359
accuracy train: 0.781602 val: 0.710448 test: 0.668563
Counter({2: 1573, 6: 1332, 3: 1024, 7: 970, 5: 861, 0: 719, 4: 528, 1: 393})

Epoch :  26 loss training:  132.4623021557927 Time :  1377
accuracy train: 0.878557 val: 0.722388 test: 0.704180
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  26 loss training:  147.14320850372314 Time :  1403
accuracy train: 0.775976 val: 0.713433 test: 0.662132
Counter({3: 1569, 6: 1334, 5: 1013, 4: 981, 0: 856, 2: 718, 7: 528, 1: 401})

Epoch :  27 loss training:  129.48400224745274 Time :  1419
accuracy train: 0.879881 val: 0.719403 test: 0.705169
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  27 loss training:  149.91003716737032 Time :  1447
accuracy train: 0.784249 val: 0.710448 test: 0.670047
Counter({5: 1575, 3: 1332, 7: 1014, 4: 979, 0: 842, 2: 723, 6: 525, 1: 410})

Epoch :  28 loss training:  129.1761189699173 Time :  1462
accuracy train: 0.885506 val: 0.728358 test: 0.710116
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  28 loss training:  144.38504318147898 Time :  1484
accuracy train: 0.775976 val: 0.716418 test: 0.661637
Counter({2: 1569, 7: 1320, 1: 1018, 5: 982, 4: 834, 0: 732, 6: 529, 3: 416})

Epoch :  29 loss training:  126.24868236482143 Time :  1507
accuracy train: 0.887492 val: 0.737313 test: 0.706901
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  29 loss training:  141.7514227181673 Time :  1534
accuracy train: 0.779616 val: 0.713433 test: 0.661637
Counter({1: 1572, 2: 1316, 3: 1019, 5: 989, 7: 842, 6: 723, 4: 531, 0: 408})

Epoch :  30 loss training:  122.22572539746761 Time :  1553
accuracy train: 0.894441 val: 0.731343 test: 0.710116
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  30 loss training:  147.07324689626694 Time :  1577
accuracy train: 0.776307 val: 0.710448 test: 0.660895
Counter({7: 1571, 3: 1312, 2: 1014, 6: 996, 1: 841, 5: 720, 4: 531, 0: 415})

Epoch :  31 loss training:  118.13867439329624 Time :  1594
accuracy train: 0.893779 val: 0.734328 test: 0.714816
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  31 loss training:  143.06166514009237 Time :  1621
accuracy train: 0.782263 val: 0.710448 test: 0.665100
Counter({3: 1582, 2: 1319, 5: 1013, 4: 990, 0: 838, 1: 721, 7: 514, 6: 423})

Epoch :  32 loss training:  115.43484983593225 Time :  1640
accuracy train: 0.899073 val: 0.743284 test: 0.714816
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  32 loss training:  151.34011913836002 Time :  1666
accuracy train: 0.781271 val: 0.701493 test: 0.661143
Counter({5: 1524, 3: 1309, 2: 1053, 6: 999, 7: 848, 0: 588, 1: 577, 4: 502})

Epoch :  33 loss training:  118.49267798662186 Time :  1684
accuracy train: 0.904368 val: 0.740299 test: 0.710858
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  33 loss training:  144.41305020451546 Time :  1711
accuracy train: 0.785242 val: 0.701493 test: 0.661637
Counter({7: 1528, 2: 1286, 5: 1029, 4: 1009, 3: 835, 6: 665, 1: 525, 0: 523})

Epoch :  34 loss training:  111.03121140599251 Time :  1729
accuracy train: 0.907677 val: 0.731343 test: 0.712837
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  34 loss training:  134.64999293535948 Time :  1753
accuracy train: 0.780940 val: 0.698507 test: 0.660153
Counter({5: 1544, 0: 1308, 4: 1036, 7: 1001, 6: 861, 2: 675, 1: 515, 3: 460})

Epoch :  35 loss training:  111.55997938662767 Time :  1771
accuracy train: 0.914626 val: 0.731343 test: 0.714568
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  35 loss training:  140.25104960799217 Time :  1800
accuracy train: 0.793845 val: 0.716418 test: 0.667326
Counter({7: 1555, 2: 1315, 5: 1036, 4: 995, 0: 865, 1: 659, 3: 519, 6: 456})

Epoch :  36 loss training:  106.96178694441915 Time :  1816
accuracy train: 0.915950 val: 0.731343 test: 0.714321
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  36 loss training:  141.52996953949332 Time :  1846
accuracy train: 0.788551 val: 0.707463 test: 0.661637
Counter({4: 1520, 3: 1317, 5: 1043, 2: 980, 6: 876, 1: 589, 7: 572, 0: 503})

Epoch :  37 loss training:  106.58285492286086 Time :  1863
accuracy train: 0.925546 val: 0.734328 test: 0.719268
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  37 loss training:  135.26609448343515 Time :  1891
accuracy train: 0.781932 val: 0.713433 test: 0.659906
Counter({7: 1535, 0: 1300, 6: 1061, 3: 985, 1: 859, 5: 596, 2: 578, 4: 486})

Epoch :  38 loss training:  103.78844206780195 Time :  1909
accuracy train: 0.923230 val: 0.734328 test: 0.717042
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  38 loss training:  129.40562938898802 Time :  1937
accuracy train: 0.792852 val: 0.716418 test: 0.665348
Counter({6: 1543, 1: 1291, 2: 1058, 7: 982, 5: 869, 0: 588, 3: 579, 4: 490})

Epoch :  39 loss training:  101.67463648319244 Time :  1956
accuracy train: 0.924884 val: 0.722388 test: 0.718279
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  39 loss training:  134.00945466011763 Time :  1984
accuracy train: 0.795169 val: 0.701493 test: 0.668316
Counter({3: 1537, 5: 1291, 2: 1076, 7: 978, 1: 862, 0: 586, 6: 573, 4: 497})

Epoch :  40 loss training:  103.79276625812054 Time :  2002
accuracy train: 0.932164 val: 0.740299 test: 0.716794
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  40 loss training:  133.7644678838551 Time :  2030
accuracy train: 0.790536 val: 0.707463 test: 0.659906
Counter({5: 1520, 1: 1294, 3: 1073, 6: 988, 7: 856, 0: 584, 2: 581, 4: 504})

Epoch :  41 loss training:  96.90117165446281 Time :  2052
accuracy train: 0.936466 val: 0.734328 test: 0.719515
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  41 loss training:  134.33983279019594 Time :  2079
accuracy train: 0.800463 val: 0.704478 test: 0.662874
Counter({7: 1521, 0: 1294, 4: 1070, 2: 983, 1: 865, 3: 596, 5: 578, 6: 493})

Epoch :  42 loss training:  95.5930252559483 Time :  2101
accuracy train: 0.941099 val: 0.731343 test: 0.713579
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  42 loss training:  128.90526174753904 Time :  2127
accuracy train: 0.807081 val: 0.719403 test: 0.676478
Counter({3: 1507, 0: 1294, 2: 1054, 4: 994, 5: 865, 6: 611, 7: 578, 1: 497})

Epoch :  43 loss training:  92.96604049578309 Time :  2144
accuracy train: 0.946724 val: 0.731343 test: 0.719268
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  43 loss training:  128.93715430051088 Time :  2167
accuracy train: 0.802780 val: 0.704478 test: 0.670047
Counter({6: 1410, 5: 1309, 2: 1224, 3: 1040, 7: 1025, 4: 694, 1: 523, 0: 175})

Epoch :  44 loss training:  88.29353961348534 Time :  2186
accuracy train: 0.947386 val: 0.734328 test: 0.713332
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  44 loss training:  129.7965630069375 Time :  2212
accuracy train: 0.800463 val: 0.701493 test: 0.669305
Counter({0: 1395, 5: 1298, 7: 1226, 1: 1047, 3: 1019, 4: 699, 6: 542, 2: 174})

Epoch :  45 loss training:  84.35572436079383 Time :  2229
accuracy train: 0.944739 val: 0.737313 test: 0.715805
max validation accuracy : 0.743284 max acc epoch : 14 test accuracy : 0.701707
Epoch :  45 loss training:  126.8277590200305 Time :  2256
accuracy train: 0.803441 val: 0.689552 test: 0.667821
Counter({2: 1393, 6: 1299, 5: 1223, 7: 1055, 4: 1017, 1: 709, 3: 530, 0: 174})

========================================================================================================================================================================================================
max acc epoch :  14
max validation accuracy :  0.7432835820895523
test accuracy :  0.7017066534751423
last test_accuracy :  0.7158050952263171
========================================================================================================================================================================================================

