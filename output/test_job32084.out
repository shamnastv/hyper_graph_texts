

date and time :  Wed Apr 21 22:09:55 2021
Namespace(batch_size=32, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=0)
device :  cuda:0
Counter({1: 2734, 2: 2714, 0: 1952})

Epoch :  1 loss training:  437.1593255996704 Time :  20
accuracy train: 0.653541 val: 0.662687 test: 0.625773
max validation accuracy : 0.662687 max acc epoch : 1 test accuracy : 0.625773
Epoch-1 lr: 0.001

Epoch :  2 loss training:  285.1167964935303 Time :  34
accuracy train: 0.706817 val: 0.653731 test: 0.649518
max validation accuracy : 0.662687 max acc epoch : 1 test accuracy : 0.625773
Counter({0: 3135, 1: 2508, 2: 1757})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  270.5339593887329 Time :  48
accuracy train: 0.755460 val: 0.719403 test: 0.679446
max validation accuracy : 0.719403 max acc epoch : 3 test accuracy : 0.679446
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  217.0287172794342 Time :  63
accuracy train: 0.785572 val: 0.719403 test: 0.696760
max validation accuracy : 0.719403 max acc epoch : 3 test accuracy : 0.679446
Counter({1: 4342, 2: 2151, 0: 907})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  216.59807205200195 Time :  77
accuracy train: 0.803111 val: 0.731343 test: 0.703191
max validation accuracy : 0.731343 max acc epoch : 5 test accuracy : 0.703191
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  196.1553317308426 Time :  89
accuracy train: 0.819987 val: 0.725373 test: 0.702943
max validation accuracy : 0.731343 max acc epoch : 5 test accuracy : 0.703191
Counter({1: 3372, 2: 3150, 0: 878})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  181.36624991893768 Time :  105
accuracy train: 0.837194 val: 0.731343 test: 0.715558
max validation accuracy : 0.731343 max acc epoch : 5 test accuracy : 0.703191
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  162.60917055606842 Time :  118
accuracy train: 0.840834 val: 0.734328 test: 0.709869
max validation accuracy : 0.734328 max acc epoch : 8 test accuracy : 0.709869
Counter({2: 2962, 0: 2904, 1: 1534})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  163.84877479076385 Time :  133
accuracy train: 0.861350 val: 0.746269 test: 0.717042
max validation accuracy : 0.746269 max acc epoch : 9 test accuracy : 0.717042
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  153.1080101132393 Time :  146
accuracy train: 0.863005 val: 0.749254 test: 0.719268
max validation accuracy : 0.749254 max acc epoch : 10 test accuracy : 0.719268
Counter({1: 3027, 2: 2351, 0: 2022})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  150.3288648724556 Time :  161
accuracy train: 0.881866 val: 0.752239 test: 0.716052
max validation accuracy : 0.752239 max acc epoch : 11 test accuracy : 0.716052
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  148.96995919942856 Time :  175
accuracy train: 0.887161 val: 0.752239 test: 0.720010
max validation accuracy : 0.752239 max acc epoch : 11 test accuracy : 0.716052
Counter({0: 2750, 2: 2537, 1: 2113})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  138.47415590286255 Time :  190
accuracy train: 0.887492 val: 0.752239 test: 0.717289
max validation accuracy : 0.752239 max acc epoch : 11 test accuracy : 0.716052
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  135.15636789798737 Time :  204
accuracy train: 0.884183 val: 0.743284 test: 0.715558
max validation accuracy : 0.752239 max acc epoch : 11 test accuracy : 0.716052
Counter({0: 3642, 1: 2215, 2: 1543})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  138.8692456483841 Time :  221
accuracy train: 0.887492 val: 0.746269 test: 0.713579
max validation accuracy : 0.752239 max acc epoch : 11 test accuracy : 0.716052
Epoch-15 lr: 3.125e-05

Epoch :  16 loss training:  130.79453480243683 Time :  235
accuracy train: 0.891132 val: 0.752239 test: 0.716052
max validation accuracy : 0.752239 max acc epoch : 11 test accuracy : 0.716052
Counter({0: 2787, 1: 2438, 2: 2175})
Epoch-16 lr: 3.125e-05

Epoch :  17 loss training:  135.936763048172 Time :  250
accuracy train: 0.894441 val: 0.728358 test: 0.716547
max validation accuracy : 0.752239 max acc epoch : 11 test accuracy : 0.716052
Epoch-17 lr: 3.125e-05

Epoch :  18 loss training:  130.18396934866905 Time :  262
accuracy train: 0.894441 val: 0.737313 test: 0.716547
max validation accuracy : 0.752239 max acc epoch : 11 test accuracy : 0.716052
Counter({2: 3555, 1: 2517, 0: 1328})
Epoch-18 lr: 1.5625e-05

Epoch :  19 loss training:  127.59568101167679 Time :  276
accuracy train: 0.893448 val: 0.746269 test: 0.714074
max validation accuracy : 0.752239 max acc epoch : 11 test accuracy : 0.716052
Epoch-19 lr: 1.5625e-05

Epoch :  20 loss training:  132.25700426101685 Time :  289
accuracy train: 0.891794 val: 0.749254 test: 0.712095
max validation accuracy : 0.752239 max acc epoch : 11 test accuracy : 0.716052
Counter({2: 3815, 1: 2317, 0: 1268})

Epoch :  21 loss training:  131.48293954133987 Time :  304
accuracy train: 0.899404 val: 0.746269 test: 0.716052
max validation accuracy : 0.752239 max acc epoch : 11 test accuracy : 0.716052

Epoch :  22 loss training:  131.64926886558533 Time :  319
accuracy train: 0.897088 val: 0.755224 test: 0.713579
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579
Counter({0: 3734, 2: 2391, 1: 1275})

Epoch :  23 loss training:  126.42288929224014 Time :  334
accuracy train: 0.892455 val: 0.749254 test: 0.710611
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579

Epoch :  24 loss training:  124.82697847485542 Time :  346
accuracy train: 0.893117 val: 0.752239 test: 0.716300
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579
Counter({0: 3662, 2: 2480, 1: 1258})

Epoch :  25 loss training:  126.73830306529999 Time :  361
accuracy train: 0.895103 val: 0.749254 test: 0.717289
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579

Epoch :  26 loss training:  127.08156853914261 Time :  374
accuracy train: 0.897088 val: 0.746269 test: 0.721247
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579
Counter({1: 3575, 0: 2585, 2: 1240})

Epoch :  27 loss training:  124.89858597517014 Time :  389
accuracy train: 0.893117 val: 0.749254 test: 0.713579
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579

Epoch :  28 loss training:  121.17887216806412 Time :  401
accuracy train: 0.896095 val: 0.749254 test: 0.712837
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579
Counter({0: 2816, 1: 2446, 2: 2138})

Epoch :  29 loss training:  120.27740228176117 Time :  416
accuracy train: 0.899073 val: 0.755224 test: 0.717042
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579

Epoch :  30 loss training:  123.34281957149506 Time :  430
accuracy train: 0.900728 val: 0.746269 test: 0.721989
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579
Counter({2: 2802, 0: 2472, 1: 2126})

Epoch :  31 loss training:  122.88847482204437 Time :  443
accuracy train: 0.901390 val: 0.746269 test: 0.715310
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579

Epoch :  32 loss training:  115.51877665519714 Time :  456
accuracy train: 0.902383 val: 0.746269 test: 0.718773
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579
Counter({0: 2788, 2: 2501, 1: 2111})

Epoch :  33 loss training:  117.78642684221268 Time :  470
accuracy train: 0.901721 val: 0.743284 test: 0.716300
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579

Epoch :  34 loss training:  117.81275603175163 Time :  482
accuracy train: 0.904368 val: 0.755224 test: 0.716300
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579
Counter({1: 2756, 2: 2541, 0: 2103})

Epoch :  35 loss training:  117.31751954555511 Time :  496
accuracy train: 0.902052 val: 0.743284 test: 0.714074
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579

Epoch :  36 loss training:  117.80393886566162 Time :  508
accuracy train: 0.907015 val: 0.746269 test: 0.718031
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579
Counter({0: 3207, 1: 2264, 2: 1929})

Epoch :  37 loss training:  126.28824776411057 Time :  526
accuracy train: 0.904368 val: 0.755224 test: 0.720010
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579

Epoch :  38 loss training:  124.78063225746155 Time :  538
accuracy train: 0.907677 val: 0.746269 test: 0.720999
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579
Counter({1: 3291, 0: 2193, 2: 1916})

Epoch :  39 loss training:  121.57818201184273 Time :  553
accuracy train: 0.909993 val: 0.752239 test: 0.717784
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579

Epoch :  40 loss training:  117.87634029984474 Time :  565
accuracy train: 0.906353 val: 0.737313 test: 0.719021
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579
Counter({0: 3483, 2: 2165, 1: 1752})

Epoch :  41 loss training:  123.18106830120087 Time :  579
accuracy train: 0.909001 val: 0.746269 test: 0.716052
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579

Epoch :  42 loss training:  116.67642259597778 Time :  591
accuracy train: 0.910324 val: 0.740299 test: 0.719763
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579
Counter({1: 2903, 0: 2657, 2: 1840})

Epoch :  43 loss training:  119.65969282388687 Time :  605
accuracy train: 0.910324 val: 0.743284 test: 0.718279
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579

Epoch :  44 loss training:  120.57848128676414 Time :  617
accuracy train: 0.912310 val: 0.734328 test: 0.715310
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579
Counter({0: 3074, 1: 2538, 2: 1788})

Epoch :  45 loss training:  119.1340184211731 Time :  634
accuracy train: 0.908670 val: 0.749254 test: 0.720999
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579

Epoch :  46 loss training:  120.77422529459 Time :  646
accuracy train: 0.911648 val: 0.743284 test: 0.718279
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579
Counter({2: 3022, 1: 2615, 0: 1763})

Epoch :  47 loss training:  125.41188848018646 Time :  660
accuracy train: 0.911648 val: 0.752239 test: 0.719515
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579

Epoch :  48 loss training:  117.2937924861908 Time :  672
accuracy train: 0.911317 val: 0.749254 test: 0.716794
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579
Counter({2: 3327, 1: 2296, 0: 1777})

Epoch :  49 loss training:  116.58500373363495 Time :  687
accuracy train: 0.911979 val: 0.737313 test: 0.719021
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579

Epoch :  50 loss training:  120.49426573514938 Time :  700
accuracy train: 0.915619 val: 0.743284 test: 0.723225
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579
Counter({1: 3409, 0: 2718, 2: 1273})

Epoch :  51 loss training:  120.62727236747742 Time :  715
accuracy train: 0.911979 val: 0.749254 test: 0.717042
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579

Epoch :  52 loss training:  117.52531105279922 Time :  730
accuracy train: 0.915950 val: 0.749254 test: 0.717042
max validation accuracy : 0.755224 max acc epoch : 22 test accuracy : 0.713579
Counter({2: 3370, 1: 2770, 0: 1260})

Epoch :  53 loss training:  113.86464565992355 Time :  746
accuracy train: 0.912972 val: 0.764179 test: 0.716794
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794

Epoch :  54 loss training:  109.6384756565094 Time :  760
accuracy train: 0.912972 val: 0.758209 test: 0.714568
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794
Counter({1: 2650, 2: 2504, 0: 2246})

Epoch :  55 loss training:  116.78769341111183 Time :  774
accuracy train: 0.914957 val: 0.746269 test: 0.720999
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794

Epoch :  56 loss training:  115.17662915587425 Time :  786
accuracy train: 0.918266 val: 0.755224 test: 0.720999
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794
Counter({2: 2961, 1: 2526, 0: 1913})

Epoch :  57 loss training:  111.2162429690361 Time :  801
accuracy train: 0.918597 val: 0.740299 test: 0.719268
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794

Epoch :  58 loss training:  116.65715485811234 Time :  814
accuracy train: 0.919921 val: 0.752239 test: 0.717784
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794
Counter({1: 2931, 0: 2599, 2: 1870})

Epoch :  59 loss training:  115.23443818092346 Time :  831
accuracy train: 0.918928 val: 0.740299 test: 0.720010
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794

Epoch :  60 loss training:  113.03714552521706 Time :  843
accuracy train: 0.919590 val: 0.758209 test: 0.722731
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794
Counter({2: 2862, 1: 2663, 0: 1875})

Epoch :  61 loss training:  114.09851104021072 Time :  857
accuracy train: 0.920582 val: 0.749254 test: 0.720010
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794

Epoch :  62 loss training:  110.2495328783989 Time :  869
accuracy train: 0.921244 val: 0.746269 test: 0.722731
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794
Counter({2: 2991, 1: 2471, 0: 1938})

Epoch :  63 loss training:  112.06727236509323 Time :  883
accuracy train: 0.918928 val: 0.761194 test: 0.726193
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794

Epoch :  64 loss training:  114.57837384939194 Time :  895
accuracy train: 0.920582 val: 0.746269 test: 0.721989
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794
Counter({2: 3068, 1: 2379, 0: 1953})

Epoch :  65 loss training:  108.11041700839996 Time :  908
accuracy train: 0.918597 val: 0.752239 test: 0.717784
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794

Epoch :  66 loss training:  111.99864280223846 Time :  920
accuracy train: 0.915950 val: 0.746269 test: 0.719515
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794
Counter({1: 3074, 0: 2357, 2: 1969})

Epoch :  67 loss training:  108.70750945806503 Time :  938
accuracy train: 0.920582 val: 0.761194 test: 0.725451
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794

Epoch :  68 loss training:  109.26525503396988 Time :  951
accuracy train: 0.922237 val: 0.743284 test: 0.720505
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794
Counter({0: 3273, 2: 2404, 1: 1723})

Epoch :  69 loss training:  112.81053912639618 Time :  966
accuracy train: 0.922237 val: 0.752239 test: 0.720505
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794

Epoch :  70 loss training:  112.38701513409615 Time :  977
accuracy train: 0.921575 val: 0.746269 test: 0.720999
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794
Counter({0: 3280, 2: 2439, 1: 1681})

Epoch :  71 loss training:  108.47300255298615 Time :  992
accuracy train: 0.921575 val: 0.758209 test: 0.717289
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794

Epoch :  72 loss training:  108.60302764177322 Time :  1003
accuracy train: 0.924553 val: 0.749254 test: 0.720505
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794
Counter({2: 3246, 1: 2484, 0: 1670})

Epoch :  73 loss training:  111.66485169529915 Time :  1017
accuracy train: 0.924553 val: 0.764179 test: 0.724957
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794

Epoch :  74 loss training:  108.73567759990692 Time :  1029
accuracy train: 0.924884 val: 0.761194 test: 0.718031
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794
Counter({2: 3281, 1: 2476, 0: 1643})

Epoch :  75 loss training:  111.25928378105164 Time :  1045
accuracy train: 0.926208 val: 0.740299 test: 0.722731
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794

Epoch :  76 loss training:  108.5889909863472 Time :  1057
accuracy train: 0.921906 val: 0.755224 test: 0.721741
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794
Counter({2: 3301, 1: 2788, 0: 1311})

Epoch :  77 loss training:  109.08837977051735 Time :  1071
accuracy train: 0.922568 val: 0.755224 test: 0.719763
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794

Epoch :  78 loss training:  101.93732306361198 Time :  1083
accuracy train: 0.921906 val: 0.743284 test: 0.721494
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794
Counter({1: 3539, 2: 2088, 0: 1773})

Epoch :  79 loss training:  104.76953828334808 Time :  1097
accuracy train: 0.928524 val: 0.743284 test: 0.720999
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794

Epoch :  80 loss training:  110.13780131936073 Time :  1109
accuracy train: 0.926870 val: 0.743284 test: 0.720999
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794
Counter({0: 3439, 2: 2102, 1: 1859})

Epoch :  81 loss training:  104.80109611153603 Time :  1123
accuracy train: 0.927201 val: 0.752239 test: 0.717536
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794

Epoch :  82 loss training:  102.8773632645607 Time :  1135
accuracy train: 0.926870 val: 0.755224 test: 0.720999
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794
Counter({1: 3327, 0: 3007, 2: 1066})

Epoch :  83 loss training:  109.80098408460617 Time :  1149
accuracy train: 0.929848 val: 0.749254 test: 0.724462
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794

Epoch :  84 loss training:  107.39067989587784 Time :  1160
accuracy train: 0.928193 val: 0.746269 test: 0.713826
max validation accuracy : 0.764179 max acc epoch : 53 test accuracy : 0.716794
Counter({1: 3471, 0: 3370, 2: 559})

========================================================================================================================================================================================================
max acc epoch :  53
max validation accuracy :  0.764179104477612
test accuracy :  0.7167944595597329
last test_accuracy :  0.7138263665594855
========================================================================================================================================================================================================



date and time :  Wed Apr 21 22:29:30 2021
Namespace(batch_size=32, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=True, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=0)
device :  cuda:0
Counter({0: 2736, 1: 2715, 2: 1949})

Epoch :  1 loss training:  454.8817865848541 Time :  14
accuracy train: 0.639974 val: 0.623881 test: 0.604502
max validation accuracy : 0.623881 max acc epoch : 1 test accuracy : 0.604502
Epoch-1 lr: 0.001

Epoch :  2 loss training:  294.2405091524124 Time :  29
accuracy train: 0.716082 val: 0.659701 test: 0.650507
max validation accuracy : 0.659701 max acc epoch : 2 test accuracy : 0.650507
Counter({2: 3499, 1: 2381, 0: 1520})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  277.36780202388763 Time :  46
accuracy train: 0.750827 val: 0.683582 test: 0.667574
max validation accuracy : 0.683582 max acc epoch : 3 test accuracy : 0.667574
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  222.5403105020523 Time :  60
accuracy train: 0.789874 val: 0.713433 test: 0.689587
max validation accuracy : 0.713433 max acc epoch : 4 test accuracy : 0.689587
Counter({0: 4001, 1: 2026, 2: 1373})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  210.01391145586967 Time :  76
accuracy train: 0.802449 val: 0.737313 test: 0.700965
max validation accuracy : 0.737313 max acc epoch : 5 test accuracy : 0.700965
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  188.10853362083435 Time :  90
accuracy train: 0.828590 val: 0.731343 test: 0.699233
max validation accuracy : 0.737313 max acc epoch : 5 test accuracy : 0.700965
Counter({0: 2720, 1: 2607, 2: 2073})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  181.73858666419983 Time :  106
accuracy train: 0.834878 val: 0.725373 test: 0.701707
max validation accuracy : 0.737313 max acc epoch : 5 test accuracy : 0.700965
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  163.36542564630508 Time :  119
accuracy train: 0.846790 val: 0.749254 test: 0.707395
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395
Counter({2: 3125, 0: 2893, 1: 1382})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  159.05097380280495 Time :  135
accuracy train: 0.866314 val: 0.737313 test: 0.705664
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  146.69847279787064 Time :  150
accuracy train: 0.875248 val: 0.746269 test: 0.704922
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395
Counter({2: 3356, 1: 2493, 0: 1551})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  145.18739753961563 Time :  166
accuracy train: 0.870946 val: 0.734328 test: 0.706653
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  136.92031806707382 Time :  180
accuracy train: 0.879219 val: 0.731343 test: 0.702943
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395
Counter({2: 3500, 1: 3022, 0: 878})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  151.74447858333588 Time :  196
accuracy train: 0.879881 val: 0.734328 test: 0.708385
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  141.38320726156235 Time :  211
accuracy train: 0.882197 val: 0.728358 test: 0.706406
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395
Counter({0: 3720, 2: 1942, 1: 1738})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  143.34646278619766 Time :  227
accuracy train: 0.885837 val: 0.737313 test: 0.709622
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395
Epoch-15 lr: 3.125e-05

Epoch :  16 loss training:  134.00648492574692 Time :  241
accuracy train: 0.883852 val: 0.737313 test: 0.711848
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395
Counter({2: 3173, 1: 2315, 0: 1912})
Epoch-16 lr: 3.125e-05

Epoch :  17 loss training:  136.64838302135468 Time :  257
accuracy train: 0.887492 val: 0.740299 test: 0.712342
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395
Epoch-17 lr: 3.125e-05

Epoch :  18 loss training:  133.8605484366417 Time :  271
accuracy train: 0.888154 val: 0.731343 test: 0.707395
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395
Counter({0: 3706, 2: 2087, 1: 1607})
Epoch-18 lr: 1.5625e-05

Epoch :  19 loss training:  136.53121674060822 Time :  289
accuracy train: 0.891463 val: 0.731343 test: 0.710364
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395
Epoch-19 lr: 1.5625e-05

Epoch :  20 loss training:  126.63411265611649 Time :  302
accuracy train: 0.891794 val: 0.725373 test: 0.708138
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395
Counter({2: 3721, 0: 2075, 1: 1604})

Epoch :  21 loss training:  132.41090093553066 Time :  318
accuracy train: 0.888154 val: 0.740299 test: 0.705664
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395

Epoch :  22 loss training:  129.03451174497604 Time :  332
accuracy train: 0.889808 val: 0.731343 test: 0.709374
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395
Counter({1: 3463, 0: 2471, 2: 1466})

Epoch :  23 loss training:  126.42752903699875 Time :  347
accuracy train: 0.893117 val: 0.737313 test: 0.713332
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395

Epoch :  24 loss training:  123.09950190782547 Time :  361
accuracy train: 0.895103 val: 0.728358 test: 0.709869
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395
Counter({0: 3511, 2: 2378, 1: 1511})

Epoch :  25 loss training:  123.77282005548477 Time :  377
accuracy train: 0.896757 val: 0.734328 test: 0.708880
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395

Epoch :  26 loss training:  122.87498724460602 Time :  390
accuracy train: 0.893448 val: 0.737313 test: 0.708385
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395
Counter({0: 3536, 1: 2302, 2: 1562})

Epoch :  27 loss training:  121.83387196063995 Time :  405
accuracy train: 0.895433 val: 0.728358 test: 0.712095
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395

Epoch :  28 loss training:  121.33316326141357 Time :  418
accuracy train: 0.895103 val: 0.728358 test: 0.709127
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395
Counter({1: 3872, 0: 1856, 2: 1672})

Epoch :  29 loss training:  121.6033673286438 Time :  433
accuracy train: 0.898412 val: 0.731343 test: 0.706653
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395

Epoch :  30 loss training:  120.81228756904602 Time :  446
accuracy train: 0.896426 val: 0.722388 test: 0.709622
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395
Counter({1: 2998, 2: 2352, 0: 2050})

Epoch :  31 loss training:  129.10952365398407 Time :  461
accuracy train: 0.900397 val: 0.737313 test: 0.708880
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395

Epoch :  32 loss training:  121.8293769955635 Time :  475
accuracy train: 0.907015 val: 0.728358 test: 0.706406
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395
Counter({2: 3461, 1: 2686, 0: 1253})

Epoch :  33 loss training:  125.73704439401627 Time :  490
accuracy train: 0.898081 val: 0.740299 test: 0.709869
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395

Epoch :  34 loss training:  126.69782423973083 Time :  503
accuracy train: 0.896426 val: 0.734328 test: 0.707643
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395
Counter({1: 3901, 0: 2688, 2: 811})

Epoch :  35 loss training:  126.99535500258207 Time :  517
accuracy train: 0.895764 val: 0.740299 test: 0.710364
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395

Epoch :  36 loss training:  126.60987785458565 Time :  530
accuracy train: 0.902383 val: 0.731343 test: 0.711106
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395
Counter({1: 3881, 2: 2697, 0: 822})

Epoch :  37 loss training:  128.18898224830627 Time :  544
accuracy train: 0.900397 val: 0.728358 test: 0.713084
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395

Epoch :  38 loss training:  126.75410515069962 Time :  557
accuracy train: 0.903375 val: 0.734328 test: 0.709869
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395
Counter({1: 4272, 2: 2324, 0: 804})

Epoch :  39 loss training:  126.42353612184525 Time :  573
accuracy train: 0.900397 val: 0.728358 test: 0.710116
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.707395

========================================================================================================================================================================================================
max acc epoch :  8
max validation accuracy :  0.7492537313432835
test accuracy :  0.707395498392283
last test_accuracy :  0.7101162503091764
========================================================================================================================================================================================================



date and time :  Wed Apr 21 22:39:16 2021
Namespace(batch_size=32, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=True, seed=0, weight_decay=0)
device :  cuda:0
Counter({1: 2734, 2: 2714, 0: 1952})

Epoch :  1 loss training:  592.3557887077332 Time :  14
accuracy train: 0.429517 val: 0.420896 test: 0.384368
max validation accuracy : 0.420896 max acc epoch : 1 test accuracy : 0.384368
Epoch-1 lr: 0.001

Epoch :  2 loss training:  464.39828538894653 Time :  26
accuracy train: 0.552283 val: 0.522388 test: 0.450655
max validation accuracy : 0.522388 max acc epoch : 2 test accuracy : 0.450655
Counter({0: 5314, 1: 1271, 2: 815})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  410.0011866092682 Time :  39
accuracy train: 0.651886 val: 0.573134 test: 0.486273
max validation accuracy : 0.573134 max acc epoch : 3 test accuracy : 0.486273
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  331.3403570652008 Time :  51
accuracy train: 0.737922 val: 0.600000 test: 0.516943
max validation accuracy : 0.600000 max acc epoch : 4 test accuracy : 0.516943
Counter({0: 3867, 2: 2016, 1: 1517})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  299.8175766468048 Time :  66
accuracy train: 0.801456 val: 0.602985 test: 0.527826
max validation accuracy : 0.602985 max acc epoch : 5 test accuracy : 0.527826
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  256.3229840993881 Time :  78
accuracy train: 0.822634 val: 0.594030 test: 0.530794
max validation accuracy : 0.602985 max acc epoch : 5 test accuracy : 0.527826
Counter({2: 4365, 0: 2012, 1: 1023})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  233.79824674129486 Time :  94
accuracy train: 0.858041 val: 0.602985 test: 0.546376
max validation accuracy : 0.602985 max acc epoch : 5 test accuracy : 0.527826
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  213.59688472747803 Time :  106
accuracy train: 0.871608 val: 0.623881 test: 0.547118
max validation accuracy : 0.623881 max acc epoch : 8 test accuracy : 0.547118
Counter({2: 3480, 0: 3073, 1: 847})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  203.95501697063446 Time :  124
accuracy train: 0.885506 val: 0.629851 test: 0.557012
max validation accuracy : 0.629851 max acc epoch : 9 test accuracy : 0.557012
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  183.90047192573547 Time :  136
accuracy train: 0.898743 val: 0.638806 test: 0.556270
max validation accuracy : 0.638806 max acc epoch : 10 test accuracy : 0.556270
Counter({0: 3427, 1: 2820, 2: 1153})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  181.15886652469635 Time :  151
accuracy train: 0.905030 val: 0.644776 test: 0.558249
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  171.79934349656105 Time :  163
accuracy train: 0.916612 val: 0.626866 test: 0.560475
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249
Counter({1: 2619, 2: 2569, 0: 2212})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  165.32385456562042 Time :  177
accuracy train: 0.919259 val: 0.620896 test: 0.562948
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  161.9061518907547 Time :  189
accuracy train: 0.918597 val: 0.632836 test: 0.566164
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249
Counter({0: 2504, 1: 2495, 2: 2401})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  157.01649022102356 Time :  204
accuracy train: 0.930841 val: 0.632836 test: 0.563196
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249
Epoch-15 lr: 3.125e-05

Epoch :  16 loss training:  154.4460125565529 Time :  220
accuracy train: 0.927862 val: 0.635821 test: 0.569874
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249
Counter({0: 2630, 1: 2533, 2: 2237})
Epoch-16 lr: 3.125e-05

Epoch :  17 loss training:  160.56140518188477 Time :  234
accuracy train: 0.920913 val: 0.635821 test: 0.566411
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249
Epoch-17 lr: 3.125e-05

Epoch :  18 loss training:  152.3454466164112 Time :  246
accuracy train: 0.930510 val: 0.626866 test: 0.565422
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249
Counter({2: 3761, 1: 1956, 0: 1683})
Epoch-18 lr: 1.5625e-05

Epoch :  19 loss training:  151.7207955121994 Time :  261
accuracy train: 0.924222 val: 0.644776 test: 0.568142
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249
Epoch-19 lr: 1.5625e-05

Epoch :  20 loss training:  149.3505892753601 Time :  274
accuracy train: 0.929517 val: 0.626866 test: 0.566658
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249
Counter({1: 3572, 2: 1943, 0: 1885})

Epoch :  21 loss training:  149.7403506040573 Time :  288
accuracy train: 0.933157 val: 0.620896 test: 0.567400
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249

Epoch :  22 loss training:  149.8564197421074 Time :  300
accuracy train: 0.932826 val: 0.632836 test: 0.561217
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249
Counter({2: 3600, 0: 1940, 1: 1860})

Epoch :  23 loss training:  146.07061302661896 Time :  315
accuracy train: 0.931502 val: 0.632836 test: 0.565422
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249

Epoch :  24 loss training:  146.8003208041191 Time :  328
accuracy train: 0.933819 val: 0.617910 test: 0.570121
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249
Counter({1: 2770, 0: 2397, 2: 2233})

Epoch :  25 loss training:  149.69143289327621 Time :  342
accuracy train: 0.938120 val: 0.611940 test: 0.562948
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249

Epoch :  26 loss training:  144.3821056485176 Time :  355
accuracy train: 0.930841 val: 0.626866 test: 0.570369
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249
Counter({1: 2710, 2: 2461, 0: 2229})

Epoch :  27 loss training:  148.49098670482635 Time :  369
accuracy train: 0.931833 val: 0.635821 test: 0.563690
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249

Epoch :  28 loss training:  138.23664689064026 Time :  383
accuracy train: 0.935804 val: 0.632836 test: 0.565669
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249
Counter({0: 2504, 1: 2451, 2: 2445})

Epoch :  29 loss training:  147.88247430324554 Time :  398
accuracy train: 0.937128 val: 0.611940 test: 0.569132
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249

Epoch :  30 loss training:  150.5109474658966 Time :  411
accuracy train: 0.938782 val: 0.611940 test: 0.567648
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249
Counter({2: 2490, 0: 2476, 1: 2434})

Epoch :  31 loss training:  148.11252599954605 Time :  430
accuracy train: 0.938451 val: 0.626866 test: 0.569379
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249

Epoch :  32 loss training:  147.0063455104828 Time :  442
accuracy train: 0.944739 val: 0.617910 test: 0.568390
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249
Counter({1: 3222, 0: 3053, 2: 1125})

Epoch :  33 loss training:  147.60769337415695 Time :  456
accuracy train: 0.940768 val: 0.632836 test: 0.568390
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249

Epoch :  34 loss training:  141.32522016763687 Time :  469
accuracy train: 0.940768 val: 0.617910 test: 0.563196
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249
Counter({0: 2970, 1: 2475, 2: 1955})

Epoch :  35 loss training:  143.40789794921875 Time :  486
accuracy train: 0.945069 val: 0.623881 test: 0.567895
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249

Epoch :  36 loss training:  139.63532081246376 Time :  498
accuracy train: 0.940768 val: 0.620896 test: 0.566411
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249
Counter({1: 2970, 0: 2363, 2: 2067})

Epoch :  37 loss training:  138.23175382614136 Time :  513
accuracy train: 0.943746 val: 0.617910 test: 0.567895
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249

Epoch :  38 loss training:  139.9915566444397 Time :  526
accuracy train: 0.942422 val: 0.638806 test: 0.569874
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249
Counter({1: 3042, 2: 2194, 0: 2164})

Epoch :  39 loss training:  136.82785323262215 Time :  542
accuracy train: 0.943415 val: 0.623881 test: 0.569379
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249

Epoch :  40 loss training:  138.90644019842148 Time :  554
accuracy train: 0.943084 val: 0.617910 test: 0.571853
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249
Counter({0: 2992, 1: 2402, 2: 2006})

Epoch :  41 loss training:  137.7159422636032 Time :  568
accuracy train: 0.946393 val: 0.617910 test: 0.568637
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249

Epoch :  42 loss training:  139.02658787369728 Time :  580
accuracy train: 0.942422 val: 0.635821 test: 0.567895
max validation accuracy : 0.644776 max acc epoch : 11 test accuracy : 0.558249
Counter({0: 3085, 1: 2291, 2: 2024})

========================================================================================================================================================================================================
max acc epoch :  11
max validation accuracy :  0.6447761194029851
test accuracy :  0.5582488251298541
last test_accuracy :  0.567895127380658
========================================================================================================================================================================================================

