date and time :  Mon Mar 15 14:48:37 2021
Namespace(batch_size=128, dataset='R8', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=1e-05)
device :  cuda:0
Counter({0: 1467, 3: 1321, 1: 1306, 2: 1251, 6: 1224, 5: 597, 7: 488, 4: 37})
HGNNModel(
  (word_embeddings): Embedding(8231, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=8, bias=True)
    (1): Linear(in_features=200, out_features=8, bias=True)
    (2): Linear(in_features=200, out_features=8, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  63.33933889865875 Time :  11
accuracy train: 0.752777 val: 0.727273 test: 0.743836
max validation accuracy : 0.727273 max acc epoch : 1 test accuracy : 0.743836

Epoch :  2 loss training:  34.057407557964325 Time :  16
accuracy train: 0.838013 val: 0.812727 test: 0.852968
max validation accuracy : 0.812727 max acc epoch : 2 test accuracy : 0.852968

Epoch :  3 loss training:  25.989303842186928 Time :  22
accuracy train: 0.876995 val: 0.845455 test: 0.871233
max validation accuracy : 0.845455 max acc epoch : 3 test accuracy : 0.871233

Epoch :  4 loss training:  21.38936198502779 Time :  27
accuracy train: 0.888507 val: 0.874545 test: 0.894064
max validation accuracy : 0.874545 max acc epoch : 4 test accuracy : 0.894064

Epoch :  5 loss training:  18.811343997716904 Time :  33
accuracy train: 0.839426 val: 0.829091 test: 0.856621
max validation accuracy : 0.874545 max acc epoch : 4 test accuracy : 0.894064

Epoch :  6 loss training:  14.455541610717773 Time :  39
accuracy train: 0.862250 val: 0.870909 test: 0.888128
max validation accuracy : 0.874545 max acc epoch : 4 test accuracy : 0.894064

Epoch :  7 loss training:  13.088919539004564 Time :  44
accuracy train: 0.900828 val: 0.903636 test: 0.913242
max validation accuracy : 0.903636 max acc epoch : 7 test accuracy : 0.913242

Epoch :  8 loss training:  12.876450937241316 Time :  50
accuracy train: 0.889921 val: 0.890909 test: 0.904110
max validation accuracy : 0.903636 max acc epoch : 7 test accuracy : 0.913242

Epoch :  9 loss training:  11.9862130433321 Time :  55
accuracy train: 0.898000 val: 0.892727 test: 0.911416
max validation accuracy : 0.903636 max acc epoch : 7 test accuracy : 0.913242

Epoch :  10 loss training:  9.997944213449955 Time :  61
accuracy train: 0.896991 val: 0.881818 test: 0.904566
max validation accuracy : 0.903636 max acc epoch : 7 test accuracy : 0.913242

Epoch :  11 loss training:  10.070420406758785 Time :  68
accuracy train: 0.904868 val: 0.894545 test: 0.910046
max validation accuracy : 0.903636 max acc epoch : 7 test accuracy : 0.913242

Epoch :  12 loss training:  9.360195865854621 Time :  74
accuracy train: 0.927893 val: 0.914545 test: 0.926027
max validation accuracy : 0.914545 max acc epoch : 12 test accuracy : 0.926027

Epoch :  13 loss training:  8.591259002685547 Time :  79
accuracy train: 0.924056 val: 0.905455 test: 0.921005
max validation accuracy : 0.914545 max acc epoch : 12 test accuracy : 0.926027

Epoch :  14 loss training:  10.455247920006514 Time :  85
accuracy train: 0.929509 val: 0.916364 test: 0.922374
max validation accuracy : 0.916364 max acc epoch : 14 test accuracy : 0.922374

Epoch :  15 loss training:  7.95183529984206 Time :  90
accuracy train: 0.920420 val: 0.907273 test: 0.918721
max validation accuracy : 0.916364 max acc epoch : 14 test accuracy : 0.922374

Epoch :  16 loss training:  7.647976828739047 Time :  96
accuracy train: 0.917794 val: 0.910909 test: 0.919178
max validation accuracy : 0.916364 max acc epoch : 14 test accuracy : 0.922374

Epoch :  17 loss training:  7.92355983518064 Time :  102
accuracy train: 0.923652 val: 0.912727 test: 0.922374
max validation accuracy : 0.916364 max acc epoch : 14 test accuracy : 0.922374

Epoch :  18 loss training:  7.1759963277727365 Time :  108
accuracy train: 0.922642 val: 0.916364 test: 0.919635
max validation accuracy : 0.916364 max acc epoch : 14 test accuracy : 0.922374

Epoch :  19 loss training:  6.707857953384519 Time :  115
accuracy train: 0.929307 val: 0.920000 test: 0.925571
max validation accuracy : 0.920000 max acc epoch : 19 test accuracy : 0.925571

Epoch :  20 loss training:  6.6922697043046355 Time :  120
accuracy train: 0.923046 val: 0.914545 test: 0.916895
max validation accuracy : 0.920000 max acc epoch : 19 test accuracy : 0.925571

Epoch :  21 loss training:  6.605832760222256 Time :  126
accuracy train: 0.926076 val: 0.909091 test: 0.919635
max validation accuracy : 0.920000 max acc epoch : 19 test accuracy : 0.925571

Epoch :  22 loss training:  6.551241879351437 Time :  132
accuracy train: 0.931731 val: 0.921818 test: 0.925571
max validation accuracy : 0.921818 max acc epoch : 22 test accuracy : 0.925571

Epoch :  23 loss training:  6.762792851775885 Time :  137
accuracy train: 0.930115 val: 0.916364 test: 0.923744
max validation accuracy : 0.921818 max acc epoch : 22 test accuracy : 0.925571

Epoch :  24 loss training:  6.311689873225987 Time :  143
accuracy train: 0.933347 val: 0.923636 test: 0.923744
max validation accuracy : 0.923636 max acc epoch : 24 test accuracy : 0.923744

Epoch :  25 loss training:  7.104594259522855 Time :  149
accuracy train: 0.922440 val: 0.909091 test: 0.915068
max validation accuracy : 0.923636 max acc epoch : 24 test accuracy : 0.923744

Epoch :  26 loss training:  6.503009075298905 Time :  154
accuracy train: 0.922642 val: 0.907273 test: 0.916895
max validation accuracy : 0.923636 max acc epoch : 24 test accuracy : 0.923744

Epoch :  27 loss training:  6.295854852534831 Time :  159
accuracy train: 0.921228 val: 0.912727 test: 0.914612
max validation accuracy : 0.923636 max acc epoch : 24 test accuracy : 0.923744

Epoch :  28 loss training:  6.311930461786687 Time :  165
accuracy train: 0.923046 val: 0.910909 test: 0.917808
max validation accuracy : 0.923636 max acc epoch : 24 test accuracy : 0.923744

Epoch :  29 loss training:  6.112392251379788 Time :  171
accuracy train: 0.928499 val: 0.921818 test: 0.921461
max validation accuracy : 0.923636 max acc epoch : 24 test accuracy : 0.923744

Epoch :  30 loss training:  7.050246472470462 Time :  176
accuracy train: 0.930115 val: 0.916364 test: 0.921005
max validation accuracy : 0.923636 max acc epoch : 24 test accuracy : 0.923744

Epoch :  31 loss training:  5.528228966984898 Time :  181
accuracy train: 0.929509 val: 0.921818 test: 0.921918
max validation accuracy : 0.923636 max acc epoch : 24 test accuracy : 0.923744

Epoch :  32 loss training:  5.955841984599829 Time :  186
accuracy train: 0.925268 val: 0.921818 test: 0.919178
max validation accuracy : 0.923636 max acc epoch : 24 test accuracy : 0.923744

Epoch :  33 loss training:  6.241048690397292 Time :  191
accuracy train: 0.927489 val: 0.918182 test: 0.919635
max validation accuracy : 0.923636 max acc epoch : 24 test accuracy : 0.923744

Epoch :  34 loss training:  6.384957084897906 Time :  196
accuracy train: 0.926883 val: 0.916364 test: 0.917808
max validation accuracy : 0.923636 max acc epoch : 24 test accuracy : 0.923744

Epoch :  35 loss training:  6.035808132961392 Time :  201
accuracy train: 0.929307 val: 0.916364 test: 0.917352
max validation accuracy : 0.923636 max acc epoch : 24 test accuracy : 0.923744

Epoch :  36 loss training:  5.812317335046828 Time :  206
accuracy train: 0.930317 val: 0.921818 test: 0.921918
max validation accuracy : 0.923636 max acc epoch : 24 test accuracy : 0.923744

Epoch :  37 loss training:  5.531349678058177 Time :  211
accuracy train: 0.932135 val: 0.921818 test: 0.920548
max validation accuracy : 0.923636 max acc epoch : 24 test accuracy : 0.923744

Epoch :  38 loss training:  6.3123735804110765 Time :  216
accuracy train: 0.933953 val: 0.920000 test: 0.921005
max validation accuracy : 0.923636 max acc epoch : 24 test accuracy : 0.923744

Epoch :  39 loss training:  6.1254148106090724 Time :  221
accuracy train: 0.928701 val: 0.916364 test: 0.919635
max validation accuracy : 0.923636 max acc epoch : 24 test accuracy : 0.923744

Epoch :  40 loss training:  6.662025776691735 Time :  226
accuracy train: 0.933549 val: 0.921818 test: 0.920091
max validation accuracy : 0.923636 max acc epoch : 24 test accuracy : 0.923744

Epoch :  41 loss training:  6.187321798410267 Time :  232
accuracy train: 0.931731 val: 0.920000 test: 0.919178
max validation accuracy : 0.923636 max acc epoch : 24 test accuracy : 0.923744

Epoch :  42 loss training:  5.823749807663262 Time :  238
accuracy train: 0.931529 val: 0.916364 test: 0.923744
max validation accuracy : 0.923636 max acc epoch : 24 test accuracy : 0.923744

Epoch :  43 loss training:  5.765225754585117 Time :  243
accuracy train: 0.933145 val: 0.921818 test: 0.923288
max validation accuracy : 0.923636 max acc epoch : 24 test accuracy : 0.923744

Epoch :  44 loss training:  5.9353876346722245 Time :  249
accuracy train: 0.932741 val: 0.923636 test: 0.923288
max validation accuracy : 0.923636 max acc epoch : 24 test accuracy : 0.923744

Epoch :  45 loss training:  5.848525315057486 Time :  254
accuracy train: 0.931125 val: 0.920000 test: 0.922831
max validation accuracy : 0.923636 max acc epoch : 24 test accuracy : 0.923744

========================================================================================================================================================================================================
max acc epoch :  24
max validation accuracy :  0.9236363636363636
test accuracy :  0.9237442922374429
latest_test_accuracy :  0.9228310502283105
========================================================================================================================================================================================================

date and time :  Mon Mar 15 14:53:03 2021
Namespace(batch_size=128, dataset='R8', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=200, lda=True, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=1e-05)
device :  cuda:0
Counter({7: 1488, 4: 1299, 6: 1285, 2: 1260, 3: 1250, 5: 597, 1: 475, 0: 37})
HGNNModel(
  (word_embeddings): Embedding(8231, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=8, bias=True)
    (1): Linear(in_features=200, out_features=8, bias=True)
    (2): Linear(in_features=200, out_features=8, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  67.7186689376831 Time :  17
accuracy train: 0.819834 val: 0.770909 test: 0.798630
max validation accuracy : 0.770909 max acc epoch : 1 test accuracy : 0.798630

Epoch :  2 loss training:  36.18008741736412 Time :  23
accuracy train: 0.905878 val: 0.881818 test: 0.895434
max validation accuracy : 0.881818 max acc epoch : 2 test accuracy : 0.895434

Epoch :  3 loss training:  27.234419271349907 Time :  30
accuracy train: 0.914765 val: 0.903636 test: 0.913242
max validation accuracy : 0.903636 max acc epoch : 3 test accuracy : 0.913242

Epoch :  4 loss training:  21.220132395625114 Time :  36
accuracy train: 0.923652 val: 0.910909 test: 0.916895
max validation accuracy : 0.910909 max acc epoch : 4 test accuracy : 0.916895

Epoch :  5 loss training:  17.95991239696741 Time :  42
accuracy train: 0.946475 val: 0.929091 test: 0.937900
max validation accuracy : 0.929091 max acc epoch : 5 test accuracy : 0.937900

Epoch :  6 loss training:  14.786598190665245 Time :  49
accuracy train: 0.931529 val: 0.927273 test: 0.928311
max validation accuracy : 0.929091 max acc epoch : 5 test accuracy : 0.937900

Epoch :  7 loss training:  12.581514552235603 Time :  56
accuracy train: 0.944254 val: 0.923636 test: 0.939269
max validation accuracy : 0.929091 max acc epoch : 5 test accuracy : 0.937900

Epoch :  8 loss training:  10.98104378581047 Time :  63
accuracy train: 0.951323 val: 0.927273 test: 0.939726
max validation accuracy : 0.929091 max acc epoch : 5 test accuracy : 0.937900

Epoch :  9 loss training:  10.637712121009827 Time :  69
accuracy train: 0.942638 val: 0.920000 test: 0.936073
max validation accuracy : 0.929091 max acc epoch : 5 test accuracy : 0.937900

Epoch :  10 loss training:  9.722417181357741 Time :  76
accuracy train: 0.951727 val: 0.938182 test: 0.942009
max validation accuracy : 0.938182 max acc epoch : 10 test accuracy : 0.942009

Epoch :  11 loss training:  8.641615100204945 Time :  83
accuracy train: 0.950919 val: 0.938182 test: 0.942009
max validation accuracy : 0.938182 max acc epoch : 10 test accuracy : 0.942009

Epoch :  12 loss training:  8.318200247362256 Time :  89
accuracy train: 0.949101 val: 0.929091 test: 0.936986
max validation accuracy : 0.938182 max acc epoch : 10 test accuracy : 0.942009

Epoch :  13 loss training:  7.974351391196251 Time :  96
accuracy train: 0.955161 val: 0.929091 test: 0.937443
max validation accuracy : 0.938182 max acc epoch : 10 test accuracy : 0.942009

Epoch :  14 loss training:  7.321269577369094 Time :  102
accuracy train: 0.953949 val: 0.927273 test: 0.937900
max validation accuracy : 0.938182 max acc epoch : 10 test accuracy : 0.942009

Epoch :  15 loss training:  7.131570617668331 Time :  109
accuracy train: 0.953141 val: 0.929091 test: 0.934703
max validation accuracy : 0.938182 max acc epoch : 10 test accuracy : 0.942009

Epoch :  16 loss training:  6.716382468119264 Time :  115
accuracy train: 0.954959 val: 0.936364 test: 0.936986
max validation accuracy : 0.938182 max acc epoch : 10 test accuracy : 0.942009

Epoch :  17 loss training:  6.406668098643422 Time :  122
accuracy train: 0.954555 val: 0.929091 test: 0.938356
max validation accuracy : 0.938182 max acc epoch : 10 test accuracy : 0.942009

Epoch :  18 loss training:  6.566950231790543 Time :  128
accuracy train: 0.950313 val: 0.925455 test: 0.932877
max validation accuracy : 0.938182 max acc epoch : 10 test accuracy : 0.942009

Epoch :  19 loss training:  5.810403645969927 Time :  135
accuracy train: 0.952535 val: 0.930909 test: 0.933333
max validation accuracy : 0.938182 max acc epoch : 10 test accuracy : 0.942009

Epoch :  20 loss training:  5.92946763150394 Time :  141
accuracy train: 0.954353 val: 0.934545 test: 0.936073
max validation accuracy : 0.938182 max acc epoch : 10 test accuracy : 0.942009

Epoch :  21 loss training:  5.586637803353369 Time :  147
accuracy train: 0.952131 val: 0.934545 test: 0.935616
max validation accuracy : 0.938182 max acc epoch : 10 test accuracy : 0.942009

Epoch :  22 loss training:  5.851159020792693 Time :  153
accuracy train: 0.953949 val: 0.934545 test: 0.935160
max validation accuracy : 0.938182 max acc epoch : 10 test accuracy : 0.942009

Epoch :  23 loss training:  5.231124166864902 Time :  158
accuracy train: 0.954959 val: 0.923636 test: 0.936986
max validation accuracy : 0.938182 max acc epoch : 10 test accuracy : 0.942009

Epoch :  24 loss training:  5.303913394454867 Time :  164
accuracy train: 0.954151 val: 0.927273 test: 0.936530
max validation accuracy : 0.938182 max acc epoch : 10 test accuracy : 0.942009

Epoch :  25 loss training:  5.28347341530025 Time :  170
accuracy train: 0.958998 val: 0.936364 test: 0.937900
max validation accuracy : 0.938182 max acc epoch : 10 test accuracy : 0.942009

Epoch :  26 loss training:  5.07469027582556 Time :  176
accuracy train: 0.953343 val: 0.930909 test: 0.935616
max validation accuracy : 0.938182 max acc epoch : 10 test accuracy : 0.942009

Epoch :  27 loss training:  5.6673888470977545 Time :  182
accuracy train: 0.955968 val: 0.930909 test: 0.936530
max validation accuracy : 0.938182 max acc epoch : 10 test accuracy : 0.942009

Epoch :  28 loss training:  5.079388726502657 Time :  189
accuracy train: 0.956978 val: 0.934545 test: 0.936530
max validation accuracy : 0.938182 max acc epoch : 10 test accuracy : 0.942009

Epoch :  29 loss training:  4.939051550347358 Time :  195
accuracy train: 0.960614 val: 0.934545 test: 0.941096
max validation accuracy : 0.938182 max acc epoch : 10 test accuracy : 0.942009

Epoch :  30 loss training:  4.73964507272467 Time :  201
accuracy train: 0.954353 val: 0.927273 test: 0.936530
max validation accuracy : 0.938182 max acc epoch : 10 test accuracy : 0.942009

Epoch :  31 loss training:  4.924475618638098 Time :  208
accuracy train: 0.955767 val: 0.932727 test: 0.936530
max validation accuracy : 0.938182 max acc epoch : 10 test accuracy : 0.942009

========================================================================================================================================================================================================
max acc epoch :  10
max validation accuracy :  0.9381818181818182
test accuracy :  0.9420091324200913
latest_test_accuracy :  0.9365296803652968
========================================================================================================================================================================================================

date and time :  Mon Mar 15 14:56:42 2021
Namespace(batch_size=128, dataset='R8', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=True, seed=0, weight_decay=1e-05)
device :  cuda:0
Counter({0: 1467, 3: 1321, 1: 1306, 2: 1251, 6: 1224, 5: 597, 7: 488, 4: 37})
HGNNModel(
  (word_embeddings): Embedding(8231, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=8, bias=True)
    (1): Linear(in_features=200, out_features=8, bias=True)
    (2): Linear(in_features=200, out_features=8, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  66.56360071897507 Time :  16
accuracy train: 0.800848 val: 0.767273 test: 0.788128
max validation accuracy : 0.767273 max acc epoch : 1 test accuracy : 0.788128

Epoch :  2 loss training:  35.58124715089798 Time :  21
accuracy train: 0.852757 val: 0.810909 test: 0.852055
max validation accuracy : 0.810909 max acc epoch : 2 test accuracy : 0.852055

Epoch :  3 loss training:  26.14122201502323 Time :  26
accuracy train: 0.908099 val: 0.869091 test: 0.896804
max validation accuracy : 0.869091 max acc epoch : 3 test accuracy : 0.896804

Epoch :  4 loss training:  18.74195373430848 Time :  31
accuracy train: 0.915573 val: 0.883636 test: 0.903653
max validation accuracy : 0.883636 max acc epoch : 4 test accuracy : 0.903653

Epoch :  5 loss training:  15.611470498144627 Time :  37
accuracy train: 0.907291 val: 0.872727 test: 0.890411
max validation accuracy : 0.883636 max acc epoch : 4 test accuracy : 0.903653

Epoch :  6 loss training:  11.14711943268776 Time :  42
accuracy train: 0.947081 val: 0.910909 test: 0.929680
max validation accuracy : 0.910909 max acc epoch : 6 test accuracy : 0.929680

Epoch :  7 loss training:  9.192019827663898 Time :  47
accuracy train: 0.949101 val: 0.910909 test: 0.927397
max validation accuracy : 0.910909 max acc epoch : 6 test accuracy : 0.929680

Epoch :  8 loss training:  8.13550647906959 Time :  52
accuracy train: 0.961624 val: 0.921818 test: 0.936530
max validation accuracy : 0.921818 max acc epoch : 8 test accuracy : 0.936530

Epoch :  9 loss training:  7.1526889288797975 Time :  57
accuracy train: 0.961018 val: 0.920000 test: 0.934247
max validation accuracy : 0.921818 max acc epoch : 8 test accuracy : 0.936530

Epoch :  10 loss training:  5.726335557177663 Time :  62
accuracy train: 0.960816 val: 0.907273 test: 0.926484
max validation accuracy : 0.921818 max acc epoch : 8 test accuracy : 0.936530

Epoch :  11 loss training:  6.157926662825048 Time :  68
accuracy train: 0.969299 val: 0.912727 test: 0.931507
max validation accuracy : 0.921818 max acc epoch : 8 test accuracy : 0.936530

Epoch :  12 loss training:  4.906127464026213 Time :  73
accuracy train: 0.967885 val: 0.912727 test: 0.931963
max validation accuracy : 0.921818 max acc epoch : 8 test accuracy : 0.936530

Epoch :  13 loss training:  4.315805258229375 Time :  78
accuracy train: 0.971925 val: 0.914545 test: 0.937443
max validation accuracy : 0.921818 max acc epoch : 8 test accuracy : 0.936530

Epoch :  14 loss training:  5.332079855725169 Time :  84
accuracy train: 0.978590 val: 0.930909 test: 0.941553
max validation accuracy : 0.930909 max acc epoch : 14 test accuracy : 0.941553

Epoch :  15 loss training:  4.149485748726875 Time :  89
accuracy train: 0.976166 val: 0.920000 test: 0.938356
max validation accuracy : 0.930909 max acc epoch : 14 test accuracy : 0.941553

Epoch :  16 loss training:  3.5581230306997895 Time :  95
accuracy train: 0.977782 val: 0.923636 test: 0.936530
max validation accuracy : 0.930909 max acc epoch : 14 test accuracy : 0.941553

Epoch :  17 loss training:  3.6520707570016384 Time :  100
accuracy train: 0.976974 val: 0.923636 test: 0.937443
max validation accuracy : 0.930909 max acc epoch : 14 test accuracy : 0.941553

Epoch :  18 loss training:  3.1594612621702254 Time :  105
accuracy train: 0.977378 val: 0.921818 test: 0.935160
max validation accuracy : 0.930909 max acc epoch : 14 test accuracy : 0.941553

Epoch :  19 loss training:  3.0581314077135175 Time :  110
accuracy train: 0.977984 val: 0.918182 test: 0.934703
max validation accuracy : 0.930909 max acc epoch : 14 test accuracy : 0.941553

Epoch :  20 loss training:  2.8373105032369494 Time :  116
accuracy train: 0.978994 val: 0.918182 test: 0.935616
max validation accuracy : 0.930909 max acc epoch : 14 test accuracy : 0.941553

Epoch :  21 loss training:  2.6466577174142003 Time :  121
accuracy train: 0.980610 val: 0.921818 test: 0.936530
max validation accuracy : 0.930909 max acc epoch : 14 test accuracy : 0.941553

Epoch :  22 loss training:  2.981128505896777 Time :  126
accuracy train: 0.980206 val: 0.916364 test: 0.936986
max validation accuracy : 0.930909 max acc epoch : 14 test accuracy : 0.941553

Epoch :  23 loss training:  2.8517207726836205 Time :  131
accuracy train: 0.980610 val: 0.918182 test: 0.936530
max validation accuracy : 0.930909 max acc epoch : 14 test accuracy : 0.941553

Epoch :  24 loss training:  2.692968165036291 Time :  136
accuracy train: 0.981014 val: 0.921818 test: 0.937900
max validation accuracy : 0.930909 max acc epoch : 14 test accuracy : 0.941553

Epoch :  25 loss training:  2.521110583562404 Time :  141
accuracy train: 0.983438 val: 0.927273 test: 0.937443
max validation accuracy : 0.930909 max acc epoch : 14 test accuracy : 0.941553

Epoch :  26 loss training:  2.8147728983312845 Time :  146
accuracy train: 0.983438 val: 0.932727 test: 0.940639
max validation accuracy : 0.932727 max acc epoch : 26 test accuracy : 0.940639

Epoch :  27 loss training:  2.737987032858655 Time :  152
accuracy train: 0.982226 val: 0.929091 test: 0.938356
max validation accuracy : 0.932727 max acc epoch : 26 test accuracy : 0.940639

Epoch :  28 loss training:  2.851631256286055 Time :  156
accuracy train: 0.983640 val: 0.929091 test: 0.939269
max validation accuracy : 0.932727 max acc epoch : 26 test accuracy : 0.940639

Epoch :  29 loss training:  2.5032323473133147 Time :  162
accuracy train: 0.981620 val: 0.929091 test: 0.935616
max validation accuracy : 0.932727 max acc epoch : 26 test accuracy : 0.940639

Epoch :  30 loss training:  3.6037552086636424 Time :  167
accuracy train: 0.982832 val: 0.929091 test: 0.938356
max validation accuracy : 0.932727 max acc epoch : 26 test accuracy : 0.940639

Epoch :  31 loss training:  2.2917427998036146 Time :  172
accuracy train: 0.982630 val: 0.929091 test: 0.939726
max validation accuracy : 0.932727 max acc epoch : 26 test accuracy : 0.940639

Epoch :  32 loss training:  2.322029220405966 Time :  178
accuracy train: 0.983438 val: 0.929091 test: 0.938813
max validation accuracy : 0.932727 max acc epoch : 26 test accuracy : 0.940639

Epoch :  33 loss training:  2.922436001477763 Time :  183
accuracy train: 0.983640 val: 0.932727 test: 0.937443
max validation accuracy : 0.932727 max acc epoch : 26 test accuracy : 0.940639

Epoch :  34 loss training:  2.4383907455485314 Time :  188
accuracy train: 0.983236 val: 0.930909 test: 0.938813
max validation accuracy : 0.932727 max acc epoch : 26 test accuracy : 0.940639

Epoch :  35 loss training:  2.553830132994335 Time :  193
accuracy train: 0.983842 val: 0.932727 test: 0.937443
max validation accuracy : 0.932727 max acc epoch : 26 test accuracy : 0.940639

Epoch :  36 loss training:  2.4052314687287435 Time :  198
accuracy train: 0.982630 val: 0.927273 test: 0.940183
max validation accuracy : 0.932727 max acc epoch : 26 test accuracy : 0.940639

Epoch :  37 loss training:  2.2227974658599123 Time :  203
accuracy train: 0.981822 val: 0.927273 test: 0.936530
max validation accuracy : 0.932727 max acc epoch : 26 test accuracy : 0.940639

Epoch :  38 loss training:  2.515349178109318 Time :  208
accuracy train: 0.982832 val: 0.929091 test: 0.939726
max validation accuracy : 0.932727 max acc epoch : 26 test accuracy : 0.940639

Epoch :  39 loss training:  2.7403696258552372 Time :  213
accuracy train: 0.982226 val: 0.929091 test: 0.938813
max validation accuracy : 0.932727 max acc epoch : 26 test accuracy : 0.940639

Epoch :  40 loss training:  2.538308863528073 Time :  219
accuracy train: 0.981014 val: 0.929091 test: 0.936986
max validation accuracy : 0.932727 max acc epoch : 26 test accuracy : 0.940639

Epoch :  41 loss training:  2.7379157752729952 Time :  224
accuracy train: 0.982832 val: 0.930909 test: 0.937900
max validation accuracy : 0.932727 max acc epoch : 26 test accuracy : 0.940639

Epoch :  42 loss training:  2.2056265301071107 Time :  229
accuracy train: 0.982226 val: 0.927273 test: 0.939269
max validation accuracy : 0.932727 max acc epoch : 26 test accuracy : 0.940639

Epoch :  43 loss training:  2.430426338687539 Time :  234
accuracy train: 0.984448 val: 0.932727 test: 0.940183
max validation accuracy : 0.932727 max acc epoch : 26 test accuracy : 0.940639

Epoch :  44 loss training:  2.3874133395729586 Time :  239
accuracy train: 0.983640 val: 0.930909 test: 0.939726
max validation accuracy : 0.932727 max acc epoch : 26 test accuracy : 0.940639

Epoch :  45 loss training:  2.4960414925590158 Time :  245
accuracy train: 0.982226 val: 0.929091 test: 0.939726
max validation accuracy : 0.932727 max acc epoch : 26 test accuracy : 0.940639

Epoch :  46 loss training:  2.3345873481594026 Time :  250
accuracy train: 0.983842 val: 0.929091 test: 0.939269
max validation accuracy : 0.932727 max acc epoch : 26 test accuracy : 0.940639

Epoch :  47 loss training:  2.446774046169594 Time :  256
accuracy train: 0.981620 val: 0.927273 test: 0.939269
max validation accuracy : 0.932727 max acc epoch : 26 test accuracy : 0.940639

========================================================================================================================================================================================================
max acc epoch :  26
max validation accuracy :  0.9327272727272727
test accuracy :  0.9406392694063926
latest_test_accuracy :  0.9392694063926941
========================================================================================================================================================================================================

date and time :  Mon Mar 15 15:01:09 2021
Namespace(batch_size=128, dataset='R8', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=100, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=1e-05)
device :  cuda:0
Counter({0: 1467, 3: 1321, 1: 1306, 2: 1251, 6: 1224, 5: 597, 7: 488, 4: 37})
HGNNModel(
  (word_embeddings): Embedding(8231, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=8, bias=True)
    (1): Linear(in_features=100, out_features=8, bias=True)
    (2): Linear(in_features=100, out_features=8, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  60.7492116689682 Time :  20
accuracy train: 0.742072 val: 0.718182 test: 0.747032
max validation accuracy : 0.718182 max acc epoch : 1 test accuracy : 0.747032

Epoch :  2 loss training:  34.16389758884907 Time :  26
accuracy train: 0.869117 val: 0.836364 test: 0.874429
max validation accuracy : 0.836364 max acc epoch : 2 test accuracy : 0.874429

Epoch :  3 loss training:  26.482973895967007 Time :  33
accuracy train: 0.860230 val: 0.843636 test: 0.864840
max validation accuracy : 0.843636 max acc epoch : 3 test accuracy : 0.864840

Epoch :  4 loss training:  20.925953071564436 Time :  38
accuracy train: 0.872147 val: 0.845455 test: 0.885388
max validation accuracy : 0.845455 max acc epoch : 4 test accuracy : 0.885388

Epoch :  5 loss training:  19.161382529884577 Time :  44
accuracy train: 0.876389 val: 0.858182 test: 0.886301
max validation accuracy : 0.858182 max acc epoch : 5 test accuracy : 0.886301

Epoch :  6 loss training:  15.336599247530103 Time :  50
accuracy train: 0.897192 val: 0.874545 test: 0.902283
max validation accuracy : 0.874545 max acc epoch : 6 test accuracy : 0.902283

Epoch :  7 loss training:  13.462781868875027 Time :  55
accuracy train: 0.906887 val: 0.889091 test: 0.905023
max validation accuracy : 0.889091 max acc epoch : 7 test accuracy : 0.905023

Epoch :  8 loss training:  13.589999912306666 Time :  60
accuracy train: 0.912947 val: 0.898182 test: 0.909589
max validation accuracy : 0.898182 max acc epoch : 8 test accuracy : 0.909589

Epoch :  9 loss training:  12.946771310642362 Time :  66
accuracy train: 0.900626 val: 0.896364 test: 0.904110
max validation accuracy : 0.898182 max acc epoch : 8 test accuracy : 0.909589

Epoch :  10 loss training:  11.28318487945944 Time :  71
accuracy train: 0.915977 val: 0.896364 test: 0.909132
max validation accuracy : 0.898182 max acc epoch : 8 test accuracy : 0.909589

Epoch :  11 loss training:  10.984474052675068 Time :  76
accuracy train: 0.918602 val: 0.901818 test: 0.914612
max validation accuracy : 0.901818 max acc epoch : 11 test accuracy : 0.914612

Epoch :  12 loss training:  10.358687115833163 Time :  81
accuracy train: 0.923652 val: 0.903636 test: 0.918265
max validation accuracy : 0.903636 max acc epoch : 12 test accuracy : 0.918265

Epoch :  13 loss training:  9.28817575564608 Time :  86
accuracy train: 0.932337 val: 0.912727 test: 0.922831
max validation accuracy : 0.912727 max acc epoch : 13 test accuracy : 0.922831

Epoch :  14 loss training:  10.89915942773223 Time :  91
accuracy train: 0.933751 val: 0.914545 test: 0.930137
max validation accuracy : 0.914545 max acc epoch : 14 test accuracy : 0.930137

Epoch :  15 loss training:  9.111635711509734 Time :  97
accuracy train: 0.928903 val: 0.912727 test: 0.925571
max validation accuracy : 0.914545 max acc epoch : 14 test accuracy : 0.930137

Epoch :  16 loss training:  8.51756530860439 Time :  102
accuracy train: 0.923854 val: 0.910909 test: 0.923744
max validation accuracy : 0.914545 max acc epoch : 14 test accuracy : 0.930137

Epoch :  17 loss training:  8.677946775220335 Time :  107
accuracy train: 0.920622 val: 0.909091 test: 0.921461
max validation accuracy : 0.914545 max acc epoch : 14 test accuracy : 0.930137

Epoch :  18 loss training:  9.369731939397752 Time :  112
accuracy train: 0.921834 val: 0.905455 test: 0.919635
max validation accuracy : 0.914545 max acc epoch : 14 test accuracy : 0.930137

Epoch :  19 loss training:  8.110237289685756 Time :  117
accuracy train: 0.921228 val: 0.907273 test: 0.921005
max validation accuracy : 0.914545 max acc epoch : 14 test accuracy : 0.930137

Epoch :  20 loss training:  8.033285995014012 Time :  122
accuracy train: 0.924864 val: 0.907273 test: 0.918721
max validation accuracy : 0.914545 max acc epoch : 14 test accuracy : 0.930137

Epoch :  21 loss training:  7.855655034305528 Time :  127
accuracy train: 0.922238 val: 0.905455 test: 0.916895
max validation accuracy : 0.914545 max acc epoch : 14 test accuracy : 0.930137

Epoch :  22 loss training:  8.635586622636765 Time :  132
accuracy train: 0.920218 val: 0.903636 test: 0.915982
max validation accuracy : 0.914545 max acc epoch : 14 test accuracy : 0.930137

Epoch :  23 loss training:  7.907570440787822 Time :  137
accuracy train: 0.925874 val: 0.909091 test: 0.920091
max validation accuracy : 0.914545 max acc epoch : 14 test accuracy : 0.930137

Epoch :  24 loss training:  7.285491787130013 Time :  142
accuracy train: 0.928701 val: 0.910909 test: 0.918265
max validation accuracy : 0.914545 max acc epoch : 14 test accuracy : 0.930137

Epoch :  25 loss training:  8.294364840257913 Time :  147
accuracy train: 0.928297 val: 0.907273 test: 0.918265
max validation accuracy : 0.914545 max acc epoch : 14 test accuracy : 0.930137

Epoch :  26 loss training:  7.6269711188506335 Time :  152
accuracy train: 0.928499 val: 0.909091 test: 0.916895
max validation accuracy : 0.914545 max acc epoch : 14 test accuracy : 0.930137

Epoch :  27 loss training:  7.826645755441859 Time :  157
accuracy train: 0.926883 val: 0.909091 test: 0.918721
max validation accuracy : 0.914545 max acc epoch : 14 test accuracy : 0.930137

Epoch :  28 loss training:  7.831184626556933 Time :  162
accuracy train: 0.927893 val: 0.909091 test: 0.920548
max validation accuracy : 0.914545 max acc epoch : 14 test accuracy : 0.930137

Epoch :  29 loss training:  7.411578953731805 Time :  167
accuracy train: 0.930115 val: 0.910909 test: 0.921005
max validation accuracy : 0.914545 max acc epoch : 14 test accuracy : 0.930137

Epoch :  30 loss training:  8.433041529729962 Time :  172
accuracy train: 0.930923 val: 0.905455 test: 0.917352
max validation accuracy : 0.914545 max acc epoch : 14 test accuracy : 0.930137

Epoch :  31 loss training:  7.750096283387393 Time :  177
accuracy train: 0.930317 val: 0.909091 test: 0.921461
max validation accuracy : 0.914545 max acc epoch : 14 test accuracy : 0.930137

Epoch :  32 loss training:  7.364672903669998 Time :  183
accuracy train: 0.928499 val: 0.907273 test: 0.921918
max validation accuracy : 0.914545 max acc epoch : 14 test accuracy : 0.930137

Epoch :  33 loss training:  7.46895599225536 Time :  188
accuracy train: 0.927489 val: 0.905455 test: 0.915525
max validation accuracy : 0.914545 max acc epoch : 14 test accuracy : 0.930137

Epoch :  34 loss training:  7.533770347945392 Time :  193
accuracy train: 0.931529 val: 0.909091 test: 0.918265
max validation accuracy : 0.914545 max acc epoch : 14 test accuracy : 0.930137

Epoch :  35 loss training:  7.053551487158984 Time :  198
accuracy train: 0.928903 val: 0.905455 test: 0.918265
max validation accuracy : 0.914545 max acc epoch : 14 test accuracy : 0.930137

========================================================================================================================================================================================================
max acc epoch :  14
max validation accuracy :  0.9145454545454546
test accuracy :  0.9301369863013699
latest_test_accuracy :  0.9182648401826484
========================================================================================================================================================================================================

date and time :  Mon Mar 15 15:04:38 2021
Namespace(batch_size=128, dataset='R8', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=100, lda=True, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=1e-05)
device :  cuda:0
Counter({7: 1488, 4: 1299, 6: 1285, 2: 1260, 3: 1250, 5: 597, 1: 475, 0: 37})
HGNNModel(
  (word_embeddings): Embedding(8231, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=8, bias=True)
    (1): Linear(in_features=100, out_features=8, bias=True)
    (2): Linear(in_features=100, out_features=8, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  65.9142005443573 Time :  20
accuracy train: 0.727732 val: 0.705455 test: 0.720548
max validation accuracy : 0.705455 max acc epoch : 1 test accuracy : 0.720548

Epoch :  2 loss training:  36.10723704099655 Time :  27
accuracy train: 0.885680 val: 0.843636 test: 0.884932
max validation accuracy : 0.843636 max acc epoch : 2 test accuracy : 0.884932

Epoch :  3 loss training:  27.366245567798615 Time :  34
accuracy train: 0.913351 val: 0.887273 test: 0.905936
max validation accuracy : 0.887273 max acc epoch : 3 test accuracy : 0.905936

Epoch :  4 loss training:  20.925651483237743 Time :  41
accuracy train: 0.920622 val: 0.889091 test: 0.909132
max validation accuracy : 0.889091 max acc epoch : 4 test accuracy : 0.909132

Epoch :  5 loss training:  18.07410442084074 Time :  48
accuracy train: 0.928499 val: 0.900000 test: 0.915525
max validation accuracy : 0.900000 max acc epoch : 5 test accuracy : 0.915525

Epoch :  6 loss training:  15.398317137733102 Time :  54
accuracy train: 0.931125 val: 0.912727 test: 0.922374
max validation accuracy : 0.912727 max acc epoch : 6 test accuracy : 0.922374

Epoch :  7 loss training:  13.22067348845303 Time :  61
accuracy train: 0.939204 val: 0.927273 test: 0.932877
max validation accuracy : 0.927273 max acc epoch : 7 test accuracy : 0.932877

Epoch :  8 loss training:  11.848780980333686 Time :  68
accuracy train: 0.945668 val: 0.927273 test: 0.932877
max validation accuracy : 0.927273 max acc epoch : 7 test accuracy : 0.932877

Epoch :  9 loss training:  11.081492753699422 Time :  74
accuracy train: 0.939406 val: 0.925455 test: 0.926941
max validation accuracy : 0.927273 max acc epoch : 7 test accuracy : 0.932877

Epoch :  10 loss training:  10.065678711049259 Time :  80
accuracy train: 0.949505 val: 0.929091 test: 0.929224
max validation accuracy : 0.929091 max acc epoch : 10 test accuracy : 0.929224

Epoch :  11 loss training:  9.567439936101437 Time :  86
accuracy train: 0.951929 val: 0.930909 test: 0.933790
max validation accuracy : 0.930909 max acc epoch : 11 test accuracy : 0.933790

Epoch :  12 loss training:  9.251744812354445 Time :  91
accuracy train: 0.952333 val: 0.929091 test: 0.931507
max validation accuracy : 0.930909 max acc epoch : 11 test accuracy : 0.933790

Epoch :  13 loss training:  8.597177819814533 Time :  97
accuracy train: 0.951323 val: 0.930909 test: 0.930594
max validation accuracy : 0.930909 max acc epoch : 11 test accuracy : 0.933790

Epoch :  14 loss training:  8.200376799795777 Time :  103
accuracy train: 0.954757 val: 0.932727 test: 0.936530
max validation accuracy : 0.932727 max acc epoch : 14 test accuracy : 0.936530

Epoch :  15 loss training:  8.121746694203466 Time :  109
accuracy train: 0.954757 val: 0.932727 test: 0.936530
max validation accuracy : 0.932727 max acc epoch : 14 test accuracy : 0.936530

Epoch :  16 loss training:  8.209568400867283 Time :  116
accuracy train: 0.952939 val: 0.932727 test: 0.933790
max validation accuracy : 0.932727 max acc epoch : 14 test accuracy : 0.936530

Epoch :  17 loss training:  7.371566499117762 Time :  123
accuracy train: 0.953545 val: 0.930909 test: 0.935616
max validation accuracy : 0.932727 max acc epoch : 14 test accuracy : 0.936530

Epoch :  18 loss training:  7.4759064060635865 Time :  130
accuracy train: 0.954353 val: 0.929091 test: 0.937443
max validation accuracy : 0.932727 max acc epoch : 14 test accuracy : 0.936530

Epoch :  19 loss training:  7.465298300143331 Time :  137
accuracy train: 0.955565 val: 0.932727 test: 0.938356
max validation accuracy : 0.932727 max acc epoch : 14 test accuracy : 0.936530

Epoch :  20 loss training:  6.893791582901031 Time :  144
accuracy train: 0.958392 val: 0.934545 test: 0.939269
max validation accuracy : 0.934545 max acc epoch : 20 test accuracy : 0.939269

Epoch :  21 loss training:  7.072980722878128 Time :  151
accuracy train: 0.957988 val: 0.934545 test: 0.940639
max validation accuracy : 0.934545 max acc epoch : 20 test accuracy : 0.939269

Epoch :  22 loss training:  6.976322389906272 Time :  158
accuracy train: 0.960614 val: 0.936364 test: 0.940183
max validation accuracy : 0.936364 max acc epoch : 22 test accuracy : 0.940183

Epoch :  23 loss training:  6.720419663703069 Time :  165
accuracy train: 0.958594 val: 0.936364 test: 0.939726
max validation accuracy : 0.936364 max acc epoch : 22 test accuracy : 0.940183

Epoch :  24 loss training:  6.7485929755494 Time :  172
accuracy train: 0.957988 val: 0.932727 test: 0.936986
max validation accuracy : 0.936364 max acc epoch : 22 test accuracy : 0.940183

Epoch :  25 loss training:  6.539225072134286 Time :  179
accuracy train: 0.958594 val: 0.934545 test: 0.937900
max validation accuracy : 0.936364 max acc epoch : 22 test accuracy : 0.940183

Epoch :  26 loss training:  6.596244231564924 Time :  185
accuracy train: 0.957584 val: 0.936364 test: 0.941553
max validation accuracy : 0.936364 max acc epoch : 22 test accuracy : 0.940183

Epoch :  27 loss training:  6.21188501524739 Time :  192
accuracy train: 0.958796 val: 0.934545 test: 0.937900
max validation accuracy : 0.936364 max acc epoch : 22 test accuracy : 0.940183

Epoch :  28 loss training:  6.289700471097603 Time :  200
accuracy train: 0.960816 val: 0.938182 test: 0.942922
max validation accuracy : 0.938182 max acc epoch : 28 test accuracy : 0.942922

Epoch :  29 loss training:  6.46228814846836 Time :  207
accuracy train: 0.960412 val: 0.936364 test: 0.942009
max validation accuracy : 0.938182 max acc epoch : 28 test accuracy : 0.942922

Epoch :  30 loss training:  6.070203657029197 Time :  214
accuracy train: 0.958998 val: 0.934545 test: 0.937443
max validation accuracy : 0.938182 max acc epoch : 28 test accuracy : 0.942922

Epoch :  31 loss training:  5.99365736474283 Time :  221
accuracy train: 0.960614 val: 0.938182 test: 0.942466
max validation accuracy : 0.938182 max acc epoch : 28 test accuracy : 0.942922

Epoch :  32 loss training:  6.407665462465957 Time :  228
accuracy train: 0.957786 val: 0.936364 test: 0.939269
max validation accuracy : 0.938182 max acc epoch : 28 test accuracy : 0.942922

Epoch :  33 loss training:  6.697766879806295 Time :  234
accuracy train: 0.958796 val: 0.936364 test: 0.941096
max validation accuracy : 0.938182 max acc epoch : 28 test accuracy : 0.942922

Epoch :  34 loss training:  6.6527993669733405 Time :  241
accuracy train: 0.960412 val: 0.936364 test: 0.940183
max validation accuracy : 0.938182 max acc epoch : 28 test accuracy : 0.942922

Epoch :  35 loss training:  6.084443703992292 Time :  248
accuracy train: 0.960412 val: 0.934545 test: 0.941096
max validation accuracy : 0.938182 max acc epoch : 28 test accuracy : 0.942922

Epoch :  36 loss training:  6.08273148862645 Time :  255
accuracy train: 0.961018 val: 0.938182 test: 0.940639
max validation accuracy : 0.938182 max acc epoch : 28 test accuracy : 0.942922

Epoch :  37 loss training:  6.248409480089322 Time :  262
accuracy train: 0.960008 val: 0.938182 test: 0.942466
max validation accuracy : 0.938182 max acc epoch : 28 test accuracy : 0.942922

Epoch :  38 loss training:  6.0917962128296494 Time :  269
accuracy train: 0.961220 val: 0.938182 test: 0.941096
max validation accuracy : 0.938182 max acc epoch : 28 test accuracy : 0.942922

Epoch :  39 loss training:  5.922347912564874 Time :  276
accuracy train: 0.960614 val: 0.938182 test: 0.940183
max validation accuracy : 0.938182 max acc epoch : 28 test accuracy : 0.942922

Epoch :  40 loss training:  6.2209346909075975 Time :  282
accuracy train: 0.960816 val: 0.940000 test: 0.942009
max validation accuracy : 0.940000 max acc epoch : 40 test accuracy : 0.942009

Epoch :  41 loss training:  6.08869724906981 Time :  288
accuracy train: 0.959402 val: 0.936364 test: 0.938356
max validation accuracy : 0.940000 max acc epoch : 40 test accuracy : 0.942009

Epoch :  42 loss training:  6.3311147356871516 Time :  293
accuracy train: 0.961422 val: 0.938182 test: 0.939269
max validation accuracy : 0.940000 max acc epoch : 40 test accuracy : 0.942009

Epoch :  43 loss training:  6.397223107051104 Time :  299
accuracy train: 0.962028 val: 0.938182 test: 0.942009
max validation accuracy : 0.940000 max acc epoch : 40 test accuracy : 0.942009

Epoch :  44 loss training:  6.307905076304451 Time :  305
accuracy train: 0.958998 val: 0.936364 test: 0.939269
max validation accuracy : 0.940000 max acc epoch : 40 test accuracy : 0.942009

Epoch :  45 loss training:  5.928047445602715 Time :  310
accuracy train: 0.959604 val: 0.936364 test: 0.940639
max validation accuracy : 0.940000 max acc epoch : 40 test accuracy : 0.942009

Epoch :  46 loss training:  5.968285993672907 Time :  316
accuracy train: 0.961220 val: 0.934545 test: 0.938356
max validation accuracy : 0.940000 max acc epoch : 40 test accuracy : 0.942009

Epoch :  47 loss training:  6.267609633505344 Time :  322
accuracy train: 0.961826 val: 0.938182 test: 0.939726
max validation accuracy : 0.940000 max acc epoch : 40 test accuracy : 0.942009

Epoch :  48 loss training:  6.404497364535928 Time :  329
accuracy train: 0.960412 val: 0.938182 test: 0.941553
max validation accuracy : 0.940000 max acc epoch : 40 test accuracy : 0.942009

Epoch :  49 loss training:  5.9017021369654685 Time :  335
accuracy train: 0.960816 val: 0.940000 test: 0.940639
max validation accuracy : 0.940000 max acc epoch : 40 test accuracy : 0.942009

Epoch :  50 loss training:  5.906313450308517 Time :  341
accuracy train: 0.962432 val: 0.941818 test: 0.943379
max validation accuracy : 0.941818 max acc epoch : 50 test accuracy : 0.943379

Epoch :  51 loss training:  6.024717519758269 Time :  348
accuracy train: 0.961422 val: 0.936364 test: 0.940639
max validation accuracy : 0.941818 max acc epoch : 50 test accuracy : 0.943379

Epoch :  52 loss training:  6.121307941386476 Time :  354
accuracy train: 0.959200 val: 0.938182 test: 0.938356
max validation accuracy : 0.941818 max acc epoch : 50 test accuracy : 0.943379

Epoch :  53 loss training:  6.038121453719214 Time :  361
accuracy train: 0.961018 val: 0.938182 test: 0.940639
max validation accuracy : 0.941818 max acc epoch : 50 test accuracy : 0.943379

Epoch :  54 loss training:  5.943542271619663 Time :  367
accuracy train: 0.960008 val: 0.934545 test: 0.938356
max validation accuracy : 0.941818 max acc epoch : 50 test accuracy : 0.943379

Epoch :  55 loss training:  6.29887406877242 Time :  374
accuracy train: 0.960008 val: 0.941818 test: 0.941553
max validation accuracy : 0.941818 max acc epoch : 50 test accuracy : 0.943379

Epoch :  56 loss training:  5.84710753057152 Time :  380
accuracy train: 0.960816 val: 0.940000 test: 0.941096
max validation accuracy : 0.941818 max acc epoch : 50 test accuracy : 0.943379

Epoch :  57 loss training:  6.483424994396046 Time :  387
accuracy train: 0.960614 val: 0.941818 test: 0.942009
max validation accuracy : 0.941818 max acc epoch : 50 test accuracy : 0.943379

Epoch :  58 loss training:  6.267897967714816 Time :  394
accuracy train: 0.961422 val: 0.940000 test: 0.942466
max validation accuracy : 0.941818 max acc epoch : 50 test accuracy : 0.943379

Epoch :  59 loss training:  6.240610972745344 Time :  401
accuracy train: 0.961220 val: 0.936364 test: 0.940639
max validation accuracy : 0.941818 max acc epoch : 50 test accuracy : 0.943379

Epoch :  60 loss training:  6.4051695093512535 Time :  407
accuracy train: 0.961624 val: 0.938182 test: 0.941096
max validation accuracy : 0.941818 max acc epoch : 50 test accuracy : 0.943379

Epoch :  61 loss training:  5.706671285443008 Time :  413
accuracy train: 0.961220 val: 0.940000 test: 0.941553
max validation accuracy : 0.941818 max acc epoch : 50 test accuracy : 0.943379

Epoch :  62 loss training:  5.319725358625874 Time :  420
accuracy train: 0.959806 val: 0.940000 test: 0.938813
max validation accuracy : 0.941818 max acc epoch : 50 test accuracy : 0.943379

Epoch :  63 loss training:  5.96586206369102 Time :  427
accuracy train: 0.958796 val: 0.940000 test: 0.939726
max validation accuracy : 0.941818 max acc epoch : 50 test accuracy : 0.943379

Epoch :  64 loss training:  6.118017488857731 Time :  433
accuracy train: 0.959200 val: 0.938182 test: 0.940639
max validation accuracy : 0.941818 max acc epoch : 50 test accuracy : 0.943379

Epoch :  65 loss training:  5.848845935892314 Time :  440
accuracy train: 0.959402 val: 0.936364 test: 0.938813
max validation accuracy : 0.941818 max acc epoch : 50 test accuracy : 0.943379

Epoch :  66 loss training:  6.103623102186248 Time :  446
accuracy train: 0.961422 val: 0.938182 test: 0.941553
max validation accuracy : 0.941818 max acc epoch : 50 test accuracy : 0.943379

Epoch :  67 loss training:  6.042527231620625 Time :  452
accuracy train: 0.960614 val: 0.938182 test: 0.941096
max validation accuracy : 0.941818 max acc epoch : 50 test accuracy : 0.943379

Epoch :  68 loss training:  6.275710239773616 Time :  459
accuracy train: 0.960816 val: 0.938182 test: 0.940183
max validation accuracy : 0.941818 max acc epoch : 50 test accuracy : 0.943379

Epoch :  69 loss training:  6.517877185484394 Time :  465
accuracy train: 0.959806 val: 0.934545 test: 0.939726
max validation accuracy : 0.941818 max acc epoch : 50 test accuracy : 0.943379

Epoch :  70 loss training:  5.92489585489966 Time :  471
accuracy train: 0.959604 val: 0.936364 test: 0.941096
max validation accuracy : 0.941818 max acc epoch : 50 test accuracy : 0.943379

Epoch :  71 loss training:  5.719611854990944 Time :  477
accuracy train: 0.960412 val: 0.936364 test: 0.938813
max validation accuracy : 0.941818 max acc epoch : 50 test accuracy : 0.943379

========================================================================================================================================================================================================
max acc epoch :  50
max validation accuracy :  0.9418181818181818
test accuracy :  0.94337899543379
latest_test_accuracy :  0.9388127853881278
========================================================================================================================================================================================================

date and time :  Mon Mar 15 15:12:48 2021
Namespace(batch_size=128, dataset='R8', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=100, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=True, seed=0, weight_decay=1e-05)
device :  cuda:0
Counter({0: 1467, 3: 1321, 1: 1306, 2: 1251, 6: 1224, 5: 597, 7: 488, 4: 37})
HGNNModel(
  (word_embeddings): Embedding(8231, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=8, bias=True)
    (1): Linear(in_features=100, out_features=8, bias=True)
    (2): Linear(in_features=100, out_features=8, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  67.76057040691376 Time :  14
accuracy train: 0.725510 val: 0.720000 test: 0.718265
max validation accuracy : 0.720000 max acc epoch : 1 test accuracy : 0.718265

Epoch :  2 loss training:  36.717696487903595 Time :  19
accuracy train: 0.855989 val: 0.820000 test: 0.851142
max validation accuracy : 0.820000 max acc epoch : 2 test accuracy : 0.851142

Epoch :  3 loss training:  25.435674637556076 Time :  24
accuracy train: 0.893153 val: 0.847273 test: 0.873973
max validation accuracy : 0.847273 max acc epoch : 3 test accuracy : 0.873973

Epoch :  4 loss training:  19.160516776144505 Time :  29
accuracy train: 0.902040 val: 0.860000 test: 0.888584
max validation accuracy : 0.860000 max acc epoch : 4 test accuracy : 0.888584

Epoch :  5 loss training:  15.636020246893167 Time :  34
accuracy train: 0.919410 val: 0.880000 test: 0.910959
max validation accuracy : 0.880000 max acc epoch : 5 test accuracy : 0.910959

Epoch :  6 loss training:  11.425719127990305 Time :  39
accuracy train: 0.923248 val: 0.885455 test: 0.917808
max validation accuracy : 0.885455 max acc epoch : 6 test accuracy : 0.917808

Epoch :  7 loss training:  9.862950294278562 Time :  44
accuracy train: 0.933347 val: 0.890909 test: 0.921461
max validation accuracy : 0.890909 max acc epoch : 7 test accuracy : 0.921461

Epoch :  8 loss training:  9.669183808378875 Time :  49
accuracy train: 0.937588 val: 0.890909 test: 0.916895
max validation accuracy : 0.890909 max acc epoch : 7 test accuracy : 0.921461

Epoch :  9 loss training:  8.264127102680504 Time :  54
accuracy train: 0.948293 val: 0.901818 test: 0.926027
max validation accuracy : 0.901818 max acc epoch : 9 test accuracy : 0.926027

Epoch :  10 loss training:  6.84109108755365 Time :  60
accuracy train: 0.953747 val: 0.901818 test: 0.928311
max validation accuracy : 0.901818 max acc epoch : 9 test accuracy : 0.926027

Epoch :  11 loss training:  6.4897031066939235 Time :  66
accuracy train: 0.957382 val: 0.907273 test: 0.930137
max validation accuracy : 0.907273 max acc epoch : 11 test accuracy : 0.930137

Epoch :  12 loss training:  5.769357758574188 Time :  71
accuracy train: 0.960210 val: 0.914545 test: 0.931507
max validation accuracy : 0.914545 max acc epoch : 12 test accuracy : 0.931507

Epoch :  13 loss training:  5.440182735212147 Time :  77
accuracy train: 0.959806 val: 0.910909 test: 0.931050
max validation accuracy : 0.914545 max acc epoch : 12 test accuracy : 0.931507

Epoch :  14 loss training:  5.659282643115148 Time :  82
accuracy train: 0.961624 val: 0.920000 test: 0.934703
max validation accuracy : 0.920000 max acc epoch : 14 test accuracy : 0.934703

Epoch :  15 loss training:  4.748908654320985 Time :  88
accuracy train: 0.963846 val: 0.918182 test: 0.930137
max validation accuracy : 0.920000 max acc epoch : 14 test accuracy : 0.934703

Epoch :  16 loss training:  4.349407840985805 Time :  94
accuracy train: 0.966673 val: 0.920000 test: 0.932420
max validation accuracy : 0.920000 max acc epoch : 14 test accuracy : 0.934703

Epoch :  17 loss training:  4.591501525021158 Time :  99
accuracy train: 0.968087 val: 0.918182 test: 0.935160
max validation accuracy : 0.920000 max acc epoch : 14 test accuracy : 0.934703

Epoch :  18 loss training:  4.104032772476785 Time :  104
accuracy train: 0.968289 val: 0.920000 test: 0.933333
max validation accuracy : 0.920000 max acc epoch : 14 test accuracy : 0.934703

Epoch :  19 loss training:  4.161969795357436 Time :  110
accuracy train: 0.970107 val: 0.918182 test: 0.934247
max validation accuracy : 0.920000 max acc epoch : 14 test accuracy : 0.934703

Epoch :  20 loss training:  3.8315838953712955 Time :  115
accuracy train: 0.970713 val: 0.920000 test: 0.936073
max validation accuracy : 0.920000 max acc epoch : 14 test accuracy : 0.934703

Epoch :  21 loss training:  3.91592253302224 Time :  121
accuracy train: 0.968289 val: 0.918182 test: 0.931963
max validation accuracy : 0.920000 max acc epoch : 14 test accuracy : 0.934703

Epoch :  22 loss training:  3.7754064076580107 Time :  126
accuracy train: 0.968895 val: 0.918182 test: 0.932877
max validation accuracy : 0.920000 max acc epoch : 14 test accuracy : 0.934703

Epoch :  23 loss training:  3.909478193963878 Time :  131
accuracy train: 0.973541 val: 0.923636 test: 0.936986
max validation accuracy : 0.923636 max acc epoch : 23 test accuracy : 0.936986

Epoch :  24 loss training:  3.556504065869376 Time :  137
accuracy train: 0.972127 val: 0.920000 test: 0.935616
max validation accuracy : 0.923636 max acc epoch : 23 test accuracy : 0.936986

Epoch :  25 loss training:  3.9127591396681964 Time :  142
accuracy train: 0.974349 val: 0.923636 test: 0.936986
max validation accuracy : 0.923636 max acc epoch : 23 test accuracy : 0.936986

Epoch :  26 loss training:  3.60569628351368 Time :  147
accuracy train: 0.973339 val: 0.921818 test: 0.936530
max validation accuracy : 0.923636 max acc epoch : 23 test accuracy : 0.936986

Epoch :  27 loss training:  4.008575887419283 Time :  153
accuracy train: 0.975359 val: 0.923636 test: 0.938813
max validation accuracy : 0.923636 max acc epoch : 23 test accuracy : 0.936986

Epoch :  28 loss training:  4.094932651089039 Time :  159
accuracy train: 0.975560 val: 0.925455 test: 0.936073
max validation accuracy : 0.925455 max acc epoch : 28 test accuracy : 0.936073

Epoch :  29 loss training:  3.2758943219669163 Time :  164
accuracy train: 0.975964 val: 0.925455 test: 0.938813
max validation accuracy : 0.925455 max acc epoch : 28 test accuracy : 0.936073

Epoch :  30 loss training:  4.947571313881781 Time :  169
accuracy train: 0.978994 val: 0.929091 test: 0.943379
max validation accuracy : 0.929091 max acc epoch : 30 test accuracy : 0.943379

Epoch :  31 loss training:  3.701756870606914 Time :  174
accuracy train: 0.977176 val: 0.929091 test: 0.939726
max validation accuracy : 0.929091 max acc epoch : 30 test accuracy : 0.943379

Epoch :  32 loss training:  3.439790199394338 Time :  180
accuracy train: 0.974551 val: 0.923636 test: 0.936986
max validation accuracy : 0.929091 max acc epoch : 30 test accuracy : 0.943379

Epoch :  33 loss training:  3.6982823327416554 Time :  185
accuracy train: 0.975964 val: 0.923636 test: 0.939726
max validation accuracy : 0.929091 max acc epoch : 30 test accuracy : 0.943379

Epoch :  34 loss training:  3.365430219681002 Time :  191
accuracy train: 0.976772 val: 0.923636 test: 0.936986
max validation accuracy : 0.929091 max acc epoch : 30 test accuracy : 0.943379

Epoch :  35 loss training:  3.737432145222556 Time :  196
accuracy train: 0.977580 val: 0.930909 test: 0.940183
max validation accuracy : 0.930909 max acc epoch : 35 test accuracy : 0.940183

Epoch :  36 loss training:  3.47469923022436 Time :  202
accuracy train: 0.975359 val: 0.929091 test: 0.936986
max validation accuracy : 0.930909 max acc epoch : 35 test accuracy : 0.940183

Epoch :  37 loss training:  3.2823318668524735 Time :  207
accuracy train: 0.977580 val: 0.929091 test: 0.939269
max validation accuracy : 0.930909 max acc epoch : 35 test accuracy : 0.940183

Epoch :  38 loss training:  3.9132173229008913 Time :  213
accuracy train: 0.976368 val: 0.929091 test: 0.936986
max validation accuracy : 0.930909 max acc epoch : 35 test accuracy : 0.940183

Epoch :  39 loss training:  3.626063600066118 Time :  218
accuracy train: 0.976166 val: 0.927273 test: 0.937900
max validation accuracy : 0.930909 max acc epoch : 35 test accuracy : 0.940183

Epoch :  40 loss training:  3.7653481574961916 Time :  223
accuracy train: 0.975762 val: 0.930909 test: 0.940183
max validation accuracy : 0.930909 max acc epoch : 35 test accuracy : 0.940183

Epoch :  41 loss training:  4.154883237730246 Time :  228
accuracy train: 0.976772 val: 0.925455 test: 0.938813
max validation accuracy : 0.930909 max acc epoch : 35 test accuracy : 0.940183

Epoch :  42 loss training:  3.286256080842577 Time :  233
accuracy train: 0.977378 val: 0.930909 test: 0.939726
max validation accuracy : 0.930909 max acc epoch : 35 test accuracy : 0.940183

Epoch :  43 loss training:  3.642513000755571 Time :  238
accuracy train: 0.976772 val: 0.927273 test: 0.937443
max validation accuracy : 0.930909 max acc epoch : 35 test accuracy : 0.940183

Epoch :  44 loss training:  3.1783358221291564 Time :  243
accuracy train: 0.978388 val: 0.927273 test: 0.941096
max validation accuracy : 0.930909 max acc epoch : 35 test accuracy : 0.940183

Epoch :  45 loss training:  3.3477953339461237 Time :  248
accuracy train: 0.977984 val: 0.930909 test: 0.940183
max validation accuracy : 0.930909 max acc epoch : 35 test accuracy : 0.940183

Epoch :  46 loss training:  3.1798117078724317 Time :  253
accuracy train: 0.975560 val: 0.927273 test: 0.938356
max validation accuracy : 0.930909 max acc epoch : 35 test accuracy : 0.940183

Epoch :  47 loss training:  3.1708469719742425 Time :  258
accuracy train: 0.975560 val: 0.930909 test: 0.938356
max validation accuracy : 0.930909 max acc epoch : 35 test accuracy : 0.940183

Epoch :  48 loss training:  3.087061715312302 Time :  263
accuracy train: 0.977378 val: 0.927273 test: 0.937900
max validation accuracy : 0.930909 max acc epoch : 35 test accuracy : 0.940183

Epoch :  49 loss training:  3.4183463532244787 Time :  269
accuracy train: 0.976772 val: 0.930909 test: 0.939269
max validation accuracy : 0.930909 max acc epoch : 35 test accuracy : 0.940183

Epoch :  50 loss training:  3.386993568157777 Time :  274
accuracy train: 0.975762 val: 0.930909 test: 0.937900
max validation accuracy : 0.930909 max acc epoch : 35 test accuracy : 0.940183

Epoch :  51 loss training:  3.2011525676352903 Time :  280
accuracy train: 0.977378 val: 0.925455 test: 0.937900
max validation accuracy : 0.930909 max acc epoch : 35 test accuracy : 0.940183

Epoch :  52 loss training:  3.3774181659682654 Time :  285
accuracy train: 0.976166 val: 0.923636 test: 0.936986
max validation accuracy : 0.930909 max acc epoch : 35 test accuracy : 0.940183

Epoch :  53 loss training:  3.5610660433303565 Time :  291
accuracy train: 0.975762 val: 0.925455 test: 0.937443
max validation accuracy : 0.930909 max acc epoch : 35 test accuracy : 0.940183

Epoch :  54 loss training:  3.864240210445132 Time :  297
accuracy train: 0.975157 val: 0.927273 test: 0.936986
max validation accuracy : 0.930909 max acc epoch : 35 test accuracy : 0.940183

Epoch :  55 loss training:  3.312295970856212 Time :  302
accuracy train: 0.976570 val: 0.925455 test: 0.937443
max validation accuracy : 0.930909 max acc epoch : 35 test accuracy : 0.940183

Epoch :  56 loss training:  3.311862717149779 Time :  307
accuracy train: 0.977176 val: 0.930909 test: 0.939269
max validation accuracy : 0.930909 max acc epoch : 35 test accuracy : 0.940183

========================================================================================================================================================================================================
max acc epoch :  35
max validation accuracy :  0.9309090909090909
test accuracy :  0.9401826484018265
latest_test_accuracy :  0.9392694063926941
========================================================================================================================================================================================================

