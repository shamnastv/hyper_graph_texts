

date and time :  Sat Jun  5 18:46:43 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=0, num_layers=3, num_mlp_layers=1, random_vec=False, seed=632, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  206.7289183139801 Time :  44
accuracy train: 0.661482 val: 0.605970 test: 0.612169
max validation accuracy : 0.605970 max acc epoch : 1 test accuracy : 0.612169
Epoch-1 lr: 0.001

Epoch :  2 loss training:  138.80021288990974 Time :  56
accuracy train: 0.716744 val: 0.647761 test: 0.646550
max validation accuracy : 0.647761 max acc epoch : 2 test accuracy : 0.646550
Epoch-2 lr: 0.001

Epoch :  3 loss training:  122.75627911090851 Time :  68
accuracy train: 0.774322 val: 0.662687 test: 0.673262
max validation accuracy : 0.662687 max acc epoch : 3 test accuracy : 0.673262
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  94.70631083846092 Time :  79
accuracy train: 0.819656 val: 0.695522 test: 0.699728
max validation accuracy : 0.695522 max acc epoch : 4 test accuracy : 0.699728
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  84.6129324734211 Time :  91
accuracy train: 0.829583 val: 0.701493 test: 0.704675
max validation accuracy : 0.701493 max acc epoch : 5 test accuracy : 0.704675
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  78.93610449135303 Time :  102
accuracy train: 0.843812 val: 0.677612 test: 0.709374
max validation accuracy : 0.701493 max acc epoch : 5 test accuracy : 0.704675
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  68.48776054382324 Time :  114
accuracy train: 0.876241 val: 0.707463 test: 0.718279
max validation accuracy : 0.707463 max acc epoch : 7 test accuracy : 0.718279
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.33289089798927 Time :  126
accuracy train: 0.892124 val: 0.707463 test: 0.720257
max validation accuracy : 0.707463 max acc epoch : 7 test accuracy : 0.718279
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  58.75036084651947 Time :  137
accuracy train: 0.905030 val: 0.713433 test: 0.717536
max validation accuracy : 0.713433 max acc epoch : 9 test accuracy : 0.717536
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  55.092101112008095 Time :  149
accuracy train: 0.909662 val: 0.704478 test: 0.726441
max validation accuracy : 0.713433 max acc epoch : 9 test accuracy : 0.717536
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  52.1382467597723 Time :  161
accuracy train: 0.913633 val: 0.704478 test: 0.727183
max validation accuracy : 0.713433 max acc epoch : 9 test accuracy : 0.717536
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  50.85557386279106 Time :  173
accuracy train: 0.923230 val: 0.707463 test: 0.723720
max validation accuracy : 0.713433 max acc epoch : 9 test accuracy : 0.717536
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  48.602528646588326 Time :  186
accuracy train: 0.925215 val: 0.713433 test: 0.727925
max validation accuracy : 0.713433 max acc epoch : 9 test accuracy : 0.717536
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  47.18806925415993 Time :  201
accuracy train: 0.928524 val: 0.719403 test: 0.722978
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.722978
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  45.738552555441856 Time :  225
accuracy train: 0.934480 val: 0.707463 test: 0.721989
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.722978

Epoch :  16 loss training:  46.81054636836052 Time :  239
accuracy train: 0.937790 val: 0.698507 test: 0.718279
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.722978

Epoch :  17 loss training:  44.564554661512375 Time :  252
accuracy train: 0.943415 val: 0.704478 test: 0.724215
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.722978

Epoch :  18 loss training:  43.56681017577648 Time :  265
accuracy train: 0.946393 val: 0.707463 test: 0.724957
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.722978

Epoch :  19 loss training:  40.123286448419094 Time :  278
accuracy train: 0.947717 val: 0.713433 test: 0.727925
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.722978

Epoch :  20 loss training:  41.05200469493866 Time :  292
accuracy train: 0.952349 val: 0.704478 test: 0.720257
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.722978

Epoch :  21 loss training:  39.06301321089268 Time :  305
accuracy train: 0.958306 val: 0.704478 test: 0.724709
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.722978

Epoch :  22 loss training:  37.573051154613495 Time :  318
accuracy train: 0.960622 val: 0.716418 test: 0.724462
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.722978

Epoch :  23 loss training:  35.586160987615585 Time :  331
accuracy train: 0.962277 val: 0.716418 test: 0.721741
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.722978

Epoch :  24 loss training:  36.22162286192179 Time :  344
accuracy train: 0.967571 val: 0.707463 test: 0.725946
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.722978

Epoch :  25 loss training:  33.792211830616 Time :  358
accuracy train: 0.967571 val: 0.710448 test: 0.719268
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.722978

Epoch :  26 loss training:  34.485912799835205 Time :  371
accuracy train: 0.971542 val: 0.710448 test: 0.721247
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.722978

Epoch :  27 loss training:  31.402063973248005 Time :  383
accuracy train: 0.974189 val: 0.710448 test: 0.725946
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.722978

Epoch :  28 loss training:  31.51239936426282 Time :  396
accuracy train: 0.977167 val: 0.701493 test: 0.724957
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.722978

Epoch :  29 loss training:  30.594499982893467 Time :  410
accuracy train: 0.978160 val: 0.716418 test: 0.725699
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.722978

Epoch :  30 loss training:  29.266633678227663 Time :  423
accuracy train: 0.977829 val: 0.716418 test: 0.729162
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.722978

Epoch :  31 loss training:  28.936229273676872 Time :  436
accuracy train: 0.979484 val: 0.707463 test: 0.723720
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.722978

Epoch :  32 loss training:  26.854754224419594 Time :  450
accuracy train: 0.982462 val: 0.728358 test: 0.726688
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  33 loss training:  25.757401645183563 Time :  463
accuracy train: 0.982131 val: 0.707463 test: 0.724957
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  34 loss training:  24.830381110310555 Time :  476
accuracy train: 0.984778 val: 0.710448 test: 0.725946
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  35 loss training:  24.64227293431759 Time :  489
accuracy train: 0.989411 val: 0.716418 test: 0.724215
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  36 loss training:  23.06862512975931 Time :  502
accuracy train: 0.987756 val: 0.713433 test: 0.722978
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  37 loss training:  23.69947959855199 Time :  516
accuracy train: 0.988087 val: 0.716418 test: 0.727183
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  38 loss training:  21.734255772083998 Time :  536
accuracy train: 0.991066 val: 0.725373 test: 0.726441
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  39 loss training:  21.660692181438208 Time :  555
accuracy train: 0.991066 val: 0.716418 test: 0.725699
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  40 loss training:  19.095493335276842 Time :  569
accuracy train: 0.991727 val: 0.710448 test: 0.726193
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  41 loss training:  19.830047234892845 Time :  583
accuracy train: 0.994044 val: 0.713433 test: 0.724709
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  42 loss training:  18.353833347558975 Time :  604
accuracy train: 0.992720 val: 0.704478 test: 0.726441
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  43 loss training:  17.70593653805554 Time :  617
accuracy train: 0.995698 val: 0.707463 test: 0.725451
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  44 loss training:  16.71281891874969 Time :  633
accuracy train: 0.995036 val: 0.707463 test: 0.728667
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  45 loss training:  17.107543375343084 Time :  648
accuracy train: 0.995036 val: 0.701493 test: 0.726688
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  46 loss training:  16.43766599521041 Time :  662
accuracy train: 0.997022 val: 0.710448 test: 0.727430
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  47 loss training:  14.598604012280703 Time :  680
accuracy train: 0.997022 val: 0.710448 test: 0.726935
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  48 loss training:  15.105892699211836 Time :  693
accuracy train: 0.997353 val: 0.719403 test: 0.721741
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  49 loss training:  14.93161365389824 Time :  710
accuracy train: 0.998345 val: 0.707463 test: 0.724957
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  50 loss training:  13.996487176045775 Time :  723
accuracy train: 0.998015 val: 0.713433 test: 0.730151
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  51 loss training:  14.117413191124797 Time :  740
accuracy train: 0.998676 val: 0.710448 test: 0.729409
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  52 loss training:  12.978651698678732 Time :  755
accuracy train: 0.998676 val: 0.716418 test: 0.726441
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  53 loss training:  13.055488642305136 Time :  769
accuracy train: 0.999007 val: 0.707463 test: 0.726935
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  54 loss training:  12.003831703215837 Time :  785
accuracy train: 0.999338 val: 0.698507 test: 0.727183
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  55 loss training:  11.557507755234838 Time :  799
accuracy train: 0.999007 val: 0.707463 test: 0.729162
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  56 loss training:  11.878658793866634 Time :  812
accuracy train: 0.999007 val: 0.713433 test: 0.731388
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  57 loss training:  10.495600970461965 Time :  826
accuracy train: 0.999007 val: 0.707463 test: 0.730151
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  58 loss training:  10.95816428028047 Time :  839
accuracy train: 0.999007 val: 0.716418 test: 0.729162
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  59 loss training:  10.86023620981723 Time :  853
accuracy train: 0.999338 val: 0.719403 test: 0.723720
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  60 loss training:  10.31576612778008 Time :  867
accuracy train: 0.999338 val: 0.704478 test: 0.726688
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  61 loss training:  8.714841598644853 Time :  880
accuracy train: 0.999669 val: 0.716418 test: 0.728667
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  62 loss training:  8.879222652874887 Time :  893
accuracy train: 0.999669 val: 0.707463 test: 0.725204
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

Epoch :  63 loss training:  8.834728641435504 Time :  907
accuracy train: 1.000000 val: 0.713433 test: 0.723967
max validation accuracy : 0.728358 max acc epoch : 32 test accuracy : 0.726688

========================================================================================================================================================================================================
max acc epoch :  32
max validation accuracy :  0.7283582089552239
test accuracy :  0.7266881028938906
last test_accuracy :  0.7239673509769973
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=0, num_layers=3, num_mlp_layers=1, random_vec=False, seed=632, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  206.83018797636032 Time :  933
accuracy train: 0.655526 val: 0.605970 test: 0.613159
max validation accuracy : 0.605970 max acc epoch : 1 test accuracy : 0.613159
Epoch-1 lr: 0.001

Epoch :  2 loss training:  138.8114149570465 Time :  946
accuracy train: 0.721707 val: 0.644776 test: 0.649023
max validation accuracy : 0.644776 max acc epoch : 2 test accuracy : 0.649023
Epoch-2 lr: 0.001

Epoch :  3 loss training:  122.87876015901566 Time :  960
accuracy train: 0.776307 val: 0.671642 test: 0.671778
max validation accuracy : 0.671642 max acc epoch : 3 test accuracy : 0.671778
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  94.78480038046837 Time :  974
accuracy train: 0.821310 val: 0.689552 test: 0.699975
max validation accuracy : 0.689552 max acc epoch : 4 test accuracy : 0.699975
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  84.21974620223045 Time :  987
accuracy train: 0.827267 val: 0.692537 test: 0.699975
max validation accuracy : 0.692537 max acc epoch : 5 test accuracy : 0.699975
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.2741963416338 Time :  1000
accuracy train: 0.841165 val: 0.680597 test: 0.709374
max validation accuracy : 0.692537 max acc epoch : 5 test accuracy : 0.699975
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  68.35127955675125 Time :  1013
accuracy train: 0.874586 val: 0.704478 test: 0.715558
max validation accuracy : 0.704478 max acc epoch : 7 test accuracy : 0.715558
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.34827998280525 Time :  1026
accuracy train: 0.888484 val: 0.710448 test: 0.721247
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.721247
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  58.64724577963352 Time :  1039
accuracy train: 0.906023 val: 0.722388 test: 0.716794
max validation accuracy : 0.722388 max acc epoch : 9 test accuracy : 0.716794
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  54.822489723563194 Time :  1053
accuracy train: 0.910986 val: 0.710448 test: 0.723967
max validation accuracy : 0.722388 max acc epoch : 9 test accuracy : 0.716794
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  52.40358440577984 Time :  1066
accuracy train: 0.914626 val: 0.707463 test: 0.724709
max validation accuracy : 0.722388 max acc epoch : 9 test accuracy : 0.716794
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  51.0113790333271 Time :  1079
accuracy train: 0.924222 val: 0.713433 test: 0.720505
max validation accuracy : 0.722388 max acc epoch : 9 test accuracy : 0.716794
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  48.349397622048855 Time :  1091
accuracy train: 0.925877 val: 0.722388 test: 0.728172
max validation accuracy : 0.722388 max acc epoch : 9 test accuracy : 0.716794
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  46.95171843469143 Time :  1104
accuracy train: 0.928524 val: 0.728358 test: 0.726193
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  45.91737765073776 Time :  1117
accuracy train: 0.935804 val: 0.716418 test: 0.724957
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  16 loss training:  47.072847470641136 Time :  1130
accuracy train: 0.936797 val: 0.713433 test: 0.720505
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  17 loss training:  44.810892537236214 Time :  1144
accuracy train: 0.940437 val: 0.704478 test: 0.726441
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  18 loss training:  43.821128606796265 Time :  1157
accuracy train: 0.944077 val: 0.719403 test: 0.726193
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  19 loss training:  39.90951284766197 Time :  1172
accuracy train: 0.948379 val: 0.713433 test: 0.727183
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  20 loss training:  40.96374653279781 Time :  1186
accuracy train: 0.950033 val: 0.695522 test: 0.722236
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  21 loss training:  38.843198113143444 Time :  1199
accuracy train: 0.957313 val: 0.710448 test: 0.724215
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  22 loss training:  37.79001180827618 Time :  1213
accuracy train: 0.961284 val: 0.722388 test: 0.724957
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  23 loss training:  35.809480145573616 Time :  1226
accuracy train: 0.961946 val: 0.716418 test: 0.723225
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  24 loss training:  35.94048694521189 Time :  1240
accuracy train: 0.967571 val: 0.704478 test: 0.724709
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  25 loss training:  33.809627160429955 Time :  1253
accuracy train: 0.968564 val: 0.713433 test: 0.724215
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  26 loss training:  34.67477536201477 Time :  1266
accuracy train: 0.971211 val: 0.707463 test: 0.720505
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  27 loss training:  31.66952434927225 Time :  1280
accuracy train: 0.973197 val: 0.719403 test: 0.730151
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  28 loss training:  31.441286716610193 Time :  1293
accuracy train: 0.976506 val: 0.689552 test: 0.724215
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  29 loss training:  30.480165846645832 Time :  1306
accuracy train: 0.977167 val: 0.710448 test: 0.727925
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  30 loss training:  29.516631051898003 Time :  1320
accuracy train: 0.977498 val: 0.719403 test: 0.727430
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  31 loss training:  28.69310224801302 Time :  1334
accuracy train: 0.980477 val: 0.719403 test: 0.725946
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  32 loss training:  26.973932839930058 Time :  1348
accuracy train: 0.983455 val: 0.716418 test: 0.729656
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  33 loss training:  25.924942769110203 Time :  1361
accuracy train: 0.980807 val: 0.713433 test: 0.725946
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  34 loss training:  24.47762132436037 Time :  1375
accuracy train: 0.986433 val: 0.713433 test: 0.724957
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  35 loss training:  24.53136370703578 Time :  1388
accuracy train: 0.988418 val: 0.719403 test: 0.723967
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  36 loss training:  22.743465203791857 Time :  1401
accuracy train: 0.987095 val: 0.707463 test: 0.723473
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  37 loss training:  23.43088698014617 Time :  1415
accuracy train: 0.988418 val: 0.716418 test: 0.728419
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  38 loss training:  21.658978141844273 Time :  1429
accuracy train: 0.989411 val: 0.725373 test: 0.724709
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  39 loss training:  21.534117329865694 Time :  1442
accuracy train: 0.990073 val: 0.713433 test: 0.725946
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  40 loss training:  19.210284989327192 Time :  1461
accuracy train: 0.991727 val: 0.713433 test: 0.724957
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  41 loss training:  19.441990710794926 Time :  1486
accuracy train: 0.993051 val: 0.707463 test: 0.725699
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  42 loss training:  18.190255032852292 Time :  1500
accuracy train: 0.993051 val: 0.701493 test: 0.729409
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  43 loss training:  17.537967298179865 Time :  1513
accuracy train: 0.995367 val: 0.701493 test: 0.726688
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  44 loss training:  17.083831628784537 Time :  1526
accuracy train: 0.995036 val: 0.698507 test: 0.726688
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

Epoch :  45 loss training:  16.959390353411436 Time :  1539
accuracy train: 0.995036 val: 0.704478 test: 0.726441
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.726193

========================================================================================================================================================================================================
max acc epoch :  14
max validation accuracy :  0.7283582089552239
test accuracy :  0.7261934207271827
last test_accuracy :  0.7264407618105367
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=0, num_layers=3, num_mlp_layers=1, random_vec=False, seed=632, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  206.7400268316269 Time :  1568
accuracy train: 0.658173 val: 0.594030 test: 0.613653
max validation accuracy : 0.594030 max acc epoch : 1 test accuracy : 0.613653
Epoch-1 lr: 0.001

Epoch :  2 loss training:  138.8440262079239 Time :  1581
accuracy train: 0.717406 val: 0.647761 test: 0.652980
max validation accuracy : 0.647761 max acc epoch : 2 test accuracy : 0.652980
Epoch-2 lr: 0.001

Epoch :  3 loss training:  123.14358040690422 Time :  1594
accuracy train: 0.777631 val: 0.671642 test: 0.675488
max validation accuracy : 0.671642 max acc epoch : 3 test accuracy : 0.675488
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  94.2952252626419 Time :  1607
accuracy train: 0.823296 val: 0.686567 test: 0.701212
max validation accuracy : 0.686567 max acc epoch : 4 test accuracy : 0.701212
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  84.75086070597172 Time :  1620
accuracy train: 0.832230 val: 0.701493 test: 0.703191
max validation accuracy : 0.701493 max acc epoch : 5 test accuracy : 0.703191
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  78.84849791228771 Time :  1633
accuracy train: 0.846459 val: 0.680597 test: 0.710858
max validation accuracy : 0.701493 max acc epoch : 5 test accuracy : 0.703191
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  68.31331026554108 Time :  1646
accuracy train: 0.875910 val: 0.704478 test: 0.716547
max validation accuracy : 0.704478 max acc epoch : 7 test accuracy : 0.716547
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.14433494210243 Time :  1660
accuracy train: 0.889146 val: 0.701493 test: 0.722978
max validation accuracy : 0.704478 max acc epoch : 7 test accuracy : 0.716547
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  58.55144177377224 Time :  1673
accuracy train: 0.903044 val: 0.713433 test: 0.714321
max validation accuracy : 0.713433 max acc epoch : 9 test accuracy : 0.714321
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  54.763559982180595 Time :  1686
accuracy train: 0.909332 val: 0.710448 test: 0.728914
max validation accuracy : 0.713433 max acc epoch : 9 test accuracy : 0.714321
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  52.06968481838703 Time :  1699
accuracy train: 0.912972 val: 0.695522 test: 0.724462
max validation accuracy : 0.713433 max acc epoch : 9 test accuracy : 0.714321
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  50.862001553177834 Time :  1711
accuracy train: 0.925546 val: 0.707463 test: 0.726688
max validation accuracy : 0.713433 max acc epoch : 9 test accuracy : 0.714321
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  48.01296006143093 Time :  1724
accuracy train: 0.925877 val: 0.707463 test: 0.728667
max validation accuracy : 0.713433 max acc epoch : 9 test accuracy : 0.714321
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  46.99490536749363 Time :  1738
accuracy train: 0.928193 val: 0.719403 test: 0.727183
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  45.32683564722538 Time :  1750
accuracy train: 0.935473 val: 0.713433 test: 0.724462
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  16 loss training:  46.55793118476868 Time :  1764
accuracy train: 0.935804 val: 0.701493 test: 0.721989
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  17 loss training:  44.52552282810211 Time :  1782
accuracy train: 0.942091 val: 0.704478 test: 0.727183
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  18 loss training:  43.232366964221 Time :  1805
accuracy train: 0.943084 val: 0.713433 test: 0.726441
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  19 loss training:  39.66914267838001 Time :  1822
accuracy train: 0.947717 val: 0.710448 test: 0.727430
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  20 loss training:  40.92800993472338 Time :  1835
accuracy train: 0.954997 val: 0.695522 test: 0.723225
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  21 loss training:  38.61739153414965 Time :  1853
accuracy train: 0.959960 val: 0.701493 test: 0.726688
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  22 loss training:  37.69315093755722 Time :  1868
accuracy train: 0.961284 val: 0.719403 test: 0.721494
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  23 loss training:  35.511314176023006 Time :  1886
accuracy train: 0.962277 val: 0.698507 test: 0.724462
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  24 loss training:  35.94788797199726 Time :  1907
accuracy train: 0.967240 val: 0.692537 test: 0.728914
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  25 loss training:  33.567443646490574 Time :  1921
accuracy train: 0.969226 val: 0.701493 test: 0.725451
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  26 loss training:  34.12561800330877 Time :  1942
accuracy train: 0.969887 val: 0.704478 test: 0.723720
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  27 loss training:  31.459011659026146 Time :  1957
accuracy train: 0.974520 val: 0.704478 test: 0.729162
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  28 loss training:  30.973184574395418 Time :  1976
accuracy train: 0.977167 val: 0.695522 test: 0.730151
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  29 loss training:  30.297332905232906 Time :  1990
accuracy train: 0.979153 val: 0.701493 test: 0.727430
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  30 loss training:  29.129283741116524 Time :  2008
accuracy train: 0.977498 val: 0.719403 test: 0.731140
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  31 loss training:  28.981013238430023 Time :  2023
accuracy train: 0.981800 val: 0.695522 test: 0.727925
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  32 loss training:  26.328915171325207 Time :  2041
accuracy train: 0.983786 val: 0.716418 test: 0.729162
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  33 loss training:  25.619314769282937 Time :  2057
accuracy train: 0.982462 val: 0.704478 test: 0.726935
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  34 loss training:  24.673035636544228 Time :  2071
accuracy train: 0.987426 val: 0.704478 test: 0.726441
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  35 loss training:  24.17976503074169 Time :  2086
accuracy train: 0.989411 val: 0.713433 test: 0.725946
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  36 loss training:  22.62053620070219 Time :  2099
accuracy train: 0.988087 val: 0.710448 test: 0.726441
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  37 loss training:  23.043077923357487 Time :  2114
accuracy train: 0.989411 val: 0.716418 test: 0.731388
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  38 loss training:  21.567982219159603 Time :  2128
accuracy train: 0.990404 val: 0.716418 test: 0.728172
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  39 loss training:  21.16416411474347 Time :  2142
accuracy train: 0.991066 val: 0.716418 test: 0.728172
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  40 loss training:  18.989247251302004 Time :  2157
accuracy train: 0.992389 val: 0.707463 test: 0.726441
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  41 loss training:  19.377287797629833 Time :  2171
accuracy train: 0.995036 val: 0.707463 test: 0.727677
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  42 loss training:  18.2954245749861 Time :  2186
accuracy train: 0.994044 val: 0.695522 test: 0.729656
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  43 loss training:  17.362268168479204 Time :  2200
accuracy train: 0.996029 val: 0.698507 test: 0.727183
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  44 loss training:  16.925125060603023 Time :  2214
accuracy train: 0.995367 val: 0.701493 test: 0.730151
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

Epoch :  45 loss training:  16.679339166730642 Time :  2228
accuracy train: 0.995698 val: 0.701493 test: 0.731635
max validation accuracy : 0.719403 max acc epoch : 14 test accuracy : 0.727183

========================================================================================================================================================================================================
max acc epoch :  14
max validation accuracy :  0.7194029850746269
test accuracy :  0.7271827850605985
last test_accuracy :  0.7316349245609696
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=0, num_layers=3, num_mlp_layers=1, random_vec=False, seed=632, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  206.74890542030334 Time :  2255
accuracy train: 0.657512 val: 0.600000 test: 0.611674
max validation accuracy : 0.600000 max acc epoch : 1 test accuracy : 0.611674
Epoch-1 lr: 0.001

Epoch :  2 loss training:  138.444073677063 Time :  2269
accuracy train: 0.715089 val: 0.647761 test: 0.650012
max validation accuracy : 0.647761 max acc epoch : 2 test accuracy : 0.650012
Epoch-2 lr: 0.001

Epoch :  3 loss training:  123.23864924907684 Time :  2283
accuracy train: 0.772998 val: 0.674627 test: 0.667821
max validation accuracy : 0.674627 max acc epoch : 3 test accuracy : 0.667821
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  94.46750047802925 Time :  2297
accuracy train: 0.823296 val: 0.692537 test: 0.701459
max validation accuracy : 0.692537 max acc epoch : 4 test accuracy : 0.701459
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  84.25775057077408 Time :  2311
accuracy train: 0.829252 val: 0.695522 test: 0.699233
max validation accuracy : 0.695522 max acc epoch : 5 test accuracy : 0.699233
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  78.90562488138676 Time :  2325
accuracy train: 0.839179 val: 0.677612 test: 0.710364
max validation accuracy : 0.695522 max acc epoch : 5 test accuracy : 0.699233
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  68.33606180548668 Time :  2338
accuracy train: 0.876572 val: 0.701493 test: 0.716052
max validation accuracy : 0.701493 max acc epoch : 7 test accuracy : 0.716052
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.13214766979218 Time :  2352
accuracy train: 0.889808 val: 0.710448 test: 0.721989
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.721989
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  58.512262135744095 Time :  2366
accuracy train: 0.902713 val: 0.704478 test: 0.713332
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.721989
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  54.81426644325256 Time :  2379
accuracy train: 0.910655 val: 0.704478 test: 0.724215
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.721989
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  51.80906914174557 Time :  2393
accuracy train: 0.913302 val: 0.704478 test: 0.722978
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.721989
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  51.19520080089569 Time :  2408
accuracy train: 0.922899 val: 0.704478 test: 0.724709
max validation accuracy : 0.710448 max acc epoch : 8 test accuracy : 0.721989
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  48.581106677651405 Time :  2421
accuracy train: 0.921575 val: 0.713433 test: 0.728419
max validation accuracy : 0.713433 max acc epoch : 13 test accuracy : 0.728419
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  47.10782650113106 Time :  2436
accuracy train: 0.926870 val: 0.713433 test: 0.725946
max validation accuracy : 0.713433 max acc epoch : 13 test accuracy : 0.728419
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  45.901344522833824 Time :  2450
accuracy train: 0.933488 val: 0.701493 test: 0.724957
max validation accuracy : 0.713433 max acc epoch : 13 test accuracy : 0.728419

Epoch :  16 loss training:  46.716839373111725 Time :  2466
accuracy train: 0.936466 val: 0.692537 test: 0.720505
max validation accuracy : 0.713433 max acc epoch : 13 test accuracy : 0.728419

Epoch :  17 loss training:  44.67179360985756 Time :  2481
accuracy train: 0.943415 val: 0.701493 test: 0.725946
max validation accuracy : 0.713433 max acc epoch : 13 test accuracy : 0.728419

Epoch :  18 loss training:  43.38875424861908 Time :  2495
accuracy train: 0.944408 val: 0.710448 test: 0.724957
max validation accuracy : 0.713433 max acc epoch : 13 test accuracy : 0.728419

Epoch :  19 loss training:  40.11906086653471 Time :  2509
accuracy train: 0.947055 val: 0.707463 test: 0.730893
max validation accuracy : 0.713433 max acc epoch : 13 test accuracy : 0.728419

Epoch :  20 loss training:  41.29917798936367 Time :  2524
accuracy train: 0.952019 val: 0.698507 test: 0.720010
max validation accuracy : 0.713433 max acc epoch : 13 test accuracy : 0.728419

Epoch :  21 loss training:  39.04061649739742 Time :  2538
accuracy train: 0.959298 val: 0.710448 test: 0.726193
max validation accuracy : 0.713433 max acc epoch : 13 test accuracy : 0.728419

Epoch :  22 loss training:  37.82104677706957 Time :  2552
accuracy train: 0.960622 val: 0.716418 test: 0.725946
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.725946

Epoch :  23 loss training:  35.609292186796665 Time :  2566
accuracy train: 0.961284 val: 0.707463 test: 0.724957
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.725946

Epoch :  24 loss training:  36.18781029433012 Time :  2580
accuracy train: 0.967571 val: 0.686567 test: 0.726193
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.725946

Epoch :  25 loss training:  33.77646043896675 Time :  2594
accuracy train: 0.965917 val: 0.698507 test: 0.722731
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.725946

Epoch :  26 loss training:  34.31397672742605 Time :  2608
accuracy train: 0.969226 val: 0.707463 test: 0.720505
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.725946

Epoch :  27 loss training:  31.635365277528763 Time :  2622
accuracy train: 0.975182 val: 0.713433 test: 0.728419
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.725946

Epoch :  28 loss training:  31.351658433675766 Time :  2636
accuracy train: 0.976175 val: 0.692537 test: 0.727925
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.725946

Epoch :  29 loss training:  30.701734274625778 Time :  2650
accuracy train: 0.977498 val: 0.701493 test: 0.726935
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.725946

Epoch :  30 loss training:  29.178262822329998 Time :  2664
accuracy train: 0.977167 val: 0.716418 test: 0.731635
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.725946

Epoch :  31 loss training:  28.848018929362297 Time :  2678
accuracy train: 0.979153 val: 0.707463 test: 0.725946
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.725946

Epoch :  32 loss training:  26.981564484536648 Time :  2692
accuracy train: 0.982131 val: 0.713433 test: 0.729656
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.725946

Epoch :  33 loss training:  25.818313585594296 Time :  2706
accuracy train: 0.981800 val: 0.704478 test: 0.727925
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.725946

Epoch :  34 loss training:  24.54320265352726 Time :  2720
accuracy train: 0.985440 val: 0.716418 test: 0.727430
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.725946

Epoch :  35 loss training:  24.37952433526516 Time :  2734
accuracy train: 0.988749 val: 0.716418 test: 0.723720
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.725946

Epoch :  36 loss training:  22.808861643075943 Time :  2748
accuracy train: 0.987426 val: 0.701493 test: 0.724215
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.725946

Epoch :  37 loss training:  23.563611019402742 Time :  2762
accuracy train: 0.987426 val: 0.713433 test: 0.733119
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.725946

Epoch :  38 loss training:  21.728645712137222 Time :  2776
accuracy train: 0.988749 val: 0.713433 test: 0.727925
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.725946

Epoch :  39 loss training:  21.631736665964127 Time :  2790
accuracy train: 0.990735 val: 0.710448 test: 0.726688
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.725946

Epoch :  40 loss training:  19.26020947098732 Time :  2805
accuracy train: 0.992720 val: 0.707463 test: 0.727925
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.725946

Epoch :  41 loss training:  19.75028632208705 Time :  2819
accuracy train: 0.994044 val: 0.704478 test: 0.727677
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.725946

Epoch :  42 loss training:  18.271516602486372 Time :  2838
accuracy train: 0.992720 val: 0.689552 test: 0.730646
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.725946

Epoch :  43 loss training:  17.70597008243203 Time :  2863
accuracy train: 0.994705 val: 0.695522 test: 0.727677
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.725946

Epoch :  44 loss training:  17.011745205149055 Time :  2877
accuracy train: 0.995036 val: 0.701493 test: 0.727677
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.725946

Epoch :  45 loss training:  17.02825642377138 Time :  2892
accuracy train: 0.995698 val: 0.704478 test: 0.726688
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.725946

Epoch :  46 loss training:  16.50874700024724 Time :  2906
accuracy train: 0.996691 val: 0.707463 test: 0.727925
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.725946

Epoch :  47 loss training:  14.926511906087399 Time :  2920
accuracy train: 0.997353 val: 0.701493 test: 0.729162
max validation accuracy : 0.716418 max acc epoch : 22 test accuracy : 0.725946

Epoch :  48 loss training:  15.265650307759643 Time :  2934
accuracy train: 0.997353 val: 0.719403 test: 0.724957
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  49 loss training:  15.046658767387271 Time :  2949
accuracy train: 0.998345 val: 0.707463 test: 0.725946
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  50 loss training:  14.174287898465991 Time :  2963
accuracy train: 0.998345 val: 0.707463 test: 0.729656
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  51 loss training:  13.824153296649456 Time :  2978
accuracy train: 0.998676 val: 0.707463 test: 0.727183
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  52 loss training:  12.981735546141863 Time :  2991
accuracy train: 0.999007 val: 0.704478 test: 0.728419
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  53 loss training:  13.033964129164815 Time :  3005
accuracy train: 0.999007 val: 0.704478 test: 0.730646
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  54 loss training:  11.900829877704382 Time :  3019
accuracy train: 0.999669 val: 0.701493 test: 0.731140
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  55 loss training:  11.530540389940143 Time :  3034
accuracy train: 0.999007 val: 0.704478 test: 0.730646
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  56 loss training:  12.061073498800397 Time :  3048
accuracy train: 0.998676 val: 0.707463 test: 0.734356
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  57 loss training:  10.518115257844329 Time :  3062
accuracy train: 0.999007 val: 0.695522 test: 0.733119
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  58 loss training:  10.756111197173595 Time :  3076
accuracy train: 0.998676 val: 0.704478 test: 0.728914
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  59 loss training:  10.652336358092725 Time :  3091
accuracy train: 0.999338 val: 0.713433 test: 0.730646
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  60 loss training:  10.001093924045563 Time :  3105
accuracy train: 0.999669 val: 0.710448 test: 0.730151
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  61 loss training:  8.798072500154376 Time :  3119
accuracy train: 0.999669 val: 0.713433 test: 0.732377
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  62 loss training:  8.62971960566938 Time :  3134
accuracy train: 0.999669 val: 0.698507 test: 0.729904
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  63 loss training:  8.875360353849828 Time :  3151
accuracy train: 1.000000 val: 0.704478 test: 0.727183
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  64 loss training:  8.6234928984195 Time :  3174
accuracy train: 0.999669 val: 0.716418 test: 0.726935
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  65 loss training:  8.549427448771894 Time :  3192
accuracy train: 0.999669 val: 0.707463 test: 0.726935
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  66 loss training:  7.3718096343800426 Time :  3206
accuracy train: 0.999669 val: 0.701493 test: 0.729656
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  67 loss training:  7.586384841706604 Time :  3224
accuracy train: 0.999669 val: 0.710448 test: 0.728914
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  68 loss training:  7.384491965174675 Time :  3239
accuracy train: 0.999669 val: 0.701493 test: 0.728667
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  69 loss training:  6.51097386656329 Time :  3255
accuracy train: 0.999338 val: 0.707463 test: 0.725946
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  70 loss training:  7.324445425532758 Time :  3271
accuracy train: 1.000000 val: 0.698507 test: 0.729162
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  71 loss training:  6.368619975168258 Time :  3287
accuracy train: 1.000000 val: 0.707463 test: 0.727183
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  72 loss training:  6.230261636897922 Time :  3304
accuracy train: 1.000000 val: 0.698507 test: 0.725451
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  73 loss training:  6.151825194247067 Time :  3320
accuracy train: 1.000000 val: 0.707463 test: 0.729409
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  74 loss training:  5.691358792595565 Time :  3338
accuracy train: 1.000000 val: 0.713433 test: 0.729904
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  75 loss training:  6.367379731498659 Time :  3353
accuracy train: 1.000000 val: 0.704478 test: 0.731140
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  76 loss training:  5.923869743943214 Time :  3372
accuracy train: 1.000000 val: 0.713433 test: 0.729656
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  77 loss training:  5.487440609373152 Time :  3387
accuracy train: 1.000000 val: 0.698507 test: 0.729162
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  78 loss training:  5.088763128966093 Time :  3405
accuracy train: 1.000000 val: 0.710448 test: 0.731635
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

Epoch :  79 loss training:  4.995078757870942 Time :  3419
accuracy train: 0.999669 val: 0.707463 test: 0.732130
max validation accuracy : 0.719403 max acc epoch : 48 test accuracy : 0.724957

========================================================================================================================================================================================================
max acc epoch :  48
max validation accuracy :  0.7194029850746269
test accuracy :  0.7249567153104131
last test_accuracy :  0.7321296067276775
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=0, num_layers=3, num_mlp_layers=1, random_vec=False, seed=632, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  206.76360660791397 Time :  3450
accuracy train: 0.658504 val: 0.597015 test: 0.614148
max validation accuracy : 0.597015 max acc epoch : 1 test accuracy : 0.614148
Epoch-1 lr: 0.001

Epoch :  2 loss training:  138.99490442872047 Time :  3464
accuracy train: 0.721707 val: 0.647761 test: 0.651002
max validation accuracy : 0.647761 max acc epoch : 2 test accuracy : 0.651002
Epoch-2 lr: 0.001

Epoch :  3 loss training:  122.55796658992767 Time :  3477
accuracy train: 0.779285 val: 0.668657 test: 0.668810
max validation accuracy : 0.668657 max acc epoch : 3 test accuracy : 0.668810
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  94.18445208668709 Time :  3489
accuracy train: 0.825281 val: 0.686567 test: 0.697997
max validation accuracy : 0.686567 max acc epoch : 4 test accuracy : 0.697997
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  84.03312915563583 Time :  3502
accuracy train: 0.829252 val: 0.701493 test: 0.702943
max validation accuracy : 0.701493 max acc epoch : 5 test accuracy : 0.702943
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  78.75077502429485 Time :  3517
accuracy train: 0.843812 val: 0.689552 test: 0.711848
max validation accuracy : 0.701493 max acc epoch : 5 test accuracy : 0.702943
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  68.59010156989098 Time :  3531
accuracy train: 0.877234 val: 0.704478 test: 0.719515
max validation accuracy : 0.704478 max acc epoch : 7 test accuracy : 0.719515
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.38774828612804 Time :  3544
accuracy train: 0.887492 val: 0.707463 test: 0.722483
max validation accuracy : 0.707463 max acc epoch : 8 test accuracy : 0.722483
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  58.4526409804821 Time :  3556
accuracy train: 0.906023 val: 0.710448 test: 0.719021
max validation accuracy : 0.710448 max acc epoch : 9 test accuracy : 0.719021
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  54.74277248978615 Time :  3568
accuracy train: 0.911648 val: 0.713433 test: 0.727183
max validation accuracy : 0.713433 max acc epoch : 10 test accuracy : 0.727183
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  51.9185366332531 Time :  3581
accuracy train: 0.914626 val: 0.695522 test: 0.728667
max validation accuracy : 0.713433 max acc epoch : 10 test accuracy : 0.727183
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  50.946995228528976 Time :  3593
accuracy train: 0.924222 val: 0.710448 test: 0.725699
max validation accuracy : 0.713433 max acc epoch : 10 test accuracy : 0.727183
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  48.16223215311766 Time :  3606
accuracy train: 0.924553 val: 0.719403 test: 0.729656
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.729656
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  46.93243180215359 Time :  3619
accuracy train: 0.931171 val: 0.716418 test: 0.725204
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.729656
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  45.583676636219025 Time :  3632
accuracy train: 0.934811 val: 0.716418 test: 0.722978
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.729656

Epoch :  16 loss training:  46.93324503302574 Time :  3646
accuracy train: 0.936466 val: 0.710448 test: 0.720010
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.729656

Epoch :  17 loss training:  44.629045590758324 Time :  3659
accuracy train: 0.940437 val: 0.707463 test: 0.725451
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.729656

Epoch :  18 loss training:  43.377769112586975 Time :  3673
accuracy train: 0.944408 val: 0.716418 test: 0.728172
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.729656

Epoch :  19 loss training:  39.724651858210564 Time :  3686
accuracy train: 0.946062 val: 0.698507 test: 0.727677
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.729656

Epoch :  20 loss training:  40.91315807402134 Time :  3700
accuracy train: 0.952349 val: 0.695522 test: 0.725451
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.729656

Epoch :  21 loss training:  38.96728898584843 Time :  3713
accuracy train: 0.958637 val: 0.707463 test: 0.727430
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.729656

Epoch :  22 loss training:  37.71327971667051 Time :  3727
accuracy train: 0.959629 val: 0.716418 test: 0.725451
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.729656

Epoch :  23 loss training:  35.36738447844982 Time :  3740
accuracy train: 0.962608 val: 0.710448 test: 0.726441
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.729656

Epoch :  24 loss training:  35.90390411019325 Time :  3753
accuracy train: 0.966909 val: 0.698507 test: 0.728172
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.729656

Epoch :  25 loss training:  33.664661042392254 Time :  3767
accuracy train: 0.968895 val: 0.707463 test: 0.724709
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.729656

Epoch :  26 loss training:  33.87425571680069 Time :  3781
accuracy train: 0.971542 val: 0.710448 test: 0.724957
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.729656

Epoch :  27 loss training:  31.662334218621254 Time :  3794
accuracy train: 0.974520 val: 0.707463 test: 0.730151
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.729656

Epoch :  28 loss training:  31.057877827435732 Time :  3808
accuracy train: 0.978160 val: 0.701493 test: 0.726193
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.729656

Epoch :  29 loss training:  30.61955074965954 Time :  3823
accuracy train: 0.977167 val: 0.713433 test: 0.727430
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.729656

Epoch :  30 loss training:  28.90303674340248 Time :  3836
accuracy train: 0.979815 val: 0.704478 test: 0.729904
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.729656

Epoch :  31 loss training:  28.82672868669033 Time :  3850
accuracy train: 0.980477 val: 0.701493 test: 0.727925
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.729656

Epoch :  32 loss training:  26.503097251057625 Time :  3864
accuracy train: 0.983786 val: 0.707463 test: 0.729409
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.729656

Epoch :  33 loss training:  25.589140623807907 Time :  3878
accuracy train: 0.981469 val: 0.701493 test: 0.729409
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.729656

Epoch :  34 loss training:  24.522373646497726 Time :  3891
accuracy train: 0.986102 val: 0.707463 test: 0.727430
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.729656

Epoch :  35 loss training:  24.356330011039972 Time :  3904
accuracy train: 0.990735 val: 0.713433 test: 0.726935
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.729656

Epoch :  36 loss training:  22.73810914158821 Time :  3918
accuracy train: 0.987426 val: 0.713433 test: 0.725699
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.729656

Epoch :  37 loss training:  23.415484484285116 Time :  3932
accuracy train: 0.989742 val: 0.713433 test: 0.730893
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.729656

Epoch :  38 loss training:  21.507286734879017 Time :  3945
accuracy train: 0.992058 val: 0.722388 test: 0.727430
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  39 loss training:  21.1257457844913 Time :  3959
accuracy train: 0.991396 val: 0.713433 test: 0.728172
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  40 loss training:  18.977603185921907 Time :  3973
accuracy train: 0.992720 val: 0.701493 test: 0.726193
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  41 loss training:  19.474376548081636 Time :  3986
accuracy train: 0.995036 val: 0.704478 test: 0.726441
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  42 loss training:  18.191750928759575 Time :  3999
accuracy train: 0.993713 val: 0.695522 test: 0.730646
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  43 loss training:  17.35879047960043 Time :  4013
accuracy train: 0.995698 val: 0.698507 test: 0.724215
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  44 loss training:  16.89079554565251 Time :  4026
accuracy train: 0.995367 val: 0.710448 test: 0.729656
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  45 loss training:  17.020634725689888 Time :  4040
accuracy train: 0.995698 val: 0.704478 test: 0.728419
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  46 loss training:  16.169924614951015 Time :  4053
accuracy train: 0.997022 val: 0.701493 test: 0.731140
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  47 loss training:  14.43760190345347 Time :  4067
accuracy train: 0.997022 val: 0.704478 test: 0.730893
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  48 loss training:  15.184686053544283 Time :  4080
accuracy train: 0.998015 val: 0.713433 test: 0.725699
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  49 loss training:  14.82686597853899 Time :  4093
accuracy train: 0.998015 val: 0.701493 test: 0.724215
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  50 loss training:  14.391137609258294 Time :  4107
accuracy train: 0.998676 val: 0.692537 test: 0.727925
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  51 loss training:  14.035893231630325 Time :  4120
accuracy train: 0.999007 val: 0.701493 test: 0.727183
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  52 loss training:  12.611301423981786 Time :  4134
accuracy train: 0.999338 val: 0.701493 test: 0.729904
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  53 loss training:  12.858515927568078 Time :  4147
accuracy train: 0.999338 val: 0.698507 test: 0.730646
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  54 loss training:  11.697606878355145 Time :  4160
accuracy train: 0.999338 val: 0.707463 test: 0.729162
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  55 loss training:  11.200069479644299 Time :  4173
accuracy train: 0.999669 val: 0.701493 test: 0.730893
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  56 loss training:  11.828692646697164 Time :  4187
accuracy train: 0.999338 val: 0.698507 test: 0.733614
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  57 loss training:  10.486732142046094 Time :  4199
accuracy train: 0.999669 val: 0.698507 test: 0.731140
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  58 loss training:  10.886210144497454 Time :  4212
accuracy train: 0.999338 val: 0.704478 test: 0.731882
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  59 loss training:  10.77452689036727 Time :  4226
accuracy train: 0.999669 val: 0.713433 test: 0.728667
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  60 loss training:  10.319455103948712 Time :  4239
accuracy train: 0.999669 val: 0.704478 test: 0.729409
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  61 loss training:  8.695796714164317 Time :  4252
accuracy train: 0.999669 val: 0.716418 test: 0.732377
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  62 loss training:  8.791173413395882 Time :  4266
accuracy train: 0.999669 val: 0.701493 test: 0.730398
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  63 loss training:  8.964760271832347 Time :  4279
accuracy train: 0.999669 val: 0.707463 test: 0.728172
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  64 loss training:  8.588921018876135 Time :  4293
accuracy train: 0.999669 val: 0.716418 test: 0.730893
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  65 loss training:  8.55745649524033 Time :  4306
accuracy train: 0.999669 val: 0.716418 test: 0.727677
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  66 loss training:  7.416583267971873 Time :  4319
accuracy train: 0.999669 val: 0.713433 test: 0.729162
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  67 loss training:  7.552287532482296 Time :  4331
accuracy train: 0.999669 val: 0.713433 test: 0.729409
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  68 loss training:  7.537838134914637 Time :  4343
accuracy train: 0.999669 val: 0.707463 test: 0.724709
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

Epoch :  69 loss training:  6.664301563054323 Time :  4357
accuracy train: 0.999669 val: 0.707463 test: 0.728172
max validation accuracy : 0.722388 max acc epoch : 38 test accuracy : 0.727430

========================================================================================================================================================================================================
max acc epoch :  38
max validation accuracy :  0.7223880597014926
test accuracy :  0.7274301261439525
last test_accuracy :  0.7281721493940143
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.72836 	 test_accuracy : 0.72669 	 max_acc epoch :  32 	 last test_accuracy : 0.72397
k :  1 	 val_accuracy : 0.72836 	 test_accuracy : 0.72619 	 max_acc epoch :  14 	 last test_accuracy : 0.72644
k :  2 	 val_accuracy : 0.71940 	 test_accuracy : 0.72718 	 max_acc epoch :  14 	 last test_accuracy : 0.73163
k :  3 	 val_accuracy : 0.71940 	 test_accuracy : 0.72496 	 max_acc epoch :  48 	 last test_accuracy : 0.73213
k :  4 	 val_accuracy : 0.72239 	 test_accuracy : 0.72743 	 max_acc epoch :  38 	 last test_accuracy : 0.72817

avg :  	 val_accuracy : 0.72358 	 test_accuracy : 0.72649 	 last_accuracy : 0.72847
