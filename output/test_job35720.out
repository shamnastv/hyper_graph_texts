

date and time :  Sat Jun  5 20:56:11 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=220, weight_decay=0)
device :  cuda:0
Counter({0: 4233, 1: 2305, 2: 1153})

Epoch :  1 loss training:  43.245142072439194 Time :  34
accuracy train: 0.931125 val: 0.923636 test: 0.952968
max validation accuracy : 0.923636 max acc epoch : 1 test accuracy : 0.952968
Counter({1: 3600, 2: 2558, 0: 1533})

Epoch :  2 loss training:  17.377462528645992 Time :  62
accuracy train: 0.966471 val: 0.960000 test: 0.958447
max validation accuracy : 0.960000 max acc epoch : 2 test accuracy : 0.958447
Counter({1: 3753, 0: 2449, 2: 1489})

Epoch :  3 loss training:  15.807731076143682 Time :  90
accuracy train: 0.973945 val: 0.965455 test: 0.960274
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.960274
Counter({0: 3761, 1: 2431, 2: 1499})

Epoch :  4 loss training:  15.651102337054908 Time :  117
accuracy train: 0.970915 val: 0.960000 test: 0.966210
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.960274
Counter({1: 3778, 2: 2411, 0: 1502})

Epoch :  5 loss training:  12.377781356219202 Time :  147
accuracy train: 0.973137 val: 0.961818 test: 0.961187
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.960274
Counter({2: 3782, 1: 2413, 0: 1496})

Epoch :  6 loss training:  9.739247736521065 Time :  178
accuracy train: 0.987881 val: 0.963636 test: 0.967580
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.960274
Counter({0: 3781, 1: 2398, 2: 1512})

Epoch :  7 loss training:  9.240422116359696 Time :  203
accuracy train: 0.981216 val: 0.976364 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.969406
Counter({0: 3816, 1: 2377, 2: 1498})

Epoch :  8 loss training:  8.887999595375732 Time :  225
accuracy train: 0.980610 val: 0.952727 test: 0.950685
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3846, 2: 2367, 0: 1478})

Epoch :  9 loss training:  8.437880753073841 Time :  248
accuracy train: 0.983640 val: 0.969091 test: 0.963470
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.969406
Counter({2: 3832, 1: 2374, 0: 1485})

Epoch :  10 loss training:  8.360095191048458 Time :  271
accuracy train: 0.985256 val: 0.969091 test: 0.964384
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3818, 2: 2357, 0: 1516})

Epoch :  11 loss training:  6.6585346184438094 Time :  293
accuracy train: 0.986467 val: 0.960000 test: 0.965297
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.969406
Counter({0: 3795, 1: 2367, 2: 1529})

Epoch :  12 loss training:  6.043958845199086 Time :  315
accuracy train: 0.983640 val: 0.952727 test: 0.963470
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.969406
Counter({0: 3778, 1: 2372, 2: 1541})

Epoch :  13 loss training:  8.634306996595114 Time :  338
accuracy train: 0.984246 val: 0.960000 test: 0.954795
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.969406
Counter({0: 3617, 2: 2270, 1: 1804})

Epoch :  14 loss training:  8.58873327053152 Time :  362
accuracy train: 0.967885 val: 0.936364 test: 0.940183
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.969406
Counter({1: 3668, 2: 2255, 0: 1768})

Epoch :  15 loss training:  8.650207466678694 Time :  386
accuracy train: 0.988487 val: 0.972727 test: 0.965297
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.969406
Counter({0: 3735, 2: 2333, 1: 1623})

Epoch :  16 loss training:  8.005605357815512 Time :  413
accuracy train: 0.994749 val: 0.978182 test: 0.966210
max validation accuracy : 0.978182 max acc epoch : 16 test accuracy : 0.966210
Counter({1: 3656, 0: 2414, 2: 1621})

Epoch :  17 loss training:  4.320886703033466 Time :  435
accuracy train: 0.995556 val: 0.972727 test: 0.966667
max validation accuracy : 0.978182 max acc epoch : 16 test accuracy : 0.966210
Counter({1: 3694, 2: 2350, 0: 1647})

Epoch :  18 loss training:  3.5741800652467646 Time :  460
accuracy train: 0.995960 val: 0.969091 test: 0.966210
max validation accuracy : 0.978182 max acc epoch : 16 test accuracy : 0.966210
Counter({0: 3723, 2: 2303, 1: 1665})

Epoch :  19 loss training:  2.8138726061297348 Time :  485
accuracy train: 0.997172 val: 0.961818 test: 0.966667
max validation accuracy : 0.978182 max acc epoch : 16 test accuracy : 0.966210
Counter({2: 3738, 1: 2306, 0: 1647})

Epoch :  20 loss training:  2.40778749310266 Time :  511
accuracy train: 0.996566 val: 0.972727 test: 0.966667
max validation accuracy : 0.978182 max acc epoch : 16 test accuracy : 0.966210
Counter({1: 3750, 2: 2293, 0: 1648})

Epoch :  21 loss training:  2.6198204376105423 Time :  537
accuracy train: 0.997172 val: 0.970909 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 16 test accuracy : 0.966210
Counter({2: 3774, 0: 2293, 1: 1624})

Epoch :  22 loss training:  2.5369680906551366 Time :  561
accuracy train: 0.997374 val: 0.974545 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 16 test accuracy : 0.966210
Counter({2: 3783, 1: 2287, 0: 1621})

Epoch :  23 loss training:  1.696821903635282 Time :  586
accuracy train: 0.995556 val: 0.967273 test: 0.960731
max validation accuracy : 0.978182 max acc epoch : 16 test accuracy : 0.966210
Counter({1: 3852, 0: 2273, 2: 1566})

Epoch :  24 loss training:  2.2712165946468303 Time :  609
accuracy train: 0.996768 val: 0.970909 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 16 test accuracy : 0.966210
Counter({0: 3684, 1: 2292, 2: 1715})

Epoch :  25 loss training:  2.0459442732208117 Time :  632
accuracy train: 0.997374 val: 0.969091 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 16 test accuracy : 0.966210
Counter({1: 3635, 0: 2295, 2: 1761})

Epoch :  26 loss training:  1.8498795506138777 Time :  656
accuracy train: 0.997172 val: 0.974545 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 16 test accuracy : 0.966210
Counter({0: 3803, 1: 2303, 2: 1585})

Epoch :  27 loss training:  1.7147197689773748 Time :  677
accuracy train: 0.997172 val: 0.970909 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 16 test accuracy : 0.966210
Counter({0: 3798, 1: 2294, 2: 1599})

Epoch :  28 loss training:  2.046681803678439 Time :  700
accuracy train: 0.993537 val: 0.967273 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 16 test accuracy : 0.966210
Counter({0: 3629, 1: 2294, 2: 1768})

Epoch :  29 loss training:  2.0733988455103827 Time :  723
accuracy train: 0.997374 val: 0.972727 test: 0.964840
max validation accuracy : 0.978182 max acc epoch : 16 test accuracy : 0.966210
Counter({1: 3737, 2: 2281, 0: 1673})

Epoch :  30 loss training:  1.840379201239557 Time :  746
accuracy train: 0.996566 val: 0.963636 test: 0.960274
max validation accuracy : 0.978182 max acc epoch : 16 test accuracy : 0.966210
Counter({1: 3860, 2: 2284, 0: 1547})

Epoch :  31 loss training:  1.7769846008395689 Time :  768
accuracy train: 0.997374 val: 0.976364 test: 0.966210
max validation accuracy : 0.978182 max acc epoch : 16 test accuracy : 0.966210
Counter({1: 3840, 2: 2287, 0: 1564})

Epoch :  32 loss training:  1.6094914166060335 Time :  790
accuracy train: 0.997172 val: 0.976364 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 16 test accuracy : 0.966210
Counter({0: 3849, 2: 2286, 1: 1556})

Epoch :  33 loss training:  1.6003159878564475 Time :  811
accuracy train: 0.997374 val: 0.974545 test: 0.963470
max validation accuracy : 0.978182 max acc epoch : 16 test accuracy : 0.966210
Counter({1: 3869, 2: 2273, 0: 1549})

Epoch :  34 loss training:  1.8278642422092162 Time :  834
accuracy train: 0.996970 val: 0.972727 test: 0.964840
max validation accuracy : 0.978182 max acc epoch : 16 test accuracy : 0.966210
Counter({1: 3828, 2: 2287, 0: 1576})

Epoch :  35 loss training:  1.5627396054051133 Time :  855
accuracy train: 0.997778 val: 0.978182 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 16 test accuracy : 0.966210
Counter({1: 3848, 2: 2289, 0: 1554})

Epoch :  36 loss training:  1.5414397233339514 Time :  876
accuracy train: 0.997576 val: 0.980000 test: 0.968950
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({1: 3866, 0: 2290, 2: 1535})

Epoch :  37 loss training:  1.2622723320600926 Time :  897
accuracy train: 0.996970 val: 0.974545 test: 0.966667
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({2: 3860, 1: 2289, 0: 1542})

Epoch :  38 loss training:  2.4628645238981335 Time :  919
accuracy train: 0.994951 val: 0.956364 test: 0.963927
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({1: 3724, 0: 2316, 2: 1651})

Epoch :  39 loss training:  2.21010717247691 Time :  939
accuracy train: 0.995758 val: 0.967273 test: 0.964840
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({0: 3783, 1: 2300, 2: 1608})

Epoch :  40 loss training:  2.9412222118116915 Time :  959
accuracy train: 0.996970 val: 0.969091 test: 0.965297
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({1: 3838, 0: 2284, 2: 1569})

Epoch :  41 loss training:  1.9865701648232061 Time :  981
accuracy train: 0.996162 val: 0.967273 test: 0.964384
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({1: 3859, 2: 2283, 0: 1549})

Epoch :  42 loss training:  2.3759266028382626 Time :  1003
accuracy train: 0.996566 val: 0.969091 test: 0.963470
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({1: 3849, 2: 2293, 0: 1549})

Epoch :  43 loss training:  2.428146043455854 Time :  1025
accuracy train: 0.996768 val: 0.967273 test: 0.963470
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({1: 3854, 0: 2313, 2: 1524})

Epoch :  44 loss training:  2.912825354079814 Time :  1067
accuracy train: 0.997172 val: 0.969091 test: 0.963014
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({1: 3864, 0: 2292, 2: 1535})

Epoch :  45 loss training:  1.8832783803388793 Time :  1092
accuracy train: 0.997576 val: 0.976364 test: 0.962557
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({1: 3872, 2: 2284, 0: 1535})

Epoch :  46 loss training:  2.116543358300248 Time :  1120
accuracy train: 0.994951 val: 0.963636 test: 0.964384
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({1: 3857, 2: 2303, 0: 1531})

Epoch :  47 loss training:  2.4442425020570226 Time :  1149
accuracy train: 0.993739 val: 0.950909 test: 0.959361
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({1: 3733, 0: 2303, 2: 1655})

Epoch :  48 loss training:  1.702566368026737 Time :  1175
accuracy train: 0.996970 val: 0.958182 test: 0.963470
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({0: 3843, 1: 2277, 2: 1571})

Epoch :  49 loss training:  1.9451045053997404 Time :  1201
accuracy train: 0.997172 val: 0.961818 test: 0.965753
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({1: 3852, 0: 2271, 2: 1568})

Epoch :  50 loss training:  1.3849192266298829 Time :  1227
accuracy train: 0.997374 val: 0.961818 test: 0.961644
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({1: 3870, 2: 2272, 0: 1549})

Epoch :  51 loss training:  1.4733336808906188 Time :  1255
accuracy train: 0.997374 val: 0.954545 test: 0.961644
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({1: 3748, 2: 2279, 0: 1664})

Epoch :  52 loss training:  1.569517148552201 Time :  1285
accuracy train: 0.994951 val: 0.963636 test: 0.963470
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({1: 3854, 0: 2274, 2: 1563})

Epoch :  53 loss training:  1.5855926802047264 Time :  1311
accuracy train: 0.996364 val: 0.965455 test: 0.957078
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({2: 3835, 0: 2261, 1: 1595})

Epoch :  54 loss training:  2.0737121917022705 Time :  1347
accuracy train: 0.995152 val: 0.967273 test: 0.959817
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({1: 3825, 0: 2271, 2: 1595})

Epoch :  55 loss training:  1.6979194231980728 Time :  1374
accuracy train: 0.997778 val: 0.970909 test: 0.960274
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({1: 3890, 2: 2275, 0: 1526})

Epoch :  56 loss training:  14.52471111939576 Time :  1400
accuracy train: 0.970915 val: 0.923636 test: 0.940639
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({1: 3922, 0: 1986, 2: 1783})

Epoch :  57 loss training:  8.81156489928253 Time :  1425
accuracy train: 0.992123 val: 0.941818 test: 0.948858
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({0: 3990, 1: 2506, 2: 1195})

Epoch :  58 loss training:  3.464409127482213 Time :  1451
accuracy train: 0.996162 val: 0.941818 test: 0.947945
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({2: 3565, 0: 2731, 1: 1395})

Epoch :  59 loss training:  2.198674903884239 Time :  1475
accuracy train: 0.997576 val: 0.952727 test: 0.949315
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({0: 3654, 1: 2623, 2: 1414})

Epoch :  60 loss training:  1.5736370155427721 Time :  1501
accuracy train: 0.997374 val: 0.941818 test: 0.946575
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({0: 3661, 1: 2549, 2: 1481})

Epoch :  61 loss training:  1.4555900614213897 Time :  1526
accuracy train: 0.997778 val: 0.949091 test: 0.948402
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({0: 3677, 1: 2509, 2: 1505})

Epoch :  62 loss training:  1.4441909298839164 Time :  1548
accuracy train: 0.996970 val: 0.941818 test: 0.947489
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({0: 3711, 1: 2472, 2: 1508})

Epoch :  63 loss training:  1.3132054008237901 Time :  1573
accuracy train: 0.996970 val: 0.938182 test: 0.946119
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({1: 3634, 2: 2590, 0: 1467})

Epoch :  64 loss training:  1.3234994343583821 Time :  1596
accuracy train: 0.997778 val: 0.947273 test: 0.947945
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({0: 3666, 1: 2583, 2: 1442})

Epoch :  65 loss training:  1.3286405382095836 Time :  1620
accuracy train: 0.997778 val: 0.949091 test: 0.948402
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({1: 3931, 2: 2280, 0: 1480})

Epoch :  66 loss training:  1.188163108079607 Time :  1644
accuracy train: 0.997778 val: 0.952727 test: 0.946119
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({1: 3925, 2: 2523, 0: 1243})

Epoch :  67 loss training:  1.0474313310405705 Time :  1669
accuracy train: 0.997374 val: 0.941818 test: 0.945205
max validation accuracy : 0.980000 max acc epoch : 36 test accuracy : 0.968950
Counter({0: 3699, 1: 2402, 2: 1590})

========================================================================================================================================================================================================
max acc epoch :  36
max validation accuracy :  0.98
test accuracy :  0.9689497716894977
last test_accuracy :  0.9452054794520548
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=220, weight_decay=0)
device :  cuda:0
Counter({0: 4233, 1: 2305, 2: 1153})

Epoch :  1 loss training:  43.295274902135134 Time :  1706
accuracy train: 0.931731 val: 0.925455 test: 0.955708
max validation accuracy : 0.925455 max acc epoch : 1 test accuracy : 0.955708
Counter({1: 3605, 0: 2534, 2: 1552})

Epoch :  2 loss training:  17.19556683022529 Time :  1732
accuracy train: 0.963442 val: 0.952727 test: 0.953881
max validation accuracy : 0.952727 max acc epoch : 2 test accuracy : 0.953881
Counter({0: 3750, 2: 2439, 1: 1502})

Epoch :  3 loss training:  15.61741315945983 Time :  1754
accuracy train: 0.960816 val: 0.952727 test: 0.957534
max validation accuracy : 0.952727 max acc epoch : 2 test accuracy : 0.953881
Counter({2: 3764, 1: 2411, 0: 1516})

Epoch :  4 loss training:  14.650059587787837 Time :  1778
accuracy train: 0.976368 val: 0.967273 test: 0.967123
max validation accuracy : 0.967273 max acc epoch : 4 test accuracy : 0.967123
Counter({1: 3817, 2: 2380, 0: 1494})

Epoch :  5 loss training:  11.849362502805889 Time :  1799
accuracy train: 0.982630 val: 0.963636 test: 0.965753
max validation accuracy : 0.967273 max acc epoch : 4 test accuracy : 0.967123
Counter({0: 3782, 2: 2408, 1: 1501})

Epoch :  6 loss training:  9.464001179672778 Time :  1820
accuracy train: 0.986265 val: 0.967273 test: 0.963470
max validation accuracy : 0.967273 max acc epoch : 4 test accuracy : 0.967123
Counter({0: 3807, 2: 2373, 1: 1511})

Epoch :  7 loss training:  8.55187076376751 Time :  1842
accuracy train: 0.982428 val: 0.974545 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.968493
Counter({1: 3808, 2: 2381, 0: 1502})

Epoch :  8 loss training:  9.525184868020006 Time :  1863
accuracy train: 0.984044 val: 0.945455 test: 0.952968
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.968493
Counter({1: 3823, 2: 2393, 0: 1475})

Epoch :  9 loss training:  9.75407984026242 Time :  1883
accuracy train: 0.984448 val: 0.969091 test: 0.964840
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.968493
Counter({1: 3797, 2: 2396, 0: 1498})

Epoch :  10 loss training:  11.35088514862582 Time :  1904
accuracy train: 0.983438 val: 0.970909 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.968493
Counter({0: 3680, 1: 2319, 2: 1692})

Epoch :  11 loss training:  9.738393696490675 Time :  1924
accuracy train: 0.986669 val: 0.969091 test: 0.961644
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.968493
Counter({0: 3692, 2: 2309, 1: 1690})

Epoch :  12 loss training:  7.264757862430997 Time :  1945
accuracy train: 0.990911 val: 0.958182 test: 0.962100
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.968493
Counter({1: 3704, 2: 2334, 0: 1653})

Epoch :  13 loss training:  6.882555942749605 Time :  1965
accuracy train: 0.993335 val: 0.961818 test: 0.965297
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.968493
Counter({0: 3719, 2: 2327, 1: 1645})

Epoch :  14 loss training:  6.698676140862517 Time :  1985
accuracy train: 0.977782 val: 0.954545 test: 0.946119
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.968493
Counter({2: 3737, 1: 2305, 0: 1649})

Epoch :  15 loss training:  7.8733532432233915 Time :  2006
accuracy train: 0.988689 val: 0.980000 test: 0.965753
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({0: 3809, 2: 2325, 1: 1557})

Epoch :  16 loss training:  7.7894106293679215 Time :  2029
accuracy train: 0.994345 val: 0.970909 test: 0.962557
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({2: 3761, 1: 2305, 0: 1625})

Epoch :  17 loss training:  4.5498515702201985 Time :  2049
accuracy train: 0.992729 val: 0.965455 test: 0.965753
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({0: 3801, 1: 2307, 2: 1583})

Epoch :  18 loss training:  4.588806329047657 Time :  2069
accuracy train: 0.995354 val: 0.974545 test: 0.963927
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({1: 3834, 0: 2301, 2: 1556})

Epoch :  19 loss training:  3.7147822730185 Time :  2089
accuracy train: 0.994547 val: 0.963636 test: 0.967123
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({1: 3802, 0: 2281, 2: 1608})

Epoch :  20 loss training:  2.4355974005520693 Time :  2112
accuracy train: 0.995152 val: 0.972727 test: 0.970320
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({1: 3805, 2: 2296, 0: 1590})

Epoch :  21 loss training:  3.0741749591888947 Time :  2134
accuracy train: 0.996768 val: 0.963636 test: 0.967123
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({0: 3770, 1: 2307, 2: 1614})

Epoch :  22 loss training:  2.8193368894280866 Time :  2156
accuracy train: 0.996768 val: 0.972727 test: 0.967123
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({1: 3797, 2: 2297, 0: 1597})

Epoch :  23 loss training:  2.5131031511191395 Time :  2178
accuracy train: 0.995152 val: 0.969091 test: 0.963014
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({1: 3838, 0: 2297, 2: 1556})

Epoch :  24 loss training:  2.249129594194528 Time :  2200
accuracy train: 0.996970 val: 0.969091 test: 0.963014
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({0: 3786, 2: 2225, 1: 1680})

Epoch :  25 loss training:  2.4711453323689057 Time :  2223
accuracy train: 0.995758 val: 0.963636 test: 0.963014
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({1: 3779, 2: 2323, 0: 1589})

Epoch :  26 loss training:  3.1803395280003315 Time :  2245
accuracy train: 0.996970 val: 0.978182 test: 0.967580
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({1: 3835, 0: 2315, 2: 1541})

Epoch :  27 loss training:  2.4686212736851303 Time :  2269
accuracy train: 0.997374 val: 0.969091 test: 0.968950
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({2: 3856, 1: 2298, 0: 1537})

Epoch :  28 loss training:  1.5119493060665263 Time :  2292
accuracy train: 0.994749 val: 0.974545 test: 0.967123
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({1: 3864, 0: 2291, 2: 1536})

Epoch :  29 loss training:  1.6319463767322304 Time :  2313
accuracy train: 0.997172 val: 0.972727 test: 0.963927
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({1: 3862, 0: 2286, 2: 1543})

Epoch :  30 loss training:  1.9657988622129778 Time :  2334
accuracy train: 0.997172 val: 0.963636 test: 0.960731
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({1: 3869, 2: 2272, 0: 1550})

Epoch :  31 loss training:  1.8100063401107036 Time :  2358
accuracy train: 0.997172 val: 0.974545 test: 0.966210
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({1: 3858, 0: 2294, 2: 1539})

Epoch :  32 loss training:  1.9782551398539 Time :  2382
accuracy train: 0.997172 val: 0.961818 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({1: 3861, 0: 2296, 2: 1534})

Epoch :  33 loss training:  1.771193221969952 Time :  2405
accuracy train: 0.996970 val: 0.961818 test: 0.963470
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({0: 3853, 2: 2299, 1: 1539})

Epoch :  34 loss training:  1.6820018165490183 Time :  2427
accuracy train: 0.996566 val: 0.965455 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({1: 3849, 0: 2299, 2: 1543})

Epoch :  35 loss training:  1.56779082912999 Time :  2448
accuracy train: 0.997778 val: 0.972727 test: 0.966667
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({2: 3866, 1: 2294, 0: 1531})

Epoch :  36 loss training:  1.856569783004943 Time :  2469
accuracy train: 0.997172 val: 0.974545 test: 0.966210
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({0: 3855, 1: 2310, 2: 1526})

Epoch :  37 loss training:  1.5931345008079916 Time :  2491
accuracy train: 0.996768 val: 0.972727 test: 0.963927
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({0: 3855, 1: 2305, 2: 1531})

Epoch :  38 loss training:  2.430648061125339 Time :  2515
accuracy train: 0.985457 val: 0.958182 test: 0.953881
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({1: 3796, 0: 2286, 2: 1609})

Epoch :  39 loss training:  3.0092835983050463 Time :  2539
accuracy train: 0.996768 val: 0.970909 test: 0.963927
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({0: 3834, 2: 2287, 1: 1570})

Epoch :  40 loss training:  2.037215630760329 Time :  2562
accuracy train: 0.996162 val: 0.954545 test: 0.956621
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({1: 3882, 0: 2272, 2: 1537})

Epoch :  41 loss training:  1.7467439654710688 Time :  2586
accuracy train: 0.996364 val: 0.980000 test: 0.962557
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({1: 3878, 2: 2273, 0: 1540})

Epoch :  42 loss training:  1.6250071227148624 Time :  2611
accuracy train: 0.997172 val: 0.974545 test: 0.966667
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({2: 3881, 1: 2278, 0: 1532})

Epoch :  43 loss training:  1.8626040103431478 Time :  2634
accuracy train: 0.996970 val: 0.965455 test: 0.958904
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({1: 3796, 2: 2280, 0: 1615})

Epoch :  44 loss training:  2.4617056103215873 Time :  2659
accuracy train: 0.997778 val: 0.963636 test: 0.957991
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({1: 3878, 2: 2282, 0: 1531})

Epoch :  45 loss training:  3.629284225223728 Time :  2681
accuracy train: 0.982024 val: 0.936364 test: 0.953425
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({0: 3624, 1: 2331, 2: 1736})

Epoch :  46 loss training:  11.839940139738246 Time :  2704
accuracy train: 0.946273 val: 0.890909 test: 0.920091
max validation accuracy : 0.980000 max acc epoch : 15 test accuracy : 0.965753
Counter({2: 4242, 0: 2936, 1: 513})

========================================================================================================================================================================================================
max acc epoch :  15
max validation accuracy :  0.98
test accuracy :  0.9657534246575342
last test_accuracy :  0.9200913242009132
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=220, weight_decay=0)
device :  cuda:0
Counter({0: 4233, 1: 2305, 2: 1153})

Epoch :  1 loss training:  43.28759953379631 Time :  2737
accuracy train: 0.937992 val: 0.930909 test: 0.954795
max validation accuracy : 0.930909 max acc epoch : 1 test accuracy : 0.954795
Counter({1: 3608, 2: 2523, 0: 1560})

Epoch :  2 loss training:  17.443254698067904 Time :  2759
accuracy train: 0.967683 val: 0.967273 test: 0.955708
max validation accuracy : 0.967273 max acc epoch : 2 test accuracy : 0.955708
Counter({1: 3734, 0: 2460, 2: 1497})

Epoch :  3 loss training:  15.639086350798607 Time :  2782
accuracy train: 0.970309 val: 0.960000 test: 0.963470
max validation accuracy : 0.967273 max acc epoch : 2 test accuracy : 0.955708
Counter({0: 3735, 1: 2450, 2: 1506})

Epoch :  4 loss training:  15.286880652885884 Time :  2802
accuracy train: 0.976772 val: 0.976364 test: 0.968493
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.968493
Counter({1: 3781, 2: 2414, 0: 1496})

Epoch :  5 loss training:  12.496806046925485 Time :  2824
accuracy train: 0.968289 val: 0.958182 test: 0.958904
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.968493
Counter({2: 3752, 1: 2442, 0: 1497})

Epoch :  6 loss training:  9.66477451263927 Time :  2847
accuracy train: 0.985659 val: 0.963636 test: 0.966210
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.968493
Counter({1: 3816, 0: 2383, 2: 1492})

Epoch :  7 loss training:  9.176134515088052 Time :  2871
accuracy train: 0.980206 val: 0.967273 test: 0.968493
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.968493
Counter({1: 3804, 2: 2366, 0: 1521})

Epoch :  8 loss training:  10.145147172384895 Time :  2893
accuracy train: 0.985659 val: 0.967273 test: 0.956621
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.968493
Counter({1: 3831, 0: 2355, 2: 1505})

Epoch :  9 loss training:  9.234351823339239 Time :  2914
accuracy train: 0.986871 val: 0.967273 test: 0.963470
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.968493
Counter({1: 3811, 2: 2374, 0: 1506})

Epoch :  10 loss training:  8.552793429233134 Time :  2936
accuracy train: 0.981418 val: 0.961818 test: 0.957534
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.968493
Counter({0: 3758, 1: 2336, 2: 1597})

Epoch :  11 loss training:  9.111077106790617 Time :  2957
accuracy train: 0.990911 val: 0.963636 test: 0.962557
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.968493
Counter({0: 3794, 2: 2333, 1: 1564})

Epoch :  12 loss training:  6.683068354963325 Time :  2980
accuracy train: 0.990103 val: 0.961818 test: 0.965753
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.968493
Counter({0: 3787, 1: 2328, 2: 1576})

Epoch :  13 loss training:  6.615282173850574 Time :  3005
accuracy train: 0.992527 val: 0.965455 test: 0.966210
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.968493
Counter({0: 3806, 1: 2330, 2: 1555})

Epoch :  14 loss training:  6.019928206515033 Time :  3026
accuracy train: 0.993537 val: 0.978182 test: 0.960274
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.960274
Counter({1: 3837, 0: 2327, 2: 1527})

Epoch :  15 loss training:  6.12696259864606 Time :  3049
accuracy train: 0.994547 val: 0.972727 test: 0.964840
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.960274
Counter({0: 3854, 1: 2318, 2: 1519})

Epoch :  16 loss training:  6.580687482957728 Time :  3072
accuracy train: 0.995556 val: 0.970909 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.960274
Counter({2: 3822, 1: 2327, 0: 1542})

Epoch :  17 loss training:  5.055499170382973 Time :  3095
accuracy train: 0.995152 val: 0.969091 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.960274
Counter({0: 3752, 1: 2321, 2: 1618})

Epoch :  18 loss training:  4.522894187452039 Time :  3119
accuracy train: 0.994749 val: 0.972727 test: 0.960731
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.960274
Counter({2: 3737, 1: 2281, 0: 1673})

Epoch :  19 loss training:  3.4498231869365554 Time :  3142
accuracy train: 0.996970 val: 0.965455 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.960274
Counter({0: 3766, 1: 2305, 2: 1620})

Epoch :  20 loss training:  2.6571336968627293 Time :  3165
accuracy train: 0.994547 val: 0.970909 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.960274
Counter({0: 3792, 2: 2312, 1: 1587})

Epoch :  21 loss training:  2.1175335404259386 Time :  3187
accuracy train: 0.996970 val: 0.970909 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.960274
Counter({1: 3821, 2: 2300, 0: 1570})

Epoch :  22 loss training:  2.42167274854728 Time :  3211
accuracy train: 0.997172 val: 0.974545 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.960274
Counter({1: 3833, 2: 2305, 0: 1553})

Epoch :  23 loss training:  1.841622237538104 Time :  3237
accuracy train: 0.996768 val: 0.970909 test: 0.964840
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.960274
Counter({1: 3865, 0: 2293, 2: 1533})

Epoch :  24 loss training:  1.932079094596702 Time :  3260
accuracy train: 0.997172 val: 0.969091 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.960274
Counter({0: 3856, 2: 2301, 1: 1534})

Epoch :  25 loss training:  1.887174110070191 Time :  3283
accuracy train: 0.996768 val: 0.976364 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.960274
Counter({1: 3854, 2: 2294, 0: 1543})

Epoch :  26 loss training:  2.0794919295440195 Time :  3307
accuracy train: 0.997172 val: 0.974545 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.960274
Counter({0: 3875, 2: 2303, 1: 1513})

Epoch :  27 loss training:  2.2205280560574465 Time :  3331
accuracy train: 0.996364 val: 0.960000 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.960274
Counter({0: 3813, 1: 2308, 2: 1570})

Epoch :  28 loss training:  1.824730200049089 Time :  3354
accuracy train: 0.994749 val: 0.978182 test: 0.967123
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.960274
Counter({1: 3875, 0: 2297, 2: 1519})

Epoch :  29 loss training:  1.9578449942946463 Time :  3376
accuracy train: 0.997172 val: 0.970909 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.960274
Counter({1: 3867, 0: 2298, 2: 1526})

Epoch :  30 loss training:  1.842822648883157 Time :  3399
accuracy train: 0.996970 val: 0.956364 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.960274
Counter({1: 3882, 2: 2292, 0: 1517})

Epoch :  31 loss training:  1.8571582520962693 Time :  3422
accuracy train: 0.997172 val: 0.976364 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.960274
Counter({1: 3880, 0: 2291, 2: 1520})

Epoch :  32 loss training:  2.032589378375633 Time :  3444
accuracy train: 0.996970 val: 0.961818 test: 0.965753
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.960274
Counter({1: 3851, 0: 2296, 2: 1544})

Epoch :  33 loss training:  2.412345720546 Time :  3467
accuracy train: 0.996768 val: 0.965455 test: 0.963014
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.960274
Counter({0: 3868, 1: 2292, 2: 1531})

Epoch :  34 loss training:  4.276737059815787 Time :  3490
accuracy train: 0.995556 val: 0.960000 test: 0.961644
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.960274
Counter({1: 3853, 0: 2301, 2: 1537})

Epoch :  35 loss training:  2.0641921187225307 Time :  3512
accuracy train: 0.997576 val: 0.961818 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.960274
Counter({1: 3875, 2: 2288, 0: 1528})

Epoch :  36 loss training:  2.8302102986672253 Time :  3538
accuracy train: 0.996970 val: 0.974545 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.960274
Counter({1: 3874, 2: 2288, 0: 1529})

Epoch :  37 loss training:  1.6785110082801111 Time :  3562
accuracy train: 0.996566 val: 0.980000 test: 0.966667
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({0: 3882, 1: 2290, 2: 1519})

Epoch :  38 loss training:  1.4552054956839129 Time :  3587
accuracy train: 0.997778 val: 0.970909 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({1: 3875, 2: 2287, 0: 1529})

Epoch :  39 loss training:  1.6026925017813483 Time :  3611
accuracy train: 0.995960 val: 0.965455 test: 0.962100
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({0: 3879, 1: 2279, 2: 1533})

Epoch :  40 loss training:  2.3627462621607265 Time :  3632
accuracy train: 0.996768 val: 0.969091 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({1: 3855, 2: 2288, 0: 1548})

Epoch :  41 loss training:  1.6843120735838966 Time :  3655
accuracy train: 0.996768 val: 0.980000 test: 0.966667
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({1: 3875, 2: 2273, 0: 1543})

Epoch :  42 loss training:  1.5648636218552383 Time :  3676
accuracy train: 0.997778 val: 0.969091 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({2: 3882, 1: 2281, 0: 1528})

Epoch :  43 loss training:  1.3407288134849296 Time :  3698
accuracy train: 0.997980 val: 0.974545 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({1: 3883, 0: 2279, 2: 1529})

Epoch :  44 loss training:  1.6325434110499373 Time :  3722
accuracy train: 0.997778 val: 0.976364 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({0: 3878, 1: 2281, 2: 1532})

Epoch :  45 loss training:  1.2296911868218103 Time :  3747
accuracy train: 0.997778 val: 0.976364 test: 0.970320
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({0: 3885, 1: 2279, 2: 1527})

Epoch :  46 loss training:  1.814429530493726 Time :  3770
accuracy train: 0.997778 val: 0.978182 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({2: 3887, 0: 2277, 1: 1527})

Epoch :  47 loss training:  1.6079113164682894 Time :  3792
accuracy train: 0.997576 val: 0.978182 test: 0.964840
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({1: 3888, 2: 2280, 0: 1523})

Epoch :  48 loss training:  1.718079843157284 Time :  3816
accuracy train: 0.997374 val: 0.969091 test: 0.963470
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({1: 3894, 2: 2274, 0: 1523})

Epoch :  49 loss training:  1.6690259735883046 Time :  3841
accuracy train: 0.995960 val: 0.960000 test: 0.953881
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({0: 3821, 1: 2305, 2: 1565})

Epoch :  50 loss training:  2.2778877954506243 Time :  3864
accuracy train: 0.997172 val: 0.965455 test: 0.964384
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({1: 3876, 2: 2308, 0: 1507})

Epoch :  51 loss training:  1.5129790849741767 Time :  3887
accuracy train: 0.997576 val: 0.969091 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({1: 3875, 0: 2293, 2: 1523})

Epoch :  52 loss training:  1.5121183573235157 Time :  3911
accuracy train: 0.994749 val: 0.967273 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({1: 3874, 0: 2292, 2: 1525})

Epoch :  53 loss training:  1.779516458590905 Time :  3934
accuracy train: 0.996970 val: 0.958182 test: 0.956164
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({0: 3896, 2: 2277, 1: 1518})

Epoch :  54 loss training:  2.5096088030436476 Time :  3959
accuracy train: 0.994749 val: 0.958182 test: 0.966210
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({1: 3839, 0: 2303, 2: 1549})

Epoch :  55 loss training:  2.003880272429342 Time :  3984
accuracy train: 0.993537 val: 0.960000 test: 0.951598
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({2: 3907, 1: 2263, 0: 1521})

Epoch :  56 loss training:  2.3147282119755346 Time :  4009
accuracy train: 0.996768 val: 0.967273 test: 0.965297
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({0: 3860, 1: 2284, 2: 1547})

Epoch :  57 loss training:  1.5783888270900803 Time :  4032
accuracy train: 0.997778 val: 0.972727 test: 0.968950
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({2: 3870, 1: 2291, 0: 1530})

Epoch :  58 loss training:  1.705914957602488 Time :  4057
accuracy train: 0.997778 val: 0.969091 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({0: 3860, 1: 2292, 2: 1539})

Epoch :  59 loss training:  1.273634010268097 Time :  4080
accuracy train: 0.997778 val: 0.969091 test: 0.968037
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({0: 3874, 2: 2288, 1: 1529})

Epoch :  60 loss training:  19.978813943103887 Time :  4104
accuracy train: 0.978388 val: 0.936364 test: 0.951598
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({2: 3950, 1: 2027, 0: 1714})

Epoch :  61 loss training:  8.135689071146771 Time :  4128
accuracy train: 0.992123 val: 0.947273 test: 0.942009
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({1: 3742, 2: 2259, 0: 1690})

Epoch :  62 loss training:  3.5207053989288397 Time :  4151
accuracy train: 0.995556 val: 0.949091 test: 0.949315
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({1: 3722, 0: 2302, 2: 1667})

Epoch :  63 loss training:  2.1735708421329036 Time :  4176
accuracy train: 0.996970 val: 0.950909 test: 0.952055
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({1: 3667, 0: 2287, 2: 1737})

Epoch :  64 loss training:  1.9206789782165288 Time :  4200
accuracy train: 0.996768 val: 0.945455 test: 0.942922
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({0: 3660, 1: 2294, 2: 1737})

Epoch :  65 loss training:  1.5393280702410266 Time :  4224
accuracy train: 0.996970 val: 0.954545 test: 0.950228
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({0: 3693, 1: 2275, 2: 1723})

Epoch :  66 loss training:  1.3204429737234022 Time :  4262
accuracy train: 0.997374 val: 0.952727 test: 0.951598
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({1: 3658, 2: 2250, 0: 1783})

Epoch :  67 loss training:  1.4257614118105266 Time :  4300
accuracy train: 0.997172 val: 0.952727 test: 0.947489
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({1: 3669, 2: 2266, 0: 1756})

Epoch :  68 loss training:  1.2970814338004857 Time :  4340
accuracy train: 0.997172 val: 0.950909 test: 0.944749
max validation accuracy : 0.980000 max acc epoch : 37 test accuracy : 0.966667
Counter({1: 3654, 2: 2257, 0: 1780})

========================================================================================================================================================================================================
max acc epoch :  37
max validation accuracy :  0.98
test accuracy :  0.9666666666666667
last test_accuracy :  0.9447488584474886
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=220, weight_decay=0)
device :  cuda:0
Counter({0: 4233, 1: 2305, 2: 1153})

Epoch :  1 loss training:  43.21426097303629 Time :  4400
accuracy train: 0.924460 val: 0.920000 test: 0.949772
max validation accuracy : 0.920000 max acc epoch : 1 test accuracy : 0.949772
Counter({0: 3603, 1: 2569, 2: 1519})

Epoch :  2 loss training:  17.181749844923615 Time :  4422
accuracy train: 0.963240 val: 0.958182 test: 0.956621
max validation accuracy : 0.958182 max acc epoch : 2 test accuracy : 0.956621
Counter({0: 3735, 2: 2443, 1: 1513})

Epoch :  3 loss training:  15.876952924765646 Time :  4445
accuracy train: 0.970713 val: 0.965455 test: 0.961187
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.961187
Counter({0: 3751, 2: 2411, 1: 1529})

Epoch :  4 loss training:  15.310815328732133 Time :  4468
accuracy train: 0.977782 val: 0.960000 test: 0.970776
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.961187
Counter({0: 3792, 1: 2407, 2: 1492})

Epoch :  5 loss training:  12.445450419560075 Time :  4490
accuracy train: 0.971319 val: 0.961818 test: 0.959361
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.961187
Counter({1: 3756, 2: 2436, 0: 1499})

Epoch :  6 loss training:  9.596348033519462 Time :  4513
accuracy train: 0.984448 val: 0.967273 test: 0.964384
max validation accuracy : 0.967273 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3772, 1: 2402, 2: 1517})

Epoch :  7 loss training:  8.725367795443162 Time :  4535
accuracy train: 0.978994 val: 0.965455 test: 0.966667
max validation accuracy : 0.967273 max acc epoch : 6 test accuracy : 0.964384
Counter({1: 3788, 0: 2379, 2: 1524})

Epoch :  8 loss training:  9.248407374252565 Time :  4556
accuracy train: 0.980812 val: 0.952727 test: 0.947032
max validation accuracy : 0.967273 max acc epoch : 6 test accuracy : 0.964384
Counter({1: 3840, 2: 2366, 0: 1485})

Epoch :  9 loss training:  9.052320972084999 Time :  4578
accuracy train: 0.987275 val: 0.965455 test: 0.963927
max validation accuracy : 0.967273 max acc epoch : 6 test accuracy : 0.964384
Counter({2: 3813, 0: 2381, 1: 1497})

Epoch :  10 loss training:  8.718800661619753 Time :  4602
accuracy train: 0.984852 val: 0.969091 test: 0.965753
max validation accuracy : 0.969091 max acc epoch : 10 test accuracy : 0.965753
Counter({0: 3784, 1: 2359, 2: 1548})

Epoch :  11 loss training:  6.887613809900358 Time :  4626
accuracy train: 0.986669 val: 0.958182 test: 0.963927
max validation accuracy : 0.969091 max acc epoch : 10 test accuracy : 0.965753
Counter({0: 3759, 1: 2360, 2: 1572})

Epoch :  12 loss training:  6.592284003621899 Time :  4648
accuracy train: 0.992931 val: 0.960000 test: 0.962557
max validation accuracy : 0.969091 max acc epoch : 10 test accuracy : 0.965753
Counter({0: 3777, 1: 2355, 2: 1559})

Epoch :  13 loss training:  7.129420520272106 Time :  4669
accuracy train: 0.993133 val: 0.967273 test: 0.963927
max validation accuracy : 0.969091 max acc epoch : 10 test accuracy : 0.965753
Counter({0: 3773, 1: 2343, 2: 1575})

Epoch :  14 loss training:  7.927099910099059 Time :  4691
accuracy train: 0.989093 val: 0.961818 test: 0.956621
max validation accuracy : 0.969091 max acc epoch : 10 test accuracy : 0.965753
Counter({1: 3815, 2: 2337, 0: 1539})

Epoch :  15 loss training:  7.1094542684732005 Time :  4713
accuracy train: 0.990911 val: 0.976364 test: 0.964384
max validation accuracy : 0.976364 max acc epoch : 15 test accuracy : 0.964384
Counter({1: 3720, 2: 2432, 0: 1539})

Epoch :  16 loss training:  8.416553907562047 Time :  4738
accuracy train: 0.992729 val: 0.967273 test: 0.965753
max validation accuracy : 0.976364 max acc epoch : 15 test accuracy : 0.964384
Counter({1: 3741, 2: 2383, 0: 1567})

Epoch :  17 loss training:  5.850443635310512 Time :  4765
accuracy train: 0.994345 val: 0.978182 test: 0.967123
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({0: 3844, 1: 2320, 2: 1527})

Epoch :  18 loss training:  3.7190181055193534 Time :  4788
accuracy train: 0.994345 val: 0.967273 test: 0.966667
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({0: 3819, 2: 2303, 1: 1569})

Epoch :  19 loss training:  3.0632336873095483 Time :  4811
accuracy train: 0.994143 val: 0.967273 test: 0.966667
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({1: 3808, 2: 2315, 0: 1568})

Epoch :  20 loss training:  2.9686404936292092 Time :  4836
accuracy train: 0.995152 val: 0.974545 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({1: 3809, 0: 2311, 2: 1571})

Epoch :  21 loss training:  2.5581302637838235 Time :  4861
accuracy train: 0.997172 val: 0.970909 test: 0.967123
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({1: 3836, 0: 2301, 2: 1554})

Epoch :  22 loss training:  2.4842617411195533 Time :  4883
accuracy train: 0.996768 val: 0.965455 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({0: 3836, 1: 2290, 2: 1565})

Epoch :  23 loss training:  2.055886087604449 Time :  4906
accuracy train: 0.995152 val: 0.972727 test: 0.963927
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({1: 3859, 0: 2288, 2: 1544})

Epoch :  24 loss training:  2.2047722017014166 Time :  4927
accuracy train: 0.996768 val: 0.972727 test: 0.963470
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({0: 3767, 2: 2303, 1: 1621})

Epoch :  25 loss training:  2.3561715943505988 Time :  4951
accuracy train: 0.995960 val: 0.969091 test: 0.953881
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({2: 3795, 1: 2299, 0: 1597})

Epoch :  26 loss training:  2.903459767192544 Time :  4974
accuracy train: 0.996970 val: 0.974545 test: 0.960731
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({1: 3833, 0: 2281, 2: 1577})

Epoch :  27 loss training:  2.233771919432911 Time :  4997
accuracy train: 0.996364 val: 0.963636 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({0: 3770, 1: 2289, 2: 1632})

Epoch :  28 loss training:  2.0064209480115096 Time :  5021
accuracy train: 0.994749 val: 0.974545 test: 0.963470
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({1: 3845, 0: 2282, 2: 1564})

Epoch :  29 loss training:  1.913243181681537 Time :  5044
accuracy train: 0.996768 val: 0.961818 test: 0.955708
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({1: 3854, 0: 2275, 2: 1562})

Epoch :  30 loss training:  2.1984324814511638 Time :  5067
accuracy train: 0.996970 val: 0.970909 test: 0.965297
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({1: 3838, 0: 2276, 2: 1577})

Epoch :  31 loss training:  2.0271659926675056 Time :  5090
accuracy train: 0.997576 val: 0.972727 test: 0.963470
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({1: 3837, 0: 2291, 2: 1563})

Epoch :  32 loss training:  1.9143432748951454 Time :  5115
accuracy train: 0.996768 val: 0.961818 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({1: 3820, 2: 2286, 0: 1585})

Epoch :  33 loss training:  1.7074528972570988 Time :  5141
accuracy train: 0.996970 val: 0.969091 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({1: 3835, 2: 2276, 0: 1580})

Epoch :  34 loss training:  1.6921006858474357 Time :  5164
accuracy train: 0.995758 val: 0.969091 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({0: 3820, 1: 2290, 2: 1581})

Epoch :  35 loss training:  2.4832765858382118 Time :  5187
accuracy train: 0.996970 val: 0.969091 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({0: 3819, 2: 2302, 1: 1570})

Epoch :  36 loss training:  1.891213717055507 Time :  5210
accuracy train: 0.997172 val: 0.954545 test: 0.958447
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({2: 3874, 0: 2302, 1: 1515})

Epoch :  37 loss training:  1.6139809883875387 Time :  5234
accuracy train: 0.996566 val: 0.960000 test: 0.963014
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({2: 3870, 1: 2309, 0: 1512})

Epoch :  38 loss training:  1.560127533681225 Time :  5260
accuracy train: 0.996970 val: 0.954545 test: 0.963927
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({2: 3881, 0: 2310, 1: 1500})

Epoch :  39 loss training:  1.521957692916203 Time :  5283
accuracy train: 0.997172 val: 0.963636 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({0: 3881, 2: 2287, 1: 1523})

Epoch :  40 loss training:  1.611496273508692 Time :  5305
accuracy train: 0.996768 val: 0.963636 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({2: 3872, 1: 2291, 0: 1528})

Epoch :  41 loss training:  1.8427385150948794 Time :  5327
accuracy train: 0.996364 val: 0.969091 test: 0.961187
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({0: 3847, 1: 2283, 2: 1561})

Epoch :  42 loss training:  2.2872138902246206 Time :  5352
accuracy train: 0.996970 val: 0.963636 test: 0.965753
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({0: 3849, 1: 2298, 2: 1544})

Epoch :  43 loss training:  3.133213598677685 Time :  5374
accuracy train: 0.997172 val: 0.974545 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({1: 3836, 0: 2301, 2: 1554})

Epoch :  44 loss training:  2.1466837925181608 Time :  5401
accuracy train: 0.997374 val: 0.967273 test: 0.967123
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({0: 3863, 1: 2276, 2: 1552})

Epoch :  45 loss training:  2.0742431400478836 Time :  5425
accuracy train: 0.997172 val: 0.952727 test: 0.956621
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({0: 3864, 1: 2275, 2: 1552})

Epoch :  46 loss training:  2.0238210027007426 Time :  5448
accuracy train: 0.996970 val: 0.965455 test: 0.964840
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({0: 3848, 2: 2287, 1: 1556})

Epoch :  47 loss training:  1.782557470598931 Time :  5472
accuracy train: 0.997778 val: 0.976364 test: 0.962557
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({1: 3864, 0: 2274, 2: 1553})

Epoch :  48 loss training:  2.5872504129654317 Time :  5494
accuracy train: 0.995758 val: 0.956364 test: 0.951598
max validation accuracy : 0.978182 max acc epoch : 17 test accuracy : 0.967123
Counter({0: 3711, 1: 2271, 2: 1709})

========================================================================================================================================================================================================
max acc epoch :  17
max validation accuracy :  0.9781818181818182
test accuracy :  0.9671232876712329
last test_accuracy :  0.9515981735159817
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=220, weight_decay=0)
device :  cuda:0
Counter({0: 4233, 1: 2305, 2: 1153})

Epoch :  1 loss training:  43.22244432941079 Time :  5528
accuracy train: 0.927287 val: 0.918182 test: 0.950228
max validation accuracy : 0.918182 max acc epoch : 1 test accuracy : 0.950228
Counter({2: 3594, 1: 2572, 0: 1525})

Epoch :  2 loss training:  17.295402854681015 Time :  5551
accuracy train: 0.970309 val: 0.958182 test: 0.960274
max validation accuracy : 0.958182 max acc epoch : 2 test accuracy : 0.960274
Counter({1: 3733, 0: 2466, 2: 1492})

Epoch :  3 loss training:  15.320844608359039 Time :  5574
accuracy train: 0.970309 val: 0.967273 test: 0.967123
max validation accuracy : 0.967273 max acc epoch : 3 test accuracy : 0.967123
Counter({0: 3739, 1: 2420, 2: 1532})

Epoch :  4 loss training:  15.808796210680157 Time :  5595
accuracy train: 0.973743 val: 0.965455 test: 0.968037
max validation accuracy : 0.967273 max acc epoch : 3 test accuracy : 0.967123
Counter({1: 3773, 2: 2408, 0: 1510})

Epoch :  5 loss training:  12.630308795720339 Time :  5617
accuracy train: 0.971319 val: 0.960000 test: 0.963014
max validation accuracy : 0.967273 max acc epoch : 3 test accuracy : 0.967123
Counter({1: 3741, 2: 2432, 0: 1518})

Epoch :  6 loss training:  9.641929966863245 Time :  5638
accuracy train: 0.985659 val: 0.965455 test: 0.962557
max validation accuracy : 0.967273 max acc epoch : 3 test accuracy : 0.967123
Counter({1: 3781, 0: 2384, 2: 1526})

Epoch :  7 loss training:  8.75267156609334 Time :  5662
accuracy train: 0.976974 val: 0.969091 test: 0.968493
max validation accuracy : 0.969091 max acc epoch : 7 test accuracy : 0.968493
Counter({0: 3796, 2: 2383, 1: 1512})

Epoch :  8 loss training:  10.237608252558857 Time :  5685
accuracy train: 0.985861 val: 0.954545 test: 0.953881
max validation accuracy : 0.969091 max acc epoch : 7 test accuracy : 0.968493
Counter({1: 3833, 2: 2366, 0: 1492})

Epoch :  9 loss training:  9.61996625061147 Time :  5709
accuracy train: 0.980206 val: 0.961818 test: 0.963470
max validation accuracy : 0.969091 max acc epoch : 7 test accuracy : 0.968493
Counter({1: 3780, 0: 2388, 2: 1523})

Epoch :  10 loss training:  9.336906973388977 Time :  5729
accuracy train: 0.986467 val: 0.972727 test: 0.965753
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.965753
Counter({0: 3726, 1: 2340, 2: 1625})

Epoch :  11 loss training:  9.024057098198682 Time :  5751
accuracy train: 0.986265 val: 0.969091 test: 0.963014
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.965753
Counter({0: 3727, 1: 2348, 2: 1616})

Epoch :  12 loss training:  7.027969811053481 Time :  5773
accuracy train: 0.991921 val: 0.967273 test: 0.964384
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.965753
Counter({0: 3706, 1: 2348, 2: 1637})

Epoch :  13 loss training:  7.136290053022094 Time :  5794
accuracy train: 0.993133 val: 0.965455 test: 0.964840
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.965753
Counter({1: 3715, 2: 2328, 0: 1648})

Epoch :  14 loss training:  6.070971930399537 Time :  5818
accuracy train: 0.978994 val: 0.952727 test: 0.945205
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.965753
Counter({1: 3742, 2: 2345, 0: 1604})

Epoch :  15 loss training:  8.786084465566091 Time :  5840
accuracy train: 0.988083 val: 0.974545 test: 0.964384
max validation accuracy : 0.974545 max acc epoch : 15 test accuracy : 0.964384
Counter({1: 3755, 2: 2378, 0: 1558})

Epoch :  16 loss training:  8.388883718871512 Time :  5866
accuracy train: 0.993739 val: 0.974545 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 15 test accuracy : 0.964384
Counter({1: 3678, 2: 2327, 0: 1686})

Epoch :  17 loss training:  5.163328519614879 Time :  5889
accuracy train: 0.995354 val: 0.980000 test: 0.963014
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({2: 3793, 1: 2264, 0: 1634})

Epoch :  18 loss training:  4.85395667263947 Time :  5913
accuracy train: 0.995556 val: 0.972727 test: 0.963014
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({1: 3780, 2: 2269, 0: 1642})

Epoch :  19 loss training:  3.0833639611373655 Time :  5937
accuracy train: 0.994547 val: 0.970909 test: 0.963014
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({1: 3828, 2: 2288, 0: 1575})

Epoch :  20 loss training:  2.476272744621383 Time :  5961
accuracy train: 0.995960 val: 0.970909 test: 0.968493
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({0: 3849, 1: 2314, 2: 1528})

Epoch :  21 loss training:  2.410866957311555 Time :  5983
accuracy train: 0.997172 val: 0.974545 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({1: 3819, 2: 2297, 0: 1575})

Epoch :  22 loss training:  2.631604725829675 Time :  6007
accuracy train: 0.997172 val: 0.972727 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({0: 3855, 2: 2309, 1: 1527})

Epoch :  23 loss training:  1.726509221982269 Time :  6029
accuracy train: 0.994143 val: 0.967273 test: 0.959817
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({1: 3867, 0: 2293, 2: 1531})

Epoch :  24 loss training:  2.45488550477603 Time :  6052
accuracy train: 0.996970 val: 0.978182 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({1: 3838, 2: 2313, 0: 1540})

Epoch :  25 loss training:  2.0054725010468246 Time :  6073
accuracy train: 0.995152 val: 0.961818 test: 0.960731
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({2: 3818, 1: 2305, 0: 1568})

Epoch :  26 loss training:  2.0581466648909554 Time :  6096
accuracy train: 0.997172 val: 0.974545 test: 0.963470
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({1: 3882, 0: 2288, 2: 1521})

Epoch :  27 loss training:  1.8720129774465022 Time :  6119
accuracy train: 0.996566 val: 0.969091 test: 0.965753
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({0: 3833, 1: 2324, 2: 1534})

Epoch :  28 loss training:  2.4885044581533293 Time :  6142
accuracy train: 0.997172 val: 0.972727 test: 0.964840
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({0: 3877, 1: 2294, 2: 1520})

Epoch :  29 loss training:  2.6056409227021504 Time :  6166
accuracy train: 0.997576 val: 0.972727 test: 0.966210
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({1: 3837, 0: 2314, 2: 1540})

Epoch :  30 loss training:  2.5827808093090425 Time :  6189
accuracy train: 0.996566 val: 0.969091 test: 0.964840
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({1: 3869, 2: 2309, 0: 1513})

Epoch :  31 loss training:  2.31121983038247 Time :  6213
accuracy train: 0.997374 val: 0.976364 test: 0.964384
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({1: 3868, 0: 2307, 2: 1516})

Epoch :  32 loss training:  1.8330702691091574 Time :  6236
accuracy train: 0.997172 val: 0.970909 test: 0.965753
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({1: 3866, 0: 2299, 2: 1526})

Epoch :  33 loss training:  1.5210039417470398 Time :  6257
accuracy train: 0.996970 val: 0.969091 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({1: 3867, 2: 2305, 0: 1519})

Epoch :  34 loss training:  1.536017602946231 Time :  6278
accuracy train: 0.996970 val: 0.970909 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({0: 3870, 1: 2307, 2: 1514})

Epoch :  35 loss training:  1.6002665258456545 Time :  6301
accuracy train: 0.997172 val: 0.976364 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({1: 3876, 2: 2308, 0: 1507})

Epoch :  36 loss training:  1.9964687549509108 Time :  6321
accuracy train: 0.997172 val: 0.972727 test: 0.965753
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({1: 3864, 0: 2317, 2: 1510})

Epoch :  37 loss training:  1.45627728674026 Time :  6343
accuracy train: 0.996566 val: 0.967273 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({0: 3859, 1: 2326, 2: 1506})

Epoch :  38 loss training:  2.141186083170396 Time :  6370
accuracy train: 0.996162 val: 0.967273 test: 0.964384
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({1: 3826, 2: 2323, 0: 1542})

Epoch :  39 loss training:  2.1617456469693934 Time :  6392
accuracy train: 0.996566 val: 0.970909 test: 0.962100
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({0: 3850, 1: 2315, 2: 1526})

Epoch :  40 loss training:  2.063652857836132 Time :  6414
accuracy train: 0.997172 val: 0.958182 test: 0.963927
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({2: 3870, 0: 2303, 1: 1518})

Epoch :  41 loss training:  1.9750298534045214 Time :  6437
accuracy train: 0.996970 val: 0.974545 test: 0.965297
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({0: 3858, 1: 2301, 2: 1532})

Epoch :  42 loss training:  2.5840661291367724 Time :  6460
accuracy train: 0.997172 val: 0.961818 test: 0.965297
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({0: 3866, 2: 2297, 1: 1528})

Epoch :  43 loss training:  1.9427110826641183 Time :  6484
accuracy train: 0.997374 val: 0.970909 test: 0.968037
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({2: 3859, 0: 2302, 1: 1530})

Epoch :  44 loss training:  1.6841065754115334 Time :  6507
accuracy train: 0.997778 val: 0.970909 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({1: 3863, 2: 2305, 0: 1523})

Epoch :  45 loss training:  1.4129541924239675 Time :  6528
accuracy train: 0.997778 val: 0.963636 test: 0.967580
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({0: 3857, 2: 2305, 1: 1529})

Epoch :  46 loss training:  1.6320793615291223 Time :  6550
accuracy train: 0.997778 val: 0.972727 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({2: 3862, 0: 2309, 1: 1520})

Epoch :  47 loss training:  1.1588156118975803 Time :  6574
accuracy train: 0.997778 val: 0.972727 test: 0.966667
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({1: 3873, 2: 2303, 0: 1515})

Epoch :  48 loss training:  1.574642932772349 Time :  6596
accuracy train: 0.997778 val: 0.980000 test: 0.967580
max validation accuracy : 0.980000 max acc epoch : 17 test accuracy : 0.963014
Counter({0: 3864, 1: 2302, 2: 1525})

========================================================================================================================================================================================================
max acc epoch :  17
max validation accuracy :  0.98
test accuracy :  0.963013698630137
last test_accuracy :  0.9675799086757991
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.98000 	 test_accuracy : 0.96895 	 max_acc epoch :  36 	 last test_accuracy : 0.94521
k :  1 	 val_accuracy : 0.98000 	 test_accuracy : 0.96575 	 max_acc epoch :  15 	 last test_accuracy : 0.92009
k :  2 	 val_accuracy : 0.98000 	 test_accuracy : 0.96667 	 max_acc epoch :  37 	 last test_accuracy : 0.94475
k :  3 	 val_accuracy : 0.97818 	 test_accuracy : 0.96712 	 max_acc epoch :  17 	 last test_accuracy : 0.95160
k :  4 	 val_accuracy : 0.98000 	 test_accuracy : 0.96301 	 max_acc epoch :  17 	 last test_accuracy : 0.96758

avg :  	 val_accuracy : 0.97964 	 test_accuracy : 0.96630 	 last_accuracy : 0.94584


date and time :  Sat Jun  5 22:46:22 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=864, weight_decay=0)
device :  cuda:0
Counter({1: 4230, 2: 2303, 0: 1158})

Epoch :  1 loss training:  45.94879661127925 Time :  22
accuracy train: 0.948697 val: 0.929091 test: 0.958904
max validation accuracy : 0.929091 max acc epoch : 1 test accuracy : 0.958904
Counter({1: 3670, 0: 2533, 2: 1488})

Epoch :  2 loss training:  18.35249882703647 Time :  43
accuracy train: 0.963038 val: 0.954545 test: 0.962100
max validation accuracy : 0.954545 max acc epoch : 2 test accuracy : 0.962100
Counter({1: 3751, 2: 2450, 0: 1490})

Epoch :  3 loss training:  14.929195816628635 Time :  65
accuracy train: 0.977176 val: 0.965455 test: 0.969406
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.969406
Counter({0: 3826, 1: 2423, 2: 1442})

Epoch :  4 loss training:  11.923957640305161 Time :  87
accuracy train: 0.974551 val: 0.960000 test: 0.967580
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.969406
Counter({0: 3818, 1: 2422, 2: 1451})

Epoch :  5 loss training:  11.53675107867457 Time :  108
accuracy train: 0.982226 val: 0.956364 test: 0.965753
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.969406
Counter({1: 3854, 0: 2400, 2: 1437})

Epoch :  6 loss training:  8.970423608552665 Time :  130
accuracy train: 0.984044 val: 0.965455 test: 0.971689
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.969406
Counter({2: 3861, 1: 2391, 0: 1439})

Epoch :  7 loss training:  8.92712892126292 Time :  153
accuracy train: 0.987679 val: 0.963636 test: 0.962100
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.969406
Counter({0: 3888, 2: 2347, 1: 1456})

Epoch :  8 loss training:  7.306360966409557 Time :  173
accuracy train: 0.988285 val: 0.961818 test: 0.965297
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.969406
Counter({1: 3894, 0: 2343, 2: 1454})

Epoch :  9 loss training:  7.590350793208927 Time :  194
accuracy train: 0.984650 val: 0.967273 test: 0.966667
max validation accuracy : 0.967273 max acc epoch : 9 test accuracy : 0.966667
Counter({1: 3894, 0: 2342, 2: 1455})

Epoch :  10 loss training:  6.996122894575819 Time :  217
accuracy train: 0.989295 val: 0.969091 test: 0.969406
max validation accuracy : 0.969091 max acc epoch : 10 test accuracy : 0.969406
Counter({1: 3895, 2: 2340, 0: 1456})

Epoch :  11 loss training:  6.324921041727066 Time :  238
accuracy train: 0.989295 val: 0.961818 test: 0.966667
max validation accuracy : 0.969091 max acc epoch : 10 test accuracy : 0.969406
Counter({0: 3894, 1: 2339, 2: 1458})

Epoch :  12 loss training:  5.625631257134955 Time :  259
accuracy train: 0.992123 val: 0.972727 test: 0.965297
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({0: 3905, 1: 2333, 2: 1453})

Epoch :  13 loss training:  5.242867045104504 Time :  282
accuracy train: 0.991517 val: 0.965455 test: 0.968493
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({1: 3877, 0: 2315, 2: 1499})

Epoch :  14 loss training:  5.031717472185846 Time :  303
accuracy train: 0.993537 val: 0.967273 test: 0.964384
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({2: 3876, 1: 2318, 0: 1497})

Epoch :  15 loss training:  4.243863498384599 Time :  327
accuracy train: 0.993941 val: 0.967273 test: 0.968493
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({0: 3920, 2: 2308, 1: 1463})

Epoch :  16 loss training:  5.238300310855266 Time :  350
accuracy train: 0.991315 val: 0.970909 test: 0.963470
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({2: 3931, 1: 2307, 0: 1453})

Epoch :  17 loss training:  4.351034843974048 Time :  373
accuracy train: 0.994749 val: 0.961818 test: 0.970320
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({0: 3929, 1: 2310, 2: 1452})

Epoch :  18 loss training:  2.942839034629287 Time :  395
accuracy train: 0.996364 val: 0.967273 test: 0.968037
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({0: 3927, 1: 2309, 2: 1455})

Epoch :  19 loss training:  2.527202075958485 Time :  417
accuracy train: 0.996768 val: 0.970909 test: 0.968950
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({0: 3929, 2: 2306, 1: 1456})

Epoch :  20 loss training:  2.2270878836352495 Time :  440
accuracy train: 0.996566 val: 0.967273 test: 0.963927
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({2: 3930, 0: 2303, 1: 1458})

Epoch :  21 loss training:  2.18197119960314 Time :  462
accuracy train: 0.996162 val: 0.965455 test: 0.965297
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({1: 3928, 2: 2297, 0: 1466})

Epoch :  22 loss training:  2.1897067511818022 Time :  486
accuracy train: 0.996364 val: 0.965455 test: 0.968037
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({1: 3928, 0: 2298, 2: 1465})

Epoch :  23 loss training:  2.2487179811359965 Time :  510
accuracy train: 0.996970 val: 0.960000 test: 0.963927
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({0: 3927, 1: 2296, 2: 1468})

Epoch :  24 loss training:  2.292819267451705 Time :  533
accuracy train: 0.995556 val: 0.961818 test: 0.960731
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({1: 3923, 2: 2291, 0: 1477})

Epoch :  25 loss training:  2.0057649165246403 Time :  554
accuracy train: 0.996566 val: 0.967273 test: 0.962557
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({1: 3928, 0: 2292, 2: 1471})

Epoch :  26 loss training:  1.9758794459048659 Time :  577
accuracy train: 0.995152 val: 0.961818 test: 0.962557
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({2: 3928, 1: 2292, 0: 1471})

Epoch :  27 loss training:  1.689345826041972 Time :  600
accuracy train: 0.997172 val: 0.965455 test: 0.965753
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({0: 3927, 2: 2292, 1: 1472})

Epoch :  28 loss training:  1.6312172254729376 Time :  623
accuracy train: 0.997172 val: 0.967273 test: 0.963470
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({1: 3927, 2: 2293, 0: 1471})

Epoch :  29 loss training:  1.7361080953996861 Time :  644
accuracy train: 0.996364 val: 0.967273 test: 0.963014
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({0: 3928, 2: 2292, 1: 1471})

Epoch :  30 loss training:  1.9566782410347514 Time :  666
accuracy train: 0.996566 val: 0.969091 test: 0.965753
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({1: 3927, 2: 2291, 0: 1473})

Epoch :  31 loss training:  1.6775276122007199 Time :  689
accuracy train: 0.993739 val: 0.969091 test: 0.960731
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({0: 3940, 1: 2281, 2: 1470})

Epoch :  32 loss training:  2.109035244153347 Time :  712
accuracy train: 0.996566 val: 0.965455 test: 0.968037
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({0: 3937, 1: 2279, 2: 1475})

Epoch :  33 loss training:  1.6640018532471004 Time :  733
accuracy train: 0.995758 val: 0.958182 test: 0.961644
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({0: 3937, 1: 2274, 2: 1480})

Epoch :  34 loss training:  2.4952631042688154 Time :  755
accuracy train: 0.994749 val: 0.960000 test: 0.962557
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({1: 3939, 2: 2277, 0: 1475})

Epoch :  35 loss training:  2.129368010118924 Time :  777
accuracy train: 0.996566 val: 0.965455 test: 0.964384
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({1: 3939, 2: 2280, 0: 1472})

Epoch :  36 loss training:  1.7666489041148452 Time :  798
accuracy train: 0.996566 val: 0.963636 test: 0.962100
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({1: 3939, 2: 2282, 0: 1470})

Epoch :  37 loss training:  2.2066351684334222 Time :  821
accuracy train: 0.994749 val: 0.952727 test: 0.958447
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({0: 3939, 2: 2269, 1: 1483})

Epoch :  38 loss training:  1.6040494956687326 Time :  844
accuracy train: 0.994547 val: 0.956364 test: 0.963014
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({0: 3940, 1: 2269, 2: 1482})

Epoch :  39 loss training:  1.7026902549087026 Time :  867
accuracy train: 0.996162 val: 0.952727 test: 0.963927
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({0: 3939, 1: 2274, 2: 1478})

Epoch :  40 loss training:  1.507438949372954 Time :  891
accuracy train: 0.996970 val: 0.958182 test: 0.964840
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({0: 3938, 1: 2275, 2: 1478})

Epoch :  41 loss training:  1.4668471434815729 Time :  913
accuracy train: 0.997576 val: 0.961818 test: 0.962100
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({0: 3938, 2: 2276, 1: 1477})

Epoch :  42 loss training:  1.6668020359629736 Time :  934
accuracy train: 0.997778 val: 0.956364 test: 0.962557
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({1: 3938, 2: 2276, 0: 1477})

Epoch :  43 loss training:  1.407306429118762 Time :  957
accuracy train: 0.997374 val: 0.960000 test: 0.961644
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.965297
Counter({2: 3938, 1: 2278, 0: 1475})

========================================================================================================================================================================================================
max acc epoch :  12
max validation accuracy :  0.9727272727272728
test accuracy :  0.965296803652968
last test_accuracy :  0.9616438356164384
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=864, weight_decay=0)
device :  cuda:0
Counter({1: 4230, 2: 2303, 0: 1158})

Epoch :  1 loss training:  45.95938893035054 Time :  989
accuracy train: 0.948293 val: 0.927273 test: 0.960274
max validation accuracy : 0.927273 max acc epoch : 1 test accuracy : 0.960274
Counter({0: 3665, 1: 2538, 2: 1488})

Epoch :  2 loss training:  18.388898003613576 Time :  1012
accuracy train: 0.961624 val: 0.958182 test: 0.965297
max validation accuracy : 0.958182 max acc epoch : 2 test accuracy : 0.965297
Counter({0: 3748, 1: 2452, 2: 1491})

Epoch :  3 loss training:  14.973654439672828 Time :  1033
accuracy train: 0.977176 val: 0.969091 test: 0.968037
max validation accuracy : 0.969091 max acc epoch : 3 test accuracy : 0.968037
Counter({2: 3829, 1: 2422, 0: 1440})

Epoch :  4 loss training:  11.871621553320438 Time :  1057
accuracy train: 0.972733 val: 0.960000 test: 0.963927
max validation accuracy : 0.969091 max acc epoch : 3 test accuracy : 0.968037
Counter({0: 3812, 2: 2421, 1: 1458})

Epoch :  5 loss training:  11.437196283834055 Time :  1079
accuracy train: 0.982024 val: 0.958182 test: 0.964384
max validation accuracy : 0.969091 max acc epoch : 3 test accuracy : 0.968037
Counter({1: 3850, 0: 2401, 2: 1440})

Epoch :  6 loss training:  9.04043306875974 Time :  1102
accuracy train: 0.982832 val: 0.967273 test: 0.971233
max validation accuracy : 0.969091 max acc epoch : 3 test accuracy : 0.968037
Counter({2: 3862, 1: 2392, 0: 1437})

Epoch :  7 loss training:  8.969961277209222 Time :  1124
accuracy train: 0.987881 val: 0.967273 test: 0.962100
max validation accuracy : 0.969091 max acc epoch : 3 test accuracy : 0.968037
Counter({0: 3860, 2: 2343, 1: 1488})

Epoch :  8 loss training:  7.591405677609146 Time :  1145
accuracy train: 0.986265 val: 0.967273 test: 0.965297
max validation accuracy : 0.969091 max acc epoch : 3 test accuracy : 0.968037
Counter({1: 3886, 0: 2341, 2: 1464})

Epoch :  9 loss training:  8.022411310812458 Time :  1165
accuracy train: 0.981216 val: 0.969091 test: 0.968950
max validation accuracy : 0.969091 max acc epoch : 3 test accuracy : 0.968037
Counter({0: 3883, 1: 2349, 2: 1459})

Epoch :  10 loss training:  6.816574838128872 Time :  1187
accuracy train: 0.991921 val: 0.972727 test: 0.967123
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({0: 3909, 2: 2332, 1: 1450})

Epoch :  11 loss training:  6.515472797036637 Time :  1209
accuracy train: 0.988487 val: 0.958182 test: 0.959817
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({0: 3875, 1: 2328, 2: 1488})

Epoch :  12 loss training:  5.7251342626987025 Time :  1231
accuracy train: 0.991719 val: 0.970909 test: 0.968037
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({0: 3876, 1: 2324, 2: 1491})

Epoch :  13 loss training:  5.523664185602684 Time :  1253
accuracy train: 0.990507 val: 0.958182 test: 0.964840
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({1: 3885, 0: 2319, 2: 1487})

Epoch :  14 loss training:  5.420862160273828 Time :  1277
accuracy train: 0.991517 val: 0.969091 test: 0.961187
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({1: 3890, 0: 2319, 2: 1482})

Epoch :  15 loss training:  4.821282543067355 Time :  1301
accuracy train: 0.993739 val: 0.969091 test: 0.968950
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({0: 3929, 1: 2318, 2: 1444})

Epoch :  16 loss training:  5.274433427432086 Time :  1325
accuracy train: 0.990305 val: 0.963636 test: 0.961644
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({0: 3933, 2: 2316, 1: 1442})

Epoch :  17 loss training:  4.705207230930682 Time :  1349
accuracy train: 0.995152 val: 0.961818 test: 0.966210
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({0: 3936, 1: 2312, 2: 1443})

Epoch :  18 loss training:  3.066012750445225 Time :  1374
accuracy train: 0.996162 val: 0.967273 test: 0.966667
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({1: 3935, 2: 2310, 0: 1446})

Epoch :  19 loss training:  2.488103675947059 Time :  1398
accuracy train: 0.996768 val: 0.970909 test: 0.963014
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({0: 3929, 1: 2311, 2: 1451})

Epoch :  20 loss training:  2.2779469682718627 Time :  1420
accuracy train: 0.995758 val: 0.965455 test: 0.963927
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({1: 3922, 0: 2305, 2: 1464})

Epoch :  21 loss training:  2.46233295489219 Time :  1445
accuracy train: 0.996566 val: 0.963636 test: 0.966667
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({1: 3899, 0: 2304, 2: 1488})

Epoch :  22 loss training:  2.155521036591381 Time :  1470
accuracy train: 0.996970 val: 0.969091 test: 0.965753
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({1: 3899, 0: 2305, 2: 1487})

Epoch :  23 loss training:  2.5294608919721213 Time :  1493
accuracy train: 0.996566 val: 0.965455 test: 0.964840
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({1: 3898, 2: 2304, 0: 1489})

Epoch :  24 loss training:  3.618023615301354 Time :  1516
accuracy train: 0.993941 val: 0.967273 test: 0.967123
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({1: 3896, 2: 2295, 0: 1500})

Epoch :  25 loss training:  2.365739007262164 Time :  1538
accuracy train: 0.996364 val: 0.972727 test: 0.962100
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({0: 3894, 1: 2295, 2: 1502})

Epoch :  26 loss training:  1.8460806390212383 Time :  1562
accuracy train: 0.995152 val: 0.961818 test: 0.965753
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({1: 3897, 0: 2293, 2: 1501})

Epoch :  27 loss training:  1.9651781343709445 Time :  1585
accuracy train: 0.996970 val: 0.969091 test: 0.965297
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({0: 3898, 2: 2291, 1: 1502})

Epoch :  28 loss training:  1.937593511735031 Time :  1608
accuracy train: 0.997374 val: 0.970909 test: 0.968037
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({1: 3898, 2: 2293, 0: 1500})

Epoch :  29 loss training:  1.66775512093227 Time :  1631
accuracy train: 0.996364 val: 0.967273 test: 0.965297
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({0: 3933, 1: 2293, 2: 1465})

Epoch :  30 loss training:  2.044777667371818 Time :  1655
accuracy train: 0.996566 val: 0.969091 test: 0.965753
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({0: 3932, 1: 2297, 2: 1462})

Epoch :  31 loss training:  1.802123350711554 Time :  1679
accuracy train: 0.996970 val: 0.969091 test: 0.968037
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({1: 3933, 2: 2295, 0: 1463})

Epoch :  32 loss training:  1.624975878312398 Time :  1703
accuracy train: 0.996970 val: 0.969091 test: 0.968037
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({0: 3899, 1: 2293, 2: 1499})

Epoch :  33 loss training:  1.143757288606139 Time :  1726
accuracy train: 0.997172 val: 0.970909 test: 0.968037
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({0: 3933, 1: 2293, 2: 1465})

Epoch :  34 loss training:  1.3310713415812643 Time :  1750
accuracy train: 0.994749 val: 0.961818 test: 0.967123
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({0: 3897, 1: 2297, 2: 1497})

Epoch :  35 loss training:  2.1786110748016654 Time :  1773
accuracy train: 0.997374 val: 0.965455 test: 0.964384
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({1: 3893, 2: 2293, 0: 1505})

Epoch :  36 loss training:  2.776748408054118 Time :  1796
accuracy train: 0.994143 val: 0.967273 test: 0.964384
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({0: 3924, 2: 2319, 1: 1448})

Epoch :  37 loss training:  3.044078174563765 Time :  1818
accuracy train: 0.994547 val: 0.969091 test: 0.965297
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({1: 3910, 0: 2308, 2: 1473})

Epoch :  38 loss training:  2.910575380861701 Time :  1841
accuracy train: 0.994143 val: 0.963636 test: 0.963470
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({1: 3911, 0: 2300, 2: 1480})

Epoch :  39 loss training:  1.8698312453198014 Time :  1865
accuracy train: 0.994749 val: 0.960000 test: 0.966210
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({0: 3936, 2: 2300, 1: 1455})

Epoch :  40 loss training:  1.8905099141629762 Time :  1888
accuracy train: 0.996768 val: 0.970909 test: 0.969863
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({0: 3936, 2: 2301, 1: 1454})

Epoch :  41 loss training:  1.6468101616192143 Time :  1910
accuracy train: 0.997374 val: 0.967273 test: 0.968493
max validation accuracy : 0.972727 max acc epoch : 10 test accuracy : 0.967123
Counter({0: 3937, 1: 2298, 2: 1456})

========================================================================================================================================================================================================
max acc epoch :  10
max validation accuracy :  0.9727272727272728
test accuracy :  0.9671232876712329
last test_accuracy :  0.9684931506849315
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=864, weight_decay=0)
device :  cuda:0
Counter({1: 4230, 2: 2303, 0: 1158})

Epoch :  1 loss training:  45.95201202109456 Time :  1942
accuracy train: 0.949101 val: 0.929091 test: 0.958447
max validation accuracy : 0.929091 max acc epoch : 1 test accuracy : 0.958447
Counter({2: 3670, 1: 2535, 0: 1486})

Epoch :  2 loss training:  18.369386390782893 Time :  1963
accuracy train: 0.963240 val: 0.956364 test: 0.965297
max validation accuracy : 0.956364 max acc epoch : 2 test accuracy : 0.965297
Counter({1: 3758, 2: 2440, 0: 1493})

Epoch :  3 loss training:  15.05652881320566 Time :  1984
accuracy train: 0.977378 val: 0.967273 test: 0.968493
max validation accuracy : 0.967273 max acc epoch : 3 test accuracy : 0.968493
Counter({0: 3831, 1: 2419, 2: 1441})

Epoch :  4 loss training:  11.79251484805718 Time :  2007
accuracy train: 0.973137 val: 0.960000 test: 0.967123
max validation accuracy : 0.967273 max acc epoch : 3 test accuracy : 0.968493
Counter({0: 3823, 1: 2421, 2: 1447})

Epoch :  5 loss training:  10.993301676819101 Time :  2031
accuracy train: 0.980610 val: 0.956364 test: 0.965753
max validation accuracy : 0.967273 max acc epoch : 3 test accuracy : 0.968493
Counter({0: 3852, 2: 2400, 1: 1439})

Epoch :  6 loss training:  8.995087299030274 Time :  2055
accuracy train: 0.984650 val: 0.969091 test: 0.971233
max validation accuracy : 0.969091 max acc epoch : 6 test accuracy : 0.971233
Counter({1: 3868, 2: 2387, 0: 1436})

Epoch :  7 loss training:  9.226594384061173 Time :  2078
accuracy train: 0.986265 val: 0.963636 test: 0.964840
max validation accuracy : 0.969091 max acc epoch : 6 test accuracy : 0.971233
Counter({0: 3895, 2: 2349, 1: 1447})

Epoch :  8 loss training:  8.004354536882602 Time :  2102
accuracy train: 0.987679 val: 0.967273 test: 0.969406
max validation accuracy : 0.969091 max acc epoch : 6 test accuracy : 0.971233
Counter({1: 3896, 0: 2346, 2: 1449})

Epoch :  9 loss training:  7.484592316905037 Time :  2125
accuracy train: 0.983034 val: 0.970909 test: 0.966210
max validation accuracy : 0.970909 max acc epoch : 9 test accuracy : 0.966210
Counter({1: 3895, 2: 2348, 0: 1448})

Epoch :  10 loss training:  6.914716960163787 Time :  2147
accuracy train: 0.987679 val: 0.967273 test: 0.968037
max validation accuracy : 0.970909 max acc epoch : 9 test accuracy : 0.966210
Counter({1: 3885, 0: 2362, 2: 1444})

Epoch :  11 loss training:  7.060277042561211 Time :  2170
accuracy train: 0.991315 val: 0.965455 test: 0.963927
max validation accuracy : 0.970909 max acc epoch : 9 test accuracy : 0.966210
Counter({0: 3897, 1: 2345, 2: 1449})

Epoch :  12 loss training:  6.0526647758088075 Time :  2194
accuracy train: 0.991719 val: 0.972727 test: 0.964384
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.964384
Counter({0: 3902, 1: 2331, 2: 1458})

Epoch :  13 loss training:  5.133308605407365 Time :  2218
accuracy train: 0.991921 val: 0.963636 test: 0.967123
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.964384
Counter({0: 3875, 1: 2321, 2: 1495})

Epoch :  14 loss training:  5.176830985816196 Time :  2243
accuracy train: 0.992729 val: 0.970909 test: 0.960274
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.964384
Counter({0: 3875, 1: 2324, 2: 1492})

Epoch :  15 loss training:  4.583725349337328 Time :  2267
accuracy train: 0.993335 val: 0.965455 test: 0.968037
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.964384
Counter({1: 3916, 0: 2321, 2: 1454})

Epoch :  16 loss training:  5.316981575160753 Time :  2291
accuracy train: 0.992123 val: 0.967273 test: 0.962100
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.964384
Counter({0: 3929, 1: 2309, 2: 1453})

Epoch :  17 loss training:  4.3594633369357325 Time :  2316
accuracy train: 0.995152 val: 0.965455 test: 0.966210
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.964384
Counter({2: 3929, 1: 2305, 0: 1457})

Epoch :  18 loss training:  3.5828009182878304 Time :  2342
accuracy train: 0.996970 val: 0.967273 test: 0.966667
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.964384
Counter({0: 3925, 1: 2312, 2: 1454})

Epoch :  19 loss training:  2.2145494545111433 Time :  2366
accuracy train: 0.996364 val: 0.969091 test: 0.963927
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.964384
Counter({0: 3930, 1: 2311, 2: 1450})

Epoch :  20 loss training:  2.809686768014217 Time :  2390
accuracy train: 0.995960 val: 0.969091 test: 0.964840
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.964384
Counter({2: 3931, 0: 2306, 1: 1454})

Epoch :  21 loss training:  1.9691652354958933 Time :  2413
accuracy train: 0.996566 val: 0.969091 test: 0.967580
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.964384
Counter({2: 3931, 1: 2303, 0: 1457})

Epoch :  22 loss training:  2.2097050530283013 Time :  2438
accuracy train: 0.996768 val: 0.970909 test: 0.969863
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.964384
Counter({1: 3930, 0: 2303, 2: 1458})

Epoch :  23 loss training:  2.012316709398874 Time :  2461
accuracy train: 0.996970 val: 0.965455 test: 0.968950
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.964384
Counter({0: 3931, 2: 2302, 1: 1458})

Epoch :  24 loss training:  1.8205282313138014 Time :  2487
accuracy train: 0.996566 val: 0.969091 test: 0.972146
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.964384
Counter({0: 3932, 1: 2303, 2: 1456})

Epoch :  25 loss training:  1.5287371775084466 Time :  2509
accuracy train: 0.997374 val: 0.974545 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({0: 3911, 1: 2309, 2: 1471})

Epoch :  26 loss training:  1.6776902058263659 Time :  2533
accuracy train: 0.995152 val: 0.965455 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({0: 3916, 1: 2304, 2: 1471})

Epoch :  27 loss training:  1.9413989187160041 Time :  2558
accuracy train: 0.997172 val: 0.970909 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({1: 3917, 2: 2301, 0: 1473})

Epoch :  28 loss training:  2.1030929871849366 Time :  2584
accuracy train: 0.997172 val: 0.970909 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({1: 3928, 2: 2305, 0: 1458})

Epoch :  29 loss training:  1.7038467972015496 Time :  2610
accuracy train: 0.996566 val: 0.965455 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({0: 3930, 1: 2301, 2: 1460})

Epoch :  30 loss training:  1.9079483271616482 Time :  2635
accuracy train: 0.997172 val: 0.960000 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({0: 3930, 1: 2298, 2: 1463})

Epoch :  31 loss training:  1.6760946723807137 Time :  2659
accuracy train: 0.995152 val: 0.974545 test: 0.962557
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({0: 3930, 1: 2293, 2: 1468})

Epoch :  32 loss training:  2.433267816915759 Time :  2684
accuracy train: 0.996768 val: 0.956364 test: 0.967123
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({0: 3930, 1: 2293, 2: 1468})

Epoch :  33 loss training:  1.730118140732884 Time :  2708
accuracy train: 0.997576 val: 0.969091 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({1: 3925, 0: 2293, 2: 1473})

Epoch :  34 loss training:  2.3245193881830346 Time :  2735
accuracy train: 0.995152 val: 0.963636 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({1: 3925, 2: 2297, 0: 1469})

Epoch :  35 loss training:  2.610910503004561 Time :  2759
accuracy train: 0.997374 val: 0.967273 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({1: 3926, 2: 2295, 0: 1470})

Epoch :  36 loss training:  2.271715462266002 Time :  2784
accuracy train: 0.996970 val: 0.965455 test: 0.974429
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({1: 3925, 2: 2294, 0: 1472})

Epoch :  37 loss training:  2.260276730175974 Time :  2807
accuracy train: 0.994749 val: 0.965455 test: 0.966210
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({0: 3924, 2: 2293, 1: 1474})

Epoch :  38 loss training:  1.5209432583396847 Time :  2831
accuracy train: 0.994951 val: 0.965455 test: 0.966210
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({1: 3925, 0: 2292, 2: 1474})

Epoch :  39 loss training:  1.4945029149675975 Time :  2856
accuracy train: 0.995152 val: 0.963636 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({0: 3923, 1: 2293, 2: 1475})

Epoch :  40 loss training:  1.691651763041591 Time :  2881
accuracy train: 0.996768 val: 0.961818 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({0: 3924, 1: 2292, 2: 1475})

Epoch :  41 loss training:  1.541071478869526 Time :  2905
accuracy train: 0.997778 val: 0.967273 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({0: 3925, 1: 2292, 2: 1474})

Epoch :  42 loss training:  1.3692778226632072 Time :  2929
accuracy train: 0.997374 val: 0.965455 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({0: 3924, 2: 2292, 1: 1475})

Epoch :  43 loss training:  1.5755840389683726 Time :  2955
accuracy train: 0.994951 val: 0.961818 test: 0.963927
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({2: 3929, 1: 2292, 0: 1470})

Epoch :  44 loss training:  1.275544852936946 Time :  2980
accuracy train: 0.997576 val: 0.963636 test: 0.965753
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({1: 3929, 0: 2292, 2: 1470})

Epoch :  45 loss training:  1.3878659565034468 Time :  3005
accuracy train: 0.995758 val: 0.965455 test: 0.967123
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({0: 3929, 2: 2291, 1: 1471})

Epoch :  46 loss training:  1.7502183344586228 Time :  3027
accuracy train: 0.996768 val: 0.958182 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({1: 3930, 2: 2288, 0: 1473})

Epoch :  47 loss training:  1.7822129502783355 Time :  3051
accuracy train: 0.996364 val: 0.969091 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({0: 3929, 1: 2293, 2: 1469})

Epoch :  48 loss training:  1.7534282909909962 Time :  3077
accuracy train: 0.996970 val: 0.970909 test: 0.962557
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({1: 3929, 0: 2293, 2: 1469})

Epoch :  49 loss training:  1.3659916091783089 Time :  3102
accuracy train: 0.997374 val: 0.967273 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({1: 3930, 0: 2291, 2: 1470})

Epoch :  50 loss training:  1.1673304778614693 Time :  3127
accuracy train: 0.997172 val: 0.969091 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({1: 3930, 0: 2291, 2: 1470})

Epoch :  51 loss training:  1.3687859186829883 Time :  3151
accuracy train: 0.994547 val: 0.958182 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({0: 3930, 2: 2291, 1: 1470})

Epoch :  52 loss training:  1.4938989576503445 Time :  3173
accuracy train: 0.997576 val: 0.972727 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({1: 3931, 2: 2291, 0: 1469})

Epoch :  53 loss training:  1.2591996215833205 Time :  3197
accuracy train: 0.996364 val: 0.969091 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({1: 3930, 0: 2292, 2: 1469})

Epoch :  54 loss training:  1.249049045098218 Time :  3221
accuracy train: 0.997374 val: 0.972727 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({0: 3929, 1: 2292, 2: 1470})

Epoch :  55 loss training:  1.6403971630134038 Time :  3245
accuracy train: 0.997172 val: 0.960000 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({2: 3929, 0: 2292, 1: 1470})

Epoch :  56 loss training:  1.4108618337704684 Time :  3269
accuracy train: 0.997576 val: 0.969091 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 25 test accuracy : 0.970320
Counter({1: 3925, 2: 2292, 0: 1474})

========================================================================================================================================================================================================
max acc epoch :  25
max validation accuracy :  0.9745454545454545
test accuracy :  0.9703196347031964
last test_accuracy :  0.9684931506849315
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=864, weight_decay=0)
device :  cuda:0
Counter({1: 4230, 2: 2303, 0: 1158})

Epoch :  1 loss training:  45.94486513361335 Time :  3301
accuracy train: 0.948293 val: 0.927273 test: 0.959361
max validation accuracy : 0.927273 max acc epoch : 1 test accuracy : 0.959361
Counter({1: 3666, 2: 2538, 0: 1487})

Epoch :  2 loss training:  18.45389872440137 Time :  3327
accuracy train: 0.963644 val: 0.954545 test: 0.965297
max validation accuracy : 0.954545 max acc epoch : 2 test accuracy : 0.965297
Counter({1: 3749, 0: 2456, 2: 1486})

Epoch :  3 loss training:  14.982079181820154 Time :  3353
accuracy train: 0.978590 val: 0.963636 test: 0.971689
max validation accuracy : 0.963636 max acc epoch : 3 test accuracy : 0.971689
Counter({0: 3817, 1: 2428, 2: 1446})

Epoch :  4 loss training:  11.879705931525677 Time :  3375
accuracy train: 0.974753 val: 0.958182 test: 0.966210
max validation accuracy : 0.963636 max acc epoch : 3 test accuracy : 0.971689
Counter({2: 3817, 1: 2424, 0: 1450})

Epoch :  5 loss training:  11.21076530055143 Time :  3397
accuracy train: 0.980610 val: 0.956364 test: 0.967123
max validation accuracy : 0.963636 max acc epoch : 3 test accuracy : 0.971689
Counter({2: 3851, 1: 2398, 0: 1442})

Epoch :  6 loss training:  9.000188411679119 Time :  3420
accuracy train: 0.983640 val: 0.969091 test: 0.970320
max validation accuracy : 0.969091 max acc epoch : 6 test accuracy : 0.970320
Counter({0: 3863, 2: 2389, 1: 1439})

Epoch :  7 loss training:  8.900576462387107 Time :  3445
accuracy train: 0.986669 val: 0.960000 test: 0.964384
max validation accuracy : 0.969091 max acc epoch : 6 test accuracy : 0.970320
Counter({0: 3893, 1: 2353, 2: 1445})

Epoch :  8 loss training:  7.768579663126729 Time :  3468
accuracy train: 0.987881 val: 0.965455 test: 0.962557
max validation accuracy : 0.969091 max acc epoch : 6 test accuracy : 0.970320
Counter({2: 3898, 1: 2346, 0: 1447})

Epoch :  9 loss training:  8.16115074022673 Time :  3491
accuracy train: 0.985054 val: 0.969091 test: 0.967580
max validation accuracy : 0.969091 max acc epoch : 6 test accuracy : 0.970320
Counter({0: 3900, 1: 2344, 2: 1447})

Epoch :  10 loss training:  6.789311274886131 Time :  3512
accuracy train: 0.988689 val: 0.965455 test: 0.967123
max validation accuracy : 0.969091 max acc epoch : 6 test accuracy : 0.970320
Counter({0: 3902, 2: 2342, 1: 1447})

Epoch :  11 loss training:  6.457837535650469 Time :  3533
accuracy train: 0.993335 val: 0.972727 test: 0.968037
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({0: 3897, 2: 2333, 1: 1461})

Epoch :  12 loss training:  5.751488908746978 Time :  3557
accuracy train: 0.990709 val: 0.970909 test: 0.961644
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({0: 3925, 1: 2304, 2: 1462})

Epoch :  13 loss training:  4.5932003441266716 Time :  3581
accuracy train: 0.991517 val: 0.960000 test: 0.967580
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({0: 3916, 1: 2298, 2: 1477})

Epoch :  14 loss training:  4.549461772607174 Time :  3605
accuracy train: 0.993537 val: 0.967273 test: 0.963470
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({1: 3914, 0: 2300, 2: 1477})

Epoch :  15 loss training:  4.624221339181531 Time :  3628
accuracy train: 0.992729 val: 0.963636 test: 0.968037
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({0: 3929, 1: 2300, 2: 1462})

Epoch :  16 loss training:  4.926943499944173 Time :  3652
accuracy train: 0.992729 val: 0.969091 test: 0.966210
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({0: 3933, 1: 2292, 2: 1466})

Epoch :  17 loss training:  3.4640091316541657 Time :  3673
accuracy train: 0.994749 val: 0.960000 test: 0.970320
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({0: 3932, 2: 2295, 1: 1464})

Epoch :  18 loss training:  3.217984894057736 Time :  3698
accuracy train: 0.995960 val: 0.969091 test: 0.964840
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({0: 3937, 1: 2295, 2: 1459})

Epoch :  19 loss training:  2.626979818509426 Time :  3721
accuracy train: 0.996768 val: 0.965455 test: 0.971233
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({0: 3938, 1: 2298, 2: 1455})

Epoch :  20 loss training:  2.3402750180466683 Time :  3744
accuracy train: 0.996768 val: 0.965455 test: 0.970320
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({1: 3938, 2: 2289, 0: 1464})

Epoch :  21 loss training:  1.9652400025806855 Time :  3765
accuracy train: 0.996970 val: 0.967273 test: 0.969406
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({1: 3936, 2: 2289, 0: 1466})

Epoch :  22 loss training:  2.4407323359773727 Time :  3787
accuracy train: 0.996162 val: 0.963636 test: 0.970776
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({1: 3937, 0: 2293, 2: 1461})

Epoch :  23 loss training:  2.17602038053883 Time :  3812
accuracy train: 0.996162 val: 0.965455 test: 0.968037
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({2: 3936, 1: 2293, 0: 1462})

Epoch :  24 loss training:  2.1767469667611294 Time :  3834
accuracy train: 0.996162 val: 0.969091 test: 0.967123
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({0: 3936, 1: 2291, 2: 1464})

Epoch :  25 loss training:  2.0840609324368415 Time :  3857
accuracy train: 0.996566 val: 0.970909 test: 0.967580
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({1: 3936, 2: 2294, 0: 1461})

Epoch :  26 loss training:  1.7608726920589106 Time :  3881
accuracy train: 0.996970 val: 0.967273 test: 0.965753
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({1: 3937, 0: 2294, 2: 1460})

Epoch :  27 loss training:  1.7371569384667964 Time :  3903
accuracy train: 0.994951 val: 0.963636 test: 0.964840
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({1: 3935, 2: 2298, 0: 1458})

Epoch :  28 loss training:  1.9908993161625403 Time :  3928
accuracy train: 0.997576 val: 0.972727 test: 0.969406
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({1: 3934, 2: 2298, 0: 1459})

Epoch :  29 loss training:  2.0896246212068945 Time :  3952
accuracy train: 0.995758 val: 0.963636 test: 0.969863
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({1: 3935, 0: 2296, 2: 1460})

Epoch :  30 loss training:  1.8633723628663574 Time :  3975
accuracy train: 0.996768 val: 0.969091 test: 0.967580
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({0: 3936, 1: 2296, 2: 1459})

Epoch :  31 loss training:  1.6436311992765695 Time :  3999
accuracy train: 0.996566 val: 0.967273 test: 0.969406
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({1: 3936, 0: 2296, 2: 1459})

Epoch :  32 loss training:  1.5884448400520341 Time :  4021
accuracy train: 0.996768 val: 0.960000 test: 0.972603
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({0: 3936, 1: 2295, 2: 1460})

Epoch :  33 loss training:  1.4614954935259448 Time :  4043
accuracy train: 0.996970 val: 0.965455 test: 0.971233
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({1: 3936, 0: 2294, 2: 1461})

Epoch :  34 loss training:  1.3771427830261018 Time :  4066
accuracy train: 0.994951 val: 0.961818 test: 0.968037
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({1: 3937, 2: 2295, 0: 1459})

Epoch :  35 loss training:  1.9776734621118521 Time :  4088
accuracy train: 0.997576 val: 0.965455 test: 0.965753
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({1: 3936, 2: 2295, 0: 1460})

Epoch :  36 loss training:  1.8400475804082816 Time :  4109
accuracy train: 0.996970 val: 0.965455 test: 0.968493
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({0: 3935, 1: 2296, 2: 1460})

Epoch :  37 loss training:  2.231193958732547 Time :  4131
accuracy train: 0.995354 val: 0.961818 test: 0.966667
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({0: 3936, 2: 2291, 1: 1464})

Epoch :  38 loss training:  1.610046623944072 Time :  4154
accuracy train: 0.995354 val: 0.958182 test: 0.966210
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({0: 3934, 1: 2291, 2: 1466})

Epoch :  39 loss training:  1.566512109996438 Time :  4176
accuracy train: 0.997374 val: 0.965455 test: 0.967123
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({0: 3934, 1: 2292, 2: 1465})

Epoch :  40 loss training:  1.2725068691943306 Time :  4198
accuracy train: 0.996768 val: 0.963636 test: 0.968037
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({0: 3933, 1: 2292, 2: 1466})

Epoch :  41 loss training:  1.5039943666779436 Time :  4221
accuracy train: 0.997778 val: 0.967273 test: 0.968950
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({0: 3933, 1: 2291, 2: 1467})

Epoch :  42 loss training:  1.4791258518980612 Time :  4245
accuracy train: 0.997374 val: 0.961818 test: 0.965753
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.968037
Counter({1: 3932, 0: 2294, 2: 1465})

========================================================================================================================================================================================================
max acc epoch :  11
max validation accuracy :  0.9727272727272728
test accuracy :  0.9680365296803652
last test_accuracy :  0.9657534246575342
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=864, weight_decay=0)
device :  cuda:0
Counter({1: 4230, 2: 2303, 0: 1158})

Epoch :  1 loss training:  45.959265653043985 Time :  4276
accuracy train: 0.948293 val: 0.927273 test: 0.958904
max validation accuracy : 0.927273 max acc epoch : 1 test accuracy : 0.958904
Counter({2: 3666, 1: 2538, 0: 1487})

Epoch :  2 loss training:  18.402557803783566 Time :  4298
accuracy train: 0.964452 val: 0.956364 test: 0.966667
max validation accuracy : 0.956364 max acc epoch : 2 test accuracy : 0.966667
Counter({1: 3753, 0: 2452, 2: 1486})

Epoch :  3 loss training:  15.185657593421638 Time :  4319
accuracy train: 0.977176 val: 0.961818 test: 0.970320
max validation accuracy : 0.961818 max acc epoch : 3 test accuracy : 0.970320
Counter({0: 3820, 1: 2433, 2: 1438})

Epoch :  4 loss training:  11.783444970380515 Time :  4340
accuracy train: 0.972733 val: 0.960000 test: 0.966210
max validation accuracy : 0.961818 max acc epoch : 3 test accuracy : 0.970320
Counter({0: 3811, 1: 2427, 2: 1453})

Epoch :  5 loss training:  11.403154377127066 Time :  4363
accuracy train: 0.978590 val: 0.956364 test: 0.963014
max validation accuracy : 0.961818 max acc epoch : 3 test accuracy : 0.970320
Counter({0: 3847, 2: 2403, 1: 1441})

Epoch :  6 loss training:  9.009328726446256 Time :  4385
accuracy train: 0.984650 val: 0.970909 test: 0.972146
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.972146
Counter({1: 3868, 0: 2384, 2: 1439})

Epoch :  7 loss training:  9.138783678761683 Time :  4408
accuracy train: 0.986265 val: 0.961818 test: 0.963014
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.972146
Counter({0: 3894, 2: 2345, 1: 1452})

Epoch :  8 loss training:  7.800270508043468 Time :  4430
accuracy train: 0.987477 val: 0.965455 test: 0.967580
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.972146
Counter({1: 3897, 0: 2343, 2: 1451})

Epoch :  9 loss training:  7.474984921747819 Time :  4453
accuracy train: 0.983236 val: 0.969091 test: 0.966667
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.972146
Counter({2: 3895, 0: 2351, 1: 1445})

Epoch :  10 loss training:  7.339021175750531 Time :  4475
accuracy train: 0.988083 val: 0.965455 test: 0.964384
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.972146
Counter({0: 3903, 2: 2342, 1: 1446})

Epoch :  11 loss training:  6.560991451726295 Time :  4498
accuracy train: 0.990911 val: 0.972727 test: 0.961644
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({2: 3869, 1: 2338, 0: 1484})

Epoch :  12 loss training:  5.599753391754348 Time :  4519
accuracy train: 0.991315 val: 0.965455 test: 0.958447
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({0: 3920, 1: 2315, 2: 1456})

Epoch :  13 loss training:  4.927748871152289 Time :  4539
accuracy train: 0.990911 val: 0.958182 test: 0.965297
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({0: 3898, 1: 2304, 2: 1489})

Epoch :  14 loss training:  4.645525633764919 Time :  4561
accuracy train: 0.992729 val: 0.969091 test: 0.957078
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({0: 3924, 1: 2303, 2: 1464})

Epoch :  15 loss training:  3.862369834969286 Time :  4583
accuracy train: 0.993739 val: 0.965455 test: 0.963927
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({0: 3939, 2: 2304, 1: 1448})

Epoch :  16 loss training:  5.06896666236571 Time :  4604
accuracy train: 0.989295 val: 0.961818 test: 0.957991
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({0: 3949, 1: 2276, 2: 1466})

Epoch :  17 loss training:  4.6554749954957515 Time :  4629
accuracy train: 0.994749 val: 0.956364 test: 0.962557
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({1: 3943, 2: 2282, 0: 1466})

Epoch :  18 loss training:  3.024629113788251 Time :  4652
accuracy train: 0.996768 val: 0.961818 test: 0.963927
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({0: 3944, 2: 2287, 1: 1460})

Epoch :  19 loss training:  2.4026982646028046 Time :  4673
accuracy train: 0.996364 val: 0.961818 test: 0.964384
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({0: 3937, 1: 2281, 2: 1473})

Epoch :  20 loss training:  2.417844293639064 Time :  4697
accuracy train: 0.996566 val: 0.961818 test: 0.968493
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({0: 3951, 1: 2278, 2: 1462})

Epoch :  21 loss training:  2.1417752211200423 Time :  4718
accuracy train: 0.996162 val: 0.965455 test: 0.964384
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({1: 3949, 2: 2276, 0: 1466})

Epoch :  22 loss training:  2.024474683115841 Time :  4741
accuracy train: 0.996364 val: 0.961818 test: 0.966667
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({0: 3950, 1: 2277, 2: 1464})

Epoch :  23 loss training:  2.142651429545367 Time :  4762
accuracy train: 0.995960 val: 0.958182 test: 0.965753
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({1: 3945, 0: 2277, 2: 1469})

Epoch :  24 loss training:  2.187071174994344 Time :  4786
accuracy train: 0.996364 val: 0.965455 test: 0.961644
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({1: 3945, 0: 2270, 2: 1476})

Epoch :  25 loss training:  2.1288026495676604 Time :  4811
accuracy train: 0.996970 val: 0.963636 test: 0.962557
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({0: 3944, 1: 2271, 2: 1476})

Epoch :  26 loss training:  1.6762462188708014 Time :  4835
accuracy train: 0.994951 val: 0.960000 test: 0.961644
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({1: 3949, 2: 2271, 0: 1471})

Epoch :  27 loss training:  1.4897708314892952 Time :  4859
accuracy train: 0.997172 val: 0.965455 test: 0.967580
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({1: 3943, 2: 2273, 0: 1475})

Epoch :  28 loss training:  1.705325601682489 Time :  4882
accuracy train: 0.997576 val: 0.969091 test: 0.962100
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({1: 3946, 0: 2273, 2: 1472})

Epoch :  29 loss training:  1.505074842254544 Time :  4904
accuracy train: 0.996162 val: 0.965455 test: 0.960274
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({2: 3950, 1: 2273, 0: 1468})

Epoch :  30 loss training:  1.7590665200514195 Time :  4926
accuracy train: 0.996364 val: 0.967273 test: 0.961644
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({0: 3950, 1: 2273, 2: 1468})

Epoch :  31 loss training:  1.6243525475547358 Time :  4948
accuracy train: 0.997172 val: 0.961818 test: 0.963014
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({1: 3950, 2: 2276, 0: 1465})

Epoch :  32 loss training:  1.7691412581480108 Time :  4970
accuracy train: 0.996768 val: 0.969091 test: 0.962100
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({0: 3949, 2: 2268, 1: 1474})

Epoch :  33 loss training:  1.5949655126023572 Time :  4993
accuracy train: 0.996970 val: 0.965455 test: 0.961644
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({2: 3942, 0: 2268, 1: 1481})

Epoch :  34 loss training:  2.5125640823202957 Time :  5017
accuracy train: 0.992931 val: 0.956364 test: 0.959361
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({0: 3906, 1: 2293, 2: 1492})

Epoch :  35 loss training:  2.7252433115827444 Time :  5040
accuracy train: 0.997778 val: 0.961818 test: 0.962100
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({1: 3946, 2: 2286, 0: 1459})

Epoch :  36 loss training:  3.2228311048747855 Time :  5063
accuracy train: 0.985054 val: 0.956364 test: 0.948858
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({2: 3918, 1: 2245, 0: 1528})

Epoch :  37 loss training:  6.066894528092234 Time :  5086
accuracy train: 0.995354 val: 0.965455 test: 0.960731
max validation accuracy : 0.972727 max acc epoch : 11 test accuracy : 0.961644
Counter({0: 3851, 1: 2223, 2: 1617})

Epoch :  38 loss training:  2.4786724336227053 Time :  5110
accuracy train: 0.996566 val: 0.976364 test: 0.960274
max validation accuracy : 0.976364 max acc epoch : 38 test accuracy : 0.960274
Counter({0: 3832, 1: 2198, 2: 1661})

Epoch :  39 loss training:  2.084651985387609 Time :  5133
accuracy train: 0.997576 val: 0.974545 test: 0.963014
max validation accuracy : 0.976364 max acc epoch : 38 test accuracy : 0.960274
Counter({0: 3790, 1: 2111, 2: 1790})

Epoch :  40 loss training:  3.483620850893203 Time :  5155
accuracy train: 0.996768 val: 0.972727 test: 0.967580
max validation accuracy : 0.976364 max acc epoch : 38 test accuracy : 0.960274
Counter({1: 3119, 0: 2972, 2: 1600})

Epoch :  41 loss training:  3.2848323879297823 Time :  5178
accuracy train: 0.992729 val: 0.963636 test: 0.963470
max validation accuracy : 0.976364 max acc epoch : 38 test accuracy : 0.960274
Counter({0: 2908, 2: 2474, 1: 2309})

Epoch :  42 loss training:  2.8207833336055046 Time :  5200
accuracy train: 0.997576 val: 0.978182 test: 0.961187
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({0: 2912, 2: 2507, 1: 2272})

Epoch :  43 loss training:  2.0721537781937514 Time :  5224
accuracy train: 0.996970 val: 0.972727 test: 0.963470
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({1: 3063, 2: 2351, 0: 2277})

Epoch :  44 loss training:  1.8498650162509875 Time :  5247
accuracy train: 0.997374 val: 0.974545 test: 0.964840
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({1: 3075, 2: 2341, 0: 2275})

Epoch :  45 loss training:  1.4982642192553612 Time :  5270
accuracy train: 0.995758 val: 0.967273 test: 0.965753
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({2: 3084, 0: 2338, 1: 2269})

Epoch :  46 loss training:  1.6853221364835917 Time :  5292
accuracy train: 0.996970 val: 0.976364 test: 0.963927
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({0: 3125, 2: 2293, 1: 2273})

Epoch :  47 loss training:  1.4194306391545979 Time :  5314
accuracy train: 0.997172 val: 0.978182 test: 0.967123
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({0: 3121, 2: 2292, 1: 2278})

Epoch :  48 loss training:  1.4031191090380162 Time :  5336
accuracy train: 0.996970 val: 0.974545 test: 0.964384
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({2: 3072, 1: 2337, 0: 2282})

Epoch :  49 loss training:  1.5340458062128164 Time :  5358
accuracy train: 0.997576 val: 0.978182 test: 0.963927
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({1: 3032, 2: 2382, 0: 2277})

Epoch :  50 loss training:  1.4846812046234845 Time :  5380
accuracy train: 0.997172 val: 0.972727 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({0: 2978, 2: 2447, 1: 2266})

Epoch :  51 loss training:  1.5797305760352174 Time :  5404
accuracy train: 0.996768 val: 0.970909 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({2: 2995, 0: 2427, 1: 2269})

Epoch :  52 loss training:  1.6136091984481027 Time :  5426
accuracy train: 0.997576 val: 0.978182 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({2: 3145, 1: 2275, 0: 2271})

Epoch :  53 loss training:  1.7404614064616908 Time :  5450
accuracy train: 0.996970 val: 0.976364 test: 0.967123
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({0: 3127, 2: 2300, 1: 2264})

Epoch :  54 loss training:  1.2532739654361649 Time :  5470
accuracy train: 0.996970 val: 0.976364 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({0: 3044, 2: 2383, 1: 2264})

Epoch :  55 loss training:  1.4253026669784958 Time :  5492
accuracy train: 0.997778 val: 0.970909 test: 0.964840
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({0: 3057, 2: 2371, 1: 2263})

Epoch :  56 loss training:  1.2607742878662975 Time :  5515
accuracy train: 0.997778 val: 0.974545 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({0: 3854, 2: 2296, 1: 1541})

Epoch :  57 loss training:  2.8911814762905124 Time :  5540
accuracy train: 0.997576 val: 0.976364 test: 0.964384
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({1: 3847, 0: 2284, 2: 1560})

Epoch :  58 loss training:  1.840976670053351 Time :  5563
accuracy train: 0.997778 val: 0.978182 test: 0.964840
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({0: 3749, 2: 2288, 1: 1654})

Epoch :  59 loss training:  1.5825418338899908 Time :  5586
accuracy train: 0.997374 val: 0.972727 test: 0.967123
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({0: 3794, 1: 2292, 2: 1605})

Epoch :  60 loss training:  1.436517250705947 Time :  5607
accuracy train: 0.997778 val: 0.974545 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({0: 3857, 1: 2291, 2: 1543})

Epoch :  61 loss training:  2.2593577541520062 Time :  5628
accuracy train: 0.997374 val: 0.970909 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({0: 3871, 1: 2295, 2: 1525})

Epoch :  62 loss training:  1.9315839447153849 Time :  5651
accuracy train: 0.997576 val: 0.976364 test: 0.967123
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({1: 3905, 0: 2284, 2: 1502})

Epoch :  63 loss training:  1.2990175075938168 Time :  5674
accuracy train: 0.997172 val: 0.974545 test: 0.960731
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({2: 3874, 1: 2278, 0: 1539})

Epoch :  64 loss training:  1.3602873720419666 Time :  5696
accuracy train: 0.997172 val: 0.978182 test: 0.963927
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({1: 3849, 0: 2283, 2: 1559})

Epoch :  65 loss training:  1.24667651594973 Time :  5719
accuracy train: 0.997374 val: 0.972727 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({1: 3889, 2: 2284, 0: 1518})

Epoch :  66 loss training:  1.2621001503703155 Time :  5741
accuracy train: 0.997778 val: 0.970909 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({0: 3869, 2: 2289, 1: 1533})

Epoch :  67 loss training:  1.1329303176562462 Time :  5763
accuracy train: 0.997576 val: 0.972727 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({2: 3910, 1: 2289, 0: 1492})

Epoch :  68 loss training:  1.0782557915076723 Time :  5784
accuracy train: 0.997778 val: 0.972727 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({1: 3902, 0: 2292, 2: 1497})

Epoch :  69 loss training:  1.326011412711523 Time :  5804
accuracy train: 0.997576 val: 0.972727 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({2: 3880, 1: 2289, 0: 1522})

Epoch :  70 loss training:  1.216460382879177 Time :  5825
accuracy train: 0.997778 val: 0.976364 test: 0.967123
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({2: 3875, 1: 2290, 0: 1526})

Epoch :  71 loss training:  1.2322796668913725 Time :  5850
accuracy train: 0.997778 val: 0.978182 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({0: 3882, 1: 2284, 2: 1525})

Epoch :  72 loss training:  1.446595695690121 Time :  5872
accuracy train: 0.996970 val: 0.972727 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({1: 3888, 0: 2286, 2: 1517})

Epoch :  73 loss training:  1.5070249164336929 Time :  5895
accuracy train: 0.997576 val: 0.978182 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 42 test accuracy : 0.961187
Counter({1: 3867, 0: 2285, 2: 1539})

========================================================================================================================================================================================================
max acc epoch :  42
max validation accuracy :  0.9781818181818182
test accuracy :  0.9611872146118722
last test_accuracy :  0.9680365296803652
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.97273 	 test_accuracy : 0.96530 	 max_acc epoch :  12 	 last test_accuracy : 0.96164
k :  1 	 val_accuracy : 0.97273 	 test_accuracy : 0.96712 	 max_acc epoch :  10 	 last test_accuracy : 0.96849
k :  2 	 val_accuracy : 0.97455 	 test_accuracy : 0.97032 	 max_acc epoch :  25 	 last test_accuracy : 0.96849
k :  3 	 val_accuracy : 0.97273 	 test_accuracy : 0.96804 	 max_acc epoch :  11 	 last test_accuracy : 0.96575
k :  4 	 val_accuracy : 0.97818 	 test_accuracy : 0.96119 	 max_acc epoch :  42 	 last test_accuracy : 0.96804

avg :  	 val_accuracy : 0.97418 	 test_accuracy : 0.96639 	 last_accuracy : 0.96648


date and time :  Sun Jun  6 00:24:53 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=567, weight_decay=0)
device :  cuda:0
Counter({1: 4233, 2: 2305, 0: 1153})

Epoch :  1 loss training:  89.17720358073711 Time :  23
accuracy train: 0.911129 val: 0.874545 test: 0.915982
max validation accuracy : 0.874545 max acc epoch : 1 test accuracy : 0.915982
Counter({0: 3522, 2: 2608, 1: 1561})

Epoch :  2 loss training:  37.50018198788166 Time :  45
accuracy train: 0.941426 val: 0.932727 test: 0.939726
max validation accuracy : 0.932727 max acc epoch : 2 test accuracy : 0.939726
Counter({1: 3697, 0: 2471, 2: 1523})

Epoch :  3 loss training:  25.162381444126368 Time :  67
accuracy train: 0.958796 val: 0.945455 test: 0.959361
max validation accuracy : 0.945455 max acc epoch : 3 test accuracy : 0.959361
Counter({1: 3764, 0: 2437, 2: 1490})

Epoch :  4 loss training:  18.988721787929535 Time :  87
accuracy train: 0.963240 val: 0.943636 test: 0.964384
max validation accuracy : 0.945455 max acc epoch : 3 test accuracy : 0.959361
Counter({1: 3782, 0: 2428, 2: 1481})

Epoch :  5 loss training:  16.04154374450445 Time :  109
accuracy train: 0.971521 val: 0.947273 test: 0.962100
max validation accuracy : 0.947273 max acc epoch : 5 test accuracy : 0.962100
Counter({1: 3802, 0: 2413, 2: 1476})

Epoch :  6 loss training:  13.84791480191052 Time :  132
accuracy train: 0.968289 val: 0.943636 test: 0.963927
max validation accuracy : 0.947273 max acc epoch : 5 test accuracy : 0.962100
Counter({0: 3821, 2: 2401, 1: 1469})

Epoch :  7 loss training:  11.928645863197744 Time :  153
accuracy train: 0.974753 val: 0.945455 test: 0.955708
max validation accuracy : 0.947273 max acc epoch : 5 test accuracy : 0.962100
Counter({1: 3836, 2: 2384, 0: 1471})

Epoch :  8 loss training:  11.44920452311635 Time :  174
accuracy train: 0.980610 val: 0.952727 test: 0.964384
max validation accuracy : 0.952727 max acc epoch : 8 test accuracy : 0.964384
Counter({1: 3844, 2: 2382, 0: 1465})

Epoch :  9 loss training:  10.106358197983354 Time :  197
accuracy train: 0.977378 val: 0.947273 test: 0.963927
max validation accuracy : 0.952727 max acc epoch : 8 test accuracy : 0.964384
Counter({1: 3850, 0: 2378, 2: 1463})

Epoch :  10 loss training:  11.087155601941049 Time :  220
accuracy train: 0.978388 val: 0.947273 test: 0.968037
max validation accuracy : 0.952727 max acc epoch : 8 test accuracy : 0.964384
Counter({0: 3857, 1: 2375, 2: 1459})

Epoch :  11 loss training:  9.502923466265202 Time :  242
accuracy train: 0.980004 val: 0.949091 test: 0.964384
max validation accuracy : 0.952727 max acc epoch : 8 test accuracy : 0.964384
Counter({0: 3859, 1: 2376, 2: 1456})

Epoch :  12 loss training:  9.351736053824425 Time :  263
accuracy train: 0.985054 val: 0.954545 test: 0.966667
max validation accuracy : 0.954545 max acc epoch : 12 test accuracy : 0.966667
Counter({2: 3866, 0: 2368, 1: 1457})

Epoch :  13 loss training:  8.32276667188853 Time :  286
accuracy train: 0.987073 val: 0.952727 test: 0.968493
max validation accuracy : 0.954545 max acc epoch : 12 test accuracy : 0.966667
Counter({1: 3872, 2: 2362, 0: 1457})

Epoch :  14 loss training:  8.045078424504027 Time :  309
accuracy train: 0.982428 val: 0.947273 test: 0.966210
max validation accuracy : 0.954545 max acc epoch : 12 test accuracy : 0.966667
Counter({1: 3871, 0: 2366, 2: 1454})

Epoch :  15 loss training:  7.1748700111638755 Time :  333
accuracy train: 0.986871 val: 0.954545 test: 0.967123
max validation accuracy : 0.954545 max acc epoch : 12 test accuracy : 0.966667
Counter({0: 3873, 1: 2362, 2: 1456})

Epoch :  16 loss training:  7.221085538156331 Time :  358
accuracy train: 0.989093 val: 0.956364 test: 0.966210
max validation accuracy : 0.956364 max acc epoch : 16 test accuracy : 0.966210
Counter({1: 3896, 2: 2338, 0: 1457})

Epoch :  17 loss training:  6.360365515574813 Time :  380
accuracy train: 0.989093 val: 0.952727 test: 0.967580
max validation accuracy : 0.956364 max acc epoch : 16 test accuracy : 0.966210
Counter({0: 3897, 1: 2339, 2: 1455})

Epoch :  18 loss training:  6.128617414855398 Time :  403
accuracy train: 0.990305 val: 0.958182 test: 0.968493
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968493
Counter({1: 3903, 0: 2336, 2: 1452})

Epoch :  19 loss training:  6.014870374696329 Time :  424
accuracy train: 0.988891 val: 0.952727 test: 0.972146
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968493
Counter({0: 3900, 1: 2337, 2: 1454})

Epoch :  20 loss training:  4.96820733579807 Time :  446
accuracy train: 0.993335 val: 0.956364 test: 0.965753
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968493
Counter({0: 3928, 1: 2300, 2: 1463})

Epoch :  21 loss training:  4.961197337019257 Time :  472
accuracy train: 0.994143 val: 0.958182 test: 0.964840
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968493
Counter({0: 3929, 1: 2299, 2: 1463})

Epoch :  22 loss training:  4.1947226074989885 Time :  510
accuracy train: 0.993941 val: 0.950909 test: 0.966210
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968493
Counter({0: 3929, 2: 2295, 1: 1467})

Epoch :  23 loss training:  3.7520599628333002 Time :  548
accuracy train: 0.994951 val: 0.956364 test: 0.966667
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968493
Counter({2: 3929, 1: 2293, 0: 1469})

Epoch :  24 loss training:  3.4546036140527576 Time :  583
accuracy train: 0.995758 val: 0.960000 test: 0.965753
max validation accuracy : 0.960000 max acc epoch : 24 test accuracy : 0.965753
Counter({1: 3933, 2: 2290, 0: 1468})

Epoch :  25 loss training:  3.3427657928259578 Time :  606
accuracy train: 0.995152 val: 0.952727 test: 0.966210
max validation accuracy : 0.960000 max acc epoch : 24 test accuracy : 0.965753
Counter({2: 3934, 0: 2287, 1: 1470})

Epoch :  26 loss training:  3.2561154105933383 Time :  631
accuracy train: 0.995556 val: 0.952727 test: 0.968037
max validation accuracy : 0.960000 max acc epoch : 24 test accuracy : 0.965753
Counter({1: 3936, 0: 2287, 2: 1468})

Epoch :  27 loss training:  2.8358611611183733 Time :  653
accuracy train: 0.995152 val: 0.950909 test: 0.965297
max validation accuracy : 0.960000 max acc epoch : 24 test accuracy : 0.965753
Counter({1: 3936, 0: 2287, 2: 1468})

Epoch :  28 loss training:  2.5261758880806156 Time :  675
accuracy train: 0.996768 val: 0.961818 test: 0.964384
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({0: 3935, 1: 2289, 2: 1467})

Epoch :  29 loss training:  2.7864733256865293 Time :  696
accuracy train: 0.996364 val: 0.956364 test: 0.966667
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({1: 3939, 2: 2284, 0: 1468})

Epoch :  30 loss training:  3.6900078315811697 Time :  718
accuracy train: 0.996970 val: 0.956364 test: 0.966667
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({2: 3939, 1: 2281, 0: 1471})

Epoch :  31 loss training:  3.0283195656957105 Time :  741
accuracy train: 0.996364 val: 0.954545 test: 0.965297
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({0: 3939, 1: 2281, 2: 1471})

Epoch :  32 loss training:  2.3822528559248894 Time :  763
accuracy train: 0.995354 val: 0.958182 test: 0.963927
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({1: 3939, 0: 2280, 2: 1472})

Epoch :  33 loss training:  2.0328125256928615 Time :  784
accuracy train: 0.996162 val: 0.958182 test: 0.966210
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({1: 3939, 0: 2280, 2: 1472})

Epoch :  34 loss training:  2.113274883653503 Time :  808
accuracy train: 0.997374 val: 0.958182 test: 0.967123
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({0: 3939, 1: 2280, 2: 1472})

Epoch :  35 loss training:  1.9011776463885326 Time :  830
accuracy train: 0.997172 val: 0.954545 test: 0.967123
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({1: 3939, 2: 2281, 0: 1471})

Epoch :  36 loss training:  2.0032330842514057 Time :  853
accuracy train: 0.997374 val: 0.956364 test: 0.967123
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({1: 3937, 0: 2278, 2: 1476})

Epoch :  37 loss training:  1.5650730815541465 Time :  875
accuracy train: 0.997172 val: 0.954545 test: 0.968950
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({0: 3937, 1: 2278, 2: 1476})

Epoch :  38 loss training:  1.7129520059388597 Time :  899
accuracy train: 0.998182 val: 0.954545 test: 0.965297
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({1: 3936, 2: 2279, 0: 1476})

Epoch :  39 loss training:  1.9319309205457103 Time :  921
accuracy train: 0.997778 val: 0.960000 test: 0.964384
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({0: 3936, 1: 2279, 2: 1476})

Epoch :  40 loss training:  1.563659416846349 Time :  943
accuracy train: 0.997980 val: 0.956364 test: 0.968037
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({0: 3937, 2: 2280, 1: 1474})

Epoch :  41 loss training:  1.4654337178362766 Time :  967
accuracy train: 0.997778 val: 0.954545 test: 0.968037
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({0: 3937, 1: 2279, 2: 1475})

Epoch :  42 loss training:  1.4799196300737094 Time :  990
accuracy train: 0.997576 val: 0.956364 test: 0.965297
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({0: 3937, 1: 2280, 2: 1474})

Epoch :  43 loss training:  1.2793885646970011 Time :  1012
accuracy train: 0.997980 val: 0.950909 test: 0.966210
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({2: 3937, 1: 2279, 0: 1475})

Epoch :  44 loss training:  1.5397099987894762 Time :  1034
accuracy train: 0.996364 val: 0.954545 test: 0.963014
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({0: 3938, 1: 2279, 2: 1474})

Epoch :  45 loss training:  1.322510280104325 Time :  1058
accuracy train: 0.997576 val: 0.954545 test: 0.965297
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({0: 3938, 1: 2280, 2: 1473})

Epoch :  46 loss training:  1.1178846872862778 Time :  1082
accuracy train: 0.997980 val: 0.956364 test: 0.963927
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({1: 3938, 0: 2280, 2: 1473})

Epoch :  47 loss training:  1.3672153938387055 Time :  1105
accuracy train: 0.997778 val: 0.952727 test: 0.968037
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({1: 3938, 2: 2279, 0: 1474})

Epoch :  48 loss training:  1.2573881907592295 Time :  1130
accuracy train: 0.996566 val: 0.958182 test: 0.963470
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({1: 3938, 0: 2282, 2: 1471})

Epoch :  49 loss training:  1.5117281192360679 Time :  1150
accuracy train: 0.997576 val: 0.956364 test: 0.967123
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({1: 3938, 0: 2281, 2: 1472})

Epoch :  50 loss training:  1.424088148996816 Time :  1172
accuracy train: 0.998182 val: 0.960000 test: 0.966667
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({0: 3938, 1: 2282, 2: 1471})

Epoch :  51 loss training:  1.2841569888332742 Time :  1194
accuracy train: 0.997576 val: 0.952727 test: 0.967580
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({0: 3938, 2: 2280, 1: 1473})

Epoch :  52 loss training:  1.2368811160995392 Time :  1218
accuracy train: 0.998182 val: 0.950909 test: 0.969406
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({0: 3938, 1: 2279, 2: 1474})

Epoch :  53 loss training:  1.1805095811214414 Time :  1242
accuracy train: 0.998182 val: 0.960000 test: 0.966210
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({1: 3938, 0: 2279, 2: 1474})

Epoch :  54 loss training:  1.2474761392149958 Time :  1265
accuracy train: 0.998182 val: 0.958182 test: 0.968037
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({1: 3938, 2: 2279, 0: 1474})

Epoch :  55 loss training:  1.157563880784437 Time :  1287
accuracy train: 0.998182 val: 0.961818 test: 0.965753
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({0: 3938, 1: 2279, 2: 1474})

Epoch :  56 loss training:  0.9333037271499052 Time :  1311
accuracy train: 0.998182 val: 0.958182 test: 0.965753
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({1: 3938, 0: 2280, 2: 1473})

Epoch :  57 loss training:  1.0441674317189609 Time :  1331
accuracy train: 0.997778 val: 0.958182 test: 0.965753
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({0: 3938, 1: 2280, 2: 1473})

Epoch :  58 loss training:  1.0476150891699945 Time :  1354
accuracy train: 0.997778 val: 0.958182 test: 0.968950
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({1: 3938, 2: 2280, 0: 1473})

Epoch :  59 loss training:  1.1425000191520667 Time :  1377
accuracy train: 0.998182 val: 0.956364 test: 0.965297
max validation accuracy : 0.961818 max acc epoch : 28 test accuracy : 0.964384
Counter({1: 3938, 2: 2279, 0: 1474})

========================================================================================================================================================================================================
max acc epoch :  28
max validation accuracy :  0.9618181818181818
test accuracy :  0.9643835616438357
last test_accuracy :  0.965296803652968
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=567, weight_decay=0)
device :  cuda:0
Counter({1: 4233, 2: 2305, 0: 1153})

Epoch :  1 loss training:  89.17691856622696 Time :  1405
accuracy train: 0.911129 val: 0.876364 test: 0.915525
max validation accuracy : 0.876364 max acc epoch : 1 test accuracy : 0.915525
Counter({2: 3522, 0: 2608, 1: 1561})

Epoch :  2 loss training:  37.52980823814869 Time :  1426
accuracy train: 0.942032 val: 0.930909 test: 0.941096
max validation accuracy : 0.930909 max acc epoch : 2 test accuracy : 0.941096
Counter({0: 3700, 1: 2468, 2: 1523})

Epoch :  3 loss training:  25.090743843466043 Time :  1447
accuracy train: 0.959200 val: 0.945455 test: 0.960274
max validation accuracy : 0.945455 max acc epoch : 3 test accuracy : 0.960274
Counter({0: 3765, 1: 2436, 2: 1490})

Epoch :  4 loss training:  18.898708011955023 Time :  1471
accuracy train: 0.963846 val: 0.943636 test: 0.964840
max validation accuracy : 0.945455 max acc epoch : 3 test accuracy : 0.960274
Counter({1: 3780, 0: 2428, 2: 1483})

Epoch :  5 loss training:  16.07336617447436 Time :  1494
accuracy train: 0.970511 val: 0.949091 test: 0.962557
max validation accuracy : 0.949091 max acc epoch : 5 test accuracy : 0.962557
Counter({1: 3799, 0: 2414, 2: 1478})

Epoch :  6 loss training:  13.921324563212693 Time :  1516
accuracy train: 0.967885 val: 0.941818 test: 0.964384
max validation accuracy : 0.949091 max acc epoch : 5 test accuracy : 0.962557
Counter({0: 3817, 1: 2405, 2: 1469})

Epoch :  7 loss training:  12.102387891151011 Time :  1540
accuracy train: 0.974551 val: 0.947273 test: 0.956621
max validation accuracy : 0.949091 max acc epoch : 5 test accuracy : 0.962557
Counter({0: 3832, 1: 2386, 2: 1473})

Epoch :  8 loss training:  11.541584149003029 Time :  1562
accuracy train: 0.980408 val: 0.950909 test: 0.965297
max validation accuracy : 0.950909 max acc epoch : 8 test accuracy : 0.965297
Counter({0: 3841, 1: 2382, 2: 1468})

Epoch :  9 loss training:  10.227556199766695 Time :  1585
accuracy train: 0.978388 val: 0.947273 test: 0.964384
max validation accuracy : 0.950909 max acc epoch : 8 test accuracy : 0.965297
Counter({1: 3851, 0: 2372, 2: 1468})

Epoch :  10 loss training:  10.960901818238199 Time :  1607
accuracy train: 0.978590 val: 0.945455 test: 0.968493
max validation accuracy : 0.950909 max acc epoch : 8 test accuracy : 0.965297
Counter({1: 3862, 2: 2371, 0: 1458})

Epoch :  11 loss training:  9.687208479270339 Time :  1630
accuracy train: 0.979398 val: 0.949091 test: 0.966210
max validation accuracy : 0.950909 max acc epoch : 8 test accuracy : 0.965297
Counter({1: 3866, 0: 2371, 2: 1454})

Epoch :  12 loss training:  9.263400852214545 Time :  1652
accuracy train: 0.984448 val: 0.956364 test: 0.965753
max validation accuracy : 0.956364 max acc epoch : 12 test accuracy : 0.965753
Counter({1: 3872, 0: 2367, 2: 1452})

Epoch :  13 loss training:  8.277608688455075 Time :  1675
accuracy train: 0.986871 val: 0.952727 test: 0.966667
max validation accuracy : 0.956364 max acc epoch : 12 test accuracy : 0.965753
Counter({2: 3880, 0: 2363, 1: 1448})

Epoch :  14 loss training:  8.213197250152007 Time :  1697
accuracy train: 0.981620 val: 0.950909 test: 0.966667
max validation accuracy : 0.956364 max acc epoch : 12 test accuracy : 0.965753
Counter({1: 3877, 0: 2369, 2: 1445})

Epoch :  15 loss training:  7.337806648109108 Time :  1720
accuracy train: 0.986265 val: 0.956364 test: 0.969406
max validation accuracy : 0.956364 max acc epoch : 12 test accuracy : 0.965753
Counter({0: 3883, 2: 2366, 1: 1442})

Epoch :  16 loss training:  7.164468100527301 Time :  1744
accuracy train: 0.987679 val: 0.954545 test: 0.967123
max validation accuracy : 0.956364 max acc epoch : 12 test accuracy : 0.965753
Counter({2: 3906, 1: 2343, 0: 1442})

Epoch :  17 loss training:  6.4419407825917006 Time :  1767
accuracy train: 0.989497 val: 0.954545 test: 0.969863
max validation accuracy : 0.956364 max acc epoch : 12 test accuracy : 0.965753
Counter({0: 3907, 1: 2341, 2: 1443})

Epoch :  18 loss training:  6.4166914612287655 Time :  1791
accuracy train: 0.989295 val: 0.958182 test: 0.968037
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968037
Counter({1: 3903, 0: 2338, 2: 1450})

Epoch :  19 loss training:  6.126854106783867 Time :  1812
accuracy train: 0.988083 val: 0.950909 test: 0.972603
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968037
Counter({0: 3900, 1: 2340, 2: 1451})

Epoch :  20 loss training:  5.25445782346651 Time :  1836
accuracy train: 0.993133 val: 0.954545 test: 0.967580
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968037
Counter({0: 3924, 1: 2305, 2: 1462})

Epoch :  21 loss training:  4.96943219343666 Time :  1858
accuracy train: 0.993335 val: 0.956364 test: 0.965753
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968037
Counter({1: 3926, 2: 2303, 0: 1462})

Epoch :  22 loss training:  4.202294051880017 Time :  1882
accuracy train: 0.993335 val: 0.954545 test: 0.966667
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968037
Counter({1: 3925, 0: 2297, 2: 1469})

Epoch :  23 loss training:  4.016544389538467 Time :  1902
accuracy train: 0.994951 val: 0.952727 test: 0.967123
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968037
Counter({1: 3927, 0: 2294, 2: 1470})

Epoch :  24 loss training:  3.6359514369396493 Time :  1925
accuracy train: 0.994951 val: 0.956364 test: 0.968493
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968037
Counter({0: 3929, 1: 2292, 2: 1470})

Epoch :  25 loss training:  3.230000156763708 Time :  1950
accuracy train: 0.994951 val: 0.956364 test: 0.967580
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968037
Counter({0: 3931, 1: 2288, 2: 1472})

Epoch :  26 loss training:  3.1857034380664118 Time :  1971
accuracy train: 0.994951 val: 0.952727 test: 0.971233
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968037
Counter({0: 3943, 2: 2289, 1: 1459})

Epoch :  27 loss training:  2.9701091938186437 Time :  1993
accuracy train: 0.994951 val: 0.954545 test: 0.968037
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968037
Counter({0: 3944, 2: 2288, 1: 1459})

Epoch :  28 loss training:  2.5140288663678803 Time :  2018
accuracy train: 0.996566 val: 0.958182 test: 0.965297
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968037
Counter({0: 3932, 2: 2290, 1: 1469})

Epoch :  29 loss training:  2.810783276159782 Time :  2040
accuracy train: 0.996162 val: 0.956364 test: 0.967580
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968037
Counter({1: 3934, 0: 2287, 2: 1470})

Epoch :  30 loss training:  3.5170075439091306 Time :  2063
accuracy train: 0.997172 val: 0.952727 test: 0.968950
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968037
Counter({0: 3935, 1: 2285, 2: 1471})

Epoch :  31 loss training:  3.192988992901519 Time :  2085
accuracy train: 0.996566 val: 0.947273 test: 0.967123
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968037
Counter({0: 3945, 2: 2284, 1: 1462})

Epoch :  32 loss training:  2.323103587026708 Time :  2107
accuracy train: 0.995354 val: 0.952727 test: 0.966210
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968037
Counter({1: 3943, 0: 2282, 2: 1466})

Epoch :  33 loss training:  2.0845370324968826 Time :  2129
accuracy train: 0.996162 val: 0.961818 test: 0.965753
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({2: 3933, 0: 2281, 1: 1477})

Epoch :  34 loss training:  2.214253976882901 Time :  2153
accuracy train: 0.996768 val: 0.949091 test: 0.966210
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({0: 3933, 1: 2284, 2: 1474})

Epoch :  35 loss training:  1.8000512991275173 Time :  2175
accuracy train: 0.996768 val: 0.952727 test: 0.968037
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3933, 2: 2284, 0: 1474})

Epoch :  36 loss training:  2.2187431637139525 Time :  2197
accuracy train: 0.996768 val: 0.952727 test: 0.968493
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3933, 0: 2284, 2: 1474})

Epoch :  37 loss training:  1.6899978850560728 Time :  2219
accuracy train: 0.997172 val: 0.952727 test: 0.971689
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({0: 3933, 2: 2285, 1: 1473})

Epoch :  38 loss training:  1.8996680853160797 Time :  2242
accuracy train: 0.997778 val: 0.950909 test: 0.967580
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3931, 2: 2286, 0: 1474})

Epoch :  39 loss training:  1.8841705488302978 Time :  2263
accuracy train: 0.997172 val: 0.954545 test: 0.963014
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({2: 3930, 1: 2287, 0: 1474})

Epoch :  40 loss training:  1.6040951289178338 Time :  2284
accuracy train: 0.997980 val: 0.952727 test: 0.971233
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3931, 0: 2285, 2: 1475})

Epoch :  41 loss training:  1.5382666005316423 Time :  2306
accuracy train: 0.997576 val: 0.950909 test: 0.966667
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({0: 3931, 1: 2286, 2: 1474})

Epoch :  42 loss training:  1.5219927826983621 Time :  2327
accuracy train: 0.997576 val: 0.954545 test: 0.968037
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({2: 3931, 1: 2287, 0: 1473})

Epoch :  43 loss training:  1.4471371510298923 Time :  2347
accuracy train: 0.997778 val: 0.952727 test: 0.967580
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3931, 0: 2287, 2: 1473})

Epoch :  44 loss training:  1.744053204820375 Time :  2368
accuracy train: 0.995960 val: 0.952727 test: 0.966210
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3932, 0: 2286, 2: 1473})

Epoch :  45 loss training:  1.549982348060439 Time :  2390
accuracy train: 0.997576 val: 0.952727 test: 0.965753
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3932, 2: 2286, 0: 1473})

Epoch :  46 loss training:  1.2889800053526415 Time :  2414
accuracy train: 0.997980 val: 0.950909 test: 0.968493
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({0: 3932, 1: 2285, 2: 1474})

Epoch :  47 loss training:  1.3963451773306588 Time :  2435
accuracy train: 0.997374 val: 0.952727 test: 0.968493
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3932, 0: 2283, 2: 1476})

Epoch :  48 loss training:  1.4859534667411936 Time :  2457
accuracy train: 0.996364 val: 0.950909 test: 0.964384
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3932, 0: 2286, 2: 1473})

Epoch :  49 loss training:  1.578087761423376 Time :  2480
accuracy train: 0.997374 val: 0.954545 test: 0.969406
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3931, 0: 2286, 2: 1474})

Epoch :  50 loss training:  1.39295202253561 Time :  2503
accuracy train: 0.998182 val: 0.954545 test: 0.968037
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({0: 3931, 1: 2286, 2: 1474})

Epoch :  51 loss training:  1.3121568051283248 Time :  2525
accuracy train: 0.997172 val: 0.952727 test: 0.968493
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({0: 3931, 1: 2286, 2: 1474})

Epoch :  52 loss training:  1.2254060490231495 Time :  2547
accuracy train: 0.998182 val: 0.947273 test: 0.968950
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({0: 3931, 1: 2285, 2: 1475})

Epoch :  53 loss training:  1.168946489073278 Time :  2567
accuracy train: 0.997778 val: 0.952727 test: 0.964384
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3931, 0: 2285, 2: 1475})

Epoch :  54 loss training:  1.2693442418021732 Time :  2589
accuracy train: 0.997980 val: 0.956364 test: 0.965753
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({2: 3931, 0: 2285, 1: 1475})

Epoch :  55 loss training:  1.1601350829732837 Time :  2609
accuracy train: 0.997980 val: 0.956364 test: 0.964840
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3931, 2: 2285, 0: 1475})

Epoch :  56 loss training:  1.0758129537316563 Time :  2630
accuracy train: 0.997980 val: 0.950909 test: 0.965753
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3931, 0: 2285, 2: 1475})

Epoch :  57 loss training:  1.2633683677231602 Time :  2651
accuracy train: 0.997778 val: 0.952727 test: 0.966667
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({0: 3931, 1: 2284, 2: 1476})

Epoch :  58 loss training:  1.1767791113743442 Time :  2672
accuracy train: 0.998182 val: 0.949091 test: 0.968037
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3930, 2: 2284, 0: 1477})

Epoch :  59 loss training:  1.3390921388490824 Time :  2695
accuracy train: 0.997778 val: 0.945455 test: 0.965297
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({0: 3931, 2: 2282, 1: 1478})

Epoch :  60 loss training:  1.4979871902251034 Time :  2717
accuracy train: 0.997980 val: 0.945455 test: 0.966210
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3931, 0: 2283, 2: 1477})

Epoch :  61 loss training:  1.1946195979435288 Time :  2739
accuracy train: 0.997576 val: 0.947273 test: 0.963470
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({0: 3930, 2: 2283, 1: 1478})

Epoch :  62 loss training:  1.1403035266666848 Time :  2760
accuracy train: 0.997980 val: 0.949091 test: 0.965753
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3931, 2: 2284, 0: 1476})

Epoch :  63 loss training:  1.104602549381525 Time :  2782
accuracy train: 0.997980 val: 0.949091 test: 0.969406
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({0: 3931, 1: 2284, 2: 1476})

Epoch :  64 loss training:  1.1998499697292573 Time :  2802
accuracy train: 0.998182 val: 0.947273 test: 0.966210
max validation accuracy : 0.961818 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3931, 2: 2284, 0: 1476})

========================================================================================================================================================================================================
max acc epoch :  33
max validation accuracy :  0.9618181818181818
test accuracy :  0.9657534246575342
last test_accuracy :  0.9662100456621004
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=567, weight_decay=0)
device :  cuda:0
Counter({1: 4233, 2: 2305, 0: 1153})

Epoch :  1 loss training:  89.18195037543774 Time :  2834
accuracy train: 0.911533 val: 0.874545 test: 0.915525
max validation accuracy : 0.874545 max acc epoch : 1 test accuracy : 0.915525
Counter({0: 3522, 2: 2609, 1: 1560})

Epoch :  2 loss training:  37.49902167916298 Time :  2856
accuracy train: 0.941224 val: 0.930909 test: 0.939726
max validation accuracy : 0.930909 max acc epoch : 2 test accuracy : 0.939726
Counter({0: 3699, 1: 2470, 2: 1522})

Epoch :  3 loss training:  25.072791047394276 Time :  2876
accuracy train: 0.958998 val: 0.945455 test: 0.959817
max validation accuracy : 0.945455 max acc epoch : 3 test accuracy : 0.959817
Counter({1: 3769, 2: 2433, 0: 1489})

Epoch :  4 loss training:  18.966703180223703 Time :  2896
accuracy train: 0.963442 val: 0.943636 test: 0.963927
max validation accuracy : 0.945455 max acc epoch : 3 test accuracy : 0.959817
Counter({1: 3782, 0: 2430, 2: 1479})

Epoch :  5 loss training:  16.015147369354963 Time :  2915
accuracy train: 0.971723 val: 0.949091 test: 0.963470
max validation accuracy : 0.949091 max acc epoch : 5 test accuracy : 0.963470
Counter({1: 3803, 2: 2414, 0: 1474})

Epoch :  6 loss training:  13.858465000987053 Time :  2935
accuracy train: 0.970107 val: 0.943636 test: 0.966667
max validation accuracy : 0.949091 max acc epoch : 5 test accuracy : 0.963470
Counter({2: 3830, 1: 2393, 0: 1468})

Epoch :  7 loss training:  12.006713103502989 Time :  2953
accuracy train: 0.975560 val: 0.947273 test: 0.955251
max validation accuracy : 0.949091 max acc epoch : 5 test accuracy : 0.963470
Counter({1: 3844, 2: 2378, 0: 1469})

Epoch :  8 loss training:  11.368645208422095 Time :  2971
accuracy train: 0.981216 val: 0.952727 test: 0.964840
max validation accuracy : 0.952727 max acc epoch : 8 test accuracy : 0.964840
Counter({0: 3852, 1: 2373, 2: 1466})

Epoch :  9 loss training:  10.097505719400942 Time :  2992
accuracy train: 0.978388 val: 0.947273 test: 0.963927
max validation accuracy : 0.952727 max acc epoch : 8 test accuracy : 0.964840
Counter({1: 3858, 0: 2368, 2: 1465})

Epoch :  10 loss training:  10.850307889282703 Time :  3011
accuracy train: 0.978994 val: 0.947273 test: 0.969406
max validation accuracy : 0.952727 max acc epoch : 8 test accuracy : 0.964840
Counter({1: 3865, 2: 2368, 0: 1458})

Epoch :  11 loss training:  9.535624153912067 Time :  3031
accuracy train: 0.980610 val: 0.949091 test: 0.966667
max validation accuracy : 0.952727 max acc epoch : 8 test accuracy : 0.964840
Counter({1: 3869, 2: 2369, 0: 1453})

Epoch :  12 loss training:  9.107812424190342 Time :  3051
accuracy train: 0.985256 val: 0.956364 test: 0.967123
max validation accuracy : 0.956364 max acc epoch : 12 test accuracy : 0.967123
Counter({1: 3879, 2: 2365, 0: 1447})

Epoch :  13 loss training:  8.166793192271143 Time :  3072
accuracy train: 0.987477 val: 0.952727 test: 0.965753
max validation accuracy : 0.956364 max acc epoch : 12 test accuracy : 0.967123
Counter({1: 3888, 0: 2366, 2: 1437})

Epoch :  14 loss training:  8.179780697682872 Time :  3092
accuracy train: 0.980812 val: 0.952727 test: 0.968493
max validation accuracy : 0.956364 max acc epoch : 12 test accuracy : 0.967123
Counter({1: 3881, 2: 2371, 0: 1439})

Epoch :  15 loss training:  7.39980429247953 Time :  3113
accuracy train: 0.987477 val: 0.952727 test: 0.969863
max validation accuracy : 0.956364 max acc epoch : 12 test accuracy : 0.967123
Counter({0: 3889, 1: 2365, 2: 1437})

Epoch :  16 loss training:  7.248935031704605 Time :  3133
accuracy train: 0.988891 val: 0.950909 test: 0.968950
max validation accuracy : 0.956364 max acc epoch : 12 test accuracy : 0.967123
Counter({1: 3910, 2: 2341, 0: 1440})

Epoch :  17 loss training:  6.322184274788015 Time :  3154
accuracy train: 0.989295 val: 0.952727 test: 0.968493
max validation accuracy : 0.956364 max acc epoch : 12 test accuracy : 0.967123
Counter({0: 3912, 2: 2339, 1: 1440})

Epoch :  18 loss training:  6.397841428639367 Time :  3173
accuracy train: 0.990103 val: 0.958182 test: 0.968493
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968493
Counter({1: 3909, 0: 2334, 2: 1448})

Epoch :  19 loss training:  6.025909152813256 Time :  3194
accuracy train: 0.989901 val: 0.952727 test: 0.973059
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968493
Counter({0: 3908, 2: 2334, 1: 1449})

Epoch :  20 loss training:  5.110252243466675 Time :  3214
accuracy train: 0.993739 val: 0.956364 test: 0.968037
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968493
Counter({0: 3926, 1: 2308, 2: 1457})

Epoch :  21 loss training:  5.152792171109468 Time :  3234
accuracy train: 0.993739 val: 0.956364 test: 0.967123
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968493
Counter({0: 3928, 1: 2308, 2: 1455})

Epoch :  22 loss training:  4.394321512663737 Time :  3255
accuracy train: 0.994143 val: 0.954545 test: 0.967123
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968493
Counter({2: 3925, 0: 2306, 1: 1460})

Epoch :  23 loss training:  4.025386176188476 Time :  3276
accuracy train: 0.994951 val: 0.954545 test: 0.968950
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968493
Counter({0: 3929, 1: 2300, 2: 1462})

Epoch :  24 loss training:  3.8189920227159746 Time :  3297
accuracy train: 0.994749 val: 0.954545 test: 0.968950
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968493
Counter({1: 3936, 2: 2291, 0: 1464})

Epoch :  25 loss training:  3.4900327606665087 Time :  3317
accuracy train: 0.994749 val: 0.950909 test: 0.966667
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968493
Counter({2: 3943, 1: 2287, 0: 1461})

Epoch :  26 loss training:  3.4133258716319688 Time :  3337
accuracy train: 0.995152 val: 0.954545 test: 0.971233
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968493
Counter({1: 3944, 2: 2287, 0: 1460})

Epoch :  27 loss training:  3.0179318208247423 Time :  3357
accuracy train: 0.994547 val: 0.952727 test: 0.967580
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968493
Counter({0: 3947, 1: 2285, 2: 1459})

Epoch :  28 loss training:  2.7198695588158444 Time :  3377
accuracy train: 0.996768 val: 0.958182 test: 0.966210
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968493
Counter({0: 3935, 2: 2286, 1: 1470})

Epoch :  29 loss training:  2.978905232390389 Time :  3397
accuracy train: 0.996566 val: 0.958182 test: 0.967580
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968493
Counter({1: 3934, 0: 2284, 2: 1473})

Epoch :  30 loss training:  3.7119631002133247 Time :  3416
accuracy train: 0.997172 val: 0.956364 test: 0.968493
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968493
Counter({1: 3935, 0: 2282, 2: 1474})

Epoch :  31 loss training:  3.2474104026332498 Time :  3437
accuracy train: 0.995556 val: 0.949091 test: 0.968037
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968493
Counter({1: 3946, 2: 2280, 0: 1465})

Epoch :  32 loss training:  2.4658845946541987 Time :  3458
accuracy train: 0.995758 val: 0.956364 test: 0.967580
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968493
Counter({1: 3935, 0: 2278, 2: 1478})

Epoch :  33 loss training:  2.1040553808852565 Time :  3479
accuracy train: 0.996364 val: 0.960000 test: 0.965753
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3935, 0: 2279, 2: 1477})

Epoch :  34 loss training:  2.1998177357309032 Time :  3499
accuracy train: 0.996768 val: 0.952727 test: 0.966667
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({0: 3932, 1: 2285, 2: 1474})

Epoch :  35 loss training:  1.8055061121995095 Time :  3520
accuracy train: 0.997172 val: 0.954545 test: 0.967580
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3932, 2: 2285, 0: 1474})

Epoch :  36 loss training:  2.140165816701483 Time :  3541
accuracy train: 0.996970 val: 0.954545 test: 0.967123
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3909, 0: 2285, 2: 1497})

Epoch :  37 loss training:  1.663303704408463 Time :  3561
accuracy train: 0.997172 val: 0.956364 test: 0.971233
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3932, 2: 2285, 0: 1474})

Epoch :  38 loss training:  1.843383079743944 Time :  3582
accuracy train: 0.997374 val: 0.950909 test: 0.968493
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3930, 2: 2287, 0: 1474})

Epoch :  39 loss training:  1.8803946074476698 Time :  3602
accuracy train: 0.997576 val: 0.958182 test: 0.964840
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({0: 3930, 1: 2287, 2: 1474})

Epoch :  40 loss training:  1.4229713071836159 Time :  3623
accuracy train: 0.997980 val: 0.956364 test: 0.968950
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3930, 0: 2287, 2: 1474})

Epoch :  41 loss training:  1.5656434530901606 Time :  3643
accuracy train: 0.997576 val: 0.954545 test: 0.969406
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3907, 0: 2287, 2: 1497})

Epoch :  42 loss training:  1.4163659407931846 Time :  3665
accuracy train: 0.997172 val: 0.956364 test: 0.968950
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3930, 0: 2286, 2: 1475})

Epoch :  43 loss training:  1.3704789041075855 Time :  3685
accuracy train: 0.997980 val: 0.952727 test: 0.968950
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3930, 2: 2285, 0: 1476})

Epoch :  44 loss training:  1.6885774935071822 Time :  3706
accuracy train: 0.996364 val: 0.956364 test: 0.966667
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3908, 0: 2285, 2: 1498})

Epoch :  45 loss training:  1.5772123090828245 Time :  3727
accuracy train: 0.997374 val: 0.956364 test: 0.967123
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({0: 3931, 1: 2285, 2: 1475})

Epoch :  46 loss training:  1.2433446598151932 Time :  3746
accuracy train: 0.997778 val: 0.954545 test: 0.966210
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3931, 0: 2285, 2: 1475})

Epoch :  47 loss training:  1.3992992976127425 Time :  3767
accuracy train: 0.997374 val: 0.952727 test: 0.967123
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({0: 3908, 2: 2285, 1: 1498})

Epoch :  48 loss training:  1.2386575936689042 Time :  3787
accuracy train: 0.996364 val: 0.954545 test: 0.964384
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3931, 2: 2287, 0: 1473})

Epoch :  49 loss training:  1.3069229800021276 Time :  3807
accuracy train: 0.997778 val: 0.954545 test: 0.966210
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3931, 0: 2286, 2: 1474})

Epoch :  50 loss training:  1.4090370005142177 Time :  3829
accuracy train: 0.997778 val: 0.954545 test: 0.967123
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3908, 0: 2286, 2: 1497})

Epoch :  51 loss training:  1.4076341293693986 Time :  3850
accuracy train: 0.997172 val: 0.952727 test: 0.967123
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3931, 0: 2286, 2: 1474})

Epoch :  52 loss training:  1.2346683408104582 Time :  3870
accuracy train: 0.997778 val: 0.954545 test: 0.968037
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({0: 3931, 1: 2287, 2: 1473})

Epoch :  53 loss training:  1.1775473521338427 Time :  3891
accuracy train: 0.997980 val: 0.958182 test: 0.965753
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({0: 3931, 2: 2288, 1: 1472})

Epoch :  54 loss training:  1.2755048160470324 Time :  3912
accuracy train: 0.997980 val: 0.958182 test: 0.966667
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({2: 3908, 0: 2288, 1: 1495})

Epoch :  55 loss training:  1.2346211755866534 Time :  3933
accuracy train: 0.997778 val: 0.954545 test: 0.963014
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({0: 3908, 1: 2288, 2: 1495})

Epoch :  56 loss training:  1.0721893716799968 Time :  3955
accuracy train: 0.997980 val: 0.952727 test: 0.965297
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3907, 0: 2288, 2: 1496})

Epoch :  57 loss training:  1.2163200508257432 Time :  3975
accuracy train: 0.997576 val: 0.958182 test: 0.967123
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({2: 3907, 1: 2286, 0: 1498})

Epoch :  58 loss training:  1.130259957146336 Time :  3995
accuracy train: 0.997778 val: 0.952727 test: 0.968950
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3907, 2: 2286, 0: 1498})

Epoch :  59 loss training:  1.1097847795499547 Time :  4018
accuracy train: 0.997778 val: 0.950909 test: 0.967580
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({2: 3907, 1: 2286, 0: 1498})

Epoch :  60 loss training:  1.1807802515977528 Time :  4039
accuracy train: 0.997980 val: 0.947273 test: 0.967580
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({0: 3930, 1: 2285, 2: 1476})

Epoch :  61 loss training:  1.1602541908141575 Time :  4060
accuracy train: 0.997576 val: 0.956364 test: 0.966667
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({0: 3906, 1: 2286, 2: 1499})

Epoch :  62 loss training:  1.1469239507023303 Time :  4081
accuracy train: 0.997980 val: 0.950909 test: 0.967123
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3907, 0: 2287, 2: 1497})

Epoch :  63 loss training:  1.1241853169922251 Time :  4103
accuracy train: 0.997980 val: 0.950909 test: 0.966667
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3930, 0: 2287, 2: 1474})

Epoch :  64 loss training:  1.1318666050719912 Time :  4125
accuracy train: 0.997980 val: 0.949091 test: 0.965297
max validation accuracy : 0.960000 max acc epoch : 33 test accuracy : 0.965753
Counter({1: 3930, 0: 2287, 2: 1474})

========================================================================================================================================================================================================
max acc epoch :  33
max validation accuracy :  0.96
test accuracy :  0.9657534246575342
last test_accuracy :  0.965296803652968
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=567, weight_decay=0)
device :  cuda:0
Counter({1: 4233, 2: 2305, 0: 1153})

Epoch :  1 loss training:  89.1815893650055 Time :  4154
accuracy train: 0.911533 val: 0.874545 test: 0.915525
max validation accuracy : 0.874545 max acc epoch : 1 test accuracy : 0.915525
Counter({2: 3520, 1: 2617, 0: 1554})

Epoch :  2 loss training:  37.497953698039055 Time :  4176
accuracy train: 0.941830 val: 0.936364 test: 0.940183
max validation accuracy : 0.936364 max acc epoch : 2 test accuracy : 0.940183
Counter({0: 3704, 1: 2472, 2: 1515})

Epoch :  3 loss training:  25.064611952751875 Time :  4196
accuracy train: 0.960210 val: 0.945455 test: 0.959817
max validation accuracy : 0.945455 max acc epoch : 3 test accuracy : 0.959817
Counter({1: 3769, 0: 2436, 2: 1486})

Epoch :  4 loss training:  18.919222127646208 Time :  4216
accuracy train: 0.964250 val: 0.943636 test: 0.964840
max validation accuracy : 0.945455 max acc epoch : 3 test accuracy : 0.959817
Counter({1: 3783, 0: 2427, 2: 1481})

Epoch :  5 loss training:  16.055273856967688 Time :  4236
accuracy train: 0.972329 val: 0.947273 test: 0.961187
max validation accuracy : 0.947273 max acc epoch : 5 test accuracy : 0.961187
Counter({1: 3804, 2: 2411, 0: 1476})

Epoch :  6 loss training:  13.805453483015299 Time :  4255
accuracy train: 0.970107 val: 0.943636 test: 0.965753
max validation accuracy : 0.947273 max acc epoch : 5 test accuracy : 0.961187
Counter({0: 3830, 2: 2391, 1: 1470})

Epoch :  7 loss training:  11.97381706442684 Time :  4275
accuracy train: 0.974349 val: 0.947273 test: 0.956164
max validation accuracy : 0.947273 max acc epoch : 5 test accuracy : 0.961187
Counter({1: 3845, 0: 2379, 2: 1467})

Epoch :  8 loss training:  11.525698996149004 Time :  4296
accuracy train: 0.980408 val: 0.950909 test: 0.965297
max validation accuracy : 0.950909 max acc epoch : 8 test accuracy : 0.965297
Counter({0: 3850, 1: 2377, 2: 1464})

Epoch :  9 loss training:  10.199789206497371 Time :  4315
accuracy train: 0.977580 val: 0.949091 test: 0.963927
max validation accuracy : 0.950909 max acc epoch : 8 test accuracy : 0.965297
Counter({0: 3856, 1: 2374, 2: 1461})

Epoch :  10 loss training:  10.954436264000833 Time :  4334
accuracy train: 0.978388 val: 0.947273 test: 0.968037
max validation accuracy : 0.950909 max acc epoch : 8 test accuracy : 0.965297
Counter({1: 3868, 0: 2373, 2: 1450})

Epoch :  11 loss training:  9.55670793261379 Time :  4355
accuracy train: 0.979600 val: 0.949091 test: 0.967123
max validation accuracy : 0.950909 max acc epoch : 8 test accuracy : 0.965297
Counter({0: 3872, 1: 2370, 2: 1449})

Epoch :  12 loss training:  9.33582643372938 Time :  4375
accuracy train: 0.984246 val: 0.956364 test: 0.966210
max validation accuracy : 0.956364 max acc epoch : 12 test accuracy : 0.966210
Counter({0: 3880, 2: 2364, 1: 1447})

Epoch :  13 loss training:  8.212969837710261 Time :  4394
accuracy train: 0.987477 val: 0.952727 test: 0.966667
max validation accuracy : 0.956364 max acc epoch : 12 test accuracy : 0.966210
Counter({1: 3884, 0: 2363, 2: 1444})

Epoch :  14 loss training:  8.077603451209143 Time :  4413
accuracy train: 0.981822 val: 0.949091 test: 0.966210
max validation accuracy : 0.956364 max acc epoch : 12 test accuracy : 0.966210
Counter({1: 3885, 0: 2365, 2: 1441})

Epoch :  15 loss training:  7.234328739112243 Time :  4434
accuracy train: 0.987073 val: 0.950909 test: 0.968037
max validation accuracy : 0.956364 max acc epoch : 12 test accuracy : 0.966210
Counter({0: 3888, 1: 2364, 2: 1439})

Epoch :  16 loss training:  7.174524096073583 Time :  4456
accuracy train: 0.987881 val: 0.950909 test: 0.966667
max validation accuracy : 0.956364 max acc epoch : 12 test accuracy : 0.966210
Counter({0: 3903, 2: 2347, 1: 1441})

Epoch :  17 loss training:  6.429930560523644 Time :  4478
accuracy train: 0.990103 val: 0.954545 test: 0.968950
max validation accuracy : 0.956364 max acc epoch : 12 test accuracy : 0.966210
Counter({0: 3905, 1: 2345, 2: 1441})

Epoch :  18 loss training:  6.33540968305897 Time :  4499
accuracy train: 0.990103 val: 0.960000 test: 0.968037
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({2: 3902, 1: 2340, 0: 1449})

Epoch :  19 loss training:  6.153429656755179 Time :  4521
accuracy train: 0.988891 val: 0.954545 test: 0.974429
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({1: 3903, 2: 2338, 0: 1450})

Epoch :  20 loss training:  5.221066270722076 Time :  4542
accuracy train: 0.993537 val: 0.952727 test: 0.968037
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({0: 3926, 1: 2304, 2: 1461})

Epoch :  21 loss training:  5.062674404936843 Time :  4564
accuracy train: 0.993335 val: 0.956364 test: 0.966667
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({0: 3927, 1: 2301, 2: 1463})

Epoch :  22 loss training:  4.278464374947362 Time :  4586
accuracy train: 0.994345 val: 0.952727 test: 0.965753
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({1: 3925, 0: 2300, 2: 1466})

Epoch :  23 loss training:  3.896911335992627 Time :  4606
accuracy train: 0.995152 val: 0.954545 test: 0.968037
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({0: 3926, 1: 2297, 2: 1468})

Epoch :  24 loss training:  3.621273534721695 Time :  4628
accuracy train: 0.995556 val: 0.952727 test: 0.967580
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({1: 3940, 2: 2293, 0: 1458})

Epoch :  25 loss training:  3.4225428507634206 Time :  4649
accuracy train: 0.994749 val: 0.952727 test: 0.967580
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({0: 3942, 1: 2288, 2: 1461})

Epoch :  26 loss training:  3.2881805041106418 Time :  4670
accuracy train: 0.995152 val: 0.950909 test: 0.970320
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({0: 3942, 2: 2290, 1: 1459})

Epoch :  27 loss training:  2.9657520873006433 Time :  4690
accuracy train: 0.994951 val: 0.956364 test: 0.968037
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({0: 3942, 1: 2290, 2: 1459})

Epoch :  28 loss training:  2.633611387864221 Time :  4713
accuracy train: 0.996970 val: 0.952727 test: 0.965753
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({0: 3930, 2: 2290, 1: 1471})

Epoch :  29 loss training:  2.800115064426791 Time :  4734
accuracy train: 0.995960 val: 0.958182 test: 0.968493
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({1: 3930, 0: 2286, 2: 1475})

Epoch :  30 loss training:  3.742211955948733 Time :  4753
accuracy train: 0.996970 val: 0.952727 test: 0.969406
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({2: 3931, 1: 2284, 0: 1476})

Epoch :  31 loss training:  3.267354458803311 Time :  4775
accuracy train: 0.996364 val: 0.943636 test: 0.967580
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({1: 3943, 0: 2282, 2: 1466})

Epoch :  32 loss training:  2.5607766113243997 Time :  4796
accuracy train: 0.995556 val: 0.950909 test: 0.968037
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({0: 3931, 1: 2281, 2: 1479})

Epoch :  33 loss training:  2.081763186841272 Time :  4817
accuracy train: 0.996162 val: 0.960000 test: 0.965297
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({0: 3931, 2: 2281, 1: 1479})

Epoch :  34 loss training:  2.2780868667177856 Time :  4838
accuracy train: 0.997374 val: 0.952727 test: 0.968493
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({0: 3931, 1: 2285, 2: 1475})

Epoch :  35 loss training:  1.9000539185653906 Time :  4859
accuracy train: 0.996364 val: 0.950909 test: 0.968950
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({1: 3932, 2: 2285, 0: 1474})

Epoch :  36 loss training:  2.2430065607768483 Time :  4880
accuracy train: 0.996768 val: 0.950909 test: 0.968493
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({1: 3931, 0: 2286, 2: 1474})

Epoch :  37 loss training:  1.7211627244832925 Time :  4901
accuracy train: 0.996970 val: 0.952727 test: 0.971689
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({1: 3931, 0: 2286, 2: 1474})

Epoch :  38 loss training:  1.7568282381544122 Time :  4922
accuracy train: 0.997374 val: 0.949091 test: 0.968950
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({1: 3930, 0: 2287, 2: 1474})

Epoch :  39 loss training:  1.7854424544493668 Time :  4944
accuracy train: 0.997576 val: 0.952727 test: 0.967580
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({0: 3931, 1: 2287, 2: 1473})

Epoch :  40 loss training:  1.5898160340439063 Time :  4963
accuracy train: 0.997576 val: 0.949091 test: 0.970320
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({2: 3930, 1: 2288, 0: 1473})

Epoch :  41 loss training:  1.5079097963462118 Time :  4985
accuracy train: 0.997374 val: 0.945455 test: 0.967123
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({0: 3929, 2: 2290, 1: 1472})

Epoch :  42 loss training:  1.5128222141356673 Time :  5007
accuracy train: 0.997374 val: 0.952727 test: 0.968037
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({0: 3929, 1: 2289, 2: 1473})

Epoch :  43 loss training:  1.3972792917047627 Time :  5028
accuracy train: 0.997576 val: 0.949091 test: 0.969406
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({2: 3929, 1: 2289, 0: 1473})

Epoch :  44 loss training:  1.8445043265528511 Time :  5049
accuracy train: 0.997172 val: 0.954545 test: 0.967123
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({1: 3930, 0: 2289, 2: 1472})

Epoch :  45 loss training:  1.5536400048295036 Time :  5069
accuracy train: 0.997172 val: 0.954545 test: 0.966667
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({1: 3930, 2: 2289, 0: 1472})

Epoch :  46 loss training:  1.300934601087647 Time :  5090
accuracy train: 0.997980 val: 0.956364 test: 0.967580
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({0: 3930, 1: 2288, 2: 1473})

Epoch :  47 loss training:  1.4227863803171203 Time :  5109
accuracy train: 0.997374 val: 0.952727 test: 0.967123
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({1: 3930, 0: 2288, 2: 1473})

Epoch :  48 loss training:  1.2193063983650063 Time :  5129
accuracy train: 0.995758 val: 0.949091 test: 0.967123
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({1: 3907, 2: 2288, 0: 1496})

Epoch :  49 loss training:  1.503249010813306 Time :  5151
accuracy train: 0.997172 val: 0.956364 test: 0.972603
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.968037
Counter({1: 3907, 0: 2288, 2: 1496})

========================================================================================================================================================================================================
max acc epoch :  18
max validation accuracy :  0.96
test accuracy :  0.9680365296803652
last test_accuracy :  0.9726027397260274
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=567, weight_decay=0)
device :  cuda:0
Counter({1: 4233, 2: 2305, 0: 1153})

Epoch :  1 loss training:  89.17623943090439 Time :  5179
accuracy train: 0.911331 val: 0.874545 test: 0.915525
max validation accuracy : 0.874545 max acc epoch : 1 test accuracy : 0.915525
Counter({2: 3522, 1: 2615, 0: 1554})

Epoch :  2 loss training:  37.50811414420605 Time :  5198
accuracy train: 0.941830 val: 0.936364 test: 0.940639
max validation accuracy : 0.936364 max acc epoch : 2 test accuracy : 0.940639
Counter({0: 3702, 1: 2473, 2: 1516})

Epoch :  3 loss training:  25.07872823253274 Time :  5218
accuracy train: 0.960412 val: 0.945455 test: 0.960274
max validation accuracy : 0.945455 max acc epoch : 3 test accuracy : 0.960274
Counter({2: 3765, 0: 2439, 1: 1487})

Epoch :  4 loss training:  18.920277170836926 Time :  5239
accuracy train: 0.964048 val: 0.943636 test: 0.964384
max validation accuracy : 0.945455 max acc epoch : 3 test accuracy : 0.960274
Counter({1: 3779, 0: 2430, 2: 1482})

Epoch :  5 loss training:  16.05823295377195 Time :  5259
accuracy train: 0.971723 val: 0.947273 test: 0.962100
max validation accuracy : 0.947273 max acc epoch : 5 test accuracy : 0.962100
Counter({0: 3800, 2: 2414, 1: 1477})

Epoch :  6 loss training:  13.881351662799716 Time :  5279
accuracy train: 0.970511 val: 0.943636 test: 0.962557
max validation accuracy : 0.947273 max acc epoch : 5 test accuracy : 0.962100
Counter({0: 3822, 1: 2396, 2: 1473})

Epoch :  7 loss training:  12.0423529651016 Time :  5299
accuracy train: 0.975157 val: 0.947273 test: 0.954795
max validation accuracy : 0.947273 max acc epoch : 5 test accuracy : 0.962100
Counter({2: 3836, 1: 2382, 0: 1473})

Epoch :  8 loss training:  11.506086267530918 Time :  5319
accuracy train: 0.980004 val: 0.952727 test: 0.965297
max validation accuracy : 0.952727 max acc epoch : 8 test accuracy : 0.965297
Counter({0: 3842, 1: 2382, 2: 1467})

Epoch :  9 loss training:  10.197993604466319 Time :  5339
accuracy train: 0.978388 val: 0.947273 test: 0.963470
max validation accuracy : 0.952727 max acc epoch : 8 test accuracy : 0.965297
Counter({1: 3847, 0: 2378, 2: 1466})

Epoch :  10 loss training:  10.878049946390092 Time :  5360
accuracy train: 0.978388 val: 0.947273 test: 0.969406
max validation accuracy : 0.952727 max acc epoch : 8 test accuracy : 0.965297
Counter({1: 3853, 2: 2377, 0: 1461})

Epoch :  11 loss training:  9.528648528270423 Time :  5378
accuracy train: 0.980610 val: 0.949091 test: 0.966667
max validation accuracy : 0.952727 max acc epoch : 8 test accuracy : 0.965297
Counter({1: 3854, 0: 2377, 2: 1460})

Epoch :  12 loss training:  9.232667883392423 Time :  5398
accuracy train: 0.985256 val: 0.956364 test: 0.966210
max validation accuracy : 0.956364 max acc epoch : 12 test accuracy : 0.966210
Counter({1: 3860, 2: 2372, 0: 1459})

Epoch :  13 loss training:  8.276976941619068 Time :  5417
accuracy train: 0.986871 val: 0.950909 test: 0.966210
max validation accuracy : 0.956364 max acc epoch : 12 test accuracy : 0.966210
Counter({1: 3877, 2: 2369, 0: 1445})

Epoch :  14 loss training:  8.16395765193738 Time :  5435
accuracy train: 0.981418 val: 0.949091 test: 0.968950
max validation accuracy : 0.956364 max acc epoch : 12 test accuracy : 0.966210
Counter({1: 3874, 0: 2371, 2: 1446})

Epoch :  15 loss training:  7.363059756346047 Time :  5456
accuracy train: 0.986669 val: 0.952727 test: 0.967580
max validation accuracy : 0.956364 max acc epoch : 12 test accuracy : 0.966210
Counter({0: 3881, 1: 2368, 2: 1442})

Epoch :  16 loss training:  7.1175061906687915 Time :  5476
accuracy train: 0.988487 val: 0.952727 test: 0.966667
max validation accuracy : 0.956364 max acc epoch : 12 test accuracy : 0.966210
Counter({2: 3901, 1: 2347, 0: 1443})

Epoch :  17 loss training:  6.366908351657912 Time :  5497
accuracy train: 0.989901 val: 0.954545 test: 0.970320
max validation accuracy : 0.956364 max acc epoch : 12 test accuracy : 0.966210
Counter({0: 3904, 1: 2346, 2: 1441})

Epoch :  18 loss training:  6.304661304806359 Time :  5519
accuracy train: 0.990709 val: 0.958182 test: 0.968493
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968493
Counter({1: 3901, 0: 2342, 2: 1448})

Epoch :  19 loss training:  6.036553100682795 Time :  5539
accuracy train: 0.989093 val: 0.952727 test: 0.973516
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968493
Counter({0: 3898, 1: 2343, 2: 1450})

Epoch :  20 loss training:  5.05708203301765 Time :  5559
accuracy train: 0.993537 val: 0.956364 test: 0.968493
max validation accuracy : 0.958182 max acc epoch : 18 test accuracy : 0.968493
Counter({0: 3924, 1: 2305, 2: 1462})

Epoch :  21 loss training:  4.963048923062161 Time :  5578
accuracy train: 0.993335 val: 0.960000 test: 0.966210
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({0: 3924, 1: 2305, 2: 1462})

Epoch :  22 loss training:  4.189032546943054 Time :  5598
accuracy train: 0.994143 val: 0.952727 test: 0.966210
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({1: 3923, 0: 2302, 2: 1466})

Epoch :  23 loss training:  3.8767794208833948 Time :  5617
accuracy train: 0.995152 val: 0.956364 test: 0.967580
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({0: 3925, 2: 2299, 1: 1467})

Epoch :  24 loss training:  3.720786083722487 Time :  5637
accuracy train: 0.995556 val: 0.954545 test: 0.968037
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({1: 3926, 2: 2296, 0: 1469})

Epoch :  25 loss training:  3.341630135779269 Time :  5657
accuracy train: 0.994951 val: 0.952727 test: 0.968950
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({0: 3927, 1: 2290, 2: 1474})

Epoch :  26 loss training:  3.2015018051606603 Time :  5677
accuracy train: 0.994749 val: 0.950909 test: 0.970320
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({0: 3929, 2: 2290, 1: 1472})

Epoch :  27 loss training:  2.977249211340677 Time :  5697
accuracy train: 0.995354 val: 0.954545 test: 0.968037
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({0: 3930, 1: 2291, 2: 1470})

Epoch :  28 loss training:  2.6801494670799 Time :  5716
accuracy train: 0.996566 val: 0.956364 test: 0.966667
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({0: 3928, 2: 2291, 1: 1472})

Epoch :  29 loss training:  2.880535386619158 Time :  5737
accuracy train: 0.996566 val: 0.958182 test: 0.967580
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({0: 3930, 1: 2287, 2: 1474})

Epoch :  30 loss training:  3.900733333750395 Time :  5757
accuracy train: 0.997172 val: 0.954545 test: 0.968950
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({0: 3930, 1: 2284, 2: 1477})

Epoch :  31 loss training:  3.1554742996231653 Time :  5777
accuracy train: 0.996364 val: 0.952727 test: 0.967580
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({0: 3930, 1: 2283, 2: 1478})

Epoch :  32 loss training:  2.369150189566426 Time :  5800
accuracy train: 0.995556 val: 0.956364 test: 0.966210
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({1: 3930, 0: 2280, 2: 1481})

Epoch :  33 loss training:  1.9447823079826776 Time :  5821
accuracy train: 0.996162 val: 0.956364 test: 0.966667
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({1: 3930, 0: 2280, 2: 1481})

Epoch :  34 loss training:  2.1431171048316173 Time :  5841
accuracy train: 0.997374 val: 0.956364 test: 0.968493
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({0: 3930, 1: 2282, 2: 1479})

Epoch :  35 loss training:  1.8616674297081772 Time :  5861
accuracy train: 0.996970 val: 0.956364 test: 0.968037
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({1: 3907, 2: 2283, 0: 1501})

Epoch :  36 loss training:  2.232392255566083 Time :  5882
accuracy train: 0.996768 val: 0.954545 test: 0.968037
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({1: 3905, 0: 2283, 2: 1503})

Epoch :  37 loss training:  1.6649022831697948 Time :  5902
accuracy train: 0.996970 val: 0.954545 test: 0.972146
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({1: 3905, 0: 2283, 2: 1503})

Epoch :  38 loss training:  1.7993540517272777 Time :  5922
accuracy train: 0.997576 val: 0.952727 test: 0.970320
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({1: 3904, 0: 2284, 2: 1503})

Epoch :  39 loss training:  1.689881895450526 Time :  5943
accuracy train: 0.997374 val: 0.958182 test: 0.966667
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({0: 3927, 1: 2285, 2: 1479})

Epoch :  40 loss training:  1.6091156182519626 Time :  5963
accuracy train: 0.997980 val: 0.954545 test: 0.968950
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({0: 3928, 1: 2284, 2: 1479})

Epoch :  41 loss training:  1.6477043455524836 Time :  5983
accuracy train: 0.997576 val: 0.956364 test: 0.966210
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({0: 3905, 1: 2284, 2: 1502})

Epoch :  42 loss training:  1.5575755418976769 Time :  6005
accuracy train: 0.997374 val: 0.958182 test: 0.968950
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({1: 3904, 0: 2286, 2: 1501})

Epoch :  43 loss training:  1.3918399082467658 Time :  6026
accuracy train: 0.997374 val: 0.952727 test: 0.967123
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({0: 3904, 2: 2286, 1: 1501})

Epoch :  44 loss training:  1.845867907468346 Time :  6047
accuracy train: 0.996970 val: 0.952727 test: 0.967580
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({1: 3906, 0: 2285, 2: 1500})

Epoch :  45 loss training:  1.5175430663730367 Time :  6068
accuracy train: 0.996970 val: 0.956364 test: 0.965753
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({1: 3905, 2: 2285, 0: 1501})

Epoch :  46 loss training:  1.2492490639342577 Time :  6088
accuracy train: 0.997576 val: 0.952727 test: 0.966210
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({1: 3928, 0: 2285, 2: 1478})

Epoch :  47 loss training:  1.3970450134656858 Time :  6108
accuracy train: 0.997374 val: 0.954545 test: 0.966667
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({1: 3906, 0: 2285, 2: 1500})

Epoch :  48 loss training:  1.3746981113945367 Time :  6129
accuracy train: 0.996566 val: 0.956364 test: 0.966667
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({2: 3906, 1: 2285, 0: 1500})

Epoch :  49 loss training:  1.3456092834676383 Time :  6150
accuracy train: 0.997374 val: 0.956364 test: 0.969406
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({2: 3906, 1: 2285, 0: 1500})

Epoch :  50 loss training:  1.4140228890173603 Time :  6171
accuracy train: 0.997980 val: 0.958182 test: 0.969863
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({2: 3929, 1: 2285, 0: 1477})

Epoch :  51 loss training:  1.3424732928469894 Time :  6190
accuracy train: 0.997374 val: 0.950909 test: 0.967580
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({0: 3927, 1: 2286, 2: 1478})

Epoch :  52 loss training:  1.2665277830747073 Time :  6210
accuracy train: 0.997980 val: 0.950909 test: 0.969406
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.966210
Counter({1: 3904, 2: 2286, 0: 1501})

========================================================================================================================================================================================================
max acc epoch :  21
max validation accuracy :  0.96
test accuracy :  0.9662100456621004
last test_accuracy :  0.9694063926940639
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.96182 	 test_accuracy : 0.96438 	 max_acc epoch :  28 	 last test_accuracy : 0.96530
k :  1 	 val_accuracy : 0.96182 	 test_accuracy : 0.96575 	 max_acc epoch :  33 	 last test_accuracy : 0.96621
k :  2 	 val_accuracy : 0.96000 	 test_accuracy : 0.96575 	 max_acc epoch :  33 	 last test_accuracy : 0.96530
k :  3 	 val_accuracy : 0.96000 	 test_accuracy : 0.96804 	 max_acc epoch :  18 	 last test_accuracy : 0.97260
k :  4 	 val_accuracy : 0.96000 	 test_accuracy : 0.96621 	 max_acc epoch :  21 	 last test_accuracy : 0.96941

avg :  	 val_accuracy : 0.96073 	 test_accuracy : 0.96603 	 last_accuracy : 0.96776


date and time :  Sun Jun  6 02:08:36 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=5e-05, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=413, weight_decay=0)
device :  cuda:0
Counter({1: 4233, 2: 2305, 0: 1153})

Epoch :  1 loss training:  125.50150388479233 Time :  20
accuracy train: 0.818421 val: 0.800000 test: 0.834247
max validation accuracy : 0.800000 max acc epoch : 1 test accuracy : 0.834247
Counter({0: 3339, 2: 2525, 1: 1827})

Epoch :  2 loss training:  61.62058374285698 Time :  41
accuracy train: 0.904060 val: 0.892727 test: 0.907306
max validation accuracy : 0.892727 max acc epoch : 2 test accuracy : 0.907306
Counter({1: 3582, 0: 2521, 2: 1588})

Epoch :  3 loss training:  43.6803347915411 Time :  61
accuracy train: 0.930721 val: 0.907273 test: 0.935160
max validation accuracy : 0.907273 max acc epoch : 3 test accuracy : 0.935160
Counter({0: 3655, 1: 2514, 2: 1522})

Epoch :  4 loss training:  33.90716702491045 Time :  81
accuracy train: 0.939002 val: 0.914545 test: 0.940183
max validation accuracy : 0.914545 max acc epoch : 4 test accuracy : 0.940183
Counter({1: 3663, 2: 2499, 0: 1529})

Epoch :  5 loss training:  27.5138948187232 Time :  100
accuracy train: 0.950313 val: 0.932727 test: 0.947032
max validation accuracy : 0.932727 max acc epoch : 5 test accuracy : 0.947032
Counter({1: 3726, 2: 2469, 0: 1496})

Epoch :  6 loss training:  23.61531414836645 Time :  119
accuracy train: 0.952535 val: 0.929091 test: 0.952511
max validation accuracy : 0.932727 max acc epoch : 5 test accuracy : 0.947032
Counter({0: 3750, 1: 2449, 2: 1492})

Epoch :  7 loss training:  21.015715800225735 Time :  139
accuracy train: 0.956776 val: 0.929091 test: 0.960274
max validation accuracy : 0.932727 max acc epoch : 5 test accuracy : 0.947032
Counter({0: 3759, 1: 2443, 2: 1489})

Epoch :  8 loss training:  17.862824879586697 Time :  157
accuracy train: 0.959806 val: 0.934545 test: 0.956621
max validation accuracy : 0.934545 max acc epoch : 8 test accuracy : 0.956621
Counter({0: 3753, 2: 2435, 1: 1503})

Epoch :  9 loss training:  16.501778731122613 Time :  176
accuracy train: 0.962230 val: 0.938182 test: 0.963014
max validation accuracy : 0.938182 max acc epoch : 9 test accuracy : 0.963014
Counter({1: 3771, 0: 2422, 2: 1498})

Epoch :  10 loss training:  15.227562663145363 Time :  195
accuracy train: 0.969299 val: 0.943636 test: 0.965297
max validation accuracy : 0.943636 max acc epoch : 10 test accuracy : 0.965297
Counter({1: 3794, 0: 2405, 2: 1492})

Epoch :  11 loss training:  14.266125608235598 Time :  216
accuracy train: 0.973339 val: 0.945455 test: 0.966210
max validation accuracy : 0.945455 max acc epoch : 11 test accuracy : 0.966210
Counter({1: 3810, 2: 2397, 0: 1484})

Epoch :  12 loss training:  13.675698248669505 Time :  235
accuracy train: 0.972127 val: 0.945455 test: 0.963014
max validation accuracy : 0.945455 max acc epoch : 11 test accuracy : 0.966210
Counter({0: 3816, 1: 2395, 2: 1480})

Epoch :  13 loss training:  12.325943108648062 Time :  254
accuracy train: 0.969905 val: 0.941818 test: 0.965753
max validation accuracy : 0.945455 max acc epoch : 11 test accuracy : 0.966210
Counter({0: 3825, 2: 2390, 1: 1476})

Epoch :  14 loss training:  11.715875385794789 Time :  274
accuracy train: 0.977176 val: 0.945455 test: 0.963927
max validation accuracy : 0.945455 max acc epoch : 11 test accuracy : 0.966210
Counter({2: 3834, 1: 2383, 0: 1474})

Epoch :  15 loss training:  11.613293128088117 Time :  293
accuracy train: 0.980812 val: 0.950909 test: 0.964384
max validation accuracy : 0.950909 max acc epoch : 15 test accuracy : 0.964384
Counter({1: 3846, 0: 2374, 2: 1471})

Epoch :  16 loss training:  10.64648863999173 Time :  313
accuracy train: 0.978994 val: 0.956364 test: 0.966667
max validation accuracy : 0.956364 max acc epoch : 16 test accuracy : 0.966667
Counter({0: 3848, 1: 2373, 2: 1470})

Epoch :  17 loss training:  9.469897472299635 Time :  333
accuracy train: 0.981822 val: 0.954545 test: 0.962557
max validation accuracy : 0.956364 max acc epoch : 16 test accuracy : 0.966667
Counter({0: 3855, 1: 2374, 2: 1462})

Epoch :  18 loss training:  9.650872992351651 Time :  352
accuracy train: 0.984044 val: 0.952727 test: 0.966210
max validation accuracy : 0.956364 max acc epoch : 16 test accuracy : 0.966667
Counter({1: 3868, 0: 2358, 2: 1465})

Epoch :  19 loss training:  8.982775647193193 Time :  373
accuracy train: 0.985659 val: 0.954545 test: 0.963927
max validation accuracy : 0.956364 max acc epoch : 16 test accuracy : 0.966667
Counter({0: 3876, 1: 2351, 2: 1464})

Epoch :  20 loss training:  8.166905398480594 Time :  393
accuracy train: 0.984246 val: 0.952727 test: 0.968037
max validation accuracy : 0.956364 max acc epoch : 16 test accuracy : 0.966667
Counter({0: 3880, 1: 2348, 2: 1463})

Epoch :  21 loss training:  8.26629964960739 Time :  414
accuracy train: 0.986467 val: 0.952727 test: 0.963927
max validation accuracy : 0.956364 max acc epoch : 16 test accuracy : 0.966667
Counter({0: 3887, 1: 2343, 2: 1461})

Epoch :  22 loss training:  8.06731456052512 Time :  434
accuracy train: 0.986467 val: 0.958182 test: 0.967123
max validation accuracy : 0.958182 max acc epoch : 22 test accuracy : 0.967123
Counter({1: 3896, 0: 2337, 2: 1458})

Epoch :  23 loss training:  7.408522791229188 Time :  455
accuracy train: 0.988285 val: 0.960000 test: 0.968037
max validation accuracy : 0.960000 max acc epoch : 23 test accuracy : 0.968037
Counter({1: 3898, 2: 2335, 0: 1458})

Epoch :  24 loss training:  6.914278523996472 Time :  474
accuracy train: 0.987073 val: 0.958182 test: 0.971689
max validation accuracy : 0.960000 max acc epoch : 23 test accuracy : 0.968037
Counter({1: 3898, 2: 2336, 0: 1457})

Epoch :  25 loss training:  6.934695116709918 Time :  497
accuracy train: 0.989699 val: 0.963636 test: 0.967580
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3912, 1: 2325, 2: 1454})

Epoch :  26 loss training:  6.59790412383154 Time :  517
accuracy train: 0.990305 val: 0.958182 test: 0.968037
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({1: 3913, 2: 2320, 0: 1458})

Epoch :  27 loss training:  6.153016472002491 Time :  536
accuracy train: 0.989901 val: 0.961818 test: 0.972603
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({1: 3911, 2: 2320, 0: 1460})

Epoch :  28 loss training:  5.819220495526679 Time :  559
accuracy train: 0.990911 val: 0.961818 test: 0.968950
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3909, 2: 2321, 1: 1461})

Epoch :  29 loss training:  5.604406570084393 Time :  579
accuracy train: 0.989699 val: 0.960000 test: 0.968037
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({1: 3907, 0: 2323, 2: 1461})

Epoch :  30 loss training:  5.6541541100014 Time :  600
accuracy train: 0.991517 val: 0.961818 test: 0.969406
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3910, 1: 2319, 2: 1462})

Epoch :  31 loss training:  5.648749854648486 Time :  621
accuracy train: 0.990709 val: 0.960000 test: 0.968493
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3910, 2: 2321, 1: 1460})

Epoch :  32 loss training:  4.926111009612214 Time :  640
accuracy train: 0.991719 val: 0.961818 test: 0.968037
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3911, 1: 2320, 2: 1460})

Epoch :  33 loss training:  5.106581534375437 Time :  662
accuracy train: 0.992123 val: 0.961818 test: 0.969863
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3915, 1: 2318, 2: 1458})

Epoch :  34 loss training:  4.532301128143445 Time :  684
accuracy train: 0.992931 val: 0.960000 test: 0.969406
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({1: 3915, 0: 2317, 2: 1459})

Epoch :  35 loss training:  4.496893738862127 Time :  704
accuracy train: 0.993335 val: 0.961818 test: 0.969863
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3914, 1: 2319, 2: 1458})

Epoch :  36 loss training:  4.768855600384995 Time :  725
accuracy train: 0.992729 val: 0.961818 test: 0.969406
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3913, 1: 2321, 2: 1457})

Epoch :  37 loss training:  4.472793789347634 Time :  745
accuracy train: 0.993133 val: 0.961818 test: 0.969406
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3915, 1: 2325, 2: 1451})

Epoch :  38 loss training:  3.6687909265165217 Time :  764
accuracy train: 0.994345 val: 0.961818 test: 0.970320
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({1: 3915, 0: 2325, 2: 1451})

Epoch :  39 loss training:  4.007965184864588 Time :  784
accuracy train: 0.994345 val: 0.963636 test: 0.973059
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({1: 3917, 0: 2318, 2: 1456})

Epoch :  40 loss training:  4.083311697118916 Time :  805
accuracy train: 0.995556 val: 0.960000 test: 0.971233
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3920, 2: 2315, 1: 1456})

Epoch :  41 loss training:  3.370467673870735 Time :  837
accuracy train: 0.995152 val: 0.961818 test: 0.969406
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({2: 3919, 0: 2317, 1: 1455})

Epoch :  42 loss training:  3.1592536598909646 Time :  868
accuracy train: 0.994345 val: 0.963636 test: 0.970776
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3920, 1: 2316, 2: 1455})

Epoch :  43 loss training:  3.560268507222645 Time :  889
accuracy train: 0.994749 val: 0.960000 test: 0.971233
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3922, 1: 2313, 2: 1456})

Epoch :  44 loss training:  3.1060228530259337 Time :  910
accuracy train: 0.995960 val: 0.960000 test: 0.971233
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3923, 2: 2312, 1: 1456})

Epoch :  45 loss training:  3.152193674002774 Time :  929
accuracy train: 0.995556 val: 0.960000 test: 0.973059
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3923, 1: 2310, 2: 1458})

Epoch :  46 loss training:  3.6605490809306502 Time :  950
accuracy train: 0.996364 val: 0.961818 test: 0.971233
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3924, 1: 2309, 2: 1458})

Epoch :  47 loss training:  2.9828165531507693 Time :  973
accuracy train: 0.996162 val: 0.960000 test: 0.973973
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3924, 2: 2308, 1: 1459})

Epoch :  48 loss training:  2.923214161186479 Time :  993
accuracy train: 0.995556 val: 0.958182 test: 0.971233
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({1: 3924, 2: 2309, 0: 1458})

Epoch :  49 loss training:  2.444420503685251 Time :  1012
accuracy train: 0.995354 val: 0.961818 test: 0.971233
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({1: 3924, 2: 2309, 0: 1458})

Epoch :  50 loss training:  2.4979515011946205 Time :  1033
accuracy train: 0.995758 val: 0.958182 test: 0.970776
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3924, 1: 2308, 2: 1459})

Epoch :  51 loss training:  2.374030214967206 Time :  1053
accuracy train: 0.996162 val: 0.956364 test: 0.970776
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({1: 3924, 2: 2309, 0: 1458})

Epoch :  52 loss training:  2.444086426665308 Time :  1075
accuracy train: 0.996162 val: 0.961818 test: 0.969406
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3925, 2: 2311, 1: 1455})

Epoch :  53 loss training:  2.1057552533748094 Time :  1096
accuracy train: 0.996162 val: 0.960000 test: 0.970776
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({1: 3925, 0: 2310, 2: 1456})

Epoch :  54 loss training:  2.30458730502869 Time :  1117
accuracy train: 0.996970 val: 0.960000 test: 0.970320
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({2: 3925, 0: 2311, 1: 1455})

Epoch :  55 loss training:  2.196326349338051 Time :  1137
accuracy train: 0.996566 val: 0.961818 test: 0.971689
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3925, 1: 2307, 2: 1459})

Epoch :  56 loss training:  2.5222133342176676 Time :  1157
accuracy train: 0.996364 val: 0.965455 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({0: 3925, 2: 2306, 1: 1460})

Epoch :  57 loss training:  2.784555310732685 Time :  1177
accuracy train: 0.995758 val: 0.961818 test: 0.972146
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({1: 3925, 2: 2306, 0: 1460})

Epoch :  58 loss training:  2.4679958338674624 Time :  1198
accuracy train: 0.996566 val: 0.960000 test: 0.968950
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({1: 3925, 0: 2305, 2: 1461})

Epoch :  59 loss training:  2.1766362864000257 Time :  1219
accuracy train: 0.995556 val: 0.960000 test: 0.968950
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({0: 3925, 2: 2305, 1: 1461})

Epoch :  60 loss training:  2.0584188369102776 Time :  1240
accuracy train: 0.997172 val: 0.961818 test: 0.972603
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({1: 3925, 0: 2305, 2: 1461})

Epoch :  61 loss training:  2.179251626919722 Time :  1261
accuracy train: 0.996364 val: 0.958182 test: 0.969406
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({0: 3926, 2: 2306, 1: 1459})

Epoch :  62 loss training:  2.0404720297665335 Time :  1283
accuracy train: 0.996768 val: 0.958182 test: 0.972146
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({0: 3925, 1: 2307, 2: 1459})

Epoch :  63 loss training:  1.9691847741196398 Time :  1305
accuracy train: 0.996970 val: 0.956364 test: 0.971233
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({0: 3924, 1: 2307, 2: 1460})

Epoch :  64 loss training:  1.7154096810845658 Time :  1327
accuracy train: 0.996566 val: 0.960000 test: 0.973516
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({0: 3923, 1: 2308, 2: 1460})

Epoch :  65 loss training:  1.8538938117417274 Time :  1348
accuracy train: 0.996768 val: 0.958182 test: 0.970776
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({1: 3923, 0: 2307, 2: 1461})

Epoch :  66 loss training:  1.8180745299032424 Time :  1368
accuracy train: 0.996566 val: 0.960000 test: 0.970776
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({2: 3922, 1: 2308, 0: 1461})

Epoch :  67 loss training:  1.728495725619723 Time :  1390
accuracy train: 0.997172 val: 0.960000 test: 0.971233
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({2: 3922, 1: 2308, 0: 1461})

Epoch :  68 loss training:  1.5602308853412978 Time :  1413
accuracy train: 0.997172 val: 0.960000 test: 0.972603
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({2: 3922, 1: 2309, 0: 1460})

Epoch :  69 loss training:  2.0543532689625863 Time :  1434
accuracy train: 0.996970 val: 0.958182 test: 0.971233
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({0: 3922, 1: 2309, 2: 1460})

Epoch :  70 loss training:  1.539459354520659 Time :  1454
accuracy train: 0.996162 val: 0.960000 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({1: 3922, 0: 2308, 2: 1461})

Epoch :  71 loss training:  1.459729038644582 Time :  1474
accuracy train: 0.996970 val: 0.960000 test: 0.968950
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({0: 3922, 1: 2308, 2: 1461})

Epoch :  72 loss training:  1.6374902667594142 Time :  1495
accuracy train: 0.996566 val: 0.960000 test: 0.971233
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({0: 3922, 1: 2308, 2: 1461})

Epoch :  73 loss training:  1.612192122374836 Time :  1516
accuracy train: 0.996566 val: 0.958182 test: 0.969406
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({1: 3922, 0: 2308, 2: 1461})

Epoch :  74 loss training:  1.5418491907039424 Time :  1537
accuracy train: 0.997172 val: 0.960000 test: 0.971689
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({0: 3922, 1: 2309, 2: 1460})

Epoch :  75 loss training:  1.472011083875259 Time :  1557
accuracy train: 0.997374 val: 0.958182 test: 0.970776
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({1: 3922, 0: 2308, 2: 1461})

Epoch :  76 loss training:  1.5881844782270491 Time :  1578
accuracy train: 0.996970 val: 0.956364 test: 0.968493
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({1: 3922, 0: 2308, 2: 1461})

Epoch :  77 loss training:  1.5396328333299607 Time :  1599
accuracy train: 0.996364 val: 0.956364 test: 0.970320
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({0: 3922, 1: 2308, 2: 1461})

Epoch :  78 loss training:  1.4482606693927664 Time :  1620
accuracy train: 0.996566 val: 0.954545 test: 0.970776
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({0: 3922, 1: 2309, 2: 1460})

Epoch :  79 loss training:  1.3518194943972048 Time :  1641
accuracy train: 0.996162 val: 0.956364 test: 0.967580
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({1: 3922, 2: 2309, 0: 1460})

Epoch :  80 loss training:  1.5608154366054805 Time :  1662
accuracy train: 0.996768 val: 0.952727 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({0: 3922, 1: 2309, 2: 1460})

Epoch :  81 loss training:  1.5181261318793986 Time :  1682
accuracy train: 0.997576 val: 0.956364 test: 0.972146
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({1: 3922, 2: 2309, 0: 1460})

Epoch :  82 loss training:  1.6496784163318807 Time :  1703
accuracy train: 0.996970 val: 0.954545 test: 0.970320
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({1: 3922, 0: 2309, 2: 1460})

Epoch :  83 loss training:  1.414785066677723 Time :  1724
accuracy train: 0.997374 val: 0.956364 test: 0.968493
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({0: 3922, 1: 2309, 2: 1460})

Epoch :  84 loss training:  1.2634730326972203 Time :  1745
accuracy train: 0.997374 val: 0.956364 test: 0.970320
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({0: 3922, 1: 2310, 2: 1459})

Epoch :  85 loss training:  1.3863895732501987 Time :  1764
accuracy train: 0.996970 val: 0.956364 test: 0.970776
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({0: 3922, 1: 2310, 2: 1459})

Epoch :  86 loss training:  1.3969931505271234 Time :  1784
accuracy train: 0.997172 val: 0.958182 test: 0.970320
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({0: 3922, 1: 2311, 2: 1458})

Epoch :  87 loss training:  1.4282231630204478 Time :  1806
accuracy train: 0.996566 val: 0.960000 test: 0.972603
max validation accuracy : 0.965455 max acc epoch : 56 test accuracy : 0.969863
Counter({0: 3922, 1: 2313, 2: 1456})

========================================================================================================================================================================================================
max acc epoch :  56
max validation accuracy :  0.9654545454545455
test accuracy :  0.9698630136986301
last test_accuracy :  0.9726027397260274
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=5e-05, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=413, weight_decay=0)
device :  cuda:0
Counter({1: 4233, 2: 2305, 0: 1153})

Epoch :  1 loss training:  125.5014024078846 Time :  1836
accuracy train: 0.818421 val: 0.800000 test: 0.834247
max validation accuracy : 0.800000 max acc epoch : 1 test accuracy : 0.834247
Counter({1: 3339, 2: 2524, 0: 1828})

Epoch :  2 loss training:  61.63522297143936 Time :  1859
accuracy train: 0.905070 val: 0.890909 test: 0.906393
max validation accuracy : 0.890909 max acc epoch : 2 test accuracy : 0.906393
Counter({0: 3585, 2: 2520, 1: 1586})

Epoch :  3 loss training:  43.659354001283646 Time :  1880
accuracy train: 0.930923 val: 0.907273 test: 0.934703
max validation accuracy : 0.907273 max acc epoch : 3 test accuracy : 0.934703
Counter({1: 3656, 0: 2516, 2: 1519})

Epoch :  4 loss training:  33.912895269691944 Time :  1902
accuracy train: 0.939204 val: 0.918182 test: 0.940183
max validation accuracy : 0.918182 max acc epoch : 4 test accuracy : 0.940183
Counter({0: 3692, 1: 2499, 2: 1500})

Epoch :  5 loss training:  27.468699749559164 Time :  1923
accuracy train: 0.949303 val: 0.934545 test: 0.947945
max validation accuracy : 0.934545 max acc epoch : 5 test accuracy : 0.947945
Counter({1: 3724, 2: 2476, 0: 1491})

Epoch :  6 loss training:  23.665099814534187 Time :  1944
accuracy train: 0.953747 val: 0.929091 test: 0.952968
max validation accuracy : 0.934545 max acc epoch : 5 test accuracy : 0.947945
Counter({1: 3750, 2: 2446, 0: 1495})

Epoch :  7 loss training:  20.828958597034216 Time :  1962
accuracy train: 0.956372 val: 0.930909 test: 0.960274
max validation accuracy : 0.934545 max acc epoch : 5 test accuracy : 0.947945
Counter({0: 3760, 1: 2440, 2: 1491})

Epoch :  8 loss training:  17.807248927652836 Time :  1983
accuracy train: 0.958998 val: 0.936364 test: 0.956164
max validation accuracy : 0.936364 max acc epoch : 8 test accuracy : 0.956164
Counter({1: 3750, 0: 2435, 2: 1506})

Epoch :  9 loss training:  16.5920579303056 Time :  2002
accuracy train: 0.962230 val: 0.936364 test: 0.962557
max validation accuracy : 0.936364 max acc epoch : 8 test accuracy : 0.956164
Counter({0: 3764, 2: 2428, 1: 1499})

Epoch :  10 loss training:  15.417935892008245 Time :  2023
accuracy train: 0.968491 val: 0.943636 test: 0.965297
max validation accuracy : 0.943636 max acc epoch : 10 test accuracy : 0.965297
Counter({1: 3792, 0: 2405, 2: 1494})

Epoch :  11 loss training:  14.343241047114134 Time :  2043
accuracy train: 0.973541 val: 0.945455 test: 0.965753
max validation accuracy : 0.945455 max acc epoch : 11 test accuracy : 0.965753
Counter({0: 3813, 1: 2393, 2: 1485})

Epoch :  12 loss training:  13.594010945409536 Time :  2062
accuracy train: 0.972733 val: 0.945455 test: 0.963927
max validation accuracy : 0.945455 max acc epoch : 11 test accuracy : 0.965753
Counter({0: 3825, 2: 2388, 1: 1478})

Epoch :  13 loss training:  12.333226789720356 Time :  2084
accuracy train: 0.970713 val: 0.943636 test: 0.964840
max validation accuracy : 0.945455 max acc epoch : 11 test accuracy : 0.965753
Counter({0: 3828, 2: 2387, 1: 1476})

Epoch :  14 loss training:  11.736636416520923 Time :  2105
accuracy train: 0.977378 val: 0.945455 test: 0.964384
max validation accuracy : 0.945455 max acc epoch : 11 test accuracy : 0.965753
Counter({1: 3834, 2: 2382, 0: 1475})

Epoch :  15 loss training:  11.551895221695304 Time :  2126
accuracy train: 0.980610 val: 0.956364 test: 0.963470
max validation accuracy : 0.956364 max acc epoch : 15 test accuracy : 0.963470
Counter({1: 3847, 0: 2373, 2: 1471})

Epoch :  16 loss training:  10.633100281003863 Time :  2147
accuracy train: 0.979196 val: 0.956364 test: 0.966667
max validation accuracy : 0.956364 max acc epoch : 15 test accuracy : 0.963470
Counter({0: 3850, 1: 2375, 2: 1466})

Epoch :  17 loss training:  9.46804610081017 Time :  2168
accuracy train: 0.982024 val: 0.954545 test: 0.962557
max validation accuracy : 0.956364 max acc epoch : 15 test accuracy : 0.963470
Counter({0: 3856, 1: 2377, 2: 1458})

Epoch :  18 loss training:  9.58878375776112 Time :  2190
accuracy train: 0.983640 val: 0.952727 test: 0.966210
max validation accuracy : 0.956364 max acc epoch : 15 test accuracy : 0.963470
Counter({1: 3863, 2: 2368, 0: 1460})

Epoch :  19 loss training:  9.016671465709805 Time :  2211
accuracy train: 0.985054 val: 0.952727 test: 0.963470
max validation accuracy : 0.956364 max acc epoch : 15 test accuracy : 0.963470
Counter({0: 3871, 2: 2358, 1: 1462})

Epoch :  20 loss training:  8.293489431031048 Time :  2233
accuracy train: 0.984852 val: 0.950909 test: 0.968037
max validation accuracy : 0.956364 max acc epoch : 15 test accuracy : 0.963470
Counter({2: 3877, 1: 2352, 0: 1462})

Epoch :  21 loss training:  8.270832021255046 Time :  2254
accuracy train: 0.986265 val: 0.954545 test: 0.964840
max validation accuracy : 0.956364 max acc epoch : 15 test accuracy : 0.963470
Counter({0: 3885, 1: 2347, 2: 1459})

Epoch :  22 loss training:  7.985041870269924 Time :  2275
accuracy train: 0.986467 val: 0.954545 test: 0.968037
max validation accuracy : 0.956364 max acc epoch : 15 test accuracy : 0.963470
Counter({0: 3892, 1: 2341, 2: 1458})

Epoch :  23 loss training:  7.493749120738357 Time :  2296
accuracy train: 0.988083 val: 0.956364 test: 0.967580
max validation accuracy : 0.956364 max acc epoch : 15 test accuracy : 0.963470
Counter({1: 3893, 2: 2339, 0: 1459})

Epoch :  24 loss training:  6.945103771518916 Time :  2317
accuracy train: 0.986871 val: 0.954545 test: 0.972146
max validation accuracy : 0.956364 max acc epoch : 15 test accuracy : 0.963470
Counter({1: 3894, 0: 2339, 2: 1458})

Epoch :  25 loss training:  6.996470760088414 Time :  2338
accuracy train: 0.989699 val: 0.963636 test: 0.967580
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3912, 1: 2327, 2: 1452})

Epoch :  26 loss training:  6.64935699198395 Time :  2357
accuracy train: 0.989699 val: 0.960000 test: 0.968493
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({2: 3913, 1: 2322, 0: 1456})

Epoch :  27 loss training:  6.18947223527357 Time :  2377
accuracy train: 0.990103 val: 0.963636 test: 0.972146
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({1: 3913, 0: 2321, 2: 1457})

Epoch :  28 loss training:  6.023199958493933 Time :  2399
accuracy train: 0.990911 val: 0.960000 test: 0.968037
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3910, 2: 2322, 1: 1459})

Epoch :  29 loss training:  5.640475162072107 Time :  2419
accuracy train: 0.989699 val: 0.958182 test: 0.968950
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({1: 3909, 0: 2322, 2: 1460})

Epoch :  30 loss training:  5.704867829452269 Time :  2441
accuracy train: 0.991517 val: 0.961818 test: 0.969406
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({1: 3913, 2: 2319, 0: 1459})

Epoch :  31 loss training:  5.774616155424155 Time :  2461
accuracy train: 0.990911 val: 0.960000 test: 0.968950
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3914, 1: 2322, 2: 1455})

Epoch :  32 loss training:  5.018571652355604 Time :  2482
accuracy train: 0.991315 val: 0.961818 test: 0.968950
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3915, 1: 2322, 2: 1454})

Epoch :  33 loss training:  5.023483430151828 Time :  2505
accuracy train: 0.992325 val: 0.961818 test: 0.969863
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3918, 1: 2318, 2: 1455})

Epoch :  34 loss training:  4.531641775043681 Time :  2527
accuracy train: 0.993133 val: 0.960000 test: 0.969863
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({1: 3917, 0: 2318, 2: 1456})

Epoch :  35 loss training:  4.6203666215296835 Time :  2548
accuracy train: 0.993537 val: 0.961818 test: 0.969406
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({1: 3916, 2: 2320, 0: 1455})

Epoch :  36 loss training:  4.709147144691087 Time :  2569
accuracy train: 0.992527 val: 0.961818 test: 0.970320
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3916, 1: 2321, 2: 1454})

Epoch :  37 loss training:  4.535253875888884 Time :  2590
accuracy train: 0.993335 val: 0.961818 test: 0.970776
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3921, 1: 2323, 2: 1447})

Epoch :  38 loss training:  3.7662907845224254 Time :  2610
accuracy train: 0.994345 val: 0.961818 test: 0.970320
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3921, 2: 2323, 1: 1447})

Epoch :  39 loss training:  3.9956347120460123 Time :  2631
accuracy train: 0.993739 val: 0.963636 test: 0.973516
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({1: 3922, 0: 2318, 2: 1451})

Epoch :  40 loss training:  4.1934708608314395 Time :  2651
accuracy train: 0.995354 val: 0.963636 test: 0.971689
max validation accuracy : 0.963636 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3923, 1: 2317, 2: 1451})

Epoch :  41 loss training:  3.5276096304878592 Time :  2674
accuracy train: 0.994345 val: 0.965455 test: 0.968037
max validation accuracy : 0.965455 max acc epoch : 41 test accuracy : 0.968037
Counter({0: 3924, 1: 2316, 2: 1451})

Epoch :  42 loss training:  3.2931642837938853 Time :  2696
accuracy train: 0.994143 val: 0.965455 test: 0.968950
max validation accuracy : 0.965455 max acc epoch : 41 test accuracy : 0.968037
Counter({0: 3927, 1: 2313, 2: 1451})

Epoch :  43 loss training:  3.643118552688975 Time :  2717
accuracy train: 0.994143 val: 0.961818 test: 0.971233
max validation accuracy : 0.965455 max acc epoch : 41 test accuracy : 0.968037
Counter({0: 3928, 1: 2312, 2: 1451})

Epoch :  44 loss training:  3.1696988569456153 Time :  2739
accuracy train: 0.995758 val: 0.963636 test: 0.971689
max validation accuracy : 0.965455 max acc epoch : 41 test accuracy : 0.968037
Counter({0: 3928, 1: 2312, 2: 1451})

Epoch :  45 loss training:  3.25312143744668 Time :  2760
accuracy train: 0.994951 val: 0.961818 test: 0.973059
max validation accuracy : 0.965455 max acc epoch : 41 test accuracy : 0.968037
Counter({0: 3928, 1: 2312, 2: 1451})

Epoch :  46 loss training:  3.7277756930561736 Time :  2782
accuracy train: 0.996162 val: 0.963636 test: 0.971233
max validation accuracy : 0.965455 max acc epoch : 41 test accuracy : 0.968037
Counter({1: 3928, 0: 2312, 2: 1451})

Epoch :  47 loss training:  3.246206136071123 Time :  2804
accuracy train: 0.995960 val: 0.963636 test: 0.972146
max validation accuracy : 0.965455 max acc epoch : 41 test accuracy : 0.968037
Counter({0: 3922, 1: 2310, 2: 1459})

Epoch :  48 loss training:  3.0496503523318097 Time :  2826
accuracy train: 0.995758 val: 0.961818 test: 0.970776
max validation accuracy : 0.965455 max acc epoch : 41 test accuracy : 0.968037
Counter({1: 3921, 2: 2310, 0: 1460})

Epoch :  49 loss training:  2.6416659259120934 Time :  2846
accuracy train: 0.995152 val: 0.963636 test: 0.970320
max validation accuracy : 0.965455 max acc epoch : 41 test accuracy : 0.968037
Counter({1: 3921, 2: 2310, 0: 1460})

Epoch :  50 loss training:  2.6663593843986746 Time :  2868
accuracy train: 0.995152 val: 0.961818 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 41 test accuracy : 0.968037
Counter({0: 3921, 2: 2310, 1: 1460})

Epoch :  51 loss training:  2.5234906076220796 Time :  2889
accuracy train: 0.995960 val: 0.958182 test: 0.970776
max validation accuracy : 0.965455 max acc epoch : 41 test accuracy : 0.968037
Counter({0: 3921, 1: 2310, 2: 1460})

Epoch :  52 loss training:  2.490912109031342 Time :  2910
accuracy train: 0.995960 val: 0.963636 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 41 test accuracy : 0.968037
Counter({1: 3920, 2: 2310, 0: 1461})

Epoch :  53 loss training:  2.258336656203028 Time :  2934
accuracy train: 0.995960 val: 0.963636 test: 0.968493
max validation accuracy : 0.965455 max acc epoch : 41 test accuracy : 0.968037
Counter({0: 3920, 1: 2310, 2: 1461})

Epoch :  54 loss training:  2.5211021463910583 Time :  2954
accuracy train: 0.996566 val: 0.963636 test: 0.968950
max validation accuracy : 0.965455 max acc epoch : 41 test accuracy : 0.968037
Counter({0: 3927, 1: 2310, 2: 1454})

Epoch :  55 loss training:  2.2584620385605376 Time :  2976
accuracy train: 0.996162 val: 0.967273 test: 0.972146
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({1: 3927, 2: 2309, 0: 1455})

Epoch :  56 loss training:  2.6000903075910173 Time :  2997
accuracy train: 0.995960 val: 0.965455 test: 0.969863
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({0: 3928, 1: 2309, 2: 1454})

Epoch :  57 loss training:  2.808322631579358 Time :  3017
accuracy train: 0.995960 val: 0.965455 test: 0.971233
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({1: 3931, 0: 2307, 2: 1453})

Epoch :  58 loss training:  2.469701457885094 Time :  3040
accuracy train: 0.995960 val: 0.963636 test: 0.968037
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({1: 3931, 0: 2307, 2: 1453})

Epoch :  59 loss training:  2.219395644046017 Time :  3060
accuracy train: 0.995556 val: 0.961818 test: 0.968493
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({0: 3931, 1: 2307, 2: 1453})

Epoch :  60 loss training:  2.1427540143195074 Time :  3082
accuracy train: 0.996768 val: 0.965455 test: 0.971233
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({1: 3931, 0: 2308, 2: 1452})

Epoch :  61 loss training:  2.2470997973287012 Time :  3103
accuracy train: 0.996364 val: 0.965455 test: 0.969863
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({0: 3931, 1: 2307, 2: 1453})

Epoch :  62 loss training:  1.9673041048226878 Time :  3124
accuracy train: 0.996768 val: 0.960000 test: 0.971689
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({0: 3929, 1: 2309, 2: 1453})

Epoch :  63 loss training:  1.89362244453514 Time :  3145
accuracy train: 0.996970 val: 0.961818 test: 0.970320
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({0: 3929, 1: 2309, 2: 1453})

Epoch :  64 loss training:  1.7987113762501394 Time :  3167
accuracy train: 0.996566 val: 0.963636 test: 0.972603
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({0: 3929, 1: 2310, 2: 1452})

Epoch :  65 loss training:  1.8802325683645904 Time :  3187
accuracy train: 0.996768 val: 0.965455 test: 0.968493
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({1: 3929, 0: 2309, 2: 1453})

Epoch :  66 loss training:  1.8763935751048848 Time :  3210
accuracy train: 0.996364 val: 0.965455 test: 0.969406
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({0: 3929, 1: 2308, 2: 1454})

Epoch :  67 loss training:  1.7472217247268418 Time :  3231
accuracy train: 0.996768 val: 0.961818 test: 0.969863
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({0: 3929, 1: 2308, 2: 1454})

Epoch :  68 loss training:  1.6087195161235286 Time :  3252
accuracy train: 0.996768 val: 0.960000 test: 0.969863
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({1: 3929, 0: 2309, 2: 1453})

Epoch :  69 loss training:  2.2584523759724107 Time :  3273
accuracy train: 0.996970 val: 0.960000 test: 0.968493
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({0: 3928, 1: 2309, 2: 1454})

Epoch :  70 loss training:  1.7388268584763864 Time :  3296
accuracy train: 0.995960 val: 0.960000 test: 0.968493
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({1: 3928, 0: 2308, 2: 1455})

Epoch :  71 loss training:  1.5090031626168638 Time :  3317
accuracy train: 0.996768 val: 0.961818 test: 0.968037
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({0: 3928, 1: 2309, 2: 1454})

Epoch :  72 loss training:  1.6876843411009759 Time :  3338
accuracy train: 0.995960 val: 0.961818 test: 0.969863
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({0: 3928, 1: 2309, 2: 1454})

Epoch :  73 loss training:  1.6247467137509375 Time :  3358
accuracy train: 0.996364 val: 0.958182 test: 0.967580
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({1: 3927, 0: 2310, 2: 1454})

Epoch :  74 loss training:  1.462612126604654 Time :  3380
accuracy train: 0.996566 val: 0.960000 test: 0.969863
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({1: 3927, 0: 2310, 2: 1454})

Epoch :  75 loss training:  1.5315416239973274 Time :  3401
accuracy train: 0.996970 val: 0.960000 test: 0.971233
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({0: 3927, 1: 2310, 2: 1454})

Epoch :  76 loss training:  1.6229825892660301 Time :  3422
accuracy train: 0.996970 val: 0.958182 test: 0.967123
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({0: 3920, 1: 2310, 2: 1461})

Epoch :  77 loss training:  1.632781123262248 Time :  3443
accuracy train: 0.996162 val: 0.958182 test: 0.971233
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({1: 3927, 2: 2310, 0: 1454})

Epoch :  78 loss training:  1.4486121390364133 Time :  3463
accuracy train: 0.996364 val: 0.958182 test: 0.970320
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({0: 3927, 1: 2310, 2: 1454})

Epoch :  79 loss training:  1.4256034112768248 Time :  3485
accuracy train: 0.995960 val: 0.958182 test: 0.967580
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({1: 3927, 0: 2310, 2: 1454})

Epoch :  80 loss training:  1.584082982808468 Time :  3507
accuracy train: 0.996566 val: 0.954545 test: 0.969863
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({1: 3927, 2: 2310, 0: 1454})

Epoch :  81 loss training:  1.96107274213864 Time :  3527
accuracy train: 0.997172 val: 0.960000 test: 0.968493
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({1: 3927, 2: 2310, 0: 1454})

Epoch :  82 loss training:  1.8095233000203734 Time :  3549
accuracy train: 0.996970 val: 0.960000 test: 0.968493
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({1: 3927, 0: 2309, 2: 1455})

Epoch :  83 loss training:  1.520329555220087 Time :  3572
accuracy train: 0.996970 val: 0.958182 test: 0.968037
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({1: 3927, 2: 2309, 0: 1455})

Epoch :  84 loss training:  1.260358383617131 Time :  3591
accuracy train: 0.997172 val: 0.960000 test: 0.968950
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({0: 3927, 1: 2309, 2: 1455})

Epoch :  85 loss training:  1.5531177455195575 Time :  3612
accuracy train: 0.996768 val: 0.958182 test: 0.969863
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({0: 3927, 2: 2309, 1: 1455})

Epoch :  86 loss training:  1.4089339654165087 Time :  3635
accuracy train: 0.997172 val: 0.961818 test: 0.969863
max validation accuracy : 0.967273 max acc epoch : 55 test accuracy : 0.972146
Counter({0: 3927, 1: 2309, 2: 1455})

========================================================================================================================================================================================================
max acc epoch :  55
max validation accuracy :  0.9672727272727273
test accuracy :  0.9721461187214612
last test_accuracy :  0.9698630136986301
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=5e-05, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=413, weight_decay=0)
device :  cuda:0
Counter({1: 4233, 2: 2305, 0: 1153})

Epoch :  1 loss training:  125.50067436695099 Time :  3665
accuracy train: 0.818421 val: 0.800000 test: 0.834247
max validation accuracy : 0.800000 max acc epoch : 1 test accuracy : 0.834247
Counter({0: 3339, 2: 2524, 1: 1828})

Epoch :  2 loss training:  61.63076928257942 Time :  3687
accuracy train: 0.904060 val: 0.892727 test: 0.907306
max validation accuracy : 0.892727 max acc epoch : 2 test accuracy : 0.907306
Counter({1: 3579, 2: 2524, 0: 1588})

Epoch :  3 loss training:  43.84171712398529 Time :  3706
accuracy train: 0.931327 val: 0.907273 test: 0.935616
max validation accuracy : 0.907273 max acc epoch : 3 test accuracy : 0.935616
Counter({1: 3652, 2: 2519, 0: 1520})

Epoch :  4 loss training:  33.866165064275265 Time :  3727
accuracy train: 0.938800 val: 0.914545 test: 0.941096
max validation accuracy : 0.914545 max acc epoch : 4 test accuracy : 0.941096
Counter({1: 3689, 0: 2503, 2: 1499})

Epoch :  5 loss training:  27.544895723462105 Time :  3749
accuracy train: 0.949909 val: 0.934545 test: 0.947489
max validation accuracy : 0.934545 max acc epoch : 5 test accuracy : 0.947489
Counter({1: 3711, 2: 2474, 0: 1506})

Epoch :  6 loss training:  23.65816829353571 Time :  3770
accuracy train: 0.952737 val: 0.930909 test: 0.952511
max validation accuracy : 0.934545 max acc epoch : 5 test accuracy : 0.947489
Counter({1: 3746, 2: 2454, 0: 1491})

Epoch :  7 loss training:  20.951477885246277 Time :  3791
accuracy train: 0.956574 val: 0.932727 test: 0.960731
max validation accuracy : 0.934545 max acc epoch : 5 test accuracy : 0.947489
Counter({0: 3757, 1: 2447, 2: 1487})

Epoch :  8 loss training:  17.844915226101875 Time :  3811
accuracy train: 0.959402 val: 0.936364 test: 0.957078
max validation accuracy : 0.936364 max acc epoch : 8 test accuracy : 0.957078
Counter({1: 3750, 0: 2440, 2: 1501})

Epoch :  9 loss training:  16.54743415489793 Time :  3830
accuracy train: 0.962634 val: 0.941818 test: 0.962557
max validation accuracy : 0.941818 max acc epoch : 9 test accuracy : 0.962557
Counter({0: 3766, 1: 2427, 2: 1498})

Epoch :  10 loss training:  15.358440238982439 Time :  3850
accuracy train: 0.968491 val: 0.945455 test: 0.966210
max validation accuracy : 0.945455 max acc epoch : 10 test accuracy : 0.966210
Counter({1: 3792, 0: 2405, 2: 1494})

Epoch :  11 loss training:  14.259746019728482 Time :  3870
accuracy train: 0.973137 val: 0.945455 test: 0.965753
max validation accuracy : 0.945455 max acc epoch : 10 test accuracy : 0.966210
Counter({0: 3810, 2: 2396, 1: 1485})

Epoch :  12 loss training:  13.607355700805783 Time :  3891
accuracy train: 0.972329 val: 0.945455 test: 0.964384
max validation accuracy : 0.945455 max acc epoch : 10 test accuracy : 0.966210
Counter({1: 3820, 0: 2394, 2: 1477})

Epoch :  13 loss training:  12.268052282743156 Time :  3911
accuracy train: 0.970309 val: 0.941818 test: 0.965753
max validation accuracy : 0.945455 max acc epoch : 10 test accuracy : 0.966210
Counter({0: 3823, 2: 2391, 1: 1477})

Epoch :  14 loss training:  11.630067052785307 Time :  3932
accuracy train: 0.977984 val: 0.947273 test: 0.964384
max validation accuracy : 0.947273 max acc epoch : 14 test accuracy : 0.964384
Counter({1: 3835, 2: 2384, 0: 1472})

Epoch :  15 loss training:  11.55291720572859 Time :  3952
accuracy train: 0.981418 val: 0.954545 test: 0.963014
max validation accuracy : 0.954545 max acc epoch : 15 test accuracy : 0.963014
Counter({1: 3846, 0: 2377, 2: 1468})

Epoch :  16 loss training:  10.537879145238549 Time :  3974
accuracy train: 0.978590 val: 0.956364 test: 0.966667
max validation accuracy : 0.956364 max acc epoch : 16 test accuracy : 0.966667
Counter({0: 3850, 1: 2375, 2: 1466})

Epoch :  17 loss training:  9.379412712994963 Time :  3997
accuracy train: 0.982226 val: 0.952727 test: 0.963470
max validation accuracy : 0.956364 max acc epoch : 16 test accuracy : 0.966667
Counter({0: 3855, 1: 2378, 2: 1458})

Epoch :  18 loss training:  9.499032710678875 Time :  4018
accuracy train: 0.983640 val: 0.952727 test: 0.966210
max validation accuracy : 0.956364 max acc epoch : 16 test accuracy : 0.966667
Counter({1: 3865, 0: 2364, 2: 1462})

Epoch :  19 loss training:  8.83944392669946 Time :  4039
accuracy train: 0.985457 val: 0.954545 test: 0.963927
max validation accuracy : 0.956364 max acc epoch : 16 test accuracy : 0.966667
Counter({1: 3874, 0: 2354, 2: 1463})

Epoch :  20 loss training:  8.138549277093261 Time :  4061
accuracy train: 0.984448 val: 0.950909 test: 0.968037
max validation accuracy : 0.956364 max acc epoch : 16 test accuracy : 0.966667
Counter({1: 3879, 2: 2349, 0: 1463})

Epoch :  21 loss training:  8.250737881287932 Time :  4082
accuracy train: 0.987477 val: 0.954545 test: 0.966667
max validation accuracy : 0.956364 max acc epoch : 16 test accuracy : 0.966667
Counter({0: 3887, 2: 2344, 1: 1460})

Epoch :  22 loss training:  7.9696416785009205 Time :  4102
accuracy train: 0.986669 val: 0.960000 test: 0.967580
max validation accuracy : 0.960000 max acc epoch : 22 test accuracy : 0.967580
Counter({0: 3893, 1: 2340, 2: 1458})

Epoch :  23 loss training:  7.45783330919221 Time :  4122
accuracy train: 0.988285 val: 0.960000 test: 0.968037
max validation accuracy : 0.960000 max acc epoch : 22 test accuracy : 0.967580
Counter({1: 3894, 2: 2339, 0: 1458})

Epoch :  24 loss training:  6.992670998442918 Time :  4143
accuracy train: 0.986871 val: 0.954545 test: 0.972146
max validation accuracy : 0.960000 max acc epoch : 22 test accuracy : 0.967580
Counter({1: 3897, 0: 2336, 2: 1458})

Epoch :  25 loss training:  7.0034899595193565 Time :  4164
accuracy train: 0.989497 val: 0.961818 test: 0.967580
max validation accuracy : 0.961818 max acc epoch : 25 test accuracy : 0.967580
Counter({0: 3915, 1: 2323, 2: 1453})

Epoch :  26 loss training:  6.549943139310926 Time :  4185
accuracy train: 0.990911 val: 0.963636 test: 0.968950
max validation accuracy : 0.963636 max acc epoch : 26 test accuracy : 0.968950
Counter({1: 3915, 2: 2322, 0: 1454})

Epoch :  27 loss training:  6.095621120650321 Time :  4206
accuracy train: 0.990103 val: 0.963636 test: 0.972603
max validation accuracy : 0.963636 max acc epoch : 26 test accuracy : 0.968950
Counter({0: 3914, 1: 2321, 2: 1456})

Epoch :  28 loss training:  5.911582296364941 Time :  4228
accuracy train: 0.990911 val: 0.960000 test: 0.968950
max validation accuracy : 0.963636 max acc epoch : 26 test accuracy : 0.968950
Counter({0: 3911, 2: 2322, 1: 1458})

Epoch :  29 loss training:  5.607947729760781 Time :  4250
accuracy train: 0.989901 val: 0.961818 test: 0.968950
max validation accuracy : 0.963636 max acc epoch : 26 test accuracy : 0.968950
Counter({1: 3912, 0: 2321, 2: 1458})

Epoch :  30 loss training:  5.628226200118661 Time :  4270
accuracy train: 0.991921 val: 0.961818 test: 0.968037
max validation accuracy : 0.963636 max acc epoch : 26 test accuracy : 0.968950
Counter({0: 3913, 1: 2320, 2: 1458})

Epoch :  31 loss training:  5.651515426347032 Time :  4291
accuracy train: 0.990507 val: 0.960000 test: 0.968493
max validation accuracy : 0.963636 max acc epoch : 26 test accuracy : 0.968950
Counter({0: 3912, 1: 2323, 2: 1456})

Epoch :  32 loss training:  4.970804544456769 Time :  4311
accuracy train: 0.991719 val: 0.961818 test: 0.969406
max validation accuracy : 0.963636 max acc epoch : 26 test accuracy : 0.968950
Counter({1: 3914, 0: 2321, 2: 1456})

Epoch :  33 loss training:  5.131126901367679 Time :  4333
accuracy train: 0.992123 val: 0.963636 test: 0.969863
max validation accuracy : 0.963636 max acc epoch : 26 test accuracy : 0.968950
Counter({0: 3917, 1: 2319, 2: 1455})

Epoch :  34 loss training:  4.580435380106792 Time :  4355
accuracy train: 0.993133 val: 0.960000 test: 0.969863
max validation accuracy : 0.963636 max acc epoch : 26 test accuracy : 0.968950
Counter({0: 3917, 1: 2318, 2: 1456})

Epoch :  35 loss training:  4.463957785628736 Time :  4375
accuracy train: 0.993133 val: 0.960000 test: 0.969406
max validation accuracy : 0.963636 max acc epoch : 26 test accuracy : 0.968950
Counter({1: 3916, 2: 2320, 0: 1455})

Epoch :  36 loss training:  4.722358976956457 Time :  4397
accuracy train: 0.992325 val: 0.961818 test: 0.970320
max validation accuracy : 0.963636 max acc epoch : 26 test accuracy : 0.968950
Counter({0: 3916, 1: 2321, 2: 1454})

Epoch :  37 loss training:  4.428687418228947 Time :  4420
accuracy train: 0.993739 val: 0.961818 test: 0.970776
max validation accuracy : 0.963636 max acc epoch : 26 test accuracy : 0.968950
Counter({0: 3921, 1: 2325, 2: 1445})

Epoch :  38 loss training:  3.7086126832291484 Time :  4440
accuracy train: 0.994749 val: 0.961818 test: 0.970776
max validation accuracy : 0.963636 max acc epoch : 26 test accuracy : 0.968950
Counter({0: 3920, 1: 2325, 2: 1446})

Epoch :  39 loss training:  3.8516014226479456 Time :  4464
accuracy train: 0.993941 val: 0.963636 test: 0.973516
max validation accuracy : 0.963636 max acc epoch : 26 test accuracy : 0.968950
Counter({1: 3921, 0: 2319, 2: 1451})

Epoch :  40 loss training:  4.1549283732892945 Time :  4483
accuracy train: 0.994749 val: 0.963636 test: 0.972146
max validation accuracy : 0.963636 max acc epoch : 26 test accuracy : 0.968950
Counter({0: 3923, 1: 2317, 2: 1451})

Epoch :  41 loss training:  3.5775993451243266 Time :  4504
accuracy train: 0.994547 val: 0.965455 test: 0.968950
max validation accuracy : 0.965455 max acc epoch : 41 test accuracy : 0.968950
Counter({0: 3924, 2: 2316, 1: 1451})

Epoch :  42 loss training:  3.219427974370774 Time :  4525
accuracy train: 0.993941 val: 0.965455 test: 0.970320
max validation accuracy : 0.965455 max acc epoch : 41 test accuracy : 0.968950
Counter({0: 3924, 1: 2316, 2: 1451})

Epoch :  43 loss training:  3.5544216909329407 Time :  4547
accuracy train: 0.994345 val: 0.961818 test: 0.971689
max validation accuracy : 0.965455 max acc epoch : 41 test accuracy : 0.968950
Counter({1: 3924, 0: 2315, 2: 1452})

Epoch :  44 loss training:  3.1584600734058768 Time :  4570
accuracy train: 0.995354 val: 0.963636 test: 0.972146
max validation accuracy : 0.965455 max acc epoch : 41 test accuracy : 0.968950
Counter({2: 3924, 0: 2314, 1: 1453})

Epoch :  45 loss training:  3.1801266335533 Time :  4594
accuracy train: 0.995152 val: 0.967273 test: 0.972603
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({0: 3924, 1: 2312, 2: 1455})

Epoch :  46 loss training:  3.676487268821802 Time :  4616
accuracy train: 0.995960 val: 0.963636 test: 0.971689
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({1: 3925, 0: 2312, 2: 1454})

Epoch :  47 loss training:  3.1675162749015726 Time :  4637
accuracy train: 0.995758 val: 0.961818 test: 0.973973
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({1: 3922, 2: 2311, 0: 1458})

Epoch :  48 loss training:  3.0257779984967783 Time :  4659
accuracy train: 0.995354 val: 0.960000 test: 0.971233
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({1: 3922, 2: 2311, 0: 1458})

Epoch :  49 loss training:  2.602694542671088 Time :  4681
accuracy train: 0.995152 val: 0.963636 test: 0.971233
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({1: 3922, 0: 2310, 2: 1459})

Epoch :  50 loss training:  2.550886395998532 Time :  4702
accuracy train: 0.995152 val: 0.963636 test: 0.970320
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({0: 3922, 1: 2310, 2: 1459})

Epoch :  51 loss training:  2.4305807337514125 Time :  4721
accuracy train: 0.996162 val: 0.958182 test: 0.971233
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({0: 3922, 1: 2312, 2: 1457})

Epoch :  52 loss training:  2.4737036234291736 Time :  4742
accuracy train: 0.995556 val: 0.965455 test: 0.970320
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({1: 3922, 0: 2313, 2: 1456})

Epoch :  53 loss training:  2.169926299713552 Time :  4763
accuracy train: 0.995556 val: 0.961818 test: 0.968950
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({0: 3922, 1: 2313, 2: 1456})

Epoch :  54 loss training:  2.506088824593462 Time :  4784
accuracy train: 0.996364 val: 0.961818 test: 0.968950
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({0: 3922, 1: 2314, 2: 1455})

Epoch :  55 loss training:  2.2878385570074897 Time :  4805
accuracy train: 0.996364 val: 0.961818 test: 0.971689
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({0: 3923, 1: 2309, 2: 1459})

Epoch :  56 loss training:  2.574973037291784 Time :  4826
accuracy train: 0.995960 val: 0.965455 test: 0.971233
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({0: 3923, 2: 2308, 1: 1460})

Epoch :  57 loss training:  2.8217069770325907 Time :  4847
accuracy train: 0.995960 val: 0.961818 test: 0.971233
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({0: 3923, 1: 2309, 2: 1459})

Epoch :  58 loss training:  2.4048361373716034 Time :  4867
accuracy train: 0.996768 val: 0.958182 test: 0.968950
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({1: 3923, 0: 2309, 2: 1459})

Epoch :  59 loss training:  2.1757497394428356 Time :  4889
accuracy train: 0.995758 val: 0.958182 test: 0.968037
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({0: 3924, 1: 2308, 2: 1459})

Epoch :  60 loss training:  2.0833455643441994 Time :  4912
accuracy train: 0.996970 val: 0.961818 test: 0.970776
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({1: 3925, 0: 2308, 2: 1458})

Epoch :  61 loss training:  2.1375141558237374 Time :  4936
accuracy train: 0.996566 val: 0.960000 test: 0.968493
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({0: 3925, 1: 2308, 2: 1458})

Epoch :  62 loss training:  1.8751556684728712 Time :  4959
accuracy train: 0.996566 val: 0.960000 test: 0.970320
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({1: 3924, 0: 2308, 2: 1459})

Epoch :  63 loss training:  1.9598660251067486 Time :  4980
accuracy train: 0.996970 val: 0.958182 test: 0.969406
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({0: 3924, 1: 2309, 2: 1458})

Epoch :  64 loss training:  1.7650051869422896 Time :  5002
accuracy train: 0.996566 val: 0.961818 test: 0.972603
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({0: 3924, 1: 2311, 2: 1456})

Epoch :  65 loss training:  1.795214665660751 Time :  5024
accuracy train: 0.996768 val: 0.960000 test: 0.969863
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({1: 3924, 0: 2311, 2: 1456})

Epoch :  66 loss training:  1.8384226300840965 Time :  5045
accuracy train: 0.996364 val: 0.963636 test: 0.969863
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({0: 3924, 1: 2310, 2: 1457})

Epoch :  67 loss training:  1.6905859572434565 Time :  5066
accuracy train: 0.996566 val: 0.961818 test: 0.970776
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({2: 3923, 0: 2311, 1: 1457})

Epoch :  68 loss training:  1.5255460059997858 Time :  5086
accuracy train: 0.996970 val: 0.963636 test: 0.970776
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({1: 3923, 2: 2312, 0: 1456})

Epoch :  69 loss training:  2.0832276164583163 Time :  5108
accuracy train: 0.996768 val: 0.961818 test: 0.969406
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({0: 3923, 1: 2312, 2: 1456})

Epoch :  70 loss training:  1.7168810953444336 Time :  5130
accuracy train: 0.995758 val: 0.961818 test: 0.969406
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({1: 3922, 0: 2311, 2: 1458})

Epoch :  71 loss training:  1.489936776459217 Time :  5151
accuracy train: 0.996162 val: 0.960000 test: 0.968950
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({0: 3922, 1: 2311, 2: 1458})

Epoch :  72 loss training:  1.6783746804576367 Time :  5172
accuracy train: 0.996162 val: 0.961818 test: 0.970776
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({0: 3922, 1: 2311, 2: 1458})

Epoch :  73 loss training:  1.6150678454869194 Time :  5195
accuracy train: 0.996566 val: 0.958182 test: 0.968950
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({1: 3922, 0: 2312, 2: 1457})

Epoch :  74 loss training:  1.5013314001553226 Time :  5216
accuracy train: 0.996768 val: 0.960000 test: 0.971233
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({0: 3922, 1: 2313, 2: 1456})

Epoch :  75 loss training:  1.519300492531329 Time :  5237
accuracy train: 0.997172 val: 0.961818 test: 0.970320
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({1: 3922, 0: 2312, 2: 1457})

Epoch :  76 loss training:  1.606103913843981 Time :  5257
accuracy train: 0.996768 val: 0.960000 test: 0.969406
max validation accuracy : 0.967273 max acc epoch : 45 test accuracy : 0.972603
Counter({1: 3922, 2: 2312, 0: 1457})

========================================================================================================================================================================================================
max acc epoch :  45
max validation accuracy :  0.9672727272727273
test accuracy :  0.9726027397260274
last test_accuracy :  0.9694063926940639
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=5e-05, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=413, weight_decay=0)
device :  cuda:0
Counter({1: 4233, 2: 2305, 0: 1153})

Epoch :  1 loss training:  125.50138941407204 Time :  5285
accuracy train: 0.818421 val: 0.800000 test: 0.834247
max validation accuracy : 0.800000 max acc epoch : 1 test accuracy : 0.834247
Counter({1: 3339, 2: 2524, 0: 1828})

Epoch :  2 loss training:  61.63615018129349 Time :  5305
accuracy train: 0.905070 val: 0.890909 test: 0.906393
max validation accuracy : 0.890909 max acc epoch : 2 test accuracy : 0.906393
Counter({0: 3585, 2: 2519, 1: 1587})

Epoch :  3 loss training:  43.6703732162714 Time :  5325
accuracy train: 0.930721 val: 0.907273 test: 0.934703
max validation accuracy : 0.907273 max acc epoch : 3 test accuracy : 0.934703
Counter({1: 3659, 2: 2513, 0: 1519})

Epoch :  4 loss training:  33.8530635535717 Time :  5345
accuracy train: 0.939406 val: 0.916364 test: 0.940639
max validation accuracy : 0.916364 max acc epoch : 4 test accuracy : 0.940639
Counter({1: 3668, 0: 2498, 2: 1525})

Epoch :  5 loss training:  27.528094582259655 Time :  5367
accuracy train: 0.949505 val: 0.934545 test: 0.946119
max validation accuracy : 0.934545 max acc epoch : 5 test accuracy : 0.946119
Counter({0: 3702, 1: 2475, 2: 1514})

Epoch :  6 loss training:  23.677191846072674 Time :  5387
accuracy train: 0.953545 val: 0.930909 test: 0.952511
max validation accuracy : 0.934545 max acc epoch : 5 test accuracy : 0.946119
Counter({0: 3755, 1: 2444, 2: 1492})

Epoch :  7 loss training:  21.030466713011265 Time :  5407
accuracy train: 0.956776 val: 0.930909 test: 0.958904
max validation accuracy : 0.934545 max acc epoch : 5 test accuracy : 0.946119
Counter({1: 3765, 0: 2437, 2: 1489})

Epoch :  8 loss training:  17.7766496501863 Time :  5426
accuracy train: 0.960816 val: 0.936364 test: 0.956164
max validation accuracy : 0.936364 max acc epoch : 8 test accuracy : 0.956164
Counter({1: 3755, 2: 2431, 0: 1505})

Epoch :  9 loss training:  16.518522335216403 Time :  5446
accuracy train: 0.962230 val: 0.936364 test: 0.963014
max validation accuracy : 0.936364 max acc epoch : 8 test accuracy : 0.956164
Counter({2: 3766, 0: 2425, 1: 1500})

Epoch :  10 loss training:  15.293529934249818 Time :  5468
accuracy train: 0.968087 val: 0.947273 test: 0.964840
max validation accuracy : 0.947273 max acc epoch : 10 test accuracy : 0.964840
Counter({1: 3789, 0: 2407, 2: 1495})

Epoch :  11 loss training:  14.304598113521934 Time :  5490
accuracy train: 0.974147 val: 0.947273 test: 0.964840
max validation accuracy : 0.947273 max acc epoch : 10 test accuracy : 0.964840
Counter({0: 3809, 1: 2394, 2: 1488})

Epoch :  12 loss training:  13.570641279220581 Time :  5510
accuracy train: 0.972127 val: 0.945455 test: 0.963470
max validation accuracy : 0.947273 max acc epoch : 10 test accuracy : 0.964840
Counter({0: 3818, 1: 2393, 2: 1480})

Epoch :  13 loss training:  12.245917424559593 Time :  5530
accuracy train: 0.970309 val: 0.943636 test: 0.964384
max validation accuracy : 0.947273 max acc epoch : 10 test accuracy : 0.964840
Counter({0: 3820, 2: 2391, 1: 1480})

Epoch :  14 loss training:  11.737685929518193 Time :  5550
accuracy train: 0.976772 val: 0.949091 test: 0.964840
max validation accuracy : 0.949091 max acc epoch : 14 test accuracy : 0.964840
Counter({1: 3834, 0: 2384, 2: 1473})

Epoch :  15 loss training:  11.58268163446337 Time :  5569
accuracy train: 0.981014 val: 0.950909 test: 0.963014
max validation accuracy : 0.950909 max acc epoch : 15 test accuracy : 0.963014
Counter({2: 3844, 1: 2378, 0: 1469})

Epoch :  16 loss training:  10.590052582323551 Time :  5592
accuracy train: 0.978186 val: 0.956364 test: 0.966667
max validation accuracy : 0.956364 max acc epoch : 16 test accuracy : 0.966667
Counter({0: 3847, 1: 2375, 2: 1469})

Epoch :  17 loss training:  9.435607111081481 Time :  5613
accuracy train: 0.980812 val: 0.950909 test: 0.962557
max validation accuracy : 0.956364 max acc epoch : 16 test accuracy : 0.966667
Counter({0: 3853, 1: 2376, 2: 1462})

Epoch :  18 loss training:  9.632257175631821 Time :  5634
accuracy train: 0.984246 val: 0.954545 test: 0.966210
max validation accuracy : 0.956364 max acc epoch : 16 test accuracy : 0.966667
Counter({1: 3863, 2: 2359, 0: 1469})

Epoch :  19 loss training:  8.938748105894774 Time :  5654
accuracy train: 0.985659 val: 0.954545 test: 0.963927
max validation accuracy : 0.956364 max acc epoch : 16 test accuracy : 0.966667
Counter({0: 3874, 2: 2353, 1: 1464})

Epoch :  20 loss training:  8.209424847271293 Time :  5673
accuracy train: 0.984852 val: 0.950909 test: 0.967123
max validation accuracy : 0.956364 max acc epoch : 16 test accuracy : 0.966667
Counter({2: 3879, 0: 2347, 1: 1465})

Epoch :  21 loss training:  8.125974866561592 Time :  5693
accuracy train: 0.986265 val: 0.958182 test: 0.964840
max validation accuracy : 0.958182 max acc epoch : 21 test accuracy : 0.964840
Counter({0: 3887, 2: 2342, 1: 1462})

Epoch :  22 loss training:  8.018289274536073 Time :  5714
accuracy train: 0.986669 val: 0.954545 test: 0.968037
max validation accuracy : 0.958182 max acc epoch : 21 test accuracy : 0.964840
Counter({0: 3895, 2: 2336, 1: 1460})

Epoch :  23 loss training:  7.405030858004466 Time :  5735
accuracy train: 0.987477 val: 0.956364 test: 0.967580
max validation accuracy : 0.958182 max acc epoch : 21 test accuracy : 0.964840
Counter({1: 3897, 2: 2333, 0: 1461})

Epoch :  24 loss training:  6.927316497080028 Time :  5757
accuracy train: 0.987073 val: 0.958182 test: 0.970776
max validation accuracy : 0.958182 max acc epoch : 21 test accuracy : 0.964840
Counter({1: 3899, 0: 2333, 2: 1459})

Epoch :  25 loss training:  6.849589366931468 Time :  5777
accuracy train: 0.989699 val: 0.965455 test: 0.968037
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({0: 3911, 2: 2323, 1: 1457})

Epoch :  26 loss training:  6.558745814487338 Time :  5797
accuracy train: 0.990103 val: 0.958182 test: 0.968950
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({0: 3913, 1: 2318, 2: 1460})

Epoch :  27 loss training:  6.1228219592012465 Time :  5818
accuracy train: 0.989699 val: 0.961818 test: 0.970320
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({1: 3914, 2: 2317, 0: 1460})

Epoch :  28 loss training:  5.736431259778328 Time :  5839
accuracy train: 0.990911 val: 0.961818 test: 0.967580
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({1: 3914, 2: 2317, 0: 1460})

Epoch :  29 loss training:  5.582447906024754 Time :  5859
accuracy train: 0.990103 val: 0.961818 test: 0.968037
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({1: 3913, 0: 2318, 2: 1460})

Epoch :  30 loss training:  5.453144780592993 Time :  5879
accuracy train: 0.991517 val: 0.963636 test: 0.968493
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({0: 3915, 2: 2317, 1: 1459})

Epoch :  31 loss training:  5.713728578994051 Time :  5902
accuracy train: 0.991315 val: 0.960000 test: 0.968037
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({1: 3916, 2: 2319, 0: 1456})

Epoch :  32 loss training:  4.966590763360728 Time :  5922
accuracy train: 0.991921 val: 0.960000 test: 0.969406
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({0: 3917, 1: 2317, 2: 1457})

Epoch :  33 loss training:  4.885646588169038 Time :  5941
accuracy train: 0.993335 val: 0.961818 test: 0.970320
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({0: 3918, 1: 2318, 2: 1455})

Epoch :  34 loss training:  4.459630144061521 Time :  5963
accuracy train: 0.992931 val: 0.960000 test: 0.970320
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({0: 3918, 1: 2317, 2: 1456})

Epoch :  35 loss training:  4.4413067939458415 Time :  5984
accuracy train: 0.993133 val: 0.960000 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({1: 3917, 2: 2320, 0: 1454})

Epoch :  36 loss training:  4.631509320694022 Time :  6003
accuracy train: 0.992527 val: 0.961818 test: 0.970776
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({0: 3917, 1: 2320, 2: 1454})

Epoch :  37 loss training:  4.53064118581824 Time :  6024
accuracy train: 0.993739 val: 0.961818 test: 0.970320
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({1: 3922, 0: 2324, 2: 1445})

Epoch :  38 loss training:  3.5833641338394955 Time :  6043
accuracy train: 0.993941 val: 0.965455 test: 0.969406
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({1: 3911, 0: 2323, 2: 1457})

Epoch :  39 loss training:  3.904281572322361 Time :  6064
accuracy train: 0.994143 val: 0.963636 test: 0.971689
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({1: 3915, 0: 2318, 2: 1458})

Epoch :  40 loss training:  4.037694484111853 Time :  6085
accuracy train: 0.995152 val: 0.961818 test: 0.972146
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({0: 3919, 1: 2317, 2: 1455})

Epoch :  41 loss training:  3.4283009117934853 Time :  6105
accuracy train: 0.994143 val: 0.963636 test: 0.969406
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({0: 3918, 1: 2317, 2: 1456})

Epoch :  42 loss training:  3.1840489024179988 Time :  6126
accuracy train: 0.993941 val: 0.960000 test: 0.969406
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({0: 3922, 2: 2313, 1: 1456})

Epoch :  43 loss training:  3.518439476552885 Time :  6147
accuracy train: 0.994345 val: 0.958182 test: 0.971233
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({1: 3920, 0: 2312, 2: 1459})

Epoch :  44 loss training:  3.2705147992819548 Time :  6168
accuracy train: 0.995354 val: 0.961818 test: 0.970776
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({0: 3920, 1: 2311, 2: 1460})

Epoch :  45 loss training:  3.224396658304613 Time :  6188
accuracy train: 0.995152 val: 0.961818 test: 0.973059
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({0: 3920, 2: 2310, 1: 1461})

Epoch :  46 loss training:  3.6945117248687893 Time :  6210
accuracy train: 0.995960 val: 0.960000 test: 0.971233
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({1: 3921, 0: 2310, 2: 1460})

Epoch :  47 loss training:  3.155513091478497 Time :  6232
accuracy train: 0.995960 val: 0.960000 test: 0.973059
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({1: 3921, 2: 2309, 0: 1461})

Epoch :  48 loss training:  3.0189139299909584 Time :  6252
accuracy train: 0.995960 val: 0.958182 test: 0.970776
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({1: 3920, 2: 2309, 0: 1462})

Epoch :  49 loss training:  2.7438471891218796 Time :  6272
accuracy train: 0.995152 val: 0.961818 test: 0.970320
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({1: 3920, 2: 2308, 0: 1463})

Epoch :  50 loss training:  2.6659937574877404 Time :  6294
accuracy train: 0.995354 val: 0.960000 test: 0.970320
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({0: 3921, 1: 2308, 2: 1462})

Epoch :  51 loss training:  2.447411328612361 Time :  6315
accuracy train: 0.996162 val: 0.956364 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({0: 3921, 1: 2310, 2: 1460})

Epoch :  52 loss training:  2.442007301870035 Time :  6335
accuracy train: 0.995758 val: 0.961818 test: 0.967580
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({1: 3921, 2: 2312, 0: 1458})

Epoch :  53 loss training:  2.2268209080793895 Time :  6355
accuracy train: 0.996162 val: 0.960000 test: 0.969406
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({1: 3921, 0: 2311, 2: 1459})

Epoch :  54 loss training:  2.5131786637648474 Time :  6374
accuracy train: 0.996566 val: 0.960000 test: 0.967123
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({0: 3923, 1: 2311, 2: 1457})

Epoch :  55 loss training:  2.2752026307280175 Time :  6396
accuracy train: 0.995960 val: 0.961818 test: 0.972146
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({0: 3922, 1: 2306, 2: 1463})

Epoch :  56 loss training:  2.5709553851629607 Time :  6418
accuracy train: 0.995960 val: 0.965455 test: 0.971233
max validation accuracy : 0.965455 max acc epoch : 25 test accuracy : 0.968037
Counter({1: 3921, 0: 2303, 2: 1467})

========================================================================================================================================================================================================
max acc epoch :  25
max validation accuracy :  0.9654545454545455
test accuracy :  0.9680365296803652
last test_accuracy :  0.9712328767123287
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=5e-05, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=413, weight_decay=0)
device :  cuda:0
Counter({1: 4233, 2: 2305, 0: 1153})

Epoch :  1 loss training:  125.50138372182846 Time :  6445
accuracy train: 0.818421 val: 0.800000 test: 0.834247
max validation accuracy : 0.800000 max acc epoch : 1 test accuracy : 0.834247
Counter({0: 3339, 2: 2525, 1: 1827})

Epoch :  2 loss training:  61.61807358264923 Time :  6465
accuracy train: 0.904060 val: 0.892727 test: 0.907306
max validation accuracy : 0.892727 max acc epoch : 2 test accuracy : 0.907306
Counter({0: 3582, 2: 2521, 1: 1588})

Epoch :  3 loss training:  43.74153044819832 Time :  6485
accuracy train: 0.931125 val: 0.907273 test: 0.935160
max validation accuracy : 0.907273 max acc epoch : 3 test accuracy : 0.935160
Counter({2: 3653, 1: 2519, 0: 1519})

Epoch :  4 loss training:  33.85830780118704 Time :  6505
accuracy train: 0.939204 val: 0.916364 test: 0.940639
max validation accuracy : 0.916364 max acc epoch : 4 test accuracy : 0.940639
Counter({1: 3664, 2: 2500, 0: 1527})

Epoch :  5 loss training:  27.564069110900164 Time :  6526
accuracy train: 0.950111 val: 0.932727 test: 0.947489
max validation accuracy : 0.932727 max acc epoch : 5 test accuracy : 0.947489
Counter({1: 3703, 0: 2473, 2: 1515})

Epoch :  6 loss training:  23.689698860049248 Time :  6545
accuracy train: 0.953141 val: 0.930909 test: 0.952511
max validation accuracy : 0.932727 max acc epoch : 5 test accuracy : 0.947489
Counter({0: 3748, 1: 2450, 2: 1493})

Epoch :  7 loss training:  21.063237749040127 Time :  6566
accuracy train: 0.957180 val: 0.932727 test: 0.960274
max validation accuracy : 0.932727 max acc epoch : 5 test accuracy : 0.947489
Counter({1: 3758, 0: 2443, 2: 1490})

Epoch :  8 loss training:  17.831445898860693 Time :  6585
accuracy train: 0.960210 val: 0.936364 test: 0.956164
max validation accuracy : 0.936364 max acc epoch : 8 test accuracy : 0.956164
Counter({0: 3752, 2: 2433, 1: 1506})

Epoch :  9 loss training:  16.561848539859056 Time :  6604
accuracy train: 0.961826 val: 0.938182 test: 0.962100
max validation accuracy : 0.938182 max acc epoch : 9 test accuracy : 0.962100
Counter({0: 3767, 1: 2424, 2: 1500})

Epoch :  10 loss training:  15.375283917412162 Time :  6623
accuracy train: 0.967885 val: 0.945455 test: 0.964840
max validation accuracy : 0.945455 max acc epoch : 10 test accuracy : 0.964840
Counter({1: 3791, 0: 2405, 2: 1495})

Epoch :  11 loss training:  14.307306335307658 Time :  6643
accuracy train: 0.973945 val: 0.945455 test: 0.965753
max validation accuracy : 0.945455 max acc epoch : 10 test accuracy : 0.964840
Counter({0: 3811, 1: 2393, 2: 1487})

Epoch :  12 loss training:  13.563510827720165 Time :  6664
accuracy train: 0.971925 val: 0.945455 test: 0.962557
max validation accuracy : 0.945455 max acc epoch : 10 test accuracy : 0.964840
Counter({0: 3820, 1: 2390, 2: 1481})

Epoch :  13 loss training:  12.303190439939499 Time :  6685
accuracy train: 0.970107 val: 0.941818 test: 0.965297
max validation accuracy : 0.945455 max acc epoch : 10 test accuracy : 0.964840
Counter({0: 3821, 1: 2390, 2: 1480})

Epoch :  14 loss training:  11.637368279509246 Time :  6705
accuracy train: 0.977176 val: 0.947273 test: 0.963014
max validation accuracy : 0.947273 max acc epoch : 14 test accuracy : 0.963014
Counter({1: 3832, 2: 2384, 0: 1475})

Epoch :  15 loss training:  11.545123044401407 Time :  6725
accuracy train: 0.980812 val: 0.952727 test: 0.962557
max validation accuracy : 0.952727 max acc epoch : 15 test accuracy : 0.962557
Counter({1: 3844, 2: 2376, 0: 1471})

Epoch :  16 loss training:  10.587614433374256 Time :  6746
accuracy train: 0.978388 val: 0.956364 test: 0.965753
max validation accuracy : 0.956364 max acc epoch : 16 test accuracy : 0.965753
Counter({0: 3847, 1: 2376, 2: 1468})

Epoch :  17 loss training:  9.368760594166815 Time :  6766
accuracy train: 0.981418 val: 0.950909 test: 0.963470
max validation accuracy : 0.956364 max acc epoch : 16 test accuracy : 0.965753
Counter({0: 3851, 1: 2379, 2: 1461})

Epoch :  18 loss training:  9.546832126565278 Time :  6786
accuracy train: 0.983842 val: 0.952727 test: 0.965753
max validation accuracy : 0.956364 max acc epoch : 16 test accuracy : 0.965753
Counter({1: 3866, 0: 2359, 2: 1466})

Epoch :  19 loss training:  8.82791072037071 Time :  6807
accuracy train: 0.985256 val: 0.954545 test: 0.965297
max validation accuracy : 0.956364 max acc epoch : 16 test accuracy : 0.965753
Counter({1: 3877, 0: 2353, 2: 1461})

Epoch :  20 loss training:  8.088367260526866 Time :  6828
accuracy train: 0.984448 val: 0.950909 test: 0.968493
max validation accuracy : 0.956364 max acc epoch : 16 test accuracy : 0.965753
Counter({1: 3880, 2: 2350, 0: 1461})

Epoch :  21 loss training:  8.170958137139678 Time :  6847
accuracy train: 0.986871 val: 0.958182 test: 0.965753
max validation accuracy : 0.958182 max acc epoch : 21 test accuracy : 0.965753
Counter({0: 3887, 1: 2346, 2: 1458})

Epoch :  22 loss training:  8.106448713690042 Time :  6868
accuracy train: 0.986265 val: 0.956364 test: 0.967123
max validation accuracy : 0.958182 max acc epoch : 21 test accuracy : 0.965753
Counter({0: 3893, 1: 2343, 2: 1455})

Epoch :  23 loss training:  7.398525229655206 Time :  6890
accuracy train: 0.988487 val: 0.960000 test: 0.967123
max validation accuracy : 0.960000 max acc epoch : 23 test accuracy : 0.967123
Counter({0: 3895, 1: 2340, 2: 1456})

Epoch :  24 loss training:  6.839709802996367 Time :  6912
accuracy train: 0.986871 val: 0.956364 test: 0.971689
max validation accuracy : 0.960000 max acc epoch : 23 test accuracy : 0.967123
Counter({1: 3897, 0: 2338, 2: 1456})

Epoch :  25 loss training:  6.953021629247814 Time :  6931
accuracy train: 0.989497 val: 0.961818 test: 0.967123
max validation accuracy : 0.961818 max acc epoch : 25 test accuracy : 0.967123
Counter({0: 3909, 1: 2327, 2: 1455})

Epoch :  26 loss training:  6.580014634411782 Time :  6953
accuracy train: 0.990507 val: 0.960000 test: 0.967580
max validation accuracy : 0.961818 max acc epoch : 25 test accuracy : 0.967123
Counter({0: 3906, 1: 2325, 2: 1460})

Epoch :  27 loss training:  6.151598090073094 Time :  6974
accuracy train: 0.990305 val: 0.963636 test: 0.969863
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({1: 3906, 0: 2324, 2: 1461})

Epoch :  28 loss training:  5.922366612590849 Time :  6996
accuracy train: 0.991315 val: 0.961818 test: 0.968037
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({0: 3909, 2: 2325, 1: 1457})

Epoch :  29 loss training:  5.598497413331643 Time :  7017
accuracy train: 0.990103 val: 0.961818 test: 0.967580
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({1: 3908, 0: 2325, 2: 1458})

Epoch :  30 loss training:  5.584733355906792 Time :  7039
accuracy train: 0.991113 val: 0.963636 test: 0.967580
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({0: 3910, 1: 2324, 2: 1457})

Epoch :  31 loss training:  5.713144982000813 Time :  7060
accuracy train: 0.990709 val: 0.960000 test: 0.967123
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({0: 3909, 1: 2325, 2: 1457})

Epoch :  32 loss training:  4.9748684508376755 Time :  7081
accuracy train: 0.991719 val: 0.961818 test: 0.968493
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({2: 3910, 0: 2325, 1: 1456})

Epoch :  33 loss training:  5.229415945708752 Time :  7102
accuracy train: 0.991921 val: 0.963636 test: 0.969406
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({0: 3915, 1: 2323, 2: 1453})

Epoch :  34 loss training:  4.538001469802111 Time :  7123
accuracy train: 0.992729 val: 0.960000 test: 0.969863
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({1: 3915, 0: 2322, 2: 1454})

Epoch :  35 loss training:  4.49100518017076 Time :  7144
accuracy train: 0.993537 val: 0.961818 test: 0.970776
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({1: 3913, 2: 2324, 0: 1454})

Epoch :  36 loss training:  4.715548002975993 Time :  7164
accuracy train: 0.992325 val: 0.961818 test: 0.970320
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({0: 3913, 1: 2324, 2: 1454})

Epoch :  37 loss training:  4.4851480417419225 Time :  7185
accuracy train: 0.993537 val: 0.960000 test: 0.970776
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({0: 3913, 1: 2327, 2: 1451})

Epoch :  38 loss training:  3.656769023684319 Time :  7207
accuracy train: 0.994345 val: 0.963636 test: 0.970320
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({0: 3913, 1: 2327, 2: 1451})

Epoch :  39 loss training:  3.9287078221095726 Time :  7228
accuracy train: 0.994345 val: 0.963636 test: 0.972146
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({1: 3914, 0: 2320, 2: 1457})

Epoch :  40 loss training:  4.1846180051798 Time :  7250
accuracy train: 0.995556 val: 0.960000 test: 0.972146
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({0: 3916, 1: 2318, 2: 1457})

Epoch :  41 loss training:  3.5654257129644975 Time :  7271
accuracy train: 0.994547 val: 0.960000 test: 0.967580
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({0: 3918, 1: 2318, 2: 1455})

Epoch :  42 loss training:  3.264853000640869 Time :  7292
accuracy train: 0.994143 val: 0.960000 test: 0.969406
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({0: 3921, 2: 2315, 1: 1455})

Epoch :  43 loss training:  3.516383543028496 Time :  7312
accuracy train: 0.994345 val: 0.958182 test: 0.971233
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({0: 3920, 1: 2314, 2: 1457})

Epoch :  44 loss training:  3.1103210369183216 Time :  7334
accuracy train: 0.995556 val: 0.961818 test: 0.971689
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({0: 3920, 1: 2314, 2: 1457})

Epoch :  45 loss training:  3.1911836456274614 Time :  7354
accuracy train: 0.995354 val: 0.958182 test: 0.972146
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({0: 3920, 1: 2312, 2: 1459})

Epoch :  46 loss training:  3.726441666483879 Time :  7373
accuracy train: 0.995960 val: 0.961818 test: 0.972146
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({1: 3921, 0: 2311, 2: 1459})

Epoch :  47 loss training:  3.151562658662442 Time :  7394
accuracy train: 0.995960 val: 0.960000 test: 0.973973
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({1: 3921, 2: 2310, 0: 1460})

Epoch :  48 loss training:  3.012636645406019 Time :  7416
accuracy train: 0.995758 val: 0.958182 test: 0.971233
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({1: 3920, 0: 2311, 2: 1460})

Epoch :  49 loss training:  2.6290046439680737 Time :  7439
accuracy train: 0.995758 val: 0.960000 test: 0.971689
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({1: 3920, 0: 2310, 2: 1461})

Epoch :  50 loss training:  2.6442539270210546 Time :  7459
accuracy train: 0.995152 val: 0.960000 test: 0.970320
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({0: 3920, 2: 2310, 1: 1461})

Epoch :  51 loss training:  2.5142913582385518 Time :  7479
accuracy train: 0.996162 val: 0.954545 test: 0.971689
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({1: 3920, 0: 2310, 2: 1461})

Epoch :  52 loss training:  2.421983087871922 Time :  7499
accuracy train: 0.995758 val: 0.961818 test: 0.969863
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({1: 3920, 2: 2311, 0: 1460})

Epoch :  53 loss training:  2.239229560655076 Time :  7520
accuracy train: 0.996162 val: 0.960000 test: 0.968950
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({0: 3921, 1: 2311, 2: 1459})

Epoch :  54 loss training:  2.480122208915418 Time :  7541
accuracy train: 0.996566 val: 0.960000 test: 0.968950
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({1: 3921, 0: 2311, 2: 1459})

Epoch :  55 loss training:  2.300872791558504 Time :  7561
accuracy train: 0.996162 val: 0.960000 test: 0.972146
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({0: 3921, 1: 2306, 2: 1464})

Epoch :  56 loss training:  2.6469701080641244 Time :  7583
accuracy train: 0.996162 val: 0.961818 test: 0.971689
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({0: 3921, 2: 2306, 1: 1464})

Epoch :  57 loss training:  2.8387011494487524 Time :  7603
accuracy train: 0.996162 val: 0.961818 test: 0.971233
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({1: 3923, 0: 2305, 2: 1463})

Epoch :  58 loss training:  2.4279955418605823 Time :  7624
accuracy train: 0.996566 val: 0.960000 test: 0.968493
max validation accuracy : 0.963636 max acc epoch : 27 test accuracy : 0.969863
Counter({1: 3923, 2: 2305, 0: 1463})

========================================================================================================================================================================================================
max acc epoch :  27
max validation accuracy :  0.9636363636363636
test accuracy :  0.9698630136986301
last test_accuracy :  0.9684931506849315
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.96545 	 test_accuracy : 0.96986 	 max_acc epoch :  56 	 last test_accuracy : 0.97260
k :  1 	 val_accuracy : 0.96727 	 test_accuracy : 0.97215 	 max_acc epoch :  55 	 last test_accuracy : 0.96986
k :  2 	 val_accuracy : 0.96727 	 test_accuracy : 0.97260 	 max_acc epoch :  45 	 last test_accuracy : 0.96941
k :  3 	 val_accuracy : 0.96545 	 test_accuracy : 0.96804 	 max_acc epoch :  25 	 last test_accuracy : 0.97123
k :  4 	 val_accuracy : 0.96364 	 test_accuracy : 0.96986 	 max_acc epoch :  27 	 last test_accuracy : 0.96849

avg :  	 val_accuracy : 0.96582 	 test_accuracy : 0.97050 	 last_accuracy : 0.97032
