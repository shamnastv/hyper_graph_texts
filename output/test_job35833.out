

date and time :  Mon Jun  7 00:45:34 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=540, weight_decay=0)
device :  cuda:0
Counter({1: 2590, 2: 2551, 0: 2259})

Epoch :  1 loss training:  212.62949204444885 Time :  142
accuracy train: 0.654864 val: 0.617910 test: 0.624784
max validation accuracy : 0.617910 max acc epoch : 1 test accuracy : 0.624784
Counter({2: 3778, 1: 1833, 0: 1789})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  142.04044216871262 Time :  218
accuracy train: 0.725678 val: 0.662687 test: 0.659164
max validation accuracy : 0.662687 max acc epoch : 2 test accuracy : 0.659164
Counter({1: 3721, 0: 2070, 2: 1609})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.16537916660309 Time :  289
accuracy train: 0.749504 val: 0.665672 test: 0.656196
max validation accuracy : 0.665672 max acc epoch : 3 test accuracy : 0.656196
Counter({1: 3073, 2: 2409, 0: 1918})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.69420918822289 Time :  326
accuracy train: 0.790536 val: 0.683582 test: 0.690329
max validation accuracy : 0.683582 max acc epoch : 4 test accuracy : 0.690329
Counter({0: 3027, 2: 2486, 1: 1887})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  91.82627728581429 Time :  379
accuracy train: 0.815685 val: 0.677612 test: 0.698739
max validation accuracy : 0.683582 max acc epoch : 4 test accuracy : 0.690329
Counter({1: 3047, 0: 2506, 2: 1847})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  83.29663689434528 Time :  418
accuracy train: 0.835539 val: 0.692537 test: 0.702696
max validation accuracy : 0.692537 max acc epoch : 6 test accuracy : 0.702696
Counter({1: 2900, 0: 2735, 2: 1765})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  72.7426025569439 Time :  455
accuracy train: 0.863005 val: 0.707463 test: 0.707395
max validation accuracy : 0.707463 max acc epoch : 7 test accuracy : 0.707395
Counter({1: 2935, 0: 2733, 2: 1732})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  70.53018479049206 Time :  506
accuracy train: 0.862674 val: 0.719403 test: 0.708385
max validation accuracy : 0.719403 max acc epoch : 8 test accuracy : 0.708385
Counter({1: 2996, 0: 2721, 2: 1683})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.72346225380898 Time :  546
accuracy train: 0.876572 val: 0.695522 test: 0.712095
max validation accuracy : 0.719403 max acc epoch : 8 test accuracy : 0.708385
Counter({1: 3000, 2: 2737, 0: 1663})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.03751553595066 Time :  589
accuracy train: 0.891463 val: 0.695522 test: 0.710858
max validation accuracy : 0.719403 max acc epoch : 8 test accuracy : 0.708385
Counter({2: 3026, 1: 2715, 0: 1659})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.94396930932999 Time :  634
accuracy train: 0.903044 val: 0.710448 test: 0.715063
max validation accuracy : 0.719403 max acc epoch : 8 test accuracy : 0.708385
Counter({0: 3046, 1: 2705, 2: 1649})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  54.86768862605095 Time :  682
accuracy train: 0.905692 val: 0.701493 test: 0.714321
max validation accuracy : 0.719403 max acc epoch : 8 test accuracy : 0.708385
Counter({1: 3062, 0: 2697, 2: 1641})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  51.66990974545479 Time :  722
accuracy train: 0.913633 val: 0.716418 test: 0.716794
max validation accuracy : 0.719403 max acc epoch : 8 test accuracy : 0.708385
Counter({2: 3069, 0: 2696, 1: 1635})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  49.96334695070982 Time :  767
accuracy train: 0.916942 val: 0.716418 test: 0.716794
max validation accuracy : 0.719403 max acc epoch : 8 test accuracy : 0.708385
Counter({1: 3066, 2: 2699, 0: 1635})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  49.13778367638588 Time :  809
accuracy train: 0.929186 val: 0.719403 test: 0.716052
max validation accuracy : 0.719403 max acc epoch : 8 test accuracy : 0.708385
Counter({1: 3060, 2: 2708, 0: 1632})

Epoch :  16 loss training:  46.46207179129124 Time :  847
accuracy train: 0.932164 val: 0.713433 test: 0.717289
max validation accuracy : 0.719403 max acc epoch : 8 test accuracy : 0.708385
Counter({0: 3057, 2: 2720, 1: 1623})

Epoch :  17 loss training:  46.263018012046814 Time :  904
accuracy train: 0.934811 val: 0.719403 test: 0.714816
max validation accuracy : 0.719403 max acc epoch : 8 test accuracy : 0.708385
Counter({1: 3053, 0: 2726, 2: 1621})

Epoch :  18 loss training:  45.151853397488594 Time :  940
accuracy train: 0.937790 val: 0.719403 test: 0.718526
max validation accuracy : 0.719403 max acc epoch : 8 test accuracy : 0.708385
Counter({0: 3048, 2: 2732, 1: 1620})

Epoch :  19 loss training:  43.710110396146774 Time :  980
accuracy train: 0.942422 val: 0.713433 test: 0.714074
max validation accuracy : 0.719403 max acc epoch : 8 test accuracy : 0.708385
Counter({1: 3046, 2: 2735, 0: 1619})

Epoch :  20 loss training:  41.72742311656475 Time :  1018
accuracy train: 0.946724 val: 0.722388 test: 0.716547
max validation accuracy : 0.722388 max acc epoch : 20 test accuracy : 0.716547
Counter({0: 3044, 1: 2741, 2: 1615})

Epoch :  21 loss training:  39.02147041261196 Time :  1061
accuracy train: 0.952349 val: 0.722388 test: 0.720257
max validation accuracy : 0.722388 max acc epoch : 20 test accuracy : 0.716547
Counter({1: 3035, 2: 2752, 0: 1613})

Epoch :  22 loss training:  38.37045656144619 Time :  1123
accuracy train: 0.953342 val: 0.710448 test: 0.717042
max validation accuracy : 0.722388 max acc epoch : 20 test accuracy : 0.716547
Counter({0: 3037, 2: 2757, 1: 1606})

Epoch :  23 loss training:  37.371096421033144 Time :  1158
accuracy train: 0.954997 val: 0.722388 test: 0.719021
max validation accuracy : 0.722388 max acc epoch : 20 test accuracy : 0.716547
Counter({1: 3036, 0: 2764, 2: 1600})

Epoch :  24 loss training:  35.788616731762886 Time :  1204
accuracy train: 0.960953 val: 0.731343 test: 0.716547
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.716547
Counter({1: 3036, 2: 2768, 0: 1596})

Epoch :  25 loss training:  35.340609557926655 Time :  1242
accuracy train: 0.961284 val: 0.713433 test: 0.719763
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.716547
Counter({0: 3028, 1: 2778, 2: 1594})

Epoch :  26 loss training:  34.2149863243103 Time :  1277
accuracy train: 0.967571 val: 0.716418 test: 0.720752
max validation accuracy : 0.731343 max acc epoch : 24 test accuracy : 0.716547
Counter({2: 3022, 0: 2787, 1: 1591})

Epoch :  27 loss training:  33.66143070533872 Time :  1333
accuracy train: 0.970218 val: 0.743284 test: 0.717289
max validation accuracy : 0.743284 max acc epoch : 27 test accuracy : 0.717289
Counter({2: 3027, 1: 2783, 0: 1590})

Epoch :  28 loss training:  31.822305016219616 Time :  1371
accuracy train: 0.973197 val: 0.728358 test: 0.721494
max validation accuracy : 0.743284 max acc epoch : 27 test accuracy : 0.717289
Counter({2: 3024, 0: 2791, 1: 1585})

Epoch :  29 loss training:  30.753483161330223 Time :  1407
accuracy train: 0.977167 val: 0.719403 test: 0.722236
max validation accuracy : 0.743284 max acc epoch : 27 test accuracy : 0.717289
Counter({2: 3022, 1: 2791, 0: 1587})

Epoch :  30 loss training:  29.79444609582424 Time :  1455
accuracy train: 0.977167 val: 0.710448 test: 0.715558
max validation accuracy : 0.743284 max acc epoch : 27 test accuracy : 0.717289
Counter({1: 3011, 0: 2803, 2: 1586})

Epoch :  31 loss training:  29.72960551828146 Time :  1499
accuracy train: 0.976837 val: 0.731343 test: 0.717042
max validation accuracy : 0.743284 max acc epoch : 27 test accuracy : 0.717289
Counter({1: 3011, 0: 2808, 2: 1581})

Epoch :  32 loss training:  27.270777389407158 Time :  1546
accuracy train: 0.979153 val: 0.731343 test: 0.718526
max validation accuracy : 0.743284 max acc epoch : 27 test accuracy : 0.717289
Counter({1: 3000, 0: 2820, 2: 1580})

Epoch :  33 loss training:  27.298278629779816 Time :  1586
accuracy train: 0.979484 val: 0.743284 test: 0.719268
max validation accuracy : 0.743284 max acc epoch : 27 test accuracy : 0.717289
Counter({2: 3000, 0: 2826, 1: 1574})

Epoch :  34 loss training:  25.134417586028576 Time :  1620
accuracy train: 0.982462 val: 0.731343 test: 0.719021
max validation accuracy : 0.743284 max acc epoch : 27 test accuracy : 0.717289
Counter({0: 2989, 1: 2844, 2: 1567})

Epoch :  35 loss training:  24.362728763371706 Time :  1664
accuracy train: 0.984116 val: 0.728358 test: 0.711848
max validation accuracy : 0.743284 max acc epoch : 27 test accuracy : 0.717289
Counter({0: 2988, 2: 2849, 1: 1563})

Epoch :  36 loss training:  23.890060145407915 Time :  1717
accuracy train: 0.986102 val: 0.728358 test: 0.713826
max validation accuracy : 0.743284 max acc epoch : 27 test accuracy : 0.717289
Counter({0: 2986, 2: 2853, 1: 1561})

Epoch :  37 loss training:  23.627328485250473 Time :  1762
accuracy train: 0.987095 val: 0.713433 test: 0.716794
max validation accuracy : 0.743284 max acc epoch : 27 test accuracy : 0.717289
Counter({0: 2983, 1: 2858, 2: 1559})

Epoch :  38 loss training:  22.11695586144924 Time :  1793
accuracy train: 0.986764 val: 0.722388 test: 0.716300
max validation accuracy : 0.743284 max acc epoch : 27 test accuracy : 0.717289
Counter({1: 2978, 2: 2865, 0: 1557})

Epoch :  39 loss training:  21.418814934790134 Time :  1829
accuracy train: 0.988418 val: 0.731343 test: 0.715805
max validation accuracy : 0.743284 max acc epoch : 27 test accuracy : 0.717289
Counter({2: 2979, 1: 2866, 0: 1555})

Epoch :  40 loss training:  20.976232796907425 Time :  1861
accuracy train: 0.992058 val: 0.728358 test: 0.717536
max validation accuracy : 0.743284 max acc epoch : 27 test accuracy : 0.717289
Counter({0: 2982, 2: 2865, 1: 1553})

Epoch :  41 loss training:  19.10557571426034 Time :  1896
accuracy train: 0.992720 val: 0.743284 test: 0.714074
max validation accuracy : 0.743284 max acc epoch : 27 test accuracy : 0.717289
Counter({1: 2975, 0: 2875, 2: 1550})

Epoch :  42 loss training:  19.035298939794302 Time :  1926
accuracy train: 0.992389 val: 0.725373 test: 0.717536
max validation accuracy : 0.743284 max acc epoch : 27 test accuracy : 0.717289
Counter({2: 2983, 0: 2873, 1: 1544})

Epoch :  43 loss training:  18.71435682103038 Time :  1957
accuracy train: 0.992389 val: 0.728358 test: 0.715310
max validation accuracy : 0.743284 max acc epoch : 27 test accuracy : 0.717289
Counter({0: 2974, 1: 2881, 2: 1545})

Epoch :  44 loss training:  17.055654007941484 Time :  1985
accuracy train: 0.993051 val: 0.737313 test: 0.716794
max validation accuracy : 0.743284 max acc epoch : 27 test accuracy : 0.717289
Counter({0: 2973, 1: 2885, 2: 1542})

Epoch :  45 loss training:  18.0251379981637 Time :  2022
accuracy train: 0.993051 val: 0.743284 test: 0.715310
max validation accuracy : 0.743284 max acc epoch : 27 test accuracy : 0.717289
Counter({0: 2965, 2: 2897, 1: 1538})

Epoch :  46 loss training:  17.046373169869184 Time :  2054
accuracy train: 0.994375 val: 0.755224 test: 0.715310
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({2: 2962, 1: 2903, 0: 1535})

Epoch :  47 loss training:  15.712131960317492 Time :  2082
accuracy train: 0.995036 val: 0.737313 test: 0.718526
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({2: 2956, 1: 2910, 0: 1534})

Epoch :  48 loss training:  15.556363634765148 Time :  2112
accuracy train: 0.995367 val: 0.737313 test: 0.718279
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({0: 2956, 2: 2911, 1: 1533})

Epoch :  49 loss training:  13.792133392766118 Time :  2143
accuracy train: 0.996691 val: 0.746269 test: 0.718526
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({2: 2961, 0: 2906, 1: 1533})

Epoch :  50 loss training:  13.133358236402273 Time :  2180
accuracy train: 0.997353 val: 0.725373 test: 0.715310
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({2: 2964, 0: 2904, 1: 1532})

Epoch :  51 loss training:  13.568563824519515 Time :  2211
accuracy train: 0.997353 val: 0.743284 test: 0.714074
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({0: 2964, 2: 2910, 1: 1526})

Epoch :  52 loss training:  13.061581192538142 Time :  2244
accuracy train: 0.997684 val: 0.734328 test: 0.719515
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({2: 2975, 0: 2901, 1: 1524})

Epoch :  53 loss training:  12.871423061937094 Time :  2273
accuracy train: 0.997684 val: 0.743284 test: 0.722731
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({0: 2990, 1: 2886, 2: 1524})

Epoch :  54 loss training:  12.27294959872961 Time :  2303
accuracy train: 0.998345 val: 0.755224 test: 0.715063
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({0: 3002, 1: 2877, 2: 1521})

Epoch :  55 loss training:  11.981642244383693 Time :  2342
accuracy train: 0.999007 val: 0.752239 test: 0.717784
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({2: 2989, 1: 2894, 0: 1517})

Epoch :  56 loss training:  12.06278182938695 Time :  2373
accuracy train: 0.999007 val: 0.740299 test: 0.717289
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({2: 2968, 0: 2922, 1: 1510})

Epoch :  57 loss training:  10.48740447126329 Time :  2400
accuracy train: 0.999669 val: 0.737313 test: 0.713084
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({2: 2972, 0: 2920, 1: 1508})

Epoch :  58 loss training:  11.240789534524083 Time :  2439
accuracy train: 1.000000 val: 0.743284 test: 0.715063
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({2: 2977, 1: 2918, 0: 1505})

Epoch :  59 loss training:  10.15400851983577 Time :  2471
accuracy train: 0.999669 val: 0.725373 test: 0.717289
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({1: 2977, 0: 2921, 2: 1502})

Epoch :  60 loss training:  10.218756036367267 Time :  2500
accuracy train: 0.999669 val: 0.743284 test: 0.716547
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({2: 2980, 1: 2924, 0: 1496})

Epoch :  61 loss training:  9.286113256588578 Time :  2534
accuracy train: 1.000000 val: 0.731343 test: 0.717289
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({0: 2987, 2: 2925, 1: 1488})

Epoch :  62 loss training:  9.04122519493103 Time :  2563
accuracy train: 0.999338 val: 0.728358 test: 0.714568
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({1: 2969, 0: 2948, 2: 1483})

Epoch :  63 loss training:  9.195655918680131 Time :  2591
accuracy train: 1.000000 val: 0.725373 test: 0.718031
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({2: 2967, 0: 2950, 1: 1483})

Epoch :  64 loss training:  7.88148105610162 Time :  2635
accuracy train: 0.999338 val: 0.737313 test: 0.716052
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({2: 2979, 1: 2943, 0: 1478})

Epoch :  65 loss training:  8.028371008113027 Time :  2663
accuracy train: 0.999669 val: 0.743284 test: 0.717536
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({0: 2985, 2: 2939, 1: 1476})

Epoch :  66 loss training:  7.993084017187357 Time :  2692
accuracy train: 1.000000 val: 0.755224 test: 0.719021
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({0: 2990, 2: 2937, 1: 1473})

Epoch :  67 loss training:  6.482421663589776 Time :  2732
accuracy train: 1.000000 val: 0.731343 test: 0.714074
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({1: 3022, 0: 2907, 2: 1471})

Epoch :  68 loss training:  7.627580547705293 Time :  2763
accuracy train: 1.000000 val: 0.749254 test: 0.713579
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({0: 3020, 1: 2910, 2: 1470})

Epoch :  69 loss training:  6.53342654556036 Time :  2791
accuracy train: 1.000000 val: 0.734328 test: 0.715558
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({0: 3022, 2: 2911, 1: 1467})

Epoch :  70 loss training:  6.607684490736574 Time :  2818
accuracy train: 1.000000 val: 0.734328 test: 0.719268
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({0: 3037, 2: 2900, 1: 1463})

Epoch :  71 loss training:  5.927807710133493 Time :  2852
accuracy train: 1.000000 val: 0.737313 test: 0.717042
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({2: 3037, 0: 2901, 1: 1462})

Epoch :  72 loss training:  6.374600657261908 Time :  2882
accuracy train: 1.000000 val: 0.728358 test: 0.712590
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({1: 3025, 0: 2914, 2: 1461})

Epoch :  73 loss training:  5.975859344936907 Time :  2914
accuracy train: 0.999669 val: 0.752239 test: 0.720505
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({0: 3024, 1: 2916, 2: 1460})

Epoch :  74 loss training:  5.394772103987634 Time :  2949
accuracy train: 1.000000 val: 0.740299 test: 0.716052
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({1: 3015, 2: 2929, 0: 1456})

Epoch :  75 loss training:  5.749123857822269 Time :  2980
accuracy train: 1.000000 val: 0.737313 test: 0.714321
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({0: 3019, 2: 2927, 1: 1454})

Epoch :  76 loss training:  5.238333311863244 Time :  3006
accuracy train: 1.000000 val: 0.734328 test: 0.718031
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({1: 3013, 0: 2934, 2: 1453})

Epoch :  77 loss training:  4.978362932335585 Time :  3046
accuracy train: 1.000000 val: 0.740299 test: 0.717536
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.715310
Counter({1: 3006, 0: 2941, 2: 1453})

========================================================================================================================================================================================================
max acc epoch :  46
max validation accuracy :  0.755223880597015
test accuracy :  0.7153104130596092
last test_accuracy :  0.7175364828097948
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=540, weight_decay=0)
device :  cuda:0
Counter({1: 2590, 2: 2551, 0: 2259})

Epoch :  1 loss training:  212.5505176782608 Time :  3100
accuracy train: 0.660490 val: 0.614925 test: 0.627504
max validation accuracy : 0.614925 max acc epoch : 1 test accuracy : 0.627504
Counter({0: 3809, 2: 1802, 1: 1789})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  142.35926473140717 Time :  3130
accuracy train: 0.714758 val: 0.668657 test: 0.658669
max validation accuracy : 0.668657 max acc epoch : 2 test accuracy : 0.658669
Counter({2: 3382, 0: 2431, 1: 1587})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.33693888783455 Time :  3158
accuracy train: 0.746856 val: 0.653731 test: 0.653475
max validation accuracy : 0.668657 max acc epoch : 2 test accuracy : 0.658669
Counter({2: 2806, 0: 2755, 1: 1839})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.17926371097565 Time :  3204
accuracy train: 0.795500 val: 0.677612 test: 0.695028
max validation accuracy : 0.677612 max acc epoch : 4 test accuracy : 0.695028
Counter({1: 2853, 2: 2804, 0: 1743})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  91.67660188674927 Time :  3234
accuracy train: 0.812707 val: 0.671642 test: 0.701459
max validation accuracy : 0.677612 max acc epoch : 4 test accuracy : 0.695028
Counter({1: 2876, 0: 2785, 2: 1739})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  82.98107796907425 Time :  3261
accuracy train: 0.828921 val: 0.686567 test: 0.692555
max validation accuracy : 0.686567 max acc epoch : 6 test accuracy : 0.692555
Counter({2: 2916, 1: 2797, 0: 1687})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  73.26776513457298 Time :  3289
accuracy train: 0.864659 val: 0.689552 test: 0.704180
max validation accuracy : 0.689552 max acc epoch : 7 test accuracy : 0.704180
Counter({1: 3153, 0: 2584, 2: 1663})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.74557566642761 Time :  3315
accuracy train: 0.852085 val: 0.698507 test: 0.706406
max validation accuracy : 0.698507 max acc epoch : 8 test accuracy : 0.706406
Counter({2: 3164, 0: 2594, 1: 1642})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.2914346754551 Time :  3356
accuracy train: 0.873263 val: 0.689552 test: 0.714568
max validation accuracy : 0.698507 max acc epoch : 8 test accuracy : 0.706406
Counter({0: 3115, 1: 2659, 2: 1626})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.98780845105648 Time :  3382
accuracy train: 0.885506 val: 0.692537 test: 0.714568
max validation accuracy : 0.698507 max acc epoch : 8 test accuracy : 0.706406
Counter({2: 3130, 1: 2644, 0: 1626})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.12507489323616 Time :  3412
accuracy train: 0.904368 val: 0.710448 test: 0.716052
max validation accuracy : 0.710448 max acc epoch : 11 test accuracy : 0.716052
Counter({1: 3137, 2: 2646, 0: 1617})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  55.411164194345474 Time :  3440
accuracy train: 0.904037 val: 0.704478 test: 0.718031
max validation accuracy : 0.710448 max acc epoch : 11 test accuracy : 0.716052
Counter({1: 3123, 0: 2663, 2: 1614})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  51.747019201517105 Time :  3480
accuracy train: 0.913633 val: 0.713433 test: 0.717784
max validation accuracy : 0.713433 max acc epoch : 13 test accuracy : 0.717784
Counter({0: 3119, 1: 2672, 2: 1609})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  49.54045523703098 Time :  3513
accuracy train: 0.918266 val: 0.707463 test: 0.717784
max validation accuracy : 0.713433 max acc epoch : 13 test accuracy : 0.717784
Counter({1: 3113, 0: 2681, 2: 1606})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  49.01458206772804 Time :  3550
accuracy train: 0.927201 val: 0.713433 test: 0.717536
max validation accuracy : 0.713433 max acc epoch : 13 test accuracy : 0.717784
Counter({0: 3116, 2: 2683, 1: 1601})

Epoch :  16 loss training:  46.33369942009449 Time :  3586
accuracy train: 0.929848 val: 0.722388 test: 0.720010
max validation accuracy : 0.722388 max acc epoch : 16 test accuracy : 0.720010
Counter({0: 3110, 2: 2698, 1: 1592})

Epoch :  17 loss training:  45.26835575699806 Time :  3628
accuracy train: 0.935142 val: 0.716418 test: 0.720752
max validation accuracy : 0.722388 max acc epoch : 16 test accuracy : 0.720010
Counter({0: 3093, 1: 2713, 2: 1594})

Epoch :  18 loss training:  45.037894785404205 Time :  3669
accuracy train: 0.937459 val: 0.719403 test: 0.726193
max validation accuracy : 0.722388 max acc epoch : 16 test accuracy : 0.720010
Counter({1: 3093, 2: 2719, 0: 1588})

Epoch :  19 loss training:  42.36827449500561 Time :  3699
accuracy train: 0.940437 val: 0.713433 test: 0.716300
max validation accuracy : 0.722388 max acc epoch : 16 test accuracy : 0.720010
Counter({2: 3097, 1: 2722, 0: 1581})

Epoch :  20 loss training:  41.10705900192261 Time :  3734
accuracy train: 0.948709 val: 0.722388 test: 0.716547
max validation accuracy : 0.722388 max acc epoch : 16 test accuracy : 0.720010
Counter({0: 3103, 1: 2719, 2: 1578})

Epoch :  21 loss training:  38.956151001155376 Time :  3768
accuracy train: 0.948709 val: 0.734328 test: 0.716794
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({1: 3101, 2: 2719, 0: 1580})

Epoch :  22 loss training:  39.27233263850212 Time :  3810
accuracy train: 0.950695 val: 0.725373 test: 0.718279
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({2: 3080, 0: 2738, 1: 1582})

Epoch :  23 loss training:  37.74006614089012 Time :  3842
accuracy train: 0.951026 val: 0.719403 test: 0.720505
max validation accuracy : 0.734328 max acc epoch : 21 test accuracy : 0.716794
Counter({0: 3073, 1: 2745, 2: 1582})

Epoch :  24 loss training:  36.25384033471346 Time :  3869
accuracy train: 0.958306 val: 0.737313 test: 0.717289
max validation accuracy : 0.737313 max acc epoch : 24 test accuracy : 0.717289
Counter({1: 3068, 0: 2756, 2: 1576})

Epoch :  25 loss training:  35.542344994843006 Time :  3907
accuracy train: 0.960953 val: 0.719403 test: 0.721741
max validation accuracy : 0.737313 max acc epoch : 24 test accuracy : 0.717289
Counter({1: 3059, 0: 2764, 2: 1577})

Epoch :  26 loss training:  34.83832637220621 Time :  3952
accuracy train: 0.963931 val: 0.719403 test: 0.720257
max validation accuracy : 0.737313 max acc epoch : 24 test accuracy : 0.717289
Counter({0: 3050, 2: 2782, 1: 1568})

Epoch :  27 loss training:  32.695379711687565 Time :  3986
accuracy train: 0.965917 val: 0.740299 test: 0.720999
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({2: 3047, 0: 2788, 1: 1565})

Epoch :  28 loss training:  31.55422304570675 Time :  4016
accuracy train: 0.968233 val: 0.731343 test: 0.725204
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({2: 3046, 1: 2794, 0: 1560})

Epoch :  29 loss training:  31.582462064921856 Time :  4044
accuracy train: 0.975513 val: 0.707463 test: 0.722978
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({1: 3040, 2: 2796, 0: 1564})

Epoch :  30 loss training:  28.652744952589273 Time :  4076
accuracy train: 0.975182 val: 0.731343 test: 0.721989
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({1: 3033, 0: 2804, 2: 1563})

Epoch :  31 loss training:  29.185352593660355 Time :  4105
accuracy train: 0.977498 val: 0.725373 test: 0.716794
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({1: 3024, 2: 2815, 0: 1561})

Epoch :  32 loss training:  27.19235957786441 Time :  4134
accuracy train: 0.978822 val: 0.719403 test: 0.719515
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({0: 3023, 2: 2818, 1: 1559})

Epoch :  33 loss training:  26.834412407130003 Time :  4160
accuracy train: 0.980807 val: 0.728358 test: 0.722236
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({0: 3022, 2: 2817, 1: 1561})

Epoch :  34 loss training:  25.51311320066452 Time :  4195
accuracy train: 0.984778 val: 0.719403 test: 0.721494
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({1: 3017, 2: 2827, 0: 1556})

Epoch :  35 loss training:  23.76050291210413 Time :  4236
accuracy train: 0.984778 val: 0.716418 test: 0.718526
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({1: 3017, 0: 2829, 2: 1554})

Epoch :  36 loss training:  23.47326996177435 Time :  4262
accuracy train: 0.986102 val: 0.725373 test: 0.719515
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({1: 3019, 0: 2830, 2: 1551})

Epoch :  37 loss training:  23.325571849942207 Time :  4293
accuracy train: 0.985440 val: 0.719403 test: 0.716794
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({1: 3008, 0: 2842, 2: 1550})

Epoch :  38 loss training:  21.733483534306288 Time :  4320
accuracy train: 0.987426 val: 0.722388 test: 0.720010
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({2: 2993, 1: 2859, 0: 1548})

Epoch :  39 loss training:  21.1806017793715 Time :  4350
accuracy train: 0.988087 val: 0.728358 test: 0.717784
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({1: 3001, 0: 2855, 2: 1544})

Epoch :  40 loss training:  21.44410589337349 Time :  4385
accuracy train: 0.991066 val: 0.737313 test: 0.718031
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({2: 3000, 0: 2854, 1: 1546})

Epoch :  41 loss training:  18.814725179225206 Time :  4411
accuracy train: 0.992389 val: 0.725373 test: 0.718279
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({0: 2989, 1: 2866, 2: 1545})

Epoch :  42 loss training:  19.429472751915455 Time :  4439
accuracy train: 0.992720 val: 0.737313 test: 0.720010
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({0: 2985, 2: 2874, 1: 1541})

Epoch :  43 loss training:  18.431051436811686 Time :  4464
accuracy train: 0.993051 val: 0.740299 test: 0.718773
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({1: 2983, 0: 2875, 2: 1542})

Epoch :  44 loss training:  17.563779827207327 Time :  4502
accuracy train: 0.994705 val: 0.728358 test: 0.721989
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({0: 2977, 1: 2882, 2: 1541})

Epoch :  45 loss training:  17.712371204048395 Time :  4530
accuracy train: 0.995036 val: 0.728358 test: 0.719515
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({0: 2965, 1: 2897, 2: 1538})

Epoch :  46 loss training:  17.258447658270597 Time :  4556
accuracy train: 0.995367 val: 0.740299 test: 0.717289
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({2: 2965, 1: 2902, 0: 1533})

Epoch :  47 loss training:  15.039051512256265 Time :  4583
accuracy train: 0.996029 val: 0.737313 test: 0.718279
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({1: 2981, 2: 2891, 0: 1528})

Epoch :  48 loss training:  14.62909471616149 Time :  4612
accuracy train: 0.997022 val: 0.734328 test: 0.716547
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({0: 2979, 1: 2890, 2: 1531})

Epoch :  49 loss training:  13.305203767493367 Time :  4664
accuracy train: 0.997353 val: 0.734328 test: 0.721247
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({2: 2988, 0: 2889, 1: 1523})

Epoch :  50 loss training:  13.559396117925644 Time :  4690
accuracy train: 0.998676 val: 0.728358 test: 0.713084
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({0: 2994, 2: 2883, 1: 1523})

Epoch :  51 loss training:  12.314326157793403 Time :  4722
accuracy train: 0.998345 val: 0.728358 test: 0.716794
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({0: 2991, 2: 2888, 1: 1521})

Epoch :  52 loss training:  13.300860814750195 Time :  4750
accuracy train: 0.999669 val: 0.731343 test: 0.718526
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({0: 2992, 1: 2890, 2: 1518})

Epoch :  53 loss training:  12.492344111204147 Time :  4780
accuracy train: 0.998676 val: 0.734328 test: 0.717289
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({0: 3017, 2: 2866, 1: 1517})

Epoch :  54 loss training:  12.434721257537603 Time :  4809
accuracy train: 0.999007 val: 0.722388 test: 0.719515
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({0: 3020, 1: 2866, 2: 1514})

Epoch :  55 loss training:  11.780063215643167 Time :  4840
accuracy train: 0.999338 val: 0.725373 test: 0.715558
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({2: 2995, 1: 2892, 0: 1513})

Epoch :  56 loss training:  10.995026437565684 Time :  4870
accuracy train: 0.999338 val: 0.722388 test: 0.721989
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({0: 2978, 1: 2914, 2: 1508})

Epoch :  57 loss training:  10.390149868093431 Time :  4895
accuracy train: 0.999007 val: 0.722388 test: 0.717536
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({2: 2989, 0: 2914, 1: 1497})

Epoch :  58 loss training:  9.902845241129398 Time :  4934
accuracy train: 0.999669 val: 0.716418 test: 0.716052
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.720999
Counter({1: 2988, 2: 2922, 0: 1490})

========================================================================================================================================================================================================
max acc epoch :  27
max validation accuracy :  0.7402985074626866
test accuracy :  0.7209992579767499
last test_accuracy :  0.7160524363096711
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=540, weight_decay=0)
device :  cuda:0
Counter({1: 2590, 2: 2551, 0: 2259})

Epoch :  1 loss training:  212.561807513237 Time :  4968
accuracy train: 0.649901 val: 0.605970 test: 0.622805
max validation accuracy : 0.605970 max acc epoch : 1 test accuracy : 0.622805
Counter({2: 3732, 1: 1837, 0: 1831})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  142.7638382911682 Time :  4998
accuracy train: 0.723693 val: 0.683582 test: 0.662627
max validation accuracy : 0.683582 max acc epoch : 2 test accuracy : 0.662627
Counter({0: 3428, 1: 2310, 2: 1662})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.02174320816994 Time :  5041
accuracy train: 0.747849 val: 0.647761 test: 0.660401
max validation accuracy : 0.683582 max acc epoch : 2 test accuracy : 0.662627
Counter({2: 2905, 0: 2757, 1: 1738})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  99.09673309326172 Time :  5087
accuracy train: 0.794507 val: 0.683582 test: 0.696265
max validation accuracy : 0.683582 max acc epoch : 2 test accuracy : 0.662627
Counter({2: 3045, 0: 2691, 1: 1664})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  91.45778322219849 Time :  5112
accuracy train: 0.811714 val: 0.677612 test: 0.698244
max validation accuracy : 0.683582 max acc epoch : 2 test accuracy : 0.662627
Counter({1: 3106, 0: 2636, 2: 1658})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  83.32859887182713 Time :  5140
accuracy train: 0.828590 val: 0.716418 test: 0.700470
max validation accuracy : 0.716418 max acc epoch : 6 test accuracy : 0.700470
Counter({0: 2981, 2: 2751, 1: 1668})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  72.81740428507328 Time :  5170
accuracy train: 0.859696 val: 0.686567 test: 0.706653
max validation accuracy : 0.716418 max acc epoch : 6 test accuracy : 0.700470
Counter({1: 2857, 2: 2846, 0: 1697})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  70.32644684612751 Time :  5199
accuracy train: 0.861681 val: 0.710448 test: 0.706653
max validation accuracy : 0.716418 max acc epoch : 6 test accuracy : 0.700470
Counter({2: 2901, 1: 2818, 0: 1681})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  66.23422408103943 Time :  5231
accuracy train: 0.883521 val: 0.716418 test: 0.709622
max validation accuracy : 0.716418 max acc epoch : 6 test accuracy : 0.700470
Counter({0: 2877, 1: 2853, 2: 1670})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.0229951441288 Time :  5265
accuracy train: 0.887161 val: 0.713433 test: 0.711848
max validation accuracy : 0.716418 max acc epoch : 6 test accuracy : 0.700470
Counter({2: 2927, 0: 2813, 1: 1660})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.409585669636726 Time :  5291
accuracy train: 0.895433 val: 0.713433 test: 0.712095
max validation accuracy : 0.716418 max acc epoch : 6 test accuracy : 0.700470
Counter({2: 2954, 0: 2795, 1: 1651})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  56.567190796136856 Time :  5326
accuracy train: 0.906353 val: 0.716418 test: 0.714568
max validation accuracy : 0.716418 max acc epoch : 6 test accuracy : 0.700470
Counter({1: 2954, 0: 2806, 2: 1640})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  52.71945437788963 Time :  5366
accuracy train: 0.913964 val: 0.734328 test: 0.716052
max validation accuracy : 0.734328 max acc epoch : 13 test accuracy : 0.716052
Counter({0: 2964, 1: 2806, 2: 1630})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  49.76068897545338 Time :  5391
accuracy train: 0.918928 val: 0.728358 test: 0.717042
max validation accuracy : 0.734328 max acc epoch : 13 test accuracy : 0.716052
Counter({1: 2965, 2: 2808, 0: 1627})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  47.18842227756977 Time :  5423
accuracy train: 0.923230 val: 0.725373 test: 0.716547
max validation accuracy : 0.734328 max acc epoch : 13 test accuracy : 0.716052
Counter({1: 2964, 2: 2809, 0: 1627})

Epoch :  16 loss training:  46.78606644272804 Time :  5451
accuracy train: 0.928855 val: 0.716418 test: 0.715310
max validation accuracy : 0.734328 max acc epoch : 13 test accuracy : 0.716052
Counter({2: 2965, 0: 2817, 1: 1618})

Epoch :  17 loss training:  45.7247513756156 Time :  5486
accuracy train: 0.933488 val: 0.722388 test: 0.720752
max validation accuracy : 0.734328 max acc epoch : 13 test accuracy : 0.716052
Counter({0: 2965, 2: 2817, 1: 1618})

Epoch :  18 loss training:  45.32609061896801 Time :  5513
accuracy train: 0.935804 val: 0.743284 test: 0.721989
max validation accuracy : 0.743284 max acc epoch : 18 test accuracy : 0.721989
Counter({1: 2967, 2: 2818, 0: 1615})

Epoch :  19 loss training:  42.56448395550251 Time :  5546
accuracy train: 0.939775 val: 0.737313 test: 0.717042
max validation accuracy : 0.743284 max acc epoch : 18 test accuracy : 0.721989
Counter({2: 2976, 1: 2812, 0: 1612})

Epoch :  20 loss training:  41.555353567004204 Time :  5572
accuracy train: 0.944408 val: 0.713433 test: 0.716300
max validation accuracy : 0.743284 max acc epoch : 18 test accuracy : 0.721989
Counter({0: 2979, 2: 2812, 1: 1609})

Epoch :  21 loss training:  38.867684096097946 Time :  5599
accuracy train: 0.946724 val: 0.737313 test: 0.719763
max validation accuracy : 0.743284 max acc epoch : 18 test accuracy : 0.721989
Counter({0: 2968, 1: 2823, 2: 1609})

Epoch :  22 loss training:  39.12173844873905 Time :  5644
accuracy train: 0.950364 val: 0.728358 test: 0.720010
max validation accuracy : 0.743284 max acc epoch : 18 test accuracy : 0.721989
Counter({2: 2977, 0: 2818, 1: 1605})

Epoch :  23 loss training:  37.873095616698265 Time :  5671
accuracy train: 0.952019 val: 0.722388 test: 0.719515
max validation accuracy : 0.743284 max acc epoch : 18 test accuracy : 0.721989
Counter({0: 2980, 1: 2818, 2: 1602})

Epoch :  24 loss training:  35.93154485523701 Time :  5697
accuracy train: 0.957313 val: 0.731343 test: 0.719515
max validation accuracy : 0.743284 max acc epoch : 18 test accuracy : 0.721989
Counter({0: 2984, 1: 2818, 2: 1598})

Epoch :  25 loss training:  35.14198710024357 Time :  5723
accuracy train: 0.961284 val: 0.722388 test: 0.721247
max validation accuracy : 0.743284 max acc epoch : 18 test accuracy : 0.721989
Counter({2: 2973, 0: 2832, 1: 1595})

Epoch :  26 loss training:  34.73218788206577 Time :  5751
accuracy train: 0.966909 val: 0.731343 test: 0.718031
max validation accuracy : 0.743284 max acc epoch : 18 test accuracy : 0.721989
Counter({1: 2966, 0: 2839, 2: 1595})

Epoch :  27 loss training:  33.39914612099528 Time :  5783
accuracy train: 0.968233 val: 0.743284 test: 0.719021
max validation accuracy : 0.743284 max acc epoch : 18 test accuracy : 0.721989
Counter({0: 2957, 2: 2852, 1: 1591})

Epoch :  28 loss training:  32.90951335430145 Time :  5810
accuracy train: 0.969887 val: 0.737313 test: 0.720999
max validation accuracy : 0.743284 max acc epoch : 18 test accuracy : 0.721989
Counter({2: 2960, 0: 2859, 1: 1581})

Epoch :  29 loss training:  31.32096342742443 Time :  5842
accuracy train: 0.973527 val: 0.716418 test: 0.720999
max validation accuracy : 0.743284 max acc epoch : 18 test accuracy : 0.721989
Counter({1: 2961, 0: 2859, 2: 1580})

Epoch :  30 loss training:  28.377050951123238 Time :  5871
accuracy train: 0.970880 val: 0.713433 test: 0.715558
max validation accuracy : 0.743284 max acc epoch : 18 test accuracy : 0.721989
Counter({2: 2962, 1: 2859, 0: 1579})

Epoch :  31 loss training:  27.80957092344761 Time :  5901
accuracy train: 0.977498 val: 0.731343 test: 0.714568
max validation accuracy : 0.743284 max acc epoch : 18 test accuracy : 0.721989
Counter({0: 2962, 2: 2866, 1: 1572})

Epoch :  32 loss training:  27.834234427660704 Time :  5929
accuracy train: 0.979153 val: 0.731343 test: 0.717536
max validation accuracy : 0.743284 max acc epoch : 18 test accuracy : 0.721989
Counter({0: 2950, 2: 2879, 1: 1571})

Epoch :  33 loss training:  25.77790730446577 Time :  5963
accuracy train: 0.976506 val: 0.728358 test: 0.720257
max validation accuracy : 0.743284 max acc epoch : 18 test accuracy : 0.721989
Counter({0: 2943, 2: 2891, 1: 1566})

Epoch :  34 loss training:  26.41738348081708 Time :  5990
accuracy train: 0.980477 val: 0.731343 test: 0.720010
max validation accuracy : 0.743284 max acc epoch : 18 test accuracy : 0.721989
Counter({0: 2939, 1: 2898, 2: 1563})

Epoch :  35 loss training:  24.00544684752822 Time :  6015
accuracy train: 0.983124 val: 0.728358 test: 0.721989
max validation accuracy : 0.743284 max acc epoch : 18 test accuracy : 0.721989
Counter({0: 2941, 1: 2900, 2: 1559})

Epoch :  36 loss training:  23.986188858747482 Time :  6064
accuracy train: 0.984116 val: 0.734328 test: 0.719763
max validation accuracy : 0.743284 max acc epoch : 18 test accuracy : 0.721989
Counter({0: 2952, 2: 2895, 1: 1553})

Epoch :  37 loss training:  21.27800514921546 Time :  6089
accuracy train: 0.984116 val: 0.731343 test: 0.719515
max validation accuracy : 0.743284 max acc epoch : 18 test accuracy : 0.721989
Counter({0: 2967, 2: 2881, 1: 1552})

Epoch :  38 loss training:  21.74815136566758 Time :  6117
accuracy train: 0.988749 val: 0.746269 test: 0.718773
max validation accuracy : 0.746269 max acc epoch : 38 test accuracy : 0.718773
Counter({2: 2974, 1: 2874, 0: 1552})

Epoch :  39 loss training:  22.1323389261961 Time :  6144
accuracy train: 0.990404 val: 0.728358 test: 0.714321
max validation accuracy : 0.746269 max acc epoch : 38 test accuracy : 0.718773
Counter({0: 2974, 1: 2878, 2: 1548})

Epoch :  40 loss training:  20.051335982978344 Time :  6174
accuracy train: 0.991396 val: 0.743284 test: 0.719763
max validation accuracy : 0.746269 max acc epoch : 38 test accuracy : 0.718773
Counter({2: 2976, 0: 2879, 1: 1545})

Epoch :  41 loss training:  19.472849640995264 Time :  6200
accuracy train: 0.990735 val: 0.749254 test: 0.719763
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({0: 2976, 1: 2882, 2: 1542})

Epoch :  42 loss training:  18.368465531617403 Time :  6232
accuracy train: 0.992389 val: 0.737313 test: 0.720257
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({1: 2990, 0: 2873, 2: 1537})

Epoch :  43 loss training:  18.133507385849953 Time :  6262
accuracy train: 0.992389 val: 0.737313 test: 0.718031
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({0: 2992, 1: 2869, 2: 1539})

Epoch :  44 loss training:  18.73049844428897 Time :  6289
accuracy train: 0.993051 val: 0.734328 test: 0.718279
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({2: 2987, 0: 2876, 1: 1537})

Epoch :  45 loss training:  17.162827875465155 Time :  6332
accuracy train: 0.994044 val: 0.743284 test: 0.717536
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({0: 3002, 2: 2875, 1: 1523})

Epoch :  46 loss training:  15.66840673610568 Time :  6359
accuracy train: 0.995036 val: 0.740299 test: 0.716547
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({2: 3005, 0: 2874, 1: 1521})

Epoch :  47 loss training:  16.082909800112247 Time :  6385
accuracy train: 0.995367 val: 0.740299 test: 0.720257
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({2: 3003, 1: 2881, 0: 1516})

Epoch :  48 loss training:  15.49919069930911 Time :  6418
accuracy train: 0.996691 val: 0.734328 test: 0.717784
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({0: 3013, 2: 2875, 1: 1512})

Epoch :  49 loss training:  14.059245109558105 Time :  6447
accuracy train: 0.997353 val: 0.722388 test: 0.718526
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({0: 3020, 1: 2873, 2: 1507})

Epoch :  50 loss training:  14.350482996553183 Time :  6477
accuracy train: 0.996691 val: 0.719403 test: 0.715063
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({0: 3022, 2: 2873, 1: 1505})

Epoch :  51 loss training:  13.668001938611269 Time :  6504
accuracy train: 0.997353 val: 0.731343 test: 0.715310
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({2: 3028, 1: 2866, 0: 1506})

Epoch :  52 loss training:  12.26243326254189 Time :  6533
accuracy train: 0.997353 val: 0.725373 test: 0.716547
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({1: 3026, 0: 2873, 2: 1501})

Epoch :  53 loss training:  12.397057810798287 Time :  6564
accuracy train: 0.997684 val: 0.737313 test: 0.717042
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({2: 3034, 0: 2869, 1: 1497})

Epoch :  54 loss training:  10.702934857457876 Time :  6597
accuracy train: 0.997684 val: 0.737313 test: 0.718279
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({0: 3041, 2: 2873, 1: 1486})

Epoch :  55 loss training:  11.492092860862613 Time :  6627
accuracy train: 0.999007 val: 0.725373 test: 0.713084
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({2: 3050, 1: 2865, 0: 1485})

Epoch :  56 loss training:  11.647096327506006 Time :  6657
accuracy train: 0.998676 val: 0.743284 test: 0.718031
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({0: 3038, 2: 2884, 1: 1478})

Epoch :  57 loss training:  11.190777676180005 Time :  6681
accuracy train: 0.999007 val: 0.731343 test: 0.718279
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({2: 3047, 0: 2878, 1: 1475})

Epoch :  58 loss training:  9.734453666955233 Time :  6716
accuracy train: 0.999669 val: 0.734328 test: 0.719021
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({2: 3042, 1: 2888, 0: 1470})

Epoch :  59 loss training:  9.830300837755203 Time :  6755
accuracy train: 1.000000 val: 0.728358 test: 0.719268
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({1: 3046, 0: 2886, 2: 1468})

Epoch :  60 loss training:  10.285617215558887 Time :  6782
accuracy train: 1.000000 val: 0.728358 test: 0.715805
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({2: 3022, 0: 2910, 1: 1468})

Epoch :  61 loss training:  9.305166989564896 Time :  6809
accuracy train: 0.999669 val: 0.731343 test: 0.719268
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({2: 3025, 1: 2913, 0: 1462})

Epoch :  62 loss training:  9.144686367362738 Time :  6842
accuracy train: 0.999669 val: 0.734328 test: 0.719268
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({0: 3028, 2: 2916, 1: 1456})

Epoch :  63 loss training:  8.370712202042341 Time :  6877
accuracy train: 1.000000 val: 0.737313 test: 0.718031
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({2: 3030, 0: 2914, 1: 1456})

Epoch :  64 loss training:  8.282671255990863 Time :  6905
accuracy train: 0.999669 val: 0.722388 test: 0.719515
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({2: 3023, 0: 2921, 1: 1456})

Epoch :  65 loss training:  8.085086390376091 Time :  6933
accuracy train: 1.000000 val: 0.731343 test: 0.718773
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({1: 3026, 0: 2917, 2: 1457})

Epoch :  66 loss training:  7.871999269351363 Time :  6961
accuracy train: 1.000000 val: 0.722388 test: 0.712590
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({2: 3032, 1: 2912, 0: 1456})

Epoch :  67 loss training:  7.605363523121923 Time :  6987
accuracy train: 1.000000 val: 0.731343 test: 0.714568
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({1: 3031, 0: 2913, 2: 1456})

Epoch :  68 loss training:  7.357194774784148 Time :  7032
accuracy train: 1.000000 val: 0.737313 test: 0.711848
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({2: 3038, 0: 2908, 1: 1454})

Epoch :  69 loss training:  7.156512413173914 Time :  7059
accuracy train: 1.000000 val: 0.716418 test: 0.716052
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({1: 3033, 2: 2909, 0: 1458})

Epoch :  70 loss training:  6.726266385987401 Time :  7091
accuracy train: 1.000000 val: 0.734328 test: 0.716547
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({0: 3034, 1: 2909, 2: 1457})

Epoch :  71 loss training:  7.0168973403051496 Time :  7120
accuracy train: 1.000000 val: 0.737313 test: 0.709622
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({2: 3037, 0: 2904, 1: 1459})

Epoch :  72 loss training:  5.3606425719335675 Time :  7150
accuracy train: 1.000000 val: 0.725373 test: 0.713332
max validation accuracy : 0.749254 max acc epoch : 41 test accuracy : 0.719763
Counter({2: 3040, 1: 2904, 0: 1456})

========================================================================================================================================================================================================
max acc epoch :  41
max validation accuracy :  0.7492537313432835
test accuracy :  0.7197625525599802
last test_accuracy :  0.7133316843927776
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=540, weight_decay=0)
device :  cuda:0
Counter({1: 2590, 2: 2551, 0: 2259})

Epoch :  1 loss training:  212.44400465488434 Time :  7193
accuracy train: 0.654864 val: 0.623881 test: 0.625278
max validation accuracy : 0.623881 max acc epoch : 1 test accuracy : 0.625278
Counter({1: 3823, 0: 1789, 2: 1788})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  142.1666318178177 Time :  7218
accuracy train: 0.711449 val: 0.653731 test: 0.652486
max validation accuracy : 0.653731 max acc epoch : 2 test accuracy : 0.652486
Counter({2: 3427, 0: 2409, 1: 1564})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.19372460246086 Time :  7253
accuracy train: 0.749504 val: 0.662687 test: 0.658175
max validation accuracy : 0.662687 max acc epoch : 3 test accuracy : 0.658175
Counter({0: 2952, 2: 2693, 1: 1755})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.21856406331062 Time :  7285
accuracy train: 0.794838 val: 0.680597 test: 0.698491
max validation accuracy : 0.680597 max acc epoch : 4 test accuracy : 0.698491
Counter({2: 3023, 0: 2702, 1: 1675})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  91.4450221657753 Time :  7315
accuracy train: 0.814030 val: 0.674627 test: 0.697749
max validation accuracy : 0.680597 max acc epoch : 4 test accuracy : 0.698491
Counter({0: 3082, 1: 2674, 2: 1644})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  83.53332099318504 Time :  7348
accuracy train: 0.833554 val: 0.704478 test: 0.701707
max validation accuracy : 0.704478 max acc epoch : 6 test accuracy : 0.701707
Counter({2: 4287, 0: 1626, 1: 1487})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  72.77787739038467 Time :  7378
accuracy train: 0.857379 val: 0.701493 test: 0.708138
max validation accuracy : 0.704478 max acc epoch : 6 test accuracy : 0.701707
Counter({0: 4360, 1: 1624, 2: 1416})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  70.66299499571323 Time :  7403
accuracy train: 0.865652 val: 0.713433 test: 0.711600
max validation accuracy : 0.713433 max acc epoch : 8 test accuracy : 0.711600
Counter({0: 4445, 2: 1587, 1: 1368})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.73354394733906 Time :  7444
accuracy train: 0.875910 val: 0.695522 test: 0.711848
max validation accuracy : 0.713433 max acc epoch : 8 test accuracy : 0.711600
Counter({1: 4476, 0: 1564, 2: 1360})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.71648383140564 Time :  7472
accuracy train: 0.887492 val: 0.689552 test: 0.711106
max validation accuracy : 0.713433 max acc epoch : 8 test accuracy : 0.711600
Counter({1: 4485, 0: 1561, 2: 1354})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.2382779866457 Time :  7501
accuracy train: 0.908670 val: 0.716418 test: 0.716794
max validation accuracy : 0.716418 max acc epoch : 11 test accuracy : 0.716794
Counter({1: 4483, 2: 1561, 0: 1356})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  55.37555770576 Time :  7528
accuracy train: 0.906684 val: 0.707463 test: 0.715063
max validation accuracy : 0.716418 max acc epoch : 11 test accuracy : 0.716794
Counter({2: 4470, 1: 1561, 0: 1369})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  51.82059547305107 Time :  7560
accuracy train: 0.914626 val: 0.719403 test: 0.716794
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.716794
Counter({2: 4464, 1: 1563, 0: 1373})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  50.31651435047388 Time :  7594
accuracy train: 0.916942 val: 0.716418 test: 0.717289
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.716794
Counter({0: 4467, 1: 1562, 2: 1371})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  49.67884862422943 Time :  7621
accuracy train: 0.927201 val: 0.719403 test: 0.719021
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.716794
Counter({1: 4473, 2: 1559, 0: 1368})

Epoch :  16 loss training:  47.57252940535545 Time :  7658
accuracy train: 0.928524 val: 0.713433 test: 0.713826
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.716794
Counter({1: 4477, 0: 1555, 2: 1368})

Epoch :  17 loss training:  46.85294000804424 Time :  7688
accuracy train: 0.931171 val: 0.716418 test: 0.717289
max validation accuracy : 0.719403 max acc epoch : 13 test accuracy : 0.716794
Counter({1: 4483, 0: 1550, 2: 1367})

Epoch :  18 loss training:  45.31299513578415 Time :  7742
accuracy train: 0.935473 val: 0.737313 test: 0.721989
max validation accuracy : 0.737313 max acc epoch : 18 test accuracy : 0.721989
Counter({0: 4481, 2: 1547, 1: 1372})

Epoch :  19 loss training:  42.89621423184872 Time :  7768
accuracy train: 0.938451 val: 0.719403 test: 0.716794
max validation accuracy : 0.737313 max acc epoch : 18 test accuracy : 0.721989
Counter({2: 4487, 0: 1544, 1: 1369})

Epoch :  20 loss training:  41.08266531676054 Time :  7794
accuracy train: 0.946393 val: 0.728358 test: 0.718773
max validation accuracy : 0.737313 max acc epoch : 18 test accuracy : 0.721989
Counter({0: 4493, 1: 1536, 2: 1371})

Epoch :  21 loss training:  39.3950082808733 Time :  7828
accuracy train: 0.949702 val: 0.734328 test: 0.719763
max validation accuracy : 0.737313 max acc epoch : 18 test accuracy : 0.721989
Counter({1: 4500, 0: 1533, 2: 1367})

Epoch :  22 loss training:  39.71247024834156 Time :  7862
accuracy train: 0.952019 val: 0.725373 test: 0.716547
max validation accuracy : 0.737313 max acc epoch : 18 test accuracy : 0.721989
Counter({2: 4498, 1: 1534, 0: 1368})

Epoch :  23 loss training:  38.3111107647419 Time :  7892
accuracy train: 0.951688 val: 0.725373 test: 0.719515
max validation accuracy : 0.737313 max acc epoch : 18 test accuracy : 0.721989
Counter({0: 4494, 2: 1531, 1: 1375})

Epoch :  24 loss training:  36.933992855250835 Time :  7930
accuracy train: 0.958637 val: 0.725373 test: 0.720752
max validation accuracy : 0.737313 max acc epoch : 18 test accuracy : 0.721989
Counter({1: 4491, 0: 1530, 2: 1379})

Epoch :  25 loss training:  37.24403911083937 Time :  7958
accuracy train: 0.959629 val: 0.734328 test: 0.719763
max validation accuracy : 0.737313 max acc epoch : 18 test accuracy : 0.721989
Counter({2: 4491, 1: 1529, 0: 1380})

Epoch :  26 loss training:  34.59110810607672 Time :  7985
accuracy train: 0.961615 val: 0.737313 test: 0.718526
max validation accuracy : 0.737313 max acc epoch : 18 test accuracy : 0.721989
Counter({1: 4494, 0: 1525, 2: 1381})

Epoch :  27 loss training:  33.23874559253454 Time :  8029
accuracy train: 0.963931 val: 0.740299 test: 0.716794
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.716794
Counter({2: 4486, 0: 1526, 1: 1388})

Epoch :  28 loss training:  32.26206195354462 Time :  8058
accuracy train: 0.970549 val: 0.731343 test: 0.716052
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.716794
Counter({1: 4485, 2: 1522, 0: 1393})

Epoch :  29 loss training:  31.31921399384737 Time :  8084
accuracy train: 0.972866 val: 0.731343 test: 0.718526
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.716794
Counter({0: 4493, 1: 1524, 2: 1383})

Epoch :  30 loss training:  29.737804900854826 Time :  8122
accuracy train: 0.970549 val: 0.731343 test: 0.717289
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.716794
Counter({0: 4495, 2: 1523, 1: 1382})

Epoch :  31 loss training:  28.085496574640274 Time :  8155
accuracy train: 0.975513 val: 0.728358 test: 0.717784
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.716794
Counter({0: 4493, 2: 1521, 1: 1386})

Epoch :  32 loss training:  28.726074814796448 Time :  8181
accuracy train: 0.978491 val: 0.725373 test: 0.714816
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.716794
Counter({2: 4504, 1: 1523, 0: 1373})

Epoch :  33 loss training:  27.27019589394331 Time :  8214
accuracy train: 0.977498 val: 0.719403 test: 0.719763
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.716794
Counter({2: 4508, 1: 1520, 0: 1372})

Epoch :  34 loss training:  25.469836466014385 Time :  8242
accuracy train: 0.981469 val: 0.728358 test: 0.717042
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.716794
Counter({2: 4503, 0: 1515, 1: 1382})

Epoch :  35 loss training:  22.999927405267954 Time :  8270
accuracy train: 0.982793 val: 0.731343 test: 0.718031
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.716794
Counter({2: 4509, 0: 1514, 1: 1377})

Epoch :  36 loss training:  24.547179132699966 Time :  8303
accuracy train: 0.983786 val: 0.722388 test: 0.718031
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.716794
Counter({0: 4511, 1: 1515, 2: 1374})

Epoch :  37 loss training:  21.755760530009866 Time :  8332
accuracy train: 0.983786 val: 0.737313 test: 0.716794
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.716794
Counter({1: 4509, 0: 1515, 2: 1376})

Epoch :  38 loss training:  21.55920596420765 Time :  8359
accuracy train: 0.984447 val: 0.728358 test: 0.722978
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.716794
Counter({1: 4509, 2: 1511, 0: 1380})

Epoch :  39 loss training:  22.357503559440374 Time :  8393
accuracy train: 0.987095 val: 0.728358 test: 0.722236
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.716794
Counter({2: 4512, 1: 1505, 0: 1383})

Epoch :  40 loss training:  19.523595593869686 Time :  8428
accuracy train: 0.989411 val: 0.722388 test: 0.721741
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.716794
Counter({2: 4520, 0: 1503, 1: 1377})

Epoch :  41 loss training:  19.116611573845148 Time :  8453
accuracy train: 0.992058 val: 0.740299 test: 0.721494
max validation accuracy : 0.740299 max acc epoch : 27 test accuracy : 0.716794
Counter({1: 4524, 2: 1501, 0: 1375})

Epoch :  42 loss training:  19.226681660860777 Time :  8488
accuracy train: 0.991066 val: 0.746269 test: 0.720257
max validation accuracy : 0.746269 max acc epoch : 42 test accuracy : 0.720257
Counter({2: 4530, 0: 1495, 1: 1375})

Epoch :  43 loss training:  18.4857227653265 Time :  8518
accuracy train: 0.993051 val: 0.740299 test: 0.716794
max validation accuracy : 0.746269 max acc epoch : 42 test accuracy : 0.720257
Counter({0: 4523, 2: 1495, 1: 1382})

Epoch :  44 loss training:  19.05995974317193 Time :  8548
accuracy train: 0.992720 val: 0.740299 test: 0.718773
max validation accuracy : 0.746269 max acc epoch : 42 test accuracy : 0.720257
Counter({0: 4524, 2: 1493, 1: 1383})

Epoch :  45 loss training:  17.874171927571297 Time :  8576
accuracy train: 0.993713 val: 0.740299 test: 0.719021
max validation accuracy : 0.746269 max acc epoch : 42 test accuracy : 0.720257
Counter({0: 4525, 1: 1491, 2: 1384})

Epoch :  46 loss training:  16.209171758964658 Time :  8599
accuracy train: 0.993382 val: 0.728358 test: 0.717289
max validation accuracy : 0.746269 max acc epoch : 42 test accuracy : 0.720257
Counter({2: 4531, 1: 1479, 0: 1390})

Epoch :  47 loss training:  15.598526991903782 Time :  8621
accuracy train: 0.996691 val: 0.752239 test: 0.718279
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({2: 4535, 0: 1477, 1: 1388})

Epoch :  48 loss training:  15.94498598575592 Time :  8644
accuracy train: 0.995698 val: 0.737313 test: 0.719763
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({0: 4531, 2: 1480, 1: 1389})

Epoch :  49 loss training:  14.642095480114222 Time :  8671
accuracy train: 0.996691 val: 0.740299 test: 0.722483
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({0: 4524, 1: 1479, 2: 1397})

Epoch :  50 loss training:  14.414484158158302 Time :  8695
accuracy train: 0.998676 val: 0.731343 test: 0.720999
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({2: 4527, 1: 1478, 0: 1395})

Epoch :  51 loss training:  14.167871624231339 Time :  8718
accuracy train: 0.998015 val: 0.734328 test: 0.716794
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({0: 4543, 2: 1478, 1: 1379})

Epoch :  52 loss training:  12.076901456341147 Time :  8743
accuracy train: 0.999007 val: 0.740299 test: 0.721741
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({0: 4557, 2: 1473, 1: 1370})

Epoch :  53 loss training:  13.199022773653269 Time :  8766
accuracy train: 0.996691 val: 0.746269 test: 0.717289
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({1: 4563, 0: 1470, 2: 1367})

Epoch :  54 loss training:  12.413083951920271 Time :  8794
accuracy train: 0.998345 val: 0.737313 test: 0.716547
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({0: 4588, 1: 1462, 2: 1350})

Epoch :  55 loss training:  10.927738232538104 Time :  8816
accuracy train: 0.999007 val: 0.731343 test: 0.721247
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({2: 4597, 0: 1455, 1: 1348})

Epoch :  56 loss training:  11.894954196177423 Time :  8839
accuracy train: 0.999338 val: 0.734328 test: 0.717289
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({2: 4607, 1: 1456, 0: 1337})

Epoch :  57 loss training:  10.98831345140934 Time :  8863
accuracy train: 0.999669 val: 0.740299 test: 0.718526
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({0: 4623, 2: 1451, 1: 1326})

Epoch :  58 loss training:  10.936809771694243 Time :  8887
accuracy train: 1.000000 val: 0.728358 test: 0.717784
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({0: 4633, 1: 1443, 2: 1324})

Epoch :  59 loss training:  10.099099215120077 Time :  8914
accuracy train: 0.999669 val: 0.731343 test: 0.721494
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({0: 4629, 2: 1443, 1: 1328})

Epoch :  60 loss training:  9.359429031610489 Time :  8937
accuracy train: 1.000000 val: 0.728358 test: 0.718773
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({2: 4626, 0: 1444, 1: 1330})

Epoch :  61 loss training:  8.251049663871527 Time :  8959
accuracy train: 1.000000 val: 0.728358 test: 0.719021
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({2: 4630, 0: 1439, 1: 1331})

Epoch :  62 loss training:  8.851029047742486 Time :  8982
accuracy train: 1.000000 val: 0.737313 test: 0.716794
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({2: 4627, 1: 1439, 0: 1334})

Epoch :  63 loss training:  9.046023566275835 Time :  9009
accuracy train: 1.000000 val: 0.734328 test: 0.715805
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({2: 4635, 1: 1433, 0: 1332})

Epoch :  64 loss training:  8.023629100993276 Time :  9031
accuracy train: 1.000000 val: 0.740299 test: 0.719515
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({0: 4643, 1: 1427, 2: 1330})

Epoch :  65 loss training:  8.035149516537786 Time :  9054
accuracy train: 1.000000 val: 0.740299 test: 0.716794
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({0: 4649, 1: 1422, 2: 1329})

Epoch :  66 loss training:  7.07520957570523 Time :  9077
accuracy train: 1.000000 val: 0.743284 test: 0.716052
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({1: 4646, 2: 1424, 0: 1330})

Epoch :  67 loss training:  7.392115016467869 Time :  9100
accuracy train: 0.999669 val: 0.734328 test: 0.719515
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({0: 4638, 1: 1421, 2: 1341})

Epoch :  68 loss training:  7.190801068209112 Time :  9134
accuracy train: 1.000000 val: 0.737313 test: 0.716547
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({2: 4635, 1: 1417, 0: 1348})

Epoch :  69 loss training:  6.567693856544793 Time :  9157
accuracy train: 1.000000 val: 0.728358 test: 0.720752
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({2: 4652, 1: 1411, 0: 1337})

Epoch :  70 loss training:  7.263721687719226 Time :  9181
accuracy train: 1.000000 val: 0.740299 test: 0.720257
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({0: 4658, 2: 1408, 1: 1334})

Epoch :  71 loss training:  6.539343839045614 Time :  9203
accuracy train: 1.000000 val: 0.737313 test: 0.715310
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({0: 4647, 2: 1402, 1: 1351})

Epoch :  72 loss training:  6.073999527841806 Time :  9228
accuracy train: 1.000000 val: 0.746269 test: 0.719021
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({0: 4657, 1: 1404, 2: 1339})

Epoch :  73 loss training:  5.957829691935331 Time :  9255
accuracy train: 0.999669 val: 0.743284 test: 0.721494
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({0: 4662, 2: 1397, 1: 1341})

Epoch :  74 loss training:  6.631364069879055 Time :  9279
accuracy train: 1.000000 val: 0.743284 test: 0.722731
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({2: 4661, 0: 1401, 1: 1338})

Epoch :  75 loss training:  6.696020512841642 Time :  9302
accuracy train: 1.000000 val: 0.740299 test: 0.720999
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({2: 4669, 0: 1400, 1: 1331})

Epoch :  76 loss training:  5.0202276930212975 Time :  9326
accuracy train: 1.000000 val: 0.728358 test: 0.722236
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({0: 4668, 1: 1400, 2: 1332})

Epoch :  77 loss training:  5.77375115826726 Time :  9355
accuracy train: 1.000000 val: 0.731343 test: 0.716300
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({0: 4666, 2: 1402, 1: 1332})

Epoch :  78 loss training:  5.577138720545918 Time :  9379
accuracy train: 1.000000 val: 0.746269 test: 0.716052
max validation accuracy : 0.752239 max acc epoch : 47 test accuracy : 0.718279
Counter({2: 4670, 1: 1404, 0: 1326})

========================================================================================================================================================================================================
max acc epoch :  47
max validation accuracy :  0.7522388059701492
test accuracy :  0.7182785060598565
last test_accuracy :  0.7160524363096711
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=540, weight_decay=0)
device :  cuda:0
Counter({1: 2590, 2: 2551, 0: 2259})

Epoch :  1 loss training:  212.57807457447052 Time :  9408
accuracy train: 0.655526 val: 0.614925 test: 0.622805
max validation accuracy : 0.614925 max acc epoch : 1 test accuracy : 0.622805
Counter({2: 3827, 0: 1789, 1: 1784})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  142.2089552283287 Time :  9431
accuracy train: 0.718398 val: 0.662687 test: 0.655454
max validation accuracy : 0.662687 max acc epoch : 2 test accuracy : 0.655454
Counter({1: 3532, 2: 2270, 0: 1598})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  120.90374591946602 Time :  9454
accuracy train: 0.747849 val: 0.650746 test: 0.658669
max validation accuracy : 0.662687 max acc epoch : 2 test accuracy : 0.655454
Counter({1: 3101, 2: 2600, 0: 1699})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.99203139543533 Time :  9489
accuracy train: 0.793183 val: 0.683582 test: 0.698491
max validation accuracy : 0.683582 max acc epoch : 4 test accuracy : 0.698491
Counter({1: 3122, 2: 2633, 0: 1645})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  91.45782122015953 Time :  9514
accuracy train: 0.816016 val: 0.683582 test: 0.697997
max validation accuracy : 0.683582 max acc epoch : 4 test accuracy : 0.698491
Counter({0: 3126, 1: 2626, 2: 1648})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  83.03128531575203 Time :  9537
accuracy train: 0.831238 val: 0.707463 test: 0.701954
max validation accuracy : 0.707463 max acc epoch : 6 test accuracy : 0.701954
Counter({0: 2889, 1: 2852, 2: 1659})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  72.40837755799294 Time :  9561
accuracy train: 0.857710 val: 0.695522 test: 0.704922
max validation accuracy : 0.707463 max acc epoch : 6 test accuracy : 0.701954
Counter({0: 3122, 1: 2609, 2: 1669})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  70.14083549380302 Time :  9588
accuracy train: 0.863997 val: 0.716418 test: 0.708632
max validation accuracy : 0.716418 max acc epoch : 8 test accuracy : 0.708632
Counter({0: 3083, 1: 2677, 2: 1640})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.83245562016964 Time :  9611
accuracy train: 0.878226 val: 0.713433 test: 0.710858
max validation accuracy : 0.716418 max acc epoch : 8 test accuracy : 0.708632
Counter({0: 3076, 1: 2697, 2: 1627})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.58288802206516 Time :  9634
accuracy train: 0.887492 val: 0.704478 test: 0.712837
max validation accuracy : 0.716418 max acc epoch : 8 test accuracy : 0.708632
Counter({2: 3098, 1: 2685, 0: 1617})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.88252218067646 Time :  9656
accuracy train: 0.906684 val: 0.713433 test: 0.715805
max validation accuracy : 0.716418 max acc epoch : 8 test accuracy : 0.708632
Counter({0: 3104, 2: 2694, 1: 1602})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  55.353805378079414 Time :  9679
accuracy train: 0.907346 val: 0.722388 test: 0.713826
max validation accuracy : 0.722388 max acc epoch : 12 test accuracy : 0.713826
Counter({1: 3087, 0: 2713, 2: 1600})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  51.373537585139275 Time :  9707
accuracy train: 0.913964 val: 0.728358 test: 0.715310
max validation accuracy : 0.728358 max acc epoch : 13 test accuracy : 0.715310
Counter({1: 3087, 0: 2717, 2: 1596})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  50.20755062997341 Time :  9730
accuracy train: 0.916942 val: 0.722388 test: 0.716794
max validation accuracy : 0.728358 max acc epoch : 13 test accuracy : 0.715310
Counter({2: 3075, 1: 2734, 0: 1591})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  49.27363793551922 Time :  9753
accuracy train: 0.924222 val: 0.716418 test: 0.715063
max validation accuracy : 0.728358 max acc epoch : 13 test accuracy : 0.715310
Counter({1: 3075, 2: 2736, 0: 1589})

Epoch :  16 loss training:  47.26510602235794 Time :  9777
accuracy train: 0.932164 val: 0.716418 test: 0.714568
max validation accuracy : 0.728358 max acc epoch : 13 test accuracy : 0.715310
Counter({0: 3070, 2: 2749, 1: 1581})

Epoch :  17 loss training:  45.99708512425423 Time :  9801
accuracy train: 0.935142 val: 0.725373 test: 0.715063
max validation accuracy : 0.728358 max acc epoch : 13 test accuracy : 0.715310
Counter({1: 3067, 2: 2756, 0: 1577})

Epoch :  18 loss training:  45.32079714536667 Time :  9835
accuracy train: 0.935473 val: 0.722388 test: 0.719515
max validation accuracy : 0.728358 max acc epoch : 13 test accuracy : 0.715310
Counter({1: 3067, 2: 2760, 0: 1573})

Epoch :  19 loss training:  43.50307038426399 Time :  9859
accuracy train: 0.942422 val: 0.710448 test: 0.714816
max validation accuracy : 0.728358 max acc epoch : 13 test accuracy : 0.715310
Counter({0: 3070, 2: 2757, 1: 1573})

Epoch :  20 loss training:  41.83809029310942 Time :  9882
accuracy train: 0.947055 val: 0.737313 test: 0.716300
max validation accuracy : 0.737313 max acc epoch : 20 test accuracy : 0.716300
Counter({2: 3079, 0: 2750, 1: 1571})

Epoch :  21 loss training:  38.9309104681015 Time :  9905
accuracy train: 0.948379 val: 0.740299 test: 0.716300
max validation accuracy : 0.740299 max acc epoch : 21 test accuracy : 0.716300
Counter({0: 3084, 2: 2746, 1: 1570})

Epoch :  22 loss training:  38.44566126167774 Time :  9932
accuracy train: 0.951026 val: 0.725373 test: 0.718526
max validation accuracy : 0.740299 max acc epoch : 21 test accuracy : 0.716300
Counter({1: 3085, 0: 2751, 2: 1564})

Epoch :  23 loss training:  37.33336292952299 Time :  9959
accuracy train: 0.955989 val: 0.713433 test: 0.716794
max validation accuracy : 0.740299 max acc epoch : 21 test accuracy : 0.716300
Counter({1: 3089, 0: 2748, 2: 1563})

Epoch :  24 loss training:  36.396815441548824 Time :  9983
accuracy train: 0.959960 val: 0.725373 test: 0.716052
max validation accuracy : 0.740299 max acc epoch : 21 test accuracy : 0.716300
Counter({1: 3092, 0: 2749, 2: 1559})

Epoch :  25 loss training:  35.56940069049597 Time :  10007
accuracy train: 0.958968 val: 0.719403 test: 0.717289
max validation accuracy : 0.740299 max acc epoch : 21 test accuracy : 0.716300
Counter({2: 3082, 0: 2761, 1: 1557})

Epoch :  26 loss training:  34.36295524984598 Time :  10030
accuracy train: 0.967240 val: 0.728358 test: 0.714568
max validation accuracy : 0.740299 max acc epoch : 21 test accuracy : 0.716300
Counter({0: 3069, 2: 2776, 1: 1555})

Epoch :  27 loss training:  33.87372736260295 Time :  10059
accuracy train: 0.968233 val: 0.737313 test: 0.716300
max validation accuracy : 0.740299 max acc epoch : 21 test accuracy : 0.716300
Counter({1: 3065, 0: 2785, 2: 1550})

Epoch :  28 loss training:  32.54330323636532 Time :  10083
accuracy train: 0.969887 val: 0.731343 test: 0.719763
max validation accuracy : 0.740299 max acc epoch : 21 test accuracy : 0.716300
Counter({2: 3055, 0: 2799, 1: 1546})

Epoch :  29 loss training:  31.041425570845604 Time :  10106
accuracy train: 0.975513 val: 0.725373 test: 0.719268
max validation accuracy : 0.740299 max acc epoch : 21 test accuracy : 0.716300
Counter({2: 3052, 0: 2801, 1: 1547})

Epoch :  30 loss training:  28.09264139831066 Time :  10130
accuracy train: 0.974189 val: 0.728358 test: 0.716300
max validation accuracy : 0.740299 max acc epoch : 21 test accuracy : 0.716300
Counter({0: 3057, 1: 2801, 2: 1542})

Epoch :  31 loss training:  27.770421147346497 Time :  10154
accuracy train: 0.977498 val: 0.728358 test: 0.715310
max validation accuracy : 0.740299 max acc epoch : 21 test accuracy : 0.716300
Counter({2: 3061, 0: 2805, 1: 1534})

Epoch :  32 loss training:  27.833446867763996 Time :  10187
accuracy train: 0.981138 val: 0.719403 test: 0.716052
max validation accuracy : 0.740299 max acc epoch : 21 test accuracy : 0.716300
Counter({0: 3044, 1: 2826, 2: 1530})

Epoch :  33 loss training:  27.076349925249815 Time :  10211
accuracy train: 0.979815 val: 0.731343 test: 0.719515
max validation accuracy : 0.740299 max acc epoch : 21 test accuracy : 0.716300
Counter({0: 3039, 2: 2836, 1: 1525})

Epoch :  34 loss training:  25.676024809479713 Time :  10233
accuracy train: 0.980477 val: 0.734328 test: 0.718773
max validation accuracy : 0.740299 max acc epoch : 21 test accuracy : 0.716300
Counter({1: 3030, 2: 2842, 0: 1528})

Epoch :  35 loss training:  24.43620790913701 Time :  10258
accuracy train: 0.983786 val: 0.722388 test: 0.712095
max validation accuracy : 0.740299 max acc epoch : 21 test accuracy : 0.716300
Counter({2: 3034, 0: 2838, 1: 1528})

Epoch :  36 loss training:  23.538759503513575 Time :  10285
accuracy train: 0.986102 val: 0.719403 test: 0.715063
max validation accuracy : 0.740299 max acc epoch : 21 test accuracy : 0.716300
Counter({0: 3036, 2: 2839, 1: 1525})

Epoch :  37 loss training:  23.42768056690693 Time :  10308
accuracy train: 0.985440 val: 0.707463 test: 0.715063
max validation accuracy : 0.740299 max acc epoch : 21 test accuracy : 0.716300
Counter({1: 3030, 0: 2851, 2: 1519})

Epoch :  38 loss training:  22.357127368450165 Time :  10331
accuracy train: 0.986102 val: 0.722388 test: 0.717289
max validation accuracy : 0.740299 max acc epoch : 21 test accuracy : 0.716300
Counter({1: 3016, 0: 2869, 2: 1515})

Epoch :  39 loss training:  21.727397944778204 Time :  10354
accuracy train: 0.988087 val: 0.740299 test: 0.716052
max validation accuracy : 0.740299 max acc epoch : 21 test accuracy : 0.716300
Counter({0: 3022, 2: 2868, 1: 1510})

Epoch :  40 loss training:  21.084996912628412 Time :  10377
accuracy train: 0.991727 val: 0.734328 test: 0.715310
max validation accuracy : 0.740299 max acc epoch : 21 test accuracy : 0.716300
Counter({0: 3024, 2: 2870, 1: 1506})

Epoch :  41 loss training:  18.90424970909953 Time :  10403
accuracy train: 0.992389 val: 0.734328 test: 0.717536
max validation accuracy : 0.740299 max acc epoch : 21 test accuracy : 0.716300
Counter({0: 3027, 2: 2869, 1: 1504})

Epoch :  42 loss training:  19.044483106583357 Time :  10425
accuracy train: 0.991727 val: 0.740299 test: 0.718279
max validation accuracy : 0.740299 max acc epoch : 21 test accuracy : 0.716300
Counter({1: 3038, 2: 2864, 0: 1498})

Epoch :  43 loss training:  18.467395294457674 Time :  10447
accuracy train: 0.993382 val: 0.752239 test: 0.717536
max validation accuracy : 0.752239 max acc epoch : 43 test accuracy : 0.717536
Counter({2: 3028, 0: 2873, 1: 1499})

Epoch :  44 loss training:  17.35393571294844 Time :  10469
accuracy train: 0.991396 val: 0.740299 test: 0.715063
max validation accuracy : 0.752239 max acc epoch : 43 test accuracy : 0.717536
Counter({2: 3025, 1: 2875, 0: 1500})

Epoch :  45 loss training:  17.921881571412086 Time :  10492
accuracy train: 0.993713 val: 0.746269 test: 0.712342
max validation accuracy : 0.752239 max acc epoch : 43 test accuracy : 0.717536
Counter({0: 2998, 2: 2896, 1: 1506})

Epoch :  46 loss training:  17.27275699749589 Time :  10520
accuracy train: 0.995367 val: 0.755224 test: 0.716052
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({2: 3004, 1: 2890, 0: 1506})

Epoch :  47 loss training:  15.556989489123225 Time :  10543
accuracy train: 0.995698 val: 0.737313 test: 0.715805
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({1: 3003, 0: 2888, 2: 1509})

Epoch :  48 loss training:  15.083721447736025 Time :  10565
accuracy train: 0.996691 val: 0.740299 test: 0.718526
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({2: 2998, 0: 2894, 1: 1508})

Epoch :  49 loss training:  13.842044712975621 Time :  10587
accuracy train: 0.997353 val: 0.731343 test: 0.718773
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({1: 3005, 0: 2889, 2: 1506})

Epoch :  50 loss training:  12.945149425417185 Time :  10611
accuracy train: 0.996691 val: 0.722388 test: 0.715310
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({0: 2997, 2: 2898, 1: 1505})

Epoch :  51 loss training:  13.4766716491431 Time :  10646
accuracy train: 0.997022 val: 0.746269 test: 0.716547
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({1: 2993, 0: 2903, 2: 1504})

Epoch :  52 loss training:  12.958864595741034 Time :  10669
accuracy train: 0.998345 val: 0.731343 test: 0.715558
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({0: 2995, 2: 2904, 1: 1501})

Epoch :  53 loss training:  13.465883979573846 Time :  10692
accuracy train: 0.998015 val: 0.743284 test: 0.719021
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({1: 3002, 2: 2899, 0: 1499})

Epoch :  54 loss training:  12.02656496502459 Time :  10715
accuracy train: 0.998676 val: 0.737313 test: 0.713826
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({1: 3010, 0: 2894, 2: 1496})

Epoch :  55 loss training:  11.878280088305473 Time :  10741
accuracy train: 0.998345 val: 0.734328 test: 0.716547
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({0: 2999, 1: 2908, 2: 1493})

Epoch :  56 loss training:  12.42732460424304 Time :  10765
accuracy train: 0.999669 val: 0.731343 test: 0.720010
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({2: 2992, 1: 2919, 0: 1489})

Epoch :  57 loss training:  10.654835313558578 Time :  10790
accuracy train: 0.999338 val: 0.731343 test: 0.712342
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({1: 3002, 0: 2909, 2: 1489})

Epoch :  58 loss training:  11.409768506884575 Time :  10813
accuracy train: 1.000000 val: 0.734328 test: 0.715805
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({2: 3019, 1: 2894, 0: 1487})

Epoch :  59 loss training:  10.071223344653845 Time :  10837
accuracy train: 1.000000 val: 0.740299 test: 0.719268
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({1: 3018, 2: 2898, 0: 1484})

Epoch :  60 loss training:  10.068273122422397 Time :  10864
accuracy train: 1.000000 val: 0.734328 test: 0.716300
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({1: 3015, 2: 2910, 0: 1475})

Epoch :  61 loss training:  9.405204007402062 Time :  10887
accuracy train: 1.000000 val: 0.725373 test: 0.716300
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({0: 3012, 2: 2915, 1: 1473})

Epoch :  62 loss training:  9.227744775824249 Time :  10909
accuracy train: 0.999669 val: 0.710448 test: 0.716547
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({0: 2999, 2: 2927, 1: 1474})

Epoch :  63 loss training:  9.191517315339297 Time :  10933
accuracy train: 1.000000 val: 0.734328 test: 0.716794
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({1: 2995, 2: 2934, 0: 1471})

Epoch :  64 loss training:  7.596736994571984 Time :  10956
accuracy train: 1.000000 val: 0.734328 test: 0.715805
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({2: 2992, 0: 2939, 1: 1469})

Epoch :  65 loss training:  8.234328025020659 Time :  10991
accuracy train: 1.000000 val: 0.737313 test: 0.717784
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({0: 2979, 1: 2951, 2: 1470})

Epoch :  66 loss training:  7.620857510715723 Time :  11014
accuracy train: 1.000000 val: 0.740299 test: 0.716794
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({1: 2989, 0: 2947, 2: 1464})

Epoch :  67 loss training:  6.451102036982775 Time :  11037
accuracy train: 1.000000 val: 0.725373 test: 0.713579
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({2: 2972, 0: 2965, 1: 1463})

Epoch :  68 loss training:  7.694412521086633 Time :  11060
accuracy train: 1.000000 val: 0.746269 test: 0.714816
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({2: 2969, 1: 2968, 0: 1463})

Epoch :  69 loss training:  6.774282343219966 Time :  11086
accuracy train: 1.000000 val: 0.728358 test: 0.716794
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({1: 2983, 0: 2958, 2: 1459})

Epoch :  70 loss training:  6.652146373875439 Time :  11111
accuracy train: 1.000000 val: 0.734328 test: 0.718279
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({2: 2974, 1: 2971, 0: 1455})

Epoch :  71 loss training:  5.813326813280582 Time :  11134
accuracy train: 1.000000 val: 0.734328 test: 0.717042
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({0: 2974, 1: 2972, 2: 1454})

Epoch :  72 loss training:  6.084921058267355 Time :  11157
accuracy train: 1.000000 val: 0.728358 test: 0.715558
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({2: 2976, 1: 2968, 0: 1456})

Epoch :  73 loss training:  5.78857084363699 Time :  11180
accuracy train: 1.000000 val: 0.743284 test: 0.717784
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({0: 2976, 1: 2965, 2: 1459})

Epoch :  74 loss training:  5.513937073759735 Time :  11207
accuracy train: 1.000000 val: 0.737313 test: 0.715310
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({0: 2992, 1: 2956, 2: 1452})

Epoch :  75 loss training:  6.1783235892653465 Time :  11230
accuracy train: 1.000000 val: 0.716418 test: 0.712837
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({2: 2987, 1: 2963, 0: 1450})

Epoch :  76 loss training:  5.307581543456763 Time :  11253
accuracy train: 1.000000 val: 0.713433 test: 0.718279
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({2: 2984, 0: 2966, 1: 1450})

Epoch :  77 loss training:  4.506938017439097 Time :  11276
accuracy train: 1.000000 val: 0.740299 test: 0.716794
max validation accuracy : 0.755224 max acc epoch : 46 test accuracy : 0.716052
Counter({0: 2985, 2: 2966, 1: 1449})

========================================================================================================================================================================================================
max acc epoch :  46
max validation accuracy :  0.755223880597015
test accuracy :  0.7160524363096711
last test_accuracy :  0.7167944595597329
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.75522 	 test_accuracy : 0.71531 	 max_acc epoch :  46 	 last test_accuracy : 0.71754
k :  1 	 val_accuracy : 0.74030 	 test_accuracy : 0.72100 	 max_acc epoch :  27 	 last test_accuracy : 0.71605
k :  2 	 val_accuracy : 0.74925 	 test_accuracy : 0.71976 	 max_acc epoch :  41 	 last test_accuracy : 0.71333
k :  3 	 val_accuracy : 0.75224 	 test_accuracy : 0.71828 	 max_acc epoch :  47 	 last test_accuracy : 0.71605
k :  4 	 val_accuracy : 0.75522 	 test_accuracy : 0.71605 	 max_acc epoch :  46 	 last test_accuracy : 0.71679

avg :  	 val_accuracy : 0.75045 	 test_accuracy : 0.71808 	 last_accuracy : 0.71595
