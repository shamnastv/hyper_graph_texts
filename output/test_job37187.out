

date and time :  Fri Jun 11 14:22:25 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=492, weight_decay=1e-10)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  37.99450136721134 Time :  119
accuracy train: 0.930923 val: 0.914545 test: 0.950228
max validation accuracy : 0.914545 max acc epoch : 1 test accuracy : 0.950228
Counter({0: 4107, 1: 3584})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.129746017744765 Time :  170
accuracy train: 0.970511 val: 0.961818 test: 0.955708
max validation accuracy : 0.961818 max acc epoch : 2 test accuracy : 0.955708
Counter({0: 3907, 1: 3784})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  17.350355310365558 Time :  220
accuracy train: 0.953747 val: 0.947273 test: 0.949772
max validation accuracy : 0.961818 max acc epoch : 2 test accuracy : 0.955708
Counter({0: 3885, 1: 3806})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.501807936001569 Time :  272
accuracy train: 0.980610 val: 0.963636 test: 0.968037
max validation accuracy : 0.963636 max acc epoch : 4 test accuracy : 0.968037
Counter({0: 3919, 1: 3772})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.597535560606048 Time :  318
accuracy train: 0.985054 val: 0.967273 test: 0.971233
max validation accuracy : 0.967273 max acc epoch : 5 test accuracy : 0.971233
Counter({0: 3877, 1: 3814})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  7.166884414618835 Time :  366
accuracy train: 0.982630 val: 0.970909 test: 0.975342
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.975342
Counter({0: 3860, 1: 3831})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.97865884937346 Time :  411
accuracy train: 0.988689 val: 0.970909 test: 0.970320
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.975342
Counter({1: 3855, 0: 3836})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.61437317635864 Time :  459
accuracy train: 0.989295 val: 0.970909 test: 0.968493
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.975342
Counter({1: 3854, 0: 3837})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.120545455138199 Time :  501
accuracy train: 0.989699 val: 0.972727 test: 0.973059
max validation accuracy : 0.972727 max acc epoch : 9 test accuracy : 0.973059
Counter({0: 3847, 1: 3844})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.415269641438499 Time :  552
accuracy train: 0.992931 val: 0.976364 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.972603
Counter({1: 3854, 0: 3837})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.122911044512875 Time :  601
accuracy train: 0.992527 val: 0.969091 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.972603
Counter({1: 3866, 0: 3825})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.57066756056156 Time :  660
accuracy train: 0.992527 val: 0.972727 test: 0.973516
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.972603
Counter({1: 3867, 0: 3824})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  3.777085652516689 Time :  701
accuracy train: 0.994143 val: 0.976364 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.972603
Counter({1: 3872, 0: 3819})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.2799275037396 Time :  741
accuracy train: 0.994345 val: 0.976364 test: 0.968950
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.972603
Counter({1: 3877, 0: 3814})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  4.142484359326772 Time :  780
accuracy train: 0.994749 val: 0.978182 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3880, 1: 3811})
Epoch-15 lr: 3.125e-05

Epoch :  16 loss training:  3.5731532461359166 Time :  817
accuracy train: 0.994547 val: 0.970909 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3881, 1: 3810})
Epoch-16 lr: 3.125e-05

Epoch :  17 loss training:  3.6338903945870697 Time :  858
accuracy train: 0.993739 val: 0.974545 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3883, 0: 3808})
Epoch-17 lr: 3.125e-05

Epoch :  18 loss training:  3.6380022988596465 Time :  923
accuracy train: 0.995556 val: 0.980000 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({1: 3883, 0: 3808})
Epoch-18 lr: 1.5625e-05

Epoch :  19 loss training:  3.302240413846448 Time :  961
accuracy train: 0.994749 val: 0.974545 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({0: 3883, 1: 3808})
Epoch-19 lr: 1.5625e-05

Epoch :  20 loss training:  3.6769259544671513 Time :  994
accuracy train: 0.995152 val: 0.976364 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({1: 3883, 0: 3808})
Epoch-20 lr: 1.5625e-05

Epoch :  21 loss training:  3.5834473286522552 Time :  1036
accuracy train: 0.995152 val: 0.976364 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({1: 3882, 0: 3809})

Epoch :  22 loss training:  3.428074855124578 Time :  1069
accuracy train: 0.995758 val: 0.978182 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({0: 3884, 1: 3807})

Epoch :  23 loss training:  3.0176846511894837 Time :  1109
accuracy train: 0.995152 val: 0.970909 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({1: 3884, 0: 3807})

Epoch :  24 loss training:  3.592362377909012 Time :  1164
accuracy train: 0.995758 val: 0.978182 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({0: 3884, 1: 3807})

Epoch :  25 loss training:  3.9223909128340892 Time :  1202
accuracy train: 0.996162 val: 0.976364 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({0: 3884, 1: 3807})

Epoch :  26 loss training:  3.417776039423188 Time :  1240
accuracy train: 0.995152 val: 0.972727 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({1: 3884, 0: 3807})

Epoch :  27 loss training:  3.6777568658581004 Time :  1276
accuracy train: 0.995758 val: 0.974545 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({1: 3887, 0: 3804})

Epoch :  28 loss training:  3.3365864058141597 Time :  1319
accuracy train: 0.995556 val: 0.974545 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({1: 3887, 0: 3804})

Epoch :  29 loss training:  2.9121616325573996 Time :  1364
accuracy train: 0.995556 val: 0.970909 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({0: 3887, 1: 3804})

Epoch :  30 loss training:  3.204746169678401 Time :  1415
accuracy train: 0.995758 val: 0.978182 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({1: 3889, 0: 3802})

Epoch :  31 loss training:  3.1378463227883913 Time :  1453
accuracy train: 0.995960 val: 0.976364 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({0: 3889, 1: 3802})

Epoch :  32 loss training:  3.083415793022141 Time :  1488
accuracy train: 0.995556 val: 0.974545 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({1: 3890, 0: 3801})

Epoch :  33 loss training:  3.0035696441773325 Time :  1525
accuracy train: 0.995960 val: 0.978182 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({0: 3891, 1: 3800})

Epoch :  34 loss training:  3.161403627425898 Time :  1560
accuracy train: 0.995960 val: 0.976364 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({1: 3892, 0: 3799})

Epoch :  35 loss training:  2.987620108644478 Time :  1618
accuracy train: 0.995960 val: 0.976364 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({1: 3891, 0: 3800})

Epoch :  36 loss training:  3.011997973022517 Time :  1668
accuracy train: 0.995758 val: 0.978182 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({1: 3896, 0: 3795})

Epoch :  37 loss training:  2.959423581487499 Time :  1707
accuracy train: 0.995960 val: 0.976364 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({1: 3896, 0: 3795})

Epoch :  38 loss training:  2.733391451067291 Time :  1744
accuracy train: 0.995758 val: 0.974545 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({1: 3896, 0: 3795})

Epoch :  39 loss training:  2.7608951663714834 Time :  1778
accuracy train: 0.995758 val: 0.974545 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({1: 3897, 0: 3794})

Epoch :  40 loss training:  2.5552223220001906 Time :  1817
accuracy train: 0.995960 val: 0.974545 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({1: 3898, 0: 3793})

Epoch :  41 loss training:  2.99931915133493 Time :  1876
accuracy train: 0.995960 val: 0.974545 test: 0.974886
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({1: 3898, 0: 3793})

Epoch :  42 loss training:  2.6561923267436214 Time :  1916
accuracy train: 0.995354 val: 0.974545 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({1: 3898, 0: 3793})

Epoch :  43 loss training:  2.693734828804736 Time :  1953
accuracy train: 0.996162 val: 0.978182 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({0: 3898, 1: 3793})

Epoch :  44 loss training:  2.97865169798024 Time :  1992
accuracy train: 0.995960 val: 0.978182 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({0: 3898, 1: 3793})

Epoch :  45 loss training:  2.727871956070885 Time :  2029
accuracy train: 0.996162 val: 0.978182 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({1: 3899, 0: 3792})

Epoch :  46 loss training:  2.6480719672399573 Time :  2067
accuracy train: 0.995960 val: 0.972727 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({1: 3898, 0: 3793})

Epoch :  47 loss training:  2.7602345573541243 Time :  2123
accuracy train: 0.996162 val: 0.978182 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({1: 3900, 0: 3791})

Epoch :  48 loss training:  2.953088575974107 Time :  2160
accuracy train: 0.995960 val: 0.974545 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({0: 3900, 1: 3791})

Epoch :  49 loss training:  2.81126809399575 Time :  2200
accuracy train: 0.995960 val: 0.974545 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 18 test accuracy : 0.972146
Counter({1: 3900, 0: 3791})

========================================================================================================================================================================================================
best acc epoch :  18
validation accuracy :  0.98
test accuracy :  0.9721461187214612
last test_accuracy :  0.9735159817351599
second best val :  0.9781818181818182
second best test :  0.9698630136986301
max gap 5
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=492, weight_decay=1e-10)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  38.005181377753615 Time :  2289
accuracy train: 0.931327 val: 0.912727 test: 0.952055
max validation accuracy : 0.912727 max acc epoch : 1 test accuracy : 0.952055
Counter({0: 4107, 1: 3584})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.086009320570156 Time :  2341
accuracy train: 0.969703 val: 0.952727 test: 0.955251
max validation accuracy : 0.952727 max acc epoch : 2 test accuracy : 0.955251
Counter({0: 3903, 1: 3788})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.444716861005872 Time :  2377
accuracy train: 0.957180 val: 0.941818 test: 0.952511
max validation accuracy : 0.952727 max acc epoch : 2 test accuracy : 0.955251
Counter({0: 3880, 1: 3811})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.672280789818615 Time :  2413
accuracy train: 0.979802 val: 0.960000 test: 0.969863
max validation accuracy : 0.960000 max acc epoch : 4 test accuracy : 0.969863
Counter({0: 3908, 1: 3783})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.310949323698878 Time :  2449
accuracy train: 0.984044 val: 0.963636 test: 0.968950
max validation accuracy : 0.963636 max acc epoch : 5 test accuracy : 0.968950
Counter({1: 3882, 0: 3809})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  7.3456128728576005 Time :  2484
accuracy train: 0.983236 val: 0.963636 test: 0.976712
max validation accuracy : 0.963636 max acc epoch : 5 test accuracy : 0.968950
Counter({0: 3863, 1: 3828})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.563196713803336 Time :  2519
accuracy train: 0.988083 val: 0.969091 test: 0.970320
max validation accuracy : 0.969091 max acc epoch : 7 test accuracy : 0.970320
Counter({0: 3855, 1: 3836})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.466202812502161 Time :  2571
accuracy train: 0.988487 val: 0.970909 test: 0.968950
max validation accuracy : 0.970909 max acc epoch : 8 test accuracy : 0.968950
Counter({0: 3854, 1: 3837})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.893175579840317 Time :  2603
accuracy train: 0.990103 val: 0.970909 test: 0.970320
max validation accuracy : 0.970909 max acc epoch : 8 test accuracy : 0.968950
Counter({1: 3853, 0: 3838})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.469266829197295 Time :  2640
accuracy train: 0.992931 val: 0.976364 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({1: 3868, 0: 3823})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.038025590532925 Time :  2679
accuracy train: 0.993133 val: 0.972727 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({1: 3875, 0: 3816})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.320390834705904 Time :  2714
accuracy train: 0.992729 val: 0.969091 test: 0.974429
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({0: 3875, 1: 3816})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  3.5656375708058476 Time :  2752
accuracy train: 0.994547 val: 0.974545 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({0: 3882, 1: 3809})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.020737053855555 Time :  2802
accuracy train: 0.995152 val: 0.974545 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({1: 3882, 0: 3809})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  3.8869460076093674 Time :  2839
accuracy train: 0.995152 val: 0.974545 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({1: 3886, 0: 3805})
Epoch-15 lr: 3.125e-05

Epoch :  16 loss training:  3.310666834935546 Time :  2875
accuracy train: 0.994951 val: 0.972727 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({0: 3889, 1: 3802})
Epoch-16 lr: 3.125e-05

Epoch :  17 loss training:  3.3413084328640252 Time :  2911
accuracy train: 0.994749 val: 0.970909 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({1: 3890, 0: 3801})
Epoch-17 lr: 3.125e-05

Epoch :  18 loss training:  3.4942635487532243 Time :  2948
accuracy train: 0.995354 val: 0.976364 test: 0.974429
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({1: 3892, 0: 3799})
Epoch-18 lr: 1.5625e-05

Epoch :  19 loss training:  3.0178298472310416 Time :  2995
accuracy train: 0.995152 val: 0.970909 test: 0.973973
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({1: 3892, 0: 3799})
Epoch-19 lr: 1.5625e-05

Epoch :  20 loss training:  3.340382546070032 Time :  3034
accuracy train: 0.995556 val: 0.974545 test: 0.973973
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({0: 3892, 1: 3799})
Epoch-20 lr: 1.5625e-05

Epoch :  21 loss training:  3.3386846376233734 Time :  3069
accuracy train: 0.995758 val: 0.970909 test: 0.973516
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({1: 3892, 0: 3799})

Epoch :  22 loss training:  3.413691524299793 Time :  3104
accuracy train: 0.995758 val: 0.976364 test: 0.973516
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({0: 3893, 1: 3798})

Epoch :  23 loss training:  2.848167307151016 Time :  3136
accuracy train: 0.995556 val: 0.970909 test: 0.973516
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({0: 3893, 1: 3798})

Epoch :  24 loss training:  3.349570859631058 Time :  3173
accuracy train: 0.995354 val: 0.976364 test: 0.974886
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({0: 3893, 1: 3798})

Epoch :  25 loss training:  3.433910151827149 Time :  3223
accuracy train: 0.995960 val: 0.974545 test: 0.974429
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({0: 3894, 1: 3797})

Epoch :  26 loss training:  3.1068010160233825 Time :  3262
accuracy train: 0.995556 val: 0.972727 test: 0.973973
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({0: 3894, 1: 3797})

Epoch :  27 loss training:  3.4124852540844586 Time :  3297
accuracy train: 0.996162 val: 0.972727 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({0: 3896, 1: 3795})

Epoch :  28 loss training:  3.1653139233239926 Time :  3335
accuracy train: 0.995758 val: 0.972727 test: 0.974429
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({0: 3897, 1: 3794})

Epoch :  29 loss training:  2.8535787485307083 Time :  3365
accuracy train: 0.995152 val: 0.970909 test: 0.973973
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({0: 3897, 1: 3794})

Epoch :  30 loss training:  3.0709200483979657 Time :  3402
accuracy train: 0.995556 val: 0.976364 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({1: 3897, 0: 3794})

Epoch :  31 loss training:  2.9891523703117855 Time :  3445
accuracy train: 0.995758 val: 0.974545 test: 0.973973
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({0: 3897, 1: 3794})

Epoch :  32 loss training:  3.039307844825089 Time :  3485
accuracy train: 0.995758 val: 0.972727 test: 0.974429
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({1: 3896, 0: 3795})

Epoch :  33 loss training:  2.782418612157926 Time :  3517
accuracy train: 0.995960 val: 0.976364 test: 0.974886
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({1: 3897, 0: 3794})

Epoch :  34 loss training:  2.856389312131796 Time :  3549
accuracy train: 0.996364 val: 0.976364 test: 0.974429
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({1: 3898, 0: 3793})

Epoch :  35 loss training:  2.820648689608788 Time :  3585
accuracy train: 0.996162 val: 0.974545 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({1: 3897, 0: 3794})

Epoch :  36 loss training:  2.8752989259082824 Time :  3623
accuracy train: 0.995758 val: 0.976364 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({0: 3898, 1: 3793})

Epoch :  37 loss training:  2.8408441525534727 Time :  3667
accuracy train: 0.996162 val: 0.972727 test: 0.973973
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({1: 3899, 0: 3792})

Epoch :  38 loss training:  2.6110098075005226 Time :  3705
accuracy train: 0.995758 val: 0.974545 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({0: 3899, 1: 3792})

Epoch :  39 loss training:  2.609665757161565 Time :  3741
accuracy train: 0.995758 val: 0.974545 test: 0.973516
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({1: 3899, 0: 3792})

Epoch :  40 loss training:  2.3927812739275396 Time :  3776
accuracy train: 0.995758 val: 0.974545 test: 0.974886
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({1: 3899, 0: 3792})

Epoch :  41 loss training:  2.923190394649282 Time :  3813
accuracy train: 0.996364 val: 0.974545 test: 0.974429
max validation accuracy : 0.976364 max acc epoch : 10 test accuracy : 0.971233
Counter({1: 3900, 0: 3791})

========================================================================================================================================================================================================
best acc epoch :  10
validation accuracy :  0.9763636363636363
test accuracy :  0.9712328767123287
last test_accuracy :  0.9744292237442922
second best val :  0.9745454545454545
second best test :  0.9712328767123287
max gap 2
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=492, weight_decay=1e-10)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  38.00224260054529 Time :  3920
accuracy train: 0.930317 val: 0.912727 test: 0.951598
max validation accuracy : 0.912727 max acc epoch : 1 test accuracy : 0.951598
Counter({0: 4107, 1: 3584})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.22348591638729 Time :  3960
accuracy train: 0.968895 val: 0.952727 test: 0.953881
max validation accuracy : 0.952727 max acc epoch : 2 test accuracy : 0.953881
Counter({1: 3898, 0: 3793})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.8624754762277 Time :  3999
accuracy train: 0.954757 val: 0.941818 test: 0.951598
max validation accuracy : 0.952727 max acc epoch : 2 test accuracy : 0.953881
Counter({0: 3876, 1: 3815})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.598010984715074 Time :  4037
accuracy train: 0.979802 val: 0.960000 test: 0.968950
max validation accuracy : 0.960000 max acc epoch : 4 test accuracy : 0.968950
Counter({0: 3893, 1: 3798})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.463535286253318 Time :  4079
accuracy train: 0.982630 val: 0.969091 test: 0.968950
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.968950
Counter({0: 3878, 1: 3813})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  7.519098560092971 Time :  4122
accuracy train: 0.984448 val: 0.970909 test: 0.975342
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.975342
Counter({1: 3853, 0: 3838})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.7143825080711395 Time :  4157
accuracy train: 0.989295 val: 0.970909 test: 0.971689
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.975342
Counter({1: 3846, 0: 3845})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.562460299406666 Time :  4193
accuracy train: 0.989901 val: 0.974545 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.969406
Counter({0: 3851, 1: 3840})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.040242079761811 Time :  4236
accuracy train: 0.989901 val: 0.976364 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 9 test accuracy : 0.972146
Counter({1: 3849, 0: 3842})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.450585575657897 Time :  4272
accuracy train: 0.992527 val: 0.980000 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 10 test accuracy : 0.972146
Counter({1: 3855, 0: 3836})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.283727780566551 Time :  4326
accuracy train: 0.993335 val: 0.974545 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 10 test accuracy : 0.972146
Counter({0: 3866, 1: 3825})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.630281739751808 Time :  4362
accuracy train: 0.993133 val: 0.978182 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 10 test accuracy : 0.972146
Counter({1: 3868, 0: 3823})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  3.7552779032848775 Time :  4399
accuracy train: 0.994345 val: 0.976364 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 10 test accuracy : 0.972146
Counter({1: 3871, 0: 3820})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.34003636817215 Time :  4438
accuracy train: 0.994547 val: 0.978182 test: 0.970320
max validation accuracy : 0.980000 max acc epoch : 10 test accuracy : 0.972146
Counter({1: 3877, 0: 3814})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  4.011242658831179 Time :  4477
accuracy train: 0.994547 val: 0.981818 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3880, 1: 3811})
Epoch-15 lr: 3.125e-05

Epoch :  16 loss training:  3.5514806392602623 Time :  4514
accuracy train: 0.994749 val: 0.974545 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3882, 0: 3809})
Epoch-16 lr: 3.125e-05

Epoch :  17 loss training:  3.6828447252046317 Time :  4560
accuracy train: 0.994547 val: 0.976364 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3882, 1: 3809})
Epoch-17 lr: 3.125e-05

Epoch :  18 loss training:  3.7490190961398184 Time :  4593
accuracy train: 0.995152 val: 0.981818 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3886, 0: 3805})
Epoch-18 lr: 1.5625e-05

Epoch :  19 loss training:  3.224770780769177 Time :  4628
accuracy train: 0.994547 val: 0.978182 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3887, 0: 3804})
Epoch-19 lr: 1.5625e-05

Epoch :  20 loss training:  3.5770124042755924 Time :  4663
accuracy train: 0.995354 val: 0.980000 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3888, 0: 3803})
Epoch-20 lr: 1.5625e-05

Epoch :  21 loss training:  3.5724893044680357 Time :  4699
accuracy train: 0.995152 val: 0.974545 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3887, 1: 3804})

Epoch :  22 loss training:  3.4454629712272435 Time :  4741
accuracy train: 0.995556 val: 0.980000 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3888, 0: 3803})

Epoch :  23 loss training:  3.0160317478585057 Time :  4782
accuracy train: 0.994951 val: 0.974545 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3888, 1: 3803})

Epoch :  24 loss training:  3.6573932985193096 Time :  4820
accuracy train: 0.995354 val: 0.978182 test: 0.975799
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3890, 0: 3801})

Epoch :  25 loss training:  3.889295479282737 Time :  4855
accuracy train: 0.995556 val: 0.978182 test: 0.975342
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3891, 0: 3800})

Epoch :  26 loss training:  3.2560650522937067 Time :  4889
accuracy train: 0.995152 val: 0.974545 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3891, 0: 3800})

Epoch :  27 loss training:  3.5574234272062313 Time :  4922
accuracy train: 0.995758 val: 0.976364 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3893, 1: 3798})

Epoch :  28 loss training:  3.3518450761330314 Time :  4973
accuracy train: 0.995152 val: 0.976364 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3892, 0: 3799})

Epoch :  29 loss training:  2.970708155480679 Time :  5007
accuracy train: 0.995152 val: 0.970909 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3892, 0: 3799})

Epoch :  30 loss training:  3.1481626015447546 Time :  5040
accuracy train: 0.995556 val: 0.978182 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3892, 0: 3799})

Epoch :  31 loss training:  3.109197852027137 Time :  5074
accuracy train: 0.995354 val: 0.976364 test: 0.974886
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3892, 0: 3799})

Epoch :  32 loss training:  3.053254433325492 Time :  5108
accuracy train: 0.995556 val: 0.972727 test: 0.973059
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3892, 0: 3799})

Epoch :  33 loss training:  2.9857951855519786 Time :  5142
accuracy train: 0.995758 val: 0.976364 test: 0.975342
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3892, 0: 3799})

Epoch :  34 loss training:  3.057012951001525 Time :  5187
accuracy train: 0.995758 val: 0.978182 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3892, 1: 3799})

Epoch :  35 loss training:  2.9853403173328843 Time :  5221
accuracy train: 0.995758 val: 0.976364 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3892, 0: 3799})

Epoch :  36 loss training:  3.117855038464768 Time :  5253
accuracy train: 0.995758 val: 0.978182 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3892, 1: 3799})

Epoch :  37 loss training:  2.9192098552011885 Time :  5287
accuracy train: 0.995556 val: 0.978182 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3892, 0: 3799})

Epoch :  38 loss training:  2.8192883635056205 Time :  5319
accuracy train: 0.995960 val: 0.976364 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3892, 1: 3799})

Epoch :  39 loss training:  2.7666448646923527 Time :  5353
accuracy train: 0.995556 val: 0.976364 test: 0.973516
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3892, 1: 3799})

Epoch :  40 loss training:  2.550509242748376 Time :  5394
accuracy train: 0.995960 val: 0.978182 test: 0.973973
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3893, 1: 3798})

Epoch :  41 loss training:  2.9944493484217674 Time :  5427
accuracy train: 0.995960 val: 0.976364 test: 0.974429
max validation accuracy : 0.981818 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3896, 1: 3795})

slurmstepd: error: *** JOB 37187 ON cl-gpusrv1 CANCELLED AT 2021-06-11T15:53:47 ***
