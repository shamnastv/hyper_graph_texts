

date and time :  Wed Apr 21 23:42:56 2021
Namespace(batch_size=32, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=0)
device :  cuda:0
Counter({1: 2734, 2: 2714, 0: 1952})

Epoch :  1 loss training:  437.1224263906479 Time :  32
accuracy train: 0.647915 val: 0.623881 test: 0.611180
max validation accuracy : 0.623881 max acc epoch : 1 test accuracy : 0.611180
Epoch-1 lr: 0.001

Epoch :  2 loss training:  283.3936493396759 Time :  45
accuracy train: 0.725678 val: 0.683582 test: 0.663863
max validation accuracy : 0.683582 max acc epoch : 2 test accuracy : 0.663863
Counter({1: 3963, 2: 2220, 0: 1217})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  245.01245999336243 Time :  59
accuracy train: 0.769027 val: 0.710448 test: 0.671778
max validation accuracy : 0.710448 max acc epoch : 3 test accuracy : 0.671778
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  201.71811348199844 Time :  71
accuracy train: 0.796161 val: 0.722388 test: 0.699481
max validation accuracy : 0.722388 max acc epoch : 4 test accuracy : 0.699481
Counter({1: 2879, 2: 2394, 0: 2127})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  185.86361795663834 Time :  84
accuracy train: 0.827598 val: 0.737313 test: 0.704180
max validation accuracy : 0.737313 max acc epoch : 5 test accuracy : 0.704180
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  168.0031095147133 Time :  96
accuracy train: 0.835208 val: 0.731343 test: 0.704180
max validation accuracy : 0.737313 max acc epoch : 5 test accuracy : 0.704180
Counter({2: 3070, 1: 2292, 0: 2038})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  154.4494451880455 Time :  111
accuracy train: 0.867968 val: 0.731343 test: 0.713084
max validation accuracy : 0.737313 max acc epoch : 5 test accuracy : 0.704180
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  145.2842015028 Time :  123
accuracy train: 0.875910 val: 0.749254 test: 0.711353
max validation accuracy : 0.749254 max acc epoch : 8 test accuracy : 0.711353
Counter({0: 2987, 2: 2647, 1: 1766})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  138.15913224220276 Time :  137
accuracy train: 0.880212 val: 0.755224 test: 0.710116
max validation accuracy : 0.755224 max acc epoch : 9 test accuracy : 0.710116
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  128.7143376469612 Time :  148
accuracy train: 0.889808 val: 0.758209 test: 0.716300
max validation accuracy : 0.758209 max acc epoch : 10 test accuracy : 0.716300
Counter({0: 2993, 1: 2684, 2: 1723})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  123.18084931373596 Time :  162
accuracy train: 0.903044 val: 0.767164 test: 0.720257
max validation accuracy : 0.767164 max acc epoch : 11 test accuracy : 0.720257
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  119.96431523561478 Time :  173
accuracy train: 0.904699 val: 0.752239 test: 0.713084
max validation accuracy : 0.767164 max acc epoch : 11 test accuracy : 0.720257
Counter({1: 2994, 2: 2708, 0: 1698})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  119.92389917373657 Time :  188
accuracy train: 0.908670 val: 0.755224 test: 0.716052
max validation accuracy : 0.767164 max acc epoch : 11 test accuracy : 0.720257
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  116.26682984828949 Time :  200
accuracy train: 0.908008 val: 0.752239 test: 0.716794
max validation accuracy : 0.767164 max acc epoch : 11 test accuracy : 0.720257
Counter({2: 2986, 1: 2724, 0: 1690})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  113.35157239437103 Time :  217
accuracy train: 0.912972 val: 0.752239 test: 0.717784
max validation accuracy : 0.767164 max acc epoch : 11 test accuracy : 0.720257

Epoch :  16 loss training:  114.48248320817947 Time :  227
accuracy train: 0.916612 val: 0.749254 test: 0.715310
max validation accuracy : 0.767164 max acc epoch : 11 test accuracy : 0.720257
Counter({2: 2978, 1: 2752, 0: 1670})

Epoch :  17 loss training:  106.66233837604523 Time :  242
accuracy train: 0.917935 val: 0.761194 test: 0.716300
max validation accuracy : 0.767164 max acc epoch : 11 test accuracy : 0.720257

Epoch :  18 loss training:  105.03897511959076 Time :  254
accuracy train: 0.924222 val: 0.761194 test: 0.721247
max validation accuracy : 0.767164 max acc epoch : 11 test accuracy : 0.720257
Counter({1: 2954, 2: 2787, 0: 1659})

Epoch :  19 loss training:  105.53461661934853 Time :  268
accuracy train: 0.919921 val: 0.767164 test: 0.721247
max validation accuracy : 0.767164 max acc epoch : 11 test accuracy : 0.720257

Epoch :  20 loss training:  100.15919315814972 Time :  281
accuracy train: 0.918266 val: 0.755224 test: 0.718526
max validation accuracy : 0.767164 max acc epoch : 11 test accuracy : 0.720257
Counter({2: 2935, 0: 2806, 1: 1659})

Epoch :  21 loss training:  104.01310932636261 Time :  295
accuracy train: 0.922568 val: 0.770149 test: 0.720505
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505

Epoch :  22 loss training:  99.92836207151413 Time :  308
accuracy train: 0.923230 val: 0.755224 test: 0.718031
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505
Counter({2: 2911, 0: 2826, 1: 1663})

Epoch :  23 loss training:  98.69527298212051 Time :  322
accuracy train: 0.926539 val: 0.752239 test: 0.718279
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505

Epoch :  24 loss training:  99.74078911542892 Time :  335
accuracy train: 0.930179 val: 0.761194 test: 0.716547
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505
Counter({0: 2920, 1: 2813, 2: 1667})

Epoch :  25 loss training:  94.70976927876472 Time :  348
accuracy train: 0.932826 val: 0.752239 test: 0.718031
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505

Epoch :  26 loss training:  99.44422346353531 Time :  361
accuracy train: 0.932164 val: 0.749254 test: 0.718279
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505
Counter({1: 3187, 0: 2550, 2: 1663})

Epoch :  27 loss training:  98.14932456612587 Time :  375
accuracy train: 0.939444 val: 0.755224 test: 0.714568
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505

Epoch :  28 loss training:  94.86926639080048 Time :  388
accuracy train: 0.937128 val: 0.743284 test: 0.714568
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505
Counter({1: 3217, 2: 2522, 0: 1661})

Epoch :  29 loss training:  88.90320298075676 Time :  405
accuracy train: 0.940106 val: 0.761194 test: 0.716300
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505

Epoch :  30 loss training:  89.14833462238312 Time :  417
accuracy train: 0.942753 val: 0.764179 test: 0.718279
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505
Counter({2: 3235, 1: 2489, 0: 1676})

Epoch :  31 loss training:  85.91732627153397 Time :  431
accuracy train: 0.938120 val: 0.749254 test: 0.715805
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505

Epoch :  32 loss training:  86.19983720779419 Time :  443
accuracy train: 0.941430 val: 0.752239 test: 0.714816
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505
Counter({1: 3249, 0: 2459, 2: 1692})

Epoch :  33 loss training:  90.896624147892 Time :  458
accuracy train: 0.950033 val: 0.749254 test: 0.715805
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505

Epoch :  34 loss training:  86.87660300731659 Time :  471
accuracy train: 0.944739 val: 0.752239 test: 0.715558
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505
Counter({2: 3256, 1: 2453, 0: 1691})

Epoch :  35 loss training:  87.1002749800682 Time :  484
accuracy train: 0.949702 val: 0.755224 test: 0.717042
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505

Epoch :  36 loss training:  84.8830491900444 Time :  498
accuracy train: 0.954004 val: 0.764179 test: 0.721247
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505
Counter({2: 3264, 1: 2450, 0: 1686})

Epoch :  37 loss training:  85.5568480193615 Time :  511
accuracy train: 0.953011 val: 0.755224 test: 0.717042
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505

Epoch :  38 loss training:  84.96236529201269 Time :  522
accuracy train: 0.954004 val: 0.752239 test: 0.716547
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505
Counter({1: 3295, 0: 2440, 2: 1665})

Epoch :  39 loss training:  83.50783815979958 Time :  536
accuracy train: 0.956320 val: 0.746269 test: 0.714074
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505

Epoch :  40 loss training:  82.88122710585594 Time :  549
accuracy train: 0.954004 val: 0.755224 test: 0.714074
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505
Counter({2: 3297, 0: 2435, 1: 1668})

Epoch :  41 loss training:  79.63863483071327 Time :  564
accuracy train: 0.957313 val: 0.758209 test: 0.719021
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505

Epoch :  42 loss training:  79.02267894148827 Time :  576
accuracy train: 0.957975 val: 0.758209 test: 0.718279
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505
Counter({2: 3282, 0: 2449, 1: 1669})

Epoch :  43 loss training:  77.41333103179932 Time :  591
accuracy train: 0.963600 val: 0.752239 test: 0.719021
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505

Epoch :  44 loss training:  77.29527252912521 Time :  603
accuracy train: 0.962938 val: 0.761194 test: 0.715558
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505
Counter({0: 3294, 1: 2448, 2: 1658})

Epoch :  45 loss training:  76.7250768840313 Time :  620
accuracy train: 0.963931 val: 0.752239 test: 0.720010
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505

Epoch :  46 loss training:  75.37459605932236 Time :  632
accuracy train: 0.964593 val: 0.740299 test: 0.719763
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505
Counter({0: 3293, 1: 2448, 2: 1659})

Epoch :  47 loss training:  77.16944670677185 Time :  647
accuracy train: 0.967240 val: 0.761194 test: 0.718031
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505

Epoch :  48 loss training:  77.33028349280357 Time :  659
accuracy train: 0.966248 val: 0.761194 test: 0.718773
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505
Counter({0: 3318, 1: 2436, 2: 1646})

Epoch :  49 loss training:  78.4038870036602 Time :  673
accuracy train: 0.968233 val: 0.743284 test: 0.719268
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505

Epoch :  50 loss training:  73.75074503570795 Time :  687
accuracy train: 0.968233 val: 0.749254 test: 0.719021
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505
Counter({0: 3316, 1: 2440, 2: 1644})

Epoch :  51 loss training:  70.21503376960754 Time :  700
accuracy train: 0.970880 val: 0.764179 test: 0.717536
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505

Epoch :  52 loss training:  68.41960075497627 Time :  712
accuracy train: 0.970218 val: 0.761194 test: 0.720999
max validation accuracy : 0.770149 max acc epoch : 21 test accuracy : 0.720505
Counter({0: 3334, 1: 2434, 2: 1632})

========================================================================================================================================================================================================
max acc epoch :  21
max validation accuracy :  0.7701492537313432
test accuracy :  0.720504575810042
last test_accuracy :  0.7209992579767499
========================================================================================================================================================================================================



date and time :  Wed Apr 21 23:55:01 2021
Namespace(batch_size=32, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=True, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=0)
device :  cuda:0
Counter({2: 2736, 1: 2715, 0: 1949})

Epoch :  1 loss training:  431.7439559698105 Time :  16
accuracy train: 0.662806 val: 0.626866 test: 0.617611
max validation accuracy : 0.626866 max acc epoch : 1 test accuracy : 0.617611
Epoch-1 lr: 0.001

Epoch :  2 loss training:  282.47301173210144 Time :  31
accuracy train: 0.735275 val: 0.683582 test: 0.665100
max validation accuracy : 0.683582 max acc epoch : 2 test accuracy : 0.665100
Counter({1: 3050, 2: 2560, 0: 1790})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  237.6187674999237 Time :  46
accuracy train: 0.762078 val: 0.734328 test: 0.678209
max validation accuracy : 0.734328 max acc epoch : 3 test accuracy : 0.678209
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  203.24080502986908 Time :  61
accuracy train: 0.806750 val: 0.719403 test: 0.685877
max validation accuracy : 0.734328 max acc epoch : 3 test accuracy : 0.678209
Counter({2: 3092, 1: 2523, 0: 1785})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  181.87409365177155 Time :  77
accuracy train: 0.817009 val: 0.722388 test: 0.699233
max validation accuracy : 0.734328 max acc epoch : 3 test accuracy : 0.678209
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  174.13864088058472 Time :  90
accuracy train: 0.852085 val: 0.728358 test: 0.694534
max validation accuracy : 0.734328 max acc epoch : 3 test accuracy : 0.678209
Counter({1: 3072, 2: 2653, 0: 1675})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  154.96601235866547 Time :  106
accuracy train: 0.868630 val: 0.758209 test: 0.701954
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  140.73951822519302 Time :  120
accuracy train: 0.869954 val: 0.737313 test: 0.710364
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954
Counter({1: 3132, 2: 2734, 0: 1534})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  140.83342725038528 Time :  135
accuracy train: 0.887161 val: 0.734328 test: 0.705169
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  125.28552186489105 Time :  150
accuracy train: 0.892786 val: 0.740299 test: 0.716300
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954
Counter({0: 3208, 1: 2728, 2: 1464})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  121.81561362743378 Time :  164
accuracy train: 0.899404 val: 0.743284 test: 0.712837
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  121.99438166618347 Time :  178
accuracy train: 0.905692 val: 0.743284 test: 0.710364
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954
Counter({0: 3217, 1: 2735, 2: 1448})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  115.75113373994827 Time :  194
accuracy train: 0.908670 val: 0.743284 test: 0.709869
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  115.0718939602375 Time :  208
accuracy train: 0.909993 val: 0.755224 test: 0.709374
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954
Counter({2: 3245, 1: 2722, 0: 1433})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  113.39277830719948 Time :  225
accuracy train: 0.909993 val: 0.755224 test: 0.712342
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954

Epoch :  16 loss training:  113.03848022222519 Time :  242
accuracy train: 0.916942 val: 0.752239 test: 0.711353
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954
Counter({1: 3258, 2: 2701, 0: 1441})

Epoch :  17 loss training:  105.69416606426239 Time :  258
accuracy train: 0.923891 val: 0.740299 test: 0.712342
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954

Epoch :  18 loss training:  106.82323265075684 Time :  272
accuracy train: 0.920913 val: 0.758209 test: 0.712590
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954
Counter({0: 3262, 1: 2677, 2: 1461})

Epoch :  19 loss training:  102.94927406311035 Time :  288
accuracy train: 0.922568 val: 0.749254 test: 0.713084
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954

Epoch :  20 loss training:  106.14242479205132 Time :  301
accuracy train: 0.924222 val: 0.743284 test: 0.713826
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954
Counter({1: 3260, 2: 2669, 0: 1471})

Epoch :  21 loss training:  102.74262008070946 Time :  317
accuracy train: 0.925215 val: 0.758209 test: 0.714074
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954

Epoch :  22 loss training:  102.02625977993011 Time :  331
accuracy train: 0.928855 val: 0.752239 test: 0.714321
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954
Counter({1: 3260, 0: 2670, 2: 1470})

Epoch :  23 loss training:  99.04356008768082 Time :  346
accuracy train: 0.933819 val: 0.743284 test: 0.713084
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954

Epoch :  24 loss training:  98.60386309027672 Time :  358
accuracy train: 0.941430 val: 0.752239 test: 0.712342
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954
Counter({2: 3255, 1: 2653, 0: 1492})

Epoch :  25 loss training:  98.19808959960938 Time :  373
accuracy train: 0.938120 val: 0.758209 test: 0.712342
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954

Epoch :  26 loss training:  94.5826353430748 Time :  387
accuracy train: 0.945400 val: 0.746269 test: 0.711600
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954
Counter({2: 3269, 1: 2643, 0: 1488})

Epoch :  27 loss training:  93.54076063632965 Time :  403
accuracy train: 0.946062 val: 0.746269 test: 0.716547
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954

Epoch :  28 loss training:  91.72998550534248 Time :  417
accuracy train: 0.945069 val: 0.743284 test: 0.712095
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954
Counter({1: 3270, 2: 2640, 0: 1490})

Epoch :  29 loss training:  93.00531297922134 Time :  442
accuracy train: 0.946724 val: 0.743284 test: 0.711600
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954

Epoch :  30 loss training:  90.16422864794731 Time :  456
accuracy train: 0.946062 val: 0.758209 test: 0.719515
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954
Counter({2: 3289, 0: 2632, 1: 1479})

Epoch :  31 loss training:  91.38052162528038 Time :  469
accuracy train: 0.950033 val: 0.749254 test: 0.712342
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954

Epoch :  32 loss training:  91.42982426285744 Time :  482
accuracy train: 0.953342 val: 0.740299 test: 0.714816
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954
Counter({2: 3302, 1: 2620, 0: 1478})

Epoch :  33 loss training:  82.7554059624672 Time :  497
accuracy train: 0.952680 val: 0.755224 test: 0.712342
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954

Epoch :  34 loss training:  87.16502070426941 Time :  511
accuracy train: 0.955989 val: 0.740299 test: 0.714568
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954
Counter({2: 3320, 1: 2594, 0: 1486})

Epoch :  35 loss training:  87.59184110164642 Time :  529
accuracy train: 0.954666 val: 0.749254 test: 0.712837
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954

Epoch :  36 loss training:  85.29020139575005 Time :  542
accuracy train: 0.959298 val: 0.746269 test: 0.713826
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954
Counter({2: 3327, 1: 2604, 0: 1469})

Epoch :  37 loss training:  85.00686979293823 Time :  557
accuracy train: 0.963269 val: 0.740299 test: 0.716547
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954

Epoch :  38 loss training:  78.90606427192688 Time :  570
accuracy train: 0.961615 val: 0.740299 test: 0.714074
max validation accuracy : 0.758209 max acc epoch : 7 test accuracy : 0.701954
Counter({2: 3330, 0: 2606, 1: 1464})

========================================================================================================================================================================================================
max acc epoch :  7
max validation accuracy :  0.7582089552238805
test accuracy :  0.7019539945584962
last test_accuracy :  0.7140737076428395
========================================================================================================================================================================================================



date and time :  Thu Apr 22 00:04:46 2021
Namespace(batch_size=32, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=True, seed=0, weight_decay=0)
device :  cuda:0
Counter({1: 2734, 2: 2714, 0: 1952})

Epoch :  1 loss training:  589.9050011634827 Time :  15
accuracy train: 0.416612 val: 0.411940 test: 0.374969
max validation accuracy : 0.411940 max acc epoch : 1 test accuracy : 0.374969
Epoch-1 lr: 0.001

Epoch :  2 loss training:  455.75312304496765 Time :  29
accuracy train: 0.578425 val: 0.522388 test: 0.443483
max validation accuracy : 0.522388 max acc epoch : 2 test accuracy : 0.443483
Counter({1: 4127, 0: 2132, 2: 1141})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  373.12910556793213 Time :  46
accuracy train: 0.702184 val: 0.570149 test: 0.493198
max validation accuracy : 0.570149 max acc epoch : 3 test accuracy : 0.493198
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  296.41533410549164 Time :  58
accuracy train: 0.775976 val: 0.591045 test: 0.527331
max validation accuracy : 0.591045 max acc epoch : 4 test accuracy : 0.527331
Counter({2: 5375, 1: 1247, 0: 778})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  248.399580180645 Time :  74
accuracy train: 0.820979 val: 0.594030 test: 0.530299
max validation accuracy : 0.594030 max acc epoch : 5 test accuracy : 0.530299
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  221.87354576587677 Time :  87
accuracy train: 0.852747 val: 0.608955 test: 0.546129
max validation accuracy : 0.608955 max acc epoch : 6 test accuracy : 0.546129
Counter({0: 4998, 1: 1286, 2: 1116})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  186.3525161743164 Time :  102
accuracy train: 0.886499 val: 0.602985 test: 0.551818
max validation accuracy : 0.608955 max acc epoch : 6 test accuracy : 0.546129
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  174.81658005714417 Time :  115
accuracy train: 0.905361 val: 0.600000 test: 0.555033
max validation accuracy : 0.608955 max acc epoch : 6 test accuracy : 0.546129
Counter({1: 4909, 2: 1307, 0: 1184})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  158.04392075538635 Time :  129
accuracy train: 0.922568 val: 0.602985 test: 0.559980
max validation accuracy : 0.608955 max acc epoch : 6 test accuracy : 0.546129
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  146.03247886896133 Time :  143
accuracy train: 0.927862 val: 0.608955 test: 0.560722
max validation accuracy : 0.608955 max acc epoch : 6 test accuracy : 0.546129
Counter({2: 4855, 1: 1323, 0: 1222})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  134.72331088781357 Time :  157
accuracy train: 0.935142 val: 0.617910 test: 0.562206
max validation accuracy : 0.617910 max acc epoch : 11 test accuracy : 0.562206
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  131.5886865258217 Time :  171
accuracy train: 0.940768 val: 0.608955 test: 0.565422
max validation accuracy : 0.617910 max acc epoch : 11 test accuracy : 0.562206
Counter({0: 4799, 1: 1334, 2: 1267})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  120.45638054609299 Time :  186
accuracy train: 0.943746 val: 0.608955 test: 0.563938
max validation accuracy : 0.617910 max acc epoch : 11 test accuracy : 0.562206
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  120.15765428543091 Time :  200
accuracy train: 0.946724 val: 0.602985 test: 0.565916
max validation accuracy : 0.617910 max acc epoch : 11 test accuracy : 0.562206
Counter({1: 4807, 2: 1337, 0: 1256})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  117.04518461227417 Time :  214
accuracy train: 0.948709 val: 0.611940 test: 0.564185
max validation accuracy : 0.617910 max acc epoch : 11 test accuracy : 0.562206

Epoch :  16 loss training:  116.99822956323624 Time :  228
accuracy train: 0.953011 val: 0.608955 test: 0.566658
max validation accuracy : 0.617910 max acc epoch : 11 test accuracy : 0.562206
Counter({0: 4762, 1: 1337, 2: 1301})

Epoch :  17 loss training:  112.53168767690659 Time :  242
accuracy train: 0.950033 val: 0.620896 test: 0.565669
max validation accuracy : 0.620896 max acc epoch : 17 test accuracy : 0.565669

Epoch :  18 loss training:  113.03634482622147 Time :  255
accuracy train: 0.956651 val: 0.617910 test: 0.569132
max validation accuracy : 0.620896 max acc epoch : 17 test accuracy : 0.565669
Counter({1: 4716, 2: 1347, 0: 1337})

Epoch :  19 loss training:  111.76115930080414 Time :  270
accuracy train: 0.955989 val: 0.632836 test: 0.571605
max validation accuracy : 0.632836 max acc epoch : 19 test accuracy : 0.571605

Epoch :  20 loss training:  108.25821083784103 Time :  282
accuracy train: 0.960622 val: 0.620896 test: 0.570369
max validation accuracy : 0.632836 max acc epoch : 19 test accuracy : 0.571605
Counter({2: 4704, 0: 1364, 1: 1332})

Epoch :  21 loss training:  100.25721377134323 Time :  298
accuracy train: 0.965255 val: 0.623881 test: 0.566906
max validation accuracy : 0.632836 max acc epoch : 19 test accuracy : 0.571605

Epoch :  22 loss training:  103.6939060986042 Time :  311
accuracy train: 0.964593 val: 0.620896 test: 0.567153
max validation accuracy : 0.632836 max acc epoch : 19 test accuracy : 0.571605
Counter({1: 4708, 0: 1351, 2: 1341})

Epoch :  23 loss training:  100.226513504982 Time :  330
accuracy train: 0.966909 val: 0.617910 test: 0.567400
max validation accuracy : 0.632836 max acc epoch : 19 test accuracy : 0.571605

Epoch :  24 loss training:  97.21798241138458 Time :  343
accuracy train: 0.968564 val: 0.620896 test: 0.568884
max validation accuracy : 0.632836 max acc epoch : 19 test accuracy : 0.571605
Counter({2: 4708, 0: 1352, 1: 1340})

Epoch :  25 loss training:  98.4366164803505 Time :  358
accuracy train: 0.968895 val: 0.626866 test: 0.571853
max validation accuracy : 0.632836 max acc epoch : 19 test accuracy : 0.571605

Epoch :  26 loss training:  95.31104046106339 Time :  371
accuracy train: 0.973858 val: 0.620896 test: 0.576552
max validation accuracy : 0.632836 max acc epoch : 19 test accuracy : 0.571605
Counter({0: 4720, 1: 1346, 2: 1334})

Epoch :  27 loss training:  93.019435942173 Time :  387
accuracy train: 0.975844 val: 0.632836 test: 0.574079
max validation accuracy : 0.632836 max acc epoch : 19 test accuracy : 0.571605

Epoch :  28 loss training:  85.79012602567673 Time :  401
accuracy train: 0.975182 val: 0.626866 test: 0.572595
max validation accuracy : 0.632836 max acc epoch : 19 test accuracy : 0.571605
Counter({2: 4722, 1: 1346, 0: 1332})

Epoch :  29 loss training:  93.85659629106522 Time :  417
accuracy train: 0.975182 val: 0.623881 test: 0.573089
max validation accuracy : 0.632836 max acc epoch : 19 test accuracy : 0.571605

Epoch :  30 loss training:  83.92342361807823 Time :  430
accuracy train: 0.974189 val: 0.635821 test: 0.576552
max validation accuracy : 0.635821 max acc epoch : 30 test accuracy : 0.576552
Counter({2: 4708, 0: 1348, 1: 1344})

Epoch :  31 loss training:  79.5164612531662 Time :  445
accuracy train: 0.979484 val: 0.626866 test: 0.571358
max validation accuracy : 0.635821 max acc epoch : 30 test accuracy : 0.576552

Epoch :  32 loss training:  80.41304859519005 Time :  459
accuracy train: 0.982462 val: 0.632836 test: 0.574326
max validation accuracy : 0.635821 max acc epoch : 30 test accuracy : 0.576552
Counter({1: 4689, 2: 1370, 0: 1341})

Epoch :  33 loss training:  83.65451610088348 Time :  473
accuracy train: 0.975844 val: 0.635821 test: 0.579273
max validation accuracy : 0.635821 max acc epoch : 30 test accuracy : 0.576552

Epoch :  34 loss training:  81.81967977434397 Time :  486
accuracy train: 0.985109 val: 0.623881 test: 0.573584
max validation accuracy : 0.635821 max acc epoch : 30 test accuracy : 0.576552
Counter({1: 4659, 0: 1400, 2: 1341})

Epoch :  35 loss training:  76.09206202626228 Time :  501
accuracy train: 0.981138 val: 0.635821 test: 0.578036
max validation accuracy : 0.635821 max acc epoch : 30 test accuracy : 0.576552

Epoch :  36 loss training:  73.55107545852661 Time :  515
accuracy train: 0.983124 val: 0.629851 test: 0.572842
max validation accuracy : 0.635821 max acc epoch : 30 test accuracy : 0.576552
Counter({0: 4640, 2: 1418, 1: 1342})

Epoch :  37 loss training:  75.25236675143242 Time :  532
accuracy train: 0.988087 val: 0.638806 test: 0.573584
max validation accuracy : 0.638806 max acc epoch : 37 test accuracy : 0.573584

Epoch :  38 loss training:  72.73377671837807 Time :  546
accuracy train: 0.986764 val: 0.638806 test: 0.573337
max validation accuracy : 0.638806 max acc epoch : 37 test accuracy : 0.573584
Counter({0: 4633, 1: 1420, 2: 1347})

Epoch :  39 loss training:  72.07520425319672 Time :  562
accuracy train: 0.985109 val: 0.632836 test: 0.577047
max validation accuracy : 0.638806 max acc epoch : 37 test accuracy : 0.573584

Epoch :  40 loss training:  70.4717775285244 Time :  576
accuracy train: 0.988418 val: 0.632836 test: 0.575563
max validation accuracy : 0.638806 max acc epoch : 37 test accuracy : 0.573584
Counter({0: 3177, 1: 2895, 2: 1328})

Epoch :  41 loss training:  70.55008274316788 Time :  591
accuracy train: 0.988749 val: 0.635821 test: 0.573584
max validation accuracy : 0.638806 max acc epoch : 37 test accuracy : 0.573584

Epoch :  42 loss training:  70.21285691857338 Time :  606
accuracy train: 0.990735 val: 0.635821 test: 0.576305
max validation accuracy : 0.638806 max acc epoch : 37 test accuracy : 0.573584
Counter({0: 3174, 2: 2906, 1: 1320})

Epoch :  43 loss training:  67.55988734960556 Time :  622
accuracy train: 0.987095 val: 0.632836 test: 0.575810
max validation accuracy : 0.638806 max acc epoch : 37 test accuracy : 0.573584

Epoch :  44 loss training:  65.46385623514652 Time :  635
accuracy train: 0.991396 val: 0.635821 test: 0.575810
max validation accuracy : 0.638806 max acc epoch : 37 test accuracy : 0.573584
Counter({1: 3161, 2: 2927, 0: 1312})

Epoch :  45 loss training:  63.13013079762459 Time :  650
accuracy train: 0.991727 val: 0.650746 test: 0.577541
max validation accuracy : 0.650746 max acc epoch : 45 test accuracy : 0.577541

Epoch :  46 loss training:  61.703066259622574 Time :  663
accuracy train: 0.991396 val: 0.638806 test: 0.574573
max validation accuracy : 0.650746 max acc epoch : 45 test accuracy : 0.577541
Counter({0: 3169, 1: 2924, 2: 1307})

Epoch :  47 loss training:  64.37714922428131 Time :  677
accuracy train: 0.991727 val: 0.629851 test: 0.577541
max validation accuracy : 0.650746 max acc epoch : 45 test accuracy : 0.577541

Epoch :  48 loss training:  65.09301836788654 Time :  689
accuracy train: 0.992058 val: 0.629851 test: 0.572842
max validation accuracy : 0.650746 max acc epoch : 45 test accuracy : 0.577541
Counter({1: 3196, 0: 2896, 2: 1308})

Epoch :  49 loss training:  59.01693570613861 Time :  704
accuracy train: 0.994705 val: 0.638806 test: 0.577047
max validation accuracy : 0.650746 max acc epoch : 45 test accuracy : 0.577541

Epoch :  50 loss training:  63.48932310938835 Time :  716
accuracy train: 0.992389 val: 0.635821 test: 0.577789
max validation accuracy : 0.650746 max acc epoch : 45 test accuracy : 0.577541
Counter({1: 3173, 0: 2917, 2: 1310})

Epoch :  51 loss training:  53.479106813669205 Time :  730
accuracy train: 0.994375 val: 0.632836 test: 0.577541
max validation accuracy : 0.650746 max acc epoch : 45 test accuracy : 0.577541

Epoch :  52 loss training:  54.22700694203377 Time :  742
accuracy train: 0.995698 val: 0.629851 test: 0.574821
max validation accuracy : 0.650746 max acc epoch : 45 test accuracy : 0.577541
Counter({2: 3174, 1: 2906, 0: 1320})

Epoch :  53 loss training:  56.54335205256939 Time :  755
accuracy train: 0.994705 val: 0.641791 test: 0.574079
max validation accuracy : 0.650746 max acc epoch : 45 test accuracy : 0.577541

Epoch :  54 loss training:  55.60394486784935 Time :  767
accuracy train: 0.995036 val: 0.656716 test: 0.575810
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810
Counter({1: 3102, 0: 2983, 2: 1315})

Epoch :  55 loss training:  53.30436414480209 Time :  781
accuracy train: 0.993713 val: 0.647761 test: 0.576305
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810

Epoch :  56 loss training:  55.185468673706055 Time :  793
accuracy train: 0.995367 val: 0.638806 test: 0.578531
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810
Counter({2: 3141, 0: 2946, 1: 1313})

Epoch :  57 loss training:  52.95885391533375 Time :  807
accuracy train: 0.995698 val: 0.641791 test: 0.579273
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810

Epoch :  58 loss training:  52.39453023672104 Time :  819
accuracy train: 0.995698 val: 0.638806 test: 0.576305
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810
Counter({2: 3141, 1: 2953, 0: 1306})

Epoch :  59 loss training:  49.43783321976662 Time :  833
accuracy train: 0.995698 val: 0.644776 test: 0.577789
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810

Epoch :  60 loss training:  50.12989754974842 Time :  845
accuracy train: 0.996029 val: 0.650746 test: 0.579273
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810
Counter({0: 3155, 1: 2935, 2: 1310})

Epoch :  61 loss training:  46.23210451006889 Time :  858
accuracy train: 0.995036 val: 0.644776 test: 0.583230
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810

Epoch :  62 loss training:  45.62962192296982 Time :  871
accuracy train: 0.995036 val: 0.647761 test: 0.582241
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810
Counter({0: 3199, 2: 2891, 1: 1310})

Epoch :  63 loss training:  44.31237410008907 Time :  885
accuracy train: 0.994705 val: 0.650746 test: 0.578778
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810

Epoch :  64 loss training:  43.43733485043049 Time :  897
accuracy train: 0.995367 val: 0.641791 test: 0.585209
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810
Counter({0: 3284, 2: 2807, 1: 1309})

Epoch :  65 loss training:  45.623003117740154 Time :  911
accuracy train: 0.995036 val: 0.635821 test: 0.580015
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810

Epoch :  66 loss training:  42.17978946864605 Time :  923
accuracy train: 0.996360 val: 0.638806 test: 0.580757
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810
Counter({0: 3314, 2: 2779, 1: 1307})

Epoch :  67 loss training:  42.54541298747063 Time :  937
accuracy train: 0.995698 val: 0.650746 test: 0.583725
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810

Epoch :  68 loss training:  42.18411289155483 Time :  948
accuracy train: 0.997353 val: 0.650746 test: 0.584467
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810
Counter({1: 3321, 0: 2772, 2: 1307})

Epoch :  69 loss training:  41.5032264739275 Time :  966
accuracy train: 0.997684 val: 0.638806 test: 0.580510
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810

Epoch :  70 loss training:  45.100982278585434 Time :  978
accuracy train: 0.996360 val: 0.650746 test: 0.581994
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810
Counter({2: 3359, 0: 2734, 1: 1307})

Epoch :  71 loss training:  37.89909143745899 Time :  993
accuracy train: 0.996360 val: 0.653731 test: 0.584962
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810

Epoch :  72 loss training:  40.34193132072687 Time :  1005
accuracy train: 0.997684 val: 0.629851 test: 0.583478
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810
Counter({0: 3357, 1: 2739, 2: 1304})

Epoch :  73 loss training:  38.299161449074745 Time :  1020
accuracy train: 0.998015 val: 0.644776 test: 0.584962
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810

Epoch :  74 loss training:  42.25397450476885 Time :  1032
accuracy train: 0.999007 val: 0.644776 test: 0.581994
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810
Counter({2: 3346, 1: 2735, 0: 1319})

Epoch :  75 loss training:  34.85129256546497 Time :  1046
accuracy train: 0.998345 val: 0.641791 test: 0.586198
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810

Epoch :  76 loss training:  36.91986232623458 Time :  1057
accuracy train: 0.999669 val: 0.632836 test: 0.581252
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810
Counter({0: 3330, 1: 2755, 2: 1315})

Epoch :  77 loss training:  38.3506755977869 Time :  1070
accuracy train: 0.999338 val: 0.644776 test: 0.583972
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810

Epoch :  78 loss training:  37.895673897117376 Time :  1082
accuracy train: 0.999338 val: 0.647761 test: 0.587188
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810
Counter({0: 3319, 1: 2770, 2: 1311})

Epoch :  79 loss training:  38.72893908619881 Time :  1095
accuracy train: 0.998676 val: 0.650746 test: 0.586940
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810

Epoch :  80 loss training:  35.66151800006628 Time :  1107
accuracy train: 0.999669 val: 0.653731 test: 0.583230
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810
Counter({0: 3259, 2: 2835, 1: 1306})

Epoch :  81 loss training:  33.72566673159599 Time :  1120
accuracy train: 0.999007 val: 0.653731 test: 0.583478
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810

Epoch :  82 loss training:  35.23389835655689 Time :  1132
accuracy train: 0.999669 val: 0.653731 test: 0.584714
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810
Counter({2: 3252, 1: 2848, 0: 1300})

Epoch :  83 loss training:  32.54027070850134 Time :  1147
accuracy train: 0.999669 val: 0.647761 test: 0.583478
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810

Epoch :  84 loss training:  33.82685722410679 Time :  1158
accuracy train: 0.998345 val: 0.650746 test: 0.583972
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810
Counter({1: 3169, 0: 2931, 2: 1300})

Epoch :  85 loss training:  29.511239141225815 Time :  1172
accuracy train: 0.999338 val: 0.644776 test: 0.580015
max validation accuracy : 0.656716 max acc epoch : 54 test accuracy : 0.575810

========================================================================================================================================================================================================
max acc epoch :  54
max validation accuracy :  0.6567164179104478
test accuracy :  0.5758100420479841
last test_accuracy :  0.5800148404650013
========================================================================================================================================================================================================

