date and time :  Tue Jan 26 17:25:56 2021
Namespace(batch_size=16, dataset='R52', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=200, lda=True, lr=0.0005, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=1e-05)
device :  cuda:0
HGNNModel(
  (word_embeddings): Embedding(9333, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=52, bias=True)
    (1): Linear(in_features=200, out_features=52, bias=True)
    (2): Linear(in_features=200, out_features=52, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
)
Epoch :  1 loss training:  304.79154958948493 Time :  10
accuracy train: 0.912602 val: 0.888720 test: 0.900778
max validation accuracy : 0.888720 max acc epoch : 1.000000 test accuracy : 0.900778

Epoch :  2 loss training:  120.52315807249397 Time :  22
accuracy train: 0.944444 val: 0.907012 test: 0.916732
max validation accuracy : 0.907012 max acc epoch : 2.000000 test accuracy : 0.916732

Epoch :  3 loss training:  85.46075346576981 Time :  36
accuracy train: 0.969343 val: 0.932927 test: 0.924514
max validation accuracy : 0.932927 max acc epoch : 3.000000 test accuracy : 0.924514

Epoch :  4 loss training:  65.041044941172 Time :  49
accuracy train: 0.977304 val: 0.942073 test: 0.933074
max validation accuracy : 0.942073 max acc epoch : 4.000000 test accuracy : 0.933074

Epoch :  5 loss training:  50.652313282713294 Time :  60
accuracy train: 0.982046 val: 0.928354 test: 0.935019
max validation accuracy : 0.942073 max acc epoch : 4.000000 test accuracy : 0.933074

Epoch :  6 loss training:  35.667611348908395 Time :  72
accuracy train: 0.980860 val: 0.932927 test: 0.933074
max validation accuracy : 0.942073 max acc epoch : 4.000000 test accuracy : 0.933074

Epoch :  7 loss training:  30.65433435002342 Time :  84
accuracy train: 0.990176 val: 0.935976 test: 0.939689
max validation accuracy : 0.942073 max acc epoch : 4.000000 test accuracy : 0.933074

Epoch :  8 loss training:  25.91053370659938 Time :  96
accuracy train: 0.989160 val: 0.935976 test: 0.933074
max validation accuracy : 0.942073 max acc epoch : 4.000000 test accuracy : 0.933074

Epoch :  9 loss training:  23.237330508127343 Time :  109
accuracy train: 0.994411 val: 0.935976 test: 0.936965
max validation accuracy : 0.942073 max acc epoch : 4.000000 test accuracy : 0.933074

Epoch :  10 loss training:  21.899583907914348 Time :  120
accuracy train: 0.995088 val: 0.940549 test: 0.939689
max validation accuracy : 0.942073 max acc epoch : 4.000000 test accuracy : 0.933074

Epoch :  11 loss training:  18.420438619607012 Time :  131
accuracy train: 0.994580 val: 0.946646 test: 0.940467
max validation accuracy : 0.946646 max acc epoch : 11.000000 test accuracy : 0.940467

Epoch :  12 loss training:  13.388252514298074 Time :  145
accuracy train: 0.996443 val: 0.946646 test: 0.942023
max validation accuracy : 0.946646 max acc epoch : 11.000000 test accuracy : 0.940467

Epoch :  13 loss training:  13.661079430690734 Time :  158
accuracy train: 0.996612 val: 0.940549 test: 0.938132
max validation accuracy : 0.946646 max acc epoch : 11.000000 test accuracy : 0.940467

Epoch :  14 loss training:  13.31285864446545 Time :  169
accuracy train: 0.996951 val: 0.940549 test: 0.940078
max validation accuracy : 0.946646 max acc epoch : 11.000000 test accuracy : 0.940467

Epoch :  15 loss training:  12.372114093715936 Time :  181
accuracy train: 0.996612 val: 0.939024 test: 0.938132
max validation accuracy : 0.946646 max acc epoch : 11.000000 test accuracy : 0.940467

Epoch :  16 loss training:  10.164523850166006 Time :  192
accuracy train: 0.997121 val: 0.940549 test: 0.940467
max validation accuracy : 0.946646 max acc epoch : 11.000000 test accuracy : 0.940467

Epoch :  17 loss training:  9.463136836115154 Time :  206
accuracy train: 0.997459 val: 0.942073 test: 0.940078
max validation accuracy : 0.946646 max acc epoch : 11.000000 test accuracy : 0.940467

Epoch :  18 loss training:  7.585978386639908 Time :  218
accuracy train: 0.997798 val: 0.940549 test: 0.940856
max validation accuracy : 0.946646 max acc epoch : 11.000000 test accuracy : 0.940467

Epoch :  19 loss training:  9.183137059415458 Time :  230
accuracy train: 0.997459 val: 0.942073 test: 0.941245
max validation accuracy : 0.946646 max acc epoch : 11.000000 test accuracy : 0.940467

Epoch :  20 loss training:  8.845272755250335 Time :  241
accuracy train: 0.997629 val: 0.942073 test: 0.940078
max validation accuracy : 0.946646 max acc epoch : 11.000000 test accuracy : 0.940467

Epoch :  21 loss training:  7.693581262501539 Time :  253
accuracy train: 0.997967 val: 0.940549 test: 0.943191
max validation accuracy : 0.946646 max acc epoch : 11.000000 test accuracy : 0.940467

Epoch :  22 loss training:  8.080735178300529 Time :  265
accuracy train: 0.997967 val: 0.942073 test: 0.943580
max validation accuracy : 0.946646 max acc epoch : 11.000000 test accuracy : 0.940467

Epoch :  23 loss training:  6.874568309838651 Time :  278
accuracy train: 0.998137 val: 0.940549 test: 0.942023
max validation accuracy : 0.946646 max acc epoch : 11.000000 test accuracy : 0.940467

Epoch :  24 loss training:  7.70353376728599 Time :  437
accuracy train: 0.998137 val: 0.942073 test: 0.940856
max validation accuracy : 0.946646 max acc epoch : 11.000000 test accuracy : 0.940467

Epoch :  25 loss training:  7.1524628874176415 Time :  1241
accuracy train: 0.997967 val: 0.945122 test: 0.943969
max validation accuracy : 0.946646 max acc epoch : 11.000000 test accuracy : 0.940467

Epoch :  26 loss training:  6.471009535664052 Time :  1586
accuracy train: 0.998306 val: 0.946646 test: 0.943191
max validation accuracy : 0.946646 max acc epoch : 11.000000 test accuracy : 0.940467

Epoch :  27 loss training:  6.186016290252155 Time :  1970
accuracy train: 0.998137 val: 0.943598 test: 0.944358
max validation accuracy : 0.946646 max acc epoch : 11.000000 test accuracy : 0.940467

Epoch :  28 loss training:  5.81650923302368 Time :  2336
accuracy train: 0.998137 val: 0.943598 test: 0.942412
max validation accuracy : 0.946646 max acc epoch : 11.000000 test accuracy : 0.940467

Epoch :  29 loss training:  5.939802530177985 Time :  2734
accuracy train: 0.998137 val: 0.948171 test: 0.942023
max validation accuracy : 0.948171 max acc epoch : 29.000000 test accuracy : 0.942023

Epoch :  30 loss training:  5.576691214933817 Time :  3102
accuracy train: 0.998306 val: 0.948171 test: 0.942412
max validation accuracy : 0.948171 max acc epoch : 29.000000 test accuracy : 0.942023

Epoch :  31 loss training:  5.860303954643314 Time :  3115
accuracy train: 0.998306 val: 0.945122 test: 0.942802
max validation accuracy : 0.948171 max acc epoch : 29.000000 test accuracy : 0.942023

Epoch :  32 loss training:  5.762782912730472 Time :  3126
accuracy train: 0.998306 val: 0.945122 test: 0.941245
max validation accuracy : 0.948171 max acc epoch : 29.000000 test accuracy : 0.942023

Epoch :  33 loss training:  6.266648426397296 Time :  3137
accuracy train: 0.998306 val: 0.946646 test: 0.940467
max validation accuracy : 0.948171 max acc epoch : 29.000000 test accuracy : 0.942023

Epoch :  34 loss training:  6.569535265829472 Time :  3148
accuracy train: 0.998306 val: 0.942073 test: 0.940856
max validation accuracy : 0.948171 max acc epoch : 29.000000 test accuracy : 0.942023

Epoch :  35 loss training:  5.352167385754001 Time :  3160
accuracy train: 0.998306 val: 0.943598 test: 0.941634
max validation accuracy : 0.948171 max acc epoch : 29.000000 test accuracy : 0.942023

Epoch :  36 loss training:  6.760322198577342 Time :  3171
accuracy train: 0.998306 val: 0.946646 test: 0.942802
max validation accuracy : 0.948171 max acc epoch : 29.000000 test accuracy : 0.942023

Epoch :  37 loss training:  6.042594476406521 Time :  3184
accuracy train: 0.998306 val: 0.945122 test: 0.943191
max validation accuracy : 0.948171 max acc epoch : 29.000000 test accuracy : 0.942023

Epoch :  38 loss training:  5.390921182231978 Time :  3247
accuracy train: 0.998306 val: 0.943598 test: 0.943969
max validation accuracy : 0.948171 max acc epoch : 29.000000 test accuracy : 0.942023

Epoch :  39 loss training:  5.059333492336009 Time :  3538
accuracy train: 0.998306 val: 0.943598 test: 0.945136
max validation accuracy : 0.948171 max acc epoch : 29.000000 test accuracy : 0.942023

Epoch :  40 loss training:  5.484456671911175 Time :  3837
accuracy train: 0.998306 val: 0.946646 test: 0.942412
max validation accuracy : 0.948171 max acc epoch : 29.000000 test accuracy : 0.942023

Epoch :  41 loss training:  6.063176629933878 Time :  4172
accuracy train: 0.998306 val: 0.945122 test: 0.944358
max validation accuracy : 0.948171 max acc epoch : 29.000000 test accuracy : 0.942023

Epoch :  42 loss training:  5.5005657843721565 Time :  4521
accuracy train: 0.998306 val: 0.945122 test: 0.942412
max validation accuracy : 0.948171 max acc epoch : 29.000000 test accuracy : 0.942023

Epoch :  43 loss training:  5.683747643485276 Time :  4857
accuracy train: 0.998306 val: 0.945122 test: 0.943580
max validation accuracy : 0.948171 max acc epoch : 29.000000 test accuracy : 0.942023

Epoch :  44 loss training:  5.18982640037575 Time :  5194
accuracy train: 0.998306 val: 0.943598 test: 0.942802
max validation accuracy : 0.948171 max acc epoch : 29.000000 test accuracy : 0.942023

Epoch :  45 loss training:  5.855654222534213 Time :  5522
accuracy train: 0.998306 val: 0.946646 test: 0.941245
max validation accuracy : 0.948171 max acc epoch : 29.000000 test accuracy : 0.942023

Epoch :  46 loss training:  5.328180456952396 Time :  5858
accuracy train: 0.998306 val: 0.946646 test: 0.942802
max validation accuracy : 0.948171 max acc epoch : 29.000000 test accuracy : 0.942023

Epoch :  47 loss training:  5.729490627956693 Time :  6217
accuracy train: 0.998306 val: 0.943598 test: 0.942412
max validation accuracy : 0.948171 max acc epoch : 29.000000 test accuracy : 0.942023

Epoch :  48 loss training:  5.77714914529497 Time :  6588
accuracy train: 0.998306 val: 0.945122 test: 0.942023
max validation accuracy : 0.948171 max acc epoch : 29.000000 test accuracy : 0.942023

Epoch :  49 loss training:  5.850409561229753 Time :  6945
accuracy train: 0.998306 val: 0.948171 test: 0.942023
max validation accuracy : 0.948171 max acc epoch : 29.000000 test accuracy : 0.942023

Epoch :  50 loss training:  5.238404027513752 Time :  7274
accuracy train: 0.998306 val: 0.942073 test: 0.941245
max validation accuracy : 0.948171 max acc epoch : 29.000000 test accuracy : 0.942023

========================================================================================================================================================================================================
max acc epoch :  29
max validation accuracy :  0.948170731707317
test accuracy :  0.9420233463035019
latest_test_accuracy :  0.9412451361867704
========================================================================================================================================================================================================

