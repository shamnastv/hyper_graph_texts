

date and time :  Tue May 25 17:24:09 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=123, weight_decay=1e-08)
device :  cuda:0
Counter({0: 5300, -1: 2100})

Epoch :  1 loss training:  231.430258333683 Time :  197
accuracy train: 0.620781 val: 0.537313 test: 0.567153
max validation accuracy : 0.537313 max acc epoch : 1 test accuracy : 0.567153
Counter({-1: 7400})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  150.89852637052536 Time :  269
accuracy train: 0.725678 val: 0.638806 test: 0.637398
max validation accuracy : 0.638806 max acc epoch : 2 test accuracy : 0.637398
Counter({-1: 7400})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  123.9261015355587 Time :  331
accuracy train: 0.784580 val: 0.665672 test: 0.673510
max validation accuracy : 0.665672 max acc epoch : 3 test accuracy : 0.673510
Counter({-1: 7400})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  100.70567801594734 Time :  395
accuracy train: 0.811714 val: 0.668657 test: 0.682414
max validation accuracy : 0.668657 max acc epoch : 4 test accuracy : 0.682414
Counter({-1: 7400})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  91.64930441975594 Time :  461
accuracy train: 0.821641 val: 0.674627 test: 0.687361
max validation accuracy : 0.674627 max acc epoch : 5 test accuracy : 0.687361
Counter({-1: 7400})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.47368559241295 Time :  518
accuracy train: 0.859365 val: 0.665672 test: 0.701954
max validation accuracy : 0.674627 max acc epoch : 5 test accuracy : 0.687361
Counter({-1: 7400})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  71.21506905555725 Time :  569
accuracy train: 0.872270 val: 0.674627 test: 0.706901
max validation accuracy : 0.674627 max acc epoch : 5 test accuracy : 0.687361
Counter({-1: 7400})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.34583720564842 Time :  616
accuracy train: 0.889477 val: 0.698507 test: 0.704427
max validation accuracy : 0.698507 max acc epoch : 8 test accuracy : 0.704427
Counter({-1: 7400})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  66.22918464243412 Time :  671
accuracy train: 0.893117 val: 0.680597 test: 0.703685
max validation accuracy : 0.698507 max acc epoch : 8 test accuracy : 0.704427
Counter({-1: 7400})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.06448505818844 Time :  724
accuracy train: 0.912310 val: 0.698507 test: 0.713579
max validation accuracy : 0.698507 max acc epoch : 8 test accuracy : 0.704427
Counter({-1: 7400})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  55.52022894471884 Time :  777
accuracy train: 0.918928 val: 0.707463 test: 0.710611
max validation accuracy : 0.707463 max acc epoch : 11 test accuracy : 0.710611
Counter({-1: 7400})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  55.23301221430302 Time :  830
accuracy train: 0.921244 val: 0.701493 test: 0.708138
max validation accuracy : 0.707463 max acc epoch : 11 test accuracy : 0.710611
Counter({-1: 7400})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  53.06432929635048 Time :  889
accuracy train: 0.932495 val: 0.701493 test: 0.713332
max validation accuracy : 0.707463 max acc epoch : 11 test accuracy : 0.710611
Counter({-1: 7400})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  50.9679713845253 Time :  950
accuracy train: 0.929186 val: 0.707463 test: 0.712095
max validation accuracy : 0.707463 max acc epoch : 11 test accuracy : 0.710611
Counter({-1: 7400})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  49.53254998475313 Time :  1013
accuracy train: 0.931502 val: 0.695522 test: 0.710611
max validation accuracy : 0.707463 max acc epoch : 11 test accuracy : 0.710611
Counter({-1: 7400})

Epoch :  16 loss training:  49.34320795536041 Time :  1078
accuracy train: 0.935804 val: 0.686567 test: 0.716300
max validation accuracy : 0.707463 max acc epoch : 11 test accuracy : 0.710611
Counter({-1: 7400})

Epoch :  17 loss training:  48.726463466882706 Time :  1137
accuracy train: 0.942422 val: 0.701493 test: 0.714816
max validation accuracy : 0.707463 max acc epoch : 11 test accuracy : 0.710611
Counter({-1: 7400})

Epoch :  18 loss training:  45.87727551162243 Time :  1198
accuracy train: 0.946062 val: 0.707463 test: 0.717536
max validation accuracy : 0.707463 max acc epoch : 11 test accuracy : 0.710611
Counter({-1: 7400})

Epoch :  19 loss training:  43.53140201419592 Time :  1257
accuracy train: 0.947386 val: 0.704478 test: 0.716052
max validation accuracy : 0.707463 max acc epoch : 11 test accuracy : 0.710611
Counter({-1: 7400})

Epoch :  20 loss training:  44.06280682235956 Time :  1321
accuracy train: 0.954004 val: 0.704478 test: 0.715063
max validation accuracy : 0.707463 max acc epoch : 11 test accuracy : 0.710611
Counter({-1: 7400})

Epoch :  21 loss training:  41.383323937654495 Time :  1387
accuracy train: 0.958637 val: 0.716418 test: 0.717536
max validation accuracy : 0.716418 max acc epoch : 21 test accuracy : 0.717536
Counter({-1: 7400})

Epoch :  22 loss training:  39.69039602577686 Time :  1450
accuracy train: 0.958968 val: 0.707463 test: 0.717042
max validation accuracy : 0.716418 max acc epoch : 21 test accuracy : 0.717536
Counter({-1: 7400})

Epoch :  23 loss training:  40.4589067324996 Time :  1510
accuracy train: 0.956982 val: 0.698507 test: 0.713826
max validation accuracy : 0.716418 max acc epoch : 21 test accuracy : 0.717536
Counter({-1: 7400})

Epoch :  24 loss training:  39.14620694518089 Time :  1578
accuracy train: 0.963269 val: 0.704478 test: 0.717536
max validation accuracy : 0.716418 max acc epoch : 21 test accuracy : 0.717536
Counter({-1: 7400})

Epoch :  25 loss training:  36.37596453726292 Time :  1640
accuracy train: 0.962608 val: 0.719403 test: 0.719268
max validation accuracy : 0.719403 max acc epoch : 25 test accuracy : 0.719268
Counter({-1: 7400})

Epoch :  26 loss training:  36.537006728351116 Time :  1702
accuracy train: 0.964593 val: 0.710448 test: 0.725204
max validation accuracy : 0.719403 max acc epoch : 25 test accuracy : 0.719268
Counter({-1: 7400})

Epoch :  27 loss training:  35.44439706206322 Time :  1763
accuracy train: 0.978160 val: 0.698507 test: 0.722731
max validation accuracy : 0.719403 max acc epoch : 25 test accuracy : 0.719268
Counter({-1: 7400})

Epoch :  28 loss training:  32.30784972012043 Time :  1824
accuracy train: 0.980146 val: 0.701493 test: 0.723473
max validation accuracy : 0.719403 max acc epoch : 25 test accuracy : 0.719268
Counter({-1: 7400})

Epoch :  29 loss training:  31.59699524194002 Time :  1886
accuracy train: 0.980807 val: 0.710448 test: 0.725451
max validation accuracy : 0.719403 max acc epoch : 25 test accuracy : 0.719268
Counter({-1: 7400})

Epoch :  30 loss training:  32.8128654807806 Time :  1946
accuracy train: 0.980807 val: 0.707463 test: 0.725451
max validation accuracy : 0.719403 max acc epoch : 25 test accuracy : 0.719268
Counter({-1: 7400})

Epoch :  31 loss training:  29.770245864987373 Time :  2004
accuracy train: 0.987095 val: 0.704478 test: 0.725946
max validation accuracy : 0.719403 max acc epoch : 25 test accuracy : 0.719268
Counter({-1: 7400})

Epoch :  32 loss training:  29.275939770042896 Time :  2065
accuracy train: 0.985109 val: 0.707463 test: 0.721741
max validation accuracy : 0.719403 max acc epoch : 25 test accuracy : 0.719268
Counter({-1: 7400})

Epoch :  33 loss training:  29.75574591010809 Time :  2127
accuracy train: 0.984778 val: 0.713433 test: 0.722978
max validation accuracy : 0.719403 max acc epoch : 25 test accuracy : 0.719268
Counter({-1: 7400})

Epoch :  34 loss training:  27.985746208578348 Time :  2187
accuracy train: 0.988749 val: 0.698507 test: 0.725204
max validation accuracy : 0.719403 max acc epoch : 25 test accuracy : 0.719268
Counter({-1: 7400})

Epoch :  35 loss training:  27.091948799788952 Time :  2246
accuracy train: 0.989742 val: 0.695522 test: 0.722731
max validation accuracy : 0.719403 max acc epoch : 25 test accuracy : 0.719268
Counter({-1: 7400})

Epoch :  36 loss training:  25.677301842719316 Time :  2308
accuracy train: 0.993382 val: 0.704478 test: 0.721741
max validation accuracy : 0.719403 max acc epoch : 25 test accuracy : 0.719268
Counter({-1: 7400})

Epoch :  37 loss training:  25.272218570113182 Time :  2366
accuracy train: 0.990404 val: 0.704478 test: 0.720257
max validation accuracy : 0.719403 max acc epoch : 25 test accuracy : 0.719268
Counter({-1: 7400})

Epoch :  38 loss training:  24.909820191562176 Time :  2423
accuracy train: 0.993713 val: 0.710448 test: 0.720257
max validation accuracy : 0.719403 max acc epoch : 25 test accuracy : 0.719268
Counter({-1: 7400})

Epoch :  39 loss training:  23.438809260725975 Time :  2480
accuracy train: 0.993382 val: 0.701493 test: 0.721494
max validation accuracy : 0.719403 max acc epoch : 25 test accuracy : 0.719268
Counter({-1: 7400})

Epoch :  40 loss training:  22.280956763774157 Time :  2538
accuracy train: 0.993051 val: 0.704478 test: 0.722483
max validation accuracy : 0.719403 max acc epoch : 25 test accuracy : 0.719268
Counter({-1: 7400})

Epoch :  41 loss training:  21.57616763561964 Time :  2594
accuracy train: 0.996360 val: 0.701493 test: 0.723225
max validation accuracy : 0.719403 max acc epoch : 25 test accuracy : 0.719268
Counter({-1: 7400})

Epoch :  42 loss training:  21.844533756375313 Time :  2650
accuracy train: 0.995698 val: 0.698507 test: 0.722731
max validation accuracy : 0.719403 max acc epoch : 25 test accuracy : 0.719268
Counter({-1: 7400})

Epoch :  43 loss training:  19.844294846057892 Time :  2702
accuracy train: 0.995036 val: 0.713433 test: 0.725451
max validation accuracy : 0.719403 max acc epoch : 25 test accuracy : 0.719268
Counter({-1: 7400})

Epoch :  44 loss training:  20.166366428136826 Time :  2760
accuracy train: 0.998345 val: 0.707463 test: 0.722483
max validation accuracy : 0.719403 max acc epoch : 25 test accuracy : 0.719268
Counter({-1: 7400})

Epoch :  45 loss training:  19.556847289204597 Time :  2819
accuracy train: 0.996029 val: 0.707463 test: 0.721741
max validation accuracy : 0.719403 max acc epoch : 25 test accuracy : 0.719268
Counter({-1: 7400})

Epoch :  46 loss training:  17.785690627992153 Time :  2876
accuracy train: 0.997684 val: 0.704478 test: 0.724709
max validation accuracy : 0.719403 max acc epoch : 25 test accuracy : 0.719268
Counter({-1: 7400})

Epoch :  47 loss training:  18.927768111228943 Time :  2933
accuracy train: 0.997684 val: 0.701493 test: 0.721247
max validation accuracy : 0.719403 max acc epoch : 25 test accuracy : 0.719268
Counter({-1: 7400})

Epoch :  48 loss training:  16.84301594644785 Time :  2984
accuracy train: 0.998015 val: 0.704478 test: 0.724957
max validation accuracy : 0.719403 max acc epoch : 25 test accuracy : 0.719268
Counter({-1: 7400})

Epoch :  49 loss training:  16.548999909311533 Time :  3035
accuracy train: 0.998345 val: 0.716418 test: 0.725204
max validation accuracy : 0.719403 max acc epoch : 25 test accuracy : 0.719268
Counter({-1: 7400})

Epoch :  50 loss training:  15.73505249619484 Time :  3082
accuracy train: 0.999338 val: 0.710448 test: 0.728914
max validation accuracy : 0.719403 max acc epoch : 25 test accuracy : 0.719268
Counter({-1: 7400})

Epoch :  51 loss training:  14.250087592750788 Time :  3132
accuracy train: 0.998345 val: 0.725373 test: 0.725204
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  52 loss training:  16.250885802321136 Time :  3185
accuracy train: 0.999338 val: 0.713433 test: 0.721989
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  53 loss training:  14.43167295306921 Time :  3242
accuracy train: 0.999669 val: 0.710448 test: 0.718279
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  54 loss training:  13.371310682967305 Time :  3301
accuracy train: 0.998345 val: 0.713433 test: 0.720010
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  55 loss training:  13.163472713902593 Time :  3360
accuracy train: 0.999669 val: 0.701493 test: 0.727925
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  56 loss training:  12.37121682614088 Time :  3418
accuracy train: 0.999669 val: 0.704478 test: 0.725204
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  57 loss training:  12.783640708774328 Time :  3474
accuracy train: 1.000000 val: 0.704478 test: 0.725451
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  58 loss training:  13.778989903628826 Time :  3530
accuracy train: 1.000000 val: 0.695522 test: 0.727677
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  59 loss training:  11.833306721411645 Time :  3583
accuracy train: 1.000000 val: 0.704478 test: 0.723473
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  60 loss training:  12.295189164578915 Time :  3636
accuracy train: 0.999669 val: 0.710448 test: 0.722236
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  61 loss training:  11.434495019726455 Time :  3688
accuracy train: 1.000000 val: 0.713433 test: 0.723473
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  62 loss training:  10.939049258828163 Time :  3741
accuracy train: 1.000000 val: 0.701493 test: 0.723720
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  63 loss training:  11.29375124629587 Time :  3791
accuracy train: 0.999669 val: 0.698507 test: 0.724957
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  64 loss training:  9.710970468819141 Time :  3838
accuracy train: 1.000000 val: 0.710448 test: 0.723967
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  65 loss training:  10.88749189209193 Time :  3894
accuracy train: 0.999669 val: 0.710448 test: 0.723720
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  66 loss training:  9.981369037181139 Time :  3949
accuracy train: 1.000000 val: 0.710448 test: 0.721494
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  67 loss training:  10.356310890987515 Time :  4007
accuracy train: 1.000000 val: 0.710448 test: 0.724215
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  68 loss training:  8.738816166296601 Time :  4063
accuracy train: 1.000000 val: 0.701493 test: 0.722731
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  69 loss training:  9.806742512620986 Time :  4120
accuracy train: 1.000000 val: 0.716418 test: 0.723473
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  70 loss training:  9.251001593656838 Time :  4179
accuracy train: 1.000000 val: 0.704478 test: 0.721494
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  71 loss training:  8.697510692290962 Time :  4233
accuracy train: 1.000000 val: 0.707463 test: 0.727430
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  72 loss training:  8.563112465664744 Time :  4283
accuracy train: 1.000000 val: 0.713433 test: 0.724215
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  73 loss training:  7.246727146208286 Time :  4333
accuracy train: 1.000000 val: 0.713433 test: 0.725204
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  74 loss training:  7.69450459536165 Time :  4383
accuracy train: 1.000000 val: 0.701493 test: 0.723473
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  75 loss training:  7.7376527255401015 Time :  4435
accuracy train: 1.000000 val: 0.707463 test: 0.723967
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  76 loss training:  7.383149103727192 Time :  4485
accuracy train: 1.000000 val: 0.707463 test: 0.722731
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  77 loss training:  6.646991575136781 Time :  4538
accuracy train: 1.000000 val: 0.713433 test: 0.725946
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  78 loss training:  6.341526900883764 Time :  4590
accuracy train: 1.000000 val: 0.698507 test: 0.720257
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  79 loss training:  6.109158438630402 Time :  4643
accuracy train: 1.000000 val: 0.707463 test: 0.725451
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  80 loss training:  8.008529796265066 Time :  4697
accuracy train: 1.000000 val: 0.710448 test: 0.724462
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  81 loss training:  6.145842880476266 Time :  4746
accuracy train: 1.000000 val: 0.695522 test: 0.723473
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

Epoch :  82 loss training:  6.411612275056541 Time :  4793
accuracy train: 1.000000 val: 0.695522 test: 0.723720
max validation accuracy : 0.725373 max acc epoch : 51 test accuracy : 0.725204
Counter({-1: 7400})

========================================================================================================================================================================================================
max acc epoch :  51
max validation accuracy :  0.7253731343283583
test accuracy :  0.725204056393767
last test_accuracy :  0.7237200098936434
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=123, weight_decay=1e-08)
device :  cuda:0
Counter({0: 5300, -1: 2100})

Epoch :  1 loss training:  231.4722530245781 Time :  4954
accuracy train: 0.627399 val: 0.537313 test: 0.578531
max validation accuracy : 0.537313 max acc epoch : 1 test accuracy : 0.578531
Counter({-1: 7400})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  150.96447813510895 Time :  5022
accuracy train: 0.716082 val: 0.650746 test: 0.632946
max validation accuracy : 0.650746 max acc epoch : 2 test accuracy : 0.632946
Counter({-1: 7400})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  124.62207847833633 Time :  5077
accuracy train: 0.781271 val: 0.653731 test: 0.668563
max validation accuracy : 0.653731 max acc epoch : 3 test accuracy : 0.668563
Counter({-1: 7400})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  101.03691700100899 Time :  5141
accuracy train: 0.817670 val: 0.659701 test: 0.688103
max validation accuracy : 0.659701 max acc epoch : 4 test accuracy : 0.688103
Counter({-1: 7400})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  91.28390392661095 Time :  5208
accuracy train: 0.831238 val: 0.665672 test: 0.687114
max validation accuracy : 0.665672 max acc epoch : 5 test accuracy : 0.687114
Counter({-1: 7400})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  84.77504423260689 Time :  5268
accuracy train: 0.861681 val: 0.674627 test: 0.698491
max validation accuracy : 0.674627 max acc epoch : 6 test accuracy : 0.698491
Counter({-1: 7400})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  71.47223311662674 Time :  5330
accuracy train: 0.867306 val: 0.659701 test: 0.701212
max validation accuracy : 0.674627 max acc epoch : 6 test accuracy : 0.698491
Counter({-1: 7400})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.16148053109646 Time :  5386
accuracy train: 0.886168 val: 0.683582 test: 0.712095
max validation accuracy : 0.683582 max acc epoch : 8 test accuracy : 0.712095
Counter({-1: 7400})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  66.18853425979614 Time :  5448
accuracy train: 0.895433 val: 0.665672 test: 0.702201
max validation accuracy : 0.683582 max acc epoch : 8 test accuracy : 0.712095
Counter({-1: 7400})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.2635790258646 Time :  5508
accuracy train: 0.909993 val: 0.698507 test: 0.716052
max validation accuracy : 0.698507 max acc epoch : 10 test accuracy : 0.716052
Counter({-1: 7400})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  55.90844774246216 Time :  5568
accuracy train: 0.918266 val: 0.692537 test: 0.710611
max validation accuracy : 0.698507 max acc epoch : 10 test accuracy : 0.716052
Counter({-1: 7400})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  54.90987594425678 Time :  5626
accuracy train: 0.920913 val: 0.683582 test: 0.709622
max validation accuracy : 0.698507 max acc epoch : 10 test accuracy : 0.716052
Counter({-1: 7400})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  52.74346049129963 Time :  5683
accuracy train: 0.930179 val: 0.695522 test: 0.712590
max validation accuracy : 0.698507 max acc epoch : 10 test accuracy : 0.716052
Counter({-1: 7400})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  50.44889760017395 Time :  5741
accuracy train: 0.932495 val: 0.692537 test: 0.713826
max validation accuracy : 0.698507 max acc epoch : 10 test accuracy : 0.716052
Counter({-1: 7400})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  49.277816623449326 Time :  5800
accuracy train: 0.934150 val: 0.683582 test: 0.713332
max validation accuracy : 0.698507 max acc epoch : 10 test accuracy : 0.716052
Counter({-1: 7400})

Epoch :  16 loss training:  47.68130913376808 Time :  5857
accuracy train: 0.941099 val: 0.683582 test: 0.714074
max validation accuracy : 0.698507 max acc epoch : 10 test accuracy : 0.716052
Counter({-1: 7400})

Epoch :  17 loss training:  49.220920115709305 Time :  5914
accuracy train: 0.942753 val: 0.689552 test: 0.715063
max validation accuracy : 0.698507 max acc epoch : 10 test accuracy : 0.716052
Counter({-1: 7400})

Epoch :  18 loss training:  45.58421768248081 Time :  5964
accuracy train: 0.947386 val: 0.680597 test: 0.715558
max validation accuracy : 0.698507 max acc epoch : 10 test accuracy : 0.716052
Counter({-1: 7400})

Epoch :  19 loss training:  43.690794326364994 Time :  6021
accuracy train: 0.947717 val: 0.695522 test: 0.716052
max validation accuracy : 0.698507 max acc epoch : 10 test accuracy : 0.716052
Counter({-1: 7400})

Epoch :  20 loss training:  43.72582621872425 Time :  6072
accuracy train: 0.954335 val: 0.701493 test: 0.714321
max validation accuracy : 0.701493 max acc epoch : 20 test accuracy : 0.714321
Counter({-1: 7400})

Epoch :  21 loss training:  40.33025150001049 Time :  6122
accuracy train: 0.962277 val: 0.692537 test: 0.714816
max validation accuracy : 0.701493 max acc epoch : 20 test accuracy : 0.714321
Counter({-1: 7400})

Epoch :  22 loss training:  40.342181757092476 Time :  6176
accuracy train: 0.960291 val: 0.692537 test: 0.715805
max validation accuracy : 0.701493 max acc epoch : 20 test accuracy : 0.714321
Counter({-1: 7400})

Epoch :  23 loss training:  39.927313044667244 Time :  6227
accuracy train: 0.960291 val: 0.683582 test: 0.714568
max validation accuracy : 0.701493 max acc epoch : 20 test accuracy : 0.714321
Counter({-1: 7400})

Epoch :  24 loss training:  38.31806578487158 Time :  6282
accuracy train: 0.967571 val: 0.692537 test: 0.713579
max validation accuracy : 0.701493 max acc epoch : 20 test accuracy : 0.714321
Counter({-1: 7400})

Epoch :  25 loss training:  37.268056742846966 Time :  6341
accuracy train: 0.965586 val: 0.701493 test: 0.714816
max validation accuracy : 0.701493 max acc epoch : 20 test accuracy : 0.714321
Counter({-1: 7400})

Epoch :  26 loss training:  36.00561684370041 Time :  6401
accuracy train: 0.970880 val: 0.698507 test: 0.716547
max validation accuracy : 0.701493 max acc epoch : 20 test accuracy : 0.714321
Counter({-1: 7400})

Epoch :  27 loss training:  34.38519600778818 Time :  6465
accuracy train: 0.977829 val: 0.677612 test: 0.720999
max validation accuracy : 0.701493 max acc epoch : 20 test accuracy : 0.714321
Counter({-1: 7400})

Epoch :  28 loss training:  32.65073627233505 Time :  6523
accuracy train: 0.980477 val: 0.680597 test: 0.717042
max validation accuracy : 0.701493 max acc epoch : 20 test accuracy : 0.714321
Counter({-1: 7400})

Epoch :  29 loss training:  31.77647925913334 Time :  6572
accuracy train: 0.981469 val: 0.689552 test: 0.721494
max validation accuracy : 0.701493 max acc epoch : 20 test accuracy : 0.714321
Counter({-1: 7400})

Epoch :  30 loss training:  31.877758856862783 Time :  6625
accuracy train: 0.985440 val: 0.686567 test: 0.717042
max validation accuracy : 0.701493 max acc epoch : 20 test accuracy : 0.714321
Counter({-1: 7400})

Epoch :  31 loss training:  29.586141653358936 Time :  6680
accuracy train: 0.985771 val: 0.695522 test: 0.715558
max validation accuracy : 0.701493 max acc epoch : 20 test accuracy : 0.714321
Counter({-1: 7400})

Epoch :  32 loss training:  28.904200702905655 Time :  6729
accuracy train: 0.984116 val: 0.707463 test: 0.718773
max validation accuracy : 0.707463 max acc epoch : 32 test accuracy : 0.718773
Counter({-1: 7400})

Epoch :  33 loss training:  30.059228152036667 Time :  6785
accuracy train: 0.986102 val: 0.713433 test: 0.721494
max validation accuracy : 0.713433 max acc epoch : 33 test accuracy : 0.721494
Counter({-1: 7400})

Epoch :  34 loss training:  28.354251004755497 Time :  6840
accuracy train: 0.989411 val: 0.698507 test: 0.720999
max validation accuracy : 0.713433 max acc epoch : 33 test accuracy : 0.721494
Counter({-1: 7400})

Epoch :  35 loss training:  27.112145818769932 Time :  6892
accuracy train: 0.990073 val: 0.680597 test: 0.716547
max validation accuracy : 0.713433 max acc epoch : 33 test accuracy : 0.721494
Counter({-1: 7400})

Epoch :  36 loss training:  25.70036819577217 Time :  6950
accuracy train: 0.992389 val: 0.689552 test: 0.720010
max validation accuracy : 0.713433 max acc epoch : 33 test accuracy : 0.721494
Counter({-1: 7400})

Epoch :  37 loss training:  24.84836907684803 Time :  7008
accuracy train: 0.992720 val: 0.698507 test: 0.720010
max validation accuracy : 0.713433 max acc epoch : 33 test accuracy : 0.721494
Counter({-1: 7400})

Epoch :  38 loss training:  24.327684834599495 Time :  7063
accuracy train: 0.993382 val: 0.725373 test: 0.719763
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  39 loss training:  22.644998766481876 Time :  7116
accuracy train: 0.995367 val: 0.695522 test: 0.718773
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  40 loss training:  21.657212898135185 Time :  7171
accuracy train: 0.994705 val: 0.716418 test: 0.718279
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  41 loss training:  21.623959094285965 Time :  7230
accuracy train: 0.996691 val: 0.698507 test: 0.718773
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  42 loss training:  22.60047796368599 Time :  7306
accuracy train: 0.997353 val: 0.701493 test: 0.721989
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  43 loss training:  19.358648357912898 Time :  7360
accuracy train: 0.997022 val: 0.695522 test: 0.721741
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  44 loss training:  20.368416354060173 Time :  7413
accuracy train: 0.997684 val: 0.701493 test: 0.723473
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  45 loss training:  19.954331252723932 Time :  7469
accuracy train: 0.997353 val: 0.692537 test: 0.719021
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  46 loss training:  17.828817427158356 Time :  7530
accuracy train: 0.998345 val: 0.698507 test: 0.721741
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  47 loss training:  18.40685399994254 Time :  7587
accuracy train: 0.998345 val: 0.692537 test: 0.718773
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  48 loss training:  16.705536849796772 Time :  7645
accuracy train: 0.998345 val: 0.698507 test: 0.719515
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  49 loss training:  17.068571731448174 Time :  7702
accuracy train: 0.998676 val: 0.707463 test: 0.722978
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  50 loss training:  15.697078701108694 Time :  7758
accuracy train: 0.999338 val: 0.710448 test: 0.722483
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  51 loss training:  15.227733626961708 Time :  7811
accuracy train: 0.999007 val: 0.707463 test: 0.721247
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  52 loss training:  16.58063507452607 Time :  7865
accuracy train: 0.999007 val: 0.701493 test: 0.715558
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  53 loss training:  14.433448612689972 Time :  7917
accuracy train: 0.999669 val: 0.698507 test: 0.713826
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  54 loss training:  13.423976259306073 Time :  7970
accuracy train: 0.999338 val: 0.701493 test: 0.718773
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  55 loss training:  13.574133709073067 Time :  8024
accuracy train: 0.999669 val: 0.695522 test: 0.724957
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  56 loss training:  13.27308582700789 Time :  8074
accuracy train: 0.999669 val: 0.701493 test: 0.723225
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  57 loss training:  12.755303502082825 Time :  8126
accuracy train: 0.999669 val: 0.701493 test: 0.720999
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  58 loss training:  12.612913850694895 Time :  8178
accuracy train: 0.999669 val: 0.701493 test: 0.725451
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  59 loss training:  12.159788105636835 Time :  8227
accuracy train: 1.000000 val: 0.701493 test: 0.722236
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  60 loss training:  12.22627916187048 Time :  8284
accuracy train: 1.000000 val: 0.698507 test: 0.721741
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  61 loss training:  10.605404901318252 Time :  8338
accuracy train: 1.000000 val: 0.716418 test: 0.720257
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  62 loss training:  11.11455257423222 Time :  8391
accuracy train: 1.000000 val: 0.692537 test: 0.720752
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  63 loss training:  11.20571850426495 Time :  8443
accuracy train: 1.000000 val: 0.698507 test: 0.719268
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  64 loss training:  9.306496739387512 Time :  8495
accuracy train: 1.000000 val: 0.710448 test: 0.723225
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  65 loss training:  10.258105773478746 Time :  8548
accuracy train: 1.000000 val: 0.710448 test: 0.724462
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  66 loss training:  10.287497444078326 Time :  8599
accuracy train: 1.000000 val: 0.713433 test: 0.724709
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  67 loss training:  10.06019346602261 Time :  8650
accuracy train: 1.000000 val: 0.707463 test: 0.723720
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  68 loss training:  9.094129665754735 Time :  8705
accuracy train: 1.000000 val: 0.704478 test: 0.722483
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

Epoch :  69 loss training:  9.437055300921202 Time :  8758
accuracy train: 1.000000 val: 0.707463 test: 0.724957
max validation accuracy : 0.725373 max acc epoch : 38 test accuracy : 0.719763
Counter({-1: 7400})

========================================================================================================================================================================================================
max acc epoch :  38
max validation accuracy :  0.7253731343283583
test accuracy :  0.7197625525599802
last test_accuracy :  0.7249567153104131
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=123, weight_decay=1e-08)
device :  cuda:0
Counter({0: 5300, -1: 2100})

Epoch :  1 loss training:  231.3082428574562 Time :  8944
accuracy train: 0.621443 val: 0.540299 test: 0.568142
max validation accuracy : 0.540299 max acc epoch : 1 test accuracy : 0.568142
Counter({-1: 7400})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  150.59900444746017 Time :  9004
accuracy train: 0.710126 val: 0.620896 test: 0.632698
max validation accuracy : 0.620896 max acc epoch : 2 test accuracy : 0.632698
Counter({-1: 7400})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  125.38097661733627 Time :  9062
accuracy train: 0.778954 val: 0.671642 test: 0.675241
max validation accuracy : 0.671642 max acc epoch : 3 test accuracy : 0.675241
Counter({-1: 7400})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  101.61243015527725 Time :  9123
accuracy train: 0.817670 val: 0.668657 test: 0.684887
max validation accuracy : 0.671642 max acc epoch : 3 test accuracy : 0.675241
Counter({-1: 7400})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  91.25714439153671 Time :  9184
accuracy train: 0.825943 val: 0.671642 test: 0.689340
max validation accuracy : 0.671642 max acc epoch : 3 test accuracy : 0.675241
Counter({-1: 7400})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  85.1324573457241 Time :  9238
accuracy train: 0.856386 val: 0.677612 test: 0.700965
max validation accuracy : 0.677612 max acc epoch : 6 test accuracy : 0.700965
Counter({-1: 7400})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  72.0782268345356 Time :  9287
accuracy train: 0.866314 val: 0.665672 test: 0.703191
max validation accuracy : 0.677612 max acc epoch : 6 test accuracy : 0.700965
Counter({-1: 7400})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.39942866563797 Time :  9340
accuracy train: 0.891132 val: 0.692537 test: 0.710858
max validation accuracy : 0.692537 max acc epoch : 8 test accuracy : 0.710858
Counter({-1: 7400})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.48058994114399 Time :  9401
accuracy train: 0.890470 val: 0.674627 test: 0.699233
max validation accuracy : 0.692537 max acc epoch : 8 test accuracy : 0.710858
Counter({-1: 7400})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.11572323739529 Time :  9460
accuracy train: 0.909001 val: 0.710448 test: 0.713826
max validation accuracy : 0.710448 max acc epoch : 10 test accuracy : 0.713826
Counter({-1: 7400})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  56.36193401366472 Time :  9514
accuracy train: 0.919921 val: 0.716418 test: 0.710116
max validation accuracy : 0.716418 max acc epoch : 11 test accuracy : 0.710116
Counter({-1: 7400})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  54.851698622107506 Time :  9566
accuracy train: 0.922899 val: 0.698507 test: 0.710611
max validation accuracy : 0.716418 max acc epoch : 11 test accuracy : 0.710116
Counter({-1: 7400})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  53.01585255563259 Time :  9615
accuracy train: 0.934480 val: 0.710448 test: 0.708385
max validation accuracy : 0.716418 max acc epoch : 11 test accuracy : 0.710116
Counter({-1: 7400})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  50.382702469825745 Time :  9665
accuracy train: 0.931171 val: 0.704478 test: 0.711353
max validation accuracy : 0.716418 max acc epoch : 11 test accuracy : 0.710116
Counter({-1: 7400})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  49.22203300893307 Time :  9715
accuracy train: 0.933488 val: 0.701493 test: 0.709622
max validation accuracy : 0.716418 max acc epoch : 11 test accuracy : 0.710116
Counter({-1: 7400})

Epoch :  16 loss training:  48.30418762564659 Time :  9764
accuracy train: 0.939775 val: 0.695522 test: 0.711353
max validation accuracy : 0.716418 max acc epoch : 11 test accuracy : 0.710116
Counter({-1: 7400})

Epoch :  17 loss training:  48.99646708369255 Time :  9813
accuracy train: 0.941099 val: 0.710448 test: 0.711106
max validation accuracy : 0.716418 max acc epoch : 11 test accuracy : 0.710116
Counter({-1: 7400})

Epoch :  18 loss training:  45.53867173194885 Time :  9860
accuracy train: 0.948048 val: 0.692537 test: 0.711600
max validation accuracy : 0.716418 max acc epoch : 11 test accuracy : 0.710116
Counter({-1: 7400})

Epoch :  19 loss training:  43.585269913077354 Time :  9913
accuracy train: 0.947386 val: 0.692537 test: 0.711848
max validation accuracy : 0.716418 max acc epoch : 11 test accuracy : 0.710116
Counter({-1: 7400})

Epoch :  20 loss training:  43.11304501444101 Time :  9964
accuracy train: 0.955659 val: 0.692537 test: 0.710611
max validation accuracy : 0.716418 max acc epoch : 11 test accuracy : 0.710116
Counter({-1: 7400})

Epoch :  21 loss training:  40.31293123215437 Time :  10017
accuracy train: 0.961284 val: 0.704478 test: 0.714568
max validation accuracy : 0.716418 max acc epoch : 11 test accuracy : 0.710116
Counter({-1: 7400})

slurmstepd: error: *** JOB 33860 ON cl-gpusrv1 CANCELLED AT 2021-05-25T20:12:15 ***
