

date and time :  Fri Jun 11 23:51:39 2021
itr : 0
Namespace(batch_size=32, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=793, weight_decay=1e-10)
device :  cuda:0
Counter({0: 7565, 1: 6372, 2: 4909})

Epoch :  1 loss training:  672.9222288131714 Time :  494
accuracy train: 0.811352 val: 0.787798 test: 0.735794
max validation accuracy : 0.787798 max acc epoch : 1 test accuracy : 0.735794
Counter({1: 6964, 0: 6581, 2: 5301})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  435.79346138238907 Time :  661
accuracy train: 0.837278 val: 0.799293 test: 0.757302
max validation accuracy : 0.799293 max acc epoch : 2 test accuracy : 0.757302
Counter({2: 7382, 0: 6130, 1: 5334})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  387.1841160207987 Time :  816
accuracy train: 0.869783 val: 0.825818 test: 0.773898
max validation accuracy : 0.825818 max acc epoch : 3 test accuracy : 0.773898
Counter({1: 6902, 2: 6251, 0: 5693})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  275.97205943614244 Time :  913
accuracy train: 0.904547 val: 0.863837 test: 0.790361
max validation accuracy : 0.863837 max acc epoch : 4 test accuracy : 0.790361
Counter({2: 6460, 1: 6294, 0: 6092})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  251.62087777256966 Time :  1011
accuracy train: 0.912796 val: 0.861185 test: 0.798593
max validation accuracy : 0.863837 max acc epoch : 4 test accuracy : 0.790361
Counter({2: 7588, 1: 6314, 0: 4944})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  232.0850558448583 Time :  1125
accuracy train: 0.925759 val: 0.862069 test: 0.801514
max validation accuracy : 0.863837 max acc epoch : 4 test accuracy : 0.790361
Counter({2: 7319, 1: 6259, 0: 5268})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  192.01084126904607 Time :  1222
accuracy train: 0.947265 val: 0.881521 test: 0.810542
max validation accuracy : 0.881521 max acc epoch : 7 test accuracy : 0.810542
Counter({2: 7058, 1: 6257, 0: 5531})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  179.44252113439143 Time :  1319
accuracy train: 0.946676 val: 0.879752 test: 0.810409
max validation accuracy : 0.881521 max acc epoch : 7 test accuracy : 0.810542
Counter({2: 6897, 0: 6261, 1: 5688})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  167.03945837542415 Time :  1409
accuracy train: 0.955907 val: 0.879752 test: 0.813330
max validation accuracy : 0.881521 max acc epoch : 7 test accuracy : 0.810542
Counter({2: 6863, 1: 6299, 0: 5684})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  147.37622943613678 Time :  1507
accuracy train: 0.963960 val: 0.887710 test: 0.814657
max validation accuracy : 0.887710 max acc epoch : 10 test accuracy : 0.814657
Counter({0: 6761, 1: 6317, 2: 5768})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  140.2059192005545 Time :  1609
accuracy train: 0.970343 val: 0.893899 test: 0.818242
max validation accuracy : 0.893899 max acc epoch : 11 test accuracy : 0.818242
Counter({2: 6757, 0: 6311, 1: 5778})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  123.04548769351095 Time :  1722
accuracy train: 0.973485 val: 0.889478 test: 0.821030
max validation accuracy : 0.893899 max acc epoch : 11 test accuracy : 0.818242
Counter({1: 6759, 2: 6303, 0: 5784})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  99.88431273959577 Time :  1826
accuracy train: 0.981047 val: 0.900088 test: 0.822623
max validation accuracy : 0.900088 max acc epoch : 13 test accuracy : 0.822623
Counter({2: 6741, 0: 6312, 1: 5793})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  95.14491652185097 Time :  1928
accuracy train: 0.982127 val: 0.905393 test: 0.822491
max validation accuracy : 0.905393 max acc epoch : 14 test accuracy : 0.822491
Counter({2: 6716, 1: 6313, 0: 5817})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  89.54824323719367 Time :  2030
accuracy train: 0.984779 val: 0.901857 test: 0.825943
max validation accuracy : 0.905393 max acc epoch : 14 test accuracy : 0.822491
Counter({1: 6685, 2: 6335, 0: 5826})

Epoch :  16 loss training:  79.3346929308027 Time :  2138
accuracy train: 0.986644 val: 0.900973 test: 0.829660
max validation accuracy : 0.905393 max acc epoch : 14 test accuracy : 0.822491
Counter({2: 6654, 1: 6343, 0: 5849})

Epoch :  17 loss training:  73.0880579741206 Time :  2243
accuracy train: 0.988510 val: 0.910698 test: 0.828598
max validation accuracy : 0.910698 max acc epoch : 17 test accuracy : 0.828598
Counter({2: 6662, 1: 6343, 0: 5841})

Epoch :  18 loss training:  69.00517962430604 Time :  2355
accuracy train: 0.989885 val: 0.909814 test: 0.828996
max validation accuracy : 0.910698 max acc epoch : 17 test accuracy : 0.828598
Counter({2: 6667, 0: 6339, 1: 5840})

Epoch :  19 loss training:  68.01191926887259 Time :  2464
accuracy train: 0.991653 val: 0.906278 test: 0.831519
max validation accuracy : 0.910698 max acc epoch : 17 test accuracy : 0.828598
Counter({2: 6658, 1: 6342, 0: 5846})

Epoch :  20 loss training:  59.159227115567774 Time :  2574
accuracy train: 0.993126 val: 0.908046 test: 0.830722
max validation accuracy : 0.910698 max acc epoch : 17 test accuracy : 0.828598
Counter({0: 9781, 2: 7105, 1: 1960})

Epoch :  21 loss training:  58.986341886920854 Time :  2682
accuracy train: 0.994304 val: 0.908930 test: 0.834440
max validation accuracy : 0.910698 max acc epoch : 17 test accuracy : 0.828598
Counter({0: 9853, 2: 7041, 1: 1952})

Epoch :  22 loss training:  50.41380629641935 Time :  2789
accuracy train: 0.994697 val: 0.915119 test: 0.832847
max validation accuracy : 0.915119 max acc epoch : 22 test accuracy : 0.832847
Counter({1: 9838, 0: 7055, 2: 1953})

Epoch :  23 loss training:  48.598659868119285 Time :  2901
accuracy train: 0.994599 val: 0.910698 test: 0.834041
max validation accuracy : 0.915119 max acc epoch : 22 test accuracy : 0.832847
Counter({1: 9837, 0: 7057, 2: 1952})

Epoch :  24 loss training:  44.76631700480357 Time :  3013
accuracy train: 0.995581 val: 0.914235 test: 0.835104
max validation accuracy : 0.915119 max acc epoch : 22 test accuracy : 0.832847
Counter({0: 9840, 1: 7051, 2: 1955})

Epoch :  25 loss training:  43.490844087908044 Time :  3122
accuracy train: 0.996661 val: 0.913351 test: 0.834572
max validation accuracy : 0.915119 max acc epoch : 22 test accuracy : 0.832847
Counter({0: 9832, 2: 7062, 1: 1952})

Epoch :  26 loss training:  35.561145250918344 Time :  3225
accuracy train: 0.997250 val: 0.913351 test: 0.833643
max validation accuracy : 0.915119 max acc epoch : 22 test accuracy : 0.832847
Counter({2: 9835, 0: 7058, 1: 1953})

Epoch :  27 loss training:  33.704630083288066 Time :  3326
accuracy train: 0.998036 val: 0.916888 test: 0.836564
max validation accuracy : 0.916888 max acc epoch : 27 test accuracy : 0.836564
Counter({0: 9833, 1: 7058, 2: 1955})

Epoch :  28 loss training:  30.834139412851073 Time :  3430
accuracy train: 0.998331 val: 0.916888 test: 0.836830
max validation accuracy : 0.916888 max acc epoch : 27 test accuracy : 0.836564
Counter({1: 9837, 0: 7050, 2: 1959})

Epoch :  29 loss training:  29.25498725665966 Time :  3535
accuracy train: 0.998429 val: 0.916004 test: 0.838688
max validation accuracy : 0.916888 max acc epoch : 27 test accuracy : 0.836564
Counter({1: 7895, 2: 6896, 0: 4055})

Epoch :  30 loss training:  28.01940401014872 Time :  3634
accuracy train: 0.998527 val: 0.913351 test: 0.839883
max validation accuracy : 0.916888 max acc epoch : 27 test accuracy : 0.836564
Counter({1: 9831, 0: 7044, 2: 1971})

Epoch :  31 loss training:  26.625878100807313 Time :  3737
accuracy train: 0.999018 val: 0.920424 test: 0.839618
max validation accuracy : 0.920424 max acc epoch : 31 test accuracy : 0.839618
Counter({1: 9828, 2: 7046, 0: 1972})

Epoch :  32 loss training:  23.717077501351014 Time :  3840
accuracy train: 0.998920 val: 0.926614 test: 0.838290
max validation accuracy : 0.926614 max acc epoch : 32 test accuracy : 0.838290
Counter({1: 9830, 0: 7044, 2: 1972})

Epoch :  33 loss training:  21.409630583249964 Time :  3943
accuracy train: 0.999214 val: 0.921309 test: 0.839087
max validation accuracy : 0.926614 max acc epoch : 32 test accuracy : 0.838290
Counter({0: 9822, 1: 7051, 2: 1973})

Epoch :  34 loss training:  19.025667818496004 Time :  4040
accuracy train: 0.999018 val: 0.919540 test: 0.840414
max validation accuracy : 0.926614 max acc epoch : 32 test accuracy : 0.838290
Counter({2: 9817, 0: 7056, 1: 1973})

Epoch :  35 loss training:  17.55814560147701 Time :  4141
accuracy train: 0.999313 val: 0.921309 test: 0.841476
max validation accuracy : 0.926614 max acc epoch : 32 test accuracy : 0.838290
Counter({0: 9803, 2: 7075, 1: 1968})

Epoch :  36 loss training:  17.055569108662894 Time :  4242
accuracy train: 0.999411 val: 0.923077 test: 0.839087
max validation accuracy : 0.926614 max acc epoch : 32 test accuracy : 0.838290
Counter({2: 9819, 0: 7059, 1: 1968})

Epoch :  37 loss training:  17.154204178368673 Time :  4343
accuracy train: 0.999313 val: 0.919540 test: 0.843468
max validation accuracy : 0.926614 max acc epoch : 32 test accuracy : 0.838290
Counter({0: 9818, 1: 7058, 2: 1970})

Epoch :  38 loss training:  12.885116962890606 Time :  4449
accuracy train: 0.999509 val: 0.922193 test: 0.840414
max validation accuracy : 0.926614 max acc epoch : 32 test accuracy : 0.838290
Counter({0: 9810, 1: 7065, 2: 1971})

Epoch :  39 loss training:  14.266166850953596 Time :  4566
accuracy train: 0.999313 val: 0.922193 test: 0.842273
max validation accuracy : 0.926614 max acc epoch : 32 test accuracy : 0.838290
Counter({2: 9817, 0: 7059, 1: 1970})

Epoch :  40 loss training:  11.754427936044522 Time :  4682
accuracy train: 0.999313 val: 0.921309 test: 0.841742
max validation accuracy : 0.926614 max acc epoch : 32 test accuracy : 0.838290
Counter({0: 9814, 1: 7062, 2: 1970})

Epoch :  41 loss training:  13.85867575139855 Time :  4781
accuracy train: 0.999509 val: 0.929266 test: 0.844132
max validation accuracy : 0.929266 max acc epoch : 41 test accuracy : 0.844132
Counter({0: 9819, 1: 7057, 2: 1970})

Epoch :  42 loss training:  10.548238159703033 Time :  4882
accuracy train: 0.999313 val: 0.925729 test: 0.843070
max validation accuracy : 0.929266 max acc epoch : 41 test accuracy : 0.844132
Counter({1: 9818, 0: 7058, 2: 1970})

Epoch :  43 loss training:  12.345181786382454 Time :  4984
accuracy train: 0.999411 val: 0.927498 test: 0.839750
max validation accuracy : 0.929266 max acc epoch : 41 test accuracy : 0.844132
Counter({0: 9827, 1: 7047, 2: 1972})

Epoch :  44 loss training:  10.25993745776941 Time :  5096
accuracy train: 0.999214 val: 0.928382 test: 0.843999
max validation accuracy : 0.929266 max acc epoch : 41 test accuracy : 0.844132
Counter({2: 9841, 0: 7034, 1: 1971})

Epoch :  45 loss training:  9.527904845948797 Time :  5203
accuracy train: 0.999214 val: 0.924845 test: 0.841476
max validation accuracy : 0.929266 max acc epoch : 41 test accuracy : 0.844132
Counter({0: 9841, 2: 7036, 1: 1969})

Epoch :  46 loss training:  9.473966283221671 Time :  5306
accuracy train: 0.999116 val: 0.928382 test: 0.842671
max validation accuracy : 0.929266 max acc epoch : 41 test accuracy : 0.844132
Counter({0: 9828, 1: 7050, 2: 1968})

Epoch :  47 loss training:  9.850636259267048 Time :  5409
accuracy train: 0.999313 val: 0.929266 test: 0.843335
max validation accuracy : 0.929266 max acc epoch : 41 test accuracy : 0.844132
Counter({0: 9817, 2: 7061, 1: 1968})

Epoch :  48 loss training:  9.542723978978756 Time :  5510
accuracy train: 0.999313 val: 0.927498 test: 0.845194
max validation accuracy : 0.929266 max acc epoch : 41 test accuracy : 0.844132
Counter({1: 9819, 2: 7059, 0: 1968})

Epoch :  49 loss training:  7.487674892909126 Time :  5612
accuracy train: 0.999313 val: 0.927498 test: 0.844663
max validation accuracy : 0.929266 max acc epoch : 41 test accuracy : 0.844132
Counter({0: 9816, 1: 7065, 2: 1965})

Epoch :  50 loss training:  7.764238624287827 Time :  5714
accuracy train: 0.999313 val: 0.930150 test: 0.843335
max validation accuracy : 0.930150 max acc epoch : 50 test accuracy : 0.843335
Counter({0: 9830, 2: 7050, 1: 1966})

Epoch :  51 loss training:  7.455930025535054 Time :  5815
accuracy train: 0.999313 val: 0.930150 test: 0.844663
max validation accuracy : 0.930150 max acc epoch : 50 test accuracy : 0.843335
Counter({0: 9827, 2: 7052, 1: 1967})

Epoch :  52 loss training:  7.671802632030449 Time :  5932
accuracy train: 0.999313 val: 0.930150 test: 0.843866
max validation accuracy : 0.930150 max acc epoch : 50 test accuracy : 0.843335
Counter({0: 9839, 1: 7045, 2: 1962})

Epoch :  53 loss training:  7.372420363626588 Time :  6036
accuracy train: 0.999214 val: 0.931919 test: 0.844397
max validation accuracy : 0.931919 max acc epoch : 53 test accuracy : 0.844397
Counter({1: 9843, 0: 7043, 2: 1960})

Epoch :  54 loss training:  6.494982256535877 Time :  6141
accuracy train: 0.999313 val: 0.931034 test: 0.845327
max validation accuracy : 0.931919 max acc epoch : 53 test accuracy : 0.844397
Counter({1: 9843, 0: 7040, 2: 1963})

Epoch :  55 loss training:  6.2683040111660375 Time :  6248
accuracy train: 0.999313 val: 0.926614 test: 0.846256
max validation accuracy : 0.931919 max acc epoch : 53 test accuracy : 0.844397
Counter({0: 9836, 1: 7047, 2: 1963})

Epoch :  56 loss training:  5.341106207713892 Time :  6345
accuracy train: 0.999411 val: 0.929266 test: 0.845858
max validation accuracy : 0.931919 max acc epoch : 53 test accuracy : 0.844397
Counter({0: 9846, 2: 7036, 1: 1964})

Epoch :  57 loss training:  6.79972942135646 Time :  6450
accuracy train: 0.999411 val: 0.926614 test: 0.847318
max validation accuracy : 0.931919 max acc epoch : 53 test accuracy : 0.844397
Counter({1: 9840, 2: 7041, 0: 1965})

Epoch :  58 loss training:  5.5545496433842345 Time :  6553
accuracy train: 0.999214 val: 0.930150 test: 0.844796
max validation accuracy : 0.931919 max acc epoch : 53 test accuracy : 0.844397
Counter({1: 9852, 0: 7029, 2: 1965})

Epoch :  59 loss training:  5.363139008235521 Time :  6656
accuracy train: 0.999411 val: 0.927498 test: 0.849841
max validation accuracy : 0.931919 max acc epoch : 53 test accuracy : 0.844397
Counter({0: 9845, 1: 7037, 2: 1964})

Epoch :  60 loss training:  3.84121174543543 Time :  6755
accuracy train: 0.999411 val: 0.929266 test: 0.846654
max validation accuracy : 0.931919 max acc epoch : 53 test accuracy : 0.844397
Counter({2: 9865, 0: 7011, 1: 1970})

Epoch :  61 loss training:  6.084535862757548 Time :  6853
accuracy train: 0.999411 val: 0.933687 test: 0.847185
max validation accuracy : 0.933687 max acc epoch : 61 test accuracy : 0.847185
Counter({0: 9863, 1: 7011, 2: 1972})

Epoch :  62 loss training:  5.6607273754016205 Time :  6955
accuracy train: 0.999411 val: 0.930150 test: 0.844132
max validation accuracy : 0.933687 max acc epoch : 61 test accuracy : 0.847185
Counter({0: 7981, 2: 6852, 1: 4013})

Epoch :  63 loss training:  4.5658498377561045 Time :  7055
accuracy train: 0.999411 val: 0.929266 test: 0.848779
max validation accuracy : 0.933687 max acc epoch : 61 test accuracy : 0.847185
Counter({1: 9833, 0: 7034, 2: 1979})

Epoch :  64 loss training:  4.889032770850463 Time :  7158
accuracy train: 0.999509 val: 0.931034 test: 0.843202
max validation accuracy : 0.933687 max acc epoch : 61 test accuracy : 0.847185
Counter({1: 9859, 2: 7012, 0: 1975})

Epoch :  65 loss training:  4.920215231930342 Time :  7263
accuracy train: 0.999411 val: 0.932803 test: 0.847318
max validation accuracy : 0.933687 max acc epoch : 61 test accuracy : 0.847185
Counter({0: 9884, 2: 6988, 1: 1974})

Epoch :  66 loss training:  4.073627237070468 Time :  7368
accuracy train: 0.999313 val: 0.930150 test: 0.849973
max validation accuracy : 0.933687 max acc epoch : 61 test accuracy : 0.847185
Counter({0: 9923, 1: 6950, 2: 1973})

Epoch :  67 loss training:  4.399591052628239 Time :  7470
accuracy train: 0.999411 val: 0.931919 test: 0.849177
max validation accuracy : 0.933687 max acc epoch : 61 test accuracy : 0.847185
Counter({0: 9931, 2: 6946, 1: 1969})

Epoch :  68 loss training:  4.319714632271825 Time :  7571
accuracy train: 0.999411 val: 0.931919 test: 0.846256
max validation accuracy : 0.933687 max acc epoch : 61 test accuracy : 0.847185
Counter({0: 9925, 1: 6951, 2: 1970})

Epoch :  69 loss training:  3.68072191722149 Time :  7678
accuracy train: 0.999214 val: 0.931919 test: 0.844796
max validation accuracy : 0.933687 max acc epoch : 61 test accuracy : 0.847185
Counter({1: 9924, 2: 6954, 0: 1968})

Epoch :  70 loss training:  3.944033688876516 Time :  7782
accuracy train: 0.999411 val: 0.931919 test: 0.846389
max validation accuracy : 0.933687 max acc epoch : 61 test accuracy : 0.847185
Counter({1: 9918, 0: 6959, 2: 1969})

Epoch :  71 loss training:  2.9316258105027373 Time :  7884
accuracy train: 0.999313 val: 0.931034 test: 0.850903
max validation accuracy : 0.933687 max acc epoch : 61 test accuracy : 0.847185
Counter({1: 9915, 0: 6962, 2: 1969})

Epoch :  72 loss training:  3.1918484034649737 Time :  7984
accuracy train: 0.999411 val: 0.927498 test: 0.847849
max validation accuracy : 0.933687 max acc epoch : 61 test accuracy : 0.847185
Counter({2: 9917, 1: 6958, 0: 1971})

Epoch :  73 loss training:  2.676042007489741 Time :  8089
accuracy train: 0.999509 val: 0.927498 test: 0.845990
max validation accuracy : 0.933687 max acc epoch : 61 test accuracy : 0.847185
Counter({0: 9925, 1: 6950, 2: 1971})

Epoch :  74 loss training:  4.427088942061346 Time :  8196
accuracy train: 0.999313 val: 0.931034 test: 0.848513
max validation accuracy : 0.933687 max acc epoch : 61 test accuracy : 0.847185
Counter({0: 9924, 2: 6952, 1: 1970})

Epoch :  75 loss training:  3.3461082023168274 Time :  8310
accuracy train: 0.999509 val: 0.927498 test: 0.847318
max validation accuracy : 0.933687 max acc epoch : 61 test accuracy : 0.847185
Counter({0: 9911, 2: 6966, 1: 1969})

Epoch :  76 loss training:  3.254806539440324 Time :  8416
accuracy train: 0.999411 val: 0.931034 test: 0.849310
max validation accuracy : 0.933687 max acc epoch : 61 test accuracy : 0.847185
Counter({0: 9883, 1: 6992, 2: 1971})

Epoch :  77 loss training:  3.6994451216687594 Time :  8520
accuracy train: 0.999509 val: 0.926614 test: 0.845990
max validation accuracy : 0.933687 max acc epoch : 61 test accuracy : 0.847185
Counter({0: 9885, 1: 6990, 2: 1971})

Epoch :  78 loss training:  4.112992633897193 Time :  8624
accuracy train: 0.999313 val: 0.929266 test: 0.848247
max validation accuracy : 0.933687 max acc epoch : 61 test accuracy : 0.847185
Counter({2: 9886, 1: 6992, 0: 1968})

Epoch :  79 loss training:  3.1874280761549016 Time :  8720
accuracy train: 0.999411 val: 0.933687 test: 0.849177
max validation accuracy : 0.933687 max acc epoch : 61 test accuracy : 0.847185
Counter({1: 9878, 0: 6997, 2: 1971})

Epoch :  80 loss training:  2.4897800704156907 Time :  8822
accuracy train: 0.999313 val: 0.933687 test: 0.851832
max validation accuracy : 0.933687 max acc epoch : 61 test accuracy : 0.847185
Counter({2: 9844, 1: 7030, 0: 1972})

Epoch :  81 loss training:  2.373357903743454 Time :  8931
accuracy train: 0.999411 val: 0.935455 test: 0.851965
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({0: 9848, 1: 7026, 2: 1972})

Epoch :  82 loss training:  2.6901028687580038 Time :  9036
accuracy train: 0.999509 val: 0.931034 test: 0.851036
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({0: 9856, 2: 7019, 1: 1971})

Epoch :  83 loss training:  2.2547496277084065 Time :  9138
accuracy train: 0.999509 val: 0.926614 test: 0.850372
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({0: 9864, 1: 7016, 2: 1966})

Epoch :  84 loss training:  2.49793663781702 Time :  9247
accuracy train: 0.999411 val: 0.935455 test: 0.849044
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({1: 9849, 2: 7032, 0: 1965})

Epoch :  85 loss training:  3.3157956970335363 Time :  9342
accuracy train: 0.999411 val: 0.935455 test: 0.851036
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({1: 9842, 0: 7038, 2: 1966})

Epoch :  86 loss training:  2.394048622758419 Time :  9443
accuracy train: 0.999313 val: 0.934571 test: 0.851434
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({1: 9834, 0: 7041, 2: 1971})

Epoch :  87 loss training:  2.671417930849202 Time :  9556
accuracy train: 0.999411 val: 0.928382 test: 0.850770
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({0: 9831, 2: 7044, 1: 1971})

Epoch :  88 loss training:  2.5838429780269507 Time :  9658
accuracy train: 0.999411 val: 0.932803 test: 0.847318
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({0: 9816, 1: 7060, 2: 1970})

Epoch :  89 loss training:  2.5250628797139143 Time :  9757
accuracy train: 0.999509 val: 0.933687 test: 0.849044
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({2: 9808, 1: 7068, 0: 1970})

Epoch :  90 loss training:  2.635202174205915 Time :  9861
accuracy train: 0.999509 val: 0.931034 test: 0.850505
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({0: 9814, 2: 7063, 1: 1969})

Epoch :  91 loss training:  2.2016465074484586 Time :  9963
accuracy train: 0.999411 val: 0.931034 test: 0.850770
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({0: 9780, 1: 7098, 2: 1968})

Epoch :  92 loss training:  2.0730776937748487 Time :  10068
accuracy train: 0.999509 val: 0.932803 test: 0.847185
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({0: 9781, 2: 7099, 1: 1966})

Epoch :  93 loss training:  2.804251464014669 Time :  10167
accuracy train: 0.999607 val: 0.931034 test: 0.849310
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({0: 9791, 1: 7090, 2: 1965})

Epoch :  94 loss training:  2.442371396459748 Time :  10279
accuracy train: 0.999705 val: 0.931919 test: 0.849708
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({1: 9796, 0: 7085, 2: 1965})

Epoch :  95 loss training:  2.0709290439870074 Time :  10384
accuracy train: 0.999509 val: 0.929266 test: 0.849310
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({0: 7926, 1: 7026, 2: 3894})

Epoch :  96 loss training:  2.5967019237868953 Time :  10501
accuracy train: 0.999509 val: 0.932803 test: 0.851567
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({0: 7904, 1: 7024, 2: 3918})

Epoch :  97 loss training:  2.032980140523705 Time :  10601
accuracy train: 0.999607 val: 0.930150 test: 0.851699
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({0: 9748, 2: 7125, 1: 1973})

Epoch :  98 loss training:  2.199440575093149 Time :  10700
accuracy train: 0.999607 val: 0.929266 test: 0.849973
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({0: 9759, 2: 7117, 1: 1970})

Epoch :  99 loss training:  1.960634240571835 Time :  10802
accuracy train: 0.999313 val: 0.926614 test: 0.851832
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({2: 9754, 1: 7121, 0: 1971})

Epoch :  100 loss training:  1.7782066381946606 Time :  10904
accuracy train: 0.999509 val: 0.931919 test: 0.849841
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({2: 9747, 1: 7129, 0: 1970})

Epoch :  101 loss training:  2.1997917608250646 Time :  11007
accuracy train: 0.999411 val: 0.925729 test: 0.849177
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({0: 7889, 1: 7041, 2: 3916})

Epoch :  102 loss training:  2.135668804170791 Time :  11110
accuracy train: 0.999411 val: 0.931034 test: 0.853824
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({2: 9782, 1: 7082, 0: 1982})

Epoch :  103 loss training:  1.281576439039327 Time :  11211
accuracy train: 0.999607 val: 0.928382 test: 0.851699
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({1: 9779, 0: 7083, 2: 1984})

Epoch :  104 loss training:  1.897838623519874 Time :  11313
accuracy train: 0.999411 val: 0.929266 test: 0.849575
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({1: 9785, 0: 7080, 2: 1981})

Epoch :  105 loss training:  2.4620331279681977 Time :  11429
accuracy train: 0.999509 val: 0.931919 test: 0.853425
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({0: 9816, 1: 7051, 2: 1979})

Epoch :  106 loss training:  2.3683405421725183 Time :  11532
accuracy train: 0.999509 val: 0.927498 test: 0.851567
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({0: 9813, 2: 7056, 1: 1977})

Epoch :  107 loss training:  1.8568164759849424 Time :  11637
accuracy train: 0.999607 val: 0.932803 test: 0.851965
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({2: 9810, 0: 7059, 1: 1977})

Epoch :  108 loss training:  1.542421886019838 Time :  11739
accuracy train: 0.999509 val: 0.928382 test: 0.850903
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({1: 9829, 2: 7042, 0: 1975})

Epoch :  109 loss training:  1.5927352026417338 Time :  11845
accuracy train: 0.999607 val: 0.929266 test: 0.850637
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({0: 9833, 1: 7039, 2: 1974})

Epoch :  110 loss training:  1.307064448008532 Time :  11948
accuracy train: 0.999509 val: 0.934571 test: 0.851168
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({0: 9836, 2: 7037, 1: 1973})

Epoch :  111 loss training:  1.3734758068062547 Time :  12049
accuracy train: 0.999411 val: 0.932803 test: 0.849442
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({1: 9835, 0: 7038, 2: 1973})

Epoch :  112 loss training:  1.8917044566912864 Time :  12150
accuracy train: 0.999607 val: 0.928382 test: 0.850637
max validation accuracy : 0.935455 max acc epoch : 81 test accuracy : 0.851965
Counter({1: 9837, 0: 7036, 2: 1973})

========================================================================================================================================================================================================
best acc epoch :  81
validation accuracy :  0.9354553492484527
test accuracy :  0.8519649495485927
last test_accuracy :  0.8506372809346787
second best val :  0.9345711759504863
second best test :  0.8519649495485927
max gap 20
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=32, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=793, weight_decay=1e-10)
device :  cuda:0
Counter({0: 7565, 1: 6372, 2: 4909})

Epoch :  1 loss training:  671.3620712459087 Time :  12288
accuracy train: 0.810076 val: 0.781609 test: 0.734599
max validation accuracy : 0.781609 max acc epoch : 1 test accuracy : 0.734599
Counter({1: 10015, 0: 6836, 2: 1995})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  433.33134008944035 Time :  12391
accuracy train: 0.839635 val: 0.802829 test: 0.754912
max validation accuracy : 0.802829 max acc epoch : 2 test accuracy : 0.754912
Counter({0: 8753, 1: 8093, 2: 2000})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  374.819692581892 Time :  12493
accuracy train: 0.877541 val: 0.833775 test: 0.775093
max validation accuracy : 0.833775 max acc epoch : 3 test accuracy : 0.775093
Counter({2: 7227, 0: 6874, 1: 4745})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  274.9700980260968 Time :  12596
accuracy train: 0.907493 val: 0.863837 test: 0.792884
max validation accuracy : 0.863837 max acc epoch : 4 test accuracy : 0.792884
Counter({1: 7321, 2: 6835, 0: 4690})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  249.6575525617227 Time :  12695
accuracy train: 0.916822 val: 0.858532 test: 0.799257
max validation accuracy : 0.863837 max acc epoch : 4 test accuracy : 0.792884
Counter({1: 7384, 0: 6783, 2: 4679})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  227.067755935248 Time :  12826
accuracy train: 0.923304 val: 0.859416 test: 0.795141
max validation accuracy : 0.863837 max acc epoch : 4 test accuracy : 0.792884
Counter({0: 7568, 2: 6683, 1: 4595})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  191.20838397322223 Time :  12927
accuracy train: 0.945988 val: 0.885057 test: 0.810674
max validation accuracy : 0.885057 max acc epoch : 7 test accuracy : 0.810674
Counter({1: 7572, 0: 6692, 2: 4582})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  180.4610857712105 Time :  13029
accuracy train: 0.943926 val: 0.876216 test: 0.807488
max validation accuracy : 0.885057 max acc epoch : 7 test accuracy : 0.810674
Counter({0: 7568, 1: 6713, 2: 4565})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  164.6124000074342 Time :  13139
accuracy train: 0.951782 val: 0.889478 test: 0.809612
max validation accuracy : 0.889478 max acc epoch : 9 test accuracy : 0.809612
Counter({1: 7622, 0: 6732, 2: 4492})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  145.05561079271138 Time :  13240
accuracy train: 0.962781 val: 0.890363 test: 0.815587
max validation accuracy : 0.890363 max acc epoch : 10 test accuracy : 0.815587
Counter({0: 7652, 1: 6724, 2: 4470})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  135.9340111706406 Time :  13346
accuracy train: 0.972209 val: 0.896552 test: 0.820632
max validation accuracy : 0.896552 max acc epoch : 11 test accuracy : 0.820632
Counter({1: 7602, 0: 6784, 2: 4460})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  119.25383051938843 Time :  13451
accuracy train: 0.975351 val: 0.896552 test: 0.818773
max validation accuracy : 0.896552 max acc epoch : 11 test accuracy : 0.820632
Counter({1: 9844, 0: 7020, 2: 1982})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  103.4879762949422 Time :  13559
accuracy train: 0.981538 val: 0.901857 test: 0.822756
max validation accuracy : 0.901857 max acc epoch : 13 test accuracy : 0.822756
Counter({1: 9830, 0: 7034, 2: 1982})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  90.93927505239844 Time :  13659
accuracy train: 0.984680 val: 0.900088 test: 0.826606
max validation accuracy : 0.901857 max acc epoch : 13 test accuracy : 0.822756
Counter({2: 9822, 0: 7042, 1: 1982})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  84.94593473058194 Time :  13762
accuracy train: 0.984386 val: 0.895668 test: 0.825943
max validation accuracy : 0.901857 max acc epoch : 13 test accuracy : 0.822756
Counter({1: 9812, 0: 7055, 2: 1979})

Epoch :  16 loss training:  79.17354079522192 Time :  13869
accuracy train: 0.986841 val: 0.900088 test: 0.828731
max validation accuracy : 0.901857 max acc epoch : 13 test accuracy : 0.822756
Counter({0: 9814, 1: 7056, 2: 1976})

Epoch :  17 loss training:  70.94038711022586 Time :  13975
accuracy train: 0.989787 val: 0.902741 test: 0.828598
max validation accuracy : 0.902741 max acc epoch : 17 test accuracy : 0.828598
Counter({0: 9804, 1: 7067, 2: 1975})

Epoch :  18 loss training:  66.01806448819116 Time :  14084
accuracy train: 0.990474 val: 0.908046 test: 0.830988
max validation accuracy : 0.908046 max acc epoch : 18 test accuracy : 0.830988
Counter({1: 7858, 0: 6947, 2: 4041})

Epoch :  19 loss training:  63.686546626035124 Time :  14192
accuracy train: 0.992438 val: 0.908930 test: 0.830589
max validation accuracy : 0.908930 max acc epoch : 19 test accuracy : 0.830589
Counter({1: 7784, 0: 6973, 2: 4089})

Epoch :  20 loss training:  59.12208566139452 Time :  14313
accuracy train: 0.992831 val: 0.907162 test: 0.832183
max validation accuracy : 0.908930 max acc epoch : 19 test accuracy : 0.830589
Counter({1: 7748, 0: 7004, 2: 4094})

Epoch :  21 loss training:  52.95020908419974 Time :  14419
accuracy train: 0.993519 val: 0.910698 test: 0.834307
max validation accuracy : 0.910698 max acc epoch : 21 test accuracy : 0.834307
Counter({1: 9609, 0: 7255, 2: 1982})

Epoch :  22 loss training:  51.36241753399372 Time :  14538
accuracy train: 0.994402 val: 0.913351 test: 0.835502
max validation accuracy : 0.913351 max acc epoch : 22 test accuracy : 0.835502
Counter({0: 9602, 1: 7258, 2: 1986})

Epoch :  23 loss training:  48.56137464474887 Time :  14649
accuracy train: 0.994992 val: 0.913351 test: 0.833643
max validation accuracy : 0.913351 max acc epoch : 22 test accuracy : 0.835502
Counter({1: 9603, 0: 7260, 2: 1983})

Epoch :  24 loss training:  43.54109706997406 Time :  14749
accuracy train: 0.995875 val: 0.917772 test: 0.834971
max validation accuracy : 0.917772 max acc epoch : 24 test accuracy : 0.834971
Counter({1: 9599, 0: 7264, 2: 1983})

Epoch :  25 loss training:  40.36215860932134 Time :  14852
accuracy train: 0.996366 val: 0.909814 test: 0.835502
max validation accuracy : 0.917772 max acc epoch : 24 test accuracy : 0.834971
Counter({1: 9577, 0: 7291, 2: 1978})

Epoch :  26 loss training:  36.16665424045641 Time :  14957
accuracy train: 0.997250 val: 0.912467 test: 0.833643
max validation accuracy : 0.917772 max acc epoch : 24 test accuracy : 0.834971
Counter({0: 9561, 2: 7307, 1: 1978})

Epoch :  27 loss training:  33.03307754569687 Time :  15058
accuracy train: 0.998036 val: 0.919540 test: 0.838423
max validation accuracy : 0.919540 max acc epoch : 27 test accuracy : 0.838423
Counter({2: 9557, 0: 7311, 1: 1978})

Epoch :  28 loss training:  30.035429979790933 Time :  15166
accuracy train: 0.998134 val: 0.923961 test: 0.836830
max validation accuracy : 0.923961 max acc epoch : 28 test accuracy : 0.836830
Counter({0: 9547, 1: 7318, 2: 1981})

Epoch :  29 loss training:  28.630204319721088 Time :  15280
accuracy train: 0.998429 val: 0.919540 test: 0.838024
max validation accuracy : 0.923961 max acc epoch : 28 test accuracy : 0.836830
Counter({1: 9496, 0: 7369, 2: 1981})

Epoch :  30 loss training:  25.864543037721887 Time :  15387
accuracy train: 0.998527 val: 0.920424 test: 0.838821
max validation accuracy : 0.923961 max acc epoch : 28 test accuracy : 0.836830
Counter({1: 7457, 2: 7386, 0: 4003})

Epoch :  31 loss training:  23.905553766409867 Time :  15502
accuracy train: 0.998920 val: 0.921309 test: 0.838954
max validation accuracy : 0.923961 max acc epoch : 28 test accuracy : 0.836830
Counter({0: 9286, 2: 7572, 1: 1988})

Epoch :  32 loss training:  21.927226158499252 Time :  15609
accuracy train: 0.998822 val: 0.918656 test: 0.837626
max validation accuracy : 0.923961 max acc epoch : 28 test accuracy : 0.836830
Counter({0: 9294, 2: 7568, 1: 1984})

Epoch :  33 loss training:  20.337946214800468 Time :  15731
accuracy train: 0.998920 val: 0.922193 test: 0.840016
max validation accuracy : 0.923961 max acc epoch : 28 test accuracy : 0.836830
Counter({1: 9296, 0: 7568, 2: 1982})

Epoch :  34 loss training:  18.91453632916091 Time :  15836
accuracy train: 0.999214 val: 0.920424 test: 0.841875
max validation accuracy : 0.923961 max acc epoch : 28 test accuracy : 0.836830
Counter({0: 9282, 1: 7581, 2: 1983})

Epoch :  35 loss training:  16.174684123892803 Time :  15944
accuracy train: 0.999116 val: 0.923961 test: 0.843070
max validation accuracy : 0.923961 max acc epoch : 28 test accuracy : 0.836830
Counter({0: 9267, 2: 7597, 1: 1982})

Epoch :  36 loss training:  16.77739598872722 Time :  16048
accuracy train: 0.999018 val: 0.926614 test: 0.840149
max validation accuracy : 0.926614 max acc epoch : 36 test accuracy : 0.840149
Counter({1: 9286, 0: 7578, 2: 1982})

Epoch :  37 loss training:  15.191946169827133 Time :  16154
accuracy train: 0.999116 val: 0.923077 test: 0.843866
max validation accuracy : 0.926614 max acc epoch : 36 test accuracy : 0.840149
Counter({0: 9277, 1: 7589, 2: 1980})

Epoch :  38 loss training:  15.896280338260112 Time :  16264
accuracy train: 0.999214 val: 0.921309 test: 0.842804
max validation accuracy : 0.926614 max acc epoch : 36 test accuracy : 0.840149
Counter({1: 9264, 0: 7603, 2: 1979})

Epoch :  39 loss training:  14.073073710489552 Time :  16370
accuracy train: 0.999313 val: 0.925729 test: 0.843335
max validation accuracy : 0.926614 max acc epoch : 36 test accuracy : 0.840149
Counter({1: 9229, 0: 7638, 2: 1979})

Epoch :  40 loss training:  11.995215987844858 Time :  16474
accuracy train: 0.999214 val: 0.924845 test: 0.843335
max validation accuracy : 0.926614 max acc epoch : 36 test accuracy : 0.840149
Counter({1: 7560, 2: 7296, 0: 3990})

Epoch :  41 loss training:  11.413878594263224 Time :  16582
accuracy train: 0.999313 val: 0.928382 test: 0.845858
max validation accuracy : 0.928382 max acc epoch : 41 test accuracy : 0.845858
Counter({1: 7565, 2: 7287, 0: 3994})

Epoch :  42 loss training:  12.01431080783368 Time :  16689
accuracy train: 0.999116 val: 0.926614 test: 0.844264
max validation accuracy : 0.928382 max acc epoch : 41 test accuracy : 0.845858
Counter({0: 7564, 1: 7267, 2: 4015})

Epoch :  43 loss training:  12.903586940417881 Time :  16787
accuracy train: 0.999214 val: 0.927498 test: 0.845459
max validation accuracy : 0.928382 max acc epoch : 41 test accuracy : 0.845858
Counter({0: 7596, 1: 7220, 2: 4030})

Epoch :  44 loss training:  9.83488668530481 Time :  16891
accuracy train: 0.999313 val: 0.929266 test: 0.843070
max validation accuracy : 0.929266 max acc epoch : 44 test accuracy : 0.843070
Counter({2: 7629, 0: 7182, 1: 4035})

Epoch :  45 loss training:  8.597186673585384 Time :  16992
accuracy train: 0.999313 val: 0.930150 test: 0.843999
max validation accuracy : 0.930150 max acc epoch : 45 test accuracy : 0.843999
Counter({2: 7626, 1: 7183, 0: 4037})

Epoch :  46 loss training:  10.351531695476297 Time :  17125
accuracy train: 0.999116 val: 0.928382 test: 0.847584
max validation accuracy : 0.930150 max acc epoch : 45 test accuracy : 0.843999
Counter({0: 7627, 2: 7183, 1: 4036})

Epoch :  47 loss training:  9.291333467648656 Time :  17235
accuracy train: 0.999116 val: 0.927498 test: 0.847584
max validation accuracy : 0.930150 max acc epoch : 45 test accuracy : 0.843999
Counter({1: 7630, 0: 7180, 2: 4036})

Epoch :  48 loss training:  6.331130664257216 Time :  17338
accuracy train: 0.999214 val: 0.929266 test: 0.849575
max validation accuracy : 0.930150 max acc epoch : 45 test accuracy : 0.843999
Counter({2: 7633, 1: 7176, 0: 4037})

Epoch :  49 loss training:  7.584769686582149 Time :  17438
accuracy train: 0.999411 val: 0.929266 test: 0.845459
max validation accuracy : 0.930150 max acc epoch : 45 test accuracy : 0.843999
Counter({0: 7670, 1: 7145, 2: 4031})

Epoch :  50 loss training:  7.037264966234943 Time :  17544
accuracy train: 0.999411 val: 0.931034 test: 0.848646
max validation accuracy : 0.931034 max acc epoch : 50 test accuracy : 0.848646
Counter({0: 7684, 1: 7125, 2: 4037})

Epoch :  51 loss training:  7.095370778508368 Time :  17644
accuracy train: 0.999411 val: 0.934571 test: 0.846256
max validation accuracy : 0.934571 max acc epoch : 51 test accuracy : 0.846256
Counter({1: 7682, 0: 7127, 2: 4037})

Epoch :  52 loss training:  7.652916062485019 Time :  17751
accuracy train: 0.999313 val: 0.927498 test: 0.846256
max validation accuracy : 0.934571 max acc epoch : 51 test accuracy : 0.846256
Counter({2: 7673, 0: 7127, 1: 4046})

Epoch :  53 loss training:  6.354666971463303 Time :  17863
accuracy train: 0.999313 val: 0.927498 test: 0.849841
max validation accuracy : 0.934571 max acc epoch : 51 test accuracy : 0.846256
Counter({0: 7664, 2: 7135, 1: 4047})

Epoch :  54 loss training:  5.6197248120734 Time :  17970
accuracy train: 0.999411 val: 0.931034 test: 0.850770
max validation accuracy : 0.934571 max acc epoch : 51 test accuracy : 0.846256
Counter({1: 7668, 0: 7124, 2: 4054})

Epoch :  55 loss training:  6.485713727353868 Time :  18072
accuracy train: 0.999313 val: 0.930150 test: 0.851301
max validation accuracy : 0.934571 max acc epoch : 51 test accuracy : 0.846256
Counter({0: 7668, 1: 7124, 2: 4054})

Epoch :  56 loss training:  6.63113323370635 Time :  18179
accuracy train: 0.999313 val: 0.928382 test: 0.851965
max validation accuracy : 0.934571 max acc epoch : 51 test accuracy : 0.846256
Counter({0: 7669, 1: 7125, 2: 4052})

Epoch :  57 loss training:  5.510788057843456 Time :  18284
accuracy train: 0.999509 val: 0.935455 test: 0.850505
max validation accuracy : 0.935455 max acc epoch : 57 test accuracy : 0.850505
Counter({2: 7655, 0: 7131, 1: 4060})

Epoch :  58 loss training:  5.690626061797957 Time :  18382
accuracy train: 0.999411 val: 0.933687 test: 0.845459
max validation accuracy : 0.935455 max acc epoch : 57 test accuracy : 0.850505
Counter({0: 7673, 2: 7110, 1: 4063})

Epoch :  59 loss training:  4.916710916426382 Time :  18483
accuracy train: 0.999509 val: 0.930150 test: 0.849442
max validation accuracy : 0.935455 max acc epoch : 57 test accuracy : 0.850505
Counter({2: 7673, 0: 7110, 1: 4063})

Epoch :  60 loss training:  5.694227558276907 Time :  18591
accuracy train: 0.999313 val: 0.933687 test: 0.848115
max validation accuracy : 0.935455 max acc epoch : 57 test accuracy : 0.850505
Counter({0: 7673, 1: 7113, 2: 4060})

Epoch :  61 loss training:  4.565004399923055 Time :  18697
accuracy train: 0.999214 val: 0.927498 test: 0.849841
max validation accuracy : 0.935455 max acc epoch : 57 test accuracy : 0.850505
Counter({0: 7663, 2: 7120, 1: 4063})

Epoch :  62 loss training:  4.493402986954607 Time :  18803
accuracy train: 0.999313 val: 0.934571 test: 0.849044
max validation accuracy : 0.935455 max acc epoch : 57 test accuracy : 0.850505
Counter({2: 7680, 0: 7099, 1: 4067})

Epoch :  63 loss training:  4.535820392185997 Time :  18906
accuracy train: 0.999411 val: 0.931034 test: 0.852098
max validation accuracy : 0.935455 max acc epoch : 57 test accuracy : 0.850505
Counter({0: 7690, 2: 7092, 1: 4064})

Epoch :  64 loss training:  4.752408957112493 Time :  19009
accuracy train: 0.999411 val: 0.932803 test: 0.850637
max validation accuracy : 0.935455 max acc epoch : 57 test accuracy : 0.850505
Counter({0: 7697, 2: 7087, 1: 4062})

Epoch :  65 loss training:  3.7216562535304547 Time :  19112
accuracy train: 0.999313 val: 0.930150 test: 0.846389
max validation accuracy : 0.935455 max acc epoch : 57 test accuracy : 0.850505
Counter({1: 7722, 2: 7074, 0: 4050})

Epoch :  66 loss training:  4.278026892872731 Time :  19213
accuracy train: 0.999509 val: 0.929266 test: 0.848646
max validation accuracy : 0.935455 max acc epoch : 57 test accuracy : 0.850505
Counter({0: 7721, 1: 7079, 2: 4046})

Epoch :  67 loss training:  4.3159991340689885 Time :  19315
accuracy train: 0.999509 val: 0.931034 test: 0.851567
max validation accuracy : 0.935455 max acc epoch : 57 test accuracy : 0.850505
Counter({2: 7730, 0: 7072, 1: 4044})

Epoch :  68 loss training:  4.472732214113421 Time :  19425
accuracy train: 0.999214 val: 0.931034 test: 0.849841
max validation accuracy : 0.935455 max acc epoch : 57 test accuracy : 0.850505
Counter({1: 7726, 0: 7086, 2: 4034})

Epoch :  69 loss training:  3.7982239069260686 Time :  19528
accuracy train: 0.999313 val: 0.928382 test: 0.849442
max validation accuracy : 0.935455 max acc epoch : 57 test accuracy : 0.850505
Counter({0: 7728, 1: 7085, 2: 4033})

Epoch :  70 loss training:  3.3412850986733247 Time :  19635
accuracy train: 0.999509 val: 0.933687 test: 0.850106
max validation accuracy : 0.935455 max acc epoch : 57 test accuracy : 0.850505
Counter({1: 7733, 2: 7079, 0: 4034})

Epoch :  71 loss training:  3.908091023495217 Time :  19738
accuracy train: 0.999411 val: 0.938992 test: 0.848646
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({0: 7729, 1: 7081, 2: 4036})

Epoch :  72 loss training:  3.804422514811449 Time :  19840
accuracy train: 0.999509 val: 0.931034 test: 0.846522
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({1: 7751, 0: 7042, 2: 4053})

Epoch :  73 loss training:  3.046614623905043 Time :  19938
accuracy train: 0.999411 val: 0.935455 test: 0.852363
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({2: 7757, 1: 7051, 0: 4038})

Epoch :  74 loss training:  3.1295303641654755 Time :  20039
accuracy train: 0.999411 val: 0.931034 test: 0.850903
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({0: 7776, 2: 7025, 1: 4045})

Epoch :  75 loss training:  3.1609740175381376 Time :  20156
accuracy train: 0.999313 val: 0.933687 test: 0.851699
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({0: 7772, 1: 7019, 2: 4055})

Epoch :  76 loss training:  2.5450544183822785 Time :  20263
accuracy train: 0.999411 val: 0.935455 test: 0.851567
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({2: 7770, 0: 7026, 1: 4050})

Epoch :  77 loss training:  2.807847138638863 Time :  20368
accuracy train: 0.999509 val: 0.931919 test: 0.847451
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({2: 7781, 0: 7001, 1: 4064})

Epoch :  78 loss training:  3.513777098843093 Time :  20471
accuracy train: 0.999411 val: 0.931919 test: 0.850505
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({1: 7794, 0: 6985, 2: 4067})

Epoch :  79 loss training:  3.4520109242384933 Time :  20575
accuracy train: 0.999509 val: 0.931919 test: 0.850372
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({1: 7816, 0: 6979, 2: 4051})

Epoch :  80 loss training:  2.8857986398766116 Time :  20675
accuracy train: 0.999509 val: 0.938108 test: 0.849310
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({2: 7812, 0: 6988, 1: 4046})

Epoch :  81 loss training:  3.3421473330586196 Time :  20783
accuracy train: 0.999607 val: 0.924845 test: 0.847053
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({2: 7810, 0: 6973, 1: 4063})

Epoch :  82 loss training:  3.4647666344199024 Time :  20887
accuracy train: 0.999411 val: 0.931034 test: 0.846920
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({0: 7814, 2: 6966, 1: 4066})

Epoch :  83 loss training:  2.0996689118328504 Time :  20991
accuracy train: 0.999411 val: 0.929266 test: 0.848911
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({0: 7826, 2: 6958, 1: 4062})

Epoch :  84 loss training:  3.1267360981528327 Time :  21098
accuracy train: 0.999411 val: 0.933687 test: 0.852230
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({2: 7831, 0: 6948, 1: 4067})

Epoch :  85 loss training:  2.912126602589524 Time :  21200
accuracy train: 0.999411 val: 0.931919 test: 0.851965
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({1: 7838, 0: 6948, 2: 4060})

Epoch :  86 loss training:  2.588428988022315 Time :  21305
accuracy train: 0.999607 val: 0.928382 test: 0.849177
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({2: 7837, 1: 6951, 0: 4058})

Epoch :  87 loss training:  3.007581372879031 Time :  21406
accuracy train: 0.999411 val: 0.931034 test: 0.850106
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({2: 7825, 0: 6960, 1: 4061})

Epoch :  88 loss training:  2.0122447508770165 Time :  21513
accuracy train: 0.999411 val: 0.933687 test: 0.847053
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({2: 7825, 0: 6961, 1: 4060})

Epoch :  89 loss training:  2.1488779152477946 Time :  21618
accuracy train: 0.999509 val: 0.933687 test: 0.848779
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({0: 7829, 1: 6943, 2: 4074})

Epoch :  90 loss training:  2.456949058486316 Time :  21732
accuracy train: 0.999411 val: 0.927498 test: 0.846256
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({0: 7841, 1: 6936, 2: 4069})

Epoch :  91 loss training:  2.5402726369998163 Time :  21836
accuracy train: 0.999411 val: 0.931919 test: 0.849177
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({2: 7837, 1: 6943, 0: 4066})

Epoch :  92 loss training:  2.2229485369907707 Time :  21937
accuracy train: 0.999411 val: 0.932803 test: 0.851699
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({1: 7849, 0: 6936, 2: 4061})

Epoch :  93 loss training:  2.138719971562523 Time :  22039
accuracy train: 0.999607 val: 0.932803 test: 0.852762
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({0: 7842, 1: 6942, 2: 4062})

Epoch :  94 loss training:  1.7677040102398678 Time :  22146
accuracy train: 0.999313 val: 0.931034 test: 0.851434
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({1: 7845, 2: 6939, 0: 4062})

Epoch :  95 loss training:  2.206402196669842 Time :  22259
accuracy train: 0.999509 val: 0.931919 test: 0.849575
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({2: 7856, 0: 6937, 1: 4053})

Epoch :  96 loss training:  2.3042052571366867 Time :  22365
accuracy train: 0.999607 val: 0.927498 test: 0.852363
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({0: 7848, 2: 6943, 1: 4055})

Epoch :  97 loss training:  1.7279679993766877 Time :  22479
accuracy train: 0.999411 val: 0.929266 test: 0.850372
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({2: 7859, 0: 6935, 1: 4052})

Epoch :  98 loss training:  2.2352741846302706 Time :  22592
accuracy train: 0.999705 val: 0.931034 test: 0.849841
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({0: 7858, 1: 6935, 2: 4053})

Epoch :  99 loss training:  2.02779241750477 Time :  22707
accuracy train: 0.999116 val: 0.931919 test: 0.851434
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({1: 7855, 0: 6938, 2: 4053})

Epoch :  100 loss training:  2.3730607585966936 Time :  22817
accuracy train: 0.999607 val: 0.932803 test: 0.851168
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({0: 7878, 1: 6920, 2: 4048})

Epoch :  101 loss training:  2.2660609520289654 Time :  22923
accuracy train: 0.999411 val: 0.932803 test: 0.848911
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({0: 7876, 1: 6922, 2: 4048})

Epoch :  102 loss training:  2.5561148659530772 Time :  23027
accuracy train: 0.999313 val: 0.933687 test: 0.847982
max validation accuracy : 0.938992 max acc epoch : 71 test accuracy : 0.848646
Counter({1: 7875, 0: 6926, 2: 4045})

========================================================================================================================================================================================================
best acc epoch :  71
validation accuracy :  0.9389920424403183
test accuracy :  0.8486457780138078
last test_accuracy :  0.8479819437068508
second best val :  0.9381078691423519
second best test :  0.8486457780138078
max gap 14
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=32, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=793, weight_decay=1e-10)
device :  cuda:0
Counter({0: 7565, 1: 6372, 2: 4909})

Epoch :  1 loss training:  672.5561490803957 Time :  23158
accuracy train: 0.808995 val: 0.787798 test: 0.730616
max validation accuracy : 0.787798 max acc epoch : 1 test accuracy : 0.730616
Counter({2: 7291, 0: 6616, 1: 4939})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  437.85035710036755 Time :  23260
accuracy train: 0.836983 val: 0.795756 test: 0.746946
max validation accuracy : 0.795756 max acc epoch : 2 test accuracy : 0.746946
Counter({1: 6774, 2: 6758, 0: 5314})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  385.9863720536232 Time :  23373
accuracy train: 0.874988 val: 0.819629 test: 0.776022
max validation accuracy : 0.819629 max acc epoch : 3 test accuracy : 0.776022
Counter({1: 6600, 0: 6362, 2: 5884})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  277.80519644171 Time :  23474
accuracy train: 0.904841 val: 0.866490 test: 0.785183
max validation accuracy : 0.866490 max acc epoch : 4 test accuracy : 0.785183
Counter({1: 6548, 0: 6390, 2: 5908})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  253.10571197606623 Time :  23579
accuracy train: 0.915251 val: 0.858532 test: 0.798460
max validation accuracy : 0.866490 max acc epoch : 4 test accuracy : 0.785183
Counter({2: 6625, 0: 6481, 1: 5740})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  231.8868249533698 Time :  23676
accuracy train: 0.918983 val: 0.859416 test: 0.794211
max validation accuracy : 0.866490 max acc epoch : 4 test accuracy : 0.785183
Counter({0: 6590, 2: 6560, 1: 5696})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  193.95474389754236 Time :  23777
accuracy train: 0.948149 val: 0.885057 test: 0.806957
max validation accuracy : 0.885057 max acc epoch : 7 test accuracy : 0.806957
Counter({0: 6592, 2: 6513, 1: 5741})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  180.33666883409023 Time :  23879
accuracy train: 0.942551 val: 0.881521 test: 0.806957
max validation accuracy : 0.885057 max acc epoch : 7 test accuracy : 0.806957
Counter({1: 6577, 2: 6469, 0: 5800})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  167.15498619899154 Time :  23977
accuracy train: 0.953059 val: 0.887710 test: 0.808152
max validation accuracy : 0.887710 max acc epoch : 9 test accuracy : 0.808152
Counter({2: 6601, 0: 6555, 1: 5690})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  146.7388270199299 Time :  24078
accuracy train: 0.962094 val: 0.890363 test: 0.812002
max validation accuracy : 0.890363 max acc epoch : 10 test accuracy : 0.812002
Counter({1: 6595, 0: 6524, 2: 5727})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  141.05225935019553 Time :  24179
accuracy train: 0.970343 val: 0.890363 test: 0.819039
max validation accuracy : 0.890363 max acc epoch : 10 test accuracy : 0.812002
Counter({1: 6542, 2: 6447, 0: 5857})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  120.5381667278707 Time :  24283
accuracy train: 0.974271 val: 0.891247 test: 0.822623
max validation accuracy : 0.891247 max acc epoch : 12 test accuracy : 0.822623
Counter({1: 6462, 0: 6456, 2: 5928})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  102.87458837311715 Time :  24385
accuracy train: 0.978690 val: 0.895668 test: 0.825412
max validation accuracy : 0.895668 max acc epoch : 13 test accuracy : 0.825412
Counter({1: 6459, 2: 6457, 0: 5930})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  96.42786223022267 Time :  24495
accuracy train: 0.982618 val: 0.904509 test: 0.827138
max validation accuracy : 0.904509 max acc epoch : 14 test accuracy : 0.827138
Counter({0: 6461, 2: 6458, 1: 5927})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  87.22120672278106 Time :  24599
accuracy train: 0.984386 val: 0.894783 test: 0.828067
max validation accuracy : 0.904509 max acc epoch : 14 test accuracy : 0.827138
Counter({0: 6472, 2: 6439, 1: 5935})

Epoch :  16 loss training:  79.26911834510975 Time :  24716
accuracy train: 0.985662 val: 0.901857 test: 0.829926
max validation accuracy : 0.904509 max acc epoch : 14 test accuracy : 0.827138
Counter({1: 6470, 2: 6442, 0: 5934})

Epoch :  17 loss training:  75.12365151243284 Time :  24817
accuracy train: 0.988707 val: 0.903625 test: 0.830324
max validation accuracy : 0.904509 max acc epoch : 14 test accuracy : 0.827138
Counter({2: 6437, 0: 6430, 1: 5979})

Epoch :  18 loss training:  68.80921665439382 Time :  24924
accuracy train: 0.989689 val: 0.900973 test: 0.830457
max validation accuracy : 0.904509 max acc epoch : 14 test accuracy : 0.827138
Counter({2: 6457, 1: 6409, 0: 5980})

Epoch :  19 loss training:  66.74563241680153 Time :  25030
accuracy train: 0.991358 val: 0.906278 test: 0.830855
max validation accuracy : 0.906278 max acc epoch : 19 test accuracy : 0.830855
Counter({0: 6466, 2: 6396, 1: 5984})

Epoch :  20 loss training:  61.23559320648201 Time :  25137
accuracy train: 0.992537 val: 0.903625 test: 0.833776
max validation accuracy : 0.906278 max acc epoch : 19 test accuracy : 0.830855
Counter({1: 6452, 0: 6412, 2: 5982})

Epoch :  21 loss training:  58.82871583336964 Time :  25244
accuracy train: 0.994108 val: 0.907162 test: 0.834440
max validation accuracy : 0.907162 max acc epoch : 21 test accuracy : 0.834440
Counter({2: 6453, 0: 6397, 1: 5996})

Epoch :  22 loss training:  50.69503768370487 Time :  25349
accuracy train: 0.995286 val: 0.907162 test: 0.833776
max validation accuracy : 0.907162 max acc epoch : 21 test accuracy : 0.834440
Counter({1: 9781, 0: 7090, 2: 1975})

Epoch :  23 loss training:  45.50057728821412 Time :  25450
accuracy train: 0.994795 val: 0.908930 test: 0.837228
max validation accuracy : 0.908930 max acc epoch : 23 test accuracy : 0.837228
Counter({2: 9786, 0: 7091, 1: 1969})

Epoch :  24 loss training:  43.972196825779974 Time :  25565
accuracy train: 0.996759 val: 0.913351 test: 0.840813
max validation accuracy : 0.913351 max acc epoch : 24 test accuracy : 0.840813
Counter({1: 9790, 0: 7088, 2: 1968})

Epoch :  25 loss training:  41.78805913589895 Time :  25667
accuracy train: 0.997250 val: 0.910698 test: 0.839087
max validation accuracy : 0.913351 max acc epoch : 24 test accuracy : 0.840813
Counter({1: 9775, 0: 7103, 2: 1968})

Epoch :  26 loss training:  36.304560716147535 Time :  25775
accuracy train: 0.996563 val: 0.913351 test: 0.837892
max validation accuracy : 0.913351 max acc epoch : 24 test accuracy : 0.840813
Counter({1: 9778, 0: 7101, 2: 1967})

Epoch :  27 loss training:  34.3048287089041 Time :  25880
accuracy train: 0.997545 val: 0.920424 test: 0.841476
max validation accuracy : 0.920424 max acc epoch : 27 test accuracy : 0.841476
Counter({2: 9779, 0: 7101, 1: 1966})

Epoch :  28 loss training:  32.22155404090881 Time :  25982
accuracy train: 0.997643 val: 0.916004 test: 0.840016
max validation accuracy : 0.920424 max acc epoch : 27 test accuracy : 0.841476
Counter({1: 9770, 0: 7112, 2: 1964})

Epoch :  29 loss training:  30.059000524925068 Time :  26087
accuracy train: 0.997938 val: 0.916888 test: 0.840680
max validation accuracy : 0.920424 max acc epoch : 27 test accuracy : 0.841476
Counter({0: 9765, 1: 7116, 2: 1965})

Epoch :  30 loss training:  27.481716095819138 Time :  26187
accuracy train: 0.998723 val: 0.920424 test: 0.842937
max validation accuracy : 0.920424 max acc epoch : 27 test accuracy : 0.841476
Counter({2: 9725, 0: 7160, 1: 1961})

Epoch :  31 loss training:  24.674857255537063 Time :  26291
accuracy train: 0.998429 val: 0.924845 test: 0.840813
max validation accuracy : 0.924845 max acc epoch : 31 test accuracy : 0.840813
Counter({0: 7690, 2: 6976, 1: 4180})

Epoch :  32 loss training:  25.529927043418866 Time :  26393
accuracy train: 0.998625 val: 0.920424 test: 0.840281
max validation accuracy : 0.924845 max acc epoch : 31 test accuracy : 0.840813
Counter({1: 9695, 0: 7173, 2: 1978})

Epoch :  33 loss training:  21.7686593842227 Time :  26507
accuracy train: 0.999018 val: 0.922193 test: 0.841875
max validation accuracy : 0.924845 max acc epoch : 31 test accuracy : 0.840813
Counter({0: 9690, 1: 7184, 2: 1972})

Epoch :  34 loss training:  19.556767111367662 Time :  26613
accuracy train: 0.998920 val: 0.916888 test: 0.842804
max validation accuracy : 0.924845 max acc epoch : 31 test accuracy : 0.840813
Counter({2: 9674, 0: 7202, 1: 1970})

Epoch :  35 loss training:  18.07734000540222 Time :  26719
accuracy train: 0.999214 val: 0.917772 test: 0.837892
max validation accuracy : 0.924845 max acc epoch : 31 test accuracy : 0.840813
Counter({0: 9634, 2: 7243, 1: 1969})

Epoch :  36 loss training:  17.982766278204508 Time :  26830
accuracy train: 0.999116 val: 0.925729 test: 0.842140
max validation accuracy : 0.925729 max acc epoch : 36 test accuracy : 0.842140
Counter({0: 9625, 2: 7257, 1: 1964})

Epoch :  37 loss training:  17.82839516591048 Time :  26937
accuracy train: 0.999214 val: 0.921309 test: 0.841609
max validation accuracy : 0.925729 max acc epoch : 36 test accuracy : 0.842140
Counter({0: 9608, 2: 7274, 1: 1964})

Epoch :  38 loss training:  13.994363006902859 Time :  27040
accuracy train: 0.999214 val: 0.921309 test: 0.845194
max validation accuracy : 0.925729 max acc epoch : 36 test accuracy : 0.842140
Counter({1: 9547, 2: 7335, 0: 1964})

Epoch :  39 loss training:  14.467923587944824 Time :  27146
accuracy train: 0.999411 val: 0.923077 test: 0.844663
max validation accuracy : 0.925729 max acc epoch : 36 test accuracy : 0.842140
Counter({1: 9551, 0: 7330, 2: 1965})

Epoch :  40 loss training:  12.706438214656373 Time :  27267
accuracy train: 0.999313 val: 0.921309 test: 0.845194
max validation accuracy : 0.925729 max acc epoch : 36 test accuracy : 0.842140
Counter({0: 9548, 2: 7332, 1: 1966})

Epoch :  41 loss training:  12.630729766839067 Time :  27375
accuracy train: 0.999411 val: 0.923961 test: 0.845990
max validation accuracy : 0.925729 max acc epoch : 36 test accuracy : 0.842140
Counter({2: 9553, 0: 7325, 1: 1968})

Epoch :  42 loss training:  11.287328972990508 Time :  27510
accuracy train: 0.999214 val: 0.923077 test: 0.846920
max validation accuracy : 0.925729 max acc epoch : 36 test accuracy : 0.842140
Counter({2: 9559, 1: 7320, 0: 1967})

Epoch :  43 loss training:  10.511994449043414 Time :  27630
accuracy train: 0.999313 val: 0.924845 test: 0.844264
max validation accuracy : 0.925729 max acc epoch : 36 test accuracy : 0.842140
Counter({2: 9562, 1: 7316, 0: 1968})

Epoch :  44 loss training:  10.192992388329003 Time :  27735
accuracy train: 0.999214 val: 0.926614 test: 0.844264
max validation accuracy : 0.926614 max acc epoch : 44 test accuracy : 0.844264
Counter({0: 9541, 2: 7337, 1: 1968})

Epoch :  45 loss training:  9.994305158383213 Time :  27838
accuracy train: 0.999313 val: 0.928382 test: 0.843070
max validation accuracy : 0.928382 max acc epoch : 45 test accuracy : 0.843070
Counter({0: 9549, 1: 7332, 2: 1965})

Epoch :  46 loss training:  8.793454775841383 Time :  27943
accuracy train: 0.999313 val: 0.926614 test: 0.845592
max validation accuracy : 0.928382 max acc epoch : 45 test accuracy : 0.843070
Counter({1: 9550, 0: 7330, 2: 1966})

Epoch :  47 loss training:  9.205045394570334 Time :  28051
accuracy train: 0.999411 val: 0.927498 test: 0.848247
max validation accuracy : 0.928382 max acc epoch : 45 test accuracy : 0.843070
Counter({2: 9554, 0: 7325, 1: 1967})

Epoch :  48 loss training:  9.155922997830203 Time :  28151
accuracy train: 0.999313 val: 0.922193 test: 0.846522
max validation accuracy : 0.928382 max acc epoch : 45 test accuracy : 0.843070
Counter({1: 9549, 0: 7330, 2: 1967})

Epoch :  49 loss training:  8.082368492425303 Time :  28255
accuracy train: 0.999411 val: 0.928382 test: 0.846256
max validation accuracy : 0.928382 max acc epoch : 45 test accuracy : 0.843070
Counter({1: 9535, 2: 7343, 0: 1968})

Epoch :  50 loss training:  7.648486169026 Time :  28363
accuracy train: 0.999411 val: 0.927498 test: 0.846920
max validation accuracy : 0.928382 max acc epoch : 45 test accuracy : 0.843070
Counter({1: 9518, 2: 7359, 0: 1969})

Epoch :  51 loss training:  7.316909921057231 Time :  28468
accuracy train: 0.999411 val: 0.931034 test: 0.843468
max validation accuracy : 0.931034 max acc epoch : 51 test accuracy : 0.843468
Counter({0: 9499, 1: 7380, 2: 1967})

Epoch :  52 loss training:  7.88546226946346 Time :  28574
accuracy train: 0.999313 val: 0.929266 test: 0.845194
max validation accuracy : 0.931034 max acc epoch : 51 test accuracy : 0.843468
Counter({2: 9501, 0: 7380, 1: 1965})

Epoch :  53 loss training:  8.333910710789496 Time :  28692
accuracy train: 0.999411 val: 0.930150 test: 0.846389
max validation accuracy : 0.931034 max acc epoch : 51 test accuracy : 0.843468
Counter({1: 9480, 0: 7403, 2: 1963})

Epoch :  54 loss training:  5.699681910562504 Time :  28801
accuracy train: 0.999313 val: 0.931919 test: 0.851036
max validation accuracy : 0.931919 max acc epoch : 54 test accuracy : 0.851036
Counter({1: 9475, 0: 7406, 2: 1965})

Epoch :  55 loss training:  5.833860819700931 Time :  28908
accuracy train: 0.999214 val: 0.925729 test: 0.846787
max validation accuracy : 0.931919 max acc epoch : 54 test accuracy : 0.851036
Counter({0: 9468, 2: 7412, 1: 1966})

Epoch :  56 loss training:  6.558941204933944 Time :  29013
accuracy train: 0.999411 val: 0.931919 test: 0.849177
max validation accuracy : 0.931919 max acc epoch : 54 test accuracy : 0.851036
Counter({1: 9393, 0: 7487, 2: 1966})

Epoch :  57 loss training:  5.1207396286627045 Time :  29122
accuracy train: 0.999313 val: 0.930150 test: 0.847451
max validation accuracy : 0.931919 max acc epoch : 54 test accuracy : 0.851036
Counter({0: 9393, 1: 7487, 2: 1966})

Epoch :  58 loss training:  5.703112335940659 Time :  29228
accuracy train: 0.999607 val: 0.930150 test: 0.845990
max validation accuracy : 0.931919 max acc epoch : 54 test accuracy : 0.851036
Counter({0: 9391, 1: 7488, 2: 1967})

Epoch :  59 loss training:  5.3955814920627745 Time :  29332
accuracy train: 0.999509 val: 0.928382 test: 0.849310
max validation accuracy : 0.931919 max acc epoch : 54 test accuracy : 0.851036
Counter({1: 9386, 0: 7493, 2: 1967})

Epoch :  60 loss training:  4.4959044691331655 Time :  29437
accuracy train: 0.999313 val: 0.932803 test: 0.850637
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.850637
Counter({1: 9317, 0: 7564, 2: 1965})

Epoch :  61 loss training:  4.410265237444037 Time :  29543
accuracy train: 0.999214 val: 0.932803 test: 0.849575
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.850637
Counter({0: 9314, 1: 7566, 2: 1966})

Epoch :  62 loss training:  4.236714850814678 Time :  29647
accuracy train: 0.999214 val: 0.929266 test: 0.848646
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.850637
Counter({0: 9302, 1: 7575, 2: 1969})

Epoch :  63 loss training:  4.973482739886094 Time :  29754
accuracy train: 0.999313 val: 0.933687 test: 0.847584
max validation accuracy : 0.933687 max acc epoch : 63 test accuracy : 0.847584
Counter({0: 9237, 2: 7641, 1: 1968})

Epoch :  64 loss training:  4.595532145816833 Time :  29863
accuracy train: 0.999411 val: 0.934571 test: 0.848247
max validation accuracy : 0.934571 max acc epoch : 64 test accuracy : 0.848247
Counter({0: 9226, 2: 7655, 1: 1965})

Epoch :  65 loss training:  5.45402232412016 Time :  29968
accuracy train: 0.999411 val: 0.935455 test: 0.849973
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({0: 9221, 2: 7658, 1: 1967})

Epoch :  66 loss training:  3.8975726365133596 Time :  30074
accuracy train: 0.999313 val: 0.934571 test: 0.847451
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({2: 9223, 0: 7656, 1: 1967})

Epoch :  67 loss training:  4.967466729949592 Time :  30181
accuracy train: 0.999411 val: 0.924845 test: 0.847185
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({2: 9223, 0: 7656, 1: 1967})

Epoch :  68 loss training:  4.313338454874611 Time :  30288
accuracy train: 0.999313 val: 0.932803 test: 0.849177
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({2: 9224, 0: 7656, 1: 1966})

Epoch :  69 loss training:  5.243402500951561 Time :  30394
accuracy train: 0.999313 val: 0.931919 test: 0.849575
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({2: 9236, 0: 7644, 1: 1966})

Epoch :  70 loss training:  3.982942619921232 Time :  30518
accuracy train: 0.999509 val: 0.931919 test: 0.849177
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({1: 9240, 0: 7641, 2: 1965})

Epoch :  71 loss training:  3.70473042753747 Time :  30630
accuracy train: 0.999509 val: 0.930150 test: 0.850239
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({2: 9241, 0: 7639, 1: 1966})

Epoch :  72 loss training:  3.9120938177684366 Time :  30746
accuracy train: 0.999509 val: 0.929266 test: 0.849708
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({0: 9235, 1: 7646, 2: 1965})

Epoch :  73 loss training:  3.329403136041037 Time :  30873
accuracy train: 0.999313 val: 0.933687 test: 0.851036
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({0: 7504, 1: 7372, 2: 3970})

Epoch :  74 loss training:  2.316673952565907 Time :  30980
accuracy train: 0.999411 val: 0.929266 test: 0.848646
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({1: 9224, 0: 7654, 2: 1968})

Epoch :  75 loss training:  2.7310183462952864 Time :  31085
accuracy train: 0.999509 val: 0.931034 test: 0.849044
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({0: 9241, 2: 7643, 1: 1962})

Epoch :  76 loss training:  3.569260752423361 Time :  31187
accuracy train: 0.999509 val: 0.934571 test: 0.849575
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({1: 9246, 0: 7635, 2: 1965})

Epoch :  77 loss training:  2.9536554969427016 Time :  31290
accuracy train: 0.999509 val: 0.930150 test: 0.846522
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({1: 9250, 0: 7632, 2: 1964})

Epoch :  78 loss training:  3.0755977290828014 Time :  31392
accuracy train: 0.999313 val: 0.931034 test: 0.850770
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({1: 7534, 0: 7422, 2: 3890})

Epoch :  79 loss training:  3.055532673562084 Time :  31497
accuracy train: 0.999411 val: 0.931919 test: 0.847849
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({2: 9279, 0: 7578, 1: 1989})

Epoch :  80 loss training:  3.033357756946316 Time :  31611
accuracy train: 0.999313 val: 0.935455 test: 0.848247
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({1: 9291, 0: 7569, 2: 1986})

Epoch :  81 loss training:  2.2397162729921547 Time :  31718
accuracy train: 0.999411 val: 0.931919 test: 0.849973
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({0: 9288, 1: 7576, 2: 1982})

Epoch :  82 loss training:  2.711401637061499 Time :  31823
accuracy train: 0.999411 val: 0.928382 test: 0.848911
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({1: 9288, 0: 7578, 2: 1980})

Epoch :  83 loss training:  1.9646833763281393 Time :  31936
accuracy train: 0.999509 val: 0.929266 test: 0.845858
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({1: 9287, 0: 7580, 2: 1979})

Epoch :  84 loss training:  2.8364937715386986 Time :  32041
accuracy train: 0.999411 val: 0.931034 test: 0.849442
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({0: 9289, 2: 7579, 1: 1978})

Epoch :  85 loss training:  2.548243028435081 Time :  32148
accuracy train: 0.999411 val: 0.929266 test: 0.850239
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({0: 7480, 2: 7315, 1: 4051})

Epoch :  86 loss training:  2.152521311511009 Time :  32250
accuracy train: 0.999411 val: 0.930150 test: 0.850372
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({0: 9302, 2: 7559, 1: 1985})

Epoch :  87 loss training:  3.0010562091001702 Time :  32357
accuracy train: 0.999509 val: 0.931919 test: 0.850903
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({1: 9294, 0: 7570, 2: 1982})

Epoch :  88 loss training:  2.3321730143552486 Time :  32460
accuracy train: 0.999509 val: 0.934571 test: 0.847849
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({2: 9274, 0: 7593, 1: 1979})

Epoch :  89 loss training:  1.859506027280986 Time :  32569
accuracy train: 0.999313 val: 0.930150 test: 0.849973
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({2: 9280, 0: 7587, 1: 1979})

Epoch :  90 loss training:  2.4840158775893997 Time :  32685
accuracy train: 0.999411 val: 0.931919 test: 0.851168
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({1: 9284, 0: 7584, 2: 1978})

Epoch :  91 loss training:  1.5217215300692715 Time :  32815
accuracy train: 0.999509 val: 0.930150 test: 0.848513
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({0: 7468, 2: 7295, 1: 4083})

Epoch :  92 loss training:  1.3312726922467846 Time :  32965
accuracy train: 0.999509 val: 0.930150 test: 0.848115
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({1: 9304, 0: 7572, 2: 1970})

Epoch :  93 loss training:  2.802021498476279 Time :  33107
accuracy train: 0.999411 val: 0.933687 test: 0.851832
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({2: 7480, 0: 7384, 1: 3982})

Epoch :  94 loss training:  1.7583333588429468 Time :  33253
accuracy train: 0.999509 val: 0.932803 test: 0.850106
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({0: 9322, 1: 7554, 2: 1970})

Epoch :  95 loss training:  2.3569491649777774 Time :  33396
accuracy train: 0.999411 val: 0.928382 test: 0.846787
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({2: 9323, 0: 7553, 1: 1970})

Epoch :  96 loss training:  2.4274954243444427 Time :  33532
accuracy train: 0.999509 val: 0.933687 test: 0.850106
max validation accuracy : 0.935455 max acc epoch : 65 test accuracy : 0.849973
Counter({1: 9326, 0: 7552, 2: 1968})

========================================================================================================================================================================================================
best acc epoch :  65
validation accuracy :  0.9354553492484527
test accuracy :  0.8499734466277217
last test_accuracy :  0.8501062134891131
second best val :  0.9345711759504863
second best test :  0.8482474774296336
max gap 8
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=32, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=793, weight_decay=1e-10)
device :  cuda:0
Counter({0: 7565, 1: 6372, 2: 4909})

Epoch :  1 loss training:  673.2613998502493 Time :  34019
accuracy train: 0.809290 val: 0.786914 test: 0.727164
max validation accuracy : 0.786914 max acc epoch : 1 test accuracy : 0.727164
Counter({0: 9949, 1: 6920, 2: 1977})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  434.0990268960595 Time :  34165
accuracy train: 0.844938 val: 0.811671 test: 0.756771
max validation accuracy : 0.811671 max acc epoch : 2 test accuracy : 0.756771
Counter({1: 7263, 2: 6242, 0: 5341})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  381.58294858038425 Time :  34311
accuracy train: 0.867131 val: 0.828470 test: 0.770446
max validation accuracy : 0.828470 max acc epoch : 3 test accuracy : 0.770446
Counter({1: 6839, 2: 6492, 0: 5515})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  281.45885394886136 Time :  34451
accuracy train: 0.903958 val: 0.853227 test: 0.784785
max validation accuracy : 0.853227 max acc epoch : 4 test accuracy : 0.784785
Counter({0: 6954, 2: 6042, 1: 5850})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  252.48518193513155 Time :  34590
accuracy train: 0.912796 val: 0.852343 test: 0.796203
max validation accuracy : 0.853227 max acc epoch : 4 test accuracy : 0.784785
Counter({2: 8626, 0: 6762, 1: 3458})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  236.28518910333514 Time :  34724
accuracy train: 0.919474 val: 0.865606 test: 0.796999
max validation accuracy : 0.865606 max acc epoch : 6 test accuracy : 0.796999
Counter({2: 8803, 1: 6620, 0: 3423})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  192.08795335516334 Time :  34862
accuracy train: 0.946479 val: 0.879752 test: 0.807090
max validation accuracy : 0.879752 max acc epoch : 7 test accuracy : 0.807090
Counter({0: 8831, 2: 6590, 1: 3425})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  180.60497335437685 Time :  35003
accuracy train: 0.938132 val: 0.876216 test: 0.803240
max validation accuracy : 0.879752 max acc epoch : 7 test accuracy : 0.807090
Counter({2: 8783, 1: 6634, 0: 3429})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  167.81373028364033 Time :  35149
accuracy train: 0.953746 val: 0.886826 test: 0.809081
max validation accuracy : 0.886826 max acc epoch : 9 test accuracy : 0.809081
Counter({2: 8832, 1: 6592, 0: 3422})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  147.7684476673603 Time :  35292
accuracy train: 0.962094 val: 0.890363 test: 0.812002
max validation accuracy : 0.890363 max acc epoch : 10 test accuracy : 0.812002
Counter({2: 8806, 0: 6609, 1: 3431})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  138.02080221101642 Time :  35431
accuracy train: 0.970637 val: 0.894783 test: 0.818508
max validation accuracy : 0.894783 max acc epoch : 11 test accuracy : 0.818508
Counter({2: 8792, 1: 6611, 0: 3443})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  122.85703055514023 Time :  35570
accuracy train: 0.971914 val: 0.893899 test: 0.819437
max validation accuracy : 0.894783 max acc epoch : 11 test accuracy : 0.818508
Counter({2: 6774, 1: 6714, 0: 5358})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  101.8420901587233 Time :  35712
accuracy train: 0.979083 val: 0.901857 test: 0.821163
max validation accuracy : 0.901857 max acc epoch : 13 test accuracy : 0.821163
Counter({1: 6754, 2: 6725, 0: 5367})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  97.69559922115877 Time :  35851
accuracy train: 0.983011 val: 0.900088 test: 0.823951
max validation accuracy : 0.901857 max acc epoch : 13 test accuracy : 0.821163
Counter({1: 6753, 2: 6722, 0: 5371})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  85.50302520487458 Time :  35997
accuracy train: 0.984091 val: 0.900973 test: 0.825943
max validation accuracy : 0.901857 max acc epoch : 13 test accuracy : 0.821163
Counter({1: 6757, 2: 6681, 0: 5408})

Epoch :  16 loss training:  79.97273584117647 Time :  36141
accuracy train: 0.985957 val: 0.905393 test: 0.828332
max validation accuracy : 0.905393 max acc epoch : 16 test accuracy : 0.828332
Counter({1: 6763, 2: 6670, 0: 5413})

Epoch :  17 loss training:  77.20007393183187 Time :  36282
accuracy train: 0.988707 val: 0.904509 test: 0.828731
max validation accuracy : 0.905393 max acc epoch : 16 test accuracy : 0.828332
Counter({1: 6756, 2: 6658, 0: 5432})

Epoch :  18 loss training:  66.87212980096228 Time :  36424
accuracy train: 0.989296 val: 0.903625 test: 0.827669
max validation accuracy : 0.905393 max acc epoch : 16 test accuracy : 0.828332
Counter({1: 6761, 0: 6656, 2: 5429})

Epoch :  19 loss training:  64.73190132947639 Time :  36570
accuracy train: 0.990769 val: 0.906278 test: 0.830855
max validation accuracy : 0.906278 max acc epoch : 19 test accuracy : 0.830855
Counter({0: 6756, 1: 6641, 2: 5449})

Epoch :  20 loss training:  60.66117388335988 Time :  36713
accuracy train: 0.992242 val: 0.908930 test: 0.830191
max validation accuracy : 0.908930 max acc epoch : 20 test accuracy : 0.830191
Counter({2: 6767, 1: 6631, 0: 5448})

Epoch :  21 loss training:  56.516073481878266 Time :  36866
accuracy train: 0.993715 val: 0.910698 test: 0.830324
max validation accuracy : 0.910698 max acc epoch : 21 test accuracy : 0.830324
Counter({1: 6766, 2: 6630, 0: 5450})

Epoch :  22 loss training:  50.949114453746006 Time :  37014
accuracy train: 0.994893 val: 0.908930 test: 0.832050
max validation accuracy : 0.910698 max acc epoch : 21 test accuracy : 0.830324
Counter({2: 6756, 1: 6622, 0: 5468})

Epoch :  23 loss training:  46.99646826146636 Time :  37153
accuracy train: 0.995286 val: 0.908930 test: 0.833245
max validation accuracy : 0.910698 max acc epoch : 21 test accuracy : 0.830324
Counter({2: 6757, 1: 6617, 0: 5472})

Epoch :  24 loss training:  45.50365248834714 Time :  37293
accuracy train: 0.996268 val: 0.915119 test: 0.834174
max validation accuracy : 0.915119 max acc epoch : 24 test accuracy : 0.834174
Counter({2: 6724, 0: 6618, 1: 5504})

Epoch :  25 loss training:  41.171676731843036 Time :  37435
accuracy train: 0.996956 val: 0.912467 test: 0.835502
max validation accuracy : 0.915119 max acc epoch : 24 test accuracy : 0.834174
Counter({0: 6724, 2: 6592, 1: 5530})

Epoch :  26 loss training:  36.54959519288968 Time :  37579
accuracy train: 0.996956 val: 0.911583 test: 0.834971
max validation accuracy : 0.915119 max acc epoch : 24 test accuracy : 0.834174
Counter({0: 6738, 1: 6577, 2: 5531})

Epoch :  27 loss training:  32.54693751235027 Time :  37717
accuracy train: 0.997250 val: 0.918656 test: 0.836033
max validation accuracy : 0.918656 max acc epoch : 27 test accuracy : 0.836033
Counter({0: 6734, 2: 6582, 1: 5530})

Epoch :  28 loss training:  33.15682829148136 Time :  37862
accuracy train: 0.997938 val: 0.909814 test: 0.840149
max validation accuracy : 0.918656 max acc epoch : 27 test accuracy : 0.836033
Counter({0: 6732, 1: 6580, 2: 5534})

Epoch :  29 loss training:  30.02804612775799 Time :  38012
accuracy train: 0.998036 val: 0.916004 test: 0.839883
max validation accuracy : 0.918656 max acc epoch : 27 test accuracy : 0.836033
Counter({1: 6721, 2: 6573, 0: 5552})

Epoch :  30 loss training:  27.0484348856844 Time :  38165
accuracy train: 0.998429 val: 0.922193 test: 0.838821
max validation accuracy : 0.922193 max acc epoch : 30 test accuracy : 0.838821
Counter({0: 6710, 2: 6581, 1: 5555})

Epoch :  31 loss training:  25.683658332040068 Time :  38309
accuracy train: 0.998822 val: 0.922193 test: 0.835502
max validation accuracy : 0.922193 max acc epoch : 30 test accuracy : 0.838821
Counter({0: 6711, 2: 6579, 1: 5556})

Epoch :  32 loss training:  23.22318615455879 Time :  38455
accuracy train: 0.998625 val: 0.920424 test: 0.839352
max validation accuracy : 0.922193 max acc epoch : 30 test accuracy : 0.838821
Counter({1: 6671, 2: 6600, 0: 5575})

Epoch :  33 loss training:  22.127715574402828 Time :  38609
accuracy train: 0.998723 val: 0.921309 test: 0.839352
max validation accuracy : 0.922193 max acc epoch : 30 test accuracy : 0.838821
Counter({2: 6670, 1: 6603, 0: 5573})

Epoch :  34 loss training:  21.132929134822916 Time :  38760
accuracy train: 0.999116 val: 0.920424 test: 0.838423
max validation accuracy : 0.922193 max acc epoch : 30 test accuracy : 0.838821
Counter({1: 6660, 0: 6612, 2: 5574})

Epoch :  35 loss training:  17.39579628847423 Time :  38924
accuracy train: 0.999313 val: 0.920424 test: 0.841211
max validation accuracy : 0.922193 max acc epoch : 30 test accuracy : 0.838821
Counter({0: 6666, 2: 6602, 1: 5578})

Epoch :  36 loss training:  18.684474155888893 Time :  39076
accuracy train: 0.998920 val: 0.924845 test: 0.837892
max validation accuracy : 0.924845 max acc epoch : 36 test accuracy : 0.837892
Counter({0: 6664, 1: 6602, 2: 5580})

Epoch :  37 loss training:  16.347281011228915 Time :  39224
accuracy train: 0.999214 val: 0.919540 test: 0.843601
max validation accuracy : 0.924845 max acc epoch : 36 test accuracy : 0.837892
Counter({2: 6655, 1: 6610, 0: 5581})

Epoch :  38 loss training:  16.64193100243574 Time :  39373
accuracy train: 0.999313 val: 0.923077 test: 0.845327
max validation accuracy : 0.924845 max acc epoch : 36 test accuracy : 0.837892
Counter({1: 6654, 2: 6607, 0: 5585})

Epoch :  39 loss training:  13.79465885143145 Time :  39534
accuracy train: 0.999313 val: 0.927498 test: 0.843999
max validation accuracy : 0.927498 max acc epoch : 39 test accuracy : 0.843999
Counter({0: 6657, 1: 6596, 2: 5593})

Epoch :  40 loss training:  13.185295591654722 Time :  39691
accuracy train: 0.999313 val: 0.928382 test: 0.842007
max validation accuracy : 0.928382 max acc epoch : 40 test accuracy : 0.842007
Counter({0: 6663, 1: 6578, 2: 5605})

Epoch :  41 loss training:  12.112157940340694 Time :  39854
accuracy train: 0.999214 val: 0.927498 test: 0.845990
max validation accuracy : 0.928382 max acc epoch : 40 test accuracy : 0.842007
Counter({2: 6662, 1: 6560, 0: 5624})

Epoch :  42 loss training:  10.688079433253733 Time :  40026
accuracy train: 0.999313 val: 0.931919 test: 0.845990
max validation accuracy : 0.931919 max acc epoch : 42 test accuracy : 0.845990
Counter({2: 6643, 0: 6573, 1: 5630})

Epoch :  43 loss training:  10.414389915225911 Time :  40202
accuracy train: 0.999411 val: 0.918656 test: 0.843335
max validation accuracy : 0.931919 max acc epoch : 42 test accuracy : 0.845990
Counter({2: 6640, 1: 6565, 0: 5641})

Epoch :  44 loss training:  9.941496756058768 Time :  40370
accuracy train: 0.999411 val: 0.926614 test: 0.847053
max validation accuracy : 0.931919 max acc epoch : 42 test accuracy : 0.845990
Counter({2: 6604, 0: 6560, 1: 5682})

Epoch :  45 loss training:  10.821294880108326 Time :  40533
accuracy train: 0.999214 val: 0.927498 test: 0.841875
max validation accuracy : 0.931919 max acc epoch : 42 test accuracy : 0.845990
Counter({1: 6616, 0: 6556, 2: 5674})

Epoch :  46 loss training:  10.939473749960598 Time :  40690
accuracy train: 0.999214 val: 0.927498 test: 0.845990
max validation accuracy : 0.931919 max acc epoch : 42 test accuracy : 0.845990
Counter({1: 6617, 2: 6539, 0: 5690})

Epoch :  47 loss training:  8.654090654235915 Time :  40849
accuracy train: 0.999214 val: 0.927498 test: 0.845725
max validation accuracy : 0.931919 max acc epoch : 42 test accuracy : 0.845990
Counter({2: 6624, 1: 6532, 0: 5690})

Epoch :  48 loss training:  9.732205116590194 Time :  41003
accuracy train: 0.999214 val: 0.923077 test: 0.843999
max validation accuracy : 0.931919 max acc epoch : 42 test accuracy : 0.845990
Counter({0: 6619, 2: 6530, 1: 5697})

Epoch :  49 loss training:  7.966400946097565 Time :  41150
accuracy train: 0.999116 val: 0.925729 test: 0.843866
max validation accuracy : 0.931919 max acc epoch : 42 test accuracy : 0.845990
Counter({0: 6606, 2: 6526, 1: 5714})

Epoch :  50 loss training:  6.11092413501683 Time :  41292
accuracy train: 0.999411 val: 0.927498 test: 0.846654
max validation accuracy : 0.931919 max acc epoch : 42 test accuracy : 0.845990
Counter({1: 6602, 2: 6507, 0: 5737})

Epoch :  51 loss training:  7.44524272178387 Time :  41435
accuracy train: 0.999411 val: 0.927498 test: 0.844530
max validation accuracy : 0.931919 max acc epoch : 42 test accuracy : 0.845990
Counter({1: 6605, 2: 6494, 0: 5747})

Epoch :  52 loss training:  6.1404328658027225 Time :  41579
accuracy train: 0.999313 val: 0.931034 test: 0.848911
max validation accuracy : 0.931919 max acc epoch : 42 test accuracy : 0.845990
Counter({1: 6604, 2: 6493, 0: 5749})

Epoch :  53 loss training:  5.699042822438059 Time :  41713
accuracy train: 0.999313 val: 0.925729 test: 0.849973
max validation accuracy : 0.931919 max acc epoch : 42 test accuracy : 0.845990
Counter({1: 6601, 2: 6483, 0: 5762})

Epoch :  54 loss training:  6.135010175559728 Time :  41820
accuracy train: 0.999411 val: 0.923961 test: 0.850505
max validation accuracy : 0.931919 max acc epoch : 42 test accuracy : 0.845990
Counter({2: 6598, 1: 6485, 0: 5763})

Epoch :  55 loss training:  7.329946036494221 Time :  41919
accuracy train: 0.999411 val: 0.923961 test: 0.848911
max validation accuracy : 0.931919 max acc epoch : 42 test accuracy : 0.845990
Counter({1: 6598, 2: 6473, 0: 5775})

Epoch :  56 loss training:  5.675537451417767 Time :  42018
accuracy train: 0.999509 val: 0.930150 test: 0.849708
max validation accuracy : 0.931919 max acc epoch : 42 test accuracy : 0.845990
Counter({0: 6601, 2: 6467, 1: 5778})

Epoch :  57 loss training:  6.04363412305247 Time :  42121
accuracy train: 0.999411 val: 0.930150 test: 0.846787
max validation accuracy : 0.931919 max acc epoch : 42 test accuracy : 0.845990
Counter({0: 6608, 1: 6455, 2: 5783})

Epoch :  58 loss training:  5.236859825774445 Time :  42229
accuracy train: 0.999411 val: 0.937224 test: 0.845459
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({2: 6635, 1: 6419, 0: 5792})

Epoch :  59 loss training:  6.579580581554183 Time :  42332
accuracy train: 0.999509 val: 0.928382 test: 0.848646
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({0: 6652, 2: 6402, 1: 5792})

Epoch :  60 loss training:  4.993173475413641 Time :  42434
accuracy train: 0.999313 val: 0.926614 test: 0.850239
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({1: 6636, 2: 6397, 0: 5813})

Epoch :  61 loss training:  4.697674917362747 Time :  42537
accuracy train: 0.999509 val: 0.932803 test: 0.849973
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({0: 6637, 2: 6396, 1: 5813})

Epoch :  62 loss training:  4.222854179994101 Time :  42634
accuracy train: 0.999411 val: 0.930150 test: 0.845990
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({0: 6609, 1: 6387, 2: 5850})

Epoch :  63 loss training:  4.562233100692538 Time :  42736
accuracy train: 0.999313 val: 0.931919 test: 0.853293
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({1: 6612, 2: 6381, 0: 5853})

Epoch :  64 loss training:  4.3874089147084305 Time :  42838
accuracy train: 0.999313 val: 0.928382 test: 0.847053
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({0: 6622, 1: 6377, 2: 5847})

Epoch :  65 loss training:  4.5441596610689885 Time :  42942
accuracy train: 0.999411 val: 0.931919 test: 0.848779
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({0: 6627, 1: 6373, 2: 5846})

Epoch :  66 loss training:  3.984695611125062 Time :  43046
accuracy train: 0.999411 val: 0.931034 test: 0.850505
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({1: 6648, 0: 6430, 2: 5768})

Epoch :  67 loss training:  3.7224597594085935 Time :  43148
accuracy train: 0.999411 val: 0.931034 test: 0.850372
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({2: 6645, 1: 6460, 0: 5741})

Epoch :  68 loss training:  3.6634941856900696 Time :  43248
accuracy train: 0.999411 val: 0.925729 test: 0.849708
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({0: 6638, 2: 6482, 1: 5726})

Epoch :  69 loss training:  3.018480200376871 Time :  43350
accuracy train: 0.999411 val: 0.927498 test: 0.850106
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({0: 6636, 2: 6496, 1: 5714})

Epoch :  70 loss training:  3.1002966339970044 Time :  43448
accuracy train: 0.999411 val: 0.924845 test: 0.851434
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({0: 6640, 2: 6517, 1: 5689})

Epoch :  71 loss training:  3.9053293962715543 Time :  43545
accuracy train: 0.999509 val: 0.927498 test: 0.851965
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({2: 9984, 0: 6902, 1: 1960})

Epoch :  72 loss training:  3.6555933928138984 Time :  43653
accuracy train: 0.999411 val: 0.927498 test: 0.852629
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({0: 9984, 2: 6902, 1: 1960})

Epoch :  73 loss training:  2.2606410656771914 Time :  43756
accuracy train: 0.999313 val: 0.926614 test: 0.847584
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({0: 9984, 2: 6903, 1: 1959})

Epoch :  74 loss training:  3.2990684954947938 Time :  43867
accuracy train: 0.999313 val: 0.925729 test: 0.852496
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({0: 9991, 2: 6896, 1: 1959})

Epoch :  75 loss training:  2.945551850436459 Time :  43972
accuracy train: 0.999509 val: 0.925729 test: 0.853425
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({2: 10004, 0: 6884, 1: 1958})

Epoch :  76 loss training:  2.839095789284329 Time :  44079
accuracy train: 0.999509 val: 0.930150 test: 0.849442
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({2: 10016, 0: 6869, 1: 1961})

Epoch :  77 loss training:  2.960326639971754 Time :  44183
accuracy train: 0.999313 val: 0.927498 test: 0.853160
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({1: 10013, 0: 6871, 2: 1962})

Epoch :  78 loss training:  3.1876825114097755 Time :  44289
accuracy train: 0.999411 val: 0.928382 test: 0.852629
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({0: 10020, 1: 6863, 2: 1963})

Epoch :  79 loss training:  3.5069168422778603 Time :  44396
accuracy train: 0.999411 val: 0.928382 test: 0.853293
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({0: 10029, 1: 6855, 2: 1962})

Epoch :  80 loss training:  3.7774050549342064 Time :  44500
accuracy train: 0.999509 val: 0.929266 test: 0.846787
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({1: 10026, 0: 6858, 2: 1962})

Epoch :  81 loss training:  4.24274920213611 Time :  44607
accuracy train: 0.999509 val: 0.925729 test: 0.851699
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({1: 10028, 0: 6857, 2: 1961})

Epoch :  82 loss training:  2.2961445371656737 Time :  44712
accuracy train: 0.999411 val: 0.927498 test: 0.850637
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({0: 10027, 2: 6859, 1: 1960})

Epoch :  83 loss training:  2.250522896039911 Time :  44822
accuracy train: 0.999411 val: 0.930150 test: 0.851699
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({1: 10015, 0: 6871, 2: 1960})

Epoch :  84 loss training:  1.891189920988836 Time :  44927
accuracy train: 0.999411 val: 0.928382 test: 0.853160
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({0: 10024, 1: 6862, 2: 1960})

Epoch :  85 loss training:  2.67728176271703 Time :  45032
accuracy train: 0.999411 val: 0.927498 test: 0.854886
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({0: 10020, 2: 6867, 1: 1959})

Epoch :  86 loss training:  2.1391071591933724 Time :  45136
accuracy train: 0.999411 val: 0.926614 test: 0.853425
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({1: 10019, 0: 6868, 2: 1959})

Epoch :  87 loss training:  2.335306759166997 Time :  45238
accuracy train: 0.999411 val: 0.924845 test: 0.851301
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({1: 10022, 0: 6865, 2: 1959})

Epoch :  88 loss training:  3.115162940731352 Time :  45345
accuracy train: 0.999411 val: 0.928382 test: 0.851036
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({1: 10021, 0: 6866, 2: 1959})

Epoch :  89 loss training:  2.831548655682809 Time :  45456
accuracy train: 0.999411 val: 0.929266 test: 0.849708
max validation accuracy : 0.937224 max acc epoch : 58 test accuracy : 0.845459
Counter({1: 10015, 0: 6871, 2: 1960})

========================================================================================================================================================================================================
best acc epoch :  58
validation accuracy :  0.9372236958443855
test accuracy :  0.8454593733404142
last test_accuracy :  0.849707912904939
second best val :  0.9328028293545535
second best test :  0.8454593733404142
max gap 16
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  81 	 val_accuracy : 0.93546 	 test_accuracy : 0.85196 	 last test_accuracy : 0.85064 	 second best val : 0.93457 	 second best test : 0.85196
k :  1 	 best_acc epoch :  71 	 val_accuracy : 0.93899 	 test_accuracy : 0.84865 	 last test_accuracy : 0.84798 	 second best val : 0.93811 	 second best test : 0.84865
k :  2 	 best_acc epoch :  65 	 val_accuracy : 0.93546 	 test_accuracy : 0.84997 	 last test_accuracy : 0.85011 	 second best val : 0.93457 	 second best test : 0.84825
k :  3 	 best_acc epoch :  58 	 val_accuracy : 0.93722 	 test_accuracy : 0.84546 	 last test_accuracy : 0.84971 	 second best val : 0.93280 	 second best test : 0.84546

avg :  	 val_accuracy : 0.93678 	 test_accuracy : 0.84901 	 last_accuracy : 0.84961 	 second best val : 0.93501 	 second best test : 0.84858

std :  	 val_accuracy : 0.00147 	 test_accuracy : 0.00237 	 last_accuracy : 0.00100 	 second best val : 0.00193 	 second best test : 0.00231
