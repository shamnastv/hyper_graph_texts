date and time :  Mon Mar 15 15:27:45 2021
Namespace(batch_size=128, dataset='R8', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=1e-05)
device :  cuda:0
Counter({0: 1467, 3: 1321, 1: 1306, 2: 1251, 6: 1224, 5: 597, 7: 488, 4: 37})
HGNNModel(
  (word_embeddings): Embedding(8231, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=8, bias=True)
    (1): Linear(in_features=200, out_features=8, bias=True)
    (2): Linear(in_features=200, out_features=8, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  63.25639885663986 Time :  18
accuracy train: 0.751161 val: 0.720000 test: 0.742009
max validation accuracy : 0.720000 max acc epoch : 1 test accuracy : 0.742009

Epoch :  2 loss training:  34.16715642809868 Time :  24
accuracy train: 0.850535 val: 0.823636 test: 0.858904
max validation accuracy : 0.823636 max acc epoch : 2 test accuracy : 0.858904

Epoch :  3 loss training:  25.85158695280552 Time :  29
accuracy train: 0.882650 val: 0.863636 test: 0.879452
max validation accuracy : 0.863636 max acc epoch : 3 test accuracy : 0.879452

Epoch :  4 loss training:  21.433222949504852 Time :  35
accuracy train: 0.853161 val: 0.843636 test: 0.874886
max validation accuracy : 0.863636 max acc epoch : 3 test accuracy : 0.879452

Epoch :  5 loss training:  18.851747512817383 Time :  41
accuracy train: 0.915573 val: 0.883636 test: 0.916438
max validation accuracy : 0.883636 max acc epoch : 5 test accuracy : 0.916438

Epoch :  6 loss training:  15.55516779795289 Time :  46
accuracy train: 0.811553 val: 0.805455 test: 0.840183
max validation accuracy : 0.883636 max acc epoch : 5 test accuracy : 0.916438

Epoch :  7 loss training:  13.192665338516235 Time :  52
accuracy train: 0.925672 val: 0.903636 test: 0.925114
max validation accuracy : 0.903636 max acc epoch : 7 test accuracy : 0.925114

Epoch :  8 loss training:  13.442150922492146 Time :  58
accuracy train: 0.843466 val: 0.841818 test: 0.857991
max validation accuracy : 0.903636 max acc epoch : 7 test accuracy : 0.925114

Epoch :  9 loss training:  12.344976916909218 Time :  64
accuracy train: 0.881236 val: 0.858182 test: 0.890411
max validation accuracy : 0.903636 max acc epoch : 7 test accuracy : 0.925114

Epoch :  10 loss training:  9.270517967641354 Time :  70
accuracy train: 0.913149 val: 0.896364 test: 0.914612
max validation accuracy : 0.903636 max acc epoch : 7 test accuracy : 0.925114

Epoch :  11 loss training:  9.318537726532668 Time :  76
accuracy train: 0.846900 val: 0.843636 test: 0.858447
max validation accuracy : 0.903636 max acc epoch : 7 test accuracy : 0.925114

Epoch :  12 loss training:  8.283340741880238 Time :  81
accuracy train: 0.839628 val: 0.834545 test: 0.866210
max validation accuracy : 0.903636 max acc epoch : 7 test accuracy : 0.925114

Epoch :  13 loss training:  8.442112256307155 Time :  86
accuracy train: 0.874773 val: 0.843636 test: 0.868950
max validation accuracy : 0.903636 max acc epoch : 7 test accuracy : 0.925114

Epoch :  14 loss training:  12.81247617630288 Time :  92
accuracy train: 0.864068 val: 0.850909 test: 0.868493
max validation accuracy : 0.903636 max acc epoch : 7 test accuracy : 0.925114

Epoch :  15 loss training:  7.913219809066504 Time :  97
accuracy train: 0.905474 val: 0.885455 test: 0.905936
max validation accuracy : 0.903636 max acc epoch : 7 test accuracy : 0.925114

Epoch :  16 loss training:  6.885833234176971 Time :  103
accuracy train: 0.867502 val: 0.865455 test: 0.866667
max validation accuracy : 0.903636 max acc epoch : 7 test accuracy : 0.925114

Epoch :  17 loss training:  7.021972519112751 Time :  108
accuracy train: 0.923854 val: 0.898182 test: 0.904566
max validation accuracy : 0.903636 max acc epoch : 7 test accuracy : 0.925114

Epoch :  18 loss training:  5.803016172954813 Time :  114
accuracy train: 0.899616 val: 0.885455 test: 0.902283
max validation accuracy : 0.903636 max acc epoch : 7 test accuracy : 0.925114

Epoch :  19 loss training:  5.690838656388223 Time :  120
accuracy train: 0.856191 val: 0.847273 test: 0.838813
max validation accuracy : 0.903636 max acc epoch : 7 test accuracy : 0.925114

Epoch :  20 loss training:  4.86748582375003 Time :  125
accuracy train: 0.887497 val: 0.858182 test: 0.885845
max validation accuracy : 0.903636 max acc epoch : 7 test accuracy : 0.925114

Epoch :  21 loss training:  7.689645336038666 Time :  131
accuracy train: 0.902646 val: 0.860000 test: 0.867123
max validation accuracy : 0.903636 max acc epoch : 7 test accuracy : 0.925114

Epoch :  22 loss training:  7.209923252929002 Time :  136
accuracy train: 0.902444 val: 0.885455 test: 0.892694
max validation accuracy : 0.903636 max acc epoch : 7 test accuracy : 0.925114

Epoch :  23 loss training:  5.611671594670042 Time :  141
accuracy train: 0.880832 val: 0.870909 test: 0.876712
max validation accuracy : 0.903636 max acc epoch : 7 test accuracy : 0.925114

Epoch :  24 loss training:  5.0025623352848925 Time :  147
accuracy train: 0.946273 val: 0.912727 test: 0.925571
max validation accuracy : 0.912727 max acc epoch : 24 test accuracy : 0.925571

Epoch :  25 loss training:  6.740184239461087 Time :  153
accuracy train: 0.882044 val: 0.876364 test: 0.884475
max validation accuracy : 0.912727 max acc epoch : 24 test accuracy : 0.925571

Epoch :  26 loss training:  5.043983485447825 Time :  159
accuracy train: 0.916784 val: 0.890909 test: 0.890868
max validation accuracy : 0.912727 max acc epoch : 24 test accuracy : 0.925571

Epoch :  27 loss training:  3.9903684169767075 Time :  164
accuracy train: 0.924864 val: 0.885455 test: 0.895890
max validation accuracy : 0.912727 max acc epoch : 24 test accuracy : 0.925571

Epoch :  28 loss training:  3.289818524324801 Time :  170
accuracy train: 0.930721 val: 0.901818 test: 0.903196
max validation accuracy : 0.912727 max acc epoch : 24 test accuracy : 0.925571

Epoch :  29 loss training:  3.232445563611691 Time :  176
accuracy train: 0.877600 val: 0.852727 test: 0.855251
max validation accuracy : 0.912727 max acc epoch : 24 test accuracy : 0.925571

Epoch :  30 loss training:  5.238850491870835 Time :  181
accuracy train: 0.951525 val: 0.920000 test: 0.921461
max validation accuracy : 0.920000 max acc epoch : 30 test accuracy : 0.921461

Epoch :  31 loss training:  3.797987709811423 Time :  187
accuracy train: 0.933145 val: 0.896364 test: 0.912329
max validation accuracy : 0.920000 max acc epoch : 30 test accuracy : 0.921461

Epoch :  32 loss training:  3.666641180643637 Time :  192
accuracy train: 0.935165 val: 0.901818 test: 0.906849
max validation accuracy : 0.920000 max acc epoch : 30 test accuracy : 0.921461

Epoch :  33 loss training:  3.0259907569852658 Time :  197
accuracy train: 0.926479 val: 0.896364 test: 0.911872
max validation accuracy : 0.920000 max acc epoch : 30 test accuracy : 0.921461

Epoch :  34 loss training:  4.484400457076845 Time :  202
accuracy train: 0.928297 val: 0.896364 test: 0.899087
max validation accuracy : 0.920000 max acc epoch : 30 test accuracy : 0.921461

Epoch :  35 loss training:  3.4529538148817664 Time :  207
accuracy train: 0.937184 val: 0.912727 test: 0.918721
max validation accuracy : 0.920000 max acc epoch : 30 test accuracy : 0.921461

Epoch :  36 loss training:  3.261098607632448 Time :  212
accuracy train: 0.903454 val: 0.878182 test: 0.905023
max validation accuracy : 0.920000 max acc epoch : 30 test accuracy : 0.921461

Epoch :  37 loss training:  2.4062732113234233 Time :  217
accuracy train: 0.962230 val: 0.934545 test: 0.940183
max validation accuracy : 0.934545 max acc epoch : 37 test accuracy : 0.940183

Epoch :  38 loss training:  2.6685065472775022 Time :  222
accuracy train: 0.934761 val: 0.903636 test: 0.907763
max validation accuracy : 0.934545 max acc epoch : 37 test accuracy : 0.940183

Epoch :  39 loss training:  3.6910818042088067 Time :  227
accuracy train: 0.927085 val: 0.900000 test: 0.911416
max validation accuracy : 0.934545 max acc epoch : 37 test accuracy : 0.940183

Epoch :  40 loss training:  5.514362681999046 Time :  232
accuracy train: 0.940416 val: 0.907273 test: 0.928311
max validation accuracy : 0.934545 max acc epoch : 37 test accuracy : 0.940183

Epoch :  41 loss training:  4.9656780186342075 Time :  238
accuracy train: 0.915371 val: 0.883636 test: 0.917808
max validation accuracy : 0.934545 max acc epoch : 37 test accuracy : 0.940183

Epoch :  42 loss training:  4.006914556863194 Time :  243
accuracy train: 0.935367 val: 0.896364 test: 0.918721
max validation accuracy : 0.934545 max acc epoch : 37 test accuracy : 0.940183

Epoch :  43 loss training:  4.406038869430631 Time :  249
accuracy train: 0.941022 val: 0.929091 test: 0.940639
max validation accuracy : 0.934545 max acc epoch : 37 test accuracy : 0.940183

Epoch :  44 loss training:  2.9875384698952985 Time :  255
accuracy train: 0.955363 val: 0.916364 test: 0.929224
max validation accuracy : 0.934545 max acc epoch : 37 test accuracy : 0.940183

Epoch :  45 loss training:  4.623787064367207 Time :  260
accuracy train: 0.921834 val: 0.892727 test: 0.908676
max validation accuracy : 0.934545 max acc epoch : 37 test accuracy : 0.940183

Epoch :  46 loss training:  3.363886493607424 Time :  266
accuracy train: 0.960210 val: 0.918182 test: 0.938356
max validation accuracy : 0.934545 max acc epoch : 37 test accuracy : 0.940183

Epoch :  47 loss training:  2.7182172847387847 Time :  271
accuracy train: 0.935569 val: 0.903636 test: 0.895434
max validation accuracy : 0.934545 max acc epoch : 37 test accuracy : 0.940183

Epoch :  48 loss training:  2.6345778207178228 Time :  277
accuracy train: 0.954757 val: 0.916364 test: 0.923288
max validation accuracy : 0.934545 max acc epoch : 37 test accuracy : 0.940183

Epoch :  49 loss training:  3.9613271084526787 Time :  282
accuracy train: 0.938598 val: 0.918182 test: 0.921918
max validation accuracy : 0.934545 max acc epoch : 37 test accuracy : 0.940183

Epoch :  50 loss training:  2.0834518496158125 Time :  288
accuracy train: 0.953545 val: 0.916364 test: 0.919635
max validation accuracy : 0.934545 max acc epoch : 37 test accuracy : 0.940183

Epoch :  51 loss training:  1.9825697093729104 Time :  293
accuracy train: 0.952737 val: 0.920000 test: 0.933790
max validation accuracy : 0.934545 max acc epoch : 37 test accuracy : 0.940183

Epoch :  52 loss training:  2.3800190111942356 Time :  299
accuracy train: 0.960816 val: 0.925455 test: 0.933790
max validation accuracy : 0.934545 max acc epoch : 37 test accuracy : 0.940183

Epoch :  53 loss training:  3.149816140983603 Time :  304
accuracy train: 0.917996 val: 0.890909 test: 0.914155
max validation accuracy : 0.934545 max acc epoch : 37 test accuracy : 0.940183

Epoch :  54 loss training:  7.34959764748055 Time :  309
accuracy train: 0.937386 val: 0.903636 test: 0.896804
max validation accuracy : 0.934545 max acc epoch : 37 test accuracy : 0.940183

Epoch :  55 loss training:  3.704055610462092 Time :  315
accuracy train: 0.952737 val: 0.936364 test: 0.939269
max validation accuracy : 0.936364 max acc epoch : 55 test accuracy : 0.939269

Epoch :  56 loss training:  2.7923177088596276 Time :  320
accuracy train: 0.944456 val: 0.907273 test: 0.925571
max validation accuracy : 0.936364 max acc epoch : 55 test accuracy : 0.939269

Epoch :  57 loss training:  2.8509527735732263 Time :  325
accuracy train: 0.943244 val: 0.920000 test: 0.930137
max validation accuracy : 0.936364 max acc epoch : 55 test accuracy : 0.939269

Epoch :  58 loss training:  2.358481093287992 Time :  331
accuracy train: 0.950313 val: 0.910909 test: 0.928767
max validation accuracy : 0.936364 max acc epoch : 55 test accuracy : 0.939269

Epoch :  59 loss training:  1.9525586402833142 Time :  336
accuracy train: 0.964250 val: 0.914545 test: 0.924658
max validation accuracy : 0.936364 max acc epoch : 55 test accuracy : 0.939269

Epoch :  60 loss training:  2.238400052759971 Time :  343
accuracy train: 0.956170 val: 0.914545 test: 0.927854
max validation accuracy : 0.936364 max acc epoch : 55 test accuracy : 0.939269

Epoch :  61 loss training:  2.435474164889456 Time :  348
accuracy train: 0.953747 val: 0.918182 test: 0.934247
max validation accuracy : 0.936364 max acc epoch : 55 test accuracy : 0.939269

Epoch :  62 loss training:  2.3919919649197254 Time :  353
accuracy train: 0.956574 val: 0.932727 test: 0.940639
max validation accuracy : 0.936364 max acc epoch : 55 test accuracy : 0.939269

Epoch :  63 loss training:  2.724383870825477 Time :  359
accuracy train: 0.955565 val: 0.903636 test: 0.926027
max validation accuracy : 0.936364 max acc epoch : 55 test accuracy : 0.939269

Epoch :  64 loss training:  3.349016052496154 Time :  364
accuracy train: 0.968289 val: 0.923636 test: 0.935616
max validation accuracy : 0.936364 max acc epoch : 55 test accuracy : 0.939269

Epoch :  65 loss training:  2.0424481248010125 Time :  370
accuracy train: 0.959806 val: 0.925455 test: 0.933333
max validation accuracy : 0.936364 max acc epoch : 55 test accuracy : 0.939269

Epoch :  66 loss training:  2.704393222265935 Time :  375
accuracy train: 0.947485 val: 0.903636 test: 0.915982
max validation accuracy : 0.936364 max acc epoch : 55 test accuracy : 0.939269

Epoch :  67 loss training:  1.5384101566996833 Time :  381
accuracy train: 0.956372 val: 0.916364 test: 0.927854
max validation accuracy : 0.936364 max acc epoch : 55 test accuracy : 0.939269

Epoch :  68 loss training:  1.617172715767083 Time :  386
accuracy train: 0.958796 val: 0.930909 test: 0.936530
max validation accuracy : 0.936364 max acc epoch : 55 test accuracy : 0.939269

Epoch :  69 loss training:  1.461270017735842 Time :  392
accuracy train: 0.960412 val: 0.921818 test: 0.926484
max validation accuracy : 0.936364 max acc epoch : 55 test accuracy : 0.939269

Epoch :  70 loss training:  1.8920017832388112 Time :  397
accuracy train: 0.963442 val: 0.927273 test: 0.932877
max validation accuracy : 0.936364 max acc epoch : 55 test accuracy : 0.939269

Epoch :  71 loss training:  1.0805994910033405 Time :  403
accuracy train: 0.963240 val: 0.920000 test: 0.928767
max validation accuracy : 0.936364 max acc epoch : 55 test accuracy : 0.939269

Epoch :  72 loss training:  1.122645175040816 Time :  408
accuracy train: 0.968087 val: 0.940000 test: 0.934703
max validation accuracy : 0.940000 max acc epoch : 72 test accuracy : 0.934703

Epoch :  73 loss training:  1.1886328694781696 Time :  413
accuracy train: 0.965462 val: 0.930909 test: 0.933333
max validation accuracy : 0.940000 max acc epoch : 72 test accuracy : 0.934703

Epoch :  74 loss training:  1.5231403094076086 Time :  418
accuracy train: 0.955363 val: 0.920000 test: 0.928311
max validation accuracy : 0.940000 max acc epoch : 72 test accuracy : 0.934703

Epoch :  75 loss training:  1.2660195944392854 Time :  423
accuracy train: 0.969501 val: 0.927273 test: 0.934247
max validation accuracy : 0.940000 max acc epoch : 72 test accuracy : 0.934703

Epoch :  76 loss training:  1.089083196354295 Time :  428
accuracy train: 0.965462 val: 0.920000 test: 0.926484
max validation accuracy : 0.940000 max acc epoch : 72 test accuracy : 0.934703

Epoch :  77 loss training:  1.991312320194993 Time :  433
accuracy train: 0.968491 val: 0.925455 test: 0.930594
max validation accuracy : 0.940000 max acc epoch : 72 test accuracy : 0.934703

Epoch :  78 loss training:  1.904559231878011 Time :  438
accuracy train: 0.958594 val: 0.916364 test: 0.929224
max validation accuracy : 0.940000 max acc epoch : 72 test accuracy : 0.934703

Epoch :  79 loss training:  2.3766217787351707 Time :  443
accuracy train: 0.960210 val: 0.914545 test: 0.936986
max validation accuracy : 0.940000 max acc epoch : 72 test accuracy : 0.934703

Epoch :  80 loss training:  1.8575793955023983 Time :  449
accuracy train: 0.955968 val: 0.930909 test: 0.933790
max validation accuracy : 0.940000 max acc epoch : 72 test accuracy : 0.934703

Epoch :  81 loss training:  2.738545853049459 Time :  454
accuracy train: 0.933549 val: 0.892727 test: 0.901370
max validation accuracy : 0.940000 max acc epoch : 72 test accuracy : 0.934703

Epoch :  82 loss training:  2.71216011631077 Time :  460
accuracy train: 0.959806 val: 0.923636 test: 0.932877
max validation accuracy : 0.940000 max acc epoch : 72 test accuracy : 0.934703

Epoch :  83 loss training:  5.221009558503283 Time :  465
accuracy train: 0.937992 val: 0.878182 test: 0.900457
max validation accuracy : 0.940000 max acc epoch : 72 test accuracy : 0.934703

Epoch :  84 loss training:  3.0081009190471377 Time :  471
accuracy train: 0.955767 val: 0.918182 test: 0.933790
max validation accuracy : 0.940000 max acc epoch : 72 test accuracy : 0.934703

Epoch :  85 loss training:  1.9513998575639562 Time :  476
accuracy train: 0.957988 val: 0.923636 test: 0.931507
max validation accuracy : 0.940000 max acc epoch : 72 test accuracy : 0.934703

Epoch :  86 loss training:  4.338550108911022 Time :  481
accuracy train: 0.950919 val: 0.909091 test: 0.933333
max validation accuracy : 0.940000 max acc epoch : 72 test accuracy : 0.934703

Epoch :  87 loss training:  2.61400855863576 Time :  487
accuracy train: 0.931933 val: 0.898182 test: 0.903653
max validation accuracy : 0.940000 max acc epoch : 72 test accuracy : 0.934703

Epoch :  88 loss training:  2.605965619926792 Time :  492
accuracy train: 0.949101 val: 0.901818 test: 0.916895
max validation accuracy : 0.940000 max acc epoch : 72 test accuracy : 0.934703

Epoch :  89 loss training:  2.9729498425622296 Time :  498
accuracy train: 0.960210 val: 0.918182 test: 0.924658
max validation accuracy : 0.940000 max acc epoch : 72 test accuracy : 0.934703

Epoch :  90 loss training:  3.6143788917579514 Time :  504
accuracy train: 0.949707 val: 0.920000 test: 0.927397
max validation accuracy : 0.940000 max acc epoch : 72 test accuracy : 0.934703

Epoch :  91 loss training:  3.5754470144302104 Time :  510
accuracy train: 0.960614 val: 0.930909 test: 0.932420
max validation accuracy : 0.940000 max acc epoch : 72 test accuracy : 0.934703

Epoch :  92 loss training:  3.052362030617587 Time :  515
accuracy train: 0.909715 val: 0.878182 test: 0.899087
max validation accuracy : 0.940000 max acc epoch : 72 test accuracy : 0.934703

Epoch :  93 loss training:  1.9773534070482128 Time :  521
accuracy train: 0.943244 val: 0.916364 test: 0.926484
max validation accuracy : 0.940000 max acc epoch : 72 test accuracy : 0.934703

========================================================================================================================================================================================================
max acc epoch :  72
max validation accuracy :  0.94
test accuracy :  0.9347031963470319
last test_accuracy :  0.9264840182648402
========================================================================================================================================================================================================

date and time :  Mon Mar 15 15:36:37 2021
Namespace(batch_size=128, dataset='R8', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=200, lda=True, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=1e-05)
device :  cuda:0
Counter({7: 1488, 4: 1299, 6: 1285, 2: 1260, 3: 1250, 5: 597, 1: 475, 0: 37})
HGNNModel(
  (word_embeddings): Embedding(8231, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=8, bias=True)
    (1): Linear(in_features=200, out_features=8, bias=True)
    (2): Linear(in_features=200, out_features=8, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  67.7183632850647 Time :  19
accuracy train: 0.823874 val: 0.772727 test: 0.800913
max validation accuracy : 0.772727 max acc epoch : 1 test accuracy : 0.800913

Epoch :  2 loss training:  36.21743044257164 Time :  26
accuracy train: 0.904666 val: 0.887273 test: 0.894977
max validation accuracy : 0.887273 max acc epoch : 2 test accuracy : 0.894977

Epoch :  3 loss training:  27.250347957015038 Time :  32
accuracy train: 0.920218 val: 0.907273 test: 0.917352
max validation accuracy : 0.907273 max acc epoch : 3 test accuracy : 0.917352

Epoch :  4 loss training:  21.357473701238632 Time :  39
accuracy train: 0.926278 val: 0.912727 test: 0.919178
max validation accuracy : 0.912727 max acc epoch : 4 test accuracy : 0.919178

Epoch :  5 loss training:  17.681952580809593 Time :  45
accuracy train: 0.942032 val: 0.929091 test: 0.933790
max validation accuracy : 0.929091 max acc epoch : 5 test accuracy : 0.933790

Epoch :  6 loss training:  15.937544461339712 Time :  52
accuracy train: 0.941628 val: 0.923636 test: 0.928311
max validation accuracy : 0.929091 max acc epoch : 5 test accuracy : 0.933790

Epoch :  7 loss training:  12.920317970216274 Time :  59
accuracy train: 0.947485 val: 0.921818 test: 0.931050
max validation accuracy : 0.929091 max acc epoch : 5 test accuracy : 0.933790

Epoch :  8 loss training:  10.819525426253676 Time :  67
accuracy train: 0.946677 val: 0.921818 test: 0.931050
max validation accuracy : 0.929091 max acc epoch : 5 test accuracy : 0.933790

Epoch :  9 loss training:  9.802491155453026 Time :  75
accuracy train: 0.954757 val: 0.929091 test: 0.938356
max validation accuracy : 0.929091 max acc epoch : 5 test accuracy : 0.933790

Epoch :  10 loss training:  8.892445555888116 Time :  81
accuracy train: 0.951323 val: 0.927273 test: 0.934703
max validation accuracy : 0.929091 max acc epoch : 5 test accuracy : 0.933790

Epoch :  11 loss training:  8.000155601650476 Time :  88
accuracy train: 0.960008 val: 0.934545 test: 0.940639
max validation accuracy : 0.934545 max acc epoch : 11 test accuracy : 0.940639

Epoch :  12 loss training:  7.741561086149886 Time :  94
accuracy train: 0.956978 val: 0.927273 test: 0.932877
max validation accuracy : 0.934545 max acc epoch : 11 test accuracy : 0.940639

Epoch :  13 loss training:  6.1636598540935665 Time :  101
accuracy train: 0.954757 val: 0.923636 test: 0.931963
max validation accuracy : 0.934545 max acc epoch : 11 test accuracy : 0.940639

Epoch :  14 loss training:  5.193580086226575 Time :  107
accuracy train: 0.954959 val: 0.927273 test: 0.929224
max validation accuracy : 0.934545 max acc epoch : 11 test accuracy : 0.940639

Epoch :  15 loss training:  5.775023737107404 Time :  113
accuracy train: 0.960210 val: 0.927273 test: 0.934703
max validation accuracy : 0.934545 max acc epoch : 11 test accuracy : 0.940639

Epoch :  16 loss training:  5.432326829293743 Time :  119
accuracy train: 0.962432 val: 0.927273 test: 0.938813
max validation accuracy : 0.934545 max acc epoch : 11 test accuracy : 0.940639

Epoch :  17 loss training:  4.79613802061067 Time :  125
accuracy train: 0.948899 val: 0.901818 test: 0.922831
max validation accuracy : 0.934545 max acc epoch : 11 test accuracy : 0.940639

Epoch :  18 loss training:  4.494738357723691 Time :  131
accuracy train: 0.951121 val: 0.909091 test: 0.919635
max validation accuracy : 0.934545 max acc epoch : 11 test accuracy : 0.940639

Epoch :  19 loss training:  5.352104145873454 Time :  137
accuracy train: 0.954353 val: 0.920000 test: 0.925571
max validation accuracy : 0.934545 max acc epoch : 11 test accuracy : 0.940639

Epoch :  20 loss training:  4.295099673356162 Time :  143
accuracy train: 0.971521 val: 0.940000 test: 0.944292
max validation accuracy : 0.940000 max acc epoch : 20 test accuracy : 0.944292

Epoch :  21 loss training:  3.828330467127671 Time :  149
accuracy train: 0.944658 val: 0.910909 test: 0.923744
max validation accuracy : 0.940000 max acc epoch : 20 test accuracy : 0.944292

Epoch :  22 loss training:  3.252571853430709 Time :  156
accuracy train: 0.967885 val: 0.940000 test: 0.937443
max validation accuracy : 0.940000 max acc epoch : 20 test accuracy : 0.944292

Epoch :  23 loss training:  3.1908572561951587 Time :  163
accuracy train: 0.963240 val: 0.934545 test: 0.944292
max validation accuracy : 0.940000 max acc epoch : 20 test accuracy : 0.944292

Epoch :  24 loss training:  3.276395101333037 Time :  169
accuracy train: 0.949909 val: 0.921818 test: 0.927397
max validation accuracy : 0.940000 max acc epoch : 20 test accuracy : 0.944292

Epoch :  25 loss training:  3.1308753885969054 Time :  175
accuracy train: 0.970309 val: 0.941818 test: 0.940639
max validation accuracy : 0.941818 max acc epoch : 25 test accuracy : 0.940639

Epoch :  26 loss training:  3.4387999251230212 Time :  182
accuracy train: 0.961018 val: 0.923636 test: 0.934703
max validation accuracy : 0.941818 max acc epoch : 25 test accuracy : 0.940639

Epoch :  27 loss training:  3.706571233618888 Time :  189
accuracy train: 0.961220 val: 0.925455 test: 0.939726
max validation accuracy : 0.941818 max acc epoch : 25 test accuracy : 0.940639

Epoch :  28 loss training:  3.7291830022950307 Time :  196
accuracy train: 0.969097 val: 0.932727 test: 0.933333
max validation accuracy : 0.941818 max acc epoch : 25 test accuracy : 0.940639

Epoch :  29 loss training:  3.815865941141965 Time :  202
accuracy train: 0.964856 val: 0.934545 test: 0.934247
max validation accuracy : 0.941818 max acc epoch : 25 test accuracy : 0.940639

Epoch :  30 loss training:  3.6838500364829088 Time :  208
accuracy train: 0.951525 val: 0.914545 test: 0.925571
max validation accuracy : 0.941818 max acc epoch : 25 test accuracy : 0.940639

Epoch :  31 loss training:  3.062875182255084 Time :  215
accuracy train: 0.956170 val: 0.920000 test: 0.931050
max validation accuracy : 0.941818 max acc epoch : 25 test accuracy : 0.940639

Epoch :  32 loss training:  2.559671446251741 Time :  221
accuracy train: 0.961826 val: 0.923636 test: 0.937900
max validation accuracy : 0.941818 max acc epoch : 25 test accuracy : 0.940639

Epoch :  33 loss training:  2.7037642983668775 Time :  227
accuracy train: 0.955363 val: 0.923636 test: 0.934703
max validation accuracy : 0.941818 max acc epoch : 25 test accuracy : 0.940639

Epoch :  34 loss training:  3.38668526118272 Time :  233
accuracy train: 0.972329 val: 0.932727 test: 0.942922
max validation accuracy : 0.941818 max acc epoch : 25 test accuracy : 0.940639

Epoch :  35 loss training:  4.326212456959183 Time :  240
accuracy train: 0.958998 val: 0.923636 test: 0.934703
max validation accuracy : 0.941818 max acc epoch : 25 test accuracy : 0.940639

Epoch :  36 loss training:  3.025271654682001 Time :  246
accuracy train: 0.977782 val: 0.949091 test: 0.949315
max validation accuracy : 0.949091 max acc epoch : 36 test accuracy : 0.949315

Epoch :  37 loss training:  2.3261293123177893 Time :  253
accuracy train: 0.972127 val: 0.936364 test: 0.937443
max validation accuracy : 0.949091 max acc epoch : 36 test accuracy : 0.949315

Epoch :  38 loss training:  3.6229516716557555 Time :  259
accuracy train: 0.968491 val: 0.927273 test: 0.939269
max validation accuracy : 0.949091 max acc epoch : 36 test accuracy : 0.949315

Epoch :  39 loss training:  2.165702696849621 Time :  266
accuracy train: 0.966067 val: 0.932727 test: 0.935160
max validation accuracy : 0.949091 max acc epoch : 36 test accuracy : 0.949315

Epoch :  40 loss training:  1.719255264433741 Time :  273
accuracy train: 0.962230 val: 0.927273 test: 0.935160
max validation accuracy : 0.949091 max acc epoch : 36 test accuracy : 0.949315

Epoch :  41 loss training:  1.9394167655736965 Time :  279
accuracy train: 0.966875 val: 0.929091 test: 0.933790
max validation accuracy : 0.949091 max acc epoch : 36 test accuracy : 0.949315

Epoch :  42 loss training:  2.4880119950867083 Time :  285
accuracy train: 0.967885 val: 0.930909 test: 0.932877
max validation accuracy : 0.949091 max acc epoch : 36 test accuracy : 0.949315

Epoch :  43 loss training:  2.408207192849659 Time :  292
accuracy train: 0.956776 val: 0.920000 test: 0.928311
max validation accuracy : 0.949091 max acc epoch : 36 test accuracy : 0.949315

Epoch :  44 loss training:  1.825312549706723 Time :  299
accuracy train: 0.973743 val: 0.938182 test: 0.937443
max validation accuracy : 0.949091 max acc epoch : 36 test accuracy : 0.949315

Epoch :  45 loss training:  1.603674541835062 Time :  305
accuracy train: 0.969097 val: 0.938182 test: 0.941553
max validation accuracy : 0.949091 max acc epoch : 36 test accuracy : 0.949315

Epoch :  46 loss training:  2.114239903385169 Time :  312
accuracy train: 0.970107 val: 0.932727 test: 0.936073
max validation accuracy : 0.949091 max acc epoch : 36 test accuracy : 0.949315

Epoch :  47 loss training:  2.5665528951267333 Time :  318
accuracy train: 0.967077 val: 0.934545 test: 0.936530
max validation accuracy : 0.949091 max acc epoch : 36 test accuracy : 0.949315

Epoch :  48 loss training:  2.7627689401851967 Time :  325
accuracy train: 0.976772 val: 0.941818 test: 0.940183
max validation accuracy : 0.949091 max acc epoch : 36 test accuracy : 0.949315

Epoch :  49 loss training:  1.7264877021807479 Time :  331
accuracy train: 0.979196 val: 0.952727 test: 0.945662
max validation accuracy : 0.952727 max acc epoch : 49 test accuracy : 0.945662

Epoch :  50 loss training:  1.2476685859619465 Time :  337
accuracy train: 0.970309 val: 0.938182 test: 0.934703
max validation accuracy : 0.952727 max acc epoch : 49 test accuracy : 0.945662

Epoch :  51 loss training:  1.9748176179418806 Time :  343
accuracy train: 0.969097 val: 0.929091 test: 0.930594
max validation accuracy : 0.952727 max acc epoch : 49 test accuracy : 0.945662

Epoch :  52 loss training:  2.062589263106929 Time :  349
accuracy train: 0.965865 val: 0.923636 test: 0.931050
max validation accuracy : 0.952727 max acc epoch : 49 test accuracy : 0.945662

Epoch :  53 loss training:  2.0544617870400543 Time :  355
accuracy train: 0.976166 val: 0.929091 test: 0.931507
max validation accuracy : 0.952727 max acc epoch : 49 test accuracy : 0.945662

Epoch :  54 loss training:  1.6220260321788373 Time :  360
accuracy train: 0.959604 val: 0.925455 test: 0.923288
max validation accuracy : 0.952727 max acc epoch : 49 test accuracy : 0.945662

Epoch :  55 loss training:  1.3262698386806733 Time :  366
accuracy train: 0.969501 val: 0.932727 test: 0.925571
max validation accuracy : 0.952727 max acc epoch : 49 test accuracy : 0.945662

Epoch :  56 loss training:  1.4576293896279822 Time :  372
accuracy train: 0.977378 val: 0.930909 test: 0.936986
max validation accuracy : 0.952727 max acc epoch : 49 test accuracy : 0.945662

Epoch :  57 loss training:  1.3066487167188825 Time :  379
accuracy train: 0.957584 val: 0.918182 test: 0.922374
max validation accuracy : 0.952727 max acc epoch : 49 test accuracy : 0.945662

Epoch :  58 loss training:  2.7370998744954704 Time :  385
accuracy train: 0.971117 val: 0.938182 test: 0.926484
max validation accuracy : 0.952727 max acc epoch : 49 test accuracy : 0.945662

Epoch :  59 loss training:  2.328138412393855 Time :  392
accuracy train: 0.950919 val: 0.914545 test: 0.918265
max validation accuracy : 0.952727 max acc epoch : 49 test accuracy : 0.945662

Epoch :  60 loss training:  2.604428506863769 Time :  398
accuracy train: 0.971723 val: 0.934545 test: 0.929680
max validation accuracy : 0.952727 max acc epoch : 49 test accuracy : 0.945662

Epoch :  61 loss training:  2.0102371164175565 Time :  404
accuracy train: 0.987275 val: 0.947273 test: 0.945205
max validation accuracy : 0.952727 max acc epoch : 49 test accuracy : 0.945662

Epoch :  62 loss training:  2.932195465435143 Time :  411
accuracy train: 0.948697 val: 0.914545 test: 0.916895
max validation accuracy : 0.952727 max acc epoch : 49 test accuracy : 0.945662

Epoch :  63 loss training:  1.5150427717671846 Time :  418
accuracy train: 0.965865 val: 0.923636 test: 0.929680
max validation accuracy : 0.952727 max acc epoch : 49 test accuracy : 0.945662

Epoch :  64 loss training:  1.2732088468437723 Time :  424
accuracy train: 0.974349 val: 0.938182 test: 0.940639
max validation accuracy : 0.952727 max acc epoch : 49 test accuracy : 0.945662

Epoch :  65 loss training:  2.065394804254538 Time :  430
accuracy train: 0.964856 val: 0.929091 test: 0.922831
max validation accuracy : 0.952727 max acc epoch : 49 test accuracy : 0.945662

Epoch :  66 loss training:  1.6441414190021533 Time :  437
accuracy train: 0.978388 val: 0.934545 test: 0.941096
max validation accuracy : 0.952727 max acc epoch : 49 test accuracy : 0.945662

Epoch :  67 loss training:  1.6030123306500172 Time :  444
accuracy train: 0.975964 val: 0.929091 test: 0.936530
max validation accuracy : 0.952727 max acc epoch : 49 test accuracy : 0.945662

Epoch :  68 loss training:  1.580297517539293 Time :  450
accuracy train: 0.974551 val: 0.936364 test: 0.936530
max validation accuracy : 0.952727 max acc epoch : 49 test accuracy : 0.945662

Epoch :  69 loss training:  1.3881339301988191 Time :  457
accuracy train: 0.977984 val: 0.943636 test: 0.942922
max validation accuracy : 0.952727 max acc epoch : 49 test accuracy : 0.945662

Epoch :  70 loss training:  2.0733829635337315 Time :  463
accuracy train: 0.973541 val: 0.934545 test: 0.937443
max validation accuracy : 0.952727 max acc epoch : 49 test accuracy : 0.945662

========================================================================================================================================================================================================
max acc epoch :  49
max validation accuracy :  0.9527272727272728
test accuracy :  0.945662100456621
last test_accuracy :  0.9374429223744293
========================================================================================================================================================================================================

date and time :  Mon Mar 15 15:44:32 2021
Namespace(batch_size=128, dataset='R8', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=True, seed=0, weight_decay=1e-05)
device :  cuda:0
Counter({0: 1467, 3: 1321, 1: 1306, 2: 1251, 6: 1224, 5: 597, 7: 488, 4: 37})
HGNNModel(
  (word_embeddings): Embedding(8231, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=8, bias=True)
    (1): Linear(in_features=200, out_features=8, bias=True)
    (2): Linear(in_features=200, out_features=8, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  66.56098991632462 Time :  24
accuracy train: 0.800040 val: 0.767273 test: 0.788128
max validation accuracy : 0.767273 max acc epoch : 1 test accuracy : 0.788128

Epoch :  2 loss training:  35.53622514009476 Time :  29
accuracy train: 0.853363 val: 0.814545 test: 0.852511
max validation accuracy : 0.814545 max acc epoch : 2 test accuracy : 0.852511

Epoch :  3 loss training:  26.074281603097916 Time :  34
accuracy train: 0.904262 val: 0.865455 test: 0.894064
max validation accuracy : 0.865455 max acc epoch : 3 test accuracy : 0.894064

Epoch :  4 loss training:  18.82506701722741 Time :  40
accuracy train: 0.918602 val: 0.887273 test: 0.909589
max validation accuracy : 0.887273 max acc epoch : 4 test accuracy : 0.909589

Epoch :  5 loss training:  15.500546611845493 Time :  45
accuracy train: 0.917794 val: 0.880000 test: 0.901826
max validation accuracy : 0.887273 max acc epoch : 4 test accuracy : 0.909589

Epoch :  6 loss training:  11.208337150514126 Time :  50
accuracy train: 0.945668 val: 0.916364 test: 0.926027
max validation accuracy : 0.916364 max acc epoch : 6 test accuracy : 0.926027

Epoch :  7 loss training:  8.320206919685006 Time :  55
accuracy train: 0.944860 val: 0.901818 test: 0.919178
max validation accuracy : 0.916364 max acc epoch : 6 test accuracy : 0.926027

Epoch :  8 loss training:  6.899581250734627 Time :  60
accuracy train: 0.961624 val: 0.927273 test: 0.940183
max validation accuracy : 0.927273 max acc epoch : 8 test accuracy : 0.940183

Epoch :  9 loss training:  5.425269305240363 Time :  65
accuracy train: 0.961018 val: 0.914545 test: 0.926941
max validation accuracy : 0.927273 max acc epoch : 8 test accuracy : 0.940183

Epoch :  10 loss training:  4.173506502993405 Time :  70
accuracy train: 0.970511 val: 0.930909 test: 0.931963
max validation accuracy : 0.930909 max acc epoch : 10 test accuracy : 0.931963

Epoch :  11 loss training:  4.1494924336439 Time :  76
accuracy train: 0.969097 val: 0.921818 test: 0.926941
max validation accuracy : 0.930909 max acc epoch : 10 test accuracy : 0.931963

Epoch :  12 loss training:  2.8995654771570116 Time :  81
accuracy train: 0.982630 val: 0.929091 test: 0.939726
max validation accuracy : 0.930909 max acc epoch : 10 test accuracy : 0.931963

Epoch :  13 loss training:  1.9484965447336435 Time :  86
accuracy train: 0.984852 val: 0.936364 test: 0.942466
max validation accuracy : 0.936364 max acc epoch : 13 test accuracy : 0.942466

Epoch :  14 loss training:  5.283211950561963 Time :  91
accuracy train: 0.976368 val: 0.916364 test: 0.933333
max validation accuracy : 0.936364 max acc epoch : 13 test accuracy : 0.942466

Epoch :  15 loss training:  3.114811533363536 Time :  96
accuracy train: 0.974955 val: 0.927273 test: 0.936986
max validation accuracy : 0.936364 max acc epoch : 13 test accuracy : 0.942466

Epoch :  16 loss training:  2.0923001008632127 Time :  101
accuracy train: 0.952333 val: 0.887273 test: 0.912329
max validation accuracy : 0.936364 max acc epoch : 13 test accuracy : 0.942466

Epoch :  17 loss training:  2.64813792926725 Time :  106
accuracy train: 0.985457 val: 0.938182 test: 0.940183
max validation accuracy : 0.938182 max acc epoch : 17 test accuracy : 0.940183

Epoch :  18 loss training:  1.3243172744550975 Time :  111
accuracy train: 0.987073 val: 0.930909 test: 0.939726
max validation accuracy : 0.938182 max acc epoch : 17 test accuracy : 0.940183

Epoch :  19 loss training:  1.7244058305805083 Time :  116
accuracy train: 0.987477 val: 0.938182 test: 0.941553
max validation accuracy : 0.938182 max acc epoch : 17 test accuracy : 0.940183

Epoch :  20 loss training:  1.0765541469227173 Time :  121
accuracy train: 0.980408 val: 0.914545 test: 0.930137
max validation accuracy : 0.938182 max acc epoch : 17 test accuracy : 0.940183

Epoch :  21 loss training:  1.581942311313469 Time :  126
accuracy train: 0.985457 val: 0.929091 test: 0.935616
max validation accuracy : 0.938182 max acc epoch : 17 test accuracy : 0.940183

Epoch :  22 loss training:  0.9082717278797645 Time :  132
accuracy train: 0.985861 val: 0.934545 test: 0.942922
max validation accuracy : 0.938182 max acc epoch : 17 test accuracy : 0.940183

Epoch :  23 loss training:  1.100352451656363 Time :  137
accuracy train: 0.987477 val: 0.930909 test: 0.943836
max validation accuracy : 0.938182 max acc epoch : 17 test accuracy : 0.940183

Epoch :  24 loss training:  1.066750749705534 Time :  142
accuracy train: 0.990305 val: 0.938182 test: 0.942009
max validation accuracy : 0.938182 max acc epoch : 17 test accuracy : 0.940183

Epoch :  25 loss training:  0.48571716163132805 Time :  147
accuracy train: 0.992527 val: 0.934545 test: 0.944292
max validation accuracy : 0.938182 max acc epoch : 17 test accuracy : 0.940183

Epoch :  26 loss training:  0.8272165253620187 Time :  153
accuracy train: 0.989093 val: 0.932727 test: 0.940639
max validation accuracy : 0.938182 max acc epoch : 17 test accuracy : 0.940183

Epoch :  27 loss training:  2.1002595686768473 Time :  158
accuracy train: 0.981014 val: 0.936364 test: 0.940639
max validation accuracy : 0.938182 max acc epoch : 17 test accuracy : 0.940183

Epoch :  28 loss training:  1.1490685525241133 Time :  163
accuracy train: 0.989497 val: 0.936364 test: 0.940183
max validation accuracy : 0.938182 max acc epoch : 17 test accuracy : 0.940183

Epoch :  29 loss training:  0.8825888583060078 Time :  168
accuracy train: 0.989093 val: 0.927273 test: 0.941553
max validation accuracy : 0.938182 max acc epoch : 17 test accuracy : 0.940183

Epoch :  30 loss training:  3.0237385487425854 Time :  173
accuracy train: 0.980206 val: 0.930909 test: 0.939726
max validation accuracy : 0.938182 max acc epoch : 17 test accuracy : 0.940183

Epoch :  31 loss training:  1.298614864837873 Time :  178
accuracy train: 0.987275 val: 0.920000 test: 0.938356
max validation accuracy : 0.938182 max acc epoch : 17 test accuracy : 0.940183

Epoch :  32 loss training:  0.9729576899080712 Time :  183
accuracy train: 0.986871 val: 0.923636 test: 0.937900
max validation accuracy : 0.938182 max acc epoch : 17 test accuracy : 0.940183

Epoch :  33 loss training:  1.0283232432229852 Time :  189
accuracy train: 0.988487 val: 0.927273 test: 0.942466
max validation accuracy : 0.938182 max acc epoch : 17 test accuracy : 0.940183

Epoch :  34 loss training:  0.7902380348969018 Time :  194
accuracy train: 0.989093 val: 0.927273 test: 0.938813
max validation accuracy : 0.938182 max acc epoch : 17 test accuracy : 0.940183

Epoch :  35 loss training:  0.660263091644083 Time :  199
accuracy train: 0.986669 val: 0.932727 test: 0.932877
max validation accuracy : 0.938182 max acc epoch : 17 test accuracy : 0.940183

Epoch :  36 loss training:  0.7213131368132508 Time :  204
accuracy train: 0.982630 val: 0.918182 test: 0.929680
max validation accuracy : 0.938182 max acc epoch : 17 test accuracy : 0.940183

Epoch :  37 loss training:  0.33120995370882156 Time :  209
accuracy train: 0.985861 val: 0.923636 test: 0.933790
max validation accuracy : 0.938182 max acc epoch : 17 test accuracy : 0.940183

Epoch :  38 loss training:  0.8976728887910213 Time :  215
accuracy train: 0.992729 val: 0.930909 test: 0.943836
max validation accuracy : 0.938182 max acc epoch : 17 test accuracy : 0.940183

========================================================================================================================================================================================================
max acc epoch :  17
max validation accuracy :  0.9381818181818182
test accuracy :  0.9401826484018265
last test_accuracy :  0.9438356164383561
========================================================================================================================================================================================================

date and time :  Mon Mar 15 15:48:17 2021
Namespace(batch_size=128, dataset='R8', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=100, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=1e-05)
device :  cuda:0
Counter({0: 1467, 3: 1321, 1: 1306, 2: 1251, 6: 1224, 5: 597, 7: 488, 4: 37})
HGNNModel(
  (word_embeddings): Embedding(8231, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=8, bias=True)
    (1): Linear(in_features=100, out_features=8, bias=True)
    (2): Linear(in_features=100, out_features=8, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  60.77668875455856 Time :  25
accuracy train: 0.743688 val: 0.720000 test: 0.748402
max validation accuracy : 0.720000 max acc epoch : 1 test accuracy : 0.748402

Epoch :  2 loss training:  34.162158742547035 Time :  31
accuracy train: 0.863462 val: 0.830909 test: 0.867123
max validation accuracy : 0.830909 max acc epoch : 2 test accuracy : 0.867123

Epoch :  3 loss training:  26.376758188009262 Time :  37
accuracy train: 0.862250 val: 0.836364 test: 0.866210
max validation accuracy : 0.836364 max acc epoch : 3 test accuracy : 0.866210

Epoch :  4 loss training:  21.031222239136696 Time :  43
accuracy train: 0.898202 val: 0.869091 test: 0.903653
max validation accuracy : 0.869091 max acc epoch : 4 test accuracy : 0.903653

Epoch :  5 loss training:  18.831763349473476 Time :  48
accuracy train: 0.876995 val: 0.840000 test: 0.886301
max validation accuracy : 0.869091 max acc epoch : 4 test accuracy : 0.903653

Epoch :  6 loss training:  15.075457215309143 Time :  54
accuracy train: 0.899818 val: 0.876364 test: 0.905936
max validation accuracy : 0.876364 max acc epoch : 6 test accuracy : 0.905936

Epoch :  7 loss training:  13.868664298206568 Time :  60
accuracy train: 0.914361 val: 0.900000 test: 0.908676
max validation accuracy : 0.900000 max acc epoch : 7 test accuracy : 0.908676

Epoch :  8 loss training:  12.919352274388075 Time :  65
accuracy train: 0.873763 val: 0.867273 test: 0.893151
max validation accuracy : 0.900000 max acc epoch : 7 test accuracy : 0.908676

Epoch :  9 loss training:  12.51466635381803 Time :  71
accuracy train: 0.900424 val: 0.890909 test: 0.904110
max validation accuracy : 0.900000 max acc epoch : 7 test accuracy : 0.908676

Epoch :  10 loss training:  10.627353610470891 Time :  76
accuracy train: 0.854171 val: 0.840000 test: 0.874886
max validation accuracy : 0.900000 max acc epoch : 7 test accuracy : 0.908676

Epoch :  11 loss training:  9.518502548104152 Time :  82
accuracy train: 0.933953 val: 0.907273 test: 0.927854
max validation accuracy : 0.907273 max acc epoch : 11 test accuracy : 0.927854

Epoch :  12 loss training:  9.27162124379538 Time :  87
accuracy train: 0.902646 val: 0.892727 test: 0.904110
max validation accuracy : 0.907273 max acc epoch : 11 test accuracy : 0.927854

Epoch :  13 loss training:  7.5922474541002885 Time :  92
accuracy train: 0.908503 val: 0.901818 test: 0.915982
max validation accuracy : 0.907273 max acc epoch : 11 test accuracy : 0.927854

Epoch :  14 loss training:  9.047535315621644 Time :  98
accuracy train: 0.934761 val: 0.910909 test: 0.930594
max validation accuracy : 0.910909 max acc epoch : 14 test accuracy : 0.930594

Epoch :  15 loss training:  7.398469650419429 Time :  103
accuracy train: 0.888305 val: 0.865455 test: 0.896347
max validation accuracy : 0.910909 max acc epoch : 14 test accuracy : 0.930594

Epoch :  16 loss training:  6.469411263125949 Time :  109
accuracy train: 0.900424 val: 0.881818 test: 0.907306
max validation accuracy : 0.910909 max acc epoch : 14 test accuracy : 0.930594

Epoch :  17 loss training:  5.924713809392415 Time :  114
accuracy train: 0.921834 val: 0.905455 test: 0.921005
max validation accuracy : 0.910909 max acc epoch : 14 test accuracy : 0.930594

Epoch :  18 loss training:  6.704769665229833 Time :  120
accuracy train: 0.877600 val: 0.865455 test: 0.891324
max validation accuracy : 0.910909 max acc epoch : 14 test accuracy : 0.930594

Epoch :  19 loss training:  6.649767836541287 Time :  126
accuracy train: 0.954151 val: 0.909091 test: 0.928311
max validation accuracy : 0.910909 max acc epoch : 14 test accuracy : 0.930594

Epoch :  20 loss training:  5.886492787045427 Time :  131
accuracy train: 0.908705 val: 0.896364 test: 0.913242
max validation accuracy : 0.910909 max acc epoch : 14 test accuracy : 0.930594

Epoch :  21 loss training:  5.325850935128983 Time :  136
accuracy train: 0.913755 val: 0.887273 test: 0.889954
max validation accuracy : 0.910909 max acc epoch : 14 test accuracy : 0.930594

Epoch :  22 loss training:  6.5379768566344865 Time :  141
accuracy train: 0.898000 val: 0.887273 test: 0.902283
max validation accuracy : 0.910909 max acc epoch : 14 test accuracy : 0.930594

Epoch :  23 loss training:  5.278676391826593 Time :  146
accuracy train: 0.917592 val: 0.883636 test: 0.900913
max validation accuracy : 0.910909 max acc epoch : 14 test accuracy : 0.930594

Epoch :  24 loss training:  4.5915070189512335 Time :  151
accuracy train: 0.924662 val: 0.903636 test: 0.915068
max validation accuracy : 0.910909 max acc epoch : 14 test accuracy : 0.930594

Epoch :  25 loss training:  4.7864563324983465 Time :  156
accuracy train: 0.882044 val: 0.872727 test: 0.892694
max validation accuracy : 0.910909 max acc epoch : 14 test accuracy : 0.930594

Epoch :  26 loss training:  5.071318987291306 Time :  161
accuracy train: 0.924460 val: 0.900000 test: 0.899087
max validation accuracy : 0.910909 max acc epoch : 14 test accuracy : 0.930594

Epoch :  27 loss training:  5.372530717490008 Time :  166
accuracy train: 0.898202 val: 0.892727 test: 0.899543
max validation accuracy : 0.910909 max acc epoch : 14 test accuracy : 0.930594

Epoch :  28 loss training:  4.283960173648666 Time :  171
accuracy train: 0.932943 val: 0.914545 test: 0.918265
max validation accuracy : 0.914545 max acc epoch : 28 test accuracy : 0.918265

Epoch :  29 loss training:  3.945905315791606 Time :  176
accuracy train: 0.898404 val: 0.874545 test: 0.884475
max validation accuracy : 0.914545 max acc epoch : 28 test accuracy : 0.918265

Epoch :  30 loss training:  6.279554260130681 Time :  181
accuracy train: 0.911937 val: 0.903636 test: 0.908676
max validation accuracy : 0.914545 max acc epoch : 28 test accuracy : 0.918265

Epoch :  31 loss training:  5.202803395332012 Time :  187
accuracy train: 0.919410 val: 0.883636 test: 0.896804
max validation accuracy : 0.914545 max acc epoch : 28 test accuracy : 0.918265

Epoch :  32 loss training:  4.513047728978563 Time :  192
accuracy train: 0.895173 val: 0.878182 test: 0.905479
max validation accuracy : 0.914545 max acc epoch : 28 test accuracy : 0.918265

Epoch :  33 loss training:  4.0519698609932675 Time :  197
accuracy train: 0.939608 val: 0.921818 test: 0.928767
max validation accuracy : 0.921818 max acc epoch : 33 test accuracy : 0.928767

Epoch :  34 loss training:  4.263677418821317 Time :  202
accuracy train: 0.934761 val: 0.909091 test: 0.912329
max validation accuracy : 0.921818 max acc epoch : 33 test accuracy : 0.928767

Epoch :  35 loss training:  3.441467434509832 Time :  207
accuracy train: 0.944658 val: 0.918182 test: 0.931963
max validation accuracy : 0.921818 max acc epoch : 33 test accuracy : 0.928767

Epoch :  36 loss training:  2.748707807430037 Time :  212
accuracy train: 0.946072 val: 0.920000 test: 0.933333
max validation accuracy : 0.921818 max acc epoch : 33 test accuracy : 0.928767

Epoch :  37 loss training:  2.7872542174882255 Time :  217
accuracy train: 0.960816 val: 0.936364 test: 0.947032
max validation accuracy : 0.936364 max acc epoch : 37 test accuracy : 0.947032

Epoch :  38 loss training:  2.61855519094388 Time :  222
accuracy train: 0.941628 val: 0.914545 test: 0.923288
max validation accuracy : 0.936364 max acc epoch : 37 test accuracy : 0.947032

Epoch :  39 loss training:  2.88503678804409 Time :  227
accuracy train: 0.951727 val: 0.920000 test: 0.929680
max validation accuracy : 0.936364 max acc epoch : 37 test accuracy : 0.947032

Epoch :  40 loss training:  4.513792704525258 Time :  232
accuracy train: 0.940416 val: 0.914545 test: 0.917808
max validation accuracy : 0.936364 max acc epoch : 37 test accuracy : 0.947032

Epoch :  41 loss training:  7.702375620661769 Time :  237
accuracy train: 0.916583 val: 0.892727 test: 0.920091
max validation accuracy : 0.936364 max acc epoch : 37 test accuracy : 0.947032

Epoch :  42 loss training:  3.7492488485586364 Time :  242
accuracy train: 0.925672 val: 0.896364 test: 0.916895
max validation accuracy : 0.936364 max acc epoch : 37 test accuracy : 0.947032

Epoch :  43 loss training:  3.3834667388000526 Time :  247
accuracy train: 0.934559 val: 0.894545 test: 0.920091
max validation accuracy : 0.936364 max acc epoch : 37 test accuracy : 0.947032

Epoch :  44 loss training:  3.0057670099049574 Time :  252
accuracy train: 0.941426 val: 0.898182 test: 0.919635
max validation accuracy : 0.936364 max acc epoch : 37 test accuracy : 0.947032

Epoch :  45 loss training:  2.7138379960924794 Time :  258
accuracy train: 0.951525 val: 0.929091 test: 0.936530
max validation accuracy : 0.936364 max acc epoch : 37 test accuracy : 0.947032

Epoch :  46 loss training:  2.4781197282281937 Time :  263
accuracy train: 0.924258 val: 0.905455 test: 0.920548
max validation accuracy : 0.936364 max acc epoch : 37 test accuracy : 0.947032

Epoch :  47 loss training:  2.3229095559945563 Time :  269
accuracy train: 0.946273 val: 0.923636 test: 0.932877
max validation accuracy : 0.936364 max acc epoch : 37 test accuracy : 0.947032

Epoch :  48 loss training:  3.033843884608359 Time :  274
accuracy train: 0.947687 val: 0.930909 test: 0.929680
max validation accuracy : 0.936364 max acc epoch : 37 test accuracy : 0.947032

Epoch :  49 loss training:  5.1268290535663255 Time :  279
accuracy train: 0.934155 val: 0.900000 test: 0.926027
max validation accuracy : 0.936364 max acc epoch : 37 test accuracy : 0.947032

Epoch :  50 loss training:  4.480917841407063 Time :  284
accuracy train: 0.957584 val: 0.927273 test: 0.939726
max validation accuracy : 0.936364 max acc epoch : 37 test accuracy : 0.947032

Epoch :  51 loss training:  4.801902327752032 Time :  289
accuracy train: 0.946677 val: 0.903636 test: 0.933333
max validation accuracy : 0.936364 max acc epoch : 37 test accuracy : 0.947032

Epoch :  52 loss training:  3.946359948393365 Time :  295
accuracy train: 0.934357 val: 0.918182 test: 0.931963
max validation accuracy : 0.936364 max acc epoch : 37 test accuracy : 0.947032

Epoch :  53 loss training:  3.3138315718169906 Time :  300
accuracy train: 0.952737 val: 0.920000 test: 0.937443
max validation accuracy : 0.936364 max acc epoch : 37 test accuracy : 0.947032

Epoch :  54 loss training:  7.029128495370969 Time :  306
accuracy train: 0.938800 val: 0.927273 test: 0.931963
max validation accuracy : 0.936364 max acc epoch : 37 test accuracy : 0.947032

Epoch :  55 loss training:  4.200885729747824 Time :  311
accuracy train: 0.958594 val: 0.929091 test: 0.947032
max validation accuracy : 0.936364 max acc epoch : 37 test accuracy : 0.947032

Epoch :  56 loss training:  3.638110897067236 Time :  316
accuracy train: 0.944052 val: 0.912727 test: 0.933333
max validation accuracy : 0.936364 max acc epoch : 37 test accuracy : 0.947032

Epoch :  57 loss training:  3.5638205826398917 Time :  321
accuracy train: 0.935973 val: 0.914545 test: 0.932877
max validation accuracy : 0.936364 max acc epoch : 37 test accuracy : 0.947032

Epoch :  58 loss training:  2.5471782851964235 Time :  326
accuracy train: 0.951323 val: 0.923636 test: 0.940183
max validation accuracy : 0.936364 max acc epoch : 37 test accuracy : 0.947032

========================================================================================================================================================================================================
max acc epoch :  37
max validation accuracy :  0.9363636363636364
test accuracy :  0.9470319634703196
last test_accuracy :  0.9401826484018265
========================================================================================================================================================================================================

date and time :  Mon Mar 15 15:53:54 2021
Namespace(batch_size=128, dataset='R8', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=100, lda=True, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=1e-05)
device :  cuda:0
Counter({7: 1488, 4: 1299, 6: 1285, 2: 1260, 3: 1250, 5: 597, 1: 475, 0: 37})
HGNNModel(
  (word_embeddings): Embedding(8231, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=8, bias=True)
    (1): Linear(in_features=100, out_features=8, bias=True)
    (2): Linear(in_features=100, out_features=8, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  65.91350662708282 Time :  19
accuracy train: 0.727530 val: 0.705455 test: 0.720548
max validation accuracy : 0.705455 max acc epoch : 1 test accuracy : 0.720548

Epoch :  2 loss training:  36.13952702283859 Time :  26
accuracy train: 0.883862 val: 0.841818 test: 0.882192
max validation accuracy : 0.841818 max acc epoch : 2 test accuracy : 0.882192

Epoch :  3 loss training:  27.423310413956642 Time :  32
accuracy train: 0.911735 val: 0.883636 test: 0.904110
max validation accuracy : 0.883636 max acc epoch : 3 test accuracy : 0.904110

Epoch :  4 loss training:  21.035079903900623 Time :  38
accuracy train: 0.916179 val: 0.883636 test: 0.904110
max validation accuracy : 0.883636 max acc epoch : 3 test accuracy : 0.904110

Epoch :  5 loss training:  18.16454589739442 Time :  44
accuracy train: 0.930115 val: 0.901818 test: 0.921918
max validation accuracy : 0.901818 max acc epoch : 5 test accuracy : 0.921918

Epoch :  6 loss training:  16.105707865208387 Time :  50
accuracy train: 0.936780 val: 0.907273 test: 0.922374
max validation accuracy : 0.907273 max acc epoch : 6 test accuracy : 0.922374

Epoch :  7 loss training:  13.43221908994019 Time :  55
accuracy train: 0.947889 val: 0.923636 test: 0.934247
max validation accuracy : 0.923636 max acc epoch : 7 test accuracy : 0.934247

Epoch :  8 loss training:  11.236136914230883 Time :  62
accuracy train: 0.942840 val: 0.918182 test: 0.928311
max validation accuracy : 0.923636 max acc epoch : 7 test accuracy : 0.934247

Epoch :  9 loss training:  9.940858210437 Time :  68
accuracy train: 0.949101 val: 0.925455 test: 0.931507
max validation accuracy : 0.925455 max acc epoch : 9 test accuracy : 0.931507

Epoch :  10 loss training:  8.616440904326737 Time :  75
accuracy train: 0.954959 val: 0.930909 test: 0.932877
max validation accuracy : 0.930909 max acc epoch : 10 test accuracy : 0.932877

Epoch :  11 loss training:  8.747664655558765 Time :  82
accuracy train: 0.949505 val: 0.921818 test: 0.927397
max validation accuracy : 0.930909 max acc epoch : 10 test accuracy : 0.932877

Epoch :  12 loss training:  7.687773537822068 Time :  88
accuracy train: 0.960008 val: 0.934545 test: 0.937443
max validation accuracy : 0.934545 max acc epoch : 12 test accuracy : 0.937443

Epoch :  13 loss training:  7.316034485236742 Time :  96
accuracy train: 0.956574 val: 0.929091 test: 0.935160
max validation accuracy : 0.934545 max acc epoch : 12 test accuracy : 0.937443

Epoch :  14 loss training:  6.816316428361461 Time :  103
accuracy train: 0.960412 val: 0.936364 test: 0.938356
max validation accuracy : 0.936364 max acc epoch : 14 test accuracy : 0.938356

Epoch :  15 loss training:  6.189804013818502 Time :  109
accuracy train: 0.953141 val: 0.918182 test: 0.925114
max validation accuracy : 0.936364 max acc epoch : 14 test accuracy : 0.938356

Epoch :  16 loss training:  5.954846410895698 Time :  116
accuracy train: 0.958594 val: 0.934545 test: 0.940183
max validation accuracy : 0.936364 max acc epoch : 14 test accuracy : 0.938356

Epoch :  17 loss training:  5.763063705409877 Time :  122
accuracy train: 0.962028 val: 0.934545 test: 0.933333
max validation accuracy : 0.936364 max acc epoch : 14 test accuracy : 0.938356

Epoch :  18 loss training:  5.197052809002344 Time :  129
accuracy train: 0.960008 val: 0.938182 test: 0.933790
max validation accuracy : 0.938182 max acc epoch : 18 test accuracy : 0.933790

Epoch :  19 loss training:  5.184931207812042 Time :  135
accuracy train: 0.954151 val: 0.925455 test: 0.926027
max validation accuracy : 0.938182 max acc epoch : 18 test accuracy : 0.933790

Epoch :  20 loss training:  5.243871453130851 Time :  141
accuracy train: 0.968289 val: 0.936364 test: 0.943379
max validation accuracy : 0.938182 max acc epoch : 18 test accuracy : 0.933790

Epoch :  21 loss training:  4.606994427362224 Time :  148
accuracy train: 0.948293 val: 0.909091 test: 0.918721
max validation accuracy : 0.938182 max acc epoch : 18 test accuracy : 0.933790

Epoch :  22 loss training:  5.090453101278399 Time :  154
accuracy train: 0.964048 val: 0.930909 test: 0.946575
max validation accuracy : 0.938182 max acc epoch : 18 test accuracy : 0.933790

Epoch :  23 loss training:  3.6224214098911034 Time :  161
accuracy train: 0.970107 val: 0.941818 test: 0.942466
max validation accuracy : 0.941818 max acc epoch : 23 test accuracy : 0.942466

Epoch :  24 loss training:  4.161434772890061 Time :  166
accuracy train: 0.965058 val: 0.932727 test: 0.935160
max validation accuracy : 0.941818 max acc epoch : 23 test accuracy : 0.942466

Epoch :  25 loss training:  3.5945168075268157 Time :  172
accuracy train: 0.966269 val: 0.927273 test: 0.936986
max validation accuracy : 0.941818 max acc epoch : 23 test accuracy : 0.942466

Epoch :  26 loss training:  4.17248575771373 Time :  178
accuracy train: 0.970309 val: 0.930909 test: 0.944292
max validation accuracy : 0.941818 max acc epoch : 23 test accuracy : 0.942466

Epoch :  27 loss training:  4.083441347902408 Time :  184
accuracy train: 0.962836 val: 0.925455 test: 0.934703
max validation accuracy : 0.941818 max acc epoch : 23 test accuracy : 0.942466

Epoch :  28 loss training:  3.9763700345502 Time :  191
accuracy train: 0.961624 val: 0.929091 test: 0.938356
max validation accuracy : 0.941818 max acc epoch : 23 test accuracy : 0.942466

Epoch :  29 loss training:  4.083638236130355 Time :  197
accuracy train: 0.961422 val: 0.936364 test: 0.933333
max validation accuracy : 0.941818 max acc epoch : 23 test accuracy : 0.942466

Epoch :  30 loss training:  2.911084405510337 Time :  203
accuracy train: 0.968491 val: 0.938182 test: 0.943379
max validation accuracy : 0.941818 max acc epoch : 23 test accuracy : 0.942466

Epoch :  31 loss training:  3.2871517127132392 Time :  209
accuracy train: 0.973137 val: 0.943636 test: 0.941096
max validation accuracy : 0.943636 max acc epoch : 31 test accuracy : 0.941096

Epoch :  32 loss training:  2.764006075398356 Time :  216
accuracy train: 0.968491 val: 0.934545 test: 0.940183
max validation accuracy : 0.943636 max acc epoch : 31 test accuracy : 0.941096

Epoch :  33 loss training:  3.554086852913315 Time :  223
accuracy train: 0.974753 val: 0.943636 test: 0.940183
max validation accuracy : 0.943636 max acc epoch : 31 test accuracy : 0.941096

Epoch :  34 loss training:  3.0215367465680174 Time :  229
accuracy train: 0.976166 val: 0.940000 test: 0.942009
max validation accuracy : 0.943636 max acc epoch : 31 test accuracy : 0.941096

Epoch :  35 loss training:  2.4688434268318815 Time :  236
accuracy train: 0.969905 val: 0.934545 test: 0.935616
max validation accuracy : 0.943636 max acc epoch : 31 test accuracy : 0.941096

Epoch :  36 loss training:  2.7592405285759014 Time :  242
accuracy train: 0.974955 val: 0.934545 test: 0.941096
max validation accuracy : 0.943636 max acc epoch : 31 test accuracy : 0.941096

Epoch :  37 loss training:  2.9205036878192914 Time :  249
accuracy train: 0.977580 val: 0.938182 test: 0.942009
max validation accuracy : 0.943636 max acc epoch : 31 test accuracy : 0.941096

Epoch :  38 loss training:  2.954044917023566 Time :  256
accuracy train: 0.969905 val: 0.934545 test: 0.940183
max validation accuracy : 0.943636 max acc epoch : 31 test accuracy : 0.941096

Epoch :  39 loss training:  3.0060743657377316 Time :  262
accuracy train: 0.958594 val: 0.921818 test: 0.927397
max validation accuracy : 0.943636 max acc epoch : 31 test accuracy : 0.941096

Epoch :  40 loss training:  2.6423278550319083 Time :  269
accuracy train: 0.972329 val: 0.930909 test: 0.937900
max validation accuracy : 0.943636 max acc epoch : 31 test accuracy : 0.941096

Epoch :  41 loss training:  2.5899402057402767 Time :  275
accuracy train: 0.971117 val: 0.934545 test: 0.936073
max validation accuracy : 0.943636 max acc epoch : 31 test accuracy : 0.941096

Epoch :  42 loss training:  2.700783270483953 Time :  281
accuracy train: 0.974955 val: 0.940000 test: 0.937443
max validation accuracy : 0.943636 max acc epoch : 31 test accuracy : 0.941096

Epoch :  43 loss training:  2.4697299725849007 Time :  288
accuracy train: 0.974955 val: 0.945455 test: 0.945662
max validation accuracy : 0.945455 max acc epoch : 43 test accuracy : 0.945662

Epoch :  44 loss training:  2.816531494450828 Time :  294
accuracy train: 0.973137 val: 0.940000 test: 0.941553
max validation accuracy : 0.945455 max acc epoch : 43 test accuracy : 0.945662

Epoch :  45 loss training:  2.2694244566264388 Time :  300
accuracy train: 0.979600 val: 0.945455 test: 0.951142
max validation accuracy : 0.945455 max acc epoch : 43 test accuracy : 0.945662

Epoch :  46 loss training:  3.117950229527196 Time :  306
accuracy train: 0.978994 val: 0.943636 test: 0.948858
max validation accuracy : 0.945455 max acc epoch : 43 test accuracy : 0.945662

Epoch :  47 loss training:  2.510882482769375 Time :  313
accuracy train: 0.980004 val: 0.952727 test: 0.951142
max validation accuracy : 0.952727 max acc epoch : 47 test accuracy : 0.951142

Epoch :  48 loss training:  2.774922005730332 Time :  320
accuracy train: 0.979196 val: 0.932727 test: 0.948858
max validation accuracy : 0.952727 max acc epoch : 47 test accuracy : 0.951142

Epoch :  49 loss training:  3.8367512901168084 Time :  327
accuracy train: 0.978186 val: 0.938182 test: 0.938813
max validation accuracy : 0.952727 max acc epoch : 47 test accuracy : 0.951142

Epoch :  50 loss training:  3.295946274554808 Time :  333
accuracy train: 0.985861 val: 0.949091 test: 0.948858
max validation accuracy : 0.952727 max acc epoch : 47 test accuracy : 0.951142

Epoch :  51 loss training:  2.738313373465644 Time :  339
accuracy train: 0.981216 val: 0.949091 test: 0.943836
max validation accuracy : 0.952727 max acc epoch : 47 test accuracy : 0.951142

Epoch :  52 loss training:  3.3047788659241633 Time :  346
accuracy train: 0.984448 val: 0.945455 test: 0.948858
max validation accuracy : 0.952727 max acc epoch : 47 test accuracy : 0.951142

Epoch :  53 loss training:  1.763216163177276 Time :  352
accuracy train: 0.978590 val: 0.945455 test: 0.946575
max validation accuracy : 0.952727 max acc epoch : 47 test accuracy : 0.951142

Epoch :  54 loss training:  2.663565845165067 Time :  358
accuracy train: 0.981216 val: 0.947273 test: 0.946119
max validation accuracy : 0.952727 max acc epoch : 47 test accuracy : 0.951142

Epoch :  55 loss training:  2.348724794886948 Time :  365
accuracy train: 0.980610 val: 0.943636 test: 0.948858
max validation accuracy : 0.952727 max acc epoch : 47 test accuracy : 0.951142

Epoch :  56 loss training:  1.7052591859628592 Time :  371
accuracy train: 0.980004 val: 0.940000 test: 0.942466
max validation accuracy : 0.952727 max acc epoch : 47 test accuracy : 0.951142

Epoch :  57 loss training:  2.166080167164182 Time :  377
accuracy train: 0.978388 val: 0.940000 test: 0.946575
max validation accuracy : 0.952727 max acc epoch : 47 test accuracy : 0.951142

Epoch :  58 loss training:  2.2428681871861045 Time :  384
accuracy train: 0.969703 val: 0.938182 test: 0.938356
max validation accuracy : 0.952727 max acc epoch : 47 test accuracy : 0.951142

Epoch :  59 loss training:  2.2934535178210353 Time :  390
accuracy train: 0.977580 val: 0.940000 test: 0.945662
max validation accuracy : 0.952727 max acc epoch : 47 test accuracy : 0.951142

Epoch :  60 loss training:  1.6960377720142787 Time :  396
accuracy train: 0.967885 val: 0.927273 test: 0.939726
max validation accuracy : 0.952727 max acc epoch : 47 test accuracy : 0.951142

Epoch :  61 loss training:  1.6190244678909949 Time :  402
accuracy train: 0.988891 val: 0.945455 test: 0.952511
max validation accuracy : 0.952727 max acc epoch : 47 test accuracy : 0.951142

Epoch :  62 loss training:  1.2686705468986474 Time :  408
accuracy train: 0.962028 val: 0.920000 test: 0.926941
max validation accuracy : 0.952727 max acc epoch : 47 test accuracy : 0.951142

Epoch :  63 loss training:  1.7576015511167498 Time :  414
accuracy train: 0.974551 val: 0.936364 test: 0.939269
max validation accuracy : 0.952727 max acc epoch : 47 test accuracy : 0.951142

Epoch :  64 loss training:  1.95466986856718 Time :  420
accuracy train: 0.970713 val: 0.936364 test: 0.936986
max validation accuracy : 0.952727 max acc epoch : 47 test accuracy : 0.951142

Epoch :  65 loss training:  2.006356148159739 Time :  425
accuracy train: 0.976166 val: 0.938182 test: 0.941553
max validation accuracy : 0.952727 max acc epoch : 47 test accuracy : 0.951142

Epoch :  66 loss training:  1.7900729049388246 Time :  431
accuracy train: 0.981014 val: 0.945455 test: 0.942922
max validation accuracy : 0.952727 max acc epoch : 47 test accuracy : 0.951142

Epoch :  67 loss training:  1.9689395252289614 Time :  437
accuracy train: 0.977378 val: 0.940000 test: 0.944292
max validation accuracy : 0.952727 max acc epoch : 47 test accuracy : 0.951142

Epoch :  68 loss training:  1.472449021803186 Time :  444
accuracy train: 0.985256 val: 0.943636 test: 0.949315
max validation accuracy : 0.952727 max acc epoch : 47 test accuracy : 0.951142

========================================================================================================================================================================================================
max acc epoch :  47
max validation accuracy :  0.9527272727272728
test accuracy :  0.9511415525114155
last test_accuracy :  0.9493150684931507
========================================================================================================================================================================================================

date and time :  Mon Mar 15 16:01:30 2021
Namespace(batch_size=128, dataset='R8', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=100, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=True, seed=0, weight_decay=1e-05)
device :  cuda:0
Counter({0: 1467, 3: 1321, 1: 1306, 2: 1251, 6: 1224, 5: 597, 7: 488, 4: 37})
HGNNModel(
  (word_embeddings): Embedding(8231, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (mlp2): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=100, out_features=100, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (batch_norms2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=100, out_features=100, bias=True)
        (W_hr): Linear(in_features=100, out_features=100, bias=True)
        (W_in): Linear(in_features=100, out_features=100, bias=True)
        (W_hn): Linear(in_features=100, out_features=100, bias=True)
        (W_iz): Linear(in_features=100, out_features=100, bias=True)
        (W_hz): Linear(in_features=100, out_features=100, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=8, bias=True)
    (1): Linear(in_features=100, out_features=8, bias=True)
    (2): Linear(in_features=100, out_features=8, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=100, out_features=100, bias=False)
        (1): Linear(in_features=100, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  67.75599986314774 Time :  20
accuracy train: 0.725308 val: 0.720000 test: 0.717352
max validation accuracy : 0.720000 max acc epoch : 1 test accuracy : 0.717352

Epoch :  2 loss training:  36.7824165225029 Time :  26
accuracy train: 0.856595 val: 0.820000 test: 0.852055
max validation accuracy : 0.820000 max acc epoch : 2 test accuracy : 0.852055

Epoch :  3 loss training:  25.456550896167755 Time :  31
accuracy train: 0.893153 val: 0.852727 test: 0.875342
max validation accuracy : 0.852727 max acc epoch : 3 test accuracy : 0.875342

Epoch :  4 loss training:  19.073944497853518 Time :  36
accuracy train: 0.904868 val: 0.861818 test: 0.887671
max validation accuracy : 0.861818 max acc epoch : 4 test accuracy : 0.887671

Epoch :  5 loss training:  15.710995560511947 Time :  42
accuracy train: 0.927085 val: 0.889091 test: 0.914612
max validation accuracy : 0.889091 max acc epoch : 5 test accuracy : 0.914612

Epoch :  6 loss training:  11.462757343426347 Time :  47
accuracy train: 0.917390 val: 0.881818 test: 0.903196
max validation accuracy : 0.889091 max acc epoch : 5 test accuracy : 0.914612

Epoch :  7 loss training:  9.203466684557498 Time :  52
accuracy train: 0.925066 val: 0.889091 test: 0.914155
max validation accuracy : 0.889091 max acc epoch : 5 test accuracy : 0.914612

Epoch :  8 loss training:  8.414586530532688 Time :  57
accuracy train: 0.942436 val: 0.896364 test: 0.922374
max validation accuracy : 0.896364 max acc epoch : 8 test accuracy : 0.922374

Epoch :  9 loss training:  6.604403937002644 Time :  62
accuracy train: 0.957988 val: 0.914545 test: 0.932420
max validation accuracy : 0.914545 max acc epoch : 9 test accuracy : 0.932420

Epoch :  10 loss training:  4.659005792229436 Time :  68
accuracy train: 0.969703 val: 0.921818 test: 0.937443
max validation accuracy : 0.921818 max acc epoch : 10 test accuracy : 0.937443

Epoch :  11 loss training:  4.183251739130355 Time :  73
accuracy train: 0.969299 val: 0.927273 test: 0.935616
max validation accuracy : 0.927273 max acc epoch : 11 test accuracy : 0.935616

Epoch :  12 loss training:  3.6423612811486237 Time :  78
accuracy train: 0.973945 val: 0.912727 test: 0.934247
max validation accuracy : 0.927273 max acc epoch : 11 test accuracy : 0.935616

Epoch :  13 loss training:  3.489787525148131 Time :  83
accuracy train: 0.973137 val: 0.925455 test: 0.934247
max validation accuracy : 0.927273 max acc epoch : 11 test accuracy : 0.935616

Epoch :  14 loss training:  3.3714897981844842 Time :  88
accuracy train: 0.986265 val: 0.932727 test: 0.943379
max validation accuracy : 0.932727 max acc epoch : 14 test accuracy : 0.943379

Epoch :  15 loss training:  2.202839789708378 Time :  93
accuracy train: 0.983438 val: 0.927273 test: 0.940639
max validation accuracy : 0.932727 max acc epoch : 14 test accuracy : 0.943379

Epoch :  16 loss training:  1.6258882861293387 Time :  98
accuracy train: 0.990305 val: 0.936364 test: 0.946575
max validation accuracy : 0.936364 max acc epoch : 16 test accuracy : 0.946575

Epoch :  17 loss training:  2.0848773820252973 Time :  103
accuracy train: 0.981822 val: 0.914545 test: 0.931507
max validation accuracy : 0.936364 max acc epoch : 16 test accuracy : 0.946575

Epoch :  18 loss training:  1.9429965043673292 Time :  108
accuracy train: 0.985861 val: 0.932727 test: 0.943379
max validation accuracy : 0.936364 max acc epoch : 16 test accuracy : 0.946575

Epoch :  19 loss training:  1.4779280943839694 Time :  113
accuracy train: 0.985659 val: 0.927273 test: 0.937443
max validation accuracy : 0.936364 max acc epoch : 16 test accuracy : 0.946575

Epoch :  20 loss training:  1.561302318557864 Time :  118
accuracy train: 0.990103 val: 0.932727 test: 0.942922
max validation accuracy : 0.936364 max acc epoch : 16 test accuracy : 0.946575

Epoch :  21 loss training:  1.0385906538140262 Time :  123
accuracy train: 0.987275 val: 0.932727 test: 0.940183
max validation accuracy : 0.936364 max acc epoch : 16 test accuracy : 0.946575

Epoch :  22 loss training:  0.7444728310074424 Time :  128
accuracy train: 0.987679 val: 0.929091 test: 0.941553
max validation accuracy : 0.936364 max acc epoch : 16 test accuracy : 0.946575

Epoch :  23 loss training:  0.923790300359542 Time :  134
accuracy train: 0.992931 val: 0.938182 test: 0.942922
max validation accuracy : 0.938182 max acc epoch : 23 test accuracy : 0.942922

Epoch :  24 loss training:  0.7490041489691066 Time :  139
accuracy train: 0.990507 val: 0.930909 test: 0.938813
max validation accuracy : 0.938182 max acc epoch : 23 test accuracy : 0.942922

Epoch :  25 loss training:  0.9185670668484818 Time :  144
accuracy train: 0.993335 val: 0.940000 test: 0.943379
max validation accuracy : 0.940000 max acc epoch : 25 test accuracy : 0.943379

Epoch :  26 loss training:  1.0548688824892452 Time :  149
accuracy train: 0.992527 val: 0.930909 test: 0.942466
max validation accuracy : 0.940000 max acc epoch : 25 test accuracy : 0.943379

Epoch :  27 loss training:  1.1696413843637856 Time :  154
accuracy train: 0.991315 val: 0.943636 test: 0.944292
max validation accuracy : 0.943636 max acc epoch : 27 test accuracy : 0.944292

Epoch :  28 loss training:  0.9613281625443051 Time :  159
accuracy train: 0.992527 val: 0.938182 test: 0.942466
max validation accuracy : 0.943636 max acc epoch : 27 test accuracy : 0.944292

Epoch :  29 loss training:  0.6296590423298767 Time :  164
accuracy train: 0.992123 val: 0.941818 test: 0.945662
max validation accuracy : 0.943636 max acc epoch : 27 test accuracy : 0.944292

Epoch :  30 loss training:  2.2938436969288887 Time :  169
accuracy train: 0.983640 val: 0.932727 test: 0.943379
max validation accuracy : 0.943636 max acc epoch : 27 test accuracy : 0.944292

Epoch :  31 loss training:  3.357895203746466 Time :  174
accuracy train: 0.987679 val: 0.929091 test: 0.940639
max validation accuracy : 0.943636 max acc epoch : 27 test accuracy : 0.944292

Epoch :  32 loss training:  1.184613179662847 Time :  179
accuracy train: 0.989901 val: 0.932727 test: 0.942009
max validation accuracy : 0.943636 max acc epoch : 27 test accuracy : 0.944292

Epoch :  33 loss training:  1.2825285663966497 Time :  184
accuracy train: 0.991517 val: 0.936364 test: 0.942922
max validation accuracy : 0.943636 max acc epoch : 27 test accuracy : 0.944292

Epoch :  34 loss training:  1.1414746477457811 Time :  189
accuracy train: 0.994345 val: 0.940000 test: 0.945662
max validation accuracy : 0.943636 max acc epoch : 27 test accuracy : 0.944292

Epoch :  35 loss training:  0.5932334231038112 Time :  193
accuracy train: 0.995354 val: 0.938182 test: 0.946575
max validation accuracy : 0.943636 max acc epoch : 27 test accuracy : 0.944292

Epoch :  36 loss training:  1.1133341172781002 Time :  199
accuracy train: 0.994951 val: 0.934545 test: 0.944749
max validation accuracy : 0.943636 max acc epoch : 27 test accuracy : 0.944292

Epoch :  37 loss training:  0.9530951578863096 Time :  204
accuracy train: 0.995758 val: 0.936364 test: 0.942009
max validation accuracy : 0.943636 max acc epoch : 27 test accuracy : 0.944292

Epoch :  38 loss training:  0.6839905388478655 Time :  209
accuracy train: 0.995152 val: 0.934545 test: 0.946575
max validation accuracy : 0.943636 max acc epoch : 27 test accuracy : 0.944292

Epoch :  39 loss training:  0.7261354347101587 Time :  214
accuracy train: 0.994143 val: 0.941818 test: 0.942922
max validation accuracy : 0.943636 max acc epoch : 27 test accuracy : 0.944292

Epoch :  40 loss training:  0.9917222808180668 Time :  219
accuracy train: 0.993537 val: 0.932727 test: 0.942466
max validation accuracy : 0.943636 max acc epoch : 27 test accuracy : 0.944292

Epoch :  41 loss training:  0.6582100018677011 Time :  224
accuracy train: 0.996162 val: 0.940000 test: 0.946119
max validation accuracy : 0.943636 max acc epoch : 27 test accuracy : 0.944292

Epoch :  42 loss training:  0.37570059509016573 Time :  229
accuracy train: 0.995556 val: 0.936364 test: 0.945662
max validation accuracy : 0.943636 max acc epoch : 27 test accuracy : 0.944292

Epoch :  43 loss training:  0.734415684659325 Time :  234
accuracy train: 0.996566 val: 0.940000 test: 0.942466
max validation accuracy : 0.943636 max acc epoch : 27 test accuracy : 0.944292

Epoch :  44 loss training:  0.48933626671077946 Time :  239
accuracy train: 0.995556 val: 0.936364 test: 0.947489
max validation accuracy : 0.943636 max acc epoch : 27 test accuracy : 0.944292

Epoch :  45 loss training:  0.7836876088622375 Time :  244
accuracy train: 0.990911 val: 0.940000 test: 0.945662
max validation accuracy : 0.943636 max acc epoch : 27 test accuracy : 0.944292

Epoch :  46 loss training:  0.7277342460201908 Time :  249
accuracy train: 0.988285 val: 0.936364 test: 0.940183
max validation accuracy : 0.943636 max acc epoch : 27 test accuracy : 0.944292

Epoch :  47 loss training:  0.8185045146692573 Time :  254
accuracy train: 0.989901 val: 0.932727 test: 0.937900
max validation accuracy : 0.943636 max acc epoch : 27 test accuracy : 0.944292

Epoch :  48 loss training:  0.8486634521395899 Time :  259
accuracy train: 0.992123 val: 0.936364 test: 0.940639
max validation accuracy : 0.943636 max acc epoch : 27 test accuracy : 0.944292

========================================================================================================================================================================================================
max acc epoch :  27
max validation accuracy :  0.9436363636363636
test accuracy :  0.9442922374429223
last test_accuracy :  0.9406392694063926
========================================================================================================================================================================================================

