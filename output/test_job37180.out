

date and time :  Fri Jun 11 09:54:12 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=217, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  91.94485521316528 Time :  12
accuracy train: 0.780713 val: 0.749296 test: 0.759989
max validation accuracy : 0.749296 max acc epoch : 1 test accuracy : 0.759989
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.44523963332176 Time :  21
accuracy train: 0.778681 val: 0.757746 test: 0.767304
max validation accuracy : 0.757746 max acc epoch : 2 test accuracy : 0.767304
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.91655623912811 Time :  30
accuracy train: 0.814473 val: 0.761972 test: 0.776590
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776590
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.13648264110088 Time :  39
accuracy train: 0.833229 val: 0.756338 test: 0.772088
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776590
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  73.49978749454021 Time :  46
accuracy train: 0.827602 val: 0.767606 test: 0.780248
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.780248
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.58257700502872 Time :  52
accuracy train: 0.847452 val: 0.760563 test: 0.772088
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.780248
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.83537012338638 Time :  59
accuracy train: 0.857143 val: 0.767606 test: 0.779685
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.780248
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.36960655450821 Time :  65
accuracy train: 0.860425 val: 0.770423 test: 0.778841
max validation accuracy : 0.770423 max acc epoch : 8 test accuracy : 0.778841
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.0825834274292 Time :  71
accuracy train: 0.858706 val: 0.773239 test: 0.768711
max validation accuracy : 0.773239 max acc epoch : 9 test accuracy : 0.768711
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.129694536328316 Time :  77
accuracy train: 0.885589 val: 0.753521 test: 0.779403
max validation accuracy : 0.773239 max acc epoch : 9 test accuracy : 0.768711

Epoch :  11 loss training:  60.6772877573967 Time :  83
accuracy train: 0.887777 val: 0.763380 test: 0.769274
max validation accuracy : 0.773239 max acc epoch : 9 test accuracy : 0.768711

Epoch :  12 loss training:  57.471124067902565 Time :  89
accuracy train: 0.904345 val: 0.770423 test: 0.783624
max validation accuracy : 0.773239 max acc epoch : 9 test accuracy : 0.768711

Epoch :  13 loss training:  54.8823007196188 Time :  96
accuracy train: 0.912473 val: 0.773239 test: 0.779966
max validation accuracy : 0.773239 max acc epoch : 9 test accuracy : 0.768711

Epoch :  14 loss training:  51.58712621033192 Time :  107
accuracy train: 0.929666 val: 0.767606 test: 0.776027
max validation accuracy : 0.773239 max acc epoch : 9 test accuracy : 0.768711

Epoch :  15 loss training:  47.53627921640873 Time :  113
accuracy train: 0.936699 val: 0.776056 test: 0.776590
max validation accuracy : 0.776056 max acc epoch : 15 test accuracy : 0.776590

Epoch :  16 loss training:  44.62119736522436 Time :  119
accuracy train: 0.943889 val: 0.777465 test: 0.770681
max validation accuracy : 0.777465 max acc epoch : 16 test accuracy : 0.770681

Epoch :  17 loss training:  41.935020945966244 Time :  125
accuracy train: 0.952641 val: 0.778873 test: 0.771525
max validation accuracy : 0.778873 max acc epoch : 17 test accuracy : 0.771525

Epoch :  18 loss training:  38.53721130639315 Time :  131
accuracy train: 0.959831 val: 0.770423 test: 0.775464
max validation accuracy : 0.778873 max acc epoch : 17 test accuracy : 0.771525

Epoch :  19 loss training:  35.862938933074474 Time :  137
accuracy train: 0.969991 val: 0.771831 test: 0.774902
max validation accuracy : 0.778873 max acc epoch : 17 test accuracy : 0.771525

Epoch :  20 loss training:  32.56079747527838 Time :  143
accuracy train: 0.970460 val: 0.776056 test: 0.771806
max validation accuracy : 0.778873 max acc epoch : 17 test accuracy : 0.771525

Epoch :  21 loss training:  31.67553725093603 Time :  149
accuracy train: 0.976868 val: 0.780282 test: 0.779966
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  22 loss training:  29.7013628333807 Time :  155
accuracy train: 0.982807 val: 0.776056 test: 0.768430
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  23 loss training:  27.856182895600796 Time :  161
accuracy train: 0.986715 val: 0.771831 test: 0.774057
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  24 loss training:  24.921058375388384 Time :  168
accuracy train: 0.988590 val: 0.766197 test: 0.768149
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  25 loss training:  23.728473015129566 Time :  174
accuracy train: 0.992185 val: 0.770423 test: 0.771244
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  26 loss training:  22.20025765709579 Time :  180
accuracy train: 0.993279 val: 0.778873 test: 0.768149
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  27 loss training:  19.221857076510787 Time :  186
accuracy train: 0.995624 val: 0.774648 test: 0.767586
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  28 loss training:  18.0441383253783 Time :  192
accuracy train: 0.996093 val: 0.767606 test: 0.772369
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  29 loss training:  17.99441801663488 Time :  202
accuracy train: 0.997187 val: 0.763380 test: 0.763647
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  30 loss training:  16.27132871001959 Time :  210
accuracy train: 0.997030 val: 0.777465 test: 0.775183
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  31 loss training:  15.061231820844114 Time :  219
accuracy train: 0.997656 val: 0.773239 test: 0.773776
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  32 loss training:  14.814781915396452 Time :  227
accuracy train: 0.998906 val: 0.773239 test: 0.767586
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  33 loss training:  14.41167092230171 Time :  236
accuracy train: 0.998750 val: 0.777465 test: 0.768993
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  34 loss training:  12.998579523526132 Time :  245
accuracy train: 0.998906 val: 0.776056 test: 0.767023
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  35 loss training:  11.505024478770792 Time :  254
accuracy train: 0.999844 val: 0.769014 test: 0.765335
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  36 loss training:  10.422902932856232 Time :  263
accuracy train: 0.999375 val: 0.769014 test: 0.770118
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  37 loss training:  11.445910785347223 Time :  272
accuracy train: 0.999531 val: 0.777465 test: 0.771806
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  38 loss training:  9.6668611895293 Time :  281
accuracy train: 1.000000 val: 0.763380 test: 0.766460
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  39 loss training:  10.057917885482311 Time :  289
accuracy train: 0.999844 val: 0.777465 test: 0.769555
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  40 loss training:  9.205220642499626 Time :  301
accuracy train: 0.999687 val: 0.767606 test: 0.760270
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  41 loss training:  7.941664240788668 Time :  310
accuracy train: 1.000000 val: 0.761972 test: 0.764772
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  42 loss training:  8.32843140186742 Time :  319
accuracy train: 0.999844 val: 0.771831 test: 0.768149
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  43 loss training:  7.318657396826893 Time :  328
accuracy train: 0.999844 val: 0.757746 test: 0.757456
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  44 loss training:  7.36029240838252 Time :  337
accuracy train: 1.000000 val: 0.752113 test: 0.771244
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  45 loss training:  7.34477477974724 Time :  346
accuracy train: 0.999844 val: 0.766197 test: 0.765335
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  46 loss training:  7.101456443080679 Time :  354
accuracy train: 0.999844 val: 0.761972 test: 0.765898
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  47 loss training:  6.19488193327561 Time :  363
accuracy train: 1.000000 val: 0.750704 test: 0.763365
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  48 loss training:  6.216850072320085 Time :  371
accuracy train: 1.000000 val: 0.767606 test: 0.769555
max validation accuracy : 0.780282 max acc epoch : 21 test accuracy : 0.779966

Epoch :  49 loss training:  5.686986307497136 Time :  380
accuracy train: 1.000000 val: 0.781690 test: 0.767023
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  50 loss training:  5.742905958555639 Time :  389
accuracy train: 1.000000 val: 0.770423 test: 0.765898
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  51 loss training:  5.507519647013396 Time :  398
accuracy train: 1.000000 val: 0.763380 test: 0.764209
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  52 loss training:  4.15790404798463 Time :  404
accuracy train: 1.000000 val: 0.776056 test: 0.761677
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  53 loss training:  5.000325035769492 Time :  410
accuracy train: 1.000000 val: 0.776056 test: 0.759145
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  54 loss training:  4.752398894750513 Time :  416
accuracy train: 1.000000 val: 0.766197 test: 0.761677
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  55 loss training:  4.352315742522478 Time :  422
accuracy train: 1.000000 val: 0.771831 test: 0.766460
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  56 loss training:  4.75178312062053 Time :  428
accuracy train: 1.000000 val: 0.781690 test: 0.763928
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  57 loss training:  3.7016238340875134 Time :  435
accuracy train: 1.000000 val: 0.767606 test: 0.762802
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  58 loss training:  4.605131866235752 Time :  441
accuracy train: 1.000000 val: 0.769014 test: 0.760833
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  59 loss training:  4.15153544023633 Time :  447
accuracy train: 1.000000 val: 0.780282 test: 0.763928
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  60 loss training:  4.635367394133937 Time :  455
accuracy train: 1.000000 val: 0.771831 test: 0.759707
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  61 loss training:  3.714962166384794 Time :  464
accuracy train: 1.000000 val: 0.778873 test: 0.754924
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  62 loss training:  4.299070063745603 Time :  472
accuracy train: 1.000000 val: 0.774648 test: 0.761677
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  63 loss training:  3.861917138681747 Time :  481
accuracy train: 1.000000 val: 0.767606 test: 0.759989
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  64 loss training:  4.115175345505122 Time :  491
accuracy train: 1.000000 val: 0.777465 test: 0.760833
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  65 loss training:  3.227043672115542 Time :  501
accuracy train: 1.000000 val: 0.774648 test: 0.765616
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  66 loss training:  3.9091417360759806 Time :  509
accuracy train: 1.000000 val: 0.770423 test: 0.763084
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  67 loss training:  2.865594778850209 Time :  518
accuracy train: 1.000000 val: 0.766197 test: 0.767586
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  68 loss training:  2.8042808245372726 Time :  527
accuracy train: 1.000000 val: 0.776056 test: 0.764772
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  69 loss training:  3.595811951541691 Time :  535
accuracy train: 1.000000 val: 0.778873 test: 0.764491
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  70 loss training:  2.5373138022987405 Time :  543
accuracy train: 1.000000 val: 0.780282 test: 0.768993
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  71 loss training:  2.8440928264171816 Time :  552
accuracy train: 0.999844 val: 0.774648 test: 0.770681
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  72 loss training:  2.801278901170008 Time :  560
accuracy train: 1.000000 val: 0.766197 test: 0.766179
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  73 loss training:  2.1816428180900402 Time :  569
accuracy train: 1.000000 val: 0.769014 test: 0.766742
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  74 loss training:  2.291046550453757 Time :  577
accuracy train: 1.000000 val: 0.763380 test: 0.764209
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  75 loss training:  2.697996304152184 Time :  588
accuracy train: 1.000000 val: 0.770423 test: 0.769274
max validation accuracy : 0.781690 max acc epoch : 49 test accuracy : 0.767023

Epoch :  76 loss training:  1.8649240674712928 Time :  597
accuracy train: 1.000000 val: 0.784507 test: 0.768430
max validation accuracy : 0.784507 max acc epoch : 76 test accuracy : 0.768430

Epoch :  77 loss training:  2.012605896758032 Time :  606
accuracy train: 1.000000 val: 0.783099 test: 0.764772
max validation accuracy : 0.784507 max acc epoch : 76 test accuracy : 0.768430

Epoch :  78 loss training:  2.441784415379516 Time :  615
accuracy train: 1.000000 val: 0.783099 test: 0.767023
max validation accuracy : 0.784507 max acc epoch : 76 test accuracy : 0.768430

Epoch :  79 loss training:  2.3501132097735535 Time :  623
accuracy train: 1.000000 val: 0.778873 test: 0.769837
max validation accuracy : 0.784507 max acc epoch : 76 test accuracy : 0.768430

Epoch :  80 loss training:  2.652725987980375 Time :  632
accuracy train: 1.000000 val: 0.780282 test: 0.764772
max validation accuracy : 0.784507 max acc epoch : 76 test accuracy : 0.768430

Epoch :  81 loss training:  2.1729730301740346 Time :  641
accuracy train: 1.000000 val: 0.776056 test: 0.767867
max validation accuracy : 0.784507 max acc epoch : 76 test accuracy : 0.768430

Epoch :  82 loss training:  1.6704016028525075 Time :  649
accuracy train: 1.000000 val: 0.784507 test: 0.764772
max validation accuracy : 0.784507 max acc epoch : 76 test accuracy : 0.768430

Epoch :  83 loss training:  2.062962324853288 Time :  658
accuracy train: 0.999844 val: 0.784507 test: 0.764772
max validation accuracy : 0.784507 max acc epoch : 76 test accuracy : 0.768430

Epoch :  84 loss training:  1.7367372804510524 Time :  667
accuracy train: 1.000000 val: 0.774648 test: 0.763365
max validation accuracy : 0.784507 max acc epoch : 76 test accuracy : 0.768430

Epoch :  85 loss training:  2.6530105389101664 Time :  676
accuracy train: 1.000000 val: 0.777465 test: 0.767586
max validation accuracy : 0.784507 max acc epoch : 76 test accuracy : 0.768430

Epoch :  86 loss training:  1.9553559292689897 Time :  688
accuracy train: 1.000000 val: 0.764789 test: 0.758582
max validation accuracy : 0.784507 max acc epoch : 76 test accuracy : 0.768430

Epoch :  87 loss training:  2.525400297512533 Time :  697
accuracy train: 1.000000 val: 0.770423 test: 0.762802
max validation accuracy : 0.784507 max acc epoch : 76 test accuracy : 0.768430

Epoch :  88 loss training:  1.7517480732421973 Time :  705
accuracy train: 1.000000 val: 0.778873 test: 0.763647
max validation accuracy : 0.784507 max acc epoch : 76 test accuracy : 0.768430

Epoch :  89 loss training:  1.5052168342954246 Time :  714
accuracy train: 1.000000 val: 0.776056 test: 0.762521
max validation accuracy : 0.784507 max acc epoch : 76 test accuracy : 0.768430

Epoch :  90 loss training:  1.1914728900592308 Time :  722
accuracy train: 1.000000 val: 0.773239 test: 0.766742
max validation accuracy : 0.784507 max acc epoch : 76 test accuracy : 0.768430

Epoch :  91 loss training:  1.5239745721046347 Time :  729
accuracy train: 1.000000 val: 0.778873 test: 0.762240
max validation accuracy : 0.784507 max acc epoch : 76 test accuracy : 0.768430

Epoch :  92 loss training:  1.4440297088949592 Time :  735
accuracy train: 1.000000 val: 0.761972 test: 0.757456
max validation accuracy : 0.784507 max acc epoch : 76 test accuracy : 0.768430

Epoch :  93 loss training:  1.5998915621748893 Time :  742
accuracy train: 1.000000 val: 0.770423 test: 0.766460
max validation accuracy : 0.784507 max acc epoch : 76 test accuracy : 0.768430

Epoch :  94 loss training:  1.0934694012030377 Time :  748
accuracy train: 1.000000 val: 0.760563 test: 0.763084
max validation accuracy : 0.784507 max acc epoch : 76 test accuracy : 0.768430

Epoch :  95 loss training:  1.6520837843017944 Time :  754
accuracy train: 1.000000 val: 0.771831 test: 0.765335
max validation accuracy : 0.784507 max acc epoch : 76 test accuracy : 0.768430

Epoch :  96 loss training:  1.2324835584950051 Time :  760
accuracy train: 1.000000 val: 0.776056 test: 0.760551
max validation accuracy : 0.784507 max acc epoch : 76 test accuracy : 0.768430

Epoch :  97 loss training:  1.0843563840680872 Time :  767
accuracy train: 1.000000 val: 0.777465 test: 0.757456
max validation accuracy : 0.784507 max acc epoch : 76 test accuracy : 0.768430

Epoch :  98 loss training:  1.4779132876537915 Time :  773
accuracy train: 1.000000 val: 0.773239 test: 0.764772
max validation accuracy : 0.784507 max acc epoch : 76 test accuracy : 0.768430

Epoch :  99 loss training:  1.8241206013262854 Time :  784
accuracy train: 1.000000 val: 0.776056 test: 0.762521
max validation accuracy : 0.784507 max acc epoch : 76 test accuracy : 0.768430

Epoch :  100 loss training:  0.8193923655744584 Time :  793
accuracy train: 1.000000 val: 0.776056 test: 0.767023
max validation accuracy : 0.784507 max acc epoch : 76 test accuracy : 0.768430

Epoch :  101 loss training:  1.3531318908426329 Time :  802
accuracy train: 1.000000 val: 0.785915 test: 0.763084
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  102 loss training:  1.1658209110319149 Time :  811
accuracy train: 1.000000 val: 0.781690 test: 0.754080
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  103 loss training:  1.0840889304381562 Time :  820
accuracy train: 1.000000 val: 0.781690 test: 0.758582
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  104 loss training:  1.295706082462857 Time :  828
accuracy train: 1.000000 val: 0.781690 test: 0.759707
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  105 loss training:  1.4973791163938586 Time :  837
accuracy train: 1.000000 val: 0.767606 test: 0.752673
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  106 loss training:  0.9898065040233632 Time :  846
accuracy train: 1.000000 val: 0.774648 test: 0.756331
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  107 loss training:  1.7750776374014094 Time :  854
accuracy train: 1.000000 val: 0.780282 test: 0.751548
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  108 loss training:  1.5159088555155904 Time :  863
accuracy train: 1.000000 val: 0.778873 test: 0.757175
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  109 loss training:  0.8706892069367314 Time :  872
accuracy train: 1.000000 val: 0.785915 test: 0.760270
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  110 loss training:  1.0511915893657715 Time :  880
accuracy train: 1.000000 val: 0.778873 test: 0.751548
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  111 loss training:  0.6711519842556299 Time :  893
accuracy train: 1.000000 val: 0.766197 test: 0.752673
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  112 loss training:  1.6203824084459484 Time :  901
accuracy train: 1.000000 val: 0.783099 test: 0.761114
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  113 loss training:  1.0235746779217152 Time :  910
accuracy train: 1.000000 val: 0.785915 test: 0.759426
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  114 loss training:  1.0983876311256608 Time :  918
accuracy train: 1.000000 val: 0.777465 test: 0.761958
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  115 loss training:  1.0055155338231998 Time :  927
accuracy train: 1.000000 val: 0.783099 test: 0.763365
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  116 loss training:  0.7277460185105156 Time :  936
accuracy train: 1.000000 val: 0.778873 test: 0.767304
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  117 loss training:  1.7616183703612478 Time :  945
accuracy train: 1.000000 val: 0.776056 test: 0.758301
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  118 loss training:  0.876560135762702 Time :  953
accuracy train: 1.000000 val: 0.776056 test: 0.764209
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  119 loss training:  1.238536459632087 Time :  962
accuracy train: 1.000000 val: 0.774648 test: 0.763084
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  120 loss training:  0.8879368360649096 Time :  970
accuracy train: 1.000000 val: 0.783099 test: 0.755768
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  121 loss training:  0.6042604312879121 Time :  979
accuracy train: 1.000000 val: 0.785915 test: 0.763365
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  122 loss training:  1.2844023072830169 Time :  987
accuracy train: 1.000000 val: 0.784507 test: 0.761677
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  123 loss training:  1.2562146148156899 Time :  998
accuracy train: 1.000000 val: 0.784507 test: 0.763647
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  124 loss training:  0.533826383606538 Time :  1007
accuracy train: 1.000000 val: 0.784507 test: 0.765898
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  125 loss training:  1.07323076780267 Time :  1015
accuracy train: 1.000000 val: 0.777465 test: 0.763928
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  126 loss training:  1.1278239996554476 Time :  1024
accuracy train: 1.000000 val: 0.783099 test: 0.762521
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  127 loss training:  0.9486477132340951 Time :  1032
accuracy train: 1.000000 val: 0.783099 test: 0.762240
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  128 loss training:  0.9345666391577652 Time :  1041
accuracy train: 1.000000 val: 0.774648 test: 0.767304
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  129 loss training:  0.7721001231411719 Time :  1049
accuracy train: 1.000000 val: 0.774648 test: 0.760833
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  130 loss training:  0.7724653983968892 Time :  1058
accuracy train: 1.000000 val: 0.773239 test: 0.758582
max validation accuracy : 0.785915 max acc epoch : 101 test accuracy : 0.763084

Epoch :  131 loss training:  1.0513120645773597 Time :  1064
accuracy train: 1.000000 val: 0.787324 test: 0.763084
max validation accuracy : 0.787324 max acc epoch : 131 test accuracy : 0.763084

Epoch :  132 loss training:  0.8683860492255917 Time :  1070
accuracy train: 1.000000 val: 0.788732 test: 0.760833
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  133 loss training:  0.6560116495547845 Time :  1076
accuracy train: 1.000000 val: 0.781690 test: 0.759989
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  134 loss training:  0.7355470237653208 Time :  1082
accuracy train: 1.000000 val: 0.770423 test: 0.758301
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  135 loss training:  0.5060687022714774 Time :  1089
accuracy train: 1.000000 val: 0.773239 test: 0.761396
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  136 loss training:  1.279514470252252 Time :  1098
accuracy train: 1.000000 val: 0.764789 test: 0.761958
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  137 loss training:  1.1728873282172572 Time :  1108
accuracy train: 1.000000 val: 0.767606 test: 0.758019
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  138 loss training:  0.9074455221907556 Time :  1116
accuracy train: 1.000000 val: 0.766197 test: 0.763647
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  139 loss training:  0.9671670629968503 Time :  1125
accuracy train: 1.000000 val: 0.767606 test: 0.758019
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  140 loss training:  0.3899453067779177 Time :  1134
accuracy train: 1.000000 val: 0.776056 test: 0.761677
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  141 loss training:  0.9924698536237884 Time :  1142
accuracy train: 1.000000 val: 0.767606 test: 0.762240
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  142 loss training:  0.7134891932469145 Time :  1151
accuracy train: 1.000000 val: 0.767606 test: 0.764772
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  143 loss training:  0.7176050800662779 Time :  1160
accuracy train: 1.000000 val: 0.770423 test: 0.762802
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  144 loss training:  0.7975199702823375 Time :  1169
accuracy train: 1.000000 val: 0.770423 test: 0.766179
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  145 loss training:  0.7967698920565454 Time :  1178
accuracy train: 1.000000 val: 0.770423 test: 0.766742
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  146 loss training:  0.7029737757720795 Time :  1187
accuracy train: 1.000000 val: 0.771831 test: 0.764772
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  147 loss training:  0.6114051423460296 Time :  1197
accuracy train: 1.000000 val: 0.780282 test: 0.763365
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  148 loss training:  0.6338970811539184 Time :  1204
accuracy train: 1.000000 val: 0.767606 test: 0.763647
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  149 loss training:  0.4572196403560156 Time :  1210
accuracy train: 1.000000 val: 0.777465 test: 0.763365
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  150 loss training:  0.6436569715260703 Time :  1216
accuracy train: 1.000000 val: 0.773239 test: 0.758301
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  151 loss training:  0.5887027983108055 Time :  1223
accuracy train: 1.000000 val: 0.777465 test: 0.757175
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  152 loss training:  1.003670992129173 Time :  1229
accuracy train: 1.000000 val: 0.773239 test: 0.767867
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  153 loss training:  0.7725619248094517 Time :  1235
accuracy train: 1.000000 val: 0.776056 test: 0.763928
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  154 loss training:  0.38091907756825094 Time :  1241
accuracy train: 1.000000 val: 0.780282 test: 0.764209
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  155 loss training:  0.30356537494753866 Time :  1248
accuracy train: 1.000000 val: 0.774648 test: 0.766742
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  156 loss training:  0.2521837914191565 Time :  1254
accuracy train: 1.000000 val: 0.771831 test: 0.762521
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  157 loss training:  0.6883159121573499 Time :  1262
accuracy train: 1.000000 val: 0.780282 test: 0.760270
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  158 loss training:  0.5128957766264648 Time :  1271
accuracy train: 1.000000 val: 0.783099 test: 0.764209
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  159 loss training:  0.6061708633951639 Time :  1280
accuracy train: 1.000000 val: 0.764789 test: 0.761114
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  160 loss training:  0.3580801055111351 Time :  1290
accuracy train: 1.000000 val: 0.776056 test: 0.760551
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  161 loss training:  0.38785582411128416 Time :  1301
accuracy train: 1.000000 val: 0.770423 test: 0.760833
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  162 loss training:  0.3615587999474883 Time :  1309
accuracy train: 1.000000 val: 0.776056 test: 0.757738
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

Epoch :  163 loss training:  0.5407163444806429 Time :  1318
accuracy train: 1.000000 val: 0.785915 test: 0.759145
max validation accuracy : 0.788732 max acc epoch : 132 test accuracy : 0.760833

========================================================================================================================================================================================================
max acc epoch :  132
max validation accuracy :  0.7887323943661971
test accuracy :  0.7608328643781654
last test_accuracy :  0.7591446257737761
max gap 30
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=217, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  91.8705515563488 Time :  1328
accuracy train: 0.776024 val: 0.740845 test: 0.760270
max validation accuracy : 0.740845 max acc epoch : 1 test accuracy : 0.760270
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.21386176347733 Time :  1336
accuracy train: 0.773679 val: 0.759155 test: 0.764491
max validation accuracy : 0.759155 max acc epoch : 2 test accuracy : 0.764491
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.90985956788063 Time :  1345
accuracy train: 0.815098 val: 0.760563 test: 0.777153
max validation accuracy : 0.760563 max acc epoch : 3 test accuracy : 0.777153
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.3626860678196 Time :  1353
accuracy train: 0.830728 val: 0.763380 test: 0.771806
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.771806
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  73.73302121460438 Time :  1362
accuracy train: 0.825727 val: 0.761972 test: 0.776027
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.771806
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.49248498678207 Time :  1371
accuracy train: 0.846515 val: 0.743662 test: 0.772651
max validation accuracy : 0.763380 max acc epoch : 4 test accuracy : 0.771806
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.97627069056034 Time :  1380
accuracy train: 0.853079 val: 0.767606 test: 0.776590
max validation accuracy : 0.767606 max acc epoch : 7 test accuracy : 0.776590
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.78245981037617 Time :  1389
accuracy train: 0.857299 val: 0.759155 test: 0.777997
max validation accuracy : 0.767606 max acc epoch : 7 test accuracy : 0.776590
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.32602071762085 Time :  1400
accuracy train: 0.855892 val: 0.757746 test: 0.773776
max validation accuracy : 0.767606 max acc epoch : 7 test accuracy : 0.776590
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.60033421218395 Time :  1408
accuracy train: 0.878399 val: 0.757746 test: 0.770681
max validation accuracy : 0.767606 max acc epoch : 7 test accuracy : 0.776590

Epoch :  11 loss training:  61.10415634512901 Time :  1417
accuracy train: 0.886371 val: 0.753521 test: 0.772651
max validation accuracy : 0.767606 max acc epoch : 7 test accuracy : 0.776590

Epoch :  12 loss training:  57.931677132844925 Time :  1426
accuracy train: 0.898406 val: 0.776056 test: 0.777997
max validation accuracy : 0.776056 max acc epoch : 12 test accuracy : 0.777997

Epoch :  13 loss training:  55.82646486163139 Time :  1435
accuracy train: 0.913410 val: 0.770423 test: 0.778559
max validation accuracy : 0.776056 max acc epoch : 12 test accuracy : 0.777997

Epoch :  14 loss training:  51.91838821768761 Time :  1445
accuracy train: 0.924039 val: 0.761972 test: 0.774902
max validation accuracy : 0.776056 max acc epoch : 12 test accuracy : 0.777997

Epoch :  15 loss training:  48.11314915120602 Time :  1454
accuracy train: 0.935449 val: 0.774648 test: 0.773776
max validation accuracy : 0.776056 max acc epoch : 12 test accuracy : 0.777997

Epoch :  16 loss training:  45.06911385059357 Time :  1463
accuracy train: 0.940294 val: 0.766197 test: 0.770118
max validation accuracy : 0.776056 max acc epoch : 12 test accuracy : 0.777997

Epoch :  17 loss training:  42.526673659682274 Time :  1472
accuracy train: 0.951704 val: 0.774648 test: 0.773495
max validation accuracy : 0.776056 max acc epoch : 12 test accuracy : 0.777997

Epoch :  18 loss training:  39.57194035500288 Time :  1481
accuracy train: 0.959987 val: 0.771831 test: 0.775183
max validation accuracy : 0.776056 max acc epoch : 12 test accuracy : 0.777997

Epoch :  19 loss training:  36.97522586584091 Time :  1489
accuracy train: 0.968271 val: 0.783099 test: 0.770962
max validation accuracy : 0.783099 max acc epoch : 19 test accuracy : 0.770962

Epoch :  20 loss training:  33.29176672548056 Time :  1501
accuracy train: 0.968584 val: 0.788732 test: 0.776871
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  21 loss training:  31.32825117558241 Time :  1510
accuracy train: 0.974211 val: 0.771831 test: 0.777715
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  22 loss training:  30.499596118927002 Time :  1519
accuracy train: 0.982026 val: 0.784507 test: 0.769274
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  23 loss training:  27.62346375361085 Time :  1528
accuracy train: 0.984214 val: 0.769014 test: 0.773495
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  24 loss training:  25.263376601040363 Time :  1537
accuracy train: 0.989528 val: 0.776056 test: 0.770962
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  25 loss training:  24.18028306029737 Time :  1546
accuracy train: 0.989528 val: 0.784507 test: 0.771525
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  26 loss training:  22.81528410874307 Time :  1555
accuracy train: 0.991560 val: 0.769014 test: 0.765616
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  27 loss training:  19.612892247736454 Time :  1565
accuracy train: 0.994373 val: 0.769014 test: 0.772088
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  28 loss training:  17.410379249602556 Time :  1574
accuracy train: 0.994061 val: 0.780282 test: 0.773213
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  29 loss training:  18.6624653339386 Time :  1583
accuracy train: 0.996093 val: 0.788732 test: 0.763647
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  30 loss training:  16.915233328938484 Time :  1593
accuracy train: 0.996093 val: 0.776056 test: 0.773776
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  31 loss training:  14.684945699758828 Time :  1604
accuracy train: 0.996718 val: 0.781690 test: 0.770118
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  32 loss training:  14.315605151467025 Time :  1614
accuracy train: 0.997968 val: 0.785915 test: 0.766460
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  33 loss training:  14.239188462495804 Time :  1623
accuracy train: 0.998593 val: 0.774648 test: 0.765616
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  34 loss training:  13.078234946355224 Time :  1632
accuracy train: 0.999062 val: 0.785915 test: 0.766742
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  35 loss training:  11.383750673383474 Time :  1640
accuracy train: 0.999062 val: 0.785915 test: 0.770118
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  36 loss training:  10.561369141563773 Time :  1649
accuracy train: 0.999062 val: 0.771831 test: 0.769274
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  37 loss training:  11.313454080373049 Time :  1659
accuracy train: 0.999844 val: 0.778873 test: 0.771525
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  38 loss training:  9.649568103253841 Time :  1668
accuracy train: 1.000000 val: 0.770423 test: 0.771244
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  39 loss training:  10.70212942874059 Time :  1677
accuracy train: 0.999687 val: 0.784507 test: 0.773213
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  40 loss training:  9.29648551158607 Time :  1686
accuracy train: 0.999531 val: 0.780282 test: 0.768149
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  41 loss training:  7.723806330468506 Time :  1696
accuracy train: 1.000000 val: 0.781690 test: 0.770118
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  42 loss training:  8.18154087336734 Time :  1705
accuracy train: 1.000000 val: 0.781690 test: 0.768993
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  43 loss training:  7.185799252009019 Time :  1714
accuracy train: 0.999844 val: 0.778873 test: 0.766742
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  44 loss training:  7.793021475197747 Time :  1723
accuracy train: 1.000000 val: 0.787324 test: 0.770681
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  45 loss training:  7.014701670501381 Time :  1732
accuracy train: 1.000000 val: 0.773239 test: 0.765898
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  46 loss training:  7.929588980274275 Time :  1741
accuracy train: 1.000000 val: 0.774648 test: 0.768430
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  47 loss training:  6.180565292248502 Time :  1750
accuracy train: 1.000000 val: 0.780282 test: 0.764491
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  48 loss training:  6.247048503370024 Time :  1758
accuracy train: 1.000000 val: 0.788732 test: 0.770681
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  49 loss training:  6.034938192809932 Time :  1767
accuracy train: 1.000000 val: 0.783099 test: 0.771244
max validation accuracy : 0.788732 max acc epoch : 20 test accuracy : 0.776871

Epoch :  50 loss training:  5.988250181660987 Time :  1776
accuracy train: 1.000000 val: 0.790141 test: 0.774057
max validation accuracy : 0.790141 max acc epoch : 50 test accuracy : 0.774057

Epoch :  51 loss training:  5.068657279014587 Time :  1784
accuracy train: 1.000000 val: 0.777465 test: 0.770400
max validation accuracy : 0.790141 max acc epoch : 50 test accuracy : 0.774057

Epoch :  52 loss training:  4.909232489415444 Time :  1796
accuracy train: 1.000000 val: 0.788732 test: 0.766460
max validation accuracy : 0.790141 max acc epoch : 50 test accuracy : 0.774057

Epoch :  53 loss training:  4.5779797534924 Time :  1806
accuracy train: 1.000000 val: 0.791549 test: 0.762240
max validation accuracy : 0.791549 max acc epoch : 53 test accuracy : 0.762240

Epoch :  54 loss training:  5.4326819173875265 Time :  1815
accuracy train: 1.000000 val: 0.785915 test: 0.768430
max validation accuracy : 0.791549 max acc epoch : 53 test accuracy : 0.762240

Epoch :  55 loss training:  3.8765629515983164 Time :  1824
accuracy train: 1.000000 val: 0.792958 test: 0.768711
max validation accuracy : 0.792958 max acc epoch : 55 test accuracy : 0.768711

Epoch :  56 loss training:  4.182449089712463 Time :  1833
accuracy train: 1.000000 val: 0.792958 test: 0.769274
max validation accuracy : 0.792958 max acc epoch : 55 test accuracy : 0.768711

Epoch :  57 loss training:  3.737337422790006 Time :  1842
accuracy train: 1.000000 val: 0.790141 test: 0.767023
max validation accuracy : 0.792958 max acc epoch : 55 test accuracy : 0.768711

Epoch :  58 loss training:  4.409887132002041 Time :  1852
accuracy train: 1.000000 val: 0.780282 test: 0.759989
max validation accuracy : 0.792958 max acc epoch : 55 test accuracy : 0.768711

Epoch :  59 loss training:  3.724955061072251 Time :  1861
accuracy train: 1.000000 val: 0.788732 test: 0.762802
max validation accuracy : 0.792958 max acc epoch : 55 test accuracy : 0.768711

Epoch :  60 loss training:  4.88052135577891 Time :  1870
accuracy train: 1.000000 val: 0.785915 test: 0.760551
max validation accuracy : 0.792958 max acc epoch : 55 test accuracy : 0.768711

Epoch :  61 loss training:  4.000618215766735 Time :  1880
accuracy train: 1.000000 val: 0.790141 test: 0.760551
max validation accuracy : 0.792958 max acc epoch : 55 test accuracy : 0.768711

Epoch :  62 loss training:  4.034546134760603 Time :  1889
accuracy train: 1.000000 val: 0.797183 test: 0.765616
max validation accuracy : 0.797183 max acc epoch : 62 test accuracy : 0.765616

Epoch :  63 loss training:  3.848346511309501 Time :  1901
accuracy train: 1.000000 val: 0.792958 test: 0.760270
max validation accuracy : 0.797183 max acc epoch : 62 test accuracy : 0.765616

Epoch :  64 loss training:  3.4766097059182357 Time :  1910
accuracy train: 1.000000 val: 0.787324 test: 0.760270
max validation accuracy : 0.797183 max acc epoch : 62 test accuracy : 0.765616

Epoch :  65 loss training:  2.961980274965754 Time :  1919
accuracy train: 1.000000 val: 0.794366 test: 0.769555
max validation accuracy : 0.797183 max acc epoch : 62 test accuracy : 0.765616

Epoch :  66 loss training:  2.6889391584554687 Time :  1928
accuracy train: 1.000000 val: 0.794366 test: 0.767304
max validation accuracy : 0.797183 max acc epoch : 62 test accuracy : 0.765616

Epoch :  67 loss training:  3.0528395791188814 Time :  1937
accuracy train: 1.000000 val: 0.790141 test: 0.764491
max validation accuracy : 0.797183 max acc epoch : 62 test accuracy : 0.765616

Epoch :  68 loss training:  2.8442110024625435 Time :  1945
accuracy train: 1.000000 val: 0.785915 test: 0.770681
max validation accuracy : 0.797183 max acc epoch : 62 test accuracy : 0.765616

Epoch :  69 loss training:  3.648794620676199 Time :  1954
accuracy train: 1.000000 val: 0.790141 test: 0.764491
max validation accuracy : 0.797183 max acc epoch : 62 test accuracy : 0.765616

Epoch :  70 loss training:  2.60095359897241 Time :  1963
accuracy train: 1.000000 val: 0.794366 test: 0.764491
max validation accuracy : 0.797183 max acc epoch : 62 test accuracy : 0.765616

Epoch :  71 loss training:  2.3113697748922277 Time :  1972
accuracy train: 1.000000 val: 0.792958 test: 0.771244
max validation accuracy : 0.797183 max acc epoch : 62 test accuracy : 0.765616

Epoch :  72 loss training:  2.0323347085504793 Time :  1980
accuracy train: 1.000000 val: 0.780282 test: 0.765053
max validation accuracy : 0.797183 max acc epoch : 62 test accuracy : 0.765616

Epoch :  73 loss training:  2.4384763499401743 Time :  1990
accuracy train: 1.000000 val: 0.784507 test: 0.768149
max validation accuracy : 0.797183 max acc epoch : 62 test accuracy : 0.765616

Epoch :  74 loss training:  2.152469353779452 Time :  2001
accuracy train: 1.000000 val: 0.790141 test: 0.764491
max validation accuracy : 0.797183 max acc epoch : 62 test accuracy : 0.765616

Epoch :  75 loss training:  2.360888190654805 Time :  2010
accuracy train: 1.000000 val: 0.794366 test: 0.772088
max validation accuracy : 0.797183 max acc epoch : 62 test accuracy : 0.765616

Epoch :  76 loss training:  2.4396416492090793 Time :  2019
accuracy train: 1.000000 val: 0.795775 test: 0.765898
max validation accuracy : 0.797183 max acc epoch : 62 test accuracy : 0.765616

Epoch :  77 loss training:  1.7462663793266984 Time :  2028
accuracy train: 1.000000 val: 0.792958 test: 0.765898
max validation accuracy : 0.797183 max acc epoch : 62 test accuracy : 0.765616

Epoch :  78 loss training:  1.7572289915697183 Time :  2037
accuracy train: 1.000000 val: 0.798592 test: 0.765898
max validation accuracy : 0.798592 max acc epoch : 78 test accuracy : 0.765898

Epoch :  79 loss training:  2.1657493068487383 Time :  2045
accuracy train: 0.999844 val: 0.788732 test: 0.770118
max validation accuracy : 0.798592 max acc epoch : 78 test accuracy : 0.765898

Epoch :  80 loss training:  3.1801540202723118 Time :  2054
accuracy train: 1.000000 val: 0.787324 test: 0.763365
max validation accuracy : 0.798592 max acc epoch : 78 test accuracy : 0.765898

Epoch :  81 loss training:  2.012674731289735 Time :  2063
accuracy train: 1.000000 val: 0.795775 test: 0.764772
max validation accuracy : 0.798592 max acc epoch : 78 test accuracy : 0.765898

Epoch :  82 loss training:  1.68394053519296 Time :  2071
accuracy train: 1.000000 val: 0.801408 test: 0.763928
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  83 loss training:  2.0580343812980573 Time :  2080
accuracy train: 1.000000 val: 0.788732 test: 0.760551
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  84 loss training:  1.9143004805737291 Time :  2090
accuracy train: 1.000000 val: 0.784507 test: 0.766742
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  85 loss training:  1.8676818499807268 Time :  2102
accuracy train: 1.000000 val: 0.792958 test: 0.766460
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  86 loss training:  1.8359621036797762 Time :  2112
accuracy train: 1.000000 val: 0.785915 test: 0.760833
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  87 loss training:  2.038295778518659 Time :  2121
accuracy train: 1.000000 val: 0.783099 test: 0.762802
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  88 loss training:  1.9745419874525396 Time :  2130
accuracy train: 1.000000 val: 0.790141 test: 0.760833
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  89 loss training:  1.6477756116655655 Time :  2139
accuracy train: 1.000000 val: 0.787324 test: 0.761677
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  90 loss training:  1.2167782233300386 Time :  2148
accuracy train: 1.000000 val: 0.790141 test: 0.765898
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  91 loss training:  1.3954937403905205 Time :  2157
accuracy train: 1.000000 val: 0.792958 test: 0.766460
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  92 loss training:  1.2628505205539113 Time :  2166
accuracy train: 1.000000 val: 0.784507 test: 0.759707
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  93 loss training:  1.555697967953165 Time :  2175
accuracy train: 1.000000 val: 0.776056 test: 0.761958
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  94 loss training:  0.9817292511579581 Time :  2184
accuracy train: 1.000000 val: 0.781690 test: 0.760270
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  95 loss training:  1.2656001696559542 Time :  2196
accuracy train: 1.000000 val: 0.784507 test: 0.766460
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  96 loss training:  1.5000991198194242 Time :  2204
accuracy train: 1.000000 val: 0.780282 test: 0.757738
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  97 loss training:  1.6889555609232048 Time :  2214
accuracy train: 1.000000 val: 0.791549 test: 0.767304
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  98 loss training:  1.4667156836148934 Time :  2223
accuracy train: 1.000000 val: 0.783099 test: 0.765335
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  99 loss training:  1.4512188749140478 Time :  2232
accuracy train: 1.000000 val: 0.778873 test: 0.758863
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  100 loss training:  0.787335331826398 Time :  2240
accuracy train: 1.000000 val: 0.790141 test: 0.768149
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  101 loss training:  1.1459258621525805 Time :  2249
accuracy train: 1.000000 val: 0.790141 test: 0.759989
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  102 loss training:  0.7802096396044362 Time :  2258
accuracy train: 1.000000 val: 0.792958 test: 0.760270
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  103 loss training:  1.2516105273862195 Time :  2266
accuracy train: 1.000000 val: 0.785915 test: 0.759426
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  104 loss training:  1.6830162135847786 Time :  2275
accuracy train: 1.000000 val: 0.781690 test: 0.759145
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  105 loss training:  1.3294029509888787 Time :  2284
accuracy train: 1.000000 val: 0.788732 test: 0.756612
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  106 loss training:  1.5921132572075294 Time :  2295
accuracy train: 1.000000 val: 0.790141 test: 0.758301
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  107 loss training:  1.8787626296179951 Time :  2304
accuracy train: 1.000000 val: 0.784507 test: 0.763647
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  108 loss training:  1.34863805052737 Time :  2313
accuracy train: 1.000000 val: 0.783099 test: 0.763084
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  109 loss training:  0.8202739471598761 Time :  2323
accuracy train: 1.000000 val: 0.795775 test: 0.767304
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  110 loss training:  0.7825817951052159 Time :  2332
accuracy train: 1.000000 val: 0.781690 test: 0.758863
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  111 loss training:  0.7989380240178434 Time :  2341
accuracy train: 1.000000 val: 0.792958 test: 0.757175
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  112 loss training:  1.4673702705931646 Time :  2351
accuracy train: 1.000000 val: 0.788732 test: 0.760833
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

Epoch :  113 loss training:  0.7574161417651339 Time :  2361
accuracy train: 1.000000 val: 0.785915 test: 0.763084
max validation accuracy : 0.801408 max acc epoch : 82 test accuracy : 0.763928

========================================================================================================================================================================================================
max acc epoch :  82
max validation accuracy :  0.8014084507042254
test accuracy :  0.7639279684862127
last test_accuracy :  0.7630838491840181
max gap 30
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=217, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  91.88641074299812 Time :  2370
accuracy train: 0.780244 val: 0.736620 test: 0.761114
max validation accuracy : 0.736620 max acc epoch : 1 test accuracy : 0.761114
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.25433018803596 Time :  2379
accuracy train: 0.778525 val: 0.761972 test: 0.767304
max validation accuracy : 0.761972 max acc epoch : 2 test accuracy : 0.767304
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.88289391994476 Time :  2389
accuracy train: 0.814161 val: 0.750704 test: 0.778278
max validation accuracy : 0.761972 max acc epoch : 2 test accuracy : 0.767304
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.33289256691933 Time :  2399
accuracy train: 0.833073 val: 0.756338 test: 0.772651
max validation accuracy : 0.761972 max acc epoch : 2 test accuracy : 0.767304
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  73.68509058654308 Time :  2408
accuracy train: 0.831979 val: 0.766197 test: 0.779966
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779966
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.74055001139641 Time :  2418
accuracy train: 0.847609 val: 0.766197 test: 0.773495
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779966
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.72174915671349 Time :  2426
accuracy train: 0.854329 val: 0.766197 test: 0.781936
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.779966
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.38357834517956 Time :  2436
accuracy train: 0.863395 val: 0.774648 test: 0.779966
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.779966
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.14860973507166 Time :  2445
accuracy train: 0.857299 val: 0.761972 test: 0.767867
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.779966
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.30534729361534 Time :  2455
accuracy train: 0.886058 val: 0.761972 test: 0.777715
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.779966

Epoch :  11 loss training:  60.686506763100624 Time :  2464
accuracy train: 0.890747 val: 0.764789 test: 0.771806
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.779966

Epoch :  12 loss training:  57.914473190903664 Time :  2472
accuracy train: 0.905283 val: 0.769014 test: 0.782499
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.779966

Epoch :  13 loss training:  55.59928645193577 Time :  2482
accuracy train: 0.916068 val: 0.771831 test: 0.777715
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.779966

Epoch :  14 loss training:  51.524200104177 Time :  2491
accuracy train: 0.927008 val: 0.766197 test: 0.781936
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.779966

Epoch :  15 loss training:  47.296963810920715 Time :  2501
accuracy train: 0.940450 val: 0.761972 test: 0.780529
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.779966

Epoch :  16 loss training:  44.72633323073387 Time :  2510
accuracy train: 0.945452 val: 0.756338 test: 0.779122
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.779966

Epoch :  17 loss training:  42.82373418658972 Time :  2520
accuracy train: 0.955611 val: 0.770423 test: 0.781654
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.779966

Epoch :  18 loss training:  39.49150890111923 Time :  2529
accuracy train: 0.958425 val: 0.759155 test: 0.775464
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.779966

Epoch :  19 loss training:  36.781974993646145 Time :  2538
accuracy train: 0.968428 val: 0.759155 test: 0.780529
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.779966

Epoch :  20 loss training:  32.958982698619366 Time :  2547
accuracy train: 0.972023 val: 0.773239 test: 0.776871
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.779966

Epoch :  21 loss training:  31.916353087872267 Time :  2557
accuracy train: 0.976868 val: 0.767606 test: 0.777153
max validation accuracy : 0.774648 max acc epoch : 8 test accuracy : 0.779966

Epoch :  22 loss training:  30.107125479727983 Time :  2566
accuracy train: 0.984995 val: 0.777465 test: 0.776590
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  23 loss training:  27.556543607264757 Time :  2575
accuracy train: 0.987340 val: 0.769014 test: 0.772651
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  24 loss training:  26.111239328980446 Time :  2584
accuracy train: 0.987496 val: 0.767606 test: 0.777997
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  25 loss training:  23.917676467448473 Time :  2595
accuracy train: 0.991872 val: 0.769014 test: 0.772088
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  26 loss training:  23.207069098949432 Time :  2603
accuracy train: 0.993279 val: 0.757746 test: 0.768149
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  27 loss training:  19.625593760982156 Time :  2612
accuracy train: 0.995155 val: 0.763380 test: 0.767867
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  28 loss training:  18.381748527288437 Time :  2621
accuracy train: 0.996249 val: 0.763380 test: 0.774339
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  29 loss training:  18.523903530091047 Time :  2630
accuracy train: 0.996874 val: 0.761972 test: 0.774057
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  30 loss training:  16.990276500582695 Time :  2638
accuracy train: 0.997030 val: 0.761972 test: 0.770400
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  31 loss training:  14.80226605385542 Time :  2647
accuracy train: 0.998281 val: 0.773239 test: 0.767586
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  32 loss training:  14.349481677636504 Time :  2656
accuracy train: 0.997968 val: 0.770423 test: 0.776590
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  33 loss training:  14.245160286314785 Time :  2664
accuracy train: 0.999531 val: 0.771831 test: 0.775183
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  34 loss training:  12.423656682483852 Time :  2672
accuracy train: 0.999219 val: 0.771831 test: 0.775464
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  35 loss training:  11.7139639435336 Time :  2680
accuracy train: 0.999531 val: 0.759155 test: 0.768430
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  36 loss training:  9.998121882788837 Time :  2689
accuracy train: 0.999062 val: 0.763380 test: 0.770400
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  37 loss training:  11.404932896140963 Time :  2701
accuracy train: 0.999375 val: 0.770423 test: 0.775746
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  38 loss training:  10.518903340213 Time :  2715
accuracy train: 0.999844 val: 0.777465 test: 0.768430
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  39 loss training:  10.657338413409889 Time :  2724
accuracy train: 0.999687 val: 0.761972 test: 0.772369
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  40 loss training:  9.317295209504664 Time :  2731
accuracy train: 0.999844 val: 0.764789 test: 0.760551
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  41 loss training:  7.95883823314216 Time :  2738
accuracy train: 0.999844 val: 0.766197 test: 0.766179
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  42 loss training:  8.401072851382196 Time :  2747
accuracy train: 1.000000 val: 0.769014 test: 0.767023
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  43 loss training:  7.693745740223676 Time :  2755
accuracy train: 0.999844 val: 0.761972 test: 0.756894
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  44 loss training:  7.927175468299538 Time :  2762
accuracy train: 0.999844 val: 0.776056 test: 0.768430
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  45 loss training:  7.150773456552997 Time :  2771
accuracy train: 0.999844 val: 0.766197 test: 0.766742
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  46 loss training:  7.656343472190201 Time :  2779
accuracy train: 1.000000 val: 0.767606 test: 0.766742
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  47 loss training:  6.849532583029941 Time :  2786
accuracy train: 0.999844 val: 0.771831 test: 0.767304
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  48 loss training:  6.26261254446581 Time :  2795
accuracy train: 1.000000 val: 0.760563 test: 0.761677
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  49 loss training:  6.420457370113581 Time :  2804
accuracy train: 1.000000 val: 0.769014 test: 0.767867
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  50 loss training:  5.691792414523661 Time :  2813
accuracy train: 1.000000 val: 0.770423 test: 0.770400
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  51 loss training:  5.198414253769442 Time :  2822
accuracy train: 1.000000 val: 0.763380 test: 0.763084
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  52 loss training:  4.668682600487955 Time :  2831
accuracy train: 0.999844 val: 0.773239 test: 0.763365
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

Epoch :  53 loss training:  5.277952134900261 Time :  2844
accuracy train: 1.000000 val: 0.766197 test: 0.766460
max validation accuracy : 0.777465 max acc epoch : 22 test accuracy : 0.776590

========================================================================================================================================================================================================
max acc epoch :  22
max validation accuracy :  0.7774647887323943
test accuracy :  0.7765897580191333
last test_accuracy :  0.7664603263927968
max gap 14
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=217, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  91.89149045944214 Time :  2855
accuracy train: 0.778837 val: 0.745070 test: 0.763365
max validation accuracy : 0.745070 max acc epoch : 1 test accuracy : 0.763365
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.50899681448936 Time :  2865
accuracy train: 0.770866 val: 0.747887 test: 0.764209
max validation accuracy : 0.747887 max acc epoch : 2 test accuracy : 0.764209
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.69001257419586 Time :  2877
accuracy train: 0.809315 val: 0.766197 test: 0.776590
max validation accuracy : 0.766197 max acc epoch : 3 test accuracy : 0.776590
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.16482503712177 Time :  2885
accuracy train: 0.827759 val: 0.769014 test: 0.771525
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.771525
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  73.4496053904295 Time :  2892
accuracy train: 0.829478 val: 0.766197 test: 0.777434
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.771525
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.65635594725609 Time :  2899
accuracy train: 0.852923 val: 0.767606 test: 0.774620
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.771525
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.55403186380863 Time :  2907
accuracy train: 0.857143 val: 0.761972 test: 0.777434
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.771525
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.31638416647911 Time :  2915
accuracy train: 0.862457 val: 0.778873 test: 0.775183
max validation accuracy : 0.778873 max acc epoch : 8 test accuracy : 0.775183
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.96860019117594 Time :  2924
accuracy train: 0.855111 val: 0.773239 test: 0.765335
max validation accuracy : 0.778873 max acc epoch : 8 test accuracy : 0.775183
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.210222855210304 Time :  2932
accuracy train: 0.882463 val: 0.759155 test: 0.776027
max validation accuracy : 0.778873 max acc epoch : 8 test accuracy : 0.775183

Epoch :  11 loss training:  60.492844462394714 Time :  2940
accuracy train: 0.889028 val: 0.761972 test: 0.769274
max validation accuracy : 0.778873 max acc epoch : 8 test accuracy : 0.775183

Epoch :  12 loss training:  57.86556154489517 Time :  2948
accuracy train: 0.906064 val: 0.776056 test: 0.779122
max validation accuracy : 0.778873 max acc epoch : 8 test accuracy : 0.775183

Epoch :  13 loss training:  54.67452946305275 Time :  2956
accuracy train: 0.915286 val: 0.780282 test: 0.778278
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.778278

Epoch :  14 loss training:  51.25997023284435 Time :  2965
accuracy train: 0.926383 val: 0.773239 test: 0.776871
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.778278

Epoch :  15 loss training:  46.70181904733181 Time :  2973
accuracy train: 0.937949 val: 0.781690 test: 0.776308
max validation accuracy : 0.781690 max acc epoch : 15 test accuracy : 0.776308

Epoch :  16 loss training:  43.96290609240532 Time :  2979
accuracy train: 0.943264 val: 0.783099 test: 0.780810
max validation accuracy : 0.783099 max acc epoch : 16 test accuracy : 0.780810

Epoch :  17 loss training:  41.42859407514334 Time :  2989
accuracy train: 0.954986 val: 0.780282 test: 0.775464
max validation accuracy : 0.783099 max acc epoch : 16 test accuracy : 0.780810

Epoch :  18 loss training:  38.341976188123226 Time :  2998
accuracy train: 0.961863 val: 0.773239 test: 0.775464
max validation accuracy : 0.783099 max acc epoch : 16 test accuracy : 0.780810

Epoch :  19 loss training:  36.34486135095358 Time :  3006
accuracy train: 0.970303 val: 0.766197 test: 0.775464
max validation accuracy : 0.783099 max acc epoch : 16 test accuracy : 0.780810

Epoch :  20 loss training:  33.12302669882774 Time :  3013
accuracy train: 0.970928 val: 0.787324 test: 0.779966
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  21 loss training:  30.685420036315918 Time :  3020
accuracy train: 0.976399 val: 0.785915 test: 0.778278
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  22 loss training:  29.586584128439426 Time :  3026
accuracy train: 0.984839 val: 0.776056 test: 0.773213
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  23 loss training:  27.60188750550151 Time :  3032
accuracy train: 0.986715 val: 0.770423 test: 0.771525
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  24 loss training:  25.26832400634885 Time :  3038
accuracy train: 0.989997 val: 0.770423 test: 0.778278
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  25 loss training:  23.723575675860047 Time :  3045
accuracy train: 0.992810 val: 0.771831 test: 0.772932
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  26 loss training:  21.409289615228772 Time :  3051
accuracy train: 0.993435 val: 0.769014 test: 0.770118
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  27 loss training:  19.219882315024734 Time :  3057
accuracy train: 0.995467 val: 0.763380 test: 0.771806
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  28 loss training:  18.01584412716329 Time :  3063
accuracy train: 0.996874 val: 0.774648 test: 0.779685
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  29 loss training:  17.199922805652022 Time :  3070
accuracy train: 0.997656 val: 0.776056 test: 0.774902
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  30 loss training:  16.126004226505756 Time :  3076
accuracy train: 0.997499 val: 0.774648 test: 0.774620
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  31 loss training:  14.1102649345994 Time :  3085
accuracy train: 0.999219 val: 0.780282 test: 0.776871
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  32 loss training:  13.818680963013321 Time :  3094
accuracy train: 0.999219 val: 0.773239 test: 0.773495
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  33 loss training:  13.677362306043506 Time :  3103
accuracy train: 0.999062 val: 0.781690 test: 0.767867
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  34 loss training:  12.34337659412995 Time :  3112
accuracy train: 0.999687 val: 0.777465 test: 0.771806
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  35 loss training:  10.595248538069427 Time :  3121
accuracy train: 0.999687 val: 0.783099 test: 0.768430
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  36 loss training:  10.169866933021694 Time :  3130
accuracy train: 0.999687 val: 0.771831 test: 0.774057
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  37 loss training:  11.310461912769824 Time :  3139
accuracy train: 0.999687 val: 0.773239 test: 0.773776
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  38 loss training:  9.81839101202786 Time :  3148
accuracy train: 1.000000 val: 0.764789 test: 0.767867
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  39 loss training:  10.198822903446853 Time :  3157
accuracy train: 0.999844 val: 0.770423 test: 0.765898
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  40 loss training:  9.56597077473998 Time :  3165
accuracy train: 0.999375 val: 0.769014 test: 0.762240
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  41 loss training:  8.023945591412485 Time :  3174
accuracy train: 1.000000 val: 0.769014 test: 0.767867
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  42 loss training:  7.747965793358162 Time :  3185
accuracy train: 1.000000 val: 0.769014 test: 0.764209
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  43 loss training:  7.5276671992614865 Time :  3194
accuracy train: 1.000000 val: 0.767606 test: 0.760833
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  44 loss training:  7.6846753128338605 Time :  3203
accuracy train: 1.000000 val: 0.776056 test: 0.772088
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  45 loss training:  7.191623437684029 Time :  3212
accuracy train: 1.000000 val: 0.763380 test: 0.761958
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  46 loss training:  7.044906105613336 Time :  3221
accuracy train: 1.000000 val: 0.766197 test: 0.759426
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  47 loss training:  6.384239455568604 Time :  3231
accuracy train: 1.000000 val: 0.781690 test: 0.756050
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  48 loss training:  6.785288072889671 Time :  3240
accuracy train: 1.000000 val: 0.776056 test: 0.763928
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  49 loss training:  5.226253909757361 Time :  3250
accuracy train: 1.000000 val: 0.769014 test: 0.761396
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  50 loss training:  5.569337671389803 Time :  3258
accuracy train: 1.000000 val: 0.778873 test: 0.767586
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

Epoch :  51 loss training:  5.2019113609567285 Time :  3267
accuracy train: 1.000000 val: 0.761972 test: 0.759989
max validation accuracy : 0.787324 max acc epoch : 20 test accuracy : 0.779966

========================================================================================================================================================================================================
max acc epoch :  20
max validation accuracy :  0.7873239436619718
test accuracy :  0.7799662352279122
last test_accuracy :  0.7599887450759707
max gap 5
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=217, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  91.96580520272255 Time :  3276
accuracy train: 0.780869 val: 0.752113 test: 0.760270
max validation accuracy : 0.752113 max acc epoch : 1 test accuracy : 0.760270
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.41337823867798 Time :  3283
accuracy train: 0.780244 val: 0.753521 test: 0.768149
max validation accuracy : 0.753521 max acc epoch : 2 test accuracy : 0.768149
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.70398315787315 Time :  3296
accuracy train: 0.809159 val: 0.759155 test: 0.776871
max validation accuracy : 0.759155 max acc epoch : 3 test accuracy : 0.776871
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.79027020931244 Time :  3306
accuracy train: 0.830103 val: 0.753521 test: 0.773213
max validation accuracy : 0.759155 max acc epoch : 3 test accuracy : 0.776871
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  73.74907746911049 Time :  3315
accuracy train: 0.831666 val: 0.766197 test: 0.781092
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.781092
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.20474661886692 Time :  3325
accuracy train: 0.843857 val: 0.763380 test: 0.772369
max validation accuracy : 0.766197 max acc epoch : 5 test accuracy : 0.781092
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.34145790338516 Time :  3332
accuracy train: 0.850109 val: 0.781690 test: 0.777153
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777153
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.22095727920532 Time :  3339
accuracy train: 0.856518 val: 0.774648 test: 0.780529
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777153
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.80711726844311 Time :  3349
accuracy train: 0.852298 val: 0.763380 test: 0.771244
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777153
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  63.641716375947 Time :  3358
accuracy train: 0.874961 val: 0.760563 test: 0.773495
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777153

Epoch :  11 loss training:  62.01188860833645 Time :  3368
accuracy train: 0.881994 val: 0.764789 test: 0.776027
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777153

Epoch :  12 loss training:  59.4041562974453 Time :  3378
accuracy train: 0.893873 val: 0.773239 test: 0.782217
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777153

Epoch :  13 loss training:  56.41248631477356 Time :  3387
accuracy train: 0.902626 val: 0.766197 test: 0.779966
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777153

Epoch :  14 loss training:  52.69354309141636 Time :  3395
accuracy train: 0.915911 val: 0.781690 test: 0.777715
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777153

Epoch :  15 loss training:  48.71272315084934 Time :  3401
accuracy train: 0.927946 val: 0.776056 test: 0.774339
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777153

Epoch :  16 loss training:  46.0759391784668 Time :  3415
accuracy train: 0.935292 val: 0.771831 test: 0.770962
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777153

Epoch :  17 loss training:  43.640248857438564 Time :  3425
accuracy train: 0.945295 val: 0.769014 test: 0.775746
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777153

Epoch :  18 loss training:  40.52456138283014 Time :  3435
accuracy train: 0.954048 val: 0.773239 test: 0.778841
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777153

Epoch :  19 loss training:  37.105327636003494 Time :  3444
accuracy train: 0.962645 val: 0.764789 test: 0.774902
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777153

Epoch :  20 loss training:  33.81277170032263 Time :  3454
accuracy train: 0.969522 val: 0.778873 test: 0.774057
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777153

Epoch :  21 loss training:  31.842304311692715 Time :  3464
accuracy train: 0.973585 val: 0.773239 test: 0.778278
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.777153

Epoch :  22 loss training:  30.866792034357786 Time :  3473
accuracy train: 0.979681 val: 0.792958 test: 0.767867
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  23 loss training:  27.806009273976088 Time :  3482
accuracy train: 0.984058 val: 0.774648 test: 0.771806
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  24 loss training:  26.209671676158905 Time :  3493
accuracy train: 0.986715 val: 0.780282 test: 0.771244
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  25 loss training:  24.138910001143813 Time :  3502
accuracy train: 0.987965 val: 0.776056 test: 0.773213
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  26 loss training:  23.024698100984097 Time :  3513
accuracy train: 0.991404 val: 0.776056 test: 0.772088
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  27 loss training:  19.263454450294375 Time :  3521
accuracy train: 0.993435 val: 0.770423 test: 0.772651
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  28 loss training:  17.702096233144403 Time :  3533
accuracy train: 0.994373 val: 0.773239 test: 0.774620
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  29 loss training:  17.922507658600807 Time :  3546
accuracy train: 0.995780 val: 0.769014 test: 0.772369
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  30 loss training:  17.033462904393673 Time :  3555
accuracy train: 0.996874 val: 0.767606 test: 0.771525
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  31 loss training:  14.654048318974674 Time :  3565
accuracy train: 0.997968 val: 0.777465 test: 0.771806
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  32 loss training:  14.399351106956601 Time :  3574
accuracy train: 0.998281 val: 0.777465 test: 0.770681
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  33 loss training:  13.975311239250004 Time :  3584
accuracy train: 0.998124 val: 0.767606 test: 0.770962
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  34 loss training:  12.387774198316038 Time :  3593
accuracy train: 0.999219 val: 0.774648 test: 0.768993
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  35 loss training:  11.588559912517667 Time :  3604
accuracy train: 0.998906 val: 0.773239 test: 0.768430
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  36 loss training:  9.888382104225457 Time :  3612
accuracy train: 0.999375 val: 0.777465 test: 0.776027
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  37 loss training:  11.214553426019847 Time :  3622
accuracy train: 0.999844 val: 0.773239 test: 0.773213
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  38 loss training:  10.017705116886646 Time :  3630
accuracy train: 0.999844 val: 0.777465 test: 0.768711
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  39 loss training:  10.34609581809491 Time :  3641
accuracy train: 0.999687 val: 0.770423 test: 0.770400
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  40 loss training:  8.721421093679965 Time :  3653
accuracy train: 1.000000 val: 0.777465 test: 0.767304
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  41 loss training:  8.529896973632276 Time :  3663
accuracy train: 1.000000 val: 0.771831 test: 0.768149
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  42 loss training:  7.680910788476467 Time :  3670
accuracy train: 1.000000 val: 0.780282 test: 0.765335
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  43 loss training:  7.026921350043267 Time :  3677
accuracy train: 0.999844 val: 0.764789 test: 0.758301
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  44 loss training:  8.087511605583131 Time :  3687
accuracy train: 1.000000 val: 0.769014 test: 0.767586
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  45 loss training:  6.738974661566317 Time :  3696
accuracy train: 1.000000 val: 0.776056 test: 0.765053
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  46 loss training:  6.61975533911027 Time :  3706
accuracy train: 0.999844 val: 0.773239 test: 0.764491
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  47 loss training:  6.141289649880491 Time :  3714
accuracy train: 1.000000 val: 0.769014 test: 0.765053
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  48 loss training:  5.554433831828646 Time :  3725
accuracy train: 1.000000 val: 0.784507 test: 0.767304
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  49 loss training:  5.105735242599621 Time :  3735
accuracy train: 1.000000 val: 0.773239 test: 0.764209
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  50 loss training:  5.205785559373908 Time :  3745
accuracy train: 1.000000 val: 0.776056 test: 0.769837
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  51 loss training:  4.921989646740258 Time :  3755
accuracy train: 0.999844 val: 0.780282 test: 0.756612
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  52 loss training:  4.732349286554381 Time :  3762
accuracy train: 1.000000 val: 0.777465 test: 0.764209
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

Epoch :  53 loss training:  4.723008905770257 Time :  3773
accuracy train: 1.000000 val: 0.764789 test: 0.762802
max validation accuracy : 0.792958 max acc epoch : 22 test accuracy : 0.767867

========================================================================================================================================================================================================
max acc epoch :  22
max validation accuracy :  0.7929577464788733
test accuracy :  0.7678671918964547
last test_accuracy :  0.7628024760832864
max gap 15
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=217, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  91.92383807897568 Time :  3788
accuracy train: 0.779931 val: 0.756338 test: 0.761114
max validation accuracy : 0.756338 max acc epoch : 1 test accuracy : 0.761114
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.55263593792915 Time :  3797
accuracy train: 0.762738 val: 0.746479 test: 0.750422
max validation accuracy : 0.756338 max acc epoch : 1 test accuracy : 0.761114
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.5687326490879 Time :  3807
accuracy train: 0.811660 val: 0.753521 test: 0.773776
max validation accuracy : 0.756338 max acc epoch : 1 test accuracy : 0.761114
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.27440272271633 Time :  3816
accuracy train: 0.830885 val: 0.746479 test: 0.768430
max validation accuracy : 0.756338 max acc epoch : 1 test accuracy : 0.761114
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  73.43558152019978 Time :  3826
accuracy train: 0.832604 val: 0.767606 test: 0.777715
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.777715
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.28531403839588 Time :  3836
accuracy train: 0.850578 val: 0.759155 test: 0.775464
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.777715
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.77603669464588 Time :  3845
accuracy train: 0.854798 val: 0.766197 test: 0.777153
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.777715
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.94061729311943 Time :  3854
accuracy train: 0.861832 val: 0.760563 test: 0.782499
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.777715
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.34205064922571 Time :  3864
accuracy train: 0.854955 val: 0.759155 test: 0.773776
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.777715
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.057633101940155 Time :  3874
accuracy train: 0.881682 val: 0.754930 test: 0.777997
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.777715

Epoch :  11 loss training:  60.59560181200504 Time :  3880
accuracy train: 0.885120 val: 0.766197 test: 0.772088
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.777715

Epoch :  12 loss training:  57.579981714487076 Time :  3888
accuracy train: 0.903720 val: 0.766197 test: 0.782217
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.777715

Epoch :  13 loss training:  55.418160155415535 Time :  3902
accuracy train: 0.914661 val: 0.770423 test: 0.777434
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.777434

Epoch :  14 loss training:  51.3891336619854 Time :  3913
accuracy train: 0.928728 val: 0.757746 test: 0.776027
max validation accuracy : 0.770423 max acc epoch : 13 test accuracy : 0.777434

Epoch :  15 loss training:  47.10652405023575 Time :  3922
accuracy train: 0.938575 val: 0.771831 test: 0.778841
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.778841

Epoch :  16 loss training:  44.74581900238991 Time :  3933
accuracy train: 0.944201 val: 0.753521 test: 0.779685
max validation accuracy : 0.771831 max acc epoch : 15 test accuracy : 0.778841

Epoch :  17 loss training:  42.12474577128887 Time :  3943
accuracy train: 0.954361 val: 0.776056 test: 0.768993
max validation accuracy : 0.776056 max acc epoch : 17 test accuracy : 0.768993

Epoch :  18 loss training:  39.09343059360981 Time :  3952
accuracy train: 0.959519 val: 0.764789 test: 0.774057
max validation accuracy : 0.776056 max acc epoch : 17 test accuracy : 0.768993

Epoch :  19 loss training:  36.678260155022144 Time :  3962
accuracy train: 0.971554 val: 0.763380 test: 0.774620
max validation accuracy : 0.776056 max acc epoch : 17 test accuracy : 0.768993

Epoch :  20 loss training:  33.36667662858963 Time :  3971
accuracy train: 0.970928 val: 0.780282 test: 0.778559
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.778559

Epoch :  21 loss training:  31.2587177939713 Time :  3981
accuracy train: 0.977493 val: 0.780282 test: 0.773213
max validation accuracy : 0.780282 max acc epoch : 20 test accuracy : 0.778559

Epoch :  22 loss training:  29.66918947175145 Time :  3991
accuracy train: 0.984839 val: 0.783099 test: 0.771244
max validation accuracy : 0.783099 max acc epoch : 22 test accuracy : 0.771244

Epoch :  23 loss training:  27.026237409561872 Time :  4000
accuracy train: 0.986871 val: 0.766197 test: 0.767023
max validation accuracy : 0.783099 max acc epoch : 22 test accuracy : 0.771244

Epoch :  24 loss training:  25.497880846261978 Time :  4010
accuracy train: 0.989684 val: 0.766197 test: 0.764491
max validation accuracy : 0.783099 max acc epoch : 22 test accuracy : 0.771244

Epoch :  25 loss training:  23.99813701212406 Time :  4018
accuracy train: 0.992185 val: 0.780282 test: 0.768711
max validation accuracy : 0.783099 max acc epoch : 22 test accuracy : 0.771244

Epoch :  26 loss training:  22.327471684664488 Time :  4030
accuracy train: 0.994061 val: 0.774648 test: 0.768993
max validation accuracy : 0.783099 max acc epoch : 22 test accuracy : 0.771244

Epoch :  27 loss training:  19.248323252424598 Time :  4039
accuracy train: 0.995780 val: 0.773239 test: 0.770681
max validation accuracy : 0.783099 max acc epoch : 22 test accuracy : 0.771244

Epoch :  28 loss training:  18.039954924955964 Time :  4049
accuracy train: 0.995155 val: 0.773239 test: 0.773495
max validation accuracy : 0.783099 max acc epoch : 22 test accuracy : 0.771244

Epoch :  29 loss training:  17.666101396083832 Time :  4058
accuracy train: 0.996561 val: 0.767606 test: 0.771806
max validation accuracy : 0.783099 max acc epoch : 22 test accuracy : 0.771244

Epoch :  30 loss training:  16.239409239962697 Time :  4067
accuracy train: 0.997499 val: 0.783099 test: 0.772088
max validation accuracy : 0.783099 max acc epoch : 22 test accuracy : 0.771244

Epoch :  31 loss training:  15.036580234766006 Time :  4076
accuracy train: 0.998124 val: 0.783099 test: 0.769837
max validation accuracy : 0.783099 max acc epoch : 22 test accuracy : 0.771244

Epoch :  32 loss training:  13.935189586598426 Time :  4086
accuracy train: 0.999219 val: 0.781690 test: 0.771525
max validation accuracy : 0.783099 max acc epoch : 22 test accuracy : 0.771244

Epoch :  33 loss training:  13.478900992311537 Time :  4095
accuracy train: 0.998437 val: 0.778873 test: 0.759707
max validation accuracy : 0.783099 max acc epoch : 22 test accuracy : 0.771244

Epoch :  34 loss training:  12.79527893383056 Time :  4104
accuracy train: 1.000000 val: 0.774648 test: 0.768430
max validation accuracy : 0.783099 max acc epoch : 22 test accuracy : 0.771244

Epoch :  35 loss training:  11.383789891377091 Time :  4114
accuracy train: 0.999375 val: 0.780282 test: 0.765616
max validation accuracy : 0.783099 max acc epoch : 22 test accuracy : 0.771244

Epoch :  36 loss training:  10.535677543841302 Time :  4124
accuracy train: 0.999219 val: 0.776056 test: 0.767586
max validation accuracy : 0.783099 max acc epoch : 22 test accuracy : 0.771244

Epoch :  37 loss training:  11.889919769018888 Time :  4133
accuracy train: 0.999844 val: 0.780282 test: 0.768430
max validation accuracy : 0.783099 max acc epoch : 22 test accuracy : 0.771244

Epoch :  38 loss training:  10.207758265547454 Time :  4147
accuracy train: 1.000000 val: 0.785915 test: 0.763365
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  39 loss training:  10.486330035608262 Time :  4156
accuracy train: 1.000000 val: 0.767606 test: 0.767023
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  40 loss training:  8.981376146432012 Time :  4167
accuracy train: 1.000000 val: 0.774648 test: 0.757175
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  41 loss training:  8.14790151361376 Time :  4176
accuracy train: 1.000000 val: 0.773239 test: 0.764772
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  42 loss training:  8.005711637903005 Time :  4187
accuracy train: 1.000000 val: 0.769014 test: 0.763647
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  43 loss training:  7.11222337372601 Time :  4196
accuracy train: 1.000000 val: 0.767606 test: 0.757456
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  44 loss training:  7.624340025242418 Time :  4206
accuracy train: 0.999844 val: 0.783099 test: 0.770962
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  45 loss training:  7.417240383801982 Time :  4216
accuracy train: 1.000000 val: 0.760563 test: 0.764491
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  46 loss training:  6.893945530755445 Time :  4226
accuracy train: 1.000000 val: 0.764789 test: 0.763928
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  47 loss training:  6.6817133099539205 Time :  4235
accuracy train: 1.000000 val: 0.761972 test: 0.763647
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  48 loss training:  6.8839862728491426 Time :  4245
accuracy train: 1.000000 val: 0.769014 test: 0.768430
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  49 loss training:  5.810075974324718 Time :  4255
accuracy train: 1.000000 val: 0.774648 test: 0.766460
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  50 loss training:  5.626654744846746 Time :  4266
accuracy train: 1.000000 val: 0.778873 test: 0.769555
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  51 loss training:  5.6209788240958005 Time :  4276
accuracy train: 1.000000 val: 0.761972 test: 0.760551
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  52 loss training:  4.548725948901847 Time :  4285
accuracy train: 1.000000 val: 0.781690 test: 0.763365
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  53 loss training:  5.112540691392496 Time :  4295
accuracy train: 1.000000 val: 0.776056 test: 0.762521
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  54 loss training:  5.587459850183222 Time :  4305
accuracy train: 1.000000 val: 0.781690 test: 0.764772
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  55 loss training:  4.731643440143671 Time :  4315
accuracy train: 1.000000 val: 0.777465 test: 0.766460
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  56 loss training:  4.551699981791899 Time :  4325
accuracy train: 1.000000 val: 0.771831 test: 0.767023
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  57 loss training:  3.5219675345579162 Time :  4334
accuracy train: 1.000000 val: 0.771831 test: 0.762240
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  58 loss training:  4.875310025061481 Time :  4343
accuracy train: 1.000000 val: 0.759155 test: 0.764772
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  59 loss training:  3.8610170971951447 Time :  4354
accuracy train: 1.000000 val: 0.774648 test: 0.759707
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  60 loss training:  4.7914643692201935 Time :  4363
accuracy train: 1.000000 val: 0.780282 test: 0.761958
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  61 loss training:  4.543790212948807 Time :  4374
accuracy train: 1.000000 val: 0.776056 test: 0.766742
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  62 loss training:  3.996227481169626 Time :  4387
accuracy train: 1.000000 val: 0.784507 test: 0.765335
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  63 loss training:  3.3991560076829046 Time :  4398
accuracy train: 1.000000 val: 0.780282 test: 0.764209
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  64 loss training:  3.864828065270558 Time :  4406
accuracy train: 1.000000 val: 0.770423 test: 0.756331
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  65 loss training:  3.089902861858718 Time :  4417
accuracy train: 1.000000 val: 0.781690 test: 0.765335
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  66 loss training:  3.2078889550757594 Time :  4426
accuracy train: 1.000000 val: 0.771831 test: 0.757738
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  67 loss training:  2.83312704283162 Time :  4437
accuracy train: 1.000000 val: 0.784507 test: 0.761114
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  68 loss training:  3.0310485597292427 Time :  4447
accuracy train: 1.000000 val: 0.778873 test: 0.761958
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

Epoch :  69 loss training:  3.4865970482642297 Time :  4457
accuracy train: 1.000000 val: 0.771831 test: 0.764772
max validation accuracy : 0.785915 max acc epoch : 38 test accuracy : 0.763365

========================================================================================================================================================================================================
max acc epoch :  38
max validation accuracy :  0.7859154929577464
test accuracy :  0.7633652222847496
last test_accuracy :  0.7647720877884074
max gap 16
========================================================================================================================================================================================================

itr : 6
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=217, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  91.93418949842453 Time :  4468
accuracy train: 0.778525 val: 0.739437 test: 0.758863
max validation accuracy : 0.739437 max acc epoch : 1 test accuracy : 0.758863
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.48342594504356 Time :  4475
accuracy train: 0.781025 val: 0.760563 test: 0.766460
max validation accuracy : 0.760563 max acc epoch : 2 test accuracy : 0.766460
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.65632677078247 Time :  4483
accuracy train: 0.812285 val: 0.756338 test: 0.775746
max validation accuracy : 0.760563 max acc epoch : 2 test accuracy : 0.766460
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  72.93103548884392 Time :  4495
accuracy train: 0.828071 val: 0.753521 test: 0.772651
max validation accuracy : 0.760563 max acc epoch : 2 test accuracy : 0.766460
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  73.22643008828163 Time :  4506
accuracy train: 0.834792 val: 0.771831 test: 0.780248
max validation accuracy : 0.771831 max acc epoch : 5 test accuracy : 0.780248
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.23221273720264 Time :  4515
accuracy train: 0.850266 val: 0.764789 test: 0.771806
max validation accuracy : 0.771831 max acc epoch : 5 test accuracy : 0.780248
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.24915985763073 Time :  4525
accuracy train: 0.854798 val: 0.777465 test: 0.776027
max validation accuracy : 0.777465 max acc epoch : 7 test accuracy : 0.776027
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.84740753471851 Time :  4534
accuracy train: 0.863395 val: 0.776056 test: 0.774057
max validation accuracy : 0.777465 max acc epoch : 7 test accuracy : 0.776027
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.72783259302378 Time :  4544
accuracy train: 0.860894 val: 0.769014 test: 0.775746
max validation accuracy : 0.777465 max acc epoch : 7 test accuracy : 0.776027
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.560280323028564 Time :  4552
accuracy train: 0.883557 val: 0.759155 test: 0.775746
max validation accuracy : 0.777465 max acc epoch : 7 test accuracy : 0.776027

Epoch :  11 loss training:  60.220161974430084 Time :  4563
accuracy train: 0.891529 val: 0.766197 test: 0.769837
max validation accuracy : 0.777465 max acc epoch : 7 test accuracy : 0.776027

Epoch :  12 loss training:  57.524766743183136 Time :  4572
accuracy train: 0.905283 val: 0.774648 test: 0.777153
max validation accuracy : 0.777465 max acc epoch : 7 test accuracy : 0.776027

Epoch :  13 loss training:  54.63100911676884 Time :  4581
accuracy train: 0.919506 val: 0.780282 test: 0.778559
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.778559

Epoch :  14 loss training:  51.464131742715836 Time :  4588
accuracy train: 0.929822 val: 0.774648 test: 0.776308
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.778559

Epoch :  15 loss training:  46.599324479699135 Time :  4598
accuracy train: 0.939825 val: 0.773239 test: 0.778841
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.778559

Epoch :  16 loss training:  43.93949976563454 Time :  4604
accuracy train: 0.942951 val: 0.771831 test: 0.774057
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.778559

Epoch :  17 loss training:  41.65413284301758 Time :  4616
accuracy train: 0.955767 val: 0.773239 test: 0.771525
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.778559

Epoch :  18 loss training:  38.25530209392309 Time :  4627
accuracy train: 0.961550 val: 0.774648 test: 0.772088
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.778559

Epoch :  19 loss training:  35.251300401985645 Time :  4637
accuracy train: 0.970303 val: 0.769014 test: 0.774057
max validation accuracy : 0.780282 max acc epoch : 13 test accuracy : 0.778559

Epoch :  20 loss training:  32.58298282697797 Time :  4647
accuracy train: 0.970928 val: 0.783099 test: 0.773213
max validation accuracy : 0.783099 max acc epoch : 20 test accuracy : 0.773213

Epoch :  21 loss training:  30.847853753715754 Time :  4656
accuracy train: 0.978587 val: 0.778873 test: 0.773776
max validation accuracy : 0.783099 max acc epoch : 20 test accuracy : 0.773213

Epoch :  22 loss training:  29.015535656362772 Time :  4667
accuracy train: 0.986871 val: 0.778873 test: 0.774057
max validation accuracy : 0.783099 max acc epoch : 20 test accuracy : 0.773213

Epoch :  23 loss training:  26.535637244582176 Time :  4676
accuracy train: 0.986558 val: 0.767606 test: 0.772088
max validation accuracy : 0.783099 max acc epoch : 20 test accuracy : 0.773213

Epoch :  24 loss training:  24.773366264998913 Time :  4687
accuracy train: 0.989997 val: 0.771831 test: 0.774339
max validation accuracy : 0.783099 max acc epoch : 20 test accuracy : 0.773213

Epoch :  25 loss training:  23.790316224098206 Time :  4697
accuracy train: 0.992185 val: 0.776056 test: 0.773776
max validation accuracy : 0.783099 max acc epoch : 20 test accuracy : 0.773213

Epoch :  26 loss training:  22.388676090165973 Time :  4704
accuracy train: 0.994998 val: 0.774648 test: 0.765335
max validation accuracy : 0.783099 max acc epoch : 20 test accuracy : 0.773213

Epoch :  27 loss training:  18.736343314871192 Time :  4712
accuracy train: 0.995624 val: 0.780282 test: 0.770962
max validation accuracy : 0.783099 max acc epoch : 20 test accuracy : 0.773213

Epoch :  28 loss training:  17.56661244481802 Time :  4723
accuracy train: 0.996561 val: 0.773239 test: 0.772932
max validation accuracy : 0.783099 max acc epoch : 20 test accuracy : 0.773213

Epoch :  29 loss training:  17.22738717123866 Time :  4734
accuracy train: 0.998124 val: 0.780282 test: 0.769274
max validation accuracy : 0.783099 max acc epoch : 20 test accuracy : 0.773213

Epoch :  30 loss training:  15.975634793750942 Time :  4743
accuracy train: 0.998124 val: 0.781690 test: 0.770118
max validation accuracy : 0.783099 max acc epoch : 20 test accuracy : 0.773213

Epoch :  31 loss training:  13.90057473257184 Time :  4749
accuracy train: 0.998593 val: 0.785915 test: 0.769274
max validation accuracy : 0.785915 max acc epoch : 31 test accuracy : 0.769274

Epoch :  32 loss training:  13.916228166781366 Time :  4760
accuracy train: 0.998906 val: 0.778873 test: 0.768993
max validation accuracy : 0.785915 max acc epoch : 31 test accuracy : 0.769274

Epoch :  33 loss training:  13.310673129744828 Time :  4769
accuracy train: 0.999375 val: 0.781690 test: 0.765335
max validation accuracy : 0.785915 max acc epoch : 31 test accuracy : 0.769274

Epoch :  34 loss training:  12.19204078707844 Time :  4780
accuracy train: 0.999531 val: 0.784507 test: 0.765898
max validation accuracy : 0.785915 max acc epoch : 31 test accuracy : 0.769274

Epoch :  35 loss training:  11.42156407982111 Time :  4789
accuracy train: 1.000000 val: 0.784507 test: 0.768430
max validation accuracy : 0.785915 max acc epoch : 31 test accuracy : 0.769274

Epoch :  36 loss training:  10.316286155954003 Time :  4799
accuracy train: 0.999062 val: 0.777465 test: 0.763647
max validation accuracy : 0.785915 max acc epoch : 31 test accuracy : 0.769274

Epoch :  37 loss training:  11.38938510324806 Time :  4809
accuracy train: 0.999844 val: 0.783099 test: 0.769274
max validation accuracy : 0.785915 max acc epoch : 31 test accuracy : 0.769274

Epoch :  38 loss training:  9.95083486661315 Time :  4819
accuracy train: 1.000000 val: 0.781690 test: 0.761114
max validation accuracy : 0.785915 max acc epoch : 31 test accuracy : 0.769274

Epoch :  39 loss training:  10.247507974971086 Time :  4829
accuracy train: 1.000000 val: 0.781690 test: 0.769274
max validation accuracy : 0.785915 max acc epoch : 31 test accuracy : 0.769274

Epoch :  40 loss training:  8.891363281290978 Time :  4838
accuracy train: 0.999844 val: 0.780282 test: 0.761958
max validation accuracy : 0.785915 max acc epoch : 31 test accuracy : 0.769274

Epoch :  41 loss training:  8.23179788410198 Time :  4849
accuracy train: 0.999844 val: 0.784507 test: 0.767304
max validation accuracy : 0.785915 max acc epoch : 31 test accuracy : 0.769274

Epoch :  42 loss training:  8.49074836994987 Time :  4861
accuracy train: 0.999844 val: 0.784507 test: 0.770962
max validation accuracy : 0.785915 max acc epoch : 31 test accuracy : 0.769274

Epoch :  43 loss training:  7.918042965698987 Time :  4870
accuracy train: 0.999687 val: 0.777465 test: 0.761958
max validation accuracy : 0.785915 max acc epoch : 31 test accuracy : 0.769274

Epoch :  44 loss training:  7.1435731099918485 Time :  4881
accuracy train: 0.999844 val: 0.783099 test: 0.769274
max validation accuracy : 0.785915 max acc epoch : 31 test accuracy : 0.769274

Epoch :  45 loss training:  7.016610621940345 Time :  4891
accuracy train: 1.000000 val: 0.770423 test: 0.764772
max validation accuracy : 0.785915 max acc epoch : 31 test accuracy : 0.769274

Epoch :  46 loss training:  6.872365903109312 Time :  4901
accuracy train: 1.000000 val: 0.767606 test: 0.762240
max validation accuracy : 0.785915 max acc epoch : 31 test accuracy : 0.769274

Epoch :  47 loss training:  6.372184582753107 Time :  4911
accuracy train: 0.999844 val: 0.764789 test: 0.763647
max validation accuracy : 0.785915 max acc epoch : 31 test accuracy : 0.769274

Epoch :  48 loss training:  6.340802717255428 Time :  4921
accuracy train: 1.000000 val: 0.778873 test: 0.766179
max validation accuracy : 0.785915 max acc epoch : 31 test accuracy : 0.769274

Epoch :  49 loss training:  5.947680599056184 Time :  4931
accuracy train: 1.000000 val: 0.791549 test: 0.758863
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  50 loss training:  5.911562563851476 Time :  4940
accuracy train: 1.000000 val: 0.783099 test: 0.769555
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  51 loss training:  5.25978026073426 Time :  4949
accuracy train: 1.000000 val: 0.780282 test: 0.762802
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  52 loss training:  4.795652917702682 Time :  4959
accuracy train: 1.000000 val: 0.777465 test: 0.758863
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  53 loss training:  5.427387634990737 Time :  4968
accuracy train: 1.000000 val: 0.785915 test: 0.761677
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  54 loss training:  5.2720863544382155 Time :  4974
accuracy train: 1.000000 val: 0.787324 test: 0.768430
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  55 loss training:  4.081764932372607 Time :  4981
accuracy train: 1.000000 val: 0.783099 test: 0.767867
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  56 loss training:  3.9396572147961706 Time :  4987
accuracy train: 1.000000 val: 0.791549 test: 0.765053
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  57 loss training:  3.608774501190055 Time :  4993
accuracy train: 1.000000 val: 0.778873 test: 0.765053
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  58 loss training:  4.257291144051123 Time :  5000
accuracy train: 1.000000 val: 0.774648 test: 0.766742
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  59 loss training:  4.153692357300315 Time :  5006
accuracy train: 0.999844 val: 0.784507 test: 0.765616
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  60 loss training:  4.877979025535751 Time :  5012
accuracy train: 1.000000 val: 0.783099 test: 0.761396
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  61 loss training:  4.216549700242467 Time :  5018
accuracy train: 1.000000 val: 0.761972 test: 0.764209
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  62 loss training:  3.982303461409174 Time :  5025
accuracy train: 1.000000 val: 0.774648 test: 0.767867
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  63 loss training:  3.6245730439550243 Time :  5035
accuracy train: 1.000000 val: 0.773239 test: 0.765335
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  64 loss training:  3.3395536550087854 Time :  5044
accuracy train: 1.000000 val: 0.770423 test: 0.757175
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  65 loss training:  2.9711230910615996 Time :  5053
accuracy train: 1.000000 val: 0.778873 test: 0.770681
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  66 loss training:  3.1751961325644515 Time :  5064
accuracy train: 1.000000 val: 0.780282 test: 0.757456
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  67 loss training:  3.120712365867803 Time :  5070
accuracy train: 1.000000 val: 0.773239 test: 0.766742
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  68 loss training:  3.2821160870371386 Time :  5079
accuracy train: 1.000000 val: 0.778873 test: 0.772088
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  69 loss training:  3.1177283735160017 Time :  5088
accuracy train: 1.000000 val: 0.771831 test: 0.766460
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  70 loss training:  2.7818723135860637 Time :  5097
accuracy train: 1.000000 val: 0.780282 test: 0.769837
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  71 loss training:  1.9834540363954147 Time :  5105
accuracy train: 1.000000 val: 0.777465 test: 0.764491
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  72 loss training:  2.657030348200351 Time :  5114
accuracy train: 1.000000 val: 0.764789 test: 0.760270
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  73 loss training:  2.848914294881979 Time :  5124
accuracy train: 1.000000 val: 0.778873 test: 0.762521
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  74 loss training:  2.5135667972790543 Time :  5133
accuracy train: 1.000000 val: 0.784507 test: 0.764209
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  75 loss training:  2.866192454530392 Time :  5142
accuracy train: 1.000000 val: 0.781690 test: 0.762240
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  76 loss training:  1.751246869273018 Time :  5151
accuracy train: 1.000000 val: 0.784507 test: 0.754080
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  77 loss training:  1.8579418161389185 Time :  5162
accuracy train: 1.000000 val: 0.788732 test: 0.760833
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  78 loss training:  2.001967605945538 Time :  5172
accuracy train: 1.000000 val: 0.781690 test: 0.761677
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  79 loss training:  2.6215036266949028 Time :  5178
accuracy train: 1.000000 val: 0.791549 test: 0.766742
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

Epoch :  80 loss training:  2.6044191106630024 Time :  5184
accuracy train: 1.000000 val: 0.784507 test: 0.760270
max validation accuracy : 0.791549 max acc epoch : 49 test accuracy : 0.758863

========================================================================================================================================================================================================
max acc epoch :  49
max validation accuracy :  0.7915492957746478
test accuracy :  0.7588632526730444
last test_accuracy :  0.7602701181767023
max gap 18
========================================================================================================================================================================================================

itr : 7
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=217, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  91.89119654893875 Time :  5195
accuracy train: 0.776180 val: 0.750704 test: 0.764491
max validation accuracy : 0.750704 max acc epoch : 1 test accuracy : 0.764491
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.37185201048851 Time :  5203
accuracy train: 0.773367 val: 0.752113 test: 0.763647
max validation accuracy : 0.752113 max acc epoch : 2 test accuracy : 0.763647
Epoch-2 lr: 0.001

Epoch :  3 loss training:  81.08372530341148 Time :  5212
accuracy train: 0.809628 val: 0.757746 test: 0.768993
max validation accuracy : 0.757746 max acc epoch : 3 test accuracy : 0.768993
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.20423048734665 Time :  5221
accuracy train: 0.830885 val: 0.745070 test: 0.770681
max validation accuracy : 0.757746 max acc epoch : 3 test accuracy : 0.768993
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  73.55882740020752 Time :  5230
accuracy train: 0.831197 val: 0.764789 test: 0.775746
max validation accuracy : 0.764789 max acc epoch : 5 test accuracy : 0.775746
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.69270184636116 Time :  5239
accuracy train: 0.844639 val: 0.753521 test: 0.771806
max validation accuracy : 0.764789 max acc epoch : 5 test accuracy : 0.775746
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.99611647427082 Time :  5248
accuracy train: 0.856518 val: 0.767606 test: 0.778841
max validation accuracy : 0.767606 max acc epoch : 7 test accuracy : 0.778841
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.11450897157192 Time :  5257
accuracy train: 0.859175 val: 0.764789 test: 0.780248
max validation accuracy : 0.767606 max acc epoch : 7 test accuracy : 0.778841
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.26797023415565 Time :  5269
accuracy train: 0.861363 val: 0.760563 test: 0.772651
max validation accuracy : 0.767606 max acc epoch : 7 test accuracy : 0.778841
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.61517609655857 Time :  5278
accuracy train: 0.880275 val: 0.757746 test: 0.776871
max validation accuracy : 0.767606 max acc epoch : 7 test accuracy : 0.778841

Epoch :  11 loss training:  61.31337857246399 Time :  5287
accuracy train: 0.888090 val: 0.770423 test: 0.771525
max validation accuracy : 0.770423 max acc epoch : 11 test accuracy : 0.771525

Epoch :  12 loss training:  58.03322561085224 Time :  5297
accuracy train: 0.903564 val: 0.767606 test: 0.783343
max validation accuracy : 0.770423 max acc epoch : 11 test accuracy : 0.771525

Epoch :  13 loss training:  55.43819035589695 Time :  5306
accuracy train: 0.913410 val: 0.771831 test: 0.775746
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.775746

Epoch :  14 loss training:  52.22271341085434 Time :  5315
accuracy train: 0.928259 val: 0.763380 test: 0.773213
max validation accuracy : 0.771831 max acc epoch : 13 test accuracy : 0.775746

Epoch :  15 loss training:  47.63391976058483 Time :  5324
accuracy train: 0.934511 val: 0.774648 test: 0.777997
max validation accuracy : 0.774648 max acc epoch : 15 test accuracy : 0.777997

Epoch :  16 loss training:  44.75347267836332 Time :  5333
accuracy train: 0.940606 val: 0.776056 test: 0.779966
max validation accuracy : 0.776056 max acc epoch : 16 test accuracy : 0.779966

Epoch :  17 loss training:  42.58376932144165 Time :  5342
accuracy train: 0.954673 val: 0.780282 test: 0.778559
max validation accuracy : 0.780282 max acc epoch : 17 test accuracy : 0.778559

Epoch :  18 loss training:  39.394679836928844 Time :  5352
accuracy train: 0.956862 val: 0.769014 test: 0.775746
max validation accuracy : 0.780282 max acc epoch : 17 test accuracy : 0.778559

Epoch :  19 loss training:  36.675361447036266 Time :  5362
accuracy train: 0.968740 val: 0.769014 test: 0.771806
max validation accuracy : 0.780282 max acc epoch : 17 test accuracy : 0.778559

Epoch :  20 loss training:  33.15120206400752 Time :  5370
accuracy train: 0.970303 val: 0.777465 test: 0.775464
max validation accuracy : 0.780282 max acc epoch : 17 test accuracy : 0.778559

Epoch :  21 loss training:  31.249862734228373 Time :  5376
accuracy train: 0.977180 val: 0.781690 test: 0.779403
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.779403

Epoch :  22 loss training:  29.76012185961008 Time :  5383
accuracy train: 0.982963 val: 0.766197 test: 0.766460
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.779403

Epoch :  23 loss training:  27.21754989773035 Time :  5389
accuracy train: 0.986089 val: 0.760563 test: 0.777997
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.779403

Epoch :  24 loss training:  25.887454088777304 Time :  5395
accuracy train: 0.987652 val: 0.770423 test: 0.772932
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.779403

Epoch :  25 loss training:  23.618891339749098 Time :  5402
accuracy train: 0.991247 val: 0.763380 test: 0.775746
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.779403

Epoch :  26 loss training:  22.668592175468802 Time :  5408
accuracy train: 0.993279 val: 0.774648 test: 0.770400
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.779403

Epoch :  27 loss training:  19.785577327013016 Time :  5414
accuracy train: 0.993435 val: 0.761972 test: 0.777153
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.779403

Epoch :  28 loss training:  17.934943102300167 Time :  5422
accuracy train: 0.994842 val: 0.761972 test: 0.772932
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.779403

Epoch :  29 loss training:  17.747183127328753 Time :  5429
accuracy train: 0.995624 val: 0.766197 test: 0.770400
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.779403

Epoch :  30 loss training:  16.957860946655273 Time :  5436
accuracy train: 0.996874 val: 0.766197 test: 0.774339
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.779403

Epoch :  31 loss training:  14.551242765039206 Time :  5442
accuracy train: 0.997656 val: 0.774648 test: 0.774902
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.779403

Epoch :  32 loss training:  14.240764265414327 Time :  5448
accuracy train: 0.998124 val: 0.773239 test: 0.771525
max validation accuracy : 0.781690 max acc epoch : 21 test accuracy : 0.779403

Epoch :  33 loss training:  13.235778890550137 Time :  5456
accuracy train: 0.999062 val: 0.785915 test: 0.765616
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.765616

Epoch :  34 loss training:  12.391329413279891 Time :  5466
accuracy train: 0.998906 val: 0.780282 test: 0.770962
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.765616

Epoch :  35 loss training:  11.728805157355964 Time :  5475
accuracy train: 0.999219 val: 0.766197 test: 0.766179
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.765616

Epoch :  36 loss training:  10.522449261508882 Time :  5484
accuracy train: 0.999062 val: 0.767606 test: 0.771806
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.765616

Epoch :  37 loss training:  11.117240494582802 Time :  5492
accuracy train: 0.999687 val: 0.780282 test: 0.772088
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.765616

Epoch :  38 loss training:  10.494445457588881 Time :  5501
accuracy train: 0.999375 val: 0.780282 test: 0.772088
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.765616

Epoch :  39 loss training:  10.758403816260397 Time :  5510
accuracy train: 0.999375 val: 0.781690 test: 0.772651
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.765616

Epoch :  40 loss training:  9.296905882656574 Time :  5518
accuracy train: 0.999687 val: 0.770423 test: 0.766460
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.765616

Epoch :  41 loss training:  7.587699808413163 Time :  5527
accuracy train: 0.999844 val: 0.777465 test: 0.769555
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.765616

Epoch :  42 loss training:  8.60303987422958 Time :  5536
accuracy train: 0.999844 val: 0.783099 test: 0.773776
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.765616

Epoch :  43 loss training:  7.954708147328347 Time :  5545
accuracy train: 0.999687 val: 0.776056 test: 0.765616
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.765616

Epoch :  44 loss training:  7.795330271590501 Time :  5554
accuracy train: 1.000000 val: 0.778873 test: 0.769555
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.765616

Epoch :  45 loss training:  7.708757447777316 Time :  5566
accuracy train: 1.000000 val: 0.776056 test: 0.766742
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.765616

Epoch :  46 loss training:  6.832301456015557 Time :  5573
accuracy train: 1.000000 val: 0.774648 test: 0.770962
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.765616

Epoch :  47 loss training:  6.537181575782597 Time :  5579
accuracy train: 1.000000 val: 0.766197 test: 0.762802
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.765616

Epoch :  48 loss training:  6.205894957762212 Time :  5585
accuracy train: 1.000000 val: 0.764789 test: 0.774620
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.765616

Epoch :  49 loss training:  5.630060104595032 Time :  5591
accuracy train: 1.000000 val: 0.774648 test: 0.769555
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.765616

Epoch :  50 loss training:  5.763401878299192 Time :  5598
accuracy train: 1.000000 val: 0.780282 test: 0.774057
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.765616

Epoch :  51 loss training:  5.714460108894855 Time :  5604
accuracy train: 1.000000 val: 0.767606 test: 0.768149
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.765616

Epoch :  52 loss training:  5.000572584802285 Time :  5610
accuracy train: 1.000000 val: 0.790141 test: 0.763084
max validation accuracy : 0.790141 max acc epoch : 52 test accuracy : 0.763084

Epoch :  53 loss training:  5.008361425134353 Time :  5616
accuracy train: 1.000000 val: 0.780282 test: 0.762802
max validation accuracy : 0.790141 max acc epoch : 52 test accuracy : 0.763084

Epoch :  54 loss training:  4.989528597157914 Time :  5623
accuracy train: 1.000000 val: 0.783099 test: 0.764209
max validation accuracy : 0.790141 max acc epoch : 52 test accuracy : 0.763084

Epoch :  55 loss training:  4.156659317202866 Time :  5629
accuracy train: 1.000000 val: 0.780282 test: 0.768993
max validation accuracy : 0.790141 max acc epoch : 52 test accuracy : 0.763084

Epoch :  56 loss training:  3.8593631958356127 Time :  5635
accuracy train: 1.000000 val: 0.790141 test: 0.761958
max validation accuracy : 0.790141 max acc epoch : 52 test accuracy : 0.763084

Epoch :  57 loss training:  3.5781913172104396 Time :  5641
accuracy train: 1.000000 val: 0.778873 test: 0.760270
max validation accuracy : 0.790141 max acc epoch : 52 test accuracy : 0.763084

Epoch :  58 loss training:  4.798689269053284 Time :  5648
accuracy train: 1.000000 val: 0.774648 test: 0.761396
max validation accuracy : 0.790141 max acc epoch : 52 test accuracy : 0.763084

Epoch :  59 loss training:  4.235201355302706 Time :  5657
accuracy train: 1.000000 val: 0.784507 test: 0.760833
max validation accuracy : 0.790141 max acc epoch : 52 test accuracy : 0.763084

Epoch :  60 loss training:  4.416111422993708 Time :  5667
accuracy train: 1.000000 val: 0.780282 test: 0.753236
max validation accuracy : 0.790141 max acc epoch : 52 test accuracy : 0.763084

Epoch :  61 loss training:  4.282530739554204 Time :  5675
accuracy train: 1.000000 val: 0.784507 test: 0.755768
max validation accuracy : 0.790141 max acc epoch : 52 test accuracy : 0.763084

Epoch :  62 loss training:  4.067398690676782 Time :  5684
accuracy train: 1.000000 val: 0.780282 test: 0.765335
max validation accuracy : 0.790141 max acc epoch : 52 test accuracy : 0.763084

Epoch :  63 loss training:  3.8179735557059757 Time :  5693
accuracy train: 1.000000 val: 0.781690 test: 0.765898
max validation accuracy : 0.790141 max acc epoch : 52 test accuracy : 0.763084

Epoch :  64 loss training:  3.3654767196276225 Time :  5702
accuracy train: 1.000000 val: 0.776056 test: 0.756331
max validation accuracy : 0.790141 max acc epoch : 52 test accuracy : 0.763084

Epoch :  65 loss training:  3.452947372716153 Time :  5711
accuracy train: 1.000000 val: 0.784507 test: 0.767586
max validation accuracy : 0.790141 max acc epoch : 52 test accuracy : 0.763084

Epoch :  66 loss training:  3.29950557477423 Time :  5720
accuracy train: 1.000000 val: 0.778873 test: 0.762521
max validation accuracy : 0.790141 max acc epoch : 52 test accuracy : 0.763084

Epoch :  67 loss training:  2.6038831668847706 Time :  5729
accuracy train: 1.000000 val: 0.784507 test: 0.764209
max validation accuracy : 0.790141 max acc epoch : 52 test accuracy : 0.763084

Epoch :  68 loss training:  2.692973563243868 Time :  5736
accuracy train: 1.000000 val: 0.781690 test: 0.773776
max validation accuracy : 0.790141 max acc epoch : 52 test accuracy : 0.763084

Epoch :  69 loss training:  3.674006434623152 Time :  5742
accuracy train: 1.000000 val: 0.783099 test: 0.766460
max validation accuracy : 0.790141 max acc epoch : 52 test accuracy : 0.763084

Epoch :  70 loss training:  2.4467597120965365 Time :  5748
accuracy train: 1.000000 val: 0.790141 test: 0.767304
max validation accuracy : 0.790141 max acc epoch : 52 test accuracy : 0.763084

Epoch :  71 loss training:  2.255033451219788 Time :  5757
accuracy train: 1.000000 val: 0.792958 test: 0.763928
max validation accuracy : 0.792958 max acc epoch : 71 test accuracy : 0.763928

Epoch :  72 loss training:  3.0321794511110056 Time :  5764
accuracy train: 1.000000 val: 0.790141 test: 0.761396
max validation accuracy : 0.792958 max acc epoch : 71 test accuracy : 0.763928

Epoch :  73 loss training:  2.306927598285256 Time :  5770
accuracy train: 1.000000 val: 0.783099 test: 0.764772
max validation accuracy : 0.792958 max acc epoch : 71 test accuracy : 0.763928

Epoch :  74 loss training:  2.2397231133509194 Time :  5776
accuracy train: 1.000000 val: 0.790141 test: 0.763084
max validation accuracy : 0.792958 max acc epoch : 71 test accuracy : 0.763928

Epoch :  75 loss training:  2.361431077719317 Time :  5782
accuracy train: 1.000000 val: 0.791549 test: 0.767304
max validation accuracy : 0.792958 max acc epoch : 71 test accuracy : 0.763928

Epoch :  76 loss training:  1.8287507146014832 Time :  5789
accuracy train: 1.000000 val: 0.798592 test: 0.764209
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  77 loss training:  2.05477827359573 Time :  5798
accuracy train: 1.000000 val: 0.788732 test: 0.768149
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  78 loss training:  1.5833821652049664 Time :  5807
accuracy train: 1.000000 val: 0.788732 test: 0.760551
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  79 loss training:  2.309638887678375 Time :  5816
accuracy train: 1.000000 val: 0.785915 test: 0.765335
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  80 loss training:  2.833101808821084 Time :  5824
accuracy train: 1.000000 val: 0.791549 test: 0.755487
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  81 loss training:  2.516517318188562 Time :  5833
accuracy train: 1.000000 val: 0.783099 test: 0.761958
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  82 loss training:  1.7133233797940193 Time :  5842
accuracy train: 1.000000 val: 0.791549 test: 0.765335
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  83 loss training:  1.6385653989200364 Time :  5850
accuracy train: 1.000000 val: 0.792958 test: 0.762521
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  84 loss training:  1.617662920813018 Time :  5861
accuracy train: 1.000000 val: 0.788732 test: 0.764491
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  85 loss training:  2.325679325222154 Time :  5871
accuracy train: 1.000000 val: 0.788732 test: 0.767586
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  86 loss training:  1.5800375784165226 Time :  5880
accuracy train: 1.000000 val: 0.784507 test: 0.759426
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  87 loss training:  1.9877024422894465 Time :  5889
accuracy train: 1.000000 val: 0.781690 test: 0.759426
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  88 loss training:  2.0762409247545293 Time :  5898
accuracy train: 1.000000 val: 0.787324 test: 0.765053
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  89 loss training:  1.9652090611489257 Time :  5907
accuracy train: 1.000000 val: 0.783099 test: 0.755487
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  90 loss training:  1.2308946080083842 Time :  5917
accuracy train: 1.000000 val: 0.787324 test: 0.759145
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  91 loss training:  1.9155508974508848 Time :  5926
accuracy train: 1.000000 val: 0.778873 test: 0.759989
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  92 loss training:  1.3817272941596457 Time :  5934
accuracy train: 1.000000 val: 0.783099 test: 0.760270
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  93 loss training:  1.7867162637339788 Time :  5943
accuracy train: 1.000000 val: 0.774648 test: 0.760270
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  94 loss training:  1.280338189797476 Time :  5954
accuracy train: 0.999844 val: 0.776056 test: 0.755205
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  95 loss training:  1.3955452183290618 Time :  5961
accuracy train: 1.000000 val: 0.791549 test: 0.765616
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  96 loss training:  1.4468453597801272 Time :  5968
accuracy train: 1.000000 val: 0.783099 test: 0.756612
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  97 loss training:  1.186935150573845 Time :  5974
accuracy train: 1.000000 val: 0.791549 test: 0.759989
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  98 loss training:  1.7403141979521024 Time :  5981
accuracy train: 1.000000 val: 0.778873 test: 0.762521
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  99 loss training:  1.833340948462137 Time :  5987
accuracy train: 1.000000 val: 0.785915 test: 0.762240
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  100 loss training:  1.1532010101800552 Time :  5996
accuracy train: 1.000000 val: 0.798592 test: 0.763084
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  101 loss training:  0.9632245148713992 Time :  6005
accuracy train: 1.000000 val: 0.773239 test: 0.756894
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  102 loss training:  1.223915801372641 Time :  6015
accuracy train: 1.000000 val: 0.780282 test: 0.752673
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  103 loss training:  1.3446612778570852 Time :  6024
accuracy train: 1.000000 val: 0.771831 test: 0.752954
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  104 loss training:  1.2562039076128713 Time :  6033
accuracy train: 1.000000 val: 0.770423 test: 0.752954
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  105 loss training:  1.3213282722390431 Time :  6042
accuracy train: 1.000000 val: 0.783099 test: 0.751548
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  106 loss training:  0.9962714913153832 Time :  6052
accuracy train: 1.000000 val: 0.784507 test: 0.755205
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

Epoch :  107 loss training:  1.5055982314879657 Time :  6062
accuracy train: 1.000000 val: 0.771831 test: 0.747046
max validation accuracy : 0.798592 max acc epoch : 76 test accuracy : 0.764209

========================================================================================================================================================================================================
max acc epoch :  76
max validation accuracy :  0.7985915492957747
test accuracy :  0.7642093415869443
last test_accuracy :  0.7470455824423186
max gap 19
========================================================================================================================================================================================================

itr : 8
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=217, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  91.86664474010468 Time :  6071
accuracy train: 0.776024 val: 0.756338 test: 0.763365
max validation accuracy : 0.756338 max acc epoch : 1 test accuracy : 0.763365
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.43137228488922 Time :  6080
accuracy train: 0.774773 val: 0.746479 test: 0.762521
max validation accuracy : 0.756338 max acc epoch : 1 test accuracy : 0.763365
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.77342277765274 Time :  6089
accuracy train: 0.811347 val: 0.769014 test: 0.774620
max validation accuracy : 0.769014 max acc epoch : 3 test accuracy : 0.774620
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.27520042657852 Time :  6097
accuracy train: 0.829165 val: 0.757746 test: 0.774902
max validation accuracy : 0.769014 max acc epoch : 3 test accuracy : 0.774620
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  73.5614323914051 Time :  6107
accuracy train: 0.831354 val: 0.773239 test: 0.779685
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.779685
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.47497123479843 Time :  6116
accuracy train: 0.850109 val: 0.763380 test: 0.776027
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.779685
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.10767258703709 Time :  6125
accuracy train: 0.854642 val: 0.769014 test: 0.775746
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.779685
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.54519706964493 Time :  6133
accuracy train: 0.861207 val: 0.781690 test: 0.777153
max validation accuracy : 0.781690 max acc epoch : 8 test accuracy : 0.777153
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.50887757539749 Time :  6142
accuracy train: 0.854955 val: 0.771831 test: 0.767586
max validation accuracy : 0.781690 max acc epoch : 8 test accuracy : 0.777153
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.56469660997391 Time :  6151
accuracy train: 0.878868 val: 0.770423 test: 0.778278
max validation accuracy : 0.781690 max acc epoch : 8 test accuracy : 0.777153

Epoch :  11 loss training:  61.304956659674644 Time :  6162
accuracy train: 0.886840 val: 0.771831 test: 0.773213
max validation accuracy : 0.781690 max acc epoch : 8 test accuracy : 0.777153

Epoch :  12 loss training:  58.546429216861725 Time :  6171
accuracy train: 0.900281 val: 0.790141 test: 0.779403
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.779403

Epoch :  13 loss training:  56.00317205488682 Time :  6180
accuracy train: 0.910128 val: 0.774648 test: 0.779685
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.779403

Epoch :  14 loss training:  52.348574593663216 Time :  6189
accuracy train: 0.922163 val: 0.778873 test: 0.780248
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.779403

Epoch :  15 loss training:  48.06611527502537 Time :  6198
accuracy train: 0.934823 val: 0.776056 test: 0.780529
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.779403

Epoch :  16 loss training:  45.17005544155836 Time :  6207
accuracy train: 0.937480 val: 0.776056 test: 0.776308
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.779403

Epoch :  17 loss training:  43.06897383928299 Time :  6216
accuracy train: 0.950922 val: 0.790141 test: 0.776871
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.779403

Epoch :  18 loss training:  40.018649615347385 Time :  6225
accuracy train: 0.959362 val: 0.780282 test: 0.777153
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.779403

Epoch :  19 loss training:  37.00408153235912 Time :  6233
accuracy train: 0.966865 val: 0.780282 test: 0.775183
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.779403

Epoch :  20 loss training:  33.421683356165886 Time :  6242
accuracy train: 0.970616 val: 0.790141 test: 0.779685
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.779403

Epoch :  21 loss training:  32.110520236194134 Time :  6253
accuracy train: 0.978118 val: 0.776056 test: 0.777715
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.779403

Epoch :  22 loss training:  29.651096057146788 Time :  6263
accuracy train: 0.981869 val: 0.778873 test: 0.777715
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.779403

Epoch :  23 loss training:  27.459374394267797 Time :  6272
accuracy train: 0.985933 val: 0.776056 test: 0.774620
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.779403

Epoch :  24 loss training:  26.04045531153679 Time :  6281
accuracy train: 0.988903 val: 0.783099 test: 0.774620
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.779403

Epoch :  25 loss training:  24.038871057331562 Time :  6290
accuracy train: 0.991716 val: 0.778873 test: 0.774057
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.779403

Epoch :  26 loss training:  22.990111641585827 Time :  6298
accuracy train: 0.993435 val: 0.777465 test: 0.768430
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.779403

Epoch :  27 loss training:  19.090636842884123 Time :  6307
accuracy train: 0.995780 val: 0.771831 test: 0.769555
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.779403

Epoch :  28 loss training:  18.265455286949873 Time :  6316
accuracy train: 0.995624 val: 0.774648 test: 0.775746
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.779403

Epoch :  29 loss training:  18.00170588120818 Time :  6325
accuracy train: 0.996405 val: 0.777465 test: 0.772651
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.779403

Epoch :  30 loss training:  17.06003523990512 Time :  6334
accuracy train: 0.996874 val: 0.773239 test: 0.776871
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.779403

Epoch :  31 loss training:  14.809159697964787 Time :  6343
accuracy train: 0.998124 val: 0.777465 test: 0.777153
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.779403

Epoch :  32 loss training:  14.522971326019615 Time :  6354
accuracy train: 0.998906 val: 0.780282 test: 0.769274
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.779403

Epoch :  33 loss training:  14.13676519645378 Time :  6363
accuracy train: 0.999375 val: 0.784507 test: 0.768711
max validation accuracy : 0.790141 max acc epoch : 12 test accuracy : 0.779403

Epoch :  34 loss training:  12.366668333299458 Time :  6372
accuracy train: 0.999531 val: 0.794366 test: 0.768993
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  35 loss training:  11.62235199380666 Time :  6381
accuracy train: 0.999687 val: 0.783099 test: 0.768711
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  36 loss training:  10.017525228206068 Time :  6391
accuracy train: 0.999531 val: 0.778873 test: 0.768430
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  37 loss training:  11.018815692979842 Time :  6399
accuracy train: 0.999844 val: 0.784507 test: 0.773495
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  38 loss training:  9.843246911186725 Time :  6408
accuracy train: 0.999844 val: 0.791549 test: 0.775746
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  39 loss training:  10.650908168870956 Time :  6417
accuracy train: 1.000000 val: 0.781690 test: 0.774620
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  40 loss training:  9.119726167526096 Time :  6425
accuracy train: 0.999531 val: 0.778873 test: 0.764209
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  41 loss training:  7.789720075437799 Time :  6434
accuracy train: 1.000000 val: 0.785915 test: 0.766460
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  42 loss training:  8.786686224048026 Time :  6443
accuracy train: 1.000000 val: 0.781690 test: 0.767867
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  43 loss training:  7.3748172738123685 Time :  6454
accuracy train: 1.000000 val: 0.776056 test: 0.763647
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  44 loss training:  7.144224083982408 Time :  6464
accuracy train: 0.999844 val: 0.792958 test: 0.772651
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  45 loss training:  6.514672468416393 Time :  6473
accuracy train: 1.000000 val: 0.777465 test: 0.763647
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  46 loss training:  6.464932815521024 Time :  6483
accuracy train: 1.000000 val: 0.780282 test: 0.768711
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  47 loss training:  6.300811419729143 Time :  6493
accuracy train: 1.000000 val: 0.774648 test: 0.763365
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  48 loss training:  6.385188778163865 Time :  6502
accuracy train: 1.000000 val: 0.785915 test: 0.768711
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  49 loss training:  5.4214585713343695 Time :  6511
accuracy train: 1.000000 val: 0.780282 test: 0.766460
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  50 loss training:  5.375442267628387 Time :  6520
accuracy train: 1.000000 val: 0.776056 test: 0.770400
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  51 loss training:  5.287316017434932 Time :  6529
accuracy train: 1.000000 val: 0.771831 test: 0.762521
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  52 loss training:  4.384220716310665 Time :  6539
accuracy train: 1.000000 val: 0.792958 test: 0.769274
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  53 loss training:  4.8888706335565075 Time :  6550
accuracy train: 1.000000 val: 0.785915 test: 0.767586
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  54 loss training:  5.452505712863058 Time :  6561
accuracy train: 1.000000 val: 0.780282 test: 0.766742
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  55 loss training:  4.059379753714893 Time :  6571
accuracy train: 1.000000 val: 0.781690 test: 0.771806
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  56 loss training:  3.7613224251545034 Time :  6580
accuracy train: 1.000000 val: 0.791549 test: 0.769555
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  57 loss training:  3.643565114645753 Time :  6591
accuracy train: 1.000000 val: 0.773239 test: 0.770962
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  58 loss training:  4.238963996060193 Time :  6599
accuracy train: 1.000000 val: 0.773239 test: 0.768149
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  59 loss training:  3.4158013116102666 Time :  6608
accuracy train: 1.000000 val: 0.777465 test: 0.770681
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  60 loss training:  5.032466582721099 Time :  6618
accuracy train: 1.000000 val: 0.777465 test: 0.762240
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  61 loss training:  3.79469620535383 Time :  6626
accuracy train: 1.000000 val: 0.780282 test: 0.762240
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  62 loss training:  3.238255101372488 Time :  6633
accuracy train: 1.000000 val: 0.777465 test: 0.768711
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  63 loss training:  3.506520168564748 Time :  6644
accuracy train: 1.000000 val: 0.770423 test: 0.764491
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  64 loss training:  4.344245748710819 Time :  6653
accuracy train: 1.000000 val: 0.770423 test: 0.759426
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

Epoch :  65 loss training:  3.2128553219663445 Time :  6664
accuracy train: 1.000000 val: 0.780282 test: 0.772088
max validation accuracy : 0.794366 max acc epoch : 34 test accuracy : 0.768993

========================================================================================================================================================================================================
max acc epoch :  34
max validation accuracy :  0.7943661971830986
test accuracy :  0.768992684299381
last test_accuracy :  0.7720877884074282
max gap 22
========================================================================================================================================================================================================

itr : 9
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=217, weight_decay=1e-10)
device :  cuda:0

Epoch :  1 loss training:  92.00503242015839 Time :  6678
accuracy train: 0.777274 val: 0.754930 test: 0.758301
max validation accuracy : 0.754930 max acc epoch : 1 test accuracy : 0.758301
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.34447005391121 Time :  6689
accuracy train: 0.777118 val: 0.757746 test: 0.766460
max validation accuracy : 0.757746 max acc epoch : 2 test accuracy : 0.766460
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.80943703651428 Time :  6699
accuracy train: 0.812754 val: 0.766197 test: 0.774339
max validation accuracy : 0.766197 max acc epoch : 3 test accuracy : 0.774339
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.04578164219856 Time :  6708
accuracy train: 0.831510 val: 0.752113 test: 0.776027
max validation accuracy : 0.766197 max acc epoch : 3 test accuracy : 0.774339
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  73.6174032241106 Time :  6718
accuracy train: 0.829165 val: 0.773239 test: 0.780248
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.780248
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.49474519491196 Time :  6726
accuracy train: 0.850891 val: 0.752113 test: 0.777434
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.780248
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.97069942951202 Time :  6736
accuracy train: 0.858862 val: 0.769014 test: 0.778841
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.780248
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.34153687953949 Time :  6745
accuracy train: 0.860269 val: 0.767606 test: 0.777997
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.780248
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.33205008506775 Time :  6755
accuracy train: 0.859175 val: 0.760563 test: 0.774339
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.780248
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.278087332844734 Time :  6762
accuracy train: 0.880588 val: 0.761972 test: 0.774057
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.780248

Epoch :  11 loss training:  61.40459854900837 Time :  6771
accuracy train: 0.888246 val: 0.774648 test: 0.775464
max validation accuracy : 0.774648 max acc epoch : 11 test accuracy : 0.775464

Epoch :  12 loss training:  58.05992941558361 Time :  6780
accuracy train: 0.901063 val: 0.776056 test: 0.785594
max validation accuracy : 0.776056 max acc epoch : 12 test accuracy : 0.785594

Epoch :  13 loss training:  55.28929613530636 Time :  6792
accuracy train: 0.912160 val: 0.776056 test: 0.781092
max validation accuracy : 0.776056 max acc epoch : 12 test accuracy : 0.785594

Epoch :  14 loss training:  51.355821430683136 Time :  6804
accuracy train: 0.925914 val: 0.770423 test: 0.779685
max validation accuracy : 0.776056 max acc epoch : 12 test accuracy : 0.785594

Epoch :  15 loss training:  47.05302058160305 Time :  6813
accuracy train: 0.935449 val: 0.771831 test: 0.774902
max validation accuracy : 0.776056 max acc epoch : 12 test accuracy : 0.785594

Epoch :  16 loss training:  44.495755687355995 Time :  6822
accuracy train: 0.941232 val: 0.766197 test: 0.779122
max validation accuracy : 0.776056 max acc epoch : 12 test accuracy : 0.785594

Epoch :  17 loss training:  42.34534977376461 Time :  6829
accuracy train: 0.955611 val: 0.781690 test: 0.776871
max validation accuracy : 0.781690 max acc epoch : 17 test accuracy : 0.776871

Epoch :  18 loss training:  39.644096076488495 Time :  6838
accuracy train: 0.957487 val: 0.776056 test: 0.776027
max validation accuracy : 0.781690 max acc epoch : 17 test accuracy : 0.776871

Epoch :  19 loss training:  36.32840935885906 Time :  6847
accuracy train: 0.969209 val: 0.773239 test: 0.775464
max validation accuracy : 0.781690 max acc epoch : 17 test accuracy : 0.776871

Epoch :  20 loss training:  33.0198048055172 Time :  6858
accuracy train: 0.972023 val: 0.781690 test: 0.777434
max validation accuracy : 0.781690 max acc epoch : 17 test accuracy : 0.776871

Epoch :  21 loss training:  30.983120039105415 Time :  6867
accuracy train: 0.975774 val: 0.784507 test: 0.778841
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  22 loss training:  30.16571543738246 Time :  6877
accuracy train: 0.983432 val: 0.777465 test: 0.774057
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  23 loss training:  26.907592054456472 Time :  6887
accuracy train: 0.987340 val: 0.781690 test: 0.768711
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  24 loss training:  25.379112903028727 Time :  6896
accuracy train: 0.988903 val: 0.781690 test: 0.771525
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  25 loss training:  22.829981992021203 Time :  6905
accuracy train: 0.991716 val: 0.777465 test: 0.768993
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  26 loss training:  22.147941451519728 Time :  6918
accuracy train: 0.994842 val: 0.774648 test: 0.768711
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  27 loss training:  19.136526685208082 Time :  6927
accuracy train: 0.994998 val: 0.767606 test: 0.768711
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  28 loss training:  18.39294288493693 Time :  6938
accuracy train: 0.996405 val: 0.771831 test: 0.769837
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  29 loss training:  17.306351180188358 Time :  6946
accuracy train: 0.996093 val: 0.777465 test: 0.771806
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  30 loss training:  16.31854551844299 Time :  6957
accuracy train: 0.997030 val: 0.776056 test: 0.770962
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  31 loss training:  15.097651039250195 Time :  6967
accuracy train: 0.998281 val: 0.777465 test: 0.768993
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  32 loss training:  14.083302984014153 Time :  6978
accuracy train: 0.998750 val: 0.784507 test: 0.764772
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  33 loss training:  13.49729288648814 Time :  6988
accuracy train: 0.998906 val: 0.783099 test: 0.760551
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  34 loss training:  11.986924903467298 Time :  6997
accuracy train: 0.999375 val: 0.771831 test: 0.766460
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  35 loss training:  10.68829308077693 Time :  7007
accuracy train: 0.999375 val: 0.781690 test: 0.761396
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  36 loss training:  10.000994859728962 Time :  7016
accuracy train: 0.999219 val: 0.778873 test: 0.764209
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  37 loss training:  10.504052967764437 Time :  7027
accuracy train: 0.999844 val: 0.780282 test: 0.763928
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  38 loss training:  9.995496748480946 Time :  7038
accuracy train: 0.999531 val: 0.778873 test: 0.761677
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  39 loss training:  10.92812936543487 Time :  7049
accuracy train: 0.999375 val: 0.780282 test: 0.766460
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  40 loss training:  9.022528261411935 Time :  7058
accuracy train: 0.999687 val: 0.767606 test: 0.758301
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  41 loss training:  8.046077432576567 Time :  7068
accuracy train: 1.000000 val: 0.771831 test: 0.760551
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  42 loss training:  8.308716079220176 Time :  7078
accuracy train: 0.999844 val: 0.769014 test: 0.761958
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  43 loss training:  7.206050900742412 Time :  7087
accuracy train: 0.999844 val: 0.759155 test: 0.759989
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  44 loss training:  7.814300660975277 Time :  7093
accuracy train: 0.999844 val: 0.778873 test: 0.764209
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  45 loss training:  7.365833099000156 Time :  7103
accuracy train: 1.000000 val: 0.752113 test: 0.755205
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  46 loss training:  6.92162999860011 Time :  7110
accuracy train: 0.999844 val: 0.763380 test: 0.764209
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  47 loss training:  6.691947678104043 Time :  7117
accuracy train: 1.000000 val: 0.764789 test: 0.760833
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  48 loss training:  6.217137994477525 Time :  7127
accuracy train: 0.999844 val: 0.763380 test: 0.761396
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  49 loss training:  6.030436777276918 Time :  7136
accuracy train: 0.999844 val: 0.759155 test: 0.765616
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  50 loss training:  5.753079857910052 Time :  7147
accuracy train: 1.000000 val: 0.771831 test: 0.770118
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  51 loss training:  5.030042172060348 Time :  7159
accuracy train: 0.999844 val: 0.756338 test: 0.759145
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

Epoch :  52 loss training:  4.499671437893994 Time :  7169
accuracy train: 1.000000 val: 0.767606 test: 0.758301
max validation accuracy : 0.784507 max acc epoch : 21 test accuracy : 0.778841

========================================================================================================================================================================================================
max acc epoch :  21
max validation accuracy :  0.7845070422535211
test accuracy :  0.7788407428249859
last test_accuracy :  0.7583005064715813
max gap 6
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.78873 	 test_accuracy : 0.76083 	 max_acc epoch :  132 	 last test_accuracy : 0.75914
k :  1 	 val_accuracy : 0.80141 	 test_accuracy : 0.76393 	 max_acc epoch :  82 	 last test_accuracy : 0.76308
k :  2 	 val_accuracy : 0.77746 	 test_accuracy : 0.77659 	 max_acc epoch :  22 	 last test_accuracy : 0.76646
k :  3 	 val_accuracy : 0.78732 	 test_accuracy : 0.77997 	 max_acc epoch :  20 	 last test_accuracy : 0.75999
k :  4 	 val_accuracy : 0.79296 	 test_accuracy : 0.76787 	 max_acc epoch :  22 	 last test_accuracy : 0.76280
k :  5 	 val_accuracy : 0.78592 	 test_accuracy : 0.76337 	 max_acc epoch :  38 	 last test_accuracy : 0.76477
k :  6 	 val_accuracy : 0.79155 	 test_accuracy : 0.75886 	 max_acc epoch :  49 	 last test_accuracy : 0.76027
k :  7 	 val_accuracy : 0.79859 	 test_accuracy : 0.76421 	 max_acc epoch :  76 	 last test_accuracy : 0.74705
k :  8 	 val_accuracy : 0.79437 	 test_accuracy : 0.76899 	 max_acc epoch :  34 	 last test_accuracy : 0.77209
k :  9 	 val_accuracy : 0.78451 	 test_accuracy : 0.77884 	 max_acc epoch :  21 	 last test_accuracy : 0.75830

avg :  	 val_accuracy : 0.79028 	 test_accuracy : 0.76835 	 last_accuracy : 0.76140
