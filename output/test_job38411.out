

date and time :  Mon Jul  5 00:43:25 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=357, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  96.65917924046516 Time :  10
accuracy train: 0.764145 val: 0.757746 test: 0.755487
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.755487
Epoch-1 lr: 0.001

Epoch :  2 loss training:  88.41377520561218 Time :  20
accuracy train: 0.777118 val: 0.752113 test: 0.760270
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.755487
Epoch-2 lr: 0.001

Epoch :  3 loss training:  86.24399621784687 Time :  30
accuracy train: 0.786496 val: 0.784507 test: 0.770962
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.770962
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  82.27895963191986 Time :  40
accuracy train: 0.800875 val: 0.774648 test: 0.760551
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.770962
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.29694494605064 Time :  50
accuracy train: 0.806189 val: 0.780282 test: 0.772088
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.770962
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.41819076240063 Time :  59
accuracy train: 0.795874 val: 0.769014 test: 0.759989
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.770962
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  78.29452049732208 Time :  70
accuracy train: 0.810566 val: 0.780282 test: 0.773213
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.770962
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  77.1928071975708 Time :  79
accuracy train: 0.810722 val: 0.778873 test: 0.772369
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.770962
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.9445249736309 Time :  89
accuracy train: 0.815724 val: 0.777465 test: 0.777153
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.770962
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.31977385282516 Time :  99
accuracy train: 0.813692 val: 0.792958 test: 0.775746
max validation accuracy : 0.792958 max acc epoch : 10 test accuracy : 0.775746

Epoch :  11 loss training:  74.63272404670715 Time :  109
accuracy train: 0.828228 val: 0.791549 test: 0.778559
max validation accuracy : 0.792958 max acc epoch : 10 test accuracy : 0.775746

Epoch :  12 loss training:  72.96892830729485 Time :  119
accuracy train: 0.835730 val: 0.785915 test: 0.778559
max validation accuracy : 0.792958 max acc epoch : 10 test accuracy : 0.775746

Epoch :  13 loss training:  72.29069776833057 Time :  130
accuracy train: 0.843701 val: 0.798592 test: 0.779966
max validation accuracy : 0.798592 max acc epoch : 13 test accuracy : 0.779966

Epoch :  14 loss training:  69.86731722950935 Time :  139
accuracy train: 0.850735 val: 0.795775 test: 0.778278
max validation accuracy : 0.798592 max acc epoch : 13 test accuracy : 0.779966

Epoch :  15 loss training:  67.48175643384457 Time :  149
accuracy train: 0.856518 val: 0.802817 test: 0.782499
max validation accuracy : 0.802817 max acc epoch : 15 test accuracy : 0.782499

Epoch :  16 loss training:  65.7880344837904 Time :  159
accuracy train: 0.866677 val: 0.795775 test: 0.779403
max validation accuracy : 0.802817 max acc epoch : 15 test accuracy : 0.782499

Epoch :  17 loss training:  64.8769911378622 Time :  168
accuracy train: 0.876680 val: 0.792958 test: 0.779403
max validation accuracy : 0.802817 max acc epoch : 15 test accuracy : 0.782499

Epoch :  18 loss training:  62.99147590994835 Time :  175
accuracy train: 0.880744 val: 0.802817 test: 0.783905
max validation accuracy : 0.802817 max acc epoch : 15 test accuracy : 0.782499

Epoch :  19 loss training:  60.18347090482712 Time :  181
accuracy train: 0.889028 val: 0.802817 test: 0.782499
max validation accuracy : 0.802817 max acc epoch : 15 test accuracy : 0.782499

Epoch :  20 loss training:  59.432437747716904 Time :  189
accuracy train: 0.895749 val: 0.800000 test: 0.782499
max validation accuracy : 0.802817 max acc epoch : 15 test accuracy : 0.782499

Epoch :  21 loss training:  56.299702271819115 Time :  199
accuracy train: 0.903407 val: 0.792958 test: 0.785875
max validation accuracy : 0.802817 max acc epoch : 15 test accuracy : 0.782499

Epoch :  22 loss training:  55.71671284735203 Time :  210
accuracy train: 0.906064 val: 0.805634 test: 0.782499
max validation accuracy : 0.805634 max acc epoch : 22 test accuracy : 0.782499

Epoch :  23 loss training:  54.284260138869286 Time :  220
accuracy train: 0.915286 val: 0.802817 test: 0.785875
max validation accuracy : 0.805634 max acc epoch : 22 test accuracy : 0.782499

Epoch :  24 loss training:  50.445434510707855 Time :  229
accuracy train: 0.919819 val: 0.802817 test: 0.785594
max validation accuracy : 0.805634 max acc epoch : 22 test accuracy : 0.782499

Epoch :  25 loss training:  49.35512958467007 Time :  238
accuracy train: 0.925602 val: 0.805634 test: 0.783343
max validation accuracy : 0.805634 max acc epoch : 22 test accuracy : 0.782499

Epoch :  26 loss training:  46.21844160556793 Time :  247
accuracy train: 0.931385 val: 0.794366 test: 0.783905
max validation accuracy : 0.805634 max acc epoch : 22 test accuracy : 0.782499

Epoch :  27 loss training:  46.44448798894882 Time :  258
accuracy train: 0.937949 val: 0.797183 test: 0.783061
max validation accuracy : 0.805634 max acc epoch : 22 test accuracy : 0.782499

Epoch :  28 loss training:  45.45855841040611 Time :  267
accuracy train: 0.941075 val: 0.801408 test: 0.784187
max validation accuracy : 0.805634 max acc epoch : 22 test accuracy : 0.782499

Epoch :  29 loss training:  42.91513052582741 Time :  278
accuracy train: 0.948890 val: 0.784507 test: 0.783905
max validation accuracy : 0.805634 max acc epoch : 22 test accuracy : 0.782499

Epoch :  30 loss training:  41.55036532133818 Time :  288
accuracy train: 0.952798 val: 0.794366 test: 0.781373
max validation accuracy : 0.805634 max acc epoch : 22 test accuracy : 0.782499

Epoch :  31 loss training:  40.0382569655776 Time :  299
accuracy train: 0.954986 val: 0.795775 test: 0.780810
max validation accuracy : 0.805634 max acc epoch : 22 test accuracy : 0.782499

Epoch :  32 loss training:  39.127518609166145 Time :  309
accuracy train: 0.959675 val: 0.785915 test: 0.780810
max validation accuracy : 0.805634 max acc epoch : 22 test accuracy : 0.782499

Epoch :  33 loss training:  37.3985795378685 Time :  320
accuracy train: 0.964833 val: 0.797183 test: 0.779122
max validation accuracy : 0.805634 max acc epoch : 22 test accuracy : 0.782499

========================================================================================================================================================================================================
best acc epoch :  22
validation accuracy :  0.8056338028169014
test accuracy :  0.7824985931344963
last test_accuracy :  0.7791221159257175
second best val :  0.8028169014084507
second best test :  0.7824985931344963
max gap 7
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=906, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  95.36705777049065 Time :  332
accuracy train: 0.774461 val: 0.742254 test: 0.761958
max validation accuracy : 0.742254 max acc epoch : 1 test accuracy : 0.761958
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.13812032341957 Time :  341
accuracy train: 0.785245 val: 0.753521 test: 0.770681
max validation accuracy : 0.753521 max acc epoch : 2 test accuracy : 0.770681
Epoch-2 lr: 0.001

Epoch :  3 loss training:  85.51019182801247 Time :  352
accuracy train: 0.780400 val: 0.739437 test: 0.766460
max validation accuracy : 0.753521 max acc epoch : 2 test accuracy : 0.770681
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.11463326215744 Time :  360
accuracy train: 0.802282 val: 0.759155 test: 0.779122
max validation accuracy : 0.759155 max acc epoch : 4 test accuracy : 0.779122
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.59655484557152 Time :  370
accuracy train: 0.805408 val: 0.776056 test: 0.779403
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779403
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  78.2549698650837 Time :  378
accuracy train: 0.804314 val: 0.756338 test: 0.785312
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779403
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.42333954572678 Time :  389
accuracy train: 0.808378 val: 0.757746 test: 0.783905
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779403
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.18169990181923 Time :  399
accuracy train: 0.816193 val: 0.767606 test: 0.786438
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779403
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  75.84564036130905 Time :  409
accuracy train: 0.813848 val: 0.760563 test: 0.781092
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779403
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  74.49488718807697 Time :  419
accuracy train: 0.825102 val: 0.764789 test: 0.783905
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779403

Epoch :  11 loss training:  73.94486238062382 Time :  429
accuracy train: 0.830572 val: 0.756338 test: 0.782217
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779403

Epoch :  12 loss training:  73.04323296248913 Time :  440
accuracy train: 0.835261 val: 0.761972 test: 0.782217
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779403

Epoch :  13 loss training:  71.08720399439335 Time :  450
accuracy train: 0.849328 val: 0.776056 test: 0.779966
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779403

Epoch :  14 loss training:  68.40329210460186 Time :  460
accuracy train: 0.857924 val: 0.783099 test: 0.777715
max validation accuracy : 0.783099 max acc epoch : 14 test accuracy : 0.777715

Epoch :  15 loss training:  66.23224884271622 Time :  468
accuracy train: 0.866677 val: 0.784507 test: 0.780529
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.780529

Epoch :  16 loss training:  64.83765955269337 Time :  477
accuracy train: 0.874492 val: 0.769014 test: 0.783905
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.780529

Epoch :  17 loss training:  62.79456117749214 Time :  492
accuracy train: 0.885589 val: 0.777465 test: 0.783061
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.780529

Epoch :  18 loss training:  60.65929073095322 Time :  501
accuracy train: 0.890591 val: 0.778873 test: 0.785031
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.780529

Epoch :  19 loss training:  59.60977843403816 Time :  511
accuracy train: 0.894498 val: 0.776056 test: 0.787001
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.780529

Epoch :  20 loss training:  57.56495091319084 Time :  521
accuracy train: 0.904189 val: 0.778873 test: 0.785594
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.780529

Epoch :  21 loss training:  56.11760205030441 Time :  531
accuracy train: 0.910284 val: 0.785915 test: 0.786719
max validation accuracy : 0.785915 max acc epoch : 21 test accuracy : 0.786719

Epoch :  22 loss training:  52.960735470056534 Time :  541
accuracy train: 0.914036 val: 0.774648 test: 0.782780
max validation accuracy : 0.785915 max acc epoch : 21 test accuracy : 0.786719

Epoch :  23 loss training:  51.829821318387985 Time :  550
accuracy train: 0.922632 val: 0.783099 test: 0.784468
max validation accuracy : 0.785915 max acc epoch : 21 test accuracy : 0.786719

Epoch :  24 loss training:  50.12634238600731 Time :  559
accuracy train: 0.926071 val: 0.787324 test: 0.789252
max validation accuracy : 0.787324 max acc epoch : 24 test accuracy : 0.789252

Epoch :  25 loss training:  47.695612005889416 Time :  569
accuracy train: 0.936074 val: 0.776056 test: 0.781373
max validation accuracy : 0.787324 max acc epoch : 24 test accuracy : 0.789252

Epoch :  26 loss training:  47.290102899074554 Time :  580
accuracy train: 0.942795 val: 0.785915 test: 0.779966
max validation accuracy : 0.787324 max acc epoch : 24 test accuracy : 0.789252

Epoch :  27 loss training:  46.21946171671152 Time :  591
accuracy train: 0.944827 val: 0.780282 test: 0.785594
max validation accuracy : 0.787324 max acc epoch : 24 test accuracy : 0.789252

Epoch :  28 loss training:  43.792649269104004 Time :  600
accuracy train: 0.953267 val: 0.770423 test: 0.780529
max validation accuracy : 0.787324 max acc epoch : 24 test accuracy : 0.789252

Epoch :  29 loss training:  42.09839844703674 Time :  610
accuracy train: 0.959206 val: 0.773239 test: 0.781373
max validation accuracy : 0.787324 max acc epoch : 24 test accuracy : 0.789252

Epoch :  30 loss training:  42.17924051731825 Time :  620
accuracy train: 0.959362 val: 0.770423 test: 0.783343
max validation accuracy : 0.787324 max acc epoch : 24 test accuracy : 0.789252

Epoch :  31 loss training:  38.61117210239172 Time :  629
accuracy train: 0.964833 val: 0.769014 test: 0.777153
max validation accuracy : 0.787324 max acc epoch : 24 test accuracy : 0.789252

Epoch :  32 loss training:  36.60671040415764 Time :  639
accuracy train: 0.967177 val: 0.759155 test: 0.776871
max validation accuracy : 0.787324 max acc epoch : 24 test accuracy : 0.789252

Epoch :  33 loss training:  35.78687746822834 Time :  648
accuracy train: 0.969522 val: 0.771831 test: 0.777715
max validation accuracy : 0.787324 max acc epoch : 24 test accuracy : 0.789252

Epoch :  34 loss training:  33.838971979916096 Time :  658
accuracy train: 0.972804 val: 0.773239 test: 0.774620
max validation accuracy : 0.787324 max acc epoch : 24 test accuracy : 0.789252

Epoch :  35 loss training:  33.69573763757944 Time :  666
accuracy train: 0.973585 val: 0.774648 test: 0.776027
max validation accuracy : 0.787324 max acc epoch : 24 test accuracy : 0.789252

========================================================================================================================================================================================================
best acc epoch :  24
validation accuracy :  0.7873239436619718
test accuracy :  0.7892515475520541
last test_accuracy :  0.7760270118176702
second best val :  0.7859154929577464
second best test :  0.7867191896454699
max gap 9
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=620, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  95.27498033642769 Time :  679
accuracy train: 0.764301 val: 0.773239 test: 0.759426
max validation accuracy : 0.773239 max acc epoch : 1 test accuracy : 0.759426
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.86396566033363 Time :  688
accuracy train: 0.776649 val: 0.780282 test: 0.763928
max validation accuracy : 0.780282 max acc epoch : 2 test accuracy : 0.763928
Epoch-2 lr: 0.001

Epoch :  3 loss training:  86.28110945224762 Time :  697
accuracy train: 0.784776 val: 0.787324 test: 0.773213
max validation accuracy : 0.787324 max acc epoch : 3 test accuracy : 0.773213
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  80.66500778496265 Time :  708
accuracy train: 0.796968 val: 0.785915 test: 0.778559
max validation accuracy : 0.787324 max acc epoch : 3 test accuracy : 0.773213
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  81.56667220592499 Time :  717
accuracy train: 0.797593 val: 0.800000 test: 0.773495
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.773495
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.39591228961945 Time :  727
accuracy train: 0.801344 val: 0.785915 test: 0.783061
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.773495
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.81505644321442 Time :  737
accuracy train: 0.810253 val: 0.794366 test: 0.779122
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.773495
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  77.89086565375328 Time :  747
accuracy train: 0.809628 val: 0.794366 test: 0.776871
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.773495
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  77.13475167751312 Time :  757
accuracy train: 0.812598 val: 0.781690 test: 0.771525
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.773495
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.4051773250103 Time :  768
accuracy train: 0.818381 val: 0.787324 test: 0.774339
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.773495

Epoch :  11 loss training:  75.16298970580101 Time :  778
accuracy train: 0.819319 val: 0.797183 test: 0.777434
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.773495

Epoch :  12 loss training:  73.79131197929382 Time :  787
accuracy train: 0.830572 val: 0.792958 test: 0.784187
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.773495

Epoch :  13 loss training:  72.74516332149506 Time :  796
accuracy train: 0.838074 val: 0.794366 test: 0.782499
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.773495

Epoch :  14 loss training:  69.2602521777153 Time :  802
accuracy train: 0.846983 val: 0.800000 test: 0.783905
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.773495

Epoch :  15 loss training:  68.22545300424099 Time :  809
accuracy train: 0.850422 val: 0.798592 test: 0.783061
max validation accuracy : 0.800000 max acc epoch : 5 test accuracy : 0.773495

Epoch :  16 loss training:  66.62077468633652 Time :  817
accuracy train: 0.862457 val: 0.801408 test: 0.784187
max validation accuracy : 0.801408 max acc epoch : 16 test accuracy : 0.784187

Epoch :  17 loss training:  63.40481823682785 Time :  826
accuracy train: 0.871053 val: 0.802817 test: 0.782217
max validation accuracy : 0.802817 max acc epoch : 17 test accuracy : 0.782217

Epoch :  18 loss training:  62.98940256237984 Time :  836
accuracy train: 0.879806 val: 0.807042 test: 0.787282
max validation accuracy : 0.807042 max acc epoch : 18 test accuracy : 0.787282

Epoch :  19 loss training:  61.36695210635662 Time :  846
accuracy train: 0.889028 val: 0.807042 test: 0.787845
max validation accuracy : 0.807042 max acc epoch : 18 test accuracy : 0.787282

Epoch :  20 loss training:  58.199272483587265 Time :  856
accuracy train: 0.894342 val: 0.804225 test: 0.782217
max validation accuracy : 0.807042 max acc epoch : 18 test accuracy : 0.787282

Epoch :  21 loss training:  56.8452230989933 Time :  867
accuracy train: 0.901532 val: 0.812676 test: 0.784468
max validation accuracy : 0.812676 max acc epoch : 21 test accuracy : 0.784468

Epoch :  22 loss training:  55.65620402991772 Time :  876
accuracy train: 0.909190 val: 0.812676 test: 0.784750
max validation accuracy : 0.812676 max acc epoch : 21 test accuracy : 0.784468

Epoch :  23 loss training:  54.122877575457096 Time :  887
accuracy train: 0.914036 val: 0.811268 test: 0.786719
max validation accuracy : 0.812676 max acc epoch : 21 test accuracy : 0.784468

Epoch :  24 loss training:  51.183974891901016 Time :  897
accuracy train: 0.920600 val: 0.808451 test: 0.784468
max validation accuracy : 0.812676 max acc epoch : 21 test accuracy : 0.784468

Epoch :  25 loss training:  50.99210254102945 Time :  907
accuracy train: 0.924195 val: 0.814085 test: 0.788126
max validation accuracy : 0.814085 max acc epoch : 25 test accuracy : 0.788126

Epoch :  26 loss training:  48.329729959368706 Time :  916
accuracy train: 0.933104 val: 0.814085 test: 0.782499
max validation accuracy : 0.814085 max acc epoch : 25 test accuracy : 0.788126

Epoch :  27 loss training:  46.060363814234734 Time :  925
accuracy train: 0.938731 val: 0.812676 test: 0.782217
max validation accuracy : 0.814085 max acc epoch : 25 test accuracy : 0.788126

Epoch :  28 loss training:  44.360280722379684 Time :  936
accuracy train: 0.942013 val: 0.807042 test: 0.784750
max validation accuracy : 0.814085 max acc epoch : 25 test accuracy : 0.788126

Epoch :  29 loss training:  43.20844957977533 Time :  946
accuracy train: 0.949828 val: 0.811268 test: 0.780810
max validation accuracy : 0.814085 max acc epoch : 25 test accuracy : 0.788126

Epoch :  30 loss training:  41.21342397481203 Time :  957
accuracy train: 0.956549 val: 0.808451 test: 0.782780
max validation accuracy : 0.814085 max acc epoch : 25 test accuracy : 0.788126

Epoch :  31 loss training:  41.1248065084219 Time :  967
accuracy train: 0.957330 val: 0.814085 test: 0.778841
max validation accuracy : 0.814085 max acc epoch : 25 test accuracy : 0.788126

Epoch :  32 loss training:  39.35643418505788 Time :  977
accuracy train: 0.963739 val: 0.804225 test: 0.781654
max validation accuracy : 0.814085 max acc epoch : 25 test accuracy : 0.788126

Epoch :  33 loss training:  37.0660190731287 Time :  986
accuracy train: 0.967646 val: 0.800000 test: 0.781936
max validation accuracy : 0.814085 max acc epoch : 25 test accuracy : 0.788126

Epoch :  34 loss training:  35.32105944305658 Time :  996
accuracy train: 0.972335 val: 0.804225 test: 0.779966
max validation accuracy : 0.814085 max acc epoch : 25 test accuracy : 0.788126

Epoch :  35 loss training:  33.78401447087526 Time :  1007
accuracy train: 0.968584 val: 0.805634 test: 0.781092
max validation accuracy : 0.814085 max acc epoch : 25 test accuracy : 0.788126

Epoch :  36 loss training:  33.88531846553087 Time :  1016
accuracy train: 0.974211 val: 0.812676 test: 0.781654
max validation accuracy : 0.814085 max acc epoch : 25 test accuracy : 0.788126

========================================================================================================================================================================================================
best acc epoch :  25
validation accuracy :  0.8140845070422535
test accuracy :  0.7881260551491277
last test_accuracy :  0.7816544738323016
second best val :  0.8126760563380282
second best test :  0.7844682048396173
max gap 11
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=263, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  98.50625362992287 Time :  1027
accuracy train: 0.774617 val: 0.752113 test: 0.761114
max validation accuracy : 0.752113 max acc epoch : 1 test accuracy : 0.761114
Epoch-1 lr: 0.001

Epoch :  2 loss training:  90.35315018892288 Time :  1038
accuracy train: 0.784151 val: 0.776056 test: 0.768430
max validation accuracy : 0.776056 max acc epoch : 2 test accuracy : 0.768430
Epoch-2 lr: 0.001

Epoch :  3 loss training:  85.89225679636002 Time :  1049
accuracy train: 0.795717 val: 0.753521 test: 0.767867
max validation accuracy : 0.776056 max acc epoch : 2 test accuracy : 0.768430
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.97047945857048 Time :  1059
accuracy train: 0.797906 val: 0.770423 test: 0.782499
max validation accuracy : 0.776056 max acc epoch : 2 test accuracy : 0.768430
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.86214199662209 Time :  1067
accuracy train: 0.799000 val: 0.773239 test: 0.781654
max validation accuracy : 0.776056 max acc epoch : 2 test accuracy : 0.768430
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.72829665243626 Time :  1077
accuracy train: 0.810410 val: 0.771831 test: 0.772651
max validation accuracy : 0.776056 max acc epoch : 2 test accuracy : 0.768430
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.30461931228638 Time :  1087
accuracy train: 0.811035 val: 0.766197 test: 0.779966
max validation accuracy : 0.776056 max acc epoch : 2 test accuracy : 0.768430
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.74345800280571 Time :  1096
accuracy train: 0.807127 val: 0.774648 test: 0.777715
max validation accuracy : 0.776056 max acc epoch : 2 test accuracy : 0.768430
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  77.9202615916729 Time :  1106
accuracy train: 0.824945 val: 0.766197 test: 0.780529
max validation accuracy : 0.776056 max acc epoch : 2 test accuracy : 0.768430
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.03633308410645 Time :  1115
accuracy train: 0.823226 val: 0.760563 test: 0.781092
max validation accuracy : 0.776056 max acc epoch : 2 test accuracy : 0.768430

Epoch :  11 loss training:  74.35967621207237 Time :  1126
accuracy train: 0.832760 val: 0.770423 test: 0.780529
max validation accuracy : 0.776056 max acc epoch : 2 test accuracy : 0.768430

Epoch :  12 loss training:  73.36688914895058 Time :  1137
accuracy train: 0.838543 val: 0.767606 test: 0.782499
max validation accuracy : 0.776056 max acc epoch : 2 test accuracy : 0.768430

Epoch :  13 loss training:  71.25322405993938 Time :  1148
accuracy train: 0.846827 val: 0.771831 test: 0.781092
max validation accuracy : 0.776056 max acc epoch : 2 test accuracy : 0.768430

========================================================================================================================================================================================================
best acc epoch :  2
validation accuracy :  0.776056338028169
test accuracy :  0.7684299380979178
last test_accuracy :  0.7810917276308385
second best val :  0.7746478873239436
second best test :  0.7684299380979178
max gap 1
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  22 	 val_accuracy : 0.80563 	 test_accuracy : 0.78250 	 last test_accuracy : 0.77912 	 second best val : 0.80282 	 second best test : 0.78250
k :  1 	 best_acc epoch :  24 	 val_accuracy : 0.78732 	 test_accuracy : 0.78925 	 last test_accuracy : 0.77603 	 second best val : 0.78592 	 second best test : 0.78672
k :  2 	 best_acc epoch :  25 	 val_accuracy : 0.81408 	 test_accuracy : 0.78813 	 last test_accuracy : 0.78165 	 second best val : 0.81268 	 second best test : 0.78447
k :  3 	 best_acc epoch :  2 	 val_accuracy : 0.77606 	 test_accuracy : 0.76843 	 last test_accuracy : 0.78109 	 second best val : 0.77465 	 second best test : 0.76843

avg :  	 val_accuracy : 0.79577 	 test_accuracy : 0.78208 	 last_accuracy : 0.77947 	 second best val : 0.79401 	 second best test : 0.78053

std :  	 val_accuracy : 0.01494 	 test_accuracy : 0.00828 	 last_accuracy : 0.00220 	 second best val : 0.01472 	 second best test : 0.00714


date and time :  Mon Jul  5 01:02:42 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=252, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  95.15583625435829 Time :  11
accuracy train: 0.758206 val: 0.746479 test: 0.756612
max validation accuracy : 0.746479 max acc epoch : 1 test accuracy : 0.756612
Epoch-1 lr: 0.001

Epoch :  2 loss training:  89.76254233717918 Time :  21
accuracy train: 0.774773 val: 0.754930 test: 0.753517
max validation accuracy : 0.754930 max acc epoch : 2 test accuracy : 0.753517
Epoch-2 lr: 0.001

Epoch :  3 loss training:  83.26106545329094 Time :  32
accuracy train: 0.777430 val: 0.750704 test: 0.766742
max validation accuracy : 0.754930 max acc epoch : 2 test accuracy : 0.753517
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.11535248160362 Time :  42
accuracy train: 0.799000 val: 0.769014 test: 0.771806
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.771806
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.06417828798294 Time :  51
accuracy train: 0.799625 val: 0.766197 test: 0.774902
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.771806
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  78.95884397625923 Time :  62
accuracy train: 0.802595 val: 0.757746 test: 0.773213
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.771806
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  79.30392894148827 Time :  73
accuracy train: 0.807440 val: 0.764789 test: 0.776027
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.771806
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  77.53344404697418 Time :  83
accuracy train: 0.804001 val: 0.764789 test: 0.769274
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.771806
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.72782707214355 Time :  92
accuracy train: 0.812910 val: 0.767606 test: 0.771525
max validation accuracy : 0.769014 max acc epoch : 4 test accuracy : 0.771806
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.88795393705368 Time :  102
accuracy train: 0.815255 val: 0.774648 test: 0.772932
max validation accuracy : 0.774648 max acc epoch : 10 test accuracy : 0.772932

Epoch :  11 loss training:  75.3045240342617 Time :  112
accuracy train: 0.825414 val: 0.780282 test: 0.774620
max validation accuracy : 0.780282 max acc epoch : 11 test accuracy : 0.774620

Epoch :  12 loss training:  74.25272935628891 Time :  122
accuracy train: 0.832448 val: 0.781690 test: 0.773213
max validation accuracy : 0.781690 max acc epoch : 12 test accuracy : 0.773213

Epoch :  13 loss training:  71.17655186355114 Time :  133
accuracy train: 0.843545 val: 0.784507 test: 0.779403
max validation accuracy : 0.784507 max acc epoch : 13 test accuracy : 0.779403

Epoch :  14 loss training:  68.8747119307518 Time :  142
accuracy train: 0.846046 val: 0.787324 test: 0.776871
max validation accuracy : 0.787324 max acc epoch : 14 test accuracy : 0.776871

Epoch :  15 loss training:  68.35048878192902 Time :  153
accuracy train: 0.855580 val: 0.792958 test: 0.776027
max validation accuracy : 0.792958 max acc epoch : 15 test accuracy : 0.776027

Epoch :  16 loss training:  66.42549474537373 Time :  162
accuracy train: 0.866208 val: 0.784507 test: 0.782780
max validation accuracy : 0.792958 max acc epoch : 15 test accuracy : 0.776027

Epoch :  17 loss training:  63.72764639556408 Time :  175
accuracy train: 0.868240 val: 0.795775 test: 0.781654
max validation accuracy : 0.795775 max acc epoch : 17 test accuracy : 0.781654

Epoch :  18 loss training:  62.24283282458782 Time :  186
accuracy train: 0.880119 val: 0.787324 test: 0.782217
max validation accuracy : 0.795775 max acc epoch : 17 test accuracy : 0.781654

Epoch :  19 loss training:  60.490184634923935 Time :  193
accuracy train: 0.886527 val: 0.788732 test: 0.781092
max validation accuracy : 0.795775 max acc epoch : 17 test accuracy : 0.781654

Epoch :  20 loss training:  58.07717280089855 Time :  204
accuracy train: 0.897155 val: 0.790141 test: 0.783905
max validation accuracy : 0.795775 max acc epoch : 17 test accuracy : 0.781654

Epoch :  21 loss training:  56.69164428114891 Time :  214
accuracy train: 0.901219 val: 0.790141 test: 0.785594
max validation accuracy : 0.795775 max acc epoch : 17 test accuracy : 0.781654

Epoch :  22 loss training:  55.28592789173126 Time :  225
accuracy train: 0.911847 val: 0.794366 test: 0.786719
max validation accuracy : 0.795775 max acc epoch : 17 test accuracy : 0.781654

Epoch :  23 loss training:  53.019458048045635 Time :  235
accuracy train: 0.916693 val: 0.800000 test: 0.781936
max validation accuracy : 0.800000 max acc epoch : 23 test accuracy : 0.781936

Epoch :  24 loss training:  51.9520730227232 Time :  246
accuracy train: 0.921694 val: 0.801408 test: 0.783343
max validation accuracy : 0.801408 max acc epoch : 24 test accuracy : 0.783343

Epoch :  25 loss training:  48.68399953097105 Time :  257
accuracy train: 0.929509 val: 0.790141 test: 0.782499
max validation accuracy : 0.801408 max acc epoch : 24 test accuracy : 0.783343

Epoch :  26 loss training:  47.386759132146835 Time :  267
accuracy train: 0.933104 val: 0.801408 test: 0.783061
max validation accuracy : 0.801408 max acc epoch : 24 test accuracy : 0.783343

Epoch :  27 loss training:  45.566230446100235 Time :  279
accuracy train: 0.937637 val: 0.790141 test: 0.787282
max validation accuracy : 0.801408 max acc epoch : 24 test accuracy : 0.783343

Epoch :  28 loss training:  43.838397569954395 Time :  290
accuracy train: 0.941388 val: 0.794366 test: 0.782217
max validation accuracy : 0.801408 max acc epoch : 24 test accuracy : 0.783343

Epoch :  29 loss training:  41.88112460076809 Time :  301
accuracy train: 0.947327 val: 0.795775 test: 0.780810
max validation accuracy : 0.801408 max acc epoch : 24 test accuracy : 0.783343

Epoch :  30 loss training:  39.99453482031822 Time :  312
accuracy train: 0.950766 val: 0.788732 test: 0.783624
max validation accuracy : 0.801408 max acc epoch : 24 test accuracy : 0.783343

Epoch :  31 loss training:  39.88948988169432 Time :  323
accuracy train: 0.953110 val: 0.794366 test: 0.787001
max validation accuracy : 0.801408 max acc epoch : 24 test accuracy : 0.783343

Epoch :  32 loss training:  38.31643069535494 Time :  333
accuracy train: 0.960925 val: 0.784507 test: 0.783343
max validation accuracy : 0.801408 max acc epoch : 24 test accuracy : 0.783343

Epoch :  33 loss training:  36.37686950713396 Time :  343
accuracy train: 0.964833 val: 0.794366 test: 0.778559
max validation accuracy : 0.801408 max acc epoch : 24 test accuracy : 0.783343

Epoch :  34 loss training:  35.52568819373846 Time :  353
accuracy train: 0.964520 val: 0.800000 test: 0.785031
max validation accuracy : 0.801408 max acc epoch : 24 test accuracy : 0.783343

Epoch :  35 loss training:  31.864768218249083 Time :  362
accuracy train: 0.968897 val: 0.797183 test: 0.784187
max validation accuracy : 0.801408 max acc epoch : 24 test accuracy : 0.783343

========================================================================================================================================================================================================
best acc epoch :  24
validation accuracy :  0.8014084507042254
test accuracy :  0.7833427124366911
last test_accuracy :  0.7841868317388858
second best val :  0.8
second best test :  0.7819358469330332
max gap 6
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=840, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  96.73824381828308 Time :  373
accuracy train: 0.772273 val: 0.783099 test: 0.764209
max validation accuracy : 0.783099 max acc epoch : 1 test accuracy : 0.764209
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.90904182195663 Time :  385
accuracy train: 0.789778 val: 0.773239 test: 0.770400
max validation accuracy : 0.783099 max acc epoch : 1 test accuracy : 0.764209
Epoch-2 lr: 0.001

Epoch :  3 loss training:  86.33620989322662 Time :  394
accuracy train: 0.788528 val: 0.783099 test: 0.771244
max validation accuracy : 0.783099 max acc epoch : 1 test accuracy : 0.764209
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.15236231684685 Time :  405
accuracy train: 0.776649 val: 0.745070 test: 0.766742
max validation accuracy : 0.783099 max acc epoch : 1 test accuracy : 0.764209
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  81.01535522937775 Time :  414
accuracy train: 0.800875 val: 0.784507 test: 0.775746
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.775746
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.38141471147537 Time :  425
accuracy train: 0.799000 val: 0.776056 test: 0.777715
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.775746
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.98215052485466 Time :  434
accuracy train: 0.808221 val: 0.780282 test: 0.777153
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.775746
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  77.04062649607658 Time :  444
accuracy train: 0.812129 val: 0.785915 test: 0.776027
max validation accuracy : 0.785915 max acc epoch : 8 test accuracy : 0.776027
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  77.3844871968031 Time :  455
accuracy train: 0.813692 val: 0.783099 test: 0.778278
max validation accuracy : 0.785915 max acc epoch : 8 test accuracy : 0.776027
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.5343431532383 Time :  464
accuracy train: 0.814161 val: 0.794366 test: 0.777153
max validation accuracy : 0.794366 max acc epoch : 10 test accuracy : 0.777153

Epoch :  11 loss training:  75.52048087120056 Time :  478
accuracy train: 0.813848 val: 0.795775 test: 0.777434
max validation accuracy : 0.795775 max acc epoch : 11 test accuracy : 0.777434

Epoch :  12 loss training:  72.90978762507439 Time :  488
accuracy train: 0.829947 val: 0.800000 test: 0.780248
max validation accuracy : 0.800000 max acc epoch : 12 test accuracy : 0.780248

Epoch :  13 loss training:  72.35549829900265 Time :  499
accuracy train: 0.838231 val: 0.792958 test: 0.778278
max validation accuracy : 0.800000 max acc epoch : 12 test accuracy : 0.780248

Epoch :  14 loss training:  69.72422648966312 Time :  509
accuracy train: 0.840888 val: 0.795775 test: 0.777153
max validation accuracy : 0.800000 max acc epoch : 12 test accuracy : 0.780248

Epoch :  15 loss training:  68.78088839352131 Time :  519
accuracy train: 0.846983 val: 0.797183 test: 0.783343
max validation accuracy : 0.800000 max acc epoch : 12 test accuracy : 0.780248

Epoch :  16 loss training:  65.97449503839016 Time :  529
accuracy train: 0.855580 val: 0.797183 test: 0.782499
max validation accuracy : 0.800000 max acc epoch : 12 test accuracy : 0.780248

Epoch :  17 loss training:  65.42329362034798 Time :  538
accuracy train: 0.865114 val: 0.800000 test: 0.785875
max validation accuracy : 0.800000 max acc epoch : 12 test accuracy : 0.780248

Epoch :  18 loss training:  62.79774309694767 Time :  549
accuracy train: 0.868084 val: 0.805634 test: 0.784468
max validation accuracy : 0.805634 max acc epoch : 18 test accuracy : 0.784468

Epoch :  19 loss training:  60.776954874396324 Time :  559
accuracy train: 0.878243 val: 0.795775 test: 0.787001
max validation accuracy : 0.805634 max acc epoch : 18 test accuracy : 0.784468

Epoch :  20 loss training:  60.289784625172615 Time :  570
accuracy train: 0.882932 val: 0.795775 test: 0.786438
max validation accuracy : 0.805634 max acc epoch : 18 test accuracy : 0.784468

Epoch :  21 loss training:  58.21095046401024 Time :  581
accuracy train: 0.894029 val: 0.800000 test: 0.789252
max validation accuracy : 0.805634 max acc epoch : 18 test accuracy : 0.784468

Epoch :  22 loss training:  57.00344717502594 Time :  592
accuracy train: 0.898562 val: 0.798592 test: 0.786719
max validation accuracy : 0.805634 max acc epoch : 18 test accuracy : 0.784468

Epoch :  23 loss training:  53.03849375247955 Time :  602
accuracy train: 0.907315 val: 0.800000 test: 0.789252
max validation accuracy : 0.805634 max acc epoch : 18 test accuracy : 0.784468

Epoch :  24 loss training:  50.113068759441376 Time :  611
accuracy train: 0.915442 val: 0.801408 test: 0.790377
max validation accuracy : 0.805634 max acc epoch : 18 test accuracy : 0.784468

Epoch :  25 loss training:  49.66228201985359 Time :  619
accuracy train: 0.918412 val: 0.802817 test: 0.794316
max validation accuracy : 0.805634 max acc epoch : 18 test accuracy : 0.784468

Epoch :  26 loss training:  47.506770588457584 Time :  626
accuracy train: 0.923570 val: 0.798592 test: 0.791503
max validation accuracy : 0.805634 max acc epoch : 18 test accuracy : 0.784468

Epoch :  27 loss training:  47.642845906317234 Time :  633
accuracy train: 0.931385 val: 0.792958 test: 0.791784
max validation accuracy : 0.805634 max acc epoch : 18 test accuracy : 0.784468

Epoch :  28 loss training:  45.73368211090565 Time :  642
accuracy train: 0.931229 val: 0.794366 test: 0.794035
max validation accuracy : 0.805634 max acc epoch : 18 test accuracy : 0.784468

Epoch :  29 loss training:  42.67600094527006 Time :  652
accuracy train: 0.937480 val: 0.808451 test: 0.790658
max validation accuracy : 0.808451 max acc epoch : 29 test accuracy : 0.790658

Epoch :  30 loss training:  41.54757882654667 Time :  663
accuracy train: 0.941388 val: 0.801408 test: 0.788407
max validation accuracy : 0.808451 max acc epoch : 29 test accuracy : 0.790658

Epoch :  31 loss training:  40.06154806911945 Time :  673
accuracy train: 0.948421 val: 0.792958 test: 0.788126
max validation accuracy : 0.808451 max acc epoch : 29 test accuracy : 0.790658

Epoch :  32 loss training:  38.50533838570118 Time :  685
accuracy train: 0.951547 val: 0.804225 test: 0.785875
max validation accuracy : 0.808451 max acc epoch : 29 test accuracy : 0.790658

Epoch :  33 loss training:  37.68292419612408 Time :  696
accuracy train: 0.957174 val: 0.802817 test: 0.788126
max validation accuracy : 0.808451 max acc epoch : 29 test accuracy : 0.790658

Epoch :  34 loss training:  35.80836255848408 Time :  706
accuracy train: 0.958893 val: 0.792958 test: 0.788970
max validation accuracy : 0.808451 max acc epoch : 29 test accuracy : 0.790658

Epoch :  35 loss training:  33.1722425557673 Time :  714
accuracy train: 0.962176 val: 0.794366 test: 0.790377
max validation accuracy : 0.808451 max acc epoch : 29 test accuracy : 0.790658

Epoch :  36 loss training:  34.00486782938242 Time :  724
accuracy train: 0.967959 val: 0.792958 test: 0.793191
max validation accuracy : 0.808451 max acc epoch : 29 test accuracy : 0.790658

Epoch :  37 loss training:  32.96568375080824 Time :  735
accuracy train: 0.969522 val: 0.792958 test: 0.788970
max validation accuracy : 0.808451 max acc epoch : 29 test accuracy : 0.790658

Epoch :  38 loss training:  29.947491493076086 Time :  745
accuracy train: 0.976555 val: 0.797183 test: 0.787845
max validation accuracy : 0.808451 max acc epoch : 29 test accuracy : 0.790658

Epoch :  39 loss training:  29.282338604331017 Time :  755
accuracy train: 0.976711 val: 0.805634 test: 0.786156
max validation accuracy : 0.808451 max acc epoch : 29 test accuracy : 0.790658

Epoch :  40 loss training:  27.771442998200655 Time :  766
accuracy train: 0.978118 val: 0.798592 test: 0.786438
max validation accuracy : 0.808451 max acc epoch : 29 test accuracy : 0.790658

========================================================================================================================================================================================================
best acc epoch :  29
validation accuracy :  0.8084507042253521
test accuracy :  0.7906584130557118
last test_accuracy :  0.7864378165447383
second best val :  0.8056338028169014
second best test :  0.7844682048396173
max gap 11
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=626, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  94.37822943925858 Time :  779
accuracy train: 0.769459 val: 0.769014 test: 0.761958
max validation accuracy : 0.769014 max acc epoch : 1 test accuracy : 0.761958
Epoch-1 lr: 0.001

Epoch :  2 loss training:  89.0291246175766 Time :  788
accuracy train: 0.758675 val: 0.730986 test: 0.739449
max validation accuracy : 0.769014 max acc epoch : 1 test accuracy : 0.761958
Epoch-2 lr: 0.001

Epoch :  3 loss training:  85.04212146997452 Time :  798
accuracy train: 0.783995 val: 0.771831 test: 0.761958
max validation accuracy : 0.771831 max acc epoch : 3 test accuracy : 0.761958
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  82.0213448703289 Time :  807
accuracy train: 0.788528 val: 0.778873 test: 0.770400
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.770400
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  81.79342421889305 Time :  816
accuracy train: 0.793998 val: 0.778873 test: 0.764772
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.770400
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.0936005115509 Time :  825
accuracy train: 0.798843 val: 0.778873 test: 0.775183
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.770400
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  78.96297109127045 Time :  835
accuracy train: 0.803063 val: 0.790141 test: 0.773213
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.773213
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  77.77635633945465 Time :  844
accuracy train: 0.806346 val: 0.778873 test: 0.772932
max validation accuracy : 0.790141 max acc epoch : 7 test accuracy : 0.773213
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  77.55802384018898 Time :  853
accuracy train: 0.805408 val: 0.791549 test: 0.774902
max validation accuracy : 0.791549 max acc epoch : 9 test accuracy : 0.774902
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  76.38425301015377 Time :  863
accuracy train: 0.810566 val: 0.784507 test: 0.774057
max validation accuracy : 0.791549 max acc epoch : 9 test accuracy : 0.774902

Epoch :  11 loss training:  75.5851863026619 Time :  873
accuracy train: 0.820100 val: 0.788732 test: 0.773213
max validation accuracy : 0.791549 max acc epoch : 9 test accuracy : 0.774902

Epoch :  12 loss training:  73.9043489843607 Time :  883
accuracy train: 0.824789 val: 0.791549 test: 0.777434
max validation accuracy : 0.791549 max acc epoch : 9 test accuracy : 0.774902

Epoch :  13 loss training:  71.14617118239403 Time :  892
accuracy train: 0.831979 val: 0.791549 test: 0.776027
max validation accuracy : 0.791549 max acc epoch : 9 test accuracy : 0.774902

Epoch :  14 loss training:  70.19853554666042 Time :  901
accuracy train: 0.838074 val: 0.795775 test: 0.779403
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.779403

Epoch :  15 loss training:  70.36440744996071 Time :  910
accuracy train: 0.850891 val: 0.785915 test: 0.776871
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.779403

Epoch :  16 loss training:  68.22653192281723 Time :  919
accuracy train: 0.857143 val: 0.792958 test: 0.775464
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.779403

Epoch :  17 loss training:  64.04430417716503 Time :  928
accuracy train: 0.868553 val: 0.778873 test: 0.776027
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.779403

Epoch :  18 loss training:  62.59747534990311 Time :  937
accuracy train: 0.874023 val: 0.791549 test: 0.783624
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.779403

Epoch :  19 loss training:  61.665898114442825 Time :  946
accuracy train: 0.887309 val: 0.783099 test: 0.783343
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.779403

Epoch :  20 loss training:  59.357643991708755 Time :  956
accuracy train: 0.891372 val: 0.785915 test: 0.778278
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.779403

Epoch :  21 loss training:  57.11445155739784 Time :  966
accuracy train: 0.905127 val: 0.783099 test: 0.778841
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.779403

Epoch :  22 loss training:  57.24619551002979 Time :  977
accuracy train: 0.908565 val: 0.785915 test: 0.780529
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.779403

Epoch :  23 loss training:  53.77540245652199 Time :  987
accuracy train: 0.914973 val: 0.787324 test: 0.777715
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.779403

Epoch :  24 loss training:  50.75856624543667 Time :  997
accuracy train: 0.917005 val: 0.784507 test: 0.781654
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.779403

Epoch :  25 loss training:  49.89583547413349 Time :  1006
accuracy train: 0.925445 val: 0.788732 test: 0.781373
max validation accuracy : 0.795775 max acc epoch : 14 test accuracy : 0.779403

========================================================================================================================================================================================================
best acc epoch :  14
validation accuracy :  0.795774647887324
test accuracy :  0.7794034890264491
last test_accuracy :  0.7813731007315701
second best val :  0.7929577464788733
second best test :  0.7794034890264491
max gap 5
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=333, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  96.68210944533348 Time :  1017
accuracy train: 0.772898 val: 0.769014 test: 0.761958
max validation accuracy : 0.769014 max acc epoch : 1 test accuracy : 0.761958
Epoch-1 lr: 0.001

Epoch :  2 loss training:  90.33414912223816 Time :  1026
accuracy train: 0.768365 val: 0.760563 test: 0.747608
max validation accuracy : 0.769014 max acc epoch : 1 test accuracy : 0.761958
Epoch-2 lr: 0.001

Epoch :  3 loss training:  84.39548881351948 Time :  1035
accuracy train: 0.787277 val: 0.770423 test: 0.770400
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.770400
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  80.69525071978569 Time :  1045
accuracy train: 0.799312 val: 0.766197 test: 0.774902
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.770400
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  79.11338722705841 Time :  1055
accuracy train: 0.803376 val: 0.760563 test: 0.773495
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.770400
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.70858657360077 Time :  1066
accuracy train: 0.806815 val: 0.764789 test: 0.776590
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.770400
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.61643368005753 Time :  1075
accuracy train: 0.809472 val: 0.773239 test: 0.779966
max validation accuracy : 0.773239 max acc epoch : 7 test accuracy : 0.779966
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.20426079630852 Time :  1084
accuracy train: 0.815724 val: 0.783099 test: 0.775183
max validation accuracy : 0.783099 max acc epoch : 8 test accuracy : 0.775183
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  77.20677945017815 Time :  1094
accuracy train: 0.816974 val: 0.770423 test: 0.780810
max validation accuracy : 0.783099 max acc epoch : 8 test accuracy : 0.775183
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.0700092613697 Time :  1103
accuracy train: 0.821038 val: 0.776056 test: 0.775183
max validation accuracy : 0.783099 max acc epoch : 8 test accuracy : 0.775183

Epoch :  11 loss training:  73.14303666353226 Time :  1112
accuracy train: 0.824320 val: 0.776056 test: 0.777715
max validation accuracy : 0.783099 max acc epoch : 8 test accuracy : 0.775183

Epoch :  12 loss training:  72.12567001581192 Time :  1121
accuracy train: 0.834167 val: 0.776056 test: 0.778841
max validation accuracy : 0.783099 max acc epoch : 8 test accuracy : 0.775183

Epoch :  13 loss training:  71.63263761997223 Time :  1130
accuracy train: 0.842451 val: 0.774648 test: 0.777434
max validation accuracy : 0.783099 max acc epoch : 8 test accuracy : 0.775183

Epoch :  14 loss training:  69.58003674447536 Time :  1138
accuracy train: 0.847921 val: 0.777465 test: 0.782217
max validation accuracy : 0.783099 max acc epoch : 8 test accuracy : 0.775183

Epoch :  15 loss training:  66.88453900814056 Time :  1147
accuracy train: 0.856361 val: 0.777465 test: 0.779403
max validation accuracy : 0.783099 max acc epoch : 8 test accuracy : 0.775183

Epoch :  16 loss training:  65.79423782229424 Time :  1160
accuracy train: 0.863395 val: 0.773239 test: 0.781373
max validation accuracy : 0.783099 max acc epoch : 8 test accuracy : 0.775183

Epoch :  17 loss training:  63.19941067695618 Time :  1170
accuracy train: 0.872773 val: 0.784507 test: 0.783624
max validation accuracy : 0.784507 max acc epoch : 17 test accuracy : 0.783624

Epoch :  18 loss training:  62.81180664896965 Time :  1179
accuracy train: 0.878868 val: 0.788732 test: 0.785312
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.785312

Epoch :  19 loss training:  59.85179603099823 Time :  1188
accuracy train: 0.882463 val: 0.788732 test: 0.784468
max validation accuracy : 0.788732 max acc epoch : 18 test accuracy : 0.785312

Epoch :  20 loss training:  58.33432471007109 Time :  1197
accuracy train: 0.893717 val: 0.790141 test: 0.784468
max validation accuracy : 0.790141 max acc epoch : 20 test accuracy : 0.784468

Epoch :  21 loss training:  56.081390023231506 Time :  1203
accuracy train: 0.899500 val: 0.792958 test: 0.785875
max validation accuracy : 0.792958 max acc epoch : 21 test accuracy : 0.785875

Epoch :  22 loss training:  55.15768760442734 Time :  1210
accuracy train: 0.903876 val: 0.797183 test: 0.787845
max validation accuracy : 0.797183 max acc epoch : 22 test accuracy : 0.787845

Epoch :  23 loss training:  53.13304451107979 Time :  1217
accuracy train: 0.911066 val: 0.784507 test: 0.785875
max validation accuracy : 0.797183 max acc epoch : 22 test accuracy : 0.787845

Epoch :  24 loss training:  51.28346127271652 Time :  1223
accuracy train: 0.920444 val: 0.787324 test: 0.787282
max validation accuracy : 0.797183 max acc epoch : 22 test accuracy : 0.787845

Epoch :  25 loss training:  48.12574069201946 Time :  1230
accuracy train: 0.927165 val: 0.784507 test: 0.787001
max validation accuracy : 0.797183 max acc epoch : 22 test accuracy : 0.787845

Epoch :  26 loss training:  48.01652470231056 Time :  1238
accuracy train: 0.933260 val: 0.781690 test: 0.787845
max validation accuracy : 0.797183 max acc epoch : 22 test accuracy : 0.787845

Epoch :  27 loss training:  46.328540205955505 Time :  1249
accuracy train: 0.941232 val: 0.787324 test: 0.786438
max validation accuracy : 0.797183 max acc epoch : 22 test accuracy : 0.787845

Epoch :  28 loss training:  42.926696725189686 Time :  1258
accuracy train: 0.942013 val: 0.788732 test: 0.790096
max validation accuracy : 0.797183 max acc epoch : 22 test accuracy : 0.787845

Epoch :  29 loss training:  40.70450808852911 Time :  1268
accuracy train: 0.952798 val: 0.784507 test: 0.787282
max validation accuracy : 0.797183 max acc epoch : 22 test accuracy : 0.787845

Epoch :  30 loss training:  39.405801355838776 Time :  1277
accuracy train: 0.954361 val: 0.787324 test: 0.787563
max validation accuracy : 0.797183 max acc epoch : 22 test accuracy : 0.787845

Epoch :  31 loss training:  38.5634942650795 Time :  1286
accuracy train: 0.957799 val: 0.784507 test: 0.789533
max validation accuracy : 0.797183 max acc epoch : 22 test accuracy : 0.787845

Epoch :  32 loss training:  38.279771350324154 Time :  1295
accuracy train: 0.963113 val: 0.791549 test: 0.788689
max validation accuracy : 0.797183 max acc epoch : 22 test accuracy : 0.787845

Epoch :  33 loss training:  36.359103210270405 Time :  1304
accuracy train: 0.966865 val: 0.783099 test: 0.788126
max validation accuracy : 0.797183 max acc epoch : 22 test accuracy : 0.787845

========================================================================================================================================================================================================
best acc epoch :  22
validation accuracy :  0.7971830985915493
test accuracy :  0.7878446820483962
last test_accuracy :  0.7881260551491277
second best val :  0.7929577464788733
second best test :  0.7858750703432752
max gap 9
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  24 	 val_accuracy : 0.80141 	 test_accuracy : 0.78334 	 last test_accuracy : 0.78419 	 second best val : 0.80000 	 second best test : 0.78194
k :  1 	 best_acc epoch :  29 	 val_accuracy : 0.80845 	 test_accuracy : 0.79066 	 last test_accuracy : 0.78644 	 second best val : 0.80563 	 second best test : 0.78447
k :  2 	 best_acc epoch :  14 	 val_accuracy : 0.79577 	 test_accuracy : 0.77940 	 last test_accuracy : 0.78137 	 second best val : 0.79296 	 second best test : 0.77940
k :  3 	 best_acc epoch :  22 	 val_accuracy : 0.79718 	 test_accuracy : 0.78784 	 last test_accuracy : 0.78813 	 second best val : 0.79296 	 second best test : 0.78588

avg :  	 val_accuracy : 0.80070 	 test_accuracy : 0.78531 	 last_accuracy : 0.78503 	 second best val : 0.79789 	 second best test : 0.78292

std :  	 val_accuracy : 0.00493 	 test_accuracy : 0.00429 	 last_accuracy : 0.00253 	 second best val : 0.00532 	 second best test : 0.00247


date and time :  Mon Jul  5 01:24:36 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=199, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0
Counter({0: 6237, 1: 4425})

Epoch :  1 loss training:  96.5419782102108 Time :  13
accuracy train: 0.767896 val: 0.747887 test: 0.760551
max validation accuracy : 0.747887 max acc epoch : 1 test accuracy : 0.760551
Counter({0: 6250, 1: 4412})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.40058901906013 Time :  27
accuracy train: 0.782432 val: 0.763380 test: 0.765616
max validation accuracy : 0.763380 max acc epoch : 2 test accuracy : 0.765616
Counter({0: 5844, 1: 4818})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  85.53861850500107 Time :  39
accuracy train: 0.789778 val: 0.769014 test: 0.776590
max validation accuracy : 0.769014 max acc epoch : 3 test accuracy : 0.776590
Counter({0: 5753, 1: 4909})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  80.38618651032448 Time :  52
accuracy train: 0.794936 val: 0.766197 test: 0.775464
max validation accuracy : 0.769014 max acc epoch : 3 test accuracy : 0.776590
Counter({1: 5898, 0: 4764})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  81.04128494858742 Time :  64
accuracy train: 0.789465 val: 0.769014 test: 0.773495
max validation accuracy : 0.769014 max acc epoch : 3 test accuracy : 0.776590
Counter({0: 5917, 1: 4745})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  78.93169727921486 Time :  76
accuracy train: 0.795561 val: 0.763380 test: 0.777434
max validation accuracy : 0.769014 max acc epoch : 3 test accuracy : 0.776590
Counter({1: 5850, 0: 4812})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.87162563204765 Time :  88
accuracy train: 0.806346 val: 0.771831 test: 0.777153
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777153
Counter({0: 5887, 1: 4775})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.64157593250275 Time :  101
accuracy train: 0.798531 val: 0.764789 test: 0.776590
max validation accuracy : 0.771831 max acc epoch : 7 test accuracy : 0.777153
Counter({1: 5927, 0: 4735})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  76.35815703868866 Time :  113
accuracy train: 0.806502 val: 0.780282 test: 0.777434
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.777434
Counter({1: 5962, 0: 4700})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.61372637748718 Time :  127
accuracy train: 0.809628 val: 0.773239 test: 0.783061
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.777434
Counter({1: 5957, 0: 4705})

Epoch :  11 loss training:  75.39212799072266 Time :  140
accuracy train: 0.815411 val: 0.780282 test: 0.780529
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.777434
Counter({0: 6004, 1: 4658})

Epoch :  12 loss training:  72.57969625294209 Time :  153
accuracy train: 0.825102 val: 0.767606 test: 0.781936
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.777434
Counter({1: 6076, 0: 4586})

Epoch :  13 loss training:  70.60328809916973 Time :  165
accuracy train: 0.835417 val: 0.770423 test: 0.779122
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.777434
Counter({0: 6073, 1: 4589})

Epoch :  14 loss training:  70.90703828632832 Time :  178
accuracy train: 0.850109 val: 0.761972 test: 0.783343
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.777434
Counter({1: 6095, 0: 4567})

Epoch :  15 loss training:  67.84039006382227 Time :  190
accuracy train: 0.849641 val: 0.774648 test: 0.783905
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.777434
Counter({1: 6077, 0: 4585})

Epoch :  16 loss training:  65.40566320717335 Time :  203
accuracy train: 0.860269 val: 0.767606 test: 0.782217
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.777434
Counter({1: 6111, 0: 4551})

Epoch :  17 loss training:  64.34445708990097 Time :  215
accuracy train: 0.867927 val: 0.771831 test: 0.781936
max validation accuracy : 0.780282 max acc epoch : 9 test accuracy : 0.777434
Counter({1: 6205, 0: 4457})

Epoch :  18 loss training:  60.921392530202866 Time :  228
accuracy train: 0.876993 val: 0.781690 test: 0.783624
max validation accuracy : 0.781690 max acc epoch : 18 test accuracy : 0.783624
Counter({1: 6120, 0: 4542})

Epoch :  19 loss training:  59.501101583242416 Time :  247
accuracy train: 0.880119 val: 0.780282 test: 0.782217
max validation accuracy : 0.781690 max acc epoch : 18 test accuracy : 0.783624
Counter({1: 6162, 0: 4500})

Epoch :  20 loss training:  59.40462180972099 Time :  260
accuracy train: 0.886683 val: 0.780282 test: 0.781654
max validation accuracy : 0.781690 max acc epoch : 18 test accuracy : 0.783624
Counter({1: 6163, 0: 4499})

Epoch :  21 loss training:  55.208993807435036 Time :  272
accuracy train: 0.897937 val: 0.778873 test: 0.784468
max validation accuracy : 0.781690 max acc epoch : 18 test accuracy : 0.783624
Counter({0: 6214, 1: 4448})

Epoch :  22 loss training:  53.613221392035484 Time :  285
accuracy train: 0.905908 val: 0.778873 test: 0.787563
max validation accuracy : 0.781690 max acc epoch : 18 test accuracy : 0.783624
Counter({1: 6268, 0: 4394})

Epoch :  23 loss training:  51.78261096775532 Time :  297
accuracy train: 0.908721 val: 0.780282 test: 0.786719
max validation accuracy : 0.781690 max acc epoch : 18 test accuracy : 0.783624
Counter({0: 6210, 1: 4452})

Epoch :  24 loss training:  49.76630939543247 Time :  310
accuracy train: 0.916068 val: 0.771831 test: 0.782217
max validation accuracy : 0.781690 max acc epoch : 18 test accuracy : 0.783624
Counter({0: 6232, 1: 4430})

Epoch :  25 loss training:  48.85405636578798 Time :  323
accuracy train: 0.923101 val: 0.780282 test: 0.785594
max validation accuracy : 0.781690 max acc epoch : 18 test accuracy : 0.783624
Counter({0: 6213, 1: 4449})

Epoch :  26 loss training:  47.313404612243176 Time :  336
accuracy train: 0.930134 val: 0.780282 test: 0.784468
max validation accuracy : 0.781690 max acc epoch : 18 test accuracy : 0.783624
Counter({0: 6248, 1: 4414})

Epoch :  27 loss training:  44.24691245704889 Time :  349
accuracy train: 0.936855 val: 0.774648 test: 0.786156
max validation accuracy : 0.781690 max acc epoch : 18 test accuracy : 0.783624
Counter({0: 6221, 1: 4441})

Epoch :  28 loss training:  43.030341766774654 Time :  362
accuracy train: 0.941075 val: 0.777465 test: 0.781654
max validation accuracy : 0.781690 max acc epoch : 18 test accuracy : 0.783624
Counter({1: 6213, 0: 4449})

Epoch :  29 loss training:  40.73860400170088 Time :  375
accuracy train: 0.947015 val: 0.783099 test: 0.785031
max validation accuracy : 0.783099 max acc epoch : 29 test accuracy : 0.785031
Counter({1: 6217, 0: 4445})

Epoch :  30 loss training:  38.81222427636385 Time :  388
accuracy train: 0.951704 val: 0.783099 test: 0.784468
max validation accuracy : 0.783099 max acc epoch : 29 test accuracy : 0.785031
Counter({0: 6187, 1: 4475})

Epoch :  31 loss training:  38.234927870333195 Time :  400
accuracy train: 0.954048 val: 0.783099 test: 0.785031
max validation accuracy : 0.783099 max acc epoch : 29 test accuracy : 0.785031
Counter({0: 6197, 1: 4465})

Epoch :  32 loss training:  36.253548949956894 Time :  413
accuracy train: 0.959831 val: 0.781690 test: 0.785031
max validation accuracy : 0.783099 max acc epoch : 29 test accuracy : 0.785031
Counter({0: 6156, 1: 4506})

Epoch :  33 loss training:  34.212966706603765 Time :  426
accuracy train: 0.963895 val: 0.785915 test: 0.781092
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.781092
Counter({1: 6141, 0: 4521})

Epoch :  34 loss training:  32.87816747650504 Time :  440
accuracy train: 0.966865 val: 0.774648 test: 0.785312
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.781092
Counter({1: 6130, 0: 4532})

Epoch :  35 loss training:  32.158775210380554 Time :  452
accuracy train: 0.969522 val: 0.774648 test: 0.779966
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.781092
Counter({1: 6149, 0: 4513})

Epoch :  36 loss training:  31.23082158714533 Time :  464
accuracy train: 0.972023 val: 0.774648 test: 0.777153
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.781092
Counter({1: 6132, 0: 4530})

Epoch :  37 loss training:  29.50001548230648 Time :  477
accuracy train: 0.976086 val: 0.777465 test: 0.780529
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.781092
Counter({0: 6131, 1: 4531})

Epoch :  38 loss training:  27.693267358466983 Time :  489
accuracy train: 0.977493 val: 0.776056 test: 0.775183
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.781092
Counter({1: 6137, 0: 4525})

Epoch :  39 loss training:  27.26302119344473 Time :  502
accuracy train: 0.979525 val: 0.769014 test: 0.775183
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.781092
Counter({1: 6120, 0: 4542})

Epoch :  40 loss training:  26.149859234690666 Time :  514
accuracy train: 0.980619 val: 0.783099 test: 0.777715
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.781092
Counter({1: 6125, 0: 4537})

Epoch :  41 loss training:  24.461113637313247 Time :  527
accuracy train: 0.982182 val: 0.778873 test: 0.774902
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.781092
Counter({1: 6079, 0: 4583})

Epoch :  42 loss training:  23.52628173865378 Time :  542
accuracy train: 0.984526 val: 0.778873 test: 0.773213
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.781092
Counter({1: 6056, 0: 4606})

Epoch :  43 loss training:  22.62731171026826 Time :  554
accuracy train: 0.986871 val: 0.777465 test: 0.771244
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.781092
Counter({1: 6035, 0: 4627})

Epoch :  44 loss training:  21.87089792639017 Time :  566
accuracy train: 0.989372 val: 0.780282 test: 0.771525
max validation accuracy : 0.785915 max acc epoch : 33 test accuracy : 0.781092
Counter({0: 6026, 1: 4636})

========================================================================================================================================================================================================
best acc epoch :  33
validation accuracy :  0.7859154929577464
test accuracy :  0.7810917276308385
last test_accuracy :  0.7715250422059651
second best val :  0.7830985915492957
second best test :  0.7850309510410804
max gap 11
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=114, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0
Counter({0: 6209, 1: 4453})

Epoch :  1 loss training:  97.60161185264587 Time :  581
accuracy train: 0.723820 val: 0.708451 test: 0.718346
max validation accuracy : 0.708451 max acc epoch : 1 test accuracy : 0.718346
Counter({0: 5418, 1: 5244})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  88.72047081589699 Time :  595
accuracy train: 0.776649 val: 0.756338 test: 0.765053
max validation accuracy : 0.756338 max acc epoch : 2 test accuracy : 0.765053
Counter({0: 5906, 1: 4756})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  84.98805624246597 Time :  607
accuracy train: 0.787590 val: 0.757746 test: 0.769837
max validation accuracy : 0.757746 max acc epoch : 3 test accuracy : 0.769837
Counter({1: 6004, 0: 4658})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.15147796273232 Time :  619
accuracy train: 0.780869 val: 0.752113 test: 0.771525
max validation accuracy : 0.757746 max acc epoch : 3 test accuracy : 0.769837
Counter({0: 6007, 1: 4655})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  79.8037219941616 Time :  632
accuracy train: 0.790560 val: 0.753521 test: 0.771525
max validation accuracy : 0.757746 max acc epoch : 3 test accuracy : 0.769837
Counter({0: 6084, 1: 4578})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.30618542432785 Time :  646
accuracy train: 0.790716 val: 0.752113 test: 0.770962
max validation accuracy : 0.757746 max acc epoch : 3 test accuracy : 0.769837
Counter({1: 6068, 0: 4594})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  79.08906009793282 Time :  659
accuracy train: 0.800094 val: 0.756338 test: 0.774057
max validation accuracy : 0.757746 max acc epoch : 3 test accuracy : 0.769837
Counter({0: 6086, 1: 4576})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.86508798599243 Time :  672
accuracy train: 0.802595 val: 0.761972 test: 0.770681
max validation accuracy : 0.761972 max acc epoch : 8 test accuracy : 0.770681
Counter({1: 6081, 0: 4581})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  75.05378156900406 Time :  681
accuracy train: 0.806346 val: 0.769014 test: 0.773776
max validation accuracy : 0.769014 max acc epoch : 9 test accuracy : 0.773776
Counter({1: 6088, 0: 4574})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.43487700819969 Time :  694
accuracy train: 0.808690 val: 0.774648 test: 0.777997
max validation accuracy : 0.774648 max acc epoch : 10 test accuracy : 0.777997
Counter({0: 6083, 1: 4579})

Epoch :  11 loss training:  74.30139584839344 Time :  706
accuracy train: 0.809159 val: 0.763380 test: 0.774057
max validation accuracy : 0.774648 max acc epoch : 10 test accuracy : 0.777997
Counter({1: 6118, 0: 4544})

Epoch :  12 loss training:  74.08205242455006 Time :  719
accuracy train: 0.816349 val: 0.767606 test: 0.772369
max validation accuracy : 0.774648 max acc epoch : 10 test accuracy : 0.777997
Counter({1: 6119, 0: 4543})

Epoch :  13 loss training:  72.58783739805222 Time :  731
accuracy train: 0.823070 val: 0.770423 test: 0.774057
max validation accuracy : 0.774648 max acc epoch : 10 test accuracy : 0.777997
Counter({0: 6114, 1: 4548})

Epoch :  14 loss training:  70.63010159134865 Time :  745
accuracy train: 0.830728 val: 0.771831 test: 0.780529
max validation accuracy : 0.774648 max acc epoch : 10 test accuracy : 0.777997
Counter({0: 6150, 1: 4512})

Epoch :  15 loss training:  68.24481013417244 Time :  759
accuracy train: 0.842607 val: 0.784507 test: 0.780810
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.780810
Counter({1: 6159, 0: 4503})

Epoch :  16 loss training:  66.10614277422428 Time :  772
accuracy train: 0.852610 val: 0.791549 test: 0.780248
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.780248
Counter({1: 6203, 0: 4459})

Epoch :  17 loss training:  64.36602100729942 Time :  785
accuracy train: 0.856049 val: 0.771831 test: 0.779403
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.780248
Counter({1: 6241, 0: 4421})

Epoch :  18 loss training:  62.502237901091576 Time :  797
accuracy train: 0.862926 val: 0.781690 test: 0.783905
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.780248
Counter({0: 6266, 1: 4396})

Epoch :  19 loss training:  60.92134664952755 Time :  810
accuracy train: 0.872929 val: 0.785915 test: 0.785312
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.780248
Counter({1: 6303, 0: 4359})

Epoch :  20 loss training:  59.19580973684788 Time :  822
accuracy train: 0.886996 val: 0.783099 test: 0.785031
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.780248
Counter({0: 6371, 1: 4291})

Epoch :  21 loss training:  57.15385960042477 Time :  835
accuracy train: 0.892935 val: 0.784507 test: 0.785031
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.780248
Counter({1: 6366, 0: 4296})

Epoch :  22 loss training:  55.032034024596214 Time :  849
accuracy train: 0.899187 val: 0.791549 test: 0.783343
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.780248
Counter({0: 6371, 1: 4291})

Epoch :  23 loss training:  52.70464298129082 Time :  863
accuracy train: 0.904345 val: 0.790141 test: 0.787563
max validation accuracy : 0.791549 max acc epoch : 16 test accuracy : 0.780248
Counter({0: 6431, 1: 4231})

Epoch :  24 loss training:  49.814079478383064 Time :  875
accuracy train: 0.914817 val: 0.792958 test: 0.785031
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.785031
Counter({0: 6452, 1: 4210})

Epoch :  25 loss training:  49.01445056498051 Time :  887
accuracy train: 0.921694 val: 0.790141 test: 0.786438
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.785031
Counter({1: 6477, 0: 4185})

Epoch :  26 loss training:  46.82643111050129 Time :  900
accuracy train: 0.925602 val: 0.791549 test: 0.787563
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.785031
Counter({0: 6492, 1: 4170})

Epoch :  27 loss training:  45.68700656294823 Time :  912
accuracy train: 0.932323 val: 0.788732 test: 0.789252
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.785031
Counter({0: 6491, 1: 4171})

Epoch :  28 loss training:  43.4819563254714 Time :  925
accuracy train: 0.938731 val: 0.788732 test: 0.786438
max validation accuracy : 0.792958 max acc epoch : 24 test accuracy : 0.785031
Counter({1: 6536, 0: 4126})

Epoch :  29 loss training:  41.44282674044371 Time :  938
accuracy train: 0.940294 val: 0.795775 test: 0.785875
max validation accuracy : 0.795775 max acc epoch : 29 test accuracy : 0.785875
Counter({0: 6550, 1: 4112})

Epoch :  30 loss training:  40.74290642887354 Time :  951
accuracy train: 0.946233 val: 0.794366 test: 0.785312
max validation accuracy : 0.795775 max acc epoch : 29 test accuracy : 0.785875
Counter({1: 6589, 0: 4073})

Epoch :  31 loss training:  37.96883451193571 Time :  970
accuracy train: 0.952329 val: 0.788732 test: 0.785312
max validation accuracy : 0.795775 max acc epoch : 29 test accuracy : 0.785875
Counter({1: 6593, 0: 4069})

Epoch :  32 loss training:  37.03155466169119 Time :  983
accuracy train: 0.955767 val: 0.792958 test: 0.781654
max validation accuracy : 0.795775 max acc epoch : 29 test accuracy : 0.785875
Counter({1: 6589, 0: 4073})

Epoch :  33 loss training:  35.62537534534931 Time :  996
accuracy train: 0.959050 val: 0.788732 test: 0.780248
max validation accuracy : 0.795775 max acc epoch : 29 test accuracy : 0.785875
Counter({0: 6613, 1: 4049})

Epoch :  34 loss training:  34.31744047254324 Time :  1005
accuracy train: 0.964833 val: 0.790141 test: 0.779403
max validation accuracy : 0.795775 max acc epoch : 29 test accuracy : 0.785875
Counter({0: 6629, 1: 4033})

Epoch :  35 loss training:  33.09553339332342 Time :  1018
accuracy train: 0.969053 val: 0.792958 test: 0.779122
max validation accuracy : 0.795775 max acc epoch : 29 test accuracy : 0.785875
Counter({1: 6611, 0: 4051})

Epoch :  36 loss training:  30.18964347615838 Time :  1031
accuracy train: 0.972960 val: 0.788732 test: 0.779122
max validation accuracy : 0.795775 max acc epoch : 29 test accuracy : 0.785875
Counter({1: 6626, 0: 4036})

Epoch :  37 loss training:  30.212691638618708 Time :  1044
accuracy train: 0.972335 val: 0.800000 test: 0.784468
max validation accuracy : 0.800000 max acc epoch : 37 test accuracy : 0.784468
Counter({0: 6652, 1: 4010})

Epoch :  38 loss training:  29.401193123310804 Time :  1058
accuracy train: 0.977337 val: 0.790141 test: 0.778841
max validation accuracy : 0.800000 max acc epoch : 37 test accuracy : 0.784468
Counter({1: 6653, 0: 4009})

Epoch :  39 loss training:  27.263191923499107 Time :  1073
accuracy train: 0.978431 val: 0.791549 test: 0.773213
max validation accuracy : 0.800000 max acc epoch : 37 test accuracy : 0.784468
Counter({1: 6641, 0: 4021})

Epoch :  40 loss training:  27.19509471580386 Time :  1085
accuracy train: 0.980150 val: 0.791549 test: 0.775183
max validation accuracy : 0.800000 max acc epoch : 37 test accuracy : 0.784468
Counter({1: 6660, 0: 4002})

Epoch :  41 loss training:  25.42329816892743 Time :  1098
accuracy train: 0.984214 val: 0.785915 test: 0.773213
max validation accuracy : 0.800000 max acc epoch : 37 test accuracy : 0.784468
Counter({1: 6658, 0: 4004})

Epoch :  42 loss training:  25.28693213686347 Time :  1110
accuracy train: 0.985152 val: 0.795775 test: 0.776871
max validation accuracy : 0.800000 max acc epoch : 37 test accuracy : 0.784468
Counter({1: 6683, 0: 3979})

Epoch :  43 loss training:  22.537047170102596 Time :  1123
accuracy train: 0.987496 val: 0.788732 test: 0.776308
max validation accuracy : 0.800000 max acc epoch : 37 test accuracy : 0.784468
Counter({1: 6699, 0: 3963})

Epoch :  44 loss training:  22.807430535554886 Time :  1135
accuracy train: 0.987965 val: 0.790141 test: 0.777715
max validation accuracy : 0.800000 max acc epoch : 37 test accuracy : 0.784468
Counter({1: 6696, 0: 3966})

Epoch :  45 loss training:  21.996016895398498 Time :  1148
accuracy train: 0.989528 val: 0.787324 test: 0.775464
max validation accuracy : 0.800000 max acc epoch : 37 test accuracy : 0.784468
Counter({1: 6703, 0: 3959})

Epoch :  46 loss training:  19.811859793961048 Time :  1161
accuracy train: 0.990778 val: 0.790141 test: 0.774339
max validation accuracy : 0.800000 max acc epoch : 37 test accuracy : 0.784468
Counter({1: 6715, 0: 3947})

Epoch :  47 loss training:  19.834068140015006 Time :  1176
accuracy train: 0.992810 val: 0.797183 test: 0.772369
max validation accuracy : 0.800000 max acc epoch : 37 test accuracy : 0.784468
Counter({1: 6711, 0: 3951})

Epoch :  48 loss training:  19.51231389027089 Time :  1188
accuracy train: 0.992029 val: 0.784507 test: 0.772088
max validation accuracy : 0.800000 max acc epoch : 37 test accuracy : 0.784468
Counter({1: 6729, 0: 3933})

========================================================================================================================================================================================================
best acc epoch :  37
validation accuracy :  0.8
test accuracy :  0.7844682048396173
last test_accuracy :  0.7720877884074282
second best val :  0.7971830985915493
second best test :  0.7844682048396173
max gap 8
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=542, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0
Counter({1: 6225, 0: 4437})

Epoch :  1 loss training:  96.51031011343002 Time :  1203
accuracy train: 0.756330 val: 0.753521 test: 0.750985
max validation accuracy : 0.753521 max acc epoch : 1 test accuracy : 0.750985
Counter({1: 7493, 0: 3169})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.84279096126556 Time :  1216
accuracy train: 0.777430 val: 0.787324 test: 0.772932
max validation accuracy : 0.787324 max acc epoch : 2 test accuracy : 0.772932
Counter({0: 5827, 1: 4835})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  84.84439960122108 Time :  1229
accuracy train: 0.787121 val: 0.773239 test: 0.772369
max validation accuracy : 0.787324 max acc epoch : 2 test accuracy : 0.772932
Counter({1: 5521, 0: 5141})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  82.50100699067116 Time :  1242
accuracy train: 0.794780 val: 0.794366 test: 0.774902
max validation accuracy : 0.794366 max acc epoch : 4 test accuracy : 0.774902
Counter({0: 5417, 1: 5245})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  80.23887594044209 Time :  1255
accuracy train: 0.793686 val: 0.794366 test: 0.771806
max validation accuracy : 0.794366 max acc epoch : 4 test accuracy : 0.774902
Counter({0: 5379, 1: 5283})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.02964544296265 Time :  1268
accuracy train: 0.800719 val: 0.778873 test: 0.770962
max validation accuracy : 0.794366 max acc epoch : 4 test accuracy : 0.774902
Counter({0: 5378, 1: 5284})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  78.72523441910744 Time :  1285
accuracy train: 0.801657 val: 0.778873 test: 0.777153
max validation accuracy : 0.794366 max acc epoch : 4 test accuracy : 0.774902
Counter({0: 5416, 1: 5246})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.82931619882584 Time :  1297
accuracy train: 0.806658 val: 0.788732 test: 0.770681
max validation accuracy : 0.794366 max acc epoch : 4 test accuracy : 0.774902
Counter({1: 5461, 0: 5201})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  77.15308383107185 Time :  1309
accuracy train: 0.809315 val: 0.790141 test: 0.768711
max validation accuracy : 0.794366 max acc epoch : 4 test accuracy : 0.774902
Counter({1: 5498, 0: 5164})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  75.77541896700859 Time :  1321
accuracy train: 0.814942 val: 0.787324 test: 0.771525
max validation accuracy : 0.794366 max acc epoch : 4 test accuracy : 0.774902
Counter({0: 5533, 1: 5129})

Epoch :  11 loss training:  75.3039488196373 Time :  1334
accuracy train: 0.817756 val: 0.790141 test: 0.774902
max validation accuracy : 0.794366 max acc epoch : 4 test accuracy : 0.774902
Counter({0: 5496, 1: 5166})

Epoch :  12 loss training:  74.14122918248177 Time :  1346
accuracy train: 0.821819 val: 0.785915 test: 0.777434
max validation accuracy : 0.794366 max acc epoch : 4 test accuracy : 0.774902
Counter({0: 5533, 1: 5129})

Epoch :  13 loss training:  71.06296321749687 Time :  1359
accuracy train: 0.829634 val: 0.798592 test: 0.776590
max validation accuracy : 0.798592 max acc epoch : 13 test accuracy : 0.776590
Counter({0: 5518, 1: 5144})

Epoch :  14 loss training:  70.52056565880775 Time :  1372
accuracy train: 0.834636 val: 0.787324 test: 0.775464
max validation accuracy : 0.798592 max acc epoch : 13 test accuracy : 0.776590
Counter({0: 5555, 1: 5107})

Epoch :  15 loss training:  68.93854933977127 Time :  1391
accuracy train: 0.840731 val: 0.795775 test: 0.779403
max validation accuracy : 0.798592 max acc epoch : 13 test accuracy : 0.776590
Counter({0: 5809, 1: 4853})

Epoch :  16 loss training:  67.29780249297619 Time :  1404
accuracy train: 0.852610 val: 0.798592 test: 0.779122
max validation accuracy : 0.798592 max acc epoch : 13 test accuracy : 0.776590
Counter({0: 5856, 1: 4806})

Epoch :  17 loss training:  65.59354031085968 Time :  1417
accuracy train: 0.857143 val: 0.795775 test: 0.782217
max validation accuracy : 0.798592 max acc epoch : 13 test accuracy : 0.776590
Counter({0: 5924, 1: 4738})

Epoch :  18 loss training:  62.444594234228134 Time :  1429
accuracy train: 0.857143 val: 0.804225 test: 0.783061
max validation accuracy : 0.804225 max acc epoch : 18 test accuracy : 0.783061
Counter({1: 5976, 0: 4686})

Epoch :  19 loss training:  61.42728163301945 Time :  1442
accuracy train: 0.875274 val: 0.805634 test: 0.779685
max validation accuracy : 0.805634 max acc epoch : 19 test accuracy : 0.779685
Counter({1: 5949, 0: 4713})

Epoch :  20 loss training:  58.50592537224293 Time :  1454
accuracy train: 0.877618 val: 0.802817 test: 0.786156
max validation accuracy : 0.805634 max acc epoch : 19 test accuracy : 0.779685
Counter({0: 6009, 1: 4653})

Epoch :  21 loss training:  57.26200069487095 Time :  1467
accuracy train: 0.892310 val: 0.808451 test: 0.784468
max validation accuracy : 0.808451 max acc epoch : 21 test accuracy : 0.784468
Counter({0: 5895, 1: 4767})

Epoch :  22 loss training:  56.2691810131073 Time :  1480
accuracy train: 0.899031 val: 0.818310 test: 0.785594
max validation accuracy : 0.818310 max acc epoch : 22 test accuracy : 0.785594
Counter({0: 5943, 1: 4719})

Epoch :  23 loss training:  53.98564451932907 Time :  1495
accuracy train: 0.893248 val: 0.795775 test: 0.780529
max validation accuracy : 0.818310 max acc epoch : 22 test accuracy : 0.785594
Counter({0: 5954, 1: 4708})

Epoch :  24 loss training:  51.13522160053253 Time :  1508
accuracy train: 0.908096 val: 0.812676 test: 0.784468
max validation accuracy : 0.818310 max acc epoch : 22 test accuracy : 0.785594
Counter({0: 6066, 1: 4596})

Epoch :  25 loss training:  47.83333620429039 Time :  1520
accuracy train: 0.905595 val: 0.794366 test: 0.774339
max validation accuracy : 0.818310 max acc epoch : 22 test accuracy : 0.785594
Counter({0: 6107, 1: 4555})

Epoch :  26 loss training:  48.43403121829033 Time :  1534
accuracy train: 0.921851 val: 0.798592 test: 0.784750
max validation accuracy : 0.818310 max acc epoch : 22 test accuracy : 0.785594
Counter({0: 6058, 1: 4604})

Epoch :  27 loss training:  44.87062694132328 Time :  1546
accuracy train: 0.930916 val: 0.809859 test: 0.782499
max validation accuracy : 0.818310 max acc epoch : 22 test accuracy : 0.785594
Counter({0: 6093, 1: 4569})

Epoch :  28 loss training:  43.38401224464178 Time :  1559
accuracy train: 0.931854 val: 0.802817 test: 0.781936
max validation accuracy : 0.818310 max acc epoch : 22 test accuracy : 0.785594
Counter({0: 6117, 1: 4545})

Epoch :  29 loss training:  41.27493879199028 Time :  1572
accuracy train: 0.934511 val: 0.807042 test: 0.779685
max validation accuracy : 0.818310 max acc epoch : 22 test accuracy : 0.785594
Counter({0: 6207, 1: 4455})

Epoch :  30 loss training:  41.07977145910263 Time :  1584
accuracy train: 0.947327 val: 0.807042 test: 0.781373
max validation accuracy : 0.818310 max acc epoch : 22 test accuracy : 0.785594
Counter({0: 6180, 1: 4482})

Epoch :  31 loss training:  38.648566134274006 Time :  1599
accuracy train: 0.951078 val: 0.802817 test: 0.781092
max validation accuracy : 0.818310 max acc epoch : 22 test accuracy : 0.785594
Counter({0: 6297, 1: 4365})

Epoch :  32 loss training:  38.04628353565931 Time :  1611
accuracy train: 0.954048 val: 0.805634 test: 0.779403
max validation accuracy : 0.818310 max acc epoch : 22 test accuracy : 0.785594
Counter({0: 6352, 1: 4310})

Epoch :  33 loss training:  36.53371452540159 Time :  1624
accuracy train: 0.958425 val: 0.811268 test: 0.779966
max validation accuracy : 0.818310 max acc epoch : 22 test accuracy : 0.785594
Counter({0: 6399, 1: 4263})

========================================================================================================================================================================================================
best acc epoch :  22
validation accuracy :  0.8183098591549296
test accuracy :  0.7855936972425436
last test_accuracy :  0.7799662352279122
second best val :  0.8126760563380282
second best test :  0.7855936972425436
max gap 9
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.5, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=583, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0
Counter({0: 6202, 1: 4460})

Epoch :  1 loss training:  96.73234894871712 Time :  1640
accuracy train: 0.773054 val: 0.730986 test: 0.764491
max validation accuracy : 0.730986 max acc epoch : 1 test accuracy : 0.764491
Counter({0: 5533, 1: 5129})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  87.0962423980236 Time :  1652
accuracy train: 0.782432 val: 0.743662 test: 0.775183
max validation accuracy : 0.743662 max acc epoch : 2 test accuracy : 0.775183
Counter({0: 5916, 1: 4746})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  84.27899214625359 Time :  1662
accuracy train: 0.771335 val: 0.742254 test: 0.756612
max validation accuracy : 0.743662 max acc epoch : 2 test accuracy : 0.775183
Counter({0: 6006, 1: 4656})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  81.59250585734844 Time :  1674
accuracy train: 0.787746 val: 0.750704 test: 0.769274
max validation accuracy : 0.750704 max acc epoch : 4 test accuracy : 0.769274
Counter({0: 5917, 1: 4745})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  79.39555773139 Time :  1688
accuracy train: 0.794467 val: 0.746479 test: 0.768711
max validation accuracy : 0.750704 max acc epoch : 4 test accuracy : 0.769274
Counter({1: 5828, 0: 4834})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.6453548669815 Time :  1702
accuracy train: 0.805252 val: 0.747887 test: 0.769555
max validation accuracy : 0.750704 max acc epoch : 4 test accuracy : 0.769274
Counter({0: 5842, 1: 4820})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.05747157335281 Time :  1714
accuracy train: 0.789309 val: 0.760563 test: 0.768149
max validation accuracy : 0.760563 max acc epoch : 7 test accuracy : 0.768149
Counter({1: 5877, 0: 4785})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  75.43263360857964 Time :  1727
accuracy train: 0.797906 val: 0.759155 test: 0.767023
max validation accuracy : 0.760563 max acc epoch : 7 test accuracy : 0.768149
Counter({1: 5893, 0: 4769})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  75.1093308031559 Time :  1739
accuracy train: 0.803063 val: 0.746479 test: 0.774057
max validation accuracy : 0.760563 max acc epoch : 7 test accuracy : 0.768149
Counter({0: 5878, 1: 4784})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  74.63773947954178 Time :  1752
accuracy train: 0.813848 val: 0.753521 test: 0.775464
max validation accuracy : 0.760563 max acc epoch : 7 test accuracy : 0.768149
Counter({0: 5894, 1: 4768})

Epoch :  11 loss training:  74.11044237017632 Time :  1764
accuracy train: 0.817287 val: 0.763380 test: 0.774339
max validation accuracy : 0.763380 max acc epoch : 11 test accuracy : 0.774339
Counter({1: 5923, 0: 4739})

Epoch :  12 loss training:  72.23532284796238 Time :  1777
accuracy train: 0.813535 val: 0.754930 test: 0.774902
max validation accuracy : 0.763380 max acc epoch : 11 test accuracy : 0.774339
Counter({0: 5926, 1: 4736})

Epoch :  13 loss training:  71.04841232299805 Time :  1790
accuracy train: 0.817130 val: 0.750704 test: 0.775183
max validation accuracy : 0.763380 max acc epoch : 11 test accuracy : 0.774339
Counter({0: 5938, 1: 4724})

Epoch :  14 loss training:  69.617511510849 Time :  1804
accuracy train: 0.834167 val: 0.757746 test: 0.779966
max validation accuracy : 0.763380 max acc epoch : 11 test accuracy : 0.774339
Counter({0: 5977, 1: 4685})

Epoch :  15 loss training:  67.73374152183533 Time :  1817
accuracy train: 0.845264 val: 0.760563 test: 0.783343
max validation accuracy : 0.763380 max acc epoch : 11 test accuracy : 0.774339
Counter({0: 5988, 1: 4674})

Epoch :  16 loss training:  64.75410291552544 Time :  1830
accuracy train: 0.854642 val: 0.766197 test: 0.776590
max validation accuracy : 0.766197 max acc epoch : 16 test accuracy : 0.776590
Counter({0: 5993, 1: 4669})

Epoch :  17 loss training:  64.19874279201031 Time :  1842
accuracy train: 0.856987 val: 0.764789 test: 0.781936
max validation accuracy : 0.766197 max acc epoch : 16 test accuracy : 0.776590
Counter({0: 6019, 1: 4643})

Epoch :  18 loss training:  61.33713337779045 Time :  1855
accuracy train: 0.863707 val: 0.759155 test: 0.780529
max validation accuracy : 0.766197 max acc epoch : 16 test accuracy : 0.776590
Counter({0: 6049, 1: 4613})

Epoch :  19 loss training:  60.24064591526985 Time :  1868
accuracy train: 0.871053 val: 0.760563 test: 0.783905
max validation accuracy : 0.766197 max acc epoch : 16 test accuracy : 0.776590
Counter({0: 6058, 1: 4604})

Epoch :  20 loss training:  58.04995581507683 Time :  1880
accuracy train: 0.883401 val: 0.769014 test: 0.782780
max validation accuracy : 0.769014 max acc epoch : 20 test accuracy : 0.782780
Counter({0: 6056, 1: 4606})

Epoch :  21 loss training:  55.94230356812477 Time :  1894
accuracy train: 0.887621 val: 0.760563 test: 0.782217
max validation accuracy : 0.769014 max acc epoch : 20 test accuracy : 0.782780
Counter({0: 6076, 1: 4586})

Epoch :  22 loss training:  54.27432045340538 Time :  1911
accuracy train: 0.897624 val: 0.770423 test: 0.780529
max validation accuracy : 0.770423 max acc epoch : 22 test accuracy : 0.780529
Counter({0: 6102, 1: 4560})

Epoch :  23 loss training:  52.585280388593674 Time :  1923
accuracy train: 0.906690 val: 0.767606 test: 0.782217
max validation accuracy : 0.770423 max acc epoch : 22 test accuracy : 0.780529
Counter({0: 6070, 1: 4592})

Epoch :  24 loss training:  49.80878233909607 Time :  1935
accuracy train: 0.920288 val: 0.776056 test: 0.782780
max validation accuracy : 0.776056 max acc epoch : 24 test accuracy : 0.782780
Counter({1: 6113, 0: 4549})

Epoch :  25 loss training:  47.72443105280399 Time :  1948
accuracy train: 0.918881 val: 0.763380 test: 0.778559
max validation accuracy : 0.776056 max acc epoch : 24 test accuracy : 0.782780
Counter({1: 6105, 0: 4557})

Epoch :  26 loss training:  45.721451818943024 Time :  1961
accuracy train: 0.925758 val: 0.760563 test: 0.780529
max validation accuracy : 0.776056 max acc epoch : 24 test accuracy : 0.782780
Counter({0: 6116, 1: 4546})

Epoch :  27 loss training:  43.38580425083637 Time :  1973
accuracy train: 0.939043 val: 0.770423 test: 0.781654
max validation accuracy : 0.776056 max acc epoch : 24 test accuracy : 0.782780
Counter({0: 6130, 1: 4532})

Epoch :  28 loss training:  42.1701216250658 Time :  1986
accuracy train: 0.941232 val: 0.763380 test: 0.781373
max validation accuracy : 0.776056 max acc epoch : 24 test accuracy : 0.782780
Counter({0: 6159, 1: 4503})

Epoch :  29 loss training:  39.42613911628723 Time :  1999
accuracy train: 0.948265 val: 0.764789 test: 0.782499
max validation accuracy : 0.776056 max acc epoch : 24 test accuracy : 0.782780
Counter({1: 6153, 0: 4509})

Epoch :  30 loss training:  39.18951517343521 Time :  2014
accuracy train: 0.951547 val: 0.767606 test: 0.785031
max validation accuracy : 0.776056 max acc epoch : 24 test accuracy : 0.782780
Counter({0: 6186, 1: 4476})

Epoch :  31 loss training:  36.557025618851185 Time :  2026
accuracy train: 0.955611 val: 0.760563 test: 0.784468
max validation accuracy : 0.776056 max acc epoch : 24 test accuracy : 0.782780
Counter({1: 6188, 0: 4474})

Epoch :  32 loss training:  35.0216457284987 Time :  2039
accuracy train: 0.960144 val: 0.766197 test: 0.782780
max validation accuracy : 0.776056 max acc epoch : 24 test accuracy : 0.782780
Counter({0: 6214, 1: 4448})

Epoch :  33 loss training:  33.67993254587054 Time :  2052
accuracy train: 0.963270 val: 0.749296 test: 0.782217
max validation accuracy : 0.776056 max acc epoch : 24 test accuracy : 0.782780
Counter({1: 6222, 0: 4440})

Epoch :  34 loss training:  31.938493188470602 Time :  2064
accuracy train: 0.969053 val: 0.761972 test: 0.779122
max validation accuracy : 0.776056 max acc epoch : 24 test accuracy : 0.782780
Counter({1: 6245, 0: 4417})

Epoch :  35 loss training:  31.168575167655945 Time :  2077
accuracy train: 0.970303 val: 0.754930 test: 0.781654
max validation accuracy : 0.776056 max acc epoch : 24 test accuracy : 0.782780
Counter({0: 6267, 1: 4395})

========================================================================================================================================================================================================
best acc epoch :  24
validation accuracy :  0.776056338028169
test accuracy :  0.7827799662352279
last test_accuracy :  0.7816544738323016
second best val :  0.7704225352112676
second best test :  0.7805289814293753
max gap 5
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  33 	 val_accuracy : 0.78592 	 test_accuracy : 0.78109 	 last test_accuracy : 0.77153 	 second best val : 0.78310 	 second best test : 0.78503
k :  1 	 best_acc epoch :  37 	 val_accuracy : 0.80000 	 test_accuracy : 0.78447 	 last test_accuracy : 0.77209 	 second best val : 0.79718 	 second best test : 0.78447
k :  2 	 best_acc epoch :  22 	 val_accuracy : 0.81831 	 test_accuracy : 0.78559 	 last test_accuracy : 0.77997 	 second best val : 0.81268 	 second best test : 0.78559
k :  3 	 best_acc epoch :  24 	 val_accuracy : 0.77606 	 test_accuracy : 0.78278 	 last test_accuracy : 0.78165 	 second best val : 0.77042 	 second best test : 0.78053

avg :  	 val_accuracy : 0.79507 	 test_accuracy : 0.78348 	 last_accuracy : 0.77631 	 second best val : 0.79085 	 second best test : 0.78391

std :  	 val_accuracy : 0.01589 	 test_accuracy : 0.00171 	 last_accuracy : 0.00455 	 second best val : 0.01576 	 second best test : 0.00199
