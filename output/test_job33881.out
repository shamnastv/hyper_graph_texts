

date and time :  Tue May 25 23:54:41 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=2, random_vec=False, seed=0, weight_decay=1e-08)
device :  cuda:0
Counter({0: 4233, 1: 2305, 2: 1153})

Epoch :  1 loss training:  50.91297824680805 Time :  144
accuracy train: 0.924056 val: 0.910909 test: 0.925114
max validation accuracy : 0.910909 max acc epoch : 1 test accuracy : 0.925114
Counter({1: 3609, 0: 2680, 2: 1402})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  23.31479760631919 Time :  227
accuracy train: 0.965058 val: 0.947273 test: 0.958447
max validation accuracy : 0.947273 max acc epoch : 2 test accuracy : 0.958447
Counter({1: 3672, 0: 2542, 2: 1477})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  17.352548795286566 Time :  310
accuracy train: 0.966067 val: 0.945455 test: 0.947032
max validation accuracy : 0.947273 max acc epoch : 2 test accuracy : 0.958447
Counter({1: 3787, 0: 2456, 2: 1448})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  13.029417900368571 Time :  391
accuracy train: 0.980610 val: 0.965455 test: 0.963927
max validation accuracy : 0.965455 max acc epoch : 4 test accuracy : 0.963927
Counter({1: 3785, 0: 2467, 2: 1439})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.402301372261718 Time :  470
accuracy train: 0.980206 val: 0.954545 test: 0.957991
max validation accuracy : 0.965455 max acc epoch : 4 test accuracy : 0.963927
Counter({1: 3818, 0: 2442, 2: 1431})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.652435146737844 Time :  551
accuracy train: 0.984852 val: 0.967273 test: 0.968493
max validation accuracy : 0.967273 max acc epoch : 6 test accuracy : 0.968493
Counter({1: 3852, 2: 2399, 0: 1440})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  8.733744546072558 Time :  639
accuracy train: 0.989295 val: 0.967273 test: 0.967580
max validation accuracy : 0.967273 max acc epoch : 6 test accuracy : 0.968493
Counter({1: 3878, 0: 2374, 2: 1439})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  7.016340172616765 Time :  720
accuracy train: 0.988285 val: 0.969091 test: 0.968037
max validation accuracy : 0.969091 max acc epoch : 8 test accuracy : 0.968037
Counter({0: 3890, 1: 2360, 2: 1441})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  7.580448702676222 Time :  812
accuracy train: 0.991315 val: 0.969091 test: 0.965297
max validation accuracy : 0.969091 max acc epoch : 8 test accuracy : 0.968037
Counter({0: 3897, 1: 2354, 2: 1440})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  6.5051645811181515 Time :  891
accuracy train: 0.990305 val: 0.969091 test: 0.966667
max validation accuracy : 0.969091 max acc epoch : 8 test accuracy : 0.968037
Counter({1: 3895, 0: 2356, 2: 1440})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.608152431319468 Time :  963
accuracy train: 0.991517 val: 0.967273 test: 0.966210
max validation accuracy : 0.969091 max acc epoch : 8 test accuracy : 0.968037
Counter({1: 3897, 0: 2352, 2: 1442})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  5.640840002626646 Time :  1037
accuracy train: 0.991517 val: 0.976364 test: 0.966667
max validation accuracy : 0.976364 max acc epoch : 12 test accuracy : 0.966667
Counter({1: 3899, 0: 2352, 2: 1440})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  5.374754292308353 Time :  1104
accuracy train: 0.992729 val: 0.974545 test: 0.964840
max validation accuracy : 0.976364 max acc epoch : 12 test accuracy : 0.966667
Counter({1: 3902, 0: 2350, 2: 1439})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  5.075383299496025 Time :  1183
accuracy train: 0.992527 val: 0.978182 test: 0.966667
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({1: 3902, 0: 2348, 2: 1441})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  5.005384534364566 Time :  1263
accuracy train: 0.993335 val: 0.974545 test: 0.965753
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({1: 3904, 0: 2346, 2: 1441})

Epoch :  16 loss training:  5.045165065792389 Time :  1334
accuracy train: 0.993739 val: 0.970909 test: 0.966210
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({1: 3907, 0: 2344, 2: 1440})

Epoch :  17 loss training:  5.249933973420411 Time :  1413
accuracy train: 0.993537 val: 0.972727 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({1: 3908, 0: 2343, 2: 1440})

Epoch :  18 loss training:  4.746484120842069 Time :  1495
accuracy train: 0.993537 val: 0.978182 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({0: 3913, 1: 2341, 2: 1437})

Epoch :  19 loss training:  4.342031289939769 Time :  1575
accuracy train: 0.993941 val: 0.972727 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({1: 3915, 0: 2339, 2: 1437})

Epoch :  20 loss training:  3.5258068384137005 Time :  1649
accuracy train: 0.993739 val: 0.974545 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({1: 3914, 0: 2339, 2: 1438})

Epoch :  21 loss training:  3.908258721115999 Time :  1729
accuracy train: 0.994951 val: 0.976364 test: 0.966667
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({2: 3916, 1: 2337, 0: 1438})

Epoch :  22 loss training:  4.143596920766868 Time :  1804
accuracy train: 0.994951 val: 0.974545 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({1: 3915, 0: 2338, 2: 1438})

Epoch :  23 loss training:  4.076573977712542 Time :  1886
accuracy train: 0.994749 val: 0.974545 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({0: 3915, 1: 2338, 2: 1438})

Epoch :  24 loss training:  3.2376396226754878 Time :  1980
accuracy train: 0.994951 val: 0.970909 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({1: 3915, 0: 2338, 2: 1438})

Epoch :  25 loss training:  3.504376990837045 Time :  2065
accuracy train: 0.995556 val: 0.969091 test: 0.966667
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({2: 3915, 0: 2338, 1: 1438})

Epoch :  26 loss training:  3.669194304617122 Time :  2141
accuracy train: 0.995556 val: 0.972727 test: 0.966667
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({2: 3916, 0: 2337, 1: 1438})

Epoch :  27 loss training:  3.451120497426018 Time :  2228
accuracy train: 0.995152 val: 0.970909 test: 0.965297
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({1: 3918, 0: 2336, 2: 1437})

Epoch :  28 loss training:  2.8895329238148406 Time :  2308
accuracy train: 0.995960 val: 0.974545 test: 0.966210
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({1: 3918, 0: 2336, 2: 1437})

Epoch :  29 loss training:  3.3530714261578396 Time :  2385
accuracy train: 0.995758 val: 0.972727 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({1: 3919, 0: 2335, 2: 1437})

Epoch :  30 loss training:  2.9378535831929184 Time :  2467
accuracy train: 0.994749 val: 0.974545 test: 0.966667
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({0: 3919, 1: 2335, 2: 1437})

Epoch :  31 loss training:  2.7255772220669314 Time :  2535
accuracy train: 0.995758 val: 0.974545 test: 0.965753
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({1: 3923, 0: 2331, 2: 1437})

Epoch :  32 loss training:  2.9365126141929068 Time :  2616
accuracy train: 0.995758 val: 0.974545 test: 0.965753
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({2: 3923, 0: 2326, 1: 1442})

Epoch :  33 loss training:  2.5452927340811584 Time :  2696
accuracy train: 0.995152 val: 0.972727 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({1: 3924, 0: 2326, 2: 1441})

Epoch :  34 loss training:  2.67454288166482 Time :  2775
accuracy train: 0.995354 val: 0.974545 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({1: 3924, 0: 2327, 2: 1440})

Epoch :  35 loss training:  2.5129413748218212 Time :  2837
accuracy train: 0.995960 val: 0.972727 test: 0.966667
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({1: 3925, 2: 2326, 0: 1440})

Epoch :  36 loss training:  2.5313960660714656 Time :  2909
accuracy train: 0.996162 val: 0.970909 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({2: 3926, 0: 2324, 1: 1441})

Epoch :  37 loss training:  2.3375506920710905 Time :  2989
accuracy train: 0.995960 val: 0.970909 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({1: 3927, 0: 2320, 2: 1444})

Epoch :  38 loss training:  2.3390444667747943 Time :  3056
accuracy train: 0.996162 val: 0.974545 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({0: 3927, 2: 2321, 1: 1443})

Epoch :  39 loss training:  2.3743201908655465 Time :  3133
accuracy train: 0.996566 val: 0.972727 test: 0.965297
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({1: 3928, 0: 2319, 2: 1444})

Epoch :  40 loss training:  2.1387299461930525 Time :  3207
accuracy train: 0.996566 val: 0.972727 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({1: 3929, 0: 2318, 2: 1444})

Epoch :  41 loss training:  2.2692637715954334 Time :  3275
accuracy train: 0.996768 val: 0.972727 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({1: 3929, 0: 2318, 2: 1444})

Epoch :  42 loss training:  2.8483856933016796 Time :  3360
accuracy train: 0.996364 val: 0.972727 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({1: 3929, 2: 2317, 0: 1445})

Epoch :  43 loss training:  2.550645097522647 Time :  3441
accuracy train: 0.996162 val: 0.978182 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({2: 3929, 0: 2318, 1: 1444})

Epoch :  44 loss training:  2.204869942070218 Time :  3510
accuracy train: 0.996566 val: 0.976364 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({1: 3929, 0: 2317, 2: 1445})

Epoch :  45 loss training:  1.9628265269566327 Time :  3592
accuracy train: 0.996566 val: 0.974545 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.966667
Counter({1: 3929, 0: 2317, 2: 1445})

========================================================================================================================================================================================================
max acc epoch :  14
max validation accuracy :  0.9781818181818182
test accuracy :  0.9666666666666667
last test_accuracy :  0.9680365296803652
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=2, random_vec=False, seed=0, weight_decay=1e-08)
device :  cuda:0
Counter({0: 4233, 1: 2305, 2: 1153})

Epoch :  1 loss training:  51.01541304588318 Time :  3789
accuracy train: 0.927287 val: 0.910909 test: 0.926027
max validation accuracy : 0.910909 max acc epoch : 1 test accuracy : 0.926027
Counter({1: 3581, 0: 2720, 2: 1390})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  23.706945563666523 Time :  3870
accuracy train: 0.963846 val: 0.947273 test: 0.952968
max validation accuracy : 0.947273 max acc epoch : 2 test accuracy : 0.952968
Counter({1: 3677, 0: 2579, 2: 1435})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  17.66329916752875 Time :  3954
accuracy train: 0.967885 val: 0.947273 test: 0.950685
max validation accuracy : 0.947273 max acc epoch : 2 test accuracy : 0.952968
Counter({1: 3780, 0: 2456, 2: 1455})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  13.090685809962451 Time :  4033
accuracy train: 0.980812 val: 0.958182 test: 0.962557
max validation accuracy : 0.958182 max acc epoch : 4 test accuracy : 0.962557
Counter({1: 3781, 0: 2469, 2: 1441})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.612363550113514 Time :  4106
accuracy train: 0.981216 val: 0.954545 test: 0.962100
max validation accuracy : 0.958182 max acc epoch : 4 test accuracy : 0.962557
Counter({1: 3830, 0: 2427, 2: 1434})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.917505798861384 Time :  4176
accuracy train: 0.988487 val: 0.970909 test: 0.968950
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.968950
Counter({1: 3852, 0: 2401, 2: 1438})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  8.318275560159236 Time :  4257
accuracy train: 0.990103 val: 0.967273 test: 0.966210
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.968950
Counter({1: 3866, 0: 2392, 2: 1433})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  7.116709212306887 Time :  4336
accuracy train: 0.989093 val: 0.969091 test: 0.968037
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.968950
Counter({1: 3881, 0: 2375, 2: 1435})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  7.621107715996914 Time :  4414
accuracy train: 0.991113 val: 0.972727 test: 0.966667
max validation accuracy : 0.972727 max acc epoch : 9 test accuracy : 0.966667
Counter({1: 3880, 0: 2375, 2: 1436})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  6.482484001549892 Time :  4500
accuracy train: 0.990709 val: 0.972727 test: 0.967123
max validation accuracy : 0.972727 max acc epoch : 9 test accuracy : 0.966667
Counter({1: 3870, 2: 2384, 0: 1437})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.630203615757637 Time :  4577
accuracy train: 0.991921 val: 0.970909 test: 0.967123
max validation accuracy : 0.972727 max acc epoch : 9 test accuracy : 0.966667
Counter({1: 3871, 0: 2381, 2: 1439})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  5.435172700905241 Time :  4660
accuracy train: 0.992527 val: 0.972727 test: 0.965753
max validation accuracy : 0.972727 max acc epoch : 9 test accuracy : 0.966667
Counter({1: 3878, 0: 2373, 2: 1440})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  5.288978578173555 Time :  4736
accuracy train: 0.993335 val: 0.969091 test: 0.966667
max validation accuracy : 0.972727 max acc epoch : 9 test accuracy : 0.966667
Counter({1: 3881, 0: 2369, 2: 1441})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  5.3377113081514835 Time :  4818
accuracy train: 0.993133 val: 0.974545 test: 0.966210
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({1: 3882, 0: 2368, 2: 1441})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  5.078781516407616 Time :  4897
accuracy train: 0.993133 val: 0.970909 test: 0.967123
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({1: 3891, 0: 2358, 2: 1442})

Epoch :  16 loss training:  4.924087166204117 Time :  4982
accuracy train: 0.993739 val: 0.970909 test: 0.965753
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({1: 3893, 0: 2357, 2: 1441})

Epoch :  17 loss training:  4.927926824660972 Time :  5061
accuracy train: 0.993941 val: 0.972727 test: 0.966210
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({1: 3894, 2: 2354, 0: 1443})

Epoch :  18 loss training:  4.598944058350753 Time :  5140
accuracy train: 0.993941 val: 0.972727 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({1: 3903, 0: 2346, 2: 1442})

Epoch :  19 loss training:  3.935939882590901 Time :  5218
accuracy train: 0.994143 val: 0.970909 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({1: 3904, 0: 2345, 2: 1442})

Epoch :  20 loss training:  3.6079239605460316 Time :  5294
accuracy train: 0.994951 val: 0.970909 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({0: 3904, 2: 2347, 1: 1440})

Epoch :  21 loss training:  4.154503318015486 Time :  5361
accuracy train: 0.994951 val: 0.970909 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({1: 3905, 2: 2347, 0: 1439})

Epoch :  22 loss training:  4.235962056263816 Time :  5436
accuracy train: 0.995354 val: 0.972727 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({1: 3907, 0: 2346, 2: 1438})

Epoch :  23 loss training:  4.079116270295344 Time :  5521
accuracy train: 0.995556 val: 0.970909 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({1: 3908, 0: 2346, 2: 1437})

Epoch :  24 loss training:  3.1800257937284186 Time :  5605
accuracy train: 0.995758 val: 0.972727 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({1: 3912, 0: 2340, 2: 1439})

Epoch :  25 loss training:  3.6389795914292336 Time :  5708
accuracy train: 0.995960 val: 0.972727 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({1: 3914, 0: 2337, 2: 1440})

Epoch :  26 loss training:  3.642056487791706 Time :  5797
accuracy train: 0.995960 val: 0.970909 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({1: 3917, 0: 2335, 2: 1439})

Epoch :  27 loss training:  3.2578093892661855 Time :  5887
accuracy train: 0.995960 val: 0.967273 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({2: 3919, 1: 2332, 0: 1440})

Epoch :  28 loss training:  2.6961202419479378 Time :  5969
accuracy train: 0.996162 val: 0.970909 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({0: 3919, 1: 2332, 2: 1440})

Epoch :  29 loss training:  3.3223702496034093 Time :  6056
accuracy train: 0.995960 val: 0.970909 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({1: 3920, 0: 2331, 2: 1440})

Epoch :  30 loss training:  2.9015391672728583 Time :  6142
accuracy train: 0.995758 val: 0.970909 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({1: 3920, 0: 2333, 2: 1438})

Epoch :  31 loss training:  2.6069164763612207 Time :  6227
accuracy train: 0.996364 val: 0.972727 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({2: 3920, 0: 2331, 1: 1440})

Epoch :  32 loss training:  2.80459713016171 Time :  6305
accuracy train: 0.996162 val: 0.974545 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({2: 3920, 0: 2328, 1: 1443})

Epoch :  33 loss training:  2.4003480033716187 Time :  6379
accuracy train: 0.996162 val: 0.972727 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({1: 3920, 0: 2329, 2: 1442})

Epoch :  34 loss training:  2.4236295782611705 Time :  6456
accuracy train: 0.995960 val: 0.972727 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({2: 3920, 0: 2329, 1: 1442})

Epoch :  35 loss training:  2.5960985977435485 Time :  6529
accuracy train: 0.996364 val: 0.970909 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({1: 3921, 0: 2328, 2: 1442})

Epoch :  36 loss training:  2.3113586375257 Time :  6600
accuracy train: 0.996364 val: 0.969091 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({2: 3923, 0: 2326, 1: 1442})

Epoch :  37 loss training:  2.239892479221453 Time :  6685
accuracy train: 0.996566 val: 0.972727 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({1: 3925, 0: 2323, 2: 1443})

Epoch :  38 loss training:  2.359260383833316 Time :  6765
accuracy train: 0.996768 val: 0.969091 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({1: 3926, 0: 2323, 2: 1442})

Epoch :  39 loss training:  2.1393844653575798 Time :  6848
accuracy train: 0.996566 val: 0.974545 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({1: 3926, 0: 2321, 2: 1444})

Epoch :  40 loss training:  2.011989250924671 Time :  6930
accuracy train: 0.996768 val: 0.967273 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({1: 3926, 0: 2317, 2: 1448})

Epoch :  41 loss training:  2.1280242702632677 Time :  7012
accuracy train: 0.996566 val: 0.972727 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({2: 3926, 0: 2318, 1: 1447})

Epoch :  42 loss training:  2.8748668091284344 Time :  7098
accuracy train: 0.996970 val: 0.972727 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({1: 3926, 0: 2316, 2: 1449})

Epoch :  43 loss training:  2.2467936883622315 Time :  7176
accuracy train: 0.996566 val: 0.974545 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({0: 3926, 1: 2317, 2: 1448})

Epoch :  44 loss training:  1.8138086375111016 Time :  7252
accuracy train: 0.996768 val: 0.972727 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({0: 3926, 1: 2315, 2: 1450})

Epoch :  45 loss training:  1.841245793257258 Time :  7331
accuracy train: 0.996566 val: 0.972727 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.966210
Counter({0: 3926, 1: 2317, 2: 1448})

========================================================================================================================================================================================================
max acc epoch :  14
max validation accuracy :  0.9745454545454545
test accuracy :  0.9662100456621004
last test_accuracy :  0.9707762557077626
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=2, random_vec=False, seed=0, weight_decay=1e-08)
device :  cuda:0
Counter({0: 4233, 1: 2305, 2: 1153})

Epoch :  1 loss training:  50.94129364192486 Time :  7534
accuracy train: 0.927691 val: 0.918182 test: 0.926027
max validation accuracy : 0.918182 max acc epoch : 1 test accuracy : 0.926027
Counter({1: 3571, 0: 2719, 2: 1401})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  23.346771819517016 Time :  7617
accuracy train: 0.962836 val: 0.950909 test: 0.959817
max validation accuracy : 0.950909 max acc epoch : 2 test accuracy : 0.959817
Counter({2: 3630, 0: 2561, 1: 1500})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  18.138571347808465 Time :  7709
accuracy train: 0.974955 val: 0.947273 test: 0.952055
max validation accuracy : 0.950909 max acc epoch : 2 test accuracy : 0.959817
Counter({1: 3805, 0: 2431, 2: 1455})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  13.054582977667451 Time :  7794
accuracy train: 0.976772 val: 0.958182 test: 0.960731
max validation accuracy : 0.958182 max acc epoch : 4 test accuracy : 0.960731
Counter({1: 3803, 0: 2442, 2: 1446})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.565361505141482 Time :  7872
accuracy train: 0.977984 val: 0.950909 test: 0.959817
max validation accuracy : 0.958182 max acc epoch : 4 test accuracy : 0.960731
Counter({0: 3829, 1: 2425, 2: 1437})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  10.190874088555574 Time :  7954
accuracy train: 0.983438 val: 0.963636 test: 0.970320
max validation accuracy : 0.963636 max acc epoch : 6 test accuracy : 0.970320
Counter({1: 3852, 0: 2401, 2: 1438})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  8.611990252975374 Time :  8039
accuracy train: 0.989093 val: 0.967273 test: 0.967123
max validation accuracy : 0.967273 max acc epoch : 7 test accuracy : 0.967123
Counter({1: 3869, 0: 2383, 2: 1439})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  7.136259364662692 Time :  8123
accuracy train: 0.988689 val: 0.967273 test: 0.964840
max validation accuracy : 0.967273 max acc epoch : 7 test accuracy : 0.967123
Counter({1: 3880, 2: 2367, 0: 1444})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  7.530148747842759 Time :  8211
accuracy train: 0.991113 val: 0.963636 test: 0.963470
max validation accuracy : 0.967273 max acc epoch : 7 test accuracy : 0.967123
Counter({1: 3887, 0: 2361, 2: 1443})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  6.33714334864635 Time :  8286
accuracy train: 0.991113 val: 0.960000 test: 0.966667
max validation accuracy : 0.967273 max acc epoch : 7 test accuracy : 0.967123
Counter({1: 3877, 0: 2368, 2: 1446})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.43008045910392 Time :  8370
accuracy train: 0.992123 val: 0.965455 test: 0.962557
max validation accuracy : 0.967273 max acc epoch : 7 test accuracy : 0.967123
Counter({1: 3883, 0: 2363, 2: 1445})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  5.545284758671187 Time :  8455
accuracy train: 0.991719 val: 0.969091 test: 0.965753
max validation accuracy : 0.969091 max acc epoch : 12 test accuracy : 0.965753
Counter({1: 3881, 0: 2363, 2: 1447})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  5.630610005813651 Time :  8531
accuracy train: 0.992729 val: 0.970909 test: 0.963014
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.963014
Counter({2: 3883, 0: 2361, 1: 1447})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.954169418429956 Time :  8615
accuracy train: 0.992325 val: 0.970909 test: 0.966210
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.963014
Counter({0: 3883, 1: 2359, 2: 1449})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  4.910545726539567 Time :  8698
accuracy train: 0.993537 val: 0.965455 test: 0.962557
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.963014
Counter({1: 3890, 0: 2354, 2: 1447})

Epoch :  16 loss training:  4.676885121851228 Time :  8782
accuracy train: 0.992729 val: 0.967273 test: 0.966210
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.963014
Counter({1: 3891, 0: 2353, 2: 1447})

Epoch :  17 loss training:  4.648810315760784 Time :  8858
accuracy train: 0.993941 val: 0.969091 test: 0.965753
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.963014
Counter({1: 3891, 0: 2353, 2: 1447})

Epoch :  18 loss training:  4.406695407698862 Time :  8936
accuracy train: 0.993739 val: 0.970909 test: 0.968037
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.963014
Counter({1: 3897, 0: 2343, 2: 1451})

Epoch :  19 loss training:  4.039226256776601 Time :  9010
accuracy train: 0.994345 val: 0.965455 test: 0.965753
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.963014
Counter({1: 3898, 0: 2341, 2: 1452})

Epoch :  20 loss training:  3.6139652961865067 Time :  9080
accuracy train: 0.994345 val: 0.972727 test: 0.968037
max validation accuracy : 0.972727 max acc epoch : 20 test accuracy : 0.968037
Counter({1: 3898, 0: 2340, 2: 1453})

Epoch :  21 loss training:  3.952386144956108 Time :  9154
accuracy train: 0.994345 val: 0.970909 test: 0.966210
max validation accuracy : 0.972727 max acc epoch : 20 test accuracy : 0.968037
Counter({1: 3898, 0: 2337, 2: 1456})

Epoch :  22 loss training:  4.01104037152254 Time :  9230
accuracy train: 0.994345 val: 0.972727 test: 0.967580
max validation accuracy : 0.972727 max acc epoch : 20 test accuracy : 0.968037
Counter({1: 3897, 0: 2338, 2: 1456})

Epoch :  23 loss training:  3.8869238182669505 Time :  9307
accuracy train: 0.994345 val: 0.969091 test: 0.967123
max validation accuracy : 0.972727 max acc epoch : 20 test accuracy : 0.968037
Counter({1: 3900, 0: 2336, 2: 1455})

Epoch :  24 loss training:  3.252806632197462 Time :  9383
accuracy train: 0.995556 val: 0.967273 test: 0.966667
max validation accuracy : 0.972727 max acc epoch : 20 test accuracy : 0.968037
Counter({1: 3902, 0: 2334, 2: 1455})

Epoch :  25 loss training:  3.571245079860091 Time :  9457
accuracy train: 0.995556 val: 0.967273 test: 0.969406
max validation accuracy : 0.972727 max acc epoch : 20 test accuracy : 0.968037
Counter({1: 3902, 0: 2334, 2: 1455})

Epoch :  26 loss training:  3.9337817219202407 Time :  9546
accuracy train: 0.995354 val: 0.970909 test: 0.968037
max validation accuracy : 0.972727 max acc epoch : 20 test accuracy : 0.968037
Counter({1: 3904, 0: 2332, 2: 1455})

Epoch :  27 loss training:  3.0214375319774263 Time :  9631
accuracy train: 0.995758 val: 0.969091 test: 0.968037
max validation accuracy : 0.972727 max acc epoch : 20 test accuracy : 0.968037
Counter({1: 3906, 0: 2330, 2: 1455})

Epoch :  28 loss training:  2.8283348381519318 Time :  9714
accuracy train: 0.995960 val: 0.972727 test: 0.966210
max validation accuracy : 0.972727 max acc epoch : 20 test accuracy : 0.968037
Counter({1: 3908, 0: 2329, 2: 1454})

Epoch :  29 loss training:  3.3373897968267556 Time :  9795
accuracy train: 0.995758 val: 0.972727 test: 0.968493
max validation accuracy : 0.972727 max acc epoch : 20 test accuracy : 0.968037
Counter({2: 3911, 0: 2327, 1: 1453})

Epoch :  30 loss training:  2.7495482124504633 Time :  9873
accuracy train: 0.995354 val: 0.969091 test: 0.969863
max validation accuracy : 0.972727 max acc epoch : 20 test accuracy : 0.968037
Counter({2: 3911, 0: 2327, 1: 1453})

Epoch :  31 loss training:  2.755965736520011 Time :  9943
accuracy train: 0.995960 val: 0.970909 test: 0.968493
max validation accuracy : 0.972727 max acc epoch : 20 test accuracy : 0.968037
Counter({2: 3911, 0: 2326, 1: 1454})

Epoch :  32 loss training:  2.934475353365997 Time :  10021
accuracy train: 0.995960 val: 0.972727 test: 0.968950
max validation accuracy : 0.972727 max acc epoch : 20 test accuracy : 0.968037
Counter({1: 3911, 0: 2326, 2: 1454})

Epoch :  33 loss training:  2.3869157646840904 Time :  10096
accuracy train: 0.995758 val: 0.970909 test: 0.970776
max validation accuracy : 0.972727 max acc epoch : 20 test accuracy : 0.968037
Counter({1: 3911, 0: 2326, 2: 1454})

Epoch :  34 loss training:  2.595537322224118 Time :  10167
accuracy train: 0.995354 val: 0.967273 test: 0.971233
max validation accuracy : 0.972727 max acc epoch : 20 test accuracy : 0.968037
Counter({0: 3911, 1: 2326, 2: 1454})

Epoch :  35 loss training:  2.6699147702311166 Time :  10249
accuracy train: 0.996566 val: 0.969091 test: 0.968950
max validation accuracy : 0.972727 max acc epoch : 20 test accuracy : 0.968037
Counter({1: 3911, 0: 2326, 2: 1454})

Epoch :  36 loss training:  2.4012025436968543 Time :  10325
accuracy train: 0.995960 val: 0.969091 test: 0.971233
max validation accuracy : 0.972727 max acc epoch : 20 test accuracy : 0.968037
Counter({1: 3911, 0: 2326, 2: 1454})

Epoch :  37 loss training:  2.4380946909514023 Time :  10401
accuracy train: 0.996566 val: 0.969091 test: 0.970320
max validation accuracy : 0.972727 max acc epoch : 20 test accuracy : 0.968037
Counter({1: 3912, 0: 2324, 2: 1455})

Epoch :  38 loss training:  2.431452145057847 Time :  10479
accuracy train: 0.996162 val: 0.972727 test: 0.971233
max validation accuracy : 0.972727 max acc epoch : 20 test accuracy : 0.968037
Counter({1: 3912, 0: 2324, 2: 1455})

Epoch :  39 loss training:  2.261878025106853 Time :  10561
accuracy train: 0.996566 val: 0.972727 test: 0.967580
max validation accuracy : 0.972727 max acc epoch : 20 test accuracy : 0.968037
Counter({2: 3916, 0: 2320, 1: 1455})

Epoch :  40 loss training:  2.0611174695950467 Time :  10638
accuracy train: 0.996566 val: 0.969091 test: 0.972603
max validation accuracy : 0.972727 max acc epoch : 20 test accuracy : 0.968037
Counter({1: 3915, 0: 2321, 2: 1455})

Epoch :  41 loss training:  2.2262801186880097 Time :  10718
accuracy train: 0.996970 val: 0.974545 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 41 test accuracy : 0.971689
Counter({1: 3916, 0: 2320, 2: 1455})

Epoch :  42 loss training:  2.679948626202531 Time :  10794
accuracy train: 0.996162 val: 0.970909 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 41 test accuracy : 0.971689
Counter({1: 3916, 0: 2319, 2: 1456})

Epoch :  43 loss training:  2.4099931606906466 Time :  10865
accuracy train: 0.996364 val: 0.972727 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 41 test accuracy : 0.971689
Counter({1: 3915, 0: 2320, 2: 1456})

Epoch :  44 loss training:  2.0293523512154934 Time :  10944
accuracy train: 0.996566 val: 0.967273 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 41 test accuracy : 0.971689
Counter({2: 3915, 0: 2317, 1: 1459})

Epoch :  45 loss training:  1.9391548930725548 Time :  11024
accuracy train: 0.996566 val: 0.970909 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 41 test accuracy : 0.971689
Counter({2: 3914, 0: 2320, 1: 1457})

Epoch :  46 loss training:  2.2712287220929284 Time :  11098
accuracy train: 0.996768 val: 0.970909 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 41 test accuracy : 0.971689
Counter({1: 3915, 0: 2319, 2: 1457})

Epoch :  47 loss training:  2.1082803650642745 Time :  11178
accuracy train: 0.996768 val: 0.970909 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 41 test accuracy : 0.971689
Counter({0: 3915, 2: 2319, 1: 1457})

Epoch :  48 loss training:  1.6217060305498308 Time :  11248
accuracy train: 0.996566 val: 0.970909 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 41 test accuracy : 0.971689
Counter({1: 3915, 0: 2319, 2: 1457})

Epoch :  49 loss training:  1.858275189078995 Time :  11329
accuracy train: 0.996970 val: 0.970909 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 41 test accuracy : 0.971689
Counter({1: 3915, 0: 2315, 2: 1461})

Epoch :  50 loss training:  1.8794465243408922 Time :  11407
accuracy train: 0.996970 val: 0.969091 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 41 test accuracy : 0.971689
Counter({1: 3915, 2: 2315, 0: 1461})

Epoch :  51 loss training:  1.8106397227820707 Time :  11485
accuracy train: 0.996768 val: 0.972727 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 41 test accuracy : 0.971689
Counter({2: 3915, 0: 2315, 1: 1461})

Epoch :  52 loss training:  1.6709200678233174 Time :  11563
accuracy train: 0.996970 val: 0.972727 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 41 test accuracy : 0.971689
Counter({1: 3915, 0: 2315, 2: 1461})

Epoch :  53 loss training:  1.5879437191906618 Time :  11636
accuracy train: 0.996768 val: 0.974545 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 41 test accuracy : 0.971689
Counter({1: 3915, 0: 2315, 2: 1461})

Epoch :  54 loss training:  1.7803285628251615 Time :  11704
accuracy train: 0.996768 val: 0.972727 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 41 test accuracy : 0.971689
Counter({2: 3915, 0: 2314, 1: 1462})

Epoch :  55 loss training:  1.6550278908471228 Time :  11778
accuracy train: 0.996970 val: 0.970909 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 41 test accuracy : 0.971689
Counter({1: 3915, 0: 2313, 2: 1463})

Epoch :  56 loss training:  1.8023066227397067 Time :  11859
accuracy train: 0.996970 val: 0.972727 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 41 test accuracy : 0.971689
Counter({2: 3915, 0: 2313, 1: 1463})

Epoch :  57 loss training:  2.268228551525681 Time :  11938
accuracy train: 0.996768 val: 0.976364 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({0: 3915, 1: 2313, 2: 1463})

Epoch :  58 loss training:  2.1113014533621026 Time :  12020
accuracy train: 0.996768 val: 0.967273 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({1: 3915, 0: 2311, 2: 1465})

Epoch :  59 loss training:  1.7226327707467135 Time :  12112
accuracy train: 0.996566 val: 0.970909 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({1: 3915, 0: 2311, 2: 1465})

Epoch :  60 loss training:  1.8713629040066735 Time :  12197
accuracy train: 0.996566 val: 0.969091 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({1: 3915, 0: 2310, 2: 1466})

Epoch :  61 loss training:  1.59654987428803 Time :  12275
accuracy train: 0.996970 val: 0.969091 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({1: 3915, 0: 2311, 2: 1465})

Epoch :  62 loss training:  1.363488952469197 Time :  12350
accuracy train: 0.996768 val: 0.970909 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({2: 3915, 0: 2310, 1: 1466})

Epoch :  63 loss training:  1.8859455926140072 Time :  12427
accuracy train: 0.996566 val: 0.969091 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({1: 3915, 0: 2311, 2: 1465})

Epoch :  64 loss training:  1.6028006212363834 Time :  12499
accuracy train: 0.996768 val: 0.969091 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({1: 3915, 0: 2311, 2: 1465})

Epoch :  65 loss training:  1.8153550536953844 Time :  12578
accuracy train: 0.996768 val: 0.969091 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({1: 3915, 0: 2312, 2: 1464})

Epoch :  66 loss training:  1.7136991395163932 Time :  12657
accuracy train: 0.996768 val: 0.965455 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({2: 3915, 0: 2312, 1: 1464})

Epoch :  67 loss training:  1.355366480504017 Time :  12718
accuracy train: 0.996768 val: 0.969091 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({1: 3915, 0: 2312, 2: 1464})

Epoch :  68 loss training:  1.2818943544480135 Time :  12799
accuracy train: 0.996768 val: 0.965455 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({2: 3915, 0: 2312, 1: 1464})

Epoch :  69 loss training:  1.2993684097091318 Time :  12870
accuracy train: 0.996970 val: 0.967273 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({1: 3915, 0: 2312, 2: 1464})

Epoch :  70 loss training:  1.3586794415896293 Time :  12930
accuracy train: 0.996768 val: 0.970909 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({1: 3915, 0: 2312, 2: 1464})

Epoch :  71 loss training:  1.3533217053118278 Time :  13018
accuracy train: 0.996970 val: 0.972727 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({0: 3915, 2: 2312, 1: 1464})

Epoch :  72 loss training:  1.4431803082261467 Time :  13094
accuracy train: 0.996970 val: 0.969091 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({1: 3915, 0: 2311, 2: 1465})

Epoch :  73 loss training:  1.2393364190720604 Time :  13166
accuracy train: 0.996970 val: 0.972727 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({1: 3915, 0: 2310, 2: 1466})

Epoch :  74 loss training:  1.4393281751072209 Time :  13251
accuracy train: 0.996768 val: 0.967273 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({1: 3915, 0: 2311, 2: 1465})

Epoch :  75 loss training:  1.4525812403589953 Time :  13332
accuracy train: 0.997172 val: 0.969091 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({1: 3915, 0: 2311, 2: 1465})

Epoch :  76 loss training:  1.2057616268430138 Time :  13399
accuracy train: 0.996768 val: 0.967273 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({1: 3915, 2: 2311, 0: 1465})

Epoch :  77 loss training:  1.3460373060843267 Time :  13474
accuracy train: 0.997172 val: 0.969091 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({1: 3915, 0: 2311, 2: 1465})

Epoch :  78 loss training:  1.3596149937802693 Time :  13553
accuracy train: 0.997172 val: 0.970909 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({0: 3916, 2: 2311, 1: 1464})

Epoch :  79 loss training:  1.4491353104822338 Time :  13622
accuracy train: 0.996768 val: 0.969091 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({1: 3916, 0: 2311, 2: 1464})

Epoch :  80 loss training:  1.1910473494972393 Time :  13702
accuracy train: 0.996970 val: 0.972727 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({1: 3916, 0: 2311, 2: 1464})

Epoch :  81 loss training:  1.4428802113761776 Time :  13784
accuracy train: 0.996364 val: 0.965455 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({1: 3916, 0: 2311, 2: 1464})

Epoch :  82 loss training:  1.5991425824613543 Time :  13859
accuracy train: 0.997172 val: 0.972727 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({1: 3916, 0: 2311, 2: 1464})

Epoch :  83 loss training:  1.141844376346853 Time :  13934
accuracy train: 0.996970 val: 0.972727 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({1: 3916, 0: 2311, 2: 1464})

Epoch :  84 loss training:  1.2214429022606055 Time :  14012
accuracy train: 0.996970 val: 0.970909 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({1: 3916, 0: 2311, 2: 1464})

Epoch :  85 loss training:  1.1751278997417103 Time :  14084
accuracy train: 0.997172 val: 0.970909 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({1: 3916, 0: 2311, 2: 1464})

Epoch :  86 loss training:  1.2905493100261083 Time :  14160
accuracy train: 0.997172 val: 0.967273 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({1: 3916, 0: 2312, 2: 1463})

Epoch :  87 loss training:  1.5928066324850079 Time :  14241
accuracy train: 0.996970 val: 0.970909 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({2: 3917, 0: 2311, 1: 1463})

Epoch :  88 loss training:  1.38212092124013 Time :  14315
accuracy train: 0.996970 val: 0.967273 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 57 test accuracy : 0.969863
Counter({1: 3917, 0: 2311, 2: 1463})

========================================================================================================================================================================================================
max acc epoch :  57
max validation accuracy :  0.9763636363636363
test accuracy :  0.9698630136986301
last test_accuracy :  0.9698630136986301
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=2, random_vec=False, seed=0, weight_decay=1e-08)
device :  cuda:0
Counter({0: 4233, 1: 2305, 2: 1153})

Epoch :  1 loss training:  50.98218426853418 Time :  14530
accuracy train: 0.926681 val: 0.910909 test: 0.922831
max validation accuracy : 0.910909 max acc epoch : 1 test accuracy : 0.922831
Counter({1: 3599, 0: 2697, 2: 1395})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  23.568114103749394 Time :  14627
accuracy train: 0.964250 val: 0.940000 test: 0.952968
max validation accuracy : 0.940000 max acc epoch : 2 test accuracy : 0.952968
Counter({1: 3696, 0: 2532, 2: 1463})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  17.65937565639615 Time :  14706
accuracy train: 0.966875 val: 0.950909 test: 0.946119
max validation accuracy : 0.950909 max acc epoch : 3 test accuracy : 0.946119
Counter({0: 3792, 1: 2452, 2: 1447})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  13.064057351090014 Time :  14783
accuracy train: 0.980004 val: 0.956364 test: 0.959817
max validation accuracy : 0.956364 max acc epoch : 4 test accuracy : 0.959817
Counter({1: 3777, 0: 2481, 2: 1433})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.84351967764087 Time :  14864
accuracy train: 0.979802 val: 0.960000 test: 0.964840
max validation accuracy : 0.960000 max acc epoch : 5 test accuracy : 0.964840
Counter({1: 3809, 0: 2459, 2: 1423})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.553709985688329 Time :  14926
accuracy train: 0.986063 val: 0.967273 test: 0.972603
max validation accuracy : 0.967273 max acc epoch : 6 test accuracy : 0.972603
Counter({1: 3836, 0: 2428, 2: 1427})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  8.530516175087541 Time :  15002
accuracy train: 0.989497 val: 0.967273 test: 0.969863
max validation accuracy : 0.967273 max acc epoch : 6 test accuracy : 0.972603
Counter({1: 3849, 0: 2416, 2: 1426})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.923265918740071 Time :  15074
accuracy train: 0.989901 val: 0.967273 test: 0.968493
max validation accuracy : 0.967273 max acc epoch : 6 test accuracy : 0.972603
Counter({1: 3874, 0: 2388, 2: 1429})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  7.62371449440252 Time :  15152
accuracy train: 0.991315 val: 0.969091 test: 0.966210
max validation accuracy : 0.969091 max acc epoch : 9 test accuracy : 0.966210
Counter({0: 3885, 1: 2376, 2: 1430})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  6.412475359509699 Time :  15229
accuracy train: 0.990911 val: 0.969091 test: 0.968493
max validation accuracy : 0.969091 max acc epoch : 9 test accuracy : 0.966210
Counter({1: 3885, 0: 2374, 2: 1432})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.589090001769364 Time :  15305
accuracy train: 0.992931 val: 0.967273 test: 0.967580
max validation accuracy : 0.969091 max acc epoch : 9 test accuracy : 0.966210
Counter({1: 3885, 0: 2374, 2: 1432})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  5.424701077747159 Time :  15370
accuracy train: 0.992123 val: 0.969091 test: 0.968950
max validation accuracy : 0.969091 max acc epoch : 9 test accuracy : 0.966210
Counter({1: 3884, 0: 2372, 2: 1435})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  5.340029488434084 Time :  15434
accuracy train: 0.993941 val: 0.970909 test: 0.964840
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.964840
Counter({1: 3886, 0: 2370, 2: 1435})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  5.006906830472872 Time :  15505
accuracy train: 0.992729 val: 0.967273 test: 0.970320
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.964840
Counter({1: 3886, 0: 2370, 2: 1435})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  4.891681602341123 Time :  15579
accuracy train: 0.993941 val: 0.970909 test: 0.964840
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.964840
Counter({1: 3897, 0: 2363, 2: 1431})

Epoch :  16 loss training:  5.006177641218528 Time :  15652
accuracy train: 0.993739 val: 0.969091 test: 0.969406
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.964840
Counter({1: 3896, 0: 2364, 2: 1431})

Epoch :  17 loss training:  4.7951439577154815 Time :  15723
accuracy train: 0.994345 val: 0.970909 test: 0.968037
max validation accuracy : 0.970909 max acc epoch : 13 test accuracy : 0.964840
Counter({1: 3896, 0: 2363, 2: 1432})

Epoch :  18 loss training:  4.509227169677615 Time :  15801
accuracy train: 0.994749 val: 0.974545 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 18 test accuracy : 0.969863
Counter({1: 3902, 2: 2358, 0: 1431})

Epoch :  19 loss training:  4.023541461734567 Time :  15872
accuracy train: 0.994749 val: 0.972727 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 18 test accuracy : 0.969863
Counter({1: 3902, 0: 2358, 2: 1431})

Epoch :  20 loss training:  3.641586840036325 Time :  15945
accuracy train: 0.994951 val: 0.974545 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 18 test accuracy : 0.969863
Counter({1: 3904, 2: 2354, 0: 1433})

Epoch :  21 loss training:  4.154632281046361 Time :  16016
accuracy train: 0.994951 val: 0.972727 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 18 test accuracy : 0.969863
Counter({1: 3903, 0: 2354, 2: 1434})

Epoch :  22 loss training:  4.066027768247295 Time :  16083
accuracy train: 0.995152 val: 0.970909 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 18 test accuracy : 0.969863
Counter({1: 3903, 2: 2354, 0: 1434})

Epoch :  23 loss training:  4.114471251377836 Time :  16153
accuracy train: 0.995758 val: 0.970909 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 18 test accuracy : 0.969863
Counter({2: 3908, 0: 2352, 1: 1431})

Epoch :  24 loss training:  3.3268283832876477 Time :  16216
accuracy train: 0.995354 val: 0.974545 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 18 test accuracy : 0.969863
Counter({1: 3910, 0: 2349, 2: 1432})

Epoch :  25 loss training:  3.634040545555763 Time :  16290
accuracy train: 0.995556 val: 0.974545 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 18 test accuracy : 0.969863
Counter({1: 3910, 0: 2349, 2: 1432})

Epoch :  26 loss training:  3.7036699964664876 Time :  16358
accuracy train: 0.995758 val: 0.974545 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 18 test accuracy : 0.969863
Counter({1: 3911, 0: 2347, 2: 1433})

Epoch :  27 loss training:  3.224397065117955 Time :  16429
accuracy train: 0.995152 val: 0.970909 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 18 test accuracy : 0.969863
Counter({1: 3911, 2: 2345, 0: 1435})

Epoch :  28 loss training:  2.8031557656358927 Time :  16501
accuracy train: 0.995556 val: 0.969091 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 18 test accuracy : 0.969863
Counter({1: 3911, 0: 2344, 2: 1436})

Epoch :  29 loss training:  3.2759987709578127 Time :  16566
accuracy train: 0.995758 val: 0.974545 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 18 test accuracy : 0.969863
Counter({1: 3914, 0: 2342, 2: 1435})

Epoch :  30 loss training:  2.8710925998166203 Time :  16633
accuracy train: 0.995556 val: 0.972727 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 18 test accuracy : 0.969863
Counter({2: 3915, 0: 2341, 1: 1435})

Epoch :  31 loss training:  2.6908035642118193 Time :  16700
accuracy train: 0.996162 val: 0.970909 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 18 test accuracy : 0.969863
Counter({2: 3915, 1: 2340, 0: 1436})

Epoch :  32 loss training:  2.9607524850580376 Time :  16776
accuracy train: 0.995960 val: 0.974545 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 18 test accuracy : 0.969863
Counter({1: 3915, 0: 2336, 2: 1440})

Epoch :  33 loss training:  2.5652390299947 Time :  16852
accuracy train: 0.995960 val: 0.972727 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 18 test accuracy : 0.969863
Counter({1: 3915, 0: 2335, 2: 1441})

Epoch :  34 loss training:  2.7321811474394053 Time :  16928
accuracy train: 0.995556 val: 0.972727 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 18 test accuracy : 0.969863
Counter({2: 3915, 0: 2335, 1: 1441})

Epoch :  35 loss training:  2.52686428175366 Time :  16986
accuracy train: 0.996162 val: 0.969091 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 18 test accuracy : 0.969863
Counter({2: 3920, 0: 2331, 1: 1440})

Epoch :  36 loss training:  2.476796672795899 Time :  17052
accuracy train: 0.996364 val: 0.969091 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 18 test accuracy : 0.969863
Counter({2: 3920, 0: 2330, 1: 1441})

Epoch :  37 loss training:  2.2803898695419775 Time :  17124
accuracy train: 0.996364 val: 0.972727 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 18 test accuracy : 0.969863
Counter({2: 3920, 0: 2328, 1: 1443})

Epoch :  38 loss training:  2.2970488824503263 Time :  17195
accuracy train: 0.996768 val: 0.974545 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 18 test accuracy : 0.969863
Counter({1: 3920, 2: 2328, 0: 1443})

Epoch :  39 loss training:  2.457753185357433 Time :  17255
accuracy train: 0.996768 val: 0.970909 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 18 test accuracy : 0.969863
Counter({1: 3921, 0: 2323, 2: 1447})

Epoch :  40 loss training:  2.1784378763113637 Time :  17325
accuracy train: 0.996566 val: 0.967273 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 18 test accuracy : 0.969863
Counter({2: 3921, 0: 2322, 1: 1448})

Epoch :  41 loss training:  2.0523136036354117 Time :  17400
accuracy train: 0.996768 val: 0.972727 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 18 test accuracy : 0.969863
Counter({0: 3921, 2: 2322, 1: 1448})

Epoch :  42 loss training:  2.765799525732291 Time :  17462
accuracy train: 0.996566 val: 0.970909 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 18 test accuracy : 0.969863
Counter({1: 3921, 2: 2321, 0: 1449})

Epoch :  43 loss training:  2.2670072510663886 Time :  17530
accuracy train: 0.996768 val: 0.974545 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 18 test accuracy : 0.969863
Counter({1: 3921, 0: 2321, 2: 1449})

Epoch :  44 loss training:  1.9697544538212242 Time :  17598
accuracy train: 0.996768 val: 0.976364 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 44 test accuracy : 0.970776
Counter({1: 3922, 0: 2320, 2: 1449})

Epoch :  45 loss training:  1.8883354619611055 Time :  17663
accuracy train: 0.996768 val: 0.970909 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 44 test accuracy : 0.970776
Counter({2: 3922, 0: 2320, 1: 1449})

Epoch :  46 loss training:  2.1593478675786173 Time :  17727
accuracy train: 0.996566 val: 0.976364 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 44 test accuracy : 0.970776
Counter({2: 3922, 0: 2321, 1: 1448})

Epoch :  47 loss training:  2.590271742810728 Time :  17791
accuracy train: 0.996768 val: 0.972727 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 44 test accuracy : 0.970776
Counter({1: 3922, 0: 2321, 2: 1448})

Epoch :  48 loss training:  1.7856934208102757 Time :  17859
accuracy train: 0.996566 val: 0.974545 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 44 test accuracy : 0.970776
Counter({1: 3922, 0: 2319, 2: 1450})

Epoch :  49 loss training:  1.8183311067841714 Time :  17925
accuracy train: 0.996970 val: 0.974545 test: 0.974429
max validation accuracy : 0.976364 max acc epoch : 44 test accuracy : 0.970776
Counter({1: 3920, 0: 2320, 2: 1451})

Epoch :  50 loss training:  1.8315968358438113 Time :  17985
accuracy train: 0.996768 val: 0.969091 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 44 test accuracy : 0.970776
Counter({1: 3920, 0: 2320, 2: 1451})

Epoch :  51 loss training:  1.9066820401931182 Time :  18068
accuracy train: 0.996768 val: 0.972727 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 44 test accuracy : 0.970776
Counter({1: 3920, 0: 2318, 2: 1453})

Epoch :  52 loss training:  1.93936293508159 Time :  18146
accuracy train: 0.996768 val: 0.974545 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 44 test accuracy : 0.970776
Counter({1: 3922, 0: 2317, 2: 1452})

Epoch :  53 loss training:  1.7212471737584565 Time :  18232
accuracy train: 0.996768 val: 0.972727 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 44 test accuracy : 0.970776
Counter({1: 3923, 0: 2317, 2: 1451})

Epoch :  54 loss training:  1.7968319684296148 Time :  18303
accuracy train: 0.996970 val: 0.972727 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 44 test accuracy : 0.970776
Counter({2: 3923, 0: 2317, 1: 1451})

Epoch :  55 loss training:  1.745285488133959 Time :  18374
accuracy train: 0.996970 val: 0.970909 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 44 test accuracy : 0.970776
Counter({1: 3923, 2: 2317, 0: 1451})

Epoch :  56 loss training:  1.7535531230532797 Time :  18448
accuracy train: 0.996970 val: 0.970909 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 44 test accuracy : 0.970776
Counter({1: 3923, 0: 2315, 2: 1453})

Epoch :  57 loss training:  2.117228162831452 Time :  18511
accuracy train: 0.996970 val: 0.978182 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({0: 3922, 1: 2314, 2: 1455})

Epoch :  58 loss training:  2.4769677288713865 Time :  18579
accuracy train: 0.996566 val: 0.970909 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({2: 3922, 0: 2315, 1: 1454})

Epoch :  59 loss training:  1.7130631303589325 Time :  18650
accuracy train: 0.996566 val: 0.974545 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({0: 3922, 1: 2314, 2: 1455})

Epoch :  60 loss training:  1.9224776879418641 Time :  18716
accuracy train: 0.996970 val: 0.969091 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({1: 3922, 0: 2313, 2: 1456})

Epoch :  61 loss training:  1.5578993792660185 Time :  18779
accuracy train: 0.996768 val: 0.970909 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({1: 3922, 0: 2312, 2: 1457})

Epoch :  62 loss training:  1.4149904099758714 Time :  18854
accuracy train: 0.997172 val: 0.974545 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({1: 3922, 0: 2313, 2: 1456})

Epoch :  63 loss training:  1.8135562152674538 Time :  18913
accuracy train: 0.996768 val: 0.974545 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({1: 3922, 0: 2313, 2: 1456})

Epoch :  64 loss training:  1.6854187598000863 Time :  18979
accuracy train: 0.996970 val: 0.967273 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({1: 3922, 0: 2313, 2: 1456})

Epoch :  65 loss training:  1.53266806602187 Time :  19057
accuracy train: 0.996970 val: 0.967273 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({1: 3922, 0: 2313, 2: 1456})

Epoch :  66 loss training:  1.5731478548477753 Time :  19130
accuracy train: 0.996970 val: 0.967273 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({1: 3922, 0: 2313, 2: 1456})

Epoch :  67 loss training:  1.3446475864948297 Time :  19206
accuracy train: 0.996970 val: 0.969091 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({1: 3922, 0: 2313, 2: 1456})

Epoch :  68 loss training:  1.2986748948023887 Time :  19286
accuracy train: 0.996970 val: 0.967273 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({1: 3922, 0: 2313, 2: 1456})

Epoch :  69 loss training:  1.3889097453502472 Time :  19359
accuracy train: 0.996768 val: 0.967273 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({1: 3922, 0: 2313, 2: 1456})

Epoch :  70 loss training:  1.4634387417318067 Time :  19421
accuracy train: 0.996970 val: 0.969091 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({2: 3922, 0: 2313, 1: 1456})

Epoch :  71 loss training:  1.2681569279302494 Time :  19495
accuracy train: 0.997172 val: 0.970909 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({1: 3922, 2: 2313, 0: 1456})

Epoch :  72 loss training:  1.4891273549037578 Time :  19570
accuracy train: 0.996970 val: 0.970909 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({1: 3922, 0: 2313, 2: 1456})

Epoch :  73 loss training:  1.3013652586087119 Time :  19630
accuracy train: 0.996768 val: 0.970909 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({1: 3922, 0: 2311, 2: 1458})

Epoch :  74 loss training:  1.35797322421422 Time :  19696
accuracy train: 0.996970 val: 0.969091 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({1: 3922, 0: 2312, 2: 1457})

Epoch :  75 loss training:  1.5030402347183554 Time :  19766
accuracy train: 0.997172 val: 0.970909 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({0: 3922, 1: 2312, 2: 1457})

Epoch :  76 loss training:  1.2387456424039556 Time :  19833
accuracy train: 0.996970 val: 0.965455 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({1: 3922, 0: 2311, 2: 1458})

Epoch :  77 loss training:  1.34578585352574 Time :  19901
accuracy train: 0.997172 val: 0.969091 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({1: 3922, 0: 2312, 2: 1457})

Epoch :  78 loss training:  1.4332385613233782 Time :  19971
accuracy train: 0.997172 val: 0.967273 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({1: 3922, 0: 2312, 2: 1457})

Epoch :  79 loss training:  1.4266252672568953 Time :  20038
accuracy train: 0.996970 val: 0.965455 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({1: 3923, 0: 2311, 2: 1457})

Epoch :  80 loss training:  1.1414801413775422 Time :  20103
accuracy train: 0.997172 val: 0.970909 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({1: 3923, 0: 2310, 2: 1458})

Epoch :  81 loss training:  1.4871858865662944 Time :  20175
accuracy train: 0.997172 val: 0.969091 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({1: 3923, 0: 2310, 2: 1458})

Epoch :  82 loss training:  1.5286533656471875 Time :  20246
accuracy train: 0.997172 val: 0.969091 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({1: 3923, 0: 2311, 2: 1457})

Epoch :  83 loss training:  1.231313134498123 Time :  20311
accuracy train: 0.997374 val: 0.969091 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({1: 3923, 2: 2311, 0: 1457})

Epoch :  84 loss training:  1.400893025285768 Time :  20385
accuracy train: 0.997172 val: 0.969091 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({1: 3923, 0: 2311, 2: 1457})

Epoch :  85 loss training:  1.2133455176226562 Time :  20455
accuracy train: 0.996970 val: 0.967273 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({1: 3923, 0: 2311, 2: 1457})

Epoch :  86 loss training:  1.2937954537337646 Time :  20522
accuracy train: 0.996970 val: 0.969091 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({0: 3923, 1: 2312, 2: 1456})

Epoch :  87 loss training:  1.2890802493493538 Time :  20587
accuracy train: 0.997172 val: 0.970909 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({1: 3923, 0: 2312, 2: 1456})

Epoch :  88 loss training:  1.2927122145192698 Time :  20657
accuracy train: 0.997374 val: 0.970909 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 57 test accuracy : 0.973059
Counter({1: 3923, 0: 2312, 2: 1456})

========================================================================================================================================================================================================
max acc epoch :  57
max validation accuracy :  0.9781818181818182
test accuracy :  0.9730593607305936
last test_accuracy :  0.971689497716895
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.97818 	 test_accuracy : 0.96667 	 max_acc epoch :  14 	 last test_accuracy : 0.96804
k :  1 	 val_accuracy : 0.97455 	 test_accuracy : 0.96621 	 max_acc epoch :  14 	 last test_accuracy : 0.97078
k :  2 	 val_accuracy : 0.97636 	 test_accuracy : 0.96986 	 max_acc epoch :  57 	 last test_accuracy : 0.96986
k :  3 	 val_accuracy : 0.97818 	 test_accuracy : 0.97306 	 max_acc epoch :  57 	 last test_accuracy : 0.97169

avg :  	 val_accuracy : 0.97682 	 test_accuracy : 0.96895 	 last_accuracy : 0.97009


date and time :  Wed May 26 05:39:50 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=4, num_mlp_layers=1, random_vec=False, seed=84, weight_decay=1e-08)
device :  cuda:0
Counter({1: 4230, 2: 2303, 0: 1158})

Epoch :  1 loss training:  43.3627374432981 Time :  150
accuracy train: 0.937588 val: 0.929091 test: 0.950685
max validation accuracy : 0.929091 max acc epoch : 1 test accuracy : 0.950685
Counter({0: 3496, 1: 2457, 2: 1738})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  21.31824546214193 Time :  245
accuracy train: 0.967481 val: 0.956364 test: 0.957534
max validation accuracy : 0.956364 max acc epoch : 2 test accuracy : 0.957534
Counter({0: 3659, 1: 2534, 2: 1498})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  17.955968599766493 Time :  349
accuracy train: 0.975157 val: 0.978182 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 3 test accuracy : 0.968950
Counter({1: 3698, 2: 2521, 0: 1472})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.932748443912715 Time :  429
accuracy train: 0.979802 val: 0.974545 test: 0.964384
max validation accuracy : 0.978182 max acc epoch : 3 test accuracy : 0.968950
Counter({0: 3722, 1: 2507, 2: 1462})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.874823931138963 Time :  511
accuracy train: 0.984650 val: 0.983636 test: 0.970320
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({1: 3805, 2: 2484, 0: 1402})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.404223611811176 Time :  587
accuracy train: 0.979398 val: 0.967273 test: 0.963470
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({1: 3821, 2: 2373, 0: 1497})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.732947893673554 Time :  669
accuracy train: 0.986669 val: 0.981818 test: 0.965753
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3832, 1: 2364, 2: 1495})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.780065094819292 Time :  759
accuracy train: 0.989093 val: 0.978182 test: 0.968493
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3840, 2: 2361, 1: 1490})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.752106480416842 Time :  837
accuracy train: 0.985256 val: 0.967273 test: 0.964384
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3849, 2: 2354, 1: 1488})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.798040207591839 Time :  919
accuracy train: 0.991921 val: 0.978182 test: 0.968493
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3854, 2: 2351, 1: 1486})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.334710248862393 Time :  1005
accuracy train: 0.992123 val: 0.974545 test: 0.967123
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3859, 1: 2348, 2: 1484})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.40584393707104 Time :  1091
accuracy train: 0.992527 val: 0.976364 test: 0.968493
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({2: 3859, 1: 2348, 0: 1484})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  4.7668105302145705 Time :  1178
accuracy train: 0.993941 val: 0.980000 test: 0.968037
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3862, 2: 2346, 1: 1483})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.6198908885126 Time :  1256
accuracy train: 0.993941 val: 0.978182 test: 0.968493
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({1: 3864, 2: 2343, 0: 1484})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  4.709247920254711 Time :  1331
accuracy train: 0.993537 val: 0.978182 test: 0.966667
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3869, 2: 2340, 1: 1482})

Epoch :  16 loss training:  4.496793336351402 Time :  1409
accuracy train: 0.994345 val: 0.978182 test: 0.968037
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3869, 1: 2339, 2: 1483})

Epoch :  17 loss training:  4.051045905682258 Time :  1486
accuracy train: 0.993739 val: 0.978182 test: 0.970776
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({1: 3870, 2: 2337, 0: 1484})

Epoch :  18 loss training:  4.375419885502197 Time :  1565
accuracy train: 0.994345 val: 0.980000 test: 0.967580
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({1: 3873, 0: 2334, 2: 1484})

Epoch :  19 loss training:  4.315564518212341 Time :  1645
accuracy train: 0.994345 val: 0.980000 test: 0.970320
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3877, 2: 2333, 1: 1481})

Epoch :  20 loss training:  3.860108014778234 Time :  1725
accuracy train: 0.994951 val: 0.980000 test: 0.967580
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({1: 3881, 2: 2332, 0: 1478})

Epoch :  21 loss training:  3.50211888353806 Time :  1807
accuracy train: 0.994749 val: 0.980000 test: 0.969406
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({1: 3888, 2: 2327, 0: 1476})

Epoch :  22 loss training:  3.4328717800817685 Time :  1883
accuracy train: 0.994951 val: 0.981818 test: 0.970320
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3890, 1: 2325, 2: 1476})

Epoch :  23 loss training:  3.512260048650205 Time :  1967
accuracy train: 0.995152 val: 0.983636 test: 0.968950
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3891, 1: 2324, 2: 1476})

Epoch :  24 loss training:  3.3277216885471717 Time :  2050
accuracy train: 0.995354 val: 0.978182 test: 0.968493
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3895, 2: 2322, 1: 1474})

Epoch :  25 loss training:  3.4134818168822676 Time :  2130
accuracy train: 0.994749 val: 0.974545 test: 0.968037
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3895, 2: 2322, 1: 1474})

Epoch :  26 loss training:  3.0967382868402638 Time :  2212
accuracy train: 0.995354 val: 0.980000 test: 0.972146
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3896, 2: 2322, 1: 1473})

Epoch :  27 loss training:  2.97877834920655 Time :  2292
accuracy train: 0.995960 val: 0.980000 test: 0.970776
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3902, 2: 2321, 1: 1468})

Epoch :  28 loss training:  2.7355846204445697 Time :  2364
accuracy train: 0.996162 val: 0.980000 test: 0.970776
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3909, 2: 2318, 1: 1464})

Epoch :  29 loss training:  2.966899606748484 Time :  2444
accuracy train: 0.995758 val: 0.976364 test: 0.967580
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3911, 2: 2312, 1: 1468})

Epoch :  30 loss training:  2.964130171574652 Time :  2528
accuracy train: 0.995960 val: 0.978182 test: 0.971689
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3911, 2: 2310, 1: 1470})

Epoch :  31 loss training:  2.7519128204439767 Time :  2607
accuracy train: 0.995758 val: 0.976364 test: 0.972603
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({1: 3911, 0: 2310, 2: 1470})

Epoch :  32 loss training:  2.8067125299712643 Time :  2688
accuracy train: 0.996566 val: 0.976364 test: 0.969406
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({1: 3911, 2: 2310, 0: 1470})

Epoch :  33 loss training:  2.6175218642456457 Time :  2766
accuracy train: 0.995758 val: 0.978182 test: 0.967123
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3910, 2: 2311, 1: 1470})

Epoch :  34 loss training:  2.59870438138023 Time :  2844
accuracy train: 0.996364 val: 0.978182 test: 0.967580
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3910, 2: 2311, 1: 1470})

Epoch :  35 loss training:  2.7055105355684645 Time :  2921
accuracy train: 0.995758 val: 0.976364 test: 0.970776
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({2: 3915, 1: 2310, 0: 1466})

Epoch :  36 loss training:  2.4391437863814645 Time :  3002
accuracy train: 0.996162 val: 0.978182 test: 0.969406
max validation accuracy : 0.983636 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3916, 1: 2310, 2: 1465})

========================================================================================================================================================================================================
max acc epoch :  5
max validation accuracy :  0.9836363636363636
test accuracy :  0.9703196347031964
last test_accuracy :  0.9694063926940639
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=4, num_mlp_layers=1, random_vec=False, seed=84, weight_decay=1e-08)
device :  cuda:0
Counter({1: 4230, 2: 2303, 0: 1158})

Epoch :  1 loss training:  43.325086396187544 Time :  3176
accuracy train: 0.935771 val: 0.927273 test: 0.950228
max validation accuracy : 0.927273 max acc epoch : 1 test accuracy : 0.950228
Counter({1: 3507, 0: 2496, 2: 1688})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  20.68484920822084 Time :  3263
accuracy train: 0.970511 val: 0.949091 test: 0.957991
max validation accuracy : 0.949091 max acc epoch : 2 test accuracy : 0.957991
Counter({0: 3715, 1: 2441, 2: 1535})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  17.79642985202372 Time :  3371
accuracy train: 0.977782 val: 0.978182 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 3 test accuracy : 0.969406
Counter({1: 3757, 0: 2454, 2: 1480})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  12.180214311927557 Time :  3455
accuracy train: 0.979802 val: 0.972727 test: 0.963927
max validation accuracy : 0.978182 max acc epoch : 3 test accuracy : 0.969406
Counter({0: 3777, 2: 2522, 1: 1392})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.630785224959254 Time :  3545
accuracy train: 0.985256 val: 0.976364 test: 0.963927
max validation accuracy : 0.978182 max acc epoch : 3 test accuracy : 0.969406
Counter({2: 3800, 1: 2519, 0: 1372})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.39604791183956 Time :  3641
accuracy train: 0.983236 val: 0.969091 test: 0.960274
max validation accuracy : 0.978182 max acc epoch : 3 test accuracy : 0.969406
Counter({1: 3817, 2: 2511, 0: 1363})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.723841411061585 Time :  3730
accuracy train: 0.986265 val: 0.978182 test: 0.962557
max validation accuracy : 0.978182 max acc epoch : 3 test accuracy : 0.969406
Counter({0: 3819, 2: 2504, 1: 1368})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  7.373039829544723 Time :  3819
accuracy train: 0.989093 val: 0.970909 test: 0.966210
max validation accuracy : 0.978182 max acc epoch : 3 test accuracy : 0.969406
Counter({0: 3818, 1: 2506, 2: 1367})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.1974039083579555 Time :  3898
accuracy train: 0.984650 val: 0.963636 test: 0.965297
max validation accuracy : 0.978182 max acc epoch : 3 test accuracy : 0.969406
Counter({0: 3835, 1: 2489, 2: 1367})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  6.1224209211650304 Time :  3974
accuracy train: 0.991113 val: 0.978182 test: 0.964840
max validation accuracy : 0.978182 max acc epoch : 3 test accuracy : 0.969406
Counter({1: 3835, 2: 2487, 0: 1369})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.608525368734263 Time :  4055
accuracy train: 0.992527 val: 0.974545 test: 0.966667
max validation accuracy : 0.978182 max acc epoch : 3 test accuracy : 0.969406
Counter({0: 3845, 1: 2479, 2: 1367})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.678428308805451 Time :  4134
accuracy train: 0.992325 val: 0.978182 test: 0.963927
max validation accuracy : 0.978182 max acc epoch : 3 test accuracy : 0.969406
Counter({0: 3864, 1: 2462, 2: 1365})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  4.611670223996043 Time :  4217
accuracy train: 0.993133 val: 0.980000 test: 0.967123
max validation accuracy : 0.980000 max acc epoch : 13 test accuracy : 0.967123
Counter({0: 3866, 1: 2463, 2: 1362})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.722283016657457 Time :  4303
accuracy train: 0.993537 val: 0.980000 test: 0.967580
max validation accuracy : 0.980000 max acc epoch : 13 test accuracy : 0.967123
Counter({0: 3866, 1: 2461, 2: 1364})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  4.748106341343373 Time :  4396
accuracy train: 0.993133 val: 0.980000 test: 0.966667
max validation accuracy : 0.980000 max acc epoch : 13 test accuracy : 0.967123
Counter({1: 3867, 0: 2460, 2: 1364})

Epoch :  16 loss training:  4.5834638982778415 Time :  4486
accuracy train: 0.993739 val: 0.981818 test: 0.966667
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.966667
Counter({0: 3868, 1: 2459, 2: 1364})

Epoch :  17 loss training:  3.906598318950273 Time :  4578
accuracy train: 0.993739 val: 0.981818 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.966667
Counter({0: 3869, 2: 2457, 1: 1365})

Epoch :  18 loss training:  4.404783215140924 Time :  4663
accuracy train: 0.993739 val: 0.978182 test: 0.964840
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.966667
Counter({1: 3875, 2: 2451, 0: 1365})

Epoch :  19 loss training:  4.1219196455786005 Time :  4745
accuracy train: 0.994345 val: 0.980000 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.966667
Counter({1: 3887, 2: 2378, 0: 1426})

Epoch :  20 loss training:  3.7313536184374243 Time :  4850
accuracy train: 0.994345 val: 0.980000 test: 0.966667
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.966667
Counter({1: 3894, 2: 2373, 0: 1424})

Epoch :  21 loss training:  3.702492106705904 Time :  4928
accuracy train: 0.994345 val: 0.980000 test: 0.965753
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.966667
Counter({1: 3905, 2: 2366, 0: 1420})

Epoch :  22 loss training:  3.423862156443647 Time :  5017
accuracy train: 0.994749 val: 0.981818 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 16 test accuracy : 0.966667
Counter({1: 3906, 0: 2365, 2: 1420})

Epoch :  23 loss training:  3.535951643367298 Time :  5102
accuracy train: 0.994749 val: 0.983636 test: 0.969863
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({0: 3907, 1: 2365, 2: 1419})

Epoch :  24 loss training:  3.4958680706331506 Time :  5184
accuracy train: 0.994951 val: 0.980000 test: 0.965753
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({0: 3907, 2: 2365, 1: 1419})

Epoch :  25 loss training:  3.583385593141429 Time :  5262
accuracy train: 0.993941 val: 0.978182 test: 0.968493
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({0: 3907, 1: 2365, 2: 1419})

Epoch :  26 loss training:  3.1047570786904544 Time :  5346
accuracy train: 0.994951 val: 0.983636 test: 0.970776
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({0: 3908, 1: 2365, 2: 1418})

Epoch :  27 loss training:  3.160174798569642 Time :  5432
accuracy train: 0.995152 val: 0.981818 test: 0.969406
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({0: 3912, 1: 2362, 2: 1417})

Epoch :  28 loss training:  2.9227419405942783 Time :  5524
accuracy train: 0.995152 val: 0.981818 test: 0.970320
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({0: 3913, 1: 2359, 2: 1419})

Epoch :  29 loss training:  2.9416639471892267 Time :  5619
accuracy train: 0.994951 val: 0.981818 test: 0.966210
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({0: 3916, 2: 2330, 1: 1445})

Epoch :  30 loss training:  2.835423390264623 Time :  5717
accuracy train: 0.995960 val: 0.981818 test: 0.970320
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({0: 3918, 2: 2327, 1: 1446})

Epoch :  31 loss training:  2.6212482102564536 Time :  5806
accuracy train: 0.995960 val: 0.981818 test: 0.971689
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({0: 3918, 1: 2327, 2: 1446})

Epoch :  32 loss training:  2.742795780301094 Time :  5884
accuracy train: 0.996162 val: 0.981818 test: 0.970320
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({0: 3918, 1: 2327, 2: 1446})

Epoch :  33 loss training:  2.510769314976642 Time :  5970
accuracy train: 0.995960 val: 0.978182 test: 0.967580
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({1: 3919, 2: 2326, 0: 1446})

Epoch :  34 loss training:  2.607538260926958 Time :  6057
accuracy train: 0.995960 val: 0.981818 test: 0.968493
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({0: 3921, 2: 2325, 1: 1445})

Epoch :  35 loss training:  2.681626920821145 Time :  6149
accuracy train: 0.996364 val: 0.980000 test: 0.968950
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({1: 3922, 2: 2324, 0: 1445})

Epoch :  36 loss training:  2.3373165001685265 Time :  6233
accuracy train: 0.996364 val: 0.983636 test: 0.968037
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({0: 3922, 1: 2324, 2: 1445})

Epoch :  37 loss training:  2.2802470051683486 Time :  6316
accuracy train: 0.995556 val: 0.983636 test: 0.966210
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({1: 3922, 2: 2324, 0: 1445})

Epoch :  38 loss training:  2.300854414119385 Time :  6393
accuracy train: 0.996364 val: 0.983636 test: 0.970776
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({0: 3922, 2: 2324, 1: 1445})

Epoch :  39 loss training:  2.1897082155337557 Time :  6463
accuracy train: 0.996162 val: 0.981818 test: 0.969406
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({0: 3923, 1: 2323, 2: 1445})

Epoch :  40 loss training:  2.095987000997411 Time :  6541
accuracy train: 0.995960 val: 0.983636 test: 0.967580
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({0: 3923, 1: 2323, 2: 1445})

Epoch :  41 loss training:  1.985921277460875 Time :  6622
accuracy train: 0.995758 val: 0.978182 test: 0.968037
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({1: 3924, 2: 2322, 0: 1445})

Epoch :  42 loss training:  2.034856016107369 Time :  6716
accuracy train: 0.996162 val: 0.983636 test: 0.969863
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({1: 3924, 0: 2322, 2: 1445})

Epoch :  43 loss training:  2.0104428895865567 Time :  6798
accuracy train: 0.996566 val: 0.981818 test: 0.967123
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({0: 3924, 2: 2320, 1: 1447})

Epoch :  44 loss training:  1.9376468416303396 Time :  6880
accuracy train: 0.995556 val: 0.981818 test: 0.966667
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({1: 3924, 0: 2320, 2: 1447})

Epoch :  45 loss training:  1.9887182222155388 Time :  6959
accuracy train: 0.996768 val: 0.983636 test: 0.968950
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({1: 3924, 0: 2316, 2: 1451})

Epoch :  46 loss training:  1.7005147663585376 Time :  7049
accuracy train: 0.996364 val: 0.983636 test: 0.971689
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({0: 3924, 1: 2312, 2: 1455})

Epoch :  47 loss training:  1.9459262408781797 Time :  7140
accuracy train: 0.996566 val: 0.983636 test: 0.966667
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({0: 3924, 2: 2311, 1: 1456})

Epoch :  48 loss training:  1.5935210963943973 Time :  7217
accuracy train: 0.997172 val: 0.981818 test: 0.968950
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({1: 3924, 0: 2311, 2: 1456})

Epoch :  49 loss training:  1.5734126228198875 Time :  7301
accuracy train: 0.996364 val: 0.983636 test: 0.969406
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({0: 3924, 2: 2311, 1: 1456})

Epoch :  50 loss training:  1.70875513413921 Time :  7381
accuracy train: 0.996768 val: 0.983636 test: 0.969406
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({0: 3925, 1: 2306, 2: 1460})

Epoch :  51 loss training:  1.7456818763457704 Time :  7457
accuracy train: 0.996566 val: 0.978182 test: 0.968037
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({0: 3927, 1: 2305, 2: 1459})

Epoch :  52 loss training:  1.5909443523341906 Time :  7542
accuracy train: 0.996768 val: 0.981818 test: 0.969863
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({0: 3927, 2: 2305, 1: 1459})

Epoch :  53 loss training:  1.5802210987894796 Time :  7618
accuracy train: 0.997172 val: 0.981818 test: 0.970776
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({0: 3927, 2: 2305, 1: 1459})

Epoch :  54 loss training:  1.76651253644377 Time :  7707
accuracy train: 0.997172 val: 0.981818 test: 0.972146
max validation accuracy : 0.983636 max acc epoch : 23 test accuracy : 0.969863
Counter({0: 3927, 1: 2303, 2: 1461})

========================================================================================================================================================================================================
max acc epoch :  23
max validation accuracy :  0.9836363636363636
test accuracy :  0.9698630136986301
last test_accuracy :  0.9721461187214612
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=4, num_mlp_layers=1, random_vec=False, seed=84, weight_decay=1e-08)
device :  cuda:0
Counter({1: 4230, 2: 2303, 0: 1158})

Epoch :  1 loss training:  43.53083397448063 Time :  7897
accuracy train: 0.936376 val: 0.930909 test: 0.951598
max validation accuracy : 0.930909 max acc epoch : 1 test accuracy : 0.951598
Counter({1: 3536, 0: 2484, 2: 1671})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  21.155452740378678 Time :  7991
accuracy train: 0.970107 val: 0.949091 test: 0.952968
max validation accuracy : 0.949091 max acc epoch : 2 test accuracy : 0.952968
Counter({0: 3683, 2: 2445, 1: 1563})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.29388326499611 Time :  8092
accuracy train: 0.978792 val: 0.972727 test: 0.968950
max validation accuracy : 0.972727 max acc epoch : 3 test accuracy : 0.968950
Counter({1: 3716, 2: 2420, 0: 1555})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.382882168982178 Time :  8170
accuracy train: 0.982024 val: 0.974545 test: 0.967123
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.967123
Counter({0: 3752, 1: 2400, 2: 1539})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.716364996507764 Time :  8253
accuracy train: 0.986265 val: 0.978182 test: 0.964384
max validation accuracy : 0.978182 max acc epoch : 5 test accuracy : 0.964384
Counter({0: 3820, 2: 2380, 1: 1491})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.271028525428846 Time :  8340
accuracy train: 0.981014 val: 0.963636 test: 0.959817
max validation accuracy : 0.978182 max acc epoch : 5 test accuracy : 0.964384
Counter({0: 3828, 1: 2383, 2: 1480})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.4336674611549824 Time :  8429
accuracy train: 0.987679 val: 0.980000 test: 0.962557
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.962557
Counter({0: 3831, 1: 2380, 2: 1480})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.626611365121789 Time :  8520
accuracy train: 0.988689 val: 0.974545 test: 0.968493
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.962557
Counter({1: 3844, 2: 2367, 0: 1480})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.777204759186134 Time :  8606
accuracy train: 0.985457 val: 0.965455 test: 0.964384
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.962557
Counter({0: 3855, 1: 2359, 2: 1477})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.744430876569822 Time :  8693
accuracy train: 0.991315 val: 0.976364 test: 0.967123
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.962557
Counter({0: 3866, 1: 2352, 2: 1473})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.193046631873585 Time :  8781
accuracy train: 0.991719 val: 0.976364 test: 0.967580
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.962557
Counter({0: 3868, 2: 2349, 1: 1474})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.461483070394024 Time :  8866
accuracy train: 0.992931 val: 0.980000 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.962557
Counter({0: 3868, 2: 2349, 1: 1474})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  4.626189947943203 Time :  8948
accuracy train: 0.994143 val: 0.974545 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.962557
Counter({0: 3869, 1: 2348, 2: 1474})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.694405583431944 Time :  9027
accuracy train: 0.993537 val: 0.976364 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.962557
Counter({0: 3870, 2: 2346, 1: 1475})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  4.744573455187492 Time :  9105
accuracy train: 0.993133 val: 0.980000 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.962557
Counter({0: 3875, 2: 2345, 1: 1471})

Epoch :  16 loss training:  4.285072491271421 Time :  9185
accuracy train: 0.993739 val: 0.980000 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.962557
Counter({0: 3875, 1: 2345, 2: 1471})

Epoch :  17 loss training:  3.87441687064711 Time :  9265
accuracy train: 0.993335 val: 0.974545 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.962557
Counter({0: 3877, 2: 2341, 1: 1473})

Epoch :  18 loss training:  4.365010517940391 Time :  9347
accuracy train: 0.993335 val: 0.980000 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.962557
Counter({0: 3882, 1: 2337, 2: 1472})

Epoch :  19 loss training:  4.07866636198014 Time :  9439
accuracy train: 0.994345 val: 0.980000 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.962557
Counter({1: 3888, 2: 2330, 0: 1473})

Epoch :  20 loss training:  3.6897573162568733 Time :  9533
accuracy train: 0.993537 val: 0.974545 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.962557
Counter({1: 3894, 2: 2329, 0: 1468})

Epoch :  21 loss training:  3.3968267451273277 Time :  9624
accuracy train: 0.994345 val: 0.976364 test: 0.968493
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.962557
Counter({0: 3898, 1: 2320, 2: 1473})

Epoch :  22 loss training:  3.214488562414772 Time :  9710
accuracy train: 0.995152 val: 0.976364 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.962557
Counter({0: 3898, 1: 2320, 2: 1473})

Epoch :  23 loss training:  3.272678304638248 Time :  9792
accuracy train: 0.994547 val: 0.978182 test: 0.970320
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.962557
Counter({0: 3899, 1: 2319, 2: 1473})

Epoch :  24 loss training:  3.251384679460898 Time :  9878
accuracy train: 0.995354 val: 0.978182 test: 0.968950
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.962557
Counter({0: 3901, 1: 2316, 2: 1474})

Epoch :  25 loss training:  3.433254128729459 Time :  9949
accuracy train: 0.994345 val: 0.978182 test: 0.967123
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.962557
Counter({0: 3902, 2: 2315, 1: 1474})

Epoch :  26 loss training:  2.82899285457097 Time :  10023
accuracy train: 0.995152 val: 0.980000 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.962557
Counter({0: 3904, 1: 2314, 2: 1473})

Epoch :  27 loss training:  3.0473931682063267 Time :  10100
accuracy train: 0.995152 val: 0.980000 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.962557
Counter({0: 3908, 1: 2313, 2: 1470})

Epoch :  28 loss training:  2.8250537888379768 Time :  10174
accuracy train: 0.996162 val: 0.978182 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.962557
Counter({2: 3909, 1: 2313, 0: 1469})

Epoch :  29 loss training:  2.7546492031542584 Time :  10266
accuracy train: 0.994951 val: 0.978182 test: 0.968037
max validation accuracy : 0.980000 max acc epoch : 7 test accuracy : 0.962557
Counter({0: 3913, 1: 2308, 2: 1470})

Epoch :  30 loss training:  2.723136513552163 Time :  10355
accuracy train: 0.995960 val: 0.981818 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 30 test accuracy : 0.972603
Counter({0: 3915, 2: 2307, 1: 1469})

Epoch :  31 loss training:  2.4303027935675345 Time :  10445
accuracy train: 0.995960 val: 0.981818 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 30 test accuracy : 0.972603
Counter({1: 3915, 2: 2307, 0: 1469})

Epoch :  32 loss training:  2.5786239335429855 Time :  10520
accuracy train: 0.996364 val: 0.983636 test: 0.970776
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({1: 3915, 0: 2307, 2: 1469})

Epoch :  33 loss training:  2.5762936491519213 Time :  10597
accuracy train: 0.996162 val: 0.980000 test: 0.969406
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({1: 3915, 2: 2310, 0: 1466})

Epoch :  34 loss training:  2.445893317228183 Time :  10680
accuracy train: 0.995960 val: 0.981818 test: 0.969406
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({0: 3915, 2: 2311, 1: 1465})

Epoch :  35 loss training:  2.5899421962094493 Time :  10765
accuracy train: 0.995960 val: 0.978182 test: 0.970776
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({1: 3916, 0: 2310, 2: 1465})

Epoch :  36 loss training:  2.2827452657802496 Time :  10852
accuracy train: 0.995556 val: 0.981818 test: 0.970320
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({1: 3919, 0: 2308, 2: 1464})

Epoch :  37 loss training:  2.4392907163710333 Time :  10932
accuracy train: 0.995556 val: 0.978182 test: 0.968037
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({0: 3921, 2: 2307, 1: 1463})

Epoch :  38 loss training:  2.2817004829994403 Time :  11014
accuracy train: 0.996162 val: 0.980000 test: 0.972603
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({0: 3923, 2: 2307, 1: 1461})

Epoch :  39 loss training:  1.9321552094770595 Time :  11093
accuracy train: 0.996162 val: 0.978182 test: 0.971233
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({1: 3925, 2: 2306, 0: 1460})

Epoch :  40 loss training:  1.9827529442845844 Time :  11169
accuracy train: 0.996162 val: 0.978182 test: 0.969863
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({1: 3925, 2: 2305, 0: 1461})

Epoch :  41 loss training:  1.6752063447784167 Time :  11253
accuracy train: 0.996364 val: 0.976364 test: 0.968493
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({0: 3924, 2: 2306, 1: 1461})

Epoch :  42 loss training:  2.013276398094604 Time :  11338
accuracy train: 0.996364 val: 0.978182 test: 0.969406
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({0: 3924, 2: 2306, 1: 1461})

Epoch :  43 loss training:  1.9043009580054786 Time :  11418
accuracy train: 0.996970 val: 0.980000 test: 0.969406
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({0: 3924, 2: 2305, 1: 1462})

Epoch :  44 loss training:  1.8983418086136226 Time :  11503
accuracy train: 0.996768 val: 0.978182 test: 0.967580
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({0: 3924, 2: 2306, 1: 1461})

Epoch :  45 loss training:  1.8854796611121856 Time :  11589
accuracy train: 0.997172 val: 0.980000 test: 0.969863
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({0: 3924, 1: 2304, 2: 1463})

Epoch :  46 loss training:  1.603364238209906 Time :  11670
accuracy train: 0.996970 val: 0.978182 test: 0.971233
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({0: 3924, 1: 2305, 2: 1462})

Epoch :  47 loss training:  1.9487942791602109 Time :  11758
accuracy train: 0.996970 val: 0.978182 test: 0.967580
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({1: 3924, 0: 2304, 2: 1463})

Epoch :  48 loss training:  1.5178156584006501 Time :  11844
accuracy train: 0.996970 val: 0.978182 test: 0.970320
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({0: 3924, 2: 2304, 1: 1463})

Epoch :  49 loss training:  1.5750926806067582 Time :  11935
accuracy train: 0.997172 val: 0.978182 test: 0.969406
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({0: 3924, 2: 2304, 1: 1463})

Epoch :  50 loss training:  1.5370599710877286 Time :  12020
accuracy train: 0.996970 val: 0.978182 test: 0.968950
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({1: 3922, 0: 2307, 2: 1462})

Epoch :  51 loss training:  1.6439389410807053 Time :  12109
accuracy train: 0.996768 val: 0.970909 test: 0.968493
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({0: 3923, 2: 2307, 1: 1461})

Epoch :  52 loss training:  1.557881484979589 Time :  12189
accuracy train: 0.997172 val: 0.978182 test: 0.971233
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({0: 3923, 1: 2307, 2: 1461})

Epoch :  53 loss training:  1.5025011058532982 Time :  12270
accuracy train: 0.996768 val: 0.980000 test: 0.971689
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({1: 3923, 0: 2307, 2: 1461})

Epoch :  54 loss training:  1.6136826909059891 Time :  12351
accuracy train: 0.996970 val: 0.978182 test: 0.971689
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({0: 3923, 1: 2300, 2: 1468})

Epoch :  55 loss training:  1.4532114689500304 Time :  12436
accuracy train: 0.997172 val: 0.976364 test: 0.970320
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({0: 3922, 2: 2300, 1: 1469})

Epoch :  56 loss training:  1.6107831577392062 Time :  12522
accuracy train: 0.996768 val: 0.978182 test: 0.969863
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({0: 3923, 1: 2301, 2: 1467})

Epoch :  57 loss training:  1.6657771130194305 Time :  12591
accuracy train: 0.996970 val: 0.978182 test: 0.969406
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({1: 3924, 2: 2301, 0: 1466})

Epoch :  58 loss training:  1.3275438215277973 Time :  12682
accuracy train: 0.996970 val: 0.976364 test: 0.968950
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({0: 3924, 2: 2301, 1: 1466})

Epoch :  59 loss training:  1.4966472043925023 Time :  12770
accuracy train: 0.996970 val: 0.976364 test: 0.971689
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({1: 3925, 2: 2300, 0: 1466})

Epoch :  60 loss training:  1.4304432859898952 Time :  12852
accuracy train: 0.997172 val: 0.978182 test: 0.970776
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({0: 3925, 1: 2300, 2: 1466})

Epoch :  61 loss training:  1.3888809717827826 Time :  12935
accuracy train: 0.996970 val: 0.980000 test: 0.972603
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({0: 3925, 1: 2300, 2: 1466})

Epoch :  62 loss training:  1.4673293828382157 Time :  13017
accuracy train: 0.997374 val: 0.976364 test: 0.969406
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({0: 3925, 1: 2300, 2: 1466})

Epoch :  63 loss training:  1.4539506825130957 Time :  13104
accuracy train: 0.996970 val: 0.978182 test: 0.970776
max validation accuracy : 0.983636 max acc epoch : 32 test accuracy : 0.970776
Counter({0: 3924, 1: 2300, 2: 1467})

========================================================================================================================================================================================================
max acc epoch :  32
max validation accuracy :  0.9836363636363636
test accuracy :  0.9707762557077626
last test_accuracy :  0.9707762557077626
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=4, num_mlp_layers=1, random_vec=False, seed=84, weight_decay=1e-08)
device :  cuda:0
Counter({1: 4230, 2: 2303, 0: 1158})

Epoch :  1 loss training:  43.505747482180595 Time :  13315
accuracy train: 0.936982 val: 0.927273 test: 0.953425
max validation accuracy : 0.927273 max acc epoch : 1 test accuracy : 0.953425
Counter({0: 3514, 2: 2512, 1: 1665})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  20.319145723246038 Time :  13410
accuracy train: 0.974551 val: 0.967273 test: 0.960274
max validation accuracy : 0.967273 max acc epoch : 2 test accuracy : 0.960274
Counter({1: 3692, 0: 2563, 2: 1436})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.709542317315936 Time :  13524
accuracy train: 0.977782 val: 0.978182 test: 0.965297
max validation accuracy : 0.978182 max acc epoch : 3 test accuracy : 0.965297
Counter({1: 3709, 0: 2538, 2: 1444})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.359369710553437 Time :  13604
accuracy train: 0.982024 val: 0.978182 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 3 test accuracy : 0.965297
Counter({1: 3740, 0: 2512, 2: 1439})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.809573518577963 Time :  13685
accuracy train: 0.984852 val: 0.981818 test: 0.964840
max validation accuracy : 0.981818 max acc epoch : 5 test accuracy : 0.964840
Counter({0: 3794, 1: 2392, 2: 1505})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.891630406025797 Time :  13775
accuracy train: 0.981014 val: 0.965455 test: 0.961644
max validation accuracy : 0.981818 max acc epoch : 5 test accuracy : 0.964840
Counter({0: 3801, 1: 2388, 2: 1502})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.7194651768077165 Time :  13857
accuracy train: 0.986871 val: 0.978182 test: 0.964840
max validation accuracy : 0.981818 max acc epoch : 5 test accuracy : 0.964840
Counter({0: 3805, 1: 2362, 2: 1524})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.828915386693552 Time :  13945
accuracy train: 0.989497 val: 0.972727 test: 0.967580
max validation accuracy : 0.981818 max acc epoch : 5 test accuracy : 0.964840
Counter({1: 3806, 2: 2361, 0: 1524})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.72529680992011 Time :  14031
accuracy train: 0.985256 val: 0.974545 test: 0.963470
max validation accuracy : 0.981818 max acc epoch : 5 test accuracy : 0.964840
Counter({0: 3821, 1: 2349, 2: 1521})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.6799420194583945 Time :  14110
accuracy train: 0.991517 val: 0.981818 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 5 test accuracy : 0.964840
Counter({1: 3833, 0: 2338, 2: 1520})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.191811007913202 Time :  14193
accuracy train: 0.992527 val: 0.976364 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 5 test accuracy : 0.964840
Counter({0: 3839, 1: 2336, 2: 1516})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.498572227777913 Time :  14271
accuracy train: 0.993133 val: 0.980000 test: 0.968493
max validation accuracy : 0.981818 max acc epoch : 5 test accuracy : 0.964840
Counter({1: 3839, 0: 2336, 2: 1516})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  4.579870496876538 Time :  14353
accuracy train: 0.993739 val: 0.974545 test: 0.968037
max validation accuracy : 0.981818 max acc epoch : 5 test accuracy : 0.964840
Counter({1: 3842, 2: 2336, 0: 1513})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.5376383502734825 Time :  14443
accuracy train: 0.993739 val: 0.980000 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 5 test accuracy : 0.964840
Counter({0: 3845, 1: 2334, 2: 1512})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  4.8556695183506235 Time :  14525
accuracy train: 0.993537 val: 0.985455 test: 0.969863
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3855, 2: 2332, 0: 1504})

Epoch :  16 loss training:  4.3213362887036055 Time :  14614
accuracy train: 0.994345 val: 0.983636 test: 0.970776
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3856, 2: 2332, 1: 1503})

Epoch :  17 loss training:  3.867372908629477 Time :  14695
accuracy train: 0.994345 val: 0.980000 test: 0.970320
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3858, 1: 2332, 2: 1501})

Epoch :  18 loss training:  4.269959636265412 Time :  14781
accuracy train: 0.993941 val: 0.980000 test: 0.969863
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3860, 2: 2330, 1: 1501})

Epoch :  19 loss training:  4.114236454770435 Time :  14864
accuracy train: 0.994749 val: 0.983636 test: 0.972146
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3867, 0: 2325, 2: 1499})

Epoch :  20 loss training:  3.8628398657310754 Time :  14946
accuracy train: 0.994143 val: 0.980000 test: 0.969406
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3877, 1: 2324, 2: 1490})

Epoch :  21 loss training:  3.474879221059382 Time :  15025
accuracy train: 0.994547 val: 0.981818 test: 0.970320
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3882, 0: 2319, 2: 1490})

Epoch :  22 loss training:  3.34188024722971 Time :  15109
accuracy train: 0.994547 val: 0.978182 test: 0.970776
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3882, 1: 2319, 2: 1490})

Epoch :  23 loss training:  3.3908873981563374 Time :  15192
accuracy train: 0.994749 val: 0.981818 test: 0.971233
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3883, 1: 2319, 2: 1489})

Epoch :  24 loss training:  3.3125851083314046 Time :  15273
accuracy train: 0.994749 val: 0.981818 test: 0.968950
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({2: 3886, 0: 2318, 1: 1487})

Epoch :  25 loss training:  3.4458472176338546 Time :  15359
accuracy train: 0.993739 val: 0.978182 test: 0.970320
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3886, 2: 2317, 0: 1488})

Epoch :  26 loss training:  2.8333375861984678 Time :  15456
accuracy train: 0.995354 val: 0.981818 test: 0.972146
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3889, 2: 2314, 1: 1488})

Epoch :  27 loss training:  3.075800151389558 Time :  15540
accuracy train: 0.995758 val: 0.981818 test: 0.973516
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3892, 0: 2312, 2: 1487})

Epoch :  28 loss training:  2.6279313340201043 Time :  15626
accuracy train: 0.995758 val: 0.981818 test: 0.971233
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3894, 2: 2311, 0: 1486})

Epoch :  29 loss training:  2.7490235019940883 Time :  15713
accuracy train: 0.995354 val: 0.981818 test: 0.969406
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3899, 0: 2306, 2: 1486})

Epoch :  30 loss training:  2.7907051208312623 Time :  15792
accuracy train: 0.995758 val: 0.980000 test: 0.973973
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3902, 1: 2305, 2: 1484})

Epoch :  31 loss training:  2.5626000477350317 Time :  15874
accuracy train: 0.996162 val: 0.981818 test: 0.974429
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3903, 2: 2305, 0: 1483})

Epoch :  32 loss training:  2.8771132970578037 Time :  15952
accuracy train: 0.996364 val: 0.978182 test: 0.972146
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3903, 0: 2305, 2: 1483})

Epoch :  33 loss training:  2.5600879514822736 Time :  16028
accuracy train: 0.995354 val: 0.974545 test: 0.968950
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3903, 2: 2305, 1: 1483})

Epoch :  34 loss training:  2.6442679464817047 Time :  16107
accuracy train: 0.995960 val: 0.980000 test: 0.970320
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3903, 2: 2305, 0: 1483})

Epoch :  35 loss training:  2.7357038527843542 Time :  16179
accuracy train: 0.995758 val: 0.980000 test: 0.970320
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3906, 2: 2303, 1: 1482})

Epoch :  36 loss training:  2.354484968003817 Time :  16273
accuracy train: 0.995960 val: 0.981818 test: 0.972603
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3907, 0: 2304, 2: 1480})

Epoch :  37 loss training:  2.3393617628898937 Time :  16362
accuracy train: 0.995354 val: 0.978182 test: 0.969863
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3907, 1: 2305, 2: 1479})

Epoch :  38 loss training:  2.2629123796359636 Time :  16450
accuracy train: 0.996162 val: 0.980000 test: 0.972603
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3910, 1: 2304, 2: 1477})

Epoch :  39 loss training:  2.1635354376630858 Time :  16538
accuracy train: 0.996162 val: 0.978182 test: 0.971689
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3914, 1: 2303, 2: 1474})

Epoch :  40 loss training:  2.03089777418063 Time :  16621
accuracy train: 0.996364 val: 0.980000 test: 0.972146
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3915, 2: 2302, 0: 1474})

Epoch :  41 loss training:  1.8298051014717203 Time :  16697
accuracy train: 0.996768 val: 0.978182 test: 0.970776
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3915, 2: 2303, 1: 1473})

Epoch :  42 loss training:  2.0664767965645296 Time :  16786
accuracy train: 0.996364 val: 0.978182 test: 0.971689
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3915, 1: 2303, 2: 1473})

Epoch :  43 loss training:  2.0341739699360915 Time :  16858
accuracy train: 0.996970 val: 0.978182 test: 0.971233
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({1: 3915, 0: 2303, 2: 1473})

Epoch :  44 loss training:  1.8628736870305147 Time :  16941
accuracy train: 0.996970 val: 0.978182 test: 0.970320
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3915, 2: 2303, 1: 1473})

Epoch :  45 loss training:  1.962848494076752 Time :  17026
accuracy train: 0.997374 val: 0.976364 test: 0.971233
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3915, 2: 2303, 1: 1473})

Epoch :  46 loss training:  1.5340678406500956 Time :  17109
accuracy train: 0.996970 val: 0.981818 test: 0.972146
max validation accuracy : 0.985455 max acc epoch : 15 test accuracy : 0.969863
Counter({0: 3915, 1: 2303, 2: 1473})

========================================================================================================================================================================================================
max acc epoch :  15
max validation accuracy :  0.9854545454545455
test accuracy :  0.9698630136986301
last test_accuracy :  0.9721461187214612
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.98364 	 test_accuracy : 0.97032 	 max_acc epoch :  5 	 last test_accuracy : 0.96941
k :  1 	 val_accuracy : 0.98364 	 test_accuracy : 0.96986 	 max_acc epoch :  23 	 last test_accuracy : 0.97215
k :  2 	 val_accuracy : 0.98364 	 test_accuracy : 0.97078 	 max_acc epoch :  32 	 last test_accuracy : 0.97078
k :  3 	 val_accuracy : 0.98545 	 test_accuracy : 0.96986 	 max_acc epoch :  15 	 last test_accuracy : 0.97215

avg :  	 val_accuracy : 0.98409 	 test_accuracy : 0.97021 	 last_accuracy : 0.97112
