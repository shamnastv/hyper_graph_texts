

date and time :  Sun May  9 21:26:10 2021
Namespace(batch_size=32, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=0)
device :  cuda:0
min_len_of_sentence : 1
max_len_of_sentence : 453
min_num_of_sentence : 2
max_num_of_sentence : 525
average_len_of_sentence: 5.910510463468645
average_num_of_sentence: 61.52946330777656
Total_num_of_sentence : 561764
Counter({'earn': 3923, 'acq': 2292, 'crude': 374, 'trade': 326, 'money-fx': 309, 'interest': 272, 'money-supply': 151, 'ship': 144, 'sugar': 122, 'coffee': 112, 'gold': 90, 'gnp': 74, 'cpi': 71, 'cocoa': 61, 'grain': 51, 'alum': 50, 'reserves': 49, 'jobs': 49, 'ipi': 45, 'copper': 44, 'rubber': 40, 'iron-steel': 38, 'nat-gas': 36, 'bop': 31, 'veg-oil': 30, 'tin': 27, 'cotton': 24, 'wpi': 23, 'livestock': 22, 'orange': 22, 'retail': 20, 'pet-chem': 19, 'gas': 18, 'housing': 17, 'strategic-metal': 15, 'lei': 14, 'lumber': 14, 'zinc': 13, 'income': 11, 'meal-feed': 11, 'carcass': 11, 'fuel': 11, 'heat': 10, 'lead': 8, 'instal-debt': 6, 'dlr': 6, 'tea': 5, 'potato': 5, 'nickel': 4, 'cpu': 4, 'platinum': 3, 'jet': 3})
Total_number_of_words: 9334
Total_number_of_categories: 52
vocab size : 9334
got embeddings of : 8713

Epoch :  1 loss training:  252.91782706975937 Time :  337
accuracy train: 0.910738 val: 0.893293 test: 0.887549
max validation accuracy : 0.893293 max acc epoch : 1 test accuracy : 0.887549
Epoch-1 lr: 0.001

Epoch :  2 loss training:  111.083515137434 Time :  381
accuracy train: 0.940210 val: 0.919207 test: 0.920233
max validation accuracy : 0.919207 max acc epoch : 2 test accuracy : 0.920233
Epoch-2 lr: 0.001

Epoch :  3 loss training:  87.2449119463563 Time :  422
accuracy train: 0.925305 val: 0.893293 test: 0.912840
max validation accuracy : 0.919207 max acc epoch : 2 test accuracy : 0.920233
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  56.504950284957886 Time :  462
accuracy train: 0.970020 val: 0.940549 test: 0.934630
max validation accuracy : 0.940549 max acc epoch : 4 test accuracy : 0.934630
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  48.11287275142968 Time :  503
accuracy train: 0.974593 val: 0.954268 test: 0.929183
max validation accuracy : 0.954268 max acc epoch : 5 test accuracy : 0.929183
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  41.58706020005047 Time :  543
accuracy train: 0.980183 val: 0.951220 test: 0.937354
max validation accuracy : 0.954268 max acc epoch : 5 test accuracy : 0.929183
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  33.72828724980354 Time :  584
accuracy train: 0.983740 val: 0.958841 test: 0.943969
max validation accuracy : 0.958841 max acc epoch : 7 test accuracy : 0.943969
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  29.760958910919726 Time :  624
accuracy train: 0.986958 val: 0.969512 test: 0.944747
max validation accuracy : 0.969512 max acc epoch : 8 test accuracy : 0.944747
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  26.3413353189826 Time :  666
accuracy train: 0.987974 val: 0.960366 test: 0.942023
max validation accuracy : 0.969512 max acc epoch : 8 test accuracy : 0.944747
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  25.815858172252774 Time :  705
accuracy train: 0.988652 val: 0.963415 test: 0.943580
max validation accuracy : 0.969512 max acc epoch : 8 test accuracy : 0.944747
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  23.027903460897505 Time :  748
accuracy train: 0.989668 val: 0.958841 test: 0.944747
max validation accuracy : 0.969512 max acc epoch : 8 test accuracy : 0.944747
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  21.500845359638333 Time :  790
accuracy train: 0.989837 val: 0.960366 test: 0.945914
max validation accuracy : 0.969512 max acc epoch : 8 test accuracy : 0.944747
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  19.673802657052875 Time :  838
accuracy train: 0.991192 val: 0.969512 test: 0.942023
max validation accuracy : 0.969512 max acc epoch : 8 test accuracy : 0.944747
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  20.49966622143984 Time :  883
accuracy train: 0.991701 val: 0.966463 test: 0.947860
max validation accuracy : 0.969512 max acc epoch : 8 test accuracy : 0.944747
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  18.965155955869704 Time :  929
accuracy train: 0.991870 val: 0.964939 test: 0.947471
max validation accuracy : 0.969512 max acc epoch : 8 test accuracy : 0.944747

Epoch :  16 loss training:  18.4794137571007 Time :  973
accuracy train: 0.992039 val: 0.966463 test: 0.944747
max validation accuracy : 0.969512 max acc epoch : 8 test accuracy : 0.944747

Epoch :  17 loss training:  19.760208267718554 Time :  1016
accuracy train: 0.991701 val: 0.966463 test: 0.943969
max validation accuracy : 0.969512 max acc epoch : 8 test accuracy : 0.944747

Epoch :  18 loss training:  17.371367689222097 Time :  1059
accuracy train: 0.992717 val: 0.964939 test: 0.946693
max validation accuracy : 0.969512 max acc epoch : 8 test accuracy : 0.944747

Epoch :  19 loss training:  18.619035625830293 Time :  1102
accuracy train: 0.992547 val: 0.963415 test: 0.945914
max validation accuracy : 0.969512 max acc epoch : 8 test accuracy : 0.944747

Epoch :  20 loss training:  17.481810681521893 Time :  1146
accuracy train: 0.993225 val: 0.971037 test: 0.944358
max validation accuracy : 0.971037 max acc epoch : 20 test accuracy : 0.944358

Epoch :  21 loss training:  16.66663938295096 Time :  1189
accuracy train: 0.993225 val: 0.971037 test: 0.945525
max validation accuracy : 0.971037 max acc epoch : 20 test accuracy : 0.944358

Epoch :  22 loss training:  16.569270396605134 Time :  1232
accuracy train: 0.994241 val: 0.967988 test: 0.947471
max validation accuracy : 0.971037 max acc epoch : 20 test accuracy : 0.944358

Epoch :  23 loss training:  17.734490675851703 Time :  1274
accuracy train: 0.993902 val: 0.967988 test: 0.944358
max validation accuracy : 0.971037 max acc epoch : 20 test accuracy : 0.944358

Epoch :  24 loss training:  16.263941761106253 Time :  1316
accuracy train: 0.994919 val: 0.969512 test: 0.944747
max validation accuracy : 0.971037 max acc epoch : 20 test accuracy : 0.944358

Epoch :  25 loss training:  17.11011073505506 Time :  1359
accuracy train: 0.994580 val: 0.966463 test: 0.944358
max validation accuracy : 0.971037 max acc epoch : 20 test accuracy : 0.944358

Epoch :  26 loss training:  15.922659867443144 Time :  1401
accuracy train: 0.994411 val: 0.969512 test: 0.945525
max validation accuracy : 0.971037 max acc epoch : 20 test accuracy : 0.944358

Epoch :  27 loss training:  13.952528710477054 Time :  1440
accuracy train: 0.994072 val: 0.966463 test: 0.945136
max validation accuracy : 0.971037 max acc epoch : 20 test accuracy : 0.944358

Epoch :  28 loss training:  15.092558707576245 Time :  1470
accuracy train: 0.993733 val: 0.972561 test: 0.942802
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  29 loss training:  15.349545678123832 Time :  1501
accuracy train: 0.994411 val: 0.967988 test: 0.943191
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  30 loss training:  14.4938207520172 Time :  1532
accuracy train: 0.994241 val: 0.961890 test: 0.947082
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  31 loss training:  13.79215137148276 Time :  1564
accuracy train: 0.995088 val: 0.960366 test: 0.949027
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  32 loss training:  13.884399796370417 Time :  1595
accuracy train: 0.994749 val: 0.967988 test: 0.944747
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  33 loss training:  13.327435620129108 Time :  1626
accuracy train: 0.995088 val: 0.966463 test: 0.947082
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  34 loss training:  12.634092200547457 Time :  1657
accuracy train: 0.995596 val: 0.964939 test: 0.943580
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  35 loss training:  13.206088126404211 Time :  1687
accuracy train: 0.995935 val: 0.966463 test: 0.948249
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  36 loss training:  12.981793678831309 Time :  1718
accuracy train: 0.996104 val: 0.972561 test: 0.946693
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  37 loss training:  11.802694908808917 Time :  1749
accuracy train: 0.995766 val: 0.964939 test: 0.947471
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  38 loss training:  12.05957634234801 Time :  1781
accuracy train: 0.995935 val: 0.967988 test: 0.949416
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  39 loss training:  10.755848328582942 Time :  1810
accuracy train: 0.996443 val: 0.963415 test: 0.949027
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  40 loss training:  11.771743448451161 Time :  1842
accuracy train: 0.996443 val: 0.964939 test: 0.945136
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  41 loss training:  10.351132407784462 Time :  1875
accuracy train: 0.996104 val: 0.964939 test: 0.948249
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  42 loss training:  10.570957628078759 Time :  1907
accuracy train: 0.996443 val: 0.967988 test: 0.946693
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  43 loss training:  10.207762249745429 Time :  1938
accuracy train: 0.996612 val: 0.966463 test: 0.947860
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  44 loss training:  10.364415311720222 Time :  1967
accuracy train: 0.996782 val: 0.963415 test: 0.946693
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  45 loss training:  10.674935651943088 Time :  1998
accuracy train: 0.996443 val: 0.963415 test: 0.948638
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  46 loss training:  9.98386095778551 Time :  2031
accuracy train: 0.996951 val: 0.967988 test: 0.949027
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  47 loss training:  10.251339472364634 Time :  2072
accuracy train: 0.996951 val: 0.967988 test: 0.950195
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  48 loss training:  10.717143052257597 Time :  2112
accuracy train: 0.996443 val: 0.961890 test: 0.950973
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  49 loss training:  10.573975993087515 Time :  2151
accuracy train: 0.996782 val: 0.964939 test: 0.950584
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  50 loss training:  10.168688811652828 Time :  2191
accuracy train: 0.997121 val: 0.961890 test: 0.949027
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  51 loss training:  9.538824810180813 Time :  2230
accuracy train: 0.997629 val: 0.960366 test: 0.949027
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  52 loss training:  8.960328770335764 Time :  2269
accuracy train: 0.997290 val: 0.967988 test: 0.950584
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  53 loss training:  9.261002437211573 Time :  2308
accuracy train: 0.997629 val: 0.964939 test: 0.950195
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  54 loss training:  9.417294582352042 Time :  2347
accuracy train: 0.997290 val: 0.961890 test: 0.947860
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  55 loss training:  8.800103137735277 Time :  2387
accuracy train: 0.997798 val: 0.961890 test: 0.950973
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  56 loss training:  9.135576212545857 Time :  2426
accuracy train: 0.997121 val: 0.969512 test: 0.949805
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  57 loss training:  8.666107435943559 Time :  2465
accuracy train: 0.997459 val: 0.966463 test: 0.950973
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  58 loss training:  8.601120569743216 Time :  2505
accuracy train: 0.998137 val: 0.966463 test: 0.946693
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

Epoch :  59 loss training:  8.606418489012867 Time :  2545
accuracy train: 0.997629 val: 0.969512 test: 0.945914
max validation accuracy : 0.972561 max acc epoch : 28 test accuracy : 0.942802

========================================================================================================================================================================================================
max acc epoch :  28
max validation accuracy :  0.9725609756097561
test accuracy :  0.9428015564202334
last test_accuracy :  0.9459143968871595
========================================================================================================================================================================================================

