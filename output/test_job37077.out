

date and time :  Thu Jun 10 23:43:35 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=782, weight_decay=1e-10)
device :  cuda:0
min_len_of_sentence : 0
max_len_of_sentence : 241
min_num_of_sentence : 2
max_num_of_sentence : 25
average_len_of_sentence: 14.564306415596345
average_num_of_sentence: 8.532837837837837
Total_num_of_sentence : 63143
Counter({'C14': 1175, 'C04': 1030, 'C23': 796, 'C10': 557, 'C21': 553, 'C20': 410, 'C06': 354, 'C12': 342, 'C18': 323, 'C08': 250, 'C17': 233, 'C05': 223, 'C01': 216, 'C13': 195, 'C15': 133, 'C16': 129, 'C11': 125, 'C19': 86, 'C02': 75, 'C07': 63, 'C09': 63, 'C03': 50, 'C22': 19})
Total_number_of_words: 12412
Total_number_of_categories: 23
vocab size : 12412
got embeddings of : 11675
Counter({0: 2604, 1: 2534, 2: 2262})

Epoch :  1 loss training:  210.42713779211044 Time :  98
accuracy train: 0.666777 val: 0.650746 test: 0.634183
max validation accuracy : 0.650746 max acc epoch : 1 test accuracy : 0.634183
Counter({0: 2982, 2: 2363, 1: 2055})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  140.6024985909462 Time :  137
accuracy train: 0.731635 val: 0.614925 test: 0.664358
max validation accuracy : 0.650746 max acc epoch : 1 test accuracy : 0.634183
Counter({1: 2889, 0: 2606, 2: 1905})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.09631770849228 Time :  159
accuracy train: 0.711780 val: 0.620896 test: 0.627504
max validation accuracy : 0.650746 max acc epoch : 1 test accuracy : 0.634183
Counter({1: 2675, 2: 2610, 0: 2115})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  97.68400752544403 Time :  181
accuracy train: 0.808405 val: 0.680597 test: 0.695276
max validation accuracy : 0.680597 max acc epoch : 4 test accuracy : 0.695276
Counter({0: 3306, 2: 2559, 1: 1535})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  87.7271474301815 Time :  204
accuracy train: 0.833554 val: 0.665672 test: 0.692060
max validation accuracy : 0.680597 max acc epoch : 4 test accuracy : 0.695276
Counter({1: 3199, 0: 2691, 2: 1510})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.74130795896053 Time :  228
accuracy train: 0.847783 val: 0.683582 test: 0.705169
max validation accuracy : 0.683582 max acc epoch : 6 test accuracy : 0.705169
Counter({0: 3164, 2: 2717, 1: 1519})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  70.78678521513939 Time :  256
accuracy train: 0.861350 val: 0.686567 test: 0.715310
max validation accuracy : 0.686567 max acc epoch : 7 test accuracy : 0.715310
Counter({0: 3177, 1: 2712, 2: 1511})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.54423202574253 Time :  285
accuracy train: 0.862343 val: 0.692537 test: 0.712342
max validation accuracy : 0.692537 max acc epoch : 8 test accuracy : 0.712342
Counter({0: 3172, 1: 2722, 2: 1506})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.11477755010128 Time :  315
accuracy train: 0.884514 val: 0.680597 test: 0.713332
max validation accuracy : 0.692537 max acc epoch : 8 test accuracy : 0.712342
Counter({1: 3158, 2: 2731, 0: 1511})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.01941414177418 Time :  338
accuracy train: 0.892786 val: 0.686567 test: 0.718031
max validation accuracy : 0.692537 max acc epoch : 8 test accuracy : 0.712342
Counter({0: 3154, 2: 2734, 1: 1512})

Epoch :  11 loss training:  55.444705083966255 Time :  361
accuracy train: 0.908670 val: 0.692537 test: 0.714321
max validation accuracy : 0.692537 max acc epoch : 8 test accuracy : 0.712342
Counter({2: 3174, 0: 2711, 1: 1515})

Epoch :  12 loss training:  53.828138537704945 Time :  390
accuracy train: 0.914626 val: 0.689552 test: 0.714074
max validation accuracy : 0.692537 max acc epoch : 8 test accuracy : 0.712342
Counter({0: 3185, 1: 2697, 2: 1518})

Epoch :  13 loss training:  50.91857761144638 Time :  414
accuracy train: 0.922899 val: 0.680597 test: 0.720257
max validation accuracy : 0.692537 max acc epoch : 8 test accuracy : 0.712342
Counter({0: 3194, 2: 2694, 1: 1512})

Epoch :  14 loss training:  49.36573006212711 Time :  435
accuracy train: 0.932495 val: 0.683582 test: 0.720010
max validation accuracy : 0.692537 max acc epoch : 8 test accuracy : 0.712342
Counter({0: 3207, 2: 2678, 1: 1515})

Epoch :  15 loss training:  43.824518874287605 Time :  461
accuracy train: 0.937128 val: 0.695522 test: 0.717536
max validation accuracy : 0.695522 max acc epoch : 15 test accuracy : 0.717536
Counter({1: 3212, 0: 2668, 2: 1520})

Epoch :  16 loss training:  42.952658511698246 Time :  489
accuracy train: 0.947386 val: 0.680597 test: 0.716300
max validation accuracy : 0.695522 max acc epoch : 15 test accuracy : 0.717536
Counter({2: 3215, 0: 2671, 1: 1514})

Epoch :  17 loss training:  39.0781676620245 Time :  517
accuracy train: 0.951688 val: 0.692537 test: 0.721989
max validation accuracy : 0.695522 max acc epoch : 15 test accuracy : 0.717536
Counter({0: 3202, 2: 2690, 1: 1508})

Epoch :  18 loss training:  36.75784806162119 Time :  543
accuracy train: 0.955989 val: 0.683582 test: 0.724215
max validation accuracy : 0.695522 max acc epoch : 15 test accuracy : 0.717536
Counter({2: 3210, 0: 2698, 1: 1492})

Epoch :  19 loss training:  35.97554708272219 Time :  569
accuracy train: 0.953673 val: 0.692537 test: 0.718526
max validation accuracy : 0.695522 max acc epoch : 15 test accuracy : 0.717536
Counter({0: 3217, 2: 2696, 1: 1487})

Epoch :  20 loss training:  33.02008917182684 Time :  593
accuracy train: 0.968564 val: 0.713433 test: 0.725451
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({2: 3227, 0: 2677, 1: 1496})

Epoch :  21 loss training:  31.593889310956 Time :  619
accuracy train: 0.974851 val: 0.698507 test: 0.722236
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({1: 3226, 2: 2667, 0: 1507})

Epoch :  22 loss training:  27.962280314415693 Time :  645
accuracy train: 0.973858 val: 0.704478 test: 0.722236
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({1: 3236, 2: 2653, 0: 1511})

Epoch :  23 loss training:  26.956868387758732 Time :  672
accuracy train: 0.981800 val: 0.689552 test: 0.723473
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({2: 3261, 1: 2640, 0: 1499})

Epoch :  24 loss training:  25.546566527336836 Time :  697
accuracy train: 0.983455 val: 0.683582 test: 0.720752
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({1: 3258, 0: 2655, 2: 1487})

Epoch :  25 loss training:  24.1472240537405 Time :  724
accuracy train: 0.984447 val: 0.698507 test: 0.723473
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({1: 3223, 0: 2697, 2: 1480})

Epoch :  26 loss training:  22.432878468185663 Time :  754
accuracy train: 0.989080 val: 0.674627 test: 0.720505
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({2: 3243, 0: 2685, 1: 1472})

Epoch :  27 loss training:  19.96508715674281 Time :  781
accuracy train: 0.992389 val: 0.686567 test: 0.718773
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({1: 3257, 0: 2675, 2: 1468})

Epoch :  28 loss training:  19.39843912422657 Time :  805
accuracy train: 0.991727 val: 0.695522 test: 0.720999
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({0: 3258, 1: 2677, 2: 1465})

Epoch :  29 loss training:  18.299973914399743 Time :  830
accuracy train: 0.991066 val: 0.686567 test: 0.725451
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({0: 3263, 1: 2675, 2: 1462})

Epoch :  30 loss training:  17.266031090170145 Time :  865
accuracy train: 0.995698 val: 0.692537 test: 0.718773
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({0: 3265, 2: 2687, 1: 1448})

Epoch :  31 loss training:  14.495281910523772 Time :  897
accuracy train: 0.994044 val: 0.692537 test: 0.724215
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({0: 3275, 1: 2678, 2: 1447})

Epoch :  32 loss training:  13.970155641436577 Time :  922
accuracy train: 0.997022 val: 0.686567 test: 0.720010
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({2: 3280, 1: 2677, 0: 1443})

Epoch :  33 loss training:  12.4472193736583 Time :  946
accuracy train: 0.997022 val: 0.686567 test: 0.720505
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({0: 3300, 2: 2660, 1: 1440})

Epoch :  34 loss training:  13.36945278570056 Time :  973
accuracy train: 0.996029 val: 0.704478 test: 0.720999
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({1: 3300, 2: 2660, 0: 1440})

Epoch :  35 loss training:  12.530381808057427 Time :  997
accuracy train: 0.997022 val: 0.689552 test: 0.726441
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({0: 3306, 1: 2644, 2: 1450})

Epoch :  36 loss training:  11.472429376095533 Time :  1019
accuracy train: 0.999007 val: 0.695522 test: 0.722236
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({0: 3329, 1: 2631, 2: 1440})

Epoch :  37 loss training:  9.697269481606781 Time :  1043
accuracy train: 0.998345 val: 0.686567 test: 0.722483
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({1: 3346, 0: 2613, 2: 1441})

Epoch :  38 loss training:  9.817394211888313 Time :  1069
accuracy train: 0.998676 val: 0.695522 test: 0.721494
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({2: 3345, 0: 2618, 1: 1437})

Epoch :  39 loss training:  8.590847571380436 Time :  1096
accuracy train: 0.999669 val: 0.686567 test: 0.724462
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({2: 3367, 1: 2596, 0: 1437})

Epoch :  40 loss training:  7.813470438122749 Time :  1120
accuracy train: 1.000000 val: 0.707463 test: 0.722978
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({0: 3391, 1: 2584, 2: 1425})

Epoch :  41 loss training:  8.547147881239653 Time :  1145
accuracy train: 1.000000 val: 0.680597 test: 0.716300
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({1: 3408, 2: 2572, 0: 1420})

Epoch :  42 loss training:  6.915940761566162 Time :  1170
accuracy train: 0.998676 val: 0.680597 test: 0.718031
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({1: 3407, 0: 2588, 2: 1405})

Epoch :  43 loss training:  7.985216608271003 Time :  1199
accuracy train: 0.999669 val: 0.689552 test: 0.717784
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({2: 3428, 0: 2562, 1: 1410})

Epoch :  44 loss training:  6.494090547319502 Time :  1239
accuracy train: 0.999669 val: 0.704478 test: 0.723473
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({0: 3431, 1: 2565, 2: 1404})

Epoch :  45 loss training:  5.80212034098804 Time :  1270
accuracy train: 0.999669 val: 0.695522 test: 0.722731
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({2: 3425, 1: 2575, 0: 1400})

Epoch :  46 loss training:  6.403070627711713 Time :  1301
accuracy train: 1.000000 val: 0.683582 test: 0.721494
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({2: 3404, 0: 2596, 1: 1400})

Epoch :  47 loss training:  6.076262355782092 Time :  1333
accuracy train: 1.000000 val: 0.686567 test: 0.722236
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({2: 3406, 0: 2588, 1: 1406})

Epoch :  48 loss training:  5.282714284025133 Time :  1380
accuracy train: 0.999669 val: 0.680597 test: 0.720010
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({0: 3375, 2: 2626, 1: 1399})

Epoch :  49 loss training:  5.018641671631485 Time :  1414
accuracy train: 1.000000 val: 0.689552 test: 0.722731
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({0: 3409, 1: 2593, 2: 1398})

Epoch :  50 loss training:  4.648532227147371 Time :  1446
accuracy train: 1.000000 val: 0.695522 test: 0.718031
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({0: 3384, 1: 2621, 2: 1395})

Epoch :  51 loss training:  4.685402472503483 Time :  1469
accuracy train: 1.000000 val: 0.683582 test: 0.721741
max validation accuracy : 0.713433 max acc epoch : 20 test accuracy : 0.725451
Counter({0: 3401, 2: 2622, 1: 1377})

========================================================================================================================================================================================================
max acc epoch :  20
max validation accuracy :  0.7134328358208956
test accuracy :  0.725451397477121
last test_accuracy :  0.7217412812268118
max gap 7
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=782, weight_decay=1e-10)
device :  cuda:0
Counter({0: 2604, 1: 2534, 2: 2262})

Epoch :  1 loss training:  210.26004779338837 Time :  1515
accuracy train: 0.667439 val: 0.644776 test: 0.635419
max validation accuracy : 0.644776 max acc epoch : 1 test accuracy : 0.635419
Counter({0: 2735, 1: 2685, 2: 1980})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  140.59837955236435 Time :  1541
accuracy train: 0.735275 val: 0.638806 test: 0.663121
max validation accuracy : 0.644776 max acc epoch : 1 test accuracy : 0.635419
Counter({2: 2722, 1: 2676, 0: 2002})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.37285321950912 Time :  1565
accuracy train: 0.728326 val: 0.605970 test: 0.640366
max validation accuracy : 0.644776 max acc epoch : 1 test accuracy : 0.635419
Counter({0: 2672, 1: 2565, 2: 2163})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.33926278352737 Time :  1588
accuracy train: 0.805758 val: 0.689552 test: 0.693792
max validation accuracy : 0.689552 max acc epoch : 4 test accuracy : 0.693792
Counter({1: 3326, 2: 2521, 0: 1553})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.2735855281353 Time :  1614
accuracy train: 0.832561 val: 0.659701 test: 0.695028
max validation accuracy : 0.689552 max acc epoch : 4 test accuracy : 0.693792
Counter({1: 3239, 0: 2651, 2: 1510})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.66387350857258 Time :  1652
accuracy train: 0.850761 val: 0.692537 test: 0.708138
max validation accuracy : 0.692537 max acc epoch : 6 test accuracy : 0.708138
Counter({0: 3219, 1: 2674, 2: 1507})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  71.03948459029198 Time :  1683
accuracy train: 0.861681 val: 0.704478 test: 0.716794
max validation accuracy : 0.704478 max acc epoch : 7 test accuracy : 0.716794
Counter({0: 3236, 1: 2669, 2: 1495})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.90609295666218 Time :  1716
accuracy train: 0.859365 val: 0.701493 test: 0.712342
max validation accuracy : 0.704478 max acc epoch : 7 test accuracy : 0.716794
Counter({0: 3211, 1: 2699, 2: 1490})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.98366688191891 Time :  1750
accuracy train: 0.884183 val: 0.686567 test: 0.711600
max validation accuracy : 0.704478 max acc epoch : 7 test accuracy : 0.716794
Counter({1: 3221, 0: 2697, 2: 1482})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.726919054985046 Time :  1781
accuracy train: 0.890139 val: 0.683582 test: 0.717289
max validation accuracy : 0.704478 max acc epoch : 7 test accuracy : 0.716794
Counter({0: 3213, 2: 2703, 1: 1484})

Epoch :  11 loss training:  56.331614166498184 Time :  1837
accuracy train: 0.905030 val: 0.698507 test: 0.712837
max validation accuracy : 0.704478 max acc epoch : 7 test accuracy : 0.716794
Counter({2: 3207, 1: 2701, 0: 1492})

Epoch :  12 loss training:  51.61097037792206 Time :  1873
accuracy train: 0.913633 val: 0.701493 test: 0.715310
max validation accuracy : 0.704478 max acc epoch : 7 test accuracy : 0.716794
Counter({2: 3223, 0: 2689, 1: 1488})

Epoch :  13 loss training:  49.96077214181423 Time :  1912
accuracy train: 0.923230 val: 0.686567 test: 0.719021
max validation accuracy : 0.704478 max acc epoch : 7 test accuracy : 0.716794
Counter({2: 3215, 0: 2696, 1: 1489})

Epoch :  14 loss training:  48.37484183907509 Time :  1944
accuracy train: 0.936466 val: 0.689552 test: 0.716052
max validation accuracy : 0.704478 max acc epoch : 7 test accuracy : 0.716794
Counter({0: 3234, 2: 2676, 1: 1490})

Epoch :  15 loss training:  45.06056256592274 Time :  1974
accuracy train: 0.935473 val: 0.707463 test: 0.715805
max validation accuracy : 0.707463 max acc epoch : 15 test accuracy : 0.715805
Counter({2: 3223, 0: 2686, 1: 1491})

Epoch :  16 loss training:  43.13358969986439 Time :  2034
accuracy train: 0.944077 val: 0.692537 test: 0.720257
max validation accuracy : 0.707463 max acc epoch : 15 test accuracy : 0.715805
Counter({0: 3225, 1: 2679, 2: 1496})

Epoch :  17 loss training:  39.43773206323385 Time :  2077
accuracy train: 0.950364 val: 0.695522 test: 0.721494
max validation accuracy : 0.707463 max acc epoch : 15 test accuracy : 0.715805
Counter({1: 3221, 2: 2683, 0: 1496})

Epoch :  18 loss training:  37.014987498521805 Time :  2114
accuracy train: 0.957644 val: 0.707463 test: 0.723967
max validation accuracy : 0.707463 max acc epoch : 15 test accuracy : 0.715805
Counter({0: 3224, 1: 2678, 2: 1498})

Epoch :  19 loss training:  34.10151553153992 Time :  2151
accuracy train: 0.956320 val: 0.704478 test: 0.717042
max validation accuracy : 0.707463 max acc epoch : 15 test accuracy : 0.715805
Counter({1: 3209, 0: 2701, 2: 1490})

Epoch :  20 loss training:  34.49216765537858 Time :  2205
accuracy train: 0.966578 val: 0.686567 test: 0.722236
max validation accuracy : 0.707463 max acc epoch : 15 test accuracy : 0.715805
Counter({2: 3226, 1: 2688, 0: 1486})

Epoch :  21 loss training:  30.875268198549747 Time :  2238
accuracy train: 0.971873 val: 0.698507 test: 0.723225
max validation accuracy : 0.707463 max acc epoch : 15 test accuracy : 0.715805
Counter({0: 3231, 2: 2680, 1: 1489})

Epoch :  22 loss training:  29.187011569738388 Time :  2266
accuracy train: 0.977498 val: 0.689552 test: 0.725204
max validation accuracy : 0.707463 max acc epoch : 15 test accuracy : 0.715805
Counter({0: 3235, 2: 2682, 1: 1483})

Epoch :  23 loss training:  27.195428669452667 Time :  2299
accuracy train: 0.982793 val: 0.686567 test: 0.727925
max validation accuracy : 0.707463 max acc epoch : 15 test accuracy : 0.715805
Counter({2: 3236, 1: 2682, 0: 1482})

Epoch :  24 loss training:  25.44107596576214 Time :  2333
accuracy train: 0.982131 val: 0.695522 test: 0.724462
max validation accuracy : 0.707463 max acc epoch : 15 test accuracy : 0.715805
Counter({0: 3229, 2: 2690, 1: 1481})

Epoch :  25 loss training:  23.98808864504099 Time :  2382
accuracy train: 0.979484 val: 0.695522 test: 0.727677
max validation accuracy : 0.707463 max acc epoch : 15 test accuracy : 0.715805
Counter({0: 3210, 2: 2712, 1: 1478})

Epoch :  26 loss training:  23.38111922517419 Time :  2416
accuracy train: 0.986102 val: 0.695522 test: 0.721741
max validation accuracy : 0.707463 max acc epoch : 15 test accuracy : 0.715805
Counter({1: 3237, 0: 2687, 2: 1476})

Epoch :  27 loss training:  20.6610214933753 Time :  2450
accuracy train: 0.991066 val: 0.692537 test: 0.721247
max validation accuracy : 0.707463 max acc epoch : 15 test accuracy : 0.715805
Counter({1: 3259, 2: 2678, 0: 1463})

Epoch :  28 loss training:  19.81628043949604 Time :  2485
accuracy train: 0.988749 val: 0.704478 test: 0.721247
max validation accuracy : 0.707463 max acc epoch : 15 test accuracy : 0.715805
Counter({0: 3242, 2: 2693, 1: 1465})

Epoch :  29 loss training:  18.069607919082046 Time :  2527
accuracy train: 0.992058 val: 0.695522 test: 0.725699
max validation accuracy : 0.707463 max acc epoch : 15 test accuracy : 0.715805
Counter({0: 3263, 2: 2675, 1: 1462})

Epoch :  30 loss training:  17.06369823217392 Time :  2570
accuracy train: 0.995698 val: 0.704478 test: 0.720505
max validation accuracy : 0.707463 max acc epoch : 15 test accuracy : 0.715805
Counter({1: 3275, 2: 2663, 0: 1462})

Epoch :  31 loss training:  14.981895273551345 Time :  2625
accuracy train: 0.994044 val: 0.689552 test: 0.724215
max validation accuracy : 0.707463 max acc epoch : 15 test accuracy : 0.715805
Counter({0: 3306, 2: 2633, 1: 1461})

Epoch :  32 loss training:  14.812284531071782 Time :  2666
accuracy train: 0.996029 val: 0.704478 test: 0.725451
max validation accuracy : 0.707463 max acc epoch : 15 test accuracy : 0.715805
Counter({2: 3301, 1: 2638, 0: 1461})

Epoch :  33 loss training:  12.931396588683128 Time :  2700
accuracy train: 0.994044 val: 0.692537 test: 0.720257
max validation accuracy : 0.707463 max acc epoch : 15 test accuracy : 0.715805
Counter({1: 3292, 2: 2652, 0: 1456})

Epoch :  34 loss training:  12.559333857148886 Time :  2744
accuracy train: 0.996029 val: 0.725373 test: 0.722483
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({0: 3288, 2: 2667, 1: 1445})

Epoch :  35 loss training:  11.002958382479846 Time :  2771
accuracy train: 0.998345 val: 0.686567 test: 0.721494
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({2: 3285, 0: 2676, 1: 1439})

Epoch :  36 loss training:  11.361178774386644 Time :  2807
accuracy train: 0.999007 val: 0.698507 test: 0.717536
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({0: 3287, 2: 2673, 1: 1440})

Epoch :  37 loss training:  11.139015138149261 Time :  2845
accuracy train: 0.999007 val: 0.695522 test: 0.720505
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({0: 3269, 2: 2695, 1: 1436})

Epoch :  38 loss training:  10.301481749862432 Time :  2889
accuracy train: 0.998676 val: 0.689552 test: 0.719763
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({1: 3262, 2: 2703, 0: 1435})

Epoch :  39 loss training:  9.126350737176836 Time :  2934
accuracy train: 1.000000 val: 0.686567 test: 0.728914
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({0: 3251, 2: 2709, 1: 1440})

Epoch :  40 loss training:  8.502563515678048 Time :  2971
accuracy train: 0.999669 val: 0.698507 test: 0.720999
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({2: 3271, 1: 2694, 0: 1435})

Epoch :  41 loss training:  7.885097019374371 Time :  3000
accuracy train: 0.999669 val: 0.695522 test: 0.721494
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({2: 3265, 1: 2697, 0: 1438})

Epoch :  42 loss training:  7.203812863212079 Time :  3027
accuracy train: 0.999669 val: 0.686567 test: 0.723225
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({1: 3277, 2: 2699, 0: 1424})

Epoch :  43 loss training:  8.090847291052341 Time :  3058
accuracy train: 1.000000 val: 0.704478 test: 0.721989
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({0: 3290, 1: 2690, 2: 1420})

Epoch :  44 loss training:  6.4243769105523825 Time :  3103
accuracy train: 1.000000 val: 0.686567 test: 0.724709
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({2: 3289, 0: 2689, 1: 1422})

Epoch :  45 loss training:  6.779346347786486 Time :  3137
accuracy train: 1.000000 val: 0.695522 test: 0.721247
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({2: 3316, 0: 2672, 1: 1412})

Epoch :  46 loss training:  5.754889360629022 Time :  3169
accuracy train: 1.000000 val: 0.695522 test: 0.716052
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({1: 3324, 0: 2666, 2: 1410})

Epoch :  47 loss training:  6.227329113520682 Time :  3200
accuracy train: 1.000000 val: 0.704478 test: 0.719268
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({0: 3340, 2: 2651, 1: 1409})

Epoch :  48 loss training:  5.431696130428463 Time :  3232
accuracy train: 0.999669 val: 0.695522 test: 0.721989
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({0: 3342, 1: 2663, 2: 1395})

Epoch :  49 loss training:  5.250520992092788 Time :  3284
accuracy train: 1.000000 val: 0.686567 test: 0.717784
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({2: 3346, 1: 2661, 0: 1393})

Epoch :  50 loss training:  4.958039579447359 Time :  3323
accuracy train: 1.000000 val: 0.698507 test: 0.711106
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({2: 3346, 0: 2660, 1: 1394})

Epoch :  51 loss training:  5.008371792733669 Time :  3352
accuracy train: 1.000000 val: 0.698507 test: 0.718773
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({0: 3323, 2: 2682, 1: 1395})

Epoch :  52 loss training:  4.437976044602692 Time :  3382
accuracy train: 1.000000 val: 0.674627 test: 0.717536
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({0: 3316, 1: 2702, 2: 1382})

Epoch :  53 loss training:  4.194310825783759 Time :  3411
accuracy train: 1.000000 val: 0.689552 test: 0.716300
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({0: 3334, 2: 2689, 1: 1377})

Epoch :  54 loss training:  4.198730393545702 Time :  3464
accuracy train: 1.000000 val: 0.695522 test: 0.714816
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({1: 3347, 2: 2677, 0: 1376})

Epoch :  55 loss training:  4.853713049087673 Time :  3499
accuracy train: 1.000000 val: 0.668657 test: 0.715063
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({1: 3350, 2: 2676, 0: 1374})

Epoch :  56 loss training:  3.732530400622636 Time :  3535
accuracy train: 1.000000 val: 0.695522 test: 0.720999
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({0: 3343, 1: 2683, 2: 1374})

Epoch :  57 loss training:  3.701550421770662 Time :  3565
accuracy train: 1.000000 val: 0.680597 test: 0.723473
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({0: 3355, 1: 2675, 2: 1370})

Epoch :  58 loss training:  3.2706934078596532 Time :  3595
accuracy train: 1.000000 val: 0.701493 test: 0.720999
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({2: 3363, 1: 2670, 0: 1367})

Epoch :  59 loss training:  3.4330078796483576 Time :  3636
accuracy train: 1.000000 val: 0.692537 test: 0.724709
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({2: 3371, 0: 2662, 1: 1367})

Epoch :  60 loss training:  2.8812600289238617 Time :  3688
accuracy train: 1.000000 val: 0.674627 test: 0.721494
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({0: 3377, 1: 2654, 2: 1369})

Epoch :  61 loss training:  2.6712205981602892 Time :  3719
accuracy train: 1.000000 val: 0.686567 test: 0.722483
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({1: 3369, 2: 2665, 0: 1366})

Epoch :  62 loss training:  3.0055247833952308 Time :  3745
accuracy train: 1.000000 val: 0.683582 test: 0.718279
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({1: 3365, 2: 2671, 0: 1364})

Epoch :  63 loss training:  2.568259439780377 Time :  3788
accuracy train: 1.000000 val: 0.677612 test: 0.722978
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({2: 3351, 1: 2686, 0: 1363})

Epoch :  64 loss training:  3.0270435850834474 Time :  3830
accuracy train: 1.000000 val: 0.689552 test: 0.720257
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({2: 3366, 0: 2678, 1: 1356})

Epoch :  65 loss training:  2.6646030535921454 Time :  3864
accuracy train: 1.000000 val: 0.680597 test: 0.720010
max validation accuracy : 0.725373 max acc epoch : 34 test accuracy : 0.722483
Counter({1: 3377, 0: 2668, 2: 1355})

========================================================================================================================================================================================================
max acc epoch :  34
max validation accuracy :  0.7253731343283583
test accuracy :  0.7224833044768736
last test_accuracy :  0.7200098936433341
max gap 19
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=782, weight_decay=1e-10)
device :  cuda:0
Counter({0: 2604, 1: 2534, 2: 2262})

Epoch :  1 loss training:  210.37943387031555 Time :  3902
accuracy train: 0.665784 val: 0.644776 test: 0.632204
max validation accuracy : 0.644776 max acc epoch : 1 test accuracy : 0.632204
Counter({0: 2725, 2: 2693, 1: 1982})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  140.47202652692795 Time :  3934
accuracy train: 0.733620 val: 0.626866 test: 0.661637
max validation accuracy : 0.644776 max acc epoch : 1 test accuracy : 0.632204
Counter({1: 2787, 0: 2645, 2: 1968})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.43069511651993 Time :  3986
accuracy train: 0.718729 val: 0.629851 test: 0.628494
max validation accuracy : 0.644776 max acc epoch : 1 test accuracy : 0.632204
Counter({2: 2730, 0: 2547, 1: 2123})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.08550056815147 Time :  4018
accuracy train: 0.806089 val: 0.674627 test: 0.696512
max validation accuracy : 0.674627 max acc epoch : 4 test accuracy : 0.696512
Counter({1: 3361, 2: 2486, 0: 1553})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.03133285045624 Time :  4052
accuracy train: 0.835208 val: 0.650746 test: 0.694534
max validation accuracy : 0.674627 max acc epoch : 4 test accuracy : 0.696512
Counter({1: 3271, 0: 2600, 2: 1529})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.62213476002216 Time :  4083
accuracy train: 0.852416 val: 0.698507 test: 0.705169
max validation accuracy : 0.698507 max acc epoch : 6 test accuracy : 0.705169
Counter({1: 3217, 2: 2653, 0: 1530})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  70.87509846687317 Time :  4112
accuracy train: 0.861681 val: 0.698507 test: 0.715063
max validation accuracy : 0.698507 max acc epoch : 6 test accuracy : 0.705169
Counter({2: 3204, 0: 2672, 1: 1524})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.18547895550728 Time :  4152
accuracy train: 0.860026 val: 0.701493 test: 0.713084
max validation accuracy : 0.701493 max acc epoch : 8 test accuracy : 0.713084
Counter({0: 3205, 1: 2688, 2: 1507})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.56369507312775 Time :  4182
accuracy train: 0.885506 val: 0.689552 test: 0.711848
max validation accuracy : 0.701493 max acc epoch : 8 test accuracy : 0.713084
Counter({1: 3200, 0: 2702, 2: 1498})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.59944999217987 Time :  4217
accuracy train: 0.893117 val: 0.683582 test: 0.719515
max validation accuracy : 0.701493 max acc epoch : 8 test accuracy : 0.713084
Counter({1: 3186, 0: 2709, 2: 1505})

Epoch :  11 loss training:  55.60851374268532 Time :  4251
accuracy train: 0.906023 val: 0.704478 test: 0.716547
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({2: 3189, 0: 2702, 1: 1509})

Epoch :  12 loss training:  54.15735402703285 Time :  4294
accuracy train: 0.915950 val: 0.686567 test: 0.715805
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({1: 3185, 0: 2701, 2: 1514})

Epoch :  13 loss training:  51.0183000266552 Time :  4336
accuracy train: 0.921906 val: 0.671642 test: 0.722978
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({0: 3182, 2: 2702, 1: 1516})

Epoch :  14 loss training:  48.840581968426704 Time :  4373
accuracy train: 0.929517 val: 0.695522 test: 0.721989
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({2: 3192, 1: 2688, 0: 1520})

Epoch :  15 loss training:  44.1071886792779 Time :  4411
accuracy train: 0.931833 val: 0.680597 test: 0.713826
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({1: 3183, 2: 2689, 0: 1528})

Epoch :  16 loss training:  42.61803910136223 Time :  4442
accuracy train: 0.947055 val: 0.683582 test: 0.721494
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({0: 3194, 2: 2685, 1: 1521})

Epoch :  17 loss training:  39.12919406592846 Time :  4490
accuracy train: 0.952680 val: 0.674627 test: 0.718526
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({0: 3187, 1: 2700, 2: 1513})

Epoch :  18 loss training:  36.510274931788445 Time :  4520
accuracy train: 0.955659 val: 0.686567 test: 0.724215
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({2: 3192, 0: 2697, 1: 1511})

Epoch :  19 loss training:  36.225814424455166 Time :  4552
accuracy train: 0.957644 val: 0.680597 test: 0.722731
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({0: 3179, 2: 2713, 1: 1508})

Epoch :  20 loss training:  32.89295310527086 Time :  4583
accuracy train: 0.966248 val: 0.692537 test: 0.721247
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({0: 3197, 2: 2700, 1: 1503})

Epoch :  21 loss training:  31.077027536928654 Time :  4614
accuracy train: 0.976837 val: 0.698507 test: 0.721494
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({2: 3196, 0: 2687, 1: 1517})

Epoch :  22 loss training:  28.118966542184353 Time :  4656
accuracy train: 0.976506 val: 0.704478 test: 0.720999
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({2: 3222, 1: 2671, 0: 1507})

Epoch :  23 loss training:  26.254388719797134 Time :  4690
accuracy train: 0.982131 val: 0.695522 test: 0.721494
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({2: 3256, 1: 2644, 0: 1500})

Epoch :  24 loss training:  27.01566108688712 Time :  4728
accuracy train: 0.983786 val: 0.686567 test: 0.720257
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({1: 3230, 0: 2682, 2: 1488})

Epoch :  25 loss training:  22.509227722883224 Time :  4766
accuracy train: 0.985440 val: 0.698507 test: 0.725451
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({1: 3231, 0: 2691, 2: 1478})

Epoch :  26 loss training:  22.504846453666687 Time :  4801
accuracy train: 0.987426 val: 0.680597 test: 0.720257
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({1: 3230, 2: 2706, 0: 1464})

Epoch :  27 loss training:  20.661718361079693 Time :  4859
accuracy train: 0.990735 val: 0.695522 test: 0.716052
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({0: 3223, 1: 2712, 2: 1465})

Epoch :  28 loss training:  19.001901172101498 Time :  4895
accuracy train: 0.987756 val: 0.689552 test: 0.722483
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({1: 3223, 2: 2709, 0: 1468})

Epoch :  29 loss training:  18.246697396039963 Time :  4932
accuracy train: 0.993382 val: 0.686567 test: 0.728914
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({2: 3258, 0: 2676, 1: 1466})

Epoch :  30 loss training:  16.52810398861766 Time :  4973
accuracy train: 0.996029 val: 0.683582 test: 0.720505
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({0: 3299, 1: 2643, 2: 1458})

Epoch :  31 loss training:  16.047338854521513 Time :  5019
accuracy train: 0.994044 val: 0.698507 test: 0.722978
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({1: 3273, 2: 2669, 0: 1458})

Epoch :  32 loss training:  14.071493616327643 Time :  5059
accuracy train: 0.996360 val: 0.686567 test: 0.720257
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({1: 3293, 2: 2653, 0: 1454})

Epoch :  33 loss training:  13.527117358520627 Time :  5093
accuracy train: 0.993051 val: 0.683582 test: 0.721741
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({0: 3287, 1: 2670, 2: 1443})

Epoch :  34 loss training:  12.451892973855138 Time :  5120
accuracy train: 0.996691 val: 0.701493 test: 0.722731
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({0: 3296, 1: 2666, 2: 1438})

Epoch :  35 loss training:  11.844181936234236 Time :  5147
accuracy train: 0.997684 val: 0.698507 test: 0.725946
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({1: 3297, 2: 2667, 0: 1436})

Epoch :  36 loss training:  10.58642007689923 Time :  5186
accuracy train: 0.999007 val: 0.683582 test: 0.722236
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({1: 3305, 0: 2657, 2: 1438})

Epoch :  37 loss training:  11.026635051704943 Time :  5224
accuracy train: 0.999338 val: 0.695522 test: 0.721494
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({2: 3306, 1: 2661, 0: 1433})

Epoch :  38 loss training:  9.643324321135879 Time :  5259
accuracy train: 0.999338 val: 0.704478 test: 0.718526
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({1: 3310, 0: 2660, 2: 1430})

Epoch :  39 loss training:  8.47882719989866 Time :  5296
accuracy train: 0.999669 val: 0.701493 test: 0.720752
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({2: 3305, 1: 2666, 0: 1429})

Epoch :  40 loss training:  8.091094042174518 Time :  5332
accuracy train: 0.999669 val: 0.698507 test: 0.720257
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({2: 3316, 1: 2657, 0: 1427})

Epoch :  41 loss training:  7.80369403026998 Time :  5379
accuracy train: 0.999338 val: 0.695522 test: 0.720010
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({2: 3309, 0: 2663, 1: 1428})

Epoch :  42 loss training:  7.14975605905056 Time :  5414
accuracy train: 0.999007 val: 0.704478 test: 0.718031
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.716547
Counter({1: 3339, 2: 2634, 0: 1427})

========================================================================================================================================================================================================
max acc epoch :  11
max validation accuracy :  0.7044776119402985
test accuracy :  0.716547118476379
last test_accuracy :  0.7180311649765025
max gap 3
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=782, weight_decay=1e-10)
device :  cuda:0
Counter({0: 2604, 1: 2534, 2: 2262})

Epoch :  1 loss training:  210.15175169706345 Time :  5457
accuracy train: 0.666777 val: 0.644776 test: 0.636656
max validation accuracy : 0.644776 max acc epoch : 1 test accuracy : 0.636656
Counter({2: 2894, 0: 2427, 1: 2079})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  140.3375443816185 Time :  5489
accuracy train: 0.736598 val: 0.623881 test: 0.662874
max validation accuracy : 0.644776 max acc epoch : 1 test accuracy : 0.636656
Counter({2: 2748, 1: 2707, 0: 1945})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  120.50275206565857 Time :  5522
accuracy train: 0.716082 val: 0.597015 test: 0.626762
max validation accuracy : 0.644776 max acc epoch : 1 test accuracy : 0.636656
Counter({2: 3167, 1: 2636, 0: 1597})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.17177906632423 Time :  5555
accuracy train: 0.809398 val: 0.686567 test: 0.691566
max validation accuracy : 0.686567 max acc epoch : 4 test accuracy : 0.691566
Counter({2: 3219, 1: 2656, 0: 1525})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  89.95172548294067 Time :  5589
accuracy train: 0.828590 val: 0.662687 test: 0.694286
max validation accuracy : 0.686567 max acc epoch : 4 test accuracy : 0.691566
Counter({1: 3175, 0: 2731, 2: 1494})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.37108758091927 Time :  5631
accuracy train: 0.849437 val: 0.686567 test: 0.703685
max validation accuracy : 0.686567 max acc epoch : 4 test accuracy : 0.691566
Counter({1: 3163, 2: 2669, 0: 1568})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  70.94277043640614 Time :  5675
accuracy train: 0.868961 val: 0.689552 test: 0.713579
max validation accuracy : 0.689552 max acc epoch : 7 test accuracy : 0.713579
Counter({0: 3162, 2: 2669, 1: 1569})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.54437454044819 Time :  5728
accuracy train: 0.860688 val: 0.686567 test: 0.712590
max validation accuracy : 0.689552 max acc epoch : 7 test accuracy : 0.713579
Counter({1: 3121, 0: 2712, 2: 1567})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.01503826677799 Time :  5753
accuracy train: 0.881866 val: 0.695522 test: 0.709869
max validation accuracy : 0.695522 max acc epoch : 9 test accuracy : 0.709869
Counter({1: 3154, 0: 2697, 2: 1549})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  58.854675978422165 Time :  5779
accuracy train: 0.889146 val: 0.683582 test: 0.722483
max validation accuracy : 0.695522 max acc epoch : 9 test accuracy : 0.709869
Counter({1: 3167, 2: 2701, 0: 1532})

Epoch :  11 loss training:  56.68801361322403 Time :  5804
accuracy train: 0.904368 val: 0.698507 test: 0.719763
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({1: 3176, 0: 2695, 2: 1529})

Epoch :  12 loss training:  51.826480910182 Time :  5829
accuracy train: 0.913964 val: 0.689552 test: 0.718031
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({0: 3178, 1: 2694, 2: 1528})

Epoch :  13 loss training:  50.1260971724987 Time :  5856
accuracy train: 0.919259 val: 0.680597 test: 0.719763
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({1: 3192, 2: 2687, 0: 1521})

Epoch :  14 loss training:  46.79038767516613 Time :  5882
accuracy train: 0.930841 val: 0.671642 test: 0.719268
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({2: 3226, 1: 2658, 0: 1516})

Epoch :  15 loss training:  44.62647506594658 Time :  5909
accuracy train: 0.930841 val: 0.695522 test: 0.721741
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({2: 3216, 0: 2665, 1: 1519})

Epoch :  16 loss training:  42.58133140951395 Time :  5933
accuracy train: 0.946062 val: 0.692537 test: 0.722978
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({0: 3246, 1: 2638, 2: 1516})

Epoch :  17 loss training:  41.36368919163942 Time :  5956
accuracy train: 0.952680 val: 0.668657 test: 0.722236
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({0: 3232, 1: 2653, 2: 1515})

Epoch :  18 loss training:  38.75628046691418 Time :  5984
accuracy train: 0.954666 val: 0.692537 test: 0.721989
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({1: 3253, 0: 2636, 2: 1511})

Epoch :  19 loss training:  35.98212672024965 Time :  6010
accuracy train: 0.961284 val: 0.686567 test: 0.721989
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({2: 3264, 0: 2628, 1: 1508})

Epoch :  20 loss training:  33.08228477835655 Time :  6039
accuracy train: 0.971542 val: 0.686567 test: 0.725204
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({1: 3271, 2: 2620, 0: 1509})

Epoch :  21 loss training:  30.862686842679977 Time :  6063
accuracy train: 0.975513 val: 0.677612 test: 0.718279
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({2: 3275, 1: 2614, 0: 1511})

Epoch :  22 loss training:  30.208384446799755 Time :  6088
accuracy train: 0.976175 val: 0.686567 test: 0.721989
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({0: 3297, 2: 2600, 1: 1503})

Epoch :  23 loss training:  27.207415711134672 Time :  6118
accuracy train: 0.981800 val: 0.683582 test: 0.720752
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({2: 3284, 1: 2617, 0: 1499})

Epoch :  24 loss training:  25.44894003123045 Time :  6146
accuracy train: 0.979484 val: 0.683582 test: 0.725451
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({2: 3283, 0: 2637, 1: 1480})

Epoch :  25 loss training:  24.174412179738283 Time :  6171
accuracy train: 0.985109 val: 0.680597 test: 0.722236
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({1: 3283, 0: 2644, 2: 1473})

Epoch :  26 loss training:  21.900117751210928 Time :  6199
accuracy train: 0.988749 val: 0.674627 test: 0.724462
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({2: 3286, 1: 2639, 0: 1475})

Epoch :  27 loss training:  20.92459060624242 Time :  6230
accuracy train: 0.988418 val: 0.677612 test: 0.720010
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({1: 3315, 0: 2618, 2: 1467})

Epoch :  28 loss training:  19.587354835122824 Time :  6275
accuracy train: 0.991066 val: 0.689552 test: 0.723473
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({0: 3310, 1: 2610, 2: 1480})

Epoch :  29 loss training:  18.761421460658312 Time :  6305
accuracy train: 0.992720 val: 0.680597 test: 0.718526
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({0: 3313, 1: 2615, 2: 1472})

Epoch :  30 loss training:  17.148416113108397 Time :  6337
accuracy train: 0.994705 val: 0.674627 test: 0.715063
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({2: 3319, 1: 2615, 0: 1466})

Epoch :  31 loss training:  17.069967405870557 Time :  6362
accuracy train: 0.994044 val: 0.689552 test: 0.721989
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({1: 3324, 0: 2614, 2: 1462})

Epoch :  32 loss training:  14.847910024225712 Time :  6389
accuracy train: 0.996360 val: 0.689552 test: 0.718279
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({1: 3314, 2: 2621, 0: 1465})

Epoch :  33 loss training:  14.742717949673533 Time :  6416
accuracy train: 0.996360 val: 0.683582 test: 0.723225
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({0: 3305, 2: 2632, 1: 1463})

Epoch :  34 loss training:  13.409783206880093 Time :  6441
accuracy train: 0.997353 val: 0.692537 test: 0.723225
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({2: 3292, 0: 2643, 1: 1465})

Epoch :  35 loss training:  12.411679040640593 Time :  6466
accuracy train: 0.997353 val: 0.689552 test: 0.724462
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({0: 3289, 1: 2652, 2: 1459})

Epoch :  36 loss training:  10.824579820036888 Time :  6490
accuracy train: 0.999669 val: 0.692537 test: 0.724709
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({1: 3300, 0: 2647, 2: 1453})

Epoch :  37 loss training:  10.152985556051135 Time :  6511
accuracy train: 0.997684 val: 0.683582 test: 0.725451
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({0: 3312, 2: 2645, 1: 1443})

Epoch :  38 loss training:  9.22928087413311 Time :  6545
accuracy train: 0.998015 val: 0.695522 test: 0.718279
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({2: 3313, 1: 2648, 0: 1439})

Epoch :  39 loss training:  8.615234634373337 Time :  6570
accuracy train: 0.999007 val: 0.686567 test: 0.722483
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({0: 3336, 1: 2629, 2: 1435})

Epoch :  40 loss training:  8.505926753394306 Time :  6597
accuracy train: 0.999007 val: 0.680597 test: 0.718031
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({0: 3338, 2: 2627, 1: 1435})

Epoch :  41 loss training:  7.463237188756466 Time :  6627
accuracy train: 0.999669 val: 0.674627 test: 0.719763
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({2: 3343, 1: 2622, 0: 1435})

Epoch :  42 loss training:  6.792370532639325 Time :  6665
accuracy train: 0.999669 val: 0.698507 test: 0.717042
max validation accuracy : 0.698507 max acc epoch : 11 test accuracy : 0.719763
Counter({1: 3367, 0: 2614, 2: 1419})

========================================================================================================================================================================================================
max acc epoch :  11
max validation accuracy :  0.6985074626865672
test accuracy :  0.7197625525599802
last test_accuracy :  0.7170418006430869
max gap 3
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=782, weight_decay=1e-10)
device :  cuda:0
Counter({0: 2604, 1: 2534, 2: 2262})

Epoch :  1 loss training:  210.49743485450745 Time :  6703
accuracy train: 0.675381 val: 0.638806 test: 0.635914
max validation accuracy : 0.638806 max acc epoch : 1 test accuracy : 0.635914
Counter({2: 2822, 1: 2647, 0: 1931})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  140.04250991344452 Time :  6730
accuracy train: 0.732958 val: 0.638806 test: 0.663121
max validation accuracy : 0.638806 max acc epoch : 1 test accuracy : 0.635914
Counter({2: 2826, 0: 2638, 1: 1936})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.42626631259918 Time :  6758
accuracy train: 0.719722 val: 0.608955 test: 0.635419
max validation accuracy : 0.638806 max acc epoch : 1 test accuracy : 0.635914
Counter({1: 2743, 0: 2587, 2: 2070})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.4535139799118 Time :  6782
accuracy train: 0.801125 val: 0.689552 test: 0.696512
max validation accuracy : 0.689552 max acc epoch : 4 test accuracy : 0.696512
Counter({1: 3368, 2: 2515, 0: 1517})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.3641446530819 Time :  6820
accuracy train: 0.831899 val: 0.659701 test: 0.693544
max validation accuracy : 0.689552 max acc epoch : 4 test accuracy : 0.696512
Counter({2: 3228, 0: 2681, 1: 1491})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.31926134228706 Time :  6844
accuracy train: 0.848776 val: 0.686567 test: 0.704427
max validation accuracy : 0.689552 max acc epoch : 4 test accuracy : 0.696512
Counter({0: 3220, 1: 2688, 2: 1492})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  70.36093938350677 Time :  6866
accuracy train: 0.863336 val: 0.695522 test: 0.717042
max validation accuracy : 0.695522 max acc epoch : 7 test accuracy : 0.717042
Counter({0: 3223, 2: 2688, 1: 1489})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.41192118823528 Time :  6887
accuracy train: 0.860026 val: 0.704478 test: 0.713826
max validation accuracy : 0.704478 max acc epoch : 8 test accuracy : 0.713826
Counter({0: 3210, 1: 2705, 2: 1485})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.39578825235367 Time :  6914
accuracy train: 0.882528 val: 0.692537 test: 0.714321
max validation accuracy : 0.704478 max acc epoch : 8 test accuracy : 0.713826
Counter({1: 3220, 0: 2696, 2: 1484})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  58.956404596567154 Time :  6941
accuracy train: 0.894110 val: 0.680597 test: 0.715558
max validation accuracy : 0.704478 max acc epoch : 8 test accuracy : 0.713826
Counter({0: 3206, 2: 2707, 1: 1487})

Epoch :  11 loss training:  54.69541844725609 Time :  6969
accuracy train: 0.908008 val: 0.701493 test: 0.712837
max validation accuracy : 0.704478 max acc epoch : 8 test accuracy : 0.713826
Counter({2: 3203, 0: 2705, 1: 1492})

Epoch :  12 loss training:  53.501948937773705 Time :  7005
accuracy train: 0.917935 val: 0.695522 test: 0.716547
max validation accuracy : 0.704478 max acc epoch : 8 test accuracy : 0.713826
Counter({0: 3194, 2: 2704, 1: 1502})

Epoch :  13 loss training:  50.964570969343185 Time :  7039
accuracy train: 0.924222 val: 0.686567 test: 0.720999
max validation accuracy : 0.704478 max acc epoch : 8 test accuracy : 0.713826
Counter({1: 3201, 0: 2690, 2: 1509})

Epoch :  14 loss training:  48.76248377561569 Time :  7065
accuracy train: 0.933488 val: 0.692537 test: 0.720505
max validation accuracy : 0.704478 max acc epoch : 8 test accuracy : 0.713826
Counter({0: 3209, 2: 2675, 1: 1516})

Epoch :  15 loss training:  43.87901581078768 Time :  7110
accuracy train: 0.934150 val: 0.692537 test: 0.716052
max validation accuracy : 0.704478 max acc epoch : 8 test accuracy : 0.713826
Counter({2: 3204, 0: 2674, 1: 1522})

Epoch :  16 loss training:  42.39704638719559 Time :  7136
accuracy train: 0.949040 val: 0.701493 test: 0.721494
max validation accuracy : 0.704478 max acc epoch : 8 test accuracy : 0.713826
Counter({0: 3213, 1: 2669, 2: 1518})

Epoch :  17 loss training:  38.891436249017715 Time :  7164
accuracy train: 0.953011 val: 0.692537 test: 0.718773
max validation accuracy : 0.704478 max acc epoch : 8 test accuracy : 0.713826
Counter({0: 3212, 1: 2684, 2: 1504})

Epoch :  18 loss training:  35.83946195989847 Time :  7189
accuracy train: 0.956982 val: 0.695522 test: 0.721247
max validation accuracy : 0.704478 max acc epoch : 8 test accuracy : 0.713826
Counter({0: 3219, 1: 2687, 2: 1494})

Epoch :  19 loss training:  35.73157565295696 Time :  7213
accuracy train: 0.955989 val: 0.680597 test: 0.714074
max validation accuracy : 0.704478 max acc epoch : 8 test accuracy : 0.713826
Counter({0: 3217, 1: 2690, 2: 1493})

Epoch :  20 loss training:  32.817251823842525 Time :  7255
accuracy train: 0.968895 val: 0.710448 test: 0.721741
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({1: 3228, 2: 2673, 0: 1499})

Epoch :  21 loss training:  30.55341547727585 Time :  7279
accuracy train: 0.976506 val: 0.710448 test: 0.722483
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({2: 3227, 0: 2666, 1: 1507})

Epoch :  22 loss training:  28.004220589995384 Time :  7303
accuracy train: 0.977829 val: 0.707463 test: 0.726193
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({2: 3255, 0: 2643, 1: 1502})

Epoch :  23 loss training:  26.50430776178837 Time :  7329
accuracy train: 0.984447 val: 0.692537 test: 0.724957
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({0: 3272, 2: 2635, 1: 1493})

Epoch :  24 loss training:  25.26566606014967 Time :  7353
accuracy train: 0.982793 val: 0.686567 test: 0.719515
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({2: 3268, 0: 2638, 1: 1494})

Epoch :  25 loss training:  23.362288273870945 Time :  7395
accuracy train: 0.985440 val: 0.707463 test: 0.722731
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({2: 3250, 0: 2660, 1: 1490})

Epoch :  26 loss training:  22.491887215524912 Time :  7422
accuracy train: 0.989080 val: 0.701493 test: 0.718031
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({0: 3261, 2: 2657, 1: 1482})

Epoch :  27 loss training:  19.411076858639717 Time :  7447
accuracy train: 0.992389 val: 0.689552 test: 0.722483
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({1: 3275, 2: 2644, 0: 1481})

Epoch :  28 loss training:  18.878830302506685 Time :  7471
accuracy train: 0.991066 val: 0.698507 test: 0.724215
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({0: 3283, 1: 2639, 2: 1478})

Epoch :  29 loss training:  17.844460105523467 Time :  7497
accuracy train: 0.991727 val: 0.698507 test: 0.728419
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({0: 3282, 1: 2638, 2: 1480})

Epoch :  30 loss training:  16.926948472857475 Time :  7533
accuracy train: 0.995036 val: 0.704478 test: 0.719268
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({0: 3285, 1: 2645, 2: 1470})

Epoch :  31 loss training:  14.443443765863776 Time :  7559
accuracy train: 0.993382 val: 0.707463 test: 0.725451
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({1: 3290, 0: 2647, 2: 1463})

Epoch :  32 loss training:  13.528298815712333 Time :  7582
accuracy train: 0.996691 val: 0.692537 test: 0.724709
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({2: 3297, 0: 2649, 1: 1454})

Epoch :  33 loss training:  12.08320651203394 Time :  7609
accuracy train: 0.997022 val: 0.701493 test: 0.722483
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({2: 3315, 1: 2646, 0: 1439})

Epoch :  34 loss training:  13.219230070710182 Time :  7632
accuracy train: 0.997022 val: 0.698507 test: 0.723473
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({2: 3300, 0: 2659, 1: 1441})

Epoch :  35 loss training:  11.960883505642414 Time :  7674
accuracy train: 0.998345 val: 0.689552 test: 0.725699
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({0: 3262, 1: 2692, 2: 1446})

Epoch :  36 loss training:  10.663852885365486 Time :  7700
accuracy train: 0.999007 val: 0.698507 test: 0.727183
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({0: 3259, 2: 2698, 1: 1443})

Epoch :  37 loss training:  9.714988956227899 Time :  7726
accuracy train: 0.998345 val: 0.710448 test: 0.725451
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({2: 3264, 0: 2690, 1: 1446})

Epoch :  38 loss training:  9.636142056435347 Time :  7753
accuracy train: 0.998676 val: 0.710448 test: 0.721741
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({1: 3268, 0: 2685, 2: 1447})

Epoch :  39 loss training:  8.698181963060051 Time :  7779
accuracy train: 1.000000 val: 0.701493 test: 0.721741
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({0: 3283, 2: 2670, 1: 1447})

Epoch :  40 loss training:  8.424830993637443 Time :  7818
accuracy train: 0.999338 val: 0.704478 test: 0.722731
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({0: 3304, 2: 2653, 1: 1443})

Epoch :  41 loss training:  7.446498983539641 Time :  7842
accuracy train: 1.000000 val: 0.689552 test: 0.720010
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({2: 3316, 1: 2640, 0: 1444})

Epoch :  42 loss training:  7.013333008624613 Time :  7867
accuracy train: 0.999669 val: 0.707463 test: 0.720505
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({0: 3318, 2: 2650, 1: 1432})

Epoch :  43 loss training:  7.574279339984059 Time :  7890
accuracy train: 1.000000 val: 0.698507 test: 0.723720
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({0: 3315, 2: 2655, 1: 1430})

Epoch :  44 loss training:  6.660227206535637 Time :  7915
accuracy train: 1.000000 val: 0.686567 test: 0.722978
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({1: 3320, 2: 2657, 0: 1423})

Epoch :  45 loss training:  5.959376561455429 Time :  7956
accuracy train: 1.000000 val: 0.692537 test: 0.718526
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({2: 3346, 1: 2633, 0: 1421})

Epoch :  46 loss training:  6.014750557020307 Time :  7984
accuracy train: 0.999338 val: 0.686567 test: 0.723225
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({0: 3351, 2: 2638, 1: 1411})

Epoch :  47 loss training:  5.963565762154758 Time :  8008
accuracy train: 0.999669 val: 0.701493 test: 0.713579
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({2: 3329, 1: 2660, 0: 1411})

Epoch :  48 loss training:  4.757571998052299 Time :  8033
accuracy train: 1.000000 val: 0.695522 test: 0.727677
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({0: 3334, 1: 2663, 2: 1403})

Epoch :  49 loss training:  4.4139604261145 Time :  8058
accuracy train: 1.000000 val: 0.695522 test: 0.722978
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({0: 3349, 2: 2661, 1: 1390})

Epoch :  50 loss training:  4.945402269717306 Time :  8090
accuracy train: 1.000000 val: 0.674627 test: 0.718031
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({2: 3357, 0: 2654, 1: 1389})

Epoch :  51 loss training:  4.663158088456839 Time :  8115
accuracy train: 1.000000 val: 0.692537 test: 0.719515
max validation accuracy : 0.710448 max acc epoch : 20 test accuracy : 0.721741
Counter({0: 3360, 1: 2650, 2: 1390})

========================================================================================================================================================================================================
max acc epoch :  20
max validation accuracy :  0.7104477611940299
test accuracy :  0.7217412812268118
last test_accuracy :  0.7195152114766262
max gap 12
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=782, weight_decay=1e-10)
device :  cuda:0
Counter({0: 2604, 1: 2534, 2: 2262})

Epoch :  1 loss training:  210.49520993232727 Time :  8145
accuracy train: 0.664792 val: 0.644776 test: 0.636656
max validation accuracy : 0.644776 max acc epoch : 1 test accuracy : 0.636656
Counter({0: 3048, 1: 2358, 2: 1994})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  140.24871516227722 Time :  8171
accuracy train: 0.730642 val: 0.632836 test: 0.663121
max validation accuracy : 0.644776 max acc epoch : 1 test accuracy : 0.636656
Counter({2: 2818, 1: 2675, 0: 1907})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.45576256513596 Time :  8194
accuracy train: 0.712442 val: 0.611940 test: 0.624784
max validation accuracy : 0.644776 max acc epoch : 1 test accuracy : 0.636656
Counter({2: 2907, 0: 2622, 1: 1871})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.43965128064156 Time :  8223
accuracy train: 0.807743 val: 0.674627 test: 0.690824
max validation accuracy : 0.674627 max acc epoch : 4 test accuracy : 0.690824
Counter({0: 3270, 2: 2619, 1: 1511})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  89.74795737862587 Time :  8246
accuracy train: 0.820979 val: 0.662687 test: 0.695770
max validation accuracy : 0.674627 max acc epoch : 4 test accuracy : 0.690824
Counter({2: 3259, 0: 2663, 1: 1478})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.9222183227539 Time :  8273
accuracy train: 0.850761 val: 0.686567 test: 0.704675
max validation accuracy : 0.686567 max acc epoch : 6 test accuracy : 0.704675
Counter({2: 3287, 1: 2615, 0: 1498})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  71.07485884428024 Time :  8300
accuracy train: 0.869292 val: 0.686567 test: 0.717042
max validation accuracy : 0.686567 max acc epoch : 6 test accuracy : 0.704675
Counter({0: 3262, 1: 2644, 2: 1494})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.98753699660301 Time :  8334
accuracy train: 0.862343 val: 0.686567 test: 0.712590
max validation accuracy : 0.686567 max acc epoch : 6 test accuracy : 0.704675
Counter({2: 3231, 1: 2665, 0: 1504})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.39791692793369 Time :  8369
accuracy train: 0.886499 val: 0.683582 test: 0.712095
max validation accuracy : 0.686567 max acc epoch : 6 test accuracy : 0.704675
Counter({2: 3224, 0: 2674, 1: 1502})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  58.57471923530102 Time :  8408
accuracy train: 0.886830 val: 0.698507 test: 0.709374
max validation accuracy : 0.698507 max acc epoch : 10 test accuracy : 0.709374
Counter({1: 3220, 2: 2680, 0: 1500})

Epoch :  11 loss training:  57.74559326469898 Time :  8438
accuracy train: 0.904368 val: 0.698507 test: 0.718773
max validation accuracy : 0.698507 max acc epoch : 10 test accuracy : 0.709374
Counter({2: 3224, 0: 2678, 1: 1498})

Epoch :  12 loss training:  51.70425945520401 Time :  8463
accuracy train: 0.910655 val: 0.704478 test: 0.712095
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.712095
Counter({0: 3229, 2: 2667, 1: 1504})

Epoch :  13 loss training:  49.91072055697441 Time :  8497
accuracy train: 0.917273 val: 0.692537 test: 0.718279
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.712095
Counter({2: 3241, 0: 2664, 1: 1495})

Epoch :  14 loss training:  47.377784229815006 Time :  8524
accuracy train: 0.929517 val: 0.686567 test: 0.720010
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.712095
Counter({2: 3271, 0: 2631, 1: 1498})

Epoch :  15 loss training:  44.533607222139835 Time :  8551
accuracy train: 0.931833 val: 0.695522 test: 0.717042
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.712095
Counter({1: 3278, 0: 2623, 2: 1499})

Epoch :  16 loss training:  42.9041291475296 Time :  8577
accuracy train: 0.946062 val: 0.677612 test: 0.723720
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.712095
Counter({1: 3288, 0: 2618, 2: 1494})

Epoch :  17 loss training:  40.947888776659966 Time :  8602
accuracy train: 0.954004 val: 0.671642 test: 0.719268
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.712095
Counter({1: 3283, 2: 2616, 0: 1501})

Epoch :  18 loss training:  39.06150510162115 Time :  8641
accuracy train: 0.954997 val: 0.689552 test: 0.721989
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.712095
Counter({2: 3310, 0: 2594, 1: 1496})

Epoch :  19 loss training:  36.65516351163387 Time :  8666
accuracy train: 0.959960 val: 0.698507 test: 0.715805
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.712095
Counter({1: 3310, 0: 2589, 2: 1501})

Epoch :  20 loss training:  33.691639706492424 Time :  8691
accuracy train: 0.970549 val: 0.695522 test: 0.722483
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.712095
Counter({0: 3333, 1: 2569, 2: 1498})

Epoch :  21 loss training:  31.70335677266121 Time :  8715
accuracy train: 0.978160 val: 0.695522 test: 0.718526
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.712095
Counter({2: 3336, 1: 2558, 0: 1506})

Epoch :  22 loss training:  29.827208429574966 Time :  8742
accuracy train: 0.976506 val: 0.692537 test: 0.723225
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.712095
Counter({1: 3370, 2: 2529, 0: 1501})

Epoch :  23 loss training:  27.311628993600607 Time :  8779
accuracy train: 0.982793 val: 0.683582 test: 0.723473
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.712095
Counter({2: 3367, 1: 2534, 0: 1499})

Epoch :  24 loss training:  25.828993774950504 Time :  8806
accuracy train: 0.983786 val: 0.677612 test: 0.718526
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.712095
Counter({0: 3335, 2: 2567, 1: 1498})

Epoch :  25 loss training:  23.603650219738483 Time :  8833
accuracy train: 0.984778 val: 0.704478 test: 0.720752
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.712095
Counter({1: 3298, 0: 2605, 2: 1497})

Epoch :  26 loss training:  22.440029818564653 Time :  8859
accuracy train: 0.988749 val: 0.683582 test: 0.721494
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.712095
Counter({1: 3308, 2: 2602, 0: 1490})

Epoch :  27 loss training:  20.564002208411694 Time :  8891
accuracy train: 0.987095 val: 0.689552 test: 0.720999
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.712095
Counter({0: 3350, 2: 2562, 1: 1488})

Epoch :  28 loss training:  20.200097382068634 Time :  8922
accuracy train: 0.990735 val: 0.692537 test: 0.720999
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.712095
Counter({0: 3357, 1: 2562, 2: 1481})

Epoch :  29 loss training:  17.899563373997808 Time :  8953
accuracy train: 0.993713 val: 0.686567 test: 0.724957
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.712095
Counter({0: 3379, 1: 2553, 2: 1468})

Epoch :  30 loss training:  16.767498426139355 Time :  8990
accuracy train: 0.995367 val: 0.698507 test: 0.718526
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.712095
Counter({2: 3390, 1: 2545, 0: 1465})

Epoch :  31 loss training:  15.596780195832253 Time :  9029
accuracy train: 0.995036 val: 0.692537 test: 0.716794
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.712095
Counter({1: 3397, 0: 2553, 2: 1450})

Epoch :  32 loss training:  14.720245024189353 Time :  9066
accuracy train: 0.997022 val: 0.683582 test: 0.721989
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.712095
Counter({1: 3387, 2: 2571, 0: 1442})

Epoch :  33 loss training:  14.234729457646608 Time :  9100
accuracy train: 0.995036 val: 0.698507 test: 0.715558
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.712095
Counter({1: 3382, 0: 2576, 2: 1442})

Epoch :  34 loss training:  13.350158039480448 Time :  9133
accuracy train: 0.998345 val: 0.698507 test: 0.724215
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.712095
Counter({1: 3380, 2: 2573, 0: 1447})

Epoch :  35 loss training:  13.466794179752469 Time :  9167
accuracy train: 0.998345 val: 0.683582 test: 0.723473
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.712095
Counter({0: 3366, 2: 2597, 1: 1437})

Epoch :  36 loss training:  11.238973895087838 Time :  9209
accuracy train: 0.998676 val: 0.686567 test: 0.720257
max validation accuracy : 0.704478 max acc epoch : 12 test accuracy : 0.712095
Counter({2: 3373, 1: 2590, 0: 1437})

Epoch :  37 loss training:  10.63282366655767 Time :  9234
accuracy train: 0.999007 val: 0.707463 test: 0.719763
max validation accuracy : 0.707463 max acc epoch : 37 test accuracy : 0.719763
Counter({2: 3381, 0: 2586, 1: 1433})

Epoch :  38 loss training:  10.025855848100036 Time :  9260
accuracy train: 0.999338 val: 0.707463 test: 0.725451
max validation accuracy : 0.707463 max acc epoch : 37 test accuracy : 0.719763
Counter({2: 3373, 0: 2595, 1: 1432})

Epoch :  39 loss training:  8.862508246675134 Time :  9285
accuracy train: 0.999669 val: 0.701493 test: 0.717289
max validation accuracy : 0.707463 max acc epoch : 37 test accuracy : 0.719763
Counter({0: 3376, 1: 2596, 2: 1428})

Epoch :  40 loss training:  9.245192740112543 Time :  9317
accuracy train: 0.999669 val: 0.686567 test: 0.718279
max validation accuracy : 0.707463 max acc epoch : 37 test accuracy : 0.719763
Counter({0: 3371, 1: 2602, 2: 1427})

Epoch :  41 loss training:  7.928115196991712 Time :  9342
accuracy train: 0.999669 val: 0.686567 test: 0.718279
max validation accuracy : 0.707463 max acc epoch : 37 test accuracy : 0.719763
Counter({2: 3381, 1: 2590, 0: 1429})

Epoch :  42 loss training:  7.075839572586119 Time :  9380
accuracy train: 0.999669 val: 0.701493 test: 0.723473
max validation accuracy : 0.707463 max acc epoch : 37 test accuracy : 0.719763
Counter({2: 3398, 1: 2588, 0: 1414})

Epoch :  43 loss training:  7.698510223068297 Time :  9416
accuracy train: 0.999669 val: 0.701493 test: 0.718279
max validation accuracy : 0.707463 max acc epoch : 37 test accuracy : 0.719763
Counter({1: 3411, 0: 2579, 2: 1410})

Epoch :  44 loss training:  6.427335688844323 Time :  9449
accuracy train: 1.000000 val: 0.701493 test: 0.720505
max validation accuracy : 0.707463 max acc epoch : 37 test accuracy : 0.719763
Counter({0: 3414, 2: 2580, 1: 1406})

Epoch :  45 loss training:  6.60678577888757 Time :  9490
accuracy train: 1.000000 val: 0.701493 test: 0.720505
max validation accuracy : 0.707463 max acc epoch : 37 test accuracy : 0.719763
Counter({0: 3417, 1: 2585, 2: 1398})

Epoch :  46 loss training:  6.749811177607626 Time :  9522
accuracy train: 0.999669 val: 0.713433 test: 0.719268
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({0: 3407, 2: 2596, 1: 1397})

Epoch :  47 loss training:  6.105756607837975 Time :  9549
accuracy train: 1.000000 val: 0.707463 test: 0.719515
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({0: 3406, 1: 2597, 2: 1397})

Epoch :  48 loss training:  5.476076038554311 Time :  9575
accuracy train: 0.999669 val: 0.701493 test: 0.723473
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({2: 3414, 1: 2594, 0: 1392})

Epoch :  49 loss training:  5.455605790950358 Time :  9609
accuracy train: 1.000000 val: 0.701493 test: 0.722978
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({2: 3432, 0: 2585, 1: 1383})

Epoch :  50 loss training:  5.0476314960978925 Time :  9634
accuracy train: 1.000000 val: 0.686567 test: 0.719268
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({0: 3433, 1: 2584, 2: 1383})

Epoch :  51 loss training:  5.010267622768879 Time :  9658
accuracy train: 1.000000 val: 0.677612 test: 0.718279
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({0: 3446, 1: 2582, 2: 1372})

Epoch :  52 loss training:  4.156961595173925 Time :  9681
accuracy train: 1.000000 val: 0.677612 test: 0.716300
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({2: 3450, 0: 2583, 1: 1367})

Epoch :  53 loss training:  4.608603001339361 Time :  9706
accuracy train: 1.000000 val: 0.692537 test: 0.717289
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({1: 3453, 0: 2582, 2: 1365})

Epoch :  54 loss training:  3.683110171929002 Time :  9742
accuracy train: 1.000000 val: 0.680597 test: 0.720999
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({2: 3461, 1: 2573, 0: 1366})

Epoch :  55 loss training:  4.359657204011455 Time :  9768
accuracy train: 1.000000 val: 0.695522 test: 0.718526
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({1: 3466, 2: 2570, 0: 1364})

Epoch :  56 loss training:  3.8100614505819976 Time :  9803
accuracy train: 1.000000 val: 0.689552 test: 0.725699
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({0: 3471, 1: 2565, 2: 1364})

Epoch :  57 loss training:  3.370632342994213 Time :  9830
accuracy train: 1.000000 val: 0.680597 test: 0.713579
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({2: 3493, 1: 2555, 0: 1352})

Epoch :  58 loss training:  3.3062416641041636 Time :  9855
accuracy train: 1.000000 val: 0.701493 test: 0.720010
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({0: 3492, 2: 2559, 1: 1349})

Epoch :  59 loss training:  3.4396750947926193 Time :  9888
accuracy train: 1.000000 val: 0.695522 test: 0.718031
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({0: 3480, 2: 2579, 1: 1341})

Epoch :  60 loss training:  3.452879802323878 Time :  9912
accuracy train: 1.000000 val: 0.698507 test: 0.722978
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({0: 3477, 2: 2581, 1: 1342})

Epoch :  61 loss training:  2.529236233793199 Time :  9934
accuracy train: 1.000000 val: 0.692537 test: 0.720752
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({1: 3481, 2: 2582, 0: 1337})

Epoch :  62 loss training:  2.2398627987131476 Time :  9958
accuracy train: 1.000000 val: 0.701493 test: 0.720999
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({2: 3483, 0: 2583, 1: 1334})

Epoch :  63 loss training:  2.2498591862386093 Time :  9984
accuracy train: 1.000000 val: 0.683582 test: 0.725451
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({2: 3482, 1: 2588, 0: 1330})

Epoch :  64 loss training:  2.70724517328199 Time :  10025
accuracy train: 1.000000 val: 0.665672 test: 0.717536
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({1: 3487, 0: 2588, 2: 1325})

Epoch :  65 loss training:  2.615860272315331 Time :  10060
accuracy train: 1.000000 val: 0.698507 test: 0.717536
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({2: 3510, 0: 2574, 1: 1316})

Epoch :  66 loss training:  3.228680275264196 Time :  10088
accuracy train: 1.000000 val: 0.692537 test: 0.719515
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({0: 3503, 1: 2585, 2: 1312})

Epoch :  67 loss training:  2.794042647816241 Time :  10112
accuracy train: 1.000000 val: 0.695522 test: 0.721494
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({1: 3508, 0: 2586, 2: 1306})

Epoch :  68 loss training:  1.8524366955971345 Time :  10137
accuracy train: 1.000000 val: 0.695522 test: 0.722236
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({1: 3530, 2: 2567, 0: 1303})

Epoch :  69 loss training:  2.398086583474651 Time :  10167
accuracy train: 1.000000 val: 0.674627 test: 0.724215
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({2: 3663, 0: 2439, 1: 1298})

Epoch :  70 loss training:  1.9407627255422994 Time :  10194
accuracy train: 1.000000 val: 0.689552 test: 0.714816
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({2: 3673, 1: 2425, 0: 1302})

Epoch :  71 loss training:  1.7612020402448252 Time :  10219
accuracy train: 1.000000 val: 0.695522 test: 0.718031
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({2: 3675, 0: 2423, 1: 1302})

Epoch :  72 loss training:  1.575388135155663 Time :  10244
accuracy train: 1.000000 val: 0.686567 test: 0.720505
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({2: 3661, 1: 2438, 0: 1301})

Epoch :  73 loss training:  1.4254535067593679 Time :  10267
accuracy train: 1.000000 val: 0.686567 test: 0.722731
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({0: 3662, 1: 2435, 2: 1303})

Epoch :  74 loss training:  1.7424623700790107 Time :  10298
accuracy train: 0.999669 val: 0.698507 test: 0.721989
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({2: 3650, 0: 2444, 1: 1306})

Epoch :  75 loss training:  1.7424949239939451 Time :  10321
accuracy train: 1.000000 val: 0.695522 test: 0.723225
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({2: 3640, 1: 2451, 0: 1309})

Epoch :  76 loss training:  1.6195427001221105 Time :  10346
accuracy train: 1.000000 val: 0.689552 test: 0.721494
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({2: 3634, 1: 2453, 0: 1313})

Epoch :  77 loss training:  1.4572406485676765 Time :  10373
accuracy train: 1.000000 val: 0.695522 test: 0.722236
max validation accuracy : 0.713433 max acc epoch : 46 test accuracy : 0.719268
Counter({2: 3630, 0: 2453, 1: 1317})

========================================================================================================================================================================================================
max acc epoch :  46
max validation accuracy :  0.7134328358208956
test accuracy :  0.7192678703932723
last test_accuracy :  0.7222359633935197
max gap 25
========================================================================================================================================================================================================

itr : 6
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=782, weight_decay=1e-10)
device :  cuda:0
Counter({0: 2604, 1: 2534, 2: 2262})

Epoch :  1 loss training:  210.46527713537216 Time :  10408
accuracy train: 0.665453 val: 0.641791 test: 0.629236
max validation accuracy : 0.641791 max acc epoch : 1 test accuracy : 0.629236
Counter({1: 2788, 2: 2576, 0: 2036})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  140.13211691379547 Time :  10438
accuracy train: 0.734282 val: 0.632836 test: 0.663616
max validation accuracy : 0.641791 max acc epoch : 1 test accuracy : 0.629236
Counter({1: 2723, 0: 2695, 2: 1982})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.61201351881027 Time :  10467
accuracy train: 0.708802 val: 0.614925 test: 0.625773
max validation accuracy : 0.641791 max acc epoch : 1 test accuracy : 0.629236
Counter({1: 2647, 2: 2568, 0: 2185})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.52635645866394 Time :  10499
accuracy train: 0.808405 val: 0.680597 test: 0.694039
max validation accuracy : 0.680597 max acc epoch : 4 test accuracy : 0.694039
Counter({2: 3295, 1: 2577, 0: 1528})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  89.5896187722683 Time :  10525
accuracy train: 0.826274 val: 0.662687 test: 0.691566
max validation accuracy : 0.680597 max acc epoch : 4 test accuracy : 0.694039
Counter({1: 3222, 0: 2670, 2: 1508})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.23606149852276 Time :  10555
accuracy train: 0.846790 val: 0.698507 test: 0.702449
max validation accuracy : 0.698507 max acc epoch : 6 test accuracy : 0.702449
Counter({2: 3260, 1: 2612, 0: 1528})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  70.7532072365284 Time :  10580
accuracy train: 0.867968 val: 0.692537 test: 0.717289
max validation accuracy : 0.698507 max acc epoch : 6 test accuracy : 0.702449
Counter({0: 3261, 2: 2610, 1: 1529})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  67.02734491229057 Time :  10605
accuracy train: 0.856386 val: 0.692537 test: 0.713579
max validation accuracy : 0.698507 max acc epoch : 6 test accuracy : 0.702449
Counter({2: 3238, 1: 2657, 0: 1505})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.3312625437975 Time :  10636
accuracy train: 0.882197 val: 0.692537 test: 0.713332
max validation accuracy : 0.698507 max acc epoch : 6 test accuracy : 0.702449
Counter({2: 3261, 1: 2643, 0: 1496})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.11993686854839 Time :  10670
accuracy train: 0.891132 val: 0.680597 test: 0.717289
max validation accuracy : 0.698507 max acc epoch : 6 test accuracy : 0.702449
Counter({2: 3250, 0: 2656, 1: 1494})

Epoch :  11 loss training:  57.36483733355999 Time :  10699
accuracy train: 0.902383 val: 0.701493 test: 0.721989
max validation accuracy : 0.701493 max acc epoch : 11 test accuracy : 0.721989
Counter({1: 3257, 0: 2654, 2: 1489})

Epoch :  12 loss training:  52.20923292636871 Time :  10726
accuracy train: 0.911317 val: 0.698507 test: 0.713084
max validation accuracy : 0.701493 max acc epoch : 11 test accuracy : 0.721989
Counter({0: 3263, 1: 2643, 2: 1494})

Epoch :  13 loss training:  50.799397990107536 Time :  10750
accuracy train: 0.916281 val: 0.683582 test: 0.718526
max validation accuracy : 0.701493 max acc epoch : 11 test accuracy : 0.721989
Counter({1: 3273, 2: 2638, 0: 1489})

Epoch :  14 loss training:  47.606238551437855 Time :  10773
accuracy train: 0.931171 val: 0.695522 test: 0.718773
max validation accuracy : 0.701493 max acc epoch : 11 test accuracy : 0.721989
Counter({2: 3301, 1: 2607, 0: 1492})

Epoch :  15 loss training:  45.075815081596375 Time :  10797
accuracy train: 0.930510 val: 0.710448 test: 0.719515
max validation accuracy : 0.710448 max acc epoch : 15 test accuracy : 0.719515
Counter({0: 3299, 1: 2606, 2: 1495})

Epoch :  16 loss training:  43.01529711484909 Time :  10827
accuracy train: 0.946393 val: 0.692537 test: 0.724215
max validation accuracy : 0.710448 max acc epoch : 15 test accuracy : 0.719515
Counter({1: 3320, 0: 2591, 2: 1489})

Epoch :  17 loss training:  41.23903279006481 Time :  10855
accuracy train: 0.953673 val: 0.674627 test: 0.718526
max validation accuracy : 0.710448 max acc epoch : 15 test accuracy : 0.719515
Counter({1: 3310, 2: 2594, 0: 1496})

Epoch :  18 loss training:  39.594391614198685 Time :  10886
accuracy train: 0.954666 val: 0.686567 test: 0.720505
max validation accuracy : 0.710448 max acc epoch : 15 test accuracy : 0.719515
Counter({0: 3325, 2: 2586, 1: 1489})

Epoch :  19 loss training:  36.32657738775015 Time :  10922
accuracy train: 0.962938 val: 0.686567 test: 0.721494
max validation accuracy : 0.710448 max acc epoch : 15 test accuracy : 0.719515
Counter({2: 3332, 0: 2580, 1: 1488})

Epoch :  20 loss training:  33.463089779019356 Time :  10958
accuracy train: 0.969557 val: 0.689552 test: 0.717289
max validation accuracy : 0.710448 max acc epoch : 15 test accuracy : 0.719515
Counter({2: 3331, 1: 2584, 0: 1485})

Epoch :  21 loss training:  30.85854785144329 Time :  11000
accuracy train: 0.976175 val: 0.686567 test: 0.720999
max validation accuracy : 0.710448 max acc epoch : 15 test accuracy : 0.719515
Counter({1: 3346, 0: 2565, 2: 1489})

Epoch :  22 loss training:  29.4794979467988 Time :  11026
accuracy train: 0.976837 val: 0.695522 test: 0.723720
max validation accuracy : 0.710448 max acc epoch : 15 test accuracy : 0.719515
Counter({0: 3340, 1: 2571, 2: 1489})

Epoch :  23 loss training:  27.38116966187954 Time :  11051
accuracy train: 0.982462 val: 0.692537 test: 0.720010
max validation accuracy : 0.710448 max acc epoch : 15 test accuracy : 0.719515
Counter({1: 3332, 2: 2581, 0: 1487})

Epoch :  24 loss training:  26.37645671516657 Time :  11075
accuracy train: 0.981469 val: 0.683582 test: 0.722483
max validation accuracy : 0.710448 max acc epoch : 15 test accuracy : 0.719515
Counter({0: 3312, 1: 2604, 2: 1484})

Epoch :  25 loss training:  23.571581598371267 Time :  11106
accuracy train: 0.986764 val: 0.704478 test: 0.724215
max validation accuracy : 0.710448 max acc epoch : 15 test accuracy : 0.719515
Counter({1: 3283, 2: 2632, 0: 1485})

Epoch :  26 loss training:  21.790830425918102 Time :  11143
accuracy train: 0.989080 val: 0.698507 test: 0.720257
max validation accuracy : 0.710448 max acc epoch : 15 test accuracy : 0.719515
Counter({2: 3291, 0: 2627, 1: 1482})

Epoch :  27 loss training:  19.692146316170692 Time :  11180
accuracy train: 0.990735 val: 0.707463 test: 0.721741
max validation accuracy : 0.710448 max acc epoch : 15 test accuracy : 0.719515
Counter({1: 3294, 0: 2627, 2: 1479})

Epoch :  28 loss training:  19.57348494976759 Time :  11214
accuracy train: 0.989411 val: 0.704478 test: 0.723720
max validation accuracy : 0.710448 max acc epoch : 15 test accuracy : 0.719515
Counter({0: 3304, 1: 2618, 2: 1478})

Epoch :  29 loss training:  18.179857194423676 Time :  11239
accuracy train: 0.990404 val: 0.683582 test: 0.723473
max validation accuracy : 0.710448 max acc epoch : 15 test accuracy : 0.719515
Counter({0: 3302, 1: 2625, 2: 1473})

Epoch :  30 loss training:  17.22483380138874 Time :  11280
accuracy train: 0.994375 val: 0.701493 test: 0.721247
max validation accuracy : 0.710448 max acc epoch : 15 test accuracy : 0.719515
Counter({2: 3306, 1: 2637, 0: 1457})

Epoch :  31 loss training:  14.46207307651639 Time :  11305
accuracy train: 0.994044 val: 0.683582 test: 0.724709
max validation accuracy : 0.710448 max acc epoch : 15 test accuracy : 0.719515
Counter({1: 3316, 2: 2631, 0: 1453})

Epoch :  32 loss training:  14.178013671189547 Time :  11330
accuracy train: 0.996360 val: 0.683582 test: 0.723473
max validation accuracy : 0.710448 max acc epoch : 15 test accuracy : 0.719515
Counter({2: 3318, 1: 2630, 0: 1452})

Epoch :  33 loss training:  12.657639158889651 Time :  11354
accuracy train: 0.997022 val: 0.686567 test: 0.720505
max validation accuracy : 0.710448 max acc epoch : 15 test accuracy : 0.719515
Counter({0: 3314, 2: 2634, 1: 1452})

Epoch :  34 loss training:  13.164766352623701 Time :  11377
accuracy train: 0.996691 val: 0.692537 test: 0.719763
max validation accuracy : 0.710448 max acc epoch : 15 test accuracy : 0.719515
Counter({1: 3299, 2: 2651, 0: 1450})

Epoch :  35 loss training:  12.775272885337472 Time :  11403
accuracy train: 0.999007 val: 0.692537 test: 0.722731
max validation accuracy : 0.710448 max acc epoch : 15 test accuracy : 0.719515
Counter({0: 3286, 1: 2660, 2: 1454})

Epoch :  36 loss training:  10.77095015347004 Time :  11436
accuracy train: 0.998345 val: 0.704478 test: 0.723720
max validation accuracy : 0.710448 max acc epoch : 15 test accuracy : 0.719515
Counter({0: 3278, 1: 2671, 2: 1451})

Epoch :  37 loss training:  9.968656806275249 Time :  11467
accuracy train: 0.999338 val: 0.716418 test: 0.723967
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({2: 3271, 0: 2675, 1: 1454})

Epoch :  38 loss training:  10.14487868361175 Time :  11504
accuracy train: 0.998015 val: 0.710448 test: 0.723720
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({0: 3270, 2: 2680, 1: 1450})

Epoch :  39 loss training:  9.110758719034493 Time :  11532
accuracy train: 1.000000 val: 0.701493 test: 0.721989
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({1: 3281, 2: 2671, 0: 1448})

Epoch :  40 loss training:  8.439347598701715 Time :  11562
accuracy train: 0.999669 val: 0.704478 test: 0.720999
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({0: 3292, 1: 2662, 2: 1446})

Epoch :  41 loss training:  7.80963942874223 Time :  11587
accuracy train: 1.000000 val: 0.683582 test: 0.720752
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({2: 3298, 1: 2662, 0: 1440})

Epoch :  42 loss training:  7.485605472698808 Time :  11610
accuracy train: 0.999338 val: 0.692537 test: 0.719268
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({2: 3311, 1: 2666, 0: 1423})

Epoch :  43 loss training:  7.4461931344121695 Time :  11634
accuracy train: 1.000000 val: 0.698507 test: 0.723473
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({1: 3314, 2: 2662, 0: 1424})

Epoch :  44 loss training:  7.092644755728543 Time :  11658
accuracy train: 1.000000 val: 0.695522 test: 0.720752
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({0: 3317, 2: 2655, 1: 1428})

Epoch :  45 loss training:  6.56338586518541 Time :  11684
accuracy train: 1.000000 val: 0.686567 test: 0.720752
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({0: 3342, 1: 2634, 2: 1424})

Epoch :  46 loss training:  5.679181089159101 Time :  11718
accuracy train: 1.000000 val: 0.686567 test: 0.720752
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({0: 3349, 1: 2640, 2: 1411})

Epoch :  47 loss training:  5.8903105603531 Time :  11745
accuracy train: 1.000000 val: 0.686567 test: 0.714816
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({1: 3355, 0: 2640, 2: 1405})

Epoch :  48 loss training:  5.763245502486825 Time :  11777
accuracy train: 1.000000 val: 0.701493 test: 0.727677
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({0: 3336, 1: 2664, 2: 1400})

Epoch :  49 loss training:  4.747140821069479 Time :  11812
accuracy train: 0.999669 val: 0.710448 test: 0.728914
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({0: 3323, 2: 2674, 1: 1403})

Epoch :  50 loss training:  4.891866585239768 Time :  11846
accuracy train: 1.000000 val: 0.689552 test: 0.722483
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({2: 3295, 0: 2700, 1: 1405})

Epoch :  51 loss training:  5.241479349322617 Time :  11876
accuracy train: 1.000000 val: 0.686567 test: 0.719021
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({0: 3318, 2: 2692, 1: 1390})

Epoch :  52 loss training:  4.6452496806159616 Time :  11902
accuracy train: 1.000000 val: 0.671642 test: 0.721989
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({1: 3316, 0: 2694, 2: 1390})

Epoch :  53 loss training:  3.816921347286552 Time :  11927
accuracy train: 1.000000 val: 0.695522 test: 0.714321
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({0: 3336, 2: 2687, 1: 1377})

Epoch :  54 loss training:  3.6487616412341595 Time :  11952
accuracy train: 0.999669 val: 0.701493 test: 0.719515
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({0: 3343, 2: 2687, 1: 1370})

Epoch :  55 loss training:  4.056987505871803 Time :  11981
accuracy train: 1.000000 val: 0.683582 test: 0.719763
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({2: 3345, 1: 2688, 0: 1367})

Epoch :  56 loss training:  4.309076170669869 Time :  12009
accuracy train: 0.999669 val: 0.683582 test: 0.722236
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({1: 3331, 2: 2697, 0: 1372})

Epoch :  57 loss training:  3.2193403395358473 Time :  12035
accuracy train: 1.000000 val: 0.692537 test: 0.720010
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({0: 3333, 2: 2697, 1: 1370})

Epoch :  58 loss training:  2.7130479419138283 Time :  12062
accuracy train: 1.000000 val: 0.692537 test: 0.722236
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({2: 3322, 0: 2708, 1: 1370})

Epoch :  59 loss training:  3.3167040448170155 Time :  12087
accuracy train: 1.000000 val: 0.692537 test: 0.715558
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({2: 3328, 0: 2706, 1: 1366})

Epoch :  60 loss training:  2.283987022470683 Time :  12118
accuracy train: 1.000000 val: 0.674627 test: 0.717289
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({0: 3338, 2: 2700, 1: 1362})

Epoch :  61 loss training:  2.670118138892576 Time :  12162
accuracy train: 1.000000 val: 0.677612 test: 0.721989
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({2: 3346, 1: 2694, 0: 1360})

Epoch :  62 loss training:  3.2413580496795475 Time :  12189
accuracy train: 1.000000 val: 0.689552 test: 0.724957
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({1: 3350, 0: 2690, 2: 1360})

Epoch :  63 loss training:  2.2789326421916485 Time :  12215
accuracy train: 1.000000 val: 0.680597 test: 0.720999
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({0: 3346, 1: 2693, 2: 1361})

Epoch :  64 loss training:  2.470231784740463 Time :  12242
accuracy train: 1.000000 val: 0.683582 test: 0.718526
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({2: 3350, 0: 2687, 1: 1363})

Epoch :  65 loss training:  2.896421439712867 Time :  12273
accuracy train: 1.000000 val: 0.677612 test: 0.718031
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({2: 3369, 0: 2673, 1: 1358})

Epoch :  66 loss training:  3.511349144857377 Time :  12314
accuracy train: 1.000000 val: 0.665672 test: 0.722236
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({0: 3361, 1: 2686, 2: 1353})

Epoch :  67 loss training:  2.287402547255624 Time :  12338
accuracy train: 1.000000 val: 0.662687 test: 0.715558
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({2: 3366, 1: 2682, 0: 1352})

Epoch :  68 loss training:  1.8666439383523539 Time :  12362
accuracy train: 1.000000 val: 0.665672 test: 0.710611
max validation accuracy : 0.716418 max acc epoch : 37 test accuracy : 0.723967
Counter({2: 3375, 0: 2674, 1: 1351})

========================================================================================================================================================================================================
max acc epoch :  37
max validation accuracy :  0.7164179104477612
test accuracy :  0.7239673509769973
last test_accuracy :  0.7106109324758842
max gap 22
========================================================================================================================================================================================================

itr : 7
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=782, weight_decay=1e-10)
device :  cuda:0
Counter({0: 2604, 1: 2534, 2: 2262})

Epoch :  1 loss training:  210.4617218375206 Time :  12392
accuracy train: 0.666777 val: 0.638806 test: 0.632451
max validation accuracy : 0.638806 max acc epoch : 1 test accuracy : 0.632451
Counter({0: 2813, 2: 2638, 1: 1949})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  140.12417376041412 Time :  12422
accuracy train: 0.734944 val: 0.632836 test: 0.659164
max validation accuracy : 0.638806 max acc epoch : 1 test accuracy : 0.632451
Counter({0: 2807, 2: 2693, 1: 1900})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.43192285299301 Time :  12448
accuracy train: 0.717075 val: 0.617910 test: 0.631462
max validation accuracy : 0.638806 max acc epoch : 1 test accuracy : 0.632451
Counter({2: 2655, 1: 2652, 0: 2093})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  97.91002586483955 Time :  12473
accuracy train: 0.804103 val: 0.695522 test: 0.693792
max validation accuracy : 0.695522 max acc epoch : 4 test accuracy : 0.693792
Counter({1: 3282, 0: 2581, 2: 1537})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.64329326152802 Time :  12496
accuracy train: 0.829583 val: 0.650746 test: 0.692555
max validation accuracy : 0.695522 max acc epoch : 4 test accuracy : 0.693792
Counter({2: 3231, 0: 2659, 1: 1510})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.65683822333813 Time :  12519
accuracy train: 0.849107 val: 0.695522 test: 0.702449
max validation accuracy : 0.695522 max acc epoch : 4 test accuracy : 0.693792
Counter({1: 3197, 2: 2696, 0: 1507})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  71.30647519230843 Time :  12544
accuracy train: 0.860357 val: 0.698507 test: 0.717536
max validation accuracy : 0.698507 max acc epoch : 7 test accuracy : 0.717536
Counter({0: 3194, 2: 2705, 1: 1501})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  66.87179413437843 Time :  12568
accuracy train: 0.858372 val: 0.689552 test: 0.712837
max validation accuracy : 0.698507 max acc epoch : 7 test accuracy : 0.717536
Counter({2: 3188, 1: 2727, 0: 1485})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.13823382556438 Time :  12596
accuracy train: 0.884183 val: 0.692537 test: 0.712590
max validation accuracy : 0.698507 max acc epoch : 7 test accuracy : 0.717536
Counter({0: 3194, 1: 2727, 2: 1479})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.78314454853535 Time :  12623
accuracy train: 0.890139 val: 0.686567 test: 0.718526
max validation accuracy : 0.698507 max acc epoch : 7 test accuracy : 0.717536
Counter({2: 3181, 1: 2740, 0: 1479})

Epoch :  11 loss training:  56.01617279648781 Time :  12650
accuracy train: 0.904037 val: 0.683582 test: 0.716300
max validation accuracy : 0.698507 max acc epoch : 7 test accuracy : 0.717536
Counter({0: 3194, 1: 2727, 2: 1479})

Epoch :  12 loss training:  53.99306380748749 Time :  12689
accuracy train: 0.911979 val: 0.692537 test: 0.715310
max validation accuracy : 0.698507 max acc epoch : 7 test accuracy : 0.717536
Counter({0: 3207, 2: 2713, 1: 1480})

Epoch :  13 loss training:  51.9620455801487 Time :  12714
accuracy train: 0.922899 val: 0.662687 test: 0.719268
max validation accuracy : 0.698507 max acc epoch : 7 test accuracy : 0.717536
Counter({0: 3203, 2: 2712, 1: 1485})

Epoch :  14 loss training:  49.48477590084076 Time :  12740
accuracy train: 0.931833 val: 0.683582 test: 0.720999
max validation accuracy : 0.698507 max acc epoch : 7 test accuracy : 0.717536
Counter({1: 3220, 0: 2689, 2: 1491})

Epoch :  15 loss training:  44.65951344370842 Time :  12765
accuracy train: 0.930179 val: 0.701493 test: 0.717784
max validation accuracy : 0.701493 max acc epoch : 15 test accuracy : 0.717784
Counter({1: 3206, 2: 2694, 0: 1500})

Epoch :  16 loss training:  43.27825102955103 Time :  12807
accuracy train: 0.946062 val: 0.704478 test: 0.721741
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.721741
Counter({0: 3212, 2: 2687, 1: 1501})

Epoch :  17 loss training:  39.21255439519882 Time :  12835
accuracy train: 0.950695 val: 0.692537 test: 0.719515
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.721741
Counter({1: 3204, 0: 2698, 2: 1498})

Epoch :  18 loss training:  37.124055936932564 Time :  12867
accuracy train: 0.955659 val: 0.698507 test: 0.724215
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.721741
Counter({0: 3210, 1: 2694, 2: 1496})

Epoch :  19 loss training:  36.00451297312975 Time :  12903
accuracy train: 0.955659 val: 0.683582 test: 0.721989
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.721741
Counter({0: 3220, 2: 2687, 1: 1493})

Epoch :  20 loss training:  33.11841395497322 Time :  12944
accuracy train: 0.966578 val: 0.704478 test: 0.724462
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.721741
Counter({1: 3257, 2: 2656, 0: 1487})

Epoch :  21 loss training:  31.62818966805935 Time :  12973
accuracy train: 0.975844 val: 0.695522 test: 0.721494
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.721741
Counter({2: 3271, 0: 2638, 1: 1491})

Epoch :  22 loss training:  28.289452105760574 Time :  13001
accuracy train: 0.973858 val: 0.692537 test: 0.721741
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.721741
Counter({0: 3281, 2: 2627, 1: 1492})

Epoch :  23 loss training:  27.045760542154312 Time :  13033
accuracy train: 0.983124 val: 0.692537 test: 0.724957
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.721741
Counter({1: 3299, 0: 2626, 2: 1475})

Epoch :  24 loss training:  25.292348388582468 Time :  13069
accuracy train: 0.982462 val: 0.683582 test: 0.719515
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.721741
Counter({1: 3290, 0: 2643, 2: 1467})

Epoch :  25 loss training:  23.84680211544037 Time :  13101
accuracy train: 0.983455 val: 0.698507 test: 0.723967
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.721741
Counter({2: 3274, 0: 2661, 1: 1465})

Epoch :  26 loss training:  22.120411276817322 Time :  13134
accuracy train: 0.990735 val: 0.692537 test: 0.721494
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.721741
Counter({1: 3288, 2: 2651, 0: 1461})

Epoch :  27 loss training:  19.626296028494835 Time :  13167
accuracy train: 0.991727 val: 0.686567 test: 0.719268
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.721741
Counter({2: 3278, 1: 2654, 0: 1468})

Epoch :  28 loss training:  20.056446589529514 Time :  13206
accuracy train: 0.991396 val: 0.701493 test: 0.721247
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.721741
Counter({2: 3284, 0: 2644, 1: 1472})

Epoch :  29 loss training:  17.985266625881195 Time :  13233
accuracy train: 0.990404 val: 0.683582 test: 0.727430
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.721741
Counter({0: 3297, 1: 2633, 2: 1470})

Epoch :  30 loss training:  16.972674027085304 Time :  13262
accuracy train: 0.994705 val: 0.698507 test: 0.724215
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.721741
Counter({2: 3313, 1: 2632, 0: 1455})

Epoch :  31 loss training:  14.461735961958766 Time :  13292
accuracy train: 0.995367 val: 0.695522 test: 0.727183
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.721741
Counter({0: 3336, 1: 2614, 2: 1450})

Epoch :  32 loss training:  13.628142884932458 Time :  13327
accuracy train: 0.997684 val: 0.686567 test: 0.726441
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.721741
Counter({2: 3340, 0: 2612, 1: 1448})

Epoch :  33 loss training:  12.200846647843719 Time :  13354
accuracy train: 0.996029 val: 0.698507 test: 0.721741
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.721741
Counter({0: 3349, 2: 2609, 1: 1442})

Epoch :  34 loss training:  13.141915298998356 Time :  13384
accuracy train: 0.997353 val: 0.698507 test: 0.720010
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.721741
Counter({1: 3332, 2: 2628, 0: 1440})

Epoch :  35 loss training:  12.206312226131558 Time :  13411
accuracy train: 0.998676 val: 0.698507 test: 0.725204
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.721741
Counter({2: 3298, 0: 2649, 1: 1453})

Epoch :  36 loss training:  10.562737791799009 Time :  13442
accuracy train: 0.998676 val: 0.701493 test: 0.727677
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.721741
Counter({1: 3299, 0: 2650, 2: 1451})

Epoch :  37 loss training:  9.55867082066834 Time :  13470
accuracy train: 0.999007 val: 0.710448 test: 0.720010
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({0: 3305, 2: 2646, 1: 1449})

Epoch :  38 loss training:  9.43257668428123 Time :  13502
accuracy train: 0.999007 val: 0.701493 test: 0.727430
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({2: 3307, 1: 2643, 0: 1450})

Epoch :  39 loss training:  8.43848635815084 Time :  13533
accuracy train: 1.000000 val: 0.695522 test: 0.722236
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({0: 3321, 2: 2629, 1: 1450})

Epoch :  40 loss training:  7.799333130009472 Time :  13562
accuracy train: 0.999338 val: 0.704478 test: 0.723720
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({0: 3324, 2: 2630, 1: 1446})

Epoch :  41 loss training:  8.336796568706632 Time :  13602
accuracy train: 1.000000 val: 0.689552 test: 0.722731
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({1: 3324, 2: 2633, 0: 1443})

Epoch :  42 loss training:  7.067158058285713 Time :  13633
accuracy train: 0.999669 val: 0.695522 test: 0.721494
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({0: 3324, 1: 2639, 2: 1437})

Epoch :  43 loss training:  7.405251647345722 Time :  13663
accuracy train: 1.000000 val: 0.701493 test: 0.724215
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({0: 3348, 2: 2618, 1: 1434})

Epoch :  44 loss training:  6.389042533934116 Time :  13695
accuracy train: 0.999669 val: 0.707463 test: 0.725946
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({2: 3358, 1: 2620, 0: 1422})

Epoch :  45 loss training:  5.3856644900515676 Time :  13735
accuracy train: 1.000000 val: 0.710448 test: 0.724215
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({0: 3366, 2: 2621, 1: 1413})

Epoch :  46 loss training:  6.506196051836014 Time :  13762
accuracy train: 1.000000 val: 0.692537 test: 0.725699
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({0: 3359, 2: 2631, 1: 1410})

Epoch :  47 loss training:  5.805780744180083 Time :  13792
accuracy train: 1.000000 val: 0.695522 test: 0.727677
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({1: 3370, 0: 2623, 2: 1407})

Epoch :  48 loss training:  5.2998845730908215 Time :  13823
accuracy train: 0.999669 val: 0.683582 test: 0.723225
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({0: 3365, 1: 2627, 2: 1408})

Epoch :  49 loss training:  4.664100498426706 Time :  13855
accuracy train: 1.000000 val: 0.704478 test: 0.726193
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({0: 3374, 1: 2616, 2: 1410})

Epoch :  50 loss training:  4.568771171150729 Time :  13886
accuracy train: 1.000000 val: 0.701493 test: 0.720257
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({0: 3339, 1: 2650, 2: 1411})

Epoch :  51 loss training:  4.640057501848787 Time :  13914
accuracy train: 1.000000 val: 0.692537 test: 0.717784
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({0: 3354, 2: 2638, 1: 1408})

Epoch :  52 loss training:  4.669555432163179 Time :  13947
accuracy train: 1.000000 val: 0.686567 test: 0.718031
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({0: 3356, 2: 2643, 1: 1401})

Epoch :  53 loss training:  3.7679830426350236 Time :  13976
accuracy train: 1.000000 val: 0.704478 test: 0.718279
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({0: 3385, 2: 2617, 1: 1398})

Epoch :  54 loss training:  3.7028662506490946 Time :  14015
accuracy train: 0.999669 val: 0.704478 test: 0.721741
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({2: 3417, 1: 2602, 0: 1381})

Epoch :  55 loss training:  3.8831309797242284 Time :  14044
accuracy train: 1.000000 val: 0.683582 test: 0.716300
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({1: 3430, 2: 2595, 0: 1375})

Epoch :  56 loss training:  4.290935202501714 Time :  14071
accuracy train: 1.000000 val: 0.683582 test: 0.716794
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({2: 3412, 1: 2603, 0: 1385})

Epoch :  57 loss training:  3.2061877017840743 Time :  14100
accuracy train: 1.000000 val: 0.692537 test: 0.717784
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({2: 3406, 1: 2616, 0: 1378})

Epoch :  58 loss training:  2.7173944965470582 Time :  14130
accuracy train: 1.000000 val: 0.692537 test: 0.720010
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({2: 3399, 0: 2634, 1: 1367})

Epoch :  59 loss training:  3.150064783578273 Time :  14157
accuracy train: 1.000000 val: 0.683582 test: 0.720257
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({2: 3421, 1: 2627, 0: 1352})

Epoch :  60 loss training:  2.569928463548422 Time :  14182
accuracy train: 1.000000 val: 0.689552 test: 0.720257
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({0: 3437, 1: 2616, 2: 1347})

Epoch :  61 loss training:  2.5543329273350537 Time :  14206
accuracy train: 1.000000 val: 0.710448 test: 0.727183
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({1: 3414, 2: 2642, 0: 1344})

Epoch :  62 loss training:  2.2978574653388932 Time :  14229
accuracy train: 0.999669 val: 0.704478 test: 0.723225
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({2: 3425, 1: 2639, 0: 1336})

Epoch :  63 loss training:  2.510230728017632 Time :  14255
accuracy train: 1.000000 val: 0.698507 test: 0.721741
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({0: 3421, 2: 2644, 1: 1335})

Epoch :  64 loss training:  2.804695583996363 Time :  14281
accuracy train: 1.000000 val: 0.680597 test: 0.716547
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({1: 3426, 0: 2643, 2: 1331})

Epoch :  65 loss training:  2.775904515525326 Time :  14307
accuracy train: 1.000000 val: 0.686567 test: 0.726935
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({2: 3427, 1: 2643, 0: 1330})

Epoch :  66 loss training:  2.1866107283858582 Time :  14333
accuracy train: 1.000000 val: 0.695522 test: 0.720505
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({0: 3429, 1: 2641, 2: 1330})

Epoch :  67 loss training:  2.529833064414561 Time :  14375
accuracy train: 1.000000 val: 0.686567 test: 0.715558
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({0: 3420, 1: 2651, 2: 1329})

Epoch :  68 loss training:  1.956520170031581 Time :  14421
accuracy train: 1.000000 val: 0.689552 test: 0.724709
max validation accuracy : 0.710448 max acc epoch : 37 test accuracy : 0.720010
Counter({2: 3420, 1: 2650, 0: 1330})

========================================================================================================================================================================================================
max acc epoch :  37
max validation accuracy :  0.7104477611940299
test accuracy :  0.7200098936433341
last test_accuracy :  0.7247093742270592
max gap 21
========================================================================================================================================================================================================

itr : 8
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=782, weight_decay=1e-10)
device :  cuda:0
Counter({0: 2604, 1: 2534, 2: 2262})

Epoch :  1 loss training:  210.53593403100967 Time :  14458
accuracy train: 0.667770 val: 0.644776 test: 0.634677
max validation accuracy : 0.644776 max acc epoch : 1 test accuracy : 0.634677
Counter({2: 2915, 1: 2355, 0: 2130})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  139.68464821577072 Time :  14483
accuracy train: 0.733620 val: 0.626866 test: 0.659659
max validation accuracy : 0.644776 max acc epoch : 1 test accuracy : 0.634677
Counter({2: 2703, 1: 2663, 0: 2034})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.3888909816742 Time :  14508
accuracy train: 0.722369 val: 0.608955 test: 0.636656
max validation accuracy : 0.644776 max acc epoch : 1 test accuracy : 0.634677
Counter({0: 2708, 1: 2495, 2: 2197})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  100.82506620883942 Time :  14549
accuracy train: 0.806420 val: 0.674627 test: 0.701707
max validation accuracy : 0.674627 max acc epoch : 4 test accuracy : 0.701707
Counter({1: 3367, 2: 2544, 0: 1489})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  87.95867615938187 Time :  14573
accuracy train: 0.818663 val: 0.656716 test: 0.692802
max validation accuracy : 0.674627 max acc epoch : 4 test accuracy : 0.701707
Counter({2: 3377, 0: 2557, 1: 1466})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  79.74210354685783 Time :  14599
accuracy train: 0.844805 val: 0.683582 test: 0.709127
max validation accuracy : 0.683582 max acc epoch : 6 test accuracy : 0.709127
Counter({0: 3249, 2: 2649, 1: 1502})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  70.13388895988464 Time :  14624
accuracy train: 0.868630 val: 0.704478 test: 0.714321
max validation accuracy : 0.704478 max acc epoch : 7 test accuracy : 0.714321
Counter({0: 3239, 2: 2665, 1: 1496})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  67.41659085452557 Time :  14647
accuracy train: 0.860688 val: 0.692537 test: 0.712342
max validation accuracy : 0.704478 max acc epoch : 7 test accuracy : 0.714321
Counter({2: 3247, 1: 2662, 0: 1491})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.4076689183712 Time :  14677
accuracy train: 0.879219 val: 0.704478 test: 0.715310
max validation accuracy : 0.704478 max acc epoch : 7 test accuracy : 0.714321
Counter({1: 3253, 0: 2660, 2: 1487})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.305118411779404 Time :  14700
accuracy train: 0.892786 val: 0.710448 test: 0.718031
max validation accuracy : 0.710448 max acc epoch : 10 test accuracy : 0.718031
Counter({0: 3252, 1: 2662, 2: 1486})

Epoch :  11 loss training:  57.103084951639175 Time :  14726
accuracy train: 0.906023 val: 0.710448 test: 0.718526
max validation accuracy : 0.710448 max acc epoch : 10 test accuracy : 0.718031
Counter({1: 3250, 2: 2661, 0: 1489})

Epoch :  12 loss training:  51.64713077992201 Time :  14750
accuracy train: 0.914626 val: 0.698507 test: 0.718773
max validation accuracy : 0.710448 max acc epoch : 10 test accuracy : 0.718031
Counter({0: 3247, 2: 2665, 1: 1488})

Epoch :  13 loss training:  49.796013958752155 Time :  14778
accuracy train: 0.918266 val: 0.680597 test: 0.721989
max validation accuracy : 0.710448 max acc epoch : 10 test accuracy : 0.718031
Counter({2: 3250, 0: 2665, 1: 1485})

Epoch :  14 loss training:  48.09743206202984 Time :  14804
accuracy train: 0.933488 val: 0.683582 test: 0.719268
max validation accuracy : 0.710448 max acc epoch : 10 test accuracy : 0.718031
Counter({0: 3290, 1: 2628, 2: 1482})

Epoch :  15 loss training:  45.22094774246216 Time :  14828
accuracy train: 0.933819 val: 0.704478 test: 0.715558
max validation accuracy : 0.710448 max acc epoch : 10 test accuracy : 0.718031
Counter({2: 3294, 0: 2622, 1: 1484})

Epoch :  16 loss training:  43.52235162258148 Time :  14854
accuracy train: 0.945400 val: 0.698507 test: 0.721989
max validation accuracy : 0.710448 max acc epoch : 10 test accuracy : 0.718031
Counter({0: 3303, 1: 2613, 2: 1484})

Epoch :  17 loss training:  39.6608797237277 Time :  14878
accuracy train: 0.951688 val: 0.710448 test: 0.719268
max validation accuracy : 0.710448 max acc epoch : 10 test accuracy : 0.718031
Counter({0: 3307, 2: 2605, 1: 1488})

Epoch :  18 loss training:  37.85900381952524 Time :  14907
accuracy train: 0.956320 val: 0.713433 test: 0.720505
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({0: 3314, 2: 2602, 1: 1484})

Epoch :  19 loss training:  34.68400699645281 Time :  14943
accuracy train: 0.955989 val: 0.695522 test: 0.718279
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({1: 3307, 0: 2611, 2: 1482})

Epoch :  20 loss training:  34.186506524682045 Time :  14973
accuracy train: 0.968895 val: 0.689552 test: 0.725204
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({1: 3328, 2: 2585, 0: 1487})

Epoch :  21 loss training:  30.973723739385605 Time :  15005
accuracy train: 0.975844 val: 0.692537 test: 0.726688
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({0: 3355, 1: 2559, 2: 1486})

Epoch :  22 loss training:  29.418288834393024 Time :  15034
accuracy train: 0.977167 val: 0.698507 test: 0.726935
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({0: 3359, 1: 2556, 2: 1485})

Epoch :  23 loss training:  27.03195020928979 Time :  15067
accuracy train: 0.984447 val: 0.695522 test: 0.724957
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({0: 3394, 2: 2529, 1: 1477})

Epoch :  24 loss training:  25.598211251199245 Time :  15093
accuracy train: 0.981138 val: 0.704478 test: 0.727430
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({2: 3372, 0: 2558, 1: 1470})

Epoch :  25 loss training:  23.641580544412136 Time :  15123
accuracy train: 0.982462 val: 0.698507 test: 0.723473
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({2: 3368, 0: 2566, 1: 1466})

Epoch :  26 loss training:  22.793778706341982 Time :  15151
accuracy train: 0.986764 val: 0.683582 test: 0.720999
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({2: 3382, 1: 2555, 0: 1463})

Epoch :  27 loss training:  20.464354537427425 Time :  15179
accuracy train: 0.988749 val: 0.707463 test: 0.725451
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({0: 3392, 1: 2550, 2: 1458})

Epoch :  28 loss training:  20.04581204801798 Time :  15212
accuracy train: 0.989080 val: 0.695522 test: 0.724215
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({0: 3363, 1: 2576, 2: 1461})

Epoch :  29 loss training:  18.185791973024607 Time :  15236
accuracy train: 0.993382 val: 0.698507 test: 0.724957
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({0: 3377, 1: 2567, 2: 1456})

Epoch :  30 loss training:  17.021832041442394 Time :  15262
accuracy train: 0.996360 val: 0.683582 test: 0.722483
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({1: 3410, 2: 2539, 0: 1451})

Epoch :  31 loss training:  15.841962572187185 Time :  15289
accuracy train: 0.995698 val: 0.698507 test: 0.728172
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({2: 3385, 0: 2563, 1: 1452})

Epoch :  32 loss training:  14.283876111730933 Time :  15314
accuracy train: 0.998015 val: 0.701493 test: 0.724215
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({1: 3388, 2: 2557, 0: 1455})

Epoch :  33 loss training:  13.783768123015761 Time :  15344
accuracy train: 0.994705 val: 0.695522 test: 0.727677
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({2: 3381, 0: 2568, 1: 1451})

Epoch :  34 loss training:  12.398787962272763 Time :  15370
accuracy train: 0.996691 val: 0.698507 test: 0.724709
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({0: 3372, 1: 2580, 2: 1448})

Epoch :  35 loss training:  12.258329501375556 Time :  15396
accuracy train: 0.998345 val: 0.695522 test: 0.727183
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({0: 3386, 2: 2563, 1: 1451})

Epoch :  36 loss training:  11.669178247451782 Time :  15422
accuracy train: 0.998676 val: 0.683582 test: 0.721247
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({0: 3392, 1: 2556, 2: 1452})

Epoch :  37 loss training:  10.278513355180621 Time :  15447
accuracy train: 0.997684 val: 0.692537 test: 0.724957
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({2: 3412, 0: 2538, 1: 1450})

Epoch :  38 loss training:  9.244309578090906 Time :  15483
accuracy train: 0.999338 val: 0.692537 test: 0.727183
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({2: 3396, 1: 2562, 0: 1442})

Epoch :  39 loss training:  8.386330490000546 Time :  15506
accuracy train: 1.000000 val: 0.689552 test: 0.723473
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({0: 3399, 2: 2560, 1: 1441})

Epoch :  40 loss training:  8.61294709611684 Time :  15529
accuracy train: 0.999669 val: 0.683582 test: 0.720505
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({0: 3385, 1: 2578, 2: 1437})

Epoch :  41 loss training:  7.384884278289974 Time :  15554
accuracy train: 1.000000 val: 0.677612 test: 0.718526
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({1: 3395, 2: 2568, 0: 1437})

Epoch :  42 loss training:  6.9242670480161905 Time :  15579
accuracy train: 0.999669 val: 0.689552 test: 0.721494
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({1: 3410, 0: 2568, 2: 1422})

Epoch :  43 loss training:  7.415000807493925 Time :  15606
accuracy train: 1.000000 val: 0.704478 test: 0.724709
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({2: 3409, 0: 2572, 1: 1419})

Epoch :  44 loss training:  7.165909709408879 Time :  15636
accuracy train: 1.000000 val: 0.692537 test: 0.723225
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({0: 3413, 1: 2568, 2: 1419})

Epoch :  45 loss training:  5.914958446286619 Time :  15664
accuracy train: 1.000000 val: 0.695522 test: 0.717536
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({0: 3428, 2: 2554, 1: 1418})

Epoch :  46 loss training:  5.621388289146125 Time :  15689
accuracy train: 0.999669 val: 0.683582 test: 0.719515
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({1: 3403, 2: 2575, 0: 1422})

Epoch :  47 loss training:  5.597869338467717 Time :  15712
accuracy train: 1.000000 val: 0.689552 test: 0.722236
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({0: 3417, 2: 2565, 1: 1418})

Epoch :  48 loss training:  5.121351926587522 Time :  15737
accuracy train: 1.000000 val: 0.692537 test: 0.723967
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({1: 3426, 2: 2562, 0: 1412})

Epoch :  49 loss training:  5.331095692701638 Time :  15765
accuracy train: 1.000000 val: 0.683582 test: 0.722483
max validation accuracy : 0.713433 max acc epoch : 18 test accuracy : 0.720505
Counter({2: 3427, 1: 2555, 0: 1418})

========================================================================================================================================================================================================
max acc epoch :  18
max validation accuracy :  0.7134328358208956
test accuracy :  0.720504575810042
last test_accuracy :  0.7224833044768736
max gap 8
========================================================================================================================================================================================================

itr : 9
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=782, weight_decay=1e-10)
device :  cuda:0
Counter({0: 2604, 1: 2534, 2: 2262})

Epoch :  1 loss training:  210.47613513469696 Time :  15796
accuracy train: 0.665122 val: 0.644776 test: 0.628246
max validation accuracy : 0.644776 max acc epoch : 1 test accuracy : 0.628246
Counter({1: 2871, 0: 2378, 2: 2151})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  140.1758267879486 Time :  15821
accuracy train: 0.734613 val: 0.620896 test: 0.660648
max validation accuracy : 0.644776 max acc epoch : 1 test accuracy : 0.628246
Counter({0: 2714, 1: 2601, 2: 2085})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  122.1141305565834 Time :  15844
accuracy train: 0.718398 val: 0.608955 test: 0.632698
max validation accuracy : 0.644776 max acc epoch : 1 test accuracy : 0.628246
Counter({2: 2823, 0: 2533, 1: 2044})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.11975225806236 Time :  15876
accuracy train: 0.802449 val: 0.677612 test: 0.695028
max validation accuracy : 0.677612 max acc epoch : 4 test accuracy : 0.695028
Counter({2: 3362, 1: 2500, 0: 1538})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.09473559260368 Time :  15903
accuracy train: 0.832892 val: 0.659701 test: 0.690082
max validation accuracy : 0.677612 max acc epoch : 4 test accuracy : 0.695028
Counter({2: 3224, 1: 2670, 0: 1506})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  80.81810531020164 Time :  15932
accuracy train: 0.845797 val: 0.686567 test: 0.702943
max validation accuracy : 0.686567 max acc epoch : 6 test accuracy : 0.702943
Counter({0: 3210, 2: 2693, 1: 1497})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  71.07228538393974 Time :  15958
accuracy train: 0.860357 val: 0.686567 test: 0.716052
max validation accuracy : 0.686567 max acc epoch : 6 test accuracy : 0.702943
Counter({2: 3204, 0: 2702, 1: 1494})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  67.1908187866211 Time :  15988
accuracy train: 0.856386 val: 0.698507 test: 0.710858
max validation accuracy : 0.698507 max acc epoch : 8 test accuracy : 0.710858
Counter({1: 3205, 0: 2705, 2: 1490})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.72348389029503 Time :  16025
accuracy train: 0.883521 val: 0.683582 test: 0.713084
max validation accuracy : 0.698507 max acc epoch : 8 test accuracy : 0.710858
Counter({2: 3218, 0: 2703, 1: 1479})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.718668073415756 Time :  16054
accuracy train: 0.890801 val: 0.689552 test: 0.714568
max validation accuracy : 0.698507 max acc epoch : 8 test accuracy : 0.710858
Counter({2: 3212, 1: 2707, 0: 1481})

Epoch :  11 loss training:  56.8763552904129 Time :  16083
accuracy train: 0.904699 val: 0.695522 test: 0.714321
max validation accuracy : 0.698507 max acc epoch : 8 test accuracy : 0.710858
Counter({0: 3209, 2: 2703, 1: 1488})

Epoch :  12 loss training:  51.786412835121155 Time :  16113
accuracy train: 0.913964 val: 0.698507 test: 0.717042
max validation accuracy : 0.698507 max acc epoch : 8 test accuracy : 0.710858
Counter({0: 3209, 2: 2703, 1: 1488})

Epoch :  13 loss training:  50.36652337014675 Time :  16141
accuracy train: 0.921575 val: 0.704478 test: 0.719515
max validation accuracy : 0.704478 max acc epoch : 13 test accuracy : 0.719515
Counter({0: 3207, 2: 2705, 1: 1488})

Epoch :  14 loss training:  48.656877890229225 Time :  16183
accuracy train: 0.937128 val: 0.683582 test: 0.718031
max validation accuracy : 0.704478 max acc epoch : 13 test accuracy : 0.719515
Counter({1: 3212, 2: 2691, 0: 1497})

Epoch :  15 loss training:  45.67687080800533 Time :  16209
accuracy train: 0.935142 val: 0.713433 test: 0.716052
max validation accuracy : 0.713433 max acc epoch : 15 test accuracy : 0.716052
Counter({0: 3206, 1: 2693, 2: 1501})

Epoch :  16 loss training:  43.095817409455776 Time :  16239
accuracy train: 0.942091 val: 0.689552 test: 0.719021
max validation accuracy : 0.713433 max acc epoch : 15 test accuracy : 0.716052
Counter({2: 3213, 0: 2690, 1: 1497})

Epoch :  17 loss training:  39.357213012874126 Time :  16269
accuracy train: 0.950364 val: 0.701493 test: 0.715805
max validation accuracy : 0.713433 max acc epoch : 15 test accuracy : 0.716052
Counter({1: 3207, 0: 2692, 2: 1501})

Epoch :  18 loss training:  37.156310863792896 Time :  16307
accuracy train: 0.956320 val: 0.704478 test: 0.724957
max validation accuracy : 0.713433 max acc epoch : 15 test accuracy : 0.716052
Counter({0: 3232, 1: 2666, 2: 1502})

Epoch :  19 loss training:  34.25436869263649 Time :  16342
accuracy train: 0.957975 val: 0.695522 test: 0.716300
max validation accuracy : 0.713433 max acc epoch : 15 test accuracy : 0.716052
Counter({2: 3230, 0: 2670, 1: 1500})

Epoch :  20 loss training:  34.09501292556524 Time :  16374
accuracy train: 0.966909 val: 0.692537 test: 0.722978
max validation accuracy : 0.713433 max acc epoch : 15 test accuracy : 0.716052
Counter({1: 3240, 2: 2656, 0: 1504})

Epoch :  21 loss training:  31.33310617133975 Time :  16402
accuracy train: 0.973197 val: 0.713433 test: 0.721989
max validation accuracy : 0.713433 max acc epoch : 15 test accuracy : 0.716052
Counter({2: 3246, 0: 2653, 1: 1501})

Epoch :  22 loss training:  29.330534737557173 Time :  16438
accuracy train: 0.973527 val: 0.719403 test: 0.720752
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({0: 3243, 2: 2656, 1: 1501})

Epoch :  23 loss training:  26.89504036307335 Time :  16466
accuracy train: 0.983455 val: 0.698507 test: 0.722236
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({1: 3266, 2: 2640, 0: 1494})

Epoch :  24 loss training:  24.952157221734524 Time :  16491
accuracy train: 0.981469 val: 0.701493 test: 0.727430
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({2: 3249, 0: 2657, 1: 1494})

Epoch :  25 loss training:  24.296151384711266 Time :  16517
accuracy train: 0.981469 val: 0.698507 test: 0.724957
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({1: 3249, 0: 2664, 2: 1487})

Epoch :  26 loss training:  22.975320171564817 Time :  16547
accuracy train: 0.987095 val: 0.698507 test: 0.722731
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({1: 3267, 0: 2649, 2: 1484})

Epoch :  27 loss training:  20.616632411256433 Time :  16581
accuracy train: 0.989742 val: 0.692537 test: 0.723225
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({0: 3277, 1: 2646, 2: 1477})

Epoch :  28 loss training:  19.86878254264593 Time :  16614
accuracy train: 0.988087 val: 0.707463 test: 0.720752
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({0: 3274, 1: 2646, 2: 1480})

Epoch :  29 loss training:  17.951869474723935 Time :  16647
accuracy train: 0.993051 val: 0.701493 test: 0.722978
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({0: 3288, 1: 2637, 2: 1475})

Epoch :  30 loss training:  17.021449049934745 Time :  16680
accuracy train: 0.995036 val: 0.698507 test: 0.722483
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({2: 3311, 1: 2626, 0: 1463})

Epoch :  31 loss training:  15.86363061890006 Time :  16719
accuracy train: 0.996360 val: 0.701493 test: 0.722731
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({0: 3309, 2: 2625, 1: 1466})

Epoch :  32 loss training:  14.060216819867492 Time :  16750
accuracy train: 0.996691 val: 0.689552 test: 0.723720
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({1: 3294, 2: 2637, 0: 1469})

Epoch :  33 loss training:  13.454650802537799 Time :  16782
accuracy train: 0.996029 val: 0.692537 test: 0.725204
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({0: 3302, 2: 2642, 1: 1456})

Epoch :  34 loss training:  12.677208939567208 Time :  16813
accuracy train: 0.997353 val: 0.713433 test: 0.725204
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({1: 3297, 2: 2656, 0: 1447})

Epoch :  35 loss training:  12.428671030327678 Time :  16852
accuracy train: 0.997684 val: 0.698507 test: 0.723720
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({1: 3291, 0: 2659, 2: 1450})

Epoch :  36 loss training:  10.17173179704696 Time :  16885
accuracy train: 0.999007 val: 0.695522 test: 0.721247
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({0: 3292, 2: 2657, 1: 1451})

Epoch :  37 loss training:  10.520602528937161 Time :  16914
accuracy train: 0.999007 val: 0.692537 test: 0.720257
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({0: 3290, 1: 2656, 2: 1454})

Epoch :  38 loss training:  9.75918265990913 Time :  16940
accuracy train: 0.999338 val: 0.707463 test: 0.724215
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({1: 3303, 0: 2649, 2: 1448})

Epoch :  39 loss training:  8.641768279485404 Time :  16979
accuracy train: 0.999669 val: 0.686567 test: 0.721247
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({2: 3312, 0: 2644, 1: 1444})

Epoch :  40 loss training:  8.215852627530694 Time :  17006
accuracy train: 0.999669 val: 0.704478 test: 0.719515
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({2: 3328, 1: 2635, 0: 1437})

Epoch :  41 loss training:  7.601743385195732 Time :  17032
accuracy train: 0.999007 val: 0.713433 test: 0.721494
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({0: 3330, 1: 2634, 2: 1436})

Epoch :  42 loss training:  6.912992080673575 Time :  17058
accuracy train: 0.999007 val: 0.704478 test: 0.719021
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({2: 3347, 1: 2624, 0: 1429})

Epoch :  43 loss training:  7.521673238836229 Time :  17082
accuracy train: 1.000000 val: 0.698507 test: 0.717784
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({0: 3333, 1: 2632, 2: 1435})

Epoch :  44 loss training:  7.342434476129711 Time :  17124
accuracy train: 0.999669 val: 0.698507 test: 0.717042
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({1: 3357, 0: 2605, 2: 1438})

Epoch :  45 loss training:  6.444505273364484 Time :  17148
accuracy train: 1.000000 val: 0.695522 test: 0.717042
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({1: 3340, 0: 2618, 2: 1442})

Epoch :  46 loss training:  6.546233936212957 Time :  17174
accuracy train: 1.000000 val: 0.713433 test: 0.720010
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({1: 3300, 0: 2660, 2: 1440})

Epoch :  47 loss training:  5.807631166651845 Time :  17199
accuracy train: 0.999669 val: 0.704478 test: 0.719021
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({2: 3318, 1: 2646, 0: 1436})

Epoch :  48 loss training:  5.416609307285398 Time :  17226
accuracy train: 1.000000 val: 0.701493 test: 0.719268
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({2: 3305, 1: 2665, 0: 1430})

Epoch :  49 loss training:  5.054519206518307 Time :  17258
accuracy train: 1.000000 val: 0.701493 test: 0.723473
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({0: 3301, 2: 2673, 1: 1426})

Epoch :  50 loss training:  4.726676747202873 Time :  17283
accuracy train: 1.000000 val: 0.695522 test: 0.712095
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({0: 3278, 2: 2695, 1: 1427})

Epoch :  51 loss training:  4.797979354392737 Time :  17308
accuracy train: 1.000000 val: 0.698507 test: 0.723473
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({1: 3287, 0: 2689, 2: 1424})

Epoch :  52 loss training:  4.370638331398368 Time :  17339
accuracy train: 1.000000 val: 0.689552 test: 0.724462
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({0: 3271, 2: 2715, 1: 1414})

Epoch :  53 loss training:  4.429482319857925 Time :  17375
accuracy train: 1.000000 val: 0.704478 test: 0.718773
max validation accuracy : 0.719403 max acc epoch : 22 test accuracy : 0.720752
Counter({1: 3268, 0: 2716, 2: 1416})

========================================================================================================================================================================================================
max acc epoch :  22
max validation accuracy :  0.7194029850746269
test accuracy :  0.720751916893396
last test_accuracy :  0.7187731882265644
max gap 7
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.71343 	 test_accuracy : 0.72545 	 max_acc epoch :  20 	 last test_accuracy : 0.72174
k :  1 	 val_accuracy : 0.72537 	 test_accuracy : 0.72248 	 max_acc epoch :  34 	 last test_accuracy : 0.72001
k :  2 	 val_accuracy : 0.70448 	 test_accuracy : 0.71655 	 max_acc epoch :  11 	 last test_accuracy : 0.71803
k :  3 	 val_accuracy : 0.69851 	 test_accuracy : 0.71976 	 max_acc epoch :  11 	 last test_accuracy : 0.71704
k :  4 	 val_accuracy : 0.71045 	 test_accuracy : 0.72174 	 max_acc epoch :  20 	 last test_accuracy : 0.71952
k :  5 	 val_accuracy : 0.71343 	 test_accuracy : 0.71927 	 max_acc epoch :  46 	 last test_accuracy : 0.72224
k :  6 	 val_accuracy : 0.71642 	 test_accuracy : 0.72397 	 max_acc epoch :  37 	 last test_accuracy : 0.71061
k :  7 	 val_accuracy : 0.71045 	 test_accuracy : 0.72001 	 max_acc epoch :  37 	 last test_accuracy : 0.72471
k :  8 	 val_accuracy : 0.71343 	 test_accuracy : 0.72050 	 max_acc epoch :  18 	 last test_accuracy : 0.72248
k :  9 	 val_accuracy : 0.71940 	 test_accuracy : 0.72075 	 max_acc epoch :  22 	 last test_accuracy : 0.71877

avg :  	 val_accuracy : 0.71254 	 test_accuracy : 0.72105 	 last_accuracy : 0.71952
