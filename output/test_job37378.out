

date and time :  Mon Jun 14 21:40:46 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=882, tsne=False, weight_decay=1e-07)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  47.89747768267989 Time :  79
accuracy train: 0.941224 val: 0.938182 test: 0.953881
max validation accuracy : 0.938182 max acc epoch : 1 test accuracy : 0.953881
Counter({1: 4238, 0: 3453})
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  19.59734712354839 Time :  113
accuracy train: 0.966269 val: 0.954545 test: 0.962100
max validation accuracy : 0.954545 max acc epoch : 2 test accuracy : 0.962100
Counter({0: 4155, 1: 3536})
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  14.447629463858902 Time :  143
accuracy train: 0.979600 val: 0.958182 test: 0.956164
max validation accuracy : 0.958182 max acc epoch : 3 test accuracy : 0.956164
Counter({0: 4018, 1: 3673})
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  10.106412746477872 Time :  174
accuracy train: 0.983034 val: 0.963636 test: 0.954795
max validation accuracy : 0.963636 max acc epoch : 4 test accuracy : 0.954795
Counter({0: 3997, 1: 3694})
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  9.5431669652462 Time :  206
accuracy train: 0.987275 val: 0.969091 test: 0.964840
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.964840
Counter({1: 3975, 0: 3716})
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  8.995243832934648 Time :  236
accuracy train: 0.987073 val: 0.965455 test: 0.963470
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.964840
Counter({0: 3936, 1: 3755})
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  8.187484200578183 Time :  272
accuracy train: 0.988891 val: 0.970909 test: 0.968493
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.968493
Counter({1: 3928, 0: 3763})
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  7.278830305207521 Time :  309
accuracy train: 0.985659 val: 0.969091 test: 0.966667
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.968493
Counter({0: 3908, 1: 3783})
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  6.6509041944518685 Time :  354
accuracy train: 0.987679 val: 0.963636 test: 0.964840
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.968493
Counter({0: 3911, 1: 3780})
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  6.069563005585223 Time :  387
accuracy train: 0.989699 val: 0.969091 test: 0.967580
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.968493
Counter({1: 3908, 0: 3783})

Epoch :  11 loss training:  6.257882825331762 Time :  407
accuracy train: 0.990911 val: 0.967273 test: 0.965753
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.968493
Counter({0: 3906, 1: 3785})

Epoch :  12 loss training:  5.26690309937112 Time :  426
accuracy train: 0.992527 val: 0.965455 test: 0.966210
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.968493
Counter({0: 3903, 1: 3788})

Epoch :  13 loss training:  5.5675678418483585 Time :  448
accuracy train: 0.992931 val: 0.967273 test: 0.967123
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.968493
Counter({0: 3894, 1: 3797})

Epoch :  14 loss training:  5.129564689472318 Time :  470
accuracy train: 0.992729 val: 0.970909 test: 0.964840
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.968493
Counter({0: 3884, 1: 3807})

Epoch :  15 loss training:  4.916239559301175 Time :  491
accuracy train: 0.993739 val: 0.970909 test: 0.968950
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.968493
Counter({0: 3884, 1: 3807})

Epoch :  16 loss training:  4.92204886674881 Time :  511
accuracy train: 0.994345 val: 0.972727 test: 0.970776
max validation accuracy : 0.972727 max acc epoch : 16 test accuracy : 0.970776
Counter({1: 3880, 0: 3811})

Epoch :  17 loss training:  4.460324171115644 Time :  531
accuracy train: 0.994547 val: 0.970909 test: 0.968950
max validation accuracy : 0.972727 max acc epoch : 16 test accuracy : 0.970776
Counter({0: 3885, 1: 3806})

Epoch :  18 loss training:  5.029825555742718 Time :  550
accuracy train: 0.993941 val: 0.967273 test: 0.970776
max validation accuracy : 0.972727 max acc epoch : 16 test accuracy : 0.970776
Counter({1: 3883, 0: 3808})

Epoch :  19 loss training:  4.99224678761675 Time :  568
accuracy train: 0.995556 val: 0.970909 test: 0.967580
max validation accuracy : 0.972727 max acc epoch : 16 test accuracy : 0.970776
Counter({0: 3859, 1: 3832})

Epoch :  20 loss training:  4.19079295406118 Time :  588
accuracy train: 0.994547 val: 0.970909 test: 0.968493
max validation accuracy : 0.972727 max acc epoch : 16 test accuracy : 0.970776
Counter({1: 3860, 0: 3831})

Epoch :  21 loss training:  3.9185796410311013 Time :  605
accuracy train: 0.995354 val: 0.970909 test: 0.969406
max validation accuracy : 0.972727 max acc epoch : 16 test accuracy : 0.970776
Counter({0: 3856, 1: 3835})

Epoch :  22 loss training:  3.7673532222397625 Time :  631
accuracy train: 0.993537 val: 0.969091 test: 0.966210
max validation accuracy : 0.972727 max acc epoch : 16 test accuracy : 0.970776
Counter({0: 3858, 1: 3833})

Epoch :  23 loss training:  3.952023461461067 Time :  649
accuracy train: 0.995758 val: 0.969091 test: 0.968493
max validation accuracy : 0.972727 max acc epoch : 16 test accuracy : 0.970776
Counter({1: 3854, 0: 3837})

Epoch :  24 loss training:  3.9775226797210053 Time :  673
accuracy train: 0.995354 val: 0.972727 test: 0.970776
max validation accuracy : 0.972727 max acc epoch : 16 test accuracy : 0.970776
Counter({0: 3853, 1: 3838})

Epoch :  25 loss training:  3.4958090474247 Time :  710
accuracy train: 0.995354 val: 0.967273 test: 0.968950
max validation accuracy : 0.972727 max acc epoch : 16 test accuracy : 0.970776
Counter({1: 3849, 0: 3842})

Epoch :  26 loss training:  3.601236642629374 Time :  753
accuracy train: 0.995152 val: 0.970909 test: 0.970320
max validation accuracy : 0.972727 max acc epoch : 16 test accuracy : 0.970776
Counter({0: 3850, 1: 3841})

Epoch :  27 loss training:  3.191250783158466 Time :  790
accuracy train: 0.995960 val: 0.969091 test: 0.971233
max validation accuracy : 0.972727 max acc epoch : 16 test accuracy : 0.970776
Counter({1: 3849, 0: 3842})

========================================================================================================================================================================================================
best acc epoch :  16
validation accuracy :  0.9727272727272728
test accuracy :  0.9707762557077626
last test_accuracy :  0.9712328767123287
second best val :  0.9709090909090909
second best test :  0.9684931506849315
max gap 9
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=344, tsne=False, weight_decay=1e-07)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  46.5926658436656 Time :  853
accuracy train: 0.963846 val: 0.943636 test: 0.956164
max validation accuracy : 0.943636 max acc epoch : 1 test accuracy : 0.956164
Counter({0: 4129, 1: 3562})
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  18.75489968433976 Time :  893
accuracy train: 0.970309 val: 0.961818 test: 0.963014
max validation accuracy : 0.961818 max acc epoch : 2 test accuracy : 0.963014
Counter({0: 4091, 1: 3600})
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  14.048142643645406 Time :  934
accuracy train: 0.979600 val: 0.949091 test: 0.960731
max validation accuracy : 0.961818 max acc epoch : 2 test accuracy : 0.963014
Counter({1: 4034, 0: 3657})
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  10.424405323108658 Time :  973
accuracy train: 0.984448 val: 0.956364 test: 0.963927
max validation accuracy : 0.961818 max acc epoch : 2 test accuracy : 0.963014
Counter({0: 3967, 1: 3724})
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  9.53049332741648 Time :  1010
accuracy train: 0.981822 val: 0.960000 test: 0.963927
max validation accuracy : 0.961818 max acc epoch : 2 test accuracy : 0.963014
Counter({1: 3990, 0: 3701})
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  8.942185566294938 Time :  1056
accuracy train: 0.987073 val: 0.960000 test: 0.962557
max validation accuracy : 0.961818 max acc epoch : 2 test accuracy : 0.963014
Counter({1: 3937, 0: 3754})
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  8.009820484090596 Time :  1091
accuracy train: 0.990709 val: 0.958182 test: 0.969863
max validation accuracy : 0.961818 max acc epoch : 2 test accuracy : 0.963014
Counter({0: 3933, 1: 3758})
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  7.602976770605892 Time :  1110
accuracy train: 0.990103 val: 0.960000 test: 0.967580
max validation accuracy : 0.961818 max acc epoch : 2 test accuracy : 0.963014
Counter({1: 3929, 0: 3762})
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  6.71970896795392 Time :  1130
accuracy train: 0.989295 val: 0.960000 test: 0.967123
max validation accuracy : 0.961818 max acc epoch : 2 test accuracy : 0.963014
Counter({1: 3933, 0: 3758})
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  6.927472427021712 Time :  1149
accuracy train: 0.991517 val: 0.961818 test: 0.969863
max validation accuracy : 0.961818 max acc epoch : 2 test accuracy : 0.963014
Counter({1: 3928, 0: 3763})

Epoch :  11 loss training:  6.400332828285173 Time :  1181
accuracy train: 0.992325 val: 0.965455 test: 0.966667
max validation accuracy : 0.965455 max acc epoch : 11 test accuracy : 0.966667
Counter({1: 3926, 0: 3765})

Epoch :  12 loss training:  5.977430189144798 Time :  1201
accuracy train: 0.992527 val: 0.961818 test: 0.969406
max validation accuracy : 0.965455 max acc epoch : 11 test accuracy : 0.966667
Counter({0: 3898, 1: 3793})

Epoch :  13 loss training:  5.450898197945207 Time :  1219
accuracy train: 0.992527 val: 0.967273 test: 0.969863
max validation accuracy : 0.967273 max acc epoch : 13 test accuracy : 0.969863
Counter({0: 3886, 1: 3805})

Epoch :  14 loss training:  5.159833723213524 Time :  1239
accuracy train: 0.992325 val: 0.969091 test: 0.970776
max validation accuracy : 0.969091 max acc epoch : 14 test accuracy : 0.970776
Counter({1: 3886, 0: 3805})

Epoch :  15 loss training:  4.888824299909174 Time :  1266
accuracy train: 0.993739 val: 0.967273 test: 0.967580
max validation accuracy : 0.969091 max acc epoch : 14 test accuracy : 0.970776
Counter({0: 3908, 1: 3783})

Epoch :  16 loss training:  4.969601242861245 Time :  1293
accuracy train: 0.994143 val: 0.967273 test: 0.970320
max validation accuracy : 0.969091 max acc epoch : 14 test accuracy : 0.970776
Counter({1: 3904, 0: 3787})

Epoch :  17 loss training:  4.70295079232892 Time :  1317
accuracy train: 0.994345 val: 0.967273 test: 0.970320
max validation accuracy : 0.969091 max acc epoch : 14 test accuracy : 0.970776
Counter({0: 3901, 1: 3790})

Epoch :  18 loss training:  4.696497946511954 Time :  1340
accuracy train: 0.995152 val: 0.965455 test: 0.968950
max validation accuracy : 0.969091 max acc epoch : 14 test accuracy : 0.970776
Counter({1: 3889, 0: 3802})

Epoch :  19 loss training:  4.464155694004148 Time :  1371
accuracy train: 0.994547 val: 0.969091 test: 0.969863
max validation accuracy : 0.969091 max acc epoch : 14 test accuracy : 0.970776
Counter({0: 3881, 1: 3810})

Epoch :  20 loss training:  4.12952397915069 Time :  1395
accuracy train: 0.994951 val: 0.961818 test: 0.968950
max validation accuracy : 0.969091 max acc epoch : 14 test accuracy : 0.970776
Counter({1: 3868, 0: 3823})

Epoch :  21 loss training:  4.216460128373001 Time :  1416
accuracy train: 0.995556 val: 0.967273 test: 0.969863
max validation accuracy : 0.969091 max acc epoch : 14 test accuracy : 0.970776
Counter({0: 3853, 1: 3838})

Epoch :  22 loss training:  3.8995419815182686 Time :  1443
accuracy train: 0.995354 val: 0.967273 test: 0.968493
max validation accuracy : 0.969091 max acc epoch : 14 test accuracy : 0.970776
Counter({0: 3858, 1: 3833})

Epoch :  23 loss training:  3.650541107112076 Time :  1478
accuracy train: 0.994749 val: 0.961818 test: 0.969406
max validation accuracy : 0.969091 max acc epoch : 14 test accuracy : 0.970776
Counter({0: 3850, 1: 3841})

Epoch :  24 loss training:  3.4460693313158117 Time :  1496
accuracy train: 0.996162 val: 0.970909 test: 0.973059
max validation accuracy : 0.970909 max acc epoch : 24 test accuracy : 0.973059
Counter({0: 3857, 1: 3834})

Epoch :  25 loss training:  3.519301765918499 Time :  1524
accuracy train: 0.995556 val: 0.963636 test: 0.973059
max validation accuracy : 0.970909 max acc epoch : 24 test accuracy : 0.973059
Counter({0: 3846, 1: 3845})

Epoch :  26 loss training:  3.1704745167517103 Time :  1553
accuracy train: 0.995758 val: 0.963636 test: 0.972603
max validation accuracy : 0.970909 max acc epoch : 24 test accuracy : 0.973059
Counter({0: 3850, 1: 3841})

Epoch :  27 loss training:  3.2696322916599456 Time :  1588
accuracy train: 0.995758 val: 0.963636 test: 0.968950
max validation accuracy : 0.970909 max acc epoch : 24 test accuracy : 0.973059
Counter({0: 3854, 1: 3837})

Epoch :  28 loss training:  3.1311169884284027 Time :  1607
accuracy train: 0.995960 val: 0.961818 test: 0.970320
max validation accuracy : 0.970909 max acc epoch : 24 test accuracy : 0.973059
Counter({1: 3852, 0: 3839})

Epoch :  29 loss training:  3.4488512613461353 Time :  1633
accuracy train: 0.995354 val: 0.960000 test: 0.971233
max validation accuracy : 0.970909 max acc epoch : 24 test accuracy : 0.973059
Counter({0: 3858, 1: 3833})

Epoch :  30 loss training:  2.390430021681823 Time :  1660
accuracy train: 0.996162 val: 0.969091 test: 0.971233
max validation accuracy : 0.970909 max acc epoch : 24 test accuracy : 0.973059
Counter({1: 3854, 0: 3837})

Epoch :  31 loss training:  2.9602350182831287 Time :  1693
accuracy train: 0.995758 val: 0.967273 test: 0.969406
max validation accuracy : 0.970909 max acc epoch : 24 test accuracy : 0.973059
Counter({0: 3886, 1: 3805})

Epoch :  32 loss training:  2.704329150961712 Time :  1717
accuracy train: 0.995354 val: 0.961818 test: 0.972603
max validation accuracy : 0.970909 max acc epoch : 24 test accuracy : 0.973059
Counter({1: 3851, 0: 3840})

Epoch :  33 loss training:  2.7102787436160725 Time :  1744
accuracy train: 0.995758 val: 0.963636 test: 0.968950
max validation accuracy : 0.970909 max acc epoch : 24 test accuracy : 0.973059
Counter({1: 3867, 0: 3824})

Epoch :  34 loss training:  2.774536728335079 Time :  1776
accuracy train: 0.995960 val: 0.963636 test: 0.968493
max validation accuracy : 0.970909 max acc epoch : 24 test accuracy : 0.973059
Counter({0: 3868, 1: 3823})

Epoch :  35 loss training:  2.2966891345131444 Time :  1801
accuracy train: 0.996162 val: 0.961818 test: 0.969863
max validation accuracy : 0.970909 max acc epoch : 24 test accuracy : 0.973059
Counter({1: 3874, 0: 3817})

========================================================================================================================================================================================================
best acc epoch :  24
validation accuracy :  0.9709090909090909
test accuracy :  0.9730593607305936
last test_accuracy :  0.9698630136986301
second best val :  0.9690909090909091
second best test :  0.9707762557077626
max gap 10
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=308, tsne=False, weight_decay=1e-07)
device :  cuda:0
Counter({1: 4721, 0: 2970})

Epoch :  1 loss training:  46.40360288321972 Time :  1872
accuracy train: 0.959402 val: 0.940000 test: 0.953881
max validation accuracy : 0.940000 max acc epoch : 1 test accuracy : 0.953881
Counter({1: 4067, 0: 3624})
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  18.16791238076985 Time :  1904
accuracy train: 0.963240 val: 0.943636 test: 0.959817
max validation accuracy : 0.943636 max acc epoch : 2 test accuracy : 0.959817
Counter({1: 4057, 0: 3634})
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  14.123136889189482 Time :  1926
accuracy train: 0.980004 val: 0.961818 test: 0.966210
max validation accuracy : 0.961818 max acc epoch : 3 test accuracy : 0.966210
Counter({0: 3939, 1: 3752})
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  11.402865016367286 Time :  1954
accuracy train: 0.983640 val: 0.965455 test: 0.963014
max validation accuracy : 0.965455 max acc epoch : 4 test accuracy : 0.963014
Counter({0: 3882, 1: 3809})
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  9.129615037934855 Time :  1990
accuracy train: 0.986467 val: 0.958182 test: 0.968950
max validation accuracy : 0.965455 max acc epoch : 4 test accuracy : 0.963014
Counter({0: 3866, 1: 3825})
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  8.826020669424906 Time :  2024
accuracy train: 0.986467 val: 0.958182 test: 0.971689
max validation accuracy : 0.965455 max acc epoch : 4 test accuracy : 0.963014
Counter({0: 3864, 1: 3827})
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  6.983715164009482 Time :  2056
accuracy train: 0.988285 val: 0.958182 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 4 test accuracy : 0.963014
Counter({0: 3868, 1: 3823})
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  6.689863122999668 Time :  2095
accuracy train: 0.989901 val: 0.969091 test: 0.966210
max validation accuracy : 0.969091 max acc epoch : 8 test accuracy : 0.966210
Counter({1: 3859, 0: 3832})
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  7.828326258342713 Time :  2129
accuracy train: 0.990305 val: 0.967273 test: 0.968037
max validation accuracy : 0.969091 max acc epoch : 8 test accuracy : 0.966210
Counter({0: 3865, 1: 3826})
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  6.376843142788857 Time :  2153
accuracy train: 0.992325 val: 0.967273 test: 0.972603
max validation accuracy : 0.969091 max acc epoch : 8 test accuracy : 0.966210
Counter({1: 3858, 0: 3833})

Epoch :  11 loss training:  6.1981089828768745 Time :  2184
accuracy train: 0.992123 val: 0.969091 test: 0.971689
max validation accuracy : 0.969091 max acc epoch : 8 test accuracy : 0.966210
Counter({1: 3851, 0: 3840})

Epoch :  12 loss training:  5.63848006160697 Time :  2216
accuracy train: 0.993335 val: 0.970909 test: 0.970776
max validation accuracy : 0.970909 max acc epoch : 12 test accuracy : 0.970776
Counter({1: 3855, 0: 3836})

Epoch :  13 loss training:  4.956796970334835 Time :  2242
accuracy train: 0.993739 val: 0.969091 test: 0.972146
max validation accuracy : 0.970909 max acc epoch : 12 test accuracy : 0.970776
Counter({1: 3847, 0: 3844})

Epoch :  14 loss training:  5.11015472211875 Time :  2279
accuracy train: 0.994345 val: 0.969091 test: 0.970320
max validation accuracy : 0.970909 max acc epoch : 12 test accuracy : 0.970776
Counter({0: 3848, 1: 3843})

Epoch :  15 loss training:  5.026697688153945 Time :  2313
accuracy train: 0.994749 val: 0.965455 test: 0.968950
max validation accuracy : 0.970909 max acc epoch : 12 test accuracy : 0.970776
Counter({1: 3846, 0: 3845})

Epoch :  16 loss training:  4.863336908747442 Time :  2356
accuracy train: 0.993335 val: 0.967273 test: 0.971233
max validation accuracy : 0.970909 max acc epoch : 12 test accuracy : 0.970776
Counter({1: 3851, 0: 3840})

Epoch :  17 loss training:  4.787968956516124 Time :  2387
accuracy train: 0.995354 val: 0.965455 test: 0.971233
max validation accuracy : 0.970909 max acc epoch : 12 test accuracy : 0.970776
Counter({0: 3858, 1: 3833})

Epoch :  18 loss training:  4.798067631083541 Time :  2428
accuracy train: 0.994749 val: 0.970909 test: 0.970776
max validation accuracy : 0.970909 max acc epoch : 12 test accuracy : 0.970776
Counter({1: 3877, 0: 3814})

Epoch :  19 loss training:  4.352051626541652 Time :  2459
accuracy train: 0.994547 val: 0.967273 test: 0.969863
max validation accuracy : 0.970909 max acc epoch : 12 test accuracy : 0.970776
Counter({0: 3878, 1: 3813})

Epoch :  20 loss training:  4.7976586817530915 Time :  2488
accuracy train: 0.995354 val: 0.969091 test: 0.969863
max validation accuracy : 0.970909 max acc epoch : 12 test accuracy : 0.970776
Counter({1: 3878, 0: 3813})

Epoch :  21 loss training:  4.087146395933814 Time :  2523
accuracy train: 0.994749 val: 0.963636 test: 0.972603
max validation accuracy : 0.970909 max acc epoch : 12 test accuracy : 0.970776
Counter({0: 3878, 1: 3813})

Epoch :  22 loss training:  3.8490163038950413 Time :  2549
accuracy train: 0.995354 val: 0.961818 test: 0.970320
max validation accuracy : 0.970909 max acc epoch : 12 test accuracy : 0.970776
Counter({1: 3880, 0: 3811})

Epoch :  23 loss training:  3.6458142423070967 Time :  2586
accuracy train: 0.995960 val: 0.970909 test: 0.970776
max validation accuracy : 0.970909 max acc epoch : 12 test accuracy : 0.970776
Counter({1: 3890, 0: 3801})

========================================================================================================================================================================================================
best acc epoch :  12
validation accuracy :  0.9709090909090909
test accuracy :  0.9707762557077626
last test_accuracy :  0.9707762557077626
second best val :  0.9690909090909091
second best test :  0.9662100456621004
max gap 4
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=604, tsne=False, weight_decay=1e-07)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  47.17076127976179 Time :  2677
accuracy train: 0.962230 val: 0.952727 test: 0.951142
max validation accuracy : 0.952727 max acc epoch : 1 test accuracy : 0.951142
Counter({0: 4042, 1: 3649})
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  17.757479741238058 Time :  2707
accuracy train: 0.963442 val: 0.958182 test: 0.954795
max validation accuracy : 0.958182 max acc epoch : 2 test accuracy : 0.954795
Counter({1: 4028, 0: 3663})
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  14.770912876352668 Time :  2748
accuracy train: 0.978388 val: 0.967273 test: 0.964384
max validation accuracy : 0.967273 max acc epoch : 3 test accuracy : 0.964384
Counter({0: 3969, 1: 3722})
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  10.561259287875146 Time :  2792
accuracy train: 0.984448 val: 0.969091 test: 0.966667
max validation accuracy : 0.969091 max acc epoch : 4 test accuracy : 0.966667
Counter({1: 3912, 0: 3779})
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  9.985758698545396 Time :  2843
accuracy train: 0.978792 val: 0.958182 test: 0.963470
max validation accuracy : 0.969091 max acc epoch : 4 test accuracy : 0.966667
Counter({0: 3890, 1: 3801})
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  8.971404077950865 Time :  2881
accuracy train: 0.986669 val: 0.969091 test: 0.967580
max validation accuracy : 0.969091 max acc epoch : 4 test accuracy : 0.966667
Counter({1: 3882, 0: 3809})
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  7.388371252920479 Time :  2905
accuracy train: 0.990103 val: 0.969091 test: 0.959817
max validation accuracy : 0.969091 max acc epoch : 4 test accuracy : 0.966667
Counter({0: 3877, 1: 3814})
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  7.092043736251071 Time :  2943
accuracy train: 0.988285 val: 0.967273 test: 0.973516
max validation accuracy : 0.969091 max acc epoch : 4 test accuracy : 0.966667
Counter({1: 3862, 0: 3829})
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  6.776790197240189 Time :  2976
accuracy train: 0.989901 val: 0.969091 test: 0.972146
max validation accuracy : 0.969091 max acc epoch : 4 test accuracy : 0.966667
Counter({0: 3854, 1: 3837})
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  6.251847465639003 Time :  3001
accuracy train: 0.990507 val: 0.967273 test: 0.972603
max validation accuracy : 0.969091 max acc epoch : 4 test accuracy : 0.966667
Counter({1: 3853, 0: 3838})

Epoch :  11 loss training:  5.643887354875915 Time :  3035
accuracy train: 0.991517 val: 0.974545 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 11 test accuracy : 0.967580
Counter({0: 3852, 1: 3839})

Epoch :  12 loss training:  5.693238993175328 Time :  3072
accuracy train: 0.989699 val: 0.967273 test: 0.974886
max validation accuracy : 0.974545 max acc epoch : 11 test accuracy : 0.967580
Counter({0: 3856, 1: 3835})

Epoch :  13 loss training:  5.079896343522705 Time :  3108
accuracy train: 0.991315 val: 0.970909 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 11 test accuracy : 0.967580
Counter({1: 3849, 0: 3842})

Epoch :  14 loss training:  5.1154086568858474 Time :  3145
accuracy train: 0.992527 val: 0.969091 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 11 test accuracy : 0.967580
Counter({0: 3846, 1: 3845})

Epoch :  15 loss training:  4.819714269833639 Time :  3178
accuracy train: 0.991719 val: 0.972727 test: 0.975799
max validation accuracy : 0.974545 max acc epoch : 11 test accuracy : 0.967580
Counter({0: 3855, 1: 3836})

Epoch :  16 loss training:  5.226794544490986 Time :  3210
accuracy train: 0.993941 val: 0.970909 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 11 test accuracy : 0.967580
Counter({0: 3853, 1: 3838})

Epoch :  17 loss training:  4.499991183984093 Time :  3247
accuracy train: 0.992527 val: 0.969091 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 11 test accuracy : 0.967580
Counter({1: 3862, 0: 3829})

Epoch :  18 loss training:  4.7007094654254615 Time :  3279
accuracy train: 0.993941 val: 0.972727 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 11 test accuracy : 0.967580
Counter({0: 3868, 1: 3823})

Epoch :  19 loss training:  4.231104457459878 Time :  3313
accuracy train: 0.994547 val: 0.970909 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 11 test accuracy : 0.967580
Counter({0: 3871, 1: 3820})

Epoch :  20 loss training:  4.3391319526708685 Time :  3351
accuracy train: 0.994547 val: 0.967273 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 11 test accuracy : 0.967580
Counter({0: 3868, 1: 3823})

Epoch :  21 loss training:  3.9167907268274575 Time :  3380
accuracy train: 0.994749 val: 0.974545 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 11 test accuracy : 0.967580
Counter({0: 3869, 1: 3822})

Epoch :  22 loss training:  4.283889175800141 Time :  3420
accuracy train: 0.994547 val: 0.972727 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 11 test accuracy : 0.967580
Counter({0: 3870, 1: 3821})

========================================================================================================================================================================================================
best acc epoch :  11
validation accuracy :  0.9745454545454545
test accuracy :  0.9675799086757991
last test_accuracy :  0.9680365296803652
second best val :  0.9727272727272728
second best test :  0.9675799086757991
max gap 7
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  16 	 val_accuracy : 0.97273 	 test_accuracy : 0.97078 	 last test_accuracy : 0.97123 	 second best val : 0.97091 	 second best test : 0.96849
k :  1 	 best_acc epoch :  24 	 val_accuracy : 0.97091 	 test_accuracy : 0.97306 	 last test_accuracy : 0.96986 	 second best val : 0.96909 	 second best test : 0.97078
k :  2 	 best_acc epoch :  12 	 val_accuracy : 0.97091 	 test_accuracy : 0.97078 	 last test_accuracy : 0.97078 	 second best val : 0.96909 	 second best test : 0.96621
k :  3 	 best_acc epoch :  11 	 val_accuracy : 0.97455 	 test_accuracy : 0.96758 	 last test_accuracy : 0.96804 	 second best val : 0.97273 	 second best test : 0.96758

avg :  	 val_accuracy : 0.97227 	 test_accuracy : 0.97055 	 last_accuracy : 0.96998 	 second best val : 0.97045 	 second best test : 0.96826

std :  	 val_accuracy : 0.00151 	 test_accuracy : 0.00195 	 last_accuracy : 0.00122 	 second best val : 0.00151 	 second best test : 0.00166


date and time :  Mon Jun 14 22:38:22 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=950, tsne=False, weight_decay=1e-07)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  39.886308901011944 Time :  75
accuracy train: 0.954555 val: 0.950909 test: 0.958904
max validation accuracy : 0.950909 max acc epoch : 1 test accuracy : 0.958904
Counter({0: 4122, 1: 3569})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.34341473132372 Time :  105
accuracy train: 0.965058 val: 0.961818 test: 0.959361
max validation accuracy : 0.961818 max acc epoch : 2 test accuracy : 0.959361
Counter({1: 3952, 0: 3739})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.44429009174928 Time :  148
accuracy train: 0.975157 val: 0.954545 test: 0.961187
max validation accuracy : 0.961818 max acc epoch : 2 test accuracy : 0.959361
Counter({1: 3946, 0: 3745})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.786786308977753 Time :  180
accuracy train: 0.984448 val: 0.960000 test: 0.963470
max validation accuracy : 0.961818 max acc epoch : 2 test accuracy : 0.959361
Counter({0: 3920, 1: 3771})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.288238182431087 Time :  214
accuracy train: 0.983438 val: 0.965455 test: 0.971233
max validation accuracy : 0.965455 max acc epoch : 5 test accuracy : 0.971233
Counter({1: 3904, 0: 3787})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  7.935174259357154 Time :  238
accuracy train: 0.988689 val: 0.965455 test: 0.966667
max validation accuracy : 0.965455 max acc epoch : 5 test accuracy : 0.971233
Counter({0: 3898, 1: 3793})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.245361236622557 Time :  269
accuracy train: 0.990709 val: 0.970909 test: 0.969863
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.969863
Counter({1: 3894, 0: 3797})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  7.165843873866834 Time :  296
accuracy train: 0.990507 val: 0.965455 test: 0.971689
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.969863
Counter({0: 3874, 1: 3817})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.700248528082739 Time :  320
accuracy train: 0.991517 val: 0.965455 test: 0.968950
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.969863
Counter({1: 3874, 0: 3817})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.796126605710015 Time :  351
accuracy train: 0.992931 val: 0.961818 test: 0.968037
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.969863
Counter({0: 3856, 1: 3835})

Epoch :  11 loss training:  5.19170241325628 Time :  386
accuracy train: 0.992527 val: 0.967273 test: 0.969863
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.969863
Counter({1: 3848, 0: 3843})

Epoch :  12 loss training:  5.091476238681935 Time :  416
accuracy train: 0.993739 val: 0.963636 test: 0.966667
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.969863
Counter({1: 3850, 0: 3841})

Epoch :  13 loss training:  4.5885746667627245 Time :  446
accuracy train: 0.993133 val: 0.963636 test: 0.970320
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.969863
Counter({1: 3857, 0: 3834})

Epoch :  14 loss training:  4.287585805170238 Time :  476
accuracy train: 0.994749 val: 0.965455 test: 0.963927
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.969863
Counter({1: 3853, 0: 3838})

Epoch :  15 loss training:  3.9549691834836267 Time :  510
accuracy train: 0.993739 val: 0.965455 test: 0.966210
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.969863
Counter({0: 3851, 1: 3840})

Epoch :  16 loss training:  3.7620248569292016 Time :  542
accuracy train: 0.995556 val: 0.965455 test: 0.966667
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.969863
Counter({1: 3849, 0: 3842})

Epoch :  17 loss training:  3.902554465283174 Time :  573
accuracy train: 0.995758 val: 0.960000 test: 0.968037
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.969863
Counter({0: 3851, 1: 3840})

Epoch :  18 loss training:  3.5321683813235722 Time :  603
accuracy train: 0.994749 val: 0.958182 test: 0.971233
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.969863
Counter({0: 3849, 1: 3842})

========================================================================================================================================================================================================
best acc epoch :  7
validation accuracy :  0.9709090909090909
test accuracy :  0.9698630136986301
last test_accuracy :  0.9712328767123287
second best val :  0.9672727272727273
second best test :  0.9698630136986301
max gap 3
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=829, tsne=False, weight_decay=1e-07)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  42.03266217187047 Time :  654
accuracy train: 0.966269 val: 0.969091 test: 0.961187
max validation accuracy : 0.969091 max acc epoch : 1 test accuracy : 0.961187
Counter({0: 4077, 1: 3614})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.686374339275062 Time :  693
accuracy train: 0.966269 val: 0.954545 test: 0.962557
max validation accuracy : 0.969091 max acc epoch : 1 test accuracy : 0.961187
Counter({1: 3988, 0: 3703})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  13.289585794089362 Time :  719
accuracy train: 0.944456 val: 0.903636 test: 0.919635
max validation accuracy : 0.969091 max acc epoch : 1 test accuracy : 0.961187
Counter({1: 3942, 0: 3749})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.356907854322344 Time :  750
accuracy train: 0.983236 val: 0.970909 test: 0.963470
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.963470
Counter({0: 3892, 1: 3799})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.879250084981322 Time :  776
accuracy train: 0.985659 val: 0.974545 test: 0.963470
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.963470
Counter({1: 3883, 0: 3808})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.424074659589678 Time :  813
accuracy train: 0.985054 val: 0.972727 test: 0.966210
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.963470
Counter({0: 3864, 1: 3827})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.560488598421216 Time :  839
accuracy train: 0.991113 val: 0.970909 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.963470
Counter({0: 3879, 1: 3812})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.94352834043093 Time :  862
accuracy train: 0.988083 val: 0.970909 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.963470
Counter({0: 3860, 1: 3831})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.4730752487666905 Time :  893
accuracy train: 0.989699 val: 0.972727 test: 0.963927
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.963470
Counter({1: 3861, 0: 3830})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.454352176573593 Time :  920
accuracy train: 0.992123 val: 0.972727 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.963470
Counter({0: 3867, 1: 3824})

Epoch :  11 loss training:  5.107762532541528 Time :  944
accuracy train: 0.991921 val: 0.976364 test: 0.967123
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.967123
Counter({1: 3868, 0: 3823})

Epoch :  12 loss training:  4.966829100565519 Time :  977
accuracy train: 0.992729 val: 0.972727 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.967123
Counter({1: 3860, 0: 3831})

Epoch :  13 loss training:  5.099242454394698 Time :  1005
accuracy train: 0.994143 val: 0.976364 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 11 test accuracy : 0.967123
Counter({0: 3848, 1: 3843})

Epoch :  14 loss training:  4.784828601288609 Time :  1034
accuracy train: 0.993739 val: 0.978182 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.970776
Counter({1: 3850, 0: 3841})

Epoch :  15 loss training:  4.1086111959884875 Time :  1059
accuracy train: 0.995556 val: 0.974545 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.970776
Counter({1: 3848, 0: 3843})

Epoch :  16 loss training:  4.266694725913112 Time :  1092
accuracy train: 0.995758 val: 0.974545 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.970776
Counter({0: 3847, 1: 3844})

Epoch :  17 loss training:  3.7197283533168957 Time :  1126
accuracy train: 0.995758 val: 0.974545 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.970776
Counter({1: 3852, 0: 3839})

Epoch :  18 loss training:  3.0685873538604937 Time :  1153
accuracy train: 0.995556 val: 0.974545 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.970776
Counter({0: 3860, 1: 3831})

Epoch :  19 loss training:  3.3043136319029145 Time :  1188
accuracy train: 0.995556 val: 0.974545 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.970776
Counter({0: 3859, 1: 3832})

Epoch :  20 loss training:  3.2539892112254165 Time :  1216
accuracy train: 0.995556 val: 0.976364 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.970776
Counter({0: 3867, 1: 3824})

Epoch :  21 loss training:  3.0120229568274226 Time :  1245
accuracy train: 0.995152 val: 0.974545 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.970776
Counter({1: 3878, 0: 3813})

Epoch :  22 loss training:  2.941756935499143 Time :  1270
accuracy train: 0.994143 val: 0.978182 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.970776
Counter({1: 3885, 0: 3806})

Epoch :  23 loss training:  2.7642505654657725 Time :  1300
accuracy train: 0.995960 val: 0.970909 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.970776
Counter({1: 3883, 0: 3808})

Epoch :  24 loss training:  2.571145558351418 Time :  1334
accuracy train: 0.995758 val: 0.976364 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.970776
Counter({0: 3879, 1: 3812})

Epoch :  25 loss training:  2.369790555909276 Time :  1360
accuracy train: 0.995960 val: 0.970909 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 14 test accuracy : 0.970776
Counter({1: 3893, 0: 3798})

========================================================================================================================================================================================================
best acc epoch :  14
validation accuracy :  0.9781818181818182
test accuracy :  0.9707762557077626
last test_accuracy :  0.9703196347031964
second best val :  0.9763636363636363
second best test :  0.9671232876712329
max gap 6
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=740, tsne=False, weight_decay=1e-07)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  38.39227340184152 Time :  1396
accuracy train: 0.964250 val: 0.952727 test: 0.958447
max validation accuracy : 0.952727 max acc epoch : 1 test accuracy : 0.958447
Counter({1: 4187, 0: 3504})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.63722780160606 Time :  1420
accuracy train: 0.969703 val: 0.956364 test: 0.962557
max validation accuracy : 0.956364 max acc epoch : 2 test accuracy : 0.962557
Counter({0: 4016, 1: 3675})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.325363179203123 Time :  1447
accuracy train: 0.970713 val: 0.949091 test: 0.967123
max validation accuracy : 0.956364 max acc epoch : 2 test accuracy : 0.962557
Counter({1: 3960, 0: 3731})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.054367440985516 Time :  1481
accuracy train: 0.980408 val: 0.967273 test: 0.972603
max validation accuracy : 0.967273 max acc epoch : 4 test accuracy : 0.972603
Counter({1: 3922, 0: 3769})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.118132497183979 Time :  1508
accuracy train: 0.983842 val: 0.969091 test: 0.970320
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.970320
Counter({1: 3927, 0: 3764})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  10.337618132587522 Time :  1535
accuracy train: 0.985861 val: 0.969091 test: 0.966667
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3933, 1: 3758})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.779754141578451 Time :  1559
accuracy train: 0.985457 val: 0.969091 test: 0.974429
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.970320
Counter({1: 3937, 0: 3754})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.954187208553776 Time :  1593
accuracy train: 0.990507 val: 0.967273 test: 0.969406
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3916, 1: 3775})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.444600178976543 Time :  1619
accuracy train: 0.991921 val: 0.969091 test: 0.965753
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3914, 1: 3777})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.715849861968309 Time :  1647
accuracy train: 0.992527 val: 0.967273 test: 0.970776
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.970320
Counter({1: 3902, 0: 3789})

Epoch :  11 loss training:  6.0940172544214875 Time :  1672
accuracy train: 0.992729 val: 0.967273 test: 0.967123
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3903, 1: 3788})

Epoch :  12 loss training:  5.11832058019354 Time :  1700
accuracy train: 0.993739 val: 0.969091 test: 0.971233
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.970320
Counter({1: 3897, 0: 3794})

Epoch :  13 loss training:  4.3059459188370965 Time :  1731
accuracy train: 0.993335 val: 0.969091 test: 0.968037
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.970320
Counter({1: 3897, 0: 3794})

Epoch :  14 loss training:  4.245514949085191 Time :  1755
accuracy train: 0.994345 val: 0.967273 test: 0.965753
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3886, 1: 3805})

Epoch :  15 loss training:  4.649106309807394 Time :  1778
accuracy train: 0.994547 val: 0.969091 test: 0.973516
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.970320
Counter({1: 3880, 0: 3811})

Epoch :  16 loss training:  4.555995645350777 Time :  1801
accuracy train: 0.994749 val: 0.970909 test: 0.963470
max validation accuracy : 0.970909 max acc epoch : 16 test accuracy : 0.963470
Counter({0: 3868, 1: 3823})

Epoch :  17 loss training:  3.8272271046298556 Time :  1829
accuracy train: 0.994749 val: 0.972727 test: 0.970320
max validation accuracy : 0.972727 max acc epoch : 17 test accuracy : 0.970320
Counter({0: 3863, 1: 3828})

Epoch :  18 loss training:  3.5676375654002186 Time :  1862
accuracy train: 0.995556 val: 0.970909 test: 0.969406
max validation accuracy : 0.972727 max acc epoch : 17 test accuracy : 0.970320
Counter({1: 3861, 0: 3830})

Epoch :  19 loss training:  3.2949147898470983 Time :  1889
accuracy train: 0.995556 val: 0.974545 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 19 test accuracy : 0.969863
Counter({0: 3861, 1: 3830})

Epoch :  20 loss training:  2.997155162564013 Time :  1914
accuracy train: 0.996162 val: 0.970909 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 19 test accuracy : 0.969863
Counter({0: 3855, 1: 3836})

Epoch :  21 loss training:  3.07935229112627 Time :  1941
accuracy train: 0.995960 val: 0.969091 test: 0.967123
max validation accuracy : 0.974545 max acc epoch : 19 test accuracy : 0.969863
Counter({1: 3853, 0: 3838})

Epoch :  22 loss training:  3.222439879726153 Time :  1974
accuracy train: 0.995960 val: 0.972727 test: 0.967123
max validation accuracy : 0.974545 max acc epoch : 19 test accuracy : 0.969863
Counter({0: 3852, 1: 3839})

Epoch :  23 loss training:  2.813325283699669 Time :  2003
accuracy train: 0.995758 val: 0.972727 test: 0.966210
max validation accuracy : 0.974545 max acc epoch : 19 test accuracy : 0.969863
Counter({0: 3847, 1: 3844})

Epoch :  24 loss training:  2.5238291952118743 Time :  2031
accuracy train: 0.996162 val: 0.967273 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 19 test accuracy : 0.969863
Counter({0: 3846, 1: 3845})

Epoch :  25 loss training:  2.692019306385191 Time :  2057
accuracy train: 0.995960 val: 0.967273 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 19 test accuracy : 0.969863
Counter({1: 3853, 0: 3838})

Epoch :  26 loss training:  2.4364666273759212 Time :  2085
accuracy train: 0.995960 val: 0.970909 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 19 test accuracy : 0.969863
Counter({0: 3859, 1: 3832})

Epoch :  27 loss training:  2.389274073182605 Time :  2115
accuracy train: 0.996566 val: 0.972727 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 19 test accuracy : 0.969863
Counter({1: 3862, 0: 3829})

Epoch :  28 loss training:  2.3357384584960528 Time :  2141
accuracy train: 0.997172 val: 0.972727 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 19 test accuracy : 0.969863
Counter({1: 3861, 0: 3830})

Epoch :  29 loss training:  1.750023607906769 Time :  2168
accuracy train: 0.996566 val: 0.972727 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 19 test accuracy : 0.969863
Counter({0: 3862, 1: 3829})

Epoch :  30 loss training:  1.965158155246172 Time :  2196
accuracy train: 0.996768 val: 0.972727 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 19 test accuracy : 0.969863
Counter({0: 3864, 1: 3827})

========================================================================================================================================================================================================
best acc epoch :  19
validation accuracy :  0.9745454545454545
test accuracy :  0.9698630136986301
last test_accuracy :  0.9698630136986301
second best val :  0.9727272727272728
second best test :  0.9703196347031964
max gap 11
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=710, tsne=False, weight_decay=1e-07)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  38.98349179700017 Time :  2240
accuracy train: 0.925268 val: 0.894545 test: 0.943379
max validation accuracy : 0.894545 max acc epoch : 1 test accuracy : 0.943379
Counter({0: 4050, 1: 3641})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.81230364460498 Time :  2270
accuracy train: 0.973743 val: 0.969091 test: 0.960274
max validation accuracy : 0.969091 max acc epoch : 2 test accuracy : 0.960274
Counter({1: 3956, 0: 3735})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.040300422348082 Time :  2297
accuracy train: 0.973541 val: 0.947273 test: 0.959361
max validation accuracy : 0.969091 max acc epoch : 2 test accuracy : 0.960274
Counter({0: 3849, 1: 3842})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.920493681915104 Time :  2320
accuracy train: 0.984044 val: 0.967273 test: 0.967123
max validation accuracy : 0.969091 max acc epoch : 2 test accuracy : 0.960274
Counter({1: 3877, 0: 3814})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.552107546944171 Time :  2349
accuracy train: 0.987275 val: 0.972727 test: 0.968037
max validation accuracy : 0.972727 max acc epoch : 5 test accuracy : 0.968037
Counter({1: 3852, 0: 3839})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.397351688239723 Time :  2383
accuracy train: 0.983842 val: 0.965455 test: 0.967123
max validation accuracy : 0.972727 max acc epoch : 5 test accuracy : 0.968037
Counter({1: 3856, 0: 3835})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.1935666189529 Time :  2414
accuracy train: 0.988689 val: 0.974545 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3871, 0: 3820})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.806853807065636 Time :  2444
accuracy train: 0.988891 val: 0.967273 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.971689
Counter({0: 3858, 1: 3833})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.635933611774817 Time :  2470
accuracy train: 0.991517 val: 0.980000 test: 0.968950
max validation accuracy : 0.980000 max acc epoch : 9 test accuracy : 0.968950
Counter({0: 3889, 1: 3802})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.676668217871338 Time :  2496
accuracy train: 0.991719 val: 0.972727 test: 0.964840
max validation accuracy : 0.980000 max acc epoch : 9 test accuracy : 0.968950
Counter({0: 3880, 1: 3811})

Epoch :  11 loss training:  5.479864124754386 Time :  2531
accuracy train: 0.992325 val: 0.980000 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 9 test accuracy : 0.968950
Counter({0: 3880, 1: 3811})

Epoch :  12 loss training:  5.211202158534434 Time :  2560
accuracy train: 0.992325 val: 0.972727 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 9 test accuracy : 0.968950
Counter({1: 3865, 0: 3826})

Epoch :  13 loss training:  5.005155562656 Time :  2586
accuracy train: 0.993941 val: 0.978182 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 9 test accuracy : 0.968950
Counter({0: 3881, 1: 3810})

Epoch :  14 loss training:  4.522863959544338 Time :  2612
accuracy train: 0.992729 val: 0.976364 test: 0.970320
max validation accuracy : 0.980000 max acc epoch : 9 test accuracy : 0.968950
Counter({1: 3890, 0: 3801})

Epoch :  15 loss training:  4.3473692335537635 Time :  2643
accuracy train: 0.994143 val: 0.976364 test: 0.967580
max validation accuracy : 0.980000 max acc epoch : 9 test accuracy : 0.968950
Counter({1: 3894, 0: 3797})

Epoch :  16 loss training:  3.807649537571706 Time :  2669
accuracy train: 0.994547 val: 0.978182 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 9 test accuracy : 0.968950
Counter({0: 3897, 1: 3794})

Epoch :  17 loss training:  3.373257868399378 Time :  2691
accuracy train: 0.994345 val: 0.976364 test: 0.970320
max validation accuracy : 0.980000 max acc epoch : 9 test accuracy : 0.968950
Counter({1: 3913, 0: 3778})

Epoch :  18 loss training:  3.804833946051076 Time :  2713
accuracy train: 0.994951 val: 0.978182 test: 0.968950
max validation accuracy : 0.980000 max acc epoch : 9 test accuracy : 0.968950
Counter({1: 3915, 0: 3776})

Epoch :  19 loss training:  3.2788593295263126 Time :  2736
accuracy train: 0.995152 val: 0.981818 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 19 test accuracy : 0.971689
Counter({0: 3916, 1: 3775})

Epoch :  20 loss training:  3.1401875532465056 Time :  2765
accuracy train: 0.994547 val: 0.974545 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 19 test accuracy : 0.971689
Counter({1: 3918, 0: 3773})

Epoch :  21 loss training:  3.3001393668237142 Time :  2790
accuracy train: 0.994749 val: 0.972727 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 19 test accuracy : 0.971689
Counter({0: 3913, 1: 3778})

Epoch :  22 loss training:  2.8461596148554236 Time :  2818
accuracy train: 0.995354 val: 0.970909 test: 0.964840
max validation accuracy : 0.981818 max acc epoch : 19 test accuracy : 0.971689
Counter({1: 3916, 0: 3775})

Epoch :  23 loss training:  2.6980314846150577 Time :  2846
accuracy train: 0.995960 val: 0.969091 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 19 test accuracy : 0.971689
Counter({0: 3916, 1: 3775})

Epoch :  24 loss training:  2.6821290829393547 Time :  2880
accuracy train: 0.995758 val: 0.974545 test: 0.971233
max validation accuracy : 0.981818 max acc epoch : 19 test accuracy : 0.971689
Counter({1: 3912, 0: 3779})

Epoch :  25 loss training:  2.699699937191326 Time :  2908
accuracy train: 0.995960 val: 0.980000 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 19 test accuracy : 0.971689
Counter({0: 3920, 1: 3771})

Epoch :  26 loss training:  2.3106753787142225 Time :  2943
accuracy train: 0.996162 val: 0.972727 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 19 test accuracy : 0.971689
Counter({1: 3920, 0: 3771})

Epoch :  27 loss training:  2.256850381643744 Time :  2970
accuracy train: 0.996162 val: 0.976364 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 19 test accuracy : 0.971689
Counter({0: 3924, 1: 3767})

Epoch :  28 loss training:  2.1205962217063643 Time :  2996
accuracy train: 0.996364 val: 0.972727 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 19 test accuracy : 0.971689
Counter({1: 3923, 0: 3768})

Epoch :  29 loss training:  1.9890035849821288 Time :  3025
accuracy train: 0.996566 val: 0.972727 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 19 test accuracy : 0.971689
Counter({0: 3923, 1: 3768})

Epoch :  30 loss training:  2.00084185556625 Time :  3060
accuracy train: 0.996768 val: 0.976364 test: 0.967580
max validation accuracy : 0.981818 max acc epoch : 19 test accuracy : 0.971689
Counter({1: 3927, 0: 3764})

========================================================================================================================================================================================================
best acc epoch :  19
validation accuracy :  0.9818181818181818
test accuracy :  0.971689497716895
last test_accuracy :  0.9675799086757991
second best val :  0.98
second best test :  0.9689497716894977
max gap 10
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  7 	 val_accuracy : 0.97091 	 test_accuracy : 0.96986 	 last test_accuracy : 0.97123 	 second best val : 0.96727 	 second best test : 0.96986
k :  1 	 best_acc epoch :  14 	 val_accuracy : 0.97818 	 test_accuracy : 0.97078 	 last test_accuracy : 0.97032 	 second best val : 0.97636 	 second best test : 0.96712
k :  2 	 best_acc epoch :  19 	 val_accuracy : 0.97455 	 test_accuracy : 0.96986 	 last test_accuracy : 0.96986 	 second best val : 0.97273 	 second best test : 0.97032
k :  3 	 best_acc epoch :  19 	 val_accuracy : 0.98182 	 test_accuracy : 0.97169 	 last test_accuracy : 0.96758 	 second best val : 0.98000 	 second best test : 0.96895

avg :  	 val_accuracy : 0.97636 	 test_accuracy : 0.97055 	 last_accuracy : 0.96975 	 second best val : 0.97409 	 second best test : 0.96906

std :  	 val_accuracy : 0.00407 	 test_accuracy : 0.00076 	 last_accuracy : 0.00135 	 second best val : 0.00470 	 second best test : 0.00122


date and time :  Mon Jun 14 23:29:43 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.005, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=93, tsne=False, weight_decay=1e-07)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  61.04878734052181 Time :  34
accuracy train: 0.859018 val: 0.850909 test: 0.889954
max validation accuracy : 0.850909 max acc epoch : 1 test accuracy : 0.889954
Counter({1: 4253, 0: 3438})
Epoch-1 lr: 0.005

Epoch :  2 loss training:  39.12490064650774 Time :  60
accuracy train: 0.910523 val: 0.907273 test: 0.906393
max validation accuracy : 0.907273 max acc epoch : 2 test accuracy : 0.906393
Counter({0: 4042, 1: 3649})
Epoch-2 lr: 0.005

Epoch :  3 loss training:  37.237072171643376 Time :  91
accuracy train: 0.925268 val: 0.901818 test: 0.926484
max validation accuracy : 0.907273 max acc epoch : 2 test accuracy : 0.906393
Counter({0: 4119, 1: 3572})
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  20.85837207082659 Time :  125
accuracy train: 0.953141 val: 0.950909 test: 0.941096
max validation accuracy : 0.950909 max acc epoch : 4 test accuracy : 0.941096
Counter({1: 3999, 0: 3692})
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  18.006335759535432 Time :  153
accuracy train: 0.964452 val: 0.947273 test: 0.950685
max validation accuracy : 0.950909 max acc epoch : 4 test accuracy : 0.941096
Counter({0: 3989, 1: 3702})
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  16.614341120584868 Time :  177
accuracy train: 0.966269 val: 0.932727 test: 0.958904
max validation accuracy : 0.950909 max acc epoch : 4 test accuracy : 0.941096
Counter({1: 4042, 0: 3649})
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  13.381991698821366 Time :  215
accuracy train: 0.974147 val: 0.952727 test: 0.962100
max validation accuracy : 0.952727 max acc epoch : 7 test accuracy : 0.962100
Counter({1: 4056, 0: 3635})
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  11.596800931496546 Time :  246
accuracy train: 0.971521 val: 0.943636 test: 0.963927
max validation accuracy : 0.952727 max acc epoch : 7 test accuracy : 0.962100
Counter({0: 4047, 1: 3644})
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  10.450713560916483 Time :  272
accuracy train: 0.974349 val: 0.956364 test: 0.955708
max validation accuracy : 0.956364 max acc epoch : 9 test accuracy : 0.955708
Counter({1: 4027, 0: 3664})
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  10.16142802266404 Time :  297
accuracy train: 0.979600 val: 0.958182 test: 0.963470
max validation accuracy : 0.958182 max acc epoch : 10 test accuracy : 0.963470
Counter({0: 4055, 1: 3636})

Epoch :  11 loss training:  9.318748816964217 Time :  330
accuracy train: 0.982428 val: 0.954545 test: 0.966667
max validation accuracy : 0.958182 max acc epoch : 10 test accuracy : 0.963470
Counter({1: 4062, 0: 3629})

Epoch :  12 loss training:  8.08574381400831 Time :  359
accuracy train: 0.984650 val: 0.963636 test: 0.959361
max validation accuracy : 0.963636 max acc epoch : 12 test accuracy : 0.959361
Counter({0: 4079, 1: 3612})

Epoch :  13 loss training:  6.839082972146571 Time :  388
accuracy train: 0.989093 val: 0.963636 test: 0.960731
max validation accuracy : 0.963636 max acc epoch : 12 test accuracy : 0.959361
Counter({1: 4039, 0: 3652})

Epoch :  14 loss training:  6.084088128758594 Time :  418
accuracy train: 0.986669 val: 0.961818 test: 0.956164
max validation accuracy : 0.963636 max acc epoch : 12 test accuracy : 0.959361
Counter({1: 4033, 0: 3658})

Epoch :  15 loss training:  5.374862572469283 Time :  465
accuracy train: 0.991113 val: 0.960000 test: 0.958904
max validation accuracy : 0.963636 max acc epoch : 12 test accuracy : 0.959361
Counter({1: 4082, 0: 3609})

Epoch :  16 loss training:  4.97061872004997 Time :  499
accuracy train: 0.993537 val: 0.956364 test: 0.962100
max validation accuracy : 0.963636 max acc epoch : 12 test accuracy : 0.959361
Counter({1: 4035, 0: 3656})

Epoch :  17 loss training:  4.042378876358271 Time :  528
accuracy train: 0.993537 val: 0.960000 test: 0.961187
max validation accuracy : 0.963636 max acc epoch : 12 test accuracy : 0.959361
Counter({1: 4001, 0: 3690})

Epoch :  18 loss training:  3.916786446439801 Time :  553
accuracy train: 0.995354 val: 0.963636 test: 0.963014
max validation accuracy : 0.963636 max acc epoch : 12 test accuracy : 0.959361
Counter({0: 4005, 1: 3686})

Epoch :  19 loss training:  3.4794415103679057 Time :  584
accuracy train: 0.994749 val: 0.963636 test: 0.962100
max validation accuracy : 0.963636 max acc epoch : 12 test accuracy : 0.959361
Counter({1: 3983, 0: 3708})

Epoch :  20 loss training:  2.799721231596777 Time :  622
accuracy train: 0.995758 val: 0.963636 test: 0.959361
max validation accuracy : 0.963636 max acc epoch : 12 test accuracy : 0.959361
Counter({1: 3973, 0: 3718})

Epoch :  21 loss training:  2.5042847162112594 Time :  659
accuracy train: 0.995960 val: 0.963636 test: 0.959817
max validation accuracy : 0.963636 max acc epoch : 12 test accuracy : 0.959361
Counter({0: 3959, 1: 3732})

Epoch :  22 loss training:  2.3809979138241033 Time :  705
accuracy train: 0.995960 val: 0.961818 test: 0.961187
max validation accuracy : 0.963636 max acc epoch : 12 test accuracy : 0.959361
Counter({1: 3976, 0: 3715})

Epoch :  23 loss training:  2.4067649026110303 Time :  732
accuracy train: 0.996162 val: 0.965455 test: 0.960731
max validation accuracy : 0.965455 max acc epoch : 23 test accuracy : 0.960731
Counter({0: 3957, 1: 3734})

Epoch :  24 loss training:  2.280580887570977 Time :  762
accuracy train: 0.996162 val: 0.965455 test: 0.961644
max validation accuracy : 0.965455 max acc epoch : 23 test accuracy : 0.960731
Counter({0: 3956, 1: 3735})

Epoch :  25 loss training:  2.043747577627073 Time :  791
accuracy train: 0.995758 val: 0.958182 test: 0.954338
max validation accuracy : 0.965455 max acc epoch : 23 test accuracy : 0.960731
Counter({0: 3949, 1: 3742})

Epoch :  26 loss training:  1.945253354482702 Time :  829
accuracy train: 0.996364 val: 0.961818 test: 0.961187
max validation accuracy : 0.965455 max acc epoch : 23 test accuracy : 0.960731
Counter({1: 3937, 0: 3754})

Epoch :  27 loss training:  2.0248253065510653 Time :  867
accuracy train: 0.996566 val: 0.961818 test: 0.961644
max validation accuracy : 0.965455 max acc epoch : 23 test accuracy : 0.960731
Counter({0: 3927, 1: 3764})

Epoch :  28 loss training:  2.136045223032852 Time :  893
accuracy train: 0.996566 val: 0.960000 test: 0.958904
max validation accuracy : 0.965455 max acc epoch : 23 test accuracy : 0.960731
Counter({1: 3909, 0: 3782})

Epoch :  29 loss training:  1.9412561929493677 Time :  924
accuracy train: 0.996364 val: 0.967273 test: 0.961644
max validation accuracy : 0.967273 max acc epoch : 29 test accuracy : 0.961644
Counter({0: 3913, 1: 3778})

Epoch :  30 loss training:  1.6634491125296336 Time :  953
accuracy train: 0.996364 val: 0.963636 test: 0.960274
max validation accuracy : 0.967273 max acc epoch : 29 test accuracy : 0.961644
Counter({1: 3915, 0: 3776})

Epoch :  31 loss training:  1.8000268959149253 Time :  985
accuracy train: 0.996566 val: 0.960000 test: 0.959361
max validation accuracy : 0.967273 max acc epoch : 29 test accuracy : 0.961644
Counter({0: 3922, 1: 3769})

Epoch :  32 loss training:  1.8746225366849103 Time :  1013
accuracy train: 0.996364 val: 0.958182 test: 0.958447
max validation accuracy : 0.967273 max acc epoch : 29 test accuracy : 0.961644
Counter({1: 3900, 0: 3791})

Epoch :  33 loss training:  1.9722598110379295 Time :  1047
accuracy train: 0.996970 val: 0.963636 test: 0.957991
max validation accuracy : 0.967273 max acc epoch : 29 test accuracy : 0.961644
Counter({0: 3927, 1: 3764})

Epoch :  34 loss training:  1.5569450933307962 Time :  1092
accuracy train: 0.996566 val: 0.963636 test: 0.958447
max validation accuracy : 0.967273 max acc epoch : 29 test accuracy : 0.961644
Counter({0: 3910, 1: 3781})

Epoch :  35 loss training:  1.6273954409407452 Time :  1116
accuracy train: 0.996970 val: 0.958182 test: 0.956621
max validation accuracy : 0.967273 max acc epoch : 29 test accuracy : 0.961644
Counter({0: 3918, 1: 3773})

Epoch :  36 loss training:  1.6419658738159342 Time :  1141
accuracy train: 0.996768 val: 0.965455 test: 0.957991
max validation accuracy : 0.967273 max acc epoch : 29 test accuracy : 0.961644
Counter({1: 3895, 0: 3796})

Epoch :  37 loss training:  1.5392156038433313 Time :  1165
accuracy train: 0.994547 val: 0.958182 test: 0.956621
max validation accuracy : 0.967273 max acc epoch : 29 test accuracy : 0.961644
Counter({0: 3897, 1: 3794})

Epoch :  38 loss training:  1.540196526737418 Time :  1193
accuracy train: 0.996566 val: 0.969091 test: 0.954795
max validation accuracy : 0.969091 max acc epoch : 38 test accuracy : 0.954795
Counter({0: 3917, 1: 3774})

Epoch :  39 loss training:  1.622799517805106 Time :  1223
accuracy train: 0.996970 val: 0.963636 test: 0.954795
max validation accuracy : 0.969091 max acc epoch : 38 test accuracy : 0.954795
Counter({0: 3894, 1: 3797})

Epoch :  40 loss training:  1.8015369863642263 Time :  1249
accuracy train: 0.996768 val: 0.963636 test: 0.956621
max validation accuracy : 0.969091 max acc epoch : 38 test accuracy : 0.954795
Counter({1: 3903, 0: 3788})

Epoch :  41 loss training:  1.4512345720468147 Time :  1274
accuracy train: 0.996566 val: 0.954545 test: 0.957078
max validation accuracy : 0.969091 max acc epoch : 38 test accuracy : 0.954795
Counter({0: 3887, 1: 3804})

Epoch :  42 loss training:  1.6472119163008756 Time :  1297
accuracy train: 0.996970 val: 0.961818 test: 0.956164
max validation accuracy : 0.969091 max acc epoch : 38 test accuracy : 0.954795
Counter({1: 3888, 0: 3803})

Epoch :  43 loss training:  1.4310327155762934 Time :  1321
accuracy train: 0.996566 val: 0.960000 test: 0.957078
max validation accuracy : 0.969091 max acc epoch : 38 test accuracy : 0.954795
Counter({1: 3906, 0: 3785})

Epoch :  44 loss training:  1.3407406533297035 Time :  1352
accuracy train: 0.996768 val: 0.967273 test: 0.954338
max validation accuracy : 0.969091 max acc epoch : 38 test accuracy : 0.954795
Counter({0: 3910, 1: 3781})

Epoch :  45 loss training:  1.394531555226422 Time :  1376
accuracy train: 0.997172 val: 0.965455 test: 0.958904
max validation accuracy : 0.969091 max acc epoch : 38 test accuracy : 0.954795
Counter({1: 3901, 0: 3790})

Epoch :  46 loss training:  1.6095682288432727 Time :  1401
accuracy train: 0.996970 val: 0.961818 test: 0.956621
max validation accuracy : 0.969091 max acc epoch : 38 test accuracy : 0.954795
Counter({0: 3905, 1: 3786})

Epoch :  47 loss training:  1.7798892776845605 Time :  1435
accuracy train: 0.996768 val: 0.958182 test: 0.956621
max validation accuracy : 0.969091 max acc epoch : 38 test accuracy : 0.954795
Counter({1: 3903, 0: 3788})

Epoch :  48 loss training:  1.9239890369790373 Time :  1462
accuracy train: 0.996970 val: 0.958182 test: 0.954338
max validation accuracy : 0.969091 max acc epoch : 38 test accuracy : 0.954795
Counter({1: 3867, 0: 3824})

Epoch :  49 loss training:  1.5001794229065126 Time :  1513
accuracy train: 0.997374 val: 0.960000 test: 0.954338
max validation accuracy : 0.969091 max acc epoch : 38 test accuracy : 0.954795
Counter({0: 3866, 1: 3825})

========================================================================================================================================================================================================
best acc epoch :  38
validation accuracy :  0.9690909090909091
test accuracy :  0.9547945205479452
last test_accuracy :  0.954337899543379
second best val :  0.9672727272727273
second best test :  0.9616438356164384
max gap 11
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.005, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=621, tsne=False, weight_decay=1e-07)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  59.91340481489897 Time :  1551
accuracy train: 0.890325 val: 0.880000 test: 0.898630
max validation accuracy : 0.880000 max acc epoch : 1 test accuracy : 0.898630
Counter({1: 4074, 0: 3617})
Epoch-1 lr: 0.005

Epoch :  2 loss training:  37.18775245710276 Time :  1584
accuracy train: 0.949101 val: 0.934545 test: 0.958447
max validation accuracy : 0.934545 max acc epoch : 2 test accuracy : 0.958447
Counter({1: 4238, 0: 3453})
Epoch-2 lr: 0.005

Epoch :  3 loss training:  23.909916987642646 Time :  1618
accuracy train: 0.953343 val: 0.934545 test: 0.931963
max validation accuracy : 0.934545 max acc epoch : 2 test accuracy : 0.958447
Counter({1: 4118, 0: 3573})
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  15.554435011930764 Time :  1643
accuracy train: 0.974147 val: 0.956364 test: 0.962557
max validation accuracy : 0.956364 max acc epoch : 4 test accuracy : 0.962557
Counter({0: 4249, 1: 3442})
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  13.196384239941835 Time :  1678
accuracy train: 0.973743 val: 0.949091 test: 0.964384
max validation accuracy : 0.956364 max acc epoch : 4 test accuracy : 0.962557
Counter({1: 4220, 0: 3471})
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  11.60874254629016 Time :  1715
accuracy train: 0.976570 val: 0.952727 test: 0.959361
max validation accuracy : 0.956364 max acc epoch : 4 test accuracy : 0.962557
Counter({0: 4183, 1: 3508})
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  9.457388511742465 Time :  1740
accuracy train: 0.980610 val: 0.945455 test: 0.958447
max validation accuracy : 0.956364 max acc epoch : 4 test accuracy : 0.962557
Counter({1: 4215, 0: 3476})
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  8.66686645313166 Time :  1773
accuracy train: 0.980610 val: 0.956364 test: 0.962100
max validation accuracy : 0.956364 max acc epoch : 4 test accuracy : 0.962557
Counter({0: 4181, 1: 3510})
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  8.607189879287034 Time :  1805
accuracy train: 0.984448 val: 0.954545 test: 0.958447
max validation accuracy : 0.956364 max acc epoch : 4 test accuracy : 0.962557
Counter({0: 4163, 1: 3528})
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  7.460012667812407 Time :  1829
accuracy train: 0.980610 val: 0.958182 test: 0.957991
max validation accuracy : 0.958182 max acc epoch : 10 test accuracy : 0.957991
Counter({0: 4152, 1: 3539})

Epoch :  11 loss training:  6.888274020049721 Time :  1856
accuracy train: 0.985659 val: 0.958182 test: 0.956621
max validation accuracy : 0.958182 max acc epoch : 10 test accuracy : 0.957991
Counter({0: 4144, 1: 3547})

Epoch :  12 loss training:  7.9426477095112205 Time :  1884
accuracy train: 0.989295 val: 0.960000 test: 0.960274
max validation accuracy : 0.960000 max acc epoch : 12 test accuracy : 0.960274
Counter({1: 4145, 0: 3546})

Epoch :  13 loss training:  5.5216450582956895 Time :  1917
accuracy train: 0.991315 val: 0.961818 test: 0.963470
max validation accuracy : 0.961818 max acc epoch : 13 test accuracy : 0.963470
Counter({1: 4124, 0: 3567})

Epoch :  14 loss training:  4.866966267582029 Time :  1961
accuracy train: 0.992931 val: 0.963636 test: 0.963470
max validation accuracy : 0.963636 max acc epoch : 14 test accuracy : 0.963470
Counter({0: 4131, 1: 3560})

Epoch :  15 loss training:  4.234325972371153 Time :  2000
accuracy train: 0.994547 val: 0.960000 test: 0.962100
max validation accuracy : 0.963636 max acc epoch : 14 test accuracy : 0.963470
Counter({1: 4118, 0: 3573})

Epoch :  16 loss training:  4.058273396920413 Time :  2036
accuracy train: 0.994143 val: 0.961818 test: 0.963470
max validation accuracy : 0.963636 max acc epoch : 14 test accuracy : 0.963470
Counter({0: 4096, 1: 3595})

Epoch :  17 loss training:  3.6178391307475977 Time :  2061
accuracy train: 0.995152 val: 0.956364 test: 0.960274
max validation accuracy : 0.963636 max acc epoch : 14 test accuracy : 0.963470
Counter({1: 4113, 0: 3578})

Epoch :  18 loss training:  2.9580195344169624 Time :  2086
accuracy train: 0.993739 val: 0.960000 test: 0.962100
max validation accuracy : 0.963636 max acc epoch : 14 test accuracy : 0.963470
Counter({1: 4083, 0: 3608})

Epoch :  19 loss training:  3.0591839695116505 Time :  2113
accuracy train: 0.995354 val: 0.967273 test: 0.962100
max validation accuracy : 0.967273 max acc epoch : 19 test accuracy : 0.962100
Counter({0: 4091, 1: 3600})

Epoch :  20 loss training:  2.549357444513589 Time :  2145
accuracy train: 0.995556 val: 0.963636 test: 0.960274
max validation accuracy : 0.967273 max acc epoch : 19 test accuracy : 0.962100
Counter({1: 4113, 0: 3578})

Epoch :  21 loss training:  2.6559101336752065 Time :  2209
accuracy train: 0.996162 val: 0.960000 test: 0.966210
max validation accuracy : 0.967273 max acc epoch : 19 test accuracy : 0.962100
Counter({0: 4111, 1: 3580})

Epoch :  22 loss training:  2.15631241875235 Time :  2233
accuracy train: 0.996162 val: 0.961818 test: 0.959817
max validation accuracy : 0.967273 max acc epoch : 19 test accuracy : 0.962100
Counter({1: 4093, 0: 3598})

Epoch :  23 loss training:  2.1070969477295876 Time :  2265
accuracy train: 0.996566 val: 0.958182 test: 0.963927
max validation accuracy : 0.967273 max acc epoch : 19 test accuracy : 0.962100
Counter({1: 4087, 0: 3604})

Epoch :  24 loss training:  2.152845029544551 Time :  2289
accuracy train: 0.996768 val: 0.958182 test: 0.962100
max validation accuracy : 0.967273 max acc epoch : 19 test accuracy : 0.962100
Counter({1: 4064, 0: 3627})

Epoch :  25 loss training:  1.8614280359470285 Time :  2315
accuracy train: 0.995556 val: 0.960000 test: 0.965753
max validation accuracy : 0.967273 max acc epoch : 19 test accuracy : 0.962100
Counter({0: 4078, 1: 3613})

Epoch :  26 loss training:  1.5953812544466928 Time :  2353
accuracy train: 0.996364 val: 0.956364 test: 0.965297
max validation accuracy : 0.967273 max acc epoch : 19 test accuracy : 0.962100
Counter({0: 4094, 1: 3597})

Epoch :  27 loss training:  4.116807125683408 Time :  2377
accuracy train: 0.981216 val: 0.945455 test: 0.934247
max validation accuracy : 0.967273 max acc epoch : 19 test accuracy : 0.962100
Counter({0: 4230, 1: 3461})

Epoch :  28 loss training:  3.6228064718889073 Time :  2408
accuracy train: 0.985659 val: 0.938182 test: 0.956164
max validation accuracy : 0.967273 max acc epoch : 19 test accuracy : 0.962100
Counter({1: 4174, 0: 3517})

Epoch :  29 loss training:  2.5259314886061475 Time :  2432
accuracy train: 0.996364 val: 0.965455 test: 0.965297
max validation accuracy : 0.967273 max acc epoch : 19 test accuracy : 0.962100
Counter({1: 4123, 0: 3568})

Epoch :  30 loss training:  3.721760952670593 Time :  2458
accuracy train: 0.996566 val: 0.961818 test: 0.966210
max validation accuracy : 0.967273 max acc epoch : 19 test accuracy : 0.962100
Counter({0: 4112, 1: 3579})

========================================================================================================================================================================================================
best acc epoch :  19
validation accuracy :  0.9672727272727273
test accuracy :  0.9621004566210045
last test_accuracy :  0.9662100456621004
second best val :  0.9654545454545455
second best test :  0.9621004566210045
max gap 6
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.005, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=964, tsne=False, weight_decay=1e-07)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  61.62725601345301 Time :  2507
accuracy train: 0.837609 val: 0.834545 test: 0.850228
max validation accuracy : 0.834545 max acc epoch : 1 test accuracy : 0.850228
Counter({1: 5403, 0: 2288})
Epoch-1 lr: 0.005

Epoch :  2 loss training:  35.90412977337837 Time :  2533
accuracy train: 0.949303 val: 0.934545 test: 0.951142
max validation accuracy : 0.934545 max acc epoch : 2 test accuracy : 0.951142
Counter({0: 4458, 1: 3233})
Epoch-2 lr: 0.005

Epoch :  3 loss training:  25.578027503564954 Time :  2556
accuracy train: 0.949505 val: 0.950909 test: 0.940183
max validation accuracy : 0.950909 max acc epoch : 3 test accuracy : 0.940183
Counter({1: 4264, 0: 3427})
Epoch-3 lr: 0.0025

Epoch :  4 loss training:  17.209406880196184 Time :  2591
accuracy train: 0.958392 val: 0.941818 test: 0.945205
max validation accuracy : 0.950909 max acc epoch : 3 test accuracy : 0.940183
Counter({0: 4342, 1: 3349})
Epoch-4 lr: 0.0025

Epoch :  5 loss training:  14.331714569125324 Time :  2615
accuracy train: 0.973541 val: 0.958182 test: 0.960274
max validation accuracy : 0.958182 max acc epoch : 5 test accuracy : 0.960274
Counter({1: 4369, 0: 3322})
Epoch-5 lr: 0.0025

Epoch :  6 loss training:  12.364035699516535 Time :  2648
accuracy train: 0.977782 val: 0.967273 test: 0.959361
max validation accuracy : 0.967273 max acc epoch : 6 test accuracy : 0.959361
Counter({1: 4288, 0: 3403})
Epoch-6 lr: 0.00125

Epoch :  7 loss training:  9.314394950401038 Time :  2677
accuracy train: 0.980004 val: 0.961818 test: 0.957534
max validation accuracy : 0.967273 max acc epoch : 6 test accuracy : 0.959361
Counter({0: 4294, 1: 3397})
Epoch-7 lr: 0.00125

Epoch :  8 loss training:  9.398892860335764 Time :  2713
accuracy train: 0.982428 val: 0.965455 test: 0.962100
max validation accuracy : 0.967273 max acc epoch : 6 test accuracy : 0.959361
Counter({0: 4356, 1: 3335})
Epoch-8 lr: 0.00125

Epoch :  9 loss training:  9.00459116930142 Time :  2740
accuracy train: 0.988689 val: 0.972727 test: 0.962557
max validation accuracy : 0.972727 max acc epoch : 9 test accuracy : 0.962557
Counter({0: 4380, 1: 3311})
Epoch-9 lr: 0.000625

Epoch :  10 loss training:  7.458204826281872 Time :  2765
accuracy train: 0.988689 val: 0.972727 test: 0.967580
max validation accuracy : 0.972727 max acc epoch : 9 test accuracy : 0.962557
Counter({0: 4316, 1: 3375})

Epoch :  11 loss training:  6.822869656956755 Time :  2793
accuracy train: 0.988689 val: 0.970909 test: 0.964384
max validation accuracy : 0.972727 max acc epoch : 9 test accuracy : 0.962557
Counter({0: 4335, 1: 3356})

Epoch :  12 loss training:  5.710977094233385 Time :  2828
accuracy train: 0.992123 val: 0.976364 test: 0.968950
max validation accuracy : 0.976364 max acc epoch : 12 test accuracy : 0.968950
Counter({1: 4369, 0: 3322})

Epoch :  13 loss training:  5.116136038908735 Time :  2857
accuracy train: 0.992931 val: 0.974545 test: 0.968950
max validation accuracy : 0.976364 max acc epoch : 12 test accuracy : 0.968950
Counter({0: 4371, 1: 3320})

Epoch :  14 loss training:  4.511547464644536 Time :  2880
accuracy train: 0.994749 val: 0.969091 test: 0.964384
max validation accuracy : 0.976364 max acc epoch : 12 test accuracy : 0.968950
Counter({1: 4392, 0: 3299})

Epoch :  15 loss training:  4.00821150187403 Time :  2906
accuracy train: 0.994951 val: 0.969091 test: 0.964840
max validation accuracy : 0.976364 max acc epoch : 12 test accuracy : 0.968950
Counter({0: 4360, 1: 3331})

Epoch :  16 loss training:  3.4690247314283624 Time :  2937
accuracy train: 0.996162 val: 0.970909 test: 0.964840
max validation accuracy : 0.976364 max acc epoch : 12 test accuracy : 0.968950
Counter({0: 4381, 1: 3310})

Epoch :  17 loss training:  2.7471349980914965 Time :  2959
accuracy train: 0.995152 val: 0.965455 test: 0.966210
max validation accuracy : 0.976364 max acc epoch : 12 test accuracy : 0.968950
Counter({1: 4367, 0: 3324})

Epoch :  18 loss training:  2.5902805193618406 Time :  2983
accuracy train: 0.996364 val: 0.970909 test: 0.965297
max validation accuracy : 0.976364 max acc epoch : 12 test accuracy : 0.968950
Counter({1: 4371, 0: 3320})

Epoch :  19 loss training:  2.566710860995954 Time :  3007
accuracy train: 0.996364 val: 0.970909 test: 0.962100
max validation accuracy : 0.976364 max acc epoch : 12 test accuracy : 0.968950
Counter({0: 4391, 1: 3300})

Epoch :  20 loss training:  2.216168443497736 Time :  3035
accuracy train: 0.996364 val: 0.976364 test: 0.960274
max validation accuracy : 0.976364 max acc epoch : 12 test accuracy : 0.968950
Counter({0: 4407, 1: 3284})

Epoch :  21 loss training:  2.2826248076744378 Time :  3057
accuracy train: 0.996566 val: 0.967273 test: 0.959817
max validation accuracy : 0.976364 max acc epoch : 12 test accuracy : 0.968950
Counter({1: 4391, 0: 3300})

Epoch :  22 loss training:  1.999958597123623 Time :  3080
accuracy train: 0.996768 val: 0.972727 test: 0.961644
max validation accuracy : 0.976364 max acc epoch : 12 test accuracy : 0.968950
Counter({0: 4413, 1: 3278})

Epoch :  23 loss training:  1.983599864091957 Time :  3110
accuracy train: 0.996364 val: 0.970909 test: 0.953425
max validation accuracy : 0.976364 max acc epoch : 12 test accuracy : 0.968950
Counter({1: 4412, 0: 3279})

========================================================================================================================================================================================================
best acc epoch :  12
validation accuracy :  0.9763636363636363
test accuracy :  0.9689497716894977
last test_accuracy :  0.9534246575342465
second best val :  0.9745454545454545
second best test :  0.9689497716894977
max gap 3
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.005, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=182, tsne=False, weight_decay=1e-07)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  65.63686502352357 Time :  3147
accuracy train: 0.899212 val: 0.889091 test: 0.893151
max validation accuracy : 0.889091 max acc epoch : 1 test accuracy : 0.893151
Counter({0: 5544, 1: 2147})
Epoch-1 lr: 0.005

slurmstepd: error: *** JOB 37378 ON cl-gpusrv1 CANCELLED AT 2021-06-15T00:22:41 ***
