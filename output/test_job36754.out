

date and time :  Tue Jun  8 18:50:50 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=735, weight_decay=0)
device :  cuda:0
min_len_of_sentence : 0
max_len_of_sentence : 241
min_num_of_sentence : 2
max_num_of_sentence : 25
average_len_of_sentence: 14.564306415596345
average_num_of_sentence: 8.532837837837837
Total_num_of_sentence : 63143
Counter({'C14': 1175, 'C04': 1030, 'C23': 796, 'C10': 557, 'C21': 553, 'C20': 410, 'C06': 354, 'C12': 342, 'C18': 323, 'C08': 250, 'C17': 233, 'C05': 223, 'C01': 216, 'C13': 195, 'C15': 133, 'C16': 129, 'C11': 125, 'C19': 86, 'C02': 75, 'C07': 63, 'C09': 63, 'C03': 50, 'C22': 19})
Total_number_of_words: 12412
Total_number_of_categories: 23
vocab size : 12412
got embeddings of : 11675
Counter({0: 3470, 2: 2497, 1: 1433})

Epoch :  1 loss training:  263.7888566851616 Time :  217
accuracy train: 0.680344 val: 0.629851 test: 0.614148
max validation accuracy : 0.629851 max acc epoch : 1 test accuracy : 0.614148
Counter({1: 4525, 0: 2402, 2: 473})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  150.1958284676075 Time :  250
accuracy train: 0.736598 val: 0.638806 test: 0.626268
max validation accuracy : 0.638806 max acc epoch : 2 test accuracy : 0.626268
Counter({0: 3389, 1: 2438, 2: 1573})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  126.52996947616339 Time :  288
accuracy train: 0.779947 val: 0.680597 test: 0.646302
max validation accuracy : 0.680597 max acc epoch : 3 test accuracy : 0.646302
Counter({2: 3518, 1: 2421, 0: 1461})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  87.1815741956234 Time :  316
accuracy train: 0.861350 val: 0.695522 test: 0.702696
max validation accuracy : 0.695522 max acc epoch : 4 test accuracy : 0.702696
Counter({2: 3385, 0: 2419, 1: 1596})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  68.79963763058186 Time :  345
accuracy train: 0.897419 val: 0.674627 test: 0.706653
max validation accuracy : 0.695522 max acc epoch : 4 test accuracy : 0.702696
Counter({1: 3402, 2: 2416, 0: 1582})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  56.38132183253765 Time :  382
accuracy train: 0.908339 val: 0.677612 test: 0.695523
max validation accuracy : 0.695522 max acc epoch : 4 test accuracy : 0.702696
Counter({2: 3390, 1: 2419, 0: 1591})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  44.18405216932297 Time :  421
accuracy train: 0.942422 val: 0.698507 test: 0.718526
max validation accuracy : 0.698507 max acc epoch : 7 test accuracy : 0.718526
Counter({0: 3396, 2: 2429, 1: 1575})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  36.988141380250454 Time :  471
accuracy train: 0.941430 val: 0.695522 test: 0.714816
max validation accuracy : 0.698507 max acc epoch : 7 test accuracy : 0.718526
Counter({1: 3411, 2: 2427, 0: 1562})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  33.24673192203045 Time :  515
accuracy train: 0.963931 val: 0.680597 test: 0.718031
max validation accuracy : 0.698507 max acc epoch : 7 test accuracy : 0.718526
Counter({2: 3444, 1: 2412, 0: 1544})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  28.695196826010942 Time :  555
accuracy train: 0.972204 val: 0.674627 test: 0.718773
max validation accuracy : 0.698507 max acc epoch : 7 test accuracy : 0.718526
Counter({0: 3405, 1: 2422, 2: 1573})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  24.39681800454855 Time :  581
accuracy train: 0.975513 val: 0.674627 test: 0.719268
max validation accuracy : 0.698507 max acc epoch : 7 test accuracy : 0.718526
Counter({0: 3419, 1: 2419, 2: 1562})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  25.712148569524288 Time :  608
accuracy train: 0.976175 val: 0.689552 test: 0.719515
max validation accuracy : 0.698507 max acc epoch : 7 test accuracy : 0.718526
Counter({0: 3436, 2: 2422, 1: 1542})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  22.38129112124443 Time :  635
accuracy train: 0.979815 val: 0.689552 test: 0.721494
max validation accuracy : 0.698507 max acc epoch : 7 test accuracy : 0.718526
Counter({2: 3426, 0: 2420, 1: 1554})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  20.780175898224115 Time :  698
accuracy train: 0.984447 val: 0.674627 test: 0.719763
max validation accuracy : 0.698507 max acc epoch : 7 test accuracy : 0.718526
Counter({2: 3420, 0: 2421, 1: 1559})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  20.502406872808933 Time :  730
accuracy train: 0.985440 val: 0.683582 test: 0.721494
max validation accuracy : 0.698507 max acc epoch : 7 test accuracy : 0.718526
Counter({1: 3417, 0: 2425, 2: 1558})

Epoch :  16 loss training:  19.75489914789796 Time :  759
accuracy train: 0.985109 val: 0.692537 test: 0.719515
max validation accuracy : 0.698507 max acc epoch : 7 test accuracy : 0.718526
Counter({1: 3444, 2: 2413, 0: 1543})

Epoch :  17 loss training:  18.605871237814426 Time :  786
accuracy train: 0.986433 val: 0.683582 test: 0.717784
max validation accuracy : 0.698507 max acc epoch : 7 test accuracy : 0.718526
Counter({0: 3447, 1: 2415, 2: 1538})

Epoch :  18 loss training:  17.025688644498587 Time :  816
accuracy train: 0.990404 val: 0.683582 test: 0.719763
max validation accuracy : 0.698507 max acc epoch : 7 test accuracy : 0.718526
Counter({1: 3444, 0: 2417, 2: 1539})

Epoch :  19 loss training:  16.28015861287713 Time :  842
accuracy train: 0.993382 val: 0.686567 test: 0.718773
max validation accuracy : 0.698507 max acc epoch : 7 test accuracy : 0.718526
Counter({1: 3460, 2: 2412, 0: 1528})

Epoch :  20 loss training:  15.270340293645859 Time :  872
accuracy train: 0.993382 val: 0.692537 test: 0.719021
max validation accuracy : 0.698507 max acc epoch : 7 test accuracy : 0.718526
Counter({1: 3456, 2: 2415, 0: 1529})

Epoch :  21 loss training:  15.31465120241046 Time :  901
accuracy train: 0.995698 val: 0.692537 test: 0.714568
max validation accuracy : 0.698507 max acc epoch : 7 test accuracy : 0.718526
Counter({1: 3471, 0: 2415, 2: 1514})

Epoch :  22 loss training:  14.634374918416142 Time :  925
accuracy train: 0.994375 val: 0.686567 test: 0.716794
max validation accuracy : 0.698507 max acc epoch : 7 test accuracy : 0.718526
Counter({0: 3473, 2: 2411, 1: 1516})

Epoch :  23 loss training:  13.520616034045815 Time :  951
accuracy train: 0.994375 val: 0.695522 test: 0.719268
max validation accuracy : 0.698507 max acc epoch : 7 test accuracy : 0.718526
Counter({2: 3493, 0: 2405, 1: 1502})

Epoch :  24 loss training:  13.211423369124532 Time :  981
accuracy train: 0.996029 val: 0.704478 test: 0.715558
max validation accuracy : 0.704478 max acc epoch : 24 test accuracy : 0.715558
Counter({0: 3504, 1: 2397, 2: 1499})

Epoch :  25 loss training:  11.769727311097085 Time :  1006
accuracy train: 0.997022 val: 0.698507 test: 0.718031
max validation accuracy : 0.704478 max acc epoch : 24 test accuracy : 0.715558
Counter({0: 3492, 2: 2407, 1: 1501})

Epoch :  26 loss training:  11.649854393675923 Time :  1036
accuracy train: 0.996691 val: 0.698507 test: 0.715063
max validation accuracy : 0.704478 max acc epoch : 24 test accuracy : 0.715558
Counter({2: 3500, 1: 2402, 0: 1498})

Epoch :  27 loss training:  11.813755791634321 Time :  1064
accuracy train: 0.998345 val: 0.695522 test: 0.714321
max validation accuracy : 0.704478 max acc epoch : 24 test accuracy : 0.715558
Counter({1: 3506, 2: 2402, 0: 1492})

Epoch :  28 loss training:  11.324383502826095 Time :  1090
accuracy train: 0.998015 val: 0.707463 test: 0.715310
max validation accuracy : 0.707463 max acc epoch : 28 test accuracy : 0.715310
Counter({0: 3511, 2: 2400, 1: 1489})

Epoch :  29 loss training:  10.92054130602628 Time :  1118
accuracy train: 0.999007 val: 0.698507 test: 0.714816
max validation accuracy : 0.707463 max acc epoch : 28 test accuracy : 0.715310
Counter({0: 3505, 1: 2403, 2: 1492})

Epoch :  30 loss training:  9.651820852421224 Time :  1142
accuracy train: 0.998676 val: 0.716418 test: 0.716547
max validation accuracy : 0.716418 max acc epoch : 30 test accuracy : 0.716547
Counter({1: 3497, 2: 2405, 0: 1498})

Epoch :  31 loss training:  8.97706372756511 Time :  1176
accuracy train: 0.999669 val: 0.704478 test: 0.719268
max validation accuracy : 0.716418 max acc epoch : 30 test accuracy : 0.716547
Counter({1: 3499, 0: 2397, 2: 1504})

Epoch :  32 loss training:  8.38509269617498 Time :  1203
accuracy train: 1.000000 val: 0.713433 test: 0.719021
max validation accuracy : 0.716418 max acc epoch : 30 test accuracy : 0.716547
Counter({2: 3499, 0: 2396, 1: 1505})

Epoch :  33 loss training:  8.730191800743341 Time :  1230
accuracy train: 0.999338 val: 0.710448 test: 0.720505
max validation accuracy : 0.716418 max acc epoch : 30 test accuracy : 0.716547
Counter({1: 3501, 2: 2397, 0: 1502})

Epoch :  34 loss training:  7.965986710041761 Time :  1256
accuracy train: 1.000000 val: 0.704478 test: 0.720999
max validation accuracy : 0.716418 max acc epoch : 30 test accuracy : 0.716547
Counter({1: 3499, 2: 2400, 0: 1501})

Epoch :  35 loss training:  7.597258331254125 Time :  1279
accuracy train: 1.000000 val: 0.698507 test: 0.717784
max validation accuracy : 0.716418 max acc epoch : 30 test accuracy : 0.716547
Counter({0: 3499, 2: 2406, 1: 1495})

Epoch :  36 loss training:  7.487740245647728 Time :  1316
accuracy train: 1.000000 val: 0.716418 test: 0.716300
max validation accuracy : 0.716418 max acc epoch : 30 test accuracy : 0.716547
Counter({1: 3501, 2: 2406, 0: 1493})

Epoch :  37 loss training:  6.453372556716204 Time :  1342
accuracy train: 1.000000 val: 0.704478 test: 0.717042
max validation accuracy : 0.716418 max acc epoch : 30 test accuracy : 0.716547
Counter({0: 3501, 2: 2404, 1: 1495})

Epoch :  38 loss training:  6.948941863141954 Time :  1368
accuracy train: 1.000000 val: 0.707463 test: 0.718773
max validation accuracy : 0.716418 max acc epoch : 30 test accuracy : 0.716547
Counter({2: 3505, 1: 2405, 0: 1490})

Epoch :  39 loss training:  6.453913711942732 Time :  1395
accuracy train: 1.000000 val: 0.713433 test: 0.722483
max validation accuracy : 0.716418 max acc epoch : 30 test accuracy : 0.716547
Counter({1: 3493, 0: 2412, 2: 1495})

Epoch :  40 loss training:  6.2988666500896215 Time :  1419
accuracy train: 1.000000 val: 0.704478 test: 0.723473
max validation accuracy : 0.716418 max acc epoch : 30 test accuracy : 0.716547
Counter({0: 3493, 1: 2416, 2: 1491})

Epoch :  41 loss training:  5.557905055582523 Time :  1442
accuracy train: 1.000000 val: 0.719403 test: 0.720752
max validation accuracy : 0.719403 max acc epoch : 41 test accuracy : 0.720752
Counter({0: 3485, 1: 2406, 2: 1509})

Epoch :  42 loss training:  5.741637700237334 Time :  1474
accuracy train: 0.999669 val: 0.710448 test: 0.714816
max validation accuracy : 0.719403 max acc epoch : 41 test accuracy : 0.720752
Counter({0: 3479, 2: 2411, 1: 1510})

Epoch :  43 loss training:  4.939634683076292 Time :  1501
accuracy train: 1.000000 val: 0.707463 test: 0.715558
max validation accuracy : 0.719403 max acc epoch : 41 test accuracy : 0.720752
Counter({0: 3466, 2: 2409, 1: 1525})

Epoch :  44 loss training:  5.299889633432031 Time :  1527
accuracy train: 1.000000 val: 0.701493 test: 0.720999
max validation accuracy : 0.719403 max acc epoch : 41 test accuracy : 0.720752
Counter({0: 3460, 2: 2410, 1: 1530})

Epoch :  45 loss training:  4.587381161749363 Time :  1553
accuracy train: 1.000000 val: 0.698507 test: 0.720999
max validation accuracy : 0.719403 max acc epoch : 41 test accuracy : 0.720752
Counter({0: 3472, 1: 2408, 2: 1520})

Epoch :  46 loss training:  4.876092582009733 Time :  1587
accuracy train: 1.000000 val: 0.716418 test: 0.714568
max validation accuracy : 0.719403 max acc epoch : 41 test accuracy : 0.720752
Counter({0: 3469, 2: 2413, 1: 1518})

Epoch :  47 loss training:  4.628394049126655 Time :  1614
accuracy train: 1.000000 val: 0.716418 test: 0.720010
max validation accuracy : 0.719403 max acc epoch : 41 test accuracy : 0.720752
Counter({0: 3467, 1: 2398, 2: 1535})

Epoch :  48 loss training:  4.255556603893638 Time :  1640
accuracy train: 1.000000 val: 0.716418 test: 0.718279
max validation accuracy : 0.719403 max acc epoch : 41 test accuracy : 0.720752
Counter({2: 3469, 0: 2403, 1: 1528})

Epoch :  49 loss training:  4.296801393851638 Time :  1667
accuracy train: 1.000000 val: 0.707463 test: 0.716052
max validation accuracy : 0.719403 max acc epoch : 41 test accuracy : 0.720752
Counter({0: 3483, 2: 2400, 1: 1517})

Epoch :  50 loss training:  4.223716668318957 Time :  1712
accuracy train: 1.000000 val: 0.707463 test: 0.715805
max validation accuracy : 0.719403 max acc epoch : 41 test accuracy : 0.720752
Counter({2: 3505, 1: 2401, 0: 1494})

Epoch :  51 loss training:  3.965001372154802 Time :  1746
accuracy train: 1.000000 val: 0.707463 test: 0.717289
max validation accuracy : 0.719403 max acc epoch : 41 test accuracy : 0.720752
Counter({1: 3514, 2: 2400, 0: 1486})

Epoch :  52 loss training:  3.7384054958820343 Time :  1772
accuracy train: 1.000000 val: 0.704478 test: 0.720752
max validation accuracy : 0.719403 max acc epoch : 41 test accuracy : 0.720752
Counter({2: 3509, 1: 2400, 0: 1491})

Epoch :  53 loss training:  2.9637574669905007 Time :  1796
accuracy train: 1.000000 val: 0.722388 test: 0.718773
max validation accuracy : 0.722388 max acc epoch : 53 test accuracy : 0.718773
Counter({1: 3511, 2: 2403, 0: 1486})

Epoch :  54 loss training:  3.5899003385566175 Time :  1826
accuracy train: 1.000000 val: 0.719403 test: 0.721989
max validation accuracy : 0.722388 max acc epoch : 53 test accuracy : 0.718773
Counter({0: 3500, 2: 2404, 1: 1496})

Epoch :  55 loss training:  3.29502508463338 Time :  1854
accuracy train: 1.000000 val: 0.707463 test: 0.718526
max validation accuracy : 0.722388 max acc epoch : 53 test accuracy : 0.718773
Counter({1: 3487, 2: 2403, 0: 1510})

Epoch :  56 loss training:  2.9822984093334526 Time :  1882
accuracy train: 1.000000 val: 0.722388 test: 0.719021
max validation accuracy : 0.722388 max acc epoch : 53 test accuracy : 0.718773
Counter({0: 3482, 1: 2405, 2: 1513})

Epoch :  57 loss training:  3.1012437739409506 Time :  1908
accuracy train: 1.000000 val: 0.722388 test: 0.718279
max validation accuracy : 0.722388 max acc epoch : 53 test accuracy : 0.718773
Counter({2: 3492, 0: 2402, 1: 1506})

Epoch :  58 loss training:  2.9044926709029824 Time :  1966
accuracy train: 1.000000 val: 0.722388 test: 0.717536
max validation accuracy : 0.722388 max acc epoch : 53 test accuracy : 0.718773
Counter({2: 3487, 0: 2401, 1: 1512})

Epoch :  59 loss training:  2.7854182632872835 Time :  1994
accuracy train: 1.000000 val: 0.725373 test: 0.720257
max validation accuracy : 0.725373 max acc epoch : 59 test accuracy : 0.720257
Counter({0: 3505, 1: 2396, 2: 1499})

Epoch :  60 loss training:  2.6504963387269527 Time :  2021
accuracy train: 1.000000 val: 0.719403 test: 0.719763
max validation accuracy : 0.725373 max acc epoch : 59 test accuracy : 0.720257
Counter({0: 3522, 2: 2391, 1: 1487})

Epoch :  61 loss training:  2.4410467208363116 Time :  2044
accuracy train: 1.000000 val: 0.716418 test: 0.716052
max validation accuracy : 0.725373 max acc epoch : 59 test accuracy : 0.720257
Counter({1: 3532, 2: 2386, 0: 1482})

Epoch :  62 loss training:  2.2843682419043034 Time :  2079
accuracy train: 1.000000 val: 0.731343 test: 0.717784
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({2: 3526, 0: 2390, 1: 1484})

Epoch :  63 loss training:  2.6661217917571776 Time :  2107
accuracy train: 1.000000 val: 0.725373 test: 0.719268
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({0: 3498, 1: 2398, 2: 1504})

Epoch :  64 loss training:  2.279274920001626 Time :  2132
accuracy train: 1.000000 val: 0.707463 test: 0.720505
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({2: 3493, 1: 2398, 0: 1509})

Epoch :  65 loss training:  2.1802718467079103 Time :  2174
accuracy train: 1.000000 val: 0.725373 test: 0.717042
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({0: 4542, 1: 2416, 2: 442})

Epoch :  66 loss training:  2.072583409259096 Time :  2206
accuracy train: 1.000000 val: 0.716418 test: 0.716794
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({2: 3496, 1: 2397, 0: 1507})

Epoch :  67 loss training:  2.180667871842161 Time :  2234
accuracy train: 1.000000 val: 0.725373 test: 0.717536
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({2: 3522, 1: 2400, 0: 1478})

Epoch :  68 loss training:  2.6355362731264904 Time :  2266
accuracy train: 0.999669 val: 0.731343 test: 0.720010
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({1: 3505, 0: 2399, 2: 1496})

Epoch :  69 loss training:  2.259351209970191 Time :  2293
accuracy train: 1.000000 val: 0.728358 test: 0.719515
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({2: 3525, 0: 2389, 1: 1486})

Epoch :  70 loss training:  1.8954176136758178 Time :  2320
accuracy train: 1.000000 val: 0.725373 test: 0.714321
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({2: 3539, 0: 2395, 1: 1466})

Epoch :  71 loss training:  1.6823149756528437 Time :  2345
accuracy train: 1.000000 val: 0.713433 test: 0.720752
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({0: 3544, 2: 2393, 1: 1463})

Epoch :  72 loss training:  1.9188619015039876 Time :  2379
accuracy train: 1.000000 val: 0.710448 test: 0.719515
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({2: 3531, 1: 2393, 0: 1476})

Epoch :  73 loss training:  1.9711587470956147 Time :  2407
accuracy train: 1.000000 val: 0.719403 test: 0.723473
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({0: 3538, 1: 2393, 2: 1469})

Epoch :  74 loss training:  1.731981776538305 Time :  2434
accuracy train: 1.000000 val: 0.707463 test: 0.718526
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({0: 3526, 1: 2403, 2: 1471})

Epoch :  75 loss training:  1.6677628350444138 Time :  2461
accuracy train: 1.000000 val: 0.725373 test: 0.720999
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({1: 3513, 0: 2399, 2: 1488})

Epoch :  76 loss training:  1.3632981944829226 Time :  2488
accuracy train: 1.000000 val: 0.689552 test: 0.721741
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({2: 3503, 0: 2401, 1: 1496})

Epoch :  77 loss training:  1.5884415452601388 Time :  2514
accuracy train: 0.999669 val: 0.725373 test: 0.717042
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({2: 3503, 0: 2404, 1: 1493})

Epoch :  78 loss training:  1.8367967606754974 Time :  2544
accuracy train: 1.000000 val: 0.716418 test: 0.720257
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({2: 3516, 1: 2395, 0: 1489})

Epoch :  79 loss training:  1.577270467823837 Time :  2569
accuracy train: 1.000000 val: 0.707463 test: 0.722236
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({2: 3509, 1: 2393, 0: 1498})

Epoch :  80 loss training:  1.3237618658458814 Time :  2593
accuracy train: 1.000000 val: 0.716418 test: 0.722483
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({0: 3505, 2: 2395, 1: 1500})

Epoch :  81 loss training:  1.143592888256535 Time :  2627
accuracy train: 1.000000 val: 0.719403 test: 0.722731
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({0: 3493, 1: 2405, 2: 1502})

Epoch :  82 loss training:  1.6470999015728012 Time :  2656
accuracy train: 1.000000 val: 0.713433 test: 0.719021
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({2: 3501, 1: 2401, 0: 1498})

Epoch :  83 loss training:  1.2000422611599788 Time :  2682
accuracy train: 1.000000 val: 0.713433 test: 0.721741
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({1: 3512, 2: 2394, 0: 1494})

Epoch :  84 loss training:  1.3045957540161908 Time :  2709
accuracy train: 1.000000 val: 0.716418 test: 0.722978
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({2: 3505, 0: 2399, 1: 1496})

Epoch :  85 loss training:  1.5340918756555766 Time :  2736
accuracy train: 1.000000 val: 0.722388 test: 0.720010
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({2: 3499, 0: 2387, 1: 1514})

Epoch :  86 loss training:  1.290571432968136 Time :  2768
accuracy train: 1.000000 val: 0.728358 test: 0.721741
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({1: 3497, 2: 2398, 0: 1505})

Epoch :  87 loss training:  1.6235971582937054 Time :  2796
accuracy train: 1.000000 val: 0.731343 test: 0.718526
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({0: 3508, 1: 2396, 2: 1496})

Epoch :  88 loss training:  1.608504420146346 Time :  2833
accuracy train: 1.000000 val: 0.716418 test: 0.720257
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({2: 3503, 0: 2400, 1: 1497})

Epoch :  89 loss training:  1.8266823034500703 Time :  2863
accuracy train: 1.000000 val: 0.710448 test: 0.722483
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({1: 3487, 0: 2411, 2: 1502})

Epoch :  90 loss training:  0.947809019300621 Time :  2888
accuracy train: 1.000000 val: 0.725373 test: 0.722731
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({0: 3500, 1: 2407, 2: 1493})

Epoch :  91 loss training:  0.9402085959445685 Time :  2923
accuracy train: 1.000000 val: 0.722388 test: 0.725204
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({2: 3498, 1: 2397, 0: 1505})

Epoch :  92 loss training:  1.2284928692388348 Time :  2951
accuracy train: 1.000000 val: 0.719403 test: 0.718031
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({2: 3506, 0: 2401, 1: 1493})

Epoch :  93 loss training:  1.2272952529019676 Time :  2975
accuracy train: 1.000000 val: 0.725373 test: 0.717784
max validation accuracy : 0.731343 max acc epoch : 62 test accuracy : 0.717784
Counter({0: 3513, 1: 2402, 2: 1485})

========================================================================================================================================================================================================
max acc epoch :  62
max validation accuracy :  0.7313432835820896
test accuracy :  0.7177838238931487
last test_accuracy :  0.7177838238931487
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=735, weight_decay=0)
device :  cuda:0
Counter({0: 3470, 1: 2497, 2: 1433})

Epoch :  1 loss training:  263.17475497722626 Time :  3017
accuracy train: 0.672402 val: 0.591045 test: 0.611180
max validation accuracy : 0.591045 max acc epoch : 1 test accuracy : 0.611180
Counter({2: 2625, 0: 2496, 1: 2279})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  151.61190256476402 Time :  3041
accuracy train: 0.726671 val: 0.644776 test: 0.624784
max validation accuracy : 0.644776 max acc epoch : 2 test accuracy : 0.624784
Counter({2: 3202, 1: 2357, 0: 1841})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  128.10282300412655 Time :  3078
accuracy train: 0.783587 val: 0.686567 test: 0.648528
max validation accuracy : 0.686567 max acc epoch : 3 test accuracy : 0.648528
Counter({1: 3486, 0: 2449, 2: 1465})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  85.63481380790472 Time :  3106
accuracy train: 0.853739 val: 0.692537 test: 0.691566
max validation accuracy : 0.692537 max acc epoch : 4 test accuracy : 0.691566
Counter({0: 3119, 1: 2364, 2: 1917})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  66.48113629221916 Time :  3136
accuracy train: 0.894772 val: 0.710448 test: 0.699975
max validation accuracy : 0.710448 max acc epoch : 5 test accuracy : 0.699975
Counter({0: 3374, 1: 2432, 2: 1594})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  57.68620143830776 Time :  3162
accuracy train: 0.916281 val: 0.683582 test: 0.692802
max validation accuracy : 0.710448 max acc epoch : 5 test accuracy : 0.699975
Counter({1: 3346, 2: 2426, 0: 1628})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  42.98778539150953 Time :  3200
accuracy train: 0.941099 val: 0.689552 test: 0.709127
max validation accuracy : 0.710448 max acc epoch : 5 test accuracy : 0.699975
Counter({0: 3392, 2: 2420, 1: 1588})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  35.5954275354743 Time :  3228
accuracy train: 0.945069 val: 0.692537 test: 0.707643
max validation accuracy : 0.710448 max acc epoch : 5 test accuracy : 0.699975
Counter({1: 3414, 0: 2425, 2: 1561})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  33.243881553411484 Time :  3255
accuracy train: 0.964924 val: 0.689552 test: 0.710858
max validation accuracy : 0.710448 max acc epoch : 5 test accuracy : 0.699975
Counter({0: 3421, 2: 2433, 1: 1546})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  28.18990171700716 Time :  3280
accuracy train: 0.974189 val: 0.692537 test: 0.709622
max validation accuracy : 0.710448 max acc epoch : 5 test accuracy : 0.699975
Counter({1: 3131, 0: 2352, 2: 1917})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  27.632855460047722 Time :  3321
accuracy train: 0.973197 val: 0.686567 test: 0.713579
max validation accuracy : 0.710448 max acc epoch : 5 test accuracy : 0.699975
Counter({1: 3365, 0: 2410, 2: 1625})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  26.003616012632847 Time :  3348
accuracy train: 0.977498 val: 0.698507 test: 0.713579
max validation accuracy : 0.710448 max acc epoch : 5 test accuracy : 0.699975
Counter({1: 3409, 2: 2427, 0: 1564})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  21.37231943756342 Time :  3375
accuracy train: 0.982131 val: 0.725373 test: 0.717042
max validation accuracy : 0.725373 max acc epoch : 13 test accuracy : 0.717042
Counter({2: 3413, 1: 2432, 0: 1555})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  20.78021690621972 Time :  3401
accuracy train: 0.987426 val: 0.704478 test: 0.718526
max validation accuracy : 0.725373 max acc epoch : 13 test accuracy : 0.717042
Counter({1: 3412, 0: 2433, 2: 1555})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  19.42923664674163 Time :  3433
accuracy train: 0.985440 val: 0.707463 test: 0.722731
max validation accuracy : 0.725373 max acc epoch : 13 test accuracy : 0.717042
Counter({2: 3420, 1: 2428, 0: 1552})

Epoch :  16 loss training:  18.783624667674303 Time :  3460
accuracy train: 0.987756 val: 0.704478 test: 0.717536
max validation accuracy : 0.725373 max acc epoch : 13 test accuracy : 0.717042
Counter({1: 3431, 2: 2430, 0: 1539})

Epoch :  17 loss training:  18.46108227223158 Time :  3489
accuracy train: 0.988418 val: 0.713433 test: 0.716547
max validation accuracy : 0.725373 max acc epoch : 13 test accuracy : 0.717042
Counter({2: 3434, 0: 2429, 1: 1537})

Epoch :  18 loss training:  17.693705454468727 Time :  3515
accuracy train: 0.991066 val: 0.713433 test: 0.718279
max validation accuracy : 0.725373 max acc epoch : 13 test accuracy : 0.717042
Counter({1: 3432, 2: 2431, 0: 1537})

Epoch :  19 loss training:  16.771948844194412 Time :  3555
accuracy train: 0.992058 val: 0.716418 test: 0.719515
max validation accuracy : 0.725373 max acc epoch : 13 test accuracy : 0.717042
Counter({1: 3433, 2: 2431, 0: 1536})

Epoch :  20 loss training:  16.608441311866045 Time :  3586
accuracy train: 0.993382 val: 0.716418 test: 0.718031
max validation accuracy : 0.725373 max acc epoch : 13 test accuracy : 0.717042
Counter({2: 3438, 0: 2433, 1: 1529})

Epoch :  21 loss training:  16.040311861783266 Time :  3613
accuracy train: 0.993713 val: 0.704478 test: 0.717289
max validation accuracy : 0.725373 max acc epoch : 13 test accuracy : 0.717042
Counter({2: 3435, 0: 2430, 1: 1535})

Epoch :  22 loss training:  14.60013823211193 Time :  3650
accuracy train: 0.996029 val: 0.713433 test: 0.716300
max validation accuracy : 0.725373 max acc epoch : 13 test accuracy : 0.717042
Counter({1: 3461, 2: 2434, 0: 1505})

Epoch :  23 loss training:  13.942365683615208 Time :  3693
accuracy train: 0.994044 val: 0.731343 test: 0.723720
max validation accuracy : 0.731343 max acc epoch : 23 test accuracy : 0.723720
Counter({0: 3452, 2: 2438, 1: 1510})

Epoch :  24 loss training:  12.926309769973159 Time :  3723
accuracy train: 0.996360 val: 0.719403 test: 0.717289
max validation accuracy : 0.731343 max acc epoch : 23 test accuracy : 0.723720
Counter({1: 3454, 2: 2437, 0: 1509})

Epoch :  25 loss training:  13.164637649431825 Time :  3750
accuracy train: 0.997353 val: 0.725373 test: 0.723473
max validation accuracy : 0.731343 max acc epoch : 23 test accuracy : 0.723720
Counter({1: 3458, 2: 2440, 0: 1502})

Epoch :  26 loss training:  11.721198178827763 Time :  3774
accuracy train: 0.997022 val: 0.725373 test: 0.720257
max validation accuracy : 0.731343 max acc epoch : 23 test accuracy : 0.723720
Counter({2: 3471, 0: 2440, 1: 1489})

Epoch :  27 loss training:  11.477240778505802 Time :  3797
accuracy train: 0.998345 val: 0.722388 test: 0.721989
max validation accuracy : 0.731343 max acc epoch : 23 test accuracy : 0.723720
Counter({1: 3482, 0: 2440, 2: 1478})

Epoch :  28 loss training:  10.580132618546486 Time :  3819
accuracy train: 0.997684 val: 0.719403 test: 0.720505
max validation accuracy : 0.731343 max acc epoch : 23 test accuracy : 0.723720
Counter({2: 3480, 1: 2440, 0: 1480})

Epoch :  29 loss training:  9.963328447192907 Time :  3841
accuracy train: 0.998345 val: 0.710448 test: 0.720752
max validation accuracy : 0.731343 max acc epoch : 23 test accuracy : 0.723720
Counter({0: 3480, 2: 2438, 1: 1482})

Epoch :  30 loss training:  9.792827213183045 Time :  3864
accuracy train: 0.998015 val: 0.722388 test: 0.717784
max validation accuracy : 0.731343 max acc epoch : 23 test accuracy : 0.723720
Counter({2: 3464, 1: 2441, 0: 1495})

Epoch :  31 loss training:  9.019549775868654 Time :  3887
accuracy train: 0.998676 val: 0.713433 test: 0.721989
max validation accuracy : 0.731343 max acc epoch : 23 test accuracy : 0.723720
Counter({0: 3464, 2: 2442, 1: 1494})

Epoch :  32 loss training:  8.942392295226455 Time :  3909
accuracy train: 0.998345 val: 0.713433 test: 0.719515
max validation accuracy : 0.731343 max acc epoch : 23 test accuracy : 0.723720
Counter({2: 3466, 0: 2438, 1: 1496})

Epoch :  33 loss training:  8.404250205494463 Time :  3931
accuracy train: 0.999007 val: 0.722388 test: 0.721494
max validation accuracy : 0.731343 max acc epoch : 23 test accuracy : 0.723720
Counter({2: 3483, 1: 2429, 0: 1488})

Epoch :  34 loss training:  8.14593174122274 Time :  3955
accuracy train: 0.999669 val: 0.716418 test: 0.722978
max validation accuracy : 0.731343 max acc epoch : 23 test accuracy : 0.723720
Counter({1: 3483, 0: 2432, 2: 1485})

Epoch :  35 loss training:  8.117992326617241 Time :  3977
accuracy train: 1.000000 val: 0.722388 test: 0.721494
max validation accuracy : 0.731343 max acc epoch : 23 test accuracy : 0.723720
Counter({0: 3480, 2: 2438, 1: 1482})

Epoch :  36 loss training:  7.18296142667532 Time :  4001
accuracy train: 0.999669 val: 0.719403 test: 0.721741
max validation accuracy : 0.731343 max acc epoch : 23 test accuracy : 0.723720
Counter({0: 3478, 1: 2438, 2: 1484})

Epoch :  37 loss training:  6.576366676948965 Time :  4025
accuracy train: 0.999669 val: 0.719403 test: 0.723473
max validation accuracy : 0.731343 max acc epoch : 23 test accuracy : 0.723720
Counter({2: 3479, 1: 2442, 0: 1479})

Epoch :  38 loss training:  6.653668410144746 Time :  4049
accuracy train: 1.000000 val: 0.719403 test: 0.722236
max validation accuracy : 0.731343 max acc epoch : 23 test accuracy : 0.723720
Counter({0: 3481, 2: 2443, 1: 1476})

Epoch :  39 loss training:  6.729600909631699 Time :  4072
accuracy train: 1.000000 val: 0.743284 test: 0.723225
max validation accuracy : 0.743284 max acc epoch : 39 test accuracy : 0.723225
Counter({0: 3478, 1: 2425, 2: 1497})

Epoch :  40 loss training:  5.875064125284553 Time :  4096
accuracy train: 0.999669 val: 0.734328 test: 0.720752
max validation accuracy : 0.743284 max acc epoch : 39 test accuracy : 0.723225
Counter({1: 3486, 2: 2427, 0: 1487})

Epoch :  41 loss training:  6.148642145562917 Time :  4119
accuracy train: 1.000000 val: 0.719403 test: 0.720505
max validation accuracy : 0.743284 max acc epoch : 39 test accuracy : 0.723225
Counter({0: 3480, 1: 2430, 2: 1490})

Epoch :  42 loss training:  4.784387071616948 Time :  4141
accuracy train: 1.000000 val: 0.725373 test: 0.723473
max validation accuracy : 0.743284 max acc epoch : 39 test accuracy : 0.723225
Counter({1: 3478, 0: 2420, 2: 1502})

Epoch :  43 loss training:  5.3892616969533265 Time :  4165
accuracy train: 1.000000 val: 0.719403 test: 0.721741
max validation accuracy : 0.743284 max acc epoch : 39 test accuracy : 0.723225
Counter({0: 3470, 1: 2429, 2: 1501})

Epoch :  44 loss training:  4.576064835302532 Time :  4187
accuracy train: 1.000000 val: 0.731343 test: 0.721989
max validation accuracy : 0.743284 max acc epoch : 39 test accuracy : 0.723225
Counter({2: 3474, 0: 2434, 1: 1492})

Epoch :  45 loss training:  4.55819851718843 Time :  4210
accuracy train: 1.000000 val: 0.725373 test: 0.720505
max validation accuracy : 0.743284 max acc epoch : 39 test accuracy : 0.723225
Counter({2: 3484, 0: 2422, 1: 1494})

Epoch :  46 loss training:  4.77868093829602 Time :  4233
accuracy train: 1.000000 val: 0.728358 test: 0.719763
max validation accuracy : 0.743284 max acc epoch : 39 test accuracy : 0.723225
Counter({1: 3491, 0: 2426, 2: 1483})

Epoch :  47 loss training:  4.514293611980975 Time :  4256
accuracy train: 1.000000 val: 0.713433 test: 0.722236
max validation accuracy : 0.743284 max acc epoch : 39 test accuracy : 0.723225
Counter({1: 3501, 2: 2424, 0: 1475})

Epoch :  48 loss training:  4.350609857589006 Time :  4279
accuracy train: 0.999338 val: 0.728358 test: 0.720257
max validation accuracy : 0.743284 max acc epoch : 39 test accuracy : 0.723225
Counter({2: 3493, 0: 2427, 1: 1480})

Epoch :  49 loss training:  4.293153008911759 Time :  4304
accuracy train: 1.000000 val: 0.719403 test: 0.719515
max validation accuracy : 0.743284 max acc epoch : 39 test accuracy : 0.723225
Counter({2: 3484, 0: 2427, 1: 1489})

Epoch :  50 loss training:  3.877494604792446 Time :  4328
accuracy train: 1.000000 val: 0.734328 test: 0.717784
max validation accuracy : 0.743284 max acc epoch : 39 test accuracy : 0.723225
Counter({1: 3504, 2: 2429, 0: 1467})

Epoch :  51 loss training:  3.3740568591747433 Time :  4351
accuracy train: 1.000000 val: 0.716418 test: 0.721741
max validation accuracy : 0.743284 max acc epoch : 39 test accuracy : 0.723225
Counter({2: 3503, 1: 2431, 0: 1466})

Epoch :  52 loss training:  3.564568995498121 Time :  4375
accuracy train: 1.000000 val: 0.725373 test: 0.720752
max validation accuracy : 0.743284 max acc epoch : 39 test accuracy : 0.723225
Counter({1: 3512, 2: 2432, 0: 1456})

Epoch :  53 loss training:  3.4430058740545064 Time :  4399
accuracy train: 1.000000 val: 0.728358 test: 0.721989
max validation accuracy : 0.743284 max acc epoch : 39 test accuracy : 0.723225
Counter({2: 3509, 0: 2435, 1: 1456})

Epoch :  54 loss training:  2.97626415011473 Time :  4424
accuracy train: 1.000000 val: 0.728358 test: 0.722731
max validation accuracy : 0.743284 max acc epoch : 39 test accuracy : 0.723225
Counter({0: 3538, 2: 2420, 1: 1442})

Epoch :  55 loss training:  2.909876122837886 Time :  4447
accuracy train: 0.999669 val: 0.743284 test: 0.722978
max validation accuracy : 0.743284 max acc epoch : 39 test accuracy : 0.723225
Counter({2: 3536, 1: 2422, 0: 1442})

Epoch :  56 loss training:  2.972035774961114 Time :  4471
accuracy train: 1.000000 val: 0.749254 test: 0.719763
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({0: 3535, 1: 2425, 2: 1440})

Epoch :  57 loss training:  2.8811507974751294 Time :  4494
accuracy train: 1.000000 val: 0.722388 test: 0.718773
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({1: 3521, 2: 2431, 0: 1448})

Epoch :  58 loss training:  2.5652922494336963 Time :  4517
accuracy train: 1.000000 val: 0.722388 test: 0.721247
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({1: 3510, 2: 2426, 0: 1464})

Epoch :  59 loss training:  2.9511507214047015 Time :  4541
accuracy train: 1.000000 val: 0.737313 test: 0.724709
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({1: 3523, 0: 2422, 2: 1455})

Epoch :  60 loss training:  2.6842252911883406 Time :  4563
accuracy train: 1.000000 val: 0.731343 test: 0.722978
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({1: 3524, 0: 2425, 2: 1451})

Epoch :  61 loss training:  2.5512294073123485 Time :  4587
accuracy train: 1.000000 val: 0.740299 test: 0.719763
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({1: 3521, 0: 2431, 2: 1448})

Epoch :  62 loss training:  2.9040471555199474 Time :  4610
accuracy train: 1.000000 val: 0.725373 test: 0.719021
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({2: 3522, 0: 2430, 1: 1448})

Epoch :  63 loss training:  2.5618599373847246 Time :  4633
accuracy train: 1.000000 val: 0.725373 test: 0.721989
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({2: 3539, 1: 2437, 0: 1424})

Epoch :  64 loss training:  3.14686422329396 Time :  4656
accuracy train: 1.000000 val: 0.710448 test: 0.721247
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({2: 3540, 1: 2435, 0: 1425})

Epoch :  65 loss training:  2.307080974569544 Time :  4678
accuracy train: 1.000000 val: 0.731343 test: 0.720999
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({1: 3551, 0: 2426, 2: 1423})

Epoch :  66 loss training:  2.0709462605882436 Time :  4700
accuracy train: 1.000000 val: 0.722388 test: 0.720999
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({1: 3532, 2: 2423, 0: 1445})

Epoch :  67 loss training:  1.9633048193063587 Time :  4724
accuracy train: 1.000000 val: 0.737313 test: 0.719021
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({2: 3543, 1: 2428, 0: 1429})

Epoch :  68 loss training:  2.5709823477081954 Time :  4746
accuracy train: 1.000000 val: 0.722388 test: 0.721741
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({2: 3525, 1: 2416, 0: 1459})

Epoch :  69 loss training:  2.3505845004692674 Time :  4791
accuracy train: 1.000000 val: 0.722388 test: 0.721741
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({2: 3515, 0: 2418, 1: 1467})

Epoch :  70 loss training:  1.7450823185499758 Time :  4812
accuracy train: 1.000000 val: 0.728358 test: 0.721989
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({1: 3524, 2: 2425, 0: 1451})

Epoch :  71 loss training:  1.6494193996768445 Time :  4834
accuracy train: 1.000000 val: 0.719403 test: 0.718031
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({0: 3512, 1: 2427, 2: 1461})

Epoch :  72 loss training:  1.4880208616377786 Time :  4859
accuracy train: 1.000000 val: 0.722388 test: 0.722483
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({0: 3509, 1: 2428, 2: 1463})

Epoch :  73 loss training:  2.056460489402525 Time :  4887
accuracy train: 1.000000 val: 0.728358 test: 0.724215
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({1: 3510, 2: 2420, 0: 1470})

Epoch :  74 loss training:  1.7195424336241558 Time :  4909
accuracy train: 1.000000 val: 0.728358 test: 0.723225
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({2: 3497, 1: 2424, 0: 1479})

Epoch :  75 loss training:  1.7823713085381314 Time :  4930
accuracy train: 1.000000 val: 0.734328 test: 0.720505
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({0: 3510, 1: 2429, 2: 1461})

Epoch :  76 loss training:  1.4641051336657256 Time :  4952
accuracy train: 1.000000 val: 0.734328 test: 0.720999
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({1: 3533, 2: 2427, 0: 1440})

Epoch :  77 loss training:  1.255580808618106 Time :  4972
accuracy train: 1.000000 val: 0.737313 test: 0.720010
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({1: 3540, 2: 2424, 0: 1436})

Epoch :  78 loss training:  1.5377953343559057 Time :  4994
accuracy train: 1.000000 val: 0.725373 test: 0.721494
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({0: 3534, 1: 2419, 2: 1447})

Epoch :  79 loss training:  1.3278254090691917 Time :  5017
accuracy train: 1.000000 val: 0.731343 test: 0.722731
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({2: 3557, 1: 2417, 0: 1426})

Epoch :  80 loss training:  1.240321524324827 Time :  5039
accuracy train: 1.000000 val: 0.737313 test: 0.725946
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({2: 3549, 0: 2419, 1: 1432})

Epoch :  81 loss training:  1.0172606069827452 Time :  5061
accuracy train: 1.000000 val: 0.740299 test: 0.723225
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({0: 3530, 1: 2419, 2: 1451})

Epoch :  82 loss training:  1.2956703695235774 Time :  5083
accuracy train: 1.000000 val: 0.737313 test: 0.724215
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({0: 3521, 1: 2422, 2: 1457})

Epoch :  83 loss training:  1.2485514213331044 Time :  5105
accuracy train: 1.000000 val: 0.722388 test: 0.721494
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({2: 3536, 0: 2416, 1: 1448})

Epoch :  84 loss training:  1.667718229466118 Time :  5125
accuracy train: 1.000000 val: 0.713433 test: 0.718526
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({0: 3502, 1: 2436, 2: 1462})

Epoch :  85 loss training:  1.1963665157090873 Time :  5147
accuracy train: 1.000000 val: 0.725373 test: 0.720505
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({1: 3546, 2: 2425, 0: 1429})

Epoch :  86 loss training:  1.3517837162944488 Time :  5169
accuracy train: 1.000000 val: 0.728358 test: 0.722978
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({0: 3552, 2: 2429, 1: 1419})

Epoch :  87 loss training:  1.1628664397867396 Time :  5188
accuracy train: 1.000000 val: 0.740299 test: 0.720752
max validation accuracy : 0.749254 max acc epoch : 56 test accuracy : 0.719763
Counter({1: 3575, 0: 2421, 2: 1404})

========================================================================================================================================================================================================
max acc epoch :  56
max validation accuracy :  0.7492537313432835
test accuracy :  0.7197625525599802
last test_accuracy :  0.720751916893396
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=735, weight_decay=0)
device :  cuda:0
Counter({0: 3470, 1: 2497, 2: 1433})

Epoch :  1 loss training:  263.2365954518318 Time :  5219
accuracy train: 0.667770 val: 0.600000 test: 0.608706
max validation accuracy : 0.600000 max acc epoch : 1 test accuracy : 0.608706
Counter({2: 3354, 0: 2428, 1: 1618})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  150.85850524902344 Time :  5241
accuracy train: 0.733289 val: 0.659701 test: 0.626762
max validation accuracy : 0.659701 max acc epoch : 2 test accuracy : 0.626762
Counter({0: 3479, 2: 2427, 1: 1494})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  127.39437571167946 Time :  5263
accuracy train: 0.775314 val: 0.677612 test: 0.648528
max validation accuracy : 0.677612 max acc epoch : 3 test accuracy : 0.648528
Counter({0: 3483, 2: 2439, 1: 1478})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  86.824941650033 Time :  5285
accuracy train: 0.865983 val: 0.686567 test: 0.698491
max validation accuracy : 0.686567 max acc epoch : 4 test accuracy : 0.698491
Counter({1: 3429, 0: 2424, 2: 1547})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  67.17298894375563 Time :  5307
accuracy train: 0.896757 val: 0.692537 test: 0.703438
max validation accuracy : 0.692537 max acc epoch : 5 test accuracy : 0.703438
Counter({0: 3423, 2: 2433, 1: 1544})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  58.51770819723606 Time :  5329
accuracy train: 0.910324 val: 0.677612 test: 0.695770
max validation accuracy : 0.692537 max acc epoch : 5 test accuracy : 0.703438
Counter({1: 3441, 2: 2421, 0: 1538})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  44.194728173315525 Time :  5352
accuracy train: 0.936797 val: 0.695522 test: 0.714816
max validation accuracy : 0.695522 max acc epoch : 7 test accuracy : 0.714816
Counter({0: 3424, 2: 2434, 1: 1542})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  35.73810948431492 Time :  5374
accuracy train: 0.941430 val: 0.695522 test: 0.709374
max validation accuracy : 0.695522 max acc epoch : 7 test accuracy : 0.714816
Counter({2: 3402, 1: 2433, 0: 1565})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  34.26886601746082 Time :  5395
accuracy train: 0.958968 val: 0.695522 test: 0.708385
max validation accuracy : 0.695522 max acc epoch : 7 test accuracy : 0.714816
Counter({2: 3430, 0: 2434, 1: 1536})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  28.567663468420506 Time :  5417
accuracy train: 0.972535 val: 0.686567 test: 0.708880
max validation accuracy : 0.695522 max acc epoch : 7 test accuracy : 0.714816
Counter({2: 3444, 1: 2435, 0: 1521})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  26.91956329718232 Time :  5440
accuracy train: 0.975513 val: 0.692537 test: 0.712342
max validation accuracy : 0.695522 max acc epoch : 7 test accuracy : 0.714816
Counter({1: 3450, 0: 2440, 2: 1510})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  25.830960482358932 Time :  5462
accuracy train: 0.974189 val: 0.701493 test: 0.714321
max validation accuracy : 0.701493 max acc epoch : 12 test accuracy : 0.714321
Counter({0: 3446, 1: 2432, 2: 1522})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  21.87189679592848 Time :  5484
accuracy train: 0.981138 val: 0.698507 test: 0.719763
max validation accuracy : 0.701493 max acc epoch : 12 test accuracy : 0.714321
Counter({2: 3460, 0: 2432, 1: 1508})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  21.252543695271015 Time :  5507
accuracy train: 0.987095 val: 0.698507 test: 0.716052
max validation accuracy : 0.701493 max acc epoch : 12 test accuracy : 0.714321
Counter({1: 3454, 2: 2436, 0: 1510})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  20.124738097190857 Time :  5529
accuracy train: 0.986433 val: 0.701493 test: 0.717289
max validation accuracy : 0.701493 max acc epoch : 12 test accuracy : 0.714321
Counter({2: 3479, 1: 2423, 0: 1498})

Epoch :  16 loss training:  18.51023769378662 Time :  5551
accuracy train: 0.987095 val: 0.719403 test: 0.720257
max validation accuracy : 0.719403 max acc epoch : 16 test accuracy : 0.720257
Counter({0: 3491, 1: 2429, 2: 1480})

Epoch :  17 loss training:  18.944706812500954 Time :  5576
accuracy train: 0.989080 val: 0.710448 test: 0.718279
max validation accuracy : 0.719403 max acc epoch : 16 test accuracy : 0.720257
Counter({1: 3476, 0: 2429, 2: 1495})

Epoch :  18 loss training:  18.505974899977446 Time :  5601
accuracy train: 0.987426 val: 0.713433 test: 0.718526
max validation accuracy : 0.719403 max acc epoch : 16 test accuracy : 0.720257
Counter({1: 3466, 2: 2427, 0: 1507})

Epoch :  19 loss training:  16.855511812493205 Time :  5623
accuracy train: 0.992720 val: 0.701493 test: 0.716052
max validation accuracy : 0.719403 max acc epoch : 16 test accuracy : 0.720257
Counter({1: 3458, 2: 2426, 0: 1516})

Epoch :  20 loss training:  16.811667431145906 Time :  5646
accuracy train: 0.993713 val: 0.704478 test: 0.721494
max validation accuracy : 0.719403 max acc epoch : 16 test accuracy : 0.720257
Counter({0: 3464, 2: 2423, 1: 1513})

Epoch :  21 loss training:  15.723976323381066 Time :  5667
accuracy train: 0.995367 val: 0.710448 test: 0.719763
max validation accuracy : 0.719403 max acc epoch : 16 test accuracy : 0.720257
Counter({2: 3456, 0: 2423, 1: 1521})

Epoch :  22 loss training:  14.838956132531166 Time :  5689
accuracy train: 0.994705 val: 0.716418 test: 0.718031
max validation accuracy : 0.719403 max acc epoch : 16 test accuracy : 0.720257
Counter({1: 3465, 0: 2426, 2: 1509})

Epoch :  23 loss training:  13.651918949559331 Time :  5711
accuracy train: 0.995036 val: 0.722388 test: 0.721247
max validation accuracy : 0.722388 max acc epoch : 23 test accuracy : 0.721247
Counter({2: 3469, 0: 2424, 1: 1507})

Epoch :  24 loss training:  12.990381583571434 Time :  5732
accuracy train: 0.995698 val: 0.713433 test: 0.721989
max validation accuracy : 0.722388 max acc epoch : 23 test accuracy : 0.721247
Counter({0: 3472, 2: 2421, 1: 1507})

Epoch :  25 loss training:  12.102711323648691 Time :  5754
accuracy train: 0.997022 val: 0.704478 test: 0.720010
max validation accuracy : 0.722388 max acc epoch : 23 test accuracy : 0.721247
Counter({1: 3478, 0: 2428, 2: 1494})

Epoch :  26 loss training:  11.799891859292984 Time :  5776
accuracy train: 0.998676 val: 0.713433 test: 0.719763
max validation accuracy : 0.722388 max acc epoch : 23 test accuracy : 0.721247
Counter({1: 3469, 2: 2428, 0: 1503})

Epoch :  27 loss training:  11.138737216591835 Time :  5798
accuracy train: 0.999338 val: 0.707463 test: 0.724215
max validation accuracy : 0.722388 max acc epoch : 23 test accuracy : 0.721247
Counter({2: 3454, 1: 2422, 0: 1524})

Epoch :  28 loss training:  10.193794536404312 Time :  5821
accuracy train: 0.998345 val: 0.716418 test: 0.717784
max validation accuracy : 0.722388 max acc epoch : 23 test accuracy : 0.721247
Counter({0: 3457, 1: 2419, 2: 1524})

Epoch :  29 loss training:  10.637895742431283 Time :  5842
accuracy train: 0.998676 val: 0.710448 test: 0.710116
max validation accuracy : 0.722388 max acc epoch : 23 test accuracy : 0.721247
Counter({1: 3468, 0: 2400, 2: 1532})

Epoch :  30 loss training:  9.65345206297934 Time :  5864
accuracy train: 0.999007 val: 0.713433 test: 0.716300
max validation accuracy : 0.722388 max acc epoch : 23 test accuracy : 0.721247
Counter({1: 3472, 0: 2407, 2: 1521})

Epoch :  31 loss training:  8.617610614746809 Time :  5886
accuracy train: 0.999669 val: 0.713433 test: 0.720752
max validation accuracy : 0.722388 max acc epoch : 23 test accuracy : 0.721247
Counter({2: 3468, 0: 2410, 1: 1522})

Epoch :  32 loss training:  9.274884411133826 Time :  5907
accuracy train: 0.999338 val: 0.716418 test: 0.714074
max validation accuracy : 0.722388 max acc epoch : 23 test accuracy : 0.721247
Counter({0: 3484, 1: 2411, 2: 1505})

Epoch :  33 loss training:  8.75281847268343 Time :  5929
accuracy train: 0.999669 val: 0.719403 test: 0.718279
max validation accuracy : 0.722388 max acc epoch : 23 test accuracy : 0.721247
Counter({0: 3493, 2: 2414, 1: 1493})

Epoch :  34 loss training:  7.926358772441745 Time :  5952
accuracy train: 1.000000 val: 0.713433 test: 0.722483
max validation accuracy : 0.722388 max acc epoch : 23 test accuracy : 0.721247
Counter({0: 3495, 2: 2412, 1: 1493})

Epoch :  35 loss training:  7.602601146325469 Time :  5973
accuracy train: 1.000000 val: 0.722388 test: 0.719268
max validation accuracy : 0.722388 max acc epoch : 23 test accuracy : 0.721247
Counter({0: 3499, 2: 2411, 1: 1490})

Epoch :  36 loss training:  7.451743842102587 Time :  5995
accuracy train: 1.000000 val: 0.716418 test: 0.719268
max validation accuracy : 0.722388 max acc epoch : 23 test accuracy : 0.721247
Counter({0: 3495, 2: 2415, 1: 1490})

Epoch :  37 loss training:  6.694122437387705 Time :  6017
accuracy train: 1.000000 val: 0.731343 test: 0.721494
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.721494
Counter({0: 3512, 1: 2409, 2: 1479})

Epoch :  38 loss training:  6.995602060109377 Time :  6038
accuracy train: 0.999669 val: 0.728358 test: 0.720999
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.721494
Counter({2: 3498, 0: 2410, 1: 1492})

Epoch :  39 loss training:  6.537842077203095 Time :  6060
accuracy train: 1.000000 val: 0.731343 test: 0.720010
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.721494
Counter({1: 3472, 2: 2403, 0: 1525})

Epoch :  40 loss training:  6.169308293610811 Time :  6082
accuracy train: 0.999669 val: 0.731343 test: 0.719268
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.721494
Counter({0: 3485, 1: 2397, 2: 1518})

Epoch :  41 loss training:  5.807801101822406 Time :  6103
accuracy train: 0.999669 val: 0.719403 test: 0.719268
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.721494
Counter({0: 3486, 2: 2394, 1: 1520})

Epoch :  42 loss training:  4.934524780139327 Time :  6124
accuracy train: 0.999669 val: 0.713433 test: 0.717784
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.721494
Counter({0: 3485, 2: 2405, 1: 1510})

Epoch :  43 loss training:  4.97271551983431 Time :  6147
accuracy train: 0.999669 val: 0.710448 test: 0.721247
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.721494
Counter({2: 3484, 1: 2408, 0: 1508})

Epoch :  44 loss training:  4.927474863361567 Time :  6176
accuracy train: 0.999669 val: 0.722388 test: 0.720010
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.721494
Counter({2: 3497, 1: 2398, 0: 1505})

Epoch :  45 loss training:  4.2934535080567 Time :  6203
accuracy train: 0.999338 val: 0.719403 test: 0.719515
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.721494
Counter({2: 3486, 1: 2394, 0: 1520})

Epoch :  46 loss training:  5.023625816684216 Time :  6234
accuracy train: 1.000000 val: 0.722388 test: 0.714321
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.721494
Counter({0: 3525, 2: 2401, 1: 1474})

Epoch :  47 loss training:  4.590296678710729 Time :  6262
accuracy train: 1.000000 val: 0.716418 test: 0.718526
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.721494
Counter({2: 3530, 1: 2396, 0: 1474})

Epoch :  48 loss training:  4.279653185047209 Time :  6287
accuracy train: 1.000000 val: 0.722388 test: 0.720257
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.721494
Counter({2: 3518, 1: 2405, 0: 1477})

Epoch :  49 loss training:  3.961855442263186 Time :  6325
accuracy train: 1.000000 val: 0.725373 test: 0.718526
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.721494
Counter({1: 3507, 2: 2413, 0: 1480})

Epoch :  50 loss training:  3.8855177289806306 Time :  6348
accuracy train: 1.000000 val: 0.713433 test: 0.716794
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.721494
Counter({0: 3517, 2: 2412, 1: 1471})

Epoch :  51 loss training:  3.4098267150111496 Time :  6370
accuracy train: 1.000000 val: 0.728358 test: 0.719268
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.721494
Counter({2: 3525, 1: 2408, 0: 1467})

Epoch :  52 loss training:  3.6347771915607154 Time :  6391
accuracy train: 1.000000 val: 0.713433 test: 0.721247
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.721494
Counter({0: 3517, 2: 2412, 1: 1471})

Epoch :  53 loss training:  3.1423322707414627 Time :  6414
accuracy train: 1.000000 val: 0.713433 test: 0.722483
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.721494
Counter({1: 3522, 0: 2413, 2: 1465})

Epoch :  54 loss training:  2.8447812462691218 Time :  6442
accuracy train: 1.000000 val: 0.716418 test: 0.720505
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.721494
Counter({0: 3511, 1: 2414, 2: 1475})

Epoch :  55 loss training:  3.1038001235574484 Time :  6465
accuracy train: 1.000000 val: 0.728358 test: 0.722483
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.721494
Counter({1: 3515, 2: 2401, 0: 1484})

Epoch :  56 loss training:  2.9133457499556243 Time :  6487
accuracy train: 1.000000 val: 0.725373 test: 0.723225
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.721494
Counter({1: 3522, 0: 2399, 2: 1479})

Epoch :  57 loss training:  2.8644009409472346 Time :  6509
accuracy train: 1.000000 val: 0.719403 test: 0.720505
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.721494
Counter({2: 3522, 1: 2401, 0: 1477})

Epoch :  58 loss training:  2.4344540373422205 Time :  6532
accuracy train: 1.000000 val: 0.728358 test: 0.718279
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.721494
Counter({1: 3498, 0: 2405, 2: 1497})

Epoch :  59 loss training:  3.346176216378808 Time :  6554
accuracy train: 1.000000 val: 0.725373 test: 0.720505
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.721494
Counter({2: 3494, 0: 2393, 1: 1513})

Epoch :  60 loss training:  2.9665554625098594 Time :  6576
accuracy train: 1.000000 val: 0.725373 test: 0.719021
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.721494
Counter({1: 3472, 0: 2392, 2: 1536})

Epoch :  61 loss training:  2.7066520566586405 Time :  6598
accuracy train: 1.000000 val: 0.725373 test: 0.713084
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.721494
Counter({2: 3484, 1: 2398, 0: 1518})

Epoch :  62 loss training:  2.8300179159268737 Time :  6623
accuracy train: 1.000000 val: 0.725373 test: 0.716300
max validation accuracy : 0.731343 max acc epoch : 37 test accuracy : 0.721494
Counter({0: 3486, 2: 2395, 1: 1519})

Epoch :  63 loss training:  2.347677815472707 Time :  6653
accuracy train: 1.000000 val: 0.734328 test: 0.719021
max validation accuracy : 0.734328 max acc epoch : 63 test accuracy : 0.719021
Counter({0: 3491, 2: 2394, 1: 1515})

Epoch :  64 loss training:  3.152633666759357 Time :  6679
accuracy train: 1.000000 val: 0.719403 test: 0.721494
max validation accuracy : 0.734328 max acc epoch : 63 test accuracy : 0.719021
Counter({0: 3475, 2: 2400, 1: 1525})

Epoch :  65 loss training:  2.3794576952932402 Time :  6704
accuracy train: 1.000000 val: 0.725373 test: 0.718031
max validation accuracy : 0.734328 max acc epoch : 63 test accuracy : 0.719021
Counter({1: 3487, 2: 2392, 0: 1521})

Epoch :  66 loss training:  2.038478146190755 Time :  6730
accuracy train: 1.000000 val: 0.722388 test: 0.722483
max validation accuracy : 0.734328 max acc epoch : 63 test accuracy : 0.719021
Counter({1: 3483, 0: 2390, 2: 1527})

Epoch :  67 loss training:  1.9639049475081265 Time :  6755
accuracy train: 1.000000 val: 0.710448 test: 0.719763
max validation accuracy : 0.734328 max acc epoch : 63 test accuracy : 0.719021
Counter({0: 3484, 1: 2386, 2: 1530})

Epoch :  68 loss training:  2.0798725791973993 Time :  6779
accuracy train: 1.000000 val: 0.728358 test: 0.717289
max validation accuracy : 0.734328 max acc epoch : 63 test accuracy : 0.719021
Counter({0: 3474, 1: 2391, 2: 1535})

Epoch :  69 loss training:  1.9013312407769263 Time :  6805
accuracy train: 1.000000 val: 0.722388 test: 0.720010
max validation accuracy : 0.734328 max acc epoch : 63 test accuracy : 0.719021
Counter({0: 3476, 2: 2396, 1: 1528})

Epoch :  70 loss training:  1.8919753225054592 Time :  6833
accuracy train: 1.000000 val: 0.731343 test: 0.719515
max validation accuracy : 0.734328 max acc epoch : 63 test accuracy : 0.719021
Counter({0: 3486, 2: 2394, 1: 1520})

Epoch :  71 loss training:  1.8421196815324947 Time :  6861
accuracy train: 1.000000 val: 0.716418 test: 0.719268
max validation accuracy : 0.734328 max acc epoch : 63 test accuracy : 0.719021
Counter({1: 3491, 0: 2398, 2: 1511})

Epoch :  72 loss training:  1.4546518770512193 Time :  6886
accuracy train: 1.000000 val: 0.725373 test: 0.719021
max validation accuracy : 0.734328 max acc epoch : 63 test accuracy : 0.719021
Counter({2: 3500, 1: 2388, 0: 1512})

Epoch :  73 loss training:  1.94151492533274 Time :  6911
accuracy train: 1.000000 val: 0.725373 test: 0.723967
max validation accuracy : 0.734328 max acc epoch : 63 test accuracy : 0.719021
Counter({0: 3483, 1: 2385, 2: 1532})

Epoch :  74 loss training:  1.7889944256749004 Time :  6935
accuracy train: 1.000000 val: 0.725373 test: 0.719021
max validation accuracy : 0.734328 max acc epoch : 63 test accuracy : 0.719021
Counter({0: 3445, 1: 2382, 2: 1573})

Epoch :  75 loss training:  1.6565036253305152 Time :  6960
accuracy train: 1.000000 val: 0.734328 test: 0.716547
max validation accuracy : 0.734328 max acc epoch : 63 test accuracy : 0.719021
Counter({0: 3454, 1: 2378, 2: 1568})

Epoch :  76 loss training:  1.3851781361736357 Time :  6985
accuracy train: 1.000000 val: 0.719403 test: 0.717784
max validation accuracy : 0.734328 max acc epoch : 63 test accuracy : 0.719021
Counter({2: 3473, 0: 2383, 1: 1544})

Epoch :  77 loss training:  1.308921652729623 Time :  7010
accuracy train: 1.000000 val: 0.728358 test: 0.720257
max validation accuracy : 0.734328 max acc epoch : 63 test accuracy : 0.719021
Counter({1: 3489, 2: 2399, 0: 1512})

Epoch :  78 loss training:  1.3836051936959848 Time :  7035
accuracy train: 1.000000 val: 0.722388 test: 0.720505
max validation accuracy : 0.734328 max acc epoch : 63 test accuracy : 0.719021
Counter({2: 3475, 1: 2400, 0: 1525})

Epoch :  79 loss training:  1.5767622863641009 Time :  7062
accuracy train: 1.000000 val: 0.740299 test: 0.721989
max validation accuracy : 0.740299 max acc epoch : 79 test accuracy : 0.721989
Counter({0: 3487, 1: 2395, 2: 1518})

Epoch :  80 loss training:  1.4303603913867846 Time :  7089
accuracy train: 1.000000 val: 0.731343 test: 0.716052
max validation accuracy : 0.740299 max acc epoch : 79 test accuracy : 0.721989
Counter({1: 3481, 2: 2388, 0: 1531})

Epoch :  81 loss training:  1.2320321566658095 Time :  7113
accuracy train: 1.000000 val: 0.737313 test: 0.719268
max validation accuracy : 0.740299 max acc epoch : 79 test accuracy : 0.721989
Counter({0: 3492, 2: 2383, 1: 1525})

Epoch :  82 loss training:  1.3772341010626405 Time :  7135
accuracy train: 1.000000 val: 0.722388 test: 0.721494
max validation accuracy : 0.740299 max acc epoch : 79 test accuracy : 0.721989
Counter({0: 3495, 2: 2383, 1: 1522})

Epoch :  83 loss training:  1.2310789423645474 Time :  7157
accuracy train: 1.000000 val: 0.710448 test: 0.716300
max validation accuracy : 0.740299 max acc epoch : 79 test accuracy : 0.721989
Counter({2: 3483, 1: 2384, 0: 1533})

Epoch :  84 loss training:  1.389833248918876 Time :  7179
accuracy train: 1.000000 val: 0.713433 test: 0.710611
max validation accuracy : 0.740299 max acc epoch : 79 test accuracy : 0.721989
Counter({2: 3495, 1: 2385, 0: 1520})

Epoch :  85 loss training:  1.3873150803847238 Time :  7202
accuracy train: 1.000000 val: 0.719403 test: 0.718526
max validation accuracy : 0.740299 max acc epoch : 79 test accuracy : 0.721989
Counter({1: 3508, 2: 2386, 0: 1506})

Epoch :  86 loss training:  1.2963744596927427 Time :  7223
accuracy train: 1.000000 val: 0.713433 test: 0.718279
max validation accuracy : 0.740299 max acc epoch : 79 test accuracy : 0.721989
Counter({1: 3527, 2: 2388, 0: 1485})

Epoch :  87 loss training:  1.3904808388324454 Time :  7246
accuracy train: 1.000000 val: 0.731343 test: 0.716794
max validation accuracy : 0.740299 max acc epoch : 79 test accuracy : 0.721989
Counter({2: 3526, 0: 2400, 1: 1474})

Epoch :  88 loss training:  1.2895815238007344 Time :  7268
accuracy train: 1.000000 val: 0.731343 test: 0.719515
max validation accuracy : 0.740299 max acc epoch : 79 test accuracy : 0.721989
Counter({1: 3538, 2: 2391, 0: 1471})

Epoch :  89 loss training:  1.8352085651131347 Time :  7289
accuracy train: 1.000000 val: 0.725373 test: 0.719021
max validation accuracy : 0.740299 max acc epoch : 79 test accuracy : 0.721989
Counter({2: 3513, 1: 2390, 0: 1497})

Epoch :  90 loss training:  1.0949991869274527 Time :  7313
accuracy train: 1.000000 val: 0.725373 test: 0.719515
max validation accuracy : 0.740299 max acc epoch : 79 test accuracy : 0.721989
Counter({2: 3553, 0: 2390, 1: 1457})

Epoch :  91 loss training:  1.0947522561764345 Time :  7334
accuracy train: 1.000000 val: 0.731343 test: 0.721989
max validation accuracy : 0.740299 max acc epoch : 79 test accuracy : 0.721989
Counter({1: 3548, 0: 2392, 2: 1460})

Epoch :  92 loss training:  0.9764677993080113 Time :  7356
accuracy train: 1.000000 val: 0.725373 test: 0.720010
max validation accuracy : 0.740299 max acc epoch : 79 test accuracy : 0.721989
Counter({0: 3544, 1: 2388, 2: 1468})

Epoch :  93 loss training:  0.8584442741703242 Time :  7379
accuracy train: 1.000000 val: 0.722388 test: 0.720010
max validation accuracy : 0.740299 max acc epoch : 79 test accuracy : 0.721989
Counter({2: 3539, 0: 2388, 1: 1473})

Epoch :  94 loss training:  1.3115175587590784 Time :  7401
accuracy train: 1.000000 val: 0.725373 test: 0.717289
max validation accuracy : 0.740299 max acc epoch : 79 test accuracy : 0.721989
Counter({1: 3507, 0: 2396, 2: 1497})

Epoch :  95 loss training:  1.0297625009552576 Time :  7424
accuracy train: 1.000000 val: 0.737313 test: 0.724957
max validation accuracy : 0.740299 max acc epoch : 79 test accuracy : 0.721989
Counter({0: 3518, 1: 2391, 2: 1491})

Epoch :  96 loss training:  1.0055868123890832 Time :  7446
accuracy train: 1.000000 val: 0.731343 test: 0.722236
max validation accuracy : 0.740299 max acc epoch : 79 test accuracy : 0.721989
Counter({2: 3526, 0: 2395, 1: 1479})

Epoch :  97 loss training:  0.8643275873328093 Time :  7468
accuracy train: 1.000000 val: 0.731343 test: 0.727183
max validation accuracy : 0.740299 max acc epoch : 79 test accuracy : 0.721989
Counter({1: 3515, 2: 2396, 0: 1489})

Epoch :  98 loss training:  1.0024718329077587 Time :  7491
accuracy train: 1.000000 val: 0.737313 test: 0.721741
max validation accuracy : 0.740299 max acc epoch : 79 test accuracy : 0.721989
Counter({2: 3525, 1: 2396, 0: 1479})

Epoch :  99 loss training:  0.838802877929993 Time :  7513
accuracy train: 1.000000 val: 0.734328 test: 0.720257
max validation accuracy : 0.740299 max acc epoch : 79 test accuracy : 0.721989
Counter({2: 3523, 0: 2399, 1: 1478})

Epoch :  100 loss training:  1.240328247891739 Time :  7536
accuracy train: 1.000000 val: 0.728358 test: 0.716547
max validation accuracy : 0.740299 max acc epoch : 79 test accuracy : 0.721989
Counter({1: 3506, 2: 2409, 0: 1485})

Epoch :  101 loss training:  0.8858452753047459 Time :  7560
accuracy train: 1.000000 val: 0.746269 test: 0.715558
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({0: 3513, 1: 2397, 2: 1490})

Epoch :  102 loss training:  0.7180207125784364 Time :  7581
accuracy train: 1.000000 val: 0.740299 test: 0.721247
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({1: 3506, 2: 2393, 0: 1501})

Epoch :  103 loss training:  0.901111958315596 Time :  7604
accuracy train: 1.000000 val: 0.743284 test: 0.721247
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({1: 3511, 0: 2397, 2: 1492})

Epoch :  104 loss training:  1.105249640357215 Time :  7627
accuracy train: 1.000000 val: 0.746269 test: 0.712095
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({0: 3482, 2: 2402, 1: 1516})

Epoch :  105 loss training:  1.0422466853342485 Time :  7651
accuracy train: 1.000000 val: 0.731343 test: 0.712342
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({2: 3496, 0: 2396, 1: 1508})

Epoch :  106 loss training:  0.7385926387796644 Time :  7674
accuracy train: 1.000000 val: 0.737313 test: 0.720257
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({2: 3513, 1: 2386, 0: 1501})

Epoch :  107 loss training:  0.7374695145117585 Time :  7694
accuracy train: 1.000000 val: 0.740299 test: 0.721989
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({2: 3512, 0: 2390, 1: 1498})

Epoch :  108 loss training:  1.3728781105019152 Time :  7718
accuracy train: 1.000000 val: 0.731343 test: 0.721247
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({2: 3516, 0: 2400, 1: 1484})

Epoch :  109 loss training:  0.7644353191135451 Time :  7741
accuracy train: 1.000000 val: 0.722388 test: 0.717784
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({1: 3528, 0: 2406, 2: 1466})

Epoch :  110 loss training:  0.9301677227776963 Time :  7764
accuracy train: 1.000000 val: 0.740299 test: 0.718773
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({2: 3524, 0: 2402, 1: 1474})

Epoch :  111 loss training:  0.7395019830146339 Time :  7786
accuracy train: 1.000000 val: 0.737313 test: 0.720999
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({1: 3549, 2: 2413, 0: 1438})

Epoch :  112 loss training:  0.6651615573500749 Time :  7807
accuracy train: 1.000000 val: 0.731343 test: 0.716052
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({0: 3529, 2: 2404, 1: 1467})

Epoch :  113 loss training:  0.7170226057351101 Time :  7829
accuracy train: 1.000000 val: 0.722388 test: 0.719515
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({2: 3556, 1: 2396, 0: 1448})

Epoch :  114 loss training:  0.7209879901492968 Time :  7852
accuracy train: 1.000000 val: 0.734328 test: 0.715063
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({2: 3561, 0: 2419, 1: 1420})

Epoch :  115 loss training:  0.487828585493844 Time :  7875
accuracy train: 1.000000 val: 0.746269 test: 0.718526
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({1: 3553, 0: 2407, 2: 1440})

Epoch :  116 loss training:  0.51972391831805 Time :  7897
accuracy train: 1.000000 val: 0.743284 test: 0.719021
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({1: 3557, 2: 2402, 0: 1441})

Epoch :  117 loss training:  0.5172835385310464 Time :  7918
accuracy train: 1.000000 val: 0.737313 test: 0.719021
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({0: 3560, 1: 2401, 2: 1439})

Epoch :  118 loss training:  0.40487537343869917 Time :  7941
accuracy train: 1.000000 val: 0.746269 test: 0.716300
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({2: 3549, 0: 2397, 1: 1454})

Epoch :  119 loss training:  0.2762182622391265 Time :  7962
accuracy train: 1.000000 val: 0.734328 test: 0.721494
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({0: 3544, 2: 2397, 1: 1459})

Epoch :  120 loss training:  0.4910367561969906 Time :  7980
accuracy train: 1.000000 val: 0.737313 test: 0.719515
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({1: 3544, 2: 2397, 0: 1459})

Epoch :  121 loss training:  0.48915136911091395 Time :  8000
accuracy train: 1.000000 val: 0.731343 test: 0.720257
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({0: 3534, 2: 2393, 1: 1473})

Epoch :  122 loss training:  0.505196684418479 Time :  8019
accuracy train: 1.000000 val: 0.743284 test: 0.722978
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({2: 3562, 1: 2391, 0: 1447})

Epoch :  123 loss training:  0.5306985791685292 Time :  8039
accuracy train: 1.000000 val: 0.743284 test: 0.723720
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({1: 3550, 2: 2388, 0: 1462})

Epoch :  124 loss training:  0.7315083753201179 Time :  8061
accuracy train: 1.000000 val: 0.740299 test: 0.723720
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({2: 3552, 1: 2394, 0: 1454})

Epoch :  125 loss training:  0.6310430881276261 Time :  8081
accuracy train: 1.000000 val: 0.746269 test: 0.721989
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({0: 3547, 1: 2396, 2: 1457})

Epoch :  126 loss training:  0.7558376223169034 Time :  8101
accuracy train: 1.000000 val: 0.731343 test: 0.715558
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({2: 3539, 1: 2404, 0: 1457})

Epoch :  127 loss training:  0.935641892530839 Time :  8120
accuracy train: 1.000000 val: 0.722388 test: 0.715558
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({1: 3520, 2: 2403, 0: 1477})

Epoch :  128 loss training:  0.42123052568058483 Time :  8140
accuracy train: 1.000000 val: 0.737313 test: 0.718279
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({0: 3541, 1: 2410, 2: 1449})

Epoch :  129 loss training:  0.3146538498986047 Time :  8160
accuracy train: 1.000000 val: 0.728358 test: 0.717289
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({1: 3540, 2: 2408, 0: 1452})

Epoch :  130 loss training:  0.7766457450488815 Time :  8179
accuracy train: 1.000000 val: 0.722388 test: 0.716794
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({1: 3517, 0: 2395, 2: 1488})

Epoch :  131 loss training:  0.5571457737096353 Time :  8199
accuracy train: 1.000000 val: 0.734328 test: 0.717289
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({1: 3524, 0: 2392, 2: 1484})

Epoch :  132 loss training:  0.7657244565052679 Time :  8219
accuracy train: 1.000000 val: 0.722388 test: 0.714321
max validation accuracy : 0.746269 max acc epoch : 101 test accuracy : 0.715558
Counter({0: 3527, 2: 2394, 1: 1479})

========================================================================================================================================================================================================
max acc epoch :  101
max validation accuracy :  0.746268656716418
test accuracy :  0.7155577541429632
last test_accuracy :  0.7143210487261934
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=735, weight_decay=0)
device :  cuda:0
Counter({0: 3470, 1: 2497, 2: 1433})

Epoch :  1 loss training:  263.02118438482285 Time :  8248
accuracy train: 0.671741 val: 0.576119 test: 0.610438
max validation accuracy : 0.576119 max acc epoch : 1 test accuracy : 0.610438
Counter({2: 3361, 0: 2429, 1: 1610})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  150.72259616851807 Time :  8268
accuracy train: 0.730973 val: 0.644776 test: 0.628988
max validation accuracy : 0.644776 max acc epoch : 2 test accuracy : 0.628988
Counter({0: 3487, 2: 2434, 1: 1479})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  125.63211438059807 Time :  8289
accuracy train: 0.773991 val: 0.638806 test: 0.646055
max validation accuracy : 0.644776 max acc epoch : 2 test accuracy : 0.628988
Counter({0: 3480, 1: 2444, 2: 1476})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  85.48053734004498 Time :  8311
accuracy train: 0.857379 val: 0.683582 test: 0.694286
max validation accuracy : 0.683582 max acc epoch : 4 test accuracy : 0.694286
Counter({1: 3416, 0: 2431, 2: 1553})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  67.51937797665596 Time :  8333
accuracy train: 0.897750 val: 0.707463 test: 0.704675
max validation accuracy : 0.707463 max acc epoch : 5 test accuracy : 0.704675
Counter({2: 3429, 0: 2424, 1: 1547})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  57.36767688393593 Time :  8353
accuracy train: 0.909332 val: 0.671642 test: 0.694039
max validation accuracy : 0.707463 max acc epoch : 5 test accuracy : 0.704675
Counter({2: 3434, 0: 2415, 1: 1551})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  43.83376706391573 Time :  8373
accuracy train: 0.940768 val: 0.677612 test: 0.714321
max validation accuracy : 0.707463 max acc epoch : 5 test accuracy : 0.704675
Counter({2: 3457, 1: 2421, 0: 1522})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  34.82523189485073 Time :  8392
accuracy train: 0.945400 val: 0.686567 test: 0.704427
max validation accuracy : 0.707463 max acc epoch : 5 test accuracy : 0.704675
Counter({2: 3463, 1: 2422, 0: 1515})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  33.369779981672764 Time :  8412
accuracy train: 0.969887 val: 0.698507 test: 0.708880
max validation accuracy : 0.707463 max acc epoch : 5 test accuracy : 0.704675
Counter({0: 3459, 1: 2441, 2: 1500})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  27.91709489375353 Time :  8433
accuracy train: 0.976837 val: 0.683582 test: 0.714568
max validation accuracy : 0.707463 max acc epoch : 5 test accuracy : 0.704675
Counter({2: 3457, 1: 2443, 0: 1500})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  26.161376953125 Time :  8455
accuracy train: 0.971211 val: 0.695522 test: 0.712590
max validation accuracy : 0.707463 max acc epoch : 5 test accuracy : 0.704675
Counter({0: 3474, 2: 2440, 1: 1486})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  25.355298835784197 Time :  8476
accuracy train: 0.979815 val: 0.713433 test: 0.716794
max validation accuracy : 0.713433 max acc epoch : 12 test accuracy : 0.716794
Counter({0: 3483, 2: 2433, 1: 1484})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  21.355934385210276 Time :  8495
accuracy train: 0.982131 val: 0.689552 test: 0.720257
max validation accuracy : 0.713433 max acc epoch : 12 test accuracy : 0.716794
Counter({1: 3486, 0: 2429, 2: 1485})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  20.864578373730183 Time :  8516
accuracy train: 0.987426 val: 0.704478 test: 0.716300
max validation accuracy : 0.713433 max acc epoch : 12 test accuracy : 0.716794
Counter({1: 3485, 0: 2428, 2: 1487})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  19.565434902906418 Time :  8536
accuracy train: 0.987095 val: 0.695522 test: 0.720999
max validation accuracy : 0.713433 max acc epoch : 12 test accuracy : 0.716794
Counter({2: 3480, 1: 2432, 0: 1488})

Epoch :  16 loss training:  18.789858277887106 Time :  8556
accuracy train: 0.987756 val: 0.695522 test: 0.719268
max validation accuracy : 0.713433 max acc epoch : 12 test accuracy : 0.716794
Counter({1: 3479, 2: 2428, 0: 1493})

Epoch :  17 loss training:  18.792096704244614 Time :  8577
accuracy train: 0.988418 val: 0.704478 test: 0.719268
max validation accuracy : 0.713433 max acc epoch : 12 test accuracy : 0.716794
Counter({0: 3471, 2: 2432, 1: 1497})

Epoch :  18 loss training:  18.066756207495928 Time :  8597
accuracy train: 0.990735 val: 0.707463 test: 0.720257
max validation accuracy : 0.713433 max acc epoch : 12 test accuracy : 0.716794
Counter({1: 3476, 0: 2424, 2: 1500})

Epoch :  19 loss training:  16.04632980749011 Time :  8639
accuracy train: 0.991396 val: 0.698507 test: 0.716794
max validation accuracy : 0.713433 max acc epoch : 12 test accuracy : 0.716794
Counter({1: 3474, 2: 2430, 0: 1496})

Epoch :  20 loss training:  16.65488689020276 Time :  8665
accuracy train: 0.993382 val: 0.692537 test: 0.719268
max validation accuracy : 0.713433 max acc epoch : 12 test accuracy : 0.716794
Counter({2: 3468, 1: 2434, 0: 1498})

Epoch :  21 loss training:  15.289369696751237 Time :  8688
accuracy train: 0.994705 val: 0.707463 test: 0.718279
max validation accuracy : 0.713433 max acc epoch : 12 test accuracy : 0.716794
Counter({1: 3475, 0: 2429, 2: 1496})

Epoch :  22 loss training:  14.92846079543233 Time :  8712
accuracy train: 0.994705 val: 0.695522 test: 0.714816
max validation accuracy : 0.713433 max acc epoch : 12 test accuracy : 0.716794
Counter({1: 3486, 0: 2431, 2: 1483})

Epoch :  23 loss training:  13.520445125177503 Time :  8745
accuracy train: 0.993713 val: 0.719403 test: 0.718279
max validation accuracy : 0.719403 max acc epoch : 23 test accuracy : 0.718279
Counter({2: 3477, 1: 2432, 0: 1491})

Epoch :  24 loss training:  13.038240153342485 Time :  8779
accuracy train: 0.995698 val: 0.701493 test: 0.719515
max validation accuracy : 0.719403 max acc epoch : 23 test accuracy : 0.718279
Counter({1: 3472, 0: 2435, 2: 1493})

Epoch :  25 loss training:  12.104062401689589 Time :  8824
accuracy train: 0.997353 val: 0.695522 test: 0.719763
max validation accuracy : 0.719403 max acc epoch : 23 test accuracy : 0.718279
Counter({2: 3475, 0: 2437, 1: 1488})

Epoch :  26 loss training:  12.227534163743258 Time :  8851
accuracy train: 0.998015 val: 0.698507 test: 0.714074
max validation accuracy : 0.719403 max acc epoch : 23 test accuracy : 0.718279
Counter({2: 3486, 0: 2431, 1: 1483})

Epoch :  27 loss training:  11.392090663313866 Time :  8892
accuracy train: 0.998015 val: 0.689552 test: 0.716547
max validation accuracy : 0.719403 max acc epoch : 23 test accuracy : 0.718279
Counter({0: 3483, 1: 2434, 2: 1483})

Epoch :  28 loss training:  10.393794365227222 Time :  8918
accuracy train: 0.997353 val: 0.701493 test: 0.719268
max validation accuracy : 0.719403 max acc epoch : 23 test accuracy : 0.718279
Counter({1: 3487, 2: 2428, 0: 1485})

Epoch :  29 loss training:  9.636346076615155 Time :  8945
accuracy train: 0.998345 val: 0.692537 test: 0.717784
max validation accuracy : 0.719403 max acc epoch : 23 test accuracy : 0.718279
Counter({1: 3497, 2: 2425, 0: 1478})

Epoch :  30 loss training:  9.374070156365633 Time :  8970
accuracy train: 0.998676 val: 0.710448 test: 0.719021
max validation accuracy : 0.719403 max acc epoch : 23 test accuracy : 0.718279
Counter({1: 3506, 0: 2424, 2: 1470})

Epoch :  31 loss training:  8.933552249334753 Time :  9003
accuracy train: 0.999669 val: 0.701493 test: 0.723967
max validation accuracy : 0.719403 max acc epoch : 23 test accuracy : 0.718279
Counter({0: 3498, 2: 2424, 1: 1478})

Epoch :  32 loss training:  8.634746735915542 Time :  9028
accuracy train: 0.999669 val: 0.704478 test: 0.718279
max validation accuracy : 0.719403 max acc epoch : 23 test accuracy : 0.718279
Counter({2: 3496, 1: 2428, 0: 1476})

Epoch :  33 loss training:  7.894130765460432 Time :  9066
accuracy train: 1.000000 val: 0.707463 test: 0.717042
max validation accuracy : 0.719403 max acc epoch : 23 test accuracy : 0.718279
Counter({2: 3512, 1: 2425, 0: 1463})

Epoch :  34 loss training:  8.365866556763649 Time :  9092
accuracy train: 1.000000 val: 0.692537 test: 0.717784
max validation accuracy : 0.719403 max acc epoch : 23 test accuracy : 0.718279
Counter({1: 3513, 2: 2424, 0: 1463})

Epoch :  35 loss training:  7.585318385623395 Time :  9133
accuracy train: 1.000000 val: 0.689552 test: 0.720257
max validation accuracy : 0.719403 max acc epoch : 23 test accuracy : 0.718279
Counter({0: 3510, 2: 2426, 1: 1464})

Epoch :  36 loss training:  7.140237858518958 Time :  9165
accuracy train: 1.000000 val: 0.707463 test: 0.720010
max validation accuracy : 0.719403 max acc epoch : 23 test accuracy : 0.718279
Counter({1: 3512, 0: 2422, 2: 1466})

Epoch :  37 loss training:  6.441893517971039 Time :  9194
accuracy train: 0.999669 val: 0.710448 test: 0.722978
max validation accuracy : 0.719403 max acc epoch : 23 test accuracy : 0.718279
Counter({2: 3515, 1: 2418, 0: 1467})

Epoch :  38 loss training:  6.989087988622487 Time :  9220
accuracy train: 1.000000 val: 0.695522 test: 0.719515
max validation accuracy : 0.719403 max acc epoch : 23 test accuracy : 0.718279
Counter({2: 3526, 0: 2418, 1: 1456})

slurmstepd: error: *** JOB 36754 ON cl-gpusrv1 CANCELLED AT 2021-06-08T21:25:41 ***
