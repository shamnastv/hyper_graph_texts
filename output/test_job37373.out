

date and time :  Mon Jun 14 16:10:59 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=921, tsne=False, weight_decay=0)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  39.84578567557037 Time :  114
accuracy train: 0.949101 val: 0.956364 test: 0.960731
max validation accuracy : 0.956364 max acc epoch : 1 test accuracy : 0.960731
Counter({1: 4189, 0: 3502})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.86615497339517 Time :  164
accuracy train: 0.959604 val: 0.947273 test: 0.961187
max validation accuracy : 0.956364 max acc epoch : 1 test accuracy : 0.960731
Counter({1: 4137, 0: 3554})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.19743468426168 Time :  211
accuracy train: 0.965865 val: 0.949091 test: 0.960731
max validation accuracy : 0.956364 max acc epoch : 1 test accuracy : 0.960731
Counter({1: 4061, 0: 3630})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.547736496198922 Time :  253
accuracy train: 0.983034 val: 0.965455 test: 0.966210
max validation accuracy : 0.965455 max acc epoch : 4 test accuracy : 0.966210
Counter({1: 3986, 0: 3705})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.329743705224246 Time :  310
accuracy train: 0.984852 val: 0.969091 test: 0.967580
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.967580
Counter({1: 3978, 0: 3713})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.597443249542266 Time :  364
accuracy train: 0.986265 val: 0.967273 test: 0.965753
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.967580
Counter({1: 3919, 0: 3772})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.979723715689033 Time :  427
accuracy train: 0.984650 val: 0.969091 test: 0.970776
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.967580
Counter({1: 3924, 0: 3767})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.27121537248604 Time :  468
accuracy train: 0.991719 val: 0.961818 test: 0.968037
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.967580
Counter({0: 3910, 1: 3781})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.1475686359917745 Time :  516
accuracy train: 0.990103 val: 0.965455 test: 0.964384
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.967580
Counter({1: 3907, 0: 3784})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.154202909965534 Time :  568
accuracy train: 0.992325 val: 0.967273 test: 0.968037
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.967580
Counter({1: 3905, 0: 3786})

Epoch :  11 loss training:  5.5596948865568265 Time :  617
accuracy train: 0.993133 val: 0.967273 test: 0.967580
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.967580
Counter({1: 3908, 0: 3783})

Epoch :  12 loss training:  5.132773917517625 Time :  651
accuracy train: 0.994143 val: 0.970909 test: 0.971233
max validation accuracy : 0.970909 max acc epoch : 12 test accuracy : 0.971233
Counter({1: 3905, 0: 3786})

Epoch :  13 loss training:  4.799831056036055 Time :  712
accuracy train: 0.995152 val: 0.969091 test: 0.972603
max validation accuracy : 0.970909 max acc epoch : 12 test accuracy : 0.971233
Counter({1: 3899, 0: 3792})

Epoch :  14 loss training:  4.629195997200441 Time :  758
accuracy train: 0.994951 val: 0.969091 test: 0.971233
max validation accuracy : 0.970909 max acc epoch : 12 test accuracy : 0.971233
Counter({0: 3897, 1: 3794})

Epoch :  15 loss training:  4.36789528967347 Time :  803
accuracy train: 0.995152 val: 0.972727 test: 0.970320
max validation accuracy : 0.972727 max acc epoch : 15 test accuracy : 0.970320
Counter({1: 3891, 0: 3800})

Epoch :  16 loss training:  4.715930383594241 Time :  840
accuracy train: 0.995556 val: 0.969091 test: 0.968950
max validation accuracy : 0.972727 max acc epoch : 15 test accuracy : 0.970320
Counter({1: 3881, 0: 3810})

Epoch :  17 loss training:  3.9346559930127114 Time :  899
accuracy train: 0.995354 val: 0.969091 test: 0.971233
max validation accuracy : 0.972727 max acc epoch : 15 test accuracy : 0.970320
Counter({1: 3880, 0: 3811})

Epoch :  18 loss training:  4.08714955454343 Time :  958
accuracy train: 0.996364 val: 0.969091 test: 0.972146
max validation accuracy : 0.972727 max acc epoch : 15 test accuracy : 0.970320
Counter({1: 3872, 0: 3819})

Epoch :  19 loss training:  3.2946600907016546 Time :  996
accuracy train: 0.995960 val: 0.969091 test: 0.973059
max validation accuracy : 0.972727 max acc epoch : 15 test accuracy : 0.970320
Counter({1: 3867, 0: 3824})

Epoch :  20 loss training:  2.950739210267784 Time :  1037
accuracy train: 0.996364 val: 0.972727 test: 0.974429
max validation accuracy : 0.972727 max acc epoch : 15 test accuracy : 0.970320
Counter({1: 3859, 0: 3832})

Epoch :  21 loss training:  2.9487558151595294 Time :  1087
accuracy train: 0.996364 val: 0.969091 test: 0.974886
max validation accuracy : 0.972727 max acc epoch : 15 test accuracy : 0.970320
Counter({0: 3857, 1: 3834})

Epoch :  22 loss training:  2.7662128480151296 Time :  1139
accuracy train: 0.996364 val: 0.967273 test: 0.969406
max validation accuracy : 0.972727 max acc epoch : 15 test accuracy : 0.970320
Counter({0: 3860, 1: 3831})

Epoch :  23 loss training:  2.9738532959891018 Time :  1180
accuracy train: 0.996566 val: 0.967273 test: 0.969406
max validation accuracy : 0.972727 max acc epoch : 15 test accuracy : 0.970320
Counter({0: 3860, 1: 3831})

Epoch :  24 loss training:  2.513263096479932 Time :  1226
accuracy train: 0.996768 val: 0.969091 test: 0.970776
max validation accuracy : 0.972727 max acc epoch : 15 test accuracy : 0.970320
Counter({0: 3871, 1: 3820})

Epoch :  25 loss training:  2.3072429914900567 Time :  1279
accuracy train: 0.995758 val: 0.970909 test: 0.975342
max validation accuracy : 0.972727 max acc epoch : 15 test accuracy : 0.970320
Counter({0: 3876, 1: 3815})

Epoch :  26 loss training:  2.528423834563 Time :  1325
accuracy train: 0.996768 val: 0.970909 test: 0.965297
max validation accuracy : 0.972727 max acc epoch : 15 test accuracy : 0.970320
Counter({0: 3875, 1: 3816})

========================================================================================================================================================================================================
best acc epoch :  15
validation accuracy :  0.9727272727272728
test accuracy :  0.9703196347031964
last test_accuracy :  0.965296803652968
second best val :  0.9709090909090909
second best test :  0.9712328767123287
max gap 7
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=526, tsne=False, weight_decay=0)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  38.63382012024522 Time :  1471
accuracy train: 0.965462 val: 0.947273 test: 0.954795
max validation accuracy : 0.947273 max acc epoch : 1 test accuracy : 0.954795
Counter({0: 4051, 1: 3640})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  16.670008492656052 Time :  1524
accuracy train: 0.968693 val: 0.927273 test: 0.955708
max validation accuracy : 0.947273 max acc epoch : 1 test accuracy : 0.954795
Counter({0: 3916, 1: 3775})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.850839965976775 Time :  1575
accuracy train: 0.980610 val: 0.956364 test: 0.967580
max validation accuracy : 0.956364 max acc epoch : 3 test accuracy : 0.967580
Counter({1: 3883, 0: 3808})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  9.573472826974466 Time :  1610
accuracy train: 0.982226 val: 0.945455 test: 0.971689
max validation accuracy : 0.956364 max acc epoch : 3 test accuracy : 0.967580
Counter({0: 3871, 1: 3820})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.664384614210576 Time :  1656
accuracy train: 0.989699 val: 0.950909 test: 0.966667
max validation accuracy : 0.956364 max acc epoch : 3 test accuracy : 0.967580
Counter({0: 3852, 1: 3839})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.215296165202744 Time :  1702
accuracy train: 0.984246 val: 0.947273 test: 0.967123
max validation accuracy : 0.956364 max acc epoch : 3 test accuracy : 0.967580
Counter({0: 3861, 1: 3830})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.193627433851361 Time :  1745
accuracy train: 0.992931 val: 0.947273 test: 0.968037
max validation accuracy : 0.956364 max acc epoch : 3 test accuracy : 0.967580
Counter({0: 3862, 1: 3829})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.844355448149145 Time :  1777
accuracy train: 0.992729 val: 0.947273 test: 0.972603
max validation accuracy : 0.956364 max acc epoch : 3 test accuracy : 0.967580
Counter({0: 3854, 1: 3837})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.364938123122556 Time :  1816
accuracy train: 0.992931 val: 0.943636 test: 0.970320
max validation accuracy : 0.956364 max acc epoch : 3 test accuracy : 0.967580
Counter({0: 3849, 1: 3842})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  4.900940882856958 Time :  1855
accuracy train: 0.994345 val: 0.950909 test: 0.969406
max validation accuracy : 0.956364 max acc epoch : 3 test accuracy : 0.967580
Counter({0: 3848, 1: 3843})

Epoch :  11 loss training:  5.095423626480624 Time :  1895
accuracy train: 0.992527 val: 0.949091 test: 0.973973
max validation accuracy : 0.956364 max acc epoch : 3 test accuracy : 0.967580
Counter({1: 3847, 0: 3844})

Epoch :  12 loss training:  4.384910772438161 Time :  1936
accuracy train: 0.994951 val: 0.949091 test: 0.966667
max validation accuracy : 0.956364 max acc epoch : 3 test accuracy : 0.967580
Counter({1: 3851, 0: 3840})

Epoch :  13 loss training:  4.092238935583737 Time :  1977
accuracy train: 0.995152 val: 0.945455 test: 0.971233
max validation accuracy : 0.956364 max acc epoch : 3 test accuracy : 0.967580
Counter({0: 3853, 1: 3838})

Epoch :  14 loss training:  3.5661121836164966 Time :  2019
accuracy train: 0.995354 val: 0.949091 test: 0.970776
max validation accuracy : 0.956364 max acc epoch : 3 test accuracy : 0.967580
Counter({1: 3858, 0: 3833})

========================================================================================================================================================================================================
best acc epoch :  3
validation accuracy :  0.9563636363636364
test accuracy :  0.9675799086757991
last test_accuracy :  0.9707762557077626
second best val :  0.9509090909090909
second best test :  0.9675799086757991
max gap 2
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=533, tsne=False, weight_decay=0)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  43.404044434428215 Time :  2130
accuracy train: 0.948293 val: 0.958182 test: 0.947489
max validation accuracy : 0.958182 max acc epoch : 1 test accuracy : 0.947489
Counter({0: 3945, 1: 3746})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.256186836748384 Time :  2173
accuracy train: 0.976166 val: 0.970909 test: 0.957991
max validation accuracy : 0.970909 max acc epoch : 2 test accuracy : 0.957991
Counter({0: 3945, 1: 3746})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.643634154461324 Time :  2213
accuracy train: 0.974349 val: 0.980000 test: 0.967580
max validation accuracy : 0.980000 max acc epoch : 3 test accuracy : 0.967580
Counter({0: 3977, 1: 3714})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.250555298523977 Time :  2260
accuracy train: 0.985457 val: 0.985455 test: 0.968037
max validation accuracy : 0.985455 max acc epoch : 4 test accuracy : 0.968037
Counter({0: 3862, 1: 3829})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.734176602214575 Time :  2298
accuracy train: 0.985457 val: 0.990909 test: 0.967123
max validation accuracy : 0.990909 max acc epoch : 5 test accuracy : 0.967123
Counter({0: 3852, 1: 3839})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  7.985423390986398 Time :  2335
accuracy train: 0.986669 val: 0.989091 test: 0.962557
max validation accuracy : 0.990909 max acc epoch : 5 test accuracy : 0.967123
Counter({0: 3852, 1: 3839})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.805207457393408 Time :  2377
accuracy train: 0.988891 val: 0.989091 test: 0.973059
max validation accuracy : 0.990909 max acc epoch : 5 test accuracy : 0.967123
Counter({1: 3850, 0: 3841})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.508546576282242 Time :  2413
accuracy train: 0.989295 val: 0.989091 test: 0.969863
max validation accuracy : 0.990909 max acc epoch : 5 test accuracy : 0.967123
Counter({1: 3852, 0: 3839})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.628465263405815 Time :  2443
accuracy train: 0.989699 val: 0.989091 test: 0.970320
max validation accuracy : 0.990909 max acc epoch : 5 test accuracy : 0.967123
Counter({1: 3856, 0: 3835})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  6.214986716979183 Time :  2483
accuracy train: 0.992325 val: 0.989091 test: 0.968493
max validation accuracy : 0.990909 max acc epoch : 5 test accuracy : 0.967123
Counter({1: 3864, 0: 3827})

Epoch :  11 loss training:  4.899869252927601 Time :  2524
accuracy train: 0.990305 val: 0.987273 test: 0.968037
max validation accuracy : 0.990909 max acc epoch : 5 test accuracy : 0.967123
Counter({0: 3864, 1: 3827})

Epoch :  12 loss training:  4.7748472050298005 Time :  2570
accuracy train: 0.993335 val: 0.985455 test: 0.968037
max validation accuracy : 0.990909 max acc epoch : 5 test accuracy : 0.967123
Counter({1: 3871, 0: 3820})

Epoch :  13 loss training:  5.329911386943422 Time :  2604
accuracy train: 0.993941 val: 0.992727 test: 0.970776
max validation accuracy : 0.992727 max acc epoch : 13 test accuracy : 0.970776
Counter({1: 3878, 0: 3813})

Epoch :  14 loss training:  4.702935905195773 Time :  2643
accuracy train: 0.993941 val: 0.985455 test: 0.967123
max validation accuracy : 0.992727 max acc epoch : 13 test accuracy : 0.970776
Counter({0: 3899, 1: 3792})

Epoch :  15 loss training:  3.6463731760159135 Time :  2682
accuracy train: 0.994345 val: 0.990909 test: 0.968950
max validation accuracy : 0.992727 max acc epoch : 13 test accuracy : 0.970776
Counter({1: 3900, 0: 3791})

Epoch :  16 loss training:  3.685580749064684 Time :  2722
accuracy train: 0.994547 val: 0.987273 test: 0.965297
max validation accuracy : 0.992727 max acc epoch : 13 test accuracy : 0.970776
Counter({1: 3907, 0: 3784})

Epoch :  17 loss training:  3.4626284702681005 Time :  2759
accuracy train: 0.994547 val: 0.990909 test: 0.969863
max validation accuracy : 0.992727 max acc epoch : 13 test accuracy : 0.970776
Counter({1: 3911, 0: 3780})

Epoch :  18 loss training:  3.1746102449833415 Time :  2792
accuracy train: 0.994345 val: 0.980000 test: 0.968037
max validation accuracy : 0.992727 max acc epoch : 13 test accuracy : 0.970776
Counter({1: 3918, 0: 3773})

Epoch :  19 loss training:  3.102520780696068 Time :  2832
accuracy train: 0.994547 val: 0.987273 test: 0.969863
max validation accuracy : 0.992727 max acc epoch : 13 test accuracy : 0.970776
Counter({1: 3919, 0: 3772})

Epoch :  20 loss training:  3.1625506613054313 Time :  2867
accuracy train: 0.995152 val: 0.985455 test: 0.973973
max validation accuracy : 0.992727 max acc epoch : 13 test accuracy : 0.970776
Counter({1: 3920, 0: 3771})

Epoch :  21 loss training:  2.849840430484619 Time :  2903
accuracy train: 0.994951 val: 0.987273 test: 0.969863
max validation accuracy : 0.992727 max acc epoch : 13 test accuracy : 0.970776
Counter({0: 3927, 1: 3764})

Epoch :  22 loss training:  2.60858432285022 Time :  2944
accuracy train: 0.995556 val: 0.989091 test: 0.971689
max validation accuracy : 0.992727 max acc epoch : 13 test accuracy : 0.970776
Counter({1: 3925, 0: 3766})

Epoch :  23 loss training:  2.7076372143346816 Time :  2984
accuracy train: 0.995556 val: 0.989091 test: 0.971233
max validation accuracy : 0.992727 max acc epoch : 13 test accuracy : 0.970776
Counter({1: 3925, 0: 3766})

Epoch :  24 loss training:  2.7277897899621166 Time :  3021
accuracy train: 0.995960 val: 0.987273 test: 0.971689
max validation accuracy : 0.992727 max acc epoch : 13 test accuracy : 0.970776
Counter({1: 3925, 0: 3766})

========================================================================================================================================================================================================
best acc epoch :  13
validation accuracy :  0.9927272727272727
test accuracy :  0.9707762557077626
last test_accuracy :  0.971689497716895
second best val :  0.990909090909091
second best test :  0.9671232876712329
max gap 8
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=500, tsne=False, weight_decay=0)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  40.235140446573496 Time :  3124
accuracy train: 0.957180 val: 0.949091 test: 0.960274
max validation accuracy : 0.949091 max acc epoch : 1 test accuracy : 0.960274
Counter({0: 4041, 1: 3650})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.074210530146956 Time :  3164
accuracy train: 0.973541 val: 0.963636 test: 0.953881
max validation accuracy : 0.963636 max acc epoch : 2 test accuracy : 0.953881
Counter({1: 3916, 0: 3775})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.45603039022535 Time :  3204
accuracy train: 0.975964 val: 0.967273 test: 0.968037
max validation accuracy : 0.967273 max acc epoch : 3 test accuracy : 0.968037
Counter({1: 3949, 0: 3742})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.203613283345476 Time :  3240
accuracy train: 0.973945 val: 0.947273 test: 0.967123
max validation accuracy : 0.967273 max acc epoch : 3 test accuracy : 0.968037
Counter({1: 3978, 0: 3713})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.256461201235652 Time :  3271
accuracy train: 0.988083 val: 0.969091 test: 0.960731
max validation accuracy : 0.969091 max acc epoch : 5 test accuracy : 0.960731
Counter({0: 3951, 1: 3740})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.67158656544052 Time :  3310
accuracy train: 0.988487 val: 0.972727 test: 0.972146
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.972146
Counter({0: 3938, 1: 3753})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.106496959924698 Time :  3349
accuracy train: 0.989497 val: 0.970909 test: 0.973059
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.972146
Counter({0: 3937, 1: 3754})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.938522128737532 Time :  3383
accuracy train: 0.991719 val: 0.969091 test: 0.967580
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.972146
Counter({0: 3933, 1: 3758})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.567591041675769 Time :  3414
accuracy train: 0.990103 val: 0.969091 test: 0.969863
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.972146
Counter({0: 3932, 1: 3759})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.866028463002294 Time :  3452
accuracy train: 0.991315 val: 0.972727 test: 0.973516
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.972146
Counter({0: 3927, 1: 3764})

Epoch :  11 loss training:  5.638254804769531 Time :  3494
accuracy train: 0.993941 val: 0.970909 test: 0.968950
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.972146
Counter({0: 3923, 1: 3768})

Epoch :  12 loss training:  5.080903237103485 Time :  3539
accuracy train: 0.994547 val: 0.972727 test: 0.970776
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.972146
Counter({0: 3918, 1: 3773})

Epoch :  13 loss training:  4.583204793161713 Time :  3576
accuracy train: 0.993941 val: 0.970909 test: 0.969406
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.972146
Counter({1: 3912, 0: 3779})

Epoch :  14 loss training:  4.668780420033727 Time :  3620
accuracy train: 0.995556 val: 0.974545 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.971689
Counter({0: 3901, 1: 3790})

Epoch :  15 loss training:  3.9451853524078615 Time :  3674
accuracy train: 0.994345 val: 0.972727 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.971689
Counter({0: 3891, 1: 3800})

Epoch :  16 loss training:  3.511327415704727 Time :  3717
accuracy train: 0.995152 val: 0.972727 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.971689
Counter({0: 3860, 1: 3831})

Epoch :  17 loss training:  3.7261888075154275 Time :  3761
accuracy train: 0.995758 val: 0.970909 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.971689
Counter({0: 3856, 1: 3835})

Epoch :  18 loss training:  3.1854657173971646 Time :  3796
accuracy train: 0.995152 val: 0.972727 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 14 test accuracy : 0.971689
Counter({1: 3852, 0: 3839})

Epoch :  19 loss training:  3.078533314874221 Time :  3837
accuracy train: 0.995960 val: 0.976364 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 19 test accuracy : 0.972146
Counter({1: 3850, 0: 3841})

Epoch :  20 loss training:  2.828774683177471 Time :  3879
accuracy train: 0.995556 val: 0.969091 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 19 test accuracy : 0.972146
Counter({1: 3846, 0: 3845})

Epoch :  21 loss training:  2.9458620568038896 Time :  3920
accuracy train: 0.995960 val: 0.972727 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 19 test accuracy : 0.972146
Counter({1: 3849, 0: 3842})

Epoch :  22 loss training:  2.683529837813694 Time :  3955
accuracy train: 0.996162 val: 0.974545 test: 0.973516
max validation accuracy : 0.976364 max acc epoch : 19 test accuracy : 0.972146
Counter({1: 3850, 0: 3841})

Epoch :  23 loss training:  2.4955822124611586 Time :  3998
accuracy train: 0.995556 val: 0.972727 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 19 test accuracy : 0.972146
Counter({0: 3853, 1: 3838})

Epoch :  24 loss training:  2.828299161483301 Time :  4043
accuracy train: 0.995758 val: 0.969091 test: 0.973516
max validation accuracy : 0.976364 max acc epoch : 19 test accuracy : 0.972146
Counter({1: 3854, 0: 3837})

Epoch :  25 loss training:  2.7886698326910846 Time :  4081
accuracy train: 0.995758 val: 0.972727 test: 0.976712
max validation accuracy : 0.976364 max acc epoch : 19 test accuracy : 0.972146
Counter({1: 3857, 0: 3834})

Epoch :  26 loss training:  2.211744718661066 Time :  4117
accuracy train: 0.995758 val: 0.969091 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 19 test accuracy : 0.972146
Counter({1: 3859, 0: 3832})

Epoch :  27 loss training:  2.098315515584545 Time :  4162
accuracy train: 0.995960 val: 0.967273 test: 0.973973
max validation accuracy : 0.976364 max acc epoch : 19 test accuracy : 0.972146
Counter({1: 3860, 0: 3831})

Epoch :  28 loss training:  2.339946891850559 Time :  4199
accuracy train: 0.996364 val: 0.969091 test: 0.974886
max validation accuracy : 0.976364 max acc epoch : 19 test accuracy : 0.972146
Counter({0: 3865, 1: 3826})

Epoch :  29 loss training:  2.03208856243873 Time :  4240
accuracy train: 0.996566 val: 0.969091 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 19 test accuracy : 0.972146
Counter({1: 3865, 0: 3826})

Epoch :  30 loss training:  1.8444081968336832 Time :  4285
accuracy train: 0.996364 val: 0.969091 test: 0.973973
max validation accuracy : 0.976364 max acc epoch : 19 test accuracy : 0.972146
Counter({0: 3866, 1: 3825})

========================================================================================================================================================================================================
best acc epoch :  19
validation accuracy :  0.9763636363636363
test accuracy :  0.9721461187214612
last test_accuracy :  0.9739726027397261
second best val :  0.9745454545454545
second best test :  0.971689497716895
max gap 8
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=816, tsne=False, weight_decay=0)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  40.56242457404733 Time :  4418
accuracy train: 0.955565 val: 0.947273 test: 0.955251
max validation accuracy : 0.947273 max acc epoch : 1 test accuracy : 0.955251
Counter({1: 4089, 0: 3602})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.06034006178379 Time :  4473
accuracy train: 0.966875 val: 0.958182 test: 0.962100
max validation accuracy : 0.958182 max acc epoch : 2 test accuracy : 0.962100
Counter({1: 3933, 0: 3758})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.541360541246831 Time :  4506
accuracy train: 0.976166 val: 0.963636 test: 0.967123
max validation accuracy : 0.963636 max acc epoch : 3 test accuracy : 0.967123
Counter({0: 3893, 1: 3798})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.122386693488806 Time :  4546
accuracy train: 0.987477 val: 0.970909 test: 0.968950
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.968950
Counter({1: 3862, 0: 3829})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.161857654107735 Time :  4589
accuracy train: 0.984044 val: 0.967273 test: 0.972603
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.968950
Counter({0: 3860, 1: 3831})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.759859778452665 Time :  4632
accuracy train: 0.988689 val: 0.970909 test: 0.964840
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.968950
Counter({0: 3853, 1: 3838})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.00477227428928 Time :  4674
accuracy train: 0.989699 val: 0.974545 test: 0.967123
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.967123
Counter({0: 3848, 1: 3843})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.453612627694383 Time :  4709
accuracy train: 0.988487 val: 0.972727 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.967123
Counter({0: 3865, 1: 3826})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.896924052620307 Time :  4751
accuracy train: 0.989901 val: 0.970909 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.967123
Counter({0: 3870, 1: 3821})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.583142368472181 Time :  4797
accuracy train: 0.992123 val: 0.970909 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.967123
Counter({1: 3872, 0: 3819})

Epoch :  11 loss training:  4.717001119279303 Time :  4837
accuracy train: 0.991517 val: 0.970909 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.967123
Counter({0: 3877, 1: 3814})

Epoch :  12 loss training:  4.684524086071178 Time :  4879
accuracy train: 0.993941 val: 0.972727 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.967123
Counter({1: 3883, 0: 3808})

Epoch :  13 loss training:  4.821064146235585 Time :  4920
accuracy train: 0.993739 val: 0.969091 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.967123
Counter({1: 3883, 0: 3808})

Epoch :  14 loss training:  4.288032380216464 Time :  4964
accuracy train: 0.993941 val: 0.969091 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.967123
Counter({0: 3892, 1: 3799})

Epoch :  15 loss training:  3.9106597130885348 Time :  5001
accuracy train: 0.994749 val: 0.974545 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.967123
Counter({0: 3896, 1: 3795})

Epoch :  16 loss training:  3.9219785106251948 Time :  5043
accuracy train: 0.994749 val: 0.974545 test: 0.966210
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.967123
Counter({0: 3901, 1: 3790})

Epoch :  17 loss training:  3.8202258719829842 Time :  5071
accuracy train: 0.995152 val: 0.972727 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.967123
Counter({0: 3902, 1: 3789})

Epoch :  18 loss training:  3.1375240295019466 Time :  5108
accuracy train: 0.994951 val: 0.970909 test: 0.967123
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.967123
Counter({1: 3913, 0: 3778})

========================================================================================================================================================================================================
best acc epoch :  7
validation accuracy :  0.9745454545454545
test accuracy :  0.9671232876712329
last test_accuracy :  0.9671232876712329
second best val :  0.9727272727272728
second best test :  0.9671232876712329
max gap 3
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=238, tsne=False, weight_decay=0)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  41.0115790264681 Time :  5235
accuracy train: 0.953343 val: 0.941818 test: 0.950228
max validation accuracy : 0.941818 max acc epoch : 1 test accuracy : 0.950228
Counter({1: 4033, 0: 3658})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.909937118180096 Time :  5276
accuracy train: 0.962028 val: 0.956364 test: 0.962100
max validation accuracy : 0.956364 max acc epoch : 2 test accuracy : 0.962100
Counter({1: 3972, 0: 3719})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  13.740278859157115 Time :  5313
accuracy train: 0.966067 val: 0.954545 test: 0.960274
max validation accuracy : 0.956364 max acc epoch : 2 test accuracy : 0.962100
Counter({0: 3947, 1: 3744})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.162735015386716 Time :  5345
accuracy train: 0.984246 val: 0.970909 test: 0.968037
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.968037
Counter({1: 3899, 0: 3792})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.383310420904309 Time :  5375
accuracy train: 0.984044 val: 0.967273 test: 0.962100
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.968037
Counter({1: 3887, 0: 3804})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.091483678435907 Time :  5410
accuracy train: 0.985457 val: 0.970909 test: 0.968037
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.968037
Counter({1: 3891, 0: 3800})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.252275524195284 Time :  5443
accuracy train: 0.988083 val: 0.974545 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.968493
Counter({1: 3890, 0: 3801})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.896060426835902 Time :  5471
accuracy train: 0.989901 val: 0.976364 test: 0.966210
max validation accuracy : 0.976364 max acc epoch : 8 test accuracy : 0.966210
Counter({1: 3878, 0: 3813})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.86383621575078 Time :  5500
accuracy train: 0.992729 val: 0.969091 test: 0.967580
max validation accuracy : 0.976364 max acc epoch : 8 test accuracy : 0.966210
Counter({1: 3879, 0: 3812})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.093532518250868 Time :  5525
accuracy train: 0.992729 val: 0.976364 test: 0.966210
max validation accuracy : 0.976364 max acc epoch : 8 test accuracy : 0.966210
Counter({1: 3867, 0: 3824})

Epoch :  11 loss training:  4.843433819245547 Time :  5558
accuracy train: 0.993335 val: 0.970909 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 8 test accuracy : 0.966210
Counter({1: 3868, 0: 3823})

Epoch :  12 loss training:  4.195016696117818 Time :  5588
accuracy train: 0.994547 val: 0.972727 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 8 test accuracy : 0.966210
Counter({1: 3865, 0: 3826})

Epoch :  13 loss training:  4.66351904894691 Time :  5622
accuracy train: 0.994345 val: 0.974545 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 8 test accuracy : 0.966210
Counter({0: 3864, 1: 3827})

Epoch :  14 loss training:  4.474734150455333 Time :  5649
accuracy train: 0.994749 val: 0.969091 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 8 test accuracy : 0.966210
Counter({1: 3858, 0: 3833})

Epoch :  15 loss training:  3.999418602674268 Time :  5681
accuracy train: 0.994547 val: 0.974545 test: 0.968493
max validation accuracy : 0.976364 max acc epoch : 8 test accuracy : 0.966210
Counter({0: 3849, 1: 3842})

Epoch :  16 loss training:  3.825207009620499 Time :  5714
accuracy train: 0.995152 val: 0.976364 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 8 test accuracy : 0.966210
Counter({0: 3854, 1: 3837})

Epoch :  17 loss training:  3.1773624279303476 Time :  5749
accuracy train: 0.996364 val: 0.974545 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 8 test accuracy : 0.966210
Counter({0: 3859, 1: 3832})

Epoch :  18 loss training:  3.3556488507892936 Time :  5778
accuracy train: 0.996162 val: 0.969091 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 8 test accuracy : 0.966210
Counter({0: 3865, 1: 3826})

Epoch :  19 loss training:  2.884991338243708 Time :  5807
accuracy train: 0.996162 val: 0.970909 test: 0.973973
max validation accuracy : 0.976364 max acc epoch : 8 test accuracy : 0.966210
Counter({0: 3864, 1: 3827})

========================================================================================================================================================================================================
best acc epoch :  8
validation accuracy :  0.9763636363636363
test accuracy :  0.9662100456621004
last test_accuracy :  0.9739726027397261
second best val :  0.9745454545454545
second best test :  0.9684931506849315
max gap 3
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  15 	 val_accuracy : 0.97273 	 test_accuracy : 0.97032 	 last test_accuracy : 0.96530 	 second best val : 0.97091 	 second best test : 0.97123
k :  1 	 best_acc epoch :  3 	 val_accuracy : 0.95636 	 test_accuracy : 0.96758 	 last test_accuracy : 0.97078 	 second best val : 0.95091 	 second best test : 0.96758
k :  2 	 best_acc epoch :  13 	 val_accuracy : 0.99273 	 test_accuracy : 0.97078 	 last test_accuracy : 0.97169 	 second best val : 0.99091 	 second best test : 0.96712
k :  3 	 best_acc epoch :  19 	 val_accuracy : 0.97636 	 test_accuracy : 0.97215 	 last test_accuracy : 0.97397 	 second best val : 0.97455 	 second best test : 0.97169
k :  4 	 best_acc epoch :  7 	 val_accuracy : 0.97455 	 test_accuracy : 0.96712 	 last test_accuracy : 0.96712 	 second best val : 0.97273 	 second best test : 0.96712
k :  5 	 best_acc epoch :  8 	 val_accuracy : 0.97636 	 test_accuracy : 0.96621 	 last test_accuracy : 0.97397 	 second best val : 0.97455 	 second best test : 0.96849

avg :  	 val_accuracy : 0.97485 	 test_accuracy : 0.96903 	 last_accuracy : 0.97047 	 second best val : 0.97242 	 second best test : 0.96887

std :  	 val_accuracy : 0.01057 	 test_accuracy : 0.00216 	 last_accuracy : 0.00327 	 second best val : 0.01166 	 second best test : 0.00189
