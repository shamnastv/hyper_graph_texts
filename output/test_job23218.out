date and time :  Tue Jan 26 17:25:52 2021
Namespace(batch_size=16, dataset='R52', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.0005, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=1e-05)
device :  cuda:0
HGNNModel(
  (word_embeddings): Embedding(9333, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=200, out_features=200, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=200, out_features=200, bias=True)
        (W_hr): Linear(in_features=200, out_features=200, bias=True)
        (W_in): Linear(in_features=200, out_features=200, bias=True)
        (W_hn): Linear(in_features=200, out_features=200, bias=True)
        (W_iz): Linear(in_features=200, out_features=200, bias=True)
        (W_hz): Linear(in_features=200, out_features=200, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=52, bias=True)
    (1): Linear(in_features=200, out_features=52, bias=True)
    (2): Linear(in_features=200, out_features=52, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=200, out_features=200, bias=False)
        (1): Linear(in_features=200, out_features=1, bias=False)
      )
    )
  )
)
Epoch :  1 loss training:  299.3664902076125 Time :  13
accuracy train: 0.925474 val: 0.902439 test: 0.898444
max validation accuracy : 0.902439 max acc epoch : 1.000000 test accuracy : 0.898444

Epoch :  2 loss training:  112.26165024889633 Time :  24
accuracy train: 0.945630 val: 0.920732 test: 0.922179
max validation accuracy : 0.920732 max acc epoch : 2.000000 test accuracy : 0.922179

Epoch :  3 loss training:  79.60453448013868 Time :  34
accuracy train: 0.975440 val: 0.935976 test: 0.925681
max validation accuracy : 0.935976 max acc epoch : 3.000000 test accuracy : 0.925681

Epoch :  4 loss training:  59.566994671477005 Time :  46
accuracy train: 0.979167 val: 0.940549 test: 0.932685
max validation accuracy : 0.940549 max acc epoch : 4.000000 test accuracy : 0.932685

Epoch :  5 loss training:  47.633083265740424 Time :  56
accuracy train: 0.985942 val: 0.940549 test: 0.935019
max validation accuracy : 0.940549 max acc epoch : 4.000000 test accuracy : 0.932685

Epoch :  6 loss training:  30.877036941004917 Time :  66
accuracy train: 0.989499 val: 0.946646 test: 0.936187
max validation accuracy : 0.946646 max acc epoch : 6.000000 test accuracy : 0.936187

Epoch :  7 loss training:  25.415187062462792 Time :  75
accuracy train: 0.991531 val: 0.942073 test: 0.936576
max validation accuracy : 0.946646 max acc epoch : 6.000000 test accuracy : 0.936187

Epoch :  8 loss training:  23.47259400493931 Time :  84
accuracy train: 0.992547 val: 0.942073 test: 0.938132
max validation accuracy : 0.946646 max acc epoch : 6.000000 test accuracy : 0.936187

Epoch :  9 loss training:  20.12813629664015 Time :  94
accuracy train: 0.994919 val: 0.945122 test: 0.932685
max validation accuracy : 0.946646 max acc epoch : 6.000000 test accuracy : 0.936187

Epoch :  10 loss training:  17.814768293115776 Time :  105
accuracy train: 0.995257 val: 0.935976 test: 0.934630
max validation accuracy : 0.946646 max acc epoch : 6.000000 test accuracy : 0.936187

Epoch :  11 loss training:  14.954199189713108 Time :  115
accuracy train: 0.996104 val: 0.945122 test: 0.936576
max validation accuracy : 0.946646 max acc epoch : 6.000000 test accuracy : 0.936187

Epoch :  12 loss training:  12.199287079914939 Time :  125
accuracy train: 0.997629 val: 0.943598 test: 0.937354
max validation accuracy : 0.946646 max acc epoch : 6.000000 test accuracy : 0.936187

Epoch :  13 loss training:  10.666316694550915 Time :  135
accuracy train: 0.997459 val: 0.951220 test: 0.935409
max validation accuracy : 0.951220 max acc epoch : 13.000000 test accuracy : 0.935409

Epoch :  14 loss training:  10.24515337482444 Time :  144
accuracy train: 0.997121 val: 0.937500 test: 0.936965
max validation accuracy : 0.951220 max acc epoch : 13.000000 test accuracy : 0.935409

Epoch :  15 loss training:  9.17270795605782 Time :  154
accuracy train: 0.997629 val: 0.935976 test: 0.931128
max validation accuracy : 0.951220 max acc epoch : 13.000000 test accuracy : 0.935409

Epoch :  16 loss training:  8.361383528310398 Time :  163
accuracy train: 0.997967 val: 0.939024 test: 0.935798
max validation accuracy : 0.951220 max acc epoch : 13.000000 test accuracy : 0.935409

Epoch :  17 loss training:  7.360090314672561 Time :  173
accuracy train: 0.998137 val: 0.939024 test: 0.938521
max validation accuracy : 0.951220 max acc epoch : 13.000000 test accuracy : 0.935409

Epoch :  18 loss training:  6.674960093130721 Time :  182
accuracy train: 0.997967 val: 0.939024 test: 0.937743
max validation accuracy : 0.951220 max acc epoch : 13.000000 test accuracy : 0.935409

Epoch :  19 loss training:  7.090671872487292 Time :  193
accuracy train: 0.997629 val: 0.942073 test: 0.941245
max validation accuracy : 0.951220 max acc epoch : 13.000000 test accuracy : 0.935409

Epoch :  20 loss training:  6.850231856013124 Time :  203
accuracy train: 0.997798 val: 0.942073 test: 0.936965
max validation accuracy : 0.951220 max acc epoch : 13.000000 test accuracy : 0.935409

Epoch :  21 loss training:  5.882502726162784 Time :  214
accuracy train: 0.997798 val: 0.940549 test: 0.939689
max validation accuracy : 0.951220 max acc epoch : 13.000000 test accuracy : 0.935409

Epoch :  22 loss training:  5.81424753579995 Time :  223
accuracy train: 0.997798 val: 0.942073 test: 0.939300
max validation accuracy : 0.951220 max acc epoch : 13.000000 test accuracy : 0.935409

Epoch :  23 loss training:  6.199610515177483 Time :  232
accuracy train: 0.997798 val: 0.942073 test: 0.940467
max validation accuracy : 0.951220 max acc epoch : 13.000000 test accuracy : 0.935409

Epoch :  24 loss training:  5.391041314593167 Time :  242
accuracy train: 0.997798 val: 0.942073 test: 0.939300
max validation accuracy : 0.951220 max acc epoch : 13.000000 test accuracy : 0.935409

Epoch :  25 loss training:  5.617072811783146 Time :  252
accuracy train: 0.997967 val: 0.940549 test: 0.941245
max validation accuracy : 0.951220 max acc epoch : 13.000000 test accuracy : 0.935409

Epoch :  26 loss training:  5.182880804546585 Time :  262
accuracy train: 0.997798 val: 0.942073 test: 0.940856
max validation accuracy : 0.951220 max acc epoch : 13.000000 test accuracy : 0.935409

Epoch :  27 loss training:  4.736521663398889 Time :  272
accuracy train: 0.997798 val: 0.943598 test: 0.940856
max validation accuracy : 0.951220 max acc epoch : 13.000000 test accuracy : 0.935409

Epoch :  28 loss training:  4.684253437559164 Time :  281
accuracy train: 0.997967 val: 0.940549 test: 0.938911
max validation accuracy : 0.951220 max acc epoch : 13.000000 test accuracy : 0.935409

Epoch :  29 loss training:  4.747001372925297 Time :  361
accuracy train: 0.997967 val: 0.945122 test: 0.940467
max validation accuracy : 0.951220 max acc epoch : 13.000000 test accuracy : 0.935409

Epoch :  30 loss training:  3.832635008780926 Time :  971
accuracy train: 0.998306 val: 0.940549 test: 0.940467
max validation accuracy : 0.951220 max acc epoch : 13.000000 test accuracy : 0.935409

Epoch :  31 loss training:  4.747920322348364 Time :  1554
accuracy train: 0.998137 val: 0.945122 test: 0.939689
max validation accuracy : 0.951220 max acc epoch : 13.000000 test accuracy : 0.935409

Epoch :  32 loss training:  4.833051609784889 Time :  1960
accuracy train: 0.997798 val: 0.942073 test: 0.937354
max validation accuracy : 0.951220 max acc epoch : 13.000000 test accuracy : 0.935409

Epoch :  33 loss training:  4.374471961011295 Time :  2352
accuracy train: 0.998306 val: 0.945122 test: 0.935409
max validation accuracy : 0.951220 max acc epoch : 13.000000 test accuracy : 0.935409

Epoch :  34 loss training:  4.216693225193012 Time :  2780
accuracy train: 0.998137 val: 0.948171 test: 0.938521
max validation accuracy : 0.951220 max acc epoch : 13.000000 test accuracy : 0.935409

========================================================================================================================================================================================================
max acc epoch :  13
max validation accuracy :  0.9512195121951219
test accuracy :  0.935408560311284
latest_test_accuracy :  0.9385214007782101
========================================================================================================================================================================================================

