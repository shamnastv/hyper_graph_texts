

date and time :  Sun Jun  6 19:49:19 2021
itr : 0
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=43, weight_decay=0)
device :  cuda:0
Counter({0: 5417, 2: 2504, 1: 1209})

Epoch :  1 loss training:  127.61025255918503 Time :  170
accuracy train: 0.900407 val: 0.882622 test: 0.885603
max validation accuracy : 0.882622 max acc epoch : 1 test accuracy : 0.885603
Counter({0: 3652, 2: 2773, 1: 2705})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.14683508872986 Time :  219
accuracy train: 0.937500 val: 0.916159 test: 0.915564
max validation accuracy : 0.916159 max acc epoch : 2 test accuracy : 0.915564
Counter({1: 3804, 2: 2771, 0: 2555})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  40.09147572517395 Time :  268
accuracy train: 0.953083 val: 0.917683 test: 0.919455
max validation accuracy : 0.917683 max acc epoch : 3 test accuracy : 0.919455
Counter({2: 3794, 0: 2840, 1: 2496})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  26.44362904317677 Time :  316
accuracy train: 0.968496 val: 0.935976 test: 0.938521
max validation accuracy : 0.935976 max acc epoch : 4 test accuracy : 0.938521
Counter({0: 3819, 2: 2846, 1: 2465})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  22.61619128845632 Time :  365
accuracy train: 0.974424 val: 0.935976 test: 0.935409
max validation accuracy : 0.935976 max acc epoch : 4 test accuracy : 0.938521
Counter({1: 3820, 2: 2839, 0: 2471})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  20.248366717249155 Time :  419
accuracy train: 0.976626 val: 0.940549 test: 0.942802
max validation accuracy : 0.940549 max acc epoch : 6 test accuracy : 0.942802
Counter({1: 3825, 0: 2856, 2: 2449})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  16.042671717936173 Time :  466
accuracy train: 0.979167 val: 0.945122 test: 0.943191
max validation accuracy : 0.945122 max acc epoch : 7 test accuracy : 0.943191
Counter({1: 3826, 0: 2869, 2: 2435})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  13.937781637068838 Time :  521
accuracy train: 0.984587 val: 0.939024 test: 0.946304
max validation accuracy : 0.945122 max acc epoch : 7 test accuracy : 0.943191
Counter({0: 3837, 1: 2862, 2: 2431})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  13.266426546033472 Time :  567
accuracy train: 0.983740 val: 0.943598 test: 0.949416
max validation accuracy : 0.945122 max acc epoch : 7 test accuracy : 0.943191
Counter({2: 3844, 0: 2870, 1: 2416})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  11.898925521411002 Time :  610
accuracy train: 0.988652 val: 0.945122 test: 0.947082
max validation accuracy : 0.945122 max acc epoch : 7 test accuracy : 0.943191
Counter({0: 3863, 1: 2866, 2: 2401})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  10.892360926605761 Time :  661
accuracy train: 0.990007 val: 0.951220 test: 0.948249
max validation accuracy : 0.951220 max acc epoch : 11 test accuracy : 0.948249
Counter({0: 3866, 1: 2865, 2: 2399})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  10.343268252909184 Time :  713
accuracy train: 0.989160 val: 0.940549 test: 0.948249
max validation accuracy : 0.951220 max acc epoch : 11 test accuracy : 0.948249
Counter({0: 3870, 1: 2867, 2: 2393})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  8.739456442184746 Time :  759
accuracy train: 0.990684 val: 0.948171 test: 0.949416
max validation accuracy : 0.951220 max acc epoch : 11 test accuracy : 0.948249
Counter({0: 3873, 2: 2872, 1: 2385})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  8.396546656033024 Time :  812
accuracy train: 0.992209 val: 0.951220 test: 0.952140
max validation accuracy : 0.951220 max acc epoch : 11 test accuracy : 0.948249
Counter({1: 3878, 2: 2868, 0: 2384})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  8.271971241105348 Time :  861
accuracy train: 0.991531 val: 0.949695 test: 0.951751
max validation accuracy : 0.951220 max acc epoch : 11 test accuracy : 0.948249
Counter({1: 3884, 0: 2870, 2: 2376})

Epoch :  16 loss training:  8.151628927094862 Time :  914
accuracy train: 0.991701 val: 0.949695 test: 0.951362
max validation accuracy : 0.951220 max acc epoch : 11 test accuracy : 0.948249
Counter({1: 3884, 0: 2869, 2: 2377})

Epoch :  17 loss training:  7.3719434682279825 Time :  965
accuracy train: 0.992209 val: 0.946646 test: 0.950584
max validation accuracy : 0.951220 max acc epoch : 11 test accuracy : 0.948249
Counter({2: 3883, 1: 2870, 0: 2377})

Epoch :  18 loss training:  7.419265841366723 Time :  1039
accuracy train: 0.992886 val: 0.957317 test: 0.951362
max validation accuracy : 0.957317 max acc epoch : 18 test accuracy : 0.951362
Counter({0: 3883, 2: 2870, 1: 2377})

Epoch :  19 loss training:  7.515546401962638 Time :  1101
accuracy train: 0.993733 val: 0.954268 test: 0.954864
max validation accuracy : 0.957317 max acc epoch : 18 test accuracy : 0.951362
Counter({1: 3885, 2: 2872, 0: 2373})

Epoch :  20 loss training:  6.785097619052976 Time :  1166
accuracy train: 0.993902 val: 0.952744 test: 0.951362
max validation accuracy : 0.957317 max acc epoch : 18 test accuracy : 0.951362
Counter({2: 3859, 0: 2873, 1: 2398})

Epoch :  21 loss training:  6.4526074978057295 Time :  1224
accuracy train: 0.993902 val: 0.954268 test: 0.951362
max validation accuracy : 0.957317 max acc epoch : 18 test accuracy : 0.951362
Counter({1: 3861, 0: 2876, 2: 2393})

Epoch :  22 loss training:  6.53391235251911 Time :  1280
accuracy train: 0.993394 val: 0.954268 test: 0.949416
max validation accuracy : 0.957317 max acc epoch : 18 test accuracy : 0.951362
Counter({1: 3871, 2: 2875, 0: 2384})

Epoch :  23 loss training:  6.4340423855464906 Time :  1344
accuracy train: 0.993902 val: 0.957317 test: 0.954475
max validation accuracy : 0.957317 max acc epoch : 18 test accuracy : 0.951362
Counter({0: 3871, 2: 2878, 1: 2381})

Epoch :  24 loss training:  5.995646758005023 Time :  1409
accuracy train: 0.994411 val: 0.952744 test: 0.953307
max validation accuracy : 0.957317 max acc epoch : 18 test accuracy : 0.951362
Counter({1: 3874, 2: 2877, 0: 2379})

Epoch :  25 loss training:  5.843711947323754 Time :  1467
accuracy train: 0.994919 val: 0.954268 test: 0.952529
max validation accuracy : 0.957317 max acc epoch : 18 test accuracy : 0.951362
Counter({1: 3877, 2: 2877, 0: 2376})

Epoch :  26 loss training:  5.6041586578357965 Time :  1523
accuracy train: 0.994072 val: 0.945122 test: 0.951751
max validation accuracy : 0.957317 max acc epoch : 18 test accuracy : 0.951362
Counter({1: 3880, 0: 2883, 2: 2367})

Epoch :  27 loss training:  5.482623675139621 Time :  1571
accuracy train: 0.995088 val: 0.954268 test: 0.950973
max validation accuracy : 0.957317 max acc epoch : 18 test accuracy : 0.951362
Counter({2: 3880, 0: 2883, 1: 2367})

Epoch :  28 loss training:  5.306867622537538 Time :  1626
accuracy train: 0.994749 val: 0.954268 test: 0.950973
max validation accuracy : 0.957317 max acc epoch : 18 test accuracy : 0.951362
Counter({1: 3884, 0: 2884, 2: 2362})

Epoch :  29 loss training:  5.3124617780558765 Time :  1676
accuracy train: 0.994919 val: 0.952744 test: 0.952140
max validation accuracy : 0.957317 max acc epoch : 18 test accuracy : 0.951362
Counter({1: 3910, 0: 2893, 2: 2327})

Epoch :  30 loss training:  5.35717042745091 Time :  1728
accuracy train: 0.995257 val: 0.955793 test: 0.953307
max validation accuracy : 0.957317 max acc epoch : 18 test accuracy : 0.951362
Counter({1: 3914, 0: 2893, 2: 2323})

Epoch :  31 loss training:  4.643062570132315 Time :  1778
accuracy train: 0.994749 val: 0.951220 test: 0.951362
max validation accuracy : 0.957317 max acc epoch : 18 test accuracy : 0.951362
Counter({1: 3914, 0: 2894, 2: 2322})

Epoch :  32 loss training:  4.984591929242015 Time :  1839
accuracy train: 0.995935 val: 0.952744 test: 0.952140
max validation accuracy : 0.957317 max acc epoch : 18 test accuracy : 0.951362
Counter({0: 3914, 1: 2884, 2: 2332})

Epoch :  33 loss training:  4.5775766496080905 Time :  1896
accuracy train: 0.995088 val: 0.954268 test: 0.953696
max validation accuracy : 0.957317 max acc epoch : 18 test accuracy : 0.951362
Counter({0: 3914, 2: 2886, 1: 2330})

Epoch :  34 loss training:  4.411074655945413 Time :  1954
accuracy train: 0.995935 val: 0.948171 test: 0.954086
max validation accuracy : 0.957317 max acc epoch : 18 test accuracy : 0.951362
Counter({1: 3916, 0: 2896, 2: 2318})

Epoch :  35 loss training:  4.437718338798732 Time :  2009
accuracy train: 0.995427 val: 0.954268 test: 0.949805
max validation accuracy : 0.957317 max acc epoch : 18 test accuracy : 0.951362
Counter({1: 3918, 0: 2894, 2: 2318})

Epoch :  36 loss training:  3.8322208538884297 Time :  2054
accuracy train: 0.996104 val: 0.958841 test: 0.952529
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({2: 3916, 0: 2898, 1: 2316})

Epoch :  37 loss training:  3.720099660451524 Time :  2105
accuracy train: 0.995427 val: 0.955793 test: 0.948638
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({1: 3923, 0: 2892, 2: 2315})

Epoch :  38 loss training:  4.014799050986767 Time :  2148
accuracy train: 0.996612 val: 0.951220 test: 0.952140
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({1: 3923, 0: 2892, 2: 2315})

Epoch :  39 loss training:  3.626046176534146 Time :  2197
accuracy train: 0.996782 val: 0.955793 test: 0.952918
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({0: 3922, 2: 2893, 1: 2315})

Epoch :  40 loss training:  3.6449464870383963 Time :  2250
accuracy train: 0.996274 val: 0.957317 test: 0.952529
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({2: 3922, 0: 2892, 1: 2316})

Epoch :  41 loss training:  3.3565883307601325 Time :  2308
accuracy train: 0.996274 val: 0.951220 test: 0.951362
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({0: 3914, 1: 2901, 2: 2315})

Epoch :  42 loss training:  3.662687730509788 Time :  2363
accuracy train: 0.996443 val: 0.952744 test: 0.950584
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({2: 3915, 1: 2899, 0: 2316})

Epoch :  43 loss training:  3.0977815059013665 Time :  2418
accuracy train: 0.996443 val: 0.955793 test: 0.950195
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({1: 3915, 2: 2898, 0: 2317})

Epoch :  44 loss training:  3.122188903274946 Time :  2473
accuracy train: 0.996443 val: 0.954268 test: 0.952529
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({1: 3915, 2: 2899, 0: 2316})

Epoch :  45 loss training:  3.2772872776258737 Time :  2525
accuracy train: 0.996443 val: 0.952744 test: 0.951751
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({1: 3915, 0: 2901, 2: 2314})

Epoch :  46 loss training:  3.423515043919906 Time :  2579
accuracy train: 0.996612 val: 0.957317 test: 0.952140
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({0: 3915, 1: 2902, 2: 2313})

Epoch :  47 loss training:  3.192848336067982 Time :  2633
accuracy train: 0.996782 val: 0.954268 test: 0.950973
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({0: 3916, 2: 2900, 1: 2314})

Epoch :  48 loss training:  2.840181451407261 Time :  2688
accuracy train: 0.996612 val: 0.955793 test: 0.952529
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({2: 3916, 0: 2901, 1: 2313})

Epoch :  49 loss training:  2.826111500384286 Time :  2743
accuracy train: 0.996443 val: 0.954268 test: 0.952918
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({0: 3915, 1: 2903, 2: 2312})

Epoch :  50 loss training:  3.031104789406527 Time :  2801
accuracy train: 0.997459 val: 0.952744 test: 0.950973
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({0: 3915, 2: 2904, 1: 2311})

Epoch :  51 loss training:  2.9732376422616653 Time :  2852
accuracy train: 0.997121 val: 0.954268 test: 0.952918
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({0: 3914, 1: 2904, 2: 2312})

Epoch :  52 loss training:  2.688849669037154 Time :  2908
accuracy train: 0.996612 val: 0.954268 test: 0.954475
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({2: 3914, 0: 2907, 1: 2309})

Epoch :  53 loss training:  2.532631441135891 Time :  2956
accuracy train: 0.997121 val: 0.949695 test: 0.954086
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({1: 3922, 0: 2902, 2: 2306})

Epoch :  54 loss training:  2.8136965042795055 Time :  3007
accuracy train: 0.996612 val: 0.954268 test: 0.952140
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({1: 3921, 2: 2903, 0: 2306})

Epoch :  55 loss training:  2.895505857595708 Time :  3058
accuracy train: 0.997290 val: 0.954268 test: 0.953696
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({1: 3912, 0: 2911, 2: 2307})

Epoch :  56 loss training:  2.748370713641634 Time :  3104
accuracy train: 0.996782 val: 0.954268 test: 0.951751
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({0: 3912, 2: 2911, 1: 2307})

Epoch :  57 loss training:  2.6020775292126928 Time :  3154
accuracy train: 0.997290 val: 0.952744 test: 0.950973
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({1: 3886, 2: 2911, 0: 2333})

Epoch :  58 loss training:  2.839404520462267 Time :  3201
accuracy train: 0.997121 val: 0.954268 test: 0.953696
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({0: 3912, 2: 2908, 1: 2310})

Epoch :  59 loss training:  2.5254285312839784 Time :  3249
accuracy train: 0.996782 val: 0.954268 test: 0.953696
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({1: 3921, 0: 2899, 2: 2310})

Epoch :  60 loss training:  2.442970975127537 Time :  3295
accuracy train: 0.996951 val: 0.952744 test: 0.952918
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({0: 3912, 2: 2908, 1: 2310})

Epoch :  61 loss training:  2.467441852990305 Time :  3344
accuracy train: 0.996782 val: 0.949695 test: 0.952529
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({1: 3913, 2: 2909, 0: 2308})

Epoch :  62 loss training:  2.4313222118653357 Time :  3393
accuracy train: 0.996612 val: 0.954268 test: 0.952140
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({1: 3913, 2: 2911, 0: 2306})

Epoch :  63 loss training:  2.8662931938888505 Time :  3440
accuracy train: 0.997121 val: 0.952744 test: 0.952529
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({1: 3912, 0: 2911, 2: 2307})

Epoch :  64 loss training:  2.4191833846562076 Time :  3489
accuracy train: 0.996612 val: 0.955793 test: 0.952918
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({1: 3912, 2: 2912, 0: 2306})

Epoch :  65 loss training:  2.286528461409034 Time :  3535
accuracy train: 0.996951 val: 0.954268 test: 0.950195
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({1: 3913, 0: 2910, 2: 2307})

Epoch :  66 loss training:  2.299456424487289 Time :  3582
accuracy train: 0.997121 val: 0.952744 test: 0.950584
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({0: 3913, 2: 2911, 1: 2306})

Epoch :  67 loss training:  2.344222614192404 Time :  3632
accuracy train: 0.996612 val: 0.955793 test: 0.952529
max validation accuracy : 0.958841 max acc epoch : 36 test accuracy : 0.952529
Counter({1: 3914, 0: 2912, 2: 2304})

========================================================================================================================================================================================================
max acc epoch :  36
max validation accuracy :  0.9588414634146342
test accuracy :  0.9525291828793774
last test_accuracy :  0.9525291828793774
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=43, weight_decay=0)
device :  cuda:0
Counter({0: 5417, 2: 2504, 1: 1209})

Epoch :  1 loss training:  127.54458825290203 Time :  3853
accuracy train: 0.899898 val: 0.882622 test: 0.886381
max validation accuracy : 0.882622 max acc epoch : 1 test accuracy : 0.886381
Counter({1: 3652, 2: 2753, 0: 2725})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.09440279006958 Time :  3912
accuracy train: 0.935976 val: 0.916159 test: 0.912062
max validation accuracy : 0.916159 max acc epoch : 2 test accuracy : 0.912062
Counter({0: 3788, 2: 2765, 1: 2577})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  39.72322892025113 Time :  3978
accuracy train: 0.946477 val: 0.913110 test: 0.917899
max validation accuracy : 0.916159 max acc epoch : 2 test accuracy : 0.912062
Counter({1: 3774, 0: 2858, 2: 2498})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  26.759269032627344 Time :  4037
accuracy train: 0.971037 val: 0.935976 test: 0.938132
max validation accuracy : 0.935976 max acc epoch : 4 test accuracy : 0.938132
Counter({1: 3811, 0: 2842, 2: 2477})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  22.667351788375527 Time :  4100
accuracy train: 0.976457 val: 0.937500 test: 0.936187
max validation accuracy : 0.937500 max acc epoch : 5 test accuracy : 0.936187
Counter({0: 3841, 2: 2842, 1: 2447})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  20.232454864308238 Time :  4165
accuracy train: 0.976626 val: 0.937500 test: 0.943969
max validation accuracy : 0.937500 max acc epoch : 5 test accuracy : 0.936187
Counter({1: 3838, 2: 2859, 0: 2433})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  15.873004219960421 Time :  4229
accuracy train: 0.980691 val: 0.946646 test: 0.943969
max validation accuracy : 0.946646 max acc epoch : 7 test accuracy : 0.943969
Counter({1: 3837, 0: 2864, 2: 2429})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  13.784561620093882 Time :  4289
accuracy train: 0.985095 val: 0.945122 test: 0.948638
max validation accuracy : 0.946646 max acc epoch : 7 test accuracy : 0.943969
Counter({0: 3851, 2: 2859, 1: 2420})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  12.98799097398296 Time :  4358
accuracy train: 0.984925 val: 0.943598 test: 0.952140
max validation accuracy : 0.946646 max acc epoch : 7 test accuracy : 0.943969
Counter({0: 3854, 2: 2861, 1: 2415})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  11.872355389408767 Time :  4426
accuracy train: 0.988821 val: 0.948171 test: 0.949805
max validation accuracy : 0.948171 max acc epoch : 10 test accuracy : 0.949805
Counter({0: 3868, 1: 2857, 2: 2405})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  10.770973116159439 Time :  4488
accuracy train: 0.990346 val: 0.948171 test: 0.949416
max validation accuracy : 0.948171 max acc epoch : 10 test accuracy : 0.949805
Counter({1: 3874, 0: 2855, 2: 2401})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  10.218447851017118 Time :  4546
accuracy train: 0.990007 val: 0.943598 test: 0.949027
max validation accuracy : 0.948171 max acc epoch : 10 test accuracy : 0.949805
Counter({0: 3879, 2: 2857, 1: 2394})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  8.823097802698612 Time :  4622
accuracy train: 0.991192 val: 0.948171 test: 0.949805
max validation accuracy : 0.948171 max acc epoch : 10 test accuracy : 0.949805
Counter({0: 3881, 2: 2861, 1: 2388})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  8.303115881048143 Time :  4702
accuracy train: 0.992209 val: 0.954268 test: 0.950973
max validation accuracy : 0.954268 max acc epoch : 14 test accuracy : 0.950973
Counter({0: 3883, 2: 2863, 1: 2384})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  8.158366892952472 Time :  4774
accuracy train: 0.991870 val: 0.948171 test: 0.950195
max validation accuracy : 0.954268 max acc epoch : 14 test accuracy : 0.950973
Counter({0: 3887, 1: 2864, 2: 2379})

Epoch :  16 loss training:  8.07229649857618 Time :  4840
accuracy train: 0.992717 val: 0.949695 test: 0.950584
max validation accuracy : 0.954268 max acc epoch : 14 test accuracy : 0.950973
Counter({2: 3887, 1: 2867, 0: 2376})

Epoch :  17 loss training:  7.407118779141456 Time :  4905
accuracy train: 0.992717 val: 0.951220 test: 0.950973
max validation accuracy : 0.954268 max acc epoch : 14 test accuracy : 0.950973
Counter({0: 3889, 1: 2873, 2: 2368})

Epoch :  18 loss training:  7.391801678342745 Time :  4965
accuracy train: 0.993394 val: 0.955793 test: 0.952140
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({1: 3867, 0: 2871, 2: 2392})

Epoch :  19 loss training:  7.292704511899501 Time :  5021
accuracy train: 0.993902 val: 0.951220 test: 0.953307
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({2: 3870, 1: 2871, 0: 2389})

Epoch :  20 loss training:  6.610391111345962 Time :  5079
accuracy train: 0.993394 val: 0.952744 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({2: 3870, 0: 2871, 1: 2389})

Epoch :  21 loss training:  6.192362923407927 Time :  5139
accuracy train: 0.993733 val: 0.951220 test: 0.950973
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({1: 3874, 0: 2871, 2: 2385})

Epoch :  22 loss training:  6.51089764945209 Time :  5209
accuracy train: 0.993733 val: 0.948171 test: 0.948249
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({0: 3877, 1: 2876, 2: 2377})

Epoch :  23 loss training:  6.412560801953077 Time :  5277
accuracy train: 0.994241 val: 0.954268 test: 0.952140
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({1: 3876, 2: 2876, 0: 2378})

Epoch :  24 loss training:  5.930069453315809 Time :  5344
accuracy train: 0.994411 val: 0.952744 test: 0.950584
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({1: 3880, 0: 2877, 2: 2373})

Epoch :  25 loss training:  5.774643550044857 Time :  5406
accuracy train: 0.994919 val: 0.951220 test: 0.954086
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({1: 3881, 0: 2880, 2: 2369})

Epoch :  26 loss training:  5.515890992013738 Time :  5470
accuracy train: 0.994580 val: 0.946646 test: 0.951362
max validation accuracy : 0.955793 max acc epoch : 18 test accuracy : 0.952140
Counter({1: 3883, 0: 2883, 2: 2364})

Epoch :  27 loss training:  5.5006841907743365 Time :  5534
accuracy train: 0.994919 val: 0.957317 test: 0.950584
max validation accuracy : 0.957317 max acc epoch : 27 test accuracy : 0.950584
Counter({2: 3884, 0: 2884, 1: 2362})

Epoch :  28 loss training:  5.120088914874941 Time :  5600
accuracy train: 0.994919 val: 0.952744 test: 0.950584
max validation accuracy : 0.957317 max acc epoch : 27 test accuracy : 0.950584
Counter({1: 3886, 0: 2894, 2: 2350})

Epoch :  29 loss training:  5.17639135196805 Time :  5673
accuracy train: 0.995257 val: 0.954268 test: 0.950195
max validation accuracy : 0.957317 max acc epoch : 27 test accuracy : 0.950584
Counter({1: 3886, 0: 2894, 2: 2350})

Epoch :  30 loss training:  5.237032482167706 Time :  5735
accuracy train: 0.995088 val: 0.955793 test: 0.953307
max validation accuracy : 0.957317 max acc epoch : 27 test accuracy : 0.950584
Counter({1: 3890, 0: 2892, 2: 2348})

Epoch :  31 loss training:  4.615441583096981 Time :  5797
accuracy train: 0.995088 val: 0.954268 test: 0.952918
max validation accuracy : 0.957317 max acc epoch : 27 test accuracy : 0.950584
Counter({1: 3889, 0: 2895, 2: 2346})

Epoch :  32 loss training:  4.937306384788826 Time :  5857
accuracy train: 0.995596 val: 0.955793 test: 0.952918
max validation accuracy : 0.957317 max acc epoch : 27 test accuracy : 0.950584
Counter({1: 3915, 2: 2895, 0: 2320})

Epoch :  33 loss training:  4.560197681421414 Time :  5917
accuracy train: 0.995427 val: 0.960366 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({1: 3917, 0: 2896, 2: 2317})

Epoch :  34 loss training:  4.332921864464879 Time :  5978
accuracy train: 0.995766 val: 0.958841 test: 0.952140
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({0: 3918, 2: 2894, 1: 2318})

Epoch :  35 loss training:  4.222960565704852 Time :  6042
accuracy train: 0.995596 val: 0.960366 test: 0.951362
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({1: 3917, 0: 2896, 2: 2317})

Epoch :  36 loss training:  3.847582062939182 Time :  6106
accuracy train: 0.996274 val: 0.960366 test: 0.952140
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({1: 3916, 2: 2899, 0: 2315})

Epoch :  37 loss training:  3.633632018463686 Time :  6182
accuracy train: 0.995766 val: 0.957317 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({1: 3915, 0: 2902, 2: 2313})

Epoch :  38 loss training:  4.040307123330422 Time :  6261
accuracy train: 0.996274 val: 0.954268 test: 0.952529
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({1: 3915, 0: 2901, 2: 2314})

Epoch :  39 loss training:  3.599363838438876 Time :  6336
accuracy train: 0.995935 val: 0.958841 test: 0.952140
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({1: 3916, 0: 2903, 2: 2311})

Epoch :  40 loss training:  3.654979239567183 Time :  6395
accuracy train: 0.996104 val: 0.958841 test: 0.951362
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({1: 3917, 0: 2900, 2: 2313})

Epoch :  41 loss training:  3.3291345752077177 Time :  6449
accuracy train: 0.995935 val: 0.954268 test: 0.952529
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({1: 3919, 0: 2899, 2: 2312})

Epoch :  42 loss training:  3.653810348827392 Time :  6513
accuracy train: 0.996104 val: 0.954268 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({1: 3920, 0: 2898, 2: 2312})

Epoch :  43 loss training:  3.195263761386741 Time :  6577
accuracy train: 0.996612 val: 0.954268 test: 0.950973
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({1: 3920, 2: 2896, 0: 2314})

Epoch :  44 loss training:  3.1900505940429866 Time :  6645
accuracy train: 0.996274 val: 0.960366 test: 0.952918
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({1: 3920, 2: 2896, 0: 2314})

Epoch :  45 loss training:  3.2266777954646386 Time :  6714
accuracy train: 0.996274 val: 0.949695 test: 0.950584
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({1: 3921, 0: 2896, 2: 2313})

Epoch :  46 loss training:  3.4409980208729394 Time :  6788
accuracy train: 0.996612 val: 0.954268 test: 0.951751
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({1: 3921, 2: 2900, 0: 2309})

Epoch :  47 loss training:  3.172968198894523 Time :  6870
accuracy train: 0.996612 val: 0.955793 test: 0.952529
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({0: 3921, 2: 2900, 1: 2309})

Epoch :  48 loss training:  3.1866653834003955 Time :  6938
accuracy train: 0.996612 val: 0.960366 test: 0.951751
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({2: 3895, 0: 2900, 1: 2335})

Epoch :  49 loss training:  2.985647238441743 Time :  6998
accuracy train: 0.996612 val: 0.952744 test: 0.953696
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({0: 3895, 1: 2900, 2: 2335})

Epoch :  50 loss training:  3.172884653264191 Time :  7064
accuracy train: 0.997121 val: 0.952744 test: 0.950973
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({0: 3895, 1: 2900, 2: 2335})

Epoch :  51 loss training:  2.759864065621514 Time :  7137
accuracy train: 0.996951 val: 0.954268 test: 0.953307
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({0: 3895, 2: 2900, 1: 2335})

Epoch :  52 loss training:  2.848400696297176 Time :  7210
accuracy train: 0.996782 val: 0.954268 test: 0.953696
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({1: 3921, 0: 2899, 2: 2310})

Epoch :  53 loss training:  2.670385806937702 Time :  7274
accuracy train: 0.996612 val: 0.957317 test: 0.952918
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({2: 3921, 0: 2902, 1: 2307})

Epoch :  54 loss training:  2.7092335700290278 Time :  7344
accuracy train: 0.996612 val: 0.957317 test: 0.954475
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({1: 3921, 0: 2903, 2: 2306})

Epoch :  55 loss training:  2.5663884370587766 Time :  7423
accuracy train: 0.996782 val: 0.957317 test: 0.952140
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({1: 3921, 2: 2903, 0: 2306})

Epoch :  56 loss training:  2.3805522642214783 Time :  7489
accuracy train: 0.996782 val: 0.958841 test: 0.952140
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({1: 3921, 0: 2903, 2: 2306})

Epoch :  57 loss training:  2.9117260573548265 Time :  7558
accuracy train: 0.996951 val: 0.955793 test: 0.952140
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({1: 3919, 2: 2904, 0: 2307})

Epoch :  58 loss training:  2.5985094022471458 Time :  7634
accuracy train: 0.996612 val: 0.952744 test: 0.952140
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({0: 3919, 2: 2903, 1: 2308})

Epoch :  59 loss training:  2.3877048456924967 Time :  7692
accuracy train: 0.996782 val: 0.949695 test: 0.953307
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({2: 3919, 1: 2903, 0: 2308})

Epoch :  60 loss training:  2.551119395327987 Time :  7746
accuracy train: 0.996782 val: 0.948171 test: 0.952140
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({2: 3919, 0: 2903, 1: 2308})

Epoch :  61 loss training:  2.3912709717988037 Time :  7809
accuracy train: 0.996612 val: 0.955793 test: 0.952918
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({0: 3919, 1: 2903, 2: 2308})

Epoch :  62 loss training:  2.125720907759387 Time :  7869
accuracy train: 0.996951 val: 0.955793 test: 0.950973
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({0: 3919, 2: 2903, 1: 2308})

Epoch :  63 loss training:  2.336354961444158 Time :  7931
accuracy train: 0.996951 val: 0.952744 test: 0.951751
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({2: 3918, 0: 2900, 1: 2312})

Epoch :  64 loss training:  2.255919169925619 Time :  7994
accuracy train: 0.996612 val: 0.957317 test: 0.956420
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.950195
Counter({0: 3918, 2: 2901, 1: 2311})

========================================================================================================================================================================================================
max acc epoch :  33
max validation accuracy :  0.9603658536585366
test accuracy :  0.9501945525291828
last test_accuracy :  0.9564202334630351
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=43, weight_decay=0)
device :  cuda:0
Counter({0: 5417, 2: 2504, 1: 1209})

Epoch :  1 loss training:  127.59203611314297 Time :  8242
accuracy train: 0.899221 val: 0.878049 test: 0.884047
max validation accuracy : 0.878049 max acc epoch : 1 test accuracy : 0.884047
Counter({0: 3655, 2: 2772, 1: 2703})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.185871221125126 Time :  8320
accuracy train: 0.937839 val: 0.913110 test: 0.914786
max validation accuracy : 0.913110 max acc epoch : 2 test accuracy : 0.914786
Counter({1: 3787, 0: 2814, 2: 2529})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  39.67787902057171 Time :  8387
accuracy train: 0.945122 val: 0.913110 test: 0.912451
max validation accuracy : 0.913110 max acc epoch : 2 test accuracy : 0.914786
Counter({0: 3807, 2: 2853, 1: 2470})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  26.46260652691126 Time :  8458
accuracy train: 0.969851 val: 0.939024 test: 0.937354
max validation accuracy : 0.939024 max acc epoch : 4 test accuracy : 0.937354
Counter({0: 3846, 2: 2847, 1: 2437})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  22.538062245119363 Time :  8519
accuracy train: 0.973916 val: 0.935976 test: 0.936576
max validation accuracy : 0.939024 max acc epoch : 4 test accuracy : 0.937354
Counter({0: 3840, 2: 2842, 1: 2448})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  20.25562804751098 Time :  8580
accuracy train: 0.975102 val: 0.940549 test: 0.941634
max validation accuracy : 0.940549 max acc epoch : 6 test accuracy : 0.941634
Counter({1: 3835, 0: 2842, 2: 2453})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  15.990983370225877 Time :  8660
accuracy train: 0.980352 val: 0.942073 test: 0.945136
max validation accuracy : 0.942073 max acc epoch : 7 test accuracy : 0.945136
Counter({1: 3830, 0: 2851, 2: 2449})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  13.912829267792404 Time :  8725
accuracy train: 0.985264 val: 0.939024 test: 0.947471
max validation accuracy : 0.942073 max acc epoch : 7 test accuracy : 0.945136
Counter({0: 3834, 1: 2849, 2: 2447})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  13.079453016631305 Time :  8788
accuracy train: 0.984079 val: 0.940549 test: 0.952140
max validation accuracy : 0.942073 max acc epoch : 7 test accuracy : 0.945136
Counter({0: 3844, 1: 2851, 2: 2435})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  11.739737782161683 Time :  8862
accuracy train: 0.988482 val: 0.948171 test: 0.949027
max validation accuracy : 0.948171 max acc epoch : 10 test accuracy : 0.949027
Counter({2: 3855, 1: 2853, 0: 2422})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  10.857490126043558 Time :  8923
accuracy train: 0.989160 val: 0.946646 test: 0.949416
max validation accuracy : 0.948171 max acc epoch : 10 test accuracy : 0.949027
Counter({1: 3862, 0: 2852, 2: 2416})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  10.30104833561927 Time :  8996
accuracy train: 0.989499 val: 0.945122 test: 0.947860
max validation accuracy : 0.948171 max acc epoch : 10 test accuracy : 0.949027
Counter({1: 3869, 0: 2851, 2: 2410})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  8.703661236912012 Time :  9057
accuracy train: 0.990515 val: 0.943598 test: 0.949416
max validation accuracy : 0.948171 max acc epoch : 10 test accuracy : 0.949027
Counter({1: 3871, 2: 2856, 0: 2403})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  8.249896884546615 Time :  9116
accuracy train: 0.991701 val: 0.949695 test: 0.950973
max validation accuracy : 0.949695 max acc epoch : 14 test accuracy : 0.950973
Counter({1: 3875, 2: 2857, 0: 2398})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  8.080227978993207 Time :  9182
accuracy train: 0.991362 val: 0.946646 test: 0.950195
max validation accuracy : 0.949695 max acc epoch : 14 test accuracy : 0.950973
Counter({0: 3888, 1: 2858, 2: 2384})

Epoch :  16 loss training:  8.152084017870948 Time :  9249
accuracy train: 0.992209 val: 0.951220 test: 0.951751
max validation accuracy : 0.951220 max acc epoch : 16 test accuracy : 0.951751
Counter({2: 3889, 0: 2858, 1: 2383})

Epoch :  17 loss training:  7.431508096400648 Time :  9330
accuracy train: 0.992886 val: 0.949695 test: 0.951362
max validation accuracy : 0.951220 max acc epoch : 16 test accuracy : 0.951751
Counter({0: 3889, 2: 2857, 1: 2384})

Epoch :  18 loss training:  7.393881916301325 Time :  9393
accuracy train: 0.993733 val: 0.954268 test: 0.952529
max validation accuracy : 0.954268 max acc epoch : 18 test accuracy : 0.952529
Counter({0: 3864, 2: 2856, 1: 2410})

Epoch :  19 loss training:  7.425583519041538 Time :  9450
accuracy train: 0.993733 val: 0.952744 test: 0.952918
max validation accuracy : 0.954268 max acc epoch : 18 test accuracy : 0.952529
Counter({1: 3866, 2: 2857, 0: 2407})

Epoch :  20 loss training:  6.559971107635647 Time :  9513
accuracy train: 0.993733 val: 0.952744 test: 0.951362
max validation accuracy : 0.954268 max acc epoch : 18 test accuracy : 0.952529
Counter({2: 3866, 0: 2858, 1: 2406})

Epoch :  21 loss training:  6.311894922284409 Time :  9570
accuracy train: 0.994241 val: 0.952744 test: 0.950973
max validation accuracy : 0.954268 max acc epoch : 18 test accuracy : 0.952529
Counter({1: 3870, 2: 2861, 0: 2399})

Epoch :  22 loss training:  6.329278850229457 Time :  9634
accuracy train: 0.993902 val: 0.952744 test: 0.948249
max validation accuracy : 0.954268 max acc epoch : 18 test accuracy : 0.952529
Counter({0: 3876, 2: 2862, 1: 2392})

Epoch :  23 loss training:  6.401258075376973 Time :  9691
accuracy train: 0.994241 val: 0.958841 test: 0.953696
max validation accuracy : 0.958841 max acc epoch : 23 test accuracy : 0.953696
Counter({0: 3902, 1: 2876, 2: 2352})

Epoch :  24 loss training:  5.797277532285079 Time :  9750
accuracy train: 0.994241 val: 0.954268 test: 0.951751
max validation accuracy : 0.958841 max acc epoch : 23 test accuracy : 0.953696
Counter({0: 3906, 2: 2877, 1: 2347})

Epoch :  25 loss training:  5.881861877860501 Time :  9801
accuracy train: 0.994749 val: 0.954268 test: 0.950195
max validation accuracy : 0.958841 max acc epoch : 23 test accuracy : 0.953696
Counter({0: 3909, 1: 2873, 2: 2348})

Epoch :  26 loss training:  6.214405215578154 Time :  9867
accuracy train: 0.995088 val: 0.951220 test: 0.951751
max validation accuracy : 0.958841 max acc epoch : 23 test accuracy : 0.953696
Counter({0: 3910, 1: 2877, 2: 2343})

Epoch :  27 loss training:  5.224980233702809 Time :  9952
accuracy train: 0.995088 val: 0.958841 test: 0.953696
max validation accuracy : 0.958841 max acc epoch : 23 test accuracy : 0.953696
Counter({2: 3914, 0: 2875, 1: 2341})

Epoch :  28 loss training:  5.232387107331306 Time :  10012
accuracy train: 0.995257 val: 0.952744 test: 0.952140
max validation accuracy : 0.958841 max acc epoch : 23 test accuracy : 0.953696
Counter({1: 3890, 2: 2866, 0: 2374})

Epoch :  29 loss training:  5.09256128477864 Time :  10078
accuracy train: 0.994580 val: 0.954268 test: 0.950195
max validation accuracy : 0.958841 max acc epoch : 23 test accuracy : 0.953696
Counter({1: 3890, 0: 2868, 2: 2372})

Epoch :  30 loss training:  4.689596370095387 Time :  10144
accuracy train: 0.994749 val: 0.954268 test: 0.951362
max validation accuracy : 0.958841 max acc epoch : 23 test accuracy : 0.953696
Counter({1: 3892, 2: 2868, 0: 2370})

Epoch :  31 loss training:  4.663528850884177 Time :  10206
accuracy train: 0.994919 val: 0.954268 test: 0.951362
max validation accuracy : 0.958841 max acc epoch : 23 test accuracy : 0.953696
Counter({1: 3892, 0: 2878, 2: 2360})

Epoch :  32 loss training:  4.421905806520954 Time :  10269
accuracy train: 0.995257 val: 0.952744 test: 0.952529
max validation accuracy : 0.958841 max acc epoch : 23 test accuracy : 0.953696
Counter({0: 3917, 2: 2877, 1: 2336})

Epoch :  33 loss training:  4.932437826180831 Time :  10323
accuracy train: 0.995427 val: 0.960366 test: 0.952140
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({0: 3918, 2: 2882, 1: 2330})

Epoch :  34 loss training:  4.293956234876532 Time :  10378
accuracy train: 0.995257 val: 0.951220 test: 0.954864
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({1: 3918, 2: 2884, 0: 2328})

Epoch :  35 loss training:  4.368501073797233 Time :  10441
accuracy train: 0.995766 val: 0.955793 test: 0.951362
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({2: 3918, 0: 2884, 1: 2328})

Epoch :  36 loss training:  3.8668530815048143 Time :  10504
accuracy train: 0.995596 val: 0.954268 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({1: 3918, 2: 2886, 0: 2326})

Epoch :  37 loss training:  3.8023518861737102 Time :  10572
accuracy train: 0.995766 val: 0.951220 test: 0.952529
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({1: 3918, 2: 2885, 0: 2327})

Epoch :  38 loss training:  3.6803318423917517 Time :  10633
accuracy train: 0.996104 val: 0.954268 test: 0.951362
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({1: 3893, 0: 2884, 2: 2353})

Epoch :  39 loss training:  4.020588496583514 Time :  10692
accuracy train: 0.996274 val: 0.955793 test: 0.952529
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({2: 3920, 0: 2884, 1: 2326})

Epoch :  40 loss training:  3.452091969549656 Time :  10755
accuracy train: 0.995596 val: 0.952744 test: 0.952918
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({1: 3919, 2: 2884, 0: 2327})

Epoch :  41 loss training:  3.775938429054804 Time :  10809
accuracy train: 0.996104 val: 0.952744 test: 0.951362
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({1: 3921, 0: 2883, 2: 2326})

Epoch :  42 loss training:  3.3095343058230355 Time :  10868
accuracy train: 0.996443 val: 0.955793 test: 0.950195
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({1: 3923, 2: 2883, 0: 2324})

Epoch :  43 loss training:  3.158549912739545 Time :  10941
accuracy train: 0.996443 val: 0.951220 test: 0.952529
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({0: 3923, 2: 2884, 1: 2323})

Epoch :  44 loss training:  3.301644776132889 Time :  11005
accuracy train: 0.996443 val: 0.955793 test: 0.951362
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({2: 3922, 1: 2888, 0: 2320})

Epoch :  45 loss training:  3.3405102805118077 Time :  11069
accuracy train: 0.996104 val: 0.951220 test: 0.953696
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({0: 3922, 2: 2888, 1: 2320})

Epoch :  46 loss training:  3.380302040488459 Time :  11132
accuracy train: 0.996443 val: 0.951220 test: 0.952529
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({0: 3922, 2: 2889, 1: 2319})

Epoch :  47 loss training:  3.09660549700493 Time :  11194
accuracy train: 0.996443 val: 0.951220 test: 0.954086
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({0: 3919, 2: 2891, 1: 2320})

Epoch :  48 loss training:  2.8521741641452536 Time :  11257
accuracy train: 0.996612 val: 0.951220 test: 0.951362
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({1: 3893, 0: 2891, 2: 2346})

Epoch :  49 loss training:  2.9801065151114017 Time :  11310
accuracy train: 0.996443 val: 0.946646 test: 0.950584
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({1: 3919, 2: 2892, 0: 2319})

Epoch :  50 loss training:  2.912383063463494 Time :  11357
accuracy train: 0.996612 val: 0.948171 test: 0.951751
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({0: 3919, 1: 2893, 2: 2318})

Epoch :  51 loss training:  2.6097828299971297 Time :  11411
accuracy train: 0.996612 val: 0.948171 test: 0.951751
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({0: 3919, 2: 2895, 1: 2316})

Epoch :  52 loss training:  2.844801638566423 Time :  11480
accuracy train: 0.996951 val: 0.948171 test: 0.954086
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({1: 3919, 0: 2894, 2: 2317})

Epoch :  53 loss training:  2.8138770143850707 Time :  11548
accuracy train: 0.997121 val: 0.952744 test: 0.952918
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({0: 3919, 2: 2893, 1: 2318})

Epoch :  54 loss training:  2.648437201511115 Time :  11606
accuracy train: 0.996612 val: 0.951220 test: 0.952529
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({1: 3918, 0: 2893, 2: 2319})

Epoch :  55 loss training:  2.670974810287589 Time :  11664
accuracy train: 0.996443 val: 0.954268 test: 0.954086
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({1: 3918, 0: 2892, 2: 2320})

Epoch :  56 loss training:  2.844096778630046 Time :  11722
accuracy train: 0.996612 val: 0.954268 test: 0.952140
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({0: 3919, 2: 2893, 1: 2318})

Epoch :  57 loss training:  2.5761407472891733 Time :  11786
accuracy train: 0.997121 val: 0.957317 test: 0.953696
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({1: 3920, 2: 2893, 0: 2317})

Epoch :  58 loss training:  2.719886854640208 Time :  11850
accuracy train: 0.996612 val: 0.954268 test: 0.952529
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({0: 3921, 2: 2892, 1: 2317})

Epoch :  59 loss training:  2.5710918261902407 Time :  11907
accuracy train: 0.996612 val: 0.948171 test: 0.951751
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({2: 3921, 0: 2894, 1: 2315})

Epoch :  60 loss training:  2.3073890547966585 Time :  11957
accuracy train: 0.996782 val: 0.951220 test: 0.952140
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({0: 3921, 2: 2894, 1: 2315})

Epoch :  61 loss training:  2.325931684084935 Time :  12012
accuracy train: 0.997121 val: 0.957317 test: 0.952529
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({0: 3922, 1: 2893, 2: 2315})

Epoch :  62 loss training:  2.1917883182759397 Time :  12082
accuracy train: 0.996612 val: 0.954268 test: 0.952529
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({0: 3922, 2: 2893, 1: 2315})

Epoch :  63 loss training:  2.5693896621232852 Time :  12144
accuracy train: 0.997290 val: 0.954268 test: 0.952918
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({1: 3921, 0: 2894, 2: 2315})

Epoch :  64 loss training:  2.5411488473182544 Time :  12212
accuracy train: 0.996782 val: 0.952744 test: 0.954086
max validation accuracy : 0.960366 max acc epoch : 33 test accuracy : 0.952140
Counter({1: 3921, 2: 2895, 0: 2314})

========================================================================================================================================================================================================
max acc epoch :  33
max validation accuracy :  0.9603658536585366
test accuracy :  0.9521400778210116
last test_accuracy :  0.9540856031128405
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=43, weight_decay=0)
device :  cuda:0
Counter({0: 5417, 2: 2504, 1: 1209})

Epoch :  1 loss training:  127.54603771865368 Time :  12451
accuracy train: 0.900407 val: 0.882622 test: 0.886381
max validation accuracy : 0.882622 max acc epoch : 1 test accuracy : 0.886381
Counter({1: 3642, 2: 2775, 0: 2713})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.14507146179676 Time :  12514
accuracy train: 0.940041 val: 0.916159 test: 0.913230
max validation accuracy : 0.916159 max acc epoch : 2 test accuracy : 0.913230
Counter({1: 3749, 2: 2760, 0: 2621})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  39.971397429704666 Time :  12586
accuracy train: 0.948679 val: 0.910061 test: 0.918677
max validation accuracy : 0.916159 max acc epoch : 2 test accuracy : 0.913230
Counter({0: 3767, 2: 2856, 1: 2507})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  26.79009899497032 Time :  12645
accuracy train: 0.970359 val: 0.935976 test: 0.936576
max validation accuracy : 0.935976 max acc epoch : 4 test accuracy : 0.936576
Counter({0: 3801, 2: 2854, 1: 2475})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  22.48698876844719 Time :  12704
accuracy train: 0.974593 val: 0.935976 test: 0.934630
max validation accuracy : 0.935976 max acc epoch : 4 test accuracy : 0.936576
Counter({1: 3818, 0: 2861, 2: 2451})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  20.185828410089016 Time :  12762
accuracy train: 0.976118 val: 0.939024 test: 0.944358
max validation accuracy : 0.939024 max acc epoch : 6 test accuracy : 0.944358
Counter({2: 3831, 0: 2865, 1: 2434})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  16.16982380882837 Time :  12829
accuracy train: 0.981030 val: 0.943598 test: 0.944358
max validation accuracy : 0.943598 max acc epoch : 7 test accuracy : 0.944358
Counter({1: 3833, 0: 2890, 2: 2407})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  13.942712988704443 Time :  12908
accuracy train: 0.984925 val: 0.943598 test: 0.946304
max validation accuracy : 0.943598 max acc epoch : 7 test accuracy : 0.944358
Counter({0: 3849, 2: 2879, 1: 2402})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  13.114640881773084 Time :  12975
accuracy train: 0.984756 val: 0.943598 test: 0.950195
max validation accuracy : 0.943598 max acc epoch : 7 test accuracy : 0.944358
Counter({2: 3852, 1: 2880, 0: 2398})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  11.539056845474988 Time :  13040
accuracy train: 0.988821 val: 0.948171 test: 0.949416
max validation accuracy : 0.948171 max acc epoch : 10 test accuracy : 0.949416
Counter({0: 3865, 1: 2876, 2: 2389})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  10.877268850803375 Time :  13101
accuracy train: 0.989668 val: 0.946646 test: 0.949027
max validation accuracy : 0.948171 max acc epoch : 10 test accuracy : 0.949416
Counter({1: 3870, 0: 2872, 2: 2388})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  10.077185043133795 Time :  13170
accuracy train: 0.989668 val: 0.940549 test: 0.950584
max validation accuracy : 0.948171 max acc epoch : 10 test accuracy : 0.949416
Counter({0: 3872, 2: 2875, 1: 2383})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  8.715732513926923 Time :  13239
accuracy train: 0.990854 val: 0.946646 test: 0.950195
max validation accuracy : 0.948171 max acc epoch : 10 test accuracy : 0.949416
Counter({0: 3875, 1: 2875, 2: 2380})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  8.183710815035738 Time :  13301
accuracy train: 0.992209 val: 0.951220 test: 0.953696
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.953696
Counter({1: 3880, 2: 2872, 0: 2378})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  8.110308292787522 Time :  13368
accuracy train: 0.991870 val: 0.946646 test: 0.951362
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.953696
Counter({1: 3884, 2: 2870, 0: 2376})

Epoch :  16 loss training:  7.9851268185302615 Time :  13436
accuracy train: 0.992039 val: 0.946646 test: 0.953307
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.953696
Counter({1: 3887, 0: 2870, 2: 2373})

Epoch :  17 loss training:  7.351455185096711 Time :  13493
accuracy train: 0.992547 val: 0.945122 test: 0.952529
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.953696
Counter({1: 3889, 2: 2870, 0: 2371})

Epoch :  18 loss training:  7.077455920865759 Time :  13556
accuracy train: 0.992886 val: 0.951220 test: 0.951362
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.953696
Counter({0: 3867, 2: 2870, 1: 2393})

Epoch :  19 loss training:  7.252599662635475 Time :  13617
accuracy train: 0.994241 val: 0.951220 test: 0.956031
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.953696
Counter({1: 3868, 2: 2870, 0: 2392})

Epoch :  20 loss training:  6.590901949908584 Time :  13678
accuracy train: 0.994072 val: 0.949695 test: 0.952140
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.953696
Counter({0: 3868, 2: 2874, 1: 2388})

Epoch :  21 loss training:  6.268909614998847 Time :  13733
accuracy train: 0.993733 val: 0.946646 test: 0.950195
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.953696
Counter({1: 3868, 0: 2877, 2: 2385})

Epoch :  22 loss training:  6.38509229850024 Time :  13785
accuracy train: 0.994072 val: 0.943598 test: 0.948638
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.953696
Counter({0: 3871, 2: 2877, 1: 2382})

Epoch :  23 loss training:  6.479838720522821 Time :  13859
accuracy train: 0.994241 val: 0.946646 test: 0.954086
max validation accuracy : 0.951220 max acc epoch : 14 test accuracy : 0.953696
Counter({0: 3871, 2: 2877, 1: 2382})

Epoch :  24 loss training:  5.911430998938158 Time :  13917
accuracy train: 0.994580 val: 0.954268 test: 0.952529
max validation accuracy : 0.954268 max acc epoch : 24 test accuracy : 0.952529
Counter({1: 3872, 0: 2876, 2: 2382})

Epoch :  25 loss training:  5.5470982833066955 Time :  13976
accuracy train: 0.994580 val: 0.952744 test: 0.953696
max validation accuracy : 0.954268 max acc epoch : 24 test accuracy : 0.952529
Counter({0: 3874, 1: 2878, 2: 2378})

Epoch :  26 loss training:  5.531210284680128 Time :  14042
accuracy train: 0.994411 val: 0.943598 test: 0.952529
max validation accuracy : 0.954268 max acc epoch : 24 test accuracy : 0.952529
Counter({1: 3877, 0: 2883, 2: 2370})

Epoch :  27 loss training:  5.333059805678204 Time :  14104
accuracy train: 0.994919 val: 0.955793 test: 0.952529
max validation accuracy : 0.955793 max acc epoch : 27 test accuracy : 0.952529
Counter({1: 3880, 0: 2884, 2: 2366})

Epoch :  28 loss training:  5.136358415475115 Time :  14166
accuracy train: 0.994749 val: 0.949695 test: 0.949805
max validation accuracy : 0.955793 max acc epoch : 27 test accuracy : 0.952529
Counter({1: 3885, 2: 2883, 0: 2362})

Epoch :  29 loss training:  5.12247746787034 Time :  14230
accuracy train: 0.994749 val: 0.949695 test: 0.949416
max validation accuracy : 0.955793 max acc epoch : 27 test accuracy : 0.952529
Counter({1: 3884, 2: 2883, 0: 2363})

Epoch :  30 loss training:  5.066119794733822 Time :  14288
accuracy train: 0.995257 val: 0.954268 test: 0.951362
max validation accuracy : 0.955793 max acc epoch : 27 test accuracy : 0.952529
Counter({1: 3885, 0: 2884, 2: 2361})

Epoch :  31 loss training:  4.519015390891582 Time :  14345
accuracy train: 0.994919 val: 0.951220 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 27 test accuracy : 0.952529
Counter({2: 3885, 0: 2887, 1: 2358})

Epoch :  32 loss training:  4.928554902784526 Time :  14404
accuracy train: 0.995766 val: 0.951220 test: 0.950195
max validation accuracy : 0.955793 max acc epoch : 27 test accuracy : 0.952529
Counter({0: 3884, 2: 2888, 1: 2358})

Epoch :  33 loss training:  4.51377156295348 Time :  14477
accuracy train: 0.995088 val: 0.957317 test: 0.951362
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({1: 3887, 2: 2887, 0: 2356})

Epoch :  34 loss training:  4.329608105588704 Time :  14549
accuracy train: 0.995766 val: 0.954268 test: 0.952529
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({0: 3892, 2: 2887, 1: 2351})

Epoch :  35 loss training:  4.3213226542575285 Time :  14610
accuracy train: 0.995257 val: 0.955793 test: 0.950973
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({1: 3890, 0: 2890, 2: 2350})

Epoch :  36 loss training:  3.786368643399328 Time :  14667
accuracy train: 0.996104 val: 0.954268 test: 0.953307
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({1: 3890, 2: 2901, 0: 2339})

Epoch :  37 loss training:  3.7246962727513164 Time :  14722
accuracy train: 0.995257 val: 0.951220 test: 0.950195
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({1: 3914, 2: 2903, 0: 2313})

Epoch :  38 loss training:  3.9010486733168364 Time :  14782
accuracy train: 0.996443 val: 0.951220 test: 0.951362
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({1: 3914, 0: 2903, 2: 2313})

Epoch :  39 loss training:  3.636171907070093 Time :  14842
accuracy train: 0.996443 val: 0.954268 test: 0.952529
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({0: 3914, 2: 2902, 1: 2314})

Epoch :  40 loss training:  3.7289863652549684 Time :  14900
accuracy train: 0.995766 val: 0.954268 test: 0.950973
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({1: 3914, 2: 2902, 0: 2314})

Epoch :  41 loss training:  3.2470362650055904 Time :  14959
accuracy train: 0.996274 val: 0.948171 test: 0.950973
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({1: 3915, 0: 2901, 2: 2314})

Epoch :  42 loss training:  3.6211259578121826 Time :  15018
accuracy train: 0.996274 val: 0.949695 test: 0.949805
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({1: 3915, 0: 2904, 2: 2311})

Epoch :  43 loss training:  3.078067591995932 Time :  15079
accuracy train: 0.996612 val: 0.954268 test: 0.950584
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({1: 3915, 0: 2903, 2: 2312})

Epoch :  44 loss training:  2.990558729856275 Time :  15143
accuracy train: 0.996443 val: 0.952744 test: 0.952918
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({1: 3915, 2: 2901, 0: 2314})

Epoch :  45 loss training:  3.2316412855288945 Time :  15205
accuracy train: 0.996104 val: 0.952744 test: 0.950584
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({1: 3916, 0: 2901, 2: 2313})

Epoch :  46 loss training:  3.3423819853924215 Time :  15262
accuracy train: 0.996612 val: 0.949695 test: 0.953307
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({1: 3916, 0: 2902, 2: 2312})

Epoch :  47 loss training:  3.134552735136822 Time :  15324
accuracy train: 0.996612 val: 0.948171 test: 0.950584
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({1: 3915, 0: 2902, 2: 2313})

Epoch :  48 loss training:  2.7856571038719267 Time :  15383
accuracy train: 0.996443 val: 0.955793 test: 0.954086
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({2: 3891, 0: 2901, 1: 2338})

Epoch :  49 loss training:  2.9351473237620667 Time :  15439
accuracy train: 0.996443 val: 0.954268 test: 0.954475
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({1: 3917, 0: 2901, 2: 2312})

Epoch :  50 loss training:  3.164098403416574 Time :  15499
accuracy train: 0.997121 val: 0.943598 test: 0.951362
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({0: 3917, 2: 2902, 1: 2311})

Epoch :  51 loss training:  3.0560535973054357 Time :  15579
accuracy train: 0.996951 val: 0.949695 test: 0.952918
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({0: 3916, 1: 2902, 2: 2312})

Epoch :  52 loss training:  2.7078184145502746 Time :  15643
accuracy train: 0.996782 val: 0.948171 test: 0.952529
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({1: 3916, 2: 2908, 0: 2306})

Epoch :  53 loss training:  2.4845836017047986 Time :  15701
accuracy train: 0.996782 val: 0.948171 test: 0.952529
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({0: 3915, 2: 2907, 1: 2308})

Epoch :  54 loss training:  2.785766207263805 Time :  15768
accuracy train: 0.996274 val: 0.948171 test: 0.952140
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({1: 3915, 0: 2907, 2: 2308})

Epoch :  55 loss training:  2.6716923417989165 Time :  15830
accuracy train: 0.997290 val: 0.949695 test: 0.952529
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({0: 3889, 1: 2906, 2: 2335})

Epoch :  56 loss training:  2.760092569835251 Time :  15887
accuracy train: 0.996782 val: 0.948171 test: 0.952140
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({0: 3889, 2: 2905, 1: 2336})

Epoch :  57 loss training:  2.5657729043159634 Time :  15937
accuracy train: 0.996951 val: 0.946646 test: 0.950195
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({0: 3889, 2: 2906, 1: 2335})

Epoch :  58 loss training:  2.9378476782003418 Time :  15984
accuracy train: 0.996951 val: 0.951220 test: 0.952140
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({0: 3891, 2: 2907, 1: 2332})

Epoch :  59 loss training:  2.6858173636428546 Time :  16035
accuracy train: 0.996443 val: 0.952744 test: 0.950584
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({1: 3917, 2: 2907, 0: 2306})

Epoch :  60 loss training:  2.5663889635179657 Time :  16090
accuracy train: 0.996612 val: 0.951220 test: 0.952140
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({1: 3917, 0: 2906, 2: 2307})

Epoch :  61 loss training:  2.449077820914681 Time :  16148
accuracy train: 0.996782 val: 0.951220 test: 0.952529
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({2: 3918, 1: 2906, 0: 2306})

Epoch :  62 loss training:  2.5365747120813467 Time :  16198
accuracy train: 0.996782 val: 0.952744 test: 0.951751
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({0: 3918, 2: 2906, 1: 2306})

Epoch :  63 loss training:  2.6327705688308924 Time :  16243
accuracy train: 0.997121 val: 0.949695 test: 0.952529
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({2: 3917, 0: 2905, 1: 2308})

Epoch :  64 loss training:  2.2674478786211694 Time :  16292
accuracy train: 0.996612 val: 0.955793 test: 0.953307
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.951362
Counter({1: 3917, 2: 2906, 0: 2307})

========================================================================================================================================================================================================
max acc epoch :  33
max validation accuracy :  0.9573170731707317
test accuracy :  0.9513618677042801
last test_accuracy :  0.953307392996109
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=43, weight_decay=0)
device :  cuda:0
Counter({0: 5417, 2: 2504, 1: 1209})

Epoch :  1 loss training:  127.52990727126598 Time :  16508
accuracy train: 0.897358 val: 0.879573 test: 0.887549
max validation accuracy : 0.879573 max acc epoch : 1 test accuracy : 0.887549
Counter({0: 3637, 2: 2751, 1: 2742})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  53.28120381385088 Time :  16568
accuracy train: 0.937839 val: 0.916159 test: 0.912840
max validation accuracy : 0.916159 max acc epoch : 2 test accuracy : 0.912840
Counter({1: 3778, 2: 2787, 0: 2565})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  39.75158132612705 Time :  16622
accuracy train: 0.948171 val: 0.919207 test: 0.917510
max validation accuracy : 0.919207 max acc epoch : 3 test accuracy : 0.917510
Counter({0: 3781, 2: 2840, 1: 2509})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  26.70217297784984 Time :  16685
accuracy train: 0.971545 val: 0.937500 test: 0.938911
max validation accuracy : 0.937500 max acc epoch : 4 test accuracy : 0.938911
Counter({2: 3819, 0: 2847, 1: 2464})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  22.50592676596716 Time :  16742
accuracy train: 0.972900 val: 0.932927 test: 0.938132
max validation accuracy : 0.937500 max acc epoch : 4 test accuracy : 0.938911
Counter({0: 3813, 1: 2858, 2: 2459})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  20.04206819087267 Time :  16797
accuracy train: 0.975949 val: 0.942073 test: 0.943191
max validation accuracy : 0.942073 max acc epoch : 6 test accuracy : 0.943191
Counter({1: 3822, 0: 2859, 2: 2449})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  15.696293155662715 Time :  16850
accuracy train: 0.979167 val: 0.951220 test: 0.943969
max validation accuracy : 0.951220 max acc epoch : 7 test accuracy : 0.943969
Counter({1: 3819, 0: 2889, 2: 2422})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  14.008543792180717 Time :  16902
accuracy train: 0.984756 val: 0.940549 test: 0.947471
max validation accuracy : 0.951220 max acc epoch : 7 test accuracy : 0.943969
Counter({0: 3839, 1: 2873, 2: 2418})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  13.197000473272055 Time :  16965
accuracy train: 0.985095 val: 0.948171 test: 0.951751
max validation accuracy : 0.951220 max acc epoch : 7 test accuracy : 0.943969
Counter({1: 3846, 2: 2871, 0: 2413})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  11.839115246664733 Time :  17016
accuracy train: 0.987974 val: 0.948171 test: 0.947860
max validation accuracy : 0.951220 max acc epoch : 7 test accuracy : 0.943969
Counter({1: 3864, 0: 2866, 2: 2400})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  10.903780600056052 Time :  17063
accuracy train: 0.989329 val: 0.948171 test: 0.950195
max validation accuracy : 0.951220 max acc epoch : 7 test accuracy : 0.943969
Counter({2: 3868, 1: 2864, 0: 2398})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  10.328770303167403 Time :  17115
accuracy train: 0.989329 val: 0.943598 test: 0.950195
max validation accuracy : 0.951220 max acc epoch : 7 test accuracy : 0.943969
Counter({0: 3871, 2: 2868, 1: 2391})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  8.783407610841095 Time :  17169
accuracy train: 0.990684 val: 0.945122 test: 0.949805
max validation accuracy : 0.951220 max acc epoch : 7 test accuracy : 0.943969
Counter({2: 3871, 0: 2873, 1: 2386})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  8.397795301163569 Time :  17234
accuracy train: 0.991192 val: 0.946646 test: 0.949027
max validation accuracy : 0.951220 max acc epoch : 7 test accuracy : 0.943969
Counter({2: 3873, 1: 2874, 0: 2383})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  8.442665974609554 Time :  17289
accuracy train: 0.991701 val: 0.945122 test: 0.951751
max validation accuracy : 0.951220 max acc epoch : 7 test accuracy : 0.943969
Counter({1: 3877, 2: 2874, 0: 2379})

Epoch :  16 loss training:  8.267342413309962 Time :  17345
accuracy train: 0.991362 val: 0.949695 test: 0.951751
max validation accuracy : 0.951220 max acc epoch : 7 test accuracy : 0.943969
Counter({1: 3879, 0: 2877, 2: 2374})

Epoch :  17 loss training:  7.492954862769693 Time :  17395
accuracy train: 0.992209 val: 0.946646 test: 0.949805
max validation accuracy : 0.951220 max acc epoch : 7 test accuracy : 0.943969
Counter({0: 3881, 1: 2874, 2: 2375})

Epoch :  18 loss training:  7.312893701018766 Time :  17447
accuracy train: 0.992886 val: 0.949695 test: 0.951362
max validation accuracy : 0.951220 max acc epoch : 7 test accuracy : 0.943969
Counter({0: 3886, 2: 2874, 1: 2370})

Epoch :  19 loss training:  7.542585647199303 Time :  17505
accuracy train: 0.993564 val: 0.949695 test: 0.951751
max validation accuracy : 0.951220 max acc epoch : 7 test accuracy : 0.943969
Counter({0: 3888, 2: 2874, 1: 2368})

Epoch :  20 loss training:  6.967058282345533 Time :  17556
accuracy train: 0.993733 val: 0.949695 test: 0.950584
max validation accuracy : 0.951220 max acc epoch : 7 test accuracy : 0.943969
Counter({2: 3888, 0: 2875, 1: 2367})

Epoch :  21 loss training:  6.358773129759356 Time :  17605
accuracy train: 0.993564 val: 0.946646 test: 0.950584
max validation accuracy : 0.951220 max acc epoch : 7 test accuracy : 0.943969
Counter({1: 3890, 0: 2876, 2: 2364})

Epoch :  22 loss training:  6.535787331871688 Time :  17662
accuracy train: 0.993394 val: 0.945122 test: 0.950195
max validation accuracy : 0.951220 max acc epoch : 7 test accuracy : 0.943969
Counter({0: 3894, 2: 2877, 1: 2359})

Epoch :  23 loss training:  6.483143295859918 Time :  17722
accuracy train: 0.994072 val: 0.952744 test: 0.952918
max validation accuracy : 0.952744 max acc epoch : 23 test accuracy : 0.952918
Counter({0: 3898, 2: 2881, 1: 2351})

Epoch :  24 loss training:  5.750392135465518 Time :  17782
accuracy train: 0.994241 val: 0.949695 test: 0.954086
max validation accuracy : 0.952744 max acc epoch : 23 test accuracy : 0.952918
Counter({0: 3901, 2: 2882, 1: 2347})

Epoch :  25 loss training:  5.832348458352499 Time :  17833
accuracy train: 0.994919 val: 0.951220 test: 0.954864
max validation accuracy : 0.952744 max acc epoch : 23 test accuracy : 0.952918
Counter({1: 3902, 2: 2884, 0: 2344})

Epoch :  26 loss training:  5.771764478413388 Time :  17883
accuracy train: 0.994749 val: 0.943598 test: 0.951751
max validation accuracy : 0.952744 max acc epoch : 23 test accuracy : 0.952918
Counter({1: 3906, 0: 2887, 2: 2337})

Epoch :  27 loss training:  5.515954759437591 Time :  17929
accuracy train: 0.995427 val: 0.954268 test: 0.953307
max validation accuracy : 0.954268 max acc epoch : 27 test accuracy : 0.953307
Counter({2: 3908, 0: 2888, 1: 2334})

Epoch :  28 loss training:  5.148164357524365 Time :  17992
accuracy train: 0.995427 val: 0.949695 test: 0.950973
max validation accuracy : 0.954268 max acc epoch : 27 test accuracy : 0.953307
Counter({1: 3910, 0: 2887, 2: 2333})

Epoch :  29 loss training:  5.377850023796782 Time :  18057
accuracy train: 0.995257 val: 0.948171 test: 0.950973
max validation accuracy : 0.954268 max acc epoch : 27 test accuracy : 0.953307
Counter({1: 3914, 0: 2887, 2: 2329})

Epoch :  30 loss training:  5.199571978067979 Time :  18096
accuracy train: 0.994749 val: 0.952744 test: 0.954864
max validation accuracy : 0.954268 max acc epoch : 27 test accuracy : 0.953307
Counter({1: 3915, 0: 2887, 2: 2328})

Epoch :  31 loss training:  4.7005497785285115 Time :  18134
accuracy train: 0.995088 val: 0.952744 test: 0.953307
max validation accuracy : 0.954268 max acc epoch : 27 test accuracy : 0.953307
Counter({1: 3915, 0: 2888, 2: 2327})

Epoch :  32 loss training:  5.1103719777893275 Time :  18173
accuracy train: 0.996274 val: 0.951220 test: 0.953696
max validation accuracy : 0.954268 max acc epoch : 27 test accuracy : 0.953307
Counter({1: 3917, 2: 2886, 0: 2327})

Epoch :  33 loss training:  4.562234882614575 Time :  18215
accuracy train: 0.994919 val: 0.957317 test: 0.954475
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({0: 3918, 2: 2887, 1: 2325})

Epoch :  34 loss training:  4.353137229336426 Time :  18273
accuracy train: 0.996104 val: 0.954268 test: 0.954864
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({0: 3920, 2: 2886, 1: 2324})

Epoch :  35 loss training:  4.293625811813399 Time :  18316
accuracy train: 0.995596 val: 0.952744 test: 0.952529
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({0: 3919, 2: 2889, 1: 2322})

Epoch :  36 loss training:  3.697988747037016 Time :  18354
accuracy train: 0.995766 val: 0.955793 test: 0.953696
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({2: 3918, 1: 2892, 0: 2320})

Epoch :  37 loss training:  3.7292570273857564 Time :  18390
accuracy train: 0.995088 val: 0.952744 test: 0.950973
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({1: 3918, 2: 2893, 0: 2319})

Epoch :  38 loss training:  3.9788252626312897 Time :  18429
accuracy train: 0.996951 val: 0.954268 test: 0.955253
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({1: 3918, 0: 2894, 2: 2318})

Epoch :  39 loss training:  3.667154021561146 Time :  18483
accuracy train: 0.996443 val: 0.955793 test: 0.954475
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({0: 3919, 2: 2893, 1: 2318})

Epoch :  40 loss training:  3.7180133184883744 Time :  18522
accuracy train: 0.996104 val: 0.954268 test: 0.954475
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({2: 3919, 1: 2892, 0: 2319})

Epoch :  41 loss training:  3.3722240808128845 Time :  18560
accuracy train: 0.996104 val: 0.949695 test: 0.953307
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({1: 3919, 0: 2894, 2: 2317})

Epoch :  42 loss training:  3.691462741815485 Time :  18609
accuracy train: 0.996443 val: 0.954268 test: 0.949805
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({1: 3920, 0: 2894, 2: 2316})

Epoch :  43 loss training:  3.1934430565452203 Time :  18654
accuracy train: 0.996443 val: 0.952744 test: 0.951362
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({1: 3922, 0: 2892, 2: 2316})

Epoch :  44 loss training:  3.0944322868599556 Time :  18702
accuracy train: 0.996443 val: 0.954268 test: 0.952918
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({1: 3922, 2: 2893, 0: 2315})

Epoch :  45 loss training:  3.183998983411584 Time :  18746
accuracy train: 0.996274 val: 0.948171 test: 0.951751
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({0: 3922, 2: 2895, 1: 2313})

Epoch :  46 loss training:  3.4371594330877997 Time :  18788
accuracy train: 0.996443 val: 0.951220 test: 0.953696
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({1: 3922, 0: 2895, 2: 2313})

Epoch :  47 loss training:  3.3790971839334816 Time :  18824
accuracy train: 0.996782 val: 0.952744 test: 0.952918
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({1: 3922, 0: 2896, 2: 2312})

Epoch :  48 loss training:  3.0756208694074303 Time :  18867
accuracy train: 0.996782 val: 0.955793 test: 0.954086
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({1: 3922, 0: 2896, 2: 2312})

Epoch :  49 loss training:  2.877516853273846 Time :  18916
accuracy train: 0.996443 val: 0.948171 test: 0.953307
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({1: 3922, 0: 2897, 2: 2311})

Epoch :  50 loss training:  3.0557717330520973 Time :  18958
accuracy train: 0.996951 val: 0.951220 test: 0.952918
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({1: 3922, 2: 2897, 0: 2311})

Epoch :  51 loss training:  2.87595742684789 Time :  18994
accuracy train: 0.996951 val: 0.949695 test: 0.952140
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({0: 3923, 2: 2896, 1: 2311})

Epoch :  52 loss training:  2.7421460613550153 Time :  19039
accuracy train: 0.996443 val: 0.951220 test: 0.957198
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({1: 3923, 0: 2895, 2: 2312})

Epoch :  53 loss training:  2.869050714711193 Time :  19086
accuracy train: 0.996951 val: 0.951220 test: 0.952140
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({0: 3923, 2: 2899, 1: 2308})

Epoch :  54 loss training:  2.784495049389079 Time :  19125
accuracy train: 0.996951 val: 0.949695 test: 0.954086
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({1: 3923, 0: 2901, 2: 2306})

Epoch :  55 loss training:  2.542073268792592 Time :  19170
accuracy train: 0.997121 val: 0.952744 test: 0.952529
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({1: 3923, 0: 2901, 2: 2306})

Epoch :  56 loss training:  2.569728708767798 Time :  19212
accuracy train: 0.997290 val: 0.952744 test: 0.952918
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({0: 3923, 2: 2901, 1: 2306})

Epoch :  57 loss training:  2.930992325709667 Time :  19245
accuracy train: 0.997121 val: 0.955793 test: 0.953307
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({1: 3922, 2: 2901, 0: 2307})

Epoch :  58 loss training:  2.5706503455294296 Time :  19302
accuracy train: 0.997290 val: 0.949695 test: 0.952529
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({2: 3922, 0: 2901, 1: 2307})

Epoch :  59 loss training:  2.46945062559098 Time :  19336
accuracy train: 0.996782 val: 0.949695 test: 0.954475
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({1: 3922, 2: 2901, 0: 2307})

Epoch :  60 loss training:  2.598962587711867 Time :  19376
accuracy train: 0.997290 val: 0.948171 test: 0.950195
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({1: 3922, 0: 2900, 2: 2308})

Epoch :  61 loss training:  2.412610680970829 Time :  19415
accuracy train: 0.996782 val: 0.949695 test: 0.952140
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({2: 3922, 0: 2898, 1: 2310})

Epoch :  62 loss training:  2.1638205000199378 Time :  19455
accuracy train: 0.996951 val: 0.952744 test: 0.953696
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({0: 3923, 2: 2898, 1: 2309})

Epoch :  63 loss training:  2.250839852291392 Time :  19515
accuracy train: 0.997290 val: 0.946646 test: 0.953307
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({0: 3921, 2: 2899, 1: 2310})

Epoch :  64 loss training:  2.159885459288489 Time :  19551
accuracy train: 0.996782 val: 0.954268 test: 0.955253
max validation accuracy : 0.957317 max acc epoch : 33 test accuracy : 0.954475
Counter({1: 3921, 2: 2898, 0: 2311})

========================================================================================================================================================================================================
max acc epoch :  33
max validation accuracy :  0.9573170731707317
test accuracy :  0.9544747081712063
last test_accuracy :  0.9552529182879378
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.95884 	 test_accuracy : 0.95253 	 max_acc epoch :  36 	 last test_accuracy : 0.95253
k :  1 	 val_accuracy : 0.96037 	 test_accuracy : 0.95019 	 max_acc epoch :  33 	 last test_accuracy : 0.95642
k :  2 	 val_accuracy : 0.96037 	 test_accuracy : 0.95214 	 max_acc epoch :  33 	 last test_accuracy : 0.95409
k :  3 	 val_accuracy : 0.95732 	 test_accuracy : 0.95136 	 max_acc epoch :  33 	 last test_accuracy : 0.95331
k :  4 	 val_accuracy : 0.95732 	 test_accuracy : 0.95447 	 max_acc epoch :  33 	 last test_accuracy : 0.95525

avg :  	 val_accuracy : 0.95884 	 test_accuracy : 0.95214 	 last_accuracy : 0.95432
