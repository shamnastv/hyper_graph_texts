

date and time :  Tue Jun 15 10:15:27 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=846, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  41.61561283841729 Time :  13
accuracy train: 0.945466 val: 0.923636 test: 0.935160
max validation accuracy : 0.923636 max acc epoch : 1 test accuracy : 0.935160
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.6834332421422 Time :  29
accuracy train: 0.971557 val: 0.963636 test: 0.953881
max validation accuracy : 0.963636 max acc epoch : 2 test accuracy : 0.953881
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.601175297051668 Time :  49
accuracy train: 0.970274 val: 0.953939 test: 0.967123
max validation accuracy : 0.963636 max acc epoch : 2 test accuracy : 0.953881
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.843384216539562 Time :  71
accuracy train: 0.987169 val: 0.972121 test: 0.966210
max validation accuracy : 0.972121 max acc epoch : 4 test accuracy : 0.966210
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.354854981880635 Time :  83
accuracy train: 0.987596 val: 0.968485 test: 0.973516
max validation accuracy : 0.972121 max acc epoch : 4 test accuracy : 0.966210
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.632463465444744 Time :  94
accuracy train: 0.986527 val: 0.968485 test: 0.967123
max validation accuracy : 0.972121 max acc epoch : 4 test accuracy : 0.966210
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.252077949233353 Time :  110
accuracy train: 0.992729 val: 0.973333 test: 0.964840
max validation accuracy : 0.973333 max acc epoch : 7 test accuracy : 0.964840
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  7.3006557014305145 Time :  128
accuracy train: 0.992943 val: 0.975758 test: 0.968037
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.968037
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.201182999415323 Time :  147
accuracy train: 0.992943 val: 0.974545 test: 0.969863
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.968037
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  6.266196301963646 Time :  162
accuracy train: 0.993584 val: 0.975758 test: 0.966667
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.968037

Epoch :  11 loss training:  5.039098049863242 Time :  177
accuracy train: 0.993798 val: 0.976970 test: 0.969406
max validation accuracy : 0.976970 max acc epoch : 11 test accuracy : 0.969406

Epoch :  12 loss training:  5.24019477982074 Time :  200
accuracy train: 0.994654 val: 0.978182 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 12 test accuracy : 0.968037

Epoch :  13 loss training:  4.92535512172617 Time :  221
accuracy train: 0.994226 val: 0.975758 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 12 test accuracy : 0.968037

Epoch :  14 loss training:  4.075621349737048 Time :  236
accuracy train: 0.995081 val: 0.974545 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 12 test accuracy : 0.968037

Epoch :  15 loss training:  4.180323776672594 Time :  248
accuracy train: 0.995295 val: 0.976970 test: 0.964840
max validation accuracy : 0.978182 max acc epoch : 12 test accuracy : 0.968037

Epoch :  16 loss training:  4.592015491973143 Time :  265
accuracy train: 0.995295 val: 0.979394 test: 0.969406
max validation accuracy : 0.979394 max acc epoch : 16 test accuracy : 0.969406

Epoch :  17 loss training:  3.648277072701603 Time :  284
accuracy train: 0.995723 val: 0.978182 test: 0.966667
max validation accuracy : 0.979394 max acc epoch : 16 test accuracy : 0.969406

Epoch :  18 loss training:  3.231442983436864 Time :  300
accuracy train: 0.996151 val: 0.974545 test: 0.970320
max validation accuracy : 0.979394 max acc epoch : 16 test accuracy : 0.969406

Epoch :  19 loss training:  3.2814425175311044 Time :  312
accuracy train: 0.996151 val: 0.981818 test: 0.966667
max validation accuracy : 0.981818 max acc epoch : 19 test accuracy : 0.966667

Epoch :  20 loss training:  3.3293883713777177 Time :  337
accuracy train: 0.996364 val: 0.975758 test: 0.965753
max validation accuracy : 0.981818 max acc epoch : 19 test accuracy : 0.966667

Epoch :  21 loss training:  3.631530025159009 Time :  355
accuracy train: 0.995509 val: 0.980606 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 19 test accuracy : 0.966667

Epoch :  22 loss training:  2.9428929180139676 Time :  374
accuracy train: 0.996151 val: 0.970909 test: 0.968493
max validation accuracy : 0.981818 max acc epoch : 19 test accuracy : 0.966667

Epoch :  23 loss training:  2.659070572175551 Time :  386
accuracy train: 0.996151 val: 0.975758 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 19 test accuracy : 0.966667

Epoch :  24 loss training:  2.8756765086727683 Time :  399
accuracy train: 0.995937 val: 0.973333 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 19 test accuracy : 0.966667

Epoch :  25 loss training:  2.8253431302146055 Time :  422
accuracy train: 0.995937 val: 0.976970 test: 0.968493
max validation accuracy : 0.981818 max acc epoch : 19 test accuracy : 0.966667

Epoch :  26 loss training:  2.7125667969230562 Time :  437
accuracy train: 0.996364 val: 0.974545 test: 0.971689
max validation accuracy : 0.981818 max acc epoch : 19 test accuracy : 0.966667

Epoch :  27 loss training:  2.5276054874411784 Time :  447
accuracy train: 0.996151 val: 0.979394 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 19 test accuracy : 0.966667

Epoch :  28 loss training:  2.7266821470693685 Time :  465
accuracy train: 0.996151 val: 0.975758 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 19 test accuracy : 0.966667

Epoch :  29 loss training:  2.0239451882080175 Time :  483
accuracy train: 0.996578 val: 0.976970 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 19 test accuracy : 0.966667

Epoch :  30 loss training:  2.0509723496215884 Time :  504
accuracy train: 0.996578 val: 0.980606 test: 0.964840
max validation accuracy : 0.981818 max acc epoch : 19 test accuracy : 0.966667

========================================================================================================================================================================================================
best acc epoch :  19
validation accuracy :  0.9818181818181818
test accuracy :  0.9666666666666667
last test_accuracy :  0.9648401826484019
second best val :  0.9806060606060606
second best test :  0.9666666666666667
max gap 4
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=940, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  44.32590647414327 Time :  529
accuracy train: 0.964500 val: 0.956364 test: 0.961644
max validation accuracy : 0.956364 max acc epoch : 1 test accuracy : 0.961644
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.69253721088171 Time :  549
accuracy train: 0.970915 val: 0.961212 test: 0.962557
max validation accuracy : 0.961212 max acc epoch : 2 test accuracy : 0.962557
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.19780494319275 Time :  570
accuracy train: 0.977973 val: 0.963636 test: 0.969863
max validation accuracy : 0.963636 max acc epoch : 3 test accuracy : 0.969863
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.851969684707 Time :  587
accuracy train: 0.987382 val: 0.972121 test: 0.967580
max validation accuracy : 0.972121 max acc epoch : 4 test accuracy : 0.967580
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.1231145048514 Time :  602
accuracy train: 0.986955 val: 0.969697 test: 0.966210
max validation accuracy : 0.972121 max acc epoch : 4 test accuracy : 0.967580
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.877477917878423 Time :  612
accuracy train: 0.986741 val: 0.967273 test: 0.966210
max validation accuracy : 0.972121 max acc epoch : 4 test accuracy : 0.967580
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.230975839600433 Time :  630
accuracy train: 0.993157 val: 0.973333 test: 0.972146
max validation accuracy : 0.973333 max acc epoch : 7 test accuracy : 0.972146
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.699358284124173 Time :  648
accuracy train: 0.991018 val: 0.970909 test: 0.972603
max validation accuracy : 0.973333 max acc epoch : 7 test accuracy : 0.972146
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.27149600192206 Time :  665
accuracy train: 0.993584 val: 0.968485 test: 0.973059
max validation accuracy : 0.973333 max acc epoch : 7 test accuracy : 0.972146
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.5466914034914225 Time :  679
accuracy train: 0.993798 val: 0.973333 test: 0.971689
max validation accuracy : 0.973333 max acc epoch : 7 test accuracy : 0.972146

Epoch :  11 loss training:  5.029601787216961 Time :  697
accuracy train: 0.994867 val: 0.968485 test: 0.971689
max validation accuracy : 0.973333 max acc epoch : 7 test accuracy : 0.972146

Epoch :  12 loss training:  4.48864857130684 Time :  718
accuracy train: 0.994654 val: 0.969697 test: 0.967580
max validation accuracy : 0.973333 max acc epoch : 7 test accuracy : 0.972146

Epoch :  13 loss training:  5.068966240505688 Time :  735
accuracy train: 0.995509 val: 0.970909 test: 0.973516
max validation accuracy : 0.973333 max acc epoch : 7 test accuracy : 0.972146

Epoch :  14 loss training:  4.355029338039458 Time :  748
accuracy train: 0.994654 val: 0.973333 test: 0.969863
max validation accuracy : 0.973333 max acc epoch : 7 test accuracy : 0.972146

Epoch :  15 loss training:  3.9230344608658925 Time :  764
accuracy train: 0.995937 val: 0.970909 test: 0.970320
max validation accuracy : 0.973333 max acc epoch : 7 test accuracy : 0.972146

Epoch :  16 loss training:  3.8298967538867146 Time :  785
accuracy train: 0.994867 val: 0.976970 test: 0.969863
max validation accuracy : 0.976970 max acc epoch : 16 test accuracy : 0.969863

Epoch :  17 loss training:  3.337942549609579 Time :  804
accuracy train: 0.995937 val: 0.976970 test: 0.972603
max validation accuracy : 0.976970 max acc epoch : 16 test accuracy : 0.969863

Epoch :  18 loss training:  3.410239405464381 Time :  818
accuracy train: 0.995937 val: 0.973333 test: 0.969863
max validation accuracy : 0.976970 max acc epoch : 16 test accuracy : 0.969863

Epoch :  19 loss training:  3.245920712070074 Time :  831
accuracy train: 0.996364 val: 0.975758 test: 0.968493
max validation accuracy : 0.976970 max acc epoch : 16 test accuracy : 0.969863

Epoch :  20 loss training:  3.4182950651738793 Time :  850
accuracy train: 0.996578 val: 0.975758 test: 0.969406
max validation accuracy : 0.976970 max acc epoch : 16 test accuracy : 0.969863

Epoch :  21 loss training:  2.9085899984347634 Time :  875
accuracy train: 0.996364 val: 0.975758 test: 0.971689
max validation accuracy : 0.976970 max acc epoch : 16 test accuracy : 0.969863

Epoch :  22 loss training:  2.860159062431194 Time :  894
accuracy train: 0.996151 val: 0.972121 test: 0.970776
max validation accuracy : 0.976970 max acc epoch : 16 test accuracy : 0.969863

Epoch :  23 loss training:  2.5324803016264923 Time :  911
accuracy train: 0.996578 val: 0.970909 test: 0.970320
max validation accuracy : 0.976970 max acc epoch : 16 test accuracy : 0.969863

Epoch :  24 loss training:  2.31516527486383 Time :  925
accuracy train: 0.997006 val: 0.972121 test: 0.968037
max validation accuracy : 0.976970 max acc epoch : 16 test accuracy : 0.969863

Epoch :  25 loss training:  2.1349592878032126 Time :  942
accuracy train: 0.996578 val: 0.973333 test: 0.970320
max validation accuracy : 0.976970 max acc epoch : 16 test accuracy : 0.969863

Epoch :  26 loss training:  2.32426622127241 Time :  963
accuracy train: 0.996578 val: 0.973333 test: 0.967123
max validation accuracy : 0.976970 max acc epoch : 16 test accuracy : 0.969863

Epoch :  27 loss training:  2.5105380825989414 Time :  977
accuracy train: 0.996364 val: 0.973333 test: 0.967123
max validation accuracy : 0.976970 max acc epoch : 16 test accuracy : 0.969863

========================================================================================================================================================================================================
best acc epoch :  16
validation accuracy :  0.9769696969696969
test accuracy :  0.9698630136986301
last test_accuracy :  0.9671232876712329
second best val :  0.9757575757575757
second best test :  0.9698630136986301
max gap 9
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=697, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  43.681195511482656 Time :  998
accuracy train: 0.946963 val: 0.933333 test: 0.947489
max validation accuracy : 0.933333 max acc epoch : 1 test accuracy : 0.947489
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.217059787362814 Time :  1015
accuracy train: 0.976048 val: 0.964848 test: 0.958447
max validation accuracy : 0.964848 max acc epoch : 2 test accuracy : 0.958447
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.504132248461246 Time :  1031
accuracy train: 0.973909 val: 0.961212 test: 0.955251
max validation accuracy : 0.964848 max acc epoch : 2 test accuracy : 0.958447
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  12.244852226227522 Time :  1047
accuracy train: 0.986313 val: 0.966061 test: 0.965753
max validation accuracy : 0.966061 max acc epoch : 4 test accuracy : 0.965753
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.69759403495118 Time :  1064
accuracy train: 0.985458 val: 0.966061 test: 0.964384
max validation accuracy : 0.966061 max acc epoch : 4 test accuracy : 0.965753
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.973979232483543 Time :  1078
accuracy train: 0.990804 val: 0.973333 test: 0.964840
max validation accuracy : 0.973333 max acc epoch : 6 test accuracy : 0.964840
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.925123783759773 Time :  1090
accuracy train: 0.990163 val: 0.974545 test: 0.965297
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.965297
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.396056405734271 Time :  1103
accuracy train: 0.991660 val: 0.969697 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.965297
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.719688959652558 Time :  1122
accuracy train: 0.993157 val: 0.968485 test: 0.967123
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.965297
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.008804229903035 Time :  1139
accuracy train: 0.993370 val: 0.972121 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.965297

Epoch :  11 loss training:  5.569842351716943 Time :  1155
accuracy train: 0.993798 val: 0.973333 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.965297

Epoch :  12 loss training:  4.9216955887386575 Time :  1167
accuracy train: 0.994440 val: 0.973333 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.965297

Epoch :  13 loss training:  4.682725526858121 Time :  1186
accuracy train: 0.995509 val: 0.973333 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.965297

Epoch :  14 loss training:  5.1257014099974185 Time :  1207
accuracy train: 0.995509 val: 0.974545 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.965297

Epoch :  15 loss training:  4.169134231924545 Time :  1225
accuracy train: 0.995723 val: 0.973333 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.965297

Epoch :  16 loss training:  3.854769332683645 Time :  1239
accuracy train: 0.995723 val: 0.972121 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.965297

Epoch :  17 loss training:  3.937259945902042 Time :  1256
accuracy train: 0.995723 val: 0.973333 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.965297

Epoch :  18 loss training:  3.898494211724028 Time :  1276
accuracy train: 0.995723 val: 0.972121 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.965297

========================================================================================================================================================================================================
best acc epoch :  7
validation accuracy :  0.9745454545454545
test accuracy :  0.965296803652968
last test_accuracy :  0.9726027397260274
second best val :  0.9733333333333334
second best test :  0.9648401826484019
max gap 2
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=186, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  40.82523589208722 Time :  1348
accuracy train: 0.956373 val: 0.933333 test: 0.942009
max validation accuracy : 0.933333 max acc epoch : 1 test accuracy : 0.942009
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.837260054424405 Time :  1360
accuracy train: 0.975406 val: 0.961212 test: 0.948402
max validation accuracy : 0.961212 max acc epoch : 2 test accuracy : 0.948402
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.794387192931026 Time :  1372
accuracy train: 0.979470 val: 0.963636 test: 0.960731
max validation accuracy : 0.963636 max acc epoch : 3 test accuracy : 0.960731
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.53088590176776 Time :  1391
accuracy train: 0.988452 val: 0.964848 test: 0.966667
max validation accuracy : 0.964848 max acc epoch : 4 test accuracy : 0.966667
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.956437680870295 Time :  1411
accuracy train: 0.988452 val: 0.962424 test: 0.960274
max validation accuracy : 0.964848 max acc epoch : 4 test accuracy : 0.966667
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.212558230850846 Time :  1429
accuracy train: 0.989093 val: 0.968485 test: 0.964384
max validation accuracy : 0.968485 max acc epoch : 6 test accuracy : 0.964384
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.58792803180404 Time :  1444
accuracy train: 0.991018 val: 0.969697 test: 0.969863
max validation accuracy : 0.969697 max acc epoch : 7 test accuracy : 0.969863
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.818389926105738 Time :  1454
accuracy train: 0.991660 val: 0.969697 test: 0.969406
max validation accuracy : 0.969697 max acc epoch : 7 test accuracy : 0.969863
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.356384870246984 Time :  1468
accuracy train: 0.993370 val: 0.972121 test: 0.968037
max validation accuracy : 0.972121 max acc epoch : 9 test accuracy : 0.968037
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.7984837961848825 Time :  1485
accuracy train: 0.992301 val: 0.972121 test: 0.967123
max validation accuracy : 0.972121 max acc epoch : 9 test accuracy : 0.968037

Epoch :  11 loss training:  5.455979065271094 Time :  1504
accuracy train: 0.994226 val: 0.970909 test: 0.968037
max validation accuracy : 0.972121 max acc epoch : 9 test accuracy : 0.968037

Epoch :  12 loss training:  4.922822839813307 Time :  1517
accuracy train: 0.995081 val: 0.973333 test: 0.968493
max validation accuracy : 0.973333 max acc epoch : 12 test accuracy : 0.968493

Epoch :  13 loss training:  4.83602188678924 Time :  1529
accuracy train: 0.995295 val: 0.973333 test: 0.968037
max validation accuracy : 0.973333 max acc epoch : 12 test accuracy : 0.968493

Epoch :  14 loss training:  4.861127637035679 Time :  1548
accuracy train: 0.994867 val: 0.972121 test: 0.966667
max validation accuracy : 0.973333 max acc epoch : 12 test accuracy : 0.968493

Epoch :  15 loss training:  4.219975285464898 Time :  1568
accuracy train: 0.994867 val: 0.972121 test: 0.969406
max validation accuracy : 0.973333 max acc epoch : 12 test accuracy : 0.968493

Epoch :  16 loss training:  3.9286623417865485 Time :  1584
accuracy train: 0.995937 val: 0.972121 test: 0.967580
max validation accuracy : 0.973333 max acc epoch : 12 test accuracy : 0.968493

Epoch :  17 loss training:  3.4040363510139287 Time :  1597
accuracy train: 0.995081 val: 0.972121 test: 0.972146
max validation accuracy : 0.973333 max acc epoch : 12 test accuracy : 0.968493

Epoch :  18 loss training:  3.4565046234056354 Time :  1614
accuracy train: 0.995937 val: 0.972121 test: 0.968493
max validation accuracy : 0.973333 max acc epoch : 12 test accuracy : 0.968493

Epoch :  19 loss training:  3.4511793788988143 Time :  1633
accuracy train: 0.996151 val: 0.972121 test: 0.967123
max validation accuracy : 0.973333 max acc epoch : 12 test accuracy : 0.968493

Epoch :  20 loss training:  3.2149976640939713 Time :  1651
accuracy train: 0.996578 val: 0.972121 test: 0.969406
max validation accuracy : 0.973333 max acc epoch : 12 test accuracy : 0.968493

Epoch :  21 loss training:  2.8199997557676397 Time :  1664
accuracy train: 0.995937 val: 0.972121 test: 0.966210
max validation accuracy : 0.973333 max acc epoch : 12 test accuracy : 0.968493

Epoch :  22 loss training:  2.923227923864033 Time :  1676
accuracy train: 0.996151 val: 0.972121 test: 0.969406
max validation accuracy : 0.973333 max acc epoch : 12 test accuracy : 0.968493

Epoch :  23 loss training:  2.8288990613655187 Time :  1692
accuracy train: 0.996792 val: 0.974545 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 23 test accuracy : 0.968950

Epoch :  24 loss training:  2.823661646369146 Time :  1708
accuracy train: 0.996151 val: 0.972121 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 23 test accuracy : 0.968950

Epoch :  25 loss training:  2.5746451414597686 Time :  1722
accuracy train: 0.996578 val: 0.973333 test: 0.967123
max validation accuracy : 0.974545 max acc epoch : 23 test accuracy : 0.968950

Epoch :  26 loss training:  3.047294569085352 Time :  1733
accuracy train: 0.996364 val: 0.968485 test: 0.967123
max validation accuracy : 0.974545 max acc epoch : 23 test accuracy : 0.968950

Epoch :  27 loss training:  2.757335460279137 Time :  1747
accuracy train: 0.996364 val: 0.968485 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 23 test accuracy : 0.968950

Epoch :  28 loss training:  2.494125910307048 Time :  1765
accuracy train: 0.996364 val: 0.974545 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 23 test accuracy : 0.968950

Epoch :  29 loss training:  2.9217451286385767 Time :  1783
accuracy train: 0.996792 val: 0.974545 test: 0.967123
max validation accuracy : 0.974545 max acc epoch : 23 test accuracy : 0.968950

Epoch :  30 loss training:  2.5404859172413126 Time :  1800
accuracy train: 0.996792 val: 0.975758 test: 0.967580
max validation accuracy : 0.975758 max acc epoch : 30 test accuracy : 0.967580

Epoch :  31 loss training:  2.0843389687361196 Time :  1818
accuracy train: 0.997006 val: 0.975758 test: 0.968950
max validation accuracy : 0.975758 max acc epoch : 30 test accuracy : 0.967580

Epoch :  32 loss training:  2.091034100507386 Time :  1829
accuracy train: 0.997006 val: 0.976970 test: 0.971233
max validation accuracy : 0.976970 max acc epoch : 32 test accuracy : 0.971233

Epoch :  33 loss training:  1.9391639373207 Time :  1843
accuracy train: 0.996792 val: 0.969697 test: 0.967123
max validation accuracy : 0.976970 max acc epoch : 32 test accuracy : 0.971233

Epoch :  34 loss training:  2.4440138160571223 Time :  1861
accuracy train: 0.996792 val: 0.972121 test: 0.968950
max validation accuracy : 0.976970 max acc epoch : 32 test accuracy : 0.971233

Epoch :  35 loss training:  2.734949738114665 Time :  1878
accuracy train: 0.997006 val: 0.970909 test: 0.970320
max validation accuracy : 0.976970 max acc epoch : 32 test accuracy : 0.971233

Epoch :  36 loss training:  1.6960333507086034 Time :  1891
accuracy train: 0.997006 val: 0.975758 test: 0.968493
max validation accuracy : 0.976970 max acc epoch : 32 test accuracy : 0.971233

Epoch :  37 loss training:  1.7850882514903788 Time :  1901
accuracy train: 0.997006 val: 0.974545 test: 0.968950
max validation accuracy : 0.976970 max acc epoch : 32 test accuracy : 0.971233

Epoch :  38 loss training:  1.9212578118022066 Time :  1918
accuracy train: 0.997220 val: 0.975758 test: 0.967580
max validation accuracy : 0.976970 max acc epoch : 32 test accuracy : 0.971233

Epoch :  39 loss training:  2.261398670016206 Time :  1935
accuracy train: 0.997220 val: 0.974545 test: 0.966210
max validation accuracy : 0.976970 max acc epoch : 32 test accuracy : 0.971233

Epoch :  40 loss training:  1.6612814698310103 Time :  1951
accuracy train: 0.996792 val: 0.978182 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 40 test accuracy : 0.970776

Epoch :  41 loss training:  1.5527973730640952 Time :  1965
accuracy train: 0.997006 val: 0.972121 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 40 test accuracy : 0.970776

Epoch :  42 loss training:  2.295645636477275 Time :  1985
accuracy train: 0.997220 val: 0.972121 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 40 test accuracy : 0.970776

Epoch :  43 loss training:  1.4914833642033045 Time :  2000
accuracy train: 0.997220 val: 0.970909 test: 0.966667
max validation accuracy : 0.978182 max acc epoch : 40 test accuracy : 0.970776

Epoch :  44 loss training:  1.6495486576877738 Time :  2014
accuracy train: 0.997006 val: 0.975758 test: 0.967123
max validation accuracy : 0.978182 max acc epoch : 40 test accuracy : 0.970776

Epoch :  45 loss training:  1.7006741696532117 Time :  2024
accuracy train: 0.997006 val: 0.973333 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 40 test accuracy : 0.970776

Epoch :  46 loss training:  1.6702436802479497 Time :  2041
accuracy train: 0.997220 val: 0.973333 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 40 test accuracy : 0.970776

Epoch :  47 loss training:  1.4430393658112735 Time :  2056
accuracy train: 0.996792 val: 0.974545 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 40 test accuracy : 0.970776

Epoch :  48 loss training:  1.495160694596052 Time :  2072
accuracy train: 0.997006 val: 0.972121 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 40 test accuracy : 0.970776

Epoch :  49 loss training:  1.5772426580733736 Time :  2090
accuracy train: 0.997220 val: 0.974545 test: 0.967123
max validation accuracy : 0.978182 max acc epoch : 40 test accuracy : 0.970776

Epoch :  50 loss training:  1.768370872057858 Time :  2106
accuracy train: 0.997220 val: 0.975758 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 40 test accuracy : 0.970776

Epoch :  51 loss training:  1.6818913918032194 Time :  2124
accuracy train: 0.997006 val: 0.973333 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 40 test accuracy : 0.970776

========================================================================================================================================================================================================
best acc epoch :  40
validation accuracy :  0.9781818181818182
test accuracy :  0.9707762557077626
last test_accuracy :  0.9675799086757991
second best val :  0.9769696969696969
second best test :  0.9712328767123287
max gap 11
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  19 	 val_accuracy : 0.98182 	 test_accuracy : 0.96667 	 last test_accuracy : 0.96484 	 second best val : 0.98061 	 second best test : 0.96667
k :  1 	 best_acc epoch :  16 	 val_accuracy : 0.97697 	 test_accuracy : 0.96986 	 last test_accuracy : 0.96712 	 second best val : 0.97576 	 second best test : 0.96986
k :  2 	 best_acc epoch :  7 	 val_accuracy : 0.97455 	 test_accuracy : 0.96530 	 last test_accuracy : 0.97260 	 second best val : 0.97333 	 second best test : 0.96484
k :  3 	 best_acc epoch :  40 	 val_accuracy : 0.97818 	 test_accuracy : 0.97078 	 last test_accuracy : 0.96758 	 second best val : 0.97697 	 second best test : 0.97123

avg :  	 val_accuracy : 0.97788 	 test_accuracy : 0.96815 	 last_accuracy : 0.96804 	 second best val : 0.97667 	 second best test : 0.96815

std :  	 val_accuracy : 0.00262 	 test_accuracy : 0.00225 	 last_accuracy : 0.00283 	 second best val : 0.00262 	 second best test : 0.00253


date and time :  Tue Jun 15 10:51:02 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=60, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  41.21977474540472 Time :  57
accuracy train: 0.964072 val: 0.962424 test: 0.953881
max validation accuracy : 0.962424 max acc epoch : 1 test accuracy : 0.953881
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.486161708831787 Time :  70
accuracy train: 0.967707 val: 0.960000 test: 0.952055
max validation accuracy : 0.962424 max acc epoch : 1 test accuracy : 0.953881
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.799401483032852 Time :  84
accuracy train: 0.974765 val: 0.964848 test: 0.963470
max validation accuracy : 0.964848 max acc epoch : 3 test accuracy : 0.963470
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.000702216289937 Time :  103
accuracy train: 0.985030 val: 0.973333 test: 0.965297
max validation accuracy : 0.973333 max acc epoch : 4 test accuracy : 0.965297
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.429519067052752 Time :  120
accuracy train: 0.984602 val: 0.966061 test: 0.967580
max validation accuracy : 0.973333 max acc epoch : 4 test accuracy : 0.965297
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.103985889349133 Time :  137
accuracy train: 0.986313 val: 0.973333 test: 0.968493
max validation accuracy : 0.973333 max acc epoch : 4 test accuracy : 0.965297
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.508816781453788 Time :  151
accuracy train: 0.987382 val: 0.972121 test: 0.966667
max validation accuracy : 0.973333 max acc epoch : 4 test accuracy : 0.965297
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  7.201617178274319 Time :  170
accuracy train: 0.985458 val: 0.969697 test: 0.967580
max validation accuracy : 0.973333 max acc epoch : 4 test accuracy : 0.965297
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.579148190678097 Time :  189
accuracy train: 0.991018 val: 0.974545 test: 0.962557
max validation accuracy : 0.974545 max acc epoch : 9 test accuracy : 0.962557
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  6.148800233058864 Time :  207
accuracy train: 0.991873 val: 0.972121 test: 0.961644
max validation accuracy : 0.974545 max acc epoch : 9 test accuracy : 0.962557

Epoch :  11 loss training:  5.183172445860691 Time :  223
accuracy train: 0.993798 val: 0.978182 test: 0.965753
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.965753

Epoch :  12 loss training:  4.9238959375652485 Time :  238
accuracy train: 0.993584 val: 0.976970 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.965753

Epoch :  13 loss training:  4.783489491557702 Time :  257
accuracy train: 0.994654 val: 0.973333 test: 0.963014
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.965753

Epoch :  14 loss training:  5.696702547953464 Time :  277
accuracy train: 0.994867 val: 0.978182 test: 0.961644
max validation accuracy : 0.978182 max acc epoch : 11 test accuracy : 0.965753

Epoch :  15 loss training:  4.211885217460804 Time :  294
accuracy train: 0.994654 val: 0.979394 test: 0.968950
max validation accuracy : 0.979394 max acc epoch : 15 test accuracy : 0.968950

Epoch :  16 loss training:  4.404042632551864 Time :  312
accuracy train: 0.994867 val: 0.979394 test: 0.967123
max validation accuracy : 0.979394 max acc epoch : 15 test accuracy : 0.968950

Epoch :  17 loss training:  3.5311861390364356 Time :  335
accuracy train: 0.995723 val: 0.974545 test: 0.965297
max validation accuracy : 0.979394 max acc epoch : 15 test accuracy : 0.968950

Epoch :  18 loss training:  3.8076184698729776 Time :  362
accuracy train: 0.995723 val: 0.976970 test: 0.968037
max validation accuracy : 0.979394 max acc epoch : 15 test accuracy : 0.968950

Epoch :  19 loss training:  3.0361194436554797 Time :  383
accuracy train: 0.995509 val: 0.978182 test: 0.967123
max validation accuracy : 0.979394 max acc epoch : 15 test accuracy : 0.968950

Epoch :  20 loss training:  3.090860197902657 Time :  400
accuracy train: 0.995509 val: 0.975758 test: 0.964384
max validation accuracy : 0.979394 max acc epoch : 15 test accuracy : 0.968950

Epoch :  21 loss training:  3.358935965457931 Time :  421
accuracy train: 0.995509 val: 0.979394 test: 0.969863
max validation accuracy : 0.979394 max acc epoch : 15 test accuracy : 0.968950

Epoch :  22 loss training:  2.8495086532784626 Time :  439
accuracy train: 0.996364 val: 0.978182 test: 0.968037
max validation accuracy : 0.979394 max acc epoch : 15 test accuracy : 0.968950

Epoch :  23 loss training:  2.8850949527986813 Time :  454
accuracy train: 0.996151 val: 0.978182 test: 0.969863
max validation accuracy : 0.979394 max acc epoch : 15 test accuracy : 0.968950

Epoch :  24 loss training:  2.8779602199065266 Time :  476
accuracy train: 0.996151 val: 0.980606 test: 0.967123
max validation accuracy : 0.980606 max acc epoch : 24 test accuracy : 0.967123

Epoch :  25 loss training:  2.614629385760054 Time :  496
accuracy train: 0.996151 val: 0.979394 test: 0.967580
max validation accuracy : 0.980606 max acc epoch : 24 test accuracy : 0.967123

Epoch :  26 loss training:  2.8307405417144764 Time :  510
accuracy train: 0.996151 val: 0.976970 test: 0.966210
max validation accuracy : 0.980606 max acc epoch : 24 test accuracy : 0.967123

Epoch :  27 loss training:  2.521330082206987 Time :  537
accuracy train: 0.996151 val: 0.980606 test: 0.972603
max validation accuracy : 0.980606 max acc epoch : 24 test accuracy : 0.967123

Epoch :  28 loss training:  2.352831915661227 Time :  562
accuracy train: 0.996151 val: 0.981818 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.970776

Epoch :  29 loss training:  2.4861043780256296 Time :  581
accuracy train: 0.996792 val: 0.979394 test: 0.963470
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.970776

Epoch :  30 loss training:  2.72423321226961 Time :  595
accuracy train: 0.995937 val: 0.981818 test: 0.967123
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.970776

Epoch :  31 loss training:  2.23646856607229 Time :  617
accuracy train: 0.996364 val: 0.975758 test: 0.963014
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.970776

Epoch :  32 loss training:  2.395782909792615 Time :  633
accuracy train: 0.996792 val: 0.976970 test: 0.968950
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.970776

Epoch :  33 loss training:  2.068563960347092 Time :  652
accuracy train: 0.996578 val: 0.978182 test: 0.967580
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.970776

Epoch :  34 loss training:  2.001812026821426 Time :  671
accuracy train: 0.996578 val: 0.978182 test: 0.967580
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.970776

Epoch :  35 loss training:  1.9224150481750257 Time :  685
accuracy train: 0.996792 val: 0.980606 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.970776

Epoch :  36 loss training:  2.201005438386346 Time :  709
accuracy train: 0.996792 val: 0.980606 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.970776

Epoch :  37 loss training:  1.9305666728978395 Time :  733
accuracy train: 0.996792 val: 0.979394 test: 0.968037
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.970776

Epoch :  38 loss training:  2.032648766729835 Time :  754
accuracy train: 0.997006 val: 0.976970 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.970776

Epoch :  39 loss training:  2.070001121988753 Time :  769
accuracy train: 0.996792 val: 0.981818 test: 0.972146
max validation accuracy : 0.981818 max acc epoch : 28 test accuracy : 0.970776

========================================================================================================================================================================================================
best acc epoch :  28
validation accuracy :  0.9818181818181818
test accuracy :  0.9707762557077626
last test_accuracy :  0.9721461187214612
second best val :  0.9806060606060606
second best test :  0.9671232876712329
max gap 9
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=958, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  41.83187685906887 Time :  787
accuracy train: 0.949102 val: 0.950303 test: 0.936530
max validation accuracy : 0.950303 max acc epoch : 1 test accuracy : 0.936530
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.60149196255952 Time :  806
accuracy train: 0.948888 val: 0.949091 test: 0.954338
max validation accuracy : 0.950303 max acc epoch : 1 test accuracy : 0.936530
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.881322894245386 Time :  822
accuracy train: 0.968991 val: 0.963636 test: 0.961187
max validation accuracy : 0.963636 max acc epoch : 3 test accuracy : 0.961187
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.608281613327563 Time :  839
accuracy train: 0.973482 val: 0.961212 test: 0.963014
max validation accuracy : 0.963636 max acc epoch : 3 test accuracy : 0.961187
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.326012656558305 Time :  857
accuracy train: 0.979470 val: 0.961212 test: 0.963014
max validation accuracy : 0.963636 max acc epoch : 3 test accuracy : 0.961187
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.512585278193 Time :  877
accuracy train: 0.987382 val: 0.967273 test: 0.965753
max validation accuracy : 0.967273 max acc epoch : 6 test accuracy : 0.965753
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.48106964235194 Time :  894
accuracy train: 0.990163 val: 0.973333 test: 0.970776
max validation accuracy : 0.973333 max acc epoch : 7 test accuracy : 0.970776
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.975329469540156 Time :  909
accuracy train: 0.989735 val: 0.975758 test: 0.972603
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.972603
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.438254666980356 Time :  928
accuracy train: 0.992301 val: 0.978182 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.971233
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.64143830514513 Time :  950
accuracy train: 0.991446 val: 0.979394 test: 0.967123
max validation accuracy : 0.979394 max acc epoch : 10 test accuracy : 0.967123

Epoch :  11 loss training:  4.9865543524501845 Time :  965
accuracy train: 0.992515 val: 0.979394 test: 0.969406
max validation accuracy : 0.979394 max acc epoch : 10 test accuracy : 0.967123

Epoch :  12 loss training:  4.886014111572877 Time :  981
accuracy train: 0.994012 val: 0.978182 test: 0.967123
max validation accuracy : 0.979394 max acc epoch : 10 test accuracy : 0.967123

Epoch :  13 loss training:  4.559908397030085 Time :  1004
accuracy train: 0.992729 val: 0.976970 test: 0.972146
max validation accuracy : 0.979394 max acc epoch : 10 test accuracy : 0.967123

Epoch :  14 loss training:  4.321627611527219 Time :  1023
accuracy train: 0.994012 val: 0.978182 test: 0.969406
max validation accuracy : 0.979394 max acc epoch : 10 test accuracy : 0.967123

Epoch :  15 loss training:  4.362043467932381 Time :  1036
accuracy train: 0.993584 val: 0.976970 test: 0.964840
max validation accuracy : 0.979394 max acc epoch : 10 test accuracy : 0.967123

Epoch :  16 loss training:  4.133963816682808 Time :  1061
accuracy train: 0.994012 val: 0.980606 test: 0.971233
max validation accuracy : 0.980606 max acc epoch : 16 test accuracy : 0.971233

Epoch :  17 loss training:  4.0919612239231355 Time :  1084
accuracy train: 0.995509 val: 0.978182 test: 0.972146
max validation accuracy : 0.980606 max acc epoch : 16 test accuracy : 0.971233

Epoch :  18 loss training:  3.1595900006359443 Time :  1104
accuracy train: 0.995295 val: 0.976970 test: 0.972603
max validation accuracy : 0.980606 max acc epoch : 16 test accuracy : 0.971233

Epoch :  19 loss training:  3.52630208292976 Time :  1118
accuracy train: 0.995723 val: 0.975758 test: 0.970320
max validation accuracy : 0.980606 max acc epoch : 16 test accuracy : 0.971233

Epoch :  20 loss training:  3.254578905936796 Time :  1136
accuracy train: 0.996151 val: 0.980606 test: 0.971233
max validation accuracy : 0.980606 max acc epoch : 16 test accuracy : 0.971233

Epoch :  21 loss training:  2.969362554664258 Time :  1157
accuracy train: 0.995937 val: 0.980606 test: 0.970776
max validation accuracy : 0.980606 max acc epoch : 16 test accuracy : 0.971233

Epoch :  22 loss training:  3.0550744869105984 Time :  1174
accuracy train: 0.996364 val: 0.975758 test: 0.970320
max validation accuracy : 0.980606 max acc epoch : 16 test accuracy : 0.971233

Epoch :  23 loss training:  2.4517397689050995 Time :  1188
accuracy train: 0.996151 val: 0.976970 test: 0.971689
max validation accuracy : 0.980606 max acc epoch : 16 test accuracy : 0.971233

Epoch :  24 loss training:  3.189746985786769 Time :  1208
accuracy train: 0.995937 val: 0.976970 test: 0.972146
max validation accuracy : 0.980606 max acc epoch : 16 test accuracy : 0.971233

Epoch :  25 loss training:  3.014532831046381 Time :  1230
accuracy train: 0.996364 val: 0.972121 test: 0.968950
max validation accuracy : 0.980606 max acc epoch : 16 test accuracy : 0.971233

Epoch :  26 loss training:  3.3717552394227823 Time :  1247
accuracy train: 0.996578 val: 0.975758 test: 0.972146
max validation accuracy : 0.980606 max acc epoch : 16 test accuracy : 0.971233

Epoch :  27 loss training:  2.571641293267021 Time :  1263
accuracy train: 0.996578 val: 0.974545 test: 0.968037
max validation accuracy : 0.980606 max acc epoch : 16 test accuracy : 0.971233

========================================================================================================================================================================================================
best acc epoch :  16
validation accuracy :  0.9806060606060606
test accuracy :  0.9712328767123287
last test_accuracy :  0.9680365296803652
second best val :  0.9793939393939394
second best test :  0.9671232876712329
max gap 6
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=638, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  44.97569881379604 Time :  1318
accuracy train: 0.920873 val: 0.905455 test: 0.908676
max validation accuracy : 0.905455 max acc epoch : 1 test accuracy : 0.908676
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.468203105032444 Time :  1331
accuracy train: 0.976048 val: 0.958788 test: 0.957534
max validation accuracy : 0.958788 max acc epoch : 2 test accuracy : 0.957534
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.351839725859463 Time :  1347
accuracy train: 0.958939 val: 0.946667 test: 0.962100
max validation accuracy : 0.958788 max acc epoch : 2 test accuracy : 0.957534
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.88118888111785 Time :  1365
accuracy train: 0.983961 val: 0.966061 test: 0.959361
max validation accuracy : 0.966061 max acc epoch : 4 test accuracy : 0.959361
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.957571082282811 Time :  1382
accuracy train: 0.982891 val: 0.958788 test: 0.973059
max validation accuracy : 0.966061 max acc epoch : 4 test accuracy : 0.959361
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.8741490872344 Time :  1396
accuracy train: 0.986313 val: 0.962424 test: 0.970776
max validation accuracy : 0.966061 max acc epoch : 4 test accuracy : 0.959361
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.04219462024048 Time :  1418
accuracy train: 0.988024 val: 0.964848 test: 0.972146
max validation accuracy : 0.966061 max acc epoch : 4 test accuracy : 0.959361
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.824586010974599 Time :  1438
accuracy train: 0.988879 val: 0.969697 test: 0.975799
max validation accuracy : 0.969697 max acc epoch : 8 test accuracy : 0.975799
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.45837556256447 Time :  1461
accuracy train: 0.993157 val: 0.976970 test: 0.970320
max validation accuracy : 0.976970 max acc epoch : 9 test accuracy : 0.970320
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.283816937706433 Time :  1475
accuracy train: 0.993798 val: 0.974545 test: 0.968950
max validation accuracy : 0.976970 max acc epoch : 9 test accuracy : 0.970320

Epoch :  11 loss training:  5.316350853536278 Time :  1490
accuracy train: 0.992943 val: 0.970909 test: 0.973516
max validation accuracy : 0.976970 max acc epoch : 9 test accuracy : 0.970320

Epoch :  12 loss training:  4.871542719891295 Time :  1513
accuracy train: 0.994867 val: 0.973333 test: 0.970776
max validation accuracy : 0.976970 max acc epoch : 9 test accuracy : 0.970320

Epoch :  13 loss training:  4.3865938514936715 Time :  1531
accuracy train: 0.995509 val: 0.972121 test: 0.971233
max validation accuracy : 0.976970 max acc epoch : 9 test accuracy : 0.970320

Epoch :  14 loss training:  4.457529342966154 Time :  1544
accuracy train: 0.995295 val: 0.975758 test: 0.972603
max validation accuracy : 0.976970 max acc epoch : 9 test accuracy : 0.970320

Epoch :  15 loss training:  4.14133495464921 Time :  1567
accuracy train: 0.995509 val: 0.972121 test: 0.969863
max validation accuracy : 0.976970 max acc epoch : 9 test accuracy : 0.970320

Epoch :  16 loss training:  4.050092727411538 Time :  1586
accuracy train: 0.995723 val: 0.972121 test: 0.969406
max validation accuracy : 0.976970 max acc epoch : 9 test accuracy : 0.970320

Epoch :  17 loss training:  4.045297248288989 Time :  1603
accuracy train: 0.996151 val: 0.970909 test: 0.972603
max validation accuracy : 0.976970 max acc epoch : 9 test accuracy : 0.970320

Epoch :  18 loss training:  3.685153969563544 Time :  1621
accuracy train: 0.996151 val: 0.973333 test: 0.971689
max validation accuracy : 0.976970 max acc epoch : 9 test accuracy : 0.970320

Epoch :  19 loss training:  3.4499941582907923 Time :  1640
accuracy train: 0.996792 val: 0.967273 test: 0.972603
max validation accuracy : 0.976970 max acc epoch : 9 test accuracy : 0.970320

Epoch :  20 loss training:  2.700291825516615 Time :  1658
accuracy train: 0.996151 val: 0.969697 test: 0.973059
max validation accuracy : 0.976970 max acc epoch : 9 test accuracy : 0.970320

========================================================================================================================================================================================================
best acc epoch :  9
validation accuracy :  0.9769696969696969
test accuracy :  0.9703196347031964
last test_accuracy :  0.9730593607305936
second best val :  0.9757575757575757
second best test :  0.9703196347031964
max gap 4
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=134, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  43.743718983605504 Time :  1674
accuracy train: 0.960864 val: 0.951515 test: 0.957991
max validation accuracy : 0.951515 max acc epoch : 1 test accuracy : 0.957991
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.39848761074245 Time :  1692
accuracy train: 0.969846 val: 0.957576 test: 0.953425
max validation accuracy : 0.957576 max acc epoch : 2 test accuracy : 0.953425
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.396863866597414 Time :  1708
accuracy train: 0.960222 val: 0.934545 test: 0.950685
max validation accuracy : 0.957576 max acc epoch : 2 test accuracy : 0.953425
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.297019036486745 Time :  1726
accuracy train: 0.974551 val: 0.946667 test: 0.962100
max validation accuracy : 0.957576 max acc epoch : 2 test accuracy : 0.953425
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.655758067965508 Time :  1742
accuracy train: 0.984602 val: 0.956364 test: 0.963470
max validation accuracy : 0.957576 max acc epoch : 2 test accuracy : 0.953425
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.260176317300647 Time :  1761
accuracy train: 0.986955 val: 0.960000 test: 0.963014
max validation accuracy : 0.960000 max acc epoch : 6 test accuracy : 0.963014
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.046680839150213 Time :  1781
accuracy train: 0.989521 val: 0.969697 test: 0.967123
max validation accuracy : 0.969697 max acc epoch : 7 test accuracy : 0.967123
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.652331253280863 Time :  1799
accuracy train: 0.989949 val: 0.963636 test: 0.966210
max validation accuracy : 0.969697 max acc epoch : 7 test accuracy : 0.967123
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.1639034119434655 Time :  1811
accuracy train: 0.991873 val: 0.967273 test: 0.963470
max validation accuracy : 0.969697 max acc epoch : 7 test accuracy : 0.967123
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.840669447206892 Time :  1829
accuracy train: 0.992087 val: 0.967273 test: 0.961187
max validation accuracy : 0.969697 max acc epoch : 7 test accuracy : 0.967123

Epoch :  11 loss training:  5.283539851778187 Time :  1852
accuracy train: 0.992943 val: 0.968485 test: 0.964384
max validation accuracy : 0.969697 max acc epoch : 7 test accuracy : 0.967123

Epoch :  12 loss training:  4.6347855718340725 Time :  1869
accuracy train: 0.992729 val: 0.963636 test: 0.969863
max validation accuracy : 0.969697 max acc epoch : 7 test accuracy : 0.967123

Epoch :  13 loss training:  4.887309150770307 Time :  1888
accuracy train: 0.993584 val: 0.968485 test: 0.966210
max validation accuracy : 0.969697 max acc epoch : 7 test accuracy : 0.967123

Epoch :  14 loss training:  4.424028918612748 Time :  1910
accuracy train: 0.994012 val: 0.969697 test: 0.968037
max validation accuracy : 0.969697 max acc epoch : 7 test accuracy : 0.967123

Epoch :  15 loss training:  4.2661209995276295 Time :  1941
accuracy train: 0.994867 val: 0.972121 test: 0.964840
max validation accuracy : 0.972121 max acc epoch : 15 test accuracy : 0.964840

Epoch :  16 loss training:  3.9958267101901583 Time :  1957
accuracy train: 0.995723 val: 0.972121 test: 0.965753
max validation accuracy : 0.972121 max acc epoch : 15 test accuracy : 0.964840

Epoch :  17 loss training:  3.760326632997021 Time :  1976
accuracy train: 0.995937 val: 0.968485 test: 0.967123
max validation accuracy : 0.972121 max acc epoch : 15 test accuracy : 0.964840

Epoch :  18 loss training:  3.498688204534119 Time :  2000
accuracy train: 0.995295 val: 0.968485 test: 0.963927
max validation accuracy : 0.972121 max acc epoch : 15 test accuracy : 0.964840

Epoch :  19 loss training:  3.4261704063101206 Time :  2017
accuracy train: 0.996151 val: 0.972121 test: 0.964384
max validation accuracy : 0.972121 max acc epoch : 15 test accuracy : 0.964840

Epoch :  20 loss training:  3.0827034741523676 Time :  2034
accuracy train: 0.996151 val: 0.969697 test: 0.964384
max validation accuracy : 0.972121 max acc epoch : 15 test accuracy : 0.964840

Epoch :  21 loss training:  3.423242148506688 Time :  2059
accuracy train: 0.996364 val: 0.970909 test: 0.963927
max validation accuracy : 0.972121 max acc epoch : 15 test accuracy : 0.964840

Epoch :  22 loss training:  3.030667821643874 Time :  2079
accuracy train: 0.995937 val: 0.970909 test: 0.963927
max validation accuracy : 0.972121 max acc epoch : 15 test accuracy : 0.964840

Epoch :  23 loss training:  2.567033748724498 Time :  2093
accuracy train: 0.995723 val: 0.967273 test: 0.965297
max validation accuracy : 0.972121 max acc epoch : 15 test accuracy : 0.964840

Epoch :  24 loss training:  2.5607084782241145 Time :  2122
accuracy train: 0.995723 val: 0.969697 test: 0.965297
max validation accuracy : 0.972121 max acc epoch : 15 test accuracy : 0.964840

Epoch :  25 loss training:  2.649231824907474 Time :  2146
accuracy train: 0.996364 val: 0.969697 test: 0.970320
max validation accuracy : 0.972121 max acc epoch : 15 test accuracy : 0.964840

Epoch :  26 loss training:  2.377009969452047 Time :  2164
accuracy train: 0.996578 val: 0.972121 test: 0.965753
max validation accuracy : 0.972121 max acc epoch : 15 test accuracy : 0.964840

========================================================================================================================================================================================================
best acc epoch :  15
validation accuracy :  0.9721212121212122
test accuracy :  0.9648401826484019
last test_accuracy :  0.9657534246575342
second best val :  0.9709090909090909
second best test :  0.9648401826484019
max gap 8
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  28 	 val_accuracy : 0.98182 	 test_accuracy : 0.97078 	 last test_accuracy : 0.97215 	 second best val : 0.98061 	 second best test : 0.96712
k :  1 	 best_acc epoch :  16 	 val_accuracy : 0.98061 	 test_accuracy : 0.97123 	 last test_accuracy : 0.96804 	 second best val : 0.97939 	 second best test : 0.96712
k :  2 	 best_acc epoch :  9 	 val_accuracy : 0.97697 	 test_accuracy : 0.97032 	 last test_accuracy : 0.97306 	 second best val : 0.97576 	 second best test : 0.97032
k :  3 	 best_acc epoch :  15 	 val_accuracy : 0.97212 	 test_accuracy : 0.96484 	 last test_accuracy : 0.96575 	 second best val : 0.97091 	 second best test : 0.96484

avg :  	 val_accuracy : 0.97788 	 test_accuracy : 0.96929 	 last_accuracy : 0.96975 	 second best val : 0.97667 	 second best test : 0.96735

std :  	 val_accuracy : 0.00377 	 test_accuracy : 0.00259 	 last_accuracy : 0.00298 	 second best val : 0.00377 	 second best test : 0.00195


date and time :  Tue Jun 15 11:27:17 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=19, tsne=True, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  39.99401405081153 Time :  26
accuracy train: 0.939478 val: 0.913939 test: 0.928767
max validation accuracy : 0.913939 max acc epoch : 1 test accuracy : 0.928767
Counter({0: 4065, 1: 3626})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  16.644602965563536 Time :  64
accuracy train: 0.967066 val: 0.957576 test: 0.954795
max validation accuracy : 0.957576 max acc epoch : 2 test accuracy : 0.954795
Counter({0: 4009, 1: 3682})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.54393265489489 Time :  83
accuracy train: 0.973482 val: 0.962424 test: 0.951598
max validation accuracy : 0.962424 max acc epoch : 3 test accuracy : 0.951598
Counter({0: 3893, 1: 3798})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.92321592872031 Time :  111
accuracy train: 0.983105 val: 0.976970 test: 0.966667
max validation accuracy : 0.976970 max acc epoch : 4 test accuracy : 0.966667
Counter({1: 3891, 0: 3800})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.804349772399291 Time :  153
accuracy train: 0.985030 val: 0.961212 test: 0.966667
max validation accuracy : 0.976970 max acc epoch : 4 test accuracy : 0.966667
Counter({0: 3883, 1: 3808})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.005153228761628 Time :  183
accuracy train: 0.987169 val: 0.970909 test: 0.966667
max validation accuracy : 0.976970 max acc epoch : 4 test accuracy : 0.966667
Counter({1: 3888, 0: 3803})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.831026678206399 Time :  204
accuracy train: 0.989307 val: 0.967273 test: 0.967123
max validation accuracy : 0.976970 max acc epoch : 4 test accuracy : 0.966667
Counter({0: 3880, 1: 3811})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.780566698056646 Time :  241
accuracy train: 0.990804 val: 0.967273 test: 0.968950
max validation accuracy : 0.976970 max acc epoch : 4 test accuracy : 0.966667
Counter({1: 3872, 0: 3819})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.988485576817766 Time :  261
accuracy train: 0.990804 val: 0.968485 test: 0.969863
max validation accuracy : 0.976970 max acc epoch : 4 test accuracy : 0.966667
Counter({0: 3863, 1: 3828})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.306401191599434 Time :  294
accuracy train: 0.991873 val: 0.964848 test: 0.968037
max validation accuracy : 0.976970 max acc epoch : 4 test accuracy : 0.966667
Counter({1: 3866, 0: 3825})

Epoch :  11 loss training:  4.826976440686849 Time :  332
accuracy train: 0.993798 val: 0.963636 test: 0.971233
max validation accuracy : 0.976970 max acc epoch : 4 test accuracy : 0.966667
Counter({0: 3855, 1: 3836})

Epoch :  12 loss training:  4.394331084622536 Time :  361
accuracy train: 0.994012 val: 0.970909 test: 0.975342
max validation accuracy : 0.976970 max acc epoch : 4 test accuracy : 0.966667
Counter({1: 3852, 0: 3839})

Epoch :  13 loss training:  4.802588563878089 Time :  397
accuracy train: 0.995295 val: 0.972121 test: 0.968950
max validation accuracy : 0.976970 max acc epoch : 4 test accuracy : 0.966667
Counter({0: 3850, 1: 3841})

Epoch :  14 loss training:  4.57983612595126 Time :  433
accuracy train: 0.993370 val: 0.963636 test: 0.966667
max validation accuracy : 0.976970 max acc epoch : 4 test accuracy : 0.966667
Counter({0: 3849, 1: 3842})

Epoch :  15 loss training:  3.5444890909129754 Time :  459
accuracy train: 0.995509 val: 0.969697 test: 0.970320
max validation accuracy : 0.976970 max acc epoch : 4 test accuracy : 0.966667
Counter({1: 3855, 0: 3836})

========================================================================================================================================================================================================
best acc epoch :  4
validation accuracy :  0.9769696969696969
test accuracy :  0.9666666666666667
last test_accuracy :  0.9703196347031964
second best val :  0.9721212121212122
second best test :  0.9666666666666667
max gap 1
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=361, tsne=True, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  41.258030358701944 Time :  830
accuracy train: 0.958084 val: 0.941818 test: 0.950685
max validation accuracy : 0.941818 max acc epoch : 1 test accuracy : 0.950685
Counter({1: 4142, 0: 3549})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  20.316969354636967 Time :  871
accuracy train: 0.965997 val: 0.963636 test: 0.952511
max validation accuracy : 0.963636 max acc epoch : 2 test accuracy : 0.952511
Counter({0: 3964, 1: 3727})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.138939218828455 Time :  894
accuracy train: 0.959795 val: 0.951515 test: 0.946575
max validation accuracy : 0.963636 max acc epoch : 2 test accuracy : 0.952511
Counter({1: 3920, 0: 3771})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  12.162104405462742 Time :  924
accuracy train: 0.984602 val: 0.973333 test: 0.960731
max validation accuracy : 0.973333 max acc epoch : 4 test accuracy : 0.960731
Counter({0: 3888, 1: 3803})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.722436397569254 Time :  963
accuracy train: 0.980325 val: 0.963636 test: 0.961187
max validation accuracy : 0.973333 max acc epoch : 4 test accuracy : 0.960731
Counter({1: 3848, 0: 3843})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.581109157414176 Time :  982
accuracy train: 0.980967 val: 0.967273 test: 0.970776
max validation accuracy : 0.973333 max acc epoch : 4 test accuracy : 0.960731
Counter({0: 3878, 1: 3813})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.409947319189087 Time :  1026
accuracy train: 0.989521 val: 0.978182 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.973516
Counter({0: 3859, 1: 3832})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.538967113861872 Time :  1066
accuracy train: 0.990804 val: 0.976970 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.973516
Counter({1: 3879, 0: 3812})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.740319209056906 Time :  1103
accuracy train: 0.990376 val: 0.974545 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.973516
Counter({0: 3856, 1: 3835})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.735028035007417 Time :  1139
accuracy train: 0.990376 val: 0.975758 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.973516
Counter({0: 3854, 1: 3837})

Epoch :  11 loss training:  5.347555198241025 Time :  1162
accuracy train: 0.992301 val: 0.979394 test: 0.972603
max validation accuracy : 0.979394 max acc epoch : 11 test accuracy : 0.972603
Counter({1: 3855, 0: 3836})

Epoch :  12 loss training:  4.8214148682309315 Time :  1200
accuracy train: 0.992515 val: 0.978182 test: 0.971689
max validation accuracy : 0.979394 max acc epoch : 11 test accuracy : 0.972603
Counter({1: 3856, 0: 3835})

Epoch :  13 loss training:  5.213266080943868 Time :  1243
accuracy train: 0.993584 val: 0.976970 test: 0.969863
max validation accuracy : 0.979394 max acc epoch : 11 test accuracy : 0.972603
Counter({1: 3880, 0: 3811})

Epoch :  14 loss training:  3.9319137848215178 Time :  1263
accuracy train: 0.992301 val: 0.975758 test: 0.973973
max validation accuracy : 0.979394 max acc epoch : 11 test accuracy : 0.972603
Counter({0: 3874, 1: 3817})

Epoch :  15 loss training:  4.141929392586462 Time :  1300
accuracy train: 0.993798 val: 0.978182 test: 0.973516
max validation accuracy : 0.979394 max acc epoch : 11 test accuracy : 0.972603
Counter({1: 3872, 0: 3819})

Epoch :  16 loss training:  4.2141277469927445 Time :  1321
accuracy train: 0.992943 val: 0.973333 test: 0.971689
max validation accuracy : 0.979394 max acc epoch : 11 test accuracy : 0.972603
Counter({1: 3874, 0: 3817})

Epoch :  17 loss training:  3.286201995884767 Time :  1353
accuracy train: 0.994654 val: 0.978182 test: 0.969406
max validation accuracy : 0.979394 max acc epoch : 11 test accuracy : 0.972603
Counter({1: 3890, 0: 3801})

Epoch :  18 loss training:  3.603422678192146 Time :  1388
accuracy train: 0.994440 val: 0.976970 test: 0.972146
max validation accuracy : 0.979394 max acc epoch : 11 test accuracy : 0.972603
Counter({0: 3889, 1: 3802})

Epoch :  19 loss training:  3.4784262438770384 Time :  1412
accuracy train: 0.995081 val: 0.974545 test: 0.970776
max validation accuracy : 0.979394 max acc epoch : 11 test accuracy : 0.972603
Counter({0: 3898, 1: 3793})

Epoch :  20 loss training:  3.043389984697569 Time :  1440
accuracy train: 0.995295 val: 0.976970 test: 0.973059
max validation accuracy : 0.979394 max acc epoch : 11 test accuracy : 0.972603
Counter({0: 3901, 1: 3790})

Epoch :  21 loss training:  3.5338227210449986 Time :  1476
accuracy train: 0.995937 val: 0.970909 test: 0.976256
max validation accuracy : 0.979394 max acc epoch : 11 test accuracy : 0.972603
Counter({0: 3905, 1: 3786})

Epoch :  22 loss training:  2.7678261560504325 Time :  1495
accuracy train: 0.995509 val: 0.975758 test: 0.968037
max validation accuracy : 0.979394 max acc epoch : 11 test accuracy : 0.972603
Counter({1: 3904, 0: 3787})

========================================================================================================================================================================================================
best acc epoch :  11
validation accuracy :  0.9793939393939394
test accuracy :  0.9726027397260274
last test_accuracy :  0.9680365296803652
second best val :  0.9781818181818182
second best test :  0.9735159817351599
max gap 4
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=8, tsne=True, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  41.846174743026495 Time :  1941
accuracy train: 0.959153 val: 0.951515 test: 0.949315
max validation accuracy : 0.951515 max acc epoch : 1 test accuracy : 0.949315
Counter({0: 4154, 1: 3537})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.675763274077326 Time :  1979
accuracy train: 0.958512 val: 0.951515 test: 0.945205
max validation accuracy : 0.951515 max acc epoch : 1 test accuracy : 0.949315
Counter({1: 4012, 0: 3679})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  17.225443850271404 Time :  2015
accuracy train: 0.979042 val: 0.967273 test: 0.963470
max validation accuracy : 0.967273 max acc epoch : 3 test accuracy : 0.963470
Counter({0: 3964, 1: 3727})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.146615884732455 Time :  2041
accuracy train: 0.985244 val: 0.973333 test: 0.961187
max validation accuracy : 0.973333 max acc epoch : 4 test accuracy : 0.961187
Counter({1: 3916, 0: 3775})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.241811452899128 Time :  2077
accuracy train: 0.986313 val: 0.974545 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 5 test accuracy : 0.968037
Counter({1: 3916, 0: 3775})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.738662030780688 Time :  2103
accuracy train: 0.985885 val: 0.976970 test: 0.968950
max validation accuracy : 0.976970 max acc epoch : 6 test accuracy : 0.968950
Counter({1: 3939, 0: 3752})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  8.256767212413251 Time :  2140
accuracy train: 0.987596 val: 0.976970 test: 0.968493
max validation accuracy : 0.976970 max acc epoch : 6 test accuracy : 0.968950
Counter({0: 3945, 1: 3746})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  7.234680267749354 Time :  2176
accuracy train: 0.990376 val: 0.978182 test: 0.966210
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.966210
Counter({1: 3911, 0: 3780})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  7.10777403449174 Time :  2196
accuracy train: 0.990376 val: 0.974545 test: 0.964384
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.966210
Counter({0: 3900, 1: 3791})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.924928479187656 Time :  2230
accuracy train: 0.990804 val: 0.978182 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.966210
Counter({0: 3888, 1: 3803})

Epoch :  11 loss training:  6.158743424573913 Time :  2260
accuracy train: 0.990804 val: 0.978182 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.966210
Counter({0: 3869, 1: 3822})

Epoch :  12 loss training:  6.454404487740248 Time :  2286
accuracy train: 0.994012 val: 0.975758 test: 0.965753
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.966210
Counter({1: 3859, 0: 3832})

Epoch :  13 loss training:  5.204317974625155 Time :  2331
accuracy train: 0.994226 val: 0.976970 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.966210
Counter({0: 3852, 1: 3839})

Epoch :  14 loss training:  4.769610175280832 Time :  2362
accuracy train: 0.995081 val: 0.975758 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.966210
Counter({1: 3853, 0: 3838})

Epoch :  15 loss training:  4.331580232130364 Time :  2395
accuracy train: 0.995081 val: 0.978182 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.966210
Counter({0: 3846, 1: 3845})

Epoch :  16 loss training:  4.110665124549996 Time :  2431
accuracy train: 0.994654 val: 0.978182 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.966210
Counter({0: 3848, 1: 3843})

Epoch :  17 loss training:  3.7316583173233084 Time :  2457
accuracy train: 0.995081 val: 0.978182 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.966210
Counter({0: 3847, 1: 3844})

Epoch :  18 loss training:  3.574939781683497 Time :  2495
accuracy train: 0.995723 val: 0.979394 test: 0.971689
max validation accuracy : 0.979394 max acc epoch : 18 test accuracy : 0.971689
Counter({1: 3846, 0: 3845})

Epoch :  19 loss training:  3.803605340537615 Time :  2523
accuracy train: 0.995723 val: 0.980606 test: 0.976256
max validation accuracy : 0.980606 max acc epoch : 19 test accuracy : 0.976256
Counter({0: 3857, 1: 3834})

Epoch :  20 loss training:  3.4503976366249844 Time :  2560
accuracy train: 0.995937 val: 0.978182 test: 0.971233
max validation accuracy : 0.980606 max acc epoch : 19 test accuracy : 0.976256
Counter({0: 3861, 1: 3830})

Epoch :  21 loss training:  2.8279867420205846 Time :  2581
accuracy train: 0.996151 val: 0.975758 test: 0.972603
max validation accuracy : 0.980606 max acc epoch : 19 test accuracy : 0.976256
Counter({0: 3863, 1: 3828})

Epoch :  22 loss training:  2.8583003931562416 Time :  2616
accuracy train: 0.995081 val: 0.975758 test: 0.975342
max validation accuracy : 0.980606 max acc epoch : 19 test accuracy : 0.976256
Counter({1: 3871, 0: 3820})

Epoch :  23 loss training:  3.187164188537281 Time :  2653
accuracy train: 0.996151 val: 0.978182 test: 0.971233
max validation accuracy : 0.980606 max acc epoch : 19 test accuracy : 0.976256
Counter({1: 3870, 0: 3821})

Epoch :  24 loss training:  2.430824835464591 Time :  2688
accuracy train: 0.996151 val: 0.980606 test: 0.971689
max validation accuracy : 0.980606 max acc epoch : 19 test accuracy : 0.976256
Counter({1: 3876, 0: 3815})

Epoch :  25 loss training:  2.7571375115949195 Time :  2728
accuracy train: 0.995937 val: 0.975758 test: 0.969863
max validation accuracy : 0.980606 max acc epoch : 19 test accuracy : 0.976256
Counter({0: 3871, 1: 3820})

Epoch :  26 loss training:  2.5875452219042927 Time :  2750
accuracy train: 0.996151 val: 0.978182 test: 0.970776
max validation accuracy : 0.980606 max acc epoch : 19 test accuracy : 0.976256
Counter({0: 3882, 1: 3809})

Epoch :  27 loss training:  2.5181099633919075 Time :  2782
accuracy train: 0.995723 val: 0.978182 test: 0.972146
max validation accuracy : 0.980606 max acc epoch : 19 test accuracy : 0.976256
Counter({1: 3874, 0: 3817})

Epoch :  28 loss training:  2.154776718118228 Time :  2816
accuracy train: 0.996578 val: 0.975758 test: 0.971689
max validation accuracy : 0.980606 max acc epoch : 19 test accuracy : 0.976256
Counter({0: 3876, 1: 3815})

Epoch :  29 loss training:  2.1540591336524813 Time :  2848
accuracy train: 0.997006 val: 0.974545 test: 0.972603
max validation accuracy : 0.980606 max acc epoch : 19 test accuracy : 0.976256
Counter({1: 3885, 0: 3806})

Epoch :  30 loss training:  1.931279213516973 Time :  2886
accuracy train: 0.996578 val: 0.975758 test: 0.973973
max validation accuracy : 0.980606 max acc epoch : 19 test accuracy : 0.976256
Counter({0: 3880, 1: 3811})

========================================================================================================================================================================================================
best acc epoch :  19
validation accuracy :  0.9806060606060606
test accuracy :  0.9762557077625571
last test_accuracy :  0.9739726027397261
second best val :  0.9793939393939394
second best test :  0.971689497716895
max gap 10
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=452, tsne=True, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  42.25851323083043 Time :  3256
accuracy train: 0.961292 val: 0.940606 test: 0.957991
max validation accuracy : 0.940606 max acc epoch : 1 test accuracy : 0.957991
Counter({1: 4132, 0: 3559})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  16.506771724671125 Time :  3303
accuracy train: 0.968563 val: 0.941818 test: 0.962557
max validation accuracy : 0.941818 max acc epoch : 2 test accuracy : 0.962557
Counter({0: 4087, 1: 3604})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.8458934831433 Time :  3341
accuracy train: 0.976903 val: 0.950303 test: 0.966667
max validation accuracy : 0.950303 max acc epoch : 3 test accuracy : 0.966667
Counter({1: 4109, 0: 3582})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.9515998698771 Time :  3379
accuracy train: 0.975620 val: 0.952727 test: 0.962557
max validation accuracy : 0.952727 max acc epoch : 4 test accuracy : 0.962557
Counter({0: 4043, 1: 3648})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.784641201142222 Time :  3399
accuracy train: 0.980967 val: 0.955152 test: 0.964840
max validation accuracy : 0.955152 max acc epoch : 5 test accuracy : 0.964840
Counter({1: 3997, 0: 3694})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.821257769770455 Time :  3445
accuracy train: 0.983747 val: 0.957576 test: 0.966210
max validation accuracy : 0.957576 max acc epoch : 6 test accuracy : 0.966210
Counter({1: 3995, 0: 3696})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.372686081798747 Time :  3492
accuracy train: 0.986955 val: 0.961212 test: 0.968037
max validation accuracy : 0.961212 max acc epoch : 7 test accuracy : 0.968037
Counter({0: 3980, 1: 3711})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.597308472497389 Time :  3529
accuracy train: 0.991660 val: 0.962424 test: 0.971689
max validation accuracy : 0.962424 max acc epoch : 8 test accuracy : 0.971689
Counter({0: 3975, 1: 3716})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.286213255836628 Time :  3571
accuracy train: 0.988666 val: 0.955152 test: 0.973516
max validation accuracy : 0.962424 max acc epoch : 8 test accuracy : 0.971689
Counter({1: 3967, 0: 3724})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.623725073295645 Time :  3611
accuracy train: 0.991873 val: 0.961212 test: 0.966667
max validation accuracy : 0.962424 max acc epoch : 8 test accuracy : 0.971689
Counter({0: 3942, 1: 3749})

Epoch :  11 loss training:  5.153296063421294 Time :  3644
accuracy train: 0.993584 val: 0.962424 test: 0.972603
max validation accuracy : 0.962424 max acc epoch : 8 test accuracy : 0.971689
Counter({0: 3940, 1: 3751})

Epoch :  12 loss training:  5.250555280421395 Time :  3665
accuracy train: 0.994654 val: 0.961212 test: 0.970776
max validation accuracy : 0.962424 max acc epoch : 8 test accuracy : 0.971689
Counter({1: 3943, 0: 3748})

Epoch :  13 loss training:  4.525605445262045 Time :  3709
accuracy train: 0.994654 val: 0.963636 test: 0.968493
max validation accuracy : 0.963636 max acc epoch : 13 test accuracy : 0.968493
Counter({1: 3932, 0: 3759})

Epoch :  14 loss training:  4.598156624240801 Time :  3746
accuracy train: 0.995509 val: 0.966061 test: 0.968493
max validation accuracy : 0.966061 max acc epoch : 14 test accuracy : 0.968493
Counter({1: 3933, 0: 3758})

Epoch :  15 loss training:  4.068127203379845 Time :  3774
accuracy train: 0.994867 val: 0.962424 test: 0.970776
max validation accuracy : 0.966061 max acc epoch : 14 test accuracy : 0.968493
Counter({0: 3901, 1: 3790})

Epoch :  16 loss training:  3.6193127961014397 Time :  3820
accuracy train: 0.995509 val: 0.961212 test: 0.968950
max validation accuracy : 0.966061 max acc epoch : 14 test accuracy : 0.968493
Counter({1: 3894, 0: 3797})

Epoch :  17 loss training:  3.449488115205895 Time :  3844
accuracy train: 0.994012 val: 0.962424 test: 0.971233
max validation accuracy : 0.966061 max acc epoch : 14 test accuracy : 0.968493
Counter({1: 3883, 0: 3808})

Epoch :  18 loss training:  3.5736820069141686 Time :  3875
accuracy train: 0.996151 val: 0.963636 test: 0.973973
max validation accuracy : 0.966061 max acc epoch : 14 test accuracy : 0.968493
Counter({0: 3888, 1: 3803})

Epoch :  19 loss training:  3.2946040939423256 Time :  3916
accuracy train: 0.996364 val: 0.960000 test: 0.969406
max validation accuracy : 0.966061 max acc epoch : 14 test accuracy : 0.968493
Counter({1: 3873, 0: 3818})

Epoch :  20 loss training:  2.677606077333621 Time :  3944
accuracy train: 0.996578 val: 0.962424 test: 0.967123
max validation accuracy : 0.966061 max acc epoch : 14 test accuracy : 0.968493
Counter({1: 3861, 0: 3830})

Epoch :  21 loss training:  2.858812645656144 Time :  3987
accuracy train: 0.996364 val: 0.961212 test: 0.970320
max validation accuracy : 0.966061 max acc epoch : 14 test accuracy : 0.968493
Counter({0: 3879, 1: 3812})

Epoch :  22 loss training:  2.546465900290059 Time :  4028
accuracy train: 0.996792 val: 0.963636 test: 0.971233
max validation accuracy : 0.966061 max acc epoch : 14 test accuracy : 0.968493
Counter({0: 3869, 1: 3822})

Epoch :  23 loss training:  2.757357273483649 Time :  4052
accuracy train: 0.996792 val: 0.964848 test: 0.973516
max validation accuracy : 0.966061 max acc epoch : 14 test accuracy : 0.968493
Counter({1: 3872, 0: 3819})

Epoch :  24 loss training:  2.277541807387024 Time :  4098
accuracy train: 0.996364 val: 0.963636 test: 0.972146
max validation accuracy : 0.966061 max acc epoch : 14 test accuracy : 0.968493
Counter({0: 3860, 1: 3831})

Epoch :  25 loss training:  2.3792660816106945 Time :  4131
accuracy train: 0.996792 val: 0.967273 test: 0.967123
max validation accuracy : 0.967273 max acc epoch : 25 test accuracy : 0.967123
Counter({1: 3863, 0: 3828})

Epoch :  26 loss training:  2.215086877695285 Time :  4161
accuracy train: 0.996792 val: 0.963636 test: 0.967580
max validation accuracy : 0.967273 max acc epoch : 25 test accuracy : 0.967123
Counter({0: 3864, 1: 3827})

Epoch :  27 loss training:  2.108481552088051 Time :  4201
accuracy train: 0.996578 val: 0.964848 test: 0.969863
max validation accuracy : 0.967273 max acc epoch : 25 test accuracy : 0.967123
Counter({1: 3859, 0: 3832})

Epoch :  28 loss training:  1.8991088533657603 Time :  4224
accuracy train: 0.996792 val: 0.958788 test: 0.973059
max validation accuracy : 0.967273 max acc epoch : 25 test accuracy : 0.967123
Counter({0: 3868, 1: 3823})

Epoch :  29 loss training:  1.8458441590773873 Time :  4252
accuracy train: 0.996792 val: 0.962424 test: 0.973059
max validation accuracy : 0.967273 max acc epoch : 25 test accuracy : 0.967123
Counter({0: 3864, 1: 3827})

Epoch :  30 loss training:  2.3047845656838035 Time :  4297
accuracy train: 0.997006 val: 0.964848 test: 0.968950
max validation accuracy : 0.967273 max acc epoch : 25 test accuracy : 0.967123
Counter({0: 3851, 1: 3840})

Epoch :  31 loss training:  1.739635239544441 Time :  4318
accuracy train: 0.997220 val: 0.962424 test: 0.968493
max validation accuracy : 0.967273 max acc epoch : 25 test accuracy : 0.967123
Counter({0: 3851, 1: 3840})

Epoch :  32 loss training:  2.0254745743441163 Time :  4361
accuracy train: 0.996792 val: 0.960000 test: 0.970320
max validation accuracy : 0.967273 max acc epoch : 25 test accuracy : 0.967123
Counter({0: 3848, 1: 3843})

Epoch :  33 loss training:  1.5946177564765094 Time :  4398
accuracy train: 0.997006 val: 0.961212 test: 0.970320
max validation accuracy : 0.967273 max acc epoch : 25 test accuracy : 0.967123
Counter({1: 3855, 0: 3836})

Epoch :  34 loss training:  1.8956624133279547 Time :  4419
accuracy train: 0.996578 val: 0.964848 test: 0.970320
max validation accuracy : 0.967273 max acc epoch : 25 test accuracy : 0.967123
Counter({0: 3855, 1: 3836})

Epoch :  35 loss training:  1.5634597051448509 Time :  4462
accuracy train: 0.997220 val: 0.960000 test: 0.970320
max validation accuracy : 0.967273 max acc epoch : 25 test accuracy : 0.967123
Counter({1: 3855, 0: 3836})

Epoch :  36 loss training:  1.315463864528283 Time :  4502
accuracy train: 0.997006 val: 0.961212 test: 0.970320
max validation accuracy : 0.967273 max acc epoch : 25 test accuracy : 0.967123
Counter({0: 3855, 1: 3836})

========================================================================================================================================================================================================
best acc epoch :  25
validation accuracy :  0.9672727272727273
test accuracy :  0.9671232876712329
last test_accuracy :  0.9703196347031964
second best val :  0.9660606060606061
second best test :  0.9684931506849315
max gap 11
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  4 	 val_accuracy : 0.97697 	 test_accuracy : 0.96667 	 last test_accuracy : 0.97032 	 second best val : 0.97212 	 second best test : 0.96667
k :  1 	 best_acc epoch :  11 	 val_accuracy : 0.97939 	 test_accuracy : 0.97260 	 last test_accuracy : 0.96804 	 second best val : 0.97818 	 second best test : 0.97352
k :  2 	 best_acc epoch :  19 	 val_accuracy : 0.98061 	 test_accuracy : 0.97626 	 last test_accuracy : 0.97397 	 second best val : 0.97939 	 second best test : 0.97169
k :  3 	 best_acc epoch :  25 	 val_accuracy : 0.96727 	 test_accuracy : 0.96712 	 last test_accuracy : 0.97032 	 second best val : 0.96606 	 second best test : 0.96849

avg :  	 val_accuracy : 0.97606 	 test_accuracy : 0.97066 	 last_accuracy : 0.97066 	 second best val : 0.97394 	 second best test : 0.97009

std :  	 val_accuracy : 0.00524 	 test_accuracy : 0.00399 	 last_accuracy : 0.00213 	 second best val : 0.00532 	 second best test : 0.00267
