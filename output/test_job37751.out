

date and time :  Sat Jun 19 00:41:56 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=524, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  92.20002460479736 Time :  15
accuracy train: 0.770606 val: 0.765478 test: 0.752110
max validation accuracy : 0.765478 max acc epoch : 1 test accuracy : 0.752110
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  82.80231100320816 Time :  25
accuracy train: 0.781529 val: 0.777674 test: 0.767304
max validation accuracy : 0.777674 max acc epoch : 2 test accuracy : 0.767304
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.18158134818077 Time :  36
accuracy train: 0.799239 val: 0.781426 test: 0.776027
max validation accuracy : 0.781426 max acc epoch : 3 test accuracy : 0.776027
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  76.85616531968117 Time :  46
accuracy train: 0.813307 val: 0.802064 test: 0.777153
max validation accuracy : 0.802064 max acc epoch : 4 test accuracy : 0.777153
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  73.83007463812828 Time :  58
accuracy train: 0.819596 val: 0.789869 test: 0.779685
max validation accuracy : 0.802064 max acc epoch : 4 test accuracy : 0.777153
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  73.55225998163223 Time :  68
accuracy train: 0.833995 val: 0.790807 test: 0.781936
max validation accuracy : 0.802064 max acc epoch : 4 test accuracy : 0.777153
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.87924697995186 Time :  78
accuracy train: 0.839126 val: 0.807692 test: 0.777434
max validation accuracy : 0.807692 max acc epoch : 7 test accuracy : 0.777434
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.11390203237534 Time :  88
accuracy train: 0.837802 val: 0.803940 test: 0.773213
max validation accuracy : 0.807692 max acc epoch : 7 test accuracy : 0.777434
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  69.39324596524239 Time :  99
accuracy train: 0.844588 val: 0.806754 test: 0.770118
max validation accuracy : 0.807692 max acc epoch : 7 test accuracy : 0.777434
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  67.69953694939613 Time :  109
accuracy train: 0.847733 val: 0.804878 test: 0.771806
max validation accuracy : 0.807692 max acc epoch : 7 test accuracy : 0.777434

Epoch :  11 loss training:  66.97979572415352 Time :  121
accuracy train: 0.851870 val: 0.808630 test: 0.773495
max validation accuracy : 0.808630 max acc epoch : 11 test accuracy : 0.773495

Epoch :  12 loss training:  64.55926255881786 Time :  132
accuracy train: 0.864283 val: 0.806754 test: 0.775746
max validation accuracy : 0.808630 max acc epoch : 11 test accuracy : 0.773495

Epoch :  13 loss training:  63.21011024713516 Time :  144
accuracy train: 0.873221 val: 0.810507 test: 0.772932
max validation accuracy : 0.810507 max acc epoch : 13 test accuracy : 0.772932

Epoch :  14 loss training:  61.55013957619667 Time :  155
accuracy train: 0.883317 val: 0.807692 test: 0.771806
max validation accuracy : 0.810507 max acc epoch : 13 test accuracy : 0.772932

Epoch :  15 loss training:  59.64983381330967 Time :  166
accuracy train: 0.890103 val: 0.803940 test: 0.768711
max validation accuracy : 0.810507 max acc epoch : 13 test accuracy : 0.772932

Epoch :  16 loss training:  58.85942032933235 Time :  177
accuracy train: 0.896061 val: 0.808630 test: 0.771244
max validation accuracy : 0.810507 max acc epoch : 13 test accuracy : 0.772932

Epoch :  17 loss training:  57.13487236201763 Time :  187
accuracy train: 0.908474 val: 0.808630 test: 0.771806
max validation accuracy : 0.810507 max acc epoch : 13 test accuracy : 0.772932

Epoch :  18 loss training:  54.119451358914375 Time :  198
accuracy train: 0.908143 val: 0.804878 test: 0.773776
max validation accuracy : 0.810507 max acc epoch : 13 test accuracy : 0.772932

Epoch :  19 loss training:  53.02776163816452 Time :  208
accuracy train: 0.915756 val: 0.809568 test: 0.769555
max validation accuracy : 0.810507 max acc epoch : 13 test accuracy : 0.772932

Epoch :  20 loss training:  52.57820037007332 Time :  219
accuracy train: 0.922873 val: 0.801126 test: 0.768711
max validation accuracy : 0.810507 max acc epoch : 13 test accuracy : 0.772932

Epoch :  21 loss training:  49.12171930074692 Time :  230
accuracy train: 0.930818 val: 0.805816 test: 0.765616
max validation accuracy : 0.810507 max acc epoch : 13 test accuracy : 0.772932

Epoch :  22 loss training:  47.19556066393852 Time :  240
accuracy train: 0.941907 val: 0.795497 test: 0.768430
max validation accuracy : 0.810507 max acc epoch : 13 test accuracy : 0.772932

Epoch :  23 loss training:  46.819415397942066 Time :  251
accuracy train: 0.946872 val: 0.796435 test: 0.763928
max validation accuracy : 0.810507 max acc epoch : 13 test accuracy : 0.772932

Epoch :  24 loss training:  45.329384200274944 Time :  262
accuracy train: 0.947534 val: 0.803940 test: 0.767586
max validation accuracy : 0.810507 max acc epoch : 13 test accuracy : 0.772932

========================================================================================================================================================================================================
best acc epoch :  13
validation accuracy :  0.8105065666041276
test accuracy :  0.772931907709623
last test_accuracy :  0.7675858187957231
second best val :  0.8095684803001876
second best test :  0.772931907709623
max gap 4
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=833, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  93.86820361018181 Time :  274
accuracy train: 0.779378 val: 0.750469 test: 0.761114
max validation accuracy : 0.750469 max acc epoch : 1 test accuracy : 0.761114
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  82.11077737808228 Time :  284
accuracy train: 0.799239 val: 0.772983 test: 0.776308
max validation accuracy : 0.772983 max acc epoch : 2 test accuracy : 0.776308
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.47626146674156 Time :  294
accuracy train: 0.794439 val: 0.760788 test: 0.761677
max validation accuracy : 0.772983 max acc epoch : 2 test accuracy : 0.776308
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  74.68428042531013 Time :  305
accuracy train: 0.825885 val: 0.772045 test: 0.781654
max validation accuracy : 0.772983 max acc epoch : 2 test accuracy : 0.776308
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  73.40579390525818 Time :  315
accuracy train: 0.830685 val: 0.774859 test: 0.781373
max validation accuracy : 0.774859 max acc epoch : 5 test accuracy : 0.781373
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  70.35093329846859 Time :  327
accuracy train: 0.835816 val: 0.770169 test: 0.777997
max validation accuracy : 0.774859 max acc epoch : 5 test accuracy : 0.781373
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.34946277737617 Time :  337
accuracy train: 0.841278 val: 0.774859 test: 0.780529
max validation accuracy : 0.774859 max acc epoch : 5 test accuracy : 0.781373
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.37183088064194 Time :  348
accuracy train: 0.845912 val: 0.776735 test: 0.777997
max validation accuracy : 0.776735 max acc epoch : 8 test accuracy : 0.777997
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.41219072043896 Time :  358
accuracy train: 0.852201 val: 0.767355 test: 0.769274
max validation accuracy : 0.776735 max acc epoch : 8 test accuracy : 0.777997
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  65.09263305366039 Time :  369
accuracy train: 0.858987 val: 0.771107 test: 0.774902
max validation accuracy : 0.776735 max acc epoch : 8 test accuracy : 0.777997

Epoch :  11 loss training:  66.07238875329494 Time :  380
accuracy train: 0.865276 val: 0.775797 test: 0.773776
max validation accuracy : 0.776735 max acc epoch : 8 test accuracy : 0.777997

Epoch :  12 loss training:  63.5402153134346 Time :  392
accuracy train: 0.873055 val: 0.770169 test: 0.774339
max validation accuracy : 0.776735 max acc epoch : 8 test accuracy : 0.777997

Epoch :  13 loss training:  61.7273088991642 Time :  402
accuracy train: 0.881496 val: 0.773921 test: 0.777715
max validation accuracy : 0.776735 max acc epoch : 8 test accuracy : 0.777997

Epoch :  14 loss training:  59.519296631217 Time :  415
accuracy train: 0.891592 val: 0.771107 test: 0.774339
max validation accuracy : 0.776735 max acc epoch : 8 test accuracy : 0.777997

Epoch :  15 loss training:  57.94222378730774 Time :  425
accuracy train: 0.898875 val: 0.773921 test: 0.774620
max validation accuracy : 0.776735 max acc epoch : 8 test accuracy : 0.777997

Epoch :  16 loss training:  56.51727740466595 Time :  435
accuracy train: 0.905495 val: 0.774859 test: 0.773776
max validation accuracy : 0.776735 max acc epoch : 8 test accuracy : 0.777997

Epoch :  17 loss training:  54.97798763215542 Time :  446
accuracy train: 0.913936 val: 0.775797 test: 0.770681
max validation accuracy : 0.776735 max acc epoch : 8 test accuracy : 0.777997

Epoch :  18 loss training:  54.75577400624752 Time :  457
accuracy train: 0.919563 val: 0.778612 test: 0.772651
max validation accuracy : 0.778612 max acc epoch : 18 test accuracy : 0.772651

Epoch :  19 loss training:  50.871580719947815 Time :  467
accuracy train: 0.924694 val: 0.780488 test: 0.770962
max validation accuracy : 0.780488 max acc epoch : 19 test accuracy : 0.770962

Epoch :  20 loss training:  48.88452474027872 Time :  478
accuracy train: 0.931149 val: 0.776735 test: 0.774620
max validation accuracy : 0.780488 max acc epoch : 19 test accuracy : 0.770962

Epoch :  21 loss training:  47.34801518172026 Time :  489
accuracy train: 0.940914 val: 0.783302 test: 0.773776
max validation accuracy : 0.783302 max acc epoch : 21 test accuracy : 0.773776

Epoch :  22 loss training:  46.35031206160784 Time :  500
accuracy train: 0.944058 val: 0.787992 test: 0.768430
max validation accuracy : 0.787992 max acc epoch : 22 test accuracy : 0.768430

Epoch :  23 loss training:  43.6757976859808 Time :  510
accuracy train: 0.955478 val: 0.773921 test: 0.765335
max validation accuracy : 0.787992 max acc epoch : 22 test accuracy : 0.768430

Epoch :  24 loss training:  41.29267930239439 Time :  520
accuracy train: 0.959451 val: 0.769231 test: 0.763084
max validation accuracy : 0.787992 max acc epoch : 22 test accuracy : 0.768430

Epoch :  25 loss training:  41.363274566829205 Time :  531
accuracy train: 0.961437 val: 0.772983 test: 0.766179
max validation accuracy : 0.787992 max acc epoch : 22 test accuracy : 0.768430

Epoch :  26 loss training:  39.23299381881952 Time :  543
accuracy train: 0.963588 val: 0.771107 test: 0.763928
max validation accuracy : 0.787992 max acc epoch : 22 test accuracy : 0.768430

Epoch :  27 loss training:  37.25639396905899 Time :  555
accuracy train: 0.963092 val: 0.773921 test: 0.766179
max validation accuracy : 0.787992 max acc epoch : 22 test accuracy : 0.768430

Epoch :  28 loss training:  35.81685297563672 Time :  565
accuracy train: 0.969215 val: 0.771107 test: 0.767867
max validation accuracy : 0.787992 max acc epoch : 22 test accuracy : 0.768430

Epoch :  29 loss training:  35.62812143564224 Time :  576
accuracy train: 0.973850 val: 0.772045 test: 0.763647
max validation accuracy : 0.787992 max acc epoch : 22 test accuracy : 0.768430

Epoch :  30 loss training:  34.29683244973421 Time :  586
accuracy train: 0.977822 val: 0.772983 test: 0.763365
max validation accuracy : 0.787992 max acc epoch : 22 test accuracy : 0.768430

Epoch :  31 loss training:  32.772974736988544 Time :  600
accuracy train: 0.976332 val: 0.773921 test: 0.761958
max validation accuracy : 0.787992 max acc epoch : 22 test accuracy : 0.768430

Epoch :  32 loss training:  30.758784603327513 Time :  611
accuracy train: 0.976663 val: 0.771107 test: 0.763647
max validation accuracy : 0.787992 max acc epoch : 22 test accuracy : 0.768430

Epoch :  33 loss training:  31.435727573931217 Time :  622
accuracy train: 0.983946 val: 0.769231 test: 0.766742
max validation accuracy : 0.787992 max acc epoch : 22 test accuracy : 0.768430

========================================================================================================================================================================================================
best acc epoch :  22
validation accuracy :  0.7879924953095685
test accuracy :  0.7684299380979178
last test_accuracy :  0.7667416994935284
second best val :  0.7833020637898687
second best test :  0.7737760270118177
max gap 10
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=139, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.05629226565361 Time :  632
accuracy train: 0.770275 val: 0.763602 test: 0.747608
max validation accuracy : 0.763602 max acc epoch : 1 test accuracy : 0.747608
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  81.75846055150032 Time :  642
accuracy train: 0.791294 val: 0.774859 test: 0.767304
max validation accuracy : 0.774859 max acc epoch : 2 test accuracy : 0.767304
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.63953539729118 Time :  652
accuracy train: 0.802714 val: 0.758912 test: 0.767023
max validation accuracy : 0.774859 max acc epoch : 2 test accuracy : 0.767304
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.68480905890465 Time :  662
accuracy train: 0.822410 val: 0.776735 test: 0.778841
max validation accuracy : 0.776735 max acc epoch : 4 test accuracy : 0.778841
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  73.85987402498722 Time :  668
accuracy train: 0.827706 val: 0.775797 test: 0.776308
max validation accuracy : 0.776735 max acc epoch : 4 test accuracy : 0.778841
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.35118246078491 Time :  675
accuracy train: 0.833333 val: 0.770169 test: 0.775746
max validation accuracy : 0.776735 max acc epoch : 4 test accuracy : 0.778841
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.27196291089058 Time :  682
accuracy train: 0.843098 val: 0.779550 test: 0.777997
max validation accuracy : 0.779550 max acc epoch : 7 test accuracy : 0.777997
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.98484900593758 Time :  688
accuracy train: 0.847898 val: 0.783302 test: 0.778841
max validation accuracy : 0.783302 max acc epoch : 8 test accuracy : 0.778841
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  68.26030765473843 Time :  695
accuracy train: 0.846408 val: 0.778612 test: 0.772088
max validation accuracy : 0.783302 max acc epoch : 8 test accuracy : 0.778841
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  66.69418400526047 Time :  703
accuracy train: 0.856008 val: 0.783302 test: 0.772932
max validation accuracy : 0.783302 max acc epoch : 8 test accuracy : 0.778841

Epoch :  11 loss training:  65.25831843912601 Time :  712
accuracy train: 0.865442 val: 0.787054 test: 0.772651
max validation accuracy : 0.787054 max acc epoch : 11 test accuracy : 0.772651

Epoch :  12 loss training:  64.55163930356503 Time :  721
accuracy train: 0.877855 val: 0.782364 test: 0.773776
max validation accuracy : 0.787054 max acc epoch : 11 test accuracy : 0.772651

Epoch :  13 loss training:  63.146963730454445 Time :  732
accuracy train: 0.886627 val: 0.787054 test: 0.774620
max validation accuracy : 0.787054 max acc epoch : 11 test accuracy : 0.772651

Epoch :  14 loss training:  60.41468983888626 Time :  741
accuracy train: 0.889606 val: 0.785178 test: 0.776871
max validation accuracy : 0.787054 max acc epoch : 11 test accuracy : 0.772651

Epoch :  15 loss training:  59.17097081243992 Time :  751
accuracy train: 0.897054 val: 0.786116 test: 0.773776
max validation accuracy : 0.787054 max acc epoch : 11 test accuracy : 0.772651

Epoch :  16 loss training:  56.01194052398205 Time :  760
accuracy train: 0.904005 val: 0.782364 test: 0.773776
max validation accuracy : 0.787054 max acc epoch : 11 test accuracy : 0.772651

Epoch :  17 loss training:  54.6603197902441 Time :  770
accuracy train: 0.912777 val: 0.781426 test: 0.771806
max validation accuracy : 0.787054 max acc epoch : 11 test accuracy : 0.772651

Epoch :  18 loss training:  54.18424679338932 Time :  778
accuracy train: 0.919067 val: 0.776735 test: 0.772932
max validation accuracy : 0.787054 max acc epoch : 11 test accuracy : 0.772651

Epoch :  19 loss training:  51.972375094890594 Time :  788
accuracy train: 0.927176 val: 0.776735 test: 0.773495
max validation accuracy : 0.787054 max acc epoch : 11 test accuracy : 0.772651

Epoch :  20 loss training:  50.288168862462044 Time :  797
accuracy train: 0.932638 val: 0.778612 test: 0.776590
max validation accuracy : 0.787054 max acc epoch : 11 test accuracy : 0.772651

Epoch :  21 loss training:  48.886985056102276 Time :  807
accuracy train: 0.937272 val: 0.783302 test: 0.774339
max validation accuracy : 0.787054 max acc epoch : 11 test accuracy : 0.772651

Epoch :  22 loss training:  46.34662136435509 Time :  816
accuracy train: 0.943562 val: 0.778612 test: 0.770962
max validation accuracy : 0.787054 max acc epoch : 11 test accuracy : 0.772651

========================================================================================================================================================================================================
best acc epoch :  11
validation accuracy :  0.7870544090056285
test accuracy :  0.7726505346088914
last test_accuracy :  0.770962296004502
second best val :  0.7861163227016885
second best test :  0.7726505346088914
max gap 3
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=0, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=725, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  92.53138899803162 Time :  826
accuracy train: 0.768454 val: 0.757036 test: 0.755768
max validation accuracy : 0.757036 max acc epoch : 1 test accuracy : 0.755768
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.3601203262806 Time :  835
accuracy train: 0.791956 val: 0.772045 test: 0.777153
max validation accuracy : 0.772045 max acc epoch : 2 test accuracy : 0.777153
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  78.51861709356308 Time :  844
accuracy train: 0.802052 val: 0.763602 test: 0.774057
max validation accuracy : 0.772045 max acc epoch : 2 test accuracy : 0.777153
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.99075692892075 Time :  855
accuracy train: 0.814796 val: 0.778612 test: 0.775464
max validation accuracy : 0.778612 max acc epoch : 4 test accuracy : 0.775464
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  74.1572332829237 Time :  863
accuracy train: 0.828203 val: 0.787992 test: 0.779403
max validation accuracy : 0.787992 max acc epoch : 5 test accuracy : 0.779403
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  73.85264083743095 Time :  873
accuracy train: 0.818603 val: 0.783302 test: 0.777715
max validation accuracy : 0.787992 max acc epoch : 5 test accuracy : 0.779403
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  70.13709776103497 Time :  882
accuracy train: 0.831678 val: 0.780488 test: 0.782499
max validation accuracy : 0.787992 max acc epoch : 5 test accuracy : 0.779403
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.43277014791965 Time :  891
accuracy train: 0.840947 val: 0.786116 test: 0.781373
max validation accuracy : 0.787992 max acc epoch : 5 test accuracy : 0.779403
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  68.31994657218456 Time :  897
accuracy train: 0.851374 val: 0.786116 test: 0.774620
max validation accuracy : 0.787992 max acc epoch : 5 test accuracy : 0.779403
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  66.4898394048214 Time :  903
accuracy train: 0.853029 val: 0.787054 test: 0.778559
max validation accuracy : 0.787992 max acc epoch : 5 test accuracy : 0.779403

Epoch :  11 loss training:  65.23445899784565 Time :  912
accuracy train: 0.860477 val: 0.788931 test: 0.781654
max validation accuracy : 0.788931 max acc epoch : 11 test accuracy : 0.781654

Epoch :  12 loss training:  63.98655077815056 Time :  921
accuracy train: 0.866931 val: 0.788931 test: 0.782217
max validation accuracy : 0.788931 max acc epoch : 11 test accuracy : 0.781654

Epoch :  13 loss training:  63.09355829656124 Time :  931
accuracy train: 0.875041 val: 0.785178 test: 0.781092
max validation accuracy : 0.788931 max acc epoch : 11 test accuracy : 0.781654

Epoch :  14 loss training:  61.280551105737686 Time :  940
accuracy train: 0.885965 val: 0.783302 test: 0.781654
max validation accuracy : 0.788931 max acc epoch : 11 test accuracy : 0.781654

Epoch :  15 loss training:  58.636566922068596 Time :  950
accuracy train: 0.892420 val: 0.789869 test: 0.781092
max validation accuracy : 0.789869 max acc epoch : 15 test accuracy : 0.781092

Epoch :  16 loss training:  57.14239273965359 Time :  959
accuracy train: 0.902185 val: 0.787054 test: 0.782217
max validation accuracy : 0.789869 max acc epoch : 15 test accuracy : 0.781092

Epoch :  17 loss training:  55.123623847961426 Time :  968
accuracy train: 0.907315 val: 0.790807 test: 0.780529
max validation accuracy : 0.790807 max acc epoch : 17 test accuracy : 0.780529

Epoch :  18 loss training:  52.32425607740879 Time :  978
accuracy train: 0.912943 val: 0.783302 test: 0.777434
max validation accuracy : 0.790807 max acc epoch : 17 test accuracy : 0.780529

Epoch :  19 loss training:  51.43183912336826 Time :  987
accuracy train: 0.921384 val: 0.788931 test: 0.778559
max validation accuracy : 0.790807 max acc epoch : 17 test accuracy : 0.780529

Epoch :  20 loss training:  50.120172291994095 Time :  996
accuracy train: 0.927011 val: 0.784240 test: 0.778559
max validation accuracy : 0.790807 max acc epoch : 17 test accuracy : 0.780529

Epoch :  21 loss training:  48.28015397489071 Time :  1005
accuracy train: 0.938100 val: 0.776735 test: 0.772932
max validation accuracy : 0.790807 max acc epoch : 17 test accuracy : 0.780529

Epoch :  22 loss training:  46.90337674319744 Time :  1015
accuracy train: 0.942900 val: 0.777674 test: 0.777997
max validation accuracy : 0.790807 max acc epoch : 17 test accuracy : 0.780529

Epoch :  23 loss training:  45.676073513925076 Time :  1024
accuracy train: 0.947203 val: 0.785178 test: 0.776871
max validation accuracy : 0.790807 max acc epoch : 17 test accuracy : 0.780529

Epoch :  24 loss training:  43.09005507081747 Time :  1035
accuracy train: 0.952334 val: 0.777674 test: 0.773213
max validation accuracy : 0.790807 max acc epoch : 17 test accuracy : 0.780529

Epoch :  25 loss training:  42.38398692756891 Time :  1043
accuracy train: 0.956802 val: 0.774859 test: 0.772369
max validation accuracy : 0.790807 max acc epoch : 17 test accuracy : 0.780529

Epoch :  26 loss training:  40.10357062518597 Time :  1051
accuracy train: 0.962099 val: 0.772983 test: 0.775746
max validation accuracy : 0.790807 max acc epoch : 17 test accuracy : 0.780529

Epoch :  27 loss training:  37.79126230627298 Time :  1061
accuracy train: 0.966236 val: 0.774859 test: 0.769274
max validation accuracy : 0.790807 max acc epoch : 17 test accuracy : 0.780529

Epoch :  28 loss training:  36.484456829726696 Time :  1070
accuracy train: 0.973022 val: 0.769231 test: 0.763647
max validation accuracy : 0.790807 max acc epoch : 17 test accuracy : 0.780529

========================================================================================================================================================================================================
best acc epoch :  17
validation accuracy :  0.7908067542213884
test accuracy :  0.7805289814293753
last test_accuracy :  0.7636465953854812
second best val :  0.7898686679174484
second best test :  0.7810917276308385
max gap 6
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  13 	 val_accuracy : 0.81051 	 test_accuracy : 0.77293 	 last test_accuracy : 0.76759 	 second best val : 0.80957 	 second best test : 0.77293
k :  1 	 best_acc epoch :  22 	 val_accuracy : 0.78799 	 test_accuracy : 0.76843 	 last test_accuracy : 0.76674 	 second best val : 0.78330 	 second best test : 0.77378
k :  2 	 best_acc epoch :  11 	 val_accuracy : 0.78705 	 test_accuracy : 0.77265 	 last test_accuracy : 0.77096 	 second best val : 0.78612 	 second best test : 0.77265
k :  3 	 best_acc epoch :  17 	 val_accuracy : 0.79081 	 test_accuracy : 0.78053 	 last test_accuracy : 0.76365 	 second best val : 0.78987 	 second best test : 0.78109

avg :  	 val_accuracy : 0.79409 	 test_accuracy : 0.77364 	 last_accuracy : 0.76723 	 second best val : 0.79221 	 second best test : 0.77511

std :  	 val_accuracy : 0.00958 	 test_accuracy : 0.00436 	 last_accuracy : 0.00260 	 second best val : 0.01029 	 second best test : 0.00348


date and time :  Sat Jun 19 00:59:56 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=674, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  91.8777502477169 Time :  11
accuracy train: 0.785667 val: 0.760788 test: 0.774339
max validation accuracy : 0.760788 max acc epoch : 1 test accuracy : 0.774339
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.54674124717712 Time :  21
accuracy train: 0.791129 val: 0.754221 test: 0.777153
max validation accuracy : 0.760788 max acc epoch : 1 test accuracy : 0.774339
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  78.86254426836967 Time :  30
accuracy train: 0.803873 val: 0.771107 test: 0.774620
max validation accuracy : 0.771107 max acc epoch : 3 test accuracy : 0.774620
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.42668206989765 Time :  40
accuracy train: 0.818934 val: 0.775797 test: 0.775183
max validation accuracy : 0.775797 max acc epoch : 4 test accuracy : 0.775183
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  72.9780844449997 Time :  49
accuracy train: 0.825389 val: 0.768293 test: 0.774339
max validation accuracy : 0.775797 max acc epoch : 4 test accuracy : 0.775183
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  73.21235027909279 Time :  59
accuracy train: 0.834161 val: 0.773921 test: 0.774057
max validation accuracy : 0.775797 max acc epoch : 4 test accuracy : 0.775183
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.44962982833385 Time :  68
accuracy train: 0.835319 val: 0.772983 test: 0.779685
max validation accuracy : 0.775797 max acc epoch : 4 test accuracy : 0.775183
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.96772250533104 Time :  77
accuracy train: 0.841112 val: 0.772045 test: 0.778278
max validation accuracy : 0.775797 max acc epoch : 4 test accuracy : 0.775183
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.69328173995018 Time :  83
accuracy train: 0.844919 val: 0.775797 test: 0.777715
max validation accuracy : 0.775797 max acc epoch : 4 test accuracy : 0.775183
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  66.58327999711037 Time :  91
accuracy train: 0.852036 val: 0.776735 test: 0.775183
max validation accuracy : 0.776735 max acc epoch : 10 test accuracy : 0.775183

Epoch :  11 loss training:  66.07756075263023 Time :  101
accuracy train: 0.854849 val: 0.779550 test: 0.778559
max validation accuracy : 0.779550 max acc epoch : 11 test accuracy : 0.778559

Epoch :  12 loss training:  65.5524614751339 Time :  110
accuracy train: 0.860477 val: 0.770169 test: 0.781654
max validation accuracy : 0.779550 max acc epoch : 11 test accuracy : 0.778559

Epoch :  13 loss training:  62.79969349503517 Time :  118
accuracy train: 0.869249 val: 0.771107 test: 0.780529
max validation accuracy : 0.779550 max acc epoch : 11 test accuracy : 0.778559

Epoch :  14 loss training:  61.27103787660599 Time :  124
accuracy train: 0.877524 val: 0.770169 test: 0.780248
max validation accuracy : 0.779550 max acc epoch : 11 test accuracy : 0.778559

Epoch :  15 loss training:  59.86267013847828 Time :  130
accuracy train: 0.884641 val: 0.779550 test: 0.781092
max validation accuracy : 0.779550 max acc epoch : 11 test accuracy : 0.778559

Epoch :  16 loss training:  58.65055173635483 Time :  140
accuracy train: 0.891096 val: 0.776735 test: 0.781373
max validation accuracy : 0.779550 max acc epoch : 11 test accuracy : 0.778559

Epoch :  17 loss training:  56.52410314977169 Time :  149
accuracy train: 0.899702 val: 0.779550 test: 0.778841
max validation accuracy : 0.779550 max acc epoch : 11 test accuracy : 0.778559

Epoch :  18 loss training:  53.97297936677933 Time :  159
accuracy train: 0.908474 val: 0.777674 test: 0.777434
max validation accuracy : 0.779550 max acc epoch : 11 test accuracy : 0.778559

Epoch :  19 loss training:  52.22936996817589 Time :  168
accuracy train: 0.911288 val: 0.776735 test: 0.774620
max validation accuracy : 0.779550 max acc epoch : 11 test accuracy : 0.778559

Epoch :  20 loss training:  50.603047393262386 Time :  178
accuracy train: 0.920722 val: 0.774859 test: 0.774339
max validation accuracy : 0.779550 max acc epoch : 11 test accuracy : 0.778559

Epoch :  21 loss training:  49.9058945029974 Time :  187
accuracy train: 0.924032 val: 0.781426 test: 0.775464
max validation accuracy : 0.781426 max acc epoch : 21 test accuracy : 0.775464

Epoch :  22 loss training:  48.71144964545965 Time :  196
accuracy train: 0.932969 val: 0.778612 test: 0.771244
max validation accuracy : 0.781426 max acc epoch : 21 test accuracy : 0.775464

Epoch :  23 loss training:  46.77607569843531 Time :  202
accuracy train: 0.935948 val: 0.779550 test: 0.777434
max validation accuracy : 0.781426 max acc epoch : 21 test accuracy : 0.775464

Epoch :  24 loss training:  44.840161956846714 Time :  208
accuracy train: 0.940252 val: 0.782364 test: 0.770681
max validation accuracy : 0.782364 max acc epoch : 24 test accuracy : 0.770681

Epoch :  25 loss training:  42.88507115095854 Time :  219
accuracy train: 0.949024 val: 0.779550 test: 0.770400
max validation accuracy : 0.782364 max acc epoch : 24 test accuracy : 0.770681

Epoch :  26 loss training:  41.02351353317499 Time :  229
accuracy train: 0.951506 val: 0.778612 test: 0.773776
max validation accuracy : 0.782364 max acc epoch : 24 test accuracy : 0.770681

Epoch :  27 loss training:  40.16352393478155 Time :  239
accuracy train: 0.955809 val: 0.773921 test: 0.772088
max validation accuracy : 0.782364 max acc epoch : 24 test accuracy : 0.770681

Epoch :  28 loss training:  39.94380883872509 Time :  248
accuracy train: 0.961768 val: 0.776735 test: 0.767586
max validation accuracy : 0.782364 max acc epoch : 24 test accuracy : 0.770681

Epoch :  29 loss training:  37.53842308744788 Time :  257
accuracy train: 0.963092 val: 0.780488 test: 0.767867
max validation accuracy : 0.782364 max acc epoch : 24 test accuracy : 0.770681

Epoch :  30 loss training:  36.921999640762806 Time :  266
accuracy train: 0.967064 val: 0.785178 test: 0.768149
max validation accuracy : 0.785178 max acc epoch : 30 test accuracy : 0.768149

Epoch :  31 loss training:  34.275103595107794 Time :  276
accuracy train: 0.971036 val: 0.780488 test: 0.768993
max validation accuracy : 0.785178 max acc epoch : 30 test accuracy : 0.768149

Epoch :  32 loss training:  33.22336219251156 Time :  285
accuracy train: 0.974512 val: 0.772983 test: 0.762240
max validation accuracy : 0.785178 max acc epoch : 30 test accuracy : 0.768149

Epoch :  33 loss training:  30.025344759225845 Time :  295
accuracy train: 0.979146 val: 0.777674 test: 0.765898
max validation accuracy : 0.785178 max acc epoch : 30 test accuracy : 0.768149

Epoch :  34 loss training:  31.040015324950218 Time :  301
accuracy train: 0.980636 val: 0.783302 test: 0.766460
max validation accuracy : 0.785178 max acc epoch : 30 test accuracy : 0.768149

Epoch :  35 loss training:  28.75745888054371 Time :  308
accuracy train: 0.984773 val: 0.772045 test: 0.763647
max validation accuracy : 0.785178 max acc epoch : 30 test accuracy : 0.768149

Epoch :  36 loss training:  28.50608131662011 Time :  315
accuracy train: 0.983946 val: 0.770169 test: 0.766179
max validation accuracy : 0.785178 max acc epoch : 30 test accuracy : 0.768149

Epoch :  37 loss training:  27.750906508415937 Time :  324
accuracy train: 0.987256 val: 0.772045 test: 0.768711
max validation accuracy : 0.785178 max acc epoch : 30 test accuracy : 0.768149

Epoch :  38 loss training:  26.409358132630587 Time :  334
accuracy train: 0.988911 val: 0.773921 test: 0.769274
max validation accuracy : 0.785178 max acc epoch : 30 test accuracy : 0.768149

Epoch :  39 loss training:  27.32850554957986 Time :  344
accuracy train: 0.990070 val: 0.774859 test: 0.767867
max validation accuracy : 0.785178 max acc epoch : 30 test accuracy : 0.768149

Epoch :  40 loss training:  23.15790898166597 Time :  353
accuracy train: 0.991063 val: 0.777674 test: 0.763084
max validation accuracy : 0.785178 max acc epoch : 30 test accuracy : 0.768149

Epoch :  41 loss training:  22.798173177987337 Time :  363
accuracy train: 0.992221 val: 0.774859 test: 0.765616
max validation accuracy : 0.785178 max acc epoch : 30 test accuracy : 0.768149

========================================================================================================================================================================================================
best acc epoch :  30
validation accuracy :  0.7851782363977486
test accuracy :  0.7681485649971863
last test_accuracy :  0.7656162070906022
second best val :  0.7833020637898687
second best test :  0.7681485649971863
max gap 10
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=32, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  90.298205524683 Time :  373
accuracy train: 0.783019 val: 0.744841 test: 0.763928
max validation accuracy : 0.744841 max acc epoch : 1 test accuracy : 0.763928
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.31469079852104 Time :  383
accuracy train: 0.795432 val: 0.769231 test: 0.776027
max validation accuracy : 0.769231 max acc epoch : 2 test accuracy : 0.776027
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.94321849942207 Time :  392
accuracy train: 0.808673 val: 0.765478 test: 0.775746
max validation accuracy : 0.769231 max acc epoch : 2 test accuracy : 0.776027
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.99659362435341 Time :  402
accuracy train: 0.813969 val: 0.771107 test: 0.776308
max validation accuracy : 0.771107 max acc epoch : 4 test accuracy : 0.776308
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  74.02091094851494 Time :  411
accuracy train: 0.823403 val: 0.770169 test: 0.777153
max validation accuracy : 0.771107 max acc epoch : 4 test accuracy : 0.776308
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  71.6829401999712 Time :  421
accuracy train: 0.833168 val: 0.773921 test: 0.778278
max validation accuracy : 0.773921 max acc epoch : 6 test accuracy : 0.778278
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  70.27825653553009 Time :  430
accuracy train: 0.833168 val: 0.769231 test: 0.779685
max validation accuracy : 0.773921 max acc epoch : 6 test accuracy : 0.778278
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.74824166297913 Time :  439
accuracy train: 0.844753 val: 0.768293 test: 0.781373
max validation accuracy : 0.773921 max acc epoch : 6 test accuracy : 0.778278
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  66.70954348146915 Time :  449
accuracy train: 0.847236 val: 0.771107 test: 0.782499
max validation accuracy : 0.773921 max acc epoch : 6 test accuracy : 0.778278
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  65.08016946911812 Time :  458
accuracy train: 0.852698 val: 0.772045 test: 0.786719
max validation accuracy : 0.773921 max acc epoch : 6 test accuracy : 0.778278

Epoch :  11 loss training:  65.75721077620983 Time :  468
accuracy train: 0.859815 val: 0.768293 test: 0.785312
max validation accuracy : 0.773921 max acc epoch : 6 test accuracy : 0.778278

Epoch :  12 loss training:  62.91089643537998 Time :  478
accuracy train: 0.869580 val: 0.769231 test: 0.784750
max validation accuracy : 0.773921 max acc epoch : 6 test accuracy : 0.778278

Epoch :  13 loss training:  62.12636834383011 Time :  488
accuracy train: 0.873221 val: 0.768293 test: 0.784468
max validation accuracy : 0.773921 max acc epoch : 6 test accuracy : 0.778278

Epoch :  14 loss training:  60.9057941287756 Time :  497
accuracy train: 0.882655 val: 0.767355 test: 0.786156
max validation accuracy : 0.773921 max acc epoch : 6 test accuracy : 0.778278

Epoch :  15 loss training:  57.76429629325867 Time :  507
accuracy train: 0.890930 val: 0.770169 test: 0.785312
max validation accuracy : 0.773921 max acc epoch : 6 test accuracy : 0.778278

Epoch :  16 loss training:  57.899097844958305 Time :  516
accuracy train: 0.900530 val: 0.778612 test: 0.783624
max validation accuracy : 0.778612 max acc epoch : 16 test accuracy : 0.783624

Epoch :  17 loss training:  55.91588717699051 Time :  526
accuracy train: 0.902185 val: 0.770169 test: 0.784750
max validation accuracy : 0.778612 max acc epoch : 16 test accuracy : 0.783624

Epoch :  18 loss training:  53.81360900402069 Time :  533
accuracy train: 0.908309 val: 0.772045 test: 0.783905
max validation accuracy : 0.778612 max acc epoch : 16 test accuracy : 0.783624

Epoch :  19 loss training:  52.054773174226284 Time :  539
accuracy train: 0.908309 val: 0.769231 test: 0.783061
max validation accuracy : 0.778612 max acc epoch : 16 test accuracy : 0.783624

Epoch :  20 loss training:  49.91307367384434 Time :  547
accuracy train: 0.917908 val: 0.772983 test: 0.785875
max validation accuracy : 0.778612 max acc epoch : 16 test accuracy : 0.783624

Epoch :  21 loss training:  48.596226677298546 Time :  556
accuracy train: 0.923866 val: 0.768293 test: 0.784468
max validation accuracy : 0.778612 max acc epoch : 16 test accuracy : 0.783624

Epoch :  22 loss training:  47.46044231951237 Time :  566
accuracy train: 0.929494 val: 0.767355 test: 0.785594
max validation accuracy : 0.778612 max acc epoch : 16 test accuracy : 0.783624

Epoch :  23 loss training:  46.08356509357691 Time :  575
accuracy train: 0.933962 val: 0.770169 test: 0.783343
max validation accuracy : 0.778612 max acc epoch : 16 test accuracy : 0.783624

Epoch :  24 loss training:  43.69460327923298 Time :  584
accuracy train: 0.938431 val: 0.767355 test: 0.775746
max validation accuracy : 0.778612 max acc epoch : 16 test accuracy : 0.783624

Epoch :  25 loss training:  43.406661204993725 Time :  595
accuracy train: 0.942072 val: 0.766417 test: 0.780810
max validation accuracy : 0.778612 max acc epoch : 16 test accuracy : 0.783624

Epoch :  26 loss training:  42.26634158194065 Time :  605
accuracy train: 0.948692 val: 0.763602 test: 0.782780
max validation accuracy : 0.778612 max acc epoch : 16 test accuracy : 0.783624

Epoch :  27 loss training:  41.101666271686554 Time :  614
accuracy train: 0.955147 val: 0.765478 test: 0.777434
max validation accuracy : 0.778612 max acc epoch : 16 test accuracy : 0.783624

========================================================================================================================================================================================================
best acc epoch :  16
validation accuracy :  0.7786116322701688
test accuracy :  0.7836240855374226
last test_accuracy :  0.7774338773213281
second best val :  0.773921200750469
second best test :  0.7782779966235228
max gap 10
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=722, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  92.19111093878746 Time :  624
accuracy train: 0.787488 val: 0.757974 test: 0.760270
max validation accuracy : 0.757974 max acc epoch : 1 test accuracy : 0.760270
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  82.19573020935059 Time :  634
accuracy train: 0.793280 val: 0.750469 test: 0.767586
max validation accuracy : 0.757974 max acc epoch : 1 test accuracy : 0.760270
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  78.78469750285149 Time :  643
accuracy train: 0.805197 val: 0.752345 test: 0.768711
max validation accuracy : 0.757974 max acc epoch : 1 test accuracy : 0.760270
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.89333790540695 Time :  653
accuracy train: 0.816452 val: 0.769231 test: 0.773495
max validation accuracy : 0.769231 max acc epoch : 4 test accuracy : 0.773495
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  73.94436745345592 Time :  662
accuracy train: 0.824396 val: 0.767355 test: 0.776308
max validation accuracy : 0.769231 max acc epoch : 4 test accuracy : 0.773495
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.28948752582073 Time :  672
accuracy train: 0.834988 val: 0.764540 test: 0.777153
max validation accuracy : 0.769231 max acc epoch : 4 test accuracy : 0.773495
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.14478576183319 Time :  681
accuracy train: 0.839292 val: 0.771107 test: 0.777153
max validation accuracy : 0.771107 max acc epoch : 7 test accuracy : 0.777153
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.53363639116287 Time :  691
accuracy train: 0.843264 val: 0.767355 test: 0.776590
max validation accuracy : 0.771107 max acc epoch : 7 test accuracy : 0.777153
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.12960113584995 Time :  701
accuracy train: 0.845084 val: 0.768293 test: 0.774057
max validation accuracy : 0.771107 max acc epoch : 7 test accuracy : 0.777153
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  66.01115994155407 Time :  710
accuracy train: 0.849719 val: 0.768293 test: 0.777153
max validation accuracy : 0.771107 max acc epoch : 7 test accuracy : 0.777153

Epoch :  11 loss training:  66.8376549333334 Time :  720
accuracy train: 0.863621 val: 0.769231 test: 0.773495
max validation accuracy : 0.771107 max acc epoch : 7 test accuracy : 0.777153

Epoch :  12 loss training:  63.84527789056301 Time :  729
accuracy train: 0.869414 val: 0.774859 test: 0.776871
max validation accuracy : 0.774859 max acc epoch : 12 test accuracy : 0.776871

Epoch :  13 loss training:  61.63501735031605 Time :  739
accuracy train: 0.872890 val: 0.781426 test: 0.768993
max validation accuracy : 0.781426 max acc epoch : 13 test accuracy : 0.768993

Epoch :  14 loss training:  61.54253908991814 Time :  748
accuracy train: 0.880338 val: 0.774859 test: 0.774620
max validation accuracy : 0.781426 max acc epoch : 13 test accuracy : 0.768993

Epoch :  15 loss training:  60.47959287464619 Time :  759
accuracy train: 0.890268 val: 0.773921 test: 0.770962
max validation accuracy : 0.781426 max acc epoch : 13 test accuracy : 0.768993

Epoch :  16 loss training:  57.53019264340401 Time :  768
accuracy train: 0.898378 val: 0.770169 test: 0.770681
max validation accuracy : 0.781426 max acc epoch : 13 test accuracy : 0.768993

Epoch :  17 loss training:  56.29406674206257 Time :  778
accuracy train: 0.904833 val: 0.777674 test: 0.769555
max validation accuracy : 0.781426 max acc epoch : 13 test accuracy : 0.768993

Epoch :  18 loss training:  53.351714089512825 Time :  787
accuracy train: 0.911453 val: 0.767355 test: 0.773213
max validation accuracy : 0.781426 max acc epoch : 13 test accuracy : 0.768993

Epoch :  19 loss training:  52.09828828275204 Time :  797
accuracy train: 0.917411 val: 0.771107 test: 0.771244
max validation accuracy : 0.781426 max acc epoch : 13 test accuracy : 0.768993

Epoch :  20 loss training:  50.309048645198345 Time :  806
accuracy train: 0.926514 val: 0.769231 test: 0.772651
max validation accuracy : 0.781426 max acc epoch : 13 test accuracy : 0.768993

Epoch :  21 loss training:  48.54161974042654 Time :  816
accuracy train: 0.928169 val: 0.765478 test: 0.775746
max validation accuracy : 0.781426 max acc epoch : 13 test accuracy : 0.768993

Epoch :  22 loss training:  46.62055443972349 Time :  825
accuracy train: 0.932307 val: 0.766417 test: 0.771806
max validation accuracy : 0.781426 max acc epoch : 13 test accuracy : 0.768993

Epoch :  23 loss training:  46.46730727702379 Time :  835
accuracy train: 0.939590 val: 0.774859 test: 0.774057
max validation accuracy : 0.781426 max acc epoch : 13 test accuracy : 0.768993

Epoch :  24 loss training:  43.70565211772919 Time :  845
accuracy train: 0.943396 val: 0.770169 test: 0.774057
max validation accuracy : 0.781426 max acc epoch : 13 test accuracy : 0.768993

========================================================================================================================================================================================================
best acc epoch :  13
validation accuracy :  0.7814258911819888
test accuracy :  0.768992684299381
last test_accuracy :  0.7740574001125492
second best val :  0.7776735459662288
second best test :  0.768992684299381
max gap 5
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=1, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=609, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0

Epoch :  1 loss training:  92.90635427832603 Time :  856
accuracy train: 0.777392 val: 0.766417 test: 0.764209
max validation accuracy : 0.766417 max acc epoch : 1 test accuracy : 0.764209
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  82.7714159488678 Time :  865
accuracy train: 0.791791 val: 0.783302 test: 0.770400
max validation accuracy : 0.783302 max acc epoch : 2 test accuracy : 0.770400
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  81.19154813885689 Time :  874
accuracy train: 0.799570 val: 0.768293 test: 0.773776
max validation accuracy : 0.783302 max acc epoch : 2 test accuracy : 0.770400
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  76.04475238919258 Time :  884
accuracy train: 0.811321 val: 0.776735 test: 0.777434
max validation accuracy : 0.783302 max acc epoch : 2 test accuracy : 0.770400
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  74.57952630519867 Time :  893
accuracy train: 0.818438 val: 0.772045 test: 0.779403
max validation accuracy : 0.783302 max acc epoch : 2 test accuracy : 0.770400
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  73.1255646944046 Time :  903
accuracy train: 0.826879 val: 0.776735 test: 0.779403
max validation accuracy : 0.783302 max acc epoch : 2 test accuracy : 0.770400
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.97820833325386 Time :  912
accuracy train: 0.829030 val: 0.773921 test: 0.780529
max validation accuracy : 0.783302 max acc epoch : 2 test accuracy : 0.770400
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  70.26420180499554 Time :  922
accuracy train: 0.839788 val: 0.776735 test: 0.779122
max validation accuracy : 0.783302 max acc epoch : 2 test accuracy : 0.770400
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  69.34566520154476 Time :  931
accuracy train: 0.839457 val: 0.779550 test: 0.778559
max validation accuracy : 0.783302 max acc epoch : 2 test accuracy : 0.770400
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  68.32335908710957 Time :  941
accuracy train: 0.840616 val: 0.777674 test: 0.775183
max validation accuracy : 0.783302 max acc epoch : 2 test accuracy : 0.770400

Epoch :  11 loss training:  67.86484915018082 Time :  950
accuracy train: 0.851043 val: 0.781426 test: 0.777997
max validation accuracy : 0.783302 max acc epoch : 2 test accuracy : 0.770400

Epoch :  12 loss training:  66.26463581621647 Time :  960
accuracy train: 0.858656 val: 0.779550 test: 0.774902
max validation accuracy : 0.783302 max acc epoch : 2 test accuracy : 0.770400

Epoch :  13 loss training:  64.28217196464539 Time :  969
accuracy train: 0.865442 val: 0.776735 test: 0.780810
max validation accuracy : 0.783302 max acc epoch : 2 test accuracy : 0.770400

========================================================================================================================================================================================================
best acc epoch :  2
validation accuracy :  0.7833020637898687
test accuracy :  0.7703995498030388
last test_accuracy :  0.7808103545301069
second best val :  0.7814258911819888
second best test :  0.7703995498030388
max gap 1
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  30 	 val_accuracy : 0.78518 	 test_accuracy : 0.76815 	 last test_accuracy : 0.76562 	 second best val : 0.78330 	 second best test : 0.76815
k :  1 	 best_acc epoch :  16 	 val_accuracy : 0.77861 	 test_accuracy : 0.78362 	 last test_accuracy : 0.77743 	 second best val : 0.77392 	 second best test : 0.77828
k :  2 	 best_acc epoch :  13 	 val_accuracy : 0.78143 	 test_accuracy : 0.76899 	 last test_accuracy : 0.77406 	 second best val : 0.77767 	 second best test : 0.76899
k :  3 	 best_acc epoch :  2 	 val_accuracy : 0.78330 	 test_accuracy : 0.77040 	 last test_accuracy : 0.78081 	 second best val : 0.78143 	 second best test : 0.77040

avg :  	 val_accuracy : 0.78213 	 test_accuracy : 0.77279 	 last_accuracy : 0.77448 	 second best val : 0.77908 	 second best test : 0.77145

std :  	 val_accuracy : 0.00243 	 test_accuracy : 0.00631 	 last_accuracy : 0.00565 	 second best val : 0.00360 	 second best test : 0.00402


date and time :  Sat Jun 19 01:16:14 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=916, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 6198, 0: 4464})

Epoch :  1 loss training:  91.96737053990364 Time :  13
accuracy train: 0.747435 val: 0.757974 test: 0.741699
max validation accuracy : 0.757974 max acc epoch : 1 test accuracy : 0.741699
Counter({1: 5410, 0: 5252})
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  84.22436583042145 Time :  26
accuracy train: 0.783350 val: 0.769231 test: 0.769837
max validation accuracy : 0.769231 max acc epoch : 2 test accuracy : 0.769837
Counter({0: 5639, 1: 5023})
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  80.10049925744534 Time :  38
accuracy train: 0.802714 val: 0.769231 test: 0.770118
max validation accuracy : 0.769231 max acc epoch : 2 test accuracy : 0.769837
Counter({0: 5828, 1: 4834})
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.67598029971123 Time :  60
accuracy train: 0.813307 val: 0.767355 test: 0.776308
max validation accuracy : 0.769231 max acc epoch : 2 test accuracy : 0.769837
Counter({1: 5819, 0: 4843})
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  74.36036515235901 Time :  73
accuracy train: 0.821251 val: 0.773921 test: 0.774339
max validation accuracy : 0.773921 max acc epoch : 5 test accuracy : 0.774339
Counter({0: 5841, 1: 4821})
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.49633847177029 Time :  85
accuracy train: 0.823072 val: 0.765478 test: 0.770400
max validation accuracy : 0.773921 max acc epoch : 5 test accuracy : 0.774339
Counter({1: 5871, 0: 4791})
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  69.61487305164337 Time :  96
accuracy train: 0.827706 val: 0.771107 test: 0.772088
max validation accuracy : 0.773921 max acc epoch : 5 test accuracy : 0.774339
Counter({0: 5897, 1: 4765})
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.67754086852074 Time :  108
accuracy train: 0.837471 val: 0.761726 test: 0.769555
max validation accuracy : 0.773921 max acc epoch : 5 test accuracy : 0.774339
Counter({1: 5896, 0: 4766})
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  66.8380367308855 Time :  121
accuracy train: 0.840285 val: 0.770169 test: 0.769274
max validation accuracy : 0.773921 max acc epoch : 5 test accuracy : 0.774339
Counter({1: 5936, 0: 4726})
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  66.68437919020653 Time :  133
accuracy train: 0.838299 val: 0.766417 test: 0.770681
max validation accuracy : 0.773921 max acc epoch : 5 test accuracy : 0.774339
Counter({0: 5910, 1: 4752})

Epoch :  11 loss training:  65.18094396591187 Time :  147
accuracy train: 0.845084 val: 0.768293 test: 0.772088
max validation accuracy : 0.773921 max acc epoch : 5 test accuracy : 0.774339
Counter({0: 5936, 1: 4726})

Epoch :  12 loss training:  64.33023232221603 Time :  160
accuracy train: 0.851705 val: 0.772983 test: 0.775746
max validation accuracy : 0.773921 max acc epoch : 5 test accuracy : 0.774339
Counter({1: 5947, 0: 4715})

Epoch :  13 loss training:  62.75173220038414 Time :  172
accuracy train: 0.856504 val: 0.773921 test: 0.774902
max validation accuracy : 0.773921 max acc epoch : 5 test accuracy : 0.774339
Counter({1: 5959, 0: 4703})

Epoch :  14 loss training:  61.4698443710804 Time :  185
accuracy train: 0.868587 val: 0.783302 test: 0.773213
max validation accuracy : 0.783302 max acc epoch : 14 test accuracy : 0.773213
Counter({1: 6042, 0: 4620})

Epoch :  15 loss training:  59.27909429371357 Time :  198
accuracy train: 0.873221 val: 0.779550 test: 0.772369
max validation accuracy : 0.783302 max acc epoch : 14 test accuracy : 0.773213
Counter({0: 6039, 1: 4623})

Epoch :  16 loss training:  57.9340295791626 Time :  214
accuracy train: 0.878021 val: 0.778612 test: 0.775183
max validation accuracy : 0.783302 max acc epoch : 14 test accuracy : 0.773213
Counter({0: 6038, 1: 4624})

Epoch :  17 loss training:  55.36580540239811 Time :  227
accuracy train: 0.885799 val: 0.778612 test: 0.774057
max validation accuracy : 0.783302 max acc epoch : 14 test accuracy : 0.773213
Counter({0: 6078, 1: 4584})

Epoch :  18 loss training:  53.47448182106018 Time :  239
accuracy train: 0.894902 val: 0.779550 test: 0.775464
max validation accuracy : 0.783302 max acc epoch : 14 test accuracy : 0.773213
Counter({1: 6028, 0: 4634})

Epoch :  19 loss training:  51.89209496229887 Time :  252
accuracy train: 0.903343 val: 0.780488 test: 0.772369
max validation accuracy : 0.783302 max acc epoch : 14 test accuracy : 0.773213
Counter({1: 5990, 0: 4672})

Epoch :  20 loss training:  49.43111918121576 Time :  264
accuracy train: 0.909302 val: 0.779550 test: 0.774339
max validation accuracy : 0.783302 max acc epoch : 14 test accuracy : 0.773213
Counter({0: 6023, 1: 4639})

Epoch :  21 loss training:  49.52295960485935 Time :  284
accuracy train: 0.911619 val: 0.780488 test: 0.775183
max validation accuracy : 0.783302 max acc epoch : 14 test accuracy : 0.773213
Counter({0: 6025, 1: 4637})

Epoch :  22 loss training:  46.972910441458225 Time :  297
accuracy train: 0.922542 val: 0.786116 test: 0.779966
max validation accuracy : 0.786116 max acc epoch : 22 test accuracy : 0.779966
Counter({0: 6051, 1: 4611})

Epoch :  23 loss training:  45.76359511911869 Time :  310
accuracy train: 0.926183 val: 0.781426 test: 0.780529
max validation accuracy : 0.786116 max acc epoch : 22 test accuracy : 0.779966
Counter({1: 6055, 0: 4607})

Epoch :  24 loss training:  44.60304056853056 Time :  323
accuracy train: 0.933797 val: 0.781426 test: 0.776027
max validation accuracy : 0.786116 max acc epoch : 22 test accuracy : 0.779966
Counter({0: 6104, 1: 4558})

Epoch :  25 loss training:  41.75799570977688 Time :  334
accuracy train: 0.940086 val: 0.779550 test: 0.779403
max validation accuracy : 0.786116 max acc epoch : 22 test accuracy : 0.779966
Counter({0: 6070, 1: 4592})

Epoch :  26 loss training:  39.986133724451065 Time :  350
accuracy train: 0.945713 val: 0.782364 test: 0.779122
max validation accuracy : 0.786116 max acc epoch : 22 test accuracy : 0.779966
Counter({1: 6085, 0: 4577})

Epoch :  27 loss training:  38.241181537508965 Time :  362
accuracy train: 0.946706 val: 0.784240 test: 0.777153
max validation accuracy : 0.786116 max acc epoch : 22 test accuracy : 0.779966
Counter({0: 6104, 1: 4558})

Epoch :  28 loss training:  36.84438522905111 Time :  375
accuracy train: 0.951672 val: 0.780488 test: 0.775746
max validation accuracy : 0.786116 max acc epoch : 22 test accuracy : 0.779966
Counter({0: 6075, 1: 4587})

Epoch :  29 loss training:  35.29833967983723 Time :  388
accuracy train: 0.957795 val: 0.782364 test: 0.771806
max validation accuracy : 0.786116 max acc epoch : 22 test accuracy : 0.779966
Counter({0: 6105, 1: 4557})

Epoch :  30 loss training:  35.14847173914313 Time :  400
accuracy train: 0.959782 val: 0.778612 test: 0.777153
max validation accuracy : 0.786116 max acc epoch : 22 test accuracy : 0.779966
Counter({1: 6121, 0: 4541})

Epoch :  31 loss training:  32.9045357555151 Time :  413
accuracy train: 0.966402 val: 0.783302 test: 0.776590
max validation accuracy : 0.786116 max acc epoch : 22 test accuracy : 0.779966
Counter({0: 6132, 1: 4530})

Epoch :  32 loss training:  30.18081345409155 Time :  425
accuracy train: 0.965905 val: 0.783302 test: 0.776871
max validation accuracy : 0.786116 max acc epoch : 22 test accuracy : 0.779966
Counter({1: 6097, 0: 4565})

Epoch :  33 loss training:  29.933387633413076 Time :  441
accuracy train: 0.974677 val: 0.781426 test: 0.774339
max validation accuracy : 0.786116 max acc epoch : 22 test accuracy : 0.779966
Counter({0: 6119, 1: 4543})

========================================================================================================================================================================================================
best acc epoch :  22
validation accuracy :  0.7861163227016885
test accuracy :  0.7799662352279122
last test_accuracy :  0.7743387732132808
second best val :  0.7842401500938087
second best test :  0.7799662352279122
max gap 9
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=849, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 6228, 0: 4434})

Epoch :  1 loss training:  91.26161202788353 Time :  457
accuracy train: 0.779709 val: 0.743902 test: 0.759426
max validation accuracy : 0.743902 max acc epoch : 1 test accuracy : 0.759426
Counter({1: 6144, 0: 4518})
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  81.92527136206627 Time :  469
accuracy train: 0.792618 val: 0.757974 test: 0.770681
max validation accuracy : 0.757974 max acc epoch : 2 test accuracy : 0.770681
Counter({0: 6056, 1: 4606})
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  80.23023030161858 Time :  482
accuracy train: 0.800563 val: 0.751407 test: 0.770962
max validation accuracy : 0.757974 max acc epoch : 2 test accuracy : 0.770681
Counter({1: 6094, 0: 4568})
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.51306149363518 Time :  494
accuracy train: 0.807183 val: 0.758912 test: 0.771806
max validation accuracy : 0.758912 max acc epoch : 4 test accuracy : 0.771806
Counter({0: 6129, 1: 4533})
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  73.20215737819672 Time :  507
accuracy train: 0.810162 val: 0.755159 test: 0.771806
max validation accuracy : 0.758912 max acc epoch : 4 test accuracy : 0.771806
Counter({1: 6149, 0: 4513})
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  71.39645931124687 Time :  520
accuracy train: 0.823403 val: 0.762664 test: 0.774902
max validation accuracy : 0.762664 max acc epoch : 6 test accuracy : 0.774902
Counter({0: 6183, 1: 4479})
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  70.27560050785542 Time :  533
accuracy train: 0.829692 val: 0.767355 test: 0.777715
max validation accuracy : 0.767355 max acc epoch : 7 test accuracy : 0.777715
Counter({1: 6224, 0: 4438})
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  68.4879404604435 Time :  545
accuracy train: 0.826879 val: 0.766417 test: 0.774057
max validation accuracy : 0.767355 max acc epoch : 7 test accuracy : 0.777715
Counter({1: 6209, 0: 4453})
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  67.91396224498749 Time :  557
accuracy train: 0.834823 val: 0.766417 test: 0.780248
max validation accuracy : 0.767355 max acc epoch : 7 test accuracy : 0.777715
Counter({1: 6208, 0: 4454})
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  66.1523020863533 Time :  575
accuracy train: 0.839126 val: 0.773921 test: 0.776027
max validation accuracy : 0.773921 max acc epoch : 10 test accuracy : 0.776027
Counter({1: 6239, 0: 4423})

Epoch :  11 loss training:  65.34448592364788 Time :  588
accuracy train: 0.838630 val: 0.769231 test: 0.779685
max validation accuracy : 0.773921 max acc epoch : 10 test accuracy : 0.776027
Counter({0: 6231, 1: 4431})

Epoch :  12 loss training:  64.03450421988964 Time :  601
accuracy train: 0.850215 val: 0.774859 test: 0.782217
max validation accuracy : 0.774859 max acc epoch : 12 test accuracy : 0.782217
Counter({0: 6248, 1: 4414})

Epoch :  13 loss training:  61.944015860557556 Time :  614
accuracy train: 0.848395 val: 0.768293 test: 0.778841
max validation accuracy : 0.774859 max acc epoch : 12 test accuracy : 0.782217
Counter({0: 6259, 1: 4403})

Epoch :  14 loss training:  62.03799942135811 Time :  627
accuracy train: 0.865938 val: 0.774859 test: 0.782217
max validation accuracy : 0.774859 max acc epoch : 12 test accuracy : 0.782217
Counter({1: 6292, 0: 4370})

Epoch :  15 loss training:  59.98522584140301 Time :  644
accuracy train: 0.867759 val: 0.773921 test: 0.783624
max validation accuracy : 0.774859 max acc epoch : 12 test accuracy : 0.782217
Counter({0: 6304, 1: 4358})

Epoch :  16 loss training:  57.963981330394745 Time :  656
accuracy train: 0.870242 val: 0.779550 test: 0.782499
max validation accuracy : 0.779550 max acc epoch : 16 test accuracy : 0.782499
Counter({0: 6305, 1: 4357})

Epoch :  17 loss training:  55.88360334932804 Time :  669
accuracy train: 0.883317 val: 0.775797 test: 0.783624
max validation accuracy : 0.779550 max acc epoch : 16 test accuracy : 0.782499
Counter({1: 6344, 0: 4318})

Epoch :  18 loss training:  54.035059720277786 Time :  682
accuracy train: 0.889110 val: 0.777674 test: 0.783624
max validation accuracy : 0.779550 max acc epoch : 16 test accuracy : 0.782499
Counter({1: 6350, 0: 4312})

Epoch :  19 loss training:  52.01085241883993 Time :  695
accuracy train: 0.898544 val: 0.775797 test: 0.783343
max validation accuracy : 0.779550 max acc epoch : 16 test accuracy : 0.782499
Counter({0: 6377, 1: 4285})

Epoch :  20 loss training:  50.25963006913662 Time :  708
accuracy train: 0.905991 val: 0.780488 test: 0.776027
max validation accuracy : 0.780488 max acc epoch : 20 test accuracy : 0.776027
Counter({0: 6388, 1: 4274})

Epoch :  21 loss training:  49.02933610975742 Time :  721
accuracy train: 0.908309 val: 0.778612 test: 0.781654
max validation accuracy : 0.780488 max acc epoch : 20 test accuracy : 0.776027
Counter({1: 6404, 0: 4258})

Epoch :  22 loss training:  47.19174314290285 Time :  734
accuracy train: 0.918239 val: 0.772045 test: 0.782499
max validation accuracy : 0.780488 max acc epoch : 20 test accuracy : 0.776027
Counter({1: 6408, 0: 4254})

Epoch :  23 loss training:  46.05379864573479 Time :  748
accuracy train: 0.924197 val: 0.781426 test: 0.781936
max validation accuracy : 0.781426 max acc epoch : 23 test accuracy : 0.781936
Counter({0: 6437, 1: 4225})

Epoch :  24 loss training:  43.42554444074631 Time :  761
accuracy train: 0.928666 val: 0.782364 test: 0.780529
max validation accuracy : 0.782364 max acc epoch : 24 test accuracy : 0.780529
Counter({1: 6465, 0: 4197})

Epoch :  25 loss training:  41.43944173306227 Time :  780
accuracy train: 0.940252 val: 0.779550 test: 0.781936
max validation accuracy : 0.782364 max acc epoch : 24 test accuracy : 0.780529
Counter({0: 6492, 1: 4170})

Epoch :  26 loss training:  39.57549995929003 Time :  793
accuracy train: 0.943396 val: 0.785178 test: 0.782499
max validation accuracy : 0.785178 max acc epoch : 26 test accuracy : 0.782499
Counter({0: 6471, 1: 4191})

Epoch :  27 loss training:  38.189917638897896 Time :  806
accuracy train: 0.948527 val: 0.780488 test: 0.783061
max validation accuracy : 0.785178 max acc epoch : 26 test accuracy : 0.782499
Counter({1: 6467, 0: 4195})

Epoch :  28 loss training:  36.04370926320553 Time :  819
accuracy train: 0.955975 val: 0.779550 test: 0.780248
max validation accuracy : 0.785178 max acc epoch : 26 test accuracy : 0.782499
Counter({0: 6471, 1: 4191})

Epoch :  29 loss training:  35.89784976840019 Time :  831
accuracy train: 0.961437 val: 0.771107 test: 0.781373
max validation accuracy : 0.785178 max acc epoch : 26 test accuracy : 0.782499
Counter({0: 6463, 1: 4199})

Epoch :  30 loss training:  34.07475719600916 Time :  850
accuracy train: 0.961437 val: 0.770169 test: 0.779685
max validation accuracy : 0.785178 max acc epoch : 26 test accuracy : 0.782499
Counter({1: 6450, 0: 4212})

Epoch :  31 loss training:  32.77175682783127 Time :  863
accuracy train: 0.966236 val: 0.771107 test: 0.775746
max validation accuracy : 0.785178 max acc epoch : 26 test accuracy : 0.782499
Counter({0: 6466, 1: 4196})

Epoch :  32 loss training:  31.451771568506956 Time :  876
accuracy train: 0.969878 val: 0.772045 test: 0.776871
max validation accuracy : 0.785178 max acc epoch : 26 test accuracy : 0.782499
Counter({0: 6457, 1: 4205})

Epoch :  33 loss training:  29.722144205123186 Time :  889
accuracy train: 0.973022 val: 0.772983 test: 0.774620
max validation accuracy : 0.785178 max acc epoch : 26 test accuracy : 0.782499
Counter({1: 6443, 0: 4219})

Epoch :  34 loss training:  27.926521968096495 Time :  902
accuracy train: 0.974843 val: 0.773921 test: 0.777715
max validation accuracy : 0.785178 max acc epoch : 26 test accuracy : 0.782499
Counter({0: 6413, 1: 4249})

Epoch :  35 loss training:  27.08343192189932 Time :  918
accuracy train: 0.978153 val: 0.770169 test: 0.777715
max validation accuracy : 0.785178 max acc epoch : 26 test accuracy : 0.782499
Counter({1: 6430, 0: 4232})

Epoch :  36 loss training:  25.623480644077063 Time :  930
accuracy train: 0.979477 val: 0.773921 test: 0.776871
max validation accuracy : 0.785178 max acc epoch : 26 test accuracy : 0.782499
Counter({1: 6410, 0: 4252})

Epoch :  37 loss training:  25.092946376651525 Time :  944
accuracy train: 0.982622 val: 0.774859 test: 0.774902
max validation accuracy : 0.785178 max acc epoch : 26 test accuracy : 0.782499
Counter({0: 6406, 1: 4256})

========================================================================================================================================================================================================
best acc epoch :  26
validation accuracy :  0.7851782363977486
test accuracy :  0.7824985931344963
last test_accuracy :  0.7749015194147439
second best val :  0.7823639774859287
second best test :  0.7805289814293753
max gap 4
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=70, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({1: 6221, 0: 4441})

Epoch :  1 loss training:  93.15700209140778 Time :  960
accuracy train: 0.769282 val: 0.742964 test: 0.749859
max validation accuracy : 0.742964 max acc epoch : 1 test accuracy : 0.749859
Counter({0: 5351, 1: 5311})
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.80138593912125 Time :  972
accuracy train: 0.788977 val: 0.769231 test: 0.772651
max validation accuracy : 0.769231 max acc epoch : 2 test accuracy : 0.772651
Counter({1: 5794, 0: 4868})
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  79.71160185337067 Time :  986
accuracy train: 0.801887 val: 0.768293 test: 0.775746
max validation accuracy : 0.769231 max acc epoch : 2 test accuracy : 0.772651
Counter({1: 5655, 0: 5007})
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.16636928915977 Time :  998
accuracy train: 0.805528 val: 0.773921 test: 0.776027
max validation accuracy : 0.773921 max acc epoch : 4 test accuracy : 0.776027
Counter({0: 5821, 1: 4841})
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  73.50489868223667 Time :  1013
accuracy train: 0.813307 val: 0.765478 test: 0.774339
max validation accuracy : 0.773921 max acc epoch : 4 test accuracy : 0.776027
Counter({0: 5787, 1: 4875})
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  72.65819174051285 Time :  1025
accuracy train: 0.821086 val: 0.772045 test: 0.770400
max validation accuracy : 0.773921 max acc epoch : 4 test accuracy : 0.776027
Counter({0: 5797, 1: 4865})
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  70.087657392025 Time :  1037
accuracy train: 0.820589 val: 0.766417 test: 0.777434
max validation accuracy : 0.773921 max acc epoch : 4 test accuracy : 0.776027
Counter({0: 5802, 1: 4860})
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  69.16679546236992 Time :  1052
accuracy train: 0.822741 val: 0.766417 test: 0.777153
max validation accuracy : 0.773921 max acc epoch : 4 test accuracy : 0.776027
Counter({1: 5844, 0: 4818})
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  68.16969922184944 Time :  1064
accuracy train: 0.832175 val: 0.772045 test: 0.776590
max validation accuracy : 0.773921 max acc epoch : 4 test accuracy : 0.776027
Counter({0: 5907, 1: 4755})
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  67.18313907086849 Time :  1078
accuracy train: 0.835485 val: 0.772045 test: 0.774339
max validation accuracy : 0.773921 max acc epoch : 4 test accuracy : 0.776027
Counter({1: 5870, 0: 4792})

Epoch :  11 loss training:  65.08393040299416 Time :  1090
accuracy train: 0.839788 val: 0.773921 test: 0.776590
max validation accuracy : 0.773921 max acc epoch : 4 test accuracy : 0.776027
Counter({0: 5919, 1: 4743})

Epoch :  12 loss training:  64.2578359991312 Time :  1103
accuracy train: 0.845581 val: 0.773921 test: 0.776871
max validation accuracy : 0.773921 max acc epoch : 4 test accuracy : 0.776027
Counter({1: 5955, 0: 4707})

Epoch :  13 loss training:  63.80933015048504 Time :  1115
accuracy train: 0.848395 val: 0.773921 test: 0.774057
max validation accuracy : 0.773921 max acc epoch : 4 test accuracy : 0.776027
Counter({0: 5947, 1: 4715})

Epoch :  14 loss training:  61.5579045265913 Time :  1128
accuracy train: 0.858656 val: 0.772045 test: 0.775183
max validation accuracy : 0.773921 max acc epoch : 4 test accuracy : 0.776027
Counter({1: 5977, 0: 4685})

Epoch :  15 loss training:  59.67885810136795 Time :  1140
accuracy train: 0.866435 val: 0.767355 test: 0.780529
max validation accuracy : 0.773921 max acc epoch : 4 test accuracy : 0.776027
Counter({0: 5980, 1: 4682})

========================================================================================================================================================================================================
best acc epoch :  4
validation accuracy :  0.773921200750469
test accuracy :  0.7760270118176702
last test_accuracy :  0.7805289814293753
second best val :  0.7720450281425891
second best test :  0.7760270118176702
max gap 2
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.0005, num_clusters=2, num_exp=4, num_layers=3, num_mlp_layers=1, random_vec=False, seed=67, tsne=False, val_prop=0.15, weight_decay=0)
device :  cuda:0
Counter({0: 6196, 1: 4466})

Epoch :  1 loss training:  90.8730663061142 Time :  1154
accuracy train: 0.771930 val: 0.778612 test: 0.770118
max validation accuracy : 0.778612 max acc epoch : 1 test accuracy : 0.770118
Counter({0: 5798, 1: 4864})
Epoch-1 lr: 0.0005

Epoch :  2 loss training:  83.1966661810875 Time :  1167
accuracy train: 0.792122 val: 0.793621 test: 0.775746
max validation accuracy : 0.793621 max acc epoch : 2 test accuracy : 0.775746
Counter({1: 5882, 0: 4780})
Epoch-2 lr: 0.0005

Epoch :  3 loss training:  80.8212257027626 Time :  1179
accuracy train: 0.800563 val: 0.774859 test: 0.776590
max validation accuracy : 0.793621 max acc epoch : 2 test accuracy : 0.775746
Counter({0: 5617, 1: 5045})
Epoch-3 lr: 0.00025

Epoch :  4 loss training:  75.8084811270237 Time :  1191
accuracy train: 0.811321 val: 0.787054 test: 0.777153
max validation accuracy : 0.793621 max acc epoch : 2 test accuracy : 0.775746
Counter({0: 5601, 1: 5061})
Epoch-4 lr: 0.00025

Epoch :  5 loss training:  75.32034802436829 Time :  1203
accuracy train: 0.820258 val: 0.781426 test: 0.777434
max validation accuracy : 0.793621 max acc epoch : 2 test accuracy : 0.775746
Counter({1: 5937, 0: 4725})
Epoch-5 lr: 0.00025

Epoch :  6 loss training:  73.69213321805 Time :  1215
accuracy train: 0.819100 val: 0.786116 test: 0.777997
max validation accuracy : 0.793621 max acc epoch : 2 test accuracy : 0.775746
Counter({1: 5865, 0: 4797})
Epoch-6 lr: 0.000125

Epoch :  7 loss training:  70.33743233978748 Time :  1227
accuracy train: 0.821582 val: 0.785178 test: 0.782217
max validation accuracy : 0.793621 max acc epoch : 2 test accuracy : 0.775746
Counter({0: 5871, 1: 4791})
Epoch-7 lr: 0.000125

Epoch :  8 loss training:  70.07970912754536 Time :  1239
accuracy train: 0.826713 val: 0.777674 test: 0.784187
max validation accuracy : 0.793621 max acc epoch : 2 test accuracy : 0.775746
Counter({1: 5776, 0: 4886})
Epoch-8 lr: 0.000125

Epoch :  9 loss training:  68.60056610405445 Time :  1252
accuracy train: 0.834823 val: 0.786116 test: 0.783624
max validation accuracy : 0.793621 max acc epoch : 2 test accuracy : 0.775746
Counter({1: 5790, 0: 4872})
Epoch-9 lr: 6.25e-05

Epoch :  10 loss training:  67.52367980778217 Time :  1264
accuracy train: 0.835319 val: 0.779550 test: 0.781092
max validation accuracy : 0.793621 max acc epoch : 2 test accuracy : 0.775746
Counter({1: 5804, 0: 4858})

Epoch :  11 loss training:  66.9126977622509 Time :  1276
accuracy train: 0.844422 val: 0.777674 test: 0.786438
max validation accuracy : 0.793621 max acc epoch : 2 test accuracy : 0.775746
Counter({1: 5805, 0: 4857})

Epoch :  12 loss training:  64.25656273961067 Time :  1289
accuracy train: 0.847402 val: 0.786116 test: 0.783061
max validation accuracy : 0.793621 max acc epoch : 2 test accuracy : 0.775746
Counter({0: 5822, 1: 4840})

Epoch :  13 loss training:  63.937272265553474 Time :  1301
accuracy train: 0.851705 val: 0.774859 test: 0.778278
max validation accuracy : 0.793621 max acc epoch : 2 test accuracy : 0.775746
Counter({1: 5815, 0: 4847})

========================================================================================================================================================================================================
best acc epoch :  2
validation accuracy :  0.7936210131332082
test accuracy :  0.7757456387169387
last test_accuracy :  0.7782779966235228
second best val :  0.7870544090056285
second best test :  0.7757456387169387
max gap 1
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  22 	 val_accuracy : 0.78612 	 test_accuracy : 0.77997 	 last test_accuracy : 0.77434 	 second best val : 0.78424 	 second best test : 0.77997
k :  1 	 best_acc epoch :  26 	 val_accuracy : 0.78518 	 test_accuracy : 0.78250 	 last test_accuracy : 0.77490 	 second best val : 0.78236 	 second best test : 0.78053
k :  2 	 best_acc epoch :  4 	 val_accuracy : 0.77392 	 test_accuracy : 0.77603 	 last test_accuracy : 0.78053 	 second best val : 0.77205 	 second best test : 0.77603
k :  3 	 best_acc epoch :  2 	 val_accuracy : 0.79362 	 test_accuracy : 0.77575 	 last test_accuracy : 0.77828 	 second best val : 0.78705 	 second best test : 0.77575

avg :  	 val_accuracy : 0.78471 	 test_accuracy : 0.77856 	 last_accuracy : 0.77701 	 second best val : 0.78143 	 second best test : 0.77807

std :  	 val_accuracy : 0.00704 	 test_accuracy : 0.00282 	 last_accuracy : 0.00253 	 second best val : 0.00567 	 second best test : 0.00219
