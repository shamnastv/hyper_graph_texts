

date and time :  Tue Jun  8 21:27:01 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.5, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=978, weight_decay=0)
device :  cuda:0
Counter({1: 3470, 2: 2497, 0: 1433})

Epoch :  1 loss training:  305.6879292726517 Time :  484
accuracy train: 0.608206 val: 0.564179 test: 0.536977
max validation accuracy : 0.564179 max acc epoch : 1 test accuracy : 0.536977
Counter({1: 3372, 2: 2431, 0: 1597})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  192.99821984767914 Time :  545
accuracy train: 0.697551 val: 0.614925 test: 0.647292
max validation accuracy : 0.614925 max acc epoch : 2 test accuracy : 0.647292
Counter({2: 3387, 1: 2462, 0: 1551})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  149.22066289186478 Time :  625
accuracy train: 0.756784 val: 0.656716 test: 0.674994
max validation accuracy : 0.656716 max acc epoch : 3 test accuracy : 0.674994
Counter({1: 3436, 0: 2435, 2: 1529})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  118.57528138160706 Time :  700
accuracy train: 0.810390 val: 0.677612 test: 0.690576
max validation accuracy : 0.677612 max acc epoch : 4 test accuracy : 0.690576
Counter({1: 3443, 0: 2445, 2: 1512})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  101.09674081206322 Time :  784
accuracy train: 0.822303 val: 0.701493 test: 0.692308
max validation accuracy : 0.701493 max acc epoch : 5 test accuracy : 0.692308
Counter({2: 3437, 0: 2450, 1: 1513})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  94.01154491305351 Time :  866
accuracy train: 0.841496 val: 0.719403 test: 0.704427
max validation accuracy : 0.719403 max acc epoch : 6 test accuracy : 0.704427
Counter({2: 3487, 1: 2445, 0: 1468})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.56477795541286 Time :  932
accuracy train: 0.870285 val: 0.704478 test: 0.698739
max validation accuracy : 0.719403 max acc epoch : 6 test accuracy : 0.704427
Counter({0: 3481, 1: 2439, 2: 1480})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  73.90808761119843 Time :  998
accuracy train: 0.876903 val: 0.731343 test: 0.706901
max validation accuracy : 0.731343 max acc epoch : 8 test accuracy : 0.706901
Counter({0: 3470, 2: 2443, 1: 1487})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  67.30278661847115 Time :  1068
accuracy train: 0.894110 val: 0.689552 test: 0.699233
max validation accuracy : 0.731343 max acc epoch : 8 test accuracy : 0.706901
Counter({0: 3473, 1: 2451, 2: 1476})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.32556061446667 Time :  1105
accuracy train: 0.897750 val: 0.734328 test: 0.708632
max validation accuracy : 0.734328 max acc epoch : 10 test accuracy : 0.708632
Counter({2: 3466, 1: 2445, 0: 1489})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  57.44625958800316 Time :  1188
accuracy train: 0.899735 val: 0.719403 test: 0.710611
max validation accuracy : 0.734328 max acc epoch : 10 test accuracy : 0.708632
Counter({0: 3465, 1: 2454, 2: 1481})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  55.094300240278244 Time :  1273
accuracy train: 0.905030 val: 0.737313 test: 0.717536
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.717536
Counter({2: 3466, 1: 2452, 0: 1482})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  50.25132817029953 Time :  1348
accuracy train: 0.912641 val: 0.731343 test: 0.711848
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.717536
Counter({0: 3467, 1: 2452, 2: 1481})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  52.072795540094376 Time :  1422
accuracy train: 0.921244 val: 0.722388 test: 0.713579
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.717536
Counter({1: 3474, 2: 2446, 0: 1480})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  50.02017606794834 Time :  1498
accuracy train: 0.918928 val: 0.722388 test: 0.710364
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.717536
Counter({2: 3471, 0: 2450, 1: 1479})

Epoch :  16 loss training:  49.550094321370125 Time :  1576
accuracy train: 0.924884 val: 0.707463 test: 0.712342
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.717536
Counter({1: 3469, 2: 2455, 0: 1476})

Epoch :  17 loss training:  47.66542759537697 Time :  1664
accuracy train: 0.922568 val: 0.734328 test: 0.713084
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.717536
Counter({0: 3464, 1: 2455, 2: 1481})

Epoch :  18 loss training:  46.57049599289894 Time :  1722
accuracy train: 0.931502 val: 0.713433 test: 0.711848
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.717536
Counter({2: 3478, 1: 2451, 0: 1471})

Epoch :  19 loss training:  47.035933807492256 Time :  1811
accuracy train: 0.934150 val: 0.719403 test: 0.710611
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.717536
Counter({1: 3482, 0: 2455, 2: 1463})

Epoch :  20 loss training:  44.44046675413847 Time :  1903
accuracy train: 0.937128 val: 0.704478 test: 0.715063
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.717536
Counter({1: 3485, 2: 2455, 0: 1460})

Epoch :  21 loss training:  43.32435082644224 Time :  1985
accuracy train: 0.942753 val: 0.713433 test: 0.716794
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.717536
Counter({1: 3487, 0: 2455, 2: 1458})

Epoch :  22 loss training:  43.55829128623009 Time :  2065
accuracy train: 0.946062 val: 0.725373 test: 0.714074
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.717536
Counter({1: 3489, 2: 2453, 0: 1458})

Epoch :  23 loss training:  43.796033687889576 Time :  2135
accuracy train: 0.949371 val: 0.710448 test: 0.713826
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.717536
Counter({2: 3485, 1: 2452, 0: 1463})

Epoch :  24 loss training:  39.742697820067406 Time :  2209
accuracy train: 0.947717 val: 0.719403 test: 0.717289
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.717536
Counter({1: 3480, 2: 2452, 0: 1468})

Epoch :  25 loss training:  40.75692880153656 Time :  2283
accuracy train: 0.956320 val: 0.737313 test: 0.713332
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.717536
Counter({2: 3478, 0: 2457, 1: 1465})

Epoch :  26 loss training:  40.78843055665493 Time :  2343
accuracy train: 0.954666 val: 0.713433 test: 0.719763
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.717536
Counter({0: 3483, 2: 2454, 1: 1463})

Epoch :  27 loss training:  36.85114148259163 Time :  2421
accuracy train: 0.955989 val: 0.725373 test: 0.721989
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.717536
Counter({1: 3482, 0: 2459, 2: 1459})

Epoch :  28 loss training:  36.08780237287283 Time :  2499
accuracy train: 0.962938 val: 0.728358 test: 0.712342
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.717536
Counter({1: 3494, 0: 2455, 2: 1451})

Epoch :  29 loss training:  35.703691236674786 Time :  2584
accuracy train: 0.962277 val: 0.728358 test: 0.714321
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.717536
Counter({1: 3495, 0: 2455, 2: 1450})

Epoch :  30 loss training:  34.94235784560442 Time :  2673
accuracy train: 0.967240 val: 0.728358 test: 0.715310
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.717536
Counter({1: 3496, 0: 2451, 2: 1453})

Epoch :  31 loss training:  32.45962908118963 Time :  2737
accuracy train: 0.966248 val: 0.734328 test: 0.716547
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.717536
Counter({2: 3499, 0: 2454, 1: 1447})

Epoch :  32 loss training:  32.64708888530731 Time :  2818
accuracy train: 0.964593 val: 0.728358 test: 0.719268
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.717536
Counter({0: 3498, 1: 2454, 2: 1448})

Epoch :  33 loss training:  31.09747213125229 Time :  2897
accuracy train: 0.973858 val: 0.725373 test: 0.715310
max validation accuracy : 0.737313 max acc epoch : 12 test accuracy : 0.717536
Counter({2: 3494, 0: 2459, 1: 1447})

Epoch :  34 loss training:  30.16615830361843 Time :  2957
accuracy train: 0.973858 val: 0.740299 test: 0.719021
max validation accuracy : 0.740299 max acc epoch : 34 test accuracy : 0.719021
Counter({1: 3495, 2: 2457, 0: 1448})

Epoch :  35 loss training:  29.813624750822783 Time :  3015
accuracy train: 0.974520 val: 0.728358 test: 0.715558
max validation accuracy : 0.740299 max acc epoch : 34 test accuracy : 0.719021
Counter({2: 3487, 1: 2466, 0: 1447})

Epoch :  36 loss training:  28.786958530545235 Time :  3087
accuracy train: 0.979484 val: 0.725373 test: 0.717289
max validation accuracy : 0.740299 max acc epoch : 34 test accuracy : 0.719021
Counter({2: 3487, 0: 2451, 1: 1462})

Epoch :  37 loss training:  27.5248004719615 Time :  3155
accuracy train: 0.980477 val: 0.740299 test: 0.713084
max validation accuracy : 0.740299 max acc epoch : 34 test accuracy : 0.719021
Counter({0: 3473, 2: 2460, 1: 1467})

Epoch :  38 loss training:  27.647760663181543 Time :  3247
accuracy train: 0.984447 val: 0.737313 test: 0.718279
max validation accuracy : 0.740299 max acc epoch : 34 test accuracy : 0.719021
Counter({2: 3477, 0: 2460, 1: 1463})

Epoch :  39 loss training:  29.64829344302416 Time :  3338
accuracy train: 0.979153 val: 0.740299 test: 0.717784
max validation accuracy : 0.740299 max acc epoch : 34 test accuracy : 0.719021
Counter({2: 3497, 1: 2457, 0: 1446})

Epoch :  40 loss training:  27.111258566379547 Time :  3416
accuracy train: 0.983124 val: 0.731343 test: 0.720010
max validation accuracy : 0.740299 max acc epoch : 34 test accuracy : 0.719021
Counter({1: 3494, 2: 2453, 0: 1453})

Epoch :  41 loss training:  26.08755148202181 Time :  3486
accuracy train: 0.984447 val: 0.728358 test: 0.716300
max validation accuracy : 0.740299 max acc epoch : 34 test accuracy : 0.719021
Counter({0: 3496, 2: 2455, 1: 1449})

Epoch :  42 loss training:  26.023650038987398 Time :  3555
accuracy train: 0.990404 val: 0.740299 test: 0.712095
max validation accuracy : 0.740299 max acc epoch : 34 test accuracy : 0.719021
Counter({1: 3500, 0: 2453, 2: 1447})

Epoch :  43 loss training:  24.769017169252038 Time :  3618
accuracy train: 0.986102 val: 0.713433 test: 0.722236
max validation accuracy : 0.740299 max acc epoch : 34 test accuracy : 0.719021
Counter({0: 3510, 1: 2447, 2: 1443})

Epoch :  44 loss training:  25.410761825740337 Time :  3685
accuracy train: 0.989080 val: 0.731343 test: 0.719515
max validation accuracy : 0.740299 max acc epoch : 34 test accuracy : 0.719021
Counter({0: 3508, 2: 2454, 1: 1438})

Epoch :  45 loss training:  23.27170407027006 Time :  3750
accuracy train: 0.990404 val: 0.719403 test: 0.713332
max validation accuracy : 0.740299 max acc epoch : 34 test accuracy : 0.719021
Counter({0: 3514, 1: 2455, 2: 1431})

Epoch :  46 loss training:  23.830126026645303 Time :  3813
accuracy train: 0.992058 val: 0.731343 test: 0.717289
max validation accuracy : 0.740299 max acc epoch : 34 test accuracy : 0.719021
Counter({0: 3514, 1: 2461, 2: 1425})

Epoch :  47 loss training:  21.78052280470729 Time :  3891
accuracy train: 0.991396 val: 0.731343 test: 0.715063
max validation accuracy : 0.740299 max acc epoch : 34 test accuracy : 0.719021
Counter({0: 3507, 1: 2459, 2: 1434})

Epoch :  48 loss training:  20.504565751180053 Time :  3971
accuracy train: 0.990735 val: 0.725373 test: 0.712837
max validation accuracy : 0.740299 max acc epoch : 34 test accuracy : 0.719021
Counter({0: 3513, 1: 2459, 2: 1428})

Epoch :  49 loss training:  21.059755505993962 Time :  4042
accuracy train: 0.995036 val: 0.725373 test: 0.714568
max validation accuracy : 0.740299 max acc epoch : 34 test accuracy : 0.719021
Counter({1: 3526, 0: 2457, 2: 1417})

Epoch :  50 loss training:  20.997884016484022 Time :  4111
accuracy train: 0.993051 val: 0.725373 test: 0.710611
max validation accuracy : 0.740299 max acc epoch : 34 test accuracy : 0.719021
Counter({0: 3514, 1: 2458, 2: 1428})

Epoch :  51 loss training:  19.292419243603945 Time :  4172
accuracy train: 0.994044 val: 0.722388 test: 0.715063
max validation accuracy : 0.740299 max acc epoch : 34 test accuracy : 0.719021
Counter({2: 3521, 1: 2456, 0: 1423})

Epoch :  52 loss training:  19.154778584837914 Time :  4232
accuracy train: 0.997022 val: 0.734328 test: 0.714816
max validation accuracy : 0.740299 max acc epoch : 34 test accuracy : 0.719021
Counter({1: 3520, 0: 2456, 2: 1424})

Epoch :  53 loss training:  18.965769546106458 Time :  4292
accuracy train: 0.994375 val: 0.725373 test: 0.717289
max validation accuracy : 0.740299 max acc epoch : 34 test accuracy : 0.719021
Counter({1: 3528, 0: 2449, 2: 1423})

Epoch :  54 loss training:  18.324397444725037 Time :  4350
accuracy train: 0.997353 val: 0.734328 test: 0.720752
max validation accuracy : 0.740299 max acc epoch : 34 test accuracy : 0.719021
Counter({0: 3527, 1: 2451, 2: 1422})

Epoch :  55 loss training:  18.25967308692634 Time :  4425
accuracy train: 0.995698 val: 0.731343 test: 0.718773
max validation accuracy : 0.740299 max acc epoch : 34 test accuracy : 0.719021
Counter({1: 3531, 0: 2451, 2: 1418})

Epoch :  56 loss training:  17.57483165152371 Time :  4486
accuracy train: 0.996360 val: 0.734328 test: 0.715063
max validation accuracy : 0.740299 max acc epoch : 34 test accuracy : 0.719021
Counter({0: 3529, 2: 2451, 1: 1420})

Epoch :  57 loss training:  17.218504071235657 Time :  4555
accuracy train: 0.998345 val: 0.752239 test: 0.715558
max validation accuracy : 0.752239 max acc epoch : 57 test accuracy : 0.715558
Counter({0: 3526, 2: 2452, 1: 1422})

Epoch :  58 loss training:  16.29070020839572 Time :  4624
accuracy train: 0.997684 val: 0.737313 test: 0.714074
max validation accuracy : 0.752239 max acc epoch : 57 test accuracy : 0.715558
Counter({1: 3536, 2: 2444, 0: 1420})

Epoch :  59 loss training:  16.5262447334826 Time :  4694
accuracy train: 0.998015 val: 0.749254 test: 0.718279
max validation accuracy : 0.752239 max acc epoch : 57 test accuracy : 0.715558
Counter({2: 3533, 0: 2453, 1: 1414})

Epoch :  60 loss training:  14.633642429485917 Time :  4766
accuracy train: 0.998345 val: 0.728358 test: 0.719268
max validation accuracy : 0.752239 max acc epoch : 57 test accuracy : 0.715558
Counter({0: 3542, 1: 2451, 2: 1407})

Epoch :  61 loss training:  15.148246932774782 Time :  4836
accuracy train: 0.998345 val: 0.731343 test: 0.715558
max validation accuracy : 0.752239 max acc epoch : 57 test accuracy : 0.715558
Counter({1: 3529, 2: 2456, 0: 1415})

Epoch :  62 loss training:  14.126419939100742 Time :  4914
accuracy train: 0.998676 val: 0.725373 test: 0.716052
max validation accuracy : 0.752239 max acc epoch : 57 test accuracy : 0.715558
Counter({1: 3531, 0: 2456, 2: 1413})

Epoch :  63 loss training:  14.542094051837921 Time :  4984
accuracy train: 0.999007 val: 0.722388 test: 0.715310
max validation accuracy : 0.752239 max acc epoch : 57 test accuracy : 0.715558
Counter({1: 3528, 0: 2455, 2: 1417})

Epoch :  64 loss training:  15.010264167562127 Time :  5056
accuracy train: 0.998345 val: 0.734328 test: 0.724957
max validation accuracy : 0.752239 max acc epoch : 57 test accuracy : 0.715558
Counter({2: 3531, 0: 2450, 1: 1419})

Epoch :  65 loss training:  15.030443783849478 Time :  5121
accuracy train: 0.998345 val: 0.740299 test: 0.720999
max validation accuracy : 0.752239 max acc epoch : 57 test accuracy : 0.715558
Counter({0: 3523, 1: 2457, 2: 1420})

Epoch :  66 loss training:  14.783459562808275 Time :  5191
accuracy train: 0.998015 val: 0.755224 test: 0.718773
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({2: 3520, 0: 2452, 1: 1428})

Epoch :  67 loss training:  11.969095062464476 Time :  5272
accuracy train: 0.999338 val: 0.746269 test: 0.719021
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({2: 3520, 0: 2451, 1: 1429})

Epoch :  68 loss training:  11.806966757401824 Time :  5338
accuracy train: 0.999007 val: 0.752239 test: 0.724462
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({2: 3522, 1: 2453, 0: 1425})

Epoch :  69 loss training:  11.838008806109428 Time :  5397
accuracy train: 0.998015 val: 0.743284 test: 0.718279
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({1: 3527, 0: 2454, 2: 1419})

Epoch :  70 loss training:  11.860028681345284 Time :  5454
accuracy train: 0.998345 val: 0.737313 test: 0.720999
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({0: 3540, 2: 2449, 1: 1411})

Epoch :  71 loss training:  11.690182385966182 Time :  5511
accuracy train: 0.999007 val: 0.734328 test: 0.718773
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({2: 3522, 0: 2454, 1: 1424})

Epoch :  72 loss training:  11.90652677230537 Time :  5589
accuracy train: 0.998676 val: 0.734328 test: 0.720257
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({0: 3535, 2: 2452, 1: 1413})

Epoch :  73 loss training:  10.35602315980941 Time :  5658
accuracy train: 0.999669 val: 0.746269 test: 0.722978
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({1: 3569, 0: 2436, 2: 1395})

Epoch :  74 loss training:  10.425611696206033 Time :  5724
accuracy train: 0.999338 val: 0.740299 test: 0.718279
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({2: 3581, 0: 2438, 1: 1381})

Epoch :  75 loss training:  11.501040847972035 Time :  5791
accuracy train: 0.999669 val: 0.752239 test: 0.720010
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({1: 3530, 0: 2452, 2: 1418})

Epoch :  76 loss training:  11.101165088824928 Time :  5861
accuracy train: 0.998676 val: 0.740299 test: 0.713579
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({2: 3536, 1: 2452, 0: 1412})

Epoch :  77 loss training:  9.702423833776265 Time :  5940
accuracy train: 0.999669 val: 0.731343 test: 0.719515
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({2: 3537, 1: 2449, 0: 1414})

Epoch :  78 loss training:  10.545180270448327 Time :  6001
accuracy train: 0.999338 val: 0.749254 test: 0.715063
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({0: 3550, 1: 2444, 2: 1406})

Epoch :  79 loss training:  10.210670817643404 Time :  6065
accuracy train: 0.999669 val: 0.740299 test: 0.713579
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({1: 3562, 2: 2439, 0: 1399})

Epoch :  80 loss training:  9.950722683686763 Time :  6120
accuracy train: 0.999669 val: 0.749254 test: 0.723225
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({1: 3557, 2: 2440, 0: 1403})

Epoch :  81 loss training:  9.153411431238055 Time :  6183
accuracy train: 1.000000 val: 0.734328 test: 0.721247
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({0: 3544, 2: 2445, 1: 1411})

Epoch :  82 loss training:  8.613566175103188 Time :  6243
accuracy train: 0.998676 val: 0.728358 test: 0.716052
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({1: 3539, 2: 2450, 0: 1411})

Epoch :  83 loss training:  8.63061136752367 Time :  6303
accuracy train: 0.999669 val: 0.734328 test: 0.715805
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({2: 3542, 1: 2445, 0: 1413})

Epoch :  84 loss training:  8.033427972346544 Time :  6361
accuracy train: 0.999007 val: 0.737313 test: 0.721989
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({2: 3539, 1: 2450, 0: 1411})

Epoch :  85 loss training:  8.080038788262755 Time :  6422
accuracy train: 0.999669 val: 0.749254 test: 0.717536
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({2: 3549, 0: 2447, 1: 1404})

Epoch :  86 loss training:  7.930359703488648 Time :  6472
accuracy train: 0.999669 val: 0.749254 test: 0.717536
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({1: 3542, 2: 2448, 0: 1410})

Epoch :  87 loss training:  8.191572764888406 Time :  6527
accuracy train: 0.999669 val: 0.749254 test: 0.723225
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({1: 3554, 0: 2444, 2: 1402})

Epoch :  88 loss training:  7.788158182054758 Time :  6583
accuracy train: 1.000000 val: 0.737313 test: 0.722731
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({1: 3575, 2: 2429, 0: 1396})

Epoch :  89 loss training:  7.401652836706489 Time :  6636
accuracy train: 0.999669 val: 0.752239 test: 0.726935
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({2: 3551, 0: 2442, 1: 1407})

Epoch :  90 loss training:  7.850855304859579 Time :  6682
accuracy train: 0.999669 val: 0.752239 test: 0.723967
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({1: 3551, 2: 2440, 0: 1409})

Epoch :  91 loss training:  8.414884521160275 Time :  6725
accuracy train: 1.000000 val: 0.734328 test: 0.724462
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({2: 3541, 1: 2438, 0: 1421})

Epoch :  92 loss training:  7.233944027218968 Time :  6782
accuracy train: 1.000000 val: 0.722388 test: 0.721741
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({1: 3558, 0: 2434, 2: 1408})

Epoch :  93 loss training:  5.894837756175548 Time :  6842
accuracy train: 1.000000 val: 0.749254 test: 0.714568
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({1: 3558, 2: 2432, 0: 1410})

Epoch :  94 loss training:  6.8452250505797565 Time :  6906
accuracy train: 1.000000 val: 0.734328 test: 0.720752
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({1: 3566, 2: 2432, 0: 1402})

Epoch :  95 loss training:  6.71736112004146 Time :  6964
accuracy train: 0.999669 val: 0.728358 test: 0.717289
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({1: 3555, 0: 2438, 2: 1407})

Epoch :  96 loss training:  6.869642560370266 Time :  7018
accuracy train: 1.000000 val: 0.740299 test: 0.719515
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({1: 3578, 2: 2429, 0: 1393})

Epoch :  97 loss training:  6.117058688774705 Time :  7071
accuracy train: 1.000000 val: 0.740299 test: 0.718031
max validation accuracy : 0.755224 max acc epoch : 66 test accuracy : 0.718773
Counter({0: 3577, 2: 2437, 1: 1386})

========================================================================================================================================================================================================
max acc epoch :  66
max validation accuracy :  0.755223880597015
test accuracy :  0.7187731882265644
last test_accuracy :  0.7180311649765025
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.5, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=978, weight_decay=0)
device :  cuda:0
Counter({2: 3470, 0: 2497, 1: 1433})

Epoch :  1 loss training:  306.30833262205124 Time :  7361
accuracy train: 0.615486 val: 0.555224 test: 0.550087
max validation accuracy : 0.555224 max acc epoch : 1 test accuracy : 0.550087
Counter({2: 3443, 1: 2474, 0: 1483})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  190.74936479330063 Time :  7424
accuracy train: 0.694242 val: 0.623881 test: 0.644818
max validation accuracy : 0.623881 max acc epoch : 2 test accuracy : 0.644818
Counter({0: 3424, 2: 2423, 1: 1553})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  151.094585865736 Time :  7471
accuracy train: 0.751820 val: 0.656716 test: 0.663863
max validation accuracy : 0.656716 max acc epoch : 3 test accuracy : 0.663863
Counter({2: 3392, 1: 2412, 0: 1596})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  122.49368289113045 Time :  7536
accuracy train: 0.805096 val: 0.668657 test: 0.688845
max validation accuracy : 0.668657 max acc epoch : 4 test accuracy : 0.688845
Counter({1: 3446, 2: 2421, 0: 1533})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  102.97958999872208 Time :  7602
accuracy train: 0.824619 val: 0.662687 test: 0.690082
max validation accuracy : 0.668657 max acc epoch : 4 test accuracy : 0.688845
Counter({2: 3440, 0: 2432, 1: 1528})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  95.04614168405533 Time :  7674
accuracy train: 0.844474 val: 0.701493 test: 0.701707
max validation accuracy : 0.701493 max acc epoch : 6 test accuracy : 0.701707
Counter({0: 3471, 1: 2442, 2: 1487})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  78.37500327825546 Time :  7751
accuracy train: 0.864659 val: 0.716418 test: 0.702449
max validation accuracy : 0.716418 max acc epoch : 7 test accuracy : 0.702449
Counter({2: 3486, 1: 2439, 0: 1475})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.04086738824844 Time :  7827
accuracy train: 0.873263 val: 0.728358 test: 0.701954
max validation accuracy : 0.728358 max acc epoch : 8 test accuracy : 0.701954
Counter({2: 3449, 0: 2446, 1: 1505})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  67.08568359911442 Time :  7868
accuracy train: 0.890801 val: 0.695522 test: 0.692555
max validation accuracy : 0.728358 max acc epoch : 8 test accuracy : 0.701954
Counter({0: 3461, 1: 2456, 2: 1483})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.60828894376755 Time :  7957
accuracy train: 0.897750 val: 0.722388 test: 0.703933
max validation accuracy : 0.728358 max acc epoch : 8 test accuracy : 0.701954
Counter({1: 3464, 2: 2452, 0: 1484})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  57.92552191019058 Time :  8019
accuracy train: 0.904037 val: 0.719403 test: 0.704675
max validation accuracy : 0.728358 max acc epoch : 8 test accuracy : 0.701954
Counter({1: 3456, 2: 2453, 0: 1491})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  56.405665166676044 Time :  8085
accuracy train: 0.898412 val: 0.710448 test: 0.711600
max validation accuracy : 0.728358 max acc epoch : 8 test accuracy : 0.701954
Counter({1: 3450, 2: 2445, 0: 1505})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  52.26347194612026 Time :  8147
accuracy train: 0.910986 val: 0.719403 test: 0.709374
max validation accuracy : 0.728358 max acc epoch : 8 test accuracy : 0.701954
Counter({1: 3461, 2: 2443, 0: 1496})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  52.09356510639191 Time :  8210
accuracy train: 0.919259 val: 0.716418 test: 0.706653
max validation accuracy : 0.728358 max acc epoch : 8 test accuracy : 0.701954
Counter({0: 3460, 2: 2451, 1: 1489})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  50.430991157889366 Time :  8268
accuracy train: 0.917273 val: 0.731343 test: 0.709127
max validation accuracy : 0.731343 max acc epoch : 15 test accuracy : 0.709127
Counter({0: 3471, 1: 2445, 2: 1484})

Epoch :  16 loss training:  51.168663650751114 Time :  8324
accuracy train: 0.921575 val: 0.716418 test: 0.704427
max validation accuracy : 0.731343 max acc epoch : 15 test accuracy : 0.709127
Counter({0: 3451, 2: 2458, 1: 1491})

Epoch :  17 loss training:  48.22430796176195 Time :  8394
accuracy train: 0.922568 val: 0.725373 test: 0.707643
max validation accuracy : 0.731343 max acc epoch : 15 test accuracy : 0.709127
Counter({0: 3451, 1: 2456, 2: 1493})

Epoch :  18 loss training:  46.799516305327415 Time :  8447
accuracy train: 0.930510 val: 0.734328 test: 0.707643
max validation accuracy : 0.734328 max acc epoch : 18 test accuracy : 0.707643
Counter({1: 3464, 2: 2450, 0: 1486})

Epoch :  19 loss training:  46.871637873351574 Time :  8508
accuracy train: 0.931502 val: 0.737313 test: 0.707643
max validation accuracy : 0.737313 max acc epoch : 19 test accuracy : 0.707643
Counter({0: 3465, 2: 2455, 1: 1480})

Epoch :  20 loss training:  43.52707262337208 Time :  8573
accuracy train: 0.934480 val: 0.719403 test: 0.708385
max validation accuracy : 0.737313 max acc epoch : 19 test accuracy : 0.707643
Counter({0: 3470, 1: 2458, 2: 1472})

Epoch :  21 loss training:  43.762608014047146 Time :  8640
accuracy train: 0.942091 val: 0.734328 test: 0.712342
max validation accuracy : 0.737313 max acc epoch : 19 test accuracy : 0.707643
Counter({0: 3467, 1: 2456, 2: 1477})

Epoch :  22 loss training:  44.232168316841125 Time :  8698
accuracy train: 0.942753 val: 0.728358 test: 0.714321
max validation accuracy : 0.737313 max acc epoch : 19 test accuracy : 0.707643
Counter({1: 3466, 0: 2456, 2: 1478})

Epoch :  23 loss training:  43.98899931460619 Time :  8760
accuracy train: 0.948048 val: 0.731343 test: 0.716052
max validation accuracy : 0.737313 max acc epoch : 19 test accuracy : 0.707643
Counter({2: 3476, 1: 2448, 0: 1476})

Epoch :  24 loss training:  40.675066627562046 Time :  8817
accuracy train: 0.945069 val: 0.728358 test: 0.714074
max validation accuracy : 0.737313 max acc epoch : 19 test accuracy : 0.707643
Counter({1: 3475, 0: 2454, 2: 1471})

Epoch :  25 loss training:  40.97478048503399 Time :  8886
accuracy train: 0.950033 val: 0.752239 test: 0.709869
max validation accuracy : 0.752239 max acc epoch : 25 test accuracy : 0.709869
Counter({0: 3469, 2: 2456, 1: 1475})

Epoch :  26 loss training:  41.25736854225397 Time :  8953
accuracy train: 0.954997 val: 0.743284 test: 0.715558
max validation accuracy : 0.752239 max acc epoch : 25 test accuracy : 0.709869
Counter({0: 3485, 2: 2449, 1: 1466})

Epoch :  27 loss training:  37.9811110123992 Time :  9008
accuracy train: 0.949702 val: 0.734328 test: 0.713084
max validation accuracy : 0.752239 max acc epoch : 25 test accuracy : 0.709869
Counter({1: 3492, 2: 2444, 0: 1464})

Epoch :  28 loss training:  34.79937359690666 Time :  9056
accuracy train: 0.960622 val: 0.731343 test: 0.708880
max validation accuracy : 0.752239 max acc epoch : 25 test accuracy : 0.709869
Counter({1: 3499, 0: 2441, 2: 1460})

Epoch :  29 loss training:  35.95474283397198 Time :  9127
accuracy train: 0.959298 val: 0.752239 test: 0.715063
max validation accuracy : 0.752239 max acc epoch : 25 test accuracy : 0.709869
Counter({1: 3502, 0: 2439, 2: 1459})

Epoch :  30 loss training:  34.997148886322975 Time :  9188
accuracy train: 0.963931 val: 0.746269 test: 0.714074
max validation accuracy : 0.752239 max acc epoch : 25 test accuracy : 0.709869
Counter({1: 3481, 0: 2448, 2: 1471})

Epoch :  31 loss training:  33.44936930388212 Time :  9243
accuracy train: 0.963269 val: 0.740299 test: 0.716547
max validation accuracy : 0.752239 max acc epoch : 25 test accuracy : 0.709869
Counter({0: 3476, 1: 2449, 2: 1475})

Epoch :  32 loss training:  33.86793118715286 Time :  9312
accuracy train: 0.964593 val: 0.737313 test: 0.715063
max validation accuracy : 0.752239 max acc epoch : 25 test accuracy : 0.709869
Counter({0: 3477, 2: 2446, 1: 1477})

Epoch :  33 loss training:  31.676124319434166 Time :  9380
accuracy train: 0.974851 val: 0.740299 test: 0.715310
max validation accuracy : 0.752239 max acc epoch : 25 test accuracy : 0.709869
Counter({1: 3481, 0: 2448, 2: 1471})

Epoch :  34 loss training:  31.57824144512415 Time :  9441
accuracy train: 0.970549 val: 0.752239 test: 0.717536
max validation accuracy : 0.752239 max acc epoch : 25 test accuracy : 0.709869
Counter({2: 3481, 1: 2449, 0: 1470})

Epoch :  35 loss training:  30.310692243278027 Time :  9514
accuracy train: 0.976175 val: 0.740299 test: 0.718279
max validation accuracy : 0.752239 max acc epoch : 25 test accuracy : 0.709869
Counter({1: 3469, 0: 2456, 2: 1475})

Epoch :  36 loss training:  30.6127395555377 Time :  9599
accuracy train: 0.979484 val: 0.740299 test: 0.712590
max validation accuracy : 0.752239 max acc epoch : 25 test accuracy : 0.709869
Counter({2: 3458, 1: 2451, 0: 1491})

Epoch :  37 loss training:  30.831482969224453 Time :  9663
accuracy train: 0.979153 val: 0.755224 test: 0.719515
max validation accuracy : 0.755224 max acc epoch : 37 test accuracy : 0.719515
Counter({0: 3321, 1: 2393, 2: 1686})

Epoch :  38 loss training:  29.060807332396507 Time :  9733
accuracy train: 0.981138 val: 0.743284 test: 0.718526
max validation accuracy : 0.755224 max acc epoch : 37 test accuracy : 0.719515
Counter({1: 3323, 0: 2395, 2: 1682})

Epoch :  39 loss training:  29.18755465745926 Time :  9792
accuracy train: 0.982462 val: 0.746269 test: 0.714568
max validation accuracy : 0.755224 max acc epoch : 37 test accuracy : 0.719515
Counter({2: 3470, 1: 2430, 0: 1500})

Epoch :  40 loss training:  27.906396012753248 Time :  9848
accuracy train: 0.982462 val: 0.752239 test: 0.717289
max validation accuracy : 0.755224 max acc epoch : 37 test accuracy : 0.719515
Counter({1: 3467, 0: 2431, 2: 1502})

Epoch :  41 loss training:  26.591337397694588 Time :  9915
accuracy train: 0.984447 val: 0.743284 test: 0.713579
max validation accuracy : 0.755224 max acc epoch : 37 test accuracy : 0.719515
Counter({0: 3467, 1: 2439, 2: 1494})

Epoch :  42 loss training:  26.71162786334753 Time :  9984
accuracy train: 0.988418 val: 0.740299 test: 0.719763
max validation accuracy : 0.755224 max acc epoch : 37 test accuracy : 0.719515
Counter({2: 3488, 0: 2430, 1: 1482})

Epoch :  43 loss training:  25.53639082238078 Time :  10044
accuracy train: 0.984778 val: 0.731343 test: 0.713332
max validation accuracy : 0.755224 max acc epoch : 37 test accuracy : 0.719515
Counter({2: 3505, 0: 2434, 1: 1461})

Epoch :  44 loss training:  25.796174455434084 Time :  10109
accuracy train: 0.988749 val: 0.743284 test: 0.714568
max validation accuracy : 0.755224 max acc epoch : 37 test accuracy : 0.719515
Counter({0: 3506, 2: 2435, 1: 1459})

Epoch :  45 loss training:  22.194588396698236 Time :  10165
accuracy train: 0.990735 val: 0.740299 test: 0.713332
max validation accuracy : 0.755224 max acc epoch : 37 test accuracy : 0.719515
Counter({1: 3498, 0: 2439, 2: 1463})

Epoch :  46 loss training:  21.137870024889708 Time :  10201
accuracy train: 0.988749 val: 0.758209 test: 0.716300
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({1: 3514, 0: 2438, 2: 1448})

Epoch :  47 loss training:  24.34965968504548 Time :  10274
accuracy train: 0.987756 val: 0.752239 test: 0.711353
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({0: 3509, 2: 2437, 1: 1454})

Epoch :  48 loss training:  21.410708010196686 Time :  10335
accuracy train: 0.993051 val: 0.737313 test: 0.713826
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({2: 3510, 1: 2436, 0: 1454})

Epoch :  49 loss training:  21.650846818462014 Time :  10397
accuracy train: 0.992058 val: 0.737313 test: 0.712590
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({0: 3509, 2: 2434, 1: 1457})

Epoch :  50 loss training:  20.371729880571365 Time :  10437
accuracy train: 0.994705 val: 0.728358 test: 0.710116
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({1: 3519, 0: 2442, 2: 1439})

Epoch :  51 loss training:  20.5080660097301 Time :  10504
accuracy train: 0.994044 val: 0.725373 test: 0.710611
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({1: 3527, 2: 2437, 0: 1436})

Epoch :  52 loss training:  20.2274766061455 Time :  10567
accuracy train: 0.995036 val: 0.740299 test: 0.711848
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({0: 3519, 1: 2442, 2: 1439})

Epoch :  53 loss training:  19.925472330302 Time :  10634
accuracy train: 0.988418 val: 0.737313 test: 0.708880
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({2: 3525, 0: 2441, 1: 1434})

Epoch :  54 loss training:  19.729037705808878 Time :  10693
accuracy train: 0.995036 val: 0.749254 test: 0.717289
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({0: 3528, 1: 2437, 2: 1435})

Epoch :  55 loss training:  17.65044596232474 Time :  10750
accuracy train: 0.992720 val: 0.743284 test: 0.715805
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({0: 3523, 2: 2442, 1: 1435})

Epoch :  56 loss training:  19.057445499114692 Time :  10798
accuracy train: 0.996029 val: 0.746269 test: 0.718031
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({2: 3524, 1: 2440, 0: 1436})

Epoch :  57 loss training:  16.587365943938494 Time :  10853
accuracy train: 0.995036 val: 0.743284 test: 0.716547
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({0: 3528, 2: 2440, 1: 1432})

Epoch :  58 loss training:  17.846924033015966 Time :  10913
accuracy train: 0.997022 val: 0.746269 test: 0.715310
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({1: 3531, 2: 2443, 0: 1426})

Epoch :  59 loss training:  16.030606772750616 Time :  10975
accuracy train: 0.997684 val: 0.752239 test: 0.715805
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({0: 3528, 1: 2444, 2: 1428})

Epoch :  60 loss training:  16.205846063792706 Time :  11037
accuracy train: 0.996691 val: 0.737313 test: 0.718279
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({0: 3526, 1: 2440, 2: 1434})

Epoch :  61 loss training:  14.651650929823518 Time :  11098
accuracy train: 0.996691 val: 0.749254 test: 0.714816
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({0: 3538, 2: 2429, 1: 1433})

Epoch :  62 loss training:  15.75541197694838 Time :  11158
accuracy train: 0.997353 val: 0.740299 test: 0.715805
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({2: 3538, 0: 2437, 1: 1425})

Epoch :  63 loss training:  14.21722249686718 Time :  11216
accuracy train: 0.998015 val: 0.734328 test: 0.716794
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({2: 3544, 0: 2435, 1: 1421})

Epoch :  64 loss training:  14.817462392151356 Time :  11271
accuracy train: 0.998015 val: 0.740299 test: 0.718773
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({1: 3548, 2: 2431, 0: 1421})

Epoch :  65 loss training:  14.554294073954225 Time :  11332
accuracy train: 0.997022 val: 0.731343 test: 0.715063
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({2: 3556, 1: 2429, 0: 1415})

Epoch :  66 loss training:  14.844860326498747 Time :  11379
accuracy train: 0.998676 val: 0.725373 test: 0.708385
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({2: 3540, 0: 2431, 1: 1429})

Epoch :  67 loss training:  12.800795454531908 Time :  11443
accuracy train: 0.998676 val: 0.740299 test: 0.713826
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({1: 3551, 2: 2429, 0: 1420})

Epoch :  68 loss training:  11.628492258489132 Time :  11499
accuracy train: 0.998676 val: 0.743284 test: 0.715805
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({2: 3547, 0: 2436, 1: 1417})

Epoch :  69 loss training:  12.964705725200474 Time :  11558
accuracy train: 1.000000 val: 0.755224 test: 0.719021
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({1: 3554, 2: 2425, 0: 1421})

Epoch :  70 loss training:  11.72363580390811 Time :  11608
accuracy train: 0.999338 val: 0.740299 test: 0.718279
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({1: 3555, 2: 2432, 0: 1413})

Epoch :  71 loss training:  11.340641763061285 Time :  11652
accuracy train: 0.999338 val: 0.740299 test: 0.713826
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({1: 3579, 2: 2425, 0: 1396})

Epoch :  72 loss training:  11.592188908718526 Time :  11701
accuracy train: 0.999338 val: 0.749254 test: 0.715805
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({0: 3571, 1: 2435, 2: 1394})

Epoch :  73 loss training:  11.588514100760221 Time :  11759
accuracy train: 0.999669 val: 0.740299 test: 0.720257
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({2: 3570, 0: 2433, 1: 1397})

Epoch :  74 loss training:  10.224381985142827 Time :  11814
accuracy train: 0.998676 val: 0.734328 test: 0.711106
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({1: 3549, 0: 2442, 2: 1409})

Epoch :  75 loss training:  11.484614057466388 Time :  11875
accuracy train: 0.998345 val: 0.740299 test: 0.717784
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({0: 3545, 2: 2441, 1: 1414})

Epoch :  76 loss training:  9.672495378181338 Time :  11939
accuracy train: 0.999669 val: 0.743284 test: 0.713084
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({1: 3553, 2: 2435, 0: 1412})

Epoch :  77 loss training:  10.072724703233689 Time :  11982
accuracy train: 0.999669 val: 0.734328 test: 0.714321
max validation accuracy : 0.758209 max acc epoch : 46 test accuracy : 0.716300
Counter({1: 3541, 0: 2435, 2: 1424})

========================================================================================================================================================================================================
max acc epoch :  46
max validation accuracy :  0.7582089552238805
test accuracy :  0.716299777393025
last test_accuracy :  0.7143210487261934
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.5, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=978, weight_decay=0)
device :  cuda:0
Counter({2: 3470, 1: 2497, 0: 1433})

Epoch :  1 loss training:  307.8986465334892 Time :  12336
accuracy train: 0.615156 val: 0.558209 test: 0.553055
max validation accuracy : 0.558209 max acc epoch : 1 test accuracy : 0.553055
Counter({1: 3441, 2: 2390, 0: 1569})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  191.86123049259186 Time :  12392
accuracy train: 0.697220 val: 0.617910 test: 0.651002
max validation accuracy : 0.617910 max acc epoch : 2 test accuracy : 0.651002
Counter({1: 3437, 2: 2438, 0: 1525})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  148.78747645020485 Time :  12457
accuracy train: 0.746856 val: 0.659701 test: 0.665348
max validation accuracy : 0.659701 max acc epoch : 3 test accuracy : 0.665348
Counter({2: 3450, 0: 2446, 1: 1504})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  119.55587366223335 Time :  12521
accuracy train: 0.801456 val: 0.659701 test: 0.688103
max validation accuracy : 0.659701 max acc epoch : 3 test accuracy : 0.665348
Counter({2: 3465, 1: 2440, 0: 1495})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  104.0097323358059 Time :  12571
accuracy train: 0.824950 val: 0.680597 test: 0.688598
max validation accuracy : 0.680597 max acc epoch : 5 test accuracy : 0.688598
Counter({1: 3419, 2: 2450, 0: 1531})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  96.290273219347 Time :  12642
accuracy train: 0.835539 val: 0.701493 test: 0.707643
max validation accuracy : 0.701493 max acc epoch : 6 test accuracy : 0.707643
Counter({1: 3477, 0: 2452, 2: 1471})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  79.35653948783875 Time :  12701
accuracy train: 0.868630 val: 0.698507 test: 0.703933
max validation accuracy : 0.701493 max acc epoch : 6 test accuracy : 0.707643
Counter({1: 3489, 0: 2443, 2: 1468})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.26992060244083 Time :  12761
accuracy train: 0.868630 val: 0.716418 test: 0.702943
max validation accuracy : 0.716418 max acc epoch : 8 test accuracy : 0.702943
Counter({2: 3486, 0: 2439, 1: 1475})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  68.4449177980423 Time :  12826
accuracy train: 0.888815 val: 0.704478 test: 0.695770
max validation accuracy : 0.716418 max acc epoch : 8 test accuracy : 0.702943
Counter({1: 3480, 0: 2454, 2: 1466})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.427625864744186 Time :  12893
accuracy train: 0.904699 val: 0.722388 test: 0.708632
max validation accuracy : 0.722388 max acc epoch : 10 test accuracy : 0.708632
Counter({2: 3462, 1: 2453, 0: 1485})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.137612625956535 Time :  12959
accuracy train: 0.903375 val: 0.713433 test: 0.707643
max validation accuracy : 0.722388 max acc epoch : 10 test accuracy : 0.708632
Counter({2: 3467, 0: 2454, 1: 1479})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  56.88780836760998 Time :  13023
accuracy train: 0.901059 val: 0.719403 test: 0.711848
max validation accuracy : 0.722388 max acc epoch : 10 test accuracy : 0.708632
Counter({0: 3478, 1: 2449, 2: 1473})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  53.35854598879814 Time :  13080
accuracy train: 0.909993 val: 0.725373 test: 0.710858
max validation accuracy : 0.725373 max acc epoch : 13 test accuracy : 0.710858
Counter({0: 3485, 1: 2449, 2: 1466})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  54.67420407384634 Time :  13115
accuracy train: 0.919921 val: 0.728358 test: 0.712342
max validation accuracy : 0.728358 max acc epoch : 14 test accuracy : 0.712342
Counter({1: 3482, 2: 2451, 0: 1467})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  50.90013674646616 Time :  13172
accuracy train: 0.916281 val: 0.731343 test: 0.709622
max validation accuracy : 0.731343 max acc epoch : 15 test accuracy : 0.709622
Counter({2: 3484, 0: 2450, 1: 1466})

Epoch :  16 loss training:  50.88438542187214 Time :  13230
accuracy train: 0.925546 val: 0.722388 test: 0.709869
max validation accuracy : 0.731343 max acc epoch : 15 test accuracy : 0.709622
Counter({0: 3488, 1: 2452, 2: 1460})

Epoch :  17 loss training:  47.86710359156132 Time :  13287
accuracy train: 0.918597 val: 0.734328 test: 0.710116
max validation accuracy : 0.734328 max acc epoch : 17 test accuracy : 0.710116
Counter({0: 3489, 2: 2450, 1: 1461})

Epoch :  18 loss training:  46.786402992904186 Time :  13350
accuracy train: 0.933819 val: 0.731343 test: 0.713084
max validation accuracy : 0.734328 max acc epoch : 17 test accuracy : 0.710116
Counter({1: 3496, 0: 2446, 2: 1458})

Epoch :  19 loss training:  46.14447095245123 Time :  13418
accuracy train: 0.932495 val: 0.731343 test: 0.712837
max validation accuracy : 0.734328 max acc epoch : 17 test accuracy : 0.710116
Counter({1: 3493, 0: 2451, 2: 1456})

Epoch :  20 loss training:  47.15223355591297 Time :  13480
accuracy train: 0.934811 val: 0.731343 test: 0.705911
max validation accuracy : 0.734328 max acc epoch : 17 test accuracy : 0.710116
Counter({0: 3492, 2: 2450, 1: 1458})

Epoch :  21 loss training:  42.64670519530773 Time :  13544
accuracy train: 0.937128 val: 0.731343 test: 0.711353
max validation accuracy : 0.734328 max acc epoch : 17 test accuracy : 0.710116
Counter({1: 3494, 2: 2451, 0: 1455})

Epoch :  22 loss training:  43.86611171066761 Time :  13618
accuracy train: 0.940437 val: 0.734328 test: 0.713332
max validation accuracy : 0.734328 max acc epoch : 17 test accuracy : 0.710116
Counter({2: 3498, 0: 2455, 1: 1447})

Epoch :  23 loss training:  42.78960429131985 Time :  13696
accuracy train: 0.948709 val: 0.743284 test: 0.712342
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({2: 3505, 1: 2451, 0: 1444})

Epoch :  24 loss training:  41.1916965842247 Time :  13760
accuracy train: 0.951688 val: 0.719403 test: 0.712837
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({1: 3500, 2: 2454, 0: 1446})

Epoch :  25 loss training:  40.0612753406167 Time :  13822
accuracy train: 0.954335 val: 0.737313 test: 0.709374
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({1: 3497, 2: 2453, 0: 1450})

Epoch :  26 loss training:  39.8165590390563 Time :  13886
accuracy train: 0.951357 val: 0.728358 test: 0.715558
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({1: 3522, 2: 2448, 0: 1430})

Epoch :  27 loss training:  37.72906603291631 Time :  13954
accuracy train: 0.957975 val: 0.737313 test: 0.712837
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({2: 3531, 0: 2448, 1: 1421})

Epoch :  28 loss training:  37.51053299754858 Time :  14017
accuracy train: 0.963931 val: 0.731343 test: 0.710858
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({1: 3532, 0: 2447, 2: 1421})

Epoch :  29 loss training:  37.136289685964584 Time :  14080
accuracy train: 0.963600 val: 0.740299 test: 0.711600
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({1: 3533, 0: 2450, 2: 1417})

Epoch :  30 loss training:  33.62088147550821 Time :  14133
accuracy train: 0.967240 val: 0.737313 test: 0.714568
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({1: 3537, 0: 2450, 2: 1413})

Epoch :  31 loss training:  36.34481707960367 Time :  14188
accuracy train: 0.966909 val: 0.722388 test: 0.714816
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({0: 3545, 1: 2452, 2: 1403})

Epoch :  32 loss training:  34.581910111010075 Time :  14246
accuracy train: 0.968233 val: 0.728358 test: 0.712342
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({1: 3547, 2: 2454, 0: 1399})

Epoch :  33 loss training:  32.05431840568781 Time :  14283
accuracy train: 0.964924 val: 0.728358 test: 0.714816
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({0: 3552, 1: 2452, 2: 1396})

Epoch :  34 loss training:  33.09247591346502 Time :  14336
accuracy train: 0.972866 val: 0.740299 test: 0.718773
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({2: 3553, 1: 2448, 0: 1399})

Epoch :  35 loss training:  31.658203341066837 Time :  14388
accuracy train: 0.975513 val: 0.737313 test: 0.717784
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({0: 3547, 1: 2452, 2: 1401})

Epoch :  36 loss training:  29.759148605167866 Time :  14454
accuracy train: 0.980477 val: 0.728358 test: 0.715063
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({2: 3542, 1: 2449, 0: 1409})

Epoch :  37 loss training:  30.15618482977152 Time :  14514
accuracy train: 0.976837 val: 0.740299 test: 0.715063
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({0: 3545, 2: 2450, 1: 1405})

Epoch :  38 loss training:  29.388163052499294 Time :  14579
accuracy train: 0.977829 val: 0.728358 test: 0.714816
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({2: 3548, 1: 2450, 0: 1402})

Epoch :  39 loss training:  28.461169619113207 Time :  14632
accuracy train: 0.980146 val: 0.725373 test: 0.716794
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({1: 3542, 0: 2449, 2: 1409})

Epoch :  40 loss training:  27.982571825385094 Time :  14694
accuracy train: 0.978822 val: 0.734328 test: 0.716794
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({1: 3542, 0: 2449, 2: 1409})

Epoch :  41 loss training:  26.996141463518143 Time :  14753
accuracy train: 0.985109 val: 0.740299 test: 0.710858
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({0: 3538, 2: 2455, 1: 1407})

Epoch :  42 loss training:  25.47454249113798 Time :  14817
accuracy train: 0.984447 val: 0.737313 test: 0.717289
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({1: 3546, 0: 2452, 2: 1402})

Epoch :  43 loss training:  26.883636007085443 Time :  14855
accuracy train: 0.985440 val: 0.731343 test: 0.721494
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({1: 3552, 0: 2447, 2: 1401})

Epoch :  44 loss training:  24.290628384798765 Time :  14909
accuracy train: 0.986764 val: 0.737313 test: 0.717042
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({0: 3573, 1: 2448, 2: 1379})

Epoch :  45 loss training:  23.812769509851933 Time :  14973
accuracy train: 0.989080 val: 0.725373 test: 0.715310
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({1: 3582, 2: 2446, 0: 1372})

Epoch :  46 loss training:  22.838354166597128 Time :  15026
accuracy train: 0.991727 val: 0.737313 test: 0.715310
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({2: 3569, 0: 2448, 1: 1383})

Epoch :  47 loss training:  23.112031616270542 Time :  15085
accuracy train: 0.989080 val: 0.731343 test: 0.714321
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({0: 3567, 2: 2435, 1: 1398})

Epoch :  48 loss training:  22.827191999182105 Time :  15142
accuracy train: 0.991727 val: 0.734328 test: 0.711600
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({2: 3560, 1: 2440, 0: 1400})

Epoch :  49 loss training:  21.91948214173317 Time :  15206
accuracy train: 0.994044 val: 0.728358 test: 0.705911
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({0: 3546, 2: 2433, 1: 1421})

Epoch :  50 loss training:  21.20443981513381 Time :  15273
accuracy train: 0.994044 val: 0.728358 test: 0.712095
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({2: 3547, 0: 2438, 1: 1415})

Epoch :  51 loss training:  18.81668219715357 Time :  15339
accuracy train: 0.994375 val: 0.731343 test: 0.713084
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({2: 3555, 1: 2439, 0: 1406})

Epoch :  52 loss training:  20.30886685848236 Time :  15394
accuracy train: 0.995367 val: 0.725373 test: 0.711848
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({2: 3554, 0: 2436, 1: 1410})

Epoch :  53 loss training:  20.37631445750594 Time :  15436
accuracy train: 0.996029 val: 0.728358 test: 0.710364
max validation accuracy : 0.743284 max acc epoch : 23 test accuracy : 0.712342
Counter({0: 3543, 2: 2442, 1: 1415})

Epoch :  54 loss training:  18.649211134761572 Time :  15487
accuracy train: 0.996360 val: 0.746269 test: 0.714074
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.714074
Counter({2: 3549, 0: 2441, 1: 1410})

Epoch :  55 loss training:  17.966053258627653 Time :  15545
accuracy train: 0.996029 val: 0.719403 test: 0.717042
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.714074
Counter({0: 3548, 1: 2438, 2: 1414})

Epoch :  56 loss training:  17.582694709300995 Time :  15600
accuracy train: 0.996029 val: 0.725373 test: 0.714074
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.714074
Counter({2: 3556, 0: 2445, 1: 1399})

Epoch :  57 loss training:  17.498891819268465 Time :  15659
accuracy train: 0.997022 val: 0.737313 test: 0.715310
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.714074
Counter({0: 3561, 1: 2443, 2: 1396})

Epoch :  58 loss training:  16.373462606221437 Time :  15718
accuracy train: 0.996360 val: 0.734328 test: 0.709374
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.714074
Counter({1: 3557, 2: 2442, 0: 1401})

Epoch :  59 loss training:  17.23180713504553 Time :  15780
accuracy train: 0.997022 val: 0.740299 test: 0.715558
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.714074
Counter({0: 3569, 1: 2443, 2: 1388})

Epoch :  60 loss training:  15.629698298871517 Time :  15843
accuracy train: 0.997022 val: 0.728358 test: 0.716300
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.714074
Counter({0: 3563, 1: 2439, 2: 1398})

Epoch :  61 loss training:  15.830807378515601 Time :  15897
accuracy train: 0.996691 val: 0.725373 test: 0.716794
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.714074
Counter({2: 3562, 0: 2441, 1: 1397})

Epoch :  62 loss training:  14.330738954246044 Time :  15954
accuracy train: 0.997684 val: 0.731343 test: 0.716794
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.714074
Counter({1: 3567, 2: 2449, 0: 1384})

Epoch :  63 loss training:  15.00879874639213 Time :  15989
accuracy train: 0.997684 val: 0.731343 test: 0.712342
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.714074
Counter({1: 3571, 2: 2446, 0: 1383})

Epoch :  64 loss training:  14.533652353100479 Time :  16035
accuracy train: 0.997022 val: 0.734328 test: 0.717042
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.714074
Counter({1: 3587, 2: 2440, 0: 1373})

Epoch :  65 loss training:  14.244125664234161 Time :  16087
accuracy train: 0.997353 val: 0.743284 test: 0.723967
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.714074
Counter({2: 3579, 0: 2438, 1: 1383})

Epoch :  66 loss training:  13.607632333412766 Time :  16145
accuracy train: 0.998676 val: 0.734328 test: 0.718279
max validation accuracy : 0.746269 max acc epoch : 54 test accuracy : 0.714074
Counter({1: 3570, 0: 2436, 2: 1394})

Epoch :  67 loss training:  12.555396806448698 Time :  16206
accuracy train: 0.998345 val: 0.749254 test: 0.717536
max validation accuracy : 0.749254 max acc epoch : 67 test accuracy : 0.717536
Counter({2: 3565, 1: 2441, 0: 1394})

Epoch :  68 loss training:  12.485088287852705 Time :  16265
accuracy train: 0.998345 val: 0.740299 test: 0.718773
max validation accuracy : 0.749254 max acc epoch : 67 test accuracy : 0.717536
Counter({2: 3564, 1: 2439, 0: 1397})

Epoch :  69 loss training:  12.76082638464868 Time :  16325
accuracy train: 0.999338 val: 0.740299 test: 0.716794
max validation accuracy : 0.749254 max acc epoch : 67 test accuracy : 0.717536
Counter({2: 3569, 0: 2433, 1: 1398})

Epoch :  70 loss training:  11.876850754022598 Time :  16384
accuracy train: 0.998345 val: 0.734328 test: 0.716547
max validation accuracy : 0.749254 max acc epoch : 67 test accuracy : 0.717536
Counter({2: 3573, 1: 2434, 0: 1393})

Epoch :  71 loss training:  11.710886136163026 Time :  16445
accuracy train: 0.999007 val: 0.746269 test: 0.716547
max validation accuracy : 0.749254 max acc epoch : 67 test accuracy : 0.717536
Counter({1: 3577, 0: 2436, 2: 1387})

Epoch :  72 loss training:  12.730632554739714 Time :  16498
accuracy train: 0.999338 val: 0.728358 test: 0.710116
max validation accuracy : 0.749254 max acc epoch : 67 test accuracy : 0.717536
Counter({0: 3573, 1: 2442, 2: 1385})

Epoch :  73 loss training:  11.353895249776542 Time :  16555
accuracy train: 0.999669 val: 0.746269 test: 0.720010
max validation accuracy : 0.749254 max acc epoch : 67 test accuracy : 0.717536
Counter({0: 3583, 1: 2437, 2: 1380})

Epoch :  74 loss training:  11.24970456585288 Time :  16594
accuracy train: 0.999669 val: 0.740299 test: 0.716052
max validation accuracy : 0.749254 max acc epoch : 67 test accuracy : 0.717536
Counter({2: 3572, 1: 2438, 0: 1390})

Epoch :  75 loss training:  11.286155482754111 Time :  16656
accuracy train: 0.998676 val: 0.758209 test: 0.716052
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({1: 3553, 0: 2434, 2: 1413})

Epoch :  76 loss training:  11.33981467038393 Time :  16718
accuracy train: 0.999669 val: 0.743284 test: 0.716794
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({0: 3557, 1: 2435, 2: 1408})

Epoch :  77 loss training:  10.306612662039697 Time :  16773
accuracy train: 1.000000 val: 0.740299 test: 0.713579
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({1: 3563, 2: 2430, 0: 1407})

Epoch :  78 loss training:  10.08622320741415 Time :  16830
accuracy train: 0.999338 val: 0.749254 test: 0.713579
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({0: 3563, 1: 2429, 2: 1408})

Epoch :  79 loss training:  9.637666238006204 Time :  16890
accuracy train: 0.999669 val: 0.752239 test: 0.718031
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({2: 3552, 1: 2432, 0: 1416})

Epoch :  80 loss training:  10.1141656646505 Time :  16945
accuracy train: 0.999669 val: 0.746269 test: 0.719268
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({2: 3556, 0: 2433, 1: 1411})

Epoch :  81 loss training:  8.95024127047509 Time :  16996
accuracy train: 0.999669 val: 0.743284 test: 0.714321
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({1: 3568, 0: 2433, 2: 1399})

Epoch :  82 loss training:  9.579313206486404 Time :  17049
accuracy train: 1.000000 val: 0.731343 test: 0.713579
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({0: 3567, 1: 2433, 2: 1400})

Epoch :  83 loss training:  9.666905498597771 Time :  17109
accuracy train: 0.999669 val: 0.743284 test: 0.713579
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({2: 3567, 0: 2432, 1: 1401})

Epoch :  84 loss training:  9.960131318308413 Time :  17163
accuracy train: 0.999007 val: 0.734328 test: 0.718526
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({1: 3580, 0: 2433, 2: 1387})

Epoch :  85 loss training:  9.23160899989307 Time :  17215
accuracy train: 0.999669 val: 0.740299 test: 0.718773
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({0: 3579, 2: 2436, 1: 1385})

Epoch :  86 loss training:  8.882954601198435 Time :  17272
accuracy train: 0.999669 val: 0.749254 test: 0.717289
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({1: 3589, 2: 2433, 0: 1378})

Epoch :  87 loss training:  8.845202818512917 Time :  17331
accuracy train: 0.999338 val: 0.749254 test: 0.718279
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({2: 3585, 1: 2432, 0: 1383})

Epoch :  88 loss training:  7.5160887483507395 Time :  17391
accuracy train: 1.000000 val: 0.728358 test: 0.716052
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({0: 3584, 1: 2435, 2: 1381})

Epoch :  89 loss training:  7.720852106343955 Time :  17446
accuracy train: 1.000000 val: 0.758209 test: 0.717289
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({2: 3589, 1: 2427, 0: 1384})

Epoch :  90 loss training:  7.077763777691871 Time :  17497
accuracy train: 0.999338 val: 0.746269 test: 0.720010
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({0: 3593, 1: 2432, 2: 1375})

Epoch :  91 loss training:  8.453131463378668 Time :  17543
accuracy train: 1.000000 val: 0.746269 test: 0.714816
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({1: 3591, 0: 2435, 2: 1374})

Epoch :  92 loss training:  6.185604122933 Time :  17611
accuracy train: 1.000000 val: 0.749254 test: 0.721989
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({2: 3590, 0: 2434, 1: 1376})

Epoch :  93 loss training:  6.803252292796969 Time :  17683
accuracy train: 1.000000 val: 0.755224 test: 0.717784
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({2: 3592, 1: 2432, 0: 1376})

Epoch :  94 loss training:  6.4075273354537785 Time :  17749
accuracy train: 1.000000 val: 0.752239 test: 0.717536
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({1: 3597, 2: 2427, 0: 1376})

Epoch :  95 loss training:  8.250724251382053 Time :  17803
accuracy train: 1.000000 val: 0.752239 test: 0.717784
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({2: 3609, 1: 2429, 0: 1362})

Epoch :  96 loss training:  6.543589587789029 Time :  17845
accuracy train: 0.999669 val: 0.737313 test: 0.714568
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({2: 3624, 1: 2421, 0: 1355})

Epoch :  97 loss training:  7.780482674017549 Time :  17906
accuracy train: 1.000000 val: 0.746269 test: 0.717536
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({1: 3602, 2: 2434, 0: 1364})

Epoch :  98 loss training:  6.3057469124905765 Time :  17968
accuracy train: 1.000000 val: 0.755224 test: 0.715310
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({0: 3618, 1: 2427, 2: 1355})

Epoch :  99 loss training:  6.894580882508308 Time :  18021
accuracy train: 1.000000 val: 0.755224 test: 0.713332
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({0: 3572, 1: 2433, 2: 1395})

Epoch :  100 loss training:  6.758626336231828 Time :  18086
accuracy train: 1.000000 val: 0.758209 test: 0.719268
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({2: 3604, 1: 2421, 0: 1375})

Epoch :  101 loss training:  6.108372174669057 Time :  18143
accuracy train: 1.000000 val: 0.740299 test: 0.721989
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({0: 3605, 2: 2428, 1: 1367})

Epoch :  102 loss training:  5.831854722928256 Time :  18201
accuracy train: 1.000000 val: 0.749254 test: 0.716794
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({2: 3561, 1: 2441, 0: 1398})

Epoch :  103 loss training:  6.490212505217642 Time :  18256
accuracy train: 1.000000 val: 0.749254 test: 0.720999
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({1: 3582, 0: 2429, 2: 1389})

Epoch :  104 loss training:  6.029501845128834 Time :  18316
accuracy train: 1.000000 val: 0.740299 test: 0.719763
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({1: 3584, 0: 2437, 2: 1379})

Epoch :  105 loss training:  5.4288199613802135 Time :  18372
accuracy train: 1.000000 val: 0.743284 test: 0.717042
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({1: 3620, 0: 2430, 2: 1350})

Epoch :  106 loss training:  6.305153945460916 Time :  18424
accuracy train: 1.000000 val: 0.752239 test: 0.720505
max validation accuracy : 0.758209 max acc epoch : 75 test accuracy : 0.716052
Counter({1: 3637, 2: 2422, 0: 1341})

========================================================================================================================================================================================================
max acc epoch :  75
max validation accuracy :  0.7582089552238805
test accuracy :  0.7160524363096711
last test_accuracy :  0.720504575810042
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.5, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=978, weight_decay=0)
device :  cuda:0
Counter({2: 3470, 0: 2497, 1: 1433})

Epoch :  1 loss training:  305.08563297986984 Time :  18868
accuracy train: 0.614163 val: 0.552239 test: 0.554539
max validation accuracy : 0.552239 max acc epoch : 1 test accuracy : 0.554539
Counter({2: 3448, 1: 2440, 0: 1512})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  193.08958059549332 Time :  18914
accuracy train: 0.695235 val: 0.617910 test: 0.653475
max validation accuracy : 0.617910 max acc epoch : 2 test accuracy : 0.653475
Counter({1: 3431, 0: 2435, 2: 1534})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  145.8356093764305 Time :  18972
accuracy train: 0.748842 val: 0.671642 test: 0.671036
max validation accuracy : 0.671642 max acc epoch : 3 test accuracy : 0.671036
Counter({2: 3416, 1: 2404, 0: 1580})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  120.35111492872238 Time :  19040
accuracy train: 0.811383 val: 0.683582 test: 0.695770
max validation accuracy : 0.683582 max acc epoch : 4 test accuracy : 0.695770
Counter({2: 3468, 0: 2430, 1: 1502})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  103.54889898002148 Time :  19097
accuracy train: 0.827929 val: 0.689552 test: 0.699728
max validation accuracy : 0.689552 max acc epoch : 5 test accuracy : 0.699728
Counter({1: 3469, 2: 2435, 0: 1496})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  94.47175595164299 Time :  19159
accuracy train: 0.850099 val: 0.719403 test: 0.708385
max validation accuracy : 0.719403 max acc epoch : 6 test accuracy : 0.708385
Counter({2: 3495, 0: 2442, 1: 1463})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  78.33092957735062 Time :  19221
accuracy train: 0.866976 val: 0.707463 test: 0.710611
max validation accuracy : 0.719403 max acc epoch : 6 test accuracy : 0.708385
Counter({1: 3509, 2: 2438, 0: 1453})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  74.5533587038517 Time :  19281
accuracy train: 0.877234 val: 0.722388 test: 0.706406
max validation accuracy : 0.722388 max acc epoch : 8 test accuracy : 0.706406
Counter({0: 3476, 2: 2436, 1: 1488})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  67.43905210494995 Time :  19335
accuracy train: 0.890470 val: 0.704478 test: 0.699728
max validation accuracy : 0.722388 max acc epoch : 8 test accuracy : 0.706406
Counter({1: 3485, 0: 2450, 2: 1465})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.452938959002495 Time :  19403
accuracy train: 0.897088 val: 0.740299 test: 0.709127
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.709127
Counter({2: 3469, 1: 2445, 0: 1486})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  57.91657753288746 Time :  19465
accuracy train: 0.907015 val: 0.731343 test: 0.711353
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.709127
Counter({2: 3467, 1: 2445, 0: 1488})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  56.9520630389452 Time :  19505
accuracy train: 0.901059 val: 0.719403 test: 0.716300
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.709127
Counter({2: 3476, 1: 2434, 0: 1490})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  51.47252121567726 Time :  19559
accuracy train: 0.911648 val: 0.737313 test: 0.709869
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.709127
Counter({0: 3483, 1: 2435, 2: 1482})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  52.53915371000767 Time :  19625
accuracy train: 0.918266 val: 0.716418 test: 0.713332
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.709127
Counter({0: 3485, 1: 2433, 2: 1482})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  50.20504346489906 Time :  19667
accuracy train: 0.917604 val: 0.737313 test: 0.711848
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.709127
Counter({2: 3485, 1: 2434, 0: 1481})

Epoch :  16 loss training:  50.678023442626 Time :  19730
accuracy train: 0.921244 val: 0.716418 test: 0.712095
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.709127
Counter({0: 3487, 1: 2441, 2: 1472})

Epoch :  17 loss training:  48.42213489860296 Time :  19796
accuracy train: 0.921244 val: 0.734328 test: 0.708632
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.709127
Counter({0: 3481, 2: 2435, 1: 1484})

Epoch :  18 loss training:  45.72099396586418 Time :  19863
accuracy train: 0.929517 val: 0.728358 test: 0.713826
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.709127
Counter({1: 3483, 0: 2431, 2: 1486})

Epoch :  19 loss training:  47.43181161209941 Time :  19918
accuracy train: 0.931502 val: 0.740299 test: 0.709127
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.709127
Counter({1: 3471, 0: 2435, 2: 1494})

Epoch :  20 loss training:  43.291550271213055 Time :  19981
accuracy train: 0.934150 val: 0.722388 test: 0.717289
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.709127
Counter({1: 3493, 0: 2434, 2: 1473})

Epoch :  21 loss training:  42.86697758734226 Time :  20046
accuracy train: 0.937459 val: 0.725373 test: 0.715558
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.709127
Counter({1: 3489, 0: 2438, 2: 1473})

Epoch :  22 loss training:  44.05126506090164 Time :  20097
accuracy train: 0.944739 val: 0.734328 test: 0.713579
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.709127
Counter({1: 3496, 0: 2436, 2: 1468})

Epoch :  23 loss training:  44.046692453324795 Time :  20161
accuracy train: 0.949040 val: 0.728358 test: 0.711600
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.709127
Counter({2: 3497, 1: 2431, 0: 1472})

Epoch :  24 loss training:  39.99012503027916 Time :  20217
accuracy train: 0.940106 val: 0.725373 test: 0.716794
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.709127
Counter({2: 3497, 1: 2435, 0: 1468})

Epoch :  25 loss training:  40.18508776277304 Time :  20273
accuracy train: 0.948048 val: 0.734328 test: 0.715558
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.709127
Counter({2: 3498, 1: 2436, 0: 1466})

Epoch :  26 loss training:  40.908420249819756 Time :  20335
accuracy train: 0.949371 val: 0.731343 test: 0.715310
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.709127
Counter({0: 3510, 1: 2432, 2: 1458})

Epoch :  27 loss training:  37.97642628848553 Time :  20400
accuracy train: 0.950695 val: 0.737313 test: 0.716300
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.709127
Counter({1: 3511, 2: 2435, 0: 1454})

Epoch :  28 loss training:  34.94751846045256 Time :  20462
accuracy train: 0.963931 val: 0.728358 test: 0.712837
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.709127
Counter({1: 3503, 0: 2436, 2: 1461})

Epoch :  29 loss training:  37.060676991939545 Time :  20522
accuracy train: 0.953673 val: 0.737313 test: 0.712837
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.709127
Counter({1: 3505, 0: 2433, 2: 1462})

Epoch :  30 loss training:  35.111949540674686 Time :  20589
accuracy train: 0.961946 val: 0.740299 test: 0.715310
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.709127
Counter({2: 3505, 1: 2433, 0: 1462})

Epoch :  31 loss training:  33.465567879378796 Time :  20641
accuracy train: 0.963600 val: 0.737313 test: 0.709622
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.709127
Counter({2: 3501, 0: 2436, 1: 1463})

Epoch :  32 loss training:  33.72092228382826 Time :  20708
accuracy train: 0.961284 val: 0.740299 test: 0.714074
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.709127
Counter({0: 3490, 2: 2445, 1: 1465})

Epoch :  33 loss training:  30.909000985324383 Time :  20779
accuracy train: 0.970218 val: 0.728358 test: 0.711106
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.709127
Counter({1: 3495, 2: 2443, 0: 1462})

Epoch :  34 loss training:  30.904748924076557 Time :  20848
accuracy train: 0.970549 val: 0.737313 test: 0.716547
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.709127
Counter({1: 3494, 2: 2439, 0: 1467})

Epoch :  35 loss training:  30.88734322041273 Time :  20913
accuracy train: 0.975844 val: 0.737313 test: 0.713084
max validation accuracy : 0.740299 max acc epoch : 10 test accuracy : 0.709127
Counter({1: 3494, 0: 2436, 2: 1470})

Epoch :  36 loss training:  30.69435640051961 Time :  20989
accuracy train: 0.978822 val: 0.746269 test: 0.715805
max validation accuracy : 0.746269 max acc epoch : 36 test accuracy : 0.715805
Counter({1: 3487, 2: 2431, 0: 1482})

Epoch :  37 loss training:  30.873411506414413 Time :  21058
accuracy train: 0.978491 val: 0.737313 test: 0.710858
max validation accuracy : 0.746269 max acc epoch : 36 test accuracy : 0.715805
Counter({2: 3501, 0: 2431, 1: 1468})

Epoch :  38 loss training:  29.182811491191387 Time :  21143
accuracy train: 0.977498 val: 0.737313 test: 0.715310
max validation accuracy : 0.746269 max acc epoch : 36 test accuracy : 0.715805
Counter({1: 3502, 2: 2433, 0: 1465})

Epoch :  39 loss training:  28.636651691049337 Time :  21209
accuracy train: 0.981800 val: 0.731343 test: 0.711600
max validation accuracy : 0.746269 max acc epoch : 36 test accuracy : 0.715805
Counter({2: 3495, 1: 2435, 0: 1470})

Epoch :  40 loss training:  27.937995746731758 Time :  21279
accuracy train: 0.980807 val: 0.725373 test: 0.716052
max validation accuracy : 0.746269 max acc epoch : 36 test accuracy : 0.715805
Counter({2: 3491, 0: 2435, 1: 1474})

Epoch :  41 loss training:  27.266907282173634 Time :  21349
accuracy train: 0.983124 val: 0.725373 test: 0.710116
max validation accuracy : 0.746269 max acc epoch : 36 test accuracy : 0.715805
Counter({0: 3437, 1: 2425, 2: 1538})

Epoch :  42 loss training:  26.730023127049208 Time :  21418
accuracy train: 0.984778 val: 0.728358 test: 0.713332
max validation accuracy : 0.746269 max acc epoch : 36 test accuracy : 0.715805
Counter({1: 3484, 0: 2430, 2: 1486})

Epoch :  43 loss training:  26.05145951360464 Time :  21488
accuracy train: 0.985440 val: 0.716418 test: 0.710858
max validation accuracy : 0.746269 max acc epoch : 36 test accuracy : 0.715805
Counter({0: 3493, 2: 2430, 1: 1477})

Epoch :  44 loss training:  26.024186871945858 Time :  21529
accuracy train: 0.988418 val: 0.740299 test: 0.712095
max validation accuracy : 0.746269 max acc epoch : 36 test accuracy : 0.715805
Counter({0: 3485, 2: 2438, 1: 1477})

Epoch :  45 loss training:  22.055457778275013 Time :  21592
accuracy train: 0.989411 val: 0.725373 test: 0.712342
max validation accuracy : 0.746269 max acc epoch : 36 test accuracy : 0.715805
Counter({1: 3484, 2: 2437, 0: 1479})

Epoch :  46 loss training:  22.649707857519388 Time :  21644
accuracy train: 0.989080 val: 0.752239 test: 0.713826
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({2: 3491, 0: 2443, 1: 1466})

Epoch :  47 loss training:  24.31338544562459 Time :  21706
accuracy train: 0.988749 val: 0.740299 test: 0.712095
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({0: 3491, 1: 2444, 2: 1465})

Epoch :  48 loss training:  21.601556165143847 Time :  21772
accuracy train: 0.991396 val: 0.734328 test: 0.712837
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({2: 3491, 0: 2440, 1: 1469})

Epoch :  49 loss training:  21.141879301518202 Time :  21833
accuracy train: 0.992058 val: 0.716418 test: 0.710611
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({0: 3493, 2: 2439, 1: 1468})

Epoch :  50 loss training:  20.945035692304373 Time :  21895
accuracy train: 0.996029 val: 0.728358 test: 0.712095
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({2: 3484, 1: 2444, 0: 1472})

Epoch :  51 loss training:  20.517864134162664 Time :  21953
accuracy train: 0.993382 val: 0.716418 test: 0.712095
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({2: 3495, 1: 2439, 0: 1466})

Epoch :  52 loss training:  21.672260232269764 Time :  22015
accuracy train: 0.995036 val: 0.722388 test: 0.711106
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({1: 3489, 0: 2437, 2: 1474})

Epoch :  53 loss training:  20.47852636873722 Time :  22081
accuracy train: 0.992389 val: 0.725373 test: 0.709374
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({0: 3493, 2: 2441, 1: 1466})

Epoch :  54 loss training:  20.06065303646028 Time :  22141
accuracy train: 0.994705 val: 0.743284 test: 0.712590
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({0: 3496, 1: 2437, 2: 1467})

Epoch :  55 loss training:  18.129242435097694 Time :  22209
accuracy train: 0.992058 val: 0.734328 test: 0.715558
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({1: 3513, 2: 2437, 0: 1450})

Epoch :  56 loss training:  18.925224866718054 Time :  22269
accuracy train: 0.995036 val: 0.746269 test: 0.713579
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({1: 3521, 0: 2435, 2: 1444})

Epoch :  57 loss training:  17.302207358181477 Time :  22331
accuracy train: 0.995036 val: 0.743284 test: 0.715805
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({0: 3523, 2: 2440, 1: 1437})

Epoch :  58 loss training:  18.331020455807447 Time :  22392
accuracy train: 0.996360 val: 0.743284 test: 0.714816
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({1: 3544, 0: 2435, 2: 1421})

Epoch :  59 loss training:  15.48935578390956 Time :  22452
accuracy train: 0.997684 val: 0.746269 test: 0.708880
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({1: 3534, 0: 2439, 2: 1427})

Epoch :  60 loss training:  16.806218402460217 Time :  22512
accuracy train: 0.997684 val: 0.737313 test: 0.713826
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({0: 3545, 1: 2436, 2: 1419})

Epoch :  61 loss training:  14.102622827515006 Time :  22577
accuracy train: 0.997353 val: 0.743284 test: 0.713332
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({2: 3542, 1: 2439, 0: 1419})

Epoch :  62 loss training:  15.855542659759521 Time :  22637
accuracy train: 0.999007 val: 0.737313 test: 0.712342
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({2: 3547, 1: 2447, 0: 1406})

Epoch :  63 loss training:  14.315668704919517 Time :  22692
accuracy train: 0.998345 val: 0.737313 test: 0.713826
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({0: 3552, 2: 2446, 1: 1402})

Epoch :  64 loss training:  14.952186776325107 Time :  22754
accuracy train: 0.996360 val: 0.722388 test: 0.708632
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({2: 3556, 1: 2442, 0: 1402})

Epoch :  65 loss training:  15.755032340064645 Time :  22825
accuracy train: 0.995698 val: 0.728358 test: 0.716052
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({1: 3575, 2: 2435, 0: 1390})

Epoch :  66 loss training:  14.33041275665164 Time :  22888
accuracy train: 0.998345 val: 0.731343 test: 0.710611
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({0: 3578, 1: 2436, 2: 1386})

Epoch :  67 loss training:  12.79895436950028 Time :  22943
accuracy train: 0.999007 val: 0.743284 test: 0.712590
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({1: 3578, 2: 2440, 0: 1382})

Epoch :  68 loss training:  11.869276070967317 Time :  22983
accuracy train: 0.998676 val: 0.740299 test: 0.716794
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({2: 3581, 1: 2440, 0: 1379})

Epoch :  69 loss training:  13.269264601171017 Time :  23040
accuracy train: 0.999669 val: 0.752239 test: 0.715558
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({0: 3574, 2: 2438, 1: 1388})

Epoch :  70 loss training:  12.09386133402586 Time :  23096
accuracy train: 0.999007 val: 0.749254 test: 0.711106
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({1: 3574, 0: 2440, 2: 1386})

Epoch :  71 loss training:  11.397147363051772 Time :  23154
accuracy train: 0.999669 val: 0.749254 test: 0.713579
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({0: 3580, 1: 2438, 2: 1382})

Epoch :  72 loss training:  11.912918996065855 Time :  23213
accuracy train: 0.998345 val: 0.740299 test: 0.714568
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({2: 3578, 1: 2444, 0: 1378})

Epoch :  73 loss training:  11.051689978688955 Time :  23272
accuracy train: 0.999338 val: 0.746269 test: 0.722731
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({2: 3570, 0: 2447, 1: 1383})

Epoch :  74 loss training:  9.740312779322267 Time :  23334
accuracy train: 0.999338 val: 0.737313 test: 0.713332
max validation accuracy : 0.752239 max acc epoch : 46 test accuracy : 0.713826
Counter({1: 3571, 0: 2444, 2: 1385})

Epoch :  75 loss training:  11.11823751218617 Time :  23391
accuracy train: 0.999669 val: 0.755224 test: 0.715558
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({0: 3575, 2: 2444, 1: 1381})

Epoch :  76 loss training:  12.036112239584327 Time :  23448
accuracy train: 0.998676 val: 0.737313 test: 0.714816
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({1: 3545, 0: 2438, 2: 1417})

Epoch :  77 loss training:  10.082897405140102 Time :  23499
accuracy train: 0.999669 val: 0.743284 test: 0.716794
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({2: 3545, 1: 2439, 0: 1416})

Epoch :  78 loss training:  10.695002121850848 Time :  23530
accuracy train: 0.999007 val: 0.728358 test: 0.716547
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({0: 3547, 1: 2440, 2: 1413})

Epoch :  79 loss training:  9.555076603777707 Time :  23580
accuracy train: 0.999338 val: 0.749254 test: 0.712837
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({0: 3598, 1: 2433, 2: 1369})

Epoch :  80 loss training:  10.431400797329843 Time :  23626
accuracy train: 1.000000 val: 0.728358 test: 0.714321
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({2: 3584, 1: 2443, 0: 1373})

Epoch :  81 loss training:  9.73583780694753 Time :  23678
accuracy train: 1.000000 val: 0.731343 test: 0.712095
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({2: 3596, 1: 2438, 0: 1366})

Epoch :  82 loss training:  8.451463702134788 Time :  23722
accuracy train: 1.000000 val: 0.722388 test: 0.708138
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({1: 3558, 2: 2439, 0: 1403})

Epoch :  83 loss training:  8.50725913234055 Time :  23772
accuracy train: 0.999669 val: 0.719403 test: 0.709127
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({1: 3568, 0: 2437, 2: 1395})

Epoch :  84 loss training:  9.311025781556964 Time :  23822
accuracy train: 1.000000 val: 0.731343 test: 0.717042
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({1: 3570, 2: 2426, 0: 1404})

Epoch :  85 loss training:  8.015536212362349 Time :  23868
accuracy train: 1.000000 val: 0.734328 test: 0.715310
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({2: 3559, 0: 2440, 1: 1401})

Epoch :  86 loss training:  8.711033335886896 Time :  23920
accuracy train: 0.999669 val: 0.734328 test: 0.715063
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({2: 3558, 0: 2438, 1: 1404})

Epoch :  87 loss training:  8.326811209321022 Time :  23962
accuracy train: 1.000000 val: 0.740299 test: 0.716300
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({2: 3548, 0: 2439, 1: 1413})

Epoch :  88 loss training:  7.721166965086013 Time :  24013
accuracy train: 0.999669 val: 0.734328 test: 0.714816
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({2: 3552, 1: 2439, 0: 1409})

Epoch :  89 loss training:  7.629552255384624 Time :  24062
accuracy train: 1.000000 val: 0.746269 test: 0.716300
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({2: 3552, 0: 2438, 1: 1410})

Epoch :  90 loss training:  7.211365728639066 Time :  24107
accuracy train: 1.000000 val: 0.752239 test: 0.722236
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({1: 3557, 2: 2435, 0: 1408})

Epoch :  91 loss training:  7.939458837732673 Time :  24151
accuracy train: 1.000000 val: 0.749254 test: 0.717042
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({1: 3561, 2: 2432, 0: 1407})

Epoch :  92 loss training:  7.117374534718692 Time :  24201
accuracy train: 1.000000 val: 0.728358 test: 0.713332
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({1: 3590, 2: 2424, 0: 1386})

Epoch :  93 loss training:  6.219949118327349 Time :  24253
accuracy train: 1.000000 val: 0.740299 test: 0.713579
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({2: 3567, 1: 2429, 0: 1404})

Epoch :  94 loss training:  7.048716495744884 Time :  24301
accuracy train: 1.000000 val: 0.740299 test: 0.711848
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({2: 3562, 1: 2432, 0: 1406})

Epoch :  95 loss training:  6.708443524315953 Time :  24356
accuracy train: 0.999669 val: 0.749254 test: 0.716547
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({2: 3553, 0: 2436, 1: 1411})

Epoch :  96 loss training:  7.8383390312083066 Time :  24409
accuracy train: 1.000000 val: 0.737313 test: 0.718279
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({2: 3592, 0: 2429, 1: 1379})

Epoch :  97 loss training:  6.512296060100198 Time :  24460
accuracy train: 1.000000 val: 0.740299 test: 0.716794
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({1: 3591, 0: 2427, 2: 1382})

Epoch :  98 loss training:  6.718369909096509 Time :  24509
accuracy train: 1.000000 val: 0.749254 test: 0.716052
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({0: 3588, 2: 2429, 1: 1383})

Epoch :  99 loss training:  5.765482141170651 Time :  24540
accuracy train: 1.000000 val: 0.752239 test: 0.717784
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({0: 3583, 2: 2433, 1: 1384})

Epoch :  100 loss training:  6.370361363980919 Time :  24593
accuracy train: 1.000000 val: 0.743284 test: 0.715558
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({1: 3591, 2: 2438, 0: 1371})

Epoch :  101 loss training:  6.894834211561829 Time :  24647
accuracy train: 1.000000 val: 0.740299 test: 0.715805
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({0: 3595, 2: 2435, 1: 1370})

Epoch :  102 loss training:  6.312506705056876 Time :  24691
accuracy train: 0.999669 val: 0.743284 test: 0.718279
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({1: 3586, 2: 2441, 0: 1373})

Epoch :  103 loss training:  6.168006455991417 Time :  24735
accuracy train: 0.999669 val: 0.749254 test: 0.716794
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({1: 3588, 2: 2435, 0: 1377})

Epoch :  104 loss training:  6.2462808871641755 Time :  24783
accuracy train: 1.000000 val: 0.737313 test: 0.720505
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({1: 3585, 2: 2432, 0: 1383})

Epoch :  105 loss training:  4.829779158346355 Time :  24833
accuracy train: 1.000000 val: 0.743284 test: 0.719268
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({1: 3592, 2: 2432, 0: 1376})

Epoch :  106 loss training:  5.8684426327236 Time :  24881
accuracy train: 1.000000 val: 0.755224 test: 0.723967
max validation accuracy : 0.755224 max acc epoch : 75 test accuracy : 0.715558
Counter({2: 3591, 1: 2430, 0: 1379})

========================================================================================================================================================================================================
max acc epoch :  75
max validation accuracy :  0.755223880597015
test accuracy :  0.7155577541429632
last test_accuracy :  0.7239673509769973
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.5, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=978, weight_decay=0)
device :  cuda:0
Counter({2: 3470, 0: 2497, 1: 1433})

Epoch :  1 loss training:  306.2593842148781 Time :  25125
accuracy train: 0.613501 val: 0.561194 test: 0.549839
max validation accuracy : 0.561194 max acc epoch : 1 test accuracy : 0.549839
Counter({1: 3456, 2: 2443, 0: 1501})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  192.21392649412155 Time :  25174
accuracy train: 0.683984 val: 0.641791 test: 0.641355
max validation accuracy : 0.641791 max acc epoch : 2 test accuracy : 0.641355
Counter({0: 3441, 1: 2442, 2: 1517})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  150.5756766796112 Time :  25220
accuracy train: 0.742224 val: 0.659701 test: 0.660895
max validation accuracy : 0.659701 max acc epoch : 3 test accuracy : 0.660895
Counter({2: 3434, 1: 2422, 0: 1544})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  122.31139352917671 Time :  25270
accuracy train: 0.808405 val: 0.671642 test: 0.693297
max validation accuracy : 0.671642 max acc epoch : 4 test accuracy : 0.693297
Counter({0: 3491, 2: 2431, 1: 1478})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  102.92201340198517 Time :  25317
accuracy train: 0.827598 val: 0.665672 test: 0.696018
max validation accuracy : 0.671642 max acc epoch : 4 test accuracy : 0.693297
Counter({0: 3469, 2: 2445, 1: 1486})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  94.86718893051147 Time :  25371
accuracy train: 0.842819 val: 0.710448 test: 0.709869
max validation accuracy : 0.710448 max acc epoch : 6 test accuracy : 0.709869
Counter({0: 3496, 1: 2449, 2: 1455})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  77.76358903944492 Time :  25425
accuracy train: 0.866645 val: 0.695522 test: 0.703438
max validation accuracy : 0.710448 max acc epoch : 6 test accuracy : 0.709869
Counter({1: 3506, 2: 2450, 0: 1444})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  76.22541481256485 Time :  25476
accuracy train: 0.878557 val: 0.734328 test: 0.703933
max validation accuracy : 0.734328 max acc epoch : 8 test accuracy : 0.703933
Counter({2: 3480, 0: 2453, 1: 1467})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  67.186265014112 Time :  25524
accuracy train: 0.893779 val: 0.701493 test: 0.701954
max validation accuracy : 0.734328 max acc epoch : 8 test accuracy : 0.703933
Counter({2: 3484, 0: 2463, 1: 1453})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.75024230778217 Time :  25589
accuracy train: 0.903706 val: 0.719403 test: 0.713084
max validation accuracy : 0.734328 max acc epoch : 8 test accuracy : 0.703933
Counter({2: 3475, 1: 2464, 0: 1461})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.695072524249554 Time :  25643
accuracy train: 0.905030 val: 0.710448 test: 0.710116
max validation accuracy : 0.734328 max acc epoch : 8 test accuracy : 0.703933
Counter({1: 3478, 2: 2454, 0: 1468})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  56.47243569791317 Time :  25676
accuracy train: 0.904699 val: 0.722388 test: 0.718773
max validation accuracy : 0.734328 max acc epoch : 8 test accuracy : 0.703933
Counter({2: 3488, 1: 2448, 0: 1464})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  53.03872922062874 Time :  25728
accuracy train: 0.911979 val: 0.728358 test: 0.713332
max validation accuracy : 0.734328 max acc epoch : 8 test accuracy : 0.703933
Counter({2: 3482, 0: 2444, 1: 1474})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  52.8394750803709 Time :  25783
accuracy train: 0.917604 val: 0.731343 test: 0.710611
max validation accuracy : 0.734328 max acc epoch : 8 test accuracy : 0.703933
Counter({1: 3480, 2: 2452, 0: 1468})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  51.077427729964256 Time :  25829
accuracy train: 0.916612 val: 0.725373 test: 0.714568
max validation accuracy : 0.734328 max acc epoch : 8 test accuracy : 0.703933
Counter({0: 3481, 1: 2448, 2: 1471})

Epoch :  16 loss training:  50.26984919607639 Time :  25860
accuracy train: 0.923561 val: 0.716418 test: 0.714321
max validation accuracy : 0.734328 max acc epoch : 8 test accuracy : 0.703933
Counter({0: 3479, 2: 2453, 1: 1468})

Epoch :  17 loss training:  47.69133921712637 Time :  25909
accuracy train: 0.918928 val: 0.725373 test: 0.714321
max validation accuracy : 0.734328 max acc epoch : 8 test accuracy : 0.703933
Counter({0: 3491, 1: 2454, 2: 1455})

Epoch :  18 loss training:  46.548974603414536 Time :  25960
accuracy train: 0.932164 val: 0.734328 test: 0.718279
max validation accuracy : 0.734328 max acc epoch : 8 test accuracy : 0.703933
Counter({1: 3491, 2: 2454, 0: 1455})

Epoch :  19 loss training:  46.71740883588791 Time :  26015
accuracy train: 0.930179 val: 0.740299 test: 0.716547
max validation accuracy : 0.740299 max acc epoch : 19 test accuracy : 0.716547
Counter({2: 3492, 0: 2455, 1: 1453})

Epoch :  20 loss training:  45.696349173784256 Time :  26069
accuracy train: 0.931171 val: 0.728358 test: 0.713084
max validation accuracy : 0.740299 max acc epoch : 19 test accuracy : 0.716547
Counter({1: 3492, 2: 2459, 0: 1449})

Epoch :  21 loss training:  42.86474400758743 Time :  26119
accuracy train: 0.938120 val: 0.746269 test: 0.718279
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({1: 3498, 2: 2451, 0: 1451})

Epoch :  22 loss training:  43.912418730556965 Time :  26176
accuracy train: 0.938451 val: 0.728358 test: 0.716547
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({2: 3504, 0: 2448, 1: 1448})

Epoch :  23 loss training:  43.11982353776693 Time :  26226
accuracy train: 0.949371 val: 0.740299 test: 0.714321
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({2: 3495, 1: 2452, 0: 1453})

Epoch :  24 loss training:  40.80023327469826 Time :  26285
accuracy train: 0.944077 val: 0.731343 test: 0.722236
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({1: 3497, 2: 2452, 0: 1451})

Epoch :  25 loss training:  40.286930702626705 Time :  26337
accuracy train: 0.954666 val: 0.728358 test: 0.718526
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({1: 3501, 2: 2454, 0: 1445})

Epoch :  26 loss training:  40.035402312874794 Time :  26390
accuracy train: 0.946724 val: 0.725373 test: 0.718526
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({2: 3503, 0: 2450, 1: 1447})

Epoch :  27 loss training:  38.02955976873636 Time :  26434
accuracy train: 0.952680 val: 0.734328 test: 0.716794
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({1: 3511, 0: 2450, 2: 1439})

Epoch :  28 loss training:  36.56334687024355 Time :  26487
accuracy train: 0.959298 val: 0.734328 test: 0.717289
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({1: 3508, 0: 2447, 2: 1445})

Epoch :  29 loss training:  37.40533050149679 Time :  26540
accuracy train: 0.958306 val: 0.734328 test: 0.711106
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({1: 3508, 2: 2450, 0: 1442})

Epoch :  30 loss training:  34.67342659831047 Time :  26600
accuracy train: 0.962277 val: 0.734328 test: 0.718031
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({2: 3523, 1: 2437, 0: 1440})

Epoch :  31 loss training:  36.11764791607857 Time :  26650
accuracy train: 0.962608 val: 0.725373 test: 0.717042
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({1: 3520, 0: 2440, 2: 1440})

Epoch :  32 loss training:  34.35547199845314 Time :  26704
accuracy train: 0.966248 val: 0.737313 test: 0.717289
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({2: 3518, 0: 2447, 1: 1435})

Epoch :  33 loss training:  32.11720684915781 Time :  26759
accuracy train: 0.963269 val: 0.740299 test: 0.712590
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({2: 3513, 0: 2449, 1: 1438})

Epoch :  34 loss training:  32.789113856852055 Time :  26797
accuracy train: 0.964593 val: 0.734328 test: 0.719515
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({0: 3505, 2: 2449, 1: 1446})

Epoch :  35 loss training:  29.824814036488533 Time :  26844
accuracy train: 0.971211 val: 0.734328 test: 0.716547
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({0: 3501, 1: 2452, 2: 1447})

Epoch :  36 loss training:  31.01310721039772 Time :  26900
accuracy train: 0.970880 val: 0.731343 test: 0.720257
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({2: 3489, 1: 2451, 0: 1460})

Epoch :  37 loss training:  29.841596856713295 Time :  26946
accuracy train: 0.973197 val: 0.734328 test: 0.717289
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({2: 3488, 0: 2447, 1: 1465})

Epoch :  38 loss training:  26.80942026525736 Time :  26994
accuracy train: 0.976506 val: 0.722388 test: 0.716794
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({2: 3487, 0: 2449, 1: 1464})

Epoch :  39 loss training:  29.68463595211506 Time :  27028
accuracy train: 0.975844 val: 0.731343 test: 0.710858
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({2: 3491, 1: 2449, 0: 1460})

Epoch :  40 loss training:  27.418335430324078 Time :  27076
accuracy train: 0.975844 val: 0.737313 test: 0.720999
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({1: 3491, 2: 2450, 0: 1459})

Epoch :  41 loss training:  27.422864884138107 Time :  27130
accuracy train: 0.979484 val: 0.731343 test: 0.715805
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({2: 3483, 0: 2450, 1: 1467})

Epoch :  42 loss training:  25.924096900969744 Time :  27184
accuracy train: 0.982462 val: 0.746269 test: 0.719515
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({1: 3498, 0: 2446, 2: 1456})

Epoch :  43 loss training:  25.401416301727295 Time :  27235
accuracy train: 0.981469 val: 0.728358 test: 0.719268
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({2: 3500, 0: 2443, 1: 1457})

Epoch :  44 loss training:  26.034217972308397 Time :  27284
accuracy train: 0.984778 val: 0.743284 test: 0.718279
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({0: 3501, 1: 2445, 2: 1454})

Epoch :  45 loss training:  22.221294343471527 Time :  27330
accuracy train: 0.988087 val: 0.737313 test: 0.718279
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({1: 3499, 2: 2444, 0: 1457})

Epoch :  46 loss training:  22.48066581785679 Time :  27363
accuracy train: 0.986102 val: 0.734328 test: 0.719763
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({2: 3512, 0: 2444, 1: 1444})

Epoch :  47 loss training:  24.85848968476057 Time :  27415
accuracy train: 0.987095 val: 0.743284 test: 0.715063
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({0: 3527, 2: 2442, 1: 1431})

Epoch :  48 loss training:  22.114103462547064 Time :  27465
accuracy train: 0.989742 val: 0.743284 test: 0.713826
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({2: 3514, 0: 2444, 1: 1442})

Epoch :  49 loss training:  21.793740760535 Time :  27517
accuracy train: 0.991066 val: 0.737313 test: 0.716794
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({0: 3505, 2: 2445, 1: 1450})

Epoch :  50 loss training:  21.089326683431864 Time :  27566
accuracy train: 0.993051 val: 0.719403 test: 0.715558
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({1: 3494, 0: 2446, 2: 1460})

Epoch :  51 loss training:  20.65865806117654 Time :  27605
accuracy train: 0.991727 val: 0.725373 test: 0.711600
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({0: 3496, 1: 2443, 2: 1461})

Epoch :  52 loss training:  21.840567339211702 Time :  27655
accuracy train: 0.993382 val: 0.728358 test: 0.714074
max validation accuracy : 0.746269 max acc epoch : 21 test accuracy : 0.718279
Counter({0: 3495, 1: 2442, 2: 1463})

========================================================================================================================================================================================================
max acc epoch :  21
max validation accuracy :  0.746268656716418
test accuracy :  0.7182785060598565
last test_accuracy :  0.7140737076428395
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.75522 	 test_accuracy : 0.71877 	 max_acc epoch :  66 	 last test_accuracy : 0.71803
k :  1 	 val_accuracy : 0.75821 	 test_accuracy : 0.71630 	 max_acc epoch :  46 	 last test_accuracy : 0.71432
k :  2 	 val_accuracy : 0.75821 	 test_accuracy : 0.71605 	 max_acc epoch :  75 	 last test_accuracy : 0.72050
k :  3 	 val_accuracy : 0.75522 	 test_accuracy : 0.71556 	 max_acc epoch :  75 	 last test_accuracy : 0.72397
k :  4 	 val_accuracy : 0.74627 	 test_accuracy : 0.71828 	 max_acc epoch :  21 	 last test_accuracy : 0.71407

avg :  	 val_accuracy : 0.75463 	 test_accuracy : 0.71699 	 last_accuracy : 0.71818
