

date and time :  Sun May 23 23:43:45 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=729, weight_decay=1e-07)
device :  cuda:0
Counter({2: 4230, 0: 2303, 1: 1158})

Epoch :  1 loss training:  47.024259962141514 Time :  192
accuracy train: 0.943446 val: 0.945455 test: 0.935616
max validation accuracy : 0.945455 max acc epoch : 1 test accuracy : 0.935616
Counter({0: 3529, 1: 2611, 2: 1551})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.771534375846386 Time :  297
accuracy train: 0.963846 val: 0.945455 test: 0.959361
max validation accuracy : 0.945455 max acc epoch : 1 test accuracy : 0.935616
Counter({0: 3602, 2: 2511, 1: 1578})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.95505178021267 Time :  391
accuracy train: 0.973945 val: 0.949091 test: 0.968950
max validation accuracy : 0.949091 max acc epoch : 3 test accuracy : 0.968950
Counter({0: 3620, 1: 2480, 2: 1591})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.751572688110173 Time :  482
accuracy train: 0.986467 val: 0.961818 test: 0.967580
max validation accuracy : 0.961818 max acc epoch : 4 test accuracy : 0.967580
Counter({1: 3691, 0: 2399, 2: 1601})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.117868728470057 Time :  578
accuracy train: 0.983438 val: 0.963636 test: 0.973516
max validation accuracy : 0.963636 max acc epoch : 5 test accuracy : 0.973516
Counter({1: 3689, 0: 2401, 2: 1601})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.083639187272638 Time :  669
accuracy train: 0.984448 val: 0.965455 test: 0.966210
max validation accuracy : 0.965455 max acc epoch : 6 test accuracy : 0.966210
Counter({1: 3712, 0: 2399, 2: 1580})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.25657235190738 Time :  770
accuracy train: 0.991921 val: 0.965455 test: 0.971233
max validation accuracy : 0.965455 max acc epoch : 6 test accuracy : 0.966210
Counter({0: 3727, 1: 2388, 2: 1576})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.7603405374102294 Time :  860
accuracy train: 0.991719 val: 0.967273 test: 0.969863
max validation accuracy : 0.967273 max acc epoch : 8 test accuracy : 0.969863
Counter({0: 3734, 2: 2380, 1: 1577})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.985252232290804 Time :  955
accuracy train: 0.991517 val: 0.967273 test: 0.972603
max validation accuracy : 0.967273 max acc epoch : 8 test accuracy : 0.969863
Counter({0: 3752, 1: 2366, 2: 1573})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.3192469746863935 Time :  1054
accuracy train: 0.992527 val: 0.967273 test: 0.970320
max validation accuracy : 0.967273 max acc epoch : 8 test accuracy : 0.969863
Counter({0: 3766, 2: 2357, 1: 1568})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.584424536733422 Time :  1136
accuracy train: 0.993133 val: 0.970909 test: 0.971233
max validation accuracy : 0.970909 max acc epoch : 11 test accuracy : 0.971233
Counter({1: 3777, 0: 2358, 2: 1556})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  5.303571943426505 Time :  1234
accuracy train: 0.993537 val: 0.972727 test: 0.969863
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.969863
Counter({0: 3784, 2: 2353, 1: 1554})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  5.269974888418801 Time :  1319
accuracy train: 0.993335 val: 0.970909 test: 0.971233
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.969863
Counter({0: 3787, 2: 2350, 1: 1554})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.553531606681645 Time :  1415
accuracy train: 0.994143 val: 0.969091 test: 0.973059
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.969863
Counter({1: 3792, 0: 2352, 2: 1547})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  4.532467796932906 Time :  1503
accuracy train: 0.994547 val: 0.967273 test: 0.968037
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.969863
Counter({0: 3797, 2: 2346, 1: 1548})

Epoch :  16 loss training:  4.335787207819521 Time :  1593
accuracy train: 0.995152 val: 0.970909 test: 0.971689
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.969863
Counter({0: 3798, 2: 2343, 1: 1550})

Epoch :  17 loss training:  4.564763321424834 Time :  1684
accuracy train: 0.995354 val: 0.970909 test: 0.971233
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.969863
Counter({1: 3801, 0: 2340, 2: 1550})

Epoch :  18 loss training:  4.627612585551105 Time :  1770
accuracy train: 0.995556 val: 0.969091 test: 0.968037
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.969863
Counter({0: 3804, 2: 2339, 1: 1548})

Epoch :  19 loss training:  4.331562501261942 Time :  1854
accuracy train: 0.995152 val: 0.970909 test: 0.969863
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.969863
Counter({0: 3805, 2: 2336, 1: 1550})

Epoch :  20 loss training:  3.7164929276914336 Time :  1948
accuracy train: 0.995960 val: 0.967273 test: 0.967123
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.969863
Counter({0: 3803, 2: 2335, 1: 1553})

Epoch :  21 loss training:  3.250489283760544 Time :  2035
accuracy train: 0.996162 val: 0.969091 test: 0.969863
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.969863
Counter({0: 3812, 2: 2328, 1: 1551})

Epoch :  22 loss training:  3.481930526846554 Time :  2121
accuracy train: 0.995758 val: 0.967273 test: 0.970776
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.969863
Counter({0: 3811, 2: 2327, 1: 1553})

Epoch :  23 loss training:  3.206498617102625 Time :  2222
accuracy train: 0.995758 val: 0.967273 test: 0.966667
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.969863
Counter({0: 3813, 2: 2329, 1: 1549})

Epoch :  24 loss training:  3.523067365633324 Time :  2317
accuracy train: 0.995960 val: 0.970909 test: 0.970320
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.969863
Counter({0: 3816, 1: 2327, 2: 1548})

Epoch :  25 loss training:  2.9521925356821157 Time :  2411
accuracy train: 0.996162 val: 0.969091 test: 0.970776
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.969863
Counter({0: 3821, 2: 2327, 1: 1543})

Epoch :  26 loss training:  3.3187728289340157 Time :  2508
accuracy train: 0.996162 val: 0.970909 test: 0.973059
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.969863
Counter({0: 3822, 2: 2326, 1: 1543})

Epoch :  27 loss training:  2.7674305975669995 Time :  2592
accuracy train: 0.996162 val: 0.969091 test: 0.969863
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.969863
Counter({0: 3826, 1: 2325, 2: 1540})

Epoch :  28 loss training:  2.723243188127526 Time :  2692
accuracy train: 0.996364 val: 0.970909 test: 0.969863
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.969863
Counter({0: 3831, 1: 2324, 2: 1536})

Epoch :  29 loss training:  3.0145772307296284 Time :  2771
accuracy train: 0.996566 val: 0.972727 test: 0.972603
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.969863
Counter({0: 3832, 2: 2323, 1: 1536})

Epoch :  30 loss training:  2.676091895744321 Time :  2843
accuracy train: 0.996364 val: 0.970909 test: 0.970320
max validation accuracy : 0.972727 max acc epoch : 12 test accuracy : 0.969863
Counter({0: 3837, 2: 2319, 1: 1535})

Epoch :  31 loss training:  2.638002837309614 Time :  2924
accuracy train: 0.996970 val: 0.974545 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 31 test accuracy : 0.971689
Counter({0: 3838, 2: 2316, 1: 1537})

Epoch :  32 loss training:  2.5818235139886383 Time :  3013
accuracy train: 0.996566 val: 0.972727 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 31 test accuracy : 0.971689
Counter({0: 3840, 2: 2314, 1: 1537})

Epoch :  33 loss training:  2.73009260580875 Time :  3113
accuracy train: 0.996970 val: 0.974545 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 31 test accuracy : 0.971689
Counter({0: 3845, 1: 2313, 2: 1533})

Epoch :  34 loss training:  2.582811375730671 Time :  3202
accuracy train: 0.996566 val: 0.967273 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 31 test accuracy : 0.971689
Counter({0: 3847, 2: 2310, 1: 1534})

Epoch :  35 loss training:  2.541210682495148 Time :  3290
accuracy train: 0.996768 val: 0.970909 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 31 test accuracy : 0.971689
Counter({1: 3849, 2: 2308, 0: 1534})

Epoch :  36 loss training:  2.506388955436705 Time :  3373
accuracy train: 0.996566 val: 0.967273 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 31 test accuracy : 0.971689
Counter({0: 3849, 1: 2308, 2: 1534})

Epoch :  37 loss training:  2.2456194848637097 Time :  3463
accuracy train: 0.996364 val: 0.972727 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 31 test accuracy : 0.971689
Counter({0: 3853, 1: 2301, 2: 1537})

Epoch :  38 loss training:  1.9953739828633843 Time :  3542
accuracy train: 0.996364 val: 0.972727 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 31 test accuracy : 0.971689
Counter({0: 3853, 1: 2303, 2: 1535})

Epoch :  39 loss training:  1.9718578500906006 Time :  3640
accuracy train: 0.996768 val: 0.970909 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 31 test accuracy : 0.971689
Counter({0: 3852, 1: 2303, 2: 1536})

Epoch :  40 loss training:  2.08066345952102 Time :  3734
accuracy train: 0.996970 val: 0.976364 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({2: 3852, 1: 2297, 0: 1542})

Epoch :  41 loss training:  2.2449240291462047 Time :  3830
accuracy train: 0.996566 val: 0.974545 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({1: 3850, 0: 2292, 2: 1549})

Epoch :  42 loss training:  2.103166201406566 Time :  3918
accuracy train: 0.996768 val: 0.972727 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({0: 3854, 2: 2296, 1: 1541})

Epoch :  43 loss training:  2.036708017294586 Time :  4004
accuracy train: 0.997172 val: 0.969091 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({0: 3855, 2: 2295, 1: 1541})

Epoch :  44 loss training:  1.9222760091070086 Time :  4103
accuracy train: 0.997172 val: 0.974545 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({0: 3857, 2: 2294, 1: 1540})

Epoch :  45 loss training:  1.8335039637313457 Time :  4192
accuracy train: 0.997172 val: 0.972727 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({0: 3857, 2: 2294, 1: 1540})

Epoch :  46 loss training:  2.2026838316669455 Time :  4289
accuracy train: 0.996970 val: 0.972727 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({1: 3856, 0: 2292, 2: 1543})

Epoch :  47 loss training:  1.9304440659034299 Time :  4384
accuracy train: 0.996566 val: 0.970909 test: 0.968037
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({0: 3856, 1: 2292, 2: 1543})

Epoch :  48 loss training:  1.733959825898637 Time :  4479
accuracy train: 0.996970 val: 0.972727 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({0: 3855, 1: 2292, 2: 1544})

Epoch :  49 loss training:  1.6991194051333878 Time :  4566
accuracy train: 0.996970 val: 0.972727 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({0: 3855, 1: 2291, 2: 1545})

Epoch :  50 loss training:  1.69905775951338 Time :  4663
accuracy train: 0.996970 val: 0.970909 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({0: 3858, 1: 2290, 2: 1543})

Epoch :  51 loss training:  1.6675581727249664 Time :  4759
accuracy train: 0.996970 val: 0.970909 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({0: 3858, 1: 2286, 2: 1547})

Epoch :  52 loss training:  2.1248940131190466 Time :  4850
accuracy train: 0.996970 val: 0.972727 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({1: 3858, 0: 2285, 2: 1548})

Epoch :  53 loss training:  1.7071127234084997 Time :  4934
accuracy train: 0.996970 val: 0.969091 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({0: 3860, 2: 2286, 1: 1545})

Epoch :  54 loss training:  1.5732377852109494 Time :  5025
accuracy train: 0.996970 val: 0.970909 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({0: 3860, 1: 2286, 2: 1545})

Epoch :  55 loss training:  1.7681782041181577 Time :  5110
accuracy train: 0.997172 val: 0.972727 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({1: 3860, 0: 2286, 2: 1545})

Epoch :  56 loss training:  1.5741204705554992 Time :  5197
accuracy train: 0.996970 val: 0.969091 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({0: 3862, 1: 2289, 2: 1540})

Epoch :  57 loss training:  1.3893183146501542 Time :  5282
accuracy train: 0.996970 val: 0.969091 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({1: 3862, 0: 2289, 2: 1540})

Epoch :  58 loss training:  1.4447922299514175 Time :  5370
accuracy train: 0.996970 val: 0.970909 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({0: 3862, 2: 2289, 1: 1540})

Epoch :  59 loss training:  1.664275318813452 Time :  5462
accuracy train: 0.996970 val: 0.972727 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({0: 3862, 2: 2290, 1: 1539})

Epoch :  60 loss training:  1.3163478853857669 Time :  5552
accuracy train: 0.997172 val: 0.974545 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({0: 3860, 1: 2289, 2: 1542})

Epoch :  61 loss training:  1.5856330094648001 Time :  5645
accuracy train: 0.996768 val: 0.974545 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({0: 3861, 1: 2289, 2: 1541})

Epoch :  62 loss training:  1.566625342824409 Time :  5728
accuracy train: 0.997172 val: 0.972727 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({0: 3860, 2: 2290, 1: 1541})

Epoch :  63 loss training:  1.5294051854871213 Time :  5834
accuracy train: 0.997374 val: 0.974545 test: 0.973516
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({0: 3859, 1: 2288, 2: 1544})

Epoch :  64 loss training:  1.5491595050334581 Time :  5927
accuracy train: 0.996970 val: 0.972727 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({0: 3859, 2: 2288, 1: 1544})

Epoch :  65 loss training:  1.7900817487679888 Time :  6019
accuracy train: 0.997172 val: 0.972727 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({0: 3860, 1: 2285, 2: 1546})

Epoch :  66 loss training:  1.3627590714204416 Time :  6113
accuracy train: 0.996970 val: 0.974545 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({0: 3859, 1: 2286, 2: 1546})

Epoch :  67 loss training:  1.385603832111883 Time :  6205
accuracy train: 0.997172 val: 0.974545 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({1: 3860, 0: 2287, 2: 1544})

Epoch :  68 loss training:  1.543255674539978 Time :  6304
accuracy train: 0.996970 val: 0.974545 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({2: 3865, 1: 2285, 0: 1541})

Epoch :  69 loss training:  1.4465537792020768 Time :  6406
accuracy train: 0.996970 val: 0.972727 test: 0.973516
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({0: 3863, 1: 2284, 2: 1544})

Epoch :  70 loss training:  1.6101038013584912 Time :  6518
accuracy train: 0.997172 val: 0.972727 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({0: 3864, 1: 2284, 2: 1543})

Epoch :  71 loss training:  1.3007470149859728 Time :  6628
accuracy train: 0.996970 val: 0.972727 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 40 test accuracy : 0.971233
Counter({0: 3863, 1: 2284, 2: 1544})

========================================================================================================================================================================================================
max acc epoch :  40
max validation accuracy :  0.9763636363636363
test accuracy :  0.9712328767123287
last test_accuracy :  0.9712328767123287
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=729, weight_decay=1e-07)
device :  cuda:0
Counter({2: 4230, 1: 2303, 0: 1158})

Epoch :  1 loss training:  46.652951093390584 Time :  6861
accuracy train: 0.944052 val: 0.949091 test: 0.933790
max validation accuracy : 0.949091 max acc epoch : 1 test accuracy : 0.933790
Counter({0: 3437, 1: 2701, 2: 1553})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.5591710107401 Time :  6955
accuracy train: 0.960816 val: 0.941818 test: 0.962100
max validation accuracy : 0.949091 max acc epoch : 1 test accuracy : 0.933790
Counter({0: 3603, 1: 2557, 2: 1531})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  17.070445242337883 Time :  7041
accuracy train: 0.976570 val: 0.954545 test: 0.972603
max validation accuracy : 0.954545 max acc epoch : 3 test accuracy : 0.972603
Counter({0: 3601, 1: 2554, 2: 1536})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.117085521109402 Time :  7143
accuracy train: 0.987275 val: 0.963636 test: 0.971689
max validation accuracy : 0.963636 max acc epoch : 4 test accuracy : 0.971689
Counter({0: 3644, 1: 2468, 2: 1579})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.933254199102521 Time :  7244
accuracy train: 0.986063 val: 0.961818 test: 0.969863
max validation accuracy : 0.963636 max acc epoch : 4 test accuracy : 0.971689
Counter({2: 3656, 0: 2475, 1: 1560})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.337724960409105 Time :  7346
accuracy train: 0.988083 val: 0.972727 test: 0.964384
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3666, 2: 2481, 1: 1544})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.424974614405073 Time :  7445
accuracy train: 0.990709 val: 0.969091 test: 0.973059
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3667, 1: 2483, 2: 1541})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.456986919976771 Time :  7533
accuracy train: 0.991719 val: 0.970909 test: 0.964840
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3679, 2: 2468, 1: 1544})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.028012443915941 Time :  7620
accuracy train: 0.992325 val: 0.963636 test: 0.971689
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({1: 3693, 0: 2459, 2: 1539})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.548540891642915 Time :  7715
accuracy train: 0.993133 val: 0.969091 test: 0.967580
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3707, 1: 2445, 2: 1539})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.323341571085621 Time :  7807
accuracy train: 0.994547 val: 0.967273 test: 0.968037
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3712, 1: 2446, 2: 1533})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.977091972017661 Time :  7898
accuracy train: 0.992729 val: 0.967273 test: 0.965753
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3742, 2: 2416, 1: 1533})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  4.967139525455423 Time :  7986
accuracy train: 0.994345 val: 0.969091 test: 0.967580
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3742, 2: 2416, 1: 1533})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.668956053559668 Time :  8074
accuracy train: 0.994547 val: 0.969091 test: 0.970776
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3747, 2: 2422, 1: 1522})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  4.135001098155044 Time :  8166
accuracy train: 0.994749 val: 0.969091 test: 0.967580
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({1: 3751, 0: 2417, 2: 1523})

Epoch :  16 loss training:  4.33611897402443 Time :  8256
accuracy train: 0.995556 val: 0.967273 test: 0.968493
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3752, 2: 2415, 1: 1524})

Epoch :  17 loss training:  4.456735875224695 Time :  8347
accuracy train: 0.995960 val: 0.967273 test: 0.966667
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3759, 2: 2409, 1: 1523})

Epoch :  18 loss training:  4.275839098729193 Time :  8439
accuracy train: 0.995152 val: 0.969091 test: 0.968037
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3758, 2: 2403, 1: 1530})

Epoch :  19 loss training:  4.408829039311968 Time :  8546
accuracy train: 0.995960 val: 0.972727 test: 0.968493
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({1: 3763, 2: 2405, 0: 1523})

Epoch :  20 loss training:  3.903974335582461 Time :  8641
accuracy train: 0.995960 val: 0.970909 test: 0.965753
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3764, 2: 2403, 1: 1524})

Epoch :  21 loss training:  3.3005939052673057 Time :  8749
accuracy train: 0.996162 val: 0.970909 test: 0.968493
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3774, 1: 2391, 2: 1526})

Epoch :  22 loss training:  3.392741576419212 Time :  8838
accuracy train: 0.996364 val: 0.969091 test: 0.969863
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3772, 1: 2395, 2: 1524})

Epoch :  23 loss training:  3.063132881070487 Time :  8921
accuracy train: 0.996162 val: 0.967273 test: 0.966210
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3778, 2: 2393, 1: 1520})

Epoch :  24 loss training:  3.486972079379484 Time :  9005
accuracy train: 0.996566 val: 0.970909 test: 0.970776
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3780, 1: 2390, 2: 1521})

Epoch :  25 loss training:  3.043822564650327 Time :  9097
accuracy train: 0.996364 val: 0.972727 test: 0.971233
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3783, 1: 2387, 2: 1521})

Epoch :  26 loss training:  3.1296110164548736 Time :  9184
accuracy train: 0.996768 val: 0.972727 test: 0.973059
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3791, 1: 2382, 2: 1518})

Epoch :  27 loss training:  2.955279504589271 Time :  9258
accuracy train: 0.996364 val: 0.970909 test: 0.968950
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3794, 1: 2382, 2: 1515})

Epoch :  28 loss training:  2.6251845873048296 Time :  9349
accuracy train: 0.996768 val: 0.969091 test: 0.969406
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3798, 1: 2379, 2: 1514})

Epoch :  29 loss training:  2.659300485131098 Time :  9442
accuracy train: 0.996566 val: 0.970909 test: 0.970320
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({1: 3800, 2: 2374, 0: 1517})

Epoch :  30 loss training:  2.6031938185187755 Time :  9533
accuracy train: 0.996970 val: 0.969091 test: 0.971689
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3807, 1: 2366, 2: 1518})

Epoch :  31 loss training:  2.671531846775906 Time :  9620
accuracy train: 0.996768 val: 0.972727 test: 0.971689
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3810, 2: 2360, 1: 1521})

Epoch :  32 loss training:  2.330024227470858 Time :  9720
accuracy train: 0.996768 val: 0.972727 test: 0.969863
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({1: 3809, 2: 2359, 0: 1523})

Epoch :  33 loss training:  2.6993920252716634 Time :  9825
accuracy train: 0.996566 val: 0.970909 test: 0.969406
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({1: 3817, 0: 2354, 2: 1520})

Epoch :  34 loss training:  2.406883768417174 Time :  9908
accuracy train: 0.996566 val: 0.972727 test: 0.967580
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3821, 1: 2353, 2: 1517})

Epoch :  35 loss training:  2.367473019345198 Time :  9998
accuracy train: 0.996768 val: 0.972727 test: 0.968950
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3820, 1: 2353, 2: 1518})

Epoch :  36 loss training:  2.635655072372174 Time :  10092
accuracy train: 0.996566 val: 0.972727 test: 0.970776
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3824, 1: 2349, 2: 1518})

Epoch :  37 loss training:  2.1072116053983336 Time :  10186
accuracy train: 0.996768 val: 0.972727 test: 0.969406
max validation accuracy : 0.972727 max acc epoch : 6 test accuracy : 0.964384
Counter({0: 3828, 1: 2347, 2: 1516})

========================================================================================================================================================================================================
max acc epoch :  6
max validation accuracy :  0.9727272727272728
test accuracy :  0.9643835616438357
last test_accuracy :  0.9694063926940639
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=729, weight_decay=1e-07)
device :  cuda:0
Counter({2: 4230, 1: 2303, 0: 1158})

Epoch :  1 loss training:  46.752540461719036 Time :  10428
accuracy train: 0.935569 val: 0.941818 test: 0.926941
max validation accuracy : 0.941818 max acc epoch : 1 test accuracy : 0.926941
Counter({0: 3429, 2: 2746, 1: 1516})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.557167151011527 Time :  10527
accuracy train: 0.961220 val: 0.943636 test: 0.962557
max validation accuracy : 0.943636 max acc epoch : 2 test accuracy : 0.962557
Counter({0: 3597, 1: 2531, 2: 1563})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.981062901671976 Time :  10610
accuracy train: 0.971117 val: 0.954545 test: 0.969406
max validation accuracy : 0.954545 max acc epoch : 3 test accuracy : 0.969406
Counter({2: 3602, 1: 2401, 0: 1688})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.854467023164034 Time :  10708
accuracy train: 0.986265 val: 0.963636 test: 0.971689
max validation accuracy : 0.963636 max acc epoch : 4 test accuracy : 0.971689
Counter({0: 3619, 1: 2393, 2: 1679})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.961276589892805 Time :  10798
accuracy train: 0.981822 val: 0.958182 test: 0.970320
max validation accuracy : 0.963636 max acc epoch : 4 test accuracy : 0.971689
Counter({0: 3670, 1: 2403, 2: 1618})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.874187945621088 Time :  10896
accuracy train: 0.986669 val: 0.970909 test: 0.968037
max validation accuracy : 0.970909 max acc epoch : 6 test accuracy : 0.968037
Counter({0: 3656, 2: 2435, 1: 1600})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.464545735856518 Time :  10989
accuracy train: 0.990507 val: 0.972727 test: 0.971233
max validation accuracy : 0.972727 max acc epoch : 7 test accuracy : 0.971233
Counter({0: 3662, 1: 2443, 2: 1586})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.677632623817772 Time :  11084
accuracy train: 0.991719 val: 0.967273 test: 0.968950
max validation accuracy : 0.972727 max acc epoch : 7 test accuracy : 0.971233
Counter({0: 3665, 2: 2445, 1: 1581})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.55467577080708 Time :  11183
accuracy train: 0.991315 val: 0.963636 test: 0.970776
max validation accuracy : 0.972727 max acc epoch : 7 test accuracy : 0.971233
Counter({0: 3679, 1: 2427, 2: 1585})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.723088373197243 Time :  11287
accuracy train: 0.992729 val: 0.967273 test: 0.969406
max validation accuracy : 0.972727 max acc epoch : 7 test accuracy : 0.971233
Counter({0: 3690, 2: 2421, 1: 1580})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.317772774986224 Time :  11376
accuracy train: 0.993941 val: 0.963636 test: 0.969863
max validation accuracy : 0.972727 max acc epoch : 7 test accuracy : 0.971233
Counter({0: 3705, 2: 2416, 1: 1570})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  4.948148328345269 Time :  11461
accuracy train: 0.992931 val: 0.969091 test: 0.966210
max validation accuracy : 0.972727 max acc epoch : 7 test accuracy : 0.971233
Counter({0: 3727, 2: 2404, 1: 1560})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  4.916904328390956 Time :  11555
accuracy train: 0.994547 val: 0.965455 test: 0.968950
max validation accuracy : 0.972727 max acc epoch : 7 test accuracy : 0.971233
Counter({0: 3732, 2: 2402, 1: 1557})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.749567410675809 Time :  11647
accuracy train: 0.994143 val: 0.965455 test: 0.970776
max validation accuracy : 0.972727 max acc epoch : 7 test accuracy : 0.971233
Counter({0: 3735, 1: 2404, 2: 1552})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  4.372556623711716 Time :  11746
accuracy train: 0.994951 val: 0.967273 test: 0.968037
max validation accuracy : 0.972727 max acc epoch : 7 test accuracy : 0.971233
Counter({0: 3743, 1: 2399, 2: 1549})

Epoch :  16 loss training:  4.453102451690938 Time :  11840
accuracy train: 0.994951 val: 0.967273 test: 0.970320
max validation accuracy : 0.972727 max acc epoch : 7 test accuracy : 0.971233
Counter({0: 3743, 1: 2399, 2: 1549})

Epoch :  17 loss training:  4.334857752197422 Time :  11942
accuracy train: 0.994951 val: 0.967273 test: 0.970776
max validation accuracy : 0.972727 max acc epoch : 7 test accuracy : 0.971233
Counter({0: 3746, 2: 2400, 1: 1545})

Epoch :  18 loss training:  4.308664433658123 Time :  12022
accuracy train: 0.995758 val: 0.967273 test: 0.969863
max validation accuracy : 0.972727 max acc epoch : 7 test accuracy : 0.971233
Counter({0: 3750, 1: 2396, 2: 1545})

Epoch :  19 loss training:  4.318235241516959 Time :  12102
accuracy train: 0.995758 val: 0.969091 test: 0.968493
max validation accuracy : 0.972727 max acc epoch : 7 test accuracy : 0.971233
Counter({0: 3752, 2: 2395, 1: 1544})

Epoch :  20 loss training:  3.7208098309929483 Time :  12187
accuracy train: 0.995960 val: 0.970909 test: 0.967123
max validation accuracy : 0.972727 max acc epoch : 7 test accuracy : 0.971233
Counter({0: 3757, 1: 2391, 2: 1543})

Epoch :  21 loss training:  3.304221691098064 Time :  12269
accuracy train: 0.995960 val: 0.969091 test: 0.968950
max validation accuracy : 0.972727 max acc epoch : 7 test accuracy : 0.971233
Counter({0: 3767, 1: 2385, 2: 1539})

Epoch :  22 loss training:  3.432057689758949 Time :  12347
accuracy train: 0.996566 val: 0.967273 test: 0.971689
max validation accuracy : 0.972727 max acc epoch : 7 test accuracy : 0.971233
Counter({1: 3766, 0: 2383, 2: 1542})

Epoch :  23 loss training:  3.2202403841074556 Time :  12429
accuracy train: 0.995960 val: 0.967273 test: 0.969406
max validation accuracy : 0.972727 max acc epoch : 7 test accuracy : 0.971233
Counter({1: 3776, 0: 2379, 2: 1536})

Epoch :  24 loss training:  3.2746010980335996 Time :  12512
accuracy train: 0.996566 val: 0.969091 test: 0.970776
max validation accuracy : 0.972727 max acc epoch : 7 test accuracy : 0.971233
Counter({0: 3778, 1: 2378, 2: 1535})

Epoch :  25 loss training:  3.2536013815551996 Time :  12594
accuracy train: 0.996162 val: 0.969091 test: 0.970776
max validation accuracy : 0.972727 max acc epoch : 7 test accuracy : 0.971233
Counter({1: 3782, 0: 2372, 2: 1537})

Epoch :  26 loss training:  3.2251669786055572 Time :  12673
accuracy train: 0.996566 val: 0.974545 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 26 test accuracy : 0.972603
Counter({0: 3783, 2: 2373, 1: 1535})

Epoch :  27 loss training:  3.006314189871773 Time :  12749
accuracy train: 0.996364 val: 0.969091 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 26 test accuracy : 0.972603
Counter({0: 3788, 1: 2369, 2: 1534})

Epoch :  28 loss training:  2.7358260397450067 Time :  12831
accuracy train: 0.996566 val: 0.969091 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 26 test accuracy : 0.972603
Counter({0: 3791, 1: 2369, 2: 1531})

Epoch :  29 loss training:  2.829387781152036 Time :  12911
accuracy train: 0.996364 val: 0.970909 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 26 test accuracy : 0.972603
Counter({0: 3793, 1: 2366, 2: 1532})

Epoch :  30 loss training:  2.823603253244073 Time :  12994
accuracy train: 0.996566 val: 0.970909 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 26 test accuracy : 0.972603
Counter({0: 3798, 2: 2358, 1: 1535})

Epoch :  31 loss training:  2.4896349096525228 Time :  13074
accuracy train: 0.997172 val: 0.970909 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 26 test accuracy : 0.972603
Counter({0: 3796, 1: 2360, 2: 1535})

Epoch :  32 loss training:  2.454839681973681 Time :  13154
accuracy train: 0.996970 val: 0.974545 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 26 test accuracy : 0.972603
Counter({1: 3796, 0: 2355, 2: 1540})

Epoch :  33 loss training:  2.7149274880357552 Time :  13231
accuracy train: 0.996768 val: 0.972727 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 26 test accuracy : 0.972603
Counter({0: 3797, 1: 2352, 2: 1542})

Epoch :  34 loss training:  2.6469368108955678 Time :  13313
accuracy train: 0.996768 val: 0.970909 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 26 test accuracy : 0.972603
Counter({0: 3798, 1: 2353, 2: 1540})

Epoch :  35 loss training:  2.598652338667307 Time :  13387
accuracy train: 0.996768 val: 0.974545 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 26 test accuracy : 0.972603
Counter({0: 3796, 1: 2349, 2: 1546})

Epoch :  36 loss training:  2.6820961534394883 Time :  13470
accuracy train: 0.996566 val: 0.976364 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({1: 3797, 0: 2344, 2: 1550})

Epoch :  37 loss training:  2.5025829049554886 Time :  13553
accuracy train: 0.996768 val: 0.969091 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({0: 3804, 1: 2333, 2: 1554})

Epoch :  38 loss training:  1.8668729300698033 Time :  13640
accuracy train: 0.996566 val: 0.972727 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({0: 3804, 2: 2334, 1: 1553})

Epoch :  39 loss training:  2.0917904593225103 Time :  13730
accuracy train: 0.996970 val: 0.974545 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({0: 3806, 1: 2330, 2: 1555})

Epoch :  40 loss training:  2.040647957182955 Time :  13813
accuracy train: 0.996970 val: 0.974545 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({0: 3808, 1: 2326, 2: 1557})

Epoch :  41 loss training:  2.1577795745106414 Time :  13891
accuracy train: 0.996364 val: 0.976364 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({0: 3809, 1: 2320, 2: 1562})

Epoch :  42 loss training:  1.9665278560496517 Time :  13981
accuracy train: 0.996566 val: 0.970909 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({0: 3809, 1: 2320, 2: 1562})

Epoch :  43 loss training:  2.060715353483829 Time :  14063
accuracy train: 0.996970 val: 0.972727 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({0: 3812, 1: 2318, 2: 1561})

Epoch :  44 loss training:  1.959683653738466 Time :  14139
accuracy train: 0.997172 val: 0.972727 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({0: 3815, 1: 2318, 2: 1558})

Epoch :  45 loss training:  1.8697925252345158 Time :  14217
accuracy train: 0.997374 val: 0.976364 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({0: 3815, 1: 2320, 2: 1556})

Epoch :  46 loss training:  1.8617469222226646 Time :  14294
accuracy train: 0.996566 val: 0.970909 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({0: 3816, 1: 2317, 2: 1558})

Epoch :  47 loss training:  1.6464488409474143 Time :  14363
accuracy train: 0.996768 val: 0.972727 test: 0.970320
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({0: 3817, 1: 2316, 2: 1558})

Epoch :  48 loss training:  1.9829950650891988 Time :  14444
accuracy train: 0.996768 val: 0.970909 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({0: 3817, 1: 2310, 2: 1564})

Epoch :  49 loss training:  1.7404481840203516 Time :  14522
accuracy train: 0.996970 val: 0.972727 test: 0.969863
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({0: 3818, 1: 2308, 2: 1565})

Epoch :  50 loss training:  1.6495285407072515 Time :  14621
accuracy train: 0.996768 val: 0.972727 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({0: 3818, 1: 2308, 2: 1565})

Epoch :  51 loss training:  1.6797912028887367 Time :  14702
accuracy train: 0.996768 val: 0.974545 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({0: 3828, 1: 2303, 2: 1560})

Epoch :  52 loss training:  1.696748864109395 Time :  14780
accuracy train: 0.996970 val: 0.972727 test: 0.973516
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({0: 3828, 1: 2302, 2: 1561})

Epoch :  53 loss training:  1.8144251956837252 Time :  14860
accuracy train: 0.996768 val: 0.974545 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({1: 3826, 0: 2300, 2: 1565})

Epoch :  54 loss training:  1.4596741615441715 Time :  14934
accuracy train: 0.996970 val: 0.976364 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({0: 3824, 1: 2286, 2: 1581})

Epoch :  55 loss training:  1.6413835594357806 Time :  15009
accuracy train: 0.997172 val: 0.970909 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({0: 3824, 1: 2287, 2: 1580})

Epoch :  56 loss training:  1.5795846341752622 Time :  15086
accuracy train: 0.996768 val: 0.969091 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({0: 3823, 2: 2287, 1: 1581})

Epoch :  57 loss training:  1.4184161382872844 Time :  15151
accuracy train: 0.996970 val: 0.972727 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({0: 3821, 1: 2288, 2: 1582})

Epoch :  58 loss training:  1.5398122534388676 Time :  15222
accuracy train: 0.996970 val: 0.976364 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({0: 3820, 1: 2289, 2: 1582})

Epoch :  59 loss training:  1.470146921237756 Time :  15293
accuracy train: 0.996768 val: 0.972727 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({0: 3822, 1: 2289, 2: 1580})

Epoch :  60 loss training:  1.3009536509853206 Time :  15376
accuracy train: 0.997172 val: 0.976364 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({0: 3822, 1: 2288, 2: 1581})

Epoch :  61 loss training:  1.5649749072035775 Time :  15466
accuracy train: 0.996970 val: 0.976364 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({0: 3822, 1: 2286, 2: 1583})

Epoch :  62 loss training:  1.6446561762786587 Time :  15555
accuracy train: 0.997172 val: 0.976364 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 36 test accuracy : 0.970776
Counter({0: 3823, 1: 2286, 2: 1582})

Epoch :  63 loss training:  1.3767728589191393 Time :  15632
accuracy train: 0.997172 val: 0.978182 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({0: 3823, 1: 2286, 2: 1582})

Epoch :  64 loss training:  1.7126128749805503 Time :  15710
accuracy train: 0.996768 val: 0.974545 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({0: 3825, 1: 2285, 2: 1581})

Epoch :  65 loss training:  1.6200165636746533 Time :  15795
accuracy train: 0.996364 val: 0.974545 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({0: 3825, 1: 2283, 2: 1583})

Epoch :  66 loss training:  1.6382974622283655 Time :  15879
accuracy train: 0.996566 val: 0.976364 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({0: 3826, 1: 2283, 2: 1582})

Epoch :  67 loss training:  1.3819408329236467 Time :  15951
accuracy train: 0.997172 val: 0.976364 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({1: 3827, 0: 2282, 2: 1582})

Epoch :  68 loss training:  1.6229722001626214 Time :  16040
accuracy train: 0.997172 val: 0.976364 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({0: 3826, 1: 2280, 2: 1585})

Epoch :  69 loss training:  1.520513739757007 Time :  16123
accuracy train: 0.996970 val: 0.976364 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({0: 3827, 1: 2282, 2: 1582})

Epoch :  70 loss training:  1.5127544838633185 Time :  16204
accuracy train: 0.996970 val: 0.974545 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({0: 3827, 1: 2281, 2: 1583})

Epoch :  71 loss training:  1.3571882325159095 Time :  16276
accuracy train: 0.997172 val: 0.972727 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({0: 3826, 1: 2282, 2: 1583})

Epoch :  72 loss training:  1.3488652199230273 Time :  16351
accuracy train: 0.996566 val: 0.974545 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({0: 3827, 1: 2277, 2: 1587})

Epoch :  73 loss training:  1.361496153040207 Time :  16437
accuracy train: 0.996970 val: 0.974545 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({1: 3828, 0: 2277, 2: 1586})

Epoch :  74 loss training:  1.318135097359118 Time :  16525
accuracy train: 0.997172 val: 0.974545 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({0: 3828, 1: 2280, 2: 1583})

Epoch :  75 loss training:  1.5024769060455583 Time :  16597
accuracy train: 0.996970 val: 0.972727 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({1: 3828, 0: 2279, 2: 1584})

Epoch :  76 loss training:  1.4088292736023504 Time :  16667
accuracy train: 0.997172 val: 0.976364 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({1: 3827, 2: 2280, 0: 1584})

Epoch :  77 loss training:  1.2390107233823073 Time :  16750
accuracy train: 0.996970 val: 0.976364 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({0: 3827, 1: 2281, 2: 1583})

Epoch :  78 loss training:  1.3617413975080126 Time :  16825
accuracy train: 0.996970 val: 0.976364 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({0: 3827, 1: 2281, 2: 1583})

Epoch :  79 loss training:  1.4877304585734237 Time :  16906
accuracy train: 0.996970 val: 0.976364 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({0: 3827, 1: 2282, 2: 1582})

Epoch :  80 loss training:  1.5010579509012132 Time :  16997
accuracy train: 0.996970 val: 0.970909 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({0: 3832, 1: 2284, 2: 1575})

Epoch :  81 loss training:  1.309608496596411 Time :  17076
accuracy train: 0.996768 val: 0.972727 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({0: 3831, 2: 2287, 1: 1573})

Epoch :  82 loss training:  1.4508346502934728 Time :  17143
accuracy train: 0.996970 val: 0.972727 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({1: 3831, 0: 2287, 2: 1573})

Epoch :  83 loss training:  1.377430266392821 Time :  17236
accuracy train: 0.997172 val: 0.970909 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({0: 3831, 1: 2287, 2: 1573})

Epoch :  84 loss training:  1.1907487020712324 Time :  17311
accuracy train: 0.996768 val: 0.972727 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({0: 3830, 2: 2287, 1: 1574})

Epoch :  85 loss training:  1.3029345470399676 Time :  17391
accuracy train: 0.996970 val: 0.974545 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({1: 3830, 0: 2285, 2: 1576})

Epoch :  86 loss training:  1.9675615369208117 Time :  17454
accuracy train: 0.997172 val: 0.974545 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({0: 3829, 1: 2282, 2: 1580})

Epoch :  87 loss training:  1.4355515538463806 Time :  17529
accuracy train: 0.996970 val: 0.972727 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({0: 3824, 2: 2279, 1: 1588})

Epoch :  88 loss training:  1.501515444866527 Time :  17600
accuracy train: 0.996768 val: 0.970909 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({0: 3827, 1: 2280, 2: 1584})

Epoch :  89 loss training:  1.2285285154412122 Time :  17693
accuracy train: 0.996768 val: 0.970909 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({0: 3827, 1: 2280, 2: 1584})

Epoch :  90 loss training:  1.2978569473398238 Time :  17773
accuracy train: 0.996970 val: 0.972727 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({0: 3827, 1: 2280, 2: 1584})

Epoch :  91 loss training:  1.4175330705220404 Time :  17855
accuracy train: 0.997374 val: 0.967273 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({0: 3827, 1: 2281, 2: 1583})

Epoch :  92 loss training:  1.256964275311475 Time :  17933
accuracy train: 0.996566 val: 0.974545 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({0: 3827, 2: 2279, 1: 1585})

Epoch :  93 loss training:  1.1972534919150348 Time :  18009
accuracy train: 0.996970 val: 0.972727 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({0: 3827, 1: 2277, 2: 1587})

Epoch :  94 loss training:  1.2100642251880345 Time :  18088
accuracy train: 0.996970 val: 0.970909 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 63 test accuracy : 0.971689
Counter({0: 3829, 1: 2276, 2: 1586})

========================================================================================================================================================================================================
max acc epoch :  63
max validation accuracy :  0.9781818181818182
test accuracy :  0.971689497716895
last test_accuracy :  0.9689497716894977
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=729, weight_decay=1e-07)
device :  cuda:0
Counter({2: 4230, 1: 2303, 0: 1158})

Epoch :  1 loss training:  46.67267772369087 Time :  18320
accuracy train: 0.944456 val: 0.949091 test: 0.930594
max validation accuracy : 0.949091 max acc epoch : 1 test accuracy : 0.930594
Counter({0: 3441, 2: 2728, 1: 1522})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.480181017890573 Time :  18414
accuracy train: 0.964250 val: 0.949091 test: 0.964384
max validation accuracy : 0.949091 max acc epoch : 1 test accuracy : 0.930594
Counter({1: 3617, 0: 2536, 2: 1538})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.55567422322929 Time :  18502
accuracy train: 0.980206 val: 0.954545 test: 0.970320
max validation accuracy : 0.954545 max acc epoch : 3 test accuracy : 0.970320
Counter({0: 3604, 2: 2446, 1: 1641})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.950443969573826 Time :  18595
accuracy train: 0.987679 val: 0.961818 test: 0.970320
max validation accuracy : 0.961818 max acc epoch : 4 test accuracy : 0.970320
Counter({1: 3615, 0: 2421, 2: 1655})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.001150290947407 Time :  18681
accuracy train: 0.986871 val: 0.961818 test: 0.969863
max validation accuracy : 0.961818 max acc epoch : 4 test accuracy : 0.970320
Counter({0: 3607, 2: 2474, 1: 1610})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.60974553716369 Time :  18775
accuracy train: 0.988285 val: 0.974545 test: 0.965297
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({0: 3617, 2: 2454, 1: 1620})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.412507860804908 Time :  18864
accuracy train: 0.991315 val: 0.969091 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({0: 3625, 2: 2445, 1: 1621})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.723187202471308 Time :  18946
accuracy train: 0.991921 val: 0.967273 test: 0.964840
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({0: 3648, 1: 2434, 2: 1609})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.077997514046729 Time :  19028
accuracy train: 0.991921 val: 0.967273 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({2: 3653, 0: 2428, 1: 1610})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.419157723576063 Time :  19112
accuracy train: 0.993941 val: 0.967273 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({2: 3682, 1: 2421, 0: 1588})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  5.283838778414065 Time :  19203
accuracy train: 0.994345 val: 0.963636 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({0: 3709, 2: 2406, 1: 1576})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  5.014260737574659 Time :  19278
accuracy train: 0.993335 val: 0.969091 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({0: 3734, 2: 2388, 1: 1569})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  4.802570099418517 Time :  19357
accuracy train: 0.994345 val: 0.969091 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({1: 3736, 0: 2385, 2: 1570})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  4.3883337657898664 Time :  19435
accuracy train: 0.994547 val: 0.965455 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({0: 3736, 1: 2385, 2: 1570})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  4.1598213037941605 Time :  19513
accuracy train: 0.994951 val: 0.967273 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({1: 3742, 0: 2382, 2: 1567})

Epoch :  16 loss training:  4.8568682873738 Time :  19598
accuracy train: 0.995152 val: 0.967273 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({1: 3743, 0: 2381, 2: 1567})

Epoch :  17 loss training:  4.236995365121402 Time :  19683
accuracy train: 0.995758 val: 0.969091 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({2: 3741, 1: 2379, 0: 1571})

Epoch :  18 loss training:  4.0975271329516545 Time :  19760
accuracy train: 0.995354 val: 0.969091 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({1: 3742, 0: 2375, 2: 1574})

Epoch :  19 loss training:  3.9654492494883016 Time :  19847
accuracy train: 0.996162 val: 0.972727 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({0: 3743, 1: 2376, 2: 1572})

Epoch :  20 loss training:  3.9363447594223544 Time :  19932
accuracy train: 0.995960 val: 0.967273 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({0: 3751, 2: 2372, 1: 1568})

Epoch :  21 loss training:  4.015199355548248 Time :  20012
accuracy train: 0.995758 val: 0.972727 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({0: 3754, 1: 2369, 2: 1568})

Epoch :  22 loss training:  3.8163647230830975 Time :  20090
accuracy train: 0.996162 val: 0.974545 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({1: 3755, 0: 2366, 2: 1570})

Epoch :  23 loss training:  3.3824833820253843 Time :  20181
accuracy train: 0.996162 val: 0.974545 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({0: 3768, 1: 2357, 2: 1566})

Epoch :  24 loss training:  3.3405628094333224 Time :  20258
accuracy train: 0.996162 val: 0.974545 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({0: 3771, 1: 2357, 2: 1563})

Epoch :  25 loss training:  3.137453824572731 Time :  20345
accuracy train: 0.996364 val: 0.969091 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({0: 3777, 1: 2355, 2: 1559})

Epoch :  26 loss training:  3.246146757155657 Time :  20432
accuracy train: 0.996566 val: 0.970909 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({0: 3780, 1: 2352, 2: 1559})

Epoch :  27 loss training:  3.2900608589989133 Time :  20520
accuracy train: 0.996364 val: 0.972727 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({1: 3780, 0: 2345, 2: 1566})

Epoch :  28 loss training:  3.076840334397275 Time :  20603
accuracy train: 0.996364 val: 0.972727 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({0: 3783, 1: 2343, 2: 1565})

Epoch :  29 loss training:  2.876385850686347 Time :  20676
accuracy train: 0.996566 val: 0.972727 test: 0.974429
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({1: 3783, 0: 2339, 2: 1569})

Epoch :  30 loss training:  2.764045130330487 Time :  20746
accuracy train: 0.996768 val: 0.969091 test: 0.974429
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({0: 3789, 1: 2335, 2: 1567})

Epoch :  31 loss training:  2.6520623560645618 Time :  20829
accuracy train: 0.996566 val: 0.969091 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({0: 3794, 1: 2340, 2: 1557})

Epoch :  32 loss training:  2.6035970257944427 Time :  20907
accuracy train: 0.996566 val: 0.967273 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({2: 3788, 1: 2335, 0: 1568})

Epoch :  33 loss training:  2.754261166584911 Time :  20979
accuracy train: 0.996768 val: 0.972727 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({0: 3796, 2: 2332, 1: 1563})

Epoch :  34 loss training:  2.0935001102188835 Time :  21050
accuracy train: 0.996566 val: 0.972727 test: 0.974429
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({1: 3797, 0: 2334, 2: 1560})

Epoch :  35 loss training:  2.543341738113668 Time :  21123
accuracy train: 0.996970 val: 0.969091 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({0: 3802, 1: 2330, 2: 1559})

Epoch :  36 loss training:  2.3552081262751017 Time :  21200
accuracy train: 0.997172 val: 0.965455 test: 0.975342
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({2: 3801, 1: 2324, 0: 1566})

Epoch :  37 loss training:  1.9489806768397102 Time :  21275
accuracy train: 0.996364 val: 0.970909 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.965297
Counter({1: 3803, 0: 2320, 2: 1568})

========================================================================================================================================================================================================
max acc epoch :  6
max validation accuracy :  0.9745454545454545
test accuracy :  0.965296803652968
last test_accuracy :  0.9726027397260274
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.97636 	 test_accuracy : 0.97123 	 max_acc epoch :  40 	 last test_accuracy : 0.97123
k :  1 	 val_accuracy : 0.97273 	 test_accuracy : 0.96438 	 max_acc epoch :  6 	 last test_accuracy : 0.96941
k :  2 	 val_accuracy : 0.97818 	 test_accuracy : 0.97169 	 max_acc epoch :  63 	 last test_accuracy : 0.96895
k :  3 	 val_accuracy : 0.97455 	 test_accuracy : 0.96530 	 max_acc epoch :  6 	 last test_accuracy : 0.97260

avg :  	 val_accuracy : 0.97545 	 test_accuracy : 0.96815 	 last_accuracy : 0.97055
