

date and time :  Thu Jun 10 11:23:44 2021
itr : 0
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.2, early_stop=30, epochs=400, filename='', hidden_dim=100, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=933, weight_decay=0)
device :  cuda:0
Counter({0: 5413, 1: 2506, 2: 1211})

Epoch :  1 loss training:  136.8554379492998 Time :  21
accuracy train: 0.896511 val: 0.897866 test: 0.871984
max validation accuracy : 0.897866 max acc epoch : 1 test accuracy : 0.871984
Counter({1: 3516, 2: 2868, 0: 2746})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  56.69192658364773 Time :  42
accuracy train: 0.927168 val: 0.908537 test: 0.912451
max validation accuracy : 0.908537 max acc epoch : 2 test accuracy : 0.912451
Counter({0: 3620, 1: 2913, 2: 2597})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  41.02108212932944 Time :  63
accuracy train: 0.947493 val: 0.920732 test: 0.919844
max validation accuracy : 0.920732 max acc epoch : 3 test accuracy : 0.919844
Counter({0: 3712, 1: 2913, 2: 2505})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  28.83220626413822 Time :  84
accuracy train: 0.964600 val: 0.939024 test: 0.934630
max validation accuracy : 0.939024 max acc epoch : 4 test accuracy : 0.934630
Counter({0: 3755, 1: 2903, 2: 2472})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  24.362678742036223 Time :  104
accuracy train: 0.971714 val: 0.940549 test: 0.924125
max validation accuracy : 0.940549 max acc epoch : 5 test accuracy : 0.924125
Counter({1: 3771, 2: 2896, 0: 2463})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  21.209484537132084 Time :  126
accuracy train: 0.976457 val: 0.940549 test: 0.939300
max validation accuracy : 0.940549 max acc epoch : 5 test accuracy : 0.924125
Counter({0: 3787, 1: 2932, 2: 2411})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  16.760799983516335 Time :  147
accuracy train: 0.981030 val: 0.949695 test: 0.938132
max validation accuracy : 0.949695 max acc epoch : 7 test accuracy : 0.938132
Counter({1: 3813, 0: 2939, 2: 2378})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  15.727868927642703 Time :  170
accuracy train: 0.984587 val: 0.943598 test: 0.940078
max validation accuracy : 0.949695 max acc epoch : 7 test accuracy : 0.938132
Counter({2: 3817, 1: 2944, 0: 2369})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  14.828483222052455 Time :  195
accuracy train: 0.985603 val: 0.951220 test: 0.933463
max validation accuracy : 0.951220 max acc epoch : 9 test accuracy : 0.933463
Counter({1: 3841, 0: 2931, 2: 2358})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  13.133192312903702 Time :  218
accuracy train: 0.986789 val: 0.946646 test: 0.937743
max validation accuracy : 0.951220 max acc epoch : 9 test accuracy : 0.933463
Counter({2: 3846, 0: 2934, 1: 2350})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  12.7178191896528 Time :  241
accuracy train: 0.987805 val: 0.948171 test: 0.938132
max validation accuracy : 0.951220 max acc epoch : 9 test accuracy : 0.933463
Counter({0: 3846, 1: 2936, 2: 2348})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  11.763825540430844 Time :  262
accuracy train: 0.989160 val: 0.949695 test: 0.940078
max validation accuracy : 0.951220 max acc epoch : 9 test accuracy : 0.933463
Counter({0: 3850, 1: 2934, 2: 2346})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  10.46611882885918 Time :  294
accuracy train: 0.988652 val: 0.949695 test: 0.939689
max validation accuracy : 0.951220 max acc epoch : 9 test accuracy : 0.933463
Counter({0: 3854, 1: 2932, 2: 2344})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  10.549054465256631 Time :  320
accuracy train: 0.988652 val: 0.952744 test: 0.940078
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.940078
Counter({1: 3854, 2: 2931, 0: 2345})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  10.423891444690526 Time :  342
accuracy train: 0.990346 val: 0.951220 test: 0.938521
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.940078
Counter({1: 3855, 0: 2930, 2: 2345})

Epoch :  16 loss training:  9.793499983847141 Time :  368
accuracy train: 0.991701 val: 0.951220 test: 0.941634
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.940078
Counter({2: 3856, 0: 2931, 1: 2343})

Epoch :  17 loss training:  9.19490079768002 Time :  394
accuracy train: 0.991531 val: 0.952744 test: 0.941634
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.940078
Counter({1: 3857, 0: 2930, 2: 2343})

Epoch :  18 loss training:  9.59232010692358 Time :  423
accuracy train: 0.991192 val: 0.949695 test: 0.942802
max validation accuracy : 0.952744 max acc epoch : 14 test accuracy : 0.940078
Counter({0: 3858, 2: 2931, 1: 2341})

Epoch :  19 loss training:  9.527145395521075 Time :  451
accuracy train: 0.992547 val: 0.954268 test: 0.941634
max validation accuracy : 0.954268 max acc epoch : 19 test accuracy : 0.941634
Counter({0: 3858, 1: 2933, 2: 2339})

Epoch :  20 loss training:  8.905115890782326 Time :  485
accuracy train: 0.991192 val: 0.948171 test: 0.940078
max validation accuracy : 0.954268 max acc epoch : 19 test accuracy : 0.941634
Counter({1: 3859, 2: 2932, 0: 2339})

Epoch :  21 loss training:  8.36696375766769 Time :  521
accuracy train: 0.992547 val: 0.955793 test: 0.942802
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({1: 3862, 0: 2931, 2: 2337})

Epoch :  22 loss training:  8.289776192046702 Time :  547
accuracy train: 0.992547 val: 0.951220 test: 0.940856
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({2: 3865, 1: 2930, 0: 2335})

Epoch :  23 loss training:  8.359067710116506 Time :  571
accuracy train: 0.992886 val: 0.949695 test: 0.940856
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({0: 3875, 1: 2927, 2: 2328})

Epoch :  24 loss training:  7.783451513852924 Time :  596
accuracy train: 0.993394 val: 0.948171 test: 0.942802
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({1: 3876, 0: 2927, 2: 2327})

Epoch :  25 loss training:  7.699512041173875 Time :  621
accuracy train: 0.994411 val: 0.951220 test: 0.941634
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({2: 3884, 0: 2924, 1: 2322})

Epoch :  26 loss training:  6.824252313468605 Time :  652
accuracy train: 0.994072 val: 0.952744 test: 0.944358
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({0: 3883, 1: 2928, 2: 2319})

Epoch :  27 loss training:  7.146043881308287 Time :  711
accuracy train: 0.994919 val: 0.951220 test: 0.943191
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({0: 3887, 1: 2929, 2: 2314})

Epoch :  28 loss training:  7.034305999986827 Time :  765
accuracy train: 0.994241 val: 0.948171 test: 0.945525
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({0: 3888, 2: 2929, 1: 2313})

Epoch :  29 loss training:  7.021297606639564 Time :  823
accuracy train: 0.994749 val: 0.951220 test: 0.944358
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({0: 3888, 1: 2930, 2: 2312})

Epoch :  30 loss training:  6.013206381816417 Time :  879
accuracy train: 0.994580 val: 0.951220 test: 0.944747
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({1: 3888, 2: 2930, 0: 2312})

Epoch :  31 loss training:  5.824109960347414 Time :  904
accuracy train: 0.994919 val: 0.952744 test: 0.944747
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({0: 3890, 2: 2934, 1: 2306})

Epoch :  32 loss training:  6.105878171510994 Time :  930
accuracy train: 0.994411 val: 0.951220 test: 0.946304
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({1: 3890, 2: 2934, 0: 2306})

Epoch :  33 loss training:  5.55021758377552 Time :  960
accuracy train: 0.994411 val: 0.949695 test: 0.943580
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({0: 3888, 2: 2938, 1: 2304})

Epoch :  34 loss training:  5.374109259340912 Time :  987
accuracy train: 0.995088 val: 0.949695 test: 0.945525
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({0: 3889, 2: 2938, 1: 2303})

Epoch :  35 loss training:  5.2841383018530905 Time :  1010
accuracy train: 0.995257 val: 0.948171 test: 0.943191
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({1: 3890, 0: 2936, 2: 2304})

Epoch :  36 loss training:  5.231802974129096 Time :  1034
accuracy train: 0.995257 val: 0.949695 test: 0.942023
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({1: 3890, 0: 2938, 2: 2302})

Epoch :  37 loss training:  5.0574702974408865 Time :  1070
accuracy train: 0.995766 val: 0.952744 test: 0.943580
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({0: 3892, 1: 2935, 2: 2303})

Epoch :  38 loss training:  4.67282045178581 Time :  1096
accuracy train: 0.996104 val: 0.951220 test: 0.946693
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({2: 3893, 0: 2936, 1: 2301})

Epoch :  39 loss training:  5.113521112827584 Time :  1123
accuracy train: 0.996443 val: 0.948171 test: 0.944358
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({0: 3896, 2: 2933, 1: 2301})

Epoch :  40 loss training:  4.177298531634733 Time :  1147
accuracy train: 0.996443 val: 0.949695 test: 0.946693
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({1: 3896, 0: 2934, 2: 2300})

Epoch :  41 loss training:  4.237920229206793 Time :  1177
accuracy train: 0.996443 val: 0.946646 test: 0.944747
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({1: 3896, 0: 2933, 2: 2301})

Epoch :  42 loss training:  4.2795570032903925 Time :  1209
accuracy train: 0.996443 val: 0.949695 test: 0.947082
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({1: 3897, 0: 2932, 2: 2301})

Epoch :  43 loss training:  4.3058174648322165 Time :  1235
accuracy train: 0.997121 val: 0.949695 test: 0.948249
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({1: 3896, 0: 2931, 2: 2303})

Epoch :  44 loss training:  4.072847700328566 Time :  1265
accuracy train: 0.996443 val: 0.948171 test: 0.948638
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({0: 3896, 2: 2931, 1: 2303})

Epoch :  45 loss training:  3.662211126415059 Time :  1289
accuracy train: 0.996443 val: 0.951220 test: 0.947860
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({1: 3897, 0: 2930, 2: 2303})

Epoch :  46 loss training:  3.8526850185589865 Time :  1313
accuracy train: 0.996443 val: 0.946646 test: 0.945914
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({0: 3899, 2: 2928, 1: 2303})

Epoch :  47 loss training:  3.7121161541435868 Time :  1339
accuracy train: 0.996612 val: 0.948171 test: 0.945525
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({1: 3900, 2: 2924, 0: 2306})

Epoch :  48 loss training:  3.8405432539293543 Time :  1363
accuracy train: 0.996104 val: 0.954268 test: 0.945525
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({1: 3905, 0: 2918, 2: 2307})

Epoch :  49 loss training:  3.5104565994115546 Time :  1387
accuracy train: 0.996951 val: 0.948171 test: 0.946304
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({2: 3905, 0: 2917, 1: 2308})

Epoch :  50 loss training:  3.260217160684988 Time :  1411
accuracy train: 0.996443 val: 0.948171 test: 0.943191
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({0: 3904, 2: 2918, 1: 2308})

Epoch :  51 loss training:  3.6023861415451393 Time :  1441
accuracy train: 0.996951 val: 0.951220 test: 0.946304
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({2: 3904, 1: 2919, 0: 2307})

Epoch :  52 loss training:  3.2107923809671775 Time :  1467
accuracy train: 0.996612 val: 0.948171 test: 0.944747
max validation accuracy : 0.955793 max acc epoch : 21 test accuracy : 0.942802
Counter({0: 3905, 2: 2921, 1: 2304})

========================================================================================================================================================================================================
max acc epoch :  21
max validation accuracy :  0.9557926829268293
test accuracy :  0.9428015564202334
last test_accuracy :  0.9447470817120622
max gap 5
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.2, early_stop=30, epochs=400, filename='', hidden_dim=100, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=933, weight_decay=0)
device :  cuda:0
slurmstepd: error: *** JOB 37015 ON cl-gpusrv1 CANCELLED AT 2021-06-10T11:48:56 ***
