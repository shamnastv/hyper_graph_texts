

date and time :  Fri Jun 11 11:58:16 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=402, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  41.6913792565465 Time :  19
accuracy train: 0.947889 val: 0.938182 test: 0.945662
max validation accuracy : 0.938182 max acc epoch : 1 test accuracy : 0.945662
Counter({1: 3971, 0: 3720})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  20.285069214180112 Time :  40
accuracy train: 0.973945 val: 0.974545 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.968037
Counter({1: 3934, 0: 3757})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.753311816602945 Time :  58
accuracy train: 0.973339 val: 0.967273 test: 0.957534
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.968037
Counter({1: 3950, 0: 3741})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.185626038815826 Time :  76
accuracy train: 0.978388 val: 0.972727 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.968037
Counter({1: 3937, 0: 3754})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.764186458254699 Time :  107
accuracy train: 0.980206 val: 0.965455 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.968037
Counter({0: 3937, 1: 3754})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.474199048709124 Time :  127
accuracy train: 0.989497 val: 0.972727 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.968037
Counter({0: 3911, 1: 3780})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.809490520041436 Time :  147
accuracy train: 0.989497 val: 0.972727 test: 0.974886
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.968037
Counter({1: 3895, 0: 3796})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.383051012409851 Time :  167
accuracy train: 0.991517 val: 0.970909 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.968037
Counter({1: 3876, 0: 3815})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.450696364045143 Time :  187
accuracy train: 0.990911 val: 0.974545 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.968037
Counter({1: 3870, 0: 3821})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.579044062294997 Time :  205
accuracy train: 0.992729 val: 0.974545 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.968037
Counter({1: 3863, 0: 3828})

Epoch :  11 loss training:  5.2495386796072125 Time :  227
accuracy train: 0.993537 val: 0.972727 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.968037
Counter({1: 3851, 0: 3840})

Epoch :  12 loss training:  5.266557903261855 Time :  250
accuracy train: 0.992729 val: 0.974545 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.968037
Counter({0: 3849, 1: 3842})

Epoch :  13 loss training:  4.8722107441863045 Time :  273
accuracy train: 0.993537 val: 0.976364 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 13 test accuracy : 0.972146
Counter({0: 3867, 1: 3824})

Epoch :  14 loss training:  4.985306135960855 Time :  293
accuracy train: 0.993941 val: 0.976364 test: 0.974429
max validation accuracy : 0.976364 max acc epoch : 13 test accuracy : 0.972146
Counter({0: 3869, 1: 3822})

Epoch :  15 loss training:  4.160266286460683 Time :  315
accuracy train: 0.993739 val: 0.978182 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3877, 1: 3814})

Epoch :  16 loss training:  3.7608264420414343 Time :  336
accuracy train: 0.994345 val: 0.974545 test: 0.975799
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3887, 1: 3804})

Epoch :  17 loss training:  3.7690977248130366 Time :  366
accuracy train: 0.995152 val: 0.976364 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3891, 1: 3800})

Epoch :  18 loss training:  3.4726100800326094 Time :  386
accuracy train: 0.995556 val: 0.976364 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3892, 1: 3799})

Epoch :  19 loss training:  3.5112298685126007 Time :  405
accuracy train: 0.995152 val: 0.974545 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3898, 1: 3793})

Epoch :  20 loss training:  3.1585458429472055 Time :  426
accuracy train: 0.996162 val: 0.976364 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3903, 1: 3788})

Epoch :  21 loss training:  2.971381410199683 Time :  445
accuracy train: 0.995960 val: 0.978182 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3912, 1: 3779})

Epoch :  22 loss training:  2.7922105015604757 Time :  464
accuracy train: 0.995758 val: 0.974545 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3916, 1: 3775})

Epoch :  23 loss training:  2.9123633126728237 Time :  486
accuracy train: 0.995960 val: 0.976364 test: 0.976256
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3916, 1: 3775})

Epoch :  24 loss training:  2.6032881478313357 Time :  507
accuracy train: 0.996364 val: 0.974545 test: 0.975799
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3917, 1: 3774})

Epoch :  25 loss training:  2.31760741857579 Time :  534
accuracy train: 0.996162 val: 0.974545 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3921, 1: 3770})

Epoch :  26 loss training:  2.456874308496481 Time :  556
accuracy train: 0.996162 val: 0.974545 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3922, 1: 3769})

Epoch :  27 loss training:  2.527711995615391 Time :  582
accuracy train: 0.996364 val: 0.970909 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3921, 1: 3770})

Epoch :  28 loss training:  2.184511060069781 Time :  609
accuracy train: 0.996768 val: 0.972727 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3924, 1: 3767})

Epoch :  29 loss training:  2.845314195728861 Time :  634
accuracy train: 0.996162 val: 0.972727 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3923, 1: 3768})

Epoch :  30 loss training:  2.871601675520651 Time :  654
accuracy train: 0.996566 val: 0.972727 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3928, 1: 3763})

Epoch :  31 loss training:  1.883133545750752 Time :  674
accuracy train: 0.996768 val: 0.972727 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3928, 1: 3763})

Epoch :  32 loss training:  2.359900799463503 Time :  694
accuracy train: 0.996364 val: 0.974545 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3926, 1: 3765})

Epoch :  33 loss training:  1.9806776998739224 Time :  713
accuracy train: 0.996768 val: 0.974545 test: 0.977169
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3927, 1: 3764})

Epoch :  34 loss training:  1.7184226911631413 Time :  733
accuracy train: 0.996364 val: 0.970909 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({1: 3927, 0: 3764})

Epoch :  35 loss training:  1.7320312858646503 Time :  762
accuracy train: 0.996970 val: 0.970909 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3932, 1: 3759})

Epoch :  36 loss training:  1.7656102435139474 Time :  781
accuracy train: 0.997172 val: 0.969091 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3932, 1: 3759})

Epoch :  37 loss training:  1.8086523084784858 Time :  799
accuracy train: 0.997172 val: 0.969091 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3932, 1: 3759})

Epoch :  38 loss training:  1.7273101789178327 Time :  818
accuracy train: 0.996970 val: 0.972727 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3932, 1: 3759})

Epoch :  39 loss training:  1.7114516598521732 Time :  835
accuracy train: 0.997374 val: 0.970909 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3932, 1: 3759})

Epoch :  40 loss training:  1.6669598840671824 Time :  857
accuracy train: 0.997576 val: 0.972727 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3932, 1: 3759})

Epoch :  41 loss training:  1.32376135935192 Time :  883
accuracy train: 0.997374 val: 0.972727 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({1: 3932, 0: 3759})

Epoch :  42 loss training:  1.427253637513786 Time :  903
accuracy train: 0.997576 val: 0.970909 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3932, 1: 3759})

Epoch :  43 loss training:  1.5336863480770262 Time :  923
accuracy train: 0.997374 val: 0.967273 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({1: 3933, 0: 3758})

Epoch :  44 loss training:  1.6013644188351464 Time :  942
accuracy train: 0.997172 val: 0.967273 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3933, 1: 3758})

Epoch :  45 loss training:  1.5613438999134814 Time :  961
accuracy train: 0.996970 val: 0.972727 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3933, 1: 3758})

Epoch :  46 loss training:  1.671423567517195 Time :  982
accuracy train: 0.997172 val: 0.976364 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974886
Counter({0: 3933, 1: 3758})

========================================================================================================================================================================================================
max acc epoch :  15
max validation accuracy :  0.9781818181818182
test accuracy :  0.9748858447488584
last test_accuracy :  0.9726027397260274
second best val :  0.9763636363636363
second best test :  0.9721461187214612
max gap 11
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=402, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  41.66610861197114 Time :  1007
accuracy train: 0.948293 val: 0.938182 test: 0.945205
max validation accuracy : 0.938182 max acc epoch : 1 test accuracy : 0.945205
Counter({1: 3964, 0: 3727})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  20.304699739441276 Time :  1026
accuracy train: 0.973339 val: 0.974545 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.968037
Counter({1: 3939, 0: 3752})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.665131656453013 Time :  1044
accuracy train: 0.973339 val: 0.967273 test: 0.960274
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.968037
Counter({1: 3941, 0: 3750})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.744991444982588 Time :  1065
accuracy train: 0.977984 val: 0.972727 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.968037
Counter({1: 3921, 0: 3770})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.66764919203706 Time :  1083
accuracy train: 0.980408 val: 0.963636 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.968037
Counter({1: 3919, 0: 3772})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.466447110753506 Time :  1106
accuracy train: 0.987275 val: 0.969091 test: 0.965753
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.968037
Counter({1: 3884, 0: 3807})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.645583514822647 Time :  1125
accuracy train: 0.990103 val: 0.974545 test: 0.974429
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.968037
Counter({1: 3871, 0: 3820})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.324226164724678 Time :  1145
accuracy train: 0.991921 val: 0.970909 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.968037
Counter({1: 3859, 0: 3832})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.290924468659796 Time :  1172
accuracy train: 0.990911 val: 0.974545 test: 0.976256
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.968037
Counter({1: 3857, 0: 3834})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.44259700528346 Time :  1192
accuracy train: 0.992123 val: 0.974545 test: 0.974429
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.968037
Counter({1: 3850, 0: 3841})

Epoch :  11 loss training:  5.164765132940374 Time :  1215
accuracy train: 0.992931 val: 0.974545 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.968037
Counter({0: 3858, 1: 3833})

Epoch :  12 loss training:  4.902631797245704 Time :  1237
accuracy train: 0.992729 val: 0.976364 test: 0.973973
max validation accuracy : 0.976364 max acc epoch : 12 test accuracy : 0.973973
Counter({0: 3859, 1: 3832})

Epoch :  13 loss training:  4.910110448137857 Time :  1256
accuracy train: 0.994345 val: 0.974545 test: 0.974886
max validation accuracy : 0.976364 max acc epoch : 12 test accuracy : 0.973973
Counter({0: 3873, 1: 3818})

Epoch :  14 loss training:  4.790125193889253 Time :  1275
accuracy train: 0.994143 val: 0.974545 test: 0.975342
max validation accuracy : 0.976364 max acc epoch : 12 test accuracy : 0.973973
Counter({0: 3877, 1: 3814})

Epoch :  15 loss training:  4.160929473815486 Time :  1295
accuracy train: 0.993941 val: 0.978182 test: 0.976256
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3883, 1: 3808})

Epoch :  16 loss training:  3.732474656426348 Time :  1315
accuracy train: 0.994143 val: 0.974545 test: 0.975799
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3893, 1: 3798})

Epoch :  17 loss training:  3.7578500569798052 Time :  1337
accuracy train: 0.995354 val: 0.976364 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3898, 1: 3793})

Epoch :  18 loss training:  3.5022899591131136 Time :  1365
accuracy train: 0.995758 val: 0.974545 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3899, 1: 3792})

Epoch :  19 loss training:  3.234556218551006 Time :  1386
accuracy train: 0.995354 val: 0.974545 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3905, 1: 3786})

Epoch :  20 loss training:  2.9648874430567957 Time :  1408
accuracy train: 0.996364 val: 0.976364 test: 0.975799
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3910, 1: 3781})

Epoch :  21 loss training:  2.859647302655503 Time :  1428
accuracy train: 0.996364 val: 0.978182 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3916, 1: 3775})

Epoch :  22 loss training:  2.7226534197106957 Time :  1448
accuracy train: 0.995960 val: 0.972727 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3922, 1: 3769})

Epoch :  23 loss training:  2.9113659149734303 Time :  1469
accuracy train: 0.995556 val: 0.974545 test: 0.976712
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3922, 1: 3769})

Epoch :  24 loss training:  2.6251757088466547 Time :  1491
accuracy train: 0.996364 val: 0.970909 test: 0.975799
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3923, 1: 3768})

Epoch :  25 loss training:  2.232101875299122 Time :  1511
accuracy train: 0.995758 val: 0.978182 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3923, 1: 3768})

Epoch :  26 loss training:  2.430153269902803 Time :  1529
accuracy train: 0.996162 val: 0.974545 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3924, 1: 3767})

Epoch :  27 loss training:  2.429188616020838 Time :  1549
accuracy train: 0.996566 val: 0.972727 test: 0.976712
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3924, 1: 3767})

Epoch :  28 loss training:  2.0486509281618055 Time :  1570
accuracy train: 0.996566 val: 0.972727 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3926, 1: 3765})

Epoch :  29 loss training:  2.776077413902385 Time :  1591
accuracy train: 0.996566 val: 0.972727 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3927, 1: 3764})

Epoch :  30 loss training:  2.922193755483022 Time :  1614
accuracy train: 0.996970 val: 0.970909 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({1: 3929, 0: 3762})

Epoch :  31 loss training:  1.9080849430756643 Time :  1637
accuracy train: 0.996970 val: 0.972727 test: 0.977626
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3928, 1: 3763})

Epoch :  32 loss training:  2.467215076001594 Time :  1656
accuracy train: 0.996364 val: 0.972727 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3929, 1: 3762})

Epoch :  33 loss training:  1.9799940065277042 Time :  1677
accuracy train: 0.996566 val: 0.970909 test: 0.976712
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3930, 1: 3761})

Epoch :  34 loss training:  1.6943530013377313 Time :  1697
accuracy train: 0.996566 val: 0.969091 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3930, 1: 3761})

Epoch :  35 loss training:  1.6773547831107862 Time :  1715
accuracy train: 0.997374 val: 0.969091 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3932, 1: 3759})

Epoch :  36 loss training:  1.7014936610648874 Time :  1732
accuracy train: 0.996970 val: 0.970909 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3931, 1: 3760})

Epoch :  37 loss training:  1.7965252041831263 Time :  1761
accuracy train: 0.997374 val: 0.970909 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3931, 1: 3760})

Epoch :  38 loss training:  1.5970460200769594 Time :  1790
accuracy train: 0.997172 val: 0.972727 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3931, 1: 3760})

Epoch :  39 loss training:  1.7558713895850815 Time :  1810
accuracy train: 0.997576 val: 0.972727 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3931, 1: 3760})

Epoch :  40 loss training:  1.614275148640445 Time :  1829
accuracy train: 0.997576 val: 0.974545 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3931, 1: 3760})

Epoch :  41 loss training:  1.3752574546451797 Time :  1851
accuracy train: 0.997172 val: 0.970909 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3931, 1: 3760})

Epoch :  42 loss training:  1.3738448527437868 Time :  1871
accuracy train: 0.997778 val: 0.972727 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3931, 1: 3760})

Epoch :  43 loss training:  1.4774850899993908 Time :  1902
accuracy train: 0.997576 val: 0.970909 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3931, 1: 3760})

Epoch :  44 loss training:  1.5339706836093683 Time :  1920
accuracy train: 0.997778 val: 0.970909 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3931, 1: 3760})

Epoch :  45 loss training:  1.4994352361100027 Time :  1938
accuracy train: 0.996970 val: 0.972727 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({1: 3931, 0: 3760})

Epoch :  46 loss training:  1.6266310189166688 Time :  1956
accuracy train: 0.997172 val: 0.974545 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.976256
Counter({0: 3932, 1: 3759})

========================================================================================================================================================================================================
max acc epoch :  15
max validation accuracy :  0.9781818181818182
test accuracy :  0.9762557077625571
last test_accuracy :  0.971689497716895
second best val :  0.9763636363636363
second best test :  0.9739726027397261
max gap 10
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=402, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  41.68550566211343 Time :  1979
accuracy train: 0.946475 val: 0.934545 test: 0.942466
max validation accuracy : 0.934545 max acc epoch : 1 test accuracy : 0.942466
Counter({1: 3957, 0: 3734})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  20.292168935760856 Time :  1997
accuracy train: 0.973743 val: 0.972727 test: 0.968037
max validation accuracy : 0.972727 max acc epoch : 2 test accuracy : 0.968037
Counter({1: 3933, 0: 3758})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.74502328503877 Time :  2019
accuracy train: 0.971723 val: 0.967273 test: 0.960274
max validation accuracy : 0.972727 max acc epoch : 2 test accuracy : 0.968037
Counter({1: 3930, 0: 3761})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.602362154051661 Time :  2038
accuracy train: 0.979196 val: 0.972727 test: 0.972146
max validation accuracy : 0.972727 max acc epoch : 2 test accuracy : 0.968037
Counter({1: 3912, 0: 3779})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.137007129669655 Time :  2055
accuracy train: 0.981418 val: 0.967273 test: 0.972146
max validation accuracy : 0.972727 max acc epoch : 2 test accuracy : 0.968037
Counter({1: 3909, 0: 3782})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.377710007596761 Time :  2074
accuracy train: 0.988285 val: 0.970909 test: 0.963470
max validation accuracy : 0.972727 max acc epoch : 2 test accuracy : 0.968037
Counter({1: 3871, 0: 3820})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.590191591763869 Time :  2095
accuracy train: 0.989497 val: 0.974545 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.973973
Counter({1: 3856, 0: 3835})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.224489824613556 Time :  2114
accuracy train: 0.992123 val: 0.974545 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 7 test accuracy : 0.973973
Counter({0: 3847, 1: 3844})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.268200080899987 Time :  2134
accuracy train: 0.992123 val: 0.976364 test: 0.973973
max validation accuracy : 0.976364 max acc epoch : 9 test accuracy : 0.973973
Counter({0: 3852, 1: 3839})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.311335266334936 Time :  2161
accuracy train: 0.992325 val: 0.976364 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 9 test accuracy : 0.973973
Counter({0: 3857, 1: 3834})

Epoch :  11 loss training:  4.993387617403641 Time :  2180
accuracy train: 0.993133 val: 0.974545 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 9 test accuracy : 0.973973
Counter({0: 3861, 1: 3830})

Epoch :  12 loss training:  4.924278263468295 Time :  2202
accuracy train: 0.992123 val: 0.976364 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 9 test accuracy : 0.973973
Counter({0: 3862, 1: 3829})

Epoch :  13 loss training:  4.717673311184626 Time :  2226
accuracy train: 0.994345 val: 0.978182 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.971689
Counter({0: 3877, 1: 3814})

Epoch :  14 loss training:  4.73148831538856 Time :  2250
accuracy train: 0.993739 val: 0.978182 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.971689
Counter({0: 3877, 1: 3814})

Epoch :  15 loss training:  4.160183327738196 Time :  2279
accuracy train: 0.993739 val: 0.978182 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.971689
Counter({0: 3884, 1: 3807})

Epoch :  16 loss training:  3.7380476963007823 Time :  2311
accuracy train: 0.994143 val: 0.974545 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.971689
Counter({0: 3895, 1: 3796})

Epoch :  17 loss training:  3.771186282276176 Time :  2337
accuracy train: 0.995354 val: 0.978182 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.971689
Counter({0: 3905, 1: 3786})

Epoch :  18 loss training:  3.348604222526774 Time :  2362
accuracy train: 0.995354 val: 0.974545 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.971689
Counter({0: 3908, 1: 3783})

Epoch :  19 loss training:  3.270803695661016 Time :  2385
accuracy train: 0.994951 val: 0.978182 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.971689
Counter({0: 3911, 1: 3780})

Epoch :  20 loss training:  3.0205778250674484 Time :  2411
accuracy train: 0.996364 val: 0.978182 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.971689
Counter({0: 3910, 1: 3781})

Epoch :  21 loss training:  2.8245933353318833 Time :  2444
accuracy train: 0.995960 val: 0.980000 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3914, 1: 3777})

Epoch :  22 loss training:  2.7746897907927632 Time :  2469
accuracy train: 0.995758 val: 0.976364 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3922, 1: 3769})

Epoch :  23 loss training:  2.90712530631572 Time :  2494
accuracy train: 0.995758 val: 0.972727 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3922, 1: 3769})

Epoch :  24 loss training:  2.7447119366843253 Time :  2520
accuracy train: 0.996364 val: 0.972727 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3923, 1: 3768})

Epoch :  25 loss training:  2.1961401899461634 Time :  2545
accuracy train: 0.995960 val: 0.978182 test: 0.975799
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3925, 1: 3766})

Epoch :  26 loss training:  2.5127404159866273 Time :  2573
accuracy train: 0.995960 val: 0.974545 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3925, 1: 3766})

Epoch :  27 loss training:  2.478734826348955 Time :  2608
accuracy train: 0.996364 val: 0.970909 test: 0.974886
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3924, 1: 3767})

Epoch :  28 loss training:  2.1274367150035687 Time :  2633
accuracy train: 0.996566 val: 0.970909 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3926, 1: 3765})

Epoch :  29 loss training:  2.7669707147870213 Time :  2659
accuracy train: 0.996566 val: 0.972727 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3926, 1: 3765})

Epoch :  30 loss training:  2.678122234501643 Time :  2686
accuracy train: 0.996768 val: 0.974545 test: 0.975342
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3926, 1: 3765})

Epoch :  31 loss training:  1.9370039189816453 Time :  2711
accuracy train: 0.997172 val: 0.974545 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3927, 1: 3764})

Epoch :  32 loss training:  2.3611248467932455 Time :  2738
accuracy train: 0.996162 val: 0.974545 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3927, 1: 3764})

Epoch :  33 loss training:  1.9986983780836454 Time :  2773
accuracy train: 0.996566 val: 0.970909 test: 0.975342
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3927, 1: 3764})

Epoch :  34 loss training:  1.6799921972851735 Time :  2800
accuracy train: 0.996364 val: 0.972727 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3930, 1: 3761})

Epoch :  35 loss training:  1.6915805672470015 Time :  2826
accuracy train: 0.997374 val: 0.976364 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3930, 1: 3761})

Epoch :  36 loss training:  1.7634845997090451 Time :  2853
accuracy train: 0.997172 val: 0.970909 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3928, 1: 3763})

Epoch :  37 loss training:  1.9968562569993082 Time :  2882
accuracy train: 0.997172 val: 0.970909 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3928, 1: 3763})

Epoch :  38 loss training:  1.6786483376927208 Time :  2914
accuracy train: 0.996768 val: 0.972727 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3928, 1: 3763})

Epoch :  39 loss training:  1.6771934866410447 Time :  2957
accuracy train: 0.997576 val: 0.974545 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3930, 1: 3761})

Epoch :  40 loss training:  1.5915650026654475 Time :  2986
accuracy train: 0.997576 val: 0.974545 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3930, 1: 3761})

Epoch :  41 loss training:  1.3857151871197857 Time :  3014
accuracy train: 0.997172 val: 0.969091 test: 0.968950
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3930, 1: 3761})

Epoch :  42 loss training:  1.3235868759948062 Time :  3044
accuracy train: 0.997778 val: 0.970909 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({1: 3930, 0: 3761})

Epoch :  43 loss training:  1.3639939174536266 Time :  3071
accuracy train: 0.997576 val: 0.967273 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3930, 1: 3761})

Epoch :  44 loss training:  1.5199279189982917 Time :  3106
accuracy train: 0.997576 val: 0.969091 test: 0.968037
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({1: 3930, 0: 3761})

Epoch :  45 loss training:  1.4933707232703455 Time :  3147
accuracy train: 0.996970 val: 0.974545 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3930, 1: 3761})

Epoch :  46 loss training:  1.5449045399582246 Time :  3176
accuracy train: 0.997576 val: 0.976364 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3930, 1: 3761})

Epoch :  47 loss training:  1.2596735005135997 Time :  3205
accuracy train: 0.997778 val: 0.974545 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3929, 1: 3762})

Epoch :  48 loss training:  1.4545721496324404 Time :  3234
accuracy train: 0.997576 val: 0.974545 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3929, 1: 3762})

Epoch :  49 loss training:  1.3554335243279638 Time :  3262
accuracy train: 0.997172 val: 0.972727 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3929, 1: 3762})

Epoch :  50 loss training:  1.1681875208851125 Time :  3296
accuracy train: 0.997576 val: 0.970909 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3929, 1: 3762})

Epoch :  51 loss training:  1.4490581967620528 Time :  3338
accuracy train: 0.997172 val: 0.972727 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3929, 1: 3762})

Epoch :  52 loss training:  1.3959630181379907 Time :  3370
accuracy train: 0.997576 val: 0.969091 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.973973
Counter({0: 3929, 1: 3762})

========================================================================================================================================================================================================
max acc epoch :  21
max validation accuracy :  0.98
test accuracy :  0.9739726027397261
last test_accuracy :  0.9744292237442922
second best val :  0.9781818181818182
second best test :  0.971689497716895
max gap 8
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=402, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  41.6868683360517 Time :  3442
accuracy train: 0.948899 val: 0.940000 test: 0.946119
max validation accuracy : 0.940000 max acc epoch : 1 test accuracy : 0.946119
Counter({1: 3964, 0: 3727})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  20.088450333103538 Time :  3473
accuracy train: 0.972531 val: 0.974545 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.969406
Counter({1: 3938, 0: 3753})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.514151536859572 Time :  3519
accuracy train: 0.968693 val: 0.961818 test: 0.961187
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.969406
Counter({1: 3947, 0: 3744})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.792963753454387 Time :  3550
accuracy train: 0.977378 val: 0.969091 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.969406
Counter({1: 3923, 0: 3768})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.117369479150511 Time :  3581
accuracy train: 0.980004 val: 0.965455 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.969406
Counter({1: 3927, 0: 3764})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.749304072698578 Time :  3609
accuracy train: 0.988285 val: 0.970909 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.969406
Counter({1: 3883, 0: 3808})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.751105047762394 Time :  3636
accuracy train: 0.989093 val: 0.974545 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.969406
Counter({1: 3877, 0: 3814})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.344794836593792 Time :  3678
accuracy train: 0.991315 val: 0.970909 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.969406
Counter({1: 3866, 0: 3825})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.32236578152515 Time :  3713
accuracy train: 0.991315 val: 0.972727 test: 0.974886
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.969406
Counter({1: 3852, 0: 3839})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.638586420798674 Time :  3743
accuracy train: 0.992325 val: 0.972727 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.969406
Counter({1: 3849, 0: 3842})

Epoch :  11 loss training:  5.155546781956218 Time :  3774
accuracy train: 0.992729 val: 0.974545 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.969406
Counter({0: 3856, 1: 3835})

Epoch :  12 loss training:  5.0744519084692 Time :  3804
accuracy train: 0.992123 val: 0.974545 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.969406
Counter({0: 3858, 1: 3833})

Epoch :  13 loss training:  4.87747094250517 Time :  3833
accuracy train: 0.993537 val: 0.972727 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.969406
Counter({0: 3872, 1: 3819})

Epoch :  14 loss training:  4.6186153969028965 Time :  3886
accuracy train: 0.993335 val: 0.970909 test: 0.975342
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.969406
Counter({0: 3873, 1: 3818})

Epoch :  15 loss training:  4.1535073827253655 Time :  3917
accuracy train: 0.993941 val: 0.974545 test: 0.976712
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.969406
Counter({0: 3883, 1: 3808})

Epoch :  16 loss training:  3.8911734264111146 Time :  3946
accuracy train: 0.994345 val: 0.972727 test: 0.975799
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.969406
Counter({0: 3889, 1: 3802})

Epoch :  17 loss training:  3.8743052861536853 Time :  3978
accuracy train: 0.995152 val: 0.974545 test: 0.975342
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.969406
Counter({0: 3894, 1: 3797})

Epoch :  18 loss training:  3.57995666685747 Time :  4007
accuracy train: 0.994951 val: 0.970909 test: 0.975799
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.969406
Counter({0: 3896, 1: 3795})

Epoch :  19 loss training:  3.566653744317591 Time :  4046
accuracy train: 0.995152 val: 0.972727 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.969406
Counter({1: 3902, 0: 3789})

Epoch :  20 loss training:  3.02320355703705 Time :  4085
accuracy train: 0.996364 val: 0.974545 test: 0.977169
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.969406
Counter({0: 3909, 1: 3782})

Epoch :  21 loss training:  2.9633112523006275 Time :  4114
accuracy train: 0.995758 val: 0.978182 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3920, 1: 3771})

Epoch :  22 loss training:  2.751988233474549 Time :  4143
accuracy train: 0.996162 val: 0.976364 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3925, 1: 3766})

Epoch :  23 loss training:  2.9650213934655767 Time :  4171
accuracy train: 0.996162 val: 0.974545 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3925, 1: 3766})

Epoch :  24 loss training:  2.716271557554137 Time :  4200
accuracy train: 0.996364 val: 0.972727 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3926, 1: 3765})

Epoch :  25 loss training:  2.4298686229158193 Time :  4247
accuracy train: 0.996364 val: 0.976364 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3926, 1: 3765})

Epoch :  26 loss training:  2.5347212329797912 Time :  4279
accuracy train: 0.996162 val: 0.974545 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3928, 1: 3763})

Epoch :  27 loss training:  2.541904372483259 Time :  4308
accuracy train: 0.996768 val: 0.967273 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3927, 1: 3764})

Epoch :  28 loss training:  2.1798010619095294 Time :  4338
accuracy train: 0.996768 val: 0.970909 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3925, 1: 3766})

Epoch :  29 loss training:  2.6711990084440913 Time :  4367
accuracy train: 0.996768 val: 0.970909 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3926, 1: 3765})

Epoch :  30 loss training:  2.452903106226586 Time :  4403
accuracy train: 0.996970 val: 0.972727 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3929, 1: 3762})

Epoch :  31 loss training:  2.0130337645241525 Time :  4444
accuracy train: 0.997172 val: 0.972727 test: 0.975799
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3929, 1: 3762})

Epoch :  32 loss training:  2.419317113919533 Time :  4475
accuracy train: 0.996768 val: 0.970909 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3928, 1: 3763})

Epoch :  33 loss training:  2.009836644225288 Time :  4507
accuracy train: 0.996970 val: 0.970909 test: 0.975799
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3929, 1: 3762})

Epoch :  34 loss training:  1.6984905499557499 Time :  4539
accuracy train: 0.996970 val: 0.972727 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3928, 1: 3763})

Epoch :  35 loss training:  1.5920092834858224 Time :  4570
accuracy train: 0.997172 val: 0.970909 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3931, 1: 3760})

Epoch :  36 loss training:  1.6737692475435324 Time :  4611
accuracy train: 0.996768 val: 0.970909 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3932, 1: 3759})

Epoch :  37 loss training:  1.830237700844009 Time :  4654
accuracy train: 0.996970 val: 0.963636 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3932, 1: 3759})

Epoch :  38 loss training:  1.6466643752355594 Time :  4684
accuracy train: 0.997374 val: 0.970909 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3933, 1: 3758})

Epoch :  39 loss training:  1.6579176854284015 Time :  4716
accuracy train: 0.997172 val: 0.963636 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3933, 1: 3758})

Epoch :  40 loss training:  1.6583457889719284 Time :  4747
accuracy train: 0.997374 val: 0.970909 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3933, 1: 3758})

Epoch :  41 loss training:  1.3894453963148408 Time :  4778
accuracy train: 0.997576 val: 0.970909 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3933, 1: 3758})

Epoch :  42 loss training:  1.3071477303819847 Time :  4827
accuracy train: 0.997980 val: 0.972727 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3933, 1: 3758})

Epoch :  43 loss training:  1.4679879752657143 Time :  4858
accuracy train: 0.997576 val: 0.965455 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3933, 1: 3758})

Epoch :  44 loss training:  1.5408351758378558 Time :  4890
accuracy train: 0.997374 val: 0.970909 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3933, 1: 3758})

Epoch :  45 loss training:  1.4411326087574707 Time :  4920
accuracy train: 0.996970 val: 0.969091 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3933, 1: 3758})

Epoch :  46 loss training:  1.5437923207973654 Time :  4951
accuracy train: 0.997576 val: 0.974545 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3933, 1: 3758})

Epoch :  47 loss training:  1.2088270173189812 Time :  4982
accuracy train: 0.997778 val: 0.969091 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3933, 1: 3758})

Epoch :  48 loss training:  1.4297613186390663 Time :  5036
accuracy train: 0.997576 val: 0.974545 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3933, 1: 3758})

Epoch :  49 loss training:  1.283425450194045 Time :  5066
accuracy train: 0.996970 val: 0.970909 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3933, 1: 3758})

Epoch :  50 loss training:  1.1507324419508222 Time :  5098
accuracy train: 0.997374 val: 0.969091 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3933, 1: 3758})

Epoch :  51 loss training:  1.6224873282990302 Time :  5128
accuracy train: 0.997172 val: 0.969091 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3933, 1: 3758})

Epoch :  52 loss training:  1.288117261865409 Time :  5159
accuracy train: 0.997576 val: 0.965455 test: 0.978082
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3933, 1: 3758})

========================================================================================================================================================================================================
max acc epoch :  21
max validation accuracy :  0.9781818181818182
test accuracy :  0.9744292237442922
last test_accuracy :  0.9780821917808219
second best val :  0.9763636363636363
second best test :  0.9744292237442922
max gap 19
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=402, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  41.66861743479967 Time :  5261
accuracy train: 0.947485 val: 0.940000 test: 0.945205
max validation accuracy : 0.940000 max acc epoch : 1 test accuracy : 0.945205
Counter({1: 3977, 0: 3714})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  20.43812588043511 Time :  5293
accuracy train: 0.975157 val: 0.972727 test: 0.968493
max validation accuracy : 0.972727 max acc epoch : 2 test accuracy : 0.968493
Counter({1: 3936, 0: 3755})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.854978398885578 Time :  5325
accuracy train: 0.972329 val: 0.967273 test: 0.962557
max validation accuracy : 0.972727 max acc epoch : 2 test accuracy : 0.968493
Counter({1: 3942, 0: 3749})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.490191188175231 Time :  5356
accuracy train: 0.977176 val: 0.976364 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.971689
Counter({1: 3926, 0: 3765})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.75272929505445 Time :  5390
accuracy train: 0.982226 val: 0.967273 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.971689
Counter({1: 3921, 0: 3770})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.49578192573972 Time :  5437
accuracy train: 0.988689 val: 0.976364 test: 0.964840
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.971689
Counter({1: 3879, 0: 3812})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.624206166481599 Time :  5468
accuracy train: 0.989295 val: 0.976364 test: 0.974886
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.971689
Counter({1: 3865, 0: 3826})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.303871623007581 Time :  5498
accuracy train: 0.991315 val: 0.970909 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.971689
Counter({1: 3858, 0: 3833})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.360409584711306 Time :  5528
accuracy train: 0.991719 val: 0.976364 test: 0.973516
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.971689
Counter({1: 3851, 0: 3840})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.440217562951148 Time :  5560
accuracy train: 0.992123 val: 0.974545 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.971689
Counter({0: 3849, 1: 3842})

Epoch :  11 loss training:  5.148882196517661 Time :  5603
accuracy train: 0.993537 val: 0.976364 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.971689
Counter({0: 3857, 1: 3834})

Epoch :  12 loss training:  5.098708105739206 Time :  5644
accuracy train: 0.992325 val: 0.972727 test: 0.973516
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.971689
Counter({0: 3859, 1: 3832})

Epoch :  13 loss training:  4.791417934640776 Time :  5676
accuracy train: 0.994143 val: 0.974545 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.971689
Counter({0: 3877, 1: 3814})

Epoch :  14 loss training:  4.823719836189412 Time :  5709
accuracy train: 0.993537 val: 0.976364 test: 0.974429
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.971689
Counter({1: 3879, 0: 3812})

Epoch :  15 loss training:  4.154233760898933 Time :  5741
accuracy train: 0.993941 val: 0.976364 test: 0.974886
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.971689
Counter({1: 3881, 0: 3810})

Epoch :  16 loss training:  3.7420247356640175 Time :  5781
accuracy train: 0.993941 val: 0.974545 test: 0.976712
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.971689
Counter({0: 3889, 1: 3802})

Epoch :  17 loss training:  3.8479924208368175 Time :  5824
accuracy train: 0.994951 val: 0.974545 test: 0.974886
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.971689
Counter({0: 3892, 1: 3799})

Epoch :  18 loss training:  3.459981981664896 Time :  5856
accuracy train: 0.995556 val: 0.974545 test: 0.973516
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.971689
Counter({0: 3895, 1: 3796})

Epoch :  19 loss training:  3.4100366873899475 Time :  5887
accuracy train: 0.995152 val: 0.974545 test: 0.973973
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.971689
Counter({0: 3905, 1: 3786})

Epoch :  20 loss training:  3.084346728574019 Time :  5917
accuracy train: 0.996364 val: 0.974545 test: 0.975342
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.971689
Counter({0: 3906, 1: 3785})

Epoch :  21 loss training:  2.8271437277435325 Time :  5948
accuracy train: 0.996162 val: 0.980000 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3917, 1: 3774})

Epoch :  22 loss training:  2.710214364400599 Time :  5978
accuracy train: 0.996162 val: 0.972727 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3921, 1: 3770})

Epoch :  23 loss training:  2.832626523973886 Time :  6006
accuracy train: 0.996162 val: 0.974545 test: 0.977169
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3920, 1: 3771})

Epoch :  24 loss training:  2.6392860384075902 Time :  6034
accuracy train: 0.996566 val: 0.976364 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3922, 1: 3769})

Epoch :  25 loss training:  2.1465866061626 Time :  6062
accuracy train: 0.996566 val: 0.976364 test: 0.975799
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3922, 1: 3769})

Epoch :  26 loss training:  2.38262771468726 Time :  6091
accuracy train: 0.996768 val: 0.976364 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3921, 1: 3770})

Epoch :  27 loss training:  2.406121758307563 Time :  6121
accuracy train: 0.996566 val: 0.972727 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3921, 1: 3770})

Epoch :  28 loss training:  2.114992750575766 Time :  6150
accuracy train: 0.996364 val: 0.969091 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3926, 1: 3765})

Epoch :  29 loss training:  2.5122621977934614 Time :  6182
accuracy train: 0.996768 val: 0.972727 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3926, 1: 3765})

Epoch :  30 loss training:  2.2153813788027037 Time :  6222
accuracy train: 0.996970 val: 0.974545 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3927, 1: 3764})

Epoch :  31 loss training:  1.9668505433801329 Time :  6256
accuracy train: 0.997172 val: 0.974545 test: 0.975342
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3927, 1: 3764})

Epoch :  32 loss training:  2.541903311779606 Time :  6295
accuracy train: 0.996364 val: 0.974545 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3928, 1: 3763})

Epoch :  33 loss training:  1.9049083124264143 Time :  6330
accuracy train: 0.996768 val: 0.972727 test: 0.975799
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3928, 1: 3763})

Epoch :  34 loss training:  1.7589241123496322 Time :  6364
accuracy train: 0.996566 val: 0.970909 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3928, 1: 3763})

Epoch :  35 loss training:  1.552046432509087 Time :  6399
accuracy train: 0.997576 val: 0.972727 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({1: 3930, 0: 3761})

Epoch :  36 loss training:  1.6429935866617598 Time :  6435
accuracy train: 0.997374 val: 0.972727 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3930, 1: 3761})

Epoch :  37 loss training:  1.794520551142341 Time :  6470
accuracy train: 0.997374 val: 0.965455 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3930, 1: 3761})

Epoch :  38 loss training:  1.5812059139279881 Time :  6507
accuracy train: 0.997172 val: 0.969091 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3931, 1: 3760})

Epoch :  39 loss training:  1.6062121724680765 Time :  6541
accuracy train: 0.997576 val: 0.970909 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3932, 1: 3759})

Epoch :  40 loss training:  1.5809253946790705 Time :  6574
accuracy train: 0.997576 val: 0.972727 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3932, 1: 3759})

Epoch :  41 loss training:  1.3567768694192637 Time :  6614
accuracy train: 0.997172 val: 0.970909 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3932, 1: 3759})

Epoch :  42 loss training:  1.3033042455717805 Time :  6654
accuracy train: 0.997576 val: 0.970909 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3932, 1: 3759})

Epoch :  43 loss training:  1.4357517572207144 Time :  6692
accuracy train: 0.997374 val: 0.967273 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3932, 1: 3759})

Epoch :  44 loss training:  1.6319212529197102 Time :  6728
accuracy train: 0.997576 val: 0.969091 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3932, 1: 3759})

Epoch :  45 loss training:  1.4881435254501412 Time :  6761
accuracy train: 0.996970 val: 0.972727 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3933, 1: 3758})

Epoch :  46 loss training:  1.6467482109801495 Time :  6796
accuracy train: 0.997172 val: 0.974545 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3933, 1: 3758})

Epoch :  47 loss training:  1.1798746773856692 Time :  6834
accuracy train: 0.997778 val: 0.974545 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3933, 1: 3758})

Epoch :  48 loss training:  1.4246743207040709 Time :  6868
accuracy train: 0.997576 val: 0.974545 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3932, 1: 3759})

Epoch :  49 loss training:  1.2994269536611682 Time :  6906
accuracy train: 0.996970 val: 0.972727 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3932, 1: 3759})

Epoch :  50 loss training:  1.172664154011727 Time :  6944
accuracy train: 0.997374 val: 0.970909 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3932, 1: 3759})

Epoch :  51 loss training:  1.421721663849894 Time :  6978
accuracy train: 0.997172 val: 0.974545 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3932, 1: 3759})

Epoch :  52 loss training:  1.3285631699036458 Time :  7015
accuracy train: 0.997778 val: 0.970909 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.974429
Counter({0: 3932, 1: 3759})

========================================================================================================================================================================================================
max acc epoch :  21
max validation accuracy :  0.98
test accuracy :  0.9744292237442922
last test_accuracy :  0.9739726027397261
second best val :  0.9763636363636363
second best test :  0.971689497716895
max gap 17
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=402, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  41.717085774987936 Time :  7103
accuracy train: 0.949101 val: 0.940000 test: 0.945662
max validation accuracy : 0.940000 max acc epoch : 1 test accuracy : 0.945662
Counter({1: 3960, 0: 3731})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  20.13002576865256 Time :  7142
accuracy train: 0.975157 val: 0.974545 test: 0.965753
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.965753
Counter({1: 3937, 0: 3754})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.970542279072106 Time :  7178
accuracy train: 0.973339 val: 0.969091 test: 0.962557
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.965753
Counter({1: 3932, 0: 3759})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.106938841287047 Time :  7214
accuracy train: 0.979196 val: 0.974545 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.965753
Counter({1: 3904, 0: 3787})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.7242290439317 Time :  7250
accuracy train: 0.980812 val: 0.965455 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.965753
Counter({1: 3902, 0: 3789})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.664100986206904 Time :  7285
accuracy train: 0.988487 val: 0.972727 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.965753
Counter({1: 3879, 0: 3812})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.6586951510980725 Time :  7320
accuracy train: 0.990103 val: 0.974545 test: 0.974429
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.965753
Counter({1: 3862, 0: 3829})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.244736511493102 Time :  7354
accuracy train: 0.991315 val: 0.970909 test: 0.974886
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.965753
Counter({0: 3853, 1: 3838})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.3261132357874885 Time :  7385
accuracy train: 0.991517 val: 0.978182 test: 0.975799
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({1: 3847, 0: 3844})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.513761611422524 Time :  7422
accuracy train: 0.992123 val: 0.972727 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3850, 1: 3841})

Epoch :  11 loss training:  5.304116821615025 Time :  7457
accuracy train: 0.993739 val: 0.974545 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3858, 1: 3833})

Epoch :  12 loss training:  5.059754264424555 Time :  7492
accuracy train: 0.991921 val: 0.974545 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3857, 1: 3834})

Epoch :  13 loss training:  4.6915529481484555 Time :  7531
accuracy train: 0.994345 val: 0.976364 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({1: 3869, 0: 3822})

Epoch :  14 loss training:  4.888207725714892 Time :  7569
accuracy train: 0.993537 val: 0.976364 test: 0.975799
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3874, 1: 3817})

Epoch :  15 loss training:  4.215938745532185 Time :  7606
accuracy train: 0.993739 val: 0.976364 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3888, 1: 3803})

Epoch :  16 loss training:  3.7184402943239547 Time :  7642
accuracy train: 0.994345 val: 0.974545 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3902, 1: 3789})

Epoch :  17 loss training:  3.765875436598435 Time :  7677
accuracy train: 0.995152 val: 0.974545 test: 0.975799
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3912, 1: 3779})

Epoch :  18 loss training:  3.44082584453281 Time :  7712
accuracy train: 0.995354 val: 0.972727 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3912, 1: 3779})

Epoch :  19 loss training:  3.400227125384845 Time :  7746
accuracy train: 0.994749 val: 0.976364 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3915, 1: 3776})

Epoch :  20 loss training:  2.979766477685189 Time :  7781
accuracy train: 0.996162 val: 0.974545 test: 0.975799
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3916, 1: 3775})

Epoch :  21 loss training:  2.942657571460586 Time :  7815
accuracy train: 0.995960 val: 0.976364 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3918, 1: 3773})

Epoch :  22 loss training:  2.6917036910308525 Time :  7850
accuracy train: 0.995960 val: 0.974545 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3921, 1: 3770})

Epoch :  23 loss training:  2.9568142647622153 Time :  7885
accuracy train: 0.996162 val: 0.974545 test: 0.976712
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3921, 1: 3770})

Epoch :  24 loss training:  2.6805878243176267 Time :  7918
accuracy train: 0.996364 val: 0.970909 test: 0.976712
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3923, 1: 3768})

Epoch :  25 loss training:  2.2688638796680607 Time :  7951
accuracy train: 0.996162 val: 0.978182 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3924, 1: 3767})

Epoch :  26 loss training:  2.5319707852904685 Time :  7986
accuracy train: 0.996566 val: 0.974545 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3925, 1: 3766})

Epoch :  27 loss training:  2.5824646012333687 Time :  8023
accuracy train: 0.996768 val: 0.972727 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3925, 1: 3766})

Epoch :  28 loss training:  2.052359598543262 Time :  8055
accuracy train: 0.996566 val: 0.974545 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({1: 3924, 0: 3767})

Epoch :  29 loss training:  2.7481398884556256 Time :  8092
accuracy train: 0.996768 val: 0.972727 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3924, 1: 3767})

Epoch :  30 loss training:  2.481226341740694 Time :  8129
accuracy train: 0.997172 val: 0.974545 test: 0.976256
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({1: 3929, 0: 3762})

Epoch :  31 loss training:  1.9662824991391972 Time :  8165
accuracy train: 0.997172 val: 0.972727 test: 0.976712
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3929, 1: 3762})

Epoch :  32 loss training:  2.327605790924281 Time :  8196
accuracy train: 0.996364 val: 0.970909 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3928, 1: 3763})

Epoch :  33 loss training:  1.9836076298670378 Time :  8230
accuracy train: 0.996768 val: 0.970909 test: 0.976712
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3928, 1: 3763})

Epoch :  34 loss training:  1.5868712204974145 Time :  8265
accuracy train: 0.996566 val: 0.972727 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({1: 3930, 0: 3761})

Epoch :  35 loss training:  1.6210553385899402 Time :  8300
accuracy train: 0.997374 val: 0.972727 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3930, 1: 3761})

Epoch :  36 loss training:  1.611587904029875 Time :  8333
accuracy train: 0.996970 val: 0.970909 test: 0.975799
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3930, 1: 3761})

Epoch :  37 loss training:  1.7550745557091432 Time :  8368
accuracy train: 0.997374 val: 0.969091 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3930, 1: 3761})

Epoch :  38 loss training:  1.5773406310472637 Time :  8401
accuracy train: 0.997778 val: 0.970909 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3931, 1: 3760})

Epoch :  39 loss training:  1.686921694810735 Time :  8436
accuracy train: 0.997576 val: 0.972727 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3931, 1: 3760})

Epoch :  40 loss training:  1.5318951015215134 Time :  8470
accuracy train: 0.997576 val: 0.969091 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 9 test accuracy : 0.975799
Counter({0: 3931, 1: 3760})

========================================================================================================================================================================================================
max acc epoch :  9
max validation accuracy :  0.9781818181818182
test accuracy :  0.9757990867579909
last test_accuracy :  0.9735159817351599
second best val :  0.9763636363636363
second best test :  0.9757990867579909
max gap 7
========================================================================================================================================================================================================

itr : 6
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=402, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  41.7157988473773 Time :  8558
accuracy train: 0.947283 val: 0.938182 test: 0.944292
max validation accuracy : 0.938182 max acc epoch : 1 test accuracy : 0.944292
Counter({1: 3972, 0: 3719})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  20.354467617347836 Time :  8599
accuracy train: 0.974349 val: 0.972727 test: 0.965297
max validation accuracy : 0.972727 max acc epoch : 2 test accuracy : 0.965297
Counter({1: 3933, 0: 3758})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.90950263477862 Time :  8638
accuracy train: 0.973137 val: 0.970909 test: 0.966210
max validation accuracy : 0.972727 max acc epoch : 2 test accuracy : 0.965297
Counter({1: 3941, 0: 3750})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.007259238045663 Time :  8685
accuracy train: 0.978388 val: 0.974545 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.969406
Counter({1: 3921, 0: 3770})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.312260366627015 Time :  8731
accuracy train: 0.978994 val: 0.963636 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.969406
Counter({1: 3920, 0: 3771})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.581753382459283 Time :  8775
accuracy train: 0.987881 val: 0.974545 test: 0.964384
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.969406
Counter({1: 3891, 0: 3800})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.65816101199016 Time :  8827
accuracy train: 0.988891 val: 0.972727 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.969406
Counter({1: 3882, 0: 3809})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.40590674104169 Time :  8879
accuracy train: 0.990911 val: 0.969091 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.969406
Counter({1: 3874, 0: 3817})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.624800638994202 Time :  8929
accuracy train: 0.990911 val: 0.974545 test: 0.974886
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.969406
Counter({1: 3851, 0: 3840})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.497017084737308 Time :  8987
accuracy train: 0.991719 val: 0.970909 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.969406
Counter({0: 3846, 1: 3845})

Epoch :  11 loss training:  5.308652424719185 Time :  9034
accuracy train: 0.992123 val: 0.970909 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.969406
Counter({0: 3854, 1: 3837})

Epoch :  12 loss training:  5.108329060138203 Time :  9085
accuracy train: 0.992325 val: 0.970909 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.969406
Counter({0: 3855, 1: 3836})

Epoch :  13 loss training:  4.807332091208082 Time :  9140
accuracy train: 0.993537 val: 0.972727 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.969406
Counter({0: 3864, 1: 3827})

Epoch :  14 loss training:  4.9583569733658805 Time :  9190
accuracy train: 0.994345 val: 0.972727 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.969406
Counter({0: 3866, 1: 3825})

Epoch :  15 loss training:  4.30292305466719 Time :  9243
accuracy train: 0.993941 val: 0.974545 test: 0.975799
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.969406
Counter({0: 3879, 1: 3812})

Epoch :  16 loss training:  3.7133908655960113 Time :  9292
accuracy train: 0.993739 val: 0.972727 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.969406
Counter({0: 3890, 1: 3801})

Epoch :  17 loss training:  3.942100169486366 Time :  9336
accuracy train: 0.995152 val: 0.972727 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.969406
Counter({0: 3897, 1: 3794})

Epoch :  18 loss training:  3.3964907811023295 Time :  9373
accuracy train: 0.995556 val: 0.972727 test: 0.974886
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.969406
Counter({0: 3901, 1: 3790})

Epoch :  19 loss training:  3.3487425506464206 Time :  9413
accuracy train: 0.995152 val: 0.974545 test: 0.974886
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.969406
Counter({1: 3905, 0: 3786})

Epoch :  20 loss training:  2.9934417040494736 Time :  9452
accuracy train: 0.996162 val: 0.976364 test: 0.974429
max validation accuracy : 0.976364 max acc epoch : 20 test accuracy : 0.974429
Counter({0: 3908, 1: 3783})

Epoch :  21 loss training:  2.786277568724472 Time :  9490
accuracy train: 0.995960 val: 0.978182 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3924, 1: 3767})

Epoch :  22 loss training:  2.6953136162483133 Time :  9540
accuracy train: 0.995758 val: 0.970909 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3929, 1: 3762})

Epoch :  23 loss training:  2.817996956699062 Time :  9585
accuracy train: 0.996162 val: 0.970909 test: 0.976256
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3929, 1: 3762})

Epoch :  24 loss training:  2.6263200956746005 Time :  9625
accuracy train: 0.996364 val: 0.972727 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3929, 1: 3762})

Epoch :  25 loss training:  2.24319276062306 Time :  9665
accuracy train: 0.996364 val: 0.976364 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3929, 1: 3762})

Epoch :  26 loss training:  2.5362930072587915 Time :  9699
accuracy train: 0.996364 val: 0.974545 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3929, 1: 3762})

Epoch :  27 loss training:  2.592413093545474 Time :  9740
accuracy train: 0.996768 val: 0.967273 test: 0.975799
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3929, 1: 3762})

Epoch :  28 loss training:  2.210547958035022 Time :  9798
accuracy train: 0.996364 val: 0.972727 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3930, 1: 3761})

Epoch :  29 loss training:  2.5689088015642483 Time :  9836
accuracy train: 0.996566 val: 0.970909 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3930, 1: 3761})

Epoch :  30 loss training:  2.2939960840158165 Time :  9876
accuracy train: 0.996970 val: 0.974545 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3935, 1: 3756})

Epoch :  31 loss training:  1.9253680541587528 Time :  9916
accuracy train: 0.996970 val: 0.969091 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3935, 1: 3756})

Epoch :  32 loss training:  2.3383338997955434 Time :  9954
accuracy train: 0.996162 val: 0.972727 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3935, 1: 3756})

Epoch :  33 loss training:  1.9205132341157878 Time :  9988
accuracy train: 0.996768 val: 0.972727 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3935, 1: 3756})

Epoch :  34 loss training:  1.649272703245515 Time :  10041
accuracy train: 0.996364 val: 0.969091 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3938, 1: 3753})

Epoch :  35 loss training:  1.6236061866075033 Time :  10079
accuracy train: 0.997172 val: 0.972727 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3939, 1: 3752})

Epoch :  36 loss training:  1.7191554525343236 Time :  10119
accuracy train: 0.997172 val: 0.969091 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3937, 1: 3754})

Epoch :  37 loss training:  1.8103543479228392 Time :  10157
accuracy train: 0.996970 val: 0.963636 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3937, 1: 3754})

Epoch :  38 loss training:  1.6122533779853256 Time :  10199
accuracy train: 0.997172 val: 0.969091 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3937, 1: 3754})

Epoch :  39 loss training:  1.6605665369716007 Time :  10248
accuracy train: 0.997576 val: 0.972727 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3937, 1: 3754})

Epoch :  40 loss training:  1.5888027254477493 Time :  10301
accuracy train: 0.997576 val: 0.969091 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3937, 1: 3754})

Epoch :  41 loss training:  1.3575629588085576 Time :  10336
accuracy train: 0.997576 val: 0.969091 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3937, 1: 3754})

Epoch :  42 loss training:  1.3096783869768842 Time :  10374
accuracy train: 0.997576 val: 0.969091 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3937, 1: 3754})

Epoch :  43 loss training:  1.4484346136450768 Time :  10416
accuracy train: 0.997576 val: 0.963636 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3937, 1: 3754})

Epoch :  44 loss training:  1.670107303216355 Time :  10454
accuracy train: 0.997576 val: 0.967273 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3933, 1: 3758})

Epoch :  45 loss training:  1.5298686115202145 Time :  10495
accuracy train: 0.996970 val: 0.969091 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3933, 1: 3758})

Epoch :  46 loss training:  1.6951663288491545 Time :  10548
accuracy train: 0.997374 val: 0.970909 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3933, 1: 3758})

Epoch :  47 loss training:  1.2305710233267746 Time :  10584
accuracy train: 0.997778 val: 0.969091 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3933, 1: 3758})

Epoch :  48 loss training:  1.401965631350322 Time :  10620
accuracy train: 0.997576 val: 0.969091 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3933, 1: 3758})

Epoch :  49 loss training:  1.2545723078847004 Time :  10658
accuracy train: 0.997576 val: 0.969091 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3933, 1: 3758})

Epoch :  50 loss training:  1.1607043628391693 Time :  10693
accuracy train: 0.997576 val: 0.969091 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3933, 1: 3758})

Epoch :  51 loss training:  1.379558471358905 Time :  10731
accuracy train: 0.997172 val: 0.969091 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3933, 1: 3758})

Epoch :  52 loss training:  1.2868991957730032 Time :  10783
accuracy train: 0.997576 val: 0.970909 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3933, 1: 3758})

========================================================================================================================================================================================================
max acc epoch :  21
max validation accuracy :  0.9781818181818182
test accuracy :  0.9726027397260274
last test_accuracy :  0.9730593607305936
second best val :  0.9763636363636363
second best test :  0.9744292237442922
max gap 16
========================================================================================================================================================================================================

itr : 7
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=402, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  41.66462139412761 Time :  10875
accuracy train: 0.947687 val: 0.934545 test: 0.944292
max validation accuracy : 0.934545 max acc epoch : 1 test accuracy : 0.944292
Counter({1: 3976, 0: 3715})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  20.41500777937472 Time :  10914
accuracy train: 0.974551 val: 0.974545 test: 0.965297
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.965297
Counter({1: 3937, 0: 3754})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  17.05197220016271 Time :  10950
accuracy train: 0.972733 val: 0.965455 test: 0.964384
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.965297
Counter({1: 3943, 0: 3748})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.979094968177378 Time :  11000
accuracy train: 0.974147 val: 0.972727 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.965297
Counter({1: 3928, 0: 3763})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.273580389446579 Time :  11040
accuracy train: 0.977984 val: 0.965455 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.965297
Counter({1: 3931, 0: 3760})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.731238289736211 Time :  11076
accuracy train: 0.987073 val: 0.970909 test: 0.963014
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.965297
Counter({1: 3904, 0: 3787})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.886982059339061 Time :  11114
accuracy train: 0.988689 val: 0.972727 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.965297
Counter({1: 3900, 0: 3791})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.575645406963304 Time :  11149
accuracy train: 0.990507 val: 0.974545 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.965297
Counter({1: 3893, 0: 3798})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.5361591866239905 Time :  11201
accuracy train: 0.990709 val: 0.974545 test: 0.975799
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.965297
Counter({1: 3883, 0: 3808})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.7665841521229595 Time :  11243
accuracy train: 0.991517 val: 0.972727 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.965297
Counter({0: 3878, 1: 3813})

Epoch :  11 loss training:  5.264610104262829 Time :  11278
accuracy train: 0.992527 val: 0.972727 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.965297
Counter({1: 3864, 0: 3827})

Epoch :  12 loss training:  5.300039913621731 Time :  11318
accuracy train: 0.991719 val: 0.972727 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.965297
Counter({1: 3857, 0: 3834})

Epoch :  13 loss training:  5.01706203824142 Time :  11353
accuracy train: 0.993739 val: 0.974545 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.965297
Counter({0: 3857, 1: 3834})

Epoch :  14 loss training:  5.0404179997276515 Time :  11389
accuracy train: 0.993537 val: 0.974545 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 2 test accuracy : 0.965297
Counter({0: 3858, 1: 3833})

Epoch :  15 loss training:  4.209134482080117 Time :  11442
accuracy train: 0.994143 val: 0.978182 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974429
Counter({0: 3865, 1: 3826})

Epoch :  16 loss training:  3.815598399261944 Time :  11477
accuracy train: 0.993537 val: 0.974545 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974429
Counter({0: 3880, 1: 3811})

Epoch :  17 loss training:  3.9452071308624 Time :  11511
accuracy train: 0.994951 val: 0.976364 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974429
Counter({0: 3887, 1: 3804})

Epoch :  18 loss training:  3.5874509976711124 Time :  11546
accuracy train: 0.995152 val: 0.976364 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974429
Counter({0: 3890, 1: 3801})

Epoch :  19 loss training:  3.368921583634801 Time :  11580
accuracy train: 0.995152 val: 0.974545 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974429
Counter({0: 3895, 1: 3796})

Epoch :  20 loss training:  3.1093100809666794 Time :  11623
accuracy train: 0.996162 val: 0.978182 test: 0.975799
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.974429
Counter({0: 3898, 1: 3793})

Epoch :  21 loss training:  2.9229461535578594 Time :  11670
accuracy train: 0.995960 val: 0.980000 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({1: 3910, 0: 3781})

Epoch :  22 loss training:  2.818238022911828 Time :  11704
accuracy train: 0.995960 val: 0.972727 test: 0.974886
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({1: 3919, 0: 3772})

Epoch :  23 loss training:  2.9966030609211884 Time :  11737
accuracy train: 0.996162 val: 0.970909 test: 0.975799
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3919, 1: 3772})

Epoch :  24 loss training:  2.720600493485108 Time :  11773
accuracy train: 0.996364 val: 0.976364 test: 0.974886
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3921, 1: 3770})

Epoch :  25 loss training:  2.380289569613524 Time :  11808
accuracy train: 0.995960 val: 0.978182 test: 0.974886
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3928, 1: 3763})

Epoch :  26 loss training:  2.467347306141164 Time :  11840
accuracy train: 0.996364 val: 0.974545 test: 0.975799
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3928, 1: 3763})

Epoch :  27 loss training:  2.6262177259195596 Time :  11895
accuracy train: 0.996566 val: 0.974545 test: 0.976712
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3928, 1: 3763})

Epoch :  28 loss training:  2.1322347340610577 Time :  11931
accuracy train: 0.996566 val: 0.972727 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3928, 1: 3763})

Epoch :  29 loss training:  2.5681089192512445 Time :  11963
accuracy train: 0.996566 val: 0.972727 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3928, 1: 3763})

Epoch :  30 loss training:  2.2838268280320335 Time :  11998
accuracy train: 0.997172 val: 0.976364 test: 0.975342
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3928, 1: 3763})

Epoch :  31 loss training:  1.951776577552664 Time :  12034
accuracy train: 0.996768 val: 0.974545 test: 0.976712
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3929, 1: 3762})

Epoch :  32 loss training:  2.492901632547728 Time :  12069
accuracy train: 0.996162 val: 0.970909 test: 0.970320
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3929, 1: 3762})

Epoch :  33 loss training:  1.9704655384266516 Time :  12117
accuracy train: 0.996566 val: 0.974545 test: 0.976256
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3929, 1: 3762})

Epoch :  34 loss training:  1.728007049241569 Time :  12149
accuracy train: 0.996364 val: 0.970909 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3931, 1: 3760})

Epoch :  35 loss training:  1.6673677421640605 Time :  12184
accuracy train: 0.997374 val: 0.970909 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3932, 1: 3759})

Epoch :  36 loss training:  1.7333555429213447 Time :  12215
accuracy train: 0.996768 val: 0.972727 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3929, 1: 3762})

Epoch :  37 loss training:  2.001657611646806 Time :  12249
accuracy train: 0.997374 val: 0.969091 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3929, 1: 3762})

Epoch :  38 loss training:  1.670306570835237 Time :  12292
accuracy train: 0.997172 val: 0.970909 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3930, 1: 3761})

Epoch :  39 loss training:  1.7336843493103515 Time :  12340
accuracy train: 0.997576 val: 0.972727 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3930, 1: 3761})

Epoch :  40 loss training:  1.6506536065571709 Time :  12374
accuracy train: 0.997576 val: 0.972727 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3932, 1: 3759})

Epoch :  41 loss training:  1.3620751340640709 Time :  12409
accuracy train: 0.997172 val: 0.969091 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3933, 1: 3758})

Epoch :  42 loss training:  1.3360494849548559 Time :  12444
accuracy train: 0.997980 val: 0.970909 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3933, 1: 3758})

Epoch :  43 loss training:  1.4521125566316186 Time :  12477
accuracy train: 0.997374 val: 0.969091 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3933, 1: 3758})

Epoch :  44 loss training:  1.5817048670323857 Time :  12526
accuracy train: 0.997778 val: 0.969091 test: 0.970320
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3933, 1: 3758})

Epoch :  45 loss training:  1.4653707777397358 Time :  12571
accuracy train: 0.996970 val: 0.970909 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3933, 1: 3758})

Epoch :  46 loss training:  1.6149958738824353 Time :  12610
accuracy train: 0.997576 val: 0.972727 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3933, 1: 3758})

Epoch :  47 loss training:  1.2305221179267392 Time :  12647
accuracy train: 0.997778 val: 0.974545 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3933, 1: 3758})

Epoch :  48 loss training:  1.3817289989674464 Time :  12684
accuracy train: 0.997576 val: 0.972727 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3933, 1: 3758})

Epoch :  49 loss training:  1.3287595661713567 Time :  12721
accuracy train: 0.996970 val: 0.972727 test: 0.974886
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3933, 1: 3758})

Epoch :  50 loss training:  1.178647602937417 Time :  12768
accuracy train: 0.997576 val: 0.969091 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({1: 3933, 0: 3758})

Epoch :  51 loss training:  1.474112873267586 Time :  12803
accuracy train: 0.997172 val: 0.972727 test: 0.973973
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3933, 1: 3758})

Epoch :  52 loss training:  1.3051090810622554 Time :  12840
accuracy train: 0.997576 val: 0.969091 test: 0.977169
max validation accuracy : 0.980000 max acc epoch : 21 test accuracy : 0.972603
Counter({0: 3933, 1: 3758})

========================================================================================================================================================================================================
max acc epoch :  21
max validation accuracy :  0.98
test accuracy :  0.9726027397260274
last test_accuracy :  0.9771689497716894
second best val :  0.9781818181818182
second best test :  0.9744292237442922
max gap 13
========================================================================================================================================================================================================

itr : 8
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=402, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  41.65686159580946 Time :  12921
accuracy train: 0.946677 val: 0.940000 test: 0.944749
max validation accuracy : 0.940000 max acc epoch : 1 test accuracy : 0.944749
Counter({1: 3971, 0: 3720})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  20.430142180994153 Time :  12973
accuracy train: 0.975359 val: 0.972727 test: 0.967580
max validation accuracy : 0.972727 max acc epoch : 2 test accuracy : 0.967580
Counter({1: 3933, 0: 3758})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.902018275111914 Time :  13007
accuracy train: 0.974349 val: 0.967273 test: 0.963014
max validation accuracy : 0.972727 max acc epoch : 2 test accuracy : 0.967580
Counter({1: 3941, 0: 3750})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.707448026631027 Time :  13042
accuracy train: 0.977378 val: 0.972727 test: 0.970320
max validation accuracy : 0.972727 max acc epoch : 2 test accuracy : 0.967580
Counter({1: 3935, 0: 3756})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.380463189794682 Time :  13079
accuracy train: 0.978186 val: 0.963636 test: 0.973516
max validation accuracy : 0.972727 max acc epoch : 2 test accuracy : 0.967580
Counter({1: 3932, 0: 3759})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.737526584183797 Time :  13112
accuracy train: 0.985054 val: 0.976364 test: 0.964840
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({0: 3923, 1: 3768})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.780547575093806 Time :  13145
accuracy train: 0.989295 val: 0.972727 test: 0.973516
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({1: 3916, 0: 3775})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.37587015889585 Time :  13193
accuracy train: 0.991517 val: 0.972727 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({1: 3906, 0: 3785})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.566221677698195 Time :  13227
accuracy train: 0.991315 val: 0.972727 test: 0.975342
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({1: 3892, 0: 3799})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.655146617558785 Time :  13262
accuracy train: 0.991719 val: 0.974545 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({1: 3885, 0: 3806})

Epoch :  11 loss training:  5.345539028989151 Time :  13296
accuracy train: 0.993335 val: 0.974545 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({1: 3873, 0: 3818})

Epoch :  12 loss training:  5.159896709374152 Time :  13327
accuracy train: 0.992325 val: 0.972727 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({1: 3869, 0: 3822})

Epoch :  13 loss training:  4.79073973337654 Time :  13367
accuracy train: 0.993941 val: 0.974545 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({1: 3850, 0: 3841})

Epoch :  14 loss training:  4.908324329764582 Time :  13421
accuracy train: 0.992527 val: 0.974545 test: 0.974429
max validation accuracy : 0.976364 max acc epoch : 6 test accuracy : 0.964840
Counter({1: 3848, 0: 3843})

Epoch :  15 loss training:  4.29604931990616 Time :  13458
accuracy train: 0.993739 val: 0.978182 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3859, 1: 3832})

Epoch :  16 loss training:  3.827797623234801 Time :  13493
accuracy train: 0.993941 val: 0.970909 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3876, 1: 3815})

Epoch :  17 loss training:  3.943952170549892 Time :  13529
accuracy train: 0.995556 val: 0.976364 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({1: 3880, 0: 3811})

Epoch :  18 loss training:  3.382880762219429 Time :  13564
accuracy train: 0.995152 val: 0.974545 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3882, 1: 3809})

Epoch :  19 loss training:  3.356651315873023 Time :  13612
accuracy train: 0.994951 val: 0.974545 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3884, 1: 3807})

Epoch :  20 loss training:  3.1115648831473663 Time :  13649
accuracy train: 0.996566 val: 0.976364 test: 0.975799
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({1: 3887, 0: 3804})

Epoch :  21 loss training:  2.823400392604526 Time :  13683
accuracy train: 0.996364 val: 0.978182 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3907, 1: 3784})

Epoch :  22 loss training:  2.8048667826806195 Time :  13716
accuracy train: 0.996364 val: 0.974545 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3914, 1: 3777})

Epoch :  23 loss training:  2.8005058312555775 Time :  13750
accuracy train: 0.996162 val: 0.974545 test: 0.977169
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3915, 1: 3776})

Epoch :  24 loss training:  2.5958025851869024 Time :  13783
accuracy train: 0.996566 val: 0.972727 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3916, 1: 3775})

Epoch :  25 loss training:  2.2446349370875396 Time :  13830
accuracy train: 0.996364 val: 0.974545 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({1: 3918, 0: 3773})

Epoch :  26 loss training:  2.460319920326583 Time :  13863
accuracy train: 0.996364 val: 0.974545 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3918, 1: 3773})

Epoch :  27 loss training:  2.4585723893833347 Time :  13894
accuracy train: 0.996768 val: 0.970909 test: 0.975799
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3919, 1: 3772})

Epoch :  28 loss training:  2.1067917980544735 Time :  13929
accuracy train: 0.996566 val: 0.970909 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3921, 1: 3770})

Epoch :  29 loss training:  2.5848676689201966 Time :  13960
accuracy train: 0.996566 val: 0.970909 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3922, 1: 3769})

Epoch :  30 loss training:  2.497746577806538 Time :  13993
accuracy train: 0.996970 val: 0.969091 test: 0.974886
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3926, 1: 3765})

Epoch :  31 loss training:  1.889717030499014 Time :  14041
accuracy train: 0.996970 val: 0.972727 test: 0.976256
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({1: 3925, 0: 3766})

Epoch :  32 loss training:  2.2637390685849823 Time :  14074
accuracy train: 0.996364 val: 0.972727 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3926, 1: 3765})

Epoch :  33 loss training:  1.9171724693005672 Time :  14108
accuracy train: 0.996566 val: 0.970909 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3926, 1: 3765})

Epoch :  34 loss training:  1.6982878831477137 Time :  14140
accuracy train: 0.996364 val: 0.970909 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3929, 1: 3762})

Epoch :  35 loss training:  1.5840503994986648 Time :  14166
accuracy train: 0.997374 val: 0.974545 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3928, 1: 3763})

Epoch :  36 loss training:  1.7130179674568353 Time :  14200
accuracy train: 0.997576 val: 0.972727 test: 0.975342
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3928, 1: 3763})

Epoch :  37 loss training:  1.8296465251696645 Time :  14233
accuracy train: 0.997172 val: 0.965455 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3928, 1: 3763})

Epoch :  38 loss training:  1.5873776375083253 Time :  14268
accuracy train: 0.997374 val: 0.972727 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3929, 1: 3762})

Epoch :  39 loss training:  1.6421865351003362 Time :  14298
accuracy train: 0.997576 val: 0.972727 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3929, 1: 3762})

Epoch :  40 loss training:  1.6755201815321925 Time :  14327
accuracy train: 0.997576 val: 0.972727 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3929, 1: 3762})

Epoch :  41 loss training:  1.4041847438857076 Time :  14362
accuracy train: 0.997778 val: 0.970909 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3929, 1: 3762})

Epoch :  42 loss training:  1.3727996636735043 Time :  14396
accuracy train: 0.997778 val: 0.970909 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3929, 1: 3762})

Epoch :  43 loss training:  1.3988820753147593 Time :  14421
accuracy train: 0.997374 val: 0.969091 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3930, 1: 3761})

Epoch :  44 loss training:  1.6105168244612287 Time :  14446
accuracy train: 0.997576 val: 0.967273 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3930, 1: 3761})

Epoch :  45 loss training:  1.5517675275696092 Time :  14474
accuracy train: 0.996970 val: 0.969091 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3930, 1: 3761})

Epoch :  46 loss training:  1.620177311837324 Time :  14498
accuracy train: 0.997374 val: 0.969091 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 15 test accuracy : 0.973973
Counter({0: 3930, 1: 3761})

========================================================================================================================================================================================================
max acc epoch :  15
max validation accuracy :  0.9781818181818182
test accuracy :  0.9739726027397261
last test_accuracy :  0.9712328767123287
second best val :  0.9763636363636363
second best test :  0.9648401826484019
max gap 9
========================================================================================================================================================================================================

itr : 9
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=402, weight_decay=1e-10)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  41.82331386953592 Time :  14586
accuracy train: 0.947485 val: 0.940000 test: 0.945205
max validation accuracy : 0.940000 max acc epoch : 1 test accuracy : 0.945205
Counter({1: 3977, 0: 3714})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  20.352286137640476 Time :  14612
accuracy train: 0.971723 val: 0.972727 test: 0.968493
max validation accuracy : 0.972727 max acc epoch : 2 test accuracy : 0.968493
Counter({1: 3940, 0: 3751})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.67638344038278 Time :  14638
accuracy train: 0.972733 val: 0.974545 test: 0.959817
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({1: 3929, 0: 3762})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.85723731899634 Time :  14666
accuracy train: 0.978994 val: 0.974545 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({1: 3905, 0: 3786})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.854503221751656 Time :  14705
accuracy train: 0.983034 val: 0.967273 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({1: 3906, 0: 3785})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.67197607504204 Time :  14733
accuracy train: 0.987679 val: 0.972727 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({1: 3875, 0: 3816})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.695378586417064 Time :  14757
accuracy train: 0.989699 val: 0.974545 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({1: 3865, 0: 3826})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.2700038203038275 Time :  14782
accuracy train: 0.990709 val: 0.972727 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({1: 3850, 0: 3841})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.237846585805528 Time :  14806
accuracy train: 0.992325 val: 0.972727 test: 0.975342
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({1: 3853, 0: 3838})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.659476064844057 Time :  14837
accuracy train: 0.991921 val: 0.972727 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({0: 3857, 1: 3834})

Epoch :  11 loss training:  5.292101818835363 Time :  14877
accuracy train: 0.993335 val: 0.972727 test: 0.974886
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({0: 3864, 1: 3827})

Epoch :  12 loss training:  5.099036700092256 Time :  14905
accuracy train: 0.991719 val: 0.972727 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({0: 3863, 1: 3828})

Epoch :  13 loss training:  4.794877764536068 Time :  14931
accuracy train: 0.993941 val: 0.972727 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({0: 3872, 1: 3819})

Epoch :  14 loss training:  4.918518950697035 Time :  14958
accuracy train: 0.993537 val: 0.970909 test: 0.975799
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({0: 3877, 1: 3814})

Epoch :  15 loss training:  4.260137505130842 Time :  14984
accuracy train: 0.993739 val: 0.972727 test: 0.976712
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({0: 3884, 1: 3807})

Epoch :  16 loss training:  3.8580459653167054 Time :  15017
accuracy train: 0.993739 val: 0.970909 test: 0.974886
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({0: 3896, 1: 3795})

Epoch :  17 loss training:  3.74125554721104 Time :  15044
accuracy train: 0.995152 val: 0.970909 test: 0.974429
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({0: 3900, 1: 3791})

Epoch :  18 loss training:  3.4637172439834103 Time :  15078
accuracy train: 0.995354 val: 0.970909 test: 0.974429
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({0: 3901, 1: 3790})

Epoch :  19 loss training:  3.342719746113289 Time :  15108
accuracy train: 0.994951 val: 0.970909 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({0: 3910, 1: 3781})

Epoch :  20 loss training:  2.985681424586801 Time :  15138
accuracy train: 0.996162 val: 0.970909 test: 0.976712
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({0: 3913, 1: 3778})

Epoch :  21 loss training:  2.9123360051307827 Time :  15167
accuracy train: 0.995960 val: 0.974545 test: 0.974886
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({1: 3923, 0: 3768})

Epoch :  22 loss training:  2.740253370255232 Time :  15210
accuracy train: 0.995960 val: 0.970909 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({0: 3926, 1: 3765})

Epoch :  23 loss training:  2.8700793641037308 Time :  15235
accuracy train: 0.996162 val: 0.970909 test: 0.975799
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({0: 3926, 1: 3765})

Epoch :  24 loss training:  2.668359066301491 Time :  15260
accuracy train: 0.996162 val: 0.970909 test: 0.975342
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({0: 3928, 1: 3763})

Epoch :  25 loss training:  2.3072972766822204 Time :  15286
accuracy train: 0.995960 val: 0.974545 test: 0.974886
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({0: 3928, 1: 3763})

Epoch :  26 loss training:  2.474322620226303 Time :  15312
accuracy train: 0.996162 val: 0.972727 test: 0.974429
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({0: 3927, 1: 3764})

Epoch :  27 loss training:  2.6069074070837814 Time :  15347
accuracy train: 0.996566 val: 0.967273 test: 0.974886
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({0: 3926, 1: 3765})

Epoch :  28 loss training:  2.1088221079553477 Time :  15379
accuracy train: 0.996768 val: 0.970909 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({0: 3928, 1: 3763})

Epoch :  29 loss training:  2.740746426396072 Time :  15405
accuracy train: 0.996566 val: 0.970909 test: 0.974429
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({0: 3929, 1: 3762})

Epoch :  30 loss training:  2.7762256491114385 Time :  15429
accuracy train: 0.996970 val: 0.969091 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({0: 3930, 1: 3761})

Epoch :  31 loss training:  1.8621056694246363 Time :  15455
accuracy train: 0.996970 val: 0.972727 test: 0.975799
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({0: 3930, 1: 3761})

Epoch :  32 loss training:  2.3214973053254653 Time :  15480
accuracy train: 0.996566 val: 0.974545 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({1: 3931, 0: 3760})

Epoch :  33 loss training:  2.145379143723403 Time :  15516
accuracy train: 0.996566 val: 0.972727 test: 0.975799
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({0: 3931, 1: 3760})

Epoch :  34 loss training:  1.717777433397714 Time :  15544
accuracy train: 0.996768 val: 0.970909 test: 0.974886
max validation accuracy : 0.974545 max acc epoch : 3 test accuracy : 0.959817
Counter({0: 3931, 1: 3760})

========================================================================================================================================================================================================
max acc epoch :  3
max validation accuracy :  0.9745454545454545
test accuracy :  0.9598173515981735
last test_accuracy :  0.9748858447488584
second best val :  0.9727272727272728
second best test :  0.9684931506849315
max gap 1
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 max_acc epoch :  15 	 val_accuracy : 0.97818 	 test_accuracy : 0.97489 	 last test_accuracy : 0.97260 	 second best val : 0.97636 	 second best test : 0.97215
k :  1 	 max_acc epoch :  15 	 val_accuracy : 0.97818 	 test_accuracy : 0.97626 	 last test_accuracy : 0.97169 	 second best val : 0.97636 	 second best test : 0.97397
k :  2 	 max_acc epoch :  21 	 val_accuracy : 0.98000 	 test_accuracy : 0.97397 	 last test_accuracy : 0.97443 	 second best val : 0.97818 	 second best test : 0.97169
k :  3 	 max_acc epoch :  21 	 val_accuracy : 0.97818 	 test_accuracy : 0.97443 	 last test_accuracy : 0.97808 	 second best val : 0.97636 	 second best test : 0.97443
k :  4 	 max_acc epoch :  21 	 val_accuracy : 0.98000 	 test_accuracy : 0.97443 	 last test_accuracy : 0.97397 	 second best val : 0.97636 	 second best test : 0.97169
k :  5 	 max_acc epoch :  9 	 val_accuracy : 0.97818 	 test_accuracy : 0.97580 	 last test_accuracy : 0.97352 	 second best val : 0.97636 	 second best test : 0.97580
k :  6 	 max_acc epoch :  21 	 val_accuracy : 0.97818 	 test_accuracy : 0.97260 	 last test_accuracy : 0.97306 	 second best val : 0.97636 	 second best test : 0.97443
k :  7 	 max_acc epoch :  21 	 val_accuracy : 0.98000 	 test_accuracy : 0.97260 	 last test_accuracy : 0.97717 	 second best val : 0.97818 	 second best test : 0.97443
k :  8 	 max_acc epoch :  15 	 val_accuracy : 0.97818 	 test_accuracy : 0.97397 	 last test_accuracy : 0.97123 	 second best val : 0.97636 	 second best test : 0.96484
k :  9 	 max_acc epoch :  3 	 val_accuracy : 0.97455 	 test_accuracy : 0.95982 	 last test_accuracy : 0.97489 	 second best val : 0.97273 	 second best test : 0.96849
(5,)

avg :  	 val_accuracy : 0.97836 	 test_accuracy : 0.97288 	 last_accuracy : 0.97406 	 second best val : 0.97636 	 second best test : 0.97219

std :  	 val_accuracy : 0.00151 	 test_accuracy : 0.00449 	 last_accuracy : 0.00209 	 second best val : 0.00141 	 second best test : 0.00315
