

date and time :  Sun Jul  4 20:21:23 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=81, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  41.236529756337404 Time :  16
accuracy train: 0.967921 val: 0.949091 test: 0.959361
max validation accuracy : 0.949091 max acc epoch : 1 test accuracy : 0.959361
Epoch-1 lr: 0.001

Epoch :  2 loss training:  16.643820835277438 Time :  27
accuracy train: 0.973054 val: 0.957576 test: 0.963470
max validation accuracy : 0.957576 max acc epoch : 2 test accuracy : 0.963470
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.362037953920662 Time :  37
accuracy train: 0.969632 val: 0.953939 test: 0.957991
max validation accuracy : 0.957576 max acc epoch : 2 test accuracy : 0.963470
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.747286637779325 Time :  46
accuracy train: 0.982250 val: 0.961212 test: 0.967580
max validation accuracy : 0.961212 max acc epoch : 4 test accuracy : 0.967580
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.179628386860713 Time :  56
accuracy train: 0.986099 val: 0.970909 test: 0.963470
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.963470
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.362632527016103 Time :  66
accuracy train: 0.988238 val: 0.970909 test: 0.964840
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.963470
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  5.758791233180091 Time :  76
accuracy train: 0.991446 val: 0.972121 test: 0.966667
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.966667
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.805242225411348 Time :  85
accuracy train: 0.993157 val: 0.969697 test: 0.966210
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.966667
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.475497509934939 Time :  95
accuracy train: 0.992729 val: 0.970909 test: 0.968037
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.966667
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.260948352981359 Time :  105
accuracy train: 0.993798 val: 0.968485 test: 0.971689
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.966667

Epoch :  11 loss training:  4.341493202780839 Time :  116
accuracy train: 0.995295 val: 0.968485 test: 0.969863
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.966667

Epoch :  12 loss training:  4.189214644022286 Time :  126
accuracy train: 0.995509 val: 0.970909 test: 0.970776
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.966667

Epoch :  13 loss training:  4.3976071127690375 Time :  137
accuracy train: 0.995509 val: 0.970909 test: 0.966667
max validation accuracy : 0.972121 max acc epoch : 7 test accuracy : 0.966667

Epoch :  14 loss training:  3.8107813265523873 Time :  147
accuracy train: 0.995937 val: 0.973333 test: 0.969406
max validation accuracy : 0.973333 max acc epoch : 14 test accuracy : 0.969406

Epoch :  15 loss training:  3.7936294710380025 Time :  158
accuracy train: 0.996151 val: 0.969697 test: 0.971689
max validation accuracy : 0.973333 max acc epoch : 14 test accuracy : 0.969406

Epoch :  16 loss training:  3.134833349031396 Time :  168
accuracy train: 0.996578 val: 0.968485 test: 0.971233
max validation accuracy : 0.973333 max acc epoch : 14 test accuracy : 0.969406

Epoch :  17 loss training:  3.2833515387028456 Time :  179
accuracy train: 0.996151 val: 0.973333 test: 0.970320
max validation accuracy : 0.973333 max acc epoch : 14 test accuracy : 0.969406

Epoch :  18 loss training:  2.7510385577916168 Time :  190
accuracy train: 0.996364 val: 0.970909 test: 0.968037
max validation accuracy : 0.973333 max acc epoch : 14 test accuracy : 0.969406

Epoch :  19 loss training:  2.7166119191097096 Time :  200
accuracy train: 0.996364 val: 0.970909 test: 0.971233
max validation accuracy : 0.973333 max acc epoch : 14 test accuracy : 0.969406

Epoch :  20 loss training:  2.5203772124659736 Time :  211
accuracy train: 0.996792 val: 0.972121 test: 0.967580
max validation accuracy : 0.973333 max acc epoch : 14 test accuracy : 0.969406

Epoch :  21 loss training:  2.729074274771847 Time :  222
accuracy train: 0.996792 val: 0.970909 test: 0.969406
max validation accuracy : 0.973333 max acc epoch : 14 test accuracy : 0.969406

Epoch :  22 loss training:  2.3832175818970427 Time :  233
accuracy train: 0.996578 val: 0.972121 test: 0.970776
max validation accuracy : 0.973333 max acc epoch : 14 test accuracy : 0.969406

Epoch :  23 loss training:  2.5092871870147064 Time :  244
accuracy train: 0.996792 val: 0.972121 test: 0.963470
max validation accuracy : 0.973333 max acc epoch : 14 test accuracy : 0.969406

Epoch :  24 loss training:  2.380013573128963 Time :  254
accuracy train: 0.996578 val: 0.973333 test: 0.967123
max validation accuracy : 0.973333 max acc epoch : 14 test accuracy : 0.969406

Epoch :  25 loss training:  2.4888431186554953 Time :  265
accuracy train: 0.994440 val: 0.970909 test: 0.966210
max validation accuracy : 0.973333 max acc epoch : 14 test accuracy : 0.969406

Epoch :  26 loss training:  2.087545638622032 Time :  276
accuracy train: 0.997006 val: 0.970909 test: 0.969406
max validation accuracy : 0.973333 max acc epoch : 14 test accuracy : 0.969406

Epoch :  27 loss training:  2.136053010704927 Time :  287
accuracy train: 0.997006 val: 0.972121 test: 0.969406
max validation accuracy : 0.973333 max acc epoch : 14 test accuracy : 0.969406

Epoch :  28 loss training:  2.025531305160257 Time :  298
accuracy train: 0.996792 val: 0.970909 test: 0.969406
max validation accuracy : 0.973333 max acc epoch : 14 test accuracy : 0.969406

Epoch :  29 loss training:  2.1641132363292854 Time :  309
accuracy train: 0.997006 val: 0.972121 test: 0.968950
max validation accuracy : 0.973333 max acc epoch : 14 test accuracy : 0.969406

Epoch :  30 loss training:  1.990438971290132 Time :  319
accuracy train: 0.997006 val: 0.973333 test: 0.970776
max validation accuracy : 0.973333 max acc epoch : 14 test accuracy : 0.969406

Epoch :  31 loss training:  1.9481061718979618 Time :  330
accuracy train: 0.997220 val: 0.968485 test: 0.968950
max validation accuracy : 0.973333 max acc epoch : 14 test accuracy : 0.969406

Epoch :  32 loss training:  1.5612098188867094 Time :  341
accuracy train: 0.997006 val: 0.969697 test: 0.967580
max validation accuracy : 0.973333 max acc epoch : 14 test accuracy : 0.969406

Epoch :  33 loss training:  1.6817244759185996 Time :  351
accuracy train: 0.997220 val: 0.973333 test: 0.969863
max validation accuracy : 0.973333 max acc epoch : 14 test accuracy : 0.969406

Epoch :  34 loss training:  1.546736042611883 Time :  363
accuracy train: 0.997220 val: 0.974545 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 34 test accuracy : 0.968493

Epoch :  35 loss training:  2.084744468302233 Time :  374
accuracy train: 0.997006 val: 0.968485 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 34 test accuracy : 0.968493

Epoch :  36 loss training:  1.6570759753740276 Time :  384
accuracy train: 0.997006 val: 0.968485 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 34 test accuracy : 0.968493

Epoch :  37 loss training:  1.7608849782991456 Time :  395
accuracy train: 0.997220 val: 0.969697 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 34 test accuracy : 0.968493

Epoch :  38 loss training:  1.7496938858967042 Time :  405
accuracy train: 0.997006 val: 0.973333 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 34 test accuracy : 0.968493

Epoch :  39 loss training:  2.046441795435385 Time :  416
accuracy train: 0.997006 val: 0.966061 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 34 test accuracy : 0.968493

Epoch :  40 loss training:  1.6572137956973165 Time :  426
accuracy train: 0.997220 val: 0.970909 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 34 test accuracy : 0.968493

Epoch :  41 loss training:  1.6735705977371254 Time :  437
accuracy train: 0.997220 val: 0.966061 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 34 test accuracy : 0.968493

Epoch :  42 loss training:  1.6757721852773102 Time :  447
accuracy train: 0.997220 val: 0.970909 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 34 test accuracy : 0.968493

Epoch :  43 loss training:  1.402670845571265 Time :  457
accuracy train: 0.997006 val: 0.972121 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 34 test accuracy : 0.968493

Epoch :  44 loss training:  1.63961058230052 Time :  468
accuracy train: 0.997006 val: 0.970909 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 34 test accuracy : 0.968493

Epoch :  45 loss training:  1.7301651795005455 Time :  479
accuracy train: 0.997006 val: 0.968485 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 34 test accuracy : 0.968493

Epoch :  46 loss training:  1.5997361664267373 Time :  489
accuracy train: 0.997006 val: 0.973333 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 34 test accuracy : 0.968493

Epoch :  47 loss training:  1.516374938095396 Time :  500
accuracy train: 0.997220 val: 0.973333 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 34 test accuracy : 0.968493

Epoch :  48 loss training:  1.7764393609177205 Time :  511
accuracy train: 0.997220 val: 0.973333 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 34 test accuracy : 0.968493

Epoch :  49 loss training:  1.6205724594547064 Time :  521
accuracy train: 0.997006 val: 0.976970 test: 0.968493
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  50 loss training:  1.322036844536342 Time :  532
accuracy train: 0.997220 val: 0.974545 test: 0.969863
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  51 loss training:  1.5249285207744947 Time :  542
accuracy train: 0.997006 val: 0.972121 test: 0.971689
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  52 loss training:  1.6959792916768492 Time :  553
accuracy train: 0.997220 val: 0.970909 test: 0.968950
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  53 loss training:  1.4449287782663305 Time :  564
accuracy train: 0.997006 val: 0.973333 test: 0.971689
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  54 loss training:  1.5848972832063737 Time :  574
accuracy train: 0.997006 val: 0.969697 test: 0.968950
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  55 loss training:  1.3355426961825287 Time :  585
accuracy train: 0.996792 val: 0.972121 test: 0.967123
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  56 loss training:  1.6062686250952538 Time :  595
accuracy train: 0.997006 val: 0.974545 test: 0.969863
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  57 loss training:  1.466482090529098 Time :  606
accuracy train: 0.997006 val: 0.968485 test: 0.968493
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  58 loss training:  1.5205550438386126 Time :  616
accuracy train: 0.997006 val: 0.970909 test: 0.968037
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  59 loss training:  1.6812001292601053 Time :  627
accuracy train: 0.997220 val: 0.970909 test: 0.972146
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  60 loss training:  1.4271903668959567 Time :  638
accuracy train: 0.997006 val: 0.970909 test: 0.970320
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  61 loss training:  1.6782365684362048 Time :  648
accuracy train: 0.997006 val: 0.975758 test: 0.969406
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  62 loss training:  1.6680367763701724 Time :  659
accuracy train: 0.997006 val: 0.968485 test: 0.969406
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  63 loss training:  1.6113883831603744 Time :  669
accuracy train: 0.997220 val: 0.968485 test: 0.965753
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  64 loss training:  1.4770525558378722 Time :  680
accuracy train: 0.997006 val: 0.964848 test: 0.969863
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  65 loss training:  1.3019067863097007 Time :  690
accuracy train: 0.997220 val: 0.970909 test: 0.968950
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  66 loss training:  1.4208071157645463 Time :  701
accuracy train: 0.997006 val: 0.973333 test: 0.970776
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  67 loss training:  1.347088529721077 Time :  711
accuracy train: 0.997220 val: 0.969697 test: 0.968037
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  68 loss training:  1.1477025544882054 Time :  722
accuracy train: 0.997220 val: 0.970909 test: 0.967123
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  69 loss training:  1.2921104098295473 Time :  732
accuracy train: 0.997220 val: 0.968485 test: 0.967580
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  70 loss training:  1.3790500354189135 Time :  742
accuracy train: 0.997220 val: 0.974545 test: 0.967580
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  71 loss training:  1.2677503513355077 Time :  753
accuracy train: 0.997220 val: 0.973333 test: 0.967580
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  72 loss training:  1.2680943996638234 Time :  763
accuracy train: 0.997220 val: 0.970909 test: 0.969863
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  73 loss training:  1.2661520610718071 Time :  774
accuracy train: 0.997220 val: 0.969697 test: 0.971233
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  74 loss training:  1.3063752435991773 Time :  784
accuracy train: 0.997006 val: 0.967273 test: 0.969863
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  75 loss training:  1.3754965329908373 Time :  795
accuracy train: 0.997220 val: 0.974545 test: 0.971689
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  76 loss training:  1.2797603158669517 Time :  806
accuracy train: 0.997006 val: 0.972121 test: 0.967580
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  77 loss training:  1.3773684329134994 Time :  816
accuracy train: 0.997220 val: 0.966061 test: 0.970776
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  78 loss training:  1.424822735843918 Time :  827
accuracy train: 0.997220 val: 0.967273 test: 0.969406
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  79 loss training:  1.5829768489802518 Time :  837
accuracy train: 0.997220 val: 0.967273 test: 0.972146
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

Epoch :  80 loss training:  1.3832510351903693 Time :  848
accuracy train: 0.997220 val: 0.973333 test: 0.971233
max validation accuracy : 0.976970 max acc epoch : 49 test accuracy : 0.968493

========================================================================================================================================================================================================
best acc epoch :  49
validation accuracy :  0.9769696969696969
test accuracy :  0.9684931506849315
last test_accuracy :  0.9712328767123287
second best val :  0.9757575757575757
second best test :  0.9684931506849315
max gap 20
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=0, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=79, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  38.73347964882851 Time :  859
accuracy train: 0.958725 val: 0.944242 test: 0.946119
max validation accuracy : 0.944242 max acc epoch : 1 test accuracy : 0.946119
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.82873808091972 Time :  869
accuracy train: 0.972412 val: 0.957576 test: 0.947945
max validation accuracy : 0.957576 max acc epoch : 2 test accuracy : 0.947945
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.614449091255665 Time :  878
accuracy train: 0.979897 val: 0.963636 test: 0.963927
max validation accuracy : 0.963636 max acc epoch : 3 test accuracy : 0.963927
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.760044660419226 Time :  888
accuracy train: 0.981608 val: 0.969697 test: 0.964840
max validation accuracy : 0.969697 max acc epoch : 4 test accuracy : 0.964840
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.992540658451617 Time :  898
accuracy train: 0.984388 val: 0.966061 test: 0.965297
max validation accuracy : 0.969697 max acc epoch : 4 test accuracy : 0.964840
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.716370537877083 Time :  907
accuracy train: 0.990590 val: 0.975758 test: 0.968493
max validation accuracy : 0.975758 max acc epoch : 6 test accuracy : 0.968493
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.638981352793053 Time :  917
accuracy train: 0.989307 val: 0.968485 test: 0.967123
max validation accuracy : 0.975758 max acc epoch : 6 test accuracy : 0.968493
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  7.048914355575107 Time :  927
accuracy train: 0.992515 val: 0.973333 test: 0.967123
max validation accuracy : 0.975758 max acc epoch : 6 test accuracy : 0.968493
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.478319495916367 Time :  937
accuracy train: 0.992943 val: 0.970909 test: 0.972146
max validation accuracy : 0.975758 max acc epoch : 6 test accuracy : 0.968493
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.664572662091814 Time :  947
accuracy train: 0.993584 val: 0.970909 test: 0.972603
max validation accuracy : 0.975758 max acc epoch : 6 test accuracy : 0.968493

Epoch :  11 loss training:  5.075462688691914 Time :  958
accuracy train: 0.993370 val: 0.969697 test: 0.969406
max validation accuracy : 0.975758 max acc epoch : 6 test accuracy : 0.968493

Epoch :  12 loss training:  4.540897964441683 Time :  968
accuracy train: 0.994226 val: 0.974545 test: 0.968950
max validation accuracy : 0.975758 max acc epoch : 6 test accuracy : 0.968493

Epoch :  13 loss training:  4.734866695711389 Time :  979
accuracy train: 0.995509 val: 0.974545 test: 0.967123
max validation accuracy : 0.975758 max acc epoch : 6 test accuracy : 0.968493

Epoch :  14 loss training:  3.8093821936054155 Time :  989
accuracy train: 0.995509 val: 0.970909 test: 0.968950
max validation accuracy : 0.975758 max acc epoch : 6 test accuracy : 0.968493

Epoch :  15 loss training:  4.369583990541287 Time :  1000
accuracy train: 0.995295 val: 0.973333 test: 0.969863
max validation accuracy : 0.975758 max acc epoch : 6 test accuracy : 0.968493

Epoch :  16 loss training:  3.4206139666202944 Time :  1011
accuracy train: 0.995723 val: 0.975758 test: 0.969406
max validation accuracy : 0.975758 max acc epoch : 6 test accuracy : 0.968493

Epoch :  17 loss training:  4.461327021592297 Time :  1021
accuracy train: 0.995509 val: 0.979394 test: 0.968950
max validation accuracy : 0.979394 max acc epoch : 17 test accuracy : 0.968950

Epoch :  18 loss training:  3.2994941371143796 Time :  1032
accuracy train: 0.995723 val: 0.973333 test: 0.965753
max validation accuracy : 0.979394 max acc epoch : 17 test accuracy : 0.968950

Epoch :  19 loss training:  2.8678018108475953 Time :  1043
accuracy train: 0.995723 val: 0.970909 test: 0.968037
max validation accuracy : 0.979394 max acc epoch : 17 test accuracy : 0.968950

Epoch :  20 loss training:  2.8209868364501745 Time :  1054
accuracy train: 0.996364 val: 0.969697 test: 0.964384
max validation accuracy : 0.979394 max acc epoch : 17 test accuracy : 0.968950

Epoch :  21 loss training:  2.4908821029239334 Time :  1064
accuracy train: 0.996364 val: 0.974545 test: 0.966667
max validation accuracy : 0.979394 max acc epoch : 17 test accuracy : 0.968950

Epoch :  22 loss training:  2.7111365279124584 Time :  1075
accuracy train: 0.996364 val: 0.975758 test: 0.967580
max validation accuracy : 0.979394 max acc epoch : 17 test accuracy : 0.968950

Epoch :  23 loss training:  2.826155563700013 Time :  1087
accuracy train: 0.996792 val: 0.972121 test: 0.972146
max validation accuracy : 0.979394 max acc epoch : 17 test accuracy : 0.968950

Epoch :  24 loss training:  2.1526224184781313 Time :  1098
accuracy train: 0.996151 val: 0.975758 test: 0.968950
max validation accuracy : 0.979394 max acc epoch : 17 test accuracy : 0.968950

Epoch :  25 loss training:  2.3013303019615705 Time :  1108
accuracy train: 0.997220 val: 0.978182 test: 0.966667
max validation accuracy : 0.979394 max acc epoch : 17 test accuracy : 0.968950

Epoch :  26 loss training:  2.652911356621189 Time :  1119
accuracy train: 0.996792 val: 0.973333 test: 0.971233
max validation accuracy : 0.979394 max acc epoch : 17 test accuracy : 0.968950

Epoch :  27 loss training:  1.9770463140448555 Time :  1129
accuracy train: 0.996578 val: 0.975758 test: 0.968037
max validation accuracy : 0.979394 max acc epoch : 17 test accuracy : 0.968950

Epoch :  28 loss training:  2.0257622712670127 Time :  1141
accuracy train: 0.997220 val: 0.975758 test: 0.972146
max validation accuracy : 0.979394 max acc epoch : 17 test accuracy : 0.968950

Epoch :  29 loss training:  1.9990839461097494 Time :  1152
accuracy train: 0.997006 val: 0.974545 test: 0.972146
max validation accuracy : 0.979394 max acc epoch : 17 test accuracy : 0.968950

Epoch :  30 loss training:  1.816344239632599 Time :  1163
accuracy train: 0.996792 val: 0.976970 test: 0.969863
max validation accuracy : 0.979394 max acc epoch : 17 test accuracy : 0.968950

Epoch :  31 loss training:  1.9058021056989674 Time :  1174
accuracy train: 0.997220 val: 0.973333 test: 0.970320
max validation accuracy : 0.979394 max acc epoch : 17 test accuracy : 0.968950

Epoch :  32 loss training:  2.0372063788563537 Time :  1186
accuracy train: 0.997006 val: 0.972121 test: 0.963927
max validation accuracy : 0.979394 max acc epoch : 17 test accuracy : 0.968950

Epoch :  33 loss training:  1.9030929190630559 Time :  1197
accuracy train: 0.997006 val: 0.981818 test: 0.969406
max validation accuracy : 0.981818 max acc epoch : 33 test accuracy : 0.969406

Epoch :  34 loss training:  1.6997729252179852 Time :  1209
accuracy train: 0.997220 val: 0.983030 test: 0.968037
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  35 loss training:  2.155623906357505 Time :  1219
accuracy train: 0.997006 val: 0.975758 test: 0.968037
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  36 loss training:  1.8165220170776593 Time :  1230
accuracy train: 0.996792 val: 0.972121 test: 0.962100
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  37 loss training:  1.7800805415899958 Time :  1241
accuracy train: 0.996792 val: 0.969697 test: 0.966667
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  38 loss training:  1.7090095206804108 Time :  1252
accuracy train: 0.996792 val: 0.972121 test: 0.968493
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  39 loss training:  1.813845942269836 Time :  1263
accuracy train: 0.997434 val: 0.975758 test: 0.969863
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  40 loss training:  1.4739486247708555 Time :  1273
accuracy train: 0.996792 val: 0.974545 test: 0.969406
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  41 loss training:  1.7587919897632673 Time :  1284
accuracy train: 0.997220 val: 0.976970 test: 0.965753
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  42 loss training:  1.5207014530169545 Time :  1294
accuracy train: 0.996792 val: 0.974545 test: 0.968950
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  43 loss training:  1.5608370243644458 Time :  1305
accuracy train: 0.997006 val: 0.969697 test: 0.968493
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  44 loss training:  1.5270150379619736 Time :  1317
accuracy train: 0.997648 val: 0.972121 test: 0.966210
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  45 loss training:  1.4009668792423327 Time :  1328
accuracy train: 0.996792 val: 0.976970 test: 0.967123
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  46 loss training:  1.4732651198210078 Time :  1338
accuracy train: 0.997006 val: 0.972121 test: 0.965753
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  47 loss training:  1.287048202175356 Time :  1349
accuracy train: 0.996792 val: 0.974545 test: 0.968950
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  48 loss training:  1.4494524985075259 Time :  1360
accuracy train: 0.997220 val: 0.981818 test: 0.970776
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  49 loss training:  1.4898524296295363 Time :  1370
accuracy train: 0.996792 val: 0.983030 test: 0.966210
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  50 loss training:  1.4507006651147094 Time :  1380
accuracy train: 0.996792 val: 0.979394 test: 0.966667
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  51 loss training:  1.4332476561139629 Time :  1391
accuracy train: 0.996792 val: 0.979394 test: 0.964840
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  52 loss training:  1.5971481253018283 Time :  1402
accuracy train: 0.997220 val: 0.973333 test: 0.967580
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  53 loss training:  1.2691527768329252 Time :  1412
accuracy train: 0.997220 val: 0.979394 test: 0.963470
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  54 loss training:  1.308845888630458 Time :  1423
accuracy train: 0.996792 val: 0.975758 test: 0.968037
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  55 loss training:  1.3558156654953564 Time :  1433
accuracy train: 0.997220 val: 0.974545 test: 0.969863
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  56 loss training:  1.4182356497894943 Time :  1443
accuracy train: 0.997006 val: 0.973333 test: 0.968950
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  57 loss training:  1.5303739946466521 Time :  1454
accuracy train: 0.997648 val: 0.974545 test: 0.967123
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  58 loss training:  1.5271059094011434 Time :  1464
accuracy train: 0.997006 val: 0.973333 test: 0.970776
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  59 loss training:  1.4742920581891212 Time :  1475
accuracy train: 0.997220 val: 0.974545 test: 0.968493
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  60 loss training:  1.5026054677127831 Time :  1485
accuracy train: 0.997220 val: 0.978182 test: 0.968493
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  61 loss training:  1.332423189192923 Time :  1495
accuracy train: 0.996578 val: 0.975758 test: 0.968493
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  62 loss training:  1.7293670716685483 Time :  1506
accuracy train: 0.997220 val: 0.975758 test: 0.970320
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  63 loss training:  1.4771101546157297 Time :  1516
accuracy train: 0.996792 val: 0.976970 test: 0.967123
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  64 loss training:  1.4550355640458292 Time :  1527
accuracy train: 0.997220 val: 0.972121 test: 0.968037
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

Epoch :  65 loss training:  1.2899116379849147 Time :  1537
accuracy train: 0.997220 val: 0.974545 test: 0.968037
max validation accuracy : 0.983030 max acc epoch : 34 test accuracy : 0.968037

========================================================================================================================================================================================================
best acc epoch :  34
validation accuracy :  0.983030303030303
test accuracy :  0.9680365296803652
last test_accuracy :  0.9680365296803652
second best val :  0.9818181818181818
second best test :  0.9694063926940639
max gap 16
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  49 	 val_accuracy : 0.97697 	 test_accuracy : 0.96849 	 last test_accuracy : 0.97123 	 second best val : 0.97576 	 second best test : 0.96849
k :  1 	 best_acc epoch :  34 	 val_accuracy : 0.98303 	 test_accuracy : 0.96804 	 last test_accuracy : 0.96804 	 second best val : 0.98182 	 second best test : 0.96941

avg :  	 val_accuracy : 0.98000 	 test_accuracy : 0.96826 	 last_accuracy : 0.96963 	 second best val : 0.97879 	 second best test : 0.96895

std :  	 val_accuracy : 0.00303 	 test_accuracy : 0.00023 	 last_accuracy : 0.00160 	 second best val : 0.00303 	 second best test : 0.00046


date and time :  Sun Jul  4 20:47:09 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=65, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  38.22608236875385 Time :  12
accuracy train: 0.949316 val: 0.940606 test: 0.947945
max validation accuracy : 0.940606 max acc epoch : 1 test accuracy : 0.947945
Epoch-1 lr: 0.001

Epoch :  2 loss training:  20.499204436317086 Time :  24
accuracy train: 0.976689 val: 0.970909 test: 0.965297
max validation accuracy : 0.970909 max acc epoch : 2 test accuracy : 0.965297
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.04065476404503 Time :  36
accuracy train: 0.973482 val: 0.964848 test: 0.957991
max validation accuracy : 0.970909 max acc epoch : 2 test accuracy : 0.965297
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.33100645407103 Time :  48
accuracy train: 0.986313 val: 0.974545 test: 0.963470
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.963470
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.121302628424019 Time :  60
accuracy train: 0.987169 val: 0.974545 test: 0.968037
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.963470
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.569343414157629 Time :  72
accuracy train: 0.986741 val: 0.972121 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.963470
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.234911891631782 Time :  83
accuracy train: 0.990590 val: 0.974545 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.963470
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.66151034788345 Time :  95
accuracy train: 0.991232 val: 0.975758 test: 0.972603
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.972603
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.466635375865735 Time :  106
accuracy train: 0.992515 val: 0.976970 test: 0.968950
max validation accuracy : 0.976970 max acc epoch : 9 test accuracy : 0.968950
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.9941708776168525 Time :  118
accuracy train: 0.991873 val: 0.980606 test: 0.973059
max validation accuracy : 0.980606 max acc epoch : 10 test accuracy : 0.973059

Epoch :  11 loss training:  5.660625452830573 Time :  130
accuracy train: 0.992729 val: 0.978182 test: 0.970776
max validation accuracy : 0.980606 max acc epoch : 10 test accuracy : 0.973059

Epoch :  12 loss training:  5.1361696070525795 Time :  143
accuracy train: 0.993370 val: 0.978182 test: 0.972603
max validation accuracy : 0.980606 max acc epoch : 10 test accuracy : 0.973059

Epoch :  13 loss training:  4.559319150168449 Time :  155
accuracy train: 0.994440 val: 0.979394 test: 0.973973
max validation accuracy : 0.980606 max acc epoch : 10 test accuracy : 0.973059

Epoch :  14 loss training:  4.340675043495139 Time :  168
accuracy train: 0.994654 val: 0.978182 test: 0.970320
max validation accuracy : 0.980606 max acc epoch : 10 test accuracy : 0.973059

Epoch :  15 loss training:  4.626508659683168 Time :  180
accuracy train: 0.992515 val: 0.979394 test: 0.970776
max validation accuracy : 0.980606 max acc epoch : 10 test accuracy : 0.973059

Epoch :  16 loss training:  3.724670398631133 Time :  193
accuracy train: 0.994654 val: 0.975758 test: 0.968037
max validation accuracy : 0.980606 max acc epoch : 10 test accuracy : 0.973059

Epoch :  17 loss training:  3.490008897788357 Time :  206
accuracy train: 0.994440 val: 0.980606 test: 0.975799
max validation accuracy : 0.980606 max acc epoch : 10 test accuracy : 0.973059

Epoch :  18 loss training:  3.239882124296855 Time :  219
accuracy train: 0.995509 val: 0.980606 test: 0.972146
max validation accuracy : 0.980606 max acc epoch : 10 test accuracy : 0.973059

Epoch :  19 loss training:  3.3659951837325934 Time :  232
accuracy train: 0.995081 val: 0.978182 test: 0.977169
max validation accuracy : 0.980606 max acc epoch : 10 test accuracy : 0.973059

Epoch :  20 loss training:  2.8957112772041 Time :  245
accuracy train: 0.995509 val: 0.975758 test: 0.973059
max validation accuracy : 0.980606 max acc epoch : 10 test accuracy : 0.973059

Epoch :  21 loss training:  3.1478824431833345 Time :  257
accuracy train: 0.995723 val: 0.978182 test: 0.973973
max validation accuracy : 0.980606 max acc epoch : 10 test accuracy : 0.973059

Epoch :  22 loss training:  3.086183225357672 Time :  270
accuracy train: 0.995723 val: 0.978182 test: 0.975799
max validation accuracy : 0.980606 max acc epoch : 10 test accuracy : 0.973059

Epoch :  23 loss training:  2.91721116140252 Time :  283
accuracy train: 0.995723 val: 0.979394 test: 0.973973
max validation accuracy : 0.980606 max acc epoch : 10 test accuracy : 0.973059

Epoch :  24 loss training:  2.7239320283697452 Time :  296
accuracy train: 0.995937 val: 0.979394 test: 0.973973
max validation accuracy : 0.980606 max acc epoch : 10 test accuracy : 0.973059

Epoch :  25 loss training:  3.0949598899751436 Time :  308
accuracy train: 0.995723 val: 0.972121 test: 0.969406
max validation accuracy : 0.980606 max acc epoch : 10 test accuracy : 0.973059

Epoch :  26 loss training:  2.4658457564364653 Time :  322
accuracy train: 0.995295 val: 0.978182 test: 0.977169
max validation accuracy : 0.980606 max acc epoch : 10 test accuracy : 0.973059

Epoch :  27 loss training:  2.324909108807333 Time :  335
accuracy train: 0.996578 val: 0.976970 test: 0.971689
max validation accuracy : 0.980606 max acc epoch : 10 test accuracy : 0.973059

Epoch :  28 loss training:  2.205140148405917 Time :  347
accuracy train: 0.996792 val: 0.978182 test: 0.975342
max validation accuracy : 0.980606 max acc epoch : 10 test accuracy : 0.973059

Epoch :  29 loss training:  2.294506886493764 Time :  360
accuracy train: 0.996364 val: 0.978182 test: 0.969863
max validation accuracy : 0.980606 max acc epoch : 10 test accuracy : 0.973059

Epoch :  30 loss training:  2.494287725261529 Time :  372
accuracy train: 0.996578 val: 0.979394 test: 0.972603
max validation accuracy : 0.980606 max acc epoch : 10 test accuracy : 0.973059

Epoch :  31 loss training:  2.0502457109978423 Time :  385
accuracy train: 0.996792 val: 0.983030 test: 0.974429
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  32 loss training:  1.9105878108966863 Time :  397
accuracy train: 0.997006 val: 0.979394 test: 0.972603
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  33 loss training:  2.304736379577662 Time :  410
accuracy train: 0.996792 val: 0.979394 test: 0.972603
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  34 loss training:  2.1271280227956595 Time :  422
accuracy train: 0.996792 val: 0.980606 test: 0.974429
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  35 loss training:  2.1301421750504232 Time :  435
accuracy train: 0.997006 val: 0.975758 test: 0.968493
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  36 loss training:  1.8644855224265484 Time :  447
accuracy train: 0.996792 val: 0.980606 test: 0.969406
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  37 loss training:  1.897559117358469 Time :  460
accuracy train: 0.997006 val: 0.981818 test: 0.974429
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  38 loss training:  1.7973964825068833 Time :  472
accuracy train: 0.997006 val: 0.983030 test: 0.972603
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  39 loss training:  1.8656779780212673 Time :  484
accuracy train: 0.997006 val: 0.975758 test: 0.967580
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  40 loss training:  1.9837697959519573 Time :  497
accuracy train: 0.996792 val: 0.981818 test: 0.969406
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  41 loss training:  1.7451317163940985 Time :  509
accuracy train: 0.997006 val: 0.981818 test: 0.970320
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  42 loss training:  1.6618280714355933 Time :  522
accuracy train: 0.997006 val: 0.978182 test: 0.971233
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  43 loss training:  1.6343668919034826 Time :  534
accuracy train: 0.996792 val: 0.981818 test: 0.970776
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  44 loss training:  1.829628344199591 Time :  546
accuracy train: 0.996578 val: 0.980606 test: 0.966210
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  45 loss training:  1.896029970699601 Time :  559
accuracy train: 0.997220 val: 0.974545 test: 0.973059
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  46 loss training:  3.4110008424613625 Time :  572
accuracy train: 0.997006 val: 0.976970 test: 0.972603
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  47 loss training:  2.523818166475394 Time :  584
accuracy train: 0.997006 val: 0.976970 test: 0.971689
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  48 loss training:  1.902893827893422 Time :  599
accuracy train: 0.996792 val: 0.975758 test: 0.975799
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  49 loss training:  1.7589741265546763 Time :  614
accuracy train: 0.997006 val: 0.980606 test: 0.976256
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  50 loss training:  1.8351025755910086 Time :  628
accuracy train: 0.997220 val: 0.980606 test: 0.970776
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  51 loss training:  1.8324469269136898 Time :  642
accuracy train: 0.997220 val: 0.978182 test: 0.972603
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  52 loss training:  1.9706679481605534 Time :  656
accuracy train: 0.996364 val: 0.975758 test: 0.973516
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  53 loss training:  1.6014085992137552 Time :  670
accuracy train: 0.997220 val: 0.978182 test: 0.975342
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  54 loss training:  1.6495550286035723 Time :  684
accuracy train: 0.997006 val: 0.979394 test: 0.973516
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  55 loss training:  1.5077529471855087 Time :  699
accuracy train: 0.997220 val: 0.978182 test: 0.973516
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  56 loss training:  1.7987355936038512 Time :  714
accuracy train: 0.997006 val: 0.979394 test: 0.972603
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  57 loss training:  1.7249944686482195 Time :  729
accuracy train: 0.997006 val: 0.978182 test: 0.971689
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  58 loss training:  1.431314225166716 Time :  742
accuracy train: 0.997220 val: 0.976970 test: 0.973059
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  59 loss training:  1.5574720260265167 Time :  757
accuracy train: 0.996578 val: 0.976970 test: 0.973516
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  60 loss training:  1.5163034271026845 Time :  771
accuracy train: 0.997220 val: 0.975758 test: 0.972603
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  61 loss training:  1.468904197881784 Time :  784
accuracy train: 0.996792 val: 0.981818 test: 0.970776
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

Epoch :  62 loss training:  1.3563627428848122 Time :  796
accuracy train: 0.997220 val: 0.980606 test: 0.968950
max validation accuracy : 0.983030 max acc epoch : 31 test accuracy : 0.974429

========================================================================================================================================================================================================
best acc epoch :  31
validation accuracy :  0.983030303030303
test accuracy :  0.9744292237442922
last test_accuracy :  0.9689497716894977
second best val :  0.9818181818181818
second best test :  0.9744292237442922
max gap 21
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=1, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=265, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0

Epoch :  1 loss training:  40.4624688513577 Time :  810
accuracy train: 0.964072 val: 0.950303 test: 0.959361
max validation accuracy : 0.950303 max acc epoch : 1 test accuracy : 0.959361
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.544877730309963 Time :  824
accuracy train: 0.973909 val: 0.952727 test: 0.968037
max validation accuracy : 0.952727 max acc epoch : 2 test accuracy : 0.968037
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.194791305577382 Time :  837
accuracy train: 0.975192 val: 0.958788 test: 0.957991
max validation accuracy : 0.958788 max acc epoch : 3 test accuracy : 0.957991
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.57510360935703 Time :  850
accuracy train: 0.984816 val: 0.968485 test: 0.965753
max validation accuracy : 0.968485 max acc epoch : 4 test accuracy : 0.965753
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.287504755659029 Time :  863
accuracy train: 0.979042 val: 0.957576 test: 0.967123
max validation accuracy : 0.968485 max acc epoch : 4 test accuracy : 0.965753
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  7.736589959997218 Time :  876
accuracy train: 0.985244 val: 0.960000 test: 0.969406
max validation accuracy : 0.968485 max acc epoch : 4 test accuracy : 0.965753
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.483096220123116 Time :  890
accuracy train: 0.990590 val: 0.963636 test: 0.969863
max validation accuracy : 0.968485 max acc epoch : 4 test accuracy : 0.965753
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.053030853508972 Time :  903
accuracy train: 0.992087 val: 0.968485 test: 0.966667
max validation accuracy : 0.968485 max acc epoch : 4 test accuracy : 0.965753
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.948461023624986 Time :  917
accuracy train: 0.990590 val: 0.967273 test: 0.964840
max validation accuracy : 0.968485 max acc epoch : 4 test accuracy : 0.965753
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.750809637131169 Time :  930
accuracy train: 0.992301 val: 0.969697 test: 0.970776
max validation accuracy : 0.969697 max acc epoch : 10 test accuracy : 0.970776

Epoch :  11 loss training:  5.640913428273052 Time :  944
accuracy train: 0.992087 val: 0.968485 test: 0.973059
max validation accuracy : 0.969697 max acc epoch : 10 test accuracy : 0.970776

Epoch :  12 loss training:  5.114694069139659 Time :  958
accuracy train: 0.992729 val: 0.964848 test: 0.973516
max validation accuracy : 0.969697 max acc epoch : 10 test accuracy : 0.970776

Epoch :  13 loss training:  4.459369479678571 Time :  973
accuracy train: 0.994440 val: 0.967273 test: 0.973973
max validation accuracy : 0.969697 max acc epoch : 10 test accuracy : 0.970776

Epoch :  14 loss training:  4.386937336530536 Time :  987
accuracy train: 0.995081 val: 0.970909 test: 0.971233
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  15 loss training:  4.095330150972586 Time :  1001
accuracy train: 0.995723 val: 0.969697 test: 0.971233
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  16 loss training:  3.892360998899676 Time :  1015
accuracy train: 0.995081 val: 0.967273 test: 0.972146
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  17 loss training:  3.558085748460144 Time :  1028
accuracy train: 0.994867 val: 0.966061 test: 0.971689
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  18 loss training:  3.4405906447791494 Time :  1042
accuracy train: 0.995295 val: 0.966061 test: 0.971689
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  19 loss training:  3.617379093018826 Time :  1056
accuracy train: 0.995081 val: 0.969697 test: 0.969406
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  20 loss training:  2.989498587907292 Time :  1071
accuracy train: 0.995509 val: 0.967273 test: 0.969406
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  21 loss training:  2.7638784909795504 Time :  1087
accuracy train: 0.994654 val: 0.964848 test: 0.972146
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  22 loss training:  3.1948462351283524 Time :  1101
accuracy train: 0.995937 val: 0.969697 test: 0.974429
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  23 loss training:  2.8201578590087593 Time :  1116
accuracy train: 0.995509 val: 0.961212 test: 0.971233
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  24 loss training:  3.212101183307823 Time :  1130
accuracy train: 0.995937 val: 0.964848 test: 0.975799
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  25 loss training:  2.873127750644926 Time :  1144
accuracy train: 0.995723 val: 0.968485 test: 0.972603
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  26 loss training:  2.408312337443931 Time :  1159
accuracy train: 0.995723 val: 0.962424 test: 0.976712
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  27 loss training:  2.2036196474800818 Time :  1173
accuracy train: 0.995937 val: 0.967273 test: 0.968493
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  28 loss training:  2.4687820874532918 Time :  1187
accuracy train: 0.996151 val: 0.966061 test: 0.972603
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  29 loss training:  2.002262335663545 Time :  1201
accuracy train: 0.996578 val: 0.963636 test: 0.974886
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  30 loss training:  1.892116983384767 Time :  1214
accuracy train: 0.996578 val: 0.967273 test: 0.975799
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  31 loss training:  2.2373653844406363 Time :  1228
accuracy train: 0.996364 val: 0.968485 test: 0.976256
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  32 loss training:  2.050402258930262 Time :  1243
accuracy train: 0.996578 val: 0.966061 test: 0.975799
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  33 loss training:  2.0096542912942823 Time :  1258
accuracy train: 0.996578 val: 0.970909 test: 0.970776
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  34 loss training:  1.8722962905230816 Time :  1274
accuracy train: 0.997220 val: 0.966061 test: 0.974886
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  35 loss training:  1.7575374276493676 Time :  1288
accuracy train: 0.996151 val: 0.968485 test: 0.973516
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  36 loss training:  1.97950736740313 Time :  1302
accuracy train: 0.996364 val: 0.968485 test: 0.976712
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  37 loss training:  1.8735754661611281 Time :  1316
accuracy train: 0.996792 val: 0.970909 test: 0.977626
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  38 loss training:  1.961570759784081 Time :  1330
accuracy train: 0.995937 val: 0.969697 test: 0.975342
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  39 loss training:  1.8472352136304835 Time :  1344
accuracy train: 0.997006 val: 0.964848 test: 0.971689
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  40 loss training:  1.7994269972114125 Time :  1358
accuracy train: 0.997006 val: 0.967273 test: 0.973973
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  41 loss training:  1.7067500057310099 Time :  1372
accuracy train: 0.996578 val: 0.966061 test: 0.968493
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  42 loss training:  1.6719555380441307 Time :  1386
accuracy train: 0.996578 val: 0.970909 test: 0.971689
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  43 loss training:  1.7767176495490276 Time :  1400
accuracy train: 0.996792 val: 0.969697 test: 0.975799
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  44 loss training:  1.811148808330472 Time :  1414
accuracy train: 0.996792 val: 0.964848 test: 0.970320
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

Epoch :  45 loss training:  1.6503917491172615 Time :  1428
accuracy train: 0.996792 val: 0.966061 test: 0.972603
max validation accuracy : 0.970909 max acc epoch : 14 test accuracy : 0.971233

========================================================================================================================================================================================================
best acc epoch :  14
validation accuracy :  0.9709090909090909
test accuracy :  0.9712328767123287
last test_accuracy :  0.9726027397260274
second best val :  0.9696969696969697
second best test :  0.9707762557077626
max gap 6
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  31 	 val_accuracy : 0.98303 	 test_accuracy : 0.97443 	 last test_accuracy : 0.96895 	 second best val : 0.98182 	 second best test : 0.97443
k :  1 	 best_acc epoch :  14 	 val_accuracy : 0.97091 	 test_accuracy : 0.97123 	 last test_accuracy : 0.97260 	 second best val : 0.96970 	 second best test : 0.97078

avg :  	 val_accuracy : 0.97697 	 test_accuracy : 0.97283 	 last_accuracy : 0.97078 	 second best val : 0.97576 	 second best test : 0.97260

std :  	 val_accuracy : 0.00606 	 test_accuracy : 0.00160 	 last_accuracy : 0.00183 	 second best val : 0.00606 	 second best test : 0.00183


date and time :  Sun Jul  4 21:11:09 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=515, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0
Counter({1: 4723, 0: 2968})

Epoch :  1 loss training:  38.8318388806656 Time :  17
accuracy train: 0.968777 val: 0.949091 test: 0.954795
max validation accuracy : 0.949091 max acc epoch : 1 test accuracy : 0.954795
Counter({0: 3910, 1: 3781})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.333061832934618 Time :  37
accuracy train: 0.969418 val: 0.957576 test: 0.959361
max validation accuracy : 0.957576 max acc epoch : 2 test accuracy : 0.959361
Counter({0: 3862, 1: 3829})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.443605738691986 Time :  55
accuracy train: 0.970701 val: 0.961212 test: 0.967580
max validation accuracy : 0.961212 max acc epoch : 3 test accuracy : 0.967580
Counter({0: 3941, 1: 3750})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.881012281752191 Time :  73
accuracy train: 0.983747 val: 0.974545 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.968950
Counter({1: 3859, 0: 3832})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  7.800233073532581 Time :  89
accuracy train: 0.987382 val: 0.969697 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.968950
Counter({1: 3850, 0: 3841})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  7.867333225440234 Time :  110
accuracy train: 0.989735 val: 0.968485 test: 0.962557
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.968950
Counter({0: 3854, 1: 3837})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.151991850842023 Time :  128
accuracy train: 0.989307 val: 0.970909 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.968950
Counter({1: 3863, 0: 3828})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.741918623331003 Time :  145
accuracy train: 0.992087 val: 0.975758 test: 0.971233
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.971233
Counter({1: 3870, 0: 3821})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.159750998951495 Time :  161
accuracy train: 0.992087 val: 0.973333 test: 0.974886
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.971233
Counter({0: 3879, 1: 3812})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.2336106119910255 Time :  180
accuracy train: 0.991873 val: 0.970909 test: 0.973516
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.971233
Counter({1: 3885, 0: 3806})

Epoch :  11 loss training:  4.953221905801911 Time :  199
accuracy train: 0.993157 val: 0.973333 test: 0.971233
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.971233
Counter({0: 3891, 1: 3800})

Epoch :  12 loss training:  4.6180990054272115 Time :  216
accuracy train: 0.993370 val: 0.975758 test: 0.972146
max validation accuracy : 0.975758 max acc epoch : 8 test accuracy : 0.971233
Counter({1: 3879, 0: 3812})

Epoch :  13 loss training:  4.176082676742226 Time :  233
accuracy train: 0.993798 val: 0.978182 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3866, 0: 3825})

Epoch :  14 loss training:  4.221109505393542 Time :  252
accuracy train: 0.994440 val: 0.967273 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({0: 3889, 1: 3802})

Epoch :  15 loss training:  3.7337118503055535 Time :  270
accuracy train: 0.995081 val: 0.974545 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3893, 0: 3798})

Epoch :  16 loss training:  3.056866324157454 Time :  287
accuracy train: 0.994867 val: 0.974545 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3895, 0: 3796})

Epoch :  17 loss training:  2.855641483096406 Time :  307
accuracy train: 0.995509 val: 0.974545 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3897, 0: 3794})

Epoch :  18 loss training:  2.874424601031933 Time :  324
accuracy train: 0.996151 val: 0.975758 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3898, 0: 3793})

Epoch :  19 loss training:  2.7793781853688415 Time :  342
accuracy train: 0.996364 val: 0.976970 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3899, 0: 3792})

Epoch :  20 loss training:  2.4972350406169426 Time :  359
accuracy train: 0.995937 val: 0.970909 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({0: 3899, 1: 3792})

Epoch :  21 loss training:  2.4739637116435915 Time :  380
accuracy train: 0.996151 val: 0.974545 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3877, 0: 3814})

Epoch :  22 loss training:  2.1091521860071225 Time :  399
accuracy train: 0.996151 val: 0.974545 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3879, 0: 3812})

Epoch :  23 loss training:  2.497343596915016 Time :  416
accuracy train: 0.996364 val: 0.973333 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3879, 0: 3812})

Epoch :  24 loss training:  2.193891330360202 Time :  433
accuracy train: 0.996151 val: 0.974545 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3915, 0: 3776})

Epoch :  25 loss training:  2.1743707692221506 Time :  454
accuracy train: 0.996578 val: 0.975758 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3915, 0: 3776})

Epoch :  26 loss training:  2.0343219827773282 Time :  473
accuracy train: 0.996364 val: 0.972121 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3903, 0: 3788})

Epoch :  27 loss training:  1.66233362397179 Time :  490
accuracy train: 0.996364 val: 0.972121 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3921, 0: 3770})

Epoch :  28 loss training:  1.8284400733973598 Time :  507
accuracy train: 0.996364 val: 0.974545 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3921, 0: 3770})

Epoch :  29 loss training:  1.8700492908683373 Time :  527
accuracy train: 0.997220 val: 0.968485 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3921, 0: 3770})

Epoch :  30 loss training:  1.8500666642794386 Time :  544
accuracy train: 0.996364 val: 0.973333 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3923, 0: 3768})

Epoch :  31 loss training:  2.0042005519062513 Time :  561
accuracy train: 0.996792 val: 0.969697 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3923, 0: 3768})

Epoch :  32 loss training:  1.4591970900219167 Time :  580
accuracy train: 0.996792 val: 0.973333 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3923, 0: 3768})

Epoch :  33 loss training:  1.7753428166470258 Time :  600
accuracy train: 0.997006 val: 0.974545 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3923, 0: 3768})

Epoch :  34 loss training:  1.350637535302667 Time :  616
accuracy train: 0.996792 val: 0.974545 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3923, 0: 3768})

Epoch :  35 loss training:  1.6177334399108076 Time :  633
accuracy train: 0.997434 val: 0.973333 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3923, 0: 3768})

Epoch :  36 loss training:  1.4720548894547392 Time :  649
accuracy train: 0.997434 val: 0.976970 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3910, 0: 3781})

Epoch :  37 loss training:  1.6681826866915799 Time :  665
accuracy train: 0.997006 val: 0.970909 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3923, 0: 3768})

Epoch :  38 loss training:  1.374110256358108 Time :  681
accuracy train: 0.997006 val: 0.970909 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3915, 0: 3776})

Epoch :  39 loss training:  1.429228277884249 Time :  697
accuracy train: 0.997220 val: 0.969697 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3922, 0: 3769})

Epoch :  40 loss training:  1.5273511881605373 Time :  713
accuracy train: 0.997006 val: 0.972121 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3924, 0: 3767})

Epoch :  41 loss training:  1.5748213654223946 Time :  728
accuracy train: 0.996792 val: 0.970909 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3922, 0: 3769})

Epoch :  42 loss training:  1.3648664183056098 Time :  743
accuracy train: 0.997006 val: 0.968485 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3926, 0: 3765})

Epoch :  43 loss training:  1.343795333734306 Time :  759
accuracy train: 0.997434 val: 0.970909 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3926, 0: 3765})

Epoch :  44 loss training:  1.387031537189614 Time :  774
accuracy train: 0.997434 val: 0.973333 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 13 test accuracy : 0.972603
Counter({1: 3927, 0: 3764})

========================================================================================================================================================================================================
best acc epoch :  13
validation accuracy :  0.9781818181818182
test accuracy :  0.9726027397260274
last test_accuracy :  0.971689497716895
second best val :  0.9769696969696969
second best test :  0.9726027397260274
max gap 5
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=684, tsne=False, val_prop=0.15, weight_decay=1e-06)
device :  cuda:0
Counter({1: 4723, 0: 2968})

Epoch :  1 loss training:  40.84757789969444 Time :  793
accuracy train: 0.960436 val: 0.946667 test: 0.960731
max validation accuracy : 0.946667 max acc epoch : 1 test accuracy : 0.960731
Counter({1: 4168, 0: 3523})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.648071830160916 Time :  808
accuracy train: 0.965997 val: 0.946667 test: 0.963014
max validation accuracy : 0.946667 max acc epoch : 1 test accuracy : 0.960731
Counter({1: 4096, 0: 3595})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.212074019596912 Time :  823
accuracy train: 0.949743 val: 0.940606 test: 0.955251
max validation accuracy : 0.946667 max acc epoch : 1 test accuracy : 0.960731
Counter({0: 4027, 1: 3664})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.260245126206428 Time :  838
accuracy train: 0.984175 val: 0.969697 test: 0.968950
max validation accuracy : 0.969697 max acc epoch : 4 test accuracy : 0.968950
Counter({0: 3926, 1: 3765})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  8.105506039224565 Time :  853
accuracy train: 0.986313 val: 0.970909 test: 0.974429
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.974429
Counter({1: 3910, 0: 3781})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.32208986626938 Time :  867
accuracy train: 0.989307 val: 0.964848 test: 0.974429
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.974429
Counter({0: 3874, 1: 3817})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.056631414685398 Time :  882
accuracy train: 0.991446 val: 0.969697 test: 0.974429
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.974429
Counter({0: 3866, 1: 3825})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.154093951568939 Time :  897
accuracy train: 0.991446 val: 0.967273 test: 0.974429
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.974429
Counter({1: 3869, 0: 3822})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.085709563689306 Time :  912
accuracy train: 0.990590 val: 0.961212 test: 0.967123
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.974429
Counter({1: 3869, 0: 3822})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.373517471365631 Time :  927
accuracy train: 0.993584 val: 0.970909 test: 0.972146
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.974429
Counter({1: 3863, 0: 3828})

Epoch :  11 loss training:  4.71270087978337 Time :  942
accuracy train: 0.993798 val: 0.970909 test: 0.973973
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.974429
Counter({1: 3860, 0: 3831})

Epoch :  12 loss training:  4.536571726785041 Time :  957
accuracy train: 0.994440 val: 0.973333 test: 0.973973
max validation accuracy : 0.973333 max acc epoch : 12 test accuracy : 0.973973
Counter({1: 3860, 0: 3831})

Epoch :  13 loss training:  4.436529772006907 Time :  972
accuracy train: 0.995081 val: 0.974545 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 13 test accuracy : 0.970320
Counter({1: 3855, 0: 3836})

Epoch :  14 loss training:  4.293636324175168 Time :  988
accuracy train: 0.994654 val: 0.969697 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 13 test accuracy : 0.970320
Counter({1: 3860, 0: 3831})

Epoch :  15 loss training:  3.82938777806703 Time :  1004
accuracy train: 0.995081 val: 0.970909 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 13 test accuracy : 0.970320
Counter({0: 3848, 1: 3843})

Epoch :  16 loss training:  3.7426919745630585 Time :  1019
accuracy train: 0.995295 val: 0.975758 test: 0.973059
max validation accuracy : 0.975758 max acc epoch : 16 test accuracy : 0.973059
Counter({1: 3850, 0: 3841})

Epoch :  17 loss training:  3.404889997211285 Time :  1035
accuracy train: 0.995723 val: 0.973333 test: 0.974429
max validation accuracy : 0.975758 max acc epoch : 16 test accuracy : 0.973059
Counter({1: 3846, 0: 3845})

Epoch :  18 loss training:  3.1641675166320056 Time :  1050
accuracy train: 0.995509 val: 0.974545 test: 0.976256
max validation accuracy : 0.975758 max acc epoch : 16 test accuracy : 0.973059
Counter({0: 3849, 1: 3842})

Epoch :  19 loss training:  3.272435858962126 Time :  1066
accuracy train: 0.995937 val: 0.975758 test: 0.975342
max validation accuracy : 0.975758 max acc epoch : 16 test accuracy : 0.973059
Counter({0: 3851, 1: 3840})

Epoch :  20 loss training:  3.268956506741233 Time :  1080
accuracy train: 0.995295 val: 0.970909 test: 0.971233
max validation accuracy : 0.975758 max acc epoch : 16 test accuracy : 0.973059
Counter({0: 3851, 1: 3840})

Epoch :  21 loss training:  2.7663707675237674 Time :  1095
accuracy train: 0.995509 val: 0.970909 test: 0.970776
max validation accuracy : 0.975758 max acc epoch : 16 test accuracy : 0.973059
Counter({0: 3850, 1: 3841})

Epoch :  22 loss training:  2.621868928137701 Time :  1111
accuracy train: 0.996151 val: 0.969697 test: 0.971689
max validation accuracy : 0.975758 max acc epoch : 16 test accuracy : 0.973059
Counter({0: 3856, 1: 3835})

Epoch :  23 loss training:  2.74458151392173 Time :  1126
accuracy train: 0.996364 val: 0.970909 test: 0.973059
max validation accuracy : 0.975758 max acc epoch : 16 test accuracy : 0.973059
Counter({0: 3858, 1: 3833})

Epoch :  24 loss training:  2.801889052730985 Time :  1142
accuracy train: 0.996364 val: 0.973333 test: 0.973973
max validation accuracy : 0.975758 max acc epoch : 16 test accuracy : 0.973059
Counter({0: 3860, 1: 3831})

Epoch :  25 loss training:  2.571159652332426 Time :  1158
accuracy train: 0.996364 val: 0.974545 test: 0.974886
max validation accuracy : 0.975758 max acc epoch : 16 test accuracy : 0.973059
Counter({1: 3860, 0: 3831})

Epoch :  26 loss training:  1.8745252354710829 Time :  1176
accuracy train: 0.996364 val: 0.970909 test: 0.972603
max validation accuracy : 0.975758 max acc epoch : 16 test accuracy : 0.973059
Counter({0: 3859, 1: 3832})

Epoch :  27 loss training:  2.620278291287832 Time :  1191
accuracy train: 0.996578 val: 0.974545 test: 0.972146
max validation accuracy : 0.975758 max acc epoch : 16 test accuracy : 0.973059
Counter({0: 3862, 1: 3829})

Epoch :  28 loss training:  2.3409114828973543 Time :  1207
accuracy train: 0.997006 val: 0.978182 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({0: 3860, 1: 3831})

Epoch :  29 loss training:  2.313307198637631 Time :  1222
accuracy train: 0.996364 val: 0.972121 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({0: 3859, 1: 3832})

Epoch :  30 loss training:  1.9823352940147743 Time :  1238
accuracy train: 0.996578 val: 0.972121 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({0: 3857, 1: 3834})

Epoch :  31 loss training:  1.85853591671912 Time :  1256
accuracy train: 0.997006 val: 0.974545 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({0: 3861, 1: 3830})

Epoch :  32 loss training:  2.4631066414003726 Time :  1272
accuracy train: 0.996792 val: 0.969697 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({0: 3861, 1: 3830})

Epoch :  33 loss training:  1.8398249297606526 Time :  1288
accuracy train: 0.996792 val: 0.968485 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({0: 3861, 1: 3830})

Epoch :  34 loss training:  1.63510852996842 Time :  1305
accuracy train: 0.997220 val: 0.972121 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({0: 3864, 1: 3827})

Epoch :  35 loss training:  1.6269376162090339 Time :  1322
accuracy train: 0.997006 val: 0.969697 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({1: 3865, 0: 3826})

Epoch :  36 loss training:  1.5775591111123504 Time :  1338
accuracy train: 0.996792 val: 0.972121 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({0: 3865, 1: 3826})

Epoch :  37 loss training:  1.4210155454329652 Time :  1353
accuracy train: 0.997006 val: 0.973333 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({1: 3869, 0: 3822})

Epoch :  38 loss training:  1.4349537931120722 Time :  1368
accuracy train: 0.997006 val: 0.972121 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({1: 3869, 0: 3822})

Epoch :  39 loss training:  2.0387194825161714 Time :  1384
accuracy train: 0.997006 val: 0.972121 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({1: 3868, 0: 3823})

Epoch :  40 loss training:  1.7790709368509852 Time :  1400
accuracy train: 0.996792 val: 0.970909 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({0: 3868, 1: 3823})

Epoch :  41 loss training:  1.3581531977724808 Time :  1415
accuracy train: 0.997006 val: 0.973333 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({0: 3870, 1: 3821})

Epoch :  42 loss training:  1.3427723106506164 Time :  1432
accuracy train: 0.997006 val: 0.975758 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({1: 3872, 0: 3819})

Epoch :  43 loss training:  1.4069852087268373 Time :  1449
accuracy train: 0.997006 val: 0.970909 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({0: 3872, 1: 3819})

Epoch :  44 loss training:  1.2786826194424066 Time :  1466
accuracy train: 0.997220 val: 0.972121 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({0: 3871, 1: 3820})

Epoch :  45 loss training:  1.1891852577682585 Time :  1483
accuracy train: 0.997006 val: 0.975758 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({0: 3872, 1: 3819})

Epoch :  46 loss training:  1.4185763454788685 Time :  1500
accuracy train: 0.997220 val: 0.975758 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({0: 3872, 1: 3819})

Epoch :  47 loss training:  1.4539440534281312 Time :  1518
accuracy train: 0.997434 val: 0.976970 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({0: 3876, 1: 3815})

Epoch :  48 loss training:  1.2651414063038828 Time :  1535
accuracy train: 0.997434 val: 0.975758 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({0: 3876, 1: 3815})

Epoch :  49 loss training:  1.6104622215007112 Time :  1551
accuracy train: 0.997220 val: 0.968485 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({0: 3876, 1: 3815})

Epoch :  50 loss training:  1.3384267091169022 Time :  1567
accuracy train: 0.997006 val: 0.973333 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({1: 3876, 0: 3815})

Epoch :  51 loss training:  1.2569631372534786 Time :  1582
accuracy train: 0.997220 val: 0.972121 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({0: 3876, 1: 3815})

Epoch :  52 loss training:  1.4554248112799542 Time :  1598
accuracy train: 0.997006 val: 0.973333 test: 0.966210
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({0: 3876, 1: 3815})

Epoch :  53 loss training:  1.1522504774493427 Time :  1614
accuracy train: 0.997220 val: 0.970909 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({1: 3877, 0: 3814})

Epoch :  54 loss training:  1.260051331770228 Time :  1631
accuracy train: 0.996792 val: 0.967273 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({0: 3877, 1: 3814})

Epoch :  55 loss training:  1.2322990508973817 Time :  1647
accuracy train: 0.997220 val: 0.968485 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({0: 3877, 1: 3814})

Epoch :  56 loss training:  1.2826279722648906 Time :  1662
accuracy train: 0.997220 val: 0.967273 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({0: 3877, 1: 3814})

Epoch :  57 loss training:  1.1793542364539462 Time :  1679
accuracy train: 0.997220 val: 0.968485 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({0: 3877, 1: 3814})

Epoch :  58 loss training:  1.1952134735047366 Time :  1695
accuracy train: 0.997006 val: 0.966061 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({1: 3876, 0: 3815})

Epoch :  59 loss training:  1.3234232854374568 Time :  1710
accuracy train: 0.997220 val: 0.969697 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 28 test accuracy : 0.971689
Counter({0: 3877, 1: 3814})

========================================================================================================================================================================================================
best acc epoch :  28
validation accuracy :  0.9781818181818182
test accuracy :  0.971689497716895
last test_accuracy :  0.9694063926940639
second best val :  0.9769696969696969
second best test :  0.971689497716895
max gap 12
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  13 	 val_accuracy : 0.97818 	 test_accuracy : 0.97260 	 last test_accuracy : 0.97169 	 second best val : 0.97697 	 second best test : 0.97260
k :  1 	 best_acc epoch :  28 	 val_accuracy : 0.97818 	 test_accuracy : 0.97169 	 last test_accuracy : 0.96941 	 second best val : 0.97697 	 second best test : 0.97169

avg :  	 val_accuracy : 0.97818 	 test_accuracy : 0.97215 	 last_accuracy : 0.97055 	 second best val : 0.97697 	 second best test : 0.97215

std :  	 val_accuracy : 0.00000 	 test_accuracy : 0.00046 	 last_accuracy : 0.00114 	 second best val : 0.00000 	 second best test : 0.00046
