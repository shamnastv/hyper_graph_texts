date and time :  Tue Jan 26 20:27:48 2021
Namespace(batch_size=16, dataset='R52', debug=False, device=0, dropout=0.4, early_stop=20, epochs=400, filename='', hidden_dim=300, lda=True, lr=0.0005, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=1e-05)
device :  cuda:0
HGNNModel(
  (word_embeddings): Embedding(9333, 300, padding_idx=0)
  (h_gnn_layers): ModuleList(
    (0): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=300, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=300, out_features=300, bias=True)
        (W_hr): Linear(in_features=300, out_features=300, bias=True)
        (W_in): Linear(in_features=300, out_features=300, bias=True)
        (W_hn): Linear(in_features=300, out_features=300, bias=True)
        (W_iz): Linear(in_features=300, out_features=300, bias=True)
        (W_hz): Linear(in_features=300, out_features=300, bias=True)
      )
    )
    (1): HGNNLayer(
      (dropout): Dropout(p=0.4, inplace=False)
      (mlp): MLP(
        (linears): ModuleList(
          (0): Linear(in_features=300, out_features=300, bias=True)
        )
        (batch_norms): ModuleList()
        (dropout): Dropout(p=0.4, inplace=False)
      )
      (batch_norms): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (gru): GRUCellMod(
        (W_ir): Linear(in_features=300, out_features=300, bias=True)
        (W_hr): Linear(in_features=300, out_features=300, bias=True)
        (W_in): Linear(in_features=300, out_features=300, bias=True)
        (W_hn): Linear(in_features=300, out_features=300, bias=True)
        (W_iz): Linear(in_features=300, out_features=300, bias=True)
        (W_hz): Linear(in_features=300, out_features=300, bias=True)
      )
    )
  )
  (linears_prediction): ModuleList(
    (0): Linear(in_features=300, out_features=52, bias=True)
    (1): Linear(in_features=300, out_features=52, bias=True)
    (2): Linear(in_features=300, out_features=52, bias=True)
  )
  (attention): ModuleList(
    (0): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (1): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
    (2): Attention(
      (linears): ModuleList(
        (0): Linear(in_features=300, out_features=300, bias=False)
        (1): Linear(in_features=300, out_features=1, bias=False)
      )
    )
  )
  (dropout): Dropout(p=0.4, inplace=False)
)
Epoch :  1 loss training:  288.01845149695873 Time :  40
accuracy train: 0.920393 val: 0.900915 test: 0.889883
max validation accuracy : 0.900915 max acc epoch : 1.000000 test accuracy : 0.889883

Epoch :  2 loss training:  117.54975060652941 Time :  76
accuracy train: 0.943767 val: 0.907012 test: 0.912062
max validation accuracy : 0.907012 max acc epoch : 2.000000 test accuracy : 0.912062

Epoch :  3 loss training:  82.33412979682907 Time :  88
accuracy train: 0.969343 val: 0.931402 test: 0.918677
max validation accuracy : 0.931402 max acc epoch : 3.000000 test accuracy : 0.918677

Epoch :  4 loss training:  63.4408332942985 Time :  101
accuracy train: 0.976795 val: 0.939024 test: 0.929183
max validation accuracy : 0.939024 max acc epoch : 4.000000 test accuracy : 0.929183

Epoch :  5 loss training:  51.91654064168688 Time :  112
accuracy train: 0.983740 val: 0.942073 test: 0.939300
max validation accuracy : 0.942073 max acc epoch : 5.000000 test accuracy : 0.939300

Epoch :  6 loss training:  33.973198411404155 Time :  124
accuracy train: 0.984587 val: 0.943598 test: 0.939689
max validation accuracy : 0.943598 max acc epoch : 6.000000 test accuracy : 0.939689

Epoch :  7 loss training:  25.047973178850953 Time :  136
accuracy train: 0.991701 val: 0.946646 test: 0.936576
max validation accuracy : 0.946646 max acc epoch : 7.000000 test accuracy : 0.936576

Epoch :  8 loss training:  22.102993338150554 Time :  147
accuracy train: 0.994072 val: 0.949695 test: 0.935409
max validation accuracy : 0.949695 max acc epoch : 8.000000 test accuracy : 0.935409

Epoch :  9 loss training:  21.95803548571712 Time :  158
accuracy train: 0.991023 val: 0.951220 test: 0.935798
max validation accuracy : 0.951220 max acc epoch : 9.000000 test accuracy : 0.935798

Epoch :  10 loss training:  17.69386047698208 Time :  169
accuracy train: 0.994919 val: 0.949695 test: 0.937354
max validation accuracy : 0.951220 max acc epoch : 9.000000 test accuracy : 0.935798

Epoch :  11 loss training:  13.237338507802633 Time :  183
accuracy train: 0.996612 val: 0.948171 test: 0.943191
max validation accuracy : 0.951220 max acc epoch : 9.000000 test accuracy : 0.935798

Epoch :  12 loss training:  12.154353798367083 Time :  195
accuracy train: 0.997290 val: 0.946646 test: 0.943191
max validation accuracy : 0.951220 max acc epoch : 9.000000 test accuracy : 0.935798

Epoch :  13 loss training:  9.111076675719232 Time :  207
accuracy train: 0.996951 val: 0.951220 test: 0.941634
max validation accuracy : 0.951220 max acc epoch : 9.000000 test accuracy : 0.935798

Epoch :  14 loss training:  10.90999172719603 Time :  220
accuracy train: 0.997290 val: 0.946646 test: 0.943580
max validation accuracy : 0.951220 max acc epoch : 9.000000 test accuracy : 0.935798

Epoch :  15 loss training:  8.486926298428443 Time :  233
accuracy train: 0.996782 val: 0.955793 test: 0.942023
max validation accuracy : 0.955793 max acc epoch : 15.000000 test accuracy : 0.942023

Epoch :  16 loss training:  8.257623626202985 Time :  246
accuracy train: 0.997798 val: 0.952744 test: 0.943580
max validation accuracy : 0.955793 max acc epoch : 15.000000 test accuracy : 0.942023

Epoch :  17 loss training:  7.271105835134222 Time :  257
accuracy train: 0.998137 val: 0.957317 test: 0.939689
max validation accuracy : 0.957317 max acc epoch : 17.000000 test accuracy : 0.939689

Epoch :  18 loss training:  5.139006881581736 Time :  268
accuracy train: 0.998137 val: 0.955793 test: 0.940078
max validation accuracy : 0.957317 max acc epoch : 17.000000 test accuracy : 0.939689

Epoch :  19 loss training:  5.74313208089734 Time :  279
accuracy train: 0.997967 val: 0.952744 test: 0.943191
max validation accuracy : 0.957317 max acc epoch : 17.000000 test accuracy : 0.939689

Epoch :  20 loss training:  6.525228279453586 Time :  292
accuracy train: 0.998306 val: 0.954268 test: 0.942412
max validation accuracy : 0.957317 max acc epoch : 17.000000 test accuracy : 0.939689

Epoch :  21 loss training:  5.859144172609376 Time :  304
accuracy train: 0.998306 val: 0.951220 test: 0.943580
max validation accuracy : 0.957317 max acc epoch : 17.000000 test accuracy : 0.939689

Epoch :  22 loss training:  5.2592182232147024 Time :  315
accuracy train: 0.998476 val: 0.952744 test: 0.943191
max validation accuracy : 0.957317 max acc epoch : 17.000000 test accuracy : 0.939689

Epoch :  23 loss training:  5.102202832746116 Time :  326
accuracy train: 0.998306 val: 0.957317 test: 0.943580
max validation accuracy : 0.957317 max acc epoch : 17.000000 test accuracy : 0.939689

Epoch :  24 loss training:  5.025725115672685 Time :  338
accuracy train: 0.998476 val: 0.955793 test: 0.944358
max validation accuracy : 0.957317 max acc epoch : 17.000000 test accuracy : 0.939689

Epoch :  25 loss training:  4.7579743294809305 Time :  349
accuracy train: 0.998476 val: 0.955793 test: 0.943969
max validation accuracy : 0.957317 max acc epoch : 17.000000 test accuracy : 0.939689

Epoch :  26 loss training:  4.23331470926496 Time :  361
accuracy train: 0.998476 val: 0.954268 test: 0.942412
max validation accuracy : 0.957317 max acc epoch : 17.000000 test accuracy : 0.939689

Epoch :  27 loss training:  3.3080791550673894 Time :  372
accuracy train: 0.998306 val: 0.954268 test: 0.941245
max validation accuracy : 0.957317 max acc epoch : 17.000000 test accuracy : 0.939689

Epoch :  28 loss training:  3.7114019697946787 Time :  383
accuracy train: 0.998476 val: 0.954268 test: 0.941245
max validation accuracy : 0.957317 max acc epoch : 17.000000 test accuracy : 0.939689

Epoch :  29 loss training:  3.9343661052535026 Time :  394
accuracy train: 0.998645 val: 0.952744 test: 0.943580
max validation accuracy : 0.957317 max acc epoch : 17.000000 test accuracy : 0.939689

Epoch :  30 loss training:  4.833912012851215 Time :  407
accuracy train: 0.998814 val: 0.954268 test: 0.943191
max validation accuracy : 0.957317 max acc epoch : 17.000000 test accuracy : 0.939689

Epoch :  31 loss training:  3.3597582309139398 Time :  420
accuracy train: 0.998645 val: 0.952744 test: 0.945136
max validation accuracy : 0.957317 max acc epoch : 17.000000 test accuracy : 0.939689

Epoch :  32 loss training:  3.611947307777882 Time :  432
accuracy train: 0.998645 val: 0.954268 test: 0.942802
max validation accuracy : 0.957317 max acc epoch : 17.000000 test accuracy : 0.939689

Epoch :  33 loss training:  3.81278419339651 Time :  442
accuracy train: 0.998645 val: 0.952744 test: 0.942412
max validation accuracy : 0.957317 max acc epoch : 17.000000 test accuracy : 0.939689

Epoch :  34 loss training:  4.00822155023161 Time :  451
accuracy train: 0.998476 val: 0.949695 test: 0.944747
max validation accuracy : 0.957317 max acc epoch : 17.000000 test accuracy : 0.939689

Epoch :  35 loss training:  4.217226015349297 Time :  461
accuracy train: 0.998645 val: 0.954268 test: 0.943191
max validation accuracy : 0.957317 max acc epoch : 17.000000 test accuracy : 0.939689

Epoch :  36 loss training:  3.2955051036260556 Time :  470
accuracy train: 0.998645 val: 0.955793 test: 0.943580
max validation accuracy : 0.957317 max acc epoch : 17.000000 test accuracy : 0.939689

Epoch :  37 loss training:  3.395317835846072 Time :  479
accuracy train: 0.998645 val: 0.952744 test: 0.942412
max validation accuracy : 0.957317 max acc epoch : 17.000000 test accuracy : 0.939689

Epoch :  38 loss training:  3.8809970424736093 Time :  487
accuracy train: 0.998645 val: 0.954268 test: 0.942412
max validation accuracy : 0.957317 max acc epoch : 17.000000 test accuracy : 0.939689

========================================================================================================================================================================================================
max acc epoch :  17
max validation accuracy :  0.9573170731707317
test accuracy :  0.9396887159533074
latest_test_accuracy :  0.9424124513618677
========================================================================================================================================================================================================

