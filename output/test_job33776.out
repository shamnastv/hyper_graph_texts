

date and time :  Mon May 24 15:33:04 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=45, weight_decay=1e-08)
device :  cuda:0

Epoch :  1 loss training:  94.10471960902214 Time :  18
accuracy train: 0.788371 val: 0.752113 test: 0.764209
max validation accuracy : 0.752113 max acc epoch : 1 test accuracy : 0.764209
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.07596525549889 Time :  29
accuracy train: 0.773523 val: 0.725352 test: 0.745357
max validation accuracy : 0.752113 max acc epoch : 1 test accuracy : 0.764209
Epoch-2 lr: 0.001

Epoch :  3 loss training:  77.89738431572914 Time :  36
accuracy train: 0.814942 val: 0.767606 test: 0.760551
max validation accuracy : 0.767606 max acc epoch : 3 test accuracy : 0.760551
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.7891274690628 Time :  44
accuracy train: 0.830259 val: 0.760563 test: 0.777715
max validation accuracy : 0.767606 max acc epoch : 3 test accuracy : 0.760551
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  70.78435771167278 Time :  60
accuracy train: 0.855580 val: 0.780282 test: 0.776590
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  69.2322878241539 Time :  74
accuracy train: 0.856987 val: 0.769014 test: 0.781373
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  65.01339069008827 Time :  81
accuracy train: 0.869959 val: 0.773239 test: 0.783343
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  63.098526656627655 Time :  90
accuracy train: 0.884495 val: 0.776056 test: 0.778278
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  61.31078851222992 Time :  103
accuracy train: 0.890903 val: 0.759155 test: 0.774057
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.964097276329994 Time :  119
accuracy train: 0.898249 val: 0.776056 test: 0.779403
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.03227984905243 Time :  130
accuracy train: 0.899812 val: 0.767606 test: 0.777153
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  56.98220977187157 Time :  138
accuracy train: 0.907627 val: 0.763380 test: 0.777153
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  54.82921947538853 Time :  150
accuracy train: 0.908721 val: 0.764789 test: 0.774339
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  53.12566013634205 Time :  167
accuracy train: 0.918412 val: 0.763380 test: 0.777997
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  53.64808389544487 Time :  176
accuracy train: 0.922319 val: 0.771831 test: 0.774902
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590

Epoch :  16 loss training:  53.14277923107147 Time :  185
accuracy train: 0.925445 val: 0.764789 test: 0.776027
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590

Epoch :  17 loss training:  51.336370915174484 Time :  196
accuracy train: 0.929353 val: 0.766197 test: 0.775746
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590

Epoch :  18 loss training:  51.09680627286434 Time :  210
accuracy train: 0.936855 val: 0.776056 test: 0.775746
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590

Epoch :  19 loss training:  48.26909418404102 Time :  222
accuracy train: 0.941857 val: 0.771831 test: 0.775464
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590

Epoch :  20 loss training:  46.3200062289834 Time :  231
accuracy train: 0.946546 val: 0.770423 test: 0.772369
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590

Epoch :  21 loss training:  46.23293888568878 Time :  241
accuracy train: 0.951235 val: 0.766197 test: 0.774902
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590

Epoch :  22 loss training:  42.635169722139835 Time :  256
accuracy train: 0.954204 val: 0.763380 test: 0.776871
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590

Epoch :  23 loss training:  41.94327116012573 Time :  269
accuracy train: 0.958581 val: 0.769014 test: 0.775746
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590

Epoch :  24 loss training:  41.09683805704117 Time :  279
accuracy train: 0.964364 val: 0.766197 test: 0.775183
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590

Epoch :  25 loss training:  40.5136057510972 Time :  287
accuracy train: 0.966239 val: 0.764789 test: 0.775464
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590

Epoch :  26 loss training:  39.51474652439356 Time :  299
accuracy train: 0.969365 val: 0.763380 test: 0.770400
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590

Epoch :  27 loss training:  37.12315406650305 Time :  313
accuracy train: 0.975930 val: 0.764789 test: 0.775464
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590

Epoch :  28 loss training:  35.38902932405472 Time :  322
accuracy train: 0.977649 val: 0.760563 test: 0.776308
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590

Epoch :  29 loss training:  34.04830512404442 Time :  330
accuracy train: 0.981400 val: 0.770423 test: 0.773213
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590

Epoch :  30 loss training:  32.600103840231895 Time :  342
accuracy train: 0.983589 val: 0.763380 test: 0.770400
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590

Epoch :  31 loss training:  32.31109447032213 Time :  358
accuracy train: 0.982495 val: 0.759155 test: 0.771525
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590

Epoch :  32 loss training:  32.63490580767393 Time :  366
accuracy train: 0.981713 val: 0.767606 test: 0.772651
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590

Epoch :  33 loss training:  30.991802778095007 Time :  373
accuracy train: 0.983276 val: 0.766197 test: 0.776308
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590

Epoch :  34 loss training:  29.5140599347651 Time :  387
accuracy train: 0.987809 val: 0.767606 test: 0.772088
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590

Epoch :  35 loss training:  28.340426817536354 Time :  401
accuracy train: 0.991091 val: 0.769014 test: 0.774902
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590

Epoch :  36 loss training:  27.769797027111053 Time :  408
accuracy train: 0.990778 val: 0.766197 test: 0.772932
max validation accuracy : 0.780282 max acc epoch : 5 test accuracy : 0.776590

========================================================================================================================================================================================================
max acc epoch :  5
max validation accuracy :  0.780281690140845
test accuracy :  0.7765897580191333
last test_accuracy :  0.772931907709623
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=45, weight_decay=1e-08)
device :  cuda:0

Epoch :  1 loss training:  94.2330205142498 Time :  419
accuracy train: 0.786965 val: 0.754930 test: 0.761958
max validation accuracy : 0.754930 max acc epoch : 1 test accuracy : 0.761958
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.31244736909866 Time :  434
accuracy train: 0.776493 val: 0.733803 test: 0.747608
max validation accuracy : 0.754930 max acc epoch : 1 test accuracy : 0.761958
Epoch-2 lr: 0.001

Epoch :  3 loss training:  77.5793717354536 Time :  447
accuracy train: 0.824164 val: 0.764789 test: 0.763928
max validation accuracy : 0.764789 max acc epoch : 3 test accuracy : 0.763928
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.49756342172623 Time :  455
accuracy train: 0.830728 val: 0.766197 test: 0.775183
max validation accuracy : 0.766197 max acc epoch : 4 test accuracy : 0.775183
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  70.80060489475727 Time :  463
accuracy train: 0.852141 val: 0.769014 test: 0.778559
max validation accuracy : 0.769014 max acc epoch : 5 test accuracy : 0.778559
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  69.13280612230301 Time :  477
accuracy train: 0.856674 val: 0.759155 test: 0.777153
max validation accuracy : 0.769014 max acc epoch : 5 test accuracy : 0.778559
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  64.33917206525803 Time :  491
accuracy train: 0.873867 val: 0.769014 test: 0.777153
max validation accuracy : 0.769014 max acc epoch : 5 test accuracy : 0.778559
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  62.897864922881126 Time :  499
accuracy train: 0.883557 val: 0.769014 test: 0.777434
max validation accuracy : 0.769014 max acc epoch : 5 test accuracy : 0.778559
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  61.72461964190006 Time :  506
accuracy train: 0.888246 val: 0.749296 test: 0.774339
max validation accuracy : 0.769014 max acc epoch : 5 test accuracy : 0.778559
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.65727873146534 Time :  519
accuracy train: 0.900125 val: 0.766197 test: 0.778278
max validation accuracy : 0.769014 max acc epoch : 5 test accuracy : 0.778559
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  57.72798040509224 Time :  532
accuracy train: 0.900750 val: 0.761972 test: 0.770962
max validation accuracy : 0.769014 max acc epoch : 5 test accuracy : 0.778559
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  57.237667605280876 Time :  540
accuracy train: 0.908409 val: 0.773239 test: 0.781936
max validation accuracy : 0.773239 max acc epoch : 12 test accuracy : 0.781936
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  54.80346642434597 Time :  548
accuracy train: 0.911691 val: 0.763380 test: 0.781936
max validation accuracy : 0.773239 max acc epoch : 12 test accuracy : 0.781936
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  53.244870603084564 Time :  561
accuracy train: 0.918881 val: 0.766197 test: 0.779966
max validation accuracy : 0.773239 max acc epoch : 12 test accuracy : 0.781936
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  53.560518220067024 Time :  573
accuracy train: 0.920444 val: 0.761972 test: 0.775746
max validation accuracy : 0.773239 max acc epoch : 12 test accuracy : 0.781936

Epoch :  16 loss training:  52.71931967139244 Time :  580
accuracy train: 0.926852 val: 0.780282 test: 0.774339
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  17 loss training:  50.452558651566505 Time :  588
accuracy train: 0.928728 val: 0.773239 test: 0.777997
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  18 loss training:  50.70544737577438 Time :  602
accuracy train: 0.936386 val: 0.776056 test: 0.776590
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  19 loss training:  48.041294641792774 Time :  616
accuracy train: 0.940450 val: 0.774648 test: 0.776027
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  20 loss training:  46.266084522008896 Time :  623
accuracy train: 0.946077 val: 0.773239 test: 0.773213
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  21 loss training:  45.94190436601639 Time :  631
accuracy train: 0.949515 val: 0.774648 test: 0.777153
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  22 loss training:  43.2331266105175 Time :  646
accuracy train: 0.952641 val: 0.771831 test: 0.776027
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  23 loss training:  41.62886047363281 Time :  657
accuracy train: 0.957799 val: 0.763380 test: 0.778278
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  24 loss training:  41.46240586787462 Time :  665
accuracy train: 0.962332 val: 0.769014 test: 0.774057
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  25 loss training:  39.76255928725004 Time :  675
accuracy train: 0.964833 val: 0.770423 test: 0.769837
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  26 loss training:  39.57267226278782 Time :  691
accuracy train: 0.968271 val: 0.764789 test: 0.774620
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  27 loss training:  36.36519402265549 Time :  701
accuracy train: 0.974680 val: 0.757746 test: 0.771806
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  28 loss training:  35.50817413628101 Time :  709
accuracy train: 0.975930 val: 0.760563 test: 0.771525
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  29 loss training:  33.93088260665536 Time :  722
accuracy train: 0.980775 val: 0.776056 test: 0.766742
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  30 loss training:  32.89166735857725 Time :  738
accuracy train: 0.980619 val: 0.769014 test: 0.770118
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  31 loss training:  32.367929704487324 Time :  748
accuracy train: 0.983276 val: 0.766197 test: 0.770681
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  32 loss training:  32.2678959146142 Time :  756
accuracy train: 0.981400 val: 0.770423 test: 0.776871
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  33 loss training:  30.52826988697052 Time :  771
accuracy train: 0.985464 val: 0.770423 test: 0.778278
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  34 loss training:  28.975329767912626 Time :  785
accuracy train: 0.988121 val: 0.763380 test: 0.770681
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  35 loss training:  27.73922100290656 Time :  798
accuracy train: 0.990935 val: 0.763380 test: 0.767023
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  36 loss training:  28.01222576573491 Time :  806
accuracy train: 0.991404 val: 0.766197 test: 0.769555
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  37 loss training:  26.347089525312185 Time :  815
accuracy train: 0.992185 val: 0.771831 test: 0.772651
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  38 loss training:  24.435050358995795 Time :  830
accuracy train: 0.991247 val: 0.766197 test: 0.774339
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  39 loss training:  24.096578307449818 Time :  846
accuracy train: 0.993592 val: 0.759155 test: 0.774057
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  40 loss training:  24.10991772264242 Time :  855
accuracy train: 0.995780 val: 0.760563 test: 0.771806
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  41 loss training:  22.263134030625224 Time :  863
accuracy train: 0.996093 val: 0.766197 test: 0.769837
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  42 loss training:  22.004587560892105 Time :  878
accuracy train: 0.996718 val: 0.771831 test: 0.771806
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  43 loss training:  20.544457342475653 Time :  894
accuracy train: 0.997343 val: 0.770423 test: 0.772651
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  44 loss training:  20.66085551865399 Time :  905
accuracy train: 0.996874 val: 0.773239 test: 0.770962
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  45 loss training:  20.248557049781084 Time :  913
accuracy train: 0.997499 val: 0.776056 test: 0.773213
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  46 loss training:  19.597411239519715 Time :  923
accuracy train: 0.997499 val: 0.771831 test: 0.766742
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

Epoch :  47 loss training:  19.063290474936366 Time :  937
accuracy train: 0.998281 val: 0.767606 test: 0.770962
max validation accuracy : 0.780282 max acc epoch : 16 test accuracy : 0.774339

========================================================================================================================================================================================================
max acc epoch :  16
max validation accuracy :  0.780281690140845
test accuracy :  0.7743387732132808
last test_accuracy :  0.770962296004502
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=45, weight_decay=1e-08)
device :  cuda:0

Epoch :  1 loss training:  94.11604127287865 Time :  950
accuracy train: 0.786027 val: 0.749296 test: 0.760270
max validation accuracy : 0.749296 max acc epoch : 1 test accuracy : 0.760270
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.22768893837929 Time :  958
accuracy train: 0.778056 val: 0.726761 test: 0.754643
max validation accuracy : 0.749296 max acc epoch : 1 test accuracy : 0.760270
Epoch-2 lr: 0.001

Epoch :  3 loss training:  77.90872012078762 Time :  969
accuracy train: 0.818850 val: 0.770423 test: 0.773495
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.773495
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.30992375314236 Time :  982
accuracy train: 0.829478 val: 0.764789 test: 0.780810
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.773495
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  70.75535462796688 Time :  990
accuracy train: 0.855736 val: 0.777465 test: 0.783624
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  69.13398998975754 Time :  998
accuracy train: 0.859331 val: 0.767606 test: 0.785031
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  64.72281330823898 Time :  1010
accuracy train: 0.869178 val: 0.763380 test: 0.779966
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  63.25444953143597 Time :  1024
accuracy train: 0.885433 val: 0.776056 test: 0.782780
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  61.65593393146992 Time :  1032
accuracy train: 0.896686 val: 0.754930 test: 0.777434
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.31883102655411 Time :  1041
accuracy train: 0.897937 val: 0.761972 test: 0.780810
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.22675234079361 Time :  1054
accuracy train: 0.900281 val: 0.753521 test: 0.777434
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  56.92568902671337 Time :  1067
accuracy train: 0.908565 val: 0.763380 test: 0.780529
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  54.734470054507256 Time :  1074
accuracy train: 0.912785 val: 0.761972 test: 0.784750
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  53.71411865949631 Time :  1084
accuracy train: 0.918725 val: 0.761972 test: 0.783343
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  53.83462627232075 Time :  1097
accuracy train: 0.921069 val: 0.764789 test: 0.782499
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624

Epoch :  16 loss training:  53.08195948600769 Time :  1109
accuracy train: 0.924508 val: 0.764789 test: 0.779403
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624

Epoch :  17 loss training:  51.38818682730198 Time :  1117
accuracy train: 0.930760 val: 0.766197 test: 0.781936
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624

Epoch :  18 loss training:  50.58894348144531 Time :  1126
accuracy train: 0.937012 val: 0.766197 test: 0.784750
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624

Epoch :  19 loss training:  48.350221045315266 Time :  1139
accuracy train: 0.940450 val: 0.769014 test: 0.783905
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624

Epoch :  20 loss training:  45.947284147143364 Time :  1151
accuracy train: 0.947327 val: 0.766197 test: 0.785875
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624

Epoch :  21 loss training:  45.65238542109728 Time :  1159
accuracy train: 0.950766 val: 0.757746 test: 0.783624
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624

Epoch :  22 loss training:  43.26259525120258 Time :  1168
accuracy train: 0.954361 val: 0.764789 test: 0.787001
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624

Epoch :  23 loss training:  41.5650589466095 Time :  1183
accuracy train: 0.957018 val: 0.761972 test: 0.785594
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624

Epoch :  24 loss training:  41.17115042358637 Time :  1194
accuracy train: 0.963113 val: 0.767606 test: 0.782217
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624

Epoch :  25 loss training:  40.54885774105787 Time :  1202
accuracy train: 0.966083 val: 0.766197 test: 0.780810
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624

Epoch :  26 loss training:  39.406844697892666 Time :  1214
accuracy train: 0.969678 val: 0.761972 test: 0.781654
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624

Epoch :  27 loss training:  36.656003937125206 Time :  1229
accuracy train: 0.974680 val: 0.764789 test: 0.781092
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624

Epoch :  28 loss training:  35.57695967704058 Time :  1240
accuracy train: 0.977337 val: 0.766197 test: 0.781092
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624

Epoch :  29 loss training:  33.96830154955387 Time :  1248
accuracy train: 0.979837 val: 0.764789 test: 0.778559
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624

Epoch :  30 loss training:  32.6181011646986 Time :  1259
accuracy train: 0.981088 val: 0.769014 test: 0.777715
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624

Epoch :  31 loss training:  32.229473013430834 Time :  1275
accuracy train: 0.984683 val: 0.770423 test: 0.772932
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624

Epoch :  32 loss training:  32.212270986288786 Time :  1285
accuracy train: 0.982026 val: 0.766197 test: 0.774057
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624

Epoch :  33 loss training:  30.71665731817484 Time :  1293
accuracy train: 0.986089 val: 0.771831 test: 0.780248
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624

Epoch :  34 loss training:  29.251694932579994 Time :  1304
accuracy train: 0.989215 val: 0.771831 test: 0.776308
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624

Epoch :  35 loss training:  27.793852780014277 Time :  1318
accuracy train: 0.992029 val: 0.769014 test: 0.771806
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624

Epoch :  36 loss training:  27.297946982085705 Time :  1329
accuracy train: 0.990778 val: 0.766197 test: 0.777153
max validation accuracy : 0.777465 max acc epoch : 5 test accuracy : 0.783624

========================================================================================================================================================================================================
max acc epoch :  5
max validation accuracy :  0.7774647887323943
test accuracy :  0.7836240855374226
last test_accuracy :  0.7771525042205966
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=45, weight_decay=1e-08)
device :  cuda:0

Epoch :  1 loss training:  94.30539056658745 Time :  1338
accuracy train: 0.786496 val: 0.752113 test: 0.760270
max validation accuracy : 0.752113 max acc epoch : 1 test accuracy : 0.760270
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.54500791430473 Time :  1349
accuracy train: 0.773679 val: 0.722535 test: 0.747327
max validation accuracy : 0.752113 max acc epoch : 1 test accuracy : 0.760270
Epoch-2 lr: 0.001

Epoch :  3 loss training:  77.66746708750725 Time :  1365
accuracy train: 0.824476 val: 0.767606 test: 0.767304
max validation accuracy : 0.767606 max acc epoch : 3 test accuracy : 0.767304
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.4419156908989 Time :  1374
accuracy train: 0.830103 val: 0.763380 test: 0.777434
max validation accuracy : 0.767606 max acc epoch : 3 test accuracy : 0.767304
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.110425978899 Time :  1382
accuracy train: 0.853861 val: 0.774648 test: 0.781654
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.781654
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  69.47149051725864 Time :  1395
accuracy train: 0.855267 val: 0.756338 test: 0.776871
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.781654
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  65.01976443827152 Time :  1411
accuracy train: 0.868865 val: 0.770423 test: 0.778278
max validation accuracy : 0.774648 max acc epoch : 5 test accuracy : 0.781654
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  63.47037756443024 Time :  1420
accuracy train: 0.880275 val: 0.780282 test: 0.779122
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  61.584635987877846 Time :  1427
accuracy train: 0.887934 val: 0.759155 test: 0.774902
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.30459202826023 Time :  1440
accuracy train: 0.895749 val: 0.767606 test: 0.783343
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.00455941259861 Time :  1454
accuracy train: 0.899812 val: 0.760563 test: 0.780529
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  57.04848462343216 Time :  1461
accuracy train: 0.910441 val: 0.766197 test: 0.781092
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  54.74345041811466 Time :  1469
accuracy train: 0.913879 val: 0.763380 test: 0.781654
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  54.06463120877743 Time :  1482
accuracy train: 0.918725 val: 0.769014 test: 0.780248
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  54.19373336434364 Time :  1497
accuracy train: 0.921851 val: 0.764789 test: 0.780248
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122

Epoch :  16 loss training:  53.071141108870506 Time :  1506
accuracy train: 0.926383 val: 0.774648 test: 0.780529
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122

Epoch :  17 loss training:  51.13387657701969 Time :  1514
accuracy train: 0.927946 val: 0.770423 test: 0.778841
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122

Epoch :  18 loss training:  50.673449352383614 Time :  1527
accuracy train: 0.933729 val: 0.771831 test: 0.781654
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122

Epoch :  19 loss training:  48.94054912030697 Time :  1541
accuracy train: 0.938887 val: 0.767606 test: 0.781936
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122

Epoch :  20 loss training:  46.27156438678503 Time :  1549
accuracy train: 0.947327 val: 0.767606 test: 0.779122
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122

Epoch :  21 loss training:  46.16465853154659 Time :  1556
accuracy train: 0.949828 val: 0.769014 test: 0.781373
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122

Epoch :  22 loss training:  42.83682478219271 Time :  1570
accuracy train: 0.953579 val: 0.769014 test: 0.783905
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122

Epoch :  23 loss training:  41.691739186644554 Time :  1582
accuracy train: 0.957018 val: 0.764789 test: 0.779685
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122

Epoch :  24 loss training:  41.342432737350464 Time :  1591
accuracy train: 0.961707 val: 0.770423 test: 0.782217
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122

Epoch :  25 loss training:  39.75713508576155 Time :  1599
accuracy train: 0.962019 val: 0.770423 test: 0.774057
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122

Epoch :  26 loss training:  39.22036972641945 Time :  1616
accuracy train: 0.967334 val: 0.770423 test: 0.772369
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122

Epoch :  27 loss training:  36.905695870518684 Time :  1628
accuracy train: 0.972960 val: 0.764789 test: 0.775183
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122

Epoch :  28 loss training:  36.100809413939714 Time :  1637
accuracy train: 0.974836 val: 0.766197 test: 0.776027
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122

Epoch :  29 loss training:  33.95279320701957 Time :  1644
accuracy train: 0.979525 val: 0.769014 test: 0.776590
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122

Epoch :  30 loss training:  33.027350552380085 Time :  1660
accuracy train: 0.980150 val: 0.767606 test: 0.776590
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122

Epoch :  31 loss training:  31.568474404513836 Time :  1673
accuracy train: 0.981088 val: 0.773239 test: 0.768993
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122

Epoch :  32 loss training:  32.50606242194772 Time :  1682
accuracy train: 0.980150 val: 0.763380 test: 0.772088
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122

Epoch :  33 loss training:  31.604660540819168 Time :  1691
accuracy train: 0.984058 val: 0.773239 test: 0.779122
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122

Epoch :  34 loss training:  29.149387385696173 Time :  1705
accuracy train: 0.987965 val: 0.763380 test: 0.773495
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122

Epoch :  35 loss training:  28.040142975747585 Time :  1718
accuracy train: 0.990935 val: 0.769014 test: 0.773213
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122

Epoch :  36 loss training:  28.011447191238403 Time :  1726
accuracy train: 0.988903 val: 0.770423 test: 0.770962
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122

Epoch :  37 loss training:  25.91318652778864 Time :  1735
accuracy train: 0.992029 val: 0.774648 test: 0.772651
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122

Epoch :  38 loss training:  24.29553714580834 Time :  1751
accuracy train: 0.989528 val: 0.767606 test: 0.769837
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122

Epoch :  39 loss training:  24.429207265377045 Time :  1765
accuracy train: 0.992810 val: 0.767606 test: 0.772932
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.779122

========================================================================================================================================================================================================
max acc epoch :  8
max validation accuracy :  0.780281690140845
test accuracy :  0.7791221159257175
last test_accuracy :  0.772931907709623
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.78028 	 test_accuracy : 0.77659 	 max_acc epoch :  5 	 last test_accuracy : 0.77293
k :  1 	 val_accuracy : 0.78028 	 test_accuracy : 0.77434 	 max_acc epoch :  16 	 last test_accuracy : 0.77096
k :  2 	 val_accuracy : 0.77746 	 test_accuracy : 0.78362 	 max_acc epoch :  5 	 last test_accuracy : 0.77715
k :  3 	 val_accuracy : 0.78028 	 test_accuracy : 0.77912 	 max_acc epoch :  8 	 last test_accuracy : 0.77293

avg :  	 val_accuracy : 0.77958 	 test_accuracy : 0.77842 	 last_accuracy : 0.77349


date and time :  Mon May 24 16:02:35 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=339, weight_decay=1e-08)
device :  cuda:0
Counter({0: 6205, 1: 4457})

Epoch :  1 loss training:  93.78589361906052 Time :  41
accuracy train: 0.781182 val: 0.756338 test: 0.763928
max validation accuracy : 0.756338 max acc epoch : 1 test accuracy : 0.763928
Counter({0: 8086, 1: 2576})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.10528218746185 Time :  88
accuracy train: 0.806189 val: 0.759155 test: 0.774057
max validation accuracy : 0.759155 max acc epoch : 2 test accuracy : 0.774057
Counter({1: 7844, 0: 2818})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  77.52720069885254 Time :  135
accuracy train: 0.818068 val: 0.760563 test: 0.773213
max validation accuracy : 0.760563 max acc epoch : 3 test accuracy : 0.773213
Counter({0: 7880, 1: 2782})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  72.75720272958279 Time :  186
accuracy train: 0.827602 val: 0.773239 test: 0.763647
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.763647
Counter({1: 7822, 0: 2840})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  70.22274611890316 Time :  221
accuracy train: 0.852298 val: 0.766197 test: 0.772932
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.763647
Counter({1: 9894, 0: 768})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  68.77450303733349 Time :  257
accuracy train: 0.853861 val: 0.766197 test: 0.774902
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.763647
Counter({0: 9976, 1: 686})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  64.9591754078865 Time :  315
accuracy train: 0.867927 val: 0.769014 test: 0.772088
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.763647
Counter({1: 9977, 0: 685})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  63.7700834274292 Time :  368
accuracy train: 0.873867 val: 0.767606 test: 0.765616
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.763647
Counter({0: 9968, 1: 694})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.04596284031868 Time :  413
accuracy train: 0.889497 val: 0.766197 test: 0.777434
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.763647
Counter({0: 9982, 1: 680})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.04118409752846 Time :  466
accuracy train: 0.893717 val: 0.763380 test: 0.778278
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.763647
Counter({1: 9971, 0: 691})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  57.05817501246929 Time :  512
accuracy train: 0.898249 val: 0.761972 test: 0.777153
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.763647
Counter({1: 9969, 0: 693})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  57.401338666677475 Time :  551
accuracy train: 0.902782 val: 0.757746 test: 0.773495
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.763647
Counter({1: 7118, 0: 3544})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  54.90511478483677 Time :  609
accuracy train: 0.911535 val: 0.754930 test: 0.775183
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.763647
Counter({0: 7279, 1: 3383})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  52.76777984201908 Time :  653
accuracy train: 0.914817 val: 0.769014 test: 0.775183
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.763647
Counter({0: 7312, 1: 3350})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  52.2799107581377 Time :  694
accuracy train: 0.919193 val: 0.771831 test: 0.772651
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.763647
Counter({1: 7344, 0: 3318})

Epoch :  16 loss training:  52.34242706000805 Time :  741
accuracy train: 0.925133 val: 0.766197 test: 0.773776
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.763647
Counter({1: 7373, 0: 3289})

Epoch :  17 loss training:  51.29123231768608 Time :  777
accuracy train: 0.927008 val: 0.766197 test: 0.773213
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.763647
Counter({0: 7372, 1: 3290})

Epoch :  18 loss training:  47.2172421887517 Time :  817
accuracy train: 0.932479 val: 0.769014 test: 0.770962
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.763647
Counter({0: 7371, 1: 3291})

Epoch :  19 loss training:  47.707318007946014 Time :  856
accuracy train: 0.935292 val: 0.773239 test: 0.769555
max validation accuracy : 0.773239 max acc epoch : 4 test accuracy : 0.763647
Counter({0: 7364, 1: 3298})

Epoch :  20 loss training:  46.44287695735693 Time :  890
accuracy train: 0.932791 val: 0.774648 test: 0.770681
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.770681
Counter({0: 7364, 1: 3298})

Epoch :  21 loss training:  45.15222975611687 Time :  935
accuracy train: 0.947015 val: 0.761972 test: 0.769274
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.770681
Counter({1: 7365, 0: 3297})

Epoch :  22 loss training:  42.70278876274824 Time :  969
accuracy train: 0.949203 val: 0.773239 test: 0.768993
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.770681
Counter({0: 7360, 1: 3302})

Epoch :  23 loss training:  40.75817237794399 Time :  1015
accuracy train: 0.953892 val: 0.764789 test: 0.767867
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.770681
Counter({0: 7360, 1: 3302})

Epoch :  24 loss training:  40.08236590027809 Time :  1051
accuracy train: 0.957174 val: 0.766197 test: 0.770681
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.770681
Counter({1: 7355, 0: 3307})

Epoch :  25 loss training:  39.186725452542305 Time :  1097
accuracy train: 0.962176 val: 0.771831 test: 0.769274
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.770681
Counter({1: 7344, 0: 3318})

Epoch :  26 loss training:  37.19597642123699 Time :  1139
accuracy train: 0.966865 val: 0.776056 test: 0.770400
max validation accuracy : 0.776056 max acc epoch : 26 test accuracy : 0.770400
Counter({0: 7332, 1: 3330})

Epoch :  27 loss training:  36.95808328688145 Time :  1183
accuracy train: 0.969991 val: 0.776056 test: 0.769274
max validation accuracy : 0.776056 max acc epoch : 26 test accuracy : 0.770400
Counter({0: 7335, 1: 3327})

Epoch :  28 loss training:  35.25926036387682 Time :  1229
accuracy train: 0.972960 val: 0.774648 test: 0.768149
max validation accuracy : 0.776056 max acc epoch : 26 test accuracy : 0.770400
Counter({0: 7309, 1: 3353})

Epoch :  29 loss training:  34.552384063601494 Time :  1268
accuracy train: 0.976555 val: 0.785915 test: 0.766179
max validation accuracy : 0.785915 max acc epoch : 29 test accuracy : 0.766179
Counter({0: 7326, 1: 3336})

Epoch :  30 loss training:  31.85811312496662 Time :  1315
accuracy train: 0.979681 val: 0.777465 test: 0.769274
max validation accuracy : 0.785915 max acc epoch : 29 test accuracy : 0.766179
Counter({0: 7307, 1: 3355})

Epoch :  31 loss training:  32.17325757443905 Time :  1357
accuracy train: 0.981088 val: 0.773239 test: 0.770681
max validation accuracy : 0.785915 max acc epoch : 29 test accuracy : 0.766179
Counter({1: 7296, 0: 3366})

Epoch :  32 loss training:  30.393517266958952 Time :  1400
accuracy train: 0.983745 val: 0.781690 test: 0.769274
max validation accuracy : 0.785915 max acc epoch : 29 test accuracy : 0.766179
Counter({0: 7302, 1: 3360})

Epoch :  33 loss training:  28.839492604136467 Time :  1439
accuracy train: 0.984370 val: 0.776056 test: 0.770118
max validation accuracy : 0.785915 max acc epoch : 29 test accuracy : 0.766179
Counter({1: 7295, 0: 3367})

Epoch :  34 loss training:  28.062898360192776 Time :  1490
accuracy train: 0.987183 val: 0.770423 test: 0.768711
max validation accuracy : 0.785915 max acc epoch : 29 test accuracy : 0.766179
Counter({0: 7294, 1: 3368})

Epoch :  35 loss training:  27.676662120968103 Time :  1528
accuracy train: 0.988590 val: 0.777465 test: 0.764772
max validation accuracy : 0.785915 max acc epoch : 29 test accuracy : 0.766179
Counter({0: 7297, 1: 3365})

Epoch :  36 loss training:  26.438529066741467 Time :  1577
accuracy train: 0.989528 val: 0.777465 test: 0.772369
max validation accuracy : 0.785915 max acc epoch : 29 test accuracy : 0.766179
Counter({0: 7292, 1: 3370})

Epoch :  37 loss training:  25.330982226878405 Time :  1616
accuracy train: 0.992029 val: 0.774648 test: 0.770118
max validation accuracy : 0.785915 max acc epoch : 29 test accuracy : 0.766179
Counter({0: 7262, 1: 3400})

Epoch :  38 loss training:  24.974481362849474 Time :  1666
accuracy train: 0.992654 val: 0.783099 test: 0.770681
max validation accuracy : 0.785915 max acc epoch : 29 test accuracy : 0.766179
Counter({1: 7267, 0: 3395})

Epoch :  39 loss training:  23.254348017275333 Time :  1708
accuracy train: 0.992341 val: 0.781690 test: 0.768430
max validation accuracy : 0.785915 max acc epoch : 29 test accuracy : 0.766179
Counter({0: 7263, 1: 3399})

Epoch :  40 loss training:  22.011454282328486 Time :  1755
accuracy train: 0.993123 val: 0.781690 test: 0.767586
max validation accuracy : 0.785915 max acc epoch : 29 test accuracy : 0.766179
Counter({0: 7254, 1: 3408})

Epoch :  41 loss training:  21.477166086435318 Time :  1801
accuracy train: 0.993748 val: 0.784507 test: 0.772369
max validation accuracy : 0.785915 max acc epoch : 29 test accuracy : 0.766179
Counter({1: 7260, 0: 3402})

Epoch :  42 loss training:  20.625778630375862 Time :  1843
accuracy train: 0.994530 val: 0.788732 test: 0.772651
max validation accuracy : 0.788732 max acc epoch : 42 test accuracy : 0.772651
Counter({1: 7252, 0: 3410})

Epoch :  43 loss training:  20.77245485316962 Time :  1891
accuracy train: 0.995311 val: 0.784507 test: 0.769837
max validation accuracy : 0.788732 max acc epoch : 42 test accuracy : 0.772651
Counter({0: 7260, 1: 3402})

Epoch :  44 loss training:  20.07005958072841 Time :  1930
accuracy train: 0.996093 val: 0.784507 test: 0.771525
max validation accuracy : 0.788732 max acc epoch : 42 test accuracy : 0.772651
Counter({1: 7230, 0: 3432})

Epoch :  45 loss training:  18.570151848718524 Time :  1981
accuracy train: 0.995624 val: 0.794366 test: 0.769837
max validation accuracy : 0.794366 max acc epoch : 45 test accuracy : 0.769837
Counter({1: 7224, 0: 3438})

Epoch :  46 loss training:  17.483295936137438 Time :  2024
accuracy train: 0.996718 val: 0.788732 test: 0.770962
max validation accuracy : 0.794366 max acc epoch : 45 test accuracy : 0.769837
Counter({1: 7191, 0: 3471})

Epoch :  47 loss training:  16.22183582931757 Time :  2070
accuracy train: 0.997030 val: 0.792958 test: 0.769274
max validation accuracy : 0.794366 max acc epoch : 45 test accuracy : 0.769837
Counter({1: 7015, 0: 3647})

Epoch :  48 loss training:  16.89327527023852 Time :  2129
accuracy train: 0.997187 val: 0.788732 test: 0.771525
max validation accuracy : 0.794366 max acc epoch : 45 test accuracy : 0.769837
Counter({0: 7022, 1: 3640})

Epoch :  49 loss training:  16.442784136161208 Time :  2163
accuracy train: 0.998281 val: 0.788732 test: 0.769274
max validation accuracy : 0.794366 max acc epoch : 45 test accuracy : 0.769837
Counter({0: 7017, 1: 3645})

Epoch :  50 loss training:  14.966858660802245 Time :  2212
accuracy train: 0.997968 val: 0.791549 test: 0.774339
max validation accuracy : 0.794366 max acc epoch : 45 test accuracy : 0.769837
Counter({0: 7022, 1: 3640})

Epoch :  51 loss training:  14.881524123251438 Time :  2249
accuracy train: 0.998593 val: 0.791549 test: 0.773213
max validation accuracy : 0.794366 max acc epoch : 45 test accuracy : 0.769837
Counter({1: 7019, 0: 3643})

Epoch :  52 loss training:  14.259986432269216 Time :  2297
accuracy train: 0.998750 val: 0.792958 test: 0.768149
max validation accuracy : 0.794366 max acc epoch : 45 test accuracy : 0.769837
Counter({1: 7006, 0: 3656})

Epoch :  53 loss training:  13.412899442948401 Time :  2337
accuracy train: 0.998906 val: 0.794366 test: 0.765898
max validation accuracy : 0.794366 max acc epoch : 45 test accuracy : 0.769837
Counter({0: 6998, 1: 3664})

Epoch :  54 loss training:  12.860915311146528 Time :  2380
accuracy train: 0.998906 val: 0.801408 test: 0.770962
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({1: 7008, 0: 3654})

Epoch :  55 loss training:  12.318186793476343 Time :  2426
accuracy train: 0.998750 val: 0.797183 test: 0.765616
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({0: 7006, 1: 3656})

Epoch :  56 loss training:  12.730048337951303 Time :  2458
accuracy train: 0.999375 val: 0.800000 test: 0.769274
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({1: 6992, 0: 3670})

Epoch :  57 loss training:  10.87394028622657 Time :  2505
accuracy train: 0.999531 val: 0.797183 test: 0.768149
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({1: 6896, 0: 3766})

Epoch :  58 loss training:  11.272718109656125 Time :  2550
accuracy train: 0.999531 val: 0.785915 test: 0.768993
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({1: 6905, 0: 3757})

Epoch :  59 loss training:  10.857763995416462 Time :  2592
accuracy train: 0.999844 val: 0.788732 test: 0.765053
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({0: 6895, 1: 3767})

Epoch :  60 loss training:  10.48586434777826 Time :  2632
accuracy train: 0.999687 val: 0.790141 test: 0.771806
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({1: 6882, 0: 3780})

Epoch :  61 loss training:  10.226417200174183 Time :  2678
accuracy train: 0.999687 val: 0.787324 test: 0.769274
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({1: 6884, 0: 3778})

Epoch :  62 loss training:  9.831566422712058 Time :  2711
accuracy train: 1.000000 val: 0.787324 test: 0.765616
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({1: 6878, 0: 3784})

Epoch :  63 loss training:  10.222602733643726 Time :  2746
accuracy train: 1.000000 val: 0.788732 test: 0.767023
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({1: 6886, 0: 3776})

Epoch :  64 loss training:  9.633495118934661 Time :  2782
accuracy train: 1.000000 val: 0.790141 test: 0.765335
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({0: 6889, 1: 3773})

Epoch :  65 loss training:  9.096577227115631 Time :  2814
accuracy train: 1.000000 val: 0.797183 test: 0.767023
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({0: 6873, 1: 3789})

Epoch :  66 loss training:  8.990837780293077 Time :  2848
accuracy train: 1.000000 val: 0.783099 test: 0.763928
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({1: 6866, 0: 3796})

Epoch :  67 loss training:  9.085530733689666 Time :  2884
accuracy train: 0.999687 val: 0.783099 test: 0.768149
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({0: 6874, 1: 3788})

Epoch :  68 loss training:  9.069856111891568 Time :  2919
accuracy train: 0.999844 val: 0.785915 test: 0.765898
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({0: 6859, 1: 3803})

Epoch :  69 loss training:  7.427346503129229 Time :  2954
accuracy train: 0.999844 val: 0.781690 test: 0.769555
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({1: 6869, 0: 3793})

Epoch :  70 loss training:  7.513186565600336 Time :  2989
accuracy train: 0.999844 val: 0.795775 test: 0.766460
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({1: 6833, 0: 3829})

Epoch :  71 loss training:  7.3048128532245755 Time :  3025
accuracy train: 1.000000 val: 0.787324 test: 0.767023
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({1: 6841, 0: 3821})

Epoch :  72 loss training:  7.276849936926737 Time :  3060
accuracy train: 1.000000 val: 0.790141 test: 0.767304
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({1: 6842, 0: 3820})

Epoch :  73 loss training:  7.957154092378914 Time :  3095
accuracy train: 0.999844 val: 0.788732 test: 0.770400
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({0: 6841, 1: 3821})

Epoch :  74 loss training:  7.464585374807939 Time :  3128
accuracy train: 1.000000 val: 0.788732 test: 0.768430
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({1: 6846, 0: 3816})

Epoch :  75 loss training:  6.182324911700562 Time :  3159
accuracy train: 1.000000 val: 0.790141 test: 0.769555
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({1: 6846, 0: 3816})

Epoch :  76 loss training:  6.565686447080225 Time :  3190
accuracy train: 1.000000 val: 0.795775 test: 0.764209
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({0: 6829, 1: 3833})

Epoch :  77 loss training:  6.306160158477724 Time :  3229
accuracy train: 1.000000 val: 0.797183 test: 0.765898
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({1: 6832, 0: 3830})

Epoch :  78 loss training:  6.79051045444794 Time :  3266
accuracy train: 1.000000 val: 0.791549 test: 0.763928
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({1: 6830, 0: 3832})

Epoch :  79 loss training:  5.3068209225311875 Time :  3301
accuracy train: 1.000000 val: 0.792958 test: 0.763928
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({0: 6816, 1: 3846})

Epoch :  80 loss training:  5.800343170529231 Time :  3340
accuracy train: 1.000000 val: 0.795775 test: 0.762521
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({0: 6820, 1: 3842})

Epoch :  81 loss training:  5.957570122322068 Time :  3377
accuracy train: 1.000000 val: 0.787324 test: 0.761958
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({1: 6809, 0: 3853})

Epoch :  82 loss training:  5.272150124801556 Time :  3412
accuracy train: 1.000000 val: 0.795775 test: 0.762802
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({1: 6808, 0: 3854})

Epoch :  83 loss training:  5.583971417974681 Time :  3446
accuracy train: 1.000000 val: 0.788732 test: 0.765616
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({0: 6808, 1: 3854})

Epoch :  84 loss training:  4.601032838691026 Time :  3478
accuracy train: 1.000000 val: 0.792958 test: 0.767304
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({0: 6803, 1: 3859})

Epoch :  85 loss training:  4.853618576424196 Time :  3510
accuracy train: 1.000000 val: 0.784507 test: 0.763647
max validation accuracy : 0.801408 max acc epoch : 54 test accuracy : 0.770962
Counter({0: 6809, 1: 3853})

========================================================================================================================================================================================================
max acc epoch :  54
max validation accuracy :  0.8014084507042254
test accuracy :  0.770962296004502
last test_accuracy :  0.7636465953854812
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=339, weight_decay=1e-08)
device :  cuda:0
Counter({0: 6205, 1: 4457})

Epoch :  1 loss training:  93.93157011270523 Time :  3572
accuracy train: 0.780088 val: 0.764789 test: 0.765335
max validation accuracy : 0.764789 max acc epoch : 1 test accuracy : 0.765335
Counter({0: 7770, 1: 2892})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.4544749557972 Time :  3627
accuracy train: 0.805252 val: 0.766197 test: 0.775746
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.775746
Counter({1: 7524, 0: 3138})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.13601097464561 Time :  3679
accuracy train: 0.821038 val: 0.756338 test: 0.771244
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.775746
Counter({1: 7856, 0: 2806})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  72.71333903074265 Time :  3716
accuracy train: 0.828696 val: 0.777465 test: 0.770681
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.770681
Counter({1: 7812, 0: 2850})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  70.28685650229454 Time :  3755
accuracy train: 0.852610 val: 0.778873 test: 0.772088
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.772088
Counter({1: 9616, 0: 1046})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  68.29274947941303 Time :  3794
accuracy train: 0.855267 val: 0.773239 test: 0.770400
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.772088
Counter({0: 9418, 1: 1244})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  65.08292561769485 Time :  3853
accuracy train: 0.871835 val: 0.778873 test: 0.776590
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.772088
Counter({1: 7134, 0: 3528})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  63.09318436682224 Time :  3907
accuracy train: 0.886371 val: 0.771831 test: 0.771525
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.772088
Counter({1: 7607, 0: 3055})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  61.23355810344219 Time :  3955
accuracy train: 0.885589 val: 0.774648 test: 0.770400
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.772088
Counter({0: 7472, 1: 3190})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  58.52315412461758 Time :  3995
accuracy train: 0.891060 val: 0.780282 test: 0.776590
max validation accuracy : 0.780282 max acc epoch : 10 test accuracy : 0.776590
Counter({1: 7519, 0: 3143})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  56.37559874355793 Time :  4030
accuracy train: 0.901375 val: 0.771831 test: 0.776027
max validation accuracy : 0.780282 max acc epoch : 10 test accuracy : 0.776590
Counter({0: 7494, 1: 3168})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  56.59982484579086 Time :  4066
accuracy train: 0.905908 val: 0.776056 test: 0.774057
max validation accuracy : 0.780282 max acc epoch : 10 test accuracy : 0.776590
Counter({1: 7534, 0: 3128})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  56.02008916437626 Time :  4099
accuracy train: 0.909190 val: 0.778873 test: 0.775183
max validation accuracy : 0.780282 max acc epoch : 10 test accuracy : 0.776590
Counter({1: 7501, 0: 3161})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  53.3494361191988 Time :  4130
accuracy train: 0.909190 val: 0.783099 test: 0.775183
max validation accuracy : 0.783099 max acc epoch : 14 test accuracy : 0.775183
Counter({1: 7481, 0: 3181})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  53.640709400177 Time :  4163
accuracy train: 0.910753 val: 0.774648 test: 0.774902
max validation accuracy : 0.783099 max acc epoch : 14 test accuracy : 0.775183
Counter({1: 7473, 0: 3189})

Epoch :  16 loss training:  52.97869311273098 Time :  4196
accuracy train: 0.923570 val: 0.783099 test: 0.774057
max validation accuracy : 0.783099 max acc epoch : 14 test accuracy : 0.775183
Counter({1: 7491, 0: 3171})

Epoch :  17 loss training:  52.03559312224388 Time :  4230
accuracy train: 0.923570 val: 0.781690 test: 0.773495
max validation accuracy : 0.783099 max acc epoch : 14 test accuracy : 0.775183
Counter({1: 7470, 0: 3192})

Epoch :  18 loss training:  49.14548546075821 Time :  4261
accuracy train: 0.930447 val: 0.783099 test: 0.775183
max validation accuracy : 0.783099 max acc epoch : 14 test accuracy : 0.775183
Counter({1: 7425, 0: 3237})

Epoch :  19 loss training:  48.78268380463123 Time :  4292
accuracy train: 0.936699 val: 0.783099 test: 0.776308
max validation accuracy : 0.783099 max acc epoch : 14 test accuracy : 0.775183
Counter({0: 7415, 1: 3247})

Epoch :  20 loss training:  46.94966984540224 Time :  4329
accuracy train: 0.939356 val: 0.790141 test: 0.770962
max validation accuracy : 0.790141 max acc epoch : 20 test accuracy : 0.770962
Counter({0: 7342, 1: 3320})

Epoch :  21 loss training:  46.15784876048565 Time :  4362
accuracy train: 0.947952 val: 0.785915 test: 0.776308
max validation accuracy : 0.790141 max acc epoch : 20 test accuracy : 0.770962
Counter({0: 7398, 1: 3264})

Epoch :  22 loss training:  43.578484266996384 Time :  4394
accuracy train: 0.953579 val: 0.787324 test: 0.776871
max validation accuracy : 0.790141 max acc epoch : 20 test accuracy : 0.770962
Counter({1: 7323, 0: 3339})

Epoch :  23 loss training:  41.30532933026552 Time :  4428
accuracy train: 0.957643 val: 0.788732 test: 0.775746
max validation accuracy : 0.790141 max acc epoch : 20 test accuracy : 0.770962
Counter({1: 7304, 0: 3358})

Epoch :  24 loss training:  40.74836524575949 Time :  4467
accuracy train: 0.962019 val: 0.790141 test: 0.774620
max validation accuracy : 0.790141 max acc epoch : 20 test accuracy : 0.770962
Counter({1: 7316, 0: 3346})

Epoch :  25 loss training:  39.00095032155514 Time :  4504
accuracy train: 0.965927 val: 0.787324 test: 0.775464
max validation accuracy : 0.790141 max acc epoch : 20 test accuracy : 0.770962
Counter({0: 7289, 1: 3373})

Epoch :  26 loss training:  38.59574995934963 Time :  4546
accuracy train: 0.967959 val: 0.797183 test: 0.773213
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({0: 7274, 1: 3388})

Epoch :  27 loss training:  37.85014642030001 Time :  4584
accuracy train: 0.968740 val: 0.794366 test: 0.770681
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({0: 7274, 1: 3388})

Epoch :  28 loss training:  35.93636205047369 Time :  4622
accuracy train: 0.972648 val: 0.792958 test: 0.771525
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({1: 7267, 0: 3395})

Epoch :  29 loss training:  34.91090393066406 Time :  4661
accuracy train: 0.976555 val: 0.785915 test: 0.768149
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({1: 7312, 0: 3350})

Epoch :  30 loss training:  32.66648567467928 Time :  4694
accuracy train: 0.979212 val: 0.794366 test: 0.767023
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({1: 7210, 0: 3452})

Epoch :  31 loss training:  32.824049927294254 Time :  4729
accuracy train: 0.980463 val: 0.791549 test: 0.769274
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({0: 7218, 1: 3444})

Epoch :  32 loss training:  31.82475608587265 Time :  4759
accuracy train: 0.984214 val: 0.783099 test: 0.769274
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({0: 7220, 1: 3442})

Epoch :  33 loss training:  29.683281809091568 Time :  4791
accuracy train: 0.985933 val: 0.788732 test: 0.770118
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({0: 7216, 1: 3446})

Epoch :  34 loss training:  28.208542451262474 Time :  4822
accuracy train: 0.988434 val: 0.783099 test: 0.768711
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({0: 7211, 1: 3451})

Epoch :  35 loss training:  28.4422061778605 Time :  4855
accuracy train: 0.988903 val: 0.787324 test: 0.770400
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({1: 7208, 0: 3454})

Epoch :  36 loss training:  26.003515854477882 Time :  4885
accuracy train: 0.990153 val: 0.783099 test: 0.772651
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({0: 7186, 1: 3476})

Epoch :  37 loss training:  25.340656880289316 Time :  4915
accuracy train: 0.991091 val: 0.783099 test: 0.771244
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({0: 7108, 1: 3554})

Epoch :  38 loss training:  25.715004578232765 Time :  4950
accuracy train: 0.991872 val: 0.774648 test: 0.765898
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({0: 7112, 1: 3550})

Epoch :  39 loss training:  23.361750094220042 Time :  4984
accuracy train: 0.994217 val: 0.783099 test: 0.767586
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({0: 7119, 1: 3543})

Epoch :  40 loss training:  21.96571902371943 Time :  5017
accuracy train: 0.994842 val: 0.777465 test: 0.767586
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({1: 7125, 0: 3537})

Epoch :  41 loss training:  21.495706802234054 Time :  5055
accuracy train: 0.994686 val: 0.777465 test: 0.773495
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({1: 7121, 0: 3541})

Epoch :  42 loss training:  20.854849983006716 Time :  5088
accuracy train: 0.995311 val: 0.781690 test: 0.774620
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({1: 7132, 0: 3530})

Epoch :  43 loss training:  20.612539080902934 Time :  5119
accuracy train: 0.996405 val: 0.774648 test: 0.770681
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({1: 7146, 0: 3516})

Epoch :  44 loss training:  20.425700441002846 Time :  5152
accuracy train: 0.996561 val: 0.774648 test: 0.773213
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({1: 7184, 0: 3478})

Epoch :  45 loss training:  19.628332188352942 Time :  5184
accuracy train: 0.997499 val: 0.777465 test: 0.768149
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({1: 7212, 0: 3450})

Epoch :  46 loss training:  17.579834574833512 Time :  5216
accuracy train: 0.997343 val: 0.778873 test: 0.773776
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({1: 7187, 0: 3475})

Epoch :  47 loss training:  16.12153642438352 Time :  5245
accuracy train: 0.997343 val: 0.781690 test: 0.773495
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({0: 7193, 1: 3469})

Epoch :  48 loss training:  17.31836163625121 Time :  5272
accuracy train: 0.997968 val: 0.777465 test: 0.770962
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({1: 7196, 0: 3466})

Epoch :  49 loss training:  16.713036630302668 Time :  5302
accuracy train: 0.998593 val: 0.783099 test: 0.773495
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({1: 7150, 0: 3512})

Epoch :  50 loss training:  16.101260168477893 Time :  5332
accuracy train: 0.999062 val: 0.776056 test: 0.774339
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({1: 7174, 0: 3488})

Epoch :  51 loss training:  15.774023491889238 Time :  5359
accuracy train: 0.999062 val: 0.773239 test: 0.766742
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({0: 7205, 1: 3457})

Epoch :  52 loss training:  15.59580510482192 Time :  5391
accuracy train: 0.998906 val: 0.777465 test: 0.769837
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({1: 7220, 0: 3442})

Epoch :  53 loss training:  14.17715185135603 Time :  5423
accuracy train: 0.998906 val: 0.778873 test: 0.770681
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({1: 7209, 0: 3453})

Epoch :  54 loss training:  13.764700341038406 Time :  5455
accuracy train: 0.999531 val: 0.783099 test: 0.770400
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({1: 7239, 0: 3423})

Epoch :  55 loss training:  13.21550908125937 Time :  5487
accuracy train: 0.999844 val: 0.780282 test: 0.770118
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({0: 7208, 1: 3454})

Epoch :  56 loss training:  12.995903152041137 Time :  5516
accuracy train: 0.999844 val: 0.781690 test: 0.768711
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({1: 7201, 0: 3461})

Epoch :  57 loss training:  11.719642139039934 Time :  5549
accuracy train: 0.999844 val: 0.774648 test: 0.768711
max validation accuracy : 0.797183 max acc epoch : 26 test accuracy : 0.773213
Counter({1: 7164, 0: 3498})

========================================================================================================================================================================================================
max acc epoch :  26
max validation accuracy :  0.7971830985915493
test accuracy :  0.7732132808103546
last test_accuracy :  0.7687113111986494
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=339, weight_decay=1e-08)
device :  cuda:0
Counter({0: 6205, 1: 4457})

Epoch :  1 loss training:  93.7827005982399 Time :  5616
accuracy train: 0.778681 val: 0.760563 test: 0.761677
max validation accuracy : 0.760563 max acc epoch : 1 test accuracy : 0.761677
Counter({1: 7705, 0: 2957})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.16634900867939 Time :  5667
accuracy train: 0.803063 val: 0.771831 test: 0.772088
max validation accuracy : 0.771831 max acc epoch : 2 test accuracy : 0.772088
Counter({1: 7866, 0: 2796})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  77.696771427989 Time :  5710
accuracy train: 0.821663 val: 0.763380 test: 0.772088
max validation accuracy : 0.771831 max acc epoch : 2 test accuracy : 0.772088
Counter({0: 7782, 1: 2880})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  72.9755570590496 Time :  5754
accuracy train: 0.821819 val: 0.780282 test: 0.765335
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.765335
Counter({0: 7236, 1: 3426})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  69.88809868693352 Time :  5801
accuracy train: 0.845889 val: 0.769014 test: 0.773495
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.765335
Counter({1: 7205, 0: 3457})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  67.76215445995331 Time :  5847
accuracy train: 0.867146 val: 0.760563 test: 0.773776
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.765335
Counter({0: 7241, 1: 3421})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  64.17089132964611 Time :  5888
accuracy train: 0.870585 val: 0.766197 test: 0.773495
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.765335
Counter({0: 7251, 1: 3411})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  63.42370407283306 Time :  5931
accuracy train: 0.877774 val: 0.760563 test: 0.765898
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.765335
Counter({1: 7294, 0: 3368})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  61.135353311896324 Time :  5968
accuracy train: 0.890747 val: 0.763380 test: 0.772369
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.765335
Counter({0: 7293, 1: 3369})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  58.54292154312134 Time :  6003
accuracy train: 0.893873 val: 0.764789 test: 0.770962
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.765335
Counter({0: 7299, 1: 3363})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  56.36687250435352 Time :  6038
accuracy train: 0.900750 val: 0.763380 test: 0.770962
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.765335
Counter({0: 7309, 1: 3353})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  56.65352942049503 Time :  6071
accuracy train: 0.907940 val: 0.761972 test: 0.774902
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.765335
Counter({0: 7307, 1: 3355})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  55.79244901239872 Time :  6102
accuracy train: 0.911535 val: 0.760563 test: 0.776308
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.765335
Counter({0: 7304, 1: 3358})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  53.85212850570679 Time :  6135
accuracy train: 0.912316 val: 0.759155 test: 0.775746
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.765335
Counter({0: 7304, 1: 3358})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  53.88045048713684 Time :  6167
accuracy train: 0.914348 val: 0.769014 test: 0.777997
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.765335
Counter({0: 7296, 1: 3366})

Epoch :  16 loss training:  53.68629513680935 Time :  6197
accuracy train: 0.921694 val: 0.763380 test: 0.774339
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.765335
Counter({0: 7293, 1: 3369})

Epoch :  17 loss training:  52.197733014822006 Time :  6230
accuracy train: 0.920913 val: 0.764789 test: 0.776590
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.765335
Counter({0: 7296, 1: 3366})

Epoch :  18 loss training:  49.06105101853609 Time :  6262
accuracy train: 0.928571 val: 0.766197 test: 0.776027
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.765335
Counter({0: 7293, 1: 3369})

Epoch :  19 loss training:  48.86230851709843 Time :  6296
accuracy train: 0.934667 val: 0.766197 test: 0.773776
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.765335
Counter({1: 7281, 0: 3381})

Epoch :  20 loss training:  47.84805200248957 Time :  6328
accuracy train: 0.937637 val: 0.766197 test: 0.772369
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.765335
Counter({0: 7270, 1: 3392})

Epoch :  21 loss training:  45.72022932767868 Time :  6361
accuracy train: 0.944514 val: 0.766197 test: 0.774057
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.765335
Counter({0: 7267, 1: 3395})

Epoch :  22 loss training:  43.9282521083951 Time :  6395
accuracy train: 0.949515 val: 0.777465 test: 0.775464
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.765335
Counter({0: 7260, 1: 3402})

Epoch :  23 loss training:  42.47531032562256 Time :  6429
accuracy train: 0.953892 val: 0.767606 test: 0.772651
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.765335
Counter({1: 7262, 0: 3400})

Epoch :  24 loss training:  41.94835244119167 Time :  6460
accuracy train: 0.957330 val: 0.767606 test: 0.774620
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.765335
Counter({0: 7258, 1: 3404})

Epoch :  25 loss training:  39.89538901299238 Time :  6494
accuracy train: 0.959519 val: 0.770423 test: 0.771525
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.765335
Counter({0: 7252, 1: 3410})

Epoch :  26 loss training:  39.25063066184521 Time :  6525
accuracy train: 0.965302 val: 0.776056 test: 0.774339
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.765335
Counter({1: 7238, 0: 3424})

Epoch :  27 loss training:  38.17610143870115 Time :  6557
accuracy train: 0.969365 val: 0.783099 test: 0.773495
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({0: 7240, 1: 3422})

Epoch :  28 loss training:  37.060654774308205 Time :  6591
accuracy train: 0.973585 val: 0.773239 test: 0.771806
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({0: 7233, 1: 3429})

Epoch :  29 loss training:  35.14002346992493 Time :  6627
accuracy train: 0.975617 val: 0.767606 test: 0.775746
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({1: 7232, 0: 3430})

Epoch :  30 loss training:  32.70982036367059 Time :  6661
accuracy train: 0.977493 val: 0.778873 test: 0.774339
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({1: 7196, 0: 3466})

Epoch :  31 loss training:  33.248169124126434 Time :  6700
accuracy train: 0.979369 val: 0.773239 test: 0.774339
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({0: 7195, 1: 3467})

Epoch :  32 loss training:  31.85344885662198 Time :  6734
accuracy train: 0.982807 val: 0.778873 test: 0.772369
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({0: 7203, 1: 3459})

Epoch :  33 loss training:  30.438623771071434 Time :  6768
accuracy train: 0.982963 val: 0.766197 test: 0.774620
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({0: 7195, 1: 3467})

Epoch :  34 loss training:  29.126019798219204 Time :  6803
accuracy train: 0.985933 val: 0.763380 test: 0.772088
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({0: 7192, 1: 3470})

Epoch :  35 loss training:  28.337307762354612 Time :  6839
accuracy train: 0.987027 val: 0.769014 test: 0.774339
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({0: 7188, 1: 3474})

Epoch :  36 loss training:  27.027202256023884 Time :  6876
accuracy train: 0.988121 val: 0.769014 test: 0.772651
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({1: 7173, 0: 3489})

Epoch :  37 loss training:  25.78219485282898 Time :  6913
accuracy train: 0.990466 val: 0.777465 test: 0.772369
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({0: 7147, 1: 3515})

Epoch :  38 loss training:  26.136357847601175 Time :  6951
accuracy train: 0.991091 val: 0.767606 test: 0.770962
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({0: 7149, 1: 3513})

Epoch :  39 loss training:  23.91482925787568 Time :  6986
accuracy train: 0.991404 val: 0.769014 test: 0.768711
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({1: 7143, 0: 3519})

Epoch :  40 loss training:  23.407547779381275 Time :  7024
accuracy train: 0.992341 val: 0.774648 test: 0.767586
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({1: 7136, 0: 3526})

Epoch :  41 loss training:  22.048487834632397 Time :  7061
accuracy train: 0.993592 val: 0.780282 test: 0.771525
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({1: 7132, 0: 3530})

Epoch :  42 loss training:  21.528611574321985 Time :  7098
accuracy train: 0.995311 val: 0.776056 test: 0.774339
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({0: 7130, 1: 3532})

Epoch :  43 loss training:  20.909338872879744 Time :  7135
accuracy train: 0.995155 val: 0.769014 test: 0.770962
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({0: 7110, 1: 3552})

Epoch :  44 loss training:  20.702744835987687 Time :  7174
accuracy train: 0.994998 val: 0.769014 test: 0.772088
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({1: 7105, 0: 3557})

Epoch :  45 loss training:  20.38099198229611 Time :  7212
accuracy train: 0.995780 val: 0.773239 test: 0.773213
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({1: 7103, 0: 3559})

Epoch :  46 loss training:  18.04792238213122 Time :  7250
accuracy train: 0.996249 val: 0.769014 test: 0.773495
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({1: 7089, 0: 3573})

Epoch :  47 loss training:  17.134184896945953 Time :  7287
accuracy train: 0.996874 val: 0.783099 test: 0.776027
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({1: 7070, 0: 3592})

Epoch :  48 loss training:  17.446866046637297 Time :  7326
accuracy train: 0.997030 val: 0.773239 test: 0.773776
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({1: 7064, 0: 3598})

Epoch :  49 loss training:  17.354830587282777 Time :  7361
accuracy train: 0.998437 val: 0.777465 test: 0.771806
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({1: 7065, 0: 3597})

Epoch :  50 loss training:  16.260915441438556 Time :  7395
accuracy train: 0.997343 val: 0.780282 test: 0.775746
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({0: 7068, 1: 3594})

Epoch :  51 loss training:  15.857996463775635 Time :  7429
accuracy train: 0.998124 val: 0.777465 test: 0.774339
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({1: 7077, 0: 3585})

Epoch :  52 loss training:  15.955568901263177 Time :  7465
accuracy train: 0.998593 val: 0.778873 test: 0.775183
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({0: 7066, 1: 3596})

Epoch :  53 loss training:  14.899549580179155 Time :  7499
accuracy train: 0.998906 val: 0.777465 test: 0.772932
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({1: 7062, 0: 3600})

Epoch :  54 loss training:  13.896928923204541 Time :  7535
accuracy train: 0.998593 val: 0.780282 test: 0.774339
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({0: 7057, 1: 3605})

Epoch :  55 loss training:  13.658042246475816 Time :  7571
accuracy train: 0.999375 val: 0.780282 test: 0.772088
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({0: 7053, 1: 3609})

Epoch :  56 loss training:  13.771393698640168 Time :  7607
accuracy train: 0.999219 val: 0.776056 test: 0.775746
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({0: 7048, 1: 3614})

Epoch :  57 loss training:  11.612726544961333 Time :  7642
accuracy train: 0.999687 val: 0.778873 test: 0.777153
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({0: 7019, 1: 3643})

Epoch :  58 loss training:  12.077961419709027 Time :  7678
accuracy train: 0.999844 val: 0.783099 test: 0.774902
max validation accuracy : 0.783099 max acc epoch : 27 test accuracy : 0.773495
Counter({0: 7017, 1: 3645})

========================================================================================================================================================================================================
max acc epoch :  27
max validation accuracy :  0.7830985915492957
test accuracy :  0.7734946539110861
last test_accuracy :  0.7749015194147439
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=339, weight_decay=1e-08)
device :  cuda:0
Counter({0: 6205, 1: 4457})

Epoch :  1 loss training:  93.85916525125504 Time :  7737
accuracy train: 0.779306 val: 0.761972 test: 0.761677
max validation accuracy : 0.761972 max acc epoch : 1 test accuracy : 0.761677
Counter({0: 7572, 1: 3090})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.26874911785126 Time :  7796
accuracy train: 0.800094 val: 0.766197 test: 0.771244
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.771244
Counter({1: 7531, 0: 3131})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  77.58221141994 Time :  7836
accuracy train: 0.821194 val: 0.756338 test: 0.769274
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.771244
Counter({1: 7554, 0: 3108})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  72.29427842795849 Time :  7889
accuracy train: 0.826352 val: 0.770423 test: 0.761958
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.761958
Counter({0: 7578, 1: 3084})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  69.57210664451122 Time :  7928
accuracy train: 0.851204 val: 0.778873 test: 0.768711
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({1: 7528, 0: 3134})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  67.69312931597233 Time :  7965
accuracy train: 0.857612 val: 0.761972 test: 0.768430
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({0: 7481, 1: 3181})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  63.43325972557068 Time :  8001
accuracy train: 0.867771 val: 0.766197 test: 0.771244
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({1: 7495, 0: 3167})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  62.63212226331234 Time :  8038
accuracy train: 0.872304 val: 0.763380 test: 0.766460
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({1: 7497, 0: 3165})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  61.09537561237812 Time :  8071
accuracy train: 0.883870 val: 0.759155 test: 0.766742
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({1: 7459, 0: 3203})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  58.92778919637203 Time :  8107
accuracy train: 0.890747 val: 0.764789 test: 0.766742
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({1: 7448, 0: 3214})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  56.13866268098354 Time :  8141
accuracy train: 0.899812 val: 0.763380 test: 0.766460
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({0: 7444, 1: 3218})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  56.05038933455944 Time :  8175
accuracy train: 0.908409 val: 0.756338 test: 0.765335
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({0: 7421, 1: 3241})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  54.70621058344841 Time :  8210
accuracy train: 0.913410 val: 0.767606 test: 0.770118
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({1: 7429, 0: 3233})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  53.29696935415268 Time :  8245
accuracy train: 0.913254 val: 0.757746 test: 0.768993
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({0: 7427, 1: 3235})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  52.88548518717289 Time :  8277
accuracy train: 0.915286 val: 0.770423 test: 0.768711
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({0: 7416, 1: 3246})

Epoch :  16 loss training:  52.74358847737312 Time :  8313
accuracy train: 0.921069 val: 0.769014 test: 0.770681
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({1: 7416, 0: 3246})

Epoch :  17 loss training:  51.51131850481033 Time :  8345
accuracy train: 0.923414 val: 0.771831 test: 0.770681
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({1: 7412, 0: 3250})

Epoch :  18 loss training:  48.91601129621267 Time :  8380
accuracy train: 0.929978 val: 0.771831 test: 0.770681
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({1: 7393, 0: 3269})

Epoch :  19 loss training:  48.375230729579926 Time :  8415
accuracy train: 0.933886 val: 0.773239 test: 0.770962
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({0: 7394, 1: 3268})

Epoch :  20 loss training:  46.81991719454527 Time :  8448
accuracy train: 0.936230 val: 0.766197 test: 0.768711
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({0: 7393, 1: 3269})

Epoch :  21 loss training:  45.9301278591156 Time :  8483
accuracy train: 0.944514 val: 0.767606 test: 0.770400
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({1: 7383, 0: 3279})

Epoch :  22 loss training:  43.36168124526739 Time :  8518
accuracy train: 0.947796 val: 0.774648 test: 0.770681
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({0: 7371, 1: 3291})

Epoch :  23 loss training:  41.324921898543835 Time :  8555
accuracy train: 0.953267 val: 0.769014 test: 0.768149
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({1: 7357, 0: 3305})

Epoch :  24 loss training:  41.02013585716486 Time :  8590
accuracy train: 0.959050 val: 0.769014 test: 0.768993
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({1: 7350, 0: 3312})

Epoch :  25 loss training:  40.00614553689957 Time :  8630
accuracy train: 0.961707 val: 0.773239 test: 0.763647
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({1: 7328, 0: 3334})

Epoch :  26 loss training:  38.32636076211929 Time :  8674
accuracy train: 0.964208 val: 0.770423 test: 0.766460
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({0: 7314, 1: 3348})

Epoch :  27 loss training:  37.243939593434334 Time :  8713
accuracy train: 0.968271 val: 0.777465 test: 0.763365
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({0: 7315, 1: 3347})

Epoch :  28 loss training:  35.666027933359146 Time :  8755
accuracy train: 0.972491 val: 0.777465 test: 0.763928
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({0: 7306, 1: 3356})

Epoch :  29 loss training:  34.284744307398796 Time :  8793
accuracy train: 0.974523 val: 0.769014 test: 0.765053
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({0: 7305, 1: 3357})

Epoch :  30 loss training:  32.60100397840142 Time :  8829
accuracy train: 0.978431 val: 0.767606 test: 0.766742
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({0: 7293, 1: 3369})

Epoch :  31 loss training:  32.985233169049025 Time :  8864
accuracy train: 0.980463 val: 0.771831 test: 0.766742
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({0: 7270, 1: 3392})

Epoch :  32 loss training:  30.74494555592537 Time :  8899
accuracy train: 0.983276 val: 0.773239 test: 0.764209
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({1: 7268, 0: 3394})

Epoch :  33 loss training:  29.37081252783537 Time :  8931
accuracy train: 0.985308 val: 0.764789 test: 0.763647
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({0: 7244, 1: 3418})

Epoch :  34 loss training:  28.214761219918728 Time :  8964
accuracy train: 0.987652 val: 0.773239 test: 0.761677
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({0: 7241, 1: 3421})

Epoch :  35 loss training:  27.31484554335475 Time :  8999
accuracy train: 0.989528 val: 0.769014 test: 0.763647
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({0: 7229, 1: 3433})

Epoch :  36 loss training:  26.649622783064842 Time :  9033
accuracy train: 0.988590 val: 0.773239 test: 0.765053
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.768711
Counter({0: 7219, 1: 3443})

========================================================================================================================================================================================================
max acc epoch :  5
max validation accuracy :  0.7788732394366197
test accuracy :  0.7687113111986494
last test_accuracy :  0.765053460889139
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.80141 	 test_accuracy : 0.77096 	 max_acc epoch :  54 	 last test_accuracy : 0.76365
k :  1 	 val_accuracy : 0.79718 	 test_accuracy : 0.77321 	 max_acc epoch :  26 	 last test_accuracy : 0.76871
k :  2 	 val_accuracy : 0.78310 	 test_accuracy : 0.77349 	 max_acc epoch :  27 	 last test_accuracy : 0.77490
k :  3 	 val_accuracy : 0.77887 	 test_accuracy : 0.76871 	 max_acc epoch :  5 	 last test_accuracy : 0.76505

avg :  	 val_accuracy : 0.79014 	 test_accuracy : 0.77160 	 last_accuracy : 0.76808


date and time :  Mon May 24 18:33:38 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=663, weight_decay=1e-08)
device :  cuda:0
Counter({2: 5073, 1: 3422, 0: 2167})

Epoch :  1 loss training:  93.41987392306328 Time :  102
accuracy train: 0.792748 val: 0.771831 test: 0.773213
max validation accuracy : 0.771831 max acc epoch : 1 test accuracy : 0.773213
Counter({2: 7268, 1: 2210, 0: 1184})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.68533009290695 Time :  165
accuracy train: 0.803376 val: 0.770423 test: 0.771244
max validation accuracy : 0.771831 max acc epoch : 1 test accuracy : 0.773213
Counter({2: 7530, 1: 2334, 0: 798})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.61453732848167 Time :  229
accuracy train: 0.826508 val: 0.752113 test: 0.774057
max validation accuracy : 0.771831 max acc epoch : 1 test accuracy : 0.773213
Counter({0: 7321, 2: 2709, 1: 632})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  70.82592913508415 Time :  289
accuracy train: 0.844170 val: 0.763380 test: 0.776027
max validation accuracy : 0.771831 max acc epoch : 1 test accuracy : 0.773213
Counter({0: 7200, 1: 2840, 2: 622})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  69.43823477625847 Time :  344
accuracy train: 0.861363 val: 0.773239 test: 0.783905
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({0: 7431, 1: 2632, 2: 599})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  66.88406153023243 Time :  398
accuracy train: 0.864176 val: 0.756338 test: 0.777434
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({2: 7075, 0: 2693, 1: 894})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  62.04626455903053 Time :  448
accuracy train: 0.885433 val: 0.773239 test: 0.780248
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({0: 7002, 2: 2789, 1: 871})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  60.635893017053604 Time :  499
accuracy train: 0.883401 val: 0.752113 test: 0.777997
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({2: 7123, 0: 2715, 1: 824})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  58.84725825488567 Time :  543
accuracy train: 0.902938 val: 0.770423 test: 0.783343
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({2: 7194, 1: 2636, 0: 832})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  55.99086673557758 Time :  593
accuracy train: 0.904658 val: 0.767606 test: 0.783624
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({1: 7163, 0: 2694, 2: 805})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  54.962038934230804 Time :  641
accuracy train: 0.910284 val: 0.769014 test: 0.783905
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({2: 7199, 1: 2663, 0: 800})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  54.70479829609394 Time :  686
accuracy train: 0.917787 val: 0.767606 test: 0.783624
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({1: 7173, 0: 2696, 2: 793})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  52.083229795098305 Time :  734
accuracy train: 0.921069 val: 0.764789 test: 0.781654
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({1: 7178, 0: 2692, 2: 792})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  51.00261590629816 Time :  779
accuracy train: 0.923882 val: 0.759155 test: 0.781936
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({0: 7184, 1: 2690, 2: 788})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  50.422178253531456 Time :  835
accuracy train: 0.928259 val: 0.764789 test: 0.782217
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({1: 7168, 0: 2699, 2: 795})

Epoch :  16 loss training:  50.56290342658758 Time :  887
accuracy train: 0.932479 val: 0.764789 test: 0.785031
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({0: 7135, 1: 2734, 2: 793})

Epoch :  17 loss training:  47.82228642702103 Time :  941
accuracy train: 0.936699 val: 0.759155 test: 0.782780
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({0: 7132, 1: 2739, 2: 791})

Epoch :  18 loss training:  47.70857819914818 Time :  1000
accuracy train: 0.941701 val: 0.764789 test: 0.778278
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({1: 7086, 2: 2775, 0: 801})

Epoch :  19 loss training:  45.985854774713516 Time :  1051
accuracy train: 0.945764 val: 0.760563 test: 0.781373
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({0: 7060, 1: 2804, 2: 798})

Epoch :  20 loss training:  43.77936597913504 Time :  1100
accuracy train: 0.949359 val: 0.766197 test: 0.783061
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({1: 7038, 0: 2819, 2: 805})

Epoch :  21 loss training:  42.75718520581722 Time :  1153
accuracy train: 0.951547 val: 0.759155 test: 0.779685
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({2: 6985, 1: 2837, 0: 840})

Epoch :  22 loss training:  40.658462047576904 Time :  1208
accuracy train: 0.958112 val: 0.756338 test: 0.781936
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({1: 6934, 0: 2892, 2: 836})

Epoch :  23 loss training:  39.99605683982372 Time :  1260
accuracy train: 0.961082 val: 0.764789 test: 0.779122
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({1: 6879, 2: 2927, 0: 856})

Epoch :  24 loss training:  39.43453401327133 Time :  1318
accuracy train: 0.964208 val: 0.766197 test: 0.779122
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({0: 6851, 2: 2945, 1: 866})

Epoch :  25 loss training:  36.672246262431145 Time :  1378
accuracy train: 0.968428 val: 0.766197 test: 0.782780
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({0: 6784, 2: 3006, 1: 872})

Epoch :  26 loss training:  36.836656019091606 Time :  1442
accuracy train: 0.968428 val: 0.770423 test: 0.779403
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({0: 6763, 1: 3011, 2: 888})

Epoch :  27 loss training:  36.40894492715597 Time :  1493
accuracy train: 0.972648 val: 0.770423 test: 0.782217
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({0: 6763, 2: 3010, 1: 889})

Epoch :  28 loss training:  34.697001338005066 Time :  1543
accuracy train: 0.972491 val: 0.763380 test: 0.779403
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({2: 6741, 0: 3028, 1: 893})

Epoch :  29 loss training:  33.03248663619161 Time :  1595
accuracy train: 0.977024 val: 0.771831 test: 0.779966
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({0: 6744, 1: 3023, 2: 895})

Epoch :  30 loss training:  31.506080608814955 Time :  1641
accuracy train: 0.980619 val: 0.764789 test: 0.782499
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({0: 6713, 2: 3042, 1: 907})

Epoch :  31 loss training:  31.476236429065466 Time :  1690
accuracy train: 0.980150 val: 0.766197 test: 0.779685
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({2: 6741, 1: 3027, 0: 894})

Epoch :  32 loss training:  29.968294620513916 Time :  1734
accuracy train: 0.984370 val: 0.771831 test: 0.778559
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({1: 6702, 0: 3050, 2: 910})

Epoch :  33 loss training:  28.464438047260046 Time :  1778
accuracy train: 0.984683 val: 0.761972 test: 0.775746
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({1: 6686, 0: 3055, 2: 921})

Epoch :  34 loss training:  29.012368999421597 Time :  1838
accuracy train: 0.985933 val: 0.760563 test: 0.776308
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({0: 6653, 2: 3066, 1: 943})

Epoch :  35 loss training:  27.42174296453595 Time :  1891
accuracy train: 0.988121 val: 0.764789 test: 0.776308
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({1: 6548, 0: 3123, 2: 991})

Epoch :  36 loss training:  25.775141950696707 Time :  1954
accuracy train: 0.989059 val: 0.767606 test: 0.776590
max validation accuracy : 0.773239 max acc epoch : 5 test accuracy : 0.783905
Counter({0: 6511, 2: 3124, 1: 1027})

========================================================================================================================================================================================================
max acc epoch :  5
max validation accuracy :  0.7732394366197183
test accuracy :  0.7839054586381542
last test_accuracy :  0.7765897580191333
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=663, weight_decay=1e-08)
device :  cuda:0
Counter({2: 5073, 1: 3422, 0: 2167})

Epoch :  1 loss training:  93.47765770554543 Time :  2082
accuracy train: 0.788528 val: 0.764789 test: 0.770400
max validation accuracy : 0.764789 max acc epoch : 1 test accuracy : 0.770400
Counter({1: 7204, 2: 2246, 0: 1212})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  84.09176313877106 Time :  2146
accuracy train: 0.798531 val: 0.766197 test: 0.768430
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768430
Counter({1: 7631, 0: 2263, 2: 768})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.25501304864883 Time :  2219
accuracy train: 0.826039 val: 0.743662 test: 0.777997
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768430
Counter({0: 7930, 1: 1987, 2: 745})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  71.04789698123932 Time :  2288
accuracy train: 0.846358 val: 0.760563 test: 0.778841
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768430
Counter({0: 7780, 1: 2077, 2: 805})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  69.35601663589478 Time :  2350
accuracy train: 0.858550 val: 0.760563 test: 0.779403
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768430
Counter({2: 7821, 0: 2081, 1: 760})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  66.97108393907547 Time :  2400
accuracy train: 0.864333 val: 0.761972 test: 0.779403
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768430
Counter({0: 7807, 1: 2131, 2: 724})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  62.80268332362175 Time :  2451
accuracy train: 0.881213 val: 0.760563 test: 0.778841
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768430
Counter({0: 7773, 1: 2156, 2: 733})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  60.87122751772404 Time :  2504
accuracy train: 0.882307 val: 0.760563 test: 0.777153
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768430
Counter({2: 7813, 0: 2146, 1: 703})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  59.60564425587654 Time :  2558
accuracy train: 0.899812 val: 0.764789 test: 0.781654
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768430
Counter({1: 7790, 2: 2164, 0: 708})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  56.62651139497757 Time :  2615
accuracy train: 0.901844 val: 0.761972 test: 0.783343
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768430
Counter({1: 7793, 0: 2169, 2: 700})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  55.43213686347008 Time :  2669
accuracy train: 0.909972 val: 0.764789 test: 0.783061
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768430
Counter({0: 7796, 1: 2171, 2: 695})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  54.91416792571545 Time :  2719
accuracy train: 0.916068 val: 0.761972 test: 0.784468
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768430
Counter({2: 7803, 1: 2161, 0: 698})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  52.78986646234989 Time :  2771
accuracy train: 0.919037 val: 0.760563 test: 0.782499
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768430
Counter({2: 7798, 1: 2155, 0: 709})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  51.220997378230095 Time :  2821
accuracy train: 0.922319 val: 0.761972 test: 0.780810
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768430
Counter({0: 7805, 1: 2147, 2: 710})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  50.99852693080902 Time :  2879
accuracy train: 0.925914 val: 0.759155 test: 0.783624
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768430
Counter({0: 7802, 2: 2148, 1: 712})

Epoch :  16 loss training:  51.47486390173435 Time :  2931
accuracy train: 0.931229 val: 0.760563 test: 0.783343
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768430
Counter({0: 7797, 1: 2157, 2: 708})

Epoch :  17 loss training:  49.03517359495163 Time :  2981
accuracy train: 0.935449 val: 0.766197 test: 0.784187
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768430
Counter({1: 7769, 0: 2163, 2: 730})

Epoch :  18 loss training:  48.031171068549156 Time :  3032
accuracy train: 0.937480 val: 0.754930 test: 0.779685
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.768430
Counter({1: 7731, 0: 2192, 2: 739})

Epoch :  19 loss training:  46.2346216738224 Time :  3089
accuracy train: 0.943107 val: 0.776056 test: 0.781936
max validation accuracy : 0.776056 max acc epoch : 19 test accuracy : 0.781936
Counter({2: 7706, 1: 2207, 0: 749})

Epoch :  20 loss training:  43.7981194332242 Time :  3151
accuracy train: 0.947484 val: 0.769014 test: 0.779966
max validation accuracy : 0.776056 max acc epoch : 19 test accuracy : 0.781936
Counter({2: 7693, 1: 2202, 0: 767})

Epoch :  21 loss training:  43.568942323327065 Time :  3209
accuracy train: 0.951547 val: 0.767606 test: 0.777715
max validation accuracy : 0.776056 max acc epoch : 19 test accuracy : 0.781936
Counter({0: 7673, 1: 2196, 2: 793})

Epoch :  22 loss training:  41.22025688737631 Time :  3273
accuracy train: 0.958893 val: 0.769014 test: 0.777153
max validation accuracy : 0.776056 max acc epoch : 19 test accuracy : 0.781936
Counter({2: 7644, 1: 2220, 0: 798})

Epoch :  23 loss training:  40.39963857829571 Time :  3336
accuracy train: 0.960769 val: 0.769014 test: 0.777715
max validation accuracy : 0.776056 max acc epoch : 19 test accuracy : 0.781936
Counter({0: 7592, 1: 2237, 2: 833})

Epoch :  24 loss training:  39.69811613112688 Time :  3405
accuracy train: 0.962019 val: 0.770423 test: 0.776871
max validation accuracy : 0.776056 max acc epoch : 19 test accuracy : 0.781936
Counter({1: 7581, 0: 2241, 2: 840})

Epoch :  25 loss training:  35.518151849508286 Time :  3473
accuracy train: 0.967490 val: 0.776056 test: 0.778278
max validation accuracy : 0.776056 max acc epoch : 19 test accuracy : 0.781936
Counter({1: 7483, 0: 2318, 2: 861})

Epoch :  26 loss training:  37.136831015348434 Time :  3547
accuracy train: 0.968271 val: 0.776056 test: 0.776871
max validation accuracy : 0.776056 max acc epoch : 19 test accuracy : 0.781936
Counter({2: 7472, 0: 2321, 1: 869})

Epoch :  27 loss training:  36.44877280294895 Time :  3613
accuracy train: 0.974367 val: 0.774648 test: 0.778559
max validation accuracy : 0.776056 max acc epoch : 19 test accuracy : 0.781936
Counter({2: 7455, 1: 2323, 0: 884})

Epoch :  28 loss training:  34.77842824906111 Time :  3689
accuracy train: 0.973742 val: 0.771831 test: 0.775464
max validation accuracy : 0.776056 max acc epoch : 19 test accuracy : 0.781936
Counter({0: 7454, 1: 2323, 2: 885})

Epoch :  29 loss training:  33.77060879021883 Time :  3751
accuracy train: 0.978743 val: 0.771831 test: 0.778559
max validation accuracy : 0.776056 max acc epoch : 19 test accuracy : 0.781936
Counter({1: 7446, 0: 2332, 2: 884})

Epoch :  30 loss training:  32.24149859696627 Time :  3811
accuracy train: 0.982026 val: 0.773239 test: 0.776308
max validation accuracy : 0.776056 max acc epoch : 19 test accuracy : 0.781936
Counter({2: 7428, 0: 2341, 1: 893})

Epoch :  31 loss training:  32.378009270876646 Time :  3871
accuracy train: 0.982026 val: 0.770423 test: 0.776871
max validation accuracy : 0.776056 max acc epoch : 19 test accuracy : 0.781936
Counter({0: 7414, 2: 2345, 1: 903})

Epoch :  32 loss training:  29.68777498230338 Time :  3933
accuracy train: 0.983589 val: 0.780282 test: 0.776027
max validation accuracy : 0.780282 max acc epoch : 32 test accuracy : 0.776027
Counter({0: 7319, 1: 2424, 2: 919})

Epoch :  33 loss training:  28.58691155537963 Time :  4002
accuracy train: 0.985777 val: 0.783099 test: 0.774057
max validation accuracy : 0.783099 max acc epoch : 33 test accuracy : 0.774057
Counter({2: 7309, 1: 2429, 0: 924})

Epoch :  34 loss training:  28.970148716121912 Time :  4080
accuracy train: 0.988434 val: 0.774648 test: 0.775464
max validation accuracy : 0.783099 max acc epoch : 33 test accuracy : 0.774057
Counter({0: 7295, 1: 2434, 2: 933})

Epoch :  35 loss training:  27.797733657062054 Time :  4141
accuracy train: 0.989528 val: 0.777465 test: 0.774339
max validation accuracy : 0.783099 max acc epoch : 33 test accuracy : 0.774057
Counter({1: 7271, 0: 2447, 2: 944})

Epoch :  36 loss training:  25.90279718860984 Time :  4203
accuracy train: 0.989684 val: 0.777465 test: 0.774339
max validation accuracy : 0.783099 max acc epoch : 33 test accuracy : 0.774057
Counter({0: 7212, 1: 2452, 2: 998})

Epoch :  37 loss training:  25.29831059463322 Time :  4284
accuracy train: 0.991091 val: 0.773239 test: 0.772088
max validation accuracy : 0.783099 max acc epoch : 33 test accuracy : 0.774057
Counter({0: 7126, 1: 2505, 2: 1031})

Epoch :  38 loss training:  24.58696237206459 Time :  4371
accuracy train: 0.990622 val: 0.773239 test: 0.770118
max validation accuracy : 0.783099 max acc epoch : 33 test accuracy : 0.774057
Counter({2: 5895, 1: 2488, 0: 2279})

Epoch :  39 loss training:  23.352659843862057 Time :  4469
accuracy train: 0.993748 val: 0.778873 test: 0.775464
max validation accuracy : 0.783099 max acc epoch : 33 test accuracy : 0.774057
Counter({0: 5876, 2: 2503, 1: 2283})

Epoch :  40 loss training:  23.27271569147706 Time :  4533
accuracy train: 0.993904 val: 0.774648 test: 0.774620
max validation accuracy : 0.783099 max acc epoch : 33 test accuracy : 0.774057
Counter({0: 5702, 1: 2500, 2: 2460})

Epoch :  41 loss training:  20.767690245062113 Time :  4604
accuracy train: 0.994998 val: 0.773239 test: 0.774620
max validation accuracy : 0.783099 max acc epoch : 33 test accuracy : 0.774057
Counter({0: 5706, 1: 2480, 2: 2476})

Epoch :  42 loss training:  22.178044948726892 Time :  4656
accuracy train: 0.994373 val: 0.766197 test: 0.774339
max validation accuracy : 0.783099 max acc epoch : 33 test accuracy : 0.774057
Counter({2: 5591, 1: 2599, 0: 2472})

Epoch :  43 loss training:  21.882803592830896 Time :  4721
accuracy train: 0.995780 val: 0.771831 test: 0.772651
max validation accuracy : 0.783099 max acc epoch : 33 test accuracy : 0.774057
Counter({2: 5593, 1: 2595, 0: 2474})

Epoch :  44 loss training:  19.200096663087606 Time :  4776
accuracy train: 0.996561 val: 0.773239 test: 0.775746
max validation accuracy : 0.783099 max acc epoch : 33 test accuracy : 0.774057
Counter({0: 5610, 2: 2575, 1: 2477})

Epoch :  45 loss training:  18.907625071704388 Time :  4830
accuracy train: 0.996093 val: 0.770423 test: 0.775746
max validation accuracy : 0.783099 max acc epoch : 33 test accuracy : 0.774057
Counter({2: 5600, 0: 2576, 1: 2486})

Epoch :  46 loss training:  18.763540843501687 Time :  4881
accuracy train: 0.997187 val: 0.770423 test: 0.771806
max validation accuracy : 0.783099 max acc epoch : 33 test accuracy : 0.774057
Counter({1: 5630, 0: 2551, 2: 2481})

Epoch :  47 loss training:  18.49354279972613 Time :  4931
accuracy train: 0.997968 val: 0.776056 test: 0.773213
max validation accuracy : 0.783099 max acc epoch : 33 test accuracy : 0.774057
Counter({2: 5614, 0: 2569, 1: 2479})

Epoch :  48 loss training:  17.319650726392865 Time :  4979
accuracy train: 0.998124 val: 0.770423 test: 0.775183
max validation accuracy : 0.783099 max acc epoch : 33 test accuracy : 0.774057
Counter({0: 5632, 2: 2548, 1: 2482})

Epoch :  49 loss training:  15.607812453061342 Time :  5036
accuracy train: 0.998124 val: 0.776056 test: 0.771525
max validation accuracy : 0.783099 max acc epoch : 33 test accuracy : 0.774057
Counter({2: 5640, 0: 2532, 1: 2490})

Epoch :  50 loss training:  16.62294496782124 Time :  5094
accuracy train: 0.998124 val: 0.763380 test: 0.775183
max validation accuracy : 0.783099 max acc epoch : 33 test accuracy : 0.774057
Counter({2: 5648, 1: 2514, 0: 2500})

Epoch :  51 loss training:  14.735170941799879 Time :  5148
accuracy train: 0.999062 val: 0.771831 test: 0.767304
max validation accuracy : 0.783099 max acc epoch : 33 test accuracy : 0.774057
Counter({1: 5676, 0: 2504, 2: 2482})

Epoch :  52 loss training:  14.52218428067863 Time :  5204
accuracy train: 0.999062 val: 0.769014 test: 0.771806
max validation accuracy : 0.783099 max acc epoch : 33 test accuracy : 0.774057
Counter({0: 5651, 2: 2521, 1: 2490})

Epoch :  53 loss training:  13.585781524889171 Time :  5250
accuracy train: 0.999062 val: 0.777465 test: 0.774620
max validation accuracy : 0.783099 max acc epoch : 33 test accuracy : 0.774057
Counter({0: 5649, 2: 2524, 1: 2489})

Epoch :  54 loss training:  13.710169978439808 Time :  5296
accuracy train: 0.999062 val: 0.787324 test: 0.773495
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({0: 5761, 1: 2507, 2: 2394})

Epoch :  55 loss training:  14.152908205986023 Time :  5339
accuracy train: 0.999375 val: 0.778873 test: 0.770962
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({0: 5761, 1: 2523, 2: 2378})

Epoch :  56 loss training:  13.257237170822918 Time :  5387
accuracy train: 0.999219 val: 0.777465 test: 0.774620
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({2: 5734, 1: 2522, 0: 2406})

Epoch :  57 loss training:  12.440344884525985 Time :  5434
accuracy train: 0.999375 val: 0.769014 test: 0.774057
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({0: 5712, 1: 2538, 2: 2412})

Epoch :  58 loss training:  11.7861572150141 Time :  5481
accuracy train: 0.999219 val: 0.770423 test: 0.773776
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({0: 5698, 2: 2565, 1: 2399})

Epoch :  59 loss training:  11.341675095260143 Time :  5526
accuracy train: 0.999531 val: 0.774648 test: 0.772932
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({0: 5683, 2: 2575, 1: 2404})

Epoch :  60 loss training:  12.044982803985476 Time :  5572
accuracy train: 0.999531 val: 0.778873 test: 0.773495
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({2: 5669, 0: 2591, 1: 2402})

Epoch :  61 loss training:  10.924483695067465 Time :  5617
accuracy train: 0.999375 val: 0.778873 test: 0.771244
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({0: 5679, 2: 2602, 1: 2381})

Epoch :  62 loss training:  11.136637144722044 Time :  5664
accuracy train: 0.999687 val: 0.767606 test: 0.776027
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({0: 5693, 2: 2612, 1: 2357})

Epoch :  63 loss training:  10.831961728166789 Time :  5710
accuracy train: 0.999531 val: 0.773239 test: 0.772088
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({1: 5641, 2: 2625, 0: 2396})

Epoch :  64 loss training:  10.190036416985095 Time :  5756
accuracy train: 0.999531 val: 0.767606 test: 0.775183
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({0: 5638, 2: 2660, 1: 2364})

Epoch :  65 loss training:  10.072710627689958 Time :  5806
accuracy train: 0.999687 val: 0.766197 test: 0.770681
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({0: 5635, 1: 2655, 2: 2372})

Epoch :  66 loss training:  8.491198387928307 Time :  5853
accuracy train: 0.999687 val: 0.769014 test: 0.776308
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({0: 5640, 1: 2657, 2: 2365})

Epoch :  67 loss training:  9.257869061548263 Time :  5899
accuracy train: 0.999531 val: 0.763380 test: 0.770962
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({2: 5651, 0: 2656, 1: 2355})

Epoch :  68 loss training:  8.831203861627728 Time :  5947
accuracy train: 0.999687 val: 0.769014 test: 0.770400
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({1: 5566, 2: 2655, 0: 2441})

Epoch :  69 loss training:  8.057887971401215 Time :  5998
accuracy train: 0.999687 val: 0.771831 test: 0.774057
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({2: 5581, 0: 2642, 1: 2439})

Epoch :  70 loss training:  8.29717025347054 Time :  6045
accuracy train: 0.999531 val: 0.770423 test: 0.772932
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({2: 5610, 0: 2642, 1: 2410})

Epoch :  71 loss training:  8.27666539279744 Time :  6090
accuracy train: 0.999531 val: 0.770423 test: 0.770118
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({0: 5632, 1: 2645, 2: 2385})

Epoch :  72 loss training:  6.740991364233196 Time :  6135
accuracy train: 0.999531 val: 0.773239 test: 0.773213
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({1: 5605, 0: 2641, 2: 2416})

Epoch :  73 loss training:  7.408670384902507 Time :  6188
accuracy train: 0.999687 val: 0.771831 test: 0.768993
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({0: 5622, 1: 2635, 2: 2405})

Epoch :  74 loss training:  8.40384137397632 Time :  6235
accuracy train: 0.999844 val: 0.773239 test: 0.772088
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({0: 5683, 2: 2644, 1: 2335})

Epoch :  75 loss training:  7.513727930840105 Time :  6283
accuracy train: 0.999687 val: 0.774648 test: 0.768993
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({0: 5685, 1: 2630, 2: 2347})

Epoch :  76 loss training:  6.123178323730826 Time :  6327
accuracy train: 0.999531 val: 0.773239 test: 0.771525
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({0: 5707, 1: 2639, 2: 2316})

Epoch :  77 loss training:  6.062425337266177 Time :  6374
accuracy train: 0.999687 val: 0.773239 test: 0.770681
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({0: 5657, 1: 2648, 2: 2357})

Epoch :  78 loss training:  7.125267649302259 Time :  6426
accuracy train: 1.000000 val: 0.769014 test: 0.776308
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({0: 5635, 1: 2648, 2: 2379})

Epoch :  79 loss training:  6.466014044475742 Time :  6477
accuracy train: 0.999687 val: 0.771831 test: 0.771525
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({2: 5671, 0: 2643, 1: 2348})

Epoch :  80 loss training:  6.241707103792578 Time :  6528
accuracy train: 0.999844 val: 0.778873 test: 0.776027
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({2: 5627, 0: 2688, 1: 2347})

Epoch :  81 loss training:  6.483204624149948 Time :  6581
accuracy train: 1.000000 val: 0.763380 test: 0.772651
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({2: 5652, 1: 2678, 0: 2332})

Epoch :  82 loss training:  6.108858639374375 Time :  6633
accuracy train: 0.999844 val: 0.774648 test: 0.774620
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({1: 5636, 2: 2671, 0: 2355})

Epoch :  83 loss training:  6.342301749158651 Time :  6681
accuracy train: 0.999844 val: 0.764789 test: 0.770400
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({0: 5654, 2: 2677, 1: 2331})

Epoch :  84 loss training:  6.342793726827949 Time :  6725
accuracy train: 1.000000 val: 0.761972 test: 0.773776
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({0: 5625, 1: 2689, 2: 2348})

Epoch :  85 loss training:  5.811883931048214 Time :  6768
accuracy train: 1.000000 val: 0.759155 test: 0.771525
max validation accuracy : 0.787324 max acc epoch : 54 test accuracy : 0.773495
Counter({1: 5641, 0: 2697, 2: 2324})

========================================================================================================================================================================================================
max acc epoch :  54
max validation accuracy :  0.7873239436619718
test accuracy :  0.7734946539110861
last test_accuracy :  0.7715250422059651
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=663, weight_decay=1e-08)
device :  cuda:0
Counter({2: 5073, 1: 3422, 0: 2167})

Epoch :  1 loss training:  93.52624315023422 Time :  6888
accuracy train: 0.793060 val: 0.761972 test: 0.770962
max validation accuracy : 0.761972 max acc epoch : 1 test accuracy : 0.770962
Counter({2: 7285, 1: 2247, 0: 1130})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.66718778014183 Time :  6945
accuracy train: 0.791966 val: 0.760563 test: 0.768430
max validation accuracy : 0.761972 max acc epoch : 1 test accuracy : 0.770962
Counter({0: 7539, 1: 2172, 2: 951})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.64048287272453 Time :  7002
accuracy train: 0.827133 val: 0.745070 test: 0.778841
max validation accuracy : 0.761972 max acc epoch : 1 test accuracy : 0.770962
Counter({0: 7587, 1: 2204, 2: 871})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  71.03389927744865 Time :  7054
accuracy train: 0.845577 val: 0.757746 test: 0.778841
max validation accuracy : 0.761972 max acc epoch : 1 test accuracy : 0.770962
Counter({0: 7523, 1: 2252, 2: 887})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  69.55232301354408 Time :  7100
accuracy train: 0.856830 val: 0.767606 test: 0.782499
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.782499
Counter({0: 7482, 1: 2314, 2: 866})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  66.61666510999203 Time :  7154
accuracy train: 0.864489 val: 0.759155 test: 0.777153
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.782499
Counter({0: 7388, 1: 2355, 2: 919})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  62.448312520980835 Time :  7209
accuracy train: 0.881369 val: 0.766197 test: 0.778559
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.782499
Counter({1: 7302, 2: 2457, 0: 903})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  61.28324793279171 Time :  7263
accuracy train: 0.881369 val: 0.766197 test: 0.776308
max validation accuracy : 0.767606 max acc epoch : 5 test accuracy : 0.782499
Counter({0: 7393, 1: 2393, 2: 876})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  59.58648498356342 Time :  7317
accuracy train: 0.897937 val: 0.770423 test: 0.783343
max validation accuracy : 0.770423 max acc epoch : 9 test accuracy : 0.783343
Counter({2: 7477, 1: 2321, 0: 864})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  56.163213178515434 Time :  7373
accuracy train: 0.900907 val: 0.754930 test: 0.781654
max validation accuracy : 0.770423 max acc epoch : 9 test accuracy : 0.783343
Counter({2: 7441, 0: 2367, 1: 854})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  55.08009198307991 Time :  7426
accuracy train: 0.908409 val: 0.764789 test: 0.779685
max validation accuracy : 0.770423 max acc epoch : 9 test accuracy : 0.783343
Counter({1: 7534, 0: 2269, 2: 859})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  54.969760313630104 Time :  7473
accuracy train: 0.913410 val: 0.769014 test: 0.783905
max validation accuracy : 0.770423 max acc epoch : 9 test accuracy : 0.783343
Counter({0: 7474, 1: 2335, 2: 853})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  52.554318219423294 Time :  7531
accuracy train: 0.917005 val: 0.764789 test: 0.781936
max validation accuracy : 0.770423 max acc epoch : 9 test accuracy : 0.783343
Counter({0: 7498, 2: 2316, 1: 848})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  52.073172613978386 Time :  7586
accuracy train: 0.920600 val: 0.764789 test: 0.781654
max validation accuracy : 0.770423 max acc epoch : 9 test accuracy : 0.783343
Counter({1: 7513, 2: 2313, 0: 836})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  51.04896046221256 Time :  7649
accuracy train: 0.921851 val: 0.761972 test: 0.782217
max validation accuracy : 0.770423 max acc epoch : 9 test accuracy : 0.783343
Counter({2: 7469, 1: 2354, 0: 839})

Epoch :  16 loss training:  50.62250639498234 Time :  7712
accuracy train: 0.927946 val: 0.763380 test: 0.780529
max validation accuracy : 0.770423 max acc epoch : 9 test accuracy : 0.783343
Counter({1: 7449, 2: 2366, 0: 847})

Epoch :  17 loss training:  48.92349784821272 Time :  7773
accuracy train: 0.933729 val: 0.764789 test: 0.781092
max validation accuracy : 0.770423 max acc epoch : 9 test accuracy : 0.783343
Counter({0: 7436, 1: 2380, 2: 846})

Epoch :  18 loss training:  48.219462685287 Time :  7834
accuracy train: 0.940450 val: 0.761972 test: 0.776308
max validation accuracy : 0.770423 max acc epoch : 9 test accuracy : 0.783343
Counter({2: 7401, 1: 2402, 0: 859})

Epoch :  19 loss training:  46.23311948031187 Time :  7890
accuracy train: 0.940763 val: 0.763380 test: 0.780248
max validation accuracy : 0.770423 max acc epoch : 9 test accuracy : 0.783343
Counter({1: 7365, 0: 2428, 2: 869})

Epoch :  20 loss training:  43.99656656384468 Time :  7946
accuracy train: 0.946233 val: 0.769014 test: 0.777715
max validation accuracy : 0.770423 max acc epoch : 9 test accuracy : 0.783343
Counter({2: 7346, 1: 2443, 0: 873})

Epoch :  21 loss training:  43.76217174530029 Time :  8002
accuracy train: 0.949515 val: 0.771831 test: 0.776027
max validation accuracy : 0.771831 max acc epoch : 21 test accuracy : 0.776027
Counter({1: 7305, 2: 2466, 0: 891})

Epoch :  22 loss training:  41.255567736923695 Time :  8062
accuracy train: 0.957487 val: 0.773239 test: 0.781092
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({2: 7246, 0: 2518, 1: 898})

Epoch :  23 loss training:  40.72935909032822 Time :  8114
accuracy train: 0.959206 val: 0.764789 test: 0.779122
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({1: 7225, 2: 2530, 0: 907})

Epoch :  24 loss training:  39.86463615298271 Time :  8178
accuracy train: 0.962488 val: 0.770423 test: 0.780810
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({0: 7227, 1: 2516, 2: 919})

Epoch :  25 loss training:  36.90424583107233 Time :  8237
accuracy train: 0.966396 val: 0.766197 test: 0.778559
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({1: 7168, 0: 2535, 2: 959})

Epoch :  26 loss training:  37.06386398524046 Time :  8298
accuracy train: 0.967646 val: 0.773239 test: 0.777715
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({1: 7105, 0: 2588, 2: 969})

Epoch :  27 loss training:  36.798338040709496 Time :  8364
accuracy train: 0.973429 val: 0.764789 test: 0.778841
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({1: 7028, 2: 2640, 0: 994})

Epoch :  28 loss training:  35.766606092453 Time :  8425
accuracy train: 0.973898 val: 0.763380 test: 0.777153
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({0: 6998, 1: 2658, 2: 1006})

Epoch :  29 loss training:  34.12731245905161 Time :  8476
accuracy train: 0.977806 val: 0.767606 test: 0.775464
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({1: 7001, 2: 2658, 0: 1003})

Epoch :  30 loss training:  31.991582863032818 Time :  8535
accuracy train: 0.980775 val: 0.766197 test: 0.777153
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({1: 6972, 0: 2693, 2: 997})

Epoch :  31 loss training:  32.49554321169853 Time :  8589
accuracy train: 0.981088 val: 0.764789 test: 0.774339
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({2: 6979, 1: 2685, 0: 998})

Epoch :  32 loss training:  30.19525020569563 Time :  8651
accuracy train: 0.984058 val: 0.771831 test: 0.779403
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({2: 6860, 1: 2786, 0: 1016})

Epoch :  33 loss training:  28.63863467797637 Time :  8711
accuracy train: 0.986402 val: 0.769014 test: 0.776308
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({1: 6875, 2: 2770, 0: 1017})

Epoch :  34 loss training:  28.43907220289111 Time :  8776
accuracy train: 0.986246 val: 0.769014 test: 0.772369
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({2: 6859, 0: 2780, 1: 1023})

Epoch :  35 loss training:  26.670023132115602 Time :  8859
accuracy train: 0.988903 val: 0.764789 test: 0.774339
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({0: 6813, 2: 2784, 1: 1065})

Epoch :  36 loss training:  25.689129188656807 Time :  8937
accuracy train: 0.989997 val: 0.769014 test: 0.776871
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({0: 6813, 1: 2781, 2: 1068})

Epoch :  37 loss training:  26.03108387440443 Time :  9005
accuracy train: 0.992185 val: 0.760563 test: 0.773776
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({1: 6796, 2: 2780, 0: 1086})

Epoch :  38 loss training:  24.83342471718788 Time :  9133
accuracy train: 0.990778 val: 0.766197 test: 0.776308
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({2: 5395, 1: 2676, 0: 2591})

Epoch :  39 loss training:  23.449816893786192 Time :  9216
accuracy train: 0.994686 val: 0.764789 test: 0.777434
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({0: 5404, 2: 2668, 1: 2590})

Epoch :  40 loss training:  23.147307090461254 Time :  9278
accuracy train: 0.994373 val: 0.771831 test: 0.777153
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({1: 5245, 2: 2733, 0: 2684})

Epoch :  41 loss training:  20.361731393262744 Time :  9348
accuracy train: 0.996093 val: 0.766197 test: 0.771806
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({2: 5276, 1: 2731, 0: 2655})

Epoch :  42 loss training:  22.173436358571053 Time :  9406
accuracy train: 0.995780 val: 0.764789 test: 0.776590
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({0: 5280, 1: 2803, 2: 2579})

Epoch :  43 loss training:  21.86910747922957 Time :  9473
accuracy train: 0.996093 val: 0.759155 test: 0.768711
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({1: 5274, 0: 2832, 2: 2556})

Epoch :  44 loss training:  19.499326637014747 Time :  9526
accuracy train: 0.997187 val: 0.764789 test: 0.772932
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({2: 5321, 0: 2841, 1: 2500})

Epoch :  45 loss training:  19.21354798413813 Time :  9580
accuracy train: 0.997343 val: 0.760563 test: 0.776871
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({1: 5240, 0: 2870, 2: 2552})

Epoch :  46 loss training:  18.644451760686934 Time :  9633
accuracy train: 0.997812 val: 0.764789 test: 0.772369
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({2: 5302, 0: 2878, 1: 2482})

Epoch :  47 loss training:  18.34465874172747 Time :  9687
accuracy train: 0.998124 val: 0.766197 test: 0.766460
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({2: 5279, 0: 2904, 1: 2479})

Epoch :  48 loss training:  16.606114646419883 Time :  9735
accuracy train: 0.998124 val: 0.769014 test: 0.770681
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({1: 5262, 2: 2925, 0: 2475})

Epoch :  49 loss training:  16.148356532678008 Time :  9786
accuracy train: 0.998437 val: 0.770423 test: 0.770962
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({0: 5234, 1: 2940, 2: 2488})

Epoch :  50 loss training:  16.644273469224572 Time :  9834
accuracy train: 0.998906 val: 0.763380 test: 0.771244
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({2: 5217, 1: 2948, 0: 2497})

Epoch :  51 loss training:  15.123843140900135 Time :  9881
accuracy train: 0.998906 val: 0.761972 test: 0.765053
max validation accuracy : 0.773239 max acc epoch : 22 test accuracy : 0.781092
Counter({2: 5267, 0: 2954, 1: 2441})

Epoch :  52 loss training:  14.566081669181585 Time :  9937
accuracy train: 0.999062 val: 0.777465 test: 0.771806
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({2: 5231, 0: 2992, 1: 2439})

Epoch :  53 loss training:  13.891969116404653 Time :  9988
accuracy train: 0.999062 val: 0.769014 test: 0.768993
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({2: 5260, 0: 2989, 1: 2413})

Epoch :  54 loss training:  14.195386413484812 Time :  10040
accuracy train: 0.999062 val: 0.769014 test: 0.766742
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({1: 5247, 0: 3002, 2: 2413})

Epoch :  55 loss training:  13.29279074864462 Time :  10086
accuracy train: 0.999219 val: 0.764789 test: 0.765898
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({1: 5220, 0: 2989, 2: 2453})

Epoch :  56 loss training:  12.62186131440103 Time :  10132
accuracy train: 0.998906 val: 0.769014 test: 0.769555
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({1: 5198, 2: 3007, 0: 2457})

Epoch :  57 loss training:  12.085901217535138 Time :  10177
accuracy train: 0.999062 val: 0.767606 test: 0.767023
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({1: 5184, 2: 3002, 0: 2476})

Epoch :  58 loss training:  12.261157883796841 Time :  10223
accuracy train: 0.999375 val: 0.766197 test: 0.771806
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({0: 5190, 1: 2973, 2: 2499})

Epoch :  59 loss training:  11.184920246712863 Time :  10270
accuracy train: 0.999531 val: 0.770423 test: 0.770400
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({1: 5231, 0: 2964, 2: 2467})

Epoch :  60 loss training:  11.600231818854809 Time :  10317
accuracy train: 0.999687 val: 0.764789 test: 0.770118
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({2: 5211, 1: 2970, 0: 2481})

Epoch :  61 loss training:  11.02322450093925 Time :  10363
accuracy train: 0.999844 val: 0.771831 test: 0.768711
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({2: 5234, 1: 2971, 0: 2457})

Epoch :  62 loss training:  10.898362868931144 Time :  10407
accuracy train: 0.999687 val: 0.761972 test: 0.769837
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({1: 5262, 0: 2936, 2: 2464})

Epoch :  63 loss training:  10.760476793162525 Time :  10451
accuracy train: 0.999531 val: 0.767606 test: 0.765335
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({2: 5204, 0: 2930, 1: 2528})

Epoch :  64 loss training:  10.013514880090952 Time :  10501
accuracy train: 0.999531 val: 0.769014 test: 0.768149
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({0: 5245, 2: 2913, 1: 2504})

Epoch :  65 loss training:  9.663530222140253 Time :  10550
accuracy train: 0.999375 val: 0.764789 test: 0.768430
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({2: 5282, 1: 2913, 0: 2467})

Epoch :  66 loss training:  8.793535742908716 Time :  10608
accuracy train: 0.999687 val: 0.769014 test: 0.766742
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({0: 5225, 2: 2930, 1: 2507})

Epoch :  67 loss training:  9.189441359601915 Time :  10660
accuracy train: 0.999687 val: 0.760563 test: 0.767023
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({2: 5231, 0: 2938, 1: 2493})

Epoch :  68 loss training:  8.564166483236477 Time :  10712
accuracy train: 0.999687 val: 0.763380 test: 0.767023
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({2: 5300, 0: 2926, 1: 2436})

Epoch :  69 loss training:  7.292312558274716 Time :  10760
accuracy train: 0.999844 val: 0.766197 test: 0.771244
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({2: 5271, 1: 2953, 0: 2438})

Epoch :  70 loss training:  7.996935434406623 Time :  10810
accuracy train: 1.000000 val: 0.769014 test: 0.767867
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({0: 5287, 2: 2941, 1: 2434})

Epoch :  71 loss training:  8.115648238686845 Time :  10862
accuracy train: 0.999844 val: 0.771831 test: 0.765053
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({2: 5259, 0: 2935, 1: 2468})

Epoch :  72 loss training:  6.636179469060153 Time :  10912
accuracy train: 0.999844 val: 0.774648 test: 0.769274
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({0: 5244, 1: 2953, 2: 2465})

Epoch :  73 loss training:  6.923430787632242 Time :  10959
accuracy train: 0.999844 val: 0.764789 test: 0.763365
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({0: 5214, 1: 2957, 2: 2491})

Epoch :  74 loss training:  7.199022932210937 Time :  11009
accuracy train: 1.000000 val: 0.764789 test: 0.765053
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({0: 5244, 2: 2949, 1: 2469})

Epoch :  75 loss training:  6.762538873357698 Time :  11059
accuracy train: 1.000000 val: 0.760563 test: 0.765616
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({1: 5296, 0: 2953, 2: 2413})

Epoch :  76 loss training:  6.135461066616699 Time :  11109
accuracy train: 1.000000 val: 0.764789 test: 0.761677
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({2: 5304, 1: 2952, 0: 2406})

Epoch :  77 loss training:  6.358222045586444 Time :  11158
accuracy train: 1.000000 val: 0.754930 test: 0.759145
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({2: 5347, 0: 2965, 1: 2350})

Epoch :  78 loss training:  6.615816168952733 Time :  11213
accuracy train: 1.000000 val: 0.761972 test: 0.761114
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({0: 5413, 2: 2962, 1: 2287})

Epoch :  79 loss training:  5.730680433567613 Time :  11268
accuracy train: 1.000000 val: 0.750704 test: 0.759707
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({2: 5416, 1: 2928, 0: 2318})

Epoch :  80 loss training:  6.106460424489342 Time :  11319
accuracy train: 1.000000 val: 0.759155 test: 0.763084
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({0: 5420, 1: 2905, 2: 2337})

Epoch :  81 loss training:  6.267045859247446 Time :  11373
accuracy train: 1.000000 val: 0.756338 test: 0.759145
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({2: 5380, 0: 2909, 1: 2373})

Epoch :  82 loss training:  6.44780163129326 Time :  11421
accuracy train: 1.000000 val: 0.746479 test: 0.759426
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({1: 5435, 0: 2920, 2: 2307})

Epoch :  83 loss training:  6.258946595713496 Time :  11469
accuracy train: 1.000000 val: 0.745070 test: 0.754643
max validation accuracy : 0.777465 max acc epoch : 52 test accuracy : 0.771806
Counter({2: 5457, 0: 2868, 1: 2337})

========================================================================================================================================================================================================
max acc epoch :  52
max validation accuracy :  0.7774647887323943
test accuracy :  0.7718064153066967
last test_accuracy :  0.7546426561620709
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=663, weight_decay=1e-08)
device :  cuda:0
Counter({2: 5073, 1: 3422, 0: 2167})

Epoch :  1 loss training:  93.5160785317421 Time :  11600
accuracy train: 0.786183 val: 0.753521 test: 0.769274
max validation accuracy : 0.753521 max acc epoch : 1 test accuracy : 0.769274
Counter({0: 7392, 1: 2169, 2: 1101})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  83.92796191573143 Time :  11663
accuracy train: 0.800094 val: 0.761972 test: 0.772369
max validation accuracy : 0.761972 max acc epoch : 2 test accuracy : 0.772369
Counter({2: 7712, 1: 2440, 0: 510})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.50318589806557 Time :  11734
accuracy train: 0.828071 val: 0.752113 test: 0.777715
max validation accuracy : 0.761972 max acc epoch : 2 test accuracy : 0.772369
Counter({2: 7662, 0: 2384, 1: 616})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  71.23272457718849 Time :  11799
accuracy train: 0.845420 val: 0.770423 test: 0.777434
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.777434
Counter({1: 7473, 0: 2372, 2: 817})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  69.52551651000977 Time :  11859
accuracy train: 0.859175 val: 0.767606 test: 0.778559
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.777434
Counter({0: 7422, 1: 2368, 2: 872})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  66.64985613524914 Time :  11915
accuracy train: 0.865427 val: 0.760563 test: 0.773776
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.777434
Counter({2: 7269, 1: 2390, 0: 1003})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  62.87096908688545 Time :  11985
accuracy train: 0.883557 val: 0.766197 test: 0.777997
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.777434
Counter({1: 7266, 2: 2398, 0: 998})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  60.633233681321144 Time :  12051
accuracy train: 0.884808 val: 0.760563 test: 0.775746
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.777434
Counter({0: 7279, 2: 2400, 1: 983})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  60.08429695665836 Time :  12113
accuracy train: 0.901219 val: 0.763380 test: 0.776027
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.777434
Counter({1: 7154, 2: 2436, 0: 1072})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  56.21644613146782 Time :  12183
accuracy train: 0.906221 val: 0.764789 test: 0.777997
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.777434
Counter({0: 7050, 1: 2457, 2: 1155})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  55.29090656340122 Time :  12247
accuracy train: 0.910284 val: 0.770423 test: 0.777997
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.777434
Counter({1: 7106, 0: 2442, 2: 1114})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  54.83968989551067 Time :  12301
accuracy train: 0.917162 val: 0.763380 test: 0.777715
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.777434
Counter({1: 7103, 2: 2448, 0: 1111})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  53.070541977882385 Time :  12354
accuracy train: 0.917318 val: 0.769014 test: 0.779966
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.777434
Counter({2: 7106, 0: 2447, 1: 1109})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  51.66893708705902 Time :  12405
accuracy train: 0.922632 val: 0.763380 test: 0.780248
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.777434
Counter({1: 7106, 2: 2444, 0: 1112})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  50.963989078998566 Time :  12454
accuracy train: 0.926071 val: 0.759155 test: 0.780529
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.777434
Counter({0: 7127, 1: 2443, 2: 1092})

Epoch :  16 loss training:  51.1961060911417 Time :  12502
accuracy train: 0.931385 val: 0.766197 test: 0.780248
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.777434
Counter({0: 7099, 1: 2463, 2: 1100})

Epoch :  17 loss training:  48.82812529057264 Time :  12551
accuracy train: 0.937324 val: 0.764789 test: 0.777715
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.777434
Counter({0: 7112, 1: 2464, 2: 1086})

Epoch :  18 loss training:  48.264352321624756 Time :  12601
accuracy train: 0.939669 val: 0.761972 test: 0.775746
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.777434
Counter({2: 7088, 1: 2468, 0: 1106})

Epoch :  19 loss training:  46.55237194895744 Time :  12661
accuracy train: 0.942795 val: 0.766197 test: 0.777434
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.777434
Counter({1: 7053, 0: 2488, 2: 1121})

Epoch :  20 loss training:  43.86421433836222 Time :  12712
accuracy train: 0.948734 val: 0.769014 test: 0.780529
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.777434
Counter({2: 7020, 1: 2493, 0: 1149})

Epoch :  21 loss training:  43.32283781468868 Time :  12771
accuracy train: 0.953892 val: 0.766197 test: 0.778841
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.777434
Counter({1: 6953, 2: 2488, 0: 1221})

Epoch :  22 loss training:  40.80558532476425 Time :  12863
accuracy train: 0.957956 val: 0.766197 test: 0.781092
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.777434
Counter({2: 6879, 1: 2568, 0: 1215})

Epoch :  23 loss training:  39.98741427809 Time :  12920
accuracy train: 0.962957 val: 0.769014 test: 0.779685
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.777434
Counter({0: 6870, 1: 2573, 2: 1219})

Epoch :  24 loss training:  39.43964909017086 Time :  12982
accuracy train: 0.965614 val: 0.760563 test: 0.778278
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.777434
Counter({2: 6843, 1: 2580, 0: 1239})

Epoch :  25 loss training:  37.679835975170135 Time :  13053
accuracy train: 0.968584 val: 0.767606 test: 0.777997
max validation accuracy : 0.770423 max acc epoch : 4 test accuracy : 0.777434
Counter({0: 6833, 1: 2583, 2: 1246})

Epoch :  26 loss training:  37.145470671355724 Time :  13124
accuracy train: 0.971397 val: 0.773239 test: 0.779966
max validation accuracy : 0.773239 max acc epoch : 26 test accuracy : 0.779966
Counter({1: 6833, 0: 2581, 2: 1248})

Epoch :  27 loss training:  36.96855188906193 Time :  13189
accuracy train: 0.975148 val: 0.769014 test: 0.779685
max validation accuracy : 0.773239 max acc epoch : 26 test accuracy : 0.779966
Counter({0: 6812, 1: 2586, 2: 1264})

Epoch :  28 loss training:  35.344805128872395 Time :  13274
accuracy train: 0.977806 val: 0.767606 test: 0.779685
max validation accuracy : 0.773239 max acc epoch : 26 test accuracy : 0.779966
Counter({2: 6769, 1: 2623, 0: 1270})

Epoch :  29 loss training:  34.11410638317466 Time :  13346
accuracy train: 0.979369 val: 0.767606 test: 0.778841
max validation accuracy : 0.773239 max acc epoch : 26 test accuracy : 0.779966
Counter({1: 6790, 2: 2616, 0: 1256})

Epoch :  30 loss training:  32.08249435201287 Time :  13415
accuracy train: 0.983901 val: 0.771831 test: 0.776871
max validation accuracy : 0.773239 max acc epoch : 26 test accuracy : 0.779966
Counter({2: 6743, 1: 2650, 0: 1269})

Epoch :  31 loss training:  32.05735057964921 Time :  13476
accuracy train: 0.983589 val: 0.774648 test: 0.774902
max validation accuracy : 0.774648 max acc epoch : 31 test accuracy : 0.774902
Counter({1: 6748, 2: 2659, 0: 1255})

Epoch :  32 loss training:  29.590046364814043 Time :  13529
accuracy train: 0.987027 val: 0.773239 test: 0.775746
max validation accuracy : 0.774648 max acc epoch : 31 test accuracy : 0.774902
Counter({0: 6678, 1: 2705, 2: 1279})

Epoch :  33 loss training:  28.818931248039007 Time :  13591
accuracy train: 0.987809 val: 0.771831 test: 0.774057
max validation accuracy : 0.774648 max acc epoch : 31 test accuracy : 0.774902
Counter({2: 6614, 1: 2727, 0: 1321})

Epoch :  34 loss training:  28.848474137485027 Time :  13658
accuracy train: 0.987652 val: 0.777465 test: 0.776308
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({2: 6584, 0: 2751, 1: 1327})

Epoch :  35 loss training:  27.14852226525545 Time :  13737
accuracy train: 0.990622 val: 0.767606 test: 0.775746
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({2: 6487, 1: 2840, 0: 1335})

Epoch :  36 loss training:  26.16911786235869 Time :  13846
accuracy train: 0.991560 val: 0.770423 test: 0.777997
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({2: 6466, 1: 2846, 0: 1350})

Epoch :  37 loss training:  25.831037050113082 Time :  13910
accuracy train: 0.992341 val: 0.769014 test: 0.773495
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({1: 6417, 0: 2848, 2: 1397})

Epoch :  38 loss training:  24.634579580277205 Time :  13971
accuracy train: 0.992185 val: 0.771831 test: 0.774057
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({0: 4970, 2: 2889, 1: 2803})

Epoch :  39 loss training:  23.493043364956975 Time :  14045
accuracy train: 0.994217 val: 0.767606 test: 0.776027
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({1: 4982, 2: 2874, 0: 2806})

Epoch :  40 loss training:  22.807387333363295 Time :  14099
accuracy train: 0.993748 val: 0.767606 test: 0.774620
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({0: 4986, 2: 2860, 1: 2816})

Epoch :  41 loss training:  20.116376830264926 Time :  14155
accuracy train: 0.995155 val: 0.769014 test: 0.774902
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({0: 5001, 2: 2846, 1: 2815})

Epoch :  42 loss training:  21.34278277680278 Time :  14206
accuracy train: 0.996093 val: 0.764789 test: 0.773213
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({2: 5044, 1: 2817, 0: 2801})

Epoch :  43 loss training:  19.955323096364737 Time :  14256
accuracy train: 0.995936 val: 0.760563 test: 0.772651
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({0: 5050, 1: 2831, 2: 2781})

Epoch :  44 loss training:  18.87061026133597 Time :  14309
accuracy train: 0.996561 val: 0.757746 test: 0.775464
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({2: 5133, 1: 2834, 0: 2695})

Epoch :  45 loss training:  18.930851332843304 Time :  14366
accuracy train: 0.997656 val: 0.763380 test: 0.775183
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({2: 5156, 0: 2848, 1: 2658})

Epoch :  46 loss training:  18.12402862869203 Time :  14420
accuracy train: 0.997812 val: 0.764789 test: 0.775464
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({0: 5239, 1: 2858, 2: 2565})

Epoch :  47 loss training:  17.291109919548035 Time :  14477
accuracy train: 0.998124 val: 0.753521 test: 0.770681
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({0: 5262, 1: 2862, 2: 2538})

Epoch :  48 loss training:  16.615909746848047 Time :  14534
accuracy train: 0.998593 val: 0.766197 test: 0.774057
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({1: 5286, 2: 2878, 0: 2498})

Epoch :  49 loss training:  15.358540954068303 Time :  14590
accuracy train: 0.998593 val: 0.749296 test: 0.773495
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({0: 5257, 1: 2918, 2: 2487})

Epoch :  50 loss training:  16.154985495842993 Time :  14645
accuracy train: 0.998750 val: 0.766197 test: 0.776308
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({2: 5445, 0: 2923, 1: 2294})

Epoch :  51 loss training:  15.003122434020042 Time :  14706
accuracy train: 0.998593 val: 0.756338 test: 0.771806
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({2: 5469, 1: 2942, 0: 2251})

Epoch :  52 loss training:  14.250713393092155 Time :  14763
accuracy train: 0.999062 val: 0.777465 test: 0.775464
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({1: 5521, 0: 2944, 2: 2197})

Epoch :  53 loss training:  13.361944001168013 Time :  14818
accuracy train: 0.998906 val: 0.754930 test: 0.770400
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({2: 5500, 0: 2948, 1: 2214})

Epoch :  54 loss training:  13.10909370612353 Time :  14871
accuracy train: 0.999062 val: 0.764789 test: 0.771806
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({0: 5507, 1: 2954, 2: 2201})

Epoch :  55 loss training:  13.315528159029782 Time :  14924
accuracy train: 0.998750 val: 0.759155 test: 0.769837
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({2: 5550, 0: 2978, 1: 2134})

Epoch :  56 loss training:  12.46184211364016 Time :  14975
accuracy train: 0.999062 val: 0.759155 test: 0.770118
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({2: 5541, 1: 2969, 0: 2152})

Epoch :  57 loss training:  12.830195067916065 Time :  15027
accuracy train: 0.999219 val: 0.759155 test: 0.774620
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({1: 5521, 0: 2990, 2: 2151})

Epoch :  58 loss training:  11.706746107432991 Time :  15078
accuracy train: 0.999531 val: 0.764789 test: 0.774620
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({1: 5566, 0: 3031, 2: 2065})

Epoch :  59 loss training:  11.00854500476271 Time :  15128
accuracy train: 0.999219 val: 0.767606 test: 0.770962
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({0: 5533, 2: 3020, 1: 2109})

Epoch :  60 loss training:  12.026425104122609 Time :  15176
accuracy train: 0.999687 val: 0.777465 test: 0.776308
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({0: 5559, 2: 3037, 1: 2066})

Epoch :  61 loss training:  10.342112087178975 Time :  15226
accuracy train: 0.999531 val: 0.764789 test: 0.773776
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({0: 5546, 1: 3042, 2: 2074})

Epoch :  62 loss training:  10.32361639663577 Time :  15273
accuracy train: 0.999844 val: 0.757746 test: 0.770962
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({0: 5575, 2: 3047, 1: 2040})

Epoch :  63 loss training:  10.253703597001731 Time :  15323
accuracy train: 0.999531 val: 0.764789 test: 0.766742
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({0: 5568, 2: 3060, 1: 2034})

Epoch :  64 loss training:  9.804661044850945 Time :  15370
accuracy train: 0.999375 val: 0.764789 test: 0.771806
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({2: 5623, 1: 3071, 0: 1968})

Epoch :  65 loss training:  9.400389477144927 Time :  15422
accuracy train: 0.999687 val: 0.764789 test: 0.770118
max validation accuracy : 0.777465 max acc epoch : 34 test accuracy : 0.776308
Counter({2: 5651, 1: 3078, 0: 1933})

========================================================================================================================================================================================================
max acc epoch :  34
max validation accuracy :  0.7774647887323943
test accuracy :  0.7763083849184018
last test_accuracy :  0.7701181767023073
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.77324 	 test_accuracy : 0.78391 	 max_acc epoch :  5 	 last test_accuracy : 0.77659
k :  1 	 val_accuracy : 0.78732 	 test_accuracy : 0.77349 	 max_acc epoch :  54 	 last test_accuracy : 0.77153
k :  2 	 val_accuracy : 0.77746 	 test_accuracy : 0.77181 	 max_acc epoch :  52 	 last test_accuracy : 0.75464
k :  3 	 val_accuracy : 0.77746 	 test_accuracy : 0.77631 	 max_acc epoch :  34 	 last test_accuracy : 0.77012

avg :  	 val_accuracy : 0.77887 	 test_accuracy : 0.77638 	 last_accuracy : 0.76822
