

date and time :  Thu Jun  3 19:59:04 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=663, weight_decay=1e-08)
device :  cuda:0

Epoch :  1 loss training:  92.27095067501068 Time :  12
accuracy train: 0.771647 val: 0.740845 test: 0.758863
max validation accuracy : 0.740845 max acc epoch : 1 test accuracy : 0.758863
Epoch-1 lr: 0.001

Epoch :  2 loss training:  84.98599627614021 Time :  23
accuracy train: 0.796186 val: 0.781690 test: 0.768430
max validation accuracy : 0.781690 max acc epoch : 2 test accuracy : 0.768430
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.3738844692707 Time :  33
accuracy train: 0.800406 val: 0.759155 test: 0.774902
max validation accuracy : 0.781690 max acc epoch : 2 test accuracy : 0.768430
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.68857535719872 Time :  44
accuracy train: 0.824476 val: 0.766197 test: 0.769837
max validation accuracy : 0.781690 max acc epoch : 2 test accuracy : 0.768430
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.4793318361044 Time :  53
accuracy train: 0.836824 val: 0.757746 test: 0.773776
max validation accuracy : 0.781690 max acc epoch : 2 test accuracy : 0.768430
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.18727359175682 Time :  63
accuracy train: 0.842920 val: 0.763380 test: 0.772651
max validation accuracy : 0.781690 max acc epoch : 2 test accuracy : 0.768430
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.75453037023544 Time :  73
accuracy train: 0.853861 val: 0.770423 test: 0.772651
max validation accuracy : 0.781690 max acc epoch : 2 test accuracy : 0.768430
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.01936709880829 Time :  83
accuracy train: 0.862457 val: 0.771831 test: 0.777434
max validation accuracy : 0.781690 max acc epoch : 2 test accuracy : 0.768430
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.13147938251495 Time :  93
accuracy train: 0.870272 val: 0.784507 test: 0.772088
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.53223925828934 Time :  103
accuracy train: 0.878087 val: 0.763380 test: 0.767586
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.83320310711861 Time :  114
accuracy train: 0.881838 val: 0.774648 test: 0.772088
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.35345643758774 Time :  127
accuracy train: 0.891997 val: 0.771831 test: 0.769274
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.16738483309746 Time :  137
accuracy train: 0.893092 val: 0.756338 test: 0.773495
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.978672593832016 Time :  147
accuracy train: 0.895123 val: 0.763380 test: 0.772651
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  55.94019031524658 Time :  157
accuracy train: 0.898406 val: 0.763380 test: 0.771244
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088

Epoch :  16 loss training:  56.2020868062973 Time :  167
accuracy train: 0.904814 val: 0.753521 test: 0.772088
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088

Epoch :  17 loss training:  54.75250335037708 Time :  175
accuracy train: 0.911847 val: 0.756338 test: 0.772088
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088

Epoch :  18 loss training:  53.13080930709839 Time :  184
accuracy train: 0.916849 val: 0.752113 test: 0.771525
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088

Epoch :  19 loss training:  51.41740722954273 Time :  194
accuracy train: 0.922945 val: 0.763380 test: 0.773213
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088

Epoch :  20 loss training:  50.0256358012557 Time :  205
accuracy train: 0.929040 val: 0.759155 test: 0.769555
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088

Epoch :  21 loss training:  49.244983837008476 Time :  214
accuracy train: 0.931854 val: 0.756338 test: 0.765335
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088

Epoch :  22 loss training:  46.1029286980629 Time :  228
accuracy train: 0.937480 val: 0.760563 test: 0.770681
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088

Epoch :  23 loss training:  44.91152761876583 Time :  239
accuracy train: 0.942795 val: 0.757746 test: 0.771244
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088

Epoch :  24 loss training:  43.73738420009613 Time :  248
accuracy train: 0.947952 val: 0.760563 test: 0.768993
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088

Epoch :  25 loss training:  42.37108771502972 Time :  258
accuracy train: 0.952173 val: 0.759155 test: 0.769837
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088

Epoch :  26 loss training:  40.28065810352564 Time :  268
accuracy train: 0.952485 val: 0.770423 test: 0.776308
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088

Epoch :  27 loss training:  39.92904421687126 Time :  278
accuracy train: 0.959206 val: 0.769014 test: 0.772369
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088

Epoch :  28 loss training:  39.14650708436966 Time :  286
accuracy train: 0.965145 val: 0.771831 test: 0.768430
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088

Epoch :  29 loss training:  37.02178876101971 Time :  296
accuracy train: 0.965771 val: 0.763380 test: 0.768430
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088

Epoch :  30 loss training:  35.03163565695286 Time :  306
accuracy train: 0.971710 val: 0.760563 test: 0.769274
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088

Epoch :  31 loss training:  35.31020946055651 Time :  316
accuracy train: 0.974992 val: 0.760563 test: 0.770400
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088

Epoch :  32 loss training:  31.816931623965502 Time :  329
accuracy train: 0.978274 val: 0.757746 test: 0.766179
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088

Epoch :  33 loss training:  32.0239602252841 Time :  339
accuracy train: 0.979837 val: 0.769014 test: 0.768993
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088

Epoch :  34 loss training:  30.95863651484251 Time :  348
accuracy train: 0.979681 val: 0.764789 test: 0.767586
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088

Epoch :  35 loss training:  29.961911227554083 Time :  358
accuracy train: 0.983432 val: 0.771831 test: 0.768711
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088

Epoch :  36 loss training:  28.55606932193041 Time :  368
accuracy train: 0.984526 val: 0.761972 test: 0.768993
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088

Epoch :  37 loss training:  27.47740099951625 Time :  377
accuracy train: 0.987652 val: 0.776056 test: 0.765335
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088

Epoch :  38 loss training:  26.70701176300645 Time :  388
accuracy train: 0.988121 val: 0.760563 test: 0.771806
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088

Epoch :  39 loss training:  24.130300741642714 Time :  398
accuracy train: 0.990935 val: 0.763380 test: 0.769555
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088

Epoch :  40 loss training:  24.23740247823298 Time :  408
accuracy train: 0.990466 val: 0.769014 test: 0.766460
max validation accuracy : 0.784507 max acc epoch : 9 test accuracy : 0.772088

========================================================================================================================================================================================================
max acc epoch :  9
max validation accuracy :  0.7845070422535211
test accuracy :  0.7720877884074282
last test_accuracy :  0.7664603263927968
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=663, weight_decay=1e-08)
device :  cuda:0

Epoch :  1 loss training:  92.14717331528664 Time :  420
accuracy train: 0.782745 val: 0.746479 test: 0.769274
max validation accuracy : 0.746479 max acc epoch : 1 test accuracy : 0.769274
Epoch-1 lr: 0.001

Epoch :  2 loss training:  84.77066648006439 Time :  432
accuracy train: 0.796655 val: 0.773239 test: 0.767867
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.767867
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.04906406998634 Time :  442
accuracy train: 0.807596 val: 0.756338 test: 0.774339
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.767867
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.22074666619301 Time :  452
accuracy train: 0.826508 val: 0.760563 test: 0.770681
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.767867
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.03284759819508 Time :  463
accuracy train: 0.839012 val: 0.771831 test: 0.773776
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.767867
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.04902809858322 Time :  472
accuracy train: 0.841982 val: 0.766197 test: 0.775464
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.767867
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.54490642249584 Time :  482
accuracy train: 0.860269 val: 0.773239 test: 0.772088
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.767867
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.33658519387245 Time :  492
accuracy train: 0.865427 val: 0.767606 test: 0.772369
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.767867
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.83855348825455 Time :  501
accuracy train: 0.874648 val: 0.766197 test: 0.773495
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.767867
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.500894233584404 Time :  511
accuracy train: 0.880900 val: 0.763380 test: 0.770681
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.767867
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.90551841259003 Time :  521
accuracy train: 0.884808 val: 0.764789 test: 0.773213
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.767867
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.28605626523495 Time :  534
accuracy train: 0.892935 val: 0.763380 test: 0.776027
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.767867
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.192345559597015 Time :  545
accuracy train: 0.892935 val: 0.763380 test: 0.776871
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.767867
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.567943170666695 Time :  555
accuracy train: 0.896374 val: 0.763380 test: 0.773495
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.767867
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  55.59049388766289 Time :  565
accuracy train: 0.897781 val: 0.761972 test: 0.772088
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.767867

Epoch :  16 loss training:  55.41540750861168 Time :  575
accuracy train: 0.904033 val: 0.769014 test: 0.774339
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.767867

Epoch :  17 loss training:  54.737833723425865 Time :  585
accuracy train: 0.911847 val: 0.769014 test: 0.771244
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.767867

Epoch :  18 loss training:  53.382213711738586 Time :  595
accuracy train: 0.917005 val: 0.764789 test: 0.772369
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.767867

Epoch :  19 loss training:  51.201902493834496 Time :  605
accuracy train: 0.923414 val: 0.769014 test: 0.775464
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.767867

Epoch :  20 loss training:  50.37163482606411 Time :  614
accuracy train: 0.928884 val: 0.774648 test: 0.774339
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  21 loss training:  48.79000371694565 Time :  624
accuracy train: 0.932791 val: 0.766197 test: 0.770681
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  22 loss training:  46.08385895937681 Time :  638
accuracy train: 0.935136 val: 0.769014 test: 0.773213
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  23 loss training:  45.01394822821021 Time :  648
accuracy train: 0.942951 val: 0.767606 test: 0.772088
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  24 loss training:  43.847487695515156 Time :  657
accuracy train: 0.947484 val: 0.773239 test: 0.772369
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  25 loss training:  41.77563899755478 Time :  665
accuracy train: 0.951704 val: 0.771831 test: 0.770681
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  26 loss training:  40.402953401207924 Time :  675
accuracy train: 0.953423 val: 0.773239 test: 0.772088
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  27 loss training:  40.07117713242769 Time :  685
accuracy train: 0.959675 val: 0.770423 test: 0.772651
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  28 loss training:  38.06582836061716 Time :  695
accuracy train: 0.965302 val: 0.767606 test: 0.771525
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  29 loss training:  36.78307446837425 Time :  705
accuracy train: 0.967490 val: 0.766197 test: 0.771525
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  30 loss training:  34.65428964793682 Time :  715
accuracy train: 0.970616 val: 0.760563 test: 0.773213
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  31 loss training:  34.830130606889725 Time :  725
accuracy train: 0.974523 val: 0.754930 test: 0.772088
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  32 loss training:  31.571765433996916 Time :  738
accuracy train: 0.976868 val: 0.773239 test: 0.772369
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  33 loss training:  31.773809906095266 Time :  747
accuracy train: 0.980775 val: 0.770423 test: 0.769837
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  34 loss training:  30.324047468602657 Time :  757
accuracy train: 0.980306 val: 0.771831 test: 0.770962
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  35 loss training:  29.03479690477252 Time :  767
accuracy train: 0.983276 val: 0.769014 test: 0.764209
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  36 loss training:  28.212110932916403 Time :  776
accuracy train: 0.984058 val: 0.767606 test: 0.772088
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  37 loss training:  26.888290045782924 Time :  786
accuracy train: 0.986558 val: 0.766197 test: 0.762240
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  38 loss training:  25.701023906469345 Time :  796
accuracy train: 0.988278 val: 0.766197 test: 0.770400
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  39 loss training:  23.639133967459202 Time :  806
accuracy train: 0.990935 val: 0.769014 test: 0.765898
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  40 loss training:  23.061467867344618 Time :  816
accuracy train: 0.989684 val: 0.774648 test: 0.767304
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  41 loss training:  22.459891073405743 Time :  827
accuracy train: 0.991560 val: 0.763380 test: 0.764772
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  42 loss training:  23.855782276019454 Time :  839
accuracy train: 0.993279 val: 0.770423 test: 0.767586
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  43 loss training:  22.613572377711535 Time :  850
accuracy train: 0.993748 val: 0.760563 test: 0.770118
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  44 loss training:  21.244365056976676 Time :  860
accuracy train: 0.995467 val: 0.760563 test: 0.770681
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  45 loss training:  20.01342229358852 Time :  870
accuracy train: 0.995624 val: 0.767606 test: 0.766179
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  46 loss training:  20.026573222130537 Time :  881
accuracy train: 0.996561 val: 0.763380 test: 0.765053
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  47 loss training:  19.107787538319826 Time :  891
accuracy train: 0.997030 val: 0.766197 test: 0.768430
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  48 loss training:  17.96270690858364 Time :  901
accuracy train: 0.997499 val: 0.771831 test: 0.768430
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  49 loss training:  16.170760080218315 Time :  911
accuracy train: 0.997968 val: 0.773239 test: 0.771244
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  50 loss training:  17.2182734310627 Time :  921
accuracy train: 0.997812 val: 0.766197 test: 0.766742
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

Epoch :  51 loss training:  16.57371438201517 Time :  932
accuracy train: 0.997968 val: 0.767606 test: 0.767304
max validation accuracy : 0.774648 max acc epoch : 20 test accuracy : 0.774339

========================================================================================================================================================================================================
max acc epoch :  20
max validation accuracy :  0.7746478873239436
test accuracy :  0.7743387732132808
last test_accuracy :  0.7673044456949916
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=663, weight_decay=1e-08)
device :  cuda:0

Epoch :  1 loss training:  92.17953670024872 Time :  946
accuracy train: 0.777587 val: 0.740845 test: 0.763084
max validation accuracy : 0.740845 max acc epoch : 1 test accuracy : 0.763084
Epoch-1 lr: 0.001

Epoch :  2 loss training:  84.78200051188469 Time :  956
accuracy train: 0.789153 val: 0.773239 test: 0.762240
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.762240
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.14400593936443 Time :  966
accuracy train: 0.797280 val: 0.756338 test: 0.771525
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.762240
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.69680970907211 Time :  976
accuracy train: 0.827602 val: 0.764789 test: 0.778559
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.762240
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.68150773644447 Time :  987
accuracy train: 0.837293 val: 0.760563 test: 0.778559
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.762240
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.27416095137596 Time :  997
accuracy train: 0.848078 val: 0.764789 test: 0.777997
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.762240
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.4812204092741 Time :  1007
accuracy train: 0.862457 val: 0.773239 test: 0.770118
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.762240
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.58966007828712 Time :  1017
accuracy train: 0.860894 val: 0.770423 test: 0.770681
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.762240
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.929755225777626 Time :  1027
accuracy train: 0.872773 val: 0.773239 test: 0.771244
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.762240
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.205000802874565 Time :  1038
accuracy train: 0.881525 val: 0.769014 test: 0.775183
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.762240
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  61.08244413137436 Time :  1049
accuracy train: 0.883870 val: 0.771831 test: 0.773213
max validation accuracy : 0.773239 max acc epoch : 2 test accuracy : 0.762240
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  60.019638016819954 Time :  1060
accuracy train: 0.889340 val: 0.776056 test: 0.773213
max validation accuracy : 0.776056 max acc epoch : 12 test accuracy : 0.773213
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.30385395884514 Time :  1069
accuracy train: 0.893404 val: 0.769014 test: 0.774902
max validation accuracy : 0.776056 max acc epoch : 12 test accuracy : 0.773213
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.06586515158415 Time :  1079
accuracy train: 0.895280 val: 0.771831 test: 0.772932
max validation accuracy : 0.776056 max acc epoch : 12 test accuracy : 0.773213
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  55.76961076259613 Time :  1089
accuracy train: 0.900125 val: 0.763380 test: 0.770681
max validation accuracy : 0.776056 max acc epoch : 12 test accuracy : 0.773213

Epoch :  16 loss training:  55.97222548723221 Time :  1100
accuracy train: 0.906690 val: 0.770423 test: 0.770400
max validation accuracy : 0.776056 max acc epoch : 12 test accuracy : 0.773213

Epoch :  17 loss training:  54.735100999474525 Time :  1110
accuracy train: 0.913723 val: 0.770423 test: 0.770400
max validation accuracy : 0.776056 max acc epoch : 12 test accuracy : 0.773213

Epoch :  18 loss training:  53.49659802019596 Time :  1120
accuracy train: 0.916849 val: 0.763380 test: 0.773495
max validation accuracy : 0.776056 max acc epoch : 12 test accuracy : 0.773213

Epoch :  19 loss training:  50.821097046136856 Time :  1130
accuracy train: 0.920600 val: 0.774648 test: 0.773776
max validation accuracy : 0.776056 max acc epoch : 12 test accuracy : 0.773213

Epoch :  20 loss training:  50.489920787513256 Time :  1140
accuracy train: 0.927946 val: 0.776056 test: 0.772369
max validation accuracy : 0.776056 max acc epoch : 12 test accuracy : 0.773213

Epoch :  21 loss training:  49.397221118211746 Time :  1154
accuracy train: 0.934511 val: 0.764789 test: 0.774057
max validation accuracy : 0.776056 max acc epoch : 12 test accuracy : 0.773213

Epoch :  22 loss training:  46.23264940083027 Time :  1164
accuracy train: 0.937949 val: 0.774648 test: 0.772369
max validation accuracy : 0.776056 max acc epoch : 12 test accuracy : 0.773213

Epoch :  23 loss training:  44.598452769219875 Time :  1174
accuracy train: 0.943576 val: 0.778873 test: 0.775464
max validation accuracy : 0.778873 max acc epoch : 23 test accuracy : 0.775464

Epoch :  24 loss training:  44.40376678854227 Time :  1184
accuracy train: 0.949047 val: 0.771831 test: 0.774902
max validation accuracy : 0.778873 max acc epoch : 23 test accuracy : 0.775464

Epoch :  25 loss training:  41.768384374678135 Time :  1194
accuracy train: 0.952641 val: 0.770423 test: 0.770962
max validation accuracy : 0.778873 max acc epoch : 23 test accuracy : 0.775464

Epoch :  26 loss training:  40.04459127038717 Time :  1204
accuracy train: 0.954361 val: 0.781690 test: 0.780810
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  27 loss training:  39.62448088824749 Time :  1214
accuracy train: 0.960456 val: 0.769014 test: 0.775464
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  28 loss training:  38.23489708453417 Time :  1224
accuracy train: 0.965302 val: 0.769014 test: 0.772932
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  29 loss training:  37.00175128132105 Time :  1234
accuracy train: 0.966396 val: 0.773239 test: 0.776871
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  30 loss training:  35.159765899181366 Time :  1244
accuracy train: 0.971866 val: 0.763380 test: 0.772369
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  31 loss training:  35.06801576912403 Time :  1257
accuracy train: 0.974054 val: 0.776056 test: 0.773495
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  32 loss training:  31.327602241188288 Time :  1268
accuracy train: 0.976868 val: 0.777465 test: 0.769555
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  33 loss training:  32.139174960553646 Time :  1278
accuracy train: 0.981713 val: 0.776056 test: 0.768993
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  34 loss training:  31.10127117857337 Time :  1289
accuracy train: 0.980932 val: 0.780282 test: 0.772651
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  35 loss training:  28.845224414020777 Time :  1299
accuracy train: 0.984214 val: 0.780282 test: 0.771525
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  36 loss training:  27.973133612424135 Time :  1309
accuracy train: 0.985777 val: 0.774648 test: 0.777434
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  37 loss training:  27.85724125057459 Time :  1319
accuracy train: 0.987496 val: 0.778873 test: 0.769274
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  38 loss training:  26.54315061867237 Time :  1330
accuracy train: 0.988903 val: 0.776056 test: 0.772651
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  39 loss training:  24.817410856485367 Time :  1340
accuracy train: 0.989997 val: 0.769014 test: 0.765616
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  40 loss training:  24.62463115528226 Time :  1350
accuracy train: 0.989841 val: 0.769014 test: 0.770962
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  41 loss training:  23.696207776665688 Time :  1363
accuracy train: 0.991404 val: 0.771831 test: 0.771244
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  42 loss training:  23.357107054442167 Time :  1373
accuracy train: 0.992967 val: 0.777465 test: 0.769837
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  43 loss training:  22.99248523451388 Time :  1383
accuracy train: 0.992654 val: 0.766197 test: 0.771525
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  44 loss training:  21.69215740635991 Time :  1392
accuracy train: 0.994530 val: 0.773239 test: 0.771806
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  45 loss training:  20.521857142448425 Time :  1403
accuracy train: 0.995155 val: 0.767606 test: 0.767867
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  46 loss training:  19.261056346818805 Time :  1413
accuracy train: 0.996718 val: 0.766197 test: 0.767586
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  47 loss training:  19.02462892048061 Time :  1422
accuracy train: 0.997343 val: 0.771831 test: 0.772088
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  48 loss training:  18.20485683484003 Time :  1432
accuracy train: 0.997030 val: 0.769014 test: 0.771525
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  49 loss training:  17.154929732903838 Time :  1441
accuracy train: 0.997656 val: 0.781690 test: 0.766460
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  50 loss training:  17.198739818297327 Time :  1451
accuracy train: 0.997499 val: 0.756338 test: 0.765335
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  51 loss training:  16.5140791060403 Time :  1466
accuracy train: 0.998124 val: 0.774648 test: 0.769555
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  52 loss training:  14.852224277332425 Time :  1475
accuracy train: 0.997968 val: 0.769014 test: 0.764772
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  53 loss training:  14.880121575668454 Time :  1486
accuracy train: 0.998750 val: 0.766197 test: 0.765335
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  54 loss training:  14.543868215754628 Time :  1496
accuracy train: 0.999219 val: 0.767606 test: 0.765616
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  55 loss training:  13.522228973917663 Time :  1506
accuracy train: 0.999531 val: 0.778873 test: 0.768993
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  56 loss training:  14.045169299468398 Time :  1516
accuracy train: 0.999531 val: 0.773239 test: 0.770400
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

Epoch :  57 loss training:  12.818044289946556 Time :  1527
accuracy train: 0.999687 val: 0.776056 test: 0.772651
max validation accuracy : 0.781690 max acc epoch : 26 test accuracy : 0.780810

========================================================================================================================================================================================================
max acc epoch :  26
max validation accuracy :  0.7816901408450704
test accuracy :  0.7808103545301069
last test_accuracy :  0.7726505346088914
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=663, weight_decay=1e-08)
device :  cuda:0

Epoch :  1 loss training:  92.19394460320473 Time :  1538
accuracy train: 0.777274 val: 0.749296 test: 0.761114
max validation accuracy : 0.749296 max acc epoch : 1 test accuracy : 0.761114
Epoch-1 lr: 0.001

Epoch :  2 loss training:  85.11613127589226 Time :  1548
accuracy train: 0.795874 val: 0.766197 test: 0.772369
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.772369
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.03437912464142 Time :  1560
accuracy train: 0.805877 val: 0.750704 test: 0.770400
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.772369
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.69631698727608 Time :  1571
accuracy train: 0.821976 val: 0.759155 test: 0.772932
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.772369
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.49576953053474 Time :  1582
accuracy train: 0.834011 val: 0.766197 test: 0.773495
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.772369
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.15245479345322 Time :  1591
accuracy train: 0.843701 val: 0.763380 test: 0.777153
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.772369
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.7809137403965 Time :  1601
accuracy train: 0.856518 val: 0.778873 test: 0.775183
max validation accuracy : 0.778873 max acc epoch : 7 test accuracy : 0.775183
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.73317764699459 Time :  1611
accuracy train: 0.863239 val: 0.774648 test: 0.776871
max validation accuracy : 0.778873 max acc epoch : 7 test accuracy : 0.775183
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.42245915532112 Time :  1621
accuracy train: 0.873242 val: 0.770423 test: 0.769837
max validation accuracy : 0.778873 max acc epoch : 7 test accuracy : 0.775183
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.00227378308773 Time :  1631
accuracy train: 0.878712 val: 0.773239 test: 0.773495
max validation accuracy : 0.778873 max acc epoch : 7 test accuracy : 0.775183
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.95564578473568 Time :  1640
accuracy train: 0.881994 val: 0.778873 test: 0.774902
max validation accuracy : 0.778873 max acc epoch : 7 test accuracy : 0.775183
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.26303394138813 Time :  1650
accuracy train: 0.893092 val: 0.769014 test: 0.771806
max validation accuracy : 0.778873 max acc epoch : 7 test accuracy : 0.775183
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.29504941403866 Time :  1659
accuracy train: 0.894655 val: 0.769014 test: 0.771525
max validation accuracy : 0.778873 max acc epoch : 7 test accuracy : 0.775183
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.08392255008221 Time :  1673
accuracy train: 0.898562 val: 0.770423 test: 0.769837
max validation accuracy : 0.778873 max acc epoch : 7 test accuracy : 0.775183
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  55.5174253731966 Time :  1684
accuracy train: 0.896843 val: 0.761972 test: 0.770118
max validation accuracy : 0.778873 max acc epoch : 7 test accuracy : 0.775183

Epoch :  16 loss training:  55.76093299686909 Time :  1693
accuracy train: 0.904189 val: 0.773239 test: 0.770681
max validation accuracy : 0.778873 max acc epoch : 7 test accuracy : 0.775183

Epoch :  17 loss training:  55.116985231637955 Time :  1703
accuracy train: 0.911535 val: 0.773239 test: 0.769837
max validation accuracy : 0.778873 max acc epoch : 7 test accuracy : 0.775183

Epoch :  18 loss training:  53.34772080183029 Time :  1713
accuracy train: 0.914973 val: 0.769014 test: 0.772651
max validation accuracy : 0.778873 max acc epoch : 7 test accuracy : 0.775183

Epoch :  19 loss training:  50.929345577955246 Time :  1722
accuracy train: 0.921694 val: 0.776056 test: 0.772088
max validation accuracy : 0.778873 max acc epoch : 7 test accuracy : 0.775183

Epoch :  20 loss training:  49.973696149885654 Time :  1733
accuracy train: 0.930603 val: 0.769014 test: 0.775746
max validation accuracy : 0.778873 max acc epoch : 7 test accuracy : 0.775183

Epoch :  21 loss training:  48.70685297250748 Time :  1743
accuracy train: 0.937168 val: 0.767606 test: 0.775183
max validation accuracy : 0.778873 max acc epoch : 7 test accuracy : 0.775183

Epoch :  22 loss training:  46.07985722273588 Time :  1753
accuracy train: 0.939825 val: 0.769014 test: 0.775183
max validation accuracy : 0.778873 max acc epoch : 7 test accuracy : 0.775183

Epoch :  23 loss training:  44.7793714851141 Time :  1763
accuracy train: 0.944670 val: 0.773239 test: 0.776027
max validation accuracy : 0.778873 max acc epoch : 7 test accuracy : 0.775183

Epoch :  24 loss training:  43.073286309838295 Time :  1772
accuracy train: 0.949984 val: 0.773239 test: 0.774057
max validation accuracy : 0.778873 max acc epoch : 7 test accuracy : 0.775183

Epoch :  25 loss training:  41.87600352615118 Time :  1787
accuracy train: 0.952485 val: 0.770423 test: 0.772369
max validation accuracy : 0.778873 max acc epoch : 7 test accuracy : 0.775183

Epoch :  26 loss training:  39.83100908994675 Time :  1798
accuracy train: 0.952954 val: 0.785915 test: 0.772369
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  27 loss training:  39.80633374303579 Time :  1808
accuracy train: 0.961550 val: 0.771831 test: 0.772369
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  28 loss training:  38.15678784996271 Time :  1818
accuracy train: 0.964364 val: 0.780282 test: 0.774057
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  29 loss training:  37.32720823585987 Time :  1828
accuracy train: 0.967490 val: 0.771831 test: 0.774339
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  30 loss training:  35.027590319514275 Time :  1837
accuracy train: 0.972648 val: 0.767606 test: 0.773776
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  31 loss training:  34.53234875947237 Time :  1847
accuracy train: 0.977962 val: 0.771831 test: 0.770118
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  32 loss training:  31.515954293310642 Time :  1858
accuracy train: 0.980150 val: 0.777465 test: 0.770681
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  33 loss training:  31.327391780912876 Time :  1868
accuracy train: 0.982338 val: 0.777465 test: 0.768149
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  34 loss training:  30.16412214934826 Time :  1878
accuracy train: 0.981400 val: 0.778873 test: 0.767304
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  35 loss training:  29.075105220079422 Time :  1890
accuracy train: 0.983901 val: 0.777465 test: 0.766460
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  36 loss training:  28.319507278501987 Time :  1902
accuracy train: 0.986871 val: 0.780282 test: 0.775183
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  37 loss training:  27.26228959672153 Time :  1912
accuracy train: 0.989372 val: 0.770423 test: 0.762521
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  38 loss training:  25.981602124869823 Time :  1923
accuracy train: 0.991247 val: 0.780282 test: 0.770400
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  39 loss training:  23.32317305356264 Time :  1932
accuracy train: 0.992185 val: 0.777465 test: 0.765616
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  40 loss training:  23.83054495602846 Time :  1942
accuracy train: 0.992341 val: 0.773239 test: 0.763365
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  41 loss training:  22.999054167419672 Time :  1953
accuracy train: 0.994061 val: 0.759155 test: 0.768993
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  42 loss training:  23.72591814957559 Time :  1963
accuracy train: 0.994998 val: 0.764789 test: 0.769555
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  43 loss training:  22.580180019140244 Time :  1973
accuracy train: 0.992967 val: 0.769014 test: 0.766179
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  44 loss training:  21.441284343600273 Time :  1984
accuracy train: 0.994686 val: 0.769014 test: 0.767023
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  45 loss training:  19.44640788435936 Time :  1994
accuracy train: 0.996249 val: 0.771831 test: 0.767023
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  46 loss training:  19.689798548817635 Time :  2009
accuracy train: 0.997812 val: 0.759155 test: 0.771806
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  47 loss training:  18.852078484371305 Time :  2019
accuracy train: 0.997968 val: 0.773239 test: 0.766742
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  48 loss training:  18.039140899199992 Time :  2028
accuracy train: 0.998124 val: 0.774648 test: 0.773495
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  49 loss training:  16.390200179070234 Time :  2039
accuracy train: 0.998124 val: 0.784507 test: 0.773495
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  50 loss training:  16.63947795331478 Time :  2050
accuracy train: 0.999062 val: 0.776056 test: 0.771244
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  51 loss training:  16.45089966710657 Time :  2060
accuracy train: 0.999219 val: 0.763380 test: 0.765053
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  52 loss training:  15.277881575748324 Time :  2069
accuracy train: 0.999062 val: 0.773239 test: 0.773213
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  53 loss training:  15.273971545509994 Time :  2078
accuracy train: 0.998750 val: 0.771831 test: 0.766179
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  54 loss training:  14.518425974994898 Time :  2085
accuracy train: 0.999219 val: 0.773239 test: 0.762521
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  55 loss training:  13.512685073539615 Time :  2094
accuracy train: 0.999531 val: 0.769014 test: 0.762240
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  56 loss training:  13.389823349192739 Time :  2105
accuracy train: 0.999844 val: 0.773239 test: 0.765898
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

Epoch :  57 loss training:  12.833194937556982 Time :  2115
accuracy train: 1.000000 val: 0.769014 test: 0.770962
max validation accuracy : 0.785915 max acc epoch : 26 test accuracy : 0.772369

========================================================================================================================================================================================================
max acc epoch :  26
max validation accuracy :  0.7859154929577464
test accuracy :  0.7723691615081598
last test_accuracy :  0.770962296004502
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=663, weight_decay=1e-08)
device :  cuda:0

Epoch :  1 loss training:  92.22466391324997 Time :  2125
accuracy train: 0.775086 val: 0.757746 test: 0.764491
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.764491
Epoch-1 lr: 0.001

Epoch :  2 loss training:  84.6104636490345 Time :  2135
accuracy train: 0.790872 val: 0.774648 test: 0.763647
max validation accuracy : 0.774648 max acc epoch : 2 test accuracy : 0.763647
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.04157407581806 Time :  2145
accuracy train: 0.802282 val: 0.757746 test: 0.773776
max validation accuracy : 0.774648 max acc epoch : 2 test accuracy : 0.763647
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.58786809444427 Time :  2155
accuracy train: 0.823382 val: 0.761972 test: 0.768711
max validation accuracy : 0.774648 max acc epoch : 2 test accuracy : 0.763647
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.30654096603394 Time :  2165
accuracy train: 0.833854 val: 0.761972 test: 0.774339
max validation accuracy : 0.774648 max acc epoch : 2 test accuracy : 0.763647
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.19369386136532 Time :  2173
accuracy train: 0.839325 val: 0.766197 test: 0.773776
max validation accuracy : 0.774648 max acc epoch : 2 test accuracy : 0.763647
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.59470848739147 Time :  2183
accuracy train: 0.860113 val: 0.770423 test: 0.775464
max validation accuracy : 0.774648 max acc epoch : 2 test accuracy : 0.763647
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.6566660553217 Time :  2193
accuracy train: 0.862301 val: 0.787324 test: 0.768149
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.26111754775047 Time :  2203
accuracy train: 0.872304 val: 0.769014 test: 0.769274
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.46001110970974 Time :  2218
accuracy train: 0.876837 val: 0.764789 test: 0.766179
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  61.01556587219238 Time :  2228
accuracy train: 0.881525 val: 0.771831 test: 0.770681
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.560423001646996 Time :  2238
accuracy train: 0.891997 val: 0.778873 test: 0.770681
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.73399302363396 Time :  2248
accuracy train: 0.892154 val: 0.778873 test: 0.773213
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.914085648953915 Time :  2257
accuracy train: 0.894342 val: 0.780282 test: 0.766742
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  55.84757427871227 Time :  2266
accuracy train: 0.896374 val: 0.774648 test: 0.768149
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149

Epoch :  16 loss training:  56.25790801644325 Time :  2276
accuracy train: 0.903407 val: 0.777465 test: 0.767304
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149

Epoch :  17 loss training:  54.69370099902153 Time :  2285
accuracy train: 0.911691 val: 0.778873 test: 0.770118
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149

Epoch :  18 loss training:  53.39770011603832 Time :  2295
accuracy train: 0.915442 val: 0.776056 test: 0.769837
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149

Epoch :  19 loss training:  50.78999209403992 Time :  2305
accuracy train: 0.923414 val: 0.777465 test: 0.772932
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149

Epoch :  20 loss training:  50.50499538332224 Time :  2315
accuracy train: 0.930447 val: 0.778873 test: 0.768430
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149

Epoch :  21 loss training:  48.835689187049866 Time :  2327
accuracy train: 0.935605 val: 0.767606 test: 0.768430
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149

Epoch :  22 loss training:  46.23203246295452 Time :  2338
accuracy train: 0.939981 val: 0.767606 test: 0.770118
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149

Epoch :  23 loss training:  45.61868201941252 Time :  2347
accuracy train: 0.948578 val: 0.766197 test: 0.770400
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149

Epoch :  24 loss training:  43.78609124571085 Time :  2358
accuracy train: 0.951860 val: 0.766197 test: 0.774339
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149

Epoch :  25 loss training:  41.61184997856617 Time :  2368
accuracy train: 0.956080 val: 0.764789 test: 0.771244
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149

Epoch :  26 loss training:  39.59985022991896 Time :  2378
accuracy train: 0.956549 val: 0.780282 test: 0.775464
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149

Epoch :  27 loss training:  40.36629881709814 Time :  2388
accuracy train: 0.964833 val: 0.767606 test: 0.774339
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149

Epoch :  28 loss training:  38.84221909940243 Time :  2398
accuracy train: 0.967959 val: 0.767606 test: 0.771244
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149

Epoch :  29 loss training:  37.067453399300575 Time :  2409
accuracy train: 0.969522 val: 0.763380 test: 0.770962
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149

Epoch :  30 loss training:  34.635568499565125 Time :  2419
accuracy train: 0.973429 val: 0.750704 test: 0.769274
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149

Epoch :  31 loss training:  35.01856954395771 Time :  2430
accuracy train: 0.975617 val: 0.760563 test: 0.769274
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149

Epoch :  32 loss training:  31.386803194880486 Time :  2443
accuracy train: 0.979212 val: 0.763380 test: 0.768430
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149

Epoch :  33 loss training:  31.85436676070094 Time :  2453
accuracy train: 0.981713 val: 0.763380 test: 0.766460
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149

Epoch :  34 loss training:  30.69765465706587 Time :  2463
accuracy train: 0.982182 val: 0.763380 test: 0.771244
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149

Epoch :  35 loss training:  29.23697028681636 Time :  2471
accuracy train: 0.984526 val: 0.767606 test: 0.767586
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149

Epoch :  36 loss training:  28.341941379010677 Time :  2481
accuracy train: 0.985152 val: 0.766197 test: 0.772651
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149

Epoch :  37 loss training:  27.20682768896222 Time :  2491
accuracy train: 0.987340 val: 0.763380 test: 0.768993
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149

Epoch :  38 loss training:  26.00482023693621 Time :  2501
accuracy train: 0.988746 val: 0.764789 test: 0.767023
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149

Epoch :  39 loss training:  23.66880163550377 Time :  2511
accuracy train: 0.991560 val: 0.763380 test: 0.768149
max validation accuracy : 0.787324 max acc epoch : 8 test accuracy : 0.768149

========================================================================================================================================================================================================
max acc epoch :  8
max validation accuracy :  0.7873239436619718
test accuracy :  0.7681485649971863
last test_accuracy :  0.7681485649971863
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=663, weight_decay=1e-08)
device :  cuda:0

Epoch :  1 loss training:  92.21510192751884 Time :  2522
accuracy train: 0.773679 val: 0.746479 test: 0.764772
max validation accuracy : 0.746479 max acc epoch : 1 test accuracy : 0.764772
Epoch-1 lr: 0.001

Epoch :  2 loss training:  84.99734902381897 Time :  2531
accuracy train: 0.794936 val: 0.778873 test: 0.775746
max validation accuracy : 0.778873 max acc epoch : 2 test accuracy : 0.775746
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.1678558588028 Time :  2543
accuracy train: 0.802751 val: 0.763380 test: 0.770118
max validation accuracy : 0.778873 max acc epoch : 2 test accuracy : 0.775746
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.94620269536972 Time :  2555
accuracy train: 0.822132 val: 0.763380 test: 0.777997
max validation accuracy : 0.778873 max acc epoch : 2 test accuracy : 0.775746
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.60151025652885 Time :  2565
accuracy train: 0.837293 val: 0.769014 test: 0.775746
max validation accuracy : 0.778873 max acc epoch : 2 test accuracy : 0.775746
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.67823231220245 Time :  2575
accuracy train: 0.843232 val: 0.769014 test: 0.770681
max validation accuracy : 0.778873 max acc epoch : 2 test accuracy : 0.775746
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.26233598589897 Time :  2585
accuracy train: 0.852454 val: 0.769014 test: 0.776590
max validation accuracy : 0.778873 max acc epoch : 2 test accuracy : 0.775746
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.26900132000446 Time :  2595
accuracy train: 0.856518 val: 0.773239 test: 0.774620
max validation accuracy : 0.778873 max acc epoch : 2 test accuracy : 0.775746
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.89691409468651 Time :  2604
accuracy train: 0.865427 val: 0.774648 test: 0.774339
max validation accuracy : 0.778873 max acc epoch : 2 test accuracy : 0.775746
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.362293392419815 Time :  2614
accuracy train: 0.875117 val: 0.776056 test: 0.778841
max validation accuracy : 0.778873 max acc epoch : 2 test accuracy : 0.775746
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  61.883583426475525 Time :  2623
accuracy train: 0.874961 val: 0.783099 test: 0.778559
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  60.926491379737854 Time :  2634
accuracy train: 0.883714 val: 0.776056 test: 0.771806
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  59.02991800010204 Time :  2644
accuracy train: 0.885120 val: 0.776056 test: 0.772088
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  58.84279169142246 Time :  2657
accuracy train: 0.886527 val: 0.774648 test: 0.771525
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  57.70087821781635 Time :  2668
accuracy train: 0.889340 val: 0.764789 test: 0.771806
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  16 loss training:  57.68374274671078 Time :  2678
accuracy train: 0.894967 val: 0.770423 test: 0.768711
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  17 loss training:  56.00948528945446 Time :  2687
accuracy train: 0.901063 val: 0.773239 test: 0.770962
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  18 loss training:  55.097563937306404 Time :  2698
accuracy train: 0.909190 val: 0.778873 test: 0.772651
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  19 loss training:  52.99997176229954 Time :  2707
accuracy train: 0.913098 val: 0.781690 test: 0.775464
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  20 loss training:  52.531382121145725 Time :  2717
accuracy train: 0.921382 val: 0.771831 test: 0.776308
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  21 loss training:  50.9902349114418 Time :  2728
accuracy train: 0.923414 val: 0.780282 test: 0.773213
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  22 loss training:  48.17829002439976 Time :  2738
accuracy train: 0.928415 val: 0.770423 test: 0.776027
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  23 loss training:  47.13782159984112 Time :  2749
accuracy train: 0.935292 val: 0.770423 test: 0.776027
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  24 loss training:  46.35825090110302 Time :  2761
accuracy train: 0.938731 val: 0.770423 test: 0.774902
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  25 loss training:  44.27249664068222 Time :  2773
accuracy train: 0.940919 val: 0.773239 test: 0.773495
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  26 loss training:  41.92980036884546 Time :  2783
accuracy train: 0.942169 val: 0.783099 test: 0.774620
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  27 loss training:  41.95362392812967 Time :  2794
accuracy train: 0.949828 val: 0.774648 test: 0.777997
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  28 loss training:  41.202552169561386 Time :  2804
accuracy train: 0.955455 val: 0.777465 test: 0.777434
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  29 loss training:  39.28488929569721 Time :  2814
accuracy train: 0.959519 val: 0.769014 test: 0.776590
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  30 loss training:  37.01997819542885 Time :  2825
accuracy train: 0.962488 val: 0.773239 test: 0.774339
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  31 loss training:  36.88857416063547 Time :  2834
accuracy train: 0.966552 val: 0.766197 test: 0.772932
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  32 loss training:  33.61159883067012 Time :  2844
accuracy train: 0.968740 val: 0.766197 test: 0.771244
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  33 loss training:  34.26891040429473 Time :  2853
accuracy train: 0.973898 val: 0.773239 test: 0.772369
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  34 loss training:  32.0323873385787 Time :  2865
accuracy train: 0.974211 val: 0.777465 test: 0.773495
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  35 loss training:  30.804413117468357 Time :  2877
accuracy train: 0.979525 val: 0.771831 test: 0.766742
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  36 loss training:  29.928814988583326 Time :  2886
accuracy train: 0.980775 val: 0.773239 test: 0.772088
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  37 loss training:  28.988038033246994 Time :  2897
accuracy train: 0.982651 val: 0.771831 test: 0.768711
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  38 loss training:  27.57454462349415 Time :  2905
accuracy train: 0.982338 val: 0.766197 test: 0.770962
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  39 loss training:  25.13950352370739 Time :  2915
accuracy train: 0.986871 val: 0.770423 test: 0.766742
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  40 loss training:  26.1553892493248 Time :  2926
accuracy train: 0.987027 val: 0.776056 test: 0.771525
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  41 loss training:  23.993429156020284 Time :  2936
accuracy train: 0.989684 val: 0.776056 test: 0.769837
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

Epoch :  42 loss training:  24.063862906768918 Time :  2945
accuracy train: 0.990935 val: 0.771831 test: 0.771244
max validation accuracy : 0.783099 max acc epoch : 11 test accuracy : 0.778559

========================================================================================================================================================================================================
max acc epoch :  11
max validation accuracy :  0.7830985915492957
test accuracy :  0.7785593697242543
last test_accuracy :  0.7712436691052336
========================================================================================================================================================================================================

itr : 6
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=663, weight_decay=1e-08)
device :  cuda:0

Epoch :  1 loss training:  92.2227343916893 Time :  2956
accuracy train: 0.778368 val: 0.754930 test: 0.770681
max validation accuracy : 0.754930 max acc epoch : 1 test accuracy : 0.770681
Epoch-1 lr: 0.001

Epoch :  2 loss training:  84.87012913823128 Time :  2966
accuracy train: 0.790716 val: 0.760563 test: 0.763928
max validation accuracy : 0.760563 max acc epoch : 2 test accuracy : 0.763928
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.4493935406208 Time :  2981
accuracy train: 0.804158 val: 0.781690 test: 0.768430
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.768430
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.51796951889992 Time :  2991
accuracy train: 0.826821 val: 0.766197 test: 0.775183
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.768430
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.32280458509922 Time :  3001
accuracy train: 0.839481 val: 0.764789 test: 0.774620
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.768430
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.12080582976341 Time :  3012
accuracy train: 0.845733 val: 0.774648 test: 0.777153
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.768430
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.3718429505825 Time :  3022
accuracy train: 0.859331 val: 0.778873 test: 0.776590
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.768430
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.41928842663765 Time :  3032
accuracy train: 0.863864 val: 0.771831 test: 0.774902
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.768430
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.18306335806847 Time :  3042
accuracy train: 0.873867 val: 0.783099 test: 0.768711
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.26650044322014 Time :  3052
accuracy train: 0.880744 val: 0.769014 test: 0.775183
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.10634456574917 Time :  3062
accuracy train: 0.886058 val: 0.771831 test: 0.770962
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.44244737923145 Time :  3072
accuracy train: 0.890435 val: 0.778873 test: 0.768430
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  56.79553923010826 Time :  3085
accuracy train: 0.894186 val: 0.763380 test: 0.774339
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.69971735775471 Time :  3097
accuracy train: 0.895749 val: 0.773239 test: 0.774339
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  55.69918981194496 Time :  3108
accuracy train: 0.899969 val: 0.777465 test: 0.774339
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711

Epoch :  16 loss training:  55.091382533311844 Time :  3117
accuracy train: 0.905283 val: 0.771831 test: 0.774902
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711

Epoch :  17 loss training:  54.2345394641161 Time :  3127
accuracy train: 0.912316 val: 0.769014 test: 0.774339
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711

Epoch :  18 loss training:  52.855328753590584 Time :  3139
accuracy train: 0.919193 val: 0.769014 test: 0.775464
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711

Epoch :  19 loss training:  50.60895563662052 Time :  3149
accuracy train: 0.925289 val: 0.773239 test: 0.774902
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711

Epoch :  20 loss training:  49.92727995663881 Time :  3159
accuracy train: 0.932791 val: 0.770423 test: 0.775183
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711

Epoch :  21 loss training:  48.933998972177505 Time :  3170
accuracy train: 0.935605 val: 0.767606 test: 0.774902
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711

Epoch :  22 loss training:  45.388985902071 Time :  3180
accuracy train: 0.939043 val: 0.769014 test: 0.774902
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711

Epoch :  23 loss training:  44.090221263468266 Time :  3191
accuracy train: 0.947327 val: 0.770423 test: 0.774339
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711

Epoch :  24 loss training:  43.366633750498295 Time :  3202
accuracy train: 0.950922 val: 0.770423 test: 0.776027
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711

Epoch :  25 loss training:  40.910639353096485 Time :  3211
accuracy train: 0.953736 val: 0.771831 test: 0.771244
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711

Epoch :  26 loss training:  39.218253038823605 Time :  3220
accuracy train: 0.955299 val: 0.777465 test: 0.771806
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711

Epoch :  27 loss training:  38.98485189676285 Time :  3231
accuracy train: 0.962957 val: 0.771831 test: 0.772932
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711

Epoch :  28 loss training:  37.803538113832474 Time :  3241
accuracy train: 0.966396 val: 0.754930 test: 0.770962
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711

Epoch :  29 loss training:  36.00637827813625 Time :  3250
accuracy train: 0.971397 val: 0.760563 test: 0.769274
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711

Epoch :  30 loss training:  34.14752768725157 Time :  3260
accuracy train: 0.973429 val: 0.763380 test: 0.770962
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711

Epoch :  31 loss training:  34.1026103310287 Time :  3270
accuracy train: 0.977962 val: 0.761972 test: 0.771525
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711

Epoch :  32 loss training:  30.8247349858284 Time :  3280
accuracy train: 0.979369 val: 0.769014 test: 0.772088
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711

Epoch :  33 loss training:  30.528738241642714 Time :  3289
accuracy train: 0.981869 val: 0.771831 test: 0.771525
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711

Epoch :  34 loss training:  30.814345192164183 Time :  3302
accuracy train: 0.983120 val: 0.770423 test: 0.772932
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711

Epoch :  35 loss training:  28.686057273298502 Time :  3315
accuracy train: 0.986402 val: 0.766197 test: 0.768993
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711

Epoch :  36 loss training:  27.43954234942794 Time :  3325
accuracy train: 0.987496 val: 0.769014 test: 0.767867
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711

Epoch :  37 loss training:  26.984783040359616 Time :  3335
accuracy train: 0.988746 val: 0.766197 test: 0.765335
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711

Epoch :  38 loss training:  26.226050309836864 Time :  3344
accuracy train: 0.989684 val: 0.773239 test: 0.766460
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711

Epoch :  39 loss training:  23.244086297228932 Time :  3355
accuracy train: 0.991872 val: 0.769014 test: 0.762802
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711

Epoch :  40 loss training:  23.62681559473276 Time :  3364
accuracy train: 0.992029 val: 0.771831 test: 0.765616
max validation accuracy : 0.783099 max acc epoch : 9 test accuracy : 0.768711

========================================================================================================================================================================================================
max acc epoch :  9
max validation accuracy :  0.7830985915492957
test accuracy :  0.7687113111986494
last test_accuracy :  0.7656162070906022
========================================================================================================================================================================================================

itr : 7
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=663, weight_decay=1e-08)
device :  cuda:0

Epoch :  1 loss training:  92.33756721019745 Time :  3375
accuracy train: 0.782119 val: 0.757746 test: 0.771525
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.771525
Epoch-1 lr: 0.001

Epoch :  2 loss training:  84.52364572882652 Time :  3385
accuracy train: 0.793529 val: 0.756338 test: 0.770400
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.771525
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.46308924257755 Time :  3395
accuracy train: 0.804314 val: 0.761972 test: 0.776308
max validation accuracy : 0.761972 max acc epoch : 3 test accuracy : 0.776308
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.86889997124672 Time :  3405
accuracy train: 0.827915 val: 0.771831 test: 0.771244
max validation accuracy : 0.771831 max acc epoch : 4 test accuracy : 0.771244
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.8984386920929 Time :  3420
accuracy train: 0.830572 val: 0.759155 test: 0.774339
max validation accuracy : 0.771831 max acc epoch : 4 test accuracy : 0.771244
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.48200014233589 Time :  3430
accuracy train: 0.841044 val: 0.764789 test: 0.777997
max validation accuracy : 0.771831 max acc epoch : 4 test accuracy : 0.771244
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.25720298290253 Time :  3440
accuracy train: 0.853079 val: 0.776056 test: 0.773213
max validation accuracy : 0.776056 max acc epoch : 7 test accuracy : 0.773213
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.71080793440342 Time :  3450
accuracy train: 0.856674 val: 0.778873 test: 0.777434
max validation accuracy : 0.778873 max acc epoch : 8 test accuracy : 0.777434
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.62076084315777 Time :  3460
accuracy train: 0.865583 val: 0.776056 test: 0.777715
max validation accuracy : 0.778873 max acc epoch : 8 test accuracy : 0.777434
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.21764321625233 Time :  3471
accuracy train: 0.872460 val: 0.767606 test: 0.770962
max validation accuracy : 0.778873 max acc epoch : 8 test accuracy : 0.777434
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  61.47450341284275 Time :  3481
accuracy train: 0.872304 val: 0.778873 test: 0.774339
max validation accuracy : 0.778873 max acc epoch : 8 test accuracy : 0.777434
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  60.34642833471298 Time :  3491
accuracy train: 0.883245 val: 0.784507 test: 0.772651
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  58.60333509743214 Time :  3501
accuracy train: 0.884651 val: 0.771831 test: 0.778559
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  58.30922767519951 Time :  3510
accuracy train: 0.885589 val: 0.771831 test: 0.770962
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  57.31635192036629 Time :  3522
accuracy train: 0.891060 val: 0.771831 test: 0.771806
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  16 loss training:  57.03073564171791 Time :  3533
accuracy train: 0.895123 val: 0.766197 test: 0.775746
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  17 loss training:  55.94333492219448 Time :  3544
accuracy train: 0.902313 val: 0.773239 test: 0.774620
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  18 loss training:  55.17536211013794 Time :  3553
accuracy train: 0.906690 val: 0.773239 test: 0.776308
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  19 loss training:  52.380408346652985 Time :  3564
accuracy train: 0.911847 val: 0.769014 test: 0.776308
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  20 loss training:  52.05656473338604 Time :  3574
accuracy train: 0.920600 val: 0.770423 test: 0.774620
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  21 loss training:  50.68505734205246 Time :  3584
accuracy train: 0.925133 val: 0.771831 test: 0.774339
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  22 loss training:  47.936859138309956 Time :  3594
accuracy train: 0.929666 val: 0.761972 test: 0.776308
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  23 loss training:  46.29569698870182 Time :  3604
accuracy train: 0.935449 val: 0.769014 test: 0.777434
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  24 loss training:  45.658651769161224 Time :  3614
accuracy train: 0.941388 val: 0.770423 test: 0.777434
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  25 loss training:  43.456176578998566 Time :  3626
accuracy train: 0.946858 val: 0.764789 test: 0.774339
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  26 loss training:  42.19086289405823 Time :  3639
accuracy train: 0.947484 val: 0.769014 test: 0.778841
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  27 loss training:  41.374640092253685 Time :  3648
accuracy train: 0.953579 val: 0.773239 test: 0.776590
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  28 loss training:  39.86499138921499 Time :  3658
accuracy train: 0.958581 val: 0.761972 test: 0.772369
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  29 loss training:  38.90355484932661 Time :  3667
accuracy train: 0.961238 val: 0.771831 test: 0.780529
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  30 loss training:  36.656061962246895 Time :  3676
accuracy train: 0.965458 val: 0.770423 test: 0.775464
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  31 loss training:  36.53020836412907 Time :  3685
accuracy train: 0.970460 val: 0.770423 test: 0.774902
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  32 loss training:  32.63620897009969 Time :  3696
accuracy train: 0.971710 val: 0.763380 test: 0.769837
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  33 loss training:  33.13392274826765 Time :  3705
accuracy train: 0.976868 val: 0.773239 test: 0.770962
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  34 loss training:  31.93747904151678 Time :  3715
accuracy train: 0.977649 val: 0.777465 test: 0.772369
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  35 loss training:  30.410033997148275 Time :  3725
accuracy train: 0.981557 val: 0.774648 test: 0.770681
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  36 loss training:  29.4036706648767 Time :  3740
accuracy train: 0.981557 val: 0.774648 test: 0.775464
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  37 loss training:  27.99443700350821 Time :  3750
accuracy train: 0.984058 val: 0.770423 test: 0.771525
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  38 loss training:  27.370514936745167 Time :  3760
accuracy train: 0.985464 val: 0.776056 test: 0.770962
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  39 loss training:  25.271438755095005 Time :  3769
accuracy train: 0.988121 val: 0.766197 test: 0.770118
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  40 loss training:  25.16755811870098 Time :  3779
accuracy train: 0.987965 val: 0.773239 test: 0.768711
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  41 loss training:  24.397482335567474 Time :  3789
accuracy train: 0.990466 val: 0.770423 test: 0.768149
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  42 loss training:  24.649072792381048 Time :  3799
accuracy train: 0.990309 val: 0.756338 test: 0.771244
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

Epoch :  43 loss training:  23.760163839906454 Time :  3810
accuracy train: 0.992029 val: 0.767606 test: 0.771244
max validation accuracy : 0.784507 max acc epoch : 12 test accuracy : 0.772651

========================================================================================================================================================================================================
max acc epoch :  12
max validation accuracy :  0.7845070422535211
test accuracy :  0.7726505346088914
last test_accuracy :  0.7712436691052336
========================================================================================================================================================================================================

itr : 8
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=663, weight_decay=1e-08)
device :  cuda:0

Epoch :  1 loss training:  92.20691525936127 Time :  3821
accuracy train: 0.771491 val: 0.738028 test: 0.757456
max validation accuracy : 0.738028 max acc epoch : 1 test accuracy : 0.757456
Epoch-1 lr: 0.001

Epoch :  2 loss training:  84.89925992488861 Time :  3830
accuracy train: 0.791185 val: 0.774648 test: 0.772369
max validation accuracy : 0.774648 max acc epoch : 2 test accuracy : 0.772369
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.26211339235306 Time :  3842
accuracy train: 0.805877 val: 0.757746 test: 0.771806
max validation accuracy : 0.774648 max acc epoch : 2 test accuracy : 0.772369
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.6502437889576 Time :  3855
accuracy train: 0.822601 val: 0.757746 test: 0.773495
max validation accuracy : 0.774648 max acc epoch : 2 test accuracy : 0.772369
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.90756805241108 Time :  3865
accuracy train: 0.833542 val: 0.769014 test: 0.773495
max validation accuracy : 0.774648 max acc epoch : 2 test accuracy : 0.772369
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.38356672227383 Time :  3875
accuracy train: 0.840731 val: 0.770423 test: 0.777715
max validation accuracy : 0.774648 max acc epoch : 2 test accuracy : 0.772369
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.14267954230309 Time :  3885
accuracy train: 0.855111 val: 0.788732 test: 0.777434
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.30031733214855 Time :  3894
accuracy train: 0.859331 val: 0.769014 test: 0.778841
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  65.0246759057045 Time :  3905
accuracy train: 0.864176 val: 0.774648 test: 0.774057
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.315438359975815 Time :  3915
accuracy train: 0.873554 val: 0.770423 test: 0.770118
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  61.8717902302742 Time :  3924
accuracy train: 0.876993 val: 0.778873 test: 0.772088
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  60.49292217195034 Time :  3934
accuracy train: 0.883401 val: 0.773239 test: 0.776871
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  58.227320343256 Time :  3944
accuracy train: 0.886371 val: 0.774648 test: 0.776308
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.84996388852596 Time :  3957
accuracy train: 0.889653 val: 0.778873 test: 0.777153
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  57.03847751021385 Time :  3969
accuracy train: 0.892466 val: 0.778873 test: 0.771525
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434

Epoch :  16 loss training:  56.81534470617771 Time :  3979
accuracy train: 0.897937 val: 0.774648 test: 0.769837
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434

Epoch :  17 loss training:  55.88399665057659 Time :  3989
accuracy train: 0.906221 val: 0.778873 test: 0.773495
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434

Epoch :  18 loss training:  54.191509053111076 Time :  4000
accuracy train: 0.908878 val: 0.784507 test: 0.771525
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434

Epoch :  19 loss training:  51.97035051882267 Time :  4011
accuracy train: 0.914505 val: 0.783099 test: 0.774339
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434

Epoch :  20 loss training:  51.39798782765865 Time :  4021
accuracy train: 0.922163 val: 0.778873 test: 0.774902
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434

Epoch :  21 loss training:  49.9727284014225 Time :  4032
accuracy train: 0.927321 val: 0.780282 test: 0.773776
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434

Epoch :  22 loss training:  47.02915174514055 Time :  4042
accuracy train: 0.934667 val: 0.771831 test: 0.772932
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434

Epoch :  23 loss training:  46.53411604464054 Time :  4052
accuracy train: 0.938418 val: 0.773239 test: 0.776027
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434

Epoch :  24 loss training:  45.000863306224346 Time :  4066
accuracy train: 0.942638 val: 0.774648 test: 0.775464
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434

Epoch :  25 loss training:  42.599341459572315 Time :  4078
accuracy train: 0.948109 val: 0.776056 test: 0.773213
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434

Epoch :  26 loss training:  41.09198073297739 Time :  4088
accuracy train: 0.950141 val: 0.785915 test: 0.774339
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434

Epoch :  27 loss training:  41.23576029390097 Time :  4098
accuracy train: 0.954986 val: 0.771831 test: 0.775183
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434

Epoch :  28 loss training:  39.57732006907463 Time :  4107
accuracy train: 0.960925 val: 0.777465 test: 0.773495
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434

Epoch :  29 loss training:  37.77427386492491 Time :  4117
accuracy train: 0.965771 val: 0.771831 test: 0.773213
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434

Epoch :  30 loss training:  36.03584825247526 Time :  4126
accuracy train: 0.967959 val: 0.771831 test: 0.774902
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434

Epoch :  31 loss training:  35.66417173296213 Time :  4136
accuracy train: 0.971241 val: 0.770423 test: 0.768711
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434

Epoch :  32 loss training:  32.36626521870494 Time :  4146
accuracy train: 0.974367 val: 0.773239 test: 0.769837
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434

Epoch :  33 loss training:  32.76203466579318 Time :  4156
accuracy train: 0.978118 val: 0.777465 test: 0.773213
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434

Epoch :  34 loss training:  31.31966283544898 Time :  4167
accuracy train: 0.979056 val: 0.773239 test: 0.774339
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434

Epoch :  35 loss training:  29.896048855036497 Time :  4179
accuracy train: 0.981713 val: 0.780282 test: 0.774339
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434

Epoch :  36 loss training:  28.80170239880681 Time :  4189
accuracy train: 0.984058 val: 0.783099 test: 0.772088
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434

Epoch :  37 loss training:  28.335794107988477 Time :  4198
accuracy train: 0.984995 val: 0.778873 test: 0.768430
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434

Epoch :  38 loss training:  26.731458641588688 Time :  4208
accuracy train: 0.986558 val: 0.778873 test: 0.773213
max validation accuracy : 0.788732 max acc epoch : 7 test accuracy : 0.777434

========================================================================================================================================================================================================
max acc epoch :  7
max validation accuracy :  0.7887323943661971
test accuracy :  0.7774338773213281
last test_accuracy :  0.7732132808103546
========================================================================================================================================================================================================

itr : 9
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=1, num_layers=3, num_mlp_layers=1, random_vec=False, seed=663, weight_decay=1e-08)
device :  cuda:0

Epoch :  1 loss training:  92.1247718334198 Time :  4219
accuracy train: 0.777899 val: 0.757746 test: 0.766460
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.766460
Epoch-1 lr: 0.001

Epoch :  2 loss training:  85.22909790277481 Time :  4229
accuracy train: 0.793998 val: 0.774648 test: 0.770962
max validation accuracy : 0.774648 max acc epoch : 2 test accuracy : 0.770962
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.38226091861725 Time :  4239
accuracy train: 0.804470 val: 0.763380 test: 0.778559
max validation accuracy : 0.774648 max acc epoch : 2 test accuracy : 0.770962
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.76282900571823 Time :  4249
accuracy train: 0.823226 val: 0.764789 test: 0.775183
max validation accuracy : 0.774648 max acc epoch : 2 test accuracy : 0.770962
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.14772717654705 Time :  4258
accuracy train: 0.837762 val: 0.774648 test: 0.777434
max validation accuracy : 0.774648 max acc epoch : 2 test accuracy : 0.770962
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.04004260897636 Time :  4268
accuracy train: 0.841826 val: 0.767606 test: 0.776027
max validation accuracy : 0.774648 max acc epoch : 2 test accuracy : 0.770962
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.60997952520847 Time :  4281
accuracy train: 0.859175 val: 0.781690 test: 0.778841
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.778841
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.55223846435547 Time :  4291
accuracy train: 0.866052 val: 0.777465 test: 0.777715
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.778841
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.46687924861908 Time :  4302
accuracy train: 0.874336 val: 0.773239 test: 0.772651
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.778841
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.61669363081455 Time :  4312
accuracy train: 0.881994 val: 0.771831 test: 0.768993
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.778841
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.94383132457733 Time :  4322
accuracy train: 0.881682 val: 0.774648 test: 0.774057
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.778841
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  60.04359330236912 Time :  4332
accuracy train: 0.891997 val: 0.781690 test: 0.770962
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.778841
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.511407643556595 Time :  4342
accuracy train: 0.895123 val: 0.776056 test: 0.771525
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.778841
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.90251737833023 Time :  4352
accuracy train: 0.897312 val: 0.774648 test: 0.771244
max validation accuracy : 0.781690 max acc epoch : 7 test accuracy : 0.778841
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.019852951169014 Time :  4362
accuracy train: 0.900907 val: 0.784507 test: 0.768149
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  16 loss training:  56.135991513729095 Time :  4372
accuracy train: 0.904970 val: 0.776056 test: 0.771244
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  17 loss training:  54.45272243022919 Time :  4385
accuracy train: 0.913098 val: 0.777465 test: 0.769555
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  18 loss training:  53.72848968207836 Time :  4395
accuracy train: 0.914348 val: 0.771831 test: 0.768993
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  19 loss training:  50.505623042583466 Time :  4406
accuracy train: 0.920756 val: 0.778873 test: 0.775464
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  20 loss training:  50.09614493697882 Time :  4417
accuracy train: 0.929353 val: 0.784507 test: 0.774057
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  21 loss training:  49.688221484422684 Time :  4427
accuracy train: 0.935136 val: 0.774648 test: 0.775464
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  22 loss training:  46.50203710794449 Time :  4437
accuracy train: 0.939512 val: 0.778873 test: 0.775464
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  23 loss training:  44.71388536691666 Time :  4447
accuracy train: 0.945921 val: 0.776056 test: 0.772088
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  24 loss training:  43.833402536809444 Time :  4457
accuracy train: 0.947952 val: 0.777465 test: 0.772651
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  25 loss training:  41.811401441693306 Time :  4467
accuracy train: 0.952329 val: 0.767606 test: 0.769555
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  26 loss training:  39.84607531130314 Time :  4478
accuracy train: 0.955142 val: 0.783099 test: 0.773213
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  27 loss training:  40.01216323673725 Time :  4490
accuracy train: 0.962176 val: 0.771831 test: 0.769274
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  28 loss training:  38.39191886782646 Time :  4499
accuracy train: 0.965927 val: 0.771831 test: 0.770681
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  29 loss training:  37.22336323559284 Time :  4509
accuracy train: 0.970460 val: 0.767606 test: 0.771244
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  30 loss training:  34.947040647268295 Time :  4520
accuracy train: 0.972648 val: 0.766197 test: 0.770681
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  31 loss training:  34.95150351524353 Time :  4529
accuracy train: 0.976243 val: 0.763380 test: 0.770962
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  32 loss training:  31.372873727232218 Time :  4540
accuracy train: 0.978743 val: 0.764789 test: 0.768149
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  33 loss training:  31.823010578751564 Time :  4550
accuracy train: 0.980775 val: 0.764789 test: 0.765898
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  34 loss training:  30.619454421103 Time :  4560
accuracy train: 0.982026 val: 0.766197 test: 0.769274
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  35 loss training:  28.878864642232656 Time :  4568
accuracy train: 0.985464 val: 0.770423 test: 0.768430
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  36 loss training:  28.432864539325237 Time :  4576
accuracy train: 0.985933 val: 0.764789 test: 0.772369
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  37 loss training:  27.702543018385768 Time :  4589
accuracy train: 0.987809 val: 0.770423 test: 0.766179
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  38 loss training:  26.30384822562337 Time :  4600
accuracy train: 0.990935 val: 0.764789 test: 0.769274
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  39 loss training:  23.453057646751404 Time :  4610
accuracy train: 0.991716 val: 0.764789 test: 0.763928
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  40 loss training:  24.569596434012055 Time :  4620
accuracy train: 0.991091 val: 0.770423 test: 0.768711
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  41 loss training:  22.681511893868446 Time :  4630
accuracy train: 0.993904 val: 0.761972 test: 0.767304
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  42 loss training:  24.482080729678273 Time :  4641
accuracy train: 0.993279 val: 0.761972 test: 0.770118
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  43 loss training:  22.52612154558301 Time :  4652
accuracy train: 0.994530 val: 0.760563 test: 0.763365
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  44 loss training:  21.42001723498106 Time :  4661
accuracy train: 0.996249 val: 0.763380 test: 0.764491
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  45 loss training:  20.084084019064903 Time :  4671
accuracy train: 0.996249 val: 0.752113 test: 0.766179
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

Epoch :  46 loss training:  20.20086513273418 Time :  4681
accuracy train: 0.996093 val: 0.760563 test: 0.764491
max validation accuracy : 0.784507 max acc epoch : 15 test accuracy : 0.768149

========================================================================================================================================================================================================
max acc epoch :  15
max validation accuracy :  0.7845070422535211
test accuracy :  0.7681485649971863
last test_accuracy :  0.7644907146876758
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.78451 	 test_accuracy : 0.77209 	 max_acc epoch :  9 	 last test_accuracy : 0.76646
k :  1 	 val_accuracy : 0.77465 	 test_accuracy : 0.77434 	 max_acc epoch :  20 	 last test_accuracy : 0.76730
k :  2 	 val_accuracy : 0.78169 	 test_accuracy : 0.78081 	 max_acc epoch :  26 	 last test_accuracy : 0.77265
k :  3 	 val_accuracy : 0.78592 	 test_accuracy : 0.77237 	 max_acc epoch :  26 	 last test_accuracy : 0.77096
k :  4 	 val_accuracy : 0.78732 	 test_accuracy : 0.76815 	 max_acc epoch :  8 	 last test_accuracy : 0.76815
k :  5 	 val_accuracy : 0.78310 	 test_accuracy : 0.77856 	 max_acc epoch :  11 	 last test_accuracy : 0.77124
k :  6 	 val_accuracy : 0.78310 	 test_accuracy : 0.76871 	 max_acc epoch :  9 	 last test_accuracy : 0.76562
k :  7 	 val_accuracy : 0.78451 	 test_accuracy : 0.77265 	 max_acc epoch :  12 	 last test_accuracy : 0.77124
k :  8 	 val_accuracy : 0.78873 	 test_accuracy : 0.77743 	 max_acc epoch :  7 	 last test_accuracy : 0.77321
k :  9 	 val_accuracy : 0.78451 	 test_accuracy : 0.76815 	 max_acc epoch :  15 	 last test_accuracy : 0.76449

avg :  	 val_accuracy : 0.78380 	 test_accuracy : 0.77333 	 last_accuracy : 0.76913


date and time :  Thu Jun  3 21:17:17 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=202, weight_decay=1e-08)
device :  cuda:0
Counter({0: 6232, 1: 4430})

Epoch :  1 loss training:  93.44305270910263 Time :  16
accuracy train: 0.769928 val: 0.740845 test: 0.756331
max validation accuracy : 0.740845 max acc epoch : 1 test accuracy : 0.756331
Counter({1: 5633, 0: 5029})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.22714191675186 Time :  32
accuracy train: 0.796812 val: 0.767606 test: 0.774620
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.774620
Counter({0: 5599, 1: 5063})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.57509943842888 Time :  49
accuracy train: 0.803376 val: 0.764789 test: 0.772088
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.774620
Counter({0: 5602, 1: 5060})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.31614576280117 Time :  65
accuracy train: 0.821507 val: 0.767606 test: 0.769274
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.774620
Counter({1: 5452, 0: 5210})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  70.57029390335083 Time :  79
accuracy train: 0.829322 val: 0.776056 test: 0.779122
max validation accuracy : 0.776056 max acc epoch : 5 test accuracy : 0.779122
Counter({1: 5389, 0: 5273})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  69.99253153800964 Time :  96
accuracy train: 0.846046 val: 0.783099 test: 0.771525
max validation accuracy : 0.783099 max acc epoch : 6 test accuracy : 0.771525
Counter({1: 5415, 0: 5247})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  64.91461066901684 Time :  112
accuracy train: 0.858081 val: 0.780282 test: 0.765335
max validation accuracy : 0.783099 max acc epoch : 6 test accuracy : 0.771525
Counter({1: 5351, 0: 5311})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  63.55897085368633 Time :  137
accuracy train: 0.870116 val: 0.790141 test: 0.763647
max validation accuracy : 0.790141 max acc epoch : 8 test accuracy : 0.763647
Counter({0: 5428, 1: 5234})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.5184210985899 Time :  153
accuracy train: 0.869803 val: 0.785915 test: 0.763365
max validation accuracy : 0.790141 max acc epoch : 8 test accuracy : 0.763647
Counter({0: 5409, 1: 5253})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.85319006443024 Time :  168
accuracy train: 0.874648 val: 0.784507 test: 0.766460
max validation accuracy : 0.790141 max acc epoch : 8 test accuracy : 0.763647
Counter({0: 5408, 1: 5254})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.523940324783325 Time :  184
accuracy train: 0.884964 val: 0.780282 test: 0.765335
max validation accuracy : 0.790141 max acc epoch : 8 test accuracy : 0.763647
Counter({0: 5397, 1: 5265})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.78475145995617 Time :  199
accuracy train: 0.887621 val: 0.791549 test: 0.763365
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5406, 1: 5256})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  56.43048441410065 Time :  215
accuracy train: 0.885746 val: 0.784507 test: 0.764209
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({1: 5394, 0: 5268})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.219296142458916 Time :  229
accuracy train: 0.892154 val: 0.780282 test: 0.762521
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5400, 1: 5262})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.14899604022503 Time :  244
accuracy train: 0.894498 val: 0.780282 test: 0.761677
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5390, 1: 5272})

Epoch :  16 loss training:  55.594395622611046 Time :  268
accuracy train: 0.900907 val: 0.778873 test: 0.761114
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5398, 1: 5264})

Epoch :  17 loss training:  53.82742027938366 Time :  283
accuracy train: 0.905283 val: 0.774648 test: 0.761677
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5395, 1: 5267})

Epoch :  18 loss training:  52.20817758142948 Time :  298
accuracy train: 0.911691 val: 0.776056 test: 0.761958
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5405, 1: 5257})

Epoch :  19 loss training:  50.46746803820133 Time :  314
accuracy train: 0.915755 val: 0.778873 test: 0.761958
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5411, 1: 5251})

Epoch :  20 loss training:  49.65978446602821 Time :  329
accuracy train: 0.921069 val: 0.777465 test: 0.761396
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5427, 1: 5235})

Epoch :  21 loss training:  47.58333011716604 Time :  344
accuracy train: 0.927946 val: 0.776056 test: 0.764772
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({1: 5427, 0: 5235})

Epoch :  22 loss training:  45.23363760113716 Time :  360
accuracy train: 0.930916 val: 0.774648 test: 0.763647
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5425, 1: 5237})

Epoch :  23 loss training:  44.4192513898015 Time :  374
accuracy train: 0.937949 val: 0.781690 test: 0.765335
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5458, 1: 5204})

Epoch :  24 loss training:  43.64079396426678 Time :  400
accuracy train: 0.941232 val: 0.781690 test: 0.764772
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5437, 1: 5225})

Epoch :  25 loss training:  40.83225571364164 Time :  416
accuracy train: 0.947796 val: 0.783099 test: 0.759707
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5459, 1: 5203})

Epoch :  26 loss training:  39.410530894994736 Time :  431
accuracy train: 0.955142 val: 0.774648 test: 0.764772
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({1: 5473, 0: 5189})

Epoch :  27 loss training:  38.96602275967598 Time :  447
accuracy train: 0.956236 val: 0.783099 test: 0.764209
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5493, 1: 5169})

Epoch :  28 loss training:  38.4088172018528 Time :  464
accuracy train: 0.958268 val: 0.788732 test: 0.763365
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5496, 1: 5166})

Epoch :  29 loss training:  36.33137460052967 Time :  480
accuracy train: 0.966083 val: 0.784507 test: 0.764209
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5510, 1: 5152})

Epoch :  30 loss training:  34.72866394370794 Time :  497
accuracy train: 0.967334 val: 0.777465 test: 0.762240
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5551, 1: 5111})

Epoch :  31 loss training:  33.259365044534206 Time :  515
accuracy train: 0.969365 val: 0.783099 test: 0.768149
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({1: 5571, 0: 5091})

Epoch :  32 loss training:  31.51881965249777 Time :  531
accuracy train: 0.973117 val: 0.776056 test: 0.763084
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5579, 1: 5083})

Epoch :  33 loss training:  29.276024777442217 Time :  547
accuracy train: 0.977806 val: 0.784507 test: 0.765898
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({1: 5607, 0: 5055})

Epoch :  34 loss training:  29.732365731149912 Time :  562
accuracy train: 0.981869 val: 0.790141 test: 0.765335
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5602, 1: 5060})

Epoch :  35 loss training:  28.587691623717546 Time :  579
accuracy train: 0.982338 val: 0.783099 test: 0.764772
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5595, 1: 5067})

Epoch :  36 loss training:  26.46978595852852 Time :  595
accuracy train: 0.985933 val: 0.790141 test: 0.762240
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5610, 1: 5052})

Epoch :  37 loss training:  25.267259620130062 Time :  612
accuracy train: 0.988434 val: 0.787324 test: 0.760270
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5623, 1: 5039})

Epoch :  38 loss training:  25.00467447936535 Time :  629
accuracy train: 0.987809 val: 0.787324 test: 0.763365
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5631, 1: 5031})

Epoch :  39 loss training:  23.372438438236713 Time :  649
accuracy train: 0.988278 val: 0.791549 test: 0.761396
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5651, 1: 5011})

Epoch :  40 loss training:  21.991693081334233 Time :  665
accuracy train: 0.990153 val: 0.780282 test: 0.762802
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5675, 1: 4987})

Epoch :  41 loss training:  20.11438293196261 Time :  681
accuracy train: 0.992498 val: 0.784507 test: 0.764772
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5679, 1: 4983})

Epoch :  42 loss training:  21.929920330643654 Time :  697
accuracy train: 0.993435 val: 0.785915 test: 0.764491
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5684, 1: 4978})

Epoch :  43 loss training:  20.65536729618907 Time :  714
accuracy train: 0.993748 val: 0.784507 test: 0.762240
max validation accuracy : 0.791549 max acc epoch : 12 test accuracy : 0.763365
Counter({0: 5690, 1: 4972})

========================================================================================================================================================================================================
max acc epoch :  12
max validation accuracy :  0.7915492957746478
test accuracy :  0.7633652222847496
last test_accuracy :  0.7622397298818233
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=202, weight_decay=1e-08)
device :  cuda:0
Counter({0: 6232, 1: 4430})

Epoch :  1 loss training:  93.3862195611 Time :  734
accuracy train: 0.774461 val: 0.745070 test: 0.754080
max validation accuracy : 0.745070 max acc epoch : 1 test accuracy : 0.754080
Counter({0: 5459, 1: 5203})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.41563498973846 Time :  748
accuracy train: 0.796812 val: 0.763380 test: 0.774057
max validation accuracy : 0.763380 max acc epoch : 2 test accuracy : 0.774057
Counter({0: 5818, 1: 4844})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.6939948797226 Time :  778
accuracy train: 0.800563 val: 0.771831 test: 0.775464
max validation accuracy : 0.771831 max acc epoch : 3 test accuracy : 0.775464
Counter({0: 5642, 1: 5020})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  72.87135711312294 Time :  794
accuracy train: 0.826821 val: 0.791549 test: 0.773776
max validation accuracy : 0.791549 max acc epoch : 4 test accuracy : 0.773776
Counter({0: 5630, 1: 5032})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.01722030341625 Time :  809
accuracy train: 0.828228 val: 0.776056 test: 0.780248
max validation accuracy : 0.791549 max acc epoch : 4 test accuracy : 0.773776
Counter({0: 5533, 1: 5129})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.17468790709972 Time :  826
accuracy train: 0.848078 val: 0.790141 test: 0.771244
max validation accuracy : 0.791549 max acc epoch : 4 test accuracy : 0.773776
Counter({1: 5486, 0: 5176})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.26623469591141 Time :  842
accuracy train: 0.857768 val: 0.802817 test: 0.772088
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({1: 5591, 0: 5071})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.27784210443497 Time :  879
accuracy train: 0.869022 val: 0.785915 test: 0.773213
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({0: 5657, 1: 5005})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.84360706806183 Time :  922
accuracy train: 0.867615 val: 0.783099 test: 0.769274
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({0: 5588, 1: 5074})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.17835059762001 Time :  978
accuracy train: 0.872616 val: 0.781690 test: 0.772932
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({0: 5584, 1: 5078})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.43918626010418 Time :  1023
accuracy train: 0.881213 val: 0.778873 test: 0.769555
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({0: 5588, 1: 5074})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.602774783968925 Time :  1061
accuracy train: 0.882307 val: 0.790141 test: 0.766179
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({0: 5604, 1: 5058})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.560764119029045 Time :  1098
accuracy train: 0.886058 val: 0.784507 test: 0.769555
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({0: 5615, 1: 5047})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.35543514788151 Time :  1139
accuracy train: 0.891372 val: 0.784507 test: 0.768149
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({0: 5611, 1: 5051})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  57.596250504255295 Time :  1177
accuracy train: 0.894498 val: 0.780282 test: 0.766179
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({0: 5621, 1: 5041})

Epoch :  16 loss training:  57.24965961277485 Time :  1233
accuracy train: 0.900594 val: 0.780282 test: 0.765053
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({1: 5620, 0: 5042})

Epoch :  17 loss training:  55.14155673980713 Time :  1269
accuracy train: 0.906533 val: 0.781690 test: 0.768149
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({0: 5649, 1: 5013})

Epoch :  18 loss training:  52.775736793875694 Time :  1306
accuracy train: 0.913410 val: 0.776056 test: 0.768711
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({0: 5667, 1: 4995})

Epoch :  19 loss training:  51.29530407488346 Time :  1344
accuracy train: 0.919037 val: 0.777465 test: 0.768993
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({0: 5669, 1: 4993})

Epoch :  20 loss training:  50.235483318567276 Time :  1385
accuracy train: 0.921694 val: 0.783099 test: 0.765898
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({0: 5678, 1: 4984})

Epoch :  21 loss training:  48.9656095802784 Time :  1428
accuracy train: 0.929822 val: 0.784507 test: 0.770681
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({1: 5700, 0: 4962})

Epoch :  22 loss training:  47.02281454205513 Time :  1482
accuracy train: 0.933260 val: 0.780282 test: 0.770681
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({0: 5723, 1: 4939})

Epoch :  23 loss training:  45.42247594892979 Time :  1521
accuracy train: 0.941544 val: 0.788732 test: 0.768430
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({0: 5755, 1: 4907})

Epoch :  24 loss training:  44.84088875353336 Time :  1561
accuracy train: 0.942638 val: 0.784507 test: 0.768149
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({0: 5749, 1: 4913})

Epoch :  25 loss training:  42.07417964935303 Time :  1598
accuracy train: 0.948265 val: 0.781690 test: 0.766460
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({0: 5784, 1: 4878})

Epoch :  26 loss training:  40.754267662763596 Time :  1639
accuracy train: 0.955767 val: 0.785915 test: 0.765053
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({0: 5805, 1: 4857})

Epoch :  27 loss training:  40.29367891699076 Time :  1686
accuracy train: 0.956549 val: 0.778873 test: 0.768993
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({0: 5813, 1: 4849})

Epoch :  28 loss training:  39.444016963243484 Time :  1738
accuracy train: 0.961394 val: 0.784507 test: 0.768149
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({0: 5818, 1: 4844})

Epoch :  29 loss training:  37.46042533963919 Time :  1775
accuracy train: 0.966239 val: 0.781690 test: 0.768149
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({1: 5849, 0: 4813})

Epoch :  30 loss training:  36.340019188821316 Time :  1813
accuracy train: 0.968584 val: 0.778873 test: 0.765335
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({1: 5857, 0: 4805})

Epoch :  31 loss training:  34.4989008307457 Time :  1852
accuracy train: 0.968115 val: 0.790141 test: 0.772932
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({0: 5888, 1: 4774})

Epoch :  32 loss training:  32.89236011356115 Time :  1891
accuracy train: 0.974211 val: 0.785915 test: 0.771244
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({0: 5875, 1: 4787})

Epoch :  33 loss training:  30.046246089041233 Time :  1936
accuracy train: 0.975774 val: 0.788732 test: 0.765898
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({1: 5933, 0: 4729})

Epoch :  34 loss training:  30.99005488678813 Time :  1989
accuracy train: 0.979681 val: 0.787324 test: 0.765335
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({1: 5922, 0: 4740})

Epoch :  35 loss training:  30.298238784074783 Time :  2026
accuracy train: 0.981557 val: 0.783099 test: 0.767304
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({1: 5928, 0: 4734})

Epoch :  36 loss training:  27.500946331769228 Time :  2065
accuracy train: 0.984214 val: 0.792958 test: 0.764491
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({1: 5927, 0: 4735})

Epoch :  37 loss training:  26.600405883044004 Time :  2103
accuracy train: 0.986246 val: 0.788732 test: 0.765616
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({0: 5916, 1: 4746})

Epoch :  38 loss training:  26.351584177464247 Time :  2141
accuracy train: 0.987183 val: 0.771831 test: 0.762521
max validation accuracy : 0.802817 max acc epoch : 7 test accuracy : 0.772088
Counter({1: 5972, 0: 4690})

========================================================================================================================================================================================================
max acc epoch :  7
max validation accuracy :  0.8028169014084507
test accuracy :  0.7720877884074282
last test_accuracy :  0.7625211029825548
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=202, weight_decay=1e-08)
device :  cuda:0
Counter({0: 6232, 1: 4430})

Epoch :  1 loss training:  93.357705026865 Time :  2225
accuracy train: 0.773679 val: 0.738028 test: 0.752110
max validation accuracy : 0.738028 max acc epoch : 1 test accuracy : 0.752110
Counter({1: 5569, 0: 5093})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.42715123295784 Time :  2271
accuracy train: 0.801344 val: 0.753521 test: 0.772088
max validation accuracy : 0.753521 max acc epoch : 2 test accuracy : 0.772088
Counter({1: 5883, 0: 4779})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.01640126109123 Time :  2312
accuracy train: 0.800719 val: 0.770423 test: 0.773213
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.773213
Counter({1: 5651, 0: 5011})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  72.92918382585049 Time :  2351
accuracy train: 0.831041 val: 0.783099 test: 0.772369
max validation accuracy : 0.783099 max acc epoch : 4 test accuracy : 0.772369
Counter({0: 5862, 1: 4800})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  70.56295745074749 Time :  2392
accuracy train: 0.825102 val: 0.770423 test: 0.777715
max validation accuracy : 0.783099 max acc epoch : 4 test accuracy : 0.772369
Counter({0: 5948, 1: 4714})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.49188750982285 Time :  2438
accuracy train: 0.840419 val: 0.778873 test: 0.761958
max validation accuracy : 0.783099 max acc epoch : 4 test accuracy : 0.772369
Counter({1: 5853, 0: 4809})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  65.1058514714241 Time :  2491
accuracy train: 0.856205 val: 0.784507 test: 0.766742
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.766742
Counter({0: 5880, 1: 4782})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.24760134518147 Time :  2528
accuracy train: 0.868709 val: 0.780282 test: 0.763647
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.766742
Counter({1: 5959, 0: 4703})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.84014682471752 Time :  2566
accuracy train: 0.873242 val: 0.781690 test: 0.771244
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.766742
Counter({0: 6007, 1: 4655})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.13579423725605 Time :  2603
accuracy train: 0.879494 val: 0.777465 test: 0.774057
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.766742
Counter({1: 6023, 0: 4639})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.161925330758095 Time :  2645
accuracy train: 0.886683 val: 0.780282 test: 0.763647
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.766742
Counter({1: 6030, 0: 4632})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.05244819819927 Time :  2692
accuracy train: 0.890278 val: 0.780282 test: 0.765898
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.766742
Counter({0: 6051, 1: 4611})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  56.61289367079735 Time :  2737
accuracy train: 0.891529 val: 0.777465 test: 0.762802
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.766742
Counter({1: 6067, 0: 4595})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.717743173241615 Time :  2752
accuracy train: 0.893560 val: 0.773239 test: 0.761677
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.766742
Counter({0: 6070, 1: 4592})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.386499255895615 Time :  2769
accuracy train: 0.899344 val: 0.777465 test: 0.760833
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.766742
Counter({0: 6075, 1: 4587})

Epoch :  16 loss training:  55.62629647552967 Time :  2785
accuracy train: 0.903407 val: 0.770423 test: 0.762240
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.766742
Counter({0: 6081, 1: 4581})

Epoch :  17 loss training:  54.2281277179718 Time :  2802
accuracy train: 0.911222 val: 0.781690 test: 0.762521
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.766742
Counter({0: 6119, 1: 4543})

Epoch :  18 loss training:  51.960714131593704 Time :  2818
accuracy train: 0.916536 val: 0.780282 test: 0.762240
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.766742
Counter({0: 6153, 1: 4509})

Epoch :  19 loss training:  50.416055373847485 Time :  2835
accuracy train: 0.918256 val: 0.783099 test: 0.760833
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.766742
Counter({0: 6171, 1: 4491})

Epoch :  20 loss training:  49.42035275697708 Time :  2862
accuracy train: 0.925289 val: 0.780282 test: 0.756331
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.766742
Counter({0: 6180, 1: 4482})

Epoch :  21 loss training:  47.80061998963356 Time :  2877
accuracy train: 0.930603 val: 0.773239 test: 0.759426
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.766742
Counter({0: 6198, 1: 4464})

Epoch :  22 loss training:  46.031873390078545 Time :  2894
accuracy train: 0.935605 val: 0.784507 test: 0.757738
max validation accuracy : 0.784507 max acc epoch : 7 test accuracy : 0.766742
Counter({0: 6201, 1: 4461})

Epoch :  23 loss training:  45.431030198931694 Time :  2910
accuracy train: 0.943420 val: 0.787324 test: 0.757456
max validation accuracy : 0.787324 max acc epoch : 23 test accuracy : 0.757456
Counter({1: 6217, 0: 4445})

Epoch :  24 loss training:  43.94531389325857 Time :  2926
accuracy train: 0.945921 val: 0.791549 test: 0.759145
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({0: 6218, 1: 4444})

Epoch :  25 loss training:  40.947761341929436 Time :  2941
accuracy train: 0.951704 val: 0.783099 test: 0.760833
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({0: 6236, 1: 4426})

Epoch :  26 loss training:  39.97261469066143 Time :  2957
accuracy train: 0.958112 val: 0.778873 test: 0.755487
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({0: 6274, 1: 4388})

Epoch :  27 loss training:  38.90707438439131 Time :  2976
accuracy train: 0.961707 val: 0.773239 test: 0.755205
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({1: 6273, 0: 4389})

Epoch :  28 loss training:  38.24351281672716 Time :  3000
accuracy train: 0.965458 val: 0.771831 test: 0.754643
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({0: 6305, 1: 4357})

Epoch :  29 loss training:  36.608617320656776 Time :  3017
accuracy train: 0.969209 val: 0.777465 test: 0.756894
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({1: 6334, 0: 4328})

Epoch :  30 loss training:  34.891936756670475 Time :  3032
accuracy train: 0.970460 val: 0.780282 test: 0.752954
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({0: 6353, 1: 4309})

Epoch :  31 loss training:  33.30951917916536 Time :  3047
accuracy train: 0.972648 val: 0.788732 test: 0.759707
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({1: 6360, 0: 4302})

Epoch :  32 loss training:  31.513621132820845 Time :  3064
accuracy train: 0.976711 val: 0.763380 test: 0.753236
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({1: 6363, 0: 4299})

Epoch :  33 loss training:  28.587241049855947 Time :  3081
accuracy train: 0.980619 val: 0.778873 test: 0.759989
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({1: 6373, 0: 4289})

Epoch :  34 loss training:  30.292259693145752 Time :  3096
accuracy train: 0.983432 val: 0.770423 test: 0.756894
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({1: 6368, 0: 4294})

Epoch :  35 loss training:  28.51018814742565 Time :  3117
accuracy train: 0.984526 val: 0.771831 test: 0.754924
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({1: 6382, 0: 4280})

Epoch :  36 loss training:  25.68754291534424 Time :  3134
accuracy train: 0.986715 val: 0.767606 test: 0.755487
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({0: 6388, 1: 4274})

Epoch :  37 loss training:  25.15319414436817 Time :  3149
accuracy train: 0.987652 val: 0.778873 test: 0.755487
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({1: 6377, 0: 4285})

Epoch :  38 loss training:  25.175750071182847 Time :  3166
accuracy train: 0.987965 val: 0.766197 test: 0.755768
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({1: 6405, 0: 4257})

Epoch :  39 loss training:  24.13663373887539 Time :  3183
accuracy train: 0.989841 val: 0.784507 test: 0.761396
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({0: 6433, 1: 4229})

Epoch :  40 loss training:  22.896385073661804 Time :  3200
accuracy train: 0.990935 val: 0.777465 test: 0.755768
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({1: 6425, 0: 4237})

Epoch :  41 loss training:  20.357718236744404 Time :  3216
accuracy train: 0.991872 val: 0.774648 test: 0.757456
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({1: 6441, 0: 4221})

Epoch :  42 loss training:  21.669693805277348 Time :  3233
accuracy train: 0.993123 val: 0.764789 test: 0.755768
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({1: 6440, 0: 4222})

Epoch :  43 loss training:  21.56700297445059 Time :  3258
accuracy train: 0.994217 val: 0.773239 test: 0.756894
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({0: 6441, 1: 4221})

Epoch :  44 loss training:  19.349908363074064 Time :  3273
accuracy train: 0.995467 val: 0.766197 test: 0.755487
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({1: 6440, 0: 4222})

Epoch :  45 loss training:  18.638789411634207 Time :  3288
accuracy train: 0.995780 val: 0.761972 test: 0.760270
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({1: 6468, 0: 4194})

Epoch :  46 loss training:  18.154034186154604 Time :  3304
accuracy train: 0.995936 val: 0.759155 test: 0.753236
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({1: 6455, 0: 4207})

Epoch :  47 loss training:  17.443173779174685 Time :  3320
accuracy train: 0.995780 val: 0.760563 test: 0.750985
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({0: 6476, 1: 4186})

Epoch :  48 loss training:  16.73971822205931 Time :  3336
accuracy train: 0.997187 val: 0.767606 test: 0.753236
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({1: 6479, 0: 4183})

Epoch :  49 loss training:  15.915158156305552 Time :  3352
accuracy train: 0.997499 val: 0.769014 test: 0.751266
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({1: 6481, 0: 4181})

Epoch :  50 loss training:  14.971930757164955 Time :  3372
accuracy train: 0.997968 val: 0.761972 test: 0.753799
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({1: 6503, 0: 4159})

Epoch :  51 loss training:  14.152835353277624 Time :  3393
accuracy train: 0.998437 val: 0.770423 test: 0.758019
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({1: 6524, 0: 4138})

Epoch :  52 loss training:  14.789488933980465 Time :  3410
accuracy train: 0.997968 val: 0.777465 test: 0.755205
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({1: 6522, 0: 4140})

Epoch :  53 loss training:  13.808764518238604 Time :  3427
accuracy train: 0.998593 val: 0.757746 test: 0.754643
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({0: 6534, 1: 4128})

Epoch :  54 loss training:  12.506397432647645 Time :  3444
accuracy train: 0.998437 val: 0.773239 test: 0.761677
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({0: 6542, 1: 4120})

Epoch :  55 loss training:  11.61833924613893 Time :  3461
accuracy train: 0.998437 val: 0.761972 test: 0.751548
max validation accuracy : 0.791549 max acc epoch : 24 test accuracy : 0.759145
Counter({0: 6536, 1: 4126})

========================================================================================================================================================================================================
max acc epoch :  24
max validation accuracy :  0.7915492957746478
test accuracy :  0.7591446257737761
last test_accuracy :  0.7515475520540237
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=202, weight_decay=1e-08)
device :  cuda:0
Counter({0: 6232, 1: 4430})

Epoch :  1 loss training:  93.4936892092228 Time :  3481
accuracy train: 0.772116 val: 0.745070 test: 0.754924
max validation accuracy : 0.745070 max acc epoch : 1 test accuracy : 0.754924
Counter({1: 5579, 0: 5083})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.23223036527634 Time :  3500
accuracy train: 0.796499 val: 0.756338 test: 0.768149
max validation accuracy : 0.756338 max acc epoch : 2 test accuracy : 0.768149
Counter({0: 6644, 1: 4018})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.89676806330681 Time :  3527
accuracy train: 0.810722 val: 0.778873 test: 0.775183
max validation accuracy : 0.778873 max acc epoch : 3 test accuracy : 0.775183
Counter({0: 6097, 1: 4565})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.39437559247017 Time :  3543
accuracy train: 0.825258 val: 0.778873 test: 0.777997
max validation accuracy : 0.778873 max acc epoch : 3 test accuracy : 0.775183
Counter({0: 6230, 1: 4432})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.538872346282 Time :  3560
accuracy train: 0.820100 val: 0.783099 test: 0.770118
max validation accuracy : 0.783099 max acc epoch : 5 test accuracy : 0.770118
Counter({0: 6150, 1: 4512})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.02246525883675 Time :  3575
accuracy train: 0.843545 val: 0.777465 test: 0.772369
max validation accuracy : 0.783099 max acc epoch : 5 test accuracy : 0.770118
Counter({1: 6075, 0: 4587})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.31276452541351 Time :  3592
accuracy train: 0.856205 val: 0.794366 test: 0.767304
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({0: 6007, 1: 4655})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.89271940290928 Time :  3607
accuracy train: 0.862457 val: 0.780282 test: 0.767304
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({0: 6020, 1: 4642})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.58609889447689 Time :  3622
accuracy train: 0.864645 val: 0.781690 test: 0.768149
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({1: 5980, 0: 4682})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.543647572398186 Time :  3641
accuracy train: 0.863395 val: 0.791549 test: 0.766179
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({0: 5978, 1: 4684})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.240877881646156 Time :  3661
accuracy train: 0.876368 val: 0.781690 test: 0.764772
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({0: 5978, 1: 4684})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  60.58485563099384 Time :  3677
accuracy train: 0.877931 val: 0.790141 test: 0.765616
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({0: 5964, 1: 4698})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  58.39125771820545 Time :  3693
accuracy train: 0.880588 val: 0.791549 test: 0.768430
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({0: 5966, 1: 4696})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  58.084785506129265 Time :  3709
accuracy train: 0.890903 val: 0.785915 test: 0.768711
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({1: 5971, 0: 4691})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  57.69002377986908 Time :  3726
accuracy train: 0.887465 val: 0.787324 test: 0.767867
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({0: 5979, 1: 4683})

Epoch :  16 loss training:  57.56512339413166 Time :  3742
accuracy train: 0.893560 val: 0.784507 test: 0.765898
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({1: 5977, 0: 4685})

Epoch :  17 loss training:  55.47276186943054 Time :  3758
accuracy train: 0.901063 val: 0.787324 test: 0.770400
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({1: 6003, 0: 4659})

Epoch :  18 loss training:  53.28080143034458 Time :  3786
accuracy train: 0.911535 val: 0.783099 test: 0.770118
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({0: 6029, 1: 4633})

Epoch :  19 loss training:  51.922997802495956 Time :  3805
accuracy train: 0.911691 val: 0.788732 test: 0.771806
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({1: 6056, 0: 4606})

Epoch :  20 loss training:  51.0693514496088 Time :  3822
accuracy train: 0.917787 val: 0.783099 test: 0.763928
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({1: 6052, 0: 4610})

Epoch :  21 loss training:  49.60082358121872 Time :  3840
accuracy train: 0.926696 val: 0.773239 test: 0.765616
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({1: 6065, 0: 4597})

Epoch :  22 loss training:  47.542876824736595 Time :  3857
accuracy train: 0.928415 val: 0.785915 test: 0.766460
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({0: 6078, 1: 4584})

Epoch :  23 loss training:  46.08593925833702 Time :  3874
accuracy train: 0.937793 val: 0.778873 test: 0.769555
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({0: 6119, 1: 4543})

Epoch :  24 loss training:  44.946378476917744 Time :  3891
accuracy train: 0.939981 val: 0.784507 test: 0.766179
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({0: 6133, 1: 4529})

Epoch :  25 loss training:  42.77792578190565 Time :  3912
accuracy train: 0.943420 val: 0.777465 test: 0.763928
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({1: 6134, 0: 4528})

Epoch :  26 loss training:  41.02676863223314 Time :  3931
accuracy train: 0.954361 val: 0.771831 test: 0.767867
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({0: 6170, 1: 4492})

Epoch :  27 loss training:  39.475114196538925 Time :  3948
accuracy train: 0.955142 val: 0.771831 test: 0.768711
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({0: 6155, 1: 4507})

Epoch :  28 loss training:  38.667857117950916 Time :  3964
accuracy train: 0.959362 val: 0.774648 test: 0.767586
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({1: 6163, 0: 4499})

Epoch :  29 loss training:  37.57494319230318 Time :  3980
accuracy train: 0.964364 val: 0.776056 test: 0.764209
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({1: 6184, 0: 4478})

Epoch :  30 loss training:  36.25966740399599 Time :  3996
accuracy train: 0.966552 val: 0.773239 test: 0.763365
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({1: 6216, 0: 4446})

Epoch :  31 loss training:  34.06717377156019 Time :  4012
accuracy train: 0.968584 val: 0.780282 test: 0.767586
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({1: 6209, 0: 4453})

Epoch :  32 loss training:  32.968531399965286 Time :  4027
accuracy train: 0.971866 val: 0.763380 test: 0.758301
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({0: 6198, 1: 4464})

Epoch :  33 loss training:  29.964069966226816 Time :  4054
accuracy train: 0.975305 val: 0.780282 test: 0.765335
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({1: 6218, 0: 4444})

Epoch :  34 loss training:  31.261602237820625 Time :  4071
accuracy train: 0.979369 val: 0.770423 test: 0.761114
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({0: 6237, 1: 4425})

Epoch :  35 loss training:  29.411633349955082 Time :  4087
accuracy train: 0.980775 val: 0.759155 test: 0.765898
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({1: 6236, 0: 4426})

Epoch :  36 loss training:  27.21998143568635 Time :  4104
accuracy train: 0.983589 val: 0.766197 test: 0.759707
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({0: 6253, 1: 4409})

Epoch :  37 loss training:  26.252927504479885 Time :  4121
accuracy train: 0.985152 val: 0.769014 test: 0.761396
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({1: 6255, 0: 4407})

Epoch :  38 loss training:  25.99831585586071 Time :  4137
accuracy train: 0.984683 val: 0.770423 test: 0.765053
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767304
Counter({0: 6271, 1: 4391})

========================================================================================================================================================================================================
max acc epoch :  7
max validation accuracy :  0.7943661971830986
test accuracy :  0.7673044456949916
last test_accuracy :  0.765053460889139
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=202, weight_decay=1e-08)
device :  cuda:0
Counter({0: 6232, 1: 4430})

Epoch :  1 loss training:  93.37475135922432 Time :  4157
accuracy train: 0.771335 val: 0.738028 test: 0.753236
max validation accuracy : 0.738028 max acc epoch : 1 test accuracy : 0.753236
Counter({1: 5521, 0: 5141})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.71735134720802 Time :  4188
accuracy train: 0.795874 val: 0.760563 test: 0.769274
max validation accuracy : 0.760563 max acc epoch : 2 test accuracy : 0.769274
Counter({0: 6052, 1: 4610})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.2591976672411 Time :  4205
accuracy train: 0.802907 val: 0.771831 test: 0.777434
max validation accuracy : 0.771831 max acc epoch : 3 test accuracy : 0.777434
Counter({0: 5796, 1: 4866})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.13514751195908 Time :  4220
accuracy train: 0.826821 val: 0.783099 test: 0.779403
max validation accuracy : 0.783099 max acc epoch : 4 test accuracy : 0.779403
Counter({0: 5962, 1: 4700})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  70.80456611514091 Time :  4237
accuracy train: 0.824476 val: 0.780282 test: 0.776590
max validation accuracy : 0.783099 max acc epoch : 4 test accuracy : 0.779403
Counter({0: 6115, 1: 4547})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.52118842303753 Time :  4256
accuracy train: 0.843701 val: 0.791549 test: 0.770118
max validation accuracy : 0.791549 max acc epoch : 6 test accuracy : 0.770118
Counter({0: 6129, 1: 4533})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  65.36587914824486 Time :  4273
accuracy train: 0.853079 val: 0.794366 test: 0.767867
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767867
Counter({0: 6220, 1: 4442})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  63.72281090915203 Time :  4290
accuracy train: 0.867771 val: 0.784507 test: 0.767023
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.767867
Counter({0: 6229, 1: 4433})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.049990355968475 Time :  4306
accuracy train: 0.873085 val: 0.801408 test: 0.770962
max validation accuracy : 0.801408 max acc epoch : 9 test accuracy : 0.770962
Counter({0: 6207, 1: 4455})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.594068825244904 Time :  4333
accuracy train: 0.876368 val: 0.800000 test: 0.770681
max validation accuracy : 0.801408 max acc epoch : 9 test accuracy : 0.770962
Counter({0: 6216, 1: 4446})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.95669558644295 Time :  4350
accuracy train: 0.886996 val: 0.804225 test: 0.765898
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({0: 6228, 1: 4434})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.78571407496929 Time :  4366
accuracy train: 0.888715 val: 0.795775 test: 0.763365
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({0: 6208, 1: 4454})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  56.35574449598789 Time :  4382
accuracy train: 0.889653 val: 0.792958 test: 0.769274
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({0: 6212, 1: 4450})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.296641796827316 Time :  4398
accuracy train: 0.897312 val: 0.791549 test: 0.764772
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({0: 6213, 1: 4449})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.66733558475971 Time :  4413
accuracy train: 0.899031 val: 0.788732 test: 0.763928
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({0: 6222, 1: 4440})

Epoch :  16 loss training:  55.88986609876156 Time :  4430
accuracy train: 0.903095 val: 0.790141 test: 0.763928
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({0: 6220, 1: 4442})

Epoch :  17 loss training:  53.7615012973547 Time :  4457
accuracy train: 0.908721 val: 0.794366 test: 0.767023
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({1: 6230, 0: 4432})

Epoch :  18 loss training:  51.88995783030987 Time :  4474
accuracy train: 0.914192 val: 0.788732 test: 0.763365
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({0: 6241, 1: 4421})

Epoch :  19 loss training:  50.264702282845974 Time :  4491
accuracy train: 0.921382 val: 0.798592 test: 0.764209
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({0: 6256, 1: 4406})

Epoch :  20 loss training:  49.34981454908848 Time :  4508
accuracy train: 0.927165 val: 0.791549 test: 0.758301
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({0: 6260, 1: 4402})

Epoch :  21 loss training:  47.929261550307274 Time :  4525
accuracy train: 0.934511 val: 0.784507 test: 0.764772
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({0: 6278, 1: 4384})

Epoch :  22 loss training:  45.5885216742754 Time :  4542
accuracy train: 0.936386 val: 0.795775 test: 0.763928
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({0: 6267, 1: 4395})

Epoch :  23 loss training:  44.74811502546072 Time :  4557
accuracy train: 0.944201 val: 0.787324 test: 0.764491
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({1: 6281, 0: 4381})

Epoch :  24 loss training:  43.820572316646576 Time :  4581
accuracy train: 0.944670 val: 0.798592 test: 0.767023
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({1: 6279, 0: 4383})

Epoch :  25 loss training:  40.97734843939543 Time :  4597
accuracy train: 0.952016 val: 0.788732 test: 0.762521
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({0: 6292, 1: 4370})

Epoch :  26 loss training:  39.248906813561916 Time :  4614
accuracy train: 0.957174 val: 0.784507 test: 0.761114
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({0: 6323, 1: 4339})

Epoch :  27 loss training:  38.15141287446022 Time :  4630
accuracy train: 0.958581 val: 0.784507 test: 0.759145
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({1: 6329, 0: 4333})

Epoch :  28 loss training:  38.078988030552864 Time :  4646
accuracy train: 0.963582 val: 0.787324 test: 0.763365
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({1: 6329, 0: 4333})

Epoch :  29 loss training:  36.84111850708723 Time :  4662
accuracy train: 0.966865 val: 0.791549 test: 0.760551
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({1: 6353, 0: 4309})

Epoch :  30 loss training:  34.26079671084881 Time :  4679
accuracy train: 0.969365 val: 0.788732 test: 0.759426
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({0: 6373, 1: 4289})

Epoch :  31 loss training:  33.1132944971323 Time :  4701
accuracy train: 0.971397 val: 0.792958 test: 0.764209
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({1: 6368, 0: 4294})

Epoch :  32 loss training:  31.20482689142227 Time :  4718
accuracy train: 0.976868 val: 0.780282 test: 0.758301
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({0: 6379, 1: 4283})

Epoch :  33 loss training:  28.867975741624832 Time :  4735
accuracy train: 0.979369 val: 0.788732 test: 0.755205
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({0: 6403, 1: 4259})

Epoch :  34 loss training:  29.974792037159204 Time :  4752
accuracy train: 0.982026 val: 0.783099 test: 0.756331
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({1: 6381, 0: 4281})

Epoch :  35 loss training:  28.82734990492463 Time :  4768
accuracy train: 0.983745 val: 0.783099 test: 0.756331
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({0: 6385, 1: 4277})

Epoch :  36 loss training:  26.287010930478573 Time :  4785
accuracy train: 0.987340 val: 0.783099 test: 0.754080
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({0: 6390, 1: 4272})

Epoch :  37 loss training:  25.2720062173903 Time :  4802
accuracy train: 0.989684 val: 0.783099 test: 0.754924
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({1: 6393, 0: 4269})

Epoch :  38 loss training:  25.27310890518129 Time :  4822
accuracy train: 0.987652 val: 0.780282 test: 0.754080
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({0: 6407, 1: 4255})

Epoch :  39 loss training:  24.085221510380507 Time :  4841
accuracy train: 0.990309 val: 0.788732 test: 0.758863
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({0: 6418, 1: 4244})

Epoch :  40 loss training:  22.281851455569267 Time :  4858
accuracy train: 0.991404 val: 0.778873 test: 0.756894
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({0: 6422, 1: 4240})

Epoch :  41 loss training:  19.97345895692706 Time :  4873
accuracy train: 0.992029 val: 0.781690 test: 0.755487
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({0: 6448, 1: 4214})

Epoch :  42 loss training:  21.91454976797104 Time :  4890
accuracy train: 0.993592 val: 0.781690 test: 0.755205
max validation accuracy : 0.804225 max acc epoch : 11 test accuracy : 0.765898
Counter({0: 6446, 1: 4216})

========================================================================================================================================================================================================
max acc epoch :  11
max validation accuracy :  0.8042253521126761
test accuracy :  0.7658975801913337
last test_accuracy :  0.7552054023635341
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=202, weight_decay=1e-08)
device :  cuda:0
Counter({0: 6232, 1: 4430})

Epoch :  1 loss training:  93.37938472628593 Time :  4910
accuracy train: 0.772898 val: 0.746479 test: 0.756612
max validation accuracy : 0.746479 max acc epoch : 1 test accuracy : 0.756612
Counter({0: 5477, 1: 5185})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.36149716377258 Time :  4927
accuracy train: 0.798687 val: 0.757746 test: 0.774057
max validation accuracy : 0.757746 max acc epoch : 2 test accuracy : 0.774057
Counter({0: 6214, 1: 4448})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.96939077973366 Time :  4947
accuracy train: 0.816193 val: 0.777465 test: 0.777153
max validation accuracy : 0.777465 max acc epoch : 3 test accuracy : 0.777153
Counter({0: 6008, 1: 4654})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.28209406137466 Time :  4964
accuracy train: 0.832917 val: 0.781690 test: 0.773495
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.773495
Counter({0: 6137, 1: 4525})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  70.81640721857548 Time :  4980
accuracy train: 0.831197 val: 0.791549 test: 0.770118
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({0: 6082, 1: 4580})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.68283462524414 Time :  4997
accuracy train: 0.846046 val: 0.774648 test: 0.771525
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({1: 6038, 0: 4624})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  65.72767286002636 Time :  5015
accuracy train: 0.854486 val: 0.778873 test: 0.764772
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({0: 6091, 1: 4571})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.24868842959404 Time :  5032
accuracy train: 0.864333 val: 0.784507 test: 0.762802
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({1: 6134, 0: 4528})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.72254966199398 Time :  5048
accuracy train: 0.871835 val: 0.778873 test: 0.768711
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({0: 6080, 1: 4582})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.768400594592094 Time :  5069
accuracy train: 0.875274 val: 0.778873 test: 0.769274
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({0: 6088, 1: 4574})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.44331467151642 Time :  5089
accuracy train: 0.882932 val: 0.774648 test: 0.763928
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({0: 6084, 1: 4578})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.892657309770584 Time :  5106
accuracy train: 0.890122 val: 0.778873 test: 0.766742
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({0: 6124, 1: 4538})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.301519468426704 Time :  5121
accuracy train: 0.888872 val: 0.769014 test: 0.768430
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({1: 6123, 0: 4539})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.912013202905655 Time :  5138
accuracy train: 0.894498 val: 0.770423 test: 0.766179
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({0: 6130, 1: 4532})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.60503752529621 Time :  5155
accuracy train: 0.897624 val: 0.770423 test: 0.766179
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({0: 6133, 1: 4529})

Epoch :  16 loss training:  56.27365167438984 Time :  5170
accuracy train: 0.903564 val: 0.769014 test: 0.765616
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({0: 6149, 1: 4513})

Epoch :  17 loss training:  54.28180955350399 Time :  5187
accuracy train: 0.908253 val: 0.773239 test: 0.766460
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({0: 6160, 1: 4502})

Epoch :  18 loss training:  52.077020183205605 Time :  5215
accuracy train: 0.913254 val: 0.773239 test: 0.766460
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({0: 6167, 1: 4495})

Epoch :  19 loss training:  50.07340207695961 Time :  5232
accuracy train: 0.919506 val: 0.773239 test: 0.766742
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({1: 6184, 0: 4478})

Epoch :  20 loss training:  49.63023683428764 Time :  5249
accuracy train: 0.923414 val: 0.771831 test: 0.764491
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({1: 6195, 0: 4467})

Epoch :  21 loss training:  47.971864730119705 Time :  5265
accuracy train: 0.929197 val: 0.774648 test: 0.763084
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({0: 6220, 1: 4442})

Epoch :  22 loss training:  46.20164519548416 Time :  5282
accuracy train: 0.936386 val: 0.780282 test: 0.763647
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({0: 6231, 1: 4431})

Epoch :  23 loss training:  45.11716363579035 Time :  5299
accuracy train: 0.942482 val: 0.778873 test: 0.762802
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({0: 6259, 1: 4403})

Epoch :  24 loss training:  43.650891937315464 Time :  5316
accuracy train: 0.943889 val: 0.777465 test: 0.767304
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({1: 6271, 0: 4391})

Epoch :  25 loss training:  41.358496837317944 Time :  5339
accuracy train: 0.948421 val: 0.774648 test: 0.767586
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({0: 6280, 1: 4382})

Epoch :  26 loss training:  39.28370711952448 Time :  5356
accuracy train: 0.955142 val: 0.785915 test: 0.764209
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({0: 6291, 1: 4371})

Epoch :  27 loss training:  39.30994505435228 Time :  5373
accuracy train: 0.958581 val: 0.781690 test: 0.766179
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({0: 6285, 1: 4377})

Epoch :  28 loss training:  37.70341282337904 Time :  5390
accuracy train: 0.962801 val: 0.780282 test: 0.760833
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({0: 6297, 1: 4365})

Epoch :  29 loss training:  36.23478801548481 Time :  5407
accuracy train: 0.967646 val: 0.780282 test: 0.762521
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({0: 6326, 1: 4336})

Epoch :  30 loss training:  34.55445969104767 Time :  5424
accuracy train: 0.969522 val: 0.771831 test: 0.759707
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({0: 6335, 1: 4327})

Epoch :  31 loss training:  33.056538216769695 Time :  5440
accuracy train: 0.969678 val: 0.783099 test: 0.765335
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({0: 6345, 1: 4317})

Epoch :  32 loss training:  31.913586974143982 Time :  5461
accuracy train: 0.976086 val: 0.774648 test: 0.761396
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({0: 6342, 1: 4320})

Epoch :  33 loss training:  28.783488981425762 Time :  5477
accuracy train: 0.979369 val: 0.777465 test: 0.761114
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({0: 6371, 1: 4291})

Epoch :  34 loss training:  29.906958620995283 Time :  5494
accuracy train: 0.982338 val: 0.767606 test: 0.759989
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({1: 6358, 0: 4304})

Epoch :  35 loss training:  27.631984904408455 Time :  5512
accuracy train: 0.983432 val: 0.774648 test: 0.757175
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({0: 6354, 1: 4308})

Epoch :  36 loss training:  26.089620178565383 Time :  5527
accuracy train: 0.986871 val: 0.770423 test: 0.760833
max validation accuracy : 0.791549 max acc epoch : 5 test accuracy : 0.770118
Counter({1: 6375, 0: 4287})

========================================================================================================================================================================================================
max acc epoch :  5
max validation accuracy :  0.7915492957746478
test accuracy :  0.7701181767023073
last test_accuracy :  0.7608328643781654
========================================================================================================================================================================================================

itr : 6
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=202, weight_decay=1e-08)
device :  cuda:0
Counter({0: 6232, 1: 4430})

Epoch :  1 loss training:  93.42204594612122 Time :  5547
accuracy train: 0.770553 val: 0.745070 test: 0.751829
max validation accuracy : 0.745070 max acc epoch : 1 test accuracy : 0.751829
Counter({0: 5489, 1: 5173})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  81.91649296879768 Time :  5564
accuracy train: 0.794311 val: 0.754930 test: 0.771525
max validation accuracy : 0.754930 max acc epoch : 2 test accuracy : 0.771525
Counter({1: 5474, 0: 5188})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.52232253551483 Time :  5586
accuracy train: 0.811972 val: 0.763380 test: 0.776871
max validation accuracy : 0.763380 max acc epoch : 3 test accuracy : 0.776871
Counter({0: 5940, 1: 4722})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.16863562166691 Time :  5607
accuracy train: 0.823382 val: 0.780282 test: 0.781092
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.781092
Counter({0: 5938, 1: 4724})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.25621484220028 Time :  5625
accuracy train: 0.819631 val: 0.776056 test: 0.775464
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.781092
Counter({0: 6622, 1: 4040})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.83131420612335 Time :  5642
accuracy train: 0.841044 val: 0.778873 test: 0.771806
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.781092
Counter({1: 7835, 0: 2827})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.32985210418701 Time :  5659
accuracy train: 0.852141 val: 0.776056 test: 0.770681
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.781092
Counter({0: 7863, 1: 2799})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.94119197130203 Time :  5677
accuracy train: 0.854329 val: 0.778873 test: 0.766179
max validation accuracy : 0.780282 max acc epoch : 4 test accuracy : 0.781092
Counter({0: 6816, 1: 3846})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.5311630666256 Time :  5694
accuracy train: 0.863239 val: 0.788732 test: 0.774057
max validation accuracy : 0.788732 max acc epoch : 9 test accuracy : 0.774057
Counter({1: 7180, 0: 3482})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  62.794360876083374 Time :  5715
accuracy train: 0.869334 val: 0.790141 test: 0.772088
max validation accuracy : 0.790141 max acc epoch : 10 test accuracy : 0.772088
Counter({1: 7187, 0: 3475})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  61.83756759762764 Time :  5733
accuracy train: 0.876055 val: 0.787324 test: 0.771525
max validation accuracy : 0.790141 max acc epoch : 10 test accuracy : 0.772088
Counter({0: 7423, 1: 3239})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  61.89118453860283 Time :  5751
accuracy train: 0.880588 val: 0.788732 test: 0.768993
max validation accuracy : 0.790141 max acc epoch : 10 test accuracy : 0.772088
Counter({0: 7397, 1: 3265})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  59.6577192991972 Time :  5770
accuracy train: 0.878868 val: 0.791549 test: 0.775746
max validation accuracy : 0.791549 max acc epoch : 13 test accuracy : 0.775746
Counter({1: 7456, 0: 3206})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  59.2816346436739 Time :  5785
accuracy train: 0.885433 val: 0.787324 test: 0.772088
max validation accuracy : 0.791549 max acc epoch : 13 test accuracy : 0.775746
Counter({0: 7482, 1: 3180})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  59.541339203715324 Time :  5802
accuracy train: 0.887309 val: 0.780282 test: 0.769274
max validation accuracy : 0.791549 max acc epoch : 13 test accuracy : 0.775746
Counter({0: 7158, 1: 3504})

Epoch :  16 loss training:  59.05189648270607 Time :  5820
accuracy train: 0.894186 val: 0.781690 test: 0.772369
max validation accuracy : 0.791549 max acc epoch : 13 test accuracy : 0.775746
Counter({0: 7411, 1: 3251})

Epoch :  17 loss training:  56.65458495914936 Time :  5838
accuracy train: 0.896061 val: 0.781690 test: 0.770400
max validation accuracy : 0.791549 max acc epoch : 13 test accuracy : 0.775746
Counter({1: 7427, 0: 3235})

Epoch :  18 loss training:  54.90648539364338 Time :  5863
accuracy train: 0.906221 val: 0.792958 test: 0.768149
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 7511, 1: 3151})

Epoch :  19 loss training:  53.450591795146465 Time :  5881
accuracy train: 0.907315 val: 0.784507 test: 0.774057
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 7482, 1: 3180})

Epoch :  20 loss training:  52.454426780343056 Time :  5900
accuracy train: 0.915599 val: 0.791549 test: 0.772088
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 7422, 1: 3240})

Epoch :  21 loss training:  50.686826288700104 Time :  5919
accuracy train: 0.921382 val: 0.780282 test: 0.771525
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 7477, 1: 3185})

Epoch :  22 loss training:  49.23444449901581 Time :  5938
accuracy train: 0.923414 val: 0.787324 test: 0.771525
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 7491, 1: 3171})

Epoch :  23 loss training:  48.006978906691074 Time :  5957
accuracy train: 0.933573 val: 0.790141 test: 0.767867
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 7449, 1: 3213})

Epoch :  24 loss training:  46.80520322918892 Time :  5976
accuracy train: 0.935917 val: 0.781690 test: 0.774902
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 7359, 1: 3303})

Epoch :  25 loss training:  44.81310884654522 Time :  6007
accuracy train: 0.941075 val: 0.787324 test: 0.773213
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 7055, 1: 3607})

Epoch :  26 loss training:  42.75378479063511 Time :  6024
accuracy train: 0.949203 val: 0.778873 test: 0.767867
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 7145, 1: 3517})

Epoch :  27 loss training:  42.8546776548028 Time :  6042
accuracy train: 0.952173 val: 0.780282 test: 0.769837
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 7085, 1: 3577})

Epoch :  28 loss training:  42.3011544495821 Time :  6060
accuracy train: 0.958425 val: 0.783099 test: 0.769274
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 6000, 1: 4662})

Epoch :  29 loss training:  39.724689811468124 Time :  6078
accuracy train: 0.959987 val: 0.777465 test: 0.768993
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({1: 5856, 0: 4806})

Epoch :  30 loss training:  38.78240578621626 Time :  6096
accuracy train: 0.962176 val: 0.776056 test: 0.771244
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 7155, 1: 3507})

Epoch :  31 loss training:  36.830872535705566 Time :  6117
accuracy train: 0.964208 val: 0.784507 test: 0.772369
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 7253, 1: 3409})

Epoch :  32 loss training:  35.56493631750345 Time :  6150
accuracy train: 0.969053 val: 0.776056 test: 0.768993
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({1: 7450, 0: 3212})

Epoch :  33 loss training:  32.06238520517945 Time :  6168
accuracy train: 0.971710 val: 0.781690 test: 0.768430
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 7456, 1: 3206})

Epoch :  34 loss training:  33.40512244403362 Time :  6186
accuracy train: 0.973429 val: 0.781690 test: 0.768149
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 7412, 1: 3250})

Epoch :  35 loss training:  32.64616361260414 Time :  6202
accuracy train: 0.975930 val: 0.774648 test: 0.770962
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 7350, 1: 3312})

Epoch :  36 loss training:  29.5778042152524 Time :  6220
accuracy train: 0.980932 val: 0.781690 test: 0.766179
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({1: 7359, 0: 3303})

Epoch :  37 loss training:  28.353363625705242 Time :  6239
accuracy train: 0.983120 val: 0.780282 test: 0.765616
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 7076, 1: 3586})

Epoch :  38 loss training:  28.327435184270144 Time :  6257
accuracy train: 0.983901 val: 0.780282 test: 0.768430
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 6913, 1: 3749})

Epoch :  39 loss training:  26.792024180293083 Time :  6289
accuracy train: 0.983901 val: 0.785915 test: 0.768149
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 6990, 1: 3672})

Epoch :  40 loss training:  25.538114566355944 Time :  6306
accuracy train: 0.986402 val: 0.787324 test: 0.770118
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 7003, 1: 3659})

Epoch :  41 loss training:  23.040869787335396 Time :  6324
accuracy train: 0.987809 val: 0.778873 test: 0.767867
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 6999, 1: 3663})

Epoch :  42 loss training:  24.682472303509712 Time :  6340
accuracy train: 0.989372 val: 0.778873 test: 0.770962
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 7007, 1: 3655})

Epoch :  43 loss training:  23.824903674423695 Time :  6358
accuracy train: 0.990935 val: 0.785915 test: 0.767586
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 7028, 1: 3634})

Epoch :  44 loss training:  22.653306484222412 Time :  6377
accuracy train: 0.992810 val: 0.780282 test: 0.766460
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 7054, 1: 3608})

Epoch :  45 loss training:  21.090446474030614 Time :  6395
accuracy train: 0.993904 val: 0.784507 test: 0.768149
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 7051, 1: 3611})

Epoch :  46 loss training:  20.616451509296894 Time :  6416
accuracy train: 0.995155 val: 0.773239 test: 0.760551
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 7046, 1: 3616})

Epoch :  47 loss training:  19.46435633301735 Time :  6437
accuracy train: 0.993904 val: 0.777465 test: 0.765616
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 7043, 1: 3619})

Epoch :  48 loss training:  18.87763607315719 Time :  6456
accuracy train: 0.995624 val: 0.777465 test: 0.768430
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 7045, 1: 3617})

Epoch :  49 loss training:  18.054056383669376 Time :  6474
accuracy train: 0.995467 val: 0.777465 test: 0.767586
max validation accuracy : 0.792958 max acc epoch : 18 test accuracy : 0.768149
Counter({0: 7038, 1: 3624})

========================================================================================================================================================================================================
max acc epoch :  18
max validation accuracy :  0.7929577464788733
test accuracy :  0.7681485649971863
last test_accuracy :  0.7675858187957231
========================================================================================================================================================================================================

itr : 7
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=202, weight_decay=1e-08)
device :  cuda:0
Counter({0: 6232, 1: 4430})

Epoch :  1 loss training:  93.39391249418259 Time :  6495
accuracy train: 0.770866 val: 0.740845 test: 0.757456
max validation accuracy : 0.740845 max acc epoch : 1 test accuracy : 0.757456
Counter({1: 5833, 0: 4829})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.34588959813118 Time :  6511
accuracy train: 0.801032 val: 0.749296 test: 0.773495
max validation accuracy : 0.749296 max acc epoch : 2 test accuracy : 0.773495
Counter({0: 5990, 1: 4672})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.20144635438919 Time :  6527
accuracy train: 0.812754 val: 0.777465 test: 0.778278
max validation accuracy : 0.777465 max acc epoch : 3 test accuracy : 0.778278
Counter({1: 6424, 0: 4238})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.80187511444092 Time :  6544
accuracy train: 0.825414 val: 0.778873 test: 0.778841
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.778841
Counter({1: 6371, 0: 4291})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.7654106169939 Time :  6574
accuracy train: 0.831354 val: 0.794366 test: 0.774339
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({0: 6475, 1: 4187})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.01738935709 Time :  6592
accuracy train: 0.842763 val: 0.790141 test: 0.774339
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({0: 6584, 1: 4078})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.44562794268131 Time :  6608
accuracy train: 0.846671 val: 0.766197 test: 0.764209
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({1: 6673, 0: 3989})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.25931471586227 Time :  6624
accuracy train: 0.863395 val: 0.773239 test: 0.766179
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({0: 6666, 1: 3996})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.81454864144325 Time :  6641
accuracy train: 0.868396 val: 0.778873 test: 0.767867
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({0: 6639, 1: 4023})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.463062420487404 Time :  6658
accuracy train: 0.868553 val: 0.783099 test: 0.768711
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({1: 6667, 0: 3995})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.48693390190601 Time :  6673
accuracy train: 0.884651 val: 0.778873 test: 0.762240
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({0: 6699, 1: 3963})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  60.85070511698723 Time :  6694
accuracy train: 0.880119 val: 0.788732 test: 0.765616
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({0: 6645, 1: 4017})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  58.35924692451954 Time :  6713
accuracy train: 0.886214 val: 0.788732 test: 0.772088
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({0: 6697, 1: 3965})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  58.00392399728298 Time :  6729
accuracy train: 0.891841 val: 0.783099 test: 0.767867
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({1: 6678, 0: 3984})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  57.650945484638214 Time :  6748
accuracy train: 0.893248 val: 0.784507 test: 0.767304
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({1: 6673, 0: 3989})

Epoch :  16 loss training:  57.45186059176922 Time :  6764
accuracy train: 0.897781 val: 0.778873 test: 0.766179
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({1: 6667, 0: 3995})

Epoch :  17 loss training:  55.599588453769684 Time :  6780
accuracy train: 0.902626 val: 0.791549 test: 0.768711
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({0: 6667, 1: 3995})

Epoch :  18 loss training:  53.09038135409355 Time :  6796
accuracy train: 0.909347 val: 0.781690 test: 0.768430
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({0: 6671, 1: 3991})

Epoch :  19 loss training:  52.53717506676912 Time :  6813
accuracy train: 0.913567 val: 0.783099 test: 0.768711
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({0: 6690, 1: 3972})

Epoch :  20 loss training:  50.950019016861916 Time :  6842
accuracy train: 0.919037 val: 0.778873 test: 0.763647
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({1: 6681, 0: 3981})

Epoch :  21 loss training:  48.60297943651676 Time :  6859
accuracy train: 0.923414 val: 0.785915 test: 0.766179
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({0: 6693, 1: 3969})

Epoch :  22 loss training:  46.727088175714016 Time :  6876
accuracy train: 0.927634 val: 0.780282 test: 0.767867
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({0: 6680, 1: 3982})

Epoch :  23 loss training:  45.81144027411938 Time :  6892
accuracy train: 0.937949 val: 0.788732 test: 0.765616
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({0: 6696, 1: 3966})

Epoch :  24 loss training:  44.92779967933893 Time :  6907
accuracy train: 0.938887 val: 0.783099 test: 0.769837
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({1: 6702, 0: 3960})

Epoch :  25 loss training:  42.41482412815094 Time :  6924
accuracy train: 0.945608 val: 0.784507 test: 0.766179
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({1: 6710, 0: 3952})

Epoch :  26 loss training:  40.926658891141415 Time :  6940
accuracy train: 0.952485 val: 0.790141 test: 0.760833
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({0: 6726, 1: 3936})

Epoch :  27 loss training:  40.56903035193682 Time :  6962
accuracy train: 0.953579 val: 0.788732 test: 0.762802
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({0: 6721, 1: 3941})

Epoch :  28 loss training:  39.91374956816435 Time :  6978
accuracy train: 0.956705 val: 0.788732 test: 0.767023
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({1: 6719, 0: 3943})

Epoch :  29 loss training:  37.19069239497185 Time :  6995
accuracy train: 0.962488 val: 0.791549 test: 0.762521
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({1: 6739, 0: 3923})

Epoch :  30 loss training:  36.30437645316124 Time :  7012
accuracy train: 0.964520 val: 0.790141 test: 0.765898
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({0: 6748, 1: 3914})

Epoch :  31 loss training:  34.32792495936155 Time :  7029
accuracy train: 0.967802 val: 0.792958 test: 0.764209
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({0: 6732, 1: 3930})

Epoch :  32 loss training:  32.773519322276115 Time :  7045
accuracy train: 0.972960 val: 0.770423 test: 0.760270
max validation accuracy : 0.794366 max acc epoch : 5 test accuracy : 0.774339
Counter({0: 6720, 1: 3942})

Epoch :  33 loss training:  29.83077520504594 Time :  7062
accuracy train: 0.977024 val: 0.795775 test: 0.761114
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({0: 6745, 1: 3917})

Epoch :  34 loss training:  31.211668454110622 Time :  7084
accuracy train: 0.979681 val: 0.787324 test: 0.761958
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({0: 6750, 1: 3912})

Epoch :  35 loss training:  30.199924487620592 Time :  7100
accuracy train: 0.981869 val: 0.784507 test: 0.758863
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({1: 6745, 0: 3917})

Epoch :  36 loss training:  27.05761979520321 Time :  7117
accuracy train: 0.984058 val: 0.780282 test: 0.756612
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({0: 6752, 1: 3910})

Epoch :  37 loss training:  25.653828024864197 Time :  7132
accuracy train: 0.986402 val: 0.780282 test: 0.756612
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({0: 6749, 1: 3913})

Epoch :  38 loss training:  25.96821202337742 Time :  7149
accuracy train: 0.987183 val: 0.778873 test: 0.758019
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({0: 6745, 1: 3917})

Epoch :  39 loss training:  24.50680324435234 Time :  7165
accuracy train: 0.989372 val: 0.771831 test: 0.758863
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({0: 6761, 1: 3901})

Epoch :  40 loss training:  23.335792262107134 Time :  7182
accuracy train: 0.989215 val: 0.771831 test: 0.761114
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({0: 6747, 1: 3915})

Epoch :  41 loss training:  20.432429261505604 Time :  7202
accuracy train: 0.991560 val: 0.774648 test: 0.758582
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({1: 6752, 0: 3910})

Epoch :  42 loss training:  22.18124793842435 Time :  7226
accuracy train: 0.991872 val: 0.781690 test: 0.758863
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({0: 6750, 1: 3912})

Epoch :  43 loss training:  21.778851341456175 Time :  7242
accuracy train: 0.992810 val: 0.776056 test: 0.757175
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({0: 6751, 1: 3911})

Epoch :  44 loss training:  20.44679445400834 Time :  7259
accuracy train: 0.993904 val: 0.776056 test: 0.761114
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({0: 6753, 1: 3909})

Epoch :  45 loss training:  19.528701305389404 Time :  7274
accuracy train: 0.995155 val: 0.778873 test: 0.759145
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({0: 6751, 1: 3911})

Epoch :  46 loss training:  18.27741910982877 Time :  7290
accuracy train: 0.994373 val: 0.777465 test: 0.756331
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({0: 6748, 1: 3914})

Epoch :  47 loss training:  17.359897308051586 Time :  7306
accuracy train: 0.995624 val: 0.771831 test: 0.757738
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({0: 6744, 1: 3918})

Epoch :  48 loss training:  16.322653002105653 Time :  7323
accuracy train: 0.996874 val: 0.770423 test: 0.756331
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({0: 6739, 1: 3923})

Epoch :  49 loss training:  15.860324153676629 Time :  7353
accuracy train: 0.997030 val: 0.771831 test: 0.752110
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({0: 6732, 1: 3930})

Epoch :  50 loss training:  14.455932380631566 Time :  7370
accuracy train: 0.997812 val: 0.778873 test: 0.758582
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({0: 6728, 1: 3934})

Epoch :  51 loss training:  14.032789177261293 Time :  7386
accuracy train: 0.997030 val: 0.784507 test: 0.753236
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({1: 6716, 0: 3946})

Epoch :  52 loss training:  14.453056282363832 Time :  7403
accuracy train: 0.997343 val: 0.776056 test: 0.754924
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({0: 6700, 1: 3962})

Epoch :  53 loss training:  13.341357914730906 Time :  7419
accuracy train: 0.998437 val: 0.784507 test: 0.754080
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({0: 6699, 1: 3963})

Epoch :  54 loss training:  12.312235053628683 Time :  7436
accuracy train: 0.998593 val: 0.778873 test: 0.756894
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({0: 6701, 1: 3961})

Epoch :  55 loss training:  12.332528294064105 Time :  7453
accuracy train: 0.998750 val: 0.764789 test: 0.757175
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({0: 6697, 1: 3965})

Epoch :  56 loss training:  11.900135304778814 Time :  7479
accuracy train: 0.998437 val: 0.771831 test: 0.759707
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({1: 6699, 0: 3963})

Epoch :  57 loss training:  12.011411812156439 Time :  7495
accuracy train: 0.999219 val: 0.770423 test: 0.756612
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({0: 6709, 1: 3953})

Epoch :  58 loss training:  11.205366568639874 Time :  7511
accuracy train: 0.998906 val: 0.769014 test: 0.754080
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({0: 6700, 1: 3962})

Epoch :  59 loss training:  10.778669089078903 Time :  7529
accuracy train: 0.999219 val: 0.776056 test: 0.757175
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({0: 6694, 1: 3968})

Epoch :  60 loss training:  10.870661218650639 Time :  7545
accuracy train: 0.999219 val: 0.764789 test: 0.754361
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({1: 6702, 0: 3960})

Epoch :  61 loss training:  10.503021834883839 Time :  7560
accuracy train: 0.999219 val: 0.771831 test: 0.753799
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({1: 6690, 0: 3972})

Epoch :  62 loss training:  8.14702382311225 Time :  7577
accuracy train: 0.999531 val: 0.769014 test: 0.755487
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({0: 6680, 1: 3982})

Epoch :  63 loss training:  9.485128678381443 Time :  7599
accuracy train: 0.999375 val: 0.773239 test: 0.752673
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({0: 6682, 1: 3980})

Epoch :  64 loss training:  9.637985572218895 Time :  7616
accuracy train: 0.999531 val: 0.778873 test: 0.755768
max validation accuracy : 0.795775 max acc epoch : 33 test accuracy : 0.761114
Counter({0: 6681, 1: 3981})

========================================================================================================================================================================================================
max acc epoch :  33
max validation accuracy :  0.795774647887324
test accuracy :  0.7611142374788971
last test_accuracy :  0.7557681485649972
========================================================================================================================================================================================================

itr : 8
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=202, weight_decay=1e-08)
device :  cuda:0
Counter({0: 6232, 1: 4430})

Epoch :  1 loss training:  93.35926711559296 Time :  7638
accuracy train: 0.769928 val: 0.739437 test: 0.752673
max validation accuracy : 0.739437 max acc epoch : 1 test accuracy : 0.752673
Counter({0: 5408, 1: 5254})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.20276811718941 Time :  7655
accuracy train: 0.792904 val: 0.763380 test: 0.768430
max validation accuracy : 0.763380 max acc epoch : 2 test accuracy : 0.768430
Counter({0: 6679, 1: 3983})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.99284106492996 Time :  7672
accuracy train: 0.813067 val: 0.776056 test: 0.771525
max validation accuracy : 0.776056 max acc epoch : 3 test accuracy : 0.771525
Counter({1: 6968, 0: 3694})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  73.54169760644436 Time :  7687
accuracy train: 0.827446 val: 0.781690 test: 0.773776
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.773776
Counter({1: 6729, 0: 3933})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.64660516381264 Time :  7704
accuracy train: 0.833542 val: 0.784507 test: 0.781092
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.781092
Counter({1: 6752, 0: 3910})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.69326251745224 Time :  7725
accuracy train: 0.848546 val: 0.780282 test: 0.768430
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.781092
Counter({1: 6726, 0: 3936})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.05818624794483 Time :  7741
accuracy train: 0.861676 val: 0.792958 test: 0.769837
max validation accuracy : 0.792958 max acc epoch : 7 test accuracy : 0.769837
Counter({1: 6274, 0: 4388})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.69462813436985 Time :  7756
accuracy train: 0.873711 val: 0.795775 test: 0.768993
max validation accuracy : 0.795775 max acc epoch : 8 test accuracy : 0.768993
Counter({1: 6226, 0: 4436})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.21050959825516 Time :  7773
accuracy train: 0.876837 val: 0.797183 test: 0.774620
max validation accuracy : 0.797183 max acc epoch : 9 test accuracy : 0.774620
Counter({1: 6245, 0: 4417})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.92288161814213 Time :  7790
accuracy train: 0.877462 val: 0.784507 test: 0.770681
max validation accuracy : 0.797183 max acc epoch : 9 test accuracy : 0.774620
Counter({1: 6251, 0: 4411})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.694774851202965 Time :  7807
accuracy train: 0.886683 val: 0.790141 test: 0.770118
max validation accuracy : 0.797183 max acc epoch : 9 test accuracy : 0.774620
Counter({1: 6192, 0: 4470})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.95985651016235 Time :  7824
accuracy train: 0.885277 val: 0.794366 test: 0.772651
max validation accuracy : 0.797183 max acc epoch : 9 test accuracy : 0.774620
Counter({1: 6182, 0: 4480})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.99276550114155 Time :  7842
accuracy train: 0.890747 val: 0.797183 test: 0.772651
max validation accuracy : 0.797183 max acc epoch : 9 test accuracy : 0.774620
Counter({1: 6188, 0: 4474})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.214320212602615 Time :  7867
accuracy train: 0.894342 val: 0.804225 test: 0.771244
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({1: 6157, 0: 4505})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.91966970264912 Time :  7882
accuracy train: 0.893717 val: 0.794366 test: 0.772651
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({1: 6140, 0: 4522})

Epoch :  16 loss training:  57.05532790720463 Time :  7898
accuracy train: 0.898249 val: 0.794366 test: 0.771525
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({0: 6137, 1: 4525})

Epoch :  17 loss training:  54.5206860601902 Time :  7914
accuracy train: 0.908878 val: 0.800000 test: 0.769837
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({0: 6075, 1: 4587})

Epoch :  18 loss training:  52.92662701010704 Time :  7932
accuracy train: 0.912473 val: 0.795775 test: 0.767304
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({1: 5982, 0: 4680})

Epoch :  19 loss training:  50.486087650060654 Time :  7950
accuracy train: 0.918568 val: 0.802817 test: 0.766460
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({0: 5972, 1: 4690})

Epoch :  20 loss training:  50.19544696807861 Time :  7968
accuracy train: 0.923414 val: 0.798592 test: 0.766179
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({1: 5958, 0: 4704})

Epoch :  21 loss training:  48.40025244653225 Time :  7989
accuracy train: 0.929197 val: 0.804225 test: 0.768711
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({1: 5941, 0: 4721})

Epoch :  22 loss training:  46.428752206265926 Time :  8008
accuracy train: 0.932635 val: 0.792958 test: 0.767304
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({1: 5951, 0: 4711})

Epoch :  23 loss training:  45.44316732138395 Time :  8026
accuracy train: 0.940763 val: 0.794366 test: 0.763365
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({1: 5893, 0: 4769})

Epoch :  24 loss training:  44.8193796351552 Time :  8044
accuracy train: 0.942795 val: 0.800000 test: 0.767586
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({1: 5912, 0: 4750})

Epoch :  25 loss training:  41.690318055450916 Time :  8061
accuracy train: 0.949828 val: 0.800000 test: 0.767586
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({1: 5921, 0: 4741})

Epoch :  26 loss training:  40.05871521681547 Time :  8080
accuracy train: 0.953892 val: 0.791549 test: 0.763084
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({1: 5852, 0: 4810})

Epoch :  27 loss training:  40.642210088670254 Time :  8097
accuracy train: 0.957956 val: 0.791549 test: 0.766460
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({1: 5876, 0: 4786})

Epoch :  28 loss training:  39.136979661881924 Time :  8114
accuracy train: 0.962332 val: 0.795775 test: 0.763365
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({0: 5877, 1: 4785})

Epoch :  29 loss training:  36.85953187197447 Time :  8141
accuracy train: 0.966396 val: 0.787324 test: 0.762802
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({0: 5838, 1: 4824})

Epoch :  30 loss training:  35.63921944051981 Time :  8158
accuracy train: 0.967959 val: 0.783099 test: 0.765053
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({1: 5862, 0: 4800})

Epoch :  31 loss training:  33.628212817013264 Time :  8175
accuracy train: 0.971085 val: 0.785915 test: 0.764209
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({1: 5858, 0: 4804})

Epoch :  32 loss training:  33.18354104459286 Time :  8191
accuracy train: 0.974367 val: 0.788732 test: 0.757738
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({0: 5877, 1: 4785})

Epoch :  33 loss training:  29.949386343359947 Time :  8207
accuracy train: 0.977337 val: 0.778873 test: 0.761958
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({1: 5850, 0: 4812})

Epoch :  34 loss training:  31.851867027580738 Time :  8223
accuracy train: 0.980306 val: 0.785915 test: 0.765053
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({1: 5843, 0: 4819})

Epoch :  35 loss training:  30.730504170060158 Time :  8239
accuracy train: 0.982495 val: 0.780282 test: 0.759989
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({1: 5845, 0: 4817})

Epoch :  36 loss training:  27.71599206700921 Time :  8261
accuracy train: 0.984058 val: 0.778873 test: 0.758019
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({1: 5818, 0: 4844})

Epoch :  37 loss training:  27.11757117137313 Time :  8277
accuracy train: 0.986402 val: 0.785915 test: 0.759145
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({1: 5800, 0: 4862})

Epoch :  38 loss training:  27.147676911205053 Time :  8293
accuracy train: 0.987183 val: 0.783099 test: 0.759145
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({1: 5787, 0: 4875})

Epoch :  39 loss training:  25.457317680120468 Time :  8310
accuracy train: 0.987652 val: 0.780282 test: 0.760551
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({1: 5836, 0: 4826})

Epoch :  40 loss training:  24.269798878580332 Time :  8326
accuracy train: 0.988121 val: 0.783099 test: 0.760551
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({1: 5847, 0: 4815})

Epoch :  41 loss training:  21.767017919570208 Time :  8342
accuracy train: 0.990466 val: 0.776056 test: 0.756331
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({1: 5836, 0: 4826})

Epoch :  42 loss training:  23.24981699883938 Time :  8358
accuracy train: 0.992810 val: 0.783099 test: 0.759707
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({1: 5822, 0: 4840})

Epoch :  43 loss training:  22.241820715367794 Time :  8374
accuracy train: 0.994842 val: 0.783099 test: 0.759707
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({1: 5828, 0: 4834})

Epoch :  44 loss training:  20.926284711807966 Time :  8400
accuracy train: 0.994842 val: 0.783099 test: 0.756050
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({1: 5823, 0: 4839})

Epoch :  45 loss training:  20.386497408151627 Time :  8417
accuracy train: 0.995467 val: 0.785915 test: 0.759426
max validation accuracy : 0.804225 max acc epoch : 14 test accuracy : 0.771244
Counter({1: 5812, 0: 4850})

========================================================================================================================================================================================================
max acc epoch :  14
max validation accuracy :  0.8042253521126761
test accuracy :  0.7712436691052336
last test_accuracy :  0.7594259988745076
========================================================================================================================================================================================================

itr : 9
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=202, weight_decay=1e-08)
device :  cuda:0
Counter({0: 6232, 1: 4430})

Epoch :  1 loss training:  93.44127222895622 Time :  8437
accuracy train: 0.773054 val: 0.740845 test: 0.755768
max validation accuracy : 0.740845 max acc epoch : 1 test accuracy : 0.755768
Counter({1: 5440, 0: 5222})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.37562093138695 Time :  8454
accuracy train: 0.801813 val: 0.763380 test: 0.772088
max validation accuracy : 0.763380 max acc epoch : 2 test accuracy : 0.772088
Counter({0: 5893, 1: 4769})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  78.48574873805046 Time :  8470
accuracy train: 0.809628 val: 0.773239 test: 0.773495
max validation accuracy : 0.773239 max acc epoch : 3 test accuracy : 0.773495
Counter({0: 5337, 1: 5325})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  72.80740815401077 Time :  8485
accuracy train: 0.826821 val: 0.785915 test: 0.775464
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.775464
Counter({0: 5562, 1: 5100})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  70.73837572336197 Time :  8502
accuracy train: 0.832448 val: 0.783099 test: 0.777434
max validation accuracy : 0.785915 max acc epoch : 4 test accuracy : 0.775464
Counter({0: 5546, 1: 5116})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.75325782597065 Time :  8529
accuracy train: 0.840575 val: 0.788732 test: 0.768430
max validation accuracy : 0.788732 max acc epoch : 6 test accuracy : 0.768430
Counter({0: 5589, 1: 5073})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  65.67827209830284 Time :  8546
accuracy train: 0.852298 val: 0.794366 test: 0.764209
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.764209
Counter({0: 5637, 1: 5025})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.26495867967606 Time :  8563
accuracy train: 0.863864 val: 0.791549 test: 0.764772
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.764209
Counter({0: 5596, 1: 5066})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.590316981077194 Time :  8578
accuracy train: 0.868709 val: 0.784507 test: 0.767586
max validation accuracy : 0.794366 max acc epoch : 7 test accuracy : 0.764209
Counter({0: 5563, 1: 5099})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.63220824301243 Time :  8596
accuracy train: 0.875430 val: 0.800000 test: 0.769555
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({0: 5581, 1: 5081})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.37404407560825 Time :  8612
accuracy train: 0.884026 val: 0.794366 test: 0.763365
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({0: 5591, 1: 5071})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.013730347156525 Time :  8628
accuracy train: 0.889653 val: 0.795775 test: 0.770118
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({0: 5599, 1: 5063})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.137334406375885 Time :  8648
accuracy train: 0.884964 val: 0.794366 test: 0.766742
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({0: 5593, 1: 5069})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.43656912446022 Time :  8664
accuracy train: 0.893717 val: 0.788732 test: 0.765335
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({0: 5593, 1: 5069})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.799386098980904 Time :  8680
accuracy train: 0.895749 val: 0.788732 test: 0.769274
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({0: 5610, 1: 5052})

Epoch :  16 loss training:  56.2568079829216 Time :  8697
accuracy train: 0.902157 val: 0.787324 test: 0.765898
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({0: 5611, 1: 5051})

Epoch :  17 loss training:  54.8263780772686 Time :  8712
accuracy train: 0.906690 val: 0.785915 test: 0.768711
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({0: 5602, 1: 5060})

Epoch :  18 loss training:  51.94952407479286 Time :  8727
accuracy train: 0.912629 val: 0.784507 test: 0.767586
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({0: 5625, 1: 5037})

Epoch :  19 loss training:  50.96126811951399 Time :  8742
accuracy train: 0.918256 val: 0.781690 test: 0.770400
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({0: 5631, 1: 5031})

Epoch :  20 loss training:  49.7610604763031 Time :  8762
accuracy train: 0.921851 val: 0.785915 test: 0.759989
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({0: 5646, 1: 5016})

Epoch :  21 loss training:  47.88383726775646 Time :  8782
accuracy train: 0.928103 val: 0.791549 test: 0.760833
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({0: 5656, 1: 5006})

Epoch :  22 loss training:  46.13934192061424 Time :  8798
accuracy train: 0.934198 val: 0.788732 test: 0.766179
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({0: 5649, 1: 5013})

Epoch :  23 loss training:  45.35896301269531 Time :  8814
accuracy train: 0.937637 val: 0.790141 test: 0.761958
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({0: 5665, 1: 4997})

Epoch :  24 loss training:  44.045093052089214 Time :  8830
accuracy train: 0.944358 val: 0.790141 test: 0.764209
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({0: 5669, 1: 4993})

Epoch :  25 loss training:  41.61614878475666 Time :  8846
accuracy train: 0.950922 val: 0.798592 test: 0.763365
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({1: 5698, 0: 4964})

Epoch :  26 loss training:  39.34552163630724 Time :  8863
accuracy train: 0.956705 val: 0.797183 test: 0.763647
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({1: 5733, 0: 4929})

Epoch :  27 loss training:  39.35442728549242 Time :  8880
accuracy train: 0.959987 val: 0.788732 test: 0.765616
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({0: 5739, 1: 4923})

Epoch :  28 loss training:  38.542988903820515 Time :  8909
accuracy train: 0.964051 val: 0.791549 test: 0.766742
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({1: 5759, 0: 4903})

Epoch :  29 loss training:  36.1905682682991 Time :  8927
accuracy train: 0.969365 val: 0.785915 test: 0.765616
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({0: 5765, 1: 4897})

Epoch :  30 loss training:  34.818791814148426 Time :  8945
accuracy train: 0.970616 val: 0.788732 test: 0.763365
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({1: 5808, 0: 4854})

Epoch :  31 loss training:  33.27877430617809 Time :  8962
accuracy train: 0.971866 val: 0.797183 test: 0.772369
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({1: 5851, 0: 4811})

Epoch :  32 loss training:  31.377394638955593 Time :  8980
accuracy train: 0.974523 val: 0.778873 test: 0.758301
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({1: 5847, 0: 4815})

Epoch :  33 loss training:  28.7461547665298 Time :  8995
accuracy train: 0.979681 val: 0.795775 test: 0.762802
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({0: 5894, 1: 4768})

Epoch :  34 loss training:  29.845188707113266 Time :  9012
accuracy train: 0.982026 val: 0.791549 test: 0.763928
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({0: 5895, 1: 4767})

Epoch :  35 loss training:  28.896966621279716 Time :  9031
accuracy train: 0.982182 val: 0.790141 test: 0.765053
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({0: 5897, 1: 4765})

Epoch :  36 loss training:  25.902384862303734 Time :  9049
accuracy train: 0.985152 val: 0.784507 test: 0.761114
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({0: 5909, 1: 4753})

Epoch :  37 loss training:  26.071426022797823 Time :  9064
accuracy train: 0.987496 val: 0.792958 test: 0.759707
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({0: 5939, 1: 4723})

Epoch :  38 loss training:  24.94851789623499 Time :  9080
accuracy train: 0.988746 val: 0.788732 test: 0.762802
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({0: 5959, 1: 4703})

Epoch :  39 loss training:  23.396969128400087 Time :  9095
accuracy train: 0.990309 val: 0.798592 test: 0.762802
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({0: 6002, 1: 4660})

Epoch :  40 loss training:  21.91329950466752 Time :  9111
accuracy train: 0.991091 val: 0.790141 test: 0.760833
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({0: 5996, 1: 4666})

Epoch :  41 loss training:  19.675513356924057 Time :  9127
accuracy train: 0.992654 val: 0.787324 test: 0.759989
max validation accuracy : 0.800000 max acc epoch : 10 test accuracy : 0.769555
Counter({0: 6018, 1: 4644})

========================================================================================================================================================================================================
max acc epoch :  10
max validation accuracy :  0.8
test accuracy :  0.7695554305008441
last test_accuracy :  0.7599887450759707
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.79155 	 test_accuracy : 0.76337 	 max_acc epoch :  12 	 last test_accuracy : 0.76224
k :  1 	 val_accuracy : 0.80282 	 test_accuracy : 0.77209 	 max_acc epoch :  7 	 last test_accuracy : 0.76252
k :  2 	 val_accuracy : 0.79155 	 test_accuracy : 0.75914 	 max_acc epoch :  24 	 last test_accuracy : 0.75155
k :  3 	 val_accuracy : 0.79437 	 test_accuracy : 0.76730 	 max_acc epoch :  7 	 last test_accuracy : 0.76505
k :  4 	 val_accuracy : 0.80423 	 test_accuracy : 0.76590 	 max_acc epoch :  11 	 last test_accuracy : 0.75521
k :  5 	 val_accuracy : 0.79155 	 test_accuracy : 0.77012 	 max_acc epoch :  5 	 last test_accuracy : 0.76083
k :  6 	 val_accuracy : 0.79296 	 test_accuracy : 0.76815 	 max_acc epoch :  18 	 last test_accuracy : 0.76759
k :  7 	 val_accuracy : 0.79577 	 test_accuracy : 0.76111 	 max_acc epoch :  33 	 last test_accuracy : 0.75577
k :  8 	 val_accuracy : 0.80423 	 test_accuracy : 0.77124 	 max_acc epoch :  14 	 last test_accuracy : 0.75943
k :  9 	 val_accuracy : 0.80000 	 test_accuracy : 0.76956 	 max_acc epoch :  10 	 last test_accuracy : 0.75999

avg :  	 val_accuracy : 0.79690 	 test_accuracy : 0.76680 	 last_accuracy : 0.76002


date and time :  Thu Jun  3 23:49:36 2021
itr : 0
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=250, weight_decay=1e-08)
device :  cuda:0
Counter({2: 5136, 1: 3280, 0: 2246})

Epoch :  1 loss training:  91.60548600554466 Time :  21
accuracy train: 0.781963 val: 0.763380 test: 0.768711
max validation accuracy : 0.763380 max acc epoch : 1 test accuracy : 0.768711
Counter({2: 4265, 1: 3454, 0: 2943})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.01470360159874 Time :  40
accuracy train: 0.787434 val: 0.763380 test: 0.767023
max validation accuracy : 0.763380 max acc epoch : 1 test accuracy : 0.768711
Counter({0: 4241, 2: 3424, 1: 2997})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.21063095331192 Time :  57
accuracy train: 0.810722 val: 0.785915 test: 0.772088
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({1: 4538, 2: 3229, 0: 2895})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.93685740232468 Time :  78
accuracy train: 0.823695 val: 0.771831 test: 0.777434
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({0: 4626, 2: 3219, 1: 2817})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.82036083936691 Time :  97
accuracy train: 0.832448 val: 0.773239 test: 0.773776
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({2: 4895, 0: 3034, 1: 2733})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.33098091185093 Time :  115
accuracy train: 0.850109 val: 0.769014 test: 0.782780
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({2: 4637, 1: 3254, 0: 2771})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.52436922490597 Time :  134
accuracy train: 0.851360 val: 0.764789 test: 0.779403
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({0: 4710, 2: 3161, 1: 2791})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.13196043670177 Time :  168
accuracy train: 0.857768 val: 0.773239 test: 0.777715
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({0: 4674, 1: 3202, 2: 2786})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.786309361457825 Time :  186
accuracy train: 0.867146 val: 0.759155 test: 0.778841
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({0: 4657, 1: 3224, 2: 2781})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.14951354265213 Time :  204
accuracy train: 0.879806 val: 0.764789 test: 0.779685
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({2: 4643, 0: 3244, 1: 2775})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.072572126984596 Time :  221
accuracy train: 0.878712 val: 0.763380 test: 0.777715
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({2: 4664, 1: 3222, 0: 2776})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.12449707090855 Time :  238
accuracy train: 0.886996 val: 0.771831 test: 0.775746
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({1: 4726, 0: 3150, 2: 2786})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.36906333267689 Time :  257
accuracy train: 0.889653 val: 0.770423 test: 0.774057
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({1: 4692, 2: 3197, 0: 2773})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.61202861368656 Time :  276
accuracy train: 0.892779 val: 0.761972 test: 0.774057
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({2: 4669, 1: 3224, 0: 2769})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  55.266273483633995 Time :  310
accuracy train: 0.892779 val: 0.756338 test: 0.774620
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({0: 4675, 2: 3235, 1: 2752})

Epoch :  16 loss training:  54.207076609134674 Time :  329
accuracy train: 0.905752 val: 0.778873 test: 0.775464
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({0: 4680, 1: 3224, 2: 2758})

Epoch :  17 loss training:  54.231143817305565 Time :  347
accuracy train: 0.907315 val: 0.774648 test: 0.774057
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({1: 4664, 0: 3217, 2: 2781})

Epoch :  18 loss training:  52.85608130693436 Time :  366
accuracy train: 0.913410 val: 0.780282 test: 0.775746
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({1: 4682, 0: 3205, 2: 2775})

Epoch :  19 loss training:  49.641366228461266 Time :  386
accuracy train: 0.921851 val: 0.776056 test: 0.775746
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({1: 4658, 0: 3245, 2: 2759})

Epoch :  20 loss training:  49.62469916790724 Time :  404
accuracy train: 0.926540 val: 0.773239 test: 0.776308
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({1: 4659, 0: 3238, 2: 2765})

Epoch :  21 loss training:  47.29632844030857 Time :  422
accuracy train: 0.930134 val: 0.769014 test: 0.773495
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({0: 4618, 2: 3275, 1: 2769})

Epoch :  22 loss training:  46.61418543756008 Time :  453
accuracy train: 0.936543 val: 0.773239 test: 0.772932
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({2: 4699, 0: 3188, 1: 2775})

Epoch :  23 loss training:  44.39202044159174 Time :  472
accuracy train: 0.939981 val: 0.770423 test: 0.772369
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({1: 4666, 0: 3218, 2: 2778})

Epoch :  24 loss training:  43.52758653461933 Time :  491
accuracy train: 0.946233 val: 0.769014 test: 0.772651
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({1: 4686, 2: 3184, 0: 2792})

Epoch :  25 loss training:  42.40925033390522 Time :  512
accuracy train: 0.951704 val: 0.770423 test: 0.767023
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({1: 4660, 2: 3214, 0: 2788})

Epoch :  26 loss training:  39.17535142600536 Time :  530
accuracy train: 0.954517 val: 0.761972 test: 0.765335
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({1: 4636, 2: 3228, 0: 2798})

Epoch :  27 loss training:  38.251489862799644 Time :  548
accuracy train: 0.959519 val: 0.757746 test: 0.764491
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({0: 4615, 1: 3254, 2: 2793})

Epoch :  28 loss training:  37.21520910412073 Time :  568
accuracy train: 0.962488 val: 0.763380 test: 0.766460
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({1: 4597, 2: 3282, 0: 2783})

Epoch :  29 loss training:  34.562030509114265 Time :  602
accuracy train: 0.966396 val: 0.764789 test: 0.768149
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({1: 4572, 0: 3307, 2: 2783})

Epoch :  30 loss training:  34.01652483642101 Time :  622
accuracy train: 0.971241 val: 0.763380 test: 0.763647
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({1: 4524, 2: 3368, 0: 2770})

Epoch :  31 loss training:  32.60687217861414 Time :  641
accuracy train: 0.973585 val: 0.761972 test: 0.764772
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({0: 4504, 2: 3358, 1: 2800})

Epoch :  32 loss training:  31.374235711991787 Time :  661
accuracy train: 0.976711 val: 0.764789 test: 0.762240
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({0: 4469, 2: 3387, 1: 2806})

Epoch :  33 loss training:  29.94945825636387 Time :  681
accuracy train: 0.978900 val: 0.754930 test: 0.763928
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({1: 4475, 0: 3377, 2: 2810})

Epoch :  34 loss training:  28.745460335165262 Time :  701
accuracy train: 0.982963 val: 0.761972 test: 0.759426
max validation accuracy : 0.785915 max acc epoch : 3 test accuracy : 0.772088
Counter({2: 4435, 1: 3430, 0: 2797})

========================================================================================================================================================================================================
max acc epoch :  3
max validation accuracy :  0.7859154929577464
test accuracy :  0.7720877884074282
last test_accuracy :  0.7594259988745076
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=250, weight_decay=1e-08)
device :  cuda:0
Counter({2: 5136, 1: 3280, 0: 2246})

Epoch :  1 loss training:  91.59589639306068 Time :  729
accuracy train: 0.784308 val: 0.764789 test: 0.768711
max validation accuracy : 0.764789 max acc epoch : 1 test accuracy : 0.768711
Counter({2: 4202, 0: 3609, 1: 2851})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.12480032444 Time :  751
accuracy train: 0.789309 val: 0.761972 test: 0.763647
max validation accuracy : 0.764789 max acc epoch : 1 test accuracy : 0.768711
Counter({0: 4070, 2: 3607, 1: 2985})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.57286313176155 Time :  771
accuracy train: 0.809472 val: 0.770423 test: 0.775464
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.775464
Counter({2: 4498, 1: 3096, 0: 3068})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.56142930686474 Time :  790
accuracy train: 0.826352 val: 0.778873 test: 0.776871
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({0: 4597, 1: 3069, 2: 2996})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.11364486813545 Time :  810
accuracy train: 0.831510 val: 0.777465 test: 0.772369
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({1: 4732, 2: 2966, 0: 2964})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.49759700894356 Time :  829
accuracy train: 0.853704 val: 0.767606 test: 0.779685
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({0: 4682, 2: 3048, 1: 2932})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  65.41389046609402 Time :  848
accuracy train: 0.857612 val: 0.752113 test: 0.775746
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({2: 4701, 1: 3028, 0: 2933})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  63.691064819693565 Time :  873
accuracy train: 0.866052 val: 0.756338 test: 0.774902
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({2: 4724, 0: 2997, 1: 2941})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.101143062114716 Time :  890
accuracy train: 0.873242 val: 0.756338 test: 0.779122
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({1: 4750, 0: 2969, 2: 2943})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  58.561640322208405 Time :  909
accuracy train: 0.883401 val: 0.756338 test: 0.776871
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({2: 4768, 1: 2977, 0: 2917})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.69561117887497 Time :  930
accuracy train: 0.887621 val: 0.761972 test: 0.776871
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({2: 4756, 1: 2978, 0: 2928})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  57.67034675180912 Time :  949
accuracy train: 0.891372 val: 0.750704 test: 0.768149
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({1: 4739, 2: 3005, 0: 2918})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  55.61198940873146 Time :  966
accuracy train: 0.895905 val: 0.753521 test: 0.770962
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({0: 4741, 2: 2988, 1: 2933})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  55.936152532696724 Time :  985
accuracy train: 0.899500 val: 0.754930 test: 0.769837
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({1: 4709, 0: 3004, 2: 2949})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  53.33034361898899 Time :  1008
accuracy train: 0.900125 val: 0.747887 test: 0.771244
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({1: 4732, 0: 2989, 2: 2941})

Epoch :  16 loss training:  52.90666554868221 Time :  1030
accuracy train: 0.905439 val: 0.745070 test: 0.765898
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({2: 4741, 0: 2996, 1: 2925})

Epoch :  17 loss training:  52.640110552310944 Time :  1050
accuracy train: 0.912473 val: 0.760563 test: 0.770962
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({1: 4749, 0: 2990, 2: 2923})

Epoch :  18 loss training:  50.943791300058365 Time :  1071
accuracy train: 0.918256 val: 0.759155 test: 0.767867
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({0: 4731, 2: 2990, 1: 2941})

Epoch :  19 loss training:  48.18200458586216 Time :  1091
accuracy train: 0.923257 val: 0.750704 test: 0.767867
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({1: 4734, 0: 2990, 2: 2938})

Epoch :  20 loss training:  47.51196304708719 Time :  1109
accuracy train: 0.929666 val: 0.753521 test: 0.769837
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({1: 4736, 2: 2998, 0: 2928})

Epoch :  21 loss training:  46.12652279436588 Time :  1129
accuracy train: 0.934042 val: 0.757746 test: 0.764209
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({2: 4753, 1: 2988, 0: 2921})

Epoch :  22 loss training:  45.14327538013458 Time :  1154
accuracy train: 0.938106 val: 0.757746 test: 0.764491
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({2: 4754, 1: 3005, 0: 2903})

Epoch :  23 loss training:  42.20180892199278 Time :  1174
accuracy train: 0.943420 val: 0.754930 test: 0.763084
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({1: 4745, 0: 2980, 2: 2937})

Epoch :  24 loss training:  42.05712058395147 Time :  1193
accuracy train: 0.948109 val: 0.759155 test: 0.762240
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({2: 4763, 1: 2991, 0: 2908})

Epoch :  25 loss training:  41.3181124702096 Time :  1212
accuracy train: 0.952641 val: 0.766197 test: 0.765335
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({0: 4776, 1: 2983, 2: 2903})

Epoch :  26 loss training:  37.56289368867874 Time :  1230
accuracy train: 0.956080 val: 0.764789 test: 0.766742
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({0: 4780, 2: 2983, 1: 2899})

Epoch :  27 loss training:  37.29887663573027 Time :  1249
accuracy train: 0.960144 val: 0.760563 test: 0.761677
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({2: 4754, 1: 2995, 0: 2913})

Epoch :  28 loss training:  35.15303876250982 Time :  1268
accuracy train: 0.965927 val: 0.757746 test: 0.760833
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({0: 4749, 2: 2975, 1: 2938})

Epoch :  29 loss training:  33.29642304778099 Time :  1297
accuracy train: 0.969365 val: 0.761972 test: 0.761114
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({2: 4724, 0: 2992, 1: 2946})

Epoch :  30 loss training:  33.51612461358309 Time :  1317
accuracy train: 0.973273 val: 0.759155 test: 0.759145
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({0: 4751, 2: 2964, 1: 2947})

Epoch :  31 loss training:  32.174093931913376 Time :  1333
accuracy train: 0.974523 val: 0.761972 test: 0.757175
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({0: 4737, 2: 2985, 1: 2940})

Epoch :  32 loss training:  30.540117293596268 Time :  1352
accuracy train: 0.974680 val: 0.752113 test: 0.756894
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({0: 4707, 2: 2991, 1: 2964})

Epoch :  33 loss training:  28.95784179866314 Time :  1372
accuracy train: 0.979056 val: 0.759155 test: 0.757175
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({0: 4683, 2: 3029, 1: 2950})

Epoch :  34 loss training:  27.674934286624193 Time :  1392
accuracy train: 0.982495 val: 0.753521 test: 0.760833
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({2: 4677, 0: 3006, 1: 2979})

Epoch :  35 loss training:  27.16568873077631 Time :  1413
accuracy train: 0.984683 val: 0.753521 test: 0.757175
max validation accuracy : 0.778873 max acc epoch : 4 test accuracy : 0.776871
Counter({2: 4686, 1: 3014, 0: 2962})

========================================================================================================================================================================================================
max acc epoch :  4
max validation accuracy :  0.7788732394366197
test accuracy :  0.7768711311198649
last test_accuracy :  0.7571750140686551
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=250, weight_decay=1e-08)
device :  cuda:0
Counter({2: 5136, 1: 3280, 0: 2246})

Epoch :  1 loss training:  91.63032510876656 Time :  1453
accuracy train: 0.779775 val: 0.760563 test: 0.767867
max validation accuracy : 0.760563 max acc epoch : 1 test accuracy : 0.767867
Counter({1: 4310, 2: 3650, 0: 2702})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.05772164463997 Time :  1470
accuracy train: 0.787590 val: 0.761972 test: 0.766179
max validation accuracy : 0.761972 max acc epoch : 2 test accuracy : 0.766179
Counter({0: 3998, 2: 3779, 1: 2885})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.04365304112434 Time :  1490
accuracy train: 0.807127 val: 0.773239 test: 0.771525
max validation accuracy : 0.773239 max acc epoch : 3 test accuracy : 0.771525
Counter({0: 4260, 1: 3269, 2: 3133})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.70875705778599 Time :  1509
accuracy train: 0.825258 val: 0.781690 test: 0.779966
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({1: 4646, 0: 3092, 2: 2924})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.21064159274101 Time :  1527
accuracy train: 0.832135 val: 0.777465 test: 0.780529
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({2: 4849, 1: 3008, 0: 2805})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.26486502587795 Time :  1546
accuracy train: 0.846515 val: 0.774648 test: 0.783061
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({2: 4885, 0: 2956, 1: 2821})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.42087605595589 Time :  1565
accuracy train: 0.854798 val: 0.766197 test: 0.785031
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({0: 4767, 2: 2956, 1: 2939})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.07042275369167 Time :  1598
accuracy train: 0.863707 val: 0.773239 test: 0.783624
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({2: 4712, 1: 2994, 0: 2956})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.59324653446674 Time :  1616
accuracy train: 0.874023 val: 0.767606 test: 0.782217
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({2: 4829, 1: 2927, 0: 2906})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.176499247550964 Time :  1635
accuracy train: 0.882932 val: 0.773239 test: 0.779966
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({0: 4866, 1: 2932, 2: 2864})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.29064713418484 Time :  1654
accuracy train: 0.883870 val: 0.763380 test: 0.783343
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({2: 4901, 0: 2913, 1: 2848})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.80189859867096 Time :  1672
accuracy train: 0.886371 val: 0.770423 test: 0.776871
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({2: 4900, 1: 2886, 0: 2876})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.64500418305397 Time :  1693
accuracy train: 0.893404 val: 0.777465 test: 0.777715
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({0: 4893, 2: 2895, 1: 2874})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  58.38484661281109 Time :  1712
accuracy train: 0.894967 val: 0.771831 test: 0.774902
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({1: 4857, 0: 2917, 2: 2888})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.23808562755585 Time :  1742
accuracy train: 0.893404 val: 0.773239 test: 0.772088
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({1: 4871, 2: 2914, 0: 2877})

Epoch :  16 loss training:  54.80198024213314 Time :  1761
accuracy train: 0.902313 val: 0.773239 test: 0.776871
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({0: 4889, 1: 2894, 2: 2879})

Epoch :  17 loss training:  55.367911487817764 Time :  1777
accuracy train: 0.907627 val: 0.771831 test: 0.775746
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({1: 4909, 2: 2883, 0: 2870})

Epoch :  18 loss training:  53.4507092833519 Time :  1793
accuracy train: 0.912004 val: 0.773239 test: 0.774902
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({0: 4942, 2: 2881, 1: 2839})

Epoch :  19 loss training:  50.52411922812462 Time :  1809
accuracy train: 0.918099 val: 0.769014 test: 0.776590
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({1: 4930, 0: 2873, 2: 2859})

Epoch :  20 loss training:  50.43037448078394 Time :  1826
accuracy train: 0.922788 val: 0.771831 test: 0.775746
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({1: 4928, 2: 2877, 0: 2857})

Epoch :  21 loss training:  48.4453252106905 Time :  1841
accuracy train: 0.929978 val: 0.774648 test: 0.776027
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({2: 4961, 1: 2878, 0: 2823})

Epoch :  22 loss training:  47.59086173027754 Time :  1861
accuracy train: 0.934667 val: 0.767606 test: 0.772651
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({2: 4988, 1: 2888, 0: 2786})

Epoch :  23 loss training:  44.321786627173424 Time :  1877
accuracy train: 0.942482 val: 0.776056 test: 0.774902
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({1: 4959, 0: 2892, 2: 2811})

Epoch :  24 loss training:  44.09411335736513 Time :  1894
accuracy train: 0.947327 val: 0.780282 test: 0.772369
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({1: 4948, 2: 2918, 0: 2796})

Epoch :  25 loss training:  42.53158348798752 Time :  1911
accuracy train: 0.952329 val: 0.764789 test: 0.772088
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({2: 4977, 0: 2929, 1: 2756})

Epoch :  26 loss training:  39.58476933836937 Time :  1927
accuracy train: 0.957174 val: 0.780282 test: 0.776308
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({0: 4947, 2: 2955, 1: 2760})

Epoch :  27 loss training:  39.06727699935436 Time :  1942
accuracy train: 0.962488 val: 0.774648 test: 0.772932
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({1: 4940, 2: 2968, 0: 2754})

Epoch :  28 loss training:  36.77564114332199 Time :  1959
accuracy train: 0.965458 val: 0.777465 test: 0.770962
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({2: 4935, 1: 2982, 0: 2745})

Epoch :  29 loss training:  35.144066512584686 Time :  1979
accuracy train: 0.970460 val: 0.778873 test: 0.771806
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({0: 4919, 1: 2978, 2: 2765})

Epoch :  30 loss training:  34.81359653919935 Time :  1995
accuracy train: 0.973117 val: 0.773239 test: 0.770681
max validation accuracy : 0.781690 max acc epoch : 4 test accuracy : 0.779966
Counter({0: 4906, 2: 2977, 1: 2779})

Epoch :  31 loss training:  33.25554706528783 Time :  2011
accuracy train: 0.973273 val: 0.783099 test: 0.768149
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({0: 4895, 1: 2996, 2: 2771})

Epoch :  32 loss training:  31.605368360877037 Time :  2027
accuracy train: 0.976243 val: 0.773239 test: 0.771806
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({2: 4845, 0: 3010, 1: 2807})

Epoch :  33 loss training:  30.587548606097698 Time :  2044
accuracy train: 0.980775 val: 0.776056 test: 0.771244
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({0: 4809, 2: 3014, 1: 2839})

Epoch :  34 loss training:  29.447766941040754 Time :  2060
accuracy train: 0.983120 val: 0.769014 test: 0.769274
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({1: 4762, 2: 3026, 0: 2874})

Epoch :  35 loss training:  28.155218057334423 Time :  2075
accuracy train: 0.985464 val: 0.773239 test: 0.768711
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({2: 4745, 0: 3033, 1: 2884})

Epoch :  36 loss training:  27.322994962334633 Time :  2094
accuracy train: 0.987340 val: 0.780282 test: 0.771525
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({1: 4693, 2: 3041, 0: 2928})

Epoch :  37 loss training:  26.3193595148623 Time :  2110
accuracy train: 0.989059 val: 0.767606 test: 0.769555
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({0: 4675, 1: 3060, 2: 2927})

Epoch :  38 loss training:  23.82831260934472 Time :  2127
accuracy train: 0.990622 val: 0.767606 test: 0.769555
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({1: 4638, 0: 3054, 2: 2970})

Epoch :  39 loss training:  23.756468607112765 Time :  2144
accuracy train: 0.992029 val: 0.769014 test: 0.769555
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({2: 4624, 0: 3060, 1: 2978})

Epoch :  40 loss training:  22.566067293286324 Time :  2161
accuracy train: 0.992810 val: 0.767606 test: 0.766742
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({0: 4625, 1: 3074, 2: 2963})

Epoch :  41 loss training:  21.99306880682707 Time :  2177
accuracy train: 0.993748 val: 0.770423 test: 0.767586
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({2: 4570, 0: 3072, 1: 3020})

Epoch :  42 loss training:  21.163468196988106 Time :  2193
accuracy train: 0.994530 val: 0.766197 test: 0.764491
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({1: 4567, 2: 3067, 0: 3028})

Epoch :  43 loss training:  20.000239588320255 Time :  2220
accuracy train: 0.995780 val: 0.766197 test: 0.769274
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({1: 4532, 0: 3087, 2: 3043})

Epoch :  44 loss training:  18.19715061597526 Time :  2238
accuracy train: 0.995936 val: 0.766197 test: 0.763928
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({1: 4512, 0: 3087, 2: 3063})

Epoch :  45 loss training:  18.44782149977982 Time :  2254
accuracy train: 0.997656 val: 0.763380 test: 0.770118
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({1: 4499, 2: 3083, 0: 3080})

Epoch :  46 loss training:  18.002086816355586 Time :  2269
accuracy train: 0.998124 val: 0.761972 test: 0.768430
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({0: 4455, 1: 3118, 2: 3089})

Epoch :  47 loss training:  17.09295862354338 Time :  2286
accuracy train: 0.997968 val: 0.764789 test: 0.767867
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({2: 4434, 1: 3133, 0: 3095})

Epoch :  48 loss training:  16.575034065172076 Time :  2302
accuracy train: 0.997968 val: 0.760563 test: 0.766179
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({0: 4421, 1: 3136, 2: 3105})

Epoch :  49 loss training:  16.467497643083334 Time :  2319
accuracy train: 0.998593 val: 0.760563 test: 0.767023
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({0: 4406, 1: 3144, 2: 3112})

Epoch :  50 loss training:  15.072211011312902 Time :  2342
accuracy train: 0.998906 val: 0.753521 test: 0.766460
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({0: 4400, 2: 3146, 1: 3116})

Epoch :  51 loss training:  14.71904797386378 Time :  2360
accuracy train: 0.999219 val: 0.763380 test: 0.763928
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({1: 4375, 0: 3166, 2: 3121})

Epoch :  52 loss training:  13.892536267638206 Time :  2376
accuracy train: 0.998750 val: 0.767606 test: 0.764491
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({0: 4360, 1: 3183, 2: 3119})

Epoch :  53 loss training:  12.591749145649374 Time :  2393
accuracy train: 0.998906 val: 0.757746 test: 0.763647
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({2: 4321, 1: 3208, 0: 3133})

Epoch :  54 loss training:  12.431515982374549 Time :  2407
accuracy train: 0.999375 val: 0.766197 test: 0.766460
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({2: 4320, 1: 3215, 0: 3127})

Epoch :  55 loss training:  11.168354885652661 Time :  2423
accuracy train: 0.999531 val: 0.763380 test: 0.767867
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({0: 4289, 1: 3242, 2: 3131})

Epoch :  56 loss training:  12.088921964168549 Time :  2438
accuracy train: 0.999531 val: 0.763380 test: 0.767586
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({1: 4263, 2: 3273, 0: 3126})

Epoch :  57 loss training:  10.901390776969492 Time :  2456
accuracy train: 0.999687 val: 0.761972 test: 0.768149
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({1: 4235, 2: 3289, 0: 3138})

Epoch :  58 loss training:  10.625892938114703 Time :  2474
accuracy train: 0.999687 val: 0.753521 test: 0.763084
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({1: 4209, 2: 3311, 0: 3142})

Epoch :  59 loss training:  10.008203137200326 Time :  2490
accuracy train: 0.999687 val: 0.759155 test: 0.766460
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({1: 4223, 2: 3306, 0: 3133})

Epoch :  60 loss training:  9.641201945953071 Time :  2505
accuracy train: 0.999844 val: 0.761972 test: 0.763365
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({2: 4202, 0: 3320, 1: 3140})

Epoch :  61 loss training:  8.159870351664722 Time :  2521
accuracy train: 0.999844 val: 0.761972 test: 0.765898
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({2: 4181, 1: 3337, 0: 3144})

Epoch :  62 loss training:  8.621313680894673 Time :  2538
accuracy train: 0.999531 val: 0.757746 test: 0.760551
max validation accuracy : 0.783099 max acc epoch : 31 test accuracy : 0.768149
Counter({2: 4124, 0: 3383, 1: 3155})

========================================================================================================================================================================================================
max acc epoch :  31
max validation accuracy :  0.7830985915492957
test accuracy :  0.7681485649971863
last test_accuracy :  0.7605514912774338
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=250, weight_decay=1e-08)
device :  cuda:0
Counter({2: 5136, 1: 3280, 0: 2246})

Epoch :  1 loss training:  91.53089091181755 Time :  2559
accuracy train: 0.781338 val: 0.760563 test: 0.768993
max validation accuracy : 0.760563 max acc epoch : 1 test accuracy : 0.768993
Counter({2: 4160, 1: 3476, 0: 3026})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.40012302994728 Time :  2581
accuracy train: 0.788059 val: 0.756338 test: 0.763647
max validation accuracy : 0.760563 max acc epoch : 1 test accuracy : 0.768993
Counter({1: 4103, 0: 3817, 2: 2742})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.53420588374138 Time :  2597
accuracy train: 0.813535 val: 0.770423 test: 0.779122
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.779122
Counter({2: 4509, 0: 3466, 1: 2687})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.33525091409683 Time :  2612
accuracy train: 0.827602 val: 0.770423 test: 0.781936
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.779122
Counter({0: 4638, 2: 3375, 1: 2649})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.0291708856821 Time :  2630
accuracy train: 0.834167 val: 0.770423 test: 0.771244
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.779122
Counter({2: 4660, 0: 3349, 1: 2653})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.40587477385998 Time :  2646
accuracy train: 0.857768 val: 0.769014 test: 0.783343
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.779122
Counter({2: 4812, 0: 3334, 1: 2516})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  65.84215497970581 Time :  2665
accuracy train: 0.856049 val: 0.769014 test: 0.777434
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.779122
Counter({1: 4821, 0: 3343, 2: 2498})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.0267720669508 Time :  2679
accuracy train: 0.865427 val: 0.753521 test: 0.776590
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.779122
Counter({0: 4868, 1: 3342, 2: 2452})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.05850827693939 Time :  2703
accuracy train: 0.875430 val: 0.764789 test: 0.771244
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.779122
Counter({0: 4894, 1: 3356, 2: 2412})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  58.601021975278854 Time :  2718
accuracy train: 0.885433 val: 0.764789 test: 0.771525
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.779122
Counter({2: 4924, 1: 3335, 0: 2403})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.70216158032417 Time :  2733
accuracy train: 0.886996 val: 0.761972 test: 0.768993
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.779122
Counter({1: 5003, 0: 3290, 2: 2369})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  57.117498472332954 Time :  2749
accuracy train: 0.891529 val: 0.767606 test: 0.766179
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.779122
Counter({1: 5014, 0: 3303, 2: 2345})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  55.336383894085884 Time :  2765
accuracy train: 0.894967 val: 0.769014 test: 0.768711
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.779122
Counter({1: 5028, 0: 3301, 2: 2333})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.567250803112984 Time :  2780
accuracy train: 0.894967 val: 0.764789 test: 0.766460
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.779122
Counter({0: 5043, 2: 3303, 1: 2316})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  54.10122947394848 Time :  2796
accuracy train: 0.897781 val: 0.763380 test: 0.765898
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.779122
Counter({0: 5023, 2: 3307, 1: 2332})

Epoch :  16 loss training:  53.05409672856331 Time :  2815
accuracy train: 0.909034 val: 0.753521 test: 0.765335
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.779122
Counter({0: 5034, 2: 3304, 1: 2324})

Epoch :  17 loss training:  53.00756211578846 Time :  2831
accuracy train: 0.912942 val: 0.766197 test: 0.769274
max validation accuracy : 0.770423 max acc epoch : 3 test accuracy : 0.779122
Counter({2: 5018, 0: 3322, 1: 2322})

Epoch :  18 loss training:  51.27168744802475 Time :  2846
accuracy train: 0.917162 val: 0.774648 test: 0.762521
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({1: 5020, 2: 3320, 0: 2322})

Epoch :  19 loss training:  48.85430644452572 Time :  2863
accuracy train: 0.924195 val: 0.766197 test: 0.765898
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({1: 5007, 2: 3346, 0: 2309})

Epoch :  20 loss training:  48.49508621543646 Time :  2879
accuracy train: 0.930447 val: 0.764789 test: 0.766179
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({0: 4993, 2: 3357, 1: 2312})

Epoch :  21 loss training:  47.07291577756405 Time :  2894
accuracy train: 0.933104 val: 0.757746 test: 0.763084
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({2: 4984, 0: 3380, 1: 2298})

Epoch :  22 loss training:  45.87302955240011 Time :  2910
accuracy train: 0.939043 val: 0.764789 test: 0.765335
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({0: 4991, 2: 3396, 1: 2275})

Epoch :  23 loss training:  43.42386558651924 Time :  2928
accuracy train: 0.943107 val: 0.756338 test: 0.761958
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({0: 5000, 1: 3378, 2: 2284})

Epoch :  24 loss training:  42.36509346961975 Time :  2943
accuracy train: 0.947640 val: 0.761972 test: 0.760551
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({1: 4989, 2: 3394, 0: 2279})

Epoch :  25 loss training:  41.70802965015173 Time :  2956
accuracy train: 0.954517 val: 0.752113 test: 0.761677
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({1: 4971, 2: 3415, 0: 2276})

Epoch :  26 loss training:  38.95929742604494 Time :  2973
accuracy train: 0.958112 val: 0.761972 test: 0.761114
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({1: 4947, 0: 3433, 2: 2282})

Epoch :  27 loss training:  37.41223154962063 Time :  2989
accuracy train: 0.962019 val: 0.759155 test: 0.756050
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({0: 4944, 2: 3437, 1: 2281})

Epoch :  28 loss training:  35.75822589546442 Time :  3005
accuracy train: 0.966239 val: 0.745070 test: 0.754643
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({1: 4924, 2: 3437, 0: 2301})

Epoch :  29 loss training:  33.64065082371235 Time :  3021
accuracy train: 0.967646 val: 0.753521 test: 0.756894
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({0: 4913, 2: 3433, 1: 2316})

Epoch :  30 loss training:  32.88337629288435 Time :  3043
accuracy train: 0.970772 val: 0.749296 test: 0.751548
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({2: 4949, 0: 3394, 1: 2319})

Epoch :  31 loss training:  31.830780506134033 Time :  3060
accuracy train: 0.973585 val: 0.760563 test: 0.756612
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({0: 4920, 2: 3439, 1: 2303})

Epoch :  32 loss training:  31.2534606680274 Time :  3076
accuracy train: 0.976711 val: 0.756338 test: 0.751829
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({1: 4908, 2: 3456, 0: 2298})

Epoch :  33 loss training:  28.766777962446213 Time :  3092
accuracy train: 0.979994 val: 0.756338 test: 0.753517
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({1: 4890, 0: 3495, 2: 2277})

Epoch :  34 loss training:  28.0837242603302 Time :  3108
accuracy train: 0.983745 val: 0.760563 test: 0.751829
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({0: 4861, 1: 3494, 2: 2307})

Epoch :  35 loss training:  27.018654942512512 Time :  3125
accuracy train: 0.985308 val: 0.756338 test: 0.752110
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({0: 4847, 2: 3506, 1: 2309})

Epoch :  36 loss training:  25.776238415390253 Time :  3141
accuracy train: 0.987340 val: 0.761972 test: 0.749859
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({1: 4828, 0: 3504, 2: 2330})

Epoch :  37 loss training:  24.85508313588798 Time :  3161
accuracy train: 0.990466 val: 0.759155 test: 0.750703
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({0: 4803, 1: 3528, 2: 2331})

Epoch :  38 loss training:  23.32300727069378 Time :  3177
accuracy train: 0.990466 val: 0.754930 test: 0.749297
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({2: 4751, 0: 3529, 1: 2382})

Epoch :  39 loss training:  22.54894006997347 Time :  3192
accuracy train: 0.992341 val: 0.753521 test: 0.750422
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({2: 4745, 0: 3552, 1: 2365})

Epoch :  40 loss training:  21.616854287683964 Time :  3209
accuracy train: 0.992967 val: 0.754930 test: 0.751829
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({0: 4697, 2: 3570, 1: 2395})

Epoch :  41 loss training:  21.145589030347764 Time :  3225
accuracy train: 0.993748 val: 0.763380 test: 0.744795
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({1: 4676, 0: 3591, 2: 2395})

Epoch :  42 loss training:  20.33236586302519 Time :  3240
accuracy train: 0.994217 val: 0.754930 test: 0.745920
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({0: 4662, 2: 3599, 1: 2401})

Epoch :  43 loss training:  19.47739509679377 Time :  3257
accuracy train: 0.995780 val: 0.750704 test: 0.748452
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({0: 4664, 2: 3615, 1: 2383})

Epoch :  44 loss training:  18.063552726060152 Time :  3283
accuracy train: 0.996561 val: 0.753521 test: 0.749859
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({2: 4659, 0: 3614, 1: 2389})

Epoch :  45 loss training:  16.82712322846055 Time :  3299
accuracy train: 0.997030 val: 0.757746 test: 0.750985
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({2: 4631, 0: 3613, 1: 2418})

Epoch :  46 loss training:  16.73906586598605 Time :  3317
accuracy train: 0.997499 val: 0.757746 test: 0.749578
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({1: 4593, 2: 3637, 0: 2432})

Epoch :  47 loss training:  17.058576081879437 Time :  3335
accuracy train: 0.997030 val: 0.752113 test: 0.750422
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({0: 4585, 1: 3640, 2: 2437})

Epoch :  48 loss training:  15.650768110528588 Time :  3351
accuracy train: 0.998124 val: 0.757746 test: 0.749859
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({2: 4555, 1: 3639, 0: 2468})

Epoch :  49 loss training:  15.233451814390719 Time :  3367
accuracy train: 0.998750 val: 0.753521 test: 0.748171
max validation accuracy : 0.774648 max acc epoch : 18 test accuracy : 0.762521
Counter({2: 4554, 0: 3647, 1: 2461})

========================================================================================================================================================================================================
max acc epoch :  18
max validation accuracy :  0.7746478873239436
test accuracy :  0.7625211029825548
last test_accuracy :  0.7481710748452448
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=250, weight_decay=1e-08)
device :  cuda:0
Counter({2: 5136, 1: 3280, 0: 2246})

Epoch :  1 loss training:  91.63588035106659 Time :  3391
accuracy train: 0.778681 val: 0.760563 test: 0.770681
max validation accuracy : 0.760563 max acc epoch : 1 test accuracy : 0.770681
Counter({2: 4053, 0: 3778, 1: 2831})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.22244280576706 Time :  3409
accuracy train: 0.790247 val: 0.767606 test: 0.770962
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.770962
Counter({2: 4383, 0: 3551, 1: 2728})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.56402146816254 Time :  3424
accuracy train: 0.809472 val: 0.784507 test: 0.777434
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({0: 4738, 1: 2990, 2: 2934})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.26819609105587 Time :  3440
accuracy train: 0.824476 val: 0.769014 test: 0.777715
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({1: 4853, 2: 2925, 0: 2884})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  70.7947463542223 Time :  3457
accuracy train: 0.833073 val: 0.766197 test: 0.777153
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({2: 4853, 0: 2934, 1: 2875})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  70.57542479038239 Time :  3475
accuracy train: 0.850735 val: 0.759155 test: 0.779685
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({0: 4986, 2: 2891, 1: 2785})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.19757732748985 Time :  3491
accuracy train: 0.858706 val: 0.750704 test: 0.773213
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({0: 5011, 2: 2865, 1: 2786})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  63.67062948644161 Time :  3510
accuracy train: 0.866833 val: 0.763380 test: 0.777715
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({0: 5029, 2: 2860, 1: 2773})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  62.31443302333355 Time :  3526
accuracy train: 0.880119 val: 0.760563 test: 0.779966
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({1: 5145, 2: 2768, 0: 2749})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  58.724068000912666 Time :  3541
accuracy train: 0.887152 val: 0.766197 test: 0.778559
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({1: 5164, 2: 2751, 0: 2747})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  58.540533155202866 Time :  3557
accuracy train: 0.885902 val: 0.752113 test: 0.775746
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({2: 5217, 0: 2740, 1: 2705})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  57.64753229916096 Time :  3573
accuracy train: 0.893092 val: 0.759155 test: 0.766460
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({2: 5225, 0: 2742, 1: 2695})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  55.56879436969757 Time :  3587
accuracy train: 0.896218 val: 0.761972 test: 0.771244
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({2: 5241, 1: 2719, 0: 2702})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.64031393826008 Time :  3603
accuracy train: 0.900438 val: 0.752113 test: 0.766742
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({0: 5232, 2: 2730, 1: 2700})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  53.865542098879814 Time :  3618
accuracy train: 0.899812 val: 0.760563 test: 0.769837
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({2: 5232, 0: 2730, 1: 2700})

Epoch :  16 loss training:  53.08396615087986 Time :  3639
accuracy train: 0.908253 val: 0.753521 test: 0.767867
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({2: 5235, 0: 2742, 1: 2685})

Epoch :  17 loss training:  52.66543884575367 Time :  3655
accuracy train: 0.914661 val: 0.756338 test: 0.767304
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({2: 5211, 0: 2746, 1: 2705})

Epoch :  18 loss training:  51.024902895092964 Time :  3672
accuracy train: 0.920288 val: 0.754930 test: 0.767304
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({1: 5224, 2: 2752, 0: 2686})

Epoch :  19 loss training:  48.752578780055046 Time :  3687
accuracy train: 0.925133 val: 0.754930 test: 0.770400
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({2: 5211, 0: 2766, 1: 2685})

Epoch :  20 loss training:  48.64503791183233 Time :  3704
accuracy train: 0.930291 val: 0.763380 test: 0.770400
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({1: 5217, 2: 2767, 0: 2678})

Epoch :  21 loss training:  46.509718246757984 Time :  3721
accuracy train: 0.934198 val: 0.756338 test: 0.769555
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({1: 5199, 2: 2784, 0: 2679})

Epoch :  22 loss training:  45.583104364573956 Time :  3741
accuracy train: 0.938418 val: 0.759155 test: 0.768149
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({1: 5203, 0: 2798, 2: 2661})

Epoch :  23 loss training:  43.594133116304874 Time :  3757
accuracy train: 0.944827 val: 0.760563 test: 0.768711
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({0: 5189, 2: 2797, 1: 2676})

Epoch :  24 loss training:  42.483888663351536 Time :  3773
accuracy train: 0.951704 val: 0.761972 test: 0.769274
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({2: 5201, 0: 2819, 1: 2642})

Epoch :  25 loss training:  41.09719053655863 Time :  3788
accuracy train: 0.953736 val: 0.756338 test: 0.766179
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({2: 5188, 0: 2822, 1: 2652})

Epoch :  26 loss training:  38.52392124384642 Time :  3805
accuracy train: 0.959519 val: 0.769014 test: 0.765616
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({1: 5188, 0: 2839, 2: 2635})

Epoch :  27 loss training:  37.119339019060135 Time :  3821
accuracy train: 0.962332 val: 0.757746 test: 0.769274
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({2: 5145, 1: 2873, 0: 2644})

Epoch :  28 loss training:  34.82514680176973 Time :  3836
accuracy train: 0.966708 val: 0.759155 test: 0.763084
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({2: 5165, 1: 2857, 0: 2640})

Epoch :  29 loss training:  34.34864594787359 Time :  3855
accuracy train: 0.968897 val: 0.754930 test: 0.762802
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({1: 5161, 0: 2855, 2: 2646})

Epoch :  30 loss training:  33.29916198551655 Time :  3872
accuracy train: 0.970460 val: 0.749296 test: 0.764491
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({2: 5142, 0: 2860, 1: 2660})

Epoch :  31 loss training:  32.28582724928856 Time :  3889
accuracy train: 0.976399 val: 0.767606 test: 0.760551
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({2: 5102, 1: 2924, 0: 2636})

Epoch :  32 loss training:  30.93080535531044 Time :  3906
accuracy train: 0.977649 val: 0.754930 test: 0.761677
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({2: 5089, 0: 2924, 1: 2649})

Epoch :  33 loss training:  28.90066984668374 Time :  3922
accuracy train: 0.982495 val: 0.754930 test: 0.764491
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({2: 5059, 0: 2951, 1: 2652})

Epoch :  34 loss training:  28.228088852018118 Time :  3937
accuracy train: 0.982807 val: 0.759155 test: 0.760833
max validation accuracy : 0.784507 max acc epoch : 3 test accuracy : 0.777434
Counter({0: 5032, 2: 2965, 1: 2665})

========================================================================================================================================================================================================
max acc epoch :  3
max validation accuracy :  0.7845070422535211
test accuracy :  0.7774338773213281
last test_accuracy :  0.7608328643781654
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=250, weight_decay=1e-08)
device :  cuda:0
Counter({2: 5136, 1: 3280, 0: 2246})

Epoch :  1 loss training:  91.77123898267746 Time :  3958
accuracy train: 0.779931 val: 0.763380 test: 0.770400
max validation accuracy : 0.763380 max acc epoch : 1 test accuracy : 0.770400
Counter({0: 4013, 2: 3479, 1: 3170})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.49719348549843 Time :  3994
accuracy train: 0.789934 val: 0.767606 test: 0.764209
max validation accuracy : 0.767606 max acc epoch : 2 test accuracy : 0.764209
Counter({2: 4254, 1: 3571, 0: 2837})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.12410531938076 Time :  4011
accuracy train: 0.811504 val: 0.778873 test: 0.777715
max validation accuracy : 0.778873 max acc epoch : 3 test accuracy : 0.777715
Counter({2: 4396, 0: 3654, 1: 2612})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.83407974243164 Time :  4029
accuracy train: 0.819162 val: 0.774648 test: 0.779685
max validation accuracy : 0.778873 max acc epoch : 3 test accuracy : 0.777715
Counter({2: 4458, 1: 3506, 0: 2698})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.1695512086153 Time :  4046
accuracy train: 0.833229 val: 0.784507 test: 0.771525
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({1: 4416, 0: 3531, 2: 2715})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.54185539484024 Time :  4061
accuracy train: 0.850422 val: 0.770423 test: 0.786156
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({2: 4422, 0: 3567, 1: 2673})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.04989570379257 Time :  4079
accuracy train: 0.852454 val: 0.764789 test: 0.778559
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({1: 4535, 2: 3638, 0: 2489})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.21842907369137 Time :  4097
accuracy train: 0.859487 val: 0.761972 test: 0.780529
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({0: 4575, 1: 3633, 2: 2454})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.910775542259216 Time :  4114
accuracy train: 0.866052 val: 0.766197 test: 0.777153
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({0: 4568, 2: 3666, 1: 2428})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.27559766173363 Time :  4131
accuracy train: 0.878399 val: 0.771831 test: 0.775183
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({1: 4612, 0: 3638, 2: 2412})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  60.3361496925354 Time :  4149
accuracy train: 0.880431 val: 0.766197 test: 0.776308
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({2: 4602, 0: 3645, 1: 2415})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.4339954406023 Time :  4165
accuracy train: 0.883088 val: 0.763380 test: 0.772088
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({1: 4636, 0: 3639, 2: 2387})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  58.05566291511059 Time :  4180
accuracy train: 0.888090 val: 0.773239 test: 0.771806
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({2: 4640, 0: 3629, 1: 2393})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  58.389549508690834 Time :  4197
accuracy train: 0.893873 val: 0.766197 test: 0.774620
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({1: 4627, 0: 3650, 2: 2385})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.06730668246746 Time :  4216
accuracy train: 0.893560 val: 0.769014 test: 0.774902
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({2: 4625, 1: 3646, 0: 2391})

Epoch :  16 loss training:  54.99725717306137 Time :  4233
accuracy train: 0.899344 val: 0.769014 test: 0.773776
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({2: 4623, 0: 3659, 1: 2380})

Epoch :  17 loss training:  54.89530897140503 Time :  4250
accuracy train: 0.907784 val: 0.764789 test: 0.774057
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({1: 4609, 2: 3680, 0: 2373})

Epoch :  18 loss training:  53.670023784041405 Time :  4265
accuracy train: 0.913254 val: 0.766197 test: 0.775183
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({2: 4610, 1: 3708, 0: 2344})

Epoch :  19 loss training:  50.30003444850445 Time :  4282
accuracy train: 0.917943 val: 0.764789 test: 0.772932
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({0: 4597, 1: 3723, 2: 2342})

Epoch :  20 loss training:  50.43433856964111 Time :  4299
accuracy train: 0.923257 val: 0.767606 test: 0.773213
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({2: 4597, 1: 3741, 0: 2324})

Epoch :  21 loss training:  48.23845472931862 Time :  4316
accuracy train: 0.925289 val: 0.761972 test: 0.772932
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({1: 4545, 0: 3752, 2: 2365})

Epoch :  22 loss training:  46.961987651884556 Time :  4339
accuracy train: 0.932948 val: 0.761972 test: 0.769274
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({2: 4525, 1: 3782, 0: 2355})

Epoch :  23 loss training:  44.61284402757883 Time :  4355
accuracy train: 0.935917 val: 0.766197 test: 0.771525
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({0: 4494, 2: 3777, 1: 2391})

Epoch :  24 loss training:  44.47956480830908 Time :  4371
accuracy train: 0.941232 val: 0.769014 test: 0.770400
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({0: 4504, 1: 3807, 2: 2351})

Epoch :  25 loss training:  43.163505882024765 Time :  4389
accuracy train: 0.946233 val: 0.769014 test: 0.768711
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({2: 4476, 0: 3811, 1: 2375})

Epoch :  26 loss training:  39.797813795506954 Time :  4409
accuracy train: 0.951078 val: 0.769014 test: 0.764772
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({2: 4452, 0: 3827, 1: 2383})

Epoch :  27 loss training:  39.72605814784765 Time :  4428
accuracy train: 0.954204 val: 0.764789 test: 0.766460
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({2: 4423, 0: 3830, 1: 2409})

Epoch :  28 loss training:  37.023301772773266 Time :  4446
accuracy train: 0.959206 val: 0.769014 test: 0.761958
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({2: 4438, 1: 3796, 0: 2428})

Epoch :  29 loss training:  35.78210932761431 Time :  4466
accuracy train: 0.962019 val: 0.773239 test: 0.766179
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({1: 4376, 2: 3819, 0: 2467})

Epoch :  30 loss training:  34.853042267262936 Time :  4484
accuracy train: 0.965927 val: 0.771831 test: 0.767586
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({0: 4389, 1: 3812, 2: 2461})

Epoch :  31 loss training:  32.98174548149109 Time :  4501
accuracy train: 0.968740 val: 0.770423 test: 0.766460
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({0: 4368, 1: 3837, 2: 2457})

Epoch :  32 loss training:  32.433081448078156 Time :  4520
accuracy train: 0.972804 val: 0.766197 test: 0.765898
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({2: 4364, 1: 3834, 0: 2464})

Epoch :  33 loss training:  30.94941709190607 Time :  4539
accuracy train: 0.973898 val: 0.767606 test: 0.764772
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({1: 4352, 2: 3846, 0: 2464})

Epoch :  34 loss training:  29.733632769435644 Time :  4557
accuracy train: 0.976868 val: 0.763380 test: 0.763647
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({2: 4344, 0: 3837, 1: 2481})

Epoch :  35 loss training:  27.61236722022295 Time :  4587
accuracy train: 0.978118 val: 0.770423 test: 0.763084
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({1: 4338, 2: 3846, 0: 2478})

Epoch :  36 loss training:  26.154018308967352 Time :  4606
accuracy train: 0.981713 val: 0.766197 test: 0.762521
max validation accuracy : 0.784507 max acc epoch : 5 test accuracy : 0.771525
Counter({0: 4320, 1: 3846, 2: 2496})

========================================================================================================================================================================================================
max acc epoch :  5
max validation accuracy :  0.7845070422535211
test accuracy :  0.7715250422059651
last test_accuracy :  0.7625211029825548
========================================================================================================================================================================================================

itr : 6
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=250, weight_decay=1e-08)
device :  cuda:0
Counter({2: 5136, 1: 3280, 0: 2246})

Epoch :  1 loss training:  91.62294533848763 Time :  4629
accuracy train: 0.783682 val: 0.764789 test: 0.772651
max validation accuracy : 0.764789 max acc epoch : 1 test accuracy : 0.772651
Counter({1: 4173, 0: 3586, 2: 2903})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.37907955050468 Time :  4646
accuracy train: 0.785245 val: 0.761972 test: 0.762802
max validation accuracy : 0.764789 max acc epoch : 1 test accuracy : 0.772651
Counter({2: 4302, 1: 3637, 0: 2723})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  79.77565228939056 Time :  4664
accuracy train: 0.807284 val: 0.781690 test: 0.777434
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.777434
Counter({1: 4772, 0: 3179, 2: 2711})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.70084147155285 Time :  4682
accuracy train: 0.820256 val: 0.778873 test: 0.779966
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.777434
Counter({1: 4991, 2: 2983, 0: 2688})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  72.3021614253521 Time :  4702
accuracy train: 0.833542 val: 0.780282 test: 0.776590
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.777434
Counter({1: 4991, 0: 2900, 2: 2771})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.88969776034355 Time :  4721
accuracy train: 0.845264 val: 0.769014 test: 0.782780
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.777434
Counter({1: 4870, 0: 3102, 2: 2690})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.5283330976963 Time :  4739
accuracy train: 0.850109 val: 0.778873 test: 0.781092
max validation accuracy : 0.781690 max acc epoch : 3 test accuracy : 0.777434
Counter({2: 4888, 1: 3078, 0: 2696})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.84203486144543 Time :  4758
accuracy train: 0.854642 val: 0.784507 test: 0.787563
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({2: 4913, 1: 3100, 0: 2649})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.4435173869133 Time :  4774
accuracy train: 0.867615 val: 0.764789 test: 0.786719
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({0: 4982, 2: 3035, 1: 2645})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.11529530584812 Time :  4793
accuracy train: 0.878712 val: 0.774648 test: 0.786156
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({2: 5019, 1: 3004, 0: 2639})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  61.14535699784756 Time :  4810
accuracy train: 0.874023 val: 0.767606 test: 0.782217
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({1: 5036, 0: 2975, 2: 2651})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  60.143992096185684 Time :  4843
accuracy train: 0.882463 val: 0.776056 test: 0.776590
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({0: 5024, 2: 2990, 1: 2648})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  58.79250353574753 Time :  4862
accuracy train: 0.886840 val: 0.778873 test: 0.777153
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({2: 5062, 1: 2950, 0: 2650})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  59.45781271159649 Time :  4880
accuracy train: 0.885589 val: 0.773239 test: 0.783061
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({0: 5052, 1: 2971, 2: 2639})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  56.48228055238724 Time :  4898
accuracy train: 0.887777 val: 0.766197 test: 0.779966
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({0: 5120, 2: 2911, 1: 2631})

Epoch :  16 loss training:  55.629609286785126 Time :  4915
accuracy train: 0.896061 val: 0.767606 test: 0.777153
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({0: 5067, 1: 2961, 2: 2634})

Epoch :  17 loss training:  55.96616916358471 Time :  4933
accuracy train: 0.902313 val: 0.769014 test: 0.778278
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({1: 5100, 2: 2936, 0: 2626})

Epoch :  18 loss training:  54.45128171145916 Time :  4952
accuracy train: 0.906690 val: 0.780282 test: 0.776871
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({1: 5076, 2: 2961, 0: 2625})

Epoch :  19 loss training:  51.78713196516037 Time :  4975
accuracy train: 0.914817 val: 0.774648 test: 0.779966
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({2: 5093, 0: 2964, 1: 2605})

Epoch :  20 loss training:  51.02409315109253 Time :  4992
accuracy train: 0.919975 val: 0.761972 test: 0.777715
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({0: 5075, 1: 2991, 2: 2596})

Epoch :  21 loss training:  49.22752121090889 Time :  5009
accuracy train: 0.925602 val: 0.770423 test: 0.777434
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({1: 5084, 2: 2986, 0: 2592})

Epoch :  22 loss training:  48.54948270320892 Time :  5025
accuracy train: 0.927946 val: 0.764789 test: 0.776027
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({1: 5019, 2: 3079, 0: 2564})

Epoch :  23 loss training:  46.03232469409704 Time :  5042
accuracy train: 0.933886 val: 0.766197 test: 0.776590
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({1: 5043, 0: 3052, 2: 2567})

Epoch :  24 loss training:  44.92423499375582 Time :  5058
accuracy train: 0.939043 val: 0.770423 test: 0.773776
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({1: 5022, 0: 3069, 2: 2571})

Epoch :  25 loss training:  44.05453718453646 Time :  5078
accuracy train: 0.944514 val: 0.760563 test: 0.773495
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({1: 5053, 0: 3063, 2: 2546})

Epoch :  26 loss training:  41.275249764323235 Time :  5094
accuracy train: 0.947015 val: 0.767606 test: 0.776590
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({0: 5016, 1: 3118, 2: 2528})

Epoch :  27 loss training:  39.88872943818569 Time :  5111
accuracy train: 0.953579 val: 0.777465 test: 0.774620
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({2: 5015, 1: 3120, 0: 2527})

Epoch :  28 loss training:  37.522724352777004 Time :  5128
accuracy train: 0.958893 val: 0.766197 test: 0.768430
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({2: 5041, 0: 3104, 1: 2517})

Epoch :  29 loss training:  36.92685456573963 Time :  5145
accuracy train: 0.961863 val: 0.777465 test: 0.771806
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({0: 5013, 2: 3122, 1: 2527})

Epoch :  30 loss training:  35.694247990846634 Time :  5162
accuracy train: 0.964051 val: 0.767606 test: 0.763365
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({0: 5025, 2: 3113, 1: 2524})

Epoch :  31 loss training:  34.790305987000465 Time :  5178
accuracy train: 0.967021 val: 0.766197 test: 0.769837
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({1: 4986, 0: 3166, 2: 2510})

Epoch :  32 loss training:  33.666311986744404 Time :  5204
accuracy train: 0.971085 val: 0.777465 test: 0.768430
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({1: 4925, 2: 3221, 0: 2516})

Epoch :  33 loss training:  31.678244784474373 Time :  5220
accuracy train: 0.974680 val: 0.773239 test: 0.764491
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({2: 4891, 0: 3242, 1: 2529})

Epoch :  34 loss training:  31.1599510461092 Time :  5236
accuracy train: 0.979369 val: 0.773239 test: 0.770400
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({0: 4893, 2: 3235, 1: 2534})

Epoch :  35 loss training:  29.69790042191744 Time :  5254
accuracy train: 0.980775 val: 0.770423 test: 0.768149
max validation accuracy : 0.784507 max acc epoch : 8 test accuracy : 0.787563
Counter({1: 4885, 2: 3253, 0: 2524})

Epoch :  36 loss training:  28.348946385085583 Time :  5270
accuracy train: 0.983589 val: 0.785915 test: 0.764772
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({2: 4847, 0: 3284, 1: 2531})

Epoch :  37 loss training:  27.15908458456397 Time :  5286
accuracy train: 0.986089 val: 0.769014 test: 0.762802
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({1: 4825, 2: 3295, 0: 2542})

Epoch :  38 loss training:  25.417673531919718 Time :  5303
accuracy train: 0.988278 val: 0.764789 test: 0.761114
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({1: 4775, 0: 3318, 2: 2569})

Epoch :  39 loss training:  23.561728302389383 Time :  5331
accuracy train: 0.988278 val: 0.766197 test: 0.764491
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({2: 4741, 1: 3365, 0: 2556})

Epoch :  40 loss training:  23.29295026883483 Time :  5346
accuracy train: 0.991247 val: 0.764789 test: 0.759707
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({1: 4718, 0: 3393, 2: 2551})

Epoch :  41 loss training:  22.312064288184047 Time :  5363
accuracy train: 0.992341 val: 0.769014 test: 0.761396
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({2: 4707, 1: 3391, 0: 2564})

Epoch :  42 loss training:  22.33055980503559 Time :  5381
accuracy train: 0.993435 val: 0.759155 test: 0.759426
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({2: 4666, 1: 3431, 0: 2565})

Epoch :  43 loss training:  20.36621036194265 Time :  5400
accuracy train: 0.994373 val: 0.767606 test: 0.761396
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({2: 4625, 1: 3455, 0: 2582})

Epoch :  44 loss training:  19.1963734831661 Time :  5417
accuracy train: 0.996093 val: 0.771831 test: 0.760551
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({2: 4610, 1: 3477, 0: 2575})

Epoch :  45 loss training:  19.39934035949409 Time :  5436
accuracy train: 0.997499 val: 0.778873 test: 0.761114
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({1: 4624, 0: 3449, 2: 2589})

Epoch :  46 loss training:  18.022861894220114 Time :  5456
accuracy train: 0.997030 val: 0.769014 test: 0.764491
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({2: 4562, 1: 3509, 0: 2591})

Epoch :  47 loss training:  17.158254687674344 Time :  5474
accuracy train: 0.997812 val: 0.766197 test: 0.759707
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({0: 4545, 2: 3515, 1: 2602})

Epoch :  48 loss training:  16.75558339804411 Time :  5492
accuracy train: 0.998124 val: 0.761972 test: 0.758301
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({2: 4478, 1: 3547, 0: 2637})

Epoch :  49 loss training:  16.317254345864058 Time :  5510
accuracy train: 0.998437 val: 0.764789 test: 0.759145
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({1: 4507, 0: 3522, 2: 2633})

Epoch :  50 loss training:  15.416205109097064 Time :  5527
accuracy train: 0.999375 val: 0.767606 test: 0.758019
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({0: 4508, 2: 3523, 1: 2631})

Epoch :  51 loss training:  14.113083210773766 Time :  5544
accuracy train: 0.999062 val: 0.767606 test: 0.752954
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({2: 4492, 1: 3529, 0: 2641})

Epoch :  52 loss training:  14.148120640777051 Time :  5571
accuracy train: 0.998906 val: 0.764789 test: 0.755487
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({2: 4477, 1: 3535, 0: 2650})

Epoch :  53 loss training:  13.597743484191597 Time :  5590
accuracy train: 0.998593 val: 0.757746 test: 0.760551
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({1: 4439, 0: 3546, 2: 2677})

Epoch :  54 loss training:  12.661731701344252 Time :  5606
accuracy train: 0.999062 val: 0.764789 test: 0.758019
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({1: 4409, 0: 3567, 2: 2686})

Epoch :  55 loss training:  12.010991795919836 Time :  5624
accuracy train: 0.998906 val: 0.764789 test: 0.750703
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({2: 4403, 0: 3575, 1: 2684})

Epoch :  56 loss training:  12.192839650437236 Time :  5642
accuracy train: 0.999219 val: 0.764789 test: 0.756331
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({2: 4367, 1: 3582, 0: 2713})

Epoch :  57 loss training:  11.082276796922088 Time :  5659
accuracy train: 0.999375 val: 0.761972 test: 0.759145
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({1: 4306, 2: 3614, 0: 2742})

Epoch :  58 loss training:  11.430044994689524 Time :  5677
accuracy train: 0.999844 val: 0.757746 test: 0.752954
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({2: 4284, 0: 3637, 1: 2741})

Epoch :  59 loss training:  10.23870712146163 Time :  5702
accuracy train: 0.999687 val: 0.763380 test: 0.755205
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({1: 4283, 2: 3607, 0: 2772})

Epoch :  60 loss training:  9.715535677969456 Time :  5719
accuracy train: 0.999531 val: 0.761972 test: 0.756331
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({1: 4286, 0: 3616, 2: 2760})

Epoch :  61 loss training:  8.901475103804842 Time :  5736
accuracy train: 1.000000 val: 0.760563 test: 0.758863
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({1: 4264, 0: 3635, 2: 2763})

Epoch :  62 loss training:  9.439070819877088 Time :  5753
accuracy train: 1.000000 val: 0.767606 test: 0.752673
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({2: 4243, 0: 3652, 1: 2767})

Epoch :  63 loss training:  7.899971466511488 Time :  5770
accuracy train: 1.000000 val: 0.770423 test: 0.754924
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({0: 4212, 1: 3691, 2: 2759})

Epoch :  64 loss training:  8.58057152456604 Time :  5789
accuracy train: 1.000000 val: 0.771831 test: 0.756612
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({2: 4227, 1: 3675, 0: 2760})

Epoch :  65 loss training:  8.76887839147821 Time :  5819
accuracy train: 0.999844 val: 0.766197 test: 0.756894
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({2: 4211, 0: 3677, 1: 2774})

Epoch :  66 loss training:  8.53333554440178 Time :  5835
accuracy train: 1.000000 val: 0.776056 test: 0.754643
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({0: 4200, 2: 3698, 1: 2764})

Epoch :  67 loss training:  6.618660541251302 Time :  5853
accuracy train: 1.000000 val: 0.773239 test: 0.760833
max validation accuracy : 0.785915 max acc epoch : 36 test accuracy : 0.764772
Counter({1: 4150, 2: 3725, 0: 2787})

========================================================================================================================================================================================================
max acc epoch :  36
max validation accuracy :  0.7859154929577464
test accuracy :  0.7647720877884074
last test_accuracy :  0.7608328643781654
========================================================================================================================================================================================================

itr : 7
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=250, weight_decay=1e-08)
device :  cuda:0
Counter({2: 5136, 1: 3280, 0: 2246})

Epoch :  1 loss training:  91.5747811794281 Time :  5874
accuracy train: 0.780869 val: 0.756338 test: 0.770962
max validation accuracy : 0.756338 max acc epoch : 1 test accuracy : 0.770962
Counter({2: 4209, 0: 3660, 1: 2793})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.3709248304367 Time :  5893
accuracy train: 0.789934 val: 0.757746 test: 0.766742
max validation accuracy : 0.757746 max acc epoch : 2 test accuracy : 0.766742
Counter({2: 4028, 1: 3664, 0: 2970})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.177555590868 Time :  5908
accuracy train: 0.813692 val: 0.776056 test: 0.775746
max validation accuracy : 0.776056 max acc epoch : 3 test accuracy : 0.775746
Counter({2: 4619, 0: 3054, 1: 2989})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.75791768729687 Time :  5928
accuracy train: 0.825102 val: 0.770423 test: 0.777434
max validation accuracy : 0.776056 max acc epoch : 3 test accuracy : 0.775746
Counter({1: 4747, 0: 3115, 2: 2800})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.8989467471838 Time :  5947
accuracy train: 0.834167 val: 0.778873 test: 0.778559
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.778559
Counter({0: 4696, 1: 3255, 2: 2711})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.24814131855965 Time :  5965
accuracy train: 0.847296 val: 0.771831 test: 0.781654
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.778559
Counter({0: 4811, 1: 3050, 2: 2801})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.83081737160683 Time :  5982
accuracy train: 0.855267 val: 0.764789 test: 0.778278
max validation accuracy : 0.778873 max acc epoch : 5 test accuracy : 0.778559
Counter({0: 4849, 1: 3016, 2: 2797})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.34846767783165 Time :  6002
accuracy train: 0.862770 val: 0.780282 test: 0.776871
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({1: 4925, 0: 2927, 2: 2810})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.23848557472229 Time :  6017
accuracy train: 0.871522 val: 0.759155 test: 0.780810
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({2: 4911, 1: 2915, 0: 2836})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.390303283929825 Time :  6035
accuracy train: 0.884808 val: 0.760563 test: 0.780529
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({2: 4956, 1: 2867, 0: 2839})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.443380922079086 Time :  6053
accuracy train: 0.884808 val: 0.761972 test: 0.779403
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({1: 4904, 2: 2927, 0: 2831})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  58.503513902425766 Time :  6072
accuracy train: 0.889966 val: 0.760563 test: 0.773495
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({1: 4947, 2: 2915, 0: 2800})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  56.79278114438057 Time :  6088
accuracy train: 0.892935 val: 0.764789 test: 0.777153
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({1: 4939, 2: 2901, 0: 2822})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.623418137431145 Time :  6106
accuracy train: 0.896374 val: 0.773239 test: 0.781092
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({1: 4922, 0: 2925, 2: 2815})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  55.09454020857811 Time :  6123
accuracy train: 0.898249 val: 0.767606 test: 0.779685
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({2: 4900, 0: 2914, 1: 2848})

Epoch :  16 loss training:  53.65121887624264 Time :  6140
accuracy train: 0.904970 val: 0.766197 test: 0.779122
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({2: 4889, 0: 2933, 1: 2840})

Epoch :  17 loss training:  53.794690519571304 Time :  6158
accuracy train: 0.911847 val: 0.764789 test: 0.780529
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({0: 4873, 2: 2938, 1: 2851})

Epoch :  18 loss training:  52.57446254789829 Time :  6176
accuracy train: 0.915130 val: 0.763380 test: 0.779403
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({0: 4879, 2: 2956, 1: 2827})

Epoch :  19 loss training:  49.852917924523354 Time :  6194
accuracy train: 0.920756 val: 0.760563 test: 0.776308
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({0: 4879, 2: 2941, 1: 2842})

Epoch :  20 loss training:  49.59857551753521 Time :  6211
accuracy train: 0.927477 val: 0.761972 test: 0.776871
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({0: 4881, 1: 2970, 2: 2811})

Epoch :  21 loss training:  47.605534836649895 Time :  6228
accuracy train: 0.932635 val: 0.760563 test: 0.776871
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({0: 4866, 1: 2972, 2: 2824})

Epoch :  22 loss training:  46.41838289052248 Time :  6244
accuracy train: 0.939200 val: 0.763380 test: 0.776027
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({2: 4877, 0: 2979, 1: 2806})

Epoch :  23 loss training:  44.18238825351 Time :  6261
accuracy train: 0.942013 val: 0.759155 test: 0.777997
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({1: 4860, 2: 2978, 0: 2824})

Epoch :  24 loss training:  43.361192524433136 Time :  6277
accuracy train: 0.948421 val: 0.766197 test: 0.772651
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({2: 4853, 0: 2995, 1: 2814})

Epoch :  25 loss training:  42.62636587768793 Time :  6299
accuracy train: 0.954361 val: 0.763380 test: 0.769837
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({1: 4837, 2: 3000, 0: 2825})

Epoch :  26 loss training:  39.185721173882484 Time :  6322
accuracy train: 0.957018 val: 0.767606 test: 0.773776
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({1: 4821, 2: 3009, 0: 2832})

Epoch :  27 loss training:  38.15977397561073 Time :  6338
accuracy train: 0.962019 val: 0.756338 test: 0.768711
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({0: 4809, 2: 3010, 1: 2843})

Epoch :  28 loss training:  36.22968226671219 Time :  6354
accuracy train: 0.966552 val: 0.764789 test: 0.767867
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({2: 4789, 1: 3004, 0: 2869})

Epoch :  29 loss training:  34.726822435855865 Time :  6372
accuracy train: 0.969522 val: 0.766197 test: 0.765616
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({1: 4801, 0: 3001, 2: 2860})

Epoch :  30 loss training:  33.50987842679024 Time :  6387
accuracy train: 0.972960 val: 0.769014 test: 0.766179
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({0: 4775, 1: 2998, 2: 2889})

Epoch :  31 loss training:  32.25777309387922 Time :  6404
accuracy train: 0.976555 val: 0.764789 test: 0.763365
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({0: 4748, 2: 3009, 1: 2905})

Epoch :  32 loss training:  30.645307816565037 Time :  6430
accuracy train: 0.979056 val: 0.766197 test: 0.766179
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({1: 4696, 0: 3010, 2: 2956})

Epoch :  33 loss training:  29.408555254340172 Time :  6446
accuracy train: 0.981088 val: 0.770423 test: 0.763084
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({2: 4653, 0: 3030, 1: 2979})

Epoch :  34 loss training:  28.888603378087282 Time :  6464
accuracy train: 0.983589 val: 0.754930 test: 0.765898
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({0: 4614, 2: 3027, 1: 3021})

Epoch :  35 loss training:  27.05336170271039 Time :  6483
accuracy train: 0.985621 val: 0.761972 test: 0.764209
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({1: 4619, 0: 3042, 2: 3001})

Epoch :  36 loss training:  26.32416546344757 Time :  6500
accuracy train: 0.988278 val: 0.761972 test: 0.764209
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({1: 4561, 0: 3052, 2: 3049})

Epoch :  37 loss training:  26.21336840465665 Time :  6515
accuracy train: 0.989684 val: 0.760563 test: 0.764209
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({1: 4536, 0: 3073, 2: 3053})

Epoch :  38 loss training:  23.767082564532757 Time :  6531
accuracy train: 0.990153 val: 0.750704 test: 0.762521
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({0: 4497, 1: 3090, 2: 3075})

Epoch :  39 loss training:  23.07154454290867 Time :  6559
accuracy train: 0.991560 val: 0.756338 test: 0.762802
max validation accuracy : 0.780282 max acc epoch : 8 test accuracy : 0.776871
Counter({1: 4482, 2: 3092, 0: 3088})

========================================================================================================================================================================================================
max acc epoch :  8
max validation accuracy :  0.780281690140845
test accuracy :  0.7768711311198649
last test_accuracy :  0.7628024760832864
========================================================================================================================================================================================================

itr : 8
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=250, weight_decay=1e-08)
device :  cuda:0
Counter({2: 5136, 1: 3280, 0: 2246})

Epoch :  1 loss training:  91.53670364618301 Time :  6582
accuracy train: 0.781182 val: 0.757746 test: 0.770681
max validation accuracy : 0.757746 max acc epoch : 1 test accuracy : 0.770681
Counter({2: 4002, 0: 3885, 1: 2775})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.1769337952137 Time :  6599
accuracy train: 0.790560 val: 0.774648 test: 0.767586
max validation accuracy : 0.774648 max acc epoch : 2 test accuracy : 0.767586
Counter({2: 4152, 1: 3946, 0: 2564})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.05731874704361 Time :  6619
accuracy train: 0.809315 val: 0.778873 test: 0.776027
max validation accuracy : 0.778873 max acc epoch : 3 test accuracy : 0.776027
Counter({2: 4792, 1: 3293, 0: 2577})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.7161280810833 Time :  6637
accuracy train: 0.822757 val: 0.784507 test: 0.777434
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({2: 5113, 0: 3012, 1: 2537})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.68397387862206 Time :  6654
accuracy train: 0.833229 val: 0.780282 test: 0.775183
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({1: 4897, 2: 3176, 0: 2589})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.6347134411335 Time :  6672
accuracy train: 0.845733 val: 0.767606 test: 0.785031
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({1: 4980, 2: 3090, 0: 2592})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  67.06966061890125 Time :  6702
accuracy train: 0.850735 val: 0.757746 test: 0.778841
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({1: 4992, 2: 3118, 0: 2552})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  65.15377447009087 Time :  6718
accuracy train: 0.855892 val: 0.756338 test: 0.780529
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({2: 5052, 1: 3079, 0: 2531})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.179902493953705 Time :  6735
accuracy train: 0.869178 val: 0.757746 test: 0.773495
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({2: 5086, 0: 3040, 1: 2536})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.78064589202404 Time :  6752
accuracy train: 0.883245 val: 0.764789 test: 0.774057
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({0: 5099, 2: 3064, 1: 2499})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.489176988601685 Time :  6770
accuracy train: 0.883557 val: 0.761972 test: 0.775183
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({2: 5162, 0: 3017, 1: 2483})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.04711143672466 Time :  6787
accuracy train: 0.893717 val: 0.769014 test: 0.765053
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({1: 5228, 2: 3018, 0: 2416})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  57.20053066313267 Time :  6803
accuracy train: 0.896686 val: 0.774648 test: 0.768430
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({0: 5223, 1: 3014, 2: 2425})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  57.53834865987301 Time :  6831
accuracy train: 0.896999 val: 0.764789 test: 0.771806
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({0: 5219, 1: 3020, 2: 2423})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  55.6667737364769 Time :  6849
accuracy train: 0.899344 val: 0.761972 test: 0.770400
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({0: 5247, 1: 2989, 2: 2426})

Epoch :  16 loss training:  54.01360383629799 Time :  6866
accuracy train: 0.905127 val: 0.774648 test: 0.767586
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({2: 5246, 0: 3005, 1: 2411})

Epoch :  17 loss training:  53.63908523321152 Time :  6884
accuracy train: 0.912004 val: 0.780282 test: 0.769837
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({1: 5245, 2: 3000, 0: 2417})

Epoch :  18 loss training:  52.724520176649094 Time :  6902
accuracy train: 0.917631 val: 0.776056 test: 0.768993
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({0: 5273, 2: 3003, 1: 2386})

Epoch :  19 loss training:  50.13835583627224 Time :  6918
accuracy train: 0.922007 val: 0.773239 test: 0.770962
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({1: 5249, 0: 3011, 2: 2402})

Epoch :  20 loss training:  48.79324431717396 Time :  6941
accuracy train: 0.930447 val: 0.773239 test: 0.770962
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({2: 5233, 0: 3036, 1: 2393})

Epoch :  21 loss training:  47.715613566339016 Time :  6960
accuracy train: 0.935449 val: 0.776056 test: 0.771525
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({0: 5216, 1: 3041, 2: 2405})

Epoch :  22 loss training:  45.99749347567558 Time :  6975
accuracy train: 0.939356 val: 0.781690 test: 0.768149
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({2: 5144, 0: 3120, 1: 2398})

Epoch :  23 loss training:  44.125629007816315 Time :  6992
accuracy train: 0.944514 val: 0.771831 test: 0.769837
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({0: 5162, 2: 3096, 1: 2404})

Epoch :  24 loss training:  42.972586363554 Time :  7011
accuracy train: 0.949203 val: 0.780282 test: 0.767867
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({1: 5131, 0: 3130, 2: 2401})

Epoch :  25 loss training:  42.24600093066692 Time :  7028
accuracy train: 0.954204 val: 0.780282 test: 0.768149
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({2: 5091, 1: 3140, 0: 2431})

Epoch :  26 loss training:  38.75482647866011 Time :  7047
accuracy train: 0.956705 val: 0.781690 test: 0.769274
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({2: 5081, 0: 3162, 1: 2419})

Epoch :  27 loss training:  37.93197540193796 Time :  7069
accuracy train: 0.961707 val: 0.783099 test: 0.768430
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({1: 5045, 0: 3198, 2: 2419})

Epoch :  28 loss training:  35.67779642343521 Time :  7086
accuracy train: 0.963895 val: 0.783099 test: 0.763928
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({2: 5025, 0: 3191, 1: 2446})

Epoch :  29 loss training:  34.94280835241079 Time :  7102
accuracy train: 0.968428 val: 0.773239 test: 0.763647
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({0: 5018, 2: 3186, 1: 2458})

Epoch :  30 loss training:  33.08442836999893 Time :  7119
accuracy train: 0.971397 val: 0.780282 test: 0.760270
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({2: 5009, 0: 3179, 1: 2474})

Epoch :  31 loss training:  32.88193994015455 Time :  7136
accuracy train: 0.972804 val: 0.778873 test: 0.762521
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({1: 4982, 2: 3226, 0: 2454})

Epoch :  32 loss training:  31.4071148596704 Time :  7153
accuracy train: 0.975617 val: 0.767606 test: 0.764491
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({2: 4895, 1: 3284, 0: 2483})

Epoch :  33 loss training:  29.707758396863937 Time :  7170
accuracy train: 0.979681 val: 0.774648 test: 0.766460
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({0: 4856, 1: 3341, 2: 2465})

Epoch :  34 loss training:  28.755488459020853 Time :  7196
accuracy train: 0.981400 val: 0.767606 test: 0.767586
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({2: 4802, 1: 3372, 0: 2488})

Epoch :  35 loss training:  27.290809515863657 Time :  7213
accuracy train: 0.984058 val: 0.764789 test: 0.761396
max validation accuracy : 0.784507 max acc epoch : 4 test accuracy : 0.777434
Counter({2: 4805, 1: 3367, 0: 2490})

========================================================================================================================================================================================================
max acc epoch :  4
max validation accuracy :  0.7845070422535211
test accuracy :  0.7774338773213281
last test_accuracy :  0.7613956105796286
========================================================================================================================================================================================================

itr : 9
Namespace(batch_size=64, dataset='mr', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=10, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=250, weight_decay=1e-08)
device :  cuda:0
Counter({2: 5136, 1: 3280, 0: 2246})

Epoch :  1 loss training:  91.6185232102871 Time :  7236
accuracy train: 0.779775 val: 0.761972 test: 0.766460
max validation accuracy : 0.761972 max acc epoch : 1 test accuracy : 0.766460
Counter({0: 4370, 2: 3665, 1: 2627})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  82.35988083481789 Time :  7254
accuracy train: 0.790716 val: 0.766197 test: 0.765898
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.765898
Counter({2: 4213, 0: 3572, 1: 2877})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  80.14983369410038 Time :  7272
accuracy train: 0.812910 val: 0.763380 test: 0.777434
max validation accuracy : 0.766197 max acc epoch : 2 test accuracy : 0.765898
Counter({0: 4560, 2: 3071, 1: 3031})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  74.58789962530136 Time :  7290
accuracy train: 0.826508 val: 0.777465 test: 0.775183
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({2: 4713, 1: 3007, 0: 2942})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  71.75472585856915 Time :  7310
accuracy train: 0.834636 val: 0.774648 test: 0.773495
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({0: 4569, 2: 3100, 1: 2993})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  71.18189552426338 Time :  7329
accuracy train: 0.850422 val: 0.761972 test: 0.782780
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({2: 4605, 1: 3230, 0: 2827})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  66.86157551407814 Time :  7347
accuracy train: 0.854798 val: 0.766197 test: 0.784750
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({1: 4590, 0: 3247, 2: 2825})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  64.9229165315628 Time :  7365
accuracy train: 0.859644 val: 0.767606 test: 0.778278
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({2: 4720, 1: 3128, 0: 2814})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  63.0356272906065 Time :  7383
accuracy train: 0.867302 val: 0.756338 test: 0.781092
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({2: 4759, 0: 3113, 1: 2790})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.9546317756176 Time :  7403
accuracy train: 0.882932 val: 0.770423 test: 0.775464
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({2: 4799, 0: 3087, 1: 2776})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  59.635974168777466 Time :  7422
accuracy train: 0.885433 val: 0.759155 test: 0.776871
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({1: 4827, 2: 3058, 0: 2777})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  59.006648510694504 Time :  7450
accuracy train: 0.892310 val: 0.763380 test: 0.770118
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({0: 4867, 2: 3070, 1: 2725})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  56.85395206511021 Time :  7479
accuracy train: 0.895280 val: 0.769014 test: 0.771244
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({1: 4839, 0: 3076, 2: 2747})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  56.81757827103138 Time :  7498
accuracy train: 0.894029 val: 0.766197 test: 0.770962
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({1: 4841, 0: 3092, 2: 2729})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  54.83622618019581 Time :  7516
accuracy train: 0.892154 val: 0.761972 test: 0.766460
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({2: 4873, 1: 3043, 0: 2746})

Epoch :  16 loss training:  54.12190246582031 Time :  7535
accuracy train: 0.904501 val: 0.763380 test: 0.768711
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({1: 4849, 0: 3065, 2: 2748})

Epoch :  17 loss training:  53.893932953476906 Time :  7553
accuracy train: 0.908253 val: 0.766197 test: 0.769837
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({2: 4844, 0: 3070, 1: 2748})

Epoch :  18 loss training:  52.15654177963734 Time :  7572
accuracy train: 0.914661 val: 0.770423 test: 0.769274
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({2: 4829, 0: 3097, 1: 2736})

Epoch :  19 loss training:  49.39243794977665 Time :  7591
accuracy train: 0.920444 val: 0.756338 test: 0.770400
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({0: 4832, 2: 3100, 1: 2730})

Epoch :  20 loss training:  49.303299866616726 Time :  7609
accuracy train: 0.926540 val: 0.770423 test: 0.768711
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({1: 4858, 2: 3098, 0: 2706})

Epoch :  21 loss training:  47.21012303233147 Time :  7629
accuracy train: 0.933104 val: 0.766197 test: 0.767586
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({0: 4855, 2: 3113, 1: 2694})

Epoch :  22 loss training:  45.95161747187376 Time :  7647
accuracy train: 0.937480 val: 0.757746 test: 0.768149
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({1: 4833, 0: 3127, 2: 2702})

Epoch :  23 loss training:  43.36525736749172 Time :  7665
accuracy train: 0.942795 val: 0.761972 test: 0.765335
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({1: 4840, 0: 3122, 2: 2700})

Epoch :  24 loss training:  43.228502832353115 Time :  7683
accuracy train: 0.946702 val: 0.767606 test: 0.764491
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({2: 4805, 1: 3143, 0: 2714})

Epoch :  25 loss training:  41.92876893281937 Time :  7702
accuracy train: 0.954204 val: 0.761972 test: 0.763647
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({2: 4801, 0: 3163, 1: 2698})

Epoch :  26 loss training:  39.05652018636465 Time :  7729
accuracy train: 0.956236 val: 0.767606 test: 0.768149
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({1: 4762, 0: 3198, 2: 2702})

Epoch :  27 loss training:  37.58111548423767 Time :  7747
accuracy train: 0.961394 val: 0.766197 test: 0.764772
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({1: 4759, 0: 3213, 2: 2690})

Epoch :  28 loss training:  35.34399621933699 Time :  7764
accuracy train: 0.965302 val: 0.770423 test: 0.760833
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({2: 4753, 1: 3205, 0: 2704})

Epoch :  29 loss training:  34.33937129378319 Time :  7785
accuracy train: 0.968584 val: 0.769014 test: 0.765898
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({2: 4718, 0: 3216, 1: 2728})

Epoch :  30 loss training:  33.093989610672 Time :  7804
accuracy train: 0.970303 val: 0.760563 test: 0.759989
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({1: 4749, 0: 3184, 2: 2729})

Epoch :  31 loss training:  32.37913651019335 Time :  7821
accuracy train: 0.973429 val: 0.766197 test: 0.762802
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({0: 4718, 2: 3232, 1: 2712})

Epoch :  32 loss training:  30.798313476145267 Time :  7842
accuracy train: 0.979369 val: 0.750704 test: 0.759707
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({0: 4676, 2: 3246, 1: 2740})

Epoch :  33 loss training:  29.59535690397024 Time :  7860
accuracy train: 0.983120 val: 0.760563 test: 0.765335
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({0: 4650, 2: 3286, 1: 2726})

Epoch :  34 loss training:  28.46719765290618 Time :  7879
accuracy train: 0.984214 val: 0.764789 test: 0.762802
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({0: 4622, 1: 3300, 2: 2740})

Epoch :  35 loss training:  27.64765204489231 Time :  7895
accuracy train: 0.986089 val: 0.752113 test: 0.759426
max validation accuracy : 0.777465 max acc epoch : 4 test accuracy : 0.775183
Counter({0: 4600, 1: 3322, 2: 2740})

========================================================================================================================================================================================================
max acc epoch :  4
max validation accuracy :  0.7774647887323943
test accuracy :  0.7751828925154756
last test_accuracy :  0.7594259988745076
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.78592 	 test_accuracy : 0.77209 	 max_acc epoch :  3 	 last test_accuracy : 0.75943
k :  1 	 val_accuracy : 0.77887 	 test_accuracy : 0.77687 	 max_acc epoch :  4 	 last test_accuracy : 0.75718
k :  2 	 val_accuracy : 0.78310 	 test_accuracy : 0.76815 	 max_acc epoch :  31 	 last test_accuracy : 0.76055
k :  3 	 val_accuracy : 0.77465 	 test_accuracy : 0.76252 	 max_acc epoch :  18 	 last test_accuracy : 0.74817
k :  4 	 val_accuracy : 0.78451 	 test_accuracy : 0.77743 	 max_acc epoch :  3 	 last test_accuracy : 0.76083
k :  5 	 val_accuracy : 0.78451 	 test_accuracy : 0.77153 	 max_acc epoch :  5 	 last test_accuracy : 0.76252
k :  6 	 val_accuracy : 0.78592 	 test_accuracy : 0.76477 	 max_acc epoch :  36 	 last test_accuracy : 0.76083
k :  7 	 val_accuracy : 0.78028 	 test_accuracy : 0.77687 	 max_acc epoch :  8 	 last test_accuracy : 0.76280
k :  8 	 val_accuracy : 0.78451 	 test_accuracy : 0.77743 	 max_acc epoch :  4 	 last test_accuracy : 0.76140
k :  9 	 val_accuracy : 0.77746 	 test_accuracy : 0.77518 	 max_acc epoch :  4 	 last test_accuracy : 0.75943

avg :  	 val_accuracy : 0.78197 	 test_accuracy : 0.77228 	 last_accuracy : 0.75931
