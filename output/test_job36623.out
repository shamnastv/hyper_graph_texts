

date and time :  Tue Jun  8 18:14:51 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=592, weight_decay=0)
device :  cuda:0
min_len_of_sentence : 0
max_len_of_sentence : 448
min_num_of_sentence : 1
max_num_of_sentence : 43
average_len_of_sentence: 15.622783101633148
average_num_of_sentence: 4.816668833701729
Total_num_of_sentence : 37045
Counter({'earn': 3923, 'acq': 2292, 'crude': 374, 'trade': 326, 'money-fx': 309, 'interest': 272, 'ship': 144, 'grain': 51})
Total_number_of_words: 7097
Total_number_of_categories: 8
vocab size : 7097
got embeddings of : 6573
Counter({0: 4485, 1: 3206})

Epoch :  1 loss training:  42.3262034188956 Time :  227
accuracy train: 0.956170 val: 0.950909 test: 0.953881
max validation accuracy : 0.950909 max acc epoch : 1 test accuracy : 0.953881
Counter({1: 4494, 0: 3197})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.460685347672552 Time :  279
accuracy train: 0.950515 val: 0.940000 test: 0.956621
max validation accuracy : 0.950909 max acc epoch : 1 test accuracy : 0.953881
Counter({1: 4198, 0: 3493})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  17.705199017073028 Time :  310
accuracy train: 0.962836 val: 0.954545 test: 0.939269
max validation accuracy : 0.954545 max acc epoch : 3 test accuracy : 0.939269
Counter({1: 4501, 0: 3190})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.64779535116395 Time :  343
accuracy train: 0.988083 val: 0.974545 test: 0.966667
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.966667
Counter({0: 4442, 1: 3249})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  7.314397864975035 Time :  384
accuracy train: 0.981014 val: 0.967273 test: 0.952055
max validation accuracy : 0.974545 max acc epoch : 4 test accuracy : 0.966667
Counter({1: 4380, 0: 3311})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  7.071310733444989 Time :  416
accuracy train: 0.989497 val: 0.978182 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 6 test accuracy : 0.969863
Counter({0: 4322, 1: 3369})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  5.107208834735502 Time :  459
accuracy train: 0.992931 val: 0.976364 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 6 test accuracy : 0.969863
Counter({1: 4171, 0: 3520})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  4.685391035338398 Time :  494
accuracy train: 0.995354 val: 0.974545 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 6 test accuracy : 0.969863
Counter({1: 4134, 0: 3557})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  4.361123901268002 Time :  544
accuracy train: 0.995960 val: 0.976364 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 6 test accuracy : 0.969863
Counter({1: 4114, 0: 3577})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  3.3826072903175373 Time :  585
accuracy train: 0.995960 val: 0.970909 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 6 test accuracy : 0.969863
Counter({1: 4114, 0: 3577})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  3.112332719436381 Time :  624
accuracy train: 0.995960 val: 0.972727 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 6 test accuracy : 0.969863
Counter({1: 4117, 0: 3574})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  3.476425979330088 Time :  661
accuracy train: 0.995960 val: 0.972727 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 6 test accuracy : 0.969863
Counter({0: 4115, 1: 3576})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  2.8454718235752807 Time :  718
accuracy train: 0.996162 val: 0.976364 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 6 test accuracy : 0.969863
Counter({0: 4115, 1: 3576})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  2.7050986622925848 Time :  741
accuracy train: 0.996364 val: 0.974545 test: 0.968037
max validation accuracy : 0.978182 max acc epoch : 6 test accuracy : 0.969863
Counter({1: 4113, 0: 3578})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  2.7809143722988665 Time :  760
accuracy train: 0.996162 val: 0.972727 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 6 test accuracy : 0.969863
Counter({0: 4112, 1: 3579})

Epoch :  16 loss training:  2.5810590463370318 Time :  782
accuracy train: 0.996566 val: 0.978182 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 6 test accuracy : 0.969863
Counter({0: 4108, 1: 3583})

Epoch :  17 loss training:  2.6574998581636464 Time :  805
accuracy train: 0.996364 val: 0.974545 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 6 test accuracy : 0.969863
Counter({0: 4102, 1: 3589})

Epoch :  18 loss training:  2.535033594293054 Time :  850
accuracy train: 0.996364 val: 0.972727 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 6 test accuracy : 0.969863
Counter({0: 4095, 1: 3596})

Epoch :  19 loss training:  2.5121059374141623 Time :  871
accuracy train: 0.996162 val: 0.970909 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 6 test accuracy : 0.969863
Counter({0: 4073, 1: 3618})

Epoch :  20 loss training:  2.073125970258843 Time :  896
accuracy train: 0.996364 val: 0.980000 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({1: 4066, 0: 3625})

Epoch :  21 loss training:  2.328853518818505 Time :  918
accuracy train: 0.996566 val: 0.976364 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({0: 4064, 1: 3627})

Epoch :  22 loss training:  2.1661238317738025 Time :  949
accuracy train: 0.996566 val: 0.974545 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({0: 4027, 1: 3664})

Epoch :  23 loss training:  2.172236768543371 Time :  986
accuracy train: 0.996566 val: 0.978182 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({1: 3999, 0: 3692})

Epoch :  24 loss training:  2.274397067289101 Time :  1010
accuracy train: 0.996566 val: 0.972727 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({0: 3944, 1: 3747})

Epoch :  25 loss training:  2.040246578377264 Time :  1032
accuracy train: 0.996768 val: 0.978182 test: 0.970320
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({0: 3944, 1: 3747})

Epoch :  26 loss training:  2.0388864196720533 Time :  1053
accuracy train: 0.996566 val: 0.970909 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({0: 3948, 1: 3743})

Epoch :  27 loss training:  2.101387514208909 Time :  1074
accuracy train: 0.997172 val: 0.974545 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({0: 3947, 1: 3744})

Epoch :  28 loss training:  2.117018168362847 Time :  1096
accuracy train: 0.996768 val: 0.978182 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({0: 3939, 1: 3752})

Epoch :  29 loss training:  1.715846102393698 Time :  1120
accuracy train: 0.996970 val: 0.974545 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({0: 3940, 1: 3751})

Epoch :  30 loss training:  1.96193376359588 Time :  1152
accuracy train: 0.997172 val: 0.972727 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({1: 3946, 0: 3745})

Epoch :  31 loss training:  1.739004180264601 Time :  1175
accuracy train: 0.996768 val: 0.978182 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({1: 3982, 0: 3709})

Epoch :  32 loss training:  1.705892912345007 Time :  1200
accuracy train: 0.996970 val: 0.972727 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({1: 3984, 0: 3707})

Epoch :  33 loss training:  1.6460055548814125 Time :  1223
accuracy train: 0.996970 val: 0.972727 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({0: 3983, 1: 3708})

Epoch :  34 loss training:  1.8405613654249464 Time :  1246
accuracy train: 0.996566 val: 0.978182 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({0: 3987, 1: 3704})

Epoch :  35 loss training:  1.6433573963295203 Time :  1266
accuracy train: 0.997172 val: 0.976364 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({0: 3987, 1: 3704})

Epoch :  36 loss training:  1.56801568672563 Time :  1290
accuracy train: 0.996768 val: 0.972727 test: 0.970320
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({1: 3991, 0: 3700})

Epoch :  37 loss training:  1.5700766918671434 Time :  1313
accuracy train: 0.996768 val: 0.972727 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({0: 3984, 1: 3707})

Epoch :  38 loss training:  1.7404795673101034 Time :  1334
accuracy train: 0.996970 val: 0.976364 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({0: 3984, 1: 3707})

Epoch :  39 loss training:  1.7288895802557818 Time :  1353
accuracy train: 0.996970 val: 0.972727 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({1: 4000, 0: 3691})

Epoch :  40 loss training:  1.7823970760655357 Time :  1374
accuracy train: 0.996768 val: 0.974545 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({0: 4164, 1: 3527})

Epoch :  41 loss training:  1.9810465687914984 Time :  1408
accuracy train: 0.996970 val: 0.972727 test: 0.972603
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({1: 4170, 0: 3521})

Epoch :  42 loss training:  1.564253394674779 Time :  1428
accuracy train: 0.996970 val: 0.970909 test: 0.973516
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({1: 4172, 0: 3519})

Epoch :  43 loss training:  1.4341085105952516 Time :  1449
accuracy train: 0.996970 val: 0.972727 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({1: 4172, 0: 3519})

Epoch :  44 loss training:  1.3675561750642373 Time :  1467
accuracy train: 0.997172 val: 0.970909 test: 0.975342
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({1: 4174, 0: 3517})

Epoch :  45 loss training:  1.6010078779399919 Time :  1493
accuracy train: 0.996970 val: 0.974545 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({1: 4149, 0: 3542})

Epoch :  46 loss training:  1.4978019103036786 Time :  1535
accuracy train: 0.996970 val: 0.970909 test: 0.975342
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({0: 4135, 1: 3556})

Epoch :  47 loss training:  1.2813557450317603 Time :  1566
accuracy train: 0.996970 val: 0.974545 test: 0.975799
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({1: 4128, 0: 3563})

Epoch :  48 loss training:  1.6333966482452524 Time :  1589
accuracy train: 0.997172 val: 0.970909 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({1: 4128, 0: 3563})

Epoch :  49 loss training:  1.4705308415941545 Time :  1612
accuracy train: 0.996970 val: 0.974545 test: 0.971689
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({1: 4112, 0: 3579})

Epoch :  50 loss training:  1.401293793176336 Time :  1635
accuracy train: 0.996970 val: 0.974545 test: 0.970320
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({0: 4100, 1: 3591})

Epoch :  51 loss training:  1.3860126938852773 Time :  1658
accuracy train: 0.996970 val: 0.972727 test: 0.973059
max validation accuracy : 0.980000 max acc epoch : 20 test accuracy : 0.969863
Counter({0: 4100, 1: 3591})

========================================================================================================================================================================================================
max acc epoch :  20
max validation accuracy :  0.98
test accuracy :  0.9698630136986301
last test_accuracy :  0.9730593607305936
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=592, weight_decay=0)
device :  cuda:0
Counter({0: 4485, 1: 3206})

Epoch :  1 loss training:  42.47488164994866 Time :  1700
accuracy train: 0.956776 val: 0.956364 test: 0.956164
max validation accuracy : 0.956364 max acc epoch : 1 test accuracy : 0.956164
Counter({1: 4555, 0: 3136})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.63581109372899 Time :  1730
accuracy train: 0.953141 val: 0.947273 test: 0.962557
max validation accuracy : 0.956364 max acc epoch : 1 test accuracy : 0.956164
Counter({1: 4457, 0: 3234})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.362532505998388 Time :  1750
accuracy train: 0.960412 val: 0.940000 test: 0.936530
max validation accuracy : 0.956364 max acc epoch : 1 test accuracy : 0.956164
Counter({1: 4360, 0: 3331})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.195739793009125 Time :  1773
accuracy train: 0.987679 val: 0.970909 test: 0.967580
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.967580
Counter({0: 4353, 1: 3338})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  7.051966044935398 Time :  1794
accuracy train: 0.988285 val: 0.963636 test: 0.961187
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.967580
Counter({1: 4364, 0: 3327})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  7.145150430616923 Time :  1842
accuracy train: 0.990103 val: 0.974545 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.969863
Counter({1: 4142, 0: 3549})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  4.941770816716598 Time :  1863
accuracy train: 0.993739 val: 0.972727 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.969863
Counter({1: 4088, 0: 3603})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  4.86068132170476 Time :  1883
accuracy train: 0.994951 val: 0.967273 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.969863
Counter({0: 4104, 1: 3587})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  4.517714780988172 Time :  1910
accuracy train: 0.995556 val: 0.974545 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.969863
Counter({1: 4110, 0: 3581})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  3.555936532400665 Time :  1933
accuracy train: 0.995960 val: 0.978182 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({1: 4107, 0: 3584})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  3.0527800941781607 Time :  1954
accuracy train: 0.996162 val: 0.974545 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({0: 4114, 1: 3577})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  3.5617689373757457 Time :  1989
accuracy train: 0.995556 val: 0.970909 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({0: 4103, 1: 3588})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  2.7366149383997254 Time :  2012
accuracy train: 0.995960 val: 0.972727 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({1: 4103, 0: 3588})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  2.7296192264766432 Time :  2048
accuracy train: 0.996162 val: 0.970909 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({1: 4098, 0: 3593})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  2.7312004006817006 Time :  2072
accuracy train: 0.996162 val: 0.976364 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({0: 4099, 1: 3592})

Epoch :  16 loss training:  2.4961059460038086 Time :  2118
accuracy train: 0.996364 val: 0.976364 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({0: 4095, 1: 3596})

Epoch :  17 loss training:  2.471321056873421 Time :  2142
accuracy train: 0.996162 val: 0.972727 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({1: 4097, 0: 3594})

Epoch :  18 loss training:  2.469360638904618 Time :  2162
accuracy train: 0.996162 val: 0.976364 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({0: 4093, 1: 3598})

Epoch :  19 loss training:  2.4303836350991332 Time :  2182
accuracy train: 0.996364 val: 0.974545 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({0: 4029, 1: 3662})

Epoch :  20 loss training:  2.0530837870428513 Time :  2213
accuracy train: 0.996162 val: 0.970909 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({1: 4014, 0: 3677})

Epoch :  21 loss training:  2.1779775808099657 Time :  2235
accuracy train: 0.996162 val: 0.974545 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({0: 4029, 1: 3662})

Epoch :  22 loss training:  2.1515037875378766 Time :  2258
accuracy train: 0.996566 val: 0.972727 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({1: 4023, 0: 3668})

Epoch :  23 loss training:  2.0329068012943026 Time :  2278
accuracy train: 0.996768 val: 0.972727 test: 0.969406
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({1: 4005, 0: 3686})

Epoch :  24 loss training:  2.0890236808918417 Time :  2308
accuracy train: 0.996566 val: 0.970909 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({1: 4011, 0: 3680})

Epoch :  25 loss training:  1.9838968142794329 Time :  2345
accuracy train: 0.996970 val: 0.976364 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({0: 4006, 1: 3685})

Epoch :  26 loss training:  1.9647761966480175 Time :  2374
accuracy train: 0.996970 val: 0.976364 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({0: 4031, 1: 3660})

Epoch :  27 loss training:  1.9268791634822264 Time :  2400
accuracy train: 0.996768 val: 0.976364 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({0: 4014, 1: 3677})

Epoch :  28 loss training:  2.068184758605639 Time :  2419
accuracy train: 0.996970 val: 0.972727 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({0: 3996, 1: 3695})

Epoch :  29 loss training:  1.7831327988096746 Time :  2450
accuracy train: 0.996970 val: 0.978182 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({1: 3997, 0: 3694})

Epoch :  30 loss training:  2.3957892147591338 Time :  2484
accuracy train: 0.996970 val: 0.974545 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({1: 4023, 0: 3668})

Epoch :  31 loss training:  1.7668245064051007 Time :  2507
accuracy train: 0.996970 val: 0.974545 test: 0.968493
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({1: 4079, 0: 3612})

Epoch :  32 loss training:  1.6861023124947678 Time :  2539
accuracy train: 0.996970 val: 0.974545 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({1: 4077, 0: 3614})

Epoch :  33 loss training:  1.5655692961299792 Time :  2562
accuracy train: 0.997172 val: 0.970909 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({0: 4079, 1: 3612})

Epoch :  34 loss training:  1.7994820987223648 Time :  2583
accuracy train: 0.996970 val: 0.974545 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({1: 4091, 0: 3600})

Epoch :  35 loss training:  1.6958980947747477 Time :  2629
accuracy train: 0.996970 val: 0.972727 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({0: 4087, 1: 3604})

Epoch :  36 loss training:  1.5063960877450882 Time :  2659
accuracy train: 0.997172 val: 0.974545 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({0: 4105, 1: 3586})

Epoch :  37 loss training:  1.5747375646969886 Time :  2676
accuracy train: 0.996970 val: 0.974545 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({0: 4097, 1: 3594})

Epoch :  38 loss training:  1.6190701405903383 Time :  2710
accuracy train: 0.996970 val: 0.972727 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({0: 4093, 1: 3598})

Epoch :  39 loss training:  1.9225522250999347 Time :  2730
accuracy train: 0.997172 val: 0.970909 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({0: 4112, 1: 3579})

Epoch :  40 loss training:  1.7315540529452846 Time :  2752
accuracy train: 0.996768 val: 0.974545 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({1: 4411, 0: 3280})

Epoch :  41 loss training:  1.9288268046075245 Time :  2786
accuracy train: 0.996970 val: 0.978182 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 10 test accuracy : 0.972146
Counter({1: 4392, 0: 3299})

========================================================================================================================================================================================================
max acc epoch :  10
max validation accuracy :  0.9781818181818182
test accuracy :  0.9721461187214612
last test_accuracy :  0.9721461187214612
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=592, weight_decay=0)
device :  cuda:0
Counter({0: 4485, 1: 3206})

Epoch :  1 loss training:  42.37159075587988 Time :  2855
accuracy train: 0.955363 val: 0.950909 test: 0.953425
max validation accuracy : 0.950909 max acc epoch : 1 test accuracy : 0.953425
Counter({1: 4548, 0: 3143})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.72150807455182 Time :  2884
accuracy train: 0.950919 val: 0.940000 test: 0.956164
max validation accuracy : 0.950909 max acc epoch : 1 test accuracy : 0.953425
Counter({1: 4444, 0: 3247})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  17.509354553185403 Time :  2908
accuracy train: 0.964250 val: 0.950909 test: 0.945662
max validation accuracy : 0.950909 max acc epoch : 1 test accuracy : 0.953425
Counter({0: 3994, 1: 3697})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.595712126116268 Time :  2926
accuracy train: 0.988083 val: 0.970909 test: 0.969406
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.969406
Counter({0: 3922, 1: 3769})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  7.578337199054658 Time :  2945
accuracy train: 0.984448 val: 0.970909 test: 0.955251
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.969406
Counter({1: 3997, 0: 3694})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  7.734186669695191 Time :  2965
accuracy train: 0.990709 val: 0.974545 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.972146
Counter({0: 4015, 1: 3676})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  5.175935538805788 Time :  2983
accuracy train: 0.992123 val: 0.976364 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3926, 0: 3765})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  4.723283007158898 Time :  3001
accuracy train: 0.994749 val: 0.972727 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.971689
Counter({0: 3920, 1: 3771})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  4.444315221218858 Time :  3022
accuracy train: 0.994951 val: 0.974545 test: 0.970776
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.971689
Counter({0: 3872, 1: 3819})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  3.587143816286698 Time :  3047
accuracy train: 0.995556 val: 0.970909 test: 0.973973
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.971689
Counter({0: 3869, 1: 3822})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  3.1964426550548524 Time :  3065
accuracy train: 0.995758 val: 0.976364 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.971689
Counter({0: 3904, 1: 3787})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  3.4791507557820296 Time :  3083
accuracy train: 0.995354 val: 0.972727 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3874, 0: 3817})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  2.9077453683685235 Time :  3101
accuracy train: 0.995556 val: 0.972727 test: 0.971689
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.971689
Counter({0: 3874, 1: 3817})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  2.8003025992948096 Time :  3131
accuracy train: 0.996162 val: 0.972727 test: 0.971233
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3871, 0: 3820})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  2.892125257756561 Time :  3152
accuracy train: 0.996364 val: 0.974545 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3870, 0: 3821})

Epoch :  16 loss training:  2.6484254517708905 Time :  3171
accuracy train: 0.996970 val: 0.976364 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.971689
Counter({0: 3870, 1: 3821})

Epoch :  17 loss training:  2.578214499997557 Time :  3195
accuracy train: 0.996364 val: 0.974545 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.971689
Counter({0: 3874, 1: 3817})

Epoch :  18 loss training:  2.4957086844951846 Time :  3214
accuracy train: 0.996364 val: 0.976364 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.971689
Counter({0: 3876, 1: 3815})

Epoch :  19 loss training:  2.64254461559176 Time :  3244
accuracy train: 0.996162 val: 0.974545 test: 0.972146
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.971689
Counter({0: 3876, 1: 3815})

Epoch :  20 loss training:  2.151986853030394 Time :  3266
accuracy train: 0.996364 val: 0.976364 test: 0.973516
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.971689
Counter({1: 3876, 0: 3815})

Epoch :  21 loss training:  2.387915413157316 Time :  3284
accuracy train: 0.996768 val: 0.969091 test: 0.973059
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.971689
Counter({0: 3873, 1: 3818})

Epoch :  22 loss training:  2.3578275321324327 Time :  3303
accuracy train: 0.996768 val: 0.974545 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.971689
Counter({0: 3871, 1: 3820})

Epoch :  23 loss training:  2.230320916423807 Time :  3332
accuracy train: 0.996768 val: 0.978182 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({0: 3869, 1: 3822})

Epoch :  24 loss training:  2.2500544666836504 Time :  3351
accuracy train: 0.996768 val: 0.970909 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({1: 3868, 0: 3823})

Epoch :  25 loss training:  2.072901793231722 Time :  3373
accuracy train: 0.996768 val: 0.976364 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({0: 3860, 1: 3831})

Epoch :  26 loss training:  2.0820769623242086 Time :  3403
accuracy train: 0.996768 val: 0.972727 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({0: 3860, 1: 3831})

Epoch :  27 loss training:  2.1149440599256195 Time :  3422
accuracy train: 0.996970 val: 0.976364 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({0: 3865, 1: 3826})

Epoch :  28 loss training:  2.30663184011064 Time :  3443
accuracy train: 0.996768 val: 0.978182 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({1: 3857, 0: 3834})

Epoch :  29 loss training:  1.9200425235321745 Time :  3473
accuracy train: 0.996768 val: 0.976364 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({0: 3859, 1: 3832})

Epoch :  30 loss training:  2.302623136813054 Time :  3494
accuracy train: 0.996768 val: 0.974545 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({1: 3858, 0: 3833})

Epoch :  31 loss training:  1.6669884944931255 Time :  3514
accuracy train: 0.996970 val: 0.972727 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({1: 3866, 0: 3825})

Epoch :  32 loss training:  1.7732363683462609 Time :  3535
accuracy train: 0.997172 val: 0.974545 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({0: 3869, 1: 3822})

Epoch :  33 loss training:  1.7280009501700988 Time :  3562
accuracy train: 0.997172 val: 0.972727 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({1: 3871, 0: 3820})

Epoch :  34 loss training:  1.9345277634056401 Time :  3581
accuracy train: 0.996970 val: 0.976364 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({1: 3872, 0: 3819})

Epoch :  35 loss training:  1.687662993936101 Time :  3603
accuracy train: 0.996970 val: 0.972727 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({0: 3867, 1: 3824})

Epoch :  36 loss training:  1.6136448466204456 Time :  3630
accuracy train: 0.996970 val: 0.972727 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({1: 3877, 0: 3814})

Epoch :  37 loss training:  1.5614531553037523 Time :  3650
accuracy train: 0.997172 val: 0.976364 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({0: 3877, 1: 3814})

Epoch :  38 loss training:  1.676773930892523 Time :  3670
accuracy train: 0.996970 val: 0.974545 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({0: 3880, 1: 3811})

Epoch :  39 loss training:  2.060454385718913 Time :  3693
accuracy train: 0.996970 val: 0.972727 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({1: 3945, 0: 3746})

Epoch :  40 loss training:  1.8018862669450755 Time :  3713
accuracy train: 0.996768 val: 0.970909 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({1: 4151, 0: 3540})

Epoch :  41 loss training:  1.9954147853932227 Time :  3743
accuracy train: 0.996970 val: 0.974545 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({1: 4101, 0: 3590})

Epoch :  42 loss training:  1.5968264333887419 Time :  3763
accuracy train: 0.996768 val: 0.969091 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({0: 4095, 1: 3596})

Epoch :  43 loss training:  1.4870829781211796 Time :  3782
accuracy train: 0.996768 val: 0.972727 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({0: 4056, 1: 3635})

Epoch :  44 loss training:  1.4427022406016476 Time :  3804
accuracy train: 0.997374 val: 0.970909 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({0: 4053, 1: 3638})

Epoch :  45 loss training:  1.6001094933599234 Time :  3828
accuracy train: 0.996768 val: 0.969091 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({0: 4068, 1: 3623})

Epoch :  46 loss training:  1.6758403383937548 Time :  3861
accuracy train: 0.996970 val: 0.972727 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({1: 4066, 0: 3625})

Epoch :  47 loss training:  1.2579527446196153 Time :  3881
accuracy train: 0.996970 val: 0.965455 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({0: 4047, 1: 3644})

Epoch :  48 loss training:  1.6194136662088567 Time :  3913
accuracy train: 0.997172 val: 0.978182 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({1: 4068, 0: 3623})

Epoch :  49 loss training:  1.4596427948235942 Time :  3938
accuracy train: 0.997172 val: 0.978182 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({0: 4072, 1: 3619})

Epoch :  50 loss training:  1.3438986921813694 Time :  3958
accuracy train: 0.997374 val: 0.972727 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({1: 4034, 0: 3657})

Epoch :  51 loss training:  1.3183118939996348 Time :  3985
accuracy train: 0.996970 val: 0.972727 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({0: 4072, 1: 3619})

Epoch :  52 loss training:  1.3714545574621297 Time :  4006
accuracy train: 0.997172 val: 0.976364 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({0: 4108, 1: 3583})

Epoch :  53 loss training:  1.6380472300406836 Time :  4026
accuracy train: 0.997374 val: 0.978182 test: 0.974429
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({0: 4109, 1: 3582})

Epoch :  54 loss training:  1.3965543685390003 Time :  4053
accuracy train: 0.997172 val: 0.972727 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 23 test accuracy : 0.973516
Counter({0: 4089, 1: 3602})

========================================================================================================================================================================================================
max acc epoch :  23
max validation accuracy :  0.9781818181818182
test accuracy :  0.9735159817351599
last test_accuracy :  0.9721461187214612
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=592, weight_decay=0)
device :  cuda:0
Counter({0: 4485, 1: 3206})

Epoch :  1 loss training:  42.44288844522089 Time :  4124
accuracy train: 0.955565 val: 0.952727 test: 0.955708
max validation accuracy : 0.952727 max acc epoch : 1 test accuracy : 0.955708
Counter({1: 4555, 0: 3136})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.82704276405275 Time :  4143
accuracy train: 0.945264 val: 0.938182 test: 0.951598
max validation accuracy : 0.952727 max acc epoch : 1 test accuracy : 0.955708
Counter({1: 4473, 0: 3218})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  17.46151171636302 Time :  4169
accuracy train: 0.968289 val: 0.954545 test: 0.959361
max validation accuracy : 0.954545 max acc epoch : 3 test accuracy : 0.959361
Counter({1: 3882, 0: 3809})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.030202649417333 Time :  4187
accuracy train: 0.988689 val: 0.969091 test: 0.970320
max validation accuracy : 0.969091 max acc epoch : 4 test accuracy : 0.970320
Counter({0: 3905, 1: 3786})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  7.499079124187119 Time :  4206
accuracy train: 0.987679 val: 0.970909 test: 0.960274
max validation accuracy : 0.970909 max acc epoch : 5 test accuracy : 0.960274
Counter({0: 3912, 1: 3779})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  7.190046426607296 Time :  4232
accuracy train: 0.990709 val: 0.974545 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 6 test accuracy : 0.970776
Counter({0: 3898, 1: 3793})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  5.112648648471804 Time :  4254
accuracy train: 0.992527 val: 0.976364 test: 0.972603
max validation accuracy : 0.976364 max acc epoch : 7 test accuracy : 0.972603
Counter({0: 3898, 1: 3793})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  5.023716716154013 Time :  4278
accuracy train: 0.994345 val: 0.978182 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({1: 3885, 0: 3806})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  4.638663313322468 Time :  4296
accuracy train: 0.995354 val: 0.972727 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({1: 3885, 0: 3806})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  3.6209771619469393 Time :  4328
accuracy train: 0.995960 val: 0.976364 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({1: 3885, 0: 3806})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  3.303150703985011 Time :  4355
accuracy train: 0.995758 val: 0.972727 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({0: 3883, 1: 3808})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  3.654255265952088 Time :  4373
accuracy train: 0.995758 val: 0.976364 test: 0.973059
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({0: 3888, 1: 3803})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  2.8951998087140964 Time :  4394
accuracy train: 0.995758 val: 0.972727 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({0: 3886, 1: 3805})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  2.8146424295846373 Time :  4421
accuracy train: 0.996162 val: 0.974545 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({0: 3888, 1: 3803})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  2.857884831231786 Time :  4440
accuracy train: 0.996364 val: 0.974545 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({0: 3890, 1: 3801})

Epoch :  16 loss training:  2.6445181772578508 Time :  4462
accuracy train: 0.996970 val: 0.976364 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({1: 3888, 0: 3803})

Epoch :  17 loss training:  2.474586454380187 Time :  4489
accuracy train: 0.996364 val: 0.974545 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({1: 3878, 0: 3813})

Epoch :  18 loss training:  2.535708666560822 Time :  4507
accuracy train: 0.996364 val: 0.974545 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({0: 3879, 1: 3812})

Epoch :  19 loss training:  2.5968471845044405 Time :  4536
accuracy train: 0.996566 val: 0.969091 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({0: 3878, 1: 3813})

Epoch :  20 loss training:  2.1235304113033635 Time :  4557
accuracy train: 0.996364 val: 0.976364 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({0: 3881, 1: 3810})

Epoch :  21 loss training:  2.3981190234189853 Time :  4574
accuracy train: 0.996364 val: 0.974545 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({0: 3882, 1: 3809})

Epoch :  22 loss training:  2.324107346286837 Time :  4600
accuracy train: 0.996162 val: 0.972727 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({1: 3885, 0: 3806})

Epoch :  23 loss training:  2.2102186017727945 Time :  4626
accuracy train: 0.996364 val: 0.974545 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({1: 3884, 0: 3807})

Epoch :  24 loss training:  2.2099374606914353 Time :  4646
accuracy train: 0.996566 val: 0.974545 test: 0.972146
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({0: 3884, 1: 3807})

Epoch :  25 loss training:  2.035875582063454 Time :  4664
accuracy train: 0.996970 val: 0.970909 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({1: 3886, 0: 3805})

Epoch :  26 loss training:  2.047201815294102 Time :  4685
accuracy train: 0.996970 val: 0.969091 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({1: 3885, 0: 3806})

Epoch :  27 loss training:  2.1210961785982363 Time :  4714
accuracy train: 0.996768 val: 0.970909 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({0: 3886, 1: 3805})

Epoch :  28 loss training:  2.1651583745078824 Time :  4733
accuracy train: 0.996970 val: 0.978182 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({0: 3899, 1: 3792})

Epoch :  29 loss training:  1.8413567664392758 Time :  4753
accuracy train: 0.997172 val: 0.972727 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({0: 3896, 1: 3795})

Epoch :  30 loss training:  2.7623557009501383 Time :  4781
accuracy train: 0.996970 val: 0.972727 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({0: 3891, 1: 3800})

Epoch :  31 loss training:  1.6906778406155354 Time :  4800
accuracy train: 0.996768 val: 0.970909 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({1: 3890, 0: 3801})

Epoch :  32 loss training:  1.7064830379531486 Time :  4829
accuracy train: 0.996970 val: 0.970909 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({0: 3886, 1: 3805})

Epoch :  33 loss training:  1.700150445831241 Time :  4848
accuracy train: 0.996768 val: 0.967273 test: 0.971689
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({1: 3874, 0: 3817})

Epoch :  34 loss training:  1.9637206012776005 Time :  4868
accuracy train: 0.996970 val: 0.972727 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({0: 3873, 1: 3818})

Epoch :  35 loss training:  1.6612849087978248 Time :  4890
accuracy train: 0.996970 val: 0.970909 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({0: 3876, 1: 3815})

Epoch :  36 loss training:  1.6079700257905643 Time :  4922
accuracy train: 0.996970 val: 0.967273 test: 0.972603
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({0: 3874, 1: 3817})

Epoch :  37 loss training:  1.5506299139960902 Time :  4942
accuracy train: 0.996970 val: 0.969091 test: 0.973973
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({1: 3870, 0: 3821})

Epoch :  38 loss training:  1.7845538439505617 Time :  4960
accuracy train: 0.996970 val: 0.970909 test: 0.970776
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({1: 3869, 0: 3822})

Epoch :  39 loss training:  1.8852866215383983 Time :  4988
accuracy train: 0.996970 val: 0.970909 test: 0.973516
max validation accuracy : 0.978182 max acc epoch : 8 test accuracy : 0.972603
Counter({0: 3870, 1: 3821})

========================================================================================================================================================================================================
max acc epoch :  8
max validation accuracy :  0.9781818181818182
test accuracy :  0.9726027397260274
last test_accuracy :  0.9735159817351599
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=2, num_layers=3, num_mlp_layers=1, random_vec=False, seed=592, weight_decay=0)
device :  cuda:0
Counter({0: 4485, 1: 3206})

Epoch :  1 loss training:  42.45667575672269 Time :  5012
accuracy train: 0.954353 val: 0.954545 test: 0.955251
max validation accuracy : 0.954545 max acc epoch : 1 test accuracy : 0.955251
Counter({1: 4555, 0: 3136})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.352825633483008 Time :  5031
accuracy train: 0.964250 val: 0.956364 test: 0.965753
max validation accuracy : 0.956364 max acc epoch : 2 test accuracy : 0.965753
Counter({0: 4497, 1: 3194})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.813616276020184 Time :  5048
accuracy train: 0.961422 val: 0.952727 test: 0.943379
max validation accuracy : 0.956364 max acc epoch : 2 test accuracy : 0.965753
Counter({0: 4502, 1: 3189})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.076274076884147 Time :  5075
accuracy train: 0.989093 val: 0.972727 test: 0.965297
max validation accuracy : 0.972727 max acc epoch : 4 test accuracy : 0.965297
Counter({0: 4463, 1: 3228})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  6.960811675991863 Time :  5093
accuracy train: 0.988689 val: 0.970909 test: 0.958447
max validation accuracy : 0.972727 max acc epoch : 4 test accuracy : 0.965297
Counter({1: 4258, 0: 3433})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  7.35943721680087 Time :  5116
accuracy train: 0.989497 val: 0.970909 test: 0.968493
max validation accuracy : 0.972727 max acc epoch : 4 test accuracy : 0.965297
Counter({1: 4135, 0: 3556})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  4.945709997933591 Time :  5136
accuracy train: 0.992527 val: 0.969091 test: 0.973516
max validation accuracy : 0.972727 max acc epoch : 4 test accuracy : 0.965297
Counter({0: 4048, 1: 3643})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  4.380996638647048 Time :  5155
accuracy train: 0.993739 val: 0.974545 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({0: 4052, 1: 3639})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  4.485326171532506 Time :  5186
accuracy train: 0.995556 val: 0.970909 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({0: 4023, 1: 3668})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  3.3935711729864124 Time :  5204
accuracy train: 0.995758 val: 0.972727 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({1: 4107, 0: 3584})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  3.0719870129833 Time :  5234
accuracy train: 0.995556 val: 0.970909 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({1: 4130, 0: 3561})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  3.602367652551038 Time :  5253
accuracy train: 0.995758 val: 0.972727 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({0: 4133, 1: 3558})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  2.74020180383377 Time :  5274
accuracy train: 0.995960 val: 0.970909 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({0: 4134, 1: 3557})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  2.6510713736061007 Time :  5305
accuracy train: 0.995960 val: 0.970909 test: 0.968493
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({1: 4121, 0: 3570})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  2.5641326374025084 Time :  5324
accuracy train: 0.996162 val: 0.972727 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({0: 4120, 1: 3571})

Epoch :  16 loss training:  2.5092120468325447 Time :  5358
accuracy train: 0.996162 val: 0.972727 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({0: 4117, 1: 3574})

Epoch :  17 loss training:  2.354904712905409 Time :  5377
accuracy train: 0.996162 val: 0.965455 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({1: 4117, 0: 3574})

Epoch :  18 loss training:  2.3106913670926588 Time :  5395
accuracy train: 0.996364 val: 0.972727 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({0: 4117, 1: 3574})

Epoch :  19 loss training:  2.5108468674807227 Time :  5426
accuracy train: 0.996566 val: 0.969091 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({0: 4105, 1: 3586})

Epoch :  20 loss training:  2.0337591654642893 Time :  5444
accuracy train: 0.995960 val: 0.972727 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({1: 4101, 0: 3590})

Epoch :  21 loss training:  2.271978173375828 Time :  5477
accuracy train: 0.996566 val: 0.967273 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({0: 4102, 1: 3589})

Epoch :  22 loss training:  2.1366127703531674 Time :  5497
accuracy train: 0.996970 val: 0.972727 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({0: 4099, 1: 3592})

Epoch :  23 loss training:  2.1388394906389294 Time :  5514
accuracy train: 0.996970 val: 0.969091 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({1: 4096, 0: 3595})

Epoch :  24 loss training:  2.009042194324138 Time :  5548
accuracy train: 0.996768 val: 0.967273 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({0: 4094, 1: 3597})

Epoch :  25 loss training:  1.8717233788993326 Time :  5567
accuracy train: 0.997172 val: 0.967273 test: 0.972603
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({1: 4091, 0: 3600})

Epoch :  26 loss training:  1.950947336255922 Time :  5592
accuracy train: 0.996768 val: 0.967273 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({0: 4095, 1: 3596})

Epoch :  27 loss training:  1.962750220176531 Time :  5610
accuracy train: 0.996970 val: 0.965455 test: 0.974886
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({1: 4096, 0: 3595})

Epoch :  28 loss training:  2.0053761808012496 Time :  5637
accuracy train: 0.996970 val: 0.970909 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({0: 4079, 1: 3612})

Epoch :  29 loss training:  1.713383429509122 Time :  5656
accuracy train: 0.996970 val: 0.969091 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({0: 4087, 1: 3604})

Epoch :  30 loss training:  2.278861134152976 Time :  5677
accuracy train: 0.996970 val: 0.969091 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({1: 4097, 0: 3594})

Epoch :  31 loss training:  1.6909951448324136 Time :  5708
accuracy train: 0.996970 val: 0.972727 test: 0.967580
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({1: 4104, 0: 3587})

Epoch :  32 loss training:  1.670612288362463 Time :  5728
accuracy train: 0.996970 val: 0.967273 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({1: 4104, 0: 3587})

Epoch :  33 loss training:  1.6083048839427647 Time :  5755
accuracy train: 0.996970 val: 0.967273 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({0: 4109, 1: 3582})

Epoch :  34 loss training:  1.7508027443327592 Time :  5775
accuracy train: 0.996970 val: 0.967273 test: 0.973059
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({0: 4116, 1: 3575})

Epoch :  35 loss training:  1.6038046144749387 Time :  5807
accuracy train: 0.996970 val: 0.970909 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({0: 4125, 1: 3566})

Epoch :  36 loss training:  1.4925083113339497 Time :  5829
accuracy train: 0.996970 val: 0.967273 test: 0.970320
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({1: 4143, 0: 3548})

Epoch :  37 loss training:  1.608219709189143 Time :  5858
accuracy train: 0.996970 val: 0.970909 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({0: 4141, 1: 3550})

Epoch :  38 loss training:  1.630636494661303 Time :  5891
accuracy train: 0.996970 val: 0.970909 test: 0.970776
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({0: 4146, 1: 3545})

Epoch :  39 loss training:  1.8502052309850114 Time :  5913
accuracy train: 0.996970 val: 0.967273 test: 0.975342
max validation accuracy : 0.974545 max acc epoch : 8 test accuracy : 0.968950
Counter({0: 4196, 1: 3495})

========================================================================================================================================================================================================
max acc epoch :  8
max validation accuracy :  0.9745454545454545
test accuracy :  0.9689497716894977
last test_accuracy :  0.9753424657534246
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.98000 	 test_accuracy : 0.96986 	 max_acc epoch :  20 	 last test_accuracy : 0.97306
k :  1 	 val_accuracy : 0.97818 	 test_accuracy : 0.97215 	 max_acc epoch :  10 	 last test_accuracy : 0.97215
k :  2 	 val_accuracy : 0.97818 	 test_accuracy : 0.97352 	 max_acc epoch :  23 	 last test_accuracy : 0.97215
k :  3 	 val_accuracy : 0.97818 	 test_accuracy : 0.97260 	 max_acc epoch :  8 	 last test_accuracy : 0.97352
k :  4 	 val_accuracy : 0.97455 	 test_accuracy : 0.96895 	 max_acc epoch :  8 	 last test_accuracy : 0.97534

avg :  	 val_accuracy : 0.97782 	 test_accuracy : 0.97142 	 last_accuracy : 0.97324
