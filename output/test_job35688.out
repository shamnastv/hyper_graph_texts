

date and time :  Sat Jun  5 01:49:31 2021
itr : 0
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=5, num_layers=3, num_mlp_layers=1, random_vec=False, seed=926, weight_decay=0)
device :  cuda:0
Counter({2: 3108, 1: 2523, 0: 2322, 3: 1128, 4: 49})

Epoch :  1 loss training:  126.16864031553268 Time :  31
accuracy train: 0.903117 val: 0.907012 test: 0.890661
max validation accuracy : 0.907012 max acc epoch : 1 test accuracy : 0.890661
Counter({1: 3421, 3: 2138, 2: 1349, 0: 1183, 4: 1039})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  55.160321801900864 Time :  74
accuracy train: 0.945630 val: 0.939024 test: 0.916732
max validation accuracy : 0.939024 max acc epoch : 2 test accuracy : 0.916732
Counter({0: 3638, 1: 2385, 2: 1129, 3: 1025, 4: 953})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  39.24972439929843 Time :  126
accuracy train: 0.951389 val: 0.939024 test: 0.925292
max validation accuracy : 0.939024 max acc epoch : 2 test accuracy : 0.916732
Counter({0: 3694, 3: 2356, 1: 1070, 2: 1068, 4: 942})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  26.73579457961023 Time :  160
accuracy train: 0.970020 val: 0.949695 test: 0.938132
max validation accuracy : 0.949695 max acc epoch : 4 test accuracy : 0.938132
Counter({0: 3762, 3: 2393, 4: 1113, 2: 1053, 1: 809})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  23.358464380726218 Time :  194
accuracy train: 0.971206 val: 0.954268 test: 0.933074
max validation accuracy : 0.954268 max acc epoch : 5 test accuracy : 0.933074
Counter({2: 3766, 1: 2412, 3: 1161, 4: 1088, 0: 703})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  20.620276488829404 Time :  227
accuracy train: 0.976965 val: 0.949695 test: 0.933852
max validation accuracy : 0.954268 max acc epoch : 5 test accuracy : 0.933074
Counter({1: 3810, 2: 2366, 3: 1230, 0: 1071, 4: 653})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  16.47711468487978 Time :  286
accuracy train: 0.980014 val: 0.955793 test: 0.942412
max validation accuracy : 0.955793 max acc epoch : 7 test accuracy : 0.942412
Counter({1: 3816, 2: 2371, 4: 1264, 0: 1058, 3: 621})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  14.113585233688354 Time :  320
accuracy train: 0.985264 val: 0.963415 test: 0.936187
max validation accuracy : 0.963415 max acc epoch : 8 test accuracy : 0.936187
Counter({2: 3788, 0: 2396, 3: 1260, 4: 1060, 1: 626})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  12.816076298244298 Time :  353
accuracy train: 0.985095 val: 0.957317 test: 0.942802
max validation accuracy : 0.963415 max acc epoch : 8 test accuracy : 0.936187
Counter({1: 3790, 4: 2397, 2: 1267, 3: 1060, 0: 616})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  12.02268435060978 Time :  385
accuracy train: 0.988313 val: 0.960366 test: 0.943969
max validation accuracy : 0.963415 max acc epoch : 8 test accuracy : 0.936187
Counter({2: 3798, 1: 2393, 3: 1267, 0: 1059, 4: 613})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  11.492135636508465 Time :  426
accuracy train: 0.989668 val: 0.963415 test: 0.948249
max validation accuracy : 0.963415 max acc epoch : 8 test accuracy : 0.936187
Counter({1: 3799, 0: 2399, 4: 1265, 3: 1056, 2: 611})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  10.591730179730803 Time :  474
accuracy train: 0.988991 val: 0.961890 test: 0.943580
max validation accuracy : 0.963415 max acc epoch : 8 test accuracy : 0.936187
Counter({1: 3804, 0: 2395, 2: 1266, 3: 1055, 4: 610})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  9.566801299341023 Time :  511
accuracy train: 0.990854 val: 0.964939 test: 0.944358
max validation accuracy : 0.964939 max acc epoch : 13 test accuracy : 0.944358
Counter({2: 3803, 3: 2396, 1: 1271, 0: 1052, 4: 608})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  9.291435489896685 Time :  547
accuracy train: 0.991870 val: 0.961890 test: 0.947860
max validation accuracy : 0.964939 max acc epoch : 13 test accuracy : 0.944358
Counter({2: 3806, 1: 2393, 3: 1277, 0: 1051, 4: 603})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  9.607488058507442 Time :  587
accuracy train: 0.989329 val: 0.961890 test: 0.948249
max validation accuracy : 0.964939 max acc epoch : 13 test accuracy : 0.944358
Counter({3: 3808, 0: 2390, 2: 1274, 1: 1053, 4: 605})
Epoch-15 lr: 3.125e-05

Epoch :  16 loss training:  8.78628517407924 Time :  657
accuracy train: 0.991531 val: 0.969512 test: 0.946693
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({0: 3809, 1: 2390, 3: 1273, 2: 1054, 4: 604})
Epoch-16 lr: 3.125e-05

Epoch :  17 loss training:  8.659134175628424 Time :  695
accuracy train: 0.992209 val: 0.961890 test: 0.947471
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({4: 3815, 3: 2389, 1: 1269, 2: 1055, 0: 602})
Epoch-17 lr: 3.125e-05

Epoch :  18 loss training:  8.47162033803761 Time :  740
accuracy train: 0.991531 val: 0.963415 test: 0.948249
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({1: 3815, 0: 2389, 4: 1269, 3: 1054, 2: 603})
Epoch-18 lr: 1.5625e-05

Epoch :  19 loss training:  8.101176904281601 Time :  787
accuracy train: 0.992209 val: 0.966463 test: 0.946693
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({1: 3816, 2: 2389, 4: 1269, 3: 1052, 0: 604})
Epoch-19 lr: 1.5625e-05

Epoch :  20 loss training:  8.315475910436362 Time :  845
accuracy train: 0.992378 val: 0.966463 test: 0.945914
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({0: 3818, 1: 2387, 3: 1270, 2: 1051, 4: 604})

Epoch :  21 loss training:  7.813302179798484 Time :  880
accuracy train: 0.992378 val: 0.966463 test: 0.945914
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({2: 3819, 3: 2387, 1: 1266, 4: 1052, 0: 606})

Epoch :  22 loss training:  7.951711596455425 Time :  918
accuracy train: 0.992039 val: 0.967988 test: 0.945525
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({0: 3819, 4: 2387, 1: 1264, 2: 1054, 3: 606})

Epoch :  23 loss training:  8.091933979652822 Time :  954
accuracy train: 0.992378 val: 0.967988 test: 0.947082
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({0: 3820, 1: 2386, 4: 1269, 2: 1052, 3: 603})

Epoch :  24 loss training:  8.290904609719291 Time :  1005
accuracy train: 0.992717 val: 0.966463 test: 0.947082
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({1: 3823, 0: 2384, 3: 1269, 2: 1051, 4: 603})

Epoch :  25 loss training:  7.870191866997629 Time :  1039
accuracy train: 0.993056 val: 0.964939 test: 0.945914
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({0: 3825, 1: 2382, 2: 1271, 4: 1051, 3: 601})

Epoch :  26 loss training:  7.260549435857683 Time :  1087
accuracy train: 0.992378 val: 0.964939 test: 0.947082
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({2: 3827, 0: 2380, 4: 1269, 1: 1053, 3: 601})

Epoch :  27 loss training:  7.816726055461913 Time :  1131
accuracy train: 0.993056 val: 0.966463 test: 0.950973
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({0: 3826, 1: 2381, 3: 1268, 4: 1053, 2: 602})

Epoch :  28 loss training:  7.527290200581774 Time :  1191
accuracy train: 0.993056 val: 0.963415 test: 0.946693
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({1: 3829, 2: 2380, 0: 1266, 3: 1053, 4: 602})

Epoch :  29 loss training:  7.449711130000651 Time :  1231
accuracy train: 0.993056 val: 0.966463 test: 0.948638
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({2: 3830, 4: 2379, 1: 1268, 0: 1052, 3: 601})

Epoch :  30 loss training:  7.483954939059913 Time :  1276
accuracy train: 0.993225 val: 0.966463 test: 0.947471
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({2: 3831, 3: 2378, 1: 1269, 0: 1051, 4: 601})

Epoch :  31 loss training:  7.538580175489187 Time :  1321
accuracy train: 0.993225 val: 0.966463 test: 0.946304
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({0: 3833, 3: 2377, 4: 1271, 2: 1049, 1: 600})

Epoch :  32 loss training:  7.17785766068846 Time :  1373
accuracy train: 0.993394 val: 0.966463 test: 0.947471
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({0: 3834, 3: 2377, 4: 1270, 2: 1049, 1: 600})

Epoch :  33 loss training:  6.957117473240942 Time :  1419
accuracy train: 0.993394 val: 0.969512 test: 0.949416
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({1: 3837, 0: 2375, 2: 1268, 4: 1051, 3: 599})

Epoch :  34 loss training:  7.266955244820565 Time :  1452
accuracy train: 0.993225 val: 0.963415 test: 0.949027
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({1: 3838, 3: 2374, 0: 1269, 4: 1051, 2: 598})

Epoch :  35 loss training:  7.19187484565191 Time :  1484
accuracy train: 0.993902 val: 0.963415 test: 0.949416
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({0: 3838, 1: 2374, 2: 1271, 4: 1049, 3: 598})

Epoch :  36 loss training:  6.971478789811954 Time :  1520
accuracy train: 0.993394 val: 0.964939 test: 0.949416
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({1: 3838, 2: 2374, 0: 1271, 4: 1048, 3: 599})

Epoch :  37 loss training:  6.94551872368902 Time :  1574
accuracy train: 0.993733 val: 0.963415 test: 0.947860
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({0: 3839, 2: 2372, 3: 1271, 1: 1049, 4: 599})

Epoch :  38 loss training:  6.563397589838132 Time :  1603
accuracy train: 0.993902 val: 0.964939 test: 0.948638
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({1: 3839, 2: 2372, 0: 1269, 3: 1049, 4: 601})

Epoch :  39 loss training:  6.789117250358686 Time :  1638
accuracy train: 0.993733 val: 0.966463 test: 0.948249
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({2: 3841, 0: 2370, 3: 1269, 4: 1049, 1: 601})

Epoch :  40 loss training:  6.490177785744891 Time :  1675
accuracy train: 0.993394 val: 0.964939 test: 0.947860
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({1: 3841, 2: 2371, 0: 1269, 3: 1049, 4: 600})

Epoch :  41 loss training:  6.382243224885315 Time :  1725
accuracy train: 0.993394 val: 0.963415 test: 0.948638
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({1: 3843, 3: 2369, 2: 1270, 4: 1049, 0: 599})

Epoch :  42 loss training:  6.5282121687196195 Time :  1758
accuracy train: 0.993902 val: 0.964939 test: 0.947860
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({1: 3843, 0: 2369, 3: 1270, 2: 1049, 4: 599})

Epoch :  43 loss training:  6.533544033300132 Time :  1792
accuracy train: 0.994241 val: 0.961890 test: 0.946693
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({4: 3843, 3: 2369, 2: 1268, 0: 1049, 1: 601})

Epoch :  44 loss training:  6.679219044744968 Time :  1827
accuracy train: 0.994072 val: 0.964939 test: 0.947860
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({1: 3843, 2: 2370, 4: 1268, 0: 1049, 3: 600})

Epoch :  45 loss training:  6.126713290344924 Time :  1873
accuracy train: 0.994411 val: 0.964939 test: 0.947860
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({1: 3843, 3: 2370, 4: 1268, 2: 1049, 0: 600})

Epoch :  46 loss training:  6.339364780345932 Time :  1910
accuracy train: 0.994072 val: 0.964939 test: 0.949416
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({1: 3844, 2: 2369, 0: 1268, 4: 1049, 3: 600})

Epoch :  47 loss training:  6.65881978161633 Time :  1946
accuracy train: 0.993733 val: 0.966463 test: 0.945136
max validation accuracy : 0.969512 max acc epoch : 16 test accuracy : 0.946693
Counter({0: 3846, 1: 2368, 4: 1268, 3: 1049, 2: 599})

========================================================================================================================================================================================================
max acc epoch :  16
max validation accuracy :  0.9695121951219512
test accuracy :  0.946692607003891
last test_accuracy :  0.945136186770428
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=5, num_layers=3, num_mlp_layers=1, random_vec=False, seed=926, weight_decay=0)
device :  cuda:0
Counter({2: 3108, 1: 2523, 0: 2322, 3: 1128, 4: 49})

Epoch :  1 loss training:  126.22688303887844 Time :  2022
accuracy train: 0.903455 val: 0.910061 test: 0.889883
max validation accuracy : 0.910061 max acc epoch : 1 test accuracy : 0.889883
Counter({4: 3062, 1: 2243, 0: 1740, 2: 1146, 3: 939})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  54.987216621637344 Time :  2072
accuracy train: 0.946308 val: 0.942073 test: 0.918677
max validation accuracy : 0.942073 max acc epoch : 2 test accuracy : 0.918677
Counter({3: 2881, 1: 2308, 2: 1698, 4: 1152, 0: 1091})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  39.393689304590225 Time :  2112
accuracy train: 0.952405 val: 0.940549 test: 0.929183
max validation accuracy : 0.942073 max acc epoch : 2 test accuracy : 0.918677
Counter({4: 2836, 1: 2305, 2: 1688, 3: 1179, 0: 1122})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  25.61818783544004 Time :  2152
accuracy train: 0.970020 val: 0.954268 test: 0.938521
max validation accuracy : 0.954268 max acc epoch : 4 test accuracy : 0.938521
Counter({1: 3812, 2: 2381, 3: 1231, 0: 1121, 4: 585})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  23.118431020528078 Time :  2199
accuracy train: 0.972561 val: 0.955793 test: 0.938521
max validation accuracy : 0.955793 max acc epoch : 5 test accuracy : 0.938521
Counter({0: 3791, 2: 2418, 4: 1236, 3: 1111, 1: 574})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  20.19901497103274 Time :  2243
accuracy train: 0.978150 val: 0.954268 test: 0.936965
max validation accuracy : 0.955793 max acc epoch : 5 test accuracy : 0.938521
Counter({1: 3811, 4: 2389, 2: 1247, 3: 1104, 0: 579})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  16.544731712900102 Time :  2278
accuracy train: 0.979336 val: 0.960366 test: 0.942802
max validation accuracy : 0.960366 max acc epoch : 7 test accuracy : 0.942802
Counter({1: 3817, 2: 2388, 4: 1263, 0: 1087, 3: 575})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  13.810200057923794 Time :  2310
accuracy train: 0.985095 val: 0.966463 test: 0.940078
max validation accuracy : 0.966463 max acc epoch : 8 test accuracy : 0.940078
Counter({0: 3794, 1: 2408, 2: 1260, 3: 1077, 4: 591})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  12.584367621690035 Time :  2352
accuracy train: 0.984079 val: 0.960366 test: 0.943191
max validation accuracy : 0.966463 max acc epoch : 8 test accuracy : 0.940078
Counter({1: 3792, 3: 2408, 2: 1256, 4: 1082, 0: 592})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  11.756446478888392 Time :  2417
accuracy train: 0.988821 val: 0.960366 test: 0.943969
max validation accuracy : 0.966463 max acc epoch : 8 test accuracy : 0.940078
Counter({0: 3795, 1: 2403, 2: 1258, 4: 1079, 3: 595})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  11.155720915645361 Time :  2453
accuracy train: 0.989160 val: 0.963415 test: 0.948638
max validation accuracy : 0.966463 max acc epoch : 8 test accuracy : 0.940078
Counter({1: 3799, 0: 2398, 4: 1270, 3: 1069, 2: 594})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  10.54990450432524 Time :  2484
accuracy train: 0.988652 val: 0.966463 test: 0.942802
max validation accuracy : 0.966463 max acc epoch : 8 test accuracy : 0.940078
Counter({1: 3805, 0: 2389, 4: 1271, 2: 1069, 3: 596})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  9.333548039430752 Time :  2516
accuracy train: 0.990854 val: 0.969512 test: 0.944358
max validation accuracy : 0.969512 max acc epoch : 13 test accuracy : 0.944358
Counter({2: 3803, 4: 2391, 3: 1272, 0: 1070, 1: 594})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  9.139703698456287 Time :  2563
accuracy train: 0.991870 val: 0.964939 test: 0.945136
max validation accuracy : 0.969512 max acc epoch : 13 test accuracy : 0.944358
Counter({1: 3806, 4: 2387, 0: 1272, 3: 1070, 2: 595})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  9.45898024784401 Time :  2602
accuracy train: 0.990007 val: 0.964939 test: 0.948249
max validation accuracy : 0.969512 max acc epoch : 13 test accuracy : 0.944358
Counter({1: 3807, 2: 2384, 0: 1275, 3: 1069, 4: 595})
Epoch-15 lr: 3.125e-05

Epoch :  16 loss training:  8.750417328905314 Time :  2638
accuracy train: 0.990684 val: 0.963415 test: 0.945914
max validation accuracy : 0.969512 max acc epoch : 13 test accuracy : 0.944358
Counter({4: 3809, 3: 2383, 0: 1273, 2: 1069, 1: 596})
Epoch-16 lr: 3.125e-05

Epoch :  17 loss training:  8.684401649516076 Time :  2673
accuracy train: 0.991870 val: 0.964939 test: 0.945914
max validation accuracy : 0.969512 max acc epoch : 13 test accuracy : 0.944358
Counter({1: 3809, 0: 2383, 2: 1276, 3: 1066, 4: 596})
Epoch-17 lr: 3.125e-05

Epoch :  18 loss training:  8.22392653953284 Time :  2713
accuracy train: 0.991701 val: 0.971037 test: 0.944747
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({1: 3811, 0: 2381, 3: 1275, 2: 1065, 4: 598})
Epoch-18 lr: 1.5625e-05

Epoch :  19 loss training:  8.160393565427512 Time :  2760
accuracy train: 0.991362 val: 0.971037 test: 0.943580
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({2: 3811, 1: 2384, 3: 1274, 0: 1065, 4: 596})
Epoch-19 lr: 1.5625e-05

Epoch :  20 loss training:  7.643112166784704 Time :  2793
accuracy train: 0.992378 val: 0.971037 test: 0.945525
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({1: 3812, 0: 2383, 2: 1275, 3: 1064, 4: 596})

Epoch :  21 loss training:  8.071885112207383 Time :  2828
accuracy train: 0.991870 val: 0.969512 test: 0.945525
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({0: 3814, 2: 2383, 3: 1273, 1: 1063, 4: 597})

Epoch :  22 loss training:  7.944040144328028 Time :  2869
accuracy train: 0.992378 val: 0.961890 test: 0.943969
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({1: 3815, 4: 2383, 2: 1271, 3: 1064, 0: 597})

Epoch :  23 loss training:  7.75441759522073 Time :  2922
accuracy train: 0.992378 val: 0.969512 test: 0.947082
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({0: 3815, 2: 2383, 1: 1273, 3: 1064, 4: 595})

Epoch :  24 loss training:  7.6745508490130305 Time :  2955
accuracy train: 0.992547 val: 0.967988 test: 0.947471
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({1: 3817, 3: 2383, 2: 1277, 4: 1059, 0: 594})

Epoch :  25 loss training:  7.345591286662966 Time :  2988
accuracy train: 0.992378 val: 0.966463 test: 0.947471
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({1: 3819, 4: 2382, 3: 1277, 2: 1058, 0: 594})

Epoch :  26 loss training:  7.994021219667047 Time :  3022
accuracy train: 0.992717 val: 0.966463 test: 0.946693
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({1: 3819, 0: 2382, 2: 1277, 4: 1058, 3: 594})

Epoch :  27 loss training:  7.471745003480464 Time :  3079
accuracy train: 0.992378 val: 0.971037 test: 0.946693
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({0: 3818, 1: 2384, 2: 1278, 4: 1058, 3: 592})

Epoch :  28 loss training:  7.507378270383924 Time :  3109
accuracy train: 0.992209 val: 0.967988 test: 0.946304
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({0: 3818, 2: 2384, 3: 1279, 1: 1056, 4: 593})

Epoch :  29 loss training:  7.139062488218769 Time :  3145
accuracy train: 0.992717 val: 0.963415 test: 0.949027
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({1: 3819, 2: 2383, 0: 1281, 3: 1056, 4: 591})

Epoch :  30 loss training:  7.47404601238668 Time :  3182
accuracy train: 0.992717 val: 0.964939 test: 0.945136
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({0: 3820, 3: 2384, 2: 1282, 1: 1053, 4: 591})

Epoch :  31 loss training:  7.705231161788106 Time :  3236
accuracy train: 0.993564 val: 0.967988 test: 0.947860
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({0: 3821, 1: 2384, 2: 1286, 3: 1050, 4: 589})

Epoch :  32 loss training:  7.2001051981933415 Time :  3273
accuracy train: 0.993056 val: 0.966463 test: 0.946304
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({0: 3821, 1: 2384, 4: 1286, 2: 1051, 3: 588})

Epoch :  33 loss training:  7.123186187585816 Time :  3310
accuracy train: 0.993394 val: 0.964939 test: 0.947860
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({1: 3821, 0: 2384, 3: 1282, 2: 1055, 4: 588})

Epoch :  34 loss training:  7.313596818130463 Time :  3348
accuracy train: 0.993733 val: 0.963415 test: 0.948638
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({1: 3822, 0: 2383, 2: 1282, 3: 1054, 4: 589})

Epoch :  35 loss training:  7.3180708745494485 Time :  3398
accuracy train: 0.992886 val: 0.964939 test: 0.949416
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({0: 3822, 1: 2383, 4: 1280, 2: 1056, 3: 589})

Epoch :  36 loss training:  6.69086302164942 Time :  3435
accuracy train: 0.993564 val: 0.967988 test: 0.946693
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({0: 3826, 3: 2380, 4: 1281, 2: 1056, 1: 587})

Epoch :  37 loss training:  7.014152891235426 Time :  3465
accuracy train: 0.994072 val: 0.969512 test: 0.947471
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({0: 3827, 3: 2379, 2: 1282, 4: 1056, 1: 586})

Epoch :  38 loss training:  6.661585545632988 Time :  3495
accuracy train: 0.993564 val: 0.969512 test: 0.947860
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({2: 3832, 4: 2376, 3: 1280, 0: 1057, 1: 585})

Epoch :  39 loss training:  6.73932501161471 Time :  3533
accuracy train: 0.993902 val: 0.969512 test: 0.948638
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({1: 3832, 0: 2376, 3: 1281, 4: 1056, 2: 585})

Epoch :  40 loss training:  6.854762262664735 Time :  3581
accuracy train: 0.993564 val: 0.967988 test: 0.947860
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({1: 3832, 3: 2376, 0: 1283, 4: 1056, 2: 583})

Epoch :  41 loss training:  6.425398005871102 Time :  3621
accuracy train: 0.993902 val: 0.969512 test: 0.948638
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({1: 3833, 0: 2375, 2: 1284, 4: 1055, 3: 583})

Epoch :  42 loss training:  6.348978703608736 Time :  3671
accuracy train: 0.993733 val: 0.964939 test: 0.947860
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({0: 3833, 1: 2375, 4: 1285, 3: 1054, 2: 583})

Epoch :  43 loss training:  6.644115913193673 Time :  3764
accuracy train: 0.993564 val: 0.966463 test: 0.947860
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({0: 3833, 3: 2375, 2: 1286, 4: 1053, 1: 583})

Epoch :  44 loss training:  6.213358231820166 Time :  3801
accuracy train: 0.994241 val: 0.969512 test: 0.949805
max validation accuracy : 0.971037 max acc epoch : 18 test accuracy : 0.944747
Counter({1: 3834, 3: 2376, 2: 1284, 4: 1052, 0: 584})

Epoch :  45 loss training:  6.3974805027246475 Time :  3868
accuracy train: 0.994241 val: 0.972561 test: 0.948638
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({1: 3833, 2: 2377, 3: 1281, 4: 1053, 0: 586})

Epoch :  46 loss training:  6.041158035164699 Time :  3906
accuracy train: 0.994072 val: 0.967988 test: 0.947471
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({1: 3833, 4: 2377, 2: 1280, 0: 1054, 3: 586})

Epoch :  47 loss training:  6.421544229844585 Time :  3942
accuracy train: 0.994241 val: 0.971037 test: 0.946693
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({0: 3833, 1: 2377, 3: 1283, 2: 1052, 4: 585})

Epoch :  48 loss training:  6.0058822222054005 Time :  3991
accuracy train: 0.994411 val: 0.971037 test: 0.947471
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({0: 3833, 1: 2376, 4: 1284, 2: 1052, 3: 585})

Epoch :  49 loss training:  5.924646827625111 Time :  4036
accuracy train: 0.994580 val: 0.964939 test: 0.948249
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({0: 3836, 1: 2373, 3: 1288, 2: 1049, 4: 584})

Epoch :  50 loss training:  6.272637395071797 Time :  4073
accuracy train: 0.994411 val: 0.964939 test: 0.947860
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({1: 3838, 4: 2372, 3: 1289, 0: 1046, 2: 585})

Epoch :  51 loss training:  6.056078694527969 Time :  4107
accuracy train: 0.995088 val: 0.966463 test: 0.946693
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({1: 3839, 0: 2371, 2: 1290, 3: 1046, 4: 584})

Epoch :  52 loss training:  5.973582367121708 Time :  4150
accuracy train: 0.995257 val: 0.964939 test: 0.949027
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({0: 3839, 1: 2371, 3: 1290, 2: 1046, 4: 584})

Epoch :  53 loss training:  6.0380457390565425 Time :  4196
accuracy train: 0.995257 val: 0.966463 test: 0.946693
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({0: 3840, 1: 2370, 3: 1290, 2: 1047, 4: 583})

Epoch :  54 loss training:  5.884162547066808 Time :  4234
accuracy train: 0.994919 val: 0.963415 test: 0.949805
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({1: 3840, 3: 2370, 0: 1290, 2: 1047, 4: 583})

Epoch :  55 loss training:  5.754196379566565 Time :  4269
accuracy train: 0.994749 val: 0.966463 test: 0.947860
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({1: 3843, 3: 2367, 4: 1292, 0: 1044, 2: 584})

Epoch :  56 loss training:  5.890223226509988 Time :  4314
accuracy train: 0.994919 val: 0.964939 test: 0.949027
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({1: 3844, 2: 2366, 3: 1294, 4: 1044, 0: 582})

Epoch :  57 loss training:  5.400283555267379 Time :  4363
accuracy train: 0.994411 val: 0.967988 test: 0.947860
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({2: 3845, 0: 2365, 3: 1295, 1: 1044, 4: 581})

Epoch :  58 loss training:  5.591435156296939 Time :  4396
accuracy train: 0.994749 val: 0.969512 test: 0.949416
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({1: 3846, 4: 2365, 2: 1297, 3: 1042, 0: 580})

Epoch :  59 loss training:  5.776743534952402 Time :  4436
accuracy train: 0.995257 val: 0.966463 test: 0.946304
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({1: 3846, 4: 2365, 3: 1296, 0: 1042, 2: 581})

Epoch :  60 loss training:  5.313411925919354 Time :  4481
accuracy train: 0.994919 val: 0.964939 test: 0.949416
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({1: 3846, 2: 2365, 0: 1298, 3: 1041, 4: 580})

Epoch :  61 loss training:  5.144278837135062 Time :  4526
accuracy train: 0.995257 val: 0.964939 test: 0.949027
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({1: 3846, 0: 2365, 3: 1298, 2: 1041, 4: 580})

Epoch :  62 loss training:  5.314132518135011 Time :  4561
accuracy train: 0.994919 val: 0.969512 test: 0.949805
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({0: 3846, 1: 2365, 3: 1298, 4: 1041, 2: 580})

Epoch :  63 loss training:  5.08764496142976 Time :  4595
accuracy train: 0.995088 val: 0.967988 test: 0.947082
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({0: 3847, 2: 2364, 1: 1299, 4: 1041, 3: 579})

Epoch :  64 loss training:  4.784339579520747 Time :  4631
accuracy train: 0.995088 val: 0.966463 test: 0.949027
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({1: 3847, 0: 2364, 3: 1298, 4: 1042, 2: 579})

Epoch :  65 loss training:  5.408047146163881 Time :  4688
accuracy train: 0.995088 val: 0.963415 test: 0.947471
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({1: 3849, 0: 2361, 2: 1300, 4: 1042, 3: 578})

Epoch :  66 loss training:  5.412024818069767 Time :  4727
accuracy train: 0.994919 val: 0.966463 test: 0.949027
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({0: 3853, 4: 2356, 3: 1300, 2: 1042, 1: 579})

Epoch :  67 loss training:  4.933373612584546 Time :  4760
accuracy train: 0.995596 val: 0.966463 test: 0.947860
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({0: 3854, 1: 2355, 2: 1300, 4: 1042, 3: 579})

Epoch :  68 loss training:  4.778717613895424 Time :  4802
accuracy train: 0.995596 val: 0.969512 test: 0.949027
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({1: 3855, 0: 2355, 2: 1300, 4: 1042, 3: 578})

Epoch :  69 loss training:  5.113836805569008 Time :  4859
accuracy train: 0.996274 val: 0.966463 test: 0.949805
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({1: 3855, 2: 2355, 4: 1298, 3: 1043, 0: 579})

Epoch :  70 loss training:  4.990102614508942 Time :  4896
accuracy train: 0.995935 val: 0.969512 test: 0.951362
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({0: 3855, 1: 2355, 2: 1300, 3: 1042, 4: 578})

Epoch :  71 loss training:  4.478787498665042 Time :  4937
accuracy train: 0.995596 val: 0.967988 test: 0.949805
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({1: 3855, 3: 2354, 2: 1299, 4: 1045, 0: 577})

Epoch :  72 loss training:  5.031951697310433 Time :  4989
accuracy train: 0.995766 val: 0.964939 test: 0.949416
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({1: 3856, 2: 2353, 4: 1298, 3: 1044, 0: 579})

Epoch :  73 loss training:  4.718509998638183 Time :  5060
accuracy train: 0.995427 val: 0.966463 test: 0.947860
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({1: 3857, 2: 2351, 4: 1299, 3: 1045, 0: 578})

Epoch :  74 loss training:  4.657926867250353 Time :  5095
accuracy train: 0.995088 val: 0.964939 test: 0.949027
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({0: 3858, 3: 2349, 2: 1299, 4: 1045, 1: 579})

Epoch :  75 loss training:  4.801240319618955 Time :  5135
accuracy train: 0.995935 val: 0.964939 test: 0.948249
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({2: 3858, 3: 2350, 1: 1297, 0: 1045, 4: 580})

Epoch :  76 loss training:  4.707524508121423 Time :  5178
accuracy train: 0.995427 val: 0.964939 test: 0.949416
max validation accuracy : 0.972561 max acc epoch : 45 test accuracy : 0.948638
Counter({1: 3858, 0: 2349, 2: 1303, 3: 1044, 4: 576})

========================================================================================================================================================================================================
max acc epoch :  45
max validation accuracy :  0.9725609756097561
test accuracy :  0.9486381322957198
last test_accuracy :  0.9494163424124513
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=5, num_layers=3, num_mlp_layers=1, random_vec=False, seed=926, weight_decay=0)
device :  cuda:0
Counter({2: 3108, 1: 2523, 0: 2322, 3: 1128, 4: 49})

Epoch :  1 loss training:  126.19670873880386 Time :  5229
accuracy train: 0.903625 val: 0.910061 test: 0.892218
max validation accuracy : 0.910061 max acc epoch : 1 test accuracy : 0.892218
Counter({0: 3055, 1: 2230, 4: 1721, 2: 1155, 3: 969})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  54.81420302391052 Time :  5263
accuracy train: 0.944275 val: 0.937500 test: 0.915175
max validation accuracy : 0.937500 max acc epoch : 2 test accuracy : 0.915175
Counter({4: 2871, 2: 2315, 3: 1676, 1: 1178, 0: 1090})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  39.71706072986126 Time :  5296
accuracy train: 0.952744 val: 0.942073 test: 0.929183
max validation accuracy : 0.942073 max acc epoch : 3 test accuracy : 0.929183
Counter({1: 3774, 3: 2424, 0: 1084, 2: 1047, 4: 801})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  26.07878072746098 Time :  5342
accuracy train: 0.970020 val: 0.951220 test: 0.937743
max validation accuracy : 0.951220 max acc epoch : 4 test accuracy : 0.937743
Counter({0: 3761, 1: 2428, 2: 1101, 4: 1070, 3: 770})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  23.307191541418433 Time :  5375
accuracy train: 0.971714 val: 0.951220 test: 0.935019
max validation accuracy : 0.951220 max acc epoch : 4 test accuracy : 0.937743
Counter({1: 3762, 2: 2434, 0: 1143, 3: 1093, 4: 698})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  21.1378362798132 Time :  5409
accuracy train: 0.977134 val: 0.949695 test: 0.940078
max validation accuracy : 0.951220 max acc epoch : 4 test accuracy : 0.937743
Counter({0: 3788, 4: 2400, 1: 1226, 3: 1076, 2: 640})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  16.600887530483305 Time :  5439
accuracy train: 0.977981 val: 0.952744 test: 0.941634
max validation accuracy : 0.952744 max acc epoch : 7 test accuracy : 0.941634
Counter({0: 3798, 1: 2391, 4: 1261, 3: 1071, 2: 609})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  13.701090600341558 Time :  5472
accuracy train: 0.985264 val: 0.964939 test: 0.935798
max validation accuracy : 0.964939 max acc epoch : 8 test accuracy : 0.935798
Counter({2: 3780, 0: 2411, 4: 1262, 1: 1062, 3: 615})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  12.746620267629623 Time :  5529
accuracy train: 0.985264 val: 0.961890 test: 0.943191
max validation accuracy : 0.964939 max acc epoch : 8 test accuracy : 0.935798
Counter({2: 3812, 1: 2375, 3: 1265, 0: 1069, 4: 609})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  11.88839333690703 Time :  5562
accuracy train: 0.989160 val: 0.960366 test: 0.945136
max validation accuracy : 0.964939 max acc epoch : 8 test accuracy : 0.935798
Counter({1: 3820, 2: 2372, 0: 1254, 3: 1068, 4: 616})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  11.390128968283534 Time :  5595
accuracy train: 0.989329 val: 0.963415 test: 0.945525
max validation accuracy : 0.964939 max acc epoch : 8 test accuracy : 0.935798
Counter({1: 3821, 0: 2372, 3: 1255, 2: 1065, 4: 617})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  10.349971247604117 Time :  5626
accuracy train: 0.988821 val: 0.961890 test: 0.942802
max validation accuracy : 0.964939 max acc epoch : 8 test accuracy : 0.935798
Counter({0: 3825, 1: 2364, 4: 1257, 3: 1062, 2: 622})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  9.472200881224126 Time :  5677
accuracy train: 0.991870 val: 0.964939 test: 0.947860
max validation accuracy : 0.964939 max acc epoch : 8 test accuracy : 0.935798
Counter({1: 3825, 0: 2366, 3: 1256, 2: 1061, 4: 622})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  9.101621887180954 Time :  5705
accuracy train: 0.992209 val: 0.964939 test: 0.948638
max validation accuracy : 0.964939 max acc epoch : 8 test accuracy : 0.935798
Counter({4: 3829, 2: 2362, 3: 1257, 0: 1061, 1: 621})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  9.452819663099945 Time :  5736
accuracy train: 0.990346 val: 0.961890 test: 0.948249
max validation accuracy : 0.964939 max acc epoch : 8 test accuracy : 0.935798
Counter({1: 3829, 2: 2359, 3: 1259, 4: 1061, 0: 622})
Epoch-15 lr: 3.125e-05

Epoch :  16 loss training:  8.808205500710756 Time :  5770
accuracy train: 0.991870 val: 0.964939 test: 0.948638
max validation accuracy : 0.964939 max acc epoch : 8 test accuracy : 0.935798
Counter({1: 3830, 2: 2357, 3: 1258, 4: 1061, 0: 624})
Epoch-16 lr: 3.125e-05

Epoch :  17 loss training:  8.459689843002707 Time :  5814
accuracy train: 0.992209 val: 0.963415 test: 0.948249
max validation accuracy : 0.964939 max acc epoch : 8 test accuracy : 0.935798
Counter({1: 3837, 3: 2353, 2: 1257, 0: 1060, 4: 623})
Epoch-17 lr: 3.125e-05

Epoch :  18 loss training:  8.41325263492763 Time :  5852
accuracy train: 0.991870 val: 0.964939 test: 0.949027
max validation accuracy : 0.964939 max acc epoch : 8 test accuracy : 0.935798
Counter({1: 3837, 0: 2353, 3: 1259, 2: 1057, 4: 624})
Epoch-18 lr: 1.5625e-05

Epoch :  19 loss training:  8.114967409987003 Time :  5886
accuracy train: 0.991701 val: 0.967988 test: 0.947082
max validation accuracy : 0.967988 max acc epoch : 19 test accuracy : 0.947082
Counter({4: 3838, 3: 2354, 0: 1261, 2: 1056, 1: 621})
Epoch-19 lr: 1.5625e-05

Epoch :  20 loss training:  8.45314840786159 Time :  5916
accuracy train: 0.992547 val: 0.964939 test: 0.945525
max validation accuracy : 0.967988 max acc epoch : 19 test accuracy : 0.947082
Counter({2: 3841, 0: 2352, 3: 1259, 1: 1057, 4: 621})

Epoch :  21 loss training:  7.681500640697777 Time :  5954
accuracy train: 0.992886 val: 0.967988 test: 0.946693
max validation accuracy : 0.967988 max acc epoch : 19 test accuracy : 0.947082
Counter({0: 3842, 3: 2352, 4: 1257, 2: 1058, 1: 621})

Epoch :  22 loss training:  7.992955927737057 Time :  6014
accuracy train: 0.992886 val: 0.963415 test: 0.948638
max validation accuracy : 0.967988 max acc epoch : 19 test accuracy : 0.947082
Counter({0: 3843, 1: 2352, 4: 1257, 3: 1057, 2: 621})

Epoch :  23 loss training:  8.138738937675953 Time :  6048
accuracy train: 0.992039 val: 0.966463 test: 0.947082
max validation accuracy : 0.967988 max acc epoch : 19 test accuracy : 0.947082
Counter({0: 3844, 4: 2351, 3: 1259, 2: 1055, 1: 621})

Epoch :  24 loss training:  8.340476555749774 Time :  6084
accuracy train: 0.992717 val: 0.964939 test: 0.947471
max validation accuracy : 0.967988 max acc epoch : 19 test accuracy : 0.947082
Counter({1: 3845, 2: 2353, 3: 1253, 0: 1057, 4: 622})

Epoch :  25 loss training:  7.926904470194131 Time :  6118
accuracy train: 0.993225 val: 0.964939 test: 0.946304
max validation accuracy : 0.967988 max acc epoch : 19 test accuracy : 0.947082
Counter({0: 3845, 1: 2354, 3: 1255, 2: 1056, 4: 620})

Epoch :  26 loss training:  7.2371362103149295 Time :  6173
accuracy train: 0.993225 val: 0.966463 test: 0.947860
max validation accuracy : 0.967988 max acc epoch : 19 test accuracy : 0.947082
Counter({2: 3846, 1: 2352, 0: 1256, 3: 1056, 4: 620})

Epoch :  27 loss training:  7.842163276858628 Time :  6207
accuracy train: 0.993564 val: 0.966463 test: 0.949027
max validation accuracy : 0.967988 max acc epoch : 19 test accuracy : 0.947082
Counter({1: 3846, 2: 2352, 0: 1256, 4: 1058, 3: 618})

Epoch :  28 loss training:  7.4795090006664395 Time :  6244
accuracy train: 0.993394 val: 0.963415 test: 0.947860
max validation accuracy : 0.967988 max acc epoch : 19 test accuracy : 0.947082
Counter({0: 3847, 3: 2351, 2: 1253, 1: 1057, 4: 622})

Epoch :  29 loss training:  7.613826322834939 Time :  6280
accuracy train: 0.993564 val: 0.964939 test: 0.949805
max validation accuracy : 0.967988 max acc epoch : 19 test accuracy : 0.947082
Counter({0: 3850, 1: 2349, 2: 1252, 4: 1058, 3: 621})

Epoch :  30 loss training:  7.377656578086317 Time :  6336
accuracy train: 0.993394 val: 0.967988 test: 0.950584
max validation accuracy : 0.967988 max acc epoch : 19 test accuracy : 0.947082
Counter({1: 3851, 4: 2348, 2: 1252, 3: 1056, 0: 623})

Epoch :  31 loss training:  7.435933428350836 Time :  6368
accuracy train: 0.993733 val: 0.967988 test: 0.949027
max validation accuracy : 0.967988 max acc epoch : 19 test accuracy : 0.947082
Counter({0: 3853, 1: 2346, 4: 1255, 3: 1053, 2: 623})

Epoch :  32 loss training:  7.049527782946825 Time :  6401
accuracy train: 0.992886 val: 0.967988 test: 0.947471
max validation accuracy : 0.967988 max acc epoch : 19 test accuracy : 0.947082
Counter({0: 3856, 3: 2344, 2: 1253, 1: 1054, 4: 623})

Epoch :  33 loss training:  7.025475079426542 Time :  6439
accuracy train: 0.993564 val: 0.969512 test: 0.948638
max validation accuracy : 0.969512 max acc epoch : 33 test accuracy : 0.948638
Counter({1: 3858, 4: 2344, 3: 1251, 0: 1053, 2: 624})

Epoch :  34 loss training:  7.41671938681975 Time :  6486
accuracy train: 0.993733 val: 0.964939 test: 0.952140
max validation accuracy : 0.969512 max acc epoch : 33 test accuracy : 0.948638
Counter({0: 3862, 4: 2342, 3: 1251, 2: 1053, 1: 622})

Epoch :  35 loss training:  7.2621209770441055 Time :  6521
accuracy train: 0.993564 val: 0.967988 test: 0.949027
max validation accuracy : 0.969512 max acc epoch : 33 test accuracy : 0.948638
Counter({1: 3862, 0: 2343, 4: 1255, 3: 1050, 2: 620})

Epoch :  36 loss training:  7.167470848187804 Time :  6553
accuracy train: 0.993733 val: 0.967988 test: 0.949027
max validation accuracy : 0.969512 max acc epoch : 33 test accuracy : 0.948638
Counter({0: 3862, 1: 2343, 2: 1254, 4: 1050, 3: 621})

Epoch :  37 loss training:  7.012331809382886 Time :  6587
accuracy train: 0.993902 val: 0.967988 test: 0.947860
max validation accuracy : 0.969512 max acc epoch : 33 test accuracy : 0.948638
Counter({2: 3863, 0: 2342, 1: 1254, 4: 1050, 3: 621})

Epoch :  38 loss training:  6.549710294231772 Time :  6627
accuracy train: 0.993564 val: 0.967988 test: 0.947860
max validation accuracy : 0.969512 max acc epoch : 33 test accuracy : 0.948638
Counter({1: 3865, 2: 2341, 0: 1253, 3: 1050, 4: 621})

Epoch :  39 loss training:  6.6081012196373194 Time :  6667
accuracy train: 0.994241 val: 0.969512 test: 0.948638
max validation accuracy : 0.969512 max acc epoch : 33 test accuracy : 0.948638
Counter({1: 3867, 2: 2340, 3: 1254, 0: 1049, 4: 620})

Epoch :  40 loss training:  6.425482184393331 Time :  6699
accuracy train: 0.993225 val: 0.963415 test: 0.949027
max validation accuracy : 0.969512 max acc epoch : 33 test accuracy : 0.948638
Counter({0: 3868, 3: 2338, 2: 1254, 4: 1050, 1: 620})

Epoch :  41 loss training:  6.332551057683304 Time :  6728
accuracy train: 0.993564 val: 0.966463 test: 0.948249
max validation accuracy : 0.969512 max acc epoch : 33 test accuracy : 0.948638
Counter({1: 3869, 2: 2337, 4: 1256, 3: 1048, 0: 620})

Epoch :  42 loss training:  6.533038926776499 Time :  6763
accuracy train: 0.993902 val: 0.966463 test: 0.949027
max validation accuracy : 0.969512 max acc epoch : 33 test accuracy : 0.948638
Counter({0: 3868, 1: 2338, 3: 1255, 4: 1049, 2: 620})

Epoch :  43 loss training:  6.586411726195365 Time :  6822
accuracy train: 0.993902 val: 0.969512 test: 0.949027
max validation accuracy : 0.969512 max acc epoch : 33 test accuracy : 0.948638
Counter({0: 3868, 4: 2338, 2: 1257, 3: 1048, 1: 619})

Epoch :  44 loss training:  6.373755454085767 Time :  6859
accuracy train: 0.994411 val: 0.966463 test: 0.949416
max validation accuracy : 0.969512 max acc epoch : 33 test accuracy : 0.948638
Counter({1: 3869, 2: 2338, 3: 1256, 4: 1047, 0: 620})

Epoch :  45 loss training:  6.008847870398313 Time :  6893
accuracy train: 0.994411 val: 0.967988 test: 0.947471
max validation accuracy : 0.969512 max acc epoch : 33 test accuracy : 0.948638
Counter({2: 3869, 1: 2337, 3: 1256, 0: 1049, 4: 619})

Epoch :  46 loss training:  6.334124710643664 Time :  6927
accuracy train: 0.993394 val: 0.969512 test: 0.950584
max validation accuracy : 0.969512 max acc epoch : 33 test accuracy : 0.948638
Counter({0: 3870, 1: 2336, 3: 1257, 2: 1049, 4: 618})

Epoch :  47 loss training:  6.604014799697325 Time :  6988
accuracy train: 0.993394 val: 0.969512 test: 0.945136
max validation accuracy : 0.969512 max acc epoch : 33 test accuracy : 0.948638
Counter({0: 3870, 3: 2336, 4: 1257, 1: 1049, 2: 618})

Epoch :  48 loss training:  6.35697976546362 Time :  7021
accuracy train: 0.994411 val: 0.969512 test: 0.946693
max validation accuracy : 0.969512 max acc epoch : 33 test accuracy : 0.948638
Counter({0: 3871, 1: 2334, 2: 1259, 4: 1047, 3: 619})

Epoch :  49 loss training:  5.723487044451758 Time :  7055
accuracy train: 0.994411 val: 0.967988 test: 0.949027
max validation accuracy : 0.969512 max acc epoch : 33 test accuracy : 0.948638
Counter({0: 3873, 3: 2333, 4: 1259, 2: 1046, 1: 619})

Epoch :  50 loss training:  5.615505963563919 Time :  7088
accuracy train: 0.994241 val: 0.966463 test: 0.946693
max validation accuracy : 0.969512 max acc epoch : 33 test accuracy : 0.948638
Counter({1: 3873, 2: 2333, 0: 1262, 3: 1043, 4: 619})

Epoch :  51 loss training:  6.2793396196793765 Time :  7138
accuracy train: 0.994749 val: 0.967988 test: 0.947860
max validation accuracy : 0.969512 max acc epoch : 33 test accuracy : 0.948638
Counter({1: 3875, 0: 2331, 4: 1262, 3: 1042, 2: 620})

Epoch :  52 loss training:  5.674139178590849 Time :  7173
accuracy train: 0.994411 val: 0.966463 test: 0.950195
max validation accuracy : 0.969512 max acc epoch : 33 test accuracy : 0.948638
Counter({1: 3875, 4: 2331, 3: 1263, 2: 1041, 0: 620})

Epoch :  53 loss training:  5.841113037662581 Time :  7207
accuracy train: 0.994919 val: 0.969512 test: 0.947082
max validation accuracy : 0.969512 max acc epoch : 33 test accuracy : 0.948638
Counter({0: 3875, 1: 2331, 4: 1260, 2: 1044, 3: 620})

Epoch :  54 loss training:  5.786831569625065 Time :  7243
accuracy train: 0.994749 val: 0.971037 test: 0.948638
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({0: 3879, 1: 2328, 2: 1261, 4: 1043, 3: 619})

Epoch :  55 loss training:  5.630588011583313 Time :  7304
accuracy train: 0.994919 val: 0.967988 test: 0.948249
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({1: 3881, 2: 2326, 4: 1263, 0: 1041, 3: 619})

Epoch :  56 loss training:  5.908623997005634 Time :  7338
accuracy train: 0.994580 val: 0.964939 test: 0.947082
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({3: 3882, 2: 2325, 4: 1264, 0: 1040, 1: 619})

Epoch :  57 loss training:  5.463770946371369 Time :  7372
accuracy train: 0.994411 val: 0.969512 test: 0.946693
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({2: 3885, 1: 2322, 3: 1264, 4: 1041, 0: 618})

Epoch :  58 loss training:  5.816804153844714 Time :  7408
accuracy train: 0.994411 val: 0.969512 test: 0.950195
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({1: 3885, 4: 2321, 3: 1266, 2: 1041, 0: 617})

Epoch :  59 loss training:  6.070684338454157 Time :  7468
accuracy train: 0.994749 val: 0.966463 test: 0.947471
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({1: 3886, 2: 2320, 4: 1265, 0: 1039, 3: 620})

Epoch :  60 loss training:  5.3855119224172086 Time :  7504
accuracy train: 0.994749 val: 0.967988 test: 0.951751
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({0: 3886, 2: 2320, 4: 1268, 3: 1038, 1: 618})

Epoch :  61 loss training:  5.4115364227909595 Time :  7541
accuracy train: 0.994580 val: 0.967988 test: 0.947471
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({2: 3886, 0: 2320, 1: 1268, 3: 1038, 4: 618})

Epoch :  62 loss training:  5.630681635579094 Time :  7580
accuracy train: 0.994749 val: 0.963415 test: 0.948638
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({0: 3886, 1: 2320, 2: 1274, 4: 1038, 3: 612})

Epoch :  63 loss training:  5.541971841361374 Time :  7633
accuracy train: 0.995088 val: 0.966463 test: 0.949027
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({0: 3887, 1: 2319, 3: 1271, 2: 1039, 4: 614})

Epoch :  64 loss training:  5.052609169390053 Time :  7667
accuracy train: 0.994411 val: 0.966463 test: 0.950195
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({1: 3887, 2: 2319, 3: 1273, 0: 1037, 4: 614})

Epoch :  65 loss training:  5.302777631208301 Time :  7701
accuracy train: 0.995088 val: 0.966463 test: 0.947471
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({3: 3887, 4: 2318, 0: 1275, 2: 1035, 1: 615})

Epoch :  66 loss training:  5.2776989579433575 Time :  7734
accuracy train: 0.994411 val: 0.966463 test: 0.949027
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({1: 3887, 2: 2318, 0: 1278, 3: 1034, 4: 613})

Epoch :  67 loss training:  4.8882784568704665 Time :  7796
accuracy train: 0.995427 val: 0.969512 test: 0.949805
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({0: 3887, 3: 2318, 2: 1278, 1: 1035, 4: 612})

Epoch :  68 loss training:  5.114446820924059 Time :  7830
accuracy train: 0.995257 val: 0.969512 test: 0.950195
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({0: 3888, 1: 2317, 3: 1282, 2: 1032, 4: 611})

Epoch :  69 loss training:  5.123040207428858 Time :  7869
accuracy train: 0.995596 val: 0.964939 test: 0.950195
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({0: 3888, 2: 2318, 3: 1283, 4: 1031, 1: 610})

Epoch :  70 loss training:  5.035011760890484 Time :  7904
accuracy train: 0.994919 val: 0.969512 test: 0.947471
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({1: 3888, 0: 2318, 2: 1283, 3: 1032, 4: 609})

Epoch :  71 loss training:  4.694872307823971 Time :  7963
accuracy train: 0.995596 val: 0.967988 test: 0.948249
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({1: 3889, 2: 2317, 0: 1282, 3: 1034, 4: 608})

Epoch :  72 loss training:  4.8076647784910165 Time :  7994
accuracy train: 0.995427 val: 0.966463 test: 0.947860
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({0: 3890, 1: 2316, 2: 1282, 4: 1035, 3: 607})

Epoch :  73 loss training:  4.609921702300198 Time :  8029
accuracy train: 0.995596 val: 0.966463 test: 0.949027
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({1: 3891, 0: 2315, 2: 1279, 3: 1038, 4: 607})

Epoch :  74 loss training:  4.840685337781906 Time :  8064
accuracy train: 0.995257 val: 0.964939 test: 0.948249
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({1: 3891, 2: 2315, 3: 1282, 0: 1036, 4: 606})

Epoch :  75 loss training:  4.519938020617701 Time :  8124
accuracy train: 0.995766 val: 0.969512 test: 0.949027
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({1: 3892, 2: 2314, 4: 1284, 3: 1035, 0: 605})

Epoch :  76 loss training:  4.582308462238871 Time :  8157
accuracy train: 0.995088 val: 0.964939 test: 0.948249
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({1: 3891, 0: 2314, 2: 1285, 3: 1035, 4: 605})

Epoch :  77 loss training:  4.683848342159763 Time :  8193
accuracy train: 0.994919 val: 0.964939 test: 0.948249
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({1: 3891, 0: 2314, 4: 1283, 3: 1036, 2: 606})

Epoch :  78 loss training:  4.3868562662974 Time :  8229
accuracy train: 0.995257 val: 0.969512 test: 0.948249
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({1: 3891, 0: 2314, 2: 1283, 4: 1035, 3: 607})

Epoch :  79 loss training:  4.548670453368686 Time :  8294
accuracy train: 0.995257 val: 0.967988 test: 0.948249
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({1: 3891, 2: 2314, 4: 1281, 0: 1036, 3: 608})

Epoch :  80 loss training:  4.421997315948829 Time :  8328
accuracy train: 0.995935 val: 0.967988 test: 0.947471
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({0: 3890, 1: 2315, 3: 1286, 4: 1031, 2: 608})

Epoch :  81 loss training:  4.476208177395165 Time :  8363
accuracy train: 0.995427 val: 0.967988 test: 0.949416
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({1: 3891, 3: 2313, 2: 1288, 0: 1031, 4: 607})

Epoch :  82 loss training:  4.3581527470378205 Time :  8400
accuracy train: 0.996274 val: 0.967988 test: 0.949416
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({1: 3893, 0: 2313, 4: 1286, 2: 1031, 3: 607})

Epoch :  83 loss training:  4.604041079408489 Time :  8463
accuracy train: 0.995596 val: 0.967988 test: 0.949805
max validation accuracy : 0.971037 max acc epoch : 54 test accuracy : 0.948638
Counter({1: 3893, 0: 2313, 3: 1289, 4: 1030, 2: 605})

Epoch :  84 loss training:  4.374448025715537 Time :  8499
accuracy train: 0.995596 val: 0.972561 test: 0.950195
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({0: 3895, 1: 2312, 3: 1290, 2: 1030, 4: 603})

Epoch :  85 loss training:  3.9432393078459427 Time :  8529
accuracy train: 0.995596 val: 0.969512 test: 0.949416
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({2: 3895, 1: 2312, 4: 1291, 0: 1028, 3: 604})

Epoch :  86 loss training:  4.158485207473859 Time :  8564
accuracy train: 0.995766 val: 0.967988 test: 0.949027
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({0: 3895, 1: 2312, 4: 1293, 3: 1027, 2: 603})

Epoch :  87 loss training:  4.346980597474612 Time :  8625
accuracy train: 0.994919 val: 0.966463 test: 0.948249
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({0: 3896, 4: 2310, 3: 1294, 2: 1026, 1: 604})

Epoch :  88 loss training:  4.120016172877513 Time :  8660
accuracy train: 0.995427 val: 0.967988 test: 0.947471
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({0: 3896, 1: 2310, 4: 1295, 3: 1025, 2: 604})

Epoch :  89 loss training:  4.399432006990537 Time :  8694
accuracy train: 0.995427 val: 0.971037 test: 0.949416
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({2: 3896, 3: 2311, 4: 1296, 1: 1025, 0: 602})

Epoch :  90 loss training:  4.37316385761369 Time :  8730
accuracy train: 0.995935 val: 0.967988 test: 0.949027
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({0: 3896, 1: 2311, 3: 1299, 4: 1025, 2: 599})

Epoch :  91 loss training:  4.195653430302627 Time :  8782
accuracy train: 0.996104 val: 0.966463 test: 0.949416
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({1: 3897, 2: 2310, 4: 1301, 3: 1023, 0: 599})

Epoch :  92 loss training:  4.001880380208604 Time :  8817
accuracy train: 0.995935 val: 0.966463 test: 0.947471
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({0: 3899, 2: 2308, 4: 1300, 3: 1023, 1: 600})

Epoch :  93 loss training:  3.8991438249358907 Time :  8851
accuracy train: 0.996274 val: 0.967988 test: 0.949416
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({0: 3899, 1: 2309, 4: 1302, 2: 1020, 3: 600})

Epoch :  94 loss training:  3.9968509923201054 Time :  8884
accuracy train: 0.996104 val: 0.966463 test: 0.949416
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({1: 3899, 2: 2310, 4: 1302, 0: 1020, 3: 599})

Epoch :  95 loss training:  3.82348905375693 Time :  8928
accuracy train: 0.996104 val: 0.969512 test: 0.949416
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({1: 3901, 0: 2307, 3: 1302, 2: 1021, 4: 599})

Epoch :  96 loss training:  4.452806707355194 Time :  8967
accuracy train: 0.996104 val: 0.967988 test: 0.948249
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({2: 3901, 1: 2307, 0: 1303, 4: 1021, 3: 598})

Epoch :  97 loss training:  3.722262285184115 Time :  8998
accuracy train: 0.996104 val: 0.967988 test: 0.949416
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({1: 3901, 0: 2307, 2: 1305, 3: 1021, 4: 596})

Epoch :  98 loss training:  3.8942840764066204 Time :  9032
accuracy train: 0.995596 val: 0.966463 test: 0.949416
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({2: 3902, 0: 2306, 4: 1305, 3: 1021, 1: 596})

Epoch :  99 loss training:  3.4189413511776365 Time :  9072
accuracy train: 0.995596 val: 0.969512 test: 0.949416
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({1: 3903, 2: 2304, 3: 1307, 0: 1021, 4: 595})

Epoch :  100 loss training:  3.8782427915139124 Time :  9116
accuracy train: 0.995766 val: 0.964939 test: 0.949805
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({2: 3903, 4: 2304, 0: 1308, 1: 1022, 3: 593})

Epoch :  101 loss training:  3.8603344784351066 Time :  9148
accuracy train: 0.995596 val: 0.966463 test: 0.947860
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({1: 3903, 2: 2305, 3: 1311, 4: 1023, 0: 588})

Epoch :  102 loss training:  3.7964850025018677 Time :  9179
accuracy train: 0.996274 val: 0.967988 test: 0.949416
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({1: 3903, 2: 2305, 0: 1311, 4: 1023, 3: 588})

Epoch :  103 loss training:  3.8355159233906306 Time :  9210
accuracy train: 0.995935 val: 0.969512 test: 0.950973
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({1: 3903, 2: 2306, 3: 1315, 4: 1023, 0: 583})

Epoch :  104 loss training:  3.6159881049534306 Time :  9266
accuracy train: 0.996274 val: 0.969512 test: 0.948638
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({1: 3903, 2: 2306, 4: 1315, 0: 1023, 3: 583})

Epoch :  105 loss training:  3.8625588642898947 Time :  9301
accuracy train: 0.995766 val: 0.967988 test: 0.948249
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({0: 3903, 4: 2305, 1: 1320, 3: 1021, 2: 581})

Epoch :  106 loss training:  3.4667958220816217 Time :  9332
accuracy train: 0.996274 val: 0.969512 test: 0.947471
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({2: 3903, 1: 2305, 4: 1323, 0: 1018, 3: 581})

Epoch :  107 loss training:  3.8423842636402696 Time :  9367
accuracy train: 0.996274 val: 0.969512 test: 0.948638
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({2: 3903, 0: 2306, 4: 1326, 1: 1016, 3: 579})

Epoch :  108 loss training:  3.268080491456203 Time :  9424
accuracy train: 0.996443 val: 0.967988 test: 0.947082
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({0: 3902, 2: 2308, 3: 1328, 4: 1013, 1: 579})

Epoch :  109 loss training:  3.4740241545368917 Time :  9459
accuracy train: 0.996104 val: 0.967988 test: 0.949027
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({0: 3902, 3: 2308, 2: 1326, 4: 1015, 1: 579})

Epoch :  110 loss training:  3.3528601207071915 Time :  9491
accuracy train: 0.996612 val: 0.966463 test: 0.948638
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({1: 3902, 0: 2307, 4: 1327, 3: 1015, 2: 579})

Epoch :  111 loss training:  3.48193007404916 Time :  9529
accuracy train: 0.996104 val: 0.964939 test: 0.949027
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({1: 3902, 2: 2307, 0: 1329, 3: 1013, 4: 579})

Epoch :  112 loss training:  3.4711327998666093 Time :  9586
accuracy train: 0.996104 val: 0.964939 test: 0.947471
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({0: 3902, 1: 2307, 2: 1328, 3: 1014, 4: 579})

Epoch :  113 loss training:  3.543761735665612 Time :  9619
accuracy train: 0.996104 val: 0.964939 test: 0.947860
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({0: 3902, 1: 2307, 4: 1327, 3: 1014, 2: 580})

Epoch :  114 loss training:  3.4418587468680926 Time :  9651
accuracy train: 0.996274 val: 0.966463 test: 0.947860
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({1: 3903, 2: 2306, 0: 1330, 3: 1011, 4: 580})

Epoch :  115 loss training:  3.397977504238952 Time :  9687
accuracy train: 0.996612 val: 0.966463 test: 0.948638
max validation accuracy : 0.972561 max acc epoch : 84 test accuracy : 0.950195
Counter({0: 3903, 1: 2306, 2: 1332, 3: 1009, 4: 580})

========================================================================================================================================================================================================
max acc epoch :  84
max validation accuracy :  0.9725609756097561
test accuracy :  0.9501945525291828
last test_accuracy :  0.9486381322957198
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=5, num_layers=3, num_mlp_layers=1, random_vec=False, seed=926, weight_decay=0)
device :  cuda:0
Counter({2: 3108, 1: 2523, 0: 2322, 3: 1128, 4: 49})

Epoch :  1 loss training:  126.23325219750404 Time :  9759
accuracy train: 0.902439 val: 0.907012 test: 0.890272
max validation accuracy : 0.907012 max acc epoch : 1 test accuracy : 0.890272
Counter({0: 3062, 1: 2250, 4: 1720, 3: 1137, 2: 961})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  55.03262364119291 Time :  9792
accuracy train: 0.941734 val: 0.937500 test: 0.911284
max validation accuracy : 0.937500 max acc epoch : 2 test accuracy : 0.911284
Counter({2: 2886, 3: 2309, 4: 1686, 0: 1143, 1: 1106})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  39.66547184437513 Time :  9819
accuracy train: 0.952744 val: 0.943598 test: 0.924903
max validation accuracy : 0.943598 max acc epoch : 3 test accuracy : 0.924903
Counter({3: 2827, 4: 2293, 1: 1667, 2: 1205, 0: 1138})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  26.11659468524158 Time :  9854
accuracy train: 0.970698 val: 0.957317 test: 0.936576
max validation accuracy : 0.957317 max acc epoch : 4 test accuracy : 0.936576
Counter({0: 3792, 2: 2386, 3: 1127, 4: 1080, 1: 745})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  23.113567877560854 Time :  9912
accuracy train: 0.972900 val: 0.954268 test: 0.938132
max validation accuracy : 0.957317 max acc epoch : 4 test accuracy : 0.936576
Counter({1: 3777, 3: 2411, 0: 1165, 4: 1056, 2: 721})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  20.348070051986724 Time :  9942
accuracy train: 0.978150 val: 0.957317 test: 0.936187
max validation accuracy : 0.957317 max acc epoch : 4 test accuracy : 0.936576
Counter({0: 3807, 4: 2381, 3: 1206, 2: 1064, 1: 672})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  16.329794748686254 Time :  9976
accuracy train: 0.979675 val: 0.952744 test: 0.941634
max validation accuracy : 0.957317 max acc epoch : 4 test accuracy : 0.936576
Counter({3: 3813, 4: 2378, 0: 1250, 2: 1046, 1: 643})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  13.99227633047849 Time :  10011
accuracy train: 0.985095 val: 0.966463 test: 0.940467
max validation accuracy : 0.966463 max acc epoch : 8 test accuracy : 0.940467
Counter({1: 3787, 2: 2404, 0: 1253, 4: 1043, 3: 643})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  12.52869279589504 Time :  10067
accuracy train: 0.984925 val: 0.958841 test: 0.943191
max validation accuracy : 0.966463 max acc epoch : 8 test accuracy : 0.940467
Counter({1: 3815, 0: 2377, 3: 1245, 4: 1059, 2: 634})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  11.790473172906786 Time :  10100
accuracy train: 0.987974 val: 0.960366 test: 0.945525
max validation accuracy : 0.966463 max acc epoch : 8 test accuracy : 0.940467
Counter({1: 3822, 2: 2372, 4: 1248, 0: 1056, 3: 632})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  11.152326040901244 Time :  10132
accuracy train: 0.989160 val: 0.964939 test: 0.945914
max validation accuracy : 0.966463 max acc epoch : 8 test accuracy : 0.940467
Counter({1: 3825, 0: 2372, 3: 1252, 2: 1052, 4: 629})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  10.258113526273519 Time :  10165
accuracy train: 0.988821 val: 0.967988 test: 0.943580
max validation accuracy : 0.967988 max acc epoch : 12 test accuracy : 0.943580
Counter({1: 3832, 0: 2362, 2: 1260, 3: 1046, 4: 630})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  9.385417252080515 Time :  10213
accuracy train: 0.991531 val: 0.966463 test: 0.945525
max validation accuracy : 0.967988 max acc epoch : 12 test accuracy : 0.943580
Counter({2: 3832, 1: 2362, 0: 1263, 3: 1043, 4: 630})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  9.24127880949527 Time :  10247
accuracy train: 0.991870 val: 0.966463 test: 0.949416
max validation accuracy : 0.967988 max acc epoch : 12 test accuracy : 0.943580
Counter({1: 3809, 0: 2385, 4: 1268, 2: 1042, 3: 626})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  9.243385829497129 Time :  10278
accuracy train: 0.989837 val: 0.964939 test: 0.950973
max validation accuracy : 0.967988 max acc epoch : 12 test accuracy : 0.943580
Counter({1: 3809, 0: 2384, 3: 1269, 4: 1043, 2: 625})
Epoch-15 lr: 3.125e-05

Epoch :  16 loss training:  8.47273747716099 Time :  10309
accuracy train: 0.991362 val: 0.971037 test: 0.948638
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({2: 3810, 0: 2384, 4: 1270, 1: 1040, 3: 626})
Epoch-16 lr: 3.125e-05

Epoch :  17 loss training:  8.337764699943364 Time :  10345
accuracy train: 0.992378 val: 0.964939 test: 0.947471
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({2: 3810, 0: 2384, 1: 1269, 3: 1041, 4: 626})
Epoch-17 lr: 3.125e-05

Epoch :  18 loss training:  8.347650904208422 Time :  10394
accuracy train: 0.991362 val: 0.964939 test: 0.948638
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({3: 3809, 0: 2385, 2: 1271, 4: 1037, 1: 628})
Epoch-18 lr: 1.5625e-05

Epoch :  19 loss training:  8.117446696851403 Time :  10428
accuracy train: 0.992717 val: 0.967988 test: 0.946693
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({2: 3810, 1: 2385, 0: 1265, 4: 1042, 3: 628})
Epoch-19 lr: 1.5625e-05

Epoch :  20 loss training:  8.257362614851445 Time :  10461
accuracy train: 0.992886 val: 0.967988 test: 0.946304
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({1: 3810, 2: 2385, 4: 1264, 3: 1044, 0: 627})

Epoch :  21 loss training:  7.852679018629715 Time :  10495
accuracy train: 0.992378 val: 0.969512 test: 0.947860
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({0: 3811, 2: 2385, 3: 1261, 1: 1044, 4: 629})

Epoch :  22 loss training:  7.796713140094653 Time :  10555
accuracy train: 0.992886 val: 0.966463 test: 0.948249
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({0: 3814, 3: 2384, 1: 1260, 2: 1045, 4: 627})

Epoch :  23 loss training:  8.060823823325336 Time :  10585
accuracy train: 0.992547 val: 0.966463 test: 0.949805
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({0: 3815, 4: 2384, 1: 1265, 2: 1044, 3: 622})

Epoch :  24 loss training:  8.265656386036426 Time :  10618
accuracy train: 0.993056 val: 0.966463 test: 0.949027
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({0: 3817, 2: 2384, 1: 1264, 3: 1044, 4: 621})

Epoch :  25 loss training:  7.725258065620437 Time :  10653
accuracy train: 0.993056 val: 0.964939 test: 0.947860
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({2: 3819, 3: 2384, 4: 1264, 0: 1043, 1: 620})

Epoch :  26 loss training:  7.172769224271178 Time :  10710
accuracy train: 0.992886 val: 0.966463 test: 0.947860
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({1: 3820, 0: 2382, 3: 1264, 2: 1043, 4: 621})

Epoch :  27 loss training:  7.843890260672197 Time :  10740
accuracy train: 0.993225 val: 0.969512 test: 0.949416
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({2: 3819, 3: 2383, 4: 1262, 1: 1044, 0: 622})

Epoch :  28 loss training:  7.4824084574356675 Time :  10776
accuracy train: 0.993394 val: 0.963415 test: 0.948638
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({1: 3820, 3: 2382, 0: 1262, 4: 1043, 2: 623})

Epoch :  29 loss training:  7.36727778846398 Time :  10811
accuracy train: 0.993056 val: 0.964939 test: 0.949805
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({0: 3822, 1: 2379, 4: 1262, 2: 1045, 3: 622})

Epoch :  30 loss training:  7.4230477679520845 Time :  10861
accuracy train: 0.993733 val: 0.967988 test: 0.949805
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({2: 3825, 0: 2377, 3: 1261, 4: 1046, 1: 621})

Epoch :  31 loss training:  7.218541564419866 Time :  10894
accuracy train: 0.993902 val: 0.966463 test: 0.948638
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({0: 3825, 1: 2377, 4: 1264, 3: 1044, 2: 620})

Epoch :  32 loss training:  7.052218689117581 Time :  10927
accuracy train: 0.993733 val: 0.967988 test: 0.948638
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({0: 3826, 2: 2377, 3: 1262, 1: 1044, 4: 621})

Epoch :  33 loss training:  7.141581530682743 Time :  10962
accuracy train: 0.993902 val: 0.967988 test: 0.949416
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({3: 3827, 0: 2377, 1: 1262, 2: 1044, 4: 620})

Epoch :  34 loss training:  7.3360485741868615 Time :  11005
accuracy train: 0.993902 val: 0.966463 test: 0.951362
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({1: 3827, 3: 2377, 2: 1262, 4: 1043, 0: 621})

Epoch :  35 loss training:  6.982263415353373 Time :  11041
accuracy train: 0.993902 val: 0.967988 test: 0.949805
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({1: 3827, 2: 2377, 0: 1261, 4: 1043, 3: 622})

Epoch :  36 loss training:  7.029525426914915 Time :  11074
accuracy train: 0.993902 val: 0.966463 test: 0.949027
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({2: 3827, 1: 2377, 0: 1260, 3: 1043, 4: 623})

Epoch :  37 loss training:  6.861327013466507 Time :  11109
accuracy train: 0.993902 val: 0.969512 test: 0.949805
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({2: 3827, 0: 2377, 3: 1263, 4: 1041, 1: 622})

Epoch :  38 loss training:  6.632809791830368 Time :  11148
accuracy train: 0.993394 val: 0.967988 test: 0.950195
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({0: 3827, 3: 2377, 4: 1263, 2: 1041, 1: 622})

Epoch :  39 loss training:  6.558957471279427 Time :  11182
accuracy train: 0.993733 val: 0.966463 test: 0.949416
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({1: 3830, 4: 2376, 0: 1263, 3: 1040, 2: 621})

Epoch :  40 loss training:  6.392958744894713 Time :  11214
accuracy train: 0.993564 val: 0.966463 test: 0.948638
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({1: 3832, 4: 2374, 2: 1265, 3: 1038, 0: 621})

Epoch :  41 loss training:  6.419246668345295 Time :  11244
accuracy train: 0.993394 val: 0.967988 test: 0.950195
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({0: 3833, 2: 2373, 1: 1266, 3: 1038, 4: 620})

Epoch :  42 loss training:  6.449364733416587 Time :  11277
accuracy train: 0.994072 val: 0.966463 test: 0.951362
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({0: 3833, 1: 2373, 3: 1265, 4: 1038, 2: 621})

Epoch :  43 loss training:  6.477317939745262 Time :  11332
accuracy train: 0.994241 val: 0.967988 test: 0.949027
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({1: 3835, 0: 2371, 4: 1268, 3: 1035, 2: 621})

Epoch :  44 loss training:  6.397942413110286 Time :  11364
accuracy train: 0.994580 val: 0.967988 test: 0.950195
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({1: 3835, 3: 2372, 2: 1268, 0: 1034, 4: 621})

Epoch :  45 loss training:  6.028682466363534 Time :  11396
accuracy train: 0.994411 val: 0.967988 test: 0.949027
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({1: 3835, 0: 2372, 2: 1272, 4: 1032, 3: 619})

Epoch :  46 loss training:  6.103578403126448 Time :  11429
accuracy train: 0.993902 val: 0.966463 test: 0.951751
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({1: 3836, 3: 2370, 4: 1273, 0: 1031, 2: 620})

Epoch :  47 loss training:  6.650580151705071 Time :  11484
accuracy train: 0.993733 val: 0.969512 test: 0.947471
max validation accuracy : 0.971037 max acc epoch : 16 test accuracy : 0.948638
Counter({1: 3836, 2: 2370, 3: 1274, 0: 1030, 4: 620})

========================================================================================================================================================================================================
max acc epoch :  16
max validation accuracy :  0.9710365853658537
test accuracy :  0.9486381322957198
last test_accuracy :  0.9474708171206225
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='R52', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=5, num_clusters=5, num_layers=3, num_mlp_layers=1, random_vec=False, seed=926, weight_decay=0)
device :  cuda:0
Counter({2: 3108, 1: 2523, 0: 2322, 3: 1128, 4: 49})

Epoch :  1 loss training:  126.33767671883106 Time :  11524
accuracy train: 0.903625 val: 0.911585 test: 0.891829
max validation accuracy : 0.911585 max acc epoch : 1 test accuracy : 0.891829
Counter({4: 3051, 0: 2232, 2: 1733, 3: 1136, 1: 978})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  54.90244486182928 Time :  11555
accuracy train: 0.943767 val: 0.942073 test: 0.912062
max validation accuracy : 0.942073 max acc epoch : 2 test accuracy : 0.912062
Counter({3: 2880, 4: 2305, 2: 1713, 0: 1133, 1: 1099})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  39.440281093120575 Time :  11586
accuracy train: 0.952913 val: 0.946646 test: 0.927626
max validation accuracy : 0.946646 max acc epoch : 3 test accuracy : 0.927626
Counter({2: 2820, 1: 2289, 3: 1676, 4: 1195, 0: 1150})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  25.907262483611703 Time :  11646
accuracy train: 0.971206 val: 0.952744 test: 0.940078
max validation accuracy : 0.952744 max acc epoch : 4 test accuracy : 0.940078
Counter({0: 3812, 1: 2368, 2: 1234, 3: 1124, 4: 592})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  22.923330914229155 Time :  11676
accuracy train: 0.972392 val: 0.954268 test: 0.938132
max validation accuracy : 0.954268 max acc epoch : 5 test accuracy : 0.938132
Counter({0: 3794, 2: 2391, 4: 1290, 1: 1116, 3: 539})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  20.6258862093091 Time :  11707
accuracy train: 0.978659 val: 0.952744 test: 0.937743
max validation accuracy : 0.954268 max acc epoch : 5 test accuracy : 0.938132
Counter({0: 3814, 1: 2380, 2: 1272, 4: 1118, 3: 546})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  16.1228995481506 Time :  11739
accuracy train: 0.978150 val: 0.948171 test: 0.944747
max validation accuracy : 0.954268 max acc epoch : 5 test accuracy : 0.938132
Counter({1: 3816, 2: 2376, 3: 1307, 0: 1099, 4: 532})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  13.912885800935328 Time :  11781
accuracy train: 0.984925 val: 0.963415 test: 0.942412
max validation accuracy : 0.963415 max acc epoch : 8 test accuracy : 0.942412
Counter({0: 3790, 2: 2399, 4: 1297, 3: 1090, 1: 554})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  12.890419040806592 Time :  11816
accuracy train: 0.984925 val: 0.960366 test: 0.942802
max validation accuracy : 0.963415 max acc epoch : 8 test accuracy : 0.942412
Counter({0: 3794, 2: 2395, 3: 1292, 4: 1091, 1: 558})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  11.805784951429814 Time :  11847
accuracy train: 0.988144 val: 0.958841 test: 0.945525
max validation accuracy : 0.963415 max acc epoch : 8 test accuracy : 0.942412
Counter({1: 3802, 2: 2394, 3: 1279, 4: 1090, 0: 565})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  11.628669116646051 Time :  11877
accuracy train: 0.989668 val: 0.963415 test: 0.946304
max validation accuracy : 0.963415 max acc epoch : 8 test accuracy : 0.942412
Counter({2: 3801, 1: 2397, 4: 1272, 3: 1081, 0: 579})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  10.573312550084665 Time :  11910
accuracy train: 0.988991 val: 0.961890 test: 0.943969
max validation accuracy : 0.963415 max acc epoch : 8 test accuracy : 0.942412
Counter({2: 3802, 3: 2395, 0: 1272, 4: 1078, 1: 583})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  9.408217197516933 Time :  11963
accuracy train: 0.991192 val: 0.960366 test: 0.943969
max validation accuracy : 0.963415 max acc epoch : 8 test accuracy : 0.942412
Counter({2: 3801, 1: 2398, 4: 1269, 0: 1078, 3: 584})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  9.142348488792777 Time :  11991
accuracy train: 0.991701 val: 0.960366 test: 0.948638
max validation accuracy : 0.963415 max acc epoch : 8 test accuracy : 0.942412
Counter({1: 3804, 2: 2393, 4: 1270, 0: 1080, 3: 583})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  9.52640155563131 Time :  12020
accuracy train: 0.990684 val: 0.961890 test: 0.947860
max validation accuracy : 0.963415 max acc epoch : 8 test accuracy : 0.942412
Counter({0: 3805, 1: 2394, 2: 1270, 3: 1079, 4: 582})
Epoch-15 lr: 3.125e-05

Epoch :  16 loss training:  8.827803282998502 Time :  12053
accuracy train: 0.991192 val: 0.963415 test: 0.946304
max validation accuracy : 0.963415 max acc epoch : 8 test accuracy : 0.942412
Counter({1: 3806, 4: 2394, 0: 1267, 3: 1081, 2: 582})
Epoch-16 lr: 3.125e-05

Epoch :  17 loss training:  8.650142471306026 Time :  12109
accuracy train: 0.991870 val: 0.961890 test: 0.944747
max validation accuracy : 0.963415 max acc epoch : 8 test accuracy : 0.942412
Counter({1: 3809, 4: 2391, 2: 1267, 3: 1080, 0: 583})
Epoch-17 lr: 3.125e-05

Epoch :  18 loss training:  8.41511625610292 Time :  12141
accuracy train: 0.991531 val: 0.961890 test: 0.945525
max validation accuracy : 0.963415 max acc epoch : 8 test accuracy : 0.942412
Counter({1: 3809, 4: 2390, 2: 1268, 3: 1080, 0: 583})
Epoch-18 lr: 1.5625e-05

Epoch :  19 loss training:  8.257920617237687 Time :  12171
accuracy train: 0.992378 val: 0.964939 test: 0.943580
max validation accuracy : 0.964939 max acc epoch : 19 test accuracy : 0.943580
Counter({0: 3810, 1: 2392, 4: 1265, 3: 1080, 2: 583})
Epoch-19 lr: 1.5625e-05

Epoch :  20 loss training:  7.733956746291369 Time :  12202
accuracy train: 0.992209 val: 0.963415 test: 0.943969
max validation accuracy : 0.964939 max acc epoch : 19 test accuracy : 0.943580
Counter({1: 3815, 0: 2387, 2: 1264, 3: 1080, 4: 584})

Epoch :  21 loss training:  8.229216991690919 Time :  12240
accuracy train: 0.991701 val: 0.963415 test: 0.946304
max validation accuracy : 0.964939 max acc epoch : 19 test accuracy : 0.943580
Counter({1: 3816, 0: 2387, 2: 1266, 4: 1077, 3: 584})

Epoch :  22 loss training:  7.977375977206975 Time :  12277
accuracy train: 0.992547 val: 0.961890 test: 0.945136
max validation accuracy : 0.964939 max acc epoch : 19 test accuracy : 0.943580
Counter({0: 3818, 3: 2386, 1: 1261, 4: 1079, 2: 586})

Epoch :  23 loss training:  7.821941399946809 Time :  12311
accuracy train: 0.993225 val: 0.960366 test: 0.945136
max validation accuracy : 0.964939 max acc epoch : 19 test accuracy : 0.943580
Counter({2: 3818, 3: 2386, 0: 1262, 1: 1079, 4: 585})

Epoch :  24 loss training:  7.8177375993691385 Time :  12343
accuracy train: 0.993394 val: 0.961890 test: 0.945525
max validation accuracy : 0.964939 max acc epoch : 19 test accuracy : 0.943580
Counter({1: 3822, 3: 2384, 2: 1261, 4: 1077, 0: 586})

Epoch :  25 loss training:  7.247864583041519 Time :  12384
accuracy train: 0.993225 val: 0.961890 test: 0.947471
max validation accuracy : 0.964939 max acc epoch : 19 test accuracy : 0.943580
Counter({0: 3822, 4: 2385, 3: 1260, 2: 1077, 1: 586})

Epoch :  26 loss training:  8.090060253627598 Time :  12427
accuracy train: 0.992886 val: 0.960366 test: 0.946304
max validation accuracy : 0.964939 max acc epoch : 19 test accuracy : 0.943580
Counter({1: 3822, 0: 2385, 4: 1260, 3: 1077, 2: 586})

Epoch :  27 loss training:  7.5684264921583235 Time :  12463
accuracy train: 0.993056 val: 0.963415 test: 0.948249
max validation accuracy : 0.964939 max acc epoch : 19 test accuracy : 0.943580
Counter({0: 3822, 1: 2387, 2: 1258, 4: 1077, 3: 586})

Epoch :  28 loss training:  7.52632165607065 Time :  12493
accuracy train: 0.993564 val: 0.961890 test: 0.946304
max validation accuracy : 0.964939 max acc epoch : 19 test accuracy : 0.943580
Counter({1: 3823, 2: 2385, 0: 1259, 3: 1076, 4: 587})

Epoch :  29 loss training:  7.202667772304267 Time :  12529
accuracy train: 0.993225 val: 0.961890 test: 0.947471
max validation accuracy : 0.964939 max acc epoch : 19 test accuracy : 0.943580
Counter({0: 3824, 1: 2383, 3: 1262, 4: 1074, 2: 587})

Epoch :  30 loss training:  7.607367086689919 Time :  12575
accuracy train: 0.993733 val: 0.963415 test: 0.947471
max validation accuracy : 0.964939 max acc epoch : 19 test accuracy : 0.943580
Counter({1: 3824, 2: 2384, 4: 1263, 3: 1072, 0: 587})

Epoch :  31 loss training:  7.817053040955216 Time :  12607
accuracy train: 0.993902 val: 0.964939 test: 0.947082
max validation accuracy : 0.964939 max acc epoch : 19 test accuracy : 0.943580
Counter({1: 3824, 2: 2384, 3: 1265, 0: 1070, 4: 587})

Epoch :  32 loss training:  7.1992023745551705 Time :  12643
accuracy train: 0.993902 val: 0.963415 test: 0.948249
max validation accuracy : 0.964939 max acc epoch : 19 test accuracy : 0.943580
Counter({0: 3826, 2: 2382, 4: 1264, 1: 1071, 3: 587})

Epoch :  33 loss training:  7.162442619446665 Time :  12678
accuracy train: 0.994241 val: 0.964939 test: 0.948249
max validation accuracy : 0.964939 max acc epoch : 19 test accuracy : 0.943580
Counter({1: 3828, 4: 2381, 0: 1262, 2: 1072, 3: 587})

Epoch :  34 loss training:  7.282357268966734 Time :  12730
accuracy train: 0.993564 val: 0.963415 test: 0.947860
max validation accuracy : 0.964939 max acc epoch : 19 test accuracy : 0.943580
Counter({1: 3831, 3: 2379, 4: 1261, 0: 1072, 2: 587})

Epoch :  35 loss training:  7.282522695604712 Time :  12770
accuracy train: 0.994072 val: 0.961890 test: 0.949027
max validation accuracy : 0.964939 max acc epoch : 19 test accuracy : 0.943580
Counter({1: 3831, 0: 2379, 3: 1265, 2: 1068, 4: 587})

Epoch :  36 loss training:  6.545143420342356 Time :  12805
accuracy train: 0.993902 val: 0.966463 test: 0.949027
max validation accuracy : 0.966463 max acc epoch : 36 test accuracy : 0.949027
Counter({0: 3831, 2: 2378, 1: 1266, 3: 1068, 4: 587})

Epoch :  37 loss training:  6.96334178512916 Time :  12845
accuracy train: 0.994241 val: 0.964939 test: 0.947471
max validation accuracy : 0.966463 max acc epoch : 36 test accuracy : 0.949027
Counter({1: 3834, 2: 2376, 4: 1267, 0: 1067, 3: 586})

Epoch :  38 loss training:  6.644531960366294 Time :  12892
accuracy train: 0.993902 val: 0.964939 test: 0.947471
max validation accuracy : 0.966463 max acc epoch : 36 test accuracy : 0.949027
Counter({1: 3837, 4: 2373, 0: 1268, 3: 1068, 2: 584})

Epoch :  39 loss training:  6.9101529468316585 Time :  12931
accuracy train: 0.994411 val: 0.966463 test: 0.949416
max validation accuracy : 0.966463 max acc epoch : 36 test accuracy : 0.949027
Counter({1: 3838, 3: 2373, 4: 1267, 0: 1069, 2: 583})

Epoch :  40 loss training:  6.92095913621597 Time :  12966
accuracy train: 0.993902 val: 0.964939 test: 0.949416
max validation accuracy : 0.966463 max acc epoch : 36 test accuracy : 0.949027
Counter({1: 3838, 3: 2373, 4: 1266, 0: 1069, 2: 584})

Epoch :  41 loss training:  6.609701451379806 Time :  13010
accuracy train: 0.993733 val: 0.966463 test: 0.949027
max validation accuracy : 0.966463 max acc epoch : 36 test accuracy : 0.949027
Counter({1: 3839, 2: 2372, 0: 1271, 3: 1067, 4: 581})

Epoch :  42 loss training:  6.373092637397349 Time :  13049
accuracy train: 0.994072 val: 0.963415 test: 0.949027
max validation accuracy : 0.966463 max acc epoch : 36 test accuracy : 0.949027
Counter({1: 3839, 3: 2372, 2: 1272, 4: 1067, 0: 580})

Epoch :  43 loss training:  6.672235244885087 Time :  13084
accuracy train: 0.994241 val: 0.963415 test: 0.947860
max validation accuracy : 0.966463 max acc epoch : 36 test accuracy : 0.949027
Counter({0: 3839, 3: 2372, 2: 1272, 4: 1066, 1: 581})

Epoch :  44 loss training:  6.133567712269723 Time :  13117
accuracy train: 0.995257 val: 0.966463 test: 0.949416
max validation accuracy : 0.966463 max acc epoch : 36 test accuracy : 0.949027
Counter({0: 3841, 3: 2371, 2: 1271, 1: 1067, 4: 580})

Epoch :  45 loss training:  6.481725308578461 Time :  13157
accuracy train: 0.994411 val: 0.967988 test: 0.950195
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({1: 3842, 0: 2370, 4: 1268, 3: 1068, 2: 582})

Epoch :  46 loss training:  5.919005109928548 Time :  13203
accuracy train: 0.994241 val: 0.967988 test: 0.948638
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({0: 3842, 2: 2372, 3: 1268, 1: 1068, 4: 580})

Epoch :  47 loss training:  6.365388838807121 Time :  13234
accuracy train: 0.994241 val: 0.967988 test: 0.945525
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({0: 3842, 1: 2371, 2: 1270, 3: 1067, 4: 580})

Epoch :  48 loss training:  6.049500499619171 Time :  13266
accuracy train: 0.994580 val: 0.966463 test: 0.946304
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({0: 3843, 2: 2368, 3: 1273, 4: 1065, 1: 581})

Epoch :  49 loss training:  6.067004635930061 Time :  13298
accuracy train: 0.995257 val: 0.966463 test: 0.948638
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({0: 3844, 1: 2367, 2: 1273, 3: 1065, 4: 581})

Epoch :  50 loss training:  6.410832356894389 Time :  13356
accuracy train: 0.994580 val: 0.964939 test: 0.948638
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({1: 3846, 3: 2365, 0: 1278, 4: 1059, 2: 582})

Epoch :  51 loss training:  5.856794256484136 Time :  13389
accuracy train: 0.995088 val: 0.967988 test: 0.946693
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({1: 3848, 0: 2363, 3: 1277, 2: 1060, 4: 582})

Epoch :  52 loss training:  6.063204066362232 Time :  13425
accuracy train: 0.994580 val: 0.963415 test: 0.947471
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({1: 3849, 0: 2361, 4: 1285, 2: 1054, 3: 581})

Epoch :  53 loss training:  6.037394946906716 Time :  13459
accuracy train: 0.995088 val: 0.963415 test: 0.947471
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({1: 3851, 2: 2360, 0: 1292, 3: 1049, 4: 578})

Epoch :  54 loss training:  5.886541754473001 Time :  13513
accuracy train: 0.994749 val: 0.963415 test: 0.949027
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({1: 3852, 2: 2359, 0: 1293, 4: 1048, 3: 578})

Epoch :  55 loss training:  5.6445677150040865 Time :  13544
accuracy train: 0.995257 val: 0.963415 test: 0.948249
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({0: 3855, 3: 2356, 1: 1292, 2: 1048, 4: 579})

Epoch :  56 loss training:  5.63294332055375 Time :  13575
accuracy train: 0.994749 val: 0.964939 test: 0.949027
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({2: 3855, 0: 2354, 4: 1294, 1: 1048, 3: 579})

Epoch :  57 loss training:  5.469291490735486 Time :  13608
accuracy train: 0.994749 val: 0.964939 test: 0.947860
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({2: 3855, 0: 2354, 3: 1293, 1: 1048, 4: 580})

Epoch :  58 loss training:  5.68056405428797 Time :  13658
accuracy train: 0.995088 val: 0.963415 test: 0.948638
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({0: 3856, 2: 2354, 3: 1292, 4: 1048, 1: 580})

Epoch :  59 loss training:  5.780420560855418 Time :  13690
accuracy train: 0.994919 val: 0.964939 test: 0.947082
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({0: 3856, 4: 2354, 3: 1290, 1: 1047, 2: 583})

Epoch :  60 loss training:  5.340583158424124 Time :  13726
accuracy train: 0.995088 val: 0.963415 test: 0.949027
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({0: 3859, 1: 2351, 2: 1289, 3: 1048, 4: 583})

Epoch :  61 loss training:  5.052986880298704 Time :  13762
accuracy train: 0.995088 val: 0.963415 test: 0.947860
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({0: 3858, 1: 2352, 2: 1288, 3: 1048, 4: 584})

Epoch :  62 loss training:  5.4438968047033995 Time :  13805
accuracy train: 0.994749 val: 0.964939 test: 0.949027
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({1: 3858, 4: 2351, 0: 1293, 2: 1045, 3: 583})

Epoch :  63 loss training:  5.279432363575324 Time :  13846
accuracy train: 0.995257 val: 0.963415 test: 0.947860
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({0: 3857, 3: 2352, 4: 1292, 1: 1046, 2: 583})

Epoch :  64 loss training:  4.832525159232318 Time :  13876
accuracy train: 0.994919 val: 0.963415 test: 0.949416
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({1: 3859, 0: 2351, 4: 1290, 3: 1047, 2: 583})

Epoch :  65 loss training:  5.242154984502122 Time :  13907
accuracy train: 0.995257 val: 0.960366 test: 0.946304
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({1: 3864, 3: 2345, 0: 1290, 4: 1048, 2: 583})

Epoch :  66 loss training:  5.476902469410561 Time :  13945
accuracy train: 0.995088 val: 0.963415 test: 0.949027
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({0: 3867, 2: 2342, 4: 1293, 3: 1046, 1: 582})

Epoch :  67 loss training:  4.849710991373286 Time :  13990
accuracy train: 0.995596 val: 0.964939 test: 0.947471
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({1: 3868, 2: 2340, 3: 1294, 0: 1046, 4: 582})

Epoch :  68 loss training:  4.835045751184225 Time :  14024
accuracy train: 0.995596 val: 0.963415 test: 0.950195
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({1: 3869, 2: 2339, 4: 1298, 3: 1042, 0: 582})

Epoch :  69 loss training:  5.18201017123647 Time :  14055
accuracy train: 0.995935 val: 0.961890 test: 0.947082
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({0: 3869, 2: 2338, 1: 1297, 3: 1045, 4: 581})

Epoch :  70 loss training:  4.818846915382892 Time :  14088
accuracy train: 0.995766 val: 0.964939 test: 0.950973
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({0: 3870, 1: 2337, 2: 1296, 4: 1046, 3: 581})

Epoch :  71 loss training:  4.495674792444333 Time :  14146
accuracy train: 0.995596 val: 0.964939 test: 0.948249
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({2: 3870, 1: 2336, 4: 1297, 0: 1046, 3: 581})

Epoch :  72 loss training:  4.845105588086881 Time :  14182
accuracy train: 0.995766 val: 0.963415 test: 0.949805
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({0: 3870, 1: 2335, 2: 1296, 4: 1047, 3: 582})

Epoch :  73 loss training:  4.668366165831685 Time :  14217
accuracy train: 0.995257 val: 0.963415 test: 0.949027
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({0: 3872, 4: 2332, 1: 1298, 3: 1048, 2: 580})

Epoch :  74 loss training:  4.57359683373943 Time :  14251
accuracy train: 0.995596 val: 0.963415 test: 0.949416
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({1: 3872, 3: 2331, 0: 1300, 2: 1048, 4: 579})

Epoch :  75 loss training:  4.8488114324864 Time :  14307
accuracy train: 0.995766 val: 0.964939 test: 0.947471
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({1: 3872, 4: 2332, 0: 1299, 3: 1048, 2: 579})

Epoch :  76 loss training:  4.650312841404229 Time :  14339
accuracy train: 0.995257 val: 0.960366 test: 0.949027
max validation accuracy : 0.967988 max acc epoch : 45 test accuracy : 0.950195
Counter({1: 3872, 0: 2331, 3: 1300, 2: 1048, 4: 579})

========================================================================================================================================================================================================
max acc epoch :  45
max validation accuracy :  0.9679878048780488
test accuracy :  0.9501945525291828
last test_accuracy :  0.9490272373540856
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.96951 	 test_accuracy : 0.94669 	 max_acc epoch :  16 	 last test_accuracy : 0.94514
k :  1 	 val_accuracy : 0.97256 	 test_accuracy : 0.94864 	 max_acc epoch :  45 	 last test_accuracy : 0.94942
k :  2 	 val_accuracy : 0.97256 	 test_accuracy : 0.95019 	 max_acc epoch :  84 	 last test_accuracy : 0.94864
k :  3 	 val_accuracy : 0.97104 	 test_accuracy : 0.94864 	 max_acc epoch :  16 	 last test_accuracy : 0.94747
k :  4 	 val_accuracy : 0.96799 	 test_accuracy : 0.95019 	 max_acc epoch :  45 	 last test_accuracy : 0.94903

avg :  	 val_accuracy : 0.97073 	 test_accuracy : 0.94887 	 last_accuracy : 0.94794
