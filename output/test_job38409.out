

date and time :  Mon Jul  5 00:43:15 2021
itr : 0
Namespace(batch_size=64, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=161, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0
min_len_of_sentence : 0
max_len_of_sentence : 7408
min_num_of_sentence : 1
max_num_of_sentence : 1205
average_len_of_sentence: 12.408556369315274
average_num_of_sentence: 15.765255226573277
Total_num_of_sentence : 297112
Counter({'rec.sport.hockey': 999, 'soc.religion.christian': 997, 'rec.motorcycles': 996, 'rec.sport.baseball': 994, 'sci.crypt': 991, 'rec.autos': 990, 'sci.med': 990, 'comp.windows.x': 988, 'sci.space': 987, 'comp.os.ms-windows.misc': 985, 'sci.electronics': 984, 'comp.sys.ibm.pc.hardware': 982, 'misc.forsale': 975, 'comp.graphics': 973, 'comp.sys.mac.hardware': 963, 'talk.politics.mideast': 940, 'talk.politics.guns': 910, 'alt.atheism': 799, 'talk.politics.misc': 775, 'talk.religion.misc': 628})
Total_number_of_words: 36712
Total_number_of_categories: 20
vocab size : 36712
got embeddings of : 28750
Counter({1: 7576, 2: 6348, 0: 4922})

Epoch :  1 loss training:  333.26097536087036 Time :  272
accuracy train: 0.794265 val: 0.759505 test: 0.726500
max validation accuracy : 0.759505 max acc epoch : 1 test accuracy : 0.726500
Counter({1: 7415, 2: 6134, 0: 5297})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  208.7913086861372 Time :  364
accuracy train: 0.839635 val: 0.806366 test: 0.763144
max validation accuracy : 0.806366 max acc epoch : 2 test accuracy : 0.763144
Counter({2: 7127, 0: 6597, 1: 5122})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  180.73492228984833 Time :  459
accuracy train: 0.875381 val: 0.827586 test: 0.779076
max validation accuracy : 0.827586 max acc epoch : 3 test accuracy : 0.779076
Counter({2: 7435, 1: 6492, 0: 4919})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  132.05831206589937 Time :  558
accuracy train: 0.914171 val: 0.860301 test: 0.793813
max validation accuracy : 0.860301 max acc epoch : 4 test accuracy : 0.793813
Counter({1: 7807, 0: 6528, 2: 4511})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  118.2455999404192 Time :  649
accuracy train: 0.924187 val: 0.874447 test: 0.798593
max validation accuracy : 0.874447 max acc epoch : 5 test accuracy : 0.798593
Counter({1: 7820, 2: 6523, 0: 4503})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  111.51321403682232 Time :  740
accuracy train: 0.924875 val: 0.870911 test: 0.806691
max validation accuracy : 0.874447 max acc epoch : 5 test accuracy : 0.798593
Counter({1: 7769, 0: 6563, 2: 4514})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  93.80238969624043 Time :  833
accuracy train: 0.942158 val: 0.877984 test: 0.810276
max validation accuracy : 0.877984 max acc epoch : 7 test accuracy : 0.810276
Counter({1: 7780, 2: 6631, 0: 4435})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  89.3527057133615 Time :  925
accuracy train: 0.948345 val: 0.878868 test: 0.808019
max validation accuracy : 0.878868 max acc epoch : 8 test accuracy : 0.808019
Counter({1: 7840, 0: 6580, 2: 4426})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  83.52153921872377 Time :  1016
accuracy train: 0.950997 val: 0.879752 test: 0.813728
max validation accuracy : 0.879752 max acc epoch : 9 test accuracy : 0.813728
Counter({0: 7792, 1: 6629, 2: 4425})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  73.52794421091676 Time :  1105
accuracy train: 0.956693 val: 0.883289 test: 0.815189
max validation accuracy : 0.883289 max acc epoch : 10 test accuracy : 0.815189
Counter({1: 7739, 2: 6680, 0: 4427})

Epoch :  11 loss training:  71.83604452759027 Time :  1205
accuracy train: 0.962978 val: 0.888594 test: 0.815587
max validation accuracy : 0.888594 max acc epoch : 11 test accuracy : 0.815587
Counter({1: 7676, 0: 6748, 2: 4422})

Epoch :  12 loss training:  64.249203722924 Time :  1305
accuracy train: 0.970539 val: 0.892131 test: 0.823022
max validation accuracy : 0.892131 max acc epoch : 12 test accuracy : 0.823022
Counter({1: 7657, 2: 6771, 0: 4418})

Epoch :  13 loss training:  57.33260917104781 Time :  1411
accuracy train: 0.973387 val: 0.891247 test: 0.826075
max validation accuracy : 0.892131 max acc epoch : 12 test accuracy : 0.823022
Counter({2: 7669, 1: 6773, 0: 4404})

Epoch :  14 loss training:  52.37874551676214 Time :  1509
accuracy train: 0.980163 val: 0.895668 test: 0.826872
max validation accuracy : 0.895668 max acc epoch : 14 test accuracy : 0.826872
Counter({1: 7620, 0: 6818, 2: 4408})

Epoch :  15 loss training:  46.697377199307084 Time :  1608
accuracy train: 0.981636 val: 0.894783 test: 0.829262
max validation accuracy : 0.895668 max acc epoch : 14 test accuracy : 0.826872
Counter({2: 7476, 0: 6945, 1: 4425})

Epoch :  16 loss training:  41.620278637856245 Time :  1711
accuracy train: 0.983895 val: 0.899204 test: 0.829262
max validation accuracy : 0.899204 max acc epoch : 16 test accuracy : 0.829262
Counter({0: 7431, 2: 6982, 1: 4433})

Epoch :  17 loss training:  35.3637895071879 Time :  1810
accuracy train: 0.988805 val: 0.908046 test: 0.830722
max validation accuracy : 0.908046 max acc epoch : 17 test accuracy : 0.830722
Counter({1: 7417, 0: 7011, 2: 4418})

Epoch :  18 loss training:  33.617603197693825 Time :  1909
accuracy train: 0.991849 val: 0.904509 test: 0.832315
max validation accuracy : 0.908046 max acc epoch : 17 test accuracy : 0.830722
Counter({2: 7474, 0: 7022, 1: 4350})

Epoch :  19 loss training:  29.14197943918407 Time :  2011
accuracy train: 0.993322 val: 0.906278 test: 0.835369
max validation accuracy : 0.908046 max acc epoch : 17 test accuracy : 0.830722
Counter({1: 7432, 2: 7068, 0: 4346})

Epoch :  20 loss training:  25.061035252176225 Time :  2107
accuracy train: 0.994108 val: 0.913351 test: 0.835104
max validation accuracy : 0.913351 max acc epoch : 20 test accuracy : 0.835104
Counter({1: 7325, 0: 7183, 2: 4338})

Epoch :  21 loss training:  23.155774788931012 Time :  2198
accuracy train: 0.996072 val: 0.909814 test: 0.839618
max validation accuracy : 0.913351 max acc epoch : 20 test accuracy : 0.835104
Counter({0: 7255, 2: 7252, 1: 4339})

Epoch :  22 loss training:  21.003170411568135 Time :  2289
accuracy train: 0.996563 val: 0.911583 test: 0.837095
max validation accuracy : 0.913351 max acc epoch : 20 test accuracy : 0.835104
Counter({0: 7419, 2: 7091, 1: 4336})

Epoch :  23 loss training:  17.99806088069454 Time :  2379
accuracy train: 0.997152 val: 0.908930 test: 0.838688
max validation accuracy : 0.913351 max acc epoch : 20 test accuracy : 0.835104
Counter({2: 7434, 0: 7092, 1: 4320})

Epoch :  24 loss training:  16.05799108929932 Time :  2471
accuracy train: 0.997741 val: 0.913351 test: 0.838290
max validation accuracy : 0.913351 max acc epoch : 20 test accuracy : 0.835104
Counter({0: 7449, 1: 7073, 2: 4324})

Epoch :  25 loss training:  14.516992748482153 Time :  2573
accuracy train: 0.998429 val: 0.909814 test: 0.839219
max validation accuracy : 0.913351 max acc epoch : 20 test accuracy : 0.835104
Counter({2: 7496, 0: 7049, 1: 4301})

Epoch :  26 loss training:  13.391149838804267 Time :  2676
accuracy train: 0.998527 val: 0.916004 test: 0.840281
max validation accuracy : 0.916004 max acc epoch : 26 test accuracy : 0.840281
Counter({0: 7531, 2: 7033, 1: 4282})

Epoch :  27 loss training:  11.211202294914983 Time :  2784
accuracy train: 0.999116 val: 0.912467 test: 0.841476
max validation accuracy : 0.916004 max acc epoch : 26 test accuracy : 0.840281
Counter({0: 7593, 1: 6987, 2: 4266})

Epoch :  28 loss training:  10.577106531243771 Time :  2886
accuracy train: 0.998920 val: 0.913351 test: 0.843070
max validation accuracy : 0.916004 max acc epoch : 26 test accuracy : 0.840281
Counter({0: 7617, 2: 6968, 1: 4261})

Epoch :  29 loss training:  8.976482767844573 Time :  2987
accuracy train: 0.999116 val: 0.909814 test: 0.843335
max validation accuracy : 0.916004 max acc epoch : 26 test accuracy : 0.840281
Counter({0: 7625, 1: 6960, 2: 4261})

Epoch :  30 loss training:  9.274030292057432 Time :  3093
accuracy train: 0.999411 val: 0.916888 test: 0.843999
max validation accuracy : 0.916888 max acc epoch : 30 test accuracy : 0.843999
Counter({0: 7666, 2: 6937, 1: 4243})

Epoch :  31 loss training:  7.095356721489225 Time :  3195
accuracy train: 0.999214 val: 0.915119 test: 0.843335
max validation accuracy : 0.916888 max acc epoch : 30 test accuracy : 0.843999
Counter({2: 7679, 0: 6928, 1: 4239})

Epoch :  32 loss training:  7.213421203428879 Time :  3293
accuracy train: 0.999313 val: 0.918656 test: 0.842937
max validation accuracy : 0.918656 max acc epoch : 32 test accuracy : 0.842937
Counter({2: 7683, 0: 6920, 1: 4243})

Epoch :  33 loss training:  6.516992768854834 Time :  3400
accuracy train: 0.999116 val: 0.916004 test: 0.844397
max validation accuracy : 0.918656 max acc epoch : 32 test accuracy : 0.842937
Counter({2: 7693, 0: 6912, 1: 4241})

Epoch :  34 loss training:  5.599305717361858 Time :  3510
accuracy train: 0.999411 val: 0.915119 test: 0.846920
max validation accuracy : 0.918656 max acc epoch : 32 test accuracy : 0.842937
Counter({0: 7756, 1: 6856, 2: 4234})

Epoch :  35 loss training:  5.7591873538913205 Time :  3616
accuracy train: 0.999214 val: 0.914235 test: 0.847451
max validation accuracy : 0.918656 max acc epoch : 32 test accuracy : 0.842937
Counter({0: 7773, 1: 6835, 2: 4238})

Epoch :  36 loss training:  5.537891742947977 Time :  3720
accuracy train: 0.999313 val: 0.916888 test: 0.843999
max validation accuracy : 0.918656 max acc epoch : 32 test accuracy : 0.842937
Counter({0: 7782, 2: 6832, 1: 4232})

Epoch :  37 loss training:  4.664373648818582 Time :  3824
accuracy train: 0.999313 val: 0.917772 test: 0.847716
max validation accuracy : 0.918656 max acc epoch : 32 test accuracy : 0.842937
Counter({1: 7781, 2: 6835, 0: 4230})

Epoch :  38 loss training:  4.189778386207763 Time :  3932
accuracy train: 0.999313 val: 0.921309 test: 0.849044
max validation accuracy : 0.921309 max acc epoch : 38 test accuracy : 0.849044
Counter({2: 7786, 0: 6827, 1: 4233})

Epoch :  39 loss training:  4.234371468453901 Time :  4041
accuracy train: 0.999313 val: 0.918656 test: 0.847982
max validation accuracy : 0.921309 max acc epoch : 38 test accuracy : 0.849044
Counter({0: 7783, 1: 6845, 2: 4218})

Epoch :  40 loss training:  3.999227189575322 Time :  4145
accuracy train: 0.999411 val: 0.915119 test: 0.846920
max validation accuracy : 0.921309 max acc epoch : 38 test accuracy : 0.849044
Counter({1: 7783, 0: 6844, 2: 4219})

Epoch :  41 loss training:  4.071522878133692 Time :  4246
accuracy train: 0.999313 val: 0.917772 test: 0.849177
max validation accuracy : 0.921309 max acc epoch : 38 test accuracy : 0.849044
Counter({1: 7793, 0: 6846, 2: 4207})

Epoch :  42 loss training:  3.98160913400352 Time :  4348
accuracy train: 0.999116 val: 0.923077 test: 0.851301
max validation accuracy : 0.923077 max acc epoch : 42 test accuracy : 0.851301
Counter({2: 7796, 1: 6845, 0: 4205})

Epoch :  43 loss training:  3.8237230080121662 Time :  4454
accuracy train: 0.999313 val: 0.916004 test: 0.850372
max validation accuracy : 0.923077 max acc epoch : 42 test accuracy : 0.851301
Counter({2: 7797, 0: 6835, 1: 4214})

Epoch :  44 loss training:  2.9226315253181383 Time :  4557
accuracy train: 0.999313 val: 0.920424 test: 0.849442
max validation accuracy : 0.923077 max acc epoch : 42 test accuracy : 0.851301
Counter({2: 7823, 0: 6829, 1: 4194})

Epoch :  45 loss training:  2.9969083780160872 Time :  4653
accuracy train: 0.999313 val: 0.917772 test: 0.848779
max validation accuracy : 0.923077 max acc epoch : 42 test accuracy : 0.851301
Counter({2: 7833, 1: 6823, 0: 4190})

Epoch :  46 loss training:  3.3747784650040558 Time :  4742
accuracy train: 0.999509 val: 0.922193 test: 0.851301
max validation accuracy : 0.923077 max acc epoch : 42 test accuracy : 0.851301
Counter({0: 7851, 1: 6827, 2: 4168})

Epoch :  47 loss training:  2.7387862281611888 Time :  4832
accuracy train: 0.999411 val: 0.921309 test: 0.853691
max validation accuracy : 0.923077 max acc epoch : 42 test accuracy : 0.851301
Counter({2: 7857, 1: 6821, 0: 4168})

Epoch :  48 loss training:  2.356570169562474 Time :  4921
accuracy train: 0.999411 val: 0.921309 test: 0.851965
max validation accuracy : 0.923077 max acc epoch : 42 test accuracy : 0.851301
Counter({1: 7860, 2: 6817, 0: 4169})

Epoch :  49 loss training:  2.4421259680675576 Time :  5011
accuracy train: 0.999116 val: 0.921309 test: 0.849708
max validation accuracy : 0.923077 max acc epoch : 42 test accuracy : 0.851301
Counter({0: 7866, 1: 6816, 2: 4164})

Epoch :  50 loss training:  2.398435342402081 Time :  5100
accuracy train: 0.999509 val: 0.916888 test: 0.847982
max validation accuracy : 0.923077 max acc epoch : 42 test accuracy : 0.851301
Counter({2: 7861, 1: 6815, 0: 4170})

Epoch :  51 loss training:  2.11973144163494 Time :  5190
accuracy train: 0.999411 val: 0.924845 test: 0.851036
max validation accuracy : 0.924845 max acc epoch : 51 test accuracy : 0.851036
Counter({2: 7856, 1: 6822, 0: 4168})

Epoch :  52 loss training:  2.3866090829251334 Time :  5280
accuracy train: 0.999411 val: 0.917772 test: 0.849310
max validation accuracy : 0.924845 max acc epoch : 51 test accuracy : 0.851036
Counter({2: 7860, 1: 6816, 0: 4170})

Epoch :  53 loss training:  1.6214809705707012 Time :  5369
accuracy train: 0.999313 val: 0.919540 test: 0.844397
max validation accuracy : 0.924845 max acc epoch : 51 test accuracy : 0.851036
Counter({0: 7874, 1: 6802, 2: 4170})

Epoch :  54 loss training:  2.5890865305627813 Time :  5461
accuracy train: 0.999411 val: 0.917772 test: 0.851301
max validation accuracy : 0.924845 max acc epoch : 51 test accuracy : 0.851036
Counter({1: 7875, 2: 6803, 0: 4168})

Epoch :  55 loss training:  2.97774975100765 Time :  5550
accuracy train: 0.999411 val: 0.923961 test: 0.847584
max validation accuracy : 0.924845 max acc epoch : 51 test accuracy : 0.851036
Counter({2: 7874, 1: 6799, 0: 4173})

Epoch :  56 loss training:  2.144765543311223 Time :  5640
accuracy train: 0.999214 val: 0.923961 test: 0.850505
max validation accuracy : 0.924845 max acc epoch : 51 test accuracy : 0.851036
Counter({0: 7876, 1: 6799, 2: 4171})

Epoch :  57 loss training:  1.4030931764064007 Time :  5730
accuracy train: 0.999214 val: 0.923077 test: 0.849973
max validation accuracy : 0.924845 max acc epoch : 51 test accuracy : 0.851036
Counter({0: 7877, 2: 6799, 1: 4170})

Epoch :  58 loss training:  2.145315205445513 Time :  5818
accuracy train: 0.999411 val: 0.925729 test: 0.849044
max validation accuracy : 0.925729 max acc epoch : 58 test accuracy : 0.849044
Counter({0: 7881, 2: 6800, 1: 4165})

Epoch :  59 loss training:  2.4591431267435837 Time :  5911
accuracy train: 0.999411 val: 0.923961 test: 0.845725
max validation accuracy : 0.925729 max acc epoch : 58 test accuracy : 0.849044
Counter({0: 7881, 1: 6799, 2: 4166})

Epoch :  60 loss training:  2.224206846229208 Time :  6000
accuracy train: 0.999411 val: 0.924845 test: 0.848911
max validation accuracy : 0.925729 max acc epoch : 58 test accuracy : 0.849044
Counter({1: 7883, 0: 6802, 2: 4161})

Epoch :  61 loss training:  1.7955064128982485 Time :  6090
accuracy train: 0.999411 val: 0.922193 test: 0.849575
max validation accuracy : 0.925729 max acc epoch : 58 test accuracy : 0.849044
Counter({0: 7882, 2: 6804, 1: 4160})

Epoch :  62 loss training:  1.36456611455651 Time :  6179
accuracy train: 0.999509 val: 0.923077 test: 0.850903
max validation accuracy : 0.925729 max acc epoch : 58 test accuracy : 0.849044
Counter({0: 7880, 2: 6800, 1: 4166})

Epoch :  63 loss training:  1.7373469559279329 Time :  6269
accuracy train: 0.999313 val: 0.923961 test: 0.849177
max validation accuracy : 0.925729 max acc epoch : 58 test accuracy : 0.849044
Counter({2: 7880, 0: 6803, 1: 4163})

Epoch :  64 loss training:  1.650909748428603 Time :  6360
accuracy train: 0.999509 val: 0.926614 test: 0.846522
max validation accuracy : 0.926614 max acc epoch : 64 test accuracy : 0.846522
Counter({1: 7881, 0: 6802, 2: 4163})

Epoch :  65 loss training:  2.0001228759774676 Time :  6450
accuracy train: 0.999411 val: 0.921309 test: 0.851434
max validation accuracy : 0.926614 max acc epoch : 64 test accuracy : 0.846522
Counter({0: 7884, 1: 6796, 2: 4166})

Epoch :  66 loss training:  1.6118765413593792 Time :  6539
accuracy train: 0.999509 val: 0.923961 test: 0.853160
max validation accuracy : 0.926614 max acc epoch : 64 test accuracy : 0.846522
Counter({0: 7891, 2: 6791, 1: 4164})

Epoch :  67 loss training:  1.6605477768316632 Time :  6628
accuracy train: 0.999509 val: 0.925729 test: 0.853293
max validation accuracy : 0.926614 max acc epoch : 64 test accuracy : 0.846522
Counter({1: 7895, 0: 6788, 2: 4163})

Epoch :  68 loss training:  1.207023749300788 Time :  6716
accuracy train: 0.999509 val: 0.924845 test: 0.848646
max validation accuracy : 0.926614 max acc epoch : 64 test accuracy : 0.846522
Counter({1: 7900, 0: 6784, 2: 4162})

Epoch :  69 loss training:  1.875307789297949 Time :  6809
accuracy train: 0.999411 val: 0.924845 test: 0.849310
max validation accuracy : 0.926614 max acc epoch : 64 test accuracy : 0.846522
Counter({1: 7902, 0: 6767, 2: 4177})

Epoch :  70 loss training:  1.5209511643206497 Time :  6900
accuracy train: 0.999607 val: 0.927498 test: 0.852762
max validation accuracy : 0.927498 max acc epoch : 70 test accuracy : 0.852762
Counter({0: 7908, 1: 6767, 2: 4171})

Epoch :  71 loss training:  1.3278781434582925 Time :  6991
accuracy train: 0.999509 val: 0.924845 test: 0.850372
max validation accuracy : 0.927498 max acc epoch : 70 test accuracy : 0.852762
Counter({2: 7909, 1: 6769, 0: 4168})

Epoch :  72 loss training:  1.2681887257458584 Time :  7086
accuracy train: 0.999411 val: 0.924845 test: 0.851965
max validation accuracy : 0.927498 max acc epoch : 70 test accuracy : 0.852762
Counter({2: 7914, 0: 6769, 1: 4163})

Epoch :  73 loss training:  1.877130766863047 Time :  7179
accuracy train: 0.999509 val: 0.927498 test: 0.850505
max validation accuracy : 0.927498 max acc epoch : 70 test accuracy : 0.852762
Counter({1: 7918, 2: 6764, 0: 4164})

Epoch :  74 loss training:  1.5080919969877868 Time :  7272
accuracy train: 0.999509 val: 0.927498 test: 0.851168
max validation accuracy : 0.927498 max acc epoch : 70 test accuracy : 0.852762
Counter({1: 7923, 0: 6769, 2: 4154})

Epoch :  75 loss training:  1.8687732585676713 Time :  7363
accuracy train: 0.999607 val: 0.920424 test: 0.852629
max validation accuracy : 0.927498 max acc epoch : 70 test accuracy : 0.852762
Counter({0: 7949, 2: 6779, 1: 4118})

Epoch :  76 loss training:  1.297277660130021 Time :  7455
accuracy train: 0.999607 val: 0.926614 test: 0.852098
max validation accuracy : 0.927498 max acc epoch : 70 test accuracy : 0.852762
Counter({1: 7948, 2: 6780, 0: 4118})

Epoch :  77 loss training:  1.0974994582393265 Time :  7547
accuracy train: 0.999607 val: 0.925729 test: 0.854620
max validation accuracy : 0.927498 max acc epoch : 70 test accuracy : 0.852762
Counter({1: 7946, 2: 6781, 0: 4119})

Epoch :  78 loss training:  1.502972366866743 Time :  7638
accuracy train: 0.999411 val: 0.925729 test: 0.854753
max validation accuracy : 0.927498 max acc epoch : 70 test accuracy : 0.852762
Counter({1: 7946, 0: 6799, 2: 4101})

Epoch :  79 loss training:  1.1758171064229828 Time :  7730
accuracy train: 0.999411 val: 0.927498 test: 0.853691
max validation accuracy : 0.927498 max acc epoch : 70 test accuracy : 0.852762
Counter({0: 7947, 1: 6799, 2: 4100})

Epoch :  80 loss training:  0.8601353852227476 Time :  7823
accuracy train: 0.999509 val: 0.925729 test: 0.851434
max validation accuracy : 0.927498 max acc epoch : 70 test accuracy : 0.852762
Counter({2: 7947, 0: 6801, 1: 4098})

Epoch :  81 loss training:  1.5109010688793205 Time :  7915
accuracy train: 0.999509 val: 0.925729 test: 0.851832
max validation accuracy : 0.927498 max acc epoch : 70 test accuracy : 0.852762
Counter({0: 7942, 1: 6793, 2: 4111})

Epoch :  82 loss training:  1.320339288078685 Time :  8012
accuracy train: 0.999607 val: 0.920424 test: 0.853160
max validation accuracy : 0.927498 max acc epoch : 70 test accuracy : 0.852762
Counter({0: 7938, 2: 6791, 1: 4117})

Epoch :  83 loss training:  1.1260390224961156 Time :  8109
accuracy train: 0.999607 val: 0.923077 test: 0.856479
max validation accuracy : 0.927498 max acc epoch : 70 test accuracy : 0.852762
Counter({2: 7937, 1: 6792, 0: 4117})

Epoch :  84 loss training:  1.7387476993790187 Time :  8203
accuracy train: 0.999607 val: 0.927498 test: 0.852762
max validation accuracy : 0.927498 max acc epoch : 70 test accuracy : 0.852762
Counter({0: 7932, 1: 6797, 2: 4117})

Epoch :  85 loss training:  1.1572504406321968 Time :  8296
accuracy train: 0.999607 val: 0.919540 test: 0.848380
max validation accuracy : 0.927498 max acc epoch : 70 test accuracy : 0.852762
Counter({0: 7932, 1: 6798, 2: 4116})

Epoch :  86 loss training:  1.0207281237217103 Time :  8388
accuracy train: 0.999607 val: 0.928382 test: 0.848115
max validation accuracy : 0.928382 max acc epoch : 86 test accuracy : 0.848115
Counter({0: 7930, 1: 6799, 2: 4117})

Epoch :  87 loss training:  1.3570458830145071 Time :  8487
accuracy train: 0.999509 val: 0.920424 test: 0.852629
max validation accuracy : 0.928382 max acc epoch : 86 test accuracy : 0.848115
Counter({0: 7934, 1: 6797, 2: 4115})

Epoch :  88 loss training:  1.3890197183645796 Time :  8584
accuracy train: 0.999607 val: 0.927498 test: 0.853824
max validation accuracy : 0.928382 max acc epoch : 86 test accuracy : 0.848115
Counter({2: 7937, 0: 6795, 1: 4114})

Epoch :  89 loss training:  1.1670330228207604 Time :  8673
accuracy train: 0.999705 val: 0.923077 test: 0.851036
max validation accuracy : 0.928382 max acc epoch : 86 test accuracy : 0.848115
Counter({0: 7936, 2: 6796, 1: 4114})

Epoch :  90 loss training:  1.4207947879858693 Time :  8766
accuracy train: 0.999411 val: 0.923961 test: 0.848513
max validation accuracy : 0.928382 max acc epoch : 86 test accuracy : 0.848115
Counter({2: 7942, 0: 6792, 1: 4112})

Epoch :  91 loss training:  1.4878435956052272 Time :  8858
accuracy train: 0.999607 val: 0.924845 test: 0.853956
max validation accuracy : 0.928382 max acc epoch : 86 test accuracy : 0.848115
Counter({1: 7943, 0: 6792, 2: 4111})

Epoch :  92 loss training:  0.6564074949483256 Time :  8950
accuracy train: 0.999509 val: 0.925729 test: 0.854620
max validation accuracy : 0.928382 max acc epoch : 86 test accuracy : 0.848115
Counter({2: 7939, 0: 6796, 1: 4111})

Epoch :  93 loss training:  0.9603096739701869 Time :  9051
accuracy train: 0.999509 val: 0.929266 test: 0.851301
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({0: 7939, 1: 6796, 2: 4111})

Epoch :  94 loss training:  0.7697565956659673 Time :  9142
accuracy train: 0.999607 val: 0.927498 test: 0.851567
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({2: 7939, 0: 6796, 1: 4111})

Epoch :  95 loss training:  0.8954468279480352 Time :  9233
accuracy train: 0.999607 val: 0.920424 test: 0.847716
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({0: 7942, 2: 6810, 1: 4094})

Epoch :  96 loss training:  0.9906124701865338 Time :  9324
accuracy train: 0.999411 val: 0.917772 test: 0.853558
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({1: 7942, 0: 6810, 2: 4094})

Epoch :  97 loss training:  1.1162216677648757 Time :  9415
accuracy train: 0.999705 val: 0.922193 test: 0.852762
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({1: 7947, 0: 6794, 2: 4105})

Epoch :  98 loss training:  1.0409514856955866 Time :  9509
accuracy train: 0.999607 val: 0.924845 test: 0.850106
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({2: 7947, 0: 6789, 1: 4110})

Epoch :  99 loss training:  0.8555579350741027 Time :  9601
accuracy train: 0.999509 val: 0.919540 test: 0.849841
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({0: 7951, 2: 6782, 1: 4113})

Epoch :  100 loss training:  1.4240143374663603 Time :  9691
accuracy train: 0.999509 val: 0.924845 test: 0.849442
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({0: 7952, 2: 6781, 1: 4113})

Epoch :  101 loss training:  0.7722522645417484 Time :  9781
accuracy train: 0.999607 val: 0.918656 test: 0.847982
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({2: 7950, 0: 6785, 1: 4111})

Epoch :  102 loss training:  0.8076891596665519 Time :  9874
accuracy train: 0.999607 val: 0.921309 test: 0.852098
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({1: 7958, 0: 6778, 2: 4110})

Epoch :  103 loss training:  0.768168160667301 Time :  9964
accuracy train: 0.999607 val: 0.925729 test: 0.851832
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({2: 7958, 0: 6778, 1: 4110})

Epoch :  104 loss training:  1.058048237575349 Time :  10056
accuracy train: 0.999607 val: 0.927498 test: 0.851301
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({1: 7957, 0: 6779, 2: 4110})

Epoch :  105 loss training:  0.7125578615195991 Time :  10152
accuracy train: 0.999509 val: 0.923961 test: 0.849708
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({0: 7956, 2: 6780, 1: 4110})

Epoch :  106 loss training:  0.8156062034177012 Time :  10242
accuracy train: 0.999705 val: 0.924845 test: 0.849177
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({1: 7956, 2: 6782, 0: 4108})

Epoch :  107 loss training:  1.0472796667218063 Time :  10331
accuracy train: 0.999607 val: 0.925729 test: 0.851965
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({0: 7948, 2: 6791, 1: 4107})

Epoch :  108 loss training:  1.2420742773774691 Time :  10421
accuracy train: 0.999607 val: 0.924845 test: 0.852230
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({1: 7948, 2: 6789, 0: 4109})

Epoch :  109 loss training:  1.0927713967912496 Time :  10512
accuracy train: 0.999411 val: 0.926614 test: 0.849177
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({0: 7950, 2: 6788, 1: 4108})

Epoch :  110 loss training:  1.0204313665376503 Time :  10604
accuracy train: 0.999607 val: 0.922193 test: 0.852363
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({1: 7944, 2: 6795, 0: 4107})

Epoch :  111 loss training:  0.9735513055784395 Time :  10695
accuracy train: 0.999607 val: 0.926614 test: 0.850505
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({1: 7944, 2: 6795, 0: 4107})

Epoch :  112 loss training:  0.6332057338045161 Time :  10785
accuracy train: 0.999607 val: 0.924845 test: 0.847982
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({2: 7947, 0: 6800, 1: 4099})

Epoch :  113 loss training:  0.8395604601405466 Time :  10883
accuracy train: 0.999607 val: 0.927498 test: 0.849841
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({0: 7944, 1: 6804, 2: 4098})

Epoch :  114 loss training:  1.0399114980491504 Time :  10974
accuracy train: 0.999509 val: 0.923961 test: 0.852098
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({0: 7944, 2: 6804, 1: 4098})

Epoch :  115 loss training:  0.7360738826405395 Time :  11065
accuracy train: 0.999607 val: 0.921309 test: 0.849973
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({0: 7943, 1: 6805, 2: 4098})

Epoch :  116 loss training:  1.6270191914977659 Time :  11155
accuracy train: 0.999509 val: 0.917772 test: 0.846920
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({0: 7944, 1: 6804, 2: 4098})

Epoch :  117 loss training:  0.7904557520096205 Time :  11247
accuracy train: 0.999607 val: 0.921309 test: 0.851832
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({1: 7944, 0: 6804, 2: 4098})

Epoch :  118 loss training:  1.3465138553146971 Time :  11339
accuracy train: 0.999607 val: 0.918656 test: 0.849841
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({2: 7944, 0: 6804, 1: 4098})

Epoch :  119 loss training:  1.0075674456588786 Time :  11429
accuracy train: 0.999607 val: 0.925729 test: 0.851168
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({1: 7947, 0: 6801, 2: 4098})

Epoch :  120 loss training:  0.41409628907058504 Time :  11521
accuracy train: 0.999607 val: 0.919540 test: 0.852098
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({0: 7947, 1: 6801, 2: 4098})

Epoch :  121 loss training:  0.6702378293457514 Time :  11612
accuracy train: 0.999607 val: 0.922193 test: 0.849442
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({0: 7951, 2: 6798, 1: 4097})

Epoch :  122 loss training:  0.9263069401176836 Time :  11703
accuracy train: 0.999607 val: 0.921309 test: 0.851168
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({0: 7951, 1: 6798, 2: 4097})

Epoch :  123 loss training:  0.974005216756268 Time :  11794
accuracy train: 0.999607 val: 0.922193 test: 0.853425
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({0: 7952, 1: 6798, 2: 4096})

Epoch :  124 loss training:  0.9609829725986856 Time :  11886
accuracy train: 0.999607 val: 0.924845 test: 0.851301
max validation accuracy : 0.929266 max acc epoch : 93 test accuracy : 0.851301
Counter({2: 7955, 1: 6794, 0: 4097})

========================================================================================================================================================================================================
best acc epoch :  93
validation accuracy :  0.9292661361626879
test accuracy :  0.8513011152416357
last test_accuracy :  0.8513011152416357
second best val :  0.9283819628647215
second best test :  0.8481147105682422
max gap 16
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=29, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0
Counter({1: 7577, 2: 6348, 0: 4921})

Epoch :  1 loss training:  333.3745045363903 Time :  11983
accuracy train: 0.794167 val: 0.758621 test: 0.718534
max validation accuracy : 0.758621 max acc epoch : 1 test accuracy : 0.718534
Counter({2: 6865, 1: 6258, 0: 5723})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  207.8377454727888 Time :  12066
accuracy train: 0.836492 val: 0.798408 test: 0.749867
max validation accuracy : 0.798408 max acc epoch : 2 test accuracy : 0.749867
Counter({1: 6989, 2: 6598, 0: 5259})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  174.9971348643303 Time :  12149
accuracy train: 0.883924 val: 0.830239 test: 0.779076
max validation accuracy : 0.830239 max acc epoch : 3 test accuracy : 0.779076
Counter({0: 6835, 2: 6703, 1: 5308})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  129.10567655414343 Time :  12236
accuracy train: 0.904547 val: 0.862953 test: 0.786644
max validation accuracy : 0.862953 max acc epoch : 4 test accuracy : 0.786644
Counter({2: 7370, 1: 6709, 0: 4767})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  117.3834630548954 Time :  12319
accuracy train: 0.915251 val: 0.861185 test: 0.792884
max validation accuracy : 0.862953 max acc epoch : 4 test accuracy : 0.786644
Counter({2: 7416, 1: 6747, 0: 4683})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  110.85196160897613 Time :  12402
accuracy train: 0.928999 val: 0.870911 test: 0.794344
max validation accuracy : 0.870911 max acc epoch : 6 test accuracy : 0.794344
Counter({1: 7436, 2: 6794, 0: 4616})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  93.58879643678665 Time :  12485
accuracy train: 0.944319 val: 0.876216 test: 0.808550
max validation accuracy : 0.876216 max acc epoch : 7 test accuracy : 0.808550
Counter({2: 7448, 1: 6785, 0: 4613})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  87.47660219296813 Time :  12569
accuracy train: 0.949622 val: 0.882405 test: 0.803903
max validation accuracy : 0.882405 max acc epoch : 8 test accuracy : 0.803903
Counter({2: 7491, 1: 6790, 0: 4565})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  82.44890903681517 Time :  12652
accuracy train: 0.951881 val: 0.875332 test: 0.808550
max validation accuracy : 0.882405 max acc epoch : 8 test accuracy : 0.803903
Counter({1: 7495, 0: 6811, 2: 4540})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  74.51046545058489 Time :  12735
accuracy train: 0.957282 val: 0.890363 test: 0.811737
max validation accuracy : 0.890363 max acc epoch : 10 test accuracy : 0.811737
Counter({1: 7499, 2: 6807, 0: 4540})

Epoch :  11 loss training:  70.49836402758956 Time :  12826
accuracy train: 0.963174 val: 0.893015 test: 0.817844
max validation accuracy : 0.893015 max acc epoch : 11 test accuracy : 0.817844
Counter({1: 7509, 2: 6807, 0: 4530})

Epoch :  12 loss training:  63.842622708529234 Time :  12917
accuracy train: 0.970932 val: 0.892131 test: 0.818375
max validation accuracy : 0.893015 max acc epoch : 11 test accuracy : 0.817844
Counter({2: 7511, 1: 6806, 0: 4529})

Epoch :  13 loss training:  56.17499200254679 Time :  13007
accuracy train: 0.979672 val: 0.893015 test: 0.819570
max validation accuracy : 0.893015 max acc epoch : 11 test accuracy : 0.817844
Counter({0: 7546, 2: 6779, 1: 4521})

Epoch :  14 loss training:  50.267894208431244 Time :  13099
accuracy train: 0.980850 val: 0.893899 test: 0.820632
max validation accuracy : 0.893899 max acc epoch : 14 test accuracy : 0.820632
Counter({0: 7559, 1: 6767, 2: 4520})

Epoch :  15 loss training:  44.07505983579904 Time :  13190
accuracy train: 0.985564 val: 0.898320 test: 0.824482
max validation accuracy : 0.898320 max acc epoch : 15 test accuracy : 0.824482
Counter({0: 7554, 1: 6779, 2: 4513})

Epoch :  16 loss training:  40.82949022296816 Time :  13284
accuracy train: 0.988216 val: 0.901857 test: 0.823155
max validation accuracy : 0.901857 max acc epoch : 16 test accuracy : 0.823155
Counter({0: 7562, 2: 6800, 1: 4484})

Epoch :  17 loss training:  37.16537320613861 Time :  13374
accuracy train: 0.990376 val: 0.899204 test: 0.824349
max validation accuracy : 0.901857 max acc epoch : 16 test accuracy : 0.823155
Counter({1: 7580, 0: 6794, 2: 4472})

Epoch :  18 loss training:  31.697073224931955 Time :  13465
accuracy train: 0.993126 val: 0.900088 test: 0.827934
max validation accuracy : 0.901857 max acc epoch : 16 test accuracy : 0.823155
Counter({0: 7602, 1: 6788, 2: 4456})

Epoch :  19 loss training:  28.261591711081564 Time :  13556
accuracy train: 0.993911 val: 0.900088 test: 0.829660
max validation accuracy : 0.901857 max acc epoch : 16 test accuracy : 0.823155
Counter({1: 7635, 2: 6783, 0: 4428})

Epoch :  20 loss training:  24.638232426717877 Time :  13646
accuracy train: 0.994992 val: 0.908930 test: 0.829395
max validation accuracy : 0.908930 max acc epoch : 20 test accuracy : 0.829395
Counter({1: 7673, 2: 6760, 0: 4413})

Epoch :  21 loss training:  22.14695686241612 Time :  13737
accuracy train: 0.995679 val: 0.901857 test: 0.830457
max validation accuracy : 0.908930 max acc epoch : 20 test accuracy : 0.829395
Counter({0: 7673, 1: 6762, 2: 4411})

Epoch :  22 loss training:  19.386813550256193 Time :  13829
accuracy train: 0.996661 val: 0.911583 test: 0.835767
max validation accuracy : 0.911583 max acc epoch : 22 test accuracy : 0.835767
Counter({1: 7708, 2: 6749, 0: 4389})

Epoch :  23 loss training:  18.876939916983247 Time :  13919
accuracy train: 0.997447 val: 0.907162 test: 0.832581
max validation accuracy : 0.911583 max acc epoch : 22 test accuracy : 0.835767
Counter({1: 7730, 2: 6728, 0: 4388})

Epoch :  24 loss training:  16.973701560869813 Time :  14009
accuracy train: 0.997741 val: 0.916004 test: 0.834440
max validation accuracy : 0.916004 max acc epoch : 24 test accuracy : 0.834440
Counter({0: 7733, 2: 6724, 1: 4389})

Epoch :  25 loss training:  15.286576374899596 Time :  14101
accuracy train: 0.997840 val: 0.914235 test: 0.837361
max validation accuracy : 0.916004 max acc epoch : 24 test accuracy : 0.834440
Counter({0: 7736, 1: 6728, 2: 4382})

Epoch :  26 loss training:  13.48132532928139 Time :  14191
accuracy train: 0.998723 val: 0.914235 test: 0.837095
max validation accuracy : 0.916004 max acc epoch : 24 test accuracy : 0.834440
Counter({2: 7737, 1: 6733, 0: 4376})

Epoch :  27 loss training:  11.172190279932693 Time :  14288
accuracy train: 0.998331 val: 0.914235 test: 0.835635
max validation accuracy : 0.916004 max acc epoch : 24 test accuracy : 0.834440
Counter({2: 7755, 0: 6713, 1: 4378})

Epoch :  28 loss training:  11.147082513431087 Time :  14378
accuracy train: 0.998331 val: 0.910698 test: 0.840414
max validation accuracy : 0.916004 max acc epoch : 24 test accuracy : 0.834440
Counter({0: 7767, 1: 6705, 2: 4374})

Epoch :  29 loss training:  9.161295903730206 Time :  14468
accuracy train: 0.998822 val: 0.914235 test: 0.842007
max validation accuracy : 0.916004 max acc epoch : 24 test accuracy : 0.834440
Counter({1: 7770, 2: 6709, 0: 4367})

Epoch :  30 loss training:  8.74588365945965 Time :  14560
accuracy train: 0.998920 val: 0.914235 test: 0.836830
max validation accuracy : 0.916004 max acc epoch : 24 test accuracy : 0.834440
Counter({2: 7775, 1: 6700, 0: 4371})

Epoch :  31 loss training:  7.895198820857331 Time :  14651
accuracy train: 0.998920 val: 0.915119 test: 0.839485
max validation accuracy : 0.916004 max acc epoch : 24 test accuracy : 0.834440
Counter({2: 7775, 1: 6709, 0: 4362})

Epoch :  32 loss training:  8.491661619395018 Time :  14742
accuracy train: 0.999214 val: 0.914235 test: 0.841344
max validation accuracy : 0.916004 max acc epoch : 24 test accuracy : 0.834440
Counter({1: 7774, 2: 6739, 0: 4333})

Epoch :  33 loss training:  7.865760704851709 Time :  14834
accuracy train: 0.998920 val: 0.914235 test: 0.841875
max validation accuracy : 0.916004 max acc epoch : 24 test accuracy : 0.834440
Counter({2: 7776, 0: 6749, 1: 4321})

Epoch :  34 loss training:  7.381892104167491 Time :  14926
accuracy train: 0.999214 val: 0.916888 test: 0.844264
max validation accuracy : 0.916888 max acc epoch : 34 test accuracy : 0.844264
Counter({1: 7784, 2: 6751, 0: 4311})

Epoch :  35 loss training:  5.618960057734512 Time :  15016
accuracy train: 0.999313 val: 0.919540 test: 0.844530
max validation accuracy : 0.919540 max acc epoch : 35 test accuracy : 0.844530
Counter({1: 7785, 2: 6755, 0: 4306})

Epoch :  36 loss training:  5.704981777176727 Time :  15107
accuracy train: 0.998920 val: 0.919540 test: 0.842406
max validation accuracy : 0.919540 max acc epoch : 35 test accuracy : 0.844530
Counter({0: 7789, 2: 6762, 1: 4295})

Epoch :  37 loss training:  4.051296865218319 Time :  15197
accuracy train: 0.999214 val: 0.923961 test: 0.842007
max validation accuracy : 0.923961 max acc epoch : 37 test accuracy : 0.842007
Counter({2: 7796, 1: 6762, 0: 4288})

Epoch :  38 loss training:  5.223039089003578 Time :  15287
accuracy train: 0.999116 val: 0.917772 test: 0.845194
max validation accuracy : 0.923961 max acc epoch : 37 test accuracy : 0.842007
Counter({2: 7802, 1: 6764, 0: 4280})

Epoch :  39 loss training:  4.731507484568283 Time :  15378
accuracy train: 0.999214 val: 0.920424 test: 0.844132
max validation accuracy : 0.923961 max acc epoch : 37 test accuracy : 0.842007
Counter({1: 7801, 2: 6746, 0: 4299})

Epoch :  40 loss training:  4.21794396606856 Time :  15469
accuracy train: 0.999214 val: 0.919540 test: 0.843601
max validation accuracy : 0.923961 max acc epoch : 37 test accuracy : 0.842007
Counter({1: 7819, 2: 6737, 0: 4290})

Epoch :  41 loss training:  3.60241638761363 Time :  15557
accuracy train: 0.999313 val: 0.924845 test: 0.844928
max validation accuracy : 0.924845 max acc epoch : 41 test accuracy : 0.844928
Counter({1: 7819, 2: 6738, 0: 4289})

Epoch :  42 loss training:  3.205507246340858 Time :  15649
accuracy train: 0.999313 val: 0.925729 test: 0.847185
max validation accuracy : 0.925729 max acc epoch : 42 test accuracy : 0.847185
Counter({1: 7820, 2: 6734, 0: 4292})

Epoch :  43 loss training:  3.810431099671405 Time :  15739
accuracy train: 0.999313 val: 0.924845 test: 0.843202
max validation accuracy : 0.925729 max acc epoch : 42 test accuracy : 0.847185
Counter({2: 7872, 1: 6701, 0: 4273})

Epoch :  44 loss training:  3.638295867407578 Time :  15830
accuracy train: 0.999116 val: 0.921309 test: 0.846787
max validation accuracy : 0.925729 max acc epoch : 42 test accuracy : 0.847185
Counter({2: 7873, 1: 6704, 0: 4269})

Epoch :  45 loss training:  3.4092985843744827 Time :  15922
accuracy train: 0.999116 val: 0.916004 test: 0.841609
max validation accuracy : 0.925729 max acc epoch : 42 test accuracy : 0.847185
Counter({1: 7874, 2: 6703, 0: 4269})

Epoch :  46 loss training:  3.586085249276948 Time :  16011
accuracy train: 0.999214 val: 0.920424 test: 0.844928
max validation accuracy : 0.925729 max acc epoch : 42 test accuracy : 0.847185
Counter({1: 7879, 2: 6766, 0: 4201})

Epoch :  47 loss training:  3.0516839843185153 Time :  16101
accuracy train: 0.999411 val: 0.917772 test: 0.846522
max validation accuracy : 0.925729 max acc epoch : 42 test accuracy : 0.847185
Counter({1: 7881, 2: 6782, 0: 4183})

Epoch :  48 loss training:  2.548837154812645 Time :  16193
accuracy train: 0.999313 val: 0.924845 test: 0.847053
max validation accuracy : 0.925729 max acc epoch : 42 test accuracy : 0.847185
Counter({1: 7899, 2: 6774, 0: 4173})

Epoch :  49 loss training:  3.1209807241975795 Time :  16283
accuracy train: 0.999411 val: 0.922193 test: 0.849973
max validation accuracy : 0.925729 max acc epoch : 42 test accuracy : 0.847185
Counter({2: 7901, 0: 6773, 1: 4172})

Epoch :  50 loss training:  2.8241864374722354 Time :  16371
accuracy train: 0.999411 val: 0.917772 test: 0.847584
max validation accuracy : 0.925729 max acc epoch : 42 test accuracy : 0.847185
Counter({2: 7902, 1: 6772, 0: 4172})

Epoch :  51 loss training:  2.5922218351624906 Time :  16461
accuracy train: 0.999018 val: 0.924845 test: 0.846654
max validation accuracy : 0.925729 max acc epoch : 42 test accuracy : 0.847185
Counter({1: 7904, 2: 6778, 0: 4164})

Epoch :  52 loss training:  2.7132450400240486 Time :  16553
accuracy train: 0.999411 val: 0.924845 test: 0.846389
max validation accuracy : 0.925729 max acc epoch : 42 test accuracy : 0.847185
Counter({1: 7908, 2: 6781, 0: 4157})

Epoch :  53 loss training:  2.2208166604177677 Time :  16645
accuracy train: 0.999411 val: 0.921309 test: 0.848911
max validation accuracy : 0.925729 max acc epoch : 42 test accuracy : 0.847185
Counter({0: 7910, 1: 6782, 2: 4154})

Epoch :  54 loss training:  2.057464683901344 Time :  16736
accuracy train: 0.999313 val: 0.922193 test: 0.849310
max validation accuracy : 0.925729 max acc epoch : 42 test accuracy : 0.847185
Counter({2: 7911, 1: 6782, 0: 4153})

Epoch :  55 loss training:  2.3701432943780674 Time :  16828
accuracy train: 0.999411 val: 0.923961 test: 0.847584
max validation accuracy : 0.925729 max acc epoch : 42 test accuracy : 0.847185
Counter({2: 7912, 1: 6779, 0: 4155})

Epoch :  56 loss training:  3.318691246357048 Time :  16919
accuracy train: 0.999313 val: 0.913351 test: 0.849575
max validation accuracy : 0.925729 max acc epoch : 42 test accuracy : 0.847185
Counter({0: 7948, 1: 6743, 2: 4155})

Epoch :  57 loss training:  2.3455406150242197 Time :  17011
accuracy train: 0.999313 val: 0.922193 test: 0.849708
max validation accuracy : 0.925729 max acc epoch : 42 test accuracy : 0.847185
Counter({2: 7961, 1: 6728, 0: 4157})

Epoch :  58 loss training:  2.2863637709269824 Time :  17101
accuracy train: 0.999313 val: 0.923077 test: 0.852363
max validation accuracy : 0.925729 max acc epoch : 42 test accuracy : 0.847185
Counter({2: 7975, 1: 6707, 0: 4164})

Epoch :  59 loss training:  2.1148036829181365 Time :  17194
accuracy train: 0.999411 val: 0.927498 test: 0.851567
max validation accuracy : 0.927498 max acc epoch : 59 test accuracy : 0.851567
Counter({0: 7978, 2: 6704, 1: 4164})

Epoch :  60 loss training:  2.4556916391811683 Time :  17292
accuracy train: 0.999313 val: 0.922193 test: 0.849973
max validation accuracy : 0.927498 max acc epoch : 59 test accuracy : 0.851567
Counter({2: 7977, 1: 6705, 0: 4164})

Epoch :  61 loss training:  1.5742632044712082 Time :  17383
accuracy train: 0.999313 val: 0.923961 test: 0.850239
max validation accuracy : 0.927498 max acc epoch : 59 test accuracy : 0.851567
Counter({1: 7981, 2: 6700, 0: 4165})

Epoch :  62 loss training:  1.9486508486988896 Time :  17474
accuracy train: 0.999509 val: 0.922193 test: 0.850903
max validation accuracy : 0.927498 max acc epoch : 59 test accuracy : 0.851567
Counter({1: 7983, 0: 6702, 2: 4161})

Epoch :  63 loss training:  1.7534268813105882 Time :  17566
accuracy train: 0.999411 val: 0.923077 test: 0.849442
max validation accuracy : 0.927498 max acc epoch : 59 test accuracy : 0.851567
Counter({1: 7979, 0: 6705, 2: 4162})

Epoch :  64 loss training:  1.6879703035301645 Time :  17658
accuracy train: 0.999509 val: 0.921309 test: 0.848911
max validation accuracy : 0.927498 max acc epoch : 59 test accuracy : 0.851567
Counter({2: 7979, 0: 6706, 1: 4161})

Epoch :  65 loss training:  1.7375127960876853 Time :  17749
accuracy train: 0.999411 val: 0.919540 test: 0.849708
max validation accuracy : 0.927498 max acc epoch : 59 test accuracy : 0.851567
Counter({0: 7989, 2: 6704, 1: 4153})

Epoch :  66 loss training:  1.3282945981882222 Time :  17840
accuracy train: 0.999214 val: 0.925729 test: 0.851301
max validation accuracy : 0.927498 max acc epoch : 59 test accuracy : 0.851567
Counter({1: 7991, 0: 6704, 2: 4151})

Epoch :  67 loss training:  1.4292647789043258 Time :  17930
accuracy train: 0.999214 val: 0.922193 test: 0.851699
max validation accuracy : 0.927498 max acc epoch : 59 test accuracy : 0.851567
Counter({2: 7996, 1: 6704, 0: 4146})

Epoch :  68 loss training:  1.582903715181601 Time :  18022
accuracy train: 0.999411 val: 0.919540 test: 0.849841
max validation accuracy : 0.927498 max acc epoch : 59 test accuracy : 0.851567
Counter({1: 7995, 0: 6706, 2: 4145})

Epoch :  69 loss training:  2.0806272775444086 Time :  18110
accuracy train: 0.999509 val: 0.920424 test: 0.846256
max validation accuracy : 0.927498 max acc epoch : 59 test accuracy : 0.851567
Counter({1: 8001, 2: 6698, 0: 4147})

Epoch :  70 loss training:  1.8579151350168104 Time :  18202
accuracy train: 0.999313 val: 0.928382 test: 0.851567
max validation accuracy : 0.928382 max acc epoch : 70 test accuracy : 0.851567
Counter({1: 8005, 0: 6696, 2: 4145})

Epoch :  71 loss training:  1.7896155152120627 Time :  18293
accuracy train: 0.999411 val: 0.926614 test: 0.848779
max validation accuracy : 0.928382 max acc epoch : 70 test accuracy : 0.851567
Counter({1: 8028, 0: 6689, 2: 4129})

Epoch :  72 loss training:  1.6882682622017455 Time :  18390
accuracy train: 0.999313 val: 0.920424 test: 0.848115
max validation accuracy : 0.928382 max acc epoch : 70 test accuracy : 0.851567
Counter({1: 8039, 0: 6677, 2: 4130})

Epoch :  73 loss training:  1.4061060719068337 Time :  18481
accuracy train: 0.999411 val: 0.925729 test: 0.852363
max validation accuracy : 0.928382 max acc epoch : 70 test accuracy : 0.851567
Counter({1: 8041, 2: 6673, 0: 4132})

Epoch :  74 loss training:  1.5867375741399883 Time :  18570
accuracy train: 0.999411 val: 0.922193 test: 0.852098
max validation accuracy : 0.928382 max acc epoch : 70 test accuracy : 0.851567
Counter({2: 8055, 1: 6654, 0: 4137})

Epoch :  75 loss training:  1.1151793801109307 Time :  18660
accuracy train: 0.999411 val: 0.922193 test: 0.850637
max validation accuracy : 0.928382 max acc epoch : 70 test accuracy : 0.851567
Counter({1: 8055, 2: 6635, 0: 4156})

Epoch :  76 loss training:  1.4773455337490304 Time :  18748
accuracy train: 0.999411 val: 0.925729 test: 0.849575
max validation accuracy : 0.928382 max acc epoch : 70 test accuracy : 0.851567
Counter({1: 8057, 2: 6627, 0: 4162})

Epoch :  77 loss training:  1.3227342208592745 Time :  18837
accuracy train: 0.999411 val: 0.924845 test: 0.853160
max validation accuracy : 0.928382 max acc epoch : 70 test accuracy : 0.851567
Counter({1: 8055, 2: 6629, 0: 4162})

Epoch :  78 loss training:  1.3750698714839018 Time :  18927
accuracy train: 0.999411 val: 0.923961 test: 0.853824
max validation accuracy : 0.928382 max acc epoch : 70 test accuracy : 0.851567
Counter({2: 8056, 1: 6626, 0: 4164})

Epoch :  79 loss training:  0.7742195152386557 Time :  19017
accuracy train: 0.999509 val: 0.929266 test: 0.851301
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({2: 8057, 1: 6631, 0: 4158})

Epoch :  80 loss training:  1.4696624459029408 Time :  19107
accuracy train: 0.999313 val: 0.924845 test: 0.850372
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({2: 8077, 1: 6623, 0: 4146})

Epoch :  81 loss training:  1.397040732741516 Time :  19196
accuracy train: 0.999509 val: 0.924845 test: 0.849708
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({1: 8067, 0: 6629, 2: 4150})

Epoch :  82 loss training:  1.763529551864849 Time :  19283
accuracy train: 0.999411 val: 0.923077 test: 0.846389
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({0: 8071, 1: 6627, 2: 4148})

Epoch :  83 loss training:  1.3409020962553768 Time :  19371
accuracy train: 0.999509 val: 0.923961 test: 0.849575
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({1: 8068, 0: 6627, 2: 4151})

Epoch :  84 loss training:  1.4220007712701772 Time :  19461
accuracy train: 0.999214 val: 0.929266 test: 0.848115
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({0: 8068, 2: 6643, 1: 4135})

Epoch :  85 loss training:  1.258343321562279 Time :  19550
accuracy train: 0.999313 val: 0.924845 test: 0.845858
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({2: 8071, 1: 6640, 0: 4135})

Epoch :  86 loss training:  1.0342705758612283 Time :  19640
accuracy train: 0.999509 val: 0.927498 test: 0.849708
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({1: 8076, 2: 6645, 0: 4125})

Epoch :  87 loss training:  1.089956878859084 Time :  19730
accuracy train: 0.999313 val: 0.925729 test: 0.851036
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({1: 8075, 2: 6647, 0: 4124})

Epoch :  88 loss training:  1.245341037367325 Time :  19822
accuracy train: 0.999313 val: 0.929266 test: 0.850903
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({2: 8071, 0: 6647, 1: 4128})

Epoch :  89 loss training:  1.542361798166894 Time :  19915
accuracy train: 0.999313 val: 0.923961 test: 0.846787
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({1: 8046, 2: 6642, 0: 4158})

Epoch :  90 loss training:  1.066123065949796 Time :  20004
accuracy train: 0.999509 val: 0.922193 test: 0.847982
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({1: 8048, 2: 6642, 0: 4156})

Epoch :  91 loss training:  1.2062606749768747 Time :  20093
accuracy train: 0.999411 val: 0.923961 test: 0.849177
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({1: 8049, 0: 6640, 2: 4157})

Epoch :  92 loss training:  1.4818236687151511 Time :  20182
accuracy train: 0.999313 val: 0.928382 test: 0.848513
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({1: 8054, 2: 6657, 0: 4135})

Epoch :  93 loss training:  1.5567576600315078 Time :  20272
accuracy train: 0.999313 val: 0.923961 test: 0.850372
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({0: 8059, 1: 6677, 2: 4110})

Epoch :  94 loss training:  0.8967882450451725 Time :  20360
accuracy train: 0.999607 val: 0.920424 test: 0.852496
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({0: 8061, 2: 6676, 1: 4109})

Epoch :  95 loss training:  1.237241132409963 Time :  20448
accuracy train: 0.999411 val: 0.916888 test: 0.851699
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({0: 8068, 2: 6674, 1: 4104})

Epoch :  96 loss training:  0.9891372381607653 Time :  20537
accuracy train: 0.999411 val: 0.916004 test: 0.849442
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({2: 8068, 0: 6671, 1: 4107})

Epoch :  97 loss training:  0.9087145238536323 Time :  20625
accuracy train: 0.999313 val: 0.924845 test: 0.851434
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({1: 8072, 0: 6662, 2: 4112})

Epoch :  98 loss training:  1.9649864243219781 Time :  20712
accuracy train: 0.999509 val: 0.925729 test: 0.851699
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({1: 8071, 2: 6660, 0: 4115})

Epoch :  99 loss training:  0.7979670792265097 Time :  20801
accuracy train: 0.999509 val: 0.924845 test: 0.850239
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({1: 8072, 2: 6659, 0: 4115})

Epoch :  100 loss training:  0.9272433618971263 Time :  20891
accuracy train: 0.999607 val: 0.919540 test: 0.852098
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({1: 8077, 2: 6657, 0: 4112})

Epoch :  101 loss training:  0.982261082704099 Time :  20979
accuracy train: 0.999607 val: 0.920424 test: 0.852230
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({1: 8077, 2: 6665, 0: 4104})

Epoch :  102 loss training:  1.136449060916675 Time :  21067
accuracy train: 0.999411 val: 0.924845 test: 0.853160
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({2: 8080, 1: 6665, 0: 4101})

Epoch :  103 loss training:  1.1388745481262958 Time :  21157
accuracy train: 0.999509 val: 0.923077 test: 0.848646
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({2: 8084, 1: 6666, 0: 4096})

Epoch :  104 loss training:  0.9804635087621136 Time :  21245
accuracy train: 0.999411 val: 0.922193 test: 0.844663
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({0: 8083, 1: 6647, 2: 4116})

Epoch :  105 loss training:  1.5087141530575536 Time :  21331
accuracy train: 0.999607 val: 0.920424 test: 0.850770
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({1: 8086, 2: 6655, 0: 4105})

Epoch :  106 loss training:  1.0493614314773367 Time :  21420
accuracy train: 0.999509 val: 0.920424 test: 0.849708
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({1: 8083, 2: 6662, 0: 4101})

Epoch :  107 loss training:  1.5719479091785615 Time :  21508
accuracy train: 0.999607 val: 0.918656 test: 0.847318
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({1: 8080, 2: 6665, 0: 4101})

Epoch :  108 loss training:  0.9685847149785332 Time :  21597
accuracy train: 0.999607 val: 0.919540 test: 0.849841
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({0: 8082, 2: 6663, 1: 4101})

Epoch :  109 loss training:  0.8100240128214864 Time :  21686
accuracy train: 0.999607 val: 0.917772 test: 0.849708
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({0: 8077, 2: 6672, 1: 4097})

Epoch :  110 loss training:  1.1696714930913004 Time :  21774
accuracy train: 0.999509 val: 0.915119 test: 0.846920
max validation accuracy : 0.929266 max acc epoch : 79 test accuracy : 0.851301
Counter({2: 8081, 0: 6681, 1: 4084})

========================================================================================================================================================================================================
best acc epoch :  79
validation accuracy :  0.9292661361626879
test accuracy :  0.8513011152416357
last test_accuracy :  0.8469198088157196
second best val :  0.9283819628647215
second best test :  0.8515666489644185
max gap 17
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=991, tsne=False, val_prop=0.1, weight_decay=1e-06)
device :  cuda:0
Counter({1: 7580, 2: 6349, 0: 4917})

Epoch :  1 loss training:  333.96714168787 Time :  21870
accuracy train: 0.808603 val: 0.779841 test: 0.742565
max validation accuracy : 0.779841 max acc epoch : 1 test accuracy : 0.742565
Counter({1: 6823, 0: 6224, 2: 5799})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  203.8438040316105 Time :  21953
accuracy train: 0.811156 val: 0.766578 test: 0.722384
max validation accuracy : 0.779841 max acc epoch : 1 test accuracy : 0.742565
Counter({1: 7012, 2: 6292, 0: 5542})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  169.64560224115849 Time :  22035
accuracy train: 0.868408 val: 0.835544 test: 0.768189
max validation accuracy : 0.835544 max acc epoch : 3 test accuracy : 0.768189
Counter({1: 7066, 0: 6109, 2: 5671})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  130.49318241328 Time :  22118
accuracy train: 0.910243 val: 0.855880 test: 0.795539
max validation accuracy : 0.855880 max acc epoch : 4 test accuracy : 0.795539
Counter({1: 7085, 2: 6173, 0: 5588})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  121.21093539893627 Time :  22200
accuracy train: 0.919768 val: 0.862069 test: 0.797398
max validation accuracy : 0.862069 max acc epoch : 5 test accuracy : 0.797398
Counter({2: 7086, 1: 6174, 0: 5586})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  111.45340068638325 Time :  22282
accuracy train: 0.931356 val: 0.864721 test: 0.802310
max validation accuracy : 0.864721 max acc epoch : 6 test accuracy : 0.802310
Counter({1: 7108, 2: 6183, 0: 5555})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  93.04167389124632 Time :  22365
accuracy train: 0.943239 val: 0.870027 test: 0.802045
max validation accuracy : 0.870027 max acc epoch : 7 test accuracy : 0.802045
Counter({2: 7097, 0: 6187, 1: 5562})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  85.88248104602098 Time :  22446
accuracy train: 0.938525 val: 0.870027 test: 0.800850
max validation accuracy : 0.870027 max acc epoch : 7 test accuracy : 0.802045
Counter({0: 7089, 1: 6164, 2: 5593})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  84.40086295828223 Time :  22529
accuracy train: 0.954139 val: 0.877984 test: 0.809745
max validation accuracy : 0.877984 max acc epoch : 9 test accuracy : 0.809745
Counter({2: 7081, 1: 6172, 0: 5593})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  74.46387606859207 Time :  22610
accuracy train: 0.954728 val: 0.882405 test: 0.811206
max validation accuracy : 0.882405 max acc epoch : 10 test accuracy : 0.811206
Counter({2: 7081, 1: 6175, 0: 5590})

Epoch :  11 loss training:  71.84755190089345 Time :  22701
accuracy train: 0.965727 val: 0.891247 test: 0.818773
max validation accuracy : 0.891247 max acc epoch : 11 test accuracy : 0.818773
Counter({0: 7080, 1: 6181, 2: 5585})

Epoch :  12 loss training:  63.45282720774412 Time :  22795
accuracy train: 0.968870 val: 0.889478 test: 0.823818
max validation accuracy : 0.891247 max acc epoch : 11 test accuracy : 0.818773
Counter({2: 7077, 1: 6184, 0: 5585})

Epoch :  13 loss training:  58.61104476079345 Time :  22886
accuracy train: 0.975253 val: 0.895668 test: 0.825943
max validation accuracy : 0.895668 max acc epoch : 13 test accuracy : 0.825943
Counter({1: 7051, 2: 6206, 0: 5589})

Epoch :  14 loss training:  51.52133699506521 Time :  22978
accuracy train: 0.979279 val: 0.894783 test: 0.827403
max validation accuracy : 0.895668 max acc epoch : 13 test accuracy : 0.825943
Counter({0: 7027, 2: 6213, 1: 5606})

Epoch :  15 loss training:  44.6975901927799 Time :  23068
accuracy train: 0.983306 val: 0.897436 test: 0.828864
max validation accuracy : 0.897436 max acc epoch : 15 test accuracy : 0.828864
Counter({2: 7029, 1: 6209, 0: 5608})

Epoch :  16 loss training:  40.55511053558439 Time :  23159
accuracy train: 0.988510 val: 0.905393 test: 0.831652
max validation accuracy : 0.905393 max acc epoch : 16 test accuracy : 0.831652
Counter({2: 7012, 0: 6218, 1: 5616})

Epoch :  17 loss training:  36.36689414596185 Time :  23251
accuracy train: 0.989492 val: 0.906278 test: 0.830324
max validation accuracy : 0.906278 max acc epoch : 17 test accuracy : 0.830324
Counter({1: 6940, 2: 6258, 0: 5648})

Epoch :  18 loss training:  32.34299441985786 Time :  23341
accuracy train: 0.992340 val: 0.900088 test: 0.832315
max validation accuracy : 0.906278 max acc epoch : 17 test accuracy : 0.830324
Counter({2: 6941, 1: 6253, 0: 5652})

Epoch :  19 loss training:  28.64325757790357 Time :  23431
accuracy train: 0.993617 val: 0.907162 test: 0.834572
max validation accuracy : 0.907162 max acc epoch : 19 test accuracy : 0.834572
Counter({2: 6943, 0: 6249, 1: 5654})

Epoch :  20 loss training:  25.022736825048923 Time :  23522
accuracy train: 0.995875 val: 0.908930 test: 0.836431
max validation accuracy : 0.908930 max acc epoch : 20 test accuracy : 0.836431
Counter({0: 6946, 1: 6253, 2: 5647})

Epoch :  21 loss training:  22.63145565893501 Time :  23613
accuracy train: 0.996465 val: 0.911583 test: 0.837228
max validation accuracy : 0.911583 max acc epoch : 21 test accuracy : 0.837228
Counter({2: 6952, 0: 6252, 1: 5642})

Epoch :  22 loss training:  20.65801148256287 Time :  23704
accuracy train: 0.997447 val: 0.908046 test: 0.836564
max validation accuracy : 0.911583 max acc epoch : 21 test accuracy : 0.837228
Counter({2: 6942, 1: 6259, 0: 5645})

Epoch :  23 loss training:  17.908730490133166 Time :  23794
accuracy train: 0.997741 val: 0.914235 test: 0.842539
max validation accuracy : 0.914235 max acc epoch : 23 test accuracy : 0.842539
Counter({1: 6959, 2: 6257, 0: 5630})

Epoch :  24 loss training:  16.996081191580743 Time :  23885
accuracy train: 0.998134 val: 0.915119 test: 0.840016
max validation accuracy : 0.915119 max acc epoch : 24 test accuracy : 0.840016
Counter({0: 6956, 2: 6220, 1: 5670})

Epoch :  25 loss training:  14.860038755461574 Time :  23977
accuracy train: 0.997938 val: 0.915119 test: 0.841344
max validation accuracy : 0.915119 max acc epoch : 24 test accuracy : 0.840016
Counter({2: 6928, 1: 6239, 0: 5679})

Epoch :  26 loss training:  12.332443853840232 Time :  24067
accuracy train: 0.998723 val: 0.913351 test: 0.840016
max validation accuracy : 0.915119 max acc epoch : 24 test accuracy : 0.840016
Counter({2: 6944, 1: 6241, 0: 5661})

Epoch :  27 loss training:  11.98676733742468 Time :  24158
accuracy train: 0.998920 val: 0.919540 test: 0.841476
max validation accuracy : 0.919540 max acc epoch : 27 test accuracy : 0.841476
Counter({2: 6931, 0: 6265, 1: 5650})

Epoch :  28 loss training:  11.686927990987897 Time :  24250
accuracy train: 0.999214 val: 0.908930 test: 0.843866
max validation accuracy : 0.919540 max acc epoch : 27 test accuracy : 0.841476
Counter({1: 6935, 2: 6266, 0: 5645})

Epoch :  29 loss training:  9.430357879493386 Time :  24344
accuracy train: 0.998723 val: 0.913351 test: 0.843999
max validation accuracy : 0.919540 max acc epoch : 27 test accuracy : 0.841476
Counter({1: 6930, 2: 6266, 0: 5650})

Epoch :  30 loss training:  9.0975588101428 Time :  24435
accuracy train: 0.999214 val: 0.918656 test: 0.843999
max validation accuracy : 0.919540 max acc epoch : 27 test accuracy : 0.841476
Counter({2: 6935, 1: 6266, 0: 5645})

Epoch :  31 loss training:  7.984294285881333 Time :  24526
accuracy train: 0.999313 val: 0.912467 test: 0.844796
max validation accuracy : 0.919540 max acc epoch : 27 test accuracy : 0.841476
Counter({0: 6936, 1: 6257, 2: 5653})

Epoch :  32 loss training:  7.759916289825924 Time :  24614
accuracy train: 0.999411 val: 0.914235 test: 0.845592
max validation accuracy : 0.919540 max acc epoch : 27 test accuracy : 0.841476
Counter({2: 6932, 1: 6266, 0: 5648})

Epoch :  33 loss training:  6.587950381683186 Time :  24706
accuracy train: 0.999214 val: 0.920424 test: 0.846123
max validation accuracy : 0.920424 max acc epoch : 33 test accuracy : 0.846123
Counter({0: 6941, 2: 6264, 1: 5641})

Epoch :  34 loss training:  5.666345056437422 Time :  24797
accuracy train: 0.999509 val: 0.916888 test: 0.846654
max validation accuracy : 0.920424 max acc epoch : 33 test accuracy : 0.846123
Counter({2: 6950, 0: 6264, 1: 5632})

Epoch :  35 loss training:  5.070580554311164 Time :  24887
accuracy train: 0.999411 val: 0.916888 test: 0.842937
max validation accuracy : 0.920424 max acc epoch : 33 test accuracy : 0.846123
Counter({2: 6947, 1: 6273, 0: 5626})

Epoch :  36 loss training:  5.902329598844517 Time :  24979
accuracy train: 0.999313 val: 0.923961 test: 0.847451
max validation accuracy : 0.923961 max acc epoch : 36 test accuracy : 0.847451
Counter({0: 6949, 1: 6290, 2: 5607})

Epoch :  37 loss training:  5.327429996395949 Time :  25076
accuracy train: 0.999411 val: 0.923961 test: 0.847716
max validation accuracy : 0.923961 max acc epoch : 36 test accuracy : 0.847451
Counter({1: 6949, 0: 6282, 2: 5615})

Epoch :  38 loss training:  4.693361722165719 Time :  25167
accuracy train: 0.999509 val: 0.917772 test: 0.847053
max validation accuracy : 0.923961 max acc epoch : 36 test accuracy : 0.847451
Counter({2: 6932, 1: 6260, 0: 5654})

Epoch :  39 loss training:  4.728072207421064 Time :  25257
accuracy train: 0.999411 val: 0.921309 test: 0.847451
max validation accuracy : 0.923961 max acc epoch : 36 test accuracy : 0.847451
Counter({1: 6923, 0: 6268, 2: 5655})

Epoch :  40 loss training:  3.797369451029226 Time :  25349
accuracy train: 0.999411 val: 0.923961 test: 0.843070
max validation accuracy : 0.923961 max acc epoch : 36 test accuracy : 0.847451
Counter({1: 6988, 2: 6289, 0: 5569})

Epoch :  41 loss training:  4.515210157202091 Time :  25439
accuracy train: 0.999509 val: 0.924845 test: 0.849442
max validation accuracy : 0.924845 max acc epoch : 41 test accuracy : 0.849442
Counter({2: 6955, 1: 6346, 0: 5545})

Epoch :  42 loss training:  3.221014160080813 Time :  25530
accuracy train: 0.999313 val: 0.930150 test: 0.850505
max validation accuracy : 0.930150 max acc epoch : 42 test accuracy : 0.850505
Counter({2: 6916, 0: 6384, 1: 5546})

Epoch :  43 loss training:  3.1975530539348256 Time :  25619
accuracy train: 0.999214 val: 0.923077 test: 0.848247
max validation accuracy : 0.930150 max acc epoch : 42 test accuracy : 0.850505
Counter({2: 6760, 0: 6560, 1: 5526})

Epoch :  44 loss training:  4.064816089368833 Time :  25712
accuracy train: 0.999411 val: 0.919540 test: 0.844397
max validation accuracy : 0.930150 max acc epoch : 42 test accuracy : 0.850505
Counter({0: 6798, 2: 6563, 1: 5485})

Epoch :  45 loss training:  3.6708322145568673 Time :  25802
accuracy train: 0.999313 val: 0.919540 test: 0.847451
max validation accuracy : 0.930150 max acc epoch : 42 test accuracy : 0.850505
Counter({2: 6821, 0: 6557, 1: 5468})

Epoch :  46 loss training:  2.0851432352210395 Time :  25891
accuracy train: 0.999411 val: 0.915119 test: 0.848646
max validation accuracy : 0.930150 max acc epoch : 42 test accuracy : 0.850505
Counter({2: 6823, 1: 6558, 0: 5465})

Epoch :  47 loss training:  3.063311033125501 Time :  25983
accuracy train: 0.999509 val: 0.924845 test: 0.848380
max validation accuracy : 0.930150 max acc epoch : 42 test accuracy : 0.850505
Counter({0: 6823, 1: 6561, 2: 5462})

Epoch :  48 loss training:  2.8162104862349224 Time :  26075
accuracy train: 0.999509 val: 0.924845 test: 0.848247
max validation accuracy : 0.930150 max acc epoch : 42 test accuracy : 0.850505
Counter({2: 6829, 0: 6562, 1: 5455})

Epoch :  49 loss training:  2.9966075653137523 Time :  26166
accuracy train: 0.999214 val: 0.923961 test: 0.847185
max validation accuracy : 0.930150 max acc epoch : 42 test accuracy : 0.850505
Counter({1: 6828, 0: 6574, 2: 5444})

Epoch :  50 loss training:  2.640629610643373 Time :  26256
accuracy train: 0.999509 val: 0.918656 test: 0.851168
max validation accuracy : 0.930150 max acc epoch : 42 test accuracy : 0.850505
Counter({2: 6827, 1: 6576, 0: 5443})

Epoch :  51 loss training:  2.677700904547237 Time :  26349
accuracy train: 0.999116 val: 0.918656 test: 0.847849
max validation accuracy : 0.930150 max acc epoch : 42 test accuracy : 0.850505
Counter({0: 6825, 1: 6573, 2: 5448})

Epoch :  52 loss training:  3.1099822485884943 Time :  26442
accuracy train: 0.999411 val: 0.922193 test: 0.847451
max validation accuracy : 0.930150 max acc epoch : 42 test accuracy : 0.850505
Counter({0: 6827, 1: 6572, 2: 5447})

Epoch :  53 loss training:  2.4196566448226804 Time :  26533
accuracy train: 0.999509 val: 0.920424 test: 0.852230
max validation accuracy : 0.930150 max acc epoch : 42 test accuracy : 0.850505
Counter({1: 6833, 2: 6575, 0: 5438})

Epoch :  54 loss training:  2.273608340845385 Time :  26624
accuracy train: 0.999313 val: 0.926614 test: 0.849708
max validation accuracy : 0.930150 max acc epoch : 42 test accuracy : 0.850505
Counter({1: 6836, 0: 6578, 2: 5432})

Epoch :  55 loss training:  1.8614721719713998 Time :  26714
accuracy train: 0.999509 val: 0.928382 test: 0.854355
max validation accuracy : 0.930150 max acc epoch : 42 test accuracy : 0.850505
Counter({1: 6836, 2: 6576, 0: 5434})

Epoch :  56 loss training:  1.971146528449026 Time :  26804
accuracy train: 0.999411 val: 0.924845 test: 0.848911
max validation accuracy : 0.930150 max acc epoch : 42 test accuracy : 0.850505
Counter({0: 6856, 1: 6578, 2: 5412})

Epoch :  57 loss training:  1.8840441746724537 Time :  26894
accuracy train: 0.999214 val: 0.927498 test: 0.851965
max validation accuracy : 0.930150 max acc epoch : 42 test accuracy : 0.850505
Counter({2: 6863, 0: 6580, 1: 5403})

Epoch :  58 loss training:  1.7442938238709758 Time :  26987
accuracy train: 0.999411 val: 0.929266 test: 0.849575
max validation accuracy : 0.930150 max acc epoch : 42 test accuracy : 0.850505
Counter({1: 6863, 2: 6586, 0: 5397})

Epoch :  59 loss training:  2.0698059365531662 Time :  27078
accuracy train: 0.999509 val: 0.921309 test: 0.847982
max validation accuracy : 0.930150 max acc epoch : 42 test accuracy : 0.850505
Counter({1: 6887, 2: 6574, 0: 5385})

Epoch :  60 loss training:  1.4953260731090268 Time :  27168
accuracy train: 0.999509 val: 0.932803 test: 0.854355
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({1: 6887, 0: 6574, 2: 5385})

Epoch :  61 loss training:  1.9845304826812935 Time :  27259
accuracy train: 0.999509 val: 0.927498 test: 0.851567
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({2: 6882, 1: 6585, 0: 5379})

Epoch :  62 loss training:  1.8587724074313883 Time :  27349
accuracy train: 0.999411 val: 0.931034 test: 0.849841
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({1: 6889, 2: 6554, 0: 5403})

Epoch :  63 loss training:  1.966166689660895 Time :  27439
accuracy train: 0.999411 val: 0.920424 test: 0.846920
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({1: 6897, 2: 6545, 0: 5404})

Epoch :  64 loss training:  1.2171050020479015 Time :  27528
accuracy train: 0.999411 val: 0.927498 test: 0.848115
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({2: 6898, 0: 6545, 1: 5403})

Epoch :  65 loss training:  1.7908763080922654 Time :  27618
accuracy train: 0.999509 val: 0.924845 test: 0.847451
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({1: 6902, 0: 6543, 2: 5401})

Epoch :  66 loss training:  1.5529175095507526 Time :  27707
accuracy train: 0.999607 val: 0.923077 test: 0.846654
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({2: 6900, 1: 6545, 0: 5401})

Epoch :  67 loss training:  1.5150430523244722 Time :  27797
accuracy train: 0.999411 val: 0.927498 test: 0.848247
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({1: 6899, 2: 6549, 0: 5398})

Epoch :  68 loss training:  1.1353505726146977 Time :  27887
accuracy train: 0.999411 val: 0.926614 test: 0.849044
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({1: 6899, 2: 6547, 0: 5400})

Epoch :  69 loss training:  2.271334941164241 Time :  27977
accuracy train: 0.999411 val: 0.929266 test: 0.851036
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({1: 6900, 0: 6560, 2: 5386})

Epoch :  70 loss training:  1.4014389446310815 Time :  28066
accuracy train: 0.999607 val: 0.930150 test: 0.852363
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({2: 6903, 1: 6565, 0: 5378})

Epoch :  71 loss training:  1.5904233869769087 Time :  28156
accuracy train: 0.999509 val: 0.927498 test: 0.850372
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({0: 6917, 1: 6559, 2: 5370})

Epoch :  72 loss training:  1.413031982650864 Time :  28245
accuracy train: 0.999509 val: 0.931919 test: 0.848646
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({1: 6915, 0: 6562, 2: 5369})

Epoch :  73 loss training:  1.0731317459358252 Time :  28335
accuracy train: 0.999509 val: 0.931034 test: 0.844928
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({1: 6915, 0: 6563, 2: 5368})

Epoch :  74 loss training:  1.330560101152514 Time :  28424
accuracy train: 0.999509 val: 0.923961 test: 0.848646
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({2: 6917, 1: 6561, 0: 5368})

Epoch :  75 loss training:  1.5884718325032736 Time :  28513
accuracy train: 0.999509 val: 0.924845 test: 0.849310
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({2: 6949, 1: 6566, 0: 5331})

Epoch :  76 loss training:  1.0417415246884048 Time :  28602
accuracy train: 0.999411 val: 0.923961 test: 0.851036
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({0: 6949, 1: 6566, 2: 5331})

Epoch :  77 loss training:  0.9279930014563433 Time :  28692
accuracy train: 0.999509 val: 0.926614 test: 0.851168
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({2: 6963, 1: 6565, 0: 5318})

Epoch :  78 loss training:  1.404536523434217 Time :  28783
accuracy train: 0.999509 val: 0.929266 test: 0.848247
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({2: 6964, 1: 6565, 0: 5317})

Epoch :  79 loss training:  1.5813718568133481 Time :  28870
accuracy train: 0.999607 val: 0.927498 test: 0.848911
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({1: 6963, 0: 6563, 2: 5320})

Epoch :  80 loss training:  1.0655422626368818 Time :  28961
accuracy train: 0.999313 val: 0.929266 test: 0.850372
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({1: 6962, 2: 6568, 0: 5316})

Epoch :  81 loss training:  1.7699969974964915 Time :  29048
accuracy train: 0.999509 val: 0.929266 test: 0.850372
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({2: 6964, 1: 6578, 0: 5304})

Epoch :  82 loss training:  1.7717060797422164 Time :  29138
accuracy train: 0.999411 val: 0.928382 test: 0.851832
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({0: 6962, 2: 6583, 1: 5301})

Epoch :  83 loss training:  1.0493558658836264 Time :  29228
accuracy train: 0.999411 val: 0.927498 test: 0.850372
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({0: 6960, 1: 6594, 2: 5292})

Epoch :  84 loss training:  1.6449683619830466 Time :  29316
accuracy train: 0.999509 val: 0.925729 test: 0.849708
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({2: 6957, 1: 6617, 0: 5272})

Epoch :  85 loss training:  0.8546860336336977 Time :  29402
accuracy train: 0.999509 val: 0.921309 test: 0.851434
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({1: 6958, 0: 6618, 2: 5270})

Epoch :  86 loss training:  0.9932880144970113 Time :  29492
accuracy train: 0.999509 val: 0.927498 test: 0.850903
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({1: 6951, 0: 6629, 2: 5266})

Epoch :  87 loss training:  1.6515824503549084 Time :  29581
accuracy train: 0.999509 val: 0.931034 test: 0.848380
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({1: 6950, 0: 6632, 2: 5264})

Epoch :  88 loss training:  1.0454969771253673 Time :  29672
accuracy train: 0.999509 val: 0.925729 test: 0.853824
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({0: 6953, 2: 6632, 1: 5261})

Epoch :  89 loss training:  1.3470813938838546 Time :  29762
accuracy train: 0.999509 val: 0.929266 test: 0.853425
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({0: 6953, 1: 6631, 2: 5262})

Epoch :  90 loss training:  1.0581025001083617 Time :  29851
accuracy train: 0.999411 val: 0.927498 test: 0.851567
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({0: 6976, 1: 6625, 2: 5245})

Epoch :  91 loss training:  0.8458166666796387 Time :  29941
accuracy train: 0.999607 val: 0.924845 test: 0.851434
max validation accuracy : 0.932803 max acc epoch : 60 test accuracy : 0.854355
Counter({2: 6978, 0: 6625, 1: 5243})

========================================================================================================================================================================================================
best acc epoch :  60
validation accuracy :  0.9328028293545535
test accuracy :  0.8543547530536378
last test_accuracy :  0.8514338821030271
second best val :  0.9319186560565871
second best test :  0.8543547530536378
max gap 18
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  93 	 val_accuracy : 0.92927 	 test_accuracy : 0.85130 	 last test_accuracy : 0.85130 	 second best val : 0.92838 	 second best test : 0.84811
k :  1 	 best_acc epoch :  79 	 val_accuracy : 0.92927 	 test_accuracy : 0.85130 	 last test_accuracy : 0.84692 	 second best val : 0.92838 	 second best test : 0.85157
k :  2 	 best_acc epoch :  60 	 val_accuracy : 0.93280 	 test_accuracy : 0.85435 	 last test_accuracy : 0.85143 	 second best val : 0.93192 	 second best test : 0.85435

avg :  	 val_accuracy : 0.93045 	 test_accuracy : 0.85232 	 last_accuracy : 0.84988 	 second best val : 0.92956 	 second best test : 0.85135

std :  	 val_accuracy : 0.00167 	 test_accuracy : 0.00144 	 last_accuracy : 0.00210 	 second best val : 0.00167 	 second best test : 0.00255
