

date and time :  Thu Jun 10 23:43:28 2021
itr : 0
Namespace(batch_size=64, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=221, weight_decay=1e-10)
device :  cuda:0
Counter({2: 7569, 1: 6376, 0: 4901})

Epoch :  1 loss training:  337.53951132297516 Time :  78
accuracy train: 0.818226 val: 0.799293 test: 0.745751
max validation accuracy : 0.799293 max acc epoch : 1 test accuracy : 0.745751
Counter({2: 7169, 0: 6267, 1: 5410})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  203.41782514750957 Time :  208
accuracy train: 0.850732 val: 0.818744 test: 0.764737
max validation accuracy : 0.818744 max acc epoch : 2 test accuracy : 0.764737
Counter({0: 7666, 2: 6327, 1: 4853})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  175.07859827578068 Time :  328
accuracy train: 0.868899 val: 0.826702 test: 0.769517
max validation accuracy : 0.826702 max acc epoch : 3 test accuracy : 0.769517
Counter({0: 7484, 2: 6307, 1: 5055})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  132.77360685169697 Time :  452
accuracy train: 0.905529 val: 0.855880 test: 0.796734
max validation accuracy : 0.855880 max acc epoch : 4 test accuracy : 0.796734
Counter({0: 7516, 1: 6601, 2: 4729})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  125.02761514484882 Time :  573
accuracy train: 0.920063 val: 0.874447 test: 0.801646
max validation accuracy : 0.874447 max acc epoch : 5 test accuracy : 0.801646
Counter({2: 7565, 0: 6605, 1: 4676})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  116.24486434459686 Time :  690
accuracy train: 0.926151 val: 0.870911 test: 0.801115
max validation accuracy : 0.874447 max acc epoch : 5 test accuracy : 0.801646
Counter({1: 7498, 2: 6688, 0: 4660})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  96.54685758799314 Time :  812
accuracy train: 0.937052 val: 0.877984 test: 0.807621
max validation accuracy : 0.877984 max acc epoch : 7 test accuracy : 0.807621
Counter({0: 7493, 1: 6705, 2: 4648})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  93.3387102112174 Time :  932
accuracy train: 0.934499 val: 0.870911 test: 0.808550
max validation accuracy : 0.877984 max acc epoch : 7 test accuracy : 0.807621
Counter({2: 7484, 1: 6700, 0: 4662})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  86.77422508224845 Time :  1052
accuracy train: 0.947265 val: 0.875332 test: 0.815720
max validation accuracy : 0.877984 max acc epoch : 7 test accuracy : 0.807621
Counter({1: 7401, 0: 6776, 2: 4669})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  78.06102382019162 Time :  1169
accuracy train: 0.953255 val: 0.882405 test: 0.816914
max validation accuracy : 0.882405 max acc epoch : 10 test accuracy : 0.816914
Counter({1: 7384, 2: 6793, 0: 4669})

Epoch :  11 loss training:  76.99054677039385 Time :  1304
accuracy train: 0.959246 val: 0.885057 test: 0.819968
max validation accuracy : 0.885057 max acc epoch : 11 test accuracy : 0.819968
Counter({2: 7357, 0: 6833, 1: 4656})

Epoch :  12 loss training:  68.2699504904449 Time :  1451
accuracy train: 0.966218 val: 0.895668 test: 0.821561
max validation accuracy : 0.895668 max acc epoch : 12 test accuracy : 0.821561
Counter({1: 7337, 0: 6849, 2: 4660})

Epoch :  13 loss training:  59.80224026367068 Time :  1593
accuracy train: 0.969655 val: 0.893899 test: 0.822623
max validation accuracy : 0.895668 max acc epoch : 12 test accuracy : 0.821561
Counter({0: 7309, 1: 6868, 2: 4669})

Epoch :  14 loss training:  54.97508459351957 Time :  1751
accuracy train: 0.977413 val: 0.895668 test: 0.826606
max validation accuracy : 0.895668 max acc epoch : 12 test accuracy : 0.821561
Counter({0: 7254, 2: 6910, 1: 4682})

Epoch :  15 loss training:  49.57376963272691 Time :  1929
accuracy train: 0.980949 val: 0.900973 test: 0.823686
max validation accuracy : 0.900973 max acc epoch : 15 test accuracy : 0.823686
Counter({0: 7146, 1: 7013, 2: 4687})

Epoch :  16 loss training:  44.46156942285597 Time :  2111
accuracy train: 0.984779 val: 0.903625 test: 0.829129
max validation accuracy : 0.903625 max acc epoch : 16 test accuracy : 0.829129
Counter({1: 7136, 0: 7008, 2: 4702})

Epoch :  17 loss training:  39.70979424752295 Time :  2294
accuracy train: 0.987823 val: 0.913351 test: 0.831917
max validation accuracy : 0.913351 max acc epoch : 17 test accuracy : 0.831917
Counter({1: 7171, 2: 6975, 0: 4700})

Epoch :  18 loss training:  34.66118054930121 Time :  2472
accuracy train: 0.989590 val: 0.907162 test: 0.835502
max validation accuracy : 0.913351 max acc epoch : 17 test accuracy : 0.831917
Counter({1: 7190, 0: 6974, 2: 4682})

Epoch :  19 loss training:  30.71302147116512 Time :  2659
accuracy train: 0.991456 val: 0.915119 test: 0.835900
max validation accuracy : 0.915119 max acc epoch : 19 test accuracy : 0.835900
Counter({2: 7221, 0: 6966, 1: 4659})

Epoch :  20 loss training:  27.210984827484936 Time :  2841
accuracy train: 0.994108 val: 0.918656 test: 0.837361
max validation accuracy : 0.918656 max acc epoch : 20 test accuracy : 0.837361
Counter({1: 7239, 2: 6955, 0: 4652})

Epoch :  21 loss training:  25.52673862595111 Time :  3009
accuracy train: 0.995286 val: 0.917772 test: 0.835104
max validation accuracy : 0.918656 max acc epoch : 20 test accuracy : 0.837361
Counter({0: 7249, 1: 6944, 2: 4653})

Epoch :  22 loss training:  23.95535916928202 Time :  3184
accuracy train: 0.995483 val: 0.918656 test: 0.838423
max validation accuracy : 0.918656 max acc epoch : 20 test accuracy : 0.837361
Counter({1: 7323, 0: 6867, 2: 4656})

Epoch :  23 loss training:  19.058804661035538 Time :  3371
accuracy train: 0.996661 val: 0.920424 test: 0.842140
max validation accuracy : 0.920424 max acc epoch : 23 test accuracy : 0.842140
Counter({1: 7338, 2: 6855, 0: 4653})

Epoch :  24 loss training:  18.29738559969701 Time :  3547
accuracy train: 0.997250 val: 0.917772 test: 0.843999
max validation accuracy : 0.920424 max acc epoch : 23 test accuracy : 0.842140
Counter({0: 7352, 1: 6845, 2: 4649})

Epoch :  25 loss training:  14.857761068968102 Time :  3725
accuracy train: 0.997349 val: 0.919540 test: 0.843733
max validation accuracy : 0.920424 max acc epoch : 23 test accuracy : 0.842140
Counter({2: 7404, 0: 6823, 1: 4619})

Epoch :  26 loss training:  13.54626982123591 Time :  3894
accuracy train: 0.997545 val: 0.921309 test: 0.844530
max validation accuracy : 0.921309 max acc epoch : 26 test accuracy : 0.844530
Counter({2: 7453, 1: 6793, 0: 4600})

Epoch :  27 loss training:  12.107514998409897 Time :  4057
accuracy train: 0.998429 val: 0.924845 test: 0.845459
max validation accuracy : 0.924845 max acc epoch : 27 test accuracy : 0.845459
Counter({0: 7477, 1: 6770, 2: 4599})

Epoch :  28 loss training:  11.566031939350069 Time :  4232
accuracy train: 0.998723 val: 0.928382 test: 0.846787
max validation accuracy : 0.928382 max acc epoch : 28 test accuracy : 0.846787
Counter({0: 7479, 2: 6751, 1: 4616})

Epoch :  29 loss training:  10.09474479232449 Time :  4402
accuracy train: 0.998822 val: 0.920424 test: 0.845592
max validation accuracy : 0.928382 max acc epoch : 28 test accuracy : 0.846787
Counter({0: 7517, 2: 6701, 1: 4628})

Epoch :  30 loss training:  10.73865164234303 Time :  4591
accuracy train: 0.998822 val: 0.923961 test: 0.844397
max validation accuracy : 0.928382 max acc epoch : 28 test accuracy : 0.846787
Counter({0: 7527, 2: 6694, 1: 4625})

Epoch :  31 loss training:  8.787086550379172 Time :  4765
accuracy train: 0.998625 val: 0.923961 test: 0.849044
max validation accuracy : 0.928382 max acc epoch : 28 test accuracy : 0.846787
Counter({1: 7587, 0: 6644, 2: 4615})

Epoch :  32 loss training:  7.873880935483612 Time :  4953
accuracy train: 0.999116 val: 0.923961 test: 0.849442
max validation accuracy : 0.928382 max acc epoch : 28 test accuracy : 0.846787
Counter({0: 7618, 2: 6629, 1: 4599})

Epoch :  33 loss training:  7.732820246950723 Time :  5129
accuracy train: 0.999214 val: 0.925729 test: 0.845858
max validation accuracy : 0.928382 max acc epoch : 28 test accuracy : 0.846787
Counter({2: 7633, 0: 6626, 1: 4587})

Epoch :  34 loss training:  6.47849663591478 Time :  5294
accuracy train: 0.999313 val: 0.927498 test: 0.849310
max validation accuracy : 0.928382 max acc epoch : 28 test accuracy : 0.846787
Counter({1: 7630, 2: 6614, 0: 4602})

Epoch :  35 loss training:  5.651438200031407 Time :  5465
accuracy train: 0.999313 val: 0.926614 test: 0.847318
max validation accuracy : 0.928382 max acc epoch : 28 test accuracy : 0.846787
Counter({1: 7633, 0: 6615, 2: 4598})

Epoch :  36 loss training:  6.082876058295369 Time :  5636
accuracy train: 0.999116 val: 0.928382 test: 0.847584
max validation accuracy : 0.928382 max acc epoch : 28 test accuracy : 0.846787
Counter({0: 7639, 2: 6602, 1: 4605})

Epoch :  37 loss training:  5.221813929092605 Time :  5810
accuracy train: 0.999018 val: 0.930150 test: 0.846920
max validation accuracy : 0.930150 max acc epoch : 37 test accuracy : 0.846920
Counter({1: 7660, 2: 6594, 0: 4592})

Epoch :  38 loss training:  4.748170923034195 Time :  5936
accuracy train: 0.999116 val: 0.928382 test: 0.853160
max validation accuracy : 0.930150 max acc epoch : 37 test accuracy : 0.846920
Counter({2: 7669, 0: 6585, 1: 4592})

Epoch :  39 loss training:  4.676005013519898 Time :  6067
accuracy train: 0.999411 val: 0.936340 test: 0.849841
max validation accuracy : 0.936340 max acc epoch : 39 test accuracy : 0.849841
Counter({2: 7717, 0: 6538, 1: 4591})

Epoch :  40 loss training:  4.296102814987535 Time :  6204
accuracy train: 0.999411 val: 0.929266 test: 0.850637
max validation accuracy : 0.936340 max acc epoch : 39 test accuracy : 0.849841
Counter({2: 7720, 1: 6533, 0: 4593})

Epoch :  41 loss training:  4.3265111346845515 Time :  6350
accuracy train: 0.999313 val: 0.935455 test: 0.851832
max validation accuracy : 0.936340 max acc epoch : 39 test accuracy : 0.849841
Counter({0: 7732, 2: 6520, 1: 4594})

Epoch :  42 loss training:  3.9550528476393083 Time :  6478
accuracy train: 0.999411 val: 0.935455 test: 0.850903
max validation accuracy : 0.936340 max acc epoch : 39 test accuracy : 0.849841
Counter({0: 7737, 1: 6523, 2: 4586})

Epoch :  43 loss training:  4.071039920323528 Time :  6622
accuracy train: 0.999509 val: 0.927498 test: 0.848646
max validation accuracy : 0.936340 max acc epoch : 39 test accuracy : 0.849841
Counter({0: 7757, 1: 6508, 2: 4581})

Epoch :  44 loss training:  3.5540676215314306 Time :  6761
accuracy train: 0.999313 val: 0.934571 test: 0.853691
max validation accuracy : 0.936340 max acc epoch : 39 test accuracy : 0.849841
Counter({0: 7763, 2: 6498, 1: 4585})

Epoch :  45 loss training:  3.446354920444719 Time :  6903
accuracy train: 0.999313 val: 0.933687 test: 0.849708
max validation accuracy : 0.936340 max acc epoch : 39 test accuracy : 0.849841
Counter({1: 7780, 2: 6485, 0: 4581})

Epoch :  46 loss training:  3.050084219285054 Time :  7040
accuracy train: 0.999313 val: 0.937224 test: 0.853691
max validation accuracy : 0.937224 max acc epoch : 46 test accuracy : 0.853691
Counter({2: 7787, 0: 6477, 1: 4582})

Epoch :  47 loss training:  3.158880914503243 Time :  7185
accuracy train: 0.999313 val: 0.931919 test: 0.851168
max validation accuracy : 0.937224 max acc epoch : 46 test accuracy : 0.853691
Counter({0: 7794, 1: 6468, 2: 4584})

Epoch :  48 loss training:  3.607172545249341 Time :  7327
accuracy train: 0.999411 val: 0.939876 test: 0.854488
max validation accuracy : 0.939876 max acc epoch : 48 test accuracy : 0.854488
Counter({1: 7794, 0: 6469, 2: 4583})

Epoch :  49 loss training:  2.477467715907551 Time :  7469
accuracy train: 0.999411 val: 0.934571 test: 0.855019
max validation accuracy : 0.939876 max acc epoch : 48 test accuracy : 0.854488
Counter({1: 7787, 0: 6483, 2: 4576})

Epoch :  50 loss training:  2.913625104665698 Time :  7608
accuracy train: 0.999411 val: 0.940760 test: 0.853293
max validation accuracy : 0.940760 max acc epoch : 50 test accuracy : 0.853293
Counter({1: 7792, 2: 6489, 0: 4565})

Epoch :  51 loss training:  2.0251814789226046 Time :  7751
accuracy train: 0.999313 val: 0.942529 test: 0.853160
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({0: 7797, 2: 6491, 1: 4558})

Epoch :  52 loss training:  2.1763172827049857 Time :  7887
accuracy train: 0.999411 val: 0.937224 test: 0.849575
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({0: 7810, 2: 6495, 1: 4541})

Epoch :  53 loss training:  2.915376966164331 Time :  8029
accuracy train: 0.999411 val: 0.931034 test: 0.853027
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({1: 7814, 0: 6501, 2: 4531})

Epoch :  54 loss training:  2.4441267095680814 Time :  8163
accuracy train: 0.999313 val: 0.930150 test: 0.853824
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({1: 7827, 0: 6510, 2: 4509})

Epoch :  55 loss training:  2.4496065900093527 Time :  8295
accuracy train: 0.999411 val: 0.936340 test: 0.853824
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({1: 7832, 0: 6512, 2: 4502})

Epoch :  56 loss training:  2.2782917562435614 Time :  8437
accuracy train: 0.999411 val: 0.934571 test: 0.857807
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({0: 7836, 2: 6512, 1: 4498})

Epoch :  57 loss training:  1.8204982531242422 Time :  8571
accuracy train: 0.999411 val: 0.935455 test: 0.848911
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({1: 7856, 0: 6520, 2: 4470})

Epoch :  58 loss training:  1.901213456003461 Time :  8712
accuracy train: 0.999607 val: 0.938992 test: 0.856081
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({1: 7854, 2: 6528, 0: 4464})

Epoch :  59 loss training:  1.6857807730339118 Time :  8848
accuracy train: 0.999509 val: 0.934571 test: 0.855019
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({1: 7856, 2: 6525, 0: 4465})

Epoch :  60 loss training:  2.2389086353214225 Time :  8986
accuracy train: 0.999411 val: 0.936340 test: 0.856213
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({2: 7853, 0: 6524, 1: 4469})

Epoch :  61 loss training:  2.2099164472165285 Time :  9129
accuracy train: 0.999411 val: 0.935455 test: 0.852496
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({0: 7854, 2: 6527, 1: 4465})

Epoch :  62 loss training:  1.7004632692078303 Time :  9268
accuracy train: 0.999411 val: 0.932803 test: 0.850239
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({0: 7853, 2: 6518, 1: 4475})

Epoch :  63 loss training:  1.6243708578986116 Time :  9416
accuracy train: 0.999607 val: 0.938108 test: 0.854886
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({2: 7854, 0: 6514, 1: 4478})

Epoch :  64 loss training:  1.705288848184864 Time :  9552
accuracy train: 0.999313 val: 0.936340 test: 0.852894
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({2: 7852, 1: 6514, 0: 4480})

Epoch :  65 loss training:  1.8432155102782417 Time :  9685
accuracy train: 0.999313 val: 0.935455 test: 0.852762
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({0: 7849, 1: 6517, 2: 4480})

Epoch :  66 loss training:  1.5477563934437057 Time :  9826
accuracy train: 0.999607 val: 0.938992 test: 0.846256
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({2: 7836, 0: 6524, 1: 4486})

Epoch :  67 loss training:  1.5613979289628332 Time :  9960
accuracy train: 0.999509 val: 0.928382 test: 0.854753
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({0: 7833, 1: 6524, 2: 4489})

Epoch :  68 loss training:  1.8234835155672044 Time :  10106
accuracy train: 0.999411 val: 0.941645 test: 0.849575
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({1: 7830, 0: 6561, 2: 4455})

Epoch :  69 loss training:  1.7802343526273035 Time :  10237
accuracy train: 0.999411 val: 0.935455 test: 0.850106
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({1: 7842, 0: 6560, 2: 4444})

Epoch :  70 loss training:  1.3493782814930455 Time :  10370
accuracy train: 0.999411 val: 0.934571 test: 0.855815
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({2: 7840, 0: 6568, 1: 4438})

Epoch :  71 loss training:  1.5338093939026294 Time :  10506
accuracy train: 0.999411 val: 0.936340 test: 0.853160
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({2: 7845, 0: 6570, 1: 4431})

Epoch :  72 loss training:  1.2468492316402262 Time :  10647
accuracy train: 0.999509 val: 0.937224 test: 0.857541
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({2: 7850, 1: 6567, 0: 4429})

Epoch :  73 loss training:  1.2712596205856244 Time :  10784
accuracy train: 0.999411 val: 0.937224 test: 0.855948
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({0: 7869, 2: 6563, 1: 4414})

Epoch :  74 loss training:  1.4089385137995123 Time :  10925
accuracy train: 0.999509 val: 0.934571 test: 0.853027
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({1: 7881, 0: 6563, 2: 4402})

Epoch :  75 loss training:  1.616263553931276 Time :  11070
accuracy train: 0.999411 val: 0.935455 test: 0.853027
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({1: 7905, 0: 6550, 2: 4391})

Epoch :  76 loss training:  1.672133564699834 Time :  11216
accuracy train: 0.999411 val: 0.933687 test: 0.854488
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({2: 7910, 1: 6548, 0: 4388})

Epoch :  77 loss training:  1.569950837538272 Time :  11364
accuracy train: 0.999411 val: 0.933687 test: 0.848513
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({1: 7921, 2: 6540, 0: 4385})

Epoch :  78 loss training:  0.8528294083280343 Time :  11511
accuracy train: 0.999607 val: 0.935455 test: 0.852894
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({1: 7934, 0: 6526, 2: 4386})

Epoch :  79 loss training:  0.9870753464638256 Time :  11646
accuracy train: 0.999607 val: 0.935455 test: 0.854753
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({1: 7939, 2: 6519, 0: 4388})

Epoch :  80 loss training:  1.4071478532896435 Time :  11799
accuracy train: 0.999509 val: 0.935455 test: 0.853691
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({2: 7933, 0: 6525, 1: 4388})

Epoch :  81 loss training:  1.3418541638966417 Time :  11936
accuracy train: 0.999313 val: 0.938992 test: 0.851965
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({0: 7942, 2: 6526, 1: 4378})

Epoch :  82 loss training:  1.6963858919516497 Time :  12077
accuracy train: 0.999411 val: 0.938992 test: 0.856877
max validation accuracy : 0.942529 max acc epoch : 51 test accuracy : 0.853160
Counter({0: 7942, 1: 6527, 2: 4377})

========================================================================================================================================================================================================
max acc epoch :  51
max validation accuracy :  0.9425287356321839
test accuracy :  0.8531598513011153
last test_accuracy :  0.8568773234200744
max gap 9
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=221, weight_decay=1e-10)
device :  cuda:0
Counter({2: 7569, 1: 6376, 0: 4901})

Epoch :  1 loss training:  336.7560995221138 Time :  12242
accuracy train: 0.819798 val: 0.800177 test: 0.747610
max validation accuracy : 0.800177 max acc epoch : 1 test accuracy : 0.747610
Counter({1: 7291, 0: 6583, 2: 4972})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  202.64657773077488 Time :  12378
accuracy train: 0.854169 val: 0.838196 test: 0.768189
max validation accuracy : 0.838196 max acc epoch : 2 test accuracy : 0.768189
Counter({1: 7773, 2: 6360, 0: 4713})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  172.85130470991135 Time :  12500
accuracy train: 0.867131 val: 0.820513 test: 0.769517
max validation accuracy : 0.838196 max acc epoch : 2 test accuracy : 0.768189
Counter({0: 7311, 1: 6227, 2: 5308})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  132.16252491250634 Time :  12619
accuracy train: 0.902976 val: 0.857648 test: 0.799788
max validation accuracy : 0.857648 max acc epoch : 4 test accuracy : 0.799788
Counter({2: 7793, 1: 6323, 0: 4730})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  123.19593378156424 Time :  12742
accuracy train: 0.923696 val: 0.869142 test: 0.800451
max validation accuracy : 0.869142 max acc epoch : 5 test accuracy : 0.800451
Counter({1: 7852, 0: 6313, 2: 4681})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  112.02145059406757 Time :  12874
accuracy train: 0.923991 val: 0.864721 test: 0.799655
max validation accuracy : 0.869142 max acc epoch : 5 test accuracy : 0.800451
Counter({1: 7932, 0: 6283, 2: 4631})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  96.31696588546038 Time :  13009
accuracy train: 0.935186 val: 0.871795 test: 0.808019
max validation accuracy : 0.871795 max acc epoch : 7 test accuracy : 0.808019
Counter({1: 7921, 0: 6299, 2: 4626})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  92.48266883194447 Time :  13144
accuracy train: 0.934400 val: 0.873563 test: 0.806824
max validation accuracy : 0.873563 max acc epoch : 8 test accuracy : 0.806824
Counter({1: 7901, 2: 6301, 0: 4644})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  87.01279655098915 Time :  13273
accuracy train: 0.950506 val: 0.885942 test: 0.815587
max validation accuracy : 0.885942 max acc epoch : 9 test accuracy : 0.815587
Counter({0: 7884, 1: 6308, 2: 4654})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  77.76840610429645 Time :  13402
accuracy train: 0.951193 val: 0.885942 test: 0.817180
max validation accuracy : 0.885942 max acc epoch : 9 test accuracy : 0.815587
Counter({1: 7868, 0: 6314, 2: 4664})

Epoch :  11 loss training:  75.72776142135262 Time :  13534
accuracy train: 0.957380 val: 0.894783 test: 0.821561
max validation accuracy : 0.894783 max acc epoch : 11 test accuracy : 0.821561
Counter({0: 7869, 2: 6323, 1: 4654})

Epoch :  12 loss training:  69.35316657274961 Time :  13671
accuracy train: 0.966807 val: 0.893015 test: 0.822225
max validation accuracy : 0.894783 max acc epoch : 11 test accuracy : 0.821561
Counter({1: 7839, 0: 6355, 2: 4652})

Epoch :  13 loss training:  59.93583923764527 Time :  13815
accuracy train: 0.969164 val: 0.895668 test: 0.826075
max validation accuracy : 0.895668 max acc epoch : 13 test accuracy : 0.826075
Counter({0: 7837, 2: 6360, 1: 4649})

Epoch :  14 loss training:  55.46950884535909 Time :  13946
accuracy train: 0.976235 val: 0.897436 test: 0.826739
max validation accuracy : 0.897436 max acc epoch : 14 test accuracy : 0.826739
Counter({1: 7830, 2: 6360, 0: 4656})

Epoch :  15 loss training:  49.32675816491246 Time :  14087
accuracy train: 0.979672 val: 0.907162 test: 0.825013
max validation accuracy : 0.907162 max acc epoch : 15 test accuracy : 0.825013
Counter({1: 7798, 2: 6385, 0: 4663})

Epoch :  16 loss training:  43.58242211025208 Time :  14214
accuracy train: 0.985270 val: 0.906278 test: 0.831386
max validation accuracy : 0.907162 max acc epoch : 15 test accuracy : 0.825013
Counter({2: 7721, 0: 6457, 1: 4668})

Epoch :  17 loss training:  38.5416363440454 Time :  14341
accuracy train: 0.986350 val: 0.907162 test: 0.828332
max validation accuracy : 0.907162 max acc epoch : 15 test accuracy : 0.825013
Counter({2: 7656, 0: 6549, 1: 4641})

Epoch :  18 loss training:  35.82672647200525 Time :  14486
accuracy train: 0.988805 val: 0.907162 test: 0.833643
max validation accuracy : 0.907162 max acc epoch : 15 test accuracy : 0.825013
Counter({0: 7554, 2: 6644, 1: 4648})

Epoch :  19 loss training:  30.94737180415541 Time :  14625
accuracy train: 0.991162 val: 0.915119 test: 0.835236
max validation accuracy : 0.915119 max acc epoch : 19 test accuracy : 0.835236
Counter({1: 7505, 2: 6724, 0: 4617})

Epoch :  20 loss training:  27.864677915349603 Time :  14758
accuracy train: 0.994010 val: 0.916888 test: 0.836962
max validation accuracy : 0.916888 max acc epoch : 20 test accuracy : 0.836962
Counter({1: 7448, 0: 6760, 2: 4638})

Epoch :  21 loss training:  24.732791773509234 Time :  14885
accuracy train: 0.995188 val: 0.917772 test: 0.839352
max validation accuracy : 0.917772 max acc epoch : 21 test accuracy : 0.839352
Counter({1: 7427, 2: 6765, 0: 4654})

Epoch :  22 loss training:  20.771387193351984 Time :  15029
accuracy train: 0.995188 val: 0.916888 test: 0.838821
max validation accuracy : 0.917772 max acc epoch : 21 test accuracy : 0.839352
Counter({2: 7409, 0: 6784, 1: 4653})

Epoch :  23 loss training:  19.721253220457584 Time :  15157
accuracy train: 0.996563 val: 0.916888 test: 0.840281
max validation accuracy : 0.917772 max acc epoch : 21 test accuracy : 0.839352
Counter({0: 7378, 2: 6819, 1: 4649})

Epoch :  24 loss training:  16.685114139225334 Time :  15290
accuracy train: 0.997840 val: 0.919540 test: 0.842671
max validation accuracy : 0.919540 max acc epoch : 24 test accuracy : 0.842671
Counter({2: 7349, 1: 6860, 0: 4637})

Epoch :  25 loss training:  15.79184163082391 Time :  15424
accuracy train: 0.998232 val: 0.911583 test: 0.841476
max validation accuracy : 0.919540 max acc epoch : 24 test accuracy : 0.842671
Counter({2: 7346, 1: 6871, 0: 4629})

Epoch :  26 loss training:  14.498657842632383 Time :  15558
accuracy train: 0.998429 val: 0.918656 test: 0.842273
max validation accuracy : 0.919540 max acc epoch : 24 test accuracy : 0.842671
Counter({1: 7326, 0: 6896, 2: 4624})

Epoch :  27 loss training:  13.188307947246358 Time :  15693
accuracy train: 0.998625 val: 0.923961 test: 0.847849
max validation accuracy : 0.923961 max acc epoch : 27 test accuracy : 0.847849
Counter({2: 7311, 1: 6903, 0: 4632})

Epoch :  28 loss training:  11.225322229438461 Time :  15832
accuracy train: 0.998723 val: 0.918656 test: 0.844530
max validation accuracy : 0.923961 max acc epoch : 27 test accuracy : 0.847849
Counter({1: 7318, 2: 6919, 0: 4609})

Epoch :  29 loss training:  10.523455878486857 Time :  15962
accuracy train: 0.999116 val: 0.923961 test: 0.849708
max validation accuracy : 0.923961 max acc epoch : 27 test accuracy : 0.847849
Counter({0: 7310, 2: 6927, 1: 4609})

Epoch :  30 loss training:  8.780600846745074 Time :  16108
accuracy train: 0.998822 val: 0.922193 test: 0.842671
max validation accuracy : 0.923961 max acc epoch : 27 test accuracy : 0.847849
Counter({0: 7285, 1: 6952, 2: 4609})

Epoch :  31 loss training:  8.674346378888004 Time :  16235
accuracy train: 0.999018 val: 0.928382 test: 0.849044
max validation accuracy : 0.928382 max acc epoch : 31 test accuracy : 0.849044
Counter({0: 7218, 2: 7021, 1: 4607})

Epoch :  32 loss training:  8.383584945695475 Time :  16373
accuracy train: 0.998625 val: 0.926614 test: 0.848646
max validation accuracy : 0.928382 max acc epoch : 31 test accuracy : 0.849044
Counter({1: 7205, 0: 7042, 2: 4599})

Epoch :  33 loss training:  7.4111925647594035 Time :  16512
accuracy train: 0.999116 val: 0.926614 test: 0.848779
max validation accuracy : 0.928382 max acc epoch : 31 test accuracy : 0.849044
Counter({0: 7208, 2: 7042, 1: 4596})

Epoch :  34 loss training:  6.568558127095457 Time :  16646
accuracy train: 0.999411 val: 0.926614 test: 0.850770
max validation accuracy : 0.928382 max acc epoch : 31 test accuracy : 0.849044
Counter({0: 7207, 2: 7051, 1: 4588})

Epoch :  35 loss training:  6.105542365985457 Time :  16782
accuracy train: 0.999411 val: 0.928382 test: 0.847053
max validation accuracy : 0.928382 max acc epoch : 31 test accuracy : 0.849044
Counter({1: 7211, 0: 7066, 2: 4569})

Epoch :  36 loss training:  5.52878265286563 Time :  16917
accuracy train: 0.999116 val: 0.929266 test: 0.849708
max validation accuracy : 0.929266 max acc epoch : 36 test accuracy : 0.849708
Counter({1: 7225, 2: 7076, 0: 4545})

Epoch :  37 loss training:  5.729746192053426 Time :  17058
accuracy train: 0.999214 val: 0.930150 test: 0.851965
max validation accuracy : 0.930150 max acc epoch : 37 test accuracy : 0.851965
Counter({2: 7237, 0: 7081, 1: 4528})

Epoch :  38 loss training:  6.17853187333094 Time :  17197
accuracy train: 0.999214 val: 0.928382 test: 0.850903
max validation accuracy : 0.930150 max acc epoch : 37 test accuracy : 0.851965
Counter({1: 7240, 2: 7085, 0: 4521})

Epoch :  39 loss training:  4.613703188340878 Time :  17330
accuracy train: 0.999313 val: 0.934571 test: 0.854620
max validation accuracy : 0.934571 max acc epoch : 39 test accuracy : 0.854620
Counter({1: 7243, 2: 7087, 0: 4516})

Epoch :  40 loss training:  4.884634559974074 Time :  17454
accuracy train: 0.999313 val: 0.929266 test: 0.851699
max validation accuracy : 0.934571 max acc epoch : 39 test accuracy : 0.854620
Counter({0: 7266, 2: 7075, 1: 4505})

Epoch :  41 loss training:  4.805830765282735 Time :  17564
accuracy train: 0.999411 val: 0.930150 test: 0.849973
max validation accuracy : 0.934571 max acc epoch : 39 test accuracy : 0.854620
Counter({2: 7270, 1: 7094, 0: 4482})

Epoch :  42 loss training:  4.217166585789528 Time :  17675
accuracy train: 0.999509 val: 0.929266 test: 0.851036
max validation accuracy : 0.934571 max acc epoch : 39 test accuracy : 0.854620
Counter({0: 7268, 1: 7101, 2: 4477})

Epoch :  43 loss training:  3.6705977473247913 Time :  17786
accuracy train: 0.999313 val: 0.931034 test: 0.852629
max validation accuracy : 0.934571 max acc epoch : 39 test accuracy : 0.854620
Counter({1: 7267, 0: 7099, 2: 4480})

Epoch :  44 loss training:  3.5299618908320554 Time :  17897
accuracy train: 0.999509 val: 0.927498 test: 0.851832
max validation accuracy : 0.934571 max acc epoch : 39 test accuracy : 0.854620
Counter({0: 7271, 1: 7111, 2: 4464})

Epoch :  45 loss training:  2.951504460113938 Time :  18007
accuracy train: 0.999411 val: 0.928382 test: 0.849841
max validation accuracy : 0.934571 max acc epoch : 39 test accuracy : 0.854620
Counter({0: 7265, 1: 7117, 2: 4464})

Epoch :  46 loss training:  2.9525137291202554 Time :  18131
accuracy train: 0.999411 val: 0.938992 test: 0.851832
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({2: 7263, 0: 7119, 1: 4464})

Epoch :  47 loss training:  2.595330810188898 Time :  18240
accuracy train: 0.999313 val: 0.936340 test: 0.853027
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({2: 7256, 1: 7133, 0: 4457})

Epoch :  48 loss training:  3.3547820952371694 Time :  18354
accuracy train: 0.999411 val: 0.938108 test: 0.855417
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({1: 7299, 2: 7140, 0: 4407})

Epoch :  49 loss training:  2.7015534990059678 Time :  18464
accuracy train: 0.999214 val: 0.933687 test: 0.855550
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({0: 7301, 2: 7141, 1: 4404})

Epoch :  50 loss training:  2.8731566284041037 Time :  18578
accuracy train: 0.999411 val: 0.938108 test: 0.851434
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({2: 7309, 1: 7144, 0: 4393})

Epoch :  51 loss training:  2.527335688675521 Time :  18686
accuracy train: 0.999313 val: 0.934571 test: 0.853558
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({1: 7306, 0: 7146, 2: 4394})

Epoch :  52 loss training:  2.938456058211159 Time :  18795
accuracy train: 0.999411 val: 0.931919 test: 0.854488
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({0: 7312, 1: 7143, 2: 4391})

Epoch :  53 loss training:  2.0391305058001308 Time :  18904
accuracy train: 0.999411 val: 0.931919 test: 0.853824
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({0: 7305, 1: 7155, 2: 4386})

Epoch :  54 loss training:  1.9246568348899018 Time :  19019
accuracy train: 0.999411 val: 0.937224 test: 0.856213
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({0: 7300, 1: 7158, 2: 4388})

Epoch :  55 loss training:  2.2619850356059032 Time :  19131
accuracy train: 0.999313 val: 0.932803 test: 0.855815
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({0: 7301, 1: 7158, 2: 4387})

Epoch :  56 loss training:  2.18210218904278 Time :  19244
accuracy train: 0.999411 val: 0.932803 test: 0.853956
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({1: 7295, 0: 7160, 2: 4391})

Epoch :  57 loss training:  3.1753465714064077 Time :  19345
accuracy train: 0.999313 val: 0.933687 test: 0.853027
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({1: 7292, 0: 7162, 2: 4392})

Epoch :  58 loss training:  2.2040101439197315 Time :  19437
accuracy train: 0.999313 val: 0.937224 test: 0.858869
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({2: 7271, 1: 7185, 0: 4390})

Epoch :  59 loss training:  1.9106593514006818 Time :  19531
accuracy train: 0.999214 val: 0.938108 test: 0.860462
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({2: 7264, 1: 7195, 0: 4387})

Epoch :  60 loss training:  2.4672933848378307 Time :  19627
accuracy train: 0.999411 val: 0.935455 test: 0.859400
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({0: 7262, 1: 7204, 2: 4380})

Epoch :  61 loss training:  2.158314172153041 Time :  19723
accuracy train: 0.999411 val: 0.935455 test: 0.861391
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({1: 7268, 0: 7203, 2: 4375})

Epoch :  62 loss training:  2.0750158861628734 Time :  19817
accuracy train: 0.999509 val: 0.936340 test: 0.858072
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({2: 7267, 0: 7206, 1: 4373})

Epoch :  63 loss training:  2.153334369766526 Time :  19911
accuracy train: 0.999411 val: 0.933687 test: 0.856081
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({0: 7261, 1: 7218, 2: 4367})

Epoch :  64 loss training:  2.4341034496883367 Time :  20002
accuracy train: 0.999509 val: 0.931919 test: 0.853558
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({0: 7238, 2: 7234, 1: 4374})

Epoch :  65 loss training:  1.8661978086438467 Time :  20092
accuracy train: 0.999411 val: 0.934571 test: 0.852762
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({2: 7237, 1: 7236, 0: 4373})

Epoch :  66 loss training:  1.441220944710949 Time :  20185
accuracy train: 0.999313 val: 0.937224 test: 0.852894
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({1: 7243, 0: 7234, 2: 4369})

Epoch :  67 loss training:  1.0718805137075833 Time :  20279
accuracy train: 0.999509 val: 0.930150 test: 0.853956
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({2: 7241, 1: 7240, 0: 4365})

Epoch :  68 loss training:  1.5903965962861548 Time :  20372
accuracy train: 0.999313 val: 0.938108 test: 0.857010
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({0: 7247, 1: 7243, 2: 4356})

Epoch :  69 loss training:  1.4105218160366348 Time :  20466
accuracy train: 0.999411 val: 0.935455 test: 0.857276
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({2: 7253, 1: 7242, 0: 4351})

Epoch :  70 loss training:  1.5010518318304094 Time :  20560
accuracy train: 0.999313 val: 0.934571 test: 0.856081
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({2: 7263, 0: 7235, 1: 4348})

Epoch :  71 loss training:  1.7042858478089329 Time :  20655
accuracy train: 0.999411 val: 0.938108 test: 0.857807
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({0: 7271, 2: 7226, 1: 4349})

Epoch :  72 loss training:  1.659253830959642 Time :  20748
accuracy train: 0.999411 val: 0.933687 test: 0.854620
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({2: 7270, 1: 7217, 0: 4359})

Epoch :  73 loss training:  1.1878740336451301 Time :  20841
accuracy train: 0.999509 val: 0.933687 test: 0.859134
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({0: 7270, 2: 7220, 1: 4356})

Epoch :  74 loss training:  1.1130346029967768 Time :  20936
accuracy train: 0.999313 val: 0.936340 test: 0.860728
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({1: 7269, 2: 7221, 0: 4356})

Epoch :  75 loss training:  1.2430927170098585 Time :  21027
accuracy train: 0.999214 val: 0.931919 test: 0.849708
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({2: 7271, 0: 7221, 1: 4354})

Epoch :  76 loss training:  2.2800318292938755 Time :  21122
accuracy train: 0.999607 val: 0.933687 test: 0.860329
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({2: 7279, 0: 7211, 1: 4356})

Epoch :  77 loss training:  1.6060675327462377 Time :  21215
accuracy train: 0.999607 val: 0.933687 test: 0.850903
max validation accuracy : 0.938992 max acc epoch : 46 test accuracy : 0.851832
Counter({1: 7278, 2: 7213, 0: 4355})

========================================================================================================================================================================================================
max acc epoch :  46
max validation accuracy :  0.9389920424403183
test accuracy :  0.8518321826872013
last test_accuracy :  0.8509028146574615
max gap 7
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=221, weight_decay=1e-10)
device :  cuda:0
Counter({2: 7569, 1: 6376, 0: 4901})

Epoch :  1 loss training:  337.2730687260628 Time :  21320
accuracy train: 0.816753 val: 0.799293 test: 0.740839
max validation accuracy : 0.799293 max acc epoch : 1 test accuracy : 0.740839
Counter({1: 7198, 0: 6417, 2: 5231})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  206.67674532532692 Time :  21408
accuracy train: 0.861338 val: 0.828470 test: 0.773898
max validation accuracy : 0.828470 max acc epoch : 2 test accuracy : 0.773898
Counter({2: 7778, 1: 6327, 0: 4741})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  169.06866538524628 Time :  21497
accuracy train: 0.871060 val: 0.825818 test: 0.776686
max validation accuracy : 0.828470 max acc epoch : 2 test accuracy : 0.773898
Counter({0: 7547, 2: 6287, 1: 5012})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  133.26360723376274 Time :  21588
accuracy train: 0.903761 val: 0.851459 test: 0.796867
max validation accuracy : 0.851459 max acc epoch : 4 test accuracy : 0.796867
Counter({1: 7226, 2: 6225, 0: 5395})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  120.82567152380943 Time :  21676
accuracy train: 0.918099 val: 0.872679 test: 0.799920
max validation accuracy : 0.872679 max acc epoch : 5 test accuracy : 0.799920
Counter({1: 7166, 2: 6280, 0: 5400})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  115.52379758656025 Time :  21763
accuracy train: 0.922911 val: 0.867374 test: 0.800451
max validation accuracy : 0.872679 max acc epoch : 5 test accuracy : 0.799920
Counter({0: 7078, 1: 6334, 2: 5434})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  96.68882144615054 Time :  21850
accuracy train: 0.937248 val: 0.869142 test: 0.808550
max validation accuracy : 0.872679 max acc epoch : 5 test accuracy : 0.799920
Counter({2: 7064, 0: 6344, 1: 5438})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  92.52446762472391 Time :  21938
accuracy train: 0.934891 val: 0.870911 test: 0.809214
max validation accuracy : 0.872679 max acc epoch : 5 test accuracy : 0.799920
Counter({1: 7033, 0: 6335, 2: 5478})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  87.41466749086976 Time :  22025
accuracy train: 0.947167 val: 0.876216 test: 0.815056
max validation accuracy : 0.876216 max acc epoch : 9 test accuracy : 0.815056
Counter({1: 7022, 2: 6314, 0: 5510})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  78.10919072851539 Time :  22111
accuracy train: 0.951684 val: 0.881521 test: 0.815587
max validation accuracy : 0.881521 max acc epoch : 10 test accuracy : 0.815587
Counter({2: 6993, 0: 6335, 1: 5518})

Epoch :  11 loss training:  77.44889457523823 Time :  22205
accuracy train: 0.958853 val: 0.883289 test: 0.818375
max validation accuracy : 0.883289 max acc epoch : 11 test accuracy : 0.818375
Counter({1: 6983, 0: 6339, 2: 5524})

Epoch :  12 loss training:  68.8555251955986 Time :  22302
accuracy train: 0.964451 val: 0.892131 test: 0.821296
max validation accuracy : 0.892131 max acc epoch : 12 test accuracy : 0.821296
Counter({1: 6957, 0: 6346, 2: 5543})

Epoch :  13 loss training:  60.272997692227364 Time :  22399
accuracy train: 0.969361 val: 0.893899 test: 0.822756
max validation accuracy : 0.893899 max acc epoch : 13 test accuracy : 0.822756
Counter({0: 6946, 1: 6343, 2: 5557})

Epoch :  14 loss training:  54.85961980745196 Time :  22494
accuracy train: 0.975646 val: 0.893899 test: 0.825279
max validation accuracy : 0.893899 max acc epoch : 13 test accuracy : 0.822756
Counter({0: 6910, 1: 6359, 2: 5577})

Epoch :  15 loss training:  49.30462707951665 Time :  22589
accuracy train: 0.982029 val: 0.900973 test: 0.828200
max validation accuracy : 0.900973 max acc epoch : 15 test accuracy : 0.828200
Counter({2: 6866, 1: 6395, 0: 5585})

Epoch :  16 loss training:  44.251522436738014 Time :  22685
accuracy train: 0.984189 val: 0.909814 test: 0.833112
max validation accuracy : 0.909814 max acc epoch : 16 test accuracy : 0.833112
Counter({2: 6722, 0: 6516, 1: 5608})

Epoch :  17 loss training:  39.79004844184965 Time :  22777
accuracy train: 0.986841 val: 0.907162 test: 0.830324
max validation accuracy : 0.909814 max acc epoch : 16 test accuracy : 0.833112
Counter({2: 6707, 0: 6548, 1: 5591})

Epoch :  18 loss training:  33.997702511027455 Time :  22874
accuracy train: 0.988117 val: 0.905393 test: 0.831784
max validation accuracy : 0.909814 max acc epoch : 16 test accuracy : 0.833112
Counter({1: 6694, 2: 6553, 0: 5599})

Epoch :  19 loss training:  31.383399561047554 Time :  22968
accuracy train: 0.991751 val: 0.913351 test: 0.838688
max validation accuracy : 0.913351 max acc epoch : 19 test accuracy : 0.838688
Counter({1: 6662, 2: 6581, 0: 5603})

Epoch :  20 loss training:  27.79464623145759 Time :  23064
accuracy train: 0.993028 val: 0.914235 test: 0.836298
max validation accuracy : 0.914235 max acc epoch : 20 test accuracy : 0.836298
Counter({2: 6649, 1: 6593, 0: 5604})

Epoch :  21 loss training:  26.699520877096802 Time :  23160
accuracy train: 0.993715 val: 0.919540 test: 0.834705
max validation accuracy : 0.919540 max acc epoch : 21 test accuracy : 0.834705
Counter({1: 6633, 0: 6596, 2: 5617})

Epoch :  22 loss training:  22.07680679578334 Time :  23251
accuracy train: 0.995777 val: 0.915119 test: 0.836564
max validation accuracy : 0.919540 max acc epoch : 21 test accuracy : 0.834705
Counter({0: 6617, 1: 6606, 2: 5623})

Epoch :  23 loss training:  19.65720860566944 Time :  23345
accuracy train: 0.996661 val: 0.916888 test: 0.843468
max validation accuracy : 0.919540 max acc epoch : 21 test accuracy : 0.834705
Counter({0: 6619, 1: 6606, 2: 5621})

Epoch :  24 loss training:  17.18211606144905 Time :  23440
accuracy train: 0.997545 val: 0.918656 test: 0.841875
max validation accuracy : 0.919540 max acc epoch : 21 test accuracy : 0.834705
Counter({2: 6620, 0: 6584, 1: 5642})

Epoch :  25 loss training:  16.473252889700234 Time :  23535
accuracy train: 0.997840 val: 0.920424 test: 0.844530
max validation accuracy : 0.920424 max acc epoch : 25 test accuracy : 0.844530
Counter({1: 6629, 0: 6570, 2: 5647})

Epoch :  26 loss training:  14.633351801894605 Time :  23627
accuracy train: 0.998232 val: 0.925729 test: 0.843999
max validation accuracy : 0.925729 max acc epoch : 26 test accuracy : 0.843999
Counter({2: 6627, 0: 6546, 1: 5673})

Epoch :  27 loss training:  12.12759265571367 Time :  23722
accuracy train: 0.998625 val: 0.922193 test: 0.846522
max validation accuracy : 0.925729 max acc epoch : 26 test accuracy : 0.843999
Counter({0: 6648, 2: 6461, 1: 5737})

Epoch :  28 loss training:  10.053431904991157 Time :  23818
accuracy train: 0.999018 val: 0.923961 test: 0.845990
max validation accuracy : 0.925729 max acc epoch : 26 test accuracy : 0.843999
Counter({0: 6658, 1: 6438, 2: 5750})

Epoch :  29 loss training:  11.192588040605187 Time :  23913
accuracy train: 0.998920 val: 0.923077 test: 0.843733
max validation accuracy : 0.925729 max acc epoch : 26 test accuracy : 0.843999
Counter({0: 6653, 1: 6436, 2: 5757})

Epoch :  30 loss training:  9.803126703482121 Time :  24007
accuracy train: 0.999018 val: 0.921309 test: 0.844928
max validation accuracy : 0.925729 max acc epoch : 26 test accuracy : 0.843999
Counter({0: 6652, 1: 6410, 2: 5784})

Epoch :  31 loss training:  7.7028449072968215 Time :  24102
accuracy train: 0.999018 val: 0.925729 test: 0.846787
max validation accuracy : 0.925729 max acc epoch : 26 test accuracy : 0.843999
Counter({0: 6690, 2: 6387, 1: 5769})

Epoch :  32 loss training:  7.767395971459337 Time :  24195
accuracy train: 0.998822 val: 0.925729 test: 0.845990
max validation accuracy : 0.925729 max acc epoch : 26 test accuracy : 0.843999
Counter({1: 6698, 2: 6378, 0: 5770})

Epoch :  33 loss training:  7.390701256052125 Time :  24289
accuracy train: 0.999018 val: 0.928382 test: 0.850372
max validation accuracy : 0.928382 max acc epoch : 33 test accuracy : 0.850372
Counter({2: 6694, 0: 6378, 1: 5774})

Epoch :  34 loss training:  6.1694181258790195 Time :  24382
accuracy train: 0.999116 val: 0.925729 test: 0.848911
max validation accuracy : 0.928382 max acc epoch : 33 test accuracy : 0.850372
Counter({1: 6709, 0: 6373, 2: 5764})

Epoch :  35 loss training:  6.513735655113123 Time :  24477
accuracy train: 0.999214 val: 0.923077 test: 0.847982
max validation accuracy : 0.928382 max acc epoch : 33 test accuracy : 0.850372
Counter({2: 6711, 0: 6383, 1: 5752})

Epoch :  36 loss training:  5.529565517557785 Time :  24571
accuracy train: 0.999116 val: 0.926614 test: 0.847584
max validation accuracy : 0.928382 max acc epoch : 33 test accuracy : 0.850372
Counter({2: 6715, 1: 6382, 0: 5749})

Epoch :  37 loss training:  5.1953322444460355 Time :  24667
accuracy train: 0.999116 val: 0.933687 test: 0.848911
max validation accuracy : 0.933687 max acc epoch : 37 test accuracy : 0.848911
Counter({1: 6722, 0: 6388, 2: 5736})

Epoch :  38 loss training:  5.451939368795138 Time :  24762
accuracy train: 0.999116 val: 0.925729 test: 0.848911
max validation accuracy : 0.933687 max acc epoch : 37 test accuracy : 0.848911
Counter({2: 6727, 0: 6406, 1: 5713})

Epoch :  39 loss training:  4.251943991344888 Time :  24858
accuracy train: 0.999313 val: 0.929266 test: 0.848513
max validation accuracy : 0.933687 max acc epoch : 37 test accuracy : 0.848911
Counter({2: 6728, 1: 6401, 0: 5717})

Epoch :  40 loss training:  5.002575311635155 Time :  24948
accuracy train: 0.999214 val: 0.926614 test: 0.850770
max validation accuracy : 0.933687 max acc epoch : 37 test accuracy : 0.848911
Counter({2: 6732, 0: 6398, 1: 5716})

Epoch :  41 loss training:  4.34838756872341 Time :  25046
accuracy train: 0.999214 val: 0.931919 test: 0.848779
max validation accuracy : 0.933687 max acc epoch : 37 test accuracy : 0.848911
Counter({0: 6743, 1: 6392, 2: 5711})

Epoch :  42 loss training:  4.062061018456006 Time :  25141
accuracy train: 0.999411 val: 0.929266 test: 0.849044
max validation accuracy : 0.933687 max acc epoch : 37 test accuracy : 0.848911
Counter({1: 6750, 2: 6385, 0: 5711})

Epoch :  43 loss training:  3.4118845252669416 Time :  25237
accuracy train: 0.999313 val: 0.933687 test: 0.850903
max validation accuracy : 0.933687 max acc epoch : 37 test accuracy : 0.848911
Counter({2: 6760, 1: 6369, 0: 5717})

Epoch :  44 loss training:  3.7327685614145594 Time :  25333
accuracy train: 0.999313 val: 0.935455 test: 0.857010
max validation accuracy : 0.935455 max acc epoch : 44 test accuracy : 0.857010
Counter({1: 6771, 2: 6361, 0: 5714})

Epoch :  45 loss training:  3.9234193884476554 Time :  25429
accuracy train: 0.999214 val: 0.931034 test: 0.853160
max validation accuracy : 0.935455 max acc epoch : 44 test accuracy : 0.857010
Counter({2: 6786, 1: 6356, 0: 5704})

Epoch :  46 loss training:  3.3834759432356805 Time :  25527
accuracy train: 0.999214 val: 0.935455 test: 0.855948
max validation accuracy : 0.935455 max acc epoch : 44 test accuracy : 0.857010
Counter({1: 6799, 0: 6352, 2: 5695})

Epoch :  47 loss training:  3.4408896361419465 Time :  25620
accuracy train: 0.999411 val: 0.931034 test: 0.855284
max validation accuracy : 0.935455 max acc epoch : 44 test accuracy : 0.857010
Counter({2: 6806, 0: 6345, 1: 5695})

Epoch :  48 loss training:  2.9705933528748574 Time :  25711
accuracy train: 0.999313 val: 0.932803 test: 0.856346
max validation accuracy : 0.935455 max acc epoch : 44 test accuracy : 0.857010
Counter({2: 6828, 1: 6321, 0: 5697})

Epoch :  49 loss training:  2.955743159109261 Time :  25807
accuracy train: 0.999411 val: 0.937224 test: 0.851832
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.851832
Counter({2: 6829, 1: 6321, 0: 5696})

Epoch :  50 loss training:  2.8057270967401564 Time :  25900
accuracy train: 0.999214 val: 0.931919 test: 0.851832
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.851832
Counter({2: 6831, 1: 6321, 0: 5694})

Epoch :  51 loss training:  2.5529190674278652 Time :  25997
accuracy train: 0.999411 val: 0.932803 test: 0.853160
max validation accuracy : 0.937224 max acc epoch : 49 test accuracy : 0.851832
Counter({1: 6836, 2: 6320, 0: 5690})

Epoch :  52 loss training:  2.060666296441923 Time :  26090
accuracy train: 0.999411 val: 0.938108 test: 0.854488
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({1: 6841, 0: 6340, 2: 5665})

Epoch :  53 loss training:  2.569795912655536 Time :  26186
accuracy train: 0.999313 val: 0.931034 test: 0.850637
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({0: 6843, 1: 6343, 2: 5660})

Epoch :  54 loss training:  1.8325522740924498 Time :  26283
accuracy train: 0.999313 val: 0.934571 test: 0.854620
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({1: 6836, 2: 6350, 0: 5660})

Epoch :  55 loss training:  2.3730522147670854 Time :  26379
accuracy train: 0.999313 val: 0.933687 test: 0.852230
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({2: 6834, 0: 6355, 1: 5657})

Epoch :  56 loss training:  2.1304250378889265 Time :  26472
accuracy train: 0.999411 val: 0.934571 test: 0.852629
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({1: 6844, 0: 6353, 2: 5649})

Epoch :  57 loss training:  2.02158055759719 Time :  26569
accuracy train: 0.999313 val: 0.933687 test: 0.851965
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({0: 6849, 1: 6356, 2: 5641})

Epoch :  58 loss training:  2.1409956189054355 Time :  26663
accuracy train: 0.999313 val: 0.932803 test: 0.853691
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({1: 6850, 0: 6359, 2: 5637})

Epoch :  59 loss training:  1.7063966044661356 Time :  26756
accuracy train: 0.999411 val: 0.931919 test: 0.854089
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({0: 6851, 1: 6398, 2: 5597})

Epoch :  60 loss training:  1.8124297821777873 Time :  26849
accuracy train: 0.999411 val: 0.932803 test: 0.855151
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({2: 6854, 1: 6444, 0: 5548})

Epoch :  61 loss training:  1.6284688055529841 Time :  26941
accuracy train: 0.999214 val: 0.930150 test: 0.853425
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({2: 6854, 1: 6446, 0: 5546})

Epoch :  62 loss training:  1.335420200950466 Time :  27035
accuracy train: 0.999411 val: 0.936340 test: 0.857276
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({0: 6858, 1: 6448, 2: 5540})

Epoch :  63 loss training:  2.2041233972886403 Time :  27139
accuracy train: 0.999509 val: 0.931919 test: 0.849177
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({0: 6863, 2: 6452, 1: 5531})

Epoch :  64 loss training:  2.5043435521947686 Time :  27236
accuracy train: 0.999411 val: 0.935455 test: 0.850239
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({1: 6863, 0: 6450, 2: 5533})

Epoch :  65 loss training:  2.0235071891474945 Time :  27331
accuracy train: 0.999411 val: 0.935455 test: 0.853425
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({1: 6865, 0: 6443, 2: 5538})

Epoch :  66 loss training:  2.182588649538957 Time :  27425
accuracy train: 0.999509 val: 0.934571 test: 0.847849
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({2: 6865, 0: 6443, 1: 5538})

Epoch :  67 loss training:  1.3437682832918654 Time :  27519
accuracy train: 0.999607 val: 0.938108 test: 0.853558
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({0: 6869, 1: 6443, 2: 5534})

Epoch :  68 loss training:  1.6265164912219916 Time :  27614
accuracy train: 0.999411 val: 0.934571 test: 0.857010
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({2: 6870, 1: 6447, 0: 5529})

Epoch :  69 loss training:  1.297348086925922 Time :  27710
accuracy train: 0.999313 val: 0.935455 test: 0.852762
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({1: 6872, 0: 6443, 2: 5531})

Epoch :  70 loss training:  1.8525899889755237 Time :  27806
accuracy train: 0.999411 val: 0.931919 test: 0.855815
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({1: 6887, 0: 6443, 2: 5516})

Epoch :  71 loss training:  0.9486768442657194 Time :  27901
accuracy train: 0.999411 val: 0.934571 test: 0.857143
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({1: 6889, 2: 6456, 0: 5501})

Epoch :  72 loss training:  1.531202319318254 Time :  27999
accuracy train: 0.999509 val: 0.931034 test: 0.859134
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({0: 6886, 1: 6460, 2: 5500})

Epoch :  73 loss training:  1.5111955581123766 Time :  28092
accuracy train: 0.999509 val: 0.938108 test: 0.853425
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({1: 6881, 2: 6476, 0: 5489})

Epoch :  74 loss training:  1.2484430333115597 Time :  28191
accuracy train: 0.999705 val: 0.938108 test: 0.859267
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({0: 6888, 2: 6478, 1: 5480})

Epoch :  75 loss training:  1.1582399620419892 Time :  28284
accuracy train: 0.999313 val: 0.934571 test: 0.851832
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({0: 6895, 2: 6480, 1: 5471})

Epoch :  76 loss training:  1.4220283568101877 Time :  28378
accuracy train: 0.999313 val: 0.935455 test: 0.855284
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({1: 6894, 2: 6490, 0: 5462})

Epoch :  77 loss training:  1.3641674789832905 Time :  28473
accuracy train: 0.999411 val: 0.932803 test: 0.849708
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({0: 6895, 1: 6499, 2: 5452})

Epoch :  78 loss training:  1.9184473559944308 Time :  28565
accuracy train: 0.999411 val: 0.932803 test: 0.858072
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({2: 6898, 1: 6515, 0: 5433})

Epoch :  79 loss training:  0.9562978363592265 Time :  28658
accuracy train: 0.999607 val: 0.934571 test: 0.857939
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({1: 6897, 2: 6514, 0: 5435})

Epoch :  80 loss training:  1.5285156214322342 Time :  28751
accuracy train: 0.999705 val: 0.931034 test: 0.857276
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({0: 6899, 1: 6520, 2: 5427})

Epoch :  81 loss training:  0.9430778840160201 Time :  28847
accuracy train: 0.999509 val: 0.934571 test: 0.855948
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({2: 6901, 0: 6529, 1: 5416})

Epoch :  82 loss training:  1.5820485942313098 Time :  28941
accuracy train: 0.999313 val: 0.938108 test: 0.857674
max validation accuracy : 0.938108 max acc epoch : 52 test accuracy : 0.854488
Counter({1: 6906, 0: 6548, 2: 5392})

Epoch :  83 loss training:  1.079921730704882 Time :  29036
accuracy train: 0.999509 val: 0.940760 test: 0.858205
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({2: 6913, 0: 6569, 1: 5364})

Epoch :  84 loss training:  1.3350689379531104 Time :  29131
accuracy train: 0.999509 val: 0.937224 test: 0.857807
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({2: 6924, 0: 6573, 1: 5349})

Epoch :  85 loss training:  1.6133998337545563 Time :  29225
accuracy train: 0.999509 val: 0.937224 test: 0.859798
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({2: 6926, 0: 6579, 1: 5341})

Epoch :  86 loss training:  1.046901771283956 Time :  29320
accuracy train: 0.999509 val: 0.937224 test: 0.859798
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({0: 6927, 2: 6588, 1: 5331})

Epoch :  87 loss training:  1.0024057766804617 Time :  29415
accuracy train: 0.999411 val: 0.938108 test: 0.856479
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({1: 6929, 2: 6621, 0: 5296})

Epoch :  88 loss training:  0.9151581822388835 Time :  29507
accuracy train: 0.999607 val: 0.936340 test: 0.860993
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({0: 6936, 2: 6673, 1: 5237})

Epoch :  89 loss training:  1.1515627639337254 Time :  29601
accuracy train: 0.999509 val: 0.935455 test: 0.856213
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({2: 6934, 1: 6677, 0: 5235})

Epoch :  90 loss training:  0.8849500568403528 Time :  29694
accuracy train: 0.999509 val: 0.934571 test: 0.860860
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({0: 6936, 1: 6673, 2: 5237})

Epoch :  91 loss training:  0.791175261852004 Time :  29805
accuracy train: 0.999509 val: 0.938108 test: 0.860728
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({1: 6937, 2: 6679, 0: 5230})

Epoch :  92 loss training:  0.7393539603945101 Time :  30040
accuracy train: 0.999509 val: 0.939876 test: 0.859134
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({0: 6936, 2: 6679, 1: 5231})

Epoch :  93 loss training:  1.2157896928438277 Time :  30251
accuracy train: 0.999411 val: 0.936340 test: 0.853956
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({2: 6936, 0: 6681, 1: 5229})

Epoch :  94 loss training:  0.6251291241433137 Time :  30483
accuracy train: 0.999509 val: 0.935455 test: 0.856346
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({1: 6937, 2: 6684, 0: 5225})

Epoch :  95 loss training:  0.9895201149884087 Time :  30684
accuracy train: 0.999607 val: 0.937224 test: 0.856346
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({0: 6940, 1: 6693, 2: 5213})

Epoch :  96 loss training:  1.0530716775933797 Time :  30926
accuracy train: 0.999607 val: 0.933687 test: 0.853293
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({0: 6947, 1: 6688, 2: 5211})

Epoch :  97 loss training:  1.0772023036734026 Time :  31176
accuracy train: 0.999509 val: 0.934571 test: 0.857143
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({1: 6945, 0: 6696, 2: 5205})

Epoch :  98 loss training:  0.7157434513555927 Time :  31436
accuracy train: 0.999509 val: 0.934571 test: 0.858338
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({1: 6949, 0: 6689, 2: 5208})

Epoch :  99 loss training:  1.2976872478493533 Time :  31656
accuracy train: 0.999509 val: 0.931034 test: 0.852363
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({1: 6964, 0: 6702, 2: 5180})

Epoch :  100 loss training:  1.0172184880339046 Time :  31906
accuracy train: 0.999509 val: 0.931034 test: 0.847982
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({1: 6966, 2: 6697, 0: 5183})

Epoch :  101 loss training:  0.7673622301563228 Time :  32126
accuracy train: 0.999607 val: 0.934571 test: 0.855550
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({0: 6969, 2: 6691, 1: 5186})

Epoch :  102 loss training:  0.8282832649183547 Time :  32363
accuracy train: 0.999607 val: 0.939876 test: 0.859665
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({0: 6972, 1: 6689, 2: 5185})

Epoch :  103 loss training:  0.6065071221328253 Time :  32590
accuracy train: 0.999607 val: 0.936340 test: 0.860329
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({0: 6978, 1: 6691, 2: 5177})

Epoch :  104 loss training:  0.6332593883698792 Time :  32825
accuracy train: 0.999607 val: 0.937224 test: 0.859798
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({1: 6978, 0: 6691, 2: 5177})

Epoch :  105 loss training:  0.8934218779804723 Time :  33099
accuracy train: 0.999509 val: 0.936340 test: 0.853160
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({2: 6980, 1: 6688, 0: 5178})

Epoch :  106 loss training:  0.9024127407938067 Time :  33357
accuracy train: 0.999509 val: 0.938108 test: 0.855417
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({1: 6978, 0: 6703, 2: 5165})

Epoch :  107 loss training:  0.7561617874343938 Time :  33592
accuracy train: 0.999411 val: 0.933687 test: 0.857276
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({2: 6972, 1: 6706, 0: 5168})

Epoch :  108 loss training:  1.2443485245821648 Time :  33827
accuracy train: 0.999411 val: 0.932803 test: 0.854355
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({1: 6956, 2: 6710, 0: 5180})

Epoch :  109 loss training:  0.7514424861856241 Time :  34053
accuracy train: 0.999607 val: 0.938108 test: 0.860993
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({1: 6946, 2: 6717, 0: 5183})

Epoch :  110 loss training:  0.9096741023568029 Time :  34283
accuracy train: 0.999509 val: 0.940760 test: 0.857939
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({2: 6947, 1: 6739, 0: 5160})

Epoch :  111 loss training:  0.9840891763715263 Time :  34530
accuracy train: 0.999705 val: 0.938108 test: 0.856479
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({2: 6952, 1: 6739, 0: 5155})

Epoch :  112 loss training:  0.5915540120577134 Time :  34772
accuracy train: 0.999607 val: 0.938108 test: 0.857276
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({2: 6952, 0: 6748, 1: 5146})

Epoch :  113 loss training:  0.8239938643728237 Time :  34987
accuracy train: 0.999411 val: 0.938992 test: 0.855417
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({1: 6947, 2: 6751, 0: 5148})

Epoch :  114 loss training:  0.8889909875179001 Time :  35081
accuracy train: 0.999607 val: 0.937224 test: 0.857408
max validation accuracy : 0.940760 max acc epoch : 83 test accuracy : 0.858205
Counter({2: 6951, 0: 6757, 1: 5138})

========================================================================================================================================================================================================
max acc epoch :  83
max validation accuracy :  0.9407603890362511
test accuracy :  0.8582049920339884
last test_accuracy :  0.8574083908656399
max gap 31
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=221, weight_decay=1e-10)
device :  cuda:0
Counter({2: 7569, 1: 6376, 0: 4901})

Epoch :  1 loss training:  337.4637729525566 Time :  35184
accuracy train: 0.820485 val: 0.797524 test: 0.745353
max validation accuracy : 0.797524 max acc epoch : 1 test accuracy : 0.745353
Counter({1: 7067, 0: 6172, 2: 5607})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  204.36823624372482 Time :  35268
accuracy train: 0.854365 val: 0.816092 test: 0.764604
max validation accuracy : 0.816092 max acc epoch : 2 test accuracy : 0.764604
Counter({2: 6645, 0: 6415, 1: 5786})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  173.123631618917 Time :  35355
accuracy train: 0.864185 val: 0.816976 test: 0.765003
max validation accuracy : 0.816976 max acc epoch : 3 test accuracy : 0.765003
Counter({0: 6546, 2: 6544, 1: 5756})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  133.60560213774443 Time :  35442
accuracy train: 0.903270 val: 0.861185 test: 0.793813
max validation accuracy : 0.861185 max acc epoch : 4 test accuracy : 0.793813
Counter({1: 6589, 0: 6539, 2: 5718})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  120.33617897331715 Time :  35528
accuracy train: 0.917902 val: 0.872679 test: 0.805098
max validation accuracy : 0.872679 max acc epoch : 5 test accuracy : 0.805098
Counter({2: 6600, 1: 6568, 0: 5678})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  114.40259052067995 Time :  35614
accuracy train: 0.924580 val: 0.869142 test: 0.803638
max validation accuracy : 0.872679 max acc epoch : 5 test accuracy : 0.805098
Counter({2: 6622, 1: 6518, 0: 5706})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  93.80926314741373 Time :  35700
accuracy train: 0.936070 val: 0.877100 test: 0.808683
max validation accuracy : 0.877100 max acc epoch : 7 test accuracy : 0.808683
Counter({1: 6617, 0: 6535, 2: 5694})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  92.57549193501472 Time :  35786
accuracy train: 0.934204 val: 0.868258 test: 0.803903
max validation accuracy : 0.877100 max acc epoch : 7 test accuracy : 0.808683
Counter({0: 6599, 2: 6553, 1: 5694})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  84.7139782756567 Time :  35871
accuracy train: 0.950997 val: 0.871795 test: 0.814259
max validation accuracy : 0.877100 max acc epoch : 7 test accuracy : 0.808683
Counter({2: 6595, 1: 6583, 0: 5668})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  79.11011329293251 Time :  35957
accuracy train: 0.952764 val: 0.878868 test: 0.812400
max validation accuracy : 0.878868 max acc epoch : 10 test accuracy : 0.812400
Counter({2: 6599, 0: 6587, 1: 5660})

Epoch :  11 loss training:  73.31899630278349 Time :  36053
accuracy train: 0.961013 val: 0.885057 test: 0.818109
max validation accuracy : 0.885057 max acc epoch : 11 test accuracy : 0.818109
Counter({1: 6597, 2: 6592, 0: 5657})

Epoch :  12 loss training:  68.05297696962953 Time :  36145
accuracy train: 0.966709 val: 0.892131 test: 0.821429
max validation accuracy : 0.892131 max acc epoch : 12 test accuracy : 0.821429
Counter({1: 6622, 2: 6563, 0: 5661})

Epoch :  13 loss training:  58.172266179695725 Time :  36244
accuracy train: 0.971816 val: 0.887710 test: 0.820366
max validation accuracy : 0.892131 max acc epoch : 12 test accuracy : 0.821429
Counter({1: 6652, 0: 6523, 2: 5671})

Epoch :  14 loss training:  54.63109324872494 Time :  36338
accuracy train: 0.976726 val: 0.895668 test: 0.825412
max validation accuracy : 0.895668 max acc epoch : 14 test accuracy : 0.825412
Counter({2: 6665, 0: 6503, 1: 5678})

Epoch :  15 loss training:  48.34649021551013 Time :  36432
accuracy train: 0.982029 val: 0.908046 test: 0.827536
max validation accuracy : 0.908046 max acc epoch : 15 test accuracy : 0.827536
Counter({1: 6681, 2: 6494, 0: 5671})

Epoch :  16 loss training:  42.52309506572783 Time :  36526
accuracy train: 0.983698 val: 0.906278 test: 0.830191
max validation accuracy : 0.908046 max acc epoch : 15 test accuracy : 0.827536
Counter({1: 6679, 0: 6494, 2: 5673})

Epoch :  17 loss training:  37.18814535345882 Time :  36619
accuracy train: 0.984975 val: 0.908930 test: 0.830324
max validation accuracy : 0.908930 max acc epoch : 17 test accuracy : 0.830324
Counter({1: 6707, 0: 6486, 2: 5653})

Epoch :  18 loss training:  34.3711497168988 Time :  36714
accuracy train: 0.990082 val: 0.908046 test: 0.835635
max validation accuracy : 0.908930 max acc epoch : 17 test accuracy : 0.830324
Counter({1: 6749, 2: 6456, 0: 5641})

Epoch :  19 loss training:  29.597716450691223 Time :  36811
accuracy train: 0.992242 val: 0.911583 test: 0.834572
max validation accuracy : 0.911583 max acc epoch : 19 test accuracy : 0.834572
Counter({2: 6753, 1: 6460, 0: 5633})

Epoch :  20 loss training:  26.482494079507887 Time :  36905
accuracy train: 0.993519 val: 0.913351 test: 0.835767
max validation accuracy : 0.913351 max acc epoch : 20 test accuracy : 0.835767
Counter({2: 6757, 1: 6438, 0: 5651})

Epoch :  21 loss training:  25.068295433651656 Time :  37003
accuracy train: 0.994992 val: 0.910698 test: 0.836298
max validation accuracy : 0.913351 max acc epoch : 20 test accuracy : 0.835767
Counter({0: 6753, 1: 6438, 2: 5655})

Epoch :  22 loss training:  23.38641474209726 Time :  37097
accuracy train: 0.995483 val: 0.909814 test: 0.841211
max validation accuracy : 0.913351 max acc epoch : 20 test accuracy : 0.835767
Counter({1: 6757, 2: 6441, 0: 5648})

Epoch :  23 loss training:  19.528528042137623 Time :  37194
accuracy train: 0.997741 val: 0.915119 test: 0.841875
max validation accuracy : 0.915119 max acc epoch : 23 test accuracy : 0.841875
Counter({1: 6758, 0: 6421, 2: 5667})

Epoch :  24 loss training:  17.261768265394494 Time :  37291
accuracy train: 0.998134 val: 0.917772 test: 0.845459
max validation accuracy : 0.917772 max acc epoch : 24 test accuracy : 0.845459
Counter({0: 6766, 1: 6400, 2: 5680})

Epoch :  25 loss training:  15.979158116970211 Time :  37391
accuracy train: 0.998723 val: 0.923077 test: 0.845327
max validation accuracy : 0.923077 max acc epoch : 25 test accuracy : 0.845327
Counter({0: 6774, 2: 6391, 1: 5681})

Epoch :  26 loss training:  14.930238015484065 Time :  37492
accuracy train: 0.999116 val: 0.923961 test: 0.842007
max validation accuracy : 0.923961 max acc epoch : 26 test accuracy : 0.842007
Counter({2: 6789, 0: 6377, 1: 5680})

Epoch :  27 loss training:  12.975707528181374 Time :  37603
accuracy train: 0.998822 val: 0.919540 test: 0.843866
max validation accuracy : 0.923961 max acc epoch : 26 test accuracy : 0.842007
Counter({0: 6780, 1: 6348, 2: 5718})

Epoch :  28 loss training:  11.243014830397442 Time :  37703
accuracy train: 0.998625 val: 0.923077 test: 0.842406
max validation accuracy : 0.923961 max acc epoch : 26 test accuracy : 0.842007
Counter({0: 6774, 1: 6331, 2: 5741})

Epoch :  29 loss training:  10.27159567992203 Time :  37803
accuracy train: 0.999214 val: 0.923077 test: 0.844796
max validation accuracy : 0.923961 max acc epoch : 26 test accuracy : 0.842007
Counter({0: 6787, 2: 6332, 1: 5727})

Epoch :  30 loss training:  10.205797471571714 Time :  37903
accuracy train: 0.999018 val: 0.920424 test: 0.844796
max validation accuracy : 0.923961 max acc epoch : 26 test accuracy : 0.842007
Counter({2: 6795, 0: 6323, 1: 5728})

Epoch :  31 loss training:  7.839388432097621 Time :  38002
accuracy train: 0.999018 val: 0.927498 test: 0.847982
max validation accuracy : 0.927498 max acc epoch : 31 test accuracy : 0.847982
Counter({0: 6809, 2: 6297, 1: 5740})

Epoch :  32 loss training:  7.883389658294618 Time :  38105
accuracy train: 0.999018 val: 0.928382 test: 0.851434
max validation accuracy : 0.928382 max acc epoch : 32 test accuracy : 0.851434
Counter({1: 6810, 2: 6301, 0: 5735})

Epoch :  33 loss training:  7.495093041448854 Time :  38203
accuracy train: 0.999116 val: 0.930150 test: 0.848513
max validation accuracy : 0.930150 max acc epoch : 33 test accuracy : 0.848513
Counter({2: 6811, 1: 6303, 0: 5732})

Epoch :  34 loss training:  7.0129346824251115 Time :  38304
accuracy train: 0.999116 val: 0.925729 test: 0.848779
max validation accuracy : 0.930150 max acc epoch : 33 test accuracy : 0.848513
Counter({1: 6806, 0: 6295, 2: 5745})

Epoch :  35 loss training:  6.734674525912851 Time :  38403
accuracy train: 0.999411 val: 0.931919 test: 0.847318
max validation accuracy : 0.931919 max acc epoch : 35 test accuracy : 0.847318
Counter({1: 6846, 0: 6303, 2: 5697})

Epoch :  36 loss training:  5.6185121745220385 Time :  38501
accuracy train: 0.999116 val: 0.936340 test: 0.848513
max validation accuracy : 0.936340 max acc epoch : 36 test accuracy : 0.848513
Counter({0: 6860, 1: 6288, 2: 5698})

Epoch :  37 loss training:  5.52355274814181 Time :  38603
accuracy train: 0.999411 val: 0.932803 test: 0.850239
max validation accuracy : 0.936340 max acc epoch : 36 test accuracy : 0.848513
Counter({1: 6862, 0: 6291, 2: 5693})

Epoch :  38 loss training:  4.879139941825997 Time :  38703
accuracy train: 0.999018 val: 0.935455 test: 0.851434
max validation accuracy : 0.936340 max acc epoch : 36 test accuracy : 0.848513
Counter({1: 6872, 0: 6289, 2: 5685})

Epoch :  39 loss training:  4.555663081642706 Time :  38802
accuracy train: 0.999313 val: 0.931034 test: 0.843202
max validation accuracy : 0.936340 max acc epoch : 36 test accuracy : 0.848513
Counter({2: 6875, 1: 6272, 0: 5699})

Epoch :  40 loss training:  4.578642939188285 Time :  38900
accuracy train: 0.999411 val: 0.931919 test: 0.847053
max validation accuracy : 0.936340 max acc epoch : 36 test accuracy : 0.848513
Counter({1: 6882, 0: 6266, 2: 5698})

Epoch :  41 loss training:  5.462001797452103 Time :  39002
accuracy train: 0.999214 val: 0.930150 test: 0.850239
max validation accuracy : 0.936340 max acc epoch : 36 test accuracy : 0.848513
Counter({0: 6892, 1: 6247, 2: 5707})

Epoch :  42 loss training:  4.089398976480879 Time :  39102
accuracy train: 0.999313 val: 0.934571 test: 0.850637
max validation accuracy : 0.936340 max acc epoch : 36 test accuracy : 0.848513
Counter({0: 6885, 2: 6243, 1: 5718})

Epoch :  43 loss training:  3.264338577137096 Time :  39201
accuracy train: 0.999411 val: 0.931034 test: 0.853160
max validation accuracy : 0.936340 max acc epoch : 36 test accuracy : 0.848513
Counter({1: 6907, 0: 6216, 2: 5723})

Epoch :  44 loss training:  3.2119945841259323 Time :  39295
accuracy train: 0.999214 val: 0.932803 test: 0.856479
max validation accuracy : 0.936340 max acc epoch : 36 test accuracy : 0.848513
Counter({1: 6898, 2: 6216, 0: 5732})

Epoch :  45 loss training:  3.3863445962197147 Time :  39432
accuracy train: 0.999411 val: 0.931919 test: 0.849177
max validation accuracy : 0.936340 max acc epoch : 36 test accuracy : 0.848513
Counter({1: 6901, 2: 6215, 0: 5730})

Epoch :  46 loss training:  3.5252020530897425 Time :  39593
accuracy train: 0.999313 val: 0.931919 test: 0.851965
max validation accuracy : 0.936340 max acc epoch : 36 test accuracy : 0.848513
Counter({0: 6894, 1: 6208, 2: 5744})

Epoch :  47 loss training:  2.9920251363218995 Time :  39695
accuracy train: 0.999313 val: 0.931919 test: 0.851168
max validation accuracy : 0.936340 max acc epoch : 36 test accuracy : 0.848513
Counter({2: 6894, 1: 6206, 0: 5746})

Epoch :  48 loss training:  3.0454760294160224 Time :  39793
accuracy train: 0.999116 val: 0.933687 test: 0.854355
max validation accuracy : 0.936340 max acc epoch : 36 test accuracy : 0.848513
Counter({2: 6897, 0: 6199, 1: 5750})

Epoch :  49 loss training:  2.484296666138107 Time :  39897
accuracy train: 0.999509 val: 0.936340 test: 0.852629
max validation accuracy : 0.936340 max acc epoch : 36 test accuracy : 0.848513
Counter({1: 6900, 2: 6195, 0: 5751})

Epoch :  50 loss training:  2.5677145880181342 Time :  40012
accuracy train: 0.999509 val: 0.936340 test: 0.854488
max validation accuracy : 0.936340 max acc epoch : 36 test accuracy : 0.848513
Counter({2: 6908, 0: 6198, 1: 5740})

Epoch :  51 loss training:  2.128852373061818 Time :  40137
accuracy train: 0.999509 val: 0.931919 test: 0.851965
max validation accuracy : 0.936340 max acc epoch : 36 test accuracy : 0.848513
Counter({2: 6910, 0: 6211, 1: 5725})

Epoch :  52 loss training:  2.2066092997119995 Time :  40255
accuracy train: 0.999313 val: 0.931919 test: 0.848646
max validation accuracy : 0.936340 max acc epoch : 36 test accuracy : 0.848513
Counter({1: 6923, 0: 6203, 2: 5720})

Epoch :  53 loss training:  2.284550506490632 Time :  40375
accuracy train: 0.999509 val: 0.937224 test: 0.850505
max validation accuracy : 0.937224 max acc epoch : 53 test accuracy : 0.850505
Counter({1: 6928, 0: 6212, 2: 5706})

Epoch :  54 loss training:  2.2149793370845146 Time :  40503
accuracy train: 0.999411 val: 0.938992 test: 0.853956
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({1: 6913, 2: 6223, 0: 5710})

Epoch :  55 loss training:  2.5565446445616544 Time :  40622
accuracy train: 0.999411 val: 0.932803 test: 0.848380
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({1: 6916, 0: 6249, 2: 5681})

Epoch :  56 loss training:  2.093581585344509 Time :  40740
accuracy train: 0.999411 val: 0.930150 test: 0.855019
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({2: 6918, 0: 6264, 1: 5664})

Epoch :  57 loss training:  2.184369816983235 Time :  40865
accuracy train: 0.999509 val: 0.934571 test: 0.852363
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({2: 6937, 0: 6263, 1: 5646})

Epoch :  58 loss training:  1.4000661619647872 Time :  40982
accuracy train: 0.999313 val: 0.927498 test: 0.854089
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({1: 6932, 0: 6268, 2: 5646})

Epoch :  59 loss training:  1.8796616226318292 Time :  41100
accuracy train: 0.999411 val: 0.934571 test: 0.855948
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({2: 6933, 1: 6288, 0: 5625})

Epoch :  60 loss training:  2.323218539087975 Time :  41213
accuracy train: 0.999313 val: 0.937224 test: 0.855417
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({2: 6947, 0: 6295, 1: 5604})

Epoch :  61 loss training:  2.1176684229794773 Time :  41332
accuracy train: 0.999411 val: 0.937224 test: 0.858603
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({2: 6957, 1: 6293, 0: 5596})

Epoch :  62 loss training:  1.7612309268188255 Time :  41451
accuracy train: 0.999509 val: 0.935455 test: 0.856612
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({0: 6962, 1: 6282, 2: 5602})

Epoch :  63 loss training:  1.4476851979197818 Time :  41574
accuracy train: 0.999509 val: 0.936340 test: 0.857541
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({1: 6963, 2: 6288, 0: 5595})

Epoch :  64 loss training:  1.5597013501901529 Time :  41670
accuracy train: 0.999214 val: 0.931919 test: 0.853160
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({0: 6957, 2: 6282, 1: 5607})

Epoch :  65 loss training:  2.266428198883659 Time :  41770
accuracy train: 0.999411 val: 0.934571 test: 0.852098
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({1: 6957, 2: 6280, 0: 5609})

Epoch :  66 loss training:  1.8743452724975214 Time :  41870
accuracy train: 0.999411 val: 0.930150 test: 0.851036
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({1: 6959, 2: 6320, 0: 5567})

Epoch :  67 loss training:  1.4125354803654773 Time :  41973
accuracy train: 0.999509 val: 0.937224 test: 0.856877
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({2: 6962, 1: 6332, 0: 5552})

Epoch :  68 loss training:  1.4552631121623563 Time :  42072
accuracy train: 0.999509 val: 0.938992 test: 0.857143
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({1: 6962, 2: 6338, 0: 5546})

Epoch :  69 loss training:  1.5638762199523626 Time :  42169
accuracy train: 0.999411 val: 0.931034 test: 0.850372
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({1: 6958, 2: 6353, 0: 5535})

Epoch :  70 loss training:  2.1001384430055623 Time :  42268
accuracy train: 0.999214 val: 0.932803 test: 0.854222
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({0: 6957, 1: 6348, 2: 5541})

Epoch :  71 loss training:  1.77589079439349 Time :  42365
accuracy train: 0.998920 val: 0.935455 test: 0.853425
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({1: 6973, 0: 6344, 2: 5529})

Epoch :  72 loss training:  1.4393433872392052 Time :  42464
accuracy train: 0.999509 val: 0.934571 test: 0.852894
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({1: 6970, 0: 6353, 2: 5523})

Epoch :  73 loss training:  1.3213266601560463 Time :  42562
accuracy train: 0.999509 val: 0.937224 test: 0.854355
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({2: 6973, 1: 6378, 0: 5495})

Epoch :  74 loss training:  1.4736078205460217 Time :  42662
accuracy train: 0.999411 val: 0.938108 test: 0.854488
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({2: 6976, 0: 6397, 1: 5473})

Epoch :  75 loss training:  1.3738522044477577 Time :  42763
accuracy train: 0.999509 val: 0.932803 test: 0.847318
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({2: 6988, 1: 6391, 0: 5467})

Epoch :  76 loss training:  1.626906442881591 Time :  42863
accuracy train: 0.999509 val: 0.936340 test: 0.857010
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({0: 6996, 1: 6387, 2: 5463})

Epoch :  77 loss training:  1.191599850073544 Time :  42960
accuracy train: 0.999607 val: 0.936340 test: 0.849310
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({0: 7002, 1: 6415, 2: 5429})

Epoch :  78 loss training:  1.8903334041715425 Time :  43059
accuracy train: 0.999607 val: 0.938992 test: 0.857674
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({2: 7008, 0: 6410, 1: 5428})

Epoch :  79 loss training:  1.1353212836474995 Time :  43158
accuracy train: 0.999509 val: 0.930150 test: 0.853824
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({2: 7005, 0: 6419, 1: 5422})

Epoch :  80 loss training:  1.6754863000787736 Time :  43274
accuracy train: 0.999509 val: 0.932803 test: 0.856213
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({0: 7004, 1: 6420, 2: 5422})

Epoch :  81 loss training:  0.7498336595726869 Time :  43390
accuracy train: 0.999509 val: 0.933687 test: 0.857541
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({2: 6997, 1: 6422, 0: 5427})

Epoch :  82 loss training:  1.4428952541302351 Time :  43521
accuracy train: 0.999607 val: 0.937224 test: 0.859134
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({0: 7001, 2: 6425, 1: 5420})

Epoch :  83 loss training:  1.2515649457964173 Time :  43637
accuracy train: 0.999509 val: 0.938992 test: 0.859533
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({2: 7002, 1: 6424, 0: 5420})

Epoch :  84 loss training:  1.5592365737356886 Time :  43752
accuracy train: 0.999607 val: 0.934571 test: 0.858338
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({2: 7005, 1: 6441, 0: 5400})

Epoch :  85 loss training:  0.9120855654819024 Time :  43868
accuracy train: 0.999607 val: 0.935455 test: 0.853027
max validation accuracy : 0.938992 max acc epoch : 54 test accuracy : 0.853956
Counter({2: 7010, 1: 6459, 0: 5377})

========================================================================================================================================================================================================
max acc epoch :  54
max validation accuracy :  0.9389920424403183
test accuracy :  0.8539564524694636
last test_accuracy :  0.8530270844397239
max gap 17
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=400, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=221, weight_decay=1e-10)
device :  cuda:0
Counter({2: 7569, 1: 6376, 0: 4901})

Epoch :  1 loss training:  336.9778183698654 Time :  44017
accuracy train: 0.822253 val: 0.803714 test: 0.746283
max validation accuracy : 0.803714 max acc epoch : 1 test accuracy : 0.746283
Counter({2: 7080, 0: 6423, 1: 5343})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  205.68638342618942 Time :  44125
accuracy train: 0.850830 val: 0.807250 test: 0.761816
max validation accuracy : 0.807250 max acc epoch : 2 test accuracy : 0.761816
Counter({0: 6666, 1: 6644, 2: 5536})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  171.55118585377932 Time :  44259
accuracy train: 0.864676 val: 0.823165 test: 0.772039
max validation accuracy : 0.823165 max acc epoch : 3 test accuracy : 0.772039
Counter({1: 6688, 0: 6543, 2: 5615})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  132.14777409285307 Time :  44388
accuracy train: 0.906511 val: 0.856764 test: 0.794079
max validation accuracy : 0.856764 max acc epoch : 4 test accuracy : 0.794079
Counter({2: 6649, 1: 6502, 0: 5695})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  123.8925601541996 Time :  44523
accuracy train: 0.918001 val: 0.867374 test: 0.799920
max validation accuracy : 0.867374 max acc epoch : 5 test accuracy : 0.799920
Counter({0: 6683, 1: 6471, 2: 5692})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  113.13612692058086 Time :  44647
accuracy train: 0.926544 val: 0.867374 test: 0.801381
max validation accuracy : 0.867374 max acc epoch : 5 test accuracy : 0.799920
Counter({1: 6683, 2: 6456, 0: 5707})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  95.16737929731607 Time :  44776
accuracy train: 0.935481 val: 0.877100 test: 0.803505
max validation accuracy : 0.877100 max acc epoch : 7 test accuracy : 0.803505
Counter({0: 6665, 1: 6455, 2: 5726})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  93.76631543785334 Time :  44907
accuracy train: 0.934106 val: 0.872679 test: 0.801248
max validation accuracy : 0.877100 max acc epoch : 7 test accuracy : 0.803505
Counter({0: 6655, 2: 6458, 1: 5733})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  85.86011254787445 Time :  45026
accuracy train: 0.948934 val: 0.875332 test: 0.809612
max validation accuracy : 0.877100 max acc epoch : 7 test accuracy : 0.803505
Counter({1: 6652, 2: 6453, 0: 5741})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  79.75788386538625 Time :  45143
accuracy train: 0.953255 val: 0.874447 test: 0.809612
max validation accuracy : 0.877100 max acc epoch : 7 test accuracy : 0.803505
Counter({2: 6650, 0: 6453, 1: 5743})

Epoch :  11 loss training:  76.24845251813531 Time :  45274
accuracy train: 0.959049 val: 0.886826 test: 0.818109
max validation accuracy : 0.886826 max acc epoch : 11 test accuracy : 0.818109
Counter({0: 6649, 2: 6458, 1: 5739})

Epoch :  12 loss training:  68.34666092693806 Time :  45399
accuracy train: 0.966906 val: 0.895668 test: 0.819304
max validation accuracy : 0.895668 max acc epoch : 12 test accuracy : 0.819304
Counter({1: 6634, 0: 6475, 2: 5737})

Epoch :  13 loss training:  59.963904075324535 Time :  45526
accuracy train: 0.970834 val: 0.896552 test: 0.819039
max validation accuracy : 0.896552 max acc epoch : 13 test accuracy : 0.819039
Counter({0: 6597, 1: 6505, 2: 5744})

Epoch :  14 loss training:  55.3845584616065 Time :  45649
accuracy train: 0.977021 val: 0.899204 test: 0.819039
max validation accuracy : 0.899204 max acc epoch : 14 test accuracy : 0.819039
Counter({1: 6571, 0: 6510, 2: 5765})

Epoch :  15 loss training:  48.93394633196294 Time :  45785
accuracy train: 0.980458 val: 0.909814 test: 0.827669
max validation accuracy : 0.909814 max acc epoch : 15 test accuracy : 0.827669
Counter({0: 6538, 1: 6519, 2: 5789})

Epoch :  16 loss training:  43.891690757125616 Time :  45920
accuracy train: 0.984582 val: 0.907162 test: 0.829262
max validation accuracy : 0.909814 max acc epoch : 15 test accuracy : 0.827669
Counter({2: 6555, 1: 6490, 0: 5801})

Epoch :  17 loss training:  37.9652344211936 Time :  46055
accuracy train: 0.987234 val: 0.915119 test: 0.828332
max validation accuracy : 0.915119 max acc epoch : 17 test accuracy : 0.828332
Counter({1: 6593, 0: 6455, 2: 5798})

Epoch :  18 loss training:  34.51646110508591 Time :  46183
accuracy train: 0.990573 val: 0.909814 test: 0.833909
max validation accuracy : 0.915119 max acc epoch : 17 test accuracy : 0.828332
Counter({0: 6614, 1: 6434, 2: 5798})

Epoch :  19 loss training:  30.772670943289995 Time :  46311
accuracy train: 0.992242 val: 0.918656 test: 0.832714
max validation accuracy : 0.918656 max acc epoch : 19 test accuracy : 0.832714
Counter({0: 6626, 2: 6429, 1: 5791})

Epoch :  20 loss training:  27.323808481916785 Time :  46464
accuracy train: 0.994304 val: 0.916888 test: 0.836033
max validation accuracy : 0.918656 max acc epoch : 19 test accuracy : 0.832714
Counter({0: 6645, 1: 6423, 2: 5778})

Epoch :  21 loss training:  25.5067523624748 Time :  46611
accuracy train: 0.996268 val: 0.918656 test: 0.837361
max validation accuracy : 0.918656 max acc epoch : 19 test accuracy : 0.832714
Counter({2: 6649, 1: 6426, 0: 5771})

Epoch :  22 loss training:  22.327100492082536 Time :  46773
accuracy train: 0.995384 val: 0.913351 test: 0.837095
max validation accuracy : 0.918656 max acc epoch : 19 test accuracy : 0.832714
Counter({1: 6653, 2: 6430, 0: 5763})

Epoch :  23 loss training:  19.34808493265882 Time :  46941
accuracy train: 0.997643 val: 0.923961 test: 0.839219
max validation accuracy : 0.923961 max acc epoch : 23 test accuracy : 0.839219
Counter({2: 6661, 0: 6407, 1: 5778})

Epoch :  24 loss training:  17.150819982169196 Time :  47127
accuracy train: 0.997349 val: 0.925729 test: 0.840945
max validation accuracy : 0.925729 max acc epoch : 24 test accuracy : 0.840945
Counter({0: 6671, 1: 6394, 2: 5781})

Epoch :  25 loss training:  15.95223606727086 Time :  47318
accuracy train: 0.998625 val: 0.925729 test: 0.844530
max validation accuracy : 0.925729 max acc epoch : 24 test accuracy : 0.840945
Counter({0: 6682, 2: 6385, 1: 5779})

Epoch :  26 loss training:  14.125555195845664 Time :  47511
accuracy train: 0.998134 val: 0.914235 test: 0.841211
max validation accuracy : 0.925729 max acc epoch : 24 test accuracy : 0.840945
Counter({2: 6683, 0: 6370, 1: 5793})

Epoch :  27 loss training:  13.032284950837493 Time :  47692
accuracy train: 0.998527 val: 0.927498 test: 0.845061
max validation accuracy : 0.927498 max acc epoch : 27 test accuracy : 0.845061
Counter({0: 6680, 2: 6369, 1: 5797})

Epoch :  28 loss training:  10.467161955311894 Time :  47868
accuracy train: 0.998527 val: 0.923961 test: 0.843468
max validation accuracy : 0.927498 max acc epoch : 27 test accuracy : 0.845061
Counter({0: 6686, 2: 6370, 1: 5790})

Epoch :  29 loss training:  10.511861606501043 Time :  48063
accuracy train: 0.998920 val: 0.924845 test: 0.846389
max validation accuracy : 0.927498 max acc epoch : 27 test accuracy : 0.845061
Counter({2: 6681, 1: 6368, 0: 5797})

Epoch :  30 loss training:  9.844638116424903 Time :  48244
accuracy train: 0.998822 val: 0.923961 test: 0.843601
max validation accuracy : 0.927498 max acc epoch : 27 test accuracy : 0.845061
Counter({0: 6689, 2: 6362, 1: 5795})

Epoch :  31 loss training:  8.712884640321136 Time :  48423
accuracy train: 0.999018 val: 0.924845 test: 0.849442
max validation accuracy : 0.927498 max acc epoch : 27 test accuracy : 0.845061
Counter({2: 6734, 0: 6321, 1: 5791})

Epoch :  32 loss training:  7.977247690781951 Time :  48621
accuracy train: 0.998920 val: 0.926614 test: 0.848646
max validation accuracy : 0.927498 max acc epoch : 27 test accuracy : 0.845061
Counter({2: 6736, 1: 6318, 0: 5792})

Epoch :  33 loss training:  7.798199284705333 Time :  48820
accuracy train: 0.999018 val: 0.928382 test: 0.849973
max validation accuracy : 0.928382 max acc epoch : 33 test accuracy : 0.849973
Counter({1: 6737, 2: 6312, 0: 5797})

Epoch :  34 loss training:  6.127182672033086 Time :  49010
accuracy train: 0.999313 val: 0.933687 test: 0.845990
max validation accuracy : 0.933687 max acc epoch : 34 test accuracy : 0.845990
Counter({2: 6743, 0: 6313, 1: 5790})

Epoch :  35 loss training:  6.451100106933154 Time :  49214
accuracy train: 0.999214 val: 0.923077 test: 0.844928
max validation accuracy : 0.933687 max acc epoch : 34 test accuracy : 0.845990
Counter({0: 6770, 2: 6321, 1: 5755})

Epoch :  36 loss training:  5.752600536332466 Time :  49413
accuracy train: 0.999214 val: 0.927498 test: 0.848513
max validation accuracy : 0.933687 max acc epoch : 34 test accuracy : 0.845990
Counter({1: 6784, 2: 6311, 0: 5751})

Epoch :  37 loss training:  5.64723762171343 Time :  49612
accuracy train: 0.999313 val: 0.932803 test: 0.855284
max validation accuracy : 0.933687 max acc epoch : 34 test accuracy : 0.845990
Counter({0: 6793, 1: 6306, 2: 5747})

Epoch :  38 loss training:  5.2577592097222805 Time :  49798
accuracy train: 0.999313 val: 0.929266 test: 0.850239
max validation accuracy : 0.933687 max acc epoch : 34 test accuracy : 0.845990
Counter({2: 6800, 0: 6300, 1: 5746})

slurmstepd: error: *** JOB 37076 ON cl-gpusrv1 CANCELLED AT 2021-06-11T13:37:24 ***
